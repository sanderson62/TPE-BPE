* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   1
* PEMCOF5.cbl
* Options: int("PEMCOF5.int") anim csi verbose NOBOUND PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("PEMCOF5.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"ebmlsfile" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" NOCHECKDIV NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"32" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"PEMCOF5.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"PEMCOF5.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR NOSTICKY-LINKAGE
*          NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"2" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2 PROGRAM-ID. PEMCOF4.
     3 AUTHOR.     PABLO.
     4 DATE-COMPILED. 06-Oct-15 17:19.
     6 ENVIRONMENT DIVISION.
     7 INPUT-OUTPUT SECTION.
     8 FILE-CONTROL.
     9     SELECT ERCOMP           ASSIGN TO ERCOMP
    10                             ORGANIZATION IS INDEXED
    11                             ACCESS IS DYNAMIC
    12                             RECORD KEY IS CO-CONTROL-PRIMARY
    13                             FILE STATUS IS ERCOMP-FILE-STATUS.
    14
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   2
* PEMCOF5.cbl
    15 DATA DIVISION.
    16 FILE SECTION.
    17
    18 FD  ERCOMP.
    19
*   20                                 COPY ERCCOMP.
    21******************************************************************
    22*                                                                *
    23*                                                                *
    24*                            ERCCOMP                             *
    25*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
    26*                            VMOD=2.019                          *
    27*                                                                *
    28*   ONLINE CREDIT SYSTEM                                         *
    29*                                                                *
    30*   FILE DESCRIPTION = COMPENSATION MASTER                       *
    31*                                                                *
    32*   FILE TYPE = VSAM,KSDS                                        *
    33*   RECORD SIZE = 700   RECFORM = FIXED                          *
    34*                                                                *
    35*   BASE CLUSTER NAME = ERCOMP                   RKP=2,LEN=29    *
    36*       ALTERNATE PATH = NONE                                    *
    37*                                                                *
    38*   LOG = NO                                                     *
    39*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
    40*                                                                *
    41******************************************************************
    42*                   C H A N G E   L O G
    43*
    44* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    45*-----------------------------------------------------------------
    46*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    47* EFFECTIVE    NUMBER
    48*-----------------------------------------------------------------
    49* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
    50* 041105    2005031100003  PEMA  ADD TYPE CODE FOR BANKS
    51* 092205    2005050300006  PEMA  ADD LEASE FEE
    52* 032406    2006022800001  AJRA  ADD FIRST WRITTEN DATE
    53* 072406    2006022400001  PEMA  ADD REF EDIT FLD ON B RECS
    54* 062907    2004020600003  PEMA  ADD WITHOLDING PERCENT
    55* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
    56* 020310  CR2008100900004  PEMA  ADD REF4 EXTRACT PROCESSING
    57* 071712  CR2012042700005  PEMA  ADD OVER 120 FOR AHL ONLY
    58******************************************************************
    59
    60 01  COMPENSATION-MASTER.
    61     12  CO-RECORD-ID                          PIC XX.
    62         88  VALID-CO-ID                          VALUE 'CO'.
    63
    64     12  CO-CONTROL-PRIMARY.
    65         16  CO-COMPANY-CD                     PIC X.
    66         16  CO-CONTROL.
    67             20  CO-CTL-1.
    68                 24  CO-CARR-GROUP.
    69                     28  CO-CARRIER            PIC X.
    70                     28  CO-GROUPING.
    71                         32  CO-GROUP-PREFIX   PIC XXX.
    72                         32  CO-GROUP-PRIME    PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   3
* PEMCOF5.cbl (/apps/prod/cid1p/copy/ERCCOMP)
    73                 24  CO-RESP-NO.
    74                     28  CO-RESP-PREFIX        PIC X(4).
    75                     28  CO-RESP-PRIME         PIC X(6).
    76             20  CO-CTL-2.
    77                 24  CO-ACCOUNT.
    78                     28  CO-ACCT-PREFIX        PIC X(4).
    79                     28  CO-ACCT-PRIME         PIC X(6).
    80         16  CO-TYPE                           PIC X.
    81             88  CO-COMPANY-TYPE                  VALUE 'C'.
    82             88  CO-GEN-AGENT-TYPE     VALUE 'G' 'B'.
    83             88  CO-ACCOUNT-TYPE                  VALUE 'A'.
    84
    85     12  CO-MAINT-INFORMATION.
    86         16  CO-LAST-MAINT-DT                  PIC XX.
    87         16  CO-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
    88         16  CO-LAST-MAINT-USER                PIC X(4).
    89     12  FILLER                                PIC XX.
    90     12  CO-STMT-TYPE                          PIC XXX.
    91     12  CO-COMP-TYPE                          PIC X.
    92         88  CO-COMP-IS-SPPDD                    VALUE '1'.
    93     12  CO-STMT-OWNER                         PIC X(4).
    94     12  CO-BALANCE-CONTROL                    PIC X.
    95         88  CO-CARRY-BALANCE                     VALUE 'Y'.
    96         88  CO-NO-BALANCE                        VALUE 'N'.
    97
    98     12  CO-INTERNAL-CONTROL-1                 PIC X.
    99         88  CO-AUTO-GENERATED-THIS-RUN           VALUE 'X'.
   100         88  CO-AUTO-GENERATED                    VALUE 'Y'.
   101         88  CO-NOT-AUTO-GENERATED                VALUE 'N'.
   102
   103     12  CO-INTERNAL-CONTROL-2                 PIC X.
   104         88  CO-STATEMENT-THIS-RUN                VALUE 'Y'.
   105         88  CO-NO-STATEMENT-THIS-RUN             VALUE 'N'.
   106
   107     12  CO-GA-WITHOLD-PCT                     PIC S9V9999 COMP-3.
   108     12  CO-GA-DIRECT-DEP                      PIC X.
   109     12  CO-FUTURE-SPACE                       PIC X.
   110         88  CO-FUTURE-NOT-USED                   VALUE ' '.
   111
   112     12  CO-ACCT-NAME                          PIC X(30).
   113     12  CO-MAIL-NAME                          PIC X(30).
   114     12  CO-ADDR-1                             PIC X(30).
   115     12  CO-ADDR-2                             PIC X(30).
   116     12  CO-ADDR-3.
   117         16  CO-ADDR-CITY                      PIC X(27).
   118         16  CO-ADDR-STATE                     PIC XX.
   119     12  CO-CSO-1099                           PIC X.
   120     12  CO-ZIP.
   121         16  CO-ZIP-PRIME.
   122             20  CO-ZIP-PRI-1ST                PIC X.
   123                 88  CO-CANADIAN-POST-CODE  VALUE 'A' THRU 'Z'.
   124             20  FILLER                        PIC X(4).
   125         16  CO-ZIP-PLUS4                      PIC X(4).
   126     12  CO-CANADIAN-POSTAL-CODE  REDEFINES  CO-ZIP.
   127         16  CO-CAN-POSTAL-1                   PIC XXX.
   128         16  CO-CAN-POSTAL-2                   PIC XXX.
   129         16  FILLER                            PIC XXX.
   130     12  CO-SOC-SEC                            PIC X(13).
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   4
* PEMCOF5.cbl (/apps/prod/cid1p/copy/ERCCOMP)
   131     12  CO-TELEPHONE.
   132         16  CO-AREA-CODE                      PIC XXX.
   133         16  CO-PREFIX                         PIC XXX.
   134         16  CO-PHONE                          PIC X(4).
   135
   136     12  CO-ROLADEX-PRINT-DT                   PIC XX.
   137
   138     12  CO-AR-BAL-LEVEL                       PIC X.
   139         88  CO-AR-REF-LVL                        VALUE '1'.
   140         88  CO-AR-BILL-REF-LVL                   VALUE '1'.
   141         88  CO-AR-BILL-LVL                       VALUE '2'.
   142         88  CO-AR-AGT-LVL                        VALUE '3'.
   143         88  CO-AR-FR-LVL                         VALUE '4'.
   144
   145     12  CO-AR-NORMAL-PRINT                    PIC X.
   146         88  CO-AR-BILL-IS-PRINTED                VALUE 'Y'.
   147         88  CO-AR-BILL-NOT-PRINTED               VALUE 'N'.
   148
   149     12  CO-AR-SUMMARY-CODE                    PIC X(6).
   150
   151     12  CO-AR-REPORTING                       PIC X.
   152         88  CO-AR-NET-REPORT                     VALUE 'N'.
   153         88  CO-AR-GROSS-REPORT                   VALUE 'G'.
   154
   155     12  CO-AR-PULL-CHECK                      PIC X.
   156         88  CO-AR-CHECKS-PULLED                  VALUE 'Y'.
   157         88  CO-AR-CHECKS-NOT-PULLED              VALUE 'N'.
   158
   159     12  CO-AR-BALANCE-PRINT                   PIC X.
   160         88  CO-AR-PRINT-NO-BALANCE               VALUE 'N'.
   161
   162     12  CO-AR-LAST-RUN-CODE                   PIC X.
   163         88  CO-AR-LAST-RUN-ANNUAL                VALUE 'A'.
   164         88  CO-AR-LAST-RUN-CYCLE                 VALUE 'C'.
   165         88  CO-AR-LAST-RUN-EOM                   VALUE 'M'.
   166
   167     12  CO-LAST-EOM-STMT-DT                   PIC XX.
   168
   169     12  CO-USER-CODE                          PIC X.
   170     12  CO-REPORT-GROUP-ID                    PIC X(12).
   171
   172******************************************************************
   173*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN THE TOTALS AS OF
   174*    THE LAST MONTH END RUN.
   175******************************************************************
   176
   177     12  CO-LAST-ACTIVITY-DATE.
   178         16  CO-ACT-YEAR                       PIC 99.
   179         16  CO-ACT-MONTH                      PIC 99.
   180         16  CO-ACT-DAY                        PIC 99.
   181
   182     12  CO-LAST-STMT-DT.
   183         16  CO-LAST-STMT-YEAR                 PIC 99.
   184         16  CO-LAST-STMT-MONTH                PIC 99.
   185         16  CO-LAST-STMT-DAY                  PIC 99.
   186
   187     12  CO-MO-END-TOTALS.
   188         16  CO-MONTHLY-TOTALS.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   5
* PEMCOF5.cbl (/apps/prod/cid1p/copy/ERCCOMP)
   189             20  CO-BAL-FWD                PIC S9(7)V99   COMP-3.
   190             20  CO-CUR-COM                PIC S9(7)V99   COMP-3.
   191             20  CO-CUR-CHG                PIC S9(7)V99   COMP-3.
   192             20  CO-CUR-PMT                PIC S9(7)V99   COMP-3.
   193             20  CO-END-BAL                PIC S9(7)V99   COMP-3.
   194
   195         16  CO-AGING-TOTALS.
   196             20  CO-CUR                    PIC S9(7)V99   COMP-3.
   197             20  CO-OV30                   PIC S9(7)V99   COMP-3.
   198             20  CO-OV60                   PIC S9(7)V99   COMP-3.
   199             20  CO-OV90                   PIC S9(7)V99   COMP-3.
   200
   201         16  CO-YTD-TOTALS.
   202             20  CO-YTD-COM                PIC S9(7)V99   COMP-3.
   203             20  CO-YTD-OV                 PIC S9(7)V99   COMP-3.
   204
   205         16  CO-OVER-UNDER-TOTALS.
   206             20  CO-CUR-OVR-UNDR           PIC S9(7)V99   COMP-3.
   207             20  CO-YTD-OVR-UNDR           PIC S9(7)V99   COMP-3.
   208
   209     12  CO-MISCELLANEOUS-TOTALS.
   210         16  CO-FICA-TOTALS.
   211             20  CO-CUR-FICA               PIC S9(7)V99   COMP-3.
   212             20  CO-YTD-FICA               PIC S9(7)V99   COMP-3.
   213
   214         16  CO-CLAIM-TOTALS.
   215             20  CO-LF-CLM-AMT             PIC S9(9)V99   COMP-3.
   216             20  CO-AH-CLM-AMT             PIC S9(9)V99   COMP-3.
   217
   218******************************************************************
   219*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN TOTALS THAT
   220*    REPRESENT CURRENT MONTH (TOTALS OF CYCLES).
   221******************************************************************
   222
   223     12  CO-CURRENT-TOTALS.
   224         16  CO-CURRENT-LAST-STMT-DT.
   225             20  CO-CURRENT-LAST-STMT-YEAR     PIC 99.
   226             20  CO-CURRENT-LAST-STMT-MONTH    PIC 99.
   227             20  CO-CURRENT-LAST-STMT-DAY      PIC 99.
   228
   229         16  CO-CURRENT-MONTHLY-TOTALS.
   230             20  CO-CURRENT-BAL-FWD        PIC S9(7)V99   COMP-3.
   231             20  CO-CURRENT-CUR-COM        PIC S9(7)V99   COMP-3.
   232             20  CO-CURRENT-CUR-CHG        PIC S9(7)V99   COMP-3.
   233             20  CO-CURRENT-CUR-PMT        PIC S9(7)V99   COMP-3.
   234             20  CO-CURRENT-END-BAL        PIC S9(7)V99   COMP-3.
   235
   236         16  CO-CURRENT-AGING-TOTALS.
   237             20  CO-CURRENT-CUR            PIC S9(7)V99   COMP-3.
   238             20  CO-CURRENT-OV30           PIC S9(7)V99   COMP-3.
   239             20  CO-CURRENT-OV60           PIC S9(7)V99   COMP-3.
   240             20  CO-CURRENT-OV90           PIC S9(7)V99   COMP-3.
   241
   242         16  CO-CURRENT-YTD-TOTALS.
   243             20  CO-CURRENT-YTD-COM        PIC S9(7)V99   COMP-3.
   244             20  CO-CURRENT-YTD-OV         PIC S9(7)V99   COMP-3.
   245
   246     12  CO-PAID-COMM-TOTALS.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   6
* PEMCOF5.cbl (/apps/prod/cid1p/copy/ERCCOMP)
   247         16  CO-YTD-PAID-COMMS.
   248             20  CO-YTD-PAID-COM           PIC S9(7)V99   COMP-3.
   249             20  CO-YTD-PAID-OV            PIC S9(7)V99   COMP-3.
   250
   251     12  CO-CURRENT-MONTH-ACTIVITY         PIC X.
   252         88  CO-HAS-CURR-MONTH-ACTIVITY       VALUE 'Y'.
   253         88  CO-NO-CURR-MONTH-ACTIVITY        VALUE 'N'.
   254
   255     12  CO-DELINQUENT-LETTER-CODE         PIC X.
   256         88  CO-ACCOUNT-1ST-LETTER            VALUE 'A'.
   257         88  CO-ACCOUNT-2ND-LETTER            VALUE 'B'.
   258         88  CO-AGENT-1ST-LETTER              VALUE 'B'.
   259         88  CO-AGENT-2ND-LETTER              VALUE 'G'.
   260         88  CO-OVERWRITE-LETTER              VALUE 'O'.
   261         88  CO-MEMO-TO-REGION-MGR            VALUE 'M'.
   262         88  CO-FINAL-LETTER                  VALUE 'F'.
   263         88  CO-RECONCILING                   VALUE 'R'.
   264         88  CO-PHONE-CALL                    VALUE 'P'.
   265         88  CO-LEGAL                         VALUE 'L'.
   266         88  CO-COLLECTION-AGENCY             VALUE 'C'.
   267         88  CO-WRITE-OFF                     VALUE 'W'.
   268         88  CO-NO-ACTION                     VALUE 'N' ' '.
   269
   270     12  CO-CSR-CODE                       PIC X(4).
   271
   272     12  CO-GA-STATUS-INFO.
   273         16  CO-GA-EFFECTIVE-DT            PIC XX.
   274         16  CO-GA-TERMINATION-DT          PIC XX.
   275         16  CO-GA-STATUS-CODE             PIC X.
   276             88  CO-GA-ACTIVE                 VALUE 'A'.
   277             88  CO-GA-INACTIVE               VALUE 'I'.
   278             88  CO-GA-PENDING                VALUE 'P'.
   279         16  CO-GA-COMMENTS.
   280             20  CO-GA-COMMENT-1           PIC X(40).
   281             20  CO-GA-COMMENT-2           PIC X(40).
   282             20  CO-GA-COMMENT-3           PIC X(40).
   283             20  CO-GA-COMMENT-4           PIC X(40).
   284
   285     12  CO-RPTCD2                         PIC X(10).
   286     12  CO-AHL-OVER120-DATA REDEFINES CO-RPTCD2.
   287         16  CO-OV120                      PIC S9(7)V99   COMP-3.
   288         16  CO-CURRENT-OV120              PIC S9(7)V99   COMP-3.
   289
   290     12  CO-TYPE-AGENT                     PIC X(01).
   291         88  CO-CORPORATION                   VALUE 'C'.
   292         88  CO-PARTNERSHIP                   VALUE 'P'.
   293         88  CO-SOLE-PROPRIETOR               VALUE 'S'.
   294         88  CO-TRUST                         VALUE 'T'.
   295         88  CO-UNKNOWN                       VALUE ' ' 'X'.
   296
   297     12  CO-FAXNO.
   298         16  CO-FAX-AREA-CODE                  PIC XXX.
   299         16  CO-FAX-PREFIX                     PIC XXX.
   300         16  CO-FAX-PHONE                      PIC X(4).
   301
   302     12  CO-BANK-INFORMATION.
   303         16  CO-BANK-TRANSIT-NO                PIC X(8).
   304         16  CO-BANK-TRANSIT-NON REDEFINES
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   7
* PEMCOF5.cbl (/apps/prod/cid1p/copy/ERCCOMP)
   305             CO-BANK-TRANSIT-NO                PIC 9(8).
   306
   307         16  CO-BANK-ACCOUNT-NUMBER            PIC X(17).
   308     12  CO-MISC-DEDUCT-INFO REDEFINES
   309                  CO-BANK-INFORMATION.
   310         16  CO-MD-GL-ACCT                     PIC X(10).
   311         16  CO-MD-DIV                         PIC XX.
   312         16  CO-MD-CENTER                      PIC X(4).
   313         16  CO-MD-AMT                        PIC S9(5)V99 COMP-3.
   314         16  CO-CREATE-AP-CHECK                PIC X.
   315         16  CO-DELIVER-CK-TO-MEL              PIC X.
   316         16  FILLER                            PIC XXX.
   317     12  CO-ACH-STATUS                         PIC X.
   318         88  CO-ACH-ACTIVE                         VALUE 'A'.
   319         88  CO-ACH-PENDING                        VALUE 'P'.
   320
   321     12  CO-BILL-SW                            PIC X.
   322     12  CO-CONTROL-NAME                       PIC X(30).
   323     12  CO-MAX-BANK-FEE-LEASE                 PIC S999V99 COMP-3.
   324     12  CO-MAX-BANK-FEE                       PIC S999V99 COMP-3.
   325     12  CO-CLP-STATE                          PIC XX.
   326     12  CO-FIRST-WRITTEN-DT                   PIC XX.
   327     12  CO-SPP-REFUND-EDIT                    PIC X.
   328
   329******************************************************************
   330
   331 WORKING-STORAGE SECTION.
   332 77  S1                          PIC S9(3) COMP-3 VALUE +0.
   333 77  WS-STATE-SW                 PIC X  VALUE ' '.
   334     88  VALID-STATE               VALUE 'Y'.
   335 77  WS-DIS-EFF-DT               PIC X(10)  VALUE SPACES.
   336 77  WS-DIS-EXP-DT               PIC X(10)  VALUE SPACES.
   337 01  WS-STATUS-CODES.
   338     05  ERCOMP-FILE-STATUS      PIC XX  VALUE SPACES.
   339     05  WS-EOF-SW               PIC X   VALUE SPACES.
   340         88  END-OF-ERCOMP               VALUE 'Y'.
   341         88  MORE-ERCOMP                 VALUE ' '.
   342
   343*****************************************************************
   344*                                                               *
   345*                     STATE CODE TABLE                          *
   346*                                                               *
   347*  CAUTION:  THIS TABLE MUST BE IN SEQUENCE BY STATE OR THE     *
   348*            SEARCH VERB WILL NOT WORK PROPERLY !               *
   349*                                                               *
   350*****************************************************************
   351
   352 01  STATE-VALUES.
   353     05  PIC X(24)  VALUE 'AAAA                    '.
   354     05  PIC X(24)  VALUE 'AEAE                    '.
   355     05  PIC X(24)  VALUE 'AKAKALASKA              '.
   356     05  PIC X(24)  VALUE 'ALALALABAMA             '.
   357     05  PIC X(24)  VALUE 'APAP                    '.
   358     05  PIC X(24)  VALUE 'ARARARKANSAS            '.
   359     05  PIC X(24)  VALUE 'ASASAMERICAN SAMOA      '.
   360     05  PIC X(24)  VALUE 'AZAZARIZONA             '.
   361     05  PIC X(24)  VALUE 'CACACALIFORNIA          '.
   362     05  PIC X(24)  VALUE 'CDCNCANADA              '.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   8
* PEMCOF5.cbl
   363     05  PIC X(24)  VALUE 'CNCNCANADA              '.
   364     05  PIC X(24)  VALUE 'COCOCOLORADO            '.
   365     05  PIC X(24)  VALUE 'CTCTCONNECTICUT         '.
   366     05  PIC X(24)  VALUE 'DCDCDISTRICT OF COLUMBIA'.
   367     05  PIC X(24)  VALUE 'DEDEDELAWARE            '.
   368     05  PIC X(24)  VALUE 'FCOTOTHER ALIEN         '.
   369     05  PIC X(24)  VALUE 'FLFLFLORIDA             '.
   370     05  PIC X(24)  VALUE 'GAGAGEORGIA             '.
   371     05  PIC X(24)  VALUE 'GUGUGUAM                '.
   372     05  PIC X(24)  VALUE 'HIHIHAWAII              '.
   373     05  PIC X(24)  VALUE 'IAIAIOWA                '.
   374     05  PIC X(24)  VALUE 'IDIDIDAHO               '.
   375     05  PIC X(24)  VALUE 'ILILILLINOIS            '.
   376     05  PIC X(24)  VALUE 'INININDIANA             '.
   377     05  PIC X(24)  VALUE 'KSKSKANSAS              '.
   378     05  PIC X(24)  VALUE 'KYKYKENTUCKY            '.
   379     05  PIC X(24)  VALUE 'LALALOUISIANA           '.
   380     05  PIC X(24)  VALUE 'MAMAMASSACHUSETTS       '.
   381     05  PIC X(24)  VALUE 'MDMDMARYLAND            '.
   382     05  PIC X(24)  VALUE 'MEMEMAINE               '.
   383     05  PIC X(24)  VALUE 'MIMIMICHIGAN            '.
   384     05  PIC X(24)  VALUE 'MNMNMINNESOTA           '.
   385     05  PIC X(24)  VALUE 'MOMOMISSOURI            '.
   386     05  PIC X(24)  VALUE 'MSMSMISSISSIPPI         '.
   387     05  PIC X(24)  VALUE 'MTMTMONTANA             '.
   388     05  PIC X(24)  VALUE 'NCNCNORTH CAROLINA      '.
   389     05  PIC X(24)  VALUE 'NDNDNORTH DAKOTA        '.
   390     05  PIC X(24)  VALUE 'NENENEBRASKA            '.
   391     05  PIC X(24)  VALUE 'NHNHNEW HAMPSHIRE       '.
   392     05  PIC X(24)  VALUE 'NJNJNEW JERSEY          '.
   393     05  PIC X(24)  VALUE 'NMNMNEW MEXICO          '.
   394     05  PIC X(24)  VALUE 'NVNVNEVADA              '.
   395     05  PIC X(24)  VALUE 'NYNYNEW YORK            '.
   396     05  PIC X(24)  VALUE 'OFOTOTHER ALIEN         '.
   397     05  PIC X(24)  VALUE 'OHOHOHIO                '.
   398     05  PIC X(24)  VALUE 'OKOKOKLAHOMA            '.
   399     05  PIC X(24)  VALUE 'OROROREGON              '.
   400     05  PIC X(24)  VALUE 'OTOTOTHER ALIEN         '.
   401     05  PIC X(24)  VALUE 'PAPAPENNSYLVANIA        '.
   402     05  PIC X(24)  VALUE 'PRPRPUERTO RICO         '.
   403     05  PIC X(24)  VALUE 'RIRIRHODE ISLAND        '.
   404     05  PIC X(24)  VALUE 'SCSCSOUTH CAROLINA      '.
   405     05  PIC X(24)  VALUE 'SDSDSOUTH DAKOTA        '.
   406     05  PIC X(24)  VALUE 'TNTNTENNESSEE           '.
   407     05  PIC X(24)  VALUE 'TXTXTEXAS               '.
   408     05  PIC X(24)  VALUE 'UTUTUTAH                '.
   409     05  PIC X(24)  VALUE 'VAVAVIRGINIA            '.
   410     05  PIC X(24)  VALUE 'VIVIUS VIRGIN ISLANDS   '.
   411     05  PIC X(24)  VALUE 'VTVTVERMONT             '.
   412     05  PIC X(24)  VALUE 'WAWAWASHINGTON          '.
   413     05  PIC X(24)  VALUE 'WIWIWISCONSIN           '.
   414     05  PIC X(24)  VALUE 'WVWVWEST VIRGINIA       '.
   415     05  PIC X(24)  VALUE 'WYWYWYOMING             '.
   416
   417 01  FILLER REDEFINES STATE-VALUES.
   418     05  STATE-TABLE
   419             OCCURS 63 TIMES
   420             ASCENDING KEY IS ST-STATE
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   9
* PEMCOF5.cbl
   421             INDEXED BY ST-INDEX.
   422         10  ST-STATE          PIC XX.
   423         10  ST-ALT-STATE      PIC XX.
   424         10  ST-NAME           PIC X(20).
   425
*  426                                 COPY ELCDATE.
   427******************************************************************06/11/98
   428*                                                                *ELCDATE
   429*                                                                *ELCDATE
   430*                            ELCDATE.                            *   LV023
   431*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL*16
   432*                            VMOD=2.003                           ELCDATE
   433*                                                                *ELCDATE
   434*                                                                *ELCDATE
   435*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *ELCDATE
   436*                 LENGTH = 200                                   *   CL*19
   437******************************************************************ELCDATE
   438                                                                  ELCDATE
   439 01  DATE-CONVERSION-DATA.                                        ELCDATE
   440     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.    CL*19
   441     12  DC-OPTION-CODE                PIC X.                        CL*15
   442         88  BIN-TO-GREG                VALUE ' '.                ELCDATE
   443         88  ELAPSED-BETWEEN-BIN        VALUE '1'.                ELCDATE
   444         88  EDIT-GREG-TO-BIN           VALUE '2'.                ELCDATE
   445         88  YMD-GREG-TO-BIN            VALUE '3'.                ELCDATE
   446         88  MDY-GREG-TO-BIN            VALUE '4'.                ELCDATE
   447         88  JULIAN-TO-BIN              VALUE '5'.                ELCDATE
   448         88  BIN-PLUS-ELAPSED           VALUE '6'.                ELCDATE
   449         88  FIND-CENTURY               VALUE '7'.                   CL*22
   450         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.                ELCDATE
   451         88  EDIT-GREG-TO-BIN-3         VALUE '9'.                ELCDATE
   452         88  YMD-GREG-TO-BIN-3          VALUE 'A'.                ELCDATE
   453         88  MDY-GREG-TO-BIN-3          VALUE 'B'.                ELCDATE
   454         88  JULIAN-TO-BIN-3            VALUE 'C'.                ELCDATE
   455         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.                ELCDATE
   456         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.                   CL*14
   457         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.                   CL*14
   458         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.                   CL*14
   459         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.         CL*14
   460         88  CHECK-LEAP-YEAR            VALUE 'H'.                   CL*14
   461         88  BIN-3-TO-GREG              VALUE 'I'.                   CL*14
   462         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.                   CL*14
   463         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.                   CL*14
   464         88  CYMD-GREG-TO-BIN           VALUE 'L'.                   CL*14
   465         88  MDCY-GREG-TO-BIN           VALUE 'M'.                   CL*14
   466         88  MDY-GREG-TO-JULIAN         VALUE 'N'.                   CL*14
   467         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.                   CL*14
   468         88  YMD-GREG-TO-JULIAN         VALUE 'P'.                   CL*14
   469         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.                   CL*14
   470         88  THREE-CHARACTER-BIN                                  ELCDATE
   471                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.       CL*14
   472         88  GREGORIAN-TO-BIN                                        CL**2
   473                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.    CL*14
   474         88  BIN-TO-GREGORIAN                                        CL**2
   475                  VALUES ' ' '1' 'I' '8' 'G'.                        CL*14
   476         88  JULIAN-TO-BINARY                                        CL**2
   477                  VALUES '5' 'C' 'E' 'F'.                            CL*14
   478     12  DC-ERROR-CODE                 PIC X.                        CL*15
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  10
* PEMCOF5.cbl (/apps/prod/cid1p/copy/ELCDATE)
   479         88  NO-CONVERSION-ERROR        VALUE ' '.                   CL**3
   480         88  DATE-CONVERSION-ERROR                                ELCDATE
   481                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.        CL*14
   482         88  DATE-IS-ZERO               VALUE '1'.                ELCDATE
   483         88  DATE-IS-NON-NUMERIC        VALUE '2'.                ELCDATE
   484         88  DATE-IS-INVALID            VALUE '3'.                ELCDATE
   485         88  DATE1-GREATER-DATE2        VALUE '4'.                ELCDATE
   486         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.                ELCDATE
   487         88  DATE-INVALID-OPTION        VALUE '9'.                ELCDATE
   488         88  INVALID-CENTURY            VALUE 'A'.                ELCDATE
   489         88  ONLY-CENTURY               VALUE 'B'.                ELCDATE
   490         88  ONLY-LEAP-YEAR             VALUE 'C'.                ELCDATE
   491         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.              CL**3
   492     12  DC-END-OF-MONTH               PIC X.                        CL*15
   493         88  CALCULATE-END-OF-MONTH     VALUE '1'.                ELCDATE
   494     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.         CL*15
   495         88  USE-NORMAL-PROCESS         VALUE ' '.                ELCDATE
   496         88  ADJUST-DOWN-100-YRS        VALUE '1'.                ELCDATE
   497         88  ADJUST-UP-100-YRS          VALUE '2'.                ELCDATE
   498     12  FILLER                        PIC X.                        CL*15
   499     12  DC-CONVERSION-DATES.                                        CL*15
   500         16  DC-BIN-DATE-1             PIC XX.                       CL*15
   501         16  DC-BIN-DATE-2             PIC XX.                       CL*15
   502         16  DC-GREG-DATE-1-EDIT       PIC X(08).                    CL*15
   503         16  DC-GREG-DATE-1-EDIT-R REDEFINES                         CL*15
   504                       DC-GREG-DATE-1-EDIT.                       ELCDATE
   505             20  DC-EDIT1-MONTH        PIC 99.                       CL*15
   506             20  SLASH1-1              PIC X.                        CL*15
   507             20  DC-EDIT1-DAY          PIC 99.                       CL*15
   508             20  SLASH1-2              PIC X.                        CL*15
   509             20  DC-EDIT1-YEAR         PIC 99.                       CL*15
   510         16  DC-GREG-DATE-2-EDIT       PIC X(08).                    CL*15
   511         16  DC-GREG-DATE-2-EDIT-R REDEFINES                         CL*15
   512                     DC-GREG-DATE-2-EDIT.                         ELCDATE
   513             20  DC-EDIT2-MONTH        PIC 99.                       CL*15
   514             20  SLASH2-1              PIC X.                        CL*15
   515             20  DC-EDIT2-DAY          PIC 99.                       CL*15
   516             20  SLASH2-2              PIC X.                        CL*15
   517             20  DC-EDIT2-YEAR         PIC 99.                       CL*15
   518         16  DC-GREG-DATE-1-YMD        PIC 9(06).                    CL*15
   519         16  DC-GREG-DATE-1-YMD-R  REDEFINES                         CL*15
   520                     DC-GREG-DATE-1-YMD.                          ELCDATE
   521             20  DC-YMD-YEAR           PIC 99.                       CL*15
   522             20  DC-YMD-MONTH          PIC 99.                       CL*15
   523             20  DC-YMD-DAY            PIC 99.                       CL*15
   524         16  DC-GREG-DATE-1-MDY        PIC 9(06).                    CL*15
   525         16  DC-GREG-DATE-1-MDY-R REDEFINES                          CL*15
   526                      DC-GREG-DATE-1-MDY.                         ELCDATE
   527             20  DC-MDY-MONTH          PIC 99.                       CL*15
   528             20  DC-MDY-DAY            PIC 99.                       CL*15
   529             20  DC-MDY-YEAR           PIC 99.                       CL*15
   530         16  DC-GREG-DATE-1-ALPHA.                                   CL*15
   531             20  DC-ALPHA-MONTH        PIC X(10).                    CL*15
   532             20  DC-ALPHA-DAY          PIC 99.                       CL*15
   533             20  FILLER                PIC XX.                       CL*15
   534             20  DC-ALPHA-CENTURY.                                   CL*15
   535                 24 DC-ALPHA-CEN-N     PIC 99.                       CL*15
   536             20  DC-ALPHA-YEAR         PIC 99.                       CL*15
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  11
* PEMCOF5.cbl (/apps/prod/cid1p/copy/ELCDATE)
   537         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.           CL*15
   538         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.           CL*15
   539         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.           CL*15
   540         16  DC-JULIAN-DATE            PIC 9(05).                    CL*15
   541         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE                CL*20
   542                                       PIC 9(05).                    CL*20
   543         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.                  CL*15
   544             20  DC-JULIAN-YEAR        PIC 99.                       CL*15
   545             20  DC-JULIAN-DAYS        PIC 999.                      CL*15
   546         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.       CL*15
   547         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.    CL*15
   548         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.    CL*15
   549     12  DATE-CONVERSION-VARIBLES.                                   CL*15
   550         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.            CL*15
   551         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.          CL*15
   552             20  FILLER                PIC 9(3).                     CL*15
   553             20  HOLD-CEN-1-CCYY.                                    CL*15
   554                 24  HOLD-CEN-1-CC     PIC 99.                       CL*17
   555                 24  HOLD-CEN-1-YY     PIC 99.                       CL*17
   556             20  HOLD-CEN-1-MO         PIC 99.                       CL*17
   557             20  HOLD-CEN-1-DA         PIC 99.                       CL*17
   558         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.            CL*15
   559             20  HOLD-CEN-1-R-MO       PIC 99.                       CL*17
   560             20  HOLD-CEN-1-R-DA       PIC 99.                       CL*17
   561             20  HOLD-CEN-1-R-CCYY.                                  CL*15
   562                 24  HOLD-CEN-1-R-CC   PIC 99.                       CL*17
   563                 24  HOLD-CEN-1-R-YY   PIC 99.                       CL*17
   564             20  FILLER                PIC 9(3).                     CL*15
   565         16  HOLD-CENTURY-1-X.                                       CL*15
   566             20  FILLER                PIC X(3)  VALUE SPACES.       CL*15
   567             20  HOLD-CEN-1-X-CCYY.                                  CL*15
   568                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.          CL*17
   569                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.          CL*17
   570             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.          CL*17
   571             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.          CL*17
   572         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.          CL*15
   573             20  HOLD-CEN-1-R-X-MO     PIC XX.                       CL*17
   574             20  HOLD-CEN-1-R-X-DA     PIC XX.                       CL*17
   575             20  HOLD-CEN-1-R-X-CCYY.                                CL*15
   576                 24  HOLD-CEN-1-R-X-CC PIC XX.                       CL*17
   577                 24  HOLD-CEN-1-R-X-YY PIC XX.                       CL*17
   578             20  FILLER                PIC XXX.                      CL*23
   579         16  DC-BIN-DATE-EXPAND-1      PIC XXX.                      CL*15
   580         16  DC-BIN-DATE-EXPAND-2      PIC XXX.                      CL*15
   581         16  DC-JULIAN-DATE-1          PIC 9(07).                    CL*15
   582         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.          CL*15
   583             20  DC-JULIAN-1-CCYY.                                   CL*15
   584                 24  DC-JULIAN-1-CC    PIC 99.                       CL*15
   585                 24  DC-JULIAN-1-YR    PIC 99.                       CL*15
   586             20  DC-JULIAN-DA-1        PIC 999.                      CL*15
   587         16  DC-JULIAN-DATE-2          PIC 9(07).                    CL*15
   588         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.          CL*15
   589             20  DC-JULIAN-2-CCYY.                                   CL*15
   590                 24  DC-JULIAN-2-CC    PIC 99.                       CL*15
   591                 24  DC-JULIAN-2-YR    PIC 99.                       CL*15
   592             20  DC-JULIAN-DA-2        PIC 999.                      CL*15
   593         16  DC-GREG-DATE-A-EDIT.                                    CL*15
   594             20  DC-EDITA-MONTH        PIC 99.                       CL*15
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  12
* PEMCOF5.cbl (/apps/prod/cid1p/copy/ELCDATE)
   595             20  SLASHA-1              PIC X VALUE '/'.              CL*15
   596             20  DC-EDITA-DAY          PIC 99.                       CL*15
   597             20  SLASHA-2              PIC X VALUE '/'.              CL*15
   598             20  DC-EDITA-CCYY.                                      CL*15
   599                 24  DC-EDITA-CENT     PIC 99.                       CL*15
   600                 24  DC-EDITA-YEAR     PIC 99.                       CL*15
   601         16  DC-GREG-DATE-B-EDIT.                                    CL*15
   602             20  DC-EDITB-MONTH        PIC 99.                       CL*15
   603             20  SLASHB-1              PIC X VALUE '/'.              CL*15
   604             20  DC-EDITB-DAY          PIC 99.                       CL*15
   605             20  SLASHB-2              PIC X VALUE '/'.              CL*15
   606             20  DC-EDITB-CCYY.                                      CL*15
   607                 24  DC-EDITB-CENT     PIC 99.                       CL*15
   608                 24  DC-EDITB-YEAR     PIC 99.                       CL*15
   609         16  DC-GREG-DATE-CYMD         PIC 9(08).                    CL*15
   610         16  DC-GREG-DATE-CYMD-R REDEFINES                           CL*15
   611                              DC-GREG-DATE-CYMD.                  ELCDATE
   612             20  DC-CYMD-CEN           PIC 99.                       CL*15
   613             20  DC-CYMD-YEAR          PIC 99.                       CL*15
   614             20  DC-CYMD-MONTH         PIC 99.                       CL*15
   615             20  DC-CYMD-DAY           PIC 99.                       CL*15
   616         16  DC-GREG-DATE-MDCY         PIC 9(08).                    CL*15
   617         16  DC-GREG-DATE-MDCY-R REDEFINES                           CL*15
   618                              DC-GREG-DATE-MDCY.                  ELCDATE
   619             20  DC-MDCY-MONTH         PIC 99.                       CL*15
   620             20  DC-MDCY-DAY           PIC 99.                       CL*15
   621             20  DC-MDCY-CEN           PIC 99.                       CL*15
   622             20  DC-MDCY-YEAR          PIC 99.                       CL*15
   623    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.      ELCDATE
   624        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.        ELCDATE
   625    12  DC-EL310-DATE                  PIC X(21).                    CL*26
   626    12  FILLER                         PIC X(28).                    CL*26
   627
   628 01  WS-HOLD-CITY-STATE          PIC X(30)  VALUE SPACES.
   629 01  WS-WORK-CITY-ST.
   630     05  WS-WORK-CITY            PIC X(28)  VALUE SPACES.
   631     05  WS-WORK-STATE           PIC XX     VALUE SPACES.
   632 01  WS-HOLD-ERCOMP              PIC X(2000) VALUE LOW-VALUES.
   633 01  WS-WORK-FIELDS.
   634     05  WS-ABEND-FLD            PIC 9         VALUE ZEROS.
   635     05  WS-ZERO-FLD             PIC 9         VALUE ZEROS.
   636     05  WS-ERCOMP-RECS-IN       PIC 9(9)      VALUE ZEROS.
   637     05  WS-ERCOMP-RECS-FIX      PIC 9(9)      VALUE ZEROS.
   638     05  WS-ERCOMP-RECS-DEL      PIC 9(9)      VALUE ZEROS.
   639     05  WS-DISPLAY-CNT          PIC Z,ZZZ,ZZ9 VALUE ZEROS.
   640     05  WS-INVALID-ST-CNT       PIC 9(9)      VALUE ZEROS.
   641
   642 PROCEDURE DIVISION.
   643 0000-MAINLINE.
   644
   645     PERFORM 0100-OPEN-FILES     THRU 0100-EXIT
   646     PERFORM 0200-INITIALIZE     THRU 0200-EXIT
   647     PERFORM 0500-PROCESS        THRU 0500-EXIT UNTIL
   648        END-OF-ERCOMP
   649*       OR WS-ERCOMP-RECS-FIX > 500
   650     PERFORM 3000-CLOSE-FILES    THRU 3000-EXIT
   651     PERFORM 4000-FINAL-TOTALS   THRU 4000-EXIT
   652     GOBACK
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  13
* PEMCOF5.cbl
   653
   654     .
   655 0000-EXIT.
   656     EXIT.
   657
   658 0100-OPEN-FILES.
   659
   660     OPEN I-O   ERCOMP
   661*    OPEN INPUT ERCOMP
   662
   663     IF ERCOMP-FILE-STATUS = '00'
   664         CONTINUE
   665     ELSE
   666         DISPLAY '*** ERROR OPENING ERCOMP FILE ***'
   667         DISPLAY '*** STATUS CODE IS ' ERCOMP-FILE-STATUS
   668         PERFORM 9999-ABEND-RTN
   669     END-IF
   670
   671     .
   672 0100-EXIT.
   673     EXIT.
   674
   675 0200-INITIALIZE.
   676
   677     MOVE SPACES                 TO WS-EOF-SW
   678     MOVE ZEROS                  TO WS-ERCOMP-RECS-IN
   679                                    WS-ERCOMP-RECS-FIX
   680                                    WS-ERCOMP-RECS-DEL
   681
   682     PERFORM 1100-START-ERCOMP   THRU 1100-EXIT
   683
   684     PERFORM 1200-READ-ERCOMP    THRU 1200-EXIT
   685
   686     .
   687 0200-EXIT.
   688     EXIT.
   689
   690 0500-PROCESS.
   691
   692     IF CO-STMT-OWNER = 'DADA'
   693        PERFORM 1000-PROCESS     THRU 1000-EXIT
   694     END-IF
   695
   696*    IF CO-ADDR-STATE = SPACES
   697*       IF CO-ADDR-3 NOT = SPACES
   698*          PERFORM 1000-PROCESS     THRU 1000-EXIT
   699*       END-IF
   700*    ELSE
   701*       DISPLAY ' BYPASSING ' CO-CONTROL-PRIMARY (2:28)
   702*    END-IF
   703
   704     PERFORM 1200-READ-ERCOMP    THRU 1200-EXIT
   705
   706     .
   707 0500-EXIT.
   708     EXIT.
   709
   710 1000-PROCESS.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  14
* PEMCOF5.cbl
   711
   712     DISPLAY ' FIXING ' CO-CONTROL ' ' CO-TYPE ' '
   713        CO-STMT-OWNER ' KRHA '
   714     MOVE 'KRHA'                 TO CO-STMT-OWNER
   715     PERFORM 2100-REWRITE-ERCOMP THRU 2100-EXIT
   716
   717*    MOVE SPACES                 TO WS-WORK-CITY-ST
   718*    MOVE CO-ADDR-3              TO WS-HOLD-CITY-STATE
   719*
   720** CHECK FOR GUAM AND CHANGE TO GU **
   721*    PERFORM VARYING S1 FROM +26 BY -1 UNTIL
   722*       (S1 = +1)
   723*       OR (CO-ADDR-3 (S1:4) = 'GUAM')
   724*    END-PERFORM
   725*    IF CO-ADDR-3 (S1:4) = 'GUAM'
   726*       MOVE 'GU  '              TO CO-ADDR-3 (S1:4)
   727*       DISPLAY ' FIXED GUAM ' WS-HOLD-CITY-STATE ' '
   728*          CO-ADDR-3
   729*       MOVE CO-ADDR-3           TO WS-HOLD-CITY-STATE
   730*    END-IF
   731*
   732*    PERFORM VARYING S1 FROM +29 BY -1 UNTIL
   733*       (CO-ADDR-3 (S1:1) NOT = SPACE AND '.')
   734*       OR (S1 = +1)
   735*    END-PERFORM
   736*    IF S1 > 3
   737*       SUBTRACT +1 FROM S1
   738*       MOVE CO-ADDR-3 (S1:2)
   739*                                TO WS-WORK-STATE
   740*       SUBTRACT +1 FROM S1
   741*       PERFORM VARYING S1 FROM S1 BY -1 UNTIL
   742*          CO-ADDR-3 (S1:1) NOT = SPACE
   743*       END-PERFORM
   744*       IF S1 > 2
   745*          IF CO-ADDR-3 (S1:1) = ',' OR ';' OR '.'
   746*             MOVE CO-ADDR-3 (1:S1 - 1) TO WS-WORK-CITY
   747*          ELSE
   748*             MOVE CO-ADDR-3 (1:S1) TO WS-WORK-CITY
   749*          END-IF
   750*       END-IF
   751*       MOVE SPACE               TO WS-STATE-SW
   752*       PERFORM 1500-EDIT-STATE  THRU 1500-EXIT
   753*       IF VALID-STATE
   754*          MOVE WS-WORK-CITY     TO CO-ADDR-CITY
   755*          MOVE WS-WORK-STATE    TO CO-ADDR-STATE
   756*          PERFORM 2100-REWRITE-ERCOMP
   757*                                THRU 2100-EXIT
   758*       ELSE
   759*          DISPLAY 'INVALID STATE CODE: ' WS-WORK-STATE
   760*             ' ' WS-HOLD-CITY-STATE ' ' CO-CONTROL-PRIMARY (2:28)
   761*       END-IF
   762*    ELSE
   763*       DISPLAY ' WEIRD CITY STATE ' CO-CONTROL-PRIMARY (2:28)
   764*          ' ' CO-ADDR-3
   765*    END-IF
   766
   767     .
   768 1000-EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  15
* PEMCOF5.cbl
   769     EXIT.
   770
   771 1100-START-ERCOMP.
   772
   773     MOVE LOW-VALUES             TO CO-CONTROL-PRIMARY
   774     MOVE X'04'                  TO CO-COMPANY-CD
   775
   776     START ERCOMP KEY IS NOT <
   777                      CO-CONTROL-PRIMARY
   778     IF ERCOMP-FILE-STATUS NOT = '00'
   779        DISPLAY ' ERCOMP, BAD START '
   780              ERCOMP-FILE-STATUS
   781        PERFORM 9999-ABEND-RTN
   782     END-IF
   783
   784     .
   785 1100-EXIT.
   786     EXIT.
   787
   788 1200-READ-ERCOMP.
   789
   790     READ ERCOMP NEXT RECORD
   791
   792     IF (ERCOMP-FILE-STATUS = '10' OR '23')
   793        OR (CO-COMPANY-CD > X'04')
   794        SET END-OF-ERCOMP TO TRUE
   795     ELSE
   796        IF ERCOMP-FILE-STATUS NOT = '00'
   797           DISPLAY 'ERCOMP, BAD READ NEXT '
   798                ERCOMP-FILE-STATUS
   799           PERFORM 9999-ABEND-RTN
   800        ELSE
   801           ADD 1              TO WS-ERCOMP-RECS-IN
   802        END-IF
   803     END-IF
   804
   805     .
   806 1200-EXIT.
   807     EXIT.
   808
   809 1500-EDIT-STATE.
   810
   811     SEARCH ALL STATE-TABLE AT END
   812        ADD 1 TO WS-INVALID-ST-CNT
   813        WHEN ST-STATE (ST-INDEX) = WS-WORK-STATE
   814           SET VALID-STATE TO TRUE
   815     END-SEARCH
   816
   817     .
   818 1500-EXIT.
   819     EXIT.
   820
   821 2100-REWRITE-ERCOMP.
   822
   823*    DISPLAY ' OLD ' WS-HOLD-CITY-STATE ' NEW ' WS-WORK-CITY-ST
   824     REWRITE COMPENSATION-MASTER
   825*    MOVE '00' TO ERCOMP-FILE-STATUS
   826
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  16
* PEMCOF5.cbl
   827     IF ERCOMP-FILE-STATUS = '00'
   828         ADD 1                   TO WS-ERCOMP-RECS-FIX
   829     ELSE
   830         DISPLAY 'ERCOMP, BAD REWRITE '
   831         DISPLAY '*** STATUS CODE IS ' ERCOMP-FILE-STATUS
   832         PERFORM 9999-ABEND-RTN
   833     END-IF
   834
   835     .
   836 2100-EXIT.
   837     EXIT.
   838
   839 2200-DELETE-ERCOMP.
   840
   841     DELETE  ERCOMP
   842
   843     IF ERCOMP-FILE-STATUS = '00'
   844         ADD 1                   TO WS-ERCOMP-RECS-DEL
   845     ELSE
   846         DISPLAY 'ERCOMP, BAD DELETE  '
   847         DISPLAY '*** STATUS CODE IS ' ERCOMP-FILE-STATUS
   848         PERFORM 9999-ABEND-RTN
   849     END-IF
   850
   851     .
   852 2200-EXIT.
   853     EXIT.
   854
   855 3000-CLOSE-FILES.
   856
   857     CLOSE ERCOMP
   858
   859     .
   860 3000-EXIT.
   861     EXIT.
   862
   863 4000-FINAL-TOTALS.
   864
   865     DISPLAY '**************************************************'
   866     DISPLAY '***                                            ***'
   867
   868     MOVE WS-ERCOMP-RECS-IN      TO WS-DISPLAY-CNT
   869     DISPLAY '***  ERCOMP RECORDS   IN         = ' WS-DISPLAY-CNT
   870
   871     MOVE WS-ERCOMP-RECS-FIX     TO WS-DISPLAY-CNT
   872     DISPLAY '***  ERCOMP RECORDS   FIXED      = ' WS-DISPLAY-CNT
   873
   874     MOVE WS-INVALID-ST-CNT      TO WS-DISPLAY-CNT
   875     DISPLAY '***  INVALID STATES              = ' WS-DISPLAY-CNT
   876
   877     MOVE WS-ERCOMP-RECS-DEL     TO WS-DISPLAY-CNT
   878     DISPLAY '***  ERCOMP RECORDS   DELETED    = ' WS-DISPLAY-CNT
   879
   880     DISPLAY '***                                            ***'
   881     DISPLAY '**************************************************'
   882
   883     .
   884 4000-EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  17
* PEMCOF5.cbl
   885     EXIT.
   886
   887 8510-DATE-CONVERSION.
   888
   889     CALL 'ELDATCX' USING DATE-CONVERSION-DATA
   890
   891     .
   892 8590-EXIT.
   893     EXIT.
   894
   895 9999-ABEND-RTN.
   896
   897     DISPLAY '*** ERCOMP  FILE CONVERSION PROGRAM ABENDING ***'
   898     DISPLAY '************************************************'
   899
   900     MOVE 1                      TO WS-ABEND-FLD
   901     MOVE 0                      TO WS-ZERO-FLD
   902
   903     COMPUTE WS-ABEND-FLD = WS-ABEND-FLD / WS-ZERO-FLD
   904     .
   905 9999-EXIT.
   906     EXIT.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:        5612     Code:        1632
