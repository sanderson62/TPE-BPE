* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   1
* ECS150.cbl
* Options: int("ECS150.int") anim csi verbose NOBOUND PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("ECS150.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"ebmlsfile" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" NOCHECKDIV NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"32" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"ECS150.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"ECS150.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR NOSTICKY-LINKAGE
*          NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"2" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                 ECS150.
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 01/01/97 16:27:55.
     7*             PROGRAM REVIEWED FOR YEAR 2000 COMPLIANCE
     8*                            VMOD=2.029.
     9*AUTHOR         LOGIC, INC.
    10*               DALLAS, TEXAS.
    11*DATE-COMPILED.
    12
    13*SECURITY.   *****************************************************
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   2
* ECS150.cbl
    14*            *                                                   *
    15*            *   THIS PROGRAM IS THE PROPERTY OF LOGIC, INC.     *
    16*            *                                                   *
    17*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
    18*            *   OF LOGIC, INC. IS EXPRESSLY PROHIBITED WITHOUT  *
    19*            *   THE PRIOR WRITTEN PERMISSION OF LOGIC INC.      *
    20*            *                                                   *
    21*            *****************************************************
    22
    23*REMARKS.
    24*        THIS PROGRAM PRODUCES THE EXTRACT RECORDS
    25*        NEEDED TO COMPLETE THE LIFE AND A/H ANNUAL REPORT.
    26*        DETAIL IS GENERATED IF REQUESTED.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   3
* ECS150.cbl
    28******************************************************************
    29*                   C H A N G E   L O G
    30*
    31* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    32*-----------------------------------------------------------------
    33*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    34* EFFECTIVE    NUMBER
    35*-----------------------------------------------------------------
    36* 012610 IR2010010700001   PEMA  CORRECT IN FORCE COUNT AND AMT
    37* 121510 CR2009120700001   PEMA  FORCE BEGINNING TOTALS TO MATCH ENDING
    38* 030612  CR2011120900003  AJRA  ADD AHL COMPANY CODE
    39* 062712    2012062600003  PEMA  ADD PROCESSING FOR AHL
    40* 121613 IR2013121000001   PEMA  CORRECT REMAMT RTN ON 0% APR
    41* 011615 CR2015011500001   PEMA  Add ability to process all REINCOS
    42******************************************************************
    43 ENVIRONMENT DIVISION.
    44 CONFIGURATION SECTION.
    45 INPUT-OUTPUT SECTION.
    46 FILE-CONTROL.
    47
    48     SELECT SORT-WORK        ASSIGN TO SYS001-UT-2314-S-SORTWK1.
    49     SELECT PRINT-FILE       ASSIGN TO SYS008-UR-1403-S-SYS008.
    50     SELECT CERT-FILE        ASSIGN TO SYS011-UT-2400-S-SYS011.
    51     SELECT REINS-EXTRACT-2  ASSIGN TO SYS012-UT-2400-S-SYS012.
    52     SELECT ERRTBL-IN        ASSIGN TO ERRTBLT
    53                             ORGANIZATION IS INDEXED
    54                             ACCESS IS DYNAMIC
    55                             FILE STATUS IS ERRTBL-FILE-STATUS
    56                             RECORD KEY IS RE-CONTROL-PRIMARY.
    57     SELECT ERACCTT          ASSIGN TO SYS010-FBA1-ERACCTT
    58                             ORGANIZATION IS INDEXED
    59                             ACCESS IS SEQUENTIAL
    60                             FILE STATUS IS ACCT-FILE-STATUS
    61                             RECORD KEY IS AM-CONTROL-PRIMARY.
    62     SELECT REINS-EXTRACT-1  ASSIGN TO SYS018-UT-2400-S-SYS018.
    63     SELECT DISK-DATE        ASSIGN TO SYS019-UT-2314-S-SYS019.
    64     SELECT FICH             ASSIGN TO SYS020-UT-2400-S-SYS020.
    65     SELECT CLAS150-A-EXTRACT ASSIGN TO SYS021-UT-2400-S-SYS021.
    66     SELECT CLAS150-B-EXTRACT ASSIGN TO SYS022-UT-2400-S-SYS022.
    67     SELECT CLAS150-C-EXTRACT ASSIGN TO SYS023-UT-2400-S-SYS023.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   4
* ECS150.cbl
    69 DATA DIVISION.
    70 FILE SECTION.
    71
    72 SD  SORT-WORK.
    73*    RECORD CONTAINS 210 CHARACTERS
    74
    75 01  SORT-REC.
    76     12  SORT-KEY            PIC X(42).
    77     12  FILLER              PIC X(168).
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   5
* ECS150.cbl
    79 FD  PRINT-FILE
*   80                             COPY ELCPRTFD.
    81******************************************************************04/15/98
    82*                                                                *ELCPRTFD
    83*                                                                *ELCPRTFD
    84*                            ELCPRTFD.                           *   LV003
    85*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
    86*                            VMOD=2.006                          *ELCPRTFD
    87******************************************************************ELCPRTFD
    88     RECORDING MODE F                                             ELCPRTFD
    89     LABEL RECORDS OMITTED                                        ELCPRTFD
    90     BLOCK CONTAINS 0 RECORDS
    91     RECORD CONTAINS 133 CHARACTERS.                              ELCPRTFD
    92 01  PRT.                                                         ELCPRTFD
    93     12  P-CTL               PIC  X.                                 CL**2
    94     12  P-DATA              PIC  X(132).                         ELCPRTFD
    95******************************************************************ELCPRTFD
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   6
* ECS150.cbl
    97 FD  CERT-FILE
*   98                             COPY ECSCRIFD.
    99******************************************************************07/10/97
   100*                                                                *ECSCRIFD
   101*                            ECSCRIFD                            *   LV001
   102*                            VMOD 2.005                          *ECSCRIFD
   103*                                                                *ECSCRIFD
   104*  NO CID MODS FOR COPYBOOK ECSCRIFD                             *ECSCRIFD
   105*                                                                *ECSCRIFD
   106******************************************************************ECSCRIFD
   107     BLOCK CONTAINS 0 RECORDS
   108     RECORDING MODE F.                                            ECSCRIFD
   109                                                                  ECSCRIFD
   110 01  CERT-IN-RECORD.                                              ECSCRIFD
   111                                                                  ECSCRIFD
   112     12  FILLER                            PIC XXX.               ECSCRIFD
   113     12  CIR-CONTROL                       PIC X(36).             ECSCRIFD
   114     12  FILLER                            PIC X(66).             ECSCRIFD
   115     12  CIR-JOINT-AGE                     PIC 99.                ECSCRIFD
   116     12  FILLER                            PIC X(20).             ECSCRIFD
   117     12  CIR-LFTYP                         PIC XX.                ECSCRIFD
   118     12  FILLER                            PIC X(14).             ECSCRIFD
   119     12  CIR-LFAMT                         PIC S9(9)V99   COMP-3. ECSCRIFD
   120     12  FILLER                            PIC X(39).             ECSCRIFD
   121     12  CIR-LFRFND-CALC                   PIC S9(7)V99   COMP-3. ECSCRIFD
   122     12  FILLER                            PIC X(45).             ECSCRIFD
   123     12  CIR-AHTYP                         PIC XX.                ECSCRIFD
   124     12  FILLER                            PIC X(35).             ECSCRIFD
   125     12  CIR-AHRFND-CALC                   PIC S9(7)V99   COMP-3. ECSCRIFD
   126     12  FILLER                            PIC X(41).             ECSCRIFD
   127     12  CIR-APR                           PIC S999V9(4)  COMP-3. ECSCRIFD
   128     12  FILLER                            PIC X(48).             ECSCRIFD
   129     12  CIR-REIN-TABLE                    PIC XXX.               ECSCRIFD
   130     12  FILLER                            PIC X(9).              ECSCRIFD
   131     12  CIR-SUM-CAN-CNT-YTD               PIC S999       COMP-3. ECSCRIFD
   132     12  FILLER                            PIC X(120).            ECSCRIFD
   133     12  CIR-DTHAMT-YTD                    PIC S9(9)V99   COMP-3. ECSCRIFD
   134     12  FILLER                            PIC X(73).             ECSCRIFD
   135     12  CIR-DISAMT-YTD                    PIC S9(9)V99   COMP-3. ECSCRIFD
   136     12  FILLER                            PIC X(464).            ECSCRIFD
   137                                                                  ECSCRIFD
   138******************************************************************ECSCRIFD
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   7
* ECS150.cbl
   140 FD  REINS-EXTRACT-2
   141     BLOCK CONTAINS 0 RECORDS
   142     RECORDING MODE IS F.
   143*    RECORD CONTAINS 210 CHARACTERS
   144
   145 01  RC-REC-2.
   146     12  RC-CONTRAL-2        PIC  X(210).
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   8
* ECS150.cbl
   148 FD  ERRTBL-IN
*  149                             COPY ECSRTFDD.
   150******************************************************************07/10/97
   151*                                                                *ECSRTFDD
   152*                            ECSRTFDD                            *   LV001
   153*                            VMOD=2.001                          *ECSRTFDD
   154*                                                                *ECSRTFDD
   155*  NO  CID  MODS  IN  COPYBOOK  ECSRTFDD                         *ECSRTFDD
   156*                                                                *ECSRTFDD
   157******************************************************************ECSRTFDD
   158     LABEL RECORDS STANDARD                                       ECSRTFDD
   159     RECORD CONTAINS 4000 CHARACTERS.                             ECSRTFDD
   160                                                                  ECSRTFDD
   161 01  RT-REC                  PIC  X(4000).                        ECSRTFDD
   162******************************************************************ECSRTFDD
   163
*  164                             COPY ERCREIN.
   165******************************************************************07/27/93
   166*                                                                *ERCREIN
   167*                            ERCREIN                             *   LV009
   168*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   169*                            VMOD=2.010                          *   CL**9
   170*                                                                *ERCREIN
   171*   ONLINE CREDIT SYSTEM                                         *ERCREIN
   172*                                                                *ERCREIN
   173*   FILE DESCRIPTION = REINSURANCE MASTER FILE                   *ERCREIN
   174*                                                                *ERCREIN
   175*   FILE TYPE = VSAM,KSDS                                        *ERCREIN
   176*   RECORD SIZE = 4000  RECFORM = FIXED                          *ERCREIN
   177*                                                                *ERCREIN
   178*   BASE CLUSTER NAME = ERREIN                   RKP=2,LEN=8     *ERCREIN
   179*       ALTERNATE PATH = NONE                                    *ERCREIN
   180*                                                                *ERCREIN
   181*   LOG = NO                                                     *ERCREIN
   182*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *ERCREIN
   183*                                                                *ERCREIN
   184******************************************************************ERCREIN
   185*                   C H A N G E   L O G
   186*
   187* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   188*-----------------------------------------------------------------
   189*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   190* EFFECTIVE    NUMBER
   191*-----------------------------------------------------------------
   192* 103101    2001100100006  SMVA  ADD STATE EXHIBIT REPORT OPTION F
   193* 032707    2007032100006  PEMA  ADD EXCISE TAX CAPABILITY
   194******************************************************************
   195 01  REINSURANCE-RECORD.                                          ERCREIN
   196     12  RE-RECORD-ID                      PIC XX.                ERCREIN
   197         88  VALID-RE-ID                      VALUE 'RE'.         ERCREIN
   198                                                                  ERCREIN
   199     12  RE-CONTROL-PRIMARY.                                      ERCREIN
   200         16  RE-COMPANY-CD                 PIC X.                 ERCREIN
   201         16  RE-KEY.                                              ERCREIN
   202             20  RE-CODE                   PIC X.                 ERCREIN
   203                 88  RE-TABLE-RECORD          VALUE 'A'.          ERCREIN
   204                 88  RE-COMPANY-RECORD        VALUE 'B'.          ERCREIN
   205             20  RE-TABLE                  PIC XXX.               ERCREIN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   9
* ECS150.cbl (/apps/prod/cid1p/copy/ERCREIN)
   206             20  FILLER                    PIC XXX.               ERCREIN
   207         16  RE-COMPANY-KEY REDEFINES RE-KEY.                     ERCREIN
   208             20  FILLER                    PIC X.                 ERCREIN
   209             20  RE-COMPANY.                                      ERCREIN
   210                 24  RE-COMP-PRIME         PIC XXX.               ERCREIN
   211                 24  RE-COMP-SUB           PIC XXX.               ERCREIN
   212                                                                  ERCREIN
   213     12  RE-MAINT-INFORMATION.                                    ERCREIN
   214         16  RE-LAST-MAINT-DT              PIC XX.                ERCREIN
   215         16  RE-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3. ERCREIN
   216         16  RE-LAST-MAINT-USER            PIC X(4).              ERCREIN
   217         16  FILLER                        PIC X(10).             ERCREIN
   218                                                                  ERCREIN
   219     12  RE-TABLE-DATA.                                           ERCREIN
   220         16  RE-100-COMP                   PIC 99.                ERCREIN
   221                                                                  ERCREIN
   222         16  RE-COMP-INFO    OCCURS 30 TIMES.                     ERCREIN
   223             20  RE-REI-COMP-NO.                                  ERCREIN
   224                 24  RE-REI-COMP           PIC XXX.               ERCREIN
   225                 24  RE-REI-COMP-SUB       PIC XXX.               ERCREIN
   226             20  RE-LF-QC                  PIC X.                 ERCREIN
   227             20  RE-AH-QC                  PIC X.                 ERCREIN
   228             20  RE-LO-DATE                PIC 9(11)     COMP-3.  ERCREIN
   229             20  RE-HI-DATE                PIC 9(11)     COMP-3.  ERCREIN
   230             20  RE-LFAGE-LO               PIC 99.                ERCREIN
   231             20  RE-LFAGE-HI               PIC 99.                ERCREIN
   232             20  RE-AHAGE-LO               PIC 99.                ERCREIN
   233             20  RE-AHAGE-HI               PIC 99.                ERCREIN
   234             20  RE-LFTRM-LO               PIC S999       COMP-3. ERCREIN
   235             20  RE-LFTRM-HI               PIC S999       COMP-3. ERCREIN
   236             20  RE-AHTRM-LO               PIC S999       COMP-3. ERCREIN
   237             20  RE-AHTRM-HI               PIC S999       COMP-3. ERCREIN
   238             20  RE-LF-PCT                 PIC S9V9999    COMP-3. ERCREIN
   239             20  RE-AH-PCT                 PIC S9V9999    COMP-3. ERCREIN
   240             20  RE-LF-LIM-LO              PIC S9(9)V99   COMP-3. ERCREIN
   241             20  RE-LF-LIM-HI              PIC S9(9)V99   COMP-3. ERCREIN
   242             20  RE-LF-LO                  PIC S9(9)V99   COMP-3. ERCREIN
   243             20  RE-LF-HI                  PIC S9(9)V99   COMP-3. ERCREIN
   244             20  RE-AHBEN-LIM-LO           PIC S9(7)V99   COMP-3. ERCREIN
   245             20  RE-AHBEN-LIM-HI           PIC S9(7)V99   COMP-3. ERCREIN
   246             20  RE-AHBEN-LO               PIC S9(7)V99   COMP-3. ERCREIN
   247             20  RE-AHBEN-HI               PIC S9(7)V99   COMP-3. ERCREIN
   248             20  RE-AHMOA-LIM-LO           PIC S9(7)V99   COMP-3. ERCREIN
   249             20  RE-AHMOA-LIM-HI           PIC S9(7)V99   COMP-3. ERCREIN
   250             20  RE-AHMOA-LO               PIC S9(7)V99   COMP-3. ERCREIN
   251             20  RE-AHMOA-HI               PIC S9(7)V99   COMP-3. ERCREIN
   252             20  RE-LF-BEN-CODE            PIC X.                 ERCREIN
   253             20  RE-AH-BEN-CODE            PIC X.                 ERCREIN
   254             20  RE-INTERACTIVE            PIC X.                 ERCREIN
   255             20  RE-REMAINING              PIC X.                 ERCREIN
   256             20  RE-LF-RUNOFF-SW           PIC X.                      000
   257             20  RE-AH-RUNOFF-SW           PIC X.                      000
   258             20  FILLER                    PIC X(19).                  000
   259                                                                  ERCREIN
   260         16  RE-COMP-INFO-END              PIC X(6).              ERCREIN
   261         16  RE-NSP-ST-CD-LF               PIC XX.                ERCREIN
   262         16  RE-NSP-ST-CD-AH               PIC XX.                ERCREIN
   263         16  RE-TABLE-CARRIER-SECURITY     PIC X.                 ERCREIN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  10
* ECS150.cbl (/apps/prod/cid1p/copy/ERCREIN)
   264             88  NO-TABLE-CARRIER-SECURITY    VALUE SPACE.        ERCREIN
   265                                                                  ERCREIN
   266         16  FILLER                        PIC X(27).             ERCREIN
   267                                                                  ERCREIN
   268     12  RE-COMPANY-DATA   REDEFINES   RE-TABLE-DATA.             ERCREIN
   269         16  RE-NAME                       PIC X(30).             ERCREIN
   270         16  RE-LF-PE                      PIC X.                 ERCREIN
   271         16  RE-AH-PE                      PIC X.                 ERCREIN
   272         16  RE-LF-FEE                     PIC S9V9999    COMP-3. ERCREIN
   273         16  RE-AH-FEE                     PIC S9V9999    COMP-3. ERCREIN
   274         16  RE-AH-PR-PCT                  PIC S9V9999    COMP-3. ERCREIN
   275         16  RE-AH-78-PCT                  PIC S9V9999    COMP-3. ERCREIN
   276         16  RE-PRT-ST                     PIC X.                 ERCREIN
   277         16  RE-PRT-OW                     PIC X.                 ERCREIN
   278         16  RE-MORT-CODE                  PIC X(4).              ERCREIN
   279         16  RE-CLAIM-CODE                 PIC X.                 ERCREIN
   280         16  RE-ZERO-LF-FEE                PIC X.                 ERCREIN
   281         16  RE-ZERO-AH-FEE                PIC X.                 ERCREIN
   282         16  RE-CEDE-NAME                  PIC X(30).             ERCREIN
   283         16  RE-LF-COMM                    PIC X.                 ERCREIN
   284         16  RE-AH-COMM                    PIC X.                 ERCREIN
   285         16  RE-LF-TAX                     PIC X.                 ERCREIN
   286         16  RE-AH-TAX                     PIC X.                 ERCREIN
   287         16  RE-CLM-INCURRED-LIM           PIC 9(11)  COMP-3.     ERCREIN
   288         16  RE-LF-IBNR-PCT                PIC SV999      COMP-3. ERCREIN
   289         16  RE-AH-IBNR-PCT                PIC SV999      COMP-3. ERCREIN
   290                                                                  ERCREIN
   291         16  RE-COMP-CARRIER-SECURITY      PIC X.                 ERCREIN
   292             88  NO-COMP-CARRIER-SECURITY     VALUE SPACE.        ERCREIN
   293                                                                  ERCREIN
   294         16  RE-LF-CEDING-FEE-BRACKETS.                           ERCREIN
   295             20  RE-LF-FEE-METHOD          PIC X.                 ERCREIN
   296                 88  RE-LF-FEE-BRACKETED         VALUE '1' '2'.   ERCREIN
   297                 88  RE-LF-FEE-METHOD-1          VALUE '1'.       ERCREIN
   298                 88  RE-LF-FEE-METHOD-2          VALUE '2'.       ERCREIN
   299                 88  RE-LF-FEE-PERCENT           VALUE ' ' 'P'.   ERCREIN
   300             20  RE-LF-FEE-BASIS           PIC X.                 ERCREIN
   301                 88  RE-LF-GROSS-CEDED             VALUE '1'.     ERCREIN
   302                 88  RE-LF-NET-CEDED               VALUE '2'.     ERCREIN
   303                 88  RE-LF-GROSS-WRITTEN           VALUE '3'.     ERCREIN
   304                 88  RE-LF-NET-WRITTEN             VALUE '4'.     ERCREIN
   305                 88  RE-LF-COMBINE-GROSS-CEDED     VALUE '5'.     ERCREIN
   306                 88  RE-LF-COMBINE-NET-CEDED       VALUE '6'.     ERCREIN
   307                 88  RE-LF-COMBINE-GROSS-WRITTEN   VALUE '7'.     ERCREIN
   308                 88  RE-LF-COMBINE-NET-WRITTEN     VALUE '8'.     ERCREIN
   309             20  FILLER                    PIC XXX.               ERCREIN
   310             20  RE-LF-FEE-RANGES  OCCURS 6 TIMES.                ERCREIN
   311                 24  RE-LF-FEE-RANGE-PCT   PIC S9V9999    COMP-3. ERCREIN
   312                 24  RE-LF-FEE-THRU-AMT    PIC S9(7)V99   COMP-3. ERCREIN
   313                                                                  ERCREIN
   314         16  RE-AH-CEDING-FEE-BRACKETS.                           ERCREIN
   315             20  RE-AH-FEE-METHOD          PIC X.                 ERCREIN
   316                 88  RE-AH-FEE-BRACKETED         VALUE '1' '2'.   ERCREIN
   317                 88  RE-AH-FEE-METHOD-1          VALUE '1'.       ERCREIN
   318                 88  RE-AH-FEE-METHOD-2          VALUE '2'.       ERCREIN
   319                 88  RE-AH-FEE-PERCENT           VALUE ' ' 'P'.   ERCREIN
   320             20  RE-AH-FEE-BASIS           PIC X.                 ERCREIN
   321                 88  RE-AH-GROSS-CEDED             VALUE '1'.     ERCREIN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  11
* ECS150.cbl (/apps/prod/cid1p/copy/ERCREIN)
   322                 88  RE-AH-NET-CEDED               VALUE '2'.     ERCREIN
   323                 88  RE-AH-GROSS-WRITTEN           VALUE '3'.     ERCREIN
   324                 88  RE-AH-NET-WRITTEN             VALUE '4'.     ERCREIN
   325                 88  RE-AH-COMBINE-GROSS-CEDED     VALUE '5'.     ERCREIN
   326                 88  RE-AH-COMBINE-NET-CEDED       VALUE '6'.     ERCREIN
   327                 88  RE-AH-COMBINE-GROSS-WRITTEN   VALUE '7'.     ERCREIN
   328                 88  RE-AH-COMBINE-NET-WRITTEN     VALUE '8'.     ERCREIN
   329             20  FILLER                    PIC XXX.               ERCREIN
   330             20  RE-AH-FEE-RANGES  OCCURS 6 TIMES.                ERCREIN
   331                 24  RE-AH-FEE-RANGE-PCT   PIC S9V9999    COMP-3. ERCREIN
   332                 24  RE-AH-FEE-THRU-AMT    PIC S9(7)V99   COMP-3. ERCREIN
   333                                                                  ERCREIN
   334         16  RE-EARNING-START-DT           PIC 9(11)  COMP-3.     ERCREIN
   335                                                                  ERCREIN
   336         16  RE-OLD-CEDING-STMT            PIC X.                    CL**4
   337                                                                  ERCREIN
   338         16  RE-LF-CLM-PCT                 PIC S9V9999    COMP-3. ERCREIN
   339         16  RE-AH-CLM-PCT                 PIC S9V9999    COMP-3. ERCREIN
   340         16  RE-LF-CLM-MAX                 PIC S9(7)V99   COMP-3. ERCREIN
   341         16  RE-AH-CLM-MAX                 PIC S9(7)V99   COMP-3. ERCREIN
   342         16  RE-LF-PR-PCT                  PIC S9V9999    COMP-3. ERCREIN
   343         16  RE-LF-78-PCT                  PIC S9V9999    COMP-3. ERCREIN
   344         16  RE-REINS-GROUPING-CODE        PIC X(6).              ERCREIN
   345         16  RE-MORT-SW                    PIC X.                 ERCREIN
   346         16  RE-CEDING-TYPE-FLAG           PIC X.                    CL**2
   347             88  RE-NO-CESSION-TYPE                VALUE ' '.        CL**2
   348             88  RE-CEDED                          VALUE 'C'.        CL**2
   349             88  RE-ASSUMED                        VALUE 'A'.        CL**2
   350             88  RE-PHANTOM                        VALUE 'P'.        CL**2
   351                                                                  ERCREIN
   352         16  RE-CEDING-STMT-OPT-A          PIC X.                    CL**3
   353             88  REPORT-A-WANTED    VALUE ' ' 'Y'.                   CL**3
   354         16  RE-CEDING-STMT-OPT-B          PIC X.                    CL**3
   355             88  REPORT-B-WANTED    VALUE ' ' 'Y'.                   CL**3
   356         16  RE-CEDING-STMT-OPT-C          PIC X.                    CL**3
   357             88  REPORT-C-WANTED    VALUE ' ' 'Y'.                   CL**3
   358         16  RE-CEDING-STMT-OPT-D          PIC X.                    CL**3
   359             88  REPORT-D-WANTED    VALUE ' ' 'Y'.                   CL**3
   360         16  RE-CEDING-STMT-OPT-E          PIC X.                    CL**3
   361             88  REPORT-E-WANTED    VALUE ' ' 'Y'.                   CL**3
   362                                                                     CL**3
   363         16  RE-PRT-CRSV                   PIC X.                    CL**5
   364                                                                     CL**5
   365         16  RE-GL-CENTER                  PIC X(4).                 CL**6
   366                                                                     CL**8
   367         16  RE-CUSTODIAL-BAL              PIC S9(7)V99   COMP-3.    CL**8
   368                                                                     CL**8
   369         16  RE-EARNING-STOP-DT            PIC 9(11)  COMP-3.        CL**9
   370                                                                     CL**9
   371         16  RE-EARN-STOP-CODE             PIC X.                    CL**9
   372             88  STOP-LIFE-EARNING  VALUE 'L' 'B'.                   CL**9
   373             88  STOP-AH-EARNING    VALUE 'A' 'B'.                   CL**9
   374
   375         16  RE-STATE-EXHIBIT-OPT-F        PIC X.
   376             88  RPTF-ECS152-WANTED VALUE ' ' 'Y'.
   377                                                                     CL**9
   378         16  RE-EXCISE-TAX                 PIC S9V9999 COMP-3.
   379         16  FILLER                        PIC X(2281).              CL**9
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  12
* ECS150.cbl (/apps/prod/cid1p/copy/ERCREIN)
   380                                                                  ERCREIN
   381         16  RE-DESC OCCURS 18 TIMES       PIC X(79).             ERCREIN
   382                                                                  ERCREIN
   383******************************************************************ERCREIN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  13
* ECS150.cbl
   385 FD  ERACCTT.
*  386                             COPY ERCACCT.
   387******************************************************************04/19/98
   388*                                                                *ERCACCT
   389*                                                                *ERCACCT
   390*                            ERCACCT                             *   LV031
   391*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL*31
   392*                            VMOD=2.031                          *ERCACCT
   393*                                                                *ERCACCT
   394*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *ERCACCT
   395*                                                                *ERCACCT
   396*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *ERCACCT
   397*   VSAM ACCOUNT MASTER FILES.                                   *ERCACCT
   398*                                                                *ERCACCT
   399*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *ERCACCT
   400*                                                                *ERCACCT
   401*   FILE TYPE = VSAM,KSDS                                        *ERCACCT
   402*   RECORD SIZE = 2000  RECFORM = FIX                            *ERCACCT
   403*                                                                *ERCACCT
   404*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *ERCACCT
   405*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *ERCACCT
   406*                                                                *ERCACCT
   407*   LOG = NO                                                     *ERCACCT
   408*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *ERCACCT
   409*                                                                *ERCACCT
   410*                                                                *ERCACCT
   411******************************************************************ERCACCT
   412*                   C H A N G E   L O G
   413*
   414* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   415*-----------------------------------------------------------------
   416*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   417* EFFECTIVE    NUMBER
   418*-----------------------------------------------------------------
   419* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
   420* 092705    2005050300006  PEMA  ADD SPP LEASES
   421* 022808    2007083100002  PEMA  ADD FREEZE STATUS
   422* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
   423* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
   424* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
   425* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
   426******************************************************************
   427                                                                  ERCACCT
   428 01  ACCOUNT-MASTER.                                              ERCACCT
   429     12  AM-RECORD-ID                      PIC XX.                ERCACCT
   430         88  VALID-AM-ID                      VALUE 'AM'.         ERCACCT
   431                                                                  ERCACCT
   432     12  AM-CONTROL-PRIMARY.                                      ERCACCT
   433         16  AM-COMPANY-CD                 PIC X.                 ERCACCT
   434         16  AM-MSTR-CNTRL.                                       ERCACCT
   435             20  AM-CONTROL-A.                                    ERCACCT
   436                 24  AM-CARRIER            PIC X.                 ERCACCT
   437                 24  AM-GROUPING.                                 ERCACCT
   438                     28 AM-GROUPING-PREFIX PIC XXX.               ERCACCT
   439                     28 AM-GROUPING-PRIME  PIC XXX.               ERCACCT
   440                 24  AM-STATE              PIC XX.                ERCACCT
   441                 24  AM-ACCOUNT.                                  ERCACCT
   442                     28  AM-ACCOUNT-PREFIX PIC X(4).              ERCACCT
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  14
* ECS150.cbl (/apps/prod/cid1p/copy/ERCACCT)
   443                     28  AM-ACCOUNT-PRIME  PIC X(6).              ERCACCT
   444             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A            ERCACCT
   445                                           PIC X(19).             ERCACCT
   446             20  AM-CNTRL-B.                                      ERCACCT
   447                 24  AM-EXPIRATION-DT      PIC XX.                ERCACCT
   448                 24  FILLER                PIC X(4).              ERCACCT
   449             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.                 ERCACCT
   450                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.     ERCACCT
   451                                                                  ERCACCT
   452     12  AM-CONTROL-BY-VAR-GRP.                                   ERCACCT
   453         16  AM-COMPANY-CD-A1              PIC X.                 ERCACCT
   454         16  AM-VG-CARRIER                 PIC X.                 ERCACCT
   455         16  AM-VG-GROUPING                PIC X(6).              ERCACCT
   456         16  AM-VG-STATE                   PIC XX.                ERCACCT
   457         16  AM-VG-ACCOUNT                 PIC X(10).             ERCACCT
   458         16  AM-VG-DATE.                                          ERCACCT
   459             20  AM-VG-EXPIRATION-DT       PIC XX.                ERCACCT
   460             20  FILLER                    PIC X(4).              ERCACCT
   461         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE                  ERCACCT
   462                                           PIC 9(11)      COMP-3. ERCACCT
   463     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
   464         16  FILLER                        PIC X(10).
   465         16  AM-VG-KEY3.
   466             20  AM-VG3-ACCOUNT            PIC X(10).
   467             20  AM-VG3-EXP-DT             PIC XX.
   468         16  FILLER                        PIC X(4).
   469     12  AM-MAINT-INFORMATION.                                    ERCACCT
   470         16  AM-LAST-MAINT-DT              PIC XX.                ERCACCT
   471         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3. ERCACCT
   472         16  AM-LAST-MAINT-USER            PIC X(4).              ERCACCT
   473         16  FILLER                        PIC XX.                ERCACCT
   474                                                                  ERCACCT
   475     12  AM-EFFECTIVE-DT                   PIC XX.                ERCACCT
   476     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3. ERCACCT
   477                                                                  ERCACCT
   478     12  AM-PREV-DATES  COMP-3.                                   ERCACCT
   479         16  AM-PREV-EXP-DT                PIC 9(11).             ERCACCT
   480         16  AM-PREV-EFF-DT                PIC 9(11).             ERCACCT
   481                                                                  ERCACCT
   482     12  AM-REPORT-CODE-1                  PIC X(10).             ERCACCT
   483     12  AM-REPORT-CODE-2                  PIC X(10).             ERCACCT
   484                                                                  ERCACCT
   485     12  AM-CITY-CODE                      PIC X(4).              ERCACCT
   486     12  AM-COUNTY-PARISH                  PIC X(6).              ERCACCT
   487                                                                  ERCACCT
   488     12  AM-NAME                           PIC X(30).             ERCACCT
   489     12  AM-PERSON                         PIC X(30).             ERCACCT
   490     12  AM-ADDRS                          PIC X(30).             ERCACCT
   491     12  AM-CITY.
   492         16  AM-ADDR-CITY                  PIC X(28).
   493         16  AM-ADDR-STATE                 PIC XX.
   494     12  AM-ZIP.                                                  ERCACCT
   495         16  AM-ZIP-PRIME.                                        ERCACCT
   496             20  AM-ZIP-PRI-1ST            PIC X.                 ERCACCT
   497                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'. ERCACCT
   498             20  FILLER                    PIC X(4).              ERCACCT
   499         16  AM-ZIP-PLUS4                  PIC X(4).              ERCACCT
   500     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.              ERCACCT
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  15
* ECS150.cbl (/apps/prod/cid1p/copy/ERCACCT)
   501         16  AM-CAN-POSTAL-1               PIC XXX.               ERCACCT
   502         16  AM-CAN-POSTAL-2               PIC XXX.               ERCACCT
   503         16  FILLER                        PIC XXX.               ERCACCT
   504     12  AM-TEL-NO.                                               ERCACCT
   505         16  AM-AREA-CODE                  PIC 999.               ERCACCT
   506         16  AM-TEL-PRE                    PIC 999.               ERCACCT
   507         16  AM-TEL-NBR                    PIC 9(4).              ERCACCT
   508     12  AM-TEL-LOC                        PIC X.                 ERCACCT
   509         88  AM-TEL-AT-HOME                   VALUE 'H'.          ERCACCT
   510         88  AM-TEL-AT-BUSINESS               VALUE 'B'.          ERCACCT
   511                                                                  ERCACCT
   512     12  AM-COMM-STRUCTURE.                                       ERCACCT
   513         16  AM-DEFN-1.                                           ERCACCT
   514             20  AM-AGT-COMMS       OCCURS 10 TIMES.              ERCACCT
   515                 24  AM-AGT.                                      ERCACCT
   516                     28  AM-AGT-PREFIX     PIC X(4).              ERCACCT
   517                     28  AM-AGT-PRIME      PIC X(6).              ERCACCT
   518                 24  AM-COM-TYP            PIC X.                 ERCACCT
   519                 24  AM-L-COM              PIC SV9(5)     COMP-3. ERCACCT
   520                 24  AM-J-COM              PIC SV9(5)     COMP-3. ERCACCT
   521                 24  AM-A-COM              PIC SV9(5)     COMP-3. ERCACCT
   522                 24  AM-RECALC-LV-INDIC    PIC X.                 ERCACCT
   523                 24  AM-RETRO-LV-INDIC     PIC X.                 ERCACCT
   524                 24  AM-GL-CODES           PIC X.                 ERCACCT
   525                 24  AM-COMM-CHARGEBACK    PIC 9(02).             ERCACCT
   526                 24  FILLER                PIC X(01).             ERCACCT
   527         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.                   ERCACCT
   528             20  AM-COM-TBLS        OCCURS 10 TIMES.              ERCACCT
   529                 24  FILLER                PIC X(11).             ERCACCT
   530                 24  AM-L-COMA             PIC XXX.               ERCACCT
   531                 24  AM-J-COMA             PIC XXX.               ERCACCT
   532                 24  AM-A-COMA             PIC XXX.               ERCACCT
   533                 24  FILLER                PIC X(6).              ERCACCT
   534                                                                  ERCACCT
   535     12  AM-COMM-CHANGE-STATUS             PIC X.                 ERCACCT
   536         88  AM-COMMISSIONS-CHANGED           VALUE '*'.          ERCACCT
   537                                                                  ERCACCT
   538     12  AM-CSR-CODE                       PIC X(4).              ERCACCT
   539                                                                  ERCACCT
   540     12  AM-BILLING-STATUS                 PIC X.                 ERCACCT
   541         88  AM-ACCOUNT-BILLED                VALUE 'B'.          ERCACCT
   542         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.          ERCACCT
   543     12  AM-AUTO-REFUND-SW                 PIC X.                 ERCACCT
   544         88  AUTO-REFUNDS-USED                VALUE 'Y'.          ERCACCT
   545         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.      ERCACCT
   546     12  AM-GPCD                           PIC 99.                ERCACCT
   547     12  AM-IG                             PIC X.                 ERCACCT
   548         88  AM-HAS-INDIVIDUAL                VALUE '1'.          ERCACCT
   549         88  AM-HAS-GROUP                     VALUE '2'.          ERCACCT
   550     12  AM-STATUS                         PIC X.                 ERCACCT
   551         88  AM-ACCOUNT-ACTIVE                VALUE '0'.          ERCACCT
   552         88  AM-ACCOUNT-INACTIVE              VALUE '1'.          ERCACCT
   553         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.          ERCACCT
   554         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
   555         88  AM-ACCOUNT-FROZEN                VALUE '4'.
   556         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
   557     12  AM-REMIT-TO                       PIC 99.                ERCACCT
   558     12  AM-ID-NO                          PIC X(11).             ERCACCT
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  16
* ECS150.cbl (/apps/prod/cid1p/copy/ERCACCT)
   559                                                                  ERCACCT
   560     12  AM-CAL-TABLE                      PIC XX.                ERCACCT
   561     12  AM-LF-DEVIATION                   PIC XXX.               ERCACCT
   562     12  AM-AH-DEVIATION                   PIC XXX.               ERCACCT
   563     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3. ERCACCT
   564     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3. ERCACCT
   565     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3. ERCACCT
   566     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3. ERCACCT
   567     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3. ERCACCT
   568     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3. ERCACCT
   569                                                                  ERCACCT
   570     12  AM-USER-FIELDS.                                          ERCACCT
   571         16  AM-FLD-1                      PIC XX.                ERCACCT
   572         16  AM-FLD-2                      PIC XX.                ERCACCT
   573         16  AM-FLD-3                      PIC XX.                ERCACCT
   574         16  AM-FLD-4                      PIC XX.                ERCACCT
   575         16  AM-FLD-5                      PIC XX.                ERCACCT
   576                                                                  ERCACCT
   577     12  AM-1ST-PROD-DATE.                                        ERCACCT
   578         16  AM-1ST-PROD-YR                PIC XX.                ERCACCT
   579         16  AM-1ST-PROD-MO                PIC XX.                ERCACCT
   580         16  AM-1ST-PROD-DA                PIC XX.                ERCACCT
   581     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.     ERCACCT
   582     12  AM-CERTS-PURGED-DATE.                                    ERCACCT
   583         16  AM-PUR-YR                     PIC XX.                ERCACCT
   584         16  AM-PUR-MO                     PIC XX.                ERCACCT
   585         16  AM-PUR-DA                     PIC XX.                ERCACCT
   586     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.     ERCACCT
   587     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.     ERCACCT
   588     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.     ERCACCT
   589     12  AM-INACTIVE-DATE.                                        ERCACCT
   590         16  AM-INA-MO                     PIC 99.                ERCACCT
   591         16  AM-INA-DA                     PIC 99.                ERCACCT
   592         16  AM-INA-YR                     PIC 99.                ERCACCT
   593     12  AM-AR-HI-CERT-DATE                PIC XX.                ERCACCT
   594                                                                  ERCACCT
   595     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3. ERCACCT
   596     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3. ERCACCT
   597                                                                  ERCACCT
   598     12  AM-OB-PAYMENT-MODE                PIC X.                 ERCACCT
   599         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.      ERCACCT
   600         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.          ERCACCT
   601         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.          ERCACCT
   602         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.          ERCACCT
   603                                                                  ERCACCT
   604     12  AM-AH-ONLY-INDICATOR              PIC X.                 ERCACCT
   605         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.      ERCACCT
   606         88  AM-NO-AH-ONLY                    VALUE 'N'.          ERCACCT
   607                                                                  ERCACCT
   608     12  AM-EDIT-LOAN-OFC                  PIC X(01).             ERCACCT
   609                                                                  ERCACCT
   610     12  AM-OVER-SHORT.                                           ERCACCT
   611         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3. ERCACCT
   612         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3. ERCACCT
   613                                                                  ERCACCT
   614     12  AM-DCC-PRODUCT-CODE               PIC XXX.
   615     12  AM-DCC-CLP-STATE                  PIC XX.
   616                                                                  ERCACCT
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  17
* ECS150.cbl (/apps/prod/cid1p/copy/ERCACCT)
   617     12  AM-RECALC-COMM                    PIC X.                 ERCACCT
   618     12  AM-RECALC-REIN                    PIC X.                 ERCACCT
   619                                                                  ERCACCT
   620     12  AM-REI-TABLE                      PIC XXX.               ERCACCT
   621     12  AM-REI-ET-LF                      PIC X.                 ERCACCT
   622     12  AM-REI-ET-AH                      PIC X.                 ERCACCT
   623     12  AM-REI-PE-LF                      PIC X.                 ERCACCT
   624     12  AM-REI-PE-AH                      PIC X.                 ERCACCT
   625     12  AM-REI-PRT-ST                     PIC X.                 ERCACCT
   626     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3. ERCACCT
   627     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3. ERCACCT
   628     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3. ERCACCT
   629     12  AM-REI-GROUP-A                    PIC X(6).              ERCACCT
   630     12  AM-REI-MORT                       PIC X(4).              ERCACCT
   631     12  AM-REI-PRT-OW                     PIC X.                 ERCACCT
   632     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3. ERCACCT
   633     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3. ERCACCT
   634     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3. ERCACCT
   635     12  AM-REI-GROUP-B                    PIC X(6).              ERCACCT
   636                                                                  ERCACCT
   637     12  AM-TRUST-TYPE                     PIC X(2).              ERCACCT
   638                                                                  ERCACCT
   639     12  AM-EMPLOYER-STMT-USED             PIC X.                 ERCACCT
   640     12  AM-GROUPED-CHECKS-Y-N             PIC X.                 ERCACCT
   641                                                                  ERCACCT
   642     12  AM-STD-AH-TYPE                    PIC XX.                ERCACCT
   643     12  AM-EARN-METHODS.                                         ERCACCT
   644         16  AM-EARN-METHOD-R              PIC X.                 ERCACCT
   645             88 AM-REF-RL-R78                 VALUE 'R'.          ERCACCT
   646             88 AM-REF-RL-PR                  VALUE 'P'.          ERCACCT
   647             88 AM-REF-RL-MEAN                VALUE 'M'.          ERCACCT
   648             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.          ERCACCT
   649         16  AM-EARN-METHOD-L              PIC X.                 ERCACCT
   650             88 AM-REF-LL-R78                 VALUE 'R'.          ERCACCT
   651             88 AM-REF-LL-PR                  VALUE 'P'.          ERCACCT
   652             88 AM-REF-LL-MEAN                VALUE 'M'.          ERCACCT
   653             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.          ERCACCT
   654         16  AM-EARN-METHOD-A              PIC X.                 ERCACCT
   655             88 AM-REF-AH-R78                 VALUE 'R'.          ERCACCT
   656             88 AM-REF-AH-PR                  VALUE 'P'.          ERCACCT
   657             88 AM-REF-AH-MEAN                VALUE 'M'.          ERCACCT
   658             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.          ERCACCT
   659             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.          ERCACCT
   660             88 AM-REF-AH-NET                 VALUE 'N'.          ERCACCT
   661                                                                  ERCACCT
   662     12  AM-TOL-PREM                       PIC S999V99    COMP-3. ERCACCT
   663     12  AM-TOL-REF                        PIC S999V99    COMP-3. ERCACCT
   664     12  AM-TOL-CLM                        PIC S999V99    COMP-3. ERCACCT
   665                                                                  ERCACCT
   666     12  AM-RET-Y-N                        PIC X.                 ERCACCT
   667     12  AM-RET-P-E                        PIC X.                 ERCACCT
   668     12  AM-LF-RET                         PIC S9V9999    COMP-3. ERCACCT
   669     12  AM-AH-RET                         PIC S9V9999    COMP-3. ERCACCT
   670     12  AM-RET-GRP                        PIC X(6).              ERCACCT
   671     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.                    ERCACCT
   672         16  AM-POOL-PRIME                 PIC XXX.               ERCACCT
   673         16  AM-POOL-SUB                   PIC XXX.               ERCACCT
   674     12  AM-RETRO-EARNINGS.                                       ERCACCT
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  18
* ECS150.cbl (/apps/prod/cid1p/copy/ERCACCT)
   675         16  AM-RET-EARN-R                 PIC X.                 ERCACCT
   676         16  AM-RET-EARN-L                 PIC X.                 ERCACCT
   677         16  AM-RET-EARN-A                 PIC X.                 ERCACCT
   678     12  AM-RET-ST-TAX-USE                 PIC X.                 ERCACCT
   679         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.  ERCACCT
   680         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.      ERCACCT
   681     12  AM-RETRO-BEG-EARNINGS.                                   ERCACCT
   682         16  AM-RET-BEG-EARN-R             PIC X.                 ERCACCT
   683         16  AM-RET-BEG-EARN-L             PIC X.                 ERCACCT
   684         16  AM-RET-BEG-EARN-A             PIC X.                 ERCACCT
   685     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3. ERCACCT
   686     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3. ERCACCT
   687                                                                  ERCACCT
   688     12  AM-USER-SELECT-OPTIONS.                                  ERCACCT
   689         16  AM-USER-SELECT-1              PIC X(10).             ERCACCT
   690         16  AM-USER-SELECT-2              PIC X(10).             ERCACCT
   691         16  AM-USER-SELECT-3              PIC X(10).             ERCACCT
   692         16  AM-USER-SELECT-4              PIC X(10).             ERCACCT
   693         16  AM-USER-SELECT-5              PIC X(10).             ERCACCT
   694                                                                  ERCACCT
   695     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3. ERCACCT
   696                                                                  ERCACCT
   697     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3. ERCACCT
   698                                                                  ERCACCT
   699     12  AM-RPT045A-SWITCH                 PIC X.                 ERCACCT
   700         88  RPT045A-OFF                   VALUE 'N'.             ERCACCT
   701                                                                  ERCACCT
   702     12  AM-INSURANCE-LIMITS.                                     ERCACCT
   703         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3. ERCACCT
   704         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3. ERCACCT
   705                                                                  ERCACCT
   706     12  AM-PROFILE-CHANGE-SWITCH          PIC X.                 ERCACCT
   707         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.          ERCACCT
   708                                                                  ERCACCT
   709     12  AM-DISMBR-COVERAGE-SW             PIC X.                 ERCACCT
   710         88  AM-DISMBR-COVERAGE               VALUE 'Y'.          ERCACCT
   711         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.          ERCACCT
   712                                                                  ERCACCT
   713     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3. ERCACCT
   714                                                                  ERCACCT
   715     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3. ERCACCT
   716     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
   717     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
   718     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
   719     12  AM-DCC-UEF-STATE                  PIC XX.
   720     12  FILLER                            PIC XXX.
   721     12  AM-REPORT-CODE-3                  PIC X(10).
   722*    12  FILLER                            PIC X(22).             ERCACCT
   723                                                                  ERCACCT
   724     12  AM-RESERVE-DATE.                                         ERCACCT
   725         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.    ERCACCT
   726         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.    ERCACCT
   727         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.    ERCACCT
   728                                                                  ERCACCT
   729     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.                ERCACCT
   730     12  AM-NOTIFICATION-TYPES.                                   ERCACCT
   731         16  AM-NOTIF-OF-LETTERS           PIC X.                 ERCACCT
   732         16  AM-NOTIF-OF-PAYMENTS          PIC X.                 ERCACCT
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  19
* ECS150.cbl (/apps/prod/cid1p/copy/ERCACCT)
   733         16  AM-NOTIF-OF-REPORTS           PIC X.                 ERCACCT
   734         16  AM-NOTIF-OF-STATUS            PIC X.                 ERCACCT
   735                                                                  ERCACCT
   736     12  AM-BENEFIT-TABLE-USAGE            PIC X.                 ERCACCT
   737         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.          ERCACCT
   738         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.          ERCACCT
   739         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.          ERCACCT
   740         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.     ERCACCT
   741                                                                  ERCACCT
   742     12  AM-BENEFIT-CONTROLS.                                     ERCACCT
   743         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.            ERCACCT
   744             20  AM-BENEFIT-CODE           PIC XX.                ERCACCT
   745             20  AM-BENEFIT-TYPE           PIC X.                 ERCACCT
   746             20  AM-BENEFIT-REVISION       PIC XXX.               ERCACCT
   747             20  AM-BENEFIT-REM-TERM       PIC X.                 ERCACCT
   748             20  AM-BENEFIT-RETRO-Y-N      PIC X.                 ERCACCT
   749             20  FILLER                    PIC XX.                ERCACCT
   750         16  FILLER                        PIC X(80).             ERCACCT
   751                                                                  ERCACCT
   752     12  AM-TRANSFER-DATA.                                        ERCACCT
   753         16  AM-TRANSFERRED-FROM.                                 ERCACCT
   754             20  AM-TRNFROM-CARRIER        PIC X.                 ERCACCT
   755             20  AM-TRNFROM-GROUPING.                             ERCACCT
   756                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.               ERCACCT
   757                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.               ERCACCT
   758             20  AM-TRNFROM-STATE          PIC XX.                ERCACCT
   759             20  AM-TRNFROM-ACCOUNT.                              ERCACCT
   760                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).             ERCACCT
   761                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).              ERCACCT
   762             20  AM-TRNFROM-DTE            PIC XX.                ERCACCT
   763         16  AM-TRANSFERRED-TO.                                   ERCACCT
   764             20  AM-TRNTO-CARRIER          PIC X.                 ERCACCT
   765             20  AM-TRNTO-GROUPING.                               ERCACCT
   766                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.               ERCACCT
   767                 24  AM-TRNTO-GRP-PRIME    PIC XXX.               ERCACCT
   768             20  AM-TRNTO-STATE            PIC XX.                ERCACCT
   769             20  AM-TRNTO-ACCOUNT.                                ERCACCT
   770                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).              ERCACCT
   771                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).              ERCACCT
   772             20  AM-TRNTO-DTE              PIC XX.                ERCACCT
   773         16  FILLER                        PIC X(10).             ERCACCT
   774                                                                  ERCACCT
   775     12  AM-SAVED-REMIT-TO                 PIC 99.                ERCACCT
   776                                                                  ERCACCT
   777     12  AM-COMM-STRUCTURE-SAVED.                                 ERCACCT
   778         16  AM-DEFN-1-SAVED.                                     ERCACCT
   779             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.           ERCACCT
   780                 24  AM-AGT-SV             PIC X(10).             ERCACCT
   781                 24  AM-COM-TYP-SV         PIC X.                 ERCACCT
   782                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3. ERCACCT
   783                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3. ERCACCT
   784                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3. ERCACCT
   785                 24  AM-RECALC-LV-INDIC-SV PIC X.                 ERCACCT
   786                 24  FILLER                PIC X.                 ERCACCT
   787                 24  AM-GL-CODES-SV        PIC X.                 ERCACCT
   788                 24  AM-COM-CHARGEBACK-SV  PIC 99.                ERCACCT
   789                 24  FILLER                PIC X.                 ERCACCT
   790         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.       ERCACCT
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  20
* ECS150.cbl (/apps/prod/cid1p/copy/ERCACCT)
   791             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.            ERCACCT
   792                 24  FILLER                PIC X(11).             ERCACCT
   793                 24  AM-L-COMA-SV          PIC XXX.               ERCACCT
   794                 24  AM-J-COMA-SV          PIC XXX.               ERCACCT
   795                 24  AM-A-COMA-SV          PIC XXX.               ERCACCT
   796                 24  FILLER                PIC X(6).              ERCACCT
   797                                                                  ERCACCT
   798     12  AM-FLC-NET-PREMIUM-ALLOWANCE.                            ERCACCT
   799         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.                 ERCACCT
   800            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3. ERCACCT
   801            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3. ERCACCT
   802            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3. ERCACCT
   803                                                                  ERCACCT
   804     12  AM-ORIG-DEALER-NO                 PIC X(10).             ERCACCT
   805     12  FILLER                            PIC X(120).            ERCACCT
   806                                                                  ERCACCT
   807     12  AM-ACCOUNT-EXECUTIVE-DATA.                               ERCACCT
   808         16  AM-CONTROL-NAME               PIC X(30).             ERCACCT
   809         16  AM-EXECUTIVE-ONE.                                    ERCACCT
   810             20  AM-EXEC1-NAME             PIC X(15).             ERCACCT
   811             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)       ERCACCT
   812                                                          COMP-3. ERCACCT
   813             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)       ERCACCT
   814                                                          COMP-3. ERCACCT
   815         16  AM-EXECUTIVE-TWO.                                    ERCACCT
   816             20  AM-EXEC2-NAME             PIC X(15).             ERCACCT
   817             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)       ERCACCT
   818                                                          COMP-3. ERCACCT
   819             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)       ERCACCT
   820                                                          COMP-3. ERCACCT
   821                                                                  ERCACCT
   822     12  AM-RETRO-ADDITIONAL-DATA.                                ERCACCT
   823         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3. ERCACCT
   824         16  AM-RETRO-PREM-P-E             PIC X.                 ERCACCT
   825         16  AM-RETRO-CLMS-P-I             PIC X.                 ERCACCT
   826         16  AM-RETRO-RET-BRACKET-LF.                             ERCACCT
   827             20  AM-RETRO-RET-METHOD-LF    PIC X.                 ERCACCT
   828                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.      ERCACCT
   829                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.          ERCACCT
   830             20  AM-RETRO-RET-BASIS-LF     PIC X.                 ERCACCT
   831                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.      ERCACCT
   832                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.          ERCACCT
   833             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.           ERCACCT
   834                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3. ERCACCT
   835                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3. ERCACCT
   836         16  AM-RETRO-RET-BRACKET-AH.                             ERCACCT
   837             20  AM-RETRO-RET-METHOD-AH    PIC X.                 ERCACCT
   838                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.      ERCACCT
   839                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.          ERCACCT
   840                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.          ERCACCT
   841             20  AM-RETRO-RET-BASIS-AH     PIC X.                 ERCACCT
   842                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.      ERCACCT
   843                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.          ERCACCT
   844             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.           ERCACCT
   845                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3. ERCACCT
   846                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3. ERCACCT
   847                                                                  ERCACCT
   848     12  AM-COMMENTS.                                             ERCACCT
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  21
* ECS150.cbl (/apps/prod/cid1p/copy/ERCACCT)
   849         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.ERCACCT
   850                                                                  ERCACCT
   851     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.         ERCACCT
   852         16  AM-FLI-RETRO-SHARE-CODE       PIC X.                 ERCACCT
   853         16  AM-FLI-BILLING-CODE           PIC X.                 ERCACCT
   854         16  AM-FLI-ALT-STATE-CODE         PIC XX.                ERCACCT
   855         16  AM-FLI-UNITED-IDENT           PIC X.                 ERCACCT
   856         16  AM-FLI-INTEREST-LOST-DATA.                           ERCACCT
   857             20  AM-FLI-BANK-NO            PIC X(5).              ERCACCT
   858             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3. ERCACCT
   859             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3. ERCACCT
   860             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3. ERCACCT
   861         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.            ERCACCT
   862             20  AM-FLI-AGT                PIC X(9).              ERCACCT
   863             20  AM-FLI-AGT-COMM-ACC       PIC X.                 ERCACCT
   864             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3. ERCACCT
   865         16  FILLER                        PIC X(102).            ERCACCT
   866                                                                  ERCACCT
   867     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.         ERCACCT
   868         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.          ERCACCT
   869             20  AM-BENEFIT-DMD-CODE         PIC XX.              ERCACCT
   870             20  AM-BENEFIT-DMD-TYPE         PIC X.               ERCACCT
   871             20  AM-BENEFIT-DMD-REVISION     PIC XXX.             ERCACCT
   872             20  AM-BENEFIT-DMD-REM-TERM     PIC X.               ERCACCT
   873             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.               ERCACCT
   874         16  FILLER                          PIC X(10).           ERCACCT
   875******************************************************************ERCACCT
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  22
* ECS150.cbl
   877 FD  REINS-EXTRACT-1
   878     BLOCK CONTAINS 0 RECORDS
   879     RECORDING MODE IS F.
   880*    RECORD CONTAINS 210 CHARACTERS
   881
   882 01  RC-REC-1.
   883     12  RC-CONTRAL-1        PIC  X(210).
   884
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  23
* ECS150.cbl
   886 FD  DISK-DATE
*  887                             COPY ELCDTEFD.
   888******************************************************************04/15/98
   889*                                                                *ELCDTEFD
   890*                                                                *ELCDTEFD
   891*                            ELCDTEFD.                           *   LV002
   892*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
   893*                            VMOD=2.007                          *   CL**2
   894*                                                                *ELCDTEFD
   895******************************************************************ELCDTEFD
   896     BLOCK CONTAINS 0 RECORDS
   897     RECORDING MODE F.                                            ELCDTEFD
   898                                                                  ELCDTEFD
   899 01  DATE-DISK.                                                   ELCDTEFD
   900     12  DD-ID                       PIC  X(4).                   ELCDTEFD
   901     12  FILLER                      PIC  X(14).                  ELCDTEFD
   902     12  DD-CR1                      PIC  9.                      ELCDTEFD
   903     12  DD-CR1N                     PIC  X(30).                  ELCDTEFD
   904     12  DD-CR2                      PIC  9.                      ELCDTEFD
   905     12  DD-CR2N                     PIC  X(30).                  ELCDTEFD
   906     12  FILLER                      PIC  X(20).                  ELCDTEFD
   907                                                                  ELCDTEFD
   908 01  DATE-DISK-R.                                                 ELCDTEFD
   909     12  FILLER                      PIC  X(4).                   ELCDTEFD
   910     12  DD-ST           OCCURS 3 TIMES                           ELCDTEFD
   911                                     PIC  X(32).                  ELCDTEFD
   912                                                                  ELCDTEFD
   913 01  DATE-DISK-T.                                                 ELCDTEFD
   914     12  FILLER                      PIC  X(4).                   ELCDTEFD
   915     12  DD-TYPE         OCCURS 2 TIMES                           ELCDTEFD
   916                                     PIC  X(48).                  ELCDTEFD
   917                                                                  ELCDTEFD
   918 01  DATE-DISK-M.                                                 ELCDTEFD
   919     12  FILLER                      PIC  X(4).                   ELCDTEFD
   920     12  DD-MORT         OCCURS 2 TIMES                           ELCDTEFD
   921                                     PIC  X(48).                  ELCDTEFD
   922                                                                  ELCDTEFD
   923 01  DATE-DISK-P.                                                 ELCDTEFD
   924     12  DD-IDA                      PIC  XX.                     ELCDTEFD
   925     12  DD-IDX                      PIC  99.                     ELCDTEFD
   926     12  DD-DATA                     PIC  X(96).                  ELCDTEFD
   927     12  FILLER  REDEFINES DD-DATA.                               ELCDTEFD
   928         16  DD-PS-PIC   OCCURS 50 TIMES                          ELCDTEFD
   929                                     PIC  X.                      ELCDTEFD
   930         16  FILLER                  PIC  X(46).                  ELCDTEFD
   931     12  FILLER  REDEFINES DD-DATA.                               ELCDTEFD
   932         16  DD-PS-PICO  OCCURS 20 TIMES.                         ELCDTEFD
   933             20  DD-PS-PRT           PIC  X.                      ELCDTEFD
   934             20  DD-PS-FMT           PIC  X.                      ELCDTEFD
   935             20  DD-PS-PRC           PIC  X.                      ELCDTEFD
   936             20  DD-PS-TOT           PIC  X.                      ELCDTEFD
   937         16  FILLER                  PIC  X(16).                  ELCDTEFD
   938                                                                  ELCDTEFD
   939 01  DATE-DISK-E.                                                 ELCDTEFD
   940     12  FILLER                      PIC  X(4).                   ELCDTEFD
   941     12  DD-EDIT         OCCURS 24 TIMES                          ELCDTEFD
   942                                     PIC  X(4).                   ELCDTEFD
   943                                                                  ELCDTEFD
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  24
* ECS150.cbl (/apps/prod/cid1p/copy/ELCDTEFD)
   944 01  DATE-DISK-C.                                                 ELCDTEFD
   945     12  FILLER                      PIC  X(7).                   ELCDTEFD
   946     12  DD-CARR1-SECPAY-SW          PIC  X.
   947     12  DD-CARR1-UEP-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   948     12  DD-CARR1-R78-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   949     12  DD-CARR1-PRO-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   950     12  DD-CARR1                    PIC  X.                      ELCDTEFD
   951     12  DD-CARR1S                   PIC  XX.                     ELCDTEFD
   952     12  DD-CARR1N                   PIC  X(30).                  ELCDTEFD
   953     12  DD-CARR2                    PIC  X.                      ELCDTEFD
   954     12  DD-CARR2S                   PIC  XX.                     ELCDTEFD
   955     12  DD-CARR2N                   PIC  X(30).                  ELCDTEFD
   956     12  DD-CARR2-UEP-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   957     12  DD-CARR2-R78-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   958     12  DD-CARR2-PRO-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   959     12  DD-CARR2-SECPAY-SW          PIC  X.
   960     12  FILLER                      PIC  X(7).                   ELCDTEFD
   961                                                                  ELCDTEFD
   962 01  DATE-DISK-OPT.                                               ELCDTEFD
   963     12  FILLER                      PIC  X(04).                  ELCDTEFD
   964     12  DD-TLR-DATA.                                             ELCDTEFD
   965         16  DD-TLR                  OCCURS 32 TIMES              ELCDTEFD
   966                                     PIC  X(03).                  ELCDTEFD
   967     12  DD-STATE-DATA REDEFINES DD-TLR-DATA.                     ELCDTEFD
   968         16  DD-STATE-FLDS           OCCURS 16 TIMES              ELCDTEFD
   969                                     PIC  X(06).                  ELCDTEFD
   970     12  DD-CARR-DATA REDEFINES DD-TLR-DATA.                      ELCDTEFD
   971         16  DD-CARR-FLDS            OCCURS 13 TIMES              ELCDTEFD
   972                                     PIC  X(07).                  ELCDTEFD
   973         16  FILLER                  PIC  X(05).                  ELCDTEFD
   974     12  DD-MISC-DATA REDEFINES DD-TLR-DATA                       ELCDTEFD
   975                                     PIC  X(96).                  ELCDTEFD
   976******************************************************************ELCDTEFD
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  25
* ECS150.cbl
   978 FD  FICH
   979     RECORDING MODE IS F.
   980
   981 01  FICH-REC                PIC X(133).
   982
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  26
* ECS150.cbl
   984 FD  CLAS150-A-EXTRACT
   985     BLOCK CONTAINS 0 RECORDS
   986     RECORDING MODE IS F.
   987*    RECORD CONTAINS 2701 CHARACTERS
   988*
   989*  THIS EXTRACT FILE CONTAINS THE RECORDS
   990*  NEEDED TO PRINT THE CERTIFICATE ACTIVITY AND EXHIBIT
   991*  REPORT FOR THE 1ST INSURANCE COMPANY
   992*
   993*          ** RECORD TYPE AND SORT KEY DESCRIPTION **
   994******** SORT KEY ***************   ******** USAGE *********
   995*TYPE*CARR*COMP*STATE*ACCT*STATE*
   996* 01 * X  *  X *  X  * X  * LV  * - ACCT TOTAL-1ST INS.
   997* 02 * X  *  X *  X  * X  * LV  * - ACCT TOTAL-REINS
   998* 03 * X  *  X *  X  * HV * LV  * - ST TOT-1ST INS
   999* 04 * X  *  X *  X  * HV * LV  * - ST TOT-REINS
  1000* 05 * X  *  X *  HV * HV * LV  * - ST TOT-1ST,ACCUM FOR CO TOTAL
  1001* 06 * X  *  X *  HV * HV * LV  * - ST TOT-REINS,ACCUM FOR CO TOT
  1002* 07 * X  * HV *  X  * HV * LV  * - ST TOT-1ST,ACCUM FOR ST/CARR
  1003* 08 * X  * HV *  X  * HV * LV  * - ST TOT-REIN,ACCUM FOR ST/CARR
  1004* 09 * X  * HV *  HV * HV * LV  * - ST TOT-1ST,ACCUM FOR CARR TOT
  1005* 10 * X  * HV *  HV * HV * LV  * - ST TOT-REIN,ACCUM FOR CARR TOT
  1006* 11 * HV * HV *  HV * HV * LV  * - ST TOT-1ST,ACCUM FOR GRND TOT
  1007* 12 * HV * HV *  HV * HV * LV  * - ST TOT-REIN,ACCUM FOR GRND TOT
  1008* 13 * HV * HV *  HV * HV *  X  * - ST TOT-1ST,ACCUM FOR ST TOTAL
  1009* 14 * HV * HV *  HV * HV *  X  * - ST TOT-REIN,ACCUM FOR ST TOTAL
  1010*
  1011* X-INDICATES FIELD INITIALIZED WITH ACTUAL VALUE
  1012* LV - INDICATES FIELD WILL CONTAIN LOW-VALUE
  1013* HV - INDICATES FIELD WILL CONTAIN HIGH-VALUE
  1014*
  1015***NOTE - FIELD ER-REINS-CO IS SET TO LOW-VALUE FOR ALL RECORDS
  1016*         IN THIS FILE SINCE IT IS NOT USED FOR THIS REPORT
  1017
  1018 01  CLAS150-EXTRACT-RECORD-A    PIC X(2701).
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  27
* ECS150.cbl
  1020 FD  CLAS150-B-EXTRACT
  1021     BLOCK CONTAINS 0 RECORDS
  1022     RECORDING MODE IS F.
  1023*    RECORD CONTAINS 2701 CHARACTERS
  1024*
  1025*  THIS FILE CONTAINS THE RECORDS NEEDED TO
  1026*  PRINT THE CERTIFICATE ACTIVITY AND EXHIBIT
  1027*  REPORT FOR THE REINSURANCE COMPANY WITH THE
  1028*  EXCEPTION OF OVER STATE TOTALS.
  1029*
  1030*          ** RECORD TYPE AND SORT KEY DESCRIPTION **
  1031******* SORT KEY *********
  1032*RE-CO*CARR*COMP*STATE*ACCT*STATE*TYPE*
  1033*  X  * X  *  X *  X  * X  * LV  * 15 *   ACCT TOTAL
  1034*  X  * X  *  X *  X  * LV * LV  * 16 *   STATE TOTAL
  1035*  X  * X  *  X *  LV * LV * LV  * 17 *   COMPANY TOTAL
  1036*  X  * X  * LV *  LV * LV * LV  * 18 *   CARRIER TOTAL
  1037*  X  * LV * LV *  LV * LV * LV  * 19 *   REINS CO TOTAL
  1038*     *    *    *     *    *     *    *
  1039* X= INITIALIZED TO ACTUAL VALUE       * TOTAL RECORD TYPE 19
  1040* LV = INITIALIZED TO LOW-VALUE          FOR GRAND TOTALS
  1041
  1042 01  CLAS150-EXTRACT-RECORD-B    PIC X(2701).
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  28
* ECS150.cbl
  1044 FD  CLAS150-C-EXTRACT
  1045     BLOCK CONTAINS 0 RECORDS
  1046     RECORDING MODE IS F.
  1047*    RECORD CONTAINS 2701 CHARACTERS
  1048*
  1049*    THIS FILE CONTAINS THE RECORDS NEEDED TO PRINT
  1050*    THE REINSURANCE COMPANY - CERTIFICATE AND EXHIBIT
  1051*    REPORT - AT THE STATE LEVEL.
  1052*
  1053*    ALL RECORDS IN THIS FILE ARE TYPE 20
  1054*    ALL CONTROL FIELDS IN THE SORT KEY ARE SET TO
  1055*     LOW-VALUE WITH THE EXCEPTION OF THE STATE AND TYPE
  1056*     FIELDS.
  1057*
  1058*
  1059
  1060 01  CLAS150-EXTRACT-RECORD-C    PIC X(2701).
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  29
* ECS150.cbl
  1062 WORKING-STORAGE SECTION.
  1063 01  LCP-ABND-CODE                 PIC S999 COMP VALUE +519.
  1064 77  FILLER  PIC X(32) VALUE '********************************'.
  1065 77  FILLER  PIC X(32) VALUE '     ECS150 WORKING STORAGE     '.
  1066 77  FILLER  PIC X(32) VALUE '******* VMOD=2.029 *************'.
  1067
  1068
  1069 77  LINE-CNT                PIC S9(3)      COMP-3 VALUE +56.
  1070 77  FACTOR-C                PIC S9(3)      COMP-3 VALUE +0.
  1071 77  MINUS-CNT               PIC S9(3)      COMP-3 VALUE +0.
  1072 77  PAGE-CNT                PIC S9(5)      COMP-3 VALUE +0.
  1073 77  EXPIRED-MONTHS          PIC S9(5)      COMP-3 VALUE +0.
  1074 77  UNEXPIRED-MONTHS        PIC S9(3)V99   COMP-3 VALUE +0.
  1075 77  HOLD-PREV-UNEXP         PIC S9(5)      COMP-3 VALUE +0.
  1076 77  HOLD-PREV-EXP           PIC S9(5)      COMP-3 VALUE +0.
  1077 77  HOLD-END-UNEXP          PIC S9(5)      COMP-3 VALUE +0.
  1078 77  HOLD-END-EXP            PIC S9(5)      COMP-3 VALUE +0.
  1079 77  TERM-WORK               PIC S9(5)      COMP-3 VALUE +0.
  1080 77  REINS-REC-CNT           PIC S9(7)      COMP-3 VALUE +0.
  1081 77  EXB-CNT                 PIC S9(7)      COMP-3 VALUE ZERO.
  1082 77  FACTOR-A                PIC S9(4)V9(11) COMP-3 VALUE +0.
  1083 77  FACTOR-B                PIC S9(4)V9(11) COMP-3 VALUE +0.
  1084 77  WS-TOTAL-FACE-AMT       PIC S9(7)V99   COMP-3 VALUE +0.
  1085 77  UNEARNED-AMT-LF         PIC S9(7)V99   COMP-3 VALUE +0.
  1086 77  UNEARNED-AMT-AH         PIC S9(7)V99   COMP-3 VALUE +0.
  1087 77  SUMMARY-AMT-LF          PIC S9(9)V99   COMP-3 VALUE +0.
  1088 77  SUMMARY-AMT-AH          PIC S9(9)V99   COMP-3 VALUE +0.
  1089 77  MINUS-AMT               PIC S9(7)V99   COMP-3 VALUE +0.
  1090 77  TEMP-RESULT             PIC S9(9)V99   COMP-3 VALUE +0.
  1091 77  SAVE-BGN-INFORCE        PIC S9(9)V99   COMP-3 VALUE +0.
  1092 77  SAVE-END-INFORCE        PIC S9(9)V99   COMP-3 VALUE +0.
  1093 77  TEMP-RESULT-L           PIC S9(9)V9(6) COMP-3 VALUE +0.
  1094 77  SAVE-REM-TERM           PIC S9(3)V99   COMP-3 VALUE +0.
  1095 77  X                       PIC X                 VALUE SPACE.
  1096 77  ERRTBL-FILE-STATUS      PIC XX              VALUE '00'.
  1097 77  ACCT-FILE-STATUS        PIC XX              VALUE '00'.
  1098 77  ws-override-option          pic xxx value spaces.
  1099     88  process-all-rein-companies  value 'ALL'.
  1100
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  30
* ECS150.cbl
  1102 01  WORK-AREAS.
  1103     12  sub3                       pic s9(5) value +0 comp-3.
  1104     12  WS-ZERO                    PIC S9     VALUE +0 COMP-3.
  1105     12  WS-RETURN-CODE             PIC S9(4)  VALUE +0 COMP-3.
  1106     12  WS-ABEND-MESSAGE           PIC X(80)  VALUE SPACES.
  1107     12  WS-ABEND-FILE-STATUS       PIC XX     VALUE ZERO.
  1108     12  INTERIM-YR                 PIC 99     VALUE 0.
  1109     12  WS-931231                  PIC XX     VALUE X'8CFF'.
  1110     12  WS-CR-DIS-CCYY             PIC 9(04)  VALUE 0.
  1111     12  WS-CR-CCYY                 PIC 9(04)  VALUE 0.
  1112
  1113 01  FILLER PIC X(16)  VALUE 'CONTROL SWITCHES'.
  1114 01  PROGRAM-CNTRL-SWITCHES.
  1115     12  PASS-TYPE           PIC 9               VALUE 0.
  1116         88  FIRST-INS-PASS                      VALUE 0.
  1117         88  REINSURANCE-PASS                    VALUE 1.
  1118     12  INFORCE-CNT-SW      PIC 9               VALUE 0.
  1119     12  RECORD-TYPE-SW      PIC 9               VALUE 0.
  1120         88  FIRST-INS-REC                       VALUE 0.
  1121         88  REINSURANCE-REC                     VALUE 1.
  1122     12  EFFECTIVE-CONTROL   PIC 9               VALUE 0.
  1123         88  EFFECTIVE-LAST-PER                  VALUE 1.
  1124         88  EFFECTIVE-THIS-PER                  VALUE 2.
  1125         88  EFFECTIVE-BOTH-PER                  VALUE 3.
  1126     12  CERT-STATUS         PIC 9               VALUE 0.
  1127         88  CERT-ACTIVE                         VALUE 0.
  1128         88  CERT-CANCELLED                      VALUE 1.
  1129         88  CERT-CLAIM                          VALUE 2.
  1130         88  LUMP-SUM                            VALUE 3.
  1131         88  CLAIM-OR-CANCEL                     VALUE 1 2 3.
  1132     12  REINSURANCE-FOUND   PIC 9               VALUE 0.
  1133         88  NO-REINSURANCE                      VALUE 0.
  1134     12  OB-SW               PIC 9               VALUE 0.
  1135         88  OB-COVERAGE                         VALUE 1.
  1136     12  SUMMARY-SW          PIC 9               VALUE 0.
  1137         88  SUMMARY-REC                         VALUE 1.
  1138     12  COUNT-CNTRL         PIC 9               VALUE 0.
  1139         88  ALREADY-COUNTED                     VALUE 1.
  1140     12  NEW-IN-EFFECT       PIC 9               VALUE 0.
  1141         88  ENTERED-THIS-PERIOD                 VALUE 1.
  1142     12  OLD-IN-EFFECT       PIC 9               VALUE 0.
  1143         88  ENTERED-PREV-PERIOD                 VALUE 1.
  1144     12  PRINT-CNTRL         PIC 9               VALUE 0.
  1145         88  FIRST-DETAIL-DONE                   VALUE 1.
  1146     12  INS-TYPE-SW         PIC 9               VALUE 0.
  1147         88  INDIVIDUAL-INS                      VALUE 1.
  1148         88  GROUP-INS                           VALUE 2.
  1149     12  LIFE-INS-SW         PIC 9               VALUE 0.
  1150         88  LEVEL-LIFE                          VALUE 1.
  1151         88  REDUCING-LIFE                       VALUE 2.
  1152     12  CANCEL-SW           PIC 9               VALUE 0.
  1153         88  CURRENT-CANCEL-ONLY                 VALUE 1.
  1154     12  CLAIM-SW            PIC 9               VALUE 0.
  1155         88  CURRENT-CLAIM-ONLY                  VALUE 1.
  1156     12  REINS-FILE-SW       PIC 9               VALUE 0.
  1157         88  REINS-FILE-CLOSED                   VALUE 0.
  1158         88  REINS-FILE-OPEN                     VALUE 1.
  1159     12  TEXAS-REG-SW        PIC 9               VALUE 0.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  31
* ECS150.cbl
  1160         88  TEXAS-CERT                          VALUE 1.
  1161     12  NET-PAY-SW          PIC 9               VALUE 0.
  1162         88  NET-PAY-CERT                        VALUE 1.
  1163 01  FILLER PIC X(16)  VALUE 'PRINT   SWITCHES'.
  1164 01  PRINT-SWITCHES.
  1165     12  LF-REFUND-SW        PIC 9               VALUE 0.
  1166         88 PRT-LF-REFUND                        VALUE 1.
  1167     12  AH-REFUND-SW        PIC 9               VALUE 0.
  1168         88 PRT-AH-REFUND                        VALUE 1.
  1169     12  LF-ISSUE            PIC 9               VALUE 0.
  1170         88 PRT-LF-ISSUE                         VALUE 1.
  1171     12  LF-CANC             PIC 9               VALUE 0.
  1172         88 PRT-LF-CANC                          VALUE 1.
  1173     12  LF-DEATH            PIC 9               VALUE 0.
  1174         88 PRT-LF-DEATH                         VALUE 1.
  1175     12  LF-EXPIRY           PIC 9               VALUE 0.
  1176         88 PRT-LF-EXPIRY                        VALUE 1.
  1177     12  LF-DECR             PIC 9               VALUE 0.
  1178         88 PRT-LF-DECR                          VALUE 1.
  1179     12  LF-INCR             PIC 9               VALUE 0.
  1180         88 PRT-LF-INCR                          VALUE 1.
  1181     12  LF-LUMP             PIC 9               VALUE 0.
  1182         88 PRT-LF-LUMP                          VALUE 1.
  1183     12  AH-ISSUE            PIC 9               VALUE 0.
  1184         88 PRT-AH-ISSUE                         VALUE 1.
  1185     12  AH-CANC             PIC 9               VALUE 0.
  1186         88 PRT-AH-CANC                          VALUE 1.
  1187     12  AH-CLAIM            PIC 9               VALUE 0.
  1188         88 PRT-AH-CLAIM                         VALUE 1.
  1189 01  PRINT-AMOUNTS.
  1190     12  PRT-ISSUE-AMT-LF    PIC S9(11)V99 COMP-3   VALUE ZERO.
  1191     12  PRT-CANC-AMT-LF     PIC S9(11)V99 COMP-3   VALUE ZERO.
  1192     12  PRT-DEATH-AMT-LF    PIC S9(11)V99 COMP-3   VALUE ZERO.
  1193     12  PRT-EXPIRY-AMT-LF   PIC S9(11)V99 COMP-3   VALUE ZERO.
  1194     12  PRT-DECR-AMT-LF     PIC S9(11)V99 COMP-3   VALUE ZERO.
  1195     12  PRT-INCR-AMT-LF     PIC S9(11)V99 COMP-3   VALUE ZERO.
  1196     12  PRT-ISSUE-AMT-AH    PIC S9(11)V99 COMP-3   VALUE ZERO.
  1197     12  PRT-CANC-AMT-AH     PIC S9(11)V99 COMP-3   VALUE ZERO.
  1198     12  PRT-CLAIM-AMT-AH    PIC S9(11)V99 COMP-3   VALUE ZERO.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  32
* ECS150.cbl
  1200 01  RC-REC.
  1201     12  RC-CONTROL.
  1202         16  RC-COMP            PIC X(6).
  1203         16  RC-CMCTL.
  1204             20  RC-CNTRL-1     PIC X(19).
  1205             20  RC-CNTRL-2     PIC X(17).
  1206     12  RC-ENTRY-STATUS        PIC X.
  1207     12  RC-LFTYP               PIC XX.
  1208     12  RC-LF-TERM             PIC S9(3)       COMP-3.
  1209     12  RC-LFAMT               PIC S9(9)V99    COMP-3.
  1210     12  RC-LFPRM               PIC S9(7)V99    COMP-3.
  1211     12  RC-LFRFND              PIC S9(7)V99    COMP-3.
  1212     12  RC-LF-CANCEL-STATUS    PIC X.
  1213     12  RC-LF-CLAIM-STATUS     PIC X.
  1214     12  RC-LF-CURRENT-STATUS   PIC X.
  1215     12  RC-AHTYP               PIC XX.
  1216     12  RC-AH-TERM             PIC S9(3)       COMP-3.
  1217     12  RC-AHAMT               PIC S9(7)V99    COMP-3.
  1218     12  RC-AHPRM               PIC S9(7)V99    COMP-3.
  1219     12  RC-AHRFND              PIC S9(7)V99    COMP-3.
  1220     12  RC-AH-CANCEL-STATUS    PIC X.
  1221     12  RC-AH-CLAIM-STATUS     PIC X.
  1222     12  RC-AH-CURRENT-STATUS   PIC X.
  1223     12  RC-DTHAMT              PIC S9(9)V99    COMP-3.
  1224     12  RC-DISAMT              PIC S9(9)V99    COMP-3.
  1225     12  RC-IND-GRP             PIC X.
  1226     12  RC-LF-CANC-DT          PIC 9(11)       COMP-3.
  1227     12  RC-AH-CANC-DT          PIC 9(11)       COMP-3.
  1228     12  RC-DIS-DT              PIC 9(11)       COMP-3.
  1229     12  RC-ENT-DT              PIC 9(11)       COMP-3.
  1230     12  RC-LF-CANC-EXIT        PIC 9(11)       COMP-3.
  1231     12  RC-AH-CANC-EXIT        PIC 9(11)       COMP-3.
  1232     12  RC-LF-CLAIM-EXIT       PIC 9(11)       COMP-3.
  1233     12  RC-AH-CLAIM-EXIT       PIC 9(11)       COMP-3.
  1234     12  RC-PMT-FREQ            PIC 9(2).
  1235     12  RC-APR                 PIC S9(3)V9(4)  COMP-3.
  1236     12  RC-LOAN-TERM           PIC S9(3)       COMP-3.
  1237     12  RC-I-LIVES             PIC S9(3)       COMP-3.
  1238     12  RC-C-LIVES-YTD         PIC S9(3)       COMP-3.
  1239     12  RC-C-LIVES-ITD         PIC S9(3)       COMP-3.
  1240     12  RC-LFRFND-YTD          PIC S9(7)V99    COMP-3.
  1241     12  RC-AHRFND-YTD          PIC S9(7)V99    COMP-3.
  1242     12  RC-LF-TERM-IN-DAYS     PIC S9(5)       COMP-3.
  1243     12  RC-LF-EXPIRE-DT        PIC 9(11)       COMP-3.
  1244     12  RC-AH-EXPIRE-DT        PIC 9(11)       COMP-3.
  1245     12  RC-LOAN-1ST-PMT-DT     PIC 9(6).
  1246     12  RC-ORIG-LFAMT          PIC S9(9)V99    COMP-3.
  1247     12  RC-LFAMT-ALT           PIC S9(9)V99    COMP-3.
  1248     12  RC-CEDE-FACT           PIC S9(1)V9(4)  COMP-3.
  1249     12  FILLER                 PIC X.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  33
* ECS150.cbl
  1251 01  PROCESSING-CONTROL-DATES.
  1252     12  PERIOD-START        PIC XX.
  1253     12  PERIOD-START-9      PIC S9(5)    COMP-3.
  1254     12  PERIOD-END          PIC XX.
  1255     12  PERIOD-END-9        PIC S9(5)    COMP-3.
  1256     12  CERT-EFFECT-DT      PIC XX.
  1257     12  FIRST-PAY-DT        PIC XX.
  1258     12  CERT-EXPIRE-DATE    PIC XX.
  1259     12  CERT-EXPIRE-DATE-O  PIC XX.
  1260     12  CANCEL-EXIT-DATE    PIC XX.
  1261     12  CLAIM-EXIT-DATE     PIC XX.
  1262     12  VALUATION-DATE      PIC S9(5)    COMP-3.
  1263     12  CERT-ENTRY-DATE     PIC XX.
  1264     12  LOW-EXIT-DATE       PIC XX.
  1265     12  SUM-CANCEL-DATE     PIC XX.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  34
* ECS150.cbl
  1267 01  SAVE-CONTROL-BREAKS                         VALUE SPACES.
  1268     12  LAST-REINS-CO       PIC X(6).
  1269     12  SAVE-CNTRL-GRP.
  1270         16  LAST-CARRIER    PIC X.
  1271         16  LAST-GROUPING   PIC X(6).
  1272         16  LAST-STATE      PIC XX.
  1273         16  LAST-ACCOUNT    PIC X(10).
  1274
  1275 01  SAVE-EXP-DT.
  1276     12  SE-YR             PIC 99.
  1277     12  SE-MO             PIC 99.
  1278     12  SE-DA             PIC 99.
  1279
  1280 01  REMAINING-TERM-WORK-FIELDS.
  1281     12  BGN-DT.
  1282         16  BGN-YR          PIC 99.
  1283         16  BGN-MO          PIC 99.
  1284         16  BGN-DA          PIC 99.
  1285     12  END-DT.
  1286         16  END-YR          PIC 99.
  1287         16  END-MO          PIC 99.
  1288         16  END-DA          PIC 99.
  1289     12  TEMP-1              PIC S9(9)V9(7)  COMP-3 VALUE +0.
  1290     12  TEMP-2              PIC S9(9)V9(7)  COMP-3 VALUE +0.
  1291     12  TEMP-3              PIC S9(9)V9(7)  COMP-3 VALUE +0.
  1292     12  TEMP-4              PIC S9V9(8)     COMP-3 VALUE +0.
  1293     12  TEMP-5              PIC S9V9(8)     COMP-3 VALUE +0.
  1294     12  LF-REM-TRM          PIC S9(3)V99    COMP-3 VALUE +0.
  1295     12  AH-REM-TRM          PIC S9(3)V99    COMP-3 VALUE +0.
  1296     12  LF-BAL-REMTRM       PIC S9(3)V99    COMP-3 VALUE +0.
  1297     12  REM-TRM1            PIC S9(3)V99    COMP-3 VALUE +0.
  1298     12  REM-TRM2            PIC S9(3)V99    COMP-3 VALUE +0.
  1299     12  TEM-TRM1            PIC S9(3)V99    COMP-3 VALUE +0.
  1300     12  HLD-TRM             PIC S9(3)V99    COMP-3 VALUE +0.
  1301     12  RUN-DATE-BIN        PIC XX.
  1302     12  EP-DT-BIN           PIC XX.
  1303     12  WS-CR-BIN-DATE      PIC XX.
  1304
  1305 01  TEXAS-REG-WORK-AREAS.
  1306     12  TEX-FACT-1          PIC S9(7)V99    COMP-3.
  1307     12  TEX-FACT-2          PIC S9(3)       COMP-3.
  1308     12  TEX-FACT-3          PIC S9(3)       COMP-3.
  1309     12  TEX-FACT-4          PIC S9(7)       COMP-3.
  1310     12  TEX-FACT-5          PIC S9(3)       COMP-3.
  1311     12  TEX-FACT-6          PIC S9(3)       COMP-3.
  1312     12  TEX-FACT-7          PIC S9(7)       COMP-3.
  1313     12  TEX-FACT-8          PIC S9V9(6)     COMP-3.
  1314     12  TEX-FACT-9          PIC S9(4)V9(11) COMP-3.
  1315
  1316 01  NET-PAY-INTERFACE.
  1317     12  NP-APR              PIC S9(3)V9(4)  COMP-3.
  1318     12  NP-ORIG             PIC S9(3)       COMP-3.
  1319     12  NP-REM              PIC S9(3)       COMP-3.
  1320     12  NP251-ORIG          PIC S9(3)V99    COMP-3.
  1321     12  NP251-REM           PIC S9(3)V99    COMP-3.
  1322     12  NP-SUB              PIC S9(3)       COMP-3.
  1323     12  NP-EFF-DT           PIC X(06).
  1324     12  NP-OPT              PIC X.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  35
* ECS150.cbl
  1325     12  NP-CAP              PIC S9(3)       COMP-3.
  1326     12  NP-FACTOR           PIC S9(4)V9(9)  COMP-3.
  1327     12  NP-WORK1            PIC S9(6)V9(9)  COMP-3.
  1328     12  NP-WORK2            PIC S9(6)V9(9)  COMP-3.
  1329     12  NP-BENEFIT          PIC S9(9)V99    COMP-3.
  1330     12  NP-REMAINING        PIC S9(9)V99    COMP-3.
  1331     12  NP-AHPRM            PIC S9(7)V99    COMP-3.
  1332     12  NP-ACCOUNT          PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  36
* ECS150.cbl
  1334** OTHER WORK FIELDS
  1335 01  SAVE-REINS-CERT         PIC X(210).
  1336
  1337 01  COUNT-WORK              PIC S9(3)   COMP-3  VALUE +0.
  1338
  1339 01  COUNT-SAVE              PIC S9(3)   COMP-3  VALUE +0.
  1340 01  INFORCE-DOLLARS         PIC S9(9)V99 COMP-3 VALUE +0.
  1341 01  DOLLAR-AMT              PIC S9(9)V99 COMP-3 VALUE +0.
  1342 01  DECREASING-DOLLAR       PIC S9(9)V99 COMP-3 VALUE +0.
  1343 01  WS-PR-UN-PREM           PIC S9(7)V99 COMP-3 VALUE +0.
  1344 01  WS-PR-UN-PREM-ALT       PIC S9(7)V99 COMP-3 VALUE +0.
  1345 01  WS-R78-UN-PREM          PIC S9(7)V99 COMP-3 VALUE +0.
  1346 01  WS-R78-UN-PREM-ALT      PIC S9(7)V99 COMP-3 VALUE +0.
  1347 01  WS-STATE-UN-PREM        PIC S9(7)V99 COMP-3 VALUE +0.
  1348 01  AH-EARN-METHOD          PIC X(01)           VALUE SPACE.
  1349*
  1350*
  1351* LEAVE THE ABOVE 2 LINE IN TO PREVENT LOSING THE LINE ABOVE
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  37
* ECS150.cbl
  1353 01  ACTIVITY-TOTAL-TABLE.
  1354     12  CONTROL-LEVELS OCCURS 5 TIMES.
  1355*          **ON PASS FOR 1ST INSURANCE COMPANY
  1356*            1=  STATE TOTALS   - 1ST INSURANCE
  1357*            2=  ACCOUNT TOTALS - 1ST INSURANCE
  1358*            3=  STATE TOTALS   - REINSURANCE
  1359*            4=  ACCOUNT TOTALS - REINSURANCE
  1360*            5=  NOT USED
  1361*          **ON PASS FOR REINSURANCE COMPANY
  1362*            1=  REINSURANCE COMPANY TOTALS
  1363*            2=  CARRIER TOTALS
  1364*            3=  COMPANY TOTALS
  1365*            4=  STATE TOTALS
  1366*            5=  ACCOUNT TOTALS
  1367*
  1368         16  TERM-GROUPS OCCURS 3 TIMES.
  1369*            1=  0-60 MONTHS
  1370*            2=  61 - 120 MONTHS
  1371*            3=  OVER 120 MONTHS
  1372*
  1373             20  INSURANCE-TYPES OCCURS 10 TIMES.
  1374*                **  1-5 ARE GROUP
  1375*                    6-10 ARE INDIVIDUAL
  1376*                 1,6 =  LIFE(RED)
  1377*                 2,7 =  LIFE(LEV)
  1378*                 3,8 =  LIFE(OB)
  1379*                 4,9 =  AH
  1380*                 5,10=  AH(OB)
  1381                 24  ISSUE-CNT   PIC S9(13)    COMP-3.
  1382                 24  ISSUE-AMT   PIC S9(11)V99 COMP-3.
  1383                 24  ISSUE-PREM  PIC S9(11)V99 COMP-3.
  1384                 24  CANCEL-CNT  PIC S9(13)    COMP-3.
  1385                 24  CANCEL-AMT  PIC S9(11)V99 COMP-3.
  1386                 24  CANCEL-PREM PIC S9(11)V99 COMP-3.
  1387                 24  CLAIM-CNT   PIC S9(13)    COMP-3.
  1388                 24  CLAIM-AMT   PIC S9(11)V99 COMP-3.
  1389                 24  EARN-PREM   PIC S9(11)V99 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  38
* ECS150.cbl
  1391 01  EXHIBIT-TOTALS-TABLE.
  1392     12  E-CONTROL-LEVELS OCCURS 5 TIMES.
  1393*            * DEFINITION OF LEVELS SAME AS ACTIVITY-TOTAL-TABLE
  1394         16  E-TERM-GROUPS OCCURS 3 TIMES.
  1395*            * DEFINITION OF LEVELS SAME AS ACTIVITY-TOTAL-TABLE
  1396             20  EXHIBIT-GROUPS OCCURS 9 TIMES.
  1397*                1=  INFORCE END OF PREVIOUS PERIOD
  1398*                2=  ISSUED DURING PERIOD
  1399*                3=  TOTAL INFORCE (LEV 1 + LEV 2)
  1400*                4=  DEATHS IN PERIOD
  1401*                5=  EXPIRED
  1402*                6=  CANCELLED
  1403*                7=  DECREASES
  1404*                8=  TOTAL DEDUCTIONS (LEV 4+5+6+7)
  1405*                9=  TOTAL INFORCE AT END OF PERIOD (LEV 3-8)
  1406*
  1407                 24  GROUP-CNT   PIC S9(13)    COMP-3.
  1408                 24  GROUP-AMT   PIC S9(11)V99 COMP-3.
  1409                 24  IND-CNT     PIC S9(13)    COMP-3.
  1410                 24  IND-AMT     PIC S9(11)V99 COMP-3.
  1411
  1412 01  AH-PAID-TABLE.
  1413     12  A-CONTROL-LEVELS OCCURS 5 TIMES.
  1414*            * DEFINITION OF LEVELS SAME AS ACTIVITY-TOTAL-TABLE.
  1415         16  AH-PAID-THIS-YR     PIC S9(11)V99 COMP-3.
  1416         16  AH-PAID-LAST-YR     PIC S9(11)V99 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  39
* ECS150.cbl
  1418 01  TABLE-SUBSCRIPTS    COMP.
  1419*
  1420* CONTROL-LEVELS
  1421     12  CL                  PIC S9(4).
  1422* TERM-GROUPS
  1423     12  TG                  PIC S9(4).
  1424* DETAIL (EXHIBIT GROUPS)
  1425     12  EG                  PIC S9(4).
  1426* DETAIL (INSURANCE TYPES)
  1427     12  IY                  PIC S9(4).
  1428* CONTROL-LEVELS + 1 (USED TO ROLL TOTALS)
  1429     12  CLX                 PIC S9(4).
  1430* LAST-ADD-LEVEL.
  1431     12  LA                  PIC S9(4).
  1432
  1433     12  SAV-LF-TERM-CODE    PIC S9(4).
  1434
  1435 01  DATE-EDIT-AREAS.
  1436     12  FORMAT-DATE.
  1437         16  XMM             PIC 99.
  1438         16  FILLER          PIC X               VALUE '/'.
  1439         16  XDD             PIC 99.
  1440         16  FILLER          PIC X               VALUE '/'.
  1441         16  XYY             PIC 99.
  1442     12  EDITED-DATE REDEFINES
  1443         FORMAT-DATE         PIC X(8).
  1444     12  RAW-DATE.
  1445         16  XCC             PIC 99.
  1446         16  XYY             PIC 99.
  1447         16  XMM             PIC 99.
  1448         16  XDD             PIC 99.
  1449     12  DATE-WORK REDEFINES
  1450         RAW-DATE            PIC 9(8).
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  40
* ECS150.cbl
  1452 01  HEAD-LINE-1.
  1453     12  FILLER              PIC X(12)           VALUE
  1454             '  CARRIER - '.
  1455     12  HL-CARRIER          PIC X               VALUE SPACES.
  1456     12  FILLER              PIC X(34)           VALUE SPACES.
  1457     12  HL-CO-NAME          PIC X(30)           VALUE SPACES.
  1458     12  FILLER              PIC X(42)           VALUE SPACES.
  1459     12  FILLER              PIC X(8)            VALUE 'ECS150'.
  1460
  1461 01  HEAD-LINE-2.
  1462     12  FILLER              PIC X(12)           VALUE
  1463             ' GROUPING - '.
  1464     12  HL-COMPANY          PIC X(6)            VALUE SPACES.
  1465     12  FILLER              PIC X(23)           VALUE SPACES.
  1466     12  FILLER              PIC X(49)           VALUE
  1467             'CERTIFICATE ACTIVITY - DETAIL AND SUMMARY TOTALS'.
  1468     12  FILLER              PIC X(29)           VALUE SPACES.
  1469     12  HL-DATE             PIC X(8).
  1470
  1471 01  HEAD-LINE-3.
  1472     12  FILLER              PIC X(12)           VALUE
  1473             '  STATE   - '.
  1474     12  HL-STATE            PIC X(20)           VALUE SPACES.
  1475     12  FILLER              PIC X(17)           VALUE SPACES.
  1476     12  FILLER              PIC X(11)           VALUE
  1477             'FOR PERIOD '.
  1478     12  HL-PER-START        PIC X(8).
  1479     12  FILLER              PIC X(6)            VALUE ' THRU '.
  1480     12  HL-PER-END          PIC X(8).
  1481     12  FILLER              PIC X(37)           VALUE SPACES.
  1482     12  FILLER              PIC X(5)            VALUE 'PAGE '.
  1483     12  HL-PAGENO           PIC ZZ,ZZ9.
  1484
  1485 01  HEAD-LINE-4.
  1486     12  FILLER              PIC X(12)           VALUE
  1487             '  ACCOUNT - '.
  1488     12  HL-ACCOUNT          PIC X(11)           VALUE SPACES.
  1489     12  FILLER              PIC X(109)          VALUE SPACES.
  1490
  1491 01  HEAD-LINE-5.
  1492     12  FILLER              PIC X(25)           VALUE
  1493             '  REINSURANCE COMPANY - '.
  1494     12  HL-REIN-CO          PIC X(6)            VALUE SPACES.
  1495     12  FILLER              PIC X(101)          VALUE SPACES.
  1496
  1497 01  HEAD-LINE-6.
  1498     12  FILLER              PIC X(7)    VALUE '  *****'.
  1499     12  HL-MESSAGE          PIC X(21)   VALUE SPACES.
  1500     12  FILLER              PIC X(5)    VALUE '*****'.
  1501     12  FILLER              PIC X(99)   VALUE SPACES.
  1502
  1503 01  HEAD-LINE-7A.
  1504     12  FILLER              PIC X(44)           VALUE
  1505             '          CERTIFICATE     ISSUE    TERM     '.
  1506     12  FILLER              PIC X(44)           VALUE
  1507             '       PLAN       ORIGINAL        PREMIUM AM'.
  1508     12  FILLER              PIC X(44)           VALUE
  1509             'OUNTS                                       '.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  41
* ECS150.cbl
  1510
  1511 01  HEAD-LINE-7B.
  1512     12  FILLER              PIC X(44)           VALUE
  1513             '            NUMBER        DATE     AH  LF   '.
  1514     12  FILLER              PIC X(44)           VALUE
  1515             'TYPE   CODE        AMOUNT          LIFE     '.
  1516     12  FILLER              PIC X(44)           VALUE
  1517             ' AH        ACTIVITY      AMOUNT             '.
  1518
  1519 01  HEAD-LINE-8A.
  1520     12  FILLER              PIC X(44)           VALUE
  1521             ' CLASSIFICATION         I S S U E D         '.
  1522     12  FILLER              PIC X(44)           VALUE
  1523             '                  C A N C E L L E D         '.
  1524     12  FILLER              PIC X(44)           VALUE
  1525             '          C L A I M S            E A R N E D'.
  1526
  1527 01  HEAD-LINE-8B.
  1528     12  FILLER              PIC X(44)           VALUE
  1529             '*************** ****************************'.
  1530     12  FILLER              PIC X(44)           VALUE
  1531             '********    ********************************'.
  1532     12  FILLER              PIC X(44)           VALUE
  1533             '****   *********************    ************'.
  1534
  1535 01  HEAD-LINE-8C.
  1536     12  FILLER              PIC X(44)           VALUE
  1537            ' TYPE    TERM   -COUNT- ----AMOUNT----  --PR'.
  1538     12  FILLER              PIC X(44)           VALUE
  1539            'EMIUM---    -COUNT- ----AMOUNT----  --PREMIU'.
  1540     12  FILLER              PIC X(44)           VALUE
  1541            'M---   -COUNT- ---AMOUNT----    ---AMOUNT---'.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  42
* ECS150.cbl
  1543 01  DETAIL-LINE-1.
  1544     12  FILLER              PIC X(8)            VALUE SPACES.
  1545     12  DL-CERT-NO          PIC X(10).
  1546     12  DL-CERT-SUFX        PIC X.
  1547     12  FILLER              PIC X(5)            VALUE SPACES.
  1548     12  DL-ISSUE-DT         PIC X(8).
  1549     12  FILLER              PIC XX              VALUE SPACES.
  1550     12  DL-AH-TERM          PIC ZZ9.
  1551     12  FILLER              PIC X               VALUE SPACES.
  1552     12  DL-LF-TERM          PIC ZZ9.
  1553     12  FILLER              PIC X(4)            VALUE SPACES.
  1554     12  DL-TYPE             PIC XXX.
  1555     12  FILLER              PIC X(4)            VALUE SPACES.
  1556     12  DL-PLAN             PIC XXX.
  1557     12  FILLER              PIC X(2)            VALUE SPACES.
  1558     12  DL-ORIG-AMT         PIC ZZZ,ZZZ,ZZ9.99.
  1559     12  FILLER              PIC X(5)            VALUE SPACES.
  1560     12  DL-LF-PREM          PIC ZZ,ZZ9.99.
  1561     12  DL-AH-PREM          PIC ZZ,ZZ9.99.
  1562     12  FILLER              PIC X(7)            VALUE SPACES.
  1563     12  DL-ACTIVITY         PIC X(5).
  1564     12  DL-RSRV-AMT         PIC ZZZ,ZZZ,ZZ9.99-.
  1565     12  FILLER              PIC X(14)           VALUE SPACES.
  1566
  1567 01  DETAIL-LINE-2.
  1568     12  DL-DESCRIP          PIC X(16)           VALUE SPACES.
  1569     12  DL-ISS-CNT          PIC ZZZ,ZZ9.
  1570     12  DL-ISS-AMT          PIC ZZZ,ZZZ,ZZ9.99-.
  1571     12  DL-ISS-PRM          PIC ZZ,ZZZ,ZZ9.99-.
  1572     12  FILLER              PIC XX              VALUE SPACES.
  1573     12  DL-CAN-CNT          PIC ZZZ,ZZ9.
  1574     12  FILLER              PIC X               VALUE SPACES.
  1575     12  DL-CAN-AMT          PIC ZZZ,ZZZ,ZZ9.99.
  1576     12  FILLER              PIC X               VALUE SPACES.
  1577     12  DL-CAN-PRM          PIC ZZ,ZZZ,ZZ9.99.
  1578     12  FILLER              PIC XXX             VALUE SPACES.
  1579     12  DL-CLM-CNT          PIC ZZZ,ZZ9.
  1580     12  FILLER              PIC X               VALUE SPACES.
  1581     12  DL-CLM-AMT          PIC ZZ,ZZZ,ZZ9.99.
  1582     12  FILLER              PIC XX              VALUE SPACES.
  1583     12  DL-EARN-AMT         PIC ZZ,ZZZ,ZZZ.99-.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  43
* ECS150.cbl
  1585 01  ABEND-CD.
  1586     12  ABEND-CODE.
  1587         16  ABEND-FILE-ID       PIC XX VALUE ZEROS.
  1588         16  ABEND-CODE-1 REDEFINES ABEND-FILE-ID
  1589                                 PIC XX.
  1590         16  ABEND-REASON        PIC XX VALUE ZEROS.
  1591         16  ABEND-CODE-2 REDEFINES ABEND-REASON
  1592                                 PIC XX.
  1593     12  ABEND-OPTION    PIC X          VALUE 'Y'.
  1594     12  PGM-SUB         PIC S999 COMP  VALUE +150.
  1595     12  R-EX-DT             PIC X(6).
  1596
  1597 01  KB-REIN.
  1598     12  CLM-INCUR-REIN-DATE PIC 9(6).
  1599     12  CLM-INCUR-REIN-DATE-R REDEFINES CLM-INCUR-REIN-DATE.
  1600         16  CIRD-CCYY.
  1601             20  CIRD-CC     PIC 99.
  1602             20  CIRD-YR     PIC 99.
  1603         16  CIRD-MO         PIC 99.
  1604     12  DTO-CC              PIC 99.
  1605     12  DTO-YR              PIC 99.
  1606     12  DTO-MO              PIC 99.
  1607     12  FLA-CLM-REIN-BASE   PIC S9(5)V99.
  1608     12  ADJ-FLA-REIN-BASE   PIC S9(5)V99.
  1609     12  REIN-RT-SW          PIC X               VALUE 'X'.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  44
* ECS150.cbl
* 1611                             COPY ECSRITAB.
  1612******************************************************************04/29/98
  1613*                                                                *ECSRITAB
  1614*                            ECSRITAB                            *   LV015
  1615*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL*15
  1616*                            VMOD=2.015                          *ECSRITAB
  1617*                                                                *ECSRITAB
  1618*  NO  CID  MODS  IN  COPYBOOK  ECSRITAB                         *ECSRITAB
  1619*                                                                *ECSRITAB
  1620******************************************************************ECSRITAB
  1621 01  REIN-WORK-AREAS.                                             ECSRITAB
  1622     12  RW-LFAMT                PIC S9(9)V99  VALUE +0   COMP-3. ECSRITAB
  1623     12  RW-AHWRK                PIC S9(9)V99  VALUE +0   COMP-3. ECSRITAB
  1624     12  RW-LFPRM                PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  1625     12  RW-LFPRMC               PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  1626     12  RW-LFRFND               PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  1627     12  RW-AHPRM                PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  1628     12  RW-AHPRMC               PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  1629     12  RW-AHRFND               PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  1630     12  RW-LFCLMWK              PIC S9(9)V99  VALUE +0   COMP-3. ECSRITAB
  1631     12  RW-AHCLMWK              PIC S9(9)V99  VALUE +0   COMP-3. ECSRITAB
  1632     12  RW-AH-INCURRED-DETAIL.                                   ECSRITAB
  1633         16  RW-AH-INCURRED-DATA OCCURS 5 TIMES.                  ECSRITAB
  1634             20  RW-AH-INCUR-DT  PIC 9(11) COMP-3.                   CL**2
  1635             20  RW-AH-CLM-AMT   PIC S9(9)V99             COMP-3. ECSRITAB
  1636             20  RW-AH-CLM-EXP   PIC S9(9)V99             COMP-3. ECSRITAB
  1637     12  RW-LFCLM                PIC S9(9)V99  VALUE +0   COMP-3. ECSRITAB
  1638     12  RW-AHCLM                PIC S9(9)V99  VALUE +0   COMP-3. ECSRITAB
  1639     12  RW-AH-LIMIT             PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  1640     12  RW-LFIBNR               PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  1641     12  RW-LFPAYCUR             PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  1642     12  RW-LFFUTRSV             PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  1643     12  RW-AHIBNR               PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  1644     12  RW-AHPAYCUR             PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  1645     12  RW-AHFUTRSV             PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  1646     12  RW-LFIBNRWK             PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  1647     12  RW-LFPAYCURWK           PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  1648     12  RW-LFFUTRSVWK           PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  1649     12  RW-AHIBNRWK             PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  1650     12  RW-AHPAYCURWK           PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  1651     12  RW-AHFUTRSVWK           PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  1652     12  RW-AHLIM-LO             PIC S9(9)V99  VALUE +0   COMP-3. ECSRITAB
  1653     12  RW-AHLIM-HI             PIC S9(9)V99  VALUE +0   COMP-3. ECSRITAB
  1654     12  RW-ACCUM-LF             PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  1655     12  RW-ACCUM-AH             PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  1656     12  RW-ACCUM-CLM            PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  1657     12  RW-ACCUM-IBNR           PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  1658     12  RW-ACCUM-PAYCUR         PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  1659     12  RW-ACCUM-FUTRSV         PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  1660                                                                  ECSRITAB
  1661 01  REIN-HOLD-AREAS.                                             ECSRITAB
  1662     12  REIN-LEVELS       OCCURS 30 TIMES.                       ECSRITAB
  1663         16  REIN-COMP               PIC X(6).                    ECSRITAB
  1664         16  REIN-LF-AH-FLGS.                                     ECSRITAB
  1665             20  REIN-LF-FLG         PIC X.                       ECSRITAB
  1666             20  REIN-AH-FLG         PIC X.                       ECSRITAB
  1667         16  REIN-WORK-FLDS.                                      ECSRITAB
  1668             20  REIN-LFAMT          PIC S9(9)V99   COMP-3.       ECSRITAB
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  45
* ECS150.cbl (/apps/prod/cid1p/copy/ECSRITAB)
  1669             20  REIN-LFPRM          PIC S9(7)V99   COMP-3.       ECSRITAB
  1670             20  REIN-AHAMT          PIC S9(7)V99   COMP-3.       ECSRITAB
  1671             20  REIN-AHPRM          PIC S9(7)V99   COMP-3.       ECSRITAB
  1672             20  REIN-LFRFND         PIC S9(7)V99   COMP-3.       ECSRITAB
  1673             20  REIN-AHRFND         PIC S9(7)V99   COMP-3.       ECSRITAB
  1674             20  REIN-LFCLM          PIC S9(9)V99   COMP-3.       ECSRITAB
  1675             20  REIN-AHCLM          PIC S9(9)V99   COMP-3.       ECSRITAB
  1676             20  REIN-LFCLML         PIC S9(9)V99   COMP-3.       ECSRITAB
  1677             20  REIN-AHCLML         PIC S9(9)V99   COMP-3.       ECSRITAB
  1678             20  REIN-DIS-IBNR       PIC S9(7)V99   COMP-3.       ECSRITAB
  1679             20  REIN-DIS-PAYCUR     PIC S9(7)V99   COMP-3.       ECSRITAB
  1680             20  REIN-DIS-FUTRSV     PIC S9(7)V99   COMP-3.       ECSRITAB
  1681             20  REIN-DIS-IBNRL      PIC S9(7)V99   COMP-3.       ECSRITAB
  1682             20  REIN-DIS-PAYCURL    PIC S9(7)V99   COMP-3.       ECSRITAB
  1683             20  REIN-DIS-FUTRSVL    PIC S9(7)V99   COMP-3.       ECSRITAB
  1684             20  REIN-DTH-IBNR       PIC S9(7)V99   COMP-3.       ECSRITAB
  1685             20  REIN-DTH-PAYCUR     PIC S9(7)V99   COMP-3.       ECSRITAB
  1686             20  REIN-DTH-FUTRSV     PIC S9(7)V99   COMP-3.       ECSRITAB
  1687             20  REIN-DTH-IBNRL      PIC S9(7)V99   COMP-3.       ECSRITAB
  1688             20  REIN-DTH-PAYCURL    PIC S9(7)V99   COMP-3.       ECSRITAB
  1689             20  REIN-DTH-FUTRSVL    PIC S9(7)V99   COMP-3.       ECSRITAB
  1690             20  REIN-AH-LIMIT       PIC S9(7)V99   COMP-3.       ECSRITAB
  1691             20  REIN-REM-SW         PIC X.                       ECSRITAB
  1692             20  REIN-REM-AH-100     PIC X.                       ECSRITAB
  1693             20  REIN-EP-STOP-DATE   PIC 9(11)      COMP-3.          CL**4
  1694             20  REIN-LF-RUNOFF-SW   PIC X.                       ECSRITAB
  1695             20  REIN-AH-RUNOFF-SW   PIC X.                       ECSRITAB
  1696     12  REIN-LEVELS-END             PIC X(6).                    ECSRITAB
  1697                                                                  ECSRITAB
  1698     12  RWF-FIELDS.                                              ECSRITAB
  1699         16  RWF-LFAMT               PIC S9(9)V99   COMP-3.       ECSRITAB
  1700         16  RWF-LFPRM               PIC S9(7)V99   COMP-3.       ECSRITAB
  1701         16  RWF-AHAMT               PIC S9(7)V99   COMP-3.       ECSRITAB
  1702         16  RWF-AHPRM               PIC S9(7)V99   COMP-3.       ECSRITAB
  1703         16  RWF-LFRFND              PIC S9(7)V99   COMP-3.       ECSRITAB
  1704         16  RWF-AHRFND              PIC S9(7)V99   COMP-3.       ECSRITAB
  1705         16  RWF-LFCLM               PIC S9(9)V99   COMP-3.       ECSRITAB
  1706         16  RWF-AHCLM               PIC S9(9)V99   COMP-3.       ECSRITAB
  1707         16  RWF-LFCLML              PIC S9(9)V99   COMP-3.       ECSRITAB
  1708         16  RWF-AHCLML              PIC S9(9)V99   COMP-3.       ECSRITAB
  1709         16  RWF-DIS-IBNR            PIC S9(7)V99   COMP-3.       ECSRITAB
  1710         16  RWF-DIS-PAYCUR          PIC S9(7)V99   COMP-3.       ECSRITAB
  1711         16  RWF-DIS-FUTRSV          PIC S9(7)V99   COMP-3.       ECSRITAB
  1712         16  RWF-DIS-IBNRL           PIC S9(7)V99   COMP-3.       ECSRITAB
  1713         16  RWF-DIS-PAYCURL         PIC S9(7)V99   COMP-3.       ECSRITAB
  1714         16  RWF-DIS-FUTRSVL         PIC S9(7)V99   COMP-3.       ECSRITAB
  1715         16  RWF-DTH-IBNR            PIC S9(7)V99   COMP-3.       ECSRITAB
  1716         16  RWF-DTH-PAYCUR          PIC S9(7)V99   COMP-3.       ECSRITAB
  1717         16  RWF-DTH-FUTRSV          PIC S9(7)V99   COMP-3.       ECSRITAB
  1718         16  RWF-DTH-IBNRL           PIC S9(7)V99   COMP-3.       ECSRITAB
  1719         16  RWF-DTH-PAYCURL         PIC S9(7)V99   COMP-3.       ECSRITAB
  1720         16  RWF-DTH-FUTRSVL         PIC S9(7)V99   COMP-3.       ECSRITAB
  1721         16  RWF-AH-LIMIT            PIC S9(7)V99   COMP-3.       ECSRITAB
  1722         16  RWF-REM-SW              PIC X.                       ECSRITAB
  1723         16  RWF-REM-AH-100          PIC X.                       ECSRITAB
  1724         16  RWF-EP-STOP-DATE        PIC 9(11)      COMP-3.          CL**3
  1725         16  RWF-LF-RUNOFF-SW        PIC X.                       ECSRITAB
  1726         16  RWF-AH-RUNOFF-SW        PIC X.                       ECSRITAB
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  46
* ECS150.cbl (/apps/prod/cid1p/copy/ECSRITAB)
  1727                                                                  ECSRITAB
  1728     12  WT-COMP-INFO.                                            ECSRITAB
  1729         16  WT-REI-COMP             PIC X(6).                    ECSRITAB
  1730         16  WT-LF-QC                PIC X.                       ECSRITAB
  1731         16  WT-AH-QC                PIC X.                       ECSRITAB
  1732         16  WT-LO-DATE              PIC 9(11)     COMP-3.           CL**2
  1733         16  WT-HI-DATE              PIC 9(11)     COMP-3.           CL**2
  1734         16  WT-LFAGE-LO             PIC 99.                      ECSRITAB
  1735         16  WT-LFAGE-HI             PIC 99.                      ECSRITAB
  1736         16  WT-AHAGE-LO             PIC 99.                      ECSRITAB
  1737         16  WT-AHAGE-HI             PIC 99.                      ECSRITAB
  1738         16  WT-LFTRM-LO             PIC S999       COMP-3.       ECSRITAB
  1739         16  WT-LFTRM-HI             PIC S999       COMP-3.       ECSRITAB
  1740         16  WT-AHTRM-LO             PIC S999       COMP-3.       ECSRITAB
  1741         16  WT-AHTRM-HI             PIC S999       COMP-3.       ECSRITAB
  1742         16  WT-LF-PCT               PIC S9V9999    COMP-3.       ECSRITAB
  1743         16  WT-AH-PCT               PIC S9V9999    COMP-3.       ECSRITAB
  1744         16  WT-LF-LIM-LO            PIC S9(9)V99   COMP-3.       ECSRITAB
  1745         16  WT-LF-LIM-HI            PIC S9(9)V99   COMP-3.       ECSRITAB
  1746         16  WT-LF-LO                PIC S9(9)V99   COMP-3.       ECSRITAB
  1747         16  WT-LF-HI                PIC S9(9)V99   COMP-3.       ECSRITAB
  1748         16  WT-AHBEN-LIM-LO         PIC S9(7)V99   COMP-3.       ECSRITAB
  1749         16  WT-AHBEN-LIM-HI         PIC S9(7)V99   COMP-3.       ECSRITAB
  1750         16  WT-AHBEN-LO             PIC S9(7)V99   COMP-3.       ECSRITAB
  1751         16  WT-AHBEN-HI             PIC S9(7)V99   COMP-3.       ECSRITAB
  1752         16  WT-AHMOA-LIM-LO         PIC S9(7)V99   COMP-3.       ECSRITAB
  1753         16  WT-AHMOA-LIM-HI         PIC S9(7)V99   COMP-3.       ECSRITAB
  1754         16  WT-AHMOA-LO             PIC S9(7)V99   COMP-3.       ECSRITAB
  1755         16  WT-AHMOA-HI             PIC S9(7)V99   COMP-3.       ECSRITAB
  1756         16  WT-LF-BEN-CODE          PIC X.                       ECSRITAB
  1757         16  WT-AH-BEN-CODE          PIC X.                       ECSRITAB
  1758         16  WT-INTERACTIVE          PIC X.                       ECSRITAB
  1759         16  WT-REMAINING            PIC X.                       ECSRITAB
  1760         16  FILLER                  PIC X(21).                   ECSRITAB
  1761                                                                  ECSRITAB
  1762 01  REIN-MISC-WORK-FIELDS.                                       ECSRITAB
  1763     12  SUB1                    PIC S9(4)       COMP.            ECSRITAB
  1764     12  SUB2                    PIC S9(4)       COMP.            ECSRITAB
  1765     12  CO-SUB                  PIC S9(4)       COMP.            ECSRITAB
  1766     12  INC-SUB                 PIC S999        COMP.            ECSRITAB
  1767     12  MORTALITY-SUB           PIC S999        COMP.            ECSRITAB
  1768     12  REIN-FACTOR             PIC S99V9(7)  COMP-3   VALUE +0. ECSRITAB
  1769     12  REIN-CALCED-LIFE        PIC S9(7)V99  COMP-3   VALUE +0. ECSRITAB
  1770     12  REIN-CALCED-AH          PIC S9(7)V99  COMP-3   VALUE +0. ECSRITAB
  1771     12  REIN-RISK-AMOUNT        PIC S9(11)V99 COMP-3   VALUE +0. ECSRITAB
  1772     12  REIN-MONTH-REDUCE       PIC S9(7)V99  COMP-3   VALUE +0. ECSRITAB
  1773     12  REIN-CEDE-TERM          PIC S999V99   COMP-3   VALUE +0. ECSRITAB
  1774     12  REIN-WORKA              PIC S999      COMP-3   VALUE +0. ECSRITAB
  1775     12  REIN-EARN-LF-TERM       PIC S999      COMP-3   VALUE +0. ECSRITAB
  1776     12  REIN-EARN-AH-TERM       PIC S999      COMP-3   VALUE +0. ECSRITAB
  1777     12  REIN-LCNC-EARN-TERM     PIC S999      COMP-3   VALUE +0. ECSRITAB
  1778     12  REIN-ACNC-EARN-TERM     PIC S999      COMP-3   VALUE +0. ECSRITAB
  1779     12  REIN-LF-CLM-MONTHS      PIC S999      COMP-3   VALUE +0. ECSRITAB
  1780     12  REIN-AH-CLM-MONTHS      PIC S999      COMP-3   VALUE +0. ECSRITAB
  1781     12  REIN-AH-CLM-MTH-1       PIC S999      COMP-3   VALUE +0. ECSRITAB
  1782     12  REIN-AH-CLM-MTH-2       PIC S999      COMP-3   VALUE +0. ECSRITAB
  1783     12  REIN-AH-CLM-MTH-3       PIC S999      COMP-3   VALUE +0. ECSRITAB
  1784     12  REIN-AH-CLM-MTH-4       PIC S999      COMP-3   VALUE +0. ECSRITAB
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  47
* ECS150.cbl (/apps/prod/cid1p/copy/ECSRITAB)
  1785     12  REIN-AH-CLM-MTH-5       PIC S999      COMP-3   VALUE +0. ECSRITAB
  1786     12  REIN-AH-PRIOR-CLMS-PAID PIC S9(11)V99 COMP-3   VALUE +0. ECSRITAB
  1787                                                                  ECSRITAB
  1788     12  REIN-VOID-LF-SW         PIC X    VALUE ' '.              ECSRITAB
  1789         88  VOIDING-LF-CANCEL            VALUE '*'.              ECSRITAB
  1790     12  REIN-VOID-AH-SW         PIC X    VALUE ' '.              ECSRITAB
  1791         88  VOIDING-AH-CANCEL            VALUE '*'.              ECSRITAB
  1792     12  REIN-ADDL-LF-SW         PIC X    VALUE ' '.              ECSRITAB
  1793         88  ADDITIONAL-LF-CANCEL         VALUE '*'.              ECSRITAB
  1794     12  REIN-ADDL-AH-SW         PIC X    VALUE ' '.              ECSRITAB
  1795         88  ADDITIONAL-AH-CANCEL         VALUE '*'.              ECSRITAB
  1796     12  REIN-CANCEL-LF-SW       PIC X    VALUE ' '.              ECSRITAB
  1797         88  FLAT-CANCEL-LF               VALUE '*'.              ECSRITAB
  1798     12  REIN-CANCEL-AH-SW       PIC X    VALUE ' '.              ECSRITAB
  1799         88  FLAT-CANCEL-AH               VALUE '*'.              ECSRITAB
  1800                                                                  ECSRITAB
  1801     12  REIN-BEN-CODE           PIC X.                           ECSRITAB
  1802         88  CEDING-SINGLE-PREM-ONLY      VALUE 'A'.              ECSRITAB
  1803         88  CEDING-OUT-BALANCE-ONLY      VALUE 'B'.              ECSRITAB
  1804         88  CEDING-REDUCING-ONLY         VALUE 'C'  'F'.         ECSRITAB
  1805         88  CEDING-LEVEL-ONLY            VALUE 'D'  'E'.         ECSRITAB
  1806         88  CEDING-GROUP-ONLY            VALUE 'G'.              ECSRITAB
  1807         88  CEDING-GROUP-RED-LIFE-ONLY   VALUE 'H'.              ECSRITAB
  1808         88  CEDING-INDIVIDUAL-ONLY       VALUE 'I'.              ECSRITAB
  1809         88  CEDING-JOINT-ONLY            VALUE 'J'.              ECSRITAB
  1810         88  CEDING-SGL-PREM-REDUCING     VALUE 'K'.              ECSRITAB
  1811         88  CEDING-SGL-PREM-GROUP        VALUE 'L'.              ECSRITAB
  1812         88  CEDING-GROUP-LEVEL-ONLY      VALUE 'M'.              ECSRITAB
  1813         88  CEDING-SGL-PREM-GRP-REDUCING VALUE 'N'.              ECSRITAB
  1814         88  CEDING-SGL-PREM-GROUP-LEVEL  VALUE 'P'.              ECSRITAB
  1815         88  CEDING-GROUP-REDUCING-ONLY   VALUE 'R'.              ECSRITAB
  1816         88  CEDING-SINGLE-POLICIES-ONLY  VALUE 'S'.              ECSRITAB
  1817         88  CEDING-AH-ONLY               VALUE '1'.              ECSRITAB
  1818         88  CEDING-PROPERTY-ONLY         VALUE '2'.              ECSRITAB
  1819         88  CEDING-UNEMPLOYMENT-ONLY     VALUE '3'.              ECSRITAB
  1820         88  CEDING-AD-D-ONLY             VALUE '4'.              ECSRITAB
  1821         88  CEDING-LIFE-ONLY             VALUE '5'.              ECSRITAB
  1822         88  CEDING-DISMEMBERMENT-ONLY    VALUE '6'.              ECSRITAB
  1823         88  CEDING-7-DAY-RETRO           VALUE '7'.              ECSRITAB
  1824         88  CEDING-14-DAY-RETRO          VALUE '8'.              ECSRITAB
  1825     12  REIN-OPEN-SW            PIC X           VALUE SPACE.     ECSRITAB
  1826     12  REIN-SEARCH.                                             ECSRITAB
  1827         16  REIN-SRCH-COMP-CD   PIC X           VALUE SPACE.     ECSRITAB
  1828         16  REIN-SRCH-CODE      PIC X           VALUE SPACE.     ECSRITAB
  1829         16  REIN-SRCH           PIC XXX         VALUE SPACE.     ECSRITAB
  1830         16  FILLER              PIC XXX         VALUE LOW-VALUE. ECSRITAB
  1831     12  SAVE-REIN-SRCH          PIC XXX         VALUE SPACE.     ECSRITAB
  1832     12  REIN-BUS-FLAG           PIC X           VALUE SPACE.     ECSRITAB
  1833     12  RATE-WORK               PIC S9(8)V9(5)  COMP-3.          ECSRITAB
  1834     12  RATE-WORK-L             PIC S9(8)V9(5)  COMP-3.          ECSRITAB
  1835     12  RATE-WORK-A             PIC S9(8)V9(5)  COMP-3.          ECSRITAB
  1836     12  RS-LIFE-BEN             PIC S9(9)V99  COMP-3   VALUE +0. ECSRITAB
  1837     12  RS-LIFE-PREM            PIC S9(7)V99  COMP-3   VALUE +0. ECSRITAB
  1838     12  RS-AH-BEN               PIC S9(9)V99  COMP-3   VALUE +0. ECSRITAB
  1839     12  RS-AH-PREM              PIC S9(7)V99  COMP-3   VALUE +0. ECSRITAB
  1840     12  RS-LP-CALC              PIC S9(7)V99  COMP-3   VALUE +0. ECSRITAB
  1841     12  RS-AP-CALC              PIC S9(7)V99  COMP-3   VALUE +0. ECSRITAB
  1842     12  RS-R-LB                 PIC S9(9)V99  COMP-3   VALUE +0. ECSRITAB
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  48
* ECS150.cbl (/apps/prod/cid1p/copy/ECSRITAB)
  1843     12  RS-R-LP                 PIC S9(7)V99  COMP-3   VALUE +0. ECSRITAB
  1844     12  RS-R-AB                 PIC S9(9)V99  COMP-3   VALUE +0. ECSRITAB
  1845     12  RS-R-AP                 PIC S9(7)V99  COMP-3   VALUE +0. ECSRITAB
  1846     12  RS-R-LPC                PIC S9(7)V99  COMP-3   VALUE +0. ECSRITAB
  1847     12  RS-R-APC                PIC S9(7)V99  COMP-3   VALUE +0. ECSRITAB
  1848     12  BIN-RWF-EP-STOP-DT      PIC XX        VALUE SPACES.      ECSRITAB
  1849     12  BIN-CNT                 PIC 9(3)      VALUE ZEROES.      ECSRITAB
  1850     12  BIN-CR-DIS-DT           PIC XX        VALUE SPACES.      ECSRITAB
  1851     12  BIN-WT-HIGH-DT          PIC XX        VALUE SPACES.      ECSRITAB
  1852     12  BIN-WT-LO-DT            PIC XX        VALUE SPACES.      ECSRITAB
  1853     12  BIN-LF-CANC-DT          PIC XX        VALUE SPACES.      ECSRITAB
  1854     12  BIN-AH-CANC-DT          PIC XX        VALUE SPACES.      ECSRITAB
  1855     12  BIN-CR-DTH-DT           PIC XX        VALUE SPACES.      ECSRITAB
  1856                                                                  ECSRITAB
  1857 01  REIN-CO-HOLD-TABLE.                                          ECSRITAB
  1858* ELCPSEVR MUST BE MODIFIED IF THE "OCCURS" IS CHANGED.           ECSRITAB
  1859     12  REIN-CO-HOLD-ENTRIES  OCCURS 1500 TIMES.                 ECSRITAB
  1860         16  RCT-REIN-CO         PIC X(6).                        ECSRITAB
  1861         16  RCT-CLM-CUTOFF-DT   PIC 9(11)  COMP-3.               ECSRITAB
  1862         16  RCT-EARNING-START-DT PIC 9(11)  COMP-3.              ECSRITAB
  1863         16  RCT-EARNING-STOP-DT PIC 9(11)  COMP-3.               ECSRITAB
  1864         16  RCT-EARN-STOP-CODE  PIC X.                           ECSRITAB
  1865         16  RCT-LF-CLM-PCT      PIC S9V9(4)    COMP-3.           ECSRITAB
  1866         16  RCT-LF-CLM-MAX      PIC S9(9)V99   COMP-3.           ECSRITAB
  1867         16  RCT-AH-CLM-PCT      PIC S9V9(4)    COMP-3.           ECSRITAB
  1868         16  RCT-AH-CLM-MAX      PIC S9(9)V99   COMP-3.           ECSRITAB
  1869                                                                  ECSRITAB
  1870 01  REIN-CO-HOLD-TABLE-2.                                        ECSRITAB
  1871     12  RC2-CO-HOLD-ENTRIES  OCCURS 1500 TIMES.                  ECSRITAB
  1872         16  RC2-REIN-CO.                                         ECSRITAB
  1873             20  RC2-CO-PRIME    PIC XXX.                         ECSRITAB
  1874             20  RC2-CO-SUB      PIC XXX.                         ECSRITAB
  1875         16  RC2-LF-R78-PCT      PIC S9V9(4)    COMP-3.           ECSRITAB
  1876         16  RC2-LF-PRO-PCT      PIC S9V9(4)    COMP-3.           ECSRITAB
  1877         16  RC2-AH-R78-PCT      PIC S9V9(4)    COMP-3.           ECSRITAB
  1878         16  RC2-AH-PRO-PCT      PIC S9V9(4)    COMP-3.           ECSRITAB
  1879         16  RC2-CO-NAME         PIC X(30).                       ECSRITAB
  1880         16  RC2-ECS152-RPT      PIC X.                           ECSRITAB
  1881                                                                  ECSRITAB
  1882 01  REIN-MORT-CD-HOLD-TABLE.                                     ECSRITAB
  1883     12  REIN-MORT-CD-ENTRIES  OCCURS 1500 TIMES.                 ECSRITAB
  1884         16  RCT-MORT-CO         PIC X(6).                        ECSRITAB
  1885         16  RCT-MORT-CODE       PIC X(4).                        ECSRITAB
  1886     12  REIN-INDEX              PIC S9(4)    COMP    VALUE +0.   ECSRITAB
  1887                                                                  ECSRITAB
  1888 01  BIN-RCT-ITEMS-TABLE.                                         ECSRITAB
  1889     12  BIN-RCT-ITEMS OCCURS 1500 TIMES.                         ECSRITAB
  1890         16  BIN-RCT-CLM-CUTOFF-DT    PIC XX.                     ECSRITAB
  1891         16  BIN-RCT-EARNING-START-DT PIC XX.                     ECSRITAB
  1892         16  BIN-RCT-EARNING-STOP-DT  PIC XX.                     ECSRITAB
  1893 01  BIN-RW-ITEMS-TABLE.                                          ECSRITAB
  1894     12  BIN-RW-ITEMS OCCURS 5 TIMES.                             ECSRITAB
  1895         16  BIN-RW-AH-INCUR-DT       PIC XX.                     ECSRITAB
  1896                                                                  ECSRITAB
  1897 01  REIN-CO-TABLE-ENT-CNT       PIC S9(4)    COMP-3  VALUE +1500.ECSRITAB
  1898******************************************************************ECSRITAB
* 1899                             COPY ELCPSEVR.
  1900******************************************************************04/16/98
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  49
* ECS150.cbl (/apps/prod/cid1p/copy/ELCPSEVR)
  1901*                                                                *ELCPSEVR
  1902*                                                                *ELCPSEVR
  1903*                            ELCPSEVR                            *   LV003
  1904*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  1905*                            VMOD=2.001                          *ELCPSEVR
  1906*                                                                *ELCPSEVR
  1907*   WORKING STORAGE FOR DATE VARIABLES CREATED                   *ELCPSEVR
  1908*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCPSEVR
  1909*                                                                *ELCPSEVR
  1910******************************************************************ELCPSEVR
  1911                                                                  ELCPSEVR
  1912 01  WS-PD-SUMMARY-DETAIL-EXTR-DT.                                ELCPSEVR
  1913     05  WS-PSC-CID-LOW.                                          ELCPSEVR
  1914         10  FILLER               PIC 999.                        ELCPSEVR
  1915         10  PSC-CID-LOW-CCYY     PIC 9(04).                      ELCPSEVR
  1916         10  PSC-CID-LOW-CCYR  REDEFINES  PSC-CID-LOW-CCYY.       ELCPSEVR
  1917             15  PSC-CID-LOW-CC   PIC 99.                            CL**3
  1918             15  PSC-CID-LOW-YY   PIC 99.                            CL**3
  1919         10  PSC-CID-LOW-MM       PIC 99.                            CL**3
  1920         10  PSC-CID-LOW-DD       PIC 99.                            CL**3
  1921     05  WS-PSC-CID-LOW-N REDEFINES                                  CL**2
  1922            WS-PSC-CID-LOW        PIC 9(11).                         CL**2
  1923     05  WS-PSC-CID-HIGH.                                         ELCPSEVR
  1924         10  FILLER              PIC 999.                         ELCPSEVR
  1925         10  PSC-CID-HIGH-CCYY   PIC 9(04).                       ELCPSEVR
  1926         10  PSC-CID-HIGH-CCYR  REDEFINES  PSC-CID-HIGH-CCYY.     ELCPSEVR
  1927             15  PSC-CID-HIGH-CC PIC 99.                             CL**3
  1928             15  PSC-CID-HIGH-YY PIC 99.                             CL**3
  1929         10  PSC-CID-HIGH-MM     PIC 99.                             CL**3
  1930         10  PSC-CID-HIGH-DD     PIC 99.                             CL**3
  1931     05  WS-PSC-CID-HIGH-N REDEFINES                                 CL**2
  1932            WS-PSC-CID-HIGH          PIC 9(11).                      CL**2
  1933 01  WS-REIN-WORK-AREAS.                                          ELCPSEVR
  1934     05  WS-REIN-CO-HOLD-ENTRIES  OCCURS 1500 TIMES               ELCPSEVR
  1935                 INDEXED BY CPSE-NDX.                             ELCPSEVR
  1936         10  WS-RCT-CLM-CUTOFF-DT.                                ELCPSEVR
  1937             15  FILLER              PIC 999.                     ELCPSEVR
  1938             15  RCT-CUTOFF-CCYY     PIC 9(04).                   ELCPSEVR
  1939             15  RCT-CUTOFF-CCYR  REDEFINES  RCT-CUTOFF-CCYY.     ELCPSEVR
  1940                 20  RCT-CUTOFF-CC   PIC 99.                      ELCPSEVR
  1941                 20  RCT-CUTOFF-YR   PIC 99.                      ELCPSEVR
  1942             15  RCT-CUTOFF-MO       PIC 99.                      ELCPSEVR
  1943             15  RCT-CUTOFF-DA       PIC 99.                      ELCPSEVR
  1944         10  WS-RCT-CLM-CUTOFF-DT-N REDEFINES                        CL**2
  1945                WS-RCT-CLM-CUTOFF-DT PIC 9(11).                      CL**2
  1946         10  WS-RCT-EARNING-START-DT.                             ELCPSEVR
  1947             15  FILLER              PIC 999.                     ELCPSEVR
  1948             15  RCT-START-CCYY      PIC 9(04).                   ELCPSEVR
  1949             15  RCT-START-CCYR  REDEFINES  RCT-START-CCYY.       ELCPSEVR
  1950                 20  RCT-START-CC    PIC 99.                      ELCPSEVR
  1951                 20  RCT-START-YR    PIC 99.                      ELCPSEVR
  1952             15  RCT-START-MO        PIC 99.                      ELCPSEVR
  1953             15  RCT-START-DA        PIC 99.                      ELCPSEVR
  1954         10  WS-RCT-EARNING-START-DT-N REDEFINES                     CL**2
  1955                WS-RCT-EARNING-START-DT  PIC 9(11).                  CL**2
  1956         10  WS-RCT-EARNING-STOP-DT.                              ELCPSEVR
  1957             15  FILLER              PIC 999.                     ELCPSEVR
  1958             15  RCT-STOP-CCYY       PIC 9(04).                   ELCPSEVR
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  50
* ECS150.cbl (/apps/prod/cid1p/copy/ELCPSEVR)
  1959             15  RCT-STOP-CCYR  REDEFINES  RCT-STOP-CCYY.         ELCPSEVR
  1960                 20  RCT-STOP-CC     PIC 99.                      ELCPSEVR
  1961                 20  RCT-STOP-YR     PIC 99.                      ELCPSEVR
  1962             15  RCT-STOP-MO         PIC 99.                      ELCPSEVR
  1963             15  RCT-STOP-DA         PIC 99.                      ELCPSEVR
  1964         10  WS-RCT-EARNING-STOP-DT-N REDEFINES                      CL**2
  1965                WS-RCT-EARNING-STOP-DT   PIC 9(11).                  CL**2
  1966     05  WS-RWF-EP-STOP-DATE.                                     ELCPSEVR
  1967         10  FILLER              PIC 999.                         ELCPSEVR
  1968         10  RWF-EP-STOP-CCYY    PIC 9(04).                       ELCPSEVR
  1969         10  RWF-EP-STOP-CCYR REDEFINES  RWF-EP-STOP-CCYY.        ELCPSEVR
  1970             15  RWF-EP-STOP-CC  PIC 99.                          ELCPSEVR
  1971             15  RWF-EP-STOP-YR  PIC 99.                          ELCPSEVR
  1972         10  RWF-EP-STOP-MO      PIC 99.                          ELCPSEVR
  1973         10  RWF-EP-STOP-DA      PIC 99.                          ELCPSEVR
  1974     05  WS-RWF-EP-STOP-DATE-N REDEFINES                             CL**2
  1975            WS-RWF-EP-STOP-DATE  PIC 9(11).                          CL**2
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  51
* ECS150.cbl
  1977 01  CLAS150-EXTRACT-RECORD.
  1978     12  ER-SORT-KEY.
  1979         16  ER-CONTROL.
  1980             20  ER-REINS-CO             PIC X(06).
  1981             20  ER-CARRIER              PIC X(01).
  1982             20  ER-COMPANY              PIC X(06).
  1983             20  ER-STATE                PIC X(02).
  1984             20  ER-ACCOUNT              PIC X(10).
  1985         16  ER-ST-SEQ                   PIC X(02).
  1986         16  ER-REC-TYPE                 PIC 99.
  1987     12  ER-PERIOD-START                 PIC 9(11)  COMP-3.
  1988     12  ER-PERIOD-END                   PIC 9(11)  COMP-3.
  1989     12  ER-ACTIVITY-TOTALS.
  1990         16  ER-TERM-GROUP OCCURS 3 TIMES.
  1991*                1= 0-60 MONTHS
  1992*                2= 61-120 MONTHS
  1993*                3= 121 AND OVER
  1994             20  ER-TYPE-GROUPS OCCURS 10 TIMES.
  1995*                1= LIFE(R-GP)       6= LIFE(R-IND)
  1996*                2= LIFE(L-GP)       7= LIFE(L-IND)
  1997*                3= LIFE(OB-GP)      8= LIFE(OB-IND)
  1998*                4= AH(GP)           9= AH(IND)
  1999*                5= AH(OB-GP)       10= AH(OB-IND)
  2000                 24  ER-DETAIL.
  2001                     28  ER-ISSUE-CNT    PIC S9(13)    COMP-3.
  2002                     28  ER-ISSUE-AMT    PIC S9(11)V99 COMP-3.
  2003                     28  ER-ISSUE-PREM   PIC S9(11)V99 COMP-3.
  2004                     28  ER-CANCEL-CNT   PIC S9(13)    COMP-3.
  2005                     28  ER-CANCEL-AMT   PIC S9(11)V99 COMP-3.
  2006                     28  ER-CANCEL-PREM  PIC S9(11)V99 COMP-3.
  2007                     28  ER-CLAIM-CNT    PIC S9(13)    COMP-3.
  2008                     28  ER-CLAIM-AMT    PIC S9(11)V99 COMP-3.
  2009                     28  ER-EARN-PREM    PIC S9(11)V99 COMP-3.
  2010     12  ER-EXHIBIT-TOTALS.
  2011         16  ER-TERM-GROUP-E OCCURS 3 TIMES.
  2012*                1= 0-60 MONTHS
  2013*                2= 61-120 MONTHS
  2014*                3= 121 AND OVER
  2015             20  ER-LINE-DETAIL OCCURS 9 TIMES.
  2016*                1= INFORCE PREVIOUS PER  6= CANCELED IN PERIOD
  2017*                2= ISSUED IN PERIOD      7= DECREASES IN PERIOD
  2018*                3= TOTAL INFORCE-START   8= TOTAL DEC IN PERIOD
  2019*                4= DEATHS IN PERIOD      9= TOTAL INFORCE AT END
  2020*                5= EXPIRED IN PERIOD
  2021                 24  ER-DETAIL-E.
  2022                     28  ER-GROUP-CNT    PIC S9(13)    COMP-3.
  2023                     28  ER-GROUP-AMT    PIC S9(11)V99 COMP-3.
  2024                     28  ER-IND-CNT      PIC S9(13)    COMP-3.
  2025                     28  ER-IND-AMT      PIC S9(11)V99 COMP-3.
  2026
  2027     12  ER-AH-PD-THIS                   PIC S9(11)V99 COMP-3.
  2028     12  ER-AH-PD-LAST                   PIC S9(11)V99 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  52
* ECS150.cbl
* 2030                             COPY ECSCRT01.
  2031******************************************************************
  2032*                                                                *
  2033*                            ECSCRT01                            *
  2034*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2035*                            VMOD=2.016                          *
  2036*                                                                *
  2037*   FILE DESCRIPTION = CERTIFICATE RECORD    (OFF-LINE)          *
  2038*                                                                *
  2039*   FILE TYPE = SEQUENTIAL
  2040*   RECORD SIZE = 1056 RECFORM = FIXED                           *
  2041*                                                                *
  2042*   KEY DATA =                         START=4, LEN=36           *
  2043*                                                                *
  2044*  NO  CID  MODS  IN  COPYBOOK  ECSCRT01                         *
  2045*                                                                *
  2046******************************************************************
  2047******************************************************************
  2048*                   C H A N G E   L O G
  2049*
  2050* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2051*-----------------------------------------------------------------
  2052*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2053* EFFECTIVE    NUMBER
  2054*-----------------------------------------------------------------
  2055* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  2056* 100703    2003080800002  PEMA  ADD SUPER GAP PROCESSING
  2057* 040504    2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  2058* 020305    2005020000000  PEMA  ADD CLP STATE TO CERT RECORD
  2059* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  2060* 042408    2007110500003  PEMA  ADD REFUND INTEREST PROCESSING
  2061* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  2062* 032612  CR2011110200001  PEMA  AHL CHANGES
  2063* 052814  CR2014012300001  PEMA  DCC CREDIT UNION CHANGES
  2064* 090314  CR2014081300001  PEMA  LOAD CERTS INVOLVED IN THAO
  2065******************************************************************
  2066
  2067 01  CERTIFICATE-RECORD.
  2068     12  CR-RECORD-ID                      PIC XX.
  2069         88  VALID-CR-ID                      VALUE 'CR'.
  2070
  2071     12  CR-COMPANY-CD                     PIC X.
  2072
  2073     12  CR-FULL-CONTROL.
  2074         16  CR-CONTROL-1.
  2075             20  CR-ACCT-CONTROL.
  2076                 24  CR-CARRIER            PIC X.
  2077                 24  CR-GROUPING.
  2078                     28  CR-GROUP-PREFIX   PIC XXX.
  2079                     28  CR-GROUP-PRIME    PIC XXX.
  2080                 24  CR-STATE              PIC XX.
  2081                 24  CR-ACCOUNT.
  2082                     28  CR-ACCT-PREFIX    PIC X(4).
  2083                     28  CR-ACCT-PRIME     PIC X(6).
  2084             20  CR-DT                     PIC 9(11)  COMP-3.
  2085         16  CR-CERT-NO.
  2086             20  CR-CERT.
  2087                 24  CR-CERT-PREFIX        PIC X(3).
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  53
* ECS150.cbl (/apps/prod/cid1p/copy/ECSCRT01)
  2088                 24  CR-CERT-PRIME         PIC X(7).
  2089             20  CR-CERT-SFX               PIC X.
  2090
  2091     12  CR-INSUREDS-PROFILE.
  2092         16  CR-NAME.
  2093             20  CR-LNAME                  PIC X(15).
  2094             20  CR-FNAME.
  2095                 24  CR-1ST-INITIAL        PIC X.
  2096                 24  FILLER                PIC X(9).
  2097             20  CR-INIT                   PIC X.
  2098         16  CR-AGE                        PIC 99.
  2099         16  CR-SEX                        PIC X.
  2100             88  CR-SEX-MALE                  VALUE 'M'.
  2101             88  CR-SEX-FEMALE                VALUE 'F'.
  2102         16  CR-SOC-SEC                    PIC X(11).
  2103         16  CR-JOINT-NAME.
  2104             20  CR-JT-LNAME               PIC X(15).
  2105             20  CR-JT-FNAME.
  2106                 24  CR-JT-1ST-INIT        PIC X.
  2107                 24  FILLER                PIC X(9).
  2108             20  CR-JT-INIT                PIC X.
  2109         16  CR-JOINT-AGE                  PIC 99.
  2110
  2111         16  cr-ahl-ah-claim-no            pic x(9).
  2112         16  cr-ahl-ah-cert-seq            pic x(3).
  2113         16  cr-hst-proc-lf                pic x.
  2114         16  f                             pic x(7).
  2115
  2116     12  CR-LF-COVERAGE-DATA.
  2117         16  CR-LFTYP                      PIC XX.
  2118         16  CR-LF-TERM                    PIC S999       COMP-3.
  2119         16  CR-LF-CRIT-PERIOD             PIC S999       COMP-3.
  2120         16  CR-LF-TERM-IN-DAYS            PIC S9(5)      COMP-3.
  2121         16  CR-LF-DEV-CODE                PIC XXX.
  2122         16  CR-LF-DEV-PCT                 PIC S9V9(6)    COMP-3.
  2123
  2124         16  CR-LFAMT                      PIC S9(9)V99   COMP-3.
  2125         16  CR-LFPRM                      PIC S9(7)V99   COMP-3.
  2126         16  CR-LFPRM-CALC                 PIC S9(7)V99   COMP-3.
  2127         16  CR-LFPRM-RATE                 PIC S99V9(5)   COMP-3.
  2128
  2129         16  CR-LFAMT-ALT                  PIC S9(9)V99   COMP-3.
  2130         16  CR-LFPRM-ALT                  PIC S9(7)V99   COMP-3.
  2131         16  CR-LFPRM-CALC-ALT             PIC S9(7)V99   COMP-3.
  2132         16  CR-LFPRM-RATE-ALT             PIC S99V9(5)   COMP-3.
  2133
  2134         16  CR-LFRFND                     PIC S9(7)V99   COMP-3.
  2135         16  CR-LFRFND-CALC                PIC S9(7)V99   COMP-3.
  2136
  2137         16  CR-LF-NSP-PRM                 PIC S9(7)V99   COMP-3.
  2138         16  CR-LF-NSP-PRM-RATE            PIC S99V9(5)   COMP-3.
  2139
  2140         16  CR-LF-REFUND-TYPE             PIC X.
  2141         16  CR-LF-POLICY-FEE              PIC S9(3)V99   COMP-3.
  2142
  2143         16  CR-LF-COMM-CHARGEBACK         PIC X.
  2144             88  CR-NO-LF-CHARGEBACK          VALUE 'N'.
  2145
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  54
* ECS150.cbl (/apps/prod/cid1p/copy/ECSCRT01)
  2146         16  CR-LF-REI-RISK-PRM            PIC S9(7)V99   COMP-3.
  2147
  2148         16  CR-LF-EXPIRE-DATE             PIC 9(11)      COMP-3.
  2149         16  CR-LF-ISS-PREM-TAX            PIC S9V9(4)    COMP-3.
  2150         16  CR-LF-CNC-PREM-TAX            PIC S9V9(4)    COMP-3.
  2151
  2152         16  cr-ahl-lf-claim-no            pic x(9).
  2153         16  cr-ahl-lf-cert-seq            pic x(3).
  2154         16  FILLER                        PIC XX.
  2155
  2156     12  CR-AH-COVERAGE-DATA.
  2157         16  CR-AHTYP                      PIC XX.
  2158         16  CR-AH-TERM                    PIC S999       COMP-3.
  2159         16  CR-AH-CRIT-PERIOD             PIC S999       COMP-3.
  2160         16  CR-AH-DEV-CODE                PIC XXX.
  2161         16  CR-AH-DEV-PCT                 PIC S9V9(6)    COMP-3.
  2162
  2163         16  CR-AHAMT                      PIC S9(7)V99   COMP-3.
  2164         16  CR-AHPRM                      PIC S9(7)V99   COMP-3.
  2165         16  CR-AHPRM-CALC                 PIC S9(7)V99   COMP-3.
  2166         16  CR-AHPRM-RATE                 PIC S99V9(5)   COMP-3.
  2167
  2168         16  CR-AHRFND                     PIC S9(7)V99   COMP-3.
  2169         16  CR-AHRFND-CALC                PIC S9(7)V99   COMP-3.
  2170
  2171         16  CR-AH-NSP-PRM                 PIC S9(7)V99   COMP-3.
  2172         16  CR-AH-NSP-PRM-RATE            PIC S99V9(5)   COMP-3.
  2173
  2174         16  CR-AH-REFUND-TYPE             PIC X.
  2175         16  CR-AH-POLICY-FEE              PIC S9(3)V99   COMP-3.
  2176
  2177         16  CR-AH-COMM-CHARGEBACK         PIC X.
  2178             88  CR-NO-AH-CHARGEBACK          VALUE 'N'.
  2179
  2180         16  CR-AH-REI-RISK-PRM            PIC S9(7)V99   COMP-3.
  2181
  2182         16  CR-AH-EXPIRE-DATE             PIC 9(11)      COMP-3.
  2183         16  CR-AH-ISS-PREM-TAX            PIC S9V9(4)    COMP-3.
  2184         16  CR-AH-CNC-PREM-TAX            PIC S9V9(4)    COMP-3.
  2185
  2186         16  FILLER                        PIC XX.
  2187*        16  FILLER                        PIC X(8).
  2188
  2189     12  CR-LOAN-DATA.
  2190         16  CR-LIVES                      PIC S9(7)      COMP-3.
  2191         16  CR-DDF-IU-RATE-UP REDEFINES CR-LIVES
  2192                                           PIC S9(5)V99   COMP-3.
  2193         16  CR-BILLED                     PIC S9(7)      COMP-3.
  2194         16  CR-APR                        PIC S999V9(4)  COMP-3.
  2195         16  CR-PMT-FREQ                   PIC 99.
  2196         16  CR-LOAN-TERM                  PIC S999       COMP-3.
  2197         16  CR-RATING-CLASS               PIC XX.
  2198         16  CR-POLICY-FORM-NO             PIC X(12).
  2199         16  CR-GRPTYP                     PIC XX.
  2200         16  CR-IND-GRP                    PIC X.
  2201             88  CR-INDIVIDUAL                VALUE '1'.
  2202             88  CR-GROUP                     VALUE '2'.
  2203         16  CR-SKIP                       PIC 99.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  55
* ECS150.cbl (/apps/prod/cid1p/copy/ECSCRT01)
  2204             88  NO-MONTHS-SKIPPED            VALUE 00.
  2205             88  SKIP-JULY                    VALUE 01.
  2206             88  SKIP-AUGUST                  VALUE 02.
  2207             88  SKIP-SEPTEMBER               VALUE 03.
  2208             88  SKIP-JULY-AUG                VALUE 04.
  2209             88  SKIP-AUG-SEPT                VALUE 05.
  2210             88  SKIP-JULY-AUG-SEPT           VALUE 06.
  2211             88  SKIP-JUNE-JULY-AUG           VALUE 07.
  2212             88  SKIP-JUNE                    VALUE 08.
  2213             88  SKIP-JUNE-JULY               VALUE 09.
  2214             88  SKIP-AUG-SEPT-OCT            VALUE 10.
  2215             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 11.
  2216         16  CR-RESIDENT-STATE             PIC XX.
  2217         16  CR-RATE-CODE.
  2218             20  CR-LF-CLASS-CD            PIC XX.
  2219             20  CR-AH-CLASS-CD            PIC XX.
  2220         16  CR-MORT.
  2221             20  CR-TAB                    PIC X.
  2222             20  CR-INT                    PIC 99.
  2223             20  CR-GRP                    PIC X.
  2224         16  CR-MEMBER-NO                  PIC X(12).
  2225         16  CR-OLD-LOF                    PIC XXX.
  2226*        16  CR-LOAN-OFFICER               PIC XXX.
  2227         16  CR-REIN-TABLE                 PIC XXX.
  2228         16  CR-REIN-SPEC                  PIC X.
  2229         16  CR-LOAN-1ST-PMT-DT.
  2230             20  CR-1ST-PMT-YR             PIC 99.
  2231             20  CR-1ST-PMT-MO             PIC 99.
  2232             20  CR-1ST-PMT-DA             PIC 99.
  2233         16  CR-SUM-CAN-CNT-ITD            PIC S999       COMP-3.
  2234         16  CR-SUM-CAN-CNT-YTD            PIC S999       COMP-3.
  2235         16  CR-PMT-EXTENSION-DAYS         PIC S999       COMP-3.
  2236         16  CR-LAST-ADD-ON-DT             PIC XX.
  2237
  2238         16  CR-UNDERWRITING-CODE          PIC X.
  2239             88  CR-POLICY-UNDERWRITTEN       VALUE 'Y'.
  2240
  2241         16  CR-STATE-TAX                  PIC S9(7)V99   COMP-3.
  2242         16  CR-MUNI-TAX                   PIC S9(7)V99   COMP-3.
  2243         16  CR-CANCEL-STATE-TAX           PIC S9(7)V99   COMP-3.
  2244         16  CR-CANCEL-MUNI-TAX            PIC S9(7)V99   COMP-3.
  2245
  2246     12  CR-STATUS-INFORMATION.
  2247         16  CR-ENTRY-STATUS               PIC X.
  2248             88  CR-NORMAL-ENTRY              VALUE '1'.
  2249             88  CR-POLICY-IS-RESTORE         VALUE '3'.
  2250             88  CR-CONVERSION-ENTRY          VALUE '4'.
  2251             88  CR-POLICY-IS-REISSUE         VALUE '5'.
  2252             88  CR-POLICY-IS-CASH            VALUE 'C'.
  2253             88  CR-POLICY-IS-MONTHLY         VALUE 'M'.
  2254             88  CR-POLICY-IS-REIN-ONLY       VALUE '9'.
  2255             88  CR-POLICY-IS-DECLINED        VALUE 'D'.
  2256             88  CR-POLICY-IS-VOID            VALUE 'V'.
  2257             88  CR-POLICY-IS-PREM-ONLY       VALUE 'P'.
  2258             88  CR-POLICY-IS-ACTIVE          VALUE '1' '3' '4'
  2259                                                'C' '5' '9' 'P'.
  2260         16  CR-ENTRY-DATE                 PIC 9(11)  COMP-3.
  2261
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  56
* ECS150.cbl (/apps/prod/cid1p/copy/ECSCRT01)
  2262         16  CR-LF-STATUS-AT-CANCEL        PIC X.
  2263         16  CR-LF-CANC-DT                 PIC 9(11)  COMP-3.
  2264         16  CR-LF-CANCEL-EXIT-DATE        PIC 9(11)  COMP-3.
  2265
  2266         16  CR-LF-STATUS-AT-DEATH         PIC X.
  2267         16  CR-LF-CLAIM-EXIT-DATE         PIC 9(11)  COMP-3.
  2268
  2269         16  CR-LF-CURRENT-STATUS          PIC X.
  2270             88  CR-LF-NORMAL-ENTRY           VALUE '1'.
  2271             88  CR-LF-POLICY-PENDING         VALUE '2'.
  2272             88  CR-LF-POLICY-IS-RESTORE      VALUE '3'.
  2273             88  CR-LF-CONVERSION-ENTRY       VALUE '4'.
  2274             88  CR-LF-POLICY-IS-REISSUE      VALUE '5'.
  2275             88  CR-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  2276             88  CR-LF-LUMP-SUM-DISAB         VALUE '6'.
  2277             88  CR-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  2278             88  CR-LF-CANCEL-APPLIED         VALUE '8'.
  2279             88  CR-LF-IS-REIN-ONLY           VALUE '9'.
  2280             88  CR-LF-IS-DECLINED            VALUE 'D'.
  2281             88  CR-LF-IS-VOID                VALUE 'V'.
  2282             88  CR-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  2283                                                    '4' '5' '9'.
  2284
  2285         16  CR-AH-STATUS-AT-CANCEL        PIC X.
  2286
  2287         16  CR-AH-CANC-DT                 PIC 9(11)  COMP-3.
  2288         16  CR-AH-CANCEL-EXIT-DATE        PIC 9(11)  COMP-3.
  2289
  2290         16  CR-AH-STATUS-AT-SETTLEMENT    PIC X.
  2291         16  CR-AH-SETTLEMENT-EXIT-DATE    PIC 9(11)  COMP-3.
  2292
  2293         16  CR-AH-CURRENT-STATUS          PIC X.
  2294             88  CR-AH-NORMAL-ENTRY           VALUE '1'.
  2295             88  CR-AH-POLICY-PENDING         VALUE '2'.
  2296             88  CR-AH-POLICY-IS-RESTORE      VALUE '3'.
  2297             88  CR-AH-CONVERSION-ENTRY       VALUE '4'.
  2298             88  CR-AH-POLICY-IS-REISSUE      VALUE '5'.
  2299             88  CR-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  2300             88  CR-AH-LUMP-SUM-DISAB         VALUE '6'.
  2301             88  CR-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  2302             88  CR-AH-CANCEL-APPLIED         VALUE '8'.
  2303             88  CR-AH-IS-REIN-ONLY           VALUE '9'.
  2304             88  CR-AH-IS-DECLINED            VALUE 'D'.
  2305             88  CR-AH-IS-VOID                VALUE 'V'.
  2306             88  CR-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  2307                                                    '4' '5' '9'.
  2308         16  CR-LOAN-OFFICER               PIC X(5).
  2309         16  CR-CANCEL-REASON              PIC X.
  2310         16  cr-xycor-lf-cov-code          pic x(4).
  2311         16  cr-xycor-ah-cov-code          pic x(4).
  2312         16  cr-temp-epiq                  pic x(4).
  2313         16  FILLER                        PIC XX.
  2314
  2315     12  CR-DEATH-CLAIM-DATA.
  2316         16  CR-NUM-DTH-CLM                PIC S999       COMP-3.
  2317
  2318         16  CR-DTH-DT                     PIC 9(11)      COMP-3.
  2319         16  CR-DTH-RPT-DT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  57
* ECS150.cbl (/apps/prod/cid1p/copy/ECSCRT01)
  2320             20  CR-DTH-RPT-YR             PIC 99.
  2321             20  CR-DTH-RPT-MO             PIC 99.
  2322             20  CR-DTH-RPT-DA             PIC 99.
  2323         16  CR-DTH-PAY-DT                 PIC 9(11)      COMP-3.
  2324
  2325         16  CR-DTHAMT                     PIC S9(9)V99   COMP-3.
  2326         16  CR-DTHAMT-YTD                 PIC S9(9)V99   COMP-3.
  2327         16  CR-DTHAMT-LAST                PIC S9(9)V99   COMP-3.
  2328         16  CR-DTHEXP                     PIC S9(7)V99   COMP-3.
  2329         16  CR-DTHEXP-YTD                 PIC S9(7)V99   COMP-3.
  2330
  2331         16  CR-DTH-AGE                    PIC 99.
  2332         16  CR-DTH-PAY-CD                 PIC X.
  2333         16  CR-DEATH-CAUSE                PIC X(6).
  2334
  2335         16  FILLER                        PIC X(16).
  2336
  2337     12  CR-DISAB-CLAIM-DATA.
  2338         16  CR-NUM-DIS-CLM                PIC S999       COMP-3.
  2339
  2340         16  CR-DIS-DT                     PIC 9(11)      COMP-3.
  2341         16  CR-DIS-RPT-DT.
  2342             20  CR-DIS-RPT-YR             PIC 99.
  2343             20  CR-DIS-RPT-MO             PIC 99.
  2344             20  CR-DIS-RPT-DA             PIC 99.
  2345         16  CR-DIS-PAY-DT                 PIC 9(11)      COMP-3.
  2346         16  CR-DIS-PTO-DT                 PIC 9(11)      COMP-3.
  2347
  2348         16  CR-DISAMT                     PIC S9(9)V99   COMP-3.
  2349         16  CR-DISAMT-YTD                 PIC S9(9)V99   COMP-3.
  2350         16  CR-DISAMT-LAST                PIC S9(9)V99   COMP-3.
  2351         16  CR-DISEXP                     PIC S9(7)V99   COMP-3.
  2352         16  CR-DISEXP-YTD                 PIC S9(7)V99   COMP-3.
  2353
  2354         16  CR-DAYS-DISAB                 PIC 999        COMP-3.
  2355         16  CR-DIS-PAY-CD                 PIC X.
  2356         16  FILLER                        PIC XX.
  2357
  2358         16  CR-DISAB-INCURRED-DETAIL.
  2359             20  CR-DISAB-DETAIL-DATA  OCCURS 5 TIMES.
  2360**ELCCRTVR MUST BE CHANGED IF THE "OCCURS" IS CHANGED.
  2361                 24  CR-DIS-INCUR-DT       PIC 9(11)     COMP-3.
  2362                 24  CR-INCUR-DISAMT       PIC S9(9)V99  COMP-3.
  2363                 24  CR-INCUR-DISEXP       PIC S9(9)V99  COMP-3.
  2364
  2365         16  CR-DISAB-CAUSE                PIC X(6).
  2366         16  FILLER                        PIC X(14).
  2367
  2368     12  CR-REMIT-TO                       PIC 99.
  2369
  2370     12  CR-COMPENSATION-LEVELS.
  2371         16  CR-AGT-LEVELS      OCCURS 10 TIMES.
  2372             20  CR-COM-AGT.
  2373                 24  CR-COM-AGT-PREFIX     PIC X(4).
  2374                 24  CR-COM-AGT-PRIME      PIC X(6).
  2375             20  CR-AGT-TYPE               PIC X.
  2376             20  CR-LCOM-L                 PIC SV9(5)     COMP-3.
  2377             20  CR-LCOM-AH                PIC SV9(5)     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  58
* ECS150.cbl (/apps/prod/cid1p/copy/ECSCRT01)
  2378
  2379     12  CR-BANK-NOCHRGB-MONTHS            PIC 99.
  2380     12  CR-MOB-NET-TOT-FEES               PIC S9(7)V99   COMP-3.
  2381     12  CR-ADDL-CLP                       PIC S9(5)V99   COMP-3.
  2382     12  CR-CLP-STATE                      PIC XX.
  2383     12  CR-POST-CARD-IND                  PIC X.
  2384     12  CR-LF-CLP                         PIC S9(5)V99   COMP-3.
  2385     12  CR-AH-CLP                         PIC S9(5)V99   COMP-3.
  2386     12  CR-DCC-PRODUCT-CODE               PIC XXX.
  2387     12  CR-LF-RFND-CLP                    PIC S9(5)V99   COMP-3.
  2388     12  CR-AH-RFND-CLP                    PIC S9(5)V99   COMP-3.
  2389     12  FILLER                            PIC X(07).
  2390
  2391     12  CR-CSR-CODE                       PIC XXX.
  2392
  2393     12  CR-CLAIM-DEDUCT-WITHHELD          PIC S9(5)V99   COMP-3.
  2394     12  CR-CANCEL-DEDUCT-WITHHELD         PIC S9(5)V99   COMP-3.
  2395
  2396     12  CR-MICROFILM-NUMBERS.
  2397*        16  CR-ISS-MICROFILM-NO           PIC S9(9)      COMP-3.
  2398         16  FILLER                        PIC X(5).
  2399     12  CR-NH-INT-ON-REF                  PIC S9(7)V99   COMP-3.
  2400
  2401     12  CR-USER-CODE                      PIC X.
  2402     12  CR-USER-FUTURE                    PIC X(9).
  2403
  2404     12  CR-BENEFICIARY.
  2405         16  CR-BANK-NO                    PIC X(10).
  2406         16  FILLER                        PIC X(15).
  2407
  2408     12  CR-ENTRY-BATCH                    PIC X(6).
  2409     12  CR-LF-EXIT-BATCH                  PIC X(6).
  2410     12  CR-AH-EXIT-BATCH                  PIC X(6).
  2411
  2412     12  CR-NOTE-SW                        PIC X.
  2413
  2414     12  CR-ORIGIN-INDICATOR               PIC X.
  2415         88  CR-ENTERED-MANUALLY              VALUE '1'.
  2416         88  CR-CREATED-FROM-TAPE-LOAD        VALUE '2'.
  2417
  2418     12  CR-LF-CNC-ENT-DT                  PIC 9(11)  COMP-3.
  2419     12  CR-AH-CNC-ENT-DT                  PIC 9(11)  COMP-3.
  2420     12  FILLER                            PIC X(33).
  2421
  2422******************************************************************
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  59
* ECS150.cbl
* 2424                             COPY ELCDATE.
  2425******************************************************************06/11/98
  2426*                                                                *ELCDATE
  2427*                                                                *ELCDATE
  2428*                            ELCDATE.                            *   LV023
  2429*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL*16
  2430*                            VMOD=2.003                           ELCDATE
  2431*                                                                *ELCDATE
  2432*                                                                *ELCDATE
  2433*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *ELCDATE
  2434*                 LENGTH = 200                                   *   CL*19
  2435******************************************************************ELCDATE
  2436                                                                  ELCDATE
  2437 01  DATE-CONVERSION-DATA.                                        ELCDATE
  2438     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.    CL*19
  2439     12  DC-OPTION-CODE                PIC X.                        CL*15
  2440         88  BIN-TO-GREG                VALUE ' '.                ELCDATE
  2441         88  ELAPSED-BETWEEN-BIN        VALUE '1'.                ELCDATE
  2442         88  EDIT-GREG-TO-BIN           VALUE '2'.                ELCDATE
  2443         88  YMD-GREG-TO-BIN            VALUE '3'.                ELCDATE
  2444         88  MDY-GREG-TO-BIN            VALUE '4'.                ELCDATE
  2445         88  JULIAN-TO-BIN              VALUE '5'.                ELCDATE
  2446         88  BIN-PLUS-ELAPSED           VALUE '6'.                ELCDATE
  2447         88  FIND-CENTURY               VALUE '7'.                   CL*22
  2448         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.                ELCDATE
  2449         88  EDIT-GREG-TO-BIN-3         VALUE '9'.                ELCDATE
  2450         88  YMD-GREG-TO-BIN-3          VALUE 'A'.                ELCDATE
  2451         88  MDY-GREG-TO-BIN-3          VALUE 'B'.                ELCDATE
  2452         88  JULIAN-TO-BIN-3            VALUE 'C'.                ELCDATE
  2453         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.                ELCDATE
  2454         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.                   CL*14
  2455         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.                   CL*14
  2456         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.                   CL*14
  2457         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.         CL*14
  2458         88  CHECK-LEAP-YEAR            VALUE 'H'.                   CL*14
  2459         88  BIN-3-TO-GREG              VALUE 'I'.                   CL*14
  2460         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.                   CL*14
  2461         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.                   CL*14
  2462         88  CYMD-GREG-TO-BIN           VALUE 'L'.                   CL*14
  2463         88  MDCY-GREG-TO-BIN           VALUE 'M'.                   CL*14
  2464         88  MDY-GREG-TO-JULIAN         VALUE 'N'.                   CL*14
  2465         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.                   CL*14
  2466         88  YMD-GREG-TO-JULIAN         VALUE 'P'.                   CL*14
  2467         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.                   CL*14
  2468         88  THREE-CHARACTER-BIN                                  ELCDATE
  2469                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.       CL*14
  2470         88  GREGORIAN-TO-BIN                                        CL**2
  2471                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.    CL*14
  2472         88  BIN-TO-GREGORIAN                                        CL**2
  2473                  VALUES ' ' '1' 'I' '8' 'G'.                        CL*14
  2474         88  JULIAN-TO-BINARY                                        CL**2
  2475                  VALUES '5' 'C' 'E' 'F'.                            CL*14
  2476     12  DC-ERROR-CODE                 PIC X.                        CL*15
  2477         88  NO-CONVERSION-ERROR        VALUE ' '.                   CL**3
  2478         88  DATE-CONVERSION-ERROR                                ELCDATE
  2479                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.        CL*14
  2480         88  DATE-IS-ZERO               VALUE '1'.                ELCDATE
  2481         88  DATE-IS-NON-NUMERIC        VALUE '2'.                ELCDATE
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  60
* ECS150.cbl (/apps/prod/cid1p/copy/ELCDATE)
  2482         88  DATE-IS-INVALID            VALUE '3'.                ELCDATE
  2483         88  DATE1-GREATER-DATE2        VALUE '4'.                ELCDATE
  2484         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.                ELCDATE
  2485         88  DATE-INVALID-OPTION        VALUE '9'.                ELCDATE
  2486         88  INVALID-CENTURY            VALUE 'A'.                ELCDATE
  2487         88  ONLY-CENTURY               VALUE 'B'.                ELCDATE
  2488         88  ONLY-LEAP-YEAR             VALUE 'C'.                ELCDATE
  2489         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.              CL**3
  2490     12  DC-END-OF-MONTH               PIC X.                        CL*15
  2491         88  CALCULATE-END-OF-MONTH     VALUE '1'.                ELCDATE
  2492     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.         CL*15
  2493         88  USE-NORMAL-PROCESS         VALUE ' '.                ELCDATE
  2494         88  ADJUST-DOWN-100-YRS        VALUE '1'.                ELCDATE
  2495         88  ADJUST-UP-100-YRS          VALUE '2'.                ELCDATE
  2496     12  FILLER                        PIC X.                        CL*15
  2497     12  DC-CONVERSION-DATES.                                        CL*15
  2498         16  DC-BIN-DATE-1             PIC XX.                       CL*15
  2499         16  DC-BIN-DATE-2             PIC XX.                       CL*15
  2500         16  DC-GREG-DATE-1-EDIT       PIC X(08).                    CL*15
  2501         16  DC-GREG-DATE-1-EDIT-R REDEFINES                         CL*15
  2502                       DC-GREG-DATE-1-EDIT.                       ELCDATE
  2503             20  DC-EDIT1-MONTH        PIC 99.                       CL*15
  2504             20  SLASH1-1              PIC X.                        CL*15
  2505             20  DC-EDIT1-DAY          PIC 99.                       CL*15
  2506             20  SLASH1-2              PIC X.                        CL*15
  2507             20  DC-EDIT1-YEAR         PIC 99.                       CL*15
  2508         16  DC-GREG-DATE-2-EDIT       PIC X(08).                    CL*15
  2509         16  DC-GREG-DATE-2-EDIT-R REDEFINES                         CL*15
  2510                     DC-GREG-DATE-2-EDIT.                         ELCDATE
  2511             20  DC-EDIT2-MONTH        PIC 99.                       CL*15
  2512             20  SLASH2-1              PIC X.                        CL*15
  2513             20  DC-EDIT2-DAY          PIC 99.                       CL*15
  2514             20  SLASH2-2              PIC X.                        CL*15
  2515             20  DC-EDIT2-YEAR         PIC 99.                       CL*15
  2516         16  DC-GREG-DATE-1-YMD        PIC 9(06).                    CL*15
  2517         16  DC-GREG-DATE-1-YMD-R  REDEFINES                         CL*15
  2518                     DC-GREG-DATE-1-YMD.                          ELCDATE
  2519             20  DC-YMD-YEAR           PIC 99.                       CL*15
  2520             20  DC-YMD-MONTH          PIC 99.                       CL*15
  2521             20  DC-YMD-DAY            PIC 99.                       CL*15
  2522         16  DC-GREG-DATE-1-MDY        PIC 9(06).                    CL*15
  2523         16  DC-GREG-DATE-1-MDY-R REDEFINES                          CL*15
  2524                      DC-GREG-DATE-1-MDY.                         ELCDATE
  2525             20  DC-MDY-MONTH          PIC 99.                       CL*15
  2526             20  DC-MDY-DAY            PIC 99.                       CL*15
  2527             20  DC-MDY-YEAR           PIC 99.                       CL*15
  2528         16  DC-GREG-DATE-1-ALPHA.                                   CL*15
  2529             20  DC-ALPHA-MONTH        PIC X(10).                    CL*15
  2530             20  DC-ALPHA-DAY          PIC 99.                       CL*15
  2531             20  FILLER                PIC XX.                       CL*15
  2532             20  DC-ALPHA-CENTURY.                                   CL*15
  2533                 24 DC-ALPHA-CEN-N     PIC 99.                       CL*15
  2534             20  DC-ALPHA-YEAR         PIC 99.                       CL*15
  2535         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.           CL*15
  2536         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.           CL*15
  2537         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.           CL*15
  2538         16  DC-JULIAN-DATE            PIC 9(05).                    CL*15
  2539         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE                CL*20
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  61
* ECS150.cbl (/apps/prod/cid1p/copy/ELCDATE)
  2540                                       PIC 9(05).                    CL*20
  2541         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.                  CL*15
  2542             20  DC-JULIAN-YEAR        PIC 99.                       CL*15
  2543             20  DC-JULIAN-DAYS        PIC 999.                      CL*15
  2544         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.       CL*15
  2545         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.    CL*15
  2546         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.    CL*15
  2547     12  DATE-CONVERSION-VARIBLES.                                   CL*15
  2548         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.            CL*15
  2549         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.          CL*15
  2550             20  FILLER                PIC 9(3).                     CL*15
  2551             20  HOLD-CEN-1-CCYY.                                    CL*15
  2552                 24  HOLD-CEN-1-CC     PIC 99.                       CL*17
  2553                 24  HOLD-CEN-1-YY     PIC 99.                       CL*17
  2554             20  HOLD-CEN-1-MO         PIC 99.                       CL*17
  2555             20  HOLD-CEN-1-DA         PIC 99.                       CL*17
  2556         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.            CL*15
  2557             20  HOLD-CEN-1-R-MO       PIC 99.                       CL*17
  2558             20  HOLD-CEN-1-R-DA       PIC 99.                       CL*17
  2559             20  HOLD-CEN-1-R-CCYY.                                  CL*15
  2560                 24  HOLD-CEN-1-R-CC   PIC 99.                       CL*17
  2561                 24  HOLD-CEN-1-R-YY   PIC 99.                       CL*17
  2562             20  FILLER                PIC 9(3).                     CL*15
  2563         16  HOLD-CENTURY-1-X.                                       CL*15
  2564             20  FILLER                PIC X(3)  VALUE SPACES.       CL*15
  2565             20  HOLD-CEN-1-X-CCYY.                                  CL*15
  2566                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.          CL*17
  2567                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.          CL*17
  2568             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.          CL*17
  2569             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.          CL*17
  2570         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.          CL*15
  2571             20  HOLD-CEN-1-R-X-MO     PIC XX.                       CL*17
  2572             20  HOLD-CEN-1-R-X-DA     PIC XX.                       CL*17
  2573             20  HOLD-CEN-1-R-X-CCYY.                                CL*15
  2574                 24  HOLD-CEN-1-R-X-CC PIC XX.                       CL*17
  2575                 24  HOLD-CEN-1-R-X-YY PIC XX.                       CL*17
  2576             20  FILLER                PIC XXX.                      CL*23
  2577         16  DC-BIN-DATE-EXPAND-1      PIC XXX.                      CL*15
  2578         16  DC-BIN-DATE-EXPAND-2      PIC XXX.                      CL*15
  2579         16  DC-JULIAN-DATE-1          PIC 9(07).                    CL*15
  2580         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.          CL*15
  2581             20  DC-JULIAN-1-CCYY.                                   CL*15
  2582                 24  DC-JULIAN-1-CC    PIC 99.                       CL*15
  2583                 24  DC-JULIAN-1-YR    PIC 99.                       CL*15
  2584             20  DC-JULIAN-DA-1        PIC 999.                      CL*15
  2585         16  DC-JULIAN-DATE-2          PIC 9(07).                    CL*15
  2586         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.          CL*15
  2587             20  DC-JULIAN-2-CCYY.                                   CL*15
  2588                 24  DC-JULIAN-2-CC    PIC 99.                       CL*15
  2589                 24  DC-JULIAN-2-YR    PIC 99.                       CL*15
  2590             20  DC-JULIAN-DA-2        PIC 999.                      CL*15
  2591         16  DC-GREG-DATE-A-EDIT.                                    CL*15
  2592             20  DC-EDITA-MONTH        PIC 99.                       CL*15
  2593             20  SLASHA-1              PIC X VALUE '/'.              CL*15
  2594             20  DC-EDITA-DAY          PIC 99.                       CL*15
  2595             20  SLASHA-2              PIC X VALUE '/'.              CL*15
  2596             20  DC-EDITA-CCYY.                                      CL*15
  2597                 24  DC-EDITA-CENT     PIC 99.                       CL*15
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  62
* ECS150.cbl (/apps/prod/cid1p/copy/ELCDATE)
  2598                 24  DC-EDITA-YEAR     PIC 99.                       CL*15
  2599         16  DC-GREG-DATE-B-EDIT.                                    CL*15
  2600             20  DC-EDITB-MONTH        PIC 99.                       CL*15
  2601             20  SLASHB-1              PIC X VALUE '/'.              CL*15
  2602             20  DC-EDITB-DAY          PIC 99.                       CL*15
  2603             20  SLASHB-2              PIC X VALUE '/'.              CL*15
  2604             20  DC-EDITB-CCYY.                                      CL*15
  2605                 24  DC-EDITB-CENT     PIC 99.                       CL*15
  2606                 24  DC-EDITB-YEAR     PIC 99.                       CL*15
  2607         16  DC-GREG-DATE-CYMD         PIC 9(08).                    CL*15
  2608         16  DC-GREG-DATE-CYMD-R REDEFINES                           CL*15
  2609                              DC-GREG-DATE-CYMD.                  ELCDATE
  2610             20  DC-CYMD-CEN           PIC 99.                       CL*15
  2611             20  DC-CYMD-YEAR          PIC 99.                       CL*15
  2612             20  DC-CYMD-MONTH         PIC 99.                       CL*15
  2613             20  DC-CYMD-DAY           PIC 99.                       CL*15
  2614         16  DC-GREG-DATE-MDCY         PIC 9(08).                    CL*15
  2615         16  DC-GREG-DATE-MDCY-R REDEFINES                           CL*15
  2616                              DC-GREG-DATE-MDCY.                  ELCDATE
  2617             20  DC-MDCY-MONTH         PIC 99.                       CL*15
  2618             20  DC-MDCY-DAY           PIC 99.                       CL*15
  2619             20  DC-MDCY-CEN           PIC 99.                       CL*15
  2620             20  DC-MDCY-YEAR          PIC 99.                       CL*15
  2621    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.      ELCDATE
  2622        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.        ELCDATE
  2623    12  DC-EL310-DATE                  PIC X(21).                    CL*26
  2624    12  FILLER                         PIC X(28).                    CL*26
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  63
* ECS150.cbl
* 2626                             COPY ELCCALC.
  2627******************************************************************04/15/98
  2628*                                                                *ELCCALC
  2629*                           ELCCALC.                            *    LV003
  2630*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
  2631*                            VMOD=2.025                          *   CL**3
  2632*                                                                *   CL**2
  2633*   DESCRIPTION:  DATA TO BE PASSED TO REMAINING TERM ROUTINE    *   CL**2
  2634*                 REMAINING AMOUNT ROUTINE, LOSS RESERVE ROUTINE *   CL**2
  2635*                 REFUND CALCULATIONS ROUTINE, EARNINGS CALCU -  *   CL**2
  2636*                 LATIONS ROUTINE, AND THE RATING ROUTINE.       *   CL**2
  2637*                                                                *   CL**2
  2638*  PASSED TO ELRTRM                                              *   CL**2
  2639*  -----------------                                             *   CL**2
  2640*  METHOD CODE (I.E. FULL MONTH, HALF ADJ, ETC)                  *   CL**2
  2641*  ORIGINAL TERM                                                 *   CL**2
  2642*  BEGINNING DATE                                                *   CL**2
  2643*  ENDING DATE                                                   *   CL**2
  2644*  COMPANY I.D.                                                  *   CL**2
  2645*  ACCOUNT MASTER USER FIELD                                     *   CL**2
  2646*  PROCESS SWITCH (CANCEL, CLAIM)                                *   CL**2
  2647*  FREE LOOK DAYS                                                *   CL**2
  2648*                                                                *   CL**2
  2649*  RETURNED FROM ELRTRM                                          *   CL**2
  2650*  ---------------------                                         *   CL**2
  2651*  REMAINING TERM 1 - USED FOR EARNINGS                          *   CL**2
  2652*  REMAINING TERM 2 - USED FOR BENEFIT CALCULATIONS              *   CL**2
  2653*  REMAINING TERM 3 - USED FOR CLAIM BENEFITS                    *   CL**2
  2654*  ODD DAYS - REMAINING DAYS PAST FULL MONTHS                    *   CL**2
  2655*----------------------------------------------------------------*   CL**2
  2656*  PASSED TO ELRAMT                                              *   CL**2
  2657*  ----------------                                              *   CL**2
  2658*  REMAINING TERM 1 OR 2 OR 3 (FROM ELRTRM)                      *   CL**2
  2659*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *   CL**2
  2660*  ORIGINAL AMOUNT                                               *   CL**2
  2661*  ALTERNATE BENEFIT (BALLON)                                    *   CL**2
  2662*  A.P.R. - NET PAY ONLY                                         *   CL**2
  2663*  METHOD                                                            CL**2
  2664*  PAYMENT FREQUENCY - FOR FARM PLAN                             *   CL**2
  2665*  COMPANY I.D.                                                  *   CL**2
  2666*  BENEFIT TYPE                                                  *   CL**2
  2667*                                                                *   CL**2
  2668*  RETURNED FROM ELRAMT                                          *   CL**2
  2669*  --------------------                                          *   CL**2
  2670*  REMAINING AMOUNT 1 - CURRENT                                  *   CL**2
  2671*  REMAINING AMOUNT 2 - PREVIOUS MONTH                           *   CL**2
  2672*  REMAINING AMOUNT FACTOR                                           CL**2
  2673*----------------------------------------------------------------*   CL**2
  2674*  PASSED TO ELRESV                                              *   CL**2
  2675*  -----------------                                             *   CL**2
  2676*  CERTIFICATE EFFECTIVE DATE                                    *   CL**2
  2677*  VALUATION DATE                                                *   CL**2
  2678*  PAID THRU DATE                                                *   CL**2
  2679*  BENEFIT                                                       *   CL**2
  2680*  INCURRED DATE                                                 *   CL**2
  2681*  REPORTED DATE                                                 *   CL**2
  2682*  ISSUE AGE                                                     *   CL**2
  2683*  TERM                                                          *   CL**2
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  64
* ECS150.cbl (/apps/prod/cid1p/copy/ELCCALC)
  2684*  CDT PERCENT                                                   *   CL**2
  2685*  CDT METHOD (I.E. INTERPOLATED, AVERAGE, ETC)                  *   CL**2
  2686* *CLAIM TYPE (LIFE, A/H)                                        *   CL**2
  2687* *REMAINING BENEFIT (FROM ELRAMT)                               *   CL**2
  2688* *ONLY FIELDS REQUIRED FOR LIFE CLAIMS                          *   CL**2
  2689*                                                                *   CL**2
  2690*  RETURNED FROM ELRESV                                          *   CL**2
  2691*  --------------------                                          *   CL**2
  2692*  CDT TABLE USED                                                *   CL**2
  2693*  CDT FACTOR USED                                               *   CL**2
  2694*  PAY TO CURRENT RESERVE                                        *   CL**2
  2695*  I.B.N.R. - A/H ONLY                                           *   CL**2
  2696*  FUTURE (ACCRUED) AH ONLY                                      *   CL**2
  2697*----------------------------------------------------------------*   CL**2
  2698*  PASSED TO ELRATE                                              *   CL**2
  2699*  ----------------                                              *   CL**2
  2700*  CERT ISSUE DATE                                               *   CL**2
  2701*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *   CL**2
  2702*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *   CL**2
  2703*  CAPPED TERM   (ONLY FOR TRUNCATED LIFE)                       *   CL**2
  2704*  STATE CODE (CLIENT DEFINED)                                   *   CL**2
  2705*  STATE CODE (STANDARD P.O. ABBRV)                              *   CL**2
  2706*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *   CL**2
  2707*  DEVIATION CODE                                                *   CL**2
  2708*  ISSUE AGE                                                     *   CL**2
  2709*  ORIGINAL BENEFIT AMOUNT                                       *   CL**2
  2710*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *   CL**2
  2711*  PROCESS TYPE (ISSUE OR CANCEL)                                *   CL**2
  2712*  BENEFIT KIND (LIFE OR A/H)                                    *   CL**2
  2713*  A.P.R.                                                        *   CL**2
  2714*  METHOD                                                            CL**2
  2715*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *   CL**2
  2716*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *   CL**2
  2717*  COMPANY I.D. (3 CHARACTER)                                    *   CL**2
  2718*  BENEFIT CODE                                                  *   CL**2
  2719*  BENEFIT OVERRIDE CODE                                         *   CL**2
  2720*  MAXIMUM MONTHLY BENEFIT (FROM ACCT MASTER - CSL ONLY)         *   CL**2
  2721*  MAXIMUM TOTAL BENEFIT (FROM ACCT MASTER - CSL ONLY)           *   CL**2
  2722*  JOINT INDICATOR (CSL ONLY)                                    *   CL**2
  2723*  FIRST PAYMENT DATE (CSL ONLY)                                 *   CL**2
  2724*  PERIODIC PAYMENT AMOUNT (IN CP-REMAINING-TERM - CSL ONLY)     *   CL**2
  2725*                                                                *   CL**2
  2726*  RETURNED FROM ELRATE                                          *   CL**2
  2727*  --------------------                                          *   CL**2
  2728*  CALCULATED PREMIUM                                            *   CL**2
  2729*  PREMIUM RATE                                                  *   CL**2
  2730*  MORTALITY CODE                                                *   CL**2
  2731*  MAX ATTAINED AGE                                              *   CL**2
  2732*  MAX AGE                                                       *   CL**2
  2733*  MAX TERM                                                      *   CL**2
  2734*  MAX MONTHLY BENEFIT                                           *   CL**2
  2735*  MAX TOTAL BENIFIT                                             *   CL**2
  2736*  COMPOSITE RATE (OPEN-END ONLY)                                *   CL**2
  2737*----------------------------------------------------------------*   CL**2
  2738*  PASSED TO ELRFND                                              *   CL**2
  2739*  ----------------                                              *   CL**2
  2740*  CERT ISSUE DATE                                               *   CL**2
  2741*  REFUND DATE                                                   *   CL**2
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  65
* ECS150.cbl (/apps/prod/cid1p/copy/ELCCALC)
  2742*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *   CL**2
  2743*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *   CL**2
  2744*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *   CL**2
  2745*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *   CL**2
  2746*  STATE CODE (CLIENT DEFINED)                                   *   CL**2
  2747*  STATE CODE (STANDARD P.O. ABBRV)                              *   CL**2
  2748*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *   CL**2
  2749*  DEVIATION CODE                                                *   CL**2
  2750*  ISSUE AGE                                                     *   CL**2
  2751*  ORIGINAL BENEFIT AMOUNT                                       *   CL**2
  2752*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *   CL**2
  2753*  PROCESS TYPE (CANCEL)                                         *   CL**2
  2754*  BENEFIT KIND (LIFE OR A/H)                                    *   CL**2
  2755*  A.P.R.                                                        *   CL**2
  2756*  EARNING METHOD - (CODE FROM BENEFIT, STATE OR ACCOUNT RECORD) *   CL**2
  2757*  RATING METHOD -  (CODE FROM BENEFIT)                          *   CL**2
  2758*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *   CL**2
  2759*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *   CL**2
  2760*  COMPANY I.D. (3 CHARACTER)                                    *   CL**2
  2761*  BENEFIT CODE                                                  *   CL**2
  2762*  BENEFIT OVERRIDE CODE                                         *   CL**2
  2763*                                                                *   CL**2
  2764*  RETURNED FROM ELRFND                                          *   CL**2
  2765*  --------------------                                          *   CL**2
  2766*  CALCULATED REFUND                                             *   CL**2
  2767*----------------------------------------------------------------*   CL**2
  2768*  PASSED TO ELEARN                                              *   CL**2
  2769*  ----------------                                              *   CL**2
  2770*  CERT ISSUE DATE                                               *   CL**2
  2771*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *   CL**2
  2772*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *   CL**2
  2773*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *   CL**2
  2774*  STATE CODE (CLIENT DEFINED)                                   *   CL**2
  2775*  STATE CODE (STANDARD P.O. ABBRV)                              *   CL**2
  2776*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *   CL**2
  2777*  DEVIATION CODE                                                *   CL**2
  2778*  ISSUE AGE                                                     *   CL**2
  2779*  ORIGINAL BENEFIT AMOUNT                                       *   CL**2
  2780*  BENEFIT KIND (LIFE OR A/H)                                    *   CL**2
  2781*  A.P.R.                                                        *   CL**2
  2782*  METHOD - (EARNING CODE FROM BENEFIT RECORD)                   *   CL**2
  2783*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *   CL**2
  2784*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *   CL**2
  2785*  COMPANY I.D. (3 CHARACTER)                                    *   CL**2
  2786*  BENEFIT CODE                                                  *   CL**2
  2787*  BENEFIT OVERRIDE CODE                                         *   CL**2
  2788*                                                                *   CL**2
  2789*  RETURNED FROM ELEARN                                          *   CL**2
  2790*  --------------------                                          *   CL**2
  2791*  INDICATED  EARNINGS                                           *   CL**2
  2792*----------------------------------------------------------------*   CL**2
  2793*                 LENGTH = 450                                   *   CL**2
  2794*                                                                *   CL**2
  2795******************************************************************   CL**2
  2796******************************************************************
  2797*                   C H A N G E   L O G
  2798*
  2799* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  66
* ECS150.cbl (/apps/prod/cid1p/copy/ELCCALC)
  2800*-----------------------------------------------------------------
  2801*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2802* EFFECTIVE    NUMBER
  2803*-----------------------------------------------------------------
  2804* 010303    2001061800003  PEMA  ADD DCC/MONTHLY PROCESSING
  2805* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  2806* 101807    2007100100007  PEMA  EXPAND CLM RESERVE FIELDS
  2807* 010410    2008021200005  PEMA  ADD FIELDS FOR MN NET PAY BALLOON
  2808* 010410    2009050700003  PEMA  ADD FIELDS FOR SPP-DD
  2809* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  2810* 041710    2007111300001  AJRA  ADD CLAIM CALC SW FOR SC NP+6
  2811* 101110  CR2010012700001  PEMA ADD DDF REFUND/UEP PROCESSING
  2812* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  2813* 040615  CR2013072200002  PEMA  ADD EXTRA PERIODS
  2814******************************************************************
  2815                                                                     CL**2
  2816 01  CALCULATION-PASS-AREA.                                          CL**2
  2817     12  CP-COMM-LENGTH            PIC S9(4)         VALUE +450      CL**2
  2818                                     COMP.                           CL**2
  2819                                                                     CL**2
  2820     12  CP-RETURN-CODE            PIC X             VALUE ZERO.     CL**2
  2821       88  NO-CP-ERROR                             VALUE ZERO.       CL**2
  2822       88  CP-ERROR-OCCURED VALUE '1' '2' '3' '4' '5' '6' '7' '8'    CL**2
  2823                                  '9' 'A' 'B' 'C' 'D' 'E' 'H'.       CL**2
  2824       88  CP-ERROR-IN-AMOUNTS                     VALUE '1'.        CL**2
  2825       88  CP-ERROR-IN-DATES                       VALUE '2'.        CL**2
  2826       88  CP-ERROR-IN-OPTIONS                     VALUE '3'.        CL**2
  2827       88  CP-ERROR-IN-TERMS                       VALUE '4'.        CL**2
  2828       88  CP-ERROR-IN-FREQUENCY                   VALUE '5'.        CL**2
  2829       88  CP-ERROR-RATE-NOT-FOUND                 VALUE '6'.        CL**2
  2830       88  CP-ERROR-RATE-IS-ZERO                   VALUE '7'.        CL**2
  2831       88  CP-ERROR-AMT-OUTSIDE-LIMIT              VALUE '8'.        CL**2
  2832       88  CP-ERROR-TERM-OUTSIDE-LIMIT             VALUE '9'.        CL**2
  2833       88  CP-ERROR-AGE-OUTSIDE-LIMIT              VALUE 'A'.        CL**2
  2834       88  CP-ERROR-ATT-OUTSIDE-LIMIT              VALUE 'B'.        CL**2
  2835       88  CP-ERROR-TOT-OUTSIDE-LIMIT              VALUE 'C'.        CL**2
  2836       88  CP-ERROR-RATE-FILE-NOTOPEN              VALUE 'D'.        CL**2
  2837       88  CP-ERROR-ISSUE-AGE-ZERO                 VALUE 'E'.        CL**2
  2838       88  CP-ERROR-NO-LIMITS-CRI                  VALUE 'F'.        CL**2
  2839       88  CP-ERROR-DIV-BY-ZERO                    VALUE 'G'.        CL**2
  2840       88  CP-ERROR-LOAN-TERM                      VALUE 'H'.        CL**2
  2841                                                                     CL**2
  2842     12  CP-RETURN-CODE-2          PIC X             VALUE ZERO.     CL**2
  2843       88  NO-CP-ERROR-2                           VALUE ZERO.       CL**2
  2844***********************  INPUT AREAS ****************************    CL**2
  2845                                                                     CL**2
  2846     12  CP-CALCULATION-AREA.                                        CL**2
  2847         16  CP-ACCOUNT-NUMBER     PIC X(10)       VALUE SPACES.     CL**2
  2848         16  CP-CERT-EFF-DT        PIC XX.                           CL**2
  2849         16  CP-VALUATION-DT       PIC XX.                           CL**2
  2850         16  CP-PAID-THRU-DT       PIC XX.                           CL**2
  2851         16  CP-BENEFIT-TYPE       PIC X.                            CL**2
  2852           88  CP-AH                               VALUE 'A' 'D'     CL**2
  2853                                                   'I' 'U'.          CL**2
  2854           88  CP-REDUCING-LIFE                    VALUE 'R'.        CL**2
  2855           88  CP-LEVEL-LIFE                       VALUE 'L' 'P'.    CL**2
  2856         16  CP-INCURRED-DT        PIC XX.                           CL**2
  2857         16  CP-REPORTED-DT        PIC XX.                           CL**2
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  67
* ECS150.cbl (/apps/prod/cid1p/copy/ELCCALC)
  2858         16  CP-ACCT-FLD-5         PIC XX            VALUE SPACE.    CL**2
  2859         16  CP-COMPANY-ID         PIC XXX           VALUE SPACE.    CL**2
  2860         16  CP-ISSUE-AGE          PIC S9(3)         VALUE ZERO      CL**2
  2861                                     COMP-3.                         CL**2
  2862         16  CP-CDT-PERCENT        PIC S9(3)V99      VALUE ZERO      CL**2
  2863                                     COMP-3.                         CL**2
  2864         16  CP-CDT-METHOD         PIC X.                            CL**2
  2865           88  CP-CDT-ROUND-NEAR                   VALUE '1'.        CL**2
  2866           88  CP-CDT-ROUND-HIGH                   VALUE '2'.        CL**2
  2867           88  CP-CDT-INTERPOLATED                 VALUE '3'.        CL**2
  2868         16  CP-CLAIM-TYPE         PIC X.                            CL**2
  2869           88  CP-AH-CLAIM                         VALUE 'A'.        CL**2
  2870           88  CP-LIFE-CLAIM                       VALUE 'L'.        CL**2
  2871         16  CP-ORIGINAL-TERM      PIC S9(3)         VALUE ZERO      CL**2
  2872                                     COMP-3.                         CL**2
  2873         16  CP-ORIGINAL-BENEFIT   PIC S9(9)V99      VALUE ZERO      CL**2
  2874                                     COMP-3.                         CL**2
  2875         16  CP-ORIGINAL-PREMIUM   PIC S9(7)V99      VALUE ZERO      CL**2
  2876                                     COMP-3.                         CL**2
  2877         16  CP-REMAINING-TERM     PIC S9(3)V99      VALUE ZERO      CL**2
  2878                                     COMP-3.                         CL**2
  2879         16  CP-REMAINING-BENEFIT  PIC S9(9)V99      VALUE ZERO      CL**2
  2880                                     COMP-3.                         CL**2
  2881         16  CP-LOAN-APR           PIC S9(3)V9(4)    VALUE ZERO      CL**2
  2882                                     COMP-3.                         CL**2
  2883         16  CP-PAY-FREQUENCY      PIC S9(3)         VALUE ZERO      CL**2
  2884                                     COMP-3.                         CL**2
  2885         16  CP-REM-TERM-METHOD    PIC X.                            CL**2
  2886           88  CP-EARN-AFTER-15TH                  VALUE '1'.        CL**2
  2887           88  CP-EARN-ON-HALF-MONTH               VALUE '2'.        CL**2
  2888           88  CP-EARN-ON-1ST-DAY                  VALUE '3'.        CL**2
  2889           88  CP-EARN-ON-FULL-MONTH               VALUE '4'.        CL**2
  2890           88  CP-EARN-WITH-NO-DAYS                VALUE '5'.        CL**2
  2891           88  CP-EARN-AFTER-14TH                  VALUE '6'.        CL**2
  2892           88  CP-EARN-AFTER-16TH                  VALUE '7'.        CL**2
  2893         16  CP-EARNING-METHOD     PIC X.                            CL**2
  2894           88  CP-EARN-BY-R78                      VALUE '1' 'R'.    CL**2
  2895           88  CP-EARN-BY-PRORATA                  VALUE '2' 'P'.    CL**2
  2896           88  CP-EARN-AS-CALIF                    VALUE '3' 'C'.    CL**2
  2897           88  CP-EARN-AS-TEXAS                    VALUE '4' 'T'.    CL**2
  2898           88  CP-EARN-AS-FARM-PLAN                VALUE '4' 'T'.    CL**2
  2899           88  CP-EARN-AS-NET-PAY                  VALUE '5' 'N'.    CL**2
  2900           88  CP-EARN-ANTICIPATION                VALUE '6' 'A'.    CL**2
  2901           88  CP-EARN-AS-MEAN                     VALUE '8' 'M'.    CL**2
  2902           88  CP-EARN-AS-SUM-OF-DIGITS            VALUE '9'.        CL**2
  2903           88  CP-EARN-AS-REG-BALLOON              VALUE 'B'.        CL**2
  2904           88  CP-GAP-NON-REFUNDABLE               VALUE 'G'.
  2905           88  CP-GAP-ACTUARIAL                    VALUE 'S'.
  2906           88  CP-DCC-SPP-DDF                      VALUE 'D' 'I'.
  2907           88  CP-DCC-SPP-DDF-IU                   VALUE 'I'.
  2908         16  CP-PROCESS-TYPE       PIC X.                            CL**2
  2909           88  CP-CLAIM                            VALUE '1'.        CL**2
  2910           88  CP-CANCEL                           VALUE '2'.        CL**2
  2911           88  CP-ISSUE                            VALUE '3'.        CL**2
  2912         16  CP-SPECIAL-CALC-CD    PIC X.                            CL**2
  2913           88  CP-OUTSTANDING-BAL              VALUE 'O'.            CL**2
  2914           88  CP-1-MTH-INTEREST               VALUE ' '.            CL**2
  2915           88  CP-0-MTH-INTEREST               VALUE 'A'.            CL**2
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  68
* ECS150.cbl (/apps/prod/cid1p/copy/ELCCALC)
  2916           88  CP-OB-OFFLINE-RESERVED          VALUE 'B'.            CL**2
  2917           88  CP-CRITICAL-PERIOD              VALUE 'C'.            CL**2
  2918           88  CP-TERM-IS-DAYS                 VALUE 'D'.            CL**2
  2919           88  CP-USE-PREM-AS-ENTERED          VALUE 'E'.            CL**2
  2920           88  CP-FARM-PLAN                    VALUE 'F'.            CL**2
  2921           88  CP-RATE-AS-STANDARD             VALUE 'G'.            CL**2
  2922           88  CP-2-MTH-INTEREST               VALUE 'I'.            CL**2
  2923           88  CP-3-MTH-INTEREST               VALUE 'J'.            CL**2
  2924           88  CP-4-MTH-INTEREST               VALUE 'K'.            CL**2
  2925           88  CP-BALLOON-LAST-PMT             VALUE 'L'.            CL**2
  2926           88  CP-MORTGAGE-REC                 VALUE 'M'.            CL**2
  2927           88  CP-OUTSTANDING-BALANCE          VALUE 'O'.            CL**2
  2928           88  CP-NET-PAY-PRUDENTIAL           VALUE 'P'.            CL**2
  2929           88  CP-NET-PAY-SIMPLE               VALUE 'S'.            CL**2
  2930           88  CP-TRUNCATED-LIFE               VALUE 'T' 'U' 'V'     CL**2
  2931                                                     'W' 'X'.        CL**2
  2932           88  CP-TRUNCATE-0-MTH               VALUE 'T'.            CL**2
  2933           88  CP-TRUNCATE-1-MTH               VALUE 'U'.            CL**2
  2934           88  CP-TRUNCATE-2-MTH               VALUE 'V'.            CL**2
  2935           88  CP-TRUNCATE-3-MTH               VALUE 'W'.            CL**2
  2936           88  CP-TRUNCATE-4-MTH               VALUE 'X'.            CL**2
  2937           88  CP-SUMMARY-REC                  VALUE 'Z'.            CL**2
  2938           88  CP-PROPERTY-BENEFIT             VALUE '2'.            CL**2
  2939           88  CP-UNEMPLOYMENT-BENEFIT         VALUE '3'.            CL**2
  2940           88  CP-AD-D-BENEFIT                 VALUE '4'.            CL**2
  2941           88  CP-CSL-METH-1                   VALUE '5'.            CL**2
  2942           88  CP-CSL-METH-2                   VALUE '6'.            CL**2
  2943           88  CP-CSL-METH-3                   VALUE '7'.            CL**2
  2944           88  CP-CSL-METH-4                   VALUE '8'.            CL**2
  2945                                                                     CL**2
  2946         16  CP-LOAN-TERM          PIC S9(3)       VALUE ZERO        CL**2
  2947                                     COMP-3.                         CL**2
  2948         16  CP-CLASS-CODE         PIC XX          VALUE ZERO.       CL**2
  2949         16  CP-DEVIATION-CODE     PIC XXX         VALUE ZERO.       CL**2
  2950         16  CP-STATE              PIC XX          VALUE SPACE.      CL**2
  2951         16  CP-STATE-STD-ABBRV    PIC XX          VALUE SPACE.      CL**2
  2952         16  CP-BENEFIT-CD         PIC XX          VALUE ZERO.       CL**2
  2953           88  CP-CSL-VALID-NP-BENEFIT-CD VALUES '12' '13'           CL**2
  2954               '34' '35' '36' '37' '44' '45' '46' '47' '72' '73'.    CL**2
  2955         16  CP-R78-OPTION         PIC X.                            CL**2
  2956           88  CP-TERM-TIMES-TERM-PLUS-1           VALUE ' '.        CL**2
  2957           88  CP-TERM-TIMES-TERM                  VALUE '1'.        CL**2
  2958                                                                     CL**2
  2959         16  CP-COMPANY-CD         PIC X             VALUE SPACE.    CL**2
  2960         16  CP-IBNR-RESERVE-SW    PIC X.                            CL**2
  2961         16  CP-CLAIM-STATUS       PIC X.                            CL**2
  2962         16  CP-RATE-FILE          PIC X.                            CL**2
  2963         16  CP-TERM-OR-EXT-DAYS   PIC S9(05)        VALUE ZERO      CL**2
  2964                                     COMP-3.                         CL**2
  2965                                                                     CL**2
  2966         16  CP-LIFE-OVERRIDE-CODE PIC X.                            CL**2
  2967         16  CP-AH-OVERRIDE-CODE   PIC X.                            CL**2
  2968                                                                     CL**2
  2969         16  CP-RATE-DEV-PCT       PIC S9V9(6)       VALUE ZERO      CL**2
  2970                                     COMP-3.
  2971         16  CP-CLP-RATE-UP        REDEFINES CP-RATE-DEV-PCT
  2972                                   PIC S9(5)V99 COMP-3.
  2973         16  CP-CRITICAL-MONTHS    PIC S9(3)         VALUE ZERO      CL**2
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  69
* ECS150.cbl (/apps/prod/cid1p/copy/ELCCALC)
  2974                                     COMP-3.                         CL**2
  2975         16  CP-ALTERNATE-BENEFIT  PIC S9(9)V99      VALUE ZERO      CL**2
  2976                                     COMP-3.                         CL**2
  2977         16  CP-ALTERNATE-PREMIUM  PIC S9(7)V99      VALUE ZERO      CL**2
  2978                                     COMP-3.
  2979         16  CP-DDF-CSO-ADMIN-FEE REDEFINES CP-ALTERNATE-PREMIUM
  2980                                  PIC S9(7)V99 COMP-3.
  2981                                                                     CL**2
  2982         16  CP-PAID-FROM-DATE     PIC X(02).                        CL**2
  2983         16  CP-CLAIM-CALC-METHOD  PIC X(01).                        CL**2
  2984         16  CP-EXT-DAYS-CALC      PIC X.                            CL**2
  2985           88  CP-EXT-NO-CHG                   VALUE ' '.            CL**2
  2986           88  CP-EXT-CHG-LF                   VALUE '1'.            CL**2
  2987           88  CP-EXT-CHG-AH                   VALUE '2'.            CL**2
  2988           88  CP-EXT-CHG-LF-AH                VALUE '3'.            CL**2
  2989         16  CP-DOMICILE-STATE     PIC XX.                           CL**2
  2990         16  CP-CARRIER            PIC X.                            CL**2
  2991         16  CP-REIN-FLAG          PIC X.                            CL**2
  2992         16  CP-REM-TRM-CALC-OPTION PIC X.                           CL**2
  2993           88  VALID-REM-TRM-CALC-OPTION    VALUE '1'                CL**2
  2994                      '2' '3' '4' '5'.                               CL**2
  2995           88  CP-CALC-OPTION-DEFAULT       VALUE '4'.               CL**2
  2996           88  CP-CONSIDER-EXTENSION        VALUE '3' '4' '5'.       CL**2
  2997           88  CP-30-DAY-MONTH              VALUE '1' '3' '5'.       CL**2
  2998           88  CP-NO-EXT-30-DAY-MONTH       VALUE '1'.               CL**2
  2999           88  CP-NO-EXT-ACTUAL-DAYS        VALUE '2'.               CL**2
  3000           88  CP-EXT-30-DAY-MONTH          VALUE '3'.               CL**2
  3001           88  CP-EXT-ACTUAL-DAYS           VALUE '4'.               CL**2
  3002           88  CP-USE-EXP-AND-1ST-PMT       VALUE '5'.
  3003         16  CP-SIG-SWITCH         PIC X.                            CL**2
  3004         16  CP-RATING-METHOD      PIC X.                            CL**2
  3005           88  CP-RATE-AS-R78                      VALUE '1' 'R'.    CL**2
  3006           88  CP-RATE-AS-PRORATA                  VALUE '2' 'P'.    CL**2
  3007           88  CP-RATE-AS-CALIF                    VALUE '3' 'C'.    CL**2
  3008           88  CP-RATE-AS-TEXAS                    VALUE '4' 'T'.    CL**2
  3009           88  CP-RATE-AS-FARM-PLAN                VALUE '4' 'T'.    CL**2
  3010           88  CP-RATE-AS-NET-PAY                  VALUE '5' 'N'.    CL**2
  3011           88  CP-RATE-AS-ANTICIPATION             VALUE '6' 'A'.    CL**2
  3012           88  CP-RATE-AS-MEAN                     VALUE '8' 'M'.    CL**2
  3013           88  CP-RATE-AS-REG-BALLOON              VALUE 'B'.        CL**2
  3014         16  CP-SALES-TAX          PIC S9V9999     VALUE  ZEROS      CL**2
  3015                                     COMP-3.                         CL**2
  3016         16  CP-BEN-CATEGORY       PIC X.
  3017         16  CP-DCC-LF-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  3018         16  CP-DCC-ACT-COMM REDEFINES CP-DCC-LF-RATE
  3019                                   PIC S99V9(5) COMP-3.
  3020         16  CP-DCC-AH-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  3021         16  CP-DCC-PMF-COMM REDEFINES CP-DCC-AH-RATE
  3022                                   PIC S99V9(5) COMP-3.
  3023         16  CP-DAYS-TO-1ST-PMT    PIC S999     COMP-3 VALUE +0.
  3024         16  CP-AH-BALLOON-SW      PIC X  VALUE ' '.
  3025         16  CP-EXPIRE-DT          PIC XX.
  3026         16  CP-LF-CLAIM-CALC-SW   PIC X  VALUE ' '.
  3027         16  CP-DDF-HI-FACT        PIC S9V999   COMP-3 VALUE +0.
  3028         16  CP-DDF-LO-FACT        PIC S9V999   COMP-3 VALUE +0.
  3029         16  CP-DDF-CLP            PIC S9(5)V99 COMP-3 VALUE +0.
  3030         16  CP-DDF-SPEC-CALC      PIC X.
  3031             88  CP-CALC-GROSS-FEE        VALUE 'G'.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  70
* ECS150.cbl (/apps/prod/cid1p/copy/ELCCALC)
  3032             88  CP-CALC-CLP              VALUE 'C'.
  3033         16  CP-IU-RATE-UP         PIC S9(5)V99   COMP-3 VALUE +0.
  3034         16  CP-CANCEL-REASON      PIC X.
  3035         16  CP-DDF-ADMIN-FEES     PIC S9(5)V99 COMP-3 VALUE +0.
  3036         16  CP-PMT-MODE           PIC X.
  3037         16  CP-NO-OF-PMTS         PIC S999 COMP-3 VALUE +0.
  3038         16  CP-1ST-YR-ALLOW       PIC S999V99 COMP-3 VALUE +0.
  3039         16  CP-DDF-COMM-AND-MFEE  PIC S9(5)V99 COMP-3 VALUE +0.
  3040         16  CP-DDF-YR1AF          PIC S9(5)V99 COMP-3 VALUE +0.
  3041         16  FILLER                PIC X.
  3042                                                                     CL**2
  3043***************    OUTPUT FROM ELRESV   ************************     CL**2
  3044                                                                     CL**2
  3045         16  CP-CDT-TABLE          PIC 9             VALUE ZERO.     CL**2
  3046                                                                     CL**2
  3047         16  CP-CDT-FACTOR         PIC S9(5)V9(6)    VALUE ZERO      CL**2
  3048                                     COMP-3.                         CL**2
  3049         16  CP-PTC-RESERVE        PIC S9(7)V99   VALUE ZERO         CL**2
  3050                                     COMP-3.                         CL**2
  3051         16  CP-IBNR-RESERVE       PIC S9(7)V99   VALUE ZERO         CL**2
  3052                                     COMP-3.                         CL**2
  3053         16  CP-FUTURE-RESERVE     PIC S9(7)V99   VALUE ZERO         CL**2
  3054                                     COMP-3.                         CL**2
  3055         16  FILLER                PIC X(09).                        CL**2
  3056***************    OUTPUT FROM ELRTRM   *************************    CL**2
  3057                                                                     CL**2
  3058         16  CP-REMAINING-TERM-1   PIC S9(4)V9    VALUE ZERO         CL**2
  3059                                     COMP-3.                         CL**2
  3060         16  CP-REMAINING-TERM-2   PIC S9(4)V9    VALUE ZERO         CL**2
  3061                                     COMP-3.                         CL**2
  3062         16  CP-REMAINING-TERM-3   PIC S9(4)V9    VALUE ZERO         CL**2
  3063                                     COMP-3.                         CL**2
  3064         16  CP-ODD-DAYS           PIC S9(3)      VALUE ZERO         CL**2
  3065                                     COMP-3.                         CL**2
  3066         16  FILLER                PIC X(12).                        CL**2
  3067                                                                     CL**2
  3068***************    OUTPUT FROM ELRAMT   *************************    CL**2
  3069                                                                     CL**2
  3070         16  CP-REMAINING-AMT      PIC S9(9)V99   VALUE ZERO         CL**2
  3071                                     COMP-3.                         CL**2
  3072         16  CP-REMAINING-AMT-PRV  PIC S9(9)V99   VALUE ZERO         CL**2
  3073                                     COMP-3.                         CL**2
  3074         16  FILLER                PIC X(12).                        CL**2
  3075                                                                     CL**2
  3076***************    OUTPUT FROM ELRATE   *************************    CL**2
  3077                                                                     CL**2
  3078         16  CP-CALC-PREMIUM       PIC S9(7)V99   VALUE ZERO         CL**2
  3079                                     COMP-3.                         CL**2
  3080         16  CP-PREMIUM-RATE       PIC S9(2)V9(5) VALUE ZERO         CL**2
  3081                                     COMP-3.                         CL**2
  3082         16  CP-MORTALITY-CODE     PIC X(4).                         CL**2
  3083         16  CP-RATE-EDIT-FLAG     PIC X.                            CL**2
  3084             88  CP-RATES-NEED-APR                  VALUE '1'.       CL**2
  3085         16  CP-COMPOSITE-RATE     PIC S99V999    VALUE ZERO         CL**2
  3086                                     COMP-3.                         CL**2
  3087         16  CP-POLICY-FEE         PIC S9(3)V99 VALUE +0 COMP-3.     CL**2
  3088         16  CP-LF-PREM            PIC S9(7)V99 VALUE +0 COMP-3.
  3089         16  CP-LF-BALLOON-PREM REDEFINES CP-LF-PREM
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  71
* ECS150.cbl (/apps/prod/cid1p/copy/ELCCALC)
  3090                                   PIC S9(7)V99 COMP-3.
  3091         16  FILLER                PIC X(07).                        CL**2
  3092                                                                     CL**2
  3093***************    OUTPUT FROM ELRFND   *************************    CL**2
  3094                                                                     CL**2
  3095         16  CP-CALC-REFUND        PIC S9(7)V99   VALUE ZERO         CL**2
  3096                                     COMP-3.                         CL**2
  3097         16  CP-REFUND-TYPE-USED   PIC X.                            CL**2
  3098           88  CP-R-AS-R78                         VALUE '1'.        CL**2
  3099           88  CP-R-AS-PRORATA                     VALUE '2'.        CL**2
  3100           88  CP-R-AS-CALIF                       VALUE '3'.        CL**2
  3101           88  CP-R-AS-TEXAS                       VALUE '4'.        CL**2
  3102           88  CP-R-AS-FARM-PLAN                   VALUE '4'.        CL**2
  3103           88  CP-R-AS-NET-PAY                     VALUE '5'.        CL**2
  3104           88  CP-R-AS-ANTICIPATION                VALUE '6'.        CL**2
  3105           88  CP-R-AS-MEAN                        VALUE '8'.        CL**2
  3106           88  CP-R-AS-SUM-OF-DIGITS               VALUE '9'.        CL**2
  3107           88  CP-R-AS-GAP-NON-REFUND              VALUE 'G'.
  3108           88  CP-R-AS-GAP-ACTUARIAL               VALUE 'S'.
  3109           88  CP-R-AS-SPP-DDF                     VALUE 'D'.
  3110           88  CP-R-AS-SPP-DDF-IU                  VALUE 'I'.
  3111           88  CP-R-AS-REPOSSESSION                VALUE 'R'.
  3112         16  FILLER                PIC X(12).                        CL**2
  3113                                                                     CL**2
  3114***************    OUTPUT FROM ELEARN   *************************    CL**2
  3115                                                                     CL**2
  3116         16  CP-R78-U-PRM          PIC S9(7)V99   VALUE ZERO         CL**2
  3117                                     COMP-3.                         CL**2
  3118         16  CP-R78-U-PRM-ALT      PIC S9(7)V99   VALUE ZERO         CL**2
  3119                                     COMP-3.                         CL**2
  3120         16  CP-PRORATA-U-PRM      PIC S9(7)V99   VALUE ZERO         CL**2
  3121                                     COMP-3.                         CL**2
  3122         16  CP-PRORATA-U-PRM-ALT  PIC S9(7)V99   VALUE ZERO         CL**2
  3123                                     COMP-3.                         CL**2
  3124         16  CP-STATE-U-PRM        PIC S9(7)V99   VALUE ZERO         CL**2
  3125                                     COMP-3.                         CL**2
  3126         16  CP-DOMICILE-U-PRM     PIC S9(7)V99   VALUE ZERO         CL**2
  3127                                     COMP-3.                         CL**2
  3128         16  CP-EARNING-TYPE-USED  PIC X.                            CL**2
  3129           88  CP-E-AS-SPECIAL                     VALUE 'S'.        CL**2
  3130           88  CP-E-AS-R78                         VALUE '1'.        CL**2
  3131           88  CP-E-AS-PRORATA                     VALUE '2'.        CL**2
  3132           88  CP-E-AS-TEXAS                       VALUE '4'.        CL**2
  3133           88  CP-E-AS-FARM-PLAN                   VALUE '4'.        CL**2
  3134           88  CP-E-AS-NET-PAY                     VALUE '5'.        CL**2
  3135           88  CP-E-AS-ANTICIPATION                VALUE '6'.        CL**2
  3136           88  CP-E-AS-MEAN                        VALUE '8'.        CL**2
  3137           88  CP-E-AS-SUM-OF-DIGITS               VALUE '9'.        CL**2
  3138         16  FILLER                PIC X(12).                        CL**2
  3139                                                                     CL**2
  3140***************    OUTPUT FROM ELPMNT   *************************    CL**2
  3141                                                                     CL**2
  3142         16  CP-ACTUAL-DAYS        PIC S9(05)     VALUE ZERO         CL**2
  3143                                     COMP-3.                         CL**2
  3144         16  CP-CLAIM-PAYMENT      PIC S9(7)V99   VALUE ZERO         CL**2
  3145                                     COMP-3.                         CL**2
  3146         16  FILLER                PIC X(12).                        CL**2
  3147                                                                     CL**2
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  72
* ECS150.cbl (/apps/prod/cid1p/copy/ELCCALC)
  3148***************   MISC WORK AREAS    *****************************   CL**2
  3149         16  CP-TOTAL-PAID         PIC S9(7)V99   VALUE ZERO         CL**2
  3150                                     COMP-3.                         CL**2
  3151         16  CP-R-MAX-ATT-AGE      PIC S9(3)      VALUE ZERO         CL**2
  3152                                     COMP-3.                         CL**2
  3153         16  CP-R-MAX-AGE          PIC S9(3)      VALUE ZERO         CL**2
  3154                                     COMP-3.                         CL**2
  3155         16  CP-R-MAX-TERM         PIC S9(5)      VALUE ZERO         CL**2
  3156                                     COMP-3.                         CL**2
  3157         16  CP-R-MAX-TOT-BEN      PIC S9(7)V99   VALUE ZERO         CL**2
  3158                                     COMP-3.                         CL**2
  3159         16  CP-R-MAX-MON-BEN      PIC S9(7)V99   VALUE ZERO         CL**2
  3160                                     COMP-3.                         CL**2
  3161         16  CP-IO-FUNCTION        PIC X          VALUE SPACE.       CL**2
  3162             88  OPEN-RATE-FILE                   VALUE 'O'.         CL**2
  3163             88  CLOSE-RATE-FILE                  VALUE 'C'.         CL**2
  3164             88  IO-ERROR                         VALUE 'E'.         CL**2
  3165                                                                     CL**2
  3166         16  CP-FIRST-PAY-DATE     PIC XX.                           CL**2
  3167                                                                     CL**2
  3168         16  CP-JOINT-INDICATOR    PIC X.                            CL**2
  3169                                                                     CL**2
  3170         16  CP-RESERVE-REMAINING-TERM                               CL**2
  3171                                   PIC S9(4)V9    VALUE ZERO         CL**2
  3172                                     COMP-3.                         CL**2
  3173                                                                     CL**2
  3174         16  CP-INSURED-BIRTH-DT   PIC XX.                           CL**2
  3175                                                                     CL**2
  3176         16  CP-INCURRED-AGE       PIC S9(3)      VALUE ZERO         CL**2
  3177                                     COMP-3.                         CL**2
  3178                                                                     CL**2
  3179         16  CP-MONTHLY-PAYMENT    PIC S9(5)V99   VALUE ZERO         CL**2
  3180                                     COMP-3.                         CL**2
  3181                                                                     CL**2
  3182         16  CP-RATING-BENEFIT-AMT PIC S9(9)V99   VALUE ZERO         CL**2
  3183                                     COMP-3.                         CL**2
  3184                                                                     CL**2
  3185         16  CP-ODD-DAYS-TO-PMT    PIC S9(3)      VALUE ZERO         CL**2
  3186                                     COMP-3.                         CL**2
  3187                                                                     CL**2
  3188         16  CP-MNTHS-TO-FIRST-PMT PIC S9(3)      VALUE ZERO         CL**2
  3189                                     COMP-3.                         CL**2
  3190                                                                     CL**2
  3191         16  CP-REMAMT-FACTOR      PIC S9(4)V9(9) VALUE ZEROS        CL**2
  3192                                     COMP-3.                         CL**2
  3193                                                                     CL**2
  3194         16  CP-FREE-LOOK          PIC S9(3)      VALUE ZERO         CL**2
  3195                                     COMP-3.                         CL**2
  3196                                                                     CL**2
  3197         16  CP-ROA-REFUND         PIC X          VALUE 'N'.         CL**2
  3198             88  CP-ROA-PREM-AT-REFUND            VALUE 'Y'.         CL**2
  3199                                                                     CL**2
  3200         16  CP-NET-BENEFIT-AMT    PIC S9(9)V99   VALUE ZERO         CL**2
  3201                                     COMP-3.                         CL**2
  3202         16  CP-SCNP-6MO-AMT       PIC S9(9)V99   VALUE ZERO
  3203                                     COMP-3.
  3204         16  CP-MONTH              PIC S999     COMP-3 VALUE +0.
  3205         16  cp-extra-periods      pic 9 value zeros.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  73
* ECS150.cbl (/apps/prod/cid1p/copy/ELCCALC)
  3206         16  cp-net-only-state     pic x value spaces.
  3207         16  FILLER                PIC X(13).                        CL**2
  3208******************************************************************   CL**2
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  74
* ECS150.cbl
* 3210                             COPY ELCDTECX.
  3211******************************************************************06/05/98
  3212*                                                                *ELCDTECX
  3213*                            ELCDTECX.                           *   LV005
  3214*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  3215*                            VMOD=2.015                          *ELCDTECX
  3216*                                                                *ELCDTECX
  3217*      WORKING STORAGE COPY CODE FOR APPLICATIONS CALLING        *ELCDTECX
  3218*      THE DATE CARD DISK FILE. ( READ ROUTINE = ELCDTERX,       *ELCDTECX
  3219*      AND DISK FILE FD = ELCDTEFX)                              *ELCDTECX
  3220*                                                                *ELCDTECX
  3221******************************************************************ELCDTECX
  3222******************************************************************
  3223*                   C H A N G E   L O G
  3224*
  3225* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3226*-----------------------------------------------------------------
  3227*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3228* EFFECTIVE    NUMBER
  3229*-----------------------------------------------------------------
  3230* 092602    2002091900008  PEMA  INCREASE NUMBER OF MAXIMUM
  3231*                                  BENEFIT CODES FROM 300 TO 900
  3232* 090803    2003080800002  PEMA  ADD CATEGORY FOR SUPER GAP
  3233* 051304    2003080800002  SMVA  ADD REFUND METHOD
  3234* 071714    2013100100002  PEMA  FIX CRIT PERIOD EDITS
  3235******************************************************************
  3236 01  DATE-CARD.                                                   ELCDTECX
  3237     12  DATX-COD                    PIC  X(4).                   ELCDTECX
  3238     12  RUN-DATE                    PIC  9(11)  COMP-3.          ELCDTECX
  3239     12  ALPH-DATE                   PIC  X(18).                  ELCDTECX
  3240     12  EP-DT                       PIC  9(11)  COMP-3.          ELCDTECX
  3241     12  PEND-ACT-FILE               PIC  XX.                     ELCDTECX
  3242     12  EP-SW                       PIC  X.                      ELCDTECX
  3243         88  NO-EP-EXTRACTS          VALUE SPACE.                 ELCDTECX
  3244     12  TAPE-BATCHES                PIC  X.                      ELCDTECX
  3245         88  TP-PREL-BAL             VALUE '1'.                   ELCDTECX
  3246     12  BIN-RUN-DATE                PIC  XX.                     ELCDTECX
  3247     12  RUN-CENTURY.                                             ELCDTECX
  3248         16 RUN-CENTURY-N            PIC  99.                        CL**4
  3249     12  FILLER                      PIC  X.                         CL**4
  3250     12  CLAS-MORT-OVRD              PIC  X(4).                   ELCDTECX
  3251     12  FILLER                      PIC  XXX.                    ELCDTECX
  3252     12  COMPANY-NAME                PIC  X(30).                  ELCDTECX
  3253                                                                  ELCDTECX
  3254 01  FILLER                          PIC  X(7)                       CL**6
  3255                                          VALUE 'OPTIONS'.        ELCDTECX
  3256 01  DATE-CARD-OPTIONS.                                           ELCDTECX
  3257     12  DATE-OPTIONS-ID             PIC  X(4).                   ELCDTECX
  3258     12  DTE-MIN-PREM                PIC  99V99.                  ELCDTECX
  3259     12  DTE-LANGUAGE-IND            PIC  X.                      ELCDTECX
  3260         88  DTE-LANGUAGE-IS-FR           VALUE 'F'.              ELCDTECX
  3261         88  DTE-LANGUAGE-IS-ENG          VALUE 'E'.              ELCDTECX
  3262     12  DTE-MIN-AGE                 PIC  99.                     ELCDTECX
  3263     12  DTE-DEFAULT-AGE             PIC  99.                     ELCDTECX
  3264     12  FILLER                      PIC  X.                      ELCDTECX
  3265     12  DTE-MAX-TERM                PIC  999.                    ELCDTECX
  3266     12  DTE-COMP-VG                 PIC  X.                      ELCDTECX
  3267     12  DTE-REM-TRM                 PIC  X.                      ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  75
* ECS150.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  3268     12  DTE-PRM-CK                  PIC S99V99.                  ELCDTECX
  3269     12  DTE-PRORATA                 PIC  X.                      ELCDTECX
  3270     12  DTE-CLM-REJ                 PIC  X.                      ELCDTECX
  3271     12  DTE-REF-REJ                 PIC  X.                      ELCDTECX
  3272     12  DTE-COM-TBL-USED            PIC  X.                      ELCDTECX
  3273     12  FILLER                      PIC  X.                      ELCDTECX
  3274     12  DTE-QTR-CO                  PIC  X.                      ELCDTECX
  3275     12  DTE-REF-CK                  PIC S99V99.                  ELCDTECX
  3276     12  DTE-CLM-CK                  PIC S99V99.                  ELCDTECX
  3277     12  DTE-CONV-DT                 PIC 9(11) COMP-3.               CL**2
  3278     12  DTE-DEFAULT-SEX             PIC  X.                      ELCDTECX
  3279     12  DTE-EPL-FORMAT              PIC  X.                      ELCDTECX
  3280     12  FILLER                      PIC  X.                      ELCDTECX
  3281     12  DTE-JT-AGE                  PIC  X.                      ELCDTECX
  3282     12  DTE-KEY-BIRTH               PIC  X.                      ELCDTECX
  3283     12  DTE-REINSURANCE             PIC  X.                      ELCDTECX
  3284     12  DTE-CLAIM-SORT              PIC  X.                      ELCDTECX
  3285     12  DTE-WRT-OFF                 PIC  S99V99.                 ELCDTECX
  3286     12  DTE-R78                     PIC  X.                      ELCDTECX
  3287     12  DTE-DLY-BILL                PIC  X.                      ELCDTECX
  3288     12  DTE-ALT-MORT-CODE           PIC  X(4).                   ELCDTECX
  3289     12  DTE-CLAIM-PAID-THRU-TO      PIC  X.                      ELCDTECX
  3290     12  DTE-COMPENSATION-ACCESS     PIC  X.                      ELCDTECX
  3291     12  DTE-MORTG-ACCESS-CNTL       PIC  X.                      ELCDTECX
  3292     12  DTE-MP-ALT-MORT-CODE        PIC  X(4).                   ELCDTECX
  3293     12  DTE-MORTALITY-AGE-CALC-METHOD                            ELCDTECX
  3294                                     PIC  X.                      ELCDTECX
  3295         88  DTE-USE-TABLE-ASSIGNED-METHOD VALUE '1'              ELCDTECX
  3296                                                 ' '.             ELCDTECX
  3297         88  DTE-USE-ALL-AGE-LAST          VALUE '2'.             ELCDTECX
  3298         88  DTE-USE-ALL-AGE-NEAR          VALUE '3'.             ELCDTECX
  3299     12  DTE-RESERVE-OPTION-SWITCH   PIC  X.                      ELCDTECX
  3300         88  DTE-OPT-RESERVE-METHOD-AUTH       VALUE 'Y'.         ELCDTECX
  3301         88  DTE-OPT-RESERVE-METHOD-UNAUTH     VALUE 'N' ' '.     ELCDTECX
  3302     12  DTE-REM-TRM-CALC-OPTION     PIC  X.                      ELCDTECX
  3303     12  DTE-EXPERIENCE-RETENTION-AGE                             ELCDTECX
  3304                                     PIC  9.                         CL**4
  3305     12  DTE-SYSTEM.                                              ELCDTECX
  3306         16  DTE-SYS-A-CREDIT        PIC  X.                      ELCDTECX
  3307         16  DTE-SYS-B-PEND-CLAIM    PIC  X.                      ELCDTECX
  3308         16  DTE-SYS-C-CONFIRMATIONS PIC  X.                      ELCDTECX
  3309         16  DTE-SYS-D-DEMAND-BILL   PIC  X.                      ELCDTECX
  3310         16  DTE-SYS-E-CLASIC-CLAIMS PIC  X.                      ELCDTECX
  3311         16  DTE-SYS-F-CLASIC-CREDIT PIC  X.                      ELCDTECX
  3312         16  DTE-SYS-G-AR-USED       PIC  X.                      ELCDTECX
  3313         16  DTE-SYS-H               PIC  X.                      ELCDTECX
  3314         16  DTE-SYS-I               PIC  X.                      ELCDTECX
  3315         16  DTE-SYS-J               PIC  X.                      ELCDTECX
  3316         16  DTE-SYS-K               PIC  X.                      ELCDTECX
  3317         16  DTE-SYS-L               PIC  X.                      ELCDTECX
  3318         16  DTE-SYS-M               PIC  X.                      ELCDTECX
  3319         16  DTE-SYS-N               PIC  X.                      ELCDTECX
  3320         16  DTE-SYS-O               PIC  X.                      ELCDTECX
  3321         16  DTE-SYS-P               PIC  X.                      ELCDTECX
  3322         16  DTE-SYS-Q               PIC  X.                      ELCDTECX
  3323         16  DTE-SYS-R               PIC  X.                      ELCDTECX
  3324         16  DTE-SYS-S               PIC  X.                      ELCDTECX
  3325         16  DTE-SYS-T               PIC  X.                      ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  76
* ECS150.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  3326         16  DTE-SYS-U               PIC  X.                      ELCDTECX
  3327         16  DTE-SYS-V               PIC  X.                      ELCDTECX
  3328         16  DTE-SYS-W               PIC  X.                      ELCDTECX
  3329         16  DTE-SYS-X               PIC  X.                      ELCDTECX
  3330         16  DTE-SYS-Y               PIC  X.                      ELCDTECX
  3331         16  DTE-SYS-Z               PIC  X.                      ELCDTECX
  3332     12  FILLER                      REDEFINES DTE-SYSTEM.        ELCDTECX
  3333         16  DTE-SYS-CODE            OCCURS 26 TIMES              ELCDTECX
  3334                                     PIC  X.                      ELCDTECX
  3335     12  DTE-CLIENT                  PIC  XXX.                    ELCDTECX
  3336                                                                  ELCDTECX
  3337 01  CLASIC-SYSTEM-CODES.                                         ELCDTECX
  3338     12  DTE-COLC-ID                 PIC  X(4).                   ELCDTECX
  3339     12  DTE-CLASIC-COMPANY-CD       PIC  X.                      ELCDTECX
  3340     12  DTE-CLASIC-COMPANY-NUMBER   PIC  999.                    ELCDTECX
  3341*    12  DTE-CLASIC-CLAIM-ACCESS     PIC  X.                      ELCDTECX
  3342     12  FILLER                      PIC  X.                      ELCDTECX
  3343     12  CLASIC-REIN-MAINT           PIC  XX.                     ELCDTECX
  3344     12  CLASIC-COMP-MAINT           PIC  XX.                     ELCDTECX
  3345     12  CLASIC-ACCT-MAINT           PIC  XX.                     ELCDTECX
  3346     12  CLASIC-CTBL-MAINT           PIC  XX.                     ELCDTECX
  3347     12  CLASIC-RATE-MAINT           PIC  XX.                     ELCDTECX
  3348     12  CLASIC-CREDIT-EOM-DT        PIC  XX.                     ELCDTECX
  3349     12  CLASIC-CLAIMS-EOM-DT        PIC  XX.                     ELCDTECX
  3350                                                                  ELCDTECX
  3351     12  LIFE-OVERRIDE-L1            PIC  X.                      ELCDTECX
  3352     12  LIFE-OVERRIDE-L2            PIC  XX.                     ELCDTECX
  3353     12  LIFE-OVERRIDE-L6            PIC  X(6).                   ELCDTECX
  3354     12  LIFE-OVERRIDE-L12           PIC  X(12).                  ELCDTECX
  3355                                                                  ELCDTECX
  3356     12  AH-OVERRIDE-L1              PIC  X.                      ELCDTECX
  3357     12  AH-OVERRIDE-L2              PIC  XX.                     ELCDTECX
  3358     12  AH-OVERRIDE-L6              PIC  X(6).                   ELCDTECX
  3359     12  AH-OVERRIDE-L12             PIC  X(12).                  ELCDTECX
  3360                                                                  ELCDTECX
  3361     12  CLAS-REPORT-CD1-CAPTION     PIC  X(10).                  ELCDTECX
  3362     12  CLAS-REPORT-CD2-CAPTION     PIC  X(10).                  ELCDTECX
  3363                                                                  ELCDTECX
  3364     12  CLASIC-MORTG-EOM-DT         PIC  XX.                     ELCDTECX
  3365     12  CLASIC-AR-EOM-DT            PIC  XX.                     ELCDTECX
  3366                                                                  ELCDTECX
  3367     12  FILLER                      PIC  X(11)      VALUE SPACE. ELCDTECX
  3368                                                                  ELCDTECX
  3369 01  DATE-CARD-FACTORS.                                           ELCDTECX
  3370     12  DATE-FACTOR-ID              PIC  X(4).                   ELCDTECX
  3371     12  FAC-1                       PIC S999V9(5).               ELCDTECX
  3372     12  FAC-2                       PIC S999V9(5).               ELCDTECX
  3373     12  FAC-3                       PIC S999V9(5).               ELCDTECX
  3374     12  FAC-4                       PIC S999V9(5).               ELCDTECX
  3375     12  FAC-5                       PIC S999V9(5).               ELCDTECX
  3376     12  FAC-6                       PIC S999V9(5).               ELCDTECX
  3377                                                                  ELCDTECX
  3378 01  FILLER                          PIC  X(12)                   ELCDTECX
  3379                                          VALUE 'COMPANY NAME'.   ELCDTECX
  3380 01  COMPANY-NAME-TABLE.                                          ELCDTECX
  3381     12  C-N-TBL                     OCCURS 6 TIMES.              ELCDTECX
  3382         16  CNT-ID                  PIC  X.                      ELCDTECX
  3383         16  CNT-NAME                PIC  X(30).                  ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  77
* ECS150.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  3384                                                                  ELCDTECX
  3385 01  FILLER                          PIC  X(11)                   ELCDTECX
  3386                                          VALUE 'STATE NAMES'.    ELCDTECX
  3387 01  STATE-NAMES.                                                 ELCDTECX
  3388     12  STATE-NAME-FLD              OCCURS 75 TIMES.             ELCDTECX
  3389         16  STATE-SUB               PIC  XX.                     ELCDTECX
  3390         16  STATE-PIC1.                                          ELCDTECX
  3391             20  STATE-ABBR          PIC  XX.                     ELCDTECX
  3392             20  FILLER              PIC  XXX.                    ELCDTECX
  3393             20  STATE-PIC           PIC  X(20).                  ELCDTECX
  3394             20  STATE-CALL-EARN     PIC  X.                      ELCDTECX
  3395             20  STATE-CALL-BREAK    PIC  X.                      ELCDTECX
  3396             20  STATE-PRIM-FAC-DEV  PIC  XXX.                    ELCDTECX
  3397                                                                  ELCDTECX
  3398 01  FILLER                          PIC  X(13)                   ELCDTECX
  3399                                          VALUE 'CARRIER NAMES'.  ELCDTECX
  3400 01  CARRIER-NAMES.                                               ELCDTECX
  3401     12  CARRIER-NAME-FLD            OCCURS 25 TIMES.             ELCDTECX
  3402         16  CARRIER-SUB             PIC  X.                      ELCDTECX
  3403         16  CARRIER-DOM-ST          PIC  XX.                     ELCDTECX
  3404         16  CARRIER-PIC             PIC  X(30).                  ELCDTECX
  3405         16  CARRIER-UEP-PCT         PIC  S9V9(4) COMP-3.            CL**6
  3406         16  CARRIER-R78-PCT         PIC  S9V9(4) COMP-3.            CL**6
  3407         16  CARRIER-PRO-PCT         PIC  S9V9(4) COMP-3.            CL**6
  3408*        16  FILLER                  PIC  X.                      ELCDTECX
  3409         16  CARRIER-SEC-PAY         PIC  X.
  3410             88  SEC-PAY-CARRIER          VALUE 'Y'.
  3411                                                                  ELCDTECX
  3412 01  FILLER                          PIC  X(9)                       CL**6
  3413                                          VALUE 'INS TYPES'.      ELCDTECX
  3414 01  CLAS-INS-TYPES.                                              ELCDTECX
  3415*    12 CLAS-ALL-TYPES               OCCURS 300 TIMES.            ELCDTECX
  3416     12 CLAS-ALL-TYPES               OCCURS 900 TIMES.            ELCDTECX
  3417         16  CLAS-I-BEN              PIC  XX.                     ELCDTECX
  3418         16  CLAS-I-AB3.                                          ELCDTECX
  3419             20  FILLER              PIC  X.                      ELCDTECX
  3420             20  CLAS-I-AB2.                                      ELCDTECX
  3421                 24  FILLER          PIC  X.                      ELCDTECX
  3422                 24  CLAS-I-AB1      PIC  X.                      ELCDTECX
  3423         16  CLAS-I-AB3-AH REDEFINES CLAS-I-AB3.                  ELCDTECX
  3424             20  CLAS-EXCLUSION      PIC  XX.                        CL**4
  3425             20  FILLER              PIC  X.                         CL**4
  3426         16  CLAS-I-AB10.                                         ELCDTECX
  3427             20  FILLER              PIC  X(9).                   ELCDTECX
  3428             20  CLAS-I-REIN-YN      PIC  X.                      ELCDTECX
  3429         16  CLAS-I-COMMENT          PIC  X(10).                  ELCDTECX
  3430         16  CLAS-I-JOINT            PIC  X.                      ELCDTECX
  3431         16  CLAS-I-RL-AH            PIC  X.                      ELCDTECX
  3432         16  CLAS-I-CALC-TYPE.                                    ELCDTECX
  3433             20  CLAS-I-BAL          PIC  X.                      ELCDTECX
  3434         16  CLAS-I-EP               PIC  X.                      ELCDTECX
  3435         16  CLAS-CO-BEN-I-G-CD      PIC  X.                      ELCDTECX
  3436         16  CLAS-CO-REM-TERM-CALC   PIC  X.                      ELCDTECX
  3437         16  CLAS-I-BEN-CATEGORY     PIC  X.
  3438         16  CLAS-I-REFUND-METHOD    PIC  X.
  3439         16  CLAS-I-MAX-BENEFITS     PIC 99.
  3440         16  FILLER                  PIC  XXX.
  3441                                                                  ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  78
* ECS150.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  3442 01  FILLER                          PIC  X(16)                   ELCDTECX
  3443                                     VALUE 'MORTALITY TABLES'.    ELCDTECX
  3444 01  CLAS-MORTALITY-CODES.                                        ELCDTECX
  3445     12  CLAS-MORT-FLD               OCCURS 99 TIMES              ELCDTECX
  3446                                     INDEXED BY CLAS-MORT-NDX.    ELCDTECX
  3447         16  CLAS-MORT-CODE          PIC  X(4).                      CL**6
  3448         16  CLAS-MORT-J-CODE        PIC  X.                         CL**5
  3449         16  CLAS-MORT-J-FACT        PIC S9V9(4).                    CL**6
  3450         16  CLAS-MORT-DESC.                                      ELCDTECX
  3451             20  CLAS-RESERVE-ADJ    PIC  999.                       CL**6
  3452             20  FILLER              PIC  XX.                        CL**5
  3453             20  CLAS-YEAR           PIC  X(4).                      CL**6
  3454             20  FILLER              PIC  X.                         CL**5
  3455             20  CLAS-TABLE-TYPE     PIC  XXX.                       CL**6
  3456             20  FILLER              PIC  X.                         CL**5
  3457             20  CLAS-AGE-METHOD     PIC  XX.                        CL**5
  3458             20  FILLER              PIC  X.                         CL**5
  3459             20  CLAS-INTEREST       PIC  99.99.                     CL**5
  3460             20  FILLER              PIC  X(5).                      CL**6
  3461                                                                  ELCDTECX
  3462 01  FILLER                          PIC  X(15)                   ELCDTECX
  3463                                     VALUE 'BUSINESS TABLES'.     ELCDTECX
  3464 01  CLAS-BUSINESS-CLASSES.                                       ELCDTECX
  3465     12  CLAS-BUSC-FLD               OCCURS 50 TIMES.             ELCDTECX
  3466         16  CLAS-BUSC-CODE          PIC  99.                     ELCDTECX
  3467         16  CLAS-BUSC-GROUP         PIC  X.                      ELCDTECX
  3468         16  CLAS-BUSC-DESC          PIC  X(19).                  ELCDTECX
  3469         16  CLAS-BUSC-EXCL          PIC  X.                         CL**5
  3470         16  FILLER                  PIC  X(4).                      CL**6
  3471                                                                  ELCDTECX
  3472 01  FILLER                          PIC  X(7)                       CL**6
  3473                                     VALUE 'INDEXES'.             ELCDTECX
  3474 01  CLAS-INDEX-TBL.                                              ELCDTECX
  3475     12  CLAX-ID                     PIC  X(4).                   ELCDTECX
  3476     12  CLAS-STARTC                 PIC S9(4) COMP.              ELCDTECX
  3477     12  CLAS-MAXC                   PIC S9(4) COMP.              ELCDTECX
  3478     12  CLAS-STARTL                 PIC S9(4) COMP.              ELCDTECX
  3479     12  CLAS-MAXL                   PIC S9(4) COMP.              ELCDTECX
  3480     12  CLAS-STARTA                 PIC S9(4) COMP.              ELCDTECX
  3481     12  CLAS-MAXA                   PIC S9(4) COMP.              ELCDTECX
  3482     12  CLAS-STARTM                 PIC S9(4) COMP.              ELCDTECX
  3483     12  CLAS-MAXM                   PIC S9(4) COMP.              ELCDTECX
  3484     12  CLAS-STARTB                 PIC S9(4) COMP.              ELCDTECX
  3485     12  CLAS-MAXB                   PIC S9(4) COMP.              ELCDTECX
  3486     12  CLAS-STARTS                 PIC S9(4) COMP.              ELCDTECX
  3487     12  CLAS-MAXS                   PIC S9(4) COMP.              ELCDTECX
  3488     12  CLAS-STARTE                 PIC S9(4) COMP.              ELCDTECX
  3489     12  CLAS-MAXE                   PIC S9(4) COMP.              ELCDTECX
  3490     12  CLAS-STARTCN                PIC S9(4) COMP.              ELCDTECX
  3491     12  CLAS-MAXCN                  PIC S9(4) COMP.              ELCDTECX
  3492                                                                  ELCDTECX
  3493 01  CLAS-TYPE-MISC.                                              ELCDTECX
  3494     12  CLAS-INDEXC                 PIC S9(4) COMP.              ELCDTECX
  3495     12  CLAS-INDEXL                 PIC S9(4) COMP.              ELCDTECX
  3496     12  CLAS-INDEXA                 PIC S9(4) COMP.              ELCDTECX
  3497     12  CLAS-INDEXM                 PIC S9(4) COMP.              ELCDTECX
  3498     12  CLAS-INDEXB                 PIC S9(4) COMP.              ELCDTECX
  3499     12  CLAS-INDEXS                 PIC S9(4) COMP.              ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  79
* ECS150.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  3500     12  CLAS-INDEXE                 PIC S9(4) COMP.              ELCDTECX
  3501     12  CLAS-INDEX                  PIC S9(4) COMP.              ELCDTECX
  3502     12  CLAS-INDEXEN                PIC S9(4) COMP.              ELCDTECX
  3503     12  CLAS-INDEXCN                PIC S9(4) COMP.              ELCDTECX
  3504     12  CLAS-INDEXON                PIC S9(4) COMP.              ELCDTECX
  3505                                                                  ELCDTECX
  3506 01  FILLER                          PIC  X(13)                   ELCDTECX
  3507                                     VALUE 'MISCELLANEOUS'.       ELCDTECX
  3508 01  CLAS-MISC.                                                   ELCDTECX
  3509     12  DTE-FICH                    PIC  X.                      ELCDTECX
  3510         88  FICH-NO                 VALUE SPACE.                 ELCDTECX
  3511         88  FICH-ONLY               VALUE '1'.                   ELCDTECX
  3512         88  FICH-BOTH               VALUE '2'.                   ELCDTECX
  3513     12  FICH-OPEN                   PIC  X.                      ELCDTECX
  3514     12  REPT-OPEN                   PIC  X.                      ELCDTECX
  3515     12  DTE-PGM-OPT                 PIC  9.                         CL**5
  3516     12  DTE-PRT-OPT                 PIC  X.                      ELCDTECX
  3517     12  DTE-FMT-OPT                 PIC  9.                      ELCDTECX
  3518     12  DTE-PRC-OPT                 PIC  9.                      ELCDTECX
  3519     12  DTE-TOT-OPT                 PIC  9.                      ELCDTECX
  3520     12  CLAS-LOOK                   PIC  XX.                     ELCDTECX
  3521     12  DTE-TOT-LINES               PIC S9(8)      COMP.         ELCDTECX
  3522     12  STATE-L                     PIC  XX.                     ELCDTECX
  3523     12  CLAS-CN                     PIC  99.                     ELCDTECX
  3524     12  CLAS-CO                     PIC  99.                     ELCDTECX
  3525     12  DTE-VSAM-FLAGS                              VALUE ZERO.  ELCDTECX
  3526         16  DTE-F-1                 PIC  X.                      ELCDTECX
  3527         16  DTE-F-2                 PIC  X.                      ELCDTECX
  3528     12  DTE-ABEND-WORK.                                          ELCDTECX
  3529         16  DTE-ABEND-CD-1          PIC  XX         VALUE SPACES.ELCDTECX
  3530         16  DTE-ABEND-CD-2          PIC  XX         VALUE SPACES.ELCDTECX
  3531                                                                  ELCDTECX
  3532 01  FILLER                          PIC  X(12)                   ELCDTECX
  3533                                     VALUE 'WORKING DATE'.        ELCDTECX
  3534 01  WS-DATE-AND-TIME.                                            ELCDTECX
  3535     12  WS-ACCEPT-DATE.                                          ELCDTECX
  3536         16  WS-AD-YY                PIC  99.                     ELCDTECX
  3537         16  WS-AD-MM                PIC  99.                     ELCDTECX
  3538         16  WS-AD-DD                PIC  99.                     ELCDTECX
  3539     12  WS-CURRENT-DATE.                                         ELCDTECX
  3540         16  WS-CD-MM                PIC  99.                     ELCDTECX
  3541         16  FILLER                  PIC  X          VALUE '/'.   ELCDTECX
  3542         16  WS-CD-DD                PIC  99.                     ELCDTECX
  3543         16  FILLER                  PIC  X          VALUE '/'.   ELCDTECX
  3544         16  WS-CD-YY                PIC  99.                     ELCDTECX
  3545     12  WS-TIME-OF-DAY.                                          ELCDTECX
  3546         16  WS-TIME                 PIC  9(6).                   ELCDTECX
  3547         16  WS-HUN-SEC              PIC  99.                     ELCDTECX
  3548                                                                  ELCDTECX
  3549 01  FILLER                          PIC  X(12)                   ELCDTECX
  3550                                     VALUE 'CARRIER CLMS'.        ELCDTECX
  3551 01  CARRIER-OPT-CLAIM-DATA.                                      ELCDTECX
  3552     12  CARRIER-FLDS                OCCURS 25 TIMES.             ELCDTECX
  3553         16  CARRIER-IBNR-SWITCH     PIC  X.                         CL**5
  3554         16  CARRIER-IBNR-PERCENT    PIC S9V9(4) COMP-3.             CL**6
  3555         16  CARRIER-CIDA-DISCOUNT   PIC S9V9(4) COMP-3.             CL**6
  3556                                                                  ELCDTECX
  3557 01  FILLER                          PIC  X(10)                   ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  80
* ECS150.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  3558                                     VALUE 'STATE TLRS'.          ELCDTECX
  3559 01  STATE-TARGET-LOSS-RATIOS.                                    ELCDTECX
  3560     12  STATE-TLR-FLD               OCCURS 75 TIMES.             ELCDTECX
  3561         16  STATE-TARGET-LOSS-RATIO PIC S9V9(4) COMP-3.             CL**6
  3562         16  STATE-CALC-INTEREST     PIC S9V9(4) COMP-3.             CL**6
  3563                                                                  ELCDTECX
  3564 01  FILLER                          PIC  X(13)                   ELCDTECX
  3565                                     VALUE 'BUSINESS TLRS'.       ELCDTECX
  3566 01  BUSINESS-TRGT-LOSS-RATIO-MODS.                               ELCDTECX
  3567     12  BUS-TLRM-FLD                OCCURS 99 TIMES.             ELCDTECX
  3568         16  BUS-TRGT-LOSS-RATIO-MOD PIC S9V9(4) COMP-3.             CL**6
  3569                                                                  ELCDTECX
  3570 01  FILLER                          PIC  X(13)                   ELCDTECX
  3571                                     VALUE 'MISC CLM DATA'.       ELCDTECX
  3572 01  MISC-OPT-CLM-RSV-DATA.                                       ELCDTECX
  3573     12  COMPANY-CALC-INTEREST       PIC S9V9(4) COMP-3.             CL**6
  3574     12  COMPANY-CIDA-DISCOUNT       PIC S9V9(4) COMP-3.             CL**6
  3575     12  COMPANY-CRDB-TABLE-SELECTION                             ELCDTECX
  3576                                     PIC  X.                         CL**5
  3577     12  COMPANY-IBNR-AH-FACTOR      PIC S9V9(4) COMP-3.             CL**6
  3578     12  COMPANY-IBNR-LAG-MONTH      PIC S999    COMP-3.             CL**6
  3579     12  COMPANY-IBNR-LIFE-FACTOR    PIC S9V9(4) COMP-3.             CL**6
  3580     12  COMPANY-OPTION-START-DATE   PIC  XX.                        CL**5
  3581     12  INDEXBS                     PIC S9(4)   COMP.               CL**6
  3582     12  INDEXCA                     PIC S9(4)   COMP.               CL**6
  3583     12  INDEXST                     PIC S9(4)   COMP.               CL**6
  3584     12  FILLER                      PIC  X(75).                  ELCDTECX
  3585******************************************************************ELCDTECX
  3586*01  MISC-CARR-PCT-DATA.                                          00001521
  3587*    12  DD-CARR1-UEP-PCT            PIC S9V9(4) COMP-3.          00001522
  3588*    12  DD-CARR1-R78-PCT            PIC S9V9(4) COMP-3.          00001522
  3589*    12  DD-CARR1-PRO-PCT            PIC S9V9(4) COMP-3.          00001522
  3590*    12  DD-CARR2-UEP-PCT            PIC S9V9(4) COMP-3.          00001522
  3591*    12  DD-CARR2-R78-PCT            PIC S9V9(4) COMP-3.          00001522
  3592*    12  DD-CARR2-PRO-PCT            PIC S9V9(4) COMP-3.          00001522
  3593******************************************************************ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  81
* ECS150.cbl
* 3595                             COPY ELCDTEVR.
  3596***************************************************************** 04/15/98
  3597*                                                                *ELCDTEVR
  3598*                                                                *ELCDTEVR
  3599*                            ELCDTEVR.                           *   LV003
  3600*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
  3601*                            VMOD=2.001                          *   CL**2
  3602*                                                                *ELCDTEVR
  3603*   WORKING STORAGE FOR DATE VARIABLES CREATED                   *ELCDTEVR
  3604*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCDTEVR
  3605*                                                                *ELCDTEVR
  3606******************************************************************ELCDTEVR
  3607 01  WS-DATE-CARD-DATE.                                           ELCDTEVR
  3608     05  WS-RUN-DATE.                                             ELCDTEVR
  3609         10  FILLER                  PIC  9(03).                  ELCDTEVR
  3610         10  RUN-CCYY                PIC  9(04).                  ELCDTEVR
  3611         10  RUN-CCYR  REDEFINES  RUN-CCYY.                       ELCDTEVR
  3612             15  RUN-CC              PIC  99.                     ELCDTEVR
  3613             15  RUN-YR              PIC  99.                     ELCDTEVR
  3614         10  RUN-MO                  PIC  99.                     ELCDTEVR
  3615         10  RUN-DA                  PIC  99.                     ELCDTEVR
  3616     05  WS-RUN-DATE-N REDEFINES                                     CL**2
  3617            WS-RUN-DATE              PIC 9(11).                      CL**2
  3618     05  WS-EP-DT.                                                ELCDTEVR
  3619         10  FILLER                  PIC  9(03).                  ELCDTEVR
  3620         10  EP-CCYY                 PIC  9(04).                  ELCDTEVR
  3621         10  EP-CCYR  REDEFINES  EP-CCYY.                         ELCDTEVR
  3622             15  EP-CC               PIC  99.                     ELCDTEVR
  3623             15  EP-YR               PIC  99.                     ELCDTEVR
  3624         10  EP-MO                   PIC  99.                     ELCDTEVR
  3625         10  EP-DA                   PIC  99.                     ELCDTEVR
  3626     05  WS-EP-DT-N REDEFINES                                        CL**2
  3627            WS-EP-DT                 PIC 9(11).                      CL**2
  3628     05  WS-DTE-CONV-DT.                                             CL**4
  3629         10  FILLER                  PIC  9(03).                     CL**4
  3630         10  DTE-CONV-CCYY           PIC  9(04).                     CL**4
  3631         10  DTE-CONV-CCYR  REDEFINES  DTE-CONV-CCYY.                CL**4
  3632             15  DTE-CONV-CC         PIC  99.                        CL**4
  3633             15  DTE-CONV-YR         PIC  99.                        CL**4
  3634         10  DTE-CONV-MO             PIC  99.                        CL**4
  3635         10  DTE-CONV-DA             PIC  99.                        CL**4
  3636     05  WS-DTE-CONV-DT-N REDEFINES                                  CL**4
  3637            WS-DTE-CONV-DT           PIC  9(11).                     CL**4
  3638 01  WS-BALANCE-FORWARD-DATE.                                     ELCDTEVR
  3639     05  WS-BF-LAST-ACTIVITY-DATE.                                ELCDTEVR
  3640         10  FILLER                            PIC 999.           ELCDTEVR
  3641         10  BF-ACT-CCYY                       PIC 9(04).         ELCDTEVR
  3642         10  BF-ACT-CCYR  REDEFINES  BF-ACT-CCYY.                 ELCDTEVR
  3643             15  BF-ACT-CC                     PIC 99.            ELCDTEVR
  3644             15  BF-ACT-YEAR                   PIC 99.            ELCDTEVR
  3645         10  BF-ACT-MONTH                      PIC 99.            ELCDTEVR
  3646         10  BF-ACT-DAY                        PIC 99.            ELCDTEVR
  3647     05  WS-BF-LAST-ACTIVITY-DATE-N REDEFINES                        CL**2
  3648            WS-BF-LAST-ACTIVITY-DATE           PIC 9(11).            CL**2
  3649     05  WS-BF-CURRENT-LAST-STMT-DT.                              ELCDTEVR
  3650         10  FILLER                            PIC 999.           ELCDTEVR
  3651         10  BF-CURRENT-LAST-STMT-CEN          PIC 99.            ELCDTEVR
  3652         10  BF-CURRENT-LAST-STMT-YEAR         PIC 99.            ELCDTEVR
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  82
* ECS150.cbl (/apps/prod/cid1p/copy/ELCDTEVR)
  3653         10  BF-CURRENT-LAST-STMT-MONTH        PIC 99.            ELCDTEVR
  3654         10  BF-CURRENT-LAST-STMT-DAY          PIC 99.            ELCDTEVR
  3655     05  WS-BF-CURRENT-LAST-STMT-DT-N REDEFINES                      CL**2
  3656            WS-BF-CURRENT-LAST-STMT-DT        PIC 9(11).             CL**2
  3657 01  WS-ADD-CONF-TRANSACTIONS-DTE.                                ELCDTEVR
  3658     05  WS-AC-CERT-EFF-DATE.                                     ELCDTEVR
  3659         10  FILLER                            PIC 999.           ELCDTEVR
  3660         10  AC-CERT-CCYY                      PIC 9(04).         ELCDTEVR
  3661         10  AC-CERT-CCYR  REDEFINES  AC-CERT-CCYY.               ELCDTEVR
  3662             15  AC-CERT-CC                    PIC 99.            ELCDTEVR
  3663             15  AC-CERT-YR                    PIC 99.            ELCDTEVR
  3664         10  AC-CERT-MO                        PIC 99.            ELCDTEVR
  3665         10  AC-CERT-DA                        PIC 99.            ELCDTEVR
  3666     05  WS-AC-CERT-EFF-DATE-N REDEFINES                             CL**2
  3667            WS-AC-CERT-EFF-DATE                PIC 9(11).            CL**2
  3668     05  WS-AC-LIFE-CANCEL-DATE.                                  ELCDTEVR
  3669         10  FILLER                            PIC 999.           ELCDTEVR
  3670         10  AC-LIFE-CANCEL-CCYY               PIC 9(04).         ELCDTEVR
  3671         10  AC-LIFE-CANCEL-CCYR REDEFINES AC-LIFE-CANCEL-CCYY.   ELCDTEVR
  3672             15  AC-LIFE-CANCEL-CC             PIC 99.            ELCDTEVR
  3673             15  AC-LIFE-CANCEL-YR             PIC 99.            ELCDTEVR
  3674         10  AC-LIFE-CANCEL-MO                 PIC 99.            ELCDTEVR
  3675         10  AC-LIFE-CANCEL-DA                 PIC 99.            ELCDTEVR
  3676     05  WS-AC-LIFE-CANCEL-DATE-N REDEFINES                          CL**2
  3677            WS-AC-LIFE-CANCEL-DATE             PIC 9(11).            CL**2
  3678     05  WS-AC-AH-CANCEL-DATE.                                    ELCDTEVR
  3679         10  FILLER                            PIC 999.           ELCDTEVR
  3680         10  AC-AH-CANCEL-CCYY                 PIC 9(04).         ELCDTEVR
  3681         10  AC-AH-CANCEL-CCYR  REDEFINES  AC-AH-CANCEL-CCYY.     ELCDTEVR
  3682             15  AC-AH-CANCEL-CC               PIC 99.            ELCDTEVR
  3683             15  AC-AH-CANCEL-YR               PIC 99.            ELCDTEVR
  3684         10  AC-AH-CANCEL-MO                   PIC 99.            ELCDTEVR
  3685         10  AC-AH-CANCEL-DA                   PIC 99.            ELCDTEVR
  3686     05  WS-AC-AH-CANCEL-DATE-N REDEFINES                            CL**2
  3687            WS-AC-AH-CANCEL-DATE               PIC 9(11).            CL**2
  3688 01  WS-RATE-RECORD.                                              ELCDTEVR
  3689         05  WS-RT-EXPIRY-DATE.                                   ELCDTEVR
  3690             10  FILLER                        PIC 999.           ELCDTEVR
  3691             10  RT-EXP-CCYY                   PIC 9(04).         ELCDTEVR
  3692             10  RT-EXP-CCYR  REDEFINES  RT-EXP-CCYY.             ELCDTEVR
  3693                 15  RT-EXP-CC                 PIC 99.            ELCDTEVR
  3694                 15  RT-EXP-YR                 PIC 99.            ELCDTEVR
  3695             10  RT-EXP-MO                     PIC 99.            ELCDTEVR
  3696             10  RT-EXP-DA                     PIC 99.            ELCDTEVR
  3697         05  WS-RT-EXPIRY-DATE-N REDEFINES                           CL**2
  3698                WS-RT-EXPIRY-DATE              PIC 9(11).            CL**2
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  83
* ECS150.cbl
* 3700                             COPY ELCCRTVR.
  3701***************************************************************** 04/24/98
  3702*                                                                *ELCCRTVR
  3703*                                                                *ELCCRTVR
  3704*                            ELCCRTVR                            *   LV003
  3705*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  3706*                            VMOD=2.001                          *ELCCRTVR
  3707*                                                                *ELCCRTVR
  3708*   WORKING STORAGE FOR DATE VARIABLES CREATED                   *ELCCRTVR
  3709*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCCRTVR
  3710*                                                                *ELCCRTVR
  3711******************************************************************ELCCRTVR
  3712                                                                  ELCCRTVR
  3713 01  WS-CERTIFICATE-RECORD-DATE.                                  ELCCRTVR
  3714     05  WS-CR-DT.                                                ELCCRTVR
  3715         10  FILLER                PIC 999.                       ELCCRTVR
  3716         10  CR-CCYY               PIC 9(04).                     ELCCRTVR
  3717         10  CR-CCYR  REDEFINES  CR-CCYY.                         ELCCRTVR
  3718             15  CR-CC             PIC 99.                        ELCCRTVR
  3719             15  CR-YR             PIC 99.                        ELCCRTVR
  3720         10  CR-MO                 PIC 99.                        ELCCRTVR
  3721         10  CR-DA                 PIC 99.                        ELCCRTVR
  3722     05  WS-CR-DT-N REDEFINES                                        CL**2
  3723            WS-CR-DT               PIC 9(11).                        CL**2
  3724     05  WS-CR-LF-EXPIRE-DATE.                                    ELCCRTVR
  3725         10  FILLER                    PIC 999.                   ELCCRTVR
  3726         10  CR-LF-EXPIRE-CCYY         PIC 9(04).                 ELCCRTVR
  3727         10  CR-LF-EXPIRE-CCYR  REDEFINES  CR-LF-EXPIRE-CCYY.     ELCCRTVR
  3728             15  CR-LF-EXPIRE-CC       PIC 99.                    ELCCRTVR
  3729             15  CR-LF-EXPIRE-YR       PIC 99.                    ELCCRTVR
  3730         10  CR-LF-EXPIRE-MO           PIC 99.                    ELCCRTVR
  3731         10  CR-LF-EXPIRE-DA           PIC 99.                    ELCCRTVR
  3732     05  WS-CR-LF-EXPIRE-DATE-N REDEFINES                            CL**2
  3733            WS-CR-LF-EXPIRE-DATE       PIC 9(11).                    CL**2
  3734     05  WS-CR-AH-EXPIRE-DATE.                                    ELCCRTVR
  3735         10  FILLER                    PIC 999.                   ELCCRTVR
  3736         10  CR-AH-EXPIRE-CCYY         PIC 9(04).                 ELCCRTVR
  3737         10  CR-AH-EXPIRE-CCYR   REDEFINES CR-AH-EXPIRE-CCYY.     ELCCRTVR
  3738             15  CR-AH-EXPIRE-CC       PIC 99.                    ELCCRTVR
  3739             15  CR-AH-EXPIRE-YR       PIC 99.                    ELCCRTVR
  3740         10  CR-AH-EXPIRE-MO           PIC 99.                    ELCCRTVR
  3741         10  CR-AH-EXPIRE-DA           PIC 99.                    ELCCRTVR
  3742     05  WS-CR-AH-EXPIRE-DATE-N REDEFINES                            CL**2
  3743            WS-CR-AH-EXPIRE-DATE       PIC 9(11).                    CL**2
  3744     05  WS-CR-ENTRY-DATE.                                        ELCCRTVR
  3745         10  FILLER                    PIC 999.                   ELCCRTVR
  3746         10  CR-ENTRY-CCYY             PIC 9(04).                 ELCCRTVR
  3747         10  CR-ENTRY-CCYR  REDEFINES  CR-ENTRY-CCYY.             ELCCRTVR
  3748             15 CR-ENTRY-CC            PIC 99.                    ELCCRTVR
  3749             15 CR-ENTRY-YR            PIC 99.                    ELCCRTVR
  3750         10  CR-ENTRY-MO               PIC 99.                    ELCCRTVR
  3751         10  CR-ENTRY-DA               PIC 99.                    ELCCRTVR
  3752     05  WS-CR-ENTRY-DATE-N REDEFINES                                CL**2
  3753            WS-CR-ENTRY-DATE           PIC 9(11).                    CL**2
  3754     05  WS-CR-LF-CANC-DT.                                        ELCCRTVR
  3755         10  FILLER                    PIC 999.                   ELCCRTVR
  3756         10  CR-LF-CNC-CCYY            PIC 9(04).                 ELCCRTVR
  3757         10  CR-LF-CNC-CCYR   REDEFINES CR-LF-CNC-CCYY.           ELCCRTVR
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  84
* ECS150.cbl (/apps/prod/cid1p/copy/ELCCRTVR)
  3758             15  CR-LF-CNC-CC          PIC 99.                    ELCCRTVR
  3759             15  CR-LF-CNC-YR          PIC 99.                    ELCCRTVR
  3760         10  CR-LF-CNC-MO              PIC 99.                    ELCCRTVR
  3761         10  CR-LF-CNC-DA              PIC 99.                    ELCCRTVR
  3762     05  WS-CR-LF-CANC-DT-N REDEFINES                                CL**2
  3763            WS-CR-LF-CANC-DT           PIC 9(11).                    CL**2
  3764     05  WS-CR-LF-CANCEL-EXIT-DATE.                               ELCCRTVR
  3765         10  FILLER                    PIC 999.                   ELCCRTVR
  3766         10  CR-LF-CEX-CCYY            PIC 9(04).                 ELCCRTVR
  3767         10  CR-LF-CEX-CCYR  REDEFINES  CR-LF-CEX-CCYY.              CL**3
  3768             15  CR-LF-CEX-CC          PIC 99.                    ELCCRTVR
  3769             15  CR-LF-CEX-YR          PIC 99.                    ELCCRTVR
  3770         10  CR-LF-CEX-MO              PIC 99.                    ELCCRTVR
  3771         10  CR-LF-CEX-DA              PIC 99.                    ELCCRTVR
  3772     05  WS-CR-LF-CANCEL-EXIT-DATE-N REDEFINES                       CL**2
  3773            WS-CR-LF-CANCEL-EXIT-DATE  PIC 9(11).                    CL**2
  3774     05  WS-CR-LF-CLAIM-EXIT-DATE.                                ELCCRTVR
  3775         10  FILLER                    PIC 999.                   ELCCRTVR
  3776         10  CR-LF-DEX-CCYY            PIC 9(04).                 ELCCRTVR
  3777         10  CR-LF-DEX-CCYR  REDEFINES  CR-LF-DEX-CCYY.           ELCCRTVR
  3778             15  CR-LF-DEX-CC          PIC 99.                    ELCCRTVR
  3779             15  CR-LF-DEX-YR          PIC 99.                    ELCCRTVR
  3780         10  CR-LF-DEX-MO              PIC 99.                    ELCCRTVR
  3781         10  CR-LF-DEX-DA              PIC 99.                    ELCCRTVR
  3782     05  WS-CR-LF-CLAIM-EXIT-DATE-N REDEFINES                        CL**2
  3783            WS-CR-LF-CLAIM-EXIT-DATE   PIC 9(11).                    CL**2
  3784     05  WS-CR-AH-CANC-DT.                                        ELCCRTVR
  3785         10  FILLER                    PIC 999.                   ELCCRTVR
  3786         10  CR-AH-CNC-CCYY            PIC 9(04).                 ELCCRTVR
  3787         10  CR-AH-CNC-CCYR  REDEFINES  CR-AH-CNC-CCYY.           ELCCRTVR
  3788             15  CR-AH-CNC-CC          PIC 99.                    ELCCRTVR
  3789             15  CR-AH-CNC-YR          PIC 99.                    ELCCRTVR
  3790         10  CR-AH-CNC-MO              PIC 99.                    ELCCRTVR
  3791         10  CR-AH-CNC-DA              PIC 99.                    ELCCRTVR
  3792     05  WS-CR-AH-CANC-DT-N  REDEFINES                               CL**2
  3793            WS-CR-AH-CANC-DT           PIC 9(11).                    CL**2
  3794     05  WS-CR-AH-CANCEL-EXIT-DATE.                               ELCCRTVR
  3795         10  FILLER                    PIC 999.                   ELCCRTVR
  3796         10  CR-AH-CEX-CCYY            PIC 9(04).                 ELCCRTVR
  3797         10  CR-AH-CEX-CCYR  REDEFINES  CR-AH-CEX-CCYY.           ELCCRTVR
  3798             15  CR-AH-CEX-CC          PIC 99.                    ELCCRTVR
  3799             15  CR-AH-CEX-YR          PIC 99.                    ELCCRTVR
  3800         10  CR-AH-CEX-MO              PIC 99.                    ELCCRTVR
  3801         10  CR-AH-CEX-DA              PIC 99.                    ELCCRTVR
  3802     05  WS-CR-AH-CANCEL-EXIT-DATE-N REDEFINES                       CL**2
  3803            WS-CR-AH-CANCEL-EXIT-DATE  PIC 9(11).                    CL**2
  3804     05  WS-CR-AH-SETTLEMENT-EXIT-DATE.                           ELCCRTVR
  3805         10  FILLER                    PIC 999.                   ELCCRTVR
  3806         10  CR-AH-DEX-CCYY            PIC 9(04).                 ELCCRTVR
  3807         10  CR-AH-DEX-CCYR  REDEFINES  CR-AH-DEX-CCYY.           ELCCRTVR
  3808             15  CR-AH-DEX-CC          PIC 99.                    ELCCRTVR
  3809             15  CR-AH-DEX-YR          PIC 99.                    ELCCRTVR
  3810         10  CR-AH-DEX-MO              PIC 99.                    ELCCRTVR
  3811         10  CR-AH-DEX-DA              PIC 99.                    ELCCRTVR
  3812     05  WS-CR-AH-SETTLEMENT-EXIT-DATEN REDEFINES                    CL**5
  3813          WS-CR-AH-SETTLEMENT-EXIT-DATE   PIC 9(11).                 CL**5
  3814     05  WS-CR-DTH-DT.                                            ELCCRTVR
  3815         10  FILLER                    PIC 999.                   ELCCRTVR
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  85
* ECS150.cbl (/apps/prod/cid1p/copy/ELCCRTVR)
  3816         10  CR-DTH-CCYY               PIC 9(04).                 ELCCRTVR
  3817         10  CR-DTH-CCYR  REDEFINES  CR-DTH-CCYY.                 ELCCRTVR
  3818             15  CR-DTH-CC             PIC 99.                    ELCCRTVR
  3819             15  CR-DTH-YR             PIC 99.                    ELCCRTVR
  3820         10  CR-DTH-MO                 PIC 99.                    ELCCRTVR
  3821         10  CR-DTH-DA                 PIC 99.                    ELCCRTVR
  3822     05  WS-CR-DTH-DT-N REDEFINES                                    CL**2
  3823            WS-CR-DTH-DT               PIC 9(11).                    CL**2
  3824     05  WS-CR-DTH-PAY-DT.                                        ELCCRTVR
  3825         10  FILLER                    PIC 999.                   ELCCRTVR
  3826         10  CR-DTH-PAY-CCYY           PIC 9(04).                 ELCCRTVR
  3827         10  CR-DTH-PAY-CCYR  REDEFINES CR-DTH-PAY-CCYY.          ELCCRTVR
  3828             15  CR-DTH-PAY-CC         PIC 99.                    ELCCRTVR
  3829             15  CR-DTH-PAY-YR         PIC 99.                    ELCCRTVR
  3830         10  CR-DTH-PAY-MO             PIC 99.                    ELCCRTVR
  3831         10  CR-DTH-PAY-DA             PIC 99.                    ELCCRTVR
  3832     05  WS-CR-DTH-PAY-DT-N REDEFINES                                CL**2
  3833            WS-CR-DTH-PAY-DT           PIC 9(11).                    CL**2
  3834     05  WS-CR-DIS-DT.                                            ELCCRTVR
  3835         10  FILLER                    PIC 999.                   ELCCRTVR
  3836         10  CR-DIS-CCYY               PIC 9(04).                 ELCCRTVR
  3837         10  CR-DIS-CCYR  REDEFINES  CR-DIS-CCYY.                 ELCCRTVR
  3838             15  CR-DIS-CC             PIC 99.                    ELCCRTVR
  3839             15  CR-DIS-YR             PIC 99.                    ELCCRTVR
  3840         10  CR-DIS-MO                 PIC 99.                    ELCCRTVR
  3841         10  CR-DIS-DA                 PIC 99.                    ELCCRTVR
  3842     05  WS-CR-DIS-DT-N REDEFINES                                    CL**2
  3843            WS-CR-DIS-DT               PIC 9(11).                    CL**2
  3844     05  WS-CR-DIS-PAY-DT.                                        ELCCRTVR
  3845         10  FILLER                    PIC 999.                   ELCCRTVR
  3846         10  CR-DIS-PAY-CCYY           PIC 9(04).                 ELCCRTVR
  3847         10  CR-DIS-PAY-CCYR  REDEFINES  CR-DIS-PAY-CCYY.         ELCCRTVR
  3848             15  CR-DIS-PAY-CC         PIC 99.                    ELCCRTVR
  3849             15  CR-DIS-PAY-YR         PIC 99.                    ELCCRTVR
  3850         10  CR-DIS-PAY-MO             PIC 99.                    ELCCRTVR
  3851         10  CR-DIS-PAY-DA             PIC 99.                    ELCCRTVR
  3852     05  WS-CR-DIS-PAY-DT-N REDEFINES                                CL**2
  3853            WS-CR-DIS-PAY-DT           PIC 9(11).                    CL**2
  3854     05  WS-CR-DIS-PTO-DT.                                        ELCCRTVR
  3855         10  FILLER                    PIC 999.                   ELCCRTVR
  3856         10  CR-DIS-PTO-CCYY           PIC 9(04).                 ELCCRTVR
  3857         10  CR-DIS-PTO-CCYR  REDEFINES  CR-DIS-PTO-CCYY.         ELCCRTVR
  3858             15  CR-DIS-PTO-CC         PIC 99.                    ELCCRTVR
  3859             15  CR-DIS-PTO-YR         PIC 99.                    ELCCRTVR
  3860         10  CR-DIS-PTO-MO             PIC 99.                    ELCCRTVR
  3861         10  CR-DIS-PTO-DA             PIC 99.                    ELCCRTVR
  3862     05  WS-CR-DIS-PTO-DT-N REDEFINES                                CL**2
  3863            WS-CR-DIS-PTO-DT           PIC 9(11).                    CL**2
  3864     05  COPY-NDX                      PIC 9.                        CL**6
  3865     05  WS-DIS-INCUR-DT OCCURS 5 TIMES.                             CL**6
  3866         10  WS-CR-DIS-INCUR-DT.                                  ELCCRTVR
  3867             15  FILLER                PIC 999.                   ELCCRTVR
  3868             15  CR-DIS-INC-CCYY       PIC 9(04).                 ELCCRTVR
  3869             15  CR-DIS-INC-CCYR  REDEFINES  CR-DIS-INC-CCYY.     ELCCRTVR
  3870                 20  CR-DIS-INC-CC     PIC 99.                    ELCCRTVR
  3871                 20  CR-DIS-INC-YR     PIC 99.                    ELCCRTVR
  3872             15  CR-DIS-INC-MO         PIC 99.                    ELCCRTVR
  3873             15  CR-DIS-INC-DA         PIC 99.                    ELCCRTVR
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  86
* ECS150.cbl
  3874         10  WS-CR-DIS-INCUR-DT-N REDEFINES                          CL**2
  3875                WS-CR-DIS-INCUR-DT     PIC 9(11).                    CL**2
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  87
* ECS150.cbl
* 3877                             COPY ELCACCTV.
  3878******************************************************************04/14/98
  3879*                                                                *ELCACCTV
  3880*                            ELCACCTV                            *   LV002
  3881*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  3882*                            VMOD=2.001                          *ELCACCTV
  3883*                                                                *ELCACCTV
  3884*   WORKING STORAGE FOR DATE VARIABLES CREATED                   *ELCACCTV
  3885*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCACCTV
  3886*                                                                *ELCACCTV
  3887*  NO  CID  MODS  IN  COPYBOOK  ELCACCTV                         *ELCACCTV
  3888*                                                                *ELCACCTV
  3889******************************************************************ELCACCTV
  3890                                                                  ELCACCTV
  3891 01  WS-ACCOUNT-MASTER-DATE.                                      ELCACCTV
  3892                                                                  ELCACCTV
  3893     05  WS-AM-EXPIRE-DT.                                         ELCACCTV
  3894         10  FILLER            PIC 999.                           ELCACCTV
  3895         10  AM-EXP-CCYY       PIC 9(04).                         ELCACCTV
  3896         10  AM-EXP-CCYR  REDEFINES  AM-EXP-CCYY.                 ELCACCTV
  3897             15  AM-EXP-CC     PIC 99.                            ELCACCTV
  3898             15  AM-EXP-YR     PIC 99.                            ELCACCTV
  3899         10  AM-EXP-MO         PIC 99.                               CL**5
  3900         10  AM-EXP-DA         PIC 99.                               CL**5
  3901     05  WS-AM-EXPIRE-DT-N REDEFINES                                 CL**3
  3902            WS-AM-EXPIRE-DT    PIC 9(11).                            CL**4
  3903     05  WS-AM-VG-EXP-DATE.                                       ELCACCTV
  3904         10  FILLER                    PIC 999.                   ELCACCTV
  3905         10  AM-VG-EXP-CCYY            PIC 9(04).                 ELCACCTV
  3906         10  AM-VG-EXP-CCYR  REDEFINES  AM-VG-EXP-CCYY.           ELCACCTV
  3907             15  AM-VG-EXP-CC          PIC 99.                    ELCACCTV
  3908             15  AM-VG-EXP-YR          PIC 99.                    ELCACCTV
  3909         10  AM-VG-EXP-MO              PIC 99.                    ELCACCTV
  3910         10  AM-VG-EXP-DA              PIC 99.                    ELCACCTV
  3911     05  WS-AM-VG-EXP-DATE-N REDEFINES                               CL**3
  3912            WS-AM-VG-EXP-DATE          PIC 9(11).                    CL**4
  3913     05  WS-AM-EFFECT-DT.                                         ELCACCTV
  3914         10  FILLER                    PIC 999.                   ELCACCTV
  3915         10  AM-EFF-CCYY               PIC 9(04).                 ELCACCTV
  3916         10  AM-EFF-CCYR  REDEFINES  AM-EFF-CCYY.                 ELCACCTV
  3917             15  AM-EFF-CC             PIC 99.                    ELCACCTV
  3918             15  AM-EFF-YR             PIC 99.                    ELCACCTV
  3919         10  AM-EFF-MO                 PIC 99.                    ELCACCTV
  3920         10  AM-EFF-DA                 PIC 99.                    ELCACCTV
  3921     05  WS-AM-EFFECT-DT-N REDEFINES                                 CL**3
  3922            WS-AM-EFFECT-DT            PIC 9(11).                    CL**4
  3923     05  WS-AM-PREV-EXP-DT.                                       ELCACCTV
  3924         10 FILLER                     PIC 999.                   ELCACCTV
  3925         10 AM-PREV-EXP-DT-CCYY        PIC 9(04).                 ELCACCTV
  3926         10 AM-PREV-EXP-DT-CCYR  REDEFINES  AM-PREV-EXP-DT-CCYY.  ELCACCTV
  3927            15 AM-PREV-EXP-DT-CC       PIC 99.                    ELCACCTV
  3928            15 AM-PREV-EXP-DT-YR       PIC 99.                    ELCACCTV
  3929         10 AM-PREV-EXP-MO             PIC 99.                    ELCACCTV
  3930         10 AM-PREV-EXP-DA             PIC 99.                    ELCACCTV
  3931     05  WS-AM-PREV-EXP-DT-N REDEFINES                               CL**3
  3932            WS-AM-PREV-EXP-DT          PIC 9(11).                    CL**3
  3933     05  WS-AM-PREV-EFF-DT.                                       ELCACCTV
  3934         10 FILLER                     PIC 999.                   ELCACCTV
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  88
* ECS150.cbl (/apps/prod/cid1p/copy/ELCACCTV)
  3935         10 AM-PREV-EFF-CCYY           PIC 9(04).                 ELCACCTV
  3936         10 AM-PREV-EFF-CCYR  REDEFINES  AM-PREV-EFF-CCYY.        ELCACCTV
  3937            15 AM-PREV-EFF-CC          PIC 99.                    ELCACCTV
  3938            15 AM-PREV-EFF-YR          PIC 99.                    ELCACCTV
  3939         10 AM-PREV-EFF-MO             PIC 99.                    ELCACCTV
  3940         10 AM-PREV-EFF-DA             PIC 99.                    ELCACCTV
  3941     05  WS-AM-PREV-EFF-DT-N REDEFINES                               CL**3
  3942            WS-AM-PREV-EFF-DT          PIC 9(11).                    CL**3
  3943     05  WS-AM-ANNIVERSARY-DATE.                                  ELCACCTV
  3944         10  FILLER                    PIC 999.                   ELCACCTV
  3945         10  AM-AN-CCYY                PIC 9(04).                 ELCACCTV
  3946         10  AM-AN-CCYR  REDEFINES  AM-AN-CCYY.                   ELCACCTV
  3947             15  AM-AN-CC              PIC 99.                    ELCACCTV
  3948             15  AM-AN-YR              PIC 99.                    ELCACCTV
  3949         10  AM-AN-MO                  PIC 99.                    ELCACCTV
  3950         10  AM-AN-DA                  PIC 99.                    ELCACCTV
  3951     05  WS-AM-ANNIVERSARY-DATE-N REDEFINES                          CL**3
  3952            WS-AM-ANNIVERSARY-DATE     PIC 9(11).                    CL**4
  3953     05  WS-AM-HI-CERT-DATE.                                      ELCACCTV
  3954         10  FILLER                    PIC 999.                   ELCACCTV
  3955         10  AM-HI-CCYY                PIC 9(04).                 ELCACCTV
  3956         10  AM-HI-CCYR  REDEFINES  AM-HI-CCYY.                   ELCACCTV
  3957             15  AM-HI-CC              PIC 99.                    ELCACCTV
  3958             15  AM-HI-YR              PIC 99.                    ELCACCTV
  3959         10  AM-HI-MO                  PIC 99.                    ELCACCTV
  3960         10  AM-HI-DA                  PIC 99.                    ELCACCTV
  3961     05  WS-AM-HI-CERT-DATE-N REDEFINES                              CL**3
  3962            WS-AM-HI-CERT-DATE         PIC 9(11).                    CL**3
  3963     05  WS-AM-LO-CERT-DATE.                                      ELCACCTV
  3964         10  FILLER                    PIC 999.                   ELCACCTV
  3965         10  AM-LO-CCYY                PIC 9(04).                 ELCACCTV
  3966         10  AM-LO-CCYR  REDEFINES  AM-LO-CCYY.                   ELCACCTV
  3967             15  AM-LO-CC              PIC 99.                    ELCACCTV
  3968             15  AM-LO-YR              PIC 99.                    ELCACCTV
  3969         10  AM-LO-MO                  PIC 99.                    ELCACCTV
  3970         10  AM-LO-DA                  PIC 99.                    ELCACCTV
  3971     05  WS-AM-LO-CERT-DATE-N REDEFINES                              CL**3
  3972            WS-AM-LO-CERT-DATE         PIC 9(11).                    CL**3
  3973     05  WS-AM-ENTRY-DATE.                                        ELCACCTV
  3974         10  FILLER                    PIC 999.                   ELCACCTV
  3975         10  AM-ENT-CCYY               PIC 9(04).                 ELCACCTV
  3976         10  AM-ENT-CCYR  REDEFINES  AM-ENT-CCYY.                 ELCACCTV
  3977             15  AM-ENT-CC             PIC 99.                    ELCACCTV
  3978             15  AM-ENT-YR             PIC 99.                    ELCACCTV
  3979         10  AM-ENT-MO                 PIC 99.                    ELCACCTV
  3980         10  AM-ENT-DA                 PIC 99.                    ELCACCTV
  3981     05  WS-AM-ENTRY-DATE-N REDEFINES                                CL**3
  3982            WS-AM-ENTRY-DATE           PIC 9(11).                    CL**3
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  89
* ECS150.cbl
* 3984                             COPY ELCREINV.
  3985******************************************************************04/18/98
  3986*                                                                *ELCREINV
  3987*                                                                *ELCREINV
  3988*                            ELCREINV                            *   LV003
  3989*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  3990*                            VMOD=2.001                          *ELCREINV
  3991*                                                                *ELCREINV
  3992*   WORKING STORAGE FOR DATE VARIABLES CREATED                   *ELCREINV
  3993*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCREINV
  3994*                                                                *ELCREINV
  3995******************************************************************ELCREINV
  3996                                                                  ELCREINV
  3997 01  WS-REINSURANCE-RECORD-DATE.                                  ELCREINV
  3998     05  WS-RE-LO-DATE.                                              CL**3
  3999         10 FILLER                     PIC 999.                      CL**3
  4000         10 RE-LO-CCYY                 PIC 9(04).                    CL**3
  4001         10 RE-LO-CCYR  REDEFINES  RE-LO-CCYY.                       CL**3
  4002            15 RE-LO-CC                PIC 99.                       CL**3
  4003            15 RE-LO-YR                PIC 99.                       CL**3
  4004         10 RE-LO-MO                   PIC 99.                       CL**3
  4005         10 RE-LO-DA                   PIC 99.                       CL**3
  4006     05  WS-RE-LO-DATE-N REDEFINES                                   CL**3
  4007            WS-RE-LO-DATE              PIC 9(11).                    CL**3
  4008     05  WS-RE-HI-DATE.                                              CL**3
  4009         10 FILLER                     PIC 999.                      CL**3
  4010         10 RE-HI-CCYY                 PIC 9(04).                    CL**3
  4011         10 RE-HI-CCYR  REDEFINES  RE-HI-CCYY.                       CL**3
  4012            15 RE-HI-CC                PIC 99.                       CL**3
  4013            15 RE-HI-YR                PIC 99.                       CL**3
  4014         10 RE-HI-MO                   PIC 99.                       CL**3
  4015         10 RE-HI-DA                   PIC 99.                       CL**3
  4016     05  WS-RE-HI-DATE-N REDEFINES                                   CL**3
  4017            WS-RE-HI-DATE              PIC 9(11).                    CL**3
  4018     05  WS-RE-CLM-INCURRED-LIM.                                  ELCREINV
  4019         10 FILLER                     PIC 999.                   ELCREINV
  4020         10 RE-CLM-CCYY                PIC 9(04).                 ELCREINV
  4021         10 RE-CLM-CCYR  REDEFINES  RE-CLM-CCYY.                  ELCREINV
  4022            15 RE-CLM-CC               PIC 99.                    ELCREINV
  4023            15 RE-CLM-YR               PIC 99.                    ELCREINV
  4024         10 RE-CLM-MO                  PIC 99.                    ELCREINV
  4025         10 RE-CLM-DA                  PIC 99.                    ELCREINV
  4026     05  WS-RE-CLM-INCURRED-LIM-N REDEFINES                          CL**2
  4027            WS-RE-CLM-INCURRED-LIM     PIC 9(11).                    CL**2
  4028     05  WS-RE-EARNING-START-DT.                                  ELCREINV
  4029         10  FILLER                    PIC 999.                   ELCREINV
  4030         10  RE-EARN-CCYY              PIC 9(04).                 ELCREINV
  4031         10  RE-EARN-CCYR  REDEFINES  RE-EARN-CCYY.               ELCREINV
  4032             15  RE-EARN-CC            PIC 99.                    ELCREINV
  4033             15  RE-EARN-YR            PIC 99.                    ELCREINV
  4034         10  RE-EARN-MO                PIC 99.                    ELCREINV
  4035         10  RE-EARN-DA                PIC 99.                    ELCREINV
  4036     05  WS-RE-EARNING-START-DT-N REDEFINES                          CL**2
  4037            WS-RE-EARNING-START-DT     PIC 9(11).                    CL**2
  4038     05  WS-RE-EARNING-STOP-DT.                                   ELCREINV
  4039         10  FILLER                    PIC 999.                   ELCREINV
  4040         10  RE-EARN-STOP-CCYY         PIC 9(04).                 ELCREINV
  4041         10  RE-EARN-STOP-CCYR  REDEFINES  RE-EARN-STOP-CCYY.     ELCREINV
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  90
* ECS150.cbl (/apps/prod/cid1p/copy/ELCREINV)
  4042             15  RE-EARN-STOP-CC       PIC 99.                    ELCREINV
  4043             15  RE-EARN-STOP-YR       PIC 99.                    ELCREINV
  4044         10  RE-EARN-STOP-MO           PIC 99.                    ELCREINV
  4045         10  RE-EARN-STOP-DA           PIC 99.                    ELCREINV
  4046     05  WS-RE-EARNING-STOP-DT-N REDEFINES                           CL**2
  4047            WS-RE-EARNING-STOP-DT      PIC 9(11).                    CL**2
  4048 LINKAGE SECTION.
  4049
  4050 01 PARM.
  4051    05  PARM-LENGTH          COMP     PIC S9(04)  VALUE ZEROS.
  4052    05  PARM-RPT-OVERRIDE             PIC XXX     VALUE SPACES.
  4053
  4054 PROCEDURE DIVISION USING PARM.
  4055******************************************************************
  4056*                                                                *
  4057*                *** SECTION DESCRIPTIONS ***                    *
  4058*  * SECTION NO. *                                               *
  4059*                                                                *
  4060*      1000      CLAS DATE LOAD, DATE EDITS, WORK AREA INIT      *
  4061*                                                                *
  4062*      2000      PERFORM LOOP FOR EXTRACT-A                      *
  4063*                                                                *
  4064*      3000      PERFORM LOOP FOR EXTRACT-B                      *
  4065*                                                                *
  4066*      4000      COMPUTATIONS FOR-RESERVES, CLAIMS, ISSUES,      *
  4067*                                 CANCELS, INCREASES/DECREASES   *
  4068*                                                                *
  4069*      5000      PRINT ROUTINES                                  *
  4070*                                                                *
  4071*      6000      REINSURANCE CALCULATIONS                        *
  4072*                                                                *
  4073*      7000      LEVEL BREAK PROCESSING                          *
  4074*                                                                *
  4075*      8000      MISCELANEOUS ROUTINES                           *
  4076*                                                                *
  4077*      9990      PROGRAM EXIT                                    *
  4078******************************************************************
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  91
* ECS150.cbl
  4080 0100-ININITIALIZATION       SECTION 49.
  4081
  4082 0110-CLAS-DATA-LOAD.
* 4083                             COPY ELCDTERX.
  4084******************************************************************04/15/98
  4085*                                                                *ELCDTERX
  4086*                                                                *ELCDTERX
  4087*                            ELCDTERX.                           *   LV002
  4088*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  4089*                            VMOD=2.007                          *ELCDTERX
  4090*                                                                *ELCDTERX
  4091*      LOAD DATE CARD DISK FILE INTO WORKING STORAGE AREA        *ELCDTERX
  4092*      (COPY CODE FOR W/S = ELCDTECX AND COPY CODE FOR FD        *ELCDTERX
  4093*      = ELCDTEFD)                                               *ELCDTERX
  4094*                                                                *ELCDTERX
  4095******************************************************************ELCDTERX
  4096                                                                  ELCDTERX
  4097     ACCEPT WS-ACCEPT-DATE       FROM  DATE.                      ELCDTERX
  4098                                                                  ELCDTERX
  4099     MOVE WS-AD-YY               TO  WS-CD-YY.                    ELCDTERX
  4100     MOVE WS-AD-MM               TO  WS-CD-MM.                    ELCDTERX
  4101     MOVE WS-AD-DD               TO  WS-CD-DD.                    ELCDTERX
  4102                                                                  ELCDTERX
  4103     ACCEPT WS-TIME-OF-DAY       FROM  TIME.                      ELCDTERX
  4104                                                                  ELCDTERX
  4105******************************************************************ELCDTERX
  4106*    NOTE: THE FOLLOWING STATEMENT IS USED TO ELIMINATE COB II    ELCDTERX
  4107*          WARNING MESSAGES.                                      ELCDTERX
  4108******************************************************************ELCDTERX
  4109     IF WS-CD-YY = LOW-VALUES                                     ELCDTERX
  4110         COMPUTE PGM-SUB = PGM-SUB + 1.                           ELCDTERX
  4111                                                                  ELCDTERX
  4112     OPEN INPUT DISK-DATE.                                        ELCDTERX
  4113                                                                  ELCDTERX
  4114     MOVE SPACE TO DATE-CARD         CLAS-BUSINESS-CLASSES        ELCDTERX
  4115                   STATE-NAMES       CLAS-MORTALITY-CODES         ELCDTERX
  4116                   CLAS-INS-TYPES    COMPANY-NAME-TABLE           ELCDTERX
  4117                   DATE-CARD-OPTIONS DATE-CARD-FACTORS            ELCDTERX
  4118                   CLAX-ID           CLAS-MISC                    ELCDTERX
  4119                   CARRIER-NAMES     CLASIC-SYSTEM-CODES          ELCDTERX
  4120                   CARRIER-OPT-CLAIM-DATA                         ELCDTERX
  4121                   STATE-TARGET-LOSS-RATIOS                       ELCDTERX
  4122                   BUSINESS-TRGT-LOSS-RATIO-MODS                  ELCDTERX
  4123                   MISC-OPT-CLM-RSV-DATA.                         ELCDTERX
  4124                                                                  ELCDTERX
  4125     MOVE LOW-VALUES TO CLAS-INDEX-TBL CLAS-TYPE-MISC.            ELCDTERX
  4126                                                                  ELCDTERX
  4127     MOVE ZERO TO CLAS-CN DTE-TOT-LINES CLAS-CO                   ELCDTERX
  4128                  INDEXCA INDEXBS INDEXST.                        ELCDTERX
  4129                                                                  ELCDTERX
  4130     COMPUTE CLAS-CN = PGM-SUB / +50.                             ELCDTERX
  4131     COMPUTE CLAS-CO = PGM-SUB / +20.                             ELCDTERX
  4132     COMPUTE CLAS-INDEXEN = PGM-SUB - (CLAS-CN * +50).            ELCDTERX
  4133     COMPUTE CLAS-INDEXON = PGM-SUB - (CLAS-CO * +20).            ELCDTERX
  4134                                                                  ELCDTERX
  4135     IF CLAS-INDEXEN = ZERO                                       ELCDTERX
  4136         MOVE +50               TO CLAS-INDEXEN                   ELCDTERX
  4137     ELSE                                                         ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  92
* ECS150.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  4138         ADD +1                 TO CLAS-CN.                       ELCDTERX
  4139                                                                  ELCDTERX
  4140     IF CLAS-INDEXON = ZERO                                       ELCDTERX
  4141         MOVE +20               TO CLAS-INDEXON                   ELCDTERX
  4142     ELSE                                                         ELCDTERX
  4143         ADD +1                 TO CLAS-CO.                       ELCDTERX
  4144                                                                  ELCDTERX
  4145 0005-READ--CARD.                                                 ELCDTERX
  4146     READ DISK-DATE                                               ELCDTERX
  4147         AT END CLOSE DISK-DATE                                   ELCDTERX
  4148             GO TO 0060-READ--TEST.                               ELCDTERX
  4149                                                                  ELCDTERX
  4150     MOVE ZERO                   TO CLAS-INDEX.                   ELCDTERX
  4151                                                                  ELCDTERX
  4152     IF DD-ID = 'CLAS' OR 'LIFE' OR 'GLED'                        ELCDTERX
  4153         MOVE DATE-DISK          TO DATE-CARD                     ELCDTERX
  4154         MOVE RUN-DATE           TO WS-RUN-DATE-N                    CL**2
  4155         MOVE EP-DT              TO WS-EP-DT-N                       CL**2
  4156         GO TO 0005-READ--CARD.                                   ELCDTERX
  4157                                                                  ELCDTERX
  4158     IF DD-ID = 'CLAD'                                            ELCDTERX
  4159         MOVE DATE-DISK          TO DATE-CARD-OPTIONS             ELCDTERX
  4160         GO TO 0005-READ--CARD.                                   ELCDTERX
  4161                                                                  ELCDTERX
  4162     IF DD-ID = 'CLAX'                                            ELCDTERX
  4163         MOVE DATE-DISK          TO CLAS-INDEX-TBL                ELCDTERX
  4164         GO TO 0005-READ--CARD.                                   ELCDTERX
  4165                                                                  ELCDTERX
  4166     IF DD-ID = 'CLAF'                                            ELCDTERX
  4167         MOVE DATE-DISK          TO DATE-CARD-FACTORS             ELCDTERX
  4168         GO TO 0005-READ--CARD.                                   ELCDTERX
  4169                                                                  ELCDTERX
  4170     IF DD-ID = 'CLAC'                                            ELCDTERX
  4171         GO TO 0010-READ--CLAC.                                   ELCDTERX
  4172                                                                  ELCDTERX
  4173     IF DD-ID = 'CARR'                                            ELCDTERX
  4174         GO TO 0015-READ--CARR.                                   ELCDTERX
  4175                                                                  ELCDTERX
  4176     IF DD-ID = 'STAT'                                            ELCDTERX
  4177         GO TO 0020-READ--STAT.                                   ELCDTERX
  4178                                                                  ELCDTERX
  4179     IF DD-ID = 'BUSC'                                            ELCDTERX
  4180         GO TO 0025-READ--BUSC.                                   ELCDTERX
  4181                                                                  ELCDTERX
  4182     IF DD-ID = 'MORT'                                            ELCDTERX
  4183         GO TO 0030-READ--MORT.                                   ELCDTERX
  4184                                                                  ELCDTERX
  4185     IF DD-ID = 'CLAI'                                            ELCDTERX
  4186         GO TO 0040-READ--CLAI.                                   ELCDTERX
  4187                                                                  ELCDTERX
  4188     IF DD-ID = 'COLC'                                            ELCDTERX
  4189         GO TO 0065-READ--COLC.                                   ELCDTERX
  4190                                                                  ELCDTERX
  4191     IF DD-IDX NUMERIC AND                                        ELCDTERX
  4192        DD-IDA = 'CL'                                             ELCDTERX
  4193         GO TO 0035-READ--CLXX.                                   ELCDTERX
  4194                                                                  ELCDTERX
  4195     IF DD-IDX NUMERIC AND                                        ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  93
* ECS150.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  4196        DD-IDA = 'PO'                                             ELCDTERX
  4197         GO TO 0050-READ--POXX.                                   ELCDTERX
  4198                                                                  ELCDTERX
  4199     IF DD-ID = 'OPCA'                                            ELCDTERX
  4200         GO TO 0070-READ--OPCA.                                   ELCDTERX
  4201                                                                  ELCDTERX
  4202     IF DD-ID = 'OPST'                                            ELCDTERX
  4203         GO TO 0072-READ--OPST.                                   ELCDTERX
  4204                                                                  ELCDTERX
  4205     IF DD-ID = 'OPBS'                                            ELCDTERX
  4206         GO TO 0074-READ--OPBS.                                   ELCDTERX
  4207                                                                  ELCDTERX
  4208     IF DD-ID = 'OPMS'                                            ELCDTERX
  4209         MOVE DD-MISC-DATA       TO MISC-OPT-CLM-RSV-DATA.        ELCDTERX
  4210                                                                  ELCDTERX
  4211     GO TO 0005-READ--CARD.                                       ELCDTERX
  4212                                                                  ELCDTERX
  4213 0010-READ--CLAC.                                                 ELCDTERX
  4214     ADD 1                       TO CLAS-INDEXC.                  ELCDTERX
  4215     MOVE DD-CR1                 TO CNT-ID (CLAS-INDEXC).         ELCDTERX
  4216     MOVE DD-CR1N                TO CNT-NAME (CLAS-INDEXC).       ELCDTERX
  4217     ADD 1                       TO CLAS-INDEXC.                  ELCDTERX
  4218     MOVE DD-CR2                 TO CNT-ID (CLAS-INDEXC).         ELCDTERX
  4219     MOVE DD-CR2N                TO CNT-NAME (CLAS-INDEXC).       ELCDTERX
  4220     GO TO 0005-READ--CARD.                                       ELCDTERX
  4221                                                                  ELCDTERX
  4222 0015-READ--CARR.                                                 ELCDTERX
  4223     ADD 1  TO  CLAS-INDEXCN.                                     ELCDTERX
  4224     IF CLAS-INDEXCN LESS THAN +26                                ELCDTERX
  4225        MOVE DD-CARR1         TO CARRIER-SUB (CLAS-INDEXCN)
  4226        MOVE DD-CARR1S        TO CARRIER-DOM-ST (CLAS-INDEXCN)
  4227        MOVE DD-CARR1N        TO CARRIER-PIC (CLAS-INDEXCN)
  4228        MOVE DD-CARR1-UEP-PCT TO CARRIER-UEP-PCT (CLAS-INDEXCN)
  4229        MOVE DD-CARR1-R78-PCT TO CARRIER-R78-PCT (CLAS-INDEXCN)
  4230        MOVE DD-CARR1-PRO-PCT TO CARRIER-PRO-PCT (CLAS-INDEXCN)
  4231        MOVE DD-CARR1-SECPAY-SW
  4232                               TO CARRIER-SEC-PAY (CLAS-INDEXCN)
  4233     END-IF
  4234                                                                  ELCDTERX
  4235     ADD 1  TO  CLAS-INDEXCN.                                     ELCDTERX
  4236     IF CLAS-INDEXCN LESS THAN +26                                ELCDTERX
  4237        MOVE DD-CARR2         TO CARRIER-SUB (CLAS-INDEXCN)
  4238        MOVE DD-CARR2S        TO CARRIER-DOM-ST (CLAS-INDEXCN)
  4239        MOVE DD-CARR2N        TO CARRIER-PIC (CLAS-INDEXCN)
  4240        MOVE DD-CARR2-UEP-PCT TO CARRIER-UEP-PCT (CLAS-INDEXCN)
  4241        MOVE DD-CARR2-R78-PCT TO CARRIER-R78-PCT (CLAS-INDEXCN)
  4242        MOVE DD-CARR2-PRO-PCT TO CARRIER-PRO-PCT (CLAS-INDEXCN)
  4243        MOVE DD-CARR2-SECPAY-SW
  4244                              TO CARRIER-SEC-PAY (CLAS-INDEXCN)
  4245     END-IF
  4246                                                                  ELCDTERX
  4247                                                                  ELCDTERX
  4248     GO TO 0005-READ--CARD.                                       ELCDTERX
  4249                                                                  ELCDTERX
  4250 0020-READ--STAT.                                                 ELCDTERX
  4251     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  4252     IF CLAS-INDEX GREATER 3  OR                                  ELCDTERX
  4253        DD-ST (CLAS-INDEX) = SPACE                                ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  94
* ECS150.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  4254         GO TO 0005-READ--CARD.                                   ELCDTERX
  4255                                                                  ELCDTERX
  4256     ADD 1                       TO CLAS-INDEXS.                  ELCDTERX
  4257     MOVE DD-ST (CLAS-INDEX)     TO STATE-NAME-FLD (CLAS-INDEXS). ELCDTERX
  4258     GO TO 0020-READ--STAT.                                       ELCDTERX
  4259                                                                  ELCDTERX
  4260 0025-READ--BUSC.                                                 ELCDTERX
  4261     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  4262     IF CLAS-INDEX GREATER 3  OR                                  ELCDTERX
  4263        DD-ST (CLAS-INDEX) = SPACE                                ELCDTERX
  4264         GO TO 0005-READ--CARD.                                   ELCDTERX
  4265                                                                  ELCDTERX
  4266     ADD 1                       TO CLAS-INDEXB.                  ELCDTERX
  4267     MOVE DD-ST (CLAS-INDEX)     TO CLAS-BUSC-FLD (CLAS-INDEXB).  ELCDTERX
  4268     GO TO 0025-READ--BUSC.                                       ELCDTERX
  4269                                                                  ELCDTERX
  4270 0030-READ--MORT.                                                 ELCDTERX
  4271     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  4272     IF CLAS-INDEX GREATER 2  OR                                  ELCDTERX
  4273        DD-MORT (CLAS-INDEX) = SPACE                              ELCDTERX
  4274         GO TO 0005-READ--CARD.                                   ELCDTERX
  4275                                                                  ELCDTERX
  4276     ADD 1                       TO CLAS-INDEXM.                  ELCDTERX
  4277     MOVE DD-MORT (CLAS-INDEX)   TO CLAS-MORT-FLD (CLAS-INDEXM).  ELCDTERX
  4278     GO TO 0030-READ--MORT.                                       ELCDTERX
  4279                                                                  ELCDTERX
  4280 0035-READ--CLXX.                                                 ELCDTERX
  4281     IF DD-IDX NOT = CLAS-CN                                      ELCDTERX
  4282          GO TO 0005-READ--CARD.                                  ELCDTERX
  4283                                                                  ELCDTERX
  4284     IF DD-PS-PIC (CLAS-INDEXEN) = 'X'                            ELCDTERX
  4285         DISPLAY '***********************************************'ELCDTERX
  4286         DISPLAY 'PROGRAM ECS-', PGM-SUB, ' NOT SCHEDULED TO RUN' ELCDTERX
  4287         DISPLAY '***********************************************'ELCDTERX
  4288         GO TO 0055-READ--STOP.                                   ELCDTERX
  4289                                                                  ELCDTERX
  4290     IF DD-PS-PIC (CLAS-INDEXEN) NOT LESS 'A'  AND                ELCDTERX
  4291        DD-PS-PIC (CLAS-INDEXEN) NOT GREATER 'I'                  ELCDTERX
  4292         MOVE '1'                TO DTE-FICH.                     ELCDTERX
  4293                                                                  ELCDTERX
  4294     IF DD-PS-PIC (CLAS-INDEXEN) NOT LESS 'J'  AND                ELCDTERX
  4295        DD-PS-PIC (CLAS-INDEXEN) NOT GREATER 'R'                  ELCDTERX
  4296         MOVE '2'                TO DTE-FICH.                     ELCDTERX
  4297                                                                  ELCDTERX
  4298*    MOVE DD-PS-PIC (CLAS-INDEXEN) TO DTE-PGM-OPT.                ELCDTERX
  4299     GO TO 0005-READ--CARD.                                       ELCDTERX
  4300                                                                  ELCDTERX
  4301 0040-READ--CLAI.                                                 ELCDTERX
  4302     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  4303     IF CLAS-INDEX GREATER 2  OR                                  ELCDTERX
  4304        DD-TYPE (CLAS-INDEX) = SPACE                              ELCDTERX
  4305         GO TO 0005-READ--CARD.                                   ELCDTERX
  4306                                                                  ELCDTERX
  4307     ADD 1                       TO CLAS-INDEXA.                  ELCDTERX
  4308     MOVE DD-TYPE (CLAS-INDEX) TO CLAS-ALL-TYPES (CLAS-INDEXA).   ELCDTERX
  4309     GO TO 0040-READ--CLAI.                                       ELCDTERX
  4310                                                                  ELCDTERX
  4311 0045-READ--DUMP.                                                 ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  95
* ECS150.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  4312     MOVE +999 TO WS-RETURN-CODE                                  ELCDTERX
  4313     MOVE 'MISSING AND/OR INVALID CLAS DATE CARD'                 ELCDTERX
  4314                                 TO  WS-ABEND-MESSAGE             ELCDTERX
  4315     PERFORM ABEND-PGM.                                           ELCDTERX
  4316                                                                  ELCDTERX
  4317 0050-READ--POXX.                                                 ELCDTERX
  4318     IF DD-IDX NOT = CLAS-CO                                      ELCDTERX
  4319         GO TO 0005-READ--CARD.                                   ELCDTERX
  4320                                                                  ELCDTERX
  4321     IF DD-PS-PRC (CLAS-INDEXON) = 'X'                            ELCDTERX
  4322         DISPLAY '***********************************************'ELCDTERX
  4323         DISPLAY 'ECS - ', PGM-SUB, ' IS NOT SCHEDULED TO RUN'    ELCDTERX
  4324         DISPLAY '***********************************************'ELCDTERX
  4325         GO TO 0055-READ--STOP.                                   ELCDTERX
  4326                                                                  ELCDTERX
  4327     MOVE DD-PS-PRT (CLAS-INDEXON) TO DTE-PRT-OPT.                ELCDTERX
  4328     MOVE DD-PS-FMT (CLAS-INDEXON) TO DTE-FMT-OPT.                ELCDTERX
  4329     MOVE DD-PS-PRC (CLAS-INDEXON) TO DTE-PRC-OPT DTE-PGM-OPT.    ELCDTERX
  4330     MOVE DD-PS-TOT (CLAS-INDEXON) TO DTE-TOT-OPT.                ELCDTERX
  4331                                                                  ELCDTERX
  4332     IF DTE-PRT-OPT = 'B'                                         ELCDTERX
  4333         MOVE '2'                  TO DTE-FICH.                   ELCDTERX
  4334     IF DTE-PRT-OPT = 'F'                                         ELCDTERX
  4335         MOVE '1'                  TO DTE-FICH.                   ELCDTERX
  4336                                                                  ELCDTERX
  4337     GO TO 0005-READ--CARD.                                       ELCDTERX
  4338                                                                  ELCDTERX
  4339 0055-READ--STOP.                                                 ELCDTERX
  4340     GOBACK.                                                      ELCDTERX
  4341                                                                  ELCDTERX
  4342 0060-READ--TEST.                                                 ELCDTERX
  4343     IF DATX-COD        = SPACE  OR                               ELCDTERX
  4344        CLAX-ID         = SPACE  OR                               ELCDTERX
  4345        DATE-OPTIONS-ID = SPACE                                   ELCDTERX
  4346         GO TO 0045-READ--DUMP.                                   ELCDTERX
  4347                                                                  ELCDTERX
  4348     MOVE LOW-VALUE TO CLAS-TYPE-MISC.                            ELCDTERX
  4349     GO TO 0079-READ--EXIT.                                       ELCDTERX
  4350                                                                  ELCDTERX
  4351 0065-READ--COLC.                                                 ELCDTERX
  4352     MOVE DATE-DISK              TO CLASIC-SYSTEM-CODES.          ELCDTERX
  4353     GO TO 0005-READ--CARD.                                       ELCDTERX
  4354                                                                  ELCDTERX
  4355 0070-READ--OPCA.                                                 ELCDTERX
  4356                                                                  ELCDTERX
  4357     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  4358                                                                  ELCDTERX
  4359     IF  CLAS-INDEX GREATER 13                                    ELCDTERX
  4360             OR                                                   ELCDTERX
  4361         DD-CARR-FLDS (CLAS-INDEX) = SPACE                        ELCDTERX
  4362         GO TO 0005-READ--CARD.                                   ELCDTERX
  4363                                                                  ELCDTERX
  4364     ADD 1                       TO INDEXCA.                      ELCDTERX
  4365     MOVE DD-CARR-FLDS (CLAS-INDEX)                               ELCDTERX
  4366                                 TO CARRIER-FLDS (INDEXCA).       ELCDTERX
  4367     GO TO 0070-READ--OPCA.                                       ELCDTERX
  4368                                                                  ELCDTERX
  4369 0072-READ--OPST.                                                 ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  96
* ECS150.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  4370                                                                  ELCDTERX
  4371     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  4372                                                                  ELCDTERX
  4373     IF  CLAS-INDEX GREATER 16                                    ELCDTERX
  4374             OR                                                   ELCDTERX
  4375         DD-TLR (CLAS-INDEX) = SPACE                              ELCDTERX
  4376         GO TO 0005-READ--CARD.                                   ELCDTERX
  4377                                                                  ELCDTERX
  4378     ADD 1                       TO INDEXST.                      ELCDTERX
  4379     MOVE DD-STATE-FLDS (CLAS-INDEX)                              ELCDTERX
  4380                                 TO STATE-TLR-FLD (INDEXST).      ELCDTERX
  4381     GO TO 0072-READ--OPST.                                       ELCDTERX
  4382                                                                  ELCDTERX
  4383 0074-READ--OPBS.                                                 ELCDTERX
  4384                                                                  ELCDTERX
  4385     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  4386                                                                  ELCDTERX
  4387     IF  CLAS-INDEX GREATER 32                                    ELCDTERX
  4388             OR                                                   ELCDTERX
  4389         DD-TLR (CLAS-INDEX) = SPACE                              ELCDTERX
  4390         GO TO 0005-READ--CARD.                                   ELCDTERX
  4391                                                                  ELCDTERX
  4392     ADD 1                       TO INDEXBS.                      ELCDTERX
  4393     MOVE DD-TLR (CLAS-INDEX)    TO BUS-TLRM-FLD (INDEXBS).       ELCDTERX
  4394     GO TO 0074-READ--OPBS.                                       ELCDTERX
  4395                                                                  ELCDTERX
  4396 0079-READ--EXIT.                                                 ELCDTERX
  4397*    EXIT.                                                        ELCDTERX
  4398******************************************************************ELCDTERX
  4399
  4400 0120-PERIOD-EDIT.
  4401**   MOVE 1 TO DTE-PGM-OPT.
  4402     IF EP-CCYY GREATER THAN RUN-CCYY OR
  4403        EP-MO GREATER THAN RUN-MO
  4404         GO TO 0130-CLEAR-WORK.
  4405
  4406     IF EP-DT = RUN-DATE
  4407         SUBTRACT +1 FROM RUN-CCYY
  4408         MOVE WS-RUN-DATE-N TO RUN-DATE
  4409         GO TO 0130-CLEAR-WORK.
  4410
  4411     DISPLAY 'PERIOD START IS AFTER PERIOD END-CHECK CLAS CARD'.
  4412     MOVE '0998'                 TO ABEND-CODE.
  4413     GO TO ABEND-PGM.
  4414
  4415 0130-CLEAR-WORK.
  4416     MOVE HIGH-VALUES            TO REIN-HOLD-AREAS.
  4417     MOVE SPACES                 TO REIN-LEVELS-END.
  4418     PERFORM 8100-CLEAR-TABLES THRU 8100-EXIT
  4419         VARYING CL FROM +1 BY +1
  4420             UNTIL CL GREATER THAN +5.
  4421
  4422 0140-OPEN-FILES.
  4423     OPEN INPUT ERACCTT  CERT-FILE
  4424          OUTPUT PRINT-FILE  CLAS150-A-EXTRACT.
  4425     MOVE LOW-VALUES             TO ACCOUNT-MASTER.
  4426
* 4427     COPY ELCACCTI.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  97
* ECS150.cbl (/apps/prod/cid1p/copy/ELCACCTI)
  4428******************************************************************04/14/98
  4429*                                                                *ELCACCTI
  4430*                            ELCACCTI                            *   LV003
  4431*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
  4432*                            VMOD=2.001                          *ELCACCTI
  4433*                                                                *ELCACCTI
  4434*   COPY FILE VARIABLES TO WORKING STORAGE                       *ELCACCTI
  4435*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCACCTI
  4436*                                                                *ELCACCTI
  4437*  NO  CID  MODS  IN  COPYBOOK  ELCACCTI                         *ELCACCTI
  4438*                                                                *ELCACCTI
  4439******************************************************************ELCACCTI
  4440     MOVE AM-EXPIRE-DT           TO  WS-AM-EXPIRE-DT-N.              CL**2
  4441     MOVE AM-VG-EXP-DATE         TO  WS-AM-VG-EXP-DATE-N.            CL**2
  4442     MOVE AM-EFFECT-DT           TO  WS-AM-EFFECT-DT-N.              CL**2
  4443     MOVE AM-PREV-EXP-DT         TO  WS-AM-PREV-EXP-DT-N.            CL**2
  4444     MOVE AM-PREV-EFF-DT         TO  WS-AM-PREV-EFF-DT-N             CL**2
  4445     MOVE AM-ANNIVERSARY-DATE    TO  WS-AM-ANNIVERSARY-DATE-N.       CL**2
  4446     MOVE AM-HI-CERT-DATE        TO  WS-AM-HI-CERT-DATE-N.           CL**2
  4447     MOVE AM-LO-CERT-DATE        TO  WS-AM-LO-CERT-DATE-N.           CL**2
  4448     MOVE AM-ENTRY-DATE          TO  WS-AM-ENTRY-DATE-N.             CL**2
  4449
  4450     IF ACCT-FILE-STATUS NOT = '00' AND '97'
  4451         MOVE ACCT-FILE-STATUS   TO WS-ABEND-FILE-STATUS
  4452         MOVE ' ERROR ACCOUNT MASTER OPEN '
  4453                                 TO WS-ABEND-MESSAGE
  4454         PERFORM ABEND-PGM.
  4455
  4456     MOVE 'R'                        TO  CP-RATE-FILE.
  4457     MOVE 'O'                        TO  CP-IO-FUNCTION.
  4458     PERFORM 8455-CALL-RATING-ROUTINE THRU 8499-EXIT.
  4459     IF IO-ERROR
  4460         MOVE 0302                   TO  WS-RETURN-CODE
  4461         MOVE 'ERROR OCCURED OPENING - ELRATE'
  4462                                     TO  WS-ABEND-MESSAGE
  4463         GO TO ABEND-PGM.
  4464
  4465 0150-SET-DATES.
  4466
  4467     MOVE RUN-DATE                   TO DC-GREG-DATE-CYMD.
  4468     MOVE 'L'                        TO DC-OPTION-CODE.
  4469     PERFORM 8500-DATE-CONVERT-ROUTINE THRU 8599-DATE-CONVERT-X.
  4470     MOVE DC-BIN-DATE-1              TO RUN-DATE-BIN PERIOD-START.
  4471
  4472     MOVE EP-DT                      TO DC-GREG-DATE-CYMD.
  4473     MOVE 'L'                        TO DC-OPTION-CODE.
  4474     PERFORM 8500-DATE-CONVERT-ROUTINE THRU 8599-DATE-CONVERT-X.
  4475     MOVE DC-BIN-DATE-1              TO PERIOD-END  EP-DT-BIN.
  4476
  4477     COMPUTE PERIOD-START-9 = (RUN-CCYY * 12) + RUN-MO.
  4478     COMPUTE PERIOD-END-9 = (EP-CCYY * 12) + EP-MO.
  4479
  4480
  4481
  4482     MOVE COMPANY-NAME           TO HL-CO-NAME.
  4483     MOVE WS-CURRENT-DATE        TO HL-DATE.
  4484     MOVE RUN-DATE               TO DATE-WORK.
  4485     MOVE CORRESPONDING RAW-DATE TO FORMAT-DATE.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  98
* ECS150.cbl
  4486     MOVE FORMAT-DATE            TO HL-PER-START.
  4487     MOVE EP-DT                  TO DATE-WORK.
  4488     MOVE CORRESPONDING RAW-DATE TO FORMAT-DATE.
  4489     MOVE FORMAT-DATE            TO HL-PER-END.
  4490
  4491    IF PARM-LENGTH = +3
  4492       move PARM-RPT-OVERRIDE    to ws-override-option
  4493       display ' Processing All Reinsurance Companies '
  4494    else
  4495       move spaces               to ws-override-option
  4496    end-if
  4497
  4498     .
  4499 1000-MAINLINE-CONTROL       SECTION 05.
  4500
  4501 1100-CREATE-EXTRACT-A.
  4502
  4503     PERFORM 2000-EXTRACT-A THRU 2000-EXIT
  4504         UNTIL CR-ACCT-CONTROL = HIGH-VALUES.
  4505     CLOSE ERACCTT CERT-FILE  CLAS150-A-EXTRACT.
  4506
  4507     IF REINS-FILE-OPEN
  4508         CLOSE REINS-EXTRACT-1.
  4509
  4510     IF REIN-OPEN-SW NOT = SPACE
  4511         MOVE SPACE              TO REIN-OPEN-SW
  4512         CLOSE ERRTBL-IN
  4513         IF ERRTBL-FILE-STATUS NOT = '00'
  4514             MOVE '22'           TO ABEND-FILE-ID
  4515             MOVE ERRTBL-FILE-STATUS
  4516                                 TO ABEND-REASON
  4517             GO TO ABEND-PGM.
  4518
  4519     IF NO-REINSURANCE
  4520         GO TO 9990-PROGRAM-END.
  4521
  4522 1200-CREATE-EXTRACT-BC.
  4523     SORT SORT-WORK  ASCENDING KEY SORT-KEY
  4524         USING REINS-EXTRACT-1
  4525             GIVING REINS-EXTRACT-2.
  4526 S1200-EXIT.
  4527     EXIT.
  4528
  4529 1200-CONTINUE.
  4530     OPEN INPUT  REINS-EXTRACT-2
  4531          OUTPUT CLAS150-B-EXTRACT  CLAS150-C-EXTRACT.
  4532     MOVE SPACES                 TO SAVE-CONTROL-BREAKS.
  4533     MOVE LOW-VALUES             TO CERTIFICATE-RECORD.
* 4534     COPY ELCCRTM1.
  4535******************************************************************04/15/98
  4536*                                                                *ELCCRTM1
  4537*                                                                *ELCCRTM1
  4538*                            ELCCRTM1                            *   LV003
  4539*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
  4540*                            VMOD=2.001                          *ELCCRTM1
  4541*                                                                *ELCCRTM1
  4542*   COPY FILE VARIABLES TO WORKING STORAGE                       *ELCCRTM1
  4543*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCCRTM1
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  99
* ECS150.cbl (/apps/prod/cid1p/copy/ELCCRTM1)
  4544*                                                                *ELCCRTM1
  4545******************************************************************ELCCRTM1
  4546     MOVE CR-DT                   TO  WS-CR-DT-N.                    CL**2
  4547     MOVE CR-LF-EXPIRE-DATE       TO  WS-CR-LF-EXPIRE-DATE-N.        CL**2
  4548     MOVE CR-AH-EXPIRE-DATE       TO  WS-CR-AH-EXPIRE-DATE-N.        CL**2
  4549     MOVE CR-ENTRY-DATE           TO  WS-CR-ENTRY-DATE-N.            CL**2
  4550     MOVE CR-LF-CANC-DT           TO  WS-CR-LF-CANC-DT-N.            CL**2
  4551     MOVE CR-LF-CANCEL-EXIT-DATE  TO  WS-CR-LF-CANCEL-EXIT-DATE-N.   CL**2
  4552     MOVE CR-LF-CLAIM-EXIT-DATE   TO  WS-CR-LF-CLAIM-EXIT-DATE-N.    CL**2
  4553     MOVE CR-AH-CANC-DT           TO  WS-CR-AH-CANC-DT-N.            CL**2
  4554     MOVE CR-AH-CANCEL-EXIT-DATE  TO                                 CL**2
  4555                                  WS-CR-AH-CANCEL-EXIT-DATE-N.       CL**2
  4556     MOVE CR-AH-SETTLEMENT-EXIT-DATE TO                           ELCCRTM1
  4557                                 WS-CR-AH-SETTLEMENT-EXIT-DATEN.     CL**2
  4558     MOVE CR-DTH-DT               TO  WS-CR-DTH-DT-N.                CL**2
  4559     MOVE CR-DTH-PAY-DT           TO  WS-CR-DTH-PAY-DT-N.            CL**2
  4560     MOVE CR-DIS-DT               TO  WS-CR-DIS-DT-N.                CL**2
  4561     MOVE CR-DIS-PAY-DT           TO  WS-CR-DIS-PAY-DT-N.            CL**2
  4562     MOVE CR-DIS-PTO-DT           TO  WS-CR-DIS-PTO-DT-N.            CL**2
  4563     PERFORM  VARYING COPY-NDX FROM 1 BY 1 UNTIL COPY-NDX > 5     ELCCRTM1
  4564           MOVE CR-DIS-INCUR-DT (COPY-NDX)   TO                   ELCCRTM1
  4565                                WS-CR-DIS-INCUR-DT-N (COPY-NDX)      CL**2
  4566     END-PERFORM.                                                 ELCCRTM1
  4567                                                                  ELCCRTM1
  4568     MOVE +1                     TO PASS-TYPE.
  4569     PERFORM 8100-CLEAR-TABLES THRU 8100-EXIT
  4570         VARYING CL FROM +1 BY +1
  4571             UNTIL CL GREATER +5.
  4572     PERFORM 3000-EXTRACT-BC THRU 3000-EXIT
  4573         UNTIL RC-CONTROL = HIGH-VALUES.
  4574     CLOSE CLAS150-B-EXTRACT  CLAS150-C-EXTRACT  REINS-EXTRACT-2.
  4575     GO TO 9990-PROGRAM-END.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 100
* ECS150.cbl
  4577
  4578 2000-EXTRACT-A          SECTION 10.
  4579 2100-READ-CERT-FILE.
  4580     READ CERT-FILE INTO CERTIFICATE-RECORD AT END
  4581         MOVE HIGH-VALUES        TO CR-ACCT-CONTROL.
  4582
* 4583     COPY ELCCRTM1.
  4584******************************************************************04/15/98
  4585*                                                                *ELCCRTM1
  4586*                                                                *ELCCRTM1
  4587*                            ELCCRTM1                            *   LV003
  4588*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
  4589*                            VMOD=2.001                          *ELCCRTM1
  4590*                                                                *ELCCRTM1
  4591*   COPY FILE VARIABLES TO WORKING STORAGE                       *ELCCRTM1
  4592*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCCRTM1
  4593*                                                                *ELCCRTM1
  4594******************************************************************ELCCRTM1
  4595     MOVE CR-DT                   TO  WS-CR-DT-N.                    CL**2
  4596     MOVE CR-LF-EXPIRE-DATE       TO  WS-CR-LF-EXPIRE-DATE-N.        CL**2
  4597     MOVE CR-AH-EXPIRE-DATE       TO  WS-CR-AH-EXPIRE-DATE-N.        CL**2
  4598     MOVE CR-ENTRY-DATE           TO  WS-CR-ENTRY-DATE-N.            CL**2
  4599     MOVE CR-LF-CANC-DT           TO  WS-CR-LF-CANC-DT-N.            CL**2
  4600     MOVE CR-LF-CANCEL-EXIT-DATE  TO  WS-CR-LF-CANCEL-EXIT-DATE-N.   CL**2
  4601     MOVE CR-LF-CLAIM-EXIT-DATE   TO  WS-CR-LF-CLAIM-EXIT-DATE-N.    CL**2
  4602     MOVE CR-AH-CANC-DT           TO  WS-CR-AH-CANC-DT-N.            CL**2
  4603     MOVE CR-AH-CANCEL-EXIT-DATE  TO                                 CL**2
  4604                                  WS-CR-AH-CANCEL-EXIT-DATE-N.       CL**2
  4605     MOVE CR-AH-SETTLEMENT-EXIT-DATE TO                           ELCCRTM1
  4606                                 WS-CR-AH-SETTLEMENT-EXIT-DATEN.     CL**2
  4607     MOVE CR-DTH-DT               TO  WS-CR-DTH-DT-N.                CL**2
  4608     MOVE CR-DTH-PAY-DT           TO  WS-CR-DTH-PAY-DT-N.            CL**2
  4609     MOVE CR-DIS-DT               TO  WS-CR-DIS-DT-N.                CL**2
  4610     MOVE CR-DIS-PAY-DT           TO  WS-CR-DIS-PAY-DT-N.            CL**2
  4611     MOVE CR-DIS-PTO-DT           TO  WS-CR-DIS-PTO-DT-N.            CL**2
  4612     PERFORM  VARYING COPY-NDX FROM 1 BY 1 UNTIL COPY-NDX > 5     ELCCRTM1
  4613           MOVE CR-DIS-INCUR-DT (COPY-NDX)   TO                   ELCCRTM1
  4614                                WS-CR-DIS-INCUR-DT-N (COPY-NDX)      CL**2
  4615     END-PERFORM.                                                 ELCCRTM1
  4616                                                                  ELCCRTM1
  4617
  4618     IF CR-AH-CANC-DT NOT = ZEROS
  4619        IF CR-AH-CANCEL-EXIT-DATE = ZEROS
  4620            MOVE CR-AH-CANC-DT TO CR-AH-CANCEL-EXIT-DATE
  4621                                  WS-CR-AH-CANCEL-EXIT-DATE.
  4622
  4623     IF CR-LF-CANC-DT NOT = ZEROS
  4624        IF CR-LF-CANCEL-EXIT-DATE = ZEROS
  4625            MOVE CR-LF-CANC-DT TO CR-LF-CANCEL-EXIT-DATE
  4626                                  WS-CR-LF-CANCEL-EXIT-DATE.
  4627
  4628     IF CR-ACCT-CONTROL = HIGH-VALUES
  4629         GO TO 2210-CONTINUE.
  4630
  4631     IF CR-POLICY-IS-DECLINED OR
  4632        CR-POLICY-IS-VOID
  4633            DISPLAY 'CERT BYPASSED - VOID OR DECLINED '
  4634                                                CR-FULL-CONTROL
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 101
* ECS150.cbl
  4635            GO TO 2100-READ-CERT-FILE.
  4636
  4637     IF (cr-carrier = '9')
  4638        and (cr-state = 'NE')
  4639        and (cr-account = '0000015860')
  4640        and (cr-cert-no = '1098173790 ')
  4641            DISPLAY 'CERT BYPASSED - the big one '
  4642                                                CR-FULL-CONTROL
  4643            GO TO 2100-READ-CERT-FILE.
  4644
  4645     IF CR-LFTYP NOT = '00'
  4646         IF CR-LF-TERM = 0
  4647             IF CR-AHTYP = '00'
  4648                 DISPLAY 'CERT BYPASSED DUE TO INVALID TERM '
  4649                                                 CR-FULL-CONTROL
  4650                 GO TO 2100-READ-CERT-FILE.
  4651
  4652     IF CR-AHTYP NOT EQUAL '00'
  4653         IF CR-AH-TERM = 0
  4654             IF CR-LFTYP = '00'
  4655                 DISPLAY 'CERT BYPASSED DUE TO INVALID TERM '
  4656                                                 CR-FULL-CONTROL
  4657                 GO TO 2100-READ-CERT-FILE.
  4658
  4659 2210-CONTINUE.
  4660
  4661     IF CR-LFTYP NOT EQUAL '00'
  4662         IF CR-LF-TERM = 0
  4663             DISPLAY 'INVALID TERM ON LIFE CVG ' CR-FULL-CONTROL
  4664             MOVE '00'             TO  CR-LFTYP.
  4665
  4666     IF CR-AHTYP NOT EQUAL '00'
  4667         IF CR-AH-TERM = 0
  4668             DISPLAY 'INVALID TERM ON AH CVG ' CR-FULL-CONTROL
  4669             MOVE '00'             TO  CR-AHTYP.
  4670
  4671     IF SAVE-CONTROL-BREAKS = SPACES
  4672         MOVE CR-CARRIER         TO LAST-CARRIER
  4673         MOVE CR-GROUPING        TO LAST-GROUPING
  4674         MOVE CR-STATE           TO LAST-STATE
  4675         MOVE CR-ACCOUNT         TO LAST-ACCOUNT.
  4676
  4677 2200-MATCH-ACCT-TO-CERT.
  4678
  4679     IF CR-ACCT-CONTROL EQUAL HIGH-VALUES
  4680         GO TO 2300-LEVEL-BREAK-CHECK.
  4681
  4682     IF AM-CONTROL-A LESS THAN CR-ACCT-CONTROL
  4683         PERFORM 2210-ACCT-MAST-READ THRU 2210-EXIT
  4684         GO TO 2200-MATCH-ACCT-TO-CERT.
  4685
  4686     IF AM-CONTROL-A GREATER THAN CR-ACCT-CONTROL
  4687         GO TO 2205-ACCT-CERT-MISMATCH.
  4688
  4689     IF CR-DT  NOT LESS THAN AM-EXPIRE-DT
  4690         PERFORM 2210-ACCT-MAST-READ THRU 2210-EXIT
  4691         GO TO 2200-MATCH-ACCT-TO-CERT.
  4692
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 102
* ECS150.cbl
  4693     IF CR-DT NOT LESS THAN AM-EFFECT-DT
  4694         GO TO 2300-LEVEL-BREAK-CHECK.
  4695
  4696 2205-ACCT-CERT-MISMATCH.
  4697     DISPLAY 'NO MATCHING ACCOUNT MASTER FOR CONTROL '
  4698              CR-ACCT-CONTROL.
  4699
  4700     IF DTE-CLIENT EQUAL 'FIA'
  4701                      OR 'CID' OR 'AHL'
  4702        GO TO 2100-READ-CERT-FILE
  4703     ELSE
  4704        MOVE '0302'              TO ABEND-CODE
  4705        GO TO ABEND-PGM.
  4706
  4707 2210-ACCT-MAST-READ.
  4708     READ ERACCTT AT END
  4709         MOVE HIGH-VALUES        TO ACCOUNT-MASTER.
  4710
* 4711     COPY ELCACCTI.
  4712******************************************************************04/14/98
  4713*                                                                *ELCACCTI
  4714*                            ELCACCTI                            *   LV003
  4715*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
  4716*                            VMOD=2.001                          *ELCACCTI
  4717*                                                                *ELCACCTI
  4718*   COPY FILE VARIABLES TO WORKING STORAGE                       *ELCACCTI
  4719*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCACCTI
  4720*                                                                *ELCACCTI
  4721*  NO  CID  MODS  IN  COPYBOOK  ELCACCTI                         *ELCACCTI
  4722*                                                                *ELCACCTI
  4723******************************************************************ELCACCTI
  4724     MOVE AM-EXPIRE-DT           TO  WS-AM-EXPIRE-DT-N.              CL**2
  4725     MOVE AM-VG-EXP-DATE         TO  WS-AM-VG-EXP-DATE-N.            CL**2
  4726     MOVE AM-EFFECT-DT           TO  WS-AM-EFFECT-DT-N.              CL**2
  4727     MOVE AM-PREV-EXP-DT         TO  WS-AM-PREV-EXP-DT-N.            CL**2
  4728     MOVE AM-PREV-EFF-DT         TO  WS-AM-PREV-EFF-DT-N             CL**2
  4729     MOVE AM-ANNIVERSARY-DATE    TO  WS-AM-ANNIVERSARY-DATE-N.       CL**2
  4730     MOVE AM-HI-CERT-DATE        TO  WS-AM-HI-CERT-DATE-N.           CL**2
  4731     MOVE AM-LO-CERT-DATE        TO  WS-AM-LO-CERT-DATE-N.           CL**2
  4732     MOVE AM-ENTRY-DATE          TO  WS-AM-ENTRY-DATE-N.             CL**2
  4733
  4734 2210-EXIT.
  4735     EXIT.
  4736
  4737 2300-LEVEL-BREAK-CHECK.
  4738
  4739     IF (LAST-CARRIER NOT = CR-CARRIER) OR
  4740        (LAST-GROUPING NOT = CR-GROUPING)
  4741         PERFORM 7400-STATE-BREAK THRU 7400-EXIT
  4742         PERFORM 7500-ACCOUNT-BREAK THRU 7500-EXIT
  4743         MOVE CR-ACCT-CONTROL   TO SAVE-CNTRL-GRP
  4744         GO TO 2400-VALIDATE-DATA.
  4745
  4746     IF LAST-STATE NOT EQUAL CR-STATE
  4747         PERFORM 7400-STATE-BREAK THRU 7400-EXIT
  4748         MOVE CR-ACCT-CONTROL    TO SAVE-CNTRL-GRP
  4749         GO TO 2400-VALIDATE-DATA.
  4750
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 103
* ECS150.cbl
  4751     IF LAST-ACCOUNT NOT EQUAL CR-ACCOUNT
  4752         PERFORM 7500-ACCOUNT-BREAK THRU 7500-EXIT
  4753         MOVE CR-ACCT-CONTROL    TO SAVE-CNTRL-GRP.
  4754
  4755 2400-VALIDATE-DATA.
  4756     IF SAVE-CNTRL-GRP = HIGH-VALUES
  4757         GO TO 2000-EXIT.
  4758
  4759*    IF AM-EARN-METHOD-A NOT EQUAL SPACES AND ZEROS
  4760*        MOVE AM-EARN-METHOD-A   TO AH-EARN-METHOD
  4761*    ELSE
  4762     MOVE SPACES                 TO AH-EARN-METHOD
  4763
  4764     IF CR-IND-GRP NOT = '1' AND '2'
  4765         MOVE AM-IG              TO CR-IND-GRP.
  4766     IF CR-LFAMT-ALT NOT NUMERIC
  4767         MOVE ZEROS              TO CR-LFAMT-ALT.
  4768     IF CR-LFPRM-ALT NOT NUMERIC
  4769         MOVE ZEROS              TO CR-LFPRM-ALT.
  4770     IF CR-LFPRM-CALC NOT NUMERIC
  4771         MOVE ZEROES             TO CR-LFPRM-CALC.
  4772     IF CR-AHPRM-CALC NOT NUMERIC
  4773         MOVE ZEROES             TO CR-AHPRM-CALC.
  4774     IF CR-LFRFND-CALC NOT NUMERIC
  4775         MOVE ZEROES             TO CR-LFRFND-CALC.
  4776     IF CR-AHRFND-CALC NOT NUMERIC
  4777         MOVE ZEROES             TO CR-AHRFND-CALC.
  4778     IF CR-APR NOT NUMERIC
  4779         MOVE ZEROS              TO CR-APR.
  4780     IF CR-AGE NOT NUMERIC
  4781         MOVE ZEROS              TO CR-AGE.
  4782     IF CR-LIVES NOT NUMERIC
  4783         MOVE ZERO               TO CR-LIVES.
  4784     IF CR-SUM-CAN-CNT-ITD NOT NUMERIC
  4785         MOVE ZERO               TO CR-SUM-CAN-CNT-ITD.
  4786     IF CR-SUM-CAN-CNT-YTD NOT NUMERIC
  4787         MOVE ZERO               TO CR-SUM-CAN-CNT-YTD.
  4788     IF CR-DTHEXP-YTD NOT NUMERIC
  4789         MOVE ZERO               TO CR-DTHEXP-YTD.
  4790     IF CR-DTHAMT-YTD NOT NUMERIC
  4791         MOVE ZERO               TO CR-DTHAMT-YTD.
  4792     IF CR-DISAMT-YTD NOT NUMERIC
  4793         MOVE ZERO               TO CR-DISAMT-YTD.
  4794     IF CR-DISEXP-YTD NOT NUMERIC
  4795         MOVE ZERO               TO CR-DISEXP-YTD.
  4796
  4797     ADD CR-DTHEXP-YTD           TO CR-DTHAMT-YTD.
  4798     ADD CR-DISEXP-YTD           TO CR-DISAMT-YTD.
  4799
  4800     MOVE CR-DIS-CC              TO CR-DIS-INC-CC (1).
  4801     MOVE CR-DIS-YR              TO CR-DIS-INC-YR (1).
  4802     MOVE CR-DIS-MO              TO CR-DIS-INC-MO (1).
  4803     MOVE CR-DIS-DA              TO CR-DIS-INC-DA (1).
  4804     MOVE WS-CR-DIS-INCUR-DT(1)  TO CR-DIS-INCUR-DT (1).
  4805     MOVE CR-DISAMT-YTD          TO CR-INCUR-DISAMT (1).
  4806
  4807     MOVE ZEROS                  TO CR-INCUR-DISEXP (1)
  4808                                    CR-DIS-INCUR-DT (2)
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 104
* ECS150.cbl
  4809                                    WS-CR-DIS-INCUR-DT(2)
  4810                                    CR-DIS-INCUR-DT (3)
  4811                                    WS-CR-DIS-INCUR-DT(3)
  4812                                    CR-DIS-INCUR-DT (4)
  4813                                    WS-CR-DIS-INCUR-DT(4)
  4814                                    CR-DIS-INCUR-DT (5)
  4815                                    WS-CR-DIS-INCUR-DT(5).
  4816
  4817 2500-CALC-1ST-INS.
  4818     MOVE 0                      TO RECORD-TYPE-SW.
  4819     PERFORM 4000-ACTIVITY-TOTALING THRU 4000-EXIT.
  4820
  4821 2600-CALC-REINSURANCE.
  4822     IF CR-REIN-TABLE = SPACES OR ZEROES
  4823         GO TO 2000-EXIT.
  4824
  4825     IF REINS-FILE-CLOSED
  4826         OPEN OUTPUT REINS-EXTRACT-1
  4827         MOVE 1                  TO REINS-FILE-SW.
  4828
  4829     PERFORM 6000-REINSURANCE-CALC THRU 6000-EXIT.
  4830     PERFORM 2700-REINS-EXTRACT THRU 2700-EXIT
  4831         VARYING SUB1 FROM +1 BY +1
  4832             UNTIL REIN-COMP (SUB1) = SPACES.
  4833     GO TO 2000-EXIT.
  4834
  4835 2700-REINS-EXTRACT.
  4836     IF REIN-LF-AH-FLGS (SUB1) = SPACES
  4837         GO TO 2700-EXIT.
  4838
  4839     IF REIN-REM-SW (SUB1) = 'Z'
  4840         GO TO 2700-EXIT.
  4841     perform varying sub3 from +1 by +1 until
  4842        (sub3 > +1500) or
  4843        (rein-comp (sub1) = rc2-rein-co (sub3))
  4844     end-perform
  4845     if sub3 > +1500
  4846        go to 2700-exit
  4847     else
  4848        if (rc2-ecs152-rpt (sub3) = 'Y')
  4849           or (process-all-rein-companies)
  4850           continue
  4851        else
  4852           go to 2700-exit
  4853        end-if
  4854     end-if
  4855
  4856     MOVE REIN-WORK-FLDS (SUB1)  TO RWF-FIELDS.
  4857     MOVE SAVE-REINS-CERT        TO RC-REC.
  4858     MOVE REIN-COMP (SUB1)       TO RC-COMP.
  4859     MOVE RC-AHTYP               TO CR-AHTYP.
  4860     MOVE RC-LFTYP               TO CR-LFTYP.
  4861     MOVE RC-PMT-FREQ            TO CR-PMT-FREQ.
  4862     MOVE RC-I-LIVES             TO CR-LIVES.
  4863     MOVE RC-C-LIVES-ITD         TO CR-SUM-CAN-CNT-ITD.
  4864     MOVE RC-C-LIVES-YTD         TO CR-SUM-CAN-CNT-YTD.
  4865     MOVE RC-AHRFND-YTD          TO CR-AHRFND-CALC.
  4866     MOVE RC-LFRFND-YTD          TO CR-LFRFND-CALC.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 105
* ECS150.cbl
  4867     MOVE RC-LF-EXPIRE-DT        TO CR-LF-EXPIRE-DATE
  4868                                    WS-CR-LF-EXPIRE-DATE-N.
  4869     MOVE RC-AH-EXPIRE-DT        TO CR-AH-EXPIRE-DATE
  4870                                    WS-CR-AH-EXPIRE-DATE-N.
  4871     MOVE ZEROES                 TO RC-LFAMT   CR-LFAMT
  4872                                    RC-LFPRM   CR-LFPRM
  4873                                    cr-lfprm-alt
  4874                                    RC-AHAMT   CR-AHAMT
  4875                                    RC-AHPRM   CR-AHPRM
  4876                                    RC-LFRFND  CR-LFRFND
  4877                                    RC-AHRFND  CR-AHRFND
  4878                                    RC-DTHAMT  CR-DTHAMT-YTD
  4879                                    RC-DISAMT  CR-DISAMT-YTD
  4880                                    RC-CEDE-FACT.
  4881
  4882     IF REIN-LF-FLG (SUB1) = 'X'
  4883         MOVE RWF-LFAMT          TO RC-LFAMT   CR-LFAMT
  4884         MOVE RWF-LFPRM          TO RC-LFPRM   CR-LFPRM
  4885         MOVE RWF-LFRFND         TO RC-LFRFND  CR-LFRFND
  4886         MOVE RWF-LFCLM          TO RC-DTHAMT  CR-DTHAMT-YTD
  4887         IF (CR-LFAMT = ZEROS)
  4888            AND (CR-LFPRM = ZEROS)
  4889            MOVE '00'            TO CR-LFTYP
  4890                                    RC-LFTYP
  4891         END-IF
  4892     ELSE
  4893         MOVE ZERO               TO RC-LFTYP  CR-LFTYP.
  4894
  4895     COMPUTE WS-TOTAL-FACE-AMT = RC-ORIG-LFAMT + RC-LFAMT-ALT.
  4896
  4897     IF (REIN-LF-FLG (SUB1) = 'X')  AND
  4898        (CLAS-I-EP (CLAS-INDEXL) = 'B')
  4899         COMPUTE RC-CEDE-FACT = CR-LFAMT / WS-TOTAL-FACE-AMT.
  4900
  4901     IF REIN-AH-FLG (SUB1) = 'X'
  4902         MOVE RWF-AHAMT          TO RC-AHAMT   CR-AHAMT
  4903         MOVE RWF-AHPRM          TO RC-AHPRM   CR-AHPRM
  4904         MOVE RWF-AHRFND         TO RC-AHRFND  CR-AHRFND
  4905         MOVE RWF-AHCLM          TO RC-DISAMT  CR-DISAMT-YTD
  4906         IF (CR-AHAMT = ZEROS)
  4907            AND (CR-AHPRM = ZEROS)
  4908            MOVE '00'            TO CR-AHTYP
  4909                                    RC-AHTYP
  4910         END-IF
  4911     ELSE
  4912         MOVE ZERO               TO RC-AHTYP  CR-AHTYP.
  4913
  4914     ADD +1 TO REINS-REC-CNT.
  4915     MOVE 1                      TO REINSURANCE-FOUND.
  4916     WRITE RC-REC-1 FROM RC-REC.
  4917     .
  4918 2710-EVALUATE-REINS.
  4919     MOVE 1                      TO RECORD-TYPE-SW.
  4920     PERFORM 4000-ACTIVITY-TOTALING THRU 4000-EXIT.
  4921
  4922 2700-EXIT.
  4923     EXIT.
  4924
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 106
* ECS150.cbl
  4925 2000-EXIT.
  4926     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 107
* ECS150.cbl
  4928 3000-EXTRACT-BC     SECTION 15.
  4929
  4930 3100-READ-REINS-EXTRACT.
  4931     READ REINS-EXTRACT-2 INTO RC-REC AT END
  4932         MOVE HIGH-VALUES TO RC-CONTROL
  4933         GO TO 2150-CONTROL-BREAKS.
  4934     MOVE SPACES                 TO CERTIFICATE-RECORD.
  4935     MOVE RC-CMCTL               TO CR-FULL-CONTROL.
  4936     MOVE RC-ENTRY-STATUS        TO CR-ENTRY-STATUS.
  4937     MOVE RC-LFTYP               TO CR-LFTYP.
  4938     MOVE RC-LF-TERM             TO CR-LF-TERM.
  4939     MOVE RC-LF-TERM-IN-DAYS     TO CR-LF-TERM-IN-DAYS.
  4940     MOVE RC-LF-CANCEL-STATUS    TO CR-LF-STATUS-AT-CANCEL.
  4941     MOVE RC-LF-CLAIM-STATUS     TO CR-LF-STATUS-AT-DEATH.
  4942     MOVE RC-LF-CURRENT-STATUS   TO CR-LF-CURRENT-STATUS.
  4943     MOVE RC-AHTYP               TO CR-AHTYP.
  4944     MOVE RC-AH-TERM             TO CR-AH-TERM.
  4945     MOVE RC-AH-CANCEL-STATUS    TO CR-AH-STATUS-AT-CANCEL.
  4946     MOVE RC-AH-CLAIM-STATUS     TO CR-AH-STATUS-AT-SETTLEMENT.
  4947     MOVE RC-AH-CURRENT-STATUS   TO CR-AH-CURRENT-STATUS.
  4948     MOVE RC-AHAMT               TO CR-AHAMT.
  4949     MOVE RC-LFAMT               TO CR-LFAMT.
  4950     MOVE RC-LFAMT-ALT           TO CR-LFAMT-ALT.
  4951     MOVE RC-LFPRM               TO CR-LFPRM.
  4952     MOVE RC-AHPRM               TO CR-AHPRM.
  4953     MOVE RC-LFRFND              TO CR-LFRFND.
  4954     MOVE RC-AHRFND              TO CR-AHRFND.
  4955     MOVE RC-DTHAMT              TO CR-DTHAMT-YTD.
  4956     MOVE RC-DISAMT              TO CR-DISAMT-YTD.
  4957     MOVE RC-IND-GRP             TO CR-IND-GRP.
  4958     MOVE RC-LF-CANCEL-STATUS    TO CR-LF-STATUS-AT-CANCEL.
  4959     MOVE RC-LF-CLAIM-STATUS     TO CR-LF-STATUS-AT-DEATH.
  4960     MOVE RC-AH-CANCEL-STATUS    TO CR-AH-STATUS-AT-CANCEL.
  4961     MOVE RC-AH-CLAIM-STATUS     TO CR-AH-STATUS-AT-SETTLEMENT.
  4962     MOVE RC-LF-CANC-DT          TO CR-LF-CANC-DT.
  4963     MOVE RC-AH-CANC-DT          TO CR-AH-CANC-DT.
  4964     MOVE RC-DIS-DT              TO CR-DIS-DT.
  4965     MOVE RC-ENT-DT              TO CR-ENTRY-DATE.
  4966     MOVE RC-LF-CANC-EXIT        TO CR-LF-CANCEL-EXIT-DATE.
  4967     MOVE RC-AH-CANC-EXIT        TO CR-AH-CANCEL-EXIT-DATE.
  4968     MOVE RC-LF-CLAIM-EXIT       TO CR-LF-CLAIM-EXIT-DATE.
  4969     MOVE RC-AH-CLAIM-EXIT       TO CR-AH-SETTLEMENT-EXIT-DATE.
  4970     MOVE RC-PMT-FREQ            TO CR-PMT-FREQ.
  4971     MOVE RC-APR                 TO CR-APR.
  4972     MOVE RC-LOAN-TERM           TO CR-LOAN-TERM.
  4973     MOVE RC-I-LIVES             TO CR-LIVES.
  4974     MOVE RC-C-LIVES-ITD         TO CR-SUM-CAN-CNT-ITD.
  4975     MOVE RC-C-LIVES-YTD         TO CR-SUM-CAN-CNT-YTD.
  4976     MOVE RC-AHRFND-YTD          TO CR-AHRFND-CALC.
  4977     MOVE RC-LFRFND-YTD          TO CR-LFRFND-CALC.
  4978     MOVE RC-LF-EXPIRE-DT        TO CR-LF-EXPIRE-DATE.
  4979     MOVE RC-AH-EXPIRE-DT        TO CR-AH-EXPIRE-DATE.
  4980     MOVE RC-LOAN-1ST-PMT-DT     TO CR-LOAN-1ST-PMT-DT.
  4981
* 4982     COPY ELCCRTM1.
  4983******************************************************************04/15/98
  4984*                                                                *ELCCRTM1
  4985*                                                                *ELCCRTM1
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 108
* ECS150.cbl (/apps/prod/cid1p/copy/ELCCRTM1)
  4986*                            ELCCRTM1                            *   LV003
  4987*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
  4988*                            VMOD=2.001                          *ELCCRTM1
  4989*                                                                *ELCCRTM1
  4990*   COPY FILE VARIABLES TO WORKING STORAGE                       *ELCCRTM1
  4991*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCCRTM1
  4992*                                                                *ELCCRTM1
  4993******************************************************************ELCCRTM1
  4994     MOVE CR-DT                   TO  WS-CR-DT-N.                    CL**2
  4995     MOVE CR-LF-EXPIRE-DATE       TO  WS-CR-LF-EXPIRE-DATE-N.        CL**2
  4996     MOVE CR-AH-EXPIRE-DATE       TO  WS-CR-AH-EXPIRE-DATE-N.        CL**2
  4997     MOVE CR-ENTRY-DATE           TO  WS-CR-ENTRY-DATE-N.            CL**2
  4998     MOVE CR-LF-CANC-DT           TO  WS-CR-LF-CANC-DT-N.            CL**2
  4999     MOVE CR-LF-CANCEL-EXIT-DATE  TO  WS-CR-LF-CANCEL-EXIT-DATE-N.   CL**2
  5000     MOVE CR-LF-CLAIM-EXIT-DATE   TO  WS-CR-LF-CLAIM-EXIT-DATE-N.    CL**2
  5001     MOVE CR-AH-CANC-DT           TO  WS-CR-AH-CANC-DT-N.            CL**2
  5002     MOVE CR-AH-CANCEL-EXIT-DATE  TO                                 CL**2
  5003                                  WS-CR-AH-CANCEL-EXIT-DATE-N.       CL**2
  5004     MOVE CR-AH-SETTLEMENT-EXIT-DATE TO                           ELCCRTM1
  5005                                 WS-CR-AH-SETTLEMENT-EXIT-DATEN.     CL**2
  5006     MOVE CR-DTH-DT               TO  WS-CR-DTH-DT-N.                CL**2
  5007     MOVE CR-DTH-PAY-DT           TO  WS-CR-DTH-PAY-DT-N.            CL**2
  5008     MOVE CR-DIS-DT               TO  WS-CR-DIS-DT-N.                CL**2
  5009     MOVE CR-DIS-PAY-DT           TO  WS-CR-DIS-PAY-DT-N.            CL**2
  5010     MOVE CR-DIS-PTO-DT           TO  WS-CR-DIS-PTO-DT-N.            CL**2
  5011     PERFORM  VARYING COPY-NDX FROM 1 BY 1 UNTIL COPY-NDX > 5     ELCCRTM1
  5012           MOVE CR-DIS-INCUR-DT (COPY-NDX)   TO                   ELCCRTM1
  5013                                WS-CR-DIS-INCUR-DT-N (COPY-NDX)      CL**2
  5014     END-PERFORM.                                                 ELCCRTM1
  5015                                                                  ELCCRTM1
  5016
  5017 2150-CONTROL-BREAKS.
  5018     IF SAVE-CONTROL-BREAKS = SPACES
  5019         MOVE CR-ACCT-CONTROL    TO SAVE-CNTRL-GRP
  5020         MOVE RC-COMP            TO LAST-REINS-CO.
  5021
  5022     IF LAST-REINS-CO NOT = RC-COMP
  5023         PERFORM 7100-REINS-CO-BREAK THRU 7100-EXIT
  5024         GO TO 3200-CALC-FOR-REINSURANCE.
  5025
  5026     IF LAST-CARRIER NOT = CR-CARRIER
  5027         PERFORM 7200-CARRIER-BREAK THRU 7200-EXIT
  5028         GO TO 3200-CALC-FOR-REINSURANCE.
  5029
  5030     IF LAST-GROUPING NOT = CR-GROUPING
  5031         PERFORM 7300-COMPANY-BREAK THRU 7300-EXIT
  5032         GO TO 3200-CALC-FOR-REINSURANCE.
  5033
  5034     IF LAST-STATE NOT = CR-STATE
  5035         PERFORM 7400-STATE-BREAK THRU 7400-EXIT
  5036         GO TO 3200-CALC-FOR-REINSURANCE.
  5037
  5038     IF LAST-ACCOUNT NOT = CR-ACCOUNT
  5039         PERFORM 7500-ACCOUNT-BREAK THRU 7500-EXIT.
  5040
  5041 3200-CALC-FOR-REINSURANCE.
  5042     IF RC-CONTROL = HIGH-VALUES
  5043         GO TO 3000-EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 109
* ECS150.cbl
  5044
  5045     MOVE CR-ACCT-CONTROL        TO SAVE-CNTRL-GRP.
  5046     MOVE RC-COMP                TO LAST-REINS-CO.
  5047     PERFORM 4000-ACTIVITY-TOTALING THRU 4000-EXIT.
  5048
  5049 3000-EXIT.
  5050     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 110
* ECS150.cbl
  5052 4000-ACTIVITY-TOTALING  SECTION 25.
  5053
  5054 4100-ELIM-FUTURES.
  5055     MOVE  CR-ENTRY-DATE     TO  DC-GREG-DATE-CYMD.
  5056     MOVE 'L'                TO  DC-OPTION-CODE.
  5057     PERFORM 8500-DATE-CONVERT-ROUTINE THRU 8599-DATE-CONVERT-X.
  5058     IF NO-CONVERSION-ERROR
  5059         MOVE DC-BIN-DATE-1  TO  CERT-ENTRY-DATE
  5060     ELSE
  5061         MOVE CR-DT          TO  DC-GREG-DATE-CYMD
  5062         MOVE 'L'            TO  DC-OPTION-CODE
  5063         PERFORM 8500-DATE-CONVERT-ROUTINE THRU
  5064                                      8599-DATE-CONVERT-X
  5065         IF NO-CONVERSION-ERROR
  5066             MOVE DC-BIN-DATE-1  TO  CERT-ENTRY-DATE.
  5067
  5068     IF CERT-ENTRY-DATE GREATER THAN PERIOD-END
  5069         GO TO 4000-EXIT.
  5070
  5071     IF CR-ENTRY-STATUS = '9'
  5072         IF REINSURANCE-PASS OR REINSURANCE-REC
  5073             NEXT SENTENCE
  5074         ELSE
  5075             GO TO 4000-EXIT.
  5076
  5077 4110-FIND-CLAS-L-TYPE.
  5078     IF CR-LFTYP = ZERO
  5079         GO TO 4120-FIND-CLAS-A-TYPE.
  5080
  5081     MOVE CR-LFTYP               TO CLAS-LOOK.
  5082     MOVE CLAS-STARTL            TO CLAS-INDEXL.
  5083
  5084 4115-LIFE-LOOKUP.
  5085     IF CLAS-INDEXL IS GREATER THAN CLAS-MAXL
  5086         DISPLAY 'INVALID LIFE TYPE' CLAS-LOOK
  5087         MOVE '0401'             TO ABEND-CODE
  5088         GO TO ABEND-PGM.
  5089
  5090     IF CLAS-I-BEN (CLAS-INDEXL) NOT = CLAS-LOOK
  5091         ADD +1 TO CLAS-INDEXL
  5092         GO TO 4115-LIFE-LOOKUP.
  5093
  5094 4120-FIND-CLAS-A-TYPE.
  5095     IF CR-AHTYP = ZERO
  5096         GO TO 4130-FIND-CLAS-STATE-ABBR.
  5097     MOVE CR-AHTYP               TO CLAS-LOOK.
  5098     MOVE CLAS-STARTA            TO CLAS-INDEXA.
  5099
  5100 4125-AH-LOOKUP.
  5101     IF CLAS-INDEXA IS GREATER THAN CLAS-MAXA
  5102         DISPLAY 'INVALID AH TYPE' CLAS-LOOK
  5103         MOVE '0402'             TO ABEND-CODE
  5104         GO TO ABEND-PGM.
  5105
  5106     IF CLAS-I-BEN (CLAS-INDEXA) NOT = CLAS-LOOK
  5107         ADD +1 TO CLAS-INDEXA
  5108         GO TO 4125-AH-LOOKUP.
  5109
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 111
* ECS150.cbl
  5110     MOVE CLAS-I-EP (CLAS-INDEXA) TO AH-EARN-METHOD.
  5111
  5112*    IF AM-EARN-METHOD-A NOT EQUAL SPACES AND ZEROS
  5113*        MOVE AM-EARN-METHOD-A TO AH-EARN-METHOD.
  5114
  5115 4130-FIND-CLAS-STATE-ABBR.
  5116     MOVE CLAS-STARTS TO CLAS-INDEXS.
  5117
  5118 4135-STATE-LOOK-UP.
  5119     IF CLAS-INDEXS IS GREATER THAN CLAS-MAXS
  5120         DISPLAY ' INVALID STATE CODE -' CR-STATE
  5121         MOVE '0301'             TO ABEND-CODE
  5122         GO TO ABEND-PGM.
  5123
  5124     IF STATE-SUB (CLAS-INDEXS) NOT = CR-STATE
  5125         ADD +1 TO CLAS-INDEXS
  5126         GO TO 4135-STATE-LOOK-UP.
  5127
  5128     IF (CR-LFTYP NOT = ZERO AND
  5129         CLAS-I-BAL (CLAS-INDEXL) = 'B')
  5130         OR
  5131        (CR-AHTYP NOT = ZERO AND
  5132         CLAS-I-BAL (CLAS-INDEXA) = 'B')
  5133          MOVE 1                 TO OB-SW
  5134     ELSE
  5135          MOVE 0                 TO OB-SW.
  5136
  5137     IF (CR-LFTYP NOT = ZERO AND
  5138         CLAS-I-BAL (CLAS-INDEXL) = 'Z')
  5139         OR
  5140        (CR-AHTYP NOT = ZERO AND
  5141         CLAS-I-BAL (CLAS-INDEXA) = 'Z')
  5142          MOVE 1                 TO SUMMARY-SW
  5143     ELSE
  5144          MOVE 0                 TO SUMMARY-SW.
  5145
  5146     IF CERT-ENTRY-DATE GREATER THAN PERIOD-START
  5147         MOVE 2                  TO EFFECTIVE-CONTROL
  5148     ELSE
  5149         MOVE 3                  TO EFFECTIVE-CONTROL.
  5150
  5151     MOVE ZEROS                  TO PRINT-SWITCHES.
  5152     MOVE ZEROS                  TO PRT-ISSUE-AMT-LF
  5153                                    PRT-CANC-AMT-LF
  5154                                    PRT-DEATH-AMT-LF
  5155                                    PRT-EXPIRY-AMT-LF
  5156                                    PRT-DECR-AMT-LF
  5157                                    PRT-INCR-AMT-LF
  5158                                    PRT-ISSUE-AMT-LF
  5159                                    PRT-CANC-AMT-LF
  5160                                    PRT-CLAIM-AMT-AH.
  5161     MOVE 1                      TO COUNT-WORK.
  5162
  5163     MOVE CR-DT                      TO DC-GREG-DATE-CYMD.
  5164     MOVE 'L'                        TO DC-OPTION-CODE.
  5165     PERFORM 8500-DATE-CONVERT-ROUTINE THRU 8599-DATE-CONVERT-X.
  5166     MOVE DC-BIN-DATE-1              TO CERT-EFFECT-DT.
  5167
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 112
* ECS150.cbl
  5168     IF REINSURANCE-PASS OR REINSURANCE-REC
  5169         MOVE CR-LOAN-1ST-PMT-DT TO DC-GREG-DATE-1-YMD
  5170         MOVE ZEROS                  TO DC-ELAPSED-MONTHS
  5171                                        DC-ELAPSED-DAYS
  5172         MOVE '3' TO DC-OPTION-CODE
  5173         PERFORM 8500-DATE-CONVERT-ROUTINE THRU
  5174                 8599-DATE-CONVERT-X
  5175         MOVE DC-BIN-DATE-1 TO FIRST-PAY-DT
  5176         GO TO 4137-SKIP-CALC.
  5177
  5178     IF CR-LOAN-1ST-PMT-DT NOT NUMERIC
  5179         MOVE ZEROS                  TO CR-LOAN-1ST-PMT-DT.
  5180
  5181     MOVE LOW-VALUES             TO     FIRST-PAY-DT.
  5182
  5183     IF CR-LOAN-1ST-PMT-DT NOT = ZEROS
  5184         MOVE CR-LOAN-1ST-PMT-DT     TO DC-GREG-DATE-1-YMD
  5185         MOVE ZEROS                  TO DC-ELAPSED-MONTHS
  5186                                        DC-ELAPSED-DAYS
  5187         MOVE '3'                    TO DC-OPTION-CODE
  5188         PERFORM 8500-DATE-CONVERT-ROUTINE THRU
  5189                 8599-DATE-CONVERT-X
  5190         IF NO-CONVERSION-ERROR
  5191             MOVE DC-BIN-DATE-1      TO FIRST-PAY-DT
  5192         ELSE
  5193             MOVE ZEROS              TO CR-LOAN-1ST-PMT-DT.
  5194
  5195     IF FIRST-PAY-DT       LESS THAN  CERT-EFFECT-DT
  5196         MOVE ZEROS  TO  CR-LOAN-1ST-PMT-DT.
  5197
  5198     IF CR-LOAN-1ST-PMT-DT = ZEROS
  5199         MOVE CERT-EFFECT-DT         TO DC-BIN-DATE-1
  5200         MOVE +1                     TO DC-ELAPSED-MONTHS
  5201         MOVE ZEROS                  TO DC-ELAPSED-DAYS
  5202         MOVE '6'                    TO DC-OPTION-CODE
  5203         PERFORM 8500-DATE-CONVERT-ROUTINE THRU
  5204                 8599-DATE-CONVERT-X
  5205         MOVE DC-BIN-DATE-2          TO FIRST-PAY-DT
  5206         MOVE DC-GREG-DATE-1-YMD     TO CR-LOAN-1ST-PMT-DT.
  5207
  5208 4137-SKIP-CALC.
  5209
  5210     IF SUMMARY-REC
  5211         COMPUTE COUNT-WORK = CR-LIVES - CR-SUM-CAN-CNT-ITD.
  5212     IF OB-COVERAGE
  5213         MOVE ZERO               TO COUNT-WORK.
  5214
  5215     IF CR-ENTRY-STATUS = '3' OR '5'
  5216         MOVE ZERO               TO COUNT-WORK.
  5217
  5218     MOVE ZEROES                 TO DOLLAR-AMT
  5219                                    DECREASING-DOLLAR
  5220                                    TEXAS-REG-SW
  5221                                    NET-PAY-SW
  5222                                    NEW-IN-EFFECT
  5223                                    OLD-IN-EFFECT
  5224                                    SAVE-BGN-INFORCE
  5225                                    SAVE-END-INFORCE
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 113
* ECS150.cbl
  5226                                    INFORCE-CNT-SW
  5227                                    CANCEL-SW
  5228                                    CLAIM-SW
  5229                                    PRINT-CNTRL.
  5230
  5231     IF DTE-CLIENT EQUAL 'HAN'
  5232        MOVE '2' TO CR-IND-GRP.
  5233
  5234     IF CR-IND-GRP = '2'
  5235         MOVE 2                  TO INS-TYPE-SW
  5236     ELSE
  5237         MOVE 1                  TO INS-TYPE-SW.
  5238
  5239     IF REINSURANCE-PASS
  5240         MOVE +5                 TO CL
  5241     ELSE
  5242         IF FIRST-INS-REC
  5243             MOVE +2             TO CL
  5244         ELSE
  5245             MOVE +4             TO CL.
  5246
  5247     IF CR-LFTYP = ZERO
  5248         GO TO 4900-PROCESS-DISABILITY.
  5249
  5250     IF CR-LF-CURRENT-STATUS = '4'
  5251         IF CR-LF-CANCEL-EXIT-DATE IS GREATER THAN ZEROS
  5252             MOVE '8'            TO  CR-LF-CURRENT-STATUS.
  5253
  5254     IF CR-LF-CURRENT-STATUS = '6' OR '7' OR '8'
  5255         NEXT SENTENCE
  5256     ELSE
  5257         IF (CR-DTHAMT-YTD IS GREATER THAN +0) OR
  5258            (CR-DTHAMT-YTD IS LESS THAN +0)
  5259             MOVE '7'            TO  CR-LF-CURRENT-STATUS.
  5260
  5261     IF CR-LF-CURRENT-STATUS NOT = 6 AND 7 AND 8
  5262         MOVE 0                  TO CERT-STATUS.
  5263     IF CR-LF-CURRENT-STATUS = 7
  5264         MOVE 2                  TO CERT-STATUS.
  5265     IF CR-LF-CURRENT-STATUS = 8
  5266         MOVE 1                  TO CERT-STATUS.
  5267     IF CR-LF-CURRENT-STATUS = 6
  5268         MOVE 3                  TO CERT-STATUS.
  5269
  5270     MOVE CERT-EFFECT-DT             TO CP-CERT-EFF-DT.
  5271     MOVE FIRST-PAY-DT               TO CP-FIRST-PAY-DATE.
  5272     MOVE SPACES                     TO CP-ACCT-FLD-5.
  5273     MOVE DTE-CLIENT                 TO CP-COMPANY-ID.
  5274     MOVE CR-LF-TERM                 TO CP-ORIGINAL-TERM.
  5275     MOVE DTE-REM-TRM                TO CP-REM-TERM-METHOD.
  5276     MOVE '3'                        TO CP-PROCESS-TYPE.
  5277     MOVE DTE-CLASIC-COMPANY-CD      TO CP-COMPANY-CD.
  5278     MOVE DTE-REM-TRM-CALC-OPTION    TO CP-REM-TRM-CALC-OPTION.
  5279
  5280     MOVE CLAS-I-RL-AH (CLAS-INDEXL) TO CP-BENEFIT-TYPE.
  5281     MOVE CLAS-I-BAL (CLAS-INDEXL)   TO CP-SPECIAL-CALC-CD.
  5282     MOVE CR-LF-TERM                 TO CP-ORIGINAL-TERM
  5283                                        CP-LOAN-TERM.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 114
* ECS150.cbl
  5284
  5285     IF CLAS-I-EP (CLAS-INDEXL) = 'B' AND
  5286        CLAS-I-CALC-TYPE (CLAS-INDEXL) NOT = 'L'
  5287         ADD +1                      TO CP-ORIGINAL-TERM
  5288                                        CP-LOAN-TERM.
  5289
  5290     IF CP-TERM-IS-DAYS
  5291         MOVE CR-LF-TERM-IN-DAYS     TO CP-TERM-OR-EXT-DAYS
  5292     ELSE
  5293         MOVE ZEROS                  TO CP-TERM-OR-EXT-DAYS.
  5294
  5295     MOVE RUN-DATE-BIN       TO CP-VALUATION-DT.
  5296
  5297     PERFORM 4585-GET-REMAINING-TERM THRU 4585-EXIT.
  5298
  5299     IF CLAS-I-EP (CLAS-INDEXL) = 'B' AND
  5300        CLAS-I-CALC-TYPE (CLAS-INDEXL) NOT = 'L'
  5301         COMPUTE CP-REMAINING-TERM-1 = CP-REMAINING-TERM-1 - 1
  5302         COMPUTE CP-REMAINING-TERM-2 = CP-REMAINING-TERM-2 - 1.
  5303
  5304     MOVE CP-REMAINING-TERM-2  TO  SAVE-REM-TERM.
  5305
  5306     MOVE EP-DT-BIN          TO CP-VALUATION-DT.
  5307
  5308     PERFORM 4585-GET-REMAINING-TERM THRU 4585-EXIT.
  5309
  5310     MOVE ZEROS TO LF-BAL-REMTRM.
  5311     IF CLAS-I-EP (CLAS-INDEXL) = 'B' AND
  5312        CLAS-I-CALC-TYPE (CLAS-INDEXL) NOT = 'L'
  5313         MOVE CP-REMAINING-TERM-2 TO LF-BAL-REMTRM
  5314         COMPUTE CP-REMAINING-TERM-1 = CP-REMAINING-TERM-1 - 1
  5315         COMPUTE CP-REMAINING-TERM-2 = CP-REMAINING-TERM-2 - 1.
  5316
  5317     IF CP-REMAINING-TERM-2 GREATER THAN CR-LF-TERM
  5318         MOVE CR-LF-TERM TO CP-REMAINING-TERM-2
  5319                            CP-REMAINING-TERM-1.
  5320
  5321     MOVE CP-REMAINING-TERM-2 TO LF-REM-TRM.
  5322
  5323     MOVE CR-LF-EXPIRE-DATE TO DC-GREG-DATE-CYMD
  5324     MOVE 'L' TO DC-OPTION-CODE
  5325     PERFORM 8500-DATE-CONVERT-ROUTINE THRU
  5326             8599-DATE-CONVERT-X
  5327     MOVE DC-BIN-DATE-1 TO CERT-EXPIRE-DATE-O
  5328
  5329     IF REINSURANCE-PASS OR REINSURANCE-REC
  5330         MOVE CR-LF-EXPIRE-DATE TO DC-GREG-DATE-CYMD
  5331         MOVE 'L' TO DC-OPTION-CODE
  5332         PERFORM 8500-DATE-CONVERT-ROUTINE THRU
  5333                 8599-DATE-CONVERT-X
  5334         MOVE DC-BIN-DATE-1 TO CERT-EXPIRE-DATE
  5335         GO TO 4150-SKIP-CALC.
  5336
  5337     MOVE FIRST-PAY-DT            TO DC-BIN-DATE-1.
  5338
  5339     IF (CLAS-I-EP (CLAS-INDEXL) = 'B') AND
  5340        (CLAS-I-CALC-TYPE (CLAS-INDEXL) NOT = 'L')
  5341         MOVE CR-LF-TERM          TO DC-ELAPSED-MONTHS
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 115
* ECS150.cbl
  5342     ELSE
  5343         COMPUTE DC-ELAPSED-MONTHS = CR-LF-TERM - +1.
  5344
  5345     MOVE '6'                     TO DC-OPTION-CODE.
  5346     PERFORM 8500-DATE-CONVERT-ROUTINE THRU
  5347             8599-DATE-CONVERT-X.
  5348     IF NO-CONVERSION-ERROR
  5349         MOVE DC-BIN-DATE-2        TO CERT-EXPIRE-DATE
  5350     ELSE
  5351         MOVE LOW-VALUES           TO CERT-EXPIRE-DATE.
  5352
  5353     IF (CERT-EXPIRE-DATE = LOW-VALUES)
  5354        OR (DTE-REM-TRM-CALC-OPTION = '1' OR '2')
  5355        MOVE CERT-EFFECT-DT          TO DC-BIN-DATE-1
  5356        MOVE CR-LF-TERM              TO DC-ELAPSED-MONTHS
  5357        MOVE ZEROS                   TO DC-ELAPSED-DAYS
  5358        MOVE '6'                     TO DC-OPTION-CODE
  5359        PERFORM 8500-DATE-CONVERT-ROUTINE THRU
  5360                8599-DATE-CONVERT-X
  5361        IF NO-CONVERSION-ERROR
  5362           MOVE DC-BIN-DATE-2        TO CERT-EXPIRE-DATE
  5363        ELSE
  5364           MOVE LOW-VALUES           TO CERT-EXPIRE-DATE.
  5365
  5366*    IF CLAS-I-EP (CLAS-INDEXL) = 'B' AND
  5367*       CLAS-I-CALC-TYPE (CLAS-INDEXL) NOT = 'L'
  5368*       MOVE CERT-EFFECT-DT          TO DC-BIN-DATE-1
  5369*       COMPUTE DC-ELAPSED-MONTHS = CR-LF-TERM + 1
  5370*       MOVE ZEROS                   TO DC-ELAPSED-DAYS
  5371*       MOVE '6'                     TO DC-OPTION-CODE
  5372*       PERFORM 8500-DATE-CONVERT-ROUTINE THRU
  5373*               8599-DATE-CONVERT-X
  5374*       IF NO-CONVERSION-ERROR
  5375*          MOVE DC-BIN-DATE-2        TO CERT-EXPIRE-DATE
  5376*       ELSE
  5377*          MOVE LOW-VALUES           TO CERT-EXPIRE-DATE.
  5378
  5379     IF CP-REMAINING-TERM-2  GREATER THAN ZEROS
  5380         IF CERT-EXPIRE-DATE LESS THAN PERIOD-END
  5381            MOVE CERT-EXPIRE-DATE-O
  5382                              TO CERT-EXPIRE-DATE.
  5383*            MOVE PERIOD-END  TO  CERT-EXPIRE-DATE.
  5384
  5385     MOVE CERT-EXPIRE-DATE-O     TO CERT-EXPIRE-DATE
  5386     MOVE CERT-EXPIRE-DATE TO DC-BIN-DATE-1.
  5387     MOVE ' '                TO  DC-OPTION-CODE.
  5388     PERFORM 8500-DATE-CONVERT-ROUTINE THRU 8599-DATE-CONVERT-X.
  5389     MOVE DC-GREG-DATE-CYMD  TO WS-CR-LF-EXPIRE-DATE-N
  5390                                CR-LF-EXPIRE-DATE.
  5391
  5392 4150-SKIP-CALC.
  5393
  5394     MOVE LOW-VALUES             TO LOW-EXIT-DATE.
  5395     MOVE CR-LF-DEX-CC           TO DC-ALPHA-CEN-N.
  5396     MOVE CR-LF-DEX-YR           TO DC-YMD-YEAR.
  5397     MOVE CR-LF-DEX-MO           TO DC-YMD-MONTH.
  5398     MOVE CR-LF-DEX-DA           TO DC-YMD-DAY.
  5399     MOVE '3'                TO  DC-OPTION-CODE.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 116
* ECS150.cbl
  5400     PERFORM 8500-DATE-CONVERT-ROUTINE THRU 8599-DATE-CONVERT-X.
  5401     MOVE DC-BIN-DATE-1  TO  CLAIM-EXIT-DATE.
  5402
  5403     MOVE CR-LF-CANCEL-EXIT-DATE  TO DC-GREG-DATE-CYMD.
  5404     MOVE 'L'                TO  DC-OPTION-CODE.
  5405     PERFORM 8500-DATE-CONVERT-ROUTINE THRU 8599-DATE-CONVERT-X.
  5406     MOVE DC-BIN-DATE-1  TO  CANCEL-EXIT-DATE.
  5407
  5408     MOVE CR-LF-CANC-DT      TO DC-GREG-DATE-CYMD.
  5409     MOVE 'L'                TO  DC-OPTION-CODE.
  5410     PERFORM 8500-DATE-CONVERT-ROUTINE THRU 8599-DATE-CONVERT-X.
  5411     MOVE DC-BIN-DATE-1  TO  SUM-CANCEL-DATE.
  5412
  5413     IF CLAIM-EXIT-DATE = SPACES OR ZEROS
  5414         MOVE LOW-VALUES TO CLAIM-EXIT-DATE.
  5415
  5416     IF CANCEL-EXIT-DATE = SPACES OR ZEROS
  5417         MOVE LOW-VALUES TO CANCEL-EXIT-DATE.
  5418
  5419     IF CLAIM-EXIT-DATE = LOW-VALUES AND
  5420        CANCEL-EXIT-DATE = LOW-VALUES
  5421         GO TO 4300-SET-SUBSCRIPTS.
  5422
  5423     IF CLAIM-EXIT-DATE = LOW-VALUES
  5424         MOVE CANCEL-EXIT-DATE   TO LOW-EXIT-DATE
  5425         GO TO 4300-SET-SUBSCRIPTS.
  5426
  5427     IF CANCEL-EXIT-DATE = LOW-VALUES
  5428         MOVE CLAIM-EXIT-DATE    TO LOW-EXIT-DATE
  5429         GO TO 4300-SET-SUBSCRIPTS.
  5430
  5431     IF CLAIM-EXIT-DATE LESS THAN CANCEL-EXIT-DATE
  5432         MOVE CLAIM-EXIT-DATE    TO LOW-EXIT-DATE
  5433     ELSE
  5434         MOVE CANCEL-EXIT-DATE   TO LOW-EXIT-DATE.
  5435
  5436 4300-SET-SUBSCRIPTS.
  5437     IF (CLAS-I-RL-AH (CLAS-INDEXL) = 'L' OR 'P')
  5438         MOVE 1                  TO LIFE-INS-SW
  5439     ELSE
  5440         MOVE 2                  TO LIFE-INS-SW.
  5441
  5442     IF CR-LF-TERM LESS THAN +121
  5443         MOVE +2                 TO TG
  5444     ELSE
  5445         MOVE +3                 TO TG.
  5446
  5447     IF CR-LF-TERM LESS THAN +61
  5448         MOVE +1                 TO TG.
  5449     MOVE TG                     TO SAV-LF-TERM-CODE.
  5450
  5451 4410-INFORCE-PRIOR-PERIOD.
  5452     IF NOT EFFECTIVE-BOTH-PER
  5453         GO TO 4420-INFORCE-THIS-PERIOD.
  5454
  5455     IF CLAIM-EXIT-DATE NOT = LOW-VALUES  AND
  5456        CANCEL-EXIT-DATE NOT = LOW-VALUES
  5457         IF CLAIM-EXIT-DATE NOT GREATER THAN PERIOD-START AND
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 117
* ECS150.cbl
  5458            CANCEL-EXIT-DATE GREATER THAN PERIOD-START
  5459             MOVE 1              TO CANCEL-SW
  5460             MOVE 0              TO COUNT-WORK
  5461             GO TO 4700-COMPUTE-CANCEL
  5462         ELSE
  5463             IF CANCEL-EXIT-DATE NOT GREATER THAN PERIOD-START
  5464             AND
  5465             CLAIM-EXIT-DATE GREATER THAN PERIOD-START
  5466              MOVE 1             TO CLAIM-SW
  5467              MOVE 0             TO COUNT-WORK
  5468              GO TO 4750-COMPUTE-CLAIM.
  5469
  5470     IF CERT-CLAIM  AND
  5471        LOW-EXIT-DATE = LOW-VALUES
  5472         GO TO 4415-CONTINUE.
  5473
  5474     IF CLAIM-OR-CANCEL AND
  5475        LOW-EXIT-DATE NOT GREATER THAN PERIOD-START AND
  5476            CR-DTHAMT-YTD NOT = ZERO
  5477                GO TO 4750-COMPUTE-CLAIM.
  5478
  5479     IF CLAIM-OR-CANCEL AND
  5480        LOW-EXIT-DATE NOT GREATER THAN PERIOD-START
  5481         GO TO 4900-PROCESS-DISABILITY.
  5482
  5483 4415-CONTINUE.
  5484
  5485     IF (CERT-EXPIRE-DATE NOT GREATER THAN PERIOD-START) AND
  5486        NOT CLAIM-OR-CANCEL
  5487            GO TO 4900-PROCESS-DISABILITY.
  5488
  5489     MOVE 1                      TO OLD-IN-EFFECT.
  5490
  5491     IF CERT-EXPIRE-DATE NOT GREATER THAN PERIOD-START
  5492         MOVE 0                  TO COUNT-WORK
  5493         GO TO 4420-INFORCE-THIS-PERIOD.
  5494
  5495     IF (CR-LFTYP = ZERO) OR
  5496        (CR-ENTRY-STATUS = '5') OR
  5497        (OB-COVERAGE)
  5498           MOVE ZERO             TO INFORCE-DOLLARS
  5499           GO TO 4420-INFORCE-THIS-PERIOD.
  5500
  5501     IF NOT SUMMARY-REC
  5502        NEXT SENTENCE
  5503      ELSE
  5504         IF (SUM-CANCEL-DATE GREATER PERIOD-START) OR
  5505            (CR-LFRFND = ZERO)
  5506             MOVE CR-LIVES       TO COUNT-WORK
  5507             MOVE CR-LFAMT       TO INFORCE-DOLLARS
  5508           ELSE
  5509             IF CR-LFPRM NOT GREATER CR-LFRFND
  5510                MOVE ZERO        TO INFORCE-DOLLARS
  5511                                    CR-LFPRM
  5512                                    CR-LFRFND
  5513              ELSE
  5514                COMPUTE TEMP-RESULT-L ROUNDED =
  5515                                     CR-LFRFND / CR-LFPRM
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 118
* ECS150.cbl
  5516                COMPUTE INFORCE-DOLLARS ROUNDED = CR-LFAMT -
  5517                                    (CR-LFAMT * TEMP-RESULT-L).
  5518
  5519     PERFORM 8300-STARTING-INFORCE THRU 8300-EXIT.
  5520
  5521
  5522     IF DTE-CLIENT = 'HER'
  5523         MOVE CR-LFAMT TO INFORCE-DOLLARS
  5524         IF CLAS-I-EP (CLAS-INDEXL) = 'B'
  5525             ADD CR-LFAMT-ALT TO INFORCE-DOLLARS.
  5526
  5527     MOVE +1                     TO EG.
  5528     PERFORM 8400-ADD-TO-EXHIBIT THRU 8400-EXIT.
  5529
  5530     MOVE INFORCE-DOLLARS        TO SAVE-BGN-INFORCE.
  5531
  5532 4420-INFORCE-THIS-PERIOD.
  5533
  5534     IF CERT-CLAIM  AND
  5535        LOW-EXIT-DATE = LOW-VALUES
  5536         NEXT SENTENCE
  5537     ELSE
  5538        IF CLAIM-OR-CANCEL AND
  5539           LOW-EXIT-DATE <= PERIOD-END
  5540            GO TO 4500-COMPUTE-UNEARNED.
  5541
  5542     IF (CERT-EXPIRE-DATE < PERIOD-END)
  5543        OR (LF-REM-TRM = ZEROS)
  5544         GO TO 4500-COMPUTE-UNEARNED.
  5545
  5546     MOVE 1                      TO NEW-IN-EFFECT.
  5547
  5548     IF NOT REINSURANCE-PASS
  5549         ADD +1 TO EXB-CNT.
  5550
  5551     IF (CR-LFTYP = ZERO) OR
  5552        (CR-ENTRY-STATUS = '5') OR
  5553        (OB-COVERAGE)
  5554           MOVE ZERO             TO INFORCE-DOLLARS
  5555           GO TO 4500-COMPUTE-UNEARNED.
  5556
  5557     IF SUMMARY-REC
  5558         COMPUTE COUNT-WORK = CR-LIVES - CR-SUM-CAN-CNT-ITD
  5559         IF CR-LFPRM NOT GREATER CR-LFRFND
  5560            MOVE ZERO            TO INFORCE-DOLLARS
  5561                                    CR-LFPRM
  5562                                    CR-LFRFND
  5563          ELSE
  5564           IF CR-LFRFND = ZERO
  5565             MOVE CR-LFAMT       TO INFORCE-DOLLARS
  5566           ELSE
  5567                COMPUTE TEMP-RESULT-L ROUNDED =
  5568                                     CR-LFRFND / CR-LFPRM
  5569                COMPUTE INFORCE-DOLLARS ROUNDED = CR-LFAMT -
  5570                                    (CR-LFAMT * TEMP-RESULT-L).
  5571
  5572     PERFORM 8350-ENDING-INFORCE THRU 8300-EXIT.
  5573
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 119
* ECS150.cbl
  5574     IF DTE-CLIENT = 'HER'
  5575         MOVE CR-LFAMT TO INFORCE-DOLLARS
  5576         IF CLAS-I-EP (CLAS-INDEXL) = 'B'
  5577             ADD CR-LFAMT-ALT TO INFORCE-DOLLARS.
  5578
  5579     IF GROUP-INS
  5580         ADD COUNT-WORK TO GROUP-CNT (CL  TG  9)
  5581         ADD INFORCE-DOLLARS TO GROUP-AMT (CL  TG  9)
  5582     ELSE
  5583         ADD COUNT-WORK TO IND-CNT (CL  TG  9)
  5584         ADD INFORCE-DOLLARS TO IND-AMT (CL  TG  9).
  5585
  5586     MOVE 1                      TO INFORCE-CNT-SW.
  5587     MOVE INFORCE-DOLLARS        TO DECREASING-DOLLAR
  5588                                    SAVE-END-INFORCE.
  5589
  5590 4500-COMPUTE-UNEARNED.
  5591     IF CR-ENTRY-STATUS = ('3' OR '5')
  5592         GO TO 4600-COMPUTE-ISSUES.
  5593
  5594     IF OB-COVERAGE
  5595         GO TO 4600-COMPUTE-ISSUES.
  5596
  5597     MOVE CR-DT                      TO DC-GREG-DATE-CYMD.
  5598     MOVE 'L'                        TO DC-OPTION-CODE.
  5599     PERFORM 8500-DATE-CONVERT-ROUTINE THRU 8599-DATE-CONVERT-X.
  5600     MOVE DC-BIN-DATE-1              TO CP-CERT-EFF-DT.
  5601
  5602     IF CR-LOAN-1ST-PMT-DT NOT NUMERIC
  5603         MOVE ZEROS                  TO CR-LOAN-1ST-PMT-DT.
  5604
  5605     MOVE LOW-VALUES  TO  CP-FIRST-PAY-DATE.
  5606
  5607     IF CR-LOAN-1ST-PMT-DT NOT = ZEROS
  5608         MOVE CR-LOAN-1ST-PMT-DT     TO DC-GREG-DATE-1-YMD
  5609         MOVE ZEROS                  TO DC-ELAPSED-MONTHS
  5610                                        DC-ELAPSED-DAYS
  5611         MOVE '3'                    TO DC-OPTION-CODE
  5612         PERFORM 8500-DATE-CONVERT-ROUTINE THRU
  5613                 8599-DATE-CONVERT-X
  5614         IF NO-CONVERSION-ERROR
  5615             MOVE DC-BIN-DATE-1      TO CP-FIRST-PAY-DATE
  5616         ELSE
  5617             MOVE ZEROS              TO CR-LOAN-1ST-PMT-DT.
  5618
  5619     IF CP-FIRST-PAY-DATE LESS THAN  CP-CERT-EFF-DT
  5620         MOVE ZEROS  TO  CR-LOAN-1ST-PMT-DT.
  5621
  5622     IF CR-LOAN-1ST-PMT-DT = ZEROS
  5623         MOVE CP-CERT-EFF-DT         TO DC-BIN-DATE-1
  5624         MOVE +1                     TO DC-ELAPSED-MONTHS
  5625         MOVE ZEROS                  TO DC-ELAPSED-DAYS
  5626         MOVE '6'                    TO DC-OPTION-CODE
  5627         PERFORM 8500-DATE-CONVERT-ROUTINE THRU
  5628                 8599-DATE-CONVERT-X
  5629         MOVE DC-BIN-DATE-2          TO CP-FIRST-PAY-DATE
  5630         MOVE DC-GREG-DATE-1-YMD     TO CR-LOAN-1ST-PMT-DT.
  5631
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 120
* ECS150.cbl
  5632     IF ENTERED-PREV-PERIOD
  5633         MOVE RUN-DATE-BIN       TO CP-VALUATION-DT
  5634         MOVE +1                 TO FACTOR-C
  5635         PERFORM 4550-UNEARNED-CALC THRU 4550-EXIT
  5636         MOVE UNEXPIRED-MONTHS   TO HOLD-PREV-UNEXP
  5637         MOVE EXPIRED-MONTHS     TO HOLD-PREV-EXP.
  5638
  5639     IF ENTERED-PREV-PERIOD
  5640         IF CERT-CANCELLED
  5641             IF CANCEL-EXIT-DATE <= PERIOD-END
  5642                 GO TO 4700-COMPUTE-CANCEL.
  5643
  5644     IF ENTERED-THIS-PERIOD
  5645         IF CERT-CANCELLED
  5646             IF CANCEL-EXIT-DATE <= PERIOD-END
  5647                 GO TO 4600-COMPUTE-ISSUES.
  5648
  5649     IF ENTERED-THIS-PERIOD
  5650         MOVE EP-DT-BIN          TO CP-VALUATION-DT
  5651         MOVE -1                 TO FACTOR-C
  5652         PERFORM 4550-UNEARNED-CALC THRU 4550-EXIT
  5653         MOVE UNEXPIRED-MONTHS   TO HOLD-END-UNEXP
  5654         MOVE EXPIRED-MONTHS     TO HOLD-END-EXP.
  5655
  5656     GO TO 4600-COMPUTE-ISSUES.
  5657
  5658 4550-UNEARNED-CALC.
  5659
  5660     MOVE SPACES                     TO CP-ACCT-FLD-5.
  5661     MOVE DTE-CLIENT                 TO CP-COMPANY-ID.
  5662     MOVE CR-LF-TERM                 TO CP-ORIGINAL-TERM.
  5663     MOVE DTE-REM-TRM                TO CP-REM-TERM-METHOD.
  5664     MOVE '3'                        TO CP-PROCESS-TYPE.
  5665     MOVE DTE-CLASIC-COMPANY-CD      TO CP-COMPANY-CD.
  5666     MOVE DTE-REM-TRM-CALC-OPTION    TO CP-REM-TRM-CALC-OPTION.
  5667     MOVE CLAS-I-RL-AH (CLAS-INDEXL) TO CP-BENEFIT-TYPE.
  5668     MOVE CLAS-I-BAL   (CLAS-INDEXL) TO CP-SPECIAL-CALC-CD.
  5669
  5670     IF (CLAS-I-EP (CLAS-INDEXL) = 'B') AND
  5671        (CLAS-I-CALC-TYPE (CLAS-INDEXL) NOT = 'L')
  5672         ADD +1                      TO CP-ORIGINAL-TERM
  5673                                        CP-LOAN-TERM.
  5674
  5675     IF CP-TERM-IS-DAYS
  5676         MOVE CR-LF-TERM-IN-DAYS     TO CP-TERM-OR-EXT-DAYS
  5677     ELSE
  5678         MOVE ZEROS                  TO CP-TERM-OR-EXT-DAYS.
  5679
  5680     PERFORM 4585-GET-REMAINING-TERM THRU 4585-EXIT.
  5681
  5682     IF NO-CP-ERROR
  5683         NEXT SENTENCE
  5684     ELSE
  5685         MOVE +0                     TO CP-REMAINING-TERM-1
  5686                                        CP-REMAINING-TERM-2.
  5687
  5688     IF (CLAS-I-EP (CLAS-INDEXL) = 'B') AND
  5689        (CLAS-I-CALC-TYPE (CLAS-INDEXL) NOT = 'L')
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 121
* ECS150.cbl
  5690         COMPUTE CP-REMAINING-TERM-1 = (CP-REMAINING-TERM-1 - +1).
  5691
  5692     IF CP-REMAINING-TERM-1 IS NEGATIVE
  5693         MOVE ZEROS                  TO CP-REMAINING-TERM-1.
  5694     IF CP-REMAINING-TERM-2 IS NEGATIVE
  5695         MOVE ZEROS                  TO CP-REMAINING-TERM-2.
  5696
  5697     IF CP-REMAINING-TERM-1 = ZEROS
  5698         IF (CLAS-I-EP (CLAS-INDEXL) = 'B') AND
  5699            (CLAS-I-CALC-TYPE (CLAS-INDEXL) NOT = 'L') AND
  5700            (CP-REMAINING-TERM-2 IS GREATER THAN ZEROS)
  5701             NEXT SENTENCE
  5702         ELSE
  5703             GO TO 4550-EXIT.
  5704
  5705     MOVE CP-REMAINING-TERM-1        TO UNEXPIRED-MONTHS.
  5706     COMPUTE EXPIRED-MONTHS = CR-LF-TERM - UNEXPIRED-MONTHS.
  5707
  5708     IF CR-LFPRM NOT NUMERIC
  5709        MOVE +0 TO CR-LFPRM.
  5710
  5711     IF SUMMARY-REC
  5712         IF CR-LFRFND = +0
  5713             MOVE CR-LFPRM       TO CP-ORIGINAL-PREMIUM
  5714         ELSE
  5715             COMPUTE CP-ORIGINAL-PREMIUM ROUNDED =
  5716                     CR-LFPRM - CR-LFRFND
  5717     ELSE
  5718         MOVE CR-LFPRM           TO CP-ORIGINAL-PREMIUM.
  5719
  5720     IF CR-LFPRM-ALT NOT NUMERIC
  5721        MOVE +0 TO CR-LFPRM-ALT.
  5722     MOVE CR-LFPRM-ALT           TO CP-ALTERNATE-PREMIUM
  5723     IF CR-LF-TERM NOT NUMERIC
  5724        MOVE +0 TO CR-LF-TERM.
  5725     MOVE CR-LF-TERM             TO CP-ORIGINAL-TERM
  5726     MOVE UNEXPIRED-MONTHS       TO CP-REMAINING-TERM
  5727     MOVE CLAS-I-EP (CLAS-INDEXL)
  5728                                 TO CP-EARNING-METHOD
  5729     MOVE CLAS-I-RL-AH (CLAS-INDEXL)
  5730                                 TO CP-BENEFIT-TYPE
  5731     MOVE CLAS-I-CALC-TYPE (CLAS-INDEXL)
  5732                                 TO CP-SPECIAL-CALC-CD
  5733     MOVE CR-LFTYP               TO CP-BENEFIT-CD
  5734     MOVE LIFE-OVERRIDE-L1       TO CP-LIFE-OVERRIDE-CODE
  5735     PERFORM 4945-CALC-UNEARNED-PREMIUM THRU 4945-AH-EXIT.
  5736
  5737     IF CP-ERROR-OCCURED
  5738        GO TO 4575-ERROR-LF.
  5739
  5740     MOVE CP-STATE-U-PRM         TO UNEARNED-AMT-LF
  5741
  5742     IF CLAS-I-EP (CLAS-INDEXL) = 'T'
  5743         MOVE '1'                TO  TEXAS-REG-SW.
  5744
  5745     IF CLAS-I-EP (CLAS-INDEXL) = 'N'
  5746         MOVE '1'                TO  NET-PAY-SW.
  5747
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 122
* ECS150.cbl
  5748 4552-LIFE-EARNINGS-CONT.
  5749
  5750     COMPUTE UNEARNED-AMT-LF = UNEARNED-AMT-LF * FACTOR-C.
  5751
  5752     IF LEVEL-LIFE
  5753         MOVE +2                 TO IY
  5754     ELSE
  5755         MOVE +1                 TO IY.
  5756
  5757     IF INDIVIDUAL-INS
  5758         ADD +5 TO IY.
  5759
  5760     ADD UNEARNED-AMT-LF TO EARN-PREM (CL  TG  IY).
  5761
  5762 4550-EXIT.
  5763     EXIT.
  5764
  5765 4575-ERROR-LF.
  5766
  5767     DISPLAY 'ERROR OCCURED IN LF UNEARNED ROUTINE'
  5768     DISPLAY 'CP RETURN CODE ...' CP-RETURN-CODE.
  5769     DISPLAY 'FULL CONTROL   ...' CR-FULL-CONTROL
  5770     GO TO ABEND-PGM.
  5771
  5772 4585-GET-REMAINING-TERM.
  5773
  5774     CALL 'ELRTRMX' USING CALCULATION-PASS-AREA.
  5775
  5776     IF DTE-CLIENT = 'NCL'
  5777         MOVE CP-REMAINING-TERM-1 TO CP-REMAINING-TERM-2.
  5778
  5779 4585-EXIT.
  5780     EXIT.
  5781
  5782 4600-COMPUTE-ISSUES.
  5783     IF EFFECTIVE-BOTH-PER
  5784         GO TO 4700-COMPUTE-CANCEL.
  5785
  5786     IF CR-ENTRY-STATUS = '3' OR '5'
  5787         GO TO 4700-COMPUTE-CANCEL.
  5788
  5789     MOVE '1'                    TO LF-ISSUE.
  5790     MOVE CR-LFAMT               TO PRT-ISSUE-AMT-LF.
  5791     MOVE CR-LFAMT               TO TEMP-RESULT.
  5792
  5793
  5794     IF LEVEL-LIFE
  5795         MOVE +2                 TO IY
  5796     ELSE
  5797         MOVE +1                 TO IY.
  5798
  5799     IF OB-COVERAGE
  5800         MOVE +3                 TO IY.
  5801
  5802 4610-TOT-LF-ISSUES.
  5803     MOVE TEMP-RESULT            TO INFORCE-DOLLARS.
  5804
  5805     MOVE +2                     TO EG.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 123
* ECS150.cbl
  5806     IF SUMMARY-REC
  5807         MOVE CR-LIVES           TO COUNT-WORK.
  5808     PERFORM 8400-ADD-TO-EXHIBIT THRU 8400-EXIT.
  5809
  5810     MOVE 1                      TO INFORCE-CNT-SW.
  5811     ADD INFORCE-DOLLARS TO SAVE-BGN-INFORCE.
  5812
  5813     IF INDIVIDUAL-INS
  5814         ADD +5 TO IY.
  5815
  5816     IF CR-LFPRM-ALT NOT NUMERIC
  5817         MOVE ZEROS              TO  CR-LFPRM-ALT.
  5818
  5819     IF CLAS-I-EP (CLAS-INDEXL) = 'B'
  5820         ADD CR-LFPRM            TO  EARN-PREM  (CL  TG  IY)
  5821                                     ISSUE-PREM (CL  TG  IY)
  5822         ADD CR-LFPRM-ALT        TO  EARN-PREM  (CL  TG  IY)
  5823                                     ISSUE-PREM (CL  TG  IY)
  5824     ELSE
  5825         ADD CR-LFPRM            TO  EARN-PREM  (CL  TG  IY)
  5826                                     ISSUE-PREM (CL  TG  IY).
  5827
  5828     ADD TEMP-RESULT TO ISSUE-AMT (CL  TG  IY).
  5829     ADD COUNT-WORK TO ISSUE-CNT (CL  TG  IY).
  5830
  5831 4700-COMPUTE-CANCEL.
  5832*    NOTE *******************************************************
  5833*         *  EFFECTIVE AS OF VMOD 6.30 THE FOLLOWING TWO        *
  5834*         *  LINES OF CODE ARE DELETED. IF PRESENT, YOUR CANCEL *
  5835*         *  COUNT AND CLAIM COUNT WILL BE TOO LOW BECAUSE ONLY *
  5836*         *  POLICIES ISSUED IN CURRENT YEAR WILL BE COUNTED.   *
  5837*         *  THE AMOUNTS ARE CORRECT AND WILL BE UNAFFECTED.    *
  5838*         *******************************************************.
  5839*    IF INFORCE-CNT-SW NOT = 1
  5840*        MOVE 0 TO COUNT-WORK.
  5841******************************************************************
  5842     IF SUMMARY-REC AND
  5843        (SUM-CANCEL-DATE NOT GREATER PERIOD-END) AND
  5844        (SUM-CANCEL-DATE GREATER PERIOD-START) AND
  5845        (CR-SUM-CAN-CNT-YTD NOT = ZERO)
  5846         NEXT SENTENCE
  5847       ELSE
  5848        IF LUMP-SUM AND
  5849           (CLAIM-EXIT-DATE NOT GREATER PERIOD-END) AND
  5850           (CLAIM-EXIT-DATE NOT LESS PERIOD-START)
  5851            NEXT SENTENCE
  5852         ELSE
  5853            IF (CANCEL-EXIT-DATE = ZERO OR LOW-VALUES) OR
  5854               CANCEL-EXIT-DATE GREATER THAN PERIOD-END
  5855                GO TO 4750-COMPUTE-CLAIM.
  5856
  5857     SUBTRACT CR-CCYY FROM CR-LF-CNC-CCYY GIVING INTERIM-YR.
  5858*    SUBTRACT CR-YR FROM CR-LF-CNC-YR GIVING INTERIM-YR.
  5859     IF INTERIM-YR < 0
  5860        ADD 100 TO INTERIM-YR
  5861     END-IF.
  5862     COMPUTE TERM-WORK = (INTERIM-YR * 12)
  5863                        + (CR-LF-CNC-MO - CR-MO).
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 124
* ECS150.cbl
  5864     IF CR-LF-CNC-DA LESS THAN CR-DA
  5865         SUBTRACT 1 FROM TERM-WORK.
  5866
  5867     IF LUMP-SUM
  5868         MOVE '1'                TO LF-LUMP
  5869     ELSE
  5870         MOVE '1'                TO LF-CANC.
  5871
  5872     MULTIPLY CR-LFRFND BY -1 GIVING UNEARNED-AMT-LF.
  5873     MOVE '1'                    TO LF-CANC.
  5874     MOVE CR-LFRFND              TO PRT-CANC-AMT-LF.
  5875
  5876     IF LEVEL-LIFE
  5877         MOVE +2                 TO IY
  5878     ELSE
  5879         MOVE +1                 TO IY.
  5880
  5881     IF OB-COVERAGE
  5882         MOVE +3                 TO IY.
  5883
  5884     IF INDIVIDUAL-INS
  5885         ADD +5 TO IY.
  5886
  5887     ADD UNEARNED-AMT-LF TO EARN-PREM (CL  TG  IY).
  5888
  5889     IF SUMMARY-REC
  5890         GO TO 4703-SUM-CANC.
  5891
  5892     IF LEVEL-LIFE
  5893         MOVE CR-LFAMT           TO DOLLAR-AMT
  5894         GO TO 4705-LF-CANCEL-GO.
  5895
  5896     IF OB-COVERAGE
  5897         MOVE CR-LFAMT           TO DOLLAR-AMT
  5898         GO TO 4705-LF-CANCEL-GO.
  5899
  5900     IF TERM-WORK NOT POSITIVE
  5901         MOVE CR-LFAMT           TO DOLLAR-AMT
  5902         GO TO 4705-LF-CANCEL-GO.
  5903
  5904     IF TEXAS-CERT
  5905         GO TO 4701-TEX-CANC.
  5906
  5907     IF NET-PAY-CERT
  5908         GO TO 4702-NET-PAY-CANC.
  5909
  5910 4700-REG-CANCEL.
  5911     COMPUTE DOLLAR-AMT = CR-LFAMT - ((TERM-WORK / CR-LF-TERM)
  5912                             * CR-LFAMT).
  5913     GO TO 4705-LF-CANCEL-GO.
  5914
  5915 4701-TEX-CANC.
  5916     DIVIDE CR-LFAMT BY CR-LF-TERM
  5917         GIVING TEX-FACT-1.
  5918     DIVIDE TERM-WORK BY CR-PMT-FREQ
  5919         GIVING TEX-FACT-2
  5920             REMAINDER TEX-FACT-3.
  5921     COMPUTE DOLLAR-AMT =
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 125
* ECS150.cbl
  5922         (TEX-FACT-1 * (TEX-FACT-2 * CR-PMT-FREQ)).
  5923
  5924     GO TO 4705-LF-CANCEL-GO.
  5925
  5926 4702-NET-PAY-CANC.
  5927
  5928     MOVE CR-DT                  TO  DC-GREG-DATE-CYMD.
  5929     MOVE 'L'                    TO  DC-OPTION-CODE.
  5930     PERFORM 8500-DATE-CONVERT-ROUTINE THRU 8599-DATE-CONVERT-X.
  5931     MOVE DC-BIN-DATE-1          TO  CP-CERT-EFF-DT.
  5932
  5933     IF CR-LOAN-1ST-PMT-DT NOT = ZEROS
  5934         MOVE CR-LOAN-1ST-PMT-DT TO  DC-GREG-DATE-1-YMD
  5935         MOVE '3'                TO  DC-OPTION-CODE
  5936         PERFORM 8500-DATE-CONVERT-ROUTINE THRU
  5937             8599-DATE-CONVERT-X
  5938         MOVE DC-BIN-DATE-1      TO  CP-FIRST-PAY-DATE
  5939     ELSE
  5940         MOVE CP-CERT-EFF-DT     TO  DC-BIN-DATE-1
  5941         MOVE +1                 TO  DC-ELAPSED-MONTHS
  5942         MOVE +0                 TO  DC-ELAPSED-DAYS
  5943         MOVE '6'                TO  DC-OPTION-CODE
  5944         PERFORM 8500-DATE-CONVERT-ROUTINE THRU
  5945             8599-DATE-CONVERT-X
  5946         MOVE DC-BIN-DATE-2      TO  CP-FIRST-PAY-DATE.
  5947
  5948     MOVE CR-LFAMT               TO  CP-ORIGINAL-BENEFIT.
  5949     MOVE CR-APR                 TO  CP-LOAN-APR.
  5950     MOVE CR-LF-TERM             TO  CP-ORIGINAL-TERM.
  5951     MOVE CR-LOAN-TERM           TO  CP-LOAN-TERM.
  5952     COMPUTE CP-REMAINING-TERM = CR-LF-TERM - TERM-WORK.
  5953     MOVE STATE-ABBR       (CLAS-INDEXS) TO  CP-STATE-STD-ABBRV.
  5954     MOVE CLAS-I-CALC-TYPE (CLAS-INDEXL) TO  CP-SPECIAL-CALC-CD.
  5955     MOVE CLAS-I-RL-AH     (CLAS-INDEXL) TO  CP-BENEFIT-TYPE.
  5956     MOVE CLAS-I-EP        (CLAS-INDEXL) TO  CP-EARNING-METHOD.
  5957
  5958     CALL 'ELRAMTX' USING CALCULATION-PASS-AREA.
  5959
  5960     IF SUMMARY-REC
  5961         COMPUTE DOLLAR-AMT ROUNDED = CP-REMAMT-FACTOR *
  5962                                      (TEMP-1 / +1000)
  5963         GO TO 4705-LF-CANCEL-GO.
  5964
  5965     IF CP-STATE-STD-ABBRV = 'NC'
  5966               AND
  5967*      DTE-CLIENT NOT = 'WDS'
  5968       (DTE-CLIENT NOT = 'WDS' AND 'CID')
  5969          IF CP-CERT-EFF-DT GREATER THAN WS-931231
  5970             MOVE CP-REMAINING-AMT
  5971                                  TO  DOLLAR-AMT
  5972             GO TO 4705-LF-CANCEL-GO.
  5973
  5974      COMPUTE DOLLAR-AMT ROUNDED = CP-REMAMT-FACTOR *
  5975                                      (CR-LFAMT / +1000).
  5976     move cp-remaining-amt       to dollar-amt
  5977*    IF SUMMARY-REC
  5978*          COMPUTE DOLLAR-AMT ROUNDED =
  5979*                          CP-REMAMT-FACTOR * (TEMP-1 / +1000)
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 126
* ECS150.cbl
  5980*      ELSE
  5981*          COMPUTE DOLLAR-AMT ROUNDED =
  5982*                          CP-REMAMT-FACTOR * (CR-LFAMT / +1000).
  5983
  5984     GO TO 4705-LF-CANCEL-GO.
  5985
  5986 4703-SUM-CANC.
  5987     IF CR-LFPRM NOT GREATER CR-LFRFND
  5988        MOVE ZERO                TO DOLLAR-AMT
  5989        GO TO 4705-LF-CANCEL-GO.
  5990
  5991     IF CR-LFRFND = ZERO
  5992        MOVE CR-LFAMT            TO TEMP-1
  5993      ELSE
  5994                COMPUTE TEMP-RESULT-L ROUNDED =
  5995                                     CR-LFRFND / CR-LFPRM
  5996                COMPUTE TEMP-1 ROUNDED = CR-LFAMT -
  5997                                    (CR-LFAMT * TEMP-RESULT-L).
  5998
  5999     IF NET-PAY-CERT
  6000         GO TO 4702-NET-PAY-CANC.
  6001
  6002     IF LEVEL-LIFE
  6003         MOVE TEMP-1             TO DOLLAR-AMT
  6004      ELSE
  6005         COMPUTE DOLLAR-AMT = TEMP-1 - ((TERM-WORK / CR-LF-TERM)
  6006                                                        * TEMP-1).
  6007
  6008 4705-LF-CANCEL-GO.
  6009     MOVE DOLLAR-AMT             TO DECREASING-DOLLAR.
  6010
  6011     IF DOLLAR-AMT NEGATIVE
  6012         MOVE ZERO               TO DOLLAR-AMT.
  6013
  6014 4710-TOT-LF-CANCEL.
  6015     MOVE +6                     TO EG.
  6016     MOVE DOLLAR-AMT             TO INFORCE-DOLLARS.
  6017     MOVE COUNT-WORK             TO COUNT-SAVE.
  6018
  6019     IF (CLAIM-EXIT-DATE NOT = ZERO AND LOW-VALUES) AND
  6020        (CLAIM-EXIT-DATE <= PERIOD-END) AND
  6021        (CLAIM-EXIT-DATE GREATER PERIOD-START) AND
  6022        (NOT LUMP-SUM)
  6023         MOVE ZERO               TO COUNT-WORK
  6024         MOVE ZERO               TO DOLLAR-AMT INFORCE-DOLLARS.
  6025
  6026     IF SUMMARY-REC
  6027         MOVE CR-SUM-CAN-CNT-YTD TO COUNT-WORK.
  6028
  6029     IF NOT CURRENT-CANCEL-ONLY
  6030         PERFORM 8400-ADD-TO-EXHIBIT THRU 8400-EXIT
  6031         SUBTRACT INFORCE-DOLLARS FROM SAVE-BGN-INFORCE.
  6032
  6033     IF LEVEL-LIFE
  6034         MOVE +2                 TO IY
  6035     ELSE
  6036         MOVE +1                 TO IY.
  6037
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 127
* ECS150.cbl
  6038     IF OB-COVERAGE
  6039         MOVE +3                 TO IY.
  6040
  6041     IF INDIVIDUAL-INS
  6042         ADD +5 TO IY.
  6043
  6044     IF CR-LF-STATUS-AT-CANCEL NOT = SPACES
  6045         ADD COUNT-WORK TO CANCEL-CNT (CL  TG  IY).
  6046
  6047     ADD CR-LFRFND TO CANCEL-PREM (CL  TG  IY).
  6048     IF NOT CURRENT-CANCEL-ONLY
  6049        ADD DOLLAR-AMT TO CANCEL-AMT (CL  TG  IY).
  6050
  6051     MOVE COUNT-SAVE             TO COUNT-WORK.
  6052
  6053 4730-TOT-AH-CANCEL.
  6054     IF LUMP-SUM
  6055         GO TO 4900-PROCESS-DISABILITY.
  6056
  6057     IF (CANCEL-EXIT-DATE NOT = ZERO AND LOW-VALUES) AND
  6058        (CANCEL-EXIT-DATE <= PERIOD-END) AND
  6059        (CANCEL-EXIT-DATE GREATER PERIOD-START)
  6060          NEXT SENTENCE
  6061       ELSE
  6062         GO TO 4750-COMPUTE-CLAIM.
  6063
  6064     IF OB-COVERAGE
  6065         MOVE +5                 TO IY
  6066     ELSE
  6067         MOVE +4                 TO IY.
  6068
  6069     IF INDIVIDUAL-INS
  6070         ADD +5 TO IY.
  6071
  6072     IF SUMMARY-REC
  6073         MOVE CR-SUM-CAN-CNT-YTD TO COUNT-WORK.
  6074
  6075
  6076
  6077     IF CURRENT-CANCEL-ONLY
  6078         GO TO 4900-PROCESS-DISABILITY.
  6079     IF CLAIM-EXIT-DATE NOT = LOW-VALUES
  6080         GO TO 4750-COMPUTE-CLAIM.
  6081     IF CR-DTHAMT-YTD NOT = ZERO
  6082         GO TO 4750-COMPUTE-CLAIM.
  6083     IF CERT-ENTRY-DATE GREATER THAN PERIOD-START
  6084         GO TO 4820-COMPUTE-DECREASE.
  6085     IF CERT-EXPIRE-DATE NOT GREATER THAN PERIOD-START
  6086         GO TO 4800-COMPUTE-INCREASE.
  6087
  6088     GO TO 4820-COMPUTE-DECREASE.
  6089
  6090 4750-COMPUTE-CLAIM.
  6091     IF CR-LFTYP = ZERO
  6092         GO TO 4820-COMPUTE-DECREASE.
  6093
  6094     IF LUMP-SUM
  6095         GO TO 4820-COMPUTE-DECREASE.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 128
* ECS150.cbl
  6096
  6097     IF CLAIM-EXIT-DATE GREATER THAN PERIOD-END
  6098         GO TO 4770-COMPUTE-EXPIRE.
  6099
  6100     IF (CLAIM-EXIT-DATE = ZERO OR LOW-VALUES OR SPACES) AND
  6101         CR-DTHAMT-YTD = ZERO
  6102             GO TO 4770-COMPUTE-EXPIRE.
  6103
  6104     MOVE CR-DTHAMT-YTD          TO DECREASING-DOLLAR.
  6105     MOVE CR-DTHAMT-YTD          TO PRT-DEATH-AMT-LF.
  6106     MOVE '1'                    TO LF-DEATH.
  6107
  6108     IF LEVEL-LIFE
  6109         MOVE +2                 TO IY
  6110     ELSE
  6111         MOVE +1                 TO IY.
  6112
  6113     IF OB-COVERAGE
  6114         MOVE +3                 TO IY.
  6115
  6116     IF INDIVIDUAL-INS
  6117         ADD +5 TO IY.
  6118
  6119     ADD COUNT-WORK TO CLAIM-CNT (CL  TG  IY).
  6120     ADD CR-DTHAMT-YTD TO CLAIM-AMT (CL TG IY).
  6121     MOVE CR-DTHAMT-YTD TO INFORCE-DOLLARS.
  6122
  6123     IF OB-COVERAGE
  6124         MOVE +5                 TO IY
  6125     ELSE
  6126         MOVE +4                 TO IY.
  6127
  6128     IF INDIVIDUAL-INS
  6129         ADD +5 TO IY.
  6130
  6131     MOVE +4                     TO EG.
  6132     PERFORM 8400-ADD-TO-EXHIBIT THRU 8400-EXIT
  6133
  6134     IF CURRENT-CLAIM-ONLY
  6135         GO TO 4900-PROCESS-DISABILITY.
  6136
  6137     IF OB-COVERAGE
  6138         GO TO 4770-COMPUTE-EXPIRE.
  6139
  6140     SUBTRACT INFORCE-DOLLARS FROM SAVE-BGN-INFORCE.
  6141
  6142     IF CERT-EXPIRE-DATE NOT GREATER THAN PERIOD-START AND
  6143        NOT LEVEL-LIFE
  6144         GO TO 4800-COMPUTE-INCREASE.
  6145
  6146     IF NOT LEVEL-LIFE
  6147         GO TO 4820-COMPUTE-DECREASE.
  6148
  6149     COMPUTE DOLLAR-AMT = CR-LFAMT - CR-DTHAMT-YTD.
  6150     MOVE '1'                    TO LF-DECR.
  6151     MOVE DOLLAR-AMT             TO PRT-DECR-AMT-LF.
  6152
  6153     IF GROUP-INS
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 129
* ECS150.cbl
  6154         ADD DOLLAR-AMT TO GROUP-AMT (CL  TG  7)
  6155         ADD DOLLAR-AMT TO GROUP-AMT (CL  TG  8)
  6156     ELSE
  6157         ADD DOLLAR-AMT TO IND-AMT (CL  TG  7)
  6158         ADD DOLLAR-AMT TO IND-AMT (CL  TG  8).
  6159     SUBTRACT DOLLAR-AMT FROM SAVE-BGN-INFORCE.
  6160
  6161     IF CERT-EXPIRE-DATE GREATER THAN PERIOD-START
  6162         GO TO 4900-PROCESS-DISABILITY
  6163     ELSE
  6164         MOVE CR-LFAMT           TO DECREASING-DOLLAR
  6165         GO TO 4800-COMPUTE-INCREASE.
  6166
  6167 4770-COMPUTE-EXPIRE.
  6168     IF CR-ENTRY-STATUS = '3' OR '5'
  6169         GO TO 4900-PROCESS-DISABILITY.
  6170
  6171     IF CERT-EXPIRE-DATE >= PERIOD-END
  6172         GO TO 4820-COMPUTE-DECREASE.
  6173
  6174     IF CR-LFTYP = ZERO
  6175         GO TO 4900-PROCESS-DISABILITY.
  6176
  6177     IF (CLAS-I-EP (CLAS-INDEXL) = 'B'  AND
  6178         CLAS-I-CALC-TYPE (CLAS-INDEXL) NOT = 'L'  AND
  6179         LF-BAL-REMTRM NOT GREATER THAN ZERO)
  6180                       OR
  6181        (CLAS-I-EP (CLAS-INDEXL) = 'B'  AND
  6182         CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'L'  AND
  6183         LF-REM-TRM NOT GREATER THAN ZERO)
  6184                       OR
  6185        (CLAS-I-EP (CLAS-INDEXL) NOT = 'B'  AND
  6186         LF-REM-TRM NOT GREATER ZERO)
  6187           NEXT SENTENCE
  6188         ELSE
  6189         GO TO 4900-PROCESS-DISABILITY.
  6190
  6191     IF SUMMARY-REC
  6192        COMPUTE COUNT-WORK = CR-LIVES - CR-SUM-CAN-CNT-ITD
  6193        IF CR-LFPRM NOT GREATER CR-LFRFND
  6194           MOVE ZERO TO INFORCE-DOLLARS
  6195         ELSE
  6196          IF CR-LFRFND = ZERO
  6197             MOVE CR-LFAMT TO INFORCE-DOLLARS
  6198           ELSE
  6199                COMPUTE TEMP-RESULT-L ROUNDED =
  6200                                     CR-LFRFND / CR-LFPRM
  6201                COMPUTE DOLLAR-AMT ROUNDED = CR-LFAMT -
  6202                                    (CR-LFAMT * TEMP-RESULT-L).
  6203
  6204     IF EFFECTIVE-BOTH-PER
  6205         PERFORM 8300-STARTING-INFORCE THRU 8300-EXIT
  6206         MOVE INFORCE-DOLLARS    TO DOLLAR-AMT
  6207     ELSE
  6208         MOVE CR-LFAMT           TO DOLLAR-AMT.
  6209
  6210     IF OB-COVERAGE AND CR-LFTYP NOT = ZERO
  6211         MOVE CR-LFAMT           TO DOLLAR-AMT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 130
* ECS150.cbl
  6212
  6213     MOVE '1'                    TO LF-EXPIRY.
  6214     MOVE DOLLAR-AMT             TO PRT-EXPIRY-AMT-LF.
  6215     MOVE DOLLAR-AMT             TO INFORCE-DOLLARS.
  6216     MOVE +5                     TO EG.
  6217     PERFORM 8400-ADD-TO-EXHIBIT THRU 8400-EXIT.
  6218
  6219     IF NOT OB-COVERAGE
  6220         SUBTRACT INFORCE-DOLLARS FROM SAVE-BGN-INFORCE.
  6221
  6222     GO TO 4900-PROCESS-DISABILITY.
  6223
  6224 4800-COMPUTE-INCREASE.
  6225     IF CR-ENTRY-STATUS = '3' OR '5'
  6226         GO TO 4900-PROCESS-DISABILITY.
  6227
  6228     IF NOT EFFECTIVE-BOTH-PER
  6229         GO TO 4900-PROCESS-DISABILITY.
  6230
  6231     IF CR-LFTYP = ZERO
  6232         GO TO 4900-PROCESS-DISABILITY.
  6233
  6234     IF OB-COVERAGE OR SUMMARY-REC
  6235         GO TO 4900-PROCESS-DISABILITY.
  6236
  6237     COMPUTE MINUS-AMT = DECREASING-DOLLAR * -1.
  6238     MOVE '1'                    TO LF-INCR.
  6239     MOVE MINUS-AMT              TO PRT-INCR-AMT-LF.
  6240
  6241     IF GROUP-INS
  6242         ADD MINUS-AMT TO GROUP-AMT (CL  TG  7)
  6243         ADD MINUS-AMT TO GROUP-AMT (CL  TG  8)
  6244     ELSE
  6245         ADD MINUS-AMT TO IND-AMT (CL  TG  7)
  6246         ADD MINUS-AMT TO IND-AMT (CL  TG  8).
  6247     ADD DECREASING-DOLLAR TO SAVE-BGN-INFORCE.
  6248
  6249     GO TO 4900-PROCESS-DISABILITY.
  6250
  6251 4820-COMPUTE-DECREASE.
  6252     IF CR-ENTRY-STATUS = '3' OR '5'
  6253         GO TO 4900-PROCESS-DISABILITY.
  6254
  6255     IF CR-LFTYP = ZERO
  6256         GO TO 4900-PROCESS-DISABILITY.
  6257
  6258     IF LEVEL-LIFE
  6259         GO TO 4900-PROCESS-DISABILITY.
  6260
  6261     IF OB-COVERAGE OR SUMMARY-REC
  6262         GO TO 4900-PROCESS-DISABILITY.
  6263
  6264     IF NOT EFFECTIVE-BOTH-PER
  6265         SUBTRACT DECREASING-DOLLAR FROM CR-LFAMT
  6266             GIVING DOLLAR-AMT.
  6267
  6268     IF EFFECTIVE-BOTH-PER
  6269         PERFORM 8300-STARTING-INFORCE THRU 8300-EXIT
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 131
* ECS150.cbl
  6270         MOVE INFORCE-DOLLARS    TO DOLLAR-AMT
  6271         SUBTRACT DECREASING-DOLLAR FROM DOLLAR-AMT.
  6272
  6273     MOVE '1'                    TO LF-DECR.
  6274     MOVE DOLLAR-AMT             TO PRT-DECR-AMT-LF.
  6275
  6276     IF GROUP-INS
  6277         ADD DOLLAR-AMT TO GROUP-AMT (CL  TG  7)
  6278         ADD DOLLAR-AMT TO GROUP-AMT (CL  TG  8)
  6279     ELSE
  6280         ADD DOLLAR-AMT TO IND-AMT (CL  TG  7)
  6281         ADD DOLLAR-AMT TO IND-AMT (CL  TG  8).
  6282     SUBTRACT DOLLAR-AMT FROM SAVE-BGN-INFORCE.
  6283
  6284 4900-PROCESS-DISABILITY.
  6285
  6286     IF CR-AHTYP = ZERO
  6287         GO TO 4999-PRINT.
  6288
  6289     MOVE ZERO                   TO CANCEL-SW.
  6290     MOVE ZERO                   TO CLAIM-SW.
  6291
  6292     IF CR-AH-CURRENT-STATUS NOT = 6 AND 7 AND 8
  6293         MOVE 0                  TO CERT-STATUS.
  6294     IF CR-AH-CURRENT-STATUS = 7
  6295         MOVE 2                  TO CERT-STATUS.
  6296     IF CR-AH-CURRENT-STATUS = 8
  6297         MOVE 1                  TO CERT-STATUS.
  6298     IF CR-AH-CURRENT-STATUS = 6
  6299         MOVE 3                  TO CERT-STATUS.
  6300
  6301     MOVE CERT-EFFECT-DT             TO CP-CERT-EFF-DT.
  6302     MOVE FIRST-PAY-DT               TO CP-FIRST-PAY-DATE.
  6303     MOVE CR-AH-TERM                 TO CP-ORIGINAL-TERM.
  6304     MOVE CLAS-I-RL-AH (CLAS-INDEXL) TO CP-BENEFIT-TYPE.
  6305     MOVE CLAS-I-BAL (CLAS-INDEXL)   TO CP-SPECIAL-CALC-CD.
  6306     MOVE '3'                        TO CP-PROCESS-TYPE.
  6307     MOVE DTE-CLASIC-COMPANY-CD      TO CP-COMPANY-CD.
  6308     MOVE DTE-REM-TRM-CALC-OPTION    TO CP-REM-TRM-CALC-OPTION.
  6309     MOVE ZEROS TO  CP-TERM-OR-EXT-DAYS.
  6310
  6311 AH-REM-TERM.
  6312
  6313     PERFORM 4585-GET-REMAINING-TERM THRU 4585-EXIT.
  6314
  6315     MOVE CP-REMAINING-TERM-2 TO AH-REM-TRM.
  6316
  6317     IF REINSURANCE-PASS OR REINSURANCE-REC
  6318         MOVE CR-AH-EXPIRE-DATE TO DC-GREG-DATE-CYMD
  6319         MOVE 'L' TO DC-OPTION-CODE
  6320         PERFORM 8500-DATE-CONVERT-ROUTINE THRU
  6321                 8599-DATE-CONVERT-X
  6322         MOVE DC-BIN-DATE-1 TO CERT-EXPIRE-DATE
  6323         GO TO 4910-SKIP-CALC.
  6324
  6325     MOVE FIRST-PAY-DT            TO DC-BIN-DATE-1.
  6326     COMPUTE DC-ELAPSED-MONTHS = CR-AH-TERM - +1.
  6327     MOVE '6'                     TO DC-OPTION-CODE.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 132
* ECS150.cbl
  6328     PERFORM 8500-DATE-CONVERT-ROUTINE THRU
  6329                 8599-DATE-CONVERT-X.
  6330     IF NO-CONVERSION-ERROR
  6331         MOVE DC-BIN-DATE-2        TO CERT-EXPIRE-DATE
  6332     ELSE
  6333         MOVE LOW-VALUES           TO CERT-EXPIRE-DATE.
  6334
  6335     IF (CERT-EXPIRE-DATE = LOW-VALUES)     OR
  6336         (DTE-REM-TRM-CALC-OPTION = '1' OR '2')
  6337        MOVE CERT-EFFECT-DT          TO DC-BIN-DATE-1
  6338        MOVE CR-AH-TERM              TO DC-ELAPSED-MONTHS
  6339        MOVE ZEROS                   TO DC-ELAPSED-DAYS
  6340        MOVE '6'                     TO DC-OPTION-CODE
  6341        PERFORM 8500-DATE-CONVERT-ROUTINE THRU
  6342                8599-DATE-CONVERT-X
  6343        IF NO-CONVERSION-ERROR
  6344           MOVE DC-BIN-DATE-2        TO CERT-EXPIRE-DATE
  6345        ELSE
  6346           MOVE LOW-VALUES           TO CERT-EXPIRE-DATE.
  6347
  6348     IF CP-REMAINING-TERM-2 NOT GREATER THAN ZEROS
  6349         IF CERT-EXPIRE-DATE >= PERIOD-END
  6350             MOVE PERIOD-END  TO  CERT-EXPIRE-DATE.
  6351
  6352     MOVE CERT-EXPIRE-DATE TO DC-BIN-DATE-1.
  6353     MOVE ' '                TO  DC-OPTION-CODE.
  6354     PERFORM 8500-DATE-CONVERT-ROUTINE THRU 8599-DATE-CONVERT-X.
  6355     MOVE DC-GREG-DATE-CYMD TO WS-CR-AH-EXPIRE-DATE
  6356                               CR-AH-EXPIRE-DATE.
  6357
  6358 4910-SKIP-CALC.
  6359
  6360     MOVE LOW-VALUES             TO LOW-EXIT-DATE.
  6361     MOVE CR-AH-SETTLEMENT-EXIT-DATE TO DC-GREG-DATE-CYMD.
  6362     MOVE 'L'                TO  DC-OPTION-CODE.
  6363     PERFORM 8500-DATE-CONVERT-ROUTINE THRU 8599-DATE-CONVERT-X.
  6364     MOVE DC-BIN-DATE-1  TO  CLAIM-EXIT-DATE.
  6365
  6366     MOVE CR-AH-CANCEL-EXIT-DATE  TO DC-GREG-DATE-CYMD.
  6367     MOVE 'L'                TO  DC-OPTION-CODE.
  6368     PERFORM 8500-DATE-CONVERT-ROUTINE THRU 8599-DATE-CONVERT-X.
  6369     MOVE DC-BIN-DATE-1  TO  CANCEL-EXIT-DATE.
  6370
  6371     MOVE CR-AH-CANC-DT      TO DC-GREG-DATE-CYMD.
  6372     MOVE 'L'                TO  DC-OPTION-CODE.
  6373     PERFORM 8500-DATE-CONVERT-ROUTINE THRU 8599-DATE-CONVERT-X.
  6374     MOVE DC-BIN-DATE-1  TO  SUM-CANCEL-DATE.
  6375
  6376     MOVE LOW-VALUES             TO LOW-EXIT-DATE.
  6377
  6378     IF CLAIM-EXIT-DATE = SPACES OR ZEROS
  6379         MOVE LOW-VALUES TO CLAIM-EXIT-DATE.
  6380
  6381     IF CANCEL-EXIT-DATE = SPACES OR ZEROS
  6382         MOVE LOW-VALUES TO CANCEL-EXIT-DATE.
  6383
  6384     IF CLAIM-EXIT-DATE = LOW-VALUES AND
  6385        CANCEL-EXIT-DATE = LOW-VALUES
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 133
* ECS150.cbl
  6386         GO TO 4920-SET-SUBSCRIPTS.
  6387
  6388     IF CLAIM-EXIT-DATE = LOW-VALUES
  6389         MOVE CANCEL-EXIT-DATE   TO LOW-EXIT-DATE
  6390         GO TO 4920-SET-SUBSCRIPTS.
  6391
  6392     IF CANCEL-EXIT-DATE = LOW-VALUES
  6393         MOVE CLAIM-EXIT-DATE    TO LOW-EXIT-DATE
  6394         GO TO 4920-SET-SUBSCRIPTS.
  6395
  6396     IF CLAIM-EXIT-DATE LESS THAN CANCEL-EXIT-DATE
  6397         MOVE CLAIM-EXIT-DATE    TO LOW-EXIT-DATE
  6398     ELSE
  6399         MOVE CANCEL-EXIT-DATE   TO LOW-EXIT-DATE.
  6400
  6401 4920-SET-SUBSCRIPTS.
  6402
  6403     IF CR-AH-TERM LESS THAN +121
  6404         MOVE +2                 TO TG
  6405     ELSE
  6406         MOVE +3                 TO TG.
  6407
  6408     IF CR-AH-TERM LESS THAN +61
  6409         MOVE +1                 TO TG.
  6410
  6411     IF OB-COVERAGE
  6412         MOVE +5                 TO IY
  6413     ELSE
  6414         MOVE +4                 TO IY.
  6415
  6416     IF INDIVIDUAL-INS
  6417         ADD +5 TO IY.
  6418
  6419     IF NOT EFFECTIVE-BOTH-PER
  6420         GO TO 4925-CHECK-THIS-PER-ITEM.
  6421
  6422     IF CLAIM-EXIT-DATE NOT = LOW-VALUES AND
  6423        CANCEL-EXIT-DATE NOT = LOW-VALUES
  6424         IF CLAIM-EXIT-DATE NOT GREATER THAN PERIOD-START AND
  6425            CANCEL-EXIT-DATE GREATER THAN PERIOD-START
  6426             MOVE 1              TO CANCEL-SW
  6427             MOVE 0              TO COUNT-WORK
  6428             GO TO 4970-CHECK-CANCEL
  6429         ELSE
  6430             IF CANCEL-EXIT-DATE NOT GREATER THAN PERIOD-START
  6431             AND
  6432             CLAIM-EXIT-DATE GREATER THAN PERIOD-START
  6433              MOVE 1             TO CLAIM-SW
  6434              MOVE 0             TO COUNT-WORK
  6435              GO TO 4980-CHECK-CLAIM.
  6436
  6437     IF CLAIM-OR-CANCEL AND
  6438        LOW-EXIT-DATE NOT GREATER THAN PERIOD-START AND
  6439            CR-DISAMT-YTD NOT = ZERO
  6440                GO TO 4980-CHECK-CLAIM.
  6441
  6442     IF CLAIM-OR-CANCEL AND
  6443        LOW-EXIT-DATE NOT GREATER THAN PERIOD-START
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 134
* ECS150.cbl
  6444         GO TO 4999-PRINT.
  6445
  6446     IF (CERT-EXPIRE-DATE NOT GREATER THAN PERIOD-START) AND
  6447        NOT CLAIM-OR-CANCEL
  6448            GO TO 4980-CHECK-CLAIM.
  6449
  6450     MOVE '1'                    TO OLD-IN-EFFECT.
  6451
  6452 4925-CHECK-THIS-PER-ITEM.
  6453
  6454     IF CLAIM-OR-CANCEL AND
  6455        LOW-EXIT-DATE <= PERIOD-END
  6456         GO TO 4930-COMPUTE-UNEARNED.
  6457
  6458     IF CERT-EXPIRE-DATE < PERIOD-END
  6459         GO TO 4930-COMPUTE-UNEARNED.
  6460
  6461     MOVE 1                      TO NEW-IN-EFFECT.
  6462
  6463 4930-COMPUTE-UNEARNED.
  6464     IF CR-ENTRY-STATUS = ('3' OR '5')
  6465         GO TO 4950-CHECK-AH-ISSUE.
  6466
  6467     IF SUMMARY-REC
  6468         IF CR-AHPRM IS NOT GREATER THAN CR-AHRFND
  6469             MOVE ZERO           TO  CR-AHPRM
  6470                                     CR-AHRFND.
  6471     IF OB-COVERAGE
  6472         GO TO 4950-CHECK-AH-ISSUE.
  6473
  6474     MOVE CR-DT                      TO DC-GREG-DATE-CYMD.
  6475     MOVE 'L'                        TO DC-OPTION-CODE.
  6476     PERFORM 8500-DATE-CONVERT-ROUTINE THRU 8599-DATE-CONVERT-X.
  6477     MOVE DC-BIN-DATE-1              TO CP-CERT-EFF-DT.
  6478
  6479     IF CR-LOAN-1ST-PMT-DT NOT NUMERIC
  6480         MOVE ZEROS                  TO CR-LOAN-1ST-PMT-DT.
  6481
  6482     IF CR-LOAN-1ST-PMT-DT NOT = ZEROS
  6483         MOVE CR-LOAN-1ST-PMT-DT     TO DC-GREG-DATE-1-YMD
  6484         MOVE ZEROS                  TO DC-ELAPSED-MONTHS
  6485                                        DC-ELAPSED-DAYS
  6486         MOVE '3'                    TO DC-OPTION-CODE
  6487         PERFORM 8500-DATE-CONVERT-ROUTINE THRU
  6488                 8599-DATE-CONVERT-X
  6489         IF NO-CONVERSION-ERROR
  6490             MOVE DC-BIN-DATE-1      TO CP-FIRST-PAY-DATE
  6491         ELSE
  6492             MOVE ZEROS              TO CR-LOAN-1ST-PMT-DT.
  6493
  6494     IF CR-LOAN-1ST-PMT-DT = ZEROS
  6495         MOVE CP-CERT-EFF-DT         TO DC-BIN-DATE-1
  6496         MOVE +1                     TO DC-ELAPSED-MONTHS
  6497         MOVE ZEROS                  TO DC-ELAPSED-DAYS
  6498         MOVE '6'                    TO DC-OPTION-CODE
  6499         PERFORM 8500-DATE-CONVERT-ROUTINE THRU
  6500                 8599-DATE-CONVERT-X
  6501         MOVE DC-BIN-DATE-1          TO CP-FIRST-PAY-DATE.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 135
* ECS150.cbl
  6502
  6503     IF ENTERED-PREV-PERIOD
  6504         MOVE RUN-DATE-BIN       TO CP-VALUATION-DT
  6505         MOVE +1                 TO FACTOR-C
  6506         PERFORM 4940-UNEARNED-CALC THRU 4940-EXIT.
  6507
  6508     IF ENTERED-PREV-PERIOD
  6509         IF CERT-CANCELLED
  6510             IF CANCEL-EXIT-DATE <= PERIOD-END
  6511                 GO TO 4970-CHECK-CANCEL.
  6512
  6513     IF ENTERED-THIS-PERIOD
  6514         IF CERT-CANCELLED
  6515             IF CANCEL-EXIT-DATE <= PERIOD-END
  6516                 GO TO 4950-CHECK-AH-ISSUE.
  6517
  6518     IF ENTERED-THIS-PERIOD
  6519         MOVE EP-DT-BIN          TO CP-VALUATION-DT
  6520         MOVE -1                 TO FACTOR-C
  6521         PERFORM 4940-UNEARNED-CALC THRU 4940-EXIT.
  6522
  6523     GO TO 4950-CHECK-AH-ISSUE.
  6524
  6525 4940-UNEARNED-CALC.
  6526
  6527     MOVE SPACES                     TO CP-ACCT-FLD-5.
  6528     MOVE DTE-CLIENT                 TO CP-COMPANY-ID.
  6529     MOVE CR-AH-TERM                 TO CP-ORIGINAL-TERM.
  6530     MOVE DTE-REM-TRM                TO CP-REM-TERM-METHOD.
  6531     MOVE '3'                        TO CP-PROCESS-TYPE.
  6532     MOVE DTE-CLASIC-COMPANY-CD      TO CP-COMPANY-CD.
  6533     MOVE DTE-REM-TRM-CALC-OPTION    TO CP-REM-TRM-CALC-OPTION.
  6534
  6535 4940-GET-REMAINING-TERM.
  6536
  6537     PERFORM 4585-GET-REMAINING-TERM THRU 4585-EXIT.
  6538
  6539     MOVE CP-REMAINING-TERM-1        TO UNEXPIRED-MONTHS.
  6540     COMPUTE EXPIRED-MONTHS = CR-AH-TERM - UNEXPIRED-MONTHS.
  6541
  6542 4940-TERM-OK.
  6543     IF UNEXPIRED-MONTHS NOT GREATER ZERO
  6544         GO TO 4940-EXIT.
  6545
  6546     IF SUMMARY-REC
  6547         IF CR-AHRFND = +0
  6548             MOVE CR-AHPRM       TO CP-ORIGINAL-PREMIUM
  6549         ELSE
  6550             COMPUTE CP-ORIGINAL-PREMIUM ROUNDED =
  6551                 CR-AHPRM - CR-AHRFND
  6552     ELSE
  6553         MOVE CR-AHPRM           TO CP-ORIGINAL-PREMIUM.
  6554
  6555     MOVE CR-AH-TERM             TO CP-ORIGINAL-TERM
  6556     MOVE CR-AHAMT               TO CP-ORIGINAL-BENEFIT
  6557                                    CP-RATING-BENEFIT-AMT.
  6558     MOVE UNEXPIRED-MONTHS       TO CP-REMAINING-TERM
  6559
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 136
* ECS150.cbl
  6560     IF AH-EARN-METHOD = SPACES
  6561         MOVE CLAS-I-EP (CLAS-INDEXA) TO  CP-EARNING-METHOD
  6562     ELSE
  6563         MOVE AH-EARN-METHOD          TO  CP-EARNING-METHOD.
  6564
  6565     MOVE CLAS-I-RL-AH (CLAS-INDEXA)
  6566                                 TO CP-BENEFIT-TYPE
  6567     MOVE ZEROS                  TO CP-ALTERNATE-PREMIUM
  6568     MOVE CLAS-I-CALC-TYPE (CLAS-INDEXA)
  6569                                 TO CP-SPECIAL-CALC-CD
  6570     MOVE AM-AH-DEVIATION        TO CP-DEVIATION-CODE
  6571     MOVE CR-AHTYP               TO CP-BENEFIT-CD
  6572     MOVE AH-OVERRIDE-L1         TO CP-AH-OVERRIDE-CODE
  6573
  6574     IF CR-PMT-EXTENSION-DAYS NOT NUMERIC
  6575        MOVE ZEROS               TO CP-TERM-OR-EXT-DAYS
  6576     ELSE
  6577        MOVE CR-PMT-EXTENSION-DAYS
  6578                                 TO CP-TERM-OR-EXT-DAYS.
  6579
  6580     PERFORM 4945-CALC-UNEARNED-PREMIUM THRU 4945-AH-EXIT.
  6581
  6582     IF CP-ERROR-OCCURED
  6583        GO TO 4945-ERROR-AH.
  6584
  6585     MOVE CP-STATE-U-PRM    TO UNEARNED-AMT-AH.
  6586
  6587     IF (STATE-ABBR (CLAS-INDEXS) = 'VA')      AND
  6588        (CR-AH-TERM GREATER THAN +61)  AND
  6589        (CR-DT GREATER THAN  19921231)
  6590          MOVE  'A'  TO  AH-EARN-METHOD.
  6591
  6592     IF (CLAS-I-CALC-TYPE (CLAS-INDEXA) NOT = 'B' AND 'Z') AND
  6593        (AH-EARN-METHOD = 'A' OR 'C')
  6594         PERFORM 8450-RE-RATE-ROUTINE THRU 8499-EXIT
  6595         IF (CP-ERROR-RATE-NOT-FOUND OR
  6596             CP-ERROR-RATE-IS-ZERO OR
  6597             CP-ERROR-IN-DATES)
  6598             NEXT SENTENCE
  6599         ELSE
  6600             COMPUTE UNEARNED-AMT-AH ROUNDED =
  6601              ((UNEXPIRED-MONTHS * CR-AHAMT) / +100) *
  6602                CP-PREMIUM-RATE.
  6603
  6604     COMPUTE UNEARNED-AMT-AH ROUNDED =
  6605                           UNEARNED-AMT-AH * FACTOR-C.
  6606
  6607     IF GROUP-INS
  6608         ADD UNEARNED-AMT-AH TO EARN-PREM (CL  TG  4)
  6609     ELSE
  6610         ADD UNEARNED-AMT-AH TO EARN-PREM (CL  TG  9).
  6611 4940-EXIT.
  6612     EXIT.
  6613
  6614 4945-CALC-UNEARNED-PREMIUM.
  6615
  6616     MOVE CR-DT TO DC-GREG-DATE-CYMD.
  6617     MOVE 'L' TO DC-OPTION-CODE.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 137
* ECS150.cbl
  6618     PERFORM 8500-DATE-CONVERT-ROUTINE THRU
  6619                  8599-DATE-CONVERT-X.
  6620     MOVE DC-BIN-DATE-1 TO CP-CERT-EFF-DT
  6621     MOVE DTE-R78 TO CP-R78-OPTION
  6622     MOVE SPACES TO CP-ACCT-FLD-5
  6623     MOVE DTE-CLIENT TO CP-COMPANY-ID
  6624     IF CR-AGE NOT NUMERIC
  6625        MOVE +0 TO CR-AGE.
  6626     MOVE CR-AGE TO CP-ISSUE-AGE
  6627     IF CR-APR NOT NUMERIC
  6628        MOVE +0 TO CR-APR.
  6629     MOVE CR-APR TO CP-LOAN-APR
  6630
  6631     IF CR-PMT-FREQ IS NOT NUMERIC
  6632         MOVE ZEROS              TO  CP-PAY-FREQUENCY
  6633     ELSE
  6634         MOVE CR-PMT-FREQ        TO  CP-PAY-FREQUENCY.
  6635
  6636     IF CR-LOAN-TERM NOT NUMERIC
  6637        MOVE +0 TO CR-LOAN-TERM.
  6638     MOVE CR-LOAN-TERM TO CP-LOAN-TERM
  6639     MOVE SPACES         TO CP-DOMICILE-STATE
  6640     MOVE CR-CARRIER TO CP-CARRIER
  6641     IF CR-RATING-CLASS NOT = SPACES AND ZERO
  6642        MOVE CR-RATING-CLASS TO CP-CLASS-CODE
  6643     ELSE
  6644        MOVE AM-CAL-TABLE TO CP-CLASS-CODE.
  6645
  6646     MOVE STATE-SUB (CLAS-INDEXS) TO CP-STATE
  6647     MOVE STATE-ABBR (CLAS-INDEXS) TO CP-STATE-STD-ABBRV
  6648     MOVE DTE-CLASIC-COMPANY-CD TO CP-COMPANY-CD
  6649
  6650     CALL 'ELUPRMX'  USING CALCULATION-PASS-AREA.
  6651
  6652 4945-AH-EXIT.
  6653     EXIT.
  6654
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 138
* ECS150.cbl
  6656 4945-ERROR-AH.
  6657
  6658     DISPLAY 'ERROR OCCURED IN AH UNEARNED ROUTINE'
  6659     DISPLAY 'CP RETURN CODE ...' CP-RETURN-CODE.
  6660     GO TO ABEND-PGM.
  6661
  6662 4950-CHECK-AH-ISSUE.
  6663
  6664     IF EFFECTIVE-BOTH-PER
  6665         GO TO 4970-CHECK-CANCEL.
  6666
  6667     IF CR-ENTRY-STATUS = '3' OR '5'
  6668         GO TO 4970-CHECK-CANCEL.
  6669
  6670     IF SUMMARY-REC
  6671         MOVE CR-LIVES           TO COUNT-WORK.
  6672
  6673     MOVE '1'                    TO AH-ISSUE.
  6674     ADD COUNT-WORK TO ISSUE-CNT (CL  TG  IY).
  6675     ADD CR-AHPRM TO EARN-PREM (CL  TG  IY).
  6676     ADD CR-AHPRM TO ISSUE-PREM (CL  TG  IY).
  6677
  6678 4970-CHECK-CANCEL.
  6679     IF SUMMARY-REC AND
  6680        (SUM-CANCEL-DATE NOT GREATER PERIOD-END) AND
  6681        (SUM-CANCEL-DATE GREATER PERIOD-START) AND
  6682        (CR-SUM-CAN-CNT-YTD NOT = ZERO)
  6683         NEXT SENTENCE
  6684       ELSE
  6685        IF LUMP-SUM AND
  6686           (CLAIM-EXIT-DATE NOT GREATER PERIOD-END) AND
  6687           (CLAIM-EXIT-DATE NOT LESS PERIOD-START)
  6688            NEXT SENTENCE
  6689         ELSE
  6690            IF (CANCEL-EXIT-DATE = ZERO OR LOW-VALUES) OR
  6691               CANCEL-EXIT-DATE > PERIOD-END
  6692                GO TO 4980-CHECK-CLAIM.
  6693
  6694     MOVE '1'                TO AH-CANC.
  6695
  6696     MULTIPLY CR-AHRFND BY -1 GIVING UNEARNED-AMT-AH.
  6697     MOVE '1'                    TO AH-CANC.
  6698     MOVE CR-AHRFND              TO PRT-CANC-AMT-AH.
  6699     ADD UNEARNED-AMT-AH TO EARN-PREM (CL  TG  IY).
  6700
  6701     IF CR-AH-STATUS-AT-CANCEL NOT = SPACES
  6702         ADD COUNT-WORK TO     CANCEL-CNT (CL  TG  IY).
  6703
  6704     ADD CR-AHRFND TO     CANCEL-PREM (CL  TG  IY).
  6705
  6706 4980-CHECK-CLAIM.
  6707     IF CR-DISAMT-YTD = ZERO
  6708         GO TO 4999-PRINT.
  6709
  6710     MOVE '1'                    TO AH-CLAIM.
  6711     MOVE CR-DISAMT-YTD          TO PRT-CLAIM-AMT-AH.
  6712
  6713     MOVE CR-DIS-CC              TO WS-CR-DIS-CCYY(1:2).
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 139
* ECS150.cbl
  6714     MOVE CR-DIS-YR              TO WS-CR-DIS-CCYY(3:2).
  6715     ADD COUNT-WORK    TO CLAIM-CNT (CL TG IY).
  6716     ADD CR-DISAMT-YTD TO CLAIM-AMT (CL TG IY).
  6717     COMPUTE TERM-WORK = (WS-CR-DIS-CCYY * 12) + CR-DIS-MO.
  6718
  6719     IF TERM-WORK LESS THAN PERIOD-START-9
  6720         ADD CR-DISAMT-YTD TO AH-PAID-LAST-YR (CL)
  6721     ELSE
  6722         ADD CR-DISAMT-YTD TO AH-PAID-THIS-YR (CL).
  6723
  6724     MULTIPLY CR-AHRFND BY -1 GIVING UNEARNED-AMT-AH.
  6725
  6726 4999-PRINT.
  6727
  6728     IF PRT-LF-ISSUE OR
  6729        PRT-AH-ISSUE
  6730         MOVE 'ISSUE'            TO DL-ACTIVITY
  6731         MOVE PRT-ISSUE-AMT-LF   TO DL-RSRV-AMT
  6732         PERFORM 5100-PRINT-DETAIL THRU 5100-EXIT.
  6733
  6734     IF PRT-LF-DECR
  6735         MOVE 'DECR '            TO DL-ACTIVITY
  6736         MOVE PRT-DECR-AMT-LF    TO DL-RSRV-AMT
  6737         PERFORM 5100-PRINT-DETAIL THRU 5100-EXIT.
  6738
  6739     IF PRT-LF-CANC AND
  6740        PRT-AH-CANC
  6741             MOVE '1'                TO LF-REFUND-SW
  6742             MOVE 'CANC '            TO DL-ACTIVITY
  6743             MOVE '1'                TO AH-REFUND-SW
  6744             ADD PRT-CANC-AMT-AH     TO PRT-CANC-AMT-LF
  6745             MOVE PRT-CANC-AMT-LF    TO DL-RSRV-AMT
  6746             PERFORM 5100-PRINT-DETAIL THRU 5100-EXIT
  6747             GO TO 4999-NEXT-PRINT.
  6748
  6749     IF PRT-LF-CANC
  6750             MOVE '1'                TO LF-REFUND-SW
  6751             MOVE 'CANC '            TO DL-ACTIVITY
  6752             MOVE PRT-CANC-AMT-LF    TO DL-RSRV-AMT
  6753             PERFORM 5100-PRINT-DETAIL THRU 5100-EXIT.
  6754
  6755     IF PRT-AH-CANC
  6756             MOVE '1'                TO AH-REFUND-SW
  6757             MOVE 'CANC '            TO DL-ACTIVITY
  6758             MOVE PRT-CANC-AMT-AH    TO DL-RSRV-AMT
  6759             PERFORM 5100-PRINT-DETAIL THRU 5100-EXIT.
  6760
  6761 4999-NEXT-PRINT.
  6762     IF PRT-LF-INCR
  6763         MOVE 'INCR '            TO DL-ACTIVITY
  6764         MOVE PRT-INCR-AMT-LF    TO DL-RSRV-AMT
  6765         PERFORM 5100-PRINT-DETAIL THRU 5100-EXIT.
  6766
  6767     IF PRT-LF-EXPIRY
  6768         MOVE 'EXP  '            TO DL-ACTIVITY
  6769         MOVE PRT-EXPIRY-AMT-LF   TO DL-RSRV-AMT
  6770         PERFORM 5100-PRINT-DETAIL THRU 5100-EXIT.
  6771
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 140
* ECS150.cbl
  6772     IF PRT-LF-DEATH
  6773         MOVE 'DEATH'            TO DL-ACTIVITY
  6774         MOVE PRT-DEATH-AMT-LF   TO DL-RSRV-AMT
  6775         PERFORM 5100-PRINT-DETAIL THRU 5100-EXIT.
  6776
  6777     IF PRT-LF-LUMP
  6778         MOVE 'LUMP '            TO DL-ACTIVITY
  6779         MOVE PRT-CANC-AMT-LF    TO DL-RSRV-AMT
  6780         PERFORM 5100-PRINT-DETAIL THRU 5100-EXIT.
  6781
  6782     IF PRT-AH-CLAIM
  6783         MOVE 'DISAB'            TO DL-ACTIVITY
  6784         MOVE PRT-CLAIM-AMT-AH   TO DL-RSRV-AMT
  6785         PERFORM 5100-PRINT-DETAIL THRU 5100-EXIT.
  6786
  6787 4999-ADVN-TOTALS.
  6788
  6789     IF CR-LFTYP = ZERO
  6790         GO TO 4000-EXIT.
  6791
  6792     MOVE SAV-LF-TERM-CODE       TO TG.
  6793
  6794     COMPUTE GROUP-CNT (CL TG 3) =
  6795                            GROUP-CNT (CL TG 1)
  6796                          + GROUP-CNT (CL TG 2).
  6797     COMPUTE GROUP-AMT (CL TG 3) =
  6798                            GROUP-AMT (CL TG 1)
  6799                          + GROUP-AMT (CL TG 2).
  6800     COMPUTE GROUP-AMT (CL TG 8) =
  6801                            GROUP-AMT (CL TG 3)
  6802                          - GROUP-AMT (CL TG 9).
  6803     COMPUTE GROUP-AMT (CL TG 7) =
  6804                            GROUP-AMT (CL TG 8)
  6805                          - GROUP-AMT (CL TG 4)
  6806                          - GROUP-AMT (CL TG 5)
  6807                          - GROUP-AMT (CL TG 6).
  6808
  6809     COMPUTE GROUP-CNT (CL TG 5) =
  6810                            GROUP-CNT (CL TG 3)
  6811                          - GROUP-CNT (CL TG 9)
  6812                          - GROUP-CNT (CL TG 4)
  6813                          - GROUP-CNT (CL TG 6).
  6814
  6815     IF GROUP-CNT (CL TG 5) GREATER THAN ZEROS
  6816         COMPUTE GROUP-AMT (CL TG 5) =
  6817                            GROUP-AMT (CL TG 3)
  6818                          - GROUP-AMT (CL TG 9)
  6819                          - GROUP-AMT (CL TG 4)
  6820                          - GROUP-AMT (CL TG 6)
  6821                          - GROUP-AMT (CL TG 7).
  6822
  6823     IF GROUP-CNT (CL TG 5) LESS THAN ZERO
  6824         MOVE ZEROS TO GROUP-CNT (CL TG 5).
  6825
  6826     COMPUTE GROUP-CNT (CL TG 8) =
  6827                            GROUP-CNT (CL TG 4)
  6828                          + GROUP-CNT (CL TG 5)
  6829                          + GROUP-CNT (CL TG 6).
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 141
* ECS150.cbl
  6830     COMPUTE IND-CNT (CL TG 3) =
  6831                            IND-CNT (CL TG 1)
  6832                          + IND-CNT (CL TG 2).
  6833     COMPUTE IND-AMT (CL TG 3) =
  6834                            IND-AMT (CL TG 1)
  6835                          + IND-AMT (CL TG 2).
  6836     COMPUTE IND-AMT (CL TG 8) =
  6837                            IND-AMT (CL TG 3)
  6838                          - IND-AMT (CL TG 9).
  6839     COMPUTE IND-AMT (CL TG 7) =
  6840                            IND-AMT (CL TG 8)
  6841                          - IND-AMT (CL TG 4)
  6842                          - IND-AMT (CL TG 5)
  6843                          - IND-AMT (CL TG 6).
  6844
  6845     COMPUTE IND-CNT (CL TG 5) =
  6846                            IND-CNT (CL TG 3)
  6847                          - IND-CNT (CL TG 9)
  6848                          - IND-CNT (CL TG 4)
  6849                          - IND-CNT (CL TG 6).
  6850     IF IND-CNT (CL TG 5) GREATER THAN ZEROS
  6851         COMPUTE IND-AMT (CL TG 5) =
  6852                            IND-AMT (CL TG 3)
  6853                          - IND-AMT (CL TG 9)
  6854                          - IND-AMT (CL TG 4)
  6855                          - IND-AMT (CL TG 6)
  6856                          - IND-AMT (CL TG 7).
  6857
  6858     IF IND-CNT (CL TG 5) LESS THAN ZERO
  6859         MOVE ZEROS TO IND-CNT (CL TG 5).
  6860
  6861     COMPUTE IND-CNT (CL TG 8) =
  6862                            IND-CNT (CL TG 4)
  6863                          + IND-CNT (CL TG 5)
  6864                          + IND-CNT (CL TG 6).
  6865 4000-EXIT.
  6866     EXIT.
  6867
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 142
* ECS150.cbl
  6869 5000-PRINT-ROUTINES     SECTION 30.
  6870
  6871 5100-PRINT-DETAIL.
  6872     IF DTE-PGM-OPT NOT = 1
  6873         GO TO 5100-EXIT.
  6874
  6875     IF FIRST-INS-PASS AND REINSURANCE-REC
  6876         GO TO 5100-EXIT.
  6877
  6878     IF LINE-CNT GREATER THAN +53
  6879         PERFORM 5500-PRINT-HEADING THRU 5500-EXIT.
  6880
  6881     IF FIRST-DETAIL-DONE
  6882         MOVE DETAIL-LINE-1      TO P-DATA
  6883         MOVE SPACE              TO X
  6884         PERFORM 5900-PRINT
  6885         MOVE SPACES             TO DETAIL-LINE-1
  6886         ADD +1 TO LINE-CNT
  6887         GO TO 5100-EXIT.
  6888
  6889     MOVE CR-CERT                TO DL-CERT-NO.
  6890     MOVE CR-CERT-SFX            TO DL-CERT-SUFX.
  6891     MOVE CR-DA                  TO XDD OF FORMAT-DATE.
  6892     MOVE CR-MO                  TO XMM OF FORMAT-DATE.
  6893     MOVE CR-YR                  TO XYY OF FORMAT-DATE.
  6894     MOVE EDITED-DATE            TO DL-ISSUE-DT.
  6895     MOVE CR-AH-TERM             TO DL-AH-TERM.
  6896     MOVE CR-LF-TERM             TO DL-LF-TERM.
  6897
  6898     IF CR-IND-GRP = '2'
  6899         MOVE 'GP '              TO DL-TYPE
  6900     ELSE
  6901         MOVE 'IND'              TO DL-TYPE.
  6902
  6903     MOVE SPACE                  TO DL-PLAN.
  6904     MOVE CLAS-I-AB3 (CLAS-INDEXL)
  6905                                 TO DL-PLAN.
  6906     MOVE CR-LFAMT               TO DL-ORIG-AMT.
  6907
  6908     IF OB-COVERAGE OR SUMMARY-REC
  6909          MOVE CR-LFAMT          TO DL-ORIG-AMT.
  6910
  6911     IF PRT-LF-REFUND
  6912         MOVE CR-LFRFND          TO DL-LF-PREM
  6913     ELSE
  6914         MOVE CR-LFPRM           TO DL-LF-PREM.
  6915
  6916     IF PRT-AH-REFUND
  6917         MOVE CR-AHRFND          TO DL-AH-PREM
  6918     ELSE
  6919         MOVE CR-AHPRM           TO DL-AH-PREM.
  6920
  6921     MOVE SPACE                  TO X.
  6922     MOVE DETAIL-LINE-1          TO P-DATA.
  6923     PERFORM 5900-PRINT.
  6924     MOVE SPACES                 TO DETAIL-LINE-1.
  6925     MOVE 1                      TO PRINT-CNTRL.
  6926     ADD +1 TO LINE-CNT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 143
* ECS150.cbl
  6927
  6928 5100-EXIT.
  6929     EXIT.
  6930
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 144
* ECS150.cbl
  6932 5200-PRINT-SUMMARY-TOTALS    SECTION 40.
  6933     IF DTE-PGM-OPT NOT = 1
  6934         PERFORM 5500-PRINT-HEADING THRU 5500-EXIT
  6935     ELSE
  6936         IF LINE-CNT NOT LESS THAN +44
  6937             PERFORM 5500-PRINT-HEADING THRU 5500-EXIT.
  6938
  6939     ADD 60 TO LINE-CNT.
  6940     MOVE '    SUMMARY TOTALS   ' TO HL-MESSAGE.
  6941     MOVE HEAD-LINE-6            TO P-DATA.
  6942     MOVE '0'                    TO X.
  6943     PERFORM 5900-PRINT.
  6944
  6945     MOVE SPACE                  TO X.
  6946     MOVE HEAD-LINE-8A           TO P-DATA.
  6947     PERFORM 5900-PRINT.
  6948
  6949     MOVE HEAD-LINE-8B           TO P-DATA.
  6950     PERFORM 5900-PRINT.
  6951     MOVE HEAD-LINE-8C           TO P-DATA.
  6952     PERFORM 5900-PRINT.
  6953
  6954     IF REINSURANCE-PASS
  6955         MOVE +5                 TO CL
  6956     ELSE
  6957         MOVE +2                 TO CL.
  6958
  6959     PERFORM 5300-ADD-TERMS THRU 5300-EXIT
  6960         VARYING TG FROM +1 BY +1
  6961             UNTIL TG GREATER THAN +3.
  6962
  6963     MOVE 'GROUP   0-60    '     TO DL-DESCRIP.
  6964     MOVE 1                      TO TG.
  6965     MOVE 5                      TO IY.
  6966     PERFORM 5240-BUILD-SUMMARY.
  6967
  6968     MOVE 'GROUP   61-120  '     TO DL-DESCRIP.
  6969     MOVE 2                      TO TG.
  6970     PERFORM 5240-BUILD-SUMMARY.
  6971
  6972     MOVE 'GROUP   GTR 120 '     TO DL-DESCRIP.
  6973     MOVE 3                      TO TG
  6974     PERFORM 5240-BUILD-SUMMARY.
  6975
  6976     MOVE 1                      TO TG.
  6977     MOVE 10                     TO IY.
  6978     MOVE 'INDV    0-60    '     TO DL-DESCRIP.
  6979     PERFORM 5240-BUILD-SUMMARY
  6980
  6981     MOVE 2                      TO TG.
  6982     MOVE 'INDV    61-120  '     TO DL-DESCRIP.
  6983     PERFORM 5240-BUILD-SUMMARY.
  6984
  6985     MOVE 3                      TO TG.
  6986     MOVE 'INDV    GTR 120 '     TO DL-DESCRIP.
  6987     PERFORM 5240-BUILD-SUMMARY.
  6988
  6989 5200-EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 145
* ECS150.cbl
  6990     EXIT.
  6991
  6992 5240-BUILD-SUMMARY.
  6993     MOVE ISSUE-CNT   (CL  TG  IY) TO DL-ISS-CNT.
  6994     MOVE ISSUE-AMT   (CL  TG  IY) TO DL-ISS-AMT.
  6995     MOVE ISSUE-PREM  (CL  TG  IY) TO DL-ISS-PRM.
  6996     MOVE CANCEL-CNT  (CL  TG  IY) TO DL-CAN-CNT.
  6997     MOVE CANCEL-AMT  (CL  TG  IY) TO DL-CAN-AMT.
  6998     MOVE CANCEL-PREM (CL  TG  IY) TO DL-CAN-PRM.
  6999     MOVE CLAIM-CNT   (CL  TG  IY) TO DL-CLM-CNT.
  7000     MOVE CLAIM-AMT   (CL  TG  IY) TO DL-CLM-AMT.
  7001     MOVE EARN-PREM   (CL  TG  IY) TO DL-EARN-AMT.
  7002     MOVE DETAIL-LINE-2            TO P-DATA.
  7003     PERFORM 5900-PRINT.
  7004
  7005 5300-ADD-TERMS.
  7006     MOVE +5                     TO LA.
  7007
  7008     PERFORM 5350-ADD-GRPS THRU 5350-EXIT
  7009         VARYING IY FROM 1 BY 1
  7010             UNTIL IY GREATER THAN +4.
  7011
  7012     MOVE +10 TO LA.
  7013
  7014     PERFORM 5350-ADD-GRPS THRU 5350-EXIT
  7015         VARYING IY FROM 6 BY 1
  7016             UNTIL IY GREATER THAN +9.
  7017
  7018 5300-EXIT.
  7019     EXIT.
  7020
  7021 5350-ADD-GRPS.
  7022     ADD CORRESPONDING INSURANCE-TYPES (CL  TG  IY) TO
  7023                       INSURANCE-TYPES (CL  TG  LA).
  7024
  7025 5350-EXIT.
  7026     EXIT.
  7027
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 146
* ECS150.cbl
  7029 5500-PRINT-HEADING      SECTION 30.
  7030     MOVE 0                      TO LINE-CNT.
  7031     ADD +1 TO PAGE-CNT.
  7032     MOVE LAST-CARRIER           TO HL-CARRIER.
  7033     MOVE LAST-GROUPING          TO HL-COMPANY.
  7034     MOVE PAGE-CNT               TO HL-PAGENO.
  7035     MOVE LAST-ACCOUNT           TO HL-ACCOUNT.
  7036     MOVE LAST-REINS-CO          TO HL-REIN-CO.
  7037     MOVE LAST-STATE             TO STATE-L.
  7038
  7039 5510-STATE-LOOKUP.
* 7040                             COPY ECSSTLOK.
  7041******************************************************************07/10/97
  7042*                                                                *ECSSTLOK
  7043*                            ECSSTLOK                            *   LV001
  7044*                            VMOD=2.001                         * ECSSTLOK
  7045*                                                                *ECSSTLOK
  7046*  NO  CID  MODS  IN  COPYBOOK  ECSSTLOK                         *ECSSTLOK
  7047*                                                                *ECSSTLOK
  7048******************************************************************ECSSTLOK
  7049 STATE--START.                                                    ECSSTLOK
  7050     MOVE ZERO TO CLAS-INDEXS.                                    ECSSTLOK
  7051                                                                  ECSSTLOK
  7052 STATE--LOOP.                                                     ECSSTLOK
  7053     ADD 1 TO CLAS-INDEXS.                                        ECSSTLOK
  7054     IF CLAS-INDEXS IS GREATER THAN CLAS-MAXS                     ECSSTLOK
  7055         MOVE SPACE TO STATE-L                                    ECSSTLOK
  7056         GO TO STATE--EXIT.                                       ECSSTLOK
  7057                                                                  ECSSTLOK
  7058     IF STATE-L NOT = STATE-SUB (CLAS-INDEXS)                     ECSSTLOK
  7059         GO TO STATE--LOOP.                                       ECSSTLOK
  7060                                                                  ECSSTLOK
  7061 STATE--EXIT.                                                     ECSSTLOK
  7062     EXIT.
  7063******************************************************************ECSSTLOK
  7064
  7065     IF STATE-L = SPACE
  7066         MOVE SPACE              TO HL-STATE
  7067     ELSE
  7068         MOVE STATE-PIC (CLAS-INDEXS) TO HL-STATE.
  7069
  7070     MOVE '1'                    TO X.
  7071     MOVE HEAD-LINE-1            TO P-DATA.
  7072     PERFORM 5900-PRINT.
  7073
  7074     MOVE SPACE                  TO X.
  7075     MOVE HEAD-LINE-2            TO P-DATA.
  7076     PERFORM 5900-PRINT.
  7077
  7078     MOVE HEAD-LINE-3            TO P-DATA.
  7079     PERFORM 5900-PRINT.
  7080
  7081     MOVE HEAD-LINE-4            TO P-DATA.
  7082     PERFORM 5900-PRINT.
  7083
  7084     IF REINSURANCE-PASS
  7085         MOVE HEAD-LINE-5        TO P-DATA
  7086         PERFORM 5900-PRINT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 147
* ECS150.cbl
  7087
  7088     IF DTE-PGM-OPT NOT = 1
  7089         MOVE ' NO DETAIL GENERATED ' TO HL-MESSAGE
  7090         MOVE HEAD-LINE-6        TO P-DATA
  7091         PERFORM 5900-PRINT
  7092     ELSE
  7093         MOVE '0'                TO X
  7094         MOVE HEAD-LINE-7A       TO P-DATA
  7095         PERFORM 5900-PRINT
  7096         MOVE SPACE              TO X
  7097         MOVE HEAD-LINE-7B       TO P-DATA
  7098         PERFORM 5900-PRINT.
  7099
  7100 5500-EXIT.
  7101     EXIT.
  7102
  7103 5900-PRINT.
* 7104                             COPY ELCPRT2.
  7105******************************************************************04/15/98
  7106*                                                                *ELCPRT2
  7107*                                                                *ELCPRT2
  7108*                            ELCPRT2                             *   LV005
  7109*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**5
  7110*                            VMOD=2.002                          *   CL**5
  7111*                                                                *   CL**4
  7112******************************************************************   CL**4
  7113                                                                     CL**4
  7114     IF DTE-FICH NOT = SPACE AND                                     CL**4
  7115        FICH-OPEN    = SPACE                                         CL**4
  7116         MOVE 'X'                TO  FICH-OPEN                       CL**4
  7117         OPEN OUTPUT FICH.                                           CL**4
  7118                                                                     CL**4
  7119     IF DTE-FICH NOT = SPACE                                         CL**4
  7120         MOVE X                  TO  P-CTL                           CL**4
  7121         WRITE FICH-REC FROM PRT.                                    CL**4
  7122                                                                     CL**4
  7123     IF DTE-FICH = SPACE OR '2'                                      CL**4
  7124       MOVE X                    TO  P-CTL                           CL**4
  7125       IF P-CTL = ' '                                                CL**4
  7126         WRITE PRT AFTER ADVANCING 1 LINE                            CL**4
  7127       ELSE                                                          CL**4
  7128         IF P-CTL = '0'                                              CL**4
  7129           WRITE PRT AFTER ADVANCING 2 LINES                         CL**4
  7130         ELSE                                                        CL**4
  7131           IF P-CTL = '-'                                            CL**4
  7132             WRITE PRT AFTER ADVANCING 3 LINES                       CL**4
  7133           ELSE                                                      CL**4
  7134             WRITE PRT AFTER ADVANCING PAGE.                         CL**4
  7135                                                                     CL**4
  7136******************************************************************   CL**4
  7137
  7138 5900-EXIT.
  7139     EXIT.
  7140
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 148
* ECS150.cbl
  7142 6000-REINSURANCE-CALC   SECTION 35.
  7143     IF CR-REIN-TABLE = SPACES OR ZEROS
  7144         GO TO 6000-EXIT.
  7145
  7146     PERFORM CLEAR-REIN-HOLD THRU CLEAR-REIN-HOLD-X.
  7147     MOVE CR-REIN-TABLE          TO REIN-SRCH.
  7148
  7149*    IF REIN-SRCH = 'EBM'
  7150*       MOVE 'EBO'               TO REIN-SRCH
  7151*    END-IF
  7152*    IF REIN-SRCH = 'R01'
  7153*       MOVE 'R99'               TO REIN-SRCH
  7154*    END-IF
  7155
  7156     PERFORM RR-READ-REIN THRU RR-READ-REIN-X.
  7157
  7158 REINSURE-ROUTINE-GET-CALC.
* 7159                             COPY ECSRTPFM.
  7160******************************************************************07/10/97
  7161*                                                                *ECSRTPFM
  7162*                            ECSRTPFM                            *   LV001
  7163*                            VMOD=2.002                          *ECSRTPFM
  7164*                                                                *ECSRTPFM
  7165******************************************************************ECSRTPFM
  7166                                                                  ECSRTPFM
  7167     IF    CR-LFAMT  NUMERIC                                      00000072
  7168           NEXT SENTENCE                                          00000073
  7169        ELSE                                                      00000074
  7170           MOVE ZEROS TO CR-LFAMT.                                00000075
  7171                                                                  00000076
  7172     IF    CR-LFAMT-ALT  NUMERIC                                  00000077
  7173           NEXT SENTENCE                                          00000078
  7174        ELSE                                                      00000079
  7175           MOVE ZEROS TO CR-LFAMT-ALT.                            00000080
  7176                                                                  00000081
  7177                                                                  00000082
  7178     IF    CR-LFPRM  NUMERIC                                      00000083
  7179           NEXT SENTENCE                                          00000084
  7180        ELSE                                                      00000085
  7181           MOVE ZEROS TO CR-LFPRM.                                00000086
  7182                                                                  00000087
  7183     IF    CR-LFPRM-ALT  NUMERIC                                  00000088
  7184           NEXT SENTENCE                                          00000089
  7185        ELSE                                                      00000090
  7186           MOVE ZEROS TO CR-LFPRM-ALT.                            00000091
  7187                                                                  00000092
  7188                                                                  00000093
  7189     IF    CR-LFPRM-CALC  NUMERIC                                 00000094
  7190           NEXT SENTENCE                                          00000095
  7191        ELSE                                                      00000096
  7192           MOVE ZEROS TO CR-LFPRM-CALC.                           00000097
  7193                                                                  00000098
  7194     IF    CR-LFPRM-CALC-ALT  NUMERIC                             00000099
  7195           NEXT SENTENCE                                          00000100
  7196        ELSE                                                      00000101
  7197           MOVE ZEROS TO CR-LFPRM-CALC-ALT.                       00000102
  7198                                                                  00000103
  7199     IF    CR-LF-NSP-PRM  NUMERIC                                 00000104
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 149
* ECS150.cbl (/apps/prod/cid1p/copy/ECSRTPFM)
  7200           NEXT SENTENCE                                          00000105
  7201        ELSE                                                      00000106
  7202           MOVE ZEROS TO CR-LF-NSP-PRM.                           00000107
  7203                                                                  00000108
  7204     COMPUTE RS-R-LB = CR-LFAMT + CR-LFAMT-ALT.                   ECSRTPFM
  7205     COMPUTE RS-R-LP = CR-LFPRM + CR-LFPRM-ALT.                   ECSRTPFM
  7206     IF RE-NSP-ST-CD-LF = ZEROS  OR  SPACES                       ECSRTPFM
  7207         COMPUTE RS-R-LPC = CR-LFPRM-CALC + CR-LFPRM-CALC-ALT     ECSRTPFM
  7208     ELSE                                                         ECSRTPFM
  7209         MOVE CR-LF-NSP-PRM         TO RS-R-LPC.                  ECSRTPFM
  7210     MOVE RS-R-LPC                  TO REIN-CALCED-LIFE.          ECSRTPFM
  7211                                                                  ECSRTPFM
  7212     MOVE CR-AHAMT                  TO RS-R-AB.                   ECSRTPFM
  7213     MOVE CR-AHPRM                  TO RS-R-AP.                   ECSRTPFM
  7214     IF RE-NSP-ST-CD-AH = ZEROS  OR  SPACES                       ECSRTPFM
  7215         MOVE CR-AHPRM-CALC         TO RS-R-APC                   ECSRTPFM
  7216     ELSE                                                         ECSRTPFM
  7217         MOVE CR-AH-NSP-PRM         TO RS-R-APC.                  ECSRTPFM
  7218     MOVE RS-R-APC                  TO REIN-CALCED-AH.            ECSRTPFM
  7219                                                                  ECSRTPFM
  7220     PERFORM REINSURE-CALC THRU REINSURE-CALC-X                   ECSRTPFM
  7221         VARYING SUB1 FROM +1 BY +1                               ECSRTPFM
  7222             UNTIL RE-REI-COMP-NO (SUB1) = SPACES.                ECSRTPFM
  7223                                                                  ECSRTPFM
  7224
  7225 REINSURE-ROUTINE-SKIP-1.
  7226     PERFORM REINSURE-CANCEL THRU REINSURE-CANCEL-X.
  7227     PERFORM REINSURE-CLAIM THRU REINSURE-CLAIM-X.
  7228     MOVE SPACES                 TO RC-REC.
  7229     MOVE CR-FULL-CONTROL        TO RC-CMCTL.
  7230     MOVE CR-LFAMT               TO RC-ORIG-LFAMT.
  7231     MOVE CR-LFAMT-ALT           TO RC-LFAMT-ALT.
  7232     MOVE CR-LF-TERM             TO RC-LF-TERM.
  7233     MOVE CR-LF-TERM-IN-DAYS     TO RC-LF-TERM-IN-DAYS.
  7234     MOVE CR-AH-TERM             TO RC-AH-TERM.
  7235     MOVE CR-ENTRY-STATUS        TO RC-ENTRY-STATUS.
  7236     MOVE CR-LF-CURRENT-STATUS   TO RC-LF-CURRENT-STATUS.
  7237     MOVE CR-AH-CURRENT-STATUS   TO RC-AH-CURRENT-STATUS.
  7238     MOVE CR-LFTYP               TO RC-LFTYP.
  7239     MOVE CR-AHTYP               TO RC-AHTYP.
  7240     MOVE CR-IND-GRP             TO RC-IND-GRP.
  7241     MOVE CR-LF-CANC-DT          TO RC-LF-CANC-DT.
  7242     MOVE CR-AH-CANC-DT          TO RC-AH-CANC-DT.
  7243     MOVE CR-DIS-DT              TO RC-DIS-DT.
  7244     MOVE CR-ENTRY-DATE          TO RC-ENT-DT.
  7245     MOVE CR-LF-status-at-cancel TO RC-LF-cancel-status
  7246     MOVE CR-ah-status-at-cancel TO RC-ah-cancel-status
  7247     MOVE CR-LF-CANCEL-EXIT-DATE TO RC-LF-CANC-EXIT.
  7248     MOVE CR-AH-CANCEL-EXIT-DATE TO RC-AH-CANC-EXIT.
  7249     MOVE CR-LF-CLAIM-EXIT-DATE  TO RC-LF-CLAIM-EXIT.
  7250     MOVE CR-AH-SETTLEMENT-EXIT-DATE
  7251                                 TO RC-AH-CLAIM-EXIT.
  7252     MOVE CR-PMT-FREQ            TO RC-PMT-FREQ.
  7253     MOVE CR-APR                 TO RC-APR.
  7254     MOVE CR-LOAN-TERM           TO RC-LOAN-TERM.
  7255     MOVE CR-IND-GRP             TO RC-IND-GRP.
  7256     MOVE CR-LIVES               TO RC-I-LIVES.
  7257     MOVE CR-SUM-CAN-CNT-YTD     TO RC-C-LIVES-YTD.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 150
* ECS150.cbl
  7258     MOVE CR-SUM-CAN-CNT-ITD     TO RC-C-LIVES-ITD.
  7259     MOVE CR-LFRFND-CALC         TO RC-LFRFND-YTD.
  7260     MOVE CR-AHRFND-CALC         TO RC-AHRFND-YTD.
  7261     MOVE CR-LF-EXPIRE-DATE      TO RC-LF-EXPIRE-DT.
  7262     MOVE CR-AH-EXPIRE-DATE      TO RC-AH-EXPIRE-DT.
  7263     MOVE CR-LOAN-1ST-PMT-DT     TO RC-LOAN-1ST-PMT-DT.
  7264     MOVE RC-REC                 TO SAVE-REINS-CERT.
  7265     GO TO 6000-EXIT.
  7266
  7267 RR-READ-REIN.
  7268     IF REIN-OPEN-SW = ' '
  7269         MOVE LOW-VALUES         TO RE-KEY
  7270         MOVE 'X'                TO REIN-OPEN-SW
  7271         MOVE 'A'                TO REIN-SRCH-CODE
  7272         OPEN INPUT ERRTBL-IN
  7273         IF ERRTBL-FILE-STATUS = '00' OR '97'
  7274             PERFORM REIN-CO-TABLE-BUILD THRU REIN-BUILD-EXIT
  7275          ELSE
  7276             MOVE '21'           TO ABEND-FILE-ID
  7277             MOVE ERRTBL-FILE-STATUS
  7278                                 TO ABEND-REASON
  7279             GO TO ABEND-PGM.
  7280
  7281     IF REIN-SRCH NOT = SAVE-REIN-SRCH
  7282         MOVE LOW-VALUES         TO RE-KEY
  7283         MOVE DTE-CLASIC-COMPANY-CD
  7284                                 TO RE-COMPANY-CD
  7285         MOVE REIN-SRCH          TO SAVE-REIN-SRCH
  7286                                    RE-TABLE
  7287         MOVE REIN-SRCH-CODE     TO RE-CODE
  7288         READ ERRTBL-IN
  7289         IF ERRTBL-FILE-STATUS NOT = '00'
  7290             DISPLAY 'INVALID REINSURANCE TABLE CODE - '
  7291                 RE-TABLE ' ' CR-ACCT-CONTROL
  7292             MOVE '24'            TO ABEND-FILE-ID
  7293             MOVE ERRTBL-FILE-STATUS
  7294                                 TO ABEND-REASON
  7295             GO TO ABEND-PGM.
  7296
  7297     IF RE-CODE NOT = 'A'
  7298        PERFORM REIN-DATE-LOAD.
  7299
  7300 RR-READ-REIN-X.
  7301     EXIT.
  7302
  7303 REINSURE-CANCEL.
  7304     IF REIN-COMP (1) = SPACES
  7305         GO TO REINSURE-CANCEL-X.
  7306
  7307     IF CR-LFRFND = ZERO AND
  7308        CR-AHRFND = ZERO
  7309         GO TO REINSURE-CANCEL-X.
  7310
  7311     PERFORM REINSURE-CALC-CANCEL
  7312             THRU REINSURE-CALC-CANCEL-X
  7313                 VARYING SUB1 FROM +1 BY +1
  7314                     UNTIL REIN-COMP (SUB1) = SPACES.
  7315
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 151
* ECS150.cbl
  7316 REINSURE-CANCEL-X.
  7317     EXIT.
  7318
  7319 REINSURE-CLAIM.
  7320     IF REIN-COMP (1) = SPACES
  7321         GO TO REINSURE-CLAIM-X.
  7322
  7323     MOVE CR-DTHAMT-YTD          TO RW-LFCLMWK.
  7324     MOVE CR-DISAMT-YTD          TO RW-AHCLMWK.
  7325     MOVE +0                     TO RW-LFCLM
  7326                                    RW-AHCLM.
  7327
  7328     IF RW-LFCLMWK = ZERO AND
  7329        RW-AHCLMWK = ZERO
  7330         GO TO REINSURE-CLAIM-X.
  7331
  7332     PERFORM REINSURE-CALC-CLAIM
  7333             THRU REINSURE-CALC-CLAIM-X
  7334                 VARYING SUB1 FROM +1 BY +1
  7335                     UNTIL REIN-COMP (SUB1) = SPACES.
  7336
  7337 REINSURE-CLAIM-X.
  7338     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 152
* ECS150.cbl
  7340
  7341 REINSURANCE-ROUTINES.
* 7342                             COPY ECSRIRTN.
  7343******************************************************************04/30/98
  7344*                                                                *ECSRIRTN
  7345*                            ECSRIRTN                            *   LV012
  7346*                            VMOD=2.025.                         *ECSRIRTN
  7347*                                                                *ECSRIRTN
  7348******************************************************************ECSRIRTN
  7349******************************************************************
  7350*                   C H A N G E   L O G
  7351*
  7352* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7353*-----------------------------------------------------------------
  7354*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7355* EFFECTIVE    NUMBER
  7356*-----------------------------------------------------------------
  7357* 062703                   PEMA  ADD DCC CLIENT ID TO
  7358*                                SPECIAL CEDED CLAIM CALC
  7359* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  7360* 052114  CR2014051900001  PEMA  ADD ROUNDING TO PREM TAX CALC
  7361                                                                  ECSRIRTN
  7362 REINSURE-CALC.                                                   ECSRIRTN
  7363                                                                  ECSRIRTN
  7364     MOVE RE-REI-COMP-NO (SUB1) TO REIN-COMP (SUB1).              ECSRIRTN
  7365     MOVE REIN-WORK-FLDS (SUB1) TO RWF-FIELDS.                    ECSRIRTN
  7366     MOVE RE-COMP-INFO (SUB1)   TO WT-COMP-INFO.                  ECSRIRTN
  7367     MOVE WT-REMAINING          TO RWF-REM-SW                     ECSRIRTN
  7368                                   REIN-REM-SW (SUB1).            ECSRIRTN
  7369                                                                  ECSRIRTN
  7370     MOVE ZEROS                 TO RWF-EP-STOP-DATE               ECSRIRTN
  7371                                   WS-RWF-EP-STOP-DATE-N             CL*12
  7372                                   REIN-EP-STOP-DATE (SUB1).      ECSRIRTN
  7373                                                                  ECSRIRTN
  7374     MOVE 'Y'                   TO RWF-LF-RUNOFF-SW               ECSRIRTN
  7375                                   REIN-LF-RUNOFF-SW (SUB1)       ECSRIRTN
  7376                                   RWF-AH-RUNOFF-SW               ECSRIRTN
  7377                                   REIN-AH-RUNOFF-SW (SUB1).      ECSRIRTN
  7378                                                                  ECSRIRTN
  7379     PERFORM REIN-FIND-CO-LOOP THRU FIND-REI-CO-EXIT              ECSRIRTN
  7380        VARYING CO-SUB FROM 1 BY 1 UNTIL                          ECSRIRTN
  7381          (RCT-REIN-CO (CO-SUB) = REIN-COMP (SUB1))  OR           ECSRIRTN
  7382          (CO-SUB GREATER REIN-CO-TABLE-ENT-CNT)     OR           ECSRIRTN
  7383          (RCT-REIN-CO (CO-SUB) = SPACES).                        ECSRIRTN
  7384                                                                  ECSRIRTN
  7385     IF (CO-SUB GREATER REIN-CO-TABLE-ENT-CNT)  OR                ECSRIRTN
  7386        (RCT-REIN-CO (CO-SUB) = SPACES)                           ECSRIRTN
  7387         GO TO CALC-CONTINUED.                                    ECSRIRTN
  7388                                                                  ECSRIRTN
  7389     MOVE RCT-EARNING-STOP-DT (CO-SUB) TO RWF-EP-STOP-DATE        ECSRIRTN
  7390                                          WS-RWF-EP-STOP-DATE-N      CL*12
  7391                                          REIN-EP-STOP-DATE (SUB1)ECSRIRTN
  7392                                                                  ECSRIRTN
  7393     IF RWF-EP-STOP-DATE = ZEROS                                  ECSRIRTN
  7394         GO TO CALC-CONTINUED.                                    ECSRIRTN
  7395                                                                  ECSRIRTN
  7396     IF RCT-EARN-STOP-CODE (CO-SUB) = 'L'  OR  'B'                ECSRIRTN
  7397         MOVE 'N'               TO RWF-LF-RUNOFF-SW               ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 153
* ECS150.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
  7398                                   REIN-LF-RUNOFF-SW (SUB1).      ECSRIRTN
  7399                                                                  ECSRIRTN
  7400     IF RCT-EARN-STOP-CODE (CO-SUB) = 'A'  OR  'B'                ECSRIRTN
  7401         MOVE 'N'               TO RWF-AH-RUNOFF-SW               ECSRIRTN
  7402                                   REIN-AH-RUNOFF-SW (SUB1).      ECSRIRTN
  7403                                                                  ECSRIRTN
  7404 CALC-CONTINUED.                                                  ECSRIRTN
  7405                                                                  ECSRIRTN
  7406     COMPUTE RS-LIFE-BEN  = CR-LFAMT + CR-LFAMT-ALT.              ECSRIRTN
  7407     COMPUTE RS-LIFE-PREM = CR-LFPRM + CR-LFPRM-ALT.              ECSRIRTN
  7408                                                                  ECSRIRTN
  7409     IF RE-NSP-ST-CD-LF = ZEROS  OR  SPACES                       ECSRIRTN
  7410         COMPUTE RS-LP-CALC = CR-LFPRM-CALC + CR-LFPRM-CALC-ALT   ECSRIRTN
  7411     ELSE                                                         ECSRIRTN
  7412         MOVE CR-LF-NSP-PRM         TO RS-LP-CALC.                ECSRIRTN
  7413     MOVE RS-LP-CALC                TO REIN-CALCED-LIFE.          ECSRIRTN
  7414                                                                  ECSRIRTN
  7415     MOVE CR-AHAMT                  TO RS-AH-BEN.                 ECSRIRTN
  7416     MOVE CR-AHPRM                  TO RS-AH-PREM.                ECSRIRTN
  7417     IF RE-NSP-ST-CD-AH = ZEROS  OR  SPACES                       ECSRIRTN
  7418         MOVE CR-AHPRM-CALC         TO RS-AP-CALC                 ECSRIRTN
  7419     ELSE                                                         ECSRIRTN
  7420         MOVE CR-AH-NSP-PRM         TO RS-AP-CALC.                ECSRIRTN
  7421     MOVE RS-AP-CALC                TO REIN-CALCED-AH.            ECSRIRTN
  7422                                                                  ECSRIRTN
  7423     IF WT-REMAINING = 'Y' OR 'Z' OR 'L' OR 'R'                   ECSRIRTN
  7424         MOVE RS-R-LB               TO RS-LIFE-BEN                ECSRIRTN
  7425         MOVE RS-R-LP               TO RS-LIFE-PREM               ECSRIRTN
  7426         MOVE RS-R-LPC              TO RS-LP-CALC                 ECSRIRTN
  7427         MOVE RS-R-AB               TO RS-AH-BEN                  ECSRIRTN
  7428         MOVE RS-R-AP               TO RS-AH-PREM                 ECSRIRTN
  7429         MOVE RS-R-APC              TO RS-AP-CALC.                ECSRIRTN
  7430                                                                  ECSRIRTN
  7431     IF SUB1 = RE-100-COMP                                        ECSRIRTN
  7432         GO TO REINSURE-CALC-REMAINDER.                           ECSRIRTN
  7433                                                                  ECSRIRTN
  7434     IF CR-DT LESS WT-LO-DATE                                        CL**2
  7435         GO TO REINSURE-CALC-X.                                   ECSRIRTN
  7436                                                                  ECSRIRTN
  7437     IF CR-DT NOT LESS WT-HI-DATE                                    CL**2
  7438         GO TO REINSURE-CALC-X.                                   ECSRIRTN
  7439                                                                  ECSRIRTN
  7440     PERFORM REINSURE-CK-LIFE      THRU REINSURE-CK-LIFE-X.       ECSRIRTN
  7441     PERFORM REINSURE-CK-AH        THRU REINSURE-CK-AH-X.         ECSRIRTN
  7442                                                                  ECSRIRTN
  7443     IF WT-INTERACTIVE = 'E'                                      ECSRIRTN
  7444         PERFORM REIN-CHECK-INTERACT-E THRU REIN-INTERACT-CHECK-X.ECSRIRTN
  7445                                                                  ECSRIRTN
  7446     IF WT-INTERACTIVE = 'X'                                      ECSRIRTN
  7447       IF  (REIN-LF-FLG (SUB1) = 'X' AND REIN-AH-FLG (SUB1) = 'X')ECSRIRTN
  7448        OR (REIN-LF-FLG (SUB1) = 'X' AND REIN-AH-FLG (SUB1) = ' ')ECSRIRTN
  7449        OR (REIN-LF-FLG (SUB1) = ' ' AND REIN-AH-FLG (SUB1) = 'X')ECSRIRTN
  7450           NEXT SENTENCE                                          ECSRIRTN
  7451       ELSE                                                       ECSRIRTN
  7452           MOVE 'Y' TO REIN-LF-FLG (SUB1)                         ECSRIRTN
  7453                       REIN-AH-FLG (SUB1).                        ECSRIRTN
  7454                                                                  ECSRIRTN
  7455     IF WT-INTERACTIVE = 'Y'                                      ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 154
* ECS150.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
  7456         IF REIN-LF-FLG (SUB1) = 'X' AND                          ECSRIRTN
  7457            REIN-AH-FLG (SUB1) = 'Y'                              ECSRIRTN
  7458             MOVE 'X' TO REIN-AH-FLG (SUB1).                      ECSRIRTN
  7459                                                                  ECSRIRTN
  7460     IF WT-INTERACTIVE = 'Y'                                      ECSRIRTN
  7461         IF REIN-AH-FLG (SUB1) = 'X' AND                          ECSRIRTN
  7462            REIN-LF-FLG (SUB1) = 'Y'                              ECSRIRTN
  7463             MOVE 'X' TO REIN-LF-FLG (SUB1).                      ECSRIRTN
  7464                                                                  ECSRIRTN
  7465     IF WT-INTERACTIVE = 'Z'                                      ECSRIRTN
  7466         IF REIN-LF-FLG (SUB1) = 'X'                              ECSRIRTN
  7467             IF REIN-AH-FLG (SUB1) = 'Y'                          ECSRIRTN
  7468                 MOVE 'X' TO REIN-AH-FLG (SUB1)                   ECSRIRTN
  7469             ELSE                                                 ECSRIRTN
  7470                 NEXT SENTENCE                                    ECSRIRTN
  7471         ELSE                                                     ECSRIRTN
  7472             MOVE 'Y' TO REIN-LF-FLG (SUB1)                       ECSRIRTN
  7473                         REIN-AH-FLG (SUB1).                      ECSRIRTN
  7474                                                                  ECSRIRTN
  7475     IF WT-INTERACTIVE = 'W'                                      ECSRIRTN
  7476         IF REIN-AH-FLG (SUB1) = 'X'                              ECSRIRTN
  7477             IF REIN-LF-FLG (SUB1) = 'Y'                          ECSRIRTN
  7478                 MOVE 'X' TO REIN-LF-FLG (SUB1)                   ECSRIRTN
  7479             ELSE                                                 ECSRIRTN
  7480                 NEXT SENTENCE                                    ECSRIRTN
  7481         ELSE                                                     ECSRIRTN
  7482             MOVE 'Y' TO REIN-LF-FLG (SUB1)                       ECSRIRTN
  7483                         REIN-AH-FLG (SUB1).                      ECSRIRTN
  7484                                                                  ECSRIRTN
  7485     IF REIN-LF-FLG (SUB1) = 'X'                                  ECSRIRTN
  7486         PERFORM REIN-CALC-LIFE THRU REIN-CALC-LIFE-X.            ECSRIRTN
  7487                                                                  ECSRIRTN
  7488     IF REIN-LF-FLG (SUB1) = 'E'                                  ECSRIRTN
  7489         PERFORM REIN-LF-SKIP-LIMIT THRU REIN-CALC-LIFE-X         ECSRIRTN
  7490         MOVE 'X' TO REIN-LF-FLG (SUB1).                          ECSRIRTN
  7491                                                                  ECSRIRTN
  7492     IF REIN-AH-FLG (SUB1) = 'X'                                  ECSRIRTN
  7493         PERFORM REIN-CALC-AH THRU REIN-CALC-AH-X.                ECSRIRTN
  7494                                                                  ECSRIRTN
  7495     IF REIN-AH-FLG (SUB1) = 'E'                                  ECSRIRTN
  7496         PERFORM REIN-AH-SKIP-LIMIT THRU REIN-CALC-AH-X           ECSRIRTN
  7497         MOVE 'X'                TO  REIN-AH-FLG (SUB1).          ECSRIRTN
  7498                                                                  ECSRIRTN
  7499     IF REIN-LF-FLG (SUB1) NOT = 'X'                              ECSRIRTN
  7500         MOVE SPACE TO REIN-LF-FLG (SUB1).                        ECSRIRTN
  7501                                                                  ECSRIRTN
  7502     IF REIN-AH-FLG (SUB1) NOT = 'X'                              ECSRIRTN
  7503         MOVE SPACE TO REIN-AH-FLG (SUB1).                        ECSRIRTN
  7504                                                                  ECSRIRTN
  7505     GO TO REINSURE-CALC-X.                                       ECSRIRTN
  7506                                                                  ECSRIRTN
  7507 REINSURE-CK-LIFE.                                                ECSRIRTN
  7508                                                                  ECSRIRTN
  7509     IF CR-LFTYP = ZERO                                           ECSRIRTN
  7510         GO TO REINSURE-CK-LIFE-X.                                ECSRIRTN
  7511                                                                  ECSRIRTN
  7512     IF WT-LF-PCT = ZERO                                          ECSRIRTN
  7513         GO TO REINSURE-CK-LIFE-X.                                ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 155
* ECS150.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
  7514                                                                  ECSRIRTN
  7515     IF DTE-CLIENT = 'CSO' OR 'CSI'                               ECSRIRTN
  7516         IF CLAS-I-REIN-YN (CLAS-INDEXL) = 'N'                    ECSRIRTN
  7517             GO TO REINSURE-CK-LIFE-X.                            ECSRIRTN
  7518                                                                  ECSRIRTN
  7519     MOVE WT-LF-BEN-CODE                TO REIN-BEN-CODE.         ECSRIRTN
  7520                                                                  ECSRIRTN
  7521     IF CEDING-PROPERTY-ONLY                                      ECSRIRTN
  7522         IF CLAS-I-CALC-TYPE (CLAS-INDEXL) NOT = '2'              ECSRIRTN
  7523             GO TO REINSURE-CK-LIFE-X                             ECSRIRTN
  7524         ELSE                                                     ECSRIRTN
  7525             NEXT SENTENCE                                        ECSRIRTN
  7526     ELSE                                                         ECSRIRTN
  7527         IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = '2'                  ECSRIRTN
  7528             GO TO REINSURE-CK-LIFE-X.                            ECSRIRTN
  7529                                                                  ECSRIRTN
  7530     IF CEDING-AD-D-ONLY                                          ECSRIRTN
  7531         IF CLAS-I-CALC-TYPE (CLAS-INDEXL) NOT = '4'              ECSRIRTN
  7532             GO TO REINSURE-CK-LIFE-X                             ECSRIRTN
  7533         ELSE                                                     ECSRIRTN
  7534             NEXT SENTENCE                                        ECSRIRTN
  7535     ELSE                                                         ECSRIRTN
  7536         IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = '4'                  ECSRIRTN
  7537             GO TO REINSURE-CK-LIFE-X.                            ECSRIRTN
  7538                                                                  ECSRIRTN
  7539     IF CEDING-SINGLE-PREM-ONLY                                   ECSRIRTN
  7540         IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'B'                  ECSRIRTN
  7541             GO TO REINSURE-CK-LIFE-X.                            ECSRIRTN
  7542                                                                  ECSRIRTN
  7543     IF CEDING-OUT-BALANCE-ONLY                                   ECSRIRTN
  7544         IF CLAS-I-CALC-TYPE (CLAS-INDEXL) NOT = 'B'              ECSRIRTN
  7545            GO TO REINSURE-CK-LIFE-X.                             ECSRIRTN
  7546                                                                  ECSRIRTN
  7547     IF CEDING-REDUCING-ONLY                                      ECSRIRTN
  7548         IF CLAS-I-RL-AH (CLAS-INDEXL) = 'L' OR 'P'               ECSRIRTN
  7549             GO TO REINSURE-CK-LIFE-X.                            ECSRIRTN
  7550                                                                  ECSRIRTN
  7551     IF CEDING-LEVEL-ONLY                                         ECSRIRTN
  7552         IF CLAS-I-RL-AH (CLAS-INDEXL) = 'R'                      ECSRIRTN
  7553            GO TO REINSURE-CK-LIFE-X.                             ECSRIRTN
  7554                                                                  ECSRIRTN
  7555     IF CEDING-GROUP-ONLY                                         ECSRIRTN
  7556         IF CR-IND-GRP NOT = '2'                                  ECSRIRTN
  7557             GO TO REINSURE-CK-LIFE-X.                            ECSRIRTN
  7558                                                                  ECSRIRTN
  7559     IF CEDING-GROUP-RED-LIFE-ONLY                                ECSRIRTN
  7560         IF (CR-IND-GRP = '1')  OR                                ECSRIRTN
  7561            (CLAS-I-RL-AH (CLAS-INDEXL) = 'L' OR 'P') OR          ECSRIRTN
  7562            (CR-AHTYP NOT = ZERO)                                 ECSRIRTN
  7563             GO TO REINSURE-CK-LIFE-X.                            ECSRIRTN
  7564                                                                  ECSRIRTN
  7565     IF CEDING-GROUP-REDUCING-ONLY                                ECSRIRTN
  7566         IF (CR-IND-GRP = '1')  OR                                ECSRIRTN
  7567            (CLAS-I-RL-AH (CLAS-INDEXL) = 'L' OR 'P')             ECSRIRTN
  7568             GO TO REINSURE-CK-LIFE-X.                            ECSRIRTN
  7569                                                                  ECSRIRTN
  7570     IF CEDING-INDIVIDUAL-ONLY                                    ECSRIRTN
  7571         IF CR-IND-GRP NOT = '1'                                  ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 156
* ECS150.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
  7572             GO TO REINSURE-CK-LIFE-X.                            ECSRIRTN
  7573                                                                  ECSRIRTN
  7574     IF CEDING-JOINT-ONLY                                         ECSRIRTN
  7575         IF CLAS-I-JOINT (CLAS-INDEXL) NOT = 'J'                  ECSRIRTN
  7576             GO TO REINSURE-CK-LIFE-X.                            ECSRIRTN
  7577                                                                  ECSRIRTN
  7578     IF CEDING-SGL-PREM-REDUCING                                  ECSRIRTN
  7579        IF (CLAS-I-RL-AH (CLAS-INDEXL) = 'L' OR 'P')  OR          ECSRIRTN
  7580           CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'B'                   ECSRIRTN
  7581            GO TO REINSURE-CK-LIFE-X.                             ECSRIRTN
  7582                                                                  ECSRIRTN
  7583     IF CEDING-SGL-PREM-GROUP                                     ECSRIRTN
  7584         IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'B'  OR              ECSRIRTN
  7585            CR-IND-GRP = '1'                                      ECSRIRTN
  7586             GO TO REINSURE-CK-LIFE-X.                            ECSRIRTN
  7587                                                                  ECSRIRTN
  7588     IF CEDING-GROUP-LEVEL-ONLY                                   ECSRIRTN
  7589         IF CLAS-I-RL-AH (CLAS-INDEXL) = 'R'  OR                  ECSRIRTN
  7590            CR-IND-GRP = '1'                                      ECSRIRTN
  7591             GO TO REINSURE-CK-LIFE-X.                            ECSRIRTN
  7592                                                                  ECSRIRTN
  7593     IF CEDING-SGL-PREM-GRP-REDUCING                              ECSRIRTN
  7594         IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'B'  OR              ECSRIRTN
  7595            (CLAS-I-RL-AH (CLAS-INDEXL) = 'L' OR 'P')  OR         ECSRIRTN
  7596            CR-IND-GRP = '1'                                      ECSRIRTN
  7597             GO TO REINSURE-CK-LIFE-X.                            ECSRIRTN
  7598                                                                  ECSRIRTN
  7599     IF CEDING-SGL-PREM-GROUP-LEVEL                               ECSRIRTN
  7600         IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'B'  OR              ECSRIRTN
  7601            CLAS-I-RL-AH (CLAS-INDEXL) = 'R'  OR                  ECSRIRTN
  7602            CR-IND-GRP = '1'                                      ECSRIRTN
  7603             GO TO REINSURE-CK-LIFE-X.                            ECSRIRTN
  7604                                                                  ECSRIRTN
  7605     IF CEDING-SINGLE-POLICIES-ONLY                               ECSRIRTN
  7606         IF CLAS-I-JOINT (CLAS-INDEXL) = 'J'                      ECSRIRTN
  7607            GO TO REINSURE-CK-LIFE-X.                             ECSRIRTN
  7608                                                                  ECSRIRTN
  7609     IF DTE-CLIENT EQUAL 'NCL'                                    ECSRIRTN
  7610        MOVE 'Y'                 TO REIN-LF-FLG (SUB1).           ECSRIRTN
  7611                                                                  ECSRIRTN
  7612     IF CR-AGE LESS WT-LFAGE-LO                                   ECSRIRTN
  7613         GO TO REINSURE-CK-LIFE-X.                                ECSRIRTN
  7614                                                                  ECSRIRTN
  7615     IF CR-AGE GREATER WT-LFAGE-HI                                ECSRIRTN
  7616         GO TO REINSURE-CK-LIFE-X.                                ECSRIRTN
  7617                                                                  ECSRIRTN
  7618     IF CR-LF-TERM  NUMERIC                                       00002331
  7619        NEXT SENTENCE                                             00002332
  7620     ELSE                                                         00002333
  7621        MOVE ZEROS               TO CR-LF-TERM                    00002334
  7622     END-IF
  7623                                                                  00002335
  7624     IF CR-LF-TERM LESS WT-LFTRM-LO                               ECSRIRTN
  7625         GO TO REINSURE-CK-LIFE-X.                                ECSRIRTN
  7626                                                                  ECSRIRTN
  7627     IF CR-LF-TERM GREATER WT-LFTRM-HI                            ECSRIRTN
  7628         GO TO REINSURE-CK-LIFE-X.                                ECSRIRTN
  7629                                                                  ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 157
* ECS150.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
  7630     MOVE 'Y' TO REIN-LF-FLG (SUB1).                              ECSRIRTN
  7631                                                                  ECSRIRTN
  7632     IF RS-LIFE-BEN NOT GREATER WT-LF-LIM-LO                      ECSRIRTN
  7633         GO TO REINSURE-CK-LIFE-X.                                ECSRIRTN
  7634                                                                  ECSRIRTN
  7635     IF RS-LIFE-BEN GREATER WT-LF-LIM-HI                          ECSRIRTN
  7636         GO TO REINSURE-CK-LIFE-X.                                ECSRIRTN
  7637                                                                  ECSRIRTN
  7638     MOVE 'X' TO REIN-LF-FLG (SUB1).                              ECSRIRTN
  7639                                                                  ECSRIRTN
  7640 REINSURE-CK-LIFE-X.                                              ECSRIRTN
  7641     EXIT.                                                        ECSRIRTN
  7642                                                                  ECSRIRTN
  7643 REINSURE-CK-AH.                                                  ECSRIRTN
  7644                                                                  ECSRIRTN
  7645     IF CR-AHTYP = ZERO                                           ECSRIRTN
  7646         GO TO REINSURE-CK-AH-X.                                  ECSRIRTN
  7647                                                                  ECSRIRTN
  7648     IF WT-AH-PCT = ZERO                                          ECSRIRTN
  7649         GO TO REINSURE-CK-AH-X.                                  ECSRIRTN
  7650                                                                  ECSRIRTN
  7651     IF DTE-CLIENT = 'CSO' OR 'CSI'                               ECSRIRTN
  7652         IF CLAS-I-REIN-YN (CLAS-INDEXA) = 'N'                    ECSRIRTN
  7653             GO TO REINSURE-CK-AH-X.                              ECSRIRTN
  7654                                                                  ECSRIRTN
  7655     MOVE WT-AH-BEN-CODE                TO REIN-BEN-CODE.         ECSRIRTN
  7656                                                                  ECSRIRTN
  7657     IF CEDING-UNEMPLOYMENT-ONLY                                  ECSRIRTN
  7658         IF CLAS-I-CALC-TYPE (CLAS-INDEXA) NOT = '3'              ECSRIRTN
  7659             GO TO REINSURE-CK-AH-X                               ECSRIRTN
  7660         ELSE                                                     ECSRIRTN
  7661             NEXT SENTENCE                                        ECSRIRTN
  7662     ELSE                                                         ECSRIRTN
  7663         IF CLAS-I-CALC-TYPE (CLAS-INDEXA) = '3'                  ECSRIRTN
  7664             GO TO REINSURE-CK-AH-X.                              ECSRIRTN
  7665                                                                  ECSRIRTN
  7666     IF CEDING-SINGLE-PREM-ONLY                                   ECSRIRTN
  7667         IF CLAS-I-CALC-TYPE (CLAS-INDEXA) = 'B'                  ECSRIRTN
  7668             GO TO REINSURE-CK-AH-X.                              ECSRIRTN
  7669                                                                  ECSRIRTN
  7670     IF CEDING-JOINT-ONLY                                         ECSRIRTN
  7671         IF CLAS-I-JOINT (CLAS-INDEXA) NOT = 'J'                  ECSRIRTN
  7672             GO TO REINSURE-CK-AH-X.                              ECSRIRTN
  7673                                                                  ECSRIRTN
  7674     IF CEDING-OUT-BALANCE-ONLY                                   ECSRIRTN
  7675         IF CLAS-I-CALC-TYPE (CLAS-INDEXA) NOT = 'B'              ECSRIRTN
  7676             GO TO REINSURE-CK-AH-X.                              ECSRIRTN
  7677                                                                  ECSRIRTN
  7678     IF CEDING-GROUP-ONLY                                         ECSRIRTN
  7679         IF CR-IND-GRP NOT = '2'                                  ECSRIRTN
  7680             GO TO REINSURE-CK-AH-X.                              ECSRIRTN
  7681                                                                  ECSRIRTN
  7682     IF CEDING-SGL-PREM-GROUP                                     ECSRIRTN
  7683         IF CLAS-I-CALC-TYPE (CLAS-INDEXA) = 'B'  OR              ECSRIRTN
  7684            CR-IND-GRP = '1'                                      ECSRIRTN
  7685             GO TO REINSURE-CK-AH-X.                              ECSRIRTN
  7686                                                                  ECSRIRTN
  7687     IF CEDING-INDIVIDUAL-ONLY                                    ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 158
* ECS150.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
  7688         IF CR-IND-GRP NOT = '1'                                  ECSRIRTN
  7689             GO TO REINSURE-CK-AH-X.                              ECSRIRTN
  7690                                                                  ECSRIRTN
  7691     IF CEDING-SINGLE-POLICIES-ONLY                               ECSRIRTN
  7692         IF CLAS-I-JOINT (CLAS-INDEXA) = 'J'                      ECSRIRTN
  7693            GO TO REINSURE-CK-AH-X.                               ECSRIRTN
  7694                                                                  ECSRIRTN
  7695     IF CEDING-7-DAY-RETRO                                        ECSRIRTN
  7696         IF CLAS-I-AB3 (CLAS-INDEXA) NOT = (' 7R'  AND  '07R')    ECSRIRTN
  7697            GO TO REINSURE-CK-AH-X.                               ECSRIRTN
  7698                                                                  ECSRIRTN
  7699     IF CEDING-14-DAY-RETRO                                       ECSRIRTN
  7700         IF CLAS-I-AB3 (CLAS-INDEXA) NOT = '14R'                  ECSRIRTN
  7701             GO TO REINSURE-CK-AH-X.                              ECSRIRTN
  7702                                                                  ECSRIRTN
  7703     IF DTE-CLIENT EQUAL 'NCL'                                    ECSRIRTN
  7704        MOVE 'Y'                 TO REIN-AH-FLG (SUB1).           ECSRIRTN
  7705                                                                  ECSRIRTN
  7706     IF CR-AGE LESS WT-AHAGE-LO                                   ECSRIRTN
  7707         GO TO REINSURE-CK-AH-X.                                  ECSRIRTN
  7708                                                                  ECSRIRTN
  7709     IF CR-AGE GREATER WT-AHAGE-HI                                ECSRIRTN
  7710         GO TO REINSURE-CK-AH-X.                                  ECSRIRTN
  7711                                                                  ECSRIRTN
  7712     IF CR-AH-TERM  NUMERIC                                       00002331
  7713        NEXT SENTENCE                                             00002332
  7714     ELSE                                                         00002333
  7715        MOVE ZEROS               TO CR-AH-TERM                    00002334
  7716     END-IF
  7717                                                                  00002335
  7718     IF CR-AH-TERM LESS WT-AHTRM-LO                               ECSRIRTN
  7719         GO TO REINSURE-CK-AH-X.                                  ECSRIRTN
  7720                                                                  ECSRIRTN
  7721     IF CR-AH-TERM GREATER WT-AHTRM-HI                            ECSRIRTN
  7722         GO TO REINSURE-CK-AH-X.                                  ECSRIRTN
  7723                                                                  ECSRIRTN
  7724     MOVE 'Y' TO REIN-AH-FLG (SUB1).                              ECSRIRTN
  7725                                                                  ECSRIRTN
  7726     IF WT-AHBEN-LIM-LO = ZERO                                    ECSRIRTN
  7727         AND WT-AHBEN-LIM-HI = ZERO                               ECSRIRTN
  7728             MOVE +9999999.99 TO WT-AHBEN-LIM-LO                  ECSRIRTN
  7729                                 WT-AHBEN-LIM-HI.                 ECSRIRTN
  7730                                                                  ECSRIRTN
  7731     IF WT-AHMOA-LIM-LO = ZERO                                    ECSRIRTN
  7732         AND WT-AHMOA-LIM-HI = ZERO                               ECSRIRTN
  7733             MOVE +9999999.99 TO WT-AHMOA-LIM-LO                  ECSRIRTN
  7734                                 WT-AHMOA-LIM-HI.                 ECSRIRTN
  7735                                                                  ECSRIRTN
  7736     COMPUTE RW-AHLIM-LO = CR-AH-TERM * WT-AHMOA-LIM-LO.          ECSRIRTN
  7737     COMPUTE RW-AHLIM-HI = CR-AH-TERM * WT-AHMOA-LIM-HI.          ECSRIRTN
  7738                                                                  ECSRIRTN
  7739     IF RW-AHLIM-LO GREATER WT-AHBEN-LIM-LO                       ECSRIRTN
  7740         MOVE WT-AHBEN-LIM-LO TO RW-AHLIM-LO.                     ECSRIRTN
  7741                                                                  ECSRIRTN
  7742     IF RW-AHLIM-HI GREATER WT-AHBEN-LIM-HI                       ECSRIRTN
  7743         MOVE WT-AHBEN-LIM-HI TO RW-AHLIM-HI.                     ECSRIRTN
  7744                                                                  ECSRIRTN
  7745     MOVE RW-AHLIM-LO TO RWF-AH-LIMIT.                            ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 159
* ECS150.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
  7746                                                                  ECSRIRTN
  7747     COMPUTE RW-AHWRK = RS-AH-BEN * CR-AH-TERM.                   ECSRIRTN
  7748                                                                  ECSRIRTN
  7749     IF RW-AHWRK NOT GREATER RW-AHLIM-LO                          ECSRIRTN
  7750         GO TO REINSURE-CK-AH-X.                                  ECSRIRTN
  7751                                                                  ECSRIRTN
  7752     IF RW-AHWRK GREATER RW-AHLIM-HI                              ECSRIRTN
  7753         GO TO REINSURE-CK-AH-X.                                  ECSRIRTN
  7754                                                                  ECSRIRTN
  7755     MOVE 'X' TO REIN-AH-FLG (SUB1).                              ECSRIRTN
  7756                                                                  ECSRIRTN
  7757 REINSURE-CK-AH-X.                                                ECSRIRTN
  7758     EXIT.                                                        ECSRIRTN
  7759                                                                  ECSRIRTN
  7760 REIN-CHECK-INTERACT-E.                                           ECSRIRTN
  7761                                                                  ECSRIRTN
  7762     IF RS-LIFE-BEN = ZERO  OR                                    ECSRIRTN
  7763        RS-AH-BEN = ZERO                                          ECSRIRTN
  7764         GO TO REIN-INTERACT-CHECK-X.                             ECSRIRTN
  7765                                                                  ECSRIRTN
  7766     IF REIN-LF-FLG (SUB1) NOT = 'X'  AND                         ECSRIRTN
  7767        REIN-AH-FLG (SUB1) NOT = 'X'                              ECSRIRTN
  7768         GO TO REIN-INTERACT-CHECK-X.                             ECSRIRTN
  7769                                                                  ECSRIRTN
  7770     MOVE 'X'                    TO REIN-LF-FLG (SUB1)            ECSRIRTN
  7771                                    REIN-AH-FLG (SUB1).           ECSRIRTN
  7772                                                                  ECSRIRTN
  7773     IF WT-AHBEN-LO = ZERO                                        ECSRIRTN
  7774         AND WT-AHBEN-HI = ZERO                                   ECSRIRTN
  7775             MOVE +9999999.99    TO  WT-AHBEN-LO                  ECSRIRTN
  7776                                     WT-AHBEN-HI.                 ECSRIRTN
  7777     IF WT-AHMOA-LO = ZERO                                        ECSRIRTN
  7778         AND WT-AHMOA-HI = ZERO                                   ECSRIRTN
  7779             MOVE +9999999.99    TO  WT-AHMOA-LO                  ECSRIRTN
  7780                                     WT-AHMOA-HI.                 ECSRIRTN
  7781                                                                  ECSRIRTN
  7782     COMPUTE RW-AHLIM-LO = CR-AH-TERM * WT-AHMOA-LO.              ECSRIRTN
  7783     COMPUTE RW-AHLIM-HI = CR-AH-TERM * WT-AHMOA-HI.              ECSRIRTN
  7784                                                                  ECSRIRTN
  7785     IF RW-AHLIM-LO GREATER WT-AHBEN-LO                           ECSRIRTN
  7786         MOVE WT-AHBEN-LO        TO  RW-AHLIM-LO.                 ECSRIRTN
  7787                                                                  ECSRIRTN
  7788     IF RW-AHLIM-HI GREATER WT-AHBEN-HI                           ECSRIRTN
  7789         MOVE WT-AHBEN-HI        TO  RW-AHLIM-HI.                 ECSRIRTN
  7790                                                                  ECSRIRTN
  7791     COMPUTE RW-AHWRK = RS-AH-BEN * CR-AH-TERM.                   ECSRIRTN
  7792                                                                  ECSRIRTN
  7793     IF RW-AHWRK GREATER RW-AHLIM-HI                              ECSRIRTN
  7794         MOVE RW-AHLIM-HI        TO  RW-AHWRK.                    ECSRIRTN
  7795                                                                  ECSRIRTN
  7796     IF RW-AHWRK GREATER RW-AHLIM-LO                              ECSRIRTN
  7797         COMPUTE RATE-WORK-A ROUNDED = (RW-AHWRK - RW-AHLIM-LO)   ECSRIRTN
  7798                                       / RW-AHWRK                 ECSRIRTN
  7799       ELSE                                                       ECSRIRTN
  7800         MOVE ZERO               TO RATE-WORK-A.                  ECSRIRTN
  7801                                                                  ECSRIRTN
  7802     IF RS-LIFE-BEN GREATER WT-LF-LO                              ECSRIRTN
  7803         COMPUTE RATE-WORK-L ROUNDED = (RS-LIFE-BEN - WT-LF-LO)   ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 160
* ECS150.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
  7804                                       / RS-LIFE-BEN              ECSRIRTN
  7805       ELSE                                                       ECSRIRTN
  7806         MOVE ZERO               TO RATE-WORK-L.                  ECSRIRTN
  7807                                                                  ECSRIRTN
  7808     IF (RS-LIFE-BEN GREATER WT-LF-LO) AND                        ECSRIRTN
  7809        (RW-AHWRK NOT GREATER RW-AHLIM-LO)                        ECSRIRTN
  7810          MOVE 'E'               TO REIN-AH-FLG (SUB1)            ECSRIRTN
  7811          COMPUTE RWF-AHAMT ROUNDED = (RW-AHWRK * RATE-WORK-L)    ECSRIRTN
  7812                                      / CR-AH-TERM.               ECSRIRTN
  7813                                                                  ECSRIRTN
  7814     IF (RW-AHWRK GREATER RW-AHLIM-LO) AND                        ECSRIRTN
  7815        (RS-LIFE-BEN NOT GREATER WT-LF-LO)                        ECSRIRTN
  7816          MOVE 'E'               TO REIN-LF-FLG (SUB1)            ECSRIRTN
  7817          IF (RW-AHWRK - RW-AHLIM-LO) NOT GREATER RS-LIFE-BEN     ECSRIRTN
  7818               COMPUTE RWF-LFAMT = RW-AHWRK - RW-AHLIM-LO         ECSRIRTN
  7819            ELSE                                                  ECSRIRTN
  7820                MOVE RS-LIFE-BEN TO RWF-LFAMT.                    ECSRIRTN
  7821                                                                  ECSRIRTN
  7822     IF (RW-AHWRK GREATER RW-AHLIM-LO) AND                        ECSRIRTN
  7823        (RS-LIFE-BEN GREATER WT-LF-LO)                            ECSRIRTN
  7824        IF RATE-WORK-L GREATER RATE-WORK-A                        ECSRIRTN
  7825          MOVE 'E'               TO REIN-AH-FLG (SUB1)            ECSRIRTN
  7826          COMPUTE RWF-AHAMT ROUNDED = (RW-AHWRK * RATE-WORK-L)    ECSRIRTN
  7827                                      / CR-AH-TERM                ECSRIRTN
  7828         ELSE                                                     ECSRIRTN
  7829          MOVE 'E'               TO REIN-LF-FLG (SUB1)            ECSRIRTN
  7830          IF (RW-AHWRK - RW-AHLIM-LO) NOT GREATER RS-LIFE-BEN     ECSRIRTN
  7831               COMPUTE RWF-LFAMT = RW-AHWRK - RW-AHLIM-LO         ECSRIRTN
  7832            ELSE                                                  ECSRIRTN
  7833                MOVE RS-LIFE-BEN TO RWF-LFAMT.                    ECSRIRTN
  7834                                                                  ECSRIRTN
  7835 REIN-INTERACT-CHECK-X.                                           ECSRIRTN
  7836     EXIT.                                                        ECSRIRTN
  7837                                                                  ECSRIRTN
  7838                                                                  ECSRIRTN
  7839 REIN-CALC-LIFE.                                                  ECSRIRTN
  7840                                                                  ECSRIRTN
  7841     IF RS-LIFE-BEN NOT GREATER WT-LF-HI                          ECSRIRTN
  7842         MOVE RS-LIFE-BEN TO RWF-LFAMT                            ECSRIRTN
  7843     ELSE                                                         ECSRIRTN
  7844         MOVE WT-LF-HI TO RWF-LFAMT.                              ECSRIRTN
  7845                                                                  ECSRIRTN
  7846     IF RS-LIFE-BEN LESS WT-LF-LO                                 ECSRIRTN
  7847         MOVE +0 TO RWF-LFAMT                                     ECSRIRTN
  7848     ELSE                                                         ECSRIRTN
  7849         IF WT-REMAINING NOT = 'L'                                ECSRIRTN
  7850           IF RS-LIFE-BEN LESS THAN ZERO                          ECSRIRTN
  7851               COMPUTE RWF-LFAMT ROUNDED = WT-LF-PCT * RS-LIFE-BENECSRIRTN
  7852           ELSE                                                   ECSRIRTN
  7853               COMPUTE RWF-LFAMT ROUNDED = WT-LF-PCT *            ECSRIRTN
  7854                                          (RWF-LFAMT - WT-LF-LO). ECSRIRTN
  7855                                                                  ECSRIRTN
  7856 REIN-LF-SKIP-LIMIT.                                              ECSRIRTN
  7857                                                                  ECSRIRTN
  7858     MOVE +0 TO RW-LFPRM  RW-LFPRMC.                              ECSRIRTN
  7859                                                                  ECSRIRTN
  7860     IF WT-REMAINING = 'I'                                        ECSRIRTN
  7861         GO TO REIN-CALC-LF-RISK-PREM.                            ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 161
* ECS150.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
  7862                                                                  ECSRIRTN
  7863     IF WT-REMAINING = 'L'                                        ECSRIRTN
  7864         COMPUTE RWF-LFPRM ROUNDED = RS-LIFE-PREM * WT-LF-PCT     ECSRIRTN
  7865         GO TO REIN-CALC-LIFE-X.                                  ECSRIRTN
  7866                                                                  ECSRIRTN
  7867     IF RS-LIFE-BEN NOT = ZERO                                    ECSRIRTN
  7868         COMPUTE RW-LFPRM ROUNDED = (RS-LIFE-PREM *               ECSRIRTN
  7869                   RWF-LFAMT) / RS-LIFE-BEN                       ECSRIRTN
  7870         COMPUTE RW-LFPRMC ROUNDED = (RS-LP-CALC *                ECSRIRTN
  7871                   RWF-LFAMT) / RS-LIFE-BEN                       ECSRIRTN
  7872     ELSE                                                         ECSRIRTN
  7873         IF WT-LF-LIM-LO = ZERO                                   ECSRIRTN
  7874             COMPUTE RW-LFPRM ROUNDED = RS-LIFE-PREM * WT-LF-PCT  ECSRIRTN
  7875             COMPUTE RW-LFPRMC ROUNDED = RS-LP-CALC * WT-LF-PCT.  ECSRIRTN
  7876                                                                  ECSRIRTN
  7877     IF ((WT-LF-QC = '1' OR '3') OR                                  CL**8
  7878         (WT-LF-QC = '2' AND                                         CL**8
  7879          PGM-SUB = +50  AND                                         CL**8
  7880          DTE-CLIENT = 'LAP'))                                       CL**8
  7881          MOVE RW-LFPRM TO RWF-LFPRM                                 CL**8
  7882     ELSE                                                         ECSRIRTN
  7883         MOVE RW-LFPRMC TO RWF-LFPRM.                             ECSRIRTN
  7884                                                                  ECSRIRTN
  7885     IF WT-REMAINING = 'Y' OR 'Z' OR 'X' OR 'N'                   ECSRIRTN
  7886         COMPUTE RS-R-LB = RS-R-LB - RWF-LFAMT                    ECSRIRTN
  7887         COMPUTE RS-R-LP = RS-R-LP - RW-LFPRM                     ECSRIRTN
  7888         COMPUTE RS-R-LPC = RS-R-LPC - RW-LFPRMC.                 ECSRIRTN
  7889                                                                  ECSRIRTN
  7890     GO TO REIN-CALC-LIFE-X.                                      ECSRIRTN
  7891                                                                  ECSRIRTN
  7892 REIN-CALC-LF-RISK-PREM.                                          ECSRIRTN
  7893                                                                  ECSRIRTN
  7894     IF RWF-LFAMT NOT GREATER THAN +0                             ECSRIRTN
  7895         MOVE ZEROS                 TO RWF-LFPRM                  ECSRIRTN
  7896         GO TO REIN-CALC-LIFE-X.                                  ECSRIRTN
  7897                                                                  ECSRIRTN
  7898     MOVE RWF-LFAMT                 TO REIN-RISK-AMOUNT.          ECSRIRTN
  7899     COMPUTE REIN-MONTH-REDUCE = RS-LIFE-BEN / CR-LF-TERM.        ECSRIRTN
  7900     MOVE +0                        TO REIN-WORKA                 ECSRIRTN
  7901                                       RW-LFPRM.                  ECSRIRTN
  7902                                                                  ECSRIRTN
  7903 REIN-LF-RISK-PREM-LOOP.                                          ECSRIRTN
  7904                                                                  ECSRIRTN
  7905     COMPUTE RW-LFPRM = RW-LFPRM +                                ECSRIRTN
  7906                ((REIN-RISK-AMOUNT / +1000) * CR-LF-NSP-PRM-RATE).ECSRIRTN
  7907                                                                  ECSRIRTN
  7908     IF CLAS-I-RL-AH (CLAS-INDEXL) NOT = 'L'                      ECSRIRTN
  7909        SUBTRACT REIN-MONTH-REDUCE FROM REIN-RISK-AMOUNT.         ECSRIRTN
  7910                                                                  ECSRIRTN
  7911     IF REIN-WORKA = REIN-EARN-LF-TERM  OR                        ECSRIRTN
  7912        REIN-RISK-AMOUNT LESS THAN +0                             ECSRIRTN
  7913         MOVE RW-LFPRM              TO RWF-LFPRM                  ECSRIRTN
  7914     ELSE                                                         ECSRIRTN
  7915         ADD +1 TO REIN-WORKA                                     ECSRIRTN
  7916         GO TO REIN-LF-RISK-PREM-LOOP.                            ECSRIRTN
  7917                                                                  ECSRIRTN
  7918                                                                  ECSRIRTN
  7919 REIN-CALC-LIFE-X.                                                ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 162
* ECS150.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
  7920     EXIT.                                                        ECSRIRTN
  7921                                                                  ECSRIRTN
  7922 REIN-CALC-AH.                                                    ECSRIRTN
  7923                                                                  ECSRIRTN
  7924     IF WT-AHBEN-LO = ZERO                                        ECSRIRTN
  7925         AND WT-AHBEN-HI = ZERO                                   ECSRIRTN
  7926             MOVE +9999999.99 TO WT-AHBEN-LO                      ECSRIRTN
  7927                                 WT-AHBEN-HI.                     ECSRIRTN
  7928                                                                  ECSRIRTN
  7929     IF WT-AHMOA-LO = ZERO                                        ECSRIRTN
  7930         AND WT-AHMOA-HI = ZERO                                   ECSRIRTN
  7931             MOVE +9999999.99 TO WT-AHMOA-LO                      ECSRIRTN
  7932                                 WT-AHMOA-HI.                     ECSRIRTN
  7933                                                                  ECSRIRTN
  7934     COMPUTE RW-AHLIM-LO = CR-AH-TERM * WT-AHMOA-LO.              ECSRIRTN
  7935     COMPUTE RW-AHLIM-HI = CR-AH-TERM * WT-AHMOA-HI.              ECSRIRTN
  7936                                                                  ECSRIRTN
  7937     IF RW-AHLIM-LO GREATER WT-AHBEN-LO                           ECSRIRTN
  7938         MOVE WT-AHBEN-LO TO RW-AHLIM-LO.                         ECSRIRTN
  7939                                                                  ECSRIRTN
  7940     IF RW-AHLIM-HI GREATER WT-AHBEN-HI                           ECSRIRTN
  7941         MOVE WT-AHBEN-HI TO RW-AHLIM-HI.                         ECSRIRTN
  7942                                                                  ECSRIRTN
  7943     IF RW-AHWRK GREATER RW-AHLIM-HI                              ECSRIRTN
  7944         MOVE RW-AHLIM-HI TO RW-AHWRK.                            ECSRIRTN
  7945                                                                  ECSRIRTN
  7946     IF RW-AHWRK LESS RW-AHLIM-LO                                 ECSRIRTN
  7947         MOVE +0 TO RWF-AHAMT                                     ECSRIRTN
  7948     ELSE                                                         ECSRIRTN
  7949         IF WT-REMAINING = 'L'                                    ECSRIRTN
  7950             COMPUTE RWF-AHAMT ROUNDED = RW-AHWRK / CR-AH-TERM    ECSRIRTN
  7951         ELSE                                                     ECSRIRTN
  7952             COMPUTE RWF-AHAMT ROUNDED =                          ECSRIRTN
  7953             ((RW-AHWRK - RW-AHLIM-LO) / CR-AH-TERM) * WT-AH-PCT. ECSRIRTN
  7954                                                                  ECSRIRTN
  7955 REIN-AH-SKIP-LIMIT.                                              ECSRIRTN
  7956                                                                  ECSRIRTN
  7957     IF WT-REMAINING = 'I'                                        ECSRIRTN
  7958         GO TO REIN-CALC-AH-RISK-PREM.                            ECSRIRTN
  7959                                                                  ECSRIRTN
  7960     IF WT-REMAINING = 'L'                                        ECSRIRTN
  7961         COMPUTE RWF-AHPRM ROUNDED = RS-AH-PREM * WT-AH-PCT       ECSRIRTN
  7962         GO TO REIN-CALC-AH-X.                                    ECSRIRTN
  7963                                                                  ECSRIRTN
  7964     IF RS-AH-BEN NOT = ZERO                                      ECSRIRTN
  7965         COMPUTE RW-AHPRM ROUNDED = (RS-AH-PREM *                 ECSRIRTN
  7966                   RWF-AHAMT) / RS-AH-BEN                         ECSRIRTN
  7967         COMPUTE RW-AHPRMC ROUNDED = (RS-AP-CALC *                ECSRIRTN
  7968                   RWF-AHAMT) / RS-AH-BEN                         ECSRIRTN
  7969     ELSE                                                         ECSRIRTN
  7970         IF RW-AHLIM-LO = ZERO                                    ECSRIRTN
  7971             COMPUTE RW-AHPRM ROUNDED = RS-AH-PREM * WT-AH-PCT    ECSRIRTN
  7972             COMPUTE RW-AHPRMC ROUNDED = RS-AP-CALC * WT-AH-PCT.  ECSRIRTN
  7973                                                                  ECSRIRTN
  7974     IF ((WT-AH-QC = '1' OR '3') OR                                  CL**8
  7975         (WT-AH-QC = '2' AND                                         CL**8
  7976          PGM-SUB = +50  AND                                         CL**8
  7977          DTE-CLIENT = 'LAP'))                                       CL**8
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 163
* ECS150.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
  7978         MOVE RW-AHPRM TO RWF-AHPRM                               ECSRIRTN
  7979     ELSE                                                         ECSRIRTN
  7980         MOVE RW-AHPRMC TO RWF-AHPRM.                             ECSRIRTN
  7981                                                                  ECSRIRTN
  7982     IF RE-NSP-ST-CD-AH = SPACES OR ZERO                          ECSRIRTN
  7983         IF (WT-REMAINING = 'Y' OR 'Z') AND (WT-AH-QC = '1')      ECSRIRTN
  7984            AND (RWF-AHAMT = RS-R-AB) AND (RWF-AHAMT NOT = +0)    ECSRIRTN
  7985                MOVE 'Y' TO RWF-REM-AH-100.                       ECSRIRTN
  7986                                                                  ECSRIRTN
  7987     IF WT-REMAINING = 'Y' OR 'Z' OR 'X' OR 'N'                   ECSRIRTN
  7988         COMPUTE RS-R-AB = RS-R-AB - RWF-AHAMT                    ECSRIRTN
  7989         COMPUTE RS-R-AP = RS-R-AP - RW-AHPRM                     ECSRIRTN
  7990         COMPUTE RS-R-APC = RS-R-APC - RW-AHPRMC.                 ECSRIRTN
  7991                                                                  ECSRIRTN
  7992     GO TO REIN-CALC-AH-X.                                        ECSRIRTN
  7993                                                                  ECSRIRTN
  7994 REIN-CALC-AH-RISK-PREM.                                          ECSRIRTN
  7995                                                                  ECSRIRTN
  7996     IF RWF-AHAMT NOT GREATER THAN +0                             ECSRIRTN
  7997         MOVE ZEROS                 TO RWF-AHPRM                  ECSRIRTN
  7998         GO TO REIN-CALC-AH-X.                                    ECSRIRTN
  7999                                                                  ECSRIRTN
  8000     COMPUTE REIN-RISK-AMOUNT = RWF-AHAMT * CR-AH-TERM.           ECSRIRTN
  8001     MOVE RS-AH-BEN              TO REIN-MONTH-REDUCE.            ECSRIRTN
  8002     MOVE +0                     TO REIN-WORKA                    ECSRIRTN
  8003                                    RW-AHPRM.                     ECSRIRTN
  8004                                                                  ECSRIRTN
  8005 REIN-AH-RISK-PREM-LOOP.                                          ECSRIRTN
  8006                                                                  ECSRIRTN
  8007     COMPUTE RW-AHPRM = RW-AHPRM +                                ECSRIRTN
  8008                ((REIN-RISK-AMOUNT / +1000) * CR-AH-NSP-PRM-RATE).ECSRIRTN
  8009                                                                  ECSRIRTN
  8010     SUBTRACT REIN-MONTH-REDUCE FROM REIN-RISK-AMOUNT.            ECSRIRTN
  8011                                                                  ECSRIRTN
  8012     IF REIN-WORKA = REIN-EARN-AH-TERM  OR                        ECSRIRTN
  8013        REIN-RISK-AMOUNT LESS THAN +0                             ECSRIRTN
  8014         MOVE RW-AHPRM          TO RWF-AHPRM                      ECSRIRTN
  8015     ELSE                                                         ECSRIRTN
  8016         ADD +1 TO REIN-WORKA                                     ECSRIRTN
  8017         GO TO REIN-AH-RISK-PREM-LOOP.                            ECSRIRTN
  8018                                                                  ECSRIRTN
  8019                                                                  ECSRIRTN
  8020 REIN-CALC-AH-X.                                                  ECSRIRTN
  8021     EXIT.                                                        ECSRIRTN
  8022                                                                  ECSRIRTN
  8023 REINSURE-CALC-REMAINDER.                                         ECSRIRTN
  8024                                                                  ECSRIRTN
  8025     COMPUTE RWF-LFAMT = CR-LFAMT + CR-LFAMT-ALT.                 ECSRIRTN
  8026     COMPUTE RWF-LFPRM = CR-LFPRM + CR-LFPRM-ALT.                 ECSRIRTN
  8027     MOVE CR-AHAMT TO RWF-AHAMT.                                  ECSRIRTN
  8028     MOVE CR-AHPRM TO RWF-AHPRM.                                  ECSRIRTN
  8029                                                                  ECSRIRTN
  8030     PERFORM REINSURE-SUBTRACT THRU REINSURE-SUBTRACT-X           ECSRIRTN
  8031         VARYING SUB2 FROM +1 BY +1 UNTIL SUB2 = SUB1.            ECSRIRTN
  8032                                                                  ECSRIRTN
  8033     IF RWF-LFAMT NOT = ZEROS OR                                  ECSRIRTN
  8034        RWF-LFPRM NOT = ZEROS                                     ECSRIRTN
  8035           MOVE 'X' TO REIN-LF-FLG (SUB1).                        ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 164
* ECS150.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
  8036                                                                  ECSRIRTN
  8037     IF RWF-AHAMT NOT = ZEROS OR                                  ECSRIRTN
  8038        RWF-AHPRM NOT = ZEROS                                     ECSRIRTN
  8039           MOVE 'X' TO REIN-AH-FLG (SUB1).                        ECSRIRTN
  8040                                                                  ECSRIRTN
  8041 REINSURE-CALC-X.                                                 ECSRIRTN
  8042                                                                  ECSRIRTN
  8043     IF REIN-LF-AH-FLGS (SUB1) NOT = SPACES                       ECSRIRTN
  8044         MOVE 'X' TO REIN-BUS-FLAG.                               ECSRIRTN
  8045                                                                  ECSRIRTN
  8046     MOVE RWF-FIELDS TO REIN-WORK-FLDS (SUB1).                    ECSRIRTN
  8047                                                                  ECSRIRTN
  8048 REINSURE-SUBTRACT.                                               ECSRIRTN
  8049                                                                  ECSRIRTN
  8050     SUBTRACT REIN-LFAMT (SUB2) FROM RWF-LFAMT.                   ECSRIRTN
  8051     SUBTRACT REIN-LFPRM (SUB2) FROM RWF-LFPRM.                   ECSRIRTN
  8052     SUBTRACT REIN-AHAMT (SUB2) FROM RWF-AHAMT.                   ECSRIRTN
  8053     SUBTRACT REIN-AHPRM (SUB2) FROM RWF-AHPRM.                   ECSRIRTN
  8054                                                                  ECSRIRTN
  8055 REINSURE-SUBTRACT-X.                                             ECSRIRTN
  8056     EXIT.                                                        ECSRIRTN
  8057                                                                  ECSRIRTN
  8058 REINSURE-CALC-CANCEL.                                            ECSRIRTN
  8059                                                                  ECSRIRTN
  8060     MOVE REIN-WORK-FLDS (SUB1) TO RWF-FIELDS.                    ECSRIRTN
  8061     MOVE RE-COMP-INFO (SUB1) TO WT-COMP-INFO.                    ECSRIRTN
  8062                                                                  ECSRIRTN
  8063     IF SUB1 = RE-100-COMP                                        ECSRIRTN
  8064         GO TO REINSURE-REMAINDER-CANCEL.                         ECSRIRTN
  8065                                                                  ECSRIRTN
  8066     IF REIN-LF-FLG (SUB1) NOT = 'X'                              ECSRIRTN
  8067         GO TO REINSURE-CALC-CANCEL-AH.                           ECSRIRTN
  8068                                                                  ECSRIRTN
  8069     IF RWF-LF-RUNOFF-SW = 'N'                                    ECSRIRTN
  8070         IF CR-LF-CANC-DT NOT LESS THAN RWF-EP-STOP-DATE             CL**3
  8071             GO TO REINSURE-CALC-CANCEL-AH.                       ECSRIRTN
  8072                                                                  ECSRIRTN
  8073     IF WT-REMAINING = 'I'                                        ECSRIRTN
  8074         GO TO REINSURE-CALC-LF-RISK-CANCEL.                      ECSRIRTN
  8075                                                                  ECSRIRTN
  8076     IF WT-REMAINING = 'L'                                        ECSRIRTN
  8077         COMPUTE RWF-LFRFND ROUNDED = CR-LFRFND * WT-LF-PCT       ECSRIRTN
  8078         GO TO REINSURE-CALC-CANCEL-AH.                           ECSRIRTN
  8079                                                                  ECSRIRTN
  8080     IF CR-LFPRM = ZERO                                           ECSRIRTN
  8081        MOVE ZERO                TO REIN-FACTOR
  8082     ELSE                                                         ECSRIRTN
  8083        IF DTE-CLIENT = 'GIC'  AND
  8084           CLAS-I-BAL (CLAS-INDEXL) = 'B'
  8085           MOVE +1.0             TO REIN-FACTOR
  8086        ELSE
  8087           IF DTE-CLIENT = 'DCC'
  8088              COMPUTE REIN-FACTOR = CR-LFRFND /
  8089                 (CR-LFPRM + CR-LFPRM-ALT)
  8090           ELSE
  8091              COMPUTE REIN-FACTOR ROUNDED =  CR-LFRFND-CALC /
  8092                 (CR-LFPRM + CR-LFPRM-ALT)
  8093            END-IF
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 165
* ECS150.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
  8094         END-IF
  8095     END-IF
  8096                                                                  ECSRIRTN
  8097     IF CR-LFAMT NOT = ZERO                                       ECSRIRTN
  8098         IF DTE-CLIENT = 'GTL'  OR  'UAL'  OR  'NCL'  OR  'CVL'   ECSRIRTN
  8099             IF WT-LF-QC = ('1' OR '4')                           ECSRIRTN
  8100                 COMPUTE RWF-LFRFND ROUNDED =  ((CR-LFRFND *      ECSRIRTN
  8101                         RWF-LFAMT) / (CR-LFAMT + CR-LFAMT-ALT))  ECSRIRTN
  8102             ELSE                                                 ECSRIRTN
  8103                 COMPUTE RWF-LFRFND =                             ECSRIRTN
  8104                            REIN-FACTOR * REIN-CALCED-LIFE        ECSRIRTN
  8105                 COMPUTE RWF-LFRFND ROUNDED =  ((RWF-LFRFND *     ECSRIRTN
  8106                         RWF-LFAMT) / (CR-LFAMT + CR-LFAMT-ALT))  ECSRIRTN
  8107         ELSE                                                     ECSRIRTN
  8108             IF WT-LF-QC = ('1' OR '4')                           ECSRIRTN
  8109                 compute rein-factor rounded =
  8110                    RWF-LFAMT / (CR-LFAMT + CR-LFAMT-ALT)
  8111                 COMPUTE RWF-LFRFND ROUNDED =  CR-LFRFND *
  8112                    rein-factor
  8113             ELSE                                                 ECSRIRTN
  8114*                COMPUTE RWF-LFRFND = REIN-FACTOR
  8115*                   * REIN-CALCED-LIFE *
  8116*                   (RWF-LFAMT / (CR-LFAMT + CR-LFAMT-ALT)).
  8117                 COMPUTE RWF-LFRFND =                             ECSRIRTN
  8118                            REIN-FACTOR * REIN-CALCED-LIFE        ECSRIRTN
  8119                 COMPUTE RWF-LFRFND ROUNDED =  (RWF-LFRFND *
  8120                        RWF-LFAMT) / (CR-LFAMT + CR-LFAMT-ALT).
  8121                                                                  ECSRIRTN
  8122     IF CR-LFAMT = ZERO                                           ECSRIRTN
  8123         IF WT-LF-LIM-LO = ZERO                                   ECSRIRTN
  8124             IF WT-LF-QC = ('1' OR '4')                           ECSRIRTN
  8125                 COMPUTE RWF-LFRFND ROUNDED =                     ECSRIRTN
  8126                       CR-LFRFND * WT-LF-PCT                      ECSRIRTN
  8127             ELSE                                                 ECSRIRTN
  8128                 COMPUTE RWF-LFRFND =                             ECSRIRTN
  8129                            REIN-FACTOR * REIN-CALCED-LIFE        ECSRIRTN
  8130                 COMPUTE RWF-LFRFND ROUNDED =                     ECSRIRTN
  8131                       RWF-LFRFND * WT-LF-PCT.                    ECSRIRTN
  8132                                                                  ECSRIRTN
  8133     GO TO REINSURE-CALC-CANCEL-AH.                               ECSRIRTN
  8134                                                                  ECSRIRTN
  8135                                                                  ECSRIRTN
  8136 REINSURE-CALC-LF-RISK-CANCEL.                                    ECSRIRTN
  8137                                                                  ECSRIRTN
  8138     IF RWF-LFAMT NOT GREATER THAN +0  OR                         ECSRIRTN
  8139       (CR-LF-CANC-DT = ZEROS)                                       CL*10
  8140         MOVE ZERO                    TO RWF-LFRFND               ECSRIRTN
  8141         GO TO REINSURE-CALC-CANCEL-AH.                           ECSRIRTN
  8142                                                                  ECSRIRTN
  8143     IF REIN-RT-SW NOT = 'X'                                      ECSRIRTN
  8144       IF VOIDING-LF-CANCEL                                       ECSRIRTN
  8145           COMPUTE RWF-LFRFND = RWF-LFRFND * (-1)                 ECSRIRTN
  8146           GO TO REINSURE-CALC-CANCEL-AH                          ECSRIRTN
  8147       ELSE                                                       ECSRIRTN
  8148           IF ADDITIONAL-LF-CANCEL                                ECSRIRTN
  8149               GO TO REINSURE-CALC-CANCEL-AH.                     ECSRIRTN
  8150                                                                  ECSRIRTN
  8151     IF FLAT-CANCEL-LF                                            ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 166
* ECS150.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
  8152         MOVE RWF-LFPRM               TO RWF-LFRFND               ECSRIRTN
  8153         GO TO REINSURE-CALC-CANCEL-AH.                           ECSRIRTN
  8154                                                                  ECSRIRTN
  8155     IF REIN-EARN-LF-TERM = REIN-LCNC-EARN-TERM                   ECSRIRTN
  8156         MOVE ZERO                    TO RWF-LFRFND               ECSRIRTN
  8157         GO TO REINSURE-CALC-CANCEL-AH.                           ECSRIRTN
  8158                                                                  ECSRIRTN
  8159     MOVE RWF-LFAMT                   TO REIN-RISK-AMOUNT.        ECSRIRTN
  8160     COMPUTE REIN-MONTH-REDUCE = RS-LIFE-BEN / CR-LF-TERM.        ECSRIRTN
  8161     MOVE +0                          TO REIN-WORKA               ECSRIRTN
  8162                                         RW-LFRFND.               ECSRIRTN
  8163                                                                  ECSRIRTN
  8164 REINSURE-LF-RISK-CANCEL-LOOP.                                    ECSRIRTN
  8165                                                                  ECSRIRTN
  8166     COMPUTE RW-LFRFND = RW-LFRFND +                              ECSRIRTN
  8167                ((REIN-RISK-AMOUNT / +1000) * CR-LF-NSP-PRM-RATE).ECSRIRTN
  8168                                                                  ECSRIRTN
  8169     IF CLAS-I-RL-AH (CLAS-INDEXL) NOT = 'L'                      ECSRIRTN
  8170        SUBTRACT REIN-MONTH-REDUCE FROM REIN-RISK-AMOUNT.         ECSRIRTN
  8171                                                                  ECSRIRTN
  8172     IF REIN-WORKA = REIN-LCNC-EARN-TERM  OR                      ECSRIRTN
  8173        REIN-RISK-AMOUNT LESS THAN +0                             ECSRIRTN
  8174         COMPUTE RWF-LFRFND = RWF-LFPRM - RW-LFRFND               ECSRIRTN
  8175     ELSE                                                         ECSRIRTN
  8176         ADD +1 TO REIN-WORKA                                     ECSRIRTN
  8177         GO TO REINSURE-LF-RISK-CANCEL-LOOP.                      ECSRIRTN
  8178                                                                  ECSRIRTN
  8179                                                                  ECSRIRTN
  8180 REINSURE-CALC-CANCEL-AH.                                         ECSRIRTN
  8181                                                                  ECSRIRTN
  8182     IF REIN-AH-FLG (SUB1) NOT = 'X'                              ECSRIRTN
  8183         GO TO REINSURE-CALC-CANCEL-SKIP.                         ECSRIRTN
  8184                                                                  ECSRIRTN
  8185     IF RWF-AH-RUNOFF-SW = 'N'                                    ECSRIRTN
  8186         IF CR-AH-CANC-DT NOT LESS THAN RWF-EP-STOP-DATE             CL**4
  8187             GO TO REINSURE-CALC-CANCEL-SKIP.                     ECSRIRTN
  8188                                                                  ECSRIRTN
  8189     IF RWF-REM-AH-100 = 'Y'                                      ECSRIRTN
  8190         MOVE CR-AHRFND TO RWF-AHRFND                             ECSRIRTN
  8191         PERFORM REINSURE-SUB-REM-CANCEL THRU                     ECSRIRTN
  8192             REINSURE-SUB-REM-CANCEL-X                            ECSRIRTN
  8193                 VARYING SUB2 FROM +1 BY +1 UNTIL SUB2 = SUB1     ECSRIRTN
  8194         GO TO REINSURE-CALC-CANCEL-SKIP.                         ECSRIRTN
  8195                                                                  ECSRIRTN
  8196     IF WT-REMAINING = 'I'                                        ECSRIRTN
  8197         GO TO REINSURE-CALC-AH-RISK-CANCEL.                      ECSRIRTN
  8198                                                                  ECSRIRTN
  8199     IF WT-REMAINING = 'L'                                        ECSRIRTN
  8200         COMPUTE RWF-AHRFND ROUNDED = CR-AHRFND * WT-AH-PCT       ECSRIRTN
  8201         GO TO REINSURE-CALC-CANCEL-SKIP.                         ECSRIRTN
  8202                                                                  ECSRIRTN
  8203     IF CR-AHPRM = ZERO                                           ECSRIRTN
  8204        MOVE ZERO                TO REIN-FACTOR
  8205     ELSE
  8206        IF DTE-CLIENT = 'GIC'  AND
  8207           CLAS-I-BAL (CLAS-INDEXA) = 'B'
  8208            MOVE +1.0            TO REIN-FACTOR
  8209        ELSE
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 167
* ECS150.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
  8210           IF DTE-CLIENT = 'DCC'
  8211              COMPUTE REIN-FACTOR =
  8212                 CR-AHRFND / CR-AHPRM
  8213           ELSE
  8214              COMPUTE REIN-FACTOR ROUNDED =
  8215                                CR-AHRFND-CALC / CR-AHPRM
  8216           END-IF
  8217        END-IF
  8218     END-IF
  8219
  8220     IF CR-AHAMT NOT = ZERO
  8221        IF (DTE-CLIENT = 'DCC')
  8222           AND (CLAS-I-REFUND-METHOD (CLAS-INDEXA) = 'D')
  8223           MOVE CR-AH-RFND-CLP   TO RWF-AHRFND
  8224        ELSE
  8225           IF WT-AH-QC = ('1' OR '4')
  8226              compute rein-factor rounded = rwf-ahamt / cr-ahamt
  8227              compute rwf-ahrfnd rounded =
  8228                 cr-ahrfnd * rein-factor
  8229           ELSE
  8230              COMPUTE RWF-AHRFND = REIN-FACTOR * REIN-CALCED-AH
  8231              COMPUTE RWF-AHRFND ROUNDED = (RWF-AHRFND *
  8232                       RWF-AHAMT) / CR-AHAMT
  8233           END-IF
  8234        END-IF
  8235     ELSE
  8236        IF RWF-AH-LIMIT = ZERO
  8237           IF WT-AH-QC = ('1' OR '4')
  8238              COMPUTE RWF-AHRFND ROUNDED =
  8239                       CR-AHRFND * WT-AH-PCT
  8240           ELSE
  8241              COMPUTE RWF-AHRFND =
  8242                            REIN-FACTOR * REIN-CALCED-AH
  8243              COMPUTE RWF-AHRFND ROUNDED =
  8244                       RWF-AHRFND * WT-AH-PCT
  8245           END-IF
  8246        END-IF
  8247     END-IF
  8248
  8249     GO TO REINSURE-CALC-CANCEL-SKIP.                             ECSRIRTN
  8250                                                                  ECSRIRTN
  8251                                                                  ECSRIRTN
  8252 REINSURE-CALC-AH-RISK-CANCEL.                                    ECSRIRTN
  8253                                                                  ECSRIRTN
  8254     IF RWF-AHAMT NOT GREATER THAN +0  OR                         ECSRIRTN
  8255       (CR-AH-CANC-DT = ZEROS)                                       CL*10
  8256         MOVE ZERO                    TO RWF-AHRFND               ECSRIRTN
  8257         GO TO REINSURE-CALC-CANCEL-SKIP.                         ECSRIRTN
  8258                                                                  ECSRIRTN
  8259     IF REIN-RT-SW NOT = 'X'                                      ECSRIRTN
  8260       IF VOIDING-AH-CANCEL                                       ECSRIRTN
  8261           COMPUTE RWF-AHRFND = RWF-AHRFND * (-1)                 ECSRIRTN
  8262           GO TO REINSURE-CALC-CANCEL-SKIP                        ECSRIRTN
  8263       ELSE                                                       ECSRIRTN
  8264           IF ADDITIONAL-AH-CANCEL                                ECSRIRTN
  8265               GO TO REINSURE-CALC-CANCEL-SKIP.                   ECSRIRTN
  8266                                                                  ECSRIRTN
  8267     IF FLAT-CANCEL-AH                                            ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 168
* ECS150.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
  8268         MOVE RWF-AHPRM               TO RWF-AHRFND               ECSRIRTN
  8269         GO TO REINSURE-CALC-CANCEL-SKIP.                         ECSRIRTN
  8270                                                                  ECSRIRTN
  8271     IF REIN-EARN-AH-TERM = REIN-ACNC-EARN-TERM                   ECSRIRTN
  8272         MOVE ZERO                    TO RWF-AHRFND               ECSRIRTN
  8273         GO TO REINSURE-CALC-CANCEL-SKIP.                         ECSRIRTN
  8274                                                                  ECSRIRTN
  8275     MOVE RS-AH-BEN              TO REIN-MONTH-REDUCE.            ECSRIRTN
  8276     COMPUTE REIN-RISK-AMOUNT = RWF-AHAMT * CR-AH-TERM.           ECSRIRTN
  8277     MOVE +0                     TO REIN-WORKA                    ECSRIRTN
  8278                                    RW-AHRFND.                    ECSRIRTN
  8279                                                                  ECSRIRTN
  8280 REINSURE-AH-RISK-CANCEL-LOOP.                                    ECSRIRTN
  8281                                                                  ECSRIRTN
  8282     COMPUTE RW-AHRFND = RW-AHRFND +                              ECSRIRTN
  8283                ((REIN-RISK-AMOUNT / +1000) * CR-AH-NSP-PRM-RATE).ECSRIRTN
  8284                                                                  ECSRIRTN
  8285     SUBTRACT REIN-MONTH-REDUCE FROM REIN-RISK-AMOUNT.            ECSRIRTN
  8286                                                                  ECSRIRTN
  8287     IF REIN-WORKA = REIN-ACNC-EARN-TERM  OR                      ECSRIRTN
  8288        REIN-RISK-AMOUNT LESS THAN +0                             ECSRIRTN
  8289         COMPUTE RWF-AHRFND = RWF-AHPRM - RW-AHRFND               ECSRIRTN
  8290     ELSE                                                         ECSRIRTN
  8291         ADD +1 TO REIN-WORKA                                     ECSRIRTN
  8292         GO TO REINSURE-AH-RISK-CANCEL-LOOP.                      ECSRIRTN
  8293                                                                  ECSRIRTN
  8294                                                                  ECSRIRTN
  8295 REINSURE-CALC-CANCEL-SKIP.                                       ECSRIRTN
  8296                                                                  ECSRIRTN
  8297     IF RWF-LFRFND NOT = ZEROS                                    ECSRIRTN
  8298         MOVE 'X' TO REIN-LF-FLG (SUB1).                          ECSRIRTN
  8299                                                                  ECSRIRTN
  8300     IF RWF-AHRFND NOT = ZEROS                                    ECSRIRTN
  8301         MOVE 'X' TO REIN-AH-FLG (SUB1).                          ECSRIRTN
  8302                                                                  ECSRIRTN
  8303     GO TO REINSURE-CALC-CANCEL-X.                                ECSRIRTN
  8304                                                                  ECSRIRTN
  8305 REINSURE-REMAINDER-CANCEL.                                       ECSRIRTN
  8306                                                                  ECSRIRTN
  8307     MOVE CR-LFRFND TO RWF-LFRFND.                                ECSRIRTN
  8308     MOVE CR-AHRFND TO RWF-AHRFND.                                ECSRIRTN
  8309                                                                  ECSRIRTN
  8310     PERFORM REINSURE-SUBTRACT-CANCEL THRU                        ECSRIRTN
  8311         REINSURE-SUBTRACT-CANCEL-X                               ECSRIRTN
  8312             VARYING SUB2 FROM +1 BY +1 UNTIL SUB2 = SUB1.        ECSRIRTN
  8313                                                                  ECSRIRTN
  8314     IF RWF-LFRFND NOT = ZEROS                                    ECSRIRTN
  8315         MOVE 'X' TO REIN-LF-FLG (SUB1).                          ECSRIRTN
  8316                                                                  ECSRIRTN
  8317     IF RWF-AHRFND NOT = ZEROS                                    ECSRIRTN
  8318         MOVE 'X' TO REIN-AH-FLG (SUB1).                          ECSRIRTN
  8319                                                                  ECSRIRTN
  8320 REINSURE-CALC-CANCEL-X.                                          ECSRIRTN
  8321                                                                  ECSRIRTN
  8322     IF REIN-LF-AH-FLGS (SUB1) NOT = SPACES                       ECSRIRTN
  8323         MOVE 'X' TO REIN-BUS-FLAG.                               ECSRIRTN
  8324                                                                  ECSRIRTN
  8325     MOVE RWF-FIELDS TO REIN-WORK-FLDS (SUB1).                    ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 169
* ECS150.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
  8326                                                                  ECSRIRTN
  8327 REINSURE-SUBTRACT-CANCEL.                                        ECSRIRTN
  8328                                                                  ECSRIRTN
  8329     SUBTRACT REIN-LFRFND (SUB2) FROM RWF-LFRFND.                 ECSRIRTN
  8330     SUBTRACT REIN-AHRFND (SUB2) FROM RWF-AHRFND.                 ECSRIRTN
  8331                                                                  ECSRIRTN
  8332 REINSURE-SUBTRACT-CANCEL-X.                                      ECSRIRTN
  8333     EXIT.                                                        ECSRIRTN
  8334                                                                  ECSRIRTN
  8335 REINSURE-SUB-REM-CANCEL.                                         ECSRIRTN
  8336                                                                  ECSRIRTN
  8337     IF REIN-REM-SW (SUB2) = 'Y' OR 'Z' OR 'X' OR 'N'             ECSRIRTN
  8338         SUBTRACT REIN-AHRFND (SUB2) FROM RWF-AHRFND.             ECSRIRTN
  8339                                                                  ECSRIRTN
  8340 REINSURE-SUB-REM-CANCEL-X.                                       ECSRIRTN
  8341     EXIT.                                                        ECSRIRTN
  8342                                                                  ECSRIRTN
  8343 REINSURE-CALC-CLAIM.                                             ECSRIRTN
  8344                                                                  ECSRIRTN
  8345     MOVE REIN-WORK-FLDS (SUB1) TO RWF-FIELDS.                    ECSRIRTN
  8346     MOVE RE-COMP-INFO (SUB1) TO WT-COMP-INFO.                    ECSRIRTN
  8347                                                                  ECSRIRTN
  8348     IF SUB1 = RE-100-COMP                                        ECSRIRTN
  8349         GO TO REINSURE-REMAINDER-CLAIM.                          ECSRIRTN
  8350                                                                  ECSRIRTN
  8351     PERFORM REIN-FIND-CO-LOOP THRU FIND-REI-CO-EXIT              ECSRIRTN
  8352        VARYING CO-SUB FROM 1 BY 1 UNTIL                          ECSRIRTN
  8353          (RCT-REIN-CO (CO-SUB) = REIN-COMP (SUB1))  OR           ECSRIRTN
  8354          (CO-SUB GREATER REIN-CO-TABLE-ENT-CNT)     OR           ECSRIRTN
  8355          (RCT-REIN-CO (CO-SUB) = SPACES).                        ECSRIRTN
  8356                                                                  ECSRIRTN
  8357     IF (CO-SUB GREATER REIN-CO-TABLE-ENT-CNT)  OR                ECSRIRTN
  8358        (RCT-REIN-CO (CO-SUB) = SPACES)                           ECSRIRTN
  8359          MOVE ZERO TO CO-SUB.                                    ECSRIRTN
  8360                                                                  ECSRIRTN
  8361     MOVE ZEROS                TO RWF-LFCLML                      ECSRIRTN
  8362                                  RWF-AHCLML.                     ECSRIRTN
  8363                                                                  ECSRIRTN
  8364     IF REIN-LF-FLG (SUB1) NOT = 'X'                              ECSRIRTN
  8365         GO TO REINSURE-CALC-CLAIM-AH.                            ECSRIRTN
  8366                                                                  ECSRIRTN
  8367     IF RW-LFCLMWK = ZEROS                                        ECSRIRTN
  8368         GO TO REINSURE-CALC-CLAIM-AH.                            ECSRIRTN
  8369                                                                  ECSRIRTN
  8370     IF CO-SUB NOT = ZERO                                         ECSRIRTN
  8371         IF RCT-CLM-CUTOFF-DT (CO-SUB) NOT = ZERO                 ECSRIRTN
  8372             IF CR-DTH-DT LESS RCT-CLM-CUTOFF-DT (CO-SUB)         ECSRIRTN
  8373                 GO TO REINSURE-CALC-CLAIM-AH.                    ECSRIRTN
  8374                                                                  ECSRIRTN
  8375     IF RWF-LF-RUNOFF-SW = 'N'                                    ECSRIRTN
  8376         IF CR-DTH-DT NOT LESS THAN RWF-EP-STOP-DATE                 CL**6
  8377                 GO TO REINSURE-CALC-CLAIM-AH.                    ECSRIRTN
  8378                                                                  ECSRIRTN
  8379     IF WT-REMAINING = 'I'                                        ECSRIRTN
  8380         GO TO REINSURE-CALC-LF-RISK-CLAIM.                       ECSRIRTN
  8381                                                                  ECSRIRTN
  8382     IF WT-REMAINING = 'L'                                        ECSRIRTN
  8383         IF REIN-RT-SW = 'X'                                      ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 170
* ECS150.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
  8384             IF RW-LFCLMWK GREATER WT-LF-HI                       ECSRIRTN
  8385                 MOVE WT-LF-HI TO RWF-LFCLM                       ECSRIRTN
  8386             ELSE                                                 ECSRIRTN
  8387                 MOVE RW-LFCLMWK TO RWF-LFCLM                     ECSRIRTN
  8388         ELSE                                                     ECSRIRTN
  8389             IF (RW-LFCLMWK + RWF-LFCLM) GREATER WT-LF-HI         ECSRIRTN
  8390                 COMPUTE RWF-LFCLML = WT-LF-HI - RWF-LFCLM        ECSRIRTN
  8391                 MOVE WT-LF-HI TO RWF-LFCLM                       ECSRIRTN
  8392             ELSE                                                 ECSRIRTN
  8393                 MOVE RW-LFCLMWK TO RWF-LFCLML                    ECSRIRTN
  8394                 ADD RWF-LFCLML TO RWF-LFCLM.                     ECSRIRTN
  8395                                                                  ECSRIRTN
  8396     IF WT-REMAINING = 'L'                                        ECSRIRTN
  8397         GO TO REINSURE-CALC-CLAIM-AH.                            ECSRIRTN
  8398                                                                  ECSRIRTN
  8399     IF CR-LFAMT NOT = ZERO                                       ECSRIRTN
  8400         IF DTE-CLIENT = 'GTL'  OR  'UAL'  OR  'NCL'  OR  'CVL'   ECSRIRTN
  8401            OR 'DCC'
  8402             COMPUTE RWF-LFCLML ROUNDED =  ((RW-LFCLMWK *         ECSRIRTN
  8403                         RWF-LFAMT) / (CR-LFAMT + CR-LFAMT-ALT))  ECSRIRTN
  8404         ELSE                                                     ECSRIRTN
  8405             COMPUTE RWF-LFCLML ROUNDED =  RW-LFCLMWK *           ECSRIRTN
  8406                        (RWF-LFAMT / (CR-LFAMT + CR-LFAMT-ALT)).  ECSRIRTN
  8407                                                                  ECSRIRTN
  8408     IF CR-LFAMT = ZERO                                           ECSRIRTN
  8409         IF WT-LF-LIM-LO = ZERO                                   ECSRIRTN
  8410             COMPUTE RWF-LFCLML ROUNDED =                         ECSRIRTN
  8411                       RW-LFCLMWK * WT-LF-PCT.                    ECSRIRTN
  8412                                                                  ECSRIRTN
  8413     IF CO-SUB NOT = ZERO                                         ECSRIRTN
  8414         IF RCT-LF-CLM-PCT (CO-SUB) NOT = ZERO                    ECSRIRTN
  8415             COMPUTE RWF-LFCLML ROUNDED =                         ECSRIRTN
  8416                          RW-LFCLMWK * RCT-LF-CLM-PCT (CO-SUB).   ECSRIRTN
  8417                                                                  ECSRIRTN
  8418     IF CO-SUB NOT = ZERO                                         ECSRIRTN
  8419         IF RCT-LF-CLM-MAX (CO-SUB) NOT = ZERO                    ECSRIRTN
  8420             IF REIN-RT-SW = 'X'                                  ECSRIRTN
  8421               IF RWF-LFCLML GREATER RCT-LF-CLM-MAX (CO-SUB)      ECSRIRTN
  8422                     MOVE RCT-LF-CLM-MAX (CO-SUB) TO RWF-LFCLM    ECSRIRTN
  8423                      GO TO REINSURE-CALC-CLAIM-AH                ECSRIRTN
  8424                  ELSE                                            ECSRIRTN
  8425                     MOVE RWF-LFCLML TO RWF-LFCLM                 ECSRIRTN
  8426                      GO TO REINSURE-CALC-CLAIM-AH                ECSRIRTN
  8427              ELSE                                                ECSRIRTN
  8428                 IF (RWF-LFCLML + RWF-LFCLM) GREATER              ECSRIRTN
  8429                                           RCT-LF-CLM-MAX (CO-SUB)ECSRIRTN
  8430                     COMPUTE RWF-LFCLML =                         ECSRIRTN
  8431                               RCT-LF-CLM-MAX (CO-SUB) - RWF-LFCLMECSRIRTN
  8432                     MOVE RCT-LF-CLM-MAX (CO-SUB) TO RWF-LFCLM    ECSRIRTN
  8433                      GO TO REINSURE-CALC-CLAIM-AH.               ECSRIRTN
  8434                                                                  ECSRIRTN
  8435     ADD RWF-LFCLML TO RWF-LFCLM.                                 ECSRIRTN
  8436                                                                  ECSRIRTN
  8437     GO TO REINSURE-CALC-CLAIM-AH.                                ECSRIRTN
  8438                                                                  ECSRIRTN
  8439                                                                  ECSRIRTN
  8440 REINSURE-CALC-LF-RISK-CLAIM.                                     ECSRIRTN
  8441                                                                  ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 171
* ECS150.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
  8442     IF RWF-LFAMT NOT GREATER THAN +0                             ECSRIRTN
  8443         GO TO REINSURE-CALC-CLAIM-AH.                            ECSRIRTN
  8444                                                                  ECSRIRTN
  8445     IF CLAS-I-RL-AH (CLAS-INDEXL) = 'L'                          ECSRIRTN
  8446         MOVE RWF-LFAMT                   TO REIN-RISK-AMOUNT     ECSRIRTN
  8447     ELSE                                                         ECSRIRTN
  8448         COMPUTE REIN-RISK-AMOUNT = RWF-LFAMT -                   ECSRIRTN
  8449                ((RS-LIFE-BEN / CR-LF-TERM) * REIN-LF-CLM-MONTHS).ECSRIRTN
  8450                                                                  ECSRIRTN
  8451     IF REIN-RISK-AMOUNT NOT GREATER THAN +0                      ECSRIRTN
  8452         GO TO REINSURE-CALC-CLAIM-AH.                            ECSRIRTN
  8453                                                                  ECSRIRTN
  8454     IF REIN-RT-SW = 'X'                                          ECSRIRTN
  8455         IF RW-LFCLMWK GREATER THAN REIN-RISK-AMOUNT              ECSRIRTN
  8456             MOVE REIN-RISK-AMOUNT        TO RWF-LFCLM            ECSRIRTN
  8457         ELSE                                                     ECSRIRTN
  8458             MOVE RW-LFCLMWK              TO RWF-LFCLM            ECSRIRTN
  8459     ELSE                                                         ECSRIRTN
  8460         IF (RW-LFCLMWK + RWF-LFCLM) GREATER THAN REIN-RISK-AMOUNTECSRIRTN
  8461             COMPUTE RWF-LFCLML = REIN-RISK-AMOUNT - RWF-LFCLM    ECSRIRTN
  8462             MOVE REIN-RISK-AMOUNT        TO RWF-LFCLM            ECSRIRTN
  8463         ELSE                                                     ECSRIRTN
  8464             MOVE RW-LFCLMWK              TO RWF-LFCLML           ECSRIRTN
  8465             ADD RW-LFCLMWK TO RWF-LFCLM.                         ECSRIRTN
  8466                                                                  ECSRIRTN
  8467                                                                  ECSRIRTN
  8468 REINSURE-CALC-CLAIM-AH.                                          ECSRIRTN
  8469                                                                  ECSRIRTN
  8470     IF REIN-AH-FLG (SUB1) NOT = 'X'                              ECSRIRTN
  8471         GO TO REINSURE-CALC-CLAIM-X.                             ECSRIRTN
  8472                                                                  ECSRIRTN
  8473     IF RW-AHCLMWK = ZEROS                                        ECSRIRTN
  8474         GO TO REINSURE-CALC-CLAIM-SKIP.                          ECSRIRTN
  8475                                                                  ECSRIRTN
  8476     IF REIN-RT-SW NOT = 'X'                                      ECSRIRTN
  8477         GO TO REINSURE-CALC-AH-DETAIL.                           ECSRIRTN
  8478                                                                  ECSRIRTN
  8479     MOVE CR-DISAB-INCURRED-DETAIL    TO RW-AH-INCURRED-DETAIL.   ECSRIRTN
  8480     MOVE ZEROS                       TO RW-AHCLMWK.              ECSRIRTN
  8481                                                                  ECSRIRTN
  8482     PERFORM CHECK-MULTIPLE-DISABILITIES THRU CHECK-DISABS-EXIT   ECSRIRTN
  8483             VARYING                                              ECSRIRTN
  8484         INC-SUB FROM +1 BY +1                                    ECSRIRTN
  8485             UNTIL                                                ECSRIRTN
  8486         INC-SUB GREATER THAN +5.                                 ECSRIRTN
  8487                                                                  ECSRIRTN
  8488     IF RW-AHCLMWK = ZEROS                                        ECSRIRTN
  8489         GO TO REINSURE-CALC-CLAIM-SKIP                           ECSRIRTN
  8490     ELSE                                                         ECSRIRTN
  8491         GO TO REINSURE-CALC-AH-CONTINUED.                        ECSRIRTN
  8492                                                                  ECSRIRTN
  8493 CHECK-MULTIPLE-DISABILITIES.                                     ECSRIRTN
  8494                                                                  ECSRIRTN
  8495     IF RW-AH-INCUR-DT (INC-SUB) = ZEROS                          ECSRIRTN
  8496         GO TO CHECK-DISABS-EXIT.                                 ECSRIRTN
  8497                                                                  ECSRIRTN
  8498     IF CO-SUB NOT = ZERO                                         ECSRIRTN
  8499       IF RCT-CLM-CUTOFF-DT (CO-SUB) NOT = ZERO                   ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 172
* ECS150.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
  8500           IF RW-AH-INCUR-DT (INC-SUB) LESS THAN                  ECSRIRTN
  8501                       RCT-CLM-CUTOFF-DT (CO-SUB)                    CL**5
  8502               MOVE ZEROS             TO RW-AH-CLM-AMT (INC-SUB)  ECSRIRTN
  8503                                         RW-AH-CLM-EXP (INC-SUB)  ECSRIRTN
  8504               GO TO CHECK-DISABS-EXIT.                           ECSRIRTN
  8505                                                                  ECSRIRTN
  8506     IF RWF-AH-RUNOFF-SW = 'N'                                    ECSRIRTN
  8507       IF RW-AH-INCUR-DT (INC-SUB) NOT LESS THAN RWF-EP-STOP-DATE ECSRIRTN
  8508           MOVE ZEROS                 TO RW-AH-CLM-AMT (INC-SUB)  ECSRIRTN
  8509                                         RW-AH-CLM-EXP (INC-SUB)  ECSRIRTN
  8510           GO TO CHECK-DISABS-EXIT.                               ECSRIRTN
  8511                                                                  ECSRIRTN
  8512     IF WT-REMAINING NOT = 'I'                                    ECSRIRTN
  8513         COMPUTE RW-AHCLMWK = RW-AHCLMWK                          ECSRIRTN
  8514                             + RW-AH-CLM-AMT (INC-SUB)            ECSRIRTN
  8515                             + RW-AH-CLM-EXP (INC-SUB)            ECSRIRTN
  8516         GO TO CHECK-DISABS-EXIT.                                 ECSRIRTN
  8517                                                                  ECSRIRTN
  8518     IF RWF-AHAMT NOT GREATER THAN +0                             ECSRIRTN
  8519         GO TO CHECK-DISABS-EXIT.                                 ECSRIRTN
  8520                                                                  ECSRIRTN
  8521     IF INC-SUB = +1                                              ECSRIRTN
  8522         MOVE REIN-AH-CLM-MTH-1       TO REIN-AH-CLM-MONTHS.      ECSRIRTN
  8523     IF INC-SUB = +2                                              ECSRIRTN
  8524         MOVE REIN-AH-CLM-MTH-2       TO REIN-AH-CLM-MONTHS.      ECSRIRTN
  8525     IF INC-SUB = +3                                              ECSRIRTN
  8526         MOVE REIN-AH-CLM-MTH-3       TO REIN-AH-CLM-MONTHS.      ECSRIRTN
  8527     IF INC-SUB = +4                                              ECSRIRTN
  8528         MOVE REIN-AH-CLM-MTH-4       TO REIN-AH-CLM-MONTHS.      ECSRIRTN
  8529     IF INC-SUB = +5                                              ECSRIRTN
  8530         MOVE REIN-AH-CLM-MTH-5       TO REIN-AH-CLM-MONTHS.      ECSRIRTN
  8531                                                                  ECSRIRTN
  8532     COMPUTE REIN-RISK-AMOUNT = (RWF-AHAMT * CR-AH-TERM) -        ECSRIRTN
  8533                                (RS-AH-BEN * REIN-AH-CLM-MONTHS). ECSRIRTN
  8534                                                                  ECSRIRTN
  8535     IF REIN-RISK-AMOUNT NOT GREATER THAN +0                      ECSRIRTN
  8536         GO TO CHECK-DISABS-EXIT.                                 ECSRIRTN
  8537                                                                  ECSRIRTN
  8538     IF (RW-AH-CLM-AMT (INC-SUB) + RW-AH-CLM-EXP (INC-SUB))       ECSRIRTN
  8539              GREATER THAN REIN-RISK-AMOUNT                       ECSRIRTN
  8540         COMPUTE RW-AHCLMWK = RW-AHCLMWK + REIN-RISK-AMOUNT       ECSRIRTN
  8541     ELSE                                                         ECSRIRTN
  8542         COMPUTE RW-AHCLMWK = RW-AHCLMWK                          ECSRIRTN
  8543                             + RW-AH-CLM-AMT (INC-SUB)            ECSRIRTN
  8544                             + RW-AH-CLM-EXP (INC-SUB).           ECSRIRTN
  8545                                                                  ECSRIRTN
  8546 CHECK-DISABS-EXIT.                                               ECSRIRTN
  8547      EXIT.                                                       ECSRIRTN
  8548                                                                  ECSRIRTN
  8549 REINSURE-CALC-AH-DETAIL.                                         ECSRIRTN
  8550                                                                  ECSRIRTN
  8551     IF RW-AHCLMWK = ZEROS                                        ECSRIRTN
  8552         GO TO REINSURE-CALC-CLAIM-SKIP.                          ECSRIRTN
  8553                                                                  ECSRIRTN
  8554     IF CO-SUB NOT = ZERO                                         ECSRIRTN
  8555         IF RCT-CLM-CUTOFF-DT (CO-SUB) NOT = ZERO                 ECSRIRTN
  8556             IF CR-DIS-DT LESS RCT-CLM-CUTOFF-DT (CO-SUB)            CL*11
  8557                 GO TO REINSURE-CALC-CLAIM-SKIP.                  ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 173
* ECS150.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
  8558                                                                  ECSRIRTN
  8559     IF RWF-AH-RUNOFF-SW = 'N'                                    ECSRIRTN
  8560         IF CR-DIS-DT NOT LESS THAN RWF-EP-STOP-DATE                 CL**6
  8561             GO TO REINSURE-CALC-CLAIM-SKIP.                      ECSRIRTN
  8562                                                                  ECSRIRTN
  8563 REINSURE-CALC-AH-CONTINUED.                                      ECSRIRTN
  8564                                                                  ECSRIRTN
  8565     IF RWF-REM-AH-100 = 'Y'                                      ECSRIRTN
  8566         MOVE RW-AHCLMWK TO RWF-AHCLML                            ECSRIRTN
  8567         PERFORM REINSURE-SUB-REM-CLAIM THRU                      ECSRIRTN
  8568             REINSURE-SUB-REM-CLAIM-X                             ECSRIRTN
  8569                 VARYING SUB2 FROM +1 BY +1 UNTIL SUB2 = SUB1     ECSRIRTN
  8570         ADD RWF-AHCLML TO RWF-AHCLM                              ECSRIRTN
  8571         GO TO REINSURE-CALC-CLAIM-SKIP.                          ECSRIRTN
  8572                                                                  ECSRIRTN
  8573     IF WT-REMAINING = 'I'                                        ECSRIRTN
  8574         GO TO REINSURE-CALC-AH-RISK-CLAIM.                       ECSRIRTN
  8575                                                                  ECSRIRTN
  8576     IF WT-REMAINING = 'L'                                        ECSRIRTN
  8577         IF REIN-RT-SW = 'X'                                      ECSRIRTN
  8578             IF RW-AHCLMWK GREATER WT-AHBEN-HI                    ECSRIRTN
  8579                 MOVE WT-AHBEN-HI TO RWF-AHCLM                    ECSRIRTN
  8580             ELSE                                                 ECSRIRTN
  8581                 MOVE RW-AHCLMWK TO RWF-AHCLM                     ECSRIRTN
  8582         ELSE                                                     ECSRIRTN
  8583             IF (RW-AHCLMWK + RWF-AHCLM) GREATER WT-AHBEN-HI      ECSRIRTN
  8584                 COMPUTE RWF-AHCLML = WT-AHBEN-HI - RWF-AHCLM     ECSRIRTN
  8585                 MOVE WT-AHBEN-HI TO RWF-AHCLM                    ECSRIRTN
  8586             ELSE                                                 ECSRIRTN
  8587                 MOVE RW-AHCLMWK TO RWF-AHCLML                    ECSRIRTN
  8588                 ADD RWF-AHCLML TO RWF-AHCLM.                     ECSRIRTN
  8589                                                                  ECSRIRTN
  8590     IF WT-REMAINING = 'L'                                        ECSRIRTN
  8591         GO TO REINSURE-CALC-CLAIM-SKIP.                          ECSRIRTN
  8592                                                                  ECSRIRTN
  8593     IF CR-AHAMT NOT = ZERO                                       ECSRIRTN
  8594         COMPUTE RWF-AHCLML ROUNDED = (RW-AHCLMWK *               ECSRIRTN
  8595                            RWF-AHAMT) / CR-AHAMT                 ECSRIRTN
  8596     ELSE                                                         ECSRIRTN
  8597         IF RWF-AH-LIMIT = ZERO                                   ECSRIRTN
  8598             COMPUTE RWF-AHCLML ROUNDED =                         ECSRIRTN
  8599                       RW-AHCLMWK * WT-AH-PCT.                    ECSRIRTN
  8600                                                                  ECSRIRTN
  8601     IF CO-SUB NOT = ZERO                                         ECSRIRTN
  8602         IF RCT-AH-CLM-PCT (CO-SUB) NOT = ZERO                    ECSRIRTN
  8603             COMPUTE RWF-AHCLML ROUNDED =                         ECSRIRTN
  8604                           RW-AHCLMWK * RCT-AH-CLM-PCT (CO-SUB).  ECSRIRTN
  8605                                                                  ECSRIRTN
  8606     IF CO-SUB NOT = ZERO                                         ECSRIRTN
  8607         IF RCT-AH-CLM-MAX (CO-SUB) NOT = ZERO                    ECSRIRTN
  8608             IF REIN-RT-SW = 'X'                                  ECSRIRTN
  8609               IF RWF-AHCLML GREATER RCT-AH-CLM-MAX (CO-SUB)      ECSRIRTN
  8610                     MOVE RCT-AH-CLM-MAX (CO-SUB) TO RWF-AHCLM    ECSRIRTN
  8611                      GO TO REINSURE-CALC-CLAIM-SKIP              ECSRIRTN
  8612                  ELSE                                            ECSRIRTN
  8613                     MOVE RWF-AHCLML TO RWF-AHCLM                 ECSRIRTN
  8614                      GO TO REINSURE-CALC-CLAIM-SKIP              ECSRIRTN
  8615              ELSE                                                ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 174
* ECS150.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
  8616                 IF (RWF-AHCLML + RWF-AHCLM) GREATER              ECSRIRTN
  8617                                           RCT-AH-CLM-MAX (CO-SUB)ECSRIRTN
  8618                     COMPUTE RWF-AHCLML =                         ECSRIRTN
  8619                               RCT-AH-CLM-MAX (CO-SUB) - RWF-AHCLMECSRIRTN
  8620                     MOVE RCT-AH-CLM-MAX (CO-SUB) TO RWF-AHCLM    ECSRIRTN
  8621                      GO TO REINSURE-CALC-CLAIM-SKIP.             ECSRIRTN
  8622                                                                  ECSRIRTN
  8623                                                                  ECSRIRTN
  8624     IF DTE-CLIENT = 'FLA'                                        ECSRIRTN
  8625        IF REIN-COMP (SUB1) = ('200000' OR '210000' OR            ECSRIRTN
  8626                               '220000' OR '230000')              ECSRIRTN
  8627           PERFORM FLA-SPEC-REIN-CLMS THRU                        ECSRIRTN
  8628               E-FLA-SPEC-REIN-CLMS.                              ECSRIRTN
  8629                                                                  ECSRIRTN
  8630     ADD RWF-AHCLML TO RWF-AHCLM.                                 ECSRIRTN
  8631                                                                  ECSRIRTN
  8632     GO TO REINSURE-CALC-CLAIM-SKIP.                              ECSRIRTN
  8633                                                                  ECSRIRTN
  8634                                                                  ECSRIRTN
  8635 REINSURE-CALC-AH-RISK-CLAIM.                                     ECSRIRTN
  8636                                                                  ECSRIRTN
  8637     IF RWF-AHAMT NOT GREATER THAN +0                             ECSRIRTN
  8638         GO TO REINSURE-CALC-CLAIM-SKIP.                          ECSRIRTN
  8639                                                                  ECSRIRTN
  8640     IF REIN-RT-SW = 'X'                                          ECSRIRTN
  8641         MOVE RW-AHCLMWK              TO RWF-AHCLM                ECSRIRTN
  8642         GO TO REINSURE-CALC-CLAIM-SKIP.                          ECSRIRTN
  8643                                                                  ECSRIRTN
  8644     COMPUTE REIN-RISK-AMOUNT = (RWF-AHAMT * CR-AH-TERM) -        ECSRIRTN
  8645                                (RS-AH-BEN * REIN-AH-CLM-MONTHS). ECSRIRTN
  8646                                                                  ECSRIRTN
  8647     IF REIN-RISK-AMOUNT NOT GREATER THAN +0                      ECSRIRTN
  8648         GO TO REINSURE-CALC-CLAIM-SKIP.                          ECSRIRTN
  8649                                                                  ECSRIRTN
  8650     IF REIN-AH-PRIOR-CLMS-PAID GREATER THAN REIN-RISK-AMOUNT     ECSRIRTN
  8651         GO TO REINSURE-CALC-CLAIM-SKIP.                          ECSRIRTN
  8652                                                                  ECSRIRTN
  8653     IF (RW-AHCLMWK + REIN-AH-PRIOR-CLMS-PAID)                    ECSRIRTN
  8654                                GREATER THAN REIN-RISK-AMOUNT     ECSRIRTN
  8655         COMPUTE RWF-AHCLML = REIN-RISK-AMOUNT                    ECSRIRTN
  8656                             - REIN-AH-PRIOR-CLMS-PAID            ECSRIRTN
  8657         MOVE REIN-RISK-AMOUNT        TO RWF-AHCLM                ECSRIRTN
  8658     ELSE                                                         ECSRIRTN
  8659         MOVE RW-AHCLMWK              TO RWF-AHCLML               ECSRIRTN
  8660         ADD RW-AHCLMWK TO RWF-AHCLM.                             ECSRIRTN
  8661                                                                  ECSRIRTN
  8662                                                                  ECSRIRTN
  8663 REINSURE-CALC-CLAIM-SKIP.                                        ECSRIRTN
  8664                                                                  ECSRIRTN
  8665     IF RWF-LFCLM NOT = ZEROS                                     ECSRIRTN
  8666         MOVE 'X' TO REIN-LF-FLG (SUB1).                          ECSRIRTN
  8667                                                                  ECSRIRTN
  8668     IF RWF-AHCLM NOT = ZEROS                                     ECSRIRTN
  8669         MOVE 'X' TO REIN-AH-FLG (SUB1).                          ECSRIRTN
  8670                                                                  ECSRIRTN
  8671     GO TO REINSURE-CALC-CLAIM-X.                                 ECSRIRTN
  8672                                                                  ECSRIRTN
  8673 REINSURE-REMAINDER-CLAIM.                                        ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 175
* ECS150.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
  8674                                                                  ECSRIRTN
  8675     MOVE RW-LFCLMWK TO RWF-LFCLML.                               ECSRIRTN
  8676     MOVE RW-AHCLMWK TO RWF-AHCLML.                               ECSRIRTN
  8677                                                                  ECSRIRTN
  8678     PERFORM REINSURE-SUBTRACT-CLAIM THRU                         ECSRIRTN
  8679         REINSURE-SUBTRACT-CLAIM-X                                ECSRIRTN
  8680             VARYING SUB2 FROM +1 BY +1 UNTIL SUB2 = SUB1.        ECSRIRTN
  8681                                                                  ECSRIRTN
  8682     ADD RWF-LFCLML TO RWF-LFCLM.                                 ECSRIRTN
  8683     ADD RWF-AHCLML TO RWF-AHCLM.                                 ECSRIRTN
  8684                                                                  ECSRIRTN
  8685     IF RWF-LFCLM NOT = ZEROS                                     ECSRIRTN
  8686         MOVE 'X' TO REIN-LF-FLG (SUB1).                          ECSRIRTN
  8687                                                                  ECSRIRTN
  8688     IF RWF-AHCLM NOT = ZEROS                                     ECSRIRTN
  8689         MOVE 'X' TO REIN-AH-FLG (SUB1).                          ECSRIRTN
  8690                                                                  ECSRIRTN
  8691 REINSURE-CALC-CLAIM-X.                                           ECSRIRTN
  8692                                                                  ECSRIRTN
  8693     IF REIN-LF-AH-FLGS (SUB1) NOT = SPACES                       ECSRIRTN
  8694         MOVE 'X' TO REIN-BUS-FLAG.                               ECSRIRTN
  8695                                                                  ECSRIRTN
  8696     MOVE RWF-FIELDS TO REIN-WORK-FLDS (SUB1).                    ECSRIRTN
  8697                                                                  ECSRIRTN
  8698 REINSURE-SUBTRACT-CLAIM.                                         ECSRIRTN
  8699                                                                  ECSRIRTN
  8700     SUBTRACT REIN-LFCLML (SUB2) FROM RWF-LFCLML.                 ECSRIRTN
  8701     SUBTRACT REIN-AHCLML (SUB2) FROM RWF-AHCLML.                 ECSRIRTN
  8702                                                                  ECSRIRTN
  8703 REINSURE-SUBTRACT-CLAIM-X.                                       ECSRIRTN
  8704     EXIT.                                                        ECSRIRTN
  8705                                                                  ECSRIRTN
  8706 REINSURE-SUB-REM-CLAIM.                                          ECSRIRTN
  8707                                                                  ECSRIRTN
  8708     IF REIN-REM-SW (SUB2) = 'Y' OR 'Z' OR 'X' OR 'N'             ECSRIRTN
  8709         SUBTRACT REIN-AHCLML (SUB2) FROM RWF-AHCLML.             ECSRIRTN
  8710                                                                  ECSRIRTN
  8711 REINSURE-SUB-REM-CLAIM-X.                                        ECSRIRTN
  8712     EXIT.                                                        ECSRIRTN
  8713                                                                  ECSRIRTN
  8714                                                                  ECSRIRTN
  8715 CLEAR-REIN-HOLD.                                                 ECSRIRTN
  8716                                                                  ECSRIRTN
  8717     MOVE SPACES TO REIN-COMP (1).                                ECSRIRTN
  8718     MOVE SPACES TO REIN-LF-AH-FLGS (1).                          ECSRIRTN
  8719     MOVE SPACES TO REIN-REM-SW (1).                              ECSRIRTN
  8720     MOVE SPACES TO REIN-REM-AH-100 (1).                          ECSRIRTN
  8721                                                                  ECSRIRTN
  8722     MOVE +0 TO REIN-LFAMT (1)  REIN-LFPRM (1)  REIN-AHAMT (1)    ECSRIRTN
  8723         REIN-AHPRM (1)  REIN-LFRFND (1)  REIN-AHRFND (1)         ECSRIRTN
  8724         REIN-LFCLM (1)  REIN-AHCLM (1)  REIN-LFCLML (1)          ECSRIRTN
  8725         REIN-AHCLML (1)  REIN-DIS-IBNR (1)  REIN-DIS-PAYCUR (1)  ECSRIRTN
  8726         REIN-DIS-FUTRSV (1)  REIN-DTH-IBNR (1)                   ECSRIRTN
  8727         REIN-DTH-PAYCUR (1)  REIN-DTH-FUTRSV (1)                 ECSRIRTN
  8728         REIN-DIS-IBNRL (1)  REIN-DIS-PAYCURL (1)                 ECSRIRTN
  8729         REIN-DIS-FUTRSVL (1)  REIN-DTH-IBNRL (1)                 ECSRIRTN
  8730         REIN-DTH-PAYCURL (1)  REIN-DTH-FUTRSVL (1)               ECSRIRTN
  8731         REIN-AH-LIMIT (1).                                       ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 176
* ECS150.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
  8732                                                                  ECSRIRTN
  8733     PERFORM CLEAR-REIN-HOLD-ALL VARYING SUB1 FROM 2 BY 1         ECSRIRTN
  8734         UNTIL REIN-COMP (SUB1) = SPACES.                         ECSRIRTN
  8735                                                                  ECSRIRTN
  8736     GO TO CLEAR-REIN-HOLD-X.                                     ECSRIRTN
  8737                                                                  ECSRIRTN
  8738 CLEAR-REIN-HOLD-ALL.                                             ECSRIRTN
  8739                                                                  ECSRIRTN
  8740     MOVE REIN-LEVELS (1) TO REIN-LEVELS (SUB1).                  ECSRIRTN
  8741                                                                  ECSRIRTN
  8742 CLEAR-REIN-HOLD-X.                                               ECSRIRTN
  8743     EXIT.                                                        ECSRIRTN
  8744                                                                  ECSRIRTN
  8745 FLA-SPEC-REIN-CLMS.                                              ECSRIRTN
  8746                                                                  ECSRIRTN
  8747     MOVE +250.00 TO FLA-CLM-REIN-BASE  ADJ-FLA-REIN-BASE.        ECSRIRTN
  8748                                                                  ECSRIRTN
  8749     IF REIN-COMP (SUB1) = '230000'                               ECSRIRTN
  8750         MOVE +100.00 TO FLA-CLM-REIN-BASE  ADJ-FLA-REIN-BASE.    ECSRIRTN
  8751                                                                  ECSRIRTN
  8752     IF CR-AHAMT NOT = ZERO                                       ECSRIRTN
  8753         COMPUTE ADJ-FLA-REIN-BASE ROUNDED =                      ECSRIRTN
  8754             (RW-AHCLMWK / CR-AHAMT) * FLA-CLM-REIN-BASE.         ECSRIRTN
  8755                                                                  ECSRIRTN
  8756     IF REIN-RT-SW = 'X'                                          ECSRIRTN
  8757         MOVE CR-DIS-CC TO CIRD-CC                                ECSRIRTN
  8758         MOVE CR-DIS-YR TO CIRD-YR                                ECSRIRTN
  8759         MOVE CR-DIS-MO TO CIRD-MO                                ECSRIRTN
  8760     ELSE                                                         ECSRIRTN
  8761         MOVE DTO-CC    TO CIRD-CC                                ECSRIRTN
  8762         MOVE DTO-YR    TO CIRD-YR                                ECSRIRTN
  8763         MOVE DTO-MO    TO CIRD-MO.                               ECSRIRTN
  8764                                                                  ECSRIRTN
  8765     MOVE ZEROS TO RWF-AHCLML.                                    ECSRIRTN
  8766                                                                  ECSRIRTN
  8767     IF CLM-INCUR-REIN-DATE LESS '197809'  AND                    ECSRIRTN
  8768        CR-AHAMT GREATER FLA-CLM-REIN-BASE                        ECSRIRTN
  8769         COMPUTE RWF-AHCLML = RW-AHCLMWK - ADJ-FLA-REIN-BASE.     ECSRIRTN
  8770                                                                  ECSRIRTN
  8771     IF CLM-INCUR-REIN-DATE GREATER '197806'                      ECSRIRTN
  8772         COMPUTE RWF-AHCLML = RWF-AHCLML + (RW-AHCLMWK * +.9).    ECSRIRTN
  8773                                                                  ECSRIRTN
  8774 E-FLA-SPEC-REIN-CLMS.                                            ECSRIRTN
  8775     EXIT.                                                        ECSRIRTN
  8776                                                                  ECSRIRTN
  8777 REIN-FIND-CO-LOOP.                                               ECSRIRTN
  8778                                                                  ECSRIRTN
  8779     CONTINUE.                                                    ECSRIRTN
  8780*  DUMMY PARAGRAPH - NO CODE NEEDED.                              ECSRIRTN
  8781 FIND-REI-CO-EXIT.                                                ECSRIRTN
  8782     EXIT.                                                        ECSRIRTN
  8783                                                                  ECSRIRTN
  8784 REIN-CO-TABLE-BUILD.                                             ECSRIRTN
  8785                                                                  ECSRIRTN
  8786     PERFORM ZERO-RCT-ENTRIES THRU ZERO-RCT-EXIT                  ECSRIRTN
  8787         VARYING CO-SUB FROM 1 BY 1                               ECSRIRTN
  8788                   UNTIL CO-SUB GREATER REIN-CO-TABLE-ENT-CNT.    ECSRIRTN
  8789                                                                  ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 177
* ECS150.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
  8790     PERFORM ZERO-RC2-ENTRIES THRU ZERO-RC2-EXIT                  ECSRIRTN
  8791         VARYING CO-SUB FROM 1 BY 1                               ECSRIRTN
  8792                   UNTIL CO-SUB GREATER REIN-CO-TABLE-ENT-CNT.    ECSRIRTN
  8793                                                                  ECSRIRTN
  8794     MOVE LOW-VALUES          TO RE-CONTROL-PRIMARY.              ECSRIRTN
  8795                                                                  ECSRIRTN
  8796     START ERRTBL-IN                                              ECSRIRTN
  8797           KEY IS GREATER THAN RE-CONTROL-PRIMARY                 ECSRIRTN
  8798             INVALID KEY                                          ECSRIRTN
  8799               GO TO REIN-BUILD-EXIT.                             ECSRIRTN
  8800                                                                  ECSRIRTN
  8801     MOVE 0 TO CO-SUB.                                            ECSRIRTN
  8802     MOVE 0 TO SUB1.                                              ECSRIRTN
  8803 REIN-CO-BUILD-LOOP.                                              ECSRIRTN
  8804                                                                  ECSRIRTN
  8805     READ ERRTBL-IN  NEXT RECORD.                                 ECSRIRTN
  8806                                                                  ECSRIRTN
  8807     IF ERRTBL-FILE-STATUS = '10'                                 ECSRIRTN
  8808        GO TO REIN-BUILD-EXIT.                                    ECSRIRTN
  8809                                                                  ECSRIRTN
  8810     IF ERRTBL-FILE-STATUS NOT = ZERO                             ECSRIRTN
  8811        MOVE ERRTBL-FILE-STATUS TO WS-ABEND-FILE-STATUS           ECSRIRTN
  8812        MOVE 'READ ERROR ON FILE - ERRTBL'                        ECSRIRTN
  8813                                  TO WS-ABEND-MESSAGE             ECSRIRTN
  8814        GO TO ABEND-PGM.                                          ECSRIRTN
  8815                                                                  ECSRIRTN
  8816     IF RE-CODE NOT = 'B'                                         ECSRIRTN
  8817        GO TO REIN-CO-BUILD-LOOP.                                 ECSRIRTN
  8818                                                                  ECSRIRTN
  8819     IF RE-CLM-INCURRED-LIM NOT NUMERIC                           ECSRIRTN
  8820        MOVE ZERO TO RE-CLM-INCURRED-LIM.                         ECSRIRTN
  8821                                                                  ECSRIRTN
  8822     IF RE-EARNING-START-DT NOT NUMERIC                           ECSRIRTN
  8823        MOVE ZERO TO RE-EARNING-START-DT.                         ECSRIRTN
  8824                                                                  ECSRIRTN
  8825     IF RE-EARNING-STOP-DT NOT NUMERIC                            ECSRIRTN
  8826        MOVE ZERO TO RE-EARNING-STOP-DT.                          ECSRIRTN
  8827                                                                  ECSRIRTN
  8828     PERFORM VARYING CPSE-NDX FROM 1 BY 1 UNTIL CPSE-NDX > 1500   ECSRIRTN
  8829        MOVE RCT-CLM-CUTOFF-DT (CPSE-NDX)                         ECSRIRTN
*1118-E***************************************                         (   0)**
**    Index-name belongs to different table - unexpected behaviour may occur
  8830                        TO  WS-RCT-CLM-CUTOFF-DT-N (CPSE-NDX)        CL*12
  8831        MOVE RCT-EARNING-START-DT (CPSE-NDX)                      ECSRIRTN
*1118-E******************************************                      ( 177)**
**    Index-name belongs to different table - unexpected behaviour may occur
  8832                        TO  WS-RCT-EARNING-START-DT-N (CPSE-NDX)     CL*12
  8833        MOVE RCT-EARNING-STOP-DT (CPSE-NDX)                       ECSRIRTN
*1118-E*****************************************                       ( 177)**
**    Index-name belongs to different table - unexpected behaviour may occur
  8834                        TO  WS-RCT-EARNING-STOP-DT-N (CPSE-NDX)      CL*12
  8835     END-PERFORM.                                                 ECSRIRTN
  8836     MOVE RWF-EP-STOP-DATE       TO  WS-RWF-EP-STOP-DATE-N.          CL*12
  8837                                                                  ECSRIRTN
  8838     IF RE-LF-CLM-PCT NOT NUMERIC                                 ECSRIRTN
  8839        MOVE ZERO TO RE-LF-CLM-PCT.                               ECSRIRTN
  8840                                                                  ECSRIRTN
  8841     IF RE-AH-CLM-PCT NOT NUMERIC                                 ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 178
* ECS150.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
  8842        MOVE ZERO TO RE-AH-CLM-PCT.                               ECSRIRTN
  8843                                                                  ECSRIRTN
  8844     IF RE-LF-CLM-MAX NOT NUMERIC                                 ECSRIRTN
  8845        MOVE ZERO TO RE-LF-CLM-MAX.                               ECSRIRTN
  8846                                                                  ECSRIRTN
  8847     IF RE-AH-CLM-MAX NOT NUMERIC                                 ECSRIRTN
  8848        MOVE ZERO TO RE-AH-CLM-MAX.                               ECSRIRTN
  8849                                                                  ECSRIRTN
  8850     IF (RE-AH-CLM-MAX = ZERO) AND                                ECSRIRTN
  8851        (RE-LF-CLM-MAX = ZERO) AND                                ECSRIRTN
  8852        (RE-AH-CLM-PCT = ZERO) AND                                ECSRIRTN
  8853        (RE-LF-CLM-PCT = ZERO) AND                                ECSRIRTN
  8854        (RE-CLM-INCURRED-LIM = ZERO) AND                          ECSRIRTN
  8855        (RE-EARNING-START-DT = ZERO) AND                          ECSRIRTN
  8856        (RE-EARNING-STOP-DT = ZERO)                               ECSRIRTN
  8857          GO TO REIN-CO-BUILD-EPR.                                ECSRIRTN
  8858                                                                  ECSRIRTN
  8859     ADD +1 TO CO-SUB.                                            ECSRIRTN
  8860                                                                  ECSRIRTN
  8861     IF CO-SUB GREATER REIN-CO-TABLE-ENT-CNT                      ECSRIRTN
  8862        MOVE 0202 TO WS-RETURN-CODE                               ECSRIRTN
  8863        DISPLAY 'REINSURANCE COMPANY SAVE TABLE EXCEEDED'         ECSRIRTN
  8864        DISPLAY 'ERROR DETECTED IN ECSRIRTN, SEE ECSRITAB'        ECSRIRTN
  8865        MOVE 'REINSURANCE COMPANY SAVE TABLE EXCEEDED'            ECSRIRTN
  8866                                  TO WS-ABEND-MESSAGE             ECSRIRTN
  8867        GO TO ABEND-PGM.                                          ECSRIRTN
  8868                                                                  ECSRIRTN
  8869     MOVE RE-COMPANY           TO RCT-REIN-CO (CO-SUB).              CL**7
  8870                                                                  ECSRIRTN
  8871     MOVE RE-CLM-INCURRED-LIM  TO RCT-CLM-CUTOFF-DT (CO-SUB)      ECSRIRTN
  8872                               WS-RCT-CLM-CUTOFF-DT-N (CO-SUB).      CL*12
  8873     MOVE RE-EARNING-START-DT  TO RCT-EARNING-START-DT (CO-SUB)   ECSRIRTN
  8874                               WS-RCT-EARNING-START-DT-N (CO-SUB).   CL*12
  8875     MOVE RE-EARNING-STOP-DT   TO RCT-EARNING-STOP-DT (CO-SUB)    ECSRIRTN
  8876                               WS-RCT-EARNING-STOP-DT-N (CO-SUB).    CL*12
  8877                                                                  ECSRIRTN
  8878     IF RE-EARN-STOP-CODE = 'A'  OR  'L'                          ECSRIRTN
  8879         MOVE RE-EARN-STOP-CODE  TO RCT-EARN-STOP-CODE (CO-SUB)   ECSRIRTN
  8880     ELSE                                                         ECSRIRTN
  8881         MOVE 'B'                TO RCT-EARN-STOP-CODE (CO-SUB).  ECSRIRTN
  8882                                                                  ECSRIRTN
  8883     MOVE RE-LF-CLM-PCT  TO RCT-LF-CLM-PCT (CO-SUB).              ECSRIRTN
  8884     MOVE RE-AH-CLM-PCT  TO RCT-AH-CLM-PCT (CO-SUB).              ECSRIRTN
  8885     MOVE RE-LF-CLM-MAX  TO RCT-LF-CLM-MAX (CO-SUB).              ECSRIRTN
  8886     MOVE RE-AH-CLM-MAX  TO RCT-AH-CLM-MAX (CO-SUB).              ECSRIRTN
  8887                                                                  ECSRIRTN
  8888 REIN-CO-BUILD-EPR.                                               ECSRIRTN
  8889                                                                  ECSRIRTN
  8890     IF RE-AH-PR-PCT  NOT NUMERIC                                 ECSRIRTN
  8891        MOVE ZERO TO RE-AH-PR-PCT.                                ECSRIRTN
  8892                                                                  ECSRIRTN
  8893     IF RE-AH-78-PCT  NOT NUMERIC                                 ECSRIRTN
  8894        MOVE ZERO TO RE-AH-78-PCT.                                ECSRIRTN
  8895                                                                  ECSRIRTN
  8896     IF RE-LF-PR-PCT  NOT NUMERIC                                 ECSRIRTN
  8897        MOVE ZERO TO RE-LF-PR-PCT.                                ECSRIRTN
  8898                                                                  ECSRIRTN
  8899     IF RE-LF-78-PCT  NOT NUMERIC                                 ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 179
* ECS150.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
  8900        MOVE ZERO TO RE-LF-78-PCT.                                ECSRIRTN
  8901                                                                  ECSRIRTN
  8902     ADD +1 TO SUB1.                                              ECSRIRTN
  8903                                                                  ECSRIRTN
  8904     IF SUB1 GREATER REIN-CO-TABLE-ENT-CNT                        ECSRIRTN
  8905        MOVE 0201 TO WS-RETURN-CODE                               ECSRIRTN
  8906        MOVE 'REINSURANCE COMPANY SAVE TABLE EXCEEDED'            ECSRIRTN
  8907                                  TO WS-ABEND-MESSAGE             ECSRIRTN
  8908        GO TO ABEND-PGM.                                          ECSRIRTN
  8909                                                                  ECSRIRTN
  8910     MOVE RE-COMPANY     TO RC2-REIN-CO    (SUB1).                ECSRIRTN
  8911     MOVE RE-AH-PR-PCT   TO RC2-AH-PRO-PCT (SUB1).                ECSRIRTN
  8912     MOVE RE-AH-78-PCT   TO RC2-AH-R78-PCT (SUB1).                ECSRIRTN
  8913     MOVE RE-LF-PR-PCT   TO RC2-LF-PRO-PCT (SUB1).                ECSRIRTN
  8914     MOVE RE-LF-78-PCT   TO RC2-LF-R78-PCT (SUB1).                ECSRIRTN
  8915     MOVE RE-NAME        TO RC2-CO-NAME    (SUB1).                ECSRIRTN
  8916     if re-state-exhibit-opt-f = 'Y'
  8917        move 'Y'         to rc2-ecs152-rpt (sub1)
  8918     else
  8919        move 'N'         to rc2-ecs152-rpt (sub1)
  8920     end-if
  8921                                                                  ECSRIRTN
  8922     GO TO REIN-CO-BUILD-LOOP.                                    ECSRIRTN
  8923                                                                  ECSRIRTN
  8924 REIN-BUILD-EXIT.                                                 ECSRIRTN
  8925     EXIT.                                                        ECSRIRTN
  8926                                                                  ECSRIRTN
  8927 ZERO-RCT-ENTRIES.                                                ECSRIRTN
  8928                                                                  ECSRIRTN
  8929     MOVE SPACES TO REIN-CO-HOLD-ENTRIES (CO-SUB).                ECSRIRTN
  8930                                                                  ECSRIRTN
  8931     MOVE ZERO   TO RCT-CLM-CUTOFF-DT (CO-SUB)                    ECSRIRTN
  8932                    WS-RCT-CLM-CUTOFF-DT-N (CO-SUB)                  CL*12
  8933                    RCT-EARNING-START-DT (CO-SUB)                 ECSRIRTN
  8934                    WS-RCT-EARNING-START-DT-N (CO-SUB)               CL*12
  8935                    RCT-EARNING-STOP-DT (CO-SUB)                  ECSRIRTN
  8936                    WS-RCT-EARNING-STOP-DT-N (CO-SUB)                CL*12
  8937                    RCT-LF-CLM-PCT    (CO-SUB)                    ECSRIRTN
  8938                    RCT-AH-CLM-PCT    (CO-SUB)                    ECSRIRTN
  8939                    RCT-LF-CLM-MAX    (CO-SUB)                    ECSRIRTN
  8940                    RCT-AH-CLM-MAX    (CO-SUB).                   ECSRIRTN
  8941                                                                  ECSRIRTN
  8942 ZERO-RCT-EXIT.                                                   ECSRIRTN
  8943     EXIT.                                                        ECSRIRTN
  8944                                                                  ECSRIRTN
  8945 ZERO-RC2-ENTRIES.                                                ECSRIRTN
  8946                                                                  ECSRIRTN
  8947     MOVE SPACES TO RC2-CO-NAME (CO-SUB)                          ECSRIRTN
  8948                    RC2-REIN-CO (CO-SUB).                         ECSRIRTN
  8949     move spaces      to rc2-ecs152-rpt (co-sub)
  8950                                                                  ECSRIRTN
  8951     MOVE ZERO   TO RC2-LF-R78-PCT    (CO-SUB)                    ECSRIRTN
  8952                    RC2-LF-PRO-PCT    (CO-SUB)                    ECSRIRTN
  8953                    RC2-AH-R78-PCT    (CO-SUB)                    ECSRIRTN
  8954                    RC2-AH-PRO-PCT    (CO-SUB).                   ECSRIRTN
  8955                                                                  ECSRIRTN
  8956 ZERO-RC2-EXIT.                                                   ECSRIRTN
  8957     EXIT.                                                        ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 180
* ECS150.cbl
  8958******************************************************************ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 181
* ECS150.cbl
  8960
  8961 REM-TRM-RTN.
  8962     SUBTRACT BGN-YR FROM END-YR GIVING REM-TRM1.
  8963
  8964     IF REM-TRM1 < 0
  8965       ADD 100 TO REM-TRM1.
  8966
  8967     MULTIPLY +12 BY REM-TRM1.
  8968     SUBTRACT BGN-MO FROM END-MO GIVING TEM-TRM1.
  8969     ADD TEM-TRM1 TO REM-TRM1.
  8970
  8971     IF DTE-REM-TRM = '2'
  8972         GO TO REM-TRM-2.
  8973
  8974     SUBTRACT BGN-DA FROM END-DA GIVING TEM-TRM1.
  8975
  8976     IF TEM-TRM1 = ZERO
  8977         GO TO REM-TRM-1.
  8978
  8979     IF TEM-TRM1 IS LESS THAN -15
  8980         SUBTRACT +1 FROM REM-TRM1
  8981         GO TO REM-TRM-1.
  8982
  8983     IF TEM-TRM1 IS GREATER THAN +15
  8984         ADD +1 TO REM-TRM1
  8985         GO TO REM-TRM-0.
  8986
  8987     IF TEM-TRM1 IS GREATER THAN ZERO
  8988         GO TO REM-TRM-1.
  8989
  8990 REM-TRM-0.
  8991     SUBTRACT REM-TRM1 FROM HLD-TRM GIVING REM-TRM1.
  8992     ADD +1   REM-TRM1 GIVING REM-TRM2.
  8993     GO TO REM-TRMX.
  8994
  8995 REM-TRM-1.
  8996     SUBTRACT REM-TRM1 FROM HLD-TRM GIVING REM-TRM1.
  8997     MOVE REM-TRM1               TO REM-TRM2.
  8998     GO TO REM-TRMX.
  8999
  9000 REM-TRM-2.
  9001     SUBTRACT REM-TRM1 FROM HLD-TRM GIVING REM-TRM2.
  9002     MOVE REM-TRM2               TO REM-TRM1.
  9003     IF REM-TRM2 NOT = +0
  9004         COMPUTE REM-TRM1 = REM-TRM2 - +.5.
  9005
  9006 REM-TRMX.
  9007     EXIT.
  9008
  9009 6000-EXIT.
  9010     EXIT.
  9011
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 182
* ECS150.cbl
  9013 7000-LEVEL-BREAK-PROCESSING SECTION 40.
  9014
  9015 7100-REINS-CO-BREAK.
  9016     PERFORM 7200-CARRIER-BREAK THRU 7200-EXIT.
  9017     MOVE 1                      TO CL.
  9018     PERFORM 8200-RECORD-SETUP THRU 8200-EXIT.
  9019     MOVE 19                     TO ER-REC-TYPE.
  9020     MOVE LAST-REINS-CO          TO ER-REINS-CO.
  9021     WRITE CLAS150-EXTRACT-RECORD-B FROM CLAS150-EXTRACT-RECORD.
  9022     PERFORM 8100-CLEAR-TABLES THRU 8100-EXIT.
  9023
  9024 7100-EXIT.
  9025     EXIT.
  9026
  9027 7200-CARRIER-BREAK.
  9028     PERFORM 7300-COMPANY-BREAK THRU 7300-EXIT.
  9029     MOVE +2                     TO CL.
  9030     PERFORM 7900-ROLL-TOTALS THRU 7900-EXIT.
  9031     PERFORM 8200-RECORD-SETUP THRU 8200-EXIT.
  9032     MOVE 18                     TO ER-REC-TYPE
  9033     MOVE LAST-REINS-CO          TO ER-REINS-CO.
  9034     MOVE LAST-CARRIER           TO ER-CARRIER.
  9035     WRITE CLAS150-EXTRACT-RECORD-B FROM CLAS150-EXTRACT-RECORD.
  9036     PERFORM 8100-CLEAR-TABLES THRU 8100-EXIT.
  9037
  9038 7200-EXIT.
  9039     EXIT.
  9040
  9041 7300-COMPANY-BREAK.
  9042     PERFORM 7400-STATE-BREAK THRU 7400-EXIT.
  9043     MOVE +3                     TO CL.
  9044     PERFORM 7900-ROLL-TOTALS THRU 7900-EXIT.
  9045     PERFORM 8200-RECORD-SETUP THRU 8200-EXIT.
  9046     MOVE 17                     TO ER-REC-TYPE.
  9047     MOVE LAST-REINS-CO          TO ER-REINS-CO.
  9048     MOVE LAST-CARRIER           TO ER-CARRIER.
  9049     MOVE LAST-GROUPING          TO ER-COMPANY.
  9050     WRITE CLAS150-EXTRACT-RECORD-B FROM CLAS150-EXTRACT-RECORD.
  9051     PERFORM 8100-CLEAR-TABLES THRU 8100-EXIT.
  9052
  9053 7300-EXIT.
  9054     EXIT.
  9055
  9056 7400-STATE-BREAK.
  9057     PERFORM 7500-ACCOUNT-BREAK THRU 7500-EXIT.
  9058
  9059     IF FIRST-INS-PASS
  9060         GO TO 7450-STATE-BREAK-2.
  9061
  9062     MOVE +4                     TO CL.
  9063     PERFORM 7900-ROLL-TOTALS THRU 7900-EXIT.
  9064     PERFORM 8200-RECORD-SETUP THRU 8200-EXIT.
  9065     MOVE 16                     TO ER-REC-TYPE.
  9066     MOVE LAST-REINS-CO          TO ER-REINS-CO.
  9067     MOVE LAST-GROUPING          TO ER-COMPANY.
  9068     MOVE LAST-CARRIER           TO ER-CARRIER.
  9069     MOVE LAST-STATE             TO ER-STATE.
  9070     WRITE CLAS150-EXTRACT-RECORD-B FROM CLAS150-EXTRACT-RECORD.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 183
* ECS150.cbl
  9071     PERFORM 8100-CLEAR-TABLES THRU 8100-EXIT.
  9072     MOVE LOW-VALUES             TO ER-SORT-KEY
  9073     MOVE 20                     TO ER-REC-TYPE
  9074     MOVE LAST-REINS-CO          TO ER-REINS-CO
  9075     MOVE LAST-CARRIER           TO ER-CARRIER
  9076     MOVE LAST-GROUPING          TO ER-COMPANY
  9077     MOVE LAST-STATE             TO ER-STATE
  9078     WRITE CLAS150-EXTRACT-RECORD-C FROM CLAS150-EXTRACT-RECORD.
  9079     GO TO 7400-EXIT.
  9080
  9081 7450-STATE-BREAK-2.
  9082     MOVE +1                     TO CL.
  9083     PERFORM 8200-RECORD-SETUP THRU 8200-EXIT.
  9084     MOVE 11                     TO ER-REC-TYPE.
  9085     PERFORM 7460-WRITE-ST-EXTRACT THRU 7460-EXIT.
  9086
  9087     MOVE 09                     TO ER-REC-TYPE.
  9088     MOVE LAST-CARRIER           TO ER-CARRIER.
  9089     PERFORM 7460-WRITE-ST-EXTRACT THRU 7460-EXIT.
  9090
  9091     MOVE 07                     TO ER-REC-TYPE.
  9092     MOVE LAST-STATE             TO ER-STATE.
  9093     PERFORM 7460-WRITE-ST-EXTRACT THRU 7460-EXIT.
  9094
  9095     MOVE 05                     TO ER-REC-TYPE.
  9096     MOVE HIGH-VALUE             TO ER-STATE.
  9097     MOVE LAST-GROUPING          TO ER-COMPANY.
  9098     PERFORM 7460-WRITE-ST-EXTRACT THRU 7460-EXIT.
  9099
  9100     MOVE LAST-STATE             TO ER-STATE.
  9101     MOVE 03                     TO ER-REC-TYPE.
  9102     PERFORM 7460-WRITE-ST-EXTRACT THRU 7460-EXIT.
  9103
  9104     MOVE HIGH-VALUES            TO ER-CONTROL.
  9105     MOVE LAST-STATE             TO ER-ST-SEQ.
  9106     MOVE 13 TO                  ER-REC-TYPE.
  9107     PERFORM 7460-WRITE-ST-EXTRACT THRU 7460-EXIT.
  9108
  9109     PERFORM 8100-CLEAR-TABLES THRU 8100-EXIT.
  9110     MOVE +3                     TO CL.
  9111     PERFORM 8200-RECORD-SETUP THRU 8200-EXIT.
  9112     MOVE 12                     TO ER-REC-TYPE.
  9113     PERFORM 7460-WRITE-ST-EXTRACT THRU 7460-EXIT.
  9114
  9115     MOVE 10                     TO ER-REC-TYPE.
  9116     MOVE LAST-CARRIER           TO ER-CARRIER
  9117     PERFORM 7460-WRITE-ST-EXTRACT THRU 7460-EXIT.
  9118
  9119     MOVE 08                     TO ER-REC-TYPE.
  9120     MOVE LAST-STATE             TO ER-STATE.
  9121     PERFORM 7460-WRITE-ST-EXTRACT THRU 7460-EXIT.
  9122
  9123     MOVE 06                     TO ER-REC-TYPE.
  9124     MOVE HIGH-VALUE             TO ER-STATE.
  9125     MOVE LAST-GROUPING          TO ER-COMPANY.
  9126     PERFORM 7460-WRITE-ST-EXTRACT THRU 7460-EXIT.
  9127
  9128     MOVE 04                     TO ER-REC-TYPE.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 184
* ECS150.cbl
  9129     MOVE LAST-STATE             TO ER-STATE.
  9130     PERFORM 7460-WRITE-ST-EXTRACT THRU 7460-EXIT.
  9131
  9132     MOVE HIGH-VALUES            TO ER-CONTROL
  9133     MOVE LAST-STATE             TO ER-ST-SEQ.
  9134     MOVE 14                     TO ER-REC-TYPE.
  9135     PERFORM 7460-WRITE-ST-EXTRACT THRU 7460-EXIT.
  9136
  9137     PERFORM 8100-CLEAR-TABLES THRU 8100-EXIT.
  9138
  9139 7400-EXIT.
  9140     EXIT.
  9141
  9142 7460-WRITE-ST-EXTRACT.
  9143     WRITE CLAS150-EXTRACT-RECORD-A FROM CLAS150-EXTRACT-RECORD.
  9144
  9145 7460-EXIT.
  9146     EXIT.
  9147
  9148 7500-ACCOUNT-BREAK.
  9149     COMPUTE TERM-WORK = PERIOD-END-9 - PERIOD-START-9.
  9150
  9151     PERFORM 7505-ADJ-OB-TOTS THRU 7505-EXIT
  9152         VARYING TG FROM 1 BY 1
  9153             UNTIL TG GREATER +3.
  9154
  9155     GO TO 7510-ACCT-REIN-BREAK.
  9156
  9157 7505-ADJ-OB-TOTS.
  9158     IF REINSURANCE-PASS
  9159         MOVE +5                 TO CL
  9160         PERFORM 7507-OB-DIVIDE THRU 7507-EXIT
  9161     ELSE
  9162         MOVE +2                 TO CL
  9163         PERFORM 7507-OB-DIVIDE THRU 7507-EXIT
  9164         MOVE +4                 TO CL
  9165         PERFORM 7507-OB-DIVIDE THRU 7507-EXIT.
  9166
  9167 7505-EXIT.
  9168     EXIT.
  9169
  9170 7507-OB-DIVIDE.
  9171*    IF ISSUE-AMT (CL  TG  3) NOT = 0
  9172*        DIVIDE 12 INTO ISSUE-AMT (CL  TG  3)
  9173*        MOVE +1                 TO ISSUE-CNT (CL  TG  3).
  9174*
  9175*    IF ISSUE-AMT (CL  TG  8) NOT = 0
  9176*        DIVIDE 12 INTO ISSUE-AMT (CL  TG  8)
  9177*        MOVE +1                 TO ISSUE-CNT (CL  TG  8).
  9178*
  9179*    IF ISSUE-AMT (CL  TG  5) NOT = 0
  9180*        DIVIDE 12 INTO ISSUE-AMT (CL  TG  5)
  9181*        MOVE +1                 TO ISSUE-CNT (CL  TG  5).
  9182*
  9183*    IF ISSUE-AMT (CL  TG  10) NOT = 0
  9184*        DIVIDE 12 INTO ISSUE-AMT (CL  TG  10)
  9185*        MOVE +1                 TO ISSUE-CNT (CL  TG  10).
  9186
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 185
* ECS150.cbl
  9187 7507-EXIT.
  9188     EXIT.
  9189
  9190 7510-ACCT-REIN-BREAK.
  9191     IF FIRST-INS-PASS
  9192         GO TO 7550-ACCNT-BREAK-2.
  9193
  9194     MOVE +5                     TO CL.
  9195     PERFORM 7900-ROLL-TOTALS THRU 7900-EXIT.
  9196     PERFORM 8200-RECORD-SETUP THRU 8200-EXIT.
  9197     MOVE SAVE-CONTROL-BREAKS    TO ER-CONTROL.
  9198     MOVE 15                     TO ER-REC-TYPE.
  9199     WRITE CLAS150-EXTRACT-RECORD-B FROM CLAS150-EXTRACT-RECORD.
  9200
  9201     IF DTE-PGM-OPT = 1
  9202         PERFORM 5200-PRINT-SUMMARY-TOTALS THRU 5200-EXIT.
  9203
  9204     PERFORM 8100-CLEAR-TABLES THRU 8100-EXIT.
  9205     GO TO 7500-EXIT.
  9206
  9207 7550-ACCNT-BREAK-2.
  9208     MOVE +2                     TO CL.
  9209     PERFORM 7900-ROLL-TOTALS THRU 7900-EXIT.
  9210     PERFORM 8200-RECORD-SETUP THRU 8200-EXIT.
  9211     MOVE SAVE-CONTROL-BREAKS    TO ER-CONTROL.
  9212     MOVE 01                     TO ER-REC-TYPE.
  9213     WRITE CLAS150-EXTRACT-RECORD-A FROM CLAS150-EXTRACT-RECORD.
  9214
  9215     MOVE +4                     TO CL.
  9216     PERFORM 7900-ROLL-TOTALS THRU 7900-EXIT.
  9217     PERFORM 8200-RECORD-SETUP THRU 8200-EXIT.
  9218     MOVE SAVE-CONTROL-BREAKS    TO ER-CONTROL.
  9219     MOVE 02                     TO ER-REC-TYPE.
  9220     WRITE CLAS150-EXTRACT-RECORD-A FROM CLAS150-EXTRACT-RECORD.
  9221
  9222     IF DTE-PGM-OPT = 1
  9223         PERFORM 5200-PRINT-SUMMARY-TOTALS THRU 5200-EXIT.
  9224     MOVE +4                     TO CL.
  9225     PERFORM 8100-CLEAR-TABLES THRU 8100-EXIT.
  9226     MOVE +2                     TO CL.
  9227     PERFORM 8100-CLEAR-TABLES THRU 8100-EXIT.
  9228
  9229 7500-EXIT.
  9230     EXIT.
  9231
  9232 7900-ROLL-TOTALS.
  9233     COMPUTE CLX = CL - 1.
  9234     ADD CORRESPONDING A-CONTROL-LEVELS (CL) TO
  9235                       A-CONTROL-LEVELS (CLX).
  9236     PERFORM 7910-TERM-LOOP THRU 7910-EXIT
  9237         VARYING TG FROM +1 BY +1
  9238             UNTIL TG GREATER +3.
  9239
  9240 7900-EXIT.
  9241     EXIT.
  9242
  9243 7910-TERM-LOOP.
  9244     PERFORM 7920-ROLL-ACTIVITY THRU 7920-EXIT
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 186
* ECS150.cbl
  9245         VARYING IY FROM +1 BY +1
  9246             UNTIL IY GREATER +10.
  9247     PERFORM 7930-ROLL-EXHIBIT THRU 7930-EXIT
  9248         VARYING EG FROM +1 BY +1
  9249             UNTIL EG GREATER +9.
  9250
  9251 7910-EXIT.
  9252     EXIT.
  9253
  9254 7920-ROLL-ACTIVITY.
  9255     ADD CORRESPONDING INSURANCE-TYPES (CL  TG  IY) TO
  9256                       INSURANCE-TYPES (CLX  TG  IY).
  9257
  9258 7920-EXIT.
  9259     EXIT.
  9260
  9261 7930-ROLL-EXHIBIT.
  9262     ADD CORRESPONDING EXHIBIT-GROUPS (CL  TG  EG) TO
  9263                       EXHIBIT-GROUPS (CLX  TG  EG).
  9264
  9265 7930-EXIT.
  9266     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 187
* ECS150.cbl
  9268 8000-MISCELANEOUS-ROUTINES  SECTION 32.
  9269
  9270 8100-CLEAR-TABLES.
  9271     MOVE ZERO                   TO AH-PAID-THIS-YR (CL)
  9272                                    AH-PAID-LAST-YR (CL).
  9273
  9274     PERFORM 8110-ZERO-TERM-GROUPS THRU 8110-EXIT
  9275         VARYING TG FROM +1 BY +1
  9276             UNTIL TG GREATER THAN 3.
  9277
  9278 8100-EXIT.
  9279     EXIT.
  9280
  9281 8110-ZERO-TERM-GROUPS.
  9282     PERFORM 8120-ZERO-ACTIVITY THRU 8120-EXIT
  9283         VARYING IY FROM +1 BY +1
  9284             UNTIL IY GREATER +10.
  9285
  9286     PERFORM 8130-ZERO-EXHIBIT THRU 8130-EXIT
  9287         VARYING EG FROM +1 BY +1
  9288             UNTIL EG GREATER +9.
  9289
  9290 8110-EXIT.
  9291     EXIT.
  9292
  9293 8120-ZERO-ACTIVITY.
  9294     MOVE ZERO                  TO ISSUE-CNT   (CL  TG  IY)
  9295                                   ISSUE-AMT   (CL  TG  IY)
  9296                                   ISSUE-PREM  (CL  TG  IY)
  9297                                   CANCEL-CNT  (CL  TG  IY)
  9298                                   CANCEL-PREM (CL  TG  IY)
  9299                                   CANCEL-AMT  (CL  TG  IY)
  9300                                   CLAIM-CNT   (CL  TG  IY)
  9301                                   CLAIM-AMT   (CL  TG  IY)
  9302                                   EARN-PREM   (CL  TG  IY).
  9303
  9304 8120-EXIT.
  9305     EXIT.
  9306
  9307 8130-ZERO-EXHIBIT.
  9308     MOVE ZERO                  TO GROUP-CNT (CL  TG  EG)
  9309                                   GROUP-AMT (CL  TG  EG)
  9310                                   IND-CNT   (CL  TG  EG)
  9311                                   IND-AMT   (CL  TG  EG).
  9312
  9313 8130-EXIT.
  9314     EXIT.
  9315
  9316 8200-RECORD-SETUP.
  9317     MOVE LOW-VALUES             TO ER-SORT-KEY.
  9318     MOVE RUN-DATE               TO ER-PERIOD-START.
  9319     MOVE EP-DT                  TO ER-PERIOD-END.
  9320     MOVE CONTROL-LEVELS (CL)    TO ER-ACTIVITY-TOTALS.
  9321     MOVE E-CONTROL-LEVELS (CL)  TO ER-EXHIBIT-TOTALS.
  9322     MOVE AH-PAID-THIS-YR (CL)   TO ER-AH-PD-THIS.
  9323     MOVE AH-PAID-LAST-YR (CL)   TO ER-AH-PD-LAST.
  9324     MOVE HIGH-VALUES            TO ER-CONTROL.
  9325
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 188
* ECS150.cbl
  9326 8200-EXIT.
  9327     EXIT.
  9328
  9329 8300-STARTING-INFORCE.
  9330
  9331     IF CR-LFAMT-ALT NOT NUMERIC
  9332         MOVE ZEROS TO CR-LFAMT-ALT.
  9333
  9334     IF CR-ENTRY-STATUS = '3' OR '5'
  9335         MOVE ZERO               TO INFORCE-DOLLARS
  9336         GO TO 8300-EXIT.
  9337
  9338     IF SUMMARY-REC
  9339         NEXT SENTENCE
  9340       ELSE
  9341          MOVE CR-LFAMT          TO INFORCE-DOLLARS.
  9342
  9343     IF CLAS-I-RL-AH (CLAS-INDEXL) = 'L' OR 'P'
  9344         GO TO 8390-OB-ADJ.
  9345
  9346     MOVE CR-CC                  TO WS-CR-CCYY (1:2).
  9347     MOVE CR-YR                  TO WS-CR-CCYY (3:2).
  9348
  9349     COMPUTE VALUATION-DATE = CR-LF-TERM -
  9350       (((RUN-CCYY * 12) + RUN-MO) -
  9351                            ((WS-CR-CCYY * 12) + CR-MO)).
  9352
  9353     MOVE SAVE-REM-TERM              TO UNEXPIRED-MONTHS.
  9354     COMPUTE EXPIRED-MONTHS = CR-LF-TERM - UNEXPIRED-MONTHS.
  9355
  9356     IF SAVE-REM-TERM  = CR-LF-TERM
  9357         MOVE CR-LFAMT  TO  INFORCE-DOLLARS
  9358         IF CLAS-I-EP (CLAS-INDEXL) = 'B'
  9359             ADD CR-LFAMT-ALT      TO INFORCE-DOLLARS
  9360             GO TO 8300-EXIT
  9361         ELSE
  9362             GO TO 8300-EXIT.
  9363
  9364     IF UNEXPIRED-MONTHS NOT GREATER ZERO
  9365         IF LF-BAL-REMTRM NOT GREATER THAN ZERO
  9366             MOVE ZEROS TO INFORCE-DOLLARS
  9367             GO TO 8300-EXIT.
  9368
  9369
  9370     if dte-client = 'AHL'
  9371        if cr-loan-term = zeros
  9372           move cr-lf-term       to cr-loan-term
  9373        end-if
  9374     end-if
  9375
  9376     IF SUMMARY-REC
  9377        COMPUTE TEMP-RESULT-L ROUNDED =
  9378                         INFORCE-DOLLARS / CR-LF-TERM
  9379     ELSE
  9380        if dte-client = 'AHL'
  9381           compute temp-result-l rounded =
  9382              cr-lfamt / cr-loan-term
  9383           compute unexpired-months = unexpired-months +
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 189
* ECS150.cbl
  9384              (cr-loan-term - cr-lf-term)
  9385        else
  9386           COMPUTE TEMP-RESULT-L ROUNDED =
  9387                         CR-LFAMT / CR-LF-TERM
  9388        end-if
  9389     end-if
  9390
  9391     IF REINSURANCE-PASS OR REINSURANCE-REC
  9392        IF CLAS-I-EP (CLAS-INDEXL) = 'B'
  9393            COMPUTE TEMP-RESULT-L ROUNDED  =
  9394            (RC-ORIG-LFAMT * RC-CEDE-FACT) / CR-LF-TERM.
  9395
  9396     IF CLAS-I-EP (CLAS-INDEXL) = 'T'
  9397         GO TO 8310-TEXAS-INFORCE.
  9398
  9399     IF CLAS-I-EP (CLAS-INDEXL) = 'N'
  9400         GO TO 8320-NET-PAY-INFORCE.
  9401
  9402     IF DTE-CLIENT EQUAL 'FLU'
  9403         GO TO 8325-FLU-INFORCE.
  9404
  9405     IF CR-LFTYP = 'QD'
  9406        MOVE +15.0               TO CR-APR
  9407        GO TO 8320-NET-PAY-INFORCE
  9408     END-IF
  9409
  9410*    IF STATE-ABBR (CLAS-INDEXS) = 'OH'
  9411     IF (STATE-ABBR (CLAS-INDEXS) = 'OH') AND
  9412        (CR-RATING-CLASS NOT = 'L ')
  9413         IF (CR-DT GREATER THAN 19831031) AND
  9414            (CR-LF-TERM GREATER THAN +60)  AND
  9415            (CR-APR GREATER THAN ZERO)
  9416             GO TO 8320-NET-PAY-INFORCE.
  9417
  9418     IF STATE-ABBR (CLAS-INDEXS) = 'MT'
  9419         IF (CR-DT GREATER THAN 19830318) AND
  9420            (CR-LF-TERM GREATER THAN +61)  AND
  9421            (CR-APR GREATER THAN ZERO)
  9422             GO TO 8320-NET-PAY-INFORCE.
  9423
  9424     IF STATE-ABBR (CLAS-INDEXS) = 'UT'
  9425         IF (CR-DT GREATER THAN 19810831) AND
  9426            (CR-DT LESS THAN 19830901) AND
  9427            (CR-LF-TERM GREATER THAN +62)  AND
  9428            (CR-APR GREATER THAN ZERO)
  9429             GO TO 8320-NET-PAY-INFORCE.
  9430
  9431     IF STATE-ABBR (CLAS-INDEXS) = 'RI'
  9432         IF (CR-DT GREATER THAN 19831231) AND
  9433            (CR-LF-TERM GREATER THAN +60)  AND
  9434            (CR-APR GREATER THAN ZERO)
  9435             GO TO 8320-NET-PAY-INFORCE.
  9436
  9437 8305-REG-INFORCE.
  9438
  9439     COMPUTE INFORCE-DOLLARS ROUNDED =
  9440         (TEMP-RESULT-L * UNEXPIRED-MONTHS) + CR-LFAMT-ALT.
  9441
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 190
* ECS150.cbl
  9442     IF REINSURANCE-PASS OR REINSURANCE-REC
  9443        IF CLAS-I-EP (CLAS-INDEXL) = 'B'
  9444         COMPUTE INFORCE-DOLLARS ROUNDED =
  9445          (TEMP-RESULT-L * UNEXPIRED-MONTHS) +
  9446          (CR-LFAMT-ALT * RC-CEDE-FACT).
  9447
  9448     GO TO 8390-OB-ADJ.
  9449
  9450 8310-TEXAS-INFORCE.
  9451     DIVIDE CR-LFAMT  BY  CR-LF-TERM
  9452         GIVING TEX-FACT-1.
  9453
  9454     DIVIDE UNEXPIRED-MONTHS  BY  CR-PMT-FREQ
  9455         GIVING TEX-FACT-2
  9456         REMAINDER TEX-FACT-3.
  9457
  9458     IF TEX-FACT-3 NOT ZERO
  9459         ADD +1 TO TEX-FACT-2.
  9460
  9461     IF (TEX-FACT-2 * CR-PMT-FREQ) = CR-LF-TERM
  9462         MOVE CR-LFAMT  TO  INFORCE-DOLLARS
  9463     ELSE
  9464         COMPUTE INFORCE-DOLLARS ROUNDED =
  9465             (TEX-FACT-1 * (TEX-FACT-2 * CR-PMT-FREQ)).
  9466
  9467     GO TO 8390-OB-ADJ.
  9468
  9469 8320-NET-PAY-INFORCE.
  9470
  9471     MOVE CR-DT                  TO  DC-GREG-DATE-CYMD.
  9472     MOVE 'L'                    TO  DC-OPTION-CODE.
  9473     PERFORM 8500-DATE-CONVERT-ROUTINE THRU
  9474             8599-DATE-CONVERT-X
  9475
  9476     MOVE DC-BIN-DATE-1          TO  CP-CERT-EFF-DT.
  9477
  9478     IF CR-LOAN-1ST-PMT-DT NOT = ZEROS
  9479         MOVE CR-LOAN-1ST-PMT-DT TO  DC-GREG-DATE-1-YMD
  9480         MOVE '3'                TO  DC-OPTION-CODE
  9481         PERFORM 8500-DATE-CONVERT-ROUTINE THRU
  9482                 8599-DATE-CONVERT-X
  9483         MOVE DC-BIN-DATE-1      TO  CP-FIRST-PAY-DATE
  9484     ELSE
  9485         MOVE CP-CERT-EFF-DT     TO  DC-BIN-DATE-1
  9486         MOVE +1                 TO  DC-ELAPSED-MONTHS
  9487         MOVE +0                 TO  DC-ELAPSED-DAYS
  9488         MOVE '6'                TO  DC-OPTION-CODE
  9489         PERFORM 8500-DATE-CONVERT-ROUTINE THRU
  9490             8599-DATE-CONVERT-X
  9491         MOVE DC-BIN-DATE-2      TO  CP-FIRST-PAY-DATE.
  9492
  9493     MOVE CR-LFAMT               TO  CP-ORIGINAL-BENEFIT.
  9494     MOVE CR-APR                 TO  CP-LOAN-APR.
  9495     MOVE CR-LF-TERM             TO  CP-ORIGINAL-TERM.
  9496     MOVE CR-LOAN-TERM           TO  CP-LOAN-TERM.
  9497     MOVE SAVE-REM-TERM          TO  CP-REMAINING-TERM.
  9498     MOVE STATE-ABBR       (CLAS-INDEXS) TO  CP-STATE-STD-ABBRV.
  9499     MOVE CLAS-I-CALC-TYPE (CLAS-INDEXL) TO  CP-SPECIAL-CALC-CD.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 191
* ECS150.cbl
  9500     MOVE CLAS-I-RL-AH     (CLAS-INDEXL) TO  CP-BENEFIT-TYPE.
  9501     MOVE CLAS-I-EP        (CLAS-INDEXL) TO  CP-EARNING-METHOD.
  9502
  9503     if dte-client = 'AHL'
  9504        move +14                 to cp-loan-apr
  9505     end-if
  9506
  9507     CALL 'ELRAMTX' USING CALCULATION-PASS-AREA.
  9508
  9509     IF SUMMARY-REC
  9510         COMPUTE INFORCE-DOLLARS ROUNDED = CP-REMAMT-FACTOR *
  9511                                      (INFORCE-DOLLARS / +1000)
  9512         GO TO 8390-OB-ADJ.
  9513
  9514     IF CP-STATE-STD-ABBRV = 'NC'
  9515               AND
  9516*      DTE-CLIENT NOT = 'WDS'
  9517       (DTE-CLIENT NOT = 'WDS' AND 'CID')
  9518         IF CP-CERT-EFF-DT GREATER THAN WS-931231
  9519             MOVE CP-REMAINING-AMT TO  INFORCE-DOLLARS
  9520             GO TO 8390-OB-ADJ.
  9521
  9522      COMPUTE INFORCE-DOLLARS ROUNDED = CP-REMAMT-FACTOR *
  9523                                      (CR-LFAMT / +1000).
  9524     move cp-remaining-amt       to inforce-dollars
  9525
  9526     GO TO 8390-OB-ADJ.
  9527
  9528 8325-FLU-INFORCE.
  9529     MOVE CR-APR                 TO NP-APR.
  9530     MOVE CR-LF-TERM             TO NP-ORIG  NP-CAP.
  9531     COMPUTE NP251-REM = CR-LF-TERM - TERM-WORK.
  9532     MOVE '1'                    TO NP-OPT.
  9533     MOVE CR-AHPRM               TO NP-AHPRM.
  9534     MOVE CR-ACCOUNT             TO NP-ACCOUNT.
  9535     MOVE CR-DT                  TO NP-EFF-DT.
  9536     MOVE CR-LFAMT               TO NP-BENEFIT.
  9537***  CALL 'IBKE251B'
  9538***      USING NP-ACCOUNT NP-EFF-DT NP-BENEFIT NP-AHPRM NP251-REM
  9539***            NP251-ORIG NP-SUB NP-REMAINING.
  9540     MOVE NP-REMAINING           TO INFORCE-DOLLARS.
  9541     GO TO 8390-OB-ADJ.
  9542
  9543 8350-ENDING-INFORCE.
  9544     IF CR-LFAMT-ALT NOT NUMERIC
  9545         MOVE ZEROS TO CR-LFAMT-ALT.
  9546
  9547     IF CR-ENTRY-STATUS = '3' OR '5'
  9548         MOVE ZERO               TO INFORCE-DOLLARS
  9549         GO TO 8300-EXIT.
  9550
  9551     IF SUMMARY-REC
  9552         NEXT SENTENCE
  9553       ELSE
  9554          MOVE CR-LFAMT          TO INFORCE-DOLLARS.
  9555
  9556     IF CLAS-I-RL-AH (CLAS-INDEXL) = 'L' OR 'P'
  9557         IF CLAS-I-EP (CLAS-INDEXL) = 'B'
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 192
* ECS150.cbl
  9558             ADD CR-LFAMT-ALT    TO INFORCE-DOLLARS
  9559             GO TO 8390-OB-ADJ
  9560         ELSE
  9561             GO TO 8390-OB-ADJ.
  9562
  9563     MOVE CP-REMAINING-TERM-2        TO UNEXPIRED-MONTHS.
  9564     COMPUTE EXPIRED-MONTHS = CR-LF-TERM - UNEXPIRED-MONTHS.
  9565
  9566     IF CP-REMAINING-TERM-2 = CR-LF-TERM
  9567         MOVE CR-LFAMT  TO  INFORCE-DOLLARS
  9568         IF CLAS-I-EP (CLAS-INDEXL) = 'B'
  9569            IF REINSURANCE-PASS OR REINSURANCE-REC
  9570                NEXT SENTENCE
  9571            ELSE
  9572                ADD CR-LFAMT-ALT    TO INFORCE-DOLLARS
  9573                GO TO 8390-OB-ADJ
  9574         ELSE
  9575             GO TO 8300-EXIT.
  9576
  9577     IF UNEXPIRED-MONTHS NOT GREATER ZERO
  9578         IF LF-BAL-REMTRM NOT GREATER THAN ZERO
  9579             MOVE ZEROS TO INFORCE-DOLLARS
  9580             GO TO 8300-EXIT.
  9581
  9582     MOVE CR-CC                  TO WS-CR-CCYY (1:2).
  9583     MOVE CR-YR                  TO WS-CR-CCYY (3:2).
  9584     COMPUTE VALUATION-DATE = CR-LF-TERM -
  9585        (((EP-CCYY * 12) + EP-MO)
  9586                    - ((WS-CR-CCYY * 12) + CR-MO)).
  9587
  9588     if dte-client = 'AHL'
  9589        if cr-loan-term = zeros
  9590           move cr-lf-term       to cr-loan-term
  9591        end-if
  9592     end-if
  9593
  9594     IF SUMMARY-REC
  9595         COMPUTE TEMP-RESULT-L ROUNDED =
  9596                           INFORCE-DOLLARS / CR-LF-TERM
  9597     ELSE
  9598        if dte-client = 'AHL'
  9599           compute temp-result-l rounded =
  9600              cr-lfamt / cr-loan-term
  9601           compute unexpired-months = unexpired-months +
  9602              (cr-loan-term - cr-lf-term)
  9603        else
  9604           COMPUTE TEMP-RESULT-L ROUNDED =
  9605              CR-LFAMT / CR-LF-TERM
  9606        end-if
  9607     end-if
  9608
  9609     IF REINSURANCE-PASS OR REINSURANCE-REC
  9610        IF CLAS-I-EP (CLAS-INDEXL) = 'B'
  9611         COMPUTE TEMP-RESULT-L ROUNDED =
  9612          (RC-ORIG-LFAMT * RC-CEDE-FACT) / CR-LF-TERM.
  9613
  9614     IF CLAS-I-EP (CLAS-INDEXL) = 'B'
  9615         GO TO 8355-NORMAL-ENDING.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 193
* ECS150.cbl
  9616
  9617     IF CLAS-I-EP (CLAS-INDEXL) = 'T'
  9618         GO TO 8360-TEXAS-ENDING.
  9619
  9620     IF DTE-CLIENT = 'NCL'
  9621       IF CR-DT LESS 19910101
  9622         GO TO 8355-NORMAL-ENDING.
  9623
  9624     IF CLAS-I-EP (CLAS-INDEXL) = 'N'
  9625         GO TO 8370-NET-PAY-ENDING.
  9626
  9627     IF DTE-CLIENT = 'FLU'
  9628         GO TO 8375-FLU-ENDING.
  9629
  9630     IF CR-LFTYP = 'QD'
  9631        MOVE +15.0               TO CR-APR
  9632        GO TO 8370-NET-PAY-ENDING
  9633     END-IF
  9634
  9635*    IF STATE-ABBR (CLAS-INDEXS) = 'OH'
  9636     IF (STATE-ABBR (CLAS-INDEXS) = 'OH') AND
  9637        (CR-RATING-CLASS NOT = 'L ')
  9638         IF (CR-DT GREATER THAN 19831031) AND
  9639            (CR-LF-TERM GREATER THAN +60) AND
  9640            (CR-APR GREATER THAN ZERO)
  9641             GO TO 8370-NET-PAY-ENDING.
  9642
  9643     IF STATE-ABBR (CLAS-INDEXS) = 'MT'
  9644         IF (CR-DT GREATER THAN 19830318) AND
  9645            (CR-LF-TERM GREATER THAN +61) AND
  9646            (CR-APR GREATER THAN ZERO)
  9647             GO TO 8370-NET-PAY-ENDING.
  9648
  9649     IF STATE-ABBR (CLAS-INDEXS) = 'UT'
  9650         IF (CR-DT GREATER THAN 19810831 ) AND
  9651            (CR-DT LESS THAN 19830901 ) AND
  9652            (CR-LF-TERM GREATER THAN +62) AND
  9653            (CR-APR GREATER THAN ZERO)
  9654             GO TO 8370-NET-PAY-ENDING.
  9655
  9656     IF STATE-ABBR (CLAS-INDEXS) = 'RI'
  9657         IF (CR-DT GREATER THAN 19831231) AND
  9658            (CR-LF-TERM GREATER THAN +60) AND
  9659            (CR-APR GREATER THAN ZERO)
  9660             GO TO 8370-NET-PAY-ENDING.
  9661
  9662 8355-NORMAL-ENDING.
  9663
  9664     COMPUTE INFORCE-DOLLARS ROUNDED =
  9665        (TEMP-RESULT-L * UNEXPIRED-MONTHS) + CR-LFAMT-ALT.
  9666
  9667     IF REINSURANCE-PASS OR REINSURANCE-REC
  9668         IF CLAS-I-EP (CLAS-INDEXL) = 'B'
  9669          COMPUTE INFORCE-DOLLARS ROUNDED =
  9670          (TEMP-RESULT-L * UNEXPIRED-MONTHS) +
  9671          (CR-LFAMT-ALT * RC-CEDE-FACT).
  9672
  9673     GO TO 8390-OB-ADJ.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 194
* ECS150.cbl
  9674
  9675 8360-TEXAS-ENDING.
  9676     DIVIDE CR-LFAMT  BY  CR-LF-TERM
  9677         GIVING TEX-FACT-1.
  9678     DIVIDE UNEXPIRED-MONTHS  BY  CR-PMT-FREQ
  9679         GIVING TEX-FACT-2
  9680         REMAINDER TEX-FACT-3.
  9681     IF TEX-FACT-3 NOT ZERO
  9682         ADD +1 TO TEX-FACT-2.
  9683     IF (TEX-FACT-2 * CR-PMT-FREQ) = CR-LF-TERM
  9684         MOVE CR-LFAMT  TO  INFORCE-DOLLARS
  9685     ELSE
  9686         COMPUTE INFORCE-DOLLARS ROUNDED =
  9687             (TEX-FACT-1 * (TEX-FACT-2 * CR-PMT-FREQ)).
  9688
  9689****************************************************************
  9690*    DIVIDE VALUATION-DATE BY CR-PMT-FREQ
  9691*        GIVING TEX-FACT-2
  9692*            REMAINDER TEX-FACT-3.
  9693*    IF TEX-FACT-3 NOT = ZERO
  9694*        ADD +1 TO TEX-FACT-2.
  9695*    COMPUTE INFORCE-DOLLARS =
  9696*         (TEMP-RESULT-L * (TEX-FACT-2 * CR-PMT-FREQ)).
  9697
  9698     GO TO 8390-OB-ADJ.
  9699
  9700 8370-NET-PAY-ENDING.
  9701
  9702     MOVE CR-DT                  TO  DC-GREG-DATE-CYMD.
  9703     MOVE 'L'                    TO  DC-OPTION-CODE.
  9704     PERFORM 8500-DATE-CONVERT-ROUTINE THRU
  9705             8599-DATE-CONVERT-X.
  9706     MOVE DC-BIN-DATE-1          TO  CP-CERT-EFF-DT.
  9707
  9708     IF CR-LOAN-1ST-PMT-DT NOT = ZEROS
  9709         MOVE CR-LOAN-1ST-PMT-DT TO  DC-GREG-DATE-1-YMD
  9710         MOVE '3'                TO  DC-OPTION-CODE
  9711         PERFORM 8500-DATE-CONVERT-ROUTINE THRU
  9712                 8599-DATE-CONVERT-X
  9713         MOVE DC-BIN-DATE-1      TO  CP-FIRST-PAY-DATE
  9714     ELSE
  9715         MOVE CP-CERT-EFF-DT     TO  DC-BIN-DATE-1
  9716         MOVE +1                 TO  DC-ELAPSED-MONTHS
  9717         MOVE +0                 TO  DC-ELAPSED-DAYS
  9718         MOVE '6'                TO  DC-OPTION-CODE
  9719         PERFORM 8500-DATE-CONVERT-ROUTINE THRU
  9720                 8599-DATE-CONVERT-X
  9721         MOVE DC-BIN-DATE-2      TO  CP-FIRST-PAY-DATE.
  9722
  9723     MOVE CR-LFAMT               TO  CP-ORIGINAL-BENEFIT.
  9724     MOVE CR-APR                 TO  CP-LOAN-APR.
  9725     MOVE CR-LF-TERM             TO  CP-ORIGINAL-TERM.
  9726     MOVE CR-LOAN-TERM           TO  CP-LOAN-TERM.
  9727     MOVE CP-REMAINING-TERM-2    TO  CP-REMAINING-TERM.
  9728     MOVE STATE-ABBR       (CLAS-INDEXS) TO  CP-STATE-STD-ABBRV.
  9729     MOVE CLAS-I-CALC-TYPE (CLAS-INDEXL) TO  CP-SPECIAL-CALC-CD.
  9730     MOVE CLAS-I-RL-AH     (CLAS-INDEXL) TO  CP-BENEFIT-TYPE.
  9731     MOVE CLAS-I-EP        (CLAS-INDEXL) TO  CP-EARNING-METHOD.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 195
* ECS150.cbl
  9732
  9733
  9734     if dte-client = 'AHL'
  9735        move +14                 to cp-loan-apr
  9736     end-if
  9737
  9738     CALL 'ELRAMTX' USING CALCULATION-PASS-AREA.
  9739
  9740     IF SUMMARY-REC
  9741         COMPUTE INFORCE-DOLLARS ROUNDED = CP-REMAMT-FACTOR *
  9742                                      (INFORCE-DOLLARS / +1000)
  9743         GO TO 8390-OB-ADJ.
  9744
  9745     IF CP-STATE-STD-ABBRV = 'NC'
  9746               AND
  9747*      DTE-CLIENT NOT = 'WDS'
  9748       (DTE-CLIENT NOT = 'WDS' AND 'CID')
  9749         IF CP-CERT-EFF-DT GREATER THAN WS-931231
  9750             MOVE CP-REMAINING-AMT TO INFORCE-DOLLARS
  9751             GO TO 8390-OB-ADJ.
  9752
  9753      COMPUTE INFORCE-DOLLARS ROUNDED = CP-REMAMT-FACTOR *
  9754                                      (CR-LFAMT / +1000).
  9755     move cp-remaining-amt       to inforce-dollars
  9756
  9757     GO TO 8390-OB-ADJ.
  9758
  9759 8375-FLU-ENDING.
  9760     MOVE CR-APR                 TO NP-APR.
  9761     MOVE CR-LF-TERM             TO NP-ORIG  NP-CAP.
  9762     COMPUTE NP251-REM = CR-LF-TERM - TERM-WORK.
  9763     MOVE '1'                    TO NP-OPT.
  9764     MOVE CR-AHPRM               TO NP-AHPRM.
  9765     MOVE CR-ACCOUNT             TO NP-ACCOUNT.
  9766     MOVE CR-DT                  TO NP-EFF-DT.
  9767     MOVE CR-LFAMT               TO NP-BENEFIT.
  9768***  CALL 'IBKE251B'
  9769***      USING NP-ACCOUNT NP-EFF-DT NP-BENEFIT NP-AHPRM NP251-REM
  9770***            NP251-ORIG NP-SUB NP-REMAINING.
  9771     MOVE NP-REMAINING           TO INFORCE-DOLLARS.
  9772     GO TO 8390-OB-ADJ.
  9773
  9774 8390-OB-ADJ.
  9775     IF CLAS-I-BAL (CLAS-INDEXL) = 'B'
  9776         MOVE ZERO               TO INFORCE-DOLLARS.
  9777
  9778 8300-EXIT.
  9779     EXIT.
  9780
  9781 8400-ADD-TO-EXHIBIT.
  9782     IF GROUP-INS
  9783         ADD COUNT-WORK      TO GROUP-CNT (CL  TG  EG)
  9784         ADD INFORCE-DOLLARS TO GROUP-AMT (CL  TG  EG)
  9785     ELSE
  9786         ADD COUNT-WORK      TO IND-CNT (CL  TG  EG)
  9787         ADD INFORCE-DOLLARS TO IND-AMT (CL  TG  EG).
  9788
  9789 8400-EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 196
* ECS150.cbl
  9790     EXIT.
  9791
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 197
* ECS150.cbl
  9793 8450-RE-RATE-ROUTINE.
  9794
  9795     MOVE CR-DT                  TO  DC-GREG-DATE-CYMD.
  9796     MOVE 'L'                    TO  DC-OPTION-CODE.
  9797     PERFORM 8500-DATE-CONVERT-ROUTINE THRU 8599-DATE-CONVERT-X.
  9798     MOVE DC-BIN-DATE-1          TO  CP-CERT-EFF-DT.
  9799     MOVE CLAS-I-RL-AH (CLAS-INDEXA) TO  CP-BENEFIT-TYPE.
  9800     MOVE SPACES                 TO  CP-ACCT-FLD-5.
  9801     MOVE DTE-CLIENT             TO  CP-COMPANY-ID.
  9802     MOVE STATE-SUB (CLAS-INDEXS)    TO  CP-STATE.
  9803     MOVE STATE-ABBR (CLAS-INDEXS)   TO  CP-STATE-STD-ABBRV.
  9804
  9805     IF CR-AGE IS NOT NUMERIC
  9806         MOVE ZEROS              TO  CP-ISSUE-AGE
  9807     ELSE
  9808         MOVE CR-AGE             TO  CP-ISSUE-AGE.
  9809
  9810     MOVE CP-REMAINING-TERM-1    TO  CP-ORIGINAL-TERM.
  9811     MOVE CR-AHAMT               TO  CP-ORIGINAL-BENEFIT
  9812                                     CP-RATING-BENEFIT-AMT.
  9813
  9814     IF CP-STATE-STD-ABBRV = 'OR'
  9815         COMPUTE CP-RATING-BENEFIT-AMT =
  9816                                CR-AHAMT * CP-REMAINING-TERM-1.
  9817
  9818     MOVE CR-APR                 TO  CP-LOAN-APR.
  9819
  9820     IF CR-PMT-FREQ IS NOT NUMERIC
  9821         MOVE ZEROS              TO  CP-PAY-FREQUENCY
  9822     ELSE
  9823         MOVE CR-PMT-FREQ        TO  CP-PAY-FREQUENCY.
  9824
  9825     IF AH-EARN-METHOD = SPACES
  9826         MOVE CLAS-I-EP (CLAS-INDEXA) TO  CP-EARNING-METHOD
  9827     ELSE
  9828         MOVE AH-EARN-METHOD          TO  CP-EARNING-METHOD.
  9829
  9830     IF CR-RATING-CLASS NOT = SPACE AND ZERO
  9831         MOVE CR-RATING-CLASS    TO  CP-CLASS-CODE
  9832     ELSE
  9833         MOVE AM-CAL-TABLE       TO  CP-CLASS-CODE.
  9834
  9835     MOVE '3'                    TO  CP-PROCESS-TYPE.
  9836     MOVE CLAS-I-BAL (CLAS-INDEXA)   TO  CP-SPECIAL-CALC-CD.
  9837     MOVE CR-LOAN-TERM           TO  CP-LOAN-TERM.
  9838     MOVE AM-AH-DEVIATION        TO  CP-DEVIATION-CODE.
  9839     MOVE CR-AHTYP               TO  CP-BENEFIT-CD.
  9840     MOVE DTE-CLASIC-COMPANY-CD  TO  CP-COMPANY-CD.
  9841
  9842     IF CR-PMT-EXTENSION-DAYS IS NOT NUMERIC
  9843         MOVE ZEROS              TO  CP-TERM-OR-EXT-DAYS
  9844     ELSE
  9845         MOVE CR-PMT-EXTENSION-DAYS  TO  CP-TERM-OR-EXT-DAYS.
  9846
  9847     MOVE AH-OVERRIDE-L1         TO  CP-AH-OVERRIDE-CODE.
  9848
  9849     IF AM-AH-DEVIATION-PCT IS NOT NUMERIC
  9850         MOVE ZEROS              TO  CP-RATE-DEV-PCT
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 198
* ECS150.cbl
  9851     ELSE
  9852         MOVE AM-AH-DEVIATION-PCT TO CP-RATE-DEV-PCT.
  9853
  9854 8455-CALL-RATING-ROUTINE.
  9855
  9856     CALL 'ELRATEX' USING CALCULATION-PASS-AREA.
  9857
  9858 8499-EXIT.
  9859     EXIT.
  9860
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 199
* ECS150.cbl
  9862 8500-DATE-CONVERT-ROUTINE.
  9863
* 9864     COPY ELCDCS.
  9865****************************************************************  04/15/98
  9866*                                                              *  ELCDCS
  9867*                                                              *  ELCDCS
  9868*                            ELCDCS.                           *     LV003
  9869*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  9870*                            VMOD=2.002                        *     CL**3
  9871*                                                              *  ELCDCS
  9872*           THIS SECTION CALLS THE DATE CONVERSION SUBROUTINE. *  ELCDCS
  9873****************************************************************. ELCDCS
  9874                                                                  ELCDCS
  9875 8510-DATE-CONVERSION.                                            ELCDCS
  9876     CALL 'ELDATCX' USING DATE-CONVERSION-DATA.                   ELCDCS
  9877                                                                  ELCDCS
  9878 8590-EXIT.                                                       ELCDCS
  9879     EXIT.                                                        ELCDCS
  9880                                                                  ELCDCS
  9881
  9882 8599-DATE-CONVERT-X.
  9883     EXIT.
  9884
  9885 REIN-DATE-LOAD.
  9886     MOVE RE-CLM-INCURRED-LIM    TO  WS-RE-CLM-INCURRED-LIM-N.
  9887     MOVE RE-EARNING-START-DT    TO  WS-RE-EARNING-START-DT-N.
  9888     MOVE RE-EARNING-STOP-DT     TO  WS-RE-EARNING-STOP-DT-N.
  9889
  9890 9990-PROGRAM-END            SECTION 45.
  9891
  9892 9999-CLOSE-FICH.
* 9893                             COPY ELCPRTC.
  9894******************************************************************04/15/98
  9895*                                                                *ELCPRTC
  9896*                                                                *ELCPRTC
  9897*                            ELCPRTC.                            *   LV003
  9898*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
  9899*                            VMOD=2.002                          *   CL**2
  9900*       CLOSE FICH FILE IF OPEN                                  *ELCPRTC
  9901*                                                                *ELCPRTC
  9902* NOTE- USE ELCPRTCX IF USING ELCPRT2X (ONLINE REPORT SAVE)      *   CL**2
  9903******************************************************************ELCPRTC
  9904                                                                  ELCPRTC
  9905      IF FICH-OPEN NOT = SPACE                                    ELCPRTC
  9906          CLOSE FICH.                                             ELCPRTC
  9907                                                                  ELCPRTC
  9908******************************************************************ELCPRTC
  9909
  9910     CLOSE PRINT-FILE.
  9911
  9912     IF REIN-OPEN-SW EQUAL 'X'
  9913            MOVE SPACE           TO REIN-OPEN-SW
  9914            CLOSE ERRTBL-IN
  9915            IF ERRTBL-FILE-STATUS = '00'
  9916               NEXT SENTENCE
  9917            ELSE
  9918               MOVE '22'         TO ABEND-FILE-ID
  9919               MOVE ERRTBL-FILE-STATUS
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 200
* ECS150.cbl
  9920                                 TO ABEND-REASON
  9921               GO TO ABEND-PGM.
  9922*
  9923*
  9924* LEAVE THE ABOVE 2 LINES IN TO PREVENT LOSING THE LINE ABOVE
  9925
  9926     MOVE ZEROS  TO RETURN-CODE.
  9927     GOBACK.
  9928
  9929 9999-EXIT.
  9930     EXIT.
  9931
  9932 ABEND-PGM.
* 9933                                 COPY ELCABEND.
  9934***************************************************************** 04/14/98
  9935*                                                               * ELCABEND
  9936*                            ELCABEND.                          *    LV003
  9937*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
  9938*                            VMOD 2.002                              CL**2
  9939*                                                               * ELCABEND
  9940*                THIS SECTION DISPLAYS THE NECESSARY MESSAGES   * ELCABEND
  9941*            AND THEN ABENDS.                                   * ELCABEND
  9942*                                                               * ELCABEND
  9943*  NO  CID  MODS  IN  COPYBOOK  ELCABEND                        * ELCABEND
  9944*                                                               * ELCABEND
  9945***************************************************************** ELCABEND
  9946*APS-010.                                                         ELCABEND
  9947     DISPLAY WS-ABEND-MESSAGE.                                    ELCABEND
  9948     DISPLAY WS-ABEND-MESSAGE UPON CONSOLE.                       ELCABEND
  9949                                                                  ELCABEND
  9950     IF WS-ABEND-FILE-STATUS NOT = ZERO                           ELCABEND
  9951         DISPLAY 'FILE STATUS = ' WS-ABEND-FILE-STATUS            ELCABEND
  9952         DISPLAY 'FILE STATUS = ' WS-ABEND-FILE-STATUS            ELCABEND
  9953                                 UPON CONSOLE.                    ELCABEND
  9954                                                                  ELCABEND
  9955     IF WS-RETURN-CODE NOT = ZERO                                 ELCABEND
  9956         DISPLAY 'RETURN CODE = '  WS-RETURN-CODE                 ELCABEND
  9957         DISPLAY 'RETURN CODE = '  WS-RETURN-CODE                 ELCABEND
  9958                                 UPON CONSOLE.                    ELCABEND
  9959                                                                  ELCABEND
  9960     DISPLAY 'PROGRAM WILL NOW ABEND **************'              ELCABEND
  9961     DISPLAY 'PROGRAM WILL NOW ABEND **************'              ELCABEND
  9962                                 UPON CONSOLE.                    ELCABEND
  9963                                                                  ELCABEND
  9964     DIVIDE WS-ZERO BY WS-ZERO GIVING WS-ZERO.                    ELCABEND
  9965     CALL 'ABORTME'.
  9966                                                                  ELCABEND
  9967 APS-EXIT.                                                        ELCABEND
  9968     EXIT.                                                        ELCABEND
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Last message on page:  177
* Total Messages:     3
* Unrecoverable :     0                    Severe  :     0
* Errors        :     3                    Warnings:     0
* Informational :     0                    Flags   :     0
* Data:      304396     Code:       47584
