* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   1
* PEMCRM5.cbl
* Options: int("PEMCRM5.int") anim csi verbose NOBOUND PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("PEMCRM5.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"ebmlsfile" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" NOCHECKDIV NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"32" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"PEMCRM5.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"PEMCRM5.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR NOSTICKY-LINKAGE
*          NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"2" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2 PROGRAM-ID.                PEMCRM5.
     3*AUTHOR.     PABLO.
     4*REMARKS.
     5*     THIS PROGRAM READS THE GAAP, MATCHES TO THE CERT, UPDATES
     6*       THE GAAP AND WRITES OUT A NEW GAAP
     7 ENVIRONMENT DIVISION.
     8 INPUT-OUTPUT SECTION.
     9 FILE-CONTROL.
    10     SELECT  GAAP-IN         ASSIGN TO SYS010.
    11
    12     SELECT CERT-IN          ASSIGN TO SYS011.
    13
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   2
* PEMCRM5.cbl
    14     SELECT GAAP-OUT          ASSIGN TO SYS013.
    15
    16 DATA DIVISION.
    17
    18 FILE SECTION.
    19
    20 FD  CERT-IN
    21     RECORDING MODE IS F
    22     LABEL RECORDS ARE STANDARD
    23     BLOCK CONTAINS 0 RECORDS.
    24
*   25                                COPY ECSCRT01.
    26******************************************************************
    27*                                                                *
    28*                            ECSCRT01                            *
    29*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
    30*                            VMOD=2.016                          *
    31*                                                                *
    32*   FILE DESCRIPTION = CERTIFICATE RECORD    (OFF-LINE)          *
    33*                                                                *
    34*   FILE TYPE = SEQUENTIAL
    35*   RECORD SIZE = 1056 RECFORM = FIXED                           *
    36*                                                                *
    37*   KEY DATA =                         START=4, LEN=36           *
    38*                                                                *
    39*  NO  CID  MODS  IN  COPYBOOK  ECSCRT01                         *
    40*                                                                *
    41******************************************************************
    42******************************************************************
    43*                   C H A N G E   L O G
    44*
    45* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    46*-----------------------------------------------------------------
    47*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    48* EFFECTIVE    NUMBER
    49*-----------------------------------------------------------------
    50* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
    51* 100703    2003080800002  PEMA  ADD SUPER GAP PROCESSING
    52* 040504    2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
    53* 020305    2005020000000  PEMA  ADD CLP STATE TO CERT RECORD
    54* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
    55* 042408    2007110500003  PEMA  ADD REFUND INTEREST PROCESSING
    56* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
    57* 032612  CR2011110200001  PEMA  AHL CHANGES
    58* 052814  CR2014012300001  PEMA  DCC CREDIT UNION CHANGES
    59* 090314  CR2014081300001  PEMA  LOAD CERTS INVOLVED IN THAO
    60******************************************************************
    61
    62 01  CERTIFICATE-RECORD.
    63     12  CR-RECORD-ID                      PIC XX.
    64         88  VALID-CR-ID                      VALUE 'CR'.
    65
    66     12  CR-COMPANY-CD                     PIC X.
    67
    68     12  CR-FULL-CONTROL.
    69         16  CR-CONTROL-1.
    70             20  CR-ACCT-CONTROL.
    71                 24  CR-CARRIER            PIC X.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   3
* PEMCRM5.cbl (/apps/prod/cid1p/copy/ECSCRT01)
    72                 24  CR-GROUPING.
    73                     28  CR-GROUP-PREFIX   PIC XXX.
    74                     28  CR-GROUP-PRIME    PIC XXX.
    75                 24  CR-STATE              PIC XX.
    76                 24  CR-ACCOUNT.
    77                     28  CR-ACCT-PREFIX    PIC X(4).
    78                     28  CR-ACCT-PRIME     PIC X(6).
    79             20  CR-DT                     PIC 9(11)  COMP-3.
    80         16  CR-CERT-NO.
    81             20  CR-CERT.
    82                 24  CR-CERT-PREFIX        PIC X(3).
    83                 24  CR-CERT-PRIME         PIC X(7).
    84             20  CR-CERT-SFX               PIC X.
    85
    86     12  CR-INSUREDS-PROFILE.
    87         16  CR-NAME.
    88             20  CR-LNAME                  PIC X(15).
    89             20  CR-FNAME.
    90                 24  CR-1ST-INITIAL        PIC X.
    91                 24  FILLER                PIC X(9).
    92             20  CR-INIT                   PIC X.
    93         16  CR-AGE                        PIC 99.
    94         16  CR-SEX                        PIC X.
    95             88  CR-SEX-MALE                  VALUE 'M'.
    96             88  CR-SEX-FEMALE                VALUE 'F'.
    97         16  CR-SOC-SEC                    PIC X(11).
    98         16  CR-JOINT-NAME.
    99             20  CR-JT-LNAME               PIC X(15).
   100             20  CR-JT-FNAME.
   101                 24  CR-JT-1ST-INIT        PIC X.
   102                 24  FILLER                PIC X(9).
   103             20  CR-JT-INIT                PIC X.
   104         16  CR-JOINT-AGE                  PIC 99.
   105
   106         16  cr-ahl-ah-claim-no            pic x(9).
   107         16  cr-ahl-ah-cert-seq            pic x(3).
   108         16  cr-hst-proc-lf                pic x.
   109         16  f                             pic x(7).
   110
   111     12  CR-LF-COVERAGE-DATA.
   112         16  CR-LFTYP                      PIC XX.
   113         16  CR-LF-TERM                    PIC S999       COMP-3.
   114         16  CR-LF-CRIT-PERIOD             PIC S999       COMP-3.
   115         16  CR-LF-TERM-IN-DAYS            PIC S9(5)      COMP-3.
   116         16  CR-LF-DEV-CODE                PIC XXX.
   117         16  CR-LF-DEV-PCT                 PIC S9V9(6)    COMP-3.
   118
   119         16  CR-LFAMT                      PIC S9(9)V99   COMP-3.
   120         16  CR-LFPRM                      PIC S9(7)V99   COMP-3.
   121         16  CR-LFPRM-CALC                 PIC S9(7)V99   COMP-3.
   122         16  CR-LFPRM-RATE                 PIC S99V9(5)   COMP-3.
   123
   124         16  CR-LFAMT-ALT                  PIC S9(9)V99   COMP-3.
   125         16  CR-LFPRM-ALT                  PIC S9(7)V99   COMP-3.
   126         16  CR-LFPRM-CALC-ALT             PIC S9(7)V99   COMP-3.
   127         16  CR-LFPRM-RATE-ALT             PIC S99V9(5)   COMP-3.
   128
   129         16  CR-LFRFND                     PIC S9(7)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   4
* PEMCRM5.cbl (/apps/prod/cid1p/copy/ECSCRT01)
   130         16  CR-LFRFND-CALC                PIC S9(7)V99   COMP-3.
   131
   132         16  CR-LF-NSP-PRM                 PIC S9(7)V99   COMP-3.
   133         16  CR-LF-NSP-PRM-RATE            PIC S99V9(5)   COMP-3.
   134
   135         16  CR-LF-REFUND-TYPE             PIC X.
   136         16  CR-LF-POLICY-FEE              PIC S9(3)V99   COMP-3.
   137
   138         16  CR-LF-COMM-CHARGEBACK         PIC X.
   139             88  CR-NO-LF-CHARGEBACK          VALUE 'N'.
   140
   141         16  CR-LF-REI-RISK-PRM            PIC S9(7)V99   COMP-3.
   142
   143         16  CR-LF-EXPIRE-DATE             PIC 9(11)      COMP-3.
   144         16  CR-LF-ISS-PREM-TAX            PIC S9V9(4)    COMP-3.
   145         16  CR-LF-CNC-PREM-TAX            PIC S9V9(4)    COMP-3.
   146
   147         16  cr-ahl-lf-claim-no            pic x(9).
   148         16  cr-ahl-lf-cert-seq            pic x(3).
   149         16  FILLER                        PIC XX.
   150
   151     12  CR-AH-COVERAGE-DATA.
   152         16  CR-AHTYP                      PIC XX.
   153         16  CR-AH-TERM                    PIC S999       COMP-3.
   154         16  CR-AH-CRIT-PERIOD             PIC S999       COMP-3.
   155         16  CR-AH-DEV-CODE                PIC XXX.
   156         16  CR-AH-DEV-PCT                 PIC S9V9(6)    COMP-3.
   157
   158         16  CR-AHAMT                      PIC S9(7)V99   COMP-3.
   159         16  CR-AHPRM                      PIC S9(7)V99   COMP-3.
   160         16  CR-AHPRM-CALC                 PIC S9(7)V99   COMP-3.
   161         16  CR-AHPRM-RATE                 PIC S99V9(5)   COMP-3.
   162
   163         16  CR-AHRFND                     PIC S9(7)V99   COMP-3.
   164         16  CR-AHRFND-CALC                PIC S9(7)V99   COMP-3.
   165
   166         16  CR-AH-NSP-PRM                 PIC S9(7)V99   COMP-3.
   167         16  CR-AH-NSP-PRM-RATE            PIC S99V9(5)   COMP-3.
   168
   169         16  CR-AH-REFUND-TYPE             PIC X.
   170         16  CR-AH-POLICY-FEE              PIC S9(3)V99   COMP-3.
   171
   172         16  CR-AH-COMM-CHARGEBACK         PIC X.
   173             88  CR-NO-AH-CHARGEBACK          VALUE 'N'.
   174
   175         16  CR-AH-REI-RISK-PRM            PIC S9(7)V99   COMP-3.
   176
   177         16  CR-AH-EXPIRE-DATE             PIC 9(11)      COMP-3.
   178         16  CR-AH-ISS-PREM-TAX            PIC S9V9(4)    COMP-3.
   179         16  CR-AH-CNC-PREM-TAX            PIC S9V9(4)    COMP-3.
   180
   181         16  FILLER                        PIC XX.
   182*        16  FILLER                        PIC X(8).
   183
   184     12  CR-LOAN-DATA.
   185         16  CR-LIVES                      PIC S9(7)      COMP-3.
   186         16  CR-DDF-IU-RATE-UP REDEFINES CR-LIVES
   187                                           PIC S9(5)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   5
* PEMCRM5.cbl (/apps/prod/cid1p/copy/ECSCRT01)
   188         16  CR-BILLED                     PIC S9(7)      COMP-3.
   189         16  CR-APR                        PIC S999V9(4)  COMP-3.
   190         16  CR-PMT-FREQ                   PIC 99.
   191         16  CR-LOAN-TERM                  PIC S999       COMP-3.
   192         16  CR-RATING-CLASS               PIC XX.
   193         16  CR-POLICY-FORM-NO             PIC X(12).
   194         16  CR-GRPTYP                     PIC XX.
   195         16  CR-IND-GRP                    PIC X.
   196             88  CR-INDIVIDUAL                VALUE '1'.
   197             88  CR-GROUP                     VALUE '2'.
   198         16  CR-SKIP                       PIC 99.
   199             88  NO-MONTHS-SKIPPED            VALUE 00.
   200             88  SKIP-JULY                    VALUE 01.
   201             88  SKIP-AUGUST                  VALUE 02.
   202             88  SKIP-SEPTEMBER               VALUE 03.
   203             88  SKIP-JULY-AUG                VALUE 04.
   204             88  SKIP-AUG-SEPT                VALUE 05.
   205             88  SKIP-JULY-AUG-SEPT           VALUE 06.
   206             88  SKIP-JUNE-JULY-AUG           VALUE 07.
   207             88  SKIP-JUNE                    VALUE 08.
   208             88  SKIP-JUNE-JULY               VALUE 09.
   209             88  SKIP-AUG-SEPT-OCT            VALUE 10.
   210             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 11.
   211         16  CR-RESIDENT-STATE             PIC XX.
   212         16  CR-RATE-CODE.
   213             20  CR-LF-CLASS-CD            PIC XX.
   214             20  CR-AH-CLASS-CD            PIC XX.
   215         16  CR-MORT.
   216             20  CR-TAB                    PIC X.
   217             20  CR-INT                    PIC 99.
   218             20  CR-GRP                    PIC X.
   219         16  CR-MEMBER-NO                  PIC X(12).
   220         16  CR-OLD-LOF                    PIC XXX.
   221*        16  CR-LOAN-OFFICER               PIC XXX.
   222         16  CR-REIN-TABLE                 PIC XXX.
   223         16  CR-REIN-SPEC                  PIC X.
   224         16  CR-LOAN-1ST-PMT-DT.
   225             20  CR-1ST-PMT-YR             PIC 99.
   226             20  CR-1ST-PMT-MO             PIC 99.
   227             20  CR-1ST-PMT-DA             PIC 99.
   228         16  CR-SUM-CAN-CNT-ITD            PIC S999       COMP-3.
   229         16  CR-SUM-CAN-CNT-YTD            PIC S999       COMP-3.
   230         16  CR-PMT-EXTENSION-DAYS         PIC S999       COMP-3.
   231         16  CR-LAST-ADD-ON-DT             PIC XX.
   232
   233         16  CR-UNDERWRITING-CODE          PIC X.
   234             88  CR-POLICY-UNDERWRITTEN       VALUE 'Y'.
   235
   236         16  CR-STATE-TAX                  PIC S9(7)V99   COMP-3.
   237         16  CR-MUNI-TAX                   PIC S9(7)V99   COMP-3.
   238         16  CR-CANCEL-STATE-TAX           PIC S9(7)V99   COMP-3.
   239         16  CR-CANCEL-MUNI-TAX            PIC S9(7)V99   COMP-3.
   240
   241     12  CR-STATUS-INFORMATION.
   242         16  CR-ENTRY-STATUS               PIC X.
   243             88  CR-NORMAL-ENTRY              VALUE '1'.
   244             88  CR-POLICY-IS-RESTORE         VALUE '3'.
   245             88  CR-CONVERSION-ENTRY          VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   6
* PEMCRM5.cbl (/apps/prod/cid1p/copy/ECSCRT01)
   246             88  CR-POLICY-IS-REISSUE         VALUE '5'.
   247             88  CR-POLICY-IS-CASH            VALUE 'C'.
   248             88  CR-POLICY-IS-MONTHLY         VALUE 'M'.
   249             88  CR-POLICY-IS-REIN-ONLY       VALUE '9'.
   250             88  CR-POLICY-IS-DECLINED        VALUE 'D'.
   251             88  CR-POLICY-IS-VOID            VALUE 'V'.
   252             88  CR-POLICY-IS-PREM-ONLY       VALUE 'P'.
   253             88  CR-POLICY-IS-ACTIVE          VALUE '1' '3' '4'
   254                                                'C' '5' '9' 'P'.
   255         16  CR-ENTRY-DATE                 PIC 9(11)  COMP-3.
   256
   257         16  CR-LF-STATUS-AT-CANCEL        PIC X.
   258         16  CR-LF-CANC-DT                 PIC 9(11)  COMP-3.
   259         16  CR-LF-CANCEL-EXIT-DATE        PIC 9(11)  COMP-3.
   260
   261         16  CR-LF-STATUS-AT-DEATH         PIC X.
   262         16  CR-LF-CLAIM-EXIT-DATE         PIC 9(11)  COMP-3.
   263
   264         16  CR-LF-CURRENT-STATUS          PIC X.
   265             88  CR-LF-NORMAL-ENTRY           VALUE '1'.
   266             88  CR-LF-POLICY-PENDING         VALUE '2'.
   267             88  CR-LF-POLICY-IS-RESTORE      VALUE '3'.
   268             88  CR-LF-CONVERSION-ENTRY       VALUE '4'.
   269             88  CR-LF-POLICY-IS-REISSUE      VALUE '5'.
   270             88  CR-LF-POLICY-IS-MONTHLY      VALUE 'M'.
   271             88  CR-LF-LUMP-SUM-DISAB         VALUE '6'.
   272             88  CR-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
   273             88  CR-LF-CANCEL-APPLIED         VALUE '8'.
   274             88  CR-LF-IS-REIN-ONLY           VALUE '9'.
   275             88  CR-LF-IS-DECLINED            VALUE 'D'.
   276             88  CR-LF-IS-VOID                VALUE 'V'.
   277             88  CR-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
   278                                                    '4' '5' '9'.
   279
   280         16  CR-AH-STATUS-AT-CANCEL        PIC X.
   281
   282         16  CR-AH-CANC-DT                 PIC 9(11)  COMP-3.
   283         16  CR-AH-CANCEL-EXIT-DATE        PIC 9(11)  COMP-3.
   284
   285         16  CR-AH-STATUS-AT-SETTLEMENT    PIC X.
   286         16  CR-AH-SETTLEMENT-EXIT-DATE    PIC 9(11)  COMP-3.
   287
   288         16  CR-AH-CURRENT-STATUS          PIC X.
   289             88  CR-AH-NORMAL-ENTRY           VALUE '1'.
   290             88  CR-AH-POLICY-PENDING         VALUE '2'.
   291             88  CR-AH-POLICY-IS-RESTORE      VALUE '3'.
   292             88  CR-AH-CONVERSION-ENTRY       VALUE '4'.
   293             88  CR-AH-POLICY-IS-REISSUE      VALUE '5'.
   294             88  CR-AH-POLICY-IS-MONTHLY      VALUE 'M'.
   295             88  CR-AH-LUMP-SUM-DISAB         VALUE '6'.
   296             88  CR-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
   297             88  CR-AH-CANCEL-APPLIED         VALUE '8'.
   298             88  CR-AH-IS-REIN-ONLY           VALUE '9'.
   299             88  CR-AH-IS-DECLINED            VALUE 'D'.
   300             88  CR-AH-IS-VOID                VALUE 'V'.
   301             88  CR-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
   302                                                    '4' '5' '9'.
   303         16  CR-LOAN-OFFICER               PIC X(5).
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   7
* PEMCRM5.cbl (/apps/prod/cid1p/copy/ECSCRT01)
   304         16  CR-CANCEL-REASON              PIC X.
   305         16  cr-xycor-lf-cov-code          pic x(4).
   306         16  cr-xycor-ah-cov-code          pic x(4).
   307         16  cr-temp-epiq                  pic x(4).
   308         16  FILLER                        PIC XX.
   309
   310     12  CR-DEATH-CLAIM-DATA.
   311         16  CR-NUM-DTH-CLM                PIC S999       COMP-3.
   312
   313         16  CR-DTH-DT                     PIC 9(11)      COMP-3.
   314         16  CR-DTH-RPT-DT.
   315             20  CR-DTH-RPT-YR             PIC 99.
   316             20  CR-DTH-RPT-MO             PIC 99.
   317             20  CR-DTH-RPT-DA             PIC 99.
   318         16  CR-DTH-PAY-DT                 PIC 9(11)      COMP-3.
   319
   320         16  CR-DTHAMT                     PIC S9(9)V99   COMP-3.
   321         16  CR-DTHAMT-YTD                 PIC S9(9)V99   COMP-3.
   322         16  CR-DTHAMT-LAST                PIC S9(9)V99   COMP-3.
   323         16  CR-DTHEXP                     PIC S9(7)V99   COMP-3.
   324         16  CR-DTHEXP-YTD                 PIC S9(7)V99   COMP-3.
   325
   326         16  CR-DTH-AGE                    PIC 99.
   327         16  CR-DTH-PAY-CD                 PIC X.
   328         16  CR-DEATH-CAUSE                PIC X(6).
   329
   330         16  FILLER                        PIC X(16).
   331
   332     12  CR-DISAB-CLAIM-DATA.
   333         16  CR-NUM-DIS-CLM                PIC S999       COMP-3.
   334
   335         16  CR-DIS-DT                     PIC 9(11)      COMP-3.
   336         16  CR-DIS-RPT-DT.
   337             20  CR-DIS-RPT-YR             PIC 99.
   338             20  CR-DIS-RPT-MO             PIC 99.
   339             20  CR-DIS-RPT-DA             PIC 99.
   340         16  CR-DIS-PAY-DT                 PIC 9(11)      COMP-3.
   341         16  CR-DIS-PTO-DT                 PIC 9(11)      COMP-3.
   342
   343         16  CR-DISAMT                     PIC S9(9)V99   COMP-3.
   344         16  CR-DISAMT-YTD                 PIC S9(9)V99   COMP-3.
   345         16  CR-DISAMT-LAST                PIC S9(9)V99   COMP-3.
   346         16  CR-DISEXP                     PIC S9(7)V99   COMP-3.
   347         16  CR-DISEXP-YTD                 PIC S9(7)V99   COMP-3.
   348
   349         16  CR-DAYS-DISAB                 PIC 999        COMP-3.
   350         16  CR-DIS-PAY-CD                 PIC X.
   351         16  FILLER                        PIC XX.
   352
   353         16  CR-DISAB-INCURRED-DETAIL.
   354             20  CR-DISAB-DETAIL-DATA  OCCURS 5 TIMES.
   355**ELCCRTVR MUST BE CHANGED IF THE "OCCURS" IS CHANGED.
   356                 24  CR-DIS-INCUR-DT       PIC 9(11)     COMP-3.
   357                 24  CR-INCUR-DISAMT       PIC S9(9)V99  COMP-3.
   358                 24  CR-INCUR-DISEXP       PIC S9(9)V99  COMP-3.
   359
   360         16  CR-DISAB-CAUSE                PIC X(6).
   361         16  FILLER                        PIC X(14).
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   8
* PEMCRM5.cbl (/apps/prod/cid1p/copy/ECSCRT01)
   362
   363     12  CR-REMIT-TO                       PIC 99.
   364
   365     12  CR-COMPENSATION-LEVELS.
   366         16  CR-AGT-LEVELS      OCCURS 10 TIMES.
   367             20  CR-COM-AGT.
   368                 24  CR-COM-AGT-PREFIX     PIC X(4).
   369                 24  CR-COM-AGT-PRIME      PIC X(6).
   370             20  CR-AGT-TYPE               PIC X.
   371             20  CR-LCOM-L                 PIC SV9(5)     COMP-3.
   372             20  CR-LCOM-AH                PIC SV9(5)     COMP-3.
   373
   374     12  CR-BANK-NOCHRGB-MONTHS            PIC 99.
   375     12  CR-MOB-NET-TOT-FEES               PIC S9(7)V99   COMP-3.
   376     12  CR-ADDL-CLP                       PIC S9(5)V99   COMP-3.
   377     12  CR-CLP-STATE                      PIC XX.
   378     12  CR-POST-CARD-IND                  PIC X.
   379     12  CR-LF-CLP                         PIC S9(5)V99   COMP-3.
   380     12  CR-AH-CLP                         PIC S9(5)V99   COMP-3.
   381     12  CR-DCC-PRODUCT-CODE               PIC XXX.
   382     12  CR-LF-RFND-CLP                    PIC S9(5)V99   COMP-3.
   383     12  CR-AH-RFND-CLP                    PIC S9(5)V99   COMP-3.
   384     12  FILLER                            PIC X(07).
   385
   386     12  CR-CSR-CODE                       PIC XXX.
   387
   388     12  CR-CLAIM-DEDUCT-WITHHELD          PIC S9(5)V99   COMP-3.
   389     12  CR-CANCEL-DEDUCT-WITHHELD         PIC S9(5)V99   COMP-3.
   390
   391     12  CR-MICROFILM-NUMBERS.
   392*        16  CR-ISS-MICROFILM-NO           PIC S9(9)      COMP-3.
   393         16  FILLER                        PIC X(5).
   394     12  CR-NH-INT-ON-REF                  PIC S9(7)V99   COMP-3.
   395
   396     12  CR-USER-CODE                      PIC X.
   397     12  CR-USER-FUTURE                    PIC X(9).
   398
   399     12  CR-BENEFICIARY.
   400         16  CR-BANK-NO                    PIC X(10).
   401         16  FILLER                        PIC X(15).
   402
   403     12  CR-ENTRY-BATCH                    PIC X(6).
   404     12  CR-LF-EXIT-BATCH                  PIC X(6).
   405     12  CR-AH-EXIT-BATCH                  PIC X(6).
   406
   407     12  CR-NOTE-SW                        PIC X.
   408
   409     12  CR-ORIGIN-INDICATOR               PIC X.
   410         88  CR-ENTERED-MANUALLY              VALUE '1'.
   411         88  CR-CREATED-FROM-TAPE-LOAD        VALUE '2'.
   412
   413     12  CR-LF-CNC-ENT-DT                  PIC 9(11)  COMP-3.
   414     12  CR-AH-CNC-ENT-DT                  PIC 9(11)  COMP-3.
   415     12  FILLER                            PIC X(33).
   416
   417******************************************************************
   418
   419 FD  GAAP-OUT
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   9
* PEMCRM5.cbl
   420     RECORDING MODE IS F
   421     LABEL RECORDS ARE STANDARD
   422     BLOCK CONTAINS 0 RECORDS.
   423
   424 01  GAAP-OUT-RECORD            PIC X(365).
   425
   426 FD  GAAP-IN
   427     RECORDING MODE IS F
   428     LABEL RECORDS ARE STANDARD
   429     BLOCK CONTAINS 0 RECORDS.
   430
*  431                                 COPY ECSGAP01.
   432******************************************************************04/29/98
   433*                                                                *ECSGAP01
   434*                            ECSGAP01                            *   LV009
   435*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**9
   436*                            VMOD=2.009                          *ECSGAP01
   437*                                                                *ECSGAP01
   438*   FILE DESCRIPTION = G.A.A.P. EXTRACT RECORD                   *ECSGAP01
   439*                                                                *ECSGAP01
   440*   FILE TYPE = SEQUENTIAL                                        ECSGAP01
   441*   RECORD SIZE = 365  RECFORM = FIXED                           *ECSGAP01
   442*                                                                *ECSGAP01
   443*   KEY DATA =                         START=5, LEN=36           *ECSGAP01
   444*                                                                *ECSGAP01
   445*  NO  CSO  MODS  IN  COPYBOOK  ECSGAP01                         *ECSGAP01
   446*                                                                *ECSGAP01
   447******************************************************************ECSGAP01
   448*                   C H A N G E   L O G
   449*
   450* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   451*-----------------------------------------------------------------
   452*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   453* EFFECTIVE    NUMBER
   454*-----------------------------------------------------------------
   455* 020305    2005020000000  PEMA  ADD CLP STATE TO GAAP RECORD
   456******************************************************************
   457                                                                  ECSGAP01
   458 01  GAAP-RECORD.                                                 ECSGAP01
   459     12  GR-RECORD-ID                      PIC XX.                ECSGAP01
   460         88  VALID-GR-ID                      VALUE 'GR'.         ECSGAP01
   461                                                                  ECSGAP01
   462     12  GR-COMPANY-CD                     PIC X.                 ECSGAP01
   463                                                                  ECSGAP01
   464     12  GR-REIN                           PIC X.                 ECSGAP01
   465                                                                  ECSGAP01
   466     12  GR-CONTROL.                                              ECSGAP01
   467         16  GR-CARRIER                    PIC X.                 ECSGAP01
   468         16  GR-GROUPING.                                         ECSGAP01
   469             20  GR-GROUP-PREFIX           PIC XXX.               ECSGAP01
   470             20  GR-GROUP-PRIME            PIC XXX.               ECSGAP01
   471         16  GR-STATE                      PIC XX.                ECSGAP01
   472         16  GR-ACCOUNT.                                          ECSGAP01
   473             20  GR-ACCT-PREFIX            PIC X(4).              ECSGAP01
   474             20  GR-ACCT-PRIME             PIC X(6).              ECSGAP01
   475         16  GR-EFF                        PIC 9(11)  COMP-3.     ECSGAP01
   476         16  GR-CERT-NO.                                          ECSGAP01
   477             20  GR-CERT.                                         ECSGAP01
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  10
* PEMCRM5.cbl (/apps/prod/cid1p/copy/ECSGAP01)
   478                 24  GR-CERT-PREFIX        PIC XXX.               ECSGAP01
   479                 24  GR-CERT-PRIME         PIC X(7).              ECSGAP01
   480             20  GR-CERT-SUFFIX            PIC X.                 ECSGAP01
   481                                                                  ECSGAP01
   482     12  GR-REIN-COMP.                                            ECSGAP01
   483         16  GR-REINCO                     PIC XXX.               ECSGAP01
   484         16  GR-REINCO-SUB                 PIC XXX.               ECSGAP01
   485                                                                  ECSGAP01
   486     12  GR-IG                             PIC X.                 ECSGAP01
   487     12  GR-APR                            PIC S999V9(4)  COMP-3. ECSGAP01
   488     12  GR-PMT-FREQ                       PIC 99.                ECSGAP01
   489     12  GR-LOAN-TERM                      PIC S999       COMP-3. ECSGAP01
   490     12  GR-AGE                            PIC 99.                ECSGAP01
   491     12  GR-ACC-EXPIRES                    PIC 9(11)      COMP-3.    CL**2
   492                                                                  ECSGAP01
   493     12  GR-BASIC.                                                ECSGAP01
   494         16  GR-LFTYP                      PIC XX.                ECSGAP01
   495         16  GR-LF-TERM                    PIC S999       COMP-3. ECSGAP01
   496         16  GR-LF-REMTERM                 PIC S999V99    COMP-3. ECSGAP01
   497         16  GR-LF-UP-REMTERM              PIC S999V99    COMP-3. ECSGAP01
   498         16  GR-LFBEN                      PIC S9(9)V99   COMP-3. ECSGAP01
   499         16  GR-LFPRM                      PIC S9(7)V99   COMP-3. ECSGAP01
   500         16  GR-LFCOM                      PIC S9(7)V99   COMP-3. ECSGAP01
   501         16  GR-LFEXP                      PIC S9(7)V99   COMP-3. ECSGAP01
   502         16  GR-LFTAX                      PIC S9(7)V99   COMP-3. ECSGAP01
   503                                                                  ECSGAP01
   504         16  GR-AHTYP                      PIC XX.                ECSGAP01
   505         16  GR-AH-TERM                    PIC S999       COMP-3. ECSGAP01
   506         16  GR-AH-REMTERM                 PIC S999V9     COMP-3. ECSGAP01
   507         16  GR-AH-UP-REMTERM              PIC S999V99    COMP-3. ECSGAP01
   508         16  GR-AHBEN                      PIC S9(7)V99   COMP-3. ECSGAP01
   509         16  GR-AHPRM                      PIC S9(7)V99   COMP-3. ECSGAP01
   510         16  GR-AHCOM                      PIC S9(7)V99   COMP-3. ECSGAP01
   511         16  GR-AHEXP                      PIC S9(7)V99   COMP-3. ECSGAP01
   512         16  GR-AHTAX                      PIC S9(7)V99   COMP-3. ECSGAP01
   513                                                                  ECSGAP01
   514     12  GR-PRORATA.                                              ECSGAP01
   515         16  GRP-LFPRM                     PIC S9(7)V99   COMP-3. ECSGAP01
   516         16  GRP-LFCOM                     PIC S9(7)V99   COMP-3. ECSGAP01
   517         16  GRP-LFEXP                     PIC S9(7)V99   COMP-3. ECSGAP01
   518         16  GRP-LFTAX                     PIC S9(7)V99   COMP-3. ECSGAP01
   519         16  GRP-AHPRM                     PIC S9(7)V99   COMP-3. ECSGAP01
   520         16  GRP-AHCOM                     PIC S9(7)V99   COMP-3. ECSGAP01
   521         16  GRP-AHEXP                     PIC S9(7)V99   COMP-3. ECSGAP01
   522         16  GRP-AHTAX                     PIC S9(7)V99   COMP-3. ECSGAP01
   523                                                                  ECSGAP01
   524     12  GR-R78.                                                  ECSGAP01
   525         16  GRR-LFPRM                     PIC S9(7)V99   COMP-3. ECSGAP01
   526         16  GRR-LFCOM                     PIC S9(7)V99   COMP-3. ECSGAP01
   527         16  GRR-LFEXP                     PIC S9(7)V99   COMP-3. ECSGAP01
   528         16  GRR-LFTAX                     PIC S9(7)V99   COMP-3. ECSGAP01
   529         16  GRR-AHPRM                     PIC S9(7)V99   COMP-3. ECSGAP01
   530         16  GRR-AHCOM                     PIC S9(7)V99   COMP-3. ECSGAP01
   531         16  GRR-AHEXP                     PIC S9(7)V99   COMP-3. ECSGAP01
   532         16  GRR-AHTAX                     PIC S9(7)V99   COMP-3. ECSGAP01
   533                                                                  ECSGAP01
   534     12  GR-DOMICILE-STAT.                                        ECSGAP01
   535         16  GRD-LFPRM                     PIC S9(7)V99   COMP-3. ECSGAP01
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  11
* PEMCRM5.cbl (/apps/prod/cid1p/copy/ECSGAP01)
   536         16  GRD-LFCOM                     PIC S9(7)V99   COMP-3. ECSGAP01
   537         16  GRD-AHPRM                     PIC S9(7)V99   COMP-3. ECSGAP01
   538         16  GRD-AHCOM                     PIC S9(7)V99   COMP-3. ECSGAP01
   539                                                                  ECSGAP01
   540     12  GR-STATE-STAT.                                           ECSGAP01
   541         16  GRS-LFPRM                     PIC S9(7)V99   COMP-3. ECSGAP01
   542         16  GRS-LFCOM                     PIC S9(7)V99   COMP-3. ECSGAP01
   543         16  GRS-AHPRM                     PIC S9(7)V99   COMP-3. ECSGAP01
   544         16  GRS-AHCOM                     PIC S9(7)V99   COMP-3. ECSGAP01
   545                                                                  ECSGAP01
   546     12  GR-MORTALITY-DATA.                                       ECSGAP01
   547         16  GR-MORT-CONTROL.                                     ECSGAP01
   548             20  GR-MORT-CODE.                                    ECSGAP01
   549                 24  GR-MORT-BASE.                                ECSGAP01
   550                     28  GR-MORT-TBL       PIC X.                 ECSGAP01
   551                     28  GR-MORT-INT       PIC XX.                ECSGAP01
   552                 24  GR-MORT-TYP           PIC X.                 ECSGAP01
   553             20  GR-MORT-AGE               PIC 99.                ECSGAP01
   554         16  GR-MORT-DATA.                                        ECSGAP01
   555             20  GR-REM-AMT                PIC S9(9)V99   COMP-3. ECSGAP01
   556             20  GR-MO-DEC                 PIC S9(9)V99   COMP-3. ECSGAP01
   557             20  GR-MORT-FACT              PIC S9(5)V9(4) COMP-3. ECSGAP01
   558             20  GR-RESV                   PIC S9(7)V99   COMP-3. ECSGAP01
   559         16  GR-FLAG                       PIC X.                 ECSGAP01
   560                                                                  ECSGAP01
   561     12  GR-ALT-MORTALITY-DATA.                                   ECSGAP01
   562         16  GR-ALT-MORT-CODE.                                    ECSGAP01
   563             20  GR-ALT-MORT-BASE.                                ECSGAP01
   564                 24  GR-ALT-MORT-TBL       PIC X.                 ECSGAP01
   565                 24  GR-ALT-MORT-INT       PIC XX.                ECSGAP01
   566             20  GR-ALT-MORT-TYP           PIC X.                 ECSGAP01
   567         16  GR-ALT-MORT-DATA.                                    ECSGAP01
   568             20  GR-ALT-RESV               PIC S9(7)V99   COMP-3. ECSGAP01
   569                                                                  ECSGAP01
   570     12  GR-CNT                            PIC S999       COMP-3. ECSGAP01
   571     12  GR-CNT-LF                         PIC S999       COMP-3. ECSGAP01
   572     12  GR-CNT-AH                         PIC S999       COMP-3. ECSGAP01
   573     12  GR-AH-REM-BEN                     PIC S9(9)V99   COMP-3. ECSGAP01
   574                                                                  ECSGAP01
   575     12  GR-ENT-DT                         PIC 9(11)      COMP-3. ECSGAP01
   576                                                                  ECSGAP01
   577     12  GR-SUMMARY-FLAG                   PIC X.                 ECSGAP01
   578         88  GR-SUMMARY-REC                   VALUE 'Z'.          ECSGAP01
   579                                                                  ECSGAP01
   580     12  GR-2ND-LFTYP-FLAG                 PIC X.                 ECSGAP01
   581         88  GR-2ND-LIFE-REC                  VALUE 'S'.          ECSGAP01
   582                                                                  ECSGAP01
   583     12  GR-CERT-STATUS                    PIC  X.                ECSGAP01
   584     12  GR-DIR-CERT-LFBEN                 PIC  S9(7)V99  COMP-3. ECSGAP01
   585                                                                  ECSGAP01
   586     12  GR-LF-EXPIRE-DATE                 PIC  9(11)     COMP-3. ECSGAP01
   587                                                                  ECSGAP01
   588     12  GR-AH-EXPIRE-DATE                 PIC  9(11)     COMP-3. ECSGAP01
   589                                                                  ECSGAP01
   590     12  GR-REGION                         PIC X(6).              ECSGAP01
   591     12  GR-POOL-PRIME                     PIC XXX.               ECSGAP01
   592                                                                  ECSGAP01
   593     12  GR-UNDERWRITING-CODE              PIC X.                 ECSGAP01
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  12
* PEMCRM5.cbl (/apps/prod/cid1p/copy/ECSGAP01)
   594         88  GR-POLICY-UNDERWRITTEN           VALUE 'Y'.          ECSGAP01
   595                                                                  ECSGAP01
   596     12  GR-OB-IND                         PIC X.                 ECSGAP01
   597                                                                  ECSGAP01
   598     12  GR-SEX-CODE                       PIC X.                 ECSGAP01
   599         88  GR-SEX-MALE                      VALUE 'M'.          ECSGAP01
   600         88  GR-SEX-FEMALE                    VALUE 'F'.          ECSGAP01
   601                                                                  ECSGAP01
   602*    12  GR-SERVICE-FEE.                                          ECSGAP01
   603*        16  GR-LFSRV                      PIC S9(7)V99   COMP-3. ECSGAP01
   604*        16  GR-AHSRV                      PIC S9(7)V99   COMP-3. ECSGAP01
   605     12  GR-UNLD-STAT-MORT-RESV            PIC S9(7)V99   COMP-3.
   606     12  FILLER                            PIC X(5).
   607                                                                  ECSGAP01
   608     12  GR-INS-NAME.
   609         16  GR-DCC-CLP-STATE              PIC XX.
   610         16  GR-GRPTYP                     PIC XX.
   611         16  FILLER                        PIC X(9).
   612*    12  FILLER                            PIC X(13).             ECSGAP01
   613                                                                  ECSGAP01
   614******************************************************************ECSGAP01
   615
   616 WORKING-STORAGE SECTION.
   617 77  FILLER  PIC X(32) VALUE '********************************'.
   618 77  FILLER  PIC X(32) VALUE '         WORKING-STORAGE        '.
   619 77  FILLER  PIC X(32) VALUE '********************************'.
   620
   621 01  W-MISC.
   622     05  WS-DATE-ALPH.
   623         10  FILLER             PIC XXX VALUE '000'.
   624         10  WS-WORK-CENT       PIC XX.
   625         10  WS-WORK-YR         PIC XX.
   626         10  WS-WORK-MO         PIC XX.
   627         10  WS-WORK-DA         PIC XX.
   628     05  WS-DATE-NUM REDEFINES WS-DATE-ALPH
   629                                PIC 9(11).
   630
   631     05  GAAP-IN-CNT             PIC 9(9) VALUE ZEROS.
   632     05  CERT-IN-CNT             PIC 9(9) VALUE ZEROS.
   633     05  GAAP-FIX-CNT            PIC 9(9) VALUE ZEROS.
   634     05  GAAP-OT-CNT             PIC 9(9) VALUE ZEROS.
   635     05  WS-EOF-SW              PIC X VALUE SPACES.
   636         88  END-OF-GAAP              VALUE 'Y'.
   637     05  WS-CRT-SW              PIC X VALUE ' '.
   638         88  END-OF-CERT              VALUE 'Y'.
   639
*  640                                 COPY ELCDATE.
   641******************************************************************06/11/98
   642*                                                                *ELCDATE
   643*                                                                *ELCDATE
   644*                            ELCDATE.                            *   LV023
   645*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL*16
   646*                            VMOD=2.003                           ELCDATE
   647*                                                                *ELCDATE
   648*                                                                *ELCDATE
   649*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *ELCDATE
   650*                 LENGTH = 200                                   *   CL*19
   651******************************************************************ELCDATE
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  13
* PEMCRM5.cbl (/apps/prod/cid1p/copy/ELCDATE)
   652                                                                  ELCDATE
   653 01  DATE-CONVERSION-DATA.                                        ELCDATE
   654     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.    CL*19
   655     12  DC-OPTION-CODE                PIC X.                        CL*15
   656         88  BIN-TO-GREG                VALUE ' '.                ELCDATE
   657         88  ELAPSED-BETWEEN-BIN        VALUE '1'.                ELCDATE
   658         88  EDIT-GREG-TO-BIN           VALUE '2'.                ELCDATE
   659         88  YMD-GREG-TO-BIN            VALUE '3'.                ELCDATE
   660         88  MDY-GREG-TO-BIN            VALUE '4'.                ELCDATE
   661         88  JULIAN-TO-BIN              VALUE '5'.                ELCDATE
   662         88  BIN-PLUS-ELAPSED           VALUE '6'.                ELCDATE
   663         88  FIND-CENTURY               VALUE '7'.                   CL*22
   664         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.                ELCDATE
   665         88  EDIT-GREG-TO-BIN-3         VALUE '9'.                ELCDATE
   666         88  YMD-GREG-TO-BIN-3          VALUE 'A'.                ELCDATE
   667         88  MDY-GREG-TO-BIN-3          VALUE 'B'.                ELCDATE
   668         88  JULIAN-TO-BIN-3            VALUE 'C'.                ELCDATE
   669         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.                ELCDATE
   670         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.                   CL*14
   671         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.                   CL*14
   672         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.                   CL*14
   673         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.         CL*14
   674         88  CHECK-LEAP-YEAR            VALUE 'H'.                   CL*14
   675         88  BIN-3-TO-GREG              VALUE 'I'.                   CL*14
   676         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.                   CL*14
   677         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.                   CL*14
   678         88  CYMD-GREG-TO-BIN           VALUE 'L'.                   CL*14
   679         88  MDCY-GREG-TO-BIN           VALUE 'M'.                   CL*14
   680         88  MDY-GREG-TO-JULIAN         VALUE 'N'.                   CL*14
   681         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.                   CL*14
   682         88  YMD-GREG-TO-JULIAN         VALUE 'P'.                   CL*14
   683         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.                   CL*14
   684         88  THREE-CHARACTER-BIN                                  ELCDATE
   685                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.       CL*14
   686         88  GREGORIAN-TO-BIN                                        CL**2
   687                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.    CL*14
   688         88  BIN-TO-GREGORIAN                                        CL**2
   689                  VALUES ' ' '1' 'I' '8' 'G'.                        CL*14
   690         88  JULIAN-TO-BINARY                                        CL**2
   691                  VALUES '5' 'C' 'E' 'F'.                            CL*14
   692     12  DC-ERROR-CODE                 PIC X.                        CL*15
   693         88  NO-CONVERSION-ERROR        VALUE ' '.                   CL**3
   694         88  DATE-CONVERSION-ERROR                                ELCDATE
   695                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.        CL*14
   696         88  DATE-IS-ZERO               VALUE '1'.                ELCDATE
   697         88  DATE-IS-NON-NUMERIC        VALUE '2'.                ELCDATE
   698         88  DATE-IS-INVALID            VALUE '3'.                ELCDATE
   699         88  DATE1-GREATER-DATE2        VALUE '4'.                ELCDATE
   700         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.                ELCDATE
   701         88  DATE-INVALID-OPTION        VALUE '9'.                ELCDATE
   702         88  INVALID-CENTURY            VALUE 'A'.                ELCDATE
   703         88  ONLY-CENTURY               VALUE 'B'.                ELCDATE
   704         88  ONLY-LEAP-YEAR             VALUE 'C'.                ELCDATE
   705         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.              CL**3
   706     12  DC-END-OF-MONTH               PIC X.                        CL*15
   707         88  CALCULATE-END-OF-MONTH     VALUE '1'.                ELCDATE
   708     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.         CL*15
   709         88  USE-NORMAL-PROCESS         VALUE ' '.                ELCDATE
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  14
* PEMCRM5.cbl (/apps/prod/cid1p/copy/ELCDATE)
   710         88  ADJUST-DOWN-100-YRS        VALUE '1'.                ELCDATE
   711         88  ADJUST-UP-100-YRS          VALUE '2'.                ELCDATE
   712     12  FILLER                        PIC X.                        CL*15
   713     12  DC-CONVERSION-DATES.                                        CL*15
   714         16  DC-BIN-DATE-1             PIC XX.                       CL*15
   715         16  DC-BIN-DATE-2             PIC XX.                       CL*15
   716         16  DC-GREG-DATE-1-EDIT       PIC X(08).                    CL*15
   717         16  DC-GREG-DATE-1-EDIT-R REDEFINES                         CL*15
   718                       DC-GREG-DATE-1-EDIT.                       ELCDATE
   719             20  DC-EDIT1-MONTH        PIC 99.                       CL*15
   720             20  SLASH1-1              PIC X.                        CL*15
   721             20  DC-EDIT1-DAY          PIC 99.                       CL*15
   722             20  SLASH1-2              PIC X.                        CL*15
   723             20  DC-EDIT1-YEAR         PIC 99.                       CL*15
   724         16  DC-GREG-DATE-2-EDIT       PIC X(08).                    CL*15
   725         16  DC-GREG-DATE-2-EDIT-R REDEFINES                         CL*15
   726                     DC-GREG-DATE-2-EDIT.                         ELCDATE
   727             20  DC-EDIT2-MONTH        PIC 99.                       CL*15
   728             20  SLASH2-1              PIC X.                        CL*15
   729             20  DC-EDIT2-DAY          PIC 99.                       CL*15
   730             20  SLASH2-2              PIC X.                        CL*15
   731             20  DC-EDIT2-YEAR         PIC 99.                       CL*15
   732         16  DC-GREG-DATE-1-YMD        PIC 9(06).                    CL*15
   733         16  DC-GREG-DATE-1-YMD-R  REDEFINES                         CL*15
   734                     DC-GREG-DATE-1-YMD.                          ELCDATE
   735             20  DC-YMD-YEAR           PIC 99.                       CL*15
   736             20  DC-YMD-MONTH          PIC 99.                       CL*15
   737             20  DC-YMD-DAY            PIC 99.                       CL*15
   738         16  DC-GREG-DATE-1-MDY        PIC 9(06).                    CL*15
   739         16  DC-GREG-DATE-1-MDY-R REDEFINES                          CL*15
   740                      DC-GREG-DATE-1-MDY.                         ELCDATE
   741             20  DC-MDY-MONTH          PIC 99.                       CL*15
   742             20  DC-MDY-DAY            PIC 99.                       CL*15
   743             20  DC-MDY-YEAR           PIC 99.                       CL*15
   744         16  DC-GREG-DATE-1-ALPHA.                                   CL*15
   745             20  DC-ALPHA-MONTH        PIC X(10).                    CL*15
   746             20  DC-ALPHA-DAY          PIC 99.                       CL*15
   747             20  FILLER                PIC XX.                       CL*15
   748             20  DC-ALPHA-CENTURY.                                   CL*15
   749                 24 DC-ALPHA-CEN-N     PIC 99.                       CL*15
   750             20  DC-ALPHA-YEAR         PIC 99.                       CL*15
   751         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.           CL*15
   752         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.           CL*15
   753         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.           CL*15
   754         16  DC-JULIAN-DATE            PIC 9(05).                    CL*15
   755         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE                CL*20
   756                                       PIC 9(05).                    CL*20
   757         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.                  CL*15
   758             20  DC-JULIAN-YEAR        PIC 99.                       CL*15
   759             20  DC-JULIAN-DAYS        PIC 999.                      CL*15
   760         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.       CL*15
   761         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.    CL*15
   762         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.    CL*15
   763     12  DATE-CONVERSION-VARIBLES.                                   CL*15
   764         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.            CL*15
   765         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.          CL*15
   766             20  FILLER                PIC 9(3).                     CL*15
   767             20  HOLD-CEN-1-CCYY.                                    CL*15
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  15
* PEMCRM5.cbl (/apps/prod/cid1p/copy/ELCDATE)
   768                 24  HOLD-CEN-1-CC     PIC 99.                       CL*17
   769                 24  HOLD-CEN-1-YY     PIC 99.                       CL*17
   770             20  HOLD-CEN-1-MO         PIC 99.                       CL*17
   771             20  HOLD-CEN-1-DA         PIC 99.                       CL*17
   772         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.            CL*15
   773             20  HOLD-CEN-1-R-MO       PIC 99.                       CL*17
   774             20  HOLD-CEN-1-R-DA       PIC 99.                       CL*17
   775             20  HOLD-CEN-1-R-CCYY.                                  CL*15
   776                 24  HOLD-CEN-1-R-CC   PIC 99.                       CL*17
   777                 24  HOLD-CEN-1-R-YY   PIC 99.                       CL*17
   778             20  FILLER                PIC 9(3).                     CL*15
   779         16  HOLD-CENTURY-1-X.                                       CL*15
   780             20  FILLER                PIC X(3)  VALUE SPACES.       CL*15
   781             20  HOLD-CEN-1-X-CCYY.                                  CL*15
   782                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.          CL*17
   783                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.          CL*17
   784             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.          CL*17
   785             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.          CL*17
   786         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.          CL*15
   787             20  HOLD-CEN-1-R-X-MO     PIC XX.                       CL*17
   788             20  HOLD-CEN-1-R-X-DA     PIC XX.                       CL*17
   789             20  HOLD-CEN-1-R-X-CCYY.                                CL*15
   790                 24  HOLD-CEN-1-R-X-CC PIC XX.                       CL*17
   791                 24  HOLD-CEN-1-R-X-YY PIC XX.                       CL*17
   792             20  FILLER                PIC XXX.                      CL*23
   793         16  DC-BIN-DATE-EXPAND-1      PIC XXX.                      CL*15
   794         16  DC-BIN-DATE-EXPAND-2      PIC XXX.                      CL*15
   795         16  DC-JULIAN-DATE-1          PIC 9(07).                    CL*15
   796         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.          CL*15
   797             20  DC-JULIAN-1-CCYY.                                   CL*15
   798                 24  DC-JULIAN-1-CC    PIC 99.                       CL*15
   799                 24  DC-JULIAN-1-YR    PIC 99.                       CL*15
   800             20  DC-JULIAN-DA-1        PIC 999.                      CL*15
   801         16  DC-JULIAN-DATE-2          PIC 9(07).                    CL*15
   802         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.          CL*15
   803             20  DC-JULIAN-2-CCYY.                                   CL*15
   804                 24  DC-JULIAN-2-CC    PIC 99.                       CL*15
   805                 24  DC-JULIAN-2-YR    PIC 99.                       CL*15
   806             20  DC-JULIAN-DA-2        PIC 999.                      CL*15
   807         16  DC-GREG-DATE-A-EDIT.                                    CL*15
   808             20  DC-EDITA-MONTH        PIC 99.                       CL*15
   809             20  SLASHA-1              PIC X VALUE '/'.              CL*15
   810             20  DC-EDITA-DAY          PIC 99.                       CL*15
   811             20  SLASHA-2              PIC X VALUE '/'.              CL*15
   812             20  DC-EDITA-CCYY.                                      CL*15
   813                 24  DC-EDITA-CENT     PIC 99.                       CL*15
   814                 24  DC-EDITA-YEAR     PIC 99.                       CL*15
   815         16  DC-GREG-DATE-B-EDIT.                                    CL*15
   816             20  DC-EDITB-MONTH        PIC 99.                       CL*15
   817             20  SLASHB-1              PIC X VALUE '/'.              CL*15
   818             20  DC-EDITB-DAY          PIC 99.                       CL*15
   819             20  SLASHB-2              PIC X VALUE '/'.              CL*15
   820             20  DC-EDITB-CCYY.                                      CL*15
   821                 24  DC-EDITB-CENT     PIC 99.                       CL*15
   822                 24  DC-EDITB-YEAR     PIC 99.                       CL*15
   823         16  DC-GREG-DATE-CYMD         PIC 9(08).                    CL*15
   824         16  DC-GREG-DATE-CYMD-R REDEFINES                           CL*15
   825                              DC-GREG-DATE-CYMD.                  ELCDATE
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  16
* PEMCRM5.cbl (/apps/prod/cid1p/copy/ELCDATE)
   826             20  DC-CYMD-CEN           PIC 99.                       CL*15
   827             20  DC-CYMD-YEAR          PIC 99.                       CL*15
   828             20  DC-CYMD-MONTH         PIC 99.                       CL*15
   829             20  DC-CYMD-DAY           PIC 99.                       CL*15
   830         16  DC-GREG-DATE-MDCY         PIC 9(08).                    CL*15
   831         16  DC-GREG-DATE-MDCY-R REDEFINES                           CL*15
   832                              DC-GREG-DATE-MDCY.                  ELCDATE
   833             20  DC-MDCY-MONTH         PIC 99.                       CL*15
   834             20  DC-MDCY-DAY           PIC 99.                       CL*15
   835             20  DC-MDCY-CEN           PIC 99.                       CL*15
   836             20  DC-MDCY-YEAR          PIC 99.                       CL*15
   837    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.      ELCDATE
   838        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.        ELCDATE
   839    12  DC-EL310-DATE                  PIC X(21).                    CL*26
   840    12  FILLER                         PIC X(28).                    CL*26
   841 PROCEDURE DIVISION.
   842
   843     OPEN INPUT    GAAP-IN    CERT-IN
   844
   845     OPEN OUTPUT      GAAP-OUT
   846
   847     PERFORM 0010-READ-GAAP      THRU 0010-EXIT
   848     PERFORM 0015-READ-CERT      THRU 0015-EXIT
   849
   850     PERFORM 0020-PROCESS THRU 0020-EXIT UNTIL
   851        END-OF-GAAP
   852
   853     CLOSE   GAAP-IN   CERT-IN  GAAP-OUT
   854
   855     DISPLAY ' CERT RECS READ ' CERT-IN-CNT
   856     DISPLAY ' GAAP RECS READ ' GAAP-IN-CNT
   857     DISPLAY ' GAAP RECS OUT  ' GAAP-OT-CNT
   858     DISPLAY ' GAAP RECS FIX  ' GAAP-FIX-CNT
   859
   860     GOBACK
   861
   862     .
   863 0010-READ-GAAP.
   864
   865     READ GAAP-IN AT END
   866        DISPLAY ' FOUND END OF GAAP '
   867        SET END-OF-GAAP TO TRUE
   868     END-READ
   869
   870     IF NOT END-OF-GAAP
   871        ADD  1    TO GAAP-IN-CNT
   872        IF GR-REIN = 'R'
   873           GO TO 0010-READ-GAAP
   874        END-IF
   875     END-IF
   876
   877     .
   878 0010-EXIT.
   879     EXIT.
   880
   881 0015-READ-CERT.
   882
   883     READ CERT-IN AT END
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  17
* PEMCRM5.cbl
   884        DISPLAY ' FOUND END OF CERT '
   885        SET END-OF-CERT TO TRUE
   886     END-READ
   887
   888     IF NOT END-OF-CERT
   889        ADD  1    TO CERT-IN-CNT
   890     END-IF
   891
   892     .
   893 0015-EXIT.
   894     EXIT.
   895
   896 0020-PROCESS.
   897
   898*    DISPLAY ' EXT KEY = ' EXT-KEY
   899*    DISPLAY 'CERT KEY = ' CERT-KEY
   900     IF GR-CONTROL = CR-FULL-CONTROL
   901        PERFORM 0030-MATCHED     THRU 0030-EXIT
   902        PERFORM 0010-READ-GAAP   THRU 0010-EXIT
   903     ELSE
   904        IF GR-CONTROL > CR-FULL-CONTROL
   905           PERFORM 0015-READ-CERT
   906                                 THRU 0015-EXIT
   907        ELSE
   908           DISPLAY ' NO MATCH ' GR-CONTROL '  ' CR-FULL-CONTROL
   909           PERFORM 0010-READ-GAAP THRU 0010-EXIT
   910        END-IF
   911     END-IF
   912
   913     .
   914 0020-EXIT.
   915      EXIT.
   916
   917 0030-MATCHED.
   918
   919     ADD 1 TO GAAP-FIX-CNT
   920
   921     MOVE CR-RATING-CLASS        TO GR-INS-NAME (1:2)
   922     MOVE CR-LF-DEV-CODE         TO GR-INS-NAME (3:3)
   923     MOVE CR-AH-DEV-CODE         TO GR-INS-NAME (6:3)
   924     PERFORM 0040-WRITE-GAAP     THRU 0040-EXIT
   925     .
   926 0030-EXIT.
   927      EXIT.
   928
   929 0040-WRITE-GAAP.
   930
   931     WRITE GAAP-OUT-RECORD FROM GAAP-RECORD
   932     ADD 1 TO GAAP-OT-CNT
   933
   934     .
   935 0040-EXIT.
   936     EXIT.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:        3956     Code:        1019
