* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   1
* SUNPRMX.cbl
* Options: int("SUNPRMX.int") anim csi verbose NOBOUND PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("SUNPRMX.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"ebmlsfile" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" NOCHECKDIV NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"32" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"SUNPRMX.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"SUNPRMX.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR NOSTICKY-LINKAGE
*          NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"2" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                 SUNPRMX.
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 10/17/94 15:27:20.
     7*                            VMOD=2.004
     8*
     9*AUTHOR.       LOGIC, INC.
    10*              DALLAS, TEXAS.
    11
    12*DATE-COMPILED.
    13
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   2
* SUNPRMX.cbl
    14*SECURITY.   *****************************************************
    15*            *                                                   *
    16*            *   THIS PROGRAM IS THE PROPERTY OF LOGIC, INC.     *
    17*            *                                                   *
    18*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
    19*                                                                *
    20*            *   OF LOGIC, INC. IS EXPRESSLY PROHIBITED WITHOUT  *
    21*            *   THE PRIOR WRITTEN PERMISSION OF LOGIC INC.      *
    22*            *                                                   *
    23*            *****************************************************
    24
    25*REMARKS.    *****************************************************
    26*            *                                                   *
    27*            *    THIS 'SUBROUTINE' WILL, DEPENDING UPON THE     *
    28*            *    OPTION SPECIFIED, COMPUTE UNEARNED PREMIUM     *
    29*            *****************************************************
    30
    31
    32******************************************************************
    33*                                                                *
    34*              INPUT FIELDS USED                                 *
    35*                                                                *
    36******************************************************************
    37*  CERT ISSUE DATE  - CP-CERT-EFF-DT                             *
    38*  REFUND DATE      - CP-VALUATION-DT                            *
    39*  ORIGINAL TERM    - CP-ORIGINAL-TERM                           *
    40*  CAPPED TERM      - CP-LOAN-TERM                               *
    41*  REMAINING TERM   - CP-REMAINING-TERM                          *
    42*  STATE CODE       - CP-STATE                                   *
    43*  STATE CODE       - CP-STATE-STD-ABBV                          *
    44*  CLASS CODE       - CP-CLASS-CODE                              *
    45*  DEVIATION CODE   - CP-DEVIATION-CODE                          *
    46*  ORIGINAL BENEFIT - CP-ORIGINAL-BENEFIT                        *
    47*  PROCESS TYPE     - CP-PROCESS-TYPE                            *
    48*  BENEFIT KIND     - CP-BENEFIT-TYPE                            *
    49*  A.P.R.           - CP-LOAN-APR                                *
    50*  METHOD           - CP-EARNING-METHOD                          *
    51*  SPECIAL METHOD   - CP-SPECIAL-CALC-CODE                       *
    52*  PAYMENT FREQUENCY- CP-PAY-FREQUENCY                           *
    53*  COMPANY I.D.     - CP-COMPANY-ID                              *
    54*  BENEFIT CODE     - CP-BENEFIT-CD                              *
    55*  INSURED AGE      - CP-ISSUE-AGE                               *
    56******************************************************************
    57 ENVIRONMENT DIVISION.
    58
    59 DATA DIVISION.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   3
* SUNPRMX.cbl
    61 WORKING-STORAGE SECTION.
    62 77  FILLER   PIC X(32) VALUE '********************************'.
    63 77  FILLER   PIC X(32) VALUE '**  ELUPRMX WORKING STORAGE   **'.
    64 77  FILLER   PIC X(32) VALUE '*** VMOD=2.004 *****************'.
    65
    66 01  WS-WORK-MISC.
    67     12  WS-REMAINING-TERM   PIC S9(4)V9      COMP-3.
    68     12  WS-TEMP-RESULT      PIC S9(7)V9(6)   COMP-3.
    69     12  WS-REMAINING-AMT    PIC S9(7)V9(6)   COMP-3.
    70     12  WS-ORIG-PREM        PIC S9(7)V9(6)   COMP-3.
    71     12  WS-REMAIN-PREM      PIC S9(7)V9(6)   COMP-3.
    72     12  WS-NP-REF-FACTOR    PIC S9(4)V9(11)  COMP-3.
    73     12  WS-SAVE-TERM        PIC S9(3)        COMP-3.
    74     12  UNEARN-PRM          PIC S9(5)V99     COMP-3.
    75     12  FACTOR-1            PIC S9(4)V9(11)  COMP-3.
    76     12  FACTOR-2            PIC S9(4)V9(11)  COMP-3.
    77     12  FACTOR-3            PIC S9(4)V9(11)  COMP-3.
    78     12  FACTOR-4            PIC S9(4)V9(11)  COMP-3.
    79     12  FACTOR-5            PIC S9(7)        COMP-3.
    80     12  FACTOR-6            PIC S9(7)        COMP-3.
    81     12  RATE-FACTOR-1       PIC S9V99        COMP-3.
    82     12  RATE-FACTOR-2       PIC S999         COMP-3.
    83     12  R78-TEMP-1          PIC S9(5)V99     COMP-3.
    84     12  R78-TEMP-2          PIC S9(5)V99     COMP-3.
    85     12  R78-FACTOR          PIC S9(4)V9(11)  COMP-3.
    86     12  R78-UN-PREMIUM      PIC S9(7)V99     COMP-3.
    87     12  R78-UN-PREM-ALT     PIC S9(7)V99     COMP-3.
    88     12  PR-FACTOR           PIC S9(4)V9(11)  COMP-3.
    89     12  PR-UN-PREMIUM       PIC S9(7)V99     COMP-3.
    90     12  PR-UN-PREM-ALT      PIC S9(7)V99     COMP-3.
    91     12  STATE-UN-PREMIUM    PIC S9(7)V99     COMP-3.
    92     12  DOMI-UN-PREMIUM     PIC S9(7)V99     COMP-3.
    93     12  SRL                 PIC S9(4)        COMP  VALUE +00.
    94
    95 01  AH-RES-STATE-TABLE.
    96     12  FILLER              PIC X(42)  VALUE
    97            'AKALAZCADEGAIDILKSKYLAMDMIMTNVOHORSCSDWIWY'.
    98     12  FILLER              PIC XX     VALUE HIGH-VALUES.
    99
   100 01  AH-RES-STAT-TAB  REDEFINES AH-RES-STATE-TABLE.
   101     12  AH-RES-STATE-ENT    PIC XX     OCCURS 22 TIMES.
   102
   103 01  TEXAS-REG-WORK-AREAS.
   104     12  TEX-FACT-1          PIC S9(7)V9(2)  COMP-3.
   105     12  TEX-FACT-2          PIC S9(3)       COMP-3.
   106     12  TEX-FACT-3          PIC S9(3)       COMP-3.
   107     12  TEX-FACT-4          PIC S9(7)       COMP-3.
   108     12  TEX-FACT-5          PIC S9(3)       COMP-3.
   109     12  TEX-FACT-6          PIC S9(3)       COMP-3.
   110     12  TEX-FACT-7          PIC S9(7)       COMP-3.
   111     12  TEX-FACT-8          PIC S9V9(6)     COMP-3.
   112     12  TEX-FACT-9          PIC S9(4)V9(11) COMP-3.
   113
   114 01  NET-PAY-INTERFACE.
   115     12  N-P-APR             PIC S9(3)V9(4)  COMP-3.
   116     12  N-P-ORIG            PIC S9(3)       COMP-3.
   117     12  N-P-REM             PIC S9(3)       COMP-3.
   118     12  N-P-OPT             PIC X.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   4
* SUNPRMX.cbl
   119     12  N-P-CAP             PIC S9(3)       COMP-3.
   120     12  N-P-LOAN            PIC S9(3)       COMP-3.
   121     12  N-P-FACTOR          PIC S9(4)V9(9)  COMP-3.
   122
   123*************************COPY ERCNETWS.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   5
* SUNPRMX.cbl
*  125                         COPY ELCDATE.
   126******************************************************************06/11/98
   127*                                                                *ELCDATE
   128*                                                                *ELCDATE
   129*                            ELCDATE.                            *   LV023
   130*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL*16
   131*                            VMOD=2.003                           ELCDATE
   132*                                                                *ELCDATE
   133*                                                                *ELCDATE
   134*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *ELCDATE
   135*                 LENGTH = 200                                   *   CL*19
   136******************************************************************ELCDATE
   137                                                                  ELCDATE
   138 01  DATE-CONVERSION-DATA.                                        ELCDATE
   139     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.    CL*19
   140     12  DC-OPTION-CODE                PIC X.                        CL*15
   141         88  BIN-TO-GREG                VALUE ' '.                ELCDATE
   142         88  ELAPSED-BETWEEN-BIN        VALUE '1'.                ELCDATE
   143         88  EDIT-GREG-TO-BIN           VALUE '2'.                ELCDATE
   144         88  YMD-GREG-TO-BIN            VALUE '3'.                ELCDATE
   145         88  MDY-GREG-TO-BIN            VALUE '4'.                ELCDATE
   146         88  JULIAN-TO-BIN              VALUE '5'.                ELCDATE
   147         88  BIN-PLUS-ELAPSED           VALUE '6'.                ELCDATE
   148         88  FIND-CENTURY               VALUE '7'.                   CL*22
   149         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.                ELCDATE
   150         88  EDIT-GREG-TO-BIN-3         VALUE '9'.                ELCDATE
   151         88  YMD-GREG-TO-BIN-3          VALUE 'A'.                ELCDATE
   152         88  MDY-GREG-TO-BIN-3          VALUE 'B'.                ELCDATE
   153         88  JULIAN-TO-BIN-3            VALUE 'C'.                ELCDATE
   154         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.                ELCDATE
   155         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.                   CL*14
   156         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.                   CL*14
   157         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.                   CL*14
   158         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.         CL*14
   159         88  CHECK-LEAP-YEAR            VALUE 'H'.                   CL*14
   160         88  BIN-3-TO-GREG              VALUE 'I'.                   CL*14
   161         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.                   CL*14
   162         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.                   CL*14
   163         88  CYMD-GREG-TO-BIN           VALUE 'L'.                   CL*14
   164         88  MDCY-GREG-TO-BIN           VALUE 'M'.                   CL*14
   165         88  MDY-GREG-TO-JULIAN         VALUE 'N'.                   CL*14
   166         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.                   CL*14
   167         88  YMD-GREG-TO-JULIAN         VALUE 'P'.                   CL*14
   168         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.                   CL*14
   169         88  THREE-CHARACTER-BIN                                  ELCDATE
   170                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.       CL*14
   171         88  GREGORIAN-TO-BIN                                        CL**2
   172                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.    CL*14
   173         88  BIN-TO-GREGORIAN                                        CL**2
   174                  VALUES ' ' '1' 'I' '8' 'G'.                        CL*14
   175         88  JULIAN-TO-BINARY                                        CL**2
   176                  VALUES '5' 'C' 'E' 'F'.                            CL*14
   177     12  DC-ERROR-CODE                 PIC X.                        CL*15
   178         88  NO-CONVERSION-ERROR        VALUE ' '.                   CL**3
   179         88  DATE-CONVERSION-ERROR                                ELCDATE
   180                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.        CL*14
   181         88  DATE-IS-ZERO               VALUE '1'.                ELCDATE
   182         88  DATE-IS-NON-NUMERIC        VALUE '2'.                ELCDATE
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   6
* SUNPRMX.cbl (/apps/prod/cid1p/copy/ELCDATE)
   183         88  DATE-IS-INVALID            VALUE '3'.                ELCDATE
   184         88  DATE1-GREATER-DATE2        VALUE '4'.                ELCDATE
   185         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.                ELCDATE
   186         88  DATE-INVALID-OPTION        VALUE '9'.                ELCDATE
   187         88  INVALID-CENTURY            VALUE 'A'.                ELCDATE
   188         88  ONLY-CENTURY               VALUE 'B'.                ELCDATE
   189         88  ONLY-LEAP-YEAR             VALUE 'C'.                ELCDATE
   190         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.              CL**3
   191     12  DC-END-OF-MONTH               PIC X.                        CL*15
   192         88  CALCULATE-END-OF-MONTH     VALUE '1'.                ELCDATE
   193     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.         CL*15
   194         88  USE-NORMAL-PROCESS         VALUE ' '.                ELCDATE
   195         88  ADJUST-DOWN-100-YRS        VALUE '1'.                ELCDATE
   196         88  ADJUST-UP-100-YRS          VALUE '2'.                ELCDATE
   197     12  FILLER                        PIC X.                        CL*15
   198     12  DC-CONVERSION-DATES.                                        CL*15
   199         16  DC-BIN-DATE-1             PIC XX.                       CL*15
   200         16  DC-BIN-DATE-2             PIC XX.                       CL*15
   201         16  DC-GREG-DATE-1-EDIT       PIC X(08).                    CL*15
   202         16  DC-GREG-DATE-1-EDIT-R REDEFINES                         CL*15
   203                       DC-GREG-DATE-1-EDIT.                       ELCDATE
   204             20  DC-EDIT1-MONTH        PIC 99.                       CL*15
   205             20  SLASH1-1              PIC X.                        CL*15
   206             20  DC-EDIT1-DAY          PIC 99.                       CL*15
   207             20  SLASH1-2              PIC X.                        CL*15
   208             20  DC-EDIT1-YEAR         PIC 99.                       CL*15
   209         16  DC-GREG-DATE-2-EDIT       PIC X(08).                    CL*15
   210         16  DC-GREG-DATE-2-EDIT-R REDEFINES                         CL*15
   211                     DC-GREG-DATE-2-EDIT.                         ELCDATE
   212             20  DC-EDIT2-MONTH        PIC 99.                       CL*15
   213             20  SLASH2-1              PIC X.                        CL*15
   214             20  DC-EDIT2-DAY          PIC 99.                       CL*15
   215             20  SLASH2-2              PIC X.                        CL*15
   216             20  DC-EDIT2-YEAR         PIC 99.                       CL*15
   217         16  DC-GREG-DATE-1-YMD        PIC 9(06).                    CL*15
   218         16  DC-GREG-DATE-1-YMD-R  REDEFINES                         CL*15
   219                     DC-GREG-DATE-1-YMD.                          ELCDATE
   220             20  DC-YMD-YEAR           PIC 99.                       CL*15
   221             20  DC-YMD-MONTH          PIC 99.                       CL*15
   222             20  DC-YMD-DAY            PIC 99.                       CL*15
   223         16  DC-GREG-DATE-1-MDY        PIC 9(06).                    CL*15
   224         16  DC-GREG-DATE-1-MDY-R REDEFINES                          CL*15
   225                      DC-GREG-DATE-1-MDY.                         ELCDATE
   226             20  DC-MDY-MONTH          PIC 99.                       CL*15
   227             20  DC-MDY-DAY            PIC 99.                       CL*15
   228             20  DC-MDY-YEAR           PIC 99.                       CL*15
   229         16  DC-GREG-DATE-1-ALPHA.                                   CL*15
   230             20  DC-ALPHA-MONTH        PIC X(10).                    CL*15
   231             20  DC-ALPHA-DAY          PIC 99.                       CL*15
   232             20  FILLER                PIC XX.                       CL*15
   233             20  DC-ALPHA-CENTURY.                                   CL*15
   234                 24 DC-ALPHA-CEN-N     PIC 99.                       CL*15
   235             20  DC-ALPHA-YEAR         PIC 99.                       CL*15
   236         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.           CL*15
   237         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.           CL*15
   238         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.           CL*15
   239         16  DC-JULIAN-DATE            PIC 9(05).                    CL*15
   240         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE                CL*20
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   7
* SUNPRMX.cbl (/apps/prod/cid1p/copy/ELCDATE)
   241                                       PIC 9(05).                    CL*20
   242         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.                  CL*15
   243             20  DC-JULIAN-YEAR        PIC 99.                       CL*15
   244             20  DC-JULIAN-DAYS        PIC 999.                      CL*15
   245         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.       CL*15
   246         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.    CL*15
   247         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.    CL*15
   248     12  DATE-CONVERSION-VARIBLES.                                   CL*15
   249         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.            CL*15
   250         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.          CL*15
   251             20  FILLER                PIC 9(3).                     CL*15
   252             20  HOLD-CEN-1-CCYY.                                    CL*15
   253                 24  HOLD-CEN-1-CC     PIC 99.                       CL*17
   254                 24  HOLD-CEN-1-YY     PIC 99.                       CL*17
   255             20  HOLD-CEN-1-MO         PIC 99.                       CL*17
   256             20  HOLD-CEN-1-DA         PIC 99.                       CL*17
   257         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.            CL*15
   258             20  HOLD-CEN-1-R-MO       PIC 99.                       CL*17
   259             20  HOLD-CEN-1-R-DA       PIC 99.                       CL*17
   260             20  HOLD-CEN-1-R-CCYY.                                  CL*15
   261                 24  HOLD-CEN-1-R-CC   PIC 99.                       CL*17
   262                 24  HOLD-CEN-1-R-YY   PIC 99.                       CL*17
   263             20  FILLER                PIC 9(3).                     CL*15
   264         16  HOLD-CENTURY-1-X.                                       CL*15
   265             20  FILLER                PIC X(3)  VALUE SPACES.       CL*15
   266             20  HOLD-CEN-1-X-CCYY.                                  CL*15
   267                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.          CL*17
   268                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.          CL*17
   269             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.          CL*17
   270             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.          CL*17
   271         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.          CL*15
   272             20  HOLD-CEN-1-R-X-MO     PIC XX.                       CL*17
   273             20  HOLD-CEN-1-R-X-DA     PIC XX.                       CL*17
   274             20  HOLD-CEN-1-R-X-CCYY.                                CL*15
   275                 24  HOLD-CEN-1-R-X-CC PIC XX.                       CL*17
   276                 24  HOLD-CEN-1-R-X-YY PIC XX.                       CL*17
   277             20  FILLER                PIC XXX.                      CL*23
   278         16  DC-BIN-DATE-EXPAND-1      PIC XXX.                      CL*15
   279         16  DC-BIN-DATE-EXPAND-2      PIC XXX.                      CL*15
   280         16  DC-JULIAN-DATE-1          PIC 9(07).                    CL*15
   281         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.          CL*15
   282             20  DC-JULIAN-1-CCYY.                                   CL*15
   283                 24  DC-JULIAN-1-CC    PIC 99.                       CL*15
   284                 24  DC-JULIAN-1-YR    PIC 99.                       CL*15
   285             20  DC-JULIAN-DA-1        PIC 999.                      CL*15
   286         16  DC-JULIAN-DATE-2          PIC 9(07).                    CL*15
   287         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.          CL*15
   288             20  DC-JULIAN-2-CCYY.                                   CL*15
   289                 24  DC-JULIAN-2-CC    PIC 99.                       CL*15
   290                 24  DC-JULIAN-2-YR    PIC 99.                       CL*15
   291             20  DC-JULIAN-DA-2        PIC 999.                      CL*15
   292         16  DC-GREG-DATE-A-EDIT.                                    CL*15
   293             20  DC-EDITA-MONTH        PIC 99.                       CL*15
   294             20  SLASHA-1              PIC X VALUE '/'.              CL*15
   295             20  DC-EDITA-DAY          PIC 99.                       CL*15
   296             20  SLASHA-2              PIC X VALUE '/'.              CL*15
   297             20  DC-EDITA-CCYY.                                      CL*15
   298                 24  DC-EDITA-CENT     PIC 99.                       CL*15
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   8
* SUNPRMX.cbl (/apps/prod/cid1p/copy/ELCDATE)
   299                 24  DC-EDITA-YEAR     PIC 99.                       CL*15
   300         16  DC-GREG-DATE-B-EDIT.                                    CL*15
   301             20  DC-EDITB-MONTH        PIC 99.                       CL*15
   302             20  SLASHB-1              PIC X VALUE '/'.              CL*15
   303             20  DC-EDITB-DAY          PIC 99.                       CL*15
   304             20  SLASHB-2              PIC X VALUE '/'.              CL*15
   305             20  DC-EDITB-CCYY.                                      CL*15
   306                 24  DC-EDITB-CENT     PIC 99.                       CL*15
   307                 24  DC-EDITB-YEAR     PIC 99.                       CL*15
   308         16  DC-GREG-DATE-CYMD         PIC 9(08).                    CL*15
   309         16  DC-GREG-DATE-CYMD-R REDEFINES                           CL*15
   310                              DC-GREG-DATE-CYMD.                  ELCDATE
   311             20  DC-CYMD-CEN           PIC 99.                       CL*15
   312             20  DC-CYMD-YEAR          PIC 99.                       CL*15
   313             20  DC-CYMD-MONTH         PIC 99.                       CL*15
   314             20  DC-CYMD-DAY           PIC 99.                       CL*15
   315         16  DC-GREG-DATE-MDCY         PIC 9(08).                    CL*15
   316         16  DC-GREG-DATE-MDCY-R REDEFINES                           CL*15
   317                              DC-GREG-DATE-MDCY.                  ELCDATE
   318             20  DC-MDCY-MONTH         PIC 99.                       CL*15
   319             20  DC-MDCY-DAY           PIC 99.                       CL*15
   320             20  DC-MDCY-CEN           PIC 99.                       CL*15
   321             20  DC-MDCY-YEAR          PIC 99.                       CL*15
   322    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.      ELCDATE
   323        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.        ELCDATE
   324    12  DC-EL310-DATE                  PIC X(21).                    CL*26
   325    12  FILLER                         PIC X(28).                    CL*26
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   9
* SUNPRMX.cbl
   327
   328
   329 LINKAGE SECTION.
*  330                          COPY ELCCALC.
   331******************************************************************04/15/98
   332*                                                                *ELCCALC
   333*                           ELCCALC.                            *    LV003
   334*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
   335*                            VMOD=2.025                          *   CL**3
   336*                                                                *   CL**2
   337*   DESCRIPTION:  DATA TO BE PASSED TO REMAINING TERM ROUTINE    *   CL**2
   338*                 REMAINING AMOUNT ROUTINE, LOSS RESERVE ROUTINE *   CL**2
   339*                 REFUND CALCULATIONS ROUTINE, EARNINGS CALCU -  *   CL**2
   340*                 LATIONS ROUTINE, AND THE RATING ROUTINE.       *   CL**2
   341*                                                                *   CL**2
   342*  PASSED TO ELRTRM                                              *   CL**2
   343*  -----------------                                             *   CL**2
   344*  METHOD CODE (I.E. FULL MONTH, HALF ADJ, ETC)                  *   CL**2
   345*  ORIGINAL TERM                                                 *   CL**2
   346*  BEGINNING DATE                                                *   CL**2
   347*  ENDING DATE                                                   *   CL**2
   348*  COMPANY I.D.                                                  *   CL**2
   349*  ACCOUNT MASTER USER FIELD                                     *   CL**2
   350*  PROCESS SWITCH (CANCEL, CLAIM)                                *   CL**2
   351*  FREE LOOK DAYS                                                *   CL**2
   352*                                                                *   CL**2
   353*  RETURNED FROM ELRTRM                                          *   CL**2
   354*  ---------------------                                         *   CL**2
   355*  REMAINING TERM 1 - USED FOR EARNINGS                          *   CL**2
   356*  REMAINING TERM 2 - USED FOR BENEFIT CALCULATIONS              *   CL**2
   357*  REMAINING TERM 3 - USED FOR CLAIM BENEFITS                    *   CL**2
   358*  ODD DAYS - REMAINING DAYS PAST FULL MONTHS                    *   CL**2
   359*----------------------------------------------------------------*   CL**2
   360*  PASSED TO ELRAMT                                              *   CL**2
   361*  ----------------                                              *   CL**2
   362*  REMAINING TERM 1 OR 2 OR 3 (FROM ELRTRM)                      *   CL**2
   363*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *   CL**2
   364*  ORIGINAL AMOUNT                                               *   CL**2
   365*  ALTERNATE BENEFIT (BALLON)                                    *   CL**2
   366*  A.P.R. - NET PAY ONLY                                         *   CL**2
   367*  METHOD                                                            CL**2
   368*  PAYMENT FREQUENCY - FOR FARM PLAN                             *   CL**2
   369*  COMPANY I.D.                                                  *   CL**2
   370*  BENEFIT TYPE                                                  *   CL**2
   371*                                                                *   CL**2
   372*  RETURNED FROM ELRAMT                                          *   CL**2
   373*  --------------------                                          *   CL**2
   374*  REMAINING AMOUNT 1 - CURRENT                                  *   CL**2
   375*  REMAINING AMOUNT 2 - PREVIOUS MONTH                           *   CL**2
   376*  REMAINING AMOUNT FACTOR                                           CL**2
   377*----------------------------------------------------------------*   CL**2
   378*  PASSED TO ELRESV                                              *   CL**2
   379*  -----------------                                             *   CL**2
   380*  CERTIFICATE EFFECTIVE DATE                                    *   CL**2
   381*  VALUATION DATE                                                *   CL**2
   382*  PAID THRU DATE                                                *   CL**2
   383*  BENEFIT                                                       *   CL**2
   384*  INCURRED DATE                                                 *   CL**2
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  10
* SUNPRMX.cbl (/apps/prod/cid1p/copy/ELCCALC)
   385*  REPORTED DATE                                                 *   CL**2
   386*  ISSUE AGE                                                     *   CL**2
   387*  TERM                                                          *   CL**2
   388*  CDT PERCENT                                                   *   CL**2
   389*  CDT METHOD (I.E. INTERPOLATED, AVERAGE, ETC)                  *   CL**2
   390* *CLAIM TYPE (LIFE, A/H)                                        *   CL**2
   391* *REMAINING BENEFIT (FROM ELRAMT)                               *   CL**2
   392* *ONLY FIELDS REQUIRED FOR LIFE CLAIMS                          *   CL**2
   393*                                                                *   CL**2
   394*  RETURNED FROM ELRESV                                          *   CL**2
   395*  --------------------                                          *   CL**2
   396*  CDT TABLE USED                                                *   CL**2
   397*  CDT FACTOR USED                                               *   CL**2
   398*  PAY TO CURRENT RESERVE                                        *   CL**2
   399*  I.B.N.R. - A/H ONLY                                           *   CL**2
   400*  FUTURE (ACCRUED) AH ONLY                                      *   CL**2
   401*----------------------------------------------------------------*   CL**2
   402*  PASSED TO ELRATE                                              *   CL**2
   403*  ----------------                                              *   CL**2
   404*  CERT ISSUE DATE                                               *   CL**2
   405*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *   CL**2
   406*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *   CL**2
   407*  CAPPED TERM   (ONLY FOR TRUNCATED LIFE)                       *   CL**2
   408*  STATE CODE (CLIENT DEFINED)                                   *   CL**2
   409*  STATE CODE (STANDARD P.O. ABBRV)                              *   CL**2
   410*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *   CL**2
   411*  DEVIATION CODE                                                *   CL**2
   412*  ISSUE AGE                                                     *   CL**2
   413*  ORIGINAL BENEFIT AMOUNT                                       *   CL**2
   414*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *   CL**2
   415*  PROCESS TYPE (ISSUE OR CANCEL)                                *   CL**2
   416*  BENEFIT KIND (LIFE OR A/H)                                    *   CL**2
   417*  A.P.R.                                                        *   CL**2
   418*  METHOD                                                            CL**2
   419*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *   CL**2
   420*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *   CL**2
   421*  COMPANY I.D. (3 CHARACTER)                                    *   CL**2
   422*  BENEFIT CODE                                                  *   CL**2
   423*  BENEFIT OVERRIDE CODE                                         *   CL**2
   424*  MAXIMUM MONTHLY BENEFIT (FROM ACCT MASTER - CSL ONLY)         *   CL**2
   425*  MAXIMUM TOTAL BENEFIT (FROM ACCT MASTER - CSL ONLY)           *   CL**2
   426*  JOINT INDICATOR (CSL ONLY)                                    *   CL**2
   427*  FIRST PAYMENT DATE (CSL ONLY)                                 *   CL**2
   428*  PERIODIC PAYMENT AMOUNT (IN CP-REMAINING-TERM - CSL ONLY)     *   CL**2
   429*                                                                *   CL**2
   430*  RETURNED FROM ELRATE                                          *   CL**2
   431*  --------------------                                          *   CL**2
   432*  CALCULATED PREMIUM                                            *   CL**2
   433*  PREMIUM RATE                                                  *   CL**2
   434*  MORTALITY CODE                                                *   CL**2
   435*  MAX ATTAINED AGE                                              *   CL**2
   436*  MAX AGE                                                       *   CL**2
   437*  MAX TERM                                                      *   CL**2
   438*  MAX MONTHLY BENEFIT                                           *   CL**2
   439*  MAX TOTAL BENIFIT                                             *   CL**2
   440*  COMPOSITE RATE (OPEN-END ONLY)                                *   CL**2
   441*----------------------------------------------------------------*   CL**2
   442*  PASSED TO ELRFND                                              *   CL**2
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  11
* SUNPRMX.cbl (/apps/prod/cid1p/copy/ELCCALC)
   443*  ----------------                                              *   CL**2
   444*  CERT ISSUE DATE                                               *   CL**2
   445*  REFUND DATE                                                   *   CL**2
   446*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *   CL**2
   447*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *   CL**2
   448*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *   CL**2
   449*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *   CL**2
   450*  STATE CODE (CLIENT DEFINED)                                   *   CL**2
   451*  STATE CODE (STANDARD P.O. ABBRV)                              *   CL**2
   452*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *   CL**2
   453*  DEVIATION CODE                                                *   CL**2
   454*  ISSUE AGE                                                     *   CL**2
   455*  ORIGINAL BENEFIT AMOUNT                                       *   CL**2
   456*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *   CL**2
   457*  PROCESS TYPE (CANCEL)                                         *   CL**2
   458*  BENEFIT KIND (LIFE OR A/H)                                    *   CL**2
   459*  A.P.R.                                                        *   CL**2
   460*  EARNING METHOD - (CODE FROM BENEFIT, STATE OR ACCOUNT RECORD) *   CL**2
   461*  RATING METHOD -  (CODE FROM BENEFIT)                          *   CL**2
   462*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *   CL**2
   463*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *   CL**2
   464*  COMPANY I.D. (3 CHARACTER)                                    *   CL**2
   465*  BENEFIT CODE                                                  *   CL**2
   466*  BENEFIT OVERRIDE CODE                                         *   CL**2
   467*                                                                *   CL**2
   468*  RETURNED FROM ELRFND                                          *   CL**2
   469*  --------------------                                          *   CL**2
   470*  CALCULATED REFUND                                             *   CL**2
   471*----------------------------------------------------------------*   CL**2
   472*  PASSED TO ELEARN                                              *   CL**2
   473*  ----------------                                              *   CL**2
   474*  CERT ISSUE DATE                                               *   CL**2
   475*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *   CL**2
   476*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *   CL**2
   477*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *   CL**2
   478*  STATE CODE (CLIENT DEFINED)                                   *   CL**2
   479*  STATE CODE (STANDARD P.O. ABBRV)                              *   CL**2
   480*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *   CL**2
   481*  DEVIATION CODE                                                *   CL**2
   482*  ISSUE AGE                                                     *   CL**2
   483*  ORIGINAL BENEFIT AMOUNT                                       *   CL**2
   484*  BENEFIT KIND (LIFE OR A/H)                                    *   CL**2
   485*  A.P.R.                                                        *   CL**2
   486*  METHOD - (EARNING CODE FROM BENEFIT RECORD)                   *   CL**2
   487*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *   CL**2
   488*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *   CL**2
   489*  COMPANY I.D. (3 CHARACTER)                                    *   CL**2
   490*  BENEFIT CODE                                                  *   CL**2
   491*  BENEFIT OVERRIDE CODE                                         *   CL**2
   492*                                                                *   CL**2
   493*  RETURNED FROM ELEARN                                          *   CL**2
   494*  --------------------                                          *   CL**2
   495*  INDICATED  EARNINGS                                           *   CL**2
   496*----------------------------------------------------------------*   CL**2
   497*                 LENGTH = 450                                   *   CL**2
   498*                                                                *   CL**2
   499******************************************************************   CL**2
   500******************************************************************
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  12
* SUNPRMX.cbl (/apps/prod/cid1p/copy/ELCCALC)
   501*                   C H A N G E   L O G
   502*
   503* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   504*-----------------------------------------------------------------
   505*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   506* EFFECTIVE    NUMBER
   507*-----------------------------------------------------------------
   508* 010303    2001061800003  PEMA  ADD DCC/MONTHLY PROCESSING
   509* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
   510* 101807    2007100100007  PEMA  EXPAND CLM RESERVE FIELDS
   511* 010410    2008021200005  PEMA  ADD FIELDS FOR MN NET PAY BALLOON
   512* 010410    2009050700003  PEMA  ADD FIELDS FOR SPP-DD
   513* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
   514* 041710    2007111300001  AJRA  ADD CLAIM CALC SW FOR SC NP+6
   515* 101110  CR2010012700001  PEMA ADD DDF REFUND/UEP PROCESSING
   516* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
   517* 040615  CR2013072200002  PEMA  ADD EXTRA PERIODS
   518******************************************************************
   519                                                                     CL**2
   520 01  CALCULATION-PASS-AREA.                                          CL**2
   521     12  CP-COMM-LENGTH            PIC S9(4)         VALUE +450      CL**2
   522                                     COMP.                           CL**2
   523                                                                     CL**2
   524     12  CP-RETURN-CODE            PIC X             VALUE ZERO.     CL**2
   525       88  NO-CP-ERROR                             VALUE ZERO.       CL**2
   526       88  CP-ERROR-OCCURED VALUE '1' '2' '3' '4' '5' '6' '7' '8'    CL**2
   527                                  '9' 'A' 'B' 'C' 'D' 'E' 'H'.       CL**2
   528       88  CP-ERROR-IN-AMOUNTS                     VALUE '1'.        CL**2
   529       88  CP-ERROR-IN-DATES                       VALUE '2'.        CL**2
   530       88  CP-ERROR-IN-OPTIONS                     VALUE '3'.        CL**2
   531       88  CP-ERROR-IN-TERMS                       VALUE '4'.        CL**2
   532       88  CP-ERROR-IN-FREQUENCY                   VALUE '5'.        CL**2
   533       88  CP-ERROR-RATE-NOT-FOUND                 VALUE '6'.        CL**2
   534       88  CP-ERROR-RATE-IS-ZERO                   VALUE '7'.        CL**2
   535       88  CP-ERROR-AMT-OUTSIDE-LIMIT              VALUE '8'.        CL**2
   536       88  CP-ERROR-TERM-OUTSIDE-LIMIT             VALUE '9'.        CL**2
   537       88  CP-ERROR-AGE-OUTSIDE-LIMIT              VALUE 'A'.        CL**2
   538       88  CP-ERROR-ATT-OUTSIDE-LIMIT              VALUE 'B'.        CL**2
   539       88  CP-ERROR-TOT-OUTSIDE-LIMIT              VALUE 'C'.        CL**2
   540       88  CP-ERROR-RATE-FILE-NOTOPEN              VALUE 'D'.        CL**2
   541       88  CP-ERROR-ISSUE-AGE-ZERO                 VALUE 'E'.        CL**2
   542       88  CP-ERROR-NO-LIMITS-CRI                  VALUE 'F'.        CL**2
   543       88  CP-ERROR-DIV-BY-ZERO                    VALUE 'G'.        CL**2
   544       88  CP-ERROR-LOAN-TERM                      VALUE 'H'.        CL**2
   545                                                                     CL**2
   546     12  CP-RETURN-CODE-2          PIC X             VALUE ZERO.     CL**2
   547       88  NO-CP-ERROR-2                           VALUE ZERO.       CL**2
   548***********************  INPUT AREAS ****************************    CL**2
   549                                                                     CL**2
   550     12  CP-CALCULATION-AREA.                                        CL**2
   551         16  CP-ACCOUNT-NUMBER     PIC X(10)       VALUE SPACES.     CL**2
   552         16  CP-CERT-EFF-DT        PIC XX.                           CL**2
   553         16  CP-VALUATION-DT       PIC XX.                           CL**2
   554         16  CP-PAID-THRU-DT       PIC XX.                           CL**2
   555         16  CP-BENEFIT-TYPE       PIC X.                            CL**2
   556           88  CP-AH                               VALUE 'A' 'D'     CL**2
   557                                                   'I' 'U'.          CL**2
   558           88  CP-REDUCING-LIFE                    VALUE 'R'.        CL**2
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  13
* SUNPRMX.cbl (/apps/prod/cid1p/copy/ELCCALC)
   559           88  CP-LEVEL-LIFE                       VALUE 'L' 'P'.    CL**2
   560         16  CP-INCURRED-DT        PIC XX.                           CL**2
   561         16  CP-REPORTED-DT        PIC XX.                           CL**2
   562         16  CP-ACCT-FLD-5         PIC XX            VALUE SPACE.    CL**2
   563         16  CP-COMPANY-ID         PIC XXX           VALUE SPACE.    CL**2
   564         16  CP-ISSUE-AGE          PIC S9(3)         VALUE ZERO      CL**2
   565                                     COMP-3.                         CL**2
   566         16  CP-CDT-PERCENT        PIC S9(3)V99      VALUE ZERO      CL**2
   567                                     COMP-3.                         CL**2
   568         16  CP-CDT-METHOD         PIC X.                            CL**2
   569           88  CP-CDT-ROUND-NEAR                   VALUE '1'.        CL**2
   570           88  CP-CDT-ROUND-HIGH                   VALUE '2'.        CL**2
   571           88  CP-CDT-INTERPOLATED                 VALUE '3'.        CL**2
   572         16  CP-CLAIM-TYPE         PIC X.                            CL**2
   573           88  CP-AH-CLAIM                         VALUE 'A'.        CL**2
   574           88  CP-LIFE-CLAIM                       VALUE 'L'.        CL**2
   575         16  CP-ORIGINAL-TERM      PIC S9(3)         VALUE ZERO      CL**2
   576                                     COMP-3.                         CL**2
   577         16  CP-ORIGINAL-BENEFIT   PIC S9(9)V99      VALUE ZERO      CL**2
   578                                     COMP-3.                         CL**2
   579         16  CP-ORIGINAL-PREMIUM   PIC S9(7)V99      VALUE ZERO      CL**2
   580                                     COMP-3.                         CL**2
   581         16  CP-REMAINING-TERM     PIC S9(3)V99      VALUE ZERO      CL**2
   582                                     COMP-3.                         CL**2
   583         16  CP-REMAINING-BENEFIT  PIC S9(9)V99      VALUE ZERO      CL**2
   584                                     COMP-3.                         CL**2
   585         16  CP-LOAN-APR           PIC S9(3)V9(4)    VALUE ZERO      CL**2
   586                                     COMP-3.                         CL**2
   587         16  CP-PAY-FREQUENCY      PIC S9(3)         VALUE ZERO      CL**2
   588                                     COMP-3.                         CL**2
   589         16  CP-REM-TERM-METHOD    PIC X.                            CL**2
   590           88  CP-EARN-AFTER-15TH                  VALUE '1'.        CL**2
   591           88  CP-EARN-ON-HALF-MONTH               VALUE '2'.        CL**2
   592           88  CP-EARN-ON-1ST-DAY                  VALUE '3'.        CL**2
   593           88  CP-EARN-ON-FULL-MONTH               VALUE '4'.        CL**2
   594           88  CP-EARN-WITH-NO-DAYS                VALUE '5'.        CL**2
   595           88  CP-EARN-AFTER-14TH                  VALUE '6'.        CL**2
   596           88  CP-EARN-AFTER-16TH                  VALUE '7'.        CL**2
   597         16  CP-EARNING-METHOD     PIC X.                            CL**2
   598           88  CP-EARN-BY-R78                      VALUE '1' 'R'.    CL**2
   599           88  CP-EARN-BY-PRORATA                  VALUE '2' 'P'.    CL**2
   600           88  CP-EARN-AS-CALIF                    VALUE '3' 'C'.    CL**2
   601           88  CP-EARN-AS-TEXAS                    VALUE '4' 'T'.    CL**2
   602           88  CP-EARN-AS-FARM-PLAN                VALUE '4' 'T'.    CL**2
   603           88  CP-EARN-AS-NET-PAY                  VALUE '5' 'N'.    CL**2
   604           88  CP-EARN-ANTICIPATION                VALUE '6' 'A'.    CL**2
   605           88  CP-EARN-AS-MEAN                     VALUE '8' 'M'.    CL**2
   606           88  CP-EARN-AS-SUM-OF-DIGITS            VALUE '9'.        CL**2
   607           88  CP-EARN-AS-REG-BALLOON              VALUE 'B'.        CL**2
   608           88  CP-GAP-NON-REFUNDABLE               VALUE 'G'.
   609           88  CP-GAP-ACTUARIAL                    VALUE 'S'.
   610           88  CP-DCC-SPP-DDF                      VALUE 'D' 'I'.
   611           88  CP-DCC-SPP-DDF-IU                   VALUE 'I'.
   612         16  CP-PROCESS-TYPE       PIC X.                            CL**2
   613           88  CP-CLAIM                            VALUE '1'.        CL**2
   614           88  CP-CANCEL                           VALUE '2'.        CL**2
   615           88  CP-ISSUE                            VALUE '3'.        CL**2
   616         16  CP-SPECIAL-CALC-CD    PIC X.                            CL**2
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  14
* SUNPRMX.cbl (/apps/prod/cid1p/copy/ELCCALC)
   617           88  CP-OUTSTANDING-BAL              VALUE 'O'.            CL**2
   618           88  CP-1-MTH-INTEREST               VALUE ' '.            CL**2
   619           88  CP-0-MTH-INTEREST               VALUE 'A'.            CL**2
   620           88  CP-OB-OFFLINE-RESERVED          VALUE 'B'.            CL**2
   621           88  CP-CRITICAL-PERIOD              VALUE 'C'.            CL**2
   622           88  CP-TERM-IS-DAYS                 VALUE 'D'.            CL**2
   623           88  CP-USE-PREM-AS-ENTERED          VALUE 'E'.            CL**2
   624           88  CP-FARM-PLAN                    VALUE 'F'.            CL**2
   625           88  CP-RATE-AS-STANDARD             VALUE 'G'.            CL**2
   626           88  CP-2-MTH-INTEREST               VALUE 'I'.            CL**2
   627           88  CP-3-MTH-INTEREST               VALUE 'J'.            CL**2
   628           88  CP-4-MTH-INTEREST               VALUE 'K'.            CL**2
   629           88  CP-BALLOON-LAST-PMT             VALUE 'L'.            CL**2
   630           88  CP-MORTGAGE-REC                 VALUE 'M'.            CL**2
   631           88  CP-OUTSTANDING-BALANCE          VALUE 'O'.            CL**2
   632           88  CP-NET-PAY-PRUDENTIAL           VALUE 'P'.            CL**2
   633           88  CP-NET-PAY-SIMPLE               VALUE 'S'.            CL**2
   634           88  CP-TRUNCATED-LIFE               VALUE 'T' 'U' 'V'     CL**2
   635                                                     'W' 'X'.        CL**2
   636           88  CP-TRUNCATE-0-MTH               VALUE 'T'.            CL**2
   637           88  CP-TRUNCATE-1-MTH               VALUE 'U'.            CL**2
   638           88  CP-TRUNCATE-2-MTH               VALUE 'V'.            CL**2
   639           88  CP-TRUNCATE-3-MTH               VALUE 'W'.            CL**2
   640           88  CP-TRUNCATE-4-MTH               VALUE 'X'.            CL**2
   641           88  CP-SUMMARY-REC                  VALUE 'Z'.            CL**2
   642           88  CP-PROPERTY-BENEFIT             VALUE '2'.            CL**2
   643           88  CP-UNEMPLOYMENT-BENEFIT         VALUE '3'.            CL**2
   644           88  CP-AD-D-BENEFIT                 VALUE '4'.            CL**2
   645           88  CP-CSL-METH-1                   VALUE '5'.            CL**2
   646           88  CP-CSL-METH-2                   VALUE '6'.            CL**2
   647           88  CP-CSL-METH-3                   VALUE '7'.            CL**2
   648           88  CP-CSL-METH-4                   VALUE '8'.            CL**2
   649                                                                     CL**2
   650         16  CP-LOAN-TERM          PIC S9(3)       VALUE ZERO        CL**2
   651                                     COMP-3.                         CL**2
   652         16  CP-CLASS-CODE         PIC XX          VALUE ZERO.       CL**2
   653         16  CP-DEVIATION-CODE     PIC XXX         VALUE ZERO.       CL**2
   654         16  CP-STATE              PIC XX          VALUE SPACE.      CL**2
   655         16  CP-STATE-STD-ABBRV    PIC XX          VALUE SPACE.      CL**2
   656         16  CP-BENEFIT-CD         PIC XX          VALUE ZERO.       CL**2
   657           88  CP-CSL-VALID-NP-BENEFIT-CD VALUES '12' '13'           CL**2
   658               '34' '35' '36' '37' '44' '45' '46' '47' '72' '73'.    CL**2
   659         16  CP-R78-OPTION         PIC X.                            CL**2
   660           88  CP-TERM-TIMES-TERM-PLUS-1           VALUE ' '.        CL**2
   661           88  CP-TERM-TIMES-TERM                  VALUE '1'.        CL**2
   662                                                                     CL**2
   663         16  CP-COMPANY-CD         PIC X             VALUE SPACE.    CL**2
   664         16  CP-IBNR-RESERVE-SW    PIC X.                            CL**2
   665         16  CP-CLAIM-STATUS       PIC X.                            CL**2
   666         16  CP-RATE-FILE          PIC X.                            CL**2
   667         16  CP-TERM-OR-EXT-DAYS   PIC S9(05)        VALUE ZERO      CL**2
   668                                     COMP-3.                         CL**2
   669                                                                     CL**2
   670         16  CP-LIFE-OVERRIDE-CODE PIC X.                            CL**2
   671         16  CP-AH-OVERRIDE-CODE   PIC X.                            CL**2
   672                                                                     CL**2
   673         16  CP-RATE-DEV-PCT       PIC S9V9(6)       VALUE ZERO      CL**2
   674                                     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  15
* SUNPRMX.cbl (/apps/prod/cid1p/copy/ELCCALC)
   675         16  CP-CLP-RATE-UP        REDEFINES CP-RATE-DEV-PCT
   676                                   PIC S9(5)V99 COMP-3.
   677         16  CP-CRITICAL-MONTHS    PIC S9(3)         VALUE ZERO      CL**2
   678                                     COMP-3.                         CL**2
   679         16  CP-ALTERNATE-BENEFIT  PIC S9(9)V99      VALUE ZERO      CL**2
   680                                     COMP-3.                         CL**2
   681         16  CP-ALTERNATE-PREMIUM  PIC S9(7)V99      VALUE ZERO      CL**2
   682                                     COMP-3.
   683         16  CP-DDF-CSO-ADMIN-FEE REDEFINES CP-ALTERNATE-PREMIUM
   684                                  PIC S9(7)V99 COMP-3.
   685                                                                     CL**2
   686         16  CP-PAID-FROM-DATE     PIC X(02).                        CL**2
   687         16  CP-CLAIM-CALC-METHOD  PIC X(01).                        CL**2
   688         16  CP-EXT-DAYS-CALC      PIC X.                            CL**2
   689           88  CP-EXT-NO-CHG                   VALUE ' '.            CL**2
   690           88  CP-EXT-CHG-LF                   VALUE '1'.            CL**2
   691           88  CP-EXT-CHG-AH                   VALUE '2'.            CL**2
   692           88  CP-EXT-CHG-LF-AH                VALUE '3'.            CL**2
   693         16  CP-DOMICILE-STATE     PIC XX.                           CL**2
   694         16  CP-CARRIER            PIC X.                            CL**2
   695         16  CP-REIN-FLAG          PIC X.                            CL**2
   696         16  CP-REM-TRM-CALC-OPTION PIC X.                           CL**2
   697           88  VALID-REM-TRM-CALC-OPTION    VALUE '1'                CL**2
   698                      '2' '3' '4' '5'.                               CL**2
   699           88  CP-CALC-OPTION-DEFAULT       VALUE '4'.               CL**2
   700           88  CP-CONSIDER-EXTENSION        VALUE '3' '4' '5'.       CL**2
   701           88  CP-30-DAY-MONTH              VALUE '1' '3' '5'.       CL**2
   702           88  CP-NO-EXT-30-DAY-MONTH       VALUE '1'.               CL**2
   703           88  CP-NO-EXT-ACTUAL-DAYS        VALUE '2'.               CL**2
   704           88  CP-EXT-30-DAY-MONTH          VALUE '3'.               CL**2
   705           88  CP-EXT-ACTUAL-DAYS           VALUE '4'.               CL**2
   706           88  CP-USE-EXP-AND-1ST-PMT       VALUE '5'.
   707         16  CP-SIG-SWITCH         PIC X.                            CL**2
   708         16  CP-RATING-METHOD      PIC X.                            CL**2
   709           88  CP-RATE-AS-R78                      VALUE '1' 'R'.    CL**2
   710           88  CP-RATE-AS-PRORATA                  VALUE '2' 'P'.    CL**2
   711           88  CP-RATE-AS-CALIF                    VALUE '3' 'C'.    CL**2
   712           88  CP-RATE-AS-TEXAS                    VALUE '4' 'T'.    CL**2
   713           88  CP-RATE-AS-FARM-PLAN                VALUE '4' 'T'.    CL**2
   714           88  CP-RATE-AS-NET-PAY                  VALUE '5' 'N'.    CL**2
   715           88  CP-RATE-AS-ANTICIPATION             VALUE '6' 'A'.    CL**2
   716           88  CP-RATE-AS-MEAN                     VALUE '8' 'M'.    CL**2
   717           88  CP-RATE-AS-REG-BALLOON              VALUE 'B'.        CL**2
   718         16  CP-SALES-TAX          PIC S9V9999     VALUE  ZEROS      CL**2
   719                                     COMP-3.                         CL**2
   720         16  CP-BEN-CATEGORY       PIC X.
   721         16  CP-DCC-LF-RATE        PIC S99V9(5) COMP-3 VALUE +0.
   722         16  CP-DCC-ACT-COMM REDEFINES CP-DCC-LF-RATE
   723                                   PIC S99V9(5) COMP-3.
   724         16  CP-DCC-AH-RATE        PIC S99V9(5) COMP-3 VALUE +0.
   725         16  CP-DCC-PMF-COMM REDEFINES CP-DCC-AH-RATE
   726                                   PIC S99V9(5) COMP-3.
   727         16  CP-DAYS-TO-1ST-PMT    PIC S999     COMP-3 VALUE +0.
   728         16  CP-AH-BALLOON-SW      PIC X  VALUE ' '.
   729         16  CP-EXPIRE-DT          PIC XX.
   730         16  CP-LF-CLAIM-CALC-SW   PIC X  VALUE ' '.
   731         16  CP-DDF-HI-FACT        PIC S9V999   COMP-3 VALUE +0.
   732         16  CP-DDF-LO-FACT        PIC S9V999   COMP-3 VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  16
* SUNPRMX.cbl (/apps/prod/cid1p/copy/ELCCALC)
   733         16  CP-DDF-CLP            PIC S9(5)V99 COMP-3 VALUE +0.
   734         16  CP-DDF-SPEC-CALC      PIC X.
   735             88  CP-CALC-GROSS-FEE        VALUE 'G'.
   736             88  CP-CALC-CLP              VALUE 'C'.
   737         16  CP-IU-RATE-UP         PIC S9(5)V99   COMP-3 VALUE +0.
   738         16  CP-CANCEL-REASON      PIC X.
   739         16  CP-DDF-ADMIN-FEES     PIC S9(5)V99 COMP-3 VALUE +0.
   740         16  CP-PMT-MODE           PIC X.
   741         16  CP-NO-OF-PMTS         PIC S999 COMP-3 VALUE +0.
   742         16  CP-1ST-YR-ALLOW       PIC S999V99 COMP-3 VALUE +0.
   743         16  CP-DDF-COMM-AND-MFEE  PIC S9(5)V99 COMP-3 VALUE +0.
   744         16  CP-DDF-YR1AF          PIC S9(5)V99 COMP-3 VALUE +0.
   745         16  FILLER                PIC X.
   746                                                                     CL**2
   747***************    OUTPUT FROM ELRESV   ************************     CL**2
   748                                                                     CL**2
   749         16  CP-CDT-TABLE          PIC 9             VALUE ZERO.     CL**2
   750                                                                     CL**2
   751         16  CP-CDT-FACTOR         PIC S9(5)V9(6)    VALUE ZERO      CL**2
   752                                     COMP-3.                         CL**2
   753         16  CP-PTC-RESERVE        PIC S9(7)V99   VALUE ZERO         CL**2
   754                                     COMP-3.                         CL**2
   755         16  CP-IBNR-RESERVE       PIC S9(7)V99   VALUE ZERO         CL**2
   756                                     COMP-3.                         CL**2
   757         16  CP-FUTURE-RESERVE     PIC S9(7)V99   VALUE ZERO         CL**2
   758                                     COMP-3.                         CL**2
   759         16  FILLER                PIC X(09).                        CL**2
   760***************    OUTPUT FROM ELRTRM   *************************    CL**2
   761                                                                     CL**2
   762         16  CP-REMAINING-TERM-1   PIC S9(4)V9    VALUE ZERO         CL**2
   763                                     COMP-3.                         CL**2
   764         16  CP-REMAINING-TERM-2   PIC S9(4)V9    VALUE ZERO         CL**2
   765                                     COMP-3.                         CL**2
   766         16  CP-REMAINING-TERM-3   PIC S9(4)V9    VALUE ZERO         CL**2
   767                                     COMP-3.                         CL**2
   768         16  CP-ODD-DAYS           PIC S9(3)      VALUE ZERO         CL**2
   769                                     COMP-3.                         CL**2
   770         16  FILLER                PIC X(12).                        CL**2
   771                                                                     CL**2
   772***************    OUTPUT FROM ELRAMT   *************************    CL**2
   773                                                                     CL**2
   774         16  CP-REMAINING-AMT      PIC S9(9)V99   VALUE ZERO         CL**2
   775                                     COMP-3.                         CL**2
   776         16  CP-REMAINING-AMT-PRV  PIC S9(9)V99   VALUE ZERO         CL**2
   777                                     COMP-3.                         CL**2
   778         16  FILLER                PIC X(12).                        CL**2
   779                                                                     CL**2
   780***************    OUTPUT FROM ELRATE   *************************    CL**2
   781                                                                     CL**2
   782         16  CP-CALC-PREMIUM       PIC S9(7)V99   VALUE ZERO         CL**2
   783                                     COMP-3.                         CL**2
   784         16  CP-PREMIUM-RATE       PIC S9(2)V9(5) VALUE ZERO         CL**2
   785                                     COMP-3.                         CL**2
   786         16  CP-MORTALITY-CODE     PIC X(4).                         CL**2
   787         16  CP-RATE-EDIT-FLAG     PIC X.                            CL**2
   788             88  CP-RATES-NEED-APR                  VALUE '1'.       CL**2
   789         16  CP-COMPOSITE-RATE     PIC S99V999    VALUE ZERO         CL**2
   790                                     COMP-3.                         CL**2
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  17
* SUNPRMX.cbl (/apps/prod/cid1p/copy/ELCCALC)
   791         16  CP-POLICY-FEE         PIC S9(3)V99 VALUE +0 COMP-3.     CL**2
   792         16  CP-LF-PREM            PIC S9(7)V99 VALUE +0 COMP-3.
   793         16  CP-LF-BALLOON-PREM REDEFINES CP-LF-PREM
   794                                   PIC S9(7)V99 COMP-3.
   795         16  FILLER                PIC X(07).                        CL**2
   796                                                                     CL**2
   797***************    OUTPUT FROM ELRFND   *************************    CL**2
   798                                                                     CL**2
   799         16  CP-CALC-REFUND        PIC S9(7)V99   VALUE ZERO         CL**2
   800                                     COMP-3.                         CL**2
   801         16  CP-REFUND-TYPE-USED   PIC X.                            CL**2
   802           88  CP-R-AS-R78                         VALUE '1'.        CL**2
   803           88  CP-R-AS-PRORATA                     VALUE '2'.        CL**2
   804           88  CP-R-AS-CALIF                       VALUE '3'.        CL**2
   805           88  CP-R-AS-TEXAS                       VALUE '4'.        CL**2
   806           88  CP-R-AS-FARM-PLAN                   VALUE '4'.        CL**2
   807           88  CP-R-AS-NET-PAY                     VALUE '5'.        CL**2
   808           88  CP-R-AS-ANTICIPATION                VALUE '6'.        CL**2
   809           88  CP-R-AS-MEAN                        VALUE '8'.        CL**2
   810           88  CP-R-AS-SUM-OF-DIGITS               VALUE '9'.        CL**2
   811           88  CP-R-AS-GAP-NON-REFUND              VALUE 'G'.
   812           88  CP-R-AS-GAP-ACTUARIAL               VALUE 'S'.
   813           88  CP-R-AS-SPP-DDF                     VALUE 'D'.
   814           88  CP-R-AS-SPP-DDF-IU                  VALUE 'I'.
   815           88  CP-R-AS-REPOSSESSION                VALUE 'R'.
   816         16  FILLER                PIC X(12).                        CL**2
   817                                                                     CL**2
   818***************    OUTPUT FROM ELEARN   *************************    CL**2
   819                                                                     CL**2
   820         16  CP-R78-U-PRM          PIC S9(7)V99   VALUE ZERO         CL**2
   821                                     COMP-3.                         CL**2
   822         16  CP-R78-U-PRM-ALT      PIC S9(7)V99   VALUE ZERO         CL**2
   823                                     COMP-3.                         CL**2
   824         16  CP-PRORATA-U-PRM      PIC S9(7)V99   VALUE ZERO         CL**2
   825                                     COMP-3.                         CL**2
   826         16  CP-PRORATA-U-PRM-ALT  PIC S9(7)V99   VALUE ZERO         CL**2
   827                                     COMP-3.                         CL**2
   828         16  CP-STATE-U-PRM        PIC S9(7)V99   VALUE ZERO         CL**2
   829                                     COMP-3.                         CL**2
   830         16  CP-DOMICILE-U-PRM     PIC S9(7)V99   VALUE ZERO         CL**2
   831                                     COMP-3.                         CL**2
   832         16  CP-EARNING-TYPE-USED  PIC X.                            CL**2
   833           88  CP-E-AS-SPECIAL                     VALUE 'S'.        CL**2
   834           88  CP-E-AS-R78                         VALUE '1'.        CL**2
   835           88  CP-E-AS-PRORATA                     VALUE '2'.        CL**2
   836           88  CP-E-AS-TEXAS                       VALUE '4'.        CL**2
   837           88  CP-E-AS-FARM-PLAN                   VALUE '4'.        CL**2
   838           88  CP-E-AS-NET-PAY                     VALUE '5'.        CL**2
   839           88  CP-E-AS-ANTICIPATION                VALUE '6'.        CL**2
   840           88  CP-E-AS-MEAN                        VALUE '8'.        CL**2
   841           88  CP-E-AS-SUM-OF-DIGITS               VALUE '9'.        CL**2
   842         16  FILLER                PIC X(12).                        CL**2
   843                                                                     CL**2
   844***************    OUTPUT FROM ELPMNT   *************************    CL**2
   845                                                                     CL**2
   846         16  CP-ACTUAL-DAYS        PIC S9(05)     VALUE ZERO         CL**2
   847                                     COMP-3.                         CL**2
   848         16  CP-CLAIM-PAYMENT      PIC S9(7)V99   VALUE ZERO         CL**2
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  18
* SUNPRMX.cbl (/apps/prod/cid1p/copy/ELCCALC)
   849                                     COMP-3.                         CL**2
   850         16  FILLER                PIC X(12).                        CL**2
   851                                                                     CL**2
   852***************   MISC WORK AREAS    *****************************   CL**2
   853         16  CP-TOTAL-PAID         PIC S9(7)V99   VALUE ZERO         CL**2
   854                                     COMP-3.                         CL**2
   855         16  CP-R-MAX-ATT-AGE      PIC S9(3)      VALUE ZERO         CL**2
   856                                     COMP-3.                         CL**2
   857         16  CP-R-MAX-AGE          PIC S9(3)      VALUE ZERO         CL**2
   858                                     COMP-3.                         CL**2
   859         16  CP-R-MAX-TERM         PIC S9(5)      VALUE ZERO         CL**2
   860                                     COMP-3.                         CL**2
   861         16  CP-R-MAX-TOT-BEN      PIC S9(7)V99   VALUE ZERO         CL**2
   862                                     COMP-3.                         CL**2
   863         16  CP-R-MAX-MON-BEN      PIC S9(7)V99   VALUE ZERO         CL**2
   864                                     COMP-3.                         CL**2
   865         16  CP-IO-FUNCTION        PIC X          VALUE SPACE.       CL**2
   866             88  OPEN-RATE-FILE                   VALUE 'O'.         CL**2
   867             88  CLOSE-RATE-FILE                  VALUE 'C'.         CL**2
   868             88  IO-ERROR                         VALUE 'E'.         CL**2
   869                                                                     CL**2
   870         16  CP-FIRST-PAY-DATE     PIC XX.                           CL**2
   871                                                                     CL**2
   872         16  CP-JOINT-INDICATOR    PIC X.                            CL**2
   873                                                                     CL**2
   874         16  CP-RESERVE-REMAINING-TERM                               CL**2
   875                                   PIC S9(4)V9    VALUE ZERO         CL**2
   876                                     COMP-3.                         CL**2
   877                                                                     CL**2
   878         16  CP-INSURED-BIRTH-DT   PIC XX.                           CL**2
   879                                                                     CL**2
   880         16  CP-INCURRED-AGE       PIC S9(3)      VALUE ZERO         CL**2
   881                                     COMP-3.                         CL**2
   882                                                                     CL**2
   883         16  CP-MONTHLY-PAYMENT    PIC S9(5)V99   VALUE ZERO         CL**2
   884                                     COMP-3.                         CL**2
   885                                                                     CL**2
   886         16  CP-RATING-BENEFIT-AMT PIC S9(9)V99   VALUE ZERO         CL**2
   887                                     COMP-3.                         CL**2
   888                                                                     CL**2
   889         16  CP-ODD-DAYS-TO-PMT    PIC S9(3)      VALUE ZERO         CL**2
   890                                     COMP-3.                         CL**2
   891                                                                     CL**2
   892         16  CP-MNTHS-TO-FIRST-PMT PIC S9(3)      VALUE ZERO         CL**2
   893                                     COMP-3.                         CL**2
   894                                                                     CL**2
   895         16  CP-REMAMT-FACTOR      PIC S9(4)V9(9) VALUE ZEROS        CL**2
   896                                     COMP-3.                         CL**2
   897                                                                     CL**2
   898         16  CP-FREE-LOOK          PIC S9(3)      VALUE ZERO         CL**2
   899                                     COMP-3.                         CL**2
   900                                                                     CL**2
   901         16  CP-ROA-REFUND         PIC X          VALUE 'N'.         CL**2
   902             88  CP-ROA-PREM-AT-REFUND            VALUE 'Y'.         CL**2
   903                                                                     CL**2
   904         16  CP-NET-BENEFIT-AMT    PIC S9(9)V99   VALUE ZERO         CL**2
   905                                     COMP-3.                         CL**2
   906         16  CP-SCNP-6MO-AMT       PIC S9(9)V99   VALUE ZERO
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  19
* SUNPRMX.cbl (/apps/prod/cid1p/copy/ELCCALC)
   907                                     COMP-3.
   908         16  CP-MONTH              PIC S999     COMP-3 VALUE +0.
   909         16  cp-extra-periods      pic 9 value zeros.
   910         16  cp-net-only-state     pic x value spaces.
   911         16  FILLER                PIC X(13).                        CL**2
   912******************************************************************   CL**2
   913
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  20
* SUNPRMX.cbl
   915 PROCEDURE DIVISION  USING CALCULATION-PASS-AREA.
   916
   917 0000-START-UNEARNED-CALC.
*  918                       COPY SUNUPRMP.
   919****************************************************************
   920*                                                              *
   921*                            ELCUPRMP.                         *
   922*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   923*                            VMOD=2.009                        *
   924*                                                              *
   925****************************************************************.
   926
   927
   928     MOVE ZERO                   TO  CP-RETURN-CODE
   929                                     CP-R78-U-PRM
   930                                     CP-R78-U-PRM-ALT
   931                                     CP-PRORATA-U-PRM
   932                                     CP-PRORATA-U-PRM-ALT
   933                                     CP-STATE-U-PRM
   934                                     CP-DOMICILE-U-PRM
   935                                     PR-UN-PREMIUM
   936                                     PR-UN-PREM-ALT
   937                                     STATE-UN-PREMIUM
   938                                     DOMI-UN-PREMIUM
   939                                     R78-UN-PREMIUM
   940                                     R78-UN-PREM-ALT.
   941
   942
   943 0001-GET-EFFECTIVE-DATE.
   944
   945     MOVE CP-CERT-EFF-DT     TO DC-BIN-DATE-1.
   946     MOVE SPACE              TO DC-OPTION-CODE.
   947     PERFORM 9100-CONVERT-DATE THRU 9100-EXIT.
   948
   949     IF DATE-CONVERSION-ERROR
   950          DISPLAY 'BAD RET  '
   951         MOVE '2' TO CP-RETURN-CODE
   952          GO TO 1999-EXIT-CALC-ROUTINE.
   953
   954     IF CP-ORIGINAL-TERM EQUAL 0
   955         MOVE '1'           TO CP-RETURN-CODE
   956          GO TO 1999-EXIT-CALC-ROUTINE.
   957
   958     IF CP-AH
   959         PERFORM 1500-CALC-UNEARNED-AH THRU
   960                               1500-CALC-UNEARNED-X
   961     ELSE
   962         PERFORM 1000-CALC-UNEARNED-LIFE THRU
   963                               1000-CALC-UNEARNED-X.
   964
   965     GO TO 1999-EXIT-CALC-ROUTINE.
   966
   967 0009-EXIT.
   968     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  21
* SUNPRMX.cbl (/apps/prod/cid1p/copy/SUNUPRMP)
   970******************** UNEARNED LIFE PREMIUM ***********************
   971 1000-CALC-UNEARNED-LIFE SECTION.
   972
   973     IF CP-SPECIAL-CALC-CD EQUAL 'G'
   974         MOVE 'N' TO CP-EARNING-METHOD.
   975
   976     IF CP-TERM-OR-EXT-DAYS NOT NUMERIC
   977         MOVE +0                TO CP-TERM-OR-EXT-DAYS.
   978
   979     IF CP-LOAN-TERM NOT NUMERIC
   980         MOVE +0                TO CP-LOAN-TERM.
   981
   982     IF CP-EARNING-METHOD EQUAL 'T'
   983         PERFORM 1160-CALC-TEXAS-UN   THRU 1160-EXIT
   984         GO TO 1000-CALC-UNEARNED-X1.
   985
   986     PERFORM 1100-LIFE-PRORATA-UNEARNED THRU 1111-EXIT.
   987     PERFORM 1120-LIFE-RULE78S-UNEARNED THRU 1120-EXIT.
   988
   989     IF CP-COMPANY-ID EQUAL 'NCL'
   990        IF CP-EARN-AS-REG-BALLOON
   991           IF CP-SPECIAL-CALC-CD EQUAL 'A'
   992              PERFORM 1180-CALC-NET-PAY-UN THRU 1180-EXIT
   993              GO TO 1000-DO-STATE-DOM-REGS.
   994
   995     IF (CP-EARNING-METHOD = 'B' OR 'K' OR 'L')
   996         GO TO 1000-DO-STATE-DOM-REGS.
   997
   998     IF CP-COMPANY-ID = 'NCL'
   999         IF DC-GREG-DATE-CYMD LESS THAN 19910101
  1000             MOVE ZEROS           TO CP-LOAN-APR
  1001             IF CP-EARN-AS-NET-PAY
  1002                 MOVE 'R'         TO CP-EARNING-METHOD.
  1003
  1004     IF CP-BENEFIT-CD     EQUAL 'QD'
  1005       MOVE 'N' TO CP-EARNING-METHOD
  1006       MOVE +15.0 TO N-P-APR
  1007         PERFORM 1180-CALC-NET-PAY-UN THRU 1180-EXIT
  1008         GO TO 1000-DO-STATE-DOM-REGS.
  1009
  1010     IF CP-EARNING-METHOD EQUAL 'N'
  1011         PERFORM 1180-CALC-NET-PAY-UN THRU 1180-EXIT
  1012         GO TO 1000-DO-STATE-DOM-REGS.
  1013
  1014     IF CP-STATE-STD-ABBRV = 'OH'
  1015         IF (CP-ORIGINAL-TERM GREATER THAN +60) AND
  1016            (CP-CLASS-CODE NOT = 'L ')           AND
  1017            (DC-GREG-DATE-CYMD GREATER 19831031) AND
  1018            (CP-LOAN-APR GREATER THAN ZERO)
  1019            PERFORM 1180-CALC-NET-PAY-UN THRU 1180-EXIT.
  1020
  1021     IF CP-STATE-STD-ABBRV = 'MT'
  1022         IF (CP-ORIGINAL-TERM GREATER THAN +61) AND
  1023            (DC-GREG-DATE-CYMD GREATER 19830318) AND
  1024            (CP-LOAN-APR GREATER THAN ZERO)
  1025            PERFORM 1180-CALC-NET-PAY-UN THRU 1180-EXIT.
  1026
  1027     IF CP-STATE-STD-ABBRV = 'UT'
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  22
* SUNPRMX.cbl (/apps/prod/cid1p/copy/SUNUPRMP)
  1028         IF (CP-ORIGINAL-TERM GREATER THAN +62) AND
  1029            (DC-GREG-DATE-CYMD GREATER 19810831) AND
  1030            (DC-GREG-DATE-CYMD LESS 19830901) AND
  1031            (CP-LOAN-APR GREATER THAN ZERO)
  1032            PERFORM 1180-CALC-NET-PAY-UN THRU 1180-EXIT.
  1033
  1034     IF CP-STATE-STD-ABBRV  = 'RI'
  1035         IF (CP-ORIGINAL-TERM GREATER THAN +60) AND
  1036            (DC-GREG-DATE-CYMD GREATER 19831231) AND
  1037            (CP-LOAN-APR GREATER THAN ZERO)
  1038             PERFORM 1180-CALC-NET-PAY-UN THRU 1180-EXIT.
  1039
  1040 1000-DO-STATE-DOM-REGS.
  1041
  1042     PERFORM 1200-DO-STATE-REGS    THRU 1200-EXIT.
  1043     PERFORM 1300-DO-DOMICILE      THRU 1300-EXIT.
  1044
  1045 1000-CALC-UNEARNED-X1.
  1046
  1047     MOVE DOMI-UN-PREMIUM         TO CP-DOMICILE-U-PRM.
  1048     MOVE STATE-UN-PREMIUM        TO CP-STATE-U-PRM.
  1049     MOVE PR-UN-PREMIUM           TO CP-PRORATA-U-PRM.
  1050     MOVE PR-UN-PREM-ALT          TO CP-PRORATA-U-PRM-ALT.
  1051     MOVE R78-UN-PREMIUM          TO CP-R78-U-PRM.
  1052     MOVE R78-UN-PREM-ALT         TO CP-R78-U-PRM-ALT.
  1053
  1054 1000-CALC-UNEARNED-X.
  1055*---------------------------------------------------------------
  1056     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  23
* SUNPRMX.cbl (/apps/prod/cid1p/copy/SUNUPRMP)
  1058*********************************************
  1059*                                           *
  1060* PERFORMED: LIFE UNEARNED PREMIUM ROUTINES *
  1061*                                           *
  1062*********************************************
  1063
  1064 1100-LIFE-PRORATA-UNEARNED.
  1065
  1066     IF CP-COMPANY-ID EQUAL 'FLI' OR 'FLU' OR 'MIC' OR 'MCC'
  1067         COMPUTE PR-FACTOR ROUNDED =
  1068                   (CP-REMAINING-TERM - .5) / CP-ORIGINAL-TERM
  1069     ELSE
  1070         COMPUTE PR-FACTOR ROUNDED =
  1071                       CP-REMAINING-TERM / CP-ORIGINAL-TERM.
  1072
  1073     COMPUTE PR-UN-PREMIUM ROUNDED =
  1074                     CP-ORIGINAL-PREMIUM * PR-FACTOR.
  1075
  1076
  1077     IF (CP-EARNING-METHOD NOT = 'B' AND 'K' AND 'L')
  1078         GO TO 1111-EXIT.
  1079
  1080     IF CP-SPECIAL-CALC-CD EQUAL 'L'
  1081         GO TO 1110-ALT-LIFE-PRO-UNEARNED.
  1082
  1083     IF CP-COMPANY-ID EQUAL 'FLI' OR 'FLU' OR 'MIC' OR 'MCC'
  1084         COMPUTE PR-FACTOR  ROUNDED =
  1085               (CP-REMAINING-TERM + .5) / (CP-ORIGINAL-TERM + 1)
  1086     ELSE
  1087         COMPUTE PR-FACTOR  ROUNDED =
  1088              (CP-REMAINING-TERM + 1) / (CP-ORIGINAL-TERM + 1).
  1089
  1090 1110-ALT-LIFE-PRO-UNEARNED.
  1091
  1092     COMPUTE PR-UN-PREM-ALT ROUNDED =
  1093                   CP-ALTERNATE-PREMIUM * PR-FACTOR.
  1094
  1095
  1096     COMPUTE PR-UN-PREMIUM = PR-UN-PREMIUM +
  1097                    PR-UN-PREM-ALT.
  1098
  1099
  1100 1111-EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  24
* SUNPRMX.cbl (/apps/prod/cid1p/copy/SUNUPRMP)
  1102*---------------------------------------------------------------
  1103 1120-LIFE-RULE78S-UNEARNED.
  1104
  1105     COMPUTE R78-TEMP-1 =
  1106                CP-REMAINING-TERM * (CP-REMAINING-TERM + +1).
  1107
  1108     IF CP-R78-OPTION = '1'
  1109         COMPUTE R78-TEMP-1 =
  1110                  CP-REMAINING-TERM * CP-REMAINING-TERM.
  1111
  1112     IF CP-COMPANY-ID = 'FLI'
  1113         COMPUTE R78-TEMP-1 =
  1114                  CP-REMAINING-TERM * CP-REMAINING-TERM.
  1115
  1116     IF CP-COMPANY-ID = 'MPP'
  1117         COMPUTE R78-TEMP-1 =
  1118                 (CP-ORIGINAL-TERM - CP-REMAINING-TERM)
  1119                 * ((CP-ORIGINAL-TERM - CP-REMAINING-TERM) + +1).
  1120
  1121     COMPUTE R78-TEMP-2 =
  1122                  CP-ORIGINAL-TERM * (CP-ORIGINAL-TERM + +1).
  1123
  1124     COMPUTE R78-FACTOR ROUNDED = R78-TEMP-1 / R78-TEMP-2.
  1125
  1126     COMPUTE R78-UN-PREMIUM ROUNDED =
  1127                     CP-ORIGINAL-PREMIUM * R78-FACTOR.
  1128
  1129
  1130
  1131     IF (CP-EARNING-METHOD NOT = 'B' AND 'K' AND 'L')
  1132         GO TO 1120-EXIT.
  1133
  1134     IF CP-SPECIAL-CALC-CD EQUAL 'L'
  1135         GO TO 1120-ALT-LIFE-R78-UNEARNED.
  1136
  1137     IF CP-R78-OPTION = '1' OR CP-COMPANY-ID = 'FLI'
  1138         COMPUTE R78-TEMP-1 =
  1139                (CP-REMAINING-TERM + 1) *
  1140                 (CP-REMAINING-TERM + 1 )
  1141     ELSE
  1142         COMPUTE R78-TEMP-1 =
  1143              (CP-REMAINING-TERM + 1) *
  1144              (CP-REMAINING-TERM + 2).
  1145
  1146     IF CP-COMPANY-ID = 'MPP'
  1147         COMPUTE R78-TEMP-1 =
  1148            ((CP-ORIGINAL-TERM + 1) - (CP-REMAINING-TERM + 1))
  1149           * ((CP-ORIGINAL-TERM + 1) - (CP-REMAINING-TERM + 1)).
  1150
  1151     COMPUTE R78-TEMP-2 =
  1152           (CP-ORIGINAL-TERM + 1) * (CP-ORIGINAL-TERM + 2).
  1153
  1154     COMPUTE R78-FACTOR ROUNDED =
  1155               R78-TEMP-1 / R78-TEMP-2.
  1156
  1157 1120-ALT-LIFE-R78-UNEARNED.
  1158
  1159     COMPUTE R78-UN-PREM-ALT ROUNDED =
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  25
* SUNPRMX.cbl (/apps/prod/cid1p/copy/SUNUPRMP)
  1160             CP-ALTERNATE-PREMIUM * R78-FACTOR.
  1161
  1162
  1163     COMPUTE R78-UN-PREMIUM ROUNDED =
  1164             R78-UN-PREMIUM + R78-UN-PREM-ALT.
  1165
  1166
  1167 1120-EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  26
* SUNPRMX.cbl (/apps/prod/cid1p/copy/SUNUPRMP)
  1169*---------------------------------------------------------------
  1170 1160-CALC-TEXAS-UN.
  1171
  1172     IF CP-PAY-FREQUENCY = ZERO
  1173        MOVE '5'                 TO CP-RETURN-CODE
  1174        GO TO 1160-EXIT.
  1175
  1176     COMPUTE TEX-FACT-4 = (CP-ORIGINAL-TERM * CP-ORIGINAL-TERM) +
  1177         (CP-PAY-FREQUENCY * CP-ORIGINAL-TERM).
  1178
  1179     DIVIDE CP-REMAINING-TERM BY CP-PAY-FREQUENCY
  1180         GIVING TEX-FACT-5
  1181             REMAINDER TEX-FACT-6.
  1182
  1183     COMPUTE TEX-FACT-5 = TEX-FACT-5 * CP-PAY-FREQUENCY.
  1184
  1185     COMPUTE TEX-FACT-7 = (TEX-FACT-5 * TEX-FACT-5) +
  1186         (TEX-FACT-5 * CP-PAY-FREQUENCY) +
  1187         (2 * (TEX-FACT-6 * (TEX-FACT-5 + CP-PAY-FREQUENCY))).
  1188
  1189     COMPUTE TEX-FACT-8 ROUNDED = TEX-FACT-7 / TEX-FACT-4.
  1190
  1191     COMPUTE STATE-UN-PREMIUM ROUNDED =
  1192              CP-ORIGINAL-PREMIUM * TEX-FACT-8.
  1193
  1194     MOVE STATE-UN-PREMIUM       TO  PR-UN-PREMIUM
  1195                                     R78-UN-PREMIUM
  1196                                     DOMI-UN-PREMIUM.
  1197
  1198 1160-EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  27
* SUNPRMX.cbl (/apps/prod/cid1p/copy/SUNUPRMP)
  1200
  1201*---------------------------------------------------------------
  1202 1180-CALC-NET-PAY-UN.
  1203
  1204     IF CP-LOAN-APR = ZERO
  1205        MOVE '5'            TO  CP-EARNING-METHOD
  1206        MOVE ZEROS          TO  DOMI-UN-PREMIUM
  1207        MOVE ZEROS          TO  STATE-UN-PREMIUM
  1208        GO TO 1180-EXIT.
  1209
  1210     MOVE CP-LOAN-APR       TO N-P-APR.
  1211     MOVE CP-ORIGINAL-TERM  TO N-P-ORIG
  1212                               N-P-CAP.
  1213     MOVE CP-REMAINING-TERM TO N-P-REM.
  1214
  1215     IF CP-TRUNCATED-LIFE
  1216        MOVE CP-LOAN-TERM   TO N-P-ORIG.
  1217
  1218     MOVE 'R'               TO N-P-OPT.
  1219
  1220*    ADD 1 TO ELRNETRM-CTR ALLCALL-CTR.
  1221     CALL 'SUNNETRM'
  1222          USING N-P-APR N-P-ORIG N-P-REM N-P-OPT N-P-CAP
  1223           N-P-FACTOR.
  1224
  1225*****PERFORM 10000-NET-TERM THRU 99999-EXIT.
  1226
  1227     COMPUTE STATE-UN-PREMIUM ROUNDED =
  1228                 N-P-FACTOR * CP-ORIGINAL-PREMIUM.
  1229
  1230     MOVE STATE-UN-PREMIUM      TO  DOMI-UN-PREMIUM.
  1231
  1232     IF CP-EARNING-METHOD EQUAL 'B'
  1233        NEXT SENTENCE
  1234     ELSE
  1235        MOVE '5'                TO  CP-EARNING-METHOD.
  1236
  1237 1180-EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  28
* SUNPRMX.cbl (/apps/prod/cid1p/copy/SUNUPRMP)
  1239*---------------------------------------------------------------
  1240 1200-DO-STATE-REGS.
  1241
  1242     IF CP-STATE-STD-ABBRV = 'AL'
  1243         MOVE R78-UN-PREMIUM       TO STATE-UN-PREMIUM
  1244         GO TO 1200-EXIT.
  1245
  1246     IF CP-STATE-STD-ABBRV = 'WY'
  1247         MOVE PR-UN-PREMIUM        TO STATE-UN-PREMIUM
  1248         GO TO 1200-EXIT.
  1249
  1250     IF CP-COMPANY-ID EQUAL 'NCL'
  1251        IF CP-EARN-AS-REG-BALLOON
  1252           IF CP-SPECIAL-CALC-CD EQUAL 'A'
  1253              COMPUTE STATE-UN-PREMIUM EQUAL STATE-UN-PREMIUM +
  1254                                 PR-UN-PREM-ALT
  1255              GO TO 1200-EXIT.
  1256
  1257     IF (CP-EARNING-METHOD = 'B' OR 'K' OR 'L')
  1258         COMPUTE STATE-UN-PREMIUM =
  1259            (R78-UN-PREMIUM  - R78-UN-PREM-ALT) + PR-UN-PREM-ALT
  1260         GO TO 1200-EXIT.
  1261
  1262     IF CP-EARN-AS-NET-PAY
  1263        AND CP-TRUNCATED-LIFE
  1264        AND CP-LOAN-TERM  LESS THAN CP-ORIGINAL-TERM
  1265         GO TO 1200-EXIT.
  1266
  1267     IF CP-EARN-AS-NET-PAY
  1268         IF CP-LOAN-APR NOT = ZEROS
  1269             GO TO 1200-EXIT.
  1270
  1271     IF CP-BENEFIT-TYPE  = 'L' OR 'P'
  1272         MOVE PR-UN-PREMIUM        TO STATE-UN-PREMIUM
  1273     ELSE
  1274         MOVE R78-UN-PREMIUM       TO STATE-UN-PREMIUM.
  1275
  1276 1200-EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  29
* SUNPRMX.cbl (/apps/prod/cid1p/copy/SUNUPRMP)
  1278
  1279*---------------------------------------------------------------
  1280 1300-DO-DOMICILE.
  1281
  1282     IF CP-DOMICILE-STATE = '  '  OR  '00'
  1283         GO TO 1300-EXIT.
  1284
  1285     IF CP-DOMICILE-STATE = 'AL'
  1286         MOVE R78-UN-PREMIUM      TO DOMI-UN-PREMIUM
  1287         GO TO 1300-EXIT.
  1288
  1289     IF CP-DOMICILE-STATE = 'WY'
  1290         MOVE PR-UN-PREMIUM       TO DOMI-UN-PREMIUM
  1291         GO TO 1300-EXIT.
  1292
  1293     IF (CP-EARNING-METHOD = 'B' OR 'K' OR 'L')
  1294        MOVE STATE-UN-PREMIUM   TO DOMI-UN-PREMIUM
  1295         GO TO 1300-EXIT.
  1296
  1297     IF CP-EARN-AS-NET-PAY
  1298        AND CP-TRUNCATED-LIFE
  1299        AND CP-LOAN-TERM  LESS THAN CP-ORIGINAL-TERM
  1300         GO TO 1300-EXIT.
  1301
  1302     IF CP-EARN-AS-NET-PAY
  1303         IF CP-LOAN-APR NOT = ZEROS
  1304             GO TO 1300-EXIT.
  1305
  1306     IF CP-BENEFIT-TYPE  = 'L' OR 'P'
  1307         MOVE PR-UN-PREMIUM       TO DOMI-UN-PREMIUM
  1308     ELSE
  1309         MOVE R78-UN-PREMIUM      TO DOMI-UN-PREMIUM.
  1310
  1311 1300-EXIT.
  1312
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  30
* SUNPRMX.cbl (/apps/prod/cid1p/copy/SUNUPRMP)
  1314******************** UNEARNED A&H  PREMIUM ***********************
  1315 1500-CALC-UNEARNED-AH SECTION.
  1316
  1317     PERFORM 1510-AH-PRORATA-UNEARNED THRU 1510-EXIT.
  1318
  1319     PERFORM 1550-AH-RULE78S-UNEARNED  THRU 1550-EXIT.
  1320
  1321     IF CP-COMPANY-ID = 'NCL'
  1322         IF DC-GREG-DATE-CYMD LESS THAN 19910101
  1323             MOVE ZEROS           TO CP-LOAN-APR
  1324             IF CP-EARN-AS-NET-PAY
  1325                 MOVE 'R'         TO CP-EARNING-METHOD.
  1326
  1327     IF CP-EARNING-METHOD EQUAL 'N'
  1328         PERFORM 1180-CALC-NET-PAY-UN THRU 1180-EXIT.
  1329
  1330     PERFORM 1600-DO-STATE-AH         THRU 1699-EXIT.
  1331
  1332     PERFORM 1700-DO-DOM-STATE-AH     THRU 1799-EXIT.
  1333
  1334     MOVE DOMI-UN-PREMIUM         TO CP-DOMICILE-U-PRM.
  1335     MOVE STATE-UN-PREMIUM        TO CP-STATE-U-PRM.
  1336     MOVE PR-UN-PREMIUM           TO CP-PRORATA-U-PRM.
  1337     MOVE ZEROS                   TO CP-PRORATA-U-PRM-ALT.
  1338     MOVE R78-UN-PREMIUM          TO CP-R78-U-PRM.
  1339     MOVE ZEROS                   TO CP-R78-U-PRM-ALT.
  1340
  1341
  1342 1500-CALC-UNEARNED-X.
  1343     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  31
* SUNPRMX.cbl (/apps/prod/cid1p/copy/SUNUPRMP)
  1345*********************************************
  1346*                                           *
  1347* PERFORMED: A&H  UNEARNED PREMIUM ROUTINES *
  1348*                                           *
  1349*********************************************
  1350
  1351 1510-AH-PRORATA-UNEARNED.
  1352
  1353     IF CP-COMPANY-ID EQUAL 'FLI' OR 'FLU' OR 'MIC' OR 'MCC'
  1354         COMPUTE PR-FACTOR ROUNDED =
  1355                   (CP-REMAINING-TERM - .5) / CP-ORIGINAL-TERM
  1356     ELSE
  1357         COMPUTE PR-FACTOR ROUNDED =
  1358                       CP-REMAINING-TERM / CP-ORIGINAL-TERM.
  1359
  1360     COMPUTE PR-UN-PREMIUM ROUNDED =
  1361                     CP-ORIGINAL-PREMIUM * PR-FACTOR.
  1362
  1363 1510-EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  32
* SUNPRMX.cbl (/apps/prod/cid1p/copy/SUNUPRMP)
  1365 1550-AH-RULE78S-UNEARNED.
  1366
  1367     COMPUTE R78-TEMP-1 =
  1368                CP-REMAINING-TERM * (CP-REMAINING-TERM + +1).
  1369
  1370     IF CP-R78-OPTION = '1'
  1371         COMPUTE R78-TEMP-1 =
  1372                  CP-REMAINING-TERM * CP-REMAINING-TERM.
  1373
  1374     IF CP-COMPANY-ID = 'FLI'
  1375         COMPUTE R78-TEMP-1 =
  1376                  CP-REMAINING-TERM * CP-REMAINING-TERM.
  1377
  1378     IF CP-COMPANY-ID = 'MPP'
  1379         COMPUTE R78-TEMP-1 =
  1380                 (CP-ORIGINAL-TERM - CP-REMAINING-TERM)
  1381                 * ((CP-ORIGINAL-TERM - CP-REMAINING-TERM) + +1).
  1382
  1383     COMPUTE R78-TEMP-2 =
  1384                  CP-ORIGINAL-TERM * (CP-ORIGINAL-TERM + +1).
  1385
  1386     COMPUTE R78-FACTOR ROUNDED = R78-TEMP-1 / R78-TEMP-2.
  1387
  1388     COMPUTE R78-UN-PREMIUM ROUNDED =
  1389                     CP-ORIGINAL-PREMIUM * R78-FACTOR.
  1390
  1391
  1392 1550-EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  33
* SUNPRMX.cbl (/apps/prod/cid1p/copy/SUNUPRMP)
  1394
  1395 1600-DO-STATE-AH.
  1396
  1397     IF (CP-COMPANY-ID = 'CSO'  OR  'CID')  AND
  1398         CP-STATE-STD-ABBRV = 'CO'
  1399         IF DC-GREG-DATE-CYMD LESS THAN 19970101
  1400             MOVE R78-UN-PREMIUM  TO STATE-UN-PREMIUM
  1401             GO TO 1699-EXIT
  1402         ELSE
  1403*            COMPUTE STATE-UN-PREMIUM =
  1404             COMPUTE STATE-UN-PREMIUM ROUNDED =
  1405                 (PR-UN-PREMIUM + R78-UN-PREMIUM ) / +2
  1406             GO TO 1699-EXIT.
  1407
  1408     IF (CP-STATE-STD-ABBRV = 'VA') AND
  1409        (DC-GREG-DATE-CYMD GREATER THAN 19921231) AND
  1410        (CP-ORIGINAL-TERM LESS THAN 62)
  1411          MOVE 'R'               TO  CP-EARNING-METHOD
  1412          GO TO 1600-CONTINUE.
  1413
  1414     IF CP-STATE-STD-ABBRV  = 'OH'
  1415         GO TO 1650-DO-OHIO.
  1416
  1417     IF CP-STATE-STD-ABBRV  = 'OK'
  1418         GO TO 1660-DO-OKLAHOMA.
  1419
  1420     IF CP-STATE-STD-ABBRV  = 'TX'
  1421         GO TO 1670-DO-TEXAS.
  1422
  1423     IF CP-COMPANY-ID EQUAL 'CSL'
  1424        IF CP-CARRIER EQUAL '2'
  1425           GO TO 1680-DO-SCAROLINA.
  1426
  1427     IF CP-COMPANY-ID EQUAL 'GIC'
  1428       IF (CP-EARNING-METHOD NOT = 'B' AND 'K' AND 'L')
  1429         COMPUTE STATE-UN-PREMIUM =
  1430            (PR-UN-PREMIUM * .80) + (R78-UN-PREMIUM  * .20)
  1431         GO TO 1699-EXIT.
  1432
  1433     IF CP-EARN-AS-NET-PAY
  1434         IF CP-LOAN-APR NOT = ZEROS
  1435             GO TO 1699-EXIT.
  1436
  1437 1600-CONTINUE.
  1438
  1439     MOVE R78-UN-PREMIUM           TO STATE-UN-PREMIUM.
  1440     MOVE +0                       TO SRL.
  1441
  1442 1610-TABLE-LOOKUP.
  1443     ADD +1                        TO SRL.
  1444
  1445     IF AH-RES-STATE-ENT (SRL) = HIGH-VALUES
  1446         GO TO 1699-EXIT.
  1447
  1448     IF CP-STATE-STD-ABBRV  = AH-RES-STATE-ENT (SRL)
  1449         MOVE PR-UN-PREMIUM        TO STATE-UN-PREMIUM
  1450         GO TO 1699-EXIT.
  1451
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  34
* SUNPRMX.cbl (/apps/prod/cid1p/copy/SUNUPRMP)
  1452     GO TO 1610-TABLE-LOOKUP.
  1453
  1454 1650-DO-OHIO.
  1455
  1456     IF DC-GREG-DATE-CYMD LESS THAN 19831101
  1457         MOVE PR-UN-PREMIUM        TO STATE-UN-PREMIUM
  1458     ELSE
  1459         COMPUTE STATE-UN-PREMIUM =
  1460             (PR-UN-PREMIUM + R78-UN-PREMIUM ) / +2.
  1461
  1462     GO TO 1699-EXIT.
  1463
  1464 1660-DO-OKLAHOMA.
  1465     IF DC-GREG-DATE-CYMD LESS THAN 19820630
  1466         MOVE R78-UN-PREMIUM        TO STATE-UN-PREMIUM
  1467     ELSE
  1468         COMPUTE STATE-UN-PREMIUM =
  1469             (PR-UN-PREMIUM + R78-UN-PREMIUM ) / +2.
  1470
  1471     GO TO 1699-EXIT.
  1472
  1473 1670-DO-TEXAS.
  1474
  1475     IF CP-COMPANY-ID  = 'ABL' AND CP-CARRIER NOT EQUAL '2'
  1476         COMPUTE STATE-UN-PREMIUM =
  1477             (PR-UN-PREMIUM + R78-UN-PREMIUM ) / +2
  1478         GO TO 1699-EXIT.
  1479
  1480     IF DC-GREG-DATE-CYMD LESS THAN 19830901
  1481         MOVE R78-UN-PREMIUM        TO STATE-UN-PREMIUM
  1482     ELSE
  1483         COMPUTE STATE-UN-PREMIUM =
  1484             (PR-UN-PREMIUM + R78-UN-PREMIUM ) / +2.
  1485
  1486     GO TO 1699-EXIT.
  1487
  1488 1680-DO-SCAROLINA.
  1489
  1490     COMPUTE STATE-UN-PREMIUM EQUAL
  1491             (PR-UN-PREMIUM + R78-UN-PREMIUM) / +2.
  1492
  1493 1699-EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  35
* SUNPRMX.cbl (/apps/prod/cid1p/copy/SUNUPRMP)
  1495
  1496 1700-DO-DOM-STATE-AH.
  1497
  1498     IF CP-DOMICILE-STATE = '  '  OR  '00'
  1499         GO TO 1799-EXIT.
  1500
  1501     IF (CP-COMPANY-ID = 'CSO'  OR  'CID')  AND
  1502         CP-DOMICILE-STATE = 'CO'
  1503         IF DC-GREG-DATE-CYMD LESS THAN 19970101
  1504             MOVE R78-UN-PREMIUM  TO DOMI-UN-PREMIUM
  1505             GO TO 1799-EXIT
  1506         ELSE
  1507*            COMPUTE DOMI-UN-PREMIUM =
  1508             COMPUTE DOMI-UN-PREMIUM ROUNDED =
  1509                 (PR-UN-PREMIUM + R78-UN-PREMIUM ) / +2
  1510             GO TO 1799-EXIT.
  1511
  1512     IF (CP-STATE-STD-ABBRV = 'VA') AND
  1513        (DC-GREG-DATE-CYMD GREATER THAN 19921231) AND
  1514        (CP-ORIGINAL-TERM LESS THAN 62)
  1515          MOVE 'R'               TO  CP-EARNING-METHOD
  1516          GO TO 1700-CONTINUE.
  1517
  1518     IF CP-DOMICILE-STATE = 'OH'
  1519         GO TO 1750-DO-DOM-OHIO.
  1520
  1521     IF CP-DOMICILE-STATE = 'OK'
  1522         GO TO 1760-DO-DOM-OKLAHOMA.
  1523
  1524     IF CP-DOMICILE-STATE = 'TX'
  1525         GO TO 1770-DO-DOM-TEXAS.
  1526
  1527     IF CP-EARN-AS-NET-PAY
  1528         IF CP-LOAN-APR NOT = ZEROS
  1529             GO TO 1799-EXIT.
  1530
  1531 1700-CONTINUE.
  1532
  1533     MOVE R78-UN-PREMIUM        TO DOMI-UN-PREMIUM.
  1534     MOVE +0                    TO SRL.
  1535
  1536 1710-TABLE-LOOKUP.
  1537     ADD +1                     TO SRL.
  1538
  1539     IF AH-RES-STATE-ENT (SRL) = HIGH-VALUES
  1540         GO TO 1799-EXIT.
  1541
  1542     IF CP-DOMICILE-STATE = AH-RES-STATE-ENT (SRL)
  1543         MOVE PR-UN-PREMIUM      TO DOMI-UN-PREMIUM
  1544         GO TO 1799-EXIT.
  1545
  1546     GO TO 1710-TABLE-LOOKUP.
  1547
  1548 1750-DO-DOM-OHIO.
  1549     IF DC-GREG-DATE-CYMD LESS THAN 19831101
  1550         MOVE PR-UN-PREMIUM      TO DOMI-UN-PREMIUM
  1551     ELSE
  1552         COMPUTE DOMI-UN-PREMIUM =
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  36
* SUNPRMX.cbl (/apps/prod/cid1p/copy/SUNUPRMP)
  1553             (PR-UN-PREMIUM + R78-UN-PREMIUM ) / +2.
  1554
  1555     GO TO 1799-EXIT.
  1556
  1557 1760-DO-DOM-OKLAHOMA.
  1558
  1559     IF DC-GREG-DATE-CYMD LESS THAN 19820630
  1560         MOVE R78-UN-PREMIUM    TO DOMI-UN-PREMIUM
  1561     ELSE
  1562         COMPUTE DOMI-UN-PREMIUM =
  1563             (PR-UN-PREMIUM + R78-UN-PREMIUM ) / +2.
  1564
  1565     GO TO 1799-EXIT.
  1566
  1567 1770-DO-DOM-TEXAS.
  1568
  1569     IF DC-GREG-DATE-CYMD LESS THAN 19830901
  1570         MOVE R78-UN-PREMIUM    TO DOMI-UN-PREMIUM
  1571     ELSE
  1572         COMPUTE DOMI-UN-PREMIUM =
  1573             (PR-UN-PREMIUM + R78-UN-PREMIUM ) / +2.
  1574
  1575 1799-EXIT.
  1576
  1577
  1578 1999-EXIT-CALC-ROUTINE.
  1579
  1580     GOBACK.
  1581
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  37
* SUNPRMX.cbl
  1583 2500-GET-RATE.
  1584     CALL 'SUNATEX' USING CALCULATION-PASS-AREA.
  1585
  1586 2500-EXIT.
  1587     EXIT.
  1588
  1589 9100-CONVERT-DATE.
  1590     CALL 'SUNATCX' USING DATE-CONVERSION-DATA.
  1591
  1592 9100-EXIT.
  1593      EXIT.
  1594
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  38
* SUNPRMX.cbl
  1596*10000-NET-TERM SECTION.
  1597*                            COPY ERCNETP.
  1598
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:        1124     Code:        4255
