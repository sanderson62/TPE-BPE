* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   1
* SUNATEX.cbl
* Options: int("SUNATEX.int") anim csi verbose NOBOUND PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("SUNATEX.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"ebmlsfile" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" NOCHECKDIV NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"32" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"SUNATEX.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"SUNATEX.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR NOSTICKY-LINKAGE
*          NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"2" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                SUNATEX.
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 12/11/95 14:39:14.
     7*                           VMOD=2.009
     8*
     9*AUTHOR.     LOGIC, INC.
    10*            DALLAS, TEXAS.
    11
    12*DATE-COMPILED.
    13
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   2
* SUNATEX.cbl
    14*SECURITY.   *****************************************************
    15*            *                                                   *
    16*            *   THIS PROGRAM IS THE PROPERTY OF LOGIC, INC.     *
    17*            *                                                   *
    18*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
    19*            *   OF LOGIC, INC. IS EXPRESSLY PROHIBITED WITHOUT  *
    20*            *   THE PRIOR WRITTEN PERMISSION OF LOGIC INC.      *
    21*            *                                                   *
    22*            *****************************************************
    23
    24*REMARKS.    *****************************************************
    25*            *    (BATCH VERSION OF ELRATE)                      *
    26*            *    THIS 'SUBROUTINE' WILL, DEPENDING UPON THE     *
    27*            *    OPTION SPECIFIED, COMPUTE PREMIUM AMOUNTS      *
    28*            *    AND RATES.                                     *
    29*            *****************************************************
    30
    31
    32******************************************************************
    33*                                                                *
    34*              INPUT FIELDS USED                                 *
    35*                                                                *
    36******************************************************************
    37*  ORIGINAL TERM    - CP-ORIGINAL-TERM    (RATING TERM)          *
    38*  CLASS CODE       - CP-CLASS-CODE                              *
    39*  DEVIATION CODE   - CP-DEVIATION-CODE                          *
    40*  ORIGINAL BENEFIT - CP-ORIGINAL-BENEFIT                        *
    41*  RATING BENEFIT   - CP-RATING-BENEFIT-AMT (TOT BEN ON BALLOON) *
    42*  BENEFIT TYPE     - CP-BENEFIT-TYPE                            *
    43*  STATE CODE (NUM) - CP-STATE                                   *
    44*  STATE CODE       - CP-STATE-STD-ABBV                          *
    45*  COMPANY I.D.     - CP-COMPANY-ID                              *
    46*  COMPANY CD (NUM) - CP-COMPANY-CD                              *
    47*  INSURED AGE      - CP-ISSUE-AGE                               *
    48*  RATING METHOD    - CP-EARNING-METHOD                          *
    49*  SPECIAL METHOD   - CP-SPECIAL-CALC-CODE                       *
    50*  A.P.R.           - CP-LOAN-APR                                *
    51*  A/H RATING TERM  - CP-CAPPED-TERM  (ONLY FOR SKIP CODE A/H)   *
    52*  PAYMENT FREQUENCY- CP-PAY-FREQUENCY                           *
    53*  CERT ISSUE DATE  - CP-CERT-EFF-DT                             *
    54******************************************************************
    55 ENVIRONMENT DIVISION.
    56
    57 INPUT-OUTPUT SECTION.
    58 FILE-CONTROL.
    59
    60     SELECT ERRATEF ASSIGN TO SYS001-FBA1-ERRATE
    61             ORGANIZATION IS INDEXED
    62             ACCESS IS SEQUENTIAL
    63             RECORD KEY IS ER-RATE-KEY
    64             FILE STATUS IS ER-STATUS.
    65
    66     SELECT OERATEF ASSIGN TO SYS001-FBA1-OERATE
    67             ORGANIZATION IS INDEXED
    68             ACCESS IS SEQUENTIAL
    69             RECORD KEY IS OE-RATE-KEY
    70             FILE STATUS IS ER-STATUS.
    71
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   3
* SUNATEX.cbl
    72 DATA DIVISION.
    73 FILE SECTION.
    74 FD  ERRATEF.
    75 01  ER-RATE-REC.
    76     03  FILLER       PIC XX.
    77     03  ER-RATE-KEY  PIC X(28).
    78     03  FILLER       PIC X(1735).
    79
    80 FD  OERATEF.
    81 01  OE-RATE-REC.
    82     03  FILLER       PIC XX.
    83     03  OE-RATE-KEY  PIC X(28).
    84     03  FILLER       PIC X(1735).
    85
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   4
* SUNATEX.cbl
    87 WORKING-STORAGE SECTION.
    88 77  FILLER   PIC X(32) VALUE '********************************'.
    89 77  FILLER   PIC X(32) VALUE '**  ELRATEX  WORKING STORAGE  **'.
    90 77  FILLER   PIC X(32) VALUE '***********VMOD 2.009 **********'.
    91
*   92                             COPY ELCRATWS.
    93******************************************************************04/15/98
    94*                                                                *ELCRATWS
    95*                                                                *ELCRATWS
    96*                            ELCRATWS.                           *   LV006
    97*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**6
    98*                            VMOD=2.010                          *   CL**6
    99*                                                                *ELCRATWS
   100******************************************************************ELCRATWS
   101                                                                  ELCRATWS
   102 01  STANDARD-AREAS.                                              ELCRATWS
   103     12  ER-STATUS               PIC XX.                          ELCRATWS
   104     12  WS-BROWSE-SW            PIC X       VALUE SPACE.         ELCRATWS
   105         88 WS-BROWSE-STARTED                VALUE 'Y'.           ELCRATWS
   106     12  WS-PREMIUM-RATE         PIC S99V9(5) COMP-3 VALUE ZERO.  ELCRATWS
   107     12  WS-FARM-TERM            PIC S9(3)    COMP-3 VALUE ZERO.  ELCRATWS
   108     12  OERATE-FILE-ID          PIC X(8)    VALUE 'OERATE'.      ELCRATWS
   109     12  ERRATE-FILE-ID          PIC X(8)    VALUE 'ERRATE'.      ELCRATWS
   110     12  ERRATE-KEY.                                              ELCRATWS
   111         16  RATE-COMPANY-CD     PIC X        VALUE SPACE.        ELCRATWS
   112         16  RATE-STATE-CODE.                                     ELCRATWS
   113             20  RATE-ST-CODE    PIC  XX      VALUE SPACES.       ELCRATWS
   114             20  RATE-ST-CLASS   PIC  XX      VALUE SPACES.       ELCRATWS
   115             20  RATE-ST-DEV     PIC  XXX     VALUE SPACES.       ELCRATWS
   116         16  RATE-L-AH-CODE.                                      ELCRATWS
   117             20  RATE-L-AH       PIC  X       VALUE SPACE.        ELCRATWS
   118             20  RATE-LAH-NUM    PIC  XX      VALUE ZEROS.        ELCRATWS
   119         16  RATE-LIMITS.                                         ELCRATWS
   120             20  RATE-HIGH-AGE   PIC  99      VALUE ZEROS.        ELCRATWS
   121             20  RATE-HIGH-AMT   PIC  9(6)    VALUE ZEROS.        ELCRATWS
   122             20  RATE-FUTURE     PIC  XX      VALUE SPACES.       ELCRATWS
   123             20  RATE-SEX        PIC  X       VALUE '9'.          ELCRATWS
   124         16  RATE-EXPIRY-DATE    PIC 9(11)    COMP-3.                CL**3
   125                                                                  ELCRATWS
   126     12  SAVE-ERRATE-KEY.                                         ELCRATWS
   127         16  SVRT-COMPANY-CD     PIC X        VALUE SPACE.        ELCRATWS
   128         16  SVRT-STATE-CODE.                                     ELCRATWS
   129             20  SVRT-ST-CODE    PIC  XX      VALUE SPACES.       ELCRATWS
   130             20  SVRT-ST-CLASS   PIC  XX      VALUE SPACES.       ELCRATWS
   131             20  SVRT-ST-DEV     PIC  XXX     VALUE SPACES.       ELCRATWS
   132         16  SVRT-L-AH-CODE.                                      ELCRATWS
   133             20  SVRT-L-AH       PIC  X       VALUE SPACE.        ELCRATWS
   134             20  SVRT-LAH-NUM    PIC  XX      VALUE ZEROS.        ELCRATWS
   135         16  SVRT-LIMITS.                                         ELCRATWS
   136             20  SVRT-HIGH-AGE   PIC  99      VALUE ZEROS.        ELCRATWS
   137             20  SVRT-HIGH-AMT   PIC  9(6)    VALUE ZEROS.        ELCRATWS
   138             20  SVRT-FUTURE     PIC  XX      VALUE SPACES.       ELCRATWS
   139             20  SVRT-SEX        PIC  X       VALUE '9'.          ELCRATWS
   140         16  SVRT-EXPIRY-DATE    PIC  9(11)   COMP-3.                CL**2
   141                                                                  ELCRATWS
   142     12  WS-SIN-PREM-RATE        PIC S99V9(07) VALUE +0.          ELCRATWS
   143     12  WS-TERM-MINUS-ONE       PIC S9(5)    COMP-3 VALUE +0.    ELCRATWS
   144                                                                  ELCRATWS
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   5
* SUNATEX.cbl (/apps/prod/cid1p/copy/ELCRATWS)
   145 01  CSL-WORK-AREAS          COMP-3.                              ELCRATWS
   146     12  WK-C                PIC S9(3)V9(9)     VALUE ZEROS.      ELCRATWS
   147     12  WK-D                PIC S9(4)V9(9)     VALUE ZEROS.      ELCRATWS
   148     12  WK-J                PIC S999           VALUE ZEROS.      ELCRATWS
   149     12  WK-K                PIC S999           VALUE ZEROS.      ELCRATWS
   150     12  WK-L                PIC S99V9(9)       VALUE ZEROS.      ELCRATWS
   151     12  WK-S                PIC S999V9(4)      VALUE ZEROS.      ELCRATWS
   152     12  WK-T                PIC S999           VALUE ZEROS.      ELCRATWS
   153     12  WK-T1               PIC S999           VALUE ZEROS.      ELCRATWS
   154     12  WK-U                PIC S99V9(9)       VALUE ZEROS.      ELCRATWS
   155     12  WK-PREM             PIC S9(6)V999      VALUE ZEROS.      ELCRATWS
   156     12  WK-PAY-AMT          PIC S9(7)V99       VALUE ZEROS.      ELCRATWS
   157     12  WK-LEV-RATE         PIC S99V9(7)       VALUE ZEROS.      ELCRATWS
   158     12  WK-RED-RATE         PIC S99V9(7)       VALUE ZEROS.      ELCRATWS
   159     12  WK-DAILY-RATE       PIC S99V9(7)       VALUE ZEROS.      ELCRATWS
   160     12  WK-MONTHLY-RATE     PIC S99V9(7)       VALUE ZEROS.      ELCRATWS
   161     12  WK-MONTHLY-RATE-T   PIC S99V9(7)       VALUE ZEROS.      ELCRATWS
   162     12  WK-MONTHLY-RATE-J   PIC S99V9(7)       VALUE ZEROS.      ELCRATWS
   163     12  WS-MAX-TOT-BEN      PIC S9(7)V99       VALUE ZEROS.      ELCRATWS
   164     12  WS-MAX-MON-BEN      PIC S9(7)V99       VALUE ZEROS.      ELCRATWS
   165     12  WS-NUM-PAYMTS       PIC S9(5)          VALUE ZEROS.      ELCRATWS
   166     12  WS-PAY-SCH          PIC S99            VALUE ZEROS.      ELCRATWS
   167                                                                  ELCRATWS
   168 01  TEXAS-REG-WORK-AREAS.                                        ELCRATWS
   169     12  TEX-FACT-1          PIC S9(7)V99    COMP-3.              ELCRATWS
   170     12  TEX-FACT-2          PIC S9(3)       COMP-3.              ELCRATWS
   171     12  TEX-FACT-3          PIC S9(3)       COMP-3.              ELCRATWS
   172     12  TEX-FACT-4          PIC S9(7)       COMP-3.              ELCRATWS
   173     12  TEX-FACT-5          PIC S9(3)       COMP-3.              ELCRATWS
   174     12  TEX-FACT-6          PIC S9(3)       COMP-3.              ELCRATWS
   175     12  TEX-FACT-7          PIC S9(7)       COMP-3.              ELCRATWS
   176     12  TEX-FACT-8          PIC S9V9(6)     COMP-3.              ELCRATWS
   177     12  TEX-FACT-9          PIC S9(4)V9(11) COMP-3.              ELCRATWS
   178                                                                  ELCRATWS
   179 01  NET-PAY-INTERFACE.                                           ELCRATWS
   180     12  N-P-APR             PIC S9(3)V9(4)  COMP-3.              ELCRATWS
   181     12  N-P-ORIG            PIC S9(3)       COMP-3.              ELCRATWS
   182     12  N-P-REM             PIC S9(3)       COMP-3.              ELCRATWS
   183     12  N-P-OPT             PIC X.                               ELCRATWS
   184     12  N-P-LOAN            PIC S9(3)       COMP-3.              ELCRATWS
   185     12  N-P-FACTOR          PIC S9(4)V9(9)  COMP-3.              ELCRATWS
   186                                                                  ELCRATWS
   187
*  188                             COPY ERCNETWS.
   189***************************************************************** 04/29/98
   190*                                                               * ERCNETWS
   191*                                                               * ERCNETWS
   192*                            ERCNETWS                           *    LV004
   193*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**4
   194*                            VMOD=2.014                         *    CL**3
   195*                                                               * ERCNETWS
   196*    WORKING STORAGE TO USE WITH ERCNETP - NET PAY CALCULATIONS * ERCNETWS
   197*                                                               * ERCNETWS
   198*****************************************************************.ERCNETWS
   199*                   C H A N G E   L O G
   200*
   201* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   202*-----------------------------------------------------------------
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   6
* SUNATEX.cbl (/apps/prod/cid1p/copy/ERCNETWS)
   203*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   204* EFFECTIVE    NUMBER
   205*-----------------------------------------------------------------
   206* 060909  CR2008042300002  PEMA  ADD NEW FARM PLAN CALC
   207* 101509  IR2009100700002  PEMA  INCREASE DECIMAL POSITIONS
   208* 071910  IR2010062900001  PEMA  ADD MN NET BALLOON REFUND CALC
   209* 071511  CR2011021500001  PEMA  ADD CODE FOR DCC 10C
   210* 050713  CR2008052200001  PEMA  ADD CODE FOR 0 PCT APR
   211******************************************************************
   212                                                                  ERCNETWS
   213 01  NET-PAY-WORK-AREA.                                           ERCNETWS
   214     12  OPTION-SW               PIC X   VALUE 'X'.               ERCNETWS
   215        88  NPO-STD         VALUE SPACE.                          ERCNETWS
   216        88  NPO-ALT         VALUE 'A'.                            ERCNETWS
   217        88  NPO-SIMPLE      VALUE 'S'.                            ERCNETWS
   218        88  NPO-2MO         VALUE 'I'.                            ERCNETWS
   219        88  NPO-3MO         VALUE 'J'.                            ERCNETWS
   220        88  NPO-4MO         VALUE 'K'.                            ERCNETWS
   221        88  NPO-TRUNC       VALUE 'T' 'U' 'V' 'W' 'X'.            ERCNETWS
   222        88  NPO-TRUNC-0     VALUE 'T'.                            ERCNETWS
   223        88  NPO-TRUNC-1     VALUE 'U'.                            ERCNETWS
   224        88  NPO-TRUNC-2     VALUE 'V'.                            ERCNETWS
   225        88  NPO-TRUNC-3     VALUE 'W'.                            ERCNETWS
   226        88  NPO-TRUNC-4     VALUE 'X'.                            ERCNETWS
   227        88  NPO-REFUND      VALUE 'R'.                            ERCNETWS
   228        88  NPO-PRUDENTIAL  VALUE 'P'.                            ERCNETWS
   229                                                                  ERCNETWS
   230     12  TYPE-SW             PIC X   VALUE 'N'.                   ERCNETWS
   231        88  NET-STD             VALUE 'N'.                        ERCNETWS
   232        88  NET-SMP             VALUE 'S'.                        ERCNETWS
   233                                                                  ERCNETWS
   234     12  NP-PROCESS-SW       PIC X   VALUE '1'.                   ERCNETWS
   235        88  NP-RATING           VALUE '1'.                        ERCNETWS
   236        88  NP-REFUND           VALUE '2'.                        ERCNETWS
   237        88  NP-REMAIN-AMT       VALUE '3'.                        ERCNETWS
   238                                                                  ERCNETWS
   239     12  COMP-3-WORK-AREA         COMP-3.                         ERCNETWS
   240         16  WS-WORK-DIS-RATE PIC S99V9(06)    VALUE +0.          ERCNETWS
   241         16  V               PIC SV9(13)       VALUE +.0.         ERCNETWS
   242         16  J               PIC SV9(9)        VALUE +0.
   243         16  K               PIC SV9(9)        VALUE +0.
   244         16  I               PIC SV9(10)       VALUE +.0.         ERCNETWS
   245         16  D               PIC S9(5)         VALUE +.0.
   246         16  APR100          PIC SV9(9)        VALUE +.0.         ERCNETWS
   247         16  RA              PIC S9(6)V9(9)    VALUE +.0.         ERCNETWS
   248         16  WK1             PIC S9(4)V9(13)   VALUE +.0.         ERCNETWS
   249         16  WK2             PIC S9(4)V9(13)   VALUE +.0.         ERCNETWS
   250         16  pema            pic s9(2)v9(15)   value +0.
   251         16  WK3             PIC S9(7)V9(10)   VALUE +.0.         ERCNETWS
   252         16  WK4             PIC S9(7)V9(8)    VALUE +.0.         ERCNETWS
   253         16  WK5             PIC S9(5)V9(13)   VALUE +.0.         ERCNETWS
   254         16  WK5-CSL         PIC S9(9)V9(6)    VALUE +.0.         ERCNETWS
   255         16  WK6             PIC S9(7)V9(10)   VALUE +.0.         ERCNETWS
   256         16  WK7             PIC S9(7)V9(10)   VALUE +.0.         ERCNETWS
   257         16  WK8             PIC S9(3)V9(10)   VALUE +.0.         ERCNETWS
   258         16  WK9             PIC S9(3)V9(10)   VALUE +.0.         ERCNETWS
   259         16  GR              PIC S9(7)V9(10)   VALUE +.0.         ERCNETWS
   260         16  ONE-PLUS-I      PIC S9(3)V9(10)   VALUE +.0.         ERCNETWS
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   7
* SUNATEX.cbl (/apps/prod/cid1p/copy/ERCNETWS)
   261         16  ODF             PIC S9(3)V9(10)   VALUE +.0.         ERCNETWS
   262         16  OD              PIC S9(3)V9(10)   VALUE +.0.         ERCNETWS
   263         16  FM              PIC S9(3)V9(10)   VALUE +.0.         ERCNETWS
   264         16  FN              PIC S9(3)V9(10)   VALUE +.0.         ERCNETWS
   265         16  FNM             PIC S9(3)V9(10)   VALUE +.0.         ERCNETWS
   266         16  ANGLEM          PIC S9(5)V9(13)   VALUE +.0.         ERCNETWS
   267         16  ANGLEMY         PIC S9(5)V9(13)   VALUE +.0.         ERCNETWS
   268         16  ANGLEMP1        PIC S9(5)V9(13)   VALUE +.0.         ERCNETWS
   269         16  ANGLEN          PIC S9(5)V9(13)   VALUE +.0.         ERCNETWS
   270         16  ANGLENY         PIC S9(5)V9(13)   VALUE +.0.         ERCNETWS
   271         16  ANGLEN-M        PIC S9(5)V9(13)   VALUE +.0.         ERCNETWS
   272         16  ANGLEN-MP1      PIC S9(5)V9(13)   VALUE +.0.         ERCNETWS
   273         16  ANGLEN-MP1Y     PIC S9(5)V9(13)   VALUE +.0.         ERCNETWS
   274         16  ANGLEN-1        PIC S9(7)V9(10)   VALUE +.0.         ERCNETWS
   275         16  ANGLEM-1        PIC S9(7)V9(10)   VALUE +.0.         ERCNETWS
   276         16  ANGLEM-1Y       PIC S9(7)V9(10)   VALUE +.0.         ERCNETWS
   277         16  ANGLEM-T        PIC S9(5)V9(13)   VALUE +.0.         ERCNETWS
   278         16  PVBALLOON       PIC S9(7)V99      VALUE +.0.         ERCNETWS
   279         16  TRUNC-PMT       PIC S9(7)V99      VALUE +.0.         ERCNETWS
   280         16  K1              PIC S999          VALUE +1.          ERCNETWS
   281         16  K12             PIC S999          VALUE +12.         ERCNETWS
   282         16  K100            PIC S999          VALUE +100.        ERCNETWS
   283         16  K1000           PIC S9(7)         VALUE +1000.       ERCNETWS
   284         16  NC-LR           PIC S9(2)V9(5)    VALUE +.0.         ERCNETWS
   285         16  Y REDEFINES NC-LR
   286                             PIC S99V9(5).
   287         16  TI              PIC S999V9(5)     VALUE +0.
   288         16  NC-R            PIC S9(7)V9(10)   VALUE +.0.         ERCNETWS
   289         16  NC-OB           PIC S9(7)V9(10)   VALUE +.0.         ERCNETWS
   290         16  NC-P            PIC S9(7)V9(10)   VALUE +.0.         ERCNETWS
   291         16  NC-D            PIC S9(7)V9(10)   VALUE +.0.         ERCNETWS
   292         16  NC-BIG-D        PIC S9(3)         VALUE +030.        ERCNETWS
   293         16  NC-LITTLE-D     PIC S9(2)V9(7)    VALUE +.0.         ERCNETWS
   294         16  NC-MP           PIC S9(5)V9(2)    VALUE +.0.         ERCNETWS
   295         16  NC-LP           PIC S9(5)V9(2)    VALUE +.0.         ERCNETWS
   296                                                                  ERCNETWS
   297         16  CA-MP           PIC S9(5)V9(2)    VALUE +.0.         ERCNETWS
   298         16  CA-API          PIC S9(2)V9(8)    VALUE +.0.         ERCNETWS
   299         16  CA-APJ          PIC S9(2)V9(8)    VALUE +.0.         ERCNETWS
   300         16  CA-VI           PIC S9(2)V9(8)    VALUE +.0.         ERCNETWS
   301         16  CA-J            PIC S9(2)V9(8)    VALUE +.0.         ERCNETWS
   302         16  CA-DISCOUNT     PIC S9(2)V9(8)    VALUE +.042000.    ERCNETWS
   303         16  GTL-IA-DIVIDEND PIC S9(5)V9(8)    VALUE +.0.         ERCNETWS
   304         16  GTL-IA-DIVISOR  PIC S9(5)V9(8)    VALUE +.0.         ERCNETWS
   305         16  GTL-IA-FACTOR   PIC S9(5)V9(8)    VALUE +.0.         ERCNETWS
   306         16  GTL-IA-ODF      PIC S9(5)V9(8)    VALUE +.0.         ERCNETWS
   307         16  GTL-IA-ODD-DAYS PIC S999          VALUE +.0.         ERCNETWS
   308         16  GTL-IA-SGN      PIC S9            VALUE +.0.         ERCNETWS
   309         16  GTL-IA-ABS      PIC 999           VALUE ZEROS.       ERCNETWS
   310                                                                  ERCNETWS
   311         16  ANNUAL-INT-RATE PIC S9(3)V9(4)    VALUE +.0.         ERCNETWS
   312                                                                  ERCNETWS
   313         16  ORIGINAL-TERM   PIC S999.                            ERCNETWS
   314         16  M              REDEFINES ORIGINAL-TERM               ERCNETWS
   315                             PIC S999.                            ERCNETWS
   316                                                                  ERCNETWS
   317         16  REMAINING-TERM  PIC S999.                            ERCNETWS
   318         16  R              REDEFINES REMAINING-TERM              ERCNETWS
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   8
* SUNATEX.cbl (/apps/prod/cid1p/copy/ERCNETWS)
   319                             PIC S999.                            ERCNETWS
   320                                                                  ERCNETWS
   321         16  LOAN-TERM       PIC S999.                            ERCNETWS
   322         16  N              REDEFINES LOAN-TERM                   ERCNETWS
   323                             PIC S999.                            ERCNETWS
   324                                                                  ERCNETWS
   325         16  EXPIRED-TERM    PIC S999.                            ERCNETWS
   326         16  E              REDEFINES EXPIRED-TERM                ERCNETWS
   327                             PIC S999.                            ERCNETWS
   328                                                                  ERCNETWS
   329         16  PRUDENTIAL-WORK-AMT                                  ERCNETWS
   330                             PIC S9(7)V9(8).                      ERCNETWS
   331         16  PWK            REDEFINES PRUDENTIAL-WORK-AMT         ERCNETWS
   332                             PIC S9(7)V9(8).                      ERCNETWS
   333                                                                  ERCNETWS
   334         16  FACTOR          PIC S9(4)V9(9)    VALUE +0.0.        ERCNETWS
   335         16  VX              PIC S9V9(13)      VALUE +0.0.        ERCNETWS
   336         16  SV              PIC S9V9(13)      VALUE +0.0.        ERCNETWS
   337         16  SV-MINUS-ONE    PIC S999V9(09)    VALUE +0.0.        ERCNETWS
   338         16  SX              PIC S9V9(13)      VALUE +0.0.        ERCNETWS
   339         16  SE              PIC S9V9(10)      VALUE +0.0.        ERCNETWS
   340         16  N2              PIC S9(7)         VALUE +0.          ERCNETWS
   341         16  N3              PIC S9(7)         VALUE +0.          ERCNETWS
   342         16  K-I             PIC S9V9(8)       VALUE +0.0.        ERCNETWS
   343                                                                  ERCNETWS
   344     12  BINARY-WORK-AREA        COMP.                            ERCNETWS
   345         16  X1              PIC S999        VALUE +0.            ERCNETWS
   346         16  X2              PIC S999        VALUE +0.            ERCNETWS
   347         16  MAX-X           PIC S9(5)       VALUE +0.            ERCNETWS
   348         16  B1              PIC S9(5)       VALUE +1.            ERCNETWS
   349         16  LINDX           PIC S999        VALUE ZEROS.         ERCNETWS
   350         16  AHNDX           PIC S999        VALUE ZEROS.         ERCNETWS
   351                                                                  ERCNETWS
   352     12  CSO-RATE-WORK-AREAS.
   353         16  C-PMTS-PER-YEAR     PIC S999V99 COMP-3 VALUE ZEROS.
   354         16  C-DAYS-IN-PMT-PER   PIC S999 COMP-3 VALUE ZEROS.
   355         16  C-TOT-PMTS          PIC S999 COMP-3 VALUE ZEROS.
   356
   357     12  WS-WORK-MISC.                                            ERCNETWS
   358         16  ws-extra-pmts       pic s999         comp-3.
   359         16  NET-BEN             PIC S9(9)V9999   COMP-3.         ERCNETWS
   360         16  WS-RATE-TERM        PIC S9(3)        COMP-3.         ERCNETWS
   361*        16  WS-AGE              PIC 99           VALUE ZEROS.    ERCNETWS
   362         16  WS-AGE              PIC S9(3)V99 COMP-3 VALUE +0.
   363         16  WS-AH-FACE-BENEFIT  PIC S9(7)        COMP-3.         ERCNETWS
   364         16  WS-COUNTER          PIC S9(3)    COMP-3  VALUE +0.   ERCNETWS
   365         16  WS-WORK-RATE        PIC S9(2)V9(8) COMP-3 VALUE +0.  ERCNETWS
   366         16  WS-DISCOUNT-OPTION  PIC X VALUE SPACES.              ERCNETWS
   367         16  WS-DUE-DATE         PIC S9(7) COMP-3 VALUE +0.          CL**2
   368         16  WS-INT-BEGIN-DATE   PIC S9(7) COMP-3 VALUE +0.          CL**2
   369         16  WS-X-Y-FACTOR       PIC S9(3)V9(15) COMP-3 VALUE +0. ERCNETWS
   370         16  WS-Y-X-FACTOR       PIC S9(3)V9(15) COMP-3 VALUE +0. ERCNETWS
   371         16  WS-ODD-DAY-UNITS    PIC S9(3)V9(15) COMP-3 VALUE +0. ERCNETWS
   372         16  WS-CALC-FREQ-RATE   PIC S9(2)V9(15) COMP-3 VALUE +0. ERCNETWS
   373         16  WS-NP-FACTOR        PIC S9(5)V9(10) COMP-3 VALUE +0. ERCNETWS
   374******************************************************************ERCNETWS
   375
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   9
* SUNATEX.cbl
*  377                             COPY ELCDATE.
   378******************************************************************06/11/98
   379*                                                                *ELCDATE
   380*                                                                *ELCDATE
   381*                            ELCDATE.                            *   LV023
   382*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL*16
   383*                            VMOD=2.003                           ELCDATE
   384*                                                                *ELCDATE
   385*                                                                *ELCDATE
   386*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *ELCDATE
   387*                 LENGTH = 200                                   *   CL*19
   388******************************************************************ELCDATE
   389                                                                  ELCDATE
   390 01  DATE-CONVERSION-DATA.                                        ELCDATE
   391     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.    CL*19
   392     12  DC-OPTION-CODE                PIC X.                        CL*15
   393         88  BIN-TO-GREG                VALUE ' '.                ELCDATE
   394         88  ELAPSED-BETWEEN-BIN        VALUE '1'.                ELCDATE
   395         88  EDIT-GREG-TO-BIN           VALUE '2'.                ELCDATE
   396         88  YMD-GREG-TO-BIN            VALUE '3'.                ELCDATE
   397         88  MDY-GREG-TO-BIN            VALUE '4'.                ELCDATE
   398         88  JULIAN-TO-BIN              VALUE '5'.                ELCDATE
   399         88  BIN-PLUS-ELAPSED           VALUE '6'.                ELCDATE
   400         88  FIND-CENTURY               VALUE '7'.                   CL*22
   401         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.                ELCDATE
   402         88  EDIT-GREG-TO-BIN-3         VALUE '9'.                ELCDATE
   403         88  YMD-GREG-TO-BIN-3          VALUE 'A'.                ELCDATE
   404         88  MDY-GREG-TO-BIN-3          VALUE 'B'.                ELCDATE
   405         88  JULIAN-TO-BIN-3            VALUE 'C'.                ELCDATE
   406         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.                ELCDATE
   407         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.                   CL*14
   408         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.                   CL*14
   409         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.                   CL*14
   410         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.         CL*14
   411         88  CHECK-LEAP-YEAR            VALUE 'H'.                   CL*14
   412         88  BIN-3-TO-GREG              VALUE 'I'.                   CL*14
   413         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.                   CL*14
   414         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.                   CL*14
   415         88  CYMD-GREG-TO-BIN           VALUE 'L'.                   CL*14
   416         88  MDCY-GREG-TO-BIN           VALUE 'M'.                   CL*14
   417         88  MDY-GREG-TO-JULIAN         VALUE 'N'.                   CL*14
   418         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.                   CL*14
   419         88  YMD-GREG-TO-JULIAN         VALUE 'P'.                   CL*14
   420         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.                   CL*14
   421         88  THREE-CHARACTER-BIN                                  ELCDATE
   422                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.       CL*14
   423         88  GREGORIAN-TO-BIN                                        CL**2
   424                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.    CL*14
   425         88  BIN-TO-GREGORIAN                                        CL**2
   426                  VALUES ' ' '1' 'I' '8' 'G'.                        CL*14
   427         88  JULIAN-TO-BINARY                                        CL**2
   428                  VALUES '5' 'C' 'E' 'F'.                            CL*14
   429     12  DC-ERROR-CODE                 PIC X.                        CL*15
   430         88  NO-CONVERSION-ERROR        VALUE ' '.                   CL**3
   431         88  DATE-CONVERSION-ERROR                                ELCDATE
   432                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.        CL*14
   433         88  DATE-IS-ZERO               VALUE '1'.                ELCDATE
   434         88  DATE-IS-NON-NUMERIC        VALUE '2'.                ELCDATE
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  10
* SUNATEX.cbl (/apps/prod/cid1p/copy/ELCDATE)
   435         88  DATE-IS-INVALID            VALUE '3'.                ELCDATE
   436         88  DATE1-GREATER-DATE2        VALUE '4'.                ELCDATE
   437         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.                ELCDATE
   438         88  DATE-INVALID-OPTION        VALUE '9'.                ELCDATE
   439         88  INVALID-CENTURY            VALUE 'A'.                ELCDATE
   440         88  ONLY-CENTURY               VALUE 'B'.                ELCDATE
   441         88  ONLY-LEAP-YEAR             VALUE 'C'.                ELCDATE
   442         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.              CL**3
   443     12  DC-END-OF-MONTH               PIC X.                        CL*15
   444         88  CALCULATE-END-OF-MONTH     VALUE '1'.                ELCDATE
   445     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.         CL*15
   446         88  USE-NORMAL-PROCESS         VALUE ' '.                ELCDATE
   447         88  ADJUST-DOWN-100-YRS        VALUE '1'.                ELCDATE
   448         88  ADJUST-UP-100-YRS          VALUE '2'.                ELCDATE
   449     12  FILLER                        PIC X.                        CL*15
   450     12  DC-CONVERSION-DATES.                                        CL*15
   451         16  DC-BIN-DATE-1             PIC XX.                       CL*15
   452         16  DC-BIN-DATE-2             PIC XX.                       CL*15
   453         16  DC-GREG-DATE-1-EDIT       PIC X(08).                    CL*15
   454         16  DC-GREG-DATE-1-EDIT-R REDEFINES                         CL*15
   455                       DC-GREG-DATE-1-EDIT.                       ELCDATE
   456             20  DC-EDIT1-MONTH        PIC 99.                       CL*15
   457             20  SLASH1-1              PIC X.                        CL*15
   458             20  DC-EDIT1-DAY          PIC 99.                       CL*15
   459             20  SLASH1-2              PIC X.                        CL*15
   460             20  DC-EDIT1-YEAR         PIC 99.                       CL*15
   461         16  DC-GREG-DATE-2-EDIT       PIC X(08).                    CL*15
   462         16  DC-GREG-DATE-2-EDIT-R REDEFINES                         CL*15
   463                     DC-GREG-DATE-2-EDIT.                         ELCDATE
   464             20  DC-EDIT2-MONTH        PIC 99.                       CL*15
   465             20  SLASH2-1              PIC X.                        CL*15
   466             20  DC-EDIT2-DAY          PIC 99.                       CL*15
   467             20  SLASH2-2              PIC X.                        CL*15
   468             20  DC-EDIT2-YEAR         PIC 99.                       CL*15
   469         16  DC-GREG-DATE-1-YMD        PIC 9(06).                    CL*15
   470         16  DC-GREG-DATE-1-YMD-R  REDEFINES                         CL*15
   471                     DC-GREG-DATE-1-YMD.                          ELCDATE
   472             20  DC-YMD-YEAR           PIC 99.                       CL*15
   473             20  DC-YMD-MONTH          PIC 99.                       CL*15
   474             20  DC-YMD-DAY            PIC 99.                       CL*15
   475         16  DC-GREG-DATE-1-MDY        PIC 9(06).                    CL*15
   476         16  DC-GREG-DATE-1-MDY-R REDEFINES                          CL*15
   477                      DC-GREG-DATE-1-MDY.                         ELCDATE
   478             20  DC-MDY-MONTH          PIC 99.                       CL*15
   479             20  DC-MDY-DAY            PIC 99.                       CL*15
   480             20  DC-MDY-YEAR           PIC 99.                       CL*15
   481         16  DC-GREG-DATE-1-ALPHA.                                   CL*15
   482             20  DC-ALPHA-MONTH        PIC X(10).                    CL*15
   483             20  DC-ALPHA-DAY          PIC 99.                       CL*15
   484             20  FILLER                PIC XX.                       CL*15
   485             20  DC-ALPHA-CENTURY.                                   CL*15
   486                 24 DC-ALPHA-CEN-N     PIC 99.                       CL*15
   487             20  DC-ALPHA-YEAR         PIC 99.                       CL*15
   488         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.           CL*15
   489         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.           CL*15
   490         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.           CL*15
   491         16  DC-JULIAN-DATE            PIC 9(05).                    CL*15
   492         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE                CL*20
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  11
* SUNATEX.cbl (/apps/prod/cid1p/copy/ELCDATE)
   493                                       PIC 9(05).                    CL*20
   494         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.                  CL*15
   495             20  DC-JULIAN-YEAR        PIC 99.                       CL*15
   496             20  DC-JULIAN-DAYS        PIC 999.                      CL*15
   497         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.       CL*15
   498         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.    CL*15
   499         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.    CL*15
   500     12  DATE-CONVERSION-VARIBLES.                                   CL*15
   501         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.            CL*15
   502         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.          CL*15
   503             20  FILLER                PIC 9(3).                     CL*15
   504             20  HOLD-CEN-1-CCYY.                                    CL*15
   505                 24  HOLD-CEN-1-CC     PIC 99.                       CL*17
   506                 24  HOLD-CEN-1-YY     PIC 99.                       CL*17
   507             20  HOLD-CEN-1-MO         PIC 99.                       CL*17
   508             20  HOLD-CEN-1-DA         PIC 99.                       CL*17
   509         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.            CL*15
   510             20  HOLD-CEN-1-R-MO       PIC 99.                       CL*17
   511             20  HOLD-CEN-1-R-DA       PIC 99.                       CL*17
   512             20  HOLD-CEN-1-R-CCYY.                                  CL*15
   513                 24  HOLD-CEN-1-R-CC   PIC 99.                       CL*17
   514                 24  HOLD-CEN-1-R-YY   PIC 99.                       CL*17
   515             20  FILLER                PIC 9(3).                     CL*15
   516         16  HOLD-CENTURY-1-X.                                       CL*15
   517             20  FILLER                PIC X(3)  VALUE SPACES.       CL*15
   518             20  HOLD-CEN-1-X-CCYY.                                  CL*15
   519                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.          CL*17
   520                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.          CL*17
   521             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.          CL*17
   522             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.          CL*17
   523         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.          CL*15
   524             20  HOLD-CEN-1-R-X-MO     PIC XX.                       CL*17
   525             20  HOLD-CEN-1-R-X-DA     PIC XX.                       CL*17
   526             20  HOLD-CEN-1-R-X-CCYY.                                CL*15
   527                 24  HOLD-CEN-1-R-X-CC PIC XX.                       CL*17
   528                 24  HOLD-CEN-1-R-X-YY PIC XX.                       CL*17
   529             20  FILLER                PIC XXX.                      CL*23
   530         16  DC-BIN-DATE-EXPAND-1      PIC XXX.                      CL*15
   531         16  DC-BIN-DATE-EXPAND-2      PIC XXX.                      CL*15
   532         16  DC-JULIAN-DATE-1          PIC 9(07).                    CL*15
   533         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.          CL*15
   534             20  DC-JULIAN-1-CCYY.                                   CL*15
   535                 24  DC-JULIAN-1-CC    PIC 99.                       CL*15
   536                 24  DC-JULIAN-1-YR    PIC 99.                       CL*15
   537             20  DC-JULIAN-DA-1        PIC 999.                      CL*15
   538         16  DC-JULIAN-DATE-2          PIC 9(07).                    CL*15
   539         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.          CL*15
   540             20  DC-JULIAN-2-CCYY.                                   CL*15
   541                 24  DC-JULIAN-2-CC    PIC 99.                       CL*15
   542                 24  DC-JULIAN-2-YR    PIC 99.                       CL*15
   543             20  DC-JULIAN-DA-2        PIC 999.                      CL*15
   544         16  DC-GREG-DATE-A-EDIT.                                    CL*15
   545             20  DC-EDITA-MONTH        PIC 99.                       CL*15
   546             20  SLASHA-1              PIC X VALUE '/'.              CL*15
   547             20  DC-EDITA-DAY          PIC 99.                       CL*15
   548             20  SLASHA-2              PIC X VALUE '/'.              CL*15
   549             20  DC-EDITA-CCYY.                                      CL*15
   550                 24  DC-EDITA-CENT     PIC 99.                       CL*15
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  12
* SUNATEX.cbl (/apps/prod/cid1p/copy/ELCDATE)
   551                 24  DC-EDITA-YEAR     PIC 99.                       CL*15
   552         16  DC-GREG-DATE-B-EDIT.                                    CL*15
   553             20  DC-EDITB-MONTH        PIC 99.                       CL*15
   554             20  SLASHB-1              PIC X VALUE '/'.              CL*15
   555             20  DC-EDITB-DAY          PIC 99.                       CL*15
   556             20  SLASHB-2              PIC X VALUE '/'.              CL*15
   557             20  DC-EDITB-CCYY.                                      CL*15
   558                 24  DC-EDITB-CENT     PIC 99.                       CL*15
   559                 24  DC-EDITB-YEAR     PIC 99.                       CL*15
   560         16  DC-GREG-DATE-CYMD         PIC 9(08).                    CL*15
   561         16  DC-GREG-DATE-CYMD-R REDEFINES                           CL*15
   562                              DC-GREG-DATE-CYMD.                  ELCDATE
   563             20  DC-CYMD-CEN           PIC 99.                       CL*15
   564             20  DC-CYMD-YEAR          PIC 99.                       CL*15
   565             20  DC-CYMD-MONTH         PIC 99.                       CL*15
   566             20  DC-CYMD-DAY           PIC 99.                       CL*15
   567         16  DC-GREG-DATE-MDCY         PIC 9(08).                    CL*15
   568         16  DC-GREG-DATE-MDCY-R REDEFINES                           CL*15
   569                              DC-GREG-DATE-MDCY.                  ELCDATE
   570             20  DC-MDCY-MONTH         PIC 99.                       CL*15
   571             20  DC-MDCY-DAY           PIC 99.                       CL*15
   572             20  DC-MDCY-CEN           PIC 99.                       CL*15
   573             20  DC-MDCY-YEAR          PIC 99.                       CL*15
   574    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.      ELCDATE
   575        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.        ELCDATE
   576    12  DC-EL310-DATE                  PIC X(21).                    CL*26
   577    12  FILLER                         PIC X(28).                    CL*26
   578
*  579                             COPY ERCRATE.
   580******************************************************************01/20/90
   581*                                                                *ERCRATE
   582*                                                                *ERCRATE
   583*                            ERCRATE                             *   LV007
   584*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   585*                            VMOD=2.008                          *   CL**7
   586*                                                                *ERCRATE
   587*   ONLINE CREDIT SYSTEM                                         *ERCRATE
   588*                                                                *ERCRATE
   589*   FILE DESCRIPTION = RATES MASTER FILE                         *ERCRATE
   590*                                                                *ERCRATE
   591*   FILE TYPE = VSAM,KSDS                                        *ERCRATE
   592*   RECORD SIZE = 1765  RECFORM = FIXED                          *ERCRATE
   593*                                                                *ERCRATE
   594*   BASE CLUSTER NAME = ERRATE                   RKP=2,LEN=28    *ERCRATE
   595*       ALTERNATE PATH = NONE                                    *ERCRATE
   596*                                                                *ERCRATE
   597*   LOG = NO                                                     *ERCRATE
   598*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *ERCRATE
   599*                                                                *ERCRATE
   600******************************************************************ERCRATE
   601                                                                  ERCRATE
   602 01  RATE-RECORD.                                                 ERCRATE
   603     12  RT-RECORD-ID                      PIC XX.                ERCRATE
   604         88  VALID-RT-ID                      VALUE 'RT'.         ERCRATE
   605                                                                  ERCRATE
   606     12  RT-CONTROL-PRIMARY.                                      ERCRATE
   607         16  RT-COMPANY-CD                 PIC X.                 ERCRATE
   608         16  RT-STATE-CODE.                                       ERCRATE
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  13
* SUNATEX.cbl (/apps/prod/cid1p/copy/ERCRATE)
   609             20  RT-ST-CODE                PIC XX.                ERCRATE
   610             20  RT-ST-CLASS               PIC XX.                ERCRATE
   611             20  RT-ST-DEV                 PIC XXX.               ERCRATE
   612         16  RT-L-AH-CODE.                                        ERCRATE
   613             20  RT-L-AH                   PIC X.                 ERCRATE
   614             20  RT-LAH-NUM                PIC XX.                   CL**3
   615         16  RT-LIMITS.                                           ERCRATE
   616             20  RT-HIGH-AGE               PIC 99.                ERCRATE
   617             20  RT-HIGH-AMT               PIC 9(6).              ERCRATE
   618             20  RT-FUTURE                 PIC XX.                ERCRATE
   619             20  RT-SEX                    PIC X.                 ERCRATE
   620         16  RT-EXPIRY-DATE                PIC 9(11)  COMP-3.     ERCRATE
   621                                                                  ERCRATE
   622     12  RT-MAINT-INFORMATION.                                    ERCRATE
   623         16  RT-LAST-MAINT-DT              PIC XX.                ERCRATE
   624         16  RT-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3. ERCRATE
   625         16  RT-LAST-MAINT-USER            PIC X(4).              ERCRATE
   626         16  FILLER                        PIC X(10).             ERCRATE
   627                                                                  ERCRATE
   628     12  RT-STRUCTURE-COMMENT              PIC X(50).             ERCRATE
   629     12  RT-RATE-COMMENT                   PIC X(50).             ERCRATE
   630                                                                  ERCRATE
   631     12  CSL-RESERVED                      PIC X(10).                CL**7
   632     12  FILLER                            PIC X(12).                CL**7
   633                                                                  ERCRATE
   634     12  RT-MAX-AGE                        PIC 99.                ERCRATE
   635                                                                  ERCRATE
   636     12  RT-LIFE-LIMS-FLDS.                                       ERCRATE
   637         16  RT-LIFE-MORT-CODE             PIC X(4).              ERCRATE
   638         16  RT-LIFE-EXCEPTIONS   OCCURS 8 TIMES.                 ERCRATE
   639             20  RT-L-EX-AGE               PIC 99.                ERCRATE
   640             20  RT-L-EX-TERM              PIC S999       COMP-3. ERCRATE
   641             20  RT-L-EX-FACE              PIC S9(7)      COMP-3. ERCRATE
   642         16  FILLER                        PIC X(20).             ERCRATE
   643                                                                  ERCRATE
   644     12  RT-AH-LIMS-FLDS   REDEFINES   RT-LIFE-LIMS-FLDS.         ERCRATE
   645         16  RT-AH-EXCEPTIONS   OCCURS 8 TIMES.                   ERCRATE
   646             20  RT-AH-AGE                 PIC 99.                ERCRATE
   647             20  RT-AH-TERM                PIC S999       COMP-3. ERCRATE
   648             20  RT-AH-BEN-M               PIC S9(5)      COMP-3. ERCRATE
   649             20  RT-AH-BEN-F               PIC S9(7)      COMP-3. ERCRATE
   650                                                                  ERCRATE
   651     12  RT-LIFE-RATES.                                           ERCRATE
   652         16  RT-L-RATE  OCCURS 360 TIMES   PIC S99V9(5)   COMP-3. ERCRATE
   653                                                                  ERCRATE
   654     12  RT-AH-RATES   REDEFINES   RT-LIFE-RATES.                 ERCRATE
   655         16  RT-AH-RATE  OCCURS 360 TIMES  PIC S99V9(5)   COMP-3. ERCRATE
   656                                                                  ERCRATE
   657     12  RT-DAILY-RATE                     PIC S99V9(5)   COMP-3.    CL**2
   658                                                                     CL**2
   659     12  RT-DISCOUNT-OPTION                PIC X.                    CL**5
   660         88  RT-DO-NOT-USE                     VALUE ' '.            CL**5
   661         88  RT-USE-DISCOUNT-FACTOR            VALUE '1'.            CL**5
   662         88  RT-USE-APR-AS-DISCOUNT            VALUE '2'.            CL**5
   663                                                                     CL**5
   664     12  RT-DISCOUNT-RATE                  PIC S99V9(5)   COMP-3.    CL**5
   665     12  RT-DISCOUNT-OB-RATE               PIC S99V9(5)   COMP-3.    CL**5
   666                                                                     CL**5
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  14
* SUNATEX.cbl (/apps/prod/cid1p/copy/ERCRATE)
   667     12  RT-COMPOSITE-OPTION               PIC X.                    CL**6
   668         88  RT-NO-COMPOSITE                   VALUE ' '.            CL**6
   669         88  RT-USE-COMPOSITE-RATE             VALUE '1'.            CL**6
   670                                                                     CL**6
   671     12  RT-COMPOSITE-RATE                 PIC S99V9(5)   COMP-3.    CL**6
   672                                                                     CL**6
   673     12  RT-POLICY-FEE                     PIC S9(3)V99   COMP-3.    CL**7
   674     12  FILLER                            PIC X(13).                CL**7
   675                                                                     CL**4
   676     12  RT-TYPE-RATE                      PIC X.                    CL**4
   677         88  RT-IS-STND                        VALUE ' ' 'S'.        CL**4
   678         88  RT-IS-OB                          VALUE 'O'.            CL**4
   679                                                                  ERCRATE
   680     12  RT-SRT-ALPHA                      PIC X.                 ERCRATE
   681                                                                  ERCRATE
   682     12  RT-CONTROL-2.                                            ERCRATE
   683         16  RTC-1                         PIC X(7).              ERCRATE
   684         16  RTC-3                         PIC X(11).             ERCRATE
   685         16  RTC-4                         PIC 9(11) COMP-3.      ERCRATE
   686         16  RTC-2                         PIC X(3).              ERCRATE
   687******************************************************************ERCRATE
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  15
* SUNATEX.cbl
   689 LINKAGE SECTION.
   690
*  691                             COPY ELCCALC.
   692******************************************************************04/15/98
   693*                                                                *ELCCALC
   694*                           ELCCALC.                            *    LV003
   695*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
   696*                            VMOD=2.025                          *   CL**3
   697*                                                                *   CL**2
   698*   DESCRIPTION:  DATA TO BE PASSED TO REMAINING TERM ROUTINE    *   CL**2
   699*                 REMAINING AMOUNT ROUTINE, LOSS RESERVE ROUTINE *   CL**2
   700*                 REFUND CALCULATIONS ROUTINE, EARNINGS CALCU -  *   CL**2
   701*                 LATIONS ROUTINE, AND THE RATING ROUTINE.       *   CL**2
   702*                                                                *   CL**2
   703*  PASSED TO ELRTRM                                              *   CL**2
   704*  -----------------                                             *   CL**2
   705*  METHOD CODE (I.E. FULL MONTH, HALF ADJ, ETC)                  *   CL**2
   706*  ORIGINAL TERM                                                 *   CL**2
   707*  BEGINNING DATE                                                *   CL**2
   708*  ENDING DATE                                                   *   CL**2
   709*  COMPANY I.D.                                                  *   CL**2
   710*  ACCOUNT MASTER USER FIELD                                     *   CL**2
   711*  PROCESS SWITCH (CANCEL, CLAIM)                                *   CL**2
   712*  FREE LOOK DAYS                                                *   CL**2
   713*                                                                *   CL**2
   714*  RETURNED FROM ELRTRM                                          *   CL**2
   715*  ---------------------                                         *   CL**2
   716*  REMAINING TERM 1 - USED FOR EARNINGS                          *   CL**2
   717*  REMAINING TERM 2 - USED FOR BENEFIT CALCULATIONS              *   CL**2
   718*  REMAINING TERM 3 - USED FOR CLAIM BENEFITS                    *   CL**2
   719*  ODD DAYS - REMAINING DAYS PAST FULL MONTHS                    *   CL**2
   720*----------------------------------------------------------------*   CL**2
   721*  PASSED TO ELRAMT                                              *   CL**2
   722*  ----------------                                              *   CL**2
   723*  REMAINING TERM 1 OR 2 OR 3 (FROM ELRTRM)                      *   CL**2
   724*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *   CL**2
   725*  ORIGINAL AMOUNT                                               *   CL**2
   726*  ALTERNATE BENEFIT (BALLON)                                    *   CL**2
   727*  A.P.R. - NET PAY ONLY                                         *   CL**2
   728*  METHOD                                                            CL**2
   729*  PAYMENT FREQUENCY - FOR FARM PLAN                             *   CL**2
   730*  COMPANY I.D.                                                  *   CL**2
   731*  BENEFIT TYPE                                                  *   CL**2
   732*                                                                *   CL**2
   733*  RETURNED FROM ELRAMT                                          *   CL**2
   734*  --------------------                                          *   CL**2
   735*  REMAINING AMOUNT 1 - CURRENT                                  *   CL**2
   736*  REMAINING AMOUNT 2 - PREVIOUS MONTH                           *   CL**2
   737*  REMAINING AMOUNT FACTOR                                           CL**2
   738*----------------------------------------------------------------*   CL**2
   739*  PASSED TO ELRESV                                              *   CL**2
   740*  -----------------                                             *   CL**2
   741*  CERTIFICATE EFFECTIVE DATE                                    *   CL**2
   742*  VALUATION DATE                                                *   CL**2
   743*  PAID THRU DATE                                                *   CL**2
   744*  BENEFIT                                                       *   CL**2
   745*  INCURRED DATE                                                 *   CL**2
   746*  REPORTED DATE                                                 *   CL**2
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  16
* SUNATEX.cbl (/apps/prod/cid1p/copy/ELCCALC)
   747*  ISSUE AGE                                                     *   CL**2
   748*  TERM                                                          *   CL**2
   749*  CDT PERCENT                                                   *   CL**2
   750*  CDT METHOD (I.E. INTERPOLATED, AVERAGE, ETC)                  *   CL**2
   751* *CLAIM TYPE (LIFE, A/H)                                        *   CL**2
   752* *REMAINING BENEFIT (FROM ELRAMT)                               *   CL**2
   753* *ONLY FIELDS REQUIRED FOR LIFE CLAIMS                          *   CL**2
   754*                                                                *   CL**2
   755*  RETURNED FROM ELRESV                                          *   CL**2
   756*  --------------------                                          *   CL**2
   757*  CDT TABLE USED                                                *   CL**2
   758*  CDT FACTOR USED                                               *   CL**2
   759*  PAY TO CURRENT RESERVE                                        *   CL**2
   760*  I.B.N.R. - A/H ONLY                                           *   CL**2
   761*  FUTURE (ACCRUED) AH ONLY                                      *   CL**2
   762*----------------------------------------------------------------*   CL**2
   763*  PASSED TO ELRATE                                              *   CL**2
   764*  ----------------                                              *   CL**2
   765*  CERT ISSUE DATE                                               *   CL**2
   766*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *   CL**2
   767*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *   CL**2
   768*  CAPPED TERM   (ONLY FOR TRUNCATED LIFE)                       *   CL**2
   769*  STATE CODE (CLIENT DEFINED)                                   *   CL**2
   770*  STATE CODE (STANDARD P.O. ABBRV)                              *   CL**2
   771*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *   CL**2
   772*  DEVIATION CODE                                                *   CL**2
   773*  ISSUE AGE                                                     *   CL**2
   774*  ORIGINAL BENEFIT AMOUNT                                       *   CL**2
   775*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *   CL**2
   776*  PROCESS TYPE (ISSUE OR CANCEL)                                *   CL**2
   777*  BENEFIT KIND (LIFE OR A/H)                                    *   CL**2
   778*  A.P.R.                                                        *   CL**2
   779*  METHOD                                                            CL**2
   780*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *   CL**2
   781*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *   CL**2
   782*  COMPANY I.D. (3 CHARACTER)                                    *   CL**2
   783*  BENEFIT CODE                                                  *   CL**2
   784*  BENEFIT OVERRIDE CODE                                         *   CL**2
   785*  MAXIMUM MONTHLY BENEFIT (FROM ACCT MASTER - CSL ONLY)         *   CL**2
   786*  MAXIMUM TOTAL BENEFIT (FROM ACCT MASTER - CSL ONLY)           *   CL**2
   787*  JOINT INDICATOR (CSL ONLY)                                    *   CL**2
   788*  FIRST PAYMENT DATE (CSL ONLY)                                 *   CL**2
   789*  PERIODIC PAYMENT AMOUNT (IN CP-REMAINING-TERM - CSL ONLY)     *   CL**2
   790*                                                                *   CL**2
   791*  RETURNED FROM ELRATE                                          *   CL**2
   792*  --------------------                                          *   CL**2
   793*  CALCULATED PREMIUM                                            *   CL**2
   794*  PREMIUM RATE                                                  *   CL**2
   795*  MORTALITY CODE                                                *   CL**2
   796*  MAX ATTAINED AGE                                              *   CL**2
   797*  MAX AGE                                                       *   CL**2
   798*  MAX TERM                                                      *   CL**2
   799*  MAX MONTHLY BENEFIT                                           *   CL**2
   800*  MAX TOTAL BENIFIT                                             *   CL**2
   801*  COMPOSITE RATE (OPEN-END ONLY)                                *   CL**2
   802*----------------------------------------------------------------*   CL**2
   803*  PASSED TO ELRFND                                              *   CL**2
   804*  ----------------                                              *   CL**2
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  17
* SUNATEX.cbl (/apps/prod/cid1p/copy/ELCCALC)
   805*  CERT ISSUE DATE                                               *   CL**2
   806*  REFUND DATE                                                   *   CL**2
   807*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *   CL**2
   808*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *   CL**2
   809*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *   CL**2
   810*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *   CL**2
   811*  STATE CODE (CLIENT DEFINED)                                   *   CL**2
   812*  STATE CODE (STANDARD P.O. ABBRV)                              *   CL**2
   813*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *   CL**2
   814*  DEVIATION CODE                                                *   CL**2
   815*  ISSUE AGE                                                     *   CL**2
   816*  ORIGINAL BENEFIT AMOUNT                                       *   CL**2
   817*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *   CL**2
   818*  PROCESS TYPE (CANCEL)                                         *   CL**2
   819*  BENEFIT KIND (LIFE OR A/H)                                    *   CL**2
   820*  A.P.R.                                                        *   CL**2
   821*  EARNING METHOD - (CODE FROM BENEFIT, STATE OR ACCOUNT RECORD) *   CL**2
   822*  RATING METHOD -  (CODE FROM BENEFIT)                          *   CL**2
   823*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *   CL**2
   824*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *   CL**2
   825*  COMPANY I.D. (3 CHARACTER)                                    *   CL**2
   826*  BENEFIT CODE                                                  *   CL**2
   827*  BENEFIT OVERRIDE CODE                                         *   CL**2
   828*                                                                *   CL**2
   829*  RETURNED FROM ELRFND                                          *   CL**2
   830*  --------------------                                          *   CL**2
   831*  CALCULATED REFUND                                             *   CL**2
   832*----------------------------------------------------------------*   CL**2
   833*  PASSED TO ELEARN                                              *   CL**2
   834*  ----------------                                              *   CL**2
   835*  CERT ISSUE DATE                                               *   CL**2
   836*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *   CL**2
   837*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *   CL**2
   838*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *   CL**2
   839*  STATE CODE (CLIENT DEFINED)                                   *   CL**2
   840*  STATE CODE (STANDARD P.O. ABBRV)                              *   CL**2
   841*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *   CL**2
   842*  DEVIATION CODE                                                *   CL**2
   843*  ISSUE AGE                                                     *   CL**2
   844*  ORIGINAL BENEFIT AMOUNT                                       *   CL**2
   845*  BENEFIT KIND (LIFE OR A/H)                                    *   CL**2
   846*  A.P.R.                                                        *   CL**2
   847*  METHOD - (EARNING CODE FROM BENEFIT RECORD)                   *   CL**2
   848*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *   CL**2
   849*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *   CL**2
   850*  COMPANY I.D. (3 CHARACTER)                                    *   CL**2
   851*  BENEFIT CODE                                                  *   CL**2
   852*  BENEFIT OVERRIDE CODE                                         *   CL**2
   853*                                                                *   CL**2
   854*  RETURNED FROM ELEARN                                          *   CL**2
   855*  --------------------                                          *   CL**2
   856*  INDICATED  EARNINGS                                           *   CL**2
   857*----------------------------------------------------------------*   CL**2
   858*                 LENGTH = 450                                   *   CL**2
   859*                                                                *   CL**2
   860******************************************************************   CL**2
   861******************************************************************
   862*                   C H A N G E   L O G
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  18
* SUNATEX.cbl (/apps/prod/cid1p/copy/ELCCALC)
   863*
   864* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   865*-----------------------------------------------------------------
   866*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   867* EFFECTIVE    NUMBER
   868*-----------------------------------------------------------------
   869* 010303    2001061800003  PEMA  ADD DCC/MONTHLY PROCESSING
   870* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
   871* 101807    2007100100007  PEMA  EXPAND CLM RESERVE FIELDS
   872* 010410    2008021200005  PEMA  ADD FIELDS FOR MN NET PAY BALLOON
   873* 010410    2009050700003  PEMA  ADD FIELDS FOR SPP-DD
   874* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
   875* 041710    2007111300001  AJRA  ADD CLAIM CALC SW FOR SC NP+6
   876* 101110  CR2010012700001  PEMA ADD DDF REFUND/UEP PROCESSING
   877* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
   878* 040615  CR2013072200002  PEMA  ADD EXTRA PERIODS
   879******************************************************************
   880                                                                     CL**2
   881 01  CALCULATION-PASS-AREA.                                          CL**2
   882     12  CP-COMM-LENGTH            PIC S9(4)         VALUE +450      CL**2
   883                                     COMP.                           CL**2
   884                                                                     CL**2
   885     12  CP-RETURN-CODE            PIC X             VALUE ZERO.     CL**2
   886       88  NO-CP-ERROR                             VALUE ZERO.       CL**2
   887       88  CP-ERROR-OCCURED VALUE '1' '2' '3' '4' '5' '6' '7' '8'    CL**2
   888                                  '9' 'A' 'B' 'C' 'D' 'E' 'H'.       CL**2
   889       88  CP-ERROR-IN-AMOUNTS                     VALUE '1'.        CL**2
   890       88  CP-ERROR-IN-DATES                       VALUE '2'.        CL**2
   891       88  CP-ERROR-IN-OPTIONS                     VALUE '3'.        CL**2
   892       88  CP-ERROR-IN-TERMS                       VALUE '4'.        CL**2
   893       88  CP-ERROR-IN-FREQUENCY                   VALUE '5'.        CL**2
   894       88  CP-ERROR-RATE-NOT-FOUND                 VALUE '6'.        CL**2
   895       88  CP-ERROR-RATE-IS-ZERO                   VALUE '7'.        CL**2
   896       88  CP-ERROR-AMT-OUTSIDE-LIMIT              VALUE '8'.        CL**2
   897       88  CP-ERROR-TERM-OUTSIDE-LIMIT             VALUE '9'.        CL**2
   898       88  CP-ERROR-AGE-OUTSIDE-LIMIT              VALUE 'A'.        CL**2
   899       88  CP-ERROR-ATT-OUTSIDE-LIMIT              VALUE 'B'.        CL**2
   900       88  CP-ERROR-TOT-OUTSIDE-LIMIT              VALUE 'C'.        CL**2
   901       88  CP-ERROR-RATE-FILE-NOTOPEN              VALUE 'D'.        CL**2
   902       88  CP-ERROR-ISSUE-AGE-ZERO                 VALUE 'E'.        CL**2
   903       88  CP-ERROR-NO-LIMITS-CRI                  VALUE 'F'.        CL**2
   904       88  CP-ERROR-DIV-BY-ZERO                    VALUE 'G'.        CL**2
   905       88  CP-ERROR-LOAN-TERM                      VALUE 'H'.        CL**2
   906                                                                     CL**2
   907     12  CP-RETURN-CODE-2          PIC X             VALUE ZERO.     CL**2
   908       88  NO-CP-ERROR-2                           VALUE ZERO.       CL**2
   909***********************  INPUT AREAS ****************************    CL**2
   910                                                                     CL**2
   911     12  CP-CALCULATION-AREA.                                        CL**2
   912         16  CP-ACCOUNT-NUMBER     PIC X(10)       VALUE SPACES.     CL**2
   913         16  CP-CERT-EFF-DT        PIC XX.                           CL**2
   914         16  CP-VALUATION-DT       PIC XX.                           CL**2
   915         16  CP-PAID-THRU-DT       PIC XX.                           CL**2
   916         16  CP-BENEFIT-TYPE       PIC X.                            CL**2
   917           88  CP-AH                               VALUE 'A' 'D'     CL**2
   918                                                   'I' 'U'.          CL**2
   919           88  CP-REDUCING-LIFE                    VALUE 'R'.        CL**2
   920           88  CP-LEVEL-LIFE                       VALUE 'L' 'P'.    CL**2
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  19
* SUNATEX.cbl (/apps/prod/cid1p/copy/ELCCALC)
   921         16  CP-INCURRED-DT        PIC XX.                           CL**2
   922         16  CP-REPORTED-DT        PIC XX.                           CL**2
   923         16  CP-ACCT-FLD-5         PIC XX            VALUE SPACE.    CL**2
   924         16  CP-COMPANY-ID         PIC XXX           VALUE SPACE.    CL**2
   925         16  CP-ISSUE-AGE          PIC S9(3)         VALUE ZERO      CL**2
   926                                     COMP-3.                         CL**2
   927         16  CP-CDT-PERCENT        PIC S9(3)V99      VALUE ZERO      CL**2
   928                                     COMP-3.                         CL**2
   929         16  CP-CDT-METHOD         PIC X.                            CL**2
   930           88  CP-CDT-ROUND-NEAR                   VALUE '1'.        CL**2
   931           88  CP-CDT-ROUND-HIGH                   VALUE '2'.        CL**2
   932           88  CP-CDT-INTERPOLATED                 VALUE '3'.        CL**2
   933         16  CP-CLAIM-TYPE         PIC X.                            CL**2
   934           88  CP-AH-CLAIM                         VALUE 'A'.        CL**2
   935           88  CP-LIFE-CLAIM                       VALUE 'L'.        CL**2
   936         16  CP-ORIGINAL-TERM      PIC S9(3)         VALUE ZERO      CL**2
   937                                     COMP-3.                         CL**2
   938         16  CP-ORIGINAL-BENEFIT   PIC S9(9)V99      VALUE ZERO      CL**2
   939                                     COMP-3.                         CL**2
   940         16  CP-ORIGINAL-PREMIUM   PIC S9(7)V99      VALUE ZERO      CL**2
   941                                     COMP-3.                         CL**2
   942         16  CP-REMAINING-TERM     PIC S9(3)V99      VALUE ZERO      CL**2
   943                                     COMP-3.                         CL**2
   944         16  CP-REMAINING-BENEFIT  PIC S9(9)V99      VALUE ZERO      CL**2
   945                                     COMP-3.                         CL**2
   946         16  CP-LOAN-APR           PIC S9(3)V9(4)    VALUE ZERO      CL**2
   947                                     COMP-3.                         CL**2
   948         16  CP-PAY-FREQUENCY      PIC S9(3)         VALUE ZERO      CL**2
   949                                     COMP-3.                         CL**2
   950         16  CP-REM-TERM-METHOD    PIC X.                            CL**2
   951           88  CP-EARN-AFTER-15TH                  VALUE '1'.        CL**2
   952           88  CP-EARN-ON-HALF-MONTH               VALUE '2'.        CL**2
   953           88  CP-EARN-ON-1ST-DAY                  VALUE '3'.        CL**2
   954           88  CP-EARN-ON-FULL-MONTH               VALUE '4'.        CL**2
   955           88  CP-EARN-WITH-NO-DAYS                VALUE '5'.        CL**2
   956           88  CP-EARN-AFTER-14TH                  VALUE '6'.        CL**2
   957           88  CP-EARN-AFTER-16TH                  VALUE '7'.        CL**2
   958         16  CP-EARNING-METHOD     PIC X.                            CL**2
   959           88  CP-EARN-BY-R78                      VALUE '1' 'R'.    CL**2
   960           88  CP-EARN-BY-PRORATA                  VALUE '2' 'P'.    CL**2
   961           88  CP-EARN-AS-CALIF                    VALUE '3' 'C'.    CL**2
   962           88  CP-EARN-AS-TEXAS                    VALUE '4' 'T'.    CL**2
   963           88  CP-EARN-AS-FARM-PLAN                VALUE '4' 'T'.    CL**2
   964           88  CP-EARN-AS-NET-PAY                  VALUE '5' 'N'.    CL**2
   965           88  CP-EARN-ANTICIPATION                VALUE '6' 'A'.    CL**2
   966           88  CP-EARN-AS-MEAN                     VALUE '8' 'M'.    CL**2
   967           88  CP-EARN-AS-SUM-OF-DIGITS            VALUE '9'.        CL**2
   968           88  CP-EARN-AS-REG-BALLOON              VALUE 'B'.        CL**2
   969           88  CP-GAP-NON-REFUNDABLE               VALUE 'G'.
   970           88  CP-GAP-ACTUARIAL                    VALUE 'S'.
   971           88  CP-DCC-SPP-DDF                      VALUE 'D' 'I'.
   972           88  CP-DCC-SPP-DDF-IU                   VALUE 'I'.
   973         16  CP-PROCESS-TYPE       PIC X.                            CL**2
   974           88  CP-CLAIM                            VALUE '1'.        CL**2
   975           88  CP-CANCEL                           VALUE '2'.        CL**2
   976           88  CP-ISSUE                            VALUE '3'.        CL**2
   977         16  CP-SPECIAL-CALC-CD    PIC X.                            CL**2
   978           88  CP-OUTSTANDING-BAL              VALUE 'O'.            CL**2
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  20
* SUNATEX.cbl (/apps/prod/cid1p/copy/ELCCALC)
   979           88  CP-1-MTH-INTEREST               VALUE ' '.            CL**2
   980           88  CP-0-MTH-INTEREST               VALUE 'A'.            CL**2
   981           88  CP-OB-OFFLINE-RESERVED          VALUE 'B'.            CL**2
   982           88  CP-CRITICAL-PERIOD              VALUE 'C'.            CL**2
   983           88  CP-TERM-IS-DAYS                 VALUE 'D'.            CL**2
   984           88  CP-USE-PREM-AS-ENTERED          VALUE 'E'.            CL**2
   985           88  CP-FARM-PLAN                    VALUE 'F'.            CL**2
   986           88  CP-RATE-AS-STANDARD             VALUE 'G'.            CL**2
   987           88  CP-2-MTH-INTEREST               VALUE 'I'.            CL**2
   988           88  CP-3-MTH-INTEREST               VALUE 'J'.            CL**2
   989           88  CP-4-MTH-INTEREST               VALUE 'K'.            CL**2
   990           88  CP-BALLOON-LAST-PMT             VALUE 'L'.            CL**2
   991           88  CP-MORTGAGE-REC                 VALUE 'M'.            CL**2
   992           88  CP-OUTSTANDING-BALANCE          VALUE 'O'.            CL**2
   993           88  CP-NET-PAY-PRUDENTIAL           VALUE 'P'.            CL**2
   994           88  CP-NET-PAY-SIMPLE               VALUE 'S'.            CL**2
   995           88  CP-TRUNCATED-LIFE               VALUE 'T' 'U' 'V'     CL**2
   996                                                     'W' 'X'.        CL**2
   997           88  CP-TRUNCATE-0-MTH               VALUE 'T'.            CL**2
   998           88  CP-TRUNCATE-1-MTH               VALUE 'U'.            CL**2
   999           88  CP-TRUNCATE-2-MTH               VALUE 'V'.            CL**2
  1000           88  CP-TRUNCATE-3-MTH               VALUE 'W'.            CL**2
  1001           88  CP-TRUNCATE-4-MTH               VALUE 'X'.            CL**2
  1002           88  CP-SUMMARY-REC                  VALUE 'Z'.            CL**2
  1003           88  CP-PROPERTY-BENEFIT             VALUE '2'.            CL**2
  1004           88  CP-UNEMPLOYMENT-BENEFIT         VALUE '3'.            CL**2
  1005           88  CP-AD-D-BENEFIT                 VALUE '4'.            CL**2
  1006           88  CP-CSL-METH-1                   VALUE '5'.            CL**2
  1007           88  CP-CSL-METH-2                   VALUE '6'.            CL**2
  1008           88  CP-CSL-METH-3                   VALUE '7'.            CL**2
  1009           88  CP-CSL-METH-4                   VALUE '8'.            CL**2
  1010                                                                     CL**2
  1011         16  CP-LOAN-TERM          PIC S9(3)       VALUE ZERO        CL**2
  1012                                     COMP-3.                         CL**2
  1013         16  CP-CLASS-CODE         PIC XX          VALUE ZERO.       CL**2
  1014         16  CP-DEVIATION-CODE     PIC XXX         VALUE ZERO.       CL**2
  1015         16  CP-STATE              PIC XX          VALUE SPACE.      CL**2
  1016         16  CP-STATE-STD-ABBRV    PIC XX          VALUE SPACE.      CL**2
  1017         16  CP-BENEFIT-CD         PIC XX          VALUE ZERO.       CL**2
  1018           88  CP-CSL-VALID-NP-BENEFIT-CD VALUES '12' '13'           CL**2
  1019               '34' '35' '36' '37' '44' '45' '46' '47' '72' '73'.    CL**2
  1020         16  CP-R78-OPTION         PIC X.                            CL**2
  1021           88  CP-TERM-TIMES-TERM-PLUS-1           VALUE ' '.        CL**2
  1022           88  CP-TERM-TIMES-TERM                  VALUE '1'.        CL**2
  1023                                                                     CL**2
  1024         16  CP-COMPANY-CD         PIC X             VALUE SPACE.    CL**2
  1025         16  CP-IBNR-RESERVE-SW    PIC X.                            CL**2
  1026         16  CP-CLAIM-STATUS       PIC X.                            CL**2
  1027         16  CP-RATE-FILE          PIC X.                            CL**2
  1028         16  CP-TERM-OR-EXT-DAYS   PIC S9(05)        VALUE ZERO      CL**2
  1029                                     COMP-3.                         CL**2
  1030                                                                     CL**2
  1031         16  CP-LIFE-OVERRIDE-CODE PIC X.                            CL**2
  1032         16  CP-AH-OVERRIDE-CODE   PIC X.                            CL**2
  1033                                                                     CL**2
  1034         16  CP-RATE-DEV-PCT       PIC S9V9(6)       VALUE ZERO      CL**2
  1035                                     COMP-3.
  1036         16  CP-CLP-RATE-UP        REDEFINES CP-RATE-DEV-PCT
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  21
* SUNATEX.cbl (/apps/prod/cid1p/copy/ELCCALC)
  1037                                   PIC S9(5)V99 COMP-3.
  1038         16  CP-CRITICAL-MONTHS    PIC S9(3)         VALUE ZERO      CL**2
  1039                                     COMP-3.                         CL**2
  1040         16  CP-ALTERNATE-BENEFIT  PIC S9(9)V99      VALUE ZERO      CL**2
  1041                                     COMP-3.                         CL**2
  1042         16  CP-ALTERNATE-PREMIUM  PIC S9(7)V99      VALUE ZERO      CL**2
  1043                                     COMP-3.
  1044         16  CP-DDF-CSO-ADMIN-FEE REDEFINES CP-ALTERNATE-PREMIUM
  1045                                  PIC S9(7)V99 COMP-3.
  1046                                                                     CL**2
  1047         16  CP-PAID-FROM-DATE     PIC X(02).                        CL**2
  1048         16  CP-CLAIM-CALC-METHOD  PIC X(01).                        CL**2
  1049         16  CP-EXT-DAYS-CALC      PIC X.                            CL**2
  1050           88  CP-EXT-NO-CHG                   VALUE ' '.            CL**2
  1051           88  CP-EXT-CHG-LF                   VALUE '1'.            CL**2
  1052           88  CP-EXT-CHG-AH                   VALUE '2'.            CL**2
  1053           88  CP-EXT-CHG-LF-AH                VALUE '3'.            CL**2
  1054         16  CP-DOMICILE-STATE     PIC XX.                           CL**2
  1055         16  CP-CARRIER            PIC X.                            CL**2
  1056         16  CP-REIN-FLAG          PIC X.                            CL**2
  1057         16  CP-REM-TRM-CALC-OPTION PIC X.                           CL**2
  1058           88  VALID-REM-TRM-CALC-OPTION    VALUE '1'                CL**2
  1059                      '2' '3' '4' '5'.                               CL**2
  1060           88  CP-CALC-OPTION-DEFAULT       VALUE '4'.               CL**2
  1061           88  CP-CONSIDER-EXTENSION        VALUE '3' '4' '5'.       CL**2
  1062           88  CP-30-DAY-MONTH              VALUE '1' '3' '5'.       CL**2
  1063           88  CP-NO-EXT-30-DAY-MONTH       VALUE '1'.               CL**2
  1064           88  CP-NO-EXT-ACTUAL-DAYS        VALUE '2'.               CL**2
  1065           88  CP-EXT-30-DAY-MONTH          VALUE '3'.               CL**2
  1066           88  CP-EXT-ACTUAL-DAYS           VALUE '4'.               CL**2
  1067           88  CP-USE-EXP-AND-1ST-PMT       VALUE '5'.
  1068         16  CP-SIG-SWITCH         PIC X.                            CL**2
  1069         16  CP-RATING-METHOD      PIC X.                            CL**2
  1070           88  CP-RATE-AS-R78                      VALUE '1' 'R'.    CL**2
  1071           88  CP-RATE-AS-PRORATA                  VALUE '2' 'P'.    CL**2
  1072           88  CP-RATE-AS-CALIF                    VALUE '3' 'C'.    CL**2
  1073           88  CP-RATE-AS-TEXAS                    VALUE '4' 'T'.    CL**2
  1074           88  CP-RATE-AS-FARM-PLAN                VALUE '4' 'T'.    CL**2
  1075           88  CP-RATE-AS-NET-PAY                  VALUE '5' 'N'.    CL**2
  1076           88  CP-RATE-AS-ANTICIPATION             VALUE '6' 'A'.    CL**2
  1077           88  CP-RATE-AS-MEAN                     VALUE '8' 'M'.    CL**2
  1078           88  CP-RATE-AS-REG-BALLOON              VALUE 'B'.        CL**2
  1079         16  CP-SALES-TAX          PIC S9V9999     VALUE  ZEROS      CL**2
  1080                                     COMP-3.                         CL**2
  1081         16  CP-BEN-CATEGORY       PIC X.
  1082         16  CP-DCC-LF-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  1083         16  CP-DCC-ACT-COMM REDEFINES CP-DCC-LF-RATE
  1084                                   PIC S99V9(5) COMP-3.
  1085         16  CP-DCC-AH-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  1086         16  CP-DCC-PMF-COMM REDEFINES CP-DCC-AH-RATE
  1087                                   PIC S99V9(5) COMP-3.
  1088         16  CP-DAYS-TO-1ST-PMT    PIC S999     COMP-3 VALUE +0.
  1089         16  CP-AH-BALLOON-SW      PIC X  VALUE ' '.
  1090         16  CP-EXPIRE-DT          PIC XX.
  1091         16  CP-LF-CLAIM-CALC-SW   PIC X  VALUE ' '.
  1092         16  CP-DDF-HI-FACT        PIC S9V999   COMP-3 VALUE +0.
  1093         16  CP-DDF-LO-FACT        PIC S9V999   COMP-3 VALUE +0.
  1094         16  CP-DDF-CLP            PIC S9(5)V99 COMP-3 VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  22
* SUNATEX.cbl (/apps/prod/cid1p/copy/ELCCALC)
  1095         16  CP-DDF-SPEC-CALC      PIC X.
  1096             88  CP-CALC-GROSS-FEE        VALUE 'G'.
  1097             88  CP-CALC-CLP              VALUE 'C'.
  1098         16  CP-IU-RATE-UP         PIC S9(5)V99   COMP-3 VALUE +0.
  1099         16  CP-CANCEL-REASON      PIC X.
  1100         16  CP-DDF-ADMIN-FEES     PIC S9(5)V99 COMP-3 VALUE +0.
  1101         16  CP-PMT-MODE           PIC X.
  1102         16  CP-NO-OF-PMTS         PIC S999 COMP-3 VALUE +0.
  1103         16  CP-1ST-YR-ALLOW       PIC S999V99 COMP-3 VALUE +0.
  1104         16  CP-DDF-COMM-AND-MFEE  PIC S9(5)V99 COMP-3 VALUE +0.
  1105         16  CP-DDF-YR1AF          PIC S9(5)V99 COMP-3 VALUE +0.
  1106         16  FILLER                PIC X.
  1107                                                                     CL**2
  1108***************    OUTPUT FROM ELRESV   ************************     CL**2
  1109                                                                     CL**2
  1110         16  CP-CDT-TABLE          PIC 9             VALUE ZERO.     CL**2
  1111                                                                     CL**2
  1112         16  CP-CDT-FACTOR         PIC S9(5)V9(6)    VALUE ZERO      CL**2
  1113                                     COMP-3.                         CL**2
  1114         16  CP-PTC-RESERVE        PIC S9(7)V99   VALUE ZERO         CL**2
  1115                                     COMP-3.                         CL**2
  1116         16  CP-IBNR-RESERVE       PIC S9(7)V99   VALUE ZERO         CL**2
  1117                                     COMP-3.                         CL**2
  1118         16  CP-FUTURE-RESERVE     PIC S9(7)V99   VALUE ZERO         CL**2
  1119                                     COMP-3.                         CL**2
  1120         16  FILLER                PIC X(09).                        CL**2
  1121***************    OUTPUT FROM ELRTRM   *************************    CL**2
  1122                                                                     CL**2
  1123         16  CP-REMAINING-TERM-1   PIC S9(4)V9    VALUE ZERO         CL**2
  1124                                     COMP-3.                         CL**2
  1125         16  CP-REMAINING-TERM-2   PIC S9(4)V9    VALUE ZERO         CL**2
  1126                                     COMP-3.                         CL**2
  1127         16  CP-REMAINING-TERM-3   PIC S9(4)V9    VALUE ZERO         CL**2
  1128                                     COMP-3.                         CL**2
  1129         16  CP-ODD-DAYS           PIC S9(3)      VALUE ZERO         CL**2
  1130                                     COMP-3.                         CL**2
  1131         16  FILLER                PIC X(12).                        CL**2
  1132                                                                     CL**2
  1133***************    OUTPUT FROM ELRAMT   *************************    CL**2
  1134                                                                     CL**2
  1135         16  CP-REMAINING-AMT      PIC S9(9)V99   VALUE ZERO         CL**2
  1136                                     COMP-3.                         CL**2
  1137         16  CP-REMAINING-AMT-PRV  PIC S9(9)V99   VALUE ZERO         CL**2
  1138                                     COMP-3.                         CL**2
  1139         16  FILLER                PIC X(12).                        CL**2
  1140                                                                     CL**2
  1141***************    OUTPUT FROM ELRATE   *************************    CL**2
  1142                                                                     CL**2
  1143         16  CP-CALC-PREMIUM       PIC S9(7)V99   VALUE ZERO         CL**2
  1144                                     COMP-3.                         CL**2
  1145         16  CP-PREMIUM-RATE       PIC S9(2)V9(5) VALUE ZERO         CL**2
  1146                                     COMP-3.                         CL**2
  1147         16  CP-MORTALITY-CODE     PIC X(4).                         CL**2
  1148         16  CP-RATE-EDIT-FLAG     PIC X.                            CL**2
  1149             88  CP-RATES-NEED-APR                  VALUE '1'.       CL**2
  1150         16  CP-COMPOSITE-RATE     PIC S99V999    VALUE ZERO         CL**2
  1151                                     COMP-3.                         CL**2
  1152         16  CP-POLICY-FEE         PIC S9(3)V99 VALUE +0 COMP-3.     CL**2
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  23
* SUNATEX.cbl (/apps/prod/cid1p/copy/ELCCALC)
  1153         16  CP-LF-PREM            PIC S9(7)V99 VALUE +0 COMP-3.
  1154         16  CP-LF-BALLOON-PREM REDEFINES CP-LF-PREM
  1155                                   PIC S9(7)V99 COMP-3.
  1156         16  FILLER                PIC X(07).                        CL**2
  1157                                                                     CL**2
  1158***************    OUTPUT FROM ELRFND   *************************    CL**2
  1159                                                                     CL**2
  1160         16  CP-CALC-REFUND        PIC S9(7)V99   VALUE ZERO         CL**2
  1161                                     COMP-3.                         CL**2
  1162         16  CP-REFUND-TYPE-USED   PIC X.                            CL**2
  1163           88  CP-R-AS-R78                         VALUE '1'.        CL**2
  1164           88  CP-R-AS-PRORATA                     VALUE '2'.        CL**2
  1165           88  CP-R-AS-CALIF                       VALUE '3'.        CL**2
  1166           88  CP-R-AS-TEXAS                       VALUE '4'.        CL**2
  1167           88  CP-R-AS-FARM-PLAN                   VALUE '4'.        CL**2
  1168           88  CP-R-AS-NET-PAY                     VALUE '5'.        CL**2
  1169           88  CP-R-AS-ANTICIPATION                VALUE '6'.        CL**2
  1170           88  CP-R-AS-MEAN                        VALUE '8'.        CL**2
  1171           88  CP-R-AS-SUM-OF-DIGITS               VALUE '9'.        CL**2
  1172           88  CP-R-AS-GAP-NON-REFUND              VALUE 'G'.
  1173           88  CP-R-AS-GAP-ACTUARIAL               VALUE 'S'.
  1174           88  CP-R-AS-SPP-DDF                     VALUE 'D'.
  1175           88  CP-R-AS-SPP-DDF-IU                  VALUE 'I'.
  1176           88  CP-R-AS-REPOSSESSION                VALUE 'R'.
  1177         16  FILLER                PIC X(12).                        CL**2
  1178                                                                     CL**2
  1179***************    OUTPUT FROM ELEARN   *************************    CL**2
  1180                                                                     CL**2
  1181         16  CP-R78-U-PRM          PIC S9(7)V99   VALUE ZERO         CL**2
  1182                                     COMP-3.                         CL**2
  1183         16  CP-R78-U-PRM-ALT      PIC S9(7)V99   VALUE ZERO         CL**2
  1184                                     COMP-3.                         CL**2
  1185         16  CP-PRORATA-U-PRM      PIC S9(7)V99   VALUE ZERO         CL**2
  1186                                     COMP-3.                         CL**2
  1187         16  CP-PRORATA-U-PRM-ALT  PIC S9(7)V99   VALUE ZERO         CL**2
  1188                                     COMP-3.                         CL**2
  1189         16  CP-STATE-U-PRM        PIC S9(7)V99   VALUE ZERO         CL**2
  1190                                     COMP-3.                         CL**2
  1191         16  CP-DOMICILE-U-PRM     PIC S9(7)V99   VALUE ZERO         CL**2
  1192                                     COMP-3.                         CL**2
  1193         16  CP-EARNING-TYPE-USED  PIC X.                            CL**2
  1194           88  CP-E-AS-SPECIAL                     VALUE 'S'.        CL**2
  1195           88  CP-E-AS-R78                         VALUE '1'.        CL**2
  1196           88  CP-E-AS-PRORATA                     VALUE '2'.        CL**2
  1197           88  CP-E-AS-TEXAS                       VALUE '4'.        CL**2
  1198           88  CP-E-AS-FARM-PLAN                   VALUE '4'.        CL**2
  1199           88  CP-E-AS-NET-PAY                     VALUE '5'.        CL**2
  1200           88  CP-E-AS-ANTICIPATION                VALUE '6'.        CL**2
  1201           88  CP-E-AS-MEAN                        VALUE '8'.        CL**2
  1202           88  CP-E-AS-SUM-OF-DIGITS               VALUE '9'.        CL**2
  1203         16  FILLER                PIC X(12).                        CL**2
  1204                                                                     CL**2
  1205***************    OUTPUT FROM ELPMNT   *************************    CL**2
  1206                                                                     CL**2
  1207         16  CP-ACTUAL-DAYS        PIC S9(05)     VALUE ZERO         CL**2
  1208                                     COMP-3.                         CL**2
  1209         16  CP-CLAIM-PAYMENT      PIC S9(7)V99   VALUE ZERO         CL**2
  1210                                     COMP-3.                         CL**2
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  24
* SUNATEX.cbl (/apps/prod/cid1p/copy/ELCCALC)
  1211         16  FILLER                PIC X(12).                        CL**2
  1212                                                                     CL**2
  1213***************   MISC WORK AREAS    *****************************   CL**2
  1214         16  CP-TOTAL-PAID         PIC S9(7)V99   VALUE ZERO         CL**2
  1215                                     COMP-3.                         CL**2
  1216         16  CP-R-MAX-ATT-AGE      PIC S9(3)      VALUE ZERO         CL**2
  1217                                     COMP-3.                         CL**2
  1218         16  CP-R-MAX-AGE          PIC S9(3)      VALUE ZERO         CL**2
  1219                                     COMP-3.                         CL**2
  1220         16  CP-R-MAX-TERM         PIC S9(5)      VALUE ZERO         CL**2
  1221                                     COMP-3.                         CL**2
  1222         16  CP-R-MAX-TOT-BEN      PIC S9(7)V99   VALUE ZERO         CL**2
  1223                                     COMP-3.                         CL**2
  1224         16  CP-R-MAX-MON-BEN      PIC S9(7)V99   VALUE ZERO         CL**2
  1225                                     COMP-3.                         CL**2
  1226         16  CP-IO-FUNCTION        PIC X          VALUE SPACE.       CL**2
  1227             88  OPEN-RATE-FILE                   VALUE 'O'.         CL**2
  1228             88  CLOSE-RATE-FILE                  VALUE 'C'.         CL**2
  1229             88  IO-ERROR                         VALUE 'E'.         CL**2
  1230                                                                     CL**2
  1231         16  CP-FIRST-PAY-DATE     PIC XX.                           CL**2
  1232                                                                     CL**2
  1233         16  CP-JOINT-INDICATOR    PIC X.                            CL**2
  1234                                                                     CL**2
  1235         16  CP-RESERVE-REMAINING-TERM                               CL**2
  1236                                   PIC S9(4)V9    VALUE ZERO         CL**2
  1237                                     COMP-3.                         CL**2
  1238                                                                     CL**2
  1239         16  CP-INSURED-BIRTH-DT   PIC XX.                           CL**2
  1240                                                                     CL**2
  1241         16  CP-INCURRED-AGE       PIC S9(3)      VALUE ZERO         CL**2
  1242                                     COMP-3.                         CL**2
  1243                                                                     CL**2
  1244         16  CP-MONTHLY-PAYMENT    PIC S9(5)V99   VALUE ZERO         CL**2
  1245                                     COMP-3.                         CL**2
  1246                                                                     CL**2
  1247         16  CP-RATING-BENEFIT-AMT PIC S9(9)V99   VALUE ZERO         CL**2
  1248                                     COMP-3.                         CL**2
  1249                                                                     CL**2
  1250         16  CP-ODD-DAYS-TO-PMT    PIC S9(3)      VALUE ZERO         CL**2
  1251                                     COMP-3.                         CL**2
  1252                                                                     CL**2
  1253         16  CP-MNTHS-TO-FIRST-PMT PIC S9(3)      VALUE ZERO         CL**2
  1254                                     COMP-3.                         CL**2
  1255                                                                     CL**2
  1256         16  CP-REMAMT-FACTOR      PIC S9(4)V9(9) VALUE ZEROS        CL**2
  1257                                     COMP-3.                         CL**2
  1258                                                                     CL**2
  1259         16  CP-FREE-LOOK          PIC S9(3)      VALUE ZERO         CL**2
  1260                                     COMP-3.                         CL**2
  1261                                                                     CL**2
  1262         16  CP-ROA-REFUND         PIC X          VALUE 'N'.         CL**2
  1263             88  CP-ROA-PREM-AT-REFUND            VALUE 'Y'.         CL**2
  1264                                                                     CL**2
  1265         16  CP-NET-BENEFIT-AMT    PIC S9(9)V99   VALUE ZERO         CL**2
  1266                                     COMP-3.                         CL**2
  1267         16  CP-SCNP-6MO-AMT       PIC S9(9)V99   VALUE ZERO
  1268                                     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  25
* SUNATEX.cbl (/apps/prod/cid1p/copy/ELCCALC)
  1269         16  CP-MONTH              PIC S999     COMP-3 VALUE +0.
  1270         16  cp-extra-periods      pic 9 value zeros.
  1271         16  cp-net-only-state     pic x value spaces.
  1272         16  FILLER                PIC X(13).                        CL**2
  1273******************************************************************   CL**2
  1274
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  26
* SUNATEX.cbl
  1276 PROCEDURE DIVISION USING CALCULATION-PASS-AREA.
  1277
  1278 000-START-PREMIUM-CALC.
  1279
  1280*    IF CP-RATE-FILE = 'O'
  1281*        MOVE OERATE-FILE-ID     TO ERRATE-FILE-ID.
  1282
  1283     IF  OPEN-RATE-FILE
  1284         GO TO 9999-OPEN-RATE-FILE.
  1285
  1286     IF  CLOSE-RATE-FILE
  1287         GO TO 9999-CLOSE-RATE-FILE.
  1288
  1289     MOVE ZERO                   TO CP-RETURN-CODE
  1290                                    CP-CALC-PREMIUM
  1291                                    CP-PREMIUM-RATE
  1292                                    CP-POLICY-FEE.
  1293
  1294     MOVE SPACES                 TO CP-MORTALITY-CODE.
  1295     MOVE ALL '9'                TO ERRATE-KEY.
  1296
  1297     MOVE CP-COMPANY-CD          TO RATE-COMPANY-CD.
  1298     MOVE CP-STATE               TO RATE-ST-CODE.
  1299     MOVE CP-CLASS-CODE          TO RATE-ST-CLASS.
  1300     MOVE CP-DEVIATION-CODE      TO RATE-ST-DEV.
  1301     MOVE CP-ISSUE-AGE           TO RATE-HIGH-AGE.
  1302
  1303     IF CP-RATING-BENEFIT-AMT NOT NUMERIC  OR
  1304        CP-RATING-BENEFIT-AMT = ZEROS
  1305         MOVE CP-ORIGINAL-BENEFIT    TO RATE-HIGH-AMT
  1306     ELSE
  1307         MOVE CP-RATING-BENEFIT-AMT  TO RATE-HIGH-AMT.
  1308
  1309     IF CP-AH
  1310         MOVE CP-AH-OVERRIDE-CODE    TO RATE-L-AH
  1311     ELSE
  1312         MOVE CP-LIFE-OVERRIDE-CODE  TO RATE-L-AH.
  1313
  1314     MOVE CP-BENEFIT-CD          TO RATE-LAH-NUM.
  1315     MOVE CP-CERT-EFF-DT         TO DC-BIN-DATE-1.
  1316     MOVE SPACE                  TO DC-OPTION-CODE.
  1317
  1318     PERFORM 9100-CONVERT-DATE THRU 9100-EXIT.
  1319     IF NO-CONVERSION-ERROR
  1320         MOVE DC-GREG-DATE-CYMD  TO RATE-EXPIRY-DATE
  1321         MOVE  ERRATE-KEY        TO SAVE-ERRATE-KEY
  1322     ELSE
  1323         MOVE '2'                TO CP-RETURN-CODE
  1324         GO TO 9999-CALC-RATE-PREM-X.
  1325
  1326 0050-RATE-START-BROWSE.
  1327     IF ERRATE-FILE-ID = OERATE-FILE-ID
  1328         MOVE ERRATE-KEY TO OE-RATE-KEY
  1329         START OERATEF KEY NOT LESS THAN OE-RATE-KEY
  1330     ELSE
  1331         MOVE ERRATE-KEY TO ER-RATE-KEY
  1332         START ERRATEF KEY NOT LESS THAN ER-RATE-KEY.
  1333
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  27
* SUNATEX.cbl
  1334     IF  ER-STATUS NOT = '00'
  1335         GO TO 9999-RATE-NOTFND.
  1336
  1337 0100-READ-RATE-LOOP.
  1338     IF ERRATE-FILE-ID = OERATE-FILE-ID
  1339         READ OERATEF NEXT RECORD
  1340     ELSE
  1341         READ ERRATEF NEXT RECORD.
  1342
  1343     IF  ER-STATUS NOT = '00'
  1344         GO TO 9999-RATE-NOTFND.
  1345
  1346     IF ERRATE-FILE-ID = OERATE-FILE-ID
  1347         MOVE OE-RATE-REC TO RATE-RECORD
  1348     ELSE
  1349         MOVE ER-RATE-REC TO RATE-RECORD.
  1350
  1351 0110-CHECK-KEYS.
* 1352                      COPY ELCRATPD.
  1353******************************************************************
  1354*                                                                *
  1355*                                                                *
  1356*                            ELCRATPD                            *
  1357*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1358*                            VMOD=2.061                          *
  1359*                                                                *
  1360******************************************************************
  1361******************************************************************
  1362*                   C H A N G E   L O G
  1363*
  1364* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1365*-----------------------------------------------------------------
  1366*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1367* EFFECTIVE    NUMBER
  1368*-----------------------------------------------------------------
  1369* 120202    2001061800003  PEMA  ADD DCC PROCESSING
  1370* 120502                   PEMA  ADD SPECIAL IN CALC FOR CID
  1371* 032603                   PEMA  ADD SPECIAL AZ CALC
  1372* 100703    2003080800002  PEMA  ADD SUPER GAP PROCESSING
  1373* 120403                   PEMA  ADD SPECIAL TX CALC
  1374* 092205                   PEMA  FIX CRIT PER FOR DCC
  1375* 011707                   PEMA  ADD SC NP PLUS 6 PMTS
  1376* 021207                   PEMA  ADD PA NP
  1377* 022107                   PEMA  ADD NH NP AND NP TRUNC
  1378* 032807                   PEMA  ADD VT NP PLUS 2
  1379* 052808    2008032000002  PEMA  ADD CODE FOR AK NET PAY
  1380* 052808    2008050800003  PEMA  ADD CODE FOR NV NET +2
  1381* 060909    2008042300002  PEMA  ADD NEW FARM PLAN CALC
  1382* 010410    2008021200005  PEMA  ADD MN NET PAY BALLOON
  1383* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  1384* 040610  CR2010010400006  PEMA  ADD IN TO VT CODE
  1385* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  1386* 071211    2010012700001  PEMA  ADD SPPDD
  1387* 071511    2011021500001  PEMA  ADD CODE FOR DCC 10C
  1388* 092311  IR2011092100001  PEMA  ID 10C MONTHLY
  1389* 112911  CR2011083000003  PEMA  ADD SPPDDF TRUNCATED
  1390* 032612  CR2011110200001  PEMA  AHL CHANGES
  1391* 111212  CR2012013100001  PEMA  CHANGES FOR MN AND WA
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  28
* SUNATEX.cbl (/apps/prod/cid1p/copy/ELCRATPD)
  1392* 122613  CR2011021500001  PEMA  ADD CODE 4 TRUNC BALLOON DCC 10C
  1393* 050713  CR2008042200001  PEMA  ADD CODE FOR ZERO APR
  1394******************************************************************
  1395
  1396 0110-CHECK-KEY.
  1397     IF SVRT-COMPANY-CD = RT-COMPANY-CD  AND
  1398        SVRT-ST-CODE    = RT-ST-CODE     AND
  1399        SVRT-ST-CLASS   = RT-ST-CLASS    AND
  1400        SVRT-ST-DEV     = RT-ST-DEV      AND
  1401        SVRT-L-AH       = RT-L-AH        AND
  1402        SVRT-LAH-NUM    = RT-LAH-NUM
  1403         NEXT SENTENCE
  1404     ELSE
  1405         GO TO 9999-RATE-NOTFND.
  1406
  1407     IF  SVRT-HIGH-AGE GREATER RT-HIGH-AGE
  1408         GO TO 9999-RATE-NOTFND.
  1409
  1410     IF SVRT-HIGH-AMT NOT LESS THAN RT-HIGH-AMT
  1411        GO TO 0100-READ-RATE-LOOP.
  1412
  1413     IF SVRT-EXPIRY-DATE GREATER RT-EXPIRY-DATE
  1414         GO TO 0100-READ-RATE-LOOP.
  1415
  1416     IF SVRT-EXPIRY-DATE = RT-EXPIRY-DATE
  1417         GO TO 0100-READ-RATE-LOOP.
  1418
  1419     IF RT-MAX-AGE = ZEROS
  1420         NEXT SENTENCE
  1421     ELSE
  1422         COMPUTE WS-AGE =
  1423             (CP-ISSUE-AGE + (CP-ORIGINAL-TERM / 12))
  1424         IF WS-AGE >= RT-MAX-AGE
  1425             MOVE 'B'               TO CP-RETURN-CODE.
  1426
  1427     IF CP-LOAN-TERM NOT NUMERIC
  1428         MOVE +0                    TO CP-LOAN-TERM.
  1429
  1430     IF CP-LOAN-TERM = ZERO
  1431         MOVE CP-ORIGINAL-TERM      TO CP-LOAN-TERM.
  1432
  1433     IF CP-TERM-OR-EXT-DAYS NOT NUMERIC
  1434         MOVE +0                    TO CP-TERM-OR-EXT-DAYS.
  1435
  1436     MOVE CP-R-MAX-MON-BEN          TO WS-MAX-MON-BEN.
  1437     MOVE CP-R-MAX-TOT-BEN          TO WS-MAX-TOT-BEN.
  1438
  1439     IF CP-AH
  1440         GO TO 2000-TYPE-IS-AH.
  1441
  1442     evaluate true
  1443        when (rt-is-ob)
  1444           and (cp-company-id not = 'CID')
  1445              move cp-loan-term  to ws-rate-term
  1446        when (cp-company-id = 'DCC')
  1447           and (cp-benefit-cd (1:1) = 'P')
  1448           move cp-loan-term     to ws-rate-term
  1449        when other
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  29
* SUNATEX.cbl (/apps/prod/cid1p/copy/ELCRATPD)
  1450           move cp-original-term to ws-rate-term
  1451     end-evaluate
  1452
  1453*    IF ((RT-IS-OB)
  1454*       AND (CP-COMPANY-ID NOT EQUAL 'CID'))
  1455*                     OR
  1456*       ((CP-COMPANY-ID = 'DCC')
  1457*       AND (CP-BENEFIT-CD (1:1) = 'P'))
  1458*       MOVE CP-LOAN-TERM        TO WS-RATE-TERM
  1459*    ELSE
  1460*       MOVE CP-ORIGINAL-TERM TO WS-RATE-TERM
  1461*    END-IF
  1462
  1463     MOVE CP-CERT-EFF-DT            TO DC-BIN-DATE-1.
  1464     MOVE SPACE                     TO DC-OPTION-CODE.
  1465
  1466     PERFORM 9100-CONVERT-DATE THRU 9100-EXIT.
  1467
  1468 1000-TYPE-IS-LIFE.
  1469     MOVE RT-MAX-AGE                TO CP-R-MAX-ATT-AGE.
  1470
  1471     MOVE ZERO                      TO CP-R-MAX-AGE
  1472                                       CP-R-MAX-TERM
  1473                                       CP-R-MAX-MON-BEN
  1474                                       CP-R-MAX-TOT-BEN.
  1475
  1476     MOVE RT-LIFE-MORT-CODE         TO CP-MORTALITY-CODE.
  1477
  1478     IF RT-POLICY-FEE NUMERIC
  1479        MOVE RT-POLICY-FEE          TO CP-POLICY-FEE.
  1480
  1481     MOVE RT-DISCOUNT-OPTION     TO WS-DISCOUNT-OPTION.
  1482
  1483     if rt-discount-ob-rate not numeric
  1484        move zeros               to rt-discount-ob-rate
  1485     end-if
  1486
  1487     IF (RT-DISCOUNT-OPTION EQUAL
  1488                     '1' OR '2' OR '3' OR '4' OR '5') AND
  1489        (RT-DISCOUNT-OB-RATE NUMERIC)         AND
  1490        (RT-DISCOUNT-OB-RATE GREATER THAN +0)
  1491         NEXT SENTENCE
  1492     ELSE
  1493         IF (RT-DISCOUNT-OPTION EQUAL '6') AND
  1494            (CP-STATE-STD-ABBRV EQUAL 'CA')
  1495             IF RT-DISCOUNT-RATE GREATER THAN ZERO
  1496                 COMPUTE CA-DISCOUNT = RT-DISCOUNT-RATE / 100
  1497                 GO TO 1050-REGULAR-RATES
  1498             ELSE
  1499                 GO TO 1050-REGULAR-RATES
  1500         ELSE
  1501             GO TO 1050-REGULAR-RATES.
  1502
  1503*    display ' discount option ' rt-discount-option
  1504     IF RT-DISCOUNT-RATE NOT NUMERIC
  1505        MOVE +0                  TO RT-DISCOUNT-RATE.
  1506
  1507     IF CP-ORIGINAL-TERM GREATER ZERO AND LESS 361
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  30
* SUNATEX.cbl (/apps/prod/cid1p/copy/ELCRATPD)
  1508        NEXT SENTENCE
  1509     ELSE
  1510        MOVE +0                  TO CP-PREMIUM-RATE
  1511                                    CP-COMPOSITE-RATE
  1512                                    CP-CALC-PREMIUM
  1513         MOVE '4'                TO CP-RETURN-CODE
  1514         GO TO 9999-CALC-RATE-PREM-X.
  1515
  1516     IF RT-DISCOUNT-OPTION = '1' OR '3' OR '5'
  1517        MOVE RT-DISCOUNT-RATE TO WS-WORK-DIS-RATE
  1518     ELSE
  1519        MOVE CP-LOAN-APR TO WS-WORK-DIS-RATE.
  1520
  1521*    IF RT-DISCOUNT-OPTION EQUAL '4'
  1522*       MOVE RT-DISCOUNT-OB-RATE TO CP-PREMIUM-RATE
  1523*       GO TO 1075-BYPASS-REGULAR-RATE.
  1524
  1525     IF RT-DISCOUNT-OPTION EQUAL '3' OR '4' OR '5'
  1526        MOVE RT-DISCOUNT-OB-RATE TO CP-PREMIUM-RATE
  1527        COMPUTE WS-WORK-DIS-RATE EQUAL
  1528                WS-WORK-DIS-RATE / +100
  1529        GO TO 1075-BYPASS-REGULAR-RATE.
  1530
  1531     IF (CP-COMPANY-ID EQUAL 'WDS') AND
  1532        (CP-STATE-STD-ABBRV EQUAL 'MN' OR 'NC') AND
  1533        (CP-EARN-AS-NET-PAY OR CP-EARN-AS-REG-BALLOON)
  1534        MOVE RT-DISCOUNT-OB-RATE TO CP-PREMIUM-RATE
  1535        GO TO 1075-BYPASS-REGULAR-RATE.
  1536
  1537     IF (CP-COMPANY-ID EQUAL 'GTL') AND
  1538        (CP-STATE-STD-ABBRV EQUAL 'NJ') AND
  1539        (CP-TRUNCATED-LIFE)
  1540        MOVE RT-DISCOUNT-OB-RATE TO CP-PREMIUM-RATE
  1541        GO TO 1075-BYPASS-REGULAR-RATE.
  1542
  1543     IF (CP-COMPANY-ID EQUAL 'GTL') AND
  1544        (CP-STATE-STD-ABBRV EQUAL 'GA') AND
  1545        (CP-EARN-AS-NET-PAY)
  1546*       (CP-TRUNCATED-LIFE)
  1547        MOVE RT-DISCOUNT-OB-RATE TO CP-PREMIUM-RATE
  1548        GO TO 1075-BYPASS-REGULAR-RATE.
  1549
  1550     IF ((CP-COMPANY-ID EQUAL 'GTL') AND
  1551        (CP-STATE-STD-ABBRV EQUAL 'RI'))
  1552                   AND
  1553        ((CP-EARN-AS-NET-PAY)
  1554               OR
  1555        (CP-SPECIAL-CALC-CD EQUAL 'H'))
  1556        MOVE RT-DISCOUNT-OB-RATE TO CP-PREMIUM-RATE
  1557        GO TO 1075-BYPASS-REGULAR-RATE.
  1558
  1559     IF (CP-COMPANY-ID EQUAL 'GTL') AND
  1560        (CP-STATE-STD-ABBRV EQUAL 'MA') AND
  1561        (CP-EARN-AS-NET-PAY) AND
  1562        (CP-SPECIAL-CALC-CD EQUAL 'H')
  1563        MOVE RT-DISCOUNT-OB-RATE TO CP-PREMIUM-RATE
  1564        GO TO 1075-BYPASS-REGULAR-RATE.
  1565
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  31
* SUNATEX.cbl (/apps/prod/cid1p/copy/ELCRATPD)
  1566     if (cp-company-id = 'CID')
  1567        and (cp-state-std-abbrv = 'WA')
  1568        and (rt-discount-option = '1')
  1569        and (cp-earn-as-farm-plan)
  1570        move rt-discount-ob-rate to cp-premium-rate
  1571        go to 1075-bypass-regular-rate
  1572     end-if
  1573
  1574     IF (CP-COMPANY-ID = 'CID')
  1575        AND (CP-STATE-STD-ABBRV = 'MN')
  1576        AND (RT-DISCOUNT-OPTION = '1')
  1577        AND ((CP-EARN-AS-NET-PAY OR CP-EARN-AS-REG-BALLOON)
  1578                     OR
  1579            (CP-LEVEL-LIFE OR CP-EARN-AS-FARM-PLAN)
  1580            AND (CP-CERT-EFF-DT > X'A4FF'))
  1581        MOVE RT-DISCOUNT-OB-RATE TO CP-PREMIUM-RATE
  1582        display ' made it to MN 1 ' cp-premium-rate
  1583        GO TO 1075-BYPASS-REGULAR-RATE
  1584     END-IF
  1585
  1586     if (cp-company-id = 'CID')
  1587        and (cp-earn-as-reg-balloon)
  1588        and (cp-ben-category = 'P' or 'I')
  1589        and (rt-discount-ob-rate not = zeros)
  1590        go to 1075-bypass-regular-rate
  1591     end-if
  1592
  1593     IF (CP-COMPANY-ID EQUAL 'CID')
  1594        AND ((CP-STATE-STD-ABBRV = 'NH' OR 'NV' OR 'WA' OR 'AK')
  1595                      OR
  1596            (CP-BENEFIT-CD = '49' OR '50' OR '53' OR '54'))
  1597        AND (CP-EARN-AS-NET-PAY)
  1598        MOVE RT-DISCOUNT-OB-RATE TO CP-PREMIUM-RATE
  1599        GO TO 1075-BYPASS-REGULAR-RATE
  1600     END-IF
  1601
  1602     IF (CP-COMPANY-ID EQUAL 'NCB') AND
  1603        (CP-STATE-STD-ABBRV EQUAL 'NC') AND
  1604        (CP-EARN-AS-NET-PAY OR CP-TRUNCATED-LIFE)
  1605         MOVE RT-DISCOUNT-OB-RATE TO CP-PREMIUM-RATE
  1606         GO TO 1075-BYPASS-REGULAR-RATE.
  1607
  1608     IF CP-COMPANY-ID = 'CID' or 'AHL'
  1609        CONTINUE
  1610     ELSE
  1611        IF (CP-STATE-STD-ABBRV EQUAL 'NC') AND
  1612           (CP-EARN-AS-NET-PAY ) AND
  1613           (DC-GREG-DATE-CYMD GREATER THAN 19931231)
  1614            GO TO 1075-BYPASS-REGULAR-RATE
  1615        END-IF
  1616     END-IF
  1617
  1618     IF (CP-COMPANY-ID = 'CID') AND
  1619        (CP-EARN-AS-NET-PAY) AND
  1620        (CP-LEVEL-LIFE) AND
  1621        (CP-STATE-STD-ABBRV = 'CA') AND
  1622        (CP-STATE-STD-ABBRV = CP-STATE)
  1623        COMPUTE WS-WORK-DIS-RATE =
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  32
* SUNATEX.cbl (/apps/prod/cid1p/copy/ELCRATPD)
  1624             RT-DISCOUNT-RATE / +100
  1625        MOVE RT-DISCOUNT-OB-RATE TO CP-PREMIUM-RATE
  1626        GO TO 1075-BYPASS-REGULAR-RATE
  1627     END-IF
  1628
  1629     IF (CP-COMPANY-ID = 'CID')
  1630        AND (CP-EARN-AS-NET-PAY)
  1631        AND (CP-STATE-STD-ABBRV = 'ME')
  1632        COMPUTE WS-WORK-DIS-RATE =
  1633             RT-DISCOUNT-RATE / +100
  1634        MOVE RT-DISCOUNT-OB-RATE TO CP-PREMIUM-RATE
  1635        GO TO 1075-BYPASS-REGULAR-RATE
  1636     END-IF
  1637
  1638     IF (CP-COMPANY-ID = 'CID')
  1639        AND (CP-STATE-STD-ABBRV = 'ND' OR 'MT' OR 'NJ'
  1640           OR 'IN' OR 'AZ')
  1641        AND (CP-FARM-PLAN)
  1642        MOVE RT-DISCOUNT-OB-RATE TO CP-PREMIUM-RATE
  1643        GO TO 1075-BYPASS-REGULAR-RATE
  1644     END-IF
  1645
  1646     IF (CP-COMPANY-ID = 'DCC')
  1647        AND (CP-BEN-CATEGORY = 'D')
  1648        AND (CP-EARN-AS-NET-PAY)
  1649        MOVE RT-DISCOUNT-OB-RATE TO CP-PREMIUM-RATE
  1650        COMPUTE CP-PREMIUM-RATE ROUNDED = CP-PREMIUM-RATE *
  1651           (1 + CP-DCC-PMF-COMM) / (1 - CP-DCC-ACT-COMM)
  1652*       DISPLAY ' ACT COMM ' CP-DCC-ACT-COMM
  1653*       DISPLAY ' PMF COMM ' CP-DCC-PMF-COMM
  1654*       DISPLAY ' OB RATE  ' RT-DISCOUNT-OB-RATE
  1655*       DISPLAY ' NEW RATE ' CP-PREMIUM-RATE
  1656        GO TO 1075-BYPASS-REGULAR-RATE
  1657     END-IF
  1658
  1659     IF (CP-COMPANY-ID = 'CID') AND
  1660        (CP-EARN-AS-NET-PAY) AND
  1661        ((CP-STATE-STD-ABBRV = 'MT' OR 'NJ' OR 'PA'
  1662                            OR 'VT')
  1663                   OR
  1664        ((CP-STATE-STD-ABBRV = 'IN') AND
  1665        (CP-CERT-EFF-DT > X'9A7F'))
  1666                   OR
  1667        ((CP-STATE-STD-ABBRV = 'AZ' OR 'ND') AND
  1668        (CP-CERT-EFF-DT > X'9ADF'))) AND
  1669        (CP-STATE-STD-ABBRV = CP-STATE)
  1670        COMPUTE WS-WORK-DIS-RATE =
  1671             RT-DISCOUNT-RATE / +100
  1672        MOVE RT-DISCOUNT-OB-RATE TO CP-PREMIUM-RATE
  1673        GO TO 1075-BYPASS-REGULAR-RATE
  1674     END-IF
  1675
  1676     IF (CP-COMPANY-ID = 'CID') AND
  1677        (CP-EARN-AS-NET-PAY) AND
  1678        (CP-STATE-STD-ABBRV = 'TX') AND
  1679        (CP-STATE-STD-ABBRV = CP-STATE) AND
  1680        (WS-DISCOUNT-OPTION NOT = ' ')
  1681        COMPUTE WS-WORK-DIS-RATE =
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  33
* SUNATEX.cbl (/apps/prod/cid1p/copy/ELCRATPD)
  1682             RT-DISCOUNT-RATE / +100
  1683        MOVE RT-DISCOUNT-OB-RATE TO CP-PREMIUM-RATE
  1684        GO TO 1075-BYPASS-REGULAR-RATE
  1685     END-IF
  1686
  1687     IF (CP-COMPANY-ID = 'CID') AND
  1688        (CP-EARN-AS-NET-PAY) AND
  1689        (CP-TRUNCATED-LIFE) AND
  1690        (CP-STATE-STD-ABBRV = 'CA' OR 'VA') AND
  1691        (CP-STATE-STD-ABBRV = CP-STATE) AND
  1692        (WS-DISCOUNT-OPTION NOT = ' ')
  1693        COMPUTE WS-WORK-DIS-RATE =
  1694             RT-DISCOUNT-RATE / +100
  1695        MOVE RT-DISCOUNT-OB-RATE TO CP-PREMIUM-RATE
  1696        GO TO 1075-BYPASS-REGULAR-RATE
  1697     END-IF
  1698
  1699     IF CP-SPECIAL-CALC-CD EQUAL 'H'
  1700        IF WS-WORK-DIS-RATE NOT EQUAL +0
  1701           COMPUTE WS-WORK-DIS-RATE EQUAL
  1702                   WS-WORK-DIS-RATE / +100.
  1703
  1704     IF CP-SPECIAL-CALC-CD EQUAL 'H'
  1705        IF CP-STATE-STD-ABBRV EQUAL 'NY'
  1706           IF CP-MONTHLY-PAYMENT EQUAL +0
  1707            IF CP-LOAN-APR GREATER THAN +2
  1708              COMPUTE CP-MONTHLY-PAYMENT EQUAL
  1709              CP-ORIGINAL-BENEFIT /
  1710               ((1 - (1 + (CP-LOAN-APR / +1200)) **
  1711               (WS-RATE-TERM * -1)) / (CP-LOAN-APR / +1200))
  1712            ELSE
  1713             COMPUTE CP-MONTHLY-PAYMENT EQUAL
  1714               CP-ORIGINAL-BENEFIT / CP-ORIGINAL-TERM.
  1715
  1716     IF CP-SPECIAL-CALC-CD EQUAL 'H'
  1717        IF CP-STATE-STD-ABBRV EQUAL 'NY'
  1718          IF WS-WORK-DIS-RATE GREATER THAN +0
  1719           COMPUTE WK1 ROUNDED EQUAL
  1720           (1 - 1 / (1 + WS-WORK-DIS-RATE / +12) **
  1721                              (WS-RATE-TERM - +1)) /
  1722                        (WS-WORK-DIS-RATE / +12)
  1723           COMPUTE WK2 ROUNDED EQUAL
  1724           (1 - 1 / (1 + WS-WORK-DIS-RATE / +12) **
  1725                              (WS-RATE-TERM)) /
  1726                        (WS-WORK-DIS-RATE / +12)
  1727           COMPUTE WK3 EQUAL
  1728                RT-DISCOUNT-OB-RATE *
  1729                (1 + WS-WORK-DIS-RATE / +12)
  1730                MOVE WK3 TO CP-PREMIUM-RATE
  1731                COMPUTE WK5 EQUAL WK3 / +1000
  1732           GO TO 1075-BYPASS-REGULAR-RATE.
  1733*               (RT-DISCOUNT-OB-RATE / +1000) *
  1734*               (1 + WS-WORK-DIS-RATE / +12)
  1735*          GO TO 1075-BYPASS-REGULAR-RATE.
  1736
  1737     IF CP-SPECIAL-CALC-CD EQUAL 'H'
  1738        IF RT-DISCOUNT-OB-RATE GREATER THAN +0
  1739           COMPUTE WK3 EQUAL
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  34
* SUNATEX.cbl (/apps/prod/cid1p/copy/ELCRATPD)
  1740           RT-DISCOUNT-OB-RATE *
  1741           (24 / (24 + WS-WORK-DIS-RATE * WS-RATE-TERM))
  1742           MOVE WK3 TO CP-PREMIUM-RATE
  1743           COMPUTE WK5 EQUAL WK3 / +1000
  1744           GO TO 1075-BYPASS-REGULAR-RATE.
  1745
  1746     IF (CP-COMPANY-ID EQUAL 'NCL') AND
  1747        (CP-STATE-STD-ABBRV EQUAL 'VT' OR 'MA')
  1748        MOVE RT-DISCOUNT-OB-RATE TO CP-PREMIUM-RATE
  1749        GO TO 1075-BYPASS-REGULAR-RATE.
  1750
  1751     COMPUTE WS-SIN-PREM-RATE =
  1752             (RT-DISCOUNT-OB-RATE / +1000) *
  1753             ((WS-RATE-TERM + +1) / +2).
  1754
  1755     COMPUTE CP-PREMIUM-RATE =
  1756             WS-SIN-PREM-RATE /
  1757             (+1 + (((WS-WORK-DIS-RATE / +100) *
  1758             WS-RATE-TERM) / +24)).
  1759
  1760     IF CP-PREMIUM-RATE NOT = +0
  1761        MULTIPLY +100 BY CP-PREMIUM-RATE
  1762        MOVE CP-PREMIUM-RATE TO WS-PREMIUM-RATE
  1763        GO TO 1075-BYPASS-REGULAR-RATE.
  1764
  1765 1050-REGULAR-RATES.
  1766
  1767     IF CP-SPECIAL-CALC-CD EQUAL 'H'
  1768        COMPUTE WK5 EQUAL
  1769        ((WS-RATE-TERM * RT-L-RATE (+12)) / +100) /
  1770        (6 * (WS-RATE-TERM + 1))
  1771        MOVE WK5 TO CP-PREMIUM-RATE
  1772        GO TO 1075-BYPASS-REGULAR-RATE.
  1773
  1774     IF (CP-COMPANY-ID EQUAL 'CSL') AND
  1775        (CP-CSL-VALID-NP-BENEFIT-CD)
  1776        IF CP-JOINT-INDICATOR EQUAL 'J'
  1777           MOVE RT-L-RATE (3) TO CP-PREMIUM-RATE
  1778           GO TO 1075-BYPASS-REGULAR-RATE
  1779        ELSE
  1780           MOVE RT-L-RATE (1) TO CP-PREMIUM-RATE
  1781           GO TO 1075-BYPASS-REGULAR-RATE.
  1782
  1783     IF (CP-COMPANY-ID EQUAL 'GTL')     AND
  1784        (CP-STATE-STD-ABBRV EQUAL 'IA') AND
  1785        (CP-EARN-AS-NET-PAY )
  1786        MOVE RT-L-RATE (12)      TO CP-PREMIUM-RATE
  1787        MOVE CP-CERT-EFF-DT      TO DC-BIN-DATE-1
  1788        MOVE CP-FIRST-PAY-DATE   TO DC-BIN-DATE-2
  1789        MOVE '1'                 TO DC-OPTION-CODE
  1790        PERFORM 9100-CONVERT-DATE THRU 9100-EXIT
  1791        IF DATE-CONVERSION-ERROR
  1792            MOVE '2'                TO CP-RETURN-CODE
  1793            GO TO 9999-CALC-RATE-PREM-X
  1794        ELSE
  1795            COMPUTE CP-ODD-DAYS-TO-PMT = DC-ELAPSED-MONTHS * 30 +
  1796                                         DC-ODD-DAYS-OVER
  1797            GO TO 1075-BYPASS-REGULAR-RATE.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  35
* SUNATEX.cbl (/apps/prod/cid1p/copy/ELCRATPD)
  1798
  1799     IF RT-COMPOSITE-RATE NOT NUMERIC
  1800         MOVE ZEROS                        TO RT-COMPOSITE-RATE.
  1801
  1802*    IF CP-ORIGINAL-TERM GREATER ZERO AND LESS 361
  1803     IF WS-RATE-TERM GREATER ZERO AND LESS 361
  1804         MOVE RT-L-RATE (WS-RATE-TERM)     TO CP-PREMIUM-RATE
  1805                                              WS-PREMIUM-RATE
  1806         MOVE RT-COMPOSITE-RATE            TO CP-COMPOSITE-RATE
  1807     ELSE
  1808         MOVE +0                           TO CP-PREMIUM-RATE
  1809                                              CP-COMPOSITE-RATE
  1810                                              CP-CALC-PREMIUM
  1811         GO TO 9999-CALC-RATE-PREM-X.
  1812
  1813     IF (CP-COMPANY-ID EQUAL 'CID')
  1814        AND (CP-STATE-STD-ABBRV EQUAL 'SC')
  1815        AND (CP-BENEFIT-CD = '2I' OR '2J' OR '2K' OR '2L')
  1816        AND (CP-EARN-AS-NET-PAY)
  1817        GO TO 1075-BYPASS-REGULAR-RATE
  1818     END-IF
  1819
  1820******************************************************
  1821*    IF CP-COMPANY-ID NOT = 'LBL'
  1822     IF (CP-COMPANY-ID NOT = 'LBL' AND 'CID')
  1823                   or
  1824        ((cp-company-id = 'CID')
  1825        and (cp-earn-as-reg-balloon)
  1826        and (cp-ben-category = 'P' or 'I'))
  1827         GO TO 1075-BYPASS-REGULAR-RATE.
  1828
  1829     MOVE CP-CERT-EFF-DT         TO DC-BIN-DATE-1.
  1830     MOVE CP-FIRST-PAY-DATE      TO DC-BIN-DATE-2.
  1831     MOVE '1'                    TO DC-OPTION-CODE.
  1832     PERFORM 9100-CONVERT-DATE THRU 9100-EXIT.
  1833     IF DATE-CONVERSION-ERROR
  1834         MOVE '2'                TO CP-RETURN-CODE
  1835         GO TO 9999-CALC-RATE-PREM-X
  1836       ELSE
  1837         MOVE DC-ELAPSED-MONTHS  TO CP-MNTHS-TO-FIRST-PMT
  1838         MOVE DC-ODD-DAYS-OVER   TO CP-ODD-DAYS-TO-PMT.
  1839
  1840     IF CP-MNTHS-TO-FIRST-PMT GREATER THAN 1
  1841        COMPUTE CP-ODD-DAYS-TO-PMT EQUAL CP-ODD-DAYS-TO-PMT +
  1842        ((CP-MNTHS-TO-FIRST-PMT - 1) * +30).
  1843
  1844     IF (CP-EXT-CHG-LF OR CP-EXT-CHG-LF-AH)
  1845        IF (CP-ODD-DAYS-TO-PMT NOT = ZEROS)
  1846           NEXT SENTENCE
  1847         ELSE
  1848           GO TO 1075-BYPASS-REGULAR-RATE
  1849       ELSE
  1850        IF (CP-MNTHS-TO-FIRST-PMT = ZERO) AND
  1851           (CP-ODD-DAYS-TO-PMT NOT = ZEROS)
  1852           NEXT SENTENCE
  1853         ELSE
  1854           GO TO 1075-BYPASS-REGULAR-RATE.
  1855
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  36
* SUNATEX.cbl (/apps/prod/cid1p/copy/ELCRATPD)
  1856     IF CP-MNTHS-TO-FIRST-PMT GREATER ZERO
  1857        COMPUTE CP-PREMIUM-RATE =
  1858        ((CP-PREMIUM-RATE / CP-ORIGINAL-TERM
  1859         * (CP-ORIGINAL-TERM + 1)) - CP-PREMIUM-RATE)
  1860         * (CP-ODD-DAYS-TO-PMT * 12 / 365) + CP-PREMIUM-RATE.
  1861
  1862     IF CP-MNTHS-TO-FIRST-PMT = ZEROS
  1863        COMPUTE CP-PREMIUM-RATE =
  1864        (CP-PREMIUM-RATE - (CP-PREMIUM-RATE /
  1865        CP-ORIGINAL-TERM * (CP-ORIGINAL-TERM - 1))) *
  1866        (CP-ODD-DAYS-TO-PMT * 12 / 365) +
  1867        (CP-PREMIUM-RATE / CP-ORIGINAL-TERM
  1868         * (CP-ORIGINAL-TERM - 1)).
  1869******************************************************
  1870
  1871 1075-BYPASS-REGULAR-RATE.
  1872
  1873     MOVE CP-LOAN-TERM              TO WS-RATE-TERM.
  1874
  1875     MOVE +1 TO LINDX.
  1876
  1877     IF CP-COMPANY-ID EQUAL 'CRI'
  1878        IF CP-SIG-SWITCH EQUAL 'S' OR 'J'
  1879           MOVE +5               TO LINDX
  1880           IF RT-L-EX-AGE (LINDX) EQUAL ZERO
  1881              MOVE 'F'           TO CP-RETURN-CODE
  1882              GO TO 1200-CALCULATE-PREMIUMS.
  1883
  1884     IF RT-L-EX-AGE (LINDX) = ZERO
  1885          GO TO 1200-CALCULATE-PREMIUMS.
  1886
  1887 1100-SEARCH-LIFE-LIMITS.
  1888
  1889     IF CP-COMPANY-ID EQUAL 'CRI'
  1890        IF CP-SIG-SWITCH NOT EQUAL 'S' AND 'J'
  1891           IF LINDX GREATER THAN +4
  1892              MOVE 'A'           TO CP-RETURN-CODE
  1893              GO TO 1200-CALCULATE-PREMIUMS.
  1894
  1895     IF LINDX GREATER +8
  1896         MOVE 'A'                TO CP-RETURN-CODE
  1897         GO TO 1200-CALCULATE-PREMIUMS.
  1898
  1899     IF CP-ISSUE-AGE GREATER RT-L-EX-AGE (LINDX)
  1900         IF RT-L-EX-AGE (LINDX) = ZEROS
  1901             ADD +1              TO LINDX
  1902             GO TO 1100-SEARCH-LIFE-LIMITS
  1903         ELSE
  1904             MOVE RT-L-EX-AGE (LINDX)
  1905                                 TO CP-R-MAX-AGE
  1906             MOVE RT-L-EX-TERM (LINDX)
  1907                                 TO CP-R-MAX-TERM
  1908             MOVE RT-L-EX-FACE (LINDX)
  1909                                 TO CP-R-MAX-TOT-BEN
  1910             ADD +1              TO LINDX
  1911             GO TO 1100-SEARCH-LIFE-LIMITS
  1912     ELSE
  1913         MOVE RT-L-EX-AGE (LINDX)
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  37
* SUNATEX.cbl (/apps/prod/cid1p/copy/ELCRATPD)
  1914                                 TO CP-R-MAX-AGE
  1915         MOVE RT-L-EX-TERM (LINDX)
  1916                                 TO CP-R-MAX-TERM
  1917         MOVE RT-L-EX-FACE (LINDX)
  1918                                 TO CP-R-MAX-TOT-BEN.
  1919
  1920     IF CP-ORIGINAL-TERM GREATER RT-L-EX-TERM (LINDX)
  1921         MOVE '9'                TO CP-RETURN-CODE.
  1922
  1923     IF CP-ORIGINAL-BENEFIT GREATER RT-L-EX-FACE (LINDX)
  1924         MOVE '8'                TO CP-RETURN-CODE.
  1925
  1926 1200-CALCULATE-PREMIUMS.
  1927
  1928     IF CP-COMPANY-ID = 'CSL'
  1929        IF CP-CSL-VALID-NP-BENEFIT-CD
  1930           GO TO 1240-NET-PAY-CONT
  1931        ELSE
  1932           GO TO 1250-CSL-CALC.
  1933
  1934     IF CP-COMPANY-ID = 'WDS'
  1935        IF CP-STATE-STD-ABBRV = 'MN' OR 'NC'
  1936           IF CP-EARN-AS-REG-BALLOON
  1937              GO TO 1240-NET-PAY-CONT.
  1938
  1939     IF (CP-COMPANY-ID = 'CID')
  1940        AND (CP-STATE-STD-ABBRV = 'MN')
  1941        AND (CP-EARN-AS-REG-BALLOON OR CP-EARN-AS-FARM-PLAN)
  1942        AND (CP-CERT-EFF-DT > X'A4FF')
  1943        display ' made it to mn 2 '
  1944        GO TO 1240-NET-PAY-CONT
  1945     END-IF
  1946
  1947     IF (CP-COMPANY-ID = 'CID')
  1948        AND (CP-STATE-STD-ABBRV = 'WA')
  1949        AND (CP-FARM-PLAN)
  1950        GO TO 1240-NET-PAY-CONT
  1951     END-IF
  1952
  1953
  1954     if (cp-company-id = 'CID')
  1955        and (cp-earn-as-reg-balloon)
  1956        and (cp-ben-category = 'P' or 'I')
  1957        display ' found balloon p or i ' rt-discount-ob-rate
  1958        evaluate true
  1959           when (cp-net-only-state = 'Y')
  1960              and (rt-discount-ob-rate > zeros)
  1961              compute cp-premium-rate = rt-discount-ob-rate / 10
  1962           when (cp-net-only-state = 'Y')
  1963              and (rt-discount-ob-rate = zeros)
  1964              display ' not ob rate     ' cp-premium-rate
  1965              compute cp-premium-rate =
  1966                 cp-premium-rate / cp-original-term * 12
  1967              display ' new rate ' cp-premium-rate
  1968              display ' net only state ' cp-premium-rate
  1969              compute cp-premium-rate rounded =
  1970                (cp-premium-rate *
  1971                   (cp-original-term + 1) / 12) /
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  38
* SUNATEX.cbl (/apps/prod/cid1p/copy/ELCRATPD)
  1972                ((cp-original-term + 2) / 2)
  1973              display ' new OB rate ' cp-premium-rate
  1974           when (cp-net-only-state <> 'Y')
  1975              and (rt-discount-ob-rate = zeros)
  1976              display ' not net only st ' cp-premium-rate
  1977              compute cp-premium-rate =
  1978                 cp-premium-rate / cp-original-term * 12
  1979              display ' new rate ' cp-premium-rate
  1980        end-evaluate
  1981        go to 1240-net-pay-cont
  1982     end-if
  1983
  1984     IF (CP-COMPANY-ID = 'CID')
  1985        AND (CP-STATE-STD-ABBRV = 'ND' OR 'MT' OR 'NJ'
  1986           OR 'IN' OR 'AZ')
  1987        AND (CP-FARM-PLAN)
  1988***  OK, I DID THIS SO ERCNETP WOULDN'T ERROR OUT
  1989***  THE APR ISN'T EVEN USED IN THE ROUTINE, SO SUE ME :)
  1990        MOVE +1.0                TO CP-LOAN-APR
  1991        GO TO 1240-NET-PAY-CONT
  1992     END-IF
  1993
  1994     IF CP-RATE-AS-STANDARD
  1995         GO TO 1210-REGULAR-RATE.
  1996
  1997     IF CP-CRITICAL-PERIOD
  1998         GO TO 1220-CRITICAL-PERIOD-LF-CONT.
  1999
  2000     IF CP-EARN-AS-TEXAS
  2001         GO TO 1230-TEXAS-CONT.
  2002
  2003     IF CP-EARN-AS-NET-PAY
  2004        IF CP-STATE-STD-ABBRV = 'MD'
  2005          IF CP-COMPANY-ID = 'MON'
  2006            IF CP-BENEFIT-CD = '11' OR '12' OR '13' OR
  2007                               '14' OR '26' OR '47'
  2008              GO TO 1210-REGULAR-RATE.
  2009
  2010     IF CP-SPECIAL-CALC-CD EQUAL 'H'
  2011        IF CP-MONTHLY-PAYMENT EQUAL +0
  2012           COMPUTE CP-MONTHLY-PAYMENT EQUAL
  2013                CP-ORIGINAL-BENEFIT / CP-ORIGINAL-TERM.
  2014
  2015     IF CP-COMPANY-ID EQUAL 'GTL'
  2016        NEXT SENTENCE
  2017     ELSE
  2018     IF CP-SPECIAL-CALC-CD EQUAL 'H'
  2019        IF CP-STATE-STD-ABBRV NOT EQUAL 'NY'
  2020           COMPUTE WK3 ROUNDED EQUAL
  2021           CP-ORIGINAL-TERM * (CP-ORIGINAL-TERM - +1) *
  2022           CP-MONTHLY-PAYMENT
  2023           COMPUTE WK3 ROUNDED EQUAL WK3 / 2
  2024           COMPUTE WK3 ROUNDED EQUAL WK3 + (CP-ORIGINAL-TERM *
  2025           CP-ALTERNATE-BENEFIT)
  2026           COMPUTE CP-CALC-PREMIUM ROUNDED EQUAL
  2027           WK3 * WK5
  2028           GO TO 9999-CALC-RATE-PREM-X
  2029        ELSE
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  39
* SUNATEX.cbl (/apps/prod/cid1p/copy/ELCRATPD)
  2030           COMPUTE WK3 ROUNDED EQUAL (CP-MONTHLY-PAYMENT *
  2031           (CP-ORIGINAL-TERM - 1 - WK1)) /
  2032           (WS-WORK-DIS-RATE / +12)
  2033           COMPUTE WK3 EQUAL WK3 + (CP-ALTERNATE-BENEFIT * WK2)
  2034           COMPUTE CP-CALC-PREMIUM ROUNDED EQUAL WK3 *
  2035                               WK5
  2036           GO TO 9999-CALC-RATE-PREM-X.
  2037
  2038     IF CP-COMPANY-ID EQUAL 'GTL' AND
  2039        CP-STATE-STD-ABBRV EQUAL 'RI' AND
  2040        CP-SPECIAL-CALC-CD EQUAL 'H' AND
  2041        CP-ORIGINAL-TERM LESS THAN +61
  2042        COMPUTE CP-CALC-PREMIUM EQUAL
  2043                        (CP-ORIGINAL-BENEFIT *
  2044           (CP-ORIGINAL-TERM + 1) * CP-PREMIUM-RATE) /
  2045           (20 * (1 + .0019 * CP-ORIGINAL-TERM) * 100)
  2046        COMPUTE CP-CALC-PREMIUM EQUAL
  2047                CP-CALC-PREMIUM +
  2048              (CP-ALTERNATE-BENEFIT * CP-PREMIUM-RATE *
  2049        (CP-ORIGINAL-TERM + 1)) /
  2050        (10 * (1 + .0027 * (CP-ORIGINAL-TERM + 1)) * 100)
  2051        GO TO 9999-CALC-RATE-PREM-X.
  2052
  2053     IF CP-COMPANY-ID = 'GTL'     AND
  2054        CP-STATE-STD-ABBRV = 'PA' AND
  2055        CP-SPECIAL-CALC-CD = 'H'
  2056         GO TO 1260-GTL-PA-LEASE.
  2057
  2058     IF (CP-EARN-AS-NET-PAY)
  2059*       AND (CP-LOAN-APR > ZEROS)
  2060        GO TO 1240-NET-PAY-CONT
  2061     END-IF
  2062
  2063     IF CP-LIFE-OVERRIDE-CODE NOT = 'L'
  2064         GO TO 1210-REGULAR-RATE.
  2065
  2066**** CHECK TO SEE IF THE LEVEL PORTION OF A BALLOON IS BEING
  2067**** RATED AND BYPASS NET-PAY CHECK IF NO APR HAS BEEN ENTERED.
  2068****
  2069     IF CP-DEVIATION-CODE = 'LEV' AND
  2070        CP-LOAN-APR = ZEROS
  2071         GO TO 1210-REGULAR-RATE.
  2072
  2073     IF (CP-STATE-STD-ABBRV = 'OH')
  2074        AND (CP-CLASS-CODE NOT = 'L ')
  2075        AND (CP-ORIGINAL-TERM > 60)
  2076        AND (DC-GREG-DATE-CYMD > 19831031)
  2077        AND (CP-LOAN-APR > ZEROS)
  2078        GO TO 1240-NET-PAY-CONT
  2079     END-IF
  2080
  2081     IF (CP-STATE-STD-ABBRV = 'UT')
  2082        AND (CP-ORIGINAL-TERM > 62)
  2083        AND (DC-GREG-DATE-CYMD > 19810831)
  2084        AND (DC-GREG-DATE-CYMD < 19830901)
  2085        AND (CP-LOAN-APR > ZEROS)
  2086        GO TO 1240-NET-PAY-CONT
  2087     END-IF
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  40
* SUNATEX.cbl (/apps/prod/cid1p/copy/ELCRATPD)
  2088
  2089     IF (CP-STATE-STD-ABBRV = 'RI')
  2090        AND (CP-ORIGINAL-TERM > 60)
  2091        AND (DC-GREG-DATE-CYMD > 19831231)
  2092        AND (CP-LOAN-APR > ZEROS)
  2093        GO TO 1240-NET-PAY-CONT
  2094     END-IF
  2095
  2096     .
  2097 1210-REGULAR-RATE.
  2098
  2099     IF (CP-COMPANY-ID = 'CID')
  2100        AND (CP-EARN-AS-NET-PAY)
  2101        AND (CP-LOAN-APR = 0)
  2102        IF RT-L-RATE (WS-RATE-TERM) = 0
  2103           COMPUTE WS-SIN-PREM-RATE =
  2104              (RT-DISCOUNT-OB-RATE / +1000) *
  2105              ((WS-RATE-TERM + +1) / +2)
  2106           COMPUTE CP-PREMIUM-RATE =
  2107              WS-SIN-PREM-RATE /
  2108              (+1 + (((WS-WORK-DIS-RATE / +100) *
  2109              WS-RATE-TERM) / +24))
  2110        ELSE
  2111           MOVE RT-L-RATE (WS-RATE-TERM) TO CP-PREMIUM-RATE
  2112        END-IF
  2113     END-IF
  2114
  2115*    IF CP-SPECIAL-CALC-CD EQUAL 'H'
  2116*       IF CP-MONTHLY-PAYMENT EQUAL +0
  2117*          COMPUTE CP-MONTHLY-PAYMENT EQUAL
  2118*               CP-ORIGINAL-BENEFIT / CP-ORIGINAL-TERM.
  2119*
  2120*    IF CP-SPECIAL-CALC-CD EQUAL 'H'
  2121*       IF CP-STATE-STD-ABBRV NOT EQUAL 'NY'
  2122*          COMPUTE WK3 ROUNDED EQUAL
  2123*          CP-ORIGINAL-TERM * (CP-ORIGINAL-TERM - +1) *
  2124*          CP-MONTHLY-PAYMENT
  2125*          COMPUTE WK3 ROUNDED EQUAL WK3 / 2
  2126*          COMPUTE WK3 ROUNDED EQUAL WK3 + (CP-ORIGINAL-TERM *
  2127*          CP-ALTERNATE-BENEFIT)
  2128*          COMPUTE CP-CALC-PREMIUM ROUNDED EQUAL
  2129*          WK3 * WK5
  2130*          GO TO 9999-CALC-RATE-PREM-X
  2131*       ELSE
  2132*          COMPUTE WK3 ROUNDED EQUAL (CP-MONTHLY-PAYMENT *
  2133*          (CP-ORIGINAL-TERM - 1 - WK1)) /
  2134*          (WS-WORK-DIS-RATE / +12)
  2135*          COMPUTE WK3 EQUAL WK3 + (CP-ALTERNATE-BENEFIT * WK2)
  2136*          COMPUTE CP-CALC-PREMIUM ROUNDED EQUAL WK3 *
  2137*                              WK5
  2138*          GO TO 9999-CALC-RATE-PREM-X.
  2139
  2140     IF CP-TERM-IS-DAYS
  2141         COMPUTE CP-PREMIUM-RATE ROUNDED =
  2142             ((CP-PREMIUM-RATE / CP-ORIGINAL-TERM) * 12) / +365
  2143         COMPUTE CP-CALC-PREMIUM ROUNDED =
  2144             ((CP-ORIGINAL-BENEFIT / 100) * CP-PREMIUM-RATE)
  2145                          * CP-TERM-OR-EXT-DAYS
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  41
* SUNATEX.cbl (/apps/prod/cid1p/copy/ELCRATPD)
  2146           GO TO 9999-CALC-RATE-PREM-X.
  2147
  2148     if (cp-company-id = 'AHL')
  2149        and (cp-loan-term > cp-original-term)
  2150        continue
  2151     else
  2152        IF NOT CP-TRUNCATED-LIFE
  2153           GO TO 1212-GROSS-NOT-TRUNCATED
  2154        end-if
  2155     end-if
  2156
  2157****  GROSS TRUNCATED CALCULATION
  2158
  2159     IF CP-LOAN-TERM NOT GREATER THAN CP-ORIGINAL-TERM
  2160         MOVE 'H'                TO  CP-RETURN-CODE
  2161         GO TO 9999-CALC-RATE-PREM-X.
  2162
  2163     if cp-company-id = 'AHL'
  2164        if (cp-state = 'AZ' OR 'GA' OR 'IN' OR 'MT' OR 'NH'
  2165           OR 'NJ' OR 'OH' OR 'PA' OR 'TX' OR 'VA')
  2166           compute cp-calc-premium rounded = (1 - (cp-loan-term -
  2167           cp-original-term) * (cp-loan-term - cp-original-term
  2168            + 1) / cp-loan-term / (cp-loan-term + 1)) *
  2169            cp-premium-rate / 100 * cp-original-term /
  2170            cp-loan-term * cp-original-benefit
  2171        else
  2172           compute cp-calc-premium rounded = (1 - (cp-loan-term -
  2173           cp-original-term) * (cp-loan-term - cp-original-term
  2174            + 1) / cp-loan-term / (cp-loan-term + 1)) *
  2175            cp-premium-rate * cp-original-benefit / 100
  2176        end-if
  2177        go to 9999-calc-rate-prem-x
  2178     end-if
  2179
  2180
  2181     IF CP-COMPANY-ID = 'NCL'
  2182         COMPUTE WK-MONTHLY-RATE =
  2183               ((((CP-LOAN-TERM * (CP-LOAN-TERM + 1) -
  2184                  (CP-LOAN-TERM - CP-ORIGINAL-TERM) *
  2185                  (CP-LOAN-TERM - CP-ORIGINAL-TERM + 1))
  2186                                 /
  2187                  (CP-LOAN-TERM * (CP-LOAN-TERM + 1))))
  2188                                 *
  2189                  ((RT-L-RATE (12) * CP-LOAN-TERM / 12)))
  2190         COMPUTE CP-CALC-PREMIUM =
  2191                 WK-MONTHLY-RATE * CP-ORIGINAL-BENEFIT / 100
  2192     ELSE
  2193         COMPUTE CP-R-MAX-TERM = CP-LOAN-TERM -
  2194                                 CP-ORIGINAL-TERM
  2195         COMPUTE CP-CALC-PREMIUM = CP-ORIGINAL-BENEFIT *
  2196                     ((RT-L-RATE (CP-LOAN-TERM)  -
  2197                     (1 - (CP-ORIGINAL-TERM / CP-LOAN-TERM)) *
  2198                     RT-L-RATE (CP-R-MAX-TERM)) / 100)
  2199     END-IF
  2200
  2201     IF CP-EXT-CHG-LF OR CP-EXT-CHG-LF-AH
  2202        COMPUTE CP-CALC-PREMIUM ROUNDED = CP-CALC-PREMIUM +
  2203           (((CP-ORIGINAL-BENEFIT / 100) * ((CP-PREMIUM-RATE /
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  42
* SUNATEX.cbl (/apps/prod/cid1p/copy/ELCRATPD)
  2204           CP-ORIGINAL-TERM) / 30)) * CP-TERM-OR-EXT-DAYS)
  2205     END-IF
  2206
  2207     GO TO 9999-CALC-RATE-PREM-X
  2208
  2209     .
  2210 1212-GROSS-NOT-TRUNCATED.
  2211*    DISPLAY ' ELCRATPD '
  2212*    DISPLAY ' MADE IT TO 1212-GROSS-NOT '
  2213*    display ' premium rate ' cp-premium-rate
  2214
  2215     IF (CP-COMPANY-ID = 'CID')
  2216        AND (CP-STATE-STD-ABBRV = 'VT' OR 'MA'
  2217           OR 'IN')
  2218        AND (CP-BENEFIT-CD = '55' OR '56')
  2219        COMPUTE CP-CALC-PREMIUM ROUNDED =
  2220          (CP-ORIGINAL-BENEFIT / (CP-ORIGINAL-TERM)) *
  2221          (CP-ORIGINAL-TERM) *
  2222          ((CP-ORIGINAL-TERM) / 12) *
  2223          ((6.5 * RT-DISCOUNT-OB-RATE) / 1000)
  2224          GO TO 9999-CALC-RATE-PREM-X
  2225     END-IF
  2226
  2227     IF (CP-COMPANY-ID = 'CID')
  2228        AND (CP-STATE-STD-ABBRV = 'GA')
  2229        AND (CP-BENEFIT-CD = '55' OR '56' OR '2M' OR '2N')
  2230        COMPUTE WK3 ROUNDED =
  2231          CP-ORIGINAL-BENEFIT *
  2232          ((CP-ORIGINAL-TERM + 1) / 2) *
  2233          (RT-DISCOUNT-OB-RATE / 1000)
  2234          MOVE WK3 TO CP-CALC-PREMIUM
  2235          GO TO 9999-CALC-RATE-PREM-X
  2236     END-IF
  2237
  2238     IF (CP-COMPANY-ID EQUAL 'CID')
  2239        AND (CP-STATE-STD-ABBRV = 'MN')
  2240        AND (CP-LEVEL-LIFE)
  2241        AND (CP-CERT-EFF-DT > X'A4FF')
  2242        display ' made it to mn level '
  2243        MOVE CP-CERT-EFF-DT      TO DC-BIN-DATE-1
  2244        MOVE CP-EXPIRE-DT        TO DC-BIN-DATE-2
  2245        MOVE '1'                 TO DC-OPTION-CODE
  2246        PERFORM 9100-CONVERT-DATE
  2247                                 THRU 9100-EXIT
  2248        IF DATE-CONVERSION-ERROR
  2249           MOVE '2'              TO CP-RETURN-CODE
  2250           MOVE ZEROS            TO FACTOR
  2251                                 CP-CALC-PREMIUM
  2252           GO TO 9999-CALC-RATE-PREM-X
  2253        END-IF
  2254        MOVE DC-ELAPSED-DAYS     TO D
  2255        COMPUTE CP-MONTHLY-PAYMENT = CP-ORIGINAL-BENEFIT /
  2256           (1 / (1 + (CP-LOAN-APR / 100) * D / 360) -
  2257           (CP-PREMIUM-RATE * 12 / 365 * D / 1000))
  2258        COMPUTE CP-CALC-PREMIUM = CP-MONTHLY-PAYMENT *
  2259           CP-PREMIUM-RATE * 12 / 365 * D / 1000
  2260        GO TO 9999-CALC-RATE-PREM-X
  2261     END-IF
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  43
* SUNATEX.cbl (/apps/prod/cid1p/copy/ELCRATPD)
  2262
  2263     IF (CP-COMPANY-ID = 'CID')
  2264        AND (CP-BENEFIT-CD (1:1) = 'M' OR 'N' OR 'H')
  2265        COMPUTE CP-CALC-PREMIUM ROUNDED =
  2266           (CP-ORIGINAL-BENEFIT / 1000) * CP-PREMIUM-RATE
  2267     ELSE
  2268        COMPUTE CP-CALC-PREMIUM ROUNDED =
  2269                 (CP-ORIGINAL-BENEFIT / 100) * CP-PREMIUM-RATE
  2270     END-IF
  2271*    display ' calc premium ' cp-calc-premium
  2272
  2273*    IF CP-COMPANY-ID = 'LBL'
  2274     IF (CP-COMPANY-ID = 'LBL' OR 'CID')
  2275        AND (NOT CP-EARN-AS-NET-PAY)
  2276        GO TO 9999-CALC-RATE-PREM-X
  2277     END-IF
  2278
  2279*    display ' fell through to ext days '
  2280     IF CP-TERM-OR-EXT-DAYS = ZEROS
  2281         GO TO 9999-CALC-RATE-PREM-X.
  2282
  2283     IF CP-EXT-CHG-LF OR CP-EXT-CHG-LF-AH
  2284         COMPUTE CP-CALC-PREMIUM ROUNDED = CP-CALC-PREMIUM +
  2285            (((CP-ORIGINAL-BENEFIT / 100) * ((CP-PREMIUM-RATE /
  2286               CP-ORIGINAL-TERM) / 30)) * CP-TERM-OR-EXT-DAYS).
  2287
  2288     GO TO 9999-CALC-RATE-PREM-X.
  2289
  2290 1220-CRITICAL-PERIOD-LF-CONT.
  2291     COMPUTE CP-CALC-PREMIUM ROUNDED =
  2292               (CP-ORIGINAL-BENEFIT / +100) * CP-PREMIUM-RATE.
  2293
  2294     GO TO 9999-CALC-RATE-PREM-X.
  2295
  2296 1230-TEXAS-CONT.
  2297     IF CP-FARM-PLAN
  2298         GO TO 1235-TEXAS-FARM-CONT.
  2299
  2300     COMPUTE CP-CALC-PREMIUM ROUNDED =
  2301               (CP-ORIGINAL-BENEFIT / 100) * CP-PREMIUM-RATE.
  2302
  2303     COMPUTE TEX-FACT-9 =
  2304                 (CP-ORIGINAL-TERM + CP-PAY-FREQUENCY) /
  2305                 (CP-ORIGINAL-TERM + 1).
  2306
  2307     COMPUTE CP-CALC-PREMIUM ROUNDED =
  2308                 CP-CALC-PREMIUM * TEX-FACT-9.
  2309
  2310     GO TO 9999-CALC-RATE-PREM-X.
  2311
  2312 1235-TEXAS-FARM-CONT.
  2313     COMPUTE WS-FARM-TERM =
  2314               (CP-ORIGINAL-TERM + CP-PAY-FREQUENCY).
  2315
  2316     COMPUTE WS-PREMIUM-RATE = RT-L-RATE (WS-FARM-TERM) / 2.
  2317     MOVE WS-PREMIUM-RATE         TO CP-PREMIUM-RATE.
  2318
  2319
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  44
* SUNATEX.cbl (/apps/prod/cid1p/copy/ELCRATPD)
  2320     COMPUTE CP-CALC-PREMIUM ROUNDED =
  2321              (CP-ORIGINAL-BENEFIT / 100) * CP-PREMIUM-RATE.
  2322
  2323     GO TO 9999-CALC-RATE-PREM-X.
  2324
  2325 1240-NET-PAY-CONT.
  2326
  2327     MOVE CP-LOAN-APR             TO N-P-APR.
  2328     MOVE CP-ORIGINAL-TERM        TO N-P-ORIG
  2329                                     N-P-REM
  2330                                     N-P-LOAN.
  2331
  2332     MOVE CP-SPECIAL-CALC-CD      TO N-P-OPT.
  2333
  2334     IF CP-TRUNCATED-LIFE
  2335         MOVE CP-LOAN-TERM        TO N-P-LOAN.
  2336
  2337     IF CP-COMPANY-ID EQUAL 'NCL'
  2338        NEXT SENTENCE
  2339     ELSE
  2340        GO TO 1241-NET-PAY-CONT.
  2341
  2342     MOVE CP-CERT-EFF-DT         TO DC-BIN-DATE-1
  2343     MOVE CP-FIRST-PAY-DATE      TO DC-BIN-DATE-2
  2344     MOVE '1'                    TO DC-OPTION-CODE
  2345     PERFORM 9100-CONVERT-DATE THRU 9100-EXIT.
  2346     IF DATE-CONVERSION-ERROR
  2347         MOVE '2'                TO CP-RETURN-CODE
  2348         GO TO 9999-CALC-RATE-PREM-X
  2349     ELSE
  2350        MOVE DC-ELAPSED-MONTHS   TO CP-MNTHS-TO-FIRST-PMT
  2351        MOVE DC-ODD-DAYS-OVER    TO CP-ODD-DAYS-TO-PMT.
  2352
  2353     IF (CP-EXT-CHG-LF OR CP-EXT-CHG-LF-AH) AND
  2354        (CP-ODD-DAYS-TO-PMT NOT EQUAL ZEROS)
  2355        NEXT SENTENCE
  2356     ELSE
  2357        MOVE +1                  TO ODF
  2358        GO TO 1241-NET-PAY-CONT.
  2359
  2360     IF CP-MNTHS-TO-FIRST-PMT GREATER THAN ZERO
  2361        COMPUTE CP-PREMIUM-RATE EQUAL
  2362        ((CP-PREMIUM-RATE / N-P-LOAN * (N-P-LOAN + 1)) -
  2363        CP-PREMIUM-RATE) *
  2364        (CP-ODD-DAYS-TO-PMT * 12 / 365) + CP-PREMIUM-RATE.
  2365
  2366     IF CP-MNTHS-TO-FIRST-PMT EQUAL ZEROS
  2367        COMPUTE CP-PREMIUM-RATE EQUAL
  2368        (CP-PREMIUM-RATE - (CP-PREMIUM-RATE /
  2369        N-P-LOAN * (N-P-LOAN - 1))) *
  2370        (CP-ODD-DAYS-TO-PMT * 12 / 365) +
  2371        (CP-PREMIUM-RATE / N-P-LOAN * (N-P-LOAN - 1)).
  2372
  2373     COMPUTE ODF EQUAL
  2374     ((1 + (N-P-APR / +1200)) ** (1 - CP-MNTHS-TO-FIRST-PMT)) /
  2375     ((1 + (CP-ODD-DAYS-TO-PMT * 12 / 36500))).
  2376
  2377 1241-NET-PAY-CONT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  45
* SUNATEX.cbl (/apps/prod/cid1p/copy/ELCRATPD)
  2378
  2379     PERFORM 10000-NET-TERM THRU 99999-EXIT.
  2380
  2381*    IF CP-RETURN-CODE EQUAL '0' OR '8'
  2382     IF CP-RETURN-CODE EQUAL '0' OR '8' OR '9' OR 'B'
  2383        NEXT SENTENCE
  2384     ELSE
  2385        GO TO 9999-CALC-RATE-PREM-X.
  2386
  2387     IF RT-DISCOUNT-OPTION EQUAL '6'
  2388         GO TO 9999-CALC-RATE-PREM-X.
  2389
  2390     IF (CP-COMPANY-ID EQUAL 'GTL') AND
  2391        (CP-STATE-STD-ABBRV EQUAL 'IA')
  2392        GO TO 9999-CALC-RATE-PREM-X.
  2393
  2394     MOVE N-P-FACTOR              TO CP-CDT-FACTOR.
  2395
  2396     IF RT-DISCOUNT-OPTION EQUAL '3' OR '4' OR '5'
  2397        GO TO 9999-CALC-RATE-PREM-X.
  2398
  2399     IF (CP-COMPANY-ID EQUAL 'MON') AND
  2400        (CP-STATE-STD-ABBRV EQUAL 'MD') AND
  2401        (CP-TRUNCATED-LIFE)
  2402        GO TO 9999-CALC-RATE-PREM-X.
  2403
  2404     IF (CP-COMPANY-ID EQUAL 'CSL') AND
  2405        (CP-CSL-VALID-NP-BENEFIT-CD)
  2406        GO TO 9999-CALC-RATE-PREM-X.
  2407
  2408     IF (CP-COMPANY-ID EQUAL 'TMS') AND
  2409        (CP-STATE-STD-ABBRV EQUAL 'MN' OR 'CA' OR 'WA') AND
  2410        (CP-EARN-AS-NET-PAY)
  2411        GO TO 9999-CALC-RATE-PREM-X.
  2412
  2413*    IF (CP-COMPANY-ID EQUAL 'CID') AND
  2414*       (CP-STATE-STD-ABBRV EQUAL 'NV') AND
  2415*       (CP-EARN-AS-NET-PAY OR CP-TRUNCATED-LIFE)
  2416*       GO TO 9999-CALC-RATE-PREM-X.
  2417
  2418     IF (CP-COMPANY-ID EQUAL 'NCB') AND
  2419        (CP-STATE-STD-ABBRV EQUAL 'NC') AND
  2420        (CP-EARN-AS-NET-PAY)
  2421        GO TO 9999-CALC-RATE-PREM-X.
  2422
  2423     IF (CP-COMPANY-ID EQUAL 'WDS') AND
  2424        (CP-STATE-STD-ABBRV EQUAL 'MN' OR 'NC') AND
  2425        (CP-EARN-AS-NET-PAY OR CP-EARN-AS-REG-BALLOON)
  2426        GO TO 9999-CALC-RATE-PREM-X.
  2427
  2428     IF (CP-COMPANY-ID EQUAL 'NCL') AND
  2429        (CP-EARN-AS-NET-PAY)
  2430        GO TO 9999-CALC-RATE-PREM-X.
  2431
  2432     IF (CP-COMPANY-ID EQUAL 'GTL') AND
  2433        (CP-STATE-STD-ABBRV EQUAL 'NJ') AND
  2434        (CP-TRUNCATED-LIFE)
  2435        GO TO 9999-CALC-RATE-PREM-X.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  46
* SUNATEX.cbl (/apps/prod/cid1p/copy/ELCRATPD)
  2436
  2437     IF (CP-COMPANY-ID EQUAL 'GTL') AND
  2438        (CP-STATE-STD-ABBRV EQUAL 'GA') AND
  2439        (CP-EARN-AS-NET-PAY)
  2440*       (CP-TRUNCATED-LIFE)
  2441        GO TO 9999-CALC-RATE-PREM-X.
  2442
  2443     IF (CP-COMPANY-ID EQUAL 'GTL') AND
  2444        (CP-STATE-STD-ABBRV EQUAL 'RI')
  2445                   AND
  2446        ((CP-EARN-AS-NET-PAY)
  2447               OR
  2448        (CP-SPECIAL-CALC-CD EQUAL 'H'))
  2449        GO TO 9999-CALC-RATE-PREM-X.
  2450
  2451     IF (CP-COMPANY-ID EQUAL 'GTL') AND
  2452        (CP-STATE-STD-ABBRV EQUAL 'MA') AND
  2453        (CP-EARN-AS-NET-PAY) AND
  2454        (CP-SPECIAL-CALC-CD EQUAL 'H')
  2455        GO TO 9999-CALC-RATE-PREM-X.
  2456
  2457     IF (CP-COMPANY-ID EQUAL 'GTL') AND
  2458        (CP-STATE-STD-ABBRV EQUAL 'OR') AND
  2459        (CP-EARN-AS-NET-PAY)
  2460        GO TO 9999-CALC-RATE-PREM-X.
  2461
  2462     IF CP-COMPANY-ID = 'CID' or 'AHL'
  2463        CONTINUE
  2464     ELSE
  2465        IF (CP-STATE-STD-ABBRV EQUAL 'NC') AND
  2466           (CP-EARN-AS-NET-PAY) AND
  2467           (DC-GREG-DATE-CYMD GREATER THAN 19931231)
  2468           GO TO 9999-CALC-RATE-PREM-X
  2469        END-IF
  2470     END-IF
  2471
  2472     IF (CP-COMPANY-ID = 'CID')
  2473        AND (CP-EARN-AS-NET-PAY)
  2474        AND (CP-STATE-STD-ABBRV = 'ME')
  2475        GO TO 9999-CALC-RATE-PREM-X
  2476     END-IF
  2477
  2478     IF (CP-COMPANY-ID = 'DCC')
  2479        AND (CP-BEN-CATEGORY = 'D')
  2480        AND (CP-EARN-AS-NET-PAY)
  2481        GO TO 9999-CALC-RATE-PREM-X
  2482     END-IF
  2483
  2484     IF (CP-COMPANY-ID = 'CID')
  2485        AND (CP-STATE-STD-ABBRV = 'ND' OR 'MT' OR 'NJ'
  2486           OR 'IN' OR 'AZ')
  2487        AND (CP-FARM-PLAN)
  2488        GO TO 9999-CALC-RATE-PREM-X
  2489     END-IF
  2490
  2491     IF (CP-COMPANY-ID = 'CID') AND
  2492        (CP-EARN-AS-NET-PAY) AND
  2493        (CP-LEVEL-LIFE) AND
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  47
* SUNATEX.cbl (/apps/prod/cid1p/copy/ELCRATPD)
  2494        (CP-STATE-STD-ABBRV = 'CA' OR 'MN') AND
  2495        (CP-STATE-STD-ABBRV = CP-STATE)
  2496        GO TO 9999-CALC-RATE-PREM-X
  2497     END-IF
  2498
  2499     IF (CP-COMPANY-ID = 'CID') AND
  2500        (CP-EARN-AS-NET-PAY) AND
  2501        ((CP-STATE-STD-ABBRV = 'MT' OR 'NJ' OR 'PA'
  2502                            OR 'VT')
  2503                   OR
  2504        ((CP-STATE-STD-ABBRV = 'IN') AND
  2505        (CP-CERT-EFF-DT > X'9A7F'))
  2506                   OR
  2507        ((CP-STATE-STD-ABBRV = 'AZ' OR 'ND') AND
  2508        (CP-CERT-EFF-DT > X'9ADF'))) AND
  2509        (CP-STATE-STD-ABBRV = CP-STATE)
  2510        GO TO 9999-CALC-RATE-PREM-X
  2511     END-IF
  2512
  2513     IF (CP-COMPANY-ID = 'CID') AND
  2514        (CP-EARN-AS-NET-PAY) AND
  2515        (CP-STATE-STD-ABBRV = 'TX') AND
  2516        (CP-STATE-STD-ABBRV = CP-STATE) AND
  2517        (WS-DISCOUNT-OPTION NOT = ' ')
  2518        GO TO 9999-CALC-RATE-PREM-X
  2519     END-IF
  2520
  2521     if (cp-company-id = 'CID')
  2522        and (cp-state-std-abbrv = 'WA')
  2523        and (rt-discount-option = '1')
  2524        and (cp-earn-as-farm-plan)
  2525        go to 9999-calc-rate-prem-x
  2526     end-if
  2527
  2528     if (cp-company-id = 'CID')
  2529        and (cp-earn-as-reg-balloon)
  2530        and (cp-ben-category = 'P' or 'I')
  2531        GO TO 9999-CALC-RATE-PREM-X
  2532     end-if
  2533
  2534     IF (CP-COMPANY-ID = 'CID')
  2535        AND (CP-STATE-STD-ABBRV = 'MN')
  2536        AND (RT-DISCOUNT-OPTION = '1')
  2537        AND (CP-EARN-AS-NET-PAY OR CP-EARN-AS-REG-BALLOON OR
  2538           CP-EARN-AS-FARM-PLAN)
  2539        display ' made it to mn 4 '
  2540        GO TO 9999-CALC-RATE-PREM-X
  2541     END-IF
  2542
  2543     IF (CP-COMPANY-ID = 'CID')
  2544        AND (CP-EARN-AS-NET-PAY)
  2545        AND ((CP-STATE-STD-ABBRV = 'NH' OR 'NV' OR 'WA' OR 'AK')
  2546                      OR
  2547            (CP-BENEFIT-CD = '49' OR '50' OR '53' OR '54'))
  2548        GO TO 9999-CALC-RATE-PREM-X
  2549     END-IF
  2550
  2551     IF (CP-COMPANY-ID = 'CID')
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  48
* SUNATEX.cbl (/apps/prod/cid1p/copy/ELCRATPD)
  2552        AND (CP-EARN-AS-NET-PAY)
  2553        AND (CP-STATE-STD-ABBRV = 'SC')
  2554        AND (CP-BENEFIT-CD = '2I' OR '2J' OR '2K' OR '2L')
  2555        GO TO 9999-CALC-RATE-PREM-X
  2556     END-IF
  2557
  2558     IF (CP-COMPANY-ID = 'CID') AND
  2559        (CP-EARN-AS-NET-PAY) AND
  2560        (CP-TRUNCATED-LIFE) AND
  2561        (CP-STATE-STD-ABBRV = 'CA' OR 'VA') AND
  2562        (CP-STATE-STD-ABBRV = CP-STATE) AND
  2563        (WS-DISCOUNT-OPTION NOT = ' ')
  2564        GO TO 9999-CALC-RATE-PREM-X
  2565     END-IF
  2566
  2567     IF (CP-COMPANY-ID EQUAL 'DCC') AND
  2568        (CP-EARN-AS-NET-PAY)
  2569        MOVE WS-PREMIUM-RATE  TO CP-PREMIUM-RATE
  2570        GO TO 9999-CALC-RATE-PREM-X
  2571     END-IF
  2572
  2573     IF (CP-COMPANY-ID EQUAL 'CID')
  2574        AND (CP-EARN-AS-NET-PAY)
  2575        AND (CP-BENEFIT-CD (1:1) = 'M' OR 'N' OR 'H')
  2576        GO TO 9999-CALC-RATE-PREM-X
  2577     END-IF
  2578
  2579     IF (RT-IS-OB) AND
  2580        (CP-COMPANY-ID NOT EQUAL 'CID')
  2581        COMPUTE CP-PREMIUM-RATE ROUNDED =
  2582               (CP-PREMIUM-RATE * 12) / CP-LOAN-TERM
  2583      ELSE
  2584         IF (CP-COMPANY-ID = 'DCC')
  2585            AND (CP-RATE-DEV-PCT NOT = ZEROS)
  2586            COMPUTE CP-CALC-PREMIUM ROUNDED =
  2587*           COMPUTE CP-PREMIUM-RATE ROUNDED =
  2588             (CP-PREMIUM-RATE * CP-RATE-DEV-PCT * 12) /
  2589               CP-ORIGINAL-TERM
  2590             MOVE CP-CALC-PREMIUM TO CP-PREMIUM-RATE
  2591             MOVE ZEROS          TO CP-RATE-DEV-PCT
  2592        ELSE
  2593           COMPUTE CP-PREMIUM-RATE ROUNDED =
  2594               (CP-PREMIUM-RATE * 12) / CP-ORIGINAL-TERM
  2595        END-IF
  2596     END-IF
  2597
  2598     IF CP-ROA-PREM-AT-REFUND
  2599         COMPUTE NET-BEN ROUNDED =
  2600             (CP-REMAINING-BENEFIT - CP-ORIGINAL-PREMIUM) / 1000
  2601     ELSE
  2602         COMPUTE NET-BEN ROUNDED =
  2603              (CP-ORIGINAL-BENEFIT - CP-ORIGINAL-PREMIUM) / 1000.
  2604
  2605     IF (CP-EXT-CHG-LF OR CP-EXT-CHG-LF-AH) AND
  2606        (CP-TERM-OR-EXT-DAYS NOT = ZERO)
  2607          COMPUTE NET-BEN ROUNDED =
  2608              NET-BEN * (1 + (CP-LOAN-APR / 1200) *
  2609                         (CP-TERM-OR-EXT-DAYS / 30)).
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  49
* SUNATEX.cbl (/apps/prod/cid1p/copy/ELCRATPD)
  2610
  2611     IF CP-COMPANY-ID = 'CDC' OR 'GTL' OR 'CID' OR 'MON' OR 'HAN'
  2612*       OR 'DCC'
  2613*    IF CP-COMPANY-ID = 'CDC' OR 'GTL' OR 'MON' OR 'HAN'
  2614     COMPUTE CP-CALC-PREMIUM ROUNDED = NET-BEN * 1000 *
  2615       (N-P-FACTOR * CP-PREMIUM-RATE * CP-ORIGINAL-TERM / 1200) /
  2616       (1 - (N-P-FACTOR * CP-PREMIUM-RATE
  2617                        * CP-ORIGINAL-TERM / 1200))
  2618     ELSE
  2619     COMPUTE CP-CALC-PREMIUM ROUNDED = NET-BEN * 1000 *
  2620       (N-P-FACTOR * CP-PREMIUM-RATE * WS-RATE-TERM / 1200) /
  2621       (1 - (N-P-FACTOR * CP-PREMIUM-RATE * WS-RATE-TERM / 1200)).
  2622
  2623****** THE BELOW VERSION OF THE NET PAY FORMULA IS USED WHEN NO
  2624****** INTEREST IS CHARGED ON PREMIUM.
  2625
  2626*    IF CP-STATE-STD-ABBRV = 'MI'
  2627*         COMPUTE CP-CALC-PREMIUM ROUNDED = NET-BEN * 1000 *
  2628*          (N-P-FACTOR * CP-PREMIUM-RATE * WS-RATE-TERM / 1200).
  2629
  2630     MOVE WS-PREMIUM-RATE  TO CP-PREMIUM-RATE.
  2631
  2632     GO TO 9999-CALC-RATE-PREM-X.
  2633
  2634******
  2635****** BELOW ARE PREMIUM CALCULATIONS FOR CSL
  2636******
  2637
  2638 1250-CSL-CALC.
  2639     MOVE CP-CERT-EFF-DT TO DC-BIN-DATE-1.
  2640     MOVE CP-FIRST-PAY-DATE TO DC-BIN-DATE-2.
  2641     MOVE '1' TO DC-OPTION-CODE.
  2642     PERFORM 9100-CONVERT-DATE THRU 9100-EXIT.
  2643
  2644     IF DATE-CONVERSION-ERROR
  2645         MOVE '2' TO CP-RETURN-CODE
  2646         GO TO 9999-CALC-RATE-PREM-X.
  2647
  2648     IF CP-JOINT-INDICATOR = 'J'
  2649         MOVE RT-L-RATE (3) TO WK-RED-RATE
  2650     ELSE
  2651         MOVE RT-L-RATE (1) TO WK-RED-RATE.
  2652
  2653     MOVE WK-RED-RATE TO CP-PREMIUM-RATE.
  2654     MOVE CP-REMAINING-BENEFIT TO WK-PAY-AMT.
  2655
  2656     IF CP-PAY-FREQUENCY = 12
  2657         MOVE 01               TO WS-PAY-SCH.
  2658     IF CP-PAY-FREQUENCY = 04
  2659         MOVE 03               TO WS-PAY-SCH.
  2660     IF CP-PAY-FREQUENCY = 02
  2661         MOVE 06               TO WS-PAY-SCH.
  2662     IF CP-PAY-FREQUENCY = 01
  2663         MOVE 12               TO WS-PAY-SCH.
  2664
  2665     COMPUTE WS-NUM-PAYMTS = CP-ORIGINAL-TERM / WS-PAY-SCH.
  2666     IF CP-PAY-FREQUENCY NOT = 12
  2667         COMPUTE WK-PAY-AMT = CP-REMAINING-BENEFIT /
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  50
* SUNATEX.cbl (/apps/prod/cid1p/copy/ELCRATPD)
  2668                                WS-NUM-PAYMTS.
  2669
  2670     IF CP-STATE = 'SC'  AND
  2671       (CP-BENEFIT-CD = '07'  OR  '08')
  2672         GO TO 1250-CSL-CALC-LIFE-6.
  2673
  2674     IF CP-CSL-METH-1
  2675         GO TO 1250-CSL-CALC-LIFE-1.
  2676
  2677     IF CP-CSL-METH-2
  2678         IF (WK-PAY-AMT * CP-LOAN-TERM) GREATER THAN
  2679                          WS-MAX-TOT-BEN
  2680             GO TO 1250-CSL-CALC-LIFE-2
  2681         ELSE
  2682             GO TO 1250-CSL-CALC-LIFE-1.
  2683
  2684     IF CP-CSL-METH-3
  2685         IF WK-PAY-AMT GREATER THAN WS-MAX-MON-BEN
  2686             GO TO 1250-CSL-CALC-LIFE-2
  2687         ELSE
  2688             GO TO 1250-CSL-CALC-LIFE-3.
  2689
  2690     IF CP-CSL-METH-4
  2691         IF (WK-PAY-AMT * WS-NUM-PAYMTS) GREATER THAN
  2692                          WS-MAX-TOT-BEN
  2693             GO TO 1250-CSL-CALC-LIFE-5
  2694         ELSE
  2695             GO TO 1250-CSL-CALC-LIFE-4.
  2696
  2697 1250-CSL-CALC-LIFE-1.
  2698     IF CP-JOINT-INDICATOR = 'J'
  2699         MOVE RT-L-RATE (4) TO WK-LEV-RATE
  2700     ELSE
  2701         MOVE RT-L-RATE (2) TO WK-LEV-RATE.
  2702
  2703     COMPUTE WK-D = (((DC-ELAPSED-DAYS * CP-PAY-FREQUENCY) /
  2704                    365) - 1) * 365 / 12.
  2705     COMPUTE WK-S ROUNDED = ((144 * WK-D * WK-LEV-RATE) +
  2706                    (365 * WS-NUM-PAYMTS * WK-RED-RATE)) /
  2707                    4380.
  2708     COMPUTE CP-CALC-PREMIUM ROUNDED = WK-PAY-AMT *
  2709                    WS-NUM-PAYMTS * WK-S.
  2710
  2711     GO TO 9999-CALC-RATE-PREM-X.
  2712
  2713 1250-CSL-CALC-LIFE-2.
  2714     IF CP-JOINT-INDICATOR = 'J'
  2715         MOVE RT-L-RATE (4) TO WK-LEV-RATE
  2716     ELSE
  2717         MOVE RT-L-RATE (2) TO WK-LEV-RATE.
  2718
  2719     COMPUTE WK-K = WS-MAX-TOT-BEN / WK-PAY-AMT.
  2720     COMPUTE WK-S ROUNDED = (WK-K * WK-RED-RATE) / 12.
  2721     COMPUTE WK-D = (((DC-ELAPSED-DAYS * CP-PAY-FREQUENCY / 365)
  2722                    - 1) + WS-NUM-PAYMTS - WK-K) *
  2723                    (WK-LEV-RATE * WS-MAX-TOT-BEN).
  2724     COMPUTE CP-CALC-PREMIUM ROUNDED = (WK-PAY-AMT * WK-K *
  2725                    WK-S) + WK-D.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  51
* SUNATEX.cbl (/apps/prod/cid1p/copy/ELCRATPD)
  2726
  2727     GO TO 9999-CALC-RATE-PREM-X.
  2728
  2729 1250-CSL-CALC-LIFE-3.
  2730     IF CP-JOINT-INDICATOR = 'J'
  2731         MOVE RT-L-RATE (4) TO WK-LEV-RATE
  2732     ELSE
  2733         MOVE RT-L-RATE (2) TO WK-LEV-RATE.
  2734
  2735     COMPUTE WK-K = WS-MAX-TOT-BEN / WK-PAY-AMT.
  2736     COMPUTE WK-S ROUNDED = (WK-K * WK-RED-RATE) / 12.
  2737     COMPUTE WK-D = (((DC-ELAPSED-DAYS * CP-PAY-FREQUENCY / 365)
  2738                    - 1) + WS-NUM-PAYMTS - WK-K) *
  2739                    (WK-LEV-RATE * WS-MAX-TOT-BEN).
  2740     COMPUTE CP-CALC-PREMIUM ROUNDED = (WK-PAY-AMT * WK-K *
  2741                    WK-S) + WK-D.
  2742
  2743     GO TO 9999-CALC-RATE-PREM-X.
  2744
  2745 1250-CSL-CALC-LIFE-4.
  2746     IF CP-JOINT-INDICATOR = 'J'
  2747         MOVE RT-L-RATE (4) TO WK-LEV-RATE
  2748     ELSE
  2749         MOVE RT-L-RATE (2) TO WK-LEV-RATE.
  2750
  2751     COMPUTE WK-D = DC-ELAPSED-DAYS * 12 / 365.
  2752     COMPUTE WK-S ROUNDED =
  2753                    (((6 * (WS-NUM-PAYMTS - 1)) + (WK-D *
  2754                    CP-PAY-FREQUENCY)) * WK-LEV-RATE) /
  2755                    CP-PAY-FREQUENCY.
  2756     COMPUTE CP-CALC-PREMIUM ROUNDED =  WK-PAY-AMT *
  2757                    WS-NUM-PAYMTS * WK-S.
  2758
  2759     GO TO 9999-CALC-RATE-PREM-X.
  2760
  2761 1250-CSL-CALC-LIFE-5.
  2762     IF CP-JOINT-INDICATOR = 'J'
  2763         MOVE RT-L-RATE (4) TO WK-LEV-RATE
  2764     ELSE
  2765         MOVE RT-L-RATE (2) TO WK-LEV-RATE.
  2766
  2767     COMPUTE WK-K = WS-MAX-TOT-BEN / WK-PAY-AMT.
  2768     COMPUTE WK-S ROUNDED = (6 * (WK-K + 1) * WK-LEV-RATE) /
  2769                    CP-PAY-FREQUENCY.
  2770     COMPUTE WK-U = ((((DC-ELAPSED-DAYS * CP-PAY-FREQUENCY / 365)
  2771                    - 1) + WS-NUM-PAYMTS) * 12) /
  2772                    CP-PAY-FREQUENCY.
  2773     COMPUTE WK-L = WK-U - (12 * WK-K / CP-PAY-FREQUENCY).
  2774     COMPUTE CP-CALC-PREMIUM ROUNDED = (WK-L * WK-LEV-RATE *
  2775                    WS-MAX-TOT-BEN) + (WK-K * WK-PAY-AMT * WK-S).
  2776
  2777     GO TO 9999-CALC-RATE-PREM-X.
  2778
  2779 1250-CSL-CALC-LIFE-6.
  2780
  2781     COMPUTE CP-PREMIUM-RATE ROUNDED =
  2782                (CP-PREMIUM-RATE * CP-ORIGINAL-TERM) / 12.
  2783
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  52
* SUNATEX.cbl (/apps/prod/cid1p/copy/ELCRATPD)
  2784     COMPUTE CP-CALC-PREMIUM ROUNDED =
  2785                    CP-ORIGINAL-BENEFIT * CP-PREMIUM-RATE.
  2786
  2787     GO TO 9999-CALC-RATE-PREM-X.
  2788
  2789******
  2790****** END OF PREMIUM CALCULATIONS FOR CSL
  2791******
  2792
  2793 1260-GTL-PA-LEASE.
  2794
  2795     IF CP-REDUCING-LIFE
  2796         MOVE RT-L-RATE (CP-ORIGINAL-TERM)
  2797                                 TO  CP-PREMIUM-RATE
  2798         COMPUTE CP-CALC-PREMIUM ROUNDED EQUAL
  2799                 CP-ORIGINAL-BENEFIT * CP-PREMIUM-RATE / +100
  2800     ELSE
  2801         MOVE RT-L-RATE (CP-ORIGINAL-TERM)
  2802                                 TO  CP-PREMIUM-RATE
  2803         COMPUTE CP-CALC-PREMIUM ROUNDED EQUAL
  2804                 CP-ORIGINAL-BENEFIT * CP-PREMIUM-RATE *
  2805                 (+1 + CP-SALES-TAX) / +100.
  2806
  2807     GO TO 9999-CALC-RATE-PREM-X.
  2808
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  53
* SUNATEX.cbl (/apps/prod/cid1p/copy/ELCRATPD)
  2810******************************************************************
  2811 2000-TYPE-IS-AH.
  2812     MOVE RT-MAX-AGE                TO CP-R-MAX-ATT-AGE.
  2813
  2814     MOVE ZERO                      TO CP-R-MAX-AGE
  2815                                       CP-R-MAX-TERM
  2816                                       CP-R-MAX-MON-BEN
  2817                                       CP-R-MAX-TOT-BEN.
  2818
  2819     IF RT-POLICY-FEE NUMERIC
  2820        MOVE RT-POLICY-FEE          TO CP-POLICY-FEE.
  2821
  2822     IF RT-COMPOSITE-RATE NOT NUMERIC
  2823        MOVE ZEROS                          TO RT-COMPOSITE-RATE.
  2824
  2825
  2826     IF CP-ORIGINAL-TERM > ZERO AND < 361
  2827        MOVE RT-AH-RATE (CP-ORIGINAL-TERM)
  2828                                 TO CP-PREMIUM-RATE
  2829                                    WS-PREMIUM-RATE
  2830        MOVE RT-COMPOSITE-RATE   TO CP-COMPOSITE-RATE
  2831     ELSE
  2832         MOVE +0                 TO CP-PREMIUM-RATE
  2833                                    CP-CALC-PREMIUM
  2834         GO TO 9999-CALC-RATE-PREM-X
  2835     END-IF
  2836
  2837     IF (CP-COMPANY-ID = 'DCC')
  2838        AND (CP-DDF-SPEC-CALC = 'T')
  2839        AND (CP-LOAN-TERM > ZERO AND < 361)
  2840        MOVE RT-AH-RATE (CP-LOAN-TERM)
  2841                                 TO CP-PREMIUM-RATE
  2842                                    WS-PREMIUM-RATE
  2843     END-IF
  2844
  2845*    IF (CP-COMPANY-ID = 'DCC')
  2846*       AND ((CP-BENEFIT-CD (1:1) = 'P')
  2847*       OR (CP-DDF-SPEC-CALC = 'T'))
  2848*       AND (CP-LOAN-TERM > ZERO AND < 361)
  2849*       MOVE RT-AH-RATE (CP-LOAN-TERM)
  2850*                                TO CP-PREMIUM-RATE
  2851*                                   WS-PREMIUM-RATE
  2852*    END-IF
  2853
  2854     MOVE +1 TO AHNDX.
  2855
  2856     IF CP-COMPANY-ID EQUAL 'CRI'
  2857        IF CP-SIG-SWITCH EQUAL 'S' OR 'J'
  2858           MOVE +5               TO AHNDX
  2859           IF RT-AH-AGE (AHNDX) EQUAL ZERO
  2860              MOVE 'F'           TO CP-RETURN-CODE
  2861              GO TO 2200-CALCULATE-PREMIUMS.
  2862
  2863     IF RT-AH-AGE (AHNDX) = ZERO
  2864          GO TO 2200-CALCULATE-PREMIUMS.
  2865
  2866 2100-SEARCH-AH-LIMITS.
  2867
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  54
* SUNATEX.cbl (/apps/prod/cid1p/copy/ELCRATPD)
  2868     IF CP-COMPANY-ID EQUAL 'CRI'
  2869        IF CP-SIG-SWITCH NOT EQUAL 'S' AND 'J'
  2870           IF AHNDX GREATER THAN +4
  2871              MOVE 'A'             TO CP-RETURN-CODE
  2872              GO TO 2200-CALCULATE-PREMIUMS.
  2873
  2874     IF AHNDX GREATER +8
  2875         MOVE 'A'                TO CP-RETURN-CODE
  2876         GO TO 2200-CALCULATE-PREMIUMS.
  2877
  2878     IF CP-ISSUE-AGE GREATER RT-AH-AGE (AHNDX)
  2879         IF RT-AH-AGE (AHNDX) = ZEROS
  2880             ADD +1               TO AHNDX
  2881             GO TO 2100-SEARCH-AH-LIMITS
  2882         ELSE
  2883             MOVE RT-AH-AGE (AHNDX)
  2884                                 TO CP-R-MAX-AGE
  2885             MOVE RT-AH-TERM (AHNDX)
  2886                                 TO CP-R-MAX-TERM
  2887             MOVE RT-AH-BEN-M (AHNDX)
  2888                                 TO CP-R-MAX-MON-BEN
  2889             ADD +1               TO AHNDX
  2890             GO TO 2100-SEARCH-AH-LIMITS
  2891     ELSE
  2892         MOVE RT-AH-AGE  (AHNDX) TO CP-R-MAX-AGE
  2893         MOVE RT-AH-TERM (AHNDX) TO CP-R-MAX-TERM
  2894         MOVE RT-AH-BEN-M (AHNDX)
  2895                                 TO CP-R-MAX-MON-BEN.
  2896
  2897     IF CP-ORIGINAL-TERM GREATER RT-AH-TERM (AHNDX)
  2898         MOVE '9'                 TO CP-RETURN-CODE.
  2899
  2900     IF CP-ORIGINAL-BENEFIT GREATER RT-AH-BEN-M (AHNDX)
  2901         MOVE '8'                 TO CP-RETURN-CODE.
  2902
  2903     MULTIPLY CP-ORIGINAL-BENEFIT BY CP-ORIGINAL-TERM
  2904         GIVING WS-AH-FACE-BENEFIT.
  2905
  2906     IF WS-AH-FACE-BENEFIT GREATER RT-AH-BEN-F (AHNDX)
  2907         MOVE 'C'                 TO CP-RETURN-CODE.
  2908
  2909 2200-CALCULATE-PREMIUMS.
  2910
  2911     IF CP-COMPANY-ID = 'CSL'
  2912         GO TO 2250-CSL-CALC.
  2913
  2914*    IF CP-CRITICAL-PERIOD
  2915*       GO TO 2200-CRITICAL-PERIOD-AH-CONT.
  2916
  2917     IF CP-CRITICAL-PERIOD
  2918        IF (CP-COMPANY-ID = 'DCC')
  2919           AND ((CP-BENEFIT-CD (1:1) = 'N' OR 'M' OR 'H'
  2920               OR 'S' OR 'P')
  2921                          OR
  2922                (CP-BEN-CATEGORY = 'G' OR 'L'))
  2923           CONTINUE
  2924        ELSE
  2925           GO TO 2200-CRITICAL-PERIOD-AH-CONT
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  55
* SUNATEX.cbl (/apps/prod/cid1p/copy/ELCRATPD)
  2926        END-IF
  2927     END-IF
  2928
  2929     IF (CP-COMPANY-ID = 'DCC')
  2930        AND (CP-BEN-CATEGORY = 'D')
  2931        COMPUTE CP-PREMIUM-RATE ROUNDED = CP-PREMIUM-RATE *
  2932           (1 + CP-DCC-PMF-COMM) / (1 - CP-DCC-ACT-COMM)
  2933     END-IF
  2934
  2935     IF CP-SPECIAL-CALC-CD EQUAL 'H'
  2936        COMPUTE WS-TERM-MINUS-ONE EQUAL CP-ORIGINAL-TERM - +1
  2937        MOVE RT-AH-RATE (WS-TERM-MINUS-ONE) TO
  2938                                     CP-PREMIUM-RATE
  2939        COMPUTE CP-CALC-PREMIUM ROUNDED EQUAL
  2940        (CP-ORIGINAL-BENEFIT * (CP-LOAN-TERM - +1) *
  2941        CP-PREMIUM-RATE) / +100
  2942     ELSE
  2943        IF (CP-COMPANY-ID = 'DCC')
  2944           AND (CP-BEN-CATEGORY NOT = 'G' AND 'L')
  2945           MOVE CP-PREMIUM-RATE  TO WK-S
  2946*          MOVE CP-PREMIUM-RATE  TO CP-CALC-PREMIUM
  2947           IF CP-RATE-DEV-PCT NOT = ZEROS
  2948              COMPUTE WK-S ROUNDED =
  2949                 (CP-PREMIUM-RATE * CP-RATE-DEV-PCT)
  2950           END-IF
  2951           IF CP-BENEFIT-CD (1:1) = 'M'
  2952              COMPUTE CP-CALC-PREMIUM ROUNDED =
  2953              CP-ORIGINAL-BENEFIT * WK-S / 100
  2954           ELSE
  2955              IF CP-BENEFIT-CD (1:1) = 'H'
  2956                 COMPUTE CP-CALC-PREMIUM ROUNDED =
  2957                    (CP-ORIGINAL-BENEFIT * CP-LOAN-TERM *
  2958                    WK-S) / 1000
  2959              ELSE
  2960                 IF CP-BENEFIT-CD (1:1) = 'N' OR 'S'
  2961                    GO TO 2300-CALC-DCC-MOB-NET-AH
  2962                 ELSE
  2963                    IF CP-BEN-CATEGORY = 'D'
  2964                       COMPUTE CP-CALC-PREMIUM ROUNDED =
  2965                        CP-ORIGINAL-BENEFIT *
  2966                        CP-ORIGINAL-TERM * WK-S / 100
  2967                    ELSE
  2968                      IF CP-BENEFIT-CD (1:1) = 'P'
  2969                         GO TO 2300-CALC-DCC-BEN-P-AH
  2970                      ELSE
  2971                       COMPUTE CP-CALC-PREMIUM ROUNDED =
  2972                        (CP-ORIGINAL-BENEFIT * CP-LOAN-TERM *
  2973                        WK-S) / 100
  2974                      END-IF
  2975                    END-IF
  2976                 END-IF
  2977              END-IF
  2978           END-IF
  2979           MOVE ZEROS            TO CP-RATE-DEV-PCT
  2980        ELSE
  2981           IF CP-BENEFIT-CD (1:1) = 'M'
  2982              COMPUTE CP-CALC-PREMIUM ROUNDED =
  2983                 CP-ORIGINAL-BENEFIT * CP-PREMIUM-RATE / 100
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  56
* SUNATEX.cbl (/apps/prod/cid1p/copy/ELCRATPD)
  2984           ELSE
  2985              IF CP-BENEFIT-CD (1:1) = 'N' OR 'H'
  2986                 COMPUTE CP-CALC-PREMIUM ROUNDED =
  2987                    (CP-NET-BENEFIT-AMT *
  2988                    CP-PREMIUM-RATE) / 1000
  2989              ELSE
  2990                 IF CP-AH-BALLOON-SW = 'Y'
  2991                    COMPUTE CP-CALC-PREMIUM ROUNDED =
  2992                      (CP-ORIGINAL-BENEFIT * (CP-LOAN-TERM) *
  2993                      CP-PREMIUM-RATE) / 100
  2994                 ELSE
  2995                   COMPUTE CP-CALC-PREMIUM ROUNDED =
  2996                    (CP-ORIGINAL-BENEFIT * CP-ORIGINAL-TERM *
  2997                    CP-PREMIUM-RATE) / 100
  2998                 END-IF
  2999              END-IF
  3000           END-IF
  3001        END-IF
  3002     END-IF
  3003
  3004     IF (CP-COMPANY-ID = 'DCC')
  3005        AND (CP-BEN-CATEGORY = 'G' OR 'L')
  3006        COMPUTE CP-CALC-PREMIUM = CP-PREMIUM-RATE * +1000
  3007     END-IF
  3008
  3009     IF CP-TERM-OR-EXT-DAYS = ZEROS
  3010         GO TO 9999-CALC-RATE-PREM-X.
  3011
  3012     IF CP-EXT-CHG-AH OR CP-EXT-CHG-LF-AH
  3013         COMPUTE CP-CALC-PREMIUM ROUNDED =
  3014             CP-CALC-PREMIUM +
  3015                 (((CP-CALC-PREMIUM / CP-ORIGINAL-TERM) / 30)
  3016                                       * CP-TERM-OR-EXT-DAYS).
  3017
  3018     GO TO 9999-CALC-RATE-PREM-X.
  3019
  3020 2200-CRITICAL-PERIOD-AH-CONT.
  3021
  3022     IF CP-COMPANY-ID = 'WDS'
  3023         IF CP-ORIGINAL-TERM GREATER THAN 60
  3024             MOVE 60              TO CP-LOAN-TERM.
  3025
  3026     IF CP-COMPANY-ID EQUAL 'CVL'
  3027         COMPUTE CP-CALC-PREMIUM ROUNDED =
  3028           ((CP-ORIGINAL-BENEFIT * CP-CRITICAL-MONTHS) / +100)
  3029                                       * CP-PREMIUM-RATE
  3030         GO TO 9999-CALC-RATE-PREM-X.
  3031
  3032     COMPUTE CP-CALC-PREMIUM ROUNDED =
  3033           ((CP-ORIGINAL-BENEFIT * CP-ORIGINAL-TERM) / +100)
  3034                                       * CP-PREMIUM-RATE.
  3035
  3036     GO TO 9999-CALC-RATE-PREM-X.
  3037
  3038 2250-CSL-CALC.
  3039
  3040     IF RT-DAILY-RATE NOT NUMERIC OR
  3041        RT-DAILY-RATE = ZEROS
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  57
* SUNATEX.cbl (/apps/prod/cid1p/copy/ELCRATPD)
  3042            MOVE ZEROS TO CP-CALC-PREMIUM
  3043            MOVE '7' TO CP-RETURN-CODE
  3044            GO TO 9999-CALC-RATE-PREM-X.
  3045
  3046     COMPUTE WK-DAILY-RATE = RT-DAILY-RATE / 100.
  3047     COMPUTE WK-MONTHLY-RATE =
  3048          RT-AH-RATE (CP-ORIGINAL-TERM) / 100.
  3049
  3050     MOVE CP-CERT-EFF-DT TO DC-BIN-DATE-1.
  3051     MOVE CP-FIRST-PAY-DATE TO DC-BIN-DATE-2.
  3052     MOVE '1' TO DC-OPTION-CODE.
  3053     PERFORM 9100-CONVERT-DATE THRU 9100-EXIT.
  3054     IF DATE-CONVERSION-ERROR
  3055         MOVE '2' TO CP-RETURN-CODE
  3056         GO TO 9999-CALC-RATE-PREM-X.
  3057
  3058     MOVE CP-REMAINING-BENEFIT TO WK-PAY-AMT.
  3059     IF CP-CSL-METH-1
  3060         GO TO 2250-CSL-CALC-AH-1.
  3061     IF CP-CSL-METH-2
  3062         GO TO 2250-CSL-CALC-AH-2.
  3063     IF CP-CSL-METH-3
  3064         IF WK-PAY-AMT GREATER THAN WS-MAX-MON-BEN
  3065             GO TO 2250-CSL-CALC-AH-4
  3066         ELSE
  3067             GO TO 2250-CSL-CALC-AH-3.
  3068
  3069 2250-CSL-CALC-AH-1.
  3070
  3071     COMPUTE WK-D = DC-ELAPSED-DAYS * CP-PAY-FREQUENCY / 365.
  3072     COMPUTE WK-D = (((WK-D - 1) * (365 / 12)) * WK-DAILY-RATE)
  3073                    + WK-MONTHLY-RATE.
  3074     COMPUTE CP-CALC-PREMIUM ROUNDED = CP-MONTHLY-PAYMENT *
  3075                    CP-ORIGINAL-TERM * WK-D.
  3076
  3077     GO TO 9999-CALC-RATE-PREM-X.
  3078
  3079
  3080 2250-CSL-CALC-AH-2.
  3081     COMPUTE WK-D = DC-ELAPSED-DAYS * CP-PAY-FREQUENCY / 365.
  3082     COMPUTE WK-D = (((WK-D - 1) * (365 / 12)) * WK-DAILY-RATE)
  3083                    + WK-MONTHLY-RATE.
  3084     COMPUTE CP-CALC-PREMIUM ROUNDED = WS-MAX-MON-BEN *
  3085                    CP-ORIGINAL-TERM * WK-D.
  3086
  3087     GO TO 9999-CALC-RATE-PREM-X.
  3088
  3089 2250-CSL-CALC-AH-3.
  3090
  3091     COMPUTE WK-K = WS-MAX-TOT-BEN / WK-PAY-AMT.
  3092     COMPUTE WK-T = WK-K + 1.
  3093     COMPUTE WK-MONTHLY-RATE-T =
  3094          RT-AH-RATE (WK-T) / 100.
  3095     COMPUTE WK-C = (CP-ORIGINAL-TERM - (WK-T * 2) + 1).
  3096
  3097     COMPUTE WK-T1 = WK-K * (CP-ORIGINAL-TERM - WK-T).
  3098     IF WK-T1 EQUAL ZEROS
  3099         MOVE ZEROS TO CP-CALC-PREMIUM
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  58
* SUNATEX.cbl (/apps/prod/cid1p/copy/ELCRATPD)
  3100         MOVE 'G' TO CP-RETURN-CODE
  3101         GO TO 9999-CALC-RATE-PREM-X.
  3102
  3103     COMPUTE WK-C = ((WK-C * WK-MONTHLY-RATE-T) + ((WK-T - 1) *
  3104                    WK-MONTHLY-RATE)) / (WK-K * (CP-ORIGINAL-TERM
  3105                    - WK-T)).
  3106     COMPUTE WK-D = (DC-ELAPSED-DAYS * CP-PAY-FREQUENCY / 365)
  3107     COMPUTE WK-PREM = ((CP-ORIGINAL-TERM -
  3108                       (WK-K + 1) + (WK-D - 1))) * (WK-C *
  3109                       WS-MAX-TOT-BEN).
  3110     COMPUTE CP-CALC-PREMIUM ROUNDED = (WK-PAY-AMT * (WK-K + 1) *
  3111                    WK-MONTHLY-RATE-T) + WK-PREM.
  3112
  3113     GO TO 9999-CALC-RATE-PREM-X.
  3114
  3115 2250-CSL-CALC-AH-4.
  3116     COMPUTE WK-K = WS-MAX-TOT-BEN / WK-PAY-AMT.
  3117     COMPUTE WK-J = WS-MAX-TOT-BEN / WS-MAX-MON-BEN.
  3118     COMPUTE WK-MONTHLY-RATE-J =
  3119          RT-AH-RATE (WK-J) / 100.
  3120     COMPUTE WK-T = WK-J + 1.
  3121     COMPUTE WK-MONTHLY-RATE-T =
  3122          RT-AH-RATE (WK-T) / 100.
  3123     COMPUTE WK-C = (CP-ORIGINAL-TERM - (WK-T * 2) + 1).
  3124     COMPUTE WK-C = ((WK-C * WK-MONTHLY-RATE-T) + ((WK-T - 1) *
  3125                    WK-MONTHLY-RATE)) / ((WK-T - 1) *
  3126                    (CP-ORIGINAL-TERM - WK-T)).
  3127     COMPUTE WK-D = (DC-ELAPSED-DAYS * CP-PAY-FREQUENCY / 365)
  3128     COMPUTE WK-PREM = (CP-ORIGINAL-TERM -
  3129                       (WK-J + 1) + (WK-D - 1)) * (WK-C *
  3130                       WS-MAX-TOT-BEN).
  3131     COMPUTE CP-CALC-PREMIUM ROUNDED = WK-PREM + ((WK-J + 1) *
  3132                   (WS-MAX-MON-BEN * WK-MONTHLY-RATE-T)).
  3133
  3134     GO TO 9999-CALC-RATE-PREM-X.
  3135
  3136
  3137 2300-CALC-DCC-BEN-P-AH.
  3138
  3139     IF CP-NO-OF-PMTS NOT NUMERIC
  3140        MOVE +0                  TO CP-NO-OF-PMTS
  3141     END-IF
  3142     IF CP-PMT-MODE NOT = 'W' AND 'S' AND 'B' AND 'T'
  3143        AND ' ' AND 'M'
  3144        MOVE ' '                 TO CP-PMT-MODE
  3145     END-IF
  3146
  3147******************************************************************
  3148***   Default is monthly, use loan term for rate and amort     ***
  3149******************************************************************
  3150     move cp-loan-term         to c-tot-pmts
  3151     MOVE +30                  TO C-DAYS-IN-PMT-PER
  3152     MOVE +12                  TO C-PMTS-PER-YEAR
  3153******************************************************************
  3154
  3155     evaluate true
  3156        when cp-pmt-mode = 'W'
  3157           MOVE +52              TO C-PMTS-PER-YEAR
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  59
* SUNATEX.cbl (/apps/prod/cid1p/copy/ELCRATPD)
  3158           compute c-tot-pmts = cp-loan-term /
  3159              12 * c-pmts-per-year
  3160           MOVE +7               TO C-DAYS-IN-PMT-PER
  3161        when cp-pmt-mode = 'B'
  3162           MOVE +26              TO C-PMTS-PER-YEAR
  3163           compute c-tot-pmts = cp-loan-term /
  3164              12 * c-pmts-per-year
  3165           MOVE +14              TO C-DAYS-IN-PMT-PER
  3166     end-evaluate
  3167
  3168     COMPUTE I = CP-LOAN-APR / C-PMTS-PER-YEAR / 100
  3169
  3170     if i = zeros
  3171        move .0000000001         to i
  3172     end-if
  3173
  3174     COMPUTE Y = (1 + (CP-DAYS-TO-1ST-PMT * I /
  3175        C-DAYS-IN-PMT-PER)) / (1 + I)
  3176
  3177     COMPUTE ANGLEN = (1 - ((1 + I) ** (C-TOT-PMTS * -1))) / I
  3178     COMPUTE ANGLEN-1 = ANGLEN / Y
  3179     COMPUTE WK3 = (CP-NET-BENEFIT-AMT - CP-ORIGINAL-PREMIUM)
  3180        / ANGLEN-1
  3181
  3182     if cp-net-benefit-amt = zeros
  3183        compute wk3 = cp-original-benefit - cp-original-premium
  3184     end-if
  3185     COMPUTE CP-CALC-PREMIUM = (WK3 / 100) * WK-S
  3186
  3187     GO TO 9999-CALC-RATE-PREM-X
  3188
  3189     .
  3190 2300-CALC-DCC-MOB-NET-AH.
  3191
  3192     IF CP-ALTERNATE-BENEFIT = ZEROS
  3193        CONTINUE
  3194     ELSE
  3195        GO TO 2300-CALC-DCC-MOB-BAL-AH
  3196     END-IF
  3197
  3198     MOVE CP-ORIGINAL-TERM       TO M
  3199     MOVE CP-LOAN-TERM           TO N
  3200     IF N = ZEROS
  3201        MOVE M                   TO N
  3202     END-IF
  3203     COMPUTE I = CP-LOAN-APR / +1200
  3204
  3205     if i = zeros
  3206        move .0000000001         to i
  3207     end-if
  3208     IF CP-BENEFIT-CD (1:1) = 'S'
  3209        COMPUTE OD = CP-DAYS-TO-1ST-PMT - 30
  3210        COMPUTE WK3 = CP-ORIGINAL-BENEFIT *
  3211        ((M * (M + 1) / 2) + (M * OD / 30)) *
  3212          (WK-S / 1000)
  3213          * 1
  3214        MOVE WK3                 TO CP-CALC-PREMIUM
  3215        GO TO 9999-CALC-RATE-PREM-X
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  60
* SUNATEX.cbl (/apps/prod/cid1p/copy/ELCRATPD)
  3216     END-IF
  3217
  3218     COMPUTE OD = (1 + ((CP-TERM-OR-EXT-DAYS + +30) * I / 30))
  3219        / (1 + I)
  3220     COMPUTE ANGLEN-M = ((1 - ((1 + I)
  3221          ** ((N - M) * -1))) / I)
  3222     COMPUTE ANGLEN-M = ANGLEN-M / OD
  3223     COMPUTE J = I + (WK-S / +1000)
  3224     COMPUTE WK2 = (1 + J) ** (M * -1)
  3225     COMPUTE ANGLEN-M = ANGLEN-M * WK2
  3226
  3227
  3228     COMPUTE ANGLEM = ((1 - ((1 + J)
  3229          ** (M * -1))) / J) / OD
  3230     IF CP-NET-BENEFIT-AMT = ZEROS
  3231        COMPUTE CP-NET-BENEFIT-AMT = CP-ORIGINAL-BENEFIT
  3232           * ANGLEM
  3233     END-IF
  3234     COMPUTE RA = CP-NET-BENEFIT-AMT / (ANGLEM + ANGLEN-M)
  3235
  3236     COMPUTE ANGLEN-M = ((1 - ((1 + I)
  3237          ** ((N - M) * -1))) / I)
  3238
  3239     MOVE +0                     TO WK3
  3240     PERFORM VARYING WS-COUNTER FROM +1 BY +1 UNTIL
  3241        (WS-COUNTER > M)
  3242        COMPUTE ANGLEM = (1 - ((1 + J)
  3243          ** ((M - WS-COUNTER + 1) * -1))) / J
  3244        COMPUTE WK2 = (1 / (1 + j)) ** (M - WS-COUNTER + 1)
  3245        COMPUTE WK5-CSL = RA * (ANGLEM + (ANGLEN-M * WK2))
  3246        COMPUTE WK3 = WK3 + (WK5-CSL * WK-S / +1000)
  3247     END-PERFORM
  3248
  3249     MOVE WK3                    TO CP-CALC-PREMIUM
  3250
  3251     GO TO 9999-CALC-RATE-PREM-X
  3252     .
  3253
  3254 2300-CALC-DCC-MOB-BAL-AH.
  3255
  3256     IF CP-BENEFIT-CD (1:1) = 'S'
  3257        GO TO 2300-CALC-DCC-MOB-BAL-AHSUM
  3258     END-IF
  3259     MOVE CP-ORIGINAL-TERM       TO M
  3260     MOVE CP-LOAN-TERM           TO N
  3261     IF N = ZEROS
  3262        MOVE M                   TO N
  3263     END-IF
  3264     COMPUTE I = CP-LOAN-APR / +1200
  3265     if i = zeros
  3266        move .0000000001         to i
  3267     end-if
  3268     COMPUTE OD = (1 + ((CP-TERM-OR-EXT-DAYS + +30) * I / 30))
  3269        / (1 + I)
  3270     COMPUTE ANGLEN-M = (WK5 / I) / OD
  3271     COMPUTE J = I + (WK-S / +1000)
  3272     COMPUTE K = I + (CP-DCC-LF-RATE / +1000)
  3273     MOVE I TO K
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  61
* SUNATEX.cbl (/apps/prod/cid1p/copy/ELCRATPD)
  3274     COMPUTE WK2 = (1 + J) ** (M * -1)
  3275     COMPUTE ANGLEN-M = ANGLEN-M * WK2
  3276
  3277     COMPUTE ANGLEM-1 = ((1 - ((1 + J)
  3278          ** ((M - 1) * -1))) / J)
  3279
  3280     COMPUTE ANGLEM = ((1 - ((1 + J)
  3281          ** (M * -1))) / J) / OD
  3282
  3283     IF CP-NET-BENEFIT-AMT = ZEROS
  3284        COMPUTE CP-NET-BENEFIT-AMT = CP-ORIGINAL-BENEFIT
  3285           * ANGLEM
  3286     END-IF
  3287     COMPUTE RA = (CP-NET-BENEFIT-AMT * OD -
  3288        (CP-ALTERNATE-BENEFIT * (1 + K) ** (M * -1)))
  3289        / ANGLEM-1
  3290
  3291     COMPUTE ANGLEN-M = ((1 - ((1 + I)
  3292          ** ((N - M) * -1))) / I)
  3293
  3294     MOVE +0                     TO WK3
  3295     PERFORM VARYING WS-COUNTER FROM +1 BY +1 UNTIL
  3296        (WS-COUNTER > M)
  3297        COMPUTE ANGLEM = (1 - ((1 + J)
  3298          ** ((M - WS-COUNTER) * -1))) / J
  3299        COMPUTE WK2 = (1 / (1 + K)) ** (M - WS-COUNTER + 1)
  3300        COMPUTE WK5-CSL = (RA * ANGLEM)
  3301        + (CP-ALTERNATE-BENEFIT * WK2)
  3302        COMPUTE WK3 = WK3 + (WK5-CSL - (CP-ALTERNATE-BENEFIT *
  3303          (1 / (1 + K) ** (M - WS-COUNTER + 1)))) *
  3304          (WK-S / 1000)
  3305     END-PERFORM
  3306
  3307     MOVE WK3                    TO CP-CALC-PREMIUM
  3308     GO TO 9999-CALC-RATE-PREM-X
  3309     .
  3310 2300-CALC-DCC-MOB-BAL-AHSUM.
  3311
  3312     MOVE CP-ORIGINAL-TERM       TO M
  3313
  3314     COMPUTE WK3 = CP-ORIGINAL-BENEFIT * ((M - 1) * M / 2
  3315        + (M - 1) * (CP-DAYS-TO-1ST-PMT - 30) / 30)
  3316        * WK-S / 1000
  3317
  3318*    COMPUTE WK3 = CP-ORIGINAL-BENEFIT * ((M - 1) * M / 2
  3319*       + (M - 1) * ((CP-TERM-OR-EXT-DAYS + 30) - 30) / 30)
  3320*       * WK-S / 1000
  3321
  3322
  3323
  3324     MOVE WK3                    TO CP-CALC-PREMIUM
  3325
  3326
  3327     GO TO 9999-CALC-RATE-PREM-X
  3328     .
  3329 9999-RATE-NOTFND.
  3330     MOVE '6'                    TO CP-RETURN-CODE.
  3331     GO TO 9999-CALC-RATE-PREM-X.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  62
* SUNATEX.cbl (/apps/prod/cid1p/copy/ELCRATPD)
  3332
  3333 9999-RATE-NOTOPEN.
  3334     MOVE 'D'                    TO CP-RETURN-CODE.
  3335     GO TO 9999-CALC-RATE-PREM-X.
  3336
  3337 9999-CALC-RATE-PREM-X.
  3338     IF (CP-COMPANY-ID = 'DCC')
  3339        AND (CP-BENEFIT-CD (1:1) = 'N' OR 'S' OR 'P')
  3340        CONTINUE
  3341     ELSE
  3342        IF CP-RATE-DEV-PCT NOT = ZERO
  3343           COMPUTE CP-CALC-PREMIUM =
  3344              CP-CALC-PREMIUM * CP-RATE-DEV-PCT.
  3345
  3346
  3347     GOBACK.
  3348
  3349 9100-CONVERT-DATE.
  3350     CALL 'SUNATCX' USING DATE-CONVERSION-DATA.
  3351
  3352 9100-EXIT.
  3353     EXIT.
  3354
  3355 9999-OPEN-RATE-FILE.
  3356     MOVE SPACE TO CP-RETURN-CODE
  3357                   CP-IO-FUNCTION.
  3358
  3359     IF  ERRATE-FILE-ID = OERATE-FILE-ID
  3360         OPEN INPUT OERATEF
  3361        ELSE
  3362         OPEN INPUT ERRATEF.
  3363
  3364     IF  ER-STATUS NOT = '00' AND '97'
  3365         MOVE 'E'                 TO CP-IO-FUNCTION.
  3366
  3367     GOBACK.
  3368
  3369 9999-CLOSE-RATE-FILE.
  3370     MOVE SPACE TO CP-RETURN-CODE
  3371                   CP-IO-FUNCTION.
  3372
  3373     IF  ERRATE-FILE-ID = OERATE-FILE-ID
  3374         CLOSE OERATEF
  3375        ELSE
  3376         CLOSE ERRATEF.
  3377
  3378     IF  ER-STATUS NOT = '00'
  3379         MOVE 'E'                 TO CP-IO-FUNCTION.
  3380
  3381     GOBACK.
  3382
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  63
* SUNATEX.cbl
  3384 10000-NET-TERM SECTION.
* 3385                          COPY ERCNETP.
  3386***************************************************************** 04/29/98
  3387*                                                               * ERCNETP
  3388*                            ERCNETP                            *    LV006
  3389*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**6
  3390*                            VMOD=2.029                         *    CL**3
  3391*                                                               * ERCNETP
  3392*****************************************************************.ERCNETP
  3393*                                                                 ERCNETP
  3394*    FIVE PARAMETERS ARE PASSED TO THIS MODULE AND A FACTOR IS    ERCNETP
  3395*    RETURNED. PARAMETERS PASSED  - A.P.R. (S999V9999)            ERCNETP
  3396*                                   ORIGINAL TERM (S999)          ERCNETP
  3397*                                   REMAINING TERM (S999)         ERCNETP
  3398*                                   NET PAY OPTION (X)            ERCNETP
  3399*                                   LOAN TERM (S999)              ERCNETP
  3400*              FACTOR RETURNED IS - FACTOR (S9(4)V9(9))           ERCNETP
  3401*                                                                 ERCNETP
  3402*    FACTOR RETURNED IS MULTIPLIED BY ORIG. FACE TO GET REMAINING ERCNETP
  3403*    FACE. IF ORIGNAL TERM = REMAINING TERM, FACTOR WOULD BE 1,   ERCNETP
  3404*    THEREFORE MODULE ASSUMES RATING IS DESIRED AND FACTOR THAT   ERCNETP
  3405*    IS RETURNED MAY BE MULTIPLIED BY THOUSANDS OF ORIGINAL FACE  ERCNETP
  3406*    AND REGULAR PREMIUM PER $100 PER MONTH TO GET PREMIUM TO BE  ERCNETP
  3407*    CHARGED.                                                     ERCNETP
  3408*                                                                 ERCNETP
  3409*    OPTIONS - S = NET SIMPLE                                     ERCNETP
  3410*          SPACE = NET PAY  (1 MO. INTEREST)                      ERCNETP
  3411*              A = NET PAY  (0 MO. INTEREST)                      ERCNETP
  3412*              I = NET PAY  (2 MO. INTEREST)                      ERCNETP
  3413*              J = NET PAY  (3 MO. INTEREST)                      ERCNETP
  3414*              K = NET PAY  (4 MO. INTEREST)                      ERCNETP
  3415*              T = TRUNCATED  (0 MO. INTEREST)                    ERCNETP
  3416*              U = TRUNCATED  (1 MO. INTEREST)                    ERCNETP
  3417*              V = TRUNCATED  (2 MO. INTEREST)                    ERCNETP
  3418*              W = TRUNCATED  (3 MO. INTEREST)                    ERCNETP
  3419*              X = TRUNCATED  (4 MO. INTEREST)                    ERCNETP
  3420*              R = REFUNDS (REGULAR OR TRUNCATED)                 ERCNETP
  3421******************************************************************
  3422*                   C H A N G E   L O G
  3423*
  3424* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3425*-----------------------------------------------------------------
  3426*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3427* EFFECTIVE    NUMBER
  3428*-----------------------------------------------------------------
  3429* 120202    2001061800003  PEMA  ADD DCC PROCESSING
  3430* 120502                   PEMA  ADD SPECIAL IN CALC FOR CID
  3431* 120403                   PEMA  ADD SPECIAL TX CALC
  3432* 011904                   PEMA  ADD TOTAL FEE PROCESSING
  3433* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  3434* 081205                   PEMA  ADD DAYS TO 1ST PMT ON 'S'
  3435* 083105                   PEMA  ADD DAYS TO 1ST PMT ON 'N'
  3436* 011707                   PEMA  ADD SC NP PLUS 6 PMTS
  3437* 021207                   PEMA  ADD PA NP
  3438* 022107                   PEMA  ADD NH NP AND NP TRUNC
  3439* 032807                   PEMA  ADD VT NP PLUS 2
  3440* 091307  IR2007090600001  PEMA  REMOVE LOW APR CHECK
  3441* 110207    2007010300001  PEMA  FIX PROBLEM WHERE DIFF OF LOAN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  64
* SUNATEX.cbl (/apps/prod/cid1p/copy/ERCNETP)
  3442* 110207      LOAN TERM AND INS TERM IS 1. ALSO ADD TRUNC
  3443* 110207      TO 'AL' NET PAY CALC
  3444* 052808    2008032000002  PEMA  ADD CODE FOR AK NET PAY
  3445* 052808    2008050800003  PEMA  ADD CODE FOR NV NET +2
  3446* 060308  IR2008052800002  PEMA  ADD TNP FOR ME
  3447* 060308  CR2008032700002  PEMA  ADD EXT DAYS FOR ME
  3448* 0600909 CR2008042300002  PEMA  ADD NEW FARM PLAN CALC
  3449* 010410  CR2009092300002  PEMA  ADD MN NET CALC
  3450* 010410  CR2008021200005  PEMA  ADD MN NET BALLOON
  3451* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  3452* 071910  IR2010062900001  PEMA ADD MN NET BALLOON REFUND CALC
  3453* 071211  CR2010012700001  PEMA  ADD SPP DEALER DIRECT
  3454* 092311  IR2011092100001  PEMA  ID 10C MONTHLY
  3455* 032612  CR2011110200001  PEMA  AHL CHANGES
  3456* 111212  CR2012013100001  PEMA  CHANGES FOR MN AND WA
  3457* 022613  CR2011021500001  PEMA  ADD CODE 4 TRUNC BALLOON DCC 10C
  3458* 050713  CR2008042200001  PEMA  ADD CODE FOR ZERO APR
  3459* 030515  IR2015022300001  PEMA  ADD MN AND WA FARMPLAN CODING
  3460* 040615  CR2013072200002  PEMA  ADD EXTRA PERIODS FOR NET BALLOONS
  3461******************************************************************
  3462                                                                  ERCNETP
  3463     MOVE N-P-APR     TO ANNUAL-INT-RATE.                         ERCNETP
  3464     MOVE N-P-ORIG    TO ORIGINAL-TERM.                           ERCNETP
  3465     MOVE N-P-LOAN    TO LOAN-TERM.                               ERCNETP
  3466     MOVE N-P-REM     TO REMAINING-TERM.                          ERCNETP
  3467     MOVE N-P-OPT     TO OPTION-SW.                               ERCNETP
  3468                                                                  ERCNETP
  3469     MOVE +0 TO FACTOR.                                           ERCNETP
  3470
  3471     if cp-company-id = 'CID'
  3472        if annual-int-rate = +99.9999
  3473           go to 99000-error
  3474        end-if
  3475     else
  3476        if annual-int-rate = zero
  3477           go to 99000-error
  3478        end-if
  3479     end-if
  3480
  3481     IF ORIGINAL-TERM = ZERO                                      ERCNETP
  3482         GO TO 99999-RETURN.                                      ERCNETP
  3483     IF REMAINING-TERM = ZERO                                     ERCNETP
  3484         GO TO 99999-RETURN.                                      ERCNETP
  3485     IF REMAINING-TERM GREATER ORIGINAL-TERM                      ERCNETP
  3486         GO TO 99000-ERROR.                                       ERCNETP
  3487     IF LOAN-TERM = ZERO                                          ERCNETP
  3488         GO TO 99999-RETURN.                                      ERCNETP
  3489     IF LOAN-TERM LESS ORIGINAL-TERM                              ERCNETP
  3490         GO TO 99000-ERROR.                                       ERCNETP
  3491                                                                  ERCNETP
  3492*    IF ANNUAL-INT-RATE LESS +2                                   ERCNETP
  3493*        COMPUTE ANNUAL-INT-RATE = ANNUAL-INT-RATE * +10.         ERCNETP
  3494*    IF ANNUAL-INT-RATE LESS +2                                   ERCNETP
  3495*        COMPUTE ANNUAL-INT-RATE = ANNUAL-INT-RATE * +10.         ERCNETP
  3496*    IF ANNUAL-INT-RATE LESS +2                                   ERCNETP
  3497*        COMPUTE ANNUAL-INT-RATE = ANNUAL-INT-RATE * +10.         ERCNETP
  3498                                                                  ERCNETP
  3499     IF NPO-REFUND                                                ERCNETP
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  65
* SUNATEX.cbl (/apps/prod/cid1p/copy/ERCNETP)
  3500         MOVE '2' TO NP-PROCESS-SW                                ERCNETP
  3501       ELSE                                                       ERCNETP
  3502         IF ORIGINAL-TERM = REMAINING-TERM                        ERCNETP
  3503            MOVE '1'   TO NP-PROCESS-SW                           ERCNETP
  3504           ELSE                                                   ERCNETP
  3505            MOVE '3'   TO NP-PROCESS-SW.                          ERCNETP
  3506                                                                  ERCNETP
  3507     IF NPO-SIMPLE                                                ERCNETP
  3508         MOVE 'S' TO TYPE-SW                                      ERCNETP
  3509     ELSE                                                         ERCNETP
  3510         MOVE 'N' TO TYPE-SW.                                     ERCNETP
  3511                                                                  ERCNETP
  3512     COMPUTE I ROUNDED = (ANNUAL-INT-RATE / K100) / K12.          ERCNETP
  3513     if i = zeros
  3514        move .0000000001         to i
  3515     end-if
  3516                                                                  ERCNETP
  3517     COMPUTE V ROUNDED = K1 / (K1 + I).                           ERCNETP
  3518                                                                  ERCNETP
  3519     MOVE V     TO VX                                             ERCNETP
  3520                   SV.                                            ERCNETP
  3521                                                                  ERCNETP
  3522     MOVE +1    TO X1                                             ERCNETP
  3523                   SX.                                            ERCNETP
  3524                                                                  ERCNETP
  3525     MOVE LOAN-TERM TO MAX-X.                                     ERCNETP
  3526                                                                  ERCNETP
  3527     COMPUTE X2 = MAX-X - ORIGINAL-TERM.                          ERCNETP
  3528                                                                  ERCNETP
  3529     IF MAX-X = +1                                                ERCNETP
  3530        GO TO 10700-COMPUTE-REMAINING-FACTOR.                     ERCNETP
  3531                                                                  ERCNETP
  3532     COMPUTE EXPIRED-TERM = ORIGINAL-TERM - REMAINING-TERM.       ERCNETP
  3533                                                                  ERCNETP
  3534     IF (CP-COMPANY-ID EQUAL 'CDC' OR 'GTL' OR 'CID' OR 'MON'     ERCNETP
  3535         OR 'DCC'        OR 'NCL') AND                            ERCNETP
  3536        (NOT NP-REFUND)                                           ERCNETP
  3537        NEXT SENTENCE                                             ERCNETP
  3538     ELSE                                                         ERCNETP
  3539     IF LOAN-TERM NOT = ORIGINAL-TERM                             ERCNETP
  3540        COMPUTE REMAINING-TERM = LOAN-TERM - EXPIRED-TERM.        ERCNETP
  3541                                                                  ERCNETP
  3542     COMPUTE SV-MINUS-ONE EQUAL ORIGINAL-TERM - +1.               ERCNETP
  3543                                                                  ERCNETP
  3544 10500-VX-LOOP.                                                   ERCNETP
  3545                                                                  ERCNETP
  3546***  VX = AMORT. LOAN TERM.                                       ERCNETP
  3547***  SV = AMORT. INSURANCE TERM.                                  ERCNETP
  3548***  SV = AMORT. REMAINING TERM FOR REFUND CALCS.                 ERCNETP
  3549***  SX = AMORT. LOAN TERM - INSURANCE TERM. (USED FOR TRUNCATED. ERCNETP
  3550***  SV-MINUS-ONE = INSURANCE TERM - +1... (TMS ONLY)             ERCNETP
  3551                                                                  ERCNETP
  3552     IF X2 = 1
  3553        MOVE V         TO SX
  3554     END-IF
  3555     COMPUTE VX ROUNDED = VX * V.                                 ERCNETP
  3556                                                                  ERCNETP
  3557     ADD B1 TO X1.                                                ERCNETP
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  66
* SUNATEX.cbl (/apps/prod/cid1p/copy/ERCNETP)
  3558                                                                  ERCNETP
  3559     IF X1 = REMAINING-TERM                                       ERCNETP
  3560          MOVE VX    TO SV.                                       ERCNETP
  3561                                                                  ERCNETP
  3562     IF X1 EQUAL SV-MINUS-ONE                                     ERCNETP
  3563        MOVE VX      TO SV-MINUS-ONE.                             ERCNETP
  3564                                                                  ERCNETP
  3565     IF X1 = X2                                                   ERCNETP
  3566          MOVE VX    TO SX.                                       ERCNETP
  3567                                                                  ERCNETP
  3568     IF X1 NOT = MAX-X                                            ERCNETP
  3569          GO TO 10500-VX-LOOP.                                    ERCNETP
  3570                                                                  ERCNETP
  3571 10700-COMPUTE-REMAINING-FACTOR.                                  ERCNETP
  3572*****  WK1 = LOAN TERM AMORT
  3573     COMPUTE WK1 = K1 - VX.                                       ERCNETP
  3574*****  WK2 = INS TERM AMORT
  3575     COMPUTE WK2 = K1 - SV.                                       ERCNETP
  3576*****  WK5 = LOAN TERM - INS TERM AMORT (TRUNCATED)
  3577     COMPUTE WK5 = K1 - SX.                                       ERCNETP
  3578*****  WK6 = INS TERM - 1
  3579     COMPUTE WK6 = K1 - SV-MINUS-ONE.                             ERCNETP
  3580                                                                  ERCNETP
  3581     IF NP-RATING                                                 ERCNETP
  3582         GO TO 12000-PREMIUM-RATE.                                ERCNETP
  3583                                                                  ERCNETP
  3584     IF NP-REFUND                                                 ERCNETP
  3585         GO TO 11000-REFUND-CALC.                                 ERCNETP
  3586                                                                  ERCNETP
  3587     IF NET-STD                                                   ERCNETP
  3588         COMPUTE WK3 ROUNDED = (WK2 * K1000) / WK1.               ERCNETP
  3589                                                                  ERCNETP
  3590     IF NET-SMP                                                   ERCNETP
  3591         COMPUTE WK3 ROUNDED = ((R + 1) / (N + 1)) * (R / N)      ERCNETP
  3592         COMPUTE WK3 ROUNDED = (1 - WK3) * ((I * N / WK1) - 1)    ERCNETP
  3593         COMPUTE WK3 ROUNDED = WK3 + 1 - ((N - R) * I / WK1)      ERCNETP
  3594         COMPUTE WK3 ROUNDED = WK3 * 1000.                        ERCNETP
  3595                                                                  ERCNETP
  3596     IF REMAINING-TERM LESS THAN X2                               ERCNETP
  3597         MOVE +0 TO WK3.                                          ERCNETP
  3598                                                                  ERCNETP
  3599     MOVE WK3 TO FACTOR.                                          ERCNETP
  3600                                                                  ERCNETP
  3601     GO TO 99999-RETURN.                                          ERCNETP
  3602                                                                  ERCNETP
  3603 11000-REFUND-CALC.                                               ERCNETP
  3604     IF REMAINING-TERM NOT LESS MAX-X                             ERCNETP
  3605        MOVE +1 TO FACTOR                                         ERCNETP
  3606        GO TO 99999-RETURN.                                       ERCNETP
  3607                                                                  ERCNETP
  3608     IF REMAINING-TERM LESS +1                                    ERCNETP
  3609        MOVE 0 TO FACTOR                                          ERCNETP
  3610        GO TO 99999-RETURN.                                       ERCNETP
  3611                                                                  ERCNETP
  3612     COMPUTE WK2 ROUNDED = WK2 / I.                               ERCNETP
  3613     COMPUTE WK5 ROUNDED = WK5 / I.                               ERCNETP
  3614     COMPUTE WK1 ROUNDED = WK1 / I.                               ERCNETP
  3615                                                                  ERCNETP
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  67
* SUNATEX.cbl (/apps/prod/cid1p/copy/ERCNETP)
  3616     IF (CP-COMPANY-ID EQUAL 'CID')
  3617        AND (CP-STATE-STD-ABBRV = 'MN')
  3618        AND (CP-CERT-EFF-DT > X'A4FF')
  3619        AND (CP-RATE-AS-REG-BALLOON)
  3620        AND (CP-EARN-AS-NET-PAY)
  3621        AND (CP-DEVIATION-CODE NOT = 'LEV')
  3622        CONTINUE
  3623     ELSE
  3624        GO TO 11000-CHECK-MN-LEV-BALLOON
  3625     END-IF
  3626
  3627     COMPUTE R = M - E
  3628     COMPUTE FACTOR = (R - WK2 + WK5) /
  3629        (M - WK1 + WK5)
  3630
  3631     GO TO 99999-RETURN
  3632
  3633      .
  3634 11000-CHECK-MN-LEV-BALLOON.
  3635
  3636     IF (CP-COMPANY-ID EQUAL 'CID')
  3637        AND (CP-STATE-STD-ABBRV = 'MN')
  3638        AND (CP-CERT-EFF-DT > X'A4FF')
  3639        AND (CP-RATE-AS-REG-BALLOON)
  3640        AND (CP-EARN-AS-NET-PAY)
  3641        AND (CP-DEVIATION-CODE = 'LEV')
  3642        CONTINUE
  3643     ELSE
  3644        GO TO 11000-CONTINUE-REFUND
  3645     END-IF
  3646
  3647     COMPUTE ANGLEM = (1 - (1 / (1 + I)) ** M) / I
  3648     COMPUTE ANGLEM-T = (1 - (1 / (1 + I))
  3649        ** (M - E)) / I
  3650
  3651     COMPUTE FACTOR = ANGLEM-T / ANGLEM
  3652
  3653     GO TO 99999-RETURN
  3654
  3655     .
  3656 11000-CONTINUE-REFUND.
  3657
  3658*    IF CP-GAP-ACTUARIAL
  3659*       COMPUTE ANGLEN = WK1 / ((1 + I) **
  3660*          (CP-TERM-OR-EXT-DAYS * 12 / 365))
  3661*       COMPUTE WK3 = WK2 / ANGLEN
  3662*       MOVE 'S'                 TO CP-REFUND-TYPE-USED
  3663
  3664     IF CP-GAP-ACTUARIAL
  3665        COMPUTE ANGLEN = WK1 / ((1 + I) **
  3666           (CP-TERM-OR-EXT-DAYS * 12 / 365))
  3667        COMPUTE WK3 = (R - WK2) / (M - ANGLEN)
  3668     ELSE
  3669        COMPUTE WK3 ROUNDED =
  3670          (N-P-REM - WK2 + WK5) / (ORIGINAL-TERM - WK1 + WK5)
  3671     END-IF
  3672                                                                  ERCNETP
  3673     MOVE WK3  TO FACTOR.                                         ERCNETP
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  68
* SUNATEX.cbl (/apps/prod/cid1p/copy/ERCNETP)
  3674                                                                  ERCNETP
  3675     GO TO 99999-RETURN.                                          ERCNETP
  3676                                                                  ERCNETP
  3677 12000-PREMIUM-RATE.                                              ERCNETP
  3678*    K-I IS ADJUSTMENT FACTOR FOR NO. MONTHS ADD'L. INTEREST      ERCNETP
  3679*      OPTION - N OR U OR SPACE  = 1 MO,  SO K-I = 1 + I          ERCNETP
  3680*      OPTION - A OR T           = 0 MO,  SO K-I = 1              ERCNETP
  3681*      OPTION - I OR V           = 2 MO,  SO K-I = 1 + 2I         ERCNETP
  3682*      OPTION - J OR W           = 3 MO,  SO K-I = 1 + 3I         ERCNETP
  3683*      OPTION - K OR X           = 4 MO,  SO K-I = 1 + 4I         ERCNETP
  3684                                                                  ERCNETP
  3685     COMPUTE K-I = K1 + I.                                        ERCNETP
  3686     MOVE K-I TO ONE-PLUS-I.                                      ERCNETP
  3687                                                                  ERCNETP
  3688     IF NPO-ALT OR NPO-TRUNC-0                                    ERCNETP
  3689         MOVE K1 TO K-I.                                          ERCNETP
  3690                                                                  ERCNETP
  3691     IF NPO-2MO OR NPO-TRUNC-2                                    ERCNETP
  3692         COMPUTE K-I = K1 + (2 * I).                              ERCNETP
  3693                                                                  ERCNETP
  3694     IF NPO-3MO OR NPO-TRUNC-3                                    ERCNETP
  3695         COMPUTE K-I = K1 + (3 * I).                              ERCNETP
  3696                                                                  ERCNETP
  3697     IF NPO-4MO OR NPO-TRUNC-4                                    ERCNETP
  3698         COMPUTE K-I = K1 + (4 * I).                              ERCNETP
  3699                                                                  ERCNETP
  3700     COMPUTE RA ROUNDED = 1 -                                     ERCNETP
  3701             ((X2 * (X2 + 1)) /                                   ERCNETP
  3702              (N *  (N  + 1))).                                   ERCNETP
  3703                                                                  ERCNETP
  3704     IF (CP-COMPANY-ID EQUAL 'CSL') AND                           ERCNETP
  3705        (CP-CSL-VALID-NP-BENEFIT-CD)                              ERCNETP
  3706        NEXT SENTENCE                                             ERCNETP
  3707     ELSE                                                         ERCNETP
  3708        GO TO XXXX-CHECK-DISCOUNT-5.                              ERCNETP
  3709                                                                  ERCNETP
  3710     MOVE CP-CERT-EFF-DT TO DC-BIN-DATE-1.                        ERCNETP
  3711     MOVE ' ' TO DC-OPTION-CODE.                                  ERCNETP
  3712     PERFORM 9100-CONVERT-DATE THRU 9100-EXIT.                    ERCNETP
  3713                                                                  ERCNETP
  3714     IF DATE-CONVERSION-ERROR                                     ERCNETP
  3715        MOVE '2'                 TO CP-RETURN-CODE                ERCNETP
  3716        MOVE ZEROS               TO FACTOR                        ERCNETP
  3717                                    CP-CALC-PREMIUM               ERCNETP
  3718         GO TO 99999-RETURN.                                      ERCNETP
  3719                                                                  ERCNETP
  3720     MOVE DC-JULIAN-DATE-1 TO WS-INT-BEGIN-DATE                      CL**2
  3721     MOVE CP-FIRST-PAY-DATE TO DC-BIN-DATE-1                      ERCNETP
  3722     MOVE ' ' TO DC-OPTION-CODE                                   ERCNETP
  3723     PERFORM 9100-CONVERT-DATE THRU 9100-EXIT.                    ERCNETP
  3724                                                                  ERCNETP
  3725     IF DATE-CONVERSION-ERROR                                     ERCNETP
  3726        MOVE '2'                 TO CP-RETURN-CODE                ERCNETP
  3727        MOVE ZEROS               TO FACTOR                        ERCNETP
  3728                                    CP-CALC-PREMIUM               ERCNETP
  3729         GO TO 99999-RETURN.                                      ERCNETP
  3730                                                                  ERCNETP
  3731     MOVE DC-JULIAN-DATE-1 TO WS-DUE-DATE.                           CL**2
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  69
* SUNATEX.cbl (/apps/prod/cid1p/copy/ERCNETP)
  3732                                                                  ERCNETP
  3733     COMPUTE ANGLEN-1 EQUAL 1 + (WK6 / I).                        ERCNETP
  3734                                                                  ERCNETP
  3735     IF (WS-DUE-DATE - WS-INT-BEGIN-DATE) GREATER THAN 30         ERCNETP
  3736        COMPUTE WK3 EQUAL 1 + ((30 + CP-TERM-OR-EXT-DAYS) *       ERCNETP
  3737        CP-PAY-FREQUENCY / 365) * I                               ERCNETP
  3738     ELSE                                                         ERCNETP
  3739        COMPUTE WK3 EQUAL 1 + ((30 - CP-TERM-OR-EXT-DAYS) *       ERCNETP
  3740        CP-PAY-FREQUENCY / 365) * I.                              ERCNETP
  3741                                                                  ERCNETP
  3742     COMPUTE WS-WORK-RATE EQUAL ((2 * CP-PREMIUM-RATE) /          ERCNETP
  3743     13).                                                         ERCNETP
  3744                                                                  ERCNETP
  3745     COMPUTE WK5-CSL EQUAL WS-WORK-RATE * ((1 + I) / I) *         ERCNETP
  3746     (N - ( ANGLEN-1 / WK3)).                                     ERCNETP
  3747                                                                  ERCNETP
  3748     MOVE ZEROS TO WS-Y-X-FACTOR WS-X-Y-FACTOR.                   ERCNETP
  3749                                                                  ERCNETP
  3750     COMPUTE WS-CALC-FREQ-RATE EQUAL                              ERCNETP
  3751       (CP-LOAN-APR * .01) / CP-PAY-FREQUENCY.                    ERCNETP
  3752                                                                  ERCNETP
  3753     COMPUTE WS-Y-X-FACTOR EQUAL                                  ERCNETP
  3754       1 + ((1 - (1 + WS-CALC-FREQ-RATE) ** -(N - 1)) /           ERCNETP
  3755       WS-CALC-FREQ-RATE).                                        ERCNETP
  3756                                                                  ERCNETP
  3757     COMPUTE WS-ODD-DAY-UNITS EQUAL                               ERCNETP
  3758       (WS-DUE-DATE - WS-INT-BEGIN-DATE) * CP-PAY-FREQUENCY / 365.ERCNETP
  3759                                                                  ERCNETP
  3760     COMPUTE WS-X-Y-FACTOR EQUAL                                  ERCNETP
  3761       1 + (WS-ODD-DAY-UNITS * WS-CALC-FREQ-RATE).                ERCNETP
  3762                                                                  ERCNETP
  3763     COMPUTE WS-NP-FACTOR EQUAL WS-WORK-RATE *                    ERCNETP
  3764       ((1 + WS-CALC-FREQ-RATE) / WS-CALC-FREQ-RATE) *            ERCNETP
  3765       (N - (WS-Y-X-FACTOR / WS-X-Y-FACTOR)).                     ERCNETP
  3766                                                                  ERCNETP
  3767     COMPUTE CP-CALC-PREMIUM EQUAL CP-MONTHLY-PAYMENT * WK5-CSL.  ERCNETP
  3768                                                                  ERCNETP
  3769     GO TO 99999-RETURN.                                          ERCNETP
  3770                                                                  ERCNETP
  3771 XXXX-CHECK-DISCOUNT-5.                                           ERCNETP
  3772                                                                  ERCNETP
  3773     IF WS-DISCOUNT-OPTION EQUAL '5'                              ERCNETP
  3774        NEXT SENTENCE                                             ERCNETP
  3775     ELSE                                                         ERCNETP
  3776        GO TO 12000-CHECK-CLIENT.                                 ERCNETP
  3777                                                                  ERCNETP
  3778      COMPUTE ANGLEN EQUAL WK1 / I.                               ERCNETP
  3779                                                                  ERCNETP
  3780      COMPUTE APR100 EQUAL ANNUAL-INT-RATE / +100.                ERCNETP
  3781                                                                  ERCNETP
  3782      COMPUTE WK3 EQUAL                                           ERCNETP
  3783        (12 *                                                     ERCNETP
  3784        (((CP-ORIGINAL-BENEFIT / ANGLEN) * N) -                   ERCNETP
  3785        CP-ORIGINAL-BENEFIT)) /                                   ERCNETP
  3786        APR100.                                                   ERCNETP
  3787                                                                  ERCNETP
  3788     COMPUTE WK3 EQUAL                                            ERCNETP
  3789        (WK3 * CP-PREMIUM-RATE) / +1000.                          ERCNETP
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  70
* SUNATEX.cbl (/apps/prod/cid1p/copy/ERCNETP)
  3790                                                                  ERCNETP
  3791     COMPUTE WK3 EQUAL                                            ERCNETP
  3792        (24 * WK3) / (24 + (WS-WORK-DIS-RATE * N)).               ERCNETP
  3793                                                                  ERCNETP
  3794      MOVE WK3 TO CP-CALC-PREMIUM.                                ERCNETP
  3795                                                                  ERCNETP
  3796     GO TO 99999-RETURN.                                          ERCNETP
  3797                                                                  ERCNETP
  3798 12000-CHECK-CLIENT.                                              ERCNETP
  3799                                                                  ERCNETP
  3800     IF (CP-COMPANY-ID EQUAL 'MON') AND                           ERCNETP
  3801        (CP-STATE-STD-ABBRV EQUAL 'MD') AND                       ERCNETP
  3802        (CP-TRUNCATED-LIFE)                                       ERCNETP
  3803        NEXT SENTENCE                                             ERCNETP
  3804     ELSE                                                         ERCNETP
  3805        GO TO 12000-CHECK-NEXT.                                   ERCNETP
  3806                                                                  ERCNETP
  3807     COMPUTE WS-WORK-RATE EQUAL CP-PREMIUM-RATE / +100.           ERCNETP
  3808                                                                  ERCNETP
  3809     COMPUTE ANGLEN EQUAL WK1 / I.                                ERCNETP
  3810     COMPUTE ANGLEM EQUAL WK2 / I.                                ERCNETP
  3811                                                                  ERCNETP
  3812     COMPUTE FM EQUAL                                             ERCNETP
  3813                    (((ONE-PLUS-I ** M) * I * M) /                ERCNETP
  3814                    ((ONE-PLUS-I ** M) - 1))                      ERCNETP
  3815                    - 1.                                          ERCNETP
  3816                                                                  ERCNETP
  3817     COMPUTE FN EQUAL                                             ERCNETP
  3818                    (((ONE-PLUS-I ** N) * I * N) /                ERCNETP
  3819                    ((ONE-PLUS-I ** N) - 1))                      ERCNETP
  3820                    - 1.                                          ERCNETP
  3821                                                                  ERCNETP
  3822     COMPUTE FNM EQUAL                                            ERCNETP
  3823                    (((ONE-PLUS-I ** (N - M)) * I * (N - M)) /    ERCNETP
  3824                    ((ONE-PLUS-I ** (N - M)) - 1))                ERCNETP
  3825                    - 1.                                          ERCNETP
  3826                                                                  ERCNETP
  3827     COMPUTE GR EQUAL                                             ERCNETP
  3828                    (WS-WORK-RATE * ANGLEM * I) /                 ERCNETP
  3829                    (M - ANGLEM).                                 ERCNETP
  3830                                                                  ERCNETP
  3831     COMPUTE ODF EQUAL                                            ERCNETP
  3832                     (1 +                                         ERCNETP
  3833                     ((12 * I * (CP-TERM-OR-EXT-DAYS + 30)) /     ERCNETP
  3834                     360)) /                                      ERCNETP
  3835                     ONE-PLUS-I.                                  ERCNETP
  3836                                                                  ERCNETP
  3837     COMPUTE OD EQUAL                                             ERCNETP
  3838                    (1 + (ODF * (FN / I - 1))) +                  ERCNETP
  3839                    ((12 * CP-TERM-OR-EXT-DAYS) / +360).          ERCNETP
  3840                                                                  ERCNETP
  3841     COMPUTE WK3 EQUAL                                            ERCNETP
  3842*                   ((1 + FN) * ODF * CP-ORIGINAL-BENEFIT) /      ERCNETP
  3843                    ((1 + FN) * ODF *                             ERCNETP
  3844                    (CP-ORIGINAL-BENEFIT - CP-ORIGINAL-PREMIUM)) /ERCNETP
  3845                    (1 - (GR * (OD - ((ONE-PLUS-I ** M) / I) *    ERCNETP
  3846                    FNM * ODF * (1 - ANGLEM / ANGLEN)))).         ERCNETP
  3847                                                                  ERCNETP
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  71
* SUNATEX.cbl (/apps/prod/cid1p/copy/ERCNETP)
  3848     COMPUTE TRUNC-PMT EQUAL WK3 / N.                             ERCNETP
  3849     COMPUTE WK3 EQUAL TRUNC-PMT * N.                             ERCNETP
  3850                                                                  ERCNETP
  3851     COMPUTE WK3 EQUAL                                            ERCNETP
  3852                    (WK3 / (ODF * (1 + FN))) -                    ERCNETP
  3853*                   CP-ORIGINAL-BENEFIT.                          ERCNETP
  3854                    (CP-ORIGINAL-BENEFIT - CP-ORIGINAL-PREMIUM).  ERCNETP
  3855                                                                  ERCNETP
  3856      MOVE WK3 TO CP-CALC-PREMIUM.                                ERCNETP
  3857                                                                  ERCNETP
  3858     GO TO 99999-RETURN.                                          ERCNETP
  3859                                                                  ERCNETP
  3860 12000-CHECK-NEXT.                                                ERCNETP
  3861                                                                  ERCNETP
  3862     IF WS-DISCOUNT-OPTION EQUAL '3' OR '4'                       ERCNETP
  3863        NEXT SENTENCE                                             ERCNETP
  3864     ELSE                                                         ERCNETP
  3865        GO TO 12000-CHECK-PA-TRUNC.                               ERCNETP
  3866                                                                  ERCNETP
  3867      IF WS-WORK-DIS-RATE EQUAL +0                                ERCNETP
  3868         MOVE '7'                TO CP-RETURN-CODE                ERCNETP
  3869         MOVE ZEROS              TO FACTOR                        ERCNETP
  3870                                    CP-CALC-PREMIUM               ERCNETP
  3871         GO TO 99999-RETURN.                                      ERCNETP
  3872                                                                  ERCNETP
  3873      COMPUTE ANGLEN EQUAL WK1 / I.                               ERCNETP
  3874                                                                  ERCNETP
  3875      COMPUTE APR100 EQUAL ANNUAL-INT-RATE / +100.                ERCNETP
  3876                                                                  ERCNETP
  3877      IF WS-WORK-DIS-RATE EQUAL APR100                            ERCNETP
  3878         ADD .00001 TO APR100.                                    ERCNETP
  3879                                                                  ERCNETP
  3880      COMPUTE WK8 EQUAL 12 / (12 + WS-WORK-DIS-RATE).             ERCNETP
  3881      COMPUTE WK9 EQUAL 12 / (12 + APR100).                       ERCNETP
  3882                                                                  ERCNETP
  3883
  3884
  3885     COMPUTE Y = (1 + ((CP-TERM-OR-EXT-DAYS + +30) * I) / +30)
  3886        / (1 + I)
  3887     COMPUTE ANGLEN-1 = ANGLEN / Y
  3888
  3889      IF CP-COMPANY-ID EQUAL 'CDL'                                ERCNETP
  3890         COMPUTE WK3 EQUAL                                        ERCNETP
  3891                                                                  ERCNETP
  3892          (144 * CP-ORIGINAL-BENEFIT / ANGLEN) *                  ERCNETP
  3893          ((1 + WS-WORK-DIS-RATE / 12) ** .5) *                   ERCNETP
  3894                                                                  ERCNETP
  3895          ((1 / (WS-WORK-DIS-RATE * APR100)) -                    ERCNETP
  3896                                                                  ERCNETP
  3897          ((WK8 ** N) /                                           ERCNETP
  3898          (WS-WORK-DIS-RATE * (APR100 - WS-WORK-DIS-RATE))) +     ERCNETP
  3899                                                                  ERCNETP
  3900          ((WK9 ** N) /                                           ERCNETP
  3901          (APR100 * (APR100 - WS-WORK-DIS-RATE))))                ERCNETP
  3902                                                                  ERCNETP
  3903      ELSE                                                        ERCNETP
  3904         COMPUTE WK3 EQUAL                                        ERCNETP
  3905                                                                  ERCNETP
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  72
* SUNATEX.cbl (/apps/prod/cid1p/copy/ERCNETP)
  3906          ((CP-ORIGINAL-BENEFIT / ANGLEN-1) *
  3907          (12 + WS-WORK-DIS-RATE) * 12) *                         ERCNETP
  3908                                                                  ERCNETP
  3909          ((1 / (WS-WORK-DIS-RATE * APR100)) -                    ERCNETP
  3910                                                                  ERCNETP
  3911          ((WK8 ** N) /                                           ERCNETP
  3912          (WS-WORK-DIS-RATE * (APR100 - WS-WORK-DIS-RATE))) +     ERCNETP
  3913                                                                  ERCNETP
  3914          ((WK9 ** N) /                                           ERCNETP
  3915          (APR100 * (APR100 - WS-WORK-DIS-RATE)))).               ERCNETP
  3916                                                                  ERCNETP
  3917      COMPUTE WK3 EQUAL                                           ERCNETP
  3918          (WK3 * CP-PREMIUM-RATE) / +1000.                        ERCNETP
  3919                                                                  ERCNETP
  3920      MOVE WK3 TO CP-CALC-PREMIUM.                                ERCNETP
  3921                                                                  ERCNETP
  3922     GO TO 99999-RETURN.                                          ERCNETP
  3923                                                                  ERCNETP
  3924 12000-CHECK-PA-TRUNC.                                            ERCNETP
  3925                                                                  ERCNETP
  3926     IF (CP-COMPANY-ID EQUAL 'NCL') AND                           ERCNETP
  3927        (CP-STATE-STD-ABBRV EQUAL 'PA') AND                          CL**3
  3928        (CP-EARN-AS-NET-PAY) AND                                  ERCNETP
  3929        (CP-TRUNCATED-LIFE)                                       ERCNETP
  3930        NEXT SENTENCE                                             ERCNETP
  3931     ELSE                                                         ERCNETP
  3932        GO TO 12000-CHECK-MD-TRUNC.                               ERCNETP
  3933                                                                  ERCNETP
  3934     COMPUTE WS-WORK-RATE EQUAL CP-PREMIUM-RATE / +100.           ERCNETP
  3935                                                                  ERCNETP
  3936     COMPUTE ANGLEN-M EQUAL WK5 / I.                              ERCNETP
  3937     COMPUTE ANGLEN EQUAL WK1 / I.                                ERCNETP
  3938                                                                  ERCNETP
  3939     COMPUTE ANGLEN-1 EQUAL ANGLEN * ODF.                         ERCNETP
  3940                                                                  ERCNETP
  3941     COMPUTE WK3 EQUAL                                            ERCNETP
  3942        (CP-ORIGINAL-BENEFIT * 2 * (M - (ANGLEN-M - ANGLEN)) *    ERCNETP
  3943        WS-WORK-RATE) / (ANGLEN-1 * (N + 1) * I).                 ERCNETP
  3944                                                                  ERCNETP
  3945     MOVE WK3 TO CP-CALC-PREMIUM.                                 ERCNETP
  3946                                                                  ERCNETP
  3947     GO TO 99999-RETURN.                                          ERCNETP
  3948                                                                  ERCNETP
  3949 12000-CHECK-MD-TRUNC.                                            ERCNETP
  3950                                                                  ERCNETP
  3951     IF (CP-COMPANY-ID EQUAL 'NCL') AND                           ERCNETP
  3952        (CP-STATE-STD-ABBRV EQUAL 'MD') AND                       ERCNETP
  3953        (CP-EARN-AS-NET-PAY) AND                                  ERCNETP
  3954        (CP-TRUNCATED-LIFE)                                       ERCNETP
  3955        NEXT SENTENCE                                             ERCNETP
  3956     ELSE                                                         ERCNETP
  3957        GO TO 12000-CHECK-MD.                                     ERCNETP
  3958                                                                  ERCNETP
  3959     COMPUTE WS-WORK-RATE EQUAL CP-PREMIUM-RATE / +100.           ERCNETP
  3960                                                                  ERCNETP
  3961     COMPUTE ANGLEN-M EQUAL WK5 / I.                              ERCNETP
  3962     COMPUTE ANGLEM EQUAL WK2 / I.                                ERCNETP
  3963     COMPUTE ANGLEN EQUAL WK1 / I.                                ERCNETP
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  73
* SUNATEX.cbl (/apps/prod/cid1p/copy/ERCNETP)
  3964                                                                  ERCNETP
  3965     COMPUTE ANGLEN-1 EQUAL ANGLEN * ODF.                         ERCNETP
  3966                                                                  ERCNETP
  3967     COMPUTE WK3 EQUAL                                            ERCNETP
  3968        CP-ORIGINAL-BENEFIT * WS-WORK-RATE *                      ERCNETP
  3969        ((ANGLEM * (M - (ANGLEN - ANGLEN-M))) /                   ERCNETP
  3970        (ANGLEN-1 * (M - ANGLEM))).                               ERCNETP
  3971                                                                  ERCNETP
  3972     MOVE WK3 TO CP-CALC-PREMIUM.                                 ERCNETP
  3973                                                                  ERCNETP
  3974     GO TO 99999-RETURN.                                          ERCNETP
  3975                                                                  ERCNETP
  3976 12000-CHECK-MD.                                                  ERCNETP
  3977                                                                  ERCNETP
  3978     IF (CP-COMPANY-ID EQUAL 'NCL') AND                           ERCNETP
  3979        (CP-STATE-STD-ABBRV EQUAL 'MD') AND                       ERCNETP
  3980        (CP-EARN-AS-NET-PAY)                                      ERCNETP
  3981        NEXT SENTENCE                                             ERCNETP
  3982     ELSE                                                         ERCNETP
  3983        GO TO 12000-CHECK-ME-TRUNC.                               ERCNETP
  3984                                                                  ERCNETP
  3985     COMPUTE WS-WORK-RATE EQUAL CP-PREMIUM-RATE / +100.           ERCNETP
  3986                                                                  ERCNETP
  3987     COMPUTE WK3 EQUAL                                            ERCNETP
  3988        CP-ORIGINAL-BENEFIT * WS-WORK-RATE.                       ERCNETP
  3989                                                                  ERCNETP
  3990     MOVE WK3 TO CP-CALC-PREMIUM.                                 ERCNETP
  3991                                                                  ERCNETP
  3992     GO TO 99999-RETURN.                                          ERCNETP
  3993                                                                  ERCNETP
  3994 12000-CHECK-ME-TRUNC.                                            ERCNETP
  3995                                                                  ERCNETP
  3996     IF (CP-COMPANY-ID EQUAL 'NCL' OR 'CID')
  3997        AND (CP-STATE-STD-ABBRV EQUAL 'ME')
  3998        AND (CP-EARN-AS-NET-PAY)
  3999        AND (CP-TRUNCATED-LIFE)
  4000        CONTINUE
  4001     ELSE
  4002        GO TO 12000-CHECK-CID-WA-FARMPLAN
  4003     END-IF
  4004                                                                  ERCNETP
  4005     COMPUTE WS-WORK-RATE = CP-PREMIUM-RATE / +1000
  4006
  4007     COMPUTE ANGLEN = (1 - (1 / (1 + I)) ** N) / I
  4008
  4009     COMPUTE ANGLEN-M = (1 - (1 / (1 + I)) ** (N - M)) / I
  4010
  4011     COMPUTE D = CP-TERM-OR-EXT-DAYS + +30
  4012
  4013     COMPUTE Y = (1 + (D * I) / 30) / (1 + I)
  4014     COMPUTE ANGLEN-1 = ANGLEN / Y
  4015
  4016     COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN-1
  4017
  4018     COMPUTE WK5 = 1 / (1 + (WS-WORK-DIS-RATE * N / 24))
  4019
  4020     COMPUTE WK9 = 1 / (1 + (WS-WORK-DIS-RATE * (N - M) / 24))
  4021
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  74
* SUNATEX.cbl (/apps/prod/cid1p/copy/ERCNETP)
  4022     COMPUTE WK3
  4023        = (WK4 * ((N - ANGLEN) / I) * WS-WORK-RATE * WK5)
  4024        - (WK4 * (((N - M) - ANGLEN-M) / I) * WS-WORK-RATE * WK9
  4025            * (1 / (1.0635 ** (M / 12))))
  4026
  4027*    COMPUTE WK8 EQUAL 1 / (1 + (.045 * N / 24)).                 ERCNETP
  4028*    COMPUTE WK9 EQUAL                                            ERCNETP
  4029*       1 / (1 + (.045 * (N - M) / 24))                           ERCNETP
  4030*    COMPUTE WK7 EQUAL                                            ERCNETP
  4031*       WS-WORK-RATE * 20 / (M + 1).                              ERCNETP
  4032*    COMPUTE WK3 EQUAL                                            ERCNETP
  4033*       ((( N - ANGLEN) * WK7 * WK8) /                            ERCNETP
  4034*       (10 * ANGLEN-1 * I)) -                                    ERCNETP
  4035*       (((N - M - ANGLEN-M) * WK7 * WK9 * 1) /                   ERCNETP
  4036*       (10 * ANGLEN-1 * I * (1.0635 ** (M / 12)))).              ERCNETP
  4037*    COMPUTE WK3 EQUAL WK3 * CP-ORIGINAL-BENEFIT.                 ERCNETP
  4038*                                                                 ERCNETP
  4039     MOVE WK3 TO CP-CALC-PREMIUM.                                 ERCNETP
  4040                                                                  ERCNETP
  4041     GO TO 99999-RETURN
  4042
  4043      .
  4044 12000-CHECK-CID-WA-FARMPLAN.
  4045
  4046     IF (CP-COMPANY-ID EQUAL 'CID')
  4047        AND (CP-STATE-STD-ABBRV = 'WA')
  4048        AND (CP-FARM-PLAN)
  4049        CONTINUE
  4050     ELSE
  4051        GO TO 12000-CHECK-CID-FARMPLAN
  4052     END-IF
  4053
  4054**  This was removed due to IR 2015022300001
  4055    GO TO 12000-CHECK-CID-FARMPLAN
  4056
  4057     move cp-original-term       to n
  4058     move cp-no-of-pmts          TO C-TOT-PMTS
  4059     compute c-pmts-per-year = 12 / cp-pay-frequency
  4060     move cp-pay-frequency       to m
  4061     compute c-days-in-pmt-per = 365 / c-pmts-per-year
  4062     COMPUTE I = CP-LOAN-APR / C-PMTS-PER-YEAR / 100
  4063     if i = zeros
  4064        move .0000000001         to i
  4065     end-if
  4066     COMPUTE ANGLEN   = (1 - (1 / (1 + I)) ** c-tot-pmts) / I
  4067
  4068     COMPUTE Y = (1 + ((CP-DAYS-TO-1ST-PMT * I) /
  4069        (m * 30))) / (1 + I)
  4070     COMPUTE J = ((1 + WS-WORK-DIS-RATE)
  4071        ** CP-PAY-FREQUENCY) - 1
  4072     COMPUTE TI = (cp-days-to-1st-pmt - (M * 30)) / 30
  4073     COMPUTE WK1 = (1 - (1 / (1 + WS-WORK-DIS-RATE))
  4074        ** TI) / WS-WORK-DIS-RATE
  4075     COMPUTE WK2 = (1 - (1 / (1 + J)) ** c-tot-pmts) / J
  4076     COMPUTE WK3 = (1 - (1 / (1 + J)) ** (c-tot-pmts - 1)) / J
  4077     COMPUTE WK4 = (1 - (1 / (1 + WS-WORK-DIS-RATE))
  4078        ** m) / WS-WORK-DIS-RATE
  4079     COMPUTE WK2 = WK2 * (1 + J)
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  75
* SUNATEX.cbl (/apps/prod/cid1p/copy/ERCNETP)
  4080     COMPUTE WK4 = WK4 * (1 + WS-WORK-DIS-RATE)
  4081     COMPUTE WK1 = WK1 * (1 + WS-WORK-DIS-RATE)
  4082     COMPUTE WK3 = WK3 * (1 + J)
  4083     COMPUTE WK5 = (WK3 - (c-tot-pmts - 1) * (1 / (1 + J)
  4084        ** (c-tot-pmts - 1))) / J
  4085     COMPUTE GR = (((1 / (1 + WS-WORK-DIS-RATE) ** TI) * WK4 *
  4086        ((c-tot-pmts * WK2) - WK5)) + (c-tot-pmts * WK1)) *
  4087        (CP-PREMIUM-RATE / 1000)
  4088     COMPUTE WK7 = CP-ORIGINAL-BENEFIT / (anglen / y)
  4089     COMPUTE WK6 = (WK7 * GR)
  4090
  4091     MOVE WK6 TO CP-CALC-PREMIUM
  4092
  4093     GO TO 99999-RETURN
  4094
  4095     .
  4096 12000-CHECK-CID-FARMPLAN.
  4097
  4098     IF (CP-COMPANY-ID EQUAL 'CID')
  4099        AND (CP-STATE-STD-ABBRV EQUAL 'ND' OR 'MT' OR 'NJ'
  4100           OR 'IN' OR 'AZ')
  4101        AND (CP-FARM-PLAN)
  4102        CONTINUE
  4103     ELSE
  4104        GO TO 12000-CHECK-SC-CID
  4105     END-IF
  4106
  4107     COMPUTE N = M / CP-PAY-FREQUENCY
  4108     COMPUTE D = CP-TERM-OR-EXT-DAYS + +30
  4109     COMPUTE J = ((1 + WS-WORK-DIS-RATE)
  4110        ** CP-PAY-FREQUENCY) - 1
  4111     COMPUTE TI = (D - (CP-PAY-FREQUENCY * 30)) / 30
  4112     COMPUTE WK1 = (1 - (1 / (1 + WS-WORK-DIS-RATE))
  4113        ** TI) / WS-WORK-DIS-RATE
  4114     COMPUTE WK2 = (1 - (1 / (1 + J)) ** N) / J
  4115     COMPUTE WK3 = (1 - (1 / (1 + J)) ** (N - 1)) / J
  4116     COMPUTE WK4 = (1 - (1 / (1 + WS-WORK-DIS-RATE))
  4117        ** CP-PAY-FREQUENCY) / WS-WORK-DIS-RATE
  4118     COMPUTE WK2 = WK2 * (1 + J)
  4119     COMPUTE WK4 = WK4 * (1 + WS-WORK-DIS-RATE)
  4120     COMPUTE WK1 = WK1 * (1 + WS-WORK-DIS-RATE)
  4121     COMPUTE WK3 = WK3 * (1 + J)
  4122     COMPUTE WK5 = (WK3 - (N - 1) * (1 / (1 + J)
  4123        ** (N - 1))) / J
  4124     COMPUTE GR = (((1 / (1 + WS-WORK-DIS-RATE) ** TI) * WK4 *
  4125        ((N * WK2) - WK5)) + (N * WK1)) *
  4126        (CP-PREMIUM-RATE / 1000)
  4127     COMPUTE WK7 = CP-ORIGINAL-BENEFIT / N
  4128     COMPUTE WK6 = (WK7 * GR)
  4129
  4130     MOVE WK6 TO CP-CALC-PREMIUM
  4131
  4132     GO TO 99999-RETURN
  4133
  4134     .
  4135 12000-CHECK-SC-CID.
  4136
  4137     IF (CP-COMPANY-ID = 'CID')
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  76
* SUNATEX.cbl (/apps/prod/cid1p/copy/ERCNETP)
  4138        AND (CP-STATE-STD-ABBRV = 'SC')
  4139        AND (CP-EARN-AS-NET-PAY)
  4140        AND (CP-BENEFIT-CD = '2I' OR '2J' OR '2K' OR '2L')
  4141        move 6                   to ws-extra-pmts
  4142     ELSE
  4143        GO TO 12000-CHECK-AL-CID
  4144     END-IF
  4145
  4146     COMPUTE D = CP-TERM-OR-EXT-DAYS + +30
  4147     COMPUTE Y = (1 + (D * I) / 30) / (1 + I)
  4148     COMPUTE WK2 = (CP-PREMIUM-RATE * ((M + ((D - 30) / 30))
  4149        / 12)) / ((M + 1) / 2)
  4150
  4151     if i = .0000000001
  4152        compute wk4 = cp-original-benefit / n
  4153        compute wk3 = wk4 * (((n * (n + 1)) / 2 - ((n - m) *
  4154            (n - m + 1)) / 2 + ws-extra-pmts * m) * wk2 / 100)
  4155        display ' hit sc wo apr - wk2 ' wk2
  4156     else
  4157        COMPUTE ANGLEN rounded = (1 - (1 / (1 + I)) ** N) / I
  4158        COMPUTE ANGLEN-M = (1 - (1 / (1 + I)) ** (N - M)) / I
  4159        COMPUTE ANGLEN-1 = ANGLEN / Y
  4160        COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN-1
  4161        COMPUTE WK3 = WK4 * (((M - (ANGLEN - ANGLEN-M)) / I)
  4162           + WS-EXTRA-PMTS * M) * (WK2 / 100) * (1 + I)
  4163     end-if
  4164
  4165*    COMPUTE ANGLEN = (1 - (1 / (1 + I)) ** N) / I
  4166*    COMPUTE ANGLEN-M = (1 - (1 / (1 + I)) ** (N - M)) / I
  4167*    COMPUTE D = CP-TERM-OR-EXT-DAYS + +30
  4168*    COMPUTE Y = (1 + (D * I) / 30) / (1 + I)
  4169*    COMPUTE ANGLEN-1 = ANGLEN / Y
  4170*    COMPUTE WK2 = (CP-PREMIUM-RATE * ((M + ((D - 30) / 30))
  4171*       / 12)) / ((M + 1) / 2)
  4172*    COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN-1
  4173*    COMPUTE WK3 = WK4 * (((M - (ANGLEN - ANGLEN-M)) / I)
  4174*       + WS-EXTRA-PMTS * M) * (WK2 / 100) * (1 + I)
  4175
  4176     MOVE WK3 TO CP-CALC-PREMIUM
  4177
  4178     GO TO 99999-RETURN
  4179
  4180     .
  4181 12000-CHECK-AL-CID.
  4182
  4183     IF (CP-COMPANY-ID EQUAL 'CID')
  4184        AND (CP-BENEFIT-CD = '49' OR '50' OR '53' OR '54')
  4185        AND (CP-EARN-AS-NET-PAY)
  4186        CONTINUE
  4187     ELSE
  4188        GO TO 12000-CHECK-NH-CID
  4189     END-IF
  4190
  4191     COMPUTE ANGLEN = (1 - (1 / (1 + I)) ** N) / I
  4192     COMPUTE ANGLEM = (1 - (1 / (1 + I)) ** M) / I
  4193     COMPUTE ANGLEN-M = (1 - (1 / (1 + I)) ** (N - M)) / I
  4194
  4195     COMPUTE WK8 = (1 + ((CP-TERM-OR-EXT-DAYS + +30)* I) / +30)
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  77
* SUNATEX.cbl (/apps/prod/cid1p/copy/ERCNETP)
  4196                   / (1 + I)
  4197
  4198     COMPUTE ANGLEN-1 = ANGLEN / WK8
  4199
  4200     COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN-1
  4201
  4202     COMPUTE WK3 = WK4 * ((M - (ANGLEN - ANGLEN-M) + I * M) / I) *
  4203        (CP-PREMIUM-RATE / 1000)
  4204
  4205     MOVE WK3 TO CP-CALC-PREMIUM
  4206
  4207     GO TO 99999-RETURN
  4208
  4209     .
  4210 12000-CHECK-NH-CID.
  4211
  4212     IF (CP-COMPANY-ID EQUAL 'CID')
  4213        AND (CP-STATE-STD-ABBRV = 'NH' OR 'AK')
  4214        AND (CP-EARN-AS-NET-PAY)
  4215        CONTINUE
  4216     ELSE
  4217        GO TO 12000-CHECK-PA-CID
  4218     END-IF
  4219
  4220     COMPUTE ANGLEN = (1 - (1 / (1 + I)) ** N) / I
  4221     COMPUTE ANGLEN-M = (1 - (1 / (1 + I)) ** (N - M)) / I
  4222
  4223     COMPUTE WK8 = (1 + ((CP-TERM-OR-EXT-DAYS + +30)* I) / +30)
  4224                   / (1 + I)
  4225
  4226     COMPUTE ANGLEN-1 = ANGLEN / WK8
  4227
  4228     COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN-1
  4229
  4230     COMPUTE WK3 = WK4 * ((M - (ANGLEN - ANGLEN-M)) / I) *
  4231        (1 + (2 * I)) * (CP-PREMIUM-RATE / 1000)
  4232
  4233     MOVE WK3 TO CP-CALC-PREMIUM
  4234
  4235     GO TO 99999-RETURN
  4236
  4237     .
  4238 12000-CHECK-PA-CID.
  4239
  4240     IF (CP-COMPANY-ID EQUAL 'CID')
  4241        AND (CP-STATE-STD-ABBRV EQUAL 'PA')
  4242        AND (CP-EARN-AS-NET-PAY)
  4243        CONTINUE
  4244     ELSE
  4245        GO TO 12000-CHECK-ME-CID
  4246     END-IF
  4247
  4248
  4249     COMPUTE ANGLEN = (1 - (1 / (1 + I)) ** N) / I
  4250     COMPUTE D = CP-TERM-OR-EXT-DAYS + +30
  4251     COMPUTE Y = (1 + (D * I) / 30) / (1 + I)
  4252     COMPUTE ANGLEN-1 = ANGLEN / Y
  4253     COMPUTE WK5 = 1 / (10 * (1 + (WS-WORK-DIS-RATE / 24) * N))
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  78
* SUNATEX.cbl (/apps/prod/cid1p/copy/ERCNETP)
  4254     COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN-1
  4255     COMPUTE WS-WORK-RATE EQUAL CP-PREMIUM-RATE / +100
  4256     COMPUTE WK3 = WK4 * ((N - ANGLEN) / I) * WS-WORK-RATE
  4257        * WK5
  4258
  4259     MOVE WK3 TO CP-CALC-PREMIUM
  4260
  4261     GO TO 99999-RETURN
  4262
  4263     .
  4264 12000-CHECK-ME-CID.
  4265
  4266     IF (CP-COMPANY-ID EQUAL 'CID')
  4267        AND (CP-STATE-STD-ABBRV EQUAL 'ME')
  4268        AND (CP-EARN-AS-NET-PAY)
  4269        CONTINUE
  4270     ELSE
  4271        GO TO 12000-CHECK-VT-TRUNC
  4272     END-IF
  4273
  4274     COMPUTE WS-WORK-RATE = CP-PREMIUM-RATE / +1000
  4275
  4276     COMPUTE ANGLEN = (1 - (1 / (1 + I)) ** N) / I
  4277
  4278     COMPUTE D = CP-TERM-OR-EXT-DAYS + +30
  4279     COMPUTE Y = (1 + (D * I) / 30) / (1 + I)
  4280     COMPUTE ANGLEN-1 = ANGLEN / Y
  4281
  4282     COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN-1
  4283
  4284     COMPUTE WK5 = 1 / (1 + (WS-WORK-DIS-RATE * N / 24))
  4285
  4286     COMPUTE WK3 = WK4 * ((N - ANGLEN) / I) * WS-WORK-RATE
  4287        * WK5
  4288
  4289     MOVE WK3 TO CP-CALC-PREMIUM
  4290
  4291     GO TO 99999-RETURN
  4292
  4293     .
  4294 12000-CHECK-VT-TRUNC.                                            ERCNETP
  4295                                                                  ERCNETP
  4296     IF (CP-COMPANY-ID EQUAL 'NCL') AND                           ERCNETP
  4297        (CP-STATE-STD-ABBRV EQUAL 'VT') AND                       ERCNETP
  4298        (CP-EARN-AS-NET-PAY) AND                                  ERCNETP
  4299        (CP-TRUNCATED-LIFE)                                       ERCNETP
  4300        NEXT SENTENCE                                             ERCNETP
  4301     ELSE                                                         ERCNETP
  4302        GO TO 12000-CHECK-VT.                                     ERCNETP
  4303                                                                  ERCNETP
  4304      COMPUTE WS-WORK-RATE EQUAL CP-PREMIUM-RATE / +1000.         ERCNETP
  4305                                                                  ERCNETP
  4306      COMPUTE ANGLEN EQUAL WK1 / I.                               ERCNETP
  4307                                                                  ERCNETP
  4308      COMPUTE ANGLEN-1 EQUAL ANGLEN * ODF.                        ERCNETP
  4309                                                                  ERCNETP
  4310      COMPUTE WK8 EQUAL (1 / (1 + I)) ** N.                       ERCNETP
  4311      COMPUTE WK9 EQUAL                                           ERCNETP
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  79
* SUNATEX.cbl (/apps/prod/cid1p/copy/ERCNETP)
  4312        (1 - ((1 / (1 + ((.0054 - I) / (1 + I)))) ** (M - 1))) /  ERCNETP
  4313        ((.0054 - I) / (1 + I)).                                  ERCNETP
  4314      COMPUTE WK7 EQUAL                                           ERCNETP
  4315        (1 - (1 / 1.0054) ** (M - 1)) / .0054.                    ERCNETP
  4316      COMPUTE WK3 EQUAL  CP-ORIGINAL-BENEFIT * WS-WORK-RATE *     ERCNETP
  4317        ((WK7 + 1) - (WK8 * (WK9 + 1))) / (ANGLEN-1 * I).         ERCNETP
  4318                                                                  ERCNETP
  4319      MOVE WK3 TO CP-CALC-PREMIUM.                                ERCNETP
  4320                                                                  ERCNETP
  4321     GO TO 99999-RETURN.                                          ERCNETP
  4322                                                                  ERCNETP
  4323 12000-CHECK-VT.                                                  ERCNETP
  4324                                                                  ERCNETP
  4325     IF (CP-COMPANY-ID EQUAL 'NCL') AND                           ERCNETP
  4326        (CP-STATE-STD-ABBRV EQUAL 'VT') AND                       ERCNETP
  4327        (CP-EARN-AS-NET-PAY)                                      ERCNETP
  4328        NEXT SENTENCE                                             ERCNETP
  4329     ELSE                                                         ERCNETP
  4330        GO TO 12000-CHECK-MINN-WDS.                               ERCNETP
  4331                                                                  ERCNETP
  4332      COMPUTE WS-WORK-RATE EQUAL CP-PREMIUM-RATE / +1000.         ERCNETP
  4333                                                                  ERCNETP
  4334      COMPUTE ANGLEN EQUAL WK1 / I.                               ERCNETP
  4335                                                                  ERCNETP
  4336      COMPUTE ANGLEN-1 EQUAL ANGLEN * ODF.                        ERCNETP
  4337                                                                  ERCNETP
  4338      COMPUTE WK3 EQUAL ((CP-ORIGINAL-BENEFIT * WS-WORK-RATE) /   ERCNETP
  4339                        (ANGLEN-1 * I)) *                         ERCNETP
  4340                                                                  ERCNETP
  4341                        (((1.0054 ** N - 1) /                     ERCNETP
  4342                        (1.0054 ** (N - 1) * .0054)) -            ERCNETP
  4343                                                                  ERCNETP
  4344                        ((V * (1 - 1.0054 ** N * VX)) /           ERCNETP
  4345                        (1.0054 ** (N - 1) * (1 - 1.0054 * V)))). ERCNETP
  4346                                                                  ERCNETP
  4347      MOVE WK3 TO CP-CALC-PREMIUM.                                ERCNETP
  4348                                                                  ERCNETP
  4349     GO TO 99999-RETURN.                                          ERCNETP
  4350                                                                  ERCNETP
  4351 12000-CHECK-MINN-WDS.                                            ERCNETP
  4352                                                                  ERCNETP
  4353     IF (CP-COMPANY-ID EQUAL 'WDS') AND                           ERCNETP
  4354        (CP-STATE-STD-ABBRV EQUAL 'MN') AND                       ERCNETP
  4355        (CP-EARN-AS-NET-PAY)                                      ERCNETP
  4356        NEXT SENTENCE                                             ERCNETP
  4357     ELSE                                                         ERCNETP
  4358        GO TO 12000-CHECK-MINN-BALL-LEV.                          ERCNETP
  4359                                                                  ERCNETP
  4360     COMPUTE ANGLEN EQUAL WK1 / I.                                ERCNETP
  4361     COMPUTE WK3 EQUAL (CP-PREMIUM-RATE / +100) *                 ERCNETP
  4362              (N / +12) * (2 / (N + 1)).                          ERCNETP
  4363     COMPUTE WK3 EQUAL (CP-ORIGINAL-BENEFIT / ANGLEN) *           ERCNETP
  4364         WK3 * ((N - ANGLEN) / I).                                ERCNETP
  4365                                                                  ERCNETP
  4366      MOVE WK3 TO CP-CALC-PREMIUM.                                ERCNETP
  4367                                                                  ERCNETP
  4368     GO TO 99999-RETURN.                                          ERCNETP
  4369                                                                  ERCNETP
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  80
* SUNATEX.cbl (/apps/prod/cid1p/copy/ERCNETP)
  4370 12000-CHECK-MINN-BALL-LEV.                                       ERCNETP
  4371                                                                  ERCNETP
  4372     IF (CP-COMPANY-ID EQUAL 'WDS') AND                           ERCNETP
  4373        (CP-STATE-STD-ABBRV EQUAL 'MN') AND                       ERCNETP
  4374        (CP-DEVIATION-CODE EQUAL 'LEV') AND                       ERCNETP
  4375        (CP-EARN-AS-REG-BALLOON)                                  ERCNETP
  4376        NEXT SENTENCE                                             ERCNETP
  4377     ELSE                                                         ERCNETP
  4378        GO TO 12000-CHECK-MINN-BALL.                              ERCNETP
  4379                                                                  ERCNETP
  4380     COMPUTE ANGLEN EQUAL WK1 / I.                                ERCNETP
  4381                                                                  ERCNETP
  4382     COMPUTE WK3 EQUAL 1 / (1 + I) ** N.                          ERCNETP
  4383                                                                  ERCNETP
  4384     COMPUTE WK3 EQUAL CP-ORIGINAL-BENEFIT * CP-PREMIUM-RATE /    ERCNETP
  4385        +100 * N / 12 * 2 / (N + 1) * (ANGLEN / WK3).             ERCNETP
  4386                                                                  ERCNETP
  4387     MOVE WK3 TO CP-CALC-PREMIUM.                                 ERCNETP
  4388                                                                  ERCNETP
  4389     GO TO 99999-RETURN.                                          ERCNETP
  4390                                                                  ERCNETP
  4391 12000-CHECK-MINN-BALL.                                           ERCNETP
  4392                                                                  ERCNETP
  4393     IF (CP-COMPANY-ID EQUAL 'WDS') AND                           ERCNETP
  4394        (CP-STATE-STD-ABBRV EQUAL 'MN') AND                       ERCNETP
  4395        (CP-EARN-AS-REG-BALLOON)                                  ERCNETP
  4396        NEXT SENTENCE                                             ERCNETP
  4397     ELSE                                                         ERCNETP
  4398        GO TO 12000-CHECK-CID-MN-BALL.                            ERCNETP
  4399                                                                  ERCNETP
  4400     COMPUTE ANGLEN EQUAL WK1 / I.                                ERCNETP
  4401     COMPUTE ANGLEN-1 EQUAL WK6 / I.                              ERCNETP
  4402                                                                  ERCNETP
  4403     COMPUTE WK3 EQUAL CP-ORIGINAL-BENEFIT * CP-PREMIUM-RATE      ERCNETP
  4404     / +100 * (N - 1) / 12 * 2 / N *                              ERCNETP
  4405     (((N - 1) - ANGLEN-1) / (I * ANGLEN-1)).                     ERCNETP
  4406                                                                  ERCNETP
  4407      MOVE WK3 TO CP-CALC-PREMIUM.                                ERCNETP
  4408                                                                  ERCNETP
  4409     GO TO 99999-RETURN.                                          ERCNETP
  4410                                                                  ERCNETP
  4411 12000-CHECK-CID-MN-BALL.                                         ERCNETP
  4412                                                                  ERCNETP
  4413     IF (CP-COMPANY-ID EQUAL 'CID')
  4414        AND (CP-STATE-STD-ABBRV = 'MN')
  4415        AND (CP-CERT-EFF-DT > X'A4FF')
  4416        AND (CP-EARN-AS-REG-BALLOON)
  4417        CONTINUE
  4418     ELSE
  4419        GO TO 12000-CHECK-CID-MN-FARM
  4420     END-IF
  4421                                                                  ERCNETP
  4422     COMPUTE ANGLEN = (1 - (1 / (1 + I)) ** N) / I
  4423     COMPUTE ANGLEM = (1 - (1 / (1 + I)) ** M) / I
  4424     COMPUTE ANGLEMP1 = (1 - (1 / (1 + I)) ** (M + 1)) / I
  4425     COMPUTE ANGLEM-1 = (1 - (1 / (1 + I)) ** (M - 1)) / I
  4426     COMPUTE ANGLEN-M = (1 - (1 / (1 + I)) ** (N - M + 1)) / I
  4427     COMPUTE V = 1 / (1 + I)
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  81
* SUNATEX.cbl (/apps/prod/cid1p/copy/ERCNETP)
  4428     COMPUTE D = CP-TERM-OR-EXT-DAYS + +30
  4429     COMPUTE Y = (1 + (D * I) / +30)
  4430        / (1 + I)
  4431
  4432
  4433     COMPUTE CP-LF-BALLOON-PREM = CP-ALTERNATE-BENEFIT * (M + 1)
  4434        * CP-PREMIUM-RATE / 1000
  4435
  4436*    IF CP-MONTHLY-PAYMENT NOT = ZEROS
  4437*       MOVE CP-MONTHLY-PAYMENT  TO GR
  4438*    ELSE
  4439*       COMPUTE WK6 = CP-ORIGINAL-BENEFIT + CP-ALTERNATE-BENEFIT
  4440*          * (ANGLEM / Y) * (CP-PREMIUM-RATE / 1000) -
  4441*          CP-ALTERNATE-BENEFIT * V ** (M + ((D - 30) / 30))
  4442*       DISPLAY ' BALLOON TOP ' WK6
  4443*       COMPUTE WK7 = (ANGLEM-1 / Y) - ((M - 1) - ANGLEM-1) / I
  4444*          * (CP-PREMIUM-RATE / 1000) * (1 + I) - ((M - 1) * 6.65)
  4445*          / 100
  4446*       DISPLAY ' BALLOON BOTTOM ' WK7
  4447*       COMPUTE GR = WK6 / WK7
  4448*       DISPLAY ' BALLOON PAYMENT ' GR
  4449*    END-IF
  4450
  4451     COMPUTE WK8 = (1 + I) ** ((M + 1) * -1)
  4452     COMPUTE CP-ORIGINAL-BENEFIT ROUNDED = (CP-ORIGINAL-BENEFIT
  4453        + CP-ALTERNATE-BENEFIT) - (CP-ALTERNATE-BENEFIT * WK8)
  4454     COMPUTE GR = CP-ORIGINAL-BENEFIT / ANGLEM
  4455
  4456     COMPUTE WK3 = (GR * ((M - ANGLEM) / I) * (1 + I)
  4457        + (CP-ALTERNATE-BENEFIT * ANGLEMP1) -
  4458           (CP-ALTERNATE-BENEFIT * (M + 1)))
  4459           * CP-PREMIUM-RATE / 1000
  4460
  4461     MOVE WK3                    TO CP-CALC-PREMIUM
  4462                                                                  ERCNETP
  4463     GO TO 99999-RETURN.                                          ERCNETP
  4464
  4465     .
  4466 12000-CHECK-CID-MN-FARM.
  4467
  4468     IF (CP-COMPANY-ID EQUAL 'CID')
  4469        AND (CP-STATE-STD-ABBRV = 'MN' or 'WA')
  4470        AND (CP-CERT-EFF-DT > X'A4FF')
  4471        AND (CP-EARN-AS-FARM-PLAN)
  4472        CONTINUE
  4473     ELSE
  4474        GO TO 12000-CHECK-CID-NET-BALLoons
  4475     END-IF
  4476
  4477     EVALUATE CP-PMT-MODE
  4478        WHEN 'B'
  4479           MOVE +14              TO C-DAYS-IN-PMT-PER
  4480           MOVE +26              TO C-PMTS-PER-YEAR
  4481           MOVE CP-NO-OF-PMTS    TO C-TOT-PMTS
  4482        WHEN 'S'
  4483           MOVE +15              TO C-DAYS-IN-PMT-PER
  4484           MOVE +24              TO C-PMTS-PER-YEAR
  4485           MOVE CP-NO-OF-PMTS    TO C-TOT-PMTS
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  82
* SUNATEX.cbl (/apps/prod/cid1p/copy/ERCNETP)
  4486        WHEN 'T'
  4487           MOVE +360             TO C-DAYS-IN-PMT-PER
  4488           MOVE +1               TO C-PMTS-PER-YEAR
  4489           MOVE CP-NO-OF-PMTS    TO C-TOT-PMTS
  4490        WHEN 'W'
  4491           MOVE +7               TO C-DAYS-IN-PMT-PER
  4492           MOVE +52              TO C-PMTS-PER-YEAR
  4493           MOVE CP-NO-OF-PMTS    TO C-TOT-PMTS
  4494        WHEN OTHER
  4495           move cp-no-of-pmts    to c-tot-pmts
  4496           if cp-pay-frequency > zeros
  4497              compute c-pmts-per-year =
  4498                 12 / cp-pay-frequency
  4499              compute c-days-in-pmt-per = 360 / c-pmts-per-year
  4500           else
  4501              MOVE +30           TO C-DAYS-IN-PMT-PER
  4502              MOVE +12           TO C-PMTS-PER-YEAR
  4503              MOVE CP-LOAN-TERM  TO C-TOT-PMTS
  4504           end-if
  4505     END-EVALUATE
  4506
  4507     COMPUTE I = CP-LOAN-APR / C-PMTS-PER-YEAR / 100
  4508     if i = zeros
  4509        move .0000000001         to i
  4510     end-if
  4511
  4512     COMPUTE Y = (1 + (CP-DAYS-TO-1ST-PMT * I /
  4513        C-DAYS-IN-PMT-PER)) / (1 + I)
  4514
  4515     compute cp-premium-rate =
  4516        cp-premium-rate * 12 / c-pmts-per-year / 10
  4517     move c-tot-pmts to n m
  4518     COMPUTE ANGLEN   = (1 - (1 / (1 + I)) ** N) / I
  4519     COMPUTE ANGLEN-M = (1 - (1 / (1 + I)) ** (N - M)) / I
  4520     COMPUTE ANGLEN-1 = ANGLEN / Y
  4521     COMPUTE WK3 = CP-ORIGINAL-BENEFIT / ANGLEN-1
  4522
  4523     compute wk3 = wk3 * ((m - (anglen - anglen-m)) / i) *
  4524        (cp-premium-rate / 100)
  4525
  4526
  4527     MOVE WK3                    TO CP-CALC-PREMIUM
  4528
  4529     GO TO 99999-RETURN.
  4530
  4531     .
  4532 12000-check-cid-net-balloons.
  4533
  4534     IF (CP-COMPANY-ID EQUAL 'CID')
  4535        AND (CP-EARN-AS-REG-BALLOON)
  4536        and (CP-NET-ONLY-STATE not = 'Y')
  4537        AND (CP-BEN-CATEGORY = 'P' OR 'I')
  4538        CONTINUE
  4539     ELSE
  4540        GO TO 12000-check-cid-net-only-balls
  4541     END-IF
  4542
  4543     display ' *** NOT NET ONLY STATE BALLOONS *** '
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  83
* SUNATEX.cbl (/apps/prod/cid1p/copy/ERCNETP)
  4544     COMPUTE Y =
  4545        (1 + (CP-DAYS-TO-1ST-PMT * I / 30)) / (1 + I)
  4546
  4547     COMPUTE ANGLEN   = (1 - (1 / (1 + I)) ** N) / I
  4548     COMPUTE ANGLEM   = (1 - (1 / (1 + I)) ** M) / I
  4549     COMPUTE ANGLEM-1   = (1 - (1 / (1 + I)) ** (M - 1)) / I
  4550     COMPUTE ANGLEN-MP1 = (1 - (1 / (1 + I)) ** (N - M + 1)) / I
  4551     COMPUTE ANGLEMY = ANGLEM / Y
  4552     COMPUTE ANGLEM-1Y = ANGLEM-1 / Y
  4553     COMPUTE ANGLENY = ANGLEN / Y
  4554     COMPUTE ANGLEN-MP1Y = ANGLEN-MP1 / Y
  4555
  4556     compute cp-original-benefit =
  4557        cp-original-benefit + cp-alternate-benefit
  4558     COMPUTE PVBALLOON rounded =
  4559        CP-ALTERNATE-BENEFIT / ((1 + I) ** (N + 1))
  4560     compute wk4 rounded =
  4561        cp-original-benefit - pvballoon
  4562     compute wk6 rounded =
  4563        (cp-original-benefit - cp-alternate-benefit)
  4564
  4565***  compute ra = wk4 / anglem-1y
  4566     compute ra = wk4 / anglemy
  4567     compute wk6 rounded = wk6 / anglemy
  4568     display ' rate before ' cp-premium-rate
  4569
  4570
  4571     compute cp-premium-rate =
  4572        (cp-premium-rate * ((m + (cp-days-to-1st-pmt - 30)
  4573            / 30) / 12))     /
  4574           ((m + 1) / 2)
  4575
  4576     display '************************************'
  4577     display ' orign ben    ' cp-original-benefit
  4578     display ' balloon      ' cp-alternate-benefit
  4579     display ' ra           ' ra
  4580     display ' wk6          ' wk6
  4581     display ' m            ' m
  4582     display ' anglemy      ' anglemy
  4583     display ' anglem-1     ' anglem-1y
  4584     display ' i            ' i
  4585     display ' extra per    ' cp-extra-periods
  4586     display ' prem rate    ' cp-premium-rate
  4587
  4588
  4589***  compute wk3 = ra * ((m - 1) - anglem-1y) / i * (1 +
  4590***     (cp-extra-periods * i)) * cp-premium-rate / 100
  4591
  4592     compute wk3 = wk6 * (m - anglem) / i * (1 +
  4593        (cp-extra-periods * i)) * cp-premium-rate / 100
  4594
  4595     move wk3                    to cp-calc-premium
  4596     display ' wk3          ' wk3
  4597     display '************************************'
  4598*    compute wk3 rounded =
  4599*       cp-alternate-benefit * (m + 1) * cp-premium-rate / 100
  4600*    move wk3                    to cp-lf-balloon-prem
  4601
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  84
* SUNATEX.cbl (/apps/prod/cid1p/copy/ERCNETP)
  4602     GO TO 99999-RETURN.
  4603
  4604     .
  4605 12000-check-cid-net-only-balls.
  4606
  4607     IF (CP-COMPANY-ID EQUAL 'CID')
  4608        AND (CP-EARN-AS-REG-BALLOON)
  4609        AND (CP-BEN-CATEGORY = 'P' OR 'I')
  4610        CONTINUE
  4611     ELSE
  4612        GO TO 12000-CHECK-NC-WDS
  4613     END-IF
  4614
  4615     display ' *** NET ONLY STATE BALLOONS *** '
  4616
  4617     COMPUTE Y =
  4618        (1 + (CP-DAYS-TO-1ST-PMT * I / 30)) / (1 + I)
  4619
  4620     COMPUTE ANGLEN   = (1 - (1 / (1 + I)) ** N) / I
  4621     COMPUTE ANGLEM   = (1 - (1 / (1 + I)) ** M) / I
  4622     COMPUTE ANGLEM-1   = (1 - (1 / (1 + I)) ** (M - 1)) / I
  4623     COMPUTE ANGLEN-MP1 = (1 - (1 / (1 + I)) ** (N - M + 1)) / I
  4624     COMPUTE ANGLEMY = ANGLEM / Y
  4625     COMPUTE ANGLEM-1Y = ANGLEM-1 / Y
  4626     COMPUTE ANGLENY = ANGLEN / Y
  4627     COMPUTE ANGLEN-MP1Y = ANGLEN-MP1 / Y
  4628
  4629
  4630     COMPUTE PVBALLOON rounded =
  4631        CP-ALTERNATE-BENEFIT / ((1 + I) ** (N + 1))
  4632     compute wk4 rounded =
  4633        cp-original-benefit - pvballoon
  4634
  4635
  4636*    compute cp-premium-rate =
  4637*       (cp-premium-rate * (m + 1) / 12)  /
  4638*          ((m + 2) / 2)
  4639
  4640
  4641***  compute ra = wk4 / anglem-1y
  4642     compute ra = (cp-original-benefit + cp-alternate-benefit -
  4643        pvballoon) / anglemy
  4644
  4645     display '************************************'
  4646     display ' ra           ' ra
  4647     display ' m            ' m
  4648     display ' anglemy      ' anglemy
  4649     display ' anglem-1     ' anglem-1y
  4650     display ' i            ' i
  4651     display ' extra per    ' cp-extra-periods
  4652     display ' prem rate    ' cp-premium-rate
  4653     display '************************************'
  4654
  4655***  compute wk3 = ra * ((m - 1) - anglem-1y) / i * (1 +
  4656***     (cp-extra-periods * i)) * cp-premium-rate / 100
  4657
  4658     compute wk3 = ra * (m - anglemy) / i * (1 +
  4659        (cp-extra-periods * i)) * cp-premium-rate / 100
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  85
* SUNATEX.cbl (/apps/prod/cid1p/copy/ERCNETP)
  4660
  4661     move wk3                    to cp-calc-premium
  4662     compute wk3 rounded =
  4663        cp-alternate-benefit * (m + 1) * cp-premium-rate / 100
  4664     move wk3                    to cp-lf-balloon-prem
  4665
  4666     GO TO 99999-RETURN.
  4667
  4668     .
  4669 12000-CHECK-NC-WDS.                                              ERCNETP
  4670                                                                  ERCNETP
  4671     IF (CP-COMPANY-ID EQUAL 'WDS') AND                           ERCNETP
  4672        (CP-STATE-STD-ABBRV EQUAL 'NC') AND                       ERCNETP
  4673        (CP-EARN-AS-NET-PAY)                                      ERCNETP
  4674        NEXT SENTENCE                                             ERCNETP
  4675     ELSE                                                         ERCNETP
  4676        GO TO 12000-CHECK-NC-BALL-LEV.                            ERCNETP
  4677                                                                  ERCNETP
  4678     COMPUTE WK4 EQUAL N * (1 + I * 2).                           ERCNETP
  4679     COMPUTE ANGLEN EQUAL WK1 / I.                                ERCNETP
  4680     COMPUTE WK3 EQUAL CP-ORIGINAL-BENEFIT *                      ERCNETP
  4681              CP-PREMIUM-RATE / +100 *                            ERCNETP
  4682              N / +12 * 2 / (N + 1) *                             ERCNETP
  4683              (WK4 - ANGLEN) / (I * ANGLEN).                      ERCNETP
  4684                                                                  ERCNETP
  4685      MOVE WK3 TO CP-CALC-PREMIUM.                                ERCNETP
  4686                                                                  ERCNETP
  4687     GO TO 99999-RETURN.                                          ERCNETP
  4688                                                                  ERCNETP
  4689 12000-CHECK-NC-BALL-LEV.                                         ERCNETP
  4690                                                                  ERCNETP
  4691     IF (CP-COMPANY-ID EQUAL 'WDS') AND                           ERCNETP
  4692        (CP-STATE-STD-ABBRV EQUAL 'NC') AND                       ERCNETP
  4693        (CP-DEVIATION-CODE EQUAL 'LEV') AND                       ERCNETP
  4694        (CP-EARN-AS-REG-BALLOON)                                  ERCNETP
  4695        NEXT SENTENCE                                             ERCNETP
  4696     ELSE                                                         ERCNETP
  4697        GO TO 12000-CHECK-NC-BALL.                                ERCNETP
  4698                                                                  ERCNETP
  4699     COMPUTE ANGLEN EQUAL WK1 / I.                                ERCNETP
  4700                                                                  ERCNETP
  4701**** VX = 1 / (1 + I)**N.                                         ERCNETP
  4702                                                                  ERCNETP
  4703     COMPUTE WK3 EQUAL CP-ORIGINAL-BENEFIT * CP-PREMIUM-RATE /    ERCNETP
  4704        +100 * N / 12 * 2 / (N + 1) * (ANGLEN / VX).              ERCNETP
  4705                                                                  ERCNETP
  4706     MOVE WK3 TO CP-CALC-PREMIUM.                                 ERCNETP
  4707                                                                  ERCNETP
  4708     GO TO 99999-RETURN.                                          ERCNETP
  4709                                                                  ERCNETP
  4710 12000-CHECK-NC-BALL.                                             ERCNETP
  4711                                                                  ERCNETP
  4712     IF (CP-COMPANY-ID EQUAL 'WDS') AND                           ERCNETP
  4713        (CP-STATE-STD-ABBRV EQUAL 'NC') AND                       ERCNETP
  4714        (CP-EARN-AS-REG-BALLOON)                                  ERCNETP
  4715        NEXT SENTENCE                                             ERCNETP
  4716     ELSE                                                         ERCNETP
  4717        GO TO 12000-CHECK-MINN-TRUNC.                             ERCNETP
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  86
* SUNATEX.cbl (/apps/prod/cid1p/copy/ERCNETP)
  4718                                                                  ERCNETP
  4719     COMPUTE WK4 EQUAL (N - 1) * (1 + I * 2).                     ERCNETP
  4720     COMPUTE ANGLEN EQUAL WK1 / I.                                ERCNETP
  4721     COMPUTE ANGLEN-1 EQUAL WK6 / I.                              ERCNETP
  4722**** VX = 1 / (1 + I)**N.                                         ERCNETP
  4723                                                                  ERCNETP
  4724     COMPUTE WK3 EQUAL CP-ORIGINAL-BENEFIT * CP-PREMIUM-RATE      ERCNETP
  4725     / +100 * (N - 1) / 12 * 2 / N *                              ERCNETP
  4726     (WK4 - ANGLEN-1) / (I * ANGLEN-1).                           ERCNETP
  4727                                                                  ERCNETP
  4728      MOVE WK3 TO CP-CALC-PREMIUM.                                ERCNETP
  4729                                                                  ERCNETP
  4730     GO TO 99999-RETURN.                                          ERCNETP
  4731                                                                  ERCNETP
  4732 12000-CHECK-MINN-TRUNC.                                          ERCNETP
  4733                                                                  ERCNETP
  4734     IF (CP-COMPANY-ID EQUAL 'NCL') AND                           ERCNETP
  4735        (CP-STATE-STD-ABBRV EQUAL 'MN') AND                       ERCNETP
  4736        (M GREATER THAN +63) AND                                  ERCNETP
  4737        (CP-EARN-AS-NET-PAY) AND                                  ERCNETP
  4738        (CP-TRUNCATED-LIFE)                                       ERCNETP
  4739        NEXT SENTENCE                                             ERCNETP
  4740     ELSE                                                         ERCNETP
  4741        GO TO 12000-CHECK-MINN.                                   ERCNETP
  4742                                                                  ERCNETP
  4743      COMPUTE ANGLEN EQUAL WK1 / I.                               ERCNETP
  4744      COMPUTE ANGLEN-M EQUAL WK5 / I.                             ERCNETP
  4745                                                                  ERCNETP
  4746      COMPUTE ANGLEN-1 EQUAL ANGLEN * ODF.                        ERCNETP
  4747                                                                  ERCNETP
  4748      COMPUTE WK3 EQUAL (CP-ORIGINAL-BENEFIT *                    ERCNETP
  4749       (CP-PREMIUM-RATE / +100) * 2) / (ANGLEN-1 * (N + 1)) *     ERCNETP
  4750       (((M - ANGLEN + ANGLEN-M) / I) + (2 * M)).                 ERCNETP
  4751                                                                  ERCNETP
  4752      MOVE WK3 TO CP-CALC-PREMIUM.                                ERCNETP
  4753                                                                  ERCNETP
  4754     GO TO 99999-RETURN.                                          ERCNETP
  4755                                                                  ERCNETP
  4756 12000-CHECK-MINN.                                                ERCNETP
  4757                                                                  ERCNETP
  4758     IF (CP-COMPANY-ID EQUAL 'NCL') AND                           ERCNETP
  4759        (CP-STATE-STD-ABBRV EQUAL 'MN') AND                       ERCNETP
  4760        (M GREATER THAN +63) AND                                  ERCNETP
  4761        (CP-EARN-AS-NET-PAY)                                      ERCNETP
  4762        NEXT SENTENCE                                             ERCNETP
  4763     ELSE                                                         ERCNETP
  4764        GO TO 12000-CHECK-MONTANA-TRUNC.                          ERCNETP
  4765                                                                  ERCNETP
  4766      COMPUTE ANGLEN EQUAL WK1 / I.                               ERCNETP
  4767                                                                  ERCNETP
  4768      COMPUTE ANGLEN-1 EQUAL ANGLEN * ODF.                        ERCNETP
  4769                                                                  ERCNETP
  4770      COMPUTE WK3 EQUAL (CP-ORIGINAL-BENEFIT *                    ERCNETP
  4771       (CP-PREMIUM-RATE / +100) * 2) / (ANGLEN-1 * (N + 1)) *     ERCNETP
  4772       (((N - ANGLEN) / I) + (2 * N)).                            ERCNETP
  4773                                                                  ERCNETP
  4774      MOVE WK3 TO CP-CALC-PREMIUM.                                ERCNETP
  4775                                                                  ERCNETP
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  87
* SUNATEX.cbl (/apps/prod/cid1p/copy/ERCNETP)
  4776     GO TO 99999-RETURN.                                          ERCNETP
  4777                                                                  ERCNETP
  4778 12000-CHECK-MONTANA-TRUNC.                                       ERCNETP
  4779                                                                  ERCNETP
  4780     IF (CP-COMPANY-ID EQUAL 'NCL') AND                           ERCNETP
  4781        (CP-STATE-STD-ABBRV EQUAL 'MT') AND                       ERCNETP
  4782        (M GREATER THAN +63) AND                                  ERCNETP
  4783        (CP-EARN-AS-NET-PAY) AND                                  ERCNETP
  4784        (CP-TRUNCATED-LIFE)                                       ERCNETP
  4785        NEXT SENTENCE                                             ERCNETP
  4786     ELSE                                                         ERCNETP
  4787        GO TO 12000-CHECK-MONTANA.                                ERCNETP
  4788                                                                  ERCNETP
  4789      COMPUTE ANGLEN EQUAL WK1 / I.                               ERCNETP
  4790      COMPUTE ANGLEN-M EQUAL WK5 / I.                             ERCNETP
  4791                                                                  ERCNETP
  4792      COMPUTE ANGLEN-1 EQUAL ANGLEN * ODF.                        ERCNETP
  4793                                                                  ERCNETP
  4794      COMPUTE WK3 EQUAL CP-ORIGINAL-BENEFIT *                     ERCNETP
  4795      ((CP-PREMIUM-RATE / +100) * 2) / (ANGLEN-1 * (N + 1)) *     ERCNETP
  4796       (((M - ANGLEN + ANGLEN-M) / I) + (4 * M)).                 ERCNETP
  4797                                                                  ERCNETP
  4798      MOVE WK3 TO CP-CALC-PREMIUM.                                ERCNETP
  4799                                                                  ERCNETP
  4800     GO TO 99999-RETURN.                                          ERCNETP
  4801                                                                  ERCNETP
  4802 12000-CHECK-MONTANA.                                             ERCNETP
  4803                                                                  ERCNETP
  4804     IF (CP-COMPANY-ID EQUAL 'NCL') AND                           ERCNETP
  4805        (CP-STATE-STD-ABBRV EQUAL 'MT') AND                       ERCNETP
  4806        (M GREATER THAN +63) AND                                  ERCNETP
  4807        (CP-EARN-AS-NET-PAY)                                      ERCNETP
  4808        NEXT SENTENCE                                             ERCNETP
  4809     ELSE                                                         ERCNETP
  4810        GO TO 12001-CONTINUE-NCL-TRUNC.                           ERCNETP
  4811                                                                  ERCNETP
  4812      COMPUTE ANGLEN EQUAL WK1 / I.                               ERCNETP
  4813                                                                  ERCNETP
  4814      COMPUTE ANGLEN-1 EQUAL ANGLEN * ODF.                        ERCNETP
  4815                                                                  ERCNETP
  4816      COMPUTE WK3 EQUAL (CP-ORIGINAL-BENEFIT *                    ERCNETP
  4817       (CP-PREMIUM-RATE / +100) * 2) / (ANGLEN-1 * (N + 1)) *     ERCNETP
  4818       (((N - ANGLEN) / I) + (4 * N)).                            ERCNETP
  4819                                                                  ERCNETP
  4820      MOVE WK3 TO CP-CALC-PREMIUM.                                ERCNETP
  4821                                                                  ERCNETP
  4822     GO TO 99999-RETURN.                                          ERCNETP
  4823                                                                  ERCNETP
  4824 12001-CONTINUE-NCL-TRUNC.                                        ERCNETP
  4825                                                                  ERCNETP
  4826     IF (CP-COMPANY-ID EQUAL 'NCL') AND                           ERCNETP
  4827        (CP-EARN-AS-NET-PAY) AND                                  ERCNETP
  4828        (CP-TRUNCATED-LIFE)                                       ERCNETP
  4829        NEXT SENTENCE                                             ERCNETP
  4830     ELSE                                                         ERCNETP
  4831        GO TO 12001-CONTINUE-NCL.                                 ERCNETP
  4832                                                                  ERCNETP
  4833      COMPUTE ANGLEN EQUAL WK1 / I.                               ERCNETP
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  88
* SUNATEX.cbl (/apps/prod/cid1p/copy/ERCNETP)
  4834      COMPUTE ANGLEN-M EQUAL WK5 / I.                             ERCNETP
  4835                                                                  ERCNETP
  4836      COMPUTE ANGLEN-1 EQUAL ANGLEN * ODF.                        ERCNETP
  4837                                                                  ERCNETP
  4838      COMPUTE WK3 EQUAL (CP-ORIGINAL-BENEFIT * 2 *                ERCNETP
  4839      (M - (ANGLEN - ANGLEN-M)) * (CP-PREMIUM-RATE / +100)) /     ERCNETP
  4840      (ANGLEN-1 * (N + 1) * I).                                   ERCNETP
  4841                                                                  ERCNETP
  4842      MOVE WK3 TO CP-CALC-PREMIUM.                                ERCNETP
  4843                                                                  ERCNETP
  4844     GO TO 99999-RETURN.                                          ERCNETP
  4845                                                                  ERCNETP
  4846 12001-CONTINUE-NCL.                                              ERCNETP
  4847                                                                  ERCNETP
  4848     IF (CP-COMPANY-ID EQUAL 'NCL') AND                           ERCNETP
  4849        (CP-STATE-STD-ABBRV EQUAL 'NC') AND                       ERCNETP
  4850        (CP-EARN-AS-NET-PAY)                                      ERCNETP
  4851        GO TO 12001-CHECK-NC-NET-PLUS3.                           ERCNETP
  4852                                                                  ERCNETP
  4853     IF (CP-COMPANY-ID EQUAL 'NCL') AND                           ERCNETP
  4854        (CP-STATE-STD-ABBRV EQUAL 'CA') AND                       ERCNETP
  4855        (CP-EARN-AS-NET-PAY)                                      ERCNETP
  4856        GO TO 12001-CHECK-CA.                                     ERCNETP
  4857                                                                  ERCNETP
  4858     IF (CP-COMPANY-ID EQUAL 'NCL') AND                           ERCNETP
  4859        (CP-EARN-AS-NET-PAY)                                      ERCNETP
  4860        NEXT SENTENCE                                             ERCNETP
  4861     ELSE                                                         ERCNETP
  4862        GO TO 12000-CONTINUE-NET.                                 ERCNETP
  4863                                                                  ERCNETP
  4864      COMPUTE ANGLEN EQUAL WK1 / I.                               ERCNETP
  4865      MOVE ANGLEN                TO ANGLEN-1.                     ERCNETP
  4866                                                                  ERCNETP
  4867      COMPUTE ANGLEN-1 EQUAL ANGLEN * ODF.                        ERCNETP
  4868                                                                  ERCNETP
  4869      COMPUTE WK3 EQUAL (CP-ORIGINAL-BENEFIT *                    ERCNETP
  4870       (CP-PREMIUM-RATE / +100) * 2) / (ANGLEN-1 * (N + 1)) *     ERCNETP
  4871       ((N - ANGLEN) / I).                                        ERCNETP
  4872                                                                  ERCNETP
  4873      MOVE WK3 TO CP-CALC-PREMIUM.                                ERCNETP
  4874                                                                  ERCNETP
  4875     GO TO 99999-RETURN.                                          ERCNETP
  4876                                                                  ERCNETP
  4877 12000-CONTINUE-NET.                                              ERCNETP
  4878                                                                  ERCNETP
  4879     IF (CP-COMPANY-ID EQUAL 'TMS') AND                           ERCNETP
  4880        (CP-STATE-STD-ABBRV EQUAL 'MN' OR 'CA' OR 'WA') AND       ERCNETP
  4881        (CP-EARN-AS-NET-PAY)                                      ERCNETP
  4882        NEXT SENTENCE                                             ERCNETP
  4883     ELSE                                                         ERCNETP
  4884        GO TO 12001-CONTINUE-MINN.                                ERCNETP
  4885                                                                  ERCNETP
  4886      COMPUTE ANGLEN EQUAL WK6 / I.                               ERCNETP
  4887      COMPUTE ODF EQUAL 1 + (12 * CP-TERM-OR-EXT-DAYS / +365).    ERCNETP
  4888                                                                  ERCNETP
  4889      COMPUTE WK7 EQUAL (1 + ODF * I) / (1 + ANGLEN).             ERCNETP
  4890      COMPUTE WK3 EQUAL (M  * WK7) - 1.                           ERCNETP
  4891      COMPUTE WK3 EQUAL (WK3 / I) *                               ERCNETP
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  89
* SUNATEX.cbl (/apps/prod/cid1p/copy/ERCNETP)
  4892       ((M * (CP-PREMIUM-RATE / +100)) / (+6 * (M + 1))).         ERCNETP
  4893                                                                  ERCNETP
  4894      IF CP-R-MAX-TOT-BEN NOT NUMERIC                             ERCNETP
  4895         MOVE +0 TO CP-R-MAX-TOT-BEN.                             ERCNETP
  4896                                                                  ERCNETP
  4897      COMPUTE WK3 EQUAL (WK3 * CP-ORIGINAL-BENEFIT)               ERCNETP
  4898                                                                  ERCNETP
  4899      IF (CP-ORIGINAL-BENEFIT GREATER THAN CP-R-MAX-TOT-BEN) AND  ERCNETP
  4900         (CP-R-MAX-TOT-BEN NOT EQUAL +0)                          ERCNETP
  4901         COMPUTE WK3 EQUAL (WK3 * CP-R-MAX-TOT-BEN).              ERCNETP
  4902                                                                  ERCNETP
  4903      MOVE WK3 TO CP-CALC-PREMIUM.                                ERCNETP
  4904                                                                  ERCNETP
  4905     GO TO 99999-RETURN.                                          ERCNETP
  4906                                                                  ERCNETP
  4907 12001-CONTINUE-MINN.                                             ERCNETP
  4908                                                                  ERCNETP
  4909     IF (CP-COMPANY-ID EQUAL 'GTL') AND                           ERCNETP
  4910        (CP-STATE-STD-ABBRV EQUAL 'NJ') AND                       ERCNETP
  4911        (CP-TRUNCATED-LIFE)                                       ERCNETP
  4912        NEXT SENTENCE                                             ERCNETP
  4913     ELSE                                                         ERCNETP
  4914        GO TO 12001-CHECK-RI-GTL.                                 ERCNETP
  4915                                                                  ERCNETP
  4916      COMPUTE ANGLEN EQUAL WK1 / I.                               ERCNETP
  4917      COMPUTE ANGLEM EQUAL WK2 / I.                               ERCNETP
  4918                                                                  ERCNETP
  4919      COMPUTE WK3 EQUAL ((M - ANGLEM * SX) /                      ERCNETP
  4920       (I * ANGLEN) * CP-PREMIUM-RATE / (1 + WS-WORK-DIS-RATE     ERCNETP
  4921       * M / 2400) * 1000 + .5) / 1000000.                        ERCNETP
  4922                                                                  ERCNETP
  4923      COMPUTE CP-CALC-PREMIUM EQUAL WK3 * (CP-ORIGINAL-BENEFIT    ERCNETP
  4924       - CP-ORIGINAL-PREMIUM) / (1 - WK3).                        ERCNETP
  4925                                                                  ERCNETP
  4926     GO TO 99999-RETURN.                                          ERCNETP
  4927                                                                  ERCNETP
  4928 12001-CHECK-RI-GTL.                                              ERCNETP
  4929                                                                  ERCNETP
  4930     IF (CP-COMPANY-ID EQUAL 'GTL' ) AND                          ERCNETP
  4931        (CP-STATE-STD-ABBRV EQUAL 'RI') AND                       ERCNETP
  4932        (CP-EARN-AS-NET-PAY)                                      ERCNETP
  4933        NEXT SENTENCE                                             ERCNETP
  4934     ELSE                                                         ERCNETP
  4935        GO TO 12001-CHECK-RI-LEASE-GTL.                           ERCNETP
  4936                                                                  ERCNETP
  4937      COMPUTE ANGLEN EQUAL WK1 / I.                               ERCNETP
  4938*     COMPUTE ANGLEM EQUAL WK2 / I.                               ERCNETP
  4939                                                                  ERCNETP
  4940      COMPUTE WK3 EQUAL (1000 * I * ANGLEN) *                     ERCNETP
  4941               (1 + WS-WORK-DIS-RATE * N).                        ERCNETP
  4942      COMPUTE CP-CALC-PREMIUM EQUAL CP-ORIGINAL-BENEFIT *         ERCNETP
  4943         ((N - ANGLEN) * (1 + 2 * I) * CP-PREMIUM-RATE) / WK3.    ERCNETP
  4944                                                                  ERCNETP
  4945                                                                  ERCNETP
  4946     GO TO 99999-RETURN.                                          ERCNETP
  4947                                                                  ERCNETP
  4948 12001-CHECK-RI-LEASE-GTL.                                        ERCNETP
  4949                                                                  ERCNETP
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  90
* SUNATEX.cbl (/apps/prod/cid1p/copy/ERCNETP)
  4950     IF (CP-COMPANY-ID EQUAL 'GTL' ) AND                          ERCNETP
  4951        (CP-STATE-STD-ABBRV EQUAL 'RI') AND                       ERCNETP
  4952        (CP-SPECIAL-CALC-CD EQUAL 'H')                            ERCNETP
  4953        NEXT SENTENCE                                             ERCNETP
  4954     ELSE                                                         ERCNETP
  4955        GO TO 12001-CHECK-OR-GTL.                                 ERCNETP
  4956                                                                  ERCNETP
  4957     COMPUTE ANGLEN EQUAL WK1 / I.                                ERCNETP
  4958                                                                  ERCNETP
  4959     COMPUTE WK3 EQUAL (CP-ORIGINAL-BENEFIT / ANGLEN *            ERCNETP
  4960        (N - ANGLEN) * CP-PREMIUM-RATE * (1 + 2 * I))             ERCNETP
  4961                        /                                         ERCNETP
  4962        (1000 * I * (1 + .0021 * N)).                             ERCNETP
  4963     COMPUTE CP-CALC-PREMIUM EQUAL WK3 +                          ERCNETP
  4964       (CP-ALTERNATE-BENEFIT * CP-PREMIUM-RATE * (N + 1))         ERCNETP
  4965                            /                                     ERCNETP
  4966       (1000 * (1 + .0027 * (N + 1))).                            ERCNETP
  4967                                                                  ERCNETP
  4968     GO TO 99999-RETURN.                                          ERCNETP
  4969                                                                  ERCNETP
  4970 12001-CHECK-OR-GTL.                                              ERCNETP
  4971                                                                  ERCNETP
  4972     IF (CP-COMPANY-ID EQUAL 'GTL' ) AND                          ERCNETP
  4973        (CP-STATE-STD-ABBRV EQUAL 'OR') AND                       ERCNETP
  4974        (CP-EARN-AS-NET-PAY)                                      ERCNETP
  4975        NEXT SENTENCE                                             ERCNETP
  4976     ELSE                                                         ERCNETP
  4977        GO TO 12001-CHECK-GA-GTL.                                 ERCNETP
  4978                                                                  ERCNETP
  4979     COMPUTE ANGLEN-M EQUAL WK5 / I.                              ERCNETP
  4980     COMPUTE ANGLEN EQUAL WK1 / I.                                ERCNETP
  4981                                                                  ERCNETP
  4982     IF M LESS THAN +64                                           ERCNETP
  4983        COMPUTE WK3 EQUAL (((N - (N - M)) - (ANGLEN - ANGLEN-M)) *ERCNETP
  4984         (1 + I) * CP-PREMIUM-RATE * (N - (N - M)))               ERCNETP
  4985                   /                                              ERCNETP
  4986         (I * ANGLEN * (N - (N - M) + 1) * 600)                   ERCNETP
  4987        COMPUTE CP-CALC-PREMIUM EQUAL WK3 * CP-ORIGINAL-BENEFIT   ERCNETP
  4988     ELSE                                                         ERCNETP
  4989        COMPUTE WK3 EQUAL (((N - (N - M)) - (ANGLEN - ANGLEN-M)) *ERCNETP
  4990        CP-PREMIUM-RATE * (1 + I))                                ERCNETP
  4991                  /                                               ERCNETP
  4992        (+1000 * I * ANGLEN)                                      ERCNETP
  4993        COMPUTE CP-CALC-PREMIUM EQUAL WK3 * CP-ORIGINAL-BENEFIT.  ERCNETP
  4994*    MOVE WK3 TO CP-CALC-PREMIUM.                                 ERCNETP
  4995     GO TO 99999-RETURN.                                          ERCNETP
  4996                                                                  ERCNETP
  4997 12001-CHECK-GA-GTL.                                              ERCNETP
  4998                                                                  ERCNETP
  4999     IF (CP-COMPANY-ID EQUAL 'GTL') AND                           ERCNETP
  5000        (CP-STATE-STD-ABBRV EQUAL 'GA') AND                       ERCNETP
  5001        (CP-EARN-AS-NET-PAY)                                      ERCNETP
  5002*       (CP-TRUNCATED-LIFE)                                       ERCNETP
  5003        NEXT SENTENCE                                             ERCNETP
  5004     ELSE                                                         ERCNETP
  5005        GO TO 12001-CHECK-MA-GTL.                                 ERCNETP
  5006                                                                  ERCNETP
  5007     COMPUTE ANGLEN-M EQUAL WK5 / I.                              ERCNETP
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  91
* SUNATEX.cbl (/apps/prod/cid1p/copy/ERCNETP)
  5008     COMPUTE ANGLEN EQUAL WK1 / I.                                ERCNETP
  5009                                                                  ERCNETP
  5010     COMPUTE WK3 EQUAL CP-ORIGINAL-BENEFIT / ANGLEN.              ERCNETP
  5011     COMPUTE WK3 EQUAL (CP-PREMIUM-RATE / +1000) * WK3 *          ERCNETP
  5012      ((N - (ANGLEN - ANGLEN-M)) / I) * (1 + 2 * I).              ERCNETP
  5013     MOVE WK3 TO CP-CALC-PREMIUM.                                 ERCNETP
  5014                                                                  ERCNETP
  5015     GO TO 99999-RETURN.                                          ERCNETP
  5016                                                                  ERCNETP
  5017 12001-CHECK-MA-GTL.                                              ERCNETP
  5018                                                                  ERCNETP
  5019     IF (CP-COMPANY-ID EQUAL 'GTL') AND                           ERCNETP
  5020        (CP-STATE-STD-ABBRV EQUAL 'MA') AND                       ERCNETP
  5021        (CP-EARN-AS-NET-PAY) AND                                  ERCNETP
  5022        (CP-SPECIAL-CALC-CD EQUAL 'H')                            ERCNETP
  5023        NEXT SENTENCE                                             ERCNETP
  5024     ELSE                                                         ERCNETP
  5025        GO TO 12001-CHECK-NV-NET.                                 ERCNETP
  5026                                                                  ERCNETP
  5027     COMPUTE ANGLEN EQUAL WK1 / I.                                ERCNETP
  5028                                                                  ERCNETP
  5029     COMPUTE WK3 EQUAL (CP-PREMIUM-RATE / +1000) *                ERCNETP
  5030      CP-ALTERNATE-BENEFIT * N.                                   ERCNETP
  5031                                                                  ERCNETP
  5032     COMPUTE WK7 EQUAL (CP-ORIGINAL-BENEFIT + WK3) /              ERCNETP
  5033     (ANGLEN - (CP-PREMIUM-RATE / +1000) * (N - ANGLEN) / I).     ERCNETP
  5034                                                                  ERCNETP
  5035     COMPUTE WK3 EQUAL WK3 + (CP-PREMIUM-RATE / +1000) *          ERCNETP
  5036     WK7 * (N - ANGLEN) / I.                                      ERCNETP
  5037     MOVE WK3 TO CP-CALC-PREMIUM.                                 ERCNETP
  5038                                                                  ERCNETP
  5039     GO TO 99999-RETURN.                                          ERCNETP
  5040                                                                  ERCNETP
  5041 12001-CHECK-NV-NET.                                              ERCNETP
  5042
  5043     IF (CP-COMPANY-ID EQUAL 'CID')
  5044        AND (CP-STATE-STD-ABBRV = 'NV' OR 'WA')
  5045        AND (CP-EARN-AS-NET-PAY)
  5046        CONTINUE
  5047     ELSE
  5048        GO TO 12001-CHECK-MN-NET
  5049     END-IF
  5050
  5051     COMPUTE ANGLEN = (1 - (1 / (1 + I)) ** N) / I
  5052     COMPUTE ANGLEN-M = (1 - (1 / (1 + I)) ** (N - M)) / I
  5053
  5054     COMPUTE WK8 = (1 + ((CP-TERM-OR-EXT-DAYS + +30) * I) / +30)
  5055                   / (1 + I)
  5056
  5057     COMPUTE ANGLEN-1 = ANGLEN / WK8
  5058
  5059     COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN-1
  5060
  5061     COMPUTE WK3 = WK4 * ((M - (ANGLEN - ANGLEN-M)) / I) *
  5062        (CP-PREMIUM-RATE * K-I / 1000)
  5063
  5064     MOVE WK3                    TO CP-CALC-PREMIUM
  5065
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  92
* SUNATEX.cbl (/apps/prod/cid1p/copy/ERCNETP)
  5066     GO TO 99999-RETURN
  5067
  5068      .
  5069 12001-CHECK-MN-NET.
  5070
  5071     IF (CP-COMPANY-ID EQUAL 'CID')
  5072        AND (CP-STATE-STD-ABBRV = 'MN')
  5073        AND (CP-EARN-AS-NET-PAY)
  5074        AND (NOT CP-LEVEL-LIFE)
  5075        AND (WS-DISCOUNT-OPTION = '1')
  5076        CONTINUE
  5077     ELSE
  5078        GO TO 12001-CHECK-NC-NET
  5079     END-IF
  5080
  5081     if i = .0000000001
  5082        compute wk4 = cp-original-benefit / n
  5083        compute wk3 = wk4 * ((n * (n + 1) / 2) - ((n - m) *
  5084           (n - m + 1) / 2))*(cp-premium-rate / 1000)
  5085        move wk3 to cp-calc-premium
  5086        go to 99999-return
  5087     end-if
  5088
  5089     COMPUTE ANGLEN = (1 - (1 / (1 + I)) ** N) / I
  5090     COMPUTE ANGLEN-M = (1 - (1 / (1 + I)) ** (N - M)) / I
  5091
  5092     COMPUTE WK8 = (1 + ((CP-TERM-OR-EXT-DAYS + +30) * I) / +30)
  5093                   / (1 + I)
  5094
  5095     COMPUTE ANGLEN-1 = ANGLEN / WK8
  5096
  5097     COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN-1
  5098
  5099     COMPUTE WK3 = WK4 * ((M - (ANGLEN - ANGLEN-M)) / I) *
  5100        (CP-PREMIUM-RATE / 1000) * (1 + I)
  5101
  5102     MOVE WK3                    TO CP-CALC-PREMIUM
  5103
  5104     GO TO 99999-RETURN
  5105
  5106      .
  5107 12001-CHECK-NC-NET.                                              ERCNETP
  5108                                                                  ERCNETP
  5109     IF (CP-COMPANY-ID EQUAL 'NCB' ) AND                          ERCNETP
  5110        (CP-STATE-STD-ABBRV EQUAL 'NC') AND                       ERCNETP
  5111        (CP-EARN-AS-NET-PAY)                                      ERCNETP
  5112        NEXT SENTENCE                                             ERCNETP
  5113     ELSE                                                         ERCNETP
  5114        GO TO 12001-CHECK-NC-NET-PLUS3.                           ERCNETP
  5115                                                                  ERCNETP
  5116      COMPUTE ANGLEN EQUAL WK1 / I.                               ERCNETP
  5117      COMPUTE ANGLEN-M EQUAL WK5 / I.                             ERCNETP
  5118                                                                  ERCNETP
  5119      COMPUTE WK6 ROUNDED = CP-ORIGINAL-BENEFIT /                 ERCNETP
  5120          (ANGLEN - (CP-PREMIUM-RATE / 1000) *                    ERCNETP
  5121          ((N - (ANGLEN - ANGLEN-M)) / I + 3 * N) -               ERCNETP
  5122          N * (CP-PREMIUM-RATE / 1000)).                          ERCNETP
  5123                                                                  ERCNETP
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  93
* SUNATEX.cbl (/apps/prod/cid1p/copy/ERCNETP)
  5124      COMPUTE WK3 ROUNDED = (CP-PREMIUM-RATE / 1000) * WK6 *      ERCNETP
  5125          ((N - (ANGLEN - ANGLEN-M)) / I + 3 * N).                ERCNETP
  5126                                                                  ERCNETP
  5127      COMPUTE WK7 ROUNDED = (1 - (CP-PREMIUM-RATE / 1000) *       ERCNETP
  5128          ((N - ANGLEN) / I + 3) / ANGLEN) /                      ERCNETP
  5129          (1 - (CP-PREMIUM-RATE / 1000) * N * (N + 1) /           ERCNETP
  5130          (ANGLEN * 2))                                           ERCNETP
  5131                                                                  ERCNETP
  5132      COMPUTE WK7 ROUNDED = WK7 * N - 3.                          ERCNETP
  5133                                                                  ERCNETP
  5134      IF ANGLEN IS NOT LESS THAN WK7                              ERCNETP
  5135          COMPUTE CP-PREMIUM-RATE ROUNDED =                       ERCNETP
  5136              (CP-PREMIUM-RATE / 1000) * +6.5 * (N / 12)          ERCNETP
  5137          COMPUTE WK3 ROUNDED =                                   ERCNETP
  5138              (CP-ORIGINAL-BENEFIT * CP-PREMIUM-RATE).            ERCNETP
  5139                                                                  ERCNETP
  5140     MOVE WK3 TO CP-CALC-PREMIUM.                                 ERCNETP
  5141                                                                  ERCNETP
  5142     GO TO 99999-RETURN.                                          ERCNETP
  5143                                                                  ERCNETP
  5144 12001-CHECK-NC-NET-PLUS3.                                        ERCNETP
  5145                                                                  ERCNETP
  5146     IF (CP-STATE-STD-ABBRV EQUAL 'NC') AND                          ERCNE
  5147        (CP-EARN-AS-NET-PAY) AND                                     ERCNE
  5148        (CP-COMPANY-ID NOT = 'CID' AND 'DCC' AND 'AHL')
  5149        NEXT SENTENCE                                                ERCNE
  5150     ELSE                                                            ERCNE
  5151        GO TO 12001-CHECK-CA.                                        ERCNE
  5152                                                                  ERCNETP
  5153     MOVE CP-CERT-EFF-DT TO DC-BIN-DATE-1.                        ERCNETP
  5154     MOVE ' ' TO DC-OPTION-CODE.                                  ERCNETP
  5155     PERFORM 9100-CONVERT-DATE THRU 9100-EXIT.                    ERCNETP
  5156                                                                  ERCNETP
  5157     IF DATE-CONVERSION-ERROR                                     ERCNETP
  5158        MOVE '2'                 TO CP-RETURN-CODE                ERCNETP
  5159        MOVE ZEROS               TO FACTOR                        ERCNETP
  5160                                    CP-CALC-PREMIUM               ERCNETP
  5161         GO TO 99999-RETURN.                                      ERCNETP
  5162                                                                  ERCNETP
  5163     IF DC-GREG-DATE-CYMD GREATER THAN 19931231                      CL**4
  5164        NEXT SENTENCE                                             ERCNETP
  5165     ELSE                                                         ERCNETP
  5166        GO TO 12001-CONTINUE-NET.                                 ERCNETP
  5167                                                                  ERCNETP
  5168     COMPUTE ANGLEN EQUAL WK1 / I.                                ERCNETP
  5169     COMPUTE ANGLEN-M EQUAL WK5 / I.                              ERCNETP
  5170                                                                  ERCNETP
  5171     COMPUTE NC-LR = CP-PREMIUM-RATE / ( ORIGINAL-TERM / 12).     ERCNETP
  5172                                                                  ERCNETP
  5173     COMPUTE NC-R = 20 *                                          ERCNETP
  5174                    ((NC-LR * ORIGINAL-TERM) / 12)                ERCNETP
  5175                          / (ORIGINAL-TERM + 1).                  ERCNETP
  5176                                                                  ERCNETP
  5177     COMPUTE NC-OB = NC-R / 1000.                                 ERCNETP
  5178                                                                  ERCNETP
  5179     COMPUTE NC-P = (((ORIGINAL-TERM - ANGLEN) / I) * NC-OB) +    ERCNETP
  5180                    (NC-OB * ORIGINAL-TERM * 3).                  ERCNETP
  5181                                                                  ERCNETP
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  94
* SUNATEX.cbl (/apps/prod/cid1p/copy/ERCNETP)
  5182     IF CP-EXT-CHG-LF                                             ERCNETP
  5183         COMPUTE NC-BIG-D = CP-TERM-OR-EXT-DAYS + 30              ERCNETP
  5184     ELSE                                                         ERCNETP
  5185         MOVE 30                 TO  NC-BIG-D.                    ERCNETP
  5186                                                                  ERCNETP
  5187     COMPUTE NC-LITTLE-D = (1 + I) /                              ERCNETP
  5188             ((( 1 + ((NC-BIG-D / 30.4166666)) * I))).            ERCNETP
  5189                                                                  ERCNETP
  5190     COMPUTE NC-MP ROUNDED = CP-ORIGINAL-BENEFIT  /               ERCNETP
  5191             (ANGLEN * NC-LITTLE-D ).                             ERCNETP
  5192                                                                  ERCNETP
  5193     COMPUTE CP-CALC-PREMIUM ROUNDED = NC-MP * NC-P.              ERCNETP
  5194                                                                  ERCNETP
  5195     GO TO 99999-RETURN.                                          ERCNETP
  5196                                                                  ERCNETP
  5197 12001-CHECK-CA.                                                  ERCNETP
  5198                                                                  ERCNETP
  5199     IF (CP-STATE-STD-ABBRV EQUAL 'CA') AND                       ERCNETP
  5200        (WS-DISCOUNT-OPTION = '6')                                ERCNETP
  5201        NEXT SENTENCE                                             ERCNETP
  5202     ELSE                                                         ERCNETP
  5203        GO TO 12001-CHECK-GTL-IA.                                 ERCNETP
  5204                                                                  ERCNETP
  5205     COMPUTE CA-J = CA-DISCOUNT / 12.                             ERCNETP
  5206     COMPUTE ANGLEN EQUAL WK1 / I.                                ERCNETP
  5207     COMPUTE CA-MP = CP-ORIGINAL-BENEFIT  / ANGLEN.               ERCNETP
  5208     COMPUTE CA-API = (1 - (1 + I)** - ORIGINAL-TERM) / I.        ERCNETP
  5209     COMPUTE CA-APJ = (1 - (1 + CA-J)** - ORIGINAL-TERM) / CA-J.  ERCNETP
  5210     COMPUTE CA-VI = (1 + I)** -1.                                ERCNETP
  5211     COMPUTE CP-CALC-PREMIUM =                                    ERCNETP
  5212         ((CP-PREMIUM-RATE * 2) / (100 * (ORIGINAL-TERM + 1)) *   ERCNETP
  5213         ((1 + CA-J) / I) *                                       ERCNETP
  5214         (CA-APJ + (CA-J * CA-APJ - I * CA-API) *                 ERCNETP
  5215         ((CA-VI ** (LOAN-TERM - ORIGINAL-TERM)) /                ERCNETP
  5216         (I - CA-J))) * (1 + CP-ODD-DAYS-TO-PMT * I) * CA-MP).    ERCNETP
  5217                                                                  ERCNETP
  5218     GO TO 99999-RETURN.                                          ERCNETP
  5219                                                                  ERCNETP
  5220 12001-CHECK-GTL-IA.                                              ERCNETP
  5221                                                                  ERCNETP
  5222     IF (CP-COMPANY-ID EQUAL 'GTL')     AND                       ERCNETP
  5223        (CP-STATE-STD-ABBRV EQUAL 'IA') AND                       ERCNETP
  5224        (CP-EARN-AS-NET-PAY)                                      ERCNETP
  5225        NEXT SENTENCE                                             ERCNETP
  5226     ELSE                                                         ERCNETP
  5227        GO TO 12001-CHECK-CID-TRN-VA.                             ERCNETP
  5228                                                                  ERCNETP
  5229***************************************************************   ERCNETP
  5230                                                                  ERCNETP
  5231     COMPUTE GTL-IA-ODD-DAYS = CP-ODD-DAYS-TO-PMT - 30.           ERCNETP
  5232                                                                  ERCNETP
  5233     IF GTL-IA-ODD-DAYS = ZEROS                                   ERCNETP
  5234         MOVE ZERO               TO  GTL-IA-SGN                   ERCNETP
  5235     ELSE                                                         ERCNETP
  5236         IF GTL-IA-ODD-DAYS GREATER THAN ZERO                     ERCNETP
  5237             MOVE +1             TO  GTL-IA-SGN                   ERCNETP
  5238         ELSE                                                     ERCNETP
  5239             MOVE -1             TO  GTL-IA-SGN.                  ERCNETP
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  95
* SUNATEX.cbl (/apps/prod/cid1p/copy/ERCNETP)
  5240                                                                  ERCNETP
  5241     MOVE GTL-IA-ODD-DAYS        TO  GTL-IA-ABS.                  ERCNETP
  5242     COMPUTE GTL-IA-ABS = GTL-IA-ABS - 30.                        ERCNETP
  5243                                                                  ERCNETP
  5244     COMPUTE GTL-IA-ODF = (1 + I * GTL-IA-ABS / 30) **            ERCNETP
  5245                          GTL-IA-SGN.                             ERCNETP
  5246                                                                  ERCNETP
  5247     COMPUTE ANGLEN EQUAL WK1 / I.                                ERCNETP
  5248     COMPUTE ANGLEN-M EQUAL WK5 / I.                                 CL**3
  5249                                                                  ERCNETP
  5250     IF GTL-IA-ODF NOT = ZERO                                     ERCNETP
  5251         COMPUTE ANGLEN EQUAL ANGLEN / GTL-IA-ODF                    CL**3
  5252         COMPUTE ANGLEN-M EQUAL ANGLEN-M / GTL-IA-ODF.               CL**3
  5253                                                                  ERCNETP
  5254     COMPUTE GTL-IA-DIVIDEND =                                       CL**3
  5255           (((N-P-LOAN - (N-P-LOAN - N-P-ORIG)) -                    CL**3
  5256                             (ANGLEN - ANGLEN-M))) *                 CL**3
  5257           ((K1 + I) * CP-PREMIUM-RATE *                             CL**3
  5258                     (N-P-LOAN - (N-P-LOAN - N-P-ORIG))).            CL**3
  5259                                                                     CL**3
  5260     COMPUTE GTL-IA-DIVISOR =                                     ERCNETP
  5261      I * ANGLEN * (N-P-LOAN - (N-P-LOAN - N-P-ORIG) + 1) * +600.    CL**3
  5262                                                                     CL**3
  5263     COMPUTE GTL-IA-FACTOR = GTL-IA-DIVIDEND / GTL-IA-DIVISOR.    ERCNETP
  5264                                                                     CL**3
  5265     COMPUTE CP-CALC-PREMIUM =                                    ERCNETP
  5266                           GTL-IA-FACTOR * CP-ORIGINAL-BENEFIT.   ERCNETP
  5267     GO TO 99999-RETURN.                                          ERCNETP
  5268                                                                  ERCNETP
  5269                                                                  ERCNETP
  5270 12001-CHECK-CID-TRN-VA.                                          ERCNETP
  5271                                                                  ERCNETP
  5272     IF (CP-COMPANY-ID EQUAL 'CID')     AND                       ERCNETP
  5273        (CP-STATE-STD-ABBRV EQUAL 'VA') AND                       ERCNETP
  5274        (CP-EARN-AS-NET-PAY) AND                                  ERCNETP
  5275        (CP-TRUNCATED-LIFE) AND
  5276        (CP-STATE-STD-ABBRV = CP-STATE)
  5277        CONTINUE                                                  ERCNETP
  5278     ELSE                                                         ERCNETP
  5279        GO TO 12001-CHECK-CID-TX
  5280     END-IF
  5281
  5282     COMPUTE ANGLEN EQUAL WK1 / I                                 ERCNETP
  5283     COMPUTE WS-WORK-DIS-RATE = WS-WORK-DIS-RATE / +12
  5284     IF WS-WORK-DIS-RATE = ZEROS
  5285        CONTINUE
  5286     ELSE
  5287        COMPUTE WK4 = 1 / (1 + WS-WORK-DIS-RATE)
  5288        COMPUTE WK7 = (1 / I) *
  5289              (((WK4 ** M - 1) / (WK4 - 1)) -
  5290              ((WK4 ** M * SX - VX) /
  5291              (WK4 * (1 + I) - 1))) *
  5292              (CP-PREMIUM-RATE / 1000)
  5293        COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN
  5294        COMPUTE WK8 = WK7 * 100 / ANGLEN
  5295        COMPUTE CP-CALC-PREMIUM =
  5296           WK8 *  ((WK4 * ANGLEN) / 100)
  5297     END-IF
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  96
* SUNATEX.cbl (/apps/prod/cid1p/copy/ERCNETP)
  5298
  5299     GO TO 99999-RETURN                                           ERCNETP
  5300
  5301     .                                                            ERCNETP
  5302                                                                  ERCNETP
  5303 12001-CHECK-CID-TX.
  5304
  5305     IF (CP-COMPANY-ID EQUAL 'CID')     AND
  5306        (CP-STATE-STD-ABBRV EQUAL 'TX') AND
  5307        (CP-EARN-AS-NET-PAY) AND
  5308        (WS-WORK-DIS-RATE > ZEROS) AND
  5309        (CP-STATE-STD-ABBRV = CP-STATE)
  5310        CONTINUE
  5311     ELSE
  5312        GO TO 12001-CHECK-CID-LEV-MN-NEW
  5313     END-IF
  5314* THE FOLLOWING STMT FORCES ONE MONTH EXTRA INT PERIOD
  5315     COMPUTE K-I = 1 + (1 * I)
  5316     COMPUTE ANGLEN EQUAL WK1 / I
  5317     COMPUTE ANGLEM EQUAL WK2 / I
  5318     COMPUTE WS-WORK-DIS-RATE = WS-WORK-DIS-RATE / +12
  5319     IF WS-WORK-DIS-RATE = ZEROS
  5320        CONTINUE
  5321     ELSE
  5322        COMPUTE WK4 = 1 / (1 + WS-WORK-DIS-RATE)
  5323        COMPUTE WK7 = (K-I / I) *
  5324              (((WK4 ** M - 1) / (WK4 - 1)) -
  5325*             ((WK4 ** M * SX - VX) /
  5326              ((WK4 ** M * SX) - VX) /
  5327*             (WK4 * (1 + I) - 1))) *
  5328              (WK4 * (1 + I) - 1)) *
  5329              (CP-PREMIUM-RATE / 1000)
  5330        COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN
  5331        COMPUTE WK8 = (WK7 * 100) / (ANGLEN * K-I)
  5332        COMPUTE CP-CALC-PREMIUM =
  5333           WK8 *  ((WK4 * ANGLEN * K-I) / 100)
  5334     END-IF
  5335
  5336     GO TO 99999-RETURN
  5337
  5338     .
  5339 12001-CHECK-CID-LEV-MN-NEW.
  5340
  5341*    IF (CP-COMPANY-ID EQUAL 'CID')
  5342*       AND (CP-STATE-STD-ABBRV = 'MN')
  5343*       AND (CP-EARN-AS-NET-PAY)
  5344*       AND (CP-LEVEL-LIFE)
  5345*       AND (CP-CERT-EFF-DT > X'A4FF')
  5346*       CONTINUE
  5347*    ELSE
  5348*       GO TO 12001-CHECK-CID-LEV-MN
  5349*    END-IF
  5350*
  5351*    MOVE CP-CERT-EFF-DT         TO DC-BIN-DATE-1
  5352*    MOVE CP-EXPIRE-DT           TO DC-BIN-DATE-2
  5353*    MOVE '1'                    TO DC-OPTION-CODE
  5354*    PERFORM 9100-CONVERT-DATE THRU 9100-EXIT
  5355*
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  97
* SUNATEX.cbl (/apps/prod/cid1p/copy/ERCNETP)
  5356*    IF DATE-CONVERSION-ERROR
  5357*       MOVE '2'                 TO CP-RETURN-CODE
  5358*       MOVE ZEROS               TO FACTOR
  5359*                                   CP-CALC-PREMIUM
  5360*       GO TO 99999-RETURN
  5361*    END-IF
  5362*
  5363*    COMPUTE I = CP-LOAN-APR / 100
  5364*    COMPUTE D = DC-ELAPSED-DAYS + CP-TERM-OR-EXT-DAYS
  5365*
  5366*    COMPUTE WK3 = (CP-ORIGINAL-BENEFIT - CP-ORIGINAL-PREMIUM) /
  5367*      (1 / (1 + (I * D / 360)) - CP-PREMIUM-RATE / 1000
  5368*      * 12 / 360 * D)
  5369*
  5370*    COMPUTE CP-CALC-PREMIUM = WK3 * CP-PREMIUM-RATE / 1000
  5371*       * 12 / 360 * D
  5372*
  5373*    GO TO 99999-RETURN
  5374
  5375      .
  5376 12001-CHECK-CID-LEV-MN.                                          ERCNETP
  5377                                                                  ERCNETP
  5378     IF (CP-COMPANY-ID EQUAL 'CID')     AND                       ERCNETP
  5379        (CP-STATE-STD-ABBRV EQUAL 'MN') AND                       ERCNETP
  5380        (CP-EARN-AS-NET-PAY) AND                                  ERCNETP
  5381        (CP-LEVEL-LIFE) AND
  5382        (CP-STATE-STD-ABBRV = CP-STATE)
  5383        CONTINUE                                                  ERCNETP
  5384     ELSE                                                         ERCNETP
  5385        GO TO 12001-CHECK-CID-LEV-CA                              ERCNETP
  5386     END-IF
  5387
  5388     COMPUTE CP-CALC-PREMIUM = (CP-ORIGINAL-BENEFIT *
  5389         (N / +12) * (CP-PREMIUM-RATE / +100)) /
  5390         (1 - (N / +12) * (CP-PREMIUM-RATE / 100))
  5391
  5392     GO TO 99999-RETURN                                           ERCNETP
  5393
  5394      .
  5395 12001-CHECK-CID-LEV-CA.                                          ERCNETP
  5396                                                                  ERCNETP
  5397     IF (CP-COMPANY-ID EQUAL 'CID')     AND                       ERCNETP
  5398        (CP-STATE-STD-ABBRV EQUAL 'CA') AND                       ERCNETP
  5399        (CP-EARN-AS-NET-PAY) AND                                  ERCNETP
  5400        (CP-LEVEL-LIFE) AND
  5401        (CP-STATE-STD-ABBRV = CP-STATE)
  5402        CONTINUE                                                  ERCNETP
  5403     ELSE                                                         ERCNETP
  5404        GO TO 12001-CHECK-CID-TRN-CA                              ERCNETP
  5405     END-IF
  5406
  5407     COMPUTE WK4 = WS-WORK-DIS-RATE / 12
  5408     COMPUTE WK7 = (1 / (1 + WK4)) ** N
  5409     COMPUTE WK8 = (1 / (1 + WK4)) ** (N - 1)
  5410     COMPUTE ANGLEN-1 = (1 - WK8) / WK4
  5411     COMPUTE CP-CALC-PREMIUM =
  5412          (CP-ORIGINAL-BENEFIT * (1 + ANGLEN-1) *
  5413          (CP-PREMIUM-RATE / 1000)) /
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  98
* SUNATEX.cbl (/apps/prod/cid1p/copy/ERCNETP)
  5414          (1 - ((1 + ANGLEN-1) * (CP-PREMIUM-RATE / 1000)))
  5415
  5416     GO TO 99999-RETURN                                           ERCNETP
  5417
  5418      .
  5419 12001-CHECK-CID-TRN-CA.                                          ERCNETP
  5420                                                                  ERCNETP
  5421     IF (CP-COMPANY-ID EQUAL 'CID')     AND                       ERCNETP
  5422        (CP-STATE-STD-ABBRV EQUAL 'CA') AND                       ERCNETP
  5423        (CP-EARN-AS-NET-PAY) AND                                  ERCNETP
  5424        (CP-TRUNCATED-LIFE) AND
  5425        (CP-STATE-STD-ABBRV = CP-STATE) AND
  5426        (WS-DISCOUNT-OPTION NOT = ' ')
  5427        CONTINUE                                                  ERCNETP
  5428     ELSE                                                         ERCNETP
  5429        GO TO 12001-CHECK-CID-TRN-MT                              ERCNETP
  5430     END-IF
  5431
  5432     COMPUTE ANGLEN EQUAL WK1 / I                                 ERCNETP
  5433     COMPUTE WS-WORK-DIS-RATE = WS-WORK-DIS-RATE / +12
  5434     IF WS-WORK-DIS-RATE = ZEROS
  5435        CONTINUE
  5436     ELSE
  5437        COMPUTE WK4 = 1 / (1 + WS-WORK-DIS-RATE)
  5438        COMPUTE WK7 = (1 / I) *
  5439              (((WK4 ** M - 1) / (WK4 - 1)) -
  5440              ((WK4 ** M * SX - VX) /
  5441              (WK4 * (1 + I) - 1))) *
  5442              (CP-PREMIUM-RATE / 1000)
  5443        COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN
  5444        COMPUTE CP-CALC-PREMIUM =
  5445           WK4 *  WK7
  5446     END-IF
  5447
  5448     GO TO 99999-RETURN                                           ERCNETP
  5449
  5450      .
  5451 12001-CHECK-CID-TRN-MT.                                          ERCNETP
  5452                                                                  ERCNETP
  5453     IF (CP-COMPANY-ID EQUAL 'CID') AND
  5454        ((CP-STATE-STD-ABBRV EQUAL 'MT' OR 'VT')
  5455                   OR
  5456        ((CP-STATE-STD-ABBRV = 'IN') AND
  5457        (CP-CERT-EFF-DT > X'9A7F'))
  5458                   OR
  5459        ((CP-STATE-STD-ABBRV = 'AZ' OR 'ND') AND
  5460        (CP-CERT-EFF-DT > X'9ADF'))) AND
  5461        (CP-EARN-AS-NET-PAY) AND                                  ERCNETP
  5462        (CP-TRUNCATED-LIFE) AND
  5463        (CP-STATE-STD-ABBRV = CP-STATE)
  5464        CONTINUE                                                  ERCNETP
  5465     ELSE                                                         ERCNETP
  5466        GO TO 12001-CHECK-CID-MT                                  ERCNETP
  5467     END-IF
  5468
  5469* K-I WILL BE USED FOR EXTRA INT. PERIODS
  5470     IF CP-STATE-STD-ABBRV = 'IN' OR 'ND'
  5471        MOVE 0                   TO K-I
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  99
* SUNATEX.cbl (/apps/prod/cid1p/copy/ERCNETP)
  5472     ELSE
  5473        MOVE 2                   TO K-I
  5474     END-IF
  5475     COMPUTE CP-TERM-OR-EXT-DAYS =
  5476           CP-TERM-OR-EXT-DAYS + 30
  5477
  5478     COMPUTE ANGLEN EQUAL WK1 / I                                 ERCNETP
  5479     COMPUTE WS-WORK-DIS-RATE = WS-WORK-DIS-RATE / +12
  5480     COMPUTE WK8 = (1 + (CP-TERM-OR-EXT-DAYS * I) / +30)
  5481                   / (1 + I)
  5482     COMPUTE ANGLEN-1 = ANGLEN / WK8
  5483     IF WS-WORK-DIS-RATE = ZEROS
  5484        CONTINUE
  5485     ELSE
  5486        COMPUTE WK4 = 1 / (1 + WS-WORK-DIS-RATE)
  5487*       COMPUTE WK7 = ((1 + (2 * I)) / I) *
  5488        COMPUTE WK7 = ((1 + (K-I * I)) / I) *
  5489              (((WK4 ** M - 1) / (WK4 - 1)) -
  5490              ((WK4 ** M * SX - VX) /
  5491              (WK4 * (1 + I) - 1))) *
  5492              (CP-PREMIUM-RATE / 1000)
  5493        COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN-1
  5494*       COMPUTE WK8 = (WK7 * 100) / (ANGLEN * (1 + 2 * I))
  5495        COMPUTE WK8 = (WK7 * 100) / (ANGLEN * (1 + K-I * I))
  5496        COMPUTE CP-CALC-PREMIUM =
  5497           WK8 *  ((WK4 * ANGLEN * (1 + K-I * I)) / 100)
  5498*          WK8 *  ((WK4 * ANGLEN * (1 + 2 * I)) / 100)
  5499     END-IF
  5500
  5501     GO TO 99999-RETURN                                           ERCNETP
  5502
  5503     .                                                            ERCNETP
  5504 12001-CHECK-CID-MT.                                              ERCNETP
  5505                                                                  ERCNETP
  5506     IF (CP-COMPANY-ID EQUAL 'CID')     AND                       ERCNETP
  5507        ((CP-STATE-STD-ABBRV EQUAL 'MT' OR 'NJ'
  5508                                OR 'VT')
  5509                   OR
  5510        ((CP-STATE-STD-ABBRV = 'IN') AND
  5511        (CP-CERT-EFF-DT > X'9A7F'))
  5512                   OR
  5513        ((CP-STATE-STD-ABBRV = 'AZ' OR 'ND') AND
  5514        (CP-CERT-EFF-DT > X'9ADF'))) AND
  5515        (CP-EARN-AS-NET-PAY) AND                                  ERCNETP
  5516        (CP-STATE-STD-ABBRV = CP-STATE)
  5517        CONTINUE                                                  ERCNETP
  5518     ELSE                                                         ERCNETP
  5519        GO TO 12001-CHECK-DCC-DD
  5520     END-IF
  5521
  5522     COMPUTE CP-TERM-OR-EXT-DAYS =
  5523           CP-TERM-OR-EXT-DAYS + 30
  5524
  5525* K-I WILL BE USED FOR EXTRA INT. PERIODS
  5526     IF CP-STATE-STD-ABBRV = 'IN' OR 'ND'
  5527        MOVE 0                   TO K-I
  5528     ELSE
  5529        IF CP-STATE-STD-ABBRV = 'NJ'
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page 100
* SUNATEX.cbl (/apps/prod/cid1p/copy/ERCNETP)
  5530           MOVE 1                TO K-I
  5531        ELSE
  5532           MOVE 2                TO K-I
  5533        END-IF
  5534     END-IF
  5535     COMPUTE ANGLEN EQUAL WK1 / I                                 ERCNETP
  5536     COMPUTE WS-WORK-DIS-RATE = WS-WORK-DIS-RATE / +12
  5537     COMPUTE WK8 = (1 + (CP-TERM-OR-EXT-DAYS * I) / +30)
  5538                   / (1 + I)
  5539     COMPUTE ANGLEN-1 = ANGLEN / WK8
  5540     IF WS-WORK-DIS-RATE = ZEROS
  5541        CONTINUE
  5542     ELSE
  5543        COMPUTE WK4 = 1 / (1 + WS-WORK-DIS-RATE)
  5544*       COMPUTE WK7 = ((1 + (2 * I)) / I) *
  5545        COMPUTE WK7 = ((1 + (K-I * I)) / I) *
  5546              (((WK4 ** N - 1) / (WK4 - 1)) -
  5547              ((WK4 ** N - SV) /
  5548              (WK4 * (1 + I) - 1))) *
  5549              (CP-PREMIUM-RATE / 1000)
  5550        COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN-1
  5551*       COMPUTE WK8 = (WK7 * 100) / (ANGLEN * (1 + 2 * I))
  5552        COMPUTE WK8 = (WK7 * 100) / (ANGLEN * (1 + K-I * I))
  5553        COMPUTE CP-CALC-PREMIUM =
  5554           WK8 *  ((WK4 * ANGLEN * (1 + K-I * I)) / 100)
  5555*          WK8 *  ((WK4 * ANGLEN * (1 + 2 * I)) / 100)
  5556     END-IF
  5557
  5558     GO TO 99999-RETURN                                           ERCNETP
  5559
  5560     .                                                            ERCNETP
  5561
  5562 12001-CHECK-DCC-DD.
  5563
  5564     IF (CP-COMPANY-ID EQUAL 'DCC')
  5565        AND (CP-EARN-AS-NET-PAY)
  5566        AND (CP-BEN-CATEGORY = 'D')
  5567        CONTINUE
  5568     ELSE
  5569        GO TO 12001-CHECK-DCC-NET
  5570     END-IF
  5571
  5572     COMPUTE CP-TERM-OR-EXT-DAYS =
  5573           CP-TERM-OR-EXT-DAYS + 30
  5574
  5575     COMPUTE ANGLEN EQUAL WK1 / I.                                ERCNETP
  5576     COMPUTE ANGLEM EQUAL WK2 / I.                                ERCNETP
  5577     COMPUTE ANGLEN-M EQUAL WK5 / I.                              ERCNETP
  5578                                                                  ERCNETP
  5579     COMPUTE ODF = (1+ (CP-TERM-OR-EXT-DAYS * I / 30))
  5580           / (1 + I)
  5581
  5582     COMPUTE GR     = ANGLEN / ODF
  5583*    COMPUTE CP-PREMIUM-RATE = CP-PREMIUM-RATE *
  5584*      CP-RATE-DEV-PCT
  5585
  5586     COMPUTE WK4 = CP-ORIGINAL-BENEFIT / GR
  5587
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page 101
* SUNATEX.cbl (/apps/prod/cid1p/copy/ERCNETP)
  5588     COMPUTE WK3 = WK4 * ((M - (ANGLEN - ANGLEN-M)) / I) *
  5589       (CP-PREMIUM-RATE / 100) * (1 + (0 * (N-P-APR / 12)))
  5590     MOVE ZEROS                  TO CP-RATE-DEV-PCT
  5591     MOVE WK3                    TO CP-CALC-PREMIUM
  5592
  5593     GO TO 99999-RETURN                                           ERCNETP
  5594
  5595     .                                                            ERCNETP
  5596
  5597 12001-CHECK-DCC-NET.                                             ERCNETP
  5598                                                                  ERCNETP
  5599     IF (CP-COMPANY-ID EQUAL 'DCC')
  5600        AND (CP-EARN-AS-NET-PAY)
  5601        AND (CP-BENEFIT-CD (1:1) NOT = 'M' AND 'N'
  5602             AND 'H' AND 'S' AND 'P')
  5603        CONTINUE                                                  ERCNETP
  5604     ELSE                                                         ERCNETP
  5605        GO TO 12001-CHECK-DCC-PNET                                ERCNETP
  5606     END-IF
  5607
  5608     COMPUTE CP-TERM-OR-EXT-DAYS =
  5609           CP-TERM-OR-EXT-DAYS + 30
  5610
  5611     COMPUTE ANGLEN EQUAL WK1 / I.                                ERCNETP
  5612     COMPUTE ANGLEM EQUAL WK2 / I.                                ERCNETP
  5613     COMPUTE ANGLEN-M EQUAL WK5 / I.                              ERCNETP
  5614                                                                  ERCNETP
  5615     COMPUTE ODF = (1+ (CP-TERM-OR-EXT-DAYS * I / 30))
  5616           / (1 + I)
  5617
  5618     COMPUTE GR     = ANGLEN / ODF
  5619     COMPUTE CP-PREMIUM-RATE = CP-PREMIUM-RATE / M * 12
  5620     COMPUTE CP-CALC-PREMIUM ROUNDED = CP-PREMIUM-RATE *
  5621       CP-RATE-DEV-PCT
  5622     MOVE CP-CALC-PREMIUM        TO CP-PREMIUM-RATE
  5623*    COMPUTE WK8 = CP-PREMIUM-RATE * M / 12
  5624
  5625     COMPUTE WK8 = CP-PREMIUM-RATE *
  5626        ((M + ((CP-TERM-OR-EXT-DAYS - 30) / 30)) / 12)
  5627     COMPUTE WK8 = WK8 / ((M + (12 / 12)) / 2)
  5628     COMPUTE WK4 = CP-ORIGINAL-BENEFIT / GR
  5629     COMPUTE WK3 = WK4 * ((M - (ANGLEN - ANGLEN-M)) / I) *
  5630       (WK8 / 100) * (1 + (0 * (N-P-APR / 12)))
  5631     MOVE ZEROS                  TO CP-RATE-DEV-PCT
  5632     MOVE WK3                    TO CP-CALC-PREMIUM
  5633
  5634     GO TO 99999-RETURN                                           ERCNETP
  5635
  5636     .                                                            ERCNETP
  5637 12001-CHECK-DCC-PNET.                                            ERCNETP
  5638
  5639     IF (CP-COMPANY-ID EQUAL 'DCC')
  5640        AND (CP-EARN-AS-NET-PAY)
  5641        AND (CP-BENEFIT-CD (1:1) = 'P')
  5642        CONTINUE                                                  ERCNETP
  5643     ELSE                                                         ERCNETP
  5644        GO TO 12001-CHECK-DCC-MNET                                ERCNETP
  5645     END-IF
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page 102
* SUNATEX.cbl (/apps/prod/cid1p/copy/ERCNETP)
  5646
  5647     IF CP-NO-OF-PMTS NOT NUMERIC
  5648        MOVE +0                  TO CP-NO-OF-PMTS
  5649     END-IF
  5650     IF CP-PMT-MODE NOT = 'W' AND 'S' AND 'B' AND 'T'
  5651        AND ' ' AND 'M'
  5652        MOVE ' '                 TO CP-PMT-MODE
  5653     END-IF
  5654
  5655******************************************************************
  5656***   Default is monthly, use loan term for rate and amort     ***
  5657******************************************************************
  5658     move cp-loan-term         to c-tot-pmts
  5659     MOVE +30                  TO C-DAYS-IN-PMT-PER
  5660     MOVE +12                  TO C-PMTS-PER-YEAR
  5661******************************************************************
  5662
  5663     evaluate true
  5664        when cp-pmt-mode = 'W'
  5665           MOVE +52              TO C-PMTS-PER-YEAR
  5666           compute c-tot-pmts = cp-loan-term /
  5667              12 * c-pmts-per-year
  5668           MOVE +7               TO C-DAYS-IN-PMT-PER
  5669        when cp-pmt-mode = 'B'
  5670           MOVE +26              TO C-PMTS-PER-YEAR
  5671           compute c-tot-pmts = cp-loan-term /
  5672              12 * c-pmts-per-year
  5673           MOVE +14              TO C-DAYS-IN-PMT-PER
  5674     end-evaluate
  5675
  5676     COMPUTE I = CP-LOAN-APR / C-PMTS-PER-YEAR / 100
  5677
  5678     COMPUTE Y = (1 + (CP-DAYS-TO-1ST-PMT * I /
  5679        C-DAYS-IN-PMT-PER)) / (1 + I)
  5680
  5681     compute anglen = (1 - (1 / (1 + i)) ** c-tot-pmts) / i
  5682*    COMPUTE ANGLEN = (1 - ((1 + I) ** (C-TOT-PMTS * -1))) / I
  5683     COMPUTE ANGLEN-1 = ANGLEN / Y
  5684
  5685     COMPUTE WK3 = CP-ORIGINAL-BENEFIT / ANGLEN-1
  5686
  5687     IF CP-RATE-DEV-PCT NOT = ZEROS
  5688        COMPUTE CP-PREMIUM-RATE = CP-RATE-DEV-PCT *
  5689           CP-PREMIUM-RATE
  5690     END-IF
  5691
  5692     COMPUTE CP-CALC-PREMIUM = (WK3 / 100) * CP-PREMIUM-RATE
  5693
  5694     GO TO 99999-RETURN
  5695
  5696     .                                                            ERCNETP
  5697 12001-CHECK-DCC-MNET.                                            ERCNETP
  5698                                                                  ERCNETP
  5699     IF (CP-COMPANY-ID EQUAL 'DCC')
  5700        AND (CP-EARN-AS-NET-PAY)
  5701        AND (CP-BENEFIT-CD (1:1) = 'M' OR 'H')
  5702        CONTINUE                                                  ERCNETP
  5703     ELSE                                                         ERCNETP
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page 103
* SUNATEX.cbl (/apps/prod/cid1p/copy/ERCNETP)
  5704        GO TO 12001-CHECK-DCC-MNET-LF-BAL
  5705     END-IF
  5706
  5707*    COMPUTE ANGLEN EQUAL WK1 / I.                                ERCNETP
  5708*    COMPUTE ANGLEM EQUAL WK2 / I.                                ERCNETP
  5709*    COMPUTE ANGLEN-M EQUAL WK5 / I.                              ERCNETP
  5710                                                                  ERCNETP
  5711     COMPUTE WK3 = CP-ORIGINAL-BENEFIT * CP-PREMIUM-RATE / 1000
  5712     MOVE WK3                    TO CP-CALC-PREMIUM
  5713
  5714     GO TO 99999-RETURN                                           ERCNETP
  5715
  5716     .                                                            ERCNETP
  5717 12001-CHECK-DCC-MNET-LF-BAL.
  5718                                                                  ERCNETP
  5719     IF (CP-COMPANY-ID EQUAL 'DCC')
  5720        AND (CP-EARN-AS-NET-PAY)
  5721        AND (CP-BENEFIT-CD (1:1) = 'N')
  5722        AND (CP-BEN-CATEGORY NOT = 'N')
  5723        AND (CP-ALTERNATE-BENEFIT NOT = ZEROS)
  5724        CONTINUE                                                  ERCNETP
  5725     ELSE                                                         ERCNETP
  5726        GO TO 12001-CHECK-DCC-MNET-LFSUM-BAL
  5727     END-IF
  5728
  5729     IF CP-RATE-DEV-PCT NOT = ZEROS
  5730        COMPUTE CP-PREMIUM-RATE = CP-RATE-DEV-PCT *
  5731           CP-PREMIUM-RATE
  5732     END-IF
  5733
  5734*    COMPUTE OD = (1 + ((CP-TERM-OR-EXT-DAYS + +30) * I / 30))
  5735     COMPUTE OD = (1 + (CP-DAYS-TO-1ST-PMT * I / 30))
  5736        / (1 + I)
  5737     COMPUTE ANGLEN-M = (WK5 / I) / OD
  5738     COMPUTE J = I + (CP-PREMIUM-RATE / +1000)
  5739     COMPUTE WK2 = (1 + J) ** (M * -1)
  5740     COMPUTE ANGLEN-M = ANGLEN-M * WK2
  5741
  5742     COMPUTE ANGLEM-1 = ((1 - ((1 + J)
  5743          ** ((M - 1) * -1))) / J)
  5744
  5745     COMPUTE ANGLEM = ((1 - ((1 + J)
  5746          ** (M * -1))) / J) / OD
  5747
  5748     COMPUTE RA = (CP-ORIGINAL-BENEFIT * OD -
  5749        (CP-ALTERNATE-BENEFIT * (1 + J) ** (M * -1)))
  5750        / ANGLEM-1
  5751
  5752     COMPUTE ANGLEN-M = ((1 - ((1 + I)
  5753          ** ((N - M) * -1))) / I)
  5754
  5755     MOVE +0                     TO WK3
  5756     PERFORM VARYING WS-COUNTER FROM +1 BY +1 UNTIL
  5757        (WS-COUNTER > M)
  5758        COMPUTE ANGLEM = (1 - ((1 + J)
  5759          ** ((M - WS-COUNTER) * -1))) / J
  5760        COMPUTE WK2 = (1 / (1 + j)) ** (M - WS-COUNTER + 1)
  5761        COMPUTE WK5-CSL = (RA * ANGLEM)
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page 104
* SUNATEX.cbl (/apps/prod/cid1p/copy/ERCNETP)
  5762        + (CP-ALTERNATE-BENEFIT * WK2)
  5763        COMPUTE WK3 = WK3 + (WK5-CSL * CP-PREMIUM-RATE / +1000)
  5764     END-PERFORM
  5765
  5766     MOVE WK3                    TO CP-CALC-PREMIUM
  5767
  5768     GO TO 99999-RETURN                                           ERCNETP
  5769
  5770     .                                                            ERCNETP
  5771 12001-CHECK-DCC-MNET-LFSUM-BAL.
  5772                                                                  ERCNETP
  5773     IF (CP-COMPANY-ID EQUAL 'DCC')
  5774        AND (CP-EARN-AS-NET-PAY)
  5775        AND (CP-BENEFIT-CD (1:1) = 'S')
  5776        AND (CP-BEN-CATEGORY NOT = 'N')
  5777        AND (CP-ALTERNATE-BENEFIT NOT = ZEROS)
  5778        CONTINUE                                                  ERCNETP
  5779     ELSE                                                         ERCNETP
  5780        GO TO 12001-CHECK-DCC-MNET-LF
  5781     END-IF
  5782
  5783     IF CP-RATE-DEV-PCT NOT = ZEROS
  5784        COMPUTE CP-PREMIUM-RATE = CP-RATE-DEV-PCT *
  5785           CP-PREMIUM-RATE
  5786     END-IF
  5787
  5788     COMPUTE K = I + (CP-PREMIUM-RATE / +1000)
  5789
  5790     COMPUTE ANGLEM-1 = ((1 - ((1 + K)
  5791          ** ((M - 1) * -1))) / K)
  5792
  5793     COMPUTE ANGLEM = ((1 - ((1 + K)
  5794          ** (M * -1))) / K)
  5795
  5796     MOVE CP-MONTHLY-PAYMENT     TO RA
  5797
  5798     COMPUTE WK3 = (((((M - 1) - ANGLEM-1) / K) - ((((M - 1)
  5799        * M / 2 - (((M - 1) - ANGLEM-1) / K)) / K) * 0 / 1000))
  5800        * RA + (CP-ALTERNATE-BENEFIT * ANGLEM)) *
  5801        CP-PREMIUM-RATE / 1000
  5802
  5803     MOVE WK3                    TO CP-CALC-PREMIUM
  5804
  5805
  5806     GO TO 99999-RETURN                                           ERCNETP
  5807
  5808     .                                                            ERCNETP
  5809 12001-CHECK-DCC-MNET-LF.
  5810                                                                  ERCNETP
  5811     IF (CP-COMPANY-ID EQUAL 'DCC')
  5812        AND (CP-EARN-AS-NET-PAY)
  5813        AND (CP-BENEFIT-CD (1:1) = 'N')
  5814        AND (CP-BEN-CATEGORY NOT = 'N')
  5815        CONTINUE                                                  ERCNETP
  5816     ELSE                                                         ERCNETP
  5817        GO TO 12001-CHECK-DCC-MNET-SUMLF
  5818     END-IF
  5819
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page 105
* SUNATEX.cbl (/apps/prod/cid1p/copy/ERCNETP)
  5820     IF CP-RATE-DEV-PCT NOT = ZEROS
  5821        COMPUTE CP-PREMIUM-RATE = CP-RATE-DEV-PCT *
  5822           CP-PREMIUM-RATE
  5823     END-IF
  5824
  5825*    COMPUTE OD = (1 + ((CP-TERM-OR-EXT-DAYS + +30) * I / 30))
  5826     COMPUTE OD = (1 + (CP-DAYS-TO-1ST-PMT * I / 30))
  5827        / (1 + I)
  5828     COMPUTE ANGLEN-M = (WK5 / I) / OD
  5829     COMPUTE J = I + (CP-PREMIUM-RATE / +1000)
  5830     COMPUTE WK2 = (1 + J) ** (M * -1)
  5831     COMPUTE ANGLEN-M = ANGLEN-M * WK2
  5832
  5833
  5834     COMPUTE ANGLEM = ((1 - ((1 + J)
  5835          ** (M * -1))) / J) / OD
  5836     COMPUTE RA = CP-ORIGINAL-BENEFIT / (ANGLEM + ANGLEN-M)
  5837
  5838     COMPUTE ANGLEN-M = ((1 - ((1 + I)
  5839          ** ((N - M) * -1))) / I)
  5840
  5841     MOVE +0                     TO WK3
  5842     PERFORM VARYING WS-COUNTER FROM +1 BY +1 UNTIL
  5843        (WS-COUNTER > M)
  5844        COMPUTE ANGLEM = (1 - ((1 + J)
  5845          ** ((M - WS-COUNTER + 1) * -1))) / J
  5846        COMPUTE WK2 = (1 / (1 + j)) ** (M - WS-COUNTER + 1)
  5847        COMPUTE WK5-CSL = RA * (ANGLEM + (ANGLEN-M * WK2))
  5848        COMPUTE WK3 = WK3 + (WK5-CSL * CP-PREMIUM-RATE / +1000)
  5849     END-PERFORM
  5850
  5851     MOVE WK3                    TO CP-CALC-PREMIUM
  5852
  5853     GO TO 99999-RETURN                                           ERCNETP
  5854
  5855     .                                                            ERCNETP
  5856 12001-CHECK-DCC-MNET-SUMLF.
  5857                                                                  ERCNETP
  5858     IF (CP-COMPANY-ID EQUAL 'DCC')
  5859        AND (CP-EARN-AS-NET-PAY)
  5860        AND (CP-BENEFIT-CD (1:1) = 'S')
  5861        AND (CP-BEN-CATEGORY NOT = 'N')
  5862        CONTINUE                                                  ERCNETP
  5863     ELSE                                                         ERCNETP
  5864        GO TO 12001-CHECK-DCC-MNET-TOT-BAL-N
  5865     END-IF
  5866
  5867     IF CP-RATE-DEV-PCT NOT = ZEROS
  5868        COMPUTE CP-PREMIUM-RATE = CP-RATE-DEV-PCT *
  5869           CP-PREMIUM-RATE
  5870     END-IF
  5871
  5872     COMPUTE K = I + (CP-PREMIUM-RATE / +1000)
  5873     COMPUTE Y = (1 + (CP-DAYS-TO-1ST-PMT * K / 30))
  5874        / (1 + K)
  5875
  5876     COMPUTE ANGLEN-M = (WK5 / I)
  5877     COMPUTE WK2 = (1 + K) ** (M * -1)
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page 106
* SUNATEX.cbl (/apps/prod/cid1p/copy/ERCNETP)
  5878     COMPUTE ANGLEN-M = ANGLEN-M * WK2
  5879     COMPUTE ANGLEN-M = ANGLEN-M / Y
  5880
  5881
  5882     COMPUTE ANGLEM = ((1 - ((1 + K)
  5883          ** (M * -1))) / K) / Y
  5884     COMPUTE RA = CP-ORIGINAL-BENEFIT / (ANGLEM + ANGLEN-M)
  5885
  5886     COMPUTE WK5-CSL = (((M - ANGLEM) / K) + (ANGLEN-M *
  5887        ((1 + K) ** (M + 1 / Y * (CP-DAYS-TO-1ST-PMT - +30) / 30)
  5888        - 1)) / K) * RA
  5889     COMPUTE WK7 = (((((M * (M + 1) / 2)
  5890        + (CP-DAYS-TO-1ST-PMT - +30)
  5891        / 30 * M - (M - ANGLEM) / K) / K)) * RA *
  5892        +0 / 1000 * 12 / 12)
  5893     COMPUTE WK3 = (WK5-CSL - WK7) * (CP-PREMIUM-RATE / 1000)
  5894        * (12 / 12)
  5895
  5896
  5897     MOVE WK3                    TO CP-CALC-PREMIUM
  5898
  5899     GO TO 99999-RETURN                                           ERCNETP
  5900
  5901     .                                                            ERCNETP
  5902 12001-CHECK-DCC-MNET-TOT-BAL-N.
  5903                                                                  ERCNETP
  5904     IF (CP-COMPANY-ID EQUAL 'DCC')
  5905        AND (CP-EARN-AS-NET-PAY)
  5906        AND (CP-BENEFIT-CD (1:1) = 'N')
  5907        AND (CP-BEN-CATEGORY = 'N')
  5908        AND (CP-ALTERNATE-BENEFIT NOT = ZEROS)
  5909        CONTINUE                                                  ERCNETP
  5910     ELSE                                                         ERCNETP
  5911        GO TO 12001-CHECK-DCC-MNET-TOT-BAL-S
  5912     END-IF
  5913
  5914*    COMPUTE OD = (1 + ((CP-TERM-OR-EXT-DAYS + +30) * I / 30))
  5915     COMPUTE OD = (1 + (CP-DAYS-TO-1ST-PMT * I / 30))
  5916        / (1 + I)
  5917     COMPUTE ANGLEN-M = (WK5 / I) / OD
  5918     COMPUTE J = I + ((CP-DCC-LF-RATE + CP-DCC-AH-RATE) / +1000)
  5919     COMPUTE K = I + (CP-DCC-LF-RATE / +1000)
  5920     COMPUTE WK2 = (1 + J) ** (M * -1)
  5921     COMPUTE ANGLEN-M = ANGLEN-M * WK2
  5922
  5923     COMPUTE ANGLEM-1 = ((1 - ((1 + J)
  5924          ** ((M - 1) * -1))) / J)
  5925
  5926     COMPUTE ANGLEM = ((1 - ((1 + J)
  5927          ** (M * -1))) / J) / OD
  5928
  5929     COMPUTE RA = (CP-ORIGINAL-BENEFIT * OD -
  5930        (CP-ALTERNATE-BENEFIT * (1 + K) ** (M * -1)))
  5931        / ANGLEM-1
  5932
  5933     COMPUTE ANGLEN-M = ((1 - ((1 + I)
  5934          ** ((N - M) * -1))) / I)
  5935
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page 107
* SUNATEX.cbl (/apps/prod/cid1p/copy/ERCNETP)
  5936     MOVE +0                     TO WK3
  5937     PERFORM VARYING WS-COUNTER FROM +1 BY +1 UNTIL
  5938        (WS-COUNTER > M)
  5939        COMPUTE ANGLEM = (1 - ((1 + J)
  5940          ** ((M - WS-COUNTER) * -1))) / J
  5941        COMPUTE WK2 = (1 / (1 + K)) ** (M - WS-COUNTER + 1)
  5942        COMPUTE WK5-CSL = (RA * ANGLEM)
  5943        + (CP-ALTERNATE-BENEFIT * WK2)
  5944        COMPUTE WK3 = WK3 +
  5945         (WK5-CSL * (CP-DCC-LF-RATE / +1000))
  5946        COMPUTE WK3 = WK3 + (WK5-CSL - (CP-ALTERNATE-BENEFIT *
  5947          (1 / (1 + K) ** (M - WS-COUNTER + 1)))) *
  5948          (CP-DCC-AH-RATE / 1000)
  5949     END-PERFORM
  5950
  5951     MOVE WK3                    TO CP-CALC-PREMIUM
  5952
  5953     GO TO 99999-RETURN                                           ERCNETP
  5954
  5955     .                                                            ERCNETP
  5956 12001-CHECK-DCC-MNET-TOT-BAL-S.
  5957                                                                  ERCNETP
  5958     IF (CP-COMPANY-ID EQUAL 'DCC')
  5959        AND (CP-EARN-AS-NET-PAY)
  5960        AND (CP-BENEFIT-CD (1:1) = 'S')
  5961        AND (CP-BEN-CATEGORY = 'N')
  5962        AND (CP-ALTERNATE-BENEFIT NOT = ZEROS)
  5963        CONTINUE                                                  ERCNETP
  5964     ELSE                                                         ERCNETP
  5965        GO TO 12001-CHECK-DCC-MNET-TOT-N
  5966     END-IF
  5967
  5968
  5969     COMPUTE K = I + (CP-DCC-LF-RATE / +1000)
  5970
  5971     COMPUTE ANGLEM-1 = ((1 - ((1 + K)
  5972          ** ((M - 1) * -1))) / K)
  5973
  5974     COMPUTE ANGLEM = ((1 - ((1 + K)
  5975          ** (M * -1))) / K)
  5976
  5977     MOVE CP-MONTHLY-PAYMENT     TO RA
  5978
  5979     COMPUTE WK3 = (((((M - 1) - ANGLEM-1) / K) - ((((M - 1)
  5980        * M / 2 - (((M - 1) - ANGLEM-1) / K)) / K)
  5981        * CP-DCC-AH-RATE / 1000))
  5982        * RA + (CP-ALTERNATE-BENEFIT * ANGLEM)) *
  5983        CP-DCC-LF-RATE / 1000
  5984
  5985     MOVE WK3                    TO CP-LF-PREM
  5986
  5987     COMPUTE WK5-CSL = RA * ((M - 1) * M / 2
  5988        + (M - 1) * (CP-DAYS-TO-1ST-PMT - 30) / 30)
  5989        * CP-DCC-AH-RATE / 1000
  5990
  5991     COMPUTE WK3 = WK3 + WK5-CSL
  5992
  5993
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page 108
* SUNATEX.cbl (/apps/prod/cid1p/copy/ERCNETP)
  5994     MOVE WK3                    TO CP-CALC-PREMIUM
  5995
  5996     GO TO 99999-RETURN                                           ERCNETP
  5997
  5998      .
  5999 12001-CHECK-DCC-MNET-TOT-N.
  6000                                                                  ERCNETP
  6001     IF (CP-COMPANY-ID EQUAL 'DCC')
  6002        AND (CP-EARN-AS-NET-PAY)
  6003        AND (CP-BENEFIT-CD (1:1) = 'N')
  6004        AND (CP-BEN-CATEGORY = 'N')
  6005        CONTINUE                                                  ERCNETP
  6006     ELSE                                                         ERCNETP
  6007        GO TO 12001-CHECK-DCC-MNET-TOT-S
  6008     END-IF
  6009
  6010*    I = APR/1200
  6011*    J = APR/1200 THEN ADJUSTED FOR THE LIFE AND DIS RATE
  6012*    RA = PAYMENT AMOUNT
  6013*    WK5-CSL = THE BALANCE (PAY OFF )
  6014*    WK3 = THE ACCUMULATED PREMIUM
  6015*    WK2 = (1 + I) ^ (m * -1)
  6016*    OD  = GAMMA
  6017*
  6018*    COMPUTE OD = (1 + ((CP-TERM-OR-EXT-DAYS + +30) * I / 30))
  6019     COMPUTE OD = (1 + (CP-DAYS-TO-1ST-PMT * I / 30))
  6020        / (1 + I)
  6021     COMPUTE ANGLEN-M = (WK5 / I) / OD
  6022     COMPUTE J = I + (CP-DCC-LF-RATE / +1000) +
  6023        (CP-DCC-AH-RATE / +1000)
  6024     COMPUTE WK2 = (1 + J) ** (M * -1)
  6025     COMPUTE ANGLEN-M = ANGLEN-M * WK2
  6026
  6027
  6028     COMPUTE ANGLEM = ((1 - ((1 + J)
  6029          ** (M * -1))) / J) / OD
  6030     COMPUTE RA = CP-ORIGINAL-BENEFIT / (ANGLEM + ANGLEN-M)
  6031
  6032     COMPUTE ANGLEN-M = ((1 - ((1 + I)
  6033          ** ((N - M) * -1))) / I)
  6034
  6035     MOVE +0                     TO WK3
  6036     PERFORM VARYING WS-COUNTER FROM +1 BY +1 UNTIL
  6037        (WS-COUNTER > M)
  6038        COMPUTE ANGLEM = (1 - ((1 + J)
  6039          ** ((M - WS-COUNTER + 1) * -1))) / J
  6040        COMPUTE WK2 = (1 / (1 + j)) ** (M - WS-COUNTER + 1)
  6041        COMPUTE WK5-CSL = RA * (ANGLEM + (ANGLEN-M * WK2))
  6042        COMPUTE WK3 = WK3 + (WK5-CSL * CP-DCC-LF-RATE / +1000)
  6043           + (WK5-CSL * CP-DCC-AH-RATE / +1000)
  6044     END-PERFORM
  6045
  6046     MOVE WK3                    TO CP-CALC-PREMIUM
  6047
  6048     GO TO 99999-RETURN                                           ERCNETP
  6049
  6050     .                                                            ERCNETP
  6051 12001-CHECK-DCC-MNET-TOT-S.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page 109
* SUNATEX.cbl (/apps/prod/cid1p/copy/ERCNETP)
  6052                                                                  ERCNETP
  6053     IF (CP-COMPANY-ID EQUAL 'DCC')
  6054        AND (CP-EARN-AS-NET-PAY)
  6055        AND (CP-BENEFIT-CD (1:1) = 'S')
  6056        AND (CP-BEN-CATEGORY = 'N')
  6057        CONTINUE                                                  ERCNETP
  6058     ELSE                                                         ERCNETP
  6059        GO TO 12001-CONTINUE-NET
  6060     END-IF
  6061
  6062*    I = APR/1200
  6063*    J = APR/1200 THEN ADJUSTED FOR THE LIFE RATE (K)
  6064*    RA = PAYMENT AMOUNT
  6065*    WK5-CSL = THE BALANCE (PAY OFF )
  6066*    WK3 = THE ACCUMULATED PREMIUM
  6067*    WK2 = (1 + I) ^ (m * -1)
  6068*    OD  = GAMMA
  6069*
  6070     COMPUTE J = I + (CP-DCC-LF-RATE / +1000)
  6071
  6072     COMPUTE OD = ((1 + (CP-DAYS-TO-1ST-PMT * J / 30)))
  6073        / (1 + J)
  6074
  6075     COMPUTE ANGLEM = ((1 - ((1 + J)
  6076          ** (M * -1))) / J) / OD
  6077
  6078     COMPUTE ANGLEN-M = ((1 - ((1 + I)
  6079          ** ((N - M) * -1))) / I)
  6080          * (1 + J) ** (-1 * M)
  6081
  6082     COMPUTE ANGLEN-M = ANGLEN-M / OD
  6083
  6084     MOVE CP-MONTHLY-PAYMENT     TO RA
  6085
  6086     COMPUTE WK1 = (M + 1 / OD * (CP-DAYS-TO-1ST-PMT - +30)
  6087        / +30)
  6088     COMPUTE WK4 = (((M - ANGLEM) / J) + (ANGLEN-M * ((1 + J)
  6089        ** (WK1) - 1)) / J) * RA
  6090
  6091     COMPUTE WK5 = (((((M * (M + 1) / 2)
  6092        + (CP-DAYS-TO-1ST-PMT - +30)
  6093        / +30 * M - (M - ANGLEM) / J) / J)) * RA *
  6094        CP-DCC-AH-RATE / +1000 * 12 / 12)
  6095
  6096     COMPUTE WK3 = (WK4 - WK5) * (CP-DCC-LF-RATE / +1000) *
  6097        (12 / 12)
  6098
  6099     COMPUTE WK5-CSL = RA * (M * (M + 1) / 2 + M *
  6100        (CP-DAYS-TO-1ST-PMT - +30) / +30) *
  6101        (CP-DCC-AH-RATE / +1000) * 12 / 12
  6102
  6103     COMPUTE WK3 = WK3 + WK5-CSL
  6104     MOVE WK3                    TO CP-CALC-PREMIUM
  6105
  6106     COMPUTE K = I + (CP-DCC-LF-RATE / +1000)
  6107     COMPUTE Y = (1 + (CP-DAYS-TO-1ST-PMT * K / 30))
  6108        / (1 + K)
  6109
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page 110
* SUNATEX.cbl (/apps/prod/cid1p/copy/ERCNETP)
  6110     COMPUTE ANGLEN-M = ((1 - ((1 + I)
  6111          ** ((N - M) * -1))) / I)
  6112     COMPUTE WK2 = (1 + K) ** (M * -1)
  6113     COMPUTE ANGLEN-M = ANGLEN-M * WK2
  6114     COMPUTE ANGLEN-M = ANGLEN-M / Y
  6115
  6116
  6117     COMPUTE ANGLEM = ((1 - ((1 + K)
  6118          ** (M * -1))) / K) / Y
  6119
  6120*    COMPUTE RA = CP-ORIGINAL-BENEFIT / (ANGLEM + ANGLEN-M)
  6121
  6122     COMPUTE WK6 = (((M - ANGLEM) / K) + (ANGLEN-M *
  6123        ((1 + K) ** (M + 1 / Y
  6124        * (CP-DAYS-TO-1ST-PMT - +30) / 30)
  6125        - 1)) / K) * RA
  6126     COMPUTE WK7 = (((((M * (M + 1) / 2)
  6127        + (CP-DAYS-TO-1ST-PMT - +30)
  6128        / 30 * M - (M - ANGLEM) / K) / K)) * RA *
  6129        CP-DCC-AH-RATE / 1000 * 12 / 12)
  6130     COMPUTE WK3 = (WK6 - WK7) * (CP-DCC-LF-RATE / 1000)
  6131        * (12 / 12)
  6132
  6133
  6134     MOVE WK3                    TO CP-LF-PREM
  6135
  6136
  6137
  6138     GO TO 99999-RETURN                                           ERCNETP
  6139
  6140     .                                                            ERCNETP
  6141 12001-CONTINUE-NET.                                              ERCNETP
  6142                                                                  ERCNETP
  6143     IF NET-STD                                                   ERCNETP
  6144        IF CP-COMPANY-ID EQUAL 'CDC' OR 'GTL' OR 'CID' OR 'MON'   ERCNETP
  6145*          OR 'DCC'
  6146         COMPUTE WK3 ROUNDED = ((I * M) + VX - SX) * 2 * N
  6147         COMPUTE WK3 ROUNDED = WK3 / ((1 - VX) * M * I)
  6148         COMPUTE WK3 ROUNDED = WK3 / ((2 * N) - M + 1)
  6149         COMPUTE WK3 ROUNDED = (WK3 * RA * K-I)
  6150                               * ((1 + N) / (1 + M))
  6151         if (i = .0000000001)
  6152            and (wk3 = zeros)
  6153            move 1               to wk3
  6154         end-if
  6155        ELSE                                                      ERCNETP
  6156         COMPUTE WK3 ROUNDED = ((I * M) + VX - SX) * 2 * N        ERCNETP
  6157         COMPUTE WK3 ROUNDED = WK3 / ((1 - VX) * M * I)           ERCNETP
  6158         COMPUTE WK3 ROUNDED = WK3 / ((2 * N) - M + 1)            ERCNETP
  6159         COMPUTE WK3 ROUNDED = WK3 * RA * K-I.                    ERCNETP
  6160                                                                  ERCNETP
  6161     IF NET-SMP                                                   ERCNETP
  6162         COMPUTE N2 = N * N                                       ERCNETP
  6163         COMPUTE N3 = N2 * N                                      ERCNETP
  6164         COMPUTE WK3 ROUNDED = 2 * N2 * WK1                       ERCNETP
  6165         COMPUTE WK3 ROUNDED = WK3 + (N3 * I) - (N2 * I)          ERCNETP
  6166         COMPUTE WK3 ROUNDED = WK3 + (4 * N * WK1)                ERCNETP
  6167         COMPUTE WK3 ROUNDED = WK3 * (1 + I) * 10                 ERCNETP
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page 111
* SUNATEX.cbl (/apps/prod/cid1p/copy/ERCNETP)
  6168         COMPUTE WK3 ROUNDED = WK3 / (36 * (N + 1) * WK1).        ERCNETP
  6169                                                                  ERCNETP
  6170     IF NPO-PRUDENTIAL                                            ERCNETP
  6171       PERFORM 12100-PRU-CALC THRU 12199-EXIT                     ERCNETP
  6172           VARYING WS-COUNTER FROM 1 BY 1                         ERCNETP
  6173               UNTIL WS-COUNTER = N                               ERCNETP
  6174       COMPUTE WK3 ROUNDED = (N * (I * PWK / (PWK - 1))) - 1      ERCNETP
  6175       COMPUTE WK3 ROUNDED = WK3 / (I * 12).                      ERCNETP
  6176                                                                  ERCNETP
  6177     MOVE WK3 TO FACTOR.                                          ERCNETP
  6178
  6179                                                                  ERCNETP
  6180     GO TO 99999-RETURN.                                          ERCNETP
  6181                                                                  ERCNETP
  6182 12100-PRU-CALC.                                                  ERCNETP
  6183     IF WS-COUNTER = 1                                            ERCNETP
  6184         COMPUTE PWK = (I + 1)                                    ERCNETP
  6185     ELSE                                                         ERCNETP
  6186         COMPUTE PWK = PWK * (I + 1).                             ERCNETP
  6187                                                                  ERCNETP
  6188 12199-EXIT.                                                      ERCNETP
  6189      EXIT.                                                       ERCNETP
  6190                                                                  ERCNETP
  6191 99000-ERROR.                                                     ERCNETP
  6192     MOVE +9999.999999999 TO N-P-FACTOR.                          ERCNETP
  6193     MOVE '4'             TO CP-RETURN-CODE.                      ERCNETP
  6194                                                                  ERCNETP
  6195     GO TO 99999-EXIT.                                            ERCNETP
  6196                                                                  ERCNETP
  6197 99999-RETURN.                                                    ERCNETP
  6198     MOVE FACTOR          TO N-P-FACTOR.                          ERCNETP
  6199                                                                  ERCNETP
  6200 99999-EXIT.                                                      ERCNETP
  6201      EXIT.                                                       ERCNETP
  6202
  6203 99999-DUMMY-STOP-RUN.
  6204     GOBACK.
  6205
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:        7980     Code:       55580
