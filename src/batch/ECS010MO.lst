* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   1
* ECS010MO.cbl
* Options: int("ECS010MO.int") anim csi verbose NOBOUND PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("ECS010MO.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"ebmlsfile" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" NOCHECKDIV NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"32" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"ECS010MO.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST
*          "ECS010MO.lst" LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0"
*          NOMAPNAME NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT
*          NOMOVELENCHECK NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT
*          NONCHAR NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR NOSTICKY-LINKAGE
*          NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"2" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                 ECS010.
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 04/27/94 07:51:58.
     7*              PROGRAM REVIEWED FOR YEAR 2000 COMPLIANCE
     8*                            VMOD=2.082.
     9
    10*AUTHOR.        LOGIC, INC.
    11*               DALLAS, TEXAS.
    12
    13*DATE-COMPILED.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   2
* ECS010MO.cbl
    14
    15*SECURITY.   *****************************************************
    16*            *                                                   *
    17*            *   THIS PROGRAM IS THE PROPERTY OF LOGIC, INC.     *
    18*            *                                                   *
    19*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
    20*            *   OF LOGIC, INC. IS EXPRESSLY PROHIBITED WITHOUT  *
    21*            *   THE PRIOR WRITTEN PERMISSION OF LOGIC INC.      *
    22*            *                                                   *
    23*            *****************************************************
    24
    25*REMARKS.
    26*        THIS PROGRAM ACCEPTS VALIDATED TRANSACTIONS FROM EL522
    27*        AND APPLIES THEM TO THE CERTIFICATE MASTER FILE.
    28*        EXTRACTS ARE PRODUCED FOR PRODUCTION  EARNED PREMIUM &
    29*        LOSS, REINSURANCE, COMMISSIONS, CLAIMS REGISTER, ETC.
    30******************************************************************
    31*                   C H A N G E   L O G
    32*
    33* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    34*-----------------------------------------------------------------
    35*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    36* EFFECTIVE    NUMBER
    37*-----------------------------------------------------------------
    38* 061802                   PEMA  ADD PROCESS FOR PEOPLES
    39* 062602    2002061900011  SMVA  CHANGE SYS009 SYSOUT TO FILE WITH
    40*                              ORGANIZATION AS LINE SEQUENTIAL
    41* 070102                   SMVA  CLEAN UP COMPILE ERRORS
    42* 080702    2002061800008  PEMA  ADD PROCESS FOR SUNFLOWER
    43* 092602    2002091900008  PEMA  INCREASE NUMBER OF MAXIMUM
    44*                                  BENEFIT CODES FROM 450 TO 900
    45* 111402    2001061800003  PEMA  ADD DCC PROCESSING
    46* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
    47* 052703                   PEMA  MODIFY CEDE BALLOON PREM TO NSP
    48* 070203                   PEMA  BUILD REIN COMP DATA FOR NSP
    49* 100703    2003080800002  PEMA  ADD SUPER GAP PROCESSING
    50* 123003                   PEMA  MODIFY COMPUTE STMTS FOR REIN
    51* 040504    2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
    52* 062104    2004050700001  SMVA  ADD NEW FILES TO AUTOMATE ME BALANCING
    53* 102204    2004101500007  PEMA  IBNR FOR DCC
    54* 111204    2004110300005  PEMA  SPLIT SPP BANK FEE
    55* 123004                   PEMA  ADD REFUND PROCESSING FOR "MONTHLY"
    56* 020305    2005020000000  PEMA  ADD CLP STATE PROCESSING
    57* 092705  CR2005050300006  PEMA  ADD SPP LEASES
    58* 052306  CR2006050800002  PEMA  ADD COMM TYPE 'J'
    59* 061206  CR2006050500001  PEMA  ADD FIRST PREMIER BANK
    60* 011207                   PEMA  PASS SIG SW TO BATCH CERT FILE
    61* 041508  CR2008030300004  PEMA  ADD POST CARD REFUND PROCESSING
    62* 042408  CR2007110500003  PEMA  ADD REFUND INTEREST PROCESSING
    63* 050808  IR2008050100002  PEMA  CHECK FOR LF AMT = ZERO
    64* 080808  IR2008080100002  PEMA  CHECK FOR AH AMT = ZERO
    65* 111208  IR2008111000001  PEMA  CORRECT BANK FEE CALC.
    66* 040109  CR2009031600001  AJRA  ADD VIN TO CERT TRLR.
    67* 093009  CR2009010500002  PEMA  CORRECT EARNED COMMISSION CALC
    68* 121609  CR2008112100001  AJRA  CORRECT AL, TX, VA STATE STAT EP
    69* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
    70******************************************************************
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   3
* ECS010MO.cbl
    72 ENVIRONMENT DIVISION.
    73 CONFIGURATION SECTION.
    74 SPECIAL-NAMES.
    75     C02 IS LCP-CH2
    76     C03 IS LCP-CH3
    77     C04 IS LCP-CH4
    78     C05 IS LCP-CH5
    79     C06 IS LCP-CH6
    80     C07 IS LCP-CH7
    81     C08 IS LCP-CH8
    82     C09 IS LCP-CH9
    83     C10 IS LCP-CH10
    84     C11 IS LCP-CH11
    85     C12 IS LCP-CH12
    86     S01 IS LCP-P01
    87     S02 IS LCP-P02.
    88
    89 INPUT-OUTPUT SECTION.
    90 FILE-CONTROL.
    91
    92     SELECT PENDING-EXTRACT  ASSIGN TO SYS005.
    93
    94     SELECT CERT-MASTER-IN   ASSIGN TO SYS010.
    95
    96     SELECT ERACCTT-IN       ASSIGN TO ERACCTT
    97                             ACCESS IS SEQUENTIAL
    98                             ORGANIZATION IS INDEXED
    99                             FILE STATUS IS ERACCTT-FILE-STATUS
   100                             RECORD KEY IS AM-CONTROL-PRIMARY.
   101
   102     SELECT ERRTBL-IN        ASSIGN TO ERRTBLT
   103                             ACCESS IS DYNAMIC
   104                             ORGANIZATION IS INDEXED
   105                             FILE STATUS IS ERRTBL-FILE-STATUS
   106                             RECORD KEY IS RE-CONTROL-PRIMARY.
   107
   108     SELECT ERCTBL           ASSIGN TO ERCTBLT
   109                             ACCESS IS DYNAMIC
   110                             ORGANIZATION IS INDEXED
   111                             FILE STATUS IS ERCTBL-FILE-STATUS
   112                             RECORD KEY IS CT-CONTROL-PRIMARY.
   113
   114     SELECT ERMEBL-INOUT     ASSIGN TO ERMEBL
   115                             ORGANIZATION INDEXED
   116                             ACCESS DYNAMIC
   117                             RECORD KEY ME-CONTROL-PRIMARY
   118                             FILE STATUS ERMEBL-FILE-STATUS.
   119
   120     SELECT ERRESC-IN        ASSIGN TO ERRESC
   121                             ORGANIZATION IS INDEXED
   122                             ACCESS IS DYNAMIC
   123                             RECORD KEY IS ERRESC-RECORD-KEY
   124                             FILE STATUS IS ERRESC-FILE-STATUS.
   125
   126     SELECT ELCRTT           ASSIGN TO ELCRTT
   127                             ACCESS IS DYNAMIC
   128                             ORGANIZATION IS INDEXED
   129                             FILE STATUS IS ELCRTT-FILE-STATUS
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   4
* ECS010MO.cbl
   130                             RECORD KEY IS CS-CONTROL-PRIMARY.
   131
   132     SELECT ERAGTC           ASSIGN TO ERAGTC
   133                             ACCESS IS DYNAMIC
   134                             ORGANIZATION IS INDEXED
   135                             FILE STATUS IS ERAGTC-FILE-STATUS
   136                             RECORD KEY IS AG-CONTROL-PRIMARY.
   137
   138     SELECT CERT-MASTER-OUT  ASSIGN TO SYS011.
   139
   140     SELECT DETAIL-EXTR      ASSIGN TO SYS017.
   141
   142     SELECT SUMMARY-EXTR     ASSIGN TO SYS018.
   143
   144
   145     SELECT ME-ECS010-BALANCE
   146                             ASSIGN TO SYS012
   147                             ORGANIZATION IS LINE SEQUENTIAL.
   148
   149     SELECT ME50-ECS010-BALANCE
   150                             ASSIGN TO SYS013
   151                             ORGANIZATION IS LINE SEQUENTIAL.
   152
   153     SELECT DISPLAY-PRT      ASSIGN TO SYS022.
   154
   155     SELECT DISK-DATE        ASSIGN TO SYS019.
   156
   157     SELECT PRINT-COPY       ASSIGN TO SYS008.
   158
   159     SELECT MISMATCH-REPORT  ASSIGN TO SYS009.
   160
   161     SELECT FICH             ASSIGN TO SYS020.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   5
* ECS010MO.cbl
   163 DATA DIVISION.
   164 FILE SECTION.
   165
   166 FD  PENDING-EXTRACT
   167     BLOCK CONTAINS 0 RECORDS
   168     RECORDING MODE F.
   169
*  170                             COPY ERCEXTD.
   171******************************************************************04/29/98
   172*                                                                *ERCEXTD
   173*                                                                *ERCEXTD
   174*                            ERCEXTD                             *   LV002
   175*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
   176*                            VMOD=2.002                          *   CL**2
   177*                                                                *ERCEXTD
   178*   FILE DESCRIPTION = ONLINE TO BATCH FILE INTERFACE AND REPORT *ERCEXTD
   179*                      EXTRACT FOR OFFLINE REPORTING.            *ERCEXTD
   180*                                                                *ERCEXTD
   181*     THIS FILE IS CREATED FROM ERCEXTR EXTRACT INTERFACE        *ERCEXTD
   182*  FOR THE FOLLOWING RECORD TYPES. THE MAIN BODY OF EACH RECORD  *ERCEXTD
   183*  CONTAINS A STRAIGHT COPY OF THE EX-DATA-AREA IN EXCEXTR.      *ERCEXTD
   184*                                                                *ERCEXTD
   185*         RECORD                                                 *ERCEXTD
   186*          TYPE          PROGRAM USING                           *ERCEXTD
   187*        --------        --------------------------------        *ERCEXTD
   188*           A             EL522  PENDING BUSINESS EXTRACT        *ERCEXTD
   189*           B             EL522  PENDING CLAIMS   EXTRACT        *ERCEXTD
   190*           C             EL522  CERT CHANGES     EXTRACT        *ERCEXTD
   191*                                                                *ERCEXTD
   192* -------------------------------------------------------------- *ERCEXTD
   193*                                                                *ERCEXTD
   194*   FILE TYPE = SEQUENTIAL                                       *ERCEXTD
   195*   RECORD SIZE = 588   RECFORM = FIX                            *ERCEXTD
   196*                                                                *ERCEXTD
   197*   FILENAME = EREXTD                                            *ERCEXTD
   198*                                                                *ERCEXTD
   199******************************************************************ERCEXTD
   200                                                                  ERCEXTD
   201 01  EXTRACT-DATA-RECORD.                                         ERCEXTD
   202     12  ED-RECORD-ID                        PIC XX.              ERCEXTD
   203         88  VALID-IN-ID                           VALUE 'ED'.    ERCEXTD
   204                                                                  ERCEXTD
   205     12  ED-RECORD-TYPE                      PIC X.               ERCEXTD
   206         88  ED-PENDING-BUSINESS                   VALUE 'A'.     ERCEXTD
   207         88  ED-PENDING-CLAIMS                     VALUE 'B'.     ERCEXTD
   208         88  ED-CERT-CHANGES                       VALUE 'C'.     ERCEXTD
   209                                                                  ERCEXTD
   210     12  ED-DATA-AREAS                       PIC X(585).          ERCEXTD
   211                                                                  ERCEXTD
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   6
* ECS010MO.cbl
   213 FD  CERT-MASTER-IN
*  214                             COPY ECSCRIFD.
   215******************************************************************07/10/97
   216*                                                                *ECSCRIFD
   217*                            ECSCRIFD                            *   LV001
   218*                            VMOD 2.005                          *ECSCRIFD
   219*                                                                *ECSCRIFD
   220*  NO CID MODS FOR COPYBOOK ECSCRIFD                             *ECSCRIFD
   221*                                                                *ECSCRIFD
   222******************************************************************ECSCRIFD
   223     BLOCK CONTAINS 0 RECORDS
   224     RECORDING MODE F.                                            ECSCRIFD
   225                                                                  ECSCRIFD
   226 01  CERT-IN-RECORD.                                              ECSCRIFD
   227                                                                  ECSCRIFD
   228     12  FILLER                            PIC XXX.               ECSCRIFD
   229     12  CIR-CONTROL                       PIC X(36).             ECSCRIFD
   230     12  FILLER                            PIC X(66).             ECSCRIFD
   231     12  CIR-JOINT-AGE                     PIC 99.                ECSCRIFD
   232     12  FILLER                            PIC X(20).             ECSCRIFD
   233     12  CIR-LFTYP                         PIC XX.                ECSCRIFD
   234     12  FILLER                            PIC X(14).             ECSCRIFD
   235     12  CIR-LFAMT                         PIC S9(9)V99   COMP-3. ECSCRIFD
   236     12  FILLER                            PIC X(39).             ECSCRIFD
   237     12  CIR-LFRFND-CALC                   PIC S9(7)V99   COMP-3. ECSCRIFD
   238     12  FILLER                            PIC X(45).             ECSCRIFD
   239     12  CIR-AHTYP                         PIC XX.                ECSCRIFD
   240     12  FILLER                            PIC X(35).             ECSCRIFD
   241     12  CIR-AHRFND-CALC                   PIC S9(7)V99   COMP-3. ECSCRIFD
   242     12  FILLER                            PIC X(41).             ECSCRIFD
   243     12  CIR-APR                           PIC S999V9(4)  COMP-3. ECSCRIFD
   244     12  FILLER                            PIC X(48).             ECSCRIFD
   245     12  CIR-REIN-TABLE                    PIC XXX.               ECSCRIFD
   246     12  FILLER                            PIC X(9).              ECSCRIFD
   247     12  CIR-SUM-CAN-CNT-YTD               PIC S999       COMP-3. ECSCRIFD
   248     12  FILLER                            PIC X(120).            ECSCRIFD
   249     12  CIR-DTHAMT-YTD                    PIC S9(9)V99   COMP-3. ECSCRIFD
   250     12  FILLER                            PIC X(73).             ECSCRIFD
   251     12  CIR-DISAMT-YTD                    PIC S9(9)V99   COMP-3. ECSCRIFD
   252     12  FILLER                            PIC X(464).            ECSCRIFD
   253                                                                  ECSCRIFD
   254******************************************************************ECSCRIFD
   255
   256 01  CI-RECORD.
   257     12  FILLER          PIC  X(03).
   258     12  CI-ACCOUNT-CONTROL.
   259         16  CI-CARRIER      PIC  X(01).
   260         16  CI-GROUPING     PIC  X(06).
   261         16  CI-STATE        PIC  X(02).
   262         16  CI-ACCOUNT      PIC  X(10).
   263     12  FILLER          PIC  X(06).
   264     12  CI-CERT-NO.
   265         16  CI-CERT     PIC X(10).
   266         16  CI-CERT-SFX PIC X.
   267     12  FILLER          PIC  X(1017).
   268
   269******************************************************
   270*   THIS FILE DEFINITION WAS ADDED TO ACCOMMODATE THE EXECUTION
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   7
* ECS010MO.cbl
   271*   OF A "MID MONTH" BILLING REPORT (EL562) FOR
   272*   COMMERCIAL FEDERAL BANK
   273******************************************************
   274 01  CF-RECORD.
   275     12  FILLER          PIC X(759).
   276     12  CF-THIRD-AGENT  PIC X(10).
   277     12  FILLER          PIC X(7).
   278     12  CF-FOURTH-AGENT PIC X(10).
   279     12  FILLER          PIC X(270).
   280
   281******************************************************
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   8
* ECS010MO.cbl
   283 FD  ERACCTT-IN.
   284
*  285                             COPY ERCACCT.
   286******************************************************************04/19/98
   287*                                                                *ERCACCT
   288*                                                                *ERCACCT
   289*                            ERCACCT                             *   LV031
   290*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL*31
   291*                            VMOD=2.031                          *ERCACCT
   292*                                                                *ERCACCT
   293*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *ERCACCT
   294*                                                                *ERCACCT
   295*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *ERCACCT
   296*   VSAM ACCOUNT MASTER FILES.                                   *ERCACCT
   297*                                                                *ERCACCT
   298*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *ERCACCT
   299*                                                                *ERCACCT
   300*   FILE TYPE = VSAM,KSDS                                        *ERCACCT
   301*   RECORD SIZE = 2000  RECFORM = FIX                            *ERCACCT
   302*                                                                *ERCACCT
   303*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *ERCACCT
   304*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *ERCACCT
   305*                                                                *ERCACCT
   306*   LOG = NO                                                     *ERCACCT
   307*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *ERCACCT
   308*                                                                *ERCACCT
   309*                                                                *ERCACCT
   310******************************************************************ERCACCT
   311*                   C H A N G E   L O G
   312*
   313* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   314*-----------------------------------------------------------------
   315*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   316* EFFECTIVE    NUMBER
   317*-----------------------------------------------------------------
   318* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
   319* 092705    2005050300006  PEMA  ADD SPP LEASES
   320* 022808    2007083100002  PEMA  ADD FREEZE STATUS
   321* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
   322* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
   323* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
   324* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
   325******************************************************************
   326                                                                  ERCACCT
   327 01  ACCOUNT-MASTER.                                              ERCACCT
   328     12  AM-RECORD-ID                      PIC XX.                ERCACCT
   329         88  VALID-AM-ID                      VALUE 'AM'.         ERCACCT
   330                                                                  ERCACCT
   331     12  AM-CONTROL-PRIMARY.                                      ERCACCT
   332         16  AM-COMPANY-CD                 PIC X.                 ERCACCT
   333         16  AM-MSTR-CNTRL.                                       ERCACCT
   334             20  AM-CONTROL-A.                                    ERCACCT
   335                 24  AM-CARRIER            PIC X.                 ERCACCT
   336                 24  AM-GROUPING.                                 ERCACCT
   337                     28 AM-GROUPING-PREFIX PIC XXX.               ERCACCT
   338                     28 AM-GROUPING-PRIME  PIC XXX.               ERCACCT
   339                 24  AM-STATE              PIC XX.                ERCACCT
   340                 24  AM-ACCOUNT.                                  ERCACCT
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   9
* ECS010MO.cbl (/apps/prod/cid1p/copy/ERCACCT)
   341                     28  AM-ACCOUNT-PREFIX PIC X(4).              ERCACCT
   342                     28  AM-ACCOUNT-PRIME  PIC X(6).              ERCACCT
   343             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A            ERCACCT
   344                                           PIC X(19).             ERCACCT
   345             20  AM-CNTRL-B.                                      ERCACCT
   346                 24  AM-EXPIRATION-DT      PIC XX.                ERCACCT
   347                 24  FILLER                PIC X(4).              ERCACCT
   348             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.                 ERCACCT
   349                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.     ERCACCT
   350                                                                  ERCACCT
   351     12  AM-CONTROL-BY-VAR-GRP.                                   ERCACCT
   352         16  AM-COMPANY-CD-A1              PIC X.                 ERCACCT
   353         16  AM-VG-CARRIER                 PIC X.                 ERCACCT
   354         16  AM-VG-GROUPING                PIC X(6).              ERCACCT
   355         16  AM-VG-STATE                   PIC XX.                ERCACCT
   356         16  AM-VG-ACCOUNT                 PIC X(10).             ERCACCT
   357         16  AM-VG-DATE.                                          ERCACCT
   358             20  AM-VG-EXPIRATION-DT       PIC XX.                ERCACCT
   359             20  FILLER                    PIC X(4).              ERCACCT
   360         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE                  ERCACCT
   361                                           PIC 9(11)      COMP-3. ERCACCT
   362     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
   363         16  FILLER                        PIC X(10).
   364         16  AM-VG-KEY3.
   365             20  AM-VG3-ACCOUNT            PIC X(10).
   366             20  AM-VG3-EXP-DT             PIC XX.
   367         16  FILLER                        PIC X(4).
   368     12  AM-MAINT-INFORMATION.                                    ERCACCT
   369         16  AM-LAST-MAINT-DT              PIC XX.                ERCACCT
   370         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3. ERCACCT
   371         16  AM-LAST-MAINT-USER            PIC X(4).              ERCACCT
   372         16  FILLER                        PIC XX.                ERCACCT
   373                                                                  ERCACCT
   374     12  AM-EFFECTIVE-DT                   PIC XX.                ERCACCT
   375     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3. ERCACCT
   376                                                                  ERCACCT
   377     12  AM-PREV-DATES  COMP-3.                                   ERCACCT
   378         16  AM-PREV-EXP-DT                PIC 9(11).             ERCACCT
   379         16  AM-PREV-EFF-DT                PIC 9(11).             ERCACCT
   380                                                                  ERCACCT
   381     12  AM-REPORT-CODE-1                  PIC X(10).             ERCACCT
   382     12  AM-REPORT-CODE-2                  PIC X(10).             ERCACCT
   383                                                                  ERCACCT
   384     12  AM-CITY-CODE                      PIC X(4).              ERCACCT
   385     12  AM-COUNTY-PARISH                  PIC X(6).              ERCACCT
   386                                                                  ERCACCT
   387     12  AM-NAME                           PIC X(30).             ERCACCT
   388     12  AM-PERSON                         PIC X(30).             ERCACCT
   389     12  AM-ADDRS                          PIC X(30).             ERCACCT
   390     12  AM-CITY.
   391         16  AM-ADDR-CITY                  PIC X(28).
   392         16  AM-ADDR-STATE                 PIC XX.
   393     12  AM-ZIP.                                                  ERCACCT
   394         16  AM-ZIP-PRIME.                                        ERCACCT
   395             20  AM-ZIP-PRI-1ST            PIC X.                 ERCACCT
   396                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'. ERCACCT
   397             20  FILLER                    PIC X(4).              ERCACCT
   398         16  AM-ZIP-PLUS4                  PIC X(4).              ERCACCT
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  10
* ECS010MO.cbl (/apps/prod/cid1p/copy/ERCACCT)
   399     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.              ERCACCT
   400         16  AM-CAN-POSTAL-1               PIC XXX.               ERCACCT
   401         16  AM-CAN-POSTAL-2               PIC XXX.               ERCACCT
   402         16  FILLER                        PIC XXX.               ERCACCT
   403     12  AM-TEL-NO.                                               ERCACCT
   404         16  AM-AREA-CODE                  PIC 999.               ERCACCT
   405         16  AM-TEL-PRE                    PIC 999.               ERCACCT
   406         16  AM-TEL-NBR                    PIC 9(4).              ERCACCT
   407     12  AM-TEL-LOC                        PIC X.                 ERCACCT
   408         88  AM-TEL-AT-HOME                   VALUE 'H'.          ERCACCT
   409         88  AM-TEL-AT-BUSINESS               VALUE 'B'.          ERCACCT
   410                                                                  ERCACCT
   411     12  AM-COMM-STRUCTURE.                                       ERCACCT
   412         16  AM-DEFN-1.                                           ERCACCT
   413             20  AM-AGT-COMMS       OCCURS 10 TIMES.              ERCACCT
   414                 24  AM-AGT.                                      ERCACCT
   415                     28  AM-AGT-PREFIX     PIC X(4).              ERCACCT
   416                     28  AM-AGT-PRIME      PIC X(6).              ERCACCT
   417                 24  AM-COM-TYP            PIC X.                 ERCACCT
   418                 24  AM-L-COM              PIC SV9(5)     COMP-3. ERCACCT
   419                 24  AM-J-COM              PIC SV9(5)     COMP-3. ERCACCT
   420                 24  AM-A-COM              PIC SV9(5)     COMP-3. ERCACCT
   421                 24  AM-RECALC-LV-INDIC    PIC X.                 ERCACCT
   422                 24  AM-RETRO-LV-INDIC     PIC X.                 ERCACCT
   423                 24  AM-GL-CODES           PIC X.                 ERCACCT
   424                 24  AM-COMM-CHARGEBACK    PIC 9(02).             ERCACCT
   425                 24  FILLER                PIC X(01).             ERCACCT
   426         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.                   ERCACCT
   427             20  AM-COM-TBLS        OCCURS 10 TIMES.              ERCACCT
   428                 24  FILLER                PIC X(11).             ERCACCT
   429                 24  AM-L-COMA             PIC XXX.               ERCACCT
   430                 24  AM-J-COMA             PIC XXX.               ERCACCT
   431                 24  AM-A-COMA             PIC XXX.               ERCACCT
   432                 24  FILLER                PIC X(6).              ERCACCT
   433                                                                  ERCACCT
   434     12  AM-COMM-CHANGE-STATUS             PIC X.                 ERCACCT
   435         88  AM-COMMISSIONS-CHANGED           VALUE '*'.          ERCACCT
   436                                                                  ERCACCT
   437     12  AM-CSR-CODE                       PIC X(4).              ERCACCT
   438                                                                  ERCACCT
   439     12  AM-BILLING-STATUS                 PIC X.                 ERCACCT
   440         88  AM-ACCOUNT-BILLED                VALUE 'B'.          ERCACCT
   441         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.          ERCACCT
   442     12  AM-AUTO-REFUND-SW                 PIC X.                 ERCACCT
   443         88  AUTO-REFUNDS-USED                VALUE 'Y'.          ERCACCT
   444         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.      ERCACCT
   445     12  AM-GPCD                           PIC 99.                ERCACCT
   446     12  AM-IG                             PIC X.                 ERCACCT
   447         88  AM-HAS-INDIVIDUAL                VALUE '1'.          ERCACCT
   448         88  AM-HAS-GROUP                     VALUE '2'.          ERCACCT
   449     12  AM-STATUS                         PIC X.                 ERCACCT
   450         88  AM-ACCOUNT-ACTIVE                VALUE '0'.          ERCACCT
   451         88  AM-ACCOUNT-INACTIVE              VALUE '1'.          ERCACCT
   452         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.          ERCACCT
   453         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
   454         88  AM-ACCOUNT-FROZEN                VALUE '4'.
   455         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
   456     12  AM-REMIT-TO                       PIC 99.                ERCACCT
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  11
* ECS010MO.cbl (/apps/prod/cid1p/copy/ERCACCT)
   457     12  AM-ID-NO                          PIC X(11).             ERCACCT
   458                                                                  ERCACCT
   459     12  AM-CAL-TABLE                      PIC XX.                ERCACCT
   460     12  AM-LF-DEVIATION                   PIC XXX.               ERCACCT
   461     12  AM-AH-DEVIATION                   PIC XXX.               ERCACCT
   462     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3. ERCACCT
   463     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3. ERCACCT
   464     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3. ERCACCT
   465     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3. ERCACCT
   466     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3. ERCACCT
   467     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3. ERCACCT
   468                                                                  ERCACCT
   469     12  AM-USER-FIELDS.                                          ERCACCT
   470         16  AM-FLD-1                      PIC XX.                ERCACCT
   471         16  AM-FLD-2                      PIC XX.                ERCACCT
   472         16  AM-FLD-3                      PIC XX.                ERCACCT
   473         16  AM-FLD-4                      PIC XX.                ERCACCT
   474         16  AM-FLD-5                      PIC XX.                ERCACCT
   475                                                                  ERCACCT
   476     12  AM-1ST-PROD-DATE.                                        ERCACCT
   477         16  AM-1ST-PROD-YR                PIC XX.                ERCACCT
   478         16  AM-1ST-PROD-MO                PIC XX.                ERCACCT
   479         16  AM-1ST-PROD-DA                PIC XX.                ERCACCT
   480     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.     ERCACCT
   481     12  AM-CERTS-PURGED-DATE.                                    ERCACCT
   482         16  AM-PUR-YR                     PIC XX.                ERCACCT
   483         16  AM-PUR-MO                     PIC XX.                ERCACCT
   484         16  AM-PUR-DA                     PIC XX.                ERCACCT
   485     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.     ERCACCT
   486     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.     ERCACCT
   487     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.     ERCACCT
   488     12  AM-INACTIVE-DATE.                                        ERCACCT
   489         16  AM-INA-MO                     PIC 99.                ERCACCT
   490         16  AM-INA-DA                     PIC 99.                ERCACCT
   491         16  AM-INA-YR                     PIC 99.                ERCACCT
   492     12  AM-AR-HI-CERT-DATE                PIC XX.                ERCACCT
   493                                                                  ERCACCT
   494     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3. ERCACCT
   495     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3. ERCACCT
   496                                                                  ERCACCT
   497     12  AM-OB-PAYMENT-MODE                PIC X.                 ERCACCT
   498         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.      ERCACCT
   499         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.          ERCACCT
   500         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.          ERCACCT
   501         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.          ERCACCT
   502                                                                  ERCACCT
   503     12  AM-AH-ONLY-INDICATOR              PIC X.                 ERCACCT
   504         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.      ERCACCT
   505         88  AM-NO-AH-ONLY                    VALUE 'N'.          ERCACCT
   506                                                                  ERCACCT
   507     12  AM-EDIT-LOAN-OFC                  PIC X(01).             ERCACCT
   508                                                                  ERCACCT
   509     12  AM-OVER-SHORT.                                           ERCACCT
   510         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3. ERCACCT
   511         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3. ERCACCT
   512                                                                  ERCACCT
   513     12  AM-DCC-PRODUCT-CODE               PIC XXX.
   514     12  AM-DCC-CLP-STATE                  PIC XX.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  12
* ECS010MO.cbl (/apps/prod/cid1p/copy/ERCACCT)
   515                                                                  ERCACCT
   516     12  AM-RECALC-COMM                    PIC X.                 ERCACCT
   517     12  AM-RECALC-REIN                    PIC X.                 ERCACCT
   518                                                                  ERCACCT
   519     12  AM-REI-TABLE                      PIC XXX.               ERCACCT
   520     12  AM-REI-ET-LF                      PIC X.                 ERCACCT
   521     12  AM-REI-ET-AH                      PIC X.                 ERCACCT
   522     12  AM-REI-PE-LF                      PIC X.                 ERCACCT
   523     12  AM-REI-PE-AH                      PIC X.                 ERCACCT
   524     12  AM-REI-PRT-ST                     PIC X.                 ERCACCT
   525     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3. ERCACCT
   526     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3. ERCACCT
   527     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3. ERCACCT
   528     12  AM-REI-GROUP-A                    PIC X(6).              ERCACCT
   529     12  AM-REI-MORT                       PIC X(4).              ERCACCT
   530     12  AM-REI-PRT-OW                     PIC X.                 ERCACCT
   531     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3. ERCACCT
   532     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3. ERCACCT
   533     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3. ERCACCT
   534     12  AM-REI-GROUP-B                    PIC X(6).              ERCACCT
   535                                                                  ERCACCT
   536     12  AM-TRUST-TYPE                     PIC X(2).              ERCACCT
   537                                                                  ERCACCT
   538     12  AM-EMPLOYER-STMT-USED             PIC X.                 ERCACCT
   539     12  AM-GROUPED-CHECKS-Y-N             PIC X.                 ERCACCT
   540                                                                  ERCACCT
   541     12  AM-STD-AH-TYPE                    PIC XX.                ERCACCT
   542     12  AM-EARN-METHODS.                                         ERCACCT
   543         16  AM-EARN-METHOD-R              PIC X.                 ERCACCT
   544             88 AM-REF-RL-R78                 VALUE 'R'.          ERCACCT
   545             88 AM-REF-RL-PR                  VALUE 'P'.          ERCACCT
   546             88 AM-REF-RL-MEAN                VALUE 'M'.          ERCACCT
   547             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.          ERCACCT
   548         16  AM-EARN-METHOD-L              PIC X.                 ERCACCT
   549             88 AM-REF-LL-R78                 VALUE 'R'.          ERCACCT
   550             88 AM-REF-LL-PR                  VALUE 'P'.          ERCACCT
   551             88 AM-REF-LL-MEAN                VALUE 'M'.          ERCACCT
   552             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.          ERCACCT
   553         16  AM-EARN-METHOD-A              PIC X.                 ERCACCT
   554             88 AM-REF-AH-R78                 VALUE 'R'.          ERCACCT
   555             88 AM-REF-AH-PR                  VALUE 'P'.          ERCACCT
   556             88 AM-REF-AH-MEAN                VALUE 'M'.          ERCACCT
   557             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.          ERCACCT
   558             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.          ERCACCT
   559             88 AM-REF-AH-NET                 VALUE 'N'.          ERCACCT
   560                                                                  ERCACCT
   561     12  AM-TOL-PREM                       PIC S999V99    COMP-3. ERCACCT
   562     12  AM-TOL-REF                        PIC S999V99    COMP-3. ERCACCT
   563     12  AM-TOL-CLM                        PIC S999V99    COMP-3. ERCACCT
   564                                                                  ERCACCT
   565     12  AM-RET-Y-N                        PIC X.                 ERCACCT
   566     12  AM-RET-P-E                        PIC X.                 ERCACCT
   567     12  AM-LF-RET                         PIC S9V9999    COMP-3. ERCACCT
   568     12  AM-AH-RET                         PIC S9V9999    COMP-3. ERCACCT
   569     12  AM-RET-GRP                        PIC X(6).              ERCACCT
   570     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.                    ERCACCT
   571         16  AM-POOL-PRIME                 PIC XXX.               ERCACCT
   572         16  AM-POOL-SUB                   PIC XXX.               ERCACCT
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  13
* ECS010MO.cbl (/apps/prod/cid1p/copy/ERCACCT)
   573     12  AM-RETRO-EARNINGS.                                       ERCACCT
   574         16  AM-RET-EARN-R                 PIC X.                 ERCACCT
   575         16  AM-RET-EARN-L                 PIC X.                 ERCACCT
   576         16  AM-RET-EARN-A                 PIC X.                 ERCACCT
   577     12  AM-RET-ST-TAX-USE                 PIC X.                 ERCACCT
   578         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.  ERCACCT
   579         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.      ERCACCT
   580     12  AM-RETRO-BEG-EARNINGS.                                   ERCACCT
   581         16  AM-RET-BEG-EARN-R             PIC X.                 ERCACCT
   582         16  AM-RET-BEG-EARN-L             PIC X.                 ERCACCT
   583         16  AM-RET-BEG-EARN-A             PIC X.                 ERCACCT
   584     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3. ERCACCT
   585     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3. ERCACCT
   586                                                                  ERCACCT
   587     12  AM-USER-SELECT-OPTIONS.                                  ERCACCT
   588         16  AM-USER-SELECT-1              PIC X(10).             ERCACCT
   589         16  AM-USER-SELECT-2              PIC X(10).             ERCACCT
   590         16  AM-USER-SELECT-3              PIC X(10).             ERCACCT
   591         16  AM-USER-SELECT-4              PIC X(10).             ERCACCT
   592         16  AM-USER-SELECT-5              PIC X(10).             ERCACCT
   593                                                                  ERCACCT
   594     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3. ERCACCT
   595                                                                  ERCACCT
   596     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3. ERCACCT
   597                                                                  ERCACCT
   598     12  AM-RPT045A-SWITCH                 PIC X.                 ERCACCT
   599         88  RPT045A-OFF                   VALUE 'N'.             ERCACCT
   600                                                                  ERCACCT
   601     12  AM-INSURANCE-LIMITS.                                     ERCACCT
   602         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3. ERCACCT
   603         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3. ERCACCT
   604                                                                  ERCACCT
   605     12  AM-PROFILE-CHANGE-SWITCH          PIC X.                 ERCACCT
   606         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.          ERCACCT
   607                                                                  ERCACCT
   608     12  AM-DISMBR-COVERAGE-SW             PIC X.                 ERCACCT
   609         88  AM-DISMBR-COVERAGE               VALUE 'Y'.          ERCACCT
   610         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.          ERCACCT
   611                                                                  ERCACCT
   612     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3. ERCACCT
   613                                                                  ERCACCT
   614     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3. ERCACCT
   615     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
   616     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
   617     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
   618     12  AM-DCC-UEF-STATE                  PIC XX.
   619     12  FILLER                            PIC XXX.
   620     12  AM-REPORT-CODE-3                  PIC X(10).
   621*    12  FILLER                            PIC X(22).             ERCACCT
   622                                                                  ERCACCT
   623     12  AM-RESERVE-DATE.                                         ERCACCT
   624         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.    ERCACCT
   625         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.    ERCACCT
   626         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.    ERCACCT
   627                                                                  ERCACCT
   628     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.                ERCACCT
   629     12  AM-NOTIFICATION-TYPES.                                   ERCACCT
   630         16  AM-NOTIF-OF-LETTERS           PIC X.                 ERCACCT
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  14
* ECS010MO.cbl (/apps/prod/cid1p/copy/ERCACCT)
   631         16  AM-NOTIF-OF-PAYMENTS          PIC X.                 ERCACCT
   632         16  AM-NOTIF-OF-REPORTS           PIC X.                 ERCACCT
   633         16  AM-NOTIF-OF-STATUS            PIC X.                 ERCACCT
   634                                                                  ERCACCT
   635     12  AM-BENEFIT-TABLE-USAGE            PIC X.                 ERCACCT
   636         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.          ERCACCT
   637         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.          ERCACCT
   638         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.          ERCACCT
   639         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.     ERCACCT
   640                                                                  ERCACCT
   641     12  AM-BENEFIT-CONTROLS.                                     ERCACCT
   642         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.            ERCACCT
   643             20  AM-BENEFIT-CODE           PIC XX.                ERCACCT
   644             20  AM-BENEFIT-TYPE           PIC X.                 ERCACCT
   645             20  AM-BENEFIT-REVISION       PIC XXX.               ERCACCT
   646             20  AM-BENEFIT-REM-TERM       PIC X.                 ERCACCT
   647             20  AM-BENEFIT-RETRO-Y-N      PIC X.                 ERCACCT
   648             20  FILLER                    PIC XX.                ERCACCT
   649         16  FILLER                        PIC X(80).             ERCACCT
   650                                                                  ERCACCT
   651     12  AM-TRANSFER-DATA.                                        ERCACCT
   652         16  AM-TRANSFERRED-FROM.                                 ERCACCT
   653             20  AM-TRNFROM-CARRIER        PIC X.                 ERCACCT
   654             20  AM-TRNFROM-GROUPING.                             ERCACCT
   655                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.               ERCACCT
   656                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.               ERCACCT
   657             20  AM-TRNFROM-STATE          PIC XX.                ERCACCT
   658             20  AM-TRNFROM-ACCOUNT.                              ERCACCT
   659                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).             ERCACCT
   660                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).              ERCACCT
   661             20  AM-TRNFROM-DTE            PIC XX.                ERCACCT
   662         16  AM-TRANSFERRED-TO.                                   ERCACCT
   663             20  AM-TRNTO-CARRIER          PIC X.                 ERCACCT
   664             20  AM-TRNTO-GROUPING.                               ERCACCT
   665                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.               ERCACCT
   666                 24  AM-TRNTO-GRP-PRIME    PIC XXX.               ERCACCT
   667             20  AM-TRNTO-STATE            PIC XX.                ERCACCT
   668             20  AM-TRNTO-ACCOUNT.                                ERCACCT
   669                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).              ERCACCT
   670                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).              ERCACCT
   671             20  AM-TRNTO-DTE              PIC XX.                ERCACCT
   672         16  FILLER                        PIC X(10).             ERCACCT
   673                                                                  ERCACCT
   674     12  AM-SAVED-REMIT-TO                 PIC 99.                ERCACCT
   675                                                                  ERCACCT
   676     12  AM-COMM-STRUCTURE-SAVED.                                 ERCACCT
   677         16  AM-DEFN-1-SAVED.                                     ERCACCT
   678             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.           ERCACCT
   679                 24  AM-AGT-SV             PIC X(10).             ERCACCT
   680                 24  AM-COM-TYP-SV         PIC X.                 ERCACCT
   681                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3. ERCACCT
   682                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3. ERCACCT
   683                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3. ERCACCT
   684                 24  AM-RECALC-LV-INDIC-SV PIC X.                 ERCACCT
   685                 24  FILLER                PIC X.                 ERCACCT
   686                 24  AM-GL-CODES-SV        PIC X.                 ERCACCT
   687                 24  AM-COM-CHARGEBACK-SV  PIC 99.                ERCACCT
   688                 24  FILLER                PIC X.                 ERCACCT
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  15
* ECS010MO.cbl (/apps/prod/cid1p/copy/ERCACCT)
   689         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.       ERCACCT
   690             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.            ERCACCT
   691                 24  FILLER                PIC X(11).             ERCACCT
   692                 24  AM-L-COMA-SV          PIC XXX.               ERCACCT
   693                 24  AM-J-COMA-SV          PIC XXX.               ERCACCT
   694                 24  AM-A-COMA-SV          PIC XXX.               ERCACCT
   695                 24  FILLER                PIC X(6).              ERCACCT
   696                                                                  ERCACCT
   697     12  AM-FLC-NET-PREMIUM-ALLOWANCE.                            ERCACCT
   698         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.                 ERCACCT
   699            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3. ERCACCT
   700            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3. ERCACCT
   701            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3. ERCACCT
   702                                                                  ERCACCT
   703     12  AM-ORIG-DEALER-NO                 PIC X(10).             ERCACCT
   704     12  FILLER                            PIC X(120).            ERCACCT
   705                                                                  ERCACCT
   706     12  AM-ACCOUNT-EXECUTIVE-DATA.                               ERCACCT
   707         16  AM-CONTROL-NAME               PIC X(30).             ERCACCT
   708         16  AM-EXECUTIVE-ONE.                                    ERCACCT
   709             20  AM-EXEC1-NAME             PIC X(15).             ERCACCT
   710             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)       ERCACCT
   711                                                          COMP-3. ERCACCT
   712             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)       ERCACCT
   713                                                          COMP-3. ERCACCT
   714         16  AM-EXECUTIVE-TWO.                                    ERCACCT
   715             20  AM-EXEC2-NAME             PIC X(15).             ERCACCT
   716             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)       ERCACCT
   717                                                          COMP-3. ERCACCT
   718             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)       ERCACCT
   719                                                          COMP-3. ERCACCT
   720                                                                  ERCACCT
   721     12  AM-RETRO-ADDITIONAL-DATA.                                ERCACCT
   722         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3. ERCACCT
   723         16  AM-RETRO-PREM-P-E             PIC X.                 ERCACCT
   724         16  AM-RETRO-CLMS-P-I             PIC X.                 ERCACCT
   725         16  AM-RETRO-RET-BRACKET-LF.                             ERCACCT
   726             20  AM-RETRO-RET-METHOD-LF    PIC X.                 ERCACCT
   727                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.      ERCACCT
   728                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.          ERCACCT
   729             20  AM-RETRO-RET-BASIS-LF     PIC X.                 ERCACCT
   730                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.      ERCACCT
   731                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.          ERCACCT
   732             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.           ERCACCT
   733                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3. ERCACCT
   734                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3. ERCACCT
   735         16  AM-RETRO-RET-BRACKET-AH.                             ERCACCT
   736             20  AM-RETRO-RET-METHOD-AH    PIC X.                 ERCACCT
   737                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.      ERCACCT
   738                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.          ERCACCT
   739                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.          ERCACCT
   740             20  AM-RETRO-RET-BASIS-AH     PIC X.                 ERCACCT
   741                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.      ERCACCT
   742                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.          ERCACCT
   743             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.           ERCACCT
   744                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3. ERCACCT
   745                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3. ERCACCT
   746                                                                  ERCACCT
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  16
* ECS010MO.cbl (/apps/prod/cid1p/copy/ERCACCT)
   747     12  AM-COMMENTS.                                             ERCACCT
   748         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.ERCACCT
   749                                                                  ERCACCT
   750     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.         ERCACCT
   751         16  AM-FLI-RETRO-SHARE-CODE       PIC X.                 ERCACCT
   752         16  AM-FLI-BILLING-CODE           PIC X.                 ERCACCT
   753         16  AM-FLI-ALT-STATE-CODE         PIC XX.                ERCACCT
   754         16  AM-FLI-UNITED-IDENT           PIC X.                 ERCACCT
   755         16  AM-FLI-INTEREST-LOST-DATA.                           ERCACCT
   756             20  AM-FLI-BANK-NO            PIC X(5).              ERCACCT
   757             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3. ERCACCT
   758             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3. ERCACCT
   759             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3. ERCACCT
   760         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.            ERCACCT
   761             20  AM-FLI-AGT                PIC X(9).              ERCACCT
   762             20  AM-FLI-AGT-COMM-ACC       PIC X.                 ERCACCT
   763             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3. ERCACCT
   764         16  FILLER                        PIC X(102).            ERCACCT
   765                                                                  ERCACCT
   766     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.         ERCACCT
   767         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.          ERCACCT
   768             20  AM-BENEFIT-DMD-CODE         PIC XX.              ERCACCT
   769             20  AM-BENEFIT-DMD-TYPE         PIC X.               ERCACCT
   770             20  AM-BENEFIT-DMD-REVISION     PIC XXX.             ERCACCT
   771             20  AM-BENEFIT-DMD-REM-TERM     PIC X.               ERCACCT
   772             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.               ERCACCT
   773         16  FILLER                          PIC X(10).           ERCACCT
   774******************************************************************ERCACCT
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  17
* ECS010MO.cbl
   776 FD  ERRTBL-IN.
   777
*  778                             COPY ERCREIN.
   779******************************************************************07/27/93
   780*                                                                *ERCREIN
   781*                            ERCREIN                             *   LV009
   782*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   783*                            VMOD=2.010                          *   CL**9
   784*                                                                *ERCREIN
   785*   ONLINE CREDIT SYSTEM                                         *ERCREIN
   786*                                                                *ERCREIN
   787*   FILE DESCRIPTION = REINSURANCE MASTER FILE                   *ERCREIN
   788*                                                                *ERCREIN
   789*   FILE TYPE = VSAM,KSDS                                        *ERCREIN
   790*   RECORD SIZE = 4000  RECFORM = FIXED                          *ERCREIN
   791*                                                                *ERCREIN
   792*   BASE CLUSTER NAME = ERREIN                   RKP=2,LEN=8     *ERCREIN
   793*       ALTERNATE PATH = NONE                                    *ERCREIN
   794*                                                                *ERCREIN
   795*   LOG = NO                                                     *ERCREIN
   796*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *ERCREIN
   797*                                                                *ERCREIN
   798******************************************************************ERCREIN
   799*                   C H A N G E   L O G
   800*
   801* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   802*-----------------------------------------------------------------
   803*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   804* EFFECTIVE    NUMBER
   805*-----------------------------------------------------------------
   806* 103101    2001100100006  SMVA  ADD STATE EXHIBIT REPORT OPTION F
   807* 032707    2007032100006  PEMA  ADD EXCISE TAX CAPABILITY
   808******************************************************************
   809 01  REINSURANCE-RECORD.                                          ERCREIN
   810     12  RE-RECORD-ID                      PIC XX.                ERCREIN
   811         88  VALID-RE-ID                      VALUE 'RE'.         ERCREIN
   812                                                                  ERCREIN
   813     12  RE-CONTROL-PRIMARY.                                      ERCREIN
   814         16  RE-COMPANY-CD                 PIC X.                 ERCREIN
   815         16  RE-KEY.                                              ERCREIN
   816             20  RE-CODE                   PIC X.                 ERCREIN
   817                 88  RE-TABLE-RECORD          VALUE 'A'.          ERCREIN
   818                 88  RE-COMPANY-RECORD        VALUE 'B'.          ERCREIN
   819             20  RE-TABLE                  PIC XXX.               ERCREIN
   820             20  FILLER                    PIC XXX.               ERCREIN
   821         16  RE-COMPANY-KEY REDEFINES RE-KEY.                     ERCREIN
   822             20  FILLER                    PIC X.                 ERCREIN
   823             20  RE-COMPANY.                                      ERCREIN
   824                 24  RE-COMP-PRIME         PIC XXX.               ERCREIN
   825                 24  RE-COMP-SUB           PIC XXX.               ERCREIN
   826                                                                  ERCREIN
   827     12  RE-MAINT-INFORMATION.                                    ERCREIN
   828         16  RE-LAST-MAINT-DT              PIC XX.                ERCREIN
   829         16  RE-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3. ERCREIN
   830         16  RE-LAST-MAINT-USER            PIC X(4).              ERCREIN
   831         16  FILLER                        PIC X(10).             ERCREIN
   832                                                                  ERCREIN
   833     12  RE-TABLE-DATA.                                           ERCREIN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  18
* ECS010MO.cbl (/apps/prod/cid1p/copy/ERCREIN)
   834         16  RE-100-COMP                   PIC 99.                ERCREIN
   835                                                                  ERCREIN
   836         16  RE-COMP-INFO    OCCURS 30 TIMES.                     ERCREIN
   837             20  RE-REI-COMP-NO.                                  ERCREIN
   838                 24  RE-REI-COMP           PIC XXX.               ERCREIN
   839                 24  RE-REI-COMP-SUB       PIC XXX.               ERCREIN
   840             20  RE-LF-QC                  PIC X.                 ERCREIN
   841             20  RE-AH-QC                  PIC X.                 ERCREIN
   842             20  RE-LO-DATE                PIC 9(11)     COMP-3.  ERCREIN
   843             20  RE-HI-DATE                PIC 9(11)     COMP-3.  ERCREIN
   844             20  RE-LFAGE-LO               PIC 99.                ERCREIN
   845             20  RE-LFAGE-HI               PIC 99.                ERCREIN
   846             20  RE-AHAGE-LO               PIC 99.                ERCREIN
   847             20  RE-AHAGE-HI               PIC 99.                ERCREIN
   848             20  RE-LFTRM-LO               PIC S999       COMP-3. ERCREIN
   849             20  RE-LFTRM-HI               PIC S999       COMP-3. ERCREIN
   850             20  RE-AHTRM-LO               PIC S999       COMP-3. ERCREIN
   851             20  RE-AHTRM-HI               PIC S999       COMP-3. ERCREIN
   852             20  RE-LF-PCT                 PIC S9V9999    COMP-3. ERCREIN
   853             20  RE-AH-PCT                 PIC S9V9999    COMP-3. ERCREIN
   854             20  RE-LF-LIM-LO              PIC S9(9)V99   COMP-3. ERCREIN
   855             20  RE-LF-LIM-HI              PIC S9(9)V99   COMP-3. ERCREIN
   856             20  RE-LF-LO                  PIC S9(9)V99   COMP-3. ERCREIN
   857             20  RE-LF-HI                  PIC S9(9)V99   COMP-3. ERCREIN
   858             20  RE-AHBEN-LIM-LO           PIC S9(7)V99   COMP-3. ERCREIN
   859             20  RE-AHBEN-LIM-HI           PIC S9(7)V99   COMP-3. ERCREIN
   860             20  RE-AHBEN-LO               PIC S9(7)V99   COMP-3. ERCREIN
   861             20  RE-AHBEN-HI               PIC S9(7)V99   COMP-3. ERCREIN
   862             20  RE-AHMOA-LIM-LO           PIC S9(7)V99   COMP-3. ERCREIN
   863             20  RE-AHMOA-LIM-HI           PIC S9(7)V99   COMP-3. ERCREIN
   864             20  RE-AHMOA-LO               PIC S9(7)V99   COMP-3. ERCREIN
   865             20  RE-AHMOA-HI               PIC S9(7)V99   COMP-3. ERCREIN
   866             20  RE-LF-BEN-CODE            PIC X.                 ERCREIN
   867             20  RE-AH-BEN-CODE            PIC X.                 ERCREIN
   868             20  RE-INTERACTIVE            PIC X.                 ERCREIN
   869             20  RE-REMAINING              PIC X.                 ERCREIN
   870             20  RE-LF-RUNOFF-SW           PIC X.                      000
   871             20  RE-AH-RUNOFF-SW           PIC X.                      000
   872             20  FILLER                    PIC X(19).                  000
   873                                                                  ERCREIN
   874         16  RE-COMP-INFO-END              PIC X(6).              ERCREIN
   875         16  RE-NSP-ST-CD-LF               PIC XX.                ERCREIN
   876         16  RE-NSP-ST-CD-AH               PIC XX.                ERCREIN
   877         16  RE-TABLE-CARRIER-SECURITY     PIC X.                 ERCREIN
   878             88  NO-TABLE-CARRIER-SECURITY    VALUE SPACE.        ERCREIN
   879                                                                  ERCREIN
   880         16  FILLER                        PIC X(27).             ERCREIN
   881                                                                  ERCREIN
   882     12  RE-COMPANY-DATA   REDEFINES   RE-TABLE-DATA.             ERCREIN
   883         16  RE-NAME                       PIC X(30).             ERCREIN
   884         16  RE-LF-PE                      PIC X.                 ERCREIN
   885         16  RE-AH-PE                      PIC X.                 ERCREIN
   886         16  RE-LF-FEE                     PIC S9V9999    COMP-3. ERCREIN
   887         16  RE-AH-FEE                     PIC S9V9999    COMP-3. ERCREIN
   888         16  RE-AH-PR-PCT                  PIC S9V9999    COMP-3. ERCREIN
   889         16  RE-AH-78-PCT                  PIC S9V9999    COMP-3. ERCREIN
   890         16  RE-PRT-ST                     PIC X.                 ERCREIN
   891         16  RE-PRT-OW                     PIC X.                 ERCREIN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  19
* ECS010MO.cbl (/apps/prod/cid1p/copy/ERCREIN)
   892         16  RE-MORT-CODE                  PIC X(4).              ERCREIN
   893         16  RE-CLAIM-CODE                 PIC X.                 ERCREIN
   894         16  RE-ZERO-LF-FEE                PIC X.                 ERCREIN
   895         16  RE-ZERO-AH-FEE                PIC X.                 ERCREIN
   896         16  RE-CEDE-NAME                  PIC X(30).             ERCREIN
   897         16  RE-LF-COMM                    PIC X.                 ERCREIN
   898         16  RE-AH-COMM                    PIC X.                 ERCREIN
   899         16  RE-LF-TAX                     PIC X.                 ERCREIN
   900         16  RE-AH-TAX                     PIC X.                 ERCREIN
   901         16  RE-CLM-INCURRED-LIM           PIC 9(11)  COMP-3.     ERCREIN
   902         16  RE-LF-IBNR-PCT                PIC SV999      COMP-3. ERCREIN
   903         16  RE-AH-IBNR-PCT                PIC SV999      COMP-3. ERCREIN
   904                                                                  ERCREIN
   905         16  RE-COMP-CARRIER-SECURITY      PIC X.                 ERCREIN
   906             88  NO-COMP-CARRIER-SECURITY     VALUE SPACE.        ERCREIN
   907                                                                  ERCREIN
   908         16  RE-LF-CEDING-FEE-BRACKETS.                           ERCREIN
   909             20  RE-LF-FEE-METHOD          PIC X.                 ERCREIN
   910                 88  RE-LF-FEE-BRACKETED         VALUE '1' '2'.   ERCREIN
   911                 88  RE-LF-FEE-METHOD-1          VALUE '1'.       ERCREIN
   912                 88  RE-LF-FEE-METHOD-2          VALUE '2'.       ERCREIN
   913                 88  RE-LF-FEE-PERCENT           VALUE ' ' 'P'.   ERCREIN
   914             20  RE-LF-FEE-BASIS           PIC X.                 ERCREIN
   915                 88  RE-LF-GROSS-CEDED             VALUE '1'.     ERCREIN
   916                 88  RE-LF-NET-CEDED               VALUE '2'.     ERCREIN
   917                 88  RE-LF-GROSS-WRITTEN           VALUE '3'.     ERCREIN
   918                 88  RE-LF-NET-WRITTEN             VALUE '4'.     ERCREIN
   919                 88  RE-LF-COMBINE-GROSS-CEDED     VALUE '5'.     ERCREIN
   920                 88  RE-LF-COMBINE-NET-CEDED       VALUE '6'.     ERCREIN
   921                 88  RE-LF-COMBINE-GROSS-WRITTEN   VALUE '7'.     ERCREIN
   922                 88  RE-LF-COMBINE-NET-WRITTEN     VALUE '8'.     ERCREIN
   923             20  FILLER                    PIC XXX.               ERCREIN
   924             20  RE-LF-FEE-RANGES  OCCURS 6 TIMES.                ERCREIN
   925                 24  RE-LF-FEE-RANGE-PCT   PIC S9V9999    COMP-3. ERCREIN
   926                 24  RE-LF-FEE-THRU-AMT    PIC S9(7)V99   COMP-3. ERCREIN
   927                                                                  ERCREIN
   928         16  RE-AH-CEDING-FEE-BRACKETS.                           ERCREIN
   929             20  RE-AH-FEE-METHOD          PIC X.                 ERCREIN
   930                 88  RE-AH-FEE-BRACKETED         VALUE '1' '2'.   ERCREIN
   931                 88  RE-AH-FEE-METHOD-1          VALUE '1'.       ERCREIN
   932                 88  RE-AH-FEE-METHOD-2          VALUE '2'.       ERCREIN
   933                 88  RE-AH-FEE-PERCENT           VALUE ' ' 'P'.   ERCREIN
   934             20  RE-AH-FEE-BASIS           PIC X.                 ERCREIN
   935                 88  RE-AH-GROSS-CEDED             VALUE '1'.     ERCREIN
   936                 88  RE-AH-NET-CEDED               VALUE '2'.     ERCREIN
   937                 88  RE-AH-GROSS-WRITTEN           VALUE '3'.     ERCREIN
   938                 88  RE-AH-NET-WRITTEN             VALUE '4'.     ERCREIN
   939                 88  RE-AH-COMBINE-GROSS-CEDED     VALUE '5'.     ERCREIN
   940                 88  RE-AH-COMBINE-NET-CEDED       VALUE '6'.     ERCREIN
   941                 88  RE-AH-COMBINE-GROSS-WRITTEN   VALUE '7'.     ERCREIN
   942                 88  RE-AH-COMBINE-NET-WRITTEN     VALUE '8'.     ERCREIN
   943             20  FILLER                    PIC XXX.               ERCREIN
   944             20  RE-AH-FEE-RANGES  OCCURS 6 TIMES.                ERCREIN
   945                 24  RE-AH-FEE-RANGE-PCT   PIC S9V9999    COMP-3. ERCREIN
   946                 24  RE-AH-FEE-THRU-AMT    PIC S9(7)V99   COMP-3. ERCREIN
   947                                                                  ERCREIN
   948         16  RE-EARNING-START-DT           PIC 9(11)  COMP-3.     ERCREIN
   949                                                                  ERCREIN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  20
* ECS010MO.cbl (/apps/prod/cid1p/copy/ERCREIN)
   950         16  RE-OLD-CEDING-STMT            PIC X.                    CL**4
   951                                                                  ERCREIN
   952         16  RE-LF-CLM-PCT                 PIC S9V9999    COMP-3. ERCREIN
   953         16  RE-AH-CLM-PCT                 PIC S9V9999    COMP-3. ERCREIN
   954         16  RE-LF-CLM-MAX                 PIC S9(7)V99   COMP-3. ERCREIN
   955         16  RE-AH-CLM-MAX                 PIC S9(7)V99   COMP-3. ERCREIN
   956         16  RE-LF-PR-PCT                  PIC S9V9999    COMP-3. ERCREIN
   957         16  RE-LF-78-PCT                  PIC S9V9999    COMP-3. ERCREIN
   958         16  RE-REINS-GROUPING-CODE        PIC X(6).              ERCREIN
   959         16  RE-MORT-SW                    PIC X.                 ERCREIN
   960         16  RE-CEDING-TYPE-FLAG           PIC X.                    CL**2
   961             88  RE-NO-CESSION-TYPE                VALUE ' '.        CL**2
   962             88  RE-CEDED                          VALUE 'C'.        CL**2
   963             88  RE-ASSUMED                        VALUE 'A'.        CL**2
   964             88  RE-PHANTOM                        VALUE 'P'.        CL**2
   965                                                                  ERCREIN
   966         16  RE-CEDING-STMT-OPT-A          PIC X.                    CL**3
   967             88  REPORT-A-WANTED    VALUE ' ' 'Y'.                   CL**3
   968         16  RE-CEDING-STMT-OPT-B          PIC X.                    CL**3
   969             88  REPORT-B-WANTED    VALUE ' ' 'Y'.                   CL**3
   970         16  RE-CEDING-STMT-OPT-C          PIC X.                    CL**3
   971             88  REPORT-C-WANTED    VALUE ' ' 'Y'.                   CL**3
   972         16  RE-CEDING-STMT-OPT-D          PIC X.                    CL**3
   973             88  REPORT-D-WANTED    VALUE ' ' 'Y'.                   CL**3
   974         16  RE-CEDING-STMT-OPT-E          PIC X.                    CL**3
   975             88  REPORT-E-WANTED    VALUE ' ' 'Y'.                   CL**3
   976                                                                     CL**3
   977         16  RE-PRT-CRSV                   PIC X.                    CL**5
   978                                                                     CL**5
   979         16  RE-GL-CENTER                  PIC X(4).                 CL**6
   980                                                                     CL**8
   981         16  RE-CUSTODIAL-BAL              PIC S9(7)V99   COMP-3.    CL**8
   982                                                                     CL**8
   983         16  RE-EARNING-STOP-DT            PIC 9(11)  COMP-3.        CL**9
   984                                                                     CL**9
   985         16  RE-EARN-STOP-CODE             PIC X.                    CL**9
   986             88  STOP-LIFE-EARNING  VALUE 'L' 'B'.                   CL**9
   987             88  STOP-AH-EARNING    VALUE 'A' 'B'.                   CL**9
   988
   989         16  RE-STATE-EXHIBIT-OPT-F        PIC X.
   990             88  RPTF-ECS152-WANTED VALUE ' ' 'Y'.
   991                                                                     CL**9
   992         16  RE-EXCISE-TAX                 PIC S9V9999 COMP-3.
   993         16  FILLER                        PIC X(2281).              CL**9
   994                                                                  ERCREIN
   995         16  RE-DESC OCCURS 18 TIMES       PIC X(79).             ERCREIN
   996                                                                  ERCREIN
   997******************************************************************ERCREIN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  21
* ECS010MO.cbl
   999 FD  ERCTBL.
  1000
* 1001                             COPY ERCCTBL.
  1002******************************************************************04/29/98
  1003*                                                                *ERCCTBL
  1004*                                                                *ERCCTBL
  1005*                            ERCCTBL                             *   LV002
  1006*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  1007*                            VMOD=2.003                              CL**2
  1008*                                                                *ERCCTBL
  1009*   ONLINE CREDIT SYSTEM                                         *ERCCTBL
  1010*                                                                *ERCCTBL
  1011*   FILE DESCRIPTION = COMPENSATION TABLE                        *ERCCTBL
  1012*                                                                *ERCCTBL
  1013*   FILE TYPE = VSAM,KSDS                                        *ERCCTBL
  1014*   RECORD SIZE = 200   RECFORM = FIXED                          *ERCCTBL
  1015*                                                                *ERCCTBL
  1016*   BASE CLUSTER NAME = ERCTBL                   RKP=2,LEN=7     *ERCCTBL
  1017*       ALTERNATE PATH = NONE                                    *ERCCTBL
  1018*                                                                *ERCCTBL
  1019*   LOG = NO                                                     *ERCCTBL
  1020*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *ERCCTBL
  1021*                                                                *ERCCTBL
  1022*                                                                *ERCCTBL
  1023******************************************************************ERCCTBL
  1024                                                                  ERCCTBL
  1025 01  COMM-TABLE-RECORD.                                           ERCCTBL
  1026     12  CT-RECORD-ID                      PIC XX.                ERCCTBL
  1027         88  VALID-CT-ID                      VALUE 'CT'.         ERCCTBL
  1028                                                                  ERCCTBL
  1029     12  CT-CONTROL-PRIMARY.                                      ERCCTBL
  1030         16  CT-COMPANY-CD                 PIC X.                 ERCCTBL
  1031         16  CT-TABLE                      PIC XXX.               ERCCTBL
  1032         16  CT-CNTRL-2.                                          ERCCTBL
  1033             20  CT-BEN-TYPE               PIC X.                 ERCCTBL
  1034             20  CT-BEN-CODE               PIC XX.                ERCCTBL
  1035                                                                  ERCCTBL
  1036     12  CT-MAINT-INFORMATION.                                    ERCCTBL
  1037         16  CT-LAST-MAINT-DT              PIC XX.                ERCCTBL
  1038         16  CT-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3. ERCCTBL
  1039         16  CT-LAST-MAINT-USER            PIC X(4).              ERCCTBL
  1040         16  FILLER                        PIC X(31).             ERCCTBL
  1041                                                                  ERCCTBL
  1042     12  CT-LIMITS.                                               ERCCTBL
  1043         16  CT-TBF OCCURS 3 TIMES         PIC S9(7)V99   COMP-3. ERCCTBL
  1044                                                                  ERCCTBL
  1045         16  CT-AGE OCCURS 3 TIMES         PIC S99        COMP-3. ERCCTBL
  1046                                                                  ERCCTBL
  1047         16  CT-TRM OCCURS 3 TIMES         PIC S999       COMP-3. ERCCTBL
  1048                                                                  ERCCTBL
  1049     12  CT-RATES.                                                ERCCTBL
  1050         16  CT-RTX          OCCURS 27 TIMES.                     ERCCTBL
  1051             20  CT-RT                     PIC SV9(5)     COMP-3. ERCCTBL
  1052             20  CT-RT-R   REDEFINES                              ERCCTBL
  1053                 CT-RT                     PIC XXX.               ERCCTBL
  1054                                                                  ERCCTBL
  1055     12  FILLER                            PIC  X(42).            ERCCTBL
  1056                                                                  ERCCTBL
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  22
* ECS010MO.cbl
  1057******************************************************************ERCCTBL
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  23
* ECS010MO.cbl
  1059 FD  ERMEBL-INOUT.
  1060
* 1061                             COPY ERCMEBL.
  1062******************************************************************
  1063*
  1064*
  1065*                            ERCMEBL                             *
  1066*                                                                *
  1067*    FILE DESCRIPTION = REPOSITORY FOR MONTH-END BALANCES FROM   *
  1068*                       SEVERAL PROGRAMS (IDENTIFIED IN BYTES    *
  1069*                       4-6 OF THE FIELD NAMES) AND BY EL541     *
  1070*                       FOR REPORTING DISCREPANCIES AND RUN TIME.*
  1071*                                                                *
  1072*    FILE TYPE = VSAM, KSDS                                      *
  1073*    RECORD SIZE = 765       RECFORM = FIXED                     *
  1074*                                                                *
  1075*    BASE CLUSTER = ERMEBL         KEY SIZE  =  5                *
  1076*    ALTERNATE PATHS = NONE        STARTING IN  3                *
  1077*                                                                *
  1078******************************************************************
  1079
  1080******************************************************************
  1081*                   C H A N G E   L O G
  1082*
  1083* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1084*-----------------------------------------------------------------
  1085*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1086* EFFECTIVE    NUMBER
  1087*-----------------------------------------------------------------
  1088* 070714  CR2013060600001  PEMA  AUTOMATE EOM BALANCING
  1089******************************************************************
  1090 01  MONTH-END-BALANCES.
  1091     12  ME-RECORD-ID            PIC  XX.
  1092     12  ME-CONTROL-PRIMARY.
  1093         16  ME-COMPANY          PIC  XXX.
  1094         16  ME-MOYR             PIC  9999       COMP.
  1095     12  ME-010-PREM-L           PIC S9(9)V99    COMP-3.
  1096     12  ME-010-PREM-AH          PIC S9(9)V99    COMP-3.
  1097     12  ME-010-REF-L            PIC S9(9)V99    COMP-3.
  1098     12  ME-010-REF-AH           PIC S9(9)V99    COMP-3.
  1099     12  ME-010-NET-L            PIC S9(9)V99    COMP-3.
  1100     12  ME-010-NET-AH           PIC S9(9)V99    COMP-3.
  1101     12  ME-010-COMM-L           PIC S9(9)V99    COMP-3.
  1102     12  ME-010-COMM-AH          PIC S9(9)V99    COMP-3.
  1103     12  ME-010-PMT-L            PIC S9(9)V99    COMP-3.
  1104     12  ME-010-PMT-AH           PIC S9(9)V99    COMP-3.
  1105     12  ME-010-CERT-IN          PIC S9(7)       COMP-3.
  1106     12  ME-010-CERT-OUT         PIC S9(7)       COMP-3.
  1107     12  ME-010-DUP-ISS          PIC S9(7)       COMP-3.
  1108     12  ME-010-RUN-DT           PIC  9(6)       COMP-3.
  1109*    12  ME-010-START            PIC  9(6)       COMP-3.
  1110*    12  ME-010-END              PIC  9(6)       COMP-3.
  1111     12  ME-010-RUN-CT           PIC S9(3)       COMP-3.
  1112     12  ME-018-COMM-Y           PIC S9(9)V99    COMP-3.
  1113     12  ME-018-COMM-1           PIC S9(9)V99    COMP-3.
  1114     12  ME-018-OW-Y             PIC S9(9)V99    COMP-3.
  1115     12  ME-018-OW-1             PIC S9(9)V99    COMP-3.
  1116     12  ME-018-RUN-DT           PIC  9(6)       COMP-3.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  24
* ECS010MO.cbl (/apps/prod/cid1p/copy/ERCMEBL)
  1117*    12  ME-018-START            PIC  9(6)       COMP-3.
  1118*    12  ME-018-END              PIC  9(6)       COMP-3.
  1119     12  ME-018-RUN-CT           PIC S9(3)       COMP-3.
  1120     12  ME-019-PREM-L           PIC S9(9)V99    COMP-3.
  1121     12  ME-019-PREM-AH          PIC S9(9)V99    COMP-3.
  1122     12  ME-019-REF-L            PIC S9(9)V99    COMP-3.
  1123     12  ME-019-REF-AH           PIC S9(9)V99    COMP-3.
  1124     12  ME-019-COMM-L           PIC S9(9)V99    COMP-3.
  1125     12  ME-019-COMM-AH          PIC S9(9)V99    COMP-3.
  1126     12  ME-019-OR-L             PIC S9(9)V99    COMP-3.
  1127     12  ME-019-OR-AH            PIC S9(9)V99    COMP-3.
  1128     12  ME-019-RUN-DT           PIC  9(6)       COMP-3.
  1129*    12  ME-019-START            PIC  9(6)       COMP-3.
  1130*    12  ME-019-END              PIC  9(6)       COMP-3.
  1131     12  ME-019-RUN-CT           PIC S9(3)       COMP-3.
  1132     12  ME-030-CLMS-L           PIC S9(9)V99    COMP-3.
  1133     12  ME-030-CLMS-AH          PIC S9(9)V99    COMP-3.
  1134     12  ME-030-RUN-DT           PIC  9(6)       COMP-3.
  1135*    12  ME-030-START            PIC  9(6)       COMP-3.
  1136*    12  ME-030-END              PIC  9(6)       COMP-3.
  1137     12  ME-030-RUN-CT           PIC S9(3)       COMP-3.
  1138     12  ME-032-RESV-L           PIC S9(9)V99    COMP-3.
  1139     12  ME-032-RESV-AH          PIC S9(9)V99    COMP-3.
  1140     12  ME-032-RUN-DT           PIC  9(6)       COMP-3.
  1141*    12  ME-032-START            PIC  9(6)       COMP-3.
  1142*    12  ME-032-END              PIC  9(6)       COMP-3.
  1143     12  ME-032-RUN-CT           PIC S9(3)       COMP-3.
  1144     12  ME-035-NET-L            PIC S9(9)V99    COMP-3.
  1145     12  ME-035-NET-AH           PIC S9(9)V99    COMP-3.
  1146     12  ME-035-RUN-DT           PIC S9(6)       COMP-3.
  1147*    12  ME-035-START            PIC S9(6)       COMP-3.
  1148*    12  ME-035-END              PIC S9(6)       COMP-3.
  1149     12  ME-035-RUN-CT           PIC S9(3)       COMP-3.
  1150     12  ME-038-RECS-IN          PIC S9(7)       COMP-3.
  1151     12  ME-038-RECS-OUT         PIC S9(7)       COMP-3.
  1152     12  ME-038-RUN-DT           PIC  9(6)       COMP-3.
  1153*    12  ME-038-START            PIC  9(6)       COMP-3.
  1154*    12  ME-038-END              PIC  9(6)       COMP-3.
  1155     12  ME-038-RUN-CT           PIC S9(3)       COMP-3.
  1156     12  ME-041-RETROS           PIC S9(9)V99    COMP-3.
  1157     12  ME-041-RUN-DT           PIC  9(6)       COMP-3.
  1158*    12  ME-041-START            PIC  9(6)       COMP-3.
  1159*    12  ME-041-END              PIC  9(6)       COMP-3.
  1160     12  ME-041-RUN-CT           PIC S9(3)       COMP-3.
  1161     12  ME-050-CERT-IN          PIC S9(7)       COMP-3.
  1162     12  ME-050-CERT-OUT         PIC S9(7)       COMP-3.
  1163*    12  ME-050-START            PIC  9(6)       COMP-3.
  1164     12  ME-050-RUN-DT           PIC  9(6)       COMP-3.
  1165*    12  ME-050-END              PIC  9(6)       COMP-3.
  1166     12  ME-050-RUN-CT           PIC S9(3)       COMP-3.
  1167     12  ME-061-PREM             PIC S9(9)V99    COMP-3.
  1168     12  ME-061-COMM             PIC S9(9)V99    COMP-3.
  1169     12  ME-061-OR               PIC S9(9)V99    COMP-3.
  1170     12  ME-061-PY-ADJ           PIC S9(9)V99    COMP-3.
  1171     12  ME-061-COMM-RCALC       PIC S9(9)V99    COMP-3.
  1172     12  ME-061-OR-RCALC         PIC S9(9)V99    COMP-3.
  1173     12  ME-061-PREM-RCALC       PIC S9(9)V99    COMP-3.
  1174     12  ME-061-RUN-DT           PIC  9(6)       COMP-3.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  25
* ECS010MO.cbl (/apps/prod/cid1p/copy/ERCMEBL)
  1175*    12  ME-061-START            PIC  9(6)       COMP-3.
  1176*    12  ME-061-END              PIC  9(6)       COMP-3.
  1177     12  ME-061-RUN-CT           PIC S9(3)       COMP-3.
  1178     12  ME-080-MORT-ERRS        PIC  9(7)       COMP-3.
  1179     12  ME-080-RUN-DT           PIC  9(6)       COMP-3.
  1180*    12  ME-080-START            PIC  9(6)       COMP-3.
  1181*    12  ME-080-END              PIC  9(6)       COMP-3.
  1182     12  ME-080-RUN-CT           PIC S9(3)       COMP-3.
  1183     12  ME-315-RESV-L           PIC S9(9)V99    COMP-3.
  1184     12  ME-315-RESV-AH          PIC S9(9)V99    COMP-3.
  1185     12  ME-315-RUN-DT           PIC  9(6)       COMP-3.
  1186*    12  ME-315-START            PIC  9(6)       COMP-3.
  1187*    12  ME-315-END              PIC  9(6)       COMP-3.
  1188     12  ME-315-RUN-CT           PIC S9(3)       COMP-3.
  1189     12  ME-331-FLAG             PIC  9.
  1190     12  ME-331-RUN-DT           PIC  9(6)       COMP-3.
  1191*    12  ME-331-START            PIC  9(6)       COMP-3.
  1192*    12  ME-331-END              PIC  9(6)       COMP-3.
  1193     12  ME-331-RUN-CT           PIC S9(3)       COMP-3.
  1194     12  ME-341-NOT-FOUND        PIC S9(7)       COMP-3.
  1195     12  ME-341-RUN-DT           PIC  9(6)       COMP-3.
  1196*    12  ME-341-START            PIC  9(6)       COMP-3.
  1197*    12  ME-341-END              PIC  9(6)       COMP-3.
  1198     12  ME-341-RUN-CT           PIC S9(3)       COMP-3.
  1199     12  ME-501-FLAG             PIC  9.
  1200     12  ME-501-RUN-DT           PIC  9(6)       COMP-3.
  1201     12  ME-501-START            PIC  9(6)       COMP-3.
  1202     12  ME-501-END              PIC  9(6)       COMP-3.
  1203     12  ME-501-RUN-CT           PIC S9(3)       COMP-3.
  1204     12  ME-509-FLAG             PIC  9.
  1205     12  ME-509-RUN-DT           PIC  9(6)       COMP-3.
  1206     12  ME-509-START            PIC  9(6)       COMP-3.
  1207     12  ME-509-END              PIC  9(6)       COMP-3.
  1208     12  ME-509-RUN-CT           PIC S9(3)       COMP-3.
  1209     12  ME-522-PY-ADJ           PIC S9(9)V99    COMP-3.
  1210     12  ME-522-RETROS           PIC S9(9)V99    COMP-3.
  1211     12  ME-522-PROC-CLM-L       PIC S9(9)V99    COMP-3.
  1212     12  ME-522-PROC-CLM-AH      PIC S9(9)V99    COMP-3.
  1213     12  ME-522-ALL-CLM-L        PIC S9(9)V99    COMP-3.
  1214     12  ME-522-ALL-CLM-AH       PIC S9(9)V99    COMP-3.
  1215     12  ME-522-PROC-RSV-L       PIC S9(9)V99    COMP-3.
  1216     12  ME-522-PROC-RSV-AH      PIC S9(9)V99    COMP-3.
  1217     12  ME-522-ALL-RSV-L        PIC S9(9)V99    COMP-3.
  1218     12  ME-522-ALL-RSV-AH       PIC S9(9)V99    COMP-3.
  1219     12  ME-522-PREM-L           PIC S9(9)V99    COMP-3.
  1220     12  ME-522-PREM-AH          PIC S9(9)V99    COMP-3.
  1221     12  ME-522-REF-L            PIC S9(9)V99    COMP-3.
  1222     12  ME-522-REF-AH           PIC S9(9)V99    COMP-3.
  1223     12  ME-522-RUN-DT           PIC  9(6)       COMP-3.
  1224     12  ME-522-START            PIC  9(6)       COMP-3.
  1225     12  ME-522-END              PIC  9(6)       COMP-3.
  1226     12  ME-522-RUN-CT           PIC S9(3)       COMP-3.
  1227     12  ME-524-CLMS-L           PIC S9(9)V99    COMP-3.
  1228     12  ME-524-CLMS-AH          PIC S9(9)V99    COMP-3.
  1229     12  ME-524-RESV-L           PIC S9(9)V99    COMP-3.
  1230     12  ME-524-RESV-AH          PIC S9(9)V99    COMP-3.
  1231     12  ME-524-RUN-DT           PIC  9(6)       COMP-3.
  1232     12  ME-524-START            PIC  9(6)       COMP-3.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  26
* ECS010MO.cbl (/apps/prod/cid1p/copy/ERCMEBL)
  1233     12  ME-524-END              PIC  9(6)       COMP-3.
  1234     12  ME-524-RUN-CT           PIC S9(3)       COMP-3.
  1235     12  ME-525-FLAG             PIC  9.
  1236     12  ME-525-RUN-DT           PIC  9(6)       COMP-3.
  1237     12  ME-525-START            PIC  9(6)       COMP-3.
  1238     12  ME-525-END              PIC  9(6)       COMP-3.
  1239     12  ME-525-RUN-CT           PIC S9(3)       COMP-3.
  1240     12  ME-048-RECS-IN          PIC S9(7)       COMP-3.
  1241     12  ME-048-RECS-OUT         PIC S9(7)       COMP-3.
  1242     12  ME-048-RUN-DT           PIC  9(6)       COMP-3.
  1243     12  ME-048-START            PIC  9(6)       COMP-3.
  1244     12  ME-048-END              PIC  9(6)       COMP-3.
  1245     12  ME-048-RUN-CT           PIC S9(3)       COMP-3.
  1246     12  ME-041-REIN-ADJ         PIC S9(9)V99    COMP-3.
  1247
  1248     12  ME-019-CLMS-L           PIC S9(9)V99    COMP-3.
  1249     12  ME-019-CLMS-AH          PIC S9(9)V99    COMP-3.
  1250     12  ME-035-COMM-TOT         PIC S9(9)V99    COMP-3.
  1251     12  ME-035-CLMS-L           PIC S9(9)V99    COMP-3.
  1252     12  ME-035-CLMS-AH          PIC S9(9)V99    COMP-3.
  1253     12  ME-041-RECS-IN          PIC S9(9)       COMP-3.
  1254     12  ME-041-RECS-OUT         PIC S9(9)       COMP-3.
  1255     12  ME-050-ACT-L            PIC S9(7)       COMP-3.
  1256     12  ME-050-ACT-AH           PIC S9(7)       COMP-3.
  1257     12  ME-061-CLMS             PIC S9(9)V99    COMP-3.
  1258     12  ME-341-CLMS-L           PIC S9(9)V99    COMP-3.
  1259     12  ME-341-CLMS-AH          PIC S9(9)V99    COMP-3.
  1260     12  ME-515-CLMS-WRAP        PIC S9(7)V99    COMP-3.
  1261     12  ME-515-RESV-WRAP        PIC S9(7)V99    COMP-3.
  1262     12  ME-317-CLMS-TOT         PIC S9(9)V99    comp-3.
  1263     12  ME-325-CLMS-TOT         PIC S9(9)V99    comp-3.
  1264     12  ME-020-PREM-TOT         PIC S9(11)V99   COMP-3.
  1265     12  ME-020-CLMS-TOT         PIC S9(9)V99    COMP-3.
  1266     12  ME-020-RESV-TOT         PIC S9(9)V99    COMP-3.
  1267     12  ME-063-OW               PIC S9(9)V99    COMP-3.
  1268     12  ME-082-ACT-L            PIC S9(7)       COMP-3.
  1269     12  ME-082-ACT-AH           PIC S9(7)       COMP-3.
  1270     12  ME-016-RECS-IN          PIC S9(9)       COMP-3.
  1271     12  ME-016-RECS-OUT         PIC S9(9)       COMP-3.
  1272     12  ME-562-PREM-TOT         PIC S9(9)V99    COMP-3.
  1273     12  ME-562-COMM-TOT         PIC S9(9)V99    COMP-3.
  1274     12  ME-524-CLMS-TOT-CM      PIC S9(9)V99    comp-3.
  1275     12  ME-523-PREM-TOT         PIC S9(9)V99    COMP-3.
  1276     12  ME-064-BEG-BAL          PIC S9(9)V99    COMP-3.
  1277     12  ME-064-END-BAL          PIC S9(9)V99    COMP-3.
  1278     12  ME-010-MM-PREM-TOT      PIC S9(9)V99    COMP-3.
  1279     12  ME-010-MM-TOT-CLMS      PIC S9(9)V99    COMP-3.
  1280     12  ME-010-MM-TOT-RESV      PIC S9(9)V99    COMP-3.
  1281     12  ME-080-MORT-RESV        PIC S9(9)V99    COMP-3.
  1282
  1283     12  FILLER                  PIC  X(09).
  1284*    12  FILLER                  PIC  X(88).
  1285******************************************************************
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  27
* ECS010MO.cbl
  1287 FD  CERT-MASTER-OUT
* 1288                             COPY ECSCROFD.
  1289******************************************************************07/10/97
  1290*                                                                *ECSCROFD
  1291*                            ECSCROFD                            *   LV001
  1292*                            VMOD=2.002                          *ECSCROFD
  1293*                                                                *ECSCROFD
  1294*  NO CID MODS IN COPYBOOK ECSCROFD.                             *ECSCROFD
  1295*                                                                *ECSCROFD
  1296******************************************************************ECSCROFD
  1297     RECORDING MODE F                                             ECSCROFD
  1298     LABEL RECORDS STANDARD                                       ECSCROFD
  1299     BLOCK CONTAINS 0 RECORDS
  1300     RECORD CONTAINS 1056 CHARACTERS.                             ECSCROFD
  1301 01  CERT-OUT-RECORD.                                             ECSCROFD
  1302     12  FILLER                            PIC  XXX.              ECSCROFD
  1303     12  COR-CONTROL                       PIC  X(36).            ECSCROFD
  1304     12  FILLER                            PIC  X(1017).          ECSCROFD
  1305                                                                  ECSCROFD
  1306******************************************************************ECSCROFD
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  28
* ECS010MO.cbl
  1308 FD  DETAIL-EXTR
  1309     BLOCK CONTAINS 0 RECORDS
  1310     RECORDING MODE F.
  1311
* 1312                             COPY ECSEXT01.
  1313******************************************************************04/29/98
  1314*                                                                *ECSEXT01
  1315*                            ECSEXT01                            *   LV015
  1316*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL*15
  1317*                            VMOD=2.015                          *ECSEXT01
  1318*                                                                *ECSEXT01
  1319*   FILE DESCRIPTION =  DETAIL EXTRACTS                          *ECSEXT01
  1320*                       (PREMIUM, COMM., CLAIMS, AND RESERVES)   *ECSEXT01
  1321*                                                                *ECSEXT01
  1322*   FILE TYPE = SEQUENTIAL                                       *ECSEXT01
  1323*   RECORD SIZE = 510  RECFORM = FIXED                           *ECSEXT01
  1324*                                                                *ECSEXT01
  1325*   KEY DATA =                                   START=5, LEN=36 *ECSEXT01
  1326*                                                                *ECSEXT01
  1327******************************************************************ECSEXT01
  1328******************************************************************
  1329*                   C H A N G E   L O G
  1330*
  1331* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1332*-----------------------------------------------------------------
  1333*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1334* EFFECTIVE    NUMBER
  1335*-----------------------------------------------------------------
  1336* 040504    2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  1337* 042110  CR2010010400006  PEMA  ADD FIELDS FOR EMERALD 032
  1338* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  1339* 071211  CR2010012700001  PEMA  ADD SPP DEALER DIRECT
  1340* 112911  CR2011083000003  PEMA  ADD SPPDDF TRUNCATED
  1341* 032612  CR2011110200001  PEMA  AHL CHANGES
  1342******************************************************************
  1343                                                                  ECSEXT01
  1344 01  DETAIL-EXTRACT.                                              ECSEXT01
  1345     02 DETAIL-FILE.                                              ECSEXT01
  1346     12  DE-RECORD-ID                      PIC XX.                ECSEXT01
  1347         88  VALID-DE-ID                      VALUE 'DE'.         ECSEXT01
  1348                                                                  ECSEXT01
  1349     12  DE-COMPANY-CD                     PIC X.                 ECSEXT01
  1350                                                                  ECSEXT01
  1351     12  DE-REIN                           PIC X.                 ECSEXT01
  1352                                                                  ECSEXT01
  1353     12  DE-CONTROL.                                              ECSEXT01
  1354         16  DE-CNTRL1.                                           ECSEXT01
  1355             20  DE-CARRIER                PIC X.                 ECSEXT01
  1356             20  DE-GROUPING.                                     ECSEXT01
  1357                 24  DE-GROUP-PREFIX       PIC XXX.               ECSEXT01
  1358                 24  DE-GROUP-PRIME        PIC XXX.               ECSEXT01
  1359             20  DE-STATE                  PIC XX.                ECSEXT01
  1360             20  DE-ACCOUNT.                                      ECSEXT01
  1361                 24  DE-ACCT-PREFIX        PIC X(4).              ECSEXT01
  1362                 24  DE-ACCT-PRIME         PIC X(6).              ECSEXT01
  1363         16  DE-CNTRL2.                                           ECSEXT01
  1364             20  DE-EFF                    PIC 9(11)  COMP-3.     ECSEXT01
  1365             20  DE-CERT.                                         ECSEXT01
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  29
* ECS010MO.cbl (/apps/prod/cid1p/copy/ECSEXT01)
  1366                 24 DE-CERT-NO.                                   ECSEXT01
  1367                     28  DE-CRT-PREFIX     PIC XXX.               ECSEXT01
  1368                     28  DE-CRT-PRIME      PIC X(7).              ECSEXT01
  1369                 24  DE-CRT-SUF            PIC X.                 ECSEXT01
  1370                                                                  ECSEXT01
  1371     12  DE-TRANS                          PIC X.                 ECSEXT01
  1372         88  DE-ISSUE                         VALUE 'I'.          ECSEXT01
  1373         88  DE-RC-ISSUE                      VALUE '8'.          ECSEXT01
  1374         88  DE-CANCEL                        VALUE 'C'.          ECSEXT01
  1375         88  DE-RC-CANCEL                     VALUE '7'.          ECSEXT01
  1376         88  DE-CLAIM                         VALUE 'X'.          ECSEXT01
  1377         88  DE-RESTORE                       VALUE 'R'.          ECSEXT01
  1378         88  DE-RESERVE                       VALUE 'Y'.          ECSEXT01
  1379         88  DE-RR-RC-ISS                     VALUE 'J'.          ECSEXT01
  1380         88  DE-RR-RC-CNC                     VALUE 'K'.          ECSEXT01
  1381         88  DE-RR-RC-CLM                     VALUE 'L'.          ECSEXT01
  1382                                                                  ECSEXT01
  1383     12  DE-REPORT-CODE-1                  PIC X(10).             ECSEXT01
  1384     12  DE-REPORT-CODE-2                  PIC X(10).             ECSEXT01
  1385                                                                  ECSEXT01
  1386     12  DE-NAME.                                                 ECSEXT01
  1387         16  DE-LNAME                      PIC X(15).             ECSEXT01
  1388         16  DE-FNAME.                                            ECSEXT01
  1389             20  DE-1ST-INIT-FNAME         PIC X.                 ECSEXT01
  1390             20  FILLER                    PIC X(9).              ECSEXT01
  1391         16  DE-INIT                       PIC X.                 ECSEXT01
  1392     12  DE-AGE                            PIC 99.                ECSEXT01
  1393     12  DE-SEX                            PIC X.                 ECSEXT01
  1394     12  DE-SOC-SEC-NO                     PIC X(11).             ECSEXT01
  1395                                                                  ECSEXT01
  1396     12  DE-LF-TYPE                        PIC XX.                ECSEXT01
  1397     12  DE-LF-TERM                        PIC 999        COMP-3. ECSEXT01
  1398     12  DE-LF-BEN                         PIC S9(9)V99   COMP-3. ECSEXT01
  1399     12  DE-LF-CNBEN                       PIC S9(9)V99   COMP-3. ECSEXT01
  1400     12  DE-LF-PRM                         PIC S9(7)V99   COMP-3. ECSEXT01
  1401     12  DE-LF-BEN-ALT                     PIC S9(9)V99   COMP-3. ECSEXT01
  1402     12  DE-LF-CNBEN-ALT                   PIC S9(9)V99   COMP-3. ECSEXT01
  1403     12  DE-LF-PRM-ALT                     PIC S9(7)V99   COMP-3. ECSEXT01
  1404     12  DE-LF-RFND                        PIC S9(7)V99   COMP-3. ECSEXT01
  1405                                                                  ECSEXT01
  1406     12  DE-LF-STAT-CDE                    PIC X.                 ECSEXT01
  1407     12  DE-LF-PREV-STAT                   PIC X.                 ECSEXT01
  1408     12  DE-LF-CANC-DTE                    PIC 9(11)      COMP-3. ECSEXT01
  1409     12  DE-LF-CANC-EXIT-DT                PIC 9(11)      COMP-3. ECSEXT01
  1410                                                                  ECSEXT01
  1411     12  DE-AH-TYPE                        PIC XX.                ECSEXT01
  1412     12  DE-AH-TERM                        PIC 999        COMP-3. ECSEXT01
  1413     12  DE-AH-BEN                         PIC S9(7)V99   COMP-3. ECSEXT01
  1414     12  DE-AH-PRM                         PIC S9(7)V99   COMP-3. ECSEXT01
  1415     12  DE-AH-RFND                        PIC S9(7)V99   COMP-3. ECSEXT01
  1416                                                                  ECSEXT01
  1417     12  DE-AH-STAT-CDE                    PIC X.                 ECSEXT01
  1418     12  DE-AH-PREV-STAT                   PIC X.                 ECSEXT01
  1419     12  DE-AH-CANC-DTE                    PIC 9(11)  COMP-3.     ECSEXT01
  1420     12  DE-AH-CANC-EXIT-DT                PIC 9(11)  COMP-3.     ECSEXT01
  1421                                                                  ECSEXT01
  1422     12  DE-LIVES                          PIC S9(7)      COMP-3. ECSEXT01
  1423     12  DE-ADDL-CLP REDEFINES DE-LIVES
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  30
* ECS010MO.cbl (/apps/prod/cid1p/copy/ECSEXT01)
  1424                                           PIC S9(5)V99   COMP-3.
  1425     12  DE-NUM-BILLED                     PIC S9(7)      COMP-3. ECSEXT01
  1426     12  FILLER REDEFINES DE-NUM-BILLED.
  1427         16  DE-CLP-STATE                  PIC XX.
  1428         16  DE-DCC-DDF-REM-TRM3           PIC S999       COMP-3.
  1429     12  DE-CANCEL-CNT-ITD                 PIC S999       COMP-3. ECSEXT01
  1430     12  DE-CANCEL-CNT-YTD                 PIC S999       COMP-3. ECSEXT01
  1431                                                                  ECSEXT01
  1432     12  DE-APR                            PIC S999V9(4)  COMP-3. ECSEXT01
  1433     12  DE-PMT-FREQ                       PIC 99.                ECSEXT01
  1434     12  DE-ACC-GPCD                       PIC XX.                ECSEXT01
  1435     12  DE-IG                             PIC X.                 ECSEXT01
  1436     12  DE-REMIT-TO                       PIC XX.                ECSEXT01
  1437*    12  DE-MEMBER-NO                      PIC X(12).             ECSEXT01
  1438     12  DE-MEMBER-NO.                                            ECSEXT01
  1439         16  DE-MASTER-POLICY              PIC X(06).             ECSEXT01
  1440         16  DE-ZIP                        PIC 9(05)    COMP-3.   ECSEXT01
  1441         16  FILLER                        PIC X(03).             ECSEXT01
  1442     12  DE-LN-OFFICER                     PIC XXX.               ECSEXT01
  1443                                                                  ECSEXT01
  1444     12  DE-AUTO-GEND-IND                  PIC X.                 ECSEXT01
  1445         88  DE-AUTO-GEND-REINS            VALUE 'R'.             ECSEXT01
  1446                                                                  ECSEXT01
  1447     12  DE-ENTRY-STATUS                   PIC X.                 ECSEXT01
  1448     12  DE-ENTRY-DTE                      PIC 9(11)      COMP-3. ECSEXT01
  1449                                                                  ECSEXT01
  1450     12  DE-REI-AREA.                                             ECSEXT01
  1451         16  DE-REI-COMP.                                         ECSEXT01
  1452             20  DE-REINCO                 PIC XXX.               ECSEXT01
  1453             20  DE-REINCO-SUB             PIC XXX.               ECSEXT01
  1454         16  DE-REI-LFAMT                  PIC S9(9)V99   COMP-3. ECSEXT01
  1455         16  DE-REI-LFPRM                  PIC S9(7)V99   COMP-3. ECSEXT01
  1456         16  DE-REI-LFRFND                 PIC S9(7)V99   COMP-3. ECSEXT01
  1457         16  DE-REI-AHAMT                  PIC S9(7)V99   COMP-3. ECSEXT01
  1458         16  DE-REI-AHPRM                  PIC S9(7)V99   COMP-3. ECSEXT01
  1459         16  DE-REI-AHRFND                 PIC S9(7)V99   COMP-3. ECSEXT01
  1460         16  DE-REI-CNAMT                  PIC S9(9)V99   COMP-3. ECSEXT01
  1461                                                                  ECSEXT01
  1462     12  DE-MOB-NET-TOT-FEES               PIC S9(7)V99   COMP-3.
  1463     12  FILLER REDEFINES DE-MOB-NET-TOT-FEES.
  1464         16  DE-IU-RATE-UP                 PIC S9(5)V99 COMP-3.
  1465         16  F                             PIC X.
  1466*    12  FILLER                            PIC X(5).              ECSEXT01
  1467                                                                  ECSEXT01
  1468     12  DE-BILLED-AREA.                                          ECSEXT01
  1469         16  DE-GL-INTERFACE-CODES.                               ECSEXT01
  1470             20  DE-GL-CODES               PIC X  OCCURS 10 TIMES.ECSEXT01
  1471                                                                  ECSEXT01
  1472         16  DE-BILL-SW                    PIC X.                 ECSEXT01
  1473             88  DE-RECORD-ON-HOLD            VALUE 'H'.          ECSEXT01
  1474             88  DE-RECORD-RETURNED           VALUE 'R'.          ECSEXT01
  1475             88  DE-RECORD-ENDORSED           VALUE 'E'.          ECSEXT01
  1476             88  DE-OVERRIDE-LIFE             VALUE 'L'.          ECSEXT01
  1477             88  DE-OVERRIDE-AH               VALUE 'A'.          ECSEXT01
  1478             88  DE-OVERRIDE-BOTH             VALUE 'B'.          ECSEXT01
  1479                                                                  ECSEXT01
  1480         16  DE-REFUND-SW                  PIC X.                 ECSEXT01
  1481             88  DE-REFUND-CREATED            VALUE 'Y'.          ECSEXT01
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  31
* ECS010MO.cbl (/apps/prod/cid1p/copy/ECSEXT01)
  1482                                                                  ECSEXT01
  1483         16  DE-BILLED-LFPRM               PIC S9(7)V99   COMP-3. ECSEXT01
  1484         16  DE-BILLED-LFRFND              PIC S9(7)V99   COMP-3. ECSEXT01
  1485         16  DE-BILLED-AHPRM               PIC S9(7)V99   COMP-3. ECSEXT01
  1486         16  DE-BILLED-AHRFND              PIC S9(7)V99   COMP-3. ECSEXT01
  1487                                                                  ECSEXT01
  1488         16  DE-GA-BILL-STATUS             PIC X  OCCURS 5 TIMES. ECSEXT01
  1489*            88  DE-NO-PRE-BILL-GA            VALUE ' '.          ECSEXT01
  1490*            88  DE-BILLED-GA                 VALUE 'B'.          ECSEXT01
  1491                                                                  ECSEXT01
  1492     12  DE-BILL-STATUS                    PIC X.                 ECSEXT01
  1493         88  DE-NO-PRE-BILL                   VALUE ' '.          ECSEXT01
  1494         88  DE-BILLED                        VALUE 'B'.          ECSEXT01
  1495         88  DE-REVERSE                       VALUE 'R'.          ECSEXT01
  1496                                                                  ECSEXT01
  1497     12  DE-REVERSE-REASONS.                                      ECSEXT01
  1498         16  DE-REVERSE-REASON-1           PIC X.                 ECSEXT01
  1499         16  DE-REVERSE-REASON-2           PIC X.                 ECSEXT01
  1500     12  DE-CANCEL-REASON                  PIC X.
  1501                                                                  ECSEXT01
  1502     12  DE-RECALC-CODE                    PIC X.                 ECSEXT01
  1503     12  DE-RECALC-TYPE                    PIC X.                 ECSEXT01
  1504                                                                  ECSEXT01
  1505     12  DE-CHARGEBACK-CODES.                                     ECSEXT01
  1506         16  DE-LF-COMM-CHARGEBACK         PIC X.                 ECSEXT01
  1507             88  DE-NO-LF-CHARGEBACK          VALUE 'N'.          ECSEXT01
  1508         16  DE-AH-COMM-CHARGEBACK         PIC X.                 ECSEXT01
  1509             88  DE-NO-AH-CHARGEBACK          VALUE 'N'.          ECSEXT01
  1510                                                                  ECSEXT01
  1511     12  DE-UNDERWRITING-CODE              PIC X.                 ECSEXT01
  1512         88  DE-POLICY-UNDERWRITTEN           VALUE 'Y'.          ECSEXT01
  1513                                                                  ECSEXT01
  1514     12  DE-NCL-POOL-CODE                  PIC XXX.               ECSEXT01
  1515     12  FILLER REDEFINES DE-NCL-POOL-CODE.
  1516         16  DE-LOAN-TERM                  PIC S999 COMP-3.
  1517         16  FILLER                        PIC X.
  1518                                                                  ECSEXT01
  1519****************************************************************  ECSEXT01
  1520**** CLAIM EXTRACT AND RESERVE EXTRACT IS REDEFINED AT THIS POINT ECSEXT01
  1521****************************************************************  ECSEXT01
  1522     12  DE-COMM-LEVELS.                                          ECSEXT01
  1523         16  DE-AGT-LEVELS     OCCURS  10  TIMES.                 ECSEXT01
  1524             20  DE-AGT.                                          ECSEXT01
  1525                 24  DE-AGT-PREFIX         PIC X(4).              ECSEXT01
  1526                 24  DE-AGT-PRIME          PIC X(6).              ECSEXT01
  1527             20  DE-AGT-TYPE               PIC X.                 ECSEXT01
  1528             20  DE-L-PC                   PIC SV9(5)     COMP-3. ECSEXT01
  1529             20  DE-A-PC                   PIC SV9(5)     COMP-3. ECSEXT01
  1530                                                                  ECSEXT01
  1531     12  DE-PROC-DT                        PIC 9(11)      COMP-3. ECSEXT01
  1532****************************************************************  ECSEXT01
  1533*******                 CLAIM EXTRACT                      *****  ECSEXT01
  1534****************************************************************  ECSEXT01
  1535     02 DE-CLAIM-EXTRACT     REDEFINES     DETAIL-FILE.           ECSEXT01
  1536     12  FILLER                            PIC X(334).            ECSEXT01
  1537     12  DE-TYPE                           PIC X.                 ECSEXT01
  1538         88  DE-DTH                           VALUE '1'.          ECSEXT01
  1539         88  DE-AH                            VALUE '2'.          ECSEXT01
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  32
* ECS010MO.cbl (/apps/prod/cid1p/copy/ECSEXT01)
  1540         88  DE-OB-DTH                        VALUE '3'.          ECSEXT01
  1541         88  DE-OB-AH                         VALUE '4'.          ECSEXT01
  1542         88  DE-DEATH                         VALUES '1' '3'.     ECSEXT01
  1543         88  DE-DISABILITY                    VALUES '2' '4'.     ECSEXT01
  1544                                                                  ECSEXT01
  1545     12  DE-CLAIM-AMT                      PIC S9(9)V99   COMP-3. ECSEXT01
  1546     12  DE-REI-CLAIM-AMT                  PIC S9(9)V99   COMP-3. ECSEXT01
  1547                                                                  ECSEXT01
  1548     12  DE-INCUR                          PIC 9(11)      COMP-3. ECSEXT01
  1549     12  DE-REPORTED.                                             ECSEXT01
  1550         16  DE-RPT-YR                     PIC 99.                ECSEXT01
  1551         16  DE-RPT-MO                     PIC 99.                ECSEXT01
  1552         16  DE-RPT-DA                     PIC 99.                ECSEXT01
  1553     12  DE-PAY                            PIC 9(11)      COMP-3. ECSEXT01
  1554     12  DE-PAID-TO                        PIC 9(11)      COMP-3. ECSEXT01
  1555                                                                  ECSEXT01
  1556     12  DE-CNUM                           PIC X(7).              ECSEXT01
  1557     12  DE-CHECK                          PIC X(7).              ECSEXT01
  1558     12  DE-PMT-TRAILER-SEQ                PIC S9(4)       COMP.  ECSEXT01
  1559     12  DE-DAYS-DISAB                     PIC 999.               ECSEXT01
  1560     12  DE-CLM-AGE                        PIC 99.                ECSEXT01
  1561     12  DE-PAY-CODE                       PIC X.                 ECSEXT01
  1562         88  DE-PARTIAL-PAYMENT               VALUE 'P'.          ECSEXT01
  1563         88  DE-FINAL-PAYMENT                 VALUE 'F'.          ECSEXT01
  1564         88  DE-LUMP-SUM-PAYMENT              VALUE 'S'.          ECSEXT01
  1565         88  DE-ADDITIONAL-PAYMENT            VALUE 'X'.          ECSEXT01
  1566         88  DE-CHARGEABLE-EXPENSE            VALUE 'E'.          ECSEXT01
  1567         88  DE-NON-CHARGEABLE-EXPENSE        VALUE 'E'.          ECSEXT01
  1568         88  DE-VOIDED-PAYMENT                VALUE 'V'.          ECSEXT01
  1569                                                                  ECSEXT01
  1570     12  DE-CLM-ERR                        PIC XX.                ECSEXT01
  1571                                                                  ECSEXT01
  1572     12  DE-ACC-NAME                       PIC X(30).             ECSEXT01
  1573     12  DE-ACC-EXP-DTE                    PIC 9(11)  COMP-3.     ECSEXT01
  1574     12  DE-ACC-EFF-DTE                    PIC 9(11)  COMP-3.     ECSEXT01
  1575     12  FILLER                            PIC XX.                ECSEXT01
  1576     12  DE-LOAN-OFFICER                   PIC XXX.               ECSEXT01
  1577                                                                  ECSEXT01
  1578     12  DE-LOAN-TYPE                      PIC X(02).             ECSEXT01
  1579     12  DE-BENEFICIARY                    PIC X(10).
  1580     12  filler redefines de-beneficiary.
  1581         16  de-birth-date                 pic 9(11)  comp-3.
  1582         16  f                             pic x(4).
  1583     12  DE-LOAN-CLASS                     PIC X(02).             ECSEXT01
  1584     12  DE-LOSS-CODE                      PIC X(06).             ECSEXT01
  1585     12  DE-ASSOCIATES                     PIC X(01).             ECSEXT01
  1586     12  DE-LEGAL-STATE                    PIC X(02).             ECSEXT01
  1587     12  DE-CLM-CAUSE                      PIC X(6).              ECSEXT01
  1588     12  DE-CLM-CLASS                      PIC XX.
  1589     12  DE-CLM-DEV                        PIC XXX.
  1590     12  DE-XYCOR-CLAIM-NO                 PIC X(9).
  1591     12  de-xycor-cert-seq                 pic x(3).
  1592     12  DE-XYCOR-CHECK-NO                 PIC X(8).
  1593     12  DE-XYCOR-ACTION-CD                PIC XXX.
  1594     12  DE-XYCOR-STATUS                   PIC X.
  1595     12  FILLER                            PIC X(4).              ECSEXT01
  1596                                                                  ECSEXT01
  1597     12  DE-CLM-PROC-DT                    PIC 9(11)  COMP-3.        CL**2
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  33
* ECS010MO.cbl (/apps/prod/cid1p/copy/ECSEXT01)
  1598                                                                  ECSEXT01
  1599****************************************************************  ECSEXT01
  1600*******               RESERVE EXTRACT                      *****  ECSEXT01
  1601****************************************************************  ECSEXT01
  1602     02 DE-RESERVE-EXTRACT     REDEFINES     DETAIL-FILE.         ECSEXT01
  1603     12  FILLER                            PIC X(334).            ECSEXT01
  1604                                                                  ECSEXT01
  1605     12  DE-RESERVE-TYPE                   PIC X.                 ECSEXT01
  1606         88  DE-LIFE-RSV                      VALUE '1' '3'.      ECSEXT01
  1607         88  DE-AH-RSV                        VALUE '2' '4'.      ECSEXT01
  1608                                                                  ECSEXT01
  1609     12  DE-IBNR                           PIC S9(7)V99   COMP-3. ECSEXT01
  1610     12  DE-PAYCUR                         PIC S9(7)V99   COMP-3. ECSEXT01
  1611     12  DE-FUTRSV                         PIC S9(7)V99   COMP-3. ECSEXT01
  1612                                                                  ECSEXT01
  1613     12  DE-CLMNO                          PIC X(7).              ECSEXT01
  1614                                                                  ECSEXT01
  1615     12  DE-RSV-INCUR                      PIC 9(11)      COMP-3. ECSEXT01
  1616     12  DE-RSV-REPORTED.                                         ECSEXT01
  1617         16  DE-RSV-RPT-YR                 PIC 99.                ECSEXT01
  1618         16  DE-RSV-RPT-MO                 PIC 99.                ECSEXT01
  1619         16  DE-RSV-RPT-DA                 PIC 99.                ECSEXT01
  1620     12  DE-RSV-PAYTO                      PIC 9(11)      COMP-3. ECSEXT01
  1621                                                                  ECSEXT01
  1622     12  DE-REI-IBNR                       PIC S9(7)V99   COMP-3. ECSEXT01
  1623     12  DE-REI-PAYCUR                     PIC S9(7)V99   COMP-3. ECSEXT01
  1624     12  DE-REI-FUTRSV                     PIC S9(7)V99   COMP-3. ECSEXT01
  1625                                                                  ECSEXT01
  1626     12  DE-RSV-ACC-NAME                   PIC X(30).             ECSEXT01
  1627     12  DE-ACC-EXP-DTE-RSV                PIC 9(11)      COMP-3. ECSEXT01
  1628     12  DE-ACC-EFF-DTE-RSV                PIC 9(11)      COMP-3. ECSEXT01
  1629                                                                  ECSEXT01
  1630     12  DE-MANUAL-RSV-SWITCH              PIC X.                 ECSEXT01
  1631                                                                  ECSEXT01
  1632     12  DE-RATE-CLASS                     PIC XX.
  1633     12  DE-DEV-CODE                       PIC XXX.
  1634     12  DE-RSV-REM-TERM                   PIC S999       COMP-3.
  1635     12  DE-RSV-REM-BENEFIT                PIC S9(9)V99   COMP-3.
  1636     12  FILLER                            PIC X(58).             ECSEXT01
  1637                                                                  ECSEXT01
  1638     12  DE-RSV-PROC-DT                    PIC 9(11)  COMP-3.        CL**2
  1639******************************************************************ECSEXT01
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  34
* ECS010MO.cbl
  1641 FD  SUMMARY-EXTR
  1642     BLOCK CONTAINS 0 RECORDS
  1643     RECORDING MODE F.
  1644
* 1645                             COPY ECSEPC01.
  1646******************************************************************
  1647*                                                                *
  1648*                            ECSEPC01                            *
  1649*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1650*                            VMOD=2.008                          *
  1651*                                                                *
  1652*   FILE DESCRIPTION =  EARNED PREM / EARNED COMM  (E.P.E.C.)    *
  1653*                                                                *
  1654*   FILE TYPE = SEQUENTIAL                                       *
  1655*   RECORD SIZE = 325  RECFORM = FIXED                           *
  1656*                                                                *
  1657*   KEY DATA =                                  START=5, LEN=31  *
  1658*                                                                *
  1659*  NO  CID  MODS  IN  COPYBOOK  ECSEPC01                         *
  1660*                                                                *
  1661******************************************************************
  1662
  1663 01  EP-RECORD.
  1664     02 EP-FILE.
  1665     12  EP-RECORD-ID                      PIC XX.
  1666         88  VALID-EP-ID                      VALUE 'EP'.
  1667
  1668     12  EP-COMPANY-CD                     PIC X.
  1669
  1670     12  EP-REIN                           PIC X.
  1671         88  EP-REIN-EXTRACT                  VALUE 'R'.
  1672
  1673     12  EP-CONTROL.
  1674         16  EP-CNTRL-1.
  1675             20  EP-COMPANY.
  1676                 24  EP-CARRIER            PIC X.
  1677                 24  EP-GROUPING.
  1678                     28  EP-GROUP-PREFIX   PIC XXX.
  1679                     28  EP-GROUP-PRIME    PIC XXX.
  1680             20  EP-STATE                  PIC XX.
  1681             20  EP-ACCOUNT.
  1682                 24  EP-ACCT-PREFIX        PIC X(4).
  1683                 24  EP-ACCT-PRIME         PIC X(6).
  1684         16  EP-CNTRL-2.
  1685             20  EP-DATES.
  1686                 24  EP-EXP-DTE            PIC 9(11)   COMP-3.
  1687                 24  EP-EFF-DTE            PIC 9(11)   COMP-3.
  1688
  1689     12  EP-REI-CO.
  1690         16  EP-REINCO                     PIC XXX.
  1691         16  EP-REINCO-SUB                 PIC XXX.
  1692
  1693     12  EP-RCD-TYPE                       PIC X.
  1694         88  EP-BEN-TYPE-LIFE                 VALUE 'L'.
  1695         88  EP-BEN-TYPE-AH                   VALUE 'A'.
  1696         88  EP-BEN-TYPE-PROPERTY             VALUE 'P'.
  1697         88  EP-BEN-TYPE-UNEMPLOYMENT         VALUE 'U'.
  1698         88  EP-BEN-TYPE-DISMEMBURMENT        VALUE 'D'.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  35
* ECS010MO.cbl (/apps/prod/cid1p/copy/ECSEPC01)
  1699         88  EP-BEN-TYPE-AD-D                 VALUE 'E'.
  1700     12  EP-BEN-CODE                       PIC XX.
  1701     12  FILLER                            PIC X.
  1702
  1703     12  EP-ISS-CNT                        PIC S9(7)      COMP-3.
  1704     12  EP-ISS-BEN                        PIC S9(11)V99  COMP-3.
  1705     12  EP-ISS-BEN-GROSS                  PIC S9(11)V99  COMP-3.
  1706
  1707     12  EP-CNC-CNT                        PIC S9(7)      COMP-3.
  1708     12  EP-CNC-BEN                        PIC S9(11)V99  COMP-3.
  1709     12  EP-CNC-BEN-GROSS                  PIC S9(11)V99  COMP-3.
  1710
  1711     12  EP-ISS-PRM                        PIC S9(9)V99   COMP-3.
  1712     12  EP-ISS-PRM-GROSS                  PIC S9(9)V99   COMP-3.
  1713     12  EP-CNC-PRM                        PIC S9(9)V99   COMP-3.
  1714     12  EP-CNC-PRM-GROSS                  PIC S9(9)V99   COMP-3.
  1715
  1716     12  EP-PRM-78                         PIC S9(9)V99   COMP-3.
  1717     12  EP-PRM-PR                         PIC S9(9)V99   COMP-3.
  1718     12  EP-PRM-ST                         PIC S9(9)V99   COMP-3.
  1719
  1720     12  EP-CLM-AMT                        PIC S9(9)V99   COMP-3.
  1721     12  EP-CLM-CNT                        PIC S9(7)      COMP-3.
  1722     12  EP-CLM-CRT                        PIC S9(7)      COMP-3.
  1723
  1724     12  EP-CLM-DU                         PIC S9(7)V99   COMP-3.
  1725     12  EP-CLM-PV                         PIC S9(7)V99   COMP-3.
  1726     12  EP-CLM-IBNR                       PIC S9(7)V99   COMP-3.
  1727     12  EP-LOSS-RESV                      PIC S9(7)V99   COMP-3.
  1728     12  EP-CLAIM-ADJ                      PIC S9(7)V99   COMP-3.
  1729
  1730     12  EP-RETRO-EXPENSES                 PIC S9(7)V99   COMP-3.
  1731     12  EP-RETRO-PAYMENTS                 PIC S9(7)V99   COMP-3.
  1732     12  EP-RETRO-OTH-COMM                 PIC S9(7)V99   COMP-3.
  1733
  1734     12  EP-MORT-RESV                      PIC S9(11)V9(6) COMP-3.
  1735     12  EP-IN-FORCE                       PIC S9(11)V99   COMP-3.
  1736     12  EP-ADJUST                         PIC S9(7)V99    COMP-3.
  1737
  1738     12  EP-SPECIFIC-OPT-RSV-FIELDS.
  1739         16  EP-LIFE-YEARS                 PIC S9(9)      COMP-3.
  1740         16  EP-NEW-DATA-IND               PIC X(01).
  1741             88  EP-NEW-DATA                   VALUE 'Y'.
  1742         16  EP-CLM-EXP                    PIC S9(9)V99   COMP-3.
  1743         16  FILLER                        PIC X(19).
  1744
  1745     12  EP-PRM-78-ADJ                     PIC S9(9)V99   COMP-3.
  1746     12  EP-PRM-PR-ADJ                     PIC S9(9)V99   COMP-3.
  1747     12  EP-PRM-ST-ADJ                     PIC S9(9)V99   COMP-3.
  1748
  1749     12  FILLER                            PIC XXX.
  1750
  1751     12  EP-UNDERWRITING-CODE              PIC X.
  1752         88  EP-UNDERWRITTEN-DATA             VALUE 'Y'.
  1753
  1754     12  EP-PRM-TAX                        PIC S9(7)V99   COMP-3.
  1755
  1756     12  FILLER                            PIC X(29).
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  36
* ECS010MO.cbl (/apps/prod/cid1p/copy/ECSEPC01)
  1757*    12  FILLER                            PIC X(34).
  1758
  1759     12  EP-AVG-AGE                        PIC S9(3)      COMP-3.
  1760     12  EP-AVG-ORIG-TERM                  PIC S9(3)      COMP-3.
  1761     12  EP-WEIGHTED-AGE                   PIC S9(3)      COMP-3.
  1762     12  EP-WEIGHTED-ORIG-TERM             PIC S9(3)      COMP-3.
  1763     12  EP-AVG-REM-TERM                   PIC S9(3)      COMP-3.
  1764     12  EP-INFORCE-CNT                    PIC S9(9)      COMP-3.
  1765
  1766     12  EP-HI-COV-DT                      PIC 9(11)      COMP-3.
  1767
  1768     12  EP-HI-CERT                        PIC 9(11)      COMP-3.
  1769     12  EP-LO-CERT                        PIC 9(11)      COMP-3.
  1770
  1771     12  EP-PURGE                          PIC X.
  1772         88  EP-DATA-FROM-PURGED-CERTS        VALUE 'P'.
  1773
  1774     12  EP-RUN-DTE                        PIC 9(11)      COMP-3.
  1775
  1776     02 EC-RECORD     REDEFINES     EP-FILE.
  1777     12  EC-RECORD-ID                      PIC XX.
  1778         88  VALID-EC-ID                      VALUE 'EC'.
  1779
  1780     12  EC-COMPANY-CD                     PIC X.
  1781
  1782     12  EC-REIN                           PIC X.
  1783         88  EC-REIN-EXTRACT                  VALUE 'R'.
  1784
  1785     12  EC-CONTROL.
  1786         16  EC-CARRIER                    PIC X.
  1787         16  EC-GROUPING.
  1788             20  EC-GROUP-PREFIX           PIC XXX.
  1789             20  EC-GROUP-PRIME            PIC XXX.
  1790         16  EC-STATE                      PIC XX.
  1791         16  EC-ACCOUNT.
  1792             20  EC-ACCT-PREFIX            PIC X(4).
  1793             20  EC-ACCT-PRIME             PIC X(6).
  1794         16  EC-DATES.
  1795             20  EC-EXP-DTE                PIC 9(11)    COMP-3.
  1796             20  EC-EFF-DTE                PIC 9(11)    COMP-3.
  1797
  1798     12  EC-REI-CO.
  1799         16  EC-REINCO                     PIC XXX.
  1800         16  EC-REINCO-SUB                 PIC XXX.
  1801
  1802     12  EC-RCD-TYPE                       PIC X.
  1803         88  EC-BEN-TYPE-LIFE                 VALUE 'L'.
  1804         88  EC-BEN-TYPE-AH                   VALUE 'A'.
  1805         88  EC-BEN-TYPE-PROPERTY             VALUE 'P'.
  1806         88  EC-BEN-TYPE-UNEMPLOYMENT         VALUE 'U'.
  1807         88  EC-BEN-TYPE-DISMEMBURMENT        VALUE 'D'.
  1808     12  EC-BEN-CODE                       PIC XX.
  1809     12  EC-SEQ-NBR                        PIC X.
  1810         88  EC-COMP-LEVELS-1-5               VALUE '1'.
  1811         88  EC-COMP-LEVELS-6-10              VALUE '2'.
  1812
  1813     12  EC-AGENTS-DATA.
  1814         16  EC-AGENTS-LEVEL     OCCURS   5   TIMES.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  37
* ECS010MO.cbl (/apps/prod/cid1p/copy/ECSEPC01)
  1815             20  EC-AGT-NO.
  1816                 24  EC-AGT-PREFIX         PIC X(4).
  1817                 24  EC-AGT-PRIME          PIC X(6).
  1818             20  EC-AGT-TYPE               PIC X.
  1819             20  EC-ISS-COMM               PIC S9(9)V99   COMP-3.
  1820             20  EC-CNC-COMM               PIC S9(9)V99   COMP-3.
  1821             20  EC-COMM-78                PIC S9(9)V99   COMP-3.
  1822             20  EC-COMM-PR                PIC S9(9)V99   COMP-3.
  1823             20  EC-COMM-ST                PIC S9(9)V99   COMP-3.
  1824
  1825     12  EC-UNDERWRITING-CODE              PIC X.
  1826         88  EC-UNDERWRITTEN-DATA             VALUE 'Y'.
  1827
  1828     12  EC-AGENTS-DATA-II.
  1829         16  EC-AGENTS-LEVEL-II  OCCURS   5   TIMES.
  1830             20  EC-COMM-78-ADJ            PIC S9(9)V99   COMP-3.
  1831             20  EC-COMM-PR-ADJ            PIC S9(9)V99   COMP-3.
  1832
  1833     12  FILLER                            PIC X(7).
  1834
  1835     12  EC-PURGE                          PIC X.
  1836         88  EC-DATA-FROM-PURGED-CERTS        VALUE 'P'.
  1837
  1838     12  EC-RUN-DTE                        PIC 9(11)     COMP-3.
  1839
  1840******************************************************************
  1841
  1842 FD  ERRESC-IN.
* 1843                             COPY ERCRESC.
  1844******************************************************************04/29/98
  1845*                                                                *ERCRESC
  1846*                            ERCRESC                             *   LV002
  1847*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  1848*                            VMOD=2.003                          *   CL**2
  1849*                                                                *ERCRESC
  1850*   FILE DESCRIPTION = ACCOUNT RESIDENT STATE COMMISSION         *ERCRESC
  1851*                                                                *ERCRESC
  1852*   FILE TYPE = VSAM,KSDS                                        *ERCRESC
  1853*   RECORD SIZE = 103 RECFORM = FIXED                            *ERCRESC
  1854*                                                                *ERCRESC
  1855*   BASE CLUSTER NAME = ERRESC                    RKP=00,LEN=37  *ERCRESC
  1856*       ALTERNATE PATH1 = NONE                                   *ERCRESC
  1857*                                                                *ERCRESC
  1858*   LOG = NO                                                     *ERCRESC
  1859*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *ERCRESC
  1860*                                                                *ERCRESC
  1861******************************************************************ERCRESC
  1862                                                                  ERCRESC
  1863 01  ACCOUNT-RESIDENT-ST-COMMISSION.                              ERCRESC
  1864                                                                  ERCRESC
  1865     10  ERRESC-RECORD-KEY.                                       ERCRESC
  1866         15  RESC-COMPANY-CD           PIC   X.                   ERCRESC
  1867         15  RESC-CARRIER              PIC   X.                   ERCRESC
  1868         15  RESC-GROUP                PIC   X(6).                ERCRESC
  1869         15  RESC-STATE                PIC   XX.                  ERCRESC
  1870         15  RESC-ACCOUNT              PIC   X(10).               ERCRESC
  1871         15  RESC-AGENT                PIC   X(10).               ERCRESC
  1872         15  RESC-RESIDENT-STATE       PIC   XX.                  ERCRESC
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  38
* ECS010MO.cbl (/apps/prod/cid1p/copy/ERCRESC)
  1873         15  RESC-EXPIRE-DATE          PIC  9(8) COMP-3.          ERCRESC
  1874*                                           YYYYMMDD              ERCRESC
  1875     10  RESC-EFFECTIVE-DATE           PIC  9(8) COMP-3.          ERCRESC
  1876                                                                  ERCRESC
  1877     10  RESC-COMM-RECORD-DATA.                                   ERCRESC
  1878         15  RESC-COMMISSIONS OCCURS 12 TIMES.                    ERCRESC
  1879             20 RESC-COVERAGE-CAT      PIC    X.                  ERCRESC
  1880             20 RESC-COMMISSION-PER    PIC SV9(5) COMP-3.         ERCRESC
  1881             20 RESC-COMMISSION-TAB REDEFINES                     ERCRESC
  1882                RESC-COMMISSION-PER    PIC  XXX.                  ERCRESC
  1883                                                                  ERCRESC
  1884     10  RESC-MAINT-BY                 PIC X(4).                  ERCRESC
  1885     10  RESC-LST-MAINT-TIME           PIC 9(7)   COMP-3.         ERCRESC
  1886     10  RESC-LST-MAINT-DATE           PIC 9(8)   COMP-3.         ERCRESC
  1887*                                          YYYYMMDD               ERCRESC
  1888 FD  ELCRTT.
  1889
* 1890                             COPY ELCCRTT.
  1891******************************************************************
  1892*                                                                *ELCCRTT
  1893*                            ELCCRTT.                            *
  1894*                                                                *ELCCRTT
  1895*   FILE DESCRIPTION = CERTIFICATE TRAILERS                      *ELCCRTT
  1896*                                                                *ELCCRTT
  1897*   FILE TYPE = VSAM,KSDS                                        *ELCCRTT
  1898*   RECORD SIZE = 552  RECFORM = FIXED                           *ELCCRTT
  1899*                                                                *ELCCRTT
  1900*   BASE CLUSTER = ELCRTT                         RKP=2,LEN=34   *ELCCRTT
  1901*                                                                *ELCCRTT
  1902*   LOG = YES                                                    *ELCCRTT
  1903*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *ELCCRTT
  1904******************************************************************
  1905*                   C H A N G E   L O G
  1906*
  1907* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1908*-----------------------------------------------------------------
  1909*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1910* EFFECTIVE    NUMBER
  1911*-----------------------------------------------------------------
  1912* 111204                   PEMA  NEW FILE TO SPLIT BANK COMM
  1913* 040109  2009031600001    AJRA  ADD NEW TRAILER TYPE AND REDEFINE DATA
  1914* 012010  2009061500002    AJRA  ADD FLAG FOR REFUND WITH OPEN CLAIM
  1915* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  1916* 061013  CR2012113000002  PEMA  SPP CLAIM RELATED CHANGES
  1917* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  1918* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  1919* 022715  CR2015010800003  PEMA  AGENT SIGNATURE
  1920******************************************************************
  1921                                                                  ELCCRTT
  1922 01  CERTIFICATE-TRAILERS.                                        ELCCRTT
  1923     12  CS-RECORD-ID                      PIC XX.                ELCCRTT
  1924         88  VALID-CS-ID                      VALUE 'CS'.         ELCCRTT
  1925                                                                  ELCCRTT
  1926     12  CS-CONTROL-PRIMARY.                                      ELCCRTT
  1927         16  CS-COMPANY-CD                 PIC X.                 ELCCRTT
  1928         16  CS-CARRIER                    PIC X.                 ELCCRTT
  1929         16  CS-GROUPING                   PIC X(6).              ELCCRTT
  1930         16  CS-STATE                      PIC XX.                ELCCRTT
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  39
* ECS010MO.cbl (/apps/prod/cid1p/copy/ELCCRTT)
  1931         16  CS-ACCOUNT                    PIC X(10).
  1932         16  CS-CERT-EFF-DT                PIC XX.                ELCCRTT
  1933         16  CS-CERT-NO.                                          ELCCRTT
  1934             20  CS-CERT-PRIME             PIC X(10).             ELCCRTT
  1935             20  CS-CERT-SFX               PIC X.                 ELCCRTT
  1936         16  CS-TRAILER-TYPE               PIC X.
  1937             88  COMM-TRLR           VALUE 'A'.
  1938             88  CLAIM-HISTORY-TRLR  VALUE 'B'.
  1939             88  CERT-DATA-TRLR      VALUE 'C'.
  1940                                                                  ELCCRTT
  1941     12  CS-DATA-AREA                      PIC X(516).
  1942
  1943     12  CS-BANK-COMMISSIONS REDEFINES CS-DATA-AREA.
  1944         16  CS-BANK-COMMISSION-AREA.
  1945             20  CS-BANK-COMMS       OCCURS 10.
  1946                 24  CS-AGT                PIC X(10).
  1947                 24  CS-COM-TYP            PIC X.
  1948                 24  CS-SPP-FEES           PIC S9(5)V99   COMP-3.
  1949                 24  CS-RECALC-LV-INDIC    PIC X.
  1950                 24  FILLER                PIC X(10).
  1951
  1952         16  FILLER                        PIC X(256).
  1953
  1954     12  CS-CLAIM-HISTORY-TRAILER REDEFINES CS-DATA-AREA.
  1955****  TO CALC NO OF BENEFITS PAID = (CS-DAYS-PAID / 30)
  1956
  1957         16  CS-MB-CLAIM-DATA OCCURS 24.
  1958             20  CS-CLAIM-NO               PIC X(7).
  1959             20  CS-CLAIM-TYPE             PIC X.
  1960                 88  CS-AH-CLM               VALUE 'A'.
  1961                 88  CS-IU-CLM               VALUE 'I'.
  1962                 88  CS-GP-CLM               VALUE 'G'.
  1963                 88  CS-LF-CLM               VALUE 'L'.
  1964                 88  CS-PR-CLM               VALUE 'P'.
  1965                 88  CS-FL-CLM               VALUE 'F'.
  1966             20  CS-INSURED-TYPE           PIC X.
  1967                 88  CS-PRIM-INSURED          VALUE 'P'.
  1968                 88  CS-CO-BORROWER           VALUE 'C'.
  1969             20  CS-BENEFIT-PERIOD         PIC 99.
  1970             20  CS-DAYS-PAID              PIC S9(5) COMP-3.
  1971             20  CS-TOTAL-PAID             PIC S9(7)V99 COMP-3.
  1972             20  CS-REMAINING-BENS         PIC S999 COMP-3.
  1973         16  FILLER                        PIC X(12).
  1974
  1975     12  CS-CERT-DATA REDEFINES CS-DATA-AREA.
  1976         16  CS-VIN-NUMBER                 PIC X(17).
  1977         16  CS-REFUND-CLAIM-FLAG          PIC X(01).
  1978         16  CS-INS-AGE-DEFAULT-FLAG       PIC X(01).
  1979         16  CS-JNT-AGE-DEFAULT-FLAG       PIC X(01).
  1980         16  cs-agent-name.
  1981             20  cs-agent-fname            pic x(20).
  1982             20  cs-agent-mi               pic x.
  1983             20  cs-agent-lname            pic x(25).
  1984         16  cs-license-no                 pic x(15).
  1985         16  cs-npn-number                 pic x(10).
  1986         16  cs-agent-edit-status          pic x.
  1987             88  cs-ae-refer-to-manager      value 'M'.
  1988             88  cs-ae-cover-sheet           value 'C'.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  40
* ECS010MO.cbl (/apps/prod/cid1p/copy/ELCCRTT)
  1989             88  cs-ae-sig-form              value 'S'.
  1990             88  cs-ae-verified              value 'V'.
  1991             88  cs-unidentified-signature   value 'U'.
  1992             88  cs-cert-returned            value 'R'.
  1993             88  cs-accept-no-commission     value 'N'.
  1994         16  FILLER                        PIC X(424).
  1995*        16  FILLER                        PIC X(496).
  1996
  1997 FD  ERAGTC.
  1998
* 1999                             COPY ERCAGTC.
  2000******************************************************************
  2001*                                                                *
  2002*                                                                *
  2003*                            ERCAGTC                             *
  2004*                            VMOD=2.001                          *
  2005*                                                                *
  2006*   ONLINE CREDIT SYSTEM                                         *
  2007*                                                                *
  2008*   FILE DESCRIPTION = AGENT COMMISSIONS                         *
  2009*                                                                *
  2010*   FILE TYPE = VSAM,KSDS                                        *
  2011*   RECORD SIZE = 450   RECFORM = FIXED                          *
  2012*                                                                *
  2013*   BASE CLUSTER NAME = ERAGTC                   RKP=2,LEN=21    *
  2014*       ALTERNATE PATH = NONE                                    *
  2015*                                                                *
  2016*   LOG = NO                                                     *
  2017*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2018*                                                                *
  2019******************************************************************
  2020*                   C H A N G E   L O G
  2021*
  2022* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2023*-----------------------------------------------------------------
  2024*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2025* EFFECTIVE    NUMBER
  2026*-----------------------------------------------------------------
  2027* 111004    2004110300005  PEMA  ADD DISTRIBUTION OF ADDENDUM FEE
  2028* 111004                         NEW FILE AND COPYBOOK
  2029* 092205                   PEMA  ADD PROCESSING FOR SPP LEASE
  2030******************************************************************
  2031
  2032 01  AGENT-COMMISSIONS.
  2033     12  AG-RECORD-ID                          PIC XX.
  2034         88  VALID-CO-ID                          VALUE 'AG'.
  2035
  2036     12  AG-CONTROL-PRIMARY.
  2037         16  AG-COMPANY-CD                     PIC X.
  2038         16  AG-CONTROL.
  2039             20  AG-CTL-1.
  2040                 24  AG-CARR-GROUP.
  2041                     28  AG-CARRIER            PIC X.
  2042                     28  AG-GROUPING           PIC X(6).
  2043                 24  AG-BANK                   PIC X(10).
  2044             20  AG-CTL-2.
  2045                 24  AG-EXP-DT                 PIC XX.
  2046         16  AG-TYPE                           PIC X.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  41
* ECS010MO.cbl (/apps/prod/cid1p/copy/ERCAGTC)
  2047             88  AG-GEN-AGENT-TYPE                VALUE 'G'.
  2048             88  AG-ACCOUNT-TYPE                  VALUE 'A'.
  2049
  2050     12  AG-MAINT-INFORMATION.
  2051         16  AG-LAST-MAINT-DT                  PIC XX.
  2052         16  AG-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  2053         16  AG-LAST-MAINT-USER                PIC X(4).
  2054         16  FILLER                            PIC X(10).
  2055
  2056     12  AG-EFF-DT                             PIC XX.
  2057     12  AG-COMM-STRUCTURE.
  2058         16  AG-AGT-COMMS OCCURS 10.
  2059             20  AG-AGT                PIC X(10).
  2060             20  AG-COM-TYP            PIC X.
  2061             20  AG-SPP-FEES           PIC S9(5)V99   COMP-3.
  2062             20  AG-RECALC-LV-INDIC    PIC X.
  2063             20  AG-SPP-LFEES          PIC S9(5)V99   COMP-3.
  2064             20  AG-LRCALC-LV-INDIC    PIC X.
  2065             20  FILLER                PIC X(05).
  2066
  2067     12  FILLER                  PIC X(145).
  2068******************************************************************
  2069
  2070 FD  ME-ECS010-BALANCE
  2071     RECORDING MODE IS F
  2072     BLOCK CONTAINS 0 RECORDS.
  2073 01  ME-ECS010-BALANCE-REC    PIC X(83).
  2074
  2075 FD  ME50-ECS010-BALANCE
  2076     RECORDING MODE IS F
  2077     BLOCK CONTAINS 0 RECORDS.
  2078 01  ME50-ECS010-BALANCE-REC  PIC X(95).
  2079
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  42
* ECS010MO.cbl
  2081 FD  DISK-DATE
* 2082                             COPY ELCDTEFD.
  2083******************************************************************04/15/98
  2084*                                                                *ELCDTEFD
  2085*                                                                *ELCDTEFD
  2086*                            ELCDTEFD.                           *   LV002
  2087*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  2088*                            VMOD=2.007                          *   CL**2
  2089*                                                                *ELCDTEFD
  2090******************************************************************ELCDTEFD
  2091     BLOCK CONTAINS 0 RECORDS
  2092     RECORDING MODE F.                                            ELCDTEFD
  2093                                                                  ELCDTEFD
  2094 01  DATE-DISK.                                                   ELCDTEFD
  2095     12  DD-ID                       PIC  X(4).                   ELCDTEFD
  2096     12  FILLER                      PIC  X(14).                  ELCDTEFD
  2097     12  DD-CR1                      PIC  9.                      ELCDTEFD
  2098     12  DD-CR1N                     PIC  X(30).                  ELCDTEFD
  2099     12  DD-CR2                      PIC  9.                      ELCDTEFD
  2100     12  DD-CR2N                     PIC  X(30).                  ELCDTEFD
  2101     12  FILLER                      PIC  X(20).                  ELCDTEFD
  2102                                                                  ELCDTEFD
  2103 01  DATE-DISK-R.                                                 ELCDTEFD
  2104     12  FILLER                      PIC  X(4).                   ELCDTEFD
  2105     12  DD-ST           OCCURS 3 TIMES                           ELCDTEFD
  2106                                     PIC  X(32).                  ELCDTEFD
  2107                                                                  ELCDTEFD
  2108 01  DATE-DISK-T.                                                 ELCDTEFD
  2109     12  FILLER                      PIC  X(4).                   ELCDTEFD
  2110     12  DD-TYPE         OCCURS 2 TIMES                           ELCDTEFD
  2111                                     PIC  X(48).                  ELCDTEFD
  2112                                                                  ELCDTEFD
  2113 01  DATE-DISK-M.                                                 ELCDTEFD
  2114     12  FILLER                      PIC  X(4).                   ELCDTEFD
  2115     12  DD-MORT         OCCURS 2 TIMES                           ELCDTEFD
  2116                                     PIC  X(48).                  ELCDTEFD
  2117                                                                  ELCDTEFD
  2118 01  DATE-DISK-P.                                                 ELCDTEFD
  2119     12  DD-IDA                      PIC  XX.                     ELCDTEFD
  2120     12  DD-IDX                      PIC  99.                     ELCDTEFD
  2121     12  DD-DATA                     PIC  X(96).                  ELCDTEFD
  2122     12  FILLER  REDEFINES DD-DATA.                               ELCDTEFD
  2123         16  DD-PS-PIC   OCCURS 50 TIMES                          ELCDTEFD
  2124                                     PIC  X.                      ELCDTEFD
  2125         16  FILLER                  PIC  X(46).                  ELCDTEFD
  2126     12  FILLER  REDEFINES DD-DATA.                               ELCDTEFD
  2127         16  DD-PS-PICO  OCCURS 20 TIMES.                         ELCDTEFD
  2128             20  DD-PS-PRT           PIC  X.                      ELCDTEFD
  2129             20  DD-PS-FMT           PIC  X.                      ELCDTEFD
  2130             20  DD-PS-PRC           PIC  X.                      ELCDTEFD
  2131             20  DD-PS-TOT           PIC  X.                      ELCDTEFD
  2132         16  FILLER                  PIC  X(16).                  ELCDTEFD
  2133                                                                  ELCDTEFD
  2134 01  DATE-DISK-E.                                                 ELCDTEFD
  2135     12  FILLER                      PIC  X(4).                   ELCDTEFD
  2136     12  DD-EDIT         OCCURS 24 TIMES                          ELCDTEFD
  2137                                     PIC  X(4).                   ELCDTEFD
  2138                                                                  ELCDTEFD
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  43
* ECS010MO.cbl (/apps/prod/cid1p/copy/ELCDTEFD)
  2139 01  DATE-DISK-C.                                                 ELCDTEFD
  2140     12  FILLER                      PIC  X(7).                   ELCDTEFD
  2141     12  DD-CARR1-SECPAY-SW          PIC  X.
  2142     12  DD-CARR1-UEP-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
  2143     12  DD-CARR1-R78-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
  2144     12  DD-CARR1-PRO-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
  2145     12  DD-CARR1                    PIC  X.                      ELCDTEFD
  2146     12  DD-CARR1S                   PIC  XX.                     ELCDTEFD
  2147     12  DD-CARR1N                   PIC  X(30).                  ELCDTEFD
  2148     12  DD-CARR2                    PIC  X.                      ELCDTEFD
  2149     12  DD-CARR2S                   PIC  XX.                     ELCDTEFD
  2150     12  DD-CARR2N                   PIC  X(30).                  ELCDTEFD
  2151     12  DD-CARR2-UEP-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
  2152     12  DD-CARR2-R78-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
  2153     12  DD-CARR2-PRO-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
  2154     12  DD-CARR2-SECPAY-SW          PIC  X.
  2155     12  FILLER                      PIC  X(7).                   ELCDTEFD
  2156                                                                  ELCDTEFD
  2157 01  DATE-DISK-OPT.                                               ELCDTEFD
  2158     12  FILLER                      PIC  X(04).                  ELCDTEFD
  2159     12  DD-TLR-DATA.                                             ELCDTEFD
  2160         16  DD-TLR                  OCCURS 32 TIMES              ELCDTEFD
  2161                                     PIC  X(03).                  ELCDTEFD
  2162     12  DD-STATE-DATA REDEFINES DD-TLR-DATA.                     ELCDTEFD
  2163         16  DD-STATE-FLDS           OCCURS 16 TIMES              ELCDTEFD
  2164                                     PIC  X(06).                  ELCDTEFD
  2165     12  DD-CARR-DATA REDEFINES DD-TLR-DATA.                      ELCDTEFD
  2166         16  DD-CARR-FLDS            OCCURS 13 TIMES              ELCDTEFD
  2167                                     PIC  X(07).                  ELCDTEFD
  2168         16  FILLER                  PIC  X(05).                  ELCDTEFD
  2169     12  DD-MISC-DATA REDEFINES DD-TLR-DATA                       ELCDTEFD
  2170                                     PIC  X(96).                  ELCDTEFD
  2171******************************************************************ELCDTEFD
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  44
* ECS010MO.cbl
  2173 FD  PRINT-COPY
* 2174                             COPY ELCPRTFD.
  2175******************************************************************04/15/98
  2176*                                                                *ELCPRTFD
  2177*                                                                *ELCPRTFD
  2178*                            ELCPRTFD.                           *   LV003
  2179*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
  2180*                            VMOD=2.006                          *ELCPRTFD
  2181******************************************************************ELCPRTFD
  2182     RECORDING MODE F                                             ELCPRTFD
  2183     LABEL RECORDS OMITTED                                        ELCPRTFD
  2184     BLOCK CONTAINS 0 RECORDS
  2185     RECORD CONTAINS 133 CHARACTERS.                              ELCPRTFD
  2186 01  PRT.                                                         ELCPRTFD
  2187     12  P-CTL               PIC  X.                                 CL**2
  2188     12  P-DATA              PIC  X(132).                         ELCPRTFD
  2189******************************************************************ELCPRTFD
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  45
* ECS010MO.cbl
  2191 FD  MISMATCH-REPORT
  2192     RECORDING MODE F.
  2193
  2194 01  MISMATCH-RPT.
  2195     12  MR-CTL              PIC X.
  2196     12  MR-DATA             PIC X(132).
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  46
* ECS010MO.cbl
  2198 FD  FICH
* 2199                             COPY ELCFCHFD.
  2200******************************************************************04/15/98
  2201*                                                                *ELCFCHFD
  2202*                            ELCFCHFD.                           *   LV003
  2203*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  2204*                            VMOD=2.004                          *   CL**3
  2205*                                                                *ELCFCHFD
  2206******************************************************************ELCFCHFD
  2207     BLOCK CONTAINS 0 RECORDS
  2208     RECORDING MODE F.                                            ELCFCHFD
  2209                                                                  ELCFCHFD
  2210 01  FICH-REC                            PIC   X(133).            ELCFCHFD
  2211******************************************************************ELCFCHFD
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  47
* ECS010MO.cbl
  2213 FD  DISPLAY-PRT
  2214     RECORDING MODE IS F
  2215     LABEL RECORDS ARE STANDARD
  2216     BLOCK CONTAINS 0 RECORDS
  2217     RECORD CONTAINS 133 CHARACTERS.
  2218
  2219 01  DISPLAY-REC.
  2220     05  DISPLAY-CC           PIC X.
  2221     05  DISPLAY-INFO         PIC X(132).
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  48
* ECS010MO.cbl
  2223 WORKING-STORAGE SECTION.
  2224 77  LCP-ASA                       PIC X.
  2225 77  FILLER  PIC X(32)  VALUE '********************************'.
  2226 77  FILLER  PIC X(32)  VALUE '*     ECS010 WORKING-STORAGE    '.
  2227 77  FILLER  PIC X(32)  VALUE '******** VMOD=2.082 ************'.
  2228
  2229 77  WS-DISP-AMT             PIC Z,ZZZ,ZZZ.99    VALUE ZEROS.
  2230 77  ERROR-COUNT             PIC 9(7)            VALUE ZEROS.
  2231 77  DIS-LINE-CNT            PIC 99              VALUE ZEROS.
  2232 77  PGM-SUB                 PIC S999    COMP    VALUE +010.
  2233 77  FIRST-ACCOUNT           PIC S9      COMP-3  VALUE +1.
  2234 77  FIRST-CERT              PIC S9      COMP-3  VALUE +1.
  2235 77  TR-CNT                  PIC S9(5)   COMP-3  VALUE +0.
  2236 77  CMIN-CNT                PIC S9(7)   COMP-3  VALUE +0.
  2237 77  CMOT-CNT                PIC S9(7)   COMP-3  VALUE +0.
  2238 77  DE-CNT                  PIC S9(7)   COMP-3  VALUE +0.
  2239 77  EP-CNT                  PIC S9(7)   COMP-3  VALUE +0.
  2240 77  LN-CNT                  PIC S999    COMP-3  VALUE +61.
  2241 77  PG-CNT                  PIC S9(5)   COMP-3  VALUE +0.
  2242 77  DUP-CNT                 PIC S9(5)   COMP-3  VALUE +0.
  2243 77  DISABILITY-TBL-MAX      PIC S9              VALUE +5.
  2244 77  DUP-MAX                 PIC S9(5)   COMP-3  VALUE +500.
  2245 77  RANGE-CNT               PIC S999    COMP-3  VALUE +0.
  2246 77  ERACCTT-READS           PIC S9(7)   COMP-3  VALUE +0.
  2247 77  ERAGTC-READS            PIC S9(7)   COMP-3  VALUE +0.
  2248 77  ELCRTT-READS            PIC S9(7)   COMP-3  VALUE +0.
  2249 77  ERRTBL-READS            PIC S9(7)   COMP-3  VALUE +0.
  2250 77  ERCTBL-READS            PIC S9(7)   COMP-3  VALUE +0.
  2251 77  FLA-CLM-REIN-BASE       PIC S9(9)V99 COMP-3.
  2252 77  WK-RATE                 PIC S99V9(5) COMP-3 VALUE +0.
  2253 77  COMM-CK-AMT             PIC S9(9)V99 COMP-3 VALUE +0.
  2254 77  ADJ-FLA-REIN-BASE       PIC S9(9)V9(4) COMP-3.
  2255 77  ISS-WK                  PIC S9(9)V99 COMP-3 VALUE +0.
  2256 77  CNC-WK                  PIC S9(9)V99 COMP-3 VALUE +0.
  2257 77  CNC-FACT                PIC S9(3)V9(7) COMP-3 VALUE +0.
  2258 77  EC-FACT                 PIC S9(3)V9(9) COMP-3 VALUE +0.
  2259 77  COMM-WK                 PIC S9(9)V99 COMP-3 VALUE +0.
  2260 77  X                       PIC X.
  2261 77  DD-FLG                  PIC X               VALUE SPACE.
  2262 77  AGT-SW                  PIC X               VALUE SPACE.
  2263 77  RC-COMM-FLG             PIC X               VALUE SPACE.
  2264 77  RECALC-TYPE             PIC X               VALUE SPACE.
  2265 77  LIFE-REFUND             PIC S9(7)V99        COMP-3.
  2266 77  LIFE-REFUND-CALC        PIC S9(7)V99        COMP-3.
  2267 77  A-H-REFUND              PIC S9(7)V99        COMP-3.
  2268 77  A-H-REFUND-CALC         PIC S9(7)V99        COMP-3.
  2269 77  YTD-CANCEL-CNT          PIC S9(3)           COMP-3.
  2270 77  MISMATCH-COUNT          PIC S9(5)           VALUE +0.
  2271 77  MISMATCH-LINE-COUNT     PIC S9(5)           VALUE +99.
  2272 77  MISMATCH-PAGE-NUMBER    PIC S9(5)           VALUE +0.
  2273 77  SV-HI-CERT              PIC 9(11)           VALUE ZEROS.
  2274 77  SV-LO-CERT              PIC 9(11)           VALUE ZEROS.
  2275 77  LST-TRD-CERT            PIC X(11)           VALUE SPACES.
  2276 77  SV-TRD-CERT             PIC X(11).
  2277 77  LST-TRD-ISDT            PIC X(10)           VALUE SPACES.
  2278 77  SV-TRD-ISDT             PIC X(10).
  2279 77  SAVE-EXTRACT            PIC X(510)          VALUE SPACES.
  2280*77  W-TLR                   PIC S9(01)V9(04) COMP-3 VALUE +.40.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  49
* ECS010MO.cbl
  2281*77  W-AH-FACTOR             PIC S9(01)V9(04) COMP-3 VALUE +.50.
  2282 77  W-EPEC-EP               PIC S9(11)V9(02) COMP-3 VALUE +0.
  2283 77  W-EPEC-EP-IN            PIC S9(11)V9(02) COMP-3 VALUE +0.
  2284 77  W-EPEC-EP-1             PIC S9(11)V9(02) COMP-3 VALUE +0.
  2285 77  W-EPEC-EP-2             PIC S9(11)V9(02) COMP-3 VALUE +0.
  2286 77  W-P-EP                  PIC S9(11)V9(02) COMP-3 VALUE +0.
  2287 77  W-M-EP                  PIC S9(11)V9(02) COMP-3 VALUE +0.
  2288 77  W-R-EP                  PIC S9(11)V9(02) COMP-3 VALUE +0.
  2289 77  W-WY-EP                 PIC S9(11)V9(02) COMP-3 VALUE +0.
  2290 77  W-VA-EP                 PIC S9(11)V9(02) COMP-3 VALUE +0.
  2291 77  W-1-EP                  PIC S9(11)V9(02) COMP-3 VALUE +0.
  2292 77  W-OTHERS-COUNT          PIC S9(11)       COMP-3 VALUE +0.
  2293 77  W-AH-CLAIM-EP           PIC S9(11)V9(02) COMP-3 VALUE +0.
  2294 77  W-AH-CLAIM-CTR          PIC S9(11)       COMP-3 VALUE +0.
  2295 77  W-EP-LESS-THAN-0        PIC S9(11)       COMP-3 VALUE +0.
  2296 77  W-CLAIMS-MADE-PAID-IN   PIC S9(11)V9(02) COMP-3 VALUE +0.
  2297 77  W-CLAIMS-MADE-PAID      PIC S9(11)V9(02) COMP-3 VALUE +0.
  2298 77  W-AH-IBNR               PIC S9(11)V9(02) COMP-3 VALUE +0.
  2299 77  W-AH-IBNR-1             PIC S9(11)V9(02) COMP-3 VALUE +0.
  2300 77  W-AH-IBNR-1-CNT         PIC S9(11)       COMP-3 VALUE +0.
  2301 77  W-AH-IBNR-2             PIC S9(11)V9(02) COMP-3 VALUE +0.
  2302 77  W-AH-IBNR-2-CNT         PIC S9(11)       COMP-3 VALUE +0.
  2303 77  W-LIFE-IBNR             PIC S9(11)V9(02) COMP-3 VALUE +0.
  2304 77  W-LIFE-IBNR-IN          PIC S9(11)V9(02) COMP-3 VALUE +0.
  2305 77  W-LIFE-REMAINING-AMT    PIC S9(11)V9(02) COMP-3 VALUE +0.
  2306 77  W-RTRM-0-CLMAMT         PIC S9(11)V9(02) COMP-3 VALUE +0.
  2307 77  W-CLM-EXCEPT-CNT        PIC S9(11)       COMP-3 VALUE +0.
  2308 77  W-CLM-EXCEPT-AMT        PIC S9(11)V9(02) COMP-3 VALUE +0.
  2309 77  W-RTRM-0-CNT            PIC S9(11)       COMP-3 VALUE +0.
  2310 77  W-RTRM-EP-1             PIC S9(11)V9(02) COMP-3 VALUE +0.
  2311 77  W-RTRM-EP-2             PIC S9(11)V9(02) COMP-3 VALUE +0.
  2312 77  W-RTRM-EP               PIC S9(11)V9(02) COMP-3 VALUE +0.
  2313 77  W-01-REMAMT             PIC S9(11)V9(02) COMP-3 VALUE +0.
  2314 77  W-01-DATA-USED          PIC S9(11)       COMP-3 VALUE +0.
  2315 77  W-02-REMAMT             PIC S9(11)V9(02) COMP-3 VALUE +0.
  2316 77  W-02-DATA-USED          PIC S9(11)       COMP-3 VALUE +0.
  2317 77  W-03-REMAMT             PIC S9(11)V9(02) COMP-3 VALUE +0.
  2318 77  W-03-DATA-USED          PIC S9(11)       COMP-3 VALUE +0.
  2319 77  W-04-REMAMT             PIC S9(11)V9(02) COMP-3 VALUE +0.
  2320 77  W-04-DATA-USED          PIC S9(11)       COMP-3 VALUE +0.
  2321 77  W-05-REMAMT             PIC S9(11)V9(02) COMP-3 VALUE +0.
  2322 77  W-05-DATA-USED          PIC S9(11)       COMP-3 VALUE +0.
  2323 77  W-06-REMAMT             PIC S9(11)V9(02) COMP-3 VALUE +0.
  2324 77  W-06-DATA-USED          PIC S9(11)       COMP-3 VALUE +0.
  2325 77  W-30-REMAMT             PIC S9(11)V9(02) COMP-3 VALUE +0.
  2326 77  W-30-DATA-USED          PIC S9(11)       COMP-3 VALUE +0.
  2327 77  W-31-REMAMT             PIC S9(11)V9(02) COMP-3 VALUE +0.
  2328 77  W-31-DATA-USED          PIC S9(11)       COMP-3 VALUE +0.
  2329 77  W-XX-REMAMT             PIC S9(11)V9(02) COMP-3 VALUE +0.
  2330 77  WS-TOT-PRM-AMT          PIC S9(11)V9(02) COMP-3 VALUE +0.
  2331 77  W-XX-DATA-USED          PIC S9(11)       COMP-3 VALUE +0.
  2332 77  W-MM-LF-PRM             PIC S9(7)V99     COMP-3 VALUE +0.
  2333 77  W-MM-AH-PRM             PIC S9(7)V99     COMP-3 VALUE +0.
  2334 77  W-MM-LF-RFD             PIC S9(7)V99     COMP-3 VALUE +0.
  2335 77  W-MM-AH-RFD             PIC S9(7)V99     COMP-3 VALUE +0.
  2336 77  W-MM-LF-CLM             PIC S9(7)V99     COMP-3 VALUE +0.
  2337 77  W-MM-AH-CLM             PIC S9(7)V99     COMP-3 VALUE +0.
  2338 77  WS-CEDE-FACT            PIC S9V9(4)      COMP-3 VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  50
* ECS010MO.cbl
  2339 77  WS-SAVE-CARR            PIC X                   VALUE ' '.
  2340 77  WS-LOOP-MAX             PIC S99          COMP-3 VALUE +10.
  2341 77  WS-CR-PMT-FREQ          PIC 99           VALUE ZEROS.
  2342 77  WS-WE-LFPRM             PIC S9(7)V99    COMP-3 VALUE +0.
  2343 77  WS-FIRST-K              PIC X                  VALUE ' '.
  2344 77  WS-DLR-INC-CHG-BACK     PIC X                  VALUE ' '.
  2345 77  TOT-AH-IBNR             PIC S9(11)V99 COMP-3 VALUE +0.
  2346 77  TOT-AH-PRM              PIC S9(11)V99 COMP-3 VALUE +0.
  2347 77  TOT-AH-PD-CLMS          PIC S9(11)V99 COMP-3 VALUE +0.
  2348 77  TOT-AH-CLMRSV           PIC S9(11)V99 COMP-3 VALUE +0.
  2349 77  TOT-LF-IBNR             PIC S9(11)V99 COMP-3 VALUE +0.
  2350 77  TOT-LF-PRM              PIC S9(11)V99 COMP-3 VALUE +0.
  2351 77  TOT-LF-PD-CLMS          PIC S9(11)V99 COMP-3 VALUE +0.
  2352 77  TOT-LF-CLMRSV           PIC S9(11)V99 COMP-3 VALUE +0.
  2353 77  RTOT-AH-IBNR            PIC S9(11)V99 COMP-3 VALUE +0.
  2354 77  RTOT-AH-PRM             PIC S9(11)V99 COMP-3 VALUE +0.
  2355 77  RTOT-AH-PD-CLMS         PIC S9(11)V99 COMP-3 VALUE +0.
  2356 77  RTOT-AH-CLMRSV          PIC S9(11)V99 COMP-3 VALUE +0.
  2357 77  RTOT-LF-IBNR            PIC S9(11)V99 COMP-3 VALUE +0.
  2358 77  RTOT-LF-PRM             PIC S9(11)V99 COMP-3 VALUE +0.
  2359 77  RTOT-LF-PD-CLMS         PIC S9(11)V99 COMP-3 VALUE +0.
  2360 77  RTOT-LF-CLMRSV          PIC S9(11)V99 COMP-3 VALUE +0.
  2361 77  IBNR-FACT               PIC S9(3)V9(7) COMP-3 VALUE +0.
  2362
  2363 01  MONTH-END-DATA.
  2364     12  ME-START-DATE.
  2365         16  ME-START-MO         PIC 99.
  2366         16  FILLER              PIC X.
  2367         16  ME-START-DA         PIC 99.
  2368         16  FILLER              PIC X.
  2369         16  ME-START-YR         PIC 99.
  2370     12  ME-CNDS-DATE            PIC 9(6).
  2371     12  ME-CNDS-DATE-R REDEFINES ME-CNDS-DATE.
  2372         16  ME-CNDS-MO          PIC 99.
  2373         16  ME-CNDS-DA          PIC 99.
  2374         16  ME-CNDS-YR          PIC 99.
  2375     12  ME-START-TIME           PIC 9(6).
  2376     12  ME-UPDATE-FLAG          PIC X VALUE 'Y'.
  2377         88  ME-DO-UPDATE        VALUE 'Y'.
  2378         88  ME-NO-UPDATE        VALUE 'N'.
  2379     12  MONTH-END-MOYR          PIC S9(5) COMP-3.
  2380
  2381 01  WS-BALANCE-DESCRIPTION1       PIC X(50)  VALUE
  2382     'Life Claims Paid'.
  2383
  2384 01  WS-BALANCE-DESCRIPTION2       PIC X(50)  VALUE
  2385     'A&H Claims Paid'.
  2386
  2387 01  WS-BALANCE-DESCRIPTION3       PIC X(50)  VALUE
  2388     'Output Certificate Master Records Prior Month'.
  2389
  2390 01  WS-BAL50-DESCRIPTION          PIC X(50)  VALUE
  2391     'ECS010 Out Recs should match EL331 Offline Certs  '.
  2392
  2393 01  WS-ME-BALANCE-REC.
  2394     12  WS-ME-BAL-JOB           PIC X(11)  VALUE SPACES.
  2395     12  WS-ME-BAL-DELIM1        PIC X(01)  VALUE ';'.
  2396     12  WS-ME-BAL-STEP          PIC X(08)  VALUE 'ECS010  '.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  51
* ECS010MO.cbl
  2397     12  WS-ME-BAL-DELIM2        PIC X(01)  VALUE ';'.
  2398     12  WS-ME-BAL-AMT           PIC ZZZ,ZZZ,ZZ9.
  2399     12  WS-ME-BAL-DELIM3        PIC X(01)  VALUE ';'.
  2400     12  WS-ME-BAL-DESCRIP       PIC X(50)  VALUE SPACES.
  2401
  2402 01  WS-ME50-BALANCE-REC.
  2403     12  WS-ME50-BAL-JOB           PIC X(11)  VALUE SPACES.
  2404     12  WS-ME50-BAL-DELIM1        PIC X(01)  VALUE ';'.
  2405     12  WS-ME50-BAL-STEP          PIC X(08)  VALUE 'ECS010  '.
  2406     12  WS-ME50-BAL-DELIM2        PIC X(01)  VALUE ';'.
  2407     12  WS-ME50-BAL-AMT-LOW       PIC ZZZ,ZZZ,ZZ9.
  2408     12  WS-ME50-BAL-DELIM3        PIC X(01)  VALUE ';'.
  2409     12  WS-ME50-BAL-AMT-HIGH      PIC ZZZ,ZZZ,ZZ9.
  2410     12  WS-ME50-BAL-DELIM4        PIC X(01)  VALUE ';'.
  2411     12  WS-ME50-BAL-DESCRIP       PIC X(50)  VALUE SPACES.
  2412
  2413 01  WS-PREV-BANK-COMM-KEY       PIC X(21)  VALUE LOW-VALUES.
  2414 01  WS-BANK-INIT                PIC X(260) VALUE SPACES.
  2415 01  WS-BANK-COMMISSIONS.
  2416     12  WS-BANK-COMMS           OCCURS 10.
  2417         16  WS-BNK-AGT          PIC X(10).
  2418         16  WS-BNK-TYPE         PIC X.
  2419         16  WS-BNK-SPP-FEES     PIC S9(5)V99  COMP-3.
  2420         16  WS-BNK-RECALC       PIC X.
  2421         16  FILLER              PIC X(10).
  2422
  2423 01  PENDING-MATCH-CONTROL.
  2424     12  PENDING-ACCOUNT-CONTROL.
  2425         16  PEND-MATCH-CARRIER    PIC X.
  2426         16  PEND-MATCH-GROUPING   PIC X(6).
  2427         16  PEND-MATCH-STATE      PIC XX.
  2428         16  PEND-MATCH-ACCOUNT    PIC X(10).
  2429     12  PEND-MATCH-EFF-DTE        PIC 9(11) COMP-3.
  2430     12  PEND-MATCH-CERT-NO.
  2431         16  PEND-MATCH-CERT       PIC X(10).
  2432         16  PEND-MATCH-CERT-SFX   PIC X.
  2433 01  PENDING-RECORD-TYPE           PIC X.
  2434     88  ISSUE-TRANSACTION            VALUE '1'.
  2435     88  CANCEL-TRANSACTION           VALUE '2'.
  2436     88  CLAIM-TRANSACTION            VALUE '3'.
  2437     88  RESERVE-TRANSACTION          VALUE '4'.
  2438     88  UPDATE-TRANSACTION           VALUE '5'.
  2439
  2440 01  CLM-INCUR-REIN-DATE.
  2441     12  CIRD-CCYY.
  2442         16  CIRD-CC         PIC 99.
  2443         16  CIRD-YR         PIC 99.
  2444     12  CIRD-MO             PIC 99.
  2445
  2446 01  HIGH-CERT               PIC 9(11)           VALUE ZEROS.
  2447
  2448 01  LOW-CERT                PIC 9(11)           VALUE ZEROS.
  2449
  2450 01  REIN-BILLING-TABLE.
  2451     12  REIN-CO-ENTRIES OCCURS 50 TIMES.
  2452         16  RB-COMPANY      PIC X(6).
  2453         16  RB-COUNT        PIC S9(5)   COMP-3.
  2454
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  52
* ECS010MO.cbl
  2455 01  B-SUB                   PIC S9(4)   COMP.
  2456
  2457 01  BINARY-COUNTERS     COMP      SYNC.
  2458     12  IA                  PIC S999            VALUE +0.
  2459     12  IB                  PIC S999            VALUE +0.
  2460     12  SUB                 PIC S999            VALUE +0.
  2461     12  SUBM                PIC S999            VALUE +0.
  2462     12  SUB3                PIC S999            VALUE +0.
  2463     12  SUB4                PIC S999            VALUE +0.
  2464     12  SUB5                PIC S999            VALUE +0.
  2465     12  SUB6                PIC S999            VALUE +0.
  2466     12  SUB7                PIC S999            VALUE +0.
  2467     12  SUB8                PIC S999            VALUE +0.
  2468     12  SUB9                PIC S999            VALUE +0.
  2469     12  SUB10               PIC S999            VALUE +0.
  2470     12  SUB11               PIC S999            VALUE +0.
  2471     12  SUB12               PIC S999            VALUE +0.
  2472     12  SUB13               PIC S999            VALUE +0.
  2473     12  SUB14               PIC S999            VALUE +0.
  2474     12  SUB15               PIC S999            VALUE +0.
  2475     12  SUB16               PIC S999            VALUE +0.
  2476     12  LEVELS-BUILT        PIC S999            VALUE +0.
  2477 01  WS-SEQ-NBR              PIC 9               VALUE ZERO.
  2478
  2479 01  WS.
  2480     12  WS-RETURN-CODE        PIC S9(4)   COMP   VALUE +0.
  2481     12  WS-ABEND-MESSAGE      PIC X(80)          VALUE SPACES.
  2482     12  WS-ABEND-FILE-STATUS  PIC XX             VALUE ZEROS.
  2483     12  WS-ZERO               PIC S9      COMP-3 VALUE +0.
  2484
  2485     12  WS-ABEND-CODE         PIC 9(4).
  2486     12  ABEND-CODE  REDEFINES  WS-ABEND-CODE.
  2487         16  ABEND-CODE-1    PIC XX.
  2488         16  ABEND-CODE-2.
  2489             20  AC2-ONE     PIC X.
  2490             20  AC2-TWO     PIC X.
  2491
  2492     12  CTBL-SEARCH.
  2493         16  CTBL-COMP-CD    PIC X.
  2494         16  CTBL-TABLE-CD   PIC XXX.
  2495         16  CTBL-BEN-TYPE   PIC X.
  2496         16  CTBL-BEN-CODE   PIC XX.
  2497     12  LAST-CTBL           PIC X(7)            VALUE SPACES.
  2498     12  COMM-OPEN-SW        PIC X               VALUE SPACES.
  2499     12  WS-COMM-TERM        PIC S999            COMP-3.
  2500     12  CTBL-ERROR-SWITCH   PIC X               VALUE SPACE.
  2501         88  CTBL-ERROR         VALUE '*'.
  2502
  2503     12  REIN-SPEC.
  2504         16  REIN-SPEC-A     PIC X.
  2505         16  REIN-SPEC-B     PIC X.
  2506         16  REIN-SPEC-C     PIC X.
  2507
  2508     12  WS-CHECK-NUMBER.
  2509         16  WS-CHECK-NO     PIC X(4).
  2510         16  FILLER          PIC XXX.
  2511
  2512     12  AH-EARN-METHOD      PIC X               VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  53
* ECS010MO.cbl
  2513         88  AH-EARN-ANTICIPATION                VALUE 'A' 'C'.
  2514         88  AH-EARN-NET                         VALUE 'N'.
  2515
  2516     12  INTERMED                PIC S9(9)V9(6)  COMP-3.
  2517     12  WS-REM-AMT              PIC S9(11)V99 COMP-3 VALUE +0.
  2518
  2519 01  ERACCTT-FILE-STATUS     PIC XX VALUE ZEROS.
  2520 01  ERCTBL-FILE-STATUS      PIC XX VALUE ZEROS.
  2521 01  ERMEBL-FILE-STATUS      PIC XX VALUE ZEROS.
  2522 01  ERRTBL-FILE-STATUS      PIC XX VALUE ZEROS.
  2523 01  ERRESC-FILE-STATUS      PIC XX VALUE ZEROS.
  2524 01  ERAGTC-FILE-STATUS      PIC XX VALUE ZEROS.
  2525 01  ELCRTT-FILE-STATUS      PIC XX VALUE ZEROS.
  2526
  2527 01  MONTHS-DIFF-LF          PIC S9(05) VALUE +0.
  2528 01  MONTHS-DIFF-AH          PIC S9(05) VALUE +0.
  2529 01  WS-CR-BIN-DATE          PIC XX VALUE LOW-VALUES.
  2530 01  WS-BIN-CANCEL-DATE      PIC XX VALUE LOW-VALUES.
  2531
  2532 01  WS-LEVELS-CHARGEBACK-SWITCHES.
  2533     12  WS-LF-CHARGEBACK-LEVELS.
  2534         16  WS-LF-CHARGEBACK-SW   PIC X(01) OCCURS 10 TIMES.
  2535     12  WS-AH-CHARGEBACK-LEVELS.
  2536         16  WS-AH-CHARGEBACK-SW   PIC X(01) OCCURS 10 TIMES.
  2537*****************************************************************
  2538*        WORKING STORAGE AREA FOR CLIENT-DMD               START*
  2539*****************************************************************
  2540*RESIDENT STATE TAXES MASTER(ERRESC)
  2541*
  2542 01  WORK-AREAS.
  2543     12  WS-ERRESC-KEY.
  2544         16 WS-ERRESC-SEARCH-KEY.
  2545             20  WS-ERRESC-COMPANY-CD PIC  X.
  2546             20  WS-ERRESC-CARRIER    PIC  X.
  2547             20  WS-ERRESC-GROUP      PIC X(6).
  2548             20  WS-ERRESC-STATE      PIC XX.
  2549             20  WS-ERRESC-ACCOUNT    PIC X(10).
  2550         16 WS-ERRESC-RESIDUAL-KEY.
  2551             20  WS-ERRESC-AGENT      PIC X(10).
  2552             20  WS-ERRESC-RES-STATE  PIC XX.
  2553             20  WS-ERRESC-EXPIRE-DT  PIC 9(8) COMP-3.
  2554*                                          YYYYMMDD
  2555     12  WS-YYYYMMDD-DT               PIC 9(8).
  2556     12  WS-COMMISSION                PIC SV9(5) COMP-3.
  2557     12  WS-SUB                       PIC    99  COMP-3.
  2558     12  WS-SUB1                      PIC    99  COMP-3.
  2559*****************************************************************
  2560*        WORKING STORAGE AREA FOR CLIENT-DMD                 END*
  2561*****************************************************************
  2562
  2563 01  COMM-WORK-AREAS.
  2564     12  FILLER              PIC  X(17)
  2565         VALUE 'COMMON WORK AREAS'.
  2566     12  ACCT-COMM-LF        PIC SV9(5)  COMP-3.
  2567     12  ACCT-COMM-AH        PIC SV9(5)  COMP-3.
  2568     12  W-AH-ACTIVE         PIC S9(13)  COMP-3 VALUE ZEROS.
  2569     12  W-AH-CALC-B         PIC S9(13)  COMP-3 VALUE ZEROS.
  2570     12  W-AH-CLAIMS         PIC S9(13)  COMP-3 VALUE ZEROS.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  54
* ECS010MO.cbl
  2571     12  W-AH-DATA-USED      PIC S9(13)  COMP-3 VALUE ZEROS.
  2572     12  W-AH-INACTIVE       PIC S9(13)  COMP-3 VALUE ZEROS.
  2573     12  W-AH-ISSUES         PIC S9(13)  COMP-3 VALUE ZEROS.
  2574     12  W-AH-REIN           PIC S9(13)  COMP-3 VALUE ZEROS.
  2575     12  W-AH-REISSUE        PIC S9(13)  COMP-3 VALUE ZEROS.
  2576     12  W-AH-REMTERM-0      PIC S9(13)  COMP-3 VALUE ZEROS.
  2577     12  W-AH-RESERVES       PIC S9(13)  COMP-3 VALUE ZEROS.
  2578     12  W-AH-RESV           PIC S9(13)  COMP-3 VALUE ZEROS.
  2579     12  W-AHTYP-99          PIC S9(13)  COMP-3 VALUE ZEROS.
  2580     12  W-BAL-REMTRM        PIC S9(05)V99  COMP-3.
  2581     12  W-CERT-COUNT        PIC S9(08)  COMP.
  2582     12  W-COUNT             PIC S9(08)  COMP   VALUE +0.
  2583     12  W-CLMAMT            PIC S9(07)V9(02)   VALUE ZEROS.
  2584     12  W-90-DAY-MAX        PIC S9(07)V9(02)   VALUE ZEROS.
  2585
  2586     12  W-EARNED-PREMIUM    PIC S9(07)V9(02)
  2587                                         COMP-3 VALUE ZEROS.
  2588     12  W-EARNED-PREMIUM-1  PIC S9(07)V9(02)
  2589                                         COMP-3 VALUE ZEROS.
  2590     12  W-EARNED-PREMIUM-2  PIC S9(07)V9(02)
  2591                                         COMP-3 VALUE ZEROS.
  2592     12  W-EDIT-FIELD        PIC ----------9.
  2593     12  W-EDIT-FIELD2       PIC ----------9.99.
  2594     12  W-EDIT-7            PIC Z(06)9.
  2595     12  W-FACTOR            PIC S9(09)V9(08)
  2596                                         COMP-3 VALUE ZEROS.
  2597     12  W-IBNR-1            PIC S9(07)V9(02)
  2598                                         COMP-3 VALUE ZEROS.
  2599     12  W-IBNR-2            PIC S9(07)V9(02)
  2600                                         COMP-3 VALUE ZEROS.
  2601     12  W-ISS-BEN           PIC S9(11)V9(02)
  2602                                         COMP-3 VALUE ZEROS.
  2603     12  W-ISS-BEN-GROSS     PIC S9(11)V9(02)
  2604                                         COMP-3 VALUE ZEROS.
  2605     12  W-LF-ACTIVE         PIC S9(13)  COMP-3 VALUE ZEROS.
  2606     12  W-LF-BALLOON        PIC S9(13)  COMP-3 VALUE ZEROS.
  2607     12  W-LF-CLAIMS         PIC S9(13)  COMP-3 VALUE ZEROS.
  2608     12  W-LF-CALC-B         PIC S9(13)  COMP-3 VALUE ZEROS.
  2609     12  W-LF-DATA-USED      PIC S9(13)  COMP-3 VALUE ZEROS.
  2610     12  W-LF-INACTIVE       PIC S9(13)  COMP-3 VALUE ZEROS.
  2611     12  W-LF-ISSUES         PIC S9(13)  COMP-3 VALUE ZEROS.
  2612     12  W-LF-REMAMT-0       PIC S9(13)  COMP-3 VALUE ZEROS.
  2613     12  W-LF-REMTERM-0      PIC S9(13)  COMP-3 VALUE ZEROS.
  2614     12  W-LF-REIN           PIC S9(13)  COMP-3 VALUE ZEROS.
  2615     12  W-LF-REISSUE        PIC S9(13)  COMP-3 VALUE ZEROS.
  2616     12  W-LF-RESERVES       PIC S9(13)  COMP-3 VALUE ZEROS.
  2617     12  W-LF-RESV           PIC S9(13)  COMP-3 VALUE ZEROS.
  2618     12  W-LFTYP-99          PIC S9(13)  COMP-3 VALUE ZEROS.
  2619     12  W-LIFE-YEARS        PIC S9(09)  COMP-3 VALUE ZEROS.
  2620     12  W-LIFE-YEARS-INT    PIC S9(09)V9(06)
  2621                                         COMP-3 VALUE ZEROS.
  2622     12  W-NDX               PIC S9(03)  COMP-3 VALUE ZEROS.
  2623     12  W-ORGTRM-0-AH       PIC S9(13)  COMP-3 VALUE ZEROS.
  2624     12  W-ORGTRM-0-LF       PIC S9(13)  COMP-3 VALUE ZEROS.
  2625     12  W-RET-CODE-AH       PIC S9(13)  COMP-3 VALUE ZEROS.
  2626     12  W-RET-CODE-LF       PIC S9(13)  COMP-3 VALUE ZEROS.
  2627     12  W-PENDING-CLMS      PIC S9(13)  COMP-3 VALUE ZEROS.
  2628     12  W-POL-ISSUES        PIC S9(13)  COMP-3 VALUE ZEROS.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  55
* ECS010MO.cbl
  2629     12  W-POLICY-ACTIVE-CTR PIC S9(13)  COMP-3 VALUE ZEROS.
  2630     12  W-POLICY-INACTIVE-CTR
  2631                             PIC S9(13)  COMP-3 VALUE ZEROS.
  2632     12  W-POLICY-REISSUE-CTR
  2633                             PIC S9(13)  COMP-3 VALUE ZEROS.
  2634     12  W-POLICY-REIN-CTR   PIC S9(13)  COMP-3 VALUE ZEROS.
  2635     12  W-POLICY-INACTIVE   PIC S9(13)  COMP-3 VALUE ZEROS.
  2636     12  W-TARGET-LOSS-RATIO PIC S9(01)V9(04)
  2637                                         COMP-3 VALUE ZEROS.
  2638     12  W-VAL-SOURCE        PIC S9(03)  COMP-3 VALUE ZEROS.
  2639     12  W-WK-IBNR           PIC S9(07)V9(02)
  2640                                         COMP-3 VALUE ZEROS.
  2641
  2642     12  W-CLAIM-TYPE        PIC  X(01).
  2643         88  W-A-H                              VALUE 'A'.
  2644         88  W-LIFE                             VALUE 'L'.
  2645     12  W-CUTOFF-DATE       PIC  9(08).
  2646     12  W-DIS-DT            PIC  XX.
  2647     12  W-DIS-PTO-DT        PIC  XX.
  2648     12  WK-LEVEL.
  2649         16  WK-AGT          PIC X(10).
  2650         16  WK-A-TYPE       PIC X.
  2651         16  WK-L-RT         PIC SV9(5)  COMP-3.
  2652         16  WK-J-RT         PIC SV9(5)  COMP-3.
  2653         16  WK-A-RT         PIC SV9(5)  COMP-3.
  2654         16  FILLER          PIC X(6).
  2655     12  WK-LEVEL-R REDEFINES WK-LEVEL.
  2656         16  FILLER          PIC X(11).
  2657         16  WK-L-RTX        PIC X(3).
  2658         16  WK-J-RTX        PIC X(3).
  2659         16  WK-A-RTX        PIC X(3).
  2660         16  FILLER          PIC X(6).
  2661     12  WK-NEW-RATES.
  2662         16  WK-N-R      OCCURS 10.
  2663             20  WK-N-AGT    PIC X(10).
  2664             20  WK-N-TYPE   PIC X.
  2665             20  WK-L-RT1    PIC SV9(5)  COMP-3.
  2666             20  WK-A-RT1    PIC SV9(5)  COMP-3.
  2667     12  W-LIFE-YEARS-ZERO.
  2668         16  FILLER          PIC  X(06)         VALUE ZEROS.
  2669         16  FILLER          PIC  X(01)         VALUE SPACES.
  2670         16  FILLER          PIC  X(02)         VALUE ZEROS.
  2671         16  FILLER          PIC  X(01)         VALUE SPACES.
  2672         16  FILLER          PIC  X(01)         VALUE SPACES.
  2673         16  FILLER          PIC  X(01)         VALUE SPACES.
  2674         16  FILLER          PIC S9(09)  COMP-3 VALUE ZEROS.
  2675         16  FILLER          PIC S9(09)  COMP-3 VALUE ZEROS.
  2676         16  FILLER          PIC S9(09)  COMP-3 VALUE ZEROS.
  2677         16  FILLER          PIC S9(09)  COMP-3 VALUE ZEROS.
  2678         16  FILLER          PIC S9(09)  COMP-3 VALUE ZEROS.
  2679         16  FILLER          PIC S9(09)  COMP-3 VALUE ZEROS.
  2680         16  FILLER          PIC S9(09)  COMP-3 VALUE ZEROS.
  2681         16  FILLER          PIC S9(09)  COMP-3 VALUE ZEROS.
  2682         16  FILLER          PIC S9(09)  COMP-3 VALUE ZEROS.
  2683         16  FILLER          PIC S9(09)  COMP-3 VALUE ZEROS.
  2684         16  FILLER          PIC S9(09)  COMP-3 VALUE ZEROS.
  2685         16  FILLER          PIC S9(09)  COMP-3 VALUE ZEROS.
  2686         16  FILLER          PIC S9(09)  COMP-3 VALUE ZEROS.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  56
* ECS010MO.cbl
  2687         16  FILLER          PIC S9(09)V9(02) COMP-3
  2688                                                VALUE ZEROS.
  2689         16  FILLER          PIC S9(09)V9(02) COMP-3
  2690                                                VALUE ZEROS.
  2691         16  FILLER          PIC S9(09)V9(02) COMP-3
  2692                                                VALUE ZEROS.
  2693         16  FILLER          PIC S9(09)V9(02) COMP-3
  2694                                                VALUE ZEROS.
  2695         16  FILLER          PIC S9(11)V9(02) COMP-3
  2696                                                VALUE ZEROS.
  2697
  2698     12  W-REIN-PROCESS-IND  PIC  X(01)         VALUE SPACES.
  2699         88 W-REIN-IN-PROCESS                   VALUE 'Y'.
  2700     12  W-REIN-PROCESS-SW   PIC  X(01)         VALUE SPACES.
  2701         88  W-REIN-PROCESS                     VALUE 'Y'.
  2702         88  W-NOT-REIN-PROCESS                 VALUE SPACES.
  2703     12  W-SELECTION-SW      PIC  X(01)         VALUE SPACES.
  2704         88  W-SELECTION-ON                     VALUE 'Y'.
  2705         88  W-SELECTION-OFF                    VALUE SPACES.
  2706     12  W-RTRM-0-SW         PIC  X(01)         VALUE SPACES.
  2707         88  W-RTRM-0                           VALUE 'Y'.
  2708         88  W-RTRM-NOT-0                       VALUE SPACES.
  2709     12  W-SUB-KEY           PIC  X(03)         VALUE SPACES.
  2710     12  W-TABLE-USED-SW     PIC  X(01)         VALUE SPACES.
  2711         88  W-TABLE-USED                       VALUE 'Y'.
  2712         88  W-TABLE-NOT-USED                   VALUE SPACES.
  2713     12  W-UNDERWRITING-SW   PIC  X             VALUE SPACES.
  2714         88  W-UNDERWRITTEN-DATA                VALUE '*'.
  2715
  2716     12  W-VAL-ERRORS.
  2717         16  FILLER          PIC  X(40)
  2718             VALUE 'PENDING CANC PROCESS - CR-LF-CANC-DT - '.
  2719         16  FILLER          PIC  X(40)
  2720             VALUE 'EPEC PROCESS - LIFE - RUN DATE - '.
  2721         16  FILLER          PIC  X(40)
  2722             VALUE 'EPEC CANCEL - LIFE - CR-LF-CANC-DT - '.
  2723         16  FILLER          PIC  X(40)
  2724             VALUE 'EPEC CANCEL LIFE SUM - CR-LF-CANC-DT - '.
  2725         16  FILLER          PIC  X(40)
  2726             VALUE 'EOM RUN DATE - EPEC - COMM - '.
  2727         16  FILLER          PIC  X(40)
  2728             VALUE 'RUN DATE EPEC - A&H - '.
  2729         16  FILLER          PIC  X(40)
  2730             VALUE 'CUTOFF DTE (OPT-MTHD) - '.
  2731         16  FILLER          PIC  X(40)
  2732             VALUE 'EOM RUN DATE - A&H EARNED PREMIUM - '.
  2733         16  FILLER          PIC  X(40)
  2734             VALUE 'EARNINGS START DATE - REIN CO RCD - '.
  2735     12  FILLER REDEFINES W-VAL-ERRORS.
  2736         16  W-VAL-ERROR OCCURS 9 TIMES
  2737                             PIC  X(40).
  2738
  2739     12  W-WORK-DATE         PIC  X(02).
  2740     12  SAVE-WK-NEW-RATES.
  2741         16  FILLER          PIC X(170).
  2742
  2743***   The following data area is for NCL only
  2744*    12  W-WORK-OB-DATA OCCURS 300.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  57
* ECS010MO.cbl
  2745*    12  W-WORK-OB-DATA OCCURS 220.
  2746     12  W-WORK-OB-DATA OCCURS 900.
  2747         16  WS-OB-REIN-CO       PIC X(06).
  2748         16  WS-OB-LF-AH         PIC X.
  2749         16  WS-OB-BENEFIT-CODE  PIC XX.
  2750         16  WS-OB-EARNED OCCURS 3.
  2751             20  WS-EPR-R78   PIC S9(09)V99 COMP-3.
  2752
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  58
* ECS010MO.cbl
  2754 01  EPEC-WORK-AREAS.
  2755     12  WE-REIN-CO          PIC X(6).
  2756     12  WE-LF-AH            PIC X.
  2757     12  WE-BEN-TYPE         PIC XX.
  2758     12  WE-LFAMT            PIC S9(9)V99    COMP-3.
  2759     12  WE-LFPRM            PIC S9(7)V99    COMP-3.
  2760     12  WE-LFAMT-ALT        PIC S9(9)V99    COMP-3.
  2761     12  WE-LFPRM-ALT        PIC S9(7)V99    COMP-3.
  2762     12  WE-LFRFND           PIC S9(7)V99    COMP-3.
  2763     12  WE-DTHAMT           PIC S9(9)V99    COMP-3.
  2764     12  WE-DTHEXP           PIC S9(9)V99    COMP-3.
  2765     12  WE-NUM-DTH-CLM      PIC S999        COMP-3.
  2766     12  WE-DTH-IBNR         PIC S9(7)V99    COMP-3.
  2767     12  WE-DTH-PAYCUR       PIC S9(7)V99    COMP-3.
  2768     12  WE-DTH-FUTRSV       PIC S9(7)V99    COMP-3.
  2769     12  WE-AHAMT            PIC S9(9)V99    COMP-3.
  2770     12  WE-AHPRM            PIC S9(7)V99    COMP-3.
  2771     12  WE-AHRFND           PIC S9(7)V99    COMP-3.
  2772     12  WE-DSPY-AMT         PIC S9(9)V99    COMP-3.
  2773     12  WE-DSPY-EXP         PIC S9(9)V99    COMP-3.
  2774     12  WE-NUM-DIS-CLM      PIC S999        COMP-3.
  2775     12  WE-DIS-IBNR         PIC S9(7)V99    COMP-3.
  2776     12  WE-DIS-PAYCUR       PIC S9(7)V99    COMP-3.
  2777     12  WE-DIS-FUTRSV       PIC S9(7)V99    COMP-3.
  2778     12  ISS-BEN             PIC S9(9)V99    COMP-3.
  2779     12  CNC-BEN             PIC S9(9)V99    COMP-3.
  2780     12  ISS-PRM             PIC S9(7)V99    COMP-3.
  2781     12  ISS-PRMTAX          PIC S9(7)V99    COMP-3.
  2782     12  CNC-PRM             PIC S9(7)V99    COMP-3.
  2783     12  GROSS-ISS-BEN-LF    PIC S9(9)V99    COMP-3.
  2784     12  GROSS-CNC-BEN-LF    PIC S9(9)V99    COMP-3.
  2785     12  GROSS-ISS-PRM-LF    PIC S9(7)V99    COMP-3.
  2786     12  GROSS-CNC-PRM-LF    PIC S9(7)V99    COMP-3.
  2787     12  GROSS-ISS-BEN-AH    PIC S9(7)V99    COMP-3.
  2788     12  GROSS-CNC-BEN-AH    PIC S9(7)V99    COMP-3.
  2789     12  GROSS-ISS-PRM-AH    PIC S9(7)V99    COMP-3.
  2790     12  GROSS-CNC-PRM-AH    PIC S9(7)V99    COMP-3.
  2791     12  EARNED-BY-CANCEL    PIC S9(7)V99    COMP-3.
  2792     12  EPR-R78             PIC S9(7)V99    COMP-3.
  2793     12  EPR-PRO             PIC S9(7)V99    COMP-3.
  2794     12  EPR-ST              PIC S9(7)V99    COMP-3.
  2795     12  W-OPT-R78           PIC S9(7)V99    COMP-3.
  2796     12  W-OPT-PRO           PIC S9(7)V99    COMP-3.
  2797     12  W-OPT-ST            PIC S9(7)V99    COMP-3.
  2798     12  WX-ACTIVE-COUNT     PIC S9          COMP-3.
  2799     12  WX-CANC-DT          PIC 9(11)       COMP-3.
  2800     12  WX-CLM-AMT          PIC S9(9)V99    COMP-3.
  2801     12  WX-CLM-EXP          PIC S9(9)V99    COMP-3.
  2802     12  WX-CLM-CNT          PIC S9(7)       COMP-3.
  2803     12  WX-CLM-CRT          PIC S9(7)       COMP-3.
  2804     12  WX-CNC-CNT          PIC S9(7)       COMP-3.
  2805     12  WX-CLAIM-EXIT-DATE  PIC  9(11)      COMP-3.
  2806     12  WX-SETTLEMENT-EXIT-DATE
  2807                             PIC  9(11)      COMP-3.
  2808     12  WX-STATUS-AT-CANCEL PIC  X(1).
  2809     12  WX-STATUS-AT-DEATH  PIC  X(1).
  2810     12  WX-STATUS-AT-SETTLEMENT
  2811                             PIC  X(1).
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  59
* ECS010MO.cbl
  2812     12  WX-EOM-RUN-DATE     PIC  9(11)      COMP-3.
  2813
  2814 01  EPEC-WORK.
  2815     12  EW-REIN-CO          PIC X(6).
  2816     12  EW-SUB-KEY.
  2817         16  EW-LF-AH        PIC X.
  2818         16  EW-BEN-TYPE     PIC XX.
  2819     12  EW-ISS-BEN          PIC S9(11)V99   COMP-3.
  2820     12  EW-ISS-BEN-GROSS    PIC S9(11)V99   COMP-3.
  2821     12  EW-CNC-BEN          PIC S9(11)V99   COMP-3.
  2822     12  EW-CNC-BEN-GROSS    PIC S9(11)V99   COMP-3.
  2823     12  EW-ISS-PRM          PIC S9(9)V99    COMP-3.
  2824     12  EW-ISS-PRM-GROSS    PIC S9(9)V99    COMP-3.
  2825     12  EW-CNC-PRM          PIC S9(9)V99    COMP-3.
  2826     12  EW-CNC-PRM-GROSS    PIC S9(9)V99    COMP-3.
  2827     12  EW-EPR-R78          PIC S9(9)V99    COMP-3.
  2828     12  EW-EPR-R78-ADJ      PIC S9(9)V99    COMP-3.
  2829     12  EW-EPR-PRO          PIC S9(9)V99    COMP-3.
  2830     12  EW-EPR-PRO-ADJ      PIC S9(9)V99    COMP-3.
  2831     12  EW-EPR-ST           PIC S9(9)V99    COMP-3.
  2832     12  EW-EPR-ST-ADJ       PIC S9(9)V99    COMP-3.
  2833     12  EW-CLM-AMT          PIC S9(9)V99    COMP-3.
  2834     12  EW-CLM-IBNR         PIC S9(7)V99    COMP-3.
  2835     12  EW-CLM-PAYCUR       PIC S9(7)V99    COMP-3.
  2836     12  EW-CLM-FUTRSV       PIC S9(7)V99    COMP-3.
  2837     12  EW-CLM-CNT          PIC S9(7)       COMP-3.
  2838     12  EW-CLM-CRT          PIC S9(7)       COMP-3.
  2839     12  EW-ISS-CNT          PIC S9(7)       COMP-3.
  2840     12  EW-CNC-CNT          PIC S9(7)       COMP-3.
  2841     12  EW-ISS-PRM-TAX      PIC S9(7)V99    COMP-3.
  2842     12  EW-AGENTS       OCCURS 10.
  2843         16  EW-AGT-NO       PIC X(10).
  2844         16  EW-AGT-TYPE     PIC X.
  2845         16  EW-ISS-COM      PIC S9(9)V99    COMP-3.
  2846         16  EW-CNC-COM      PIC S9(9)V99    COMP-3.
  2847         16  EW-ECR-R78      PIC S9(9)V99    COMP-3.
  2848         16  EW-ECR-R78-ADJ  PIC S9(9)V99    COMP-3.
  2849         16  EW-ECR-PRO      PIC S9(9)V99    COMP-3.
  2850         16  EW-ECR-PRO-ADJ  PIC S9(9)V99    COMP-3.
  2851         16  EW-ECR-ST       PIC S9(9)V99    COMP-3.
  2852     12  EW-COV-DTE          PIC 9(11)       COMP-3.
  2853     12  EW-INFORCE-CNT      PIC S9(9)       COMP-3.
  2854     12  EW-ORIG-TERM        PIC S9(9)       COMP-3.
  2855     12  EW-REM-TERM         PIC S9(9)       COMP-3.
  2856     12  EW-AGE              PIC S9(9)       COMP-3.
  2857     12  EW-AGE-BEN          PIC S9(11)      COMP-3.
  2858     12  EW-TERM-BEN         PIC S9(11)      COMP-3.
  2859     12  EW-LEVEL-USED       PIC X.
  2860
  2861 01  EPEC-TOTALS.
  2862     12  EPEC-LEVELS     OCCURS 900.
  2863*    12  EPEC-LEVELS     OCCURS 220.
  2864*    12  EPEC-LEVELS     OCCURS 300.
  2865         16  EPEC-REIN-CO          PIC X(6).
  2866         16  EPEC-SUB-KEY.
  2867             24  EPEC-LF-AH        PIC X.
  2868             24  EPEC-BEN-TYPE     PIC XX.
  2869*        16  FILLER                PIC X(694).
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  60
* ECS010MO.cbl
  2870         16  FILLER                PIC X(699).
  2871     12  EPEC-LEVELS-END           PIC X(6).
  2872
  2873 01  EPEC-UNDERWRITTEN-TOTALS.
  2874     12  EPEC-LEVELS-II  OCCURS 900.
  2875*    12  EPEC-LEVELS-II  OCCURS 220.
  2876*    12  EPEC-LEVELS-II  OCCURS 300.
  2877         16  EPEC-REIN-CO-II       PIC X(6).
  2878         16  EPEC-SUB-KEY-II.
  2879             24  EPEC-LF-AH-II     PIC X.
  2880             24  EPEC-BEN-TYPE-II  PIC XX.
  2881*        16  FILLER                PIC X(694).
  2882         16  FILLER                PIC X(699).
  2883     12  EPEC-LEVELS-END-II        PIC X(6).
  2884
  2885
  2886 01  FILLER                      PIC  X(11)
  2887                                 VALUE 'OPT RSV TBL'.
  2888*
  2889* THE 'PIC' VALUE OF THE NEXT 2 DATA NAMES IS 300 OCCURANCES
  2890*  TIMES THE SIZE OF THE DATA NAME THAT OCCURS.
  2891*  EX: EPEC-OPT-GRP  (300) TIMES THE TOTAL SIZE OF FIELDS IN
  2892*      EPEC-OPT-GRP  (108)
  2893*
  2894*      300 X 108 = 32400.
  2895*
  2896 01  EPEC-OPT-DATA-TABLE.
  2897*    12  FILLER                  PIC X(32400).
  2898*    12  FILLER                  PIC X(23760).
  2899     12  FILLER                  PIC X(97200).
  2900
  2901 01  FILLER                      PIC  X(16)
  2902                                 VALUE 'OPT RSV TBL UNDW'.
  2903 01  EPEC-UNDW-OPT-DATA-TABLE.
  2904*    12  FILLER                  PIC X(32400).
  2905*    12  FILLER                  PIC X(23760).
  2906     12  FILLER                  PIC X(97200).
  2907
  2908 01  FILLER                      PIC  X(16)
  2909                                 VALUE 'OPT RSV TBL WORK'.
  2910 01  EPEC-OPT-WORK-TABLE.
  2911*    12  EPEC-OPT-GRP        OCCURS 300.
  2912*    12  EPEC-OPT-GRP        OCCURS 220.
  2913     12  EPEC-OPT-GRP        OCCURS 900.
  2914         16  EPEC-REIN-CO-OPT
  2915                             PIC  X(06).
  2916         16  EPEC-SUB-KEY-OPT.
  2917             24  EPEC-LF-AH-OPT
  2918                             PIC  X(01).
  2919             24  EPEC-BEN-TYPE-OPT
  2920                             PIC  X(02).
  2921         16  EPEC-OPT-DATA.
  2922             20  EPEC-REIN-ONLY-IND
  2923                             PIC  X(01).
  2924                 88  EPEC-REIN-ONLY-DATA   VALUE 'R'.
  2925             20  EPEC-LINE-NOT-USED-IND
  2926                             PIC  X(01).
  2927                 88  EPEC-LINE-NOT-USED    VALUE 'N'.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  61
* ECS010MO.cbl
  2928             20  EPEC-LIFE-CTR-USED-IND
  2929                             PIC  X(01).
  2930                 88  EPEC-LIFE-CTR-USED    VALUE 'Y'.
  2931                 88  EPEC-LIFE-CTR-NOT-USED
  2932                                           VALUE ' '.
  2933             20  EPEC-LIFE-CTR   OCCURS 13 TIMES
  2934                             PIC S9(09)       COMP-3.
  2935             20  EPEC-EARNED-PREMIUM-AH
  2936                             PIC S9(09)V9(02) COMP-3.
  2937             20  EPEC-CLAIMS-MADE-PAID
  2938                             PIC S9(09)V9(02) COMP-3.
  2939             20  EPEC-CLM-EXP
  2940                             PIC S9(09)V9(02) COMP-3.
  2941             20  EPEC-LIFE-IBNR
  2942                             PIC S9(09)V9(02) COMP-3.
  2943             20  EPEC-REIN-ISS-BEN
  2944                             PIC S9(11)V9(02) COMP-3.
  2945
  2946 01  FILLER                  PIC X(09)
  2947                                 VALUE 'EOM TABLE'.
  2948
  2949 01  EOM-DATE-TABLE.
  2950     12  EOM-DATE            OCCURS 13
  2951                             PIC 9(08).
  2952
  2953 01  EPEC-SUBS.
  2954     12  EPEC-SUB-LEVELS OCCURS 31.
  2955         16  EPEC-SUB-REIN   PIC X(6).
  2956         16  EPEC-SUB-LF     PIC S999  COMP  OCCURS 900.
  2957         16  EPEC-SUB-AH     PIC S999  COMP  OCCURS 900.
  2958     12  EPEC-SUBS-END       PIC X(6).
  2959
  2960 01  SAVE-REIN-WORK.
  2961     12  REIN-SUB-1          PIC S9(4)   COMP    VALUE +0.
  2962     12  REIN-SUB-2          PIC S9(4)   COMP    VALUE +0.
  2963     12  REIN-MAX            PIC S9(4)   COMP    VALUE +32.
  2964     12  REIN-LOW-TIME       PIC 9(6)            VALUE 999999.
  2965     12  REIN-LOW-SUB        PIC S9(4)   COMP    VALUE +1.
  2966
  2967 01  SAVE-REIN-TABLE.
  2968     12  SAVE-REIN-ENTRY     OCCURS 32 TIMES.
  2969         16  SR-TIME         PIC 9(6).
  2970         16  SR-ENTRY.
  2971             20  FILLER      PIC XX.
  2972             20  SR-CONTROL  PIC X(8).
  2973             20  FILLER      PIC X(3990).
  2974
  2975
* 2976                             COPY ECSRITAB.
  2977******************************************************************04/29/98
  2978*                                                                *ECSRITAB
  2979*                            ECSRITAB                            *   LV015
  2980*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL*15
  2981*                            VMOD=2.015                          *ECSRITAB
  2982*                                                                *ECSRITAB
  2983*  NO  CID  MODS  IN  COPYBOOK  ECSRITAB                         *ECSRITAB
  2984*                                                                *ECSRITAB
  2985******************************************************************ECSRITAB
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  62
* ECS010MO.cbl (/apps/prod/cid1p/copy/ECSRITAB)
  2986 01  REIN-WORK-AREAS.                                             ECSRITAB
  2987     12  RW-LFAMT                PIC S9(9)V99  VALUE +0   COMP-3. ECSRITAB
  2988     12  RW-AHWRK                PIC S9(9)V99  VALUE +0   COMP-3. ECSRITAB
  2989     12  RW-LFPRM                PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  2990     12  RW-LFPRMC               PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  2991     12  RW-LFRFND               PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  2992     12  RW-AHPRM                PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  2993     12  RW-AHPRMC               PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  2994     12  RW-AHRFND               PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  2995     12  RW-LFCLMWK              PIC S9(9)V99  VALUE +0   COMP-3. ECSRITAB
  2996     12  RW-AHCLMWK              PIC S9(9)V99  VALUE +0   COMP-3. ECSRITAB
  2997     12  RW-AH-INCURRED-DETAIL.                                   ECSRITAB
  2998         16  RW-AH-INCURRED-DATA OCCURS 5 TIMES.                  ECSRITAB
  2999             20  RW-AH-INCUR-DT  PIC 9(11) COMP-3.                   CL**2
  3000             20  RW-AH-CLM-AMT   PIC S9(9)V99             COMP-3. ECSRITAB
  3001             20  RW-AH-CLM-EXP   PIC S9(9)V99             COMP-3. ECSRITAB
  3002     12  RW-LFCLM                PIC S9(9)V99  VALUE +0   COMP-3. ECSRITAB
  3003     12  RW-AHCLM                PIC S9(9)V99  VALUE +0   COMP-3. ECSRITAB
  3004     12  RW-AH-LIMIT             PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  3005     12  RW-LFIBNR               PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  3006     12  RW-LFPAYCUR             PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  3007     12  RW-LFFUTRSV             PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  3008     12  RW-AHIBNR               PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  3009     12  RW-AHPAYCUR             PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  3010     12  RW-AHFUTRSV             PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  3011     12  RW-LFIBNRWK             PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  3012     12  RW-LFPAYCURWK           PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  3013     12  RW-LFFUTRSVWK           PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  3014     12  RW-AHIBNRWK             PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  3015     12  RW-AHPAYCURWK           PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  3016     12  RW-AHFUTRSVWK           PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  3017     12  RW-AHLIM-LO             PIC S9(9)V99  VALUE +0   COMP-3. ECSRITAB
  3018     12  RW-AHLIM-HI             PIC S9(9)V99  VALUE +0   COMP-3. ECSRITAB
  3019     12  RW-ACCUM-LF             PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  3020     12  RW-ACCUM-AH             PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  3021     12  RW-ACCUM-CLM            PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  3022     12  RW-ACCUM-IBNR           PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  3023     12  RW-ACCUM-PAYCUR         PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  3024     12  RW-ACCUM-FUTRSV         PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  3025                                                                  ECSRITAB
  3026 01  REIN-HOLD-AREAS.                                             ECSRITAB
  3027     12  REIN-LEVELS       OCCURS 30 TIMES.                       ECSRITAB
  3028         16  REIN-COMP               PIC X(6).                    ECSRITAB
  3029         16  REIN-LF-AH-FLGS.                                     ECSRITAB
  3030             20  REIN-LF-FLG         PIC X.                       ECSRITAB
  3031             20  REIN-AH-FLG         PIC X.                       ECSRITAB
  3032         16  REIN-WORK-FLDS.                                      ECSRITAB
  3033             20  REIN-LFAMT          PIC S9(9)V99   COMP-3.       ECSRITAB
  3034             20  REIN-LFPRM          PIC S9(7)V99   COMP-3.       ECSRITAB
  3035             20  REIN-AHAMT          PIC S9(7)V99   COMP-3.       ECSRITAB
  3036             20  REIN-AHPRM          PIC S9(7)V99   COMP-3.       ECSRITAB
  3037             20  REIN-LFRFND         PIC S9(7)V99   COMP-3.       ECSRITAB
  3038             20  REIN-AHRFND         PIC S9(7)V99   COMP-3.       ECSRITAB
  3039             20  REIN-LFCLM          PIC S9(9)V99   COMP-3.       ECSRITAB
  3040             20  REIN-AHCLM          PIC S9(9)V99   COMP-3.       ECSRITAB
  3041             20  REIN-LFCLML         PIC S9(9)V99   COMP-3.       ECSRITAB
  3042             20  REIN-AHCLML         PIC S9(9)V99   COMP-3.       ECSRITAB
  3043             20  REIN-DIS-IBNR       PIC S9(7)V99   COMP-3.       ECSRITAB
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  63
* ECS010MO.cbl (/apps/prod/cid1p/copy/ECSRITAB)
  3044             20  REIN-DIS-PAYCUR     PIC S9(7)V99   COMP-3.       ECSRITAB
  3045             20  REIN-DIS-FUTRSV     PIC S9(7)V99   COMP-3.       ECSRITAB
  3046             20  REIN-DIS-IBNRL      PIC S9(7)V99   COMP-3.       ECSRITAB
  3047             20  REIN-DIS-PAYCURL    PIC S9(7)V99   COMP-3.       ECSRITAB
  3048             20  REIN-DIS-FUTRSVL    PIC S9(7)V99   COMP-3.       ECSRITAB
  3049             20  REIN-DTH-IBNR       PIC S9(7)V99   COMP-3.       ECSRITAB
  3050             20  REIN-DTH-PAYCUR     PIC S9(7)V99   COMP-3.       ECSRITAB
  3051             20  REIN-DTH-FUTRSV     PIC S9(7)V99   COMP-3.       ECSRITAB
  3052             20  REIN-DTH-IBNRL      PIC S9(7)V99   COMP-3.       ECSRITAB
  3053             20  REIN-DTH-PAYCURL    PIC S9(7)V99   COMP-3.       ECSRITAB
  3054             20  REIN-DTH-FUTRSVL    PIC S9(7)V99   COMP-3.       ECSRITAB
  3055             20  REIN-AH-LIMIT       PIC S9(7)V99   COMP-3.       ECSRITAB
  3056             20  REIN-REM-SW         PIC X.                       ECSRITAB
  3057             20  REIN-REM-AH-100     PIC X.                       ECSRITAB
  3058             20  REIN-EP-STOP-DATE   PIC 9(11)      COMP-3.          CL**4
  3059             20  REIN-LF-RUNOFF-SW   PIC X.                       ECSRITAB
  3060             20  REIN-AH-RUNOFF-SW   PIC X.                       ECSRITAB
  3061     12  REIN-LEVELS-END             PIC X(6).                    ECSRITAB
  3062                                                                  ECSRITAB
  3063     12  RWF-FIELDS.                                              ECSRITAB
  3064         16  RWF-LFAMT               PIC S9(9)V99   COMP-3.       ECSRITAB
  3065         16  RWF-LFPRM               PIC S9(7)V99   COMP-3.       ECSRITAB
  3066         16  RWF-AHAMT               PIC S9(7)V99   COMP-3.       ECSRITAB
  3067         16  RWF-AHPRM               PIC S9(7)V99   COMP-3.       ECSRITAB
  3068         16  RWF-LFRFND              PIC S9(7)V99   COMP-3.       ECSRITAB
  3069         16  RWF-AHRFND              PIC S9(7)V99   COMP-3.       ECSRITAB
  3070         16  RWF-LFCLM               PIC S9(9)V99   COMP-3.       ECSRITAB
  3071         16  RWF-AHCLM               PIC S9(9)V99   COMP-3.       ECSRITAB
  3072         16  RWF-LFCLML              PIC S9(9)V99   COMP-3.       ECSRITAB
  3073         16  RWF-AHCLML              PIC S9(9)V99   COMP-3.       ECSRITAB
  3074         16  RWF-DIS-IBNR            PIC S9(7)V99   COMP-3.       ECSRITAB
  3075         16  RWF-DIS-PAYCUR          PIC S9(7)V99   COMP-3.       ECSRITAB
  3076         16  RWF-DIS-FUTRSV          PIC S9(7)V99   COMP-3.       ECSRITAB
  3077         16  RWF-DIS-IBNRL           PIC S9(7)V99   COMP-3.       ECSRITAB
  3078         16  RWF-DIS-PAYCURL         PIC S9(7)V99   COMP-3.       ECSRITAB
  3079         16  RWF-DIS-FUTRSVL         PIC S9(7)V99   COMP-3.       ECSRITAB
  3080         16  RWF-DTH-IBNR            PIC S9(7)V99   COMP-3.       ECSRITAB
  3081         16  RWF-DTH-PAYCUR          PIC S9(7)V99   COMP-3.       ECSRITAB
  3082         16  RWF-DTH-FUTRSV          PIC S9(7)V99   COMP-3.       ECSRITAB
  3083         16  RWF-DTH-IBNRL           PIC S9(7)V99   COMP-3.       ECSRITAB
  3084         16  RWF-DTH-PAYCURL         PIC S9(7)V99   COMP-3.       ECSRITAB
  3085         16  RWF-DTH-FUTRSVL         PIC S9(7)V99   COMP-3.       ECSRITAB
  3086         16  RWF-AH-LIMIT            PIC S9(7)V99   COMP-3.       ECSRITAB
  3087         16  RWF-REM-SW              PIC X.                       ECSRITAB
  3088         16  RWF-REM-AH-100          PIC X.                       ECSRITAB
  3089         16  RWF-EP-STOP-DATE        PIC 9(11)      COMP-3.          CL**3
  3090         16  RWF-LF-RUNOFF-SW        PIC X.                       ECSRITAB
  3091         16  RWF-AH-RUNOFF-SW        PIC X.                       ECSRITAB
  3092                                                                  ECSRITAB
  3093     12  WT-COMP-INFO.                                            ECSRITAB
  3094         16  WT-REI-COMP             PIC X(6).                    ECSRITAB
  3095         16  WT-LF-QC                PIC X.                       ECSRITAB
  3096         16  WT-AH-QC                PIC X.                       ECSRITAB
  3097         16  WT-LO-DATE              PIC 9(11)     COMP-3.           CL**2
  3098         16  WT-HI-DATE              PIC 9(11)     COMP-3.           CL**2
  3099         16  WT-LFAGE-LO             PIC 99.                      ECSRITAB
  3100         16  WT-LFAGE-HI             PIC 99.                      ECSRITAB
  3101         16  WT-AHAGE-LO             PIC 99.                      ECSRITAB
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  64
* ECS010MO.cbl (/apps/prod/cid1p/copy/ECSRITAB)
  3102         16  WT-AHAGE-HI             PIC 99.                      ECSRITAB
  3103         16  WT-LFTRM-LO             PIC S999       COMP-3.       ECSRITAB
  3104         16  WT-LFTRM-HI             PIC S999       COMP-3.       ECSRITAB
  3105         16  WT-AHTRM-LO             PIC S999       COMP-3.       ECSRITAB
  3106         16  WT-AHTRM-HI             PIC S999       COMP-3.       ECSRITAB
  3107         16  WT-LF-PCT               PIC S9V9999    COMP-3.       ECSRITAB
  3108         16  WT-AH-PCT               PIC S9V9999    COMP-3.       ECSRITAB
  3109         16  WT-LF-LIM-LO            PIC S9(9)V99   COMP-3.       ECSRITAB
  3110         16  WT-LF-LIM-HI            PIC S9(9)V99   COMP-3.       ECSRITAB
  3111         16  WT-LF-LO                PIC S9(9)V99   COMP-3.       ECSRITAB
  3112         16  WT-LF-HI                PIC S9(9)V99   COMP-3.       ECSRITAB
  3113         16  WT-AHBEN-LIM-LO         PIC S9(7)V99   COMP-3.       ECSRITAB
  3114         16  WT-AHBEN-LIM-HI         PIC S9(7)V99   COMP-3.       ECSRITAB
  3115         16  WT-AHBEN-LO             PIC S9(7)V99   COMP-3.       ECSRITAB
  3116         16  WT-AHBEN-HI             PIC S9(7)V99   COMP-3.       ECSRITAB
  3117         16  WT-AHMOA-LIM-LO         PIC S9(7)V99   COMP-3.       ECSRITAB
  3118         16  WT-AHMOA-LIM-HI         PIC S9(7)V99   COMP-3.       ECSRITAB
  3119         16  WT-AHMOA-LO             PIC S9(7)V99   COMP-3.       ECSRITAB
  3120         16  WT-AHMOA-HI             PIC S9(7)V99   COMP-3.       ECSRITAB
  3121         16  WT-LF-BEN-CODE          PIC X.                       ECSRITAB
  3122         16  WT-AH-BEN-CODE          PIC X.                       ECSRITAB
  3123         16  WT-INTERACTIVE          PIC X.                       ECSRITAB
  3124         16  WT-REMAINING            PIC X.                       ECSRITAB
  3125         16  FILLER                  PIC X(21).                   ECSRITAB
  3126                                                                  ECSRITAB
  3127 01  REIN-MISC-WORK-FIELDS.                                       ECSRITAB
  3128     12  SUB1                    PIC S9(4)       COMP.            ECSRITAB
  3129     12  SUB2                    PIC S9(4)       COMP.            ECSRITAB
  3130     12  CO-SUB                  PIC S9(4)       COMP.            ECSRITAB
  3131     12  INC-SUB                 PIC S999        COMP.            ECSRITAB
  3132     12  MORTALITY-SUB           PIC S999        COMP.            ECSRITAB
  3133     12  REIN-FACTOR             PIC S99V9(7)  COMP-3   VALUE +0. ECSRITAB
  3134     12  REIN-CALCED-LIFE        PIC S9(7)V99  COMP-3   VALUE +0. ECSRITAB
  3135     12  REIN-CALCED-AH          PIC S9(7)V99  COMP-3   VALUE +0. ECSRITAB
  3136     12  REIN-RISK-AMOUNT        PIC S9(11)V99 COMP-3   VALUE +0. ECSRITAB
  3137     12  REIN-MONTH-REDUCE       PIC S9(7)V99  COMP-3   VALUE +0. ECSRITAB
  3138     12  REIN-CEDE-TERM          PIC S999V99   COMP-3   VALUE +0. ECSRITAB
  3139     12  REIN-WORKA              PIC S999      COMP-3   VALUE +0. ECSRITAB
  3140     12  REIN-EARN-LF-TERM       PIC S999      COMP-3   VALUE +0. ECSRITAB
  3141     12  REIN-EARN-AH-TERM       PIC S999      COMP-3   VALUE +0. ECSRITAB
  3142     12  REIN-LCNC-EARN-TERM     PIC S999      COMP-3   VALUE +0. ECSRITAB
  3143     12  REIN-ACNC-EARN-TERM     PIC S999      COMP-3   VALUE +0. ECSRITAB
  3144     12  REIN-LF-CLM-MONTHS      PIC S999      COMP-3   VALUE +0. ECSRITAB
  3145     12  REIN-AH-CLM-MONTHS      PIC S999      COMP-3   VALUE +0. ECSRITAB
  3146     12  REIN-AH-CLM-MTH-1       PIC S999      COMP-3   VALUE +0. ECSRITAB
  3147     12  REIN-AH-CLM-MTH-2       PIC S999      COMP-3   VALUE +0. ECSRITAB
  3148     12  REIN-AH-CLM-MTH-3       PIC S999      COMP-3   VALUE +0. ECSRITAB
  3149     12  REIN-AH-CLM-MTH-4       PIC S999      COMP-3   VALUE +0. ECSRITAB
  3150     12  REIN-AH-CLM-MTH-5       PIC S999      COMP-3   VALUE +0. ECSRITAB
  3151     12  REIN-AH-PRIOR-CLMS-PAID PIC S9(11)V99 COMP-3   VALUE +0. ECSRITAB
  3152                                                                  ECSRITAB
  3153     12  REIN-VOID-LF-SW         PIC X    VALUE ' '.              ECSRITAB
  3154         88  VOIDING-LF-CANCEL            VALUE '*'.              ECSRITAB
  3155     12  REIN-VOID-AH-SW         PIC X    VALUE ' '.              ECSRITAB
  3156         88  VOIDING-AH-CANCEL            VALUE '*'.              ECSRITAB
  3157     12  REIN-ADDL-LF-SW         PIC X    VALUE ' '.              ECSRITAB
  3158         88  ADDITIONAL-LF-CANCEL         VALUE '*'.              ECSRITAB
  3159     12  REIN-ADDL-AH-SW         PIC X    VALUE ' '.              ECSRITAB
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  65
* ECS010MO.cbl (/apps/prod/cid1p/copy/ECSRITAB)
  3160         88  ADDITIONAL-AH-CANCEL         VALUE '*'.              ECSRITAB
  3161     12  REIN-CANCEL-LF-SW       PIC X    VALUE ' '.              ECSRITAB
  3162         88  FLAT-CANCEL-LF               VALUE '*'.              ECSRITAB
  3163     12  REIN-CANCEL-AH-SW       PIC X    VALUE ' '.              ECSRITAB
  3164         88  FLAT-CANCEL-AH               VALUE '*'.              ECSRITAB
  3165                                                                  ECSRITAB
  3166     12  REIN-BEN-CODE           PIC X.                           ECSRITAB
  3167         88  CEDING-SINGLE-PREM-ONLY      VALUE 'A'.              ECSRITAB
  3168         88  CEDING-OUT-BALANCE-ONLY      VALUE 'B'.              ECSRITAB
  3169         88  CEDING-REDUCING-ONLY         VALUE 'C'  'F'.         ECSRITAB
  3170         88  CEDING-LEVEL-ONLY            VALUE 'D'  'E'.         ECSRITAB
  3171         88  CEDING-GROUP-ONLY            VALUE 'G'.              ECSRITAB
  3172         88  CEDING-GROUP-RED-LIFE-ONLY   VALUE 'H'.              ECSRITAB
  3173         88  CEDING-INDIVIDUAL-ONLY       VALUE 'I'.              ECSRITAB
  3174         88  CEDING-JOINT-ONLY            VALUE 'J'.              ECSRITAB
  3175         88  CEDING-SGL-PREM-REDUCING     VALUE 'K'.              ECSRITAB
  3176         88  CEDING-SGL-PREM-GROUP        VALUE 'L'.              ECSRITAB
  3177         88  CEDING-GROUP-LEVEL-ONLY      VALUE 'M'.              ECSRITAB
  3178         88  CEDING-SGL-PREM-GRP-REDUCING VALUE 'N'.              ECSRITAB
  3179         88  CEDING-SGL-PREM-GROUP-LEVEL  VALUE 'P'.              ECSRITAB
  3180         88  CEDING-GROUP-REDUCING-ONLY   VALUE 'R'.              ECSRITAB
  3181         88  CEDING-SINGLE-POLICIES-ONLY  VALUE 'S'.              ECSRITAB
  3182         88  CEDING-AH-ONLY               VALUE '1'.              ECSRITAB
  3183         88  CEDING-PROPERTY-ONLY         VALUE '2'.              ECSRITAB
  3184         88  CEDING-UNEMPLOYMENT-ONLY     VALUE '3'.              ECSRITAB
  3185         88  CEDING-AD-D-ONLY             VALUE '4'.              ECSRITAB
  3186         88  CEDING-LIFE-ONLY             VALUE '5'.              ECSRITAB
  3187         88  CEDING-DISMEMBERMENT-ONLY    VALUE '6'.              ECSRITAB
  3188         88  CEDING-7-DAY-RETRO           VALUE '7'.              ECSRITAB
  3189         88  CEDING-14-DAY-RETRO          VALUE '8'.              ECSRITAB
  3190     12  REIN-OPEN-SW            PIC X           VALUE SPACE.     ECSRITAB
  3191     12  REIN-SEARCH.                                             ECSRITAB
  3192         16  REIN-SRCH-COMP-CD   PIC X           VALUE SPACE.     ECSRITAB
  3193         16  REIN-SRCH-CODE      PIC X           VALUE SPACE.     ECSRITAB
  3194         16  REIN-SRCH           PIC XXX         VALUE SPACE.     ECSRITAB
  3195         16  FILLER              PIC XXX         VALUE LOW-VALUE. ECSRITAB
  3196     12  SAVE-REIN-SRCH          PIC XXX         VALUE SPACE.     ECSRITAB
  3197     12  REIN-BUS-FLAG           PIC X           VALUE SPACE.     ECSRITAB
  3198     12  RATE-WORK               PIC S9(8)V9(5)  COMP-3.          ECSRITAB
  3199     12  RATE-WORK-L             PIC S9(8)V9(5)  COMP-3.          ECSRITAB
  3200     12  RATE-WORK-A             PIC S9(8)V9(5)  COMP-3.          ECSRITAB
  3201     12  RS-LIFE-BEN             PIC S9(9)V99  COMP-3   VALUE +0. ECSRITAB
  3202     12  RS-LIFE-PREM            PIC S9(7)V99  COMP-3   VALUE +0. ECSRITAB
  3203     12  RS-AH-BEN               PIC S9(9)V99  COMP-3   VALUE +0. ECSRITAB
  3204     12  RS-AH-PREM              PIC S9(7)V99  COMP-3   VALUE +0. ECSRITAB
  3205     12  RS-LP-CALC              PIC S9(7)V99  COMP-3   VALUE +0. ECSRITAB
  3206     12  RS-AP-CALC              PIC S9(7)V99  COMP-3   VALUE +0. ECSRITAB
  3207     12  RS-R-LB                 PIC S9(9)V99  COMP-3   VALUE +0. ECSRITAB
  3208     12  RS-R-LP                 PIC S9(7)V99  COMP-3   VALUE +0. ECSRITAB
  3209     12  RS-R-AB                 PIC S9(9)V99  COMP-3   VALUE +0. ECSRITAB
  3210     12  RS-R-AP                 PIC S9(7)V99  COMP-3   VALUE +0. ECSRITAB
  3211     12  RS-R-LPC                PIC S9(7)V99  COMP-3   VALUE +0. ECSRITAB
  3212     12  RS-R-APC                PIC S9(7)V99  COMP-3   VALUE +0. ECSRITAB
  3213     12  BIN-RWF-EP-STOP-DT      PIC XX        VALUE SPACES.      ECSRITAB
  3214     12  BIN-CNT                 PIC 9(3)      VALUE ZEROES.      ECSRITAB
  3215     12  BIN-CR-DIS-DT           PIC XX        VALUE SPACES.      ECSRITAB
  3216     12  BIN-WT-HIGH-DT          PIC XX        VALUE SPACES.      ECSRITAB
  3217     12  BIN-WT-LO-DT            PIC XX        VALUE SPACES.      ECSRITAB
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  66
* ECS010MO.cbl (/apps/prod/cid1p/copy/ECSRITAB)
  3218     12  BIN-LF-CANC-DT          PIC XX        VALUE SPACES.      ECSRITAB
  3219     12  BIN-AH-CANC-DT          PIC XX        VALUE SPACES.      ECSRITAB
  3220     12  BIN-CR-DTH-DT           PIC XX        VALUE SPACES.      ECSRITAB
  3221                                                                  ECSRITAB
  3222 01  REIN-CO-HOLD-TABLE.                                          ECSRITAB
  3223* ELCPSEVR MUST BE MODIFIED IF THE "OCCURS" IS CHANGED.           ECSRITAB
  3224     12  REIN-CO-HOLD-ENTRIES  OCCURS 1500 TIMES.                 ECSRITAB
  3225         16  RCT-REIN-CO         PIC X(6).                        ECSRITAB
  3226         16  RCT-CLM-CUTOFF-DT   PIC 9(11)  COMP-3.               ECSRITAB
  3227         16  RCT-EARNING-START-DT PIC 9(11)  COMP-3.              ECSRITAB
  3228         16  RCT-EARNING-STOP-DT PIC 9(11)  COMP-3.               ECSRITAB
  3229         16  RCT-EARN-STOP-CODE  PIC X.                           ECSRITAB
  3230         16  RCT-LF-CLM-PCT      PIC S9V9(4)    COMP-3.           ECSRITAB
  3231         16  RCT-LF-CLM-MAX      PIC S9(9)V99   COMP-3.           ECSRITAB
  3232         16  RCT-AH-CLM-PCT      PIC S9V9(4)    COMP-3.           ECSRITAB
  3233         16  RCT-AH-CLM-MAX      PIC S9(9)V99   COMP-3.           ECSRITAB
  3234                                                                  ECSRITAB
  3235 01  REIN-CO-HOLD-TABLE-2.                                        ECSRITAB
  3236     12  RC2-CO-HOLD-ENTRIES  OCCURS 1500 TIMES.                  ECSRITAB
  3237         16  RC2-REIN-CO.                                         ECSRITAB
  3238             20  RC2-CO-PRIME    PIC XXX.                         ECSRITAB
  3239             20  RC2-CO-SUB      PIC XXX.                         ECSRITAB
  3240         16  RC2-LF-R78-PCT      PIC S9V9(4)    COMP-3.           ECSRITAB
  3241         16  RC2-LF-PRO-PCT      PIC S9V9(4)    COMP-3.           ECSRITAB
  3242         16  RC2-AH-R78-PCT      PIC S9V9(4)    COMP-3.           ECSRITAB
  3243         16  RC2-AH-PRO-PCT      PIC S9V9(4)    COMP-3.           ECSRITAB
  3244         16  RC2-CO-NAME         PIC X(30).                       ECSRITAB
  3245         16  RC2-ECS152-RPT      PIC X.                           ECSRITAB
  3246                                                                  ECSRITAB
  3247 01  REIN-MORT-CD-HOLD-TABLE.                                     ECSRITAB
  3248     12  REIN-MORT-CD-ENTRIES  OCCURS 1500 TIMES.                 ECSRITAB
  3249         16  RCT-MORT-CO         PIC X(6).                        ECSRITAB
  3250         16  RCT-MORT-CODE       PIC X(4).                        ECSRITAB
  3251     12  REIN-INDEX              PIC S9(4)    COMP    VALUE +0.   ECSRITAB
  3252                                                                  ECSRITAB
  3253 01  BIN-RCT-ITEMS-TABLE.                                         ECSRITAB
  3254     12  BIN-RCT-ITEMS OCCURS 1500 TIMES.                         ECSRITAB
  3255         16  BIN-RCT-CLM-CUTOFF-DT    PIC XX.                     ECSRITAB
  3256         16  BIN-RCT-EARNING-START-DT PIC XX.                     ECSRITAB
  3257         16  BIN-RCT-EARNING-STOP-DT  PIC XX.                     ECSRITAB
  3258 01  BIN-RW-ITEMS-TABLE.                                          ECSRITAB
  3259     12  BIN-RW-ITEMS OCCURS 5 TIMES.                             ECSRITAB
  3260         16  BIN-RW-AH-INCUR-DT       PIC XX.                     ECSRITAB
  3261                                                                  ECSRITAB
  3262 01  REIN-CO-TABLE-ENT-CNT       PIC S9(4)    COMP-3  VALUE +1500.ECSRITAB
  3263******************************************************************ECSRITAB
  3264
* 3265                             COPY ELCPSEVR.
  3266******************************************************************04/16/98
  3267*                                                                *ELCPSEVR
  3268*                                                                *ELCPSEVR
  3269*                            ELCPSEVR                            *   LV003
  3270*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  3271*                            VMOD=2.001                          *ELCPSEVR
  3272*                                                                *ELCPSEVR
  3273*   WORKING STORAGE FOR DATE VARIABLES CREATED                   *ELCPSEVR
  3274*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCPSEVR
  3275*                                                                *ELCPSEVR
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  67
* ECS010MO.cbl (/apps/prod/cid1p/copy/ELCPSEVR)
  3276******************************************************************ELCPSEVR
  3277                                                                  ELCPSEVR
  3278 01  WS-PD-SUMMARY-DETAIL-EXTR-DT.                                ELCPSEVR
  3279     05  WS-PSC-CID-LOW.                                          ELCPSEVR
  3280         10  FILLER               PIC 999.                        ELCPSEVR
  3281         10  PSC-CID-LOW-CCYY     PIC 9(04).                      ELCPSEVR
  3282         10  PSC-CID-LOW-CCYR  REDEFINES  PSC-CID-LOW-CCYY.       ELCPSEVR
  3283             15  PSC-CID-LOW-CC   PIC 99.                            CL**3
  3284             15  PSC-CID-LOW-YY   PIC 99.                            CL**3
  3285         10  PSC-CID-LOW-MM       PIC 99.                            CL**3
  3286         10  PSC-CID-LOW-DD       PIC 99.                            CL**3
  3287     05  WS-PSC-CID-LOW-N REDEFINES                                  CL**2
  3288            WS-PSC-CID-LOW        PIC 9(11).                         CL**2
  3289     05  WS-PSC-CID-HIGH.                                         ELCPSEVR
  3290         10  FILLER              PIC 999.                         ELCPSEVR
  3291         10  PSC-CID-HIGH-CCYY   PIC 9(04).                       ELCPSEVR
  3292         10  PSC-CID-HIGH-CCYR  REDEFINES  PSC-CID-HIGH-CCYY.     ELCPSEVR
  3293             15  PSC-CID-HIGH-CC PIC 99.                             CL**3
  3294             15  PSC-CID-HIGH-YY PIC 99.                             CL**3
  3295         10  PSC-CID-HIGH-MM     PIC 99.                             CL**3
  3296         10  PSC-CID-HIGH-DD     PIC 99.                             CL**3
  3297     05  WS-PSC-CID-HIGH-N REDEFINES                                 CL**2
  3298            WS-PSC-CID-HIGH          PIC 9(11).                      CL**2
  3299 01  WS-REIN-WORK-AREAS.                                          ELCPSEVR
  3300     05  WS-REIN-CO-HOLD-ENTRIES  OCCURS 1500 TIMES               ELCPSEVR
  3301                 INDEXED BY CPSE-NDX.                             ELCPSEVR
  3302         10  WS-RCT-CLM-CUTOFF-DT.                                ELCPSEVR
  3303             15  FILLER              PIC 999.                     ELCPSEVR
  3304             15  RCT-CUTOFF-CCYY     PIC 9(04).                   ELCPSEVR
  3305             15  RCT-CUTOFF-CCYR  REDEFINES  RCT-CUTOFF-CCYY.     ELCPSEVR
  3306                 20  RCT-CUTOFF-CC   PIC 99.                      ELCPSEVR
  3307                 20  RCT-CUTOFF-YR   PIC 99.                      ELCPSEVR
  3308             15  RCT-CUTOFF-MO       PIC 99.                      ELCPSEVR
  3309             15  RCT-CUTOFF-DA       PIC 99.                      ELCPSEVR
  3310         10  WS-RCT-CLM-CUTOFF-DT-N REDEFINES                        CL**2
  3311                WS-RCT-CLM-CUTOFF-DT PIC 9(11).                      CL**2
  3312         10  WS-RCT-EARNING-START-DT.                             ELCPSEVR
  3313             15  FILLER              PIC 999.                     ELCPSEVR
  3314             15  RCT-START-CCYY      PIC 9(04).                   ELCPSEVR
  3315             15  RCT-START-CCYR  REDEFINES  RCT-START-CCYY.       ELCPSEVR
  3316                 20  RCT-START-CC    PIC 99.                      ELCPSEVR
  3317                 20  RCT-START-YR    PIC 99.                      ELCPSEVR
  3318             15  RCT-START-MO        PIC 99.                      ELCPSEVR
  3319             15  RCT-START-DA        PIC 99.                      ELCPSEVR
  3320         10  WS-RCT-EARNING-START-DT-N REDEFINES                     CL**2
  3321                WS-RCT-EARNING-START-DT  PIC 9(11).                  CL**2
  3322         10  WS-RCT-EARNING-STOP-DT.                              ELCPSEVR
  3323             15  FILLER              PIC 999.                     ELCPSEVR
  3324             15  RCT-STOP-CCYY       PIC 9(04).                   ELCPSEVR
  3325             15  RCT-STOP-CCYR  REDEFINES  RCT-STOP-CCYY.         ELCPSEVR
  3326                 20  RCT-STOP-CC     PIC 99.                      ELCPSEVR
  3327                 20  RCT-STOP-YR     PIC 99.                      ELCPSEVR
  3328             15  RCT-STOP-MO         PIC 99.                      ELCPSEVR
  3329             15  RCT-STOP-DA         PIC 99.                      ELCPSEVR
  3330         10  WS-RCT-EARNING-STOP-DT-N REDEFINES                      CL**2
  3331                WS-RCT-EARNING-STOP-DT   PIC 9(11).                  CL**2
  3332     05  WS-RWF-EP-STOP-DATE.                                     ELCPSEVR
  3333         10  FILLER              PIC 999.                         ELCPSEVR
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  68
* ECS010MO.cbl (/apps/prod/cid1p/copy/ELCPSEVR)
  3334         10  RWF-EP-STOP-CCYY    PIC 9(04).                       ELCPSEVR
  3335         10  RWF-EP-STOP-CCYR REDEFINES  RWF-EP-STOP-CCYY.        ELCPSEVR
  3336             15  RWF-EP-STOP-CC  PIC 99.                          ELCPSEVR
  3337             15  RWF-EP-STOP-YR  PIC 99.                          ELCPSEVR
  3338         10  RWF-EP-STOP-MO      PIC 99.                          ELCPSEVR
  3339         10  RWF-EP-STOP-DA      PIC 99.                          ELCPSEVR
  3340     05  WS-RWF-EP-STOP-DATE-N REDEFINES                             CL**2
  3341            WS-RWF-EP-STOP-DATE  PIC 9(11).                          CL**2
  3342
* 3343                             COPY ELCEPCVR.
  3344******************************************************************05/15/98
  3345*                                                                *ELCEPCVR
  3346*                                                                *ELCEPCVR
  3347*                            ELCEPCVR                            *   LV003
  3348*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  3349*                            VMOD=2.001                          *ELCEPCVR
  3350*                                                                *ELCEPCVR
  3351*   WORKING STORAGE FOR DATE VARIABLES CREATED                   *ELCEPCVR
  3352*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCEPCVR
  3353*                                                                *ELCEPCVR
  3354******************************************************************ELCEPCVR
  3355 01  WS-EP-RECORD-DATE.                                           ELCEPCVR
  3356     05  WS-EP-EXP-DTE.                                           ELCEPCVR
  3357         10  FILLER            PIC 999.                           ELCEPCVR
  3358         10  EP-EXP-CCYY       PIC 9(04).                         ELCEPCVR
  3359         10  EP-EXP-CCYR  REDEFINES  EP-EXP-CCYY.                 ELCEPCVR
  3360             15  EP-EXP-CC     PIC 99.                            ELCEPCVR
  3361             15  EP-EXP-YR     PIC 99.                            ELCEPCVR
  3362         10  EP-EXP-MO         PIC 99.                            ELCEPCVR
  3363         10  EP-EXP-DA         PIC 99.                            ELCEPCVR
  3364     05  WS-EP-EXP-DTE-N REDEFINES                                   CL**3
  3365            WS-EP-EXP-DTE      PIC 9(11).                            CL**3
  3366     05  WS-EC-EXP-DTE REDEFINES WS-EP-EXP-DTE.                      CL**5
  3367         10  FILLER            PIC 999.                              CL**5
  3368         10  EC-EXP-CCYY       PIC 9(04).                            CL**5
  3369         10  EC-EXP-CCYR  REDEFINES  EC-EXP-CCYY.                    CL**5
  3370             15  EC-EXP-CC     PIC 99.                               CL**5
  3371             15  EC-EXP-YR     PIC 99.                               CL**5
  3372         10  EC-EXP-MO         PIC 99.                               CL**5
  3373         10  EC-EXP-DA         PIC 99.                               CL**5
  3374     05  WS-EC-EXP-DTE-N REDEFINES                                   CL**5
  3375            WS-EC-EXP-DTE      PIC 9(11).                            CL**5
  3376     05  WS-EP-EFF-DTE.                                           ELCEPCVR
  3377         10  FILLER            PIC 999.                           ELCEPCVR
  3378         10  EP-EFF-CCYY       PIC 9(04).                         ELCEPCVR
  3379         10  EP-EFF-CCYR  REDEFINES  EP-EFF-CCYY.                 ELCEPCVR
  3380             15  EP-EFF-CC     PIC 99.                            ELCEPCVR
  3381             15  EP-EFF-YR     PIC 99.                            ELCEPCVR
  3382         10  EP-EFF-MO         PIC 99.                            ELCEPCVR
  3383         10  EP-EFF-DA         PIC 99.                            ELCEPCVR
  3384     05  WS-EP-EFF-DTE-N REDEFINES                                   CL**3
  3385            WS-EP-EFF-DTE      PIC 9(11).                            CL**3
  3386     05  WS-EC-EFF-DTE REDEFINES WS-EP-EFF-DTE.                      CL**5
  3387         10  FILLER            PIC 999.                              CL**5
  3388         10  EC-EFF-CCYY       PIC 9(04).                            CL**5
  3389         10  EC-EFF-CCYR  REDEFINES  EC-EFF-CCYY.                    CL**5
  3390             15  EC-EFF-CC     PIC 99.                               CL**5
  3391             15  EC-EFF-YR     PIC 99.                               CL**5
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  69
* ECS010MO.cbl (/apps/prod/cid1p/copy/ELCEPCVR)
  3392         10  EC-EFF-MO         PIC 99.                               CL**5
  3393         10  EC-EFF-DA         PIC 99.                               CL**5
  3394     05  WS-EC-EFF-DTE-N REDEFINES                                   CL**5
  3395            WS-EC-EFF-DTE      PIC 9(11).                            CL**5
  3396     05  WS-EP-HI-COV-DT.                                         ELCEPCVR
  3397         10  FILLER            PIC 999.                           ELCEPCVR
  3398         10  EP-COV-CCYY       PIC 9(04).                         ELCEPCVR
  3399         10  EP-COV-CCYR  REDEFINES  EP-COV-CCYY.                 ELCEPCVR
  3400             15  EP-COV-CC     PIC 99.                            ELCEPCVR
  3401             15  EP-COV-YR     PIC 99.                            ELCEPCVR
  3402         10  EP-COV-MO         PIC 99.                            ELCEPCVR
  3403         10  EP-COV-DA         PIC 99.                            ELCEPCVR
  3404     05  WS-EP-HI-COV-DT-N REDEFINES                                 CL**3
  3405            WS-EP-HI-COV-DT    PIC 9(11).                            CL**3
  3406     05  WS-EP-HI-CERT.                                           ELCEPCVR
  3407         10  FILLER            PIC 999.                           ELCEPCVR
  3408         10  EP-HI-CCYY        PIC 9(04).                         ELCEPCVR
  3409         10  EP-HI-CCYR  REDEFINES  EP-HI-CCYY.                   ELCEPCVR
  3410             15  EP-HI-CC      PIC 99.                            ELCEPCVR
  3411             15  EP-HI-YR      PIC 99.                            ELCEPCVR
  3412         10  EP-HI-MO          PIC 99.                            ELCEPCVR
  3413         10  EP-HI-DA          PIC 99.                            ELCEPCVR
  3414     05  WS-EP-HI-CERT-N REDEFINES                                   CL**3
  3415            WS-EP-HI-CERT      PIC 9(11).                            CL**3
  3416     05  WS-EP-LO-CERT.                                           ELCEPCVR
  3417         10  FILLER            PIC 999.                           ELCEPCVR
  3418         10  EP-LO-CCYY        PIC 9(04).                         ELCEPCVR
  3419         10  EP-LO-CCYR  REDEFINES   EP-LO-CCYY.                  ELCEPCVR
  3420             15  EP-LO-CC      PIC 99.                            ELCEPCVR
  3421             15  EP-LO-YR      PIC 99.                            ELCEPCVR
  3422         10  EP-LO-MO          PIC 99.                            ELCEPCVR
  3423         10  EP-LO-DA          PIC 99.                            ELCEPCVR
  3424     05  WS-EP-LO-CERT-N REDEFINES                                   CL**3
  3425            WS-EP-LO-CERT      PIC 9(11).                            CL**3
  3426     05  WS-EP-RUN-DTE.                                           ELCEPCVR
  3427         10  FILLER            PIC 999.                           ELCEPCVR
  3428         10  EP-RUN-CCYY       PIC 9(04).                         ELCEPCVR
  3429         10  EP-RUN-CCYR  REDEFINES  EP-RUN-CCYY.                 ELCEPCVR
  3430             15  EP-RUN-CC     PIC 99.                            ELCEPCVR
  3431             15  EP-RUN-YR     PIC 99.                            ELCEPCVR
  3432         10  EP-RUN-MO         PIC 99.                            ELCEPCVR
  3433         10  EP-RUN-DA         PIC 99.                            ELCEPCVR
  3434     05  WS-EP-RUN-DTE-N REDEFINES                                   CL**3
  3435            WS-EP-RUN-DTE      PIC 9(11).                            CL**3
  3436     05  WS-EC-RUN-DTE REDEFINES WS-EP-RUN-DTE.                      CL**5
  3437         10  FILLER            PIC 999.                           ELCEPCVR
  3438         10  EC-RUN-CCYY       PIC 9(04).                         ELCEPCVR
  3439         10  EC-RUN-CCYR  REDEFINES  EC-RUN-CCYY.                 ELCEPCVR
  3440             15  EC-RUN-CC     PIC 99.                            ELCEPCVR
  3441             15  EC-RUN-YR     PIC 99.                            ELCEPCVR
  3442         10  EC-RUN-MO         PIC 99.                            ELCEPCVR
  3443         10  EC-RUN-DA         PIC 99.                            ELCEPCVR
  3444     05  WS-EC-RUN-DTE-N REDEFINES                                   CL**3
  3445            WS-EC-RUN-DTE      PIC 9(11).                            CL**3
  3446
* 3447                             COPY ELCREINV.
  3448******************************************************************04/18/98
  3449*                                                                *ELCREINV
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  70
* ECS010MO.cbl (/apps/prod/cid1p/copy/ELCREINV)
  3450*                                                                *ELCREINV
  3451*                            ELCREINV                            *   LV003
  3452*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  3453*                            VMOD=2.001                          *ELCREINV
  3454*                                                                *ELCREINV
  3455*   WORKING STORAGE FOR DATE VARIABLES CREATED                   *ELCREINV
  3456*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCREINV
  3457*                                                                *ELCREINV
  3458******************************************************************ELCREINV
  3459                                                                  ELCREINV
  3460 01  WS-REINSURANCE-RECORD-DATE.                                  ELCREINV
  3461     05  WS-RE-LO-DATE.                                              CL**3
  3462         10 FILLER                     PIC 999.                      CL**3
  3463         10 RE-LO-CCYY                 PIC 9(04).                    CL**3
  3464         10 RE-LO-CCYR  REDEFINES  RE-LO-CCYY.                       CL**3
  3465            15 RE-LO-CC                PIC 99.                       CL**3
  3466            15 RE-LO-YR                PIC 99.                       CL**3
  3467         10 RE-LO-MO                   PIC 99.                       CL**3
  3468         10 RE-LO-DA                   PIC 99.                       CL**3
  3469     05  WS-RE-LO-DATE-N REDEFINES                                   CL**3
  3470            WS-RE-LO-DATE              PIC 9(11).                    CL**3
  3471     05  WS-RE-HI-DATE.                                              CL**3
  3472         10 FILLER                     PIC 999.                      CL**3
  3473         10 RE-HI-CCYY                 PIC 9(04).                    CL**3
  3474         10 RE-HI-CCYR  REDEFINES  RE-HI-CCYY.                       CL**3
  3475            15 RE-HI-CC                PIC 99.                       CL**3
  3476            15 RE-HI-YR                PIC 99.                       CL**3
  3477         10 RE-HI-MO                   PIC 99.                       CL**3
  3478         10 RE-HI-DA                   PIC 99.                       CL**3
  3479     05  WS-RE-HI-DATE-N REDEFINES                                   CL**3
  3480            WS-RE-HI-DATE              PIC 9(11).                    CL**3
  3481     05  WS-RE-CLM-INCURRED-LIM.                                  ELCREINV
  3482         10 FILLER                     PIC 999.                   ELCREINV
  3483         10 RE-CLM-CCYY                PIC 9(04).                 ELCREINV
  3484         10 RE-CLM-CCYR  REDEFINES  RE-CLM-CCYY.                  ELCREINV
  3485            15 RE-CLM-CC               PIC 99.                    ELCREINV
  3486            15 RE-CLM-YR               PIC 99.                    ELCREINV
  3487         10 RE-CLM-MO                  PIC 99.                    ELCREINV
  3488         10 RE-CLM-DA                  PIC 99.                    ELCREINV
  3489     05  WS-RE-CLM-INCURRED-LIM-N REDEFINES                          CL**2
  3490            WS-RE-CLM-INCURRED-LIM     PIC 9(11).                    CL**2
  3491     05  WS-RE-EARNING-START-DT.                                  ELCREINV
  3492         10  FILLER                    PIC 999.                   ELCREINV
  3493         10  RE-EARN-CCYY              PIC 9(04).                 ELCREINV
  3494         10  RE-EARN-CCYR  REDEFINES  RE-EARN-CCYY.               ELCREINV
  3495             15  RE-EARN-CC            PIC 99.                    ELCREINV
  3496             15  RE-EARN-YR            PIC 99.                    ELCREINV
  3497         10  RE-EARN-MO                PIC 99.                    ELCREINV
  3498         10  RE-EARN-DA                PIC 99.                    ELCREINV
  3499     05  WS-RE-EARNING-START-DT-N REDEFINES                          CL**2
  3500            WS-RE-EARNING-START-DT     PIC 9(11).                    CL**2
  3501     05  WS-RE-EARNING-STOP-DT.                                   ELCREINV
  3502         10  FILLER                    PIC 999.                   ELCREINV
  3503         10  RE-EARN-STOP-CCYY         PIC 9(04).                 ELCREINV
  3504         10  RE-EARN-STOP-CCYR  REDEFINES  RE-EARN-STOP-CCYY.     ELCREINV
  3505             15  RE-EARN-STOP-CC       PIC 99.                    ELCREINV
  3506             15  RE-EARN-STOP-YR       PIC 99.                    ELCREINV
  3507         10  RE-EARN-STOP-MO           PIC 99.                    ELCREINV
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  71
* ECS010MO.cbl (/apps/prod/cid1p/copy/ELCREINV)
  3508         10  RE-EARN-STOP-DA           PIC 99.                    ELCREINV
  3509     05  WS-RE-EARNING-STOP-DT-N REDEFINES                           CL**2
  3510            WS-RE-EARNING-STOP-DT      PIC 9(11).                    CL**2
  3511
  3512 01  RC-REIN-HOLD-AREAS.
  3513     12  RC-REIN-LEVELS  OCCURS 30.
  3514         16  RC-REIN-COMP    PIC X(6).
  3515         16  RC-OLD-ISS      PIC X.
  3516         16  RC-NEW-ISS      PIC X.
  3517         16  RC-OLD-CNC      PIC X.
  3518         16  RC-NEW-CNC      PIC X.
  3519         16  RC-OLD-LF-CLM   PIC X.
  3520         16  RC-OLD-AH-CLM   PIC X.
  3521         16  RC-NEW-LF-CLM   PIC X.
  3522         16  RC-NEW-AH-CLM   PIC X.
  3523         16  RC-REIN-LFAMT   PIC S9(9)V99    COMP-3.
  3524         16  RC-REIN-LFPRM   PIC S9(7)V99    COMP-3.
  3525         16  RC-REIN-AHAMT   PIC S9(7)V99    COMP-3.
  3526         16  RC-REIN-AHPRM   PIC S9(7)V99    COMP-3.
  3527         16  RC-REIN-LFRFND  PIC S9(7)V99    COMP-3.
  3528         16  RC-REIN-AHRFND  PIC S9(7)V99    COMP-3.
  3529         16  RC-REIN-LFCLM   PIC S9(9)V99    COMP-3.
  3530         16  RC-REIN-AHCLM   PIC S9(9)V99    COMP-3.
  3531         16  RC-REIN-REM-SW  PIC X.
  3532     12  RC-REIN-LEVELS-END  PIC X(6).
  3533
  3534 01  TOTAL-PAGES-COUNTERS    COMP-3.
  3535     12  TPC-COUNTERS    OCCURS 6.
  3536         16  TPL-ISS-PRM     PIC S9(9)V99.
  3537         16  TPA-ISS-PRM     PIC S9(9)V99.
  3538         16  TPL-CNC-PRM     PIC S9(9)V99.
  3539         16  TPA-CNC-PRM     PIC S9(9)V99.
  3540         16  TPL-ACCT-COM    PIC S9(9)V99.
  3541         16  TPA-ACCT-COM    PIC S9(9)V99.
  3542         16  TPL-CLAIMS      PIC S9(9)V99.
  3543         16  TPA-CLAIMS      PIC S9(9)V99.
  3544
  3545 01  HLD-DTS SYNC.
  3546     12  EOM-RUN-DATE        PIC 9(08).
  3547     12  EOM-RUN-DATE-R REDEFINES EOM-RUN-DATE.
  3548         16  EOM-CCYY.
  3549             20  EOM-CC      PIC 99.
  3550             20  EOM-YR      PIC 99.
  3551         16  EOM-MO          PIC 99.
  3552         16  EOM-DA          PIC 99.
  3553
  3554****   1ST OCCURRENCE IS MONTHEND DATE MINUS ONE MONTH
  3555****   2ND OCCURRENCE IS MONTHEND DATE MINUS TWO MONTHS
  3556     12  OB-RUN-DATES OCCURS 2.
  3557         16  OB-CCYY         PIC 9(4).
  3558         16  OB-MO           PIC 99.
  3559         16  OB-DA           PIC 99.
  3560
  3561     12  OB-DATE-1-SWITCH    PIC X           VALUE SPACE.
  3562         88  OB-DATE-1-USED     VALUE '*'.
  3563     12  OB-DATE-2-SWITCH    PIC X           VALUE SPACE.
  3564         88  OB-DATE-2-USED     VALUE '*'.
  3565     12  OB-DATE-3-SWITCH    PIC X           VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  72
* ECS010MO.cbl
  3566         88  OB-DATE-3-USED     VALUE '*'.
  3567     12  EARNING-START-DATE  PIC 9(08).
  3568     12  EARNING-START-DATE-R REDEFINES  EARNING-START-DATE.
  3569         16  E-ERN-START-CC  PIC 99.
  3570         16  E-ERN-START-YR  PIC 99.
  3571         16  E-ERN-START-MO  PIC 99.
  3572         16  E-ERN-START-DA  PIC 99.
  3573     12  EARNING-STOP-DATE   PIC 9(08).
  3574     12  EARNING-STOP-DATE-R REDEFINES  EARNING-STOP-DATE.
  3575         16  E-ERN-STOP-CC   PIC 99.
  3576         16  E-ERN-STOP-YR   PIC 99.
  3577         16  E-ERN-STOP-MO   PIC 99.
  3578         16  E-ERN-STOP-DA   PIC 99.
  3579     12  STOP-LF-DATE        PIC 9(08).
  3580     12  STOP-LF-DATE-R REDEFINES STOP-LF-DATE.
  3581         16  STOP-LF-CC      PIC 99.
  3582         16  STOP-LF-YR      PIC 99.
  3583         16  STOP-LF-MO      PIC 99.
  3584         16  STOP-LF-DA      PIC 99.
  3585     12  STOP-AH-DATE        PIC 9(08).
  3586     12  STOP-AH-DATE-R REDEFINES STOP-AH-DATE.
  3587         16  STOP-AH-CC      PIC 99.
  3588         16  STOP-AH-YR      PIC 99.
  3589         16  STOP-AH-MO      PIC 99.
  3590         16  STOP-AH-DA      PIC 99.
  3591     12  BIN-VALUATION-DT    PIC XX.
  3592     12  BIN-EOM-RUN-DATE    PIC XX.
  3593     12  LAST-YRS-DATE       PIC 9(08).
  3594     12  LAST-YRS-DATE-R  REDEFINES  LAST-YRS-DATE.
  3595         16  LYD-CCYY        PIC 9(04).
  3596         16  LYD-CCYR REDEFINES LYD-CCYY.
  3597             20  LYD-CC      PIC 99.
  3598             20  LYD-YR      PIC 99.
  3599         16  LYD-MO          PIC 99.
  3600         16  LYD-DA          PIC 99.
  3601     12  VALUATION-DT        PIC 9(08)  VALUE 0.
  3602     12  VALUATION-DT-R REDEFINES VALUATION-DT.
  3603         16  VAL-CC          PIC 99.
  3604         16  VAL-YR          PIC 99.
  3605         16  VAL-MO          PIC 99.
  3606         16  VAL-DA          PIC 99.
  3607     12  INCURRED-DATE       PIC 9(08).
  3608     12  INCURRED-DATE-R REDEFINES INCURRED-DATE.
  3609         16  DTO-CC          PIC 99.
  3610         16  DTO-YR          PIC 99.
  3611         16  DTO-MO          PIC 99.
  3612         16  DTO-DA          PIC 99.
  3613     12  REPORTED-DATE.
  3614         16  RPT-YR          PIC 99.
  3615         16  RPT-MO          PIC 99.
  3616         16  RPT-DA          PIC 99.
  3617     12  PAYMENT-DATE        PIC 9(08).
  3618     12  PAYMENT-DATE-R REDEFINES PAYMENT-DATE.
  3619         16  PAY-CC          PIC 99.
  3620         16  PAY-YR          PIC 99.
  3621         16  PAY-MO          PIC 99.
  3622         16  PAY-DA          PIC 99.
  3623     12  PAY-TO-DATE         PIC 9(8).
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  73
* ECS010MO.cbl
  3624     12  PAY-TO-DATE-R  REDEFINES PAY-TO-DATE.
  3625         16  PAYTO-CC        PIC 99.
  3626         16  PAYTO-YR        PIC 99.
  3627         16  PAYTO-MO        PIC 99.
  3628         16  PAYTO-DA        PIC 99.
  3629
  3630 01  AH-RES-STATE-TABLE.
  3631     12  FILLER              PIC X(42)       VALUE
  3632             'AKALAZCADEGAIDILKSKYLAMDMIMTNVOHORSCSDWIWY'.
  3633     12  FILLER              PIC XX          VALUE HIGH-VALUES.
  3634
  3635 01  AH-RES-STATE-TAB REDEFINES AH-RES-STATE-TABLE.
  3636     12  AH-RES-STATE-ENT    PIC XX      OCCURS 22 TIMES.
  3637
  3638 01  BILLING-COUNTERS    COMP-3.
  3639     12  BC-NET-WRIT         PIC S9(7)V99        VALUE +0.
  3640     12  BC-NET-WRIT-SP      PIC S9(7)V99        VALUE +0.
  3641     12  BC-NET-WRIT-OB      PIC S9(7)V99        VALUE +0.
  3642     12  BC-G-ISS            PIC S9(5)           VALUE +0.
  3643     12  BC-G-CNC            PIC S9(5)           VALUE +0.
  3644     12  BC-G-CLM            PIC S9(5)           VALUE +0.
  3645     12  BC-G-CRS            PIC S9(5)           VALUE +0.
  3646     12  BC-G-CTN            PIC S9(5)           VALUE +0.
  3647     12  BC-R-ISS            PIC S9(5)           VALUE +0.
  3648     12  BC-R-CNC            PIC S9(5)           VALUE +0.
  3649     12  BC-R-CLM            PIC S9(5)           VALUE +0.
  3650     12  BC-R-CRS            PIC S9(5)           VALUE +0.
  3651     12  BC-R-CTN            PIC S9(5)           VALUE +0.
  3652     12  BC-COMM             PIC S9(5)           VALUE +0.
  3653     12  BC-NEW-ACCTS        PIC S9(5)           VALUE +0.
  3654     12  BC-ACCTS            PIC S9(5)           VALUE +0.
  3655     12  BC-ACT-ACCTS        PIC S9(5)           VALUE +0.
  3656     12  BC-G-CERTS          PIC S9(7)           VALUE +0.
  3657     12  BC-G-A-CERTS        PIC S9(7)           VALUE +0.
  3658     12  BC-R-CERTS          PIC S9(7)           VALUE +0.
  3659     12  BC-R-A-CERTS        PIC S9(7)           VALUE +0.
  3660     12  BC-ER-ACCTS         PIC S9(5)           VALUE +0.
  3661     12  BC-CS-ACCTS         PIC S9(5)           VALUE +0.
  3662     12  ACTIVE-COUNT        PIC S9              VALUE +0.
  3663
  3664 01  FLAGS SYNC.
  3665     12  BILLED-SWITCH           PIC X           VALUE 'N'.
  3666         88  CHECK-BILLED                        VALUE 'Y'.
  3667     12  TRANS-EOF-FLAG          PIC X           VALUE SPACE.
  3668         88  EOF-ON-TRANS                        VALUE '*'.
  3669     12  CERT-EOF-FLAG           PIC X           VALUE SPACE.
  3670         88  EOF-ON-CERT                         VALUE '*'.
  3671     12  PROCESSING-FLAG         PIC X           VALUE SPACE.
  3672         88  PROCESSING-COMPLETED                VALUE '*'.
  3673     12  DEATH-VOID-FLAG         PIC X           VALUE SPACE.
  3674         88  DEATH-CLAIM-VOIDED                  VALUE '*'.
  3675     12  CERT-CHANGE-FLAG        PIC X           VALUE SPACE.
  3676         88  PRINTING-CERT-CHANGES               VALUE '*'.
  3677     12  STATUTORY-SWITCH        PIC X           VALUE SPACE.
  3678         88  STATUTORY-REQUIREMENT               VALUE '*'.
  3679     12  STATUTORY-SWITCH-AH     PIC X           VALUE SPACE.
  3680         88  STATUTORY-REQUIREMENT-AH            VALUE '*'.
  3681     12  LIFE-EARNED-SWITCH      PIC X           VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  74
* ECS010MO.cbl
  3682         88  LIFE-FULLY-EARNED                   VALUE '*'.
  3683     12  A-H-EARNED-SWITCH       PIC X           VALUE SPACE.
  3684         88  A-H-FULLY-EARNED                    VALUE '*'.
  3685     12  CNCL-FLG            PIC X               VALUE SPACE.
  3686     12  TRANSACTION-FLAG    PIC X               VALUE SPACE.
  3687         88  NO-TRANSACTION-WAS-PROCESSED    VALUE SPACE.
  3688         88  TRANSACTION-WAS-PROCESSED       VALUE '*'.
  3689     12  RISK-REIN-FLAG      PIC X               VALUE SPACE.
  3690         88  REIN-IS-RISK-PREMIUM            VALUE '*'.
  3691     12  RISK-PREM-FLAG      PIC X               VALUE SPACE.
  3692         88  UPDATING-RISK-PREMIUMS          VALUE '*'.
  3693     12  EP-FLG              PIC X               VALUE SPACE.
  3694     12  END-FLG             PIC X               VALUE SPACE.
  3695     12  PRIOR-MATCH-CNTRL   PIC X(36)           VALUE LOW-VALUE.
  3696     12  PRIOR-CERT-IN-CNTRL PIC X(36)           VALUE LOW-VALUE.
  3697     12  ACCT-FLG            PIC X               VALUE SPACE.
  3698     12  STATE-FLG           PIC X               VALUE SPACE.
  3699     12  COMP-FLG            PIC X               VALUE SPACE.
  3700     12  CARR-FLG            PIC X               VALUE SPACE.
  3701     12  FINAL-FLG           PIC X               VALUE SPACE.
  3702     12  LOW-CTL             PIC X(19)           VALUE SPACES.
  3703     12  REIN-FLG            PIC X               VALUE SPACE.
  3704     12  REIN-EP-FLG         PIC X               VALUE SPACE.
  3705     12  REIN-RT-SW          PIC X               VALUE SPACE.
  3706
  3707 01  TEXAS-REG-WORK-AREAS   SYNC.
  3708     12  TEX-FACT-1          PIC S9(9)V99    COMP-3.
  3709     12  TEX-FACT-2          PIC S999        COMP-3.
  3710     12  TEX-FACT-3          PIC S999        COMP-3.
  3711     12  TEX-FACT-4          PIC S9(7)       COMP-3.
  3712     12  TEX-FACT-5          PIC S999        COMP-3.
  3713     12  TEX-FACT-6          PIC S999        COMP-3.
  3714     12  TEX-FACT-7          PIC S9(7)       COMP-3.
  3715     12  TEX-FACT-8          PIC S9V9(6)     COMP-3.
  3716     12  TEX-FACT-9          PIC S9(4)V9(11) COMP-3.
  3717
  3718 01  NET-PAY-INTERFACE.
  3719     12  NP-APR              PIC S999V9(4)   COMP-3.
  3720     12  NP-ORIG             PIC S999        COMP-3.
  3721     12  NP-REM              PIC S999        COMP-3.
  3722     12  NP-OPT              PIC X.
  3723     12  NP-CAP              PIC S999        COMP-3.
  3724     12  NP-FACTOR           PIC S9(4)V9(9)  COMP-3.
  3725     12  NP-WORK1            PIC S9(9)V9(9)  COMP-3.
  3726     12  NP-WORK2            PIC S9(9)V9(9)  COMP-3.
  3727     12  NP-BENEFIT          PIC S9(9)V99    COMP-3.
  3728     12  NP-REMAINING        PIC S9(9)V99    COMP-3.
  3729     12  NP-AHPRM            PIC S9(7)V99    COMP-3.
  3730     12  NP-ACCOUNT          PIC X(10).
  3731
  3732 01  HOLDERS SYNC.
  3733     12  DIS-IBNR            PIC S9(7)V99 COMP-3 VALUE +0.
  3734     12  DIS-PAYCUR          PIC S9(7)V99 COMP-3 VALUE +0.
  3735     12  DIS-FUTRSV          PIC S9(7)V99 COMP-3 VALUE +0.
  3736     12  DTH-IBNR            PIC S9(7)V99 COMP-3 VALUE +0.
  3737     12  DTH-PAYCUR          PIC S9(7)V99 COMP-3 VALUE +0.
  3738     12  DTH-FUTRSV          PIC S9(7)V99 COMP-3 VALUE +0.
  3739     12  EXCESS-RESERVE      PIC S9(7)V99 COMP-3 VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  75
* ECS010MO.cbl
  3740     12  H-LFCM              PIC S9(9)V99 COMP-3 VALUE +0.
  3741     12  H-AHCM              PIC S9(9)V99 COMP-3 VALUE +0.
  3742     12  TEMP-1              PIC S9(5)V99 COMP-3 VALUE +0.
  3743     12  TEMP-2              PIC S9(5)V99 COMP-3 VALUE +0.
  3744     12  TEMP-3              PIC S9(7)V99 COMP-3 VALUE +0.
  3745     12  TEMP-4              PIC S9V9(6)  COMP-3 VALUE +0.
  3746     12  TEMP-5              PIC S9V9(9)  COMP-3 VALUE +0.
  3747     12  TEMP-6              PIC S99V9(6) COMP-3 VALUE +0.
  3748     12  TEMP-7              PIC S9(9)V99 COMP-3 VALUE +0.
  3749     12  TEMP-8              PIC S9(9)V99 COMP-3 VALUE +0.
  3750     12  REM-TRM1            PIC S999V99  COMP-3.
  3751     12  REM-TRM2            PIC S999V99  COMP-3.
  3752     12  REM-TRM3            PIC S999V99  COMP-3.
  3753     12  TEM-TRM1            PIC S999V99  COMP-3.
  3754     12  MAX-REM-TERM        PIC S999V99  COMP-3.
  3755     12  ORIG-TERM           PIC S999V99  COMP-3.
  3756     12  HLD-CONTROL.
  3757         16  HLD-CARRIER     PIC X               VALUE SPACES.
  3758         16  HLD-GROUPING    PIC X(6)            VALUE SPACES.
  3759         16  HLD-STATE       PIC XX              VALUE SPACES.
  3760         16  HLD-ACCT        PIC X(10)           VALUE SPACES.
  3761     12  LN-MX               PIC S999     COMP-3 VALUE +56.
  3762
  3763 01  DISPLAY-IBNR-LINE.
  3764     05  FILLER                  PIC X       VALUE SPACES.
  3765     05  DIL-COMMENT             PIC X(20)   VALUE SPACES.
  3766     05  FILLER                  PIC XX      VALUE SPACES.
  3767     05  DIL-TYPE                PIC X       VALUE SPACES.
  3768     05  FILLER                  PIC X       VALUE SPACES.
  3769     05  DIL-BEN-CODE            PIC ZZ      VALUE SPACES.
  3770     05  FILLER                  PIC XXX     VALUE SPACES.
  3771     05  DIL-AMOUNT              PIC ZZZ9.99999-.
  3772
  3773 01  DISPLAY-HD-1.
  3774     05  FILLER      PIC X       VALUE SPACES.
  3775     05  FILLER      PIC X(50)   VALUE SPACES.
  3776     05  FILLER      PIC X(23)   VALUE 'PROCESSING ERROR REPORT'.
  3777     05  FILLER      PIC X(51)   VALUE SPACES.
  3778     05  FILLER      PIC X(8)    VALUE 'ECS010 '.
  3779
  3780 01  DISPLAY-HD-2.
  3781     05  FILLER                 PIC X       VALUE SPACE.
  3782     05  FILLER                 PIC X(57)   VALUE SPACES.
  3783     05  DIS-DATE               PIC X(8).
  3784     05  FILLER                 PIC X(66)   VALUE SPACES.
  3785
  3786 01  DISPLAY-LINE.
  3787     05  DL-FULL.
  3788         10  FILLER           PIC X       VALUE SPACE.
  3789         10  DIS-LINE-REASON  PIC X(32)   VALUE SPACES.
  3790         10  DIS-LINE-REC     PIC X(100)  VALUE SPACES.
  3791
  3792 01  PRT-HDNGS SYNC.
  3793     12  TR-HD-1.
  3794         16  FILLER      PIC X       VALUE '1'.
  3795         16  FILLER      PIC X(53)   VALUE SPACES.
  3796         16  FILLER      PIC X(18)   VALUE 'TRANSACTION REPORT'.
  3797         16  FILLER      PIC X(48)   VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  76
* ECS010MO.cbl
  3798         16  FILLER      PIC X(8)    VALUE 'ECS010 '.
  3799     12  TR-HD-2.
  3800         16  FILLER      PIC X       VALUE SPACE.
  3801         16  FILLER      PIC X(47)   VALUE SPACES.
  3802         16  TRHDNM      PIC X(30).
  3803         16  FILLER      PIC X(42)   VALUE SPACES.
  3804         16  TR-RN-DT    PIC X(8).
  3805     12  TR-HD-3.
  3806         16  FILLER      PIC X       VALUE SPACE.
  3807         16  FILLER      PIC X(53)   VALUE SPACES.
  3808         16  TR-MODAYR   PIC X(18).
  3809         16  FILLER      PIC X       VALUE SPACE.
  3810         16  TR-YRASK    PIC X       VALUE SPACE.
  3811         16  FILLER      PIC X(46)   VALUE SPACES.
  3812         16  FILLER      PIC X(5)    VALUE 'PAGE '.
  3813         16  TR-PG       PIC ZZ,ZZ9.
  3814     12  TR-HD-4.
  3815         16  FILLER      PIC X       VALUE SPACE.
  3816         16  TR-AGCY     PIC X(30).
  3817     12  TR-HD-5.
  3818         16  FILLER      PIC X       VALUE SPACE.
  3819         16  TR-CARR     PIC X.
  3820         16  FILLER      PIC X       VALUE '-'.
  3821         16  TR-GROUP    PIC X(6).
  3822         16  FILLER      PIC X       VALUE '-'.
  3823         16  TR-ST-NO    PIC X(2).
  3824         16  FILLER      PIC X       VALUE '-'.
  3825         16  TR-AG-NO    PIC X(10).
  3826         16  FILLER      PIC X(23)   VALUE SPACES.
  3827         16  TR5-RP-TYP.
  3828             20  FILLER  PIC X(20)   VALUE
  3829                     '* * * * TRANSACTION '.
  3830             20  FILLER  PIC X(15)   VALUE 'LISTING * * * *'.
  3831     12  TR-HD-6.
  3832         16  FILLER      PIC X       VALUE SPACE.
  3833         16  TR-CE-MO    PIC XX.
  3834         16  FILLER      PIC X       VALUE '-'.
  3835         16  TR-CE-DA    PIC XX.
  3836         16  FILLER      PIC X       VALUE '-'.
  3837         16  TR-CE-YR    PIC XX.
  3838         16  FILLER      PIC X(6)    VALUE '  TO  '.
  3839         16  TR-CX.
  3840             20  TR-CX-MO PIC XX.
  3841             20  HSHR1    PIC X.
  3842             20  TR-CX-DA PIC XX.
  3843             20  HSHR2    PIC X.
  3844             20  TR-CX-YR PIC XX.
  3845     12  TR-HD-7.
  3846         16  FILLER  PIC X      VALUE '0'.
  3847         16  FILLER  PIC X(24)  VALUE SPACES.
  3848         16  FILLER  PIC X(19)  VALUE '*----------------- '.
  3849         16  TR-7-LF PIC X(6).
  3850         16  FILLER  PIC X(9)   VALUE ' COVERAGE'.
  3851         16  FILLER  PIC X(19)  VALUE ' -----------------*'.
  3852         16  FILLER  PIC X(20)  VALUE '  *---------------- '.
  3853         16  TR-7-AH PIC X(6).
  3854         16  FILLER  PIC X(10)  VALUE ' COVERAGE '.
  3855         16  FILLER  PIC X(19)  VALUE ' -----------------*'.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  77
* ECS010MO.cbl
  3856     12  TR-HD-8.
  3857         16  FILLER  PIC X      VALUE SPACE.
  3858         16  FILLER  PIC X(24)  VALUE '   CERT      ISSUE      '.
  3859         16  FILLER  PIC X(24)  VALUE '        PREMIUM    COMMI'.
  3860         16  FILLER  PIC X(24)  VALUE 'SSION   ACTION          '.
  3861         16  FILLER  PIC X(24)  VALUE '                PREMIUM '.
  3862         16  FILLER  PIC X(22)  VALUE '   COMMISSION   ACTION'.
  3863     12  TR-HD-9.
  3864         16  FILLER  PIC X      VALUE SPACE.
  3865         16  FILLER  PIC X(24)  VALUE '  NUMBER      DATE  AGE '.
  3866         16  FILLER  PIC X(24)  VALUE 'TYP TRM  / REFUND    /  '.
  3867         16  FILLER  PIC X(24)  VALUE 'CLAIM    DATE     ACTION'.
  3868         16  FILLER  PIC X(24)  VALUE '  ST    TYP TRM  / REFUN'.
  3869         16  FILLER  PIC X(24)  VALUE 'D    /  CLAIM    DATE   '.
  3870         16  FILLER  PIC X(12)  VALUE '  ACTION  ST'.
  3871     12  TR-TTL-HD.
  3872         16  FILLER      PIC X       VALUE '0'.
  3873         16  TTL-PT-CNT  PIC ZZZZ,ZZZ,ZZZ,ZZ9.
  3874         16  FILLER      PIC XX      VALUE SPACES.
  3875         16  TTL-HD-DS   PIC X(60)   VALUE
  3876             'ECS010 CONTROL TOTALS'.
  3877
  3878 01  TR-DTL.
  3879     12  FILLER                  PIC X           VALUE SPACE.
  3880     12  TR-DTL1.
  3881         16  TRD-CERT            PIC X(11).
  3882         16  TRD-ISDT.
  3883             20  FILLER          PIC X           VALUE SPACE.
  3884             20  TRD-ISMO        PIC XX.
  3885             20  TRD-IS-S1       PIC X           VALUE '/'.
  3886             20  TRD-ISDA        PIC XX.
  3887             20  TRD-IS-S2       PIC X           VALUE '/'.
  3888             20  TRD-ISYR        PIC XX.
  3889             20  FILLER          PIC X           VALUE SPACE.
  3890         16  TRD-AGE             PIC XX.
  3891     12  TR-DTL2.
  3892         16  FILLER              PIC X           VALUE SPACE.
  3893         16  TRD-LFTYP           PIC XXX.
  3894         16  FILLER              PIC X           VALUE SPACE.
  3895         16  TRD-LFTRM           PIC ZZ9.
  3896         16  TRD-LFPRM-RFND      PIC ZZZZ,ZZZ.99  BLANK WHEN ZERO.
  3897         16  TRD-LFCOM-CLM       PIC ZZZZ,ZZZ.99- BLANK WHEN ZERO.
  3898         16  TRD-LFACTDT.
  3899             20  FILLER          PIC X           VALUE SPACE.
  3900             20  TRD-LFACTMO     PIC XX.
  3901             20  TRD-LF-S1       PIC X           VALUE '/'.
  3902             20  TRD-LFACTDA     PIC XX.
  3903             20  TRD-LF-S2       PIC X           VALUE '/'.
  3904             20  TRD-LFACTYR     PIC XX.
  3905             20  FILLER          PIC X           VALUE SPACE.
  3906         16  TRD-LF-ACTION       PIC X(10)       VALUE SPACE.
  3907         16  FILLER              PIC X           VALUE SPACE.
  3908         16  TRD-LF-STATUS       PIC X.
  3909         16  FILLER              PIC X(4)        VALUE SPACE.
  3910         16  TRD-AHTYP           PIC XXX.
  3911         16  FILLER              PIC X           VALUE SPACE.
  3912         16  TRD-AHTRM           PIC ZZ9.
  3913         16  TRD-AHPRM-RFND      PIC ZZZZ,ZZZ.99  BLANK WHEN ZERO.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  78
* ECS010MO.cbl
  3914         16  TRD-AHCOM-CLM       PIC ZZZZ,ZZZ.99- BLANK WHEN ZERO.
  3915         16  TRD-AHACTDT.
  3916             20  FILLER          PIC X           VALUE SPACE.
  3917             20  TRD-AHACTMO     PIC XX.
  3918             20  TRD-AH-S1       PIC X           VALUE '/'.
  3919             20  TRD-AHACTDA     PIC XX.
  3920             20  TRD-AH-S2       PIC X           VALUE '/'.
  3921             20  TRD-AHACTYR     PIC XX.
  3922             20  FILLER          PIC X           VALUE SPACE.
  3923         16  TRD-AH-ACTION       PIC X(10)       VALUE SPACE.
  3924         16  FILLER              PIC X           VALUE SPACE.
  3925         16  TRD-AH-STATUS       PIC X.
  3926     12  TR-DTL3 REDEFINES TR-DTL2.
  3927         16  FILLER              PIC X(20).
  3928         16  TRD-IBNR            PIC ZZZ,ZZZ.99-.
  3929         16  FILLER              PIC X.
  3930         16  TRD-IBNRX           PIC X(4).
  3931         16  FILLER              PIC X(2).
  3932         16  TRD-PAYCUR          PIC ZZZ,ZZZ.99-.
  3933         16  TRD-PAYCUR-SPACE REDEFINES TRD-PAYCUR
  3934                                 PIC X(11).
  3935         16  FILLER              PIC X.
  3936         16  TRD-PAYCURX         PIC X(8).
  3937         16  FILLER              PIC X(2).
  3938         16  TRD-FUTRSV-DATA.
  3939             20  TRD-FUTRSV      PIC ZZZ,ZZZ.99-.
  3940             20  TRD-FUTRSV-SPACE REDEFINES TRD-FUTRSV
  3941                                 PIC X(11).
  3942             20  FILLER          PIC X.
  3943             20  TRD-FUTRSVX     PIC X(6).
  3944         16  TRD-BENEFIT-DATA REDEFINES TRD-FUTRSV-DATA.
  3945             20  TRD-BENEFIT-X   PIC X(10).
  3946             20  TRD-BENEFIT-CODE
  3947                                 PIC X(02).
  3948             20  FILLER          PIC X(06).
  3949         16  FILLER              PIC X(4).
  3950         16  TRD-RSV-DESC        PIC X(6).
  3951         16  TRD-RSV-ACTION      PIC X(21).
  3952
  3953 01  DET-PR-UREC.
  3954     12  FILLER              PIC X(7)     VALUE ' AGE - '.
  3955     12  DET-AGE             PIC 99         BLANK WHEN ZERO.
  3956     12  FILLER              PIC X(11)    VALUE ' JT. AGE - '.
  3957     12  DET-JT-AGE          PIC 99         BLANK WHEN ZERO.
  3958     12  FILLER              PIC X(7)     VALUE ' SEX - '.
  3959     12  DET-SEX             PIC X.
  3960     12  FILLER              PIC X(9)     VALUE '   APR - '.
  3961     12  DET-PR-APR          PIC Z9.999     BLANK WHEN ZERO.
  3962     12  FILLER              PIC X(9)     VALUE '  MEM# - '.
  3963     12  DET-PR-MEM          PIC X(12).
  3964     12  FILLER              PIC X(9)     VALUE '   SS# - '.
  3965     12  DET-PR-SS           PIC X(11).
  3966     12  FILLER              PIC XXX      VALUE SPACES.
  3967     12  DET-1-ACTION        PIC X(20)    VALUE ' MAINTENANCE'.
  3968
  3969 01  DET-PR-UREC-2.
  3970     12  FILLER              PIC X        VALUE SPACE.
  3971     12  DET-LF-DESC         PIC XX.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  79
* ECS010MO.cbl
  3972     12  FILLER              PIC X(10)    VALUE ' TERM CHG '.
  3973     12  DET-O-LF-TERM       PIC 999        BLANK WHEN ZERO.
  3974     12  FILLER              PIC X(4)     VALUE ' TO '.
  3975     12  DET-N-LF-TERM       PIC 999        BLANK WHEN ZERO.
  3976     12  FILLER              PIC X        VALUE SPACE.
  3977     12  DET-AH-DESC         PIC XX.
  3978     12  FILLER              PIC X(10)    VALUE ' TERM CHG '.
  3979     12  DET-O-AH-TERM       PIC 999        BLANK WHEN ZERO.
  3980     12  FILLER              PIC X(4)     VALUE ' TO '.
  3981     12  DET-N-AH-TERM       PIC 999        BLANK WHEN ZERO.
  3982     12  FILLER              PIC X(12)    VALUE ' OLD LIVES -'.
  3983     12  DET-O-LIVES         PIC ZZZZ999    BLANK WHEN ZERO.
  3984     12  FILLER              PIC X(12)    VALUE ' NEW LIVES -'.
  3985     12  DET-N-LIVES         PIC ZZZZ999    BLANK WHEN ZERO.
  3986     12  FILLER              PIC X(5)     VALUE SPACES.
  3987     12  DET-2-ACTION        PIC X(20)    VALUE ' MAINTENANCE'.
  3988
  3989 01  DET-PR-UREC-3.
  3990     12  FILLER              PIC X(7)     VALUE ' I/G - '.
  3991     12  DET-IND-GRP         PIC X.
  3992     12  FILLER              PIC X(13)    VALUE '  PMT FREQ - '.
  3993     12  DET-PMT-FREQ        PIC 99         BLANK WHEN ZERO.
  3994     12  FILLER              PIC X(14)    VALUE '  POL FORM# - '.
  3995     12  DET-POL-FORM        PIC X(12).
  3996     12  FILLER              PIC X(14)    VALUE '  LOAN OFF# - '.
  3997     12  DET-LOAN-OFFICER    PIC XXX.
  3998     12  FILLER              PIC X(14)    VALUE '  USER CODE - '.
  3999     12  DET-USER-CODE       PIC X.
  4000     12  FILLER              PIC X(8)     VALUE SPACES.
  4001     12  DET-3-ACTION        PIC X(20)    VALUE ' MAINTENANCE'.
  4002
  4003 01  DET-PR-UREC-4.
  4004     12  FILLER              PIC X(18) VALUE ' CLM DEDUCT AMT - '.
  4005     12  DET-CLM-DEDUCT      PIC 99999.99   BLANK WHEN ZERO.
  4006     12  FILLER              PIC X(18) VALUE ' CAN DEDUCT AMT - '.
  4007     12  DET-CAN-DEDUCT      PIC 99999.99   BLANK WHEN ZERO.
  4008     12  FILLER              PIC X(37)    VALUE SPACES.
  4009     12  DET-3-ACTION        PIC X(20)    VALUE ' MAINTENANCE'.
  4010
  4011 01  DET-PR-UREC-5.
  4012     12  FILLER              PIC X(13) VALUE ' LF BEN CD - '.
  4013     12  DET-LF-BEN-CD       PIC XX.
  4014     12  FILLER              PIC X(11) VALUE ' LF PREM - '.
  4015     12  DET-LF-PREM         PIC ZZZZZZZ.99   BLANK WHEN ZERO.
  4016     12  FILLER              PIC X(11) VALUE ' LF BENE - '.
  4017     12  DET-LF-BEN          PIC ZZZZZZZZZ.99   BLANK WHEN ZERO.
  4018     12  FILLER              PIC X(30)    VALUE SPACES.
  4019     12  DET-3-ACTION        PIC X(20)    VALUE ' MAINTENANCE'.
  4020
  4021 01  DET-PR-UREC-6.
  4022     12  FILLER              PIC X(13) VALUE ' AH BEN CD - '.
  4023     12  DET-AH-BEN-CD       PIC XX.
  4024     12  FILLER              PIC X(11) VALUE ' AH PREM - '.
  4025     12  DET-AH-PREM         PIC ZZZZZZZ.99   BLANK WHEN ZERO.
  4026     12  FILLER              PIC X(11) VALUE ' AH BENE - '.
  4027     12  DET-AH-BEN          PIC ZZZZZZZZZ.99   BLANK WHEN ZERO.
  4028     12  FILLER              PIC X(30)    VALUE SPACES.
  4029     12  DET-3-ACTION        PIC X(20)    VALUE ' MAINTENANCE'.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  80
* ECS010MO.cbl
  4030
  4031 01  WS-CHANGE-REC-SW        PIC X  VALUE 'N'.
  4032     88  WS-CHANGE-REC              VALUE 'Y'.
  4033
  4034 01  TOTAL-PAGE-HD1.
  4035     12  FILLER              PIC X               VALUE SPACE.
  4036     12  TPH1-TYPE           PIC X(8).
  4037     12  TPH1-DESC.
  4038         16  TPH1-ST-CODE    PIC XX.
  4039         16  FILLER          PIC XXX.
  4040         16  TPH1-ST-DESC    PIC X(20).
  4041
  4042 01  TOTAL-PAGE-HD2.
  4043     12  FILLER              PIC X           VALUE SPACE.
  4044     12  TPH2-DESC           PIC X(20)       VALUE SPACES.
  4045     12  FILLER              PIC X(7)        VALUE 'WRITTEN'.
  4046     12  FILLER              PIC X(9)        VALUE SPACES.
  4047     12  FILLER              PIC X(9)        VALUE 'CANCELLED'.
  4048     12  FILLER              PIC X(11)       VALUE SPACES.
  4049     12  FILLER              PIC X(3)        VALUE 'NET'.
  4050     12  FILLER              PIC X(11)       VALUE SPACES.
  4051     12  FILLER              PIC X(7)        VALUE 'ACCOUNT'.
  4052     12  FILLER              PIC X(10)       VALUE SPACES.
  4053     12  FILLER              PIC X(10)       VALUE 'NET PREM -'.
  4054
  4055 01  TOTAL-PAGE-HD3.
  4056     12  FILLER              PIC X           VALUE SPACE.
  4057     12  TPH3-DESC           PIC X(20)       VALUE SPACES.
  4058     12  FILLER              PIC X(7)        VALUE 'PREMIUM'.
  4059     12  FILLER              PIC X(10)       VALUE SPACES.
  4060     12  FILLER              PIC X(7)        VALUE 'PREMIUM'.
  4061     12  FILLER              PIC X(10)       VALUE SPACES.
  4062     12  FILLER              PIC X(7)        VALUE 'PREMIUM'.
  4063     12  FILLER              PIC X(7)        VALUE SPACES.
  4064     12  FILLER              PIC X(10)       VALUE 'COMMISSION'.
  4065     12  FILLER              PIC X(08)       VALUE SPACES.
  4066     12  FILLER              PIC X(09)       VALUE 'ACCT COMP'.
  4067     12  FILLER              PIC X(11)       VALUE SPACES.
  4068     12  FILLER              PIC X(6)        VALUE 'CLAIMS'.
  4069
  4070 01  TOTAL-PAGE-DETAIL.
  4071     12  FILLER              PIC X(5).
  4072     12  TPD-DESC            PIC X(6).
  4073     12  FILLER              PIC X(3).
  4074     12  TPD-ISS-PRM         PIC ZZZ,ZZZ,ZZZ.99-.
  4075     12  FILLER              PIC X(2).
  4076     12  TPD-CNC-PRM         PIC ZZZ,ZZZ,ZZZ.99-.
  4077     12  FILLER              PIC X(2).
  4078     12  TPD-NET-PRM         PIC ZZZ,ZZZ,ZZZ.99-.
  4079     12  FILLER              PIC X(2).
  4080     12  TPD-ACCT-COM        PIC ZZZ,ZZZ,ZZZ.99-.
  4081     12  FILLER              PIC X(2).
  4082     12  TPD-PREM-COMP       PIC ZZZ,ZZZ,ZZZ.99-.
  4083     12  FILLER              PIC X(2).
  4084     12  TPD-CLAIMS          PIC ZZZ,ZZZ,ZZZ.99-.
  4085     12  FILLER              PIC X(4).
  4086     12  TPD-LO-CERT         PIC X(6).
  4087     12  FILLER              PIC X(2).
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  81
* ECS010MO.cbl
  4088     12  TPD-HI-CERT         PIC X(6).
  4089*    12  FILLER              PIC X.
  4090*    12  TPD-LO-CERT         PIC X(8).
  4091*    12  FILLER              PIC X.
  4092*    12  TPD-HI-CERT         PIC X(8).
  4093
  4094 01  DUPE-CERT-TABLE.
  4095     12  DUPE-ENTRIES  OCCURS 1000 TIMES.
  4096         16  DUPE-ENTRY      PIC X(36).
  4097         16  DUPE-STATUS     PIC X(01).
  4098         16  DUPE-LF-PRM     PIC S9(7)V99    COMP-3.
  4099         16  DUPE-AH-PRM     PIC S9(7)V99    COMP-3.
  4100
  4101 01  MISMATCH-HEADING-1.
  4102     12  FILLER              PIC X           VALUE '1'.
  4103     12  FILLER              PIC X(45)       VALUE SPACES.
  4104     12  FILLER              PIC X(42)       VALUE
  4105             'MISMATCHED TRANS AND DUPLICATE CERT REPORT'.
  4106     12  FILLER              PIC X(35)       VALUE SPACES.
  4107     12  FILLER              PIC X(10)       VALUE 'ECS010    '.
  4108
  4109 01  MISMATCH-HEADING-2.
  4110     12  FILLER              PIC X           VALUE '0'.
  4111     12  FILLER              PIC X(44)       VALUE
  4112             ' C  GRP ST  ACCT    EFF DTE  CERT      REC T'.
  4113     12  FILLER              PIC X(44)       VALUE
  4114             'YPE      CERT IN CONTROL                    '.
  4115     12  FILLER              PIC X(44)       VALUE
  4116             '        CERT OUT CONTROL           STATUS   '.
  4117
  4118 01  MISMATCH-DETAIL.
  4119     12  FILLER              PIC X           VALUE '0'.
  4120     12  FILLER              PIC X           VALUE SPACES.
  4121     12  DTL-MATCH-CONTROL   PIC X(36).
  4122     12  FILLER              PIC X(3)        VALUE SPACES.
  4123     12  DTL-REC-TYPE        PIC X.
  4124     12  FILLER              PIC X(2)        VALUE SPACES.
  4125     12  DTL-REC-TYPE-DESC   PIC X(3).
  4126     12  FILLER              PIC X(3)        VALUE SPACES.
  4127     12  DTL-CERT-IN-CONTROL
  4128                             PIC X(36).
  4129     12  FILLER              PIC X           VALUE SPACES.
  4130     12  DTL-CERT-OUT-CONTROL
  4131                             PIC X(36).
  4132     12  FILLER              PIC X           VALUE SPACES.
  4133     12  DTL-STATUS          PIC X(7)        VALUE 'DROPPED'.
  4134     12  FILLER              PIC X(2)        VALUE SPACES.
  4135
  4136 01  MISMATCH-DETAIL-2.
  4137     12  FILLER              PIC X           VALUE ' '.
  4138     12  FILLER              PIC X           VALUE SPACES.
  4139     12  MD2-LF-PREM-DESC    PIC X(16)       VALUE
  4140             ' LIFE PREMIUM = '.
  4141     12  MD2-LF-PREM         PIC Z,ZZZ,ZZZ.99-.
  4142     12  FILLER              PIC X           VALUE SPACES.
  4143     12  MD2-LF-ALT-PREM-DESC PIC X(16)       VALUE
  4144             'LIFE ALT PREM = '.
  4145     12  MD2-LF-ALT-PREM     PIC Z,ZZZ,ZZZ.99-.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  82
* ECS010MO.cbl
  4146     12  FILLER              PIC XX          VALUE SPACES.
  4147     12  MD2-AH-PREM-DESC    PIC X(18)       VALUE
  4148             'A/H PREMIUM = '.
  4149     12  MD2-AH-PREM         PIC Z,ZZZ,ZZZ.99-.
  4150     12  FILLER              PIC X(39)       VALUE SPACES.
  4151
  4152 01  MISMATCH-DETAIL-3.
  4153     12  FILLER              PIC X           VALUE ' '.
  4154     12  FILLER              PIC X           VALUE SPACES.
  4155     12  FILLER              PIC X(16)       VALUE
  4156             ' LIFE  REFUND = '.
  4157     12  MD3-LF-REFUND       PIC Z,ZZZ,ZZZ.99-.
  4158     12  FILLER              PIC X           VALUE SPACES.
  4159     12  FILLER              PIC X(16)       VALUE
  4160             'A & H  REFUND = '.
  4161     12  MD3-AH-REFUND       PIC Z,ZZZ,ZZZ.99-.
  4162     12  FILLER              PIC X(72)       VALUE SPACES.
  4163
  4164 01  MISMATCH-DETAIL-4.
  4165     12  FILLER              PIC X           VALUE ' '.
  4166     12  FILLER              PIC X           VALUE SPACES.
  4167     12  FILLER              PIC X(16)       VALUE
  4168             ' LIFE  CLAIM  = '.
  4169     12  MD4-LF-CLAIM        PIC Z,ZZZ,ZZZ.99-.
  4170     12  FILLER              PIC X           VALUE SPACES.
  4171     12  FILLER              PIC X(16)       VALUE
  4172             'A & H  CLAIM  = '.
  4173     12  MD4-AH-CLAIM        PIC Z,ZZZ,ZZZ.99-.
  4174     12  FILLER              PIC X(72)       VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  83
* ECS010MO.cbl
  4176*
  4177*
  4178* LEAVE THE ABOVE 2 LINES IN TO PREVENT LOSING THE LINE ABOVE
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  84
* ECS010MO.cbl
  4180 01  PB-STARTS-HERE              PIC X(48)
  4181       VALUE '*****  PENDING BUSINESS RECORD STARTS HERE  ****'.
  4182
* 4183                             COPY ERCPNDB.
  4184******************************************************************
  4185*                                                                *
  4186*                                                                *
  4187*                            ERCPNDB.                            *
  4188*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4189*                            VMOD=2.025                          *
  4190*                                                                *
  4191*   FILE DESCRIPTION = PENDING NEW BUSINESS (ISSUES AND CANCELS) *
  4192*                                                                *
  4193******************************************************************
  4194*   NOTE: IF THIS FORMAT IS CHANGED, THE SORT RECORD IN THE      *
  4195*         EL861 A/R SYSTEM MAY NEED TO BE CHANGED.               *
  4196******************************************************************
  4197*                                                                *
  4198*                                                                *
  4199*   FILE TYPE = VSAM,KSDS                                        *
  4200*   RECORD SIZE = 585  RECFORM = FIXED                           *
  4201*                                                                *
  4202*   BASE CLUSTER = ERPNDB                         RKP=2,LEN=11   *
  4203*       ALTERNATE PATH1 = ERPNDB2  (BY CAR GRP STATE ACCOUNT     *
  4204*                                  EFF-DT CERT CHG-SEQ REC-TYPE) *
  4205*                                                 RKP=13,LEN=36  *
  4206*       ALTERNATE PATH2 = ERPNDB3  (BY CO, ORIGINAL BATCH, SEQ.  *
  4207*                                      AND CHG-SEQ.)             *
  4208*                                                RKP=49,LEN=11   *
  4209*       ALTERNATE PATH3 = ERPNDB4  (BY CO, CSR-ID, BATCH, SEQ.   *
  4210*                                      AND CHG-SEQ.)             *
  4211*                                                RKP=60,LEN=15   *
  4212*                                                                *
  4213*   LOG = NO                                                     *
  4214*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4215******************************************************************
  4216******************************************************************
  4217*                   C H A N G E   L O G
  4218*
  4219* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4220*-----------------------------------------------------------------
  4221*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4222* EFFECTIVE    NUMBER
  4223*-----------------------------------------------------------------
  4224* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  4225* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  4226* 011904                   PEMA  ADD TOTAL FEE PROCESSING
  4227* 040504    2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  4228* 020305    2005020000000  PEMA  ADD CLP STATE TO PNDB RECORD
  4229* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  4230* 032306                   PEMA  ADD BOW LOAN NUMBER
  4231* 081606    2006080800002  PEMA  ADD VIN, ISSUES ONLY
  4232* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
  4233* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  4234* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  4235* 032109    2009021700002  PEMA  ADD CRED BENE TO PNDB REC
  4236* 072209  CR2008101500003  AJRA  ADD BORROWER FIRST NAME TO ENDORSEMENT
  4237* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  85
* ECS010MO.cbl (/apps/prod/cid1p/copy/ERCPNDB)
  4238* 071211  CR2010012700001  PEMA  ADD SPP DEALER DIRECT
  4239* 073114  CR2014012300001  PEMA  ADD CU CARRIER 7 PROCESSING
  4240******************************************************************
  4241
  4242 01  PENDING-BUSINESS.
  4243     12  PB-RECORD-ID                     PIC XX.
  4244         88  VALID-PB-ID                        VALUE 'PB'.
  4245
  4246     12  PB-CONTROL-PRIMARY.
  4247         16  PB-COMPANY-CD                PIC X.
  4248         16  PB-ENTRY-BATCH               PIC X(6).
  4249         16  PB-BATCH-SEQ-NO              PIC S9(4)     COMP.
  4250         16  PB-BATCH-CHG-SEQ-NO          PIC S9(4)     COMP.
  4251
  4252     12  PB-CONTROL-BY-ACCOUNT.
  4253         16  PB-COMPANY-CD-A1             PIC X.
  4254         16  PB-CARRIER                   PIC X.
  4255         16  PB-GROUPING.
  4256             20  PB-GROUPING-PREFIX       PIC XXX.
  4257             20  PB-GROUPING-PRIME        PIC XXX.
  4258         16  PB-STATE                     PIC XX.
  4259         16  PB-ACCOUNT.
  4260             20  PB-ACCOUNT-PREFIX        PIC X(4).
  4261             20  PB-ACCOUNT-PRIME         PIC X(6).
  4262         16  PB-CERT-EFF-DT               PIC XX.
  4263         16  PB-CERT-NO.
  4264             20  PB-CERT-PRIME            PIC X(10).
  4265             20  PB-CERT-SFX              PIC X.
  4266         16  PB-ALT-CHG-SEQ-NO            PIC S9(4)     COMP.
  4267
  4268         16  PB-RECORD-TYPE               PIC X.
  4269             88  PB-MAILING-DATA                VALUE '0'.
  4270             88  PB-ISSUE                       VALUE '1'.
  4271             88  PB-CANCELLATION                VALUE '2'.
  4272             88  PB-BATCH-TRAILER               VALUE '9'.
  4273
  4274     12  PB-CONTROL-BY-ORIG-BATCH.
  4275         16  PB-ORIGINAL-COMPANY-CD       PIC X.
  4276         16  PB-ORIGINAL-ENTRY-BATCH      PIC X(6).
  4277         16  PB-ORIGINAL-SEQ-NO           PIC S9(4)     COMP.
  4278         16  PB-ORIGINAL-CHG-SEQ-NO       PIC S9(4)     COMP.
  4279
  4280     12  PB-CONTROL-BY-CSR.
  4281         16  PB-CSR-COMPANY-CD            PIC X.
  4282         16  PB-CSR-ID                    PIC X(4).
  4283         16  PB-CSR-ENTRY-BATCH           PIC X(6).
  4284         16  PB-CSR-BATCH-SEQ-NO          PIC S9(4)     COMP.
  4285         16  PB-CSR-BATCH-CHG-SEQ-NO      PIC S9(4)     COMP.
  4286******************************************************************
  4287*    MAILING DATA IS PROCESSED IN ONLY PRGS. EL512 & EL513       *
  4288******************************************************************
  4289
  4290     12  PB-LAST-MAINT-DT                 PIC XX.
  4291     12  PB-LAST-MAINT-BY                 PIC X(4).
  4292     12  PB-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.
  4293
  4294     12  PB-RECORD-BODY                   PIC X(375).
  4295
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  86
* ECS010MO.cbl (/apps/prod/cid1p/copy/ERCPNDB)
  4296     12  PB-ISSUE-RECORD   REDEFINES PB-RECORD-BODY.
  4297         16  PB-CERT-ORIGIN               PIC X.
  4298             88  CLASIC-CREATED-CERT         VALUE '1'.
  4299         16  PB-I-NAME.
  4300             20  PB-I-INSURED-LAST-NAME   PIC X(15).
  4301             20  PB-I-INSURED-FIRST-NAME.
  4302                 24  PB-I-INSURED-1ST-INIT PIC X.
  4303                 24  FILLER                PIC X(9).
  4304             20  PB-I-INSURED-MIDDLE-INIT PIC X.
  4305         16  PB-I-AGE                     PIC S99   COMP-3.
  4306         16  PB-I-JOINT-AGE               PIC S99   COMP-3.
  4307         16  PB-I-BIRTHDAY                PIC XX.
  4308         16  PB-I-INSURED-SEX             PIC X.
  4309             88  PB-SEX-MALE     VALUE 'M'.
  4310             88  PB-SEX-FEMALE   VALUE 'F'.
  4311
  4312         16  PB-I-LF-TERM                 PIC S999   COMP-3.
  4313         16  PB-I-AH-TERM                 PIC S999   COMP-3.
  4314         16  PB-I-LOAN-TERM               PIC S999   COMP-3.
  4315         16  PB-I-PAY-FREQUENCY           PIC S99    COMP-3.
  4316         16  PB-I-SKIP-CODE               PIC X.
  4317             88  PB-NO-MONTHS-SKIPPED      VALUE ' ' '0'.
  4318             88  PB-SKIP-JULY              VALUE '1'.
  4319             88  PB-SKIP-AUGUST            VALUE '2'.
  4320             88  PB-SKIP-SEPTEMBER         VALUE '3'.
  4321             88  PB-SKIP-JULY-AUG          VALUE '4'.
  4322             88  PB-SKIP-AUG-SEPT          VALUE '5'.
  4323             88  PB-SKIP-JULY-AUG-SEPT     VALUE '6'.
  4324             88  PB-SKIP-JUNE-JULY-AUG     VALUE '7'.
  4325             88  PB-SKIP-JUNE              VALUE '8'.
  4326             88  PB-SKIP-JUNE-JULY         VALUE '9'.
  4327             88  PB-SKIP-AUG-SEPT-OCT      VALUE 'A'.
  4328             88  PB-SKIP-BI-WKLY-3RD-PMT   VALUE 'X'.
  4329         16  PB-I-TERM-TYPE               PIC X.
  4330             88  PB-PAID-MONTHLY           VALUE ' ' 'M'.
  4331             88  PB-PAID-WEEKLY            VALUE 'W'.
  4332             88  PB-PAID-SEMI-MONTHLY      VALUE 'S'.
  4333             88  PB-PAID-BI-WEEKLY         VALUE 'B'.
  4334             88  PB-PAID-13-YEARLY         VALUE 'T'.
  4335         16  PB-I-NO-OF-PAYMENTS          PIC S999   COMP-3.
  4336         16  PB-I-POLICY-FORM-NO          PIC X(12).
  4337         16  PB-I-DATA-ENTRY-SW           PIC X.
  4338             88  PB-EFF-DT-PROCESSING      VALUE '1' ' '.
  4339             88  PB-EXT-DAYS-PROCESSING    VALUE '2'.
  4340             88  PB-EXPIRE-DT-PROCESSING   VALUE '3'.
  4341             88  PB-1ST-PMT-DT-PROCESSING  VALUE '4'.
  4342         16  PB-I-PAYMENT-AMOUNT          PIC S9(7)V99  COMP-3.
  4343         16  PB-I-DCC-OVER-CHG-AMT        PIC S9(5)V99  COMP-3.
  4344*        16  PB-I-MICROFILM-NO            PIC S9(9)      COMP-3.
  4345         16  PB-I-AH-CLP                  PIC S9(5)V99 COMP-3.
  4346         16  FILLER                       PIC X.
  4347
  4348         16  PB-I-LIFE-BENEFIT-CD         PIC XX.
  4349             88  PB-VALID-LIFE               VALUE '01' THRU '89'.
  4350             88  PB-INVALID-LIFE             VALUE '  ' '00'
  4351                                                   '90' THRU '99'.
  4352         16  PB-I-LF-BENEFIT-CD   REDEFINES PB-I-LIFE-BENEFIT-CD
  4353                                          PIC XX.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  87
* ECS010MO.cbl (/apps/prod/cid1p/copy/ERCPNDB)
  4354         16  PB-I-LF-BENEFIT-AMT          PIC S9(9)V99   COMP-3.
  4355         16  PB-I-AMOUNT-FINANCED REDEFINES
  4356                  PB-I-LF-BENEFIT-AMT     PIC S9(9)V99   COMP-3.
  4357         16  PB-I-LF-ALT-BENEFIT-AMT      PIC S9(9)V99   COMP-3.
  4358         16  PB-I-UNPAID-CASH-PRICE REDEFINES
  4359                  PB-I-LF-ALT-BENEFIT-AMT PIC S9(9)V99   COMP-3.
  4360         16  PB-I-LF-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  4361         16  PB-I-LF-ALT-PREMIUM-AMT      PIC S9(7)V99   COMP-3.
  4362         16  PB-I-CLP-AMOUNT REDEFINES
  4363                  PB-I-LF-ALT-PREMIUM-AMT PIC S9(7)V99   COMP-3.
  4364         16  PB-I-LF-CALC-FLAG            PIC X.
  4365             88 PB-COMP-LF-PREM               VALUE '?'.
  4366         16  PB-I-LF-PREM-CALC            PIC S9(7)V99   COMP-3.
  4367         16  PB-I-LF-ALT-PREM-CALC        PIC S9(7)V99   COMP-3.
  4368         16  PB-I-LF-RATE                 PIC S99V9(5)   COMP-3.
  4369         16  PB-I-LF-ALT-RATE             PIC S99V9(5)   COMP-3.
  4370         16  PB-I-LF-POLICY-FEE           PIC S9(3)V99   COMP-3.
  4371         16  PB-I-LF-REI-RATE             PIC S99V9(5)   COMP-3.
  4372         16  PB-I-LF-ALT-REI-RATE         PIC S99V9(5)   COMP-3.
  4373         16  PB-I-LF-ABBR                 PIC XXX.
  4374         16  PB-I-LF-INPUT-CD             PIC XX.
  4375
  4376         16  PB-I-AH-BENEFIT-CD           PIC XX.
  4377             88  PB-VALID-AH                 VALUE '01' THRU '89'.
  4378             88  PB-INVALID-AH               VALUE '  ' '00'
  4379                                                   '90' THRU '99'.
  4380         16  PB-I-AH-BENEFIT-AMT          PIC S9(7)V99   COMP-3.
  4381         16  PB-I-AH-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  4382         16  PB-I-AH-CALC-FLAG            PIC X.
  4383             88 PB-COMP-AH-PREM                  VALUE '?'.
  4384         16  PB-I-AH-PREM-CALC            PIC S9(7)V99   COMP-3.
  4385         16  PB-I-AH-RATE                 PIC S99V9(5)   COMP-3.
  4386         16  PB-I-AH-POLICY-FEE           PIC S9(3)V99   COMP-3.
  4387         16  PB-I-AH-REI-RATE             PIC S99V9(5)   COMP-3.
  4388         16  PB-I-AH-RATE-TRM             PIC S999       COMP-3.
  4389         16  PB-I-AH-ABBR                 PIC XXX.
  4390         16  PB-I-AH-INPUT-CD             PIC XXX.
  4391
  4392         16  PB-I-SPECIAL-REIN-CODE       PIC X.
  4393         16  PB-I-REIN-TABLE              PIC XXX.
  4394         16  PB-I-BUSINESS-TYPE           PIC 99.
  4395         16  PB-I-INDV-GRP-CD             PIC X.
  4396         16  PB-I-MORT-CODE.
  4397             20  PB-I-TABLE               PIC X.
  4398             20  PB-I-INTEREST            PIC XX.
  4399             20  PB-I-MORT-TYP            PIC X.
  4400         16  PB-I-LF-CRIT-PER             PIC S9(3)      COMP-3.
  4401         16  PB-I-AH-CRIT-PER             PIC S9(3)      COMP-3.
  4402         16  PB-I-LF-CLP                  PIC S9(5)V99   COMP-3.
  4403         16  PB-I-INDV-GRP-OVRD           PIC X.
  4404         16  PB-I-RATE-CLASS-OVRD         PIC XX.
  4405         16  PB-I-SIG-SW                  PIC X.
  4406             88  PB-POLICY-SIGNED             VALUE 'Y'.
  4407         16  PB-I-RATE-CLASS              PIC XX.
  4408         16  PB-I-RATE-DEVIATION-LF       PIC XXX.
  4409         16  PB-I-RATE-DEVIATION-AH       PIC XXX.
  4410         16  PB-I-RATE-DEV-PCT-LF         PIC S9V9(6)    COMP-3.
  4411         16  PB-I-RATE-DEV-PCT-AH         PIC S9V9(6)    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  88
* ECS010MO.cbl (/apps/prod/cid1p/copy/ERCPNDB)
  4412         16  PB-I-LIFE-COMMISSION         PIC SV9(5)     COMP-3.
  4413         16  PB-I-JOINT-COMMISSION        PIC SV9(5)     COMP-3.
  4414         16  PB-I-AH-COMMISSION           PIC SV9(5)     COMP-3.
  4415         16  PB-I-BENEFIT-TYPE            PIC XXX.
  4416         16  PB-I-OB-FLAG                 PIC X.
  4417             88  PB-I-OB                      VALUE 'B'.
  4418             88  PB-I-SUMMARY                 VALUE 'Z'.
  4419         16  PB-I-ENTRY-STATUS            PIC X.
  4420             88  PB-I-POLICY-IS-ACTIVE        VALUE '1' '3' '4'
  4421                                              'M' '5' '9' '2'.
  4422             88  PB-I-NORMAL-ENTRY            VALUE '1'.
  4423             88  PB-I-POLICY-PENDING          VALUE '2'.
  4424             88  PB-I-CONVERSION-ENTRY        VALUE '4'.
  4425             88  PB-I-POLICY-IS-REISSUE       VALUE '5'.
  4426             88  PB-I-POLICY-IS-CASH          VALUE 'C'.
  4427             88  PB-I-POLICY-IS-MONTHLY       VALUE 'M'.
  4428             88  PB-I-REIN-ONLY               VALUE '9'.
  4429             88  PB-I-POLICY-IS-DECLINED      VALUE 'D'.
  4430             88  PB-I-POLICY-IS-VOIDED        VALUE 'V'.
  4431             88  PB-I-PREM-ACCTNG-ONLY        VALUE 'P'.
  4432             88  PB-I-UNDERWRITE-POLICY       VALUE 'U'.
  4433         16  PB-I-INT-CODE                PIC X.
  4434             88  PB-ADD-ON-INTEREST           VALUE 'A'.
  4435             88  PB-SIMPLE-INTEREST           VALUE 'S'.
  4436         16  PB-I-LOAN-APR                PIC 9(3)V9(4)   COMP-3.
  4437         16  PB-I-SOC-SEC-NO              PIC X(11).
  4438         16  PB-I-MEMBER-NO               PIC X(12).
  4439         16  PB-I-CURR-SEQ                PIC S9(4)       COMP.
  4440*        16  PB-I-LOAN-OFFICER            PIC XXX.
  4441         16  PB-I-OLD-LOF                 PIC XXX.
  4442         16  PB-I-LF-EXPIRE-DT            PIC XX.
  4443         16  PB-I-AH-EXPIRE-DT            PIC XX.
  4444         16  PB-I-EXTENTION-DAYS          PIC S999        COMP-3.
  4445         16  PB-I-TERM-IN-DAYS            PIC S9(5)       COMP-3.
  4446         16  PB-I-LIFE-INDICATOR          PIC X.
  4447             88  PB-I-JOINT-COVERAGE         VALUE 'J'.
  4448         16  PB-I-LIVES                   PIC S9(7)       COMP-3.
  4449         16  PB-I-DDF-IU-RATE-UP REDEFINES PB-I-LIVES
  4450                                          PIC S9(5)V99    COMP-3.
  4451         16  PB-I-MAIL-ADDRS-SW           PIC X.
  4452             88 PB-I-MAIL-ADDRS-NOT-PRESENT  VALUE ' '.
  4453             88 PB-I-MAIL-ADDRS-PRESENT      VALUE '1'.
  4454         16  PB-I-1ST-PMT-DT              PIC XX.
  4455         16  PB-I-JOINT-INSURED.
  4456             20 PB-I-JOINT-LAST-NAME      PIC X(15).
  4457             20 PB-I-JOINT-FIRST-NAME.
  4458                24  PB-I-JOINT-FIRST-INIT PIC X.
  4459                24  FILLER                PIC X(9).
  4460             20 PB-I-JOINT-MIDDLE-INIT    PIC X.
  4461*        16  PB-I-BENEFICIARY-NAME        PIC X(25).
  4462         16  PB-I-BENEFICIARY-NAME.
  4463             20  PB-I-BANK-NUMBER         PIC X(10).
  4464             20  FILLER                   PIC X(15).
  4465         16  PB-I-LAST-ADD-ON-DT          PIC XX.
  4466         16  PB-I-REFERENCE               PIC X(12).
  4467         16  FILLER REDEFINES PB-I-REFERENCE.
  4468             20  PB-I-TOT-FEES            PIC S9(7)V99 COMP-3.
  4469             20  PB-I-TOT-FEES-CALC       PIC S9(7)V99 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  89
* ECS010MO.cbl (/apps/prod/cid1p/copy/ERCPNDB)
  4470             20  PB-I-CLP-STATE           PIC XX.
  4471         16  PB-I-UNDERWRITING-STATUS     PIC X.
  4472             88  PB-I-POLICY-ACCEPTED         VALUE 'A' 'N'.
  4473             88  PB-I-POLICY-DECLINED         VALUE 'D'.
  4474             88  PB-I-NEEDS-UNDERWRITING      VALUE 'U'.
  4475         16  PB-I-STATE-TAX               PIC S9(7)V99 COMP-3.
  4476         16  PB-I-MUNI-TAX                PIC S9(7)V99 COMP-3.
  4477         16  PB-I-RESIDENT-STATE          PIC XX.
  4478         16  PB-I-RATE-CODE               PIC X(4).
  4479         16  PB-I-NUM-BILLED              PIC S9(7)    COMP-3.
  4480         16  PB-I-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  4481         16  PB-I-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  4482         16  PB-I-BANK-FEE                PIC S999V99  COMP-3.
  4483         16  PB-I-BANK-NOCHRGB            PIC 99.
  4484         16  PB-I-ADDL-CLP                PIC S9(5)V99 COMP-3.
  4485         16  PB-I-JOINT-BIRTHDAY          PIC XX.
  4486
  4487     12  PB-CANCEL-RECORD   REDEFINES PB-RECORD-BODY.
  4488         16  PB-C-LF-CANCEL-VOID-SW       PIC X.
  4489             88  PB-C-LF-CANCEL-VOIDED        VALUE '1'.
  4490         16  PB-C-CANCEL-ORIGIN           PIC X.
  4491             88  PB-C-CLAIM-CREATED-CANCEL   VALUE '1'.
  4492         16  PB-C-LF-CANCEL-DT            PIC XX.
  4493         16  PB-C-LF-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  4494         16  PB-C-LF-CALC-REQ             PIC X.
  4495             88 PB-COMP-LF-CANCEL            VALUE '?'.
  4496         16  PB-C-LF-REF-CALC             PIC S9(7)V99    COMP-3.
  4497         16  PB-C-LF-REM-TERM             PIC S9(3)       COMP-3.
  4498         16  PB-C-AH-CANCEL-VOID-SW       PIC X.
  4499             88  PB-C-AH-CANCEL-VOIDED        VALUE '1'.
  4500         16  PB-C-AH-CANCEL-DT            PIC XX.
  4501         16  PB-C-AH-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  4502         16  PB-C-AH-CALC-REQ             PIC X.
  4503             88 PB-COMP-AH-CANCEL            VALUE '?'.
  4504         16  PB-C-AH-REF-CALC             PIC S9(7)V99    COMP-3.
  4505         16  PB-C-AH-REM-TERM             PIC S9(3)       COMP-3.
  4506         16  PB-C-LAST-NAME               PIC X(15).
  4507         16  PB-C-REFUND-SW               PIC X.
  4508             88  PB-C-REFUND-CREATED          VALUE 'Y'.
  4509             88  PB-C-REFUND-REQUESTED        VALUE 'R'.
  4510         16  PB-C-LIVES                   PIC S9(3)       COMP-3.
  4511         16  PB-C-PAYEE-CODE              PIC X(6).
  4512         16  PB-C-LF-REFUND-OVERRIDE      PIC X.
  4513         16  PB-C-AH-REFUND-OVERRIDE      PIC X.
  4514         16  PB-C-LF-COMM-CHARGEBACK      PIC X.
  4515         16  PB-C-AH-COMM-CHARGEBACK      PIC X.
  4516         16  PB-C-REFERENCE               PIC X(12).
  4517         16  PB-C-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  4518         16  PB-C-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  4519         16  PB-C-POST-CARD-IND           PIC X.
  4520         16  PB-C-CANCEL-REASON           PIC X.
  4521         16  PB-C-REF-INTERFACE-SW        PIC X.
  4522         16  PB-C-LF-RFND-CLP             PIC S9(5)V99 COMP-3.
  4523         16  PB-C-AH-RFND-CLP             PIC S9(5)V99 COMP-3.
  4524         16  FILLER                       PIC X(01).
  4525*        16  FILLER                       PIC X(18).
  4526         16  PB-C-POLICY-FORM-NO          PIC X(12).
  4527*        16  PB-C-MICROFILM-NO            PIC S9(9)      COMP-3.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  90
* ECS010MO.cbl (/apps/prod/cid1p/copy/ERCPNDB)
  4528         16  PB-C-NH-INT-ON-REFS          PIC S9(7)V99   COMP-3.
  4529         16  PB-CANCELED-CERT-DATA.
  4530             20  PB-CI-INSURED-NAME.
  4531                 24  PB-CI-LAST-NAME      PIC X(15).
  4532                 24  PB-CI-INITIALS       PIC XX.
  4533             20  PB-CI-INSURED-AGE        PIC S99         COMP-3.
  4534             20  PB-CI-INSURED-SEX        PIC X.
  4535             20  PB-CI-LF-TERM            PIC S999        COMP-3.
  4536             20  PB-CI-LF-BENEFIT-CD      PIC XX.
  4537             20  PB-CI-LF-BENEFIT-AMT     PIC S9(9)V99    COMP-3.
  4538             20  PB-CI-LF-ALT-BENEFIT-AMT PIC S9(9)V99    COMP-3.
  4539             20  PB-CI-LF-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  4540             20  PB-CI-LF-ALT-PREMIUM-AMT PIC S9(7)V99    COMP-3.
  4541             20  PB-CI-AH-TERM            PIC S999        COMP-3.
  4542             20  PB-CI-AH-BENEFIT-CD      PIC XX.
  4543             20  PB-CI-AH-BENEFIT-AMT     PIC S9(7)V99    COMP-3.
  4544             20  PB-CI-AH-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  4545             20  PB-CI-RATE-CLASS         PIC XX.
  4546             20  PB-CI-RATE-DEV-LF        PIC XXX.
  4547             20  PB-CI-RATE-DEV-AH        PIC XXX.
  4548             20  PB-CI-RATE-DEV-PCT-LF    PIC S9V9(6)     COMP-3.
  4549             20  PB-CI-RATE-DEV-PCT-AH    PIC S9V9(6)     COMP-3.
  4550             20  PB-CI-LIFE-COMMISSION    PIC SV9(5)      COMP-3.
  4551             20  PB-CI-AH-COMMISSION      PIC SV9(5)      COMP-3.
  4552             20  PB-CI-LF-ABBR            PIC X(3).
  4553             20  PB-CI-AH-ABBR            PIC X(3).
  4554             20  PB-CI-OB-FLAG            PIC X.
  4555                 88  PB-CI-OB                VALUE 'B'.
  4556             20  PB-CI-LF-POLICY-STATUS   PIC X.
  4557                 88  PB-CI-LF-POLICY-IS-ACTIVE       VALUE '1' '3'
  4558                                           'M' '4' '5' '9' '2'.
  4559                 88  PB-CI-LF-NORMAL-ENTRY           VALUE '1'.
  4560                 88  PB-CI-LF-POLICY-PENDING         VALUE '2'.
  4561                 88  PB-CI-LF-POLICY-IS-RESTORE      VALUE '3'.
  4562                 88  PB-CI-LF-CONVERSION-ENTRY       VALUE '4'.
  4563                 88  PB-CI-LF-POLICY-IS-REISSUE      VALUE '5'.
  4564                 88  PB-CI-LF-POLICY-IS-CASH         VALUE 'C'.
  4565                 88  PB-CI-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  4566                 88  PB-CI-LF-LUMP-SUM-DISAB         VALUE '6'.
  4567                 88  PB-CI-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  4568                 88  PB-CI-LF-CANCEL-APPLIED         VALUE '8'.
  4569                 88  PB-CI-LF-REIN-ONLY              VALUE '9'.
  4570                 88  PB-CI-LF-POLICY-IS-DECLINED     VALUE 'D'.
  4571                 88  PB-CI-LF-POLICY-IS-VOID         VALUE 'V'.
  4572             20  PB-CI-AH-POLICY-STATUS   PIC X.
  4573                 88  PB-CI-AH-POLICY-IS-ACTIVE       VALUE '1' '3'
  4574                                           'M' '4' '5' '9' '2'.
  4575                 88  PB-CI-AH-NORMAL-ENTRY           VALUE '1'.
  4576                 88  PB-CI-AH-POLICY-PENDING         VALUE '2'.
  4577                 88  PB-CI-AH-POLICY-IS-RESTORE      VALUE '3'.
  4578                 88  PB-CI-AH-CONVERSION-ENTRY       VALUE '4'.
  4579                 88  PB-CI-AH-POLICY-IS-REISSUE      VALUE '5'.
  4580                 88  PB-CI-AH-POLICY-IS-CASH         VALUE 'C'.
  4581                 88  PB-CI-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  4582                 88  PB-CI-AH-LUMP-SUM-DISAB         VALUE '6'.
  4583                 88  PB-CI-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  4584                 88  PB-CI-AH-CANCEL-APPLIED         VALUE '8'.
  4585                 88  PB-CI-AH-REIN-ONLY              VALUE '9'.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  91
* ECS010MO.cbl (/apps/prod/cid1p/copy/ERCPNDB)
  4586                 88  PB-CI-AH-POLICY-IS-DECLINED     VALUE 'D'.
  4587                 88  PB-CI-AH-POLICY-IS-VOID         VALUE 'V'.
  4588             20  PB-CI-PAY-FREQUENCY      PIC 99.
  4589             20  PB-CI-LOAN-APR           PIC 9(3)V9(4)   COMP-3.
  4590             20  PB-CI-SOC-SEC-NO         PIC X(11).
  4591             20  PB-CI-MEMBER-NO          PIC X(12).
  4592             20  PB-CI-INT-CODE           PIC X.
  4593                 88  PB-CI-ADD-ON                  VALUE 'A'.
  4594                 88  PB-CI-SIMPLE                  VALUE 'S'.
  4595             20  PB-CI-LOAN-TERM          PIC S999        COMP-3.
  4596             20  PB-CI-LOAN-1ST-PMT-DT    PIC X(2).
  4597             20  PB-CI-COMP-EXCP-SW       PIC X.
  4598                 88  PB-CI-NO-COMP-EXCP            VALUE ' '.
  4599                 88  PB-CI-CERT-HAS-ERCOMM-ENTRY   VALUE '1'.
  4600             20  PB-CI-ENTRY-STATUS       PIC X.
  4601             20  PB-CI-CURR-SEQ           PIC S9(4)       COMP.
  4602             20  PB-CI-AH-PAID-THRU-DT    PIC XX.
  4603             20  PB-CI-AH-SETTLEMENT-DT   PIC XX.
  4604             20  PB-CI-DEATH-DT           PIC XX.
  4605             20  PB-CI-LF-PRIOR-CANCEL-DT PIC XX.
  4606             20  PB-CI-AH-PRIOR-CANCEL-DT PIC XX.
  4607             20  PB-CI-AH-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  4608             20  PB-CI-LF-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  4609             20  PB-CI-CREDIT-INTERFACE-SW-1 PIC X.
  4610             20  PB-CI-CREDIT-INTERFACE-SW-2 PIC X.
  4611             20  PB-CI-ENTRY-DT              PIC XX.
  4612             20  PB-CI-ENTRY-BATCH           PIC X(6).
  4613             20  PB-CI-LF-EXPIRE-DT          PIC XX.
  4614             20  PB-CI-AH-EXPIRE-DT          PIC XX.
  4615             20  PB-CI-EXTENTION-DAYS        PIC S999     COMP-3.
  4616             20  PB-CI-TERM-IN-DAYS          PIC S9(5)    COMP-3.
  4617             20  PB-CI-OLD-LOF               PIC XXX.
  4618*            20  PB-CI-LOAN-OFFICER          PIC XXX.
  4619             20  PB-CI-LIVES                 PIC S9(3)    COMP-3.
  4620             20  PB-CI-LF-CRIT-PER           PIC S9(3)    COMP-3.
  4621             20  PB-CI-AH-CRIT-PER           PIC S9(3)    COMP-3.
  4622             20  PB-CI-INDV-GRP-CD           PIC X.
  4623             20  PB-CI-BENEFICIARY-NAME.
  4624                 24  PB-CI-BANK-NUMBER       PIC X(10).
  4625                 24  FILLER                  PIC X(15).
  4626             20  PB-CI-NOTE-SW               PIC X.
  4627             20  PB-CI-CANCEL-FEE            PIC S9(3)V99 COMP-3.
  4628             20  PB-CI-MUNI-TAX              PIC S9(7)V99 COMP-3.
  4629             20  PB-CI-STATE-TAX             PIC S9(7)V99 COMP-3.
  4630             20  PB-CI-ADDL-CLP              PIC S9(5)V99 COMP-3.
  4631             20  PB-CI-LOAN-OFFICER          PIC X(5).
  4632             20  PB-CI-BOW-LOAN-NUMBER       PIC X(14).
  4633             20  PB-CI-FIRST-NAME            PIC X(10).
  4634             20  PB-CI-DDF-IU-RATE-UP        PIC S9(5)V99 COMP-3.
  4635
  4636         16  FILLER                       PIC X(13).
  4637*032306  16  FILLER                       PIC X(27).
  4638*        16  FILLER                       PIC X(46).
  4639
  4640     12  PB-MAIL-RECORD    REDEFINES PB-RECORD-BODY.
  4641         16  FILLER                       PIC X(10).
  4642         16  PB-M-INSURED-LAST-NAME       PIC X(15).
  4643         16  PB-M-INSURED-FIRST-NAME      PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  92
* ECS010MO.cbl (/apps/prod/cid1p/copy/ERCPNDB)
  4644         16  PB-M-INSURED-MID-INIT        PIC X.
  4645         16  PB-M-INSURED-AGE             PIC 99.
  4646         16  PB-M-INSURED-BIRTHDAY        PIC XX.
  4647         16  PB-M-INSURED-SEX             PIC X.
  4648         16  PB-M-INSURED-SOC-SEC-NO      PIC X(11).
  4649         16  PB-M-INSURED-ADDRESS-1       PIC X(30).
  4650         16  PB-M-INSURED-ADDRESS-2       PIC X(30).
  4651         16  PB-M-INSURED-CITY-STATE.
  4652             20  PB-M-INSURED-CITY        PIC X(28).
  4653             20  PB-M-INSURED-STATE       PIC XX.
  4654         16  PB-M-INSURED-ZIP-CODE.
  4655             20  PB-M-INSURED-ZIP-PRIME.
  4656                 24  PB-M-INSURED-ZIP-1   PIC X.
  4657                     88  PB-M-CANADIAN-POST-CODE
  4658                                             VALUE 'A' THRU 'Z'.
  4659                 24  FILLER               PIC X(4).
  4660             20  PB-M-INSURED-ZIP-PLUS4   PIC X(4).
  4661         16  PB-M-INSURED-CANADIAN-ZIP  REDEFINES
  4662                                        PB-M-INSURED-ZIP-CODE.
  4663             20  PM-M-INS-CAN-POST1       PIC XXX.
  4664             20  PM-M-INS-CAN-POST2       PIC XXX.
  4665             20  FILLER                   PIC XXX.
  4666         16  PB-M-INSURED-PHONE-NO        PIC 9(10).
  4667         16  PB-M-JOINT-BIRTHDAY          PIC XX.
  4668         16  PB-M-CRED-BENE-NAME          PIC X(30).
  4669         16  PB-M-CRED-BENE-ADDR1         PIC X(30).
  4670         16  PB-M-CRED-BENE-ADDR2         PIC X(30).
  4671         16  PB-M-CRED-BENE-CITYST.
  4672             20  PB-M-CRED-BENE-CITY      PIC X(28).
  4673             20  PB-M-CRED-BENE-STATE     PIC XX.
  4674
  4675         16  FILLER                       PIC X(92).
  4676
  4677     12  PB-BATCH-RECORD   REDEFINES PB-RECORD-BODY.
  4678         16  FILLER                       PIC X(10).
  4679         16  PB-B-LF-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4680         16  PB-B-LF-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4681         16  PB-B-LF-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4682         16  PB-B-LF-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4683         16  PB-B-LF-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4684         16  PB-B-LF-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4685         16  PB-B-AH-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4686         16  PB-B-AH-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4687         16  PB-B-AH-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4688         16  PB-B-AH-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4689         16  PB-B-AH-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4690         16  PB-B-AH-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4691         16  PB-B-ISSUE-CNT-REMITTED      PIC S9(5)    COMP-3.
  4692         16  PB-B-ISSUE-CNT-ENTERED       PIC S9(5)    COMP-3.
  4693         16  PB-B-CANCEL-CNT-REMITTED     PIC S9(5)    COMP-3.
  4694         16  PB-B-CANCEL-CNT-ENTERED      PIC S9(5)    COMP-3.
  4695         16  PB-B-HIGHEST-SEQ-NO          PIC S9(4)    COMP.
  4696         16  PB-ACCOUNT-NAME              PIC X(30).
  4697         16  PB-PREM-REF-RPT-FLAG         PIC X.
  4698         16  PB-REFERENCE                 PIC X(12).
  4699         16  PB-B-RECEIVED-DT             PIC XX.
  4700         16  FILLER                       PIC X(234).
  4701
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  93
* ECS010MO.cbl (/apps/prod/cid1p/copy/ERCPNDB)
  4702     12  PB-RECORD-STATUS.
  4703         16  PB-CREDIT-SELECT-DT          PIC XX.
  4704         16  PB-CREDIT-ACCEPT-DT          PIC XX.
  4705         16  PB-BILLED-DT                 PIC XX.
  4706         16  PB-BILLING-STATUS            PIC X.
  4707             88  PB-ENTRY-REVERSED            VALUE 'R'.
  4708             88  PB-EL860-INTERNAL-ERROR      VALUE 'E'.
  4709             88  PB-EL860-INTERNAL-PROCESS    VALUE 'P'.
  4710         16  PB-RECORD-BILL               PIC X.
  4711             88  PB-RECORD-ON-HOLD            VALUE 'H'.
  4712             88  PB-RECORD-RETURNED           VALUE 'R'.
  4713             88  PB-RECORD-ENDORSED           VALUE 'E'.
  4714             88  PB-OVERRIDE-LIFE             VALUE 'L'.
  4715             88  PB-OVERRIDE-AH               VALUE 'A'.
  4716             88  PB-OVERRIDE-BOTH             VALUE 'B'.
  4717         16  PB-BATCH-ENTRY               PIC X.
  4718             88  PB-POLICY-IS-DECLINED        VALUE 'D'.
  4719             88  PB-REIN-ONLY-CERT            VALUE 'R'.
  4720             88  PB-REISSUED-CERT             VALUE 'E'.
  4721             88  PB-CASH-CERT                 VALUE 'C'.
  4722             88  PB-MONTHLY-CERT              VALUE 'M'.
  4723             88  PB-PREM-ACCTNG-ONLY          VALUE 'P'.
  4724             88  PB-NEEDS-UNDERWRITING        VALUE 'U'.
  4725             88  PB-POLICY-IS-VOIDED          VALUE 'V'.
  4726         16  PB-FORCE-CODE                PIC X.
  4727             88  PB-FORCE-OFF                 VALUE ' ' '0'.
  4728             88  PB-ISSUE-FORCE               VALUE 'A' 'O'.
  4729             88  PB-CANCEL-FORCE              VALUE '8'.
  4730             88  PB-ALL-ISSUE-FORCED          VALUE 'A' 'O'.
  4731             88  PB-ALL-CANCEL-FORCED         VALUE '8'.
  4732             88  PB-ALL-CANCEL-FORCED-NO-FEE  VALUE '9'.
  4733             88  PB-CANCEL-DATE-FORCED        VALUE 'D'.
  4734             88  PB-CANCEL-DATE-FORCED-NO-FEE VALUE 'E'.
  4735             88  PB-ISSUE-DATE-FORCED         VALUE 'D'.
  4736             88  PB-OVERCHARGE-FORCE          VALUE 'O'.
  4737         16  PB-FATAL-FLAG                PIC X.
  4738             88  PB-FATAL-ERRORS              VALUE 'X'.
  4739         16  PB-FORCE-ER-CD               PIC X.
  4740             88  PB-FORCE-ERRORS              VALUE 'F'.
  4741             88  PB-UNFORCED-ERRORS           VALUE 'X'.
  4742         16  PB-WARN-ER-CD                PIC X.
  4743             88  PB-WARNING-ERRORS            VALUE 'W'.
  4744         16  FILLER                       PIC X.
  4745         16  PB-OUT-BAL-CD                PIC X.
  4746             88  PB-OUT-OF-BAL                VALUE 'O'.
  4747         16  PB-LIFE-OVERRIDE-L1          PIC X.
  4748         16  PB-AH-OVERRIDE-L1            PIC X.
  4749         16  PB-INPUT-DT                  PIC XX.
  4750         16  PB-INPUT-BY                  PIC X(4).
  4751         16  PB-CHG-COUNT                 PIC 9(3)        COMP-3.
  4752         16  PB-CALC-TOLERANCE            PIC 9(3)V99     COMP-3.
  4753         16  PB-TOLERANCE-REJECT-SW       PIC X.
  4754         16  PB-LF-EARNING-METHOD         PIC X.
  4755         16  PB-AH-EARNING-METHOD         PIC X.
  4756         16  PB-LF-TERM-CALC-METHOD       PIC X.
  4757         16  PB-AH-TERM-CALC-METHOD       PIC X.
  4758         16  PB-REIN-CD                   PIC XXX.
  4759         16  PB-LF-REFUND-TYPE            PIC X.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  94
* ECS010MO.cbl (/apps/prod/cid1p/copy/ERCPNDB)
  4760         16  PB-AH-REFUND-TYPE            PIC X.
  4761         16  PB-ACCT-EFF-DT               PIC XX.
  4762         16  PB-ACCT-EXP-DT               PIC XX.
  4763         16  PB-COMPANY-ID                PIC X(3).
  4764         16  PB-LF-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  4765         16  PB-AH-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  4766         16  PB-SV-CARRIER                PIC X.
  4767         16  PB-SV-GROUPING               PIC X(6).
  4768         16  PB-SV-STATE                  PIC XX.
  4769         16  PB-CONFIRMATION-REPT-DT      PIC XX.
  4770         16  PB-GA-BILLING-INFO.
  4771             20  PB-GA-BILL-DT OCCURS 5 TIMES
  4772                                          PIC XX.
  4773         16  PB-SV-REMIT-TO  REDEFINES
  4774             PB-GA-BILLING-INFO           PIC X(10).
  4775         16  PB-NO-OF-ERRORS              PIC S9(3) COMP-3.
  4776         16  PB-I-LOAN-OFFICER            PIC X(5).
  4777         16  PB-I-VIN                     PIC X(17).
  4778
  4779         16  FILLER                       PIC X(04).
  4780         16  IMNET-BYPASS-SW              PIC X.
  4781
  4782******************************************************************
  4783*                COMMON EDIT ERRORS                              *
  4784******************************************************************
  4785
  4786     12  PB-COMMON-ERRORS.
  4787         16  PB-COMMON-ERROR    OCCURS 10 TIMES
  4788                                           PIC S9(4)     COMP.
  4789
  4790******************************************************************
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  95
* ECS010MO.cbl
  4792 01  PC-STARTS-HERE              PIC X(48)
  4793       VALUE '*****   PENDING CLAIMS RECORD STARTS HERE   ****'.
  4794
* 4795                             COPY ERCPNDC.
  4796******************************************************************04/29/98
  4797*                                                                *ERCPNDC
  4798*                                                                *ERCPNDC
  4799*                            ERCPNDC                             *   LV003
  4800*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
  4801*                            VMOD=2.004                          *   CL**2
  4802*                                                                *ERCPNDC
  4803*   FILE DESCRIPTION = PENDING CLAIM TRANSACTIONS                *ERCPNDC
  4804*                      PAYMENTS, RESERVES, EXPENSES              *ERCPNDC
  4805*                                                                *ERCPNDC
  4806*   FILE TYPE = VSAM,KSDS                                        *ERCPNDC
  4807*   RECORD SIZE = 500  RECFORM = FIXED                           *ERCPNDC
  4808*                                                                *ERCPNDC
  4809*   BASE CLUSTER = ERPNDC                         RKP=2,LEN=50   *ERCPNDC
  4810*       ALTERNATE PATHS = NONE                                   *ERCPNDC
  4811*                                                                *ERCPNDC
  4812*   LOG = YES                                                    *ERCPNDC
  4813*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *ERCPNDC
  4814******************************************************************ERCPNDC
  4815                                                                  ERCPNDC
  4816 01  PENDING-CLAIMS.                                              ERCPNDC
  4817     12  PC-RECORD-ID                     PIC XX.                 ERCPNDC
  4818         88  VALID-PC-ID                      VALUE 'PC'.         ERCPNDC
  4819                                                                  ERCPNDC
  4820     12  PC-CONTROL-PRIMARY.                                      ERCPNDC
  4821         16  PC-COMPANY-CD                PIC X.                  ERCPNDC
  4822         16  PC-CARRIER                   PIC X.                  ERCPNDC
  4823         16  PC-GROUPING.                                         ERCPNDC
  4824             20  PC-GROUPING-PREFIX       PIC XXX.                ERCPNDC
  4825             20  PC-GROUPING-PRIME        PIC XXX.                ERCPNDC
  4826         16  PC-STATE                     PIC XX.                 ERCPNDC
  4827         16  PC-ACCOUNT.                                          ERCPNDC
  4828             20  PC-ACCOUNT-PREFIX        PIC X(4).               ERCPNDC
  4829             20  PC-ACCOUNT-PRIME         PIC X(6).               ERCPNDC
  4830         16  PC-CERT-EFF-DT               PIC XX.                 ERCPNDC
  4831         16  PC-CERT-NO.                                          ERCPNDC
  4832             20  PC-CERT-PRIME            PIC X(10).              ERCPNDC
  4833             20  PC-CERT-SFX              PIC X.                  ERCPNDC
  4834         16  PC-CLAIM-NO                  PIC X(7).               ERCPNDC
  4835         16  PC-CHECK-NO                  PIC X(7).               ERCPNDC
  4836                                                                  ERCPNDC
  4837         16  PC-RECORD-TYPE               PIC X.                  ERCPNDC
  4838             88  PC-CLAIMS                    VALUE '1'.          ERCPNDC
  4839             88  PC-RESERVES                  VALUE '2'.          ERCPNDC
  4840         16  PC-RECORD-SEQUENCE           PIC S9(4)     COMP.     ERCPNDC
  4841                                                                  ERCPNDC
  4842     12  PC-LAST-MAINT-DT                 PIC XX.                 ERCPNDC
  4843     12  PC-LAST-MAINT-BY                 PIC X(4).               ERCPNDC
  4844     12  PC-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.   ERCPNDC
  4845                                                                  ERCPNDC
  4846     12  PC-CLAIM-RECORD.                                         ERCPNDC
  4847         16  PC-CLAIM-TYPE                PIC X.                  ERCPNDC
  4848             88  PC-LF-CLAIM                  VALUE '1'.          ERCPNDC
  4849             88  PC-AH-CLAIM                  VALUE '2'.          ERCPNDC
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  96
* ECS010MO.cbl (/apps/prod/cid1p/copy/ERCPNDC)
  4850             88  PC-OB-LF-CLAIM               VALUE '3'.          ERCPNDC
  4851             88  PC-OB-AH-CLAIM               VALUE '4'.          ERCPNDC
  4852         16  PC-PAYMENT-DT                PIC XX.                 ERCPNDC
  4853         16  PC-PAID-THRU-DT              PIC XX.                 ERCPNDC
  4854         16  PC-REPORTED-DT               PIC XX.                 ERCPNDC
  4855         16  PC-INCURRED-DT               PIC XX.                 ERCPNDC
  4856         16  PC-NO-OF-DAYS-PAID           PIC S9(3)     COMP-3.   ERCPNDC
  4857         16  PC-CLAIM-PAYMENT             PIC S9(7)V99  COMP-3.   ERCPNDC
  4858         16  PC-AGE-AT-CLAIM              PIC 99.                 ERCPNDC
  4859         16  FILLER                       PIC XX.                 ERCPNDC
  4860         16  PC-PAYMENT-TYPE              PIC X.                  ERCPNDC
  4861             88  PC-PARTIAL-PAYMENT           VALUE '1'.          ERCPNDC
  4862             88  PC-FINAL-PAYMENT             VALUE '2'.          ERCPNDC
  4863             88  PC-LUMP-SUM-PAYMENT          VALUE '3'.          ERCPNDC
  4864             88  PC-ADDITIONAL-PAYMENT        VALUE '4'.          ERCPNDC
  4865             88  PC-CHARGEBLE-EXPENSE         VALUE '5'.          ERCPNDC
  4866             88  PC-NON-CHARGEBLE-EXPENSE     VALUE '6'.          ERCPNDC
  4867             88  PC-VOIDED-PAYMENT            VALUE '9'.          ERCPNDC
  4868                                                                  ERCPNDC
  4869         16  PC-FUTURE-RESERVE-AMT        PIC S9(7)V99  COMP-3.   ERCPNDC
  4870         16  PC-IBNR-RESERVE-AMT          PIC S9(7)V99  COMP-3.   ERCPNDC
  4871         16  PC-PTC-RESERVE-AMT           PIC S9(7)V99  COMP-3.   ERCPNDC
  4872         16  PC-MANUAL-RESERVE-AMT        PIC S9(7)V99  COMP-3.   ERCPNDC
  4873                                                                  ERCPNDC
  4874         16  PC-SV-CARRIER                PIC X.                  ERCPNDC
  4875         16  PC-SV-GROUPING               PIC X(6).               ERCPNDC
  4876         16  PC-SV-STATE                  PIC XX.                 ERCPNDC
  4877                                                                  ERCPNDC
  4878         16  PC-VOID-SW                   PIC X.                  ERCPNDC
  4879             88  PC-PUT-CERT-INFORCE          VALUE '1'.          ERCPNDC
  4880                                                                  ERCPNDC
  4881         16  PC-CAUSE-CODE                PIC X(6).               ERCPNDC
  4882         16  FILLER                       PIC X(48).              ERCPNDC
  4883                                                                  ERCPNDC
  4884         16  PC-CLAIMED-CERT-DATA.                                ERCPNDC
  4885             20  PC-CC-INSURED-NAME.                              ERCPNDC
  4886                 24  PC-CC-LAST-NAME      PIC X(15).              ERCPNDC
  4887                 24  PC-CC-INITIALS       PIC XX.                 ERCPNDC
  4888             20  PC-CC-INSURED-AGE        PIC S99.                ERCPNDC
  4889             20  PC-CC-INSURED-SEX        PIC X.                  ERCPNDC
  4890             20  PC-CC-ORIG-TERM          PIC S999        COMP-3. ERCPNDC
  4891             20  PC-CC-LF-BENEFIT-CD      PIC XX.                 ERCPNDC
  4892             20  PC-CC-LIFE-BENEFIT-AMT   PIC S9(9)V99    COMP-3. ERCPNDC
  4893             20  PC-CC-ALT-LF-BENEFIT-AMT PIC S9(9)V99    COMP-3. ERCPNDC
  4894             20  PC-CC-LIFE-PREMIUM       PIC S9(7)V99    COMP-3. ERCPNDC
  4895             20  PC-CC-AH-BENEFIT-CD      PIC XX.                 ERCPNDC
  4896             20  PC-CC-AH-BENEFIT-AMT     PIC S9(7)V99    COMP-3. ERCPNDC
  4897             20  PC-CC-AH-PREMIUM-AMT     PIC S9(7)V99    COMP-3. ERCPNDC
  4898             20  PC-CC-RATE-CLASS         PIC XX.                 ERCPNDC
  4899             20  PC-CC-RATE-DEV           PIC XXX.                ERCPNDC
  4900             20  PC-CC-OB-FLAG            PIC X.                  ERCPNDC
  4901                 88  PC-CC-OB                VALUE 'B'.           ERCPNDC
  4902             20  PC-CC-AH-POLICY-STATUS   PIC X.                  ERCPNDC
  4903                 88  PC-CCA-POLICY-IS-ACTIVE        VALUE '1' '3' ERCPNDC
  4904                                               '4' '5' '9' '2'.   ERCPNDC
  4905                 88  PC-CCA-NORMAL-ENTRY            VALUE '1'.    ERCPNDC
  4906                 88  PC-CCA-POLICY-PENDING          VALUE '2'.    ERCPNDC
  4907                 88  PC-CCA-POLICY-IS-RESTORE       VALUE '3'.    ERCPNDC
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  97
* ECS010MO.cbl (/apps/prod/cid1p/copy/ERCPNDC)
  4908                 88  PC-CCA-CONVERSION-ENTRY        VALUE '4'.    ERCPNDC
  4909                 88  PC-CCA-POLICY-IS-REISSUE       VALUE '5'.    ERCPNDC
  4910                 88  PC-CCA-LUMP-SUM-DISAB          VALUE '6'.    ERCPNDC
  4911                 88  PC-CCA-DEATH-CLAIM-APPLIED     VALUE '7'.    ERCPNDC
  4912                 88  PC-CCA-CANCEL-APPLIED          VALUE '8'.    ERCPNDC
  4913                 88  PC-CCA-REIN-ONLY               VALUE '9'.    ERCPNDC
  4914             20  PC-CC-LF-POLICY-STATUS   PIC X.                  ERCPNDC
  4915                 88  PC-CCL-POLICY-IS-ACTIVE        VALUE '1' '3' ERCPNDC
  4916                                               '4' '5' '9' '2'.   ERCPNDC
  4917                 88  PC-CCL-NORMAL-ENTRY            VALUE '1'.    ERCPNDC
  4918                 88  PC-CCL-POLICY-PENDING          VALUE '2'.    ERCPNDC
  4919                 88  PC-CCL-POLICY-IS-RESTORE       VALUE '3'.    ERCPNDC
  4920                 88  PC-CCL-CONVERSION-ENTRY        VALUE '4'.    ERCPNDC
  4921                 88  PC-CCL-POLICY-IS-REISSUE       VALUE '5'.    ERCPNDC
  4922                 88  PC-CCL-LUMP-SUM-DISAB          VALUE '6'.    ERCPNDC
  4923                 88  PC-CCL-DEATH-CLAIM-APPLIED     VALUE '7'.    ERCPNDC
  4924                 88  PC-CCL-CANCEL-APPLIED          VALUE '8'.    ERCPNDC
  4925                 88  PC-CCL-REIN-ONLY               VALUE '9'.    ERCPNDC
  4926             20  PC-CC-PAY-FREQUENCY      PIC 99.                 ERCPNDC
  4927             20  PC-CC-LOAN-APR           PIC 9(3)V9(4)   COMP-3. ERCPNDC
  4928             20  PC-CC-SOC-SEC-NO         PIC X(11).              ERCPNDC
  4929             20  PC-CC-MEMBER-NO          PIC X(12).              ERCPNDC
  4930             20  PC-CC-INT-CODE           PIC X.                  ERCPNDC
  4931                 88  PC-CC-ADD-ON                  VALUE 'A'.     ERCPNDC
  4932                 88  PC-CC-SIMPLE                  VALUE 'S'.     ERCPNDC
  4933             20  PC-CC-CAPPED-TERM        PIC 999.                ERCPNDC
  4934             20  PC-CC-PRIOR-LUMP-PMT     PIC S9(7)V99  COMP-3.   ERCPNDC
  4935             20  PC-CC-PRIOR-DEATH-AMT    PIC S9(9)V99  COMP-3.   ERCPNDC
  4936             20  PC-CC-CANCEL-DT          PIC XX.                 ERCPNDC
  4937             20  PC-CC-DEATH-DT           PIC XX.                 ERCPNDC
  4938             20  PC-CC-SETTLEMENT-DT      PIC XX.                 ERCPNDC
  4939             20  PC-CC-PRIOR-STATUS       PIC X.                  ERCPNDC
  4940             20  PC-CC-CERT-ENTRY-STATUS  PIC X.                  ERCPNDC
  4941         16  PC-TRLR-SEQ-NO               PIC S9(4)     COMP.     ERCPNDC
  4942         16  PC-CC-CLP-STATE              PIC XX.
  4943         16  FILLER                       PIC X(14).              ERCPNDC
  4944         16  PC-REMAINING-BENEFIT         PIC S9(9)V99  COMP-3.   ERCPNDC
  4945         16  PC-REMAINING-TERM            PIC S9(3)     COMP-3.   ERCPNDC
  4946         16  FILLER                       PIC X(34).              ERCPNDC
  4947                                                                  ERCPNDC
  4948     12  PC-RECORD-STATUS.                                        ERCPNDC
  4949         16  PC-CREDIT-SELECT-DT          PIC XX.                 ERCPNDC
  4950         16  PC-CREDIT-ACCEPT-DT          PIC XX.                 ERCPNDC
  4951         16  FILLER                       PIC XX.                 ERCPNDC
  4952         16  PC-FATAL-FLAG                PIC X.                  ERCPNDC
  4953             88  PC-FATAL-ERRORS             VALUE 'X'.           ERCPNDC
  4954         16  PC-FORCE-CODE                PIC X.                  ERCPNDC
  4955             88  PC-FORCE-OFF                VALUE ' ' '0'.       ERCPNDC
  4956             88  PC-CLAIM-FORCE              VALUE '6' '7'        ERCPNDC
  4957                                                     '8'.         ERCPNDC
  4958         16  PC-FORCE-ER-CD               PIC X.                  ERCPNDC
  4959             88  PC-FORCE-ERRORS             VALUE 'F'.           ERCPNDC
  4960             88  PC-UNFORCED-ERRORS          VALUE 'X'.           ERCPNDC
  4961         16  PC-WARN-ER-CD                PIC X.                  ERCPNDC
  4962             88  PC-WARNING-ERRORS           VALUE 'W'.           ERCPNDC
  4963         16  PC-LF-OVERRIDE-L1            PIC X.                  ERCPNDC
  4964         16  PC-AH-OVERRIDE-L1            PIC X.                  ERCPNDC
  4965         16  FILLER                       PIC X(17).              ERCPNDC
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  98
* ECS010MO.cbl (/apps/prod/cid1p/copy/ERCPNDC)
  4966         16  PC-CERT-UPDATE-SW            PIC X.                  ERCPNDC
  4967             88  PC-CERT-DATA-CAPTURED       VALUE '1'.           ERCPNDC
  4968         16  PC-COMPANY-ID                PIC XXX.                ERCPNDC
  4969         16  PC-INPUT-DT                  PIC XX.                 ERCPNDC
  4970                                                                  ERCPNDC
  4971     12  PC-ERROR-FLAGS.                                          ERCPNDC
  4972         16  PC-STANDARD-ERRORS.                                  ERCPNDC
  4973             20  PC-STD-ERROR-FLAGS   OCCURS 25 TIMES PIC X.      ERCPNDC
  4974         16  PC-TRANSACTION-ERRORS.                               ERCPNDC
  4975             20  PC-TRN-ERROR-FLAGS   OCCURS 75 TIMES PIC X.      ERCPNDC
  4976                                                                  ERCPNDC
  4977     12  PC-ERR-FLAGS-R REDEFINES  PC-ERROR-FLAGS.                ERCPNDC
  4978         16  PC-ERR-FLAG              OCCURS 100 TIMES PIC X.     ERCPNDC
  4979                                                                  ERCPNDC
  4980     12  FILLER                           PIC X(25).              ERCPNDC
  4981                                                                  ERCPNDC
  4982******************************************************************ERCPNDC
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  99
* ECS010MO.cbl
  4984 01  CC-STARTS-HERE              PIC X(48)
  4985       VALUE '***** CERTIFICATE CHANGE RECORD STARTS HERE ****'.
  4986
* 4987                             COPY ERCCRTC.
  4988******************************************************************04/29/98
  4989*                                                                *ERCCRTC
  4990*                                                                *ERCCRTC
  4991*                            ERCCRTC                             *   LV003
  4992*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  4993*                            VMOD=2.005                          *   CL**3
  4994*                                                                *ERCCRTC
  4995*   FILE DESCRIPTION = PENDING CHANGES TO CERTIFICATE RECORD     *ERCCRTC
  4996*                      (MAINTENANCE ONLY - SEE ERCPNDB FOR NEW   *ERCCRTC
  4997*                       ISSUES AND CANCELS)                      *ERCCRTC
  4998*   FILE TYPE = VSAM,KSDS                                        *ERCCRTC
  4999*   RECORD SIZE = 300  RECFORM = FIXED                           *ERCCRTC
  5000*                                                                *ERCCRTC
  5001*   BASE CLUSTER = ERCRTC                         RKP=2,LEN=37   *ERCCRTC
  5002*       ALTERNATE PATHS = NONE                                   *ERCCRTC
  5003*                                                                *ERCCRTC
  5004*   LOG = YES                                                    *ERCCRTC
  5005*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *ERCCRTC
  5006******************************************************************ERCCRTC
  5007*                   C H A N G E   L O G
  5008*
  5009* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5010*-----------------------------------------------------------------
  5011*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5012* EFFECTIVE    NUMBER
  5013*-----------------------------------------------------------------
  5014* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  5015******************************************************************
  5016 01  PENDING-MAINT-TO-CERT-FILE.                                  ERCCRTC
  5017     12  CC-RECORD-ID                     PIC XX.                 ERCCRTC
  5018         88  VALID-CC-ID                        VALUE 'CC'.       ERCCRTC
  5019                                                                  ERCCRTC
  5020     12  CC-CONTROL-PRIMARY.                                      ERCCRTC
  5021         16  CC-COMPANY-CD                PIC X.                  ERCCRTC
  5022         16  CC-CARRIER                   PIC X.                  ERCCRTC
  5023         16  CC-GROUPING                  PIC X(6).               ERCCRTC
  5024         16  CC-STATE                     PIC XX.                 ERCCRTC
  5025         16  CC-ACCOUNT                   PIC X(10).              ERCCRTC
  5026         16  CC-CERT-EFF-DT               PIC XX.                 ERCCRTC
  5027         16  CC-CERT-NO.                                          ERCCRTC
  5028             20  CC-CERT-PRIME            PIC X(10).              ERCCRTC
  5029             20  CC-CERT-SFX              PIC X.                  ERCCRTC
  5030                                                                  ERCCRTC
  5031         16  CC-FILE-SEQ-NO               PIC S9(8)     COMP.     ERCCRTC
  5032                                                                  ERCCRTC
  5033     12  CC-LAST-MAINT-DT                 PIC XX.                 ERCCRTC
  5034     12  CC-LAST-MAINT-BY                 PIC X(4).               ERCCRTC
  5035     12  CC-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.   ERCCRTC
  5036                                                                  ERCCRTC
  5037     12  CC-RECORD-BODY                   PIC X(191).             ERCCRTC
  5038                                                                  ERCCRTC
  5039     12  CC-CHANGES-RECORD   REDEFINES CC-RECORD-BODY.            ERCCRTC
  5040         16  FILLER                       PIC X(10).              ERCCRTC
  5041         16  CC-NAME.                                             ERCCRTC
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 100
* ECS010MO.cbl (/apps/prod/cid1p/copy/ERCCRTC)
  5042             20  CC-INSURED-LAST-NAME     PIC X(15).              ERCCRTC
  5043             20  CC-INSURED-FIRST-NAME.                           ERCCRTC
  5044                 24  CC-INSURED-1ST-INIT  PIC X.                  ERCCRTC
  5045                 24  FILLER               PIC X(9).               ERCCRTC
  5046             20  CC-INSURED-INITIAL2      PIC XX.                 ERCCRTC
  5047         16  CC-AGE                       PIC S99.                ERCCRTC
  5048         16  CC-INSURED-JOINT-AGE         PIC S99.                ERCCRTC
  5049         16  CC-BIRTHDAY                  PIC XX.                 ERCCRTC
  5050         16  CC-INSURED-SEX               PIC X.                  ERCCRTC
  5051             88  CC-SEX-MALE                 VALUE 'M'.           ERCCRTC
  5052             88  CC-SEX-FEMALE               VALUE 'F'.           ERCCRTC
  5053         16  CC-JOINT-INSURED-NAME.                               ERCCRTC
  5054             20  CC-JT-LAST-NAME          PIC X(15).              ERCCRTC
  5055             20  CC-JT-FIRST-NAME.                                ERCCRTC
  5056                 24  CC-JT-1ST-INIT       PIC X.                  ERCCRTC
  5057                 24  FILLER               PIC X(9).               ERCCRTC
  5058             20  CC-JT-INITIAL            PIC X.                  ERCCRTC
  5059         16  CC-LOAN-APR                  PIC 9(3)V9(4).          ERCCRTC
  5060         16  CC-PAY-FREQUENCY             PIC S99.                ERCCRTC
  5061         16  CC-BENEFICIARY               PIC X(25).              ERCCRTC
  5062         16  CC-POLICY-FORM-NO            PIC X(12).              ERCCRTC
  5063         16  CC-PREMIUM-TYPE              PIC X.                  ERCCRTC
  5064         16  CC-IND-GRP-TYPE              PIC X.                  ERCCRTC
  5065         16  CC-LOAN-NUMBER               PIC X(8).               ERCCRTC
  5066         16  CC-LOAN-BALANCE              PIC S9(7)V99  COMP-3.   ERCCRTC
  5067         16  CC-OLD-LOF                   PIC XXX.
  5068*        16  CC-LOAN-OFFICER              PIC XXX.                ERCCRTC
  5069         16  CC-USER-FIELD                PIC X.                  ERCCRTC
  5070         16  CC-SOC-SEC-NO                PIC X(11).              ERCCRTC
  5071         16  CC-MEMBER-NO                 PIC X(12).              ERCCRTC
  5072         16  CC-LF-ORIG-TERM              PIC S9(3).              ERCCRTC
  5073         16  CC-AH-ORIG-TERM              PIC S9(3).              ERCCRTC
  5074         16  FILLER                       PIC X(3).               ERCCRTC
  5075         16  CC-CLAIM-DEDUCT-WITHHELD     PIC S9(5)V99  COMP-3.   ERCCRTC
  5076         16  CC-CANCEL-DEDUCT-WITHHELD    PIC S9(5)V99  COMP-3.   ERCCRTC
  5077         16  CC-LIVES                     PIC S9(7)     COMP-3.   ERCCRTC
  5078         16  CC-BILLED                    PIC S9(7)     COMP-3.   ERCCRTC
  5079         16  CC-LOAN-OFFICER              PIC X(5).
  5080         16  FILLER                       PIC XXX.                ERCCRTC
  5081     12  CC-RECORD-STATUS.                                        ERCCRTC
  5082         16  CC-CREDIT-SELECT-DT          PIC XX.                 ERCCRTC
  5083         16  CC-CREDIT-ACCEPT-DT          PIC XX.                 ERCCRTC
  5084     12  CC-ADDITIONAL-LF-DATA.                                   ERCCRTC
  5085         16  CC-LF-BENEFIT-CD             PIC XX.                 ERCCRTC
  5086         16  CC-LF-PREMIUM-AMT            PIC S9(7)V99  COMP-3.   ERCCRTC
  5087         16  CC-LF-BENEFIT-AMT            PIC S9(9)V99  COMP-3.   ERCCRTC
  5088         16  CC-LF-EXPIRY-DT              PIC XX.                 ERCCRTC
  5089     12  CC-INPUT-DT                      PIC XX.                 ERCCRTC
  5090     12  CC-ERROR-FLAGS.                                          ERCCRTC
  5091         16  CC-STANDARD-ERRORS.                                  ERCCRTC
  5092             20  FILLER                   PIC X    OCCURS 10.     ERCCRTC
  5093         16  CC-TRANSACTION-ERRORS.                               ERCCRTC
  5094             20  FILLER                   PIC X    OCCURS 10.     ERCCRTC
  5095     12  CC-ADDITIONAL-AH-DATA.                                   ERCCRTC
  5096         16  CC-AH-BENEFIT-CD             PIC XX.                 ERCCRTC
  5097         16  CC-AH-PREMIUM-AMT            PIC S9(7)V99  COMP-3.   ERCCRTC
  5098         16  CC-AH-BENEFIT-AMT            PIC S9(7)V99  COMP-3.   ERCCRTC
  5099         16  CC-AH-EXPIRY-DT              PIC XX.                 ERCCRTC
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 101
* ECS010MO.cbl (/apps/prod/cid1p/copy/ERCCRTC)
  5100                                                                  ERCCRTC
  5101     12  FILLER                           PIC X(05).              ERCCRTC
  5102******************************************************************ERCCRTC
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 102
* ECS010MO.cbl
  5104 01  CR-STARTS-HERE              PIC X(48)
  5105       VALUE '***** CERTIFICATE MASTER RECORD STARTS HERE ****'.
  5106
* 5107                             COPY ECSCRT01.
  5108******************************************************************
  5109*                                                                *
  5110*                            ECSCRT01                            *
  5111*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5112*                            VMOD=2.016                          *
  5113*                                                                *
  5114*   FILE DESCRIPTION = CERTIFICATE RECORD    (OFF-LINE)          *
  5115*                                                                *
  5116*   FILE TYPE = SEQUENTIAL
  5117*   RECORD SIZE = 1056 RECFORM = FIXED                           *
  5118*                                                                *
  5119*   KEY DATA =                         START=4, LEN=36           *
  5120*                                                                *
  5121*  NO  CID  MODS  IN  COPYBOOK  ECSCRT01                         *
  5122*                                                                *
  5123******************************************************************
  5124******************************************************************
  5125*                   C H A N G E   L O G
  5126*
  5127* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5128*-----------------------------------------------------------------
  5129*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5130* EFFECTIVE    NUMBER
  5131*-----------------------------------------------------------------
  5132* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  5133* 100703    2003080800002  PEMA  ADD SUPER GAP PROCESSING
  5134* 040504    2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  5135* 020305    2005020000000  PEMA  ADD CLP STATE TO CERT RECORD
  5136* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  5137* 042408    2007110500003  PEMA  ADD REFUND INTEREST PROCESSING
  5138* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  5139* 032612  CR2011110200001  PEMA  AHL CHANGES
  5140* 052814  CR2014012300001  PEMA  DCC CREDIT UNION CHANGES
  5141* 090314  CR2014081300001  PEMA  LOAD CERTS INVOLVED IN THAO
  5142******************************************************************
  5143
  5144 01  CERTIFICATE-RECORD.
  5145     12  CR-RECORD-ID                      PIC XX.
  5146         88  VALID-CR-ID                      VALUE 'CR'.
  5147
  5148     12  CR-COMPANY-CD                     PIC X.
  5149
  5150     12  CR-FULL-CONTROL.
  5151         16  CR-CONTROL-1.
  5152             20  CR-ACCT-CONTROL.
  5153                 24  CR-CARRIER            PIC X.
  5154                 24  CR-GROUPING.
  5155                     28  CR-GROUP-PREFIX   PIC XXX.
  5156                     28  CR-GROUP-PRIME    PIC XXX.
  5157                 24  CR-STATE              PIC XX.
  5158                 24  CR-ACCOUNT.
  5159                     28  CR-ACCT-PREFIX    PIC X(4).
  5160                     28  CR-ACCT-PRIME     PIC X(6).
  5161             20  CR-DT                     PIC 9(11)  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 103
* ECS010MO.cbl (/apps/prod/cid1p/copy/ECSCRT01)
  5162         16  CR-CERT-NO.
  5163             20  CR-CERT.
  5164                 24  CR-CERT-PREFIX        PIC X(3).
  5165                 24  CR-CERT-PRIME         PIC X(7).
  5166             20  CR-CERT-SFX               PIC X.
  5167
  5168     12  CR-INSUREDS-PROFILE.
  5169         16  CR-NAME.
  5170             20  CR-LNAME                  PIC X(15).
  5171             20  CR-FNAME.
  5172                 24  CR-1ST-INITIAL        PIC X.
  5173                 24  FILLER                PIC X(9).
  5174             20  CR-INIT                   PIC X.
  5175         16  CR-AGE                        PIC 99.
  5176         16  CR-SEX                        PIC X.
  5177             88  CR-SEX-MALE                  VALUE 'M'.
  5178             88  CR-SEX-FEMALE                VALUE 'F'.
  5179         16  CR-SOC-SEC                    PIC X(11).
  5180         16  CR-JOINT-NAME.
  5181             20  CR-JT-LNAME               PIC X(15).
  5182             20  CR-JT-FNAME.
  5183                 24  CR-JT-1ST-INIT        PIC X.
  5184                 24  FILLER                PIC X(9).
  5185             20  CR-JT-INIT                PIC X.
  5186         16  CR-JOINT-AGE                  PIC 99.
  5187
  5188         16  cr-ahl-ah-claim-no            pic x(9).
  5189         16  cr-ahl-ah-cert-seq            pic x(3).
  5190         16  cr-hst-proc-lf                pic x.
  5191         16  f                             pic x(7).
  5192
  5193     12  CR-LF-COVERAGE-DATA.
  5194         16  CR-LFTYP                      PIC XX.
  5195         16  CR-LF-TERM                    PIC S999       COMP-3.
  5196         16  CR-LF-CRIT-PERIOD             PIC S999       COMP-3.
  5197         16  CR-LF-TERM-IN-DAYS            PIC S9(5)      COMP-3.
  5198         16  CR-LF-DEV-CODE                PIC XXX.
  5199         16  CR-LF-DEV-PCT                 PIC S9V9(6)    COMP-3.
  5200
  5201         16  CR-LFAMT                      PIC S9(9)V99   COMP-3.
  5202         16  CR-LFPRM                      PIC S9(7)V99   COMP-3.
  5203         16  CR-LFPRM-CALC                 PIC S9(7)V99   COMP-3.
  5204         16  CR-LFPRM-RATE                 PIC S99V9(5)   COMP-3.
  5205
  5206         16  CR-LFAMT-ALT                  PIC S9(9)V99   COMP-3.
  5207         16  CR-LFPRM-ALT                  PIC S9(7)V99   COMP-3.
  5208         16  CR-LFPRM-CALC-ALT             PIC S9(7)V99   COMP-3.
  5209         16  CR-LFPRM-RATE-ALT             PIC S99V9(5)   COMP-3.
  5210
  5211         16  CR-LFRFND                     PIC S9(7)V99   COMP-3.
  5212         16  CR-LFRFND-CALC                PIC S9(7)V99   COMP-3.
  5213
  5214         16  CR-LF-NSP-PRM                 PIC S9(7)V99   COMP-3.
  5215         16  CR-LF-NSP-PRM-RATE            PIC S99V9(5)   COMP-3.
  5216
  5217         16  CR-LF-REFUND-TYPE             PIC X.
  5218         16  CR-LF-POLICY-FEE              PIC S9(3)V99   COMP-3.
  5219
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 104
* ECS010MO.cbl (/apps/prod/cid1p/copy/ECSCRT01)
  5220         16  CR-LF-COMM-CHARGEBACK         PIC X.
  5221             88  CR-NO-LF-CHARGEBACK          VALUE 'N'.
  5222
  5223         16  CR-LF-REI-RISK-PRM            PIC S9(7)V99   COMP-3.
  5224
  5225         16  CR-LF-EXPIRE-DATE             PIC 9(11)      COMP-3.
  5226         16  CR-LF-ISS-PREM-TAX            PIC S9V9(4)    COMP-3.
  5227         16  CR-LF-CNC-PREM-TAX            PIC S9V9(4)    COMP-3.
  5228
  5229         16  cr-ahl-lf-claim-no            pic x(9).
  5230         16  cr-ahl-lf-cert-seq            pic x(3).
  5231         16  FILLER                        PIC XX.
  5232
  5233     12  CR-AH-COVERAGE-DATA.
  5234         16  CR-AHTYP                      PIC XX.
  5235         16  CR-AH-TERM                    PIC S999       COMP-3.
  5236         16  CR-AH-CRIT-PERIOD             PIC S999       COMP-3.
  5237         16  CR-AH-DEV-CODE                PIC XXX.
  5238         16  CR-AH-DEV-PCT                 PIC S9V9(6)    COMP-3.
  5239
  5240         16  CR-AHAMT                      PIC S9(7)V99   COMP-3.
  5241         16  CR-AHPRM                      PIC S9(7)V99   COMP-3.
  5242         16  CR-AHPRM-CALC                 PIC S9(7)V99   COMP-3.
  5243         16  CR-AHPRM-RATE                 PIC S99V9(5)   COMP-3.
  5244
  5245         16  CR-AHRFND                     PIC S9(7)V99   COMP-3.
  5246         16  CR-AHRFND-CALC                PIC S9(7)V99   COMP-3.
  5247
  5248         16  CR-AH-NSP-PRM                 PIC S9(7)V99   COMP-3.
  5249         16  CR-AH-NSP-PRM-RATE            PIC S99V9(5)   COMP-3.
  5250
  5251         16  CR-AH-REFUND-TYPE             PIC X.
  5252         16  CR-AH-POLICY-FEE              PIC S9(3)V99   COMP-3.
  5253
  5254         16  CR-AH-COMM-CHARGEBACK         PIC X.
  5255             88  CR-NO-AH-CHARGEBACK          VALUE 'N'.
  5256
  5257         16  CR-AH-REI-RISK-PRM            PIC S9(7)V99   COMP-3.
  5258
  5259         16  CR-AH-EXPIRE-DATE             PIC 9(11)      COMP-3.
  5260         16  CR-AH-ISS-PREM-TAX            PIC S9V9(4)    COMP-3.
  5261         16  CR-AH-CNC-PREM-TAX            PIC S9V9(4)    COMP-3.
  5262
  5263         16  FILLER                        PIC XX.
  5264*        16  FILLER                        PIC X(8).
  5265
  5266     12  CR-LOAN-DATA.
  5267         16  CR-LIVES                      PIC S9(7)      COMP-3.
  5268         16  CR-DDF-IU-RATE-UP REDEFINES CR-LIVES
  5269                                           PIC S9(5)V99   COMP-3.
  5270         16  CR-BILLED                     PIC S9(7)      COMP-3.
  5271         16  CR-APR                        PIC S999V9(4)  COMP-3.
  5272         16  CR-PMT-FREQ                   PIC 99.
  5273         16  CR-LOAN-TERM                  PIC S999       COMP-3.
  5274         16  CR-RATING-CLASS               PIC XX.
  5275         16  CR-POLICY-FORM-NO             PIC X(12).
  5276         16  CR-GRPTYP                     PIC XX.
  5277         16  CR-IND-GRP                    PIC X.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 105
* ECS010MO.cbl (/apps/prod/cid1p/copy/ECSCRT01)
  5278             88  CR-INDIVIDUAL                VALUE '1'.
  5279             88  CR-GROUP                     VALUE '2'.
  5280         16  CR-SKIP                       PIC 99.
  5281             88  NO-MONTHS-SKIPPED            VALUE 00.
  5282             88  SKIP-JULY                    VALUE 01.
  5283             88  SKIP-AUGUST                  VALUE 02.
  5284             88  SKIP-SEPTEMBER               VALUE 03.
  5285             88  SKIP-JULY-AUG                VALUE 04.
  5286             88  SKIP-AUG-SEPT                VALUE 05.
  5287             88  SKIP-JULY-AUG-SEPT           VALUE 06.
  5288             88  SKIP-JUNE-JULY-AUG           VALUE 07.
  5289             88  SKIP-JUNE                    VALUE 08.
  5290             88  SKIP-JUNE-JULY               VALUE 09.
  5291             88  SKIP-AUG-SEPT-OCT            VALUE 10.
  5292             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 11.
  5293         16  CR-RESIDENT-STATE             PIC XX.
  5294         16  CR-RATE-CODE.
  5295             20  CR-LF-CLASS-CD            PIC XX.
  5296             20  CR-AH-CLASS-CD            PIC XX.
  5297         16  CR-MORT.
  5298             20  CR-TAB                    PIC X.
  5299             20  CR-INT                    PIC 99.
  5300             20  CR-GRP                    PIC X.
  5301         16  CR-MEMBER-NO                  PIC X(12).
  5302         16  CR-OLD-LOF                    PIC XXX.
  5303*        16  CR-LOAN-OFFICER               PIC XXX.
  5304         16  CR-REIN-TABLE                 PIC XXX.
  5305         16  CR-REIN-SPEC                  PIC X.
  5306         16  CR-LOAN-1ST-PMT-DT.
  5307             20  CR-1ST-PMT-YR             PIC 99.
  5308             20  CR-1ST-PMT-MO             PIC 99.
  5309             20  CR-1ST-PMT-DA             PIC 99.
  5310         16  CR-SUM-CAN-CNT-ITD            PIC S999       COMP-3.
  5311         16  CR-SUM-CAN-CNT-YTD            PIC S999       COMP-3.
  5312         16  CR-PMT-EXTENSION-DAYS         PIC S999       COMP-3.
  5313         16  CR-LAST-ADD-ON-DT             PIC XX.
  5314
  5315         16  CR-UNDERWRITING-CODE          PIC X.
  5316             88  CR-POLICY-UNDERWRITTEN       VALUE 'Y'.
  5317
  5318         16  CR-STATE-TAX                  PIC S9(7)V99   COMP-3.
  5319         16  CR-MUNI-TAX                   PIC S9(7)V99   COMP-3.
  5320         16  CR-CANCEL-STATE-TAX           PIC S9(7)V99   COMP-3.
  5321         16  CR-CANCEL-MUNI-TAX            PIC S9(7)V99   COMP-3.
  5322
  5323     12  CR-STATUS-INFORMATION.
  5324         16  CR-ENTRY-STATUS               PIC X.
  5325             88  CR-NORMAL-ENTRY              VALUE '1'.
  5326             88  CR-POLICY-IS-RESTORE         VALUE '3'.
  5327             88  CR-CONVERSION-ENTRY          VALUE '4'.
  5328             88  CR-POLICY-IS-REISSUE         VALUE '5'.
  5329             88  CR-POLICY-IS-CASH            VALUE 'C'.
  5330             88  CR-POLICY-IS-MONTHLY         VALUE 'M'.
  5331             88  CR-POLICY-IS-REIN-ONLY       VALUE '9'.
  5332             88  CR-POLICY-IS-DECLINED        VALUE 'D'.
  5333             88  CR-POLICY-IS-VOID            VALUE 'V'.
  5334             88  CR-POLICY-IS-PREM-ONLY       VALUE 'P'.
  5335             88  CR-POLICY-IS-ACTIVE          VALUE '1' '3' '4'
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 106
* ECS010MO.cbl (/apps/prod/cid1p/copy/ECSCRT01)
  5336                                                'C' '5' '9' 'P'.
  5337         16  CR-ENTRY-DATE                 PIC 9(11)  COMP-3.
  5338
  5339         16  CR-LF-STATUS-AT-CANCEL        PIC X.
  5340         16  CR-LF-CANC-DT                 PIC 9(11)  COMP-3.
  5341         16  CR-LF-CANCEL-EXIT-DATE        PIC 9(11)  COMP-3.
  5342
  5343         16  CR-LF-STATUS-AT-DEATH         PIC X.
  5344         16  CR-LF-CLAIM-EXIT-DATE         PIC 9(11)  COMP-3.
  5345
  5346         16  CR-LF-CURRENT-STATUS          PIC X.
  5347             88  CR-LF-NORMAL-ENTRY           VALUE '1'.
  5348             88  CR-LF-POLICY-PENDING         VALUE '2'.
  5349             88  CR-LF-POLICY-IS-RESTORE      VALUE '3'.
  5350             88  CR-LF-CONVERSION-ENTRY       VALUE '4'.
  5351             88  CR-LF-POLICY-IS-REISSUE      VALUE '5'.
  5352             88  CR-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  5353             88  CR-LF-LUMP-SUM-DISAB         VALUE '6'.
  5354             88  CR-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  5355             88  CR-LF-CANCEL-APPLIED         VALUE '8'.
  5356             88  CR-LF-IS-REIN-ONLY           VALUE '9'.
  5357             88  CR-LF-IS-DECLINED            VALUE 'D'.
  5358             88  CR-LF-IS-VOID                VALUE 'V'.
  5359             88  CR-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  5360                                                    '4' '5' '9'.
  5361
  5362         16  CR-AH-STATUS-AT-CANCEL        PIC X.
  5363
  5364         16  CR-AH-CANC-DT                 PIC 9(11)  COMP-3.
  5365         16  CR-AH-CANCEL-EXIT-DATE        PIC 9(11)  COMP-3.
  5366
  5367         16  CR-AH-STATUS-AT-SETTLEMENT    PIC X.
  5368         16  CR-AH-SETTLEMENT-EXIT-DATE    PIC 9(11)  COMP-3.
  5369
  5370         16  CR-AH-CURRENT-STATUS          PIC X.
  5371             88  CR-AH-NORMAL-ENTRY           VALUE '1'.
  5372             88  CR-AH-POLICY-PENDING         VALUE '2'.
  5373             88  CR-AH-POLICY-IS-RESTORE      VALUE '3'.
  5374             88  CR-AH-CONVERSION-ENTRY       VALUE '4'.
  5375             88  CR-AH-POLICY-IS-REISSUE      VALUE '5'.
  5376             88  CR-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  5377             88  CR-AH-LUMP-SUM-DISAB         VALUE '6'.
  5378             88  CR-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  5379             88  CR-AH-CANCEL-APPLIED         VALUE '8'.
  5380             88  CR-AH-IS-REIN-ONLY           VALUE '9'.
  5381             88  CR-AH-IS-DECLINED            VALUE 'D'.
  5382             88  CR-AH-IS-VOID                VALUE 'V'.
  5383             88  CR-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  5384                                                    '4' '5' '9'.
  5385         16  CR-LOAN-OFFICER               PIC X(5).
  5386         16  CR-CANCEL-REASON              PIC X.
  5387         16  cr-xycor-lf-cov-code          pic x(4).
  5388         16  cr-xycor-ah-cov-code          pic x(4).
  5389         16  cr-temp-epiq                  pic x(4).
  5390         16  FILLER                        PIC XX.
  5391
  5392     12  CR-DEATH-CLAIM-DATA.
  5393         16  CR-NUM-DTH-CLM                PIC S999       COMP-3.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 107
* ECS010MO.cbl (/apps/prod/cid1p/copy/ECSCRT01)
  5394
  5395         16  CR-DTH-DT                     PIC 9(11)      COMP-3.
  5396         16  CR-DTH-RPT-DT.
  5397             20  CR-DTH-RPT-YR             PIC 99.
  5398             20  CR-DTH-RPT-MO             PIC 99.
  5399             20  CR-DTH-RPT-DA             PIC 99.
  5400         16  CR-DTH-PAY-DT                 PIC 9(11)      COMP-3.
  5401
  5402         16  CR-DTHAMT                     PIC S9(9)V99   COMP-3.
  5403         16  CR-DTHAMT-YTD                 PIC S9(9)V99   COMP-3.
  5404         16  CR-DTHAMT-LAST                PIC S9(9)V99   COMP-3.
  5405         16  CR-DTHEXP                     PIC S9(7)V99   COMP-3.
  5406         16  CR-DTHEXP-YTD                 PIC S9(7)V99   COMP-3.
  5407
  5408         16  CR-DTH-AGE                    PIC 99.
  5409         16  CR-DTH-PAY-CD                 PIC X.
  5410         16  CR-DEATH-CAUSE                PIC X(6).
  5411
  5412         16  FILLER                        PIC X(16).
  5413
  5414     12  CR-DISAB-CLAIM-DATA.
  5415         16  CR-NUM-DIS-CLM                PIC S999       COMP-3.
  5416
  5417         16  CR-DIS-DT                     PIC 9(11)      COMP-3.
  5418         16  CR-DIS-RPT-DT.
  5419             20  CR-DIS-RPT-YR             PIC 99.
  5420             20  CR-DIS-RPT-MO             PIC 99.
  5421             20  CR-DIS-RPT-DA             PIC 99.
  5422         16  CR-DIS-PAY-DT                 PIC 9(11)      COMP-3.
  5423         16  CR-DIS-PTO-DT                 PIC 9(11)      COMP-3.
  5424
  5425         16  CR-DISAMT                     PIC S9(9)V99   COMP-3.
  5426         16  CR-DISAMT-YTD                 PIC S9(9)V99   COMP-3.
  5427         16  CR-DISAMT-LAST                PIC S9(9)V99   COMP-3.
  5428         16  CR-DISEXP                     PIC S9(7)V99   COMP-3.
  5429         16  CR-DISEXP-YTD                 PIC S9(7)V99   COMP-3.
  5430
  5431         16  CR-DAYS-DISAB                 PIC 999        COMP-3.
  5432         16  CR-DIS-PAY-CD                 PIC X.
  5433         16  FILLER                        PIC XX.
  5434
  5435         16  CR-DISAB-INCURRED-DETAIL.
  5436             20  CR-DISAB-DETAIL-DATA  OCCURS 5 TIMES.
  5437**ELCCRTVR MUST BE CHANGED IF THE "OCCURS" IS CHANGED.
  5438                 24  CR-DIS-INCUR-DT       PIC 9(11)     COMP-3.
  5439                 24  CR-INCUR-DISAMT       PIC S9(9)V99  COMP-3.
  5440                 24  CR-INCUR-DISEXP       PIC S9(9)V99  COMP-3.
  5441
  5442         16  CR-DISAB-CAUSE                PIC X(6).
  5443         16  FILLER                        PIC X(14).
  5444
  5445     12  CR-REMIT-TO                       PIC 99.
  5446
  5447     12  CR-COMPENSATION-LEVELS.
  5448         16  CR-AGT-LEVELS      OCCURS 10 TIMES.
  5449             20  CR-COM-AGT.
  5450                 24  CR-COM-AGT-PREFIX     PIC X(4).
  5451                 24  CR-COM-AGT-PRIME      PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 108
* ECS010MO.cbl (/apps/prod/cid1p/copy/ECSCRT01)
  5452             20  CR-AGT-TYPE               PIC X.
  5453             20  CR-LCOM-L                 PIC SV9(5)     COMP-3.
  5454             20  CR-LCOM-AH                PIC SV9(5)     COMP-3.
  5455
  5456     12  CR-BANK-NOCHRGB-MONTHS            PIC 99.
  5457     12  CR-MOB-NET-TOT-FEES               PIC S9(7)V99   COMP-3.
  5458     12  CR-ADDL-CLP                       PIC S9(5)V99   COMP-3.
  5459     12  CR-CLP-STATE                      PIC XX.
  5460     12  CR-POST-CARD-IND                  PIC X.
  5461     12  CR-LF-CLP                         PIC S9(5)V99   COMP-3.
  5462     12  CR-AH-CLP                         PIC S9(5)V99   COMP-3.
  5463     12  CR-DCC-PRODUCT-CODE               PIC XXX.
  5464     12  CR-LF-RFND-CLP                    PIC S9(5)V99   COMP-3.
  5465     12  CR-AH-RFND-CLP                    PIC S9(5)V99   COMP-3.
  5466     12  FILLER                            PIC X(07).
  5467
  5468     12  CR-CSR-CODE                       PIC XXX.
  5469
  5470     12  CR-CLAIM-DEDUCT-WITHHELD          PIC S9(5)V99   COMP-3.
  5471     12  CR-CANCEL-DEDUCT-WITHHELD         PIC S9(5)V99   COMP-3.
  5472
  5473     12  CR-MICROFILM-NUMBERS.
  5474*        16  CR-ISS-MICROFILM-NO           PIC S9(9)      COMP-3.
  5475         16  FILLER                        PIC X(5).
  5476     12  CR-NH-INT-ON-REF                  PIC S9(7)V99   COMP-3.
  5477
  5478     12  CR-USER-CODE                      PIC X.
  5479     12  CR-USER-FUTURE                    PIC X(9).
  5480
  5481     12  CR-BENEFICIARY.
  5482         16  CR-BANK-NO                    PIC X(10).
  5483         16  FILLER                        PIC X(15).
  5484
  5485     12  CR-ENTRY-BATCH                    PIC X(6).
  5486     12  CR-LF-EXIT-BATCH                  PIC X(6).
  5487     12  CR-AH-EXIT-BATCH                  PIC X(6).
  5488
  5489     12  CR-NOTE-SW                        PIC X.
  5490
  5491     12  CR-ORIGIN-INDICATOR               PIC X.
  5492         88  CR-ENTERED-MANUALLY              VALUE '1'.
  5493         88  CR-CREATED-FROM-TAPE-LOAD        VALUE '2'.
  5494
  5495     12  CR-LF-CNC-ENT-DT                  PIC 9(11)  COMP-3.
  5496     12  CR-AH-CNC-ENT-DT                  PIC 9(11)  COMP-3.
  5497     12  FILLER                            PIC X(33).
  5498
  5499******************************************************************
* 5500                             COPY ELCCRTVR.
  5501***************************************************************** 04/24/98
  5502*                                                                *ELCCRTVR
  5503*                                                                *ELCCRTVR
  5504*                            ELCCRTVR                            *   LV003
  5505*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  5506*                            VMOD=2.001                          *ELCCRTVR
  5507*                                                                *ELCCRTVR
  5508*   WORKING STORAGE FOR DATE VARIABLES CREATED                   *ELCCRTVR
  5509*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCCRTVR
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 109
* ECS010MO.cbl (/apps/prod/cid1p/copy/ELCCRTVR)
  5510*                                                                *ELCCRTVR
  5511******************************************************************ELCCRTVR
  5512                                                                  ELCCRTVR
  5513 01  WS-CERTIFICATE-RECORD-DATE.                                  ELCCRTVR
  5514     05  WS-CR-DT.                                                ELCCRTVR
  5515         10  FILLER                PIC 999.                       ELCCRTVR
  5516         10  CR-CCYY               PIC 9(04).                     ELCCRTVR
  5517         10  CR-CCYR  REDEFINES  CR-CCYY.                         ELCCRTVR
  5518             15  CR-CC             PIC 99.                        ELCCRTVR
  5519             15  CR-YR             PIC 99.                        ELCCRTVR
  5520         10  CR-MO                 PIC 99.                        ELCCRTVR
  5521         10  CR-DA                 PIC 99.                        ELCCRTVR
  5522     05  WS-CR-DT-N REDEFINES                                        CL**2
  5523            WS-CR-DT               PIC 9(11).                        CL**2
  5524     05  WS-CR-LF-EXPIRE-DATE.                                    ELCCRTVR
  5525         10  FILLER                    PIC 999.                   ELCCRTVR
  5526         10  CR-LF-EXPIRE-CCYY         PIC 9(04).                 ELCCRTVR
  5527         10  CR-LF-EXPIRE-CCYR  REDEFINES  CR-LF-EXPIRE-CCYY.     ELCCRTVR
  5528             15  CR-LF-EXPIRE-CC       PIC 99.                    ELCCRTVR
  5529             15  CR-LF-EXPIRE-YR       PIC 99.                    ELCCRTVR
  5530         10  CR-LF-EXPIRE-MO           PIC 99.                    ELCCRTVR
  5531         10  CR-LF-EXPIRE-DA           PIC 99.                    ELCCRTVR
  5532     05  WS-CR-LF-EXPIRE-DATE-N REDEFINES                            CL**2
  5533            WS-CR-LF-EXPIRE-DATE       PIC 9(11).                    CL**2
  5534     05  WS-CR-AH-EXPIRE-DATE.                                    ELCCRTVR
  5535         10  FILLER                    PIC 999.                   ELCCRTVR
  5536         10  CR-AH-EXPIRE-CCYY         PIC 9(04).                 ELCCRTVR
  5537         10  CR-AH-EXPIRE-CCYR   REDEFINES CR-AH-EXPIRE-CCYY.     ELCCRTVR
  5538             15  CR-AH-EXPIRE-CC       PIC 99.                    ELCCRTVR
  5539             15  CR-AH-EXPIRE-YR       PIC 99.                    ELCCRTVR
  5540         10  CR-AH-EXPIRE-MO           PIC 99.                    ELCCRTVR
  5541         10  CR-AH-EXPIRE-DA           PIC 99.                    ELCCRTVR
  5542     05  WS-CR-AH-EXPIRE-DATE-N REDEFINES                            CL**2
  5543            WS-CR-AH-EXPIRE-DATE       PIC 9(11).                    CL**2
  5544     05  WS-CR-ENTRY-DATE.                                        ELCCRTVR
  5545         10  FILLER                    PIC 999.                   ELCCRTVR
  5546         10  CR-ENTRY-CCYY             PIC 9(04).                 ELCCRTVR
  5547         10  CR-ENTRY-CCYR  REDEFINES  CR-ENTRY-CCYY.             ELCCRTVR
  5548             15 CR-ENTRY-CC            PIC 99.                    ELCCRTVR
  5549             15 CR-ENTRY-YR            PIC 99.                    ELCCRTVR
  5550         10  CR-ENTRY-MO               PIC 99.                    ELCCRTVR
  5551         10  CR-ENTRY-DA               PIC 99.                    ELCCRTVR
  5552     05  WS-CR-ENTRY-DATE-N REDEFINES                                CL**2
  5553            WS-CR-ENTRY-DATE           PIC 9(11).                    CL**2
  5554     05  WS-CR-LF-CANC-DT.                                        ELCCRTVR
  5555         10  FILLER                    PIC 999.                   ELCCRTVR
  5556         10  CR-LF-CNC-CCYY            PIC 9(04).                 ELCCRTVR
  5557         10  CR-LF-CNC-CCYR   REDEFINES CR-LF-CNC-CCYY.           ELCCRTVR
  5558             15  CR-LF-CNC-CC          PIC 99.                    ELCCRTVR
  5559             15  CR-LF-CNC-YR          PIC 99.                    ELCCRTVR
  5560         10  CR-LF-CNC-MO              PIC 99.                    ELCCRTVR
  5561         10  CR-LF-CNC-DA              PIC 99.                    ELCCRTVR
  5562     05  WS-CR-LF-CANC-DT-N REDEFINES                                CL**2
  5563            WS-CR-LF-CANC-DT           PIC 9(11).                    CL**2
  5564     05  WS-CR-LF-CANCEL-EXIT-DATE.                               ELCCRTVR
  5565         10  FILLER                    PIC 999.                   ELCCRTVR
  5566         10  CR-LF-CEX-CCYY            PIC 9(04).                 ELCCRTVR
  5567         10  CR-LF-CEX-CCYR  REDEFINES  CR-LF-CEX-CCYY.              CL**3
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 110
* ECS010MO.cbl (/apps/prod/cid1p/copy/ELCCRTVR)
  5568             15  CR-LF-CEX-CC          PIC 99.                    ELCCRTVR
  5569             15  CR-LF-CEX-YR          PIC 99.                    ELCCRTVR
  5570         10  CR-LF-CEX-MO              PIC 99.                    ELCCRTVR
  5571         10  CR-LF-CEX-DA              PIC 99.                    ELCCRTVR
  5572     05  WS-CR-LF-CANCEL-EXIT-DATE-N REDEFINES                       CL**2
  5573            WS-CR-LF-CANCEL-EXIT-DATE  PIC 9(11).                    CL**2
  5574     05  WS-CR-LF-CLAIM-EXIT-DATE.                                ELCCRTVR
  5575         10  FILLER                    PIC 999.                   ELCCRTVR
  5576         10  CR-LF-DEX-CCYY            PIC 9(04).                 ELCCRTVR
  5577         10  CR-LF-DEX-CCYR  REDEFINES  CR-LF-DEX-CCYY.           ELCCRTVR
  5578             15  CR-LF-DEX-CC          PIC 99.                    ELCCRTVR
  5579             15  CR-LF-DEX-YR          PIC 99.                    ELCCRTVR
  5580         10  CR-LF-DEX-MO              PIC 99.                    ELCCRTVR
  5581         10  CR-LF-DEX-DA              PIC 99.                    ELCCRTVR
  5582     05  WS-CR-LF-CLAIM-EXIT-DATE-N REDEFINES                        CL**2
  5583            WS-CR-LF-CLAIM-EXIT-DATE   PIC 9(11).                    CL**2
  5584     05  WS-CR-AH-CANC-DT.                                        ELCCRTVR
  5585         10  FILLER                    PIC 999.                   ELCCRTVR
  5586         10  CR-AH-CNC-CCYY            PIC 9(04).                 ELCCRTVR
  5587         10  CR-AH-CNC-CCYR  REDEFINES  CR-AH-CNC-CCYY.           ELCCRTVR
  5588             15  CR-AH-CNC-CC          PIC 99.                    ELCCRTVR
  5589             15  CR-AH-CNC-YR          PIC 99.                    ELCCRTVR
  5590         10  CR-AH-CNC-MO              PIC 99.                    ELCCRTVR
  5591         10  CR-AH-CNC-DA              PIC 99.                    ELCCRTVR
  5592     05  WS-CR-AH-CANC-DT-N  REDEFINES                               CL**2
  5593            WS-CR-AH-CANC-DT           PIC 9(11).                    CL**2
  5594     05  WS-CR-AH-CANCEL-EXIT-DATE.                               ELCCRTVR
  5595         10  FILLER                    PIC 999.                   ELCCRTVR
  5596         10  CR-AH-CEX-CCYY            PIC 9(04).                 ELCCRTVR
  5597         10  CR-AH-CEX-CCYR  REDEFINES  CR-AH-CEX-CCYY.           ELCCRTVR
  5598             15  CR-AH-CEX-CC          PIC 99.                    ELCCRTVR
  5599             15  CR-AH-CEX-YR          PIC 99.                    ELCCRTVR
  5600         10  CR-AH-CEX-MO              PIC 99.                    ELCCRTVR
  5601         10  CR-AH-CEX-DA              PIC 99.                    ELCCRTVR
  5602     05  WS-CR-AH-CANCEL-EXIT-DATE-N REDEFINES                       CL**2
  5603            WS-CR-AH-CANCEL-EXIT-DATE  PIC 9(11).                    CL**2
  5604     05  WS-CR-AH-SETTLEMENT-EXIT-DATE.                           ELCCRTVR
  5605         10  FILLER                    PIC 999.                   ELCCRTVR
  5606         10  CR-AH-DEX-CCYY            PIC 9(04).                 ELCCRTVR
  5607         10  CR-AH-DEX-CCYR  REDEFINES  CR-AH-DEX-CCYY.           ELCCRTVR
  5608             15  CR-AH-DEX-CC          PIC 99.                    ELCCRTVR
  5609             15  CR-AH-DEX-YR          PIC 99.                    ELCCRTVR
  5610         10  CR-AH-DEX-MO              PIC 99.                    ELCCRTVR
  5611         10  CR-AH-DEX-DA              PIC 99.                    ELCCRTVR
  5612     05  WS-CR-AH-SETTLEMENT-EXIT-DATEN REDEFINES                    CL**5
  5613          WS-CR-AH-SETTLEMENT-EXIT-DATE   PIC 9(11).                 CL**5
  5614     05  WS-CR-DTH-DT.                                            ELCCRTVR
  5615         10  FILLER                    PIC 999.                   ELCCRTVR
  5616         10  CR-DTH-CCYY               PIC 9(04).                 ELCCRTVR
  5617         10  CR-DTH-CCYR  REDEFINES  CR-DTH-CCYY.                 ELCCRTVR
  5618             15  CR-DTH-CC             PIC 99.                    ELCCRTVR
  5619             15  CR-DTH-YR             PIC 99.                    ELCCRTVR
  5620         10  CR-DTH-MO                 PIC 99.                    ELCCRTVR
  5621         10  CR-DTH-DA                 PIC 99.                    ELCCRTVR
  5622     05  WS-CR-DTH-DT-N REDEFINES                                    CL**2
  5623            WS-CR-DTH-DT               PIC 9(11).                    CL**2
  5624     05  WS-CR-DTH-PAY-DT.                                        ELCCRTVR
  5625         10  FILLER                    PIC 999.                   ELCCRTVR
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 111
* ECS010MO.cbl (/apps/prod/cid1p/copy/ELCCRTVR)
  5626         10  CR-DTH-PAY-CCYY           PIC 9(04).                 ELCCRTVR
  5627         10  CR-DTH-PAY-CCYR  REDEFINES CR-DTH-PAY-CCYY.          ELCCRTVR
  5628             15  CR-DTH-PAY-CC         PIC 99.                    ELCCRTVR
  5629             15  CR-DTH-PAY-YR         PIC 99.                    ELCCRTVR
  5630         10  CR-DTH-PAY-MO             PIC 99.                    ELCCRTVR
  5631         10  CR-DTH-PAY-DA             PIC 99.                    ELCCRTVR
  5632     05  WS-CR-DTH-PAY-DT-N REDEFINES                                CL**2
  5633            WS-CR-DTH-PAY-DT           PIC 9(11).                    CL**2
  5634     05  WS-CR-DIS-DT.                                            ELCCRTVR
  5635         10  FILLER                    PIC 999.                   ELCCRTVR
  5636         10  CR-DIS-CCYY               PIC 9(04).                 ELCCRTVR
  5637         10  CR-DIS-CCYR  REDEFINES  CR-DIS-CCYY.                 ELCCRTVR
  5638             15  CR-DIS-CC             PIC 99.                    ELCCRTVR
  5639             15  CR-DIS-YR             PIC 99.                    ELCCRTVR
  5640         10  CR-DIS-MO                 PIC 99.                    ELCCRTVR
  5641         10  CR-DIS-DA                 PIC 99.                    ELCCRTVR
  5642     05  WS-CR-DIS-DT-N REDEFINES                                    CL**2
  5643            WS-CR-DIS-DT               PIC 9(11).                    CL**2
  5644     05  WS-CR-DIS-PAY-DT.                                        ELCCRTVR
  5645         10  FILLER                    PIC 999.                   ELCCRTVR
  5646         10  CR-DIS-PAY-CCYY           PIC 9(04).                 ELCCRTVR
  5647         10  CR-DIS-PAY-CCYR  REDEFINES  CR-DIS-PAY-CCYY.         ELCCRTVR
  5648             15  CR-DIS-PAY-CC         PIC 99.                    ELCCRTVR
  5649             15  CR-DIS-PAY-YR         PIC 99.                    ELCCRTVR
  5650         10  CR-DIS-PAY-MO             PIC 99.                    ELCCRTVR
  5651         10  CR-DIS-PAY-DA             PIC 99.                    ELCCRTVR
  5652     05  WS-CR-DIS-PAY-DT-N REDEFINES                                CL**2
  5653            WS-CR-DIS-PAY-DT           PIC 9(11).                    CL**2
  5654     05  WS-CR-DIS-PTO-DT.                                        ELCCRTVR
  5655         10  FILLER                    PIC 999.                   ELCCRTVR
  5656         10  CR-DIS-PTO-CCYY           PIC 9(04).                 ELCCRTVR
  5657         10  CR-DIS-PTO-CCYR  REDEFINES  CR-DIS-PTO-CCYY.         ELCCRTVR
  5658             15  CR-DIS-PTO-CC         PIC 99.                    ELCCRTVR
  5659             15  CR-DIS-PTO-YR         PIC 99.                    ELCCRTVR
  5660         10  CR-DIS-PTO-MO             PIC 99.                    ELCCRTVR
  5661         10  CR-DIS-PTO-DA             PIC 99.                    ELCCRTVR
  5662     05  WS-CR-DIS-PTO-DT-N REDEFINES                                CL**2
  5663            WS-CR-DIS-PTO-DT           PIC 9(11).                    CL**2
  5664     05  COPY-NDX                      PIC 9.                        CL**6
  5665     05  WS-DIS-INCUR-DT OCCURS 5 TIMES.                             CL**6
  5666         10  WS-CR-DIS-INCUR-DT.                                  ELCCRTVR
  5667             15  FILLER                PIC 999.                   ELCCRTVR
  5668             15  CR-DIS-INC-CCYY       PIC 9(04).                 ELCCRTVR
  5669             15  CR-DIS-INC-CCYR  REDEFINES  CR-DIS-INC-CCYY.     ELCCRTVR
  5670                 20  CR-DIS-INC-CC     PIC 99.                    ELCCRTVR
  5671                 20  CR-DIS-INC-YR     PIC 99.                    ELCCRTVR
  5672             15  CR-DIS-INC-MO         PIC 99.                    ELCCRTVR
  5673             15  CR-DIS-INC-DA         PIC 99.                    ELCCRTVR
  5674         10  WS-CR-DIS-INCUR-DT-N REDEFINES                          CL**2
  5675                WS-CR-DIS-INCUR-DT     PIC 9(11).                    CL**2
  5676
  5677 01  INITIALIZED-CERTIFICATE     PIC X(1056).
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 112
* ECS010MO.cbl
* 5679                             COPY ELCDATE.
  5680******************************************************************06/11/98
  5681*                                                                *ELCDATE
  5682*                                                                *ELCDATE
  5683*                            ELCDATE.                            *   LV023
  5684*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL*16
  5685*                            VMOD=2.003                           ELCDATE
  5686*                                                                *ELCDATE
  5687*                                                                *ELCDATE
  5688*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *ELCDATE
  5689*                 LENGTH = 200                                   *   CL*19
  5690******************************************************************ELCDATE
  5691                                                                  ELCDATE
  5692 01  DATE-CONVERSION-DATA.                                        ELCDATE
  5693     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.    CL*19
  5694     12  DC-OPTION-CODE                PIC X.                        CL*15
  5695         88  BIN-TO-GREG                VALUE ' '.                ELCDATE
  5696         88  ELAPSED-BETWEEN-BIN        VALUE '1'.                ELCDATE
  5697         88  EDIT-GREG-TO-BIN           VALUE '2'.                ELCDATE
  5698         88  YMD-GREG-TO-BIN            VALUE '3'.                ELCDATE
  5699         88  MDY-GREG-TO-BIN            VALUE '4'.                ELCDATE
  5700         88  JULIAN-TO-BIN              VALUE '5'.                ELCDATE
  5701         88  BIN-PLUS-ELAPSED           VALUE '6'.                ELCDATE
  5702         88  FIND-CENTURY               VALUE '7'.                   CL*22
  5703         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.                ELCDATE
  5704         88  EDIT-GREG-TO-BIN-3         VALUE '9'.                ELCDATE
  5705         88  YMD-GREG-TO-BIN-3          VALUE 'A'.                ELCDATE
  5706         88  MDY-GREG-TO-BIN-3          VALUE 'B'.                ELCDATE
  5707         88  JULIAN-TO-BIN-3            VALUE 'C'.                ELCDATE
  5708         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.                ELCDATE
  5709         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.                   CL*14
  5710         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.                   CL*14
  5711         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.                   CL*14
  5712         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.         CL*14
  5713         88  CHECK-LEAP-YEAR            VALUE 'H'.                   CL*14
  5714         88  BIN-3-TO-GREG              VALUE 'I'.                   CL*14
  5715         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.                   CL*14
  5716         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.                   CL*14
  5717         88  CYMD-GREG-TO-BIN           VALUE 'L'.                   CL*14
  5718         88  MDCY-GREG-TO-BIN           VALUE 'M'.                   CL*14
  5719         88  MDY-GREG-TO-JULIAN         VALUE 'N'.                   CL*14
  5720         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.                   CL*14
  5721         88  YMD-GREG-TO-JULIAN         VALUE 'P'.                   CL*14
  5722         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.                   CL*14
  5723         88  THREE-CHARACTER-BIN                                  ELCDATE
  5724                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.       CL*14
  5725         88  GREGORIAN-TO-BIN                                        CL**2
  5726                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.    CL*14
  5727         88  BIN-TO-GREGORIAN                                        CL**2
  5728                  VALUES ' ' '1' 'I' '8' 'G'.                        CL*14
  5729         88  JULIAN-TO-BINARY                                        CL**2
  5730                  VALUES '5' 'C' 'E' 'F'.                            CL*14
  5731     12  DC-ERROR-CODE                 PIC X.                        CL*15
  5732         88  NO-CONVERSION-ERROR        VALUE ' '.                   CL**3
  5733         88  DATE-CONVERSION-ERROR                                ELCDATE
  5734                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.        CL*14
  5735         88  DATE-IS-ZERO               VALUE '1'.                ELCDATE
  5736         88  DATE-IS-NON-NUMERIC        VALUE '2'.                ELCDATE
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 113
* ECS010MO.cbl (/apps/prod/cid1p/copy/ELCDATE)
  5737         88  DATE-IS-INVALID            VALUE '3'.                ELCDATE
  5738         88  DATE1-GREATER-DATE2        VALUE '4'.                ELCDATE
  5739         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.                ELCDATE
  5740         88  DATE-INVALID-OPTION        VALUE '9'.                ELCDATE
  5741         88  INVALID-CENTURY            VALUE 'A'.                ELCDATE
  5742         88  ONLY-CENTURY               VALUE 'B'.                ELCDATE
  5743         88  ONLY-LEAP-YEAR             VALUE 'C'.                ELCDATE
  5744         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.              CL**3
  5745     12  DC-END-OF-MONTH               PIC X.                        CL*15
  5746         88  CALCULATE-END-OF-MONTH     VALUE '1'.                ELCDATE
  5747     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.         CL*15
  5748         88  USE-NORMAL-PROCESS         VALUE ' '.                ELCDATE
  5749         88  ADJUST-DOWN-100-YRS        VALUE '1'.                ELCDATE
  5750         88  ADJUST-UP-100-YRS          VALUE '2'.                ELCDATE
  5751     12  FILLER                        PIC X.                        CL*15
  5752     12  DC-CONVERSION-DATES.                                        CL*15
  5753         16  DC-BIN-DATE-1             PIC XX.                       CL*15
  5754         16  DC-BIN-DATE-2             PIC XX.                       CL*15
  5755         16  DC-GREG-DATE-1-EDIT       PIC X(08).                    CL*15
  5756         16  DC-GREG-DATE-1-EDIT-R REDEFINES                         CL*15
  5757                       DC-GREG-DATE-1-EDIT.                       ELCDATE
  5758             20  DC-EDIT1-MONTH        PIC 99.                       CL*15
  5759             20  SLASH1-1              PIC X.                        CL*15
  5760             20  DC-EDIT1-DAY          PIC 99.                       CL*15
  5761             20  SLASH1-2              PIC X.                        CL*15
  5762             20  DC-EDIT1-YEAR         PIC 99.                       CL*15
  5763         16  DC-GREG-DATE-2-EDIT       PIC X(08).                    CL*15
  5764         16  DC-GREG-DATE-2-EDIT-R REDEFINES                         CL*15
  5765                     DC-GREG-DATE-2-EDIT.                         ELCDATE
  5766             20  DC-EDIT2-MONTH        PIC 99.                       CL*15
  5767             20  SLASH2-1              PIC X.                        CL*15
  5768             20  DC-EDIT2-DAY          PIC 99.                       CL*15
  5769             20  SLASH2-2              PIC X.                        CL*15
  5770             20  DC-EDIT2-YEAR         PIC 99.                       CL*15
  5771         16  DC-GREG-DATE-1-YMD        PIC 9(06).                    CL*15
  5772         16  DC-GREG-DATE-1-YMD-R  REDEFINES                         CL*15
  5773                     DC-GREG-DATE-1-YMD.                          ELCDATE
  5774             20  DC-YMD-YEAR           PIC 99.                       CL*15
  5775             20  DC-YMD-MONTH          PIC 99.                       CL*15
  5776             20  DC-YMD-DAY            PIC 99.                       CL*15
  5777         16  DC-GREG-DATE-1-MDY        PIC 9(06).                    CL*15
  5778         16  DC-GREG-DATE-1-MDY-R REDEFINES                          CL*15
  5779                      DC-GREG-DATE-1-MDY.                         ELCDATE
  5780             20  DC-MDY-MONTH          PIC 99.                       CL*15
  5781             20  DC-MDY-DAY            PIC 99.                       CL*15
  5782             20  DC-MDY-YEAR           PIC 99.                       CL*15
  5783         16  DC-GREG-DATE-1-ALPHA.                                   CL*15
  5784             20  DC-ALPHA-MONTH        PIC X(10).                    CL*15
  5785             20  DC-ALPHA-DAY          PIC 99.                       CL*15
  5786             20  FILLER                PIC XX.                       CL*15
  5787             20  DC-ALPHA-CENTURY.                                   CL*15
  5788                 24 DC-ALPHA-CEN-N     PIC 99.                       CL*15
  5789             20  DC-ALPHA-YEAR         PIC 99.                       CL*15
  5790         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.           CL*15
  5791         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.           CL*15
  5792         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.           CL*15
  5793         16  DC-JULIAN-DATE            PIC 9(05).                    CL*15
  5794         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE                CL*20
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 114
* ECS010MO.cbl (/apps/prod/cid1p/copy/ELCDATE)
  5795                                       PIC 9(05).                    CL*20
  5796         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.                  CL*15
  5797             20  DC-JULIAN-YEAR        PIC 99.                       CL*15
  5798             20  DC-JULIAN-DAYS        PIC 999.                      CL*15
  5799         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.       CL*15
  5800         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.    CL*15
  5801         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.    CL*15
  5802     12  DATE-CONVERSION-VARIBLES.                                   CL*15
  5803         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.            CL*15
  5804         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.          CL*15
  5805             20  FILLER                PIC 9(3).                     CL*15
  5806             20  HOLD-CEN-1-CCYY.                                    CL*15
  5807                 24  HOLD-CEN-1-CC     PIC 99.                       CL*17
  5808                 24  HOLD-CEN-1-YY     PIC 99.                       CL*17
  5809             20  HOLD-CEN-1-MO         PIC 99.                       CL*17
  5810             20  HOLD-CEN-1-DA         PIC 99.                       CL*17
  5811         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.            CL*15
  5812             20  HOLD-CEN-1-R-MO       PIC 99.                       CL*17
  5813             20  HOLD-CEN-1-R-DA       PIC 99.                       CL*17
  5814             20  HOLD-CEN-1-R-CCYY.                                  CL*15
  5815                 24  HOLD-CEN-1-R-CC   PIC 99.                       CL*17
  5816                 24  HOLD-CEN-1-R-YY   PIC 99.                       CL*17
  5817             20  FILLER                PIC 9(3).                     CL*15
  5818         16  HOLD-CENTURY-1-X.                                       CL*15
  5819             20  FILLER                PIC X(3)  VALUE SPACES.       CL*15
  5820             20  HOLD-CEN-1-X-CCYY.                                  CL*15
  5821                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.          CL*17
  5822                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.          CL*17
  5823             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.          CL*17
  5824             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.          CL*17
  5825         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.          CL*15
  5826             20  HOLD-CEN-1-R-X-MO     PIC XX.                       CL*17
  5827             20  HOLD-CEN-1-R-X-DA     PIC XX.                       CL*17
  5828             20  HOLD-CEN-1-R-X-CCYY.                                CL*15
  5829                 24  HOLD-CEN-1-R-X-CC PIC XX.                       CL*17
  5830                 24  HOLD-CEN-1-R-X-YY PIC XX.                       CL*17
  5831             20  FILLER                PIC XXX.                      CL*23
  5832         16  DC-BIN-DATE-EXPAND-1      PIC XXX.                      CL*15
  5833         16  DC-BIN-DATE-EXPAND-2      PIC XXX.                      CL*15
  5834         16  DC-JULIAN-DATE-1          PIC 9(07).                    CL*15
  5835         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.          CL*15
  5836             20  DC-JULIAN-1-CCYY.                                   CL*15
  5837                 24  DC-JULIAN-1-CC    PIC 99.                       CL*15
  5838                 24  DC-JULIAN-1-YR    PIC 99.                       CL*15
  5839             20  DC-JULIAN-DA-1        PIC 999.                      CL*15
  5840         16  DC-JULIAN-DATE-2          PIC 9(07).                    CL*15
  5841         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.          CL*15
  5842             20  DC-JULIAN-2-CCYY.                                   CL*15
  5843                 24  DC-JULIAN-2-CC    PIC 99.                       CL*15
  5844                 24  DC-JULIAN-2-YR    PIC 99.                       CL*15
  5845             20  DC-JULIAN-DA-2        PIC 999.                      CL*15
  5846         16  DC-GREG-DATE-A-EDIT.                                    CL*15
  5847             20  DC-EDITA-MONTH        PIC 99.                       CL*15
  5848             20  SLASHA-1              PIC X VALUE '/'.              CL*15
  5849             20  DC-EDITA-DAY          PIC 99.                       CL*15
  5850             20  SLASHA-2              PIC X VALUE '/'.              CL*15
  5851             20  DC-EDITA-CCYY.                                      CL*15
  5852                 24  DC-EDITA-CENT     PIC 99.                       CL*15
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 115
* ECS010MO.cbl (/apps/prod/cid1p/copy/ELCDATE)
  5853                 24  DC-EDITA-YEAR     PIC 99.                       CL*15
  5854         16  DC-GREG-DATE-B-EDIT.                                    CL*15
  5855             20  DC-EDITB-MONTH        PIC 99.                       CL*15
  5856             20  SLASHB-1              PIC X VALUE '/'.              CL*15
  5857             20  DC-EDITB-DAY          PIC 99.                       CL*15
  5858             20  SLASHB-2              PIC X VALUE '/'.              CL*15
  5859             20  DC-EDITB-CCYY.                                      CL*15
  5860                 24  DC-EDITB-CENT     PIC 99.                       CL*15
  5861                 24  DC-EDITB-YEAR     PIC 99.                       CL*15
  5862         16  DC-GREG-DATE-CYMD         PIC 9(08).                    CL*15
  5863         16  DC-GREG-DATE-CYMD-R REDEFINES                           CL*15
  5864                              DC-GREG-DATE-CYMD.                  ELCDATE
  5865             20  DC-CYMD-CEN           PIC 99.                       CL*15
  5866             20  DC-CYMD-YEAR          PIC 99.                       CL*15
  5867             20  DC-CYMD-MONTH         PIC 99.                       CL*15
  5868             20  DC-CYMD-DAY           PIC 99.                       CL*15
  5869         16  DC-GREG-DATE-MDCY         PIC 9(08).                    CL*15
  5870         16  DC-GREG-DATE-MDCY-R REDEFINES                           CL*15
  5871                              DC-GREG-DATE-MDCY.                  ELCDATE
  5872             20  DC-MDCY-MONTH         PIC 99.                       CL*15
  5873             20  DC-MDCY-DAY           PIC 99.                       CL*15
  5874             20  DC-MDCY-CEN           PIC 99.                       CL*15
  5875             20  DC-MDCY-YEAR          PIC 99.                       CL*15
  5876    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.      ELCDATE
  5877        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.        ELCDATE
  5878    12  DC-EL310-DATE                  PIC X(21).                    CL*26
  5879    12  FILLER                         PIC X(28).                    CL*26
* 5880                             COPY ELCFUNDT.
  5881***************************************************************** 12/03/98
  5882*                                                               * ELCFUNDT
  5883*                            ELCFUNDT.                          *    LV004
  5884*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE *             CL**4
  5885*                            VMOD=2.001                         * ELCFUNDT
  5886*                                                               * ELCFUNDT
  5887*           COPYBOOK FOR THE FUNCTION DATE FORMAT               * ELCFUNDT
  5888*                                                               * ELCFUNDT
  5889***************************************************************** ELCFUNDT
  5890                                                                  ELCFUNDT
  5891                                                                  ELCFUNDT
  5892 01  FUNCTION-DATE.                                                  CL**2
  5893     05  WS-FN-DATE                PIC 9(8)    VALUE ZEROS.          CL**3
  5894     05  WS-FN-CYMD  REDEFINES  WS-FN-DATE.                          CL**3
  5895         10  WS-FN-CCYR            PIC 9(4).                         CL**3
  5896         10  WS-FN-CCYY  REDEFINES  WS-FN-CCYR.                      CL**3
  5897             15  WS-FN-CC          PIC 99.                           CL**3
  5898             15  WS-FN-YR          PIC 99.                           CL**3
  5899         10  WS-FN-MO              PIC 99.                           CL**3
  5900         10  WS-FN-DA              PIC 99.                           CL**3
  5901     05  WS-FN-HOURS               PIC 99      VALUE ZEROS.          CL**3
  5902     05  WS-FN-MINUTES             PIC 99      VALUE ZEROS.          CL**3
  5903     05  WS-FN-SECONDS             PIC 99      VALUE ZEROS.          CL**3
  5904     05  WS-FN-HUNDSECS            PIC 99      VALUE ZEROS.          CL**3
  5905     05  WS-FN-GMT-IND             PIC X       VALUE SPACES.         CL**2
  5906         88  WS-BEHIND-GMT                     VALUE '-'.            CL**2
  5907         88  WS-AFTER-GMT                      VALUE '+'.            CL**2
  5908         88  WS-NO-GMT                         VALUE ZERO.           CL**2
  5909     05  WS-FN-GMT-HOURS           PIC 99      VALUE ZEROS.          CL**2
  5910     05  WS-FN-GMT-MINUTES         PIC 99      VALUE ZEROS.          CL**2
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 116
* ECS010MO.cbl
  5911
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 117
* ECS010MO.cbl
  5913 01  CPA-STARTS-HERE             PIC X(48)
  5914       VALUE '***** CALCULATION PASS AREA STARTS HERE ********'.
* 5915                             COPY ELCCALC.
  5916******************************************************************04/15/98
  5917*                                                                *ELCCALC
  5918*                           ELCCALC.                            *    LV003
  5919*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
  5920*                            VMOD=2.025                          *   CL**3
  5921*                                                                *   CL**2
  5922*   DESCRIPTION:  DATA TO BE PASSED TO REMAINING TERM ROUTINE    *   CL**2
  5923*                 REMAINING AMOUNT ROUTINE, LOSS RESERVE ROUTINE *   CL**2
  5924*                 REFUND CALCULATIONS ROUTINE, EARNINGS CALCU -  *   CL**2
  5925*                 LATIONS ROUTINE, AND THE RATING ROUTINE.       *   CL**2
  5926*                                                                *   CL**2
  5927*  PASSED TO ELRTRM                                              *   CL**2
  5928*  -----------------                                             *   CL**2
  5929*  METHOD CODE (I.E. FULL MONTH, HALF ADJ, ETC)                  *   CL**2
  5930*  ORIGINAL TERM                                                 *   CL**2
  5931*  BEGINNING DATE                                                *   CL**2
  5932*  ENDING DATE                                                   *   CL**2
  5933*  COMPANY I.D.                                                  *   CL**2
  5934*  ACCOUNT MASTER USER FIELD                                     *   CL**2
  5935*  PROCESS SWITCH (CANCEL, CLAIM)                                *   CL**2
  5936*  FREE LOOK DAYS                                                *   CL**2
  5937*                                                                *   CL**2
  5938*  RETURNED FROM ELRTRM                                          *   CL**2
  5939*  ---------------------                                         *   CL**2
  5940*  REMAINING TERM 1 - USED FOR EARNINGS                          *   CL**2
  5941*  REMAINING TERM 2 - USED FOR BENEFIT CALCULATIONS              *   CL**2
  5942*  REMAINING TERM 3 - USED FOR CLAIM BENEFITS                    *   CL**2
  5943*  ODD DAYS - REMAINING DAYS PAST FULL MONTHS                    *   CL**2
  5944*----------------------------------------------------------------*   CL**2
  5945*  PASSED TO ELRAMT                                              *   CL**2
  5946*  ----------------                                              *   CL**2
  5947*  REMAINING TERM 1 OR 2 OR 3 (FROM ELRTRM)                      *   CL**2
  5948*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *   CL**2
  5949*  ORIGINAL AMOUNT                                               *   CL**2
  5950*  ALTERNATE BENEFIT (BALLON)                                    *   CL**2
  5951*  A.P.R. - NET PAY ONLY                                         *   CL**2
  5952*  METHOD                                                            CL**2
  5953*  PAYMENT FREQUENCY - FOR FARM PLAN                             *   CL**2
  5954*  COMPANY I.D.                                                  *   CL**2
  5955*  BENEFIT TYPE                                                  *   CL**2
  5956*                                                                *   CL**2
  5957*  RETURNED FROM ELRAMT                                          *   CL**2
  5958*  --------------------                                          *   CL**2
  5959*  REMAINING AMOUNT 1 - CURRENT                                  *   CL**2
  5960*  REMAINING AMOUNT 2 - PREVIOUS MONTH                           *   CL**2
  5961*  REMAINING AMOUNT FACTOR                                           CL**2
  5962*----------------------------------------------------------------*   CL**2
  5963*  PASSED TO ELRESV                                              *   CL**2
  5964*  -----------------                                             *   CL**2
  5965*  CERTIFICATE EFFECTIVE DATE                                    *   CL**2
  5966*  VALUATION DATE                                                *   CL**2
  5967*  PAID THRU DATE                                                *   CL**2
  5968*  BENEFIT                                                       *   CL**2
  5969*  INCURRED DATE                                                 *   CL**2
  5970*  REPORTED DATE                                                 *   CL**2
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 118
* ECS010MO.cbl (/apps/prod/cid1p/copy/ELCCALC)
  5971*  ISSUE AGE                                                     *   CL**2
  5972*  TERM                                                          *   CL**2
  5973*  CDT PERCENT                                                   *   CL**2
  5974*  CDT METHOD (I.E. INTERPOLATED, AVERAGE, ETC)                  *   CL**2
  5975* *CLAIM TYPE (LIFE, A/H)                                        *   CL**2
  5976* *REMAINING BENEFIT (FROM ELRAMT)                               *   CL**2
  5977* *ONLY FIELDS REQUIRED FOR LIFE CLAIMS                          *   CL**2
  5978*                                                                *   CL**2
  5979*  RETURNED FROM ELRESV                                          *   CL**2
  5980*  --------------------                                          *   CL**2
  5981*  CDT TABLE USED                                                *   CL**2
  5982*  CDT FACTOR USED                                               *   CL**2
  5983*  PAY TO CURRENT RESERVE                                        *   CL**2
  5984*  I.B.N.R. - A/H ONLY                                           *   CL**2
  5985*  FUTURE (ACCRUED) AH ONLY                                      *   CL**2
  5986*----------------------------------------------------------------*   CL**2
  5987*  PASSED TO ELRATE                                              *   CL**2
  5988*  ----------------                                              *   CL**2
  5989*  CERT ISSUE DATE                                               *   CL**2
  5990*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *   CL**2
  5991*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *   CL**2
  5992*  CAPPED TERM   (ONLY FOR TRUNCATED LIFE)                       *   CL**2
  5993*  STATE CODE (CLIENT DEFINED)                                   *   CL**2
  5994*  STATE CODE (STANDARD P.O. ABBRV)                              *   CL**2
  5995*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *   CL**2
  5996*  DEVIATION CODE                                                *   CL**2
  5997*  ISSUE AGE                                                     *   CL**2
  5998*  ORIGINAL BENEFIT AMOUNT                                       *   CL**2
  5999*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *   CL**2
  6000*  PROCESS TYPE (ISSUE OR CANCEL)                                *   CL**2
  6001*  BENEFIT KIND (LIFE OR A/H)                                    *   CL**2
  6002*  A.P.R.                                                        *   CL**2
  6003*  METHOD                                                            CL**2
  6004*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *   CL**2
  6005*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *   CL**2
  6006*  COMPANY I.D. (3 CHARACTER)                                    *   CL**2
  6007*  BENEFIT CODE                                                  *   CL**2
  6008*  BENEFIT OVERRIDE CODE                                         *   CL**2
  6009*  MAXIMUM MONTHLY BENEFIT (FROM ACCT MASTER - CSL ONLY)         *   CL**2
  6010*  MAXIMUM TOTAL BENEFIT (FROM ACCT MASTER - CSL ONLY)           *   CL**2
  6011*  JOINT INDICATOR (CSL ONLY)                                    *   CL**2
  6012*  FIRST PAYMENT DATE (CSL ONLY)                                 *   CL**2
  6013*  PERIODIC PAYMENT AMOUNT (IN CP-REMAINING-TERM - CSL ONLY)     *   CL**2
  6014*                                                                *   CL**2
  6015*  RETURNED FROM ELRATE                                          *   CL**2
  6016*  --------------------                                          *   CL**2
  6017*  CALCULATED PREMIUM                                            *   CL**2
  6018*  PREMIUM RATE                                                  *   CL**2
  6019*  MORTALITY CODE                                                *   CL**2
  6020*  MAX ATTAINED AGE                                              *   CL**2
  6021*  MAX AGE                                                       *   CL**2
  6022*  MAX TERM                                                      *   CL**2
  6023*  MAX MONTHLY BENEFIT                                           *   CL**2
  6024*  MAX TOTAL BENIFIT                                             *   CL**2
  6025*  COMPOSITE RATE (OPEN-END ONLY)                                *   CL**2
  6026*----------------------------------------------------------------*   CL**2
  6027*  PASSED TO ELRFND                                              *   CL**2
  6028*  ----------------                                              *   CL**2
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 119
* ECS010MO.cbl (/apps/prod/cid1p/copy/ELCCALC)
  6029*  CERT ISSUE DATE                                               *   CL**2
  6030*  REFUND DATE                                                   *   CL**2
  6031*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *   CL**2
  6032*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *   CL**2
  6033*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *   CL**2
  6034*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *   CL**2
  6035*  STATE CODE (CLIENT DEFINED)                                   *   CL**2
  6036*  STATE CODE (STANDARD P.O. ABBRV)                              *   CL**2
  6037*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *   CL**2
  6038*  DEVIATION CODE                                                *   CL**2
  6039*  ISSUE AGE                                                     *   CL**2
  6040*  ORIGINAL BENEFIT AMOUNT                                       *   CL**2
  6041*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *   CL**2
  6042*  PROCESS TYPE (CANCEL)                                         *   CL**2
  6043*  BENEFIT KIND (LIFE OR A/H)                                    *   CL**2
  6044*  A.P.R.                                                        *   CL**2
  6045*  EARNING METHOD - (CODE FROM BENEFIT, STATE OR ACCOUNT RECORD) *   CL**2
  6046*  RATING METHOD -  (CODE FROM BENEFIT)                          *   CL**2
  6047*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *   CL**2
  6048*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *   CL**2
  6049*  COMPANY I.D. (3 CHARACTER)                                    *   CL**2
  6050*  BENEFIT CODE                                                  *   CL**2
  6051*  BENEFIT OVERRIDE CODE                                         *   CL**2
  6052*                                                                *   CL**2
  6053*  RETURNED FROM ELRFND                                          *   CL**2
  6054*  --------------------                                          *   CL**2
  6055*  CALCULATED REFUND                                             *   CL**2
  6056*----------------------------------------------------------------*   CL**2
  6057*  PASSED TO ELEARN                                              *   CL**2
  6058*  ----------------                                              *   CL**2
  6059*  CERT ISSUE DATE                                               *   CL**2
  6060*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *   CL**2
  6061*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *   CL**2
  6062*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *   CL**2
  6063*  STATE CODE (CLIENT DEFINED)                                   *   CL**2
  6064*  STATE CODE (STANDARD P.O. ABBRV)                              *   CL**2
  6065*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *   CL**2
  6066*  DEVIATION CODE                                                *   CL**2
  6067*  ISSUE AGE                                                     *   CL**2
  6068*  ORIGINAL BENEFIT AMOUNT                                       *   CL**2
  6069*  BENEFIT KIND (LIFE OR A/H)                                    *   CL**2
  6070*  A.P.R.                                                        *   CL**2
  6071*  METHOD - (EARNING CODE FROM BENEFIT RECORD)                   *   CL**2
  6072*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *   CL**2
  6073*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *   CL**2
  6074*  COMPANY I.D. (3 CHARACTER)                                    *   CL**2
  6075*  BENEFIT CODE                                                  *   CL**2
  6076*  BENEFIT OVERRIDE CODE                                         *   CL**2
  6077*                                                                *   CL**2
  6078*  RETURNED FROM ELEARN                                          *   CL**2
  6079*  --------------------                                          *   CL**2
  6080*  INDICATED  EARNINGS                                           *   CL**2
  6081*----------------------------------------------------------------*   CL**2
  6082*                 LENGTH = 450                                   *   CL**2
  6083*                                                                *   CL**2
  6084******************************************************************   CL**2
  6085******************************************************************
  6086*                   C H A N G E   L O G
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 120
* ECS010MO.cbl (/apps/prod/cid1p/copy/ELCCALC)
  6087*
  6088* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6089*-----------------------------------------------------------------
  6090*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6091* EFFECTIVE    NUMBER
  6092*-----------------------------------------------------------------
  6093* 010303    2001061800003  PEMA  ADD DCC/MONTHLY PROCESSING
  6094* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  6095* 101807    2007100100007  PEMA  EXPAND CLM RESERVE FIELDS
  6096* 010410    2008021200005  PEMA  ADD FIELDS FOR MN NET PAY BALLOON
  6097* 010410    2009050700003  PEMA  ADD FIELDS FOR SPP-DD
  6098* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  6099* 041710    2007111300001  AJRA  ADD CLAIM CALC SW FOR SC NP+6
  6100* 101110  CR2010012700001  PEMA ADD DDF REFUND/UEP PROCESSING
  6101* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  6102* 040615  CR2013072200002  PEMA  ADD EXTRA PERIODS
  6103******************************************************************
  6104                                                                     CL**2
  6105 01  CALCULATION-PASS-AREA.                                          CL**2
  6106     12  CP-COMM-LENGTH            PIC S9(4)         VALUE +450      CL**2
  6107                                     COMP.                           CL**2
  6108                                                                     CL**2
  6109     12  CP-RETURN-CODE            PIC X             VALUE ZERO.     CL**2
  6110       88  NO-CP-ERROR                             VALUE ZERO.       CL**2
  6111       88  CP-ERROR-OCCURED VALUE '1' '2' '3' '4' '5' '6' '7' '8'    CL**2
  6112                                  '9' 'A' 'B' 'C' 'D' 'E' 'H'.       CL**2
  6113       88  CP-ERROR-IN-AMOUNTS                     VALUE '1'.        CL**2
  6114       88  CP-ERROR-IN-DATES                       VALUE '2'.        CL**2
  6115       88  CP-ERROR-IN-OPTIONS                     VALUE '3'.        CL**2
  6116       88  CP-ERROR-IN-TERMS                       VALUE '4'.        CL**2
  6117       88  CP-ERROR-IN-FREQUENCY                   VALUE '5'.        CL**2
  6118       88  CP-ERROR-RATE-NOT-FOUND                 VALUE '6'.        CL**2
  6119       88  CP-ERROR-RATE-IS-ZERO                   VALUE '7'.        CL**2
  6120       88  CP-ERROR-AMT-OUTSIDE-LIMIT              VALUE '8'.        CL**2
  6121       88  CP-ERROR-TERM-OUTSIDE-LIMIT             VALUE '9'.        CL**2
  6122       88  CP-ERROR-AGE-OUTSIDE-LIMIT              VALUE 'A'.        CL**2
  6123       88  CP-ERROR-ATT-OUTSIDE-LIMIT              VALUE 'B'.        CL**2
  6124       88  CP-ERROR-TOT-OUTSIDE-LIMIT              VALUE 'C'.        CL**2
  6125       88  CP-ERROR-RATE-FILE-NOTOPEN              VALUE 'D'.        CL**2
  6126       88  CP-ERROR-ISSUE-AGE-ZERO                 VALUE 'E'.        CL**2
  6127       88  CP-ERROR-NO-LIMITS-CRI                  VALUE 'F'.        CL**2
  6128       88  CP-ERROR-DIV-BY-ZERO                    VALUE 'G'.        CL**2
  6129       88  CP-ERROR-LOAN-TERM                      VALUE 'H'.        CL**2
  6130                                                                     CL**2
  6131     12  CP-RETURN-CODE-2          PIC X             VALUE ZERO.     CL**2
  6132       88  NO-CP-ERROR-2                           VALUE ZERO.       CL**2
  6133***********************  INPUT AREAS ****************************    CL**2
  6134                                                                     CL**2
  6135     12  CP-CALCULATION-AREA.                                        CL**2
  6136         16  CP-ACCOUNT-NUMBER     PIC X(10)       VALUE SPACES.     CL**2
  6137         16  CP-CERT-EFF-DT        PIC XX.                           CL**2
  6138         16  CP-VALUATION-DT       PIC XX.                           CL**2
  6139         16  CP-PAID-THRU-DT       PIC XX.                           CL**2
  6140         16  CP-BENEFIT-TYPE       PIC X.                            CL**2
  6141           88  CP-AH                               VALUE 'A' 'D'     CL**2
  6142                                                   'I' 'U'.          CL**2
  6143           88  CP-REDUCING-LIFE                    VALUE 'R'.        CL**2
  6144           88  CP-LEVEL-LIFE                       VALUE 'L' 'P'.    CL**2
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 121
* ECS010MO.cbl (/apps/prod/cid1p/copy/ELCCALC)
  6145         16  CP-INCURRED-DT        PIC XX.                           CL**2
  6146         16  CP-REPORTED-DT        PIC XX.                           CL**2
  6147         16  CP-ACCT-FLD-5         PIC XX            VALUE SPACE.    CL**2
  6148         16  CP-COMPANY-ID         PIC XXX           VALUE SPACE.    CL**2
  6149         16  CP-ISSUE-AGE          PIC S9(3)         VALUE ZERO      CL**2
  6150                                     COMP-3.                         CL**2
  6151         16  CP-CDT-PERCENT        PIC S9(3)V99      VALUE ZERO      CL**2
  6152                                     COMP-3.                         CL**2
  6153         16  CP-CDT-METHOD         PIC X.                            CL**2
  6154           88  CP-CDT-ROUND-NEAR                   VALUE '1'.        CL**2
  6155           88  CP-CDT-ROUND-HIGH                   VALUE '2'.        CL**2
  6156           88  CP-CDT-INTERPOLATED                 VALUE '3'.        CL**2
  6157         16  CP-CLAIM-TYPE         PIC X.                            CL**2
  6158           88  CP-AH-CLAIM                         VALUE 'A'.        CL**2
  6159           88  CP-LIFE-CLAIM                       VALUE 'L'.        CL**2
  6160         16  CP-ORIGINAL-TERM      PIC S9(3)         VALUE ZERO      CL**2
  6161                                     COMP-3.                         CL**2
  6162         16  CP-ORIGINAL-BENEFIT   PIC S9(9)V99      VALUE ZERO      CL**2
  6163                                     COMP-3.                         CL**2
  6164         16  CP-ORIGINAL-PREMIUM   PIC S9(7)V99      VALUE ZERO      CL**2
  6165                                     COMP-3.                         CL**2
  6166         16  CP-REMAINING-TERM     PIC S9(3)V99      VALUE ZERO      CL**2
  6167                                     COMP-3.                         CL**2
  6168         16  CP-REMAINING-BENEFIT  PIC S9(9)V99      VALUE ZERO      CL**2
  6169                                     COMP-3.                         CL**2
  6170         16  CP-LOAN-APR           PIC S9(3)V9(4)    VALUE ZERO      CL**2
  6171                                     COMP-3.                         CL**2
  6172         16  CP-PAY-FREQUENCY      PIC S9(3)         VALUE ZERO      CL**2
  6173                                     COMP-3.                         CL**2
  6174         16  CP-REM-TERM-METHOD    PIC X.                            CL**2
  6175           88  CP-EARN-AFTER-15TH                  VALUE '1'.        CL**2
  6176           88  CP-EARN-ON-HALF-MONTH               VALUE '2'.        CL**2
  6177           88  CP-EARN-ON-1ST-DAY                  VALUE '3'.        CL**2
  6178           88  CP-EARN-ON-FULL-MONTH               VALUE '4'.        CL**2
  6179           88  CP-EARN-WITH-NO-DAYS                VALUE '5'.        CL**2
  6180           88  CP-EARN-AFTER-14TH                  VALUE '6'.        CL**2
  6181           88  CP-EARN-AFTER-16TH                  VALUE '7'.        CL**2
  6182         16  CP-EARNING-METHOD     PIC X.                            CL**2
  6183           88  CP-EARN-BY-R78                      VALUE '1' 'R'.    CL**2
  6184           88  CP-EARN-BY-PRORATA                  VALUE '2' 'P'.    CL**2
  6185           88  CP-EARN-AS-CALIF                    VALUE '3' 'C'.    CL**2
  6186           88  CP-EARN-AS-TEXAS                    VALUE '4' 'T'.    CL**2
  6187           88  CP-EARN-AS-FARM-PLAN                VALUE '4' 'T'.    CL**2
  6188           88  CP-EARN-AS-NET-PAY                  VALUE '5' 'N'.    CL**2
  6189           88  CP-EARN-ANTICIPATION                VALUE '6' 'A'.    CL**2
  6190           88  CP-EARN-AS-MEAN                     VALUE '8' 'M'.    CL**2
  6191           88  CP-EARN-AS-SUM-OF-DIGITS            VALUE '9'.        CL**2
  6192           88  CP-EARN-AS-REG-BALLOON              VALUE 'B'.        CL**2
  6193           88  CP-GAP-NON-REFUNDABLE               VALUE 'G'.
  6194           88  CP-GAP-ACTUARIAL                    VALUE 'S'.
  6195           88  CP-DCC-SPP-DDF                      VALUE 'D' 'I'.
  6196           88  CP-DCC-SPP-DDF-IU                   VALUE 'I'.
  6197         16  CP-PROCESS-TYPE       PIC X.                            CL**2
  6198           88  CP-CLAIM                            VALUE '1'.        CL**2
  6199           88  CP-CANCEL                           VALUE '2'.        CL**2
  6200           88  CP-ISSUE                            VALUE '3'.        CL**2
  6201         16  CP-SPECIAL-CALC-CD    PIC X.                            CL**2
  6202           88  CP-OUTSTANDING-BAL              VALUE 'O'.            CL**2
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 122
* ECS010MO.cbl (/apps/prod/cid1p/copy/ELCCALC)
  6203           88  CP-1-MTH-INTEREST               VALUE ' '.            CL**2
  6204           88  CP-0-MTH-INTEREST               VALUE 'A'.            CL**2
  6205           88  CP-OB-OFFLINE-RESERVED          VALUE 'B'.            CL**2
  6206           88  CP-CRITICAL-PERIOD              VALUE 'C'.            CL**2
  6207           88  CP-TERM-IS-DAYS                 VALUE 'D'.            CL**2
  6208           88  CP-USE-PREM-AS-ENTERED          VALUE 'E'.            CL**2
  6209           88  CP-FARM-PLAN                    VALUE 'F'.            CL**2
  6210           88  CP-RATE-AS-STANDARD             VALUE 'G'.            CL**2
  6211           88  CP-2-MTH-INTEREST               VALUE 'I'.            CL**2
  6212           88  CP-3-MTH-INTEREST               VALUE 'J'.            CL**2
  6213           88  CP-4-MTH-INTEREST               VALUE 'K'.            CL**2
  6214           88  CP-BALLOON-LAST-PMT             VALUE 'L'.            CL**2
  6215           88  CP-MORTGAGE-REC                 VALUE 'M'.            CL**2
  6216           88  CP-OUTSTANDING-BALANCE          VALUE 'O'.            CL**2
  6217           88  CP-NET-PAY-PRUDENTIAL           VALUE 'P'.            CL**2
  6218           88  CP-NET-PAY-SIMPLE               VALUE 'S'.            CL**2
  6219           88  CP-TRUNCATED-LIFE               VALUE 'T' 'U' 'V'     CL**2
  6220                                                     'W' 'X'.        CL**2
  6221           88  CP-TRUNCATE-0-MTH               VALUE 'T'.            CL**2
  6222           88  CP-TRUNCATE-1-MTH               VALUE 'U'.            CL**2
  6223           88  CP-TRUNCATE-2-MTH               VALUE 'V'.            CL**2
  6224           88  CP-TRUNCATE-3-MTH               VALUE 'W'.            CL**2
  6225           88  CP-TRUNCATE-4-MTH               VALUE 'X'.            CL**2
  6226           88  CP-SUMMARY-REC                  VALUE 'Z'.            CL**2
  6227           88  CP-PROPERTY-BENEFIT             VALUE '2'.            CL**2
  6228           88  CP-UNEMPLOYMENT-BENEFIT         VALUE '3'.            CL**2
  6229           88  CP-AD-D-BENEFIT                 VALUE '4'.            CL**2
  6230           88  CP-CSL-METH-1                   VALUE '5'.            CL**2
  6231           88  CP-CSL-METH-2                   VALUE '6'.            CL**2
  6232           88  CP-CSL-METH-3                   VALUE '7'.            CL**2
  6233           88  CP-CSL-METH-4                   VALUE '8'.            CL**2
  6234                                                                     CL**2
  6235         16  CP-LOAN-TERM          PIC S9(3)       VALUE ZERO        CL**2
  6236                                     COMP-3.                         CL**2
  6237         16  CP-CLASS-CODE         PIC XX          VALUE ZERO.       CL**2
  6238         16  CP-DEVIATION-CODE     PIC XXX         VALUE ZERO.       CL**2
  6239         16  CP-STATE              PIC XX          VALUE SPACE.      CL**2
  6240         16  CP-STATE-STD-ABBRV    PIC XX          VALUE SPACE.      CL**2
  6241         16  CP-BENEFIT-CD         PIC XX          VALUE ZERO.       CL**2
  6242           88  CP-CSL-VALID-NP-BENEFIT-CD VALUES '12' '13'           CL**2
  6243               '34' '35' '36' '37' '44' '45' '46' '47' '72' '73'.    CL**2
  6244         16  CP-R78-OPTION         PIC X.                            CL**2
  6245           88  CP-TERM-TIMES-TERM-PLUS-1           VALUE ' '.        CL**2
  6246           88  CP-TERM-TIMES-TERM                  VALUE '1'.        CL**2
  6247                                                                     CL**2
  6248         16  CP-COMPANY-CD         PIC X             VALUE SPACE.    CL**2
  6249         16  CP-IBNR-RESERVE-SW    PIC X.                            CL**2
  6250         16  CP-CLAIM-STATUS       PIC X.                            CL**2
  6251         16  CP-RATE-FILE          PIC X.                            CL**2
  6252         16  CP-TERM-OR-EXT-DAYS   PIC S9(05)        VALUE ZERO      CL**2
  6253                                     COMP-3.                         CL**2
  6254                                                                     CL**2
  6255         16  CP-LIFE-OVERRIDE-CODE PIC X.                            CL**2
  6256         16  CP-AH-OVERRIDE-CODE   PIC X.                            CL**2
  6257                                                                     CL**2
  6258         16  CP-RATE-DEV-PCT       PIC S9V9(6)       VALUE ZERO      CL**2
  6259                                     COMP-3.
  6260         16  CP-CLP-RATE-UP        REDEFINES CP-RATE-DEV-PCT
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 123
* ECS010MO.cbl (/apps/prod/cid1p/copy/ELCCALC)
  6261                                   PIC S9(5)V99 COMP-3.
  6262         16  CP-CRITICAL-MONTHS    PIC S9(3)         VALUE ZERO      CL**2
  6263                                     COMP-3.                         CL**2
  6264         16  CP-ALTERNATE-BENEFIT  PIC S9(9)V99      VALUE ZERO      CL**2
  6265                                     COMP-3.                         CL**2
  6266         16  CP-ALTERNATE-PREMIUM  PIC S9(7)V99      VALUE ZERO      CL**2
  6267                                     COMP-3.
  6268         16  CP-DDF-CSO-ADMIN-FEE REDEFINES CP-ALTERNATE-PREMIUM
  6269                                  PIC S9(7)V99 COMP-3.
  6270                                                                     CL**2
  6271         16  CP-PAID-FROM-DATE     PIC X(02).                        CL**2
  6272         16  CP-CLAIM-CALC-METHOD  PIC X(01).                        CL**2
  6273         16  CP-EXT-DAYS-CALC      PIC X.                            CL**2
  6274           88  CP-EXT-NO-CHG                   VALUE ' '.            CL**2
  6275           88  CP-EXT-CHG-LF                   VALUE '1'.            CL**2
  6276           88  CP-EXT-CHG-AH                   VALUE '2'.            CL**2
  6277           88  CP-EXT-CHG-LF-AH                VALUE '3'.            CL**2
  6278         16  CP-DOMICILE-STATE     PIC XX.                           CL**2
  6279         16  CP-CARRIER            PIC X.                            CL**2
  6280         16  CP-REIN-FLAG          PIC X.                            CL**2
  6281         16  CP-REM-TRM-CALC-OPTION PIC X.                           CL**2
  6282           88  VALID-REM-TRM-CALC-OPTION    VALUE '1'                CL**2
  6283                      '2' '3' '4' '5'.                               CL**2
  6284           88  CP-CALC-OPTION-DEFAULT       VALUE '4'.               CL**2
  6285           88  CP-CONSIDER-EXTENSION        VALUE '3' '4' '5'.       CL**2
  6286           88  CP-30-DAY-MONTH              VALUE '1' '3' '5'.       CL**2
  6287           88  CP-NO-EXT-30-DAY-MONTH       VALUE '1'.               CL**2
  6288           88  CP-NO-EXT-ACTUAL-DAYS        VALUE '2'.               CL**2
  6289           88  CP-EXT-30-DAY-MONTH          VALUE '3'.               CL**2
  6290           88  CP-EXT-ACTUAL-DAYS           VALUE '4'.               CL**2
  6291           88  CP-USE-EXP-AND-1ST-PMT       VALUE '5'.
  6292         16  CP-SIG-SWITCH         PIC X.                            CL**2
  6293         16  CP-RATING-METHOD      PIC X.                            CL**2
  6294           88  CP-RATE-AS-R78                      VALUE '1' 'R'.    CL**2
  6295           88  CP-RATE-AS-PRORATA                  VALUE '2' 'P'.    CL**2
  6296           88  CP-RATE-AS-CALIF                    VALUE '3' 'C'.    CL**2
  6297           88  CP-RATE-AS-TEXAS                    VALUE '4' 'T'.    CL**2
  6298           88  CP-RATE-AS-FARM-PLAN                VALUE '4' 'T'.    CL**2
  6299           88  CP-RATE-AS-NET-PAY                  VALUE '5' 'N'.    CL**2
  6300           88  CP-RATE-AS-ANTICIPATION             VALUE '6' 'A'.    CL**2
  6301           88  CP-RATE-AS-MEAN                     VALUE '8' 'M'.    CL**2
  6302           88  CP-RATE-AS-REG-BALLOON              VALUE 'B'.        CL**2
  6303         16  CP-SALES-TAX          PIC S9V9999     VALUE  ZEROS      CL**2
  6304                                     COMP-3.                         CL**2
  6305         16  CP-BEN-CATEGORY       PIC X.
  6306         16  CP-DCC-LF-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  6307         16  CP-DCC-ACT-COMM REDEFINES CP-DCC-LF-RATE
  6308                                   PIC S99V9(5) COMP-3.
  6309         16  CP-DCC-AH-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  6310         16  CP-DCC-PMF-COMM REDEFINES CP-DCC-AH-RATE
  6311                                   PIC S99V9(5) COMP-3.
  6312         16  CP-DAYS-TO-1ST-PMT    PIC S999     COMP-3 VALUE +0.
  6313         16  CP-AH-BALLOON-SW      PIC X  VALUE ' '.
  6314         16  CP-EXPIRE-DT          PIC XX.
  6315         16  CP-LF-CLAIM-CALC-SW   PIC X  VALUE ' '.
  6316         16  CP-DDF-HI-FACT        PIC S9V999   COMP-3 VALUE +0.
  6317         16  CP-DDF-LO-FACT        PIC S9V999   COMP-3 VALUE +0.
  6318         16  CP-DDF-CLP            PIC S9(5)V99 COMP-3 VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 124
* ECS010MO.cbl (/apps/prod/cid1p/copy/ELCCALC)
  6319         16  CP-DDF-SPEC-CALC      PIC X.
  6320             88  CP-CALC-GROSS-FEE        VALUE 'G'.
  6321             88  CP-CALC-CLP              VALUE 'C'.
  6322         16  CP-IU-RATE-UP         PIC S9(5)V99   COMP-3 VALUE +0.
  6323         16  CP-CANCEL-REASON      PIC X.
  6324         16  CP-DDF-ADMIN-FEES     PIC S9(5)V99 COMP-3 VALUE +0.
  6325         16  CP-PMT-MODE           PIC X.
  6326         16  CP-NO-OF-PMTS         PIC S999 COMP-3 VALUE +0.
  6327         16  CP-1ST-YR-ALLOW       PIC S999V99 COMP-3 VALUE +0.
  6328         16  CP-DDF-COMM-AND-MFEE  PIC S9(5)V99 COMP-3 VALUE +0.
  6329         16  CP-DDF-YR1AF          PIC S9(5)V99 COMP-3 VALUE +0.
  6330         16  FILLER                PIC X.
  6331                                                                     CL**2
  6332***************    OUTPUT FROM ELRESV   ************************     CL**2
  6333                                                                     CL**2
  6334         16  CP-CDT-TABLE          PIC 9             VALUE ZERO.     CL**2
  6335                                                                     CL**2
  6336         16  CP-CDT-FACTOR         PIC S9(5)V9(6)    VALUE ZERO      CL**2
  6337                                     COMP-3.                         CL**2
  6338         16  CP-PTC-RESERVE        PIC S9(7)V99   VALUE ZERO         CL**2
  6339                                     COMP-3.                         CL**2
  6340         16  CP-IBNR-RESERVE       PIC S9(7)V99   VALUE ZERO         CL**2
  6341                                     COMP-3.                         CL**2
  6342         16  CP-FUTURE-RESERVE     PIC S9(7)V99   VALUE ZERO         CL**2
  6343                                     COMP-3.                         CL**2
  6344         16  FILLER                PIC X(09).                        CL**2
  6345***************    OUTPUT FROM ELRTRM   *************************    CL**2
  6346                                                                     CL**2
  6347         16  CP-REMAINING-TERM-1   PIC S9(4)V9    VALUE ZERO         CL**2
  6348                                     COMP-3.                         CL**2
  6349         16  CP-REMAINING-TERM-2   PIC S9(4)V9    VALUE ZERO         CL**2
  6350                                     COMP-3.                         CL**2
  6351         16  CP-REMAINING-TERM-3   PIC S9(4)V9    VALUE ZERO         CL**2
  6352                                     COMP-3.                         CL**2
  6353         16  CP-ODD-DAYS           PIC S9(3)      VALUE ZERO         CL**2
  6354                                     COMP-3.                         CL**2
  6355         16  FILLER                PIC X(12).                        CL**2
  6356                                                                     CL**2
  6357***************    OUTPUT FROM ELRAMT   *************************    CL**2
  6358                                                                     CL**2
  6359         16  CP-REMAINING-AMT      PIC S9(9)V99   VALUE ZERO         CL**2
  6360                                     COMP-3.                         CL**2
  6361         16  CP-REMAINING-AMT-PRV  PIC S9(9)V99   VALUE ZERO         CL**2
  6362                                     COMP-3.                         CL**2
  6363         16  FILLER                PIC X(12).                        CL**2
  6364                                                                     CL**2
  6365***************    OUTPUT FROM ELRATE   *************************    CL**2
  6366                                                                     CL**2
  6367         16  CP-CALC-PREMIUM       PIC S9(7)V99   VALUE ZERO         CL**2
  6368                                     COMP-3.                         CL**2
  6369         16  CP-PREMIUM-RATE       PIC S9(2)V9(5) VALUE ZERO         CL**2
  6370                                     COMP-3.                         CL**2
  6371         16  CP-MORTALITY-CODE     PIC X(4).                         CL**2
  6372         16  CP-RATE-EDIT-FLAG     PIC X.                            CL**2
  6373             88  CP-RATES-NEED-APR                  VALUE '1'.       CL**2
  6374         16  CP-COMPOSITE-RATE     PIC S99V999    VALUE ZERO         CL**2
  6375                                     COMP-3.                         CL**2
  6376         16  CP-POLICY-FEE         PIC S9(3)V99 VALUE +0 COMP-3.     CL**2
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 125
* ECS010MO.cbl (/apps/prod/cid1p/copy/ELCCALC)
  6377         16  CP-LF-PREM            PIC S9(7)V99 VALUE +0 COMP-3.
  6378         16  CP-LF-BALLOON-PREM REDEFINES CP-LF-PREM
  6379                                   PIC S9(7)V99 COMP-3.
  6380         16  FILLER                PIC X(07).                        CL**2
  6381                                                                     CL**2
  6382***************    OUTPUT FROM ELRFND   *************************    CL**2
  6383                                                                     CL**2
  6384         16  CP-CALC-REFUND        PIC S9(7)V99   VALUE ZERO         CL**2
  6385                                     COMP-3.                         CL**2
  6386         16  CP-REFUND-TYPE-USED   PIC X.                            CL**2
  6387           88  CP-R-AS-R78                         VALUE '1'.        CL**2
  6388           88  CP-R-AS-PRORATA                     VALUE '2'.        CL**2
  6389           88  CP-R-AS-CALIF                       VALUE '3'.        CL**2
  6390           88  CP-R-AS-TEXAS                       VALUE '4'.        CL**2
  6391           88  CP-R-AS-FARM-PLAN                   VALUE '4'.        CL**2
  6392           88  CP-R-AS-NET-PAY                     VALUE '5'.        CL**2
  6393           88  CP-R-AS-ANTICIPATION                VALUE '6'.        CL**2
  6394           88  CP-R-AS-MEAN                        VALUE '8'.        CL**2
  6395           88  CP-R-AS-SUM-OF-DIGITS               VALUE '9'.        CL**2
  6396           88  CP-R-AS-GAP-NON-REFUND              VALUE 'G'.
  6397           88  CP-R-AS-GAP-ACTUARIAL               VALUE 'S'.
  6398           88  CP-R-AS-SPP-DDF                     VALUE 'D'.
  6399           88  CP-R-AS-SPP-DDF-IU                  VALUE 'I'.
  6400           88  CP-R-AS-REPOSSESSION                VALUE 'R'.
  6401         16  FILLER                PIC X(12).                        CL**2
  6402                                                                     CL**2
  6403***************    OUTPUT FROM ELEARN   *************************    CL**2
  6404                                                                     CL**2
  6405         16  CP-R78-U-PRM          PIC S9(7)V99   VALUE ZERO         CL**2
  6406                                     COMP-3.                         CL**2
  6407         16  CP-R78-U-PRM-ALT      PIC S9(7)V99   VALUE ZERO         CL**2
  6408                                     COMP-3.                         CL**2
  6409         16  CP-PRORATA-U-PRM      PIC S9(7)V99   VALUE ZERO         CL**2
  6410                                     COMP-3.                         CL**2
  6411         16  CP-PRORATA-U-PRM-ALT  PIC S9(7)V99   VALUE ZERO         CL**2
  6412                                     COMP-3.                         CL**2
  6413         16  CP-STATE-U-PRM        PIC S9(7)V99   VALUE ZERO         CL**2
  6414                                     COMP-3.                         CL**2
  6415         16  CP-DOMICILE-U-PRM     PIC S9(7)V99   VALUE ZERO         CL**2
  6416                                     COMP-3.                         CL**2
  6417         16  CP-EARNING-TYPE-USED  PIC X.                            CL**2
  6418           88  CP-E-AS-SPECIAL                     VALUE 'S'.        CL**2
  6419           88  CP-E-AS-R78                         VALUE '1'.        CL**2
  6420           88  CP-E-AS-PRORATA                     VALUE '2'.        CL**2
  6421           88  CP-E-AS-TEXAS                       VALUE '4'.        CL**2
  6422           88  CP-E-AS-FARM-PLAN                   VALUE '4'.        CL**2
  6423           88  CP-E-AS-NET-PAY                     VALUE '5'.        CL**2
  6424           88  CP-E-AS-ANTICIPATION                VALUE '6'.        CL**2
  6425           88  CP-E-AS-MEAN                        VALUE '8'.        CL**2
  6426           88  CP-E-AS-SUM-OF-DIGITS               VALUE '9'.        CL**2
  6427         16  FILLER                PIC X(12).                        CL**2
  6428                                                                     CL**2
  6429***************    OUTPUT FROM ELPMNT   *************************    CL**2
  6430                                                                     CL**2
  6431         16  CP-ACTUAL-DAYS        PIC S9(05)     VALUE ZERO         CL**2
  6432                                     COMP-3.                         CL**2
  6433         16  CP-CLAIM-PAYMENT      PIC S9(7)V99   VALUE ZERO         CL**2
  6434                                     COMP-3.                         CL**2
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 126
* ECS010MO.cbl (/apps/prod/cid1p/copy/ELCCALC)
  6435         16  FILLER                PIC X(12).                        CL**2
  6436                                                                     CL**2
  6437***************   MISC WORK AREAS    *****************************   CL**2
  6438         16  CP-TOTAL-PAID         PIC S9(7)V99   VALUE ZERO         CL**2
  6439                                     COMP-3.                         CL**2
  6440         16  CP-R-MAX-ATT-AGE      PIC S9(3)      VALUE ZERO         CL**2
  6441                                     COMP-3.                         CL**2
  6442         16  CP-R-MAX-AGE          PIC S9(3)      VALUE ZERO         CL**2
  6443                                     COMP-3.                         CL**2
  6444         16  CP-R-MAX-TERM         PIC S9(5)      VALUE ZERO         CL**2
  6445                                     COMP-3.                         CL**2
  6446         16  CP-R-MAX-TOT-BEN      PIC S9(7)V99   VALUE ZERO         CL**2
  6447                                     COMP-3.                         CL**2
  6448         16  CP-R-MAX-MON-BEN      PIC S9(7)V99   VALUE ZERO         CL**2
  6449                                     COMP-3.                         CL**2
  6450         16  CP-IO-FUNCTION        PIC X          VALUE SPACE.       CL**2
  6451             88  OPEN-RATE-FILE                   VALUE 'O'.         CL**2
  6452             88  CLOSE-RATE-FILE                  VALUE 'C'.         CL**2
  6453             88  IO-ERROR                         VALUE 'E'.         CL**2
  6454                                                                     CL**2
  6455         16  CP-FIRST-PAY-DATE     PIC XX.                           CL**2
  6456                                                                     CL**2
  6457         16  CP-JOINT-INDICATOR    PIC X.                            CL**2
  6458                                                                     CL**2
  6459         16  CP-RESERVE-REMAINING-TERM                               CL**2
  6460                                   PIC S9(4)V9    VALUE ZERO         CL**2
  6461                                     COMP-3.                         CL**2
  6462                                                                     CL**2
  6463         16  CP-INSURED-BIRTH-DT   PIC XX.                           CL**2
  6464                                                                     CL**2
  6465         16  CP-INCURRED-AGE       PIC S9(3)      VALUE ZERO         CL**2
  6466                                     COMP-3.                         CL**2
  6467                                                                     CL**2
  6468         16  CP-MONTHLY-PAYMENT    PIC S9(5)V99   VALUE ZERO         CL**2
  6469                                     COMP-3.                         CL**2
  6470                                                                     CL**2
  6471         16  CP-RATING-BENEFIT-AMT PIC S9(9)V99   VALUE ZERO         CL**2
  6472                                     COMP-3.                         CL**2
  6473                                                                     CL**2
  6474         16  CP-ODD-DAYS-TO-PMT    PIC S9(3)      VALUE ZERO         CL**2
  6475                                     COMP-3.                         CL**2
  6476                                                                     CL**2
  6477         16  CP-MNTHS-TO-FIRST-PMT PIC S9(3)      VALUE ZERO         CL**2
  6478                                     COMP-3.                         CL**2
  6479                                                                     CL**2
  6480         16  CP-REMAMT-FACTOR      PIC S9(4)V9(9) VALUE ZEROS        CL**2
  6481                                     COMP-3.                         CL**2
  6482                                                                     CL**2
  6483         16  CP-FREE-LOOK          PIC S9(3)      VALUE ZERO         CL**2
  6484                                     COMP-3.                         CL**2
  6485                                                                     CL**2
  6486         16  CP-ROA-REFUND         PIC X          VALUE 'N'.         CL**2
  6487             88  CP-ROA-PREM-AT-REFUND            VALUE 'Y'.         CL**2
  6488                                                                     CL**2
  6489         16  CP-NET-BENEFIT-AMT    PIC S9(9)V99   VALUE ZERO         CL**2
  6490                                     COMP-3.                         CL**2
  6491         16  CP-SCNP-6MO-AMT       PIC S9(9)V99   VALUE ZERO
  6492                                     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 127
* ECS010MO.cbl (/apps/prod/cid1p/copy/ELCCALC)
  6493         16  CP-MONTH              PIC S999     COMP-3 VALUE +0.
  6494         16  cp-extra-periods      pic 9 value zeros.
  6495         16  cp-net-only-state     pic x value spaces.
  6496         16  FILLER                PIC X(13).                        CL**2
  6497******************************************************************   CL**2
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 128
* ECS010MO.cbl
* 6499                             COPY ELCDTECX.
  6500******************************************************************06/05/98
  6501*                                                                *ELCDTECX
  6502*                            ELCDTECX.                           *   LV005
  6503*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  6504*                            VMOD=2.015                          *ELCDTECX
  6505*                                                                *ELCDTECX
  6506*      WORKING STORAGE COPY CODE FOR APPLICATIONS CALLING        *ELCDTECX
  6507*      THE DATE CARD DISK FILE. ( READ ROUTINE = ELCDTERX,       *ELCDTECX
  6508*      AND DISK FILE FD = ELCDTEFX)                              *ELCDTECX
  6509*                                                                *ELCDTECX
  6510******************************************************************ELCDTECX
  6511******************************************************************
  6512*                   C H A N G E   L O G
  6513*
  6514* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6515*-----------------------------------------------------------------
  6516*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6517* EFFECTIVE    NUMBER
  6518*-----------------------------------------------------------------
  6519* 092602    2002091900008  PEMA  INCREASE NUMBER OF MAXIMUM
  6520*                                  BENEFIT CODES FROM 300 TO 900
  6521* 090803    2003080800002  PEMA  ADD CATEGORY FOR SUPER GAP
  6522* 051304    2003080800002  SMVA  ADD REFUND METHOD
  6523* 071714    2013100100002  PEMA  FIX CRIT PERIOD EDITS
  6524******************************************************************
  6525 01  DATE-CARD.                                                   ELCDTECX
  6526     12  DATX-COD                    PIC  X(4).                   ELCDTECX
  6527     12  RUN-DATE                    PIC  9(11)  COMP-3.          ELCDTECX
  6528     12  ALPH-DATE                   PIC  X(18).                  ELCDTECX
  6529     12  EP-DT                       PIC  9(11)  COMP-3.          ELCDTECX
  6530     12  PEND-ACT-FILE               PIC  XX.                     ELCDTECX
  6531     12  EP-SW                       PIC  X.                      ELCDTECX
  6532         88  NO-EP-EXTRACTS          VALUE SPACE.                 ELCDTECX
  6533     12  TAPE-BATCHES                PIC  X.                      ELCDTECX
  6534         88  TP-PREL-BAL             VALUE '1'.                   ELCDTECX
  6535     12  BIN-RUN-DATE                PIC  XX.                     ELCDTECX
  6536     12  RUN-CENTURY.                                             ELCDTECX
  6537         16 RUN-CENTURY-N            PIC  99.                        CL**4
  6538     12  FILLER                      PIC  X.                         CL**4
  6539     12  CLAS-MORT-OVRD              PIC  X(4).                   ELCDTECX
  6540     12  FILLER                      PIC  XXX.                    ELCDTECX
  6541     12  COMPANY-NAME                PIC  X(30).                  ELCDTECX
  6542                                                                  ELCDTECX
  6543 01  FILLER                          PIC  X(7)                       CL**6
  6544                                          VALUE 'OPTIONS'.        ELCDTECX
  6545 01  DATE-CARD-OPTIONS.                                           ELCDTECX
  6546     12  DATE-OPTIONS-ID             PIC  X(4).                   ELCDTECX
  6547     12  DTE-MIN-PREM                PIC  99V99.                  ELCDTECX
  6548     12  DTE-LANGUAGE-IND            PIC  X.                      ELCDTECX
  6549         88  DTE-LANGUAGE-IS-FR           VALUE 'F'.              ELCDTECX
  6550         88  DTE-LANGUAGE-IS-ENG          VALUE 'E'.              ELCDTECX
  6551     12  DTE-MIN-AGE                 PIC  99.                     ELCDTECX
  6552     12  DTE-DEFAULT-AGE             PIC  99.                     ELCDTECX
  6553     12  FILLER                      PIC  X.                      ELCDTECX
  6554     12  DTE-MAX-TERM                PIC  999.                    ELCDTECX
  6555     12  DTE-COMP-VG                 PIC  X.                      ELCDTECX
  6556     12  DTE-REM-TRM                 PIC  X.                      ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 129
* ECS010MO.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  6557     12  DTE-PRM-CK                  PIC S99V99.                  ELCDTECX
  6558     12  DTE-PRORATA                 PIC  X.                      ELCDTECX
  6559     12  DTE-CLM-REJ                 PIC  X.                      ELCDTECX
  6560     12  DTE-REF-REJ                 PIC  X.                      ELCDTECX
  6561     12  DTE-COM-TBL-USED            PIC  X.                      ELCDTECX
  6562     12  FILLER                      PIC  X.                      ELCDTECX
  6563     12  DTE-QTR-CO                  PIC  X.                      ELCDTECX
  6564     12  DTE-REF-CK                  PIC S99V99.                  ELCDTECX
  6565     12  DTE-CLM-CK                  PIC S99V99.                  ELCDTECX
  6566     12  DTE-CONV-DT                 PIC 9(11) COMP-3.               CL**2
  6567     12  DTE-DEFAULT-SEX             PIC  X.                      ELCDTECX
  6568     12  DTE-EPL-FORMAT              PIC  X.                      ELCDTECX
  6569     12  FILLER                      PIC  X.                      ELCDTECX
  6570     12  DTE-JT-AGE                  PIC  X.                      ELCDTECX
  6571     12  DTE-KEY-BIRTH               PIC  X.                      ELCDTECX
  6572     12  DTE-REINSURANCE             PIC  X.                      ELCDTECX
  6573     12  DTE-CLAIM-SORT              PIC  X.                      ELCDTECX
  6574     12  DTE-WRT-OFF                 PIC  S99V99.                 ELCDTECX
  6575     12  DTE-R78                     PIC  X.                      ELCDTECX
  6576     12  DTE-DLY-BILL                PIC  X.                      ELCDTECX
  6577     12  DTE-ALT-MORT-CODE           PIC  X(4).                   ELCDTECX
  6578     12  DTE-CLAIM-PAID-THRU-TO      PIC  X.                      ELCDTECX
  6579     12  DTE-COMPENSATION-ACCESS     PIC  X.                      ELCDTECX
  6580     12  DTE-MORTG-ACCESS-CNTL       PIC  X.                      ELCDTECX
  6581     12  DTE-MP-ALT-MORT-CODE        PIC  X(4).                   ELCDTECX
  6582     12  DTE-MORTALITY-AGE-CALC-METHOD                            ELCDTECX
  6583                                     PIC  X.                      ELCDTECX
  6584         88  DTE-USE-TABLE-ASSIGNED-METHOD VALUE '1'              ELCDTECX
  6585                                                 ' '.             ELCDTECX
  6586         88  DTE-USE-ALL-AGE-LAST          VALUE '2'.             ELCDTECX
  6587         88  DTE-USE-ALL-AGE-NEAR          VALUE '3'.             ELCDTECX
  6588     12  DTE-RESERVE-OPTION-SWITCH   PIC  X.                      ELCDTECX
  6589         88  DTE-OPT-RESERVE-METHOD-AUTH       VALUE 'Y'.         ELCDTECX
  6590         88  DTE-OPT-RESERVE-METHOD-UNAUTH     VALUE 'N' ' '.     ELCDTECX
  6591     12  DTE-REM-TRM-CALC-OPTION     PIC  X.                      ELCDTECX
  6592     12  DTE-EXPERIENCE-RETENTION-AGE                             ELCDTECX
  6593                                     PIC  9.                         CL**4
  6594     12  DTE-SYSTEM.                                              ELCDTECX
  6595         16  DTE-SYS-A-CREDIT        PIC  X.                      ELCDTECX
  6596         16  DTE-SYS-B-PEND-CLAIM    PIC  X.                      ELCDTECX
  6597         16  DTE-SYS-C-CONFIRMATIONS PIC  X.                      ELCDTECX
  6598         16  DTE-SYS-D-DEMAND-BILL   PIC  X.                      ELCDTECX
  6599         16  DTE-SYS-E-CLASIC-CLAIMS PIC  X.                      ELCDTECX
  6600         16  DTE-SYS-F-CLASIC-CREDIT PIC  X.                      ELCDTECX
  6601         16  DTE-SYS-G-AR-USED       PIC  X.                      ELCDTECX
  6602         16  DTE-SYS-H               PIC  X.                      ELCDTECX
  6603         16  DTE-SYS-I               PIC  X.                      ELCDTECX
  6604         16  DTE-SYS-J               PIC  X.                      ELCDTECX
  6605         16  DTE-SYS-K               PIC  X.                      ELCDTECX
  6606         16  DTE-SYS-L               PIC  X.                      ELCDTECX
  6607         16  DTE-SYS-M               PIC  X.                      ELCDTECX
  6608         16  DTE-SYS-N               PIC  X.                      ELCDTECX
  6609         16  DTE-SYS-O               PIC  X.                      ELCDTECX
  6610         16  DTE-SYS-P               PIC  X.                      ELCDTECX
  6611         16  DTE-SYS-Q               PIC  X.                      ELCDTECX
  6612         16  DTE-SYS-R               PIC  X.                      ELCDTECX
  6613         16  DTE-SYS-S               PIC  X.                      ELCDTECX
  6614         16  DTE-SYS-T               PIC  X.                      ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 130
* ECS010MO.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  6615         16  DTE-SYS-U               PIC  X.                      ELCDTECX
  6616         16  DTE-SYS-V               PIC  X.                      ELCDTECX
  6617         16  DTE-SYS-W               PIC  X.                      ELCDTECX
  6618         16  DTE-SYS-X               PIC  X.                      ELCDTECX
  6619         16  DTE-SYS-Y               PIC  X.                      ELCDTECX
  6620         16  DTE-SYS-Z               PIC  X.                      ELCDTECX
  6621     12  FILLER                      REDEFINES DTE-SYSTEM.        ELCDTECX
  6622         16  DTE-SYS-CODE            OCCURS 26 TIMES              ELCDTECX
  6623                                     PIC  X.                      ELCDTECX
  6624     12  DTE-CLIENT                  PIC  XXX.                    ELCDTECX
  6625                                                                  ELCDTECX
  6626 01  CLASIC-SYSTEM-CODES.                                         ELCDTECX
  6627     12  DTE-COLC-ID                 PIC  X(4).                   ELCDTECX
  6628     12  DTE-CLASIC-COMPANY-CD       PIC  X.                      ELCDTECX
  6629     12  DTE-CLASIC-COMPANY-NUMBER   PIC  999.                    ELCDTECX
  6630*    12  DTE-CLASIC-CLAIM-ACCESS     PIC  X.                      ELCDTECX
  6631     12  FILLER                      PIC  X.                      ELCDTECX
  6632     12  CLASIC-REIN-MAINT           PIC  XX.                     ELCDTECX
  6633     12  CLASIC-COMP-MAINT           PIC  XX.                     ELCDTECX
  6634     12  CLASIC-ACCT-MAINT           PIC  XX.                     ELCDTECX
  6635     12  CLASIC-CTBL-MAINT           PIC  XX.                     ELCDTECX
  6636     12  CLASIC-RATE-MAINT           PIC  XX.                     ELCDTECX
  6637     12  CLASIC-CREDIT-EOM-DT        PIC  XX.                     ELCDTECX
  6638     12  CLASIC-CLAIMS-EOM-DT        PIC  XX.                     ELCDTECX
  6639                                                                  ELCDTECX
  6640     12  LIFE-OVERRIDE-L1            PIC  X.                      ELCDTECX
  6641     12  LIFE-OVERRIDE-L2            PIC  XX.                     ELCDTECX
  6642     12  LIFE-OVERRIDE-L6            PIC  X(6).                   ELCDTECX
  6643     12  LIFE-OVERRIDE-L12           PIC  X(12).                  ELCDTECX
  6644                                                                  ELCDTECX
  6645     12  AH-OVERRIDE-L1              PIC  X.                      ELCDTECX
  6646     12  AH-OVERRIDE-L2              PIC  XX.                     ELCDTECX
  6647     12  AH-OVERRIDE-L6              PIC  X(6).                   ELCDTECX
  6648     12  AH-OVERRIDE-L12             PIC  X(12).                  ELCDTECX
  6649                                                                  ELCDTECX
  6650     12  CLAS-REPORT-CD1-CAPTION     PIC  X(10).                  ELCDTECX
  6651     12  CLAS-REPORT-CD2-CAPTION     PIC  X(10).                  ELCDTECX
  6652                                                                  ELCDTECX
  6653     12  CLASIC-MORTG-EOM-DT         PIC  XX.                     ELCDTECX
  6654     12  CLASIC-AR-EOM-DT            PIC  XX.                     ELCDTECX
  6655                                                                  ELCDTECX
  6656     12  FILLER                      PIC  X(11)      VALUE SPACE. ELCDTECX
  6657                                                                  ELCDTECX
  6658 01  DATE-CARD-FACTORS.                                           ELCDTECX
  6659     12  DATE-FACTOR-ID              PIC  X(4).                   ELCDTECX
  6660     12  FAC-1                       PIC S999V9(5).               ELCDTECX
  6661     12  FAC-2                       PIC S999V9(5).               ELCDTECX
  6662     12  FAC-3                       PIC S999V9(5).               ELCDTECX
  6663     12  FAC-4                       PIC S999V9(5).               ELCDTECX
  6664     12  FAC-5                       PIC S999V9(5).               ELCDTECX
  6665     12  FAC-6                       PIC S999V9(5).               ELCDTECX
  6666                                                                  ELCDTECX
  6667 01  FILLER                          PIC  X(12)                   ELCDTECX
  6668                                          VALUE 'COMPANY NAME'.   ELCDTECX
  6669 01  COMPANY-NAME-TABLE.                                          ELCDTECX
  6670     12  C-N-TBL                     OCCURS 6 TIMES.              ELCDTECX
  6671         16  CNT-ID                  PIC  X.                      ELCDTECX
  6672         16  CNT-NAME                PIC  X(30).                  ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 131
* ECS010MO.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  6673                                                                  ELCDTECX
  6674 01  FILLER                          PIC  X(11)                   ELCDTECX
  6675                                          VALUE 'STATE NAMES'.    ELCDTECX
  6676 01  STATE-NAMES.                                                 ELCDTECX
  6677     12  STATE-NAME-FLD              OCCURS 75 TIMES.             ELCDTECX
  6678         16  STATE-SUB               PIC  XX.                     ELCDTECX
  6679         16  STATE-PIC1.                                          ELCDTECX
  6680             20  STATE-ABBR          PIC  XX.                     ELCDTECX
  6681             20  FILLER              PIC  XXX.                    ELCDTECX
  6682             20  STATE-PIC           PIC  X(20).                  ELCDTECX
  6683             20  STATE-CALL-EARN     PIC  X.                      ELCDTECX
  6684             20  STATE-CALL-BREAK    PIC  X.                      ELCDTECX
  6685             20  STATE-PRIM-FAC-DEV  PIC  XXX.                    ELCDTECX
  6686                                                                  ELCDTECX
  6687 01  FILLER                          PIC  X(13)                   ELCDTECX
  6688                                          VALUE 'CARRIER NAMES'.  ELCDTECX
  6689 01  CARRIER-NAMES.                                               ELCDTECX
  6690     12  CARRIER-NAME-FLD            OCCURS 25 TIMES.             ELCDTECX
  6691         16  CARRIER-SUB             PIC  X.                      ELCDTECX
  6692         16  CARRIER-DOM-ST          PIC  XX.                     ELCDTECX
  6693         16  CARRIER-PIC             PIC  X(30).                  ELCDTECX
  6694         16  CARRIER-UEP-PCT         PIC  S9V9(4) COMP-3.            CL**6
  6695         16  CARRIER-R78-PCT         PIC  S9V9(4) COMP-3.            CL**6
  6696         16  CARRIER-PRO-PCT         PIC  S9V9(4) COMP-3.            CL**6
  6697*        16  FILLER                  PIC  X.                      ELCDTECX
  6698         16  CARRIER-SEC-PAY         PIC  X.
  6699             88  SEC-PAY-CARRIER          VALUE 'Y'.
  6700                                                                  ELCDTECX
  6701 01  FILLER                          PIC  X(9)                       CL**6
  6702                                          VALUE 'INS TYPES'.      ELCDTECX
  6703 01  CLAS-INS-TYPES.                                              ELCDTECX
  6704*    12 CLAS-ALL-TYPES               OCCURS 300 TIMES.            ELCDTECX
  6705     12 CLAS-ALL-TYPES               OCCURS 900 TIMES.            ELCDTECX
  6706         16  CLAS-I-BEN              PIC  XX.                     ELCDTECX
  6707         16  CLAS-I-AB3.                                          ELCDTECX
  6708             20  FILLER              PIC  X.                      ELCDTECX
  6709             20  CLAS-I-AB2.                                      ELCDTECX
  6710                 24  FILLER          PIC  X.                      ELCDTECX
  6711                 24  CLAS-I-AB1      PIC  X.                      ELCDTECX
  6712         16  CLAS-I-AB3-AH REDEFINES CLAS-I-AB3.                  ELCDTECX
  6713             20  CLAS-EXCLUSION      PIC  XX.                        CL**4
  6714             20  FILLER              PIC  X.                         CL**4
  6715         16  CLAS-I-AB10.                                         ELCDTECX
  6716             20  FILLER              PIC  X(9).                   ELCDTECX
  6717             20  CLAS-I-REIN-YN      PIC  X.                      ELCDTECX
  6718         16  CLAS-I-COMMENT          PIC  X(10).                  ELCDTECX
  6719         16  CLAS-I-JOINT            PIC  X.                      ELCDTECX
  6720         16  CLAS-I-RL-AH            PIC  X.                      ELCDTECX
  6721         16  CLAS-I-CALC-TYPE.                                    ELCDTECX
  6722             20  CLAS-I-BAL          PIC  X.                      ELCDTECX
  6723         16  CLAS-I-EP               PIC  X.                      ELCDTECX
  6724         16  CLAS-CO-BEN-I-G-CD      PIC  X.                      ELCDTECX
  6725         16  CLAS-CO-REM-TERM-CALC   PIC  X.                      ELCDTECX
  6726         16  CLAS-I-BEN-CATEGORY     PIC  X.
  6727         16  CLAS-I-REFUND-METHOD    PIC  X.
  6728         16  CLAS-I-MAX-BENEFITS     PIC 99.
  6729         16  FILLER                  PIC  XXX.
  6730                                                                  ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 132
* ECS010MO.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  6731 01  FILLER                          PIC  X(16)                   ELCDTECX
  6732                                     VALUE 'MORTALITY TABLES'.    ELCDTECX
  6733 01  CLAS-MORTALITY-CODES.                                        ELCDTECX
  6734     12  CLAS-MORT-FLD               OCCURS 99 TIMES              ELCDTECX
  6735                                     INDEXED BY CLAS-MORT-NDX.    ELCDTECX
  6736         16  CLAS-MORT-CODE          PIC  X(4).                      CL**6
  6737         16  CLAS-MORT-J-CODE        PIC  X.                         CL**5
  6738         16  CLAS-MORT-J-FACT        PIC S9V9(4).                    CL**6
  6739         16  CLAS-MORT-DESC.                                      ELCDTECX
  6740             20  CLAS-RESERVE-ADJ    PIC  999.                       CL**6
  6741             20  FILLER              PIC  XX.                        CL**5
  6742             20  CLAS-YEAR           PIC  X(4).                      CL**6
  6743             20  FILLER              PIC  X.                         CL**5
  6744             20  CLAS-TABLE-TYPE     PIC  XXX.                       CL**6
  6745             20  FILLER              PIC  X.                         CL**5
  6746             20  CLAS-AGE-METHOD     PIC  XX.                        CL**5
  6747             20  FILLER              PIC  X.                         CL**5
  6748             20  CLAS-INTEREST       PIC  99.99.                     CL**5
  6749             20  FILLER              PIC  X(5).                      CL**6
  6750                                                                  ELCDTECX
  6751 01  FILLER                          PIC  X(15)                   ELCDTECX
  6752                                     VALUE 'BUSINESS TABLES'.     ELCDTECX
  6753 01  CLAS-BUSINESS-CLASSES.                                       ELCDTECX
  6754     12  CLAS-BUSC-FLD               OCCURS 50 TIMES.             ELCDTECX
  6755         16  CLAS-BUSC-CODE          PIC  99.                     ELCDTECX
  6756         16  CLAS-BUSC-GROUP         PIC  X.                      ELCDTECX
  6757         16  CLAS-BUSC-DESC          PIC  X(19).                  ELCDTECX
  6758         16  CLAS-BUSC-EXCL          PIC  X.                         CL**5
  6759         16  FILLER                  PIC  X(4).                      CL**6
  6760                                                                  ELCDTECX
  6761 01  FILLER                          PIC  X(7)                       CL**6
  6762                                     VALUE 'INDEXES'.             ELCDTECX
  6763 01  CLAS-INDEX-TBL.                                              ELCDTECX
  6764     12  CLAX-ID                     PIC  X(4).                   ELCDTECX
  6765     12  CLAS-STARTC                 PIC S9(4) COMP.              ELCDTECX
  6766     12  CLAS-MAXC                   PIC S9(4) COMP.              ELCDTECX
  6767     12  CLAS-STARTL                 PIC S9(4) COMP.              ELCDTECX
  6768     12  CLAS-MAXL                   PIC S9(4) COMP.              ELCDTECX
  6769     12  CLAS-STARTA                 PIC S9(4) COMP.              ELCDTECX
  6770     12  CLAS-MAXA                   PIC S9(4) COMP.              ELCDTECX
  6771     12  CLAS-STARTM                 PIC S9(4) COMP.              ELCDTECX
  6772     12  CLAS-MAXM                   PIC S9(4) COMP.              ELCDTECX
  6773     12  CLAS-STARTB                 PIC S9(4) COMP.              ELCDTECX
  6774     12  CLAS-MAXB                   PIC S9(4) COMP.              ELCDTECX
  6775     12  CLAS-STARTS                 PIC S9(4) COMP.              ELCDTECX
  6776     12  CLAS-MAXS                   PIC S9(4) COMP.              ELCDTECX
  6777     12  CLAS-STARTE                 PIC S9(4) COMP.              ELCDTECX
  6778     12  CLAS-MAXE                   PIC S9(4) COMP.              ELCDTECX
  6779     12  CLAS-STARTCN                PIC S9(4) COMP.              ELCDTECX
  6780     12  CLAS-MAXCN                  PIC S9(4) COMP.              ELCDTECX
  6781                                                                  ELCDTECX
  6782 01  CLAS-TYPE-MISC.                                              ELCDTECX
  6783     12  CLAS-INDEXC                 PIC S9(4) COMP.              ELCDTECX
  6784     12  CLAS-INDEXL                 PIC S9(4) COMP.              ELCDTECX
  6785     12  CLAS-INDEXA                 PIC S9(4) COMP.              ELCDTECX
  6786     12  CLAS-INDEXM                 PIC S9(4) COMP.              ELCDTECX
  6787     12  CLAS-INDEXB                 PIC S9(4) COMP.              ELCDTECX
  6788     12  CLAS-INDEXS                 PIC S9(4) COMP.              ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 133
* ECS010MO.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  6789     12  CLAS-INDEXE                 PIC S9(4) COMP.              ELCDTECX
  6790     12  CLAS-INDEX                  PIC S9(4) COMP.              ELCDTECX
  6791     12  CLAS-INDEXEN                PIC S9(4) COMP.              ELCDTECX
  6792     12  CLAS-INDEXCN                PIC S9(4) COMP.              ELCDTECX
  6793     12  CLAS-INDEXON                PIC S9(4) COMP.              ELCDTECX
  6794                                                                  ELCDTECX
  6795 01  FILLER                          PIC  X(13)                   ELCDTECX
  6796                                     VALUE 'MISCELLANEOUS'.       ELCDTECX
  6797 01  CLAS-MISC.                                                   ELCDTECX
  6798     12  DTE-FICH                    PIC  X.                      ELCDTECX
  6799         88  FICH-NO                 VALUE SPACE.                 ELCDTECX
  6800         88  FICH-ONLY               VALUE '1'.                   ELCDTECX
  6801         88  FICH-BOTH               VALUE '2'.                   ELCDTECX
  6802     12  FICH-OPEN                   PIC  X.                      ELCDTECX
  6803     12  REPT-OPEN                   PIC  X.                      ELCDTECX
  6804     12  DTE-PGM-OPT                 PIC  9.                         CL**5
  6805     12  DTE-PRT-OPT                 PIC  X.                      ELCDTECX
  6806     12  DTE-FMT-OPT                 PIC  9.                      ELCDTECX
  6807     12  DTE-PRC-OPT                 PIC  9.                      ELCDTECX
  6808     12  DTE-TOT-OPT                 PIC  9.                      ELCDTECX
  6809     12  CLAS-LOOK                   PIC  XX.                     ELCDTECX
  6810     12  DTE-TOT-LINES               PIC S9(8)      COMP.         ELCDTECX
  6811     12  STATE-L                     PIC  XX.                     ELCDTECX
  6812     12  CLAS-CN                     PIC  99.                     ELCDTECX
  6813     12  CLAS-CO                     PIC  99.                     ELCDTECX
  6814     12  DTE-VSAM-FLAGS                              VALUE ZERO.  ELCDTECX
  6815         16  DTE-F-1                 PIC  X.                      ELCDTECX
  6816         16  DTE-F-2                 PIC  X.                      ELCDTECX
  6817     12  DTE-ABEND-WORK.                                          ELCDTECX
  6818         16  DTE-ABEND-CD-1          PIC  XX         VALUE SPACES.ELCDTECX
  6819         16  DTE-ABEND-CD-2          PIC  XX         VALUE SPACES.ELCDTECX
  6820                                                                  ELCDTECX
  6821 01  FILLER                          PIC  X(12)                   ELCDTECX
  6822                                     VALUE 'WORKING DATE'.        ELCDTECX
  6823 01  WS-DATE-AND-TIME.                                            ELCDTECX
  6824     12  WS-ACCEPT-DATE.                                          ELCDTECX
  6825         16  WS-AD-YY                PIC  99.                     ELCDTECX
  6826         16  WS-AD-MM                PIC  99.                     ELCDTECX
  6827         16  WS-AD-DD                PIC  99.                     ELCDTECX
  6828     12  WS-CURRENT-DATE.                                         ELCDTECX
  6829         16  WS-CD-MM                PIC  99.                     ELCDTECX
  6830         16  FILLER                  PIC  X          VALUE '/'.   ELCDTECX
  6831         16  WS-CD-DD                PIC  99.                     ELCDTECX
  6832         16  FILLER                  PIC  X          VALUE '/'.   ELCDTECX
  6833         16  WS-CD-YY                PIC  99.                     ELCDTECX
  6834     12  WS-TIME-OF-DAY.                                          ELCDTECX
  6835         16  WS-TIME                 PIC  9(6).                   ELCDTECX
  6836         16  WS-HUN-SEC              PIC  99.                     ELCDTECX
  6837                                                                  ELCDTECX
  6838 01  FILLER                          PIC  X(12)                   ELCDTECX
  6839                                     VALUE 'CARRIER CLMS'.        ELCDTECX
  6840 01  CARRIER-OPT-CLAIM-DATA.                                      ELCDTECX
  6841     12  CARRIER-FLDS                OCCURS 25 TIMES.             ELCDTECX
  6842         16  CARRIER-IBNR-SWITCH     PIC  X.                         CL**5
  6843         16  CARRIER-IBNR-PERCENT    PIC S9V9(4) COMP-3.             CL**6
  6844         16  CARRIER-CIDA-DISCOUNT   PIC S9V9(4) COMP-3.             CL**6
  6845                                                                  ELCDTECX
  6846 01  FILLER                          PIC  X(10)                   ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 134
* ECS010MO.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  6847                                     VALUE 'STATE TLRS'.          ELCDTECX
  6848 01  STATE-TARGET-LOSS-RATIOS.                                    ELCDTECX
  6849     12  STATE-TLR-FLD               OCCURS 75 TIMES.             ELCDTECX
  6850         16  STATE-TARGET-LOSS-RATIO PIC S9V9(4) COMP-3.             CL**6
  6851         16  STATE-CALC-INTEREST     PIC S9V9(4) COMP-3.             CL**6
  6852                                                                  ELCDTECX
  6853 01  FILLER                          PIC  X(13)                   ELCDTECX
  6854                                     VALUE 'BUSINESS TLRS'.       ELCDTECX
  6855 01  BUSINESS-TRGT-LOSS-RATIO-MODS.                               ELCDTECX
  6856     12  BUS-TLRM-FLD                OCCURS 99 TIMES.             ELCDTECX
  6857         16  BUS-TRGT-LOSS-RATIO-MOD PIC S9V9(4) COMP-3.             CL**6
  6858                                                                  ELCDTECX
  6859 01  FILLER                          PIC  X(13)                   ELCDTECX
  6860                                     VALUE 'MISC CLM DATA'.       ELCDTECX
  6861 01  MISC-OPT-CLM-RSV-DATA.                                       ELCDTECX
  6862     12  COMPANY-CALC-INTEREST       PIC S9V9(4) COMP-3.             CL**6
  6863     12  COMPANY-CIDA-DISCOUNT       PIC S9V9(4) COMP-3.             CL**6
  6864     12  COMPANY-CRDB-TABLE-SELECTION                             ELCDTECX
  6865                                     PIC  X.                         CL**5
  6866     12  COMPANY-IBNR-AH-FACTOR      PIC S9V9(4) COMP-3.             CL**6
  6867     12  COMPANY-IBNR-LAG-MONTH      PIC S999    COMP-3.             CL**6
  6868     12  COMPANY-IBNR-LIFE-FACTOR    PIC S9V9(4) COMP-3.             CL**6
  6869     12  COMPANY-OPTION-START-DATE   PIC  XX.                        CL**5
  6870     12  INDEXBS                     PIC S9(4)   COMP.               CL**6
  6871     12  INDEXCA                     PIC S9(4)   COMP.               CL**6
  6872     12  INDEXST                     PIC S9(4)   COMP.               CL**6
  6873     12  FILLER                      PIC  X(75).                  ELCDTECX
  6874******************************************************************ELCDTECX
  6875*01  MISC-CARR-PCT-DATA.                                          00001521
  6876*    12  DD-CARR1-UEP-PCT            PIC S9V9(4) COMP-3.          00001522
  6877*    12  DD-CARR1-R78-PCT            PIC S9V9(4) COMP-3.          00001522
  6878*    12  DD-CARR1-PRO-PCT            PIC S9V9(4) COMP-3.          00001522
  6879*    12  DD-CARR2-UEP-PCT            PIC S9V9(4) COMP-3.          00001522
  6880*    12  DD-CARR2-R78-PCT            PIC S9V9(4) COMP-3.          00001522
  6881*    12  DD-CARR2-PRO-PCT            PIC S9V9(4) COMP-3.          00001522
  6882******************************************************************ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 135
* ECS010MO.cbl
* 6884                             COPY ELCDTEVR.
  6885***************************************************************** 04/15/98
  6886*                                                                *ELCDTEVR
  6887*                                                                *ELCDTEVR
  6888*                            ELCDTEVR.                           *   LV003
  6889*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
  6890*                            VMOD=2.001                          *   CL**2
  6891*                                                                *ELCDTEVR
  6892*   WORKING STORAGE FOR DATE VARIABLES CREATED                   *ELCDTEVR
  6893*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCDTEVR
  6894*                                                                *ELCDTEVR
  6895******************************************************************ELCDTEVR
  6896 01  WS-DATE-CARD-DATE.                                           ELCDTEVR
  6897     05  WS-RUN-DATE.                                             ELCDTEVR
  6898         10  FILLER                  PIC  9(03).                  ELCDTEVR
  6899         10  RUN-CCYY                PIC  9(04).                  ELCDTEVR
  6900         10  RUN-CCYR  REDEFINES  RUN-CCYY.                       ELCDTEVR
  6901             15  RUN-CC              PIC  99.                     ELCDTEVR
  6902             15  RUN-YR              PIC  99.                     ELCDTEVR
  6903         10  RUN-MO                  PIC  99.                     ELCDTEVR
  6904         10  RUN-DA                  PIC  99.                     ELCDTEVR
  6905     05  WS-RUN-DATE-N REDEFINES                                     CL**2
  6906            WS-RUN-DATE              PIC 9(11).                      CL**2
  6907     05  WS-EP-DT.                                                ELCDTEVR
  6908         10  FILLER                  PIC  9(03).                  ELCDTEVR
  6909         10  EP-CCYY                 PIC  9(04).                  ELCDTEVR
  6910         10  EP-CCYR  REDEFINES  EP-CCYY.                         ELCDTEVR
  6911             15  EP-CC               PIC  99.                     ELCDTEVR
  6912             15  EP-YR               PIC  99.                     ELCDTEVR
  6913         10  EP-MO                   PIC  99.                     ELCDTEVR
  6914         10  EP-DA                   PIC  99.                     ELCDTEVR
  6915     05  WS-EP-DT-N REDEFINES                                        CL**2
  6916            WS-EP-DT                 PIC 9(11).                      CL**2
  6917     05  WS-DTE-CONV-DT.                                             CL**4
  6918         10  FILLER                  PIC  9(03).                     CL**4
  6919         10  DTE-CONV-CCYY           PIC  9(04).                     CL**4
  6920         10  DTE-CONV-CCYR  REDEFINES  DTE-CONV-CCYY.                CL**4
  6921             15  DTE-CONV-CC         PIC  99.                        CL**4
  6922             15  DTE-CONV-YR         PIC  99.                        CL**4
  6923         10  DTE-CONV-MO             PIC  99.                        CL**4
  6924         10  DTE-CONV-DA             PIC  99.                        CL**4
  6925     05  WS-DTE-CONV-DT-N REDEFINES                                  CL**4
  6926            WS-DTE-CONV-DT           PIC  9(11).                     CL**4
  6927 01  WS-BALANCE-FORWARD-DATE.                                     ELCDTEVR
  6928     05  WS-BF-LAST-ACTIVITY-DATE.                                ELCDTEVR
  6929         10  FILLER                            PIC 999.           ELCDTEVR
  6930         10  BF-ACT-CCYY                       PIC 9(04).         ELCDTEVR
  6931         10  BF-ACT-CCYR  REDEFINES  BF-ACT-CCYY.                 ELCDTEVR
  6932             15  BF-ACT-CC                     PIC 99.            ELCDTEVR
  6933             15  BF-ACT-YEAR                   PIC 99.            ELCDTEVR
  6934         10  BF-ACT-MONTH                      PIC 99.            ELCDTEVR
  6935         10  BF-ACT-DAY                        PIC 99.            ELCDTEVR
  6936     05  WS-BF-LAST-ACTIVITY-DATE-N REDEFINES                        CL**2
  6937            WS-BF-LAST-ACTIVITY-DATE           PIC 9(11).            CL**2
  6938     05  WS-BF-CURRENT-LAST-STMT-DT.                              ELCDTEVR
  6939         10  FILLER                            PIC 999.           ELCDTEVR
  6940         10  BF-CURRENT-LAST-STMT-CEN          PIC 99.            ELCDTEVR
  6941         10  BF-CURRENT-LAST-STMT-YEAR         PIC 99.            ELCDTEVR
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 136
* ECS010MO.cbl (/apps/prod/cid1p/copy/ELCDTEVR)
  6942         10  BF-CURRENT-LAST-STMT-MONTH        PIC 99.            ELCDTEVR
  6943         10  BF-CURRENT-LAST-STMT-DAY          PIC 99.            ELCDTEVR
  6944     05  WS-BF-CURRENT-LAST-STMT-DT-N REDEFINES                      CL**2
  6945            WS-BF-CURRENT-LAST-STMT-DT        PIC 9(11).             CL**2
  6946 01  WS-ADD-CONF-TRANSACTIONS-DTE.                                ELCDTEVR
  6947     05  WS-AC-CERT-EFF-DATE.                                     ELCDTEVR
  6948         10  FILLER                            PIC 999.           ELCDTEVR
  6949         10  AC-CERT-CCYY                      PIC 9(04).         ELCDTEVR
  6950         10  AC-CERT-CCYR  REDEFINES  AC-CERT-CCYY.               ELCDTEVR
  6951             15  AC-CERT-CC                    PIC 99.            ELCDTEVR
  6952             15  AC-CERT-YR                    PIC 99.            ELCDTEVR
  6953         10  AC-CERT-MO                        PIC 99.            ELCDTEVR
  6954         10  AC-CERT-DA                        PIC 99.            ELCDTEVR
  6955     05  WS-AC-CERT-EFF-DATE-N REDEFINES                             CL**2
  6956            WS-AC-CERT-EFF-DATE                PIC 9(11).            CL**2
  6957     05  WS-AC-LIFE-CANCEL-DATE.                                  ELCDTEVR
  6958         10  FILLER                            PIC 999.           ELCDTEVR
  6959         10  AC-LIFE-CANCEL-CCYY               PIC 9(04).         ELCDTEVR
  6960         10  AC-LIFE-CANCEL-CCYR REDEFINES AC-LIFE-CANCEL-CCYY.   ELCDTEVR
  6961             15  AC-LIFE-CANCEL-CC             PIC 99.            ELCDTEVR
  6962             15  AC-LIFE-CANCEL-YR             PIC 99.            ELCDTEVR
  6963         10  AC-LIFE-CANCEL-MO                 PIC 99.            ELCDTEVR
  6964         10  AC-LIFE-CANCEL-DA                 PIC 99.            ELCDTEVR
  6965     05  WS-AC-LIFE-CANCEL-DATE-N REDEFINES                          CL**2
  6966            WS-AC-LIFE-CANCEL-DATE             PIC 9(11).            CL**2
  6967     05  WS-AC-AH-CANCEL-DATE.                                    ELCDTEVR
  6968         10  FILLER                            PIC 999.           ELCDTEVR
  6969         10  AC-AH-CANCEL-CCYY                 PIC 9(04).         ELCDTEVR
  6970         10  AC-AH-CANCEL-CCYR  REDEFINES  AC-AH-CANCEL-CCYY.     ELCDTEVR
  6971             15  AC-AH-CANCEL-CC               PIC 99.            ELCDTEVR
  6972             15  AC-AH-CANCEL-YR               PIC 99.            ELCDTEVR
  6973         10  AC-AH-CANCEL-MO                   PIC 99.            ELCDTEVR
  6974         10  AC-AH-CANCEL-DA                   PIC 99.            ELCDTEVR
  6975     05  WS-AC-AH-CANCEL-DATE-N REDEFINES                            CL**2
  6976            WS-AC-AH-CANCEL-DATE               PIC 9(11).            CL**2
  6977 01  WS-RATE-RECORD.                                              ELCDTEVR
  6978         05  WS-RT-EXPIRY-DATE.                                   ELCDTEVR
  6979             10  FILLER                        PIC 999.           ELCDTEVR
  6980             10  RT-EXP-CCYY                   PIC 9(04).         ELCDTEVR
  6981             10  RT-EXP-CCYR  REDEFINES  RT-EXP-CCYY.             ELCDTEVR
  6982                 15  RT-EXP-CC                 PIC 99.            ELCDTEVR
  6983                 15  RT-EXP-YR                 PIC 99.            ELCDTEVR
  6984             10  RT-EXP-MO                     PIC 99.            ELCDTEVR
  6985             10  RT-EXP-DA                     PIC 99.            ELCDTEVR
  6986         05  WS-RT-EXPIRY-DATE-N REDEFINES                           CL**2
  6987                WS-RT-EXPIRY-DATE              PIC 9(11).            CL**2
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 137
* ECS010MO.cbl
* 6989                             COPY ELCACCTV.
  6990******************************************************************04/14/98
  6991*                                                                *ELCACCTV
  6992*                            ELCACCTV                            *   LV002
  6993*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  6994*                            VMOD=2.001                          *ELCACCTV
  6995*                                                                *ELCACCTV
  6996*   WORKING STORAGE FOR DATE VARIABLES CREATED                   *ELCACCTV
  6997*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCACCTV
  6998*                                                                *ELCACCTV
  6999*  NO  CID  MODS  IN  COPYBOOK  ELCACCTV                         *ELCACCTV
  7000*                                                                *ELCACCTV
  7001******************************************************************ELCACCTV
  7002                                                                  ELCACCTV
  7003 01  WS-ACCOUNT-MASTER-DATE.                                      ELCACCTV
  7004                                                                  ELCACCTV
  7005     05  WS-AM-EXPIRE-DT.                                         ELCACCTV
  7006         10  FILLER            PIC 999.                           ELCACCTV
  7007         10  AM-EXP-CCYY       PIC 9(04).                         ELCACCTV
  7008         10  AM-EXP-CCYR  REDEFINES  AM-EXP-CCYY.                 ELCACCTV
  7009             15  AM-EXP-CC     PIC 99.                            ELCACCTV
  7010             15  AM-EXP-YR     PIC 99.                            ELCACCTV
  7011         10  AM-EXP-MO         PIC 99.                               CL**5
  7012         10  AM-EXP-DA         PIC 99.                               CL**5
  7013     05  WS-AM-EXPIRE-DT-N REDEFINES                                 CL**3
  7014            WS-AM-EXPIRE-DT    PIC 9(11).                            CL**4
  7015     05  WS-AM-VG-EXP-DATE.                                       ELCACCTV
  7016         10  FILLER                    PIC 999.                   ELCACCTV
  7017         10  AM-VG-EXP-CCYY            PIC 9(04).                 ELCACCTV
  7018         10  AM-VG-EXP-CCYR  REDEFINES  AM-VG-EXP-CCYY.           ELCACCTV
  7019             15  AM-VG-EXP-CC          PIC 99.                    ELCACCTV
  7020             15  AM-VG-EXP-YR          PIC 99.                    ELCACCTV
  7021         10  AM-VG-EXP-MO              PIC 99.                    ELCACCTV
  7022         10  AM-VG-EXP-DA              PIC 99.                    ELCACCTV
  7023     05  WS-AM-VG-EXP-DATE-N REDEFINES                               CL**3
  7024            WS-AM-VG-EXP-DATE          PIC 9(11).                    CL**4
  7025     05  WS-AM-EFFECT-DT.                                         ELCACCTV
  7026         10  FILLER                    PIC 999.                   ELCACCTV
  7027         10  AM-EFF-CCYY               PIC 9(04).                 ELCACCTV
  7028         10  AM-EFF-CCYR  REDEFINES  AM-EFF-CCYY.                 ELCACCTV
  7029             15  AM-EFF-CC             PIC 99.                    ELCACCTV
  7030             15  AM-EFF-YR             PIC 99.                    ELCACCTV
  7031         10  AM-EFF-MO                 PIC 99.                    ELCACCTV
  7032         10  AM-EFF-DA                 PIC 99.                    ELCACCTV
  7033     05  WS-AM-EFFECT-DT-N REDEFINES                                 CL**3
  7034            WS-AM-EFFECT-DT            PIC 9(11).                    CL**4
  7035     05  WS-AM-PREV-EXP-DT.                                       ELCACCTV
  7036         10 FILLER                     PIC 999.                   ELCACCTV
  7037         10 AM-PREV-EXP-DT-CCYY        PIC 9(04).                 ELCACCTV
  7038         10 AM-PREV-EXP-DT-CCYR  REDEFINES  AM-PREV-EXP-DT-CCYY.  ELCACCTV
  7039            15 AM-PREV-EXP-DT-CC       PIC 99.                    ELCACCTV
  7040            15 AM-PREV-EXP-DT-YR       PIC 99.                    ELCACCTV
  7041         10 AM-PREV-EXP-MO             PIC 99.                    ELCACCTV
  7042         10 AM-PREV-EXP-DA             PIC 99.                    ELCACCTV
  7043     05  WS-AM-PREV-EXP-DT-N REDEFINES                               CL**3
  7044            WS-AM-PREV-EXP-DT          PIC 9(11).                    CL**3
  7045     05  WS-AM-PREV-EFF-DT.                                       ELCACCTV
  7046         10 FILLER                     PIC 999.                   ELCACCTV
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 138
* ECS010MO.cbl (/apps/prod/cid1p/copy/ELCACCTV)
  7047         10 AM-PREV-EFF-CCYY           PIC 9(04).                 ELCACCTV
  7048         10 AM-PREV-EFF-CCYR  REDEFINES  AM-PREV-EFF-CCYY.        ELCACCTV
  7049            15 AM-PREV-EFF-CC          PIC 99.                    ELCACCTV
  7050            15 AM-PREV-EFF-YR          PIC 99.                    ELCACCTV
  7051         10 AM-PREV-EFF-MO             PIC 99.                    ELCACCTV
  7052         10 AM-PREV-EFF-DA             PIC 99.                    ELCACCTV
  7053     05  WS-AM-PREV-EFF-DT-N REDEFINES                               CL**3
  7054            WS-AM-PREV-EFF-DT          PIC 9(11).                    CL**3
  7055     05  WS-AM-ANNIVERSARY-DATE.                                  ELCACCTV
  7056         10  FILLER                    PIC 999.                   ELCACCTV
  7057         10  AM-AN-CCYY                PIC 9(04).                 ELCACCTV
  7058         10  AM-AN-CCYR  REDEFINES  AM-AN-CCYY.                   ELCACCTV
  7059             15  AM-AN-CC              PIC 99.                    ELCACCTV
  7060             15  AM-AN-YR              PIC 99.                    ELCACCTV
  7061         10  AM-AN-MO                  PIC 99.                    ELCACCTV
  7062         10  AM-AN-DA                  PIC 99.                    ELCACCTV
  7063     05  WS-AM-ANNIVERSARY-DATE-N REDEFINES                          CL**3
  7064            WS-AM-ANNIVERSARY-DATE     PIC 9(11).                    CL**4
  7065     05  WS-AM-HI-CERT-DATE.                                      ELCACCTV
  7066         10  FILLER                    PIC 999.                   ELCACCTV
  7067         10  AM-HI-CCYY                PIC 9(04).                 ELCACCTV
  7068         10  AM-HI-CCYR  REDEFINES  AM-HI-CCYY.                   ELCACCTV
  7069             15  AM-HI-CC              PIC 99.                    ELCACCTV
  7070             15  AM-HI-YR              PIC 99.                    ELCACCTV
  7071         10  AM-HI-MO                  PIC 99.                    ELCACCTV
  7072         10  AM-HI-DA                  PIC 99.                    ELCACCTV
  7073     05  WS-AM-HI-CERT-DATE-N REDEFINES                              CL**3
  7074            WS-AM-HI-CERT-DATE         PIC 9(11).                    CL**3
  7075     05  WS-AM-LO-CERT-DATE.                                      ELCACCTV
  7076         10  FILLER                    PIC 999.                   ELCACCTV
  7077         10  AM-LO-CCYY                PIC 9(04).                 ELCACCTV
  7078         10  AM-LO-CCYR  REDEFINES  AM-LO-CCYY.                   ELCACCTV
  7079             15  AM-LO-CC              PIC 99.                    ELCACCTV
  7080             15  AM-LO-YR              PIC 99.                    ELCACCTV
  7081         10  AM-LO-MO                  PIC 99.                    ELCACCTV
  7082         10  AM-LO-DA                  PIC 99.                    ELCACCTV
  7083     05  WS-AM-LO-CERT-DATE-N REDEFINES                              CL**3
  7084            WS-AM-LO-CERT-DATE         PIC 9(11).                    CL**3
  7085     05  WS-AM-ENTRY-DATE.                                        ELCACCTV
  7086         10  FILLER                    PIC 999.                   ELCACCTV
  7087         10  AM-ENT-CCYY               PIC 9(04).                 ELCACCTV
  7088         10  AM-ENT-CCYR  REDEFINES  AM-ENT-CCYY.                 ELCACCTV
  7089             15  AM-ENT-CC             PIC 99.                    ELCACCTV
  7090             15  AM-ENT-YR             PIC 99.                    ELCACCTV
  7091         10  AM-ENT-MO                 PIC 99.                    ELCACCTV
  7092         10  AM-ENT-DA                 PIC 99.                    ELCACCTV
  7093     05  WS-AM-ENTRY-DATE-N REDEFINES                                CL**3
  7094            WS-AM-ENTRY-DATE           PIC 9(11).                    CL**3
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 139
* ECS010MO.cbl
* 7096                             COPY ELCEXTVR.
  7097******************************************************************04/15/98
  7098*                                                                *ELCEXTVR
  7099*                                                                *ELCEXTVR
  7100*                             ELCEXTVR                           *   LV002
  7101*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  7102*                            VMOD=2.001                          *ELCEXTVR
  7103*                                                                *ELCEXTVR
  7104*   WORKING STORAGE FOR DATE VARIABLES CREATED                   *ELCEXTVR
  7105*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCEXTVR
  7106*                                                                *ELCEXTVR
  7107******************************************************************ELCEXTVR
  7108 01  WS-CALL-EXTRACT-DATE.                                        ELCEXTVR
  7109     05  WS-EX-EFF-DATE.                                          ELCEXTVR
  7110         10  FILLER              PIC 999.                         ELCEXTVR
  7111         10  EX-EFF-DATE-CCYY    PIC 9(04).                       ELCEXTVR
  7112         10  EX-EFF-DATE-CCYR  REDEFINES  EX-EFF-DATE-CCYY.       ELCEXTVR
  7113             15  EX-EFF-DATE-CC  PIC 99.                          ELCEXTVR
  7114             15  EX-EFF-DATE-YR  PIC 99.                          ELCEXTVR
  7115         10  EX-EFF-DATE-MO      PIC 99.                          ELCEXTVR
  7116         10  EX-EFF-DATE-DA      PIC 99.                          ELCEXTVR
  7117     05  WS-EX-EFF-DATE-N REDEFINES                                  CL**2
  7118            WS-EX-EFF-DATE       PIC 9(11).                          CL**2
  7119 01  WS-DETAIL-EXTRACT-DATE.                                      ELCEXTVR
  7120     05  WS-DE-EFF.                                               ELCEXTVR
  7121         10  FILLER              PIC 999.                         ELCEXTVR
  7122         10  DE-EF-CCYY          PIC 9(04).                       ELCEXTVR
  7123         10  DE-EF-CCYR  REDEFINES  DE-EF-CCYY.                   ELCEXTVR
  7124             15  DE-EF-CC        PIC 99.                          ELCEXTVR
  7125             15  DE-EF-YR        PIC 99.                          ELCEXTVR
  7126         10  DE-EF-MO            PIC 99.                          ELCEXTVR
  7127         10  DE-EF-DA            PIC 99.                          ELCEXTVR
  7128     05  WS-DE-EFF-N REDEFINES                                       CL**2
  7129            WS-DE-EFF            PIC 9(11).                          CL**2
  7130     05  WS-DE-LF-CANC-DTE.                                       ELCEXTVR
  7131         10  FILLER              PIC 999.                         ELCEXTVR
  7132         10  DE-LF-CANC-CCYY     PIC 9(04).                       ELCEXTVR
  7133         10  DE-LF-CANC-CCYR  REDEFINES  DE-LF-CANC-CCYY.         ELCEXTVR
  7134             15  DE-LF-CANC-CC   PIC 99.                          ELCEXTVR
  7135             15  DE-LF-CANC-YR   PIC 99.                          ELCEXTVR
  7136         10  DE-LF-CANC-MO       PIC 99.                          ELCEXTVR
  7137         10  DE-LF-CANC-DA       PIC 99.                          ELCEXTVR
  7138     05  WS-DE-LF-CANC-DTE-N REDEFINES                               CL**2
  7139            WS-DE-LF-CANC-DTE       PIC 9(11).                       CL**2
  7140     05  WS-DE-LF-CANC-EXIT-DT.                                   ELCEXTVR
  7141         10  FILLER                 PIC 999.                      ELCEXTVR
  7142         10  DE-LF-CANC-EXIT-CCYY   PIC 9(04).                    ELCEXTVR
  7143         10  DE-LF-CANC-EXIT-CCYR REDEFINES DE-LF-CANC-EXIT-CCYY. ELCEXTVR
  7144             15  DE-LF-CANC-EXIT-CC PIC 99.                       ELCEXTVR
  7145             15  DE-LF-CANC-EXIT-YR PIC 99.                       ELCEXTVR
  7146         10  DE-LF-CANC-EXIT-MO     PIC 99.                       ELCEXTVR
  7147         10  DE-LF-CANC-EXIT-DA     PIC 99.                       ELCEXTVR
  7148     05  WS-DE-LF-CANC-EXIT-DT-N REDEFINES                           CL**3
  7149            WS-DE-LF-CANC-EXIT-DT   PIC 9(11).                       CL**2
  7150     05  WS-DE-AH-CANC-DTE.                                       ELCEXTVR
  7151         10  FILLER                 PIC 999.                      ELCEXTVR
  7152         10  DE-AH-CANC-CCYY        PIC 9(04).                    ELCEXTVR
  7153         10  DE-AH-CANC-CCYR  REDEFINES  DE-AH-CANC-CCYY.         ELCEXTVR
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 140
* ECS010MO.cbl (/apps/prod/cid1p/copy/ELCEXTVR)
  7154             15  DE-AH-CANC-CC      PIC 99.                       ELCEXTVR
  7155             15  DE-AH-CANC-YR      PIC 99.                       ELCEXTVR
  7156         10  DE-AH-CANC-MO          PIC 99.                       ELCEXTVR
  7157         10  DE-AH-CANC-DA          PIC 99.                       ELCEXTVR
  7158     05  WS-DE-AH-CANC-DTE-N REDEFINES                               CL**4
  7159            WS-DE-AH-CANC-DTE       PIC 9(11).                       CL**2
  7160     05  WS-DE-AH-CANC-EXIT-DT.                                   ELCEXTVR
  7161         10  FILLER                 PIC 999.                      ELCEXTVR
  7162         10  DE-AH-CANC-EXIT-CCYY   PIC 9(04).                    ELCEXTVR
  7163         10  DE-AH-CANC-EXIT-CCYR REDEFINES DE-AH-CANC-EXIT-CCYY. ELCEXTVR
  7164             15  DE-AH-CANC-EXIT-CC PIC 99.                       ELCEXTVR
  7165             15  DE-AH-CANC-EXIT-YR PIC 99.                       ELCEXTVR
  7166         10  DE-AH-CANC-EXIT-MO     PIC 99.                       ELCEXTVR
  7167         10  DE-AH-CANC-EXIT-DA     PIC 99.                       ELCEXTVR
  7168     05  WS-DE-AH-CANC-EXIT-DT-N REDEFINES                           CL**2
  7169            WS-DE-AH-CANC-EXIT-DT   PIC 9(11).                       CL**2
  7170     05  WS-DE-ENTRY-DTE.                                         ELCEXTVR
  7171         10  FILLER                 PIC 999.                      ELCEXTVR
  7172         10  DE-ENTRY-CCYY          PIC 9(04).                    ELCEXTVR
  7173         10  DE-ENTRY-CCYR  REDEFINES  DE-ENTRY-CCYY.             ELCEXTVR
  7174             15  DE-ENTRY-CC        PIC 99.                       ELCEXTVR
  7175             15  DE-ENTRY-YR        PIC 99.                       ELCEXTVR
  7176         10  DE-ENTRY-MO            PIC 99.                       ELCEXTVR
  7177         10  DE-ENTRY-DA            PIC 99.                       ELCEXTVR
  7178     05  WS-DE-ENTRY-DTE-N REDEFINES                                 CL**2
  7179            WS-DE-ENTRY-DTE         PIC 9(11).                       CL**2
  7180     05  WS-DE-PROC-DT.                                           ELCEXTVR
  7181         10  FILLER                 PIC 999.                      ELCEXTVR
  7182         10  DE-PD-CCYY             PIC 9(04).                    ELCEXTVR
  7183         10  DE-PD-CCYR  REDEFINES  DE-PD-CCYY.                   ELCEXTVR
  7184             15  DE-PD-CC           PIC 99.                       ELCEXTVR
  7185             15  DE-PD-YR           PIC 99.                       ELCEXTVR
  7186         10  DE-PD-MO               PIC 99.                       ELCEXTVR
  7187         10  DE-PD-DA               PIC 99.                       ELCEXTVR
  7188     05  WS-DE-PROC-DT-N REDEFINES                                   CL**2
  7189            WS-DE-PROC-DT           PIC 9(11).                       CL**2
  7190     05  WS-DE-CLM-PROC-DT REDEFINES WS-DE-PROC-DT.                  CL**5
  7191         10  FILLER                 PIC 999.                         CL**5
  7192         10  DE-CP-CCYY             PIC 9(04).                       CL**5
  7193         10  DE-CP-CCYR  REDEFINES  DE-CP-CCYY.                      CL**6
  7194             15  DE-CP-CC           PIC 99.                          CL**5
  7195             15  DE-CP-YR           PIC 99.                          CL**5
  7196         10  DE-CP-MO               PIC 99.                          CL**5
  7197         10  DE-CP-DA               PIC 99.                          CL**5
  7198     05  WS-DE-CLM-PROC-DT-N REDEFINES                               CL**5
  7199            WS-DE-CLM-PROC-DT              PIC 9(11).                CL**5
  7200     05  WS-DE-RSV-PROC-DT REDEFINES WS-DE-PROC-DT.                  CL**5
  7201         10  FILLER                 PIC 999.                         CL**5
  7202         10  DE-RP-CCYY             PIC 9(04).                       CL**5
  7203         10  DE-RP-CCYR  REDEFINES  DE-RP-CCYY.                      CL**6
  7204             15  DE-RP-CC           PIC 99.                          CL**5
  7205             15  DE-RP-YR           PIC 99.                          CL**5
  7206         10  DE-RP-MO                      PIC 99.                   CL**5
  7207         10  DE-RP-DA                      PIC 99.                   CL**5
  7208     05  WS-DE-RSV-PROC-DT-N REDEFINES                               CL**5
  7209            WS-DE-RSV-PROC-DT              PIC 9(11).                CL**5
  7210     05  WS-DE-INCUR.                                             ELCEXTVR
  7211         10  FILLER                 PIC 999.                      ELCEXTVR
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 141
* ECS010MO.cbl (/apps/prod/cid1p/copy/ELCEXTVR)
  7212         10  DE-INCUR-CCYY          PIC 9(04).                    ELCEXTVR
  7213         10  DE-INCUR-CCYR  REDEFINES  DE-INCUR-CCYY.             ELCEXTVR
  7214             15  DE-INCUR-CC        PIC 99.                       ELCEXTVR
  7215             15  DE-INCUR-YR        PIC 99.                       ELCEXTVR
  7216         10  DE-INCUR-MO            PIC 99.                       ELCEXTVR
  7217         10  DE-INCUR-DA            PIC 99.                       ELCEXTVR
  7218     05  WS-DE-INCUR-N REDEFINES                                     CL**2
  7219            WS-DE-INCUR             PIC 9(11).                       CL**2
  7220     05  WS-DE-PAY.                                               ELCEXTVR
  7221         10  FILLER                 PIC 999.                      ELCEXTVR
  7222         10  DE-PAY-CCYY            PIC 9(04).                    ELCEXTVR
  7223         10  DE-PAY-CCYR  REDEFINES  DE-PAY-CCYY.                 ELCEXTVR
  7224             15  DE-PAY-CC          PIC 99.                       ELCEXTVR
  7225             15  DE-PAY-YR          PIC 99.                       ELCEXTVR
  7226         10  DE-PAY-MO              PIC 99.                       ELCEXTVR
  7227         10  DE-PAY-DA              PIC 99.                       ELCEXTVR
  7228     05  WS-DE-PAY-N REDEFINES                                       CL**2
  7229            WS-DE-PAY               PIC 9(11).                       CL**2
  7230     05  WS-DE-PAID-TO.                                           ELCEXTVR
  7231         10  FILLER                 PIC 999.                      ELCEXTVR
  7232         10  DE-PTO-CCYY            PIC 9(04).                    ELCEXTVR
  7233         10  DE-PTO-CCYR  REDEFINES  DE-PTO-CCYY.                 ELCEXTVR
  7234             15  DE-PTO-CC          PIC 99.                       ELCEXTVR
  7235             15  DE-PTO-YR          PIC 99.                       ELCEXTVR
  7236         10  DE-PTO-MO              PIC 99.                       ELCEXTVR
  7237         10  DE-PTO-DA              PIC 99.                       ELCEXTVR
  7238     05  WS-DE-PAID-TO-N REDEFINES                                   CL**2
  7239            WS-DE-PAID-TO           PIC 9(11).                       CL**2
  7240     05  WS-DE-ACC-EXP-DTE.                                       ELCEXTVR
  7241         10 FILLER                  PIC 999.                      ELCEXTVR
  7242         10 DE-ACC-EXP-CCYY         PIC 9(04).                    ELCEXTVR
  7243         10 DE-ACC-EXP-CCYR  REDEFINES  DE-ACC-EXP-CCYY.          ELCEXTVR
  7244            15 DE-ACC-EXP-CC        PIC 99.                       ELCEXTVR
  7245            15 DE-ACC-EXP-YR        PIC 99.                       ELCEXTVR
  7246         10 DE-ACC-EXP-MO           PIC 99.                       ELCEXTVR
  7247         10 DE-ACC-EXP-DA           PIC 99.                       ELCEXTVR
  7248     05  WS-DE-ACC-EXP-DTE-N REDEFINES                               CL**2
  7249            WS-DE-ACC-EXP-DTE       PIC 9(11).                       CL**2
  7250     05  WS-DE-ACC-EFF-DTE.                                       ELCEXTVR
  7251         10 FILLER                  PIC 999.                      ELCEXTVR
  7252         10 DE-ACC-EFF-CCYY         PIC 9(04).                    ELCEXTVR
  7253         10 DE-ACC-EFF-CCYR  REDEFINES  DE-ACC-EFF-CCYY.          ELCEXTVR
  7254            15 DE-ACC-EFF-CC        PIC 99.                       ELCEXTVR
  7255            15 DE-ACC-EFF-YR        PIC 99.                       ELCEXTVR
  7256         10 DE-ACC-EFF-MO           PIC 99.                       ELCEXTVR
  7257         10 DE-ACC-EFF-DA           PIC 99.                       ELCEXTVR
  7258     05  WS-DE-ACC-EFF-DTE-N REDEFINES                               CL**2
  7259            WS-DE-ACC-EFF-DTE       PIC 9(11).                       CL**2
  7260     05  WS-DE-RSV-INCUR.                                         ELCEXTVR
  7261         10  FILLER                 PIC 999.                      ELCEXTVR
  7262         10  DE-RSV-INCUR-CCYY      PIC 9(04).                    ELCEXTVR
  7263         10  DE-RSV-INCUR-CCYR  REDEFINES  DE-RSV-INCUR-CCYY.     ELCEXTVR
  7264             15  DE-RSV-INCUR-CC    PIC 99.                       ELCEXTVR
  7265             15  DE-RSV-INCUR-YR    PIC 99.                       ELCEXTVR
  7266         10  DE-RSV-INCUR-MO        PIC 99.                       ELCEXTVR
  7267         10  DE-RSV-INCUR-DA        PIC 99.                       ELCEXTVR
  7268     05  WS-DE-RSV-INCUR-N REDEFINES                                 CL**2
  7269            WS-DE-RSV-INCUR         PIC 9(11).                       CL**2
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 142
* ECS010MO.cbl (/apps/prod/cid1p/copy/ELCEXTVR)
  7270     05  WS-DE-RSV-PAYTO.                                         ELCEXTVR
  7271         10  FILLER                 PIC 999.                      ELCEXTVR
  7272         10  DE-RSV-PAYTO-CCYY      PIC 9(04).                    ELCEXTVR
  7273         10  DE-RSV-PAYTO-CCYR  REDEFINES  DE-RSV-PAYTO-CCYY.     ELCEXTVR
  7274             15  DE-RSV-PAYTO-CC    PIC 99.                       ELCEXTVR
  7275             15  DE-RSV-PAYTO-YR    PIC 99.                       ELCEXTVR
  7276         10  DE-RSV-PAYTO-MO        PIC 99.                       ELCEXTVR
  7277         10  DE-RSV-PAYTO-DA        PIC 99.                       ELCEXTVR
  7278     05  WS-DE-RSV-PAYTO-N REDEFINES                                 CL**2
  7279            WS-DE-RSV-PAYTO         PIC 9(11).                       CL**2
  7280     05  WS-DE-ACC-EXP-DTE-RSV.                                   ELCEXTVR
  7281         10  FILLER                        PIC 999.               ELCEXTVR
  7282         10  DE-ACC-EXP-DTE-RSV-CCYY       PIC 9(04).             ELCEXTVR
  7283         10  DE-ACC-EXP-DTE-RSV-CCYR REDEFINES                    ELCEXTVR
  7284                             DE-ACC-EXP-DTE-RSV-CCYY.             ELCEXTVR
  7285             15  DE-ACC-EXP-DTE-RSV-CC     PIC 99.                ELCEXTVR
  7286             15  DE-ACC-EXP-DTE-RSV-YR     PIC 99.                ELCEXTVR
  7287         10  DE-ACC-EXP-DTE-RSV-MO         PIC 99.                ELCEXTVR
  7288         10  DE-ACC-EXP-DTE-RSV-DA         PIC 99.                ELCEXTVR
  7289     05  WS-DE-ACC-EXP-DTE-RSV-N REDEFINES                           CL**2
  7290            WS-DE-ACC-EXP-DTE-RSV          PIC 9(11).                CL**2
  7291     05  WS-DE-ACC-EFF-DTE-RSV.                                   ELCEXTVR
  7292         10  FILLER                        PIC 999.               ELCEXTVR
  7293         10  DE-ACC-EFF-DTE-RSV-CCYY       PIC 9(04).             ELCEXTVR
  7294         10  DE-ACC-EFF-DTE-RSV-CCYR  REDEFINES                   ELCEXTVR
  7295                                DE-ACC-EFF-DTE-RSV-CCYY.          ELCEXTVR
  7296             15  DE-ACC-EFF-DTE-RSV-CC     PIC 99.                ELCEXTVR
  7297             15  DE-ACC-EFF-DTE-RSV-YR     PIC 99.                ELCEXTVR
  7298         10  DE-ACC-EFF-DTE-RSV-MO         PIC 99.                ELCEXTVR
  7299         10  DE-ACC-EFF-DTE-RSV-DA         PIC 99.                ELCEXTVR
  7300     05  WS-DE-ACC-EFF-DTE-RSV-N REDEFINES                           CL**2
  7301            WS-DE-ACC-EFF-DTE-RSV          PIC 9(11).                CL**2
  7302                                                                     CL**5
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 143
* ECS010MO.cbl
  7304 PROCEDURE DIVISION.
  7305
  7306 0000-START.
  7307
  7308******************************************************************
  7309***        D A T E   C A R D   L O A D   R O U T I N E         ***
  7310******************************************************************
  7311
  7312*0003-LOAD-DATE-CARD.
* 7313                             COPY ELCDTERX.
  7314******************************************************************04/15/98
  7315*                                                                *ELCDTERX
  7316*                                                                *ELCDTERX
  7317*                            ELCDTERX.                           *   LV002
  7318*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  7319*                            VMOD=2.007                          *ELCDTERX
  7320*                                                                *ELCDTERX
  7321*      LOAD DATE CARD DISK FILE INTO WORKING STORAGE AREA        *ELCDTERX
  7322*      (COPY CODE FOR W/S = ELCDTECX AND COPY CODE FOR FD        *ELCDTERX
  7323*      = ELCDTEFD)                                               *ELCDTERX
  7324*                                                                *ELCDTERX
  7325******************************************************************ELCDTERX
  7326                                                                  ELCDTERX
  7327     ACCEPT WS-ACCEPT-DATE       FROM  DATE.                      ELCDTERX
  7328                                                                  ELCDTERX
  7329     MOVE WS-AD-YY               TO  WS-CD-YY.                    ELCDTERX
  7330     MOVE WS-AD-MM               TO  WS-CD-MM.                    ELCDTERX
  7331     MOVE WS-AD-DD               TO  WS-CD-DD.                    ELCDTERX
  7332                                                                  ELCDTERX
  7333     ACCEPT WS-TIME-OF-DAY       FROM  TIME.                      ELCDTERX
  7334                                                                  ELCDTERX
  7335******************************************************************ELCDTERX
  7336*    NOTE: THE FOLLOWING STATEMENT IS USED TO ELIMINATE COB II    ELCDTERX
  7337*          WARNING MESSAGES.                                      ELCDTERX
  7338******************************************************************ELCDTERX
  7339     IF WS-CD-YY = LOW-VALUES                                     ELCDTERX
  7340         COMPUTE PGM-SUB = PGM-SUB + 1.                           ELCDTERX
  7341                                                                  ELCDTERX
  7342     OPEN INPUT DISK-DATE.                                        ELCDTERX
  7343                                                                  ELCDTERX
  7344     MOVE SPACE TO DATE-CARD         CLAS-BUSINESS-CLASSES        ELCDTERX
  7345                   STATE-NAMES       CLAS-MORTALITY-CODES         ELCDTERX
  7346                   CLAS-INS-TYPES    COMPANY-NAME-TABLE           ELCDTERX
  7347                   DATE-CARD-OPTIONS DATE-CARD-FACTORS            ELCDTERX
  7348                   CLAX-ID           CLAS-MISC                    ELCDTERX
  7349                   CARRIER-NAMES     CLASIC-SYSTEM-CODES          ELCDTERX
  7350                   CARRIER-OPT-CLAIM-DATA                         ELCDTERX
  7351                   STATE-TARGET-LOSS-RATIOS                       ELCDTERX
  7352                   BUSINESS-TRGT-LOSS-RATIO-MODS                  ELCDTERX
  7353                   MISC-OPT-CLM-RSV-DATA.                         ELCDTERX
  7354                                                                  ELCDTERX
  7355     MOVE LOW-VALUES TO CLAS-INDEX-TBL CLAS-TYPE-MISC.            ELCDTERX
  7356                                                                  ELCDTERX
  7357     MOVE ZERO TO CLAS-CN DTE-TOT-LINES CLAS-CO                   ELCDTERX
  7358                  INDEXCA INDEXBS INDEXST.                        ELCDTERX
  7359                                                                  ELCDTERX
  7360     COMPUTE CLAS-CN = PGM-SUB / +50.                             ELCDTERX
  7361     COMPUTE CLAS-CO = PGM-SUB / +20.                             ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 144
* ECS010MO.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  7362     COMPUTE CLAS-INDEXEN = PGM-SUB - (CLAS-CN * +50).            ELCDTERX
  7363     COMPUTE CLAS-INDEXON = PGM-SUB - (CLAS-CO * +20).            ELCDTERX
  7364                                                                  ELCDTERX
  7365     IF CLAS-INDEXEN = ZERO                                       ELCDTERX
  7366         MOVE +50               TO CLAS-INDEXEN                   ELCDTERX
  7367     ELSE                                                         ELCDTERX
  7368         ADD +1                 TO CLAS-CN.                       ELCDTERX
  7369                                                                  ELCDTERX
  7370     IF CLAS-INDEXON = ZERO                                       ELCDTERX
  7371         MOVE +20               TO CLAS-INDEXON                   ELCDTERX
  7372     ELSE                                                         ELCDTERX
  7373         ADD +1                 TO CLAS-CO.                       ELCDTERX
  7374                                                                  ELCDTERX
  7375 0005-READ--CARD.                                                 ELCDTERX
  7376     READ DISK-DATE                                               ELCDTERX
  7377         AT END CLOSE DISK-DATE                                   ELCDTERX
  7378             GO TO 0060-READ--TEST.                               ELCDTERX
  7379                                                                  ELCDTERX
  7380     MOVE ZERO                   TO CLAS-INDEX.                   ELCDTERX
  7381                                                                  ELCDTERX
  7382     IF DD-ID = 'CLAS' OR 'LIFE' OR 'GLED'                        ELCDTERX
  7383         MOVE DATE-DISK          TO DATE-CARD                     ELCDTERX
  7384         MOVE RUN-DATE           TO WS-RUN-DATE-N                    CL**2
  7385         MOVE EP-DT              TO WS-EP-DT-N                       CL**2
  7386         GO TO 0005-READ--CARD.                                   ELCDTERX
  7387                                                                  ELCDTERX
  7388     IF DD-ID = 'CLAD'                                            ELCDTERX
  7389         MOVE DATE-DISK          TO DATE-CARD-OPTIONS             ELCDTERX
  7390         GO TO 0005-READ--CARD.                                   ELCDTERX
  7391                                                                  ELCDTERX
  7392     IF DD-ID = 'CLAX'                                            ELCDTERX
  7393         MOVE DATE-DISK          TO CLAS-INDEX-TBL                ELCDTERX
  7394         GO TO 0005-READ--CARD.                                   ELCDTERX
  7395                                                                  ELCDTERX
  7396     IF DD-ID = 'CLAF'                                            ELCDTERX
  7397         MOVE DATE-DISK          TO DATE-CARD-FACTORS             ELCDTERX
  7398         GO TO 0005-READ--CARD.                                   ELCDTERX
  7399                                                                  ELCDTERX
  7400     IF DD-ID = 'CLAC'                                            ELCDTERX
  7401         GO TO 0010-READ--CLAC.                                   ELCDTERX
  7402                                                                  ELCDTERX
  7403     IF DD-ID = 'CARR'                                            ELCDTERX
  7404         GO TO 0015-READ--CARR.                                   ELCDTERX
  7405                                                                  ELCDTERX
  7406     IF DD-ID = 'STAT'                                            ELCDTERX
  7407         GO TO 0020-READ--STAT.                                   ELCDTERX
  7408                                                                  ELCDTERX
  7409     IF DD-ID = 'BUSC'                                            ELCDTERX
  7410         GO TO 0025-READ--BUSC.                                   ELCDTERX
  7411                                                                  ELCDTERX
  7412     IF DD-ID = 'MORT'                                            ELCDTERX
  7413         GO TO 0030-READ--MORT.                                   ELCDTERX
  7414                                                                  ELCDTERX
  7415     IF DD-ID = 'CLAI'                                            ELCDTERX
  7416         GO TO 0040-READ--CLAI.                                   ELCDTERX
  7417                                                                  ELCDTERX
  7418     IF DD-ID = 'COLC'                                            ELCDTERX
  7419         GO TO 0065-READ--COLC.                                   ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 145
* ECS010MO.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  7420                                                                  ELCDTERX
  7421     IF DD-IDX NUMERIC AND                                        ELCDTERX
  7422        DD-IDA = 'CL'                                             ELCDTERX
  7423         GO TO 0035-READ--CLXX.                                   ELCDTERX
  7424                                                                  ELCDTERX
  7425     IF DD-IDX NUMERIC AND                                        ELCDTERX
  7426        DD-IDA = 'PO'                                             ELCDTERX
  7427         GO TO 0050-READ--POXX.                                   ELCDTERX
  7428                                                                  ELCDTERX
  7429     IF DD-ID = 'OPCA'                                            ELCDTERX
  7430         GO TO 0070-READ--OPCA.                                   ELCDTERX
  7431                                                                  ELCDTERX
  7432     IF DD-ID = 'OPST'                                            ELCDTERX
  7433         GO TO 0072-READ--OPST.                                   ELCDTERX
  7434                                                                  ELCDTERX
  7435     IF DD-ID = 'OPBS'                                            ELCDTERX
  7436         GO TO 0074-READ--OPBS.                                   ELCDTERX
  7437                                                                  ELCDTERX
  7438     IF DD-ID = 'OPMS'                                            ELCDTERX
  7439         MOVE DD-MISC-DATA       TO MISC-OPT-CLM-RSV-DATA.        ELCDTERX
  7440                                                                  ELCDTERX
  7441     GO TO 0005-READ--CARD.                                       ELCDTERX
  7442                                                                  ELCDTERX
  7443 0010-READ--CLAC.                                                 ELCDTERX
  7444     ADD 1                       TO CLAS-INDEXC.                  ELCDTERX
  7445     MOVE DD-CR1                 TO CNT-ID (CLAS-INDEXC).         ELCDTERX
  7446     MOVE DD-CR1N                TO CNT-NAME (CLAS-INDEXC).       ELCDTERX
  7447     ADD 1                       TO CLAS-INDEXC.                  ELCDTERX
  7448     MOVE DD-CR2                 TO CNT-ID (CLAS-INDEXC).         ELCDTERX
  7449     MOVE DD-CR2N                TO CNT-NAME (CLAS-INDEXC).       ELCDTERX
  7450     GO TO 0005-READ--CARD.                                       ELCDTERX
  7451                                                                  ELCDTERX
  7452 0015-READ--CARR.                                                 ELCDTERX
  7453     ADD 1  TO  CLAS-INDEXCN.                                     ELCDTERX
  7454     IF CLAS-INDEXCN LESS THAN +26                                ELCDTERX
  7455        MOVE DD-CARR1         TO CARRIER-SUB (CLAS-INDEXCN)
  7456        MOVE DD-CARR1S        TO CARRIER-DOM-ST (CLAS-INDEXCN)
  7457        MOVE DD-CARR1N        TO CARRIER-PIC (CLAS-INDEXCN)
  7458        MOVE DD-CARR1-UEP-PCT TO CARRIER-UEP-PCT (CLAS-INDEXCN)
  7459        MOVE DD-CARR1-R78-PCT TO CARRIER-R78-PCT (CLAS-INDEXCN)
  7460        MOVE DD-CARR1-PRO-PCT TO CARRIER-PRO-PCT (CLAS-INDEXCN)
  7461        MOVE DD-CARR1-SECPAY-SW
  7462                               TO CARRIER-SEC-PAY (CLAS-INDEXCN)
  7463     END-IF
  7464                                                                  ELCDTERX
  7465     ADD 1  TO  CLAS-INDEXCN.                                     ELCDTERX
  7466     IF CLAS-INDEXCN LESS THAN +26                                ELCDTERX
  7467        MOVE DD-CARR2         TO CARRIER-SUB (CLAS-INDEXCN)
  7468        MOVE DD-CARR2S        TO CARRIER-DOM-ST (CLAS-INDEXCN)
  7469        MOVE DD-CARR2N        TO CARRIER-PIC (CLAS-INDEXCN)
  7470        MOVE DD-CARR2-UEP-PCT TO CARRIER-UEP-PCT (CLAS-INDEXCN)
  7471        MOVE DD-CARR2-R78-PCT TO CARRIER-R78-PCT (CLAS-INDEXCN)
  7472        MOVE DD-CARR2-PRO-PCT TO CARRIER-PRO-PCT (CLAS-INDEXCN)
  7473        MOVE DD-CARR2-SECPAY-SW
  7474                              TO CARRIER-SEC-PAY (CLAS-INDEXCN)
  7475     END-IF
  7476                                                                  ELCDTERX
  7477                                                                  ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 146
* ECS010MO.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  7478     GO TO 0005-READ--CARD.                                       ELCDTERX
  7479                                                                  ELCDTERX
  7480 0020-READ--STAT.                                                 ELCDTERX
  7481     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  7482     IF CLAS-INDEX GREATER 3  OR                                  ELCDTERX
  7483        DD-ST (CLAS-INDEX) = SPACE                                ELCDTERX
  7484         GO TO 0005-READ--CARD.                                   ELCDTERX
  7485                                                                  ELCDTERX
  7486     ADD 1                       TO CLAS-INDEXS.                  ELCDTERX
  7487     MOVE DD-ST (CLAS-INDEX)     TO STATE-NAME-FLD (CLAS-INDEXS). ELCDTERX
  7488     GO TO 0020-READ--STAT.                                       ELCDTERX
  7489                                                                  ELCDTERX
  7490 0025-READ--BUSC.                                                 ELCDTERX
  7491     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  7492     IF CLAS-INDEX GREATER 3  OR                                  ELCDTERX
  7493        DD-ST (CLAS-INDEX) = SPACE                                ELCDTERX
  7494         GO TO 0005-READ--CARD.                                   ELCDTERX
  7495                                                                  ELCDTERX
  7496     ADD 1                       TO CLAS-INDEXB.                  ELCDTERX
  7497     MOVE DD-ST (CLAS-INDEX)     TO CLAS-BUSC-FLD (CLAS-INDEXB).  ELCDTERX
  7498     GO TO 0025-READ--BUSC.                                       ELCDTERX
  7499                                                                  ELCDTERX
  7500 0030-READ--MORT.                                                 ELCDTERX
  7501     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  7502     IF CLAS-INDEX GREATER 2  OR                                  ELCDTERX
  7503        DD-MORT (CLAS-INDEX) = SPACE                              ELCDTERX
  7504         GO TO 0005-READ--CARD.                                   ELCDTERX
  7505                                                                  ELCDTERX
  7506     ADD 1                       TO CLAS-INDEXM.                  ELCDTERX
  7507     MOVE DD-MORT (CLAS-INDEX)   TO CLAS-MORT-FLD (CLAS-INDEXM).  ELCDTERX
  7508     GO TO 0030-READ--MORT.                                       ELCDTERX
  7509                                                                  ELCDTERX
  7510 0035-READ--CLXX.                                                 ELCDTERX
  7511     IF DD-IDX NOT = CLAS-CN                                      ELCDTERX
  7512          GO TO 0005-READ--CARD.                                  ELCDTERX
  7513                                                                  ELCDTERX
  7514     IF DD-PS-PIC (CLAS-INDEXEN) = 'X'                            ELCDTERX
  7515         DISPLAY '***********************************************'ELCDTERX
  7516         DISPLAY 'PROGRAM ECS-', PGM-SUB, ' NOT SCHEDULED TO RUN' ELCDTERX
  7517         DISPLAY '***********************************************'ELCDTERX
  7518         GO TO 0055-READ--STOP.                                   ELCDTERX
  7519                                                                  ELCDTERX
  7520     IF DD-PS-PIC (CLAS-INDEXEN) NOT LESS 'A'  AND                ELCDTERX
  7521        DD-PS-PIC (CLAS-INDEXEN) NOT GREATER 'I'                  ELCDTERX
  7522         MOVE '1'                TO DTE-FICH.                     ELCDTERX
  7523                                                                  ELCDTERX
  7524     IF DD-PS-PIC (CLAS-INDEXEN) NOT LESS 'J'  AND                ELCDTERX
  7525        DD-PS-PIC (CLAS-INDEXEN) NOT GREATER 'R'                  ELCDTERX
  7526         MOVE '2'                TO DTE-FICH.                     ELCDTERX
  7527                                                                  ELCDTERX
  7528*    MOVE DD-PS-PIC (CLAS-INDEXEN) TO DTE-PGM-OPT.                ELCDTERX
  7529     GO TO 0005-READ--CARD.                                       ELCDTERX
  7530                                                                  ELCDTERX
  7531 0040-READ--CLAI.                                                 ELCDTERX
  7532     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  7533     IF CLAS-INDEX GREATER 2  OR                                  ELCDTERX
  7534        DD-TYPE (CLAS-INDEX) = SPACE                              ELCDTERX
  7535         GO TO 0005-READ--CARD.                                   ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 147
* ECS010MO.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  7536                                                                  ELCDTERX
  7537     ADD 1                       TO CLAS-INDEXA.                  ELCDTERX
  7538     MOVE DD-TYPE (CLAS-INDEX) TO CLAS-ALL-TYPES (CLAS-INDEXA).   ELCDTERX
  7539     GO TO 0040-READ--CLAI.                                       ELCDTERX
  7540                                                                  ELCDTERX
  7541 0045-READ--DUMP.                                                 ELCDTERX
  7542     MOVE +999 TO WS-RETURN-CODE                                  ELCDTERX
  7543     MOVE 'MISSING AND/OR INVALID CLAS DATE CARD'                 ELCDTERX
  7544                                 TO  WS-ABEND-MESSAGE             ELCDTERX
  7545     PERFORM ABEND-PGM.                                           ELCDTERX
  7546                                                                  ELCDTERX
  7547 0050-READ--POXX.                                                 ELCDTERX
  7548     IF DD-IDX NOT = CLAS-CO                                      ELCDTERX
  7549         GO TO 0005-READ--CARD.                                   ELCDTERX
  7550                                                                  ELCDTERX
  7551     IF DD-PS-PRC (CLAS-INDEXON) = 'X'                            ELCDTERX
  7552         DISPLAY '***********************************************'ELCDTERX
  7553         DISPLAY 'ECS - ', PGM-SUB, ' IS NOT SCHEDULED TO RUN'    ELCDTERX
  7554         DISPLAY '***********************************************'ELCDTERX
  7555         GO TO 0055-READ--STOP.                                   ELCDTERX
  7556                                                                  ELCDTERX
  7557     MOVE DD-PS-PRT (CLAS-INDEXON) TO DTE-PRT-OPT.                ELCDTERX
  7558     MOVE DD-PS-FMT (CLAS-INDEXON) TO DTE-FMT-OPT.                ELCDTERX
  7559     MOVE DD-PS-PRC (CLAS-INDEXON) TO DTE-PRC-OPT DTE-PGM-OPT.    ELCDTERX
  7560     MOVE DD-PS-TOT (CLAS-INDEXON) TO DTE-TOT-OPT.                ELCDTERX
  7561                                                                  ELCDTERX
  7562     IF DTE-PRT-OPT = 'B'                                         ELCDTERX
  7563         MOVE '2'                  TO DTE-FICH.                   ELCDTERX
  7564     IF DTE-PRT-OPT = 'F'                                         ELCDTERX
  7565         MOVE '1'                  TO DTE-FICH.                   ELCDTERX
  7566                                                                  ELCDTERX
  7567     GO TO 0005-READ--CARD.                                       ELCDTERX
  7568                                                                  ELCDTERX
  7569 0055-READ--STOP.                                                 ELCDTERX
  7570     GOBACK.                                                      ELCDTERX
  7571                                                                  ELCDTERX
  7572 0060-READ--TEST.                                                 ELCDTERX
  7573     IF DATX-COD        = SPACE  OR                               ELCDTERX
  7574        CLAX-ID         = SPACE  OR                               ELCDTERX
  7575        DATE-OPTIONS-ID = SPACE                                   ELCDTERX
  7576         GO TO 0045-READ--DUMP.                                   ELCDTERX
  7577                                                                  ELCDTERX
  7578     MOVE LOW-VALUE TO CLAS-TYPE-MISC.                            ELCDTERX
  7579     GO TO 0079-READ--EXIT.                                       ELCDTERX
  7580                                                                  ELCDTERX
  7581 0065-READ--COLC.                                                 ELCDTERX
  7582     MOVE DATE-DISK              TO CLASIC-SYSTEM-CODES.          ELCDTERX
  7583     GO TO 0005-READ--CARD.                                       ELCDTERX
  7584                                                                  ELCDTERX
  7585 0070-READ--OPCA.                                                 ELCDTERX
  7586                                                                  ELCDTERX
  7587     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  7588                                                                  ELCDTERX
  7589     IF  CLAS-INDEX GREATER 13                                    ELCDTERX
  7590             OR                                                   ELCDTERX
  7591         DD-CARR-FLDS (CLAS-INDEX) = SPACE                        ELCDTERX
  7592         GO TO 0005-READ--CARD.                                   ELCDTERX
  7593                                                                  ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 148
* ECS010MO.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  7594     ADD 1                       TO INDEXCA.                      ELCDTERX
  7595     MOVE DD-CARR-FLDS (CLAS-INDEX)                               ELCDTERX
  7596                                 TO CARRIER-FLDS (INDEXCA).       ELCDTERX
  7597     GO TO 0070-READ--OPCA.                                       ELCDTERX
  7598                                                                  ELCDTERX
  7599 0072-READ--OPST.                                                 ELCDTERX
  7600                                                                  ELCDTERX
  7601     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  7602                                                                  ELCDTERX
  7603     IF  CLAS-INDEX GREATER 16                                    ELCDTERX
  7604             OR                                                   ELCDTERX
  7605         DD-TLR (CLAS-INDEX) = SPACE                              ELCDTERX
  7606         GO TO 0005-READ--CARD.                                   ELCDTERX
  7607                                                                  ELCDTERX
  7608     ADD 1                       TO INDEXST.                      ELCDTERX
  7609     MOVE DD-STATE-FLDS (CLAS-INDEX)                              ELCDTERX
  7610                                 TO STATE-TLR-FLD (INDEXST).      ELCDTERX
  7611     GO TO 0072-READ--OPST.                                       ELCDTERX
  7612                                                                  ELCDTERX
  7613 0074-READ--OPBS.                                                 ELCDTERX
  7614                                                                  ELCDTERX
  7615     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  7616                                                                  ELCDTERX
  7617     IF  CLAS-INDEX GREATER 32                                    ELCDTERX
  7618             OR                                                   ELCDTERX
  7619         DD-TLR (CLAS-INDEX) = SPACE                              ELCDTERX
  7620         GO TO 0005-READ--CARD.                                   ELCDTERX
  7621                                                                  ELCDTERX
  7622     ADD 1                       TO INDEXBS.                      ELCDTERX
  7623     MOVE DD-TLR (CLAS-INDEX)    TO BUS-TLRM-FLD (INDEXBS).       ELCDTERX
  7624     GO TO 0074-READ--OPBS.                                       ELCDTERX
  7625                                                                  ELCDTERX
  7626 0079-READ--EXIT.                                                 ELCDTERX
  7627*    EXIT.                                                        ELCDTERX
  7628******************************************************************ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 149
* ECS010MO.cbl
  7630******************************************************************
  7631***           O P E N   F I L E S   R O U T I N E              ***
  7632******************************************************************
  7633
  7634     DISPLAY ' '.
  7635     DISPLAY '****** THE FOLLOWING MESSAGES WERE CREATED BY '
  7636         'ECS010 ******'
  7637     DISPLAY ' '.
  7638
  7639     MOVE FUNCTION CURRENT-DATE  TO FUNCTION-DATE
  7640     MOVE 'Y'                    TO DC-FORCE-EL310-DATE-SW
  7641     MOVE FUNCTION-DATE          TO DC-EL310-DATE
  7642     .
  7643 0080-OPEN-FILES.
  7644*    IF DTE-PGM-OPT = '1'
  7645*       open output detail-extr
  7646*    end-if
  7647     OPEN INPUT  PENDING-EXTRACT
  7648                 CERT-MASTER-IN
  7649                 ERACCTT-IN
  7650                 ERAGTC
  7651
  7652          I-O    ERMEBL-INOUT
  7653                 ELCRTT
  7654
  7655          OUTPUT SUMMARY-EXTR
  7656                 ME-ECS010-BALANCE
  7657                 ME50-ECS010-BALANCE
  7658                 DISPLAY-PRT
  7659                 MISMATCH-REPORT
  7660                 PRINT-COPY.
  7661
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 150
* ECS010MO.cbl
  7663*START*************CUSTOM CODE FOR CLIENT "DMD"*************
  7664     IF DTE-CLIENT NOT = 'DMD'
  7665         NEXT SENTENCE
  7666     ELSE
  7667         OPEN INPUT ERRESC-IN
  7668            IF ERRESC-FILE-STATUS   = '00' OR '97'
  7669                NEXT SENTENCE
  7670            ELSE
  7671                MOVE ERRESC-FILE-STATUS TO WS-ABEND-FILE-STATUS
  7672                MOVE 'ERROR OPENING ERRESC FILE'
  7673                                        TO WS-ABEND-MESSAGE
  7674                GO TO ABEND-PGM.
  7675*END***************CUSTOM CODE FOR CLIENT "DMD"*************
  7676
  7677     IF ERACCTT-FILE-STATUS  = '00'  OR  '97'
  7678         NEXT SENTENCE
  7679       ELSE
  7680         MOVE '11'                    TO ABEND-CODE-1
  7681         MOVE ERACCTT-FILE-STATUS     TO ABEND-CODE-2
  7682         MOVE WS-ABEND-CODE           TO WS-RETURN-CODE
  7683         GO TO ABEND-PGM.
  7684
  7685     IF ELCRTT-FILE-STATUS  = '00'  OR  '97'
  7686        CONTINUE
  7687     ELSE
  7688        DISPLAY ' OPEN ERROR ELCRTT '
  7689        MOVE '31'                TO ABEND-CODE-1
  7690        MOVE ELCRTT-FILE-STATUS  TO ABEND-CODE-2
  7691        MOVE WS-ABEND-CODE       TO WS-RETURN-CODE
  7692        GO TO ABEND-PGM
  7693     END-IF
  7694
  7695     IF ERAGTC-FILE-STATUS  = '00'  OR  '97'
  7696        CONTINUE
  7697     ELSE
  7698        DISPLAY ' OPEN ERROR ERAGTC '
  7699        MOVE '41'                TO ABEND-CODE-1
  7700        MOVE ERAGTC-FILE-STATUS  TO ABEND-CODE-2
  7701        MOVE WS-ABEND-CODE       TO WS-RETURN-CODE
  7702        GO TO ABEND-PGM
  7703     END-IF
  7704
  7705     IF ERMEBL-FILE-STATUS  = '00'  OR  '97'
  7706         NEXT SENTENCE
  7707       ELSE
  7708         MOVE 'N'                     TO ME-UPDATE-FLAG.
  7709
  7710     IF DTE-PGM-OPT = '1'
  7711         OPEN OUTPUT  CERT-MASTER-OUT
  7712                      DETAIL-EXTR
  7713     ELSE
  7714         MOVE HIGH-VALUES             TO PENDING-MATCH-CONTROL
  7715         MOVE '*'                     TO TRANS-EOF-FLAG.
  7716
  7717     MOVE 'R'                         TO CP-RATE-FILE.
  7718     MOVE 'O'                         TO CP-IO-FUNCTION.
  7719     PERFORM 8100-GET-RATE THRU 8199-GET-RATE-X.
  7720     IF IO-ERROR
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 151
* ECS010MO.cbl
  7721         MOVE 'ERROR OCCURED OPENING - ELRATE'
  7722                                      TO WS-ABEND-MESSAGE
  7723         MOVE 0302                    TO WS-RETURN-CODE
  7724         GO TO ABEND-PGM.
  7725
  7726******************************************************************
  7727***       I N I T I A L I Z A T I O N   R O U T I N E          ***
  7728******************************************************************
  7729
  7730 0090-INITIALIZATION-ROUTINE.
  7731
  7732     ACCEPT WS-TIME-OF-DAY   FROM TIME.
  7733     MOVE WS-TIME                     TO ME-START-TIME.
  7734     MOVE WS-CURRENT-DATE             TO ME-START-DATE
  7735                                         TR-RN-DT.
  7736     MOVE ME-START-MO                 TO ME-CNDS-MO.
  7737     MOVE ME-START-DA                 TO ME-CNDS-DA.
  7738     MOVE ME-START-YR                 TO ME-CNDS-YR.
  7739     COMPUTE MONTH-END-MOYR = (RUN-CCYY * 12) + RUN-MO.
  7740     MOVE COMPANY-NAME                TO TRHDNM.
  7741     MOVE ALPH-DATE                   TO TR-MODAYR.
  7742     MOVE RUN-DATE                    TO EOM-RUN-DATE.
  7743     MOVE BIN-RUN-DATE                TO BIN-EOM-RUN-DATE.
  7744
  7745     MOVE EOM-RUN-DATE                TO  LAST-YRS-DATE.
  7746     COMPUTE LYD-CCYY = LYD-CCYY - 1.
  7747     COMPUTE LYD-MO = LYD-MO - 1.
  7748     IF LYD-MO = ZERO
  7749         MOVE 12                      TO LYD-MO
  7750         COMPUTE LYD-CCYY = LYD-CCYY - 1.
  7751
  7752     MOVE BIN-EOM-RUN-DATE       TO BIN-VALUATION-DT.
  7753
  7754
  7755     IF DTE-CLIENT = 'CID'
  7756         MOVE 'CILGM15'          TO  WS-ME-BAL-JOB
  7757         MOVE 'CILGM15'          TO  WS-ME50-BAL-JOB
  7758     ELSE
  7759         MOVE 'CIDCLGM15'        TO  WS-ME-BAL-JOB
  7760         MOVE 'CIDCLGM15'        TO  WS-ME50-BAL-JOB
  7761     END-IF.
  7762
  7763     IF  NOT DTE-OPT-RESERVE-METHOD-AUTH
  7764         GO TO 0090-CONTINUE.
  7765
  7766     MOVE BIN-VALUATION-DT       TO DC-BIN-DATE-1.
  7767     MOVE -12                    TO DC-ELAPSED-MONTHS.
  7768     MOVE ZEROS                  TO DC-ELAPSED-DAYS.
  7769     MOVE '6'                    TO DC-OPTION-CODE.
  7770     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
  7771
  7772     IF  DC-ERROR-CODE NOT EQUAL SPACES
  7773         MOVE '**** WORK DATE CALC ERROR ****'
  7774                                 TO WS-ABEND-MESSAGE
  7775         MOVE '90'               TO ABEND-CODE-1
  7776         MOVE '0'                TO AC2-ONE
  7777         MOVE DC-ERROR-CODE      TO AC2-TWO
  7778         MOVE WS-ABEND-CODE      TO WS-RETURN-CODE
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 152
* ECS010MO.cbl
  7779         GO TO ABEND-PGM.
  7780
  7781     MOVE DC-BIN-DATE-2          TO  W-WORK-DATE.
  7782
  7783     MOVE DC-GREG-DATE-CYMD      TO  EOM-DATE (01).
  7784     MOVE EOM-RUN-DATE           TO  EOM-DATE (13).
  7785
  7786     PERFORM 0095-GET-EOM-DATES THRU 0095-EXIT
  7787             VARYING
  7788         SUBM FROM +2 BY +1
  7789             UNTIL
  7790         SUBM GREATER THAN +12.
  7791
  7792     DISPLAY 'END OF MONTH TABLE VALUES USED BY ECS010 - '.
  7793
  7794     PERFORM 0096-DISPLAY-EOM-DATES THRU 0096-EXIT
  7795             VARYING
  7796         SUBM FROM +1 BY +1
  7797             UNTIL
  7798         SUBM GREATER THAN +13.
  7799
  7800     MOVE BIN-VALUATION-DT       TO DC-BIN-DATE-1.
  7801*    MOVE -90                    TO DC-ELAPSED-DAYS.
  7802     MOVE ZEROS                  TO DC-ELAPSED-DAYS
  7803                                    DC-ELAPSED-MONTHS.
  7804     SUBTRACT COMPANY-IBNR-LAG-MONTH FROM DC-ELAPSED-MONTHS.
  7805     MOVE 1                      TO DC-END-OF-MONTH.
  7806     MOVE '6'                    TO DC-OPTION-CODE.
  7807     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
  7808
  7809     IF  DC-ERROR-CODE NOT EQUAL SPACES
  7810         MOVE '**** CUT OFF DATE ERROR ****'
  7811                                 TO WS-ABEND-MESSAGE
  7812         MOVE '90'               TO ABEND-CODE-1
  7813         MOVE '0'                TO AC2-ONE
  7814         MOVE DC-ERROR-CODE      TO AC2-TWO
  7815         MOVE WS-ABEND-CODE      TO WS-RETURN-CODE
  7816         GO TO ABEND-PGM.
  7817
  7818     MOVE DC-GREG-DATE-CYMD      TO W-CUTOFF-DATE.
  7819     DISPLAY ' CUT OFF DATE - '  W-CUTOFF-DATE.
  7820
  7821 0090-CONTINUE.
  7822
  7823     MOVE BIN-VALUATION-DT       TO DC-BIN-DATE-1.
  7824     MOVE -1                     TO DC-ELAPSED-MONTHS.
  7825     MOVE +0                     TO DC-ELAPSED-DAYS.
  7826     MOVE '6'                    TO DC-OPTION-CODE.
  7827     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
  7828
  7829     IF NO-CONVERSION-ERROR
  7830        MOVE DC-GREG-DATE-CYMD   TO OB-RUN-DATES (1).
  7831
  7832     MOVE DC-BIN-DATE-2          TO DC-BIN-DATE-1.
  7833     MOVE -1                     TO DC-ELAPSED-MONTHS.
  7834     MOVE +0                     TO DC-ELAPSED-DAYS.
  7835     MOVE '6'                    TO DC-OPTION-CODE.
  7836     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 153
* ECS010MO.cbl
  7837
  7838     IF NO-CONVERSION-ERROR
  7839        MOVE DC-GREG-DATE-CYMD   TO OB-RUN-DATES (2).
  7840
  7841     MOVE +0                     TO DC-ELAPSED-MONTHS
  7842                                    DC-ELAPSED-DAYS.
  7843
  7844     MOVE SPACES                 TO CERTIFICATE-RECORD.
  7845     MOVE 'CR'                   TO CR-RECORD-ID.
  7846     MOVE ZEROS                  TO
  7847               CR-AGE                  CR-JOINT-AGE
  7848               CR-LFTYP                CR-AHTYP
  7849               CR-LF-TERM              CR-AH-TERM
  7850               CR-LF-CRIT-PERIOD       CR-AH-CRIT-PERIOD
  7851               CR-LF-TERM-IN-DAYS
  7852               CR-LF-DEV-PCT           CR-AH-DEV-PCT
  7853               CR-LFAMT                CR-AHAMT
  7854               CR-LFPRM                CR-AHPRM
  7855               CR-LF-POLICY-FEE        CR-AH-POLICY-FEE
  7856               CR-LFPRM-CALC           CR-AHPRM-CALC
  7857               CR-LFPRM-RATE           CR-AHPRM-RATE
  7858               CR-LFAMT-ALT
  7859               CR-LFPRM-ALT
  7860               CR-LFPRM-CALC-ALT       CR-NH-INT-ON-REF
  7861               CR-LFPRM-RATE-ALT
  7862               CR-LFRFND               CR-AHRFND
  7863               CR-LFRFND-CALC          CR-AHRFND-CALC
  7864               CR-LF-NSP-PRM           CR-AH-NSP-PRM
  7865               CR-LF-NSP-PRM-RATE      CR-AH-NSP-PRM-RATE
  7866               CR-LF-REI-RISK-PRM      CR-AH-REI-RISK-PRM
  7867               CR-LF-EXPIRE-DATE       CR-AH-EXPIRE-DATE
  7868               CR-LIVES                CR-APR
  7869               CR-BILLED
  7870               CR-LF-ISS-PREM-TAX      CR-AH-ISS-PREM-TAX
  7871               CR-LF-CNC-PREM-TAX      CR-AH-CNC-PREM-TAX
  7872               CR-PMT-FREQ             CR-LOAN-TERM
  7873               CR-SKIP                 CR-LOAN-1ST-PMT-DT
  7874               CR-SUM-CAN-CNT-ITD      CR-SUM-CAN-CNT-YTD
  7875               CR-PMT-EXTENSION-DAYS   CR-ENTRY-DATE
  7876               CR-LF-CANC-DT           CR-AH-CANC-DT
  7877               CR-LF-CANCEL-EXIT-DATE  CR-AH-CANCEL-EXIT-DATE
  7878               CR-LF-CLAIM-EXIT-DATE   CR-AH-SETTLEMENT-EXIT-DATE
  7879               CR-NUM-DTH-CLM          CR-NUM-DIS-CLM
  7880               CR-DTH-DT               CR-DIS-DT
  7881               CR-DTH-RPT-DT           CR-DIS-RPT-DT
  7882               CR-DTH-PAY-DT           CR-DIS-PAY-DT
  7883                                       CR-DIS-PTO-DT
  7884               CR-DTHAMT               CR-DISAMT
  7885               CR-DTHAMT-YTD           CR-DISAMT-YTD
  7886               CR-DTHAMT-LAST          CR-DISAMT-LAST
  7887               CR-DTHEXP               CR-DISEXP
  7888               CR-DTHEXP-YTD           CR-DISEXP-YTD
  7889               CR-DTH-AGE              CR-DAYS-DISAB
  7890               CR-DIS-INCUR-DT (1)     CR-CLAIM-DEDUCT-WITHHELD
  7891               CR-INCUR-DISAMT (1)     CR-CANCEL-DEDUCT-WITHHELD
  7892               CR-INCUR-DISEXP (1)     CR-REMIT-TO
  7893               CR-CANCEL-STATE-TAX     CR-CANCEL-MUNI-TAX
  7894               CR-MOB-NET-TOT-FEES
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 154
* ECS010MO.cbl
  7895               CR-ADDL-CLP  CR-LF-CLP  CR-AH-CLP.
  7896
  7897     MOVE CR-DISAB-DETAIL-DATA (1)  TO CR-DISAB-DETAIL-DATA (2)
  7898                                       CR-DISAB-DETAIL-DATA (3)
  7899                                       CR-DISAB-DETAIL-DATA (4)
  7900                                       CR-DISAB-DETAIL-DATA (5).
  7901
  7902     MOVE CERTIFICATE-RECORD     TO INITIALIZED-CERTIFICATE.
  7903
  7904     MOVE SPACES                 TO WS-BANK-COMMISSIONS
  7905     PERFORM VARYING IA FROM +1 BY +1 UNTIL
  7906        IA > +10
  7907        MOVE ZEROS               TO WS-BNK-SPP-FEES (IA)
  7908     END-PERFORM
  7909     MOVE WS-BANK-COMMISSIONS    TO WS-BANK-INIT
  7910
  7911     MOVE LOW-VALUES   TO ACCOUNT-MASTER   CERTIFICATE-RECORD.
  7912
  7913     MOVE HIGH-VALUES  TO REIN-HOLD-AREAS  RC-REIN-HOLD-AREAS
  7914                          EPEC-TOTALS      EPEC-SUBS
  7915                          EPEC-UNDERWRITTEN-TOTALS.
  7916
  7917     MOVE ZEROS        TO EPEC-LEVELS-END  EPEC-SUBS-END
  7918                          EPEC-LEVELS-END-II.
  7919     MOVE SPACES       TO REIN-LEVELS-END  RC-REIN-LEVELS-END
  7920                          DUPE-CERT-TABLE.
  7921
  7922     PERFORM CLEAR-REIN-HOLD        THRU CLEAR-REIN-HOLD-X.
  7923     PERFORM 4550-CLEAR-EPEC-TOTALS THRU 4589-CLEAR-EPEC-TOTALS-X.
  7924     PERFORM 5900-CLEAR-TOTAL-PAGES THRU 5999-CLEAR-TOTAL-PAGES-X
  7925                VARYING SUB6 FROM 1 BY 1 UNTIL SUB6 GREATER 6.
  7926     PERFORM 7900-CLEAR-BILLING-TABLE THRU 7999-CLEAR-BILLING-X
  7927                VARYING B-SUB FROM 1 BY 1 UNTIL B-SUB GREATER 50.
  7928
  7929     IF RUN-DATE NOT = EP-DT
  7930         MOVE '*'                     TO TR-YRASK.
  7931     MOVE LIFE-OVERRIDE-L6            TO TR-7-LF.
  7932     MOVE LIFE-OVERRIDE-L2            TO DET-LF-DESC.
  7933     MOVE AH-OVERRIDE-L6              TO TR-7-AH.
  7934     MOVE AH-OVERRIDE-L2              TO DET-AH-DESC.
  7935
  7936     IF DTE-CLIENT = 'FIA' OR 'TAO' OR 'PEK'
  7937         MOVE +1000                   TO DUP-MAX.
  7938
  7939     MOVE DTE-CLIENT                  TO ME-COMPANY.
  7940     MOVE MONTH-END-MOYR              TO ME-MOYR.
  7941     IF ME-DO-UPDATE
  7942         READ ERMEBL-INOUT INVALID KEY
  7943                       CLOSE ERMEBL-INOUT
  7944                       MOVE 'N'       TO ME-UPDATE-FLAG.
  7945
  7946     GO TO 0150-READ-ACCOUNT-MASTER.
  7947
  7948 0090-EXIT.
  7949     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 155
* ECS010MO.cbl
  7951 0095-GET-EOM-DATES.
  7952
  7953     MOVE W-WORK-DATE            TO DC-BIN-DATE-1.
  7954     MOVE '6'                    TO DC-OPTION-CODE.
  7955     MOVE 1                      TO DC-ELAPSED-MONTHS
  7956                                    DC-END-OF-MONTH.
  7957     MOVE ZEROS                  TO DC-ELAPSED-DAYS.
  7958     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
  7959
  7960     IF  DC-ERROR-CODE NOT EQUAL SPACES
  7961         MOVE '**** EOM PLUS 1 DATE CALC ERROR ****'
  7962                                 TO WS-ABEND-MESSAGE
  7963         MOVE '90'               TO ABEND-CODE-1
  7964         MOVE '0'                TO AC2-ONE
  7965         MOVE DC-ERROR-CODE      TO AC2-TWO
  7966         MOVE WS-ABEND-CODE      TO WS-RETURN-CODE
  7967         GO TO ABEND-PGM.
  7968
  7969     MOVE DC-BIN-DATE-2          TO  W-WORK-DATE
  7970                                     DC-BIN-DATE-1.
  7971     MOVE SPACES                 TO  DC-BIN-DATE-2.
  7972     MOVE ' '                    TO  DC-OPTION-CODE.
  7973     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
  7974
  7975     IF  DC-ERROR-CODE NOT EQUAL SPACES
  7976         MOVE '**** YMD EOM DATE CALC ERROR ****'
  7977                                 TO WS-ABEND-MESSAGE
  7978         MOVE '90'               TO ABEND-CODE-1
  7979         MOVE '0'                TO AC2-ONE
  7980         MOVE DC-ERROR-CODE      TO AC2-TWO
  7981         MOVE WS-ABEND-CODE      TO WS-RETURN-CODE
  7982         GO TO ABEND-PGM.
  7983
  7984     MOVE DC-GREG-DATE-CYMD      TO  EOM-DATE (SUBM).
  7985
  7986 0095-EXIT.
  7987     EXIT.
  7988
  7989 0096-DISPLAY-EOM-DATES.
  7990
  7991     DISPLAY SUBM '. ' EOM-DATE (SUBM).
  7992
  7993 0096-EXIT.
  7994     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 156
* ECS010MO.cbl
  7996******************************************************************
  7997***    R E A D   A C C O U N T   M A S T E R   R O U T I N E   ***
  7998******************************************************************
  7999
  8000 0100-ACCT-MASTER-READ-ROUTINE.
  8001
  8002     IF EP-FLG = '1'
  8003        ADD +1                   TO BC-ACT-ACCTS
  8004        IF DTE-OPT-RESERVE-METHOD-AUTH
  8005           PERFORM 4700-CALC-OPT-IBNR
  8006                                 THRU 4700-EXIT
  8007        END-IF
  8008        PERFORM 4500-BUILD-EPEC-EXTRACT
  8009                                 THRU 4599-BUILD-EPEC-EXTRACT-X
  8010     END-IF
  8011
  8012     IF TRANSACTION-WAS-PROCESSED
  8013         MOVE '1'                     TO ACCT-FLG
  8014                                         STATE-FLG
  8015                                         COMP-FLG
  8016                                         CARR-FLG
  8017                                         FINAL-FLG.
  8018
  8019 0150-READ-ACCOUNT-MASTER.
  8020
  8021     READ ERACCTT-IN AT END
  8022         GO TO 9930-EOJ-3.
  8023
  8024     ADD +1                            TO ERACCTT-READS.
  8025
* 8026     COPY ELCACCTI.
  8027******************************************************************04/14/98
  8028*                                                                *ELCACCTI
  8029*                            ELCACCTI                            *   LV003
  8030*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
  8031*                            VMOD=2.001                          *ELCACCTI
  8032*                                                                *ELCACCTI
  8033*   COPY FILE VARIABLES TO WORKING STORAGE                       *ELCACCTI
  8034*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCACCTI
  8035*                                                                *ELCACCTI
  8036*  NO  CID  MODS  IN  COPYBOOK  ELCACCTI                         *ELCACCTI
  8037*                                                                *ELCACCTI
  8038******************************************************************ELCACCTI
  8039     MOVE AM-EXPIRE-DT           TO  WS-AM-EXPIRE-DT-N.              CL**2
  8040     MOVE AM-VG-EXP-DATE         TO  WS-AM-VG-EXP-DATE-N.            CL**2
  8041     MOVE AM-EFFECT-DT           TO  WS-AM-EFFECT-DT-N.              CL**2
  8042     MOVE AM-PREV-EXP-DT         TO  WS-AM-PREV-EXP-DT-N.            CL**2
  8043     MOVE AM-PREV-EFF-DT         TO  WS-AM-PREV-EFF-DT-N             CL**2
  8044     MOVE AM-ANNIVERSARY-DATE    TO  WS-AM-ANNIVERSARY-DATE-N.       CL**2
  8045     MOVE AM-HI-CERT-DATE        TO  WS-AM-HI-CERT-DATE-N.           CL**2
  8046     MOVE AM-LO-CERT-DATE        TO  WS-AM-LO-CERT-DATE-N.           CL**2
  8047     MOVE AM-ENTRY-DATE          TO  WS-AM-ENTRY-DATE-N.             CL**2
  8048
  8049     IF FIRST-ACCOUNT EQUAL +1
  8050        MOVE +0                  TO FIRST-ACCOUNT
  8051        GO TO 0190-PROCESS-NEW-ACCOUNT.
  8052
  8053     IF AM-CARRIER NOT = HLD-CARRIER
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 157
* ECS010MO.cbl
  8054         PERFORM 5400-CARR-BREAK THRU 5499-CARR-BREAK-X
  8055     ELSE
  8056     IF AM-GROUPING NOT = HLD-GROUPING
  8057         PERFORM 5300-COMP-BREAK THRU 5399-COMP-BREAK-X
  8058     ELSE
  8059     IF AM-STATE NOT = HLD-STATE
  8060         PERFORM 5200-STATE-BREAK THRU 5299-STATE-BREAK-X
  8061     ELSE
  8062     IF AM-ACCOUNT NOT = HLD-ACCT
  8063         PERFORM 5100-ACCOUNT-BREAK THRU 5199-ACCOUNT-BREAK-X
  8064     ELSE
  8065     PERFORM 5000-DATE-RANGE-BREAK THRU 5099-DATE-RANGE-BREAK-X.
  8066
  8067     IF (AM-CARRIER NOT = HLD-CARRIER) OR
  8068        (AM-GROUPING NOT = HLD-GROUPING)
  8069         PERFORM 7000-CLIENT-BILLING-ROUTINE THRU 7099-BILL-X.
  8070
  8071 0190-PROCESS-NEW-ACCOUNT.
  8072
  8073     IF AM-CARRIER NOT = HLD-CARRIER
  8074         PERFORM 0199A-CARRIER-TABLE-LOOKUP THRU 0199A-LOOKUP-XIT.
  8075
  8076     MOVE AM-CONTROL-A          TO HLD-CONTROL.
  8077     MOVE AM-CARRIER            TO TR-CARR.
  8078     MOVE AM-GROUPING           TO TR-GROUP.
  8079     MOVE AM-ACCOUNT            TO TR-AG-NO.
  8080     MOVE AM-NAME               TO TR-AGCY.
  8081     MOVE AM-EFF-MO             TO TR-CE-MO.
  8082     MOVE AM-EFF-DA             TO TR-CE-DA.
  8083     MOVE AM-EFF-YR             TO TR-CE-YR.
  8084     MOVE AM-STATE              TO TR-ST-NO.
  8085     IF AM-EXPIRE-DT =  99999999999
  8086         MOVE 'CURRENT '        TO TR-CX
  8087     ELSE
  8088         MOVE AM-EXP-MO         TO TR-CX-MO
  8089         MOVE AM-EXP-DA         TO TR-CX-DA
  8090         MOVE AM-EXP-YR         TO TR-CX-YR
  8091         MOVE '-'               TO HSHR1  HSHR2.
  8092
  8093     ADD +1 TO BC-ACCTS.
  8094
  8095     IF AM-RECORD-ID = '**'
  8096         ADD +1 TO BC-NEW-ACCTS.
  8097     IF AM-RET-Y-N = 'Y' OR 'I' OR 'G' OR 'L' OR 'D'
  8098         ADD +1 TO BC-ER-ACCTS.
  8099
  8100     MOVE ZEROS                 TO SV-LO-CERT
  8101                                   SV-HI-CERT.
  8102     MOVE SPACE                 TO TRANSACTION-FLAG
  8103                                   LST-TRD-CERT
  8104                                   LST-TRD-ISDT
  8105                                   OB-DATE-1-SWITCH
  8106                                   OB-DATE-2-SWITCH
  8107                                   OB-DATE-3-SWITCH.
  8108     MOVE +81                   TO LN-CNT.
  8109
  8110 0199-READ-ACCOUNT-X.
  8111     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 158
* ECS010MO.cbl
  8112
  8113 0199A-CARRIER-TABLE-LOOKUP.
  8114
  8115     PERFORM 0199B-SEARCH-CARRIER-TABLE
  8116            VARYING CLAS-INDEXCN FROM 1 BY 1
  8117         UNTIL AM-CARRIER = CARRIER-SUB (CLAS-INDEXCN)  OR
  8118               CLAS-INDEXCN GREATER CLAS-MAXCN.
  8119
  8120     IF CLAS-INDEXCN GREATER CLAS-MAXCN
  8121         DISPLAY 'CARRIER NOT IN CARRIER NAME TABLE: ' AM-CARRIER
  8122         MOVE '** CARRIER NOT IN CARRIER NAME TABLE **'
  8123                                 TO WS-ABEND-MESSAGE
  8124         MOVE 4004               TO WS-ABEND-CODE
  8125         MOVE WS-ABEND-CODE      TO WS-RETURN-CODE
  8126         GO TO ABEND-PGM.
  8127
  8128 0199A-LOOKUP-XIT.
  8129     EXIT.
  8130 0199B-SEARCH-CARRIER-TABLE.
  8131     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 159
* ECS010MO.cbl
  8133******************************************************************
  8134***       R E A D   C E R T   M A S T E R   R O U T I N E      ***
  8135******************************************************************
  8136
  8137 0200-CERT-MASTER-READ-ROUTINE.
  8138
  8139     IF EOF-ON-CERT
  8140         GO TO 0299-READ-CERT-X.
  8141
  8142     IF FIRST-CERT EQUAL +1
  8143        MOVE +0                  TO FIRST-CERT
  8144        GO TO 0250-READ-CERT-MASTER.
  8145
  8146     MOVE CERT-IN-RECORD             TO CERTIFICATE-RECORD.
  8147
  8148
  8149     IF (CR-CARRIER = '9')
  8150        AND (CR-STATE = 'NE')
  8151        AND (CR-ACCOUNT = '0001190900')
  8152        AND (CR-DT >= 20090825)
  8153        DISPLAY ' CERT IN REPLACING TABLE ' CR-REIN-TABLE
  8154           ' WITH TABLE 0V9 FOR ' CR-STATE ' ' CR-ACCOUNT ' '
  8155           CR-CERT-NO ' ' CR-DT
  8156        MOVE '0V9'               TO CR-REIN-TABLE
  8157     END-IF
  8158
  8159
  8160
  8161
  8162     PERFORM CERT-DATE-LOAD.
  8163
  8164     IF CR-IND-GRP = 'I'  OR  '1'
  8165         MOVE '1'                    TO CR-IND-GRP
  8166     ELSE
  8167         MOVE '2'                    TO CR-IND-GRP.
  8168
  8169     IF CR-LF-REI-RISK-PRM NOT NUMERIC
  8170         MOVE ZEROS                TO CR-LF-REI-RISK-PRM.
  8171     IF CR-AH-REI-RISK-PRM NOT NUMERIC
  8172         MOVE ZEROS                TO CR-AH-REI-RISK-PRM.
  8173
  8174************ TEMP CODE TO INITIALIZE RISK PREM FIELDS ************
  8175     IF DTE-CLIENT NOT = 'NSL'
  8176         MOVE ZEROS                TO CR-LF-REI-RISK-PRM
  8177                                      CR-AH-REI-RISK-PRM.
  8178******************************************************************
  8179
  8180     IF CR-CLAIM-DEDUCT-WITHHELD NOT NUMERIC
  8181         MOVE ZEROS                TO CR-CLAIM-DEDUCT-WITHHELD.
  8182     IF CR-CANCEL-DEDUCT-WITHHELD NOT NUMERIC
  8183         MOVE ZEROS                TO CR-CANCEL-DEDUCT-WITHHELD.
  8184
  8185     MOVE CR-STATE                   TO STATE-L.
  8186     PERFORM 8200-STATE-CODE-LOOKUP THRU 8299-STATE-LOOKUP-X.
  8187
  8188     IF CR-LFTYP NOT = ZERO
  8189         MOVE CR-LFTYP               TO CLAS-LOOK
  8190         PERFORM 8300-LIFE-TYPE-LOOKUP THRU 8399-LIFE-LOOKUP-X.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 160
* ECS010MO.cbl
  8191
  8192     IF CR-AHTYP NOT = ZERO
  8193         MOVE CR-AHTYP               TO CLAS-LOOK
  8194         PERFORM 8400-A-H-TYPE-LOOKUP THRU 8499-A-H-LOOKUP-X.
  8195
  8196     MOVE CR-DT                  TO DC-GREG-DATE-CYMD
  8197     MOVE 'L'                    TO DC-OPTION-CODE
  8198     MOVE +0                     TO DC-ELAPSED-MONTHS
  8199                                    DC-ELAPSED-DAYS
  8200     PERFORM 8000-DATE-CONVERT-ROUTINE
  8201                                 THRU 8099-DATE-CONVERT-X
  8202     MOVE DC-BIN-DATE-1          TO WS-CR-BIN-DATE
  8203
  8204     IF (DTE-CLIENT = 'DCC')
  8205        AND (CR-AHTYP NOT = ZERO AND SPACES)
  8206        AND (CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'G' OR 'L')
  8207        PERFORM 0395-GET-CERT-TRLRS
  8208                                 THRU 0395-EXIT
  8209     END-IF
  8210
  8211     IF RUN-MO NOT = 01
  8212         GO TO 0250-READ-CERT-MASTER.
  8213
  8214     MOVE ZERO                 TO CR-DTHAMT-YTD  CR-DISAMT-YTD
  8215                                  CR-DTHEXP-YTD  CR-DISEXP-YTD.
  8216
  8217     IF ((CR-LFTYP NOT = ZERO)  AND
  8218         (CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'Z'))  OR
  8219        ((CR-AHTYP NOT = ZERO)  AND
  8220         (CLAS-I-CALC-TYPE (CLAS-INDEXA) = 'Z'))
  8221           MOVE ZERO           TO CR-SUM-CAN-CNT-YTD.
  8222
  8223     .
  8224 0250-READ-CERT-MASTER.
  8225
  8226     READ CERT-MASTER-IN
  8227               AT END GO TO 9920-EOJ-2.
  8228
  8229     ADD +1 TO CMIN-CNT.
  8230
  8231*     DISPLAY ' READ CERT ' CIR-CONTROL
  8232     IF CIR-CONTROL LESS THAN PRIOR-CERT-IN-CNTRL
  8233         DISPLAY 'SEQUENCE ERROR ON CERT MASTER'
  8234         DISPLAY 'FIRST  - '  PRIOR-CERT-IN-CNTRL
  8235         DISPLAY 'SECOND - '  CIR-CONTROL
  8236         MOVE 0612                    TO WS-ABEND-CODE
  8237         MOVE WS-ABEND-CODE           TO WS-RETURN-CODE
  8238         GO TO ABEND-PGM.
  8239
  8240     IF CIR-CONTROL = PRIOR-CERT-IN-CNTRL
  8241         DISPLAY 'DUPLICATE CERT ON FILE'  PRIOR-CERT-IN-CNTRL
  8242         IF DTE-CLIENT EQUAL 'SEN'
  8243            GO TO 0250-READ-CERT-MASTER
  8244         ELSE
  8245            MOVE 'DUPLICATE CERT ON FILE'
  8246                                      TO WS-ABEND-MESSAGE
  8247            MOVE 0302                 TO WS-ABEND-CODE
  8248            MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 161
* ECS010MO.cbl
  8249            GO TO ABEND-PGM.
  8250
  8251******************************************************
  8252*   THIS LOGIC WAS ADDED TO ACCOMMODATE THE EXECUTION
  8253*   OF A "MID MONTH" BILLING REPORT (EL562) FOR
  8254*   COMMERCIAL FEDERAL BANK AND PEOPLES TRUST
  8255******************************************************
  8256     IF DTE-CLIENT = 'CID'
  8257        IF COMPANY-NAME = '      COMMERCIAL FEDERAL'
  8258           IF (CF-THIRD-AGENT  = '0000713100') OR
  8259              (CF-FOURTH-AGENT = '0000713100')
  8260              CONTINUE
  8261           ELSE
  8262              GO TO 0250-READ-CERT-MASTER
  8263           END-IF
  8264        ELSE
  8265           IF COMPANY-NAME = '        PEOPLES TRUST'
  8266              IF CI-ACCOUNT = '0000845800'
  8267                 CONTINUE
  8268              ELSE
  8269                 GO TO 0250-READ-CERT-MASTER
  8270              END-IF
  8271           ELSE
  8272              IF COMPANY-NAME = '        SUNFLOWER BANK'
  8273                 IF (CF-THIRD-AGENT  = '0000681700') OR
  8274                    (CF-FOURTH-AGENT = '0000681700')
  8275                    CONTINUE
  8276                 ELSE
  8277                    GO TO 0250-READ-CERT-MASTER
  8278                 END-IF
  8279              ELSE
  8280                 IF COMPANY-NAME = '      FIRST PREMIER BANK'
  8281                    IF CI-ACCOUNT = '0001107200'
  8282                       CONTINUE
  8283                    ELSE
  8284                       GO TO 0250-READ-CERT-MASTER
  8285                    END-IF
  8286                 END-IF
  8287              END-IF
  8288           END-IF
  8289        END-IF
  8290     END-IF
  8291
  8292******************************************************
  8293     MOVE CIR-CONTROL                 TO PRIOR-CERT-IN-CNTRL.
  8294
  8295 0299-READ-CERT-X.
  8296     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 162
* ECS010MO.cbl
  8298******************************************************************
  8299***     R E A D   P E N D I N G   F I L E   R O U T I N E      ***
  8300******************************************************************
  8301
  8302 0300-READ-PENDING-TRANSACTIONS.
  8303
  8304     READ PENDING-EXTRACT
  8305                   AT END GO TO 9910-EOJ-1.
  8306
  8307     MOVE SPACE                    TO PENDING-RECORD-TYPE.
  8308
  8309     IF NOT ED-PENDING-BUSINESS  AND
  8310        NOT ED-PENDING-CLAIMS  AND
  8311        NOT ED-CERT-CHANGES
  8312           DISPLAY 'INVALID EXTRACT TYPE INTO ECS010 - TYPE = '
  8313                                               ED-RECORD-TYPE
  8314           MOVE 0301                        TO WS-ABEND-CODE
  8315           MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
  8316           GO TO ABEND-PGM.
  8317
  8318     PERFORM 0310-SET-UP-MATCHING-KEY THRU 0310-EXIT.
  8319
  8320     IF DTE-CLIENT = 'NCL'
  8321         IF PEND-MATCH-EFF-DTE LESS THAN 19400101
  8322             DISPLAY 'TRANS DROPPED: ' PENDING-MATCH-CONTROL
  8323                     '  TRANS TYPE: ' PENDING-RECORD-TYPE
  8324             GO TO 0300-READ-PENDING-TRANSACTIONS.
  8325
  8326     IF PENDING-MATCH-CONTROL  LESS THAN  PRIOR-MATCH-CNTRL
  8327         DISPLAY 'SEQUENCE ERROR ON TRANSACTION FILE'
  8328         DISPLAY ' PRIOR SEQ.   = '  PRIOR-MATCH-CNTRL
  8329         DISPLAY ' CURRENT SEQ. = '  PENDING-MATCH-CONTROL
  8330         MOVE 0603                    TO WS-ABEND-CODE
  8331         MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
  8332         GO TO ABEND-PGM.
  8333
  8334     ADD +1 TO TR-CNT.
  8335
  8336     IF ISSUE-TRANSACTION   OR
  8337        CANCEL-TRANSACTION  OR
  8338        CLAIM-TRANSACTION   OR
  8339        RESERVE-TRANSACTION OR
  8340        UPDATE-TRANSACTION
  8341         MOVE PENDING-MATCH-CONTROL   TO PRIOR-MATCH-CNTRL
  8342         GO TO 0330-MATCH-PENDING-TO-CERT.
  8343
  8344     DISPLAY 'INVALID TRANSACTION INTO ECS010 '.
  8345
  8346     DISPLAY 'INVALID TRANSACTION INTO ECS010 '.
  8347     DISPLAY '  MATCH CONTROL: ' PENDING-MATCH-CONTROL ' TYPE: ('
  8348             PENDING-RECORD-TYPE ')'.
  8349
  8350     MOVE 0301                   TO WS-ABEND-CODE.
  8351     MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
  8352     GO TO ABEND-PGM.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 163
* ECS010MO.cbl
  8354 0310-SET-UP-MATCHING-KEY.
  8355
  8356     IF ED-PENDING-BUSINESS
  8357         MOVE ED-DATA-AREAS      TO PENDING-BUSINESS
  8358         MOVE PB-CARRIER         TO PEND-MATCH-CARRIER
  8359         MOVE PB-GROUPING        TO PEND-MATCH-GROUPING
  8360         MOVE PB-STATE           TO PEND-MATCH-STATE
  8361         MOVE PB-ACCOUNT         TO PEND-MATCH-ACCOUNT
  8362         MOVE PB-CERT-EFF-DT     TO DC-BIN-DATE-1
  8363         MOVE PB-CERT-NO         TO PEND-MATCH-CERT-NO
  8364         MOVE PB-RECORD-TYPE     TO PENDING-RECORD-TYPE.
  8365
  8366     IF ED-PENDING-CLAIMS
  8367         ADD +1                  TO W-PENDING-CLMS
  8368         MOVE ED-DATA-AREAS      TO PENDING-CLAIMS
  8369         MOVE PC-CARRIER         TO PEND-MATCH-CARRIER
  8370         MOVE PC-GROUPING        TO PEND-MATCH-GROUPING
  8371         MOVE PC-STATE           TO PEND-MATCH-STATE
  8372         MOVE PC-ACCOUNT         TO PEND-MATCH-ACCOUNT
  8373         MOVE PC-CERT-EFF-DT     TO DC-BIN-DATE-1
  8374         MOVE PC-CERT-NO         TO PEND-MATCH-CERT-NO
  8375         IF PC-CLAIMS
  8376             MOVE '3'            TO PENDING-RECORD-TYPE
  8377         ELSE
  8378             IF PC-RESERVES
  8379                 MOVE '4'        TO PENDING-RECORD-TYPE.
  8380
  8381     IF ED-CERT-CHANGES
  8382         MOVE ED-DATA-AREAS      TO PENDING-MAINT-TO-CERT-FILE
  8383         MOVE CC-CARRIER         TO PEND-MATCH-CARRIER
  8384         MOVE CC-GROUPING        TO PEND-MATCH-GROUPING
  8385         MOVE CC-STATE           TO PEND-MATCH-STATE
  8386         MOVE CC-ACCOUNT         TO PEND-MATCH-ACCOUNT
  8387         MOVE CC-CERT-EFF-DT     TO DC-BIN-DATE-1
  8388         MOVE CC-CERT-NO         TO PEND-MATCH-CERT-NO
  8389         MOVE '5'                TO PENDING-RECORD-TYPE.
  8390
  8391     MOVE ' '                    TO DC-OPTION-CODE.
  8392     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
  8393     MOVE DC-GREG-DATE-CYMD      TO PEND-MATCH-EFF-DTE.
  8394
  8395 0310-EXIT.
  8396     EXIT.
  8397
  8398******************************************************************
  8399***    M A T C H   P E N D I N G   F I L E   T O   C E R T     ***
  8400******************************************************************
  8401
  8402 0330-MATCH-PENDING-TO-CERT.
  8403
  8404     IF PENDING-MATCH-CONTROL  LESS THAN  CR-FULL-CONTROL
  8405         GO TO 0390-CERT-MISMATCH-ERROR.
  8406
  8407     IF PENDING-MATCH-CONTROL  EQUAL   CR-FULL-CONTROL
  8408*       DISPLAY ' EQUAL PEND ' PENDING-MATCH-CONTROL
  8409       IF CLAIM-TRANSACTION
  8410*         DISPLAY ' CLAIM '
  8411         IF NOT PC-CHARGEBLE-EXPENSE  AND
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 164
* ECS010MO.cbl
  8412            NOT PC-NON-CHARGEBLE-EXPENSE
  8413             IF ((PC-CLAIM-TYPE = '1' OR '3') AND CR-LFTYP = '00')
  8414                                      OR
  8415                ((PC-CLAIM-TYPE = '2' OR '4') AND CR-AHTYP = '00')
  8416                  GO TO 0390-CERT-MISMATCH-ERROR.
  8417
  8418     IF PENDING-MATCH-CONTROL  EQUAL   CR-FULL-CONTROL
  8419       IF RESERVE-TRANSACTION
  8420*         DISPLAY ' RESV '
  8421         IF ((PC-CLAIM-TYPE = '1' OR '3') AND CR-LFTYP = '00')
  8422                                  OR
  8423            ((PC-CLAIM-TYPE = '2' OR '4') AND CR-AHTYP = '00')
  8424              GO TO 0390-CERT-MISMATCH-ERROR.
  8425
  8426     IF PENDING-MATCH-CONTROL  EQUAL   CR-FULL-CONTROL
  8427         IF ISSUE-TRANSACTION
  8428*           DISPLAY ' ISSUE '
  8429             GO TO 0380-DUPLICATE-CERT-ERROR
  8430         ELSE
  8431             GO TO 0350-MATCH-PENDING-TO-ACCOUNT.
  8432
  8433     IF PENDING-MATCH-CONTROL  NOT LESS THAN  CIR-CONTROL
  8434         PERFORM 0400-WRITE-CERT-RECORD THRU 0499-WRITE-CERT-X
  8435         PERFORM 0200-CERT-MASTER-READ-ROUTINE THRU
  8436                                               0299-READ-CERT-X
  8437         GO TO 0330-MATCH-PENDING-TO-CERT.
  8438
  8439     IF ISSUE-TRANSACTION
  8440         PERFORM 0400-WRITE-CERT-RECORD THRU 0499-WRITE-CERT-X
  8441     ELSE
  8442         GO TO 0390-CERT-MISMATCH-ERROR.
  8443
  8444 0350-MATCH-PENDING-TO-ACCOUNT.
  8445
  8446     IF PENDING-ACCOUNT-CONTROL LESS THAN AM-CONTROL-A
  8447       ADD +1  TO ERROR-COUNT
  8448         MOVE    '*** MISMATCH BETWEEN PENDING TRAN AND ACCOUNT'
  8449           TO  DL-FULL
  8450             PERFORM 8600-DISPLAY-PRT  THRU  8600-DISPLAY-EXIT
  8451         MOVE    ' PENDING CONTROL = '
  8452           TO  DIS-LINE-REASON
  8453         MOVE  PENDING-MATCH-CONTROL
  8454           TO  DIS-LINE-REC
  8455             PERFORM 8600-DISPLAY-PRT  THRU  8600-DISPLAY-EXIT
  8456         MOVE    ' KEY OF PENDING REC BYPASSED - '
  8457           TO  DIS-LINE-REASON
  8458         MOVE  PENDING-MATCH-CONTROL
  8459           TO  DIS-LINE-REC
  8460             PERFORM 8600-DISPLAY-PRT  THRU  8600-DISPLAY-EXIT
  8461         MOVE  SPACES
  8462           TO  DISPLAY-LINE
  8463             PERFORM 8600-DISPLAY-PRT  THRU  8600-DISPLAY-EXIT
  8465         DISPLAY '*** MISMATCH BETWEEN PENDING TRAN AND ACCOUNT'
  8466         DISPLAY '    PENDING CONTROL = ' PENDING-MATCH-CONTROL
  8467         DISPLAY 'PENDING REC BYPASSED - ' PENDING-MATCH-CONTROL
  8468         DISPLAY 'TRAN TYPE =   '  PENDING-RECORD-TYPE
  8469         DISPLAY '  TYPE  1=ISS   2=CAN   3=CLM   4=RSV   5=CHG'
  8470         DISPLAY '    ACCOUNT CONTROL = '
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 165
* ECS010MO.cbl
  8471         AM-MSTR-CNTRL AM-EFFECT-DT
  8472         IF DTE-CLIENT = 'UAL'  OR  'NCL' OR 'CID'
  8473            DISPLAY 'TRANS BYPASSED.... CLIENT = ' DTE-CLIENT
  8474            GO TO 0300-READ-PENDING-TRANSACTIONS
  8475         ELSE
  8476            MOVE 'MISMATCH BETWEEN PENDING TRAN AND ACCOUNT'
  8477                                      TO WS-ABEND-MESSAGE
  8478            MOVE 0302 TO WS-ABEND-CODE
  8479            MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
  8480            GO TO ABEND-PGM.
  8481
  8482     IF PENDING-ACCOUNT-CONTROL GREATER AM-CONTROL-A
  8483         PERFORM 0100-ACCT-MASTER-READ-ROUTINE THRU
  8484                                              0199-READ-ACCOUNT-X
  8485         GO TO 0350-MATCH-PENDING-TO-ACCOUNT.
  8486
  8487     IF PEND-MATCH-EFF-DTE NOT LESS THAN AM-EFFECT-DT  AND
  8488        PEND-MATCH-EFF-DTE LESS THAN AM-EXPIRE-DT
  8489         GO TO 0500-APPLY-PENDING-BUSINESS.
  8490
  8491     PERFORM 0100-ACCT-MASTER-READ-ROUTINE THRU
  8492                                       0199-READ-ACCOUNT-X.
  8493     GO TO 0350-MATCH-PENDING-TO-ACCOUNT.
  8494
  8495
  8496 0370-ACCOUNT-MISMATCH-ERROR.
  8497
  8498     DISPLAY 'MISMATCH ACCOUNT ERROR'
  8499     DISPLAY '    ACCOUNT CONTROL = ' AM-MSTR-CNTRL AM-EFFECT-DT.
  8500     MOVE 'MISMATCH ACCOUNT ERROR'
  8501                               TO WS-ABEND-MESSAGE.
  8502     MOVE 0302 TO WS-ABEND-CODE.
  8503         DISPLAY '******************************'
  8504         DISPLAY '***** ERROR LOCATION 009 *****'
  8505         DISPLAY '******************************'
  8506     MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
  8507     GO TO ABEND-PGM.
  8508
  8509
  8510 0380-DUPLICATE-CERT-ERROR.
  8511
  8512     IF PB-I-OB  OR  PB-I-SUMMARY
  8513         GO TO 0300-READ-PENDING-TRANSACTIONS.
  8514
  8515     ADD +1 TO DUP-CNT.
  8516
  8517     IF DUP-CNT NOT GREATER THAN DUP-MAX
  8518         MOVE CR-FULL-CONTROL           TO DUPE-ENTRY (DUP-CNT)
  8519         COMPUTE DUPE-LF-PRM (DUP-CNT) = PB-I-LF-PREMIUM-AMT +
  8520                                         PB-I-LF-ALT-PREMIUM-AMT
  8521         MOVE  PB-I-AH-PREMIUM-AMT      TO  DUPE-AH-PRM (DUP-CNT)
  8522         MOVE  PB-I-ENTRY-STATUS        TO  DUPE-STATUS (DUP-CNT)
  8523         GO TO 0300-READ-PENDING-TRANSACTIONS.
  8524
  8525     DISPLAY 'MORE THAN ' DUP-MAX ' DUPLICATE ISSUES PROCESSED'.
  8526     GO TO 0300-READ-PENDING-TRANSACTIONS.
  8527
  8528*    MOVE 0301 TO WS-ABEND-CODE.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 166
* ECS010MO.cbl
  8529*    MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
  8530*    GO TO ABEND-PGM.
  8531
  8532
  8533 0390-CERT-MISMATCH-ERROR.
  8534
  8535     IF ISSUE-TRANSACTION  OR
  8536        CANCEL-TRANSACTION  OR
  8537        CLAIM-TRANSACTION
  8538         ADD +1                  TO  MISMATCH-COUNT.
  8539
  8540     IF DTE-CLIENT  =  'CID'  OR  'CSO'
  8541       ADD  +1  TO  ERROR-COUNT
  8542         MOVE    '*** MISMATCH BETWEEN CERT AND TRANS'
  8543           TO  DL-FULL
  8544             PERFORM 8600-DISPLAY-PRT  THRU  8600-DISPLAY-EXIT
  8545         MOVE    ' TRANS CONTROL = '
  8546           TO  DIS-LINE-REASON
  8547         MOVE  PENDING-MATCH-CONTROL
  8548           TO  DIS-LINE-REC
  8549             PERFORM 8600-DISPLAY-PRT  THRU  8600-DISPLAY-EXIT
  8550         MOVE    ' TRANS TYPE    = '
  8551           TO  DIS-LINE-REASON
  8552         MOVE  PENDING-RECORD-TYPE
  8553           TO  DIS-LINE-REC
  8554             PERFORM 8600-DISPLAY-PRT  THRU  8600-DISPLAY-EXIT
  8555         MOVE '  TYPE: 1=ISS   2=CAN   3=CLM   4=RSV   5=CHG'
  8556           TO  DL-FULL
  8557             PERFORM 8600-DISPLAY-PRT  THRU  8600-DISPLAY-EXIT
  8558         MOVE    ' CERT IN CTL   = '
  8559           TO  DIS-LINE-REASON
  8560         MOVE  CIR-CONTROL
  8561           TO  DIS-LINE-REC
  8562             PERFORM 8600-DISPLAY-PRT  THRU  8600-DISPLAY-EXIT
  8563         MOVE    ' BYPASSED TRANS  = '
  8564           TO  DIS-LINE-REASON
  8565         MOVE  PENDING-MATCH-CONTROL
  8566           TO  DIS-LINE-REC
  8567             PERFORM 8600-DISPLAY-PRT  THRU  8600-DISPLAY-EXIT
  8568         MOVE  SPACES
  8569           TO  DISPLAY-LINE
  8570             PERFORM 8600-DISPLAY-PRT  THRU  8600-DISPLAY-EXIT
  8571         DISPLAY 'BYPASSED TRANS = ' PENDING-MATCH-CONTROL.
  8572
  8573     MOVE PENDING-MATCH-CONTROL  TO  DTL-MATCH-CONTROL.
  8574     MOVE PENDING-RECORD-TYPE    TO  DTL-REC-TYPE.
  8575
  8576     IF ISSUE-TRANSACTION
  8577         MOVE 'ISS'              TO  DTL-REC-TYPE-DESC
  8578     ELSE
  8579         IF CANCEL-TRANSACTION
  8580             MOVE 'CAN'          TO  DTL-REC-TYPE-DESC
  8581         ELSE
  8582             IF CLAIM-TRANSACTION
  8583                 MOVE 'CLM'      TO  DTL-REC-TYPE-DESC
  8584             ELSE
  8585                 IF RESERVE-TRANSACTION
  8586                     MOVE 'RES'  TO  DTL-REC-TYPE-DESC
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 167
* ECS010MO.cbl
  8587                 ELSE
  8588                     IF UPDATE-TRANSACTION
  8589                         MOVE 'CHG'
  8590                                 TO  DTL-REC-TYPE-DESC.
  8591
  8592     MOVE CIR-CONTROL            TO  DTL-CERT-IN-CONTROL.
  8593     MOVE CR-FULL-CONTROL        TO  DTL-CERT-OUT-CONTROL.
  8594     MOVE 'DROPPED'              TO  DTL-STATUS.
  8595
  8596     IF ISSUE-TRANSACTION
  8597         MOVE PB-I-LF-PREMIUM-AMT
  8598                                 TO  MD2-LF-PREM
  8599         MOVE PB-I-LF-ALT-PREMIUM-AMT
  8600                                 TO  MD2-LF-ALT-PREM
  8601         MOVE PB-I-AH-PREMIUM-AMT
  8602                                 TO  MD2-AH-PREM
  8603         ADD PB-I-LF-PREMIUM-AMT TO W-MM-LF-PRM
  8604         ADD PB-I-LF-ALT-PREMIUM-AMT TO W-MM-LF-PRM
  8605         ADD PB-I-AH-PREMIUM-AMT TO W-MM-AH-PRM
  8606     ELSE
  8607         IF CANCEL-TRANSACTION
  8608             MOVE PB-C-LF-CANCEL-AMT
  8609                                 TO  MD3-LF-REFUND
  8610             MOVE PB-C-AH-CANCEL-AMT
  8611                                 TO  MD3-AH-REFUND
  8612             ADD PB-C-LF-CANCEL-AMT TO W-MM-LF-RFD
  8613             ADD PB-C-AH-CANCEL-AMT TO W-MM-AH-RFD
  8614         ELSE
  8615             IF CLAIM-TRANSACTION
  8616                 IF PC-LF-CLAIM  OR  PC-OB-LF-CLAIM
  8617                     MOVE PC-CLAIM-PAYMENT  TO MD4-LF-CLAIM
  8618                     MOVE ZEROS             TO MD4-AH-CLAIM
  8619                     ADD PC-CLAIM-PAYMENT TO W-MM-LF-CLM
  8620                 ELSE
  8621                     MOVE ZEROS             TO MD4-LF-CLAIM
  8622                     MOVE PC-CLAIM-PAYMENT  TO MD4-AH-CLAIM
  8623                     ADD PC-CLAIM-PAYMENT TO W-MM-AH-CLM.
  8624
  8625     IF  MISMATCH-LINE-COUNT GREATER THAN +56
  8626         ADD +1                  TO  MISMATCH-PAGE-NUMBER
  8627         MOVE MISMATCH-PAGE-NUMBER
  8628                                 TO  TR-PG
  8629         MOVE MISMATCH-HEADING-1 TO  MISMATCH-RPT
  8630         MOVE MR-CTL             TO  X
  8631         MOVE X TO LCP-ASA
  8632         PERFORM LCP-WRITE-POS-MISMATCH-RPT
  8633             THRU LCP-WRITE-END-MISMATCH-RPT
  8634         MOVE TR-HD-2            TO  MISMATCH-RPT
  8635         MOVE MR-CTL             TO  X
  8636         MOVE X TO LCP-ASA
  8637         PERFORM LCP-WRITE-POS-MISMATCH-RPT
  8638             THRU LCP-WRITE-END-MISMATCH-RPT
  8639         MOVE TR-HD-3            TO  MISMATCH-RPT
  8640         MOVE MR-CTL             TO  X
  8641         MOVE X TO LCP-ASA
  8642         PERFORM LCP-WRITE-POS-MISMATCH-RPT
  8643             THRU LCP-WRITE-END-MISMATCH-RPT
  8644         MOVE MISMATCH-HEADING-2 TO  MISMATCH-RPT
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 168
* ECS010MO.cbl
  8645         MOVE MR-CTL             TO  X
  8646         MOVE X TO LCP-ASA
  8647         PERFORM LCP-WRITE-POS-MISMATCH-RPT
  8648             THRU LCP-WRITE-END-MISMATCH-RPT
  8649         MOVE +6                 TO  MISMATCH-LINE-COUNT.
  8650
  8651     MOVE MISMATCH-DETAIL        TO  MISMATCH-RPT.
  8652     MOVE MR-CTL                 TO  X.
  8653     ADD +2                      TO  MISMATCH-LINE-COUNT.
  8654
  8655     MOVE X TO LCP-ASA
  8656     PERFORM LCP-WRITE-POS-MISMATCH-RPT
  8657         THRU LCP-WRITE-END-MISMATCH-RPT.
  8658
  8659     IF ISSUE-TRANSACTION
  8660         MOVE MISMATCH-DETAIL-2  TO  MISMATCH-RPT
  8661         MOVE MR-CTL             TO  X
  8662         ADD +1                  TO  MISMATCH-LINE-COUNT
  8663         MOVE X TO LCP-ASA
  8664         PERFORM LCP-WRITE-POS-MISMATCH-RPT
  8665             THRU LCP-WRITE-END-MISMATCH-RPT.
  8666
  8667     IF CANCEL-TRANSACTION
  8668         MOVE MISMATCH-DETAIL-3  TO  MISMATCH-RPT
  8669         MOVE MR-CTL             TO  X
  8670         ADD +1                  TO  MISMATCH-LINE-COUNT
  8671         MOVE X TO LCP-ASA
  8672         PERFORM LCP-WRITE-POS-MISMATCH-RPT
  8673             THRU LCP-WRITE-END-MISMATCH-RPT.
  8674
  8675     IF CLAIM-TRANSACTION
  8676         MOVE MISMATCH-DETAIL-4  TO  MISMATCH-RPT
  8677         MOVE MR-CTL             TO  X
  8678         ADD +1                  TO  MISMATCH-LINE-COUNT
  8679         MOVE X TO LCP-ASA
  8680         PERFORM LCP-WRITE-POS-MISMATCH-RPT
  8681             THRU LCP-WRITE-END-MISMATCH-RPT.
  8682
  8683     MOVE SPACES                 TO  MISMATCH-RPT.
  8684
  8685     GO TO 0300-READ-PENDING-TRANSACTIONS.
  8686
  8687 0395-GET-CERT-TRLRS.
  8688
  8689     MOVE WS-BANK-INIT           TO WS-BANK-COMMISSIONS
  8690     MOVE DTE-CLASIC-COMPANY-CD  TO CS-COMPANY-CD
  8691     MOVE CR-CARRIER             TO CS-CARRIER
  8692     MOVE CR-GROUPING            TO CS-GROUPING
  8693     MOVE CR-STATE               TO CS-STATE
  8694     MOVE CR-ACCOUNT             TO CS-ACCOUNT
  8695     MOVE WS-CR-BIN-DATE         TO CS-CERT-EFF-DT
  8696     MOVE CR-CERT-NO             TO CS-CERT-NO
  8697     MOVE 'A'                    TO CS-TRAILER-TYPE
  8698
  8699     READ ELCRTT
  8700
  8701     IF ELCRTT-FILE-STATUS = '00'
  8702        MOVE CS-BANK-COMMISSION-AREA
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 169
* ECS010MO.cbl
  8703                                 TO WS-BANK-COMMISSIONS
  8704     ELSE
  8705        IF ELCRTT-FILE-STATUS NOT = '10' AND '23'
  8706           DISPLAY ' BAD READ    ELCRTT ' ELCRTT-FILE-STATUS
  8707           PERFORM ABEND-PGM
  8708        END-IF
  8709     END-IF
  8710
  8711     .
  8712 0395-EXIT.
  8713     EXIT.
  8714
  8715******************************************************************
  8716***       W R I T E   C E R T I F I C A T E   R E C O R D      ***
  8717******************************************************************
  8718
  8719 0400-WRITE-CERT-RECORD.
  8720*     DISPLAY ' MADE 400 WRITE ' CR-FULL-CONTROL
  8721
  8722     IF CERTIFICATE-RECORD = LOW-VALUES
  8723         GO TO 0499-WRITE-CERT-X.
  8724
  8725     IF CR-ACCT-CONTROL LESS THAN AM-CONTROL-A
  8726         DISPLAY '*** MISMATCH BETWEEN CERT MASTER AND ACCOUNT'
  8727         DISPLAY '    CERT. CONTROL = ' CR-FULL-CONTROL
  8728         ADD  +1  TO  ERROR-COUNT
  8729         MOVE    '*** CERT ACCT LESS THAN TRANS ACCT'
  8730           TO  DL-FULL
  8731             PERFORM 8600-DISPLAY-PRT  THRU  8600-DISPLAY-EXIT
  8732         MOVE    ' CERT. CONTROL = '
  8733           TO  DIS-LINE-REASON
  8734         MOVE  CR-FULL-CONTROL
  8735           TO  DIS-LINE-REC
  8736             PERFORM 8600-DISPLAY-PRT  THRU  8600-DISPLAY-EXIT
  8737         MOVE  SPACES
  8738           TO  DISPLAY-LINE
  8739             PERFORM 8600-DISPLAY-PRT  THRU  8600-DISPLAY-EXIT
  8740            WRITE CERT-OUT-RECORD FROM CERTIFICATE-RECORD
  8741            ADD +1 TO CMOT-CNT
  8742            PERFORM 0200-CERT-MASTER-READ-ROUTINE
  8743               GO TO 0400-WRITE-CERT-RECORD.
  8744
  8745*          GO TO 0370-ACCOUNT-MISMATCH-ERROR.
  8746
  8747     IF CR-ACCT-CONTROL GREATER THAN AM-CONTROL-A
  8748         PERFORM 0100-ACCT-MASTER-READ-ROUTINE THRU
  8749                                              0199-READ-ACCOUNT-X
  8750         GO TO 0400-WRITE-CERT-RECORD.
  8751
  8752     IF CR-DT LESS THAN AM-EFFECT-DT  OR
  8753        CR-DT NOT LESS THAN AM-EXPIRE-DT
  8754         PERFORM 0100-ACCT-MASTER-READ-ROUTINE THRU
  8755                                              0199-READ-ACCOUNT-X
  8756         GO TO 0400-WRITE-CERT-RECORD.
  8757
  8758*     DISPLAY ' BEFORE REIN '
  8759     PERFORM 3000-REINSURE-ROUTINE THRU 3099-REINSURE-ROUTINE-X.
  8760*     DISPLAY ' AFTER REIN '
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 170
* ECS010MO.cbl
  8761
  8762     IF CR-LFTYP = ZEROS  AND
  8763        CR-DTHEXP NOT = ZEROS
  8764         ADD +1                     TO W-LFTYP-99
  8765         MOVE '99'                  TO CR-LFTYP  CLAS-LOOK
  8766         PERFORM 8300-LIFE-TYPE-LOOKUP THRU 8399-LIFE-LOOKUP-X.
  8767
  8768     IF CR-AHTYP = ZEROS  AND
  8769        CR-DISEXP NOT = ZEROS
  8770         ADD +1                     TO W-AHTYP-99
  8771         MOVE '99'                  TO CR-AHTYP  CLAS-LOOK
  8772         PERFORM 8400-A-H-TYPE-LOOKUP THRU 8499-A-H-LOOKUP-X.
  8773
  8774*     DISPLAY ' BEFORE EP BUMP'
  8775     PERFORM 4000-EP-BUMP-RTN THRU 4099-EP-BUMP-RTN-X.
  8776*     DISPLAY ' AFTER EP BUMP'
  8777
  8778     IF CR-LFTYP = '99'
  8779         MOVE '00'                  TO CR-LFTYP.
  8780     IF CR-AHTYP = '99'
  8781         MOVE '00'                  TO CR-AHTYP.
  8782
  8783*    IF CR-ISS-MICROFILM-NO NOT NUMERIC
  8784*        MOVE ZEROS                 TO CR-ISS-MICROFILM-NO.
  8785
  8786     IF CR-NH-INT-ON-REF NOT NUMERIC
  8787         MOVE ZEROS                 TO CR-NH-INT-ON-REF
  8788     END-IF
  8789
  8790     IF  CR-POLICY-IS-ACTIVE
  8791         ADD +1                  TO W-POLICY-ACTIVE-CTR
  8792         IF  CR-POLICY-IS-REISSUE
  8793             OR CR-POLICY-IS-MONTHLY
  8794             ADD +1              TO W-POLICY-REISSUE-CTR
  8795         ELSE
  8796             IF  CR-POLICY-IS-REIN-ONLY
  8797                 ADD +1          TO W-POLICY-REIN-CTR
  8798             ELSE
  8799                 NEXT SENTENCE
  8800     ELSE
  8801         ADD +1                  TO W-POLICY-INACTIVE-CTR.
  8802
  8803     IF DTE-PGM-OPT = '1'
  8804       IF REIN-IS-RISK-PREMIUM  AND
  8805          CR-ENTRY-DATE NOT = EOM-RUN-DATE
  8806         IF NOT CR-POLICY-IS-REISSUE  AND
  8807            NOT CR-POLICY-IS-DECLINED  AND
  8808            NOT CR-POLICY-IS-VOID
  8809            AND NOT CR-POLICY-IS-MONTHLY
  8810             MOVE '*'            TO RISK-PREM-FLAG
  8811             PERFORM 3100-REINSURE-ISSUE THRU
  8812                     3199-REINSURE-ISSUE-X.
  8813
* 8814     COPY ELCCRTM2.
  8815******************************************************************04/16/98
  8816*                                                                *ELCCRTM2
  8817*                                                                *ELCCRTM2
  8818*                            ELCCRTM2                            *   LV004
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 171
* ECS010MO.cbl (/apps/prod/cid1p/copy/ELCCRTM2)
  8819*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
  8820*                            VMOD=2.001                          *ELCCRTM2
  8821*                                                                *ELCCRTM2
  8822*   COPY WORKING STORAGE TO FILE VARIABLES                       *ELCCRTM2
  8823*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCCRTM2
  8824*                                                                *ELCCRTM2
  8825******************************************************************ELCCRTM2
  8826     MOVE WS-CR-DT-N                 TO  CR-DT.                      CL**2
  8827     MOVE WS-CR-LF-EXPIRE-DATE-N     TO  CR-LF-EXPIRE-DATE.          CL**2
  8828     MOVE WS-CR-AH-EXPIRE-DATE-N     TO  CR-AH-EXPIRE-DATE.          CL**2
  8829     MOVE WS-CR-ENTRY-DATE-N         TO  CR-ENTRY-DATE.              CL**2
  8830     MOVE WS-CR-LF-CANC-DT-N         TO  CR-LF-CANC-DT.              CL**2
  8831     MOVE WS-CR-LF-CANCEL-EXIT-DATE-N TO                             CL**2
  8832                                     CR-LF-CANCEL-EXIT-DATE.         CL**2
  8833     MOVE WS-CR-LF-CLAIM-EXIT-DATE-N TO  CR-LF-CLAIM-EXIT-DATE.      CL**2
  8834     MOVE WS-CR-AH-CANC-DT-N         TO  CR-AH-CANC-DT.              CL**2
  8835     MOVE WS-CR-AH-CANCEL-EXIT-DATE-N TO CR-AH-CANCEL-EXIT-DATE.     CL**2
  8836     MOVE WS-CR-AH-SETTLEMENT-EXIT-DATEN TO                          CL**2
  8837                                  CR-AH-SETTLEMENT-EXIT-DATE.     ELCCRTM2
  8838     MOVE WS-CR-DTH-DT-N             TO  CR-DTH-DT.                  CL**2
  8839     MOVE WS-CR-DTH-PAY-DT-N         TO  CR-DTH-PAY-DT.              CL**2
  8840     MOVE WS-CR-DIS-DT-N             TO  CR-DIS-DT.                  CL**2
  8841     MOVE WS-CR-DIS-PAY-DT-N         TO  CR-DIS-PAY-DT.              CL**2
  8842     MOVE WS-CR-DIS-PTO-DT-N         TO  CR-DIS-PTO-DT.              CL**2
  8843                                                                     CL**4
  8844     PERFORM  VARYING COPY-NDX FROM 1 BY 1                           CL**4
  8845                UNTIL COPY-NDX > 5                                   CL**4
  8846           MOVE WS-CR-DIS-INCUR-DT-N (COPY-NDX)   TO                 CL**2
  8847                                  CR-DIS-INCUR-DT (COPY-NDX)      ELCCRTM2
  8848     END-PERFORM.                                                 ELCCRTM2
  8849                                                                  ELCCRTM2
  8850
  8851     IF DTE-PGM-OPT = '1'
  8852         WRITE CERT-OUT-RECORD FROM CERTIFICATE-RECORD
  8853         ADD +1 TO CMOT-CNT.
  8854
  8855     MOVE SPACE                  TO REIN-FLG
  8856                                    RISK-REIN-FLAG
  8857                                    RISK-PREM-FLAG
  8858                                    RC-COMM-FLG.
  8859
  8860 0499-WRITE-CERT-X.
  8861     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 172
* ECS010MO.cbl
  8863******************************************************************
  8864***     A P P L Y   P E N D I N G   T R A N S A C T I O N S    ***
  8865******************************************************************
  8866
  8867 0500-APPLY-PENDING-BUSINESS.
  8868
  8869     IF CANCEL-TRANSACTION
  8870*         DISPLAY ' CANCEL TRAN ' CIR-CONTROL
  8871         GO TO 0600-PROCESS-CANCELLATIONS.
  8872
  8873     IF CLAIM-TRANSACTION
  8874*        DISPLAY ' CLAIM TRAN ' CIR-CONTROL
  8875         GO TO 0700-PROCESS-CLAIMS.
  8876
  8877     IF RESERVE-TRANSACTION
  8878*        DISPLAY ' RESV TRAN ' CIR-CONTROL
  8879         GO TO 0800-PROCESS-RESERVES.
  8880
  8881     IF UPDATE-TRANSACTION
  8882*        DISPLAY ' UPD TRAN ' CIR-CONTROL
  8883         GO TO 0900-PROCESS-CERT-CHANGES.
  8884
  8885******************************************************************
  8886***     P R O C E S S   I S S U E   T R A N S A C T I O N S    ***
  8887******************************************************************
  8888
  8889 0505-PROCESS-ISSUES.
  8890
  8891     MOVE INITIALIZED-CERTIFICATE TO CERTIFICATE-RECORD.
  8892     PERFORM CERT-DATE-LOAD.
  8893
  8894     ADD +1                      TO  W-POL-ISSUES.
  8895
  8896     MOVE PB-COMPANY-CD          TO  CR-COMPANY-CD.
  8897     MOVE PB-CARRIER             TO  CR-CARRIER.
  8898     MOVE PB-GROUPING            TO  CR-GROUPING.
  8899     MOVE PB-STATE               TO  CR-STATE.
  8900     MOVE PB-ACCOUNT             TO  CR-ACCOUNT.
  8901     MOVE PB-CERT-EFF-DT         TO  DC-BIN-DATE-1
  8902                                     WS-CR-BIN-DATE
  8903     MOVE ' '                    TO  DC-OPTION-CODE.
  8904     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
  8905     MOVE DC-GREG-DATE-CYMD      TO  CR-DT
  8906                                     WS-CR-DT-N.
  8907     MOVE PB-CERT-NO             TO  CR-CERT-NO.
  8908
  8909*     DISPLAY ' PROC ISS ' CR-FULL-CONTROL
  8910     MOVE PB-I-NAME              TO  CR-NAME.
  8911     MOVE PB-I-AGE               TO  CR-AGE.
  8912     MOVE PB-I-INSURED-SEX       TO  CR-SEX.
  8913     MOVE PB-I-SOC-SEC-NO        TO  CR-SOC-SEC.
  8914
  8915     IF PB-I-JOINT-COVERAGE
  8916         MOVE PB-I-JOINT-INSURED TO  CR-JOINT-NAME
  8917         MOVE PB-I-JOINT-AGE     TO  CR-JOINT-AGE
  8918     ELSE
  8919        IF (DTE-CLIENT EQUAL 'BOA')  AND
  8920           (PB-I-JOINT-INSURED NOT EQUAL SPACES)
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 173
* ECS010MO.cbl
  8921             MOVE PB-I-JOINT-INSURED TO  CR-JOINT-NAME.
  8922
  8923     IF PB-I-SUMMARY  OR
  8924        DTE-CLIENT = 'DMD'
  8925         MOVE PB-I-LIVES         TO  CR-LIVES.
  8926
  8927     IF PB-I-NUM-BILLED NOT NUMERIC
  8928        MOVE ZEROS               TO PB-I-NUM-BILLED.
  8929
  8930     IF PB-I-STATE-TAX NOT NUMERIC
  8931        MOVE ZEROS               TO PB-I-STATE-TAX.
  8932
  8933     IF PB-I-MUNI-TAX NOT NUMERIC
  8934        MOVE ZEROS               TO PB-I-MUNI-TAX.
  8935     IF PB-I-TOT-FEES NOT NUMERIC
  8936        MOVE ZEROS               TO PB-I-TOT-FEES
  8937     END-IF
  8938     IF PB-I-ADDL-CLP NOT NUMERIC
  8939        MOVE ZEROS               TO PB-I-ADDL-CLP
  8940     END-IF
  8941
  8942     MOVE PB-I-TOT-FEES          TO  CR-MOB-NET-TOT-FEES
  8943     MOVE PB-I-ADDL-CLP          TO  CR-ADDL-CLP
  8944     MOVE PB-I-CLP-STATE         TO  CR-CLP-STATE
  8945     MOVE PB-I-LF-CLP            TO  CR-LF-CLP
  8946     MOVE PB-I-AH-CLP            TO  CR-AH-CLP
  8947     MOVE PB-I-NUM-BILLED        TO  CR-BILLED.
  8948     MOVE PB-I-STATE-TAX         TO  CR-STATE-TAX.
  8949     MOVE PB-I-RESIDENT-STATE    TO  CR-RESIDENT-STATE.
  8950     MOVE PB-I-RATE-CODE         TO  CR-RATE-CODE.
  8951     MOVE PB-I-MUNI-TAX          TO  CR-MUNI-TAX.
  8952     MOVE PB-I-LOAN-APR          TO  CR-APR.
  8953     MOVE PB-I-PAY-FREQUENCY     TO  CR-PMT-FREQ.
  8954     MOVE PB-I-LOAN-TERM         TO  CR-LOAN-TERM.
  8955
  8956     IF PB-I-RATE-CLASS-OVRD = SPACES
  8957         MOVE PB-I-RATE-CLASS    TO  CR-RATING-CLASS
  8958     ELSE
  8959         MOVE PB-I-RATE-CLASS-OVRD TO CR-RATING-CLASS.
  8960
  8961     MOVE PB-I-POLICY-FORM-NO    TO  CR-POLICY-FORM-NO.
  8962     MOVE PB-I-BUSINESS-TYPE     TO  CR-GRPTYP.
  8963
  8964     IF PB-I-INDV-GRP-OVRD = SPACES
  8965         MOVE PB-I-INDV-GRP-CD   TO  CR-IND-GRP
  8966     ELSE
  8967         MOVE PB-I-INDV-GRP-OVRD TO  CR-IND-GRP.
  8968
  8969     IF CR-IND-GRP = 'I'  OR  '1'
  8970         MOVE '1'                TO  CR-IND-GRP
  8971     ELSE
  8972         MOVE '2'                TO  CR-IND-GRP.
  8973
  8974     IF PB-I-SKIP-CODE = '1'
  8975         MOVE 01                 TO  CR-SKIP.
  8976     IF PB-I-SKIP-CODE = '2'
  8977         MOVE 02                 TO  CR-SKIP.
  8978     IF PB-I-SKIP-CODE = '3'
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 174
* ECS010MO.cbl
  8979         MOVE 03                 TO  CR-SKIP.
  8980     IF PB-I-SKIP-CODE = '4'
  8981         MOVE 04                 TO  CR-SKIP.
  8982     IF PB-I-SKIP-CODE = '5'
  8983         MOVE 05                 TO  CR-SKIP.
  8984     IF PB-I-SKIP-CODE = '6'
  8985         MOVE 06                 TO  CR-SKIP.
  8986     IF PB-I-SKIP-CODE = '7'
  8987         MOVE 07                 TO  CR-SKIP.
  8988     IF PB-I-SKIP-CODE = '8'
  8989         MOVE 08                 TO  CR-SKIP.
  8990     IF PB-I-SKIP-CODE = '9'
  8991         MOVE 09                 TO  CR-SKIP.
  8992     IF PB-I-SKIP-CODE = 'A'
  8993         MOVE 10                 TO  CR-SKIP.
  8994     IF PB-I-SKIP-CODE = 'X'
  8995         MOVE 11                 TO  CR-SKIP.
  8996
  8997     MOVE PB-I-MORT-CODE         TO  CR-MORT.
  8998     MOVE PB-I-MEMBER-NO         TO  CR-MEMBER-NO.
  8999     MOVE PB-I-LOAN-OFFICER      TO  CR-LOAN-OFFICER.
  9000
  9001     IF PB-I-SPECIAL-REIN-CODE NOT = SPACE
  9002         MOVE PB-I-SPECIAL-REIN-CODE TO CR-REIN-SPEC
  9003                                        REIN-SPEC-A
  9004                                        REIN-SPEC-B
  9005                                        REIN-SPEC-C
  9006         MOVE REIN-SPEC          TO CR-REIN-TABLE
  9007     ELSE
  9008         MOVE AM-REI-TABLE       TO CR-REIN-TABLE.
  9009
  9010     IF (CR-CARRIER = '9')
  9011        AND (CR-STATE = 'NE')
  9012        AND (CR-ACCOUNT = '0001190900')
  9013        AND (CR-DT >= 20090825)
  9014        DISPLAY ' REPLACING TABLE ' CR-REIN-TABLE
  9015           ' WITH TABLE 0V9 FOR ' CR-STATE ' ' CR-ACCOUNT ' '
  9016           CR-CERT-NO ' ' CR-DT
  9017        MOVE '0V9'               TO CR-REIN-TABLE
  9018     END-IF
  9019
  9020     MOVE PB-I-1ST-PMT-DT        TO  DC-BIN-DATE-1.
  9021     MOVE ' '                    TO  DC-OPTION-CODE.
  9022     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
  9023     MOVE DC-GREG-DATE-1-YMD     TO  CR-LOAN-1ST-PMT-DT.
  9024
  9025     MOVE PB-I-EXTENTION-DAYS    TO  CR-PMT-EXTENSION-DAYS.
  9026
  9027     IF PB-I-LAST-ADD-ON-DT  =  ZEROS  OR  SPACES
  9028         MOVE LOW-VALUES          TO CR-LAST-ADD-ON-DT
  9029     ELSE
  9030         MOVE PB-I-LAST-ADD-ON-DT TO CR-LAST-ADD-ON-DT.
  9031
  9032     IF PB-I-UNDERWRITING-STATUS = 'A'  OR  'D'
  9033         MOVE 'Y'                TO  CR-UNDERWRITING-CODE.
  9034
  9035     IF PB-BATCH-ENTRY = SPACE  OR
  9036        (PB-I-ENTRY-STATUS = '2'  OR  'U')
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 175
* ECS010MO.cbl
  9037         MOVE '1'                TO  CR-ENTRY-STATUS
  9038     ELSE
  9039         MOVE PB-I-ENTRY-STATUS  TO  CR-ENTRY-STATUS.
  9040
  9041     IF PB-POLICY-IS-DECLINED
  9042         MOVE 'D'                TO  CR-ENTRY-STATUS.
  9043
  9044     IF PB-POLICY-IS-VOIDED
  9045         MOVE 'V'                TO  CR-ENTRY-STATUS.
  9046
  9047***  IF DTE-CLIENT NOT = 'CRI'
  9048***      IF PB-I-PREM-ACCTNG-ONLY
  9049***          MOVE '1'            TO  CR-ENTRY-STATUS.
  9050
  9051     MOVE EOM-RUN-DATE           TO  CR-ENTRY-DATE
  9052                                     WS-CR-ENTRY-DATE-N.
  9053
  9054*    IF PB-I-MICROFILM-NO NUMERIC
  9055*        MOVE PB-I-MICROFILM-NO  TO CR-ISS-MICROFILM-NO.
  9056
  9057     IF DTE-CLIENT = 'TIH' OR 'FLA' OR 'TII' OR
  9058        'TMS' OR 'NCL' OR 'HER' OR 'CID' OR 'DCC'
  9059         MOVE PB-I-SIG-SW        TO CR-USER-CODE
  9060     END-IF
  9061
  9062*************************************************
  9063***  ADDED IN 06/93 WHEN CERTIFICATE-RECORD   ***
  9064***  WAS CONVERTED TO 1056 BYTES.             ***
  9065*************************************************
  9066     MOVE PB-ENTRY-BATCH         TO  CR-ENTRY-BATCH.
  9067     MOVE PB-I-BENEFICIARY-NAME  TO  CR-BENEFICIARY.
  9068
  9069     MOVE PB-LAST-MAINT-BY       TO  CR-CSR-CODE.
  9070
  9071     MOVE CR-STATE               TO STATE-L.
  9072
  9073     PERFORM 8200-STATE-CODE-LOOKUP THRU 8299-STATE-LOOKUP-X.
  9074
  9075     PERFORM 8600-SETUP-DETAIL-LINE THRU 8689-SETUP-DETAIL-X.
  9076
  9077***************************************************
  9078***  WHEN AN ISSUE WAS PROCESSED THAT HAD       ***
  9079***  INVALID BENEFIT CODES LOCATED IN BOTH      ***
  9080***  BENEFITS,  THE 'ACTION' ON THE DETAIL LIST ***
  9081***  LINE WAS BYPASSED - ONLY THE CERTIFICATE,  ***
  9082***  THE EFFECTIVE DATE AND THE AGE PRINTED.    ***
  9083***************************************************
  9084     IF (PB-INVALID-LIFE AND PB-INVALID-AH)
  9085         IF CR-LF-POLICY-IS-RESTORE
  9086             MOVE 'RESTORED  '          TO TRD-LF-ACTION
  9087             GO TO 0530-PROCESS-ISSUE-CONTINUED
  9088         ELSE
  9089         IF CR-LF-POLICY-IS-REISSUE
  9090             MOVE 'RE-ISSUED '          TO TRD-LF-ACTION
  9091             GO TO 0530-PROCESS-ISSUE-CONTINUED
  9092         ELSE
  9093         IF CR-LF-IS-REIN-ONLY
  9094             MOVE 'REIN. ONLY'          TO TRD-LF-ACTION
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 176
* ECS010MO.cbl
  9095             GO TO 0530-PROCESS-ISSUE-CONTINUED
  9096         ELSE
  9097         IF CR-LF-IS-DECLINED
  9098             MOVE 'DECLINED  '          TO TRD-LF-ACTION
  9099             GO TO 0530-PROCESS-ISSUE-CONTINUED
  9100         ELSE
  9101         IF CR-LF-IS-VOID
  9102             MOVE 'VOIDED    '          TO TRD-LF-ACTION
  9103             GO TO 0530-PROCESS-ISSUE-CONTINUED
  9104         ELSE
  9105         IF CR-LF-POLICY-IS-MONTHLY
  9106            MOVE 'MONTHLY'       TO TRD-LF-ACTION
  9107            GO TO 0530-PROCESS-ISSUE-CONTINUED.
  9108
  9109
  9110 0510-PROCESS-LIFE-ISSUE.
  9111
  9112     IF PB-INVALID-LIFE
  9113         GO TO 0520-PROCESS-A-H-ISSUE.
  9114
  9115     MOVE PB-I-LF-BENEFIT-CD     TO  CLAS-LOOK.
  9116     PERFORM 8300-LIFE-TYPE-LOOKUP THRU 8399-LIFE-LOOKUP-X.
  9117     MOVE CLAS-LOOK              TO  PB-I-LF-BENEFIT-CD.
  9118
  9119     MOVE PB-I-LF-BENEFIT-CD     TO  CR-LFTYP.
  9120     MOVE PB-I-LF-TERM           TO  CR-LF-TERM.
  9121     MOVE PB-I-LF-CRIT-PER       TO  CR-LF-CRIT-PERIOD.
  9122     MOVE PB-I-TERM-IN-DAYS      TO  CR-LF-TERM-IN-DAYS.
  9123     MOVE PB-I-RATE-DEVIATION-LF TO  CR-LF-DEV-CODE.
  9124     MOVE PB-I-RATE-DEV-PCT-LF   TO  CR-LF-DEV-PCT.
  9125
  9126     MOVE PB-I-LF-BENEFIT-AMT    TO  CR-LFAMT.
  9127     MOVE PB-I-LF-PREMIUM-AMT    TO  CR-LFPRM.
  9128     IF PB-I-LF-POLICY-FEE  NUMERIC
  9129         MOVE PB-I-LF-POLICY-FEE TO  CR-LF-POLICY-FEE.
  9130     MOVE PB-I-LF-PREM-CALC      TO  CR-LFPRM-CALC.
  9131     MOVE PB-I-LF-RATE           TO  CR-LFPRM-RATE.
  9132
  9133     IF PB-I-LF-PREM-TAX NUMERIC
  9134        MOVE PB-I-LF-PREM-TAX    TO CR-LF-ISS-PREM-TAX
  9135     END-IF
  9136
  9137
  9138     IF PB-I-LF-REI-RATE NOT = ZEROS
  9139        IF DTE-CLIENT = 'DCC'
  9140           CONTINUE
  9141*          PERFORM 0795-DCC-NSP-LF  THRU 0795-EXIT
  9142        ELSE
  9143           MOVE PB-I-LF-REI-RATE TO CR-LF-NSP-PRM-RATE
  9144           COMPUTE CR-LF-NSP-PRM ROUNDED =
  9145                          (CR-LFAMT / 100) * PB-I-LF-REI-RATE
  9146        END-IF
  9147     END-IF
  9148
  9149     IF CLAS-I-EP (CLAS-INDEXL) = 'B'
  9150         MOVE PB-I-LF-ALT-BENEFIT-AMT TO CR-LFAMT-ALT
  9151         MOVE PB-I-LF-ALT-PREMIUM-AMT TO CR-LFPRM-ALT
  9152         MOVE PB-I-LF-ALT-PREM-CALC   TO CR-LFPRM-CALC-ALT
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 177
* ECS010MO.cbl
  9153         MOVE PB-I-LF-ALT-RATE        TO CR-LFPRM-RATE-ALT
  9154         IF PB-I-LF-ALT-REI-RATE NOT = ZEROS
  9155             COMPUTE CR-LF-NSP-PRM ROUNDED =  CR-LF-NSP-PRM +
  9156                 ((CR-LFAMT-ALT / 100) * PB-I-LF-ALT-REI-RATE).
  9157
  9158     MOVE PB-I-LF-EXPIRE-DT      TO  DC-BIN-DATE-1.
  9159     MOVE ' '                    TO  DC-OPTION-CODE.
  9160     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
  9161     MOVE DC-GREG-DATE-CYMD      TO  CR-LF-EXPIRE-DATE
  9162                                     WS-CR-LF-EXPIRE-DATE-N.
  9163
  9164     IF CR-ENTRY-STATUS = 'P'
  9165         MOVE '1'                TO  CR-LF-CURRENT-STATUS
  9166     ELSE
  9167         MOVE CR-ENTRY-STATUS    TO  CR-LF-CURRENT-STATUS.
  9168
  9169     MOVE CLAS-I-AB3 (CLAS-INDEXL)  TO TRD-LFTYP.
  9170     MOVE CR-LF-TERM                TO TRD-LFTRM.
  9171     COMPUTE TRD-LFPRM-RFND = CR-LFPRM + CR-LFPRM-ALT.
  9172     MOVE 'ISSUE     '              TO TRD-LF-ACTION.
  9173     MOVE CR-LF-CURRENT-STATUS      TO TRD-LF-STATUS.
  9174
  9175     IF CR-LF-POLICY-IS-RESTORE
  9176         MOVE 'RESTORED  '          TO TRD-LF-ACTION.
  9177     IF CR-LF-POLICY-IS-REISSUE
  9178         MOVE 'RE-ISSUED '          TO TRD-LF-ACTION.
  9179     IF CR-LF-IS-REIN-ONLY
  9180         MOVE 'REIN. ONLY'          TO TRD-LF-ACTION.
  9181
  9182     IF CR-LF-IS-DECLINED
  9183         MOVE 'DECLINED  '          TO TRD-LF-ACTION.
  9184
  9185     IF CR-LF-IS-VOID
  9186         MOVE 'VOIDED    '          TO TRD-LF-ACTION.
  9187     IF CR-LF-POLICY-IS-MONTHLY
  9188         MOVE 'MONTHLY   '          TO TRD-LF-ACTION.
  9189
  9190     ADD +1                      TO  W-LF-ISSUES.
  9191
  9192 0520-PROCESS-A-H-ISSUE.
  9193
  9194     IF PB-INVALID-AH
  9195         GO TO 0530-PROCESS-ISSUE-CONTINUED.
  9196
  9197     MOVE PB-I-AH-BENEFIT-CD     TO CLAS-LOOK.
  9198     PERFORM 8400-A-H-TYPE-LOOKUP THRU 8499-A-H-LOOKUP-X.
  9199     MOVE CLAS-LOOK              TO  PB-I-AH-BENEFIT-CD.
  9200
  9201     MOVE PB-I-AH-BENEFIT-CD     TO  CR-AHTYP.
  9202     MOVE PB-I-AH-TERM           TO  CR-AH-TERM.
  9203     MOVE PB-I-AH-CRIT-PER       TO  CR-AH-CRIT-PERIOD.
  9204     MOVE PB-I-RATE-DEVIATION-AH TO  CR-AH-DEV-CODE.
  9205     MOVE PB-I-RATE-DEV-PCT-AH   TO  CR-AH-DEV-PCT.
  9206
  9207     MOVE PB-I-AH-BENEFIT-AMT    TO  CR-AHAMT.
  9208     MOVE PB-I-AH-PREMIUM-AMT    TO  CR-AHPRM.
  9209     IF PB-I-AH-POLICY-FEE  NUMERIC
  9210         MOVE PB-I-AH-POLICY-FEE TO  CR-AH-POLICY-FEE.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 178
* ECS010MO.cbl
  9211     MOVE PB-I-AH-PREM-CALC      TO  CR-AHPRM-CALC.
  9212     MOVE PB-I-AH-RATE           TO  CR-AHPRM-RATE.
  9213
  9214     IF PB-I-AH-PREM-TAX NUMERIC
  9215        MOVE PB-I-AH-PREM-TAX    TO CR-AH-ISS-PREM-TAX
  9216     END-IF
  9217
  9218     IF PB-I-AH-REI-RATE NOT = ZEROS
  9219        IF DTE-CLIENT = 'DCC'
  9220           CONTINUE
  9221        ELSE
  9222           MOVE PB-I-AH-REI-RATE   TO  CR-AH-NSP-PRM-RATE
  9223           COMPUTE CR-AH-NSP-PRM ROUNDED =
  9224             ((CR-AHAMT * CR-AH-TERM) / 100) * PB-I-AH-REI-RATE
  9225        END-IF
  9226     END-IF
  9227
  9228     IF CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'G' OR 'L'
  9229        MOVE PB-I-AMOUNT-FINANCED TO CR-LFAMT
  9230        MOVE PB-I-UNPAID-CASH-PRICE TO CR-LFAMT-ALT
  9231        MOVE PB-I-CLP-AMOUNT     TO CR-LFPRM-ALT
  9232     END-IF
  9233     MOVE PB-I-AH-EXPIRE-DT      TO  DC-BIN-DATE-1.
  9234     MOVE ' '                    TO  DC-OPTION-CODE.
  9235     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
  9236     MOVE DC-GREG-DATE-CYMD      TO  CR-AH-EXPIRE-DATE
  9237                                     WS-CR-AH-EXPIRE-DATE-N.
  9238
  9239     IF CR-ENTRY-STATUS = 'P'
  9240         MOVE '1'                TO  CR-AH-CURRENT-STATUS
  9241     ELSE
  9242         MOVE CR-ENTRY-STATUS    TO  CR-AH-CURRENT-STATUS.
  9243
  9244     MOVE CLAS-I-AB3 (CLAS-INDEXA)  TO TRD-AHTYP.
  9245     MOVE CR-AH-TERM                TO TRD-AHTRM.
  9246     MOVE CR-AHPRM                  TO TRD-AHPRM-RFND.
  9247     MOVE 'ISSUE     '              TO TRD-AH-ACTION.
  9248     MOVE CR-AH-CURRENT-STATUS      TO TRD-AH-STATUS.
  9249
  9250     IF CR-AH-POLICY-IS-RESTORE
  9251         MOVE 'RESTORED  '          TO TRD-AH-ACTION.
  9252     IF CR-AH-POLICY-IS-REISSUE
  9253         MOVE 'RE-ISSUED '          TO TRD-AH-ACTION.
  9254     IF CR-AH-IS-REIN-ONLY
  9255         MOVE 'REIN. ONLY'          TO TRD-AH-ACTION.
  9256
  9257     IF CR-AH-IS-DECLINED
  9258         MOVE 'DECLINED  '          TO TRD-AH-ACTION.
  9259
  9260     IF CR-AH-IS-VOID
  9261         MOVE 'VOIDED    '          TO TRD-AH-ACTION.
  9262     IF CR-AH-POLICY-IS-MONTHLY
  9263         MOVE 'MONTHLY   '          TO TRD-AH-ACTION.
  9264
  9265     ADD +1                      TO  W-AH-ISSUES.
  9266
  9267 0530-PROCESS-ISSUE-CONTINUED.
  9268
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 179
* ECS010MO.cbl
  9269     PERFORM 1000-SET-COMMISSION-STRUCTURE THRU 1499-SET-COMM-X.
  9270     MOVE WK-NEW-RATES           TO CR-COMPENSATION-LEVELS.
  9271     MOVE  SPACES                TO WS-LEVELS-CHARGEBACK-SWITCHES.
  9272     PERFORM 1500-GET-ACCT-LEVEL-LF-COMM THRU 1519-ACCT-LF-COMM-X.
  9273
  9274     IF (DTE-CLIENT = 'DCC')
  9275        AND (CR-AHTYP NOT = '00' AND '  ')
  9276        IF CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'G' OR 'L'
  9277           PERFORM 0920-GET-BANK-FEES
  9278                                 THRU 0920-EXIT
  9279           PERFORM 0930-BUILD-CERT-TRLR
  9280                                 THRU 0930-EXIT
  9281           PERFORM 0395-GET-CERT-TRLRS
  9282                                 THRU 0395-EXIT
  9283        END-IF
  9284     END-IF
  9285
  9286     IF DTE-CLIENT = 'DCC'
  9287        IF CLAS-I-BEN-CATEGORY (CLAS-INDEXL) = 'D'
  9288           MOVE CR-LF-CLP        TO CR-LF-NSP-PRM
  9289        END-IF
  9290        IF CR-LF-DEV-PCT NOT = +0 AND +1
  9291           COMPUTE CR-LF-NSP-PRM ROUNDED =
  9292              (CR-LFPRM + CR-LFPRM-ALT) -
  9293              ((CR-LFPRM + CR-LFPRM-ALT) * CR-LCOM-L (1))
  9294        END-IF
  9295     END-IF
  9296
  9297     IF CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'G' OR 'L'
  9298        MOVE CR-LFPRM-ALT        TO CR-AH-NSP-PRM
  9299     ELSE
  9300        IF DTE-CLIENT = 'DCC'
  9301           IF CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'D'
  9302              MOVE CR-AH-CLP        TO CR-AH-NSP-PRM
  9303           END-IF
  9304           IF CR-AH-DEV-PCT NOT = +0 AND +1
  9305              COMPUTE CR-AH-NSP-PRM ROUNDED = CR-AHPRM -
  9306              (CR-AHPRM * CR-LCOM-AH (1))
  9307           END-IF
  9308        END-IF
  9309     END-IF
  9310
  9311     IF DTE-CLIENT = 'DCC'
  9312         IF PB-I-VIN > SPACES
  9313             PERFORM 0950-BUILD-CERT-C-TRLR THRU 0950-EXIT
  9314         END-IF
  9315     END-IF.
  9316
  9317     IF CR-ENTRY-STATUS = 'P'
  9318         MOVE '1'                   TO CR-ENTRY-STATUS.
  9319
  9320     IF CR-POLICY-IS-REISSUE  OR
  9321        CR-POLICY-IS-REIN-ONLY OR
  9322        CR-POLICY-IS-DECLINED OR
  9323        CR-POLICY-IS-VOID
  9324        OR CR-POLICY-IS-MONTHLY
  9325         GO TO 0590-END-ISSUE-PROCESSING.
  9326
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 180
* ECS010MO.cbl
  9327     ADD CR-LFPRM TO TPL-ISS-PRM (1).
  9328     IF CLAS-I-BEN-CATEGORY (CLAS-INDEXA) NOT = 'G' AND 'L'
  9329        ADD CR-LFPRM-ALT TO TPL-ISS-PRM (1)
  9330     END-IF
  9331     ADD CR-AHPRM TO TPA-ISS-PRM (1).
  9332
  9333     IF NOT PB-INVALID-LIFE
  9334         COMPUTE H-LFCM ROUNDED =
  9335                    (CR-LFPRM + CR-LFPRM-ALT) * ACCT-COMM-LF
  9336         MOVE H-LFCM                   TO TRD-LFCOM-CLM
  9337         ADD H-LFCM                    TO TPL-ACCT-COM (1).
  9338
  9339     IF NOT PB-INVALID-AH
  9340        IF CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'G' OR 'L'
  9341           COMPUTE H-AHCM ROUNDED = CR-AHPRM - (CR-LFPRM-ALT
  9342           + CR-ADDL-CLP)
  9343        ELSE
  9344           COMPUTE H-AHCM ROUNDED = CR-AHPRM * ACCT-COMM-AH
  9345        END-IF
  9346        MOVE H-AHCM                   TO TRD-AHCOM-CLM
  9347        ADD H-AHCM                    TO TPA-ACCT-COM (1)
  9348     END-IF
  9349
  9350     ADD +1 TO BC-G-ISS.
  9351     ADD +1 TO BC-COMM.
  9352     ADD CR-LFPRM TO BC-NET-WRIT.
  9353     IF CLAS-I-BEN-CATEGORY (CLAS-INDEXA) NOT = 'G' AND 'L'
  9354        ADD CR-LFPRM-ALT TO BC-NET-WRIT
  9355     END-IF
  9356     ADD CR-AHPRM TO BC-NET-WRIT.
  9357
  9358     IF CLAS-I-BAL (CLAS-INDEXL) = 'B'
  9359        ADD CR-LFPRM             TO BC-NET-WRIT-OB
  9360        ADD CR-LFPRM-ALT         TO BC-NET-WRIT-OB
  9361     ELSE
  9362        ADD CR-LFPRM             TO BC-NET-WRIT-SP
  9363        IF CLAS-I-BEN-CATEGORY (CLAS-INDEXA) NOT = 'G' AND 'L'
  9364           ADD CR-LFPRM-ALT      TO BC-NET-WRIT-SP
  9365        END-IF
  9366     END-IF
  9367
  9368     IF  CLAS-I-BAL (CLAS-INDEXA) = 'B'
  9369         ADD CR-AHPRM            TO BC-NET-WRIT-OB
  9370     ELSE
  9371         ADD CR-AHPRM            TO BC-NET-WRIT-SP.
  9372
  9373 0590-END-ISSUE-PROCESSING.
  9374
  9375     PERFORM 8690-PRINT-DETAIL-LINE THRU 8699-PRT-DETAIL-X.
  9376
  9377     PERFORM 3000-REINSURE-ROUTINE THRU 3099-REINSURE-ROUTINE-X.
  9378
  9379     IF NOT CR-POLICY-IS-REIN-ONLY  AND
  9380        NOT CR-POLICY-IS-DECLINED  AND
  9381        NOT CR-POLICY-IS-VOID
  9382         MOVE 'Y' TO BILLED-SWITCH
  9383         PERFORM 2100-BUILD-ISSUE-EXTRACT THRU 2199-BLD-ISSUE-X.
  9384
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 181
* ECS010MO.cbl
  9385     IF NOT CR-POLICY-IS-REISSUE  AND
  9386        NOT CR-POLICY-IS-DECLINED  AND
  9387        NOT CR-POLICY-IS-VOID
  9388        AND NOT CR-POLICY-IS-MONTHLY
  9389         PERFORM 3100-REINSURE-ISSUE THRU 3199-REINSURE-ISSUE-X.
  9390
  9391     MOVE '*'                   TO TRANSACTION-FLAG.
  9392     GO TO 0300-READ-PENDING-TRANSACTIONS.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 182
* ECS010MO.cbl
  9394******************************************************************
  9395***    P R O C E S S   C A N C E L   T R A N S A C T I O N S   ***
  9396******************************************************************
  9397
  9398 0600-PROCESS-CANCELLATIONS.
  9399
  9400*     DISPLAY ' PROC CNC ' CR-FULL-CONTROL
  9401     PERFORM 3000-REINSURE-ROUTINE THRU 3099-REINSURE-ROUTINE-X.
  9402
  9403     IF AM-RECALC-COMM = ('Y' OR '1')
  9404        PERFORM 1600-RECALC-COMM-EXTR
  9405                                 THRU 1899-RECALC-COMM-EXTR-X
  9406        MOVE ' '                 TO RECALC-TYPE
  9407     END-IF
  9408
  9409     MOVE CR-LFRFND               TO LIFE-REFUND.
  9410     MOVE CR-LFRFND-CALC          TO LIFE-REFUND-CALC.
  9411     MOVE CR-AHRFND               TO A-H-REFUND.
  9412     MOVE CR-AHRFND-CALC          TO A-H-REFUND-CALC.
  9413     MOVE CR-SUM-CAN-CNT-YTD      TO YTD-CANCEL-CNT.
  9414
  9415     MOVE PB-C-LF-CANCEL-AMT      TO CR-LFRFND.
  9416     IF CR-LFRFND-CALC = ZEROS
  9417         MOVE PB-C-LF-REF-CALC    TO CR-LFRFND-CALC
  9418                                     LIFE-REFUND-CALC
  9419     ELSE
  9420         MOVE PB-C-LF-CANCEL-AMT  TO CR-LFRFND-CALC.
  9421
  9422     MOVE PB-C-AH-CANCEL-AMT      TO CR-AHRFND.
  9423
  9424     IF CR-AHRFND-CALC = ZEROS
  9425        MOVE PB-C-AH-REF-CALC    TO CR-AHRFND-CALC
  9426                                    A-H-REFUND-CALC
  9427     ELSE
  9428        MOVE PB-C-AH-CANCEL-AMT  TO CR-AHRFND-CALC
  9429     END-IF
  9430
  9431     IF PB-C-POST-CARD-IND = 'Y' OR 'N'
  9432        MOVE PB-C-POST-CARD-IND  TO CR-POST-CARD-IND
  9433     ELSE
  9434        MOVE SPACES              TO CR-POST-CARD-IND
  9435     END-IF
  9436
  9437*    MOVE CR-DT                 TO  DC-GREG-DATE-CYMD.
  9438*    MOVE 'L'                   TO  DC-OPTION-CODE.
  9439*    PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
  9440*    MOVE DC-BIN-DATE-1         TO  WS-CR-BIN-DATE.
  9441
  9442     IF PB-C-NH-INT-ON-REFS NUMERIC
  9443        AND PB-C-NH-INT-ON-REFS NOT = ZEROS
  9444        MOVE PB-C-NH-INT-ON-REFS  TO CR-NH-INT-ON-REF
  9445     END-IF
  9446
  9447     IF PB-CI-STATE-TAX NOT NUMERIC
  9448        MOVE ZEROS               TO PB-CI-STATE-TAX.
  9449
  9450     IF PB-CI-MUNI-TAX NOT NUMERIC
  9451        MOVE ZEROS               TO PB-CI-MUNI-TAX.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 183
* ECS010MO.cbl
  9452
  9453     IF CR-CANCEL-STATE-TAX NUMERIC
  9454         ADD PB-CI-STATE-TAX  TO CR-CANCEL-STATE-TAX
  9455       ELSE
  9456         MOVE PB-CI-STATE-TAX TO CR-CANCEL-STATE-TAX.
  9457
  9458     IF CR-CANCEL-MUNI-TAX NUMERIC
  9459         ADD PB-CI-MUNI-TAX   TO CR-CANCEL-MUNI-TAX
  9460       ELSE
  9461         MOVE PB-CI-MUNI-TAX  TO CR-CANCEL-MUNI-TAX.
  9462
  9463     MOVE ZEROS                  TO MONTHS-DIFF-LF
  9464                                    MONTHS-DIFF-AH.
  9465
  9466     PERFORM 8600-SETUP-DETAIL-LINE THRU 8689-SETUP-DETAIL-X.
  9467
  9468 0630-PROCESS-LIFE-CANCEL.
  9469
  9470     IF CR-LFTYP = ZERO  OR
  9471        PB-C-LF-CANCEL-DT = LOW-VALUES  OR  SPACES
  9472         MOVE ZEROS               TO H-LFCM
  9473         GO TO 0650-PROCESS-A-H-CANCEL.
  9474
  9475     IF PB-C-LF-PREM-TAX NUMERIC
  9476        MOVE PB-C-LF-PREM-TAX    TO CR-LF-CNC-PREM-TAX
  9477     END-IF
  9478     MOVE PB-C-LF-CANCEL-DT       TO  DC-BIN-DATE-1.
  9479     MOVE ' '                     TO  DC-OPTION-CODE.
  9480     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
  9481     MOVE DC-GREG-DATE-CYMD       TO  CR-LF-CANC-DT
  9482                                      WS-CR-LF-CANC-DT-N.
  9483
  9484
  9485     MOVE PB-INPUT-DT            TO DC-BIN-DATE-1
  9486     MOVE ' '                    TO DC-OPTION-CODE
  9487     PERFORM 8000-DATE-CONVERT-ROUTINE
  9488                                 THRU 8099-DATE-CONVERT-X
  9489     IF CR-LF-CNC-ENT-DT NOT NUMERIC
  9490        MOVE ZEROS TO CR-LF-CNC-ENT-DT
  9491     END-IF
  9492     IF NO-CONVERSION-ERROR
  9493        IF CR-LF-CNC-ENT-DT = ZEROS
  9494           MOVE DC-GREG-DATE-CYMD TO CR-LF-CNC-ENT-DT
  9495        END-IF
  9496     END-IF
  9497
  9498     MOVE WS-CR-BIN-DATE          TO  DC-BIN-DATE-1.
  9499     MOVE PB-C-LF-CANCEL-DT       TO  DC-BIN-DATE-2.
  9500     MOVE '1'                     TO  DC-OPTION-CODE.
  9501     MOVE ' '                     TO  DC-CENTURY-ADJUSTMENT.
  9502     MOVE ZEROS                   TO  DC-ELAPSED-MONTHS
  9503                                      DC-ODD-DAYS-OVER
  9504                                      DC-ELAPSED-DAYS.
  9505     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
  9506     MOVE DC-ELAPSED-MONTHS       TO  MONTHS-DIFF-LF.
  9507
  9508     IF DC-ODD-DAYS-OVER   GREATER THAN  ZERO
  9509         ADD  +1                  TO  MONTHS-DIFF-LF.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 184
* ECS010MO.cbl
  9510
  9511     MOVE  'YYYYYYYYYY'           TO  WS-LF-CHARGEBACK-LEVELS.
  9512
  9513     MOVE  ZEROS                  TO  SUB.
  9514
  9515 0635-LIFE-CHARGEBACK-LOOP.
  9516
  9517     ADD    +1                    TO  SUB.
  9518
  9519     IF  SUB  GREATER THAN  +10
  9520         GO TO  0640-CONTINUE-LIFE-CANCEL.
  9521
  9522     IF  AM-COMM-CHARGEBACK (SUB)  NOT  NUMERIC  OR
  9523         AM-COMM-CHARGEBACK (SUB)  =  ZEROS
  9524         GO TO  0635-LIFE-CHARGEBACK-LOOP.
  9525
  9526     IF  AM-COMM-CHARGEBACK (SUB)  EQUAL    '99'
  9527         MOVE  'N'    TO  WS-LF-CHARGEBACK-SW (SUB).
  9528
  9529     IF  MONTHS-DIFF-LF GREATER THAN AM-COMM-CHARGEBACK (SUB)
  9530         MOVE  'N'        TO  WS-LF-CHARGEBACK-SW (SUB).
  9531
  9532     GO TO  0635-LIFE-CHARGEBACK-LOOP.
  9533
  9534
  9535 0640-CONTINUE-LIFE-CANCEL.
  9536
  9537     IF DC-ODD-DAYS-OVER GREATER THAN ZEROS
  9538        SUBTRACT +1 FROM MONTHS-DIFF-LF.
  9539
  9540     PERFORM 1500-GET-ACCT-LEVEL-LF-COMM THRU 1519-ACCT-LF-COMM-X.
  9541
  9542     IF DTE-CLIENT = 'GIC'
  9543         IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'B'
  9544             MOVE CR-LFPRM-CALC   TO CR-LFRFND-CALC
  9545                                     LIFE-REFUND-CALC.
  9546
  9547*    IF DTE-CLIENT = 'TMS'
  9548     MOVE PB-LF-REFUND-TYPE      TO CR-LF-REFUND-TYPE
  9549
  9550     IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'Z'
  9551         MOVE PB-C-LIVES               TO CR-SUM-CAN-CNT-YTD
  9552     ELSE
  9553         IF CR-LF-CANCEL-EXIT-DATE = ZEROS
  9554             MOVE CR-LF-CURRENT-STATUS TO CR-LF-STATUS-AT-CANCEL
  9555             MOVE '8'                  TO CR-LF-CURRENT-STATUS
  9556             MOVE PB-C-LF-COMM-CHARGEBACK TO CR-LF-COMM-CHARGEBACK
  9557             MOVE EOM-RUN-DATE      TO CR-LF-CANCEL-EXIT-DATE
  9558                                       WS-CR-LF-CANCEL-EXIT-DATE-N
  9559         ELSE
  9560             IF CR-LF-CURRENT-STATUS = '6'
  9561                 MOVE '8'              TO CR-LF-CURRENT-STATUS
  9562                 MOVE PB-C-LF-COMM-CHARGEBACK
  9563                                       TO CR-LF-COMM-CHARGEBACK
  9564                 MOVE EOM-RUN-DATE TO CR-LF-CANCEL-EXIT-DATE
  9565                                      WS-CR-LF-CANCEL-EXIT-DATE-N.
  9566
  9567*************************************************
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 185
* ECS010MO.cbl
  9568***  ADDED IN 06/93 WHEN CERTIFICATE-RECORD   ***
  9569***  WAS CONVERTED TO 1056 BYTES.             ***
  9570*************************************************
  9571     MOVE PB-ENTRY-BATCH               TO CR-LF-EXIT-BATCH.
  9572
  9573     MOVE CLAS-I-AB3 (CLAS-INDEXL)     TO TRD-LFTYP.
  9574     MOVE CR-LF-TERM                   TO TRD-LFTRM.
  9575     MOVE CR-LFRFND                    TO TRD-LFPRM-RFND.
  9576
  9577     COMPUTE H-LFCM ROUNDED =
  9578                              (CR-LFRFND * ACCT-COMM-LF) * (-1).
  9579     MOVE H-LFCM                       TO TRD-LFCOM-CLM.
  9580
  9581     MOVE CR-LF-CNC-MO                 TO TRD-LFACTMO.
  9582     MOVE CR-LF-CNC-DA                 TO TRD-LFACTDA.
  9583     MOVE CR-LF-CNC-YR                 TO TRD-LFACTYR.
  9584     MOVE '/'                          TO TRD-LF-S1  TRD-LF-S2.
  9585
  9586     MOVE 'CANCEL    '                 TO TRD-LF-ACTION.
  9587     MOVE CR-LF-CURRENT-STATUS         TO TRD-LF-STATUS.
  9588
  9589 0650-PROCESS-A-H-CANCEL.
  9590
  9591     IF CR-AHTYP = ZERO  OR
  9592        PB-C-AH-CANCEL-DT = LOW-VALUES  OR  SPACES
  9593         MOVE ZEROS               TO H-AHCM
  9594         GO TO 0660-PROCESS-CANCEL-CONTINUE.
  9595
  9596*    MOVE CR-DT                 TO  DC-GREG-DATE-CYMD.
  9597*    MOVE 'L'                   TO  DC-OPTION-CODE.
  9598*    PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
  9599*    MOVE DC-BIN-DATE-1         TO  WS-CR-BIN-DATE.
  9600
  9601     MOVE PB-C-AH-CANCEL-DT       TO  DC-BIN-DATE-1.
  9602     MOVE ' '                     TO  DC-OPTION-CODE.
  9603     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
  9604     MOVE DC-GREG-DATE-CYMD       TO  CR-AH-CANC-DT
  9605                                      WS-CR-AH-CANC-DT-N.
  9606
  9607     MOVE PB-INPUT-DT            TO DC-BIN-DATE-1
  9608     MOVE ' '                    TO DC-OPTION-CODE
  9609     PERFORM 8000-DATE-CONVERT-ROUTINE
  9610                                 THRU 8099-DATE-CONVERT-X
  9611     IF CR-AH-CNC-ENT-DT NOT NUMERIC
  9612        MOVE ZEROS TO CR-AH-CNC-ENT-DT
  9613     END-IF
  9614     IF NO-CONVERSION-ERROR
  9615        IF CR-AH-CNC-ENT-DT = ZEROS
  9616           MOVE DC-GREG-DATE-CYMD TO CR-AH-CNC-ENT-DT
  9617        END-IF
  9618     END-IF
  9619
  9620     IF PB-C-AH-PREM-TAX NUMERIC
  9621        MOVE PB-C-AH-PREM-TAX    TO CR-AH-CNC-PREM-TAX
  9622     END-IF
  9623     MOVE WS-CR-BIN-DATE          TO  DC-BIN-DATE-1.
  9624     MOVE PB-C-AH-CANCEL-DT       TO  DC-BIN-DATE-2.
  9625     MOVE '1'                     TO  DC-OPTION-CODE.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 186
* ECS010MO.cbl
  9626     MOVE ' '                     TO  DC-CENTURY-ADJUSTMENT.
  9627     MOVE ZEROS                   TO  DC-ELAPSED-MONTHS
  9628                                      DC-ODD-DAYS-OVER
  9629                                      DC-ELAPSED-DAYS.
  9630     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
  9631     MOVE DC-ELAPSED-MONTHS       TO  MONTHS-DIFF-AH.
  9632
  9633     IF  DC-ODD-DAYS-OVER   GREATER THAN   ZERO
  9634          ADD  +1                 TO  MONTHS-DIFF-AH.
  9635
  9636     MOVE  'YYYYYYYYYY'           TO  WS-AH-CHARGEBACK-LEVELS.
  9637     IF CR-BANK-NOCHRGB-MONTHS NOT NUMERIC
  9638        MOVE ZEROS               TO CR-BANK-NOCHRGB-MONTHS
  9639     END-IF
  9640*    IF DTE-CLIENT = 'DCC'
  9641*       IF (CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'G' OR 'L')
  9642*          AND (CR-BANK-NOCHRGB-MONTHS > ZEROS)
  9643*          PERFORM VARYING SUB FROM +1 BY +1 UNTIL
  9644*             (CR-BANK-NO = CR-COM-AGT (SUB))
  9645*             OR (SUB > +10)
  9646*          END-PERFORM
  9647*          IF CR-BANK-NO = CR-COM-AGT (SUB)
  9648*             MOVE CR-BANK-NOCHRGB-MONTHS
  9649*                                TO AM-COMM-CHARGEBACK (SUB)
  9650*          END-IF
  9651*       END-IF
  9652*    END-IF
  9653
  9654
  9655     MOVE 'Y'                     TO WS-FIRST-K
  9656     MOVE ' '                     TO WS-DLR-INC-CHG-BACK
  9657     MOVE  ZEROS                  TO  SUB.
  9658
  9659 0653-A-H-CHARGEBACK-LOOP.
  9660
  9661     ADD    +1                    TO  SUB.
  9662
  9663     IF  SUB  GREATER THAN  +10
  9664         GO TO  0655-CONTINUE-A-H-CANCEL.
  9665
  9666     IF  AM-COMM-CHARGEBACK (SUB)  NOT  NUMERIC  OR
  9667         AM-COMM-CHARGEBACK (SUB)  =  ZEROS
  9668         GO TO  0653-A-H-CHARGEBACK-LOOP.
  9669
  9670     IF  AM-COMM-CHARGEBACK (SUB)  EQUAL    '99'
  9671         MOVE  'N'    TO  WS-AH-CHARGEBACK-SW (SUB).
  9672
  9673     IF  (MONTHS-DIFF-AH GREATER THAN AM-COMM-CHARGEBACK (SUB))
  9674         OR ((DTE-CLIENT = 'DCC')
  9675             AND (CR-AHRFND = ZEROS))
  9676         MOVE  'N'        TO  WS-AH-CHARGEBACK-SW (SUB).
  9677
  9678     GO TO  0653-A-H-CHARGEBACK-LOOP.
  9679
  9680
  9681 0655-CONTINUE-A-H-CANCEL.
  9682
  9683     IF DC-ODD-DAYS-OVER GREATER THAN ZEROS
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 187
* ECS010MO.cbl
  9684        SUBTRACT +1 FROM MONTHS-DIFF-AH.
  9685
  9686     PERFORM 1550-GET-ACCT-LEVEL-AH-COMM THRU 1599-ACCT-AH-COMM-X.
  9687
  9688     IF DTE-CLIENT = 'GIC'
  9689         IF CLAS-I-CALC-TYPE (CLAS-INDEXA) = 'B'
  9690             MOVE CR-AHPRM-CALC   TO CR-AHRFND-CALC
  9691                                     A-H-REFUND-CALC.
  9692
  9693*    IF DTE-CLIENT = 'TMS'
  9694     MOVE PB-AH-REFUND-TYPE      TO CR-AH-REFUND-TYPE
  9695*    DISPLAY ' PEND AH REF TYPE ' PB-AH-REFUND-TYPE
  9696
  9697
  9698     IF CLAS-I-CALC-TYPE (CLAS-INDEXA) = 'Z'
  9699         MOVE PB-C-LIVES               TO CR-SUM-CAN-CNT-YTD
  9700     ELSE
  9701         IF CR-AH-CANCEL-EXIT-DATE = ZEROS
  9702             MOVE CR-AH-CURRENT-STATUS TO CR-AH-STATUS-AT-CANCEL
  9703             MOVE '8'                  TO CR-AH-CURRENT-STATUS
  9704             MOVE PB-C-AH-COMM-CHARGEBACK TO CR-AH-COMM-CHARGEBACK
  9705             MOVE EOM-RUN-DATE    TO CR-AH-CANCEL-EXIT-DATE
  9706                                     WS-CR-AH-CANCEL-EXIT-DATE-N
  9707         ELSE
  9708             IF CR-AH-CURRENT-STATUS = '7'
  9709                 MOVE '8'              TO CR-AH-CURRENT-STATUS
  9710                 MOVE PB-C-AH-COMM-CHARGEBACK
  9711                                       TO CR-AH-COMM-CHARGEBACK
  9712                 MOVE EOM-RUN-DATE TO CR-AH-CANCEL-EXIT-DATE
  9713                                      WS-CR-AH-CANCEL-EXIT-DATE-N.
  9714
  9715*************************************************
  9716***  ADDED IN 06/93 WHEN CERTIFICATE-RECORD   ***
  9717***  WAS CONVERTED TO 1056 BYTES.             ***
  9718*************************************************
  9719     MOVE PB-ENTRY-BATCH               TO CR-AH-EXIT-BATCH.
  9720
  9721     MOVE CLAS-I-AB3 (CLAS-INDEXA)     TO TRD-AHTYP.
  9722     MOVE CR-AH-TERM                   TO TRD-AHTRM.
  9723     MOVE CR-AHRFND                    TO TRD-AHPRM-RFND.
  9724
  9725     IF CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'G' OR 'L'
  9726        COMPUTE CNC-FACT = CR-AHRFND / CR-AHPRM
  9727        COMPUTE H-AHCM ROUNDED = CNC-FACT *
  9728           (CR-AHPRM - (CR-LFPRM-ALT
  9729           + CR-ADDL-CLP)) * -1
  9730     ELSE
  9731        COMPUTE H-AHCM ROUNDED =
  9732          (CR-AHRFND * ACCT-COMM-AH) * (-1)
  9733     END-IF
  9734
  9735     MOVE H-AHCM                       TO TRD-AHCOM-CLM.
  9736
  9737     MOVE CR-AH-CNC-MO                 TO TRD-AHACTMO.
  9738     MOVE CR-AH-CNC-DA                 TO TRD-AHACTDA.
  9739     MOVE CR-AH-CNC-YR                 TO TRD-AHACTYR
  9740     MOVE '/'                          TO TRD-AH-S1  TRD-AH-S2.
  9741
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 188
* ECS010MO.cbl
  9742     MOVE 'CANCEL    '                 TO TRD-AH-ACTION.
  9743     MOVE CR-AH-CURRENT-STATUS         TO TRD-AH-STATUS.
  9744
  9745 0660-PROCESS-CANCEL-CONTINUE.
  9746
  9747     PERFORM 8690-PRINT-DETAIL-LINE THRU 8699-PRT-DETAIL-X.
  9748
  9749     IF CR-POLICY-IS-REIN-ONLY
  9750        GO TO 0660-CONT.
  9751
  9752     MOVE 'Y'                    TO BILLED-SWITCH.
  9753     PERFORM 2200-BUILD-CANCEL-EXTRACT THRU 2299-BLD-CANCEL-X.
  9754
  9755     IF CR-POLICY-IS-MONTHLY
  9756        GO TO 0660-CONT
  9757     END-IF
  9758
  9759     ADD +1                      TO BC-G-CNC.
  9760     ADD +1                      TO BC-COMM.
  9761     SUBTRACT CR-LFRFND FROM BC-NET-WRIT.
  9762     SUBTRACT CR-AHRFND FROM BC-NET-WRIT.
  9763     ADD CR-LFRFND               TO TPL-CNC-PRM (1).
  9764     ADD H-LFCM                  TO TPL-ACCT-COM (1).
  9765     ADD CR-AHRFND               TO TPA-CNC-PRM (1).
  9766     ADD H-AHCM                  TO TPA-ACCT-COM (1).
  9767
  9768     IF  CLAS-I-BAL (CLAS-INDEXL) = 'B'
  9769         SUBTRACT CR-LFRFND FROM BC-NET-WRIT-OB
  9770     ELSE
  9771         SUBTRACT CR-LFRFND FROM BC-NET-WRIT-SP.
  9772
  9773     IF  CLAS-I-BAL (CLAS-INDEXA) = 'B'
  9774         SUBTRACT CR-AHRFND FROM BC-NET-WRIT-OB
  9775     ELSE
  9776         SUBTRACT CR-AHRFND FROM BC-NET-WRIT-SP.
  9777
  9778
  9779 0660-CONT.
  9780
  9781     MOVE MONTHS-DIFF-LF            TO REIN-LCNC-EARN-TERM.
  9782     MOVE MONTHS-DIFF-AH            TO REIN-ACNC-EARN-TERM.
  9783
  9784     IF CR-LFRFND NEGATIVE
  9785       IF CR-LFRFND + LIFE-REFUND = ZEROS
  9786           MOVE '*'                 TO REIN-VOID-LF-SW.
  9787     IF CR-AHRFND NEGATIVE
  9788       IF CR-AHRFND + A-H-REFUND = ZEROS
  9789           MOVE '*'                 TO REIN-VOID-AH-SW.
  9790
  9791     IF CR-LFRFND NOT = ZEROS
  9792       IF CR-LF-CANCEL-EXIT-DATE NOT = EOM-RUN-DATE
  9793           MOVE '*'                 TO REIN-ADDL-LF-SW.
  9794     IF CR-AHRFND NOT = ZEROS
  9795       IF CR-AH-CANCEL-EXIT-DATE NOT = EOM-RUN-DATE
  9796           MOVE '*'                 TO REIN-ADDL-AH-SW.
  9797
  9798     IF CR-DT = CR-LF-CANC-DT
  9799       MOVE '*'                     TO REIN-CANCEL-LF-SW.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 189
* ECS010MO.cbl
  9800     IF CR-DT = CR-AH-CANC-DT
  9801       MOVE '*'                     TO REIN-CANCEL-AH-SW.
  9802
  9803     PERFORM 3200-REINSURE-CANCEL THRU 3299-REINSURE-CANCEL-X.
  9804
  9805     MOVE SPACES                    TO REIN-VOID-LF-SW
  9806                                       REIN-VOID-AH-SW
  9807                                       REIN-ADDL-LF-SW
  9808                                       REIN-ADDL-AH-SW.
  9809
  9810     COMPUTE CR-LFRFND = LIFE-REFUND + PB-C-LF-CANCEL-AMT.
  9811     MOVE LIFE-REFUND-CALC          TO CR-LFRFND-CALC.
  9812
  9813     COMPUTE CR-AHRFND = A-H-REFUND  + PB-C-AH-CANCEL-AMT.
  9814     MOVE A-H-REFUND-CALC           TO CR-AHRFND-CALC.
  9815
  9816     IF (CR-LFTYP NOT = ZERO  AND
  9817        CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'Z')  OR
  9818        (CR-AHTYP NOT = ZERO  AND
  9819        CLAS-I-CALC-TYPE (CLAS-INDEXA) = 'Z')
  9820         ADD PB-C-LIVES                TO CR-SUM-CAN-CNT-ITD
  9821         COMPUTE CR-SUM-CAN-CNT-YTD = YTD-CANCEL-CNT + PB-C-LIVES.
  9822
  9823 0670-LIFE-CANCEL-VOID.
  9824
  9825     IF CR-LFTYP NOT = ZERO  AND
  9826        CR-LFRFND = ZERO  AND
  9827        PB-C-LF-CANCEL-AMT NEGATIVE
  9828         NEXT SENTENCE
  9829     ELSE
  9830         GO TO 0680-A-H-CANCEL-VOID.
  9831
  9832     MOVE ZEROS                        TO CR-LF-CANCEL-EXIT-DATE
  9833                                       WS-CR-LF-CANCEL-EXIT-DATE-N
  9834                                          CR-LF-CANC-DT
  9835                                          WS-CR-LF-CANC-DT-N
  9836                                          CR-LFRFND-CALC.
  9837
  9838     MOVE SPACES                       TO CR-LF-COMM-CHARGEBACK.
  9839
  9840     IF CR-LF-CANCEL-APPLIED
  9841         MOVE CR-LF-STATUS-AT-CANCEL   TO CR-LF-CURRENT-STATUS
  9842         MOVE ' '                      TO CR-LF-STATUS-AT-CANCEL
  9843     ELSE
  9844         MOVE CR-LF-STATUS-AT-CANCEL   TO CR-LF-STATUS-AT-DEATH
  9845         MOVE ' '                      TO CR-LF-STATUS-AT-CANCEL.
  9846
  9847     PERFORM 8600-SETUP-DETAIL-LINE THRU 8689-SETUP-DETAIL-X.
  9848
  9849     MOVE 'VOID CANCL'                 TO TRD-LF-ACTION.
  9850     MOVE CR-LF-CURRENT-STATUS         TO TRD-LF-STATUS.
  9851
  9852     PERFORM 8690-PRINT-DETAIL-LINE THRU 8699-PRT-DETAIL-X.
  9853
  9854 0680-A-H-CANCEL-VOID.
  9855
  9856     IF CR-AHTYP NOT = ZERO  AND
  9857        CR-AHRFND = ZERO  AND
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 190
* ECS010MO.cbl
  9858        PB-C-AH-CANCEL-AMT NEGATIVE
  9859         NEXT SENTENCE
  9860     ELSE
  9861         GO TO 0690-END-CANCEL-PROCESSING.
  9862
  9863     MOVE ZEROS                      TO CR-AH-CANCEL-EXIT-DATE
  9864                                     WS-CR-AH-CANCEL-EXIT-DATE-N
  9865                                        CR-AH-CANC-DT
  9866                                        WS-CR-AH-CANC-DT-N
  9867                                        CR-AHRFND-CALC.
  9868
  9869     MOVE SPACES                        TO CR-AH-COMM-CHARGEBACK.
  9870
  9871     IF CR-AH-CANCEL-APPLIED
  9872         MOVE CR-AH-STATUS-AT-CANCEL    TO CR-AH-CURRENT-STATUS
  9873         MOVE ' '                       TO CR-AH-STATUS-AT-CANCEL
  9874     ELSE
  9875         MOVE CR-AH-STATUS-AT-CANCEL
  9876                                    TO CR-AH-STATUS-AT-SETTLEMENT
  9877         MOVE ' '                       TO CR-AH-STATUS-AT-CANCEL.
  9878
  9879     PERFORM 8600-SETUP-DETAIL-LINE THRU 8689-SETUP-DETAIL-X.
  9880
  9881     MOVE 'VOID CANCL'                  TO TRD-AH-ACTION.
  9882     MOVE CR-AH-CURRENT-STATUS          TO TRD-AH-STATUS.
  9883
  9884     PERFORM 8690-PRINT-DETAIL-LINE THRU 8699-PRT-DETAIL-X.
  9885
  9886 0690-END-CANCEL-PROCESSING.
  9887
  9888     IF CR-LF-CANC-DT = ZEROS  AND
  9889        CR-AH-CANC-DT = ZEROS
  9890         MOVE ZEROS             TO CR-NH-INT-ON-REF
  9891     END-IF
  9892
  9893     IF LIFE-REFUND = ZERO  AND  A-H-REFUND = ZERO
  9894         NEXT SENTENCE
  9895     ELSE
  9896         MOVE 'X'               TO REIN-RT-SW
  9897         PERFORM 3200-REINSURE-CANCEL THRU 3299-REINSURE-CANCEL-X
  9898         MOVE ' '               TO REIN-RT-SW.
  9899
  9900     MOVE '*'                   TO TRANSACTION-FLAG.
  9901     GO TO 0300-READ-PENDING-TRANSACTIONS.
  9902
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 191
* ECS010MO.cbl
  9904******************************************************************
  9905***    P R O C E S S   C L A I M S   T R A N S A C T I O N S   ***
  9906******************************************************************
  9907
  9908 0700-PROCESS-CLAIMS.
  9909
  9910     IF NOT PC-LF-CLAIM  AND  NOT  PC-OB-LF-CLAIM  AND
  9911        NOT PC-AH-CLAIM  AND  NOT  PC-OB-AH-CLAIM
  9912         DISPLAY 'INVALID CLAIM TYPE TO ECS010 '
  9913             PENDING-MATCH-CONTROL
  9914         MOVE 0301 TO WS-ABEND-CODE
  9915         DISPLAY '******************************'
  9916         DISPLAY '***** ERROR LOCATION 011 *****'
  9917         DISPLAY '******************************'
  9918         MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
  9919         GO TO ABEND-PGM.
  9920
  9921     PERFORM 3000-REINSURE-ROUTINE THRU 3099-REINSURE-ROUTINE-X.
  9922
  9923     ADD +1                       TO  W-LF-CLAIMS.
  9924
  9925     MOVE PC-INCURRED-DT          TO  DC-BIN-DATE-1.
  9926     MOVE ' '                     TO  DC-OPTION-CODE.
  9927     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
  9928     MOVE DC-GREG-DATE-CYMD       TO  INCURRED-DATE.
  9929
  9930     MOVE PC-REPORTED-DT          TO  DC-BIN-DATE-1.
  9931     MOVE ' '                     TO  DC-OPTION-CODE.
  9932     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
  9933     MOVE DC-GREG-DATE-1-YMD      TO  REPORTED-DATE.
  9934
  9935     MOVE PC-PAYMENT-DT           TO  DC-BIN-DATE-1.
  9936     MOVE ' '                     TO  DC-OPTION-CODE.
  9937     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
  9938     MOVE DC-GREG-DATE-CYMD       TO  PAYMENT-DATE.
  9939
  9940     MOVE PC-PAID-THRU-DT         TO  DC-BIN-DATE-1.
  9941     MOVE ' '                     TO  DC-OPTION-CODE.
  9942     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
  9943     MOVE DC-GREG-DATE-CYMD       TO  PAY-TO-DATE.
  9944
  9945     PERFORM 8600-SETUP-DETAIL-LINE THRU 8689-SETUP-DETAIL-X.
  9946
  9947     IF DTE-CLIENT = 'LAP'  OR  'RMC'
  9948       MOVE PC-CHECK-NO            TO WS-CHECK-NUMBER
  9949       IF WS-CHECK-NO = 'DEDU'  OR  ' DED'  OR  '0DED'
  9950         IF CR-CLAIM-DEDUCT-WITHHELD = +99999.99
  9951             MOVE PC-CLAIM-PAYMENT TO CR-CLAIM-DEDUCT-WITHHELD
  9952         ELSE
  9953             ADD PC-CLAIM-PAYMENT  TO CR-CLAIM-DEDUCT-WITHHELD.
  9954
  9955     IF PC-AH-CLAIM  OR  PC-OB-AH-CLAIM
  9956         GO TO 0750-PROCESS-DISABILITY-CLAIM.
  9957
  9958******************************************************************
  9959***           P R O C E S S   D E A T H   C L A I M            ***
  9960******************************************************************
  9961
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 192
* ECS010MO.cbl
  9962     IF REIN-IS-RISK-PREMIUM
  9963       IF CR-DTH-DT = ZEROS
  9964           MOVE INCURRED-DATE      TO DC-GREG-DATE-CYMD
  9965           PERFORM 3025-CALC-ELAPSED-MONTHS THRU 3026-CALC-EXIT
  9966           MOVE DC-ELAPSED-MONTHS  TO REIN-LF-CLM-MONTHS.
  9967
  9968     MOVE INCURRED-DATE            TO CR-DTH-DT
  9969                                      WS-CR-DTH-DT-N.
  9970
  9971     IF PC-CHARGEBLE-EXPENSE  OR
  9972        PC-NON-CHARGEBLE-EXPENSE
  9973         IF CR-LFTYP = '00'
  9974             MOVE '99'             TO CR-LFTYP  CLAS-LOOK
  9975             PERFORM 8300-LIFE-TYPE-LOOKUP THRU
  9976                     8399-LIFE-LOOKUP-X.
  9977
  9978     IF PC-CHARGEBLE-EXPENSE  OR
  9979        PC-NON-CHARGEBLE-EXPENSE
  9980         ADD PC-CLAIM-PAYMENT      TO CR-DTHEXP
  9981         ADD PC-CLAIM-PAYMENT      TO CR-DTHEXP-YTD
  9982         ADD PC-CLAIM-PAYMENT      TO TPL-CLAIMS (1)
  9983         MOVE PC-CLAIM-PAYMENT     TO TRD-LFCOM-CLM
  9984         MOVE 'CLAIM EXP '         TO TRD-LF-ACTION
  9985         GO TO 0780-END-CLAIMS-PROCESSING.
  9986
  9987     ADD +1                       TO  CR-NUM-DTH-CLM.
  9988     MOVE REPORTED-DATE           TO  CR-DTH-RPT-DT.
  9989     MOVE PAYMENT-DATE            TO  CR-DTH-PAY-DT
  9990                                      WS-CR-DTH-PAY-DT-N.
  9991
  9992     ADD PC-CLAIM-PAYMENT         TO  CR-DTHAMT.
  9993     ADD PC-CLAIM-PAYMENT         TO  CR-DTHAMT-YTD.
  9994     MOVE PC-CLAIM-PAYMENT        TO  CR-DTHAMT-LAST.
  9995     MOVE PC-AGE-AT-CLAIM         TO  CR-DTH-AGE.
  9996     IF CR-DTH-PAY-CD NOT = 'F'
  9997         MOVE PC-PAYMENT-TYPE     TO  CR-DTH-PAY-CD.
  9998     INSPECT CR-DTH-PAY-CD
  9999         CONVERTING '12349' TO 'PFSXV'.
 10000     MOVE PC-CAUSE-CODE           TO  CR-DEATH-CAUSE.
 10001
 10002     IF (LIFE-OVERRIDE-L1 EQUAL 'P'  OR
 10003         CLAS-I-RL-AH (CLAS-INDEXL) EQUAL 'P')
 10004       AND
 10005       (CR-DTHAMT LESS THAN (CR-LFAMT + CR-LFAMT-ALT)
 10006       OR
 10007        DTE-CLIENT = 'ACC' OR 'FDL')
 10008        NEXT SENTENCE
 10009     ELSE
 10010     IF (CLAS-I-CALC-TYPE (CLAS-INDEXL) NOT = 'Z')
 10011         IF CR-LF-CLAIM-EXIT-DATE = ZEROS
 10012             MOVE CR-LF-CURRENT-STATUS TO CR-LF-STATUS-AT-DEATH
 10013             MOVE '7'            TO CR-LF-CURRENT-STATUS
 10014             MOVE EOM-RUN-DATE   TO CR-LF-CLAIM-EXIT-DATE
 10015                                    WS-CR-LF-CLAIM-EXIT-DATE-N.
 10016
 10017     MOVE CLAS-I-AB3 (CLAS-INDEXL)     TO TRD-LFTYP.
 10018     MOVE CR-LF-TERM                   TO TRD-LFTRM.
 10019     MOVE PC-CLAIM-PAYMENT        TO  TRD-LFCOM-CLM.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 193
* ECS010MO.cbl
 10020     IF CLAS-I-RL-AH (CLAS-INDEXL) = 'P'
 10021         MOVE 'PROPERTY  '       TO TRD-LF-ACTION
 10022     ELSE
 10023         MOVE 'CLAIM PYMT'       TO TRD-LF-ACTION.
 10024     MOVE CR-LF-CURRENT-STATUS   TO TRD-LF-STATUS.
 10025
 10026     IF NOT CR-POLICY-IS-REIN-ONLY
 10027         ADD PC-CLAIM-PAYMENT    TO TPL-CLAIMS (1).
 10028
 10029 0720-CANCEL-AH-COVERAGE.
 10030
 10031     IF CR-AHTYP = ZEROS  OR
 10032        NOT CR-AH-POLICY-IS-ACTIVE
 10033         GO TO 0740-DEATH-CLAIM-VOID.
 10034
 10035     MOVE CR-AH-CURRENT-STATUS          TO CR-AH-STATUS-AT-CANCEL.
 10036     MOVE '7'                           TO CR-AH-CURRENT-STATUS.
 10037     MOVE CR-DTH-DT                     TO CR-AH-CANC-DT
 10038                                           WS-CR-AH-CANC-DT-N.
 10039     MOVE EOM-RUN-DATE               TO CR-AH-CANCEL-EXIT-DATE
 10040                                     WS-CR-AH-CANCEL-EXIT-DATE-N.
 10041
 10042     MOVE CLAS-I-AB3 (CLAS-INDEXA)      TO TRD-AHTYP.
 10043     MOVE CR-AH-TERM                    TO TRD-AHTRM.
 10044     MOVE CR-DTH-MO                     TO TRD-AHACTMO.
 10045     MOVE CR-DTH-DA                     TO TRD-AHACTDA.
 10046     MOVE CR-DTH-YR                     TO TRD-AHACTYR.
 10047     MOVE '/'                           TO TRD-AH-S1  TRD-AH-S2.
 10048     MOVE 'CLAIM CANC'                  TO TRD-AH-ACTION.
 10049     MOVE CR-AH-CURRENT-STATUS          TO TRD-AH-STATUS.
 10050
 10051 0740-DEATH-CLAIM-VOID.
 10052
 10053     IF CR-DTHAMT = ZERO  AND
 10054        PC-CLAIM-PAYMENT NEGATIVE
 10055         NEXT SENTENCE
 10056     ELSE
 10057         GO TO 0780-END-CLAIMS-PROCESSING.
 10058
 10059     MOVE '*'                           TO DEATH-VOID-FLAG.
 10060
 10061     MOVE ZEROS                         TO CR-LF-CLAIM-EXIT-DATE
 10062                                        WS-CR-LF-CLAIM-EXIT-DATE-N
 10063                                           CR-NUM-DTH-CLM
 10064                                           CR-DTH-RPT-DT
 10065                                           CR-DTH-PAY-DT
 10066                                           WS-CR-DTH-PAY-DT-N
 10067*                                          CR-DTHAMT-YTD
 10068*                                          CR-DTHAMT-LAST
 10069                                           CR-DTH-AGE.
 10070     MOVE ' '                           TO CR-DTH-PAY-CD.
 10071
 10072     IF CR-LF-DEATH-CLAIM-APPLIED
 10073         MOVE CR-LF-STATUS-AT-DEATH     TO CR-LF-CURRENT-STATUS
 10074         MOVE ' '                       TO CR-LF-STATUS-AT-DEATH
 10075     ELSE
 10076         MOVE CR-LF-STATUS-AT-DEATH     TO CR-LF-STATUS-AT-CANCEL
 10077         MOVE ' '                       TO CR-LF-STATUS-AT-DEATH.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 194
* ECS010MO.cbl
 10078
 10079     MOVE 'VOID CLAIM'                  TO TRD-LF-ACTION.
 10080     MOVE CR-LF-CURRENT-STATUS          TO TRD-LF-STATUS.
 10081
 10082     IF CR-AH-DEATH-CLAIM-APPLIED
 10083         MOVE CR-AH-STATUS-AT-CANCEL    TO CR-AH-CURRENT-STATUS
 10084         MOVE ' '                       TO CR-AH-STATUS-AT-CANCEL
 10085         MOVE ZEROS                     TO CR-AH-CANC-DT
 10086                                           WS-CR-AH-CANC-DT-N
 10087                                           CR-AH-CANCEL-EXIT-DATE
 10088                                       WS-CR-AH-CANCEL-EXIT-DATE-N
 10089         MOVE CLAS-I-AB3 (CLAS-INDEXA)  TO TRD-AHTYP
 10090         MOVE CR-AH-TERM                TO TRD-AHTRM
 10091         MOVE 'VOID CANCL'              TO TRD-AH-ACTION
 10092         MOVE CR-AH-CURRENT-STATUS      TO TRD-AH-STATUS.
 10093
 10094     GO TO 0780-END-CLAIMS-PROCESSING.
 10095
 10096******************************************************************
 10097***       P R O C E S S   D I S A B I L I T Y   C L A I M      ***
 10098******************************************************************
 10099
 10100 0750-PROCESS-DISABILITY-CLAIM.
 10101
 10102     ADD +1                       TO W-AH-CLAIMS.
 10103
 10104     MOVE INCURRED-DATE           TO CR-DIS-DT
 10105                                     WS-CR-DIS-DT-N.
 10106
 10107     PERFORM 0790-TABLE-DISAB-PERIODS THRU 0791-TABLE-AH-EXIT.
 10108
 10109     IF REIN-AH-CLM-MONTHS = +1
 10110         MOVE REIN-AH-CLM-MTH-1        TO REIN-AH-CLM-MONTHS
 10111     ELSE
 10112       IF REIN-AH-CLM-MONTHS = +2
 10113           MOVE REIN-AH-CLM-MTH-2      TO REIN-AH-CLM-MONTHS
 10114       ELSE
 10115         IF REIN-AH-CLM-MONTHS = +3
 10116             MOVE REIN-AH-CLM-MTH-3    TO REIN-AH-CLM-MONTHS
 10117         ELSE
 10118           IF REIN-AH-CLM-MONTHS = +4
 10119               MOVE REIN-AH-CLM-MTH-4  TO REIN-AH-CLM-MONTHS
 10120           ELSE
 10121               MOVE REIN-AH-CLM-MTH-5  TO REIN-AH-CLM-MONTHS.
 10122
 10123     IF PC-CHARGEBLE-EXPENSE  OR
 10124        PC-NON-CHARGEBLE-EXPENSE
 10125         IF CR-AHTYP = '00'
 10126             MOVE '99'             TO CR-AHTYP  CLAS-LOOK
 10127             PERFORM 8400-A-H-TYPE-LOOKUP THRU
 10128                     8499-A-H-LOOKUP-X.
 10129
 10130     IF PC-CHARGEBLE-EXPENSE  OR
 10131        PC-NON-CHARGEBLE-EXPENSE
 10132         ADD PC-CLAIM-PAYMENT      TO CR-DISEXP
 10133         ADD PC-CLAIM-PAYMENT      TO CR-DISEXP-YTD
 10134         ADD PC-CLAIM-PAYMENT      TO TPA-CLAIMS (1)
 10135         MOVE PC-CLAIM-PAYMENT     TO TRD-AHCOM-CLM
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 195
* ECS010MO.cbl
 10136         MOVE 'CLAIM EXP '         TO TRD-AH-ACTION
 10137         GO TO 0780-END-CLAIMS-PROCESSING.
 10138
 10139     ADD +1                       TO CR-NUM-DIS-CLM.
 10140
 10141     MOVE REPORTED-DATE           TO  CR-DIS-RPT-DT.
 10142     MOVE PAYMENT-DATE            TO  CR-DIS-PAY-DT
 10143                                      WS-CR-DIS-PAY-DT-N.
 10144     MOVE PAY-TO-DATE             TO  CR-DIS-PTO-DT
 10145                                      WS-CR-DIS-PTO-DT-N.
 10146
 10147     ADD  PC-CLAIM-PAYMENT         TO CR-DISAMT.
 10148     ADD  PC-CLAIM-PAYMENT         TO CR-DISAMT-YTD.
 10149     MOVE PC-CLAIM-PAYMENT         TO CR-DISAMT-LAST.
 10150
 10151     MOVE PC-NO-OF-DAYS-PAID       TO CR-DAYS-DISAB.
 10152     IF CR-DIS-PAY-CD NOT = 'S'
 10153         MOVE PC-PAYMENT-TYPE      TO CR-DIS-PAY-CD.
 10154     INSPECT CR-DIS-PAY-CD
 10155         CONVERTING '12349' TO 'PFSXV'.
 10156     MOVE PC-CAUSE-CODE            TO CR-DISAB-CAUSE.
 10157
 10158     IF PC-LUMP-SUM-PAYMENT
 10159         IF CR-AH-SETTLEMENT-EXIT-DATE = ZEROS
 10160           MOVE CR-AH-CURRENT-STATUS TO CR-AH-STATUS-AT-SETTLEMENT
 10161           MOVE '6'                  TO CR-AH-CURRENT-STATUS
 10162           MOVE EOM-RUN-DATE    TO CR-AH-SETTLEMENT-EXIT-DATE
 10163                                   WS-CR-AH-SETTLEMENT-EXIT-DATEN.
 10164
 10165     MOVE CLAS-I-AB3 (CLAS-INDEXA) TO TRD-AHTYP.
 10166     MOVE CR-AH-TERM               TO TRD-AHTRM.
 10167     MOVE PC-CLAIM-PAYMENT         TO TRD-AHCOM-CLM.
 10168     MOVE 'CLAIM PYMT'             TO TRD-AH-ACTION.
 10169     MOVE CR-AH-CURRENT-STATUS     TO TRD-AH-STATUS.
 10170
 10171     IF NOT CR-POLICY-IS-REIN-ONLY
 10172         ADD PC-CLAIM-PAYMENT      TO TPA-CLAIMS (1).
 10173
 10174     IF NOT PC-LUMP-SUM-PAYMENT
 10175         GO TO 0780-END-CLAIMS-PROCESSING.
 10176
 10177 0770-CANCEL-LF-COVERAGE.
 10178
 10179     IF CR-LFTYP = ZEROS  OR
 10180        NOT CR-LF-POLICY-IS-ACTIVE
 10181         GO TO 0780-END-CLAIMS-PROCESSING.
 10182
 10183     MOVE CR-LF-CURRENT-STATUS          TO CR-LF-STATUS-AT-CANCEL.
 10184     MOVE '6'                           TO CR-LF-CURRENT-STATUS.
 10185     MOVE CR-DIS-PAY-DT                 TO CR-LF-CANC-DT
 10186                                           WS-CR-LF-CANC-DT-N.
 10187     MOVE EOM-RUN-DATE               TO CR-LF-CANCEL-EXIT-DATE
 10188                                     WS-CR-LF-CANCEL-EXIT-DATE-N.
 10189
 10190     MOVE CLAS-I-AB3 (CLAS-INDEXL)      TO TRD-LFTYP.
 10191     MOVE CR-LF-TERM                    TO TRD-LFTRM.
 10192     MOVE CR-DIS-PAY-MO                 TO TRD-LFACTMO.
 10193     MOVE CR-DIS-PAY-DA                 TO TRD-LFACTDA.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 196
* ECS010MO.cbl
 10194     MOVE CR-DIS-PAY-YR                 TO TRD-LFACTYR.
 10195     MOVE '/'                           TO TRD-LF-S1  TRD-LF-S2.
 10196     MOVE 'CLAIM CANC'                  TO TRD-LF-ACTION.
 10197     MOVE CR-LF-CURRENT-STATUS          TO TRD-LF-STATUS.
 10198
 10199 0780-END-CLAIMS-PROCESSING.
 10200
 10201     IF PC-LF-CLAIM  OR  PC-OB-LF-CLAIM
 10202         MOVE DTO-MO               TO TRD-LFACTMO
 10203         MOVE DTO-DA               TO TRD-LFACTDA
 10204         MOVE DTO-YR               TO TRD-LFACTYR
 10205         MOVE '/'                  TO TRD-LF-S1  TRD-LF-S2
 10206     ELSE
 10207         MOVE PAY-MO               TO TRD-AHACTMO
 10208         MOVE PAY-DA               TO TRD-AHACTDA
 10209         MOVE PAY-YR               TO TRD-AHACTYR
 10210         MOVE '/'                  TO TRD-AH-S1  TRD-AH-S2.
 10211
 10212     PERFORM 8690-PRINT-DETAIL-LINE THRU 8699-PRT-DETAIL-X.
 10213
 10214     IF NOT CR-POLICY-IS-REIN-ONLY
 10215         PERFORM 2300-BUILD-CLAIM-EXTRACT THRU 2399-BLD-CLAIM-X
 10216         ADD +1                    TO BC-G-CLM.
 10217
 10218     PERFORM 3300-REINSURE-CLAIM THRU 3399-REINSURE-CLAIM-X.
 10219
 10220     IF DEATH-CLAIM-VOIDED
 10221         MOVE ZEROS                TO CR-DTH-DT
 10222                                      WS-CR-DTH-DT-N.
 10223     MOVE SPACE                    TO DEATH-VOID-FLAG.
 10224
 10225     MOVE '*'                      TO TRANSACTION-FLAG.
 10226     GO TO 0300-READ-PENDING-TRANSACTIONS.
 10227
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 197
* ECS010MO.cbl
 10229 0790-TABLE-DISAB-PERIODS.
 10230
 10231     MOVE +1                       TO SUB14.
 10232     PERFORM 0794-REVIEW-TABLE     THRU 0794-REVIEW-TABLE-EXIT.
 10233
 10234     MOVE +1                       TO SUB14.
 10235
 10236**************************************************************
 10237**                                                          **
 10238**   THIS ROUTINE SEARCHES THROUGH THE DISAB-DETAIL-DATA    **
 10239**  AND MATCHES INCURRED DATE.  IT THEN ADDS THE AMOUNT OF  **
 10240**  THE CLAIM TO THAT OCCURRENCE.  IF THE INCURRED DATE     **
 10241**  DOES NOT MATCH ANY PREVIOUS INCURRED DATE,  IT WILL     **
 10242**  INITIALIZE THE NEXT OCCURRENCE.  (OLDEST TO MOST RECENT)**
 10243**                                                          **
 10244**    IF ALL 5 OCCURRENCES ARE FILLED,  THE TWO OLDEST      **
 10245**  AMOUNTS ARE COMBINED LEAVING THE LAST OCCURRENCE OPEN   **
 10246**  FOR THE MOST RECENT CLAIM INFORMATION.                  **
 10247**                                                          **
 10248**************************************************************
 10249
 10250 0791-TABLE-AH-AMOUNT.
 10251
 10252     IF SUB14 GREATER THAN DISABILITY-TBL-MAX
 10253         PERFORM 0792-MOVE-TABLE  THRU 0792-MOVE-TABLE-EXIT.
 10254
 10255     IF CR-DIS-INCUR-DT (SUB14)  EQUAL ZEROS
 10256         MOVE INCURRED-DATE        TO CR-DIS-INCUR-DT (SUB14)
 10257                                      WS-CR-DIS-INCUR-DT-N (SUB14)
 10258         IF REIN-IS-RISK-PREMIUM
 10259             MOVE INCURRED-DATE     TO DC-GREG-DATE-CYMD
 10260             PERFORM 3025-CALC-ELAPSED-MONTHS THRU 3026-CALC-EXIT
 10261             IF SUB14 = +1
 10262               MOVE DC-ELAPSED-MONTHS TO REIN-AH-CLM-MTH-1
 10263             ELSE
 10264             IF SUB14 = +2
 10265               MOVE DC-ELAPSED-MONTHS TO REIN-AH-CLM-MTH-2
 10266             ELSE
 10267             IF SUB14 = +3
 10268               MOVE DC-ELAPSED-MONTHS TO REIN-AH-CLM-MTH-3
 10269             ELSE
 10270             IF SUB14 = +4
 10271               MOVE DC-ELAPSED-MONTHS TO REIN-AH-CLM-MTH-4
 10272             ELSE
 10273               MOVE DC-ELAPSED-MONTHS TO REIN-AH-CLM-MTH-5.
 10274
 10275
 10276     IF INCURRED-DATE EQUAL CR-DIS-INCUR-DT (SUB14)
 10277         MOVE SUB14                TO REIN-AH-CLM-MONTHS
 10278         COMPUTE REIN-AH-PRIOR-CLMS-PAID = CR-INCUR-DISAMT (SUB14)
 10279                                        +  CR-INCUR-DISEXP (SUB14)
 10280         IF PC-CHARGEBLE-EXPENSE  OR
 10281            PC-NON-CHARGEBLE-EXPENSE
 10282             ADD PC-CLAIM-PAYMENT  TO CR-INCUR-DISEXP (SUB14)
 10283             GO TO 0791-TABLE-AH-EXIT
 10284         ELSE
 10285             ADD  PC-CLAIM-PAYMENT TO CR-INCUR-DISAMT (SUB14)
 10286             GO TO 0791-TABLE-AH-EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 198
* ECS010MO.cbl
 10287
 10288     ADD +1                       TO SUB14.
 10289
 10290     GO TO 0791-TABLE-AH-AMOUNT.
 10291
 10292 0791-TABLE-AH-EXIT.
 10293     EXIT.
 10294
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 199
* ECS010MO.cbl
 10296**************************************************************
 10297**                                                          **
 10298** THIS ROUTINE IS PERFORMED WHEN THERE HAVE BEEN MORE THAN **
 10299** 5 DISABILITY PERIODS ATTACHED TO THE SAME CERTIFICATE.   **
 10300**                                                          **
 10301** THE SECOND OCCURRENCE IS ADDED TO THE 1ST OCCURRENCE     **
 10302** COMBINING THE TWO OLDEST OCCURRENCES INTO ONE BUCKET     **
 10303** THE NEWEST CLAIM INFORMATION IS MOVED INTO THE LAST      **
 10304** OCCURRENCE.                                              **
 10305**************************************************************
 10306 0792-MOVE-TABLE.
 10307
 10308     MOVE CR-DIS-INCUR-DT (2)  TO CR-DIS-INCUR-DT (1)
 10309                                  WS-CR-DIS-INCUR-DT-N (1).
 10310     ADD  CR-INCUR-DISAMT (2)  TO CR-INCUR-DISAMT (1).
 10311     ADD  CR-INCUR-DISEXP (2)  TO CR-INCUR-DISEXP (1).
 10312
 10313     MOVE +2                   TO SUB14.
 10314     MOVE +3                   TO SUB15.
 10315     PERFORM 0794A-BUMP-TBL    THRU 0794A-BUMP-TBL-EXIT.
 10316
 10317     MOVE DISABILITY-TBL-MAX   TO SUB14.
 10318
 10319     MOVE INCURRED-DATE        TO CR-DIS-INCUR-DT (SUB14)
 10320                                  WS-CR-DIS-INCUR-DT-N (SUB14).
 10321
 10322 0792-MOVE-TABLE-EXIT.
 10323     EXIT.
 10324
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 200
* ECS010MO.cbl
 10326**************************************************************
 10327**                                                          **
 10328**  A REVIEW OF ALL OCCURRENCES IS PERFORMED TO ELIMINATE   **
 10329** ANY WITH NO PAYMENTS OR EXPENSES ATTACHED. THESE CAN     **
 10330** OCCUR WHEN DISABILITY PAYMENTS HAVE BEEN VOIDED, BECAUSE **
 10331** CLAIM ATTACHED TO WRONG CERTIFICATE, OR WRONG CLAIM TYPE **
 10332** PAID, OR A CHANGE IN THE INCURRED DATE OF A CLAIM.       **
 10333**************************************************************
 10334
 10335 0794-REVIEW-TABLE.
 10336
 10337     IF SUB14 GREATER THAN DISABILITY-TBL-MAX
 10338         GO TO 0794-REVIEW-TABLE-EXIT.
 10339
 10340     IF CR-DIS-INCUR-DT (SUB14) EQUAL ZEROS
 10341         GO TO 0794-REVIEW-TABLE-EXIT.
 10342
 10343     IF CR-INCUR-DISAMT (SUB14) EQUAL ZEROS  AND
 10344        CR-INCUR-DISEXP (SUB14) EQUAL ZEROS
 10345         DISPLAY CR-ACCOUNT ' ' CR-CERT-NO ' ' SUB14
 10346         MOVE ZEROS            TO CR-DIS-INCUR-DT (SUB14)
 10347                                  WS-CR-DIS-INCUR-DT-N (SUB14)
 10348         MOVE SUB14            TO SUB15
 10349         ADD +1                TO SUB15
 10350         PERFORM 0794A-BUMP-TBL   THRU 0794A-BUMP-TBL-EXIT
 10351         MOVE +1               TO SUB14
 10352         GO TO 0794-REVIEW-TABLE.
 10353
 10354     ADD +1                    TO SUB14.
 10355
 10356     GO TO 0794-REVIEW-TABLE.
 10357
 10358 0794-REVIEW-TABLE-EXIT.
 10359     EXIT.
 10360
 10361 0794A-BUMP-TBL.
 10362
 10363     IF SUB15 GREATER THAN DISABILITY-TBL-MAX
 10364         GO TO 0794A-BUMP-TBL-EXIT.
 10365
 10366     MOVE CR-DISAB-DETAIL-DATA (SUB15)  TO
 10367                             CR-DISAB-DETAIL-DATA (SUB14).
 10368
 10369     MOVE ZEROS                TO CR-DIS-INCUR-DT (SUB15)
 10370                                  WS-CR-DIS-INCUR-DT-N (SUB15)
 10371                                  CR-INCUR-DISAMT (SUB15)
 10372                                  CR-INCUR-DISEXP (SUB15).
 10373
 10374     ADD +1                    TO SUB14
 10375                                  SUB15.
 10376     GO TO 0794A-BUMP-TBL.
 10377
 10378 0794A-BUMP-TBL-EXIT.
 10379     EXIT.
 10380
 10381 0795-DCC-NSP-LF.
 10382
 10383     MOVE CR-DT                      TO DC-GREG-DATE-CYMD.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 201
* ECS010MO.cbl
 10384     MOVE 'L'                        TO DC-OPTION-CODE.
 10385     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 10386     MOVE DC-BIN-DATE-1              TO CP-CERT-EFF-DT.
 10387     MOVE SPACES                     TO CP-ACCT-FLD-5.
 10388     MOVE DTE-CLIENT                 TO CP-COMPANY-ID.
 10389     MOVE CR-AGE                     TO CP-ISSUE-AGE.
 10390     MOVE CR-APR                     TO CP-LOAN-APR.
 10391     MOVE CR-PMT-FREQ                TO CP-PAY-FREQUENCY.
 10392     MOVE CR-LOAN-TERM               TO CP-LOAN-TERM.
 10393     MOVE ZEROS                      TO CP-DEVIATION-CODE.
 10394     MOVE CR-RATING-CLASS            TO CP-CLASS-CODE.
 10395
 10396     MOVE '3'                        TO CP-PROCESS-TYPE.
 10397     MOVE DTE-CLASIC-COMPANY-CD      TO CP-COMPANY-CD.
 10398     MOVE CR-PMT-EXTENSION-DAYS      TO CP-TERM-OR-EXT-DAYS.
 10399
 10400     IF CR-LFTYP = ZERO
 10401         GO TO 0795-EXIT
 10402     END-IF
 10403
 10404     IF (CLAS-I-BAL (CLAS-INDEXL) = 'B')
 10405         GO TO 0795-EXIT
 10406     END-IF
 10407     MOVE CR-LFPRM                   TO CP-ORIGINAL-PREMIUM
 10408     MOVE CLAS-I-RL-AH (CLAS-INDEXL) TO CP-BENEFIT-TYPE.
 10409     MOVE CR-LF-TERM                 TO CP-ORIGINAL-TERM.
 10410     MOVE CR-LFAMT                   TO CP-ORIGINAL-BENEFIT
 10411                                        CP-RATING-BENEFIT-AMT.
 10412     MOVE CLAS-I-EP (CLAS-INDEXL)    TO CP-EARNING-METHOD.
 10413     MOVE CLAS-I-BAL (CLAS-INDEXL)   TO CP-SPECIAL-CALC-CD.
 10414     MOVE CR-LFTYP                   TO CP-BENEFIT-CD.
 10415     MOVE LIFE-OVERRIDE-L1           TO CP-LIFE-OVERRIDE-CODE.
 10416     MOVE ZEROS                      TO CP-RATE-DEV-PCT.
 10417     MOVE CR-STATE                   TO CP-STATE.
 10418     MOVE STATE-ABBR (CLAS-INDEXS)   TO CP-STATE-STD-ABBRV.
 10419
 10420     IF CP-STATE-STD-ABBRV = 'OR'
 10421         COMPUTE CP-RATING-BENEFIT-AMT = CR-LFAMT + CR-LFAMT-ALT.
 10422
 10423     PERFORM 8100-GET-RATE THRU 8199-GET-RATE-X.
 10424
 10425     IF CP-ERROR-RATE-NOT-FOUND  OR
 10426        CP-ERROR-RATE-IS-ZERO
 10427         MOVE 'LIFE NET SINGLE PREMIUM RATE NOT FOUND'
 10428                                     TO WS-ABEND-MESSAGE
 10429         MOVE 0302                   TO WS-ABEND-CODE
 10430         DISPLAY '******************************'
 10431         DISPLAY '***** ERROR LOCATION 018 *****'
 10432         DISPLAY '******************************'
 10433         MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
 10434         GO TO ABEND-PGM.
 10435
 10436     MOVE CP-CALC-PREMIUM          TO CR-LF-NSP-PRM.
 10437
 10438*    COMPUTE CR-LF-NSP-PRM ROUNDED =
 10439*                      (CR-LFAMT / 100) * CP-PREMIUM-RATE.
 10440
 10441     COMPUTE CR-LF-NSP-PRM ROUNDED =  CR-LF-NSP-PRM +
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 202
* ECS010MO.cbl
 10442                   ((CR-LFAMT-ALT / 100) * CP-PREMIUM-RATE).
 10443
 10444     MOVE CP-PREMIUM-RATE            TO CR-LF-NSP-PRM-RATE.
 10445
 10446 0795-exit.
 10447     exit.
 10448
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 203
* ECS010MO.cbl
 10450******************************************************************
 10451***   P R O C E S S   R E S E R V E   T R A N S A C T I O N S  ***
 10452******************************************************************
 10453
 10454 0800-PROCESS-RESERVES.
 10455
 10456     IF PC-AH-CLAIM  OR  PC-OB-AH-CLAIM
 10457       IF CARRIER-UEP-PCT (CLAS-INDEXCN) NOT = ZEROS
 10458           MOVE ZEROS             TO  PC-IBNR-RESERVE-AMT.
 10459
 10460     PERFORM 3000-REINSURE-ROUTINE THRU 3099-REINSURE-ROUTINE-X.
 10461
 10462     MOVE PC-INCURRED-DT          TO  DC-BIN-DATE-1.
 10463     MOVE ' '                     TO  DC-OPTION-CODE.
 10464     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 10465     MOVE DC-GREG-DATE-CYMD       TO  INCURRED-DATE.
 10466
 10467     MOVE PC-REPORTED-DT          TO  DC-BIN-DATE-1.
 10468     MOVE ' '                     TO  DC-OPTION-CODE.
 10469     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 10470     MOVE DC-GREG-DATE-1-YMD      TO  REPORTED-DATE.
 10471
 10472     MOVE PC-PAID-THRU-DT         TO  DC-BIN-DATE-1.
 10473     MOVE ' '                     TO  DC-OPTION-CODE.
 10474     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 10475     MOVE DC-GREG-DATE-CYMD       TO  PAY-TO-DATE.
 10476
 10477     PERFORM 8600-SETUP-DETAIL-LINE THRU 8689-SETUP-DETAIL-X.
 10478
 10479     IF PC-LF-CLAIM  OR  PC-OB-LF-CLAIM
 10480         ADD +1                     TO W-LF-RESERVES
 10481         ADD PC-IBNR-RESERVE-AMT    TO DTH-IBNR
 10482         ADD PC-PTC-RESERVE-AMT     TO DTH-PAYCUR
 10483         ADD PC-FUTURE-RESERVE-AMT  TO DTH-FUTRSV
 10484         ADD PC-MANUAL-RESERVE-AMT  TO DTH-FUTRSV
 10485         MOVE INCURRED-DATE         TO CR-DTH-DT
 10486                                       WS-CR-DTH-DT-N
 10487         MOVE LIFE-OVERRIDE-L6      TO TRD-RSV-DESC
 10488
 10489     ELSE
 10490         ADD +1                     TO W-AH-RESERVES
 10491         ADD PC-IBNR-RESERVE-AMT    TO DIS-IBNR
 10492         ADD PC-PTC-RESERVE-AMT     TO DIS-PAYCUR
 10493         ADD PC-FUTURE-RESERVE-AMT  TO DIS-FUTRSV
 10494         ADD PC-MANUAL-RESERVE-AMT  TO DIS-FUTRSV
 10495         MOVE INCURRED-DATE         TO CR-DIS-DT
 10496                                       WS-CR-DIS-DT-N
 10497         MOVE AH-OVERRIDE-L6        TO TRD-RSV-DESC.
 10498
 10499     MOVE PC-IBNR-RESERVE-AMT       TO TRD-IBNR.
 10500     MOVE 'IBNR'                    TO TRD-IBNRX.
 10501     MOVE PC-PTC-RESERVE-AMT        TO TRD-PAYCUR.
 10502     MOVE 'PAY CURR'                TO TRD-PAYCURX.
 10503     COMPUTE TRD-FUTRSV EQUAL
 10504            (PC-FUTURE-RESERVE-AMT + PC-MANUAL-RESERVE-AMT).
 10505     MOVE 'FUTURE'                  TO TRD-FUTRSVX.
 10506     MOVE ' CLAIM RESERVES      '   TO TRD-RSV-ACTION.
 10507
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 204
* ECS010MO.cbl
 10508 0820-END-RESERVE-PROCESSING.
 10509
 10510     PERFORM 8690-PRINT-DETAIL-LINE THRU 8699-PRT-DETAIL-X.
 10511
 10512     IF NOT CR-POLICY-IS-REIN-ONLY
 10513         PERFORM 2400-BUILD-RESERVE-EXTRACT THRU
 10514                                            2499-BLD-RESERVE-X
 10515         ADD +1 TO BC-G-CRS.
 10516
 10517     PERFORM 3400-REINSURE-RESERVE THRU 3499-REINSURE-RESERVE-X.
 10518
 10519     MOVE '*'                    TO TRANSACTION-FLAG.
 10520     GO TO 0300-READ-PENDING-TRANSACTIONS.
 10521
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 205
* ECS010MO.cbl
 10523******************************************************************
 10524***    P R O C E S S   C H A N G E   T R A N S A C T I O N S   ***
 10525******************************************************************
 10526
 10527 0900-PROCESS-CERT-CHANGES.
 10528
 10529     PERFORM 8600-SETUP-DETAIL-LINE THRU 8689-SETUP-DETAIL-X.
 10530
 10531     IF CC-AGE NOT NUMERIC  OR
 10532        CC-AGE = CR-AGE
 10533         MOVE ZEROS TO CC-AGE.
 10534
 10535     IF CC-INSURED-JOINT-AGE NOT NUMERIC  OR
 10536        CC-INSURED-JOINT-AGE = CR-JOINT-AGE
 10537         MOVE ZEROS TO CC-INSURED-JOINT-AGE.
 10538
 10539     IF CC-INSURED-SEX NOT = 'M'  AND
 10540        CC-INSURED-SEX NOT = 'F'
 10541         MOVE SPACES TO CC-INSURED-SEX.
 10542
 10543     IF CC-LOAN-APR NOT NUMERIC  OR
 10544        CC-LOAN-APR = CR-APR
 10545         MOVE ZEROS TO CC-LOAN-APR.
 10546
 10547     IF CC-PAY-FREQUENCY NOT NUMERIC  OR
 10548        CC-PAY-FREQUENCY = CR-PMT-FREQ
 10549         MOVE ZEROS TO CC-PAY-FREQUENCY.
 10550
 10551     IF CC-IND-GRP-TYPE NOT = '1'  AND
 10552        CC-IND-GRP-TYPE NOT = '2'
 10553         MOVE SPACES TO CC-IND-GRP-TYPE.
 10554
 10555     IF CC-CLAIM-DEDUCT-WITHHELD NOT NUMERIC  OR
 10556        CC-CLAIM-DEDUCT-WITHHELD = CR-CLAIM-DEDUCT-WITHHELD
 10557         MOVE ZEROS TO CC-CLAIM-DEDUCT-WITHHELD.
 10558
 10559     IF CC-CANCEL-DEDUCT-WITHHELD NOT NUMERIC  OR
 10560        CC-CANCEL-DEDUCT-WITHHELD = CR-CANCEL-DEDUCT-WITHHELD
 10561         MOVE ZEROS TO CC-CANCEL-DEDUCT-WITHHELD.
 10562
 10563     IF CC-LF-ORIG-TERM NOT NUMERIC  OR
 10564        CC-LF-ORIG-TERM = CR-LF-TERM  OR
 10565        CR-LFTYP = ZEROS
 10566         MOVE ZEROS TO CC-LF-ORIG-TERM.
 10567
 10568     IF CC-AH-ORIG-TERM NOT NUMERIC  OR
 10569        CC-AH-ORIG-TERM = CR-AH-TERM  OR
 10570        CR-AHTYP = ZEROS
 10571         MOVE ZEROS TO CC-AH-ORIG-TERM.
 10572
 10573     IF CR-BILLED NOT NUMERIC
 10574         MOVE ZEROS TO CR-BILLED.
 10575
 10576     IF CR-LIVES NOT NUMERIC
 10577         MOVE ZEROS TO CR-LIVES.
 10578
 10579     IF CC-LIVES NOT NUMERIC  OR
 10580        CC-LIVES = CR-LIVES
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 206
* ECS010MO.cbl
 10581         MOVE ZEROS TO CC-LIVES.
 10582
 10583     IF CC-BILLED NOT NUMERIC  OR
 10584        CC-BILLED = CR-BILLED
 10585         MOVE ZEROS TO CC-BILLED.
 10586
 10587     IF CC-INSURED-LAST-NAME NOT = SPACES
 10588         MOVE CC-INSURED-LAST-NAME   TO CR-LNAME.
 10589     IF CC-INSURED-FIRST-NAME NOT = SPACES
 10590         MOVE CC-INSURED-FIRST-NAME  TO CR-FNAME.
 10591     IF CC-INSURED-INITIAL2 NOT = SPACES
 10592         MOVE CC-INSURED-INITIAL2    TO CR-INIT.
 10593     IF CC-JT-LAST-NAME NOT = SPACES
 10594         MOVE CC-JT-LAST-NAME        TO CR-JT-LNAME.
 10595     IF CC-JT-FIRST-NAME NOT = SPACES
 10596         MOVE CC-JT-FIRST-NAME       TO CR-JT-FNAME.
 10597     IF CC-JT-INITIAL NOT = SPACES
 10598         MOVE CC-JT-INITIAL          TO CR-JT-INIT.
 10599
 10600     IF CC-AGE NOT = ZEROS
 10601         MOVE CC-AGE                 TO CR-AGE
 10602                                        DET-AGE
 10603     ELSE
 10604         MOVE ZEROS                  TO DET-AGE.
 10605
 10606     IF CC-INSURED-JOINT-AGE NOT = ZEROS
 10607         MOVE CC-INSURED-JOINT-AGE   TO CR-JOINT-AGE
 10608                                        DET-JT-AGE
 10609     ELSE
 10610         MOVE ZEROS                  TO DET-JT-AGE.
 10611
 10612     IF CC-INSURED-SEX NOT = SPACES
 10613         MOVE CC-INSURED-SEX         TO CR-SEX
 10614                                        DET-SEX
 10615     ELSE
 10616         MOVE SPACE                  TO DET-SEX.
 10617
 10618     IF CC-MEMBER-NO NOT = SPACES
 10619         MOVE CC-MEMBER-NO           TO CR-MEMBER-NO
 10620                                        DET-PR-MEM
 10621     ELSE
 10622         MOVE SPACES                 TO DET-PR-MEM.
 10623
 10624     IF CC-SOC-SEC-NO NOT = SPACES
 10625         MOVE CC-SOC-SEC-NO          TO CR-SOC-SEC
 10626                                        DET-PR-SS
 10627     ELSE
 10628         MOVE SPACES                 TO DET-PR-SS.
 10629
 10630     IF CC-LOAN-APR NOT = ZEROS
 10631         MOVE CC-LOAN-APR            TO CR-APR
 10632                                        DET-PR-APR
 10633     ELSE
 10634         MOVE ZEROS                  TO DET-PR-APR.
 10635
 10636     IF CC-AGE NOT = ZERO  OR
 10637        CC-INSURED-JOINT-AGE NOT = ZERO  OR
 10638        CC-INSURED-SEX NOT = SPACE  OR
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 207
* ECS010MO.cbl
 10639        CC-MEMBER-NO NOT = SPACES  OR
 10640        CC-SOC-SEC-NO NOT = SPACES  OR
 10641        CC-LOAN-APR NOT = ZERO
 10642         MOVE DET-PR-UREC            TO TR-DTL2
 10643         MOVE 'Y'                    TO WS-CHANGE-REC-SW
 10644         PERFORM 8690-PRINT-DETAIL-LINE THRU 8699-PRT-DETAIL-X.
 10645
 10646     IF CC-LF-ORIG-TERM NOT = ZEROS
 10647         MOVE CR-LF-TERM             TO DET-O-LF-TERM
 10648         MOVE CC-LF-ORIG-TERM        TO CR-LF-TERM
 10649                                        DET-N-LF-TERM
 10650     ELSE
 10651         MOVE ZEROS                  TO DET-O-LF-TERM
 10652                                        DET-N-LF-TERM.
 10653
 10654     IF CC-AH-ORIG-TERM NOT = ZEROS
 10655         MOVE CR-AH-TERM             TO DET-O-AH-TERM
 10656         MOVE CC-AH-ORIG-TERM        TO CR-AH-TERM
 10657                                        DET-N-AH-TERM
 10658     ELSE
 10659         MOVE ZEROS                  TO DET-O-AH-TERM
 10660                                        DET-N-AH-TERM.
 10661
 10662     IF CC-LIVES NOT = ZEROS
 10663         MOVE CR-LIVES               TO DET-O-LIVES
 10664         MOVE CC-LIVES               TO CR-LIVES
 10665                                        DET-N-LIVES
 10666     ELSE
 10667         MOVE ZEROS                  TO DET-O-LIVES
 10668                                        DET-N-LIVES.
 10669
 10670     IF CC-BILLED NOT  = ZEROES
 10671         MOVE CC-BILLED              TO CR-BILLED.
 10672
 10673     IF CC-LF-ORIG-TERM NOT = ZERO  OR
 10674        CC-AH-ORIG-TERM NOT = ZERO  OR
 10675        CC-LIVES NOT = ZERO
 10676         MOVE DET-PR-UREC-2          TO TR-DTL2
 10677         MOVE 'Y'                    TO WS-CHANGE-REC-SW
 10678         PERFORM 8690-PRINT-DETAIL-LINE THRU 8699-PRT-DETAIL-X.
 10679
 10680     IF CC-IND-GRP-TYPE NOT = SPACES
 10681         MOVE CC-IND-GRP-TYPE        TO CR-IND-GRP
 10682                                        DET-IND-GRP
 10683     ELSE
 10684         MOVE SPACE                  TO DET-IND-GRP.
 10685
 10686     IF CC-PAY-FREQUENCY NOT = ZEROS
 10687         MOVE CC-PAY-FREQUENCY       TO CR-PMT-FREQ
 10688                                        DET-PMT-FREQ
 10689     ELSE
 10690         MOVE ZEROS                  TO DET-PMT-FREQ.
 10691
 10692     IF CC-POLICY-FORM-NO NOT = SPACES
 10693         MOVE CC-POLICY-FORM-NO      TO CR-POLICY-FORM-NO
 10694                                        DET-POL-FORM
 10695     ELSE
 10696         MOVE SPACES                 TO DET-POL-FORM.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 208
* ECS010MO.cbl
 10697
 10698     IF CC-LOAN-OFFICER NOT = SPACES
 10699         MOVE CC-LOAN-OFFICER        TO CR-LOAN-OFFICER
 10700                                        DET-LOAN-OFFICER
 10701     ELSE
 10702         MOVE SPACES                 TO DET-LOAN-OFFICER.
 10703
 10704     IF CC-USER-FIELD NOT = SPACES
 10705         MOVE CC-USER-FIELD          TO CR-USER-CODE
 10706                                        DET-USER-CODE
 10707     ELSE
 10708         MOVE SPACE                  TO DET-USER-CODE.
 10709
 10710     IF CC-IND-GRP-TYPE NOT = SPACE  OR
 10711        CC-PAY-FREQUENCY NOT = ZEROS  OR
 10712        CC-POLICY-FORM-NO NOT = SPACES  OR
 10713        CC-LOAN-OFFICER NOT = SPACES  OR
 10714        CC-USER-FIELD NOT = SPACES
 10715         MOVE DET-PR-UREC-3          TO TR-DTL2
 10716         MOVE 'Y'                    TO WS-CHANGE-REC-SW
 10717         PERFORM 8690-PRINT-DETAIL-LINE THRU 8699-PRT-DETAIL-X.
 10718
 10719     IF CC-CLAIM-DEDUCT-WITHHELD NOT = ZEROS
 10720         MOVE CC-CLAIM-DEDUCT-WITHHELD
 10721                                     TO CR-CLAIM-DEDUCT-WITHHELD
 10722                                        DET-CLM-DEDUCT
 10723     ELSE
 10724         MOVE ZEROS                  TO DET-CLM-DEDUCT.
 10725
 10726     IF CC-CANCEL-DEDUCT-WITHHELD NOT = ZEROS
 10727         MOVE CC-CANCEL-DEDUCT-WITHHELD
 10728                                     TO CR-CANCEL-DEDUCT-WITHHELD
 10729                                        DET-CAN-DEDUCT
 10730     ELSE
 10731         MOVE ZEROS                  TO DET-CAN-DEDUCT.
 10732
 10733     IF CC-CLAIM-DEDUCT-WITHHELD NOT = ZEROS  OR
 10734        CC-CANCEL-DEDUCT-WITHHELD NOT = ZEROS
 10735         MOVE DET-PR-UREC-4          TO TR-DTL2
 10736         MOVE 'Y'                    TO WS-CHANGE-REC-SW
 10737         PERFORM 8690-PRINT-DETAIL-LINE THRU 8699-PRT-DETAIL-X.
 10738
 10739     IF CC-LF-PREMIUM-AMT NOT NUMERIC
 10740         MOVE ZEROS              TO  CC-LF-PREMIUM-AMT.
 10741
 10742     IF CC-LF-BENEFIT-AMT NOT NUMERIC
 10743         MOVE ZEROS              TO  CC-LF-BENEFIT-AMT.
 10744
 10745     IF CC-AH-PREMIUM-AMT NOT NUMERIC
 10746         MOVE ZEROS              TO  CC-AH-PREMIUM-AMT.
 10747
 10748     IF CC-AH-BENEFIT-AMT NOT NUMERIC
 10749         MOVE ZEROS              TO  CC-AH-BENEFIT-AMT.
 10750
 10751     IF CC-LF-BENEFIT-CD NOT = SPACES
 10752         MOVE CC-LF-BENEFIT-CD   TO  CR-LFTYP
 10753                                     DET-LF-BEN-CD
 10754     ELSE
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 209
* ECS010MO.cbl
 10755         MOVE SPACES             TO DET-LF-BEN-CD.
 10756
 10757     IF CC-LF-PREMIUM-AMT NOT = ZEROS
 10758         MOVE CC-LF-PREMIUM-AMT  TO  CR-LFPRM
 10759                                     DET-LF-PREM
 10760     ELSE
 10761         MOVE ZEROS              TO DET-LF-PREM.
 10762
 10763     IF CC-LF-BENEFIT-AMT NOT = ZEROS
 10764         MOVE CC-LF-BENEFIT-AMT  TO  CR-LFAMT
 10765                                     DET-LF-BEN
 10766     ELSE
 10767         MOVE ZEROS              TO DET-LF-BEN.
 10768
 10769     IF (CC-LF-BENEFIT-CD NOT = SPACES)  OR
 10770        (CC-LF-PREMIUM-AMT NOT = ZEROS)  OR
 10771        (CC-LF-BENEFIT-AMT NOT = ZEROS)
 10772         MOVE DET-PR-UREC-5          TO TR-DTL2
 10773         MOVE 'Y'                    TO WS-CHANGE-REC-SW
 10774         PERFORM 8690-PRINT-DETAIL-LINE THRU 8699-PRT-DETAIL-X.
 10775
 10776     IF CC-AH-BENEFIT-CD NOT = SPACES
 10777         MOVE CC-AH-BENEFIT-CD   TO  CR-AHTYP
 10778                                     DET-AH-BEN-CD
 10779     ELSE
 10780         MOVE SPACES             TO DET-AH-BEN-CD.
 10781
 10782     IF CC-AH-PREMIUM-AMT NOT = ZEROS
 10783         MOVE CC-AH-PREMIUM-AMT  TO  CR-AHPRM
 10784                                     DET-AH-PREM
 10785     ELSE
 10786         MOVE ZEROS              TO DET-AH-PREM.
 10787
 10788     IF CC-AH-BENEFIT-AMT NOT = ZEROS
 10789         MOVE CC-AH-BENEFIT-AMT  TO  CR-AHAMT
 10790                                     DET-AH-BEN
 10791     ELSE
 10792         MOVE ZEROS              TO DET-AH-BEN.
 10793
 10794     IF CC-AH-BENEFIT-CD NOT = SPACES OR
 10795        CC-AH-PREMIUM-AMT NOT = ZEROS OR
 10796        CC-AH-BENEFIT-AMT NOT = ZEROS
 10797         MOVE DET-PR-UREC-6          TO TR-DTL2
 10798         MOVE 'Y'                    TO WS-CHANGE-REC-SW
 10799         PERFORM 8690-PRINT-DETAIL-LINE THRU 8699-PRT-DETAIL-X.
 10800
 10801 0910-END-CHANGE-PROCESSING.
 10802
 10803     IF CR-LNAME = ALL '*'
 10804         MOVE SPACES                 TO CR-LNAME.
 10805     IF CR-FNAME = ALL '*'
 10806         MOVE SPACES                 TO CR-FNAME.
 10807     IF CR-INIT = '*'
 10808         MOVE SPACES                 TO CR-INIT.
 10809     IF CR-SOC-SEC = ALL '*'
 10810         MOVE SPACES                 TO CR-SOC-SEC.
 10811     IF CR-JT-LNAME = ALL '*'
 10812         MOVE SPACES                 TO CR-JT-LNAME.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 210
* ECS010MO.cbl
 10813     IF CR-JT-FNAME = ALL '*'
 10814         MOVE SPACES                 TO CR-JT-FNAME.
 10815     IF CR-JT-INIT = '*'
 10816         MOVE SPACES                 TO CR-JT-INIT.
 10817     IF CR-POLICY-FORM-NO = ALL '*'
 10818         MOVE SPACES                 TO CR-POLICY-FORM-NO.
 10819     IF CR-MEMBER-NO = ALL '*'
 10820         MOVE SPACES                 TO CR-MEMBER-NO.
 10821     IF CR-LOAN-OFFICER = ALL '*'
 10822         MOVE SPACES                 TO CR-LOAN-OFFICER.
 10823     IF CR-USER-CODE = ALL '*'
 10824         MOVE SPACES                 TO CR-USER-CODE.
 10825
 10826     ADD +1 TO BC-G-CTN.
 10827     GO TO 0300-READ-PENDING-TRANSACTIONS.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 211
* ECS010MO.cbl
 10829 0920-GET-BANK-FEES.
 10830
 10831     IF CR-CERT-NO = '0008771354 '
 10832        DISPLAY ' MADE IT TO 0920 '
 10833     END-IF
 10834
 10835     MOVE DTE-CLASIC-COMPANY-CD  TO AG-COMPANY-CD
 10836     MOVE CR-CARRIER             TO AG-CARRIER
 10837     MOVE CR-GROUPING            TO AG-GROUPING
 10838     MOVE CR-BANK-NO             TO AG-BANK
 10839     MOVE WS-CR-BIN-DATE         TO AG-EXP-DT
 10840     MOVE 'B'                    TO AG-TYPE
 10841
 10842*    IF WS-PREV-BANK-COMM-KEY = AG-CONTROL-PRIMARY
 10843*       PERFORM 0925-BUILD-WORK-BNK-COMM
 10844*                                THRU 0925-EXIT
 10845*       GO TO 0920-EXIT
 10846*    END-IF
 10847
 10848     START ERAGTC KEY NOT < AG-CONTROL-PRIMARY
 10849
 10850     IF CR-CERT-NO = '0008771354 '
 10851        DISPLAY ' MADE IT AFTER START '
 10852     END-IF
 10853
 10854     .
 10855 0920-READ-ERAGTC.
 10856
 10857     IF ERAGTC-FILE-STATUS = '00'
 10858        READ ERAGTC NEXT RECORD
 10859     IF CR-CERT-NO = '0008771354 '
 10860        DISPLAY ' MADE ONE READ '
 10861     END-IF
 10862
 10863        IF ERAGTC-FILE-STATUS = '00'
 10864           IF (CR-CARRIER         = AG-CARRIER)
 10865              AND (CR-GROUPING    = AG-GROUPING)
 10866              AND (CR-BANK-NO     = AG-BANK)
 10867              IF WS-CR-BIN-DATE  = AG-EXP-DT
 10868                 GO TO 0920-READ-ERAGTC
 10869              ELSE
 10870                 IF (WS-CR-BIN-DATE NOT < AG-EFF-DT)
 10871                    AND (WS-CR-BIN-DATE < AG-EXP-DT)
 10872                    PERFORM 0925-BUILD-WORK-BNK-COMM
 10873                                 THRU 0925-EXIT
 10874                    MOVE AG-CONTROL-PRIMARY
 10875                                 TO WS-PREV-BANK-COMM-KEY
 10876                    GO TO 0920-EXIT
 10877                 END-IF
 10878              END-IF
 10879           END-IF
 10880        END-IF
 10881     END-IF
 10882
 10883     MOVE WS-BANK-INIT           TO WS-BANK-COMMISSIONS
 10884*    PERFORM 0925-BUILD-WORK-BNK-COMM
 10885
 10886     IF (CR-BANK-NO NOT = SPACES AND ZEROS)
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 212
* ECS010MO.cbl
 10887        AND (PB-I-BANK-FEE NOT = ZEROS)
 10888        MOVE CR-BANK-NO          TO WS-BNK-AGT (1)
 10889        MOVE 'B'                 TO WS-BNK-TYPE (1)
 10890        MOVE PB-I-BANK-FEE       TO WS-BNK-SPP-FEES (1)
 10891        MOVE ' '                 TO WS-BNK-RECALC (1)
 10892        MOVE +2                  TO IB
 10893     END-IF
 10894
 10895     .
 10896 0920-EXIT.
 10897     EXIT.
 10898
 10899 0925-BUILD-WORK-BNK-COMM.
 10900
 10901     IF CR-CERT-NO = '0008771354 '
 10902        DISPLAY ' MADE IT TO 0925 '
 10903     END-IF
 10904
 10905     MOVE +1                     TO IA IB
 10906
 10907*    IF (CR-BANK-NO NOT = SPACES AND ZEROS)
 10908*       AND (PB-I-BANK-FEE NOT = ZEROS)
 10909*       MOVE CR-BANK-NO          TO WS-BNK-AGT (IB)
 10910*       MOVE 'B'                 TO WS-BNK-TYPE (IB)
 10911*       MOVE PB-I-BANK-FEE       TO WS-BNK-SPP-FEES (IB)
 10912*       MOVE ' '                 TO WS-BNK-RECALC (IB)
 10913*       ADD +1                   TO IB
 10914*    END-IF
 10915*    .
 10916*0925-BUILD-CONTINUE.
 10917
 10918     IF CR-CERT-NO = '00087735841'
 10919        DISPLAY ' WS-BNK-AGT ' WS-BNK-AGT (1)
 10920        MOVE WS-BNK-SPP-FEES (1) TO WS-DISP-AMT
 10921        DISPLAY ' WS-BNK-FEE ' WS-DISP-AMT
 10922     END-IF
 10923
 10924*    PERFORM VARYING IA FROM +2 BY +1 UNTIL
 10925     PERFORM VARYING IA FROM +1 BY +1 UNTIL
 10926        (IA > +10)
 10927        OR (IB > +10)
 10928        IF AG-AGT (IA) NOT = SPACES AND ZEROS
 10929           MOVE AG-AGT (IA)      TO WS-BNK-AGT (IB)
 10930           MOVE 'B'              TO WS-BNK-TYPE (IB)
 10931*          MOVE AG-COM-TYP (IA)  TO WS-BNK-TYPE (IB)
 10932           IF AG-SPP-FEES (IA) NOT NUMERIC
 10933              MOVE ZEROS         TO AG-SPP-FEES (IA)
 10934           END-IF
 10935           MOVE AG-SPP-FEES (IA) TO WS-BNK-SPP-FEES (IB)
 10936           MOVE AG-RECALC-LV-INDIC (IA)
 10937                                 TO WS-BNK-RECALC (IB)
 10938        ELSE
 10939           MOVE SPACES           TO WS-BNK-AGT (IB)
 10940                                    WS-BNK-TYPE (IB)
 10941                                    WS-BNK-RECALC (IB)
 10942           MOVE ZEROS            TO WS-BNK-SPP-FEES (IB)
 10943        END-IF
 10944        ADD +1                   TO IB
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 213
* ECS010MO.cbl
 10945     END-PERFORM
 10946
 10947     .
 10948 0925-EXIT.
 10949     EXIT.
 10950
 10951 0930-BUILD-CERT-TRLR.
 10952
 10953     MOVE SPACES                 TO CERTIFICATE-TRAILERS
 10954     MOVE 'CS'                   TO CS-RECORD-ID
 10955     MOVE DTE-CLASIC-COMPANY-CD  TO CS-COMPANY-CD
 10956     MOVE CR-CARRIER             TO CS-CARRIER
 10957     MOVE CR-GROUPING            TO CS-GROUPING
 10958     MOVE CR-STATE               TO CS-STATE
 10959     MOVE CR-ACCOUNT             TO CS-ACCOUNT
 10960     MOVE WS-CR-BIN-DATE         TO CS-CERT-EFF-DT
 10961     MOVE CR-CERT-NO             TO CS-CERT-NO
 10962     MOVE 'A'                    TO CS-TRAILER-TYPE
 10963
 10964     MOVE WS-BANK-COMMISSIONS    TO CS-BANK-COMMISSION-AREA
 10965
 10966     IF CS-AGT (1) NOT = SPACES AND ZEROS
 10967        WRITE CERTIFICATE-TRAILERS
 10968        IF ELCRTT-FILE-STATUS = '00'
 10969           CONTINUE
 10970        ELSE
 10971           IF ELCRTT-FILE-STATUS = '22'
 10972              READ ELCRTT
 10973              IF ELCRTT-FILE-STATUS = '00'
 10974                 MOVE WS-BANK-COMMISSIONS
 10975                                 TO CS-BANK-COMMISSION-AREA
 10976                 REWRITE CERTIFICATE-TRAILERS
 10977                 IF ELCRTT-FILE-STATUS NOT = '00'
 10978                    DISPLAY ' BAD REWRITE ELCRTT '
 10979                                 ELCRTT-FILE-STATUS
 10980                    PERFORM ABEND-PGM
 10981                 END-IF
 10982              ELSE
 10983                 DISPLAY ' BAD READ    ELCRTT '
 10984                                  ELCRTT-FILE-STATUS
 10985                 PERFORM ABEND-PGM
 10986              END-IF
 10987           ELSE
 10988              DISPLAY ' BAD WRITE ELCRTT '
 10989                                 ELCRTT-FILE-STATUS
 10990              PERFORM ABEND-PGM
 10991           END-IF
 10992        END-IF
 10993     END-IF
 10994
 10995     .
 10996 0930-EXIT.
 10997     EXIT.
 10998
 10999 0950-BUILD-CERT-C-TRLR.
 11000
 11001     MOVE SPACES                 TO CERTIFICATE-TRAILERS.
 11002     MOVE 'CS'                   TO CS-RECORD-ID.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 214
* ECS010MO.cbl
 11003     MOVE DTE-CLASIC-COMPANY-CD  TO CS-COMPANY-CD.
 11004     MOVE CR-CARRIER             TO CS-CARRIER.
 11005     MOVE CR-GROUPING            TO CS-GROUPING.
 11006     MOVE CR-STATE               TO CS-STATE.
 11007     MOVE CR-ACCOUNT             TO CS-ACCOUNT.
 11008     MOVE WS-CR-BIN-DATE         TO CS-CERT-EFF-DT.
 11009     MOVE CR-CERT-NO             TO CS-CERT-NO.
 11010     MOVE 'C'                    TO CS-TRAILER-TYPE.
 11011
 11012     MOVE PB-I-VIN               TO CS-VIN-NUMBER.
 11013
 11014     WRITE CERTIFICATE-TRAILERS.
 11015     IF ELCRTT-FILE-STATUS = '00'
 11016        CONTINUE
 11017     ELSE
 11018        IF ELCRTT-FILE-STATUS = '22'
 11019           READ ELCRTT
 11020           IF ELCRTT-FILE-STATUS = '00'
 11021              MOVE PB-I-VIN      TO CS-VIN-NUMBER
 11022              REWRITE CERTIFICATE-TRAILERS
 11023              IF ELCRTT-FILE-STATUS NOT = '00'
 11024                 DISPLAY ' BAD REWRITE ELCRTT '
 11025                              ELCRTT-FILE-STATUS
 11026                 PERFORM ABEND-PGM
 11027              END-IF
 11028           ELSE
 11029              DISPLAY ' BAD READ    ELCRTT '
 11030                               ELCRTT-FILE-STATUS
 11031              PERFORM ABEND-PGM
 11032           END-IF
 11033        ELSE
 11034           DISPLAY ' BAD WRITE ELCRTT '
 11035                              ELCRTT-FILE-STATUS
 11036           PERFORM ABEND-PGM
 11037        END-IF
 11038     END-IF.
 11039
 11040     .
 11041 0950-EXIT.
 11042     EXIT.
 11043
 11044
 11045******************************************************************
 11046***      S E T   C O M M I S S I O N   S T R U C T U R E       ***
 11047******************************************************************
 11048
 11049 1000-SET-COMMISSION-STRUCTURE.
 11050
 11051     MOVE +1                     TO IA
 11052                                    IB.
 11053
 11054 1100-GET-COMMISSION-LEVEL.
 11055
 11056     MOVE AM-AGT-COMMS (IA)      TO WK-LEVEL.
 11057
 11058     IF WK-AGT = '0000000000' OR SPACES
 11059         MOVE +0                 TO WK-L-RT
 11060                                    WK-J-RT
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 215
* ECS010MO.cbl
 11061                                    WK-A-RT
 11062         GO TO 1200-SET-COMMISSION-LEVEL.
 11063
 11064 1110-LIFE-COMMISSION.
 11065
 11066     IF CR-LFTYP = ZERO  OR
 11067       (CR-ENTRY-STATUS = 'P' OR 'D' OR 'V')
 11068         MOVE +0 TO WK-L-RT
 11069                    WK-J-RT
 11070         GO TO 1130-A-H-COMMISSION.
 11071
 11072     IF CLAS-I-JOINT (CLAS-INDEXL) = 'J'
 11073         GO TO 1120-JOINT-LIFE-COMMISSION.
 11074
 11075     IF WK-L-RT NUMERIC
 11076        AND (WK-L-RTX (3:1) NOT = 'L' AND 'M')
 11077         MOVE WK-L-RT                TO WS-COMMISSION
 11078         PERFORM 6650-GET-RES-STATE-COMM  THRU 6700-COMM-EXIT
 11079         MOVE WS-COMMISSION          TO WK-L-RT
 11080         GO TO 1130-A-H-COMMISSION.
 11081
 11082     MOVE LIFE-OVERRIDE-L1           TO CTBL-BEN-TYPE.
 11083     MOVE CR-LFTYP                   TO CTBL-BEN-CODE.
 11084     MOVE ZEROS                      TO WS-SUB1.
 11085     PERFORM 6650-GET-RES-STATE-COMM  THRU 6700-COMM-EXIT
 11086
 11087     IF WS-SUB1 = ZEROS
 11088         MOVE WK-L-RTX               TO CTBL-TABLE-CD
 11089     ELSE
 11090         MOVE WK-RATE                TO WK-L-RT
 11091         GO TO 1130-A-H-COMMISSION.
 11092
 11093     PERFORM 1300-READ-ERCTBL-FILE THRU 1399-READ-ERCTBL-X.
 11094
 11095     MOVE CR-LFAMT                   TO COMM-CK-AMT.
 11096     MOVE CR-LF-TERM                 TO WS-COMM-TERM.
 11097     PERFORM 1400-GET-COMM-PERCENT THRU 1489-GET-PERCENT-X.
 11098     MOVE WK-RATE                    TO WK-L-RT.
 11099
 11100     GO TO 1130-A-H-COMMISSION.
 11101
 11102 1120-JOINT-LIFE-COMMISSION.
 11103
 11104     IF WK-J-RT NUMERIC
 11105        AND (WK-J-RTX (3:1) NOT = 'L' AND 'M')
 11106         MOVE WK-J-RT                TO WS-COMMISSION
 11107         PERFORM 6650-GET-RES-STATE-COMM  THRU 6700-COMM-EXIT
 11108         MOVE WS-COMMISSION          TO WK-J-RT
 11109         GO TO 1130-A-H-COMMISSION.
 11110
 11111     MOVE LIFE-OVERRIDE-L1           TO CTBL-BEN-TYPE.
 11112     MOVE CR-LFTYP                   TO CTBL-BEN-CODE.
 11113     MOVE ZEROS                      TO WS-SUB1.
 11114     PERFORM 6650-GET-RES-STATE-COMM  THRU 6700-COMM-EXIT
 11115
 11116     IF WS-SUB1 = ZEROS
 11117         MOVE WK-J-RTX               TO CTBL-TABLE-CD
 11118     ELSE
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 216
* ECS010MO.cbl
 11119         MOVE WK-RATE                TO WK-J-RT
 11120         GO TO 1130-A-H-COMMISSION.
 11121
 11122     PERFORM 1300-READ-ERCTBL-FILE THRU 1399-READ-ERCTBL-X.
 11123
 11124     MOVE CR-LFAMT                   TO COMM-CK-AMT.
 11125     MOVE CR-LF-TERM                 TO WS-COMM-TERM.
 11126     PERFORM 1400-GET-COMM-PERCENT THRU 1489-GET-PERCENT-X.
 11127     MOVE WK-RATE                    TO WK-J-RT.
 11128
 11129 1130-A-H-COMMISSION.
 11130
 11131     IF CR-AHTYP = ZERO  OR
 11132       (CR-ENTRY-STATUS = 'P' OR 'D' OR 'V')
 11133         MOVE +0 TO WK-A-RT
 11134         GO TO 1200-SET-COMMISSION-LEVEL.
 11135
 11136     IF WK-A-RT NUMERIC
 11137        AND (WK-A-RTX (3:1) NOT = 'L' AND 'M')
 11138         MOVE WK-A-RT                TO WS-COMMISSION
 11139         PERFORM 6650-GET-RES-STATE-COMM  THRU 6700-COMM-EXIT
 11140         MOVE WS-COMMISSION          TO WK-A-RT
 11141         GO TO 1200-SET-COMMISSION-LEVEL.
 11142
 11143     MOVE AH-OVERRIDE-L1             TO CTBL-BEN-TYPE.
 11144     MOVE CR-AHTYP                   TO CTBL-BEN-CODE.
 11145     MOVE ZEROS                      TO WS-SUB1.
 11146     PERFORM 6650-GET-RES-STATE-COMM  THRU 6700-COMM-EXIT
 11147
 11148     IF WS-SUB1 = ZEROS
 11149         MOVE WK-A-RTX               TO CTBL-TABLE-CD
 11150     ELSE
 11151         MOVE WK-RATE                TO WK-A-RT
 11152         GO TO 1200-SET-COMMISSION-LEVEL.
 11153
 11154     PERFORM 1300-READ-ERCTBL-FILE THRU 1399-READ-ERCTBL-X.
 11155
 11156     COMPUTE COMM-CK-AMT = CR-AHAMT * CR-AH-TERM.
 11157     MOVE CR-AH-TERM                 TO WS-COMM-TERM.
 11158     PERFORM 1400-GET-COMM-PERCENT THRU 1489-GET-PERCENT-X.
 11159     MOVE WK-RATE                    TO WK-A-RT.
 11160
 11161 1200-SET-COMMISSION-LEVEL.
 11162
 11163     MOVE WK-AGT                      TO WK-N-AGT  (IA).
 11164     IF WK-AGT = '0000000000' OR SPACES
 11165         MOVE SPACE                   TO WK-N-TYPE (IA)
 11166     ELSE
 11167         MOVE WK-A-TYPE               TO WK-N-TYPE (IA).
 11168
 11169     IF CR-LFTYP = ZERO
 11170         MOVE +0                      TO WK-L-RT1  (IA)
 11171     ELSE
 11172         IF CLAS-I-JOINT (CLAS-INDEXL) = 'J'
 11173             MOVE WK-J-RT             TO WK-L-RT1 (IA)
 11174         ELSE
 11175             MOVE WK-L-RT             TO WK-L-RT1 (IA).
 11176
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 217
* ECS010MO.cbl
 11177     MOVE WK-A-RT                     TO WK-A-RT1 (IA).
 11178
 11179     IF RC-COMM-FLG = 'X'
 11180        IF (AM-RECALC-LV-INDIC (IA) = 'N')
 11181*          OR ((CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'G' OR 'L')
 11182*             AND (IA = +5))
 11183            MOVE CR-COM-AGT  (IA)         TO WK-N-AGT  (IA)
 11184            MOVE CR-AGT-TYPE (IA)         TO WK-N-TYPE (IA)
 11185            MOVE CR-LCOM-L   (IA)         TO WK-L-RT1  (IA)
 11186            MOVE CR-LCOM-AH  (IA)         TO WK-A-RT1  (IA).
 11187
 11188     IF IA LESS THAN +10
 11189         ADD +1 TO IA
 11190         GO TO 1100-GET-COMMISSION-LEVEL.
 11191
 11192     GO TO 1499-SET-COMM-X.
 11193
 11194 1300-READ-ERCTBL-FILE.
 11195
 11196     IF CTBL-SEARCH = LAST-CTBL
 11197         GO TO 1399-READ-ERCTBL-X.
 11198
 11199     MOVE SPACE                          TO CTBL-ERROR-SWITCH.
 11200
 11201     IF COMM-OPEN-SW = ' '
 11202         MOVE 'X'                        TO COMM-OPEN-SW
 11203         MOVE DTE-CLASIC-COMPANY-CD      TO CTBL-COMP-CD
 11204         OPEN INPUT ERCTBL
 11205         IF ERCTBL-FILE-STATUS = '00'  OR  '97'
 11206             NEXT SENTENCE
 11207            ELSE
 11208             MOVE '41'                   TO ABEND-CODE-1
 11209             MOVE ERCTBL-FILE-STATUS     TO ABEND-CODE-2
 11210             DISPLAY '******************************'
 11211             DISPLAY '***** ERROR LOCATION 012 *****'
 11212             DISPLAY '******************************'
 11213             DISPLAY '******************************'
 11214             MOVE WS-ABEND-CODE          TO WS-RETURN-CODE
 11215             GO TO ABEND-PGM.
 11216
 11217     MOVE CTBL-SEARCH                    TO CT-CONTROL-PRIMARY
 11218                                            LAST-CTBL.
 11219     READ ERCTBL.
 11220
 11221     IF ERCTBL-FILE-STATUS = '23'
 11222         DISPLAY 'INVALID COMM TABLE CODE FOR: ' CR-FULL-CONTROL
 11223                 ' ENTERED: ' CR-ENTRY-STATUS '-' CR-ENTRY-DATE
 11224                 ' CTBL: ' CTBL-SEARCH
 11225         MOVE '*'                TO CTBL-ERROR-SWITCH
 11226         MOVE '44'               TO ABEND-CODE-1
 11227         MOVE ERCTBL-FILE-STATUS TO ABEND-CODE-2
 11228         DISPLAY 'CT-CONTROL-PRIMARY = ' CT-CONTROL-PRIMARY
 11229         DISPLAY '******************************'
 11230         DISPLAY '***** ERROR LOCATION 013 *****'
 11231         DISPLAY '******************************'
 11232         MOVE WS-ABEND-CODE      TO WS-RETURN-CODE
 11233*        IF DTE-CLIENT NOT = 'NCL'
 11234         IF DTE-CLIENT NOT = 'NCL' AND 'CID' AND 'CSO'
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 218
* ECS010MO.cbl
 11235             GO TO ABEND-PGM
 11236         ELSE
 11237             NEXT SENTENCE
 11238     ELSE
 11239         IF ERCTBL-FILE-STATUS NOT = '00'
 11240             MOVE 'READ ERROR ON ERCTBL' TO WS-ABEND-MESSAGE
 11241             MOVE '44'               TO ABEND-CODE-1
 11242             MOVE ERCTBL-FILE-STATUS TO ABEND-CODE-2
 11243             DISPLAY '******************************'
 11244             DISPLAY '***** ERROR LOCATION 014 *****'
 11245             DISPLAY '******************************'
 11246             MOVE WS-ABEND-CODE      TO WS-RETURN-CODE
 11247             GO TO ABEND-PGM.
 11248
 11249     ADD +1                            TO ERCTBL-READS.
 11250
 11251 1399-READ-ERCTBL-X.
 11252     EXIT.
 11253
 11254 1400-GET-COMM-PERCENT.
 11255
 11256     IF CTBL-ERROR
 11257         MOVE ZEROS                      TO WK-RATE
 11258         GO TO 1489-GET-PERCENT-X.
 11259
 11260     MOVE +1 TO IB.
 11261     IF (COMM-CK-AMT GREATER CT-TBF (1)) AND
 11262        (CT-TBF (1) NOT EQUAL +9999999.99)
 11263         ADD +9 TO IB
 11264         IF (COMM-CK-AMT GREATER CT-TBF (2)) AND
 11265            (CT-TBF (2) NOT EQUAL +9999999.99)
 11266             ADD +9 TO IB.
 11267
 11268     IF CR-AGE GREATER CT-AGE (1)
 11269         ADD +3 TO IB
 11270         IF CR-AGE GREATER CT-AGE (2)
 11271             ADD +3 TO IB.
 11272
 11273     IF WS-COMM-TERM GREATER CT-TRM (1)
 11274         ADD +1 TO IB
 11275         IF WS-COMM-TERM GREATER CT-TRM (2)
 11276             ADD +1 TO IB.
 11277
 11278     IF CT-RT (IB) NOT NUMERIC
 11279         MOVE LAST-CTBL     TO CT-CONTROL-PRIMARY
 11280         MOVE CT-RT-R (IB)  TO CTBL-TABLE-CD
 11281         GO TO 1300-READ-ERCTBL-FILE.
 11282
 11283     MOVE CT-RT (IB) TO WK-RATE.
 11284
 11285 1489-GET-PERCENT-X.
 11286     EXIT.
 11287
 11288 1499-SET-COMM-X.
 11289     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 219
* ECS010MO.cbl
 11291******************************************************************
 11292***  C O M P U T E   A C C T   L E V E L   C O M M I S S I O N ***
 11293******************************************************************
 11294
 11295 1500-GET-ACCT-LEVEL-LF-COMM.
 11296
 11297     MOVE ZEROS                      TO ACCT-COMM-LF
 11298                                        ACCT-COMM-AH.
 11299
 11300     MOVE +1                         TO IA.
 11301
 11302 1510-ACCT-LEVEL-LOOP.
 11303
 11304     IF CR-AGT-TYPE (IA) = 'C'  OR  'D' OR 'F' OR 'S'
 11305         IF WS-LEVELS-CHARGEBACK-SWITCHES = SPACES
 11306             ADD CR-LCOM-L (IA)  TO ACCT-COMM-LF
 11307             ADD CR-LCOM-AH (IA) TO ACCT-COMM-AH
 11308         ELSE
 11309             IF WS-LF-CHARGEBACK-SW (IA)  =  'Y'
 11310                 ADD CR-LCOM-L (IA)  TO ACCT-COMM-LF.
 11311
 11312     IF IA LESS THAN +10
 11313         ADD +1 TO IA
 11314         GO TO 1510-ACCT-LEVEL-LOOP.
 11315
 11316 1519-ACCT-LF-COMM-X.
 11317     EXIT.
 11318
 11319
 11320 1550-GET-ACCT-LEVEL-AH-COMM.
 11321
 11322     MOVE ZEROS                      TO ACCT-COMM-AH.
 11323
 11324     MOVE +1                         TO IA.
 11325
 11326 1555-ACCT-LEVEL-LOOP.
 11327
 11328     IF CR-AGT-TYPE (IA) = 'C'  OR  'D' OR 'F' OR 'S'
 11329         IF WS-AH-CHARGEBACK-SW (IA)  =  'Y'
 11330             ADD CR-LCOM-AH (IA)  TO ACCT-COMM-AH.
 11331
 11332     IF IA LESS THAN +10
 11333         ADD +1 TO IA
 11334         GO TO 1555-ACCT-LEVEL-LOOP.
 11335
 11336 1599-ACCT-AH-COMM-X.
 11337     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 220
* ECS010MO.cbl
 11339******************************************************************
 11340***      C O M M I S S I O N   R E C A L C   R O U T I N E     ***
 11341******************************************************************
 11342
 11343 1600-RECALC-COMM-EXTR.
 11344
 11345     IF RC-COMM-FLG = 'X'  OR
 11346        (DTE-PGM-OPT = '2'  OR  '3')  OR
 11347        CR-POLICY-IS-DECLINED  OR
 11348        CR-POLICY-IS-VOID
 11349         GO TO 1899-RECALC-COMM-EXTR-X.
 11350
 11351     MOVE 'X'                           TO RC-COMM-FLG.
 11352
 11353     IF CR-ENTRY-DATE = EOM-RUN-DATE
 11354         GO TO 1899-RECALC-COMM-EXTR-X.
 11355
 11356     PERFORM 1000-SET-COMMISSION-STRUCTURE THRU 1499-SET-COMM-X.
 11357
 11358     IF CR-COMPENSATION-LEVELS = WK-NEW-RATES
 11359         GO TO 1899-RECALC-COMM-EXTR-X.
 11360
 11361     MOVE WK-NEW-RATES                  TO SAVE-WK-NEW-RATES.
 11362
 11363     PERFORM 1610-CK-DUPLICATE-ENTRIES
 11364         THRU 1619-CK-DUPLICATE-ENTRIES-XIT
 11365             VARYING SUB11 FROM 1 BY 1 UNTIL SUB11 GREATER 10.
 11366
 11367     IF CR-COMPENSATION-LEVELS = WK-NEW-RATES
 11368         MOVE SAVE-WK-NEW-RATES         TO CR-COMPENSATION-LEVELS
 11369                                           WK-NEW-RATES
 11370         GO TO 1899-RECALC-COMM-EXTR-X.
 11371
 11372     MOVE +1                            TO SUB8.
 11373     GO TO 1700-REVERSE-OLD-COMM-LOOP.
 11374
 11375 1610-CK-DUPLICATE-ENTRIES.
 11376     PERFORM 1620-CK-DUPL-ENTR-NEW
 11377         THRU 1629-CK-DUPL-ENTR-NEW-XIT
 11378             VARYING SUB12 FROM 1 BY 1 UNTIL SUB12 GREATER 10.
 11379
 11380 1619-CK-DUPLICATE-ENTRIES-XIT.
 11381     EXIT.
 11382
 11383 1620-CK-DUPL-ENTR-NEW.
 11384     IF CR-AGT-LEVELS (SUB11) = WK-N-R (SUB12)
 11385         MOVE SPACES                    TO CR-COM-AGT (SUB11)
 11386         MOVE SPACE                     TO CR-AGT-TYPE (SUB11)
 11387         MOVE +0                        TO CR-LCOM-L (SUB11)
 11388                                           CR-LCOM-AH (SUB11)
 11389         MOVE CR-AGT-LEVELS (SUB11)     TO WK-N-R (SUB12)
 11390         MOVE 11                        TO SUB12.
 11391
 11392 1629-CK-DUPL-ENTR-NEW-XIT.
 11393     EXIT.
 11394
 11395 1700-REVERSE-OLD-COMM-LOOP.
 11396     COMPUTE CR-LCOM-L (SUB8) = CR-LCOM-L (SUB8) * -1.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 221
* ECS010MO.cbl
 11397     COMPUTE CR-LCOM-AH (SUB8) = CR-LCOM-AH (SUB8) * -1.
 11398
 11399     IF SUB8 LESS THAN +10
 11400         ADD +1 TO SUB8
 11401         GO TO 1700-REVERSE-OLD-COMM-LOOP.
 11402
 11403     MOVE 'O' TO RECALC-TYPE.
 11404
 11405     PERFORM 1710-DO-R-C-EXTRACTS THRU 1719-DO-R-C-EXTRACTS-X.
 11406
 11407     GO TO 1800-MOVE-NEW-COMM-RATES.
 11408
 11409 1710-DO-R-C-EXTRACTS.
 11410
 11411     PERFORM 2000-INITIALIZE-DETAIL-EXTRACT THRU 2099-INIT-DTL-X.
 11412
 11413     PERFORM 1720-CHECK-COMM-LEVELS
 11414         THRU 1729-CHECK-COMM-LEVELS-EXIT
 11415             VARYING SUB13 FROM +1 BY +1
 11416                 UNTIL SUB13 GREATER THAN 10.
 11417
 11418     MOVE '8'                           TO DE-TRANS.
 11419     MOVE RECALC-TYPE                   TO DE-RECALC-TYPE.
 11420*****PERFORM EXTRACT-DATE-RELOAD.
 11421     MOVE DETAIL-EXTRACT                TO SAVE-EXTRACT.
 11422     PERFORM 2500-WRITE-DETAIL-EXTRACTS THRU 2599-WRT-DETAIL-X.
 11423     MOVE SAVE-EXTRACT                  TO DETAIL-EXTRACT.
 11424     PERFORM EXTRACT-DATE-LOAD.
 11425     MOVE 'R'                           TO DE-REIN.
 11426     MOVE DETAIL-EXTRACT                TO SAVE-EXTRACT.
 11427     MOVE +1                            TO SUB1.
 11428     PERFORM 3110-REINSURE-ISSUE-LOOP
 11429         THRU 3119-REINSURE-ISSUE-LOOP-END.
 11430
 11431     IF CR-LF-CANCEL-APPLIED  OR  CR-AH-CANCEL-APPLIED
 11432         PERFORM 2200-BUILD-CANCEL-EXTRACT THRU
 11433                                       2259-END-CANCEL-BUILD
 11434         PERFORM 1720-CHECK-COMM-LEVELS
 11435             THRU 1729-CHECK-COMM-LEVELS-EXIT
 11436                 VARYING SUB13 FROM +1 BY +1
 11437                     UNTIL SUB13 GREATER THAN 10
 11438         MOVE '7'                       TO DE-TRANS
 11439         MOVE RECALC-TYPE               TO DE-RECALC-TYPE
 11440*********PERFORM EXTRACT-DATE-RELOAD
 11441         MOVE DETAIL-EXTRACT            TO SAVE-EXTRACT
 11442         PERFORM 2500-WRITE-DETAIL-EXTRACTS THRU 2599-WRT-DETAIL-X
 11443         MOVE SAVE-EXTRACT              TO DETAIL-EXTRACT
 11444         PERFORM EXTRACT-DATE-LOAD
 11445         MOVE 'R'                       TO DE-REIN
 11446         MOVE DETAIL-EXTRACT            TO SAVE-EXTRACT
 11447         MOVE +1                        TO SUB1
 11448         PERFORM 3210-REINSURE-CANCEL-LOOP
 11449             THRU 3219-REINSURE-CANCEL-LOOP-END.
 11450
 11451 1719-DO-R-C-EXTRACTS-X.
 11452     EXIT.
 11453
 11454 1720-CHECK-COMM-LEVELS.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 222
* ECS010MO.cbl
 11455
 11456     IF  DE-AGT (SUB13)       =  SPACES  AND
 11457         DE-AGT-TYPE (SUB13)  =  SPACES  AND
 11458         DE-L-PC (SUB13)      =  ZEROS   AND
 11459         DE-A-PC (SUB13)      =  ZEROS
 11460         MOVE '0000000000'        TO  DE-AGT (SUB13).
 11461
 11462 1729-CHECK-COMM-LEVELS-EXIT.
 11463     EXIT.
 11464
 11465 1800-MOVE-NEW-COMM-RATES.
 11466     MOVE WK-NEW-RATES                  TO CR-COMPENSATION-LEVELS.
 11467     MOVE 'N'                           TO RECALC-TYPE.
 11468     PERFORM 1710-DO-R-C-EXTRACTS THRU 1719-DO-R-C-EXTRACTS-X.
 11469     MOVE SAVE-WK-NEW-RATES             TO WK-NEW-RATES
 11470                                           CR-COMPENSATION-LEVELS.
 11471     IF DTE-CLIENT = 'DCC'
 11472        IF CR-LF-NSP-PRM NOT = ZEROS
 11473           COMPUTE CR-LF-NSP-PRM ROUNDED =
 11474              (CR-LFPRM + CR-LFPRM-ALT) -
 11475              ((CR-LFPRM + CR-LFPRM-ALT) * CR-LCOM-L (1))
 11476        END-IF
 11477        IF (CR-AH-NSP-PRM NOT = ZEROS)
 11478           AND (CLAS-I-BEN-CATEGORY (CLAS-INDEXA)
 11479                                        NOT = 'G' AND 'L')
 11480           COMPUTE CR-AH-NSP-PRM ROUNDED =
 11481           CR-AHPRM -
 11482           (CR-AHPRM * CR-LCOM-AH (1))
 11483        END-IF
 11484     END-IF
 11485     .
 11486
 11487 1899-RECALC-COMM-EXTR-X.
 11488     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 223
* ECS010MO.cbl
 11490******************************************************************
 11491***      I N I T I A L I Z E   D E T A I L   E X T R A C T     ***
 11492******************************************************************
 11493
 11494 2000-INITIALIZE-DETAIL-EXTRACT.
 11495
 11496     MOVE SPACES                   TO DETAIL-EXTRACT.
 11497
 11498     MOVE 'DE'                     TO DE-RECORD-ID.
 11499     MOVE CR-COMPANY-CD            TO DE-COMPANY-CD.
 11500     MOVE CR-FULL-CONTROL          TO DE-CONTROL.
 11501
 11502     MOVE AM-REPORT-CODE-1         TO DE-REPORT-CODE-1.
 11503     MOVE AM-REPORT-CODE-2         TO DE-REPORT-CODE-2.
 11504
 11505     MOVE CR-NAME                  TO DE-NAME.
 11506     MOVE CR-AGE                   TO DE-AGE.
 11507     MOVE CR-SEX                   TO DE-SEX.
 11508     MOVE CR-SOC-SEC               TO DE-SOC-SEC-NO.
 11509
 11510     MOVE CR-LFTYP                 TO DE-LF-TYPE.
 11511     MOVE CR-LF-TERM               TO DE-LF-TERM.
 11512     MOVE CR-LFAMT                 TO DE-LF-BEN.
 11513     MOVE ZEROS                    TO DE-LF-CNBEN.
 11514     MOVE CR-LFPRM                 TO DE-LF-PRM.
 11515     MOVE CR-LFAMT-ALT             TO DE-LF-BEN-ALT.
 11516     MOVE ZEROS                    TO DE-LF-CNBEN-ALT.
 11517     MOVE CR-LFPRM-ALT             TO DE-LF-PRM-ALT.
 11518     MOVE ZEROS                    TO DE-LF-RFND.
 11519
 11520     MOVE CR-LF-CURRENT-STATUS     TO DE-LF-STAT-CDE.
 11521     MOVE ZEROS                    TO DE-LF-CANC-DTE
 11522                                      DE-LF-CANC-EXIT-DT.
 11523
 11524     MOVE CR-AHTYP                 TO DE-AH-TYPE.
 11525     MOVE CR-AH-TERM               TO DE-AH-TERM.
 11526     MOVE CR-AHAMT                 TO DE-AH-BEN.
 11527     MOVE CR-AHPRM                 TO DE-AH-PRM.
 11528     MOVE ZEROS                    TO DE-AH-RFND.
 11529
 11530     MOVE CR-AH-CURRENT-STATUS     TO DE-AH-STAT-CDE.
 11531     MOVE ZEROS                    TO DE-AH-CANC-DTE
 11532                                      DE-AH-CANC-EXIT-DT.
 11533     MOVE CR-MOB-NET-TOT-FEES      TO DE-MOB-NET-TOT-FEES.
 11534
 11535     IF DTE-CLIENT = 'DCC'
 11536        MOVE CR-ADDL-CLP         TO DE-ADDL-CLP
 11537        MOVE CR-CLP-STATE        TO DE-CLP-STATE
 11538     ELSE
 11539        IF (CR-LFTYP NOT = ZERO   AND
 11540           CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'Z')  OR
 11541           (CR-AHTYP NOT = ZERO  AND
 11542           CLAS-I-CALC-TYPE (CLAS-INDEXA) = 'Z')
 11543           MOVE CR-LIVES           TO DE-LIVES
 11544           MOVE ZERO               TO DE-CANCEL-CNT-ITD
 11545                                      DE-CANCEL-CNT-YTD
 11546        END-IF
 11547     END-IF
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 224
* ECS010MO.cbl
 11548
 11549     MOVE CR-MEMBER-NO             TO DE-MEMBER-NO.
 11550     IF AM-ZIP-PRIME NUMERIC
 11551        MOVE AM-ZIP-PRIME          TO DE-ZIP
 11552      ELSE
 11553        MOVE ZEROS                 TO DE-ZIP.
 11554     MOVE CR-LOAN-OFFICER          TO DE-LN-OFFICER.
 11555
 11556     MOVE CR-APR                   TO DE-APR.
 11557     MOVE CR-PMT-FREQ              TO DE-PMT-FREQ.
 11558     MOVE CR-GRPTYP                TO DE-ACC-GPCD.
 11559     MOVE CR-IND-GRP               TO DE-IG.
 11560     MOVE AM-REMIT-TO              TO DE-REMIT-TO.
 11561     MOVE CR-MEMBER-NO             TO DE-MEMBER-NO.
 11562
 11563     MOVE CR-ENTRY-STATUS          TO DE-ENTRY-STATUS.
 11564     MOVE CR-ENTRY-DATE            TO DE-ENTRY-DTE.
 11565
 11566     MOVE CR-UNDERWRITING-CODE     TO DE-UNDERWRITING-CODE.
 11567     MOVE AM-POOL-PRIME            TO DE-NCL-POOL-CODE.
 11568
 11569     MOVE ZEROS                    TO DE-REI-LFAMT  DE-REI-LFPRM
 11570                                      DE-REI-AHAMT  DE-REI-AHPRM
 11571                                      DE-REI-LFRFND DE-REI-AHRFND
 11572                                      DE-REI-CNAMT.
 11573
 11574     MOVE +1                       TO SUB1.
 11575
 11576* THIS WAS ADDED SO I COULD PASS THE CLP TO ECS017
 11577* FOR DEALER DIRECT OTHERWISE THERE WAS NO WAY TO
 11578* CALC IT IN ECS017.
 11579     IF DTE-CLIENT = 'DCC'
 11580        IF CLAS-I-BEN-CATEGORY (CLAS-INDEXL) = 'D'
 11581           MOVE CR-LF-CLP          TO DE-REI-LFPRM
 11582           IF CR-ACCOUNT = '05500500DD'
 11583              DISPLAY ' LF CLP ' DE-CERT-NO ' ' DE-REI-LFPRM
 11584                ' ' DE-REI-LFRFND
 11585           END-IF
 11586        END-IF
 11587        IF CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'D'
 11588           MOVE CR-AH-CLP          TO DE-REI-AHPRM
 11589        END-IF
 11590     END-IF
 11591
 11592
 11593     PERFORM EXTRACT-DATE-LOAD.
 11594
 11595     MOVE ZEROS                    TO WS-DE-PROC-DT-N
 11596                                      WS-DE-INCUR-N
 11597                                      WS-DE-PAY-N
 11598                                      WS-DE-PAID-TO-N
 11599                                      WS-DE-ACC-EXP-DTE-N
 11600                                      WS-DE-ACC-EFF-DTE-N
 11601                                      WS-DE-RSV-INCUR-N
 11602                                      WS-DE-RSV-PAYTO-N
 11603                                      WS-DE-ACC-EXP-DTE-RSV-N
 11604                                      WS-DE-ACC-EFF-DTE-RSV-N.
 11605
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 225
* ECS010MO.cbl
 11606 2090-GL-CODE-LOOP.
 11607
 11608     MOVE AM-GL-CODES (SUB1)       TO DE-GL-CODES (SUB1).
 11609
 11610     IF SUB1 LESS THAN +10
 11611         ADD +1 TO SUB1
 11612         GO TO 2090-GL-CODE-LOOP.
 11613
 11614     MOVE AM-RECALC-COMM           TO DE-RECALC-CODE.
 11615
 11616     MOVE CR-COMPENSATION-LEVELS   TO DE-COMM-LEVELS.
 11617
 11618     IF (DTE-CLIENT = 'DCC')
 11619        AND (CR-AHTYP NOT = SPACES AND ZEROS)
 11620        AND (CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'G' OR 'L')
 11621        AND (RECALC-TYPE = SPACES)
 11622        MOVE +1                  TO IA
 11623*       IF CR-ACCOUNT = '05500500DD'
 11624**      IF CR-CERT-NO = '0008773536 '
 11625*          DISPLAY ' MADE IT TO 2000 '
 11626*          DISPLAY ' CERT AREA  REIN ' DE-REIN ' ' CR-CERT-NO
 11627*          PERFORM VARYING IB FROM +1 BY +1 UNTIL
 11628*             (IB > +10)
 11629*             IF CR-COM-AGT (IB) NOT = SPACES AND ZEROS
 11630*                MOVE IB TO DIL-BEN-CODE
 11631*                MOVE CR-LCOM-AH (IB) TO DIL-AMOUNT
 11632*                MOVE CR-COM-AGT (IB) TO DIL-COMMENT
 11633*                DISPLAY DISPLAY-IBNR-LINE
 11634*             END-IF
 11635*          END-PERFORM
 11636*          DISPLAY ' TRLR AREA  '
 11637*          DISPLAY ' CS CERT NO ' CS-CERT-NO
 11638*          PERFORM VARYING IB FROM +1 BY +1 UNTIL
 11639*             (IB > +10)
 11640*             IF WS-BNK-AGT (IB) NOT = SPACES AND ZEROS
 11641*                MOVE IB TO DIL-BEN-CODE
 11642*                MOVE WS-BNK-SPP-FEES (IB) TO DIL-AMOUNT
 11643*                MOVE WS-BNK-AGT (IB) TO DIL-COMMENT
 11644*                DISPLAY DISPLAY-IBNR-LINE
 11645*             END-IF
 11646*          END-PERFORM
 11647*       END-IF
 11648        PERFORM VARYING IB FROM +1 BY +1 UNTIL
 11649           IB > +10
 11650           IF DE-AGT (IB) NOT = SPACES AND ZEROS
 11651              CONTINUE
 11652           ELSE
 11653              IF WS-BNK-AGT (IA) NOT = SPACES AND ZEROS
 11654                 MOVE WS-BNK-AGT (IA)  TO DE-AGT (IB)
 11655                 MOVE WS-BNK-TYPE (IA) TO DE-AGT-TYPE (IB)
 11656                 COMPUTE DE-A-PC (IB) =
 11657                        WS-BNK-SPP-FEES (IA) / +1000
 11658                 MOVE +0              TO DE-L-PC (IB)
 11659                 ADD +1               TO IA
 11660              END-IF
 11661*             IF CS-AGT (IA) NOT = SPACES AND ZEROS
 11662*                MOVE CS-AGT (IA)     TO DE-AGT (IB)
 11663*                MOVE CS-COM-TYP (IA) TO DE-AGT-TYPE (IB)
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 226
* ECS010MO.cbl
 11664*                COMPUTE DE-A-PC (IB) = CS-SPP-FEES (IA) / +1000
 11665*                MOVE +0              TO DE-L-PC (IB)
 11666*                ADD +1               TO IA
 11667*             END-IF
 11668           END-IF
 11669        END-PERFORM
 11670     END-IF
 11671
 11672
 11673
 11674     .
 11675 2099-INIT-DTL-X.
 11676     EXIT.
 11677
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 227
* ECS010MO.cbl
 11679******************************************************************
 11680***            B U I L D   I S S U E   E X T R A C T           ***
 11681******************************************************************
 11682
 11683 2100-BUILD-ISSUE-EXTRACT.
 11684
 11685     PERFORM 2000-INITIALIZE-DETAIL-EXTRACT THRU 2099-INIT-DTL-X.
 11686
 11687     MOVE 'I'                      TO DE-TRANS.
 11688
 11689     IF CHECK-BILLED
 11690         MOVE 'N' TO BILLED-SWITCH
 11691     ELSE
 11692         GO TO 2190-WRITE-ISSUE-EXTRACT.
 11693
 11694     MOVE +1                        TO SUB1.
 11695 2150-GA-BILL-LOOP.
 11696
 11697     IF PB-GA-BILL-DT (SUB1) NOT = LOW-VALUES  AND  SPACES
 11698         MOVE 'B'                   TO DE-GA-BILL-STATUS (SUB1).
 11699
 11700     IF SUB1 LESS THAN +5
 11701         ADD +1 TO SUB1
 11702         GO TO 2150-GA-BILL-LOOP.
 11703
 11704     MOVE PB-RECORD-BILL            TO DE-BILL-SW.
 11705     MOVE ZEROS                     TO DE-BILLED-LFPRM
 11706                                       DE-BILLED-LFRFND
 11707                                       DE-BILLED-AHPRM
 11708                                       DE-BILLED-AHRFND.
 11709
 11710     IF PB-BILLED-DT = LOW-VALUES  OR  SPACES
 11711         IF PB-LF-BILLED-AMTS = ZERO  AND
 11712            PB-AH-BILLED-AMTS = ZERO
 11713             MOVE ' '                    TO DE-BILL-STATUS
 11714         ELSE
 11715             IF PB-LF-BILLED-AMTS = PB-I-LF-PREMIUM-AMT  AND
 11716                PB-AH-BILLED-AMTS = PB-I-AH-PREMIUM-AMT
 11717                 MOVE 'B'                TO DE-BILL-STATUS
 11718             ELSE
 11719                 MOVE 'R'                TO DE-BILL-STATUS
 11720                 MOVE PB-LF-BILLED-AMTS  TO DE-BILLED-LFPRM
 11721                 MOVE PB-AH-BILLED-AMTS  TO DE-BILLED-AHPRM
 11722     ELSE
 11723         MOVE 'B'                        TO DE-BILL-STATUS.
 11724
 11725 2190-WRITE-ISSUE-EXTRACT.
 11726
 11727     PERFORM 2500-WRITE-DETAIL-EXTRACTS THRU 2599-WRT-DETAIL-X.
 11728
 11729 2199-BLD-ISSUE-X.
 11730     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 228
* ECS010MO.cbl
 11732******************************************************************
 11733***           B U I L D   C A N C E L   E X T R A C T          ***
 11734******************************************************************
 11735
 11736 2200-BUILD-CANCEL-EXTRACT.
 11737
 11738     PERFORM 2000-INITIALIZE-DETAIL-EXTRACT THRU 2099-INIT-DTL-X.
 11739
 11740     MOVE 'C'                           TO DE-TRANS.
 11741
 11742     IF CR-LFTYP = ZERO
 11743         GO TO 2250-CONTINUE-CANCEL-BUILD.
 11744
 11745     IF CLAS-I-CALC-TYPE (CLAS-INDEXL) NOT = 'Z'
 11746         IF (CR-LF-STATUS-AT-CANCEL = ' ' OR '7')  AND
 11747             CR-LFRFND = +0
 11748              MOVE +0                   TO TEMP-5
 11749              GO TO 2250-CONTINUE-CANCEL-BUILD.
 11750
 11751     IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'Z'
 11752          IF CR-LFRFND = +0
 11753              GO TO 2250-CONTINUE-CANCEL-BUILD.
 11754
 11755     MOVE +1 TO TEMP-5.
 11756     MOVE CR-LF-TERM             TO ORIG-TERM.
 11757     MOVE CR-LF-CANC-DT          TO VALUATION-DT.
 11758     MOVE LIFE-OVERRIDE-L1       TO WE-LF-AH.
 11759     MOVE '1'                    TO W-VAL-SOURCE.
 11760     PERFORM 8500-REMAINING-TERM-ROUTINE THRU 8599-REM-TERM-X.
 11761
 11762     IF CLAS-I-RL-AH (CLAS-INDEXL) = 'L' OR 'P'
 11763         MOVE CR-LFAMT TO DE-LF-CNBEN
 11764         GO TO 2250-CONTINUE-CANCEL-BUILD.
 11765
 11766     IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'Z'
 11767         GO TO 2220-BLD-DE-CANCEL-SUM.
 11768
 11769     IF REM-TRM3 = CR-LF-TERM
 11770         MOVE CR-LFAMT TO DE-LF-CNBEN
 11771         GO TO 2250-CONTINUE-CANCEL-BUILD.
 11772
 11773     IF CLAS-I-EP (CLAS-INDEXL) = 'T'
 11774         GO TO 2210-BLD-DE-CANCEL-TEX.
 11775
 11776     IF DTE-CLIENT = 'NCL'
 11777         IF CR-DT LESS THAN 19910101
 11778             GO TO 2205-BLD-DE-CANCEL-BEN.
 11779
 11780     IF CLAS-I-EP (CLAS-INDEXL) = 'N'
 11781         GO TO 2230-BLD-DE-CANCEL-NP.
 11782
 11783     IF DTE-CLIENT = 'FUL'
 11784         GO TO 2240-BLD-DE-CANCEL-FUL.
 11785
 11786*    IF STATE-ABBR (CLAS-INDEXS) = 'OH'
 11787     IF (STATE-ABBR (CLAS-INDEXS) = 'OH') AND
 11788        (CR-RATING-CLASS NOT = 'L ')
 11789         IF (CR-APR GREATER THAN ZERO)  AND
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 229
* ECS010MO.cbl
 11790            (CR-LF-TERM GREATER THAN 060)  AND
 11791            (CR-DT GREATER THAN 19831031)
 11792              GO TO 2230-BLD-DE-CANCEL-NP.
 11793
 11794     IF STATE-ABBR (CLAS-INDEXS) = 'MT'
 11795         IF (CR-APR GREATER THAN ZERO)  AND
 11796            (CR-LF-TERM GREATER THAN 061)  AND
 11797            (CR-DT GREATER THAN 19830318)
 11798              GO TO 2230-BLD-DE-CANCEL-NP.
 11799
 11800     IF STATE-ABBR (CLAS-INDEXS) = 'UT'
 11801         IF (CR-APR GREATER THAN ZERO)  AND
 11802            (CR-LF-TERM GREATER THAN 062)  AND
 11803            (CR-DT GREATER THAN 19810831)  AND
 11804            (CR-DT LESS THAN 19830901)
 11805              GO TO 2230-BLD-DE-CANCEL-NP.
 11806
 11807     IF STATE-ABBR (CLAS-INDEXS) = 'RI'
 11808         IF (CR-APR GREATER THAN ZERO)  AND
 11809            (CR-LF-TERM GREATER THAN 060)  AND
 11810            (CR-DT GREATER THAN 19831231)
 11811              GO TO 2230-BLD-DE-CANCEL-NP.
 11812
 11813 2205-BLD-DE-CANCEL-BEN.
 11814
 11815     IF CR-LF-TERM EQUAL +0
 11816         MOVE +0          TO TEMP-5
 11817     ELSE
 11818         COMPUTE TEMP-5 = REM-TRM3 / CR-LF-TERM.
 11819
 11820     COMPUTE DE-LF-CNBEN = CR-LFAMT * TEMP-5.
 11821
 11822     GO TO 2250-CONTINUE-CANCEL-BUILD.
 11823
 11824 2210-BLD-DE-CANCEL-TEX.
 11825
 11826     DIVIDE CR-LFAMT BY CR-LF-TERM
 11827         GIVING TEX-FACT-1.
 11828     DIVIDE REM-TRM3 BY CR-PMT-FREQ
 11829         GIVING TEX-FACT-2
 11830             REMAINDER TEX-FACT-3.
 11831     IF TEX-FACT-3 NOT = ZERO
 11832         ADD +1 TO TEX-FACT-2.
 11833     COMPUTE DE-LF-CNBEN =
 11834         (TEX-FACT-1 * (TEX-FACT-2 * CR-PMT-FREQ)).
 11835
 11836     IF CR-LFAMT EQUAL +0
 11837         MOVE +0                  TO TEMP-5
 11838     ELSE
 11839         COMPUTE TEMP-5 = DE-LF-CNBEN / CR-LFAMT.
 11840
 11841     GO TO 2250-CONTINUE-CANCEL-BUILD.
 11842
 11843 2220-BLD-DE-CANCEL-SUM.
 11844
 11845     MOVE CR-SUM-CAN-CNT-YTD      TO DE-CANCEL-CNT-YTD.
 11846     MOVE CR-SUM-CAN-CNT-ITD      TO DE-CANCEL-CNT-ITD.
 11847
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 230
* ECS010MO.cbl
 11848     IF CR-LFRFND NOT LESS CR-LFPRM
 11849         MOVE CR-LFAMT           TO DE-LF-CNBEN
 11850          GO TO 2250-CONTINUE-CANCEL-BUILD.
 11851
 11852     COMPUTE TEMP-6 ROUNDED = CR-LFRFND / CR-LFPRM.
 11853     COMPUTE TEMP-7 ROUNDED = TEMP-6 * CR-LFAMT.
 11854     IF CLAS-I-RL-AH (CLAS-INDEXL) = 'L' OR 'P'
 11855         MOVE TEMP-7             TO DE-LF-CNBEN
 11856       ELSE
 11857         COMPUTE TEMP-5 = REM-TRM3 / CR-LF-TERM
 11858         COMPUTE DE-LF-CNBEN = TEMP-7 * TEMP-5.
 11859
 11860     IF CR-LFAMT EQUAL +0
 11861         MOVE +0                  TO TEMP-5
 11862     ELSE
 11863         COMPUTE TEMP-5 ROUNDED =  DE-LF-CNBEN / CR-LFAMT.
 11864
 11865     IF CLAS-I-EP (CLAS-INDEXL) NOT = 'N'
 11866         GO TO 2250-CONTINUE-CANCEL-BUILD.
 11867
 11868 2230-BLD-DE-CANCEL-NP.
 11869
 11870     MOVE CR-DT                      TO  DC-GREG-DATE-CYMD.
 11871     MOVE 'L'                        TO  DC-OPTION-CODE.
 11872     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 11873     MOVE DC-BIN-DATE-1              TO  CP-CERT-EFF-DT.
 11874
 11875     IF CR-LOAN-1ST-PMT-DT NOT = ZEROS
 11876       MOVE CR-LOAN-1ST-PMT-DT       TO  DC-GREG-DATE-1-YMD
 11877       MOVE '3'                      TO  DC-OPTION-CODE
 11878       PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X
 11879       MOVE DC-BIN-DATE-1            TO  CP-FIRST-PAY-DATE
 11880     ELSE
 11881       MOVE CP-CERT-EFF-DT           TO  DC-BIN-DATE-1
 11882       MOVE '6'                      TO  DC-OPTION-CODE
 11883       MOVE +1                       TO  DC-ELAPSED-MONTHS
 11884       MOVE +0                       TO  DC-ELAPSED-DAYS
 11885       PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X
 11886       MOVE DC-BIN-DATE-2            TO  CP-FIRST-PAY-DATE.
 11887
 11888     MOVE CR-RATING-CLASS            TO  CP-CLASS-CODE
 11889     MOVE CR-LFAMT                   TO  CP-ORIGINAL-BENEFIT.
 11890     MOVE CR-APR                     TO  CP-LOAN-APR.
 11891     MOVE CR-LF-TERM                 TO  CP-ORIGINAL-TERM.
 11892     MOVE CR-LOAN-TERM               TO  CP-LOAN-TERM.
 11893     MOVE REM-TRM3                   TO  CP-REMAINING-TERM.
 11894     MOVE CLAS-I-CALC-TYPE (CLAS-INDEXL) TO  CP-SPECIAL-CALC-CD.
 11895     MOVE CLAS-I-RL-AH     (CLAS-INDEXL) TO  CP-BENEFIT-TYPE.
 11896     MOVE CLAS-I-EP        (CLAS-INDEXL) TO  CP-EARNING-METHOD.
 11897
 11898     CALL 'ELRAMTX' USING CALCULATION-PASS-AREA.
 11899
 11900     IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'Z'
 11901         COMPUTE DE-LF-CNBEN =
 11902                 CP-REMAMT-FACTOR * (TEMP-7 / +1000)
 11903      ELSE
 11904          COMPUTE DE-LF-CNBEN ROUNDED =
 11905                  CP-REMAMT-FACTOR * (CR-LFAMT / +1000).
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 231
* ECS010MO.cbl
 11906
 11907     IF CR-LFAMT EQUAL +0
 11908         MOVE +0                  TO TEMP-5
 11909     ELSE
 11910         COMPUTE TEMP-5 = DE-LF-CNBEN / CR-LFAMT.
 11911
 11912     GO TO 2250-CONTINUE-CANCEL-BUILD.
 11913
 11914 2240-BLD-DE-CANCEL-FUL.
 11915
 11916     MOVE CR-APR                  TO NP-APR.
 11917     MOVE CR-LF-TERM              TO NP-ORIG.
 11918     MOVE REM-TRM3                TO NP-REM.
 11919     MOVE '2'                     TO NP-OPT.
 11920     MOVE CR-AHPRM                TO NP-AHPRM.
 11921     MOVE CR-ACCOUNT              TO NP-ACCOUNT.
 11922     MOVE CR-LFAMT                TO NP-BENEFIT.
 11923
 11924*    CALL 'FULNETRM'
 11925*        USING NP-APR NP-ORIG NP-REM NP-OPT NP-BENEFIT NP-AHPRM
 11926*              NP-ACCOUNT NP-REMAINING.
 11927
 11928     MOVE NP-REMAINING            TO DE-LF-CNBEN.
 11929
 11930     IF CR-LFAMT EQUAL +0
 11931         MOVE +0                  TO TEMP-5
 11932     ELSE
 11933         COMPUTE TEMP-5 = DE-LF-CNBEN / CR-LFAMT.
 11934
 11935 2250-CONTINUE-CANCEL-BUILD.
 11936
 11937     MOVE CR-LFRFND                   TO DE-LF-RFND.
 11938     MOVE CR-LF-STATUS-AT-CANCEL      TO DE-LF-PREV-STAT.
 11939     MOVE CR-LF-CANC-DT               TO DE-LF-CANC-DTE
 11940                                         WS-DE-LF-CANC-DTE-N.
 11941     MOVE CR-LF-CANCEL-EXIT-DATE      TO DE-LF-CANC-EXIT-DT
 11942                                         WS-DE-LF-CANC-EXIT-DT-N.
 11943     MOVE CR-LF-COMM-CHARGEBACK       TO DE-LF-COMM-CHARGEBACK.
 11944
 11945     MOVE CR-AHRFND                   TO DE-AH-RFND.
 11946
 11947     IF DTE-CLIENT = 'DCC'
 11948        IF DE-AH-RFND = ZEROS
 11949           MOVE ZEROS                 TO DE-ADDL-CLP
 11950        END-IF
 11951     END-IF
 11952
 11953     MOVE CR-AH-STATUS-AT-CANCEL      TO DE-AH-PREV-STAT.
 11954     MOVE CR-AH-CANC-DT               TO DE-AH-CANC-DTE
 11955                                         WS-DE-AH-CANC-DTE-N.
 11956     MOVE CR-AH-CANCEL-EXIT-DATE      TO DE-AH-CANC-EXIT-DT
 11957                                         WS-DE-AH-CANC-EXIT-DT-N.
 11958     MOVE CR-AH-COMM-CHARGEBACK       TO DE-AH-COMM-CHARGEBACK.
 11959
 11960     IF PB-LAST-MAINT-BY = 'E570'
 11961         MOVE 'R'                     TO DE-AUTO-GEND-IND.
 11962
 11963     IF CHECK-BILLED
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 232
* ECS010MO.cbl
 11964         MOVE 'N' TO BILLED-SWITCH
 11965     ELSE
 11966         GO TO 2259-END-CANCEL-BUILD.
 11967
 11968     MOVE +1                        TO SUB1.
 11969 2255-GA-BILL-LOOP.
 11970
 11971     IF PB-GA-BILL-DT (SUB1) NOT = LOW-VALUES  AND  SPACES
 11972         MOVE 'B'                   TO DE-GA-BILL-STATUS (SUB1).
 11973
 11974     IF SUB1 LESS THAN +5
 11975         ADD +1 TO SUB1
 11976         GO TO 2255-GA-BILL-LOOP.
 11977
 11978     MOVE PB-RECORD-BILL            TO DE-BILL-SW.
 11979     MOVE PB-C-REFUND-SW            TO DE-REFUND-SW.
 11980     MOVE ZEROS                     TO DE-BILLED-LFPRM
 11981                                       DE-BILLED-LFRFND
 11982                                       DE-BILLED-AHPRM
 11983                                       DE-BILLED-AHRFND.
 11984
 11985     IF PB-BILLED-DT = LOW-VALUES  OR  SPACES
 11986         IF PB-LF-BILLED-AMTS = ZERO  AND
 11987            PB-AH-BILLED-AMTS = ZERO
 11988             MOVE ' '                    TO DE-BILL-STATUS
 11989         ELSE
 11990             IF PB-LF-BILLED-AMTS = PB-C-LF-CANCEL-AMT  AND
 11991                PB-AH-BILLED-AMTS = PB-C-AH-CANCEL-AMT
 11992                 MOVE 'B'                TO DE-BILL-STATUS
 11993             ELSE
 11994                 MOVE 'R'                TO DE-BILL-STATUS
 11995                 MOVE PB-LF-BILLED-AMTS  TO DE-BILLED-LFRFND
 11996                 MOVE PB-AH-BILLED-AMTS  TO DE-BILLED-AHRFND
 11997     ELSE
 11998         MOVE 'B'                        TO DE-BILL-STATUS.
 11999
 12000 2259-END-CANCEL-BUILD.
 12001     EXIT.
 12002
 12003 2290-WRITE-CANCEL-EXTRACT.
 12004
 12005     PERFORM 2500-WRITE-DETAIL-EXTRACTS THRU 2599-WRT-DETAIL-X.
 12006
 12007 2299-BLD-CANCEL-X.
 12008     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 233
* ECS010MO.cbl
 12010******************************************************************
 12011***            B U I L D   C L A I M   E X T R A C T           ***
 12012******************************************************************
 12013
 12014 2300-BUILD-CLAIM-EXTRACT.
 12015
 12016     PERFORM 2000-INITIALIZE-DETAIL-EXTRACT THRU 2099-INIT-DTL-X.
 12017
 12018     MOVE 'X'                       TO DE-TRANS.
 12019
 12020     MOVE PC-CLAIM-TYPE             TO DE-TYPE.
 12021
 12022     MOVE PC-CLAIM-PAYMENT          TO DE-CLAIM-AMT.
 12023     MOVE ZEROS                     TO DE-REI-CLAIM-AMT.
 12024
 12025     MOVE INCURRED-DATE             TO DE-INCUR
 12026                                       WS-DE-INCUR-N.
 12027     MOVE REPORTED-DATE             TO DE-REPORTED.
 12028     MOVE PAYMENT-DATE              TO DE-PAY
 12029                                       WS-DE-PAY-N.
 12030     MOVE PAY-TO-DATE               TO DE-PAID-TO
 12031                                       WS-DE-PAID-TO-N.
 12032
 12033     MOVE PC-CLAIM-NO               TO DE-CNUM.
 12034     MOVE PC-CHECK-NO               TO DE-CHECK.
 12035     MOVE PC-TRLR-SEQ-NO            TO DE-PMT-TRAILER-SEQ.
 12036     MOVE PC-NO-OF-DAYS-PAID        TO DE-DAYS-DISAB.
 12037     MOVE PC-AGE-AT-CLAIM           TO DE-CLM-AGE.
 12038     MOVE PC-PAYMENT-TYPE           TO DE-PAY-CODE.
 12039     INSPECT DE-PAY-CODE
 12040         CONVERTING '1234569' TO 'PFSXEEV'.
 12041
 12042     MOVE AM-NAME                   TO DE-ACC-NAME.
 12043     MOVE AM-EXPIRE-DT              TO DE-ACC-EXP-DTE
 12044                                       WS-DE-ACC-EXP-DTE-N.
 12045     MOVE AM-EFFECT-DT              TO DE-ACC-EFF-DTE
 12046                                       WS-DE-ACC-EFF-DTE-N.
 12047     MOVE PC-CAUSE-CODE             TO DE-CLM-CAUSE.
 12048     MOVE CR-LOAN-OFFICER           TO DE-LOAN-OFFICER.
 12049
 12050     IF DE-DTH  OR  DE-OB-DTH
 12051         MOVE CR-LF-STATUS-AT-DEATH TO DE-LF-PREV-STAT
 12052     ELSE
 12053         IF CR-AH-LUMP-SUM-DISAB
 12054             MOVE CR-AH-STATUS-AT-SETTLEMENT
 12055                                    TO DE-AH-PREV-STAT.
 12056
 12057     IF PC-LAST-MAINT-BY EQUAL 'E570'
 12058         MOVE 'R'                     TO DE-AUTO-GEND-IND.
 12059
 12060 2390-WRITE-CLAIM-EXTRACT.
 12061
 12062     PERFORM 2500-WRITE-DETAIL-EXTRACTS THRU 2599-WRT-DETAIL-X.
 12063
 12064 2399-BLD-CLAIM-X.
 12065     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 234
* ECS010MO.cbl
 12067******************************************************************
 12068***          B U I L D   R E S E R V E   E X T R A C T         ***
 12069******************************************************************
 12070
 12071 2400-BUILD-RESERVE-EXTRACT.
 12072
 12073     PERFORM 2000-INITIALIZE-DETAIL-EXTRACT THRU 2099-INIT-DTL-X.
 12074
 12075     MOVE 'Y'                         TO DE-TRANS.
 12076     MOVE PC-CLAIM-TYPE               TO DE-RESERVE-TYPE.
 12077
 12078     MOVE PC-IBNR-RESERVE-AMT         TO DE-IBNR.
 12079     MOVE PC-PTC-RESERVE-AMT          TO DE-PAYCUR.
 12080     MOVE PC-FUTURE-RESERVE-AMT       TO DE-FUTRSV.
 12081     ADD  PC-MANUAL-RESERVE-AMT       TO DE-FUTRSV.
 12082
 12083     IF DTE-CLIENT  =  'NCL'
 12084        IF PC-MANUAL-RESERVE-AMT  GREATER THAN   ZEROS
 12085            MOVE 'Y'                  TO DE-MANUAL-RSV-SWITCH.
 12086
 12087     MOVE PC-CLAIM-NO                 TO DE-CLMNO.
 12088
 12089     MOVE AM-EXPIRE-DT                TO DE-ACC-EXP-DTE-RSV
 12090                                         WS-DE-ACC-EXP-DTE-RSV-N.
 12091
 12092     MOVE AM-EFFECT-DT                TO DE-ACC-EFF-DTE-RSV
 12093                                         WS-DE-ACC-EFF-DTE-RSV-N.
 12094
 12095     MOVE INCURRED-DATE               TO DE-RSV-INCUR
 12096                                         WS-DE-RSV-INCUR-N.
 12097     MOVE REPORTED-DATE               TO DE-RSV-REPORTED.
 12098     MOVE PAY-TO-DATE                 TO DE-RSV-PAYTO
 12099                                         WS-DE-RSV-PAYTO-N.
 12100
 12101     MOVE ZEROS                       TO DE-REI-IBNR
 12102                                         DE-REI-PAYCUR
 12103                                         DE-REI-FUTRSV.
 12104
 12105     MOVE AM-NAME                     TO DE-RSV-ACC-NAME.
 12106
 12107     IF PC-LAST-MAINT-BY EQUAL 'E570'
 12108         MOVE 'R'                     TO DE-AUTO-GEND-IND.
 12109
 12110 2490-WRITE-RESERVE-EXTRACT.
 12111
 12112     PERFORM 2500-WRITE-DETAIL-EXTRACTS THRU 2599-WRT-DETAIL-X.
 12113
 12114 2499-BLD-RESERVE-X.
 12115     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 235
* ECS010MO.cbl
 12117******************************************************************
 12118***          W R I T E   D E T A I L   E X T R A C T S         ***
 12119******************************************************************
 12120
 12121 2500-WRITE-DETAIL-EXTRACTS.
 12122
 12123
 12124     MOVE  ZEROS            TO  SUB.
 12125
 12126     IF  NOT  DE-CANCEL  AND   NOT  DE-RC-CANCEL
 12127         GO TO 2520-WRITE-CONTINUE.
 12128
 12129 2510-ZERO-CHARGEBACK-LOOP.
 12130
 12131     ADD  +1                TO  SUB.
 12132
 12133     IF  SUB    GREATER  THAN     +10
 12134         GO TO  2520-WRITE-CONTINUE.
 12135
 12136*    DISPLAY ' CERT NO ' CR-CERT-NO
 12137*    DISPLAY ' REFUND TYPE ' CR-AH-REFUND-TYPE
 12138*    DISPLAY '  SUB  ' SUB '   ' WS-AH-CHARGEBACK-SW (SUB)
 12139
 12140
 12141     IF  WS-LF-CHARGEBACK-SW (SUB)  = 'N'
 12142         MOVE  ZEROS            TO  DE-L-PC (SUB).
 12143
 12144     IF  (WS-AH-CHARGEBACK-SW (SUB)  = 'N')
 12145                   OR
 12146         ((CR-AH-REFUND-TYPE = 'G')
 12147         AND (CR-AHRFND = ZEROS))
 12148         MOVE  ZEROS             TO DE-A-PC (SUB)
 12149     END-IF
 12150
 12151     GO TO 2510-ZERO-CHARGEBACK-LOOP.
 12152
 12153 2520-WRITE-CONTINUE.
 12154
 12155     IF DTE-CLIENT NOT = 'HER'
 12156         GO TO 2590-WRITE-EXTRACTS.
 12157
 12158     IF DE-REINCO NOT = 'LNL'
 12159         GO TO 2590-WRITE-EXTRACTS.
 12160
 12161     IF DE-CLAIM  OR  DE-RESERVE  OR  DE-RR-RC-CLM
 12162         GO TO 2590-WRITE-EXTRACTS.
 12163
 12164     IF DE-AGT-TYPE (1)  = 'D'   MOVE 'C'    TO DE-AGT-TYPE (1).
 12165     IF DE-AGT-TYPE (2)  = 'P'   MOVE 'O'    TO DE-AGT-TYPE (2).
 12166     IF DE-AGT-TYPE (3)  = 'P'   MOVE 'O'    TO DE-AGT-TYPE (3).
 12167     IF DE-AGT-TYPE (4)  = 'P'   MOVE 'O'    TO DE-AGT-TYPE (4).
 12168     IF DE-AGT-TYPE (5)  = 'P'   MOVE 'O'    TO DE-AGT-TYPE (5).
 12169     IF DE-AGT-TYPE (6)  = 'P'   MOVE 'O'    TO DE-AGT-TYPE (6).
 12170     IF DE-AGT-TYPE (7)  = 'P'   MOVE 'O'    TO DE-AGT-TYPE (7).
 12171     IF DE-AGT-TYPE (8)  = 'P'   MOVE 'O'    TO DE-AGT-TYPE (8).
 12172     IF DE-AGT-TYPE (9)  = 'P'   MOVE 'O'    TO DE-AGT-TYPE (9).
 12173     IF DE-AGT-TYPE (10) = 'P'   MOVE 'O'    TO DE-AGT-TYPE (10).
 12174
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 236
* ECS010MO.cbl
 12175     IF DE-AGT-TYPE (1)  = 'S'   MOVE 'F'    TO DE-AGT-TYPE (1).
 12176     IF DE-AGT-TYPE (2)  = 'B'   MOVE 'G'    TO DE-AGT-TYPE (2).
 12177     IF DE-AGT-TYPE (3)  = 'B'   MOVE 'G'    TO DE-AGT-TYPE (3).
 12178     IF DE-AGT-TYPE (4)  = 'B'   MOVE 'G'    TO DE-AGT-TYPE (4).
 12179     IF DE-AGT-TYPE (5)  = 'B'   MOVE 'G'    TO DE-AGT-TYPE (5).
 12180     IF DE-AGT-TYPE (6)  = 'B'   MOVE 'G'    TO DE-AGT-TYPE (6).
 12181     IF DE-AGT-TYPE (7)  = 'B'   MOVE 'G'    TO DE-AGT-TYPE (7).
 12182     IF DE-AGT-TYPE (8)  = 'B'   MOVE 'G'    TO DE-AGT-TYPE (8).
 12183     IF DE-AGT-TYPE (9)  = 'B'   MOVE 'G'    TO DE-AGT-TYPE (9).
 12184     IF DE-AGT-TYPE (10) = 'B'   MOVE 'G'    TO DE-AGT-TYPE (10).
 12185
 12186
 12187 2590-WRITE-EXTRACTS.
 12188
 12189     MOVE EOM-RUN-DATE            TO DE-PROC-DT
 12190                                     WS-DE-PROC-DT-N.
 12191
 12192     IF DTE-PGM-OPT = '1'
 12193         ADD +1                   TO DE-CNT
 12194*********PERFORM EXTRACT-DATE-RELOAD
 12195         WRITE DETAIL-EXTRACT.
 12196
 12197
 12198 2599-WRT-DETAIL-X.
 12199     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 237
* ECS010MO.cbl
 12201******************************************************************
 12202***         R E I N S U R A N C E   P R O C E S S I N G        ***
 12203******************************************************************
 12204
 12205 3000-REINSURE-ROUTINE.
 12206
 12207     IF (CR-POLICY-IS-DECLINED) OR
 12208        (CR-POLICY-IS-VOID)
 12209        GO TO 3099-REINSURE-ROUTINE-X.
 12210
 12211     IF REIN-FLG = 'X'
 12212         GO TO 3099-REINSURE-ROUTINE-X.
 12213
 12214     MOVE 'X' TO REIN-FLG.
 12215
 12216     PERFORM CLEAR-REIN-HOLD THRU CLEAR-REIN-HOLD-X.
 12217
 12218     IF CR-REIN-TABLE = SPACES OR ZEROS
 12219         GO TO 3030-RE-CALCULATE-REINSURANCE.
 12220
 12221******************************************************************
 12222***    R E A D   R E I N S U R A N C E   T A B L E   F I L E   ***
 12223******************************************************************
 12224
 12225 3010-RR-READ-REIN.
 12226
 12227     IF REIN-OPEN-SW = ' '
 12228         MOVE 'X'                       TO REIN-OPEN-SW
 12229         MOVE DTE-CLASIC-COMPANY-CD     TO REIN-SRCH-COMP-CD
 12230         MOVE 'A'                       TO REIN-SRCH-CODE
 12231         OPEN INPUT ERRTBL-IN
 12232         IF ERRTBL-FILE-STATUS = '00'  OR  '97'
 12233             PERFORM REIN-CO-TABLE-BUILD THRU REIN-BUILD-EXIT
 12234          ELSE
 12235             MOVE '21'                  TO ABEND-CODE-1
 12236             MOVE ERRTBL-FILE-STATUS    TO ABEND-CODE-2
 12237             DISPLAY '******************************'
 12238             DISPLAY '***** ERROR LOCATION 015 *****'
 12239             DISPLAY '******************************'
 12240             MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
 12241             GO TO ABEND-PGM.
 12242
 12243     IF CR-REIN-TABLE = REIN-SRCH
 12244         GO TO 3019-RR-READ-REIN-X.
 12245
 12246     MOVE +0                            TO REIN-SUB-1.
 12247     MOVE 999999                        TO REIN-LOW-TIME.
 12248     MOVE CR-REIN-TABLE                 TO REIN-SRCH.
 12249
 12250 3011-RR-CHECK-REIN-SAVE-TABLE.
 12251
 12252     ADD +1                             TO REIN-SUB-1.
 12253     IF REIN-SUB-1 GREATER THAN REIN-MAX  OR
 12254        REIN-SUB-1 GREATER THAN REIN-SUB-2
 12255         GO TO 3015-RR-READ-ERRTBL.
 12256
 12257     IF REIN-SEARCH = SR-CONTROL (REIN-SUB-1)
 12258         MOVE SR-ENTRY (REIN-SUB-1)     TO REINSURANCE-RECORD
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 238
* ECS010MO.cbl
 12259         ACCEPT WS-TIME-OF-DAY   FROM TIME
 12260         MOVE WS-TIME                   TO SR-TIME (REIN-SUB-1)
 12261         GO TO 3019-RR-READ-REIN-X.
 12262
 12263     IF SR-TIME (REIN-SUB-1) LESS THAN REIN-LOW-TIME
 12264         MOVE SR-TIME (REIN-SUB-1)      TO REIN-LOW-TIME
 12265         MOVE REIN-SUB-1                TO REIN-LOW-SUB.
 12266
 12267     GO TO 3011-RR-CHECK-REIN-SAVE-TABLE.
 12268
 12269 3015-RR-READ-ERRTBL.
 12270
 12271     MOVE REIN-SEARCH                   TO RE-CONTROL-PRIMARY.
 12272
 12273     READ ERRTBL-IN.
 12274
 12275     IF ERRTBL-FILE-STATUS  = '23'
 12276         DISPLAY 'INVALID REINSURANCE TABLE CODE - ' REIN-SRCH
 12277                                           ' ' CR-FULL-CONTROL
 12278         MOVE '24'                      TO ABEND-CODE-1
 12279         MOVE ERRTBL-FILE-STATUS        TO ABEND-CODE-2
 12280         DISPLAY '******************************'
 12281         DISPLAY '***** ERROR LOCATION 016 *****'
 12282         DISPLAY '******************************'
 12283         MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
 12284         GO TO ABEND-PGM.
 12285
 12286     IF ERRTBL-FILE-STATUS  = '00'  OR  '97'
 12287         NEXT SENTENCE
 12288       ELSE
 12289         MOVE '24'                      TO ABEND-CODE-1
 12290         MOVE ERRTBL-FILE-STATUS        TO ABEND-CODE-2
 12291         DISPLAY '******************************'
 12292         DISPLAY '***** ERROR LOCATION 017 *****'
 12293         DISPLAY '******************************'
 12294         MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
 12295         GO TO ABEND-PGM.
 12296
 12297     ADD +1                            TO ERRTBL-READS.
 12298
 12299     IF REIN-SUB-1 GREATER THAN REIN-MAX
 12300         MOVE REINSURANCE-RECORD       TO SR-ENTRY (REIN-LOW-SUB)
 12301         ACCEPT WS-TIME-OF-DAY   FROM TIME
 12302         MOVE WS-TIME                  TO SR-TIME (REIN-LOW-SUB)
 12303     ELSE
 12304         MOVE REINSURANCE-RECORD       TO SR-ENTRY (REIN-SUB-1)
 12305         ACCEPT WS-TIME-OF-DAY   FROM TIME
 12306         MOVE WS-TIME                  TO SR-TIME (REIN-SUB-1)
 12307         MOVE REIN-SUB-1               TO REIN-SUB-2.
 12308
 12309 3019-RR-READ-REIN-X.
 12310     EXIT.
 12311
 12312 3020-CALCULATE-REINSURANCE.
 12313
 12314*    IF DTE-CLIENT = '???'  AND
 12315*       (CR-REIN-TABLE = 'SE1')
 12316*        PERFORM 3640-NSP-REIN-RATING-ROUTINE THRU 3669-NSP-REIN-X
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 239
* ECS010MO.cbl
 12317*        IF CR-STATE NOT = STATE-L
 12318*            MOVE CR-STATE             TO STATE-L
 12319*            PERFORM 8200-STATE-CODE-LOOKUP
 12320*                         THRU 8299-STATE-LOOKUP-X.
 12321
 12322
 12323*    IF DTE-CLIENT = 'DCC'
 12324*       IF CR-LF-NSP-PRM NOT = ZEROS
 12325*          COMPUTE CR-LF-NSP-PRM ROUNDED =
 12326*             (CR-LFPRM + CR-LFPRM-ALT) -
 12327*             ((CR-LFPRM + CR-LFPRM-ALT) * CR-LCOM-L (1))
 12328*       END-IF
 12329*       IF CR-AH-NSP-PRM NOT = ZEROS
 12330*          COMPUTE CR-AH-NSP-PRM ROUNDED =
 12331*          CR-AHPRM -
 12332*          (CR-AHPRM * CR-LCOM-AH (1))
 12333*       END-IF
 12334*    END-IF
 12335
 12336
 12337     IF RE-REMAINING (1) = 'I'
 12338         MOVE '*'                      TO RISK-REIN-FLAG
 12339     ELSE
 12340         GO TO 3029-CONTINUE-REIN-CALC.
 12341
 12342     MOVE SPACE                        TO REIN-CANCEL-LF-SW
 12343                                          REIN-CANCEL-AH-SW.
 12344     MOVE ZEROS                        TO REIN-EARN-LF-TERM
 12345                                          REIN-LCNC-EARN-TERM
 12346                                          REIN-LF-CLM-MONTHS
 12347                                          REIN-EARN-AH-TERM
 12348                                          REIN-ACNC-EARN-TERM
 12349                                          REIN-AH-PRIOR-CLMS-PAID
 12350                                          REIN-AH-CLM-MONTHS
 12351                                          REIN-AH-CLM-MTH-1
 12352                                          REIN-AH-CLM-MTH-2
 12353                                          REIN-AH-CLM-MTH-3
 12354                                          REIN-AH-CLM-MTH-4
 12355                                          REIN-AH-CLM-MTH-5.
 12356
 12357*    MOVE CR-DT                        TO DC-GREG-DATE-CYMD.
 12358*    MOVE 'L'                          TO DC-OPTION-CODE.
 12359*    PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 12360*    MOVE DC-BIN-DATE-1                TO WS-CR-BIN-DATE.
 12361
 12362     IF CR-LFTYP = ZEROS  OR  SPACES
 12363         GO TO 3023-CONTINUE.
 12364
 12365     MOVE EOM-RUN-DATE                 TO VALUATION-DT.
 12366
 12367     IF CR-LF-CANCEL-EXIT-DATE NOT = ZEROS
 12368       IF CR-LF-CANCEL-EXIT-DATE LESS THAN VALUATION-DT
 12369           MOVE CR-LF-CANCEL-EXIT-DATE TO VALUATION-DT.
 12370
 12371     IF CR-LF-CLAIM-EXIT-DATE NOT = ZEROS
 12372       IF CR-LF-CLAIM-EXIT-DATE LESS THAN VALUATION-DT
 12373           MOVE CR-LF-CLAIM-EXIT-DATE  TO VALUATION-DT.
 12374
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 240
* ECS010MO.cbl
 12375     MOVE VALUATION-DT                 TO DC-GREG-DATE-CYMD.
 12376     PERFORM 3025-CALC-ELAPSED-MONTHS THRU 3026-CALC-EXIT.
 12377
 12378     IF DC-ELAPSED-MONTHS GREATER THAN CR-LF-TERM
 12379         MOVE CR-LF-TERM               TO MONTHS-DIFF-LF
 12380     ELSE
 12381         MOVE DC-ELAPSED-MONTHS        TO MONTHS-DIFF-LF.
 12382
 12383     IF CR-LF-CANC-DT NOT = ZEROS
 12384         MOVE CR-LF-CANC-DT            TO DC-GREG-DATE-CYMD
 12385         PERFORM 3025-CALC-ELAPSED-MONTHS THRU 3026-CALC-EXIT
 12386         MOVE DC-ELAPSED-MONTHS        TO REIN-LCNC-EARN-TERM
 12387         IF CR-DT = CR-LF-CANC-DT
 12388             MOVE '*'                  TO REIN-CANCEL-LF-SW.
 12389
 12390     IF CR-DTH-DT NOT = ZEROS
 12391         MOVE CR-DTH-DT                TO DC-GREG-DATE-CYMD
 12392         PERFORM 3025-CALC-ELAPSED-MONTHS THRU 3026-CALC-EXIT
 12393         MOVE DC-ELAPSED-MONTHS        TO REIN-LF-CLM-MONTHS.
 12394
 12395     MOVE MONTHS-DIFF-LF               TO REIN-EARN-LF-TERM.
 12396
 12397
 12398 3023-CONTINUE.
 12399
 12400     IF CR-AHTYP = ZEROS  OR  SPACES
 12401        GO TO 3029-CONTINUE-REIN-CALC.
 12402
 12403     MOVE EOM-RUN-DATE                 TO VALUATION-DT.
 12404
 12405     IF CR-AH-CANCEL-EXIT-DATE NOT = ZEROS
 12406       IF CR-AH-CANCEL-EXIT-DATE LESS THAN VALUATION-DT
 12407           MOVE CR-AH-CANCEL-EXIT-DATE TO VALUATION-DT.
 12408
 12409     IF CR-AH-SETTLEMENT-EXIT-DATE NOT = ZEROS
 12410       IF CR-AH-SETTLEMENT-EXIT-DATE LESS THAN VALUATION-DT
 12411           MOVE CR-AH-SETTLEMENT-EXIT-DATE TO VALUATION-DT.
 12412
 12413     MOVE VALUATION-DT                 TO DC-GREG-DATE-CYMD.
 12414     PERFORM 3025-CALC-ELAPSED-MONTHS THRU 3026-CALC-EXIT.
 12415
 12416     IF DC-ELAPSED-MONTHS GREATER THAN CR-AH-TERM
 12417         MOVE CR-AH-TERM               TO MONTHS-DIFF-AH
 12418     ELSE
 12419         MOVE DC-ELAPSED-MONTHS        TO MONTHS-DIFF-AH.
 12420
 12421     IF CR-AH-CANC-DT NOT = ZEROS
 12422         MOVE CR-AH-CANC-DT           TO DC-GREG-DATE-CYMD
 12423         PERFORM 3025-CALC-ELAPSED-MONTHS THRU 3026-CALC-EXIT
 12424         MOVE DC-ELAPSED-MONTHS        TO REIN-ACNC-EARN-TERM
 12425         IF CR-DT = CR-AH-CANC-DT
 12426             MOVE '*'                  TO REIN-CANCEL-AH-SW.
 12427
 12428     IF CR-DIS-INCUR-DT (1) NOT = ZEROS
 12429         MOVE CR-DIS-INCUR-DT (1)    TO DC-GREG-DATE-CYMD
 12430         PERFORM 3025-CALC-ELAPSED-MONTHS THRU 3026-CALC-EXIT
 12431         MOVE DC-ELAPSED-MONTHS        TO REIN-AH-CLM-MTH-1.
 12432
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 241
* ECS010MO.cbl
 12433     IF CR-DIS-INCUR-DT (2) NOT = ZEROS
 12434         MOVE CR-DIS-INCUR-DT (2)    TO DC-GREG-DATE-CYMD
 12435         PERFORM 3025-CALC-ELAPSED-MONTHS THRU 3026-CALC-EXIT
 12436         MOVE DC-ELAPSED-MONTHS        TO REIN-AH-CLM-MTH-2.
 12437
 12438     IF CR-DIS-INCUR-DT (3) NOT = ZEROS
 12439         MOVE CR-DIS-INCUR-DT (3)      TO DC-GREG-DATE-CYMD
 12440         PERFORM 3025-CALC-ELAPSED-MONTHS THRU 3026-CALC-EXIT
 12441         MOVE DC-ELAPSED-MONTHS        TO REIN-AH-CLM-MTH-3.
 12442
 12443     IF CR-DIS-INCUR-DT (4) NOT = ZEROS
 12444         MOVE CR-DIS-INCUR-DT (4)    TO DC-GREG-DATE-CYMD
 12445         PERFORM 3025-CALC-ELAPSED-MONTHS THRU 3026-CALC-EXIT
 12446         MOVE DC-ELAPSED-MONTHS        TO REIN-AH-CLM-MTH-4.
 12447
 12448     IF CR-DIS-INCUR-DT (5) NOT = ZEROS
 12449         MOVE CR-DIS-INCUR-DT (5)    TO DC-GREG-DATE-CYMD
 12450         PERFORM 3025-CALC-ELAPSED-MONTHS THRU 3026-CALC-EXIT
 12451         MOVE DC-ELAPSED-MONTHS        TO REIN-AH-CLM-MTH-5.
 12452
 12453     MOVE MONTHS-DIFF-AH               TO REIN-EARN-AH-TERM.
 12454
 12455
 12456     GO TO 3029-CONTINUE-REIN-CALC.
 12457
 12458
 12459 3025-CALC-ELAPSED-MONTHS.
 12460
 12461     MOVE 'L'                          TO DC-OPTION-CODE.
 12462     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 12463     MOVE DC-BIN-DATE-1                TO DC-BIN-DATE-2.
 12464     MOVE WS-CR-BIN-DATE               TO DC-BIN-DATE-1.
 12465     MOVE '1'                          TO DC-OPTION-CODE.
 12466     MOVE ' '                          TO DC-CENTURY-ADJUSTMENT.
 12467     MOVE ZEROS                        TO DC-ELAPSED-MONTHS
 12468                                          DC-ODD-DAYS-OVER
 12469                                          DC-ELAPSED-DAYS.
 12470     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 12471
 12472 3026-CALC-EXIT.
 12473     EXIT.
 12474
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 242
* ECS010MO.cbl
 12476 3029-CONTINUE-REIN-CALC.
 12477
*12478                             COPY ECSRTPFM.
 12479******************************************************************07/10/97
 12480*                                                                *ECSRTPFM
 12481*                            ECSRTPFM                            *   LV001
 12482*                            VMOD=2.002                          *ECSRTPFM
 12483*                                                                *ECSRTPFM
 12484******************************************************************ECSRTPFM
 12485                                                                  ECSRTPFM
 12486     IF    CR-LFAMT  NUMERIC                                      00000072
 12487           NEXT SENTENCE                                          00000073
 12488        ELSE                                                      00000074
 12489           MOVE ZEROS TO CR-LFAMT.                                00000075
 12490                                                                  00000076
 12491     IF    CR-LFAMT-ALT  NUMERIC                                  00000077
 12492           NEXT SENTENCE                                          00000078
 12493        ELSE                                                      00000079
 12494           MOVE ZEROS TO CR-LFAMT-ALT.                            00000080
 12495                                                                  00000081
 12496                                                                  00000082
 12497     IF    CR-LFPRM  NUMERIC                                      00000083
 12498           NEXT SENTENCE                                          00000084
 12499        ELSE                                                      00000085
 12500           MOVE ZEROS TO CR-LFPRM.                                00000086
 12501                                                                  00000087
 12502     IF    CR-LFPRM-ALT  NUMERIC                                  00000088
 12503           NEXT SENTENCE                                          00000089
 12504        ELSE                                                      00000090
 12505           MOVE ZEROS TO CR-LFPRM-ALT.                            00000091
 12506                                                                  00000092
 12507                                                                  00000093
 12508     IF    CR-LFPRM-CALC  NUMERIC                                 00000094
 12509           NEXT SENTENCE                                          00000095
 12510        ELSE                                                      00000096
 12511           MOVE ZEROS TO CR-LFPRM-CALC.                           00000097
 12512                                                                  00000098
 12513     IF    CR-LFPRM-CALC-ALT  NUMERIC                             00000099
 12514           NEXT SENTENCE                                          00000100
 12515        ELSE                                                      00000101
 12516           MOVE ZEROS TO CR-LFPRM-CALC-ALT.                       00000102
 12517                                                                  00000103
 12518     IF    CR-LF-NSP-PRM  NUMERIC                                 00000104
 12519           NEXT SENTENCE                                          00000105
 12520        ELSE                                                      00000106
 12521           MOVE ZEROS TO CR-LF-NSP-PRM.                           00000107
 12522                                                                  00000108
 12523     COMPUTE RS-R-LB = CR-LFAMT + CR-LFAMT-ALT.                   ECSRTPFM
 12524     COMPUTE RS-R-LP = CR-LFPRM + CR-LFPRM-ALT.                   ECSRTPFM
 12525     IF RE-NSP-ST-CD-LF = ZEROS  OR  SPACES                       ECSRTPFM
 12526         COMPUTE RS-R-LPC = CR-LFPRM-CALC + CR-LFPRM-CALC-ALT     ECSRTPFM
 12527     ELSE                                                         ECSRTPFM
 12528         MOVE CR-LF-NSP-PRM         TO RS-R-LPC.                  ECSRTPFM
 12529     MOVE RS-R-LPC                  TO REIN-CALCED-LIFE.          ECSRTPFM
 12530                                                                  ECSRTPFM
 12531     MOVE CR-AHAMT                  TO RS-R-AB.                   ECSRTPFM
 12532     MOVE CR-AHPRM                  TO RS-R-AP.                   ECSRTPFM
 12533     IF RE-NSP-ST-CD-AH = ZEROS  OR  SPACES                       ECSRTPFM
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 243
* ECS010MO.cbl (/apps/prod/cid1p/copy/ECSRTPFM)
 12534         MOVE CR-AHPRM-CALC         TO RS-R-APC                   ECSRTPFM
 12535     ELSE                                                         ECSRTPFM
 12536         MOVE CR-AH-NSP-PRM         TO RS-R-APC.                  ECSRTPFM
 12537     MOVE RS-R-APC                  TO REIN-CALCED-AH.            ECSRTPFM
 12538                                                                  ECSRTPFM
 12539     PERFORM REINSURE-CALC THRU REINSURE-CALC-X                   ECSRTPFM
 12540         VARYING SUB1 FROM +1 BY +1                               ECSRTPFM
 12541             UNTIL RE-REI-COMP-NO (SUB1) = SPACES.                ECSRTPFM
 12542                                                                  ECSRTPFM
 12543
 12544     MOVE 'X'                  TO REIN-RT-SW.
 12545     PERFORM 3200-REINSURE-CANCEL THRU 3299-REINSURE-CANCEL-X.
 12546     PERFORM 3300-REINSURE-CLAIM THRU 3399-REINSURE-CLAIM-X.
 12547     MOVE ' '                  TO REIN-RT-SW.
 12548
 12549 3030-RE-CALCULATE-REINSURANCE.
 12550
 12551     IF AM-RECALC-REIN = 'Y'
 12552         IF CR-REIN-TABLE NOT = AM-REI-TABLE  AND
 12553            CR-REIN-SPEC = SPACE  AND
 12554            CR-ENTRY-DATE NOT = EOM-RUN-DATE
 12555             PERFORM 3600-RC-REINSURANCE
 12556                 THRU 3799-RC-REINSURANCE-X.
 12557
 12558     PERFORM 3040-REIN-REC-CNT THRU 3049-RRC-XIT
 12559         VARYING SUB1 FROM 1 BY 1
 12560             UNTIL REIN-COMP (SUB1) = SPACES.
 12561
 12562     GO TO 3099-REINSURE-ROUTINE-X.
 12563
 12564 3040-REIN-REC-CNT.
 12565
 12566     IF REIN-LF-AH-FLGS (SUB1) = SPACES
 12567         GO TO 3049-RRC-XIT.
 12568
 12569     PERFORM 3050-REIN-COMP-ADD THRU 3059-RCA-XIT
 12570         VARYING B-SUB FROM 1 BY 1
 12571             UNTIL B-SUB GREATER THAN 50.
 12572
 12573 3049-RRC-XIT.
 12574     EXIT.
 12575
 12576 3050-REIN-COMP-ADD.
 12577
 12578     IF RB-COMPANY (B-SUB) = SPACES
 12579         MOVE REIN-COMP (SUB1) TO RB-COMPANY (B-SUB).
 12580     IF RB-COMPANY (B-SUB) = REIN-COMP (SUB1)
 12581         MOVE 1   TO RB-COUNT (B-SUB)
 12582         MOVE +50 TO B-SUB.
 12583
 12584 3059-RCA-XIT.
 12585     EXIT.
 12586
 12587 3099-REINSURE-ROUTINE-X.
 12588     EXIT.
 12589
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 244
* ECS010MO.cbl
 12591******************************************************************
 12592***                R E I N S U R E   I S S U E S               ***
 12593******************************************************************
 12594
 12595 3100-REINSURE-ISSUE.
 12596
 12597     IF  REIN-COMP (1) = SPACES
 12598         GO TO 3199-REINSURE-ISSUE-X.
 12599
 12600     PERFORM 2000-INITIALIZE-DETAIL-EXTRACT THRU 2099-INIT-DTL-X.
 12601     MOVE ZEROS    TO RW-ACCUM-LF  RW-ACCUM-AH.
 12602     MOVE 'I'      TO DE-TRANS.
 12603     MOVE 'R'      TO DE-REIN.
 12604*****PERFORM EXTRACT-DATE-RELOAD.
 12605     MOVE DETAIL-EXTRACT TO SAVE-EXTRACT.
 12606     MOVE +1       TO SUB1.
 12607
 12608 3110-REINSURE-ISSUE-LOOP.
 12609
 12610     IF REIN-COMP (SUB1) = SPACES
 12611         GO TO 3119-REINSURE-ISSUE-LOOP-END.
 12612
 12613     IF UPDATING-RISK-PREMIUMS
 12614       IF REIN-REM-SW (SUB1) NOT = 'I'
 12615         ADD +1 TO SUB1
 12616         GO TO 3110-REINSURE-ISSUE-LOOP.
 12617
 12618     IF REIN-REM-SW (SUB1) = 'Z'
 12619         ADD +1 TO SUB1
 12620         GO TO 3110-REINSURE-ISSUE-LOOP.
 12621
 12622     MOVE REIN-COMP (SUB1)      TO DE-REI-COMP.
 12623     MOVE REIN-WORK-FLDS (SUB1) TO RWF-FIELDS.
 12624     MOVE RWF-LFAMT             TO DE-REI-LFAMT.
 12625     MOVE RWF-LFPRM             TO DE-REI-LFPRM.
 12626     MOVE RWF-AHAMT             TO DE-REI-AHAMT.
 12627     MOVE RWF-AHPRM             TO DE-REI-AHPRM.
 12628
 12629     IF REIN-REM-SW (SUB1) NOT = 'I'
 12630         GO TO 3115-CONTINUE-ISSUE-LOOP.
 12631
 12632     IF RWF-LFPRM = ZEROS  AND
 12633        RWF-AHPRM = ZEROS
 12634         GO TO 3115-CONTINUE-ISSUE-LOOP.
 12635
 12636     IF RWF-LFPRM NOT = ZEROS
 12637         COMPUTE DE-REI-LFPRM = RWF-LFPRM - CR-LF-REI-RISK-PRM
 12638         MOVE RWF-LFPRM         TO CR-LF-REI-RISK-PRM.
 12639
 12640     IF RWF-AHPRM NOT = ZEROS
 12641         COMPUTE DE-REI-AHPRM = RWF-AHPRM - CR-AH-REI-RISK-PRM
 12642         MOVE RWF-AHPRM         TO CR-AH-REI-RISK-PRM.
 12643
 12644 3115-CONTINUE-ISSUE-LOOP.
 12645
 12646     ADD DE-REI-LFPRM           TO RW-ACCUM-LF.
 12647     ADD DE-REI-AHPRM           TO RW-ACCUM-AH.
 12648
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 245
* ECS010MO.cbl
 12649     IF DE-REI-LFAMT NOT = ZERO
 12650        OR DE-REI-LFPRM NOT = ZERO
 12651        OR DE-REI-AHAMT NOT = ZERO
 12652        OR DE-REI-AHPRM NOT = ZERO
 12653         PERFORM 2500-WRITE-DETAIL-EXTRACTS THRU
 12654                 2599-WRT-DETAIL-X
 12655         ADD +1 TO BC-R-ISS.
 12656
 12657     ADD +1 TO SUB1.
 12658     MOVE SAVE-EXTRACT TO DETAIL-EXTRACT.
 12659     PERFORM EXTRACT-DATE-LOAD.
 12660
 12661     GO TO 3110-REINSURE-ISSUE-LOOP.
 12662
 12663 3119-REINSURE-ISSUE-LOOP-END.
 12664     EXIT.
 12665
 12666 3190-REINSURE-ISSUE-PRINT.
 12667
 12668     PERFORM 8600-SETUP-DETAIL-LINE THRU 8689-SETUP-DETAIL-X.
 12669     IF RW-ACCUM-LF NOT = ZERO
 12670         MOVE CLAS-I-AB3 (CLAS-INDEXL) TO TRD-LFTYP
 12671         MOVE CR-LF-TERM               TO TRD-LFTRM
 12672         MOVE RW-ACCUM-LF         TO TRD-LFPRM-RFND
 12673         MOVE 'REIN CEDED'        TO TRD-LF-ACTION.
 12674     IF RW-ACCUM-AH NOT = ZERO
 12675         MOVE CLAS-I-AB3 (CLAS-INDEXA) TO TRD-AHTYP
 12676         MOVE CR-AH-TERM               TO TRD-AHTRM
 12677         MOVE RW-ACCUM-AH         TO TRD-AHPRM-RFND
 12678         MOVE 'REIN CEDED'        TO TRD-AH-ACTION.
 12679     IF RW-ACCUM-LF NOT = ZERO  OR  RW-ACCUM-AH NOT = ZERO
 12680         PERFORM 8690-PRINT-DETAIL-LINE THRU 8699-PRT-DETAIL-X.
 12681
 12682 3199-REINSURE-ISSUE-X.
 12683     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 246
* ECS010MO.cbl
 12685******************************************************************
 12686***               R E I N S U R E   C A N C E L S              ***
 12687******************************************************************
 12688
 12689 3200-REINSURE-CANCEL.
 12690
 12691     IF REIN-COMP (1) = SPACES
 12692         GO TO 3299-REINSURE-CANCEL-X.
 12693
 12694     IF CR-LFRFND = ZERO
 12695        AND CR-AHRFND = ZERO
 12696         GO TO 3299-REINSURE-CANCEL-X.
 12697
 12698     PERFORM REINSURE-CALC-CANCEL THRU REINSURE-CALC-CANCEL-X
 12699             VARYING SUB1 FROM +1 BY +1 UNTIL
 12700                       REIN-COMP (SUB1) = SPACES.
 12701
 12702     IF REIN-RT-SW = 'X'
 12703         GO TO 3299-REINSURE-CANCEL-X.
 12704
 12705     PERFORM 2200-BUILD-CANCEL-EXTRACT THRU 2259-END-CANCEL-BUILD.
 12706     MOVE ZEROS    TO RW-ACCUM-LF  RW-ACCUM-AH.
 12707     MOVE 'R'      TO DE-REIN.
 12708*****PERFORM EXTRACT-DATE-RELOAD.
 12709     MOVE DETAIL-EXTRACT TO SAVE-EXTRACT.
 12710     MOVE +1       TO SUB1.
 12711
 12712 3210-REINSURE-CANCEL-LOOP.
 12713
 12714     IF REIN-COMP (SUB1) = SPACES
 12715         GO TO 3219-REINSURE-CANCEL-LOOP-END.
 12716
 12717     IF REIN-REM-SW (SUB1) = 'Z'
 12718         ADD +1        TO SUB1
 12719         MOVE SAVE-EXTRACT TO DETAIL-EXTRACT
 12720         PERFORM EXTRACT-DATE-LOAD
 12721         GO TO 3210-REINSURE-CANCEL-LOOP.
 12722
 12723     MOVE REIN-COMP (SUB1)      TO DE-REI-COMP.
 12724     MOVE REIN-WORK-FLDS (SUB1) TO RWF-FIELDS.
 12725
 12726     MOVE RWF-LFRFND            TO DE-REI-LFRFND.
 12727     MOVE RWF-AHRFND            TO DE-REI-AHRFND.
 12728     MOVE RWF-LFAMT             TO DE-REI-LFAMT.
 12729     MOVE RWF-LFPRM             TO DE-REI-LFPRM.
 12730     MOVE RWF-AHAMT             TO DE-REI-AHAMT.
 12731     MOVE RWF-AHPRM             TO DE-REI-AHPRM.
 12732     ADD RWF-LFRFND             TO RW-ACCUM-LF.
 12733     ADD RWF-AHRFND             TO RW-ACCUM-AH.
 12734     COMPUTE DE-REI-CNAMT ROUNDED = RWF-LFAMT * TEMP-5.
 12735
 12736     IF REIN-REM-SW (SUB1) NOT = 'I'
 12737         GO TO 3215-CONTINUE-CANCEL-LOOP.
 12738
 12739     IF CR-LF-CANCEL-EXIT-DATE = EOM-RUN-DATE  OR
 12740        VOIDING-LF-CANCEL
 12741         NEXT SENTENCE
 12742     ELSE
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 247
* ECS010MO.cbl
 12743         MOVE ZEROS             TO DE-REI-LFRFND.
 12744
 12745     IF CR-AH-CANCEL-EXIT-DATE = EOM-RUN-DATE  OR
 12746        VOIDING-AH-CANCEL
 12747         NEXT SENTENCE
 12748     ELSE
 12749         MOVE ZEROS             TO DE-REI-AHRFND.
 12750
 12751 3215-CONTINUE-CANCEL-LOOP.
 12752
 12753     IF RWF-LF-RUNOFF-SW = 'N'
 12754         IF DE-LF-CANC-DTE NOT LESS THAN RWF-EP-STOP-DATE
 12755             MOVE ZEROS         TO DE-LF-TYPE
 12756                                   DE-REI-LFAMT
 12757                                   DE-REI-LFPRM
 12758                                   DE-REI-LFRFND
 12759                                   DE-REI-CNAMT.
 12760
 12761     IF RWF-AH-RUNOFF-SW = 'N'
 12762         IF DE-AH-CANC-DTE NOT LESS THAN RWF-EP-STOP-DATE
 12763             MOVE ZEROS         TO DE-AH-TYPE
 12764                                   DE-REI-AHAMT
 12765                                   DE-REI-AHPRM
 12766                                   DE-REI-AHRFND.
 12767
 12768     IF DE-REI-LFAMT NOT = ZERO
 12769        OR DE-REI-LFPRM NOT = ZERO
 12770        OR DE-REI-AHAMT NOT = ZERO
 12771        OR DE-REI-AHPRM NOT = ZERO
 12772        OR DE-REI-LFRFND NOT = ZERO
 12773        OR DE-REI-AHRFND NOT = ZERO
 12774        OR DE-REI-CNAMT NOT = ZERO
 12775         PERFORM 2500-WRITE-DETAIL-EXTRACTS THRU
 12776                                            2599-WRT-DETAIL-X
 12777         ADD +1 TO BC-R-CNC.
 12778
 12779     ADD +1 TO SUB1.
 12780     MOVE SAVE-EXTRACT TO DETAIL-EXTRACT.
 12781     PERFORM EXTRACT-DATE-LOAD.
 12782     GO TO 3210-REINSURE-CANCEL-LOOP.
 12783
 12784 3219-REINSURE-CANCEL-LOOP-END.
 12785     EXIT.
 12786
 12787 3290-REINSURE-CANCEL-PRINT.
 12788
 12789     PERFORM 8600-SETUP-DETAIL-LINE THRU 8689-SETUP-DETAIL-X.
 12790     IF RW-ACCUM-LF NOT = ZERO
 12791         MOVE CLAS-I-AB3 (CLAS-INDEXL) TO TRD-LFTYP
 12792         MOVE CR-LF-TERM               TO TRD-LFTRM
 12793         MOVE RW-ACCUM-LF         TO TRD-LFPRM-RFND
 12794         MOVE 'REIN CANCL'        TO TRD-LF-ACTION.
 12795     IF RW-ACCUM-AH NOT = ZERO
 12796         MOVE CLAS-I-AB3 (CLAS-INDEXA) TO TRD-AHTYP
 12797         MOVE CR-AH-TERM               TO TRD-AHTRM
 12798         MOVE RW-ACCUM-AH         TO TRD-AHPRM-RFND
 12799         MOVE 'REIN CANCL'        TO TRD-AH-ACTION.
 12800     IF RW-ACCUM-LF NOT = ZERO  OR  RW-ACCUM-AH NOT = ZERO
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 248
* ECS010MO.cbl
 12801         PERFORM 8690-PRINT-DETAIL-LINE THRU 8699-PRT-DETAIL-X.
 12802
 12803 3299-REINSURE-CANCEL-X.
 12804     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 249
* ECS010MO.cbl
 12806******************************************************************
 12807***                R E I N S U R E   C L A I M S               ***
 12808******************************************************************
 12809
 12810 3300-REINSURE-CLAIM.
 12811
 12812*    IF DTE-CLIENT = '???'
 12813*       IF (REIN-RT-SW NOT = 'X')  AND
 12814*          (PC-PAYMENT-TYPE = '5' OR '6')
 12815*        GO TO 3399-REINSURE-CLAIM-X.
 12816
 12817     IF REIN-COMP (1) = SPACES
 12818         GO TO 3399-REINSURE-CLAIM-X.
 12819
 12820     IF REIN-RT-SW = 'X'
 12821         MOVE CR-DTHAMT   TO RW-LFCLMWK
 12822         ADD  CR-DTHEXP   TO RW-LFCLMWK
 12823         MOVE CR-DISAMT   TO RW-AHCLMWK
 12824         ADD  CR-DISEXP   TO RW-AHCLMWK
 12825     ELSE
 12826         IF PC-CLAIM-TYPE  = 1 OR 3
 12827             MOVE PC-CLAIM-PAYMENT    TO RW-LFCLMWK
 12828             MOVE +0                  TO RW-AHCLMWK
 12829         ELSE
 12830             MOVE PC-CLAIM-PAYMENT    TO RW-AHCLMWK
 12831             MOVE +0                  TO RW-LFCLMWK.
 12832
 12833     MOVE +0                          TO RW-LFCLM
 12834                                         RW-AHCLM.
 12835     IF RW-LFCLMWK = ZERO
 12836        AND RW-AHCLMWK = ZERO
 12837         GO TO 3399-REINSURE-CLAIM-X.
 12838
 12839     PERFORM REINSURE-CALC-CLAIM THRU REINSURE-CALC-CLAIM-X
 12840         VARYING SUB1 FROM +1 BY +1
 12841             UNTIL REIN-COMP (SUB1) = SPACES.
 12842
 12843     IF REIN-RT-SW = 'X'
 12844         GO TO 3399-REINSURE-CLAIM-X.
 12845
 12846     PERFORM 2300-BUILD-CLAIM-EXTRACT.
 12847     MOVE ZEROS                TO RW-ACCUM-CLM.
 12848     MOVE 'R'                  TO DE-REIN.
 12849*****PERFORM EXTRACT-DATE-RELOAD.
 12850     MOVE DETAIL-EXTRACT       TO SAVE-EXTRACT.
 12851     MOVE +1                   TO SUB1.
 12852
 12853 3310-REINSURE-CLAIM-LOOP.
 12854
 12855     IF REIN-COMP (SUB1) = SPACES
 12856         GO TO 3390-REINSURE-CLAIM-PRINT.
 12857
 12858     IF REIN-REM-SW (SUB1) = 'Z'
 12859         ADD +1        TO SUB1
 12860         MOVE SAVE-EXTRACT TO DETAIL-EXTRACT
 12861         PERFORM EXTRACT-DATE-LOAD
 12862         GO TO 3310-REINSURE-CLAIM-LOOP.
 12863
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 250
* ECS010MO.cbl
 12864     MOVE REIN-COMP (SUB1)      TO DE-REI-COMP.
 12865     MOVE REIN-WORK-FLDS (SUB1) TO RWF-FIELDS.
 12866
 12867     IF PC-CLAIM-TYPE  = 1 OR 3
 12868         IF RWF-LF-RUNOFF-SW = 'N'
 12869           IF CR-DTH-DT NOT LESS THAN RWF-EP-STOP-DATE
 12870               GO TO 3330-REINSURE-CLAIM-LOOP-ADD.
 12871
 12872     IF PC-CLAIM-TYPE  = 2 OR 4
 12873         IF RWF-AH-RUNOFF-SW = 'N'
 12874           IF CR-DIS-DT NOT LESS THAN RWF-EP-STOP-DATE
 12875               GO TO 3330-REINSURE-CLAIM-LOOP-ADD.
 12876
 12877     MOVE RWF-LFAMT             TO DE-REI-LFAMT.
 12878     MOVE RWF-LFPRM             TO DE-REI-LFPRM.
 12879     MOVE RWF-AHAMT             TO DE-REI-AHAMT.
 12880     MOVE RWF-AHPRM             TO DE-REI-AHPRM.
 12881
 12882     IF PC-CLAIM-TYPE  = 1 OR 3
 12883         MOVE RWF-LFCLML TO DE-REI-CLAIM-AMT
 12884         ADD RWF-LFCLML  TO RW-ACCUM-CLM
 12885     ELSE
 12886         MOVE RWF-AHCLML TO DE-REI-CLAIM-AMT
 12887         ADD RWF-AHCLML  TO RW-ACCUM-CLM.
 12888
 12889     IF PC-CLAIM-TYPE = 1 OR 3
 12890         IF +0 = DE-REI-LFPRM AND DE-REI-LFAMT
 12891            AND DE-REI-CLAIM-AMT
 12892             GO TO 3330-REINSURE-CLAIM-LOOP-ADD
 12893         ELSE
 12894             GO TO 3320-REINSURE-CLAIM-LOOP-GO
 12895     ELSE
 12896         IF +0 = DE-REI-AHPRM AND DE-REI-AHAMT
 12897            AND DE-REI-CLAIM-AMT
 12898             GO TO 3330-REINSURE-CLAIM-LOOP-ADD
 12899         ELSE
 12900             GO TO 3320-REINSURE-CLAIM-LOOP-GO.
 12901
 12902 3320-REINSURE-CLAIM-LOOP-GO.
 12903
 12904     PERFORM 2500-WRITE-DETAIL-EXTRACTS THRU 2599-WRT-DETAIL-X.
 12905     ADD +1                     TO BC-R-CLM.
 12906
 12907 3330-REINSURE-CLAIM-LOOP-ADD.
 12908
 12909     ADD +1                     TO SUB1.
 12910     MOVE SAVE-EXTRACT          TO DETAIL-EXTRACT.
 12911     PERFORM EXTRACT-DATE-LOAD.
 12912     GO TO 3310-REINSURE-CLAIM-LOOP.
 12913
 12914 3390-REINSURE-CLAIM-PRINT.
 12915
 12916     PERFORM 8600-SETUP-DETAIL-LINE THRU 8689-SETUP-DETAIL-X.
 12917     IF PC-CLAIM-TYPE = '1'  OR  '3'
 12918         MOVE CLAS-I-AB3 (CLAS-INDEXL) TO TRD-LFTYP
 12919         MOVE CR-LF-TERM               TO TRD-LFTRM
 12920         MOVE RW-ACCUM-CLM     TO TRD-LFCOM-CLM
 12921         MOVE 'REIN CLAIM'     TO TRD-LF-ACTION
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 251
* ECS010MO.cbl
 12922     ELSE
 12923         MOVE CLAS-I-AB3 (CLAS-INDEXA) TO TRD-AHTYP
 12924         MOVE CR-AH-TERM               TO TRD-AHTRM
 12925         MOVE RW-ACCUM-CLM     TO TRD-AHCOM-CLM
 12926         MOVE CR-DIS-MO        TO TRD-AHACTMO
 12927         MOVE CR-DIS-DA        TO TRD-AHACTDA
 12928         MOVE CR-DIS-YR        TO TRD-AHACTYR
 12929         MOVE '/'              TO TRD-AH-S1  TRD-AH-S2
 12930         MOVE 'REIN CLAIM'     TO TRD-AH-ACTION.
 12931     PERFORM 8690-PRINT-DETAIL-LINE THRU 8699-PRT-DETAIL-X.
 12932
 12933 3399-REINSURE-CLAIM-X.
 12934     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 252
* ECS010MO.cbl
 12936******************************************************************
 12937***              R E I N S U R E   R E S E R V E S             ***
 12938******************************************************************
 12939
 12940 3400-REINSURE-RESERVE.
 12941
 12942     IF REIN-COMP (1) = SPACES
 12943         GO TO 3499-REINSURE-RESERVE-X.
 12944
 12945     IF PC-CLAIM-TYPE = '1' OR '3'
 12946         MOVE PC-IBNR-RESERVE-AMT    TO RW-LFIBNRWK
 12947         MOVE PC-PTC-RESERVE-AMT     TO RW-LFPAYCURWK
 12948         MOVE PC-FUTURE-RESERVE-AMT  TO RW-LFFUTRSVWK
 12949         ADD  PC-MANUAL-RESERVE-AMT  TO RW-LFFUTRSVWK
 12950         MOVE +0 TO RW-AHIBNRWK  RW-AHPAYCURWK  RW-AHFUTRSVWK
 12951     ELSE
 12952         MOVE PC-IBNR-RESERVE-AMT    TO RW-AHIBNRWK
 12953         MOVE PC-PTC-RESERVE-AMT     TO RW-AHPAYCURWK
 12954         MOVE PC-FUTURE-RESERVE-AMT  TO RW-AHFUTRSVWK
 12955         ADD  PC-MANUAL-RESERVE-AMT  TO RW-AHFUTRSVWK
 12956         MOVE +0 TO RW-LFIBNRWK  RW-LFPAYCURWK  RW-LFFUTRSVWK.
 12957
 12958     MOVE +0 TO RW-LFIBNR  RW-LFPAYCUR  RW-LFFUTRSV
 12959                RW-AHIBNR  RW-AHPAYCUR  RW-AHFUTRSV.
 12960     IF +0 = RW-LFIBNRWK AND RW-LFPAYCURWK AND RW-LFFUTRSVWK
 12961         AND RW-AHIBNRWK AND RW-AHPAYCURWK AND RW-AHFUTRSVWK
 12962          GO TO 3499-REINSURE-RESERVE-X.
 12963
 12964     IF DTE-CLIENT NOT = 'MIC'
 12965         GO TO 3405-REINSURE-RESERVE-CONT.
 12966
 12967     IF PC-CLAIM-TYPE = '1'  OR  '3'
 12968         GO TO 3405-REINSURE-RESERVE-CONT.
 12969
 12970     MOVE PC-CERT-EFF-DT             TO CP-CERT-EFF-DT.
 12971     MOVE BIN-VALUATION-DT           TO CP-VALUATION-DT.
 12972     MOVE PC-PAID-THRU-DT            TO CP-PAID-THRU-DT.
 12973     MOVE 'A'                        TO CP-BENEFIT-TYPE
 12974                                        CP-CLAIM-TYPE.
 12975     MOVE PC-INCURRED-DT             TO CP-INCURRED-DT.
 12976     MOVE PC-REPORTED-DT             TO CP-REPORTED-DT.
 12977     MOVE DTE-CLIENT                 TO CP-COMPANY-ID.
 12978     MOVE CR-AGE                     TO CP-ISSUE-AGE.
 12979     MOVE ZEROS                      TO CP-CDT-PERCENT.
 12980     MOVE '3'                        TO CP-CDT-METHOD.
 12981     MOVE CR-AH-TERM                 TO CP-ORIGINAL-TERM.
 12982     MOVE CR-AHAMT                   TO CP-ORIGINAL-BENEFIT
 12983                                        CP-RATING-BENEFIT-AMT.
 12984     MOVE PC-REMAINING-TERM          TO CP-REMAINING-TERM.
 12985     MOVE 'O'                        TO CP-CLAIM-STATUS.
 12986
 12987 3405-REINSURE-RESERVE-CONT.
 12988
 12989     PERFORM 3500-REINSURE-CALC-RESERVE
 12990         THRU 3599-REINSURE-CALC-RESERVE-X
 12991             VARYING SUB1 FROM +1 BY +1
 12992                 UNTIL REIN-COMP (SUB1) = SPACES.
 12993
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 253
* ECS010MO.cbl
 12994     PERFORM 2400-BUILD-RESERVE-EXTRACT.
 12995     MOVE +0 TO RW-ACCUM-IBNR  RW-ACCUM-PAYCUR  RW-ACCUM-FUTRSV.
 12996     MOVE 'R'            TO DE-REIN.
 12997*****PERFORM EXTRACT-DATE-RELOAD.
 12998     MOVE DETAIL-EXTRACT TO SAVE-EXTRACT.
 12999     MOVE +1             TO SUB1.
 13000
 13001 3410-REINSURE-RESERVE-LOOP.
 13002
 13003     IF REIN-COMP (SUB1) = SPACES
 13004         GO TO 3490-REINSURE-RESERVE-PRINT.
 13005
 13006     IF REIN-REM-SW (SUB1) = 'Z'
 13007         ADD +1 TO SUB1
 13008         GO TO 3410-REINSURE-RESERVE-LOOP.
 13009
 13010     MOVE REIN-COMP (SUB1)      TO DE-REI-COMP.
 13011     MOVE REIN-WORK-FLDS (SUB1) TO RWF-FIELDS.
 13012
 13013     IF PC-CLAIM-TYPE  = 1 OR 3
 13014         IF RWF-LF-RUNOFF-SW = 'N'
 13015           IF CR-DTH-DT NOT LESS THAN RWF-EP-STOP-DATE
 13016               GO TO 3415-REINSURE-RESERVE-LOOP-ADD.
 13017
 13018     IF PC-CLAIM-TYPE  = 2 OR 4
 13019         IF RWF-AH-RUNOFF-SW = 'N'
 13020           IF CR-DIS-DT NOT LESS THAN RWF-EP-STOP-DATE
 13021               GO TO 3415-REINSURE-RESERVE-LOOP-ADD.
 13022
 13023     MOVE RWF-LFAMT             TO DE-REI-LFAMT.
 13024     MOVE RWF-LFPRM             TO DE-REI-LFPRM.
 13025     MOVE RWF-AHAMT             TO DE-REI-AHAMT.
 13026     MOVE RWF-AHPRM             TO DE-REI-AHPRM.
 13027
 13028     IF PC-CLAIM-TYPE = 1 OR 3
 13029         MOVE RWF-DTH-IBNRL   TO DE-REI-IBNR
 13030         MOVE RWF-DTH-PAYCURL TO DE-REI-PAYCUR
 13031         MOVE RWF-DTH-FUTRSVL TO DE-REI-FUTRSV
 13032     ELSE
 13033         MOVE RWF-DIS-IBNRL   TO DE-REI-IBNR
 13034         MOVE RWF-DIS-PAYCURL TO DE-REI-PAYCUR
 13035         MOVE RWF-DIS-FUTRSVL TO DE-REI-FUTRSV.
 13036
 13037     ADD DE-REI-IBNR            TO RW-ACCUM-IBNR.
 13038     ADD DE-REI-PAYCUR          TO RW-ACCUM-PAYCUR.
 13039     ADD DE-REI-FUTRSV          TO RW-ACCUM-FUTRSV.
 13040
 13041     IF +0 NOT = DE-REI-LFAMT OR DE-REI-LFPRM OR DE-REI-AHAMT
 13042        OR DE-REI-AHPRM OR DE-REI-IBNR OR DE-REI-PAYCUR
 13043        OR DE-REI-FUTRSV
 13044         PERFORM 2500-WRITE-DETAIL-EXTRACTS THRU
 13045                                            2599-WRT-DETAIL-X
 13046         ADD +1 TO BC-R-CRS.
 13047
 13048 3415-REINSURE-RESERVE-LOOP-ADD.
 13049
 13050     ADD +1 TO SUB1.
 13051     MOVE SAVE-EXTRACT TO DETAIL-EXTRACT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 254
* ECS010MO.cbl
 13052     PERFORM EXTRACT-DATE-LOAD.
 13053     GO TO 3410-REINSURE-RESERVE-LOOP.
 13054
 13055 3490-REINSURE-RESERVE-PRINT.
 13056
 13057     IF RW-ACCUM-IBNR   = ZERO  AND
 13058        RW-ACCUM-PAYCUR = ZERO  AND
 13059        RW-ACCUM-FUTRSV = ZERO
 13060         GO TO 3499-REINSURE-RESERVE-X.
 13061
 13062     PERFORM 8600-SETUP-DETAIL-LINE THRU 8689-SETUP-DETAIL-X.
 13063     MOVE RW-ACCUM-IBNR             TO TRD-IBNR.
 13064     MOVE 'IBNR'                    TO TRD-IBNRX.
 13065     MOVE RW-ACCUM-PAYCUR           TO TRD-PAYCUR.
 13066     MOVE 'PAY CURR'                TO TRD-PAYCURX.
 13067     MOVE RW-ACCUM-FUTRSV           TO TRD-FUTRSV.
 13068     MOVE 'FUTURE'                  TO TRD-FUTRSVX.
 13069
 13070     IF PC-CLAIM-TYPE = 1
 13071         MOVE LIFE-OVERRIDE-L6      TO TRD-RSV-DESC
 13072     ELSE
 13073         MOVE AH-OVERRIDE-L6        TO TRD-RSV-DESC.
 13074     MOVE ' REIN. CLAIM RESERVES'   TO TRD-RSV-ACTION.
 13075
 13076     PERFORM 8690-PRINT-DETAIL-LINE THRU 8699-PRT-DETAIL-X.
 13077
 13078 3499-REINSURE-RESERVE-X.
 13079     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 255
* ECS010MO.cbl
 13081******************************************************************
 13082***        C A L C U L A T E   R E I N   R E S E R V E S       ***
 13083******************************************************************
 13084
 13085 3500-REINSURE-CALC-RESERVE.
 13086
 13087     MOVE REIN-WORK-FLDS (SUB1) TO RWF-FIELDS.
 13088     MOVE +0 TO RWF-DTH-IBNRL RWF-DTH-PAYCURL  RWF-DTH-FUTRSVL
 13089                RWF-DIS-IBNRL  RWF-DIS-PAYCURL  RWF-DIS-FUTRSVL.
 13090
 13091     PERFORM REIN-FIND-CO-LOOP THRU FIND-REI-CO-EXIT
 13092        VARYING CO-SUB FROM 1 BY 1 UNTIL
 13093          (RCT-REIN-CO (CO-SUB) = REIN-COMP (SUB1))
 13094       OR (CO-SUB GREATER REIN-CO-TABLE-ENT-CNT).
 13095
 13096     IF CO-SUB GREATER REIN-CO-TABLE-ENT-CNT
 13097        MOVE ZERO TO CO-SUB.
 13098
 13099     IF CO-SUB NOT = ZERO
 13100        IF RCT-CLM-CUTOFF-DT (CO-SUB) NOT = ZERO
 13101           IF PC-CLAIM-TYPE = '1' OR '3'
 13102             IF CR-DTH-DT LESS THAN RCT-CLM-CUTOFF-DT (CO-SUB)
 13103                 GO TO 3540-CONT-REIN-CALC-RESERVE.
 13104
 13105     IF PC-CLAIM-TYPE  = 1 OR 3
 13106         IF RWF-LF-RUNOFF-SW = 'N'
 13107           IF CR-DTH-DT NOT LESS THAN RWF-EP-STOP-DATE
 13108               GO TO 3540-CONT-REIN-CALC-RESERVE.
 13109
 13110     IF CO-SUB NOT = ZERO
 13111        IF RCT-CLM-CUTOFF-DT (CO-SUB) NOT = ZERO
 13112           IF PC-CLAIM-TYPE = '2' OR '4'
 13113             IF CR-DIS-DT LESS THAN RCT-CLM-CUTOFF-DT (CO-SUB)
 13114                 GO TO 3540-CONT-REIN-CALC-RESERVE.
 13115
 13116     IF PC-CLAIM-TYPE  = 2 OR 4
 13117         IF RWF-AH-RUNOFF-SW = 'N'
 13118           IF CR-DIS-DT NOT LESS THAN RWF-EP-STOP-DATE
 13119               GO TO 3540-CONT-REIN-CALC-RESERVE.
 13120
 13121     IF DTE-CLIENT NOT = 'MIC'
 13122         GO TO 3505-REIN-CALC-RESERVE-CONT.
 13123
 13124     IF PC-CLAIM-TYPE = '1'  OR  '3'
 13125         GO TO 3505-REIN-CALC-RESERVE-CONT.
 13126
 13127     MOVE PC-FUTURE-RESERVE-AMT        TO RW-AHFUTRSVWK.
 13128
 13129     IF CR-AHTYP = ZERO  OR
 13130        CO-SUB = ZERO
 13131         GO TO 3505-REIN-CALC-RESERVE-CONT
 13132     ELSE
 13133         IF RCT-AH-CLM-MAX (CO-SUB) = ZERO
 13134             GO TO 3505-REIN-CALC-RESERVE-CONT.
 13135
 13136     COMPUTE MAX-REM-TERM ROUNDED =
 13137                         RCT-AH-CLM-MAX (CO-SUB) / CR-AHAMT.
 13138
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 256
* ECS010MO.cbl
 13139     IF MAX-REM-TERM NOT LESS THAN CP-REMAINING-TERM
 13140         GO TO 3505-REIN-CALC-RESERVE-CONT.
 13141
 13142     COMPUTE CP-ORIGINAL-TERM =
 13143                 CR-AH-TERM - CP-REMAINING-TERM + MAX-REM-TERM.
 13144
 13145     CALL 'ELRESVX' USING CALCULATION-PASS-AREA.
 13146
 13147     IF  CP-RETURN-CODE = ZERO
 13148         MOVE CP-FUTURE-RESERVE    TO RW-AHFUTRSVWK.
 13149
 13150 3505-REIN-CALC-RESERVE-CONT.
 13151
 13152     IF SUB1 = RE-100-COMP
 13153         GO TO 3520-REIN-REMAINDER-RSRV.
 13154
 13155     IF CR-LFAMT NOT = ZERO  AND
 13156        RWF-LFAMT NOT = ZERO
 13157         IF DTE-CLIENT NOT = 'MIC'
 13158             COMPUTE RWF-DTH-IBNRL = (RW-LFIBNRWK *
 13159                         RWF-LFAMT) / (CR-LFAMT + CR-LFAMT-ALT)
 13160             COMPUTE RWF-DTH-PAYCURL = (RW-LFPAYCURWK *
 13161                         RWF-LFAMT) / (CR-LFAMT + CR-LFAMT-ALT)
 13162             COMPUTE RWF-DTH-FUTRSVL = (RW-LFFUTRSVWK *
 13163                         RWF-LFAMT) / (CR-LFAMT + CR-LFAMT-ALT)
 13164         ELSE
 13165             MOVE RW-LFIBNRWK         TO RWF-DTH-IBNRL
 13166             MOVE RW-LFPAYCURWK       TO RWF-DTH-PAYCURL
 13167             MOVE RW-LFFUTRSVWK       TO RWF-DTH-FUTRSVL.
 13168
 13169     IF CR-AHAMT NOT = ZERO  AND
 13170        RWF-AHAMT NOT = ZERO
 13171         IF DTE-CLIENT NOT = 'MIC'
 13172             COMPUTE RWF-DIS-IBNRL = (RW-AHIBNRWK *
 13173                         RWF-AHAMT) / CR-AHAMT
 13174             COMPUTE RWF-DIS-PAYCURL = (RW-AHPAYCURWK *
 13175                         RWF-AHAMT) / CR-AHAMT
 13176             COMPUTE RWF-DIS-FUTRSVL = (RW-AHFUTRSVWK *
 13177                         RWF-AHAMT) / CR-AHAMT
 13178         ELSE
 13179             MOVE RW-AHIBNRWK         TO RWF-DIS-IBNRL
 13180             MOVE RW-AHPAYCURWK       TO RWF-DIS-PAYCURL
 13181             MOVE RW-AHFUTRSVWK       TO RWF-DIS-FUTRSVL.
 13182
 13183 3510-REINSURE-CALC-RESERVE-ADD.
 13184
 13185     ADD RWF-DTH-IBNRL   TO RWF-DTH-IBNR.
 13186     ADD RWF-DTH-PAYCURL TO RWF-DTH-PAYCUR.
 13187     ADD RWF-DTH-FUTRSVL TO RWF-DTH-FUTRSV.
 13188     ADD RWF-DIS-IBNRL   TO RWF-DIS-IBNR.
 13189     ADD RWF-DIS-PAYCURL TO RWF-DIS-PAYCUR.
 13190     ADD RWF-DIS-FUTRSVL TO RWF-DIS-FUTRSV.
 13191
 13192     IF DTE-CLIENT NOT = 'MIC'  AND  'MCC'
 13193         GO TO 3519-REINSURE-CALC-RESERVE-END.
 13194
 13195     IF CO-SUB = ZERO
 13196         GO TO 3519-REINSURE-CALC-RESERVE-END.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 257
* ECS010MO.cbl
 13197
 13198 3513-REIN-CHK-LF-RSRV-LIMIT.
 13199     IF RCT-LF-CLM-MAX (CO-SUB) = ZERO
 13200         GO TO 3515-REIN-CHK-AH-RSRV-LIMIT.
 13201
 13202     IF RWF-DTH-IBNR GREATER THAN RCT-LF-CLM-MAX (CO-SUB)
 13203         MOVE RCT-LF-CLM-MAX (CO-SUB) TO RWF-DTH-IBNR.
 13204
 13205     COMPUTE EXCESS-RESERVE = RCT-LF-CLM-MAX (CO-SUB) -
 13206                                      (RWF-LFCLM +
 13207                                       RWF-DTH-PAYCUR +
 13208                                       RWF-DTH-FUTRSV).
 13209
 13210     IF EXCESS-RESERVE NOT LESS THAN ZERO
 13211         GO TO 3515-REIN-CHK-AH-RSRV-LIMIT.
 13212
 13213     ADD EXCESS-RESERVE TO RWF-DTH-PAYCURL.
 13214
 13215     IF RWF-DTH-PAYCURL LESS THAN ZERO
 13216         ADD RWF-DTH-PAYCURL TO RWF-DTH-FUTRSVL
 13217         MOVE ZEROS TO RWF-DTH-PAYCURL.
 13218     IF RWF-DTH-FUTRSVL LESS THAN ZERO
 13219         MOVE ZEROS TO RWF-DTH-FUTRSVL.
 13220
 13221     ADD EXCESS-RESERVE TO RWF-DTH-PAYCUR.
 13222
 13223     IF RWF-DTH-PAYCUR LESS THAN ZERO
 13224         ADD RWF-DTH-PAYCUR TO RWF-DTH-FUTRSV
 13225         MOVE ZEROS TO RWF-DTH-PAYCUR.
 13226     IF RWF-DTH-FUTRSV LESS THAN ZERO
 13227         MOVE ZEROS TO RWF-DTH-FUTRSV.
 13228
 13229 3515-REIN-CHK-AH-RSRV-LIMIT.
 13230     IF RCT-AH-CLM-MAX (CO-SUB) = ZERO
 13231         GO TO 3519-REINSURE-CALC-RESERVE-END.
 13232
 13233     IF RWF-DIS-IBNR GREATER THAN RCT-AH-CLM-MAX (CO-SUB)
 13234         MOVE RCT-AH-CLM-MAX (CO-SUB) TO RWF-DIS-IBNR.
 13235
 13236     COMPUTE EXCESS-RESERVE = RCT-AH-CLM-MAX (CO-SUB) -
 13237                                      (RWF-AHCLM +
 13238                                       RWF-DIS-PAYCUR +
 13239                                       RWF-DIS-FUTRSV).
 13240
 13241     IF EXCESS-RESERVE NOT LESS THAN ZERO
 13242         GO TO 3519-REINSURE-CALC-RESERVE-END.
 13243
 13244     ADD EXCESS-RESERVE TO RWF-DIS-PAYCURL.
 13245
 13246     IF RWF-DIS-PAYCURL LESS THAN ZERO
 13247         ADD RWF-DIS-PAYCURL TO RWF-DIS-FUTRSVL
 13248         MOVE ZEROS TO RWF-DIS-PAYCURL.
 13249     IF RWF-DIS-FUTRSVL LESS THAN ZERO
 13250         MOVE ZEROS TO RWF-DIS-FUTRSVL.
 13251
 13252     ADD EXCESS-RESERVE TO RWF-DIS-PAYCUR.
 13253
 13254     IF RWF-DIS-PAYCUR LESS THAN ZERO
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 258
* ECS010MO.cbl
 13255         ADD RWF-DIS-PAYCUR TO RWF-DIS-FUTRSV
 13256         MOVE ZEROS TO RWF-DIS-PAYCUR.
 13257     IF RWF-DIS-FUTRSV LESS THAN ZERO
 13258         MOVE ZEROS TO RWF-DIS-FUTRSV.
 13259
 13260 3519-REINSURE-CALC-RESERVE-END.
 13261
 13262     IF +0 NOT = RWF-DTH-IBNR OR RWF-DTH-PAYCUR
 13263        OR RWF-DTH-FUTRSV
 13264         MOVE 'X' TO REIN-LF-FLG (SUB1).
 13265
 13266     IF +0 NOT = RWF-DIS-IBNR OR RWF-DIS-PAYCUR
 13267        OR RWF-DIS-FUTRSV
 13268         MOVE 'X' TO REIN-AH-FLG (SUB1).
 13269
 13270     GO TO 3540-CONT-REIN-CALC-RESERVE.
 13271
 13272 3520-REIN-REMAINDER-RSRV.
 13273
 13274     MOVE RW-LFIBNRWK   TO RWF-DTH-IBNRL.
 13275     MOVE RW-LFPAYCURWK TO RWF-DTH-PAYCURL.
 13276     MOVE RW-LFFUTRSVWK TO RWF-DTH-FUTRSVL.
 13277     MOVE RW-AHIBNRWK   TO RWF-DIS-IBNRL.
 13278     MOVE RW-AHPAYCURWK TO RWF-DIS-PAYCURL.
 13279     MOVE RW-AHFUTRSVWK TO RWF-DIS-FUTRSVL.
 13280
 13281     PERFORM 3530-REIN-SUB-RSRV
 13282         THRU 3539-REIN-SUB-RSRV-X
 13283             VARYING SUB2 FROM +1 BY +1 UNTIL SUB2 = SUB1.
 13284
 13285     GO TO 3510-REINSURE-CALC-RESERVE-ADD.
 13286
 13287 3530-REIN-SUB-RSRV.
 13288
 13289     SUBTRACT REIN-DTH-IBNRL (SUB2)   FROM RWF-DTH-IBNRL.
 13290     SUBTRACT REIN-DTH-PAYCURL (SUB2) FROM RWF-DTH-PAYCURL.
 13291     SUBTRACT REIN-DTH-FUTRSVL (SUB2) FROM RWF-DTH-FUTRSVL.
 13292     SUBTRACT REIN-DIS-IBNRL (SUB2)   FROM RWF-DIS-IBNRL.
 13293     SUBTRACT REIN-DIS-PAYCURL (SUB2) FROM RWF-DIS-PAYCURL.
 13294     SUBTRACT REIN-DIS-FUTRSVL (SUB2) FROM RWF-DIS-FUTRSVL.
 13295
 13296 3539-REIN-SUB-RSRV-X.
 13297     EXIT.
 13298
 13299 3540-CONT-REIN-CALC-RESERVE.
 13300
 13301     IF REIN-LF-AH-FLGS (SUB1) NOT = SPACES
 13302         MOVE 'X' TO REIN-BUS-FLAG.
 13303     MOVE RWF-FIELDS TO REIN-WORK-FLDS (SUB1).
 13304
 13305 3599-REINSURE-CALC-RESERVE-X.
 13306     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 259
* ECS010MO.cbl
 13308******************************************************************
 13309***       R E I N S U R A N C E   C A L C U L A T I O N S      ***
 13310******************************************************************
 13311
 13312*REINSURANCE-CALCULATIONS.
*13313                             COPY ECSRIRTN.
 13314******************************************************************04/30/98
 13315*                                                                *ECSRIRTN
 13316*                            ECSRIRTN                            *   LV012
 13317*                            VMOD=2.025.                         *ECSRIRTN
 13318*                                                                *ECSRIRTN
 13319******************************************************************ECSRIRTN
 13320******************************************************************
 13321*                   C H A N G E   L O G
 13322*
 13323* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
 13324*-----------------------------------------------------------------
 13325*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
 13326* EFFECTIVE    NUMBER
 13327*-----------------------------------------------------------------
 13328* 062703                   PEMA  ADD DCC CLIENT ID TO
 13329*                                SPECIAL CEDED CLAIM CALC
 13330* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
 13331* 052114  CR2014051900001  PEMA  ADD ROUNDING TO PREM TAX CALC
 13332                                                                  ECSRIRTN
 13333 REINSURE-CALC.                                                   ECSRIRTN
 13334                                                                  ECSRIRTN
 13335     MOVE RE-REI-COMP-NO (SUB1) TO REIN-COMP (SUB1).              ECSRIRTN
 13336     MOVE REIN-WORK-FLDS (SUB1) TO RWF-FIELDS.                    ECSRIRTN
 13337     MOVE RE-COMP-INFO (SUB1)   TO WT-COMP-INFO.                  ECSRIRTN
 13338     MOVE WT-REMAINING          TO RWF-REM-SW                     ECSRIRTN
 13339                                   REIN-REM-SW (SUB1).            ECSRIRTN
 13340                                                                  ECSRIRTN
 13341     MOVE ZEROS                 TO RWF-EP-STOP-DATE               ECSRIRTN
 13342                                   WS-RWF-EP-STOP-DATE-N             CL*12
 13343                                   REIN-EP-STOP-DATE (SUB1).      ECSRIRTN
 13344                                                                  ECSRIRTN
 13345     MOVE 'Y'                   TO RWF-LF-RUNOFF-SW               ECSRIRTN
 13346                                   REIN-LF-RUNOFF-SW (SUB1)       ECSRIRTN
 13347                                   RWF-AH-RUNOFF-SW               ECSRIRTN
 13348                                   REIN-AH-RUNOFF-SW (SUB1).      ECSRIRTN
 13349                                                                  ECSRIRTN
 13350     PERFORM REIN-FIND-CO-LOOP THRU FIND-REI-CO-EXIT              ECSRIRTN
 13351        VARYING CO-SUB FROM 1 BY 1 UNTIL                          ECSRIRTN
 13352          (RCT-REIN-CO (CO-SUB) = REIN-COMP (SUB1))  OR           ECSRIRTN
 13353          (CO-SUB GREATER REIN-CO-TABLE-ENT-CNT)     OR           ECSRIRTN
 13354          (RCT-REIN-CO (CO-SUB) = SPACES).                        ECSRIRTN
 13355                                                                  ECSRIRTN
 13356     IF (CO-SUB GREATER REIN-CO-TABLE-ENT-CNT)  OR                ECSRIRTN
 13357        (RCT-REIN-CO (CO-SUB) = SPACES)                           ECSRIRTN
 13358         GO TO CALC-CONTINUED.                                    ECSRIRTN
 13359                                                                  ECSRIRTN
 13360     MOVE RCT-EARNING-STOP-DT (CO-SUB) TO RWF-EP-STOP-DATE        ECSRIRTN
 13361                                          WS-RWF-EP-STOP-DATE-N      CL*12
 13362                                          REIN-EP-STOP-DATE (SUB1)ECSRIRTN
 13363                                                                  ECSRIRTN
 13364     IF RWF-EP-STOP-DATE = ZEROS                                  ECSRIRTN
 13365         GO TO CALC-CONTINUED.                                    ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 260
* ECS010MO.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 13366                                                                  ECSRIRTN
 13367     IF RCT-EARN-STOP-CODE (CO-SUB) = 'L'  OR  'B'                ECSRIRTN
 13368         MOVE 'N'               TO RWF-LF-RUNOFF-SW               ECSRIRTN
 13369                                   REIN-LF-RUNOFF-SW (SUB1).      ECSRIRTN
 13370                                                                  ECSRIRTN
 13371     IF RCT-EARN-STOP-CODE (CO-SUB) = 'A'  OR  'B'                ECSRIRTN
 13372         MOVE 'N'               TO RWF-AH-RUNOFF-SW               ECSRIRTN
 13373                                   REIN-AH-RUNOFF-SW (SUB1).      ECSRIRTN
 13374                                                                  ECSRIRTN
 13375 CALC-CONTINUED.                                                  ECSRIRTN
 13376                                                                  ECSRIRTN
 13377     COMPUTE RS-LIFE-BEN  = CR-LFAMT + CR-LFAMT-ALT.              ECSRIRTN
 13378     COMPUTE RS-LIFE-PREM = CR-LFPRM + CR-LFPRM-ALT.              ECSRIRTN
 13379                                                                  ECSRIRTN
 13380     IF RE-NSP-ST-CD-LF = ZEROS  OR  SPACES                       ECSRIRTN
 13381         COMPUTE RS-LP-CALC = CR-LFPRM-CALC + CR-LFPRM-CALC-ALT   ECSRIRTN
 13382     ELSE                                                         ECSRIRTN
 13383         MOVE CR-LF-NSP-PRM         TO RS-LP-CALC.                ECSRIRTN
 13384     MOVE RS-LP-CALC                TO REIN-CALCED-LIFE.          ECSRIRTN
 13385                                                                  ECSRIRTN
 13386     MOVE CR-AHAMT                  TO RS-AH-BEN.                 ECSRIRTN
 13387     MOVE CR-AHPRM                  TO RS-AH-PREM.                ECSRIRTN
 13388     IF RE-NSP-ST-CD-AH = ZEROS  OR  SPACES                       ECSRIRTN
 13389         MOVE CR-AHPRM-CALC         TO RS-AP-CALC                 ECSRIRTN
 13390     ELSE                                                         ECSRIRTN
 13391         MOVE CR-AH-NSP-PRM         TO RS-AP-CALC.                ECSRIRTN
 13392     MOVE RS-AP-CALC                TO REIN-CALCED-AH.            ECSRIRTN
 13393                                                                  ECSRIRTN
 13394     IF WT-REMAINING = 'Y' OR 'Z' OR 'L' OR 'R'                   ECSRIRTN
 13395         MOVE RS-R-LB               TO RS-LIFE-BEN                ECSRIRTN
 13396         MOVE RS-R-LP               TO RS-LIFE-PREM               ECSRIRTN
 13397         MOVE RS-R-LPC              TO RS-LP-CALC                 ECSRIRTN
 13398         MOVE RS-R-AB               TO RS-AH-BEN                  ECSRIRTN
 13399         MOVE RS-R-AP               TO RS-AH-PREM                 ECSRIRTN
 13400         MOVE RS-R-APC              TO RS-AP-CALC.                ECSRIRTN
 13401                                                                  ECSRIRTN
 13402     IF SUB1 = RE-100-COMP                                        ECSRIRTN
 13403         GO TO REINSURE-CALC-REMAINDER.                           ECSRIRTN
 13404                                                                  ECSRIRTN
 13405     IF CR-DT LESS WT-LO-DATE                                        CL**2
 13406         GO TO REINSURE-CALC-X.                                   ECSRIRTN
 13407                                                                  ECSRIRTN
 13408     IF CR-DT NOT LESS WT-HI-DATE                                    CL**2
 13409         GO TO REINSURE-CALC-X.                                   ECSRIRTN
 13410                                                                  ECSRIRTN
 13411     PERFORM REINSURE-CK-LIFE      THRU REINSURE-CK-LIFE-X.       ECSRIRTN
 13412     PERFORM REINSURE-CK-AH        THRU REINSURE-CK-AH-X.         ECSRIRTN
 13413                                                                  ECSRIRTN
 13414     IF WT-INTERACTIVE = 'E'                                      ECSRIRTN
 13415         PERFORM REIN-CHECK-INTERACT-E THRU REIN-INTERACT-CHECK-X.ECSRIRTN
 13416                                                                  ECSRIRTN
 13417     IF WT-INTERACTIVE = 'X'                                      ECSRIRTN
 13418       IF  (REIN-LF-FLG (SUB1) = 'X' AND REIN-AH-FLG (SUB1) = 'X')ECSRIRTN
 13419        OR (REIN-LF-FLG (SUB1) = 'X' AND REIN-AH-FLG (SUB1) = ' ')ECSRIRTN
 13420        OR (REIN-LF-FLG (SUB1) = ' ' AND REIN-AH-FLG (SUB1) = 'X')ECSRIRTN
 13421           NEXT SENTENCE                                          ECSRIRTN
 13422       ELSE                                                       ECSRIRTN
 13423           MOVE 'Y' TO REIN-LF-FLG (SUB1)                         ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 261
* ECS010MO.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 13424                       REIN-AH-FLG (SUB1).                        ECSRIRTN
 13425                                                                  ECSRIRTN
 13426     IF WT-INTERACTIVE = 'Y'                                      ECSRIRTN
 13427         IF REIN-LF-FLG (SUB1) = 'X' AND                          ECSRIRTN
 13428            REIN-AH-FLG (SUB1) = 'Y'                              ECSRIRTN
 13429             MOVE 'X' TO REIN-AH-FLG (SUB1).                      ECSRIRTN
 13430                                                                  ECSRIRTN
 13431     IF WT-INTERACTIVE = 'Y'                                      ECSRIRTN
 13432         IF REIN-AH-FLG (SUB1) = 'X' AND                          ECSRIRTN
 13433            REIN-LF-FLG (SUB1) = 'Y'                              ECSRIRTN
 13434             MOVE 'X' TO REIN-LF-FLG (SUB1).                      ECSRIRTN
 13435                                                                  ECSRIRTN
 13436     IF WT-INTERACTIVE = 'Z'                                      ECSRIRTN
 13437         IF REIN-LF-FLG (SUB1) = 'X'                              ECSRIRTN
 13438             IF REIN-AH-FLG (SUB1) = 'Y'                          ECSRIRTN
 13439                 MOVE 'X' TO REIN-AH-FLG (SUB1)                   ECSRIRTN
 13440             ELSE                                                 ECSRIRTN
 13441                 NEXT SENTENCE                                    ECSRIRTN
 13442         ELSE                                                     ECSRIRTN
 13443             MOVE 'Y' TO REIN-LF-FLG (SUB1)                       ECSRIRTN
 13444                         REIN-AH-FLG (SUB1).                      ECSRIRTN
 13445                                                                  ECSRIRTN
 13446     IF WT-INTERACTIVE = 'W'                                      ECSRIRTN
 13447         IF REIN-AH-FLG (SUB1) = 'X'                              ECSRIRTN
 13448             IF REIN-LF-FLG (SUB1) = 'Y'                          ECSRIRTN
 13449                 MOVE 'X' TO REIN-LF-FLG (SUB1)                   ECSRIRTN
 13450             ELSE                                                 ECSRIRTN
 13451                 NEXT SENTENCE                                    ECSRIRTN
 13452         ELSE                                                     ECSRIRTN
 13453             MOVE 'Y' TO REIN-LF-FLG (SUB1)                       ECSRIRTN
 13454                         REIN-AH-FLG (SUB1).                      ECSRIRTN
 13455                                                                  ECSRIRTN
 13456     IF REIN-LF-FLG (SUB1) = 'X'                                  ECSRIRTN
 13457         PERFORM REIN-CALC-LIFE THRU REIN-CALC-LIFE-X.            ECSRIRTN
 13458                                                                  ECSRIRTN
 13459     IF REIN-LF-FLG (SUB1) = 'E'                                  ECSRIRTN
 13460         PERFORM REIN-LF-SKIP-LIMIT THRU REIN-CALC-LIFE-X         ECSRIRTN
 13461         MOVE 'X' TO REIN-LF-FLG (SUB1).                          ECSRIRTN
 13462                                                                  ECSRIRTN
 13463     IF REIN-AH-FLG (SUB1) = 'X'                                  ECSRIRTN
 13464         PERFORM REIN-CALC-AH THRU REIN-CALC-AH-X.                ECSRIRTN
 13465                                                                  ECSRIRTN
 13466     IF REIN-AH-FLG (SUB1) = 'E'                                  ECSRIRTN
 13467         PERFORM REIN-AH-SKIP-LIMIT THRU REIN-CALC-AH-X           ECSRIRTN
 13468         MOVE 'X'                TO  REIN-AH-FLG (SUB1).          ECSRIRTN
 13469                                                                  ECSRIRTN
 13470     IF REIN-LF-FLG (SUB1) NOT = 'X'                              ECSRIRTN
 13471         MOVE SPACE TO REIN-LF-FLG (SUB1).                        ECSRIRTN
 13472                                                                  ECSRIRTN
 13473     IF REIN-AH-FLG (SUB1) NOT = 'X'                              ECSRIRTN
 13474         MOVE SPACE TO REIN-AH-FLG (SUB1).                        ECSRIRTN
 13475                                                                  ECSRIRTN
 13476     GO TO REINSURE-CALC-X.                                       ECSRIRTN
 13477                                                                  ECSRIRTN
 13478 REINSURE-CK-LIFE.                                                ECSRIRTN
 13479                                                                  ECSRIRTN
 13480     IF CR-LFTYP = ZERO                                           ECSRIRTN
 13481         GO TO REINSURE-CK-LIFE-X.                                ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 262
* ECS010MO.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 13482                                                                  ECSRIRTN
 13483     IF WT-LF-PCT = ZERO                                          ECSRIRTN
 13484         GO TO REINSURE-CK-LIFE-X.                                ECSRIRTN
 13485                                                                  ECSRIRTN
 13486     IF DTE-CLIENT = 'CSO' OR 'CSI'                               ECSRIRTN
 13487         IF CLAS-I-REIN-YN (CLAS-INDEXL) = 'N'                    ECSRIRTN
 13488             GO TO REINSURE-CK-LIFE-X.                            ECSRIRTN
 13489                                                                  ECSRIRTN
 13490     MOVE WT-LF-BEN-CODE                TO REIN-BEN-CODE.         ECSRIRTN
 13491                                                                  ECSRIRTN
 13492     IF CEDING-PROPERTY-ONLY                                      ECSRIRTN
 13493         IF CLAS-I-CALC-TYPE (CLAS-INDEXL) NOT = '2'              ECSRIRTN
 13494             GO TO REINSURE-CK-LIFE-X                             ECSRIRTN
 13495         ELSE                                                     ECSRIRTN
 13496             NEXT SENTENCE                                        ECSRIRTN
 13497     ELSE                                                         ECSRIRTN
 13498         IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = '2'                  ECSRIRTN
 13499             GO TO REINSURE-CK-LIFE-X.                            ECSRIRTN
 13500                                                                  ECSRIRTN
 13501     IF CEDING-AD-D-ONLY                                          ECSRIRTN
 13502         IF CLAS-I-CALC-TYPE (CLAS-INDEXL) NOT = '4'              ECSRIRTN
 13503             GO TO REINSURE-CK-LIFE-X                             ECSRIRTN
 13504         ELSE                                                     ECSRIRTN
 13505             NEXT SENTENCE                                        ECSRIRTN
 13506     ELSE                                                         ECSRIRTN
 13507         IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = '4'                  ECSRIRTN
 13508             GO TO REINSURE-CK-LIFE-X.                            ECSRIRTN
 13509                                                                  ECSRIRTN
 13510     IF CEDING-SINGLE-PREM-ONLY                                   ECSRIRTN
 13511         IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'B'                  ECSRIRTN
 13512             GO TO REINSURE-CK-LIFE-X.                            ECSRIRTN
 13513                                                                  ECSRIRTN
 13514     IF CEDING-OUT-BALANCE-ONLY                                   ECSRIRTN
 13515         IF CLAS-I-CALC-TYPE (CLAS-INDEXL) NOT = 'B'              ECSRIRTN
 13516            GO TO REINSURE-CK-LIFE-X.                             ECSRIRTN
 13517                                                                  ECSRIRTN
 13518     IF CEDING-REDUCING-ONLY                                      ECSRIRTN
 13519         IF CLAS-I-RL-AH (CLAS-INDEXL) = 'L' OR 'P'               ECSRIRTN
 13520             GO TO REINSURE-CK-LIFE-X.                            ECSRIRTN
 13521                                                                  ECSRIRTN
 13522     IF CEDING-LEVEL-ONLY                                         ECSRIRTN
 13523         IF CLAS-I-RL-AH (CLAS-INDEXL) = 'R'                      ECSRIRTN
 13524            GO TO REINSURE-CK-LIFE-X.                             ECSRIRTN
 13525                                                                  ECSRIRTN
 13526     IF CEDING-GROUP-ONLY                                         ECSRIRTN
 13527         IF CR-IND-GRP NOT = '2'                                  ECSRIRTN
 13528             GO TO REINSURE-CK-LIFE-X.                            ECSRIRTN
 13529                                                                  ECSRIRTN
 13530     IF CEDING-GROUP-RED-LIFE-ONLY                                ECSRIRTN
 13531         IF (CR-IND-GRP = '1')  OR                                ECSRIRTN
 13532            (CLAS-I-RL-AH (CLAS-INDEXL) = 'L' OR 'P') OR          ECSRIRTN
 13533            (CR-AHTYP NOT = ZERO)                                 ECSRIRTN
 13534             GO TO REINSURE-CK-LIFE-X.                            ECSRIRTN
 13535                                                                  ECSRIRTN
 13536     IF CEDING-GROUP-REDUCING-ONLY                                ECSRIRTN
 13537         IF (CR-IND-GRP = '1')  OR                                ECSRIRTN
 13538            (CLAS-I-RL-AH (CLAS-INDEXL) = 'L' OR 'P')             ECSRIRTN
 13539             GO TO REINSURE-CK-LIFE-X.                            ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 263
* ECS010MO.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 13540                                                                  ECSRIRTN
 13541     IF CEDING-INDIVIDUAL-ONLY                                    ECSRIRTN
 13542         IF CR-IND-GRP NOT = '1'                                  ECSRIRTN
 13543             GO TO REINSURE-CK-LIFE-X.                            ECSRIRTN
 13544                                                                  ECSRIRTN
 13545     IF CEDING-JOINT-ONLY                                         ECSRIRTN
 13546         IF CLAS-I-JOINT (CLAS-INDEXL) NOT = 'J'                  ECSRIRTN
 13547             GO TO REINSURE-CK-LIFE-X.                            ECSRIRTN
 13548                                                                  ECSRIRTN
 13549     IF CEDING-SGL-PREM-REDUCING                                  ECSRIRTN
 13550        IF (CLAS-I-RL-AH (CLAS-INDEXL) = 'L' OR 'P')  OR          ECSRIRTN
 13551           CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'B'                   ECSRIRTN
 13552            GO TO REINSURE-CK-LIFE-X.                             ECSRIRTN
 13553                                                                  ECSRIRTN
 13554     IF CEDING-SGL-PREM-GROUP                                     ECSRIRTN
 13555         IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'B'  OR              ECSRIRTN
 13556            CR-IND-GRP = '1'                                      ECSRIRTN
 13557             GO TO REINSURE-CK-LIFE-X.                            ECSRIRTN
 13558                                                                  ECSRIRTN
 13559     IF CEDING-GROUP-LEVEL-ONLY                                   ECSRIRTN
 13560         IF CLAS-I-RL-AH (CLAS-INDEXL) = 'R'  OR                  ECSRIRTN
 13561            CR-IND-GRP = '1'                                      ECSRIRTN
 13562             GO TO REINSURE-CK-LIFE-X.                            ECSRIRTN
 13563                                                                  ECSRIRTN
 13564     IF CEDING-SGL-PREM-GRP-REDUCING                              ECSRIRTN
 13565         IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'B'  OR              ECSRIRTN
 13566            (CLAS-I-RL-AH (CLAS-INDEXL) = 'L' OR 'P')  OR         ECSRIRTN
 13567            CR-IND-GRP = '1'                                      ECSRIRTN
 13568             GO TO REINSURE-CK-LIFE-X.                            ECSRIRTN
 13569                                                                  ECSRIRTN
 13570     IF CEDING-SGL-PREM-GROUP-LEVEL                               ECSRIRTN
 13571         IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'B'  OR              ECSRIRTN
 13572            CLAS-I-RL-AH (CLAS-INDEXL) = 'R'  OR                  ECSRIRTN
 13573            CR-IND-GRP = '1'                                      ECSRIRTN
 13574             GO TO REINSURE-CK-LIFE-X.                            ECSRIRTN
 13575                                                                  ECSRIRTN
 13576     IF CEDING-SINGLE-POLICIES-ONLY                               ECSRIRTN
 13577         IF CLAS-I-JOINT (CLAS-INDEXL) = 'J'                      ECSRIRTN
 13578            GO TO REINSURE-CK-LIFE-X.                             ECSRIRTN
 13579                                                                  ECSRIRTN
 13580     IF DTE-CLIENT EQUAL 'NCL'                                    ECSRIRTN
 13581        MOVE 'Y'                 TO REIN-LF-FLG (SUB1).           ECSRIRTN
 13582                                                                  ECSRIRTN
 13583     IF CR-AGE LESS WT-LFAGE-LO                                   ECSRIRTN
 13584         GO TO REINSURE-CK-LIFE-X.                                ECSRIRTN
 13585                                                                  ECSRIRTN
 13586     IF CR-AGE GREATER WT-LFAGE-HI                                ECSRIRTN
 13587         GO TO REINSURE-CK-LIFE-X.                                ECSRIRTN
 13588                                                                  ECSRIRTN
 13589     IF CR-LF-TERM  NUMERIC                                       00002331
 13590        NEXT SENTENCE                                             00002332
 13591     ELSE                                                         00002333
 13592        MOVE ZEROS               TO CR-LF-TERM                    00002334
 13593     END-IF
 13594                                                                  00002335
 13595     IF CR-LF-TERM LESS WT-LFTRM-LO                               ECSRIRTN
 13596         GO TO REINSURE-CK-LIFE-X.                                ECSRIRTN
 13597                                                                  ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 264
* ECS010MO.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 13598     IF CR-LF-TERM GREATER WT-LFTRM-HI                            ECSRIRTN
 13599         GO TO REINSURE-CK-LIFE-X.                                ECSRIRTN
 13600                                                                  ECSRIRTN
 13601     MOVE 'Y' TO REIN-LF-FLG (SUB1).                              ECSRIRTN
 13602                                                                  ECSRIRTN
 13603     IF RS-LIFE-BEN NOT GREATER WT-LF-LIM-LO                      ECSRIRTN
 13604         GO TO REINSURE-CK-LIFE-X.                                ECSRIRTN
 13605                                                                  ECSRIRTN
 13606     IF RS-LIFE-BEN GREATER WT-LF-LIM-HI                          ECSRIRTN
 13607         GO TO REINSURE-CK-LIFE-X.                                ECSRIRTN
 13608                                                                  ECSRIRTN
 13609     MOVE 'X' TO REIN-LF-FLG (SUB1).                              ECSRIRTN
 13610                                                                  ECSRIRTN
 13611 REINSURE-CK-LIFE-X.                                              ECSRIRTN
 13612     EXIT.                                                        ECSRIRTN
 13613                                                                  ECSRIRTN
 13614 REINSURE-CK-AH.                                                  ECSRIRTN
 13615                                                                  ECSRIRTN
 13616     IF CR-AHTYP = ZERO                                           ECSRIRTN
 13617         GO TO REINSURE-CK-AH-X.                                  ECSRIRTN
 13618                                                                  ECSRIRTN
 13619     IF WT-AH-PCT = ZERO                                          ECSRIRTN
 13620         GO TO REINSURE-CK-AH-X.                                  ECSRIRTN
 13621                                                                  ECSRIRTN
 13622     IF DTE-CLIENT = 'CSO' OR 'CSI'                               ECSRIRTN
 13623         IF CLAS-I-REIN-YN (CLAS-INDEXA) = 'N'                    ECSRIRTN
 13624             GO TO REINSURE-CK-AH-X.                              ECSRIRTN
 13625                                                                  ECSRIRTN
 13626     MOVE WT-AH-BEN-CODE                TO REIN-BEN-CODE.         ECSRIRTN
 13627                                                                  ECSRIRTN
 13628     IF CEDING-UNEMPLOYMENT-ONLY                                  ECSRIRTN
 13629         IF CLAS-I-CALC-TYPE (CLAS-INDEXA) NOT = '3'              ECSRIRTN
 13630             GO TO REINSURE-CK-AH-X                               ECSRIRTN
 13631         ELSE                                                     ECSRIRTN
 13632             NEXT SENTENCE                                        ECSRIRTN
 13633     ELSE                                                         ECSRIRTN
 13634         IF CLAS-I-CALC-TYPE (CLAS-INDEXA) = '3'                  ECSRIRTN
 13635             GO TO REINSURE-CK-AH-X.                              ECSRIRTN
 13636                                                                  ECSRIRTN
 13637     IF CEDING-SINGLE-PREM-ONLY                                   ECSRIRTN
 13638         IF CLAS-I-CALC-TYPE (CLAS-INDEXA) = 'B'                  ECSRIRTN
 13639             GO TO REINSURE-CK-AH-X.                              ECSRIRTN
 13640                                                                  ECSRIRTN
 13641     IF CEDING-JOINT-ONLY                                         ECSRIRTN
 13642         IF CLAS-I-JOINT (CLAS-INDEXA) NOT = 'J'                  ECSRIRTN
 13643             GO TO REINSURE-CK-AH-X.                              ECSRIRTN
 13644                                                                  ECSRIRTN
 13645     IF CEDING-OUT-BALANCE-ONLY                                   ECSRIRTN
 13646         IF CLAS-I-CALC-TYPE (CLAS-INDEXA) NOT = 'B'              ECSRIRTN
 13647             GO TO REINSURE-CK-AH-X.                              ECSRIRTN
 13648                                                                  ECSRIRTN
 13649     IF CEDING-GROUP-ONLY                                         ECSRIRTN
 13650         IF CR-IND-GRP NOT = '2'                                  ECSRIRTN
 13651             GO TO REINSURE-CK-AH-X.                              ECSRIRTN
 13652                                                                  ECSRIRTN
 13653     IF CEDING-SGL-PREM-GROUP                                     ECSRIRTN
 13654         IF CLAS-I-CALC-TYPE (CLAS-INDEXA) = 'B'  OR              ECSRIRTN
 13655            CR-IND-GRP = '1'                                      ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 265
* ECS010MO.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 13656             GO TO REINSURE-CK-AH-X.                              ECSRIRTN
 13657                                                                  ECSRIRTN
 13658     IF CEDING-INDIVIDUAL-ONLY                                    ECSRIRTN
 13659         IF CR-IND-GRP NOT = '1'                                  ECSRIRTN
 13660             GO TO REINSURE-CK-AH-X.                              ECSRIRTN
 13661                                                                  ECSRIRTN
 13662     IF CEDING-SINGLE-POLICIES-ONLY                               ECSRIRTN
 13663         IF CLAS-I-JOINT (CLAS-INDEXA) = 'J'                      ECSRIRTN
 13664            GO TO REINSURE-CK-AH-X.                               ECSRIRTN
 13665                                                                  ECSRIRTN
 13666     IF CEDING-7-DAY-RETRO                                        ECSRIRTN
 13667         IF CLAS-I-AB3 (CLAS-INDEXA) NOT = (' 7R'  AND  '07R')    ECSRIRTN
 13668            GO TO REINSURE-CK-AH-X.                               ECSRIRTN
 13669                                                                  ECSRIRTN
 13670     IF CEDING-14-DAY-RETRO                                       ECSRIRTN
 13671         IF CLAS-I-AB3 (CLAS-INDEXA) NOT = '14R'                  ECSRIRTN
 13672             GO TO REINSURE-CK-AH-X.                              ECSRIRTN
 13673                                                                  ECSRIRTN
 13674     IF DTE-CLIENT EQUAL 'NCL'                                    ECSRIRTN
 13675        MOVE 'Y'                 TO REIN-AH-FLG (SUB1).           ECSRIRTN
 13676                                                                  ECSRIRTN
 13677     IF CR-AGE LESS WT-AHAGE-LO                                   ECSRIRTN
 13678         GO TO REINSURE-CK-AH-X.                                  ECSRIRTN
 13679                                                                  ECSRIRTN
 13680     IF CR-AGE GREATER WT-AHAGE-HI                                ECSRIRTN
 13681         GO TO REINSURE-CK-AH-X.                                  ECSRIRTN
 13682                                                                  ECSRIRTN
 13683     IF CR-AH-TERM  NUMERIC                                       00002331
 13684        NEXT SENTENCE                                             00002332
 13685     ELSE                                                         00002333
 13686        MOVE ZEROS               TO CR-AH-TERM                    00002334
 13687     END-IF
 13688                                                                  00002335
 13689     IF CR-AH-TERM LESS WT-AHTRM-LO                               ECSRIRTN
 13690         GO TO REINSURE-CK-AH-X.                                  ECSRIRTN
 13691                                                                  ECSRIRTN
 13692     IF CR-AH-TERM GREATER WT-AHTRM-HI                            ECSRIRTN
 13693         GO TO REINSURE-CK-AH-X.                                  ECSRIRTN
 13694                                                                  ECSRIRTN
 13695     MOVE 'Y' TO REIN-AH-FLG (SUB1).                              ECSRIRTN
 13696                                                                  ECSRIRTN
 13697     IF WT-AHBEN-LIM-LO = ZERO                                    ECSRIRTN
 13698         AND WT-AHBEN-LIM-HI = ZERO                               ECSRIRTN
 13699             MOVE +9999999.99 TO WT-AHBEN-LIM-LO                  ECSRIRTN
 13700                                 WT-AHBEN-LIM-HI.                 ECSRIRTN
 13701                                                                  ECSRIRTN
 13702     IF WT-AHMOA-LIM-LO = ZERO                                    ECSRIRTN
 13703         AND WT-AHMOA-LIM-HI = ZERO                               ECSRIRTN
 13704             MOVE +9999999.99 TO WT-AHMOA-LIM-LO                  ECSRIRTN
 13705                                 WT-AHMOA-LIM-HI.                 ECSRIRTN
 13706                                                                  ECSRIRTN
 13707     COMPUTE RW-AHLIM-LO = CR-AH-TERM * WT-AHMOA-LIM-LO.          ECSRIRTN
 13708     COMPUTE RW-AHLIM-HI = CR-AH-TERM * WT-AHMOA-LIM-HI.          ECSRIRTN
 13709                                                                  ECSRIRTN
 13710     IF RW-AHLIM-LO GREATER WT-AHBEN-LIM-LO                       ECSRIRTN
 13711         MOVE WT-AHBEN-LIM-LO TO RW-AHLIM-LO.                     ECSRIRTN
 13712                                                                  ECSRIRTN
 13713     IF RW-AHLIM-HI GREATER WT-AHBEN-LIM-HI                       ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 266
* ECS010MO.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 13714         MOVE WT-AHBEN-LIM-HI TO RW-AHLIM-HI.                     ECSRIRTN
 13715                                                                  ECSRIRTN
 13716     MOVE RW-AHLIM-LO TO RWF-AH-LIMIT.                            ECSRIRTN
 13717                                                                  ECSRIRTN
 13718     COMPUTE RW-AHWRK = RS-AH-BEN * CR-AH-TERM.                   ECSRIRTN
 13719                                                                  ECSRIRTN
 13720     IF RW-AHWRK NOT GREATER RW-AHLIM-LO                          ECSRIRTN
 13721         GO TO REINSURE-CK-AH-X.                                  ECSRIRTN
 13722                                                                  ECSRIRTN
 13723     IF RW-AHWRK GREATER RW-AHLIM-HI                              ECSRIRTN
 13724         GO TO REINSURE-CK-AH-X.                                  ECSRIRTN
 13725                                                                  ECSRIRTN
 13726     MOVE 'X' TO REIN-AH-FLG (SUB1).                              ECSRIRTN
 13727                                                                  ECSRIRTN
 13728 REINSURE-CK-AH-X.                                                ECSRIRTN
 13729     EXIT.                                                        ECSRIRTN
 13730                                                                  ECSRIRTN
 13731 REIN-CHECK-INTERACT-E.                                           ECSRIRTN
 13732                                                                  ECSRIRTN
 13733     IF RS-LIFE-BEN = ZERO  OR                                    ECSRIRTN
 13734        RS-AH-BEN = ZERO                                          ECSRIRTN
 13735         GO TO REIN-INTERACT-CHECK-X.                             ECSRIRTN
 13736                                                                  ECSRIRTN
 13737     IF REIN-LF-FLG (SUB1) NOT = 'X'  AND                         ECSRIRTN
 13738        REIN-AH-FLG (SUB1) NOT = 'X'                              ECSRIRTN
 13739         GO TO REIN-INTERACT-CHECK-X.                             ECSRIRTN
 13740                                                                  ECSRIRTN
 13741     MOVE 'X'                    TO REIN-LF-FLG (SUB1)            ECSRIRTN
 13742                                    REIN-AH-FLG (SUB1).           ECSRIRTN
 13743                                                                  ECSRIRTN
 13744     IF WT-AHBEN-LO = ZERO                                        ECSRIRTN
 13745         AND WT-AHBEN-HI = ZERO                                   ECSRIRTN
 13746             MOVE +9999999.99    TO  WT-AHBEN-LO                  ECSRIRTN
 13747                                     WT-AHBEN-HI.                 ECSRIRTN
 13748     IF WT-AHMOA-LO = ZERO                                        ECSRIRTN
 13749         AND WT-AHMOA-HI = ZERO                                   ECSRIRTN
 13750             MOVE +9999999.99    TO  WT-AHMOA-LO                  ECSRIRTN
 13751                                     WT-AHMOA-HI.                 ECSRIRTN
 13752                                                                  ECSRIRTN
 13753     COMPUTE RW-AHLIM-LO = CR-AH-TERM * WT-AHMOA-LO.              ECSRIRTN
 13754     COMPUTE RW-AHLIM-HI = CR-AH-TERM * WT-AHMOA-HI.              ECSRIRTN
 13755                                                                  ECSRIRTN
 13756     IF RW-AHLIM-LO GREATER WT-AHBEN-LO                           ECSRIRTN
 13757         MOVE WT-AHBEN-LO        TO  RW-AHLIM-LO.                 ECSRIRTN
 13758                                                                  ECSRIRTN
 13759     IF RW-AHLIM-HI GREATER WT-AHBEN-HI                           ECSRIRTN
 13760         MOVE WT-AHBEN-HI        TO  RW-AHLIM-HI.                 ECSRIRTN
 13761                                                                  ECSRIRTN
 13762     COMPUTE RW-AHWRK = RS-AH-BEN * CR-AH-TERM.                   ECSRIRTN
 13763                                                                  ECSRIRTN
 13764     IF RW-AHWRK GREATER RW-AHLIM-HI                              ECSRIRTN
 13765         MOVE RW-AHLIM-HI        TO  RW-AHWRK.                    ECSRIRTN
 13766                                                                  ECSRIRTN
 13767     IF RW-AHWRK GREATER RW-AHLIM-LO                              ECSRIRTN
 13768         COMPUTE RATE-WORK-A ROUNDED = (RW-AHWRK - RW-AHLIM-LO)   ECSRIRTN
 13769                                       / RW-AHWRK                 ECSRIRTN
 13770       ELSE                                                       ECSRIRTN
 13771         MOVE ZERO               TO RATE-WORK-A.                  ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 267
* ECS010MO.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 13772                                                                  ECSRIRTN
 13773     IF RS-LIFE-BEN GREATER WT-LF-LO                              ECSRIRTN
 13774         COMPUTE RATE-WORK-L ROUNDED = (RS-LIFE-BEN - WT-LF-LO)   ECSRIRTN
 13775                                       / RS-LIFE-BEN              ECSRIRTN
 13776       ELSE                                                       ECSRIRTN
 13777         MOVE ZERO               TO RATE-WORK-L.                  ECSRIRTN
 13778                                                                  ECSRIRTN
 13779     IF (RS-LIFE-BEN GREATER WT-LF-LO) AND                        ECSRIRTN
 13780        (RW-AHWRK NOT GREATER RW-AHLIM-LO)                        ECSRIRTN
 13781          MOVE 'E'               TO REIN-AH-FLG (SUB1)            ECSRIRTN
 13782          COMPUTE RWF-AHAMT ROUNDED = (RW-AHWRK * RATE-WORK-L)    ECSRIRTN
 13783                                      / CR-AH-TERM.               ECSRIRTN
 13784                                                                  ECSRIRTN
 13785     IF (RW-AHWRK GREATER RW-AHLIM-LO) AND                        ECSRIRTN
 13786        (RS-LIFE-BEN NOT GREATER WT-LF-LO)                        ECSRIRTN
 13787          MOVE 'E'               TO REIN-LF-FLG (SUB1)            ECSRIRTN
 13788          IF (RW-AHWRK - RW-AHLIM-LO) NOT GREATER RS-LIFE-BEN     ECSRIRTN
 13789               COMPUTE RWF-LFAMT = RW-AHWRK - RW-AHLIM-LO         ECSRIRTN
 13790            ELSE                                                  ECSRIRTN
 13791                MOVE RS-LIFE-BEN TO RWF-LFAMT.                    ECSRIRTN
 13792                                                                  ECSRIRTN
 13793     IF (RW-AHWRK GREATER RW-AHLIM-LO) AND                        ECSRIRTN
 13794        (RS-LIFE-BEN GREATER WT-LF-LO)                            ECSRIRTN
 13795        IF RATE-WORK-L GREATER RATE-WORK-A                        ECSRIRTN
 13796          MOVE 'E'               TO REIN-AH-FLG (SUB1)            ECSRIRTN
 13797          COMPUTE RWF-AHAMT ROUNDED = (RW-AHWRK * RATE-WORK-L)    ECSRIRTN
 13798                                      / CR-AH-TERM                ECSRIRTN
 13799         ELSE                                                     ECSRIRTN
 13800          MOVE 'E'               TO REIN-LF-FLG (SUB1)            ECSRIRTN
 13801          IF (RW-AHWRK - RW-AHLIM-LO) NOT GREATER RS-LIFE-BEN     ECSRIRTN
 13802               COMPUTE RWF-LFAMT = RW-AHWRK - RW-AHLIM-LO         ECSRIRTN
 13803            ELSE                                                  ECSRIRTN
 13804                MOVE RS-LIFE-BEN TO RWF-LFAMT.                    ECSRIRTN
 13805                                                                  ECSRIRTN
 13806 REIN-INTERACT-CHECK-X.                                           ECSRIRTN
 13807     EXIT.                                                        ECSRIRTN
 13808                                                                  ECSRIRTN
 13809                                                                  ECSRIRTN
 13810 REIN-CALC-LIFE.                                                  ECSRIRTN
 13811                                                                  ECSRIRTN
 13812     IF RS-LIFE-BEN NOT GREATER WT-LF-HI                          ECSRIRTN
 13813         MOVE RS-LIFE-BEN TO RWF-LFAMT                            ECSRIRTN
 13814     ELSE                                                         ECSRIRTN
 13815         MOVE WT-LF-HI TO RWF-LFAMT.                              ECSRIRTN
 13816                                                                  ECSRIRTN
 13817     IF RS-LIFE-BEN LESS WT-LF-LO                                 ECSRIRTN
 13818         MOVE +0 TO RWF-LFAMT                                     ECSRIRTN
 13819     ELSE                                                         ECSRIRTN
 13820         IF WT-REMAINING NOT = 'L'                                ECSRIRTN
 13821           IF RS-LIFE-BEN LESS THAN ZERO                          ECSRIRTN
 13822               COMPUTE RWF-LFAMT ROUNDED = WT-LF-PCT * RS-LIFE-BENECSRIRTN
 13823           ELSE                                                   ECSRIRTN
 13824               COMPUTE RWF-LFAMT ROUNDED = WT-LF-PCT *            ECSRIRTN
 13825                                          (RWF-LFAMT - WT-LF-LO). ECSRIRTN
 13826                                                                  ECSRIRTN
 13827 REIN-LF-SKIP-LIMIT.                                              ECSRIRTN
 13828                                                                  ECSRIRTN
 13829     MOVE +0 TO RW-LFPRM  RW-LFPRMC.                              ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 268
* ECS010MO.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 13830                                                                  ECSRIRTN
 13831     IF WT-REMAINING = 'I'                                        ECSRIRTN
 13832         GO TO REIN-CALC-LF-RISK-PREM.                            ECSRIRTN
 13833                                                                  ECSRIRTN
 13834     IF WT-REMAINING = 'L'                                        ECSRIRTN
 13835         COMPUTE RWF-LFPRM ROUNDED = RS-LIFE-PREM * WT-LF-PCT     ECSRIRTN
 13836         GO TO REIN-CALC-LIFE-X.                                  ECSRIRTN
 13837                                                                  ECSRIRTN
 13838     IF RS-LIFE-BEN NOT = ZERO                                    ECSRIRTN
 13839         COMPUTE RW-LFPRM ROUNDED = (RS-LIFE-PREM *               ECSRIRTN
 13840                   RWF-LFAMT) / RS-LIFE-BEN                       ECSRIRTN
 13841         COMPUTE RW-LFPRMC ROUNDED = (RS-LP-CALC *                ECSRIRTN
 13842                   RWF-LFAMT) / RS-LIFE-BEN                       ECSRIRTN
 13843     ELSE                                                         ECSRIRTN
 13844         IF WT-LF-LIM-LO = ZERO                                   ECSRIRTN
 13845             COMPUTE RW-LFPRM ROUNDED = RS-LIFE-PREM * WT-LF-PCT  ECSRIRTN
 13846             COMPUTE RW-LFPRMC ROUNDED = RS-LP-CALC * WT-LF-PCT.  ECSRIRTN
 13847                                                                  ECSRIRTN
 13848     IF ((WT-LF-QC = '1' OR '3') OR                                  CL**8
 13849         (WT-LF-QC = '2' AND                                         CL**8
 13850          PGM-SUB = +50  AND                                         CL**8
 13851          DTE-CLIENT = 'LAP'))                                       CL**8
 13852          MOVE RW-LFPRM TO RWF-LFPRM                                 CL**8
 13853     ELSE                                                         ECSRIRTN
 13854         MOVE RW-LFPRMC TO RWF-LFPRM.                             ECSRIRTN
 13855                                                                  ECSRIRTN
 13856     IF WT-REMAINING = 'Y' OR 'Z' OR 'X' OR 'N'                   ECSRIRTN
 13857         COMPUTE RS-R-LB = RS-R-LB - RWF-LFAMT                    ECSRIRTN
 13858         COMPUTE RS-R-LP = RS-R-LP - RW-LFPRM                     ECSRIRTN
 13859         COMPUTE RS-R-LPC = RS-R-LPC - RW-LFPRMC.                 ECSRIRTN
 13860                                                                  ECSRIRTN
 13861     GO TO REIN-CALC-LIFE-X.                                      ECSRIRTN
 13862                                                                  ECSRIRTN
 13863 REIN-CALC-LF-RISK-PREM.                                          ECSRIRTN
 13864                                                                  ECSRIRTN
 13865     IF RWF-LFAMT NOT GREATER THAN +0                             ECSRIRTN
 13866         MOVE ZEROS                 TO RWF-LFPRM                  ECSRIRTN
 13867         GO TO REIN-CALC-LIFE-X.                                  ECSRIRTN
 13868                                                                  ECSRIRTN
 13869     MOVE RWF-LFAMT                 TO REIN-RISK-AMOUNT.          ECSRIRTN
 13870     COMPUTE REIN-MONTH-REDUCE = RS-LIFE-BEN / CR-LF-TERM.        ECSRIRTN
 13871     MOVE +0                        TO REIN-WORKA                 ECSRIRTN
 13872                                       RW-LFPRM.                  ECSRIRTN
 13873                                                                  ECSRIRTN
 13874 REIN-LF-RISK-PREM-LOOP.                                          ECSRIRTN
 13875                                                                  ECSRIRTN
 13876     COMPUTE RW-LFPRM = RW-LFPRM +                                ECSRIRTN
 13877                ((REIN-RISK-AMOUNT / +1000) * CR-LF-NSP-PRM-RATE).ECSRIRTN
 13878                                                                  ECSRIRTN
 13879     IF CLAS-I-RL-AH (CLAS-INDEXL) NOT = 'L'                      ECSRIRTN
 13880        SUBTRACT REIN-MONTH-REDUCE FROM REIN-RISK-AMOUNT.         ECSRIRTN
 13881                                                                  ECSRIRTN
 13882     IF REIN-WORKA = REIN-EARN-LF-TERM  OR                        ECSRIRTN
 13883        REIN-RISK-AMOUNT LESS THAN +0                             ECSRIRTN
 13884         MOVE RW-LFPRM              TO RWF-LFPRM                  ECSRIRTN
 13885     ELSE                                                         ECSRIRTN
 13886         ADD +1 TO REIN-WORKA                                     ECSRIRTN
 13887         GO TO REIN-LF-RISK-PREM-LOOP.                            ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 269
* ECS010MO.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 13888                                                                  ECSRIRTN
 13889                                                                  ECSRIRTN
 13890 REIN-CALC-LIFE-X.                                                ECSRIRTN
 13891     EXIT.                                                        ECSRIRTN
 13892                                                                  ECSRIRTN
 13893 REIN-CALC-AH.                                                    ECSRIRTN
 13894                                                                  ECSRIRTN
 13895     IF WT-AHBEN-LO = ZERO                                        ECSRIRTN
 13896         AND WT-AHBEN-HI = ZERO                                   ECSRIRTN
 13897             MOVE +9999999.99 TO WT-AHBEN-LO                      ECSRIRTN
 13898                                 WT-AHBEN-HI.                     ECSRIRTN
 13899                                                                  ECSRIRTN
 13900     IF WT-AHMOA-LO = ZERO                                        ECSRIRTN
 13901         AND WT-AHMOA-HI = ZERO                                   ECSRIRTN
 13902             MOVE +9999999.99 TO WT-AHMOA-LO                      ECSRIRTN
 13903                                 WT-AHMOA-HI.                     ECSRIRTN
 13904                                                                  ECSRIRTN
 13905     COMPUTE RW-AHLIM-LO = CR-AH-TERM * WT-AHMOA-LO.              ECSRIRTN
 13906     COMPUTE RW-AHLIM-HI = CR-AH-TERM * WT-AHMOA-HI.              ECSRIRTN
 13907                                                                  ECSRIRTN
 13908     IF RW-AHLIM-LO GREATER WT-AHBEN-LO                           ECSRIRTN
 13909         MOVE WT-AHBEN-LO TO RW-AHLIM-LO.                         ECSRIRTN
 13910                                                                  ECSRIRTN
 13911     IF RW-AHLIM-HI GREATER WT-AHBEN-HI                           ECSRIRTN
 13912         MOVE WT-AHBEN-HI TO RW-AHLIM-HI.                         ECSRIRTN
 13913                                                                  ECSRIRTN
 13914     IF RW-AHWRK GREATER RW-AHLIM-HI                              ECSRIRTN
 13915         MOVE RW-AHLIM-HI TO RW-AHWRK.                            ECSRIRTN
 13916                                                                  ECSRIRTN
 13917     IF RW-AHWRK LESS RW-AHLIM-LO                                 ECSRIRTN
 13918         MOVE +0 TO RWF-AHAMT                                     ECSRIRTN
 13919     ELSE                                                         ECSRIRTN
 13920         IF WT-REMAINING = 'L'                                    ECSRIRTN
 13921             COMPUTE RWF-AHAMT ROUNDED = RW-AHWRK / CR-AH-TERM    ECSRIRTN
 13922         ELSE                                                     ECSRIRTN
 13923             COMPUTE RWF-AHAMT ROUNDED =                          ECSRIRTN
 13924             ((RW-AHWRK - RW-AHLIM-LO) / CR-AH-TERM) * WT-AH-PCT. ECSRIRTN
 13925                                                                  ECSRIRTN
 13926 REIN-AH-SKIP-LIMIT.                                              ECSRIRTN
 13927                                                                  ECSRIRTN
 13928     IF WT-REMAINING = 'I'                                        ECSRIRTN
 13929         GO TO REIN-CALC-AH-RISK-PREM.                            ECSRIRTN
 13930                                                                  ECSRIRTN
 13931     IF WT-REMAINING = 'L'                                        ECSRIRTN
 13932         COMPUTE RWF-AHPRM ROUNDED = RS-AH-PREM * WT-AH-PCT       ECSRIRTN
 13933         GO TO REIN-CALC-AH-X.                                    ECSRIRTN
 13934                                                                  ECSRIRTN
 13935     IF RS-AH-BEN NOT = ZERO                                      ECSRIRTN
 13936         COMPUTE RW-AHPRM ROUNDED = (RS-AH-PREM *                 ECSRIRTN
 13937                   RWF-AHAMT) / RS-AH-BEN                         ECSRIRTN
 13938         COMPUTE RW-AHPRMC ROUNDED = (RS-AP-CALC *                ECSRIRTN
 13939                   RWF-AHAMT) / RS-AH-BEN                         ECSRIRTN
 13940     ELSE                                                         ECSRIRTN
 13941         IF RW-AHLIM-LO = ZERO                                    ECSRIRTN
 13942             COMPUTE RW-AHPRM ROUNDED = RS-AH-PREM * WT-AH-PCT    ECSRIRTN
 13943             COMPUTE RW-AHPRMC ROUNDED = RS-AP-CALC * WT-AH-PCT.  ECSRIRTN
 13944                                                                  ECSRIRTN
 13945     IF ((WT-AH-QC = '1' OR '3') OR                                  CL**8
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 270
* ECS010MO.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 13946         (WT-AH-QC = '2' AND                                         CL**8
 13947          PGM-SUB = +50  AND                                         CL**8
 13948          DTE-CLIENT = 'LAP'))                                       CL**8
 13949         MOVE RW-AHPRM TO RWF-AHPRM                               ECSRIRTN
 13950     ELSE                                                         ECSRIRTN
 13951         MOVE RW-AHPRMC TO RWF-AHPRM.                             ECSRIRTN
 13952                                                                  ECSRIRTN
 13953     IF RE-NSP-ST-CD-AH = SPACES OR ZERO                          ECSRIRTN
 13954         IF (WT-REMAINING = 'Y' OR 'Z') AND (WT-AH-QC = '1')      ECSRIRTN
 13955            AND (RWF-AHAMT = RS-R-AB) AND (RWF-AHAMT NOT = +0)    ECSRIRTN
 13956                MOVE 'Y' TO RWF-REM-AH-100.                       ECSRIRTN
 13957                                                                  ECSRIRTN
 13958     IF WT-REMAINING = 'Y' OR 'Z' OR 'X' OR 'N'                   ECSRIRTN
 13959         COMPUTE RS-R-AB = RS-R-AB - RWF-AHAMT                    ECSRIRTN
 13960         COMPUTE RS-R-AP = RS-R-AP - RW-AHPRM                     ECSRIRTN
 13961         COMPUTE RS-R-APC = RS-R-APC - RW-AHPRMC.                 ECSRIRTN
 13962                                                                  ECSRIRTN
 13963     GO TO REIN-CALC-AH-X.                                        ECSRIRTN
 13964                                                                  ECSRIRTN
 13965 REIN-CALC-AH-RISK-PREM.                                          ECSRIRTN
 13966                                                                  ECSRIRTN
 13967     IF RWF-AHAMT NOT GREATER THAN +0                             ECSRIRTN
 13968         MOVE ZEROS                 TO RWF-AHPRM                  ECSRIRTN
 13969         GO TO REIN-CALC-AH-X.                                    ECSRIRTN
 13970                                                                  ECSRIRTN
 13971     COMPUTE REIN-RISK-AMOUNT = RWF-AHAMT * CR-AH-TERM.           ECSRIRTN
 13972     MOVE RS-AH-BEN              TO REIN-MONTH-REDUCE.            ECSRIRTN
 13973     MOVE +0                     TO REIN-WORKA                    ECSRIRTN
 13974                                    RW-AHPRM.                     ECSRIRTN
 13975                                                                  ECSRIRTN
 13976 REIN-AH-RISK-PREM-LOOP.                                          ECSRIRTN
 13977                                                                  ECSRIRTN
 13978     COMPUTE RW-AHPRM = RW-AHPRM +                                ECSRIRTN
 13979                ((REIN-RISK-AMOUNT / +1000) * CR-AH-NSP-PRM-RATE).ECSRIRTN
 13980                                                                  ECSRIRTN
 13981     SUBTRACT REIN-MONTH-REDUCE FROM REIN-RISK-AMOUNT.            ECSRIRTN
 13982                                                                  ECSRIRTN
 13983     IF REIN-WORKA = REIN-EARN-AH-TERM  OR                        ECSRIRTN
 13984        REIN-RISK-AMOUNT LESS THAN +0                             ECSRIRTN
 13985         MOVE RW-AHPRM          TO RWF-AHPRM                      ECSRIRTN
 13986     ELSE                                                         ECSRIRTN
 13987         ADD +1 TO REIN-WORKA                                     ECSRIRTN
 13988         GO TO REIN-AH-RISK-PREM-LOOP.                            ECSRIRTN
 13989                                                                  ECSRIRTN
 13990                                                                  ECSRIRTN
 13991 REIN-CALC-AH-X.                                                  ECSRIRTN
 13992     EXIT.                                                        ECSRIRTN
 13993                                                                  ECSRIRTN
 13994 REINSURE-CALC-REMAINDER.                                         ECSRIRTN
 13995                                                                  ECSRIRTN
 13996     COMPUTE RWF-LFAMT = CR-LFAMT + CR-LFAMT-ALT.                 ECSRIRTN
 13997     COMPUTE RWF-LFPRM = CR-LFPRM + CR-LFPRM-ALT.                 ECSRIRTN
 13998     MOVE CR-AHAMT TO RWF-AHAMT.                                  ECSRIRTN
 13999     MOVE CR-AHPRM TO RWF-AHPRM.                                  ECSRIRTN
 14000                                                                  ECSRIRTN
 14001     PERFORM REINSURE-SUBTRACT THRU REINSURE-SUBTRACT-X           ECSRIRTN
 14002         VARYING SUB2 FROM +1 BY +1 UNTIL SUB2 = SUB1.            ECSRIRTN
 14003                                                                  ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 271
* ECS010MO.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 14004     IF RWF-LFAMT NOT = ZEROS OR                                  ECSRIRTN
 14005        RWF-LFPRM NOT = ZEROS                                     ECSRIRTN
 14006           MOVE 'X' TO REIN-LF-FLG (SUB1).                        ECSRIRTN
 14007                                                                  ECSRIRTN
 14008     IF RWF-AHAMT NOT = ZEROS OR                                  ECSRIRTN
 14009        RWF-AHPRM NOT = ZEROS                                     ECSRIRTN
 14010           MOVE 'X' TO REIN-AH-FLG (SUB1).                        ECSRIRTN
 14011                                                                  ECSRIRTN
 14012 REINSURE-CALC-X.                                                 ECSRIRTN
 14013                                                                  ECSRIRTN
 14014     IF REIN-LF-AH-FLGS (SUB1) NOT = SPACES                       ECSRIRTN
 14015         MOVE 'X' TO REIN-BUS-FLAG.                               ECSRIRTN
 14016                                                                  ECSRIRTN
 14017     MOVE RWF-FIELDS TO REIN-WORK-FLDS (SUB1).                    ECSRIRTN
 14018                                                                  ECSRIRTN
 14019 REINSURE-SUBTRACT.                                               ECSRIRTN
 14020                                                                  ECSRIRTN
 14021     SUBTRACT REIN-LFAMT (SUB2) FROM RWF-LFAMT.                   ECSRIRTN
 14022     SUBTRACT REIN-LFPRM (SUB2) FROM RWF-LFPRM.                   ECSRIRTN
 14023     SUBTRACT REIN-AHAMT (SUB2) FROM RWF-AHAMT.                   ECSRIRTN
 14024     SUBTRACT REIN-AHPRM (SUB2) FROM RWF-AHPRM.                   ECSRIRTN
 14025                                                                  ECSRIRTN
 14026 REINSURE-SUBTRACT-X.                                             ECSRIRTN
 14027     EXIT.                                                        ECSRIRTN
 14028                                                                  ECSRIRTN
 14029 REINSURE-CALC-CANCEL.                                            ECSRIRTN
 14030                                                                  ECSRIRTN
 14031     MOVE REIN-WORK-FLDS (SUB1) TO RWF-FIELDS.                    ECSRIRTN
 14032     MOVE RE-COMP-INFO (SUB1) TO WT-COMP-INFO.                    ECSRIRTN
 14033                                                                  ECSRIRTN
 14034     IF SUB1 = RE-100-COMP                                        ECSRIRTN
 14035         GO TO REINSURE-REMAINDER-CANCEL.                         ECSRIRTN
 14036                                                                  ECSRIRTN
 14037     IF REIN-LF-FLG (SUB1) NOT = 'X'                              ECSRIRTN
 14038         GO TO REINSURE-CALC-CANCEL-AH.                           ECSRIRTN
 14039                                                                  ECSRIRTN
 14040     IF RWF-LF-RUNOFF-SW = 'N'                                    ECSRIRTN
 14041         IF CR-LF-CANC-DT NOT LESS THAN RWF-EP-STOP-DATE             CL**3
 14042             GO TO REINSURE-CALC-CANCEL-AH.                       ECSRIRTN
 14043                                                                  ECSRIRTN
 14044     IF WT-REMAINING = 'I'                                        ECSRIRTN
 14045         GO TO REINSURE-CALC-LF-RISK-CANCEL.                      ECSRIRTN
 14046                                                                  ECSRIRTN
 14047     IF WT-REMAINING = 'L'                                        ECSRIRTN
 14048         COMPUTE RWF-LFRFND ROUNDED = CR-LFRFND * WT-LF-PCT       ECSRIRTN
 14049         GO TO REINSURE-CALC-CANCEL-AH.                           ECSRIRTN
 14050                                                                  ECSRIRTN
 14051     IF CR-LFPRM = ZERO                                           ECSRIRTN
 14052        MOVE ZERO                TO REIN-FACTOR
 14053     ELSE                                                         ECSRIRTN
 14054        IF DTE-CLIENT = 'GIC'  AND
 14055           CLAS-I-BAL (CLAS-INDEXL) = 'B'
 14056           MOVE +1.0             TO REIN-FACTOR
 14057        ELSE
 14058           IF DTE-CLIENT = 'DCC'
 14059              COMPUTE REIN-FACTOR = CR-LFRFND /
 14060                 (CR-LFPRM + CR-LFPRM-ALT)
 14061           ELSE
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 272
* ECS010MO.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 14062              COMPUTE REIN-FACTOR ROUNDED =  CR-LFRFND-CALC /
 14063                 (CR-LFPRM + CR-LFPRM-ALT)
 14064            END-IF
 14065         END-IF
 14066     END-IF
 14067                                                                  ECSRIRTN
 14068     IF CR-LFAMT NOT = ZERO                                       ECSRIRTN
 14069         IF DTE-CLIENT = 'GTL'  OR  'UAL'  OR  'NCL'  OR  'CVL'   ECSRIRTN
 14070             IF WT-LF-QC = ('1' OR '4')                           ECSRIRTN
 14071                 COMPUTE RWF-LFRFND ROUNDED =  ((CR-LFRFND *      ECSRIRTN
 14072                         RWF-LFAMT) / (CR-LFAMT + CR-LFAMT-ALT))  ECSRIRTN
 14073             ELSE                                                 ECSRIRTN
 14074                 COMPUTE RWF-LFRFND =                             ECSRIRTN
 14075                            REIN-FACTOR * REIN-CALCED-LIFE        ECSRIRTN
 14076                 COMPUTE RWF-LFRFND ROUNDED =  ((RWF-LFRFND *     ECSRIRTN
 14077                         RWF-LFAMT) / (CR-LFAMT + CR-LFAMT-ALT))  ECSRIRTN
 14078         ELSE                                                     ECSRIRTN
 14079             IF WT-LF-QC = ('1' OR '4')                           ECSRIRTN
 14080                 compute rein-factor rounded =
 14081                    RWF-LFAMT / (CR-LFAMT + CR-LFAMT-ALT)
 14082                 COMPUTE RWF-LFRFND ROUNDED =  CR-LFRFND *
 14083                    rein-factor
 14084             ELSE                                                 ECSRIRTN
 14085*                COMPUTE RWF-LFRFND = REIN-FACTOR
 14086*                   * REIN-CALCED-LIFE *
 14087*                   (RWF-LFAMT / (CR-LFAMT + CR-LFAMT-ALT)).
 14088                 COMPUTE RWF-LFRFND =                             ECSRIRTN
 14089                            REIN-FACTOR * REIN-CALCED-LIFE        ECSRIRTN
 14090                 COMPUTE RWF-LFRFND ROUNDED =  (RWF-LFRFND *
 14091                        RWF-LFAMT) / (CR-LFAMT + CR-LFAMT-ALT).
 14092                                                                  ECSRIRTN
 14093     IF CR-LFAMT = ZERO                                           ECSRIRTN
 14094         IF WT-LF-LIM-LO = ZERO                                   ECSRIRTN
 14095             IF WT-LF-QC = ('1' OR '4')                           ECSRIRTN
 14096                 COMPUTE RWF-LFRFND ROUNDED =                     ECSRIRTN
 14097                       CR-LFRFND * WT-LF-PCT                      ECSRIRTN
 14098             ELSE                                                 ECSRIRTN
 14099                 COMPUTE RWF-LFRFND =                             ECSRIRTN
 14100                            REIN-FACTOR * REIN-CALCED-LIFE        ECSRIRTN
 14101                 COMPUTE RWF-LFRFND ROUNDED =                     ECSRIRTN
 14102                       RWF-LFRFND * WT-LF-PCT.                    ECSRIRTN
 14103                                                                  ECSRIRTN
 14104     GO TO REINSURE-CALC-CANCEL-AH.                               ECSRIRTN
 14105                                                                  ECSRIRTN
 14106                                                                  ECSRIRTN
 14107 REINSURE-CALC-LF-RISK-CANCEL.                                    ECSRIRTN
 14108                                                                  ECSRIRTN
 14109     IF RWF-LFAMT NOT GREATER THAN +0  OR                         ECSRIRTN
 14110       (CR-LF-CANC-DT = ZEROS)                                       CL*10
 14111         MOVE ZERO                    TO RWF-LFRFND               ECSRIRTN
 14112         GO TO REINSURE-CALC-CANCEL-AH.                           ECSRIRTN
 14113                                                                  ECSRIRTN
 14114     IF REIN-RT-SW NOT = 'X'                                      ECSRIRTN
 14115       IF VOIDING-LF-CANCEL                                       ECSRIRTN
 14116           COMPUTE RWF-LFRFND = RWF-LFRFND * (-1)                 ECSRIRTN
 14117           GO TO REINSURE-CALC-CANCEL-AH                          ECSRIRTN
 14118       ELSE                                                       ECSRIRTN
 14119           IF ADDITIONAL-LF-CANCEL                                ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 273
* ECS010MO.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 14120               GO TO REINSURE-CALC-CANCEL-AH.                     ECSRIRTN
 14121                                                                  ECSRIRTN
 14122     IF FLAT-CANCEL-LF                                            ECSRIRTN
 14123         MOVE RWF-LFPRM               TO RWF-LFRFND               ECSRIRTN
 14124         GO TO REINSURE-CALC-CANCEL-AH.                           ECSRIRTN
 14125                                                                  ECSRIRTN
 14126     IF REIN-EARN-LF-TERM = REIN-LCNC-EARN-TERM                   ECSRIRTN
 14127         MOVE ZERO                    TO RWF-LFRFND               ECSRIRTN
 14128         GO TO REINSURE-CALC-CANCEL-AH.                           ECSRIRTN
 14129                                                                  ECSRIRTN
 14130     MOVE RWF-LFAMT                   TO REIN-RISK-AMOUNT.        ECSRIRTN
 14131     COMPUTE REIN-MONTH-REDUCE = RS-LIFE-BEN / CR-LF-TERM.        ECSRIRTN
 14132     MOVE +0                          TO REIN-WORKA               ECSRIRTN
 14133                                         RW-LFRFND.               ECSRIRTN
 14134                                                                  ECSRIRTN
 14135 REINSURE-LF-RISK-CANCEL-LOOP.                                    ECSRIRTN
 14136                                                                  ECSRIRTN
 14137     COMPUTE RW-LFRFND = RW-LFRFND +                              ECSRIRTN
 14138                ((REIN-RISK-AMOUNT / +1000) * CR-LF-NSP-PRM-RATE).ECSRIRTN
 14139                                                                  ECSRIRTN
 14140     IF CLAS-I-RL-AH (CLAS-INDEXL) NOT = 'L'                      ECSRIRTN
 14141        SUBTRACT REIN-MONTH-REDUCE FROM REIN-RISK-AMOUNT.         ECSRIRTN
 14142                                                                  ECSRIRTN
 14143     IF REIN-WORKA = REIN-LCNC-EARN-TERM  OR                      ECSRIRTN
 14144        REIN-RISK-AMOUNT LESS THAN +0                             ECSRIRTN
 14145         COMPUTE RWF-LFRFND = RWF-LFPRM - RW-LFRFND               ECSRIRTN
 14146     ELSE                                                         ECSRIRTN
 14147         ADD +1 TO REIN-WORKA                                     ECSRIRTN
 14148         GO TO REINSURE-LF-RISK-CANCEL-LOOP.                      ECSRIRTN
 14149                                                                  ECSRIRTN
 14150                                                                  ECSRIRTN
 14151 REINSURE-CALC-CANCEL-AH.                                         ECSRIRTN
 14152                                                                  ECSRIRTN
 14153     IF REIN-AH-FLG (SUB1) NOT = 'X'                              ECSRIRTN
 14154         GO TO REINSURE-CALC-CANCEL-SKIP.                         ECSRIRTN
 14155                                                                  ECSRIRTN
 14156     IF RWF-AH-RUNOFF-SW = 'N'                                    ECSRIRTN
 14157         IF CR-AH-CANC-DT NOT LESS THAN RWF-EP-STOP-DATE             CL**4
 14158             GO TO REINSURE-CALC-CANCEL-SKIP.                     ECSRIRTN
 14159                                                                  ECSRIRTN
 14160     IF RWF-REM-AH-100 = 'Y'                                      ECSRIRTN
 14161         MOVE CR-AHRFND TO RWF-AHRFND                             ECSRIRTN
 14162         PERFORM REINSURE-SUB-REM-CANCEL THRU                     ECSRIRTN
 14163             REINSURE-SUB-REM-CANCEL-X                            ECSRIRTN
 14164                 VARYING SUB2 FROM +1 BY +1 UNTIL SUB2 = SUB1     ECSRIRTN
 14165         GO TO REINSURE-CALC-CANCEL-SKIP.                         ECSRIRTN
 14166                                                                  ECSRIRTN
 14167     IF WT-REMAINING = 'I'                                        ECSRIRTN
 14168         GO TO REINSURE-CALC-AH-RISK-CANCEL.                      ECSRIRTN
 14169                                                                  ECSRIRTN
 14170     IF WT-REMAINING = 'L'                                        ECSRIRTN
 14171         COMPUTE RWF-AHRFND ROUNDED = CR-AHRFND * WT-AH-PCT       ECSRIRTN
 14172         GO TO REINSURE-CALC-CANCEL-SKIP.                         ECSRIRTN
 14173                                                                  ECSRIRTN
 14174     IF CR-AHPRM = ZERO                                           ECSRIRTN
 14175        MOVE ZERO                TO REIN-FACTOR
 14176     ELSE
 14177        IF DTE-CLIENT = 'GIC'  AND
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 274
* ECS010MO.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 14178           CLAS-I-BAL (CLAS-INDEXA) = 'B'
 14179            MOVE +1.0            TO REIN-FACTOR
 14180        ELSE
 14181           IF DTE-CLIENT = 'DCC'
 14182              COMPUTE REIN-FACTOR =
 14183                 CR-AHRFND / CR-AHPRM
 14184           ELSE
 14185              COMPUTE REIN-FACTOR ROUNDED =
 14186                                CR-AHRFND-CALC / CR-AHPRM
 14187           END-IF
 14188        END-IF
 14189     END-IF
 14190
 14191     IF CR-AHAMT NOT = ZERO
 14192        IF (DTE-CLIENT = 'DCC')
 14193           AND (CLAS-I-REFUND-METHOD (CLAS-INDEXA) = 'D')
 14194           MOVE CR-AH-RFND-CLP   TO RWF-AHRFND
 14195        ELSE
 14196           IF WT-AH-QC = ('1' OR '4')
 14197              compute rein-factor rounded = rwf-ahamt / cr-ahamt
 14198              compute rwf-ahrfnd rounded =
 14199                 cr-ahrfnd * rein-factor
 14200           ELSE
 14201              COMPUTE RWF-AHRFND = REIN-FACTOR * REIN-CALCED-AH
 14202              COMPUTE RWF-AHRFND ROUNDED = (RWF-AHRFND *
 14203                       RWF-AHAMT) / CR-AHAMT
 14204           END-IF
 14205        END-IF
 14206     ELSE
 14207        IF RWF-AH-LIMIT = ZERO
 14208           IF WT-AH-QC = ('1' OR '4')
 14209              COMPUTE RWF-AHRFND ROUNDED =
 14210                       CR-AHRFND * WT-AH-PCT
 14211           ELSE
 14212              COMPUTE RWF-AHRFND =
 14213                            REIN-FACTOR * REIN-CALCED-AH
 14214              COMPUTE RWF-AHRFND ROUNDED =
 14215                       RWF-AHRFND * WT-AH-PCT
 14216           END-IF
 14217        END-IF
 14218     END-IF
 14219
 14220     GO TO REINSURE-CALC-CANCEL-SKIP.                             ECSRIRTN
 14221                                                                  ECSRIRTN
 14222                                                                  ECSRIRTN
 14223 REINSURE-CALC-AH-RISK-CANCEL.                                    ECSRIRTN
 14224                                                                  ECSRIRTN
 14225     IF RWF-AHAMT NOT GREATER THAN +0  OR                         ECSRIRTN
 14226       (CR-AH-CANC-DT = ZEROS)                                       CL*10
 14227         MOVE ZERO                    TO RWF-AHRFND               ECSRIRTN
 14228         GO TO REINSURE-CALC-CANCEL-SKIP.                         ECSRIRTN
 14229                                                                  ECSRIRTN
 14230     IF REIN-RT-SW NOT = 'X'                                      ECSRIRTN
 14231       IF VOIDING-AH-CANCEL                                       ECSRIRTN
 14232           COMPUTE RWF-AHRFND = RWF-AHRFND * (-1)                 ECSRIRTN
 14233           GO TO REINSURE-CALC-CANCEL-SKIP                        ECSRIRTN
 14234       ELSE                                                       ECSRIRTN
 14235           IF ADDITIONAL-AH-CANCEL                                ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 275
* ECS010MO.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 14236               GO TO REINSURE-CALC-CANCEL-SKIP.                   ECSRIRTN
 14237                                                                  ECSRIRTN
 14238     IF FLAT-CANCEL-AH                                            ECSRIRTN
 14239         MOVE RWF-AHPRM               TO RWF-AHRFND               ECSRIRTN
 14240         GO TO REINSURE-CALC-CANCEL-SKIP.                         ECSRIRTN
 14241                                                                  ECSRIRTN
 14242     IF REIN-EARN-AH-TERM = REIN-ACNC-EARN-TERM                   ECSRIRTN
 14243         MOVE ZERO                    TO RWF-AHRFND               ECSRIRTN
 14244         GO TO REINSURE-CALC-CANCEL-SKIP.                         ECSRIRTN
 14245                                                                  ECSRIRTN
 14246     MOVE RS-AH-BEN              TO REIN-MONTH-REDUCE.            ECSRIRTN
 14247     COMPUTE REIN-RISK-AMOUNT = RWF-AHAMT * CR-AH-TERM.           ECSRIRTN
 14248     MOVE +0                     TO REIN-WORKA                    ECSRIRTN
 14249                                    RW-AHRFND.                    ECSRIRTN
 14250                                                                  ECSRIRTN
 14251 REINSURE-AH-RISK-CANCEL-LOOP.                                    ECSRIRTN
 14252                                                                  ECSRIRTN
 14253     COMPUTE RW-AHRFND = RW-AHRFND +                              ECSRIRTN
 14254                ((REIN-RISK-AMOUNT / +1000) * CR-AH-NSP-PRM-RATE).ECSRIRTN
 14255                                                                  ECSRIRTN
 14256     SUBTRACT REIN-MONTH-REDUCE FROM REIN-RISK-AMOUNT.            ECSRIRTN
 14257                                                                  ECSRIRTN
 14258     IF REIN-WORKA = REIN-ACNC-EARN-TERM  OR                      ECSRIRTN
 14259        REIN-RISK-AMOUNT LESS THAN +0                             ECSRIRTN
 14260         COMPUTE RWF-AHRFND = RWF-AHPRM - RW-AHRFND               ECSRIRTN
 14261     ELSE                                                         ECSRIRTN
 14262         ADD +1 TO REIN-WORKA                                     ECSRIRTN
 14263         GO TO REINSURE-AH-RISK-CANCEL-LOOP.                      ECSRIRTN
 14264                                                                  ECSRIRTN
 14265                                                                  ECSRIRTN
 14266 REINSURE-CALC-CANCEL-SKIP.                                       ECSRIRTN
 14267                                                                  ECSRIRTN
 14268     IF RWF-LFRFND NOT = ZEROS                                    ECSRIRTN
 14269         MOVE 'X' TO REIN-LF-FLG (SUB1).                          ECSRIRTN
 14270                                                                  ECSRIRTN
 14271     IF RWF-AHRFND NOT = ZEROS                                    ECSRIRTN
 14272         MOVE 'X' TO REIN-AH-FLG (SUB1).                          ECSRIRTN
 14273                                                                  ECSRIRTN
 14274     GO TO REINSURE-CALC-CANCEL-X.                                ECSRIRTN
 14275                                                                  ECSRIRTN
 14276 REINSURE-REMAINDER-CANCEL.                                       ECSRIRTN
 14277                                                                  ECSRIRTN
 14278     MOVE CR-LFRFND TO RWF-LFRFND.                                ECSRIRTN
 14279     MOVE CR-AHRFND TO RWF-AHRFND.                                ECSRIRTN
 14280                                                                  ECSRIRTN
 14281     PERFORM REINSURE-SUBTRACT-CANCEL THRU                        ECSRIRTN
 14282         REINSURE-SUBTRACT-CANCEL-X                               ECSRIRTN
 14283             VARYING SUB2 FROM +1 BY +1 UNTIL SUB2 = SUB1.        ECSRIRTN
 14284                                                                  ECSRIRTN
 14285     IF RWF-LFRFND NOT = ZEROS                                    ECSRIRTN
 14286         MOVE 'X' TO REIN-LF-FLG (SUB1).                          ECSRIRTN
 14287                                                                  ECSRIRTN
 14288     IF RWF-AHRFND NOT = ZEROS                                    ECSRIRTN
 14289         MOVE 'X' TO REIN-AH-FLG (SUB1).                          ECSRIRTN
 14290                                                                  ECSRIRTN
 14291 REINSURE-CALC-CANCEL-X.                                          ECSRIRTN
 14292                                                                  ECSRIRTN
 14293     IF REIN-LF-AH-FLGS (SUB1) NOT = SPACES                       ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 276
* ECS010MO.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 14294         MOVE 'X' TO REIN-BUS-FLAG.                               ECSRIRTN
 14295                                                                  ECSRIRTN
 14296     MOVE RWF-FIELDS TO REIN-WORK-FLDS (SUB1).                    ECSRIRTN
 14297                                                                  ECSRIRTN
 14298 REINSURE-SUBTRACT-CANCEL.                                        ECSRIRTN
 14299                                                                  ECSRIRTN
 14300     SUBTRACT REIN-LFRFND (SUB2) FROM RWF-LFRFND.                 ECSRIRTN
 14301     SUBTRACT REIN-AHRFND (SUB2) FROM RWF-AHRFND.                 ECSRIRTN
 14302                                                                  ECSRIRTN
 14303 REINSURE-SUBTRACT-CANCEL-X.                                      ECSRIRTN
 14304     EXIT.                                                        ECSRIRTN
 14305                                                                  ECSRIRTN
 14306 REINSURE-SUB-REM-CANCEL.                                         ECSRIRTN
 14307                                                                  ECSRIRTN
 14308     IF REIN-REM-SW (SUB2) = 'Y' OR 'Z' OR 'X' OR 'N'             ECSRIRTN
 14309         SUBTRACT REIN-AHRFND (SUB2) FROM RWF-AHRFND.             ECSRIRTN
 14310                                                                  ECSRIRTN
 14311 REINSURE-SUB-REM-CANCEL-X.                                       ECSRIRTN
 14312     EXIT.                                                        ECSRIRTN
 14313                                                                  ECSRIRTN
 14314 REINSURE-CALC-CLAIM.                                             ECSRIRTN
 14315                                                                  ECSRIRTN
 14316     MOVE REIN-WORK-FLDS (SUB1) TO RWF-FIELDS.                    ECSRIRTN
 14317     MOVE RE-COMP-INFO (SUB1) TO WT-COMP-INFO.                    ECSRIRTN
 14318                                                                  ECSRIRTN
 14319     IF SUB1 = RE-100-COMP                                        ECSRIRTN
 14320         GO TO REINSURE-REMAINDER-CLAIM.                          ECSRIRTN
 14321                                                                  ECSRIRTN
 14322     PERFORM REIN-FIND-CO-LOOP THRU FIND-REI-CO-EXIT              ECSRIRTN
 14323        VARYING CO-SUB FROM 1 BY 1 UNTIL                          ECSRIRTN
 14324          (RCT-REIN-CO (CO-SUB) = REIN-COMP (SUB1))  OR           ECSRIRTN
 14325          (CO-SUB GREATER REIN-CO-TABLE-ENT-CNT)     OR           ECSRIRTN
 14326          (RCT-REIN-CO (CO-SUB) = SPACES).                        ECSRIRTN
 14327                                                                  ECSRIRTN
 14328     IF (CO-SUB GREATER REIN-CO-TABLE-ENT-CNT)  OR                ECSRIRTN
 14329        (RCT-REIN-CO (CO-SUB) = SPACES)                           ECSRIRTN
 14330          MOVE ZERO TO CO-SUB.                                    ECSRIRTN
 14331                                                                  ECSRIRTN
 14332     MOVE ZEROS                TO RWF-LFCLML                      ECSRIRTN
 14333                                  RWF-AHCLML.                     ECSRIRTN
 14334                                                                  ECSRIRTN
 14335     IF REIN-LF-FLG (SUB1) NOT = 'X'                              ECSRIRTN
 14336         GO TO REINSURE-CALC-CLAIM-AH.                            ECSRIRTN
 14337                                                                  ECSRIRTN
 14338     IF RW-LFCLMWK = ZEROS                                        ECSRIRTN
 14339         GO TO REINSURE-CALC-CLAIM-AH.                            ECSRIRTN
 14340                                                                  ECSRIRTN
 14341     IF CO-SUB NOT = ZERO                                         ECSRIRTN
 14342         IF RCT-CLM-CUTOFF-DT (CO-SUB) NOT = ZERO                 ECSRIRTN
 14343             IF CR-DTH-DT LESS RCT-CLM-CUTOFF-DT (CO-SUB)         ECSRIRTN
 14344                 GO TO REINSURE-CALC-CLAIM-AH.                    ECSRIRTN
 14345                                                                  ECSRIRTN
 14346     IF RWF-LF-RUNOFF-SW = 'N'                                    ECSRIRTN
 14347         IF CR-DTH-DT NOT LESS THAN RWF-EP-STOP-DATE                 CL**6
 14348                 GO TO REINSURE-CALC-CLAIM-AH.                    ECSRIRTN
 14349                                                                  ECSRIRTN
 14350     IF WT-REMAINING = 'I'                                        ECSRIRTN
 14351         GO TO REINSURE-CALC-LF-RISK-CLAIM.                       ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 277
* ECS010MO.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 14352                                                                  ECSRIRTN
 14353     IF WT-REMAINING = 'L'                                        ECSRIRTN
 14354         IF REIN-RT-SW = 'X'                                      ECSRIRTN
 14355             IF RW-LFCLMWK GREATER WT-LF-HI                       ECSRIRTN
 14356                 MOVE WT-LF-HI TO RWF-LFCLM                       ECSRIRTN
 14357             ELSE                                                 ECSRIRTN
 14358                 MOVE RW-LFCLMWK TO RWF-LFCLM                     ECSRIRTN
 14359         ELSE                                                     ECSRIRTN
 14360             IF (RW-LFCLMWK + RWF-LFCLM) GREATER WT-LF-HI         ECSRIRTN
 14361                 COMPUTE RWF-LFCLML = WT-LF-HI - RWF-LFCLM        ECSRIRTN
 14362                 MOVE WT-LF-HI TO RWF-LFCLM                       ECSRIRTN
 14363             ELSE                                                 ECSRIRTN
 14364                 MOVE RW-LFCLMWK TO RWF-LFCLML                    ECSRIRTN
 14365                 ADD RWF-LFCLML TO RWF-LFCLM.                     ECSRIRTN
 14366                                                                  ECSRIRTN
 14367     IF WT-REMAINING = 'L'                                        ECSRIRTN
 14368         GO TO REINSURE-CALC-CLAIM-AH.                            ECSRIRTN
 14369                                                                  ECSRIRTN
 14370     IF CR-LFAMT NOT = ZERO                                       ECSRIRTN
 14371         IF DTE-CLIENT = 'GTL'  OR  'UAL'  OR  'NCL'  OR  'CVL'   ECSRIRTN
 14372            OR 'DCC'
 14373             COMPUTE RWF-LFCLML ROUNDED =  ((RW-LFCLMWK *         ECSRIRTN
 14374                         RWF-LFAMT) / (CR-LFAMT + CR-LFAMT-ALT))  ECSRIRTN
 14375         ELSE                                                     ECSRIRTN
 14376             COMPUTE RWF-LFCLML ROUNDED =  RW-LFCLMWK *           ECSRIRTN
 14377                        (RWF-LFAMT / (CR-LFAMT + CR-LFAMT-ALT)).  ECSRIRTN
 14378                                                                  ECSRIRTN
 14379     IF CR-LFAMT = ZERO                                           ECSRIRTN
 14380         IF WT-LF-LIM-LO = ZERO                                   ECSRIRTN
 14381             COMPUTE RWF-LFCLML ROUNDED =                         ECSRIRTN
 14382                       RW-LFCLMWK * WT-LF-PCT.                    ECSRIRTN
 14383                                                                  ECSRIRTN
 14384     IF CO-SUB NOT = ZERO                                         ECSRIRTN
 14385         IF RCT-LF-CLM-PCT (CO-SUB) NOT = ZERO                    ECSRIRTN
 14386             COMPUTE RWF-LFCLML ROUNDED =                         ECSRIRTN
 14387                          RW-LFCLMWK * RCT-LF-CLM-PCT (CO-SUB).   ECSRIRTN
 14388                                                                  ECSRIRTN
 14389     IF CO-SUB NOT = ZERO                                         ECSRIRTN
 14390         IF RCT-LF-CLM-MAX (CO-SUB) NOT = ZERO                    ECSRIRTN
 14391             IF REIN-RT-SW = 'X'                                  ECSRIRTN
 14392               IF RWF-LFCLML GREATER RCT-LF-CLM-MAX (CO-SUB)      ECSRIRTN
 14393                     MOVE RCT-LF-CLM-MAX (CO-SUB) TO RWF-LFCLM    ECSRIRTN
 14394                      GO TO REINSURE-CALC-CLAIM-AH                ECSRIRTN
 14395                  ELSE                                            ECSRIRTN
 14396                     MOVE RWF-LFCLML TO RWF-LFCLM                 ECSRIRTN
 14397                      GO TO REINSURE-CALC-CLAIM-AH                ECSRIRTN
 14398              ELSE                                                ECSRIRTN
 14399                 IF (RWF-LFCLML + RWF-LFCLM) GREATER              ECSRIRTN
 14400                                           RCT-LF-CLM-MAX (CO-SUB)ECSRIRTN
 14401                     COMPUTE RWF-LFCLML =                         ECSRIRTN
 14402                               RCT-LF-CLM-MAX (CO-SUB) - RWF-LFCLMECSRIRTN
 14403                     MOVE RCT-LF-CLM-MAX (CO-SUB) TO RWF-LFCLM    ECSRIRTN
 14404                      GO TO REINSURE-CALC-CLAIM-AH.               ECSRIRTN
 14405                                                                  ECSRIRTN
 14406     ADD RWF-LFCLML TO RWF-LFCLM.                                 ECSRIRTN
 14407                                                                  ECSRIRTN
 14408     GO TO REINSURE-CALC-CLAIM-AH.                                ECSRIRTN
 14409                                                                  ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 278
* ECS010MO.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 14410                                                                  ECSRIRTN
 14411 REINSURE-CALC-LF-RISK-CLAIM.                                     ECSRIRTN
 14412                                                                  ECSRIRTN
 14413     IF RWF-LFAMT NOT GREATER THAN +0                             ECSRIRTN
 14414         GO TO REINSURE-CALC-CLAIM-AH.                            ECSRIRTN
 14415                                                                  ECSRIRTN
 14416     IF CLAS-I-RL-AH (CLAS-INDEXL) = 'L'                          ECSRIRTN
 14417         MOVE RWF-LFAMT                   TO REIN-RISK-AMOUNT     ECSRIRTN
 14418     ELSE                                                         ECSRIRTN
 14419         COMPUTE REIN-RISK-AMOUNT = RWF-LFAMT -                   ECSRIRTN
 14420                ((RS-LIFE-BEN / CR-LF-TERM) * REIN-LF-CLM-MONTHS).ECSRIRTN
 14421                                                                  ECSRIRTN
 14422     IF REIN-RISK-AMOUNT NOT GREATER THAN +0                      ECSRIRTN
 14423         GO TO REINSURE-CALC-CLAIM-AH.                            ECSRIRTN
 14424                                                                  ECSRIRTN
 14425     IF REIN-RT-SW = 'X'                                          ECSRIRTN
 14426         IF RW-LFCLMWK GREATER THAN REIN-RISK-AMOUNT              ECSRIRTN
 14427             MOVE REIN-RISK-AMOUNT        TO RWF-LFCLM            ECSRIRTN
 14428         ELSE                                                     ECSRIRTN
 14429             MOVE RW-LFCLMWK              TO RWF-LFCLM            ECSRIRTN
 14430     ELSE                                                         ECSRIRTN
 14431         IF (RW-LFCLMWK + RWF-LFCLM) GREATER THAN REIN-RISK-AMOUNTECSRIRTN
 14432             COMPUTE RWF-LFCLML = REIN-RISK-AMOUNT - RWF-LFCLM    ECSRIRTN
 14433             MOVE REIN-RISK-AMOUNT        TO RWF-LFCLM            ECSRIRTN
 14434         ELSE                                                     ECSRIRTN
 14435             MOVE RW-LFCLMWK              TO RWF-LFCLML           ECSRIRTN
 14436             ADD RW-LFCLMWK TO RWF-LFCLM.                         ECSRIRTN
 14437                                                                  ECSRIRTN
 14438                                                                  ECSRIRTN
 14439 REINSURE-CALC-CLAIM-AH.                                          ECSRIRTN
 14440                                                                  ECSRIRTN
 14441     IF REIN-AH-FLG (SUB1) NOT = 'X'                              ECSRIRTN
 14442         GO TO REINSURE-CALC-CLAIM-X.                             ECSRIRTN
 14443                                                                  ECSRIRTN
 14444     IF RW-AHCLMWK = ZEROS                                        ECSRIRTN
 14445         GO TO REINSURE-CALC-CLAIM-SKIP.                          ECSRIRTN
 14446                                                                  ECSRIRTN
 14447     IF REIN-RT-SW NOT = 'X'                                      ECSRIRTN
 14448         GO TO REINSURE-CALC-AH-DETAIL.                           ECSRIRTN
 14449                                                                  ECSRIRTN
 14450     MOVE CR-DISAB-INCURRED-DETAIL    TO RW-AH-INCURRED-DETAIL.   ECSRIRTN
 14451     MOVE ZEROS                       TO RW-AHCLMWK.              ECSRIRTN
 14452                                                                  ECSRIRTN
 14453     PERFORM CHECK-MULTIPLE-DISABILITIES THRU CHECK-DISABS-EXIT   ECSRIRTN
 14454             VARYING                                              ECSRIRTN
 14455         INC-SUB FROM +1 BY +1                                    ECSRIRTN
 14456             UNTIL                                                ECSRIRTN
 14457         INC-SUB GREATER THAN +5.                                 ECSRIRTN
 14458                                                                  ECSRIRTN
 14459     IF RW-AHCLMWK = ZEROS                                        ECSRIRTN
 14460         GO TO REINSURE-CALC-CLAIM-SKIP                           ECSRIRTN
 14461     ELSE                                                         ECSRIRTN
 14462         GO TO REINSURE-CALC-AH-CONTINUED.                        ECSRIRTN
 14463                                                                  ECSRIRTN
 14464 CHECK-MULTIPLE-DISABILITIES.                                     ECSRIRTN
 14465                                                                  ECSRIRTN
 14466     IF RW-AH-INCUR-DT (INC-SUB) = ZEROS                          ECSRIRTN
 14467         GO TO CHECK-DISABS-EXIT.                                 ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 279
* ECS010MO.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 14468                                                                  ECSRIRTN
 14469     IF CO-SUB NOT = ZERO                                         ECSRIRTN
 14470       IF RCT-CLM-CUTOFF-DT (CO-SUB) NOT = ZERO                   ECSRIRTN
 14471           IF RW-AH-INCUR-DT (INC-SUB) LESS THAN                  ECSRIRTN
 14472                       RCT-CLM-CUTOFF-DT (CO-SUB)                    CL**5
 14473               MOVE ZEROS             TO RW-AH-CLM-AMT (INC-SUB)  ECSRIRTN
 14474                                         RW-AH-CLM-EXP (INC-SUB)  ECSRIRTN
 14475               GO TO CHECK-DISABS-EXIT.                           ECSRIRTN
 14476                                                                  ECSRIRTN
 14477     IF RWF-AH-RUNOFF-SW = 'N'                                    ECSRIRTN
 14478       IF RW-AH-INCUR-DT (INC-SUB) NOT LESS THAN RWF-EP-STOP-DATE ECSRIRTN
 14479           MOVE ZEROS                 TO RW-AH-CLM-AMT (INC-SUB)  ECSRIRTN
 14480                                         RW-AH-CLM-EXP (INC-SUB)  ECSRIRTN
 14481           GO TO CHECK-DISABS-EXIT.                               ECSRIRTN
 14482                                                                  ECSRIRTN
 14483     IF WT-REMAINING NOT = 'I'                                    ECSRIRTN
 14484         COMPUTE RW-AHCLMWK = RW-AHCLMWK                          ECSRIRTN
 14485                             + RW-AH-CLM-AMT (INC-SUB)            ECSRIRTN
 14486                             + RW-AH-CLM-EXP (INC-SUB)            ECSRIRTN
 14487         GO TO CHECK-DISABS-EXIT.                                 ECSRIRTN
 14488                                                                  ECSRIRTN
 14489     IF RWF-AHAMT NOT GREATER THAN +0                             ECSRIRTN
 14490         GO TO CHECK-DISABS-EXIT.                                 ECSRIRTN
 14491                                                                  ECSRIRTN
 14492     IF INC-SUB = +1                                              ECSRIRTN
 14493         MOVE REIN-AH-CLM-MTH-1       TO REIN-AH-CLM-MONTHS.      ECSRIRTN
 14494     IF INC-SUB = +2                                              ECSRIRTN
 14495         MOVE REIN-AH-CLM-MTH-2       TO REIN-AH-CLM-MONTHS.      ECSRIRTN
 14496     IF INC-SUB = +3                                              ECSRIRTN
 14497         MOVE REIN-AH-CLM-MTH-3       TO REIN-AH-CLM-MONTHS.      ECSRIRTN
 14498     IF INC-SUB = +4                                              ECSRIRTN
 14499         MOVE REIN-AH-CLM-MTH-4       TO REIN-AH-CLM-MONTHS.      ECSRIRTN
 14500     IF INC-SUB = +5                                              ECSRIRTN
 14501         MOVE REIN-AH-CLM-MTH-5       TO REIN-AH-CLM-MONTHS.      ECSRIRTN
 14502                                                                  ECSRIRTN
 14503     COMPUTE REIN-RISK-AMOUNT = (RWF-AHAMT * CR-AH-TERM) -        ECSRIRTN
 14504                                (RS-AH-BEN * REIN-AH-CLM-MONTHS). ECSRIRTN
 14505                                                                  ECSRIRTN
 14506     IF REIN-RISK-AMOUNT NOT GREATER THAN +0                      ECSRIRTN
 14507         GO TO CHECK-DISABS-EXIT.                                 ECSRIRTN
 14508                                                                  ECSRIRTN
 14509     IF (RW-AH-CLM-AMT (INC-SUB) + RW-AH-CLM-EXP (INC-SUB))       ECSRIRTN
 14510              GREATER THAN REIN-RISK-AMOUNT                       ECSRIRTN
 14511         COMPUTE RW-AHCLMWK = RW-AHCLMWK + REIN-RISK-AMOUNT       ECSRIRTN
 14512     ELSE                                                         ECSRIRTN
 14513         COMPUTE RW-AHCLMWK = RW-AHCLMWK                          ECSRIRTN
 14514                             + RW-AH-CLM-AMT (INC-SUB)            ECSRIRTN
 14515                             + RW-AH-CLM-EXP (INC-SUB).           ECSRIRTN
 14516                                                                  ECSRIRTN
 14517 CHECK-DISABS-EXIT.                                               ECSRIRTN
 14518      EXIT.                                                       ECSRIRTN
 14519                                                                  ECSRIRTN
 14520 REINSURE-CALC-AH-DETAIL.                                         ECSRIRTN
 14521                                                                  ECSRIRTN
 14522     IF RW-AHCLMWK = ZEROS                                        ECSRIRTN
 14523         GO TO REINSURE-CALC-CLAIM-SKIP.                          ECSRIRTN
 14524                                                                  ECSRIRTN
 14525     IF CO-SUB NOT = ZERO                                         ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 280
* ECS010MO.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 14526         IF RCT-CLM-CUTOFF-DT (CO-SUB) NOT = ZERO                 ECSRIRTN
 14527             IF CR-DIS-DT LESS RCT-CLM-CUTOFF-DT (CO-SUB)            CL*11
 14528                 GO TO REINSURE-CALC-CLAIM-SKIP.                  ECSRIRTN
 14529                                                                  ECSRIRTN
 14530     IF RWF-AH-RUNOFF-SW = 'N'                                    ECSRIRTN
 14531         IF CR-DIS-DT NOT LESS THAN RWF-EP-STOP-DATE                 CL**6
 14532             GO TO REINSURE-CALC-CLAIM-SKIP.                      ECSRIRTN
 14533                                                                  ECSRIRTN
 14534 REINSURE-CALC-AH-CONTINUED.                                      ECSRIRTN
 14535                                                                  ECSRIRTN
 14536     IF RWF-REM-AH-100 = 'Y'                                      ECSRIRTN
 14537         MOVE RW-AHCLMWK TO RWF-AHCLML                            ECSRIRTN
 14538         PERFORM REINSURE-SUB-REM-CLAIM THRU                      ECSRIRTN
 14539             REINSURE-SUB-REM-CLAIM-X                             ECSRIRTN
 14540                 VARYING SUB2 FROM +1 BY +1 UNTIL SUB2 = SUB1     ECSRIRTN
 14541         ADD RWF-AHCLML TO RWF-AHCLM                              ECSRIRTN
 14542         GO TO REINSURE-CALC-CLAIM-SKIP.                          ECSRIRTN
 14543                                                                  ECSRIRTN
 14544     IF WT-REMAINING = 'I'                                        ECSRIRTN
 14545         GO TO REINSURE-CALC-AH-RISK-CLAIM.                       ECSRIRTN
 14546                                                                  ECSRIRTN
 14547     IF WT-REMAINING = 'L'                                        ECSRIRTN
 14548         IF REIN-RT-SW = 'X'                                      ECSRIRTN
 14549             IF RW-AHCLMWK GREATER WT-AHBEN-HI                    ECSRIRTN
 14550                 MOVE WT-AHBEN-HI TO RWF-AHCLM                    ECSRIRTN
 14551             ELSE                                                 ECSRIRTN
 14552                 MOVE RW-AHCLMWK TO RWF-AHCLM                     ECSRIRTN
 14553         ELSE                                                     ECSRIRTN
 14554             IF (RW-AHCLMWK + RWF-AHCLM) GREATER WT-AHBEN-HI      ECSRIRTN
 14555                 COMPUTE RWF-AHCLML = WT-AHBEN-HI - RWF-AHCLM     ECSRIRTN
 14556                 MOVE WT-AHBEN-HI TO RWF-AHCLM                    ECSRIRTN
 14557             ELSE                                                 ECSRIRTN
 14558                 MOVE RW-AHCLMWK TO RWF-AHCLML                    ECSRIRTN
 14559                 ADD RWF-AHCLML TO RWF-AHCLM.                     ECSRIRTN
 14560                                                                  ECSRIRTN
 14561     IF WT-REMAINING = 'L'                                        ECSRIRTN
 14562         GO TO REINSURE-CALC-CLAIM-SKIP.                          ECSRIRTN
 14563                                                                  ECSRIRTN
 14564     IF CR-AHAMT NOT = ZERO                                       ECSRIRTN
 14565         COMPUTE RWF-AHCLML ROUNDED = (RW-AHCLMWK *               ECSRIRTN
 14566                            RWF-AHAMT) / CR-AHAMT                 ECSRIRTN
 14567     ELSE                                                         ECSRIRTN
 14568         IF RWF-AH-LIMIT = ZERO                                   ECSRIRTN
 14569             COMPUTE RWF-AHCLML ROUNDED =                         ECSRIRTN
 14570                       RW-AHCLMWK * WT-AH-PCT.                    ECSRIRTN
 14571                                                                  ECSRIRTN
 14572     IF CO-SUB NOT = ZERO                                         ECSRIRTN
 14573         IF RCT-AH-CLM-PCT (CO-SUB) NOT = ZERO                    ECSRIRTN
 14574             COMPUTE RWF-AHCLML ROUNDED =                         ECSRIRTN
 14575                           RW-AHCLMWK * RCT-AH-CLM-PCT (CO-SUB).  ECSRIRTN
 14576                                                                  ECSRIRTN
 14577     IF CO-SUB NOT = ZERO                                         ECSRIRTN
 14578         IF RCT-AH-CLM-MAX (CO-SUB) NOT = ZERO                    ECSRIRTN
 14579             IF REIN-RT-SW = 'X'                                  ECSRIRTN
 14580               IF RWF-AHCLML GREATER RCT-AH-CLM-MAX (CO-SUB)      ECSRIRTN
 14581                     MOVE RCT-AH-CLM-MAX (CO-SUB) TO RWF-AHCLM    ECSRIRTN
 14582                      GO TO REINSURE-CALC-CLAIM-SKIP              ECSRIRTN
 14583                  ELSE                                            ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 281
* ECS010MO.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 14584                     MOVE RWF-AHCLML TO RWF-AHCLM                 ECSRIRTN
 14585                      GO TO REINSURE-CALC-CLAIM-SKIP              ECSRIRTN
 14586              ELSE                                                ECSRIRTN
 14587                 IF (RWF-AHCLML + RWF-AHCLM) GREATER              ECSRIRTN
 14588                                           RCT-AH-CLM-MAX (CO-SUB)ECSRIRTN
 14589                     COMPUTE RWF-AHCLML =                         ECSRIRTN
 14590                               RCT-AH-CLM-MAX (CO-SUB) - RWF-AHCLMECSRIRTN
 14591                     MOVE RCT-AH-CLM-MAX (CO-SUB) TO RWF-AHCLM    ECSRIRTN
 14592                      GO TO REINSURE-CALC-CLAIM-SKIP.             ECSRIRTN
 14593                                                                  ECSRIRTN
 14594                                                                  ECSRIRTN
 14595     IF DTE-CLIENT = 'FLA'                                        ECSRIRTN
 14596        IF REIN-COMP (SUB1) = ('200000' OR '210000' OR            ECSRIRTN
 14597                               '220000' OR '230000')              ECSRIRTN
 14598           PERFORM FLA-SPEC-REIN-CLMS THRU                        ECSRIRTN
 14599               E-FLA-SPEC-REIN-CLMS.                              ECSRIRTN
 14600                                                                  ECSRIRTN
 14601     ADD RWF-AHCLML TO RWF-AHCLM.                                 ECSRIRTN
 14602                                                                  ECSRIRTN
 14603     GO TO REINSURE-CALC-CLAIM-SKIP.                              ECSRIRTN
 14604                                                                  ECSRIRTN
 14605                                                                  ECSRIRTN
 14606 REINSURE-CALC-AH-RISK-CLAIM.                                     ECSRIRTN
 14607                                                                  ECSRIRTN
 14608     IF RWF-AHAMT NOT GREATER THAN +0                             ECSRIRTN
 14609         GO TO REINSURE-CALC-CLAIM-SKIP.                          ECSRIRTN
 14610                                                                  ECSRIRTN
 14611     IF REIN-RT-SW = 'X'                                          ECSRIRTN
 14612         MOVE RW-AHCLMWK              TO RWF-AHCLM                ECSRIRTN
 14613         GO TO REINSURE-CALC-CLAIM-SKIP.                          ECSRIRTN
 14614                                                                  ECSRIRTN
 14615     COMPUTE REIN-RISK-AMOUNT = (RWF-AHAMT * CR-AH-TERM) -        ECSRIRTN
 14616                                (RS-AH-BEN * REIN-AH-CLM-MONTHS). ECSRIRTN
 14617                                                                  ECSRIRTN
 14618     IF REIN-RISK-AMOUNT NOT GREATER THAN +0                      ECSRIRTN
 14619         GO TO REINSURE-CALC-CLAIM-SKIP.                          ECSRIRTN
 14620                                                                  ECSRIRTN
 14621     IF REIN-AH-PRIOR-CLMS-PAID GREATER THAN REIN-RISK-AMOUNT     ECSRIRTN
 14622         GO TO REINSURE-CALC-CLAIM-SKIP.                          ECSRIRTN
 14623                                                                  ECSRIRTN
 14624     IF (RW-AHCLMWK + REIN-AH-PRIOR-CLMS-PAID)                    ECSRIRTN
 14625                                GREATER THAN REIN-RISK-AMOUNT     ECSRIRTN
 14626         COMPUTE RWF-AHCLML = REIN-RISK-AMOUNT                    ECSRIRTN
 14627                             - REIN-AH-PRIOR-CLMS-PAID            ECSRIRTN
 14628         MOVE REIN-RISK-AMOUNT        TO RWF-AHCLM                ECSRIRTN
 14629     ELSE                                                         ECSRIRTN
 14630         MOVE RW-AHCLMWK              TO RWF-AHCLML               ECSRIRTN
 14631         ADD RW-AHCLMWK TO RWF-AHCLM.                             ECSRIRTN
 14632                                                                  ECSRIRTN
 14633                                                                  ECSRIRTN
 14634 REINSURE-CALC-CLAIM-SKIP.                                        ECSRIRTN
 14635                                                                  ECSRIRTN
 14636     IF RWF-LFCLM NOT = ZEROS                                     ECSRIRTN
 14637         MOVE 'X' TO REIN-LF-FLG (SUB1).                          ECSRIRTN
 14638                                                                  ECSRIRTN
 14639     IF RWF-AHCLM NOT = ZEROS                                     ECSRIRTN
 14640         MOVE 'X' TO REIN-AH-FLG (SUB1).                          ECSRIRTN
 14641                                                                  ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 282
* ECS010MO.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 14642     GO TO REINSURE-CALC-CLAIM-X.                                 ECSRIRTN
 14643                                                                  ECSRIRTN
 14644 REINSURE-REMAINDER-CLAIM.                                        ECSRIRTN
 14645                                                                  ECSRIRTN
 14646     MOVE RW-LFCLMWK TO RWF-LFCLML.                               ECSRIRTN
 14647     MOVE RW-AHCLMWK TO RWF-AHCLML.                               ECSRIRTN
 14648                                                                  ECSRIRTN
 14649     PERFORM REINSURE-SUBTRACT-CLAIM THRU                         ECSRIRTN
 14650         REINSURE-SUBTRACT-CLAIM-X                                ECSRIRTN
 14651             VARYING SUB2 FROM +1 BY +1 UNTIL SUB2 = SUB1.        ECSRIRTN
 14652                                                                  ECSRIRTN
 14653     ADD RWF-LFCLML TO RWF-LFCLM.                                 ECSRIRTN
 14654     ADD RWF-AHCLML TO RWF-AHCLM.                                 ECSRIRTN
 14655                                                                  ECSRIRTN
 14656     IF RWF-LFCLM NOT = ZEROS                                     ECSRIRTN
 14657         MOVE 'X' TO REIN-LF-FLG (SUB1).                          ECSRIRTN
 14658                                                                  ECSRIRTN
 14659     IF RWF-AHCLM NOT = ZEROS                                     ECSRIRTN
 14660         MOVE 'X' TO REIN-AH-FLG (SUB1).                          ECSRIRTN
 14661                                                                  ECSRIRTN
 14662 REINSURE-CALC-CLAIM-X.                                           ECSRIRTN
 14663                                                                  ECSRIRTN
 14664     IF REIN-LF-AH-FLGS (SUB1) NOT = SPACES                       ECSRIRTN
 14665         MOVE 'X' TO REIN-BUS-FLAG.                               ECSRIRTN
 14666                                                                  ECSRIRTN
 14667     MOVE RWF-FIELDS TO REIN-WORK-FLDS (SUB1).                    ECSRIRTN
 14668                                                                  ECSRIRTN
 14669 REINSURE-SUBTRACT-CLAIM.                                         ECSRIRTN
 14670                                                                  ECSRIRTN
 14671     SUBTRACT REIN-LFCLML (SUB2) FROM RWF-LFCLML.                 ECSRIRTN
 14672     SUBTRACT REIN-AHCLML (SUB2) FROM RWF-AHCLML.                 ECSRIRTN
 14673                                                                  ECSRIRTN
 14674 REINSURE-SUBTRACT-CLAIM-X.                                       ECSRIRTN
 14675     EXIT.                                                        ECSRIRTN
 14676                                                                  ECSRIRTN
 14677 REINSURE-SUB-REM-CLAIM.                                          ECSRIRTN
 14678                                                                  ECSRIRTN
 14679     IF REIN-REM-SW (SUB2) = 'Y' OR 'Z' OR 'X' OR 'N'             ECSRIRTN
 14680         SUBTRACT REIN-AHCLML (SUB2) FROM RWF-AHCLML.             ECSRIRTN
 14681                                                                  ECSRIRTN
 14682 REINSURE-SUB-REM-CLAIM-X.                                        ECSRIRTN
 14683     EXIT.                                                        ECSRIRTN
 14684                                                                  ECSRIRTN
 14685                                                                  ECSRIRTN
 14686 CLEAR-REIN-HOLD.                                                 ECSRIRTN
 14687                                                                  ECSRIRTN
 14688     MOVE SPACES TO REIN-COMP (1).                                ECSRIRTN
 14689     MOVE SPACES TO REIN-LF-AH-FLGS (1).                          ECSRIRTN
 14690     MOVE SPACES TO REIN-REM-SW (1).                              ECSRIRTN
 14691     MOVE SPACES TO REIN-REM-AH-100 (1).                          ECSRIRTN
 14692                                                                  ECSRIRTN
 14693     MOVE +0 TO REIN-LFAMT (1)  REIN-LFPRM (1)  REIN-AHAMT (1)    ECSRIRTN
 14694         REIN-AHPRM (1)  REIN-LFRFND (1)  REIN-AHRFND (1)         ECSRIRTN
 14695         REIN-LFCLM (1)  REIN-AHCLM (1)  REIN-LFCLML (1)          ECSRIRTN
 14696         REIN-AHCLML (1)  REIN-DIS-IBNR (1)  REIN-DIS-PAYCUR (1)  ECSRIRTN
 14697         REIN-DIS-FUTRSV (1)  REIN-DTH-IBNR (1)                   ECSRIRTN
 14698         REIN-DTH-PAYCUR (1)  REIN-DTH-FUTRSV (1)                 ECSRIRTN
 14699         REIN-DIS-IBNRL (1)  REIN-DIS-PAYCURL (1)                 ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 283
* ECS010MO.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 14700         REIN-DIS-FUTRSVL (1)  REIN-DTH-IBNRL (1)                 ECSRIRTN
 14701         REIN-DTH-PAYCURL (1)  REIN-DTH-FUTRSVL (1)               ECSRIRTN
 14702         REIN-AH-LIMIT (1).                                       ECSRIRTN
 14703                                                                  ECSRIRTN
 14704     PERFORM CLEAR-REIN-HOLD-ALL VARYING SUB1 FROM 2 BY 1         ECSRIRTN
 14705         UNTIL REIN-COMP (SUB1) = SPACES.                         ECSRIRTN
 14706                                                                  ECSRIRTN
 14707     GO TO CLEAR-REIN-HOLD-X.                                     ECSRIRTN
 14708                                                                  ECSRIRTN
 14709 CLEAR-REIN-HOLD-ALL.                                             ECSRIRTN
 14710                                                                  ECSRIRTN
 14711     MOVE REIN-LEVELS (1) TO REIN-LEVELS (SUB1).                  ECSRIRTN
 14712                                                                  ECSRIRTN
 14713 CLEAR-REIN-HOLD-X.                                               ECSRIRTN
 14714     EXIT.                                                        ECSRIRTN
 14715                                                                  ECSRIRTN
 14716 FLA-SPEC-REIN-CLMS.                                              ECSRIRTN
 14717                                                                  ECSRIRTN
 14718     MOVE +250.00 TO FLA-CLM-REIN-BASE  ADJ-FLA-REIN-BASE.        ECSRIRTN
 14719                                                                  ECSRIRTN
 14720     IF REIN-COMP (SUB1) = '230000'                               ECSRIRTN
 14721         MOVE +100.00 TO FLA-CLM-REIN-BASE  ADJ-FLA-REIN-BASE.    ECSRIRTN
 14722                                                                  ECSRIRTN
 14723     IF CR-AHAMT NOT = ZERO                                       ECSRIRTN
 14724         COMPUTE ADJ-FLA-REIN-BASE ROUNDED =                      ECSRIRTN
 14725             (RW-AHCLMWK / CR-AHAMT) * FLA-CLM-REIN-BASE.         ECSRIRTN
 14726                                                                  ECSRIRTN
 14727     IF REIN-RT-SW = 'X'                                          ECSRIRTN
 14728         MOVE CR-DIS-CC TO CIRD-CC                                ECSRIRTN
 14729         MOVE CR-DIS-YR TO CIRD-YR                                ECSRIRTN
 14730         MOVE CR-DIS-MO TO CIRD-MO                                ECSRIRTN
 14731     ELSE                                                         ECSRIRTN
 14732         MOVE DTO-CC    TO CIRD-CC                                ECSRIRTN
 14733         MOVE DTO-YR    TO CIRD-YR                                ECSRIRTN
 14734         MOVE DTO-MO    TO CIRD-MO.                               ECSRIRTN
 14735                                                                  ECSRIRTN
 14736     MOVE ZEROS TO RWF-AHCLML.                                    ECSRIRTN
 14737                                                                  ECSRIRTN
 14738     IF CLM-INCUR-REIN-DATE LESS '197809'  AND                    ECSRIRTN
 14739        CR-AHAMT GREATER FLA-CLM-REIN-BASE                        ECSRIRTN
 14740         COMPUTE RWF-AHCLML = RW-AHCLMWK - ADJ-FLA-REIN-BASE.     ECSRIRTN
 14741                                                                  ECSRIRTN
 14742     IF CLM-INCUR-REIN-DATE GREATER '197806'                      ECSRIRTN
 14743         COMPUTE RWF-AHCLML = RWF-AHCLML + (RW-AHCLMWK * +.9).    ECSRIRTN
 14744                                                                  ECSRIRTN
 14745 E-FLA-SPEC-REIN-CLMS.                                            ECSRIRTN
 14746     EXIT.                                                        ECSRIRTN
 14747                                                                  ECSRIRTN
 14748 REIN-FIND-CO-LOOP.                                               ECSRIRTN
 14749                                                                  ECSRIRTN
 14750     CONTINUE.                                                    ECSRIRTN
 14751*  DUMMY PARAGRAPH - NO CODE NEEDED.                              ECSRIRTN
 14752 FIND-REI-CO-EXIT.                                                ECSRIRTN
 14753     EXIT.                                                        ECSRIRTN
 14754                                                                  ECSRIRTN
 14755 REIN-CO-TABLE-BUILD.                                             ECSRIRTN
 14756                                                                  ECSRIRTN
 14757     PERFORM ZERO-RCT-ENTRIES THRU ZERO-RCT-EXIT                  ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 284
* ECS010MO.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 14758         VARYING CO-SUB FROM 1 BY 1                               ECSRIRTN
 14759                   UNTIL CO-SUB GREATER REIN-CO-TABLE-ENT-CNT.    ECSRIRTN
 14760                                                                  ECSRIRTN
 14761     PERFORM ZERO-RC2-ENTRIES THRU ZERO-RC2-EXIT                  ECSRIRTN
 14762         VARYING CO-SUB FROM 1 BY 1                               ECSRIRTN
 14763                   UNTIL CO-SUB GREATER REIN-CO-TABLE-ENT-CNT.    ECSRIRTN
 14764                                                                  ECSRIRTN
 14765     MOVE LOW-VALUES          TO RE-CONTROL-PRIMARY.              ECSRIRTN
 14766                                                                  ECSRIRTN
 14767     START ERRTBL-IN                                              ECSRIRTN
 14768           KEY IS GREATER THAN RE-CONTROL-PRIMARY                 ECSRIRTN
 14769             INVALID KEY                                          ECSRIRTN
 14770               GO TO REIN-BUILD-EXIT.                             ECSRIRTN
 14771                                                                  ECSRIRTN
 14772     MOVE 0 TO CO-SUB.                                            ECSRIRTN
 14773     MOVE 0 TO SUB1.                                              ECSRIRTN
 14774 REIN-CO-BUILD-LOOP.                                              ECSRIRTN
 14775                                                                  ECSRIRTN
 14776     READ ERRTBL-IN  NEXT RECORD.                                 ECSRIRTN
 14777                                                                  ECSRIRTN
 14778     IF ERRTBL-FILE-STATUS = '10'                                 ECSRIRTN
 14779        GO TO REIN-BUILD-EXIT.                                    ECSRIRTN
 14780                                                                  ECSRIRTN
 14781     IF ERRTBL-FILE-STATUS NOT = ZERO                             ECSRIRTN
 14782        MOVE ERRTBL-FILE-STATUS TO WS-ABEND-FILE-STATUS           ECSRIRTN
 14783        MOVE 'READ ERROR ON FILE - ERRTBL'                        ECSRIRTN
 14784                                  TO WS-ABEND-MESSAGE             ECSRIRTN
 14785        GO TO ABEND-PGM.                                          ECSRIRTN
 14786                                                                  ECSRIRTN
 14787     IF RE-CODE NOT = 'B'                                         ECSRIRTN
 14788        GO TO REIN-CO-BUILD-LOOP.                                 ECSRIRTN
 14789                                                                  ECSRIRTN
 14790     IF RE-CLM-INCURRED-LIM NOT NUMERIC                           ECSRIRTN
 14791        MOVE ZERO TO RE-CLM-INCURRED-LIM.                         ECSRIRTN
 14792                                                                  ECSRIRTN
 14793     IF RE-EARNING-START-DT NOT NUMERIC                           ECSRIRTN
 14794        MOVE ZERO TO RE-EARNING-START-DT.                         ECSRIRTN
 14795                                                                  ECSRIRTN
 14796     IF RE-EARNING-STOP-DT NOT NUMERIC                            ECSRIRTN
 14797        MOVE ZERO TO RE-EARNING-STOP-DT.                          ECSRIRTN
 14798                                                                  ECSRIRTN
 14799     PERFORM VARYING CPSE-NDX FROM 1 BY 1 UNTIL CPSE-NDX > 1500   ECSRIRTN
 14800        MOVE RCT-CLM-CUTOFF-DT (CPSE-NDX)                         ECSRIRTN
*1118-E***************************************                         (   0)**
**    Index-name belongs to different table - unexpected behaviour may occur
 14801                        TO  WS-RCT-CLM-CUTOFF-DT-N (CPSE-NDX)        CL*12
 14802        MOVE RCT-EARNING-START-DT (CPSE-NDX)                      ECSRIRTN
*1118-E******************************************                      ( 284)**
**    Index-name belongs to different table - unexpected behaviour may occur
 14803                        TO  WS-RCT-EARNING-START-DT-N (CPSE-NDX)     CL*12
 14804        MOVE RCT-EARNING-STOP-DT (CPSE-NDX)                       ECSRIRTN
*1118-E*****************************************                       ( 284)**
**    Index-name belongs to different table - unexpected behaviour may occur
 14805                        TO  WS-RCT-EARNING-STOP-DT-N (CPSE-NDX)      CL*12
 14806     END-PERFORM.                                                 ECSRIRTN
 14807     MOVE RWF-EP-STOP-DATE       TO  WS-RWF-EP-STOP-DATE-N.          CL*12
 14808                                                                  ECSRIRTN
 14809     IF RE-LF-CLM-PCT NOT NUMERIC                                 ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 285
* ECS010MO.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 14810        MOVE ZERO TO RE-LF-CLM-PCT.                               ECSRIRTN
 14811                                                                  ECSRIRTN
 14812     IF RE-AH-CLM-PCT NOT NUMERIC                                 ECSRIRTN
 14813        MOVE ZERO TO RE-AH-CLM-PCT.                               ECSRIRTN
 14814                                                                  ECSRIRTN
 14815     IF RE-LF-CLM-MAX NOT NUMERIC                                 ECSRIRTN
 14816        MOVE ZERO TO RE-LF-CLM-MAX.                               ECSRIRTN
 14817                                                                  ECSRIRTN
 14818     IF RE-AH-CLM-MAX NOT NUMERIC                                 ECSRIRTN
 14819        MOVE ZERO TO RE-AH-CLM-MAX.                               ECSRIRTN
 14820                                                                  ECSRIRTN
 14821     IF (RE-AH-CLM-MAX = ZERO) AND                                ECSRIRTN
 14822        (RE-LF-CLM-MAX = ZERO) AND                                ECSRIRTN
 14823        (RE-AH-CLM-PCT = ZERO) AND                                ECSRIRTN
 14824        (RE-LF-CLM-PCT = ZERO) AND                                ECSRIRTN
 14825        (RE-CLM-INCURRED-LIM = ZERO) AND                          ECSRIRTN
 14826        (RE-EARNING-START-DT = ZERO) AND                          ECSRIRTN
 14827        (RE-EARNING-STOP-DT = ZERO)                               ECSRIRTN
 14828          GO TO REIN-CO-BUILD-EPR.                                ECSRIRTN
 14829                                                                  ECSRIRTN
 14830     ADD +1 TO CO-SUB.                                            ECSRIRTN
 14831                                                                  ECSRIRTN
 14832     IF CO-SUB GREATER REIN-CO-TABLE-ENT-CNT                      ECSRIRTN
 14833        MOVE 0202 TO WS-RETURN-CODE                               ECSRIRTN
 14834        DISPLAY 'REINSURANCE COMPANY SAVE TABLE EXCEEDED'         ECSRIRTN
 14835        DISPLAY 'ERROR DETECTED IN ECSRIRTN, SEE ECSRITAB'        ECSRIRTN
 14836        MOVE 'REINSURANCE COMPANY SAVE TABLE EXCEEDED'            ECSRIRTN
 14837                                  TO WS-ABEND-MESSAGE             ECSRIRTN
 14838        GO TO ABEND-PGM.                                          ECSRIRTN
 14839                                                                  ECSRIRTN
 14840     MOVE RE-COMPANY           TO RCT-REIN-CO (CO-SUB).              CL**7
 14841                                                                  ECSRIRTN
 14842     MOVE RE-CLM-INCURRED-LIM  TO RCT-CLM-CUTOFF-DT (CO-SUB)      ECSRIRTN
 14843                               WS-RCT-CLM-CUTOFF-DT-N (CO-SUB).      CL*12
 14844     MOVE RE-EARNING-START-DT  TO RCT-EARNING-START-DT (CO-SUB)   ECSRIRTN
 14845                               WS-RCT-EARNING-START-DT-N (CO-SUB).   CL*12
 14846     MOVE RE-EARNING-STOP-DT   TO RCT-EARNING-STOP-DT (CO-SUB)    ECSRIRTN
 14847                               WS-RCT-EARNING-STOP-DT-N (CO-SUB).    CL*12
 14848                                                                  ECSRIRTN
 14849     IF RE-EARN-STOP-CODE = 'A'  OR  'L'                          ECSRIRTN
 14850         MOVE RE-EARN-STOP-CODE  TO RCT-EARN-STOP-CODE (CO-SUB)   ECSRIRTN
 14851     ELSE                                                         ECSRIRTN
 14852         MOVE 'B'                TO RCT-EARN-STOP-CODE (CO-SUB).  ECSRIRTN
 14853                                                                  ECSRIRTN
 14854     MOVE RE-LF-CLM-PCT  TO RCT-LF-CLM-PCT (CO-SUB).              ECSRIRTN
 14855     MOVE RE-AH-CLM-PCT  TO RCT-AH-CLM-PCT (CO-SUB).              ECSRIRTN
 14856     MOVE RE-LF-CLM-MAX  TO RCT-LF-CLM-MAX (CO-SUB).              ECSRIRTN
 14857     MOVE RE-AH-CLM-MAX  TO RCT-AH-CLM-MAX (CO-SUB).              ECSRIRTN
 14858                                                                  ECSRIRTN
 14859 REIN-CO-BUILD-EPR.                                               ECSRIRTN
 14860                                                                  ECSRIRTN
 14861     IF RE-AH-PR-PCT  NOT NUMERIC                                 ECSRIRTN
 14862        MOVE ZERO TO RE-AH-PR-PCT.                                ECSRIRTN
 14863                                                                  ECSRIRTN
 14864     IF RE-AH-78-PCT  NOT NUMERIC                                 ECSRIRTN
 14865        MOVE ZERO TO RE-AH-78-PCT.                                ECSRIRTN
 14866                                                                  ECSRIRTN
 14867     IF RE-LF-PR-PCT  NOT NUMERIC                                 ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 286
* ECS010MO.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 14868        MOVE ZERO TO RE-LF-PR-PCT.                                ECSRIRTN
 14869                                                                  ECSRIRTN
 14870     IF RE-LF-78-PCT  NOT NUMERIC                                 ECSRIRTN
 14871        MOVE ZERO TO RE-LF-78-PCT.                                ECSRIRTN
 14872                                                                  ECSRIRTN
 14873     ADD +1 TO SUB1.                                              ECSRIRTN
 14874                                                                  ECSRIRTN
 14875     IF SUB1 GREATER REIN-CO-TABLE-ENT-CNT                        ECSRIRTN
 14876        MOVE 0201 TO WS-RETURN-CODE                               ECSRIRTN
 14877        MOVE 'REINSURANCE COMPANY SAVE TABLE EXCEEDED'            ECSRIRTN
 14878                                  TO WS-ABEND-MESSAGE             ECSRIRTN
 14879        GO TO ABEND-PGM.                                          ECSRIRTN
 14880                                                                  ECSRIRTN
 14881     MOVE RE-COMPANY     TO RC2-REIN-CO    (SUB1).                ECSRIRTN
 14882     MOVE RE-AH-PR-PCT   TO RC2-AH-PRO-PCT (SUB1).                ECSRIRTN
 14883     MOVE RE-AH-78-PCT   TO RC2-AH-R78-PCT (SUB1).                ECSRIRTN
 14884     MOVE RE-LF-PR-PCT   TO RC2-LF-PRO-PCT (SUB1).                ECSRIRTN
 14885     MOVE RE-LF-78-PCT   TO RC2-LF-R78-PCT (SUB1).                ECSRIRTN
 14886     MOVE RE-NAME        TO RC2-CO-NAME    (SUB1).                ECSRIRTN
 14887     if re-state-exhibit-opt-f = 'Y'
 14888        move 'Y'         to rc2-ecs152-rpt (sub1)
 14889     else
 14890        move 'N'         to rc2-ecs152-rpt (sub1)
 14891     end-if
 14892                                                                  ECSRIRTN
 14893     GO TO REIN-CO-BUILD-LOOP.                                    ECSRIRTN
 14894                                                                  ECSRIRTN
 14895 REIN-BUILD-EXIT.                                                 ECSRIRTN
 14896     EXIT.                                                        ECSRIRTN
 14897                                                                  ECSRIRTN
 14898 ZERO-RCT-ENTRIES.                                                ECSRIRTN
 14899                                                                  ECSRIRTN
 14900     MOVE SPACES TO REIN-CO-HOLD-ENTRIES (CO-SUB).                ECSRIRTN
 14901                                                                  ECSRIRTN
 14902     MOVE ZERO   TO RCT-CLM-CUTOFF-DT (CO-SUB)                    ECSRIRTN
 14903                    WS-RCT-CLM-CUTOFF-DT-N (CO-SUB)                  CL*12
 14904                    RCT-EARNING-START-DT (CO-SUB)                 ECSRIRTN
 14905                    WS-RCT-EARNING-START-DT-N (CO-SUB)               CL*12
 14906                    RCT-EARNING-STOP-DT (CO-SUB)                  ECSRIRTN
 14907                    WS-RCT-EARNING-STOP-DT-N (CO-SUB)                CL*12
 14908                    RCT-LF-CLM-PCT    (CO-SUB)                    ECSRIRTN
 14909                    RCT-AH-CLM-PCT    (CO-SUB)                    ECSRIRTN
 14910                    RCT-LF-CLM-MAX    (CO-SUB)                    ECSRIRTN
 14911                    RCT-AH-CLM-MAX    (CO-SUB).                   ECSRIRTN
 14912                                                                  ECSRIRTN
 14913 ZERO-RCT-EXIT.                                                   ECSRIRTN
 14914     EXIT.                                                        ECSRIRTN
 14915                                                                  ECSRIRTN
 14916 ZERO-RC2-ENTRIES.                                                ECSRIRTN
 14917                                                                  ECSRIRTN
 14918     MOVE SPACES TO RC2-CO-NAME (CO-SUB)                          ECSRIRTN
 14919                    RC2-REIN-CO (CO-SUB).                         ECSRIRTN
 14920     move spaces      to rc2-ecs152-rpt (co-sub)
 14921                                                                  ECSRIRTN
 14922     MOVE ZERO   TO RC2-LF-R78-PCT    (CO-SUB)                    ECSRIRTN
 14923                    RC2-LF-PRO-PCT    (CO-SUB)                    ECSRIRTN
 14924                    RC2-AH-R78-PCT    (CO-SUB)                    ECSRIRTN
 14925                    RC2-AH-PRO-PCT    (CO-SUB).                   ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 287
* ECS010MO.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 14926                                                                  ECSRIRTN
 14927 ZERO-RC2-EXIT.                                                   ECSRIRTN
 14928     EXIT.                                                        ECSRIRTN
 14929******************************************************************ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 288
* ECS010MO.cbl
 14931******************************************************************
 14932***   R E C A L C U L A T I O N   O F   R E I N S U R A N C E  ***
 14933******************************************************************
 14934
 14935 3600-RC-REINSURANCE.
 14936
 14937     IF DTE-PGM-OPT NOT = '1'
 14938         GO TO 3799-RC-REINSURANCE-X.
 14939
 14940     IF DTE-CLIENT = 'WSL'
 14941         IF CR-REIN-TABLE = '00A'
 14942             GO TO 3799-RC-REINSURANCE-X.
 14943
 14944     IF CR-REIN-TABLE = SPACES OR ZEROS
 14945         PERFORM CLEAR-REIN-HOLD THRU CLEAR-REIN-HOLD-X.
 14946
 14947 3610-CLEAR-RC-REIN.
 14948
 14949     MOVE SPACES TO RC-REIN-LEVELS (1).
 14950     MOVE ZEROS  TO RC-REIN-LFAMT (1)
 14951                    RC-REIN-LFPRM (1)
 14952                    RC-REIN-AHAMT (1)
 14953                    RC-REIN-AHPRM (1)
 14954                    RC-REIN-LFRFND (1)
 14955                    RC-REIN-AHRFND (1)
 14956                    RC-REIN-LFCLM (1)
 14957                    RC-REIN-AHCLM (1).
 14958
 14959     PERFORM 3620-CLEAR-RC-LEVELS VARYING SUB1 FROM +2 BY +1
 14960         UNTIL RC-REIN-COMP (SUB1) = SPACES.
 14961
 14962     MOVE +1 TO SUB1.
 14963     MOVE +0 TO SUB2.
 14964
 14965     GO TO 3630-RC-REIN-LOOP-1.
 14966
 14967 3620-CLEAR-RC-LEVELS.
 14968
 14969     MOVE RC-REIN-LEVELS (1) TO RC-REIN-LEVELS (SUB1).
 14970
 14971
 14972 3630-RC-REIN-LOOP-1.
 14973
 14974     IF REIN-LF-AH-FLGS (SUB1) NOT = SPACES
 14975         ADD +1 TO SUB2
 14976         MOVE REIN-COMP (SUB1)   TO RC-REIN-COMP (SUB2)
 14977         MOVE REIN-LFAMT (SUB1)  TO RC-REIN-LFAMT (SUB2)
 14978         MOVE REIN-LFPRM (SUB1)  TO RC-REIN-LFPRM (SUB2)
 14979         MOVE REIN-AHAMT (SUB1)  TO RC-REIN-AHAMT (SUB2)
 14980         MOVE REIN-AHPRM (SUB1)  TO RC-REIN-AHPRM (SUB2)
 14981         MOVE REIN-LFRFND (SUB1) TO RC-REIN-LFRFND (SUB2)
 14982         MOVE REIN-AHRFND (SUB1) TO RC-REIN-AHRFND (SUB2)
 14983         MOVE REIN-LFCLM (SUB1)  TO RC-REIN-LFCLM (SUB2)
 14984         MOVE REIN-AHCLM (SUB1)  TO RC-REIN-AHCLM (SUB2)
 14985         MOVE REIN-REM-SW (SUB1) TO RC-REIN-REM-SW (SUB2).
 14986
 14987     ADD +1 TO SUB1.
 14988     IF REIN-COMP (SUB1) NOT = SPACES
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 289
* ECS010MO.cbl
 14989         GO TO 3630-RC-REIN-LOOP-1.
 14990
 14991     PERFORM CLEAR-REIN-HOLD THRU CLEAR-REIN-HOLD-X.
 14992
 14993     MOVE AM-REI-TABLE TO CR-REIN-TABLE.
 14994     IF CR-REIN-TABLE = SPACES OR ZEROS
 14995         MOVE +1                     TO SUB1
 14996         GO TO 3710-RC-REIN-LOOP-2.
 14997
 14998     PERFORM 3010-RR-READ-REIN THRU 3019-RR-READ-REIN-X.
 14999
 15000 3640-NSP-REIN-RATING-ROUTINE.
 15001
 15002     MOVE CR-DT                      TO DC-GREG-DATE-CYMD.
 15003     MOVE 'L'                        TO DC-OPTION-CODE.
 15004     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 15005     MOVE DC-BIN-DATE-1              TO CP-CERT-EFF-DT.
 15006     MOVE SPACES                     TO CP-ACCT-FLD-5.
 15007     MOVE DTE-CLIENT                 TO CP-COMPANY-ID.
 15008     MOVE CR-AGE                     TO CP-ISSUE-AGE.
 15009     MOVE CR-APR                     TO CP-LOAN-APR.
 15010     MOVE CR-PMT-FREQ                TO CP-PAY-FREQUENCY.
 15011     MOVE CR-LOAN-TERM               TO CP-LOAN-TERM.
 15012     MOVE ZEROS                      TO CP-DEVIATION-CODE.
 15013     MOVE ZEROS                      TO CP-CLASS-CODE.
 15014
 15015     IF DTE-CLIENT = 'TIC'
 15016        IF CR-REIN-TABLE = '01T' OR '02T' OR '03T'
 15017            MOVE ZERO                TO CP-CLASS-CODE
 15018        ELSE
 15019            MOVE CR-RATING-CLASS     TO CP-CLASS-CODE.
 15020
 15021     MOVE '3'                        TO CP-PROCESS-TYPE.
 15022     MOVE DTE-CLASIC-COMPANY-CD      TO CP-COMPANY-CD.
 15023     MOVE CR-PMT-EXTENSION-DAYS      TO CP-TERM-OR-EXT-DAYS.
 15024
 15025 3650-NSP-REIN-LIFE.
 15026
 15027     IF CR-LFTYP = ZERO
 15028         GO TO 3660-NSP-REIN-AH.
 15029     IF (RE-NSP-ST-CD-LF = ZEROS OR SPACES)
 15030        OR (DTE-CLIENT = 'DCC')
 15031         GO TO 3660-NSP-REIN-AH.
 15032     IF DTE-CLIENT NOT = 'LBL'
 15033         IF (CLAS-I-BAL (CLAS-INDEXL) = 'B')
 15034             GO TO 3660-NSP-REIN-AH.
 15035
 15036     IF RE-NSP-ST-CD-LF NOT = STATE-L
 15037         MOVE RE-NSP-ST-CD-LF        TO STATE-L
 15038         PERFORM 8200-STATE-CODE-LOOKUP THRU 8299-STATE-LOOKUP-X.
 15039
 15040     MOVE CLAS-I-RL-AH (CLAS-INDEXL) TO CP-BENEFIT-TYPE.
 15041     MOVE CR-LF-TERM                 TO CP-ORIGINAL-TERM.
 15042     MOVE CR-LFAMT                   TO CP-ORIGINAL-BENEFIT
 15043                                        CP-RATING-BENEFIT-AMT.
 15044     MOVE CLAS-I-EP (CLAS-INDEXL)    TO CP-EARNING-METHOD.
 15045     MOVE CLAS-I-BAL (CLAS-INDEXL)   TO CP-SPECIAL-CALC-CD.
 15046     MOVE CR-LFTYP                   TO CP-BENEFIT-CD.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 290
* ECS010MO.cbl
 15047     MOVE LIFE-OVERRIDE-L1           TO CP-LIFE-OVERRIDE-CODE.
 15048     MOVE AM-LF-DEVIATION-PCT        TO CP-RATE-DEV-PCT.
 15049     MOVE RE-NSP-ST-CD-LF            TO CP-STATE.
 15050     MOVE STATE-ABBR (CLAS-INDEXS)   TO CP-STATE-STD-ABBRV.
 15051
 15052     IF CP-STATE-STD-ABBRV = 'OR'
 15053         COMPUTE CP-RATING-BENEFIT-AMT = CR-LFAMT + CR-LFAMT-ALT.
 15054
 15055     PERFORM 8100-GET-RATE THRU 8199-GET-RATE-X.
 15056
 15057     IF CP-ERROR-RATE-NOT-FOUND  OR
 15058        CP-ERROR-RATE-IS-ZERO
 15059         MOVE 'LIFE NET SINGLE PREMIUM RATE NOT FOUND'
 15060                                     TO WS-ABEND-MESSAGE
 15061         MOVE 0302                   TO WS-ABEND-CODE
 15062         DISPLAY '******************************'
 15063         DISPLAY '***** ERROR LOCATION 018 *****'
 15064         DISPLAY '******************************'
 15065         MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
 15066         GO TO ABEND-PGM.
 15067
 15068     MOVE CP-CALC-PREMIUM          TO CR-LF-NSP-PRM.
 15069
 15070*    COMPUTE CR-LF-NSP-PRM ROUNDED =
 15071*                      (CR-LFAMT / 100) * CP-PREMIUM-RATE.
 15072
 15073     COMPUTE CR-LF-NSP-PRM ROUNDED =  CR-LF-NSP-PRM +
 15074                   ((CR-LFAMT-ALT / 100) * CP-PREMIUM-RATE).
 15075
 15076     MOVE CP-PREMIUM-RATE            TO CR-LF-NSP-PRM-RATE.
 15077
 15078 3660-NSP-REIN-AH.
 15079
 15080     IF CR-AHTYP = ZERO
 15081         GO TO 3669-NSP-REIN-X.
 15082     IF (RE-NSP-ST-CD-AH = ZEROS OR SPACES)
 15083        OR (DTE-CLIENT = 'DCC')
 15084         GO TO 3669-NSP-REIN-X.
 15085     IF DTE-CLIENT NOT = 'LBL'
 15086         IF (CLAS-I-BAL (CLAS-INDEXA) = 'B')
 15087             GO TO 3669-NSP-REIN-X.
 15088
 15089     IF RE-NSP-ST-CD-AH NOT = STATE-L
 15090         MOVE RE-NSP-ST-CD-AH        TO STATE-L
 15091         PERFORM 8200-STATE-CODE-LOOKUP THRU 8299-STATE-LOOKUP-X.
 15092
 15093     MOVE CLAS-I-RL-AH (CLAS-INDEXA) TO CP-BENEFIT-TYPE.
 15094     MOVE CR-AH-TERM                 TO CP-ORIGINAL-TERM.
 15095     MOVE CR-AHAMT                   TO CP-ORIGINAL-BENEFIT
 15096                                        CP-RATING-BENEFIT-AMT.
 15097     MOVE CLAS-I-EP (CLAS-INDEXA)    TO CP-EARNING-METHOD.
 15098     MOVE CLAS-I-BAL (CLAS-INDEXA)   TO CP-SPECIAL-CALC-CD.
 15099     MOVE CR-AHTYP                   TO CP-BENEFIT-CD.
 15100     MOVE AH-OVERRIDE-L1             TO CP-AH-OVERRIDE-CODE.
 15101     MOVE AM-AH-DEVIATION-PCT        TO CP-RATE-DEV-PCT.
 15102     MOVE RE-NSP-ST-CD-AH            TO CP-STATE.
 15103     MOVE STATE-ABBR (CLAS-INDEXS)   TO CP-STATE-STD-ABBRV.
 15104
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 291
* ECS010MO.cbl
 15105     IF CP-STATE-STD-ABBRV = 'OR'
 15106         COMPUTE CP-RATING-BENEFIT-AMT = CR-AHAMT * CR-AH-TERM.
 15107
 15108     PERFORM 8100-GET-RATE THRU 8199-GET-RATE-X.
 15109
 15110     IF CP-ERROR-RATE-NOT-FOUND  OR
 15111        CP-ERROR-RATE-IS-ZERO
 15112         MOVE 'A&H NET SINGLE PREMIUM RATE NOT FOUND'
 15113                                     TO WS-ABEND-MESSAGE
 15114         MOVE 0302                   TO WS-ABEND-CODE
 15115         DISPLAY '******************************'
 15116         DISPLAY '***** ERROR LOCATION 019 *****'
 15117         DISPLAY '******************************'
 15118         MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
 15119         GO TO ABEND-PGM.
 15120
 15121     COMPUTE CR-AH-NSP-PRM ROUNDED =
 15122             ((CR-AHAMT * CR-AH-TERM) / 100) * CP-PREMIUM-RATE.
 15123
 15124     MOVE CP-PREMIUM-RATE            TO CR-AH-NSP-PRM-RATE.
 15125
 15126 3669-NSP-REIN-X.
 15127     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 292
* ECS010MO.cbl
 15129******************************************************************
 15130***        R E C A L C U L A T E   R E I N S U R A N C E       ***
 15131******************************************************************
 15132
 15133 3700-RC-REIN-PERF-CALC.
 15134
*15135                             COPY ECSRTPFM.
 15136******************************************************************07/10/97
 15137*                                                                *ECSRTPFM
 15138*                            ECSRTPFM                            *   LV001
 15139*                            VMOD=2.002                          *ECSRTPFM
 15140*                                                                *ECSRTPFM
 15141******************************************************************ECSRTPFM
 15142                                                                  ECSRTPFM
 15143     IF    CR-LFAMT  NUMERIC                                      00000072
 15144           NEXT SENTENCE                                          00000073
 15145        ELSE                                                      00000074
 15146           MOVE ZEROS TO CR-LFAMT.                                00000075
 15147                                                                  00000076
 15148     IF    CR-LFAMT-ALT  NUMERIC                                  00000077
 15149           NEXT SENTENCE                                          00000078
 15150        ELSE                                                      00000079
 15151           MOVE ZEROS TO CR-LFAMT-ALT.                            00000080
 15152                                                                  00000081
 15153                                                                  00000082
 15154     IF    CR-LFPRM  NUMERIC                                      00000083
 15155           NEXT SENTENCE                                          00000084
 15156        ELSE                                                      00000085
 15157           MOVE ZEROS TO CR-LFPRM.                                00000086
 15158                                                                  00000087
 15159     IF    CR-LFPRM-ALT  NUMERIC                                  00000088
 15160           NEXT SENTENCE                                          00000089
 15161        ELSE                                                      00000090
 15162           MOVE ZEROS TO CR-LFPRM-ALT.                            00000091
 15163                                                                  00000092
 15164                                                                  00000093
 15165     IF    CR-LFPRM-CALC  NUMERIC                                 00000094
 15166           NEXT SENTENCE                                          00000095
 15167        ELSE                                                      00000096
 15168           MOVE ZEROS TO CR-LFPRM-CALC.                           00000097
 15169                                                                  00000098
 15170     IF    CR-LFPRM-CALC-ALT  NUMERIC                             00000099
 15171           NEXT SENTENCE                                          00000100
 15172        ELSE                                                      00000101
 15173           MOVE ZEROS TO CR-LFPRM-CALC-ALT.                       00000102
 15174                                                                  00000103
 15175     IF    CR-LF-NSP-PRM  NUMERIC                                 00000104
 15176           NEXT SENTENCE                                          00000105
 15177        ELSE                                                      00000106
 15178           MOVE ZEROS TO CR-LF-NSP-PRM.                           00000107
 15179                                                                  00000108
 15180     COMPUTE RS-R-LB = CR-LFAMT + CR-LFAMT-ALT.                   ECSRTPFM
 15181     COMPUTE RS-R-LP = CR-LFPRM + CR-LFPRM-ALT.                   ECSRTPFM
 15182     IF RE-NSP-ST-CD-LF = ZEROS  OR  SPACES                       ECSRTPFM
 15183         COMPUTE RS-R-LPC = CR-LFPRM-CALC + CR-LFPRM-CALC-ALT     ECSRTPFM
 15184     ELSE                                                         ECSRTPFM
 15185         MOVE CR-LF-NSP-PRM         TO RS-R-LPC.                  ECSRTPFM
 15186     MOVE RS-R-LPC                  TO REIN-CALCED-LIFE.          ECSRTPFM
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 293
* ECS010MO.cbl (/apps/prod/cid1p/copy/ECSRTPFM)
 15187                                                                  ECSRTPFM
 15188     MOVE CR-AHAMT                  TO RS-R-AB.                   ECSRTPFM
 15189     MOVE CR-AHPRM                  TO RS-R-AP.                   ECSRTPFM
 15190     IF RE-NSP-ST-CD-AH = ZEROS  OR  SPACES                       ECSRTPFM
 15191         MOVE CR-AHPRM-CALC         TO RS-R-APC                   ECSRTPFM
 15192     ELSE                                                         ECSRTPFM
 15193         MOVE CR-AH-NSP-PRM         TO RS-R-APC.                  ECSRTPFM
 15194     MOVE RS-R-APC                  TO REIN-CALCED-AH.            ECSRTPFM
 15195                                                                  ECSRTPFM
 15196     PERFORM REINSURE-CALC THRU REINSURE-CALC-X                   ECSRTPFM
 15197         VARYING SUB1 FROM +1 BY +1                               ECSRTPFM
 15198             UNTIL RE-REI-COMP-NO (SUB1) = SPACES.                ECSRTPFM
 15199                                                                  ECSRTPFM
 15200
 15201     IF CR-STATE NOT = STATE-L
 15202         MOVE CR-STATE               TO STATE-L
 15203         PERFORM 8200-STATE-CODE-LOOKUP THRU 8299-STATE-LOOKUP-X.
 15204
 15205     MOVE 'X'                     TO REIN-RT-SW.
 15206     PERFORM 3200-REINSURE-CANCEL THRU 3299-REINSURE-CANCEL-X.
 15207     PERFORM 3300-REINSURE-CLAIM THRU 3399-REINSURE-CLAIM-X.
 15208     MOVE ' '                     TO REIN-RT-SW.
 15209
 15210 3710-RC-REIN-LOOP-2.
 15211
 15212     IF REIN-COMP (SUB1) = SPACES
 15213         GO TO 3730-RC-REIN-EXTRACTS.
 15214
 15215     IF REIN-LF-AH-FLGS (SUB1) = SPACES
 15216        ADD +1 TO SUB1
 15217         GO TO 3710-RC-REIN-LOOP-2.
 15218
 15219     MOVE +1 TO SUB2.
 15220
 15221 3720-RC-REIN-LOOP-3.
 15222
 15223     IF RC-REIN-COMP (SUB2) = SPACES
 15224         ADD +1 TO SUB1
 15225         GO TO 3710-RC-REIN-LOOP-2.
 15226
 15227     IF REIN-COMP (SUB1) NOT = RC-REIN-COMP (SUB2)
 15228         ADD +1 TO SUB2
 15229         GO TO 3720-RC-REIN-LOOP-3.
 15230
 15231     IF REIN-LFAMT (SUB1) = RC-REIN-LFAMT (SUB2)
 15232        AND REIN-LFPRM (SUB1) = RC-REIN-LFPRM (SUB2)
 15233        AND REIN-AHAMT (SUB1) = RC-REIN-AHAMT (SUB2)
 15234        AND REIN-AHPRM (SUB1) = RC-REIN-AHPRM (SUB2)
 15235         MOVE 'X' TO RC-OLD-ISS (SUB2)
 15236         MOVE 'X' TO RC-NEW-ISS (SUB1).
 15237
 15238     IF REIN-LFRFND (SUB1) = RC-REIN-LFRFND (SUB2)
 15239        AND REIN-AHRFND (SUB1) = RC-REIN-AHRFND (SUB2)
 15240         MOVE 'X' TO RC-OLD-CNC (SUB2)
 15241         MOVE 'X' TO RC-NEW-CNC (SUB1).
 15242
 15243     IF REIN-LFCLM (SUB1) = RC-REIN-LFCLM (SUB2)
 15244         MOVE 'X' TO RC-OLD-LF-CLM (SUB2)
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 294
* ECS010MO.cbl
 15245         MOVE 'X' TO RC-NEW-LF-CLM (SUB1).
 15246
 15247     IF REIN-AHCLM (SUB1) = RC-REIN-AHCLM (SUB2)
 15248         MOVE 'X' TO RC-OLD-AH-CLM (SUB2)
 15249         MOVE 'X' TO RC-NEW-AH-CLM (SUB1).
 15250
 15251     ADD +1 TO SUB2.
 15252     GO TO 3720-RC-REIN-LOOP-3.
 15253
 15254 3730-RC-REIN-EXTRACTS.
 15255
 15256     PERFORM 2000-INITIALIZE-DETAIL-EXTRACT THRU 2099-INIT-DTL-X.
 15257     MOVE 'R' TO DE-REIN.
 15258     MOVE 'J' TO DE-TRANS.
 15259*****PERFORM EXTRACT-DATE-RELOAD.
 15260     MOVE DETAIL-EXTRACT TO SAVE-EXTRACT.
 15261     MOVE +1 TO SUB1.
 15262
 15263 3740-RC-REIN-OLD-ISSUE.
 15264
 15265     IF RC-REIN-COMP (SUB1) = SPACES
 15266         MOVE +1 TO SUB1
 15267         GO TO 3745-RC-REIN-NEW-ISSUE.
 15268
 15269     IF RC-REIN-REM-SW (SUB1) = 'Z'
 15270         ADD +1 TO SUB1
 15271         GO TO 3740-RC-REIN-OLD-ISSUE.
 15272
 15273     IF RC-OLD-ISS (SUB1) = 'X'
 15274         ADD +1 TO SUB1
 15275         GO TO 3740-RC-REIN-OLD-ISSUE.
 15276
 15277     IF RC-REIN-LFAMT (SUB1) = ZERO
 15278        AND RC-REIN-LFPRM (SUB1) = ZERO
 15279        AND RC-REIN-AHAMT (SUB1) = ZERO
 15280        AND RC-REIN-AHPRM (SUB1) = ZERO
 15281         ADD +1 TO SUB1
 15282         GO TO 3740-RC-REIN-OLD-ISSUE.
 15283
 15284     MOVE SAVE-EXTRACT TO DETAIL-EXTRACT.
 15285     PERFORM EXTRACT-DATE-LOAD.
 15286     MOVE RC-REIN-COMP (SUB1) TO DE-REI-COMP.
 15287     MULTIPLY RC-REIN-LFAMT (SUB1) BY -1 GIVING DE-REI-LFAMT.
 15288     MULTIPLY RC-REIN-LFPRM (SUB1) BY -1 GIVING DE-REI-LFPRM.
 15289     MULTIPLY RC-REIN-AHAMT (SUB1) BY -1 GIVING DE-REI-AHAMT.
 15290     MULTIPLY RC-REIN-AHPRM (SUB1) BY -1 GIVING DE-REI-AHPRM.
 15291     PERFORM 2500-WRITE-DETAIL-EXTRACTS THRU 2599-WRT-DETAIL-X.
 15292
 15293     ADD +1 TO BC-R-ISS.
 15294     ADD +1 TO SUB1.
 15295     GO TO 3740-RC-REIN-OLD-ISSUE.
 15296
 15297 3745-RC-REIN-NEW-ISSUE.
 15298
 15299     IF REIN-COMP (SUB1) = SPACES
 15300         PERFORM 2200-BUILD-CANCEL-EXTRACT THRU
 15301                                         2259-END-CANCEL-BUILD
 15302         MOVE 'R'      TO DE-REIN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 295
* ECS010MO.cbl
 15303         MOVE 'K'      TO DE-TRANS
 15304*********PERFORM EXTRACT-DATE-RELOAD
 15305         MOVE DETAIL-EXTRACT TO SAVE-EXTRACT
 15306         MOVE +1       TO SUB1
 15307         GO TO 3750-RC-REIN-OLD-CANCEL.
 15308
 15309     IF REIN-REM-SW (SUB1) = 'Z'
 15310         ADD +1 TO SUB1
 15311         GO TO 3745-RC-REIN-NEW-ISSUE.
 15312
 15313     IF RC-NEW-ISS (SUB1) = 'X'
 15314         ADD +1 TO SUB1
 15315         GO TO 3745-RC-REIN-NEW-ISSUE.
 15316
 15317     IF REIN-LFAMT (SUB1) = ZERO
 15318        AND REIN-LFPRM (SUB1) = ZERO
 15319        AND REIN-AHAMT (SUB1) = ZERO
 15320        AND REIN-AHPRM (SUB1) = ZERO
 15321         ADD +1 TO SUB1
 15322         GO TO 3745-RC-REIN-NEW-ISSUE.
 15323
 15324     MOVE SAVE-EXTRACT      TO DETAIL-EXTRACT.
 15325     PERFORM EXTRACT-DATE-LOAD.
 15326     MOVE REIN-COMP (SUB1)  TO DE-REI-COMP.
 15327     MOVE REIN-LFAMT (SUB1) TO DE-REI-LFAMT.
 15328     MOVE REIN-LFPRM (SUB1) TO DE-REI-LFPRM.
 15329     MOVE REIN-AHAMT (SUB1) TO DE-REI-AHAMT.
 15330     MOVE REIN-AHPRM (SUB1) TO DE-REI-AHPRM.
 15331     PERFORM 2500-WRITE-DETAIL-EXTRACTS THRU 2599-WRT-DETAIL-X.
 15332
 15333     ADD +1 TO BC-R-ISS.
 15334     ADD +1 TO SUB1.
 15335     GO TO 3745-RC-REIN-NEW-ISSUE.
 15336
 15337 3750-RC-REIN-OLD-CANCEL.
 15338
 15339     IF RC-REIN-COMP (SUB1) = SPACES
 15340         MOVE +1 TO SUB1
 15341         GO TO 3755-RC-REIN-NEW-CANCEL.
 15342
 15343     IF RC-REIN-REM-SW (SUB1) = 'Z'
 15344         ADD +1 TO SUB1
 15345         GO TO 3750-RC-REIN-OLD-CANCEL.
 15346
 15347     IF RC-OLD-CNC (SUB1) = 'X'
 15348         ADD +1 TO SUB1
 15349         GO TO 3750-RC-REIN-OLD-CANCEL.
 15350
 15351     IF RC-REIN-LFRFND (SUB1) = ZERO
 15352        AND RC-REIN-AHRFND (SUB1) = ZERO
 15353         ADD +1 TO SUB1
 15354         GO TO 3750-RC-REIN-OLD-CANCEL.
 15355
 15356     MOVE SAVE-EXTRACT        TO DETAIL-EXTRACT.
 15357     PERFORM EXTRACT-DATE-LOAD.
 15358     MOVE RC-REIN-COMP (SUB1) TO DE-REI-COMP.
 15359     MULTIPLY RC-REIN-LFRFND (SUB1) BY -1 GIVING DE-REI-LFRFND.
 15360     MULTIPLY RC-REIN-AHRFND (SUB1) BY -1 GIVING DE-REI-AHRFND.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 296
* ECS010MO.cbl
 15361     PERFORM 2500-WRITE-DETAIL-EXTRACTS THRU 2599-WRT-DETAIL-X.
 15362
 15363     ADD +1 TO BC-R-CNC.
 15364     ADD +1 TO SUB1.
 15365     GO TO 3750-RC-REIN-OLD-CANCEL.
 15366
 15367 3755-RC-REIN-NEW-CANCEL.
 15368
 15369     IF REIN-COMP (SUB1) = SPACES
 15370         PERFORM 2000-INITIALIZE-DETAIL-EXTRACT
 15371         MOVE 'R' TO DE-REIN
 15372         MOVE 'L' TO DE-TRANS
 15373*********PERFORM EXTRACT-DATE-RELOAD
 15374         MOVE DETAIL-EXTRACT TO SAVE-EXTRACT
 15375         MOVE +1 TO SUB1
 15376         GO TO 3760-RC-REIN-OLD-CLAIM.
 15377
 15378     IF REIN-REM-SW (SUB1) = 'Z'
 15379         ADD +1 TO SUB1
 15380         GO TO 3755-RC-REIN-NEW-CANCEL.
 15381
 15382     IF RC-NEW-CNC (SUB1) = 'X'
 15383         ADD +1 TO SUB1
 15384         GO TO 3755-RC-REIN-NEW-CANCEL.
 15385
 15386     IF REIN-LFRFND (SUB1) = ZERO
 15387        AND REIN-AHRFND (SUB1) = ZERO
 15388         ADD +1 TO SUB1
 15389         GO TO 3755-RC-REIN-NEW-CANCEL.
 15390
 15391     MOVE SAVE-EXTRACT       TO DETAIL-EXTRACT.
 15392     PERFORM EXTRACT-DATE-LOAD.
 15393     MOVE REIN-COMP (SUB1)   TO DE-REI-COMP.
 15394     MOVE REIN-LFRFND (SUB1) TO DE-REI-LFRFND.
 15395     MOVE REIN-AHRFND (SUB1) TO DE-REI-AHRFND.
 15396     PERFORM 2500-WRITE-DETAIL-EXTRACTS THRU 2599-WRT-DETAIL-X.
 15397
 15398     ADD +1 TO BC-R-CNC.
 15399     ADD +1 TO SUB1.
 15400     GO TO 3755-RC-REIN-NEW-CANCEL.
 15401
 15402 3760-RC-REIN-OLD-CLAIM.
 15403
 15404     IF RC-REIN-COMP (SUB1) = SPACES
 15405         MOVE +1 TO SUB1
 15406         GO TO 3780-RC-REIN-NEW-CLAIM.
 15407
 15408     IF RC-REIN-REM-SW (SUB1) = 'Z'
 15409         ADD +1 TO SUB1
 15410         GO TO 3760-RC-REIN-OLD-CLAIM.
 15411
 15412     IF RC-OLD-LF-CLM (SUB1) = 'X'
 15413         GO TO 3770-RC-REIN-OLD-AH-CLM.
 15414
 15415     IF RC-REIN-LFCLM (SUB1) = ZERO
 15416         GO TO 3770-RC-REIN-OLD-AH-CLM.
 15417
 15418     MOVE SAVE-EXTRACT         TO DETAIL-EXTRACT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 297
* ECS010MO.cbl
 15419     PERFORM EXTRACT-DATE-LOAD.
 15420     MOVE RC-REIN-COMP (SUB1)  TO DE-REI-COMP.
 15421     MOVE RC-REIN-LFAMT (SUB1) TO DE-REI-LFAMT.
 15422     MOVE RC-REIN-LFPRM (SUB1) TO DE-REI-LFPRM.
 15423     MOVE RC-REIN-AHAMT (SUB1) TO DE-REI-AHAMT.
 15424     MOVE RC-REIN-AHPRM (SUB1) TO DE-REI-AHPRM.
 15425     MULTIPLY RC-REIN-LFCLM (SUB1) BY -1 GIVING DE-REI-CLAIM-AMT.
 15426     MOVE CR-DTHAMT     TO DE-CLAIM-AMT.
 15427     ADD  CR-DTHEXP     TO DE-CLAIM-AMT.
 15428     MOVE CR-DTH-PAY-DT TO DE-PAY
 15429                           WS-DE-PAY-N.
 15430
 15431     IF CLAS-I-BAL (CLAS-INDEXL) = 'B'
 15432         MOVE '3' TO DE-TYPE
 15433     ELSE
 15434         MOVE '1' TO DE-TYPE.
 15435
 15436     PERFORM 2500-WRITE-DETAIL-EXTRACTS THRU 2599-WRT-DETAIL-X.
 15437
 15438     ADD +1 TO BC-R-CLM.
 15439
 15440 3770-RC-REIN-OLD-AH-CLM.
 15441
 15442     IF RC-OLD-AH-CLM (SUB1) = 'X'
 15443         ADD +1 TO SUB1
 15444         GO TO 3760-RC-REIN-OLD-CLAIM.
 15445
 15446     IF RC-REIN-AHCLM (SUB1) = ZERO
 15447         ADD +1 TO SUB1
 15448         GO TO 3760-RC-REIN-OLD-CLAIM.
 15449
 15450     MOVE SAVE-EXTRACT         TO DETAIL-EXTRACT.
 15451     PERFORM EXTRACT-DATE-LOAD.
 15452     MOVE RC-REIN-COMP (SUB1)  TO DE-REI-COMP.
 15453     MOVE RC-REIN-LFAMT (SUB1) TO DE-REI-LFAMT.
 15454     MOVE RC-REIN-LFPRM (SUB1) TO DE-REI-LFPRM.
 15455     MOVE RC-REIN-AHAMT (SUB1) TO DE-REI-AHAMT.
 15456     MOVE RC-REIN-AHPRM (SUB1) TO DE-REI-AHPRM.
 15457     MULTIPLY RC-REIN-AHCLM (SUB1) BY -1 GIVING DE-REI-CLAIM-AMT.
 15458     MOVE CR-DISAMT     TO DE-CLAIM-AMT.
 15459     ADD  CR-DISEXP     TO DE-CLAIM-AMT.
 15460     MOVE CR-DIS-PAY-DT TO DE-PAY
 15461                           WS-DE-PAY-N.
 15462
 15463     IF CLAS-I-BAL (CLAS-INDEXA) = 'B'
 15464         MOVE '4' TO DE-TYPE
 15465     ELSE
 15466         MOVE '2' TO DE-TYPE.
 15467
 15468     PERFORM 2500-WRITE-DETAIL-EXTRACTS THRU 2599-WRT-DETAIL-X.
 15469
 15470     ADD +1 TO BC-R-CLM.
 15471     ADD +1 TO SUB1.
 15472
 15473     GO TO 3760-RC-REIN-OLD-CLAIM.
 15474
 15475 3780-RC-REIN-NEW-CLAIM.
 15476
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 298
* ECS010MO.cbl
 15477     IF REIN-COMP (SUB1) = SPACES
 15478         GO TO 3799-RC-REINSURANCE-X.
 15479
 15480     IF REIN-REM-SW (SUB1) = 'Z'
 15481         ADD +1 TO SUB1
 15482         GO TO 3780-RC-REIN-NEW-CLAIM.
 15483
 15484     IF RC-NEW-LF-CLM (SUB1) = 'X'
 15485         GO TO 3790-RC-REIN-NEW-AH-CLM.
 15486
 15487     IF REIN-LFCLM (SUB1) = ZERO
 15488         GO TO 3790-RC-REIN-NEW-AH-CLM.
 15489
 15490     MOVE SAVE-EXTRACT      TO DETAIL-EXTRACT.
 15491     PERFORM EXTRACT-DATE-LOAD.
 15492     MOVE REIN-COMP (SUB1)  TO DE-REI-COMP.
 15493     MOVE REIN-LFAMT (SUB1) TO DE-REI-LFAMT.
 15494     MOVE REIN-LFPRM (SUB1) TO DE-REI-LFPRM.
 15495     MOVE REIN-AHAMT (SUB1) TO DE-REI-AHAMT.
 15496     MOVE REIN-AHPRM (SUB1) TO DE-REI-AHPRM.
 15497     MOVE REIN-LFCLM (SUB1) TO DE-REI-CLAIM-AMT.
 15498     MOVE CR-DTHAMT         TO DE-CLAIM-AMT.
 15499     ADD  CR-DTHEXP         TO DE-CLAIM-AMT.
 15500     MOVE CR-DTH-PAY-DT     TO DE-PAY
 15501                               WS-DE-PAY-N.
 15502
 15503     IF CLAS-I-BAL (CLAS-INDEXL) = 'B'
 15504         MOVE '3' TO DE-TYPE
 15505     ELSE
 15506         MOVE '1' TO DE-TYPE.
 15507
 15508     PERFORM 2500-WRITE-DETAIL-EXTRACTS THRU 2599-WRT-DETAIL-X.
 15509
 15510     ADD +1 TO BC-R-CLM.
 15511
 15512 3790-RC-REIN-NEW-AH-CLM.
 15513
 15514     IF RC-NEW-AH-CLM (SUB1) = 'X'
 15515         ADD +1 TO SUB1
 15516         GO TO 3780-RC-REIN-NEW-CLAIM.
 15517
 15518     IF REIN-AHCLM (SUB1) = ZERO
 15519         ADD +1 TO SUB1
 15520         GO TO 3780-RC-REIN-NEW-CLAIM.
 15521
 15522     MOVE SAVE-EXTRACT      TO DETAIL-EXTRACT.
 15523     PERFORM EXTRACT-DATE-LOAD.
 15524     MOVE REIN-COMP (SUB1)  TO DE-REI-COMP.
 15525     MOVE REIN-LFAMT (SUB1) TO DE-REI-LFAMT.
 15526     MOVE REIN-LFPRM (SUB1) TO DE-REI-LFPRM.
 15527     MOVE REIN-AHAMT (SUB1) TO DE-REI-AHAMT.
 15528     MOVE REIN-AHPRM (SUB1) TO DE-REI-AHPRM.
 15529     MOVE REIN-AHCLM (SUB1) TO DE-REI-CLAIM-AMT.
 15530     MOVE CR-DISAMT         TO DE-CLAIM-AMT.
 15531     ADD  CR-DISEXP         TO DE-CLAIM-AMT.
 15532     MOVE CR-DIS-PAY-DT     TO DE-PAY
 15533                               WS-DE-PAY-N.
 15534
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 299
* ECS010MO.cbl
 15535     IF CLAS-I-BAL (CLAS-INDEXA) = 'B'
 15536         MOVE '4' TO DE-TYPE
 15537     ELSE
 15538         MOVE '2' TO DE-TYPE.
 15539
 15540     PERFORM 2500-WRITE-DETAIL-EXTRACTS THRU 2599-WRT-DETAIL-X.
 15541
 15542     ADD +1 TO BC-R-CLM.
 15543     ADD +1 TO SUB1.
 15544
 15545     GO TO 3780-RC-REIN-NEW-CLAIM.
 15546
 15547 3799-RC-REINSURANCE-X.
 15548     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 300
* ECS010MO.cbl
 15550******************************************************************
 15551***    E A R N E D   P R E M I U M   C A L C U L A T I O N S   ***
 15552******************************************************************
 15553
 15554 4000-EP-BUMP-RTN.
 15555
 15556     IF AM-RECALC-COMM = ('Y' OR '1')
 15557        PERFORM 1600-RECALC-COMM-EXTR
 15558                                 THRU 1899-RECALC-COMM-EXTR-X
 15559        MOVE ' '                 TO RECALC-TYPE
 15560     END-IF
 15561
 15562     MOVE '1'    TO EP-FLG.
 15563     ADD +1      TO BC-G-CERTS.
 15564
 15565     MOVE CR-DT               TO HIGH-CERT.
 15566     IF CR-ACCT-CONTROL NOT = LOW-CTL
 15567         MOVE CR-DT           TO LOW-CERT
 15568         MOVE CR-ACCT-CONTROL TO LOW-CTL.
 15569
 15570     IF CR-POLICY-IS-REIN-ONLY
 15571         MOVE +0           TO GROSS-ISS-BEN-LF   GROSS-ISS-BEN-AH
 15572                              GROSS-CNC-BEN-LF   GROSS-CNC-BEN-AH
 15573                              GROSS-ISS-PRM-LF   GROSS-ISS-PRM-AH
 15574                              GROSS-CNC-PRM-LF   GROSS-CNC-PRM-AH
 15575                              DTH-IBNR           DIS-IBNR
 15576                              DTH-PAYCUR         DIS-PAYCUR
 15577                              DTH-FUTRSV         DIS-FUTRSV
 15578         GO TO 4050-EP-DO-REINSURE.
 15579
 15580     MOVE CR-LFAMT       TO WE-LFAMT.
 15581     MOVE CR-LFPRM       TO WE-LFPRM.
 15582     IF CR-LFTYP NOT = ZEROS
 15583         IF CLAS-I-EP (CLAS-INDEXL) = 'B'
 15584             MOVE CR-LFAMT-ALT        TO WE-LFAMT-ALT
 15585             MOVE CR-LFPRM-ALT        TO WE-LFPRM-ALT
 15586         ELSE
 15587             MOVE ZEROS               TO WE-LFAMT-ALT
 15588                                         WE-LFPRM-ALT.
 15589
 15590     MOVE SPACES         TO REIN-EP-FLG
 15591                            WE-REIN-CO.
 15592     MOVE CR-LFRFND      TO WE-LFRFND.
 15593     MOVE CR-DTHAMT      TO WE-DTHAMT.
 15594     ADD  CR-DTHEXP      TO WE-DTHAMT.
 15595     MOVE CR-DTHEXP      TO WE-DTHEXP.
 15596     MOVE CR-NUM-DTH-CLM TO WE-NUM-DTH-CLM.
 15597     MOVE DTH-IBNR       TO WE-DTH-IBNR.
 15598     MOVE DTH-PAYCUR     TO WE-DTH-PAYCUR.
 15599     MOVE DTH-FUTRSV     TO WE-DTH-FUTRSV.
 15600
 15601     MOVE CR-AHPRM       TO WE-AHPRM.
 15602     MOVE CR-AHAMT       TO WE-AHAMT.
 15603     MOVE CR-AHRFND      TO WE-AHRFND.
 15604     MOVE CR-DISAMT      TO WE-DSPY-AMT.
 15605     ADD  CR-DISEXP      TO WE-DSPY-AMT.
 15606     MOVE CR-DISEXP      TO WE-DSPY-EXP.
 15607     MOVE CR-NUM-DIS-CLM TO WE-NUM-DIS-CLM.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 301
* ECS010MO.cbl
 15608     MOVE DIS-IBNR       TO WE-DIS-IBNR.
 15609     MOVE DIS-PAYCUR     TO WE-DIS-PAYCUR.
 15610     MOVE DIS-FUTRSV     TO WE-DIS-FUTRSV.
 15611
 15612     IF CR-POLICY-IS-RESTORE  OR
 15613        CR-POLICY-IS-REISSUE
 15614        OR CR-POLICY-IS-MONTHLY
 15615         MOVE ZEROS      TO WE-LFPRM
 15616                            WE-LFPRM-ALT
 15617                            WE-AHPRM.
 15618
 15619     MOVE +0               TO GROSS-ISS-BEN-LF   GROSS-ISS-BEN-AH
 15620                              GROSS-CNC-BEN-LF   GROSS-CNC-BEN-AH
 15621                              GROSS-ISS-PRM-LF   GROSS-ISS-PRM-AH
 15622                              GROSS-CNC-PRM-LF   GROSS-CNC-PRM-AH
 15623                              DTH-IBNR           DIS-IBNR
 15624                              DTH-PAYCUR         DIS-PAYCUR
 15625                              DTH-FUTRSV         DIS-FUTRSV.
 15626
 15627*     DISPLAY ' B4 4100 '
 15628     PERFORM 4100-EP-DO-LF THRU 4299-EPBX.
 15629*     DISPLAY ' AFTER 4100 '
 15630
 15631     IF CR-POLICY-IS-DECLINED  OR
 15632        CR-POLICY-IS-VOID
 15633         GO TO 4099-EP-BUMP-RTN-X.
 15634
 15635 4050-EP-DO-REINSURE.
 15636
 15637     MOVE 'R' TO REIN-EP-FLG.
 15638     MOVE +1  TO SUB5.
 15639
 15640 4090-EP-DO-REINSURE-LOOP.
 15641
 15642*     DISPLAY ' 4090 '
 15643     IF REIN-COMP (SUB5) = SPACES
 15644         MOVE SPACE TO REIN-EP-FLG
 15645         GO TO 4099-EP-BUMP-RTN-X.
 15646
 15647     IF REIN-REM-SW (SUB5) = 'Z'  OR
 15648        REIN-LF-AH-FLGS (SUB5) = SPACES
 15649         ADD +1 TO SUB5
 15650         GO TO 4090-EP-DO-REINSURE-LOOP.
 15651
 15652     PERFORM REIN-FIND-CO-LOOP THRU FIND-REI-CO-EXIT
 15653        VARYING CO-SUB FROM 1 BY 1 UNTIL
 15654          (RCT-REIN-CO (CO-SUB) = REIN-COMP (SUB5))  OR
 15655          (CO-SUB GREATER REIN-CO-TABLE-ENT-CNT)     OR
 15656          (RCT-REIN-CO (CO-SUB) = SPACES).
 15657
 15658     IF (CO-SUB GREATER REIN-CO-TABLE-ENT-CNT)  OR
 15659        (RCT-REIN-CO (CO-SUB) = SPACES)
 15660        MOVE ZERO TO CO-SUB.
 15661
 15662*     DISPLAY ' 4090 A '
 15663*     DISPLAY ' AM RECALC ' AM-RECALC-COMM
 15664     ADD +1 TO BC-R-CERTS.
 15665     MOVE REIN-COMP (SUB5)      TO WE-REIN-CO.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 302
* ECS010MO.cbl
 15666     MOVE REIN-WORK-FLDS (SUB5) TO RWF-FIELDS.
 15667     MOVE RE-COMP-INFO (SUB5)   TO WT-COMP-INFO
 15668
 15669     IF (DTE-CLIENT = 'DCC')
 15670        AND (CR-LFAMT + CR-LFAMT-ALT) > ZEROS
 15671*        DISPLAY ' B4 CEDE FACT '
 15672*        DISPLAY ' CR-LFAMT ' CR-LFAMT
 15673*        DISPLAY ' CR-LFAMT-ALT ' CR-LFAMT-ALT
 15674*        DISPLAY ' RWF-LFAMT ' RWF-LFAMT
 15675        COMPUTE WS-CEDE-FACT =
 15676           RWF-LFAMT / (CR-LFAMT + CR-LFAMT-ALT)
 15677*        DISPLAY ' AFTER CEDE FACT '
 15678        IF (AM-RECALC-COMM = ('Y' OR '1'))
 15679           AND (CLAS-I-BEN-CATEGORY (CLAS-INDEXA)
 15680                                     NOT = 'G' AND 'L')
 15681           COMPUTE RWF-LFPRM = CR-LF-NSP-PRM * WS-CEDE-FACT
 15682*          COMPUTE RWF-LFRFND ROUNDED = CR-LF-NSP-PRM
 15683*          / (CR-LFPRM + CR-LFPRM-ALT) * CR-LFRFND
 15684           COMPUTE RWF-LFRFND ROUNDED = (CR-LFRFND
 15685           / (CR-LFPRM + CR-LFPRM-ALT)) * CR-LF-NSP-PRM
 15686        END-IF
 15687     END-IF
 15688
 15689     MOVE RWF-LFPRM      TO WE-LFPRM.
 15690     MOVE RWF-LFAMT      TO WE-LFAMT.
 15691     MOVE RWF-LFRFND     TO WE-LFRFND.
 15692     MOVE RWF-LFCLM      TO WE-DTHAMT.
 15693     MOVE RWF-DTH-IBNR   TO WE-DTH-IBNR.
 15694     MOVE RWF-DTH-PAYCUR TO WE-DTH-PAYCUR.
 15695     MOVE RWF-DTH-FUTRSV TO WE-DTH-FUTRSV.
 15696     MOVE +0             TO WE-LFAMT-ALT
 15697                            WE-LFPRM-ALT
 15698                            WE-DTHEXP
 15699                            WE-NUM-DTH-CLM.
 15700
 15701*     DISPLAY ' 4090 B '
 15702     IF (DTE-CLIENT EQUAL 'NSL') AND
 15703        (CR-REIN-TABLE EQUAL 'NAR')
 15704        CONTINUE
 15705     ELSE
 15706      IF CLAS-I-EP (CLAS-INDEXL) EQUAL 'B'
 15707       IF (CR-LFAMT + CR-LFAMT-ALT) GREATER THAN +0
 15708        COMPUTE WS-CEDE-FACT ROUNDED EQUAL
 15709            RWF-LFAMT / (CR-LFAMT + CR-LFAMT-ALT)
 15710        COMPUTE WE-LFAMT ROUNDED EQUAL
 15711                           CR-LFAMT * WS-CEDE-FACT
 15712        COMPUTE WE-LFAMT-ALT ROUNDED EQUAL
 15713                           CR-LFAMT-ALT * WS-CEDE-FACT
 15714        IF (DTE-CLIENT = 'CID')
 15715           AND (CR-LF-NSP-PRM > +0)
 15716           AND (CR-ENTRY-DATE > 20031130)
 15717           AND (WT-LF-QC NOT = '1' AND '3')
 15718           COMPUTE WE-LFPRM ROUNDED = (CR-LF-NSP-PRM *
 15719              RWF-LFAMT) / (CR-LFAMT + CR-LFAMT-ALT)
 15720           MOVE +0            TO WE-LFPRM-ALT
 15721        ELSE
 15722          IF (DTE-CLIENT = 'CID')
 15723             AND (CR-LF-NSP-PRM > +0)
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 303
* ECS010MO.cbl
 15724             AND (CR-ENTRY-DATE > 20030430)
 15725             AND (WT-LF-QC NOT = '1' AND '3')
 15726             COMPUTE WE-LFPRM = CR-LF-NSP-PRM * WS-CEDE-FACT
 15727             MOVE +0            TO WE-LFPRM-ALT
 15728          ELSE
 15729             COMPUTE WE-LFPRM ROUNDED EQUAL
 15730                           CR-LFPRM * WS-CEDE-FACT
 15731             COMPUTE WE-LFPRM-ALT ROUNDED EQUAL
 15732                           CR-LFPRM-ALT * WS-CEDE-FACT
 15733          END-IF
 15734        END-IF
 15735        IF (DTE-CLIENT = 'CID')
 15736           AND (CR-LF-NSP-PRM > +0)
 15737           AND (CR-LFRFND-CALC > +0)
 15738           AND (CR-LF-CANCEL-EXIT-DATE > 20031130)
 15739           AND (WT-LF-QC NOT = '1' AND '4')
 15740           COMPUTE REIN-FACTOR ROUNDED =  CR-LFRFND-CALC /
 15741              (CR-LFPRM + CR-LFPRM-ALT)
 15742           COMPUTE WE-LFRFND =
 15743              REIN-FACTOR * REIN-CALCED-LIFE
 15744           COMPUTE WE-LFRFND ROUNDED =  (WE-LFRFND
 15745              * RWF-LFAMT) / (CR-LFAMT + CR-LFAMT-ALT)
 15746*          COMPUTE WE-LFRFND = CR-LFRFND-CALC / (CR-LFPRM
 15747*             + CR-LFPRM-ALT) * CR-LF-NSP-PRM
 15748*             * RWF-LFAMT / (CR-LFAMT + CR-LFAMT-ALT)
 15749        ELSE
 15750
 15751          IF (DTE-CLIENT = 'CID')
 15752           AND (CR-LF-NSP-PRM > +0)
 15753           AND (CR-LFRFND-CALC > +0)
 15754           AND (CR-LF-CANCEL-EXIT-DATE > 20030430)
 15755           AND (WT-LF-QC NOT = '1' AND '4')
 15756           COMPUTE WS-WE-LFPRM = CR-LF-NSP-PRM * WS-CEDE-FACT
 15757           COMPUTE WE-LFRFND = (CR-LFRFND-CALC / (CR-LFPRM
 15758              + CR-LFPRM-ALT)) * (WS-WE-LFPRM)
 15759
 15760          END-IF
 15761        END-IF
 15762       ELSE
 15763         MOVE +0 TO WS-CEDE-FACT
 15764       END-IF
 15765      END-IF
 15766     END-IF
 15767
 15768*     DISPLAY ' 4090 C '
 15769     IF DTE-CLIENT = 'DCC'
 15770        IF (AM-RECALC-COMM = ('Y' OR '1'))
 15771           AND (CLAS-I-BEN-CATEGORY (CLAS-INDEXA)
 15772                                   NOT = 'G' AND 'L')
 15773           AND (CR-AHAMT NOT = ZEROS)
 15774*        DISPLAY ' CR-AHAMT ' CR-AHAMT
 15775           COMPUTE WS-CEDE-FACT =
 15776               RWF-AHAMT / CR-AHAMT
 15777           COMPUTE RWF-AHPRM = CR-AH-NSP-PRM * WS-CEDE-FACT
 15778*          COMPUTE RWF-AHRFND ROUNDED = CR-AH-NSP-PRM
 15779*          / CR-AHPRM * CR-AHRFND
 15780           COMPUTE RWF-AHRFND ROUNDED = (CR-AHRFND
 15781           / CR-AHPRM) * CR-AH-NSP-PRM
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 304
* ECS010MO.cbl
 15782        END-IF
 15783     END-IF
 15784
 15785     MOVE RWF-AHPRM      TO WE-AHPRM.
 15786
 15787     MOVE RWF-AHAMT      TO WE-AHAMT
 15788     MOVE RWF-AHRFND     TO WE-AHRFND.
 15789     MOVE RWF-AHCLM      TO WE-DSPY-AMT.
 15790     MOVE +0             TO WE-DSPY-EXP
 15791                            WE-NUM-DIS-CLM.
 15792     MOVE RWF-DIS-IBNR   TO WE-DIS-IBNR.
 15793     MOVE RWF-DIS-PAYCUR TO WE-DIS-PAYCUR.
 15794     MOVE RWF-DIS-FUTRSV TO WE-DIS-FUTRSV.
 15795
 15796     IF  RWF-LF-RUNOFF-SW = 'N'
 15797             OR
 15798         RWF-AH-RUNOFF-SW = 'N'
 15799         PERFORM 8000R-CONVERT-STOP-DATE THRU 8099R-STOP-DATE-X.
 15800
 15801     IF  RWF-LF-RUNOFF-SW = 'N'
 15802         MOVE EARNING-STOP-DATE    TO STOP-LF-DATE
 15803     ELSE
 15804         MOVE 99999999             TO STOP-LF-DATE.
 15805
 15806     IF  RWF-AH-RUNOFF-SW = 'N'
 15807         MOVE EARNING-STOP-DATE    TO STOP-AH-DATE
 15808     ELSE
 15809         MOVE 99999999             TO STOP-AH-DATE.
 15810
 15811     IF CR-POLICY-IS-RESTORE  OR
 15812        CR-POLICY-IS-REISSUE
 15813        OR CR-POLICY-IS-MONTHLY
 15814         MOVE ZEROS      TO WE-LFPRM
 15815                            WE-LFPRM-ALT
 15816                            WE-AHPRM.
 15817
 15818*     DISPLAY ' B4 4100-EP-DO-LF '
 15819     PERFORM 4100-EP-DO-LF THRU 4299-EPBX.
 15820*     DISPLAY ' AFTER 4100-EP-DO-LF '
 15821
 15822     IF CO-SUB NOT = ZERO
 15823       IF RCT-EARNING-START-DT (CO-SUB) NOT = ZERO
 15824         IF CR-DT LESS THAN RCT-EARNING-START-DT (CO-SUB)
 15825             PERFORM S-4100-EP-DO-LF THRU S-4299-EPBX.
 15826
 15827     ADD +1 TO SUB5.
 15828     GO TO 4090-EP-DO-REINSURE-LOOP.
 15829
 15830 4099-EP-BUMP-RTN-X.
 15831     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 305
* ECS010MO.cbl
 15833******************************************************************
 15834***  C A L C U L A T E   L I F E   E A R N E D   P R E M I U M ***
 15835******************************************************************
 15836
 15837 4100-EP-DO-LF.
 15838
 15839     MOVE +0                         TO ISS-BEN  EPR-R78
 15840                                        CNC-BEN  EPR-PRO
 15841                                        ISS-PRM  EPR-ST
 15842                                        ISS-PRMTAX
 15843                                        CNC-PRM  ACTIVE-COUNT.
 15844     MOVE SPACE                      TO LIFE-EARNED-SWITCH.
 15845
 15846     IF CR-LFTYP = ZERO
 15847         GO TO 4200-EP-DO-AH.
 15848
 15849     IF REIN-EP-FLG = 'R'
 15850         IF REIN-LF-FLG (SUB5) = SPACE
 15851             GO TO 4200-EP-DO-AH.
 15852
 15853     IF CR-APR NOT NUMERIC
 15854         MOVE ZERO TO CR-APR.
 15855
 15856     MOVE LIFE-OVERRIDE-L1       TO WE-LF-AH.
 15857     MOVE CR-LFTYP               TO WE-BEN-TYPE.
 15858     PERFORM 4400-EP-FIND-TAB-ENT THRU 4499-EP-FIND-TAB-ENT-X.
 15859
 15860     IF CR-POLICY-IS-DECLINED  OR
 15861        CR-POLICY-IS-VOID
 15862         GO TO 4191-CONTINUE.
 15863
 15864     MOVE CR-LF-TERM             TO ORIG-TERM.
 15865     MOVE CLAS-INDEXL            TO W-NDX.
 15866
 15867     IF CR-DT GREATER EW-COV-DTE
 15868         MOVE CR-DT              TO EW-COV-DTE.
 15869
 15870     IF (NOT CR-POLICY-IS-RESTORE) AND
 15871        (NOT CR-POLICY-IS-REISSUE)
 15872        AND (NOT CR-POLICY-IS-MONTHLY)
 15873         COMPUTE ISS-BEN = WE-LFAMT + WE-LFAMT-ALT
 15874         IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'Z'
 15875             ADD CR-LIVES TO EW-ISS-CNT
 15876             COMPUTE EW-ORIG-TERM = EW-ORIG-TERM +
 15877                                    (ORIG-TERM * CR-LIVES)
 15878             COMPUTE EW-AGE = EW-AGE + (CR-AGE * CR-LIVES)
 15879             COMPUTE EW-AGE-BEN = EW-AGE-BEN + (CR-AGE * ISS-BEN)
 15880             COMPUTE EW-TERM-BEN = EW-TERM-BEN +
 15881                                   (ORIG-TERM * ISS-BEN)
 15882         ELSE
 15883             ADD +1 TO EW-ISS-CNT
 15884             COMPUTE EW-ORIG-TERM = EW-ORIG-TERM + ORIG-TERM
 15885             COMPUTE EW-AGE = EW-AGE + CR-AGE
 15886             COMPUTE EW-AGE-BEN = EW-AGE-BEN + (CR-AGE * ISS-BEN)
 15887             COMPUTE EW-TERM-BEN = EW-TERM-BEN +
 15888                                   (ORIG-TERM * ISS-BEN).
 15889
 15890     MOVE RUN-DATE        TO VALUATION-DT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 306
* ECS010MO.cbl
 15891     MOVE '2'             TO W-VAL-SOURCE.
 15892
 15893     IF REIN-EP-FLG = 'R'
 15894         IF REIN-LF-RUNOFF-SW (SUB5) = 'N' AND
 15895            EARNING-STOP-DATE LESS THAN VALUATION-DT
 15896             MOVE EARNING-STOP-DATE TO VALUATION-DT
 15897             MOVE '10'              TO W-VAL-SOURCE.
 15898
 15899     PERFORM 8500-REMAINING-TERM-ROUTINE THRU 8599-REM-TERM-X.
 15900
 15901     IF (CR-LF-CURRENT-STATUS = '1' OR '4') AND
 15902        (REM-TRM3 GREATER ZERO)
 15903        IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'Z'
 15904            COMPUTE EW-INFORCE-CNT = EW-INFORCE-CNT +
 15905                                  (CR-LIVES - CR-SUM-CAN-CNT-ITD)
 15906            COMPUTE EW-REM-TERM = EW-REM-TERM +
 15907                     (REM-TRM3 * (CR-LIVES - CR-SUM-CAN-CNT-ITD))
 15908          ELSE
 15909            COMPUTE EW-INFORCE-CNT = EW-INFORCE-CNT + 1
 15910            COMPUTE EW-REM-TERM = EW-REM-TERM + REM-TRM3.
 15911
 15912     COMPUTE ISS-PRM = WE-LFPRM + WE-LFPRM-ALT.
 15913
 15914     IF DTE-CLIENT = 'GIC'
 15915         IF REIN-EP-FLG NOT = 'R'  AND
 15916            CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'B'  AND
 15917            (CR-ENTRY-STATUS NOT = '5' AND '3' AND 'M')
 15918            MOVE CR-LFPRM-CALC TO ISS-PRM.
 15919
 15920     IF  DTE-OPT-RESERVE-METHOD-UNAUTH
 15921         GO TO 4105-EP-DO-LF-REIN-CHK.
 15922
 15923     IF  CR-DT NOT GREATER THAN EOM-DATE (13)
 15924             AND
 15925         CR-LF-EXPIRE-DATE GREATER THAN EOM-DATE (1)
 15926             AND
 15927         (CR-LF-CANC-DT GREATER THAN EOM-DATE (1)
 15928                 OR
 15929             CR-LF-CANC-DT EQUAL ZEROS)
 15930             AND
 15931         (CR-LF-CLAIM-EXIT-DATE GREATER THAN EOM-DATE (1)
 15932                 OR
 15933             CR-LF-CLAIM-EXIT-DATE EQUAL ZEROS)
 15934         MOVE 'Y'               TO  EPEC-LIFE-CTR-USED-IND (SUB3)
 15935         PERFORM 4194-SLOT-INTO-EFFECTED-MONTHS THRU 4194-EXIT
 15936                 VARYING
 15937             SUBM FROM +1 BY +1
 15938                 UNTIL
 15939             SUBM GREATER THAN +13.
 15940
 15941     MOVE EW-SUB-KEY             TO EPEC-SUB-KEY-OPT (SUB3).
 15942     MOVE EW-REIN-CO             TO EPEC-REIN-CO-OPT (SUB3).
 15943
 15944 4105-EP-DO-LF-REIN-CHK.
 15945
 15946     IF REIN-EP-FLG = 'R'  AND
 15947        REIN-LF-RUNOFF-SW (SUB5) = 'N'
 15948         NEXT SENTENCE
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 307
* ECS010MO.cbl
 15949     ELSE
 15950         GO TO 4110-EP-DO-LF-CLM.
 15951
 15952     IF CR-LF-STATUS-AT-CANCEL NOT = ' '
 15953         IF CR-LF-CANC-DT GREATER THAN EARNING-STOP-DATE
 15954             GO TO 4130-EP-DO-LF-EP.
 15955
 15956     IF CR-LF-STATUS-AT-DEATH NOT = ' '
 15957         IF CR-DTH-DT GREATER THAN EARNING-STOP-DATE
 15958             GO TO 4130-EP-DO-LF-EP.
 15959
 15960 4110-EP-DO-LF-CLM.
 15961
 15962     IF  EPEC-CLM-EXP (SUB3)  NUMERIC
 15963         NEXT  SENTENCE
 15964       ELSE
 15965         MOVE ZEROS TO EPEC-CLM-EXP (SUB3).
 15966
 15967     ADD WE-DTHAMT      TO EW-CLM-AMT.
 15968     ADD WE-DTHEXP      TO EPEC-CLM-EXP (SUB3).
 15969
 15970     IF CR-LF-STATUS-AT-DEATH = ' '
 15971         IF CLAS-I-CALC-TYPE (CLAS-INDEXL) NOT = 'B'
 15972             GO TO 4115-EP-DO-LF-CLM-EPR.
 15973
 15974     ADD WE-NUM-DTH-CLM TO EW-CLM-CNT.
 15975     ADD +1             TO EW-CLM-CRT.
 15976
 15977 4115-EP-DO-LF-CLM-EPR.
 15978
 15979     IF CR-LF-STATUS-AT-DEATH NOT = ' '
 15980         COMPUTE EPR-R78 = WE-LFPRM + WE-LFPRM-ALT
 15981         MOVE EPR-R78 TO EPR-PRO  EPR-ST
 15982     END-IF
 15983     .
 15984 4120-EP-DO-LF-CNCL.
 15985
 15986     IF CR-LF-STATUS-AT-CANCEL = ' '  AND
 15987        CLAS-I-CALC-TYPE (CLAS-INDEXL) NOT = 'Z'
 15988         IF CR-LF-STATUS-AT-DEATH NOT = ' '
 15989             GO TO 4190-EP-DO-LF-COMM
 15990         ELSE
 15991             GO TO 4130-EP-DO-LF-EP.
 15992
 15993     IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'Z'
 15994         ADD CR-SUM-CAN-CNT-ITD TO EW-CNC-CNT
 15995         GO TO 4124-EP-DO-LF-CNCL-SUM.
 15996
 15997     ADD +1                       TO EW-CNC-CNT.
 15998
 15999     MOVE WE-LFRFND               TO CNC-PRM.
 16000
 16001     IF DTE-CLIENT = 'GIC'
 16002         IF REIN-EP-FLG NOT = 'R'  AND
 16003            CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'B'
 16004             MOVE CR-LFRFND-CALC TO CNC-PRM.
 16005
 16006*    MOVE CR-DT                 TO  DC-GREG-DATE-CYMD.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 308
* ECS010MO.cbl
 16007*    MOVE 'L'                   TO  DC-OPTION-CODE.
 16008*    PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 16009*    MOVE DC-BIN-DATE-1         TO  WS-CR-BIN-DATE.
 16010
 16011     MOVE CR-LF-CANC-DT         TO  DC-GREG-DATE-CYMD.
 16012     MOVE 'L'                   TO  DC-OPTION-CODE.
 16013     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 16014     MOVE DC-BIN-DATE-1         TO  WS-BIN-CANCEL-DATE.
 16015
 16016     MOVE WS-CR-BIN-DATE          TO  DC-BIN-DATE-1.
 16017     MOVE WS-BIN-CANCEL-DATE      TO  DC-BIN-DATE-2.
 16018     MOVE '1'                     TO  DC-OPTION-CODE.
 16019     MOVE ZEROS                   TO  MONTHS-DIFF-LF.
 16020     MOVE ' '                     TO  DC-CENTURY-ADJUSTMENT.
 16021     MOVE ZEROS                   TO  DC-ELAPSED-MONTHS
 16022                                      DC-ODD-DAYS-OVER
 16023                                      DC-ELAPSED-DAYS.
 16024     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 16025     MOVE DC-ELAPSED-MONTHS       TO  MONTHS-DIFF-LF.
 16026
 16027     IF DC-ODD-DAYS-OVER   GREATER THAN  ZERO
 16028         ADD  +1                  TO  MONTHS-DIFF-LF.
 16029
 16030     MOVE  'YYYYYYYYYY'           TO  WS-LF-CHARGEBACK-LEVELS.
 16031
 16032     IF DTE-CLIENT = 'ACE'
 16033         GO TO 4120-CONTINUE-LIFE-CANCEL.
 16034
 16035     MOVE  ZEROS                  TO  SUB.
 16036
 16037 4120-LIFE-CHARGEBACK-LOOP.
 16038
 16039     ADD    +1                    TO  SUB.
 16040
 16041     IF  SUB  GREATER THAN  +10
 16042         GO TO  4120-CONTINUE-LIFE-CANCEL.
 16043
 16044     IF  AM-COMM-CHARGEBACK (SUB)  NOT  NUMERIC  OR
 16045         AM-COMM-CHARGEBACK (SUB)  =  ZEROS
 16046         GO TO  4120-LIFE-CHARGEBACK-LOOP.
 16047
 16048     IF  AM-COMM-CHARGEBACK (SUB)  EQUAL    '99'
 16049         MOVE  'N'    TO  WS-LF-CHARGEBACK-SW (SUB).
 16050
 16051     IF  MONTHS-DIFF-LF GREATER THAN AM-COMM-CHARGEBACK (SUB)
 16052         MOVE  'N'        TO  WS-LF-CHARGEBACK-SW (SUB).
 16053
 16054     GO TO  4120-LIFE-CHARGEBACK-LOOP.
 16055
 16056
 16057 4120-CONTINUE-LIFE-CANCEL.
 16058
 16059     COMPUTE EPR-R78 = (WE-LFPRM + WE-LFPRM-ALT) - WE-LFRFND.
 16060     MOVE EPR-R78 TO EPR-PRO  EPR-ST.
 16061
 16062     IF WE-LFRFND = +0 AND WE-DTHAMT NOT = +0
 16063         GO TO 4190-EP-DO-LF-COMM.
 16064
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 309
* ECS010MO.cbl
 16065     IF CLAS-I-RL-AH (CLAS-INDEXL) = 'L' OR 'P'
 16066         COMPUTE CNC-BEN = WE-LFAMT + WE-LFAMT-ALT
 16067         GO TO 4190-EP-DO-LF-COMM.
 16068
 16069     MOVE CR-LF-CANC-DT TO VALUATION-DT.
 16070     MOVE '3'           TO W-VAL-SOURCE.
 16071     PERFORM 8500-REMAINING-TERM-ROUTINE THRU 8599-REM-TERM-X.
 16072
 16073     IF REM-TRM3 = CR-LF-TERM
 16074         COMPUTE CNC-BEN = WE-LFAMT + WE-LFAMT-ALT
 16075         GO TO 4190-EP-DO-LF-COMM.
 16076
 16077     IF CLAS-I-EP (CLAS-INDEXL) = 'T'
 16078         GO TO 4122-EP-DO-LF-CNCL-TEX.
 16079
 16080     IF DTE-CLIENT = 'NCL'
 16081         IF CR-DT LESS THAN 19910101
 16082             GO TO 4121-EP-DO-LF-CNC-BEN.
 16083
 16084     IF CLAS-I-EP (CLAS-INDEXL) = 'N'
 16085         GO TO 4126-EP-DO-LF-CNCL-NP.
 16086
 16087     IF DTE-CLIENT = 'FUL'
 16088         GO TO 4128-EP-DO-LF-CNCL-FUL.
 16089
 16090*    IF STATE-ABBR (CLAS-INDEXS) = 'OH'
 16091     IF (STATE-ABBR (CLAS-INDEXS) = 'OH') AND
 16092        (CR-RATING-CLASS NOT = 'L ')
 16093         IF (CR-APR GREATER THAN ZERO)  AND
 16094            (CR-LF-TERM GREATER THAN 060)  AND
 16095            (CR-DT GREATER THAN 19831031)
 16096              GO TO 4126-EP-DO-LF-CNCL-NP.
 16097
 16098     IF STATE-ABBR (CLAS-INDEXS) = 'MT'
 16099         IF (CR-APR GREATER THAN ZERO)  AND
 16100            (CR-LF-TERM GREATER THAN 061)  AND
 16101            (CR-DT GREATER THAN 19830318)
 16102              GO TO 4126-EP-DO-LF-CNCL-NP.
 16103
 16104     IF STATE-ABBR (CLAS-INDEXS) = 'UT'
 16105         IF (CR-APR GREATER THAN ZERO)  AND
 16106            (CR-LF-TERM GREATER THAN 062)  AND
 16107            (CR-DT GREATER THAN 19810831)  AND
 16108            (CR-DT LESS THAN 19830901)
 16109              GO TO 4126-EP-DO-LF-CNCL-NP.
 16110
 16111     IF STATE-ABBR (CLAS-INDEXS) = 'RI'
 16112         IF (CR-APR GREATER THAN ZERO)  AND
 16113            (CR-LF-TERM GREATER THAN 060)  AND
 16114            (CR-DT GREATER THAN 19831231)
 16115              GO TO 4126-EP-DO-LF-CNCL-NP.
 16116
 16117 4121-EP-DO-LF-CNC-BEN.
 16118
 16119     COMPUTE TEMP-4 ROUNDED EQUAL REM-TRM3 / CR-LF-TERM.
 16120
 16121     COMPUTE TEMP-3 ROUNDED EQUAL
 16122         (WE-LFAMT + WE-LFAMT-ALT) * TEMP-4.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 310
* ECS010MO.cbl
 16123
 16124     MOVE TEMP-3                 TO CNC-BEN.
 16125
 16126     GO TO 4190-EP-DO-LF-COMM.
 16127
 16128 4122-EP-DO-LF-CNCL-TEX.
 16129
 16130     DIVIDE WE-LFAMT BY CR-LF-TERM
 16131         GIVING TEX-FACT-1.
 16132     DIVIDE REM-TRM3 BY CR-PMT-FREQ
 16133         GIVING TEX-FACT-2
 16134             REMAINDER TEX-FACT-3.
 16135     IF TEX-FACT-3 NOT = ZERO
 16136         ADD +1 TO TEX-FACT-2.
 16137
 16138     COMPUTE CNC-BEN = (TEX-FACT-1 * (TEX-FACT-2 * CR-PMT-FREQ)).
 16139
 16140     GO TO 4190-EP-DO-LF-COMM.
 16141
 16142 4124-EP-DO-LF-CNCL-SUM.
 16143
 16144     IF WE-LFRFND = ZERO
 16145         GO TO 4130-EP-DO-LF-EP.
 16146
 16147     MOVE WE-LFRFND TO CNC-PRM.
 16148
 16149     MOVE  'YYYYYYYYYY'           TO  WS-LF-CHARGEBACK-LEVELS.
 16150
 16151     IF WE-LFRFND NOT LESS WE-LFPRM
 16152         MOVE WE-LFAMT TO CNC-BEN
 16153          GO TO 4130-EP-DO-LF-EP.
 16154
 16155
 16156     COMPUTE TEMP-7 ROUNDED = WE-LFAMT * (WE-LFRFND / WE-LFPRM).
 16157
 16158     IF CLAS-I-RL-AH (CLAS-INDEXL) = 'L' OR 'P'
 16159         MOVE TEMP-7 TO CNC-BEN
 16160          GO TO 4130-EP-DO-LF-EP.
 16161
 16162     MOVE CR-LF-CANC-DT TO VALUATION-DT.
 16163     MOVE '4'           TO W-VAL-SOURCE.
 16164     PERFORM 8500-REMAINING-TERM-ROUTINE THRU 8599-REM-TERM-X.
 16165
 16166     IF CLAS-I-EP (CLAS-INDEXL) NOT = 'N'
 16167         COMPUTE CNC-BEN = TEMP-7 * (REM-TRM3 / CR-LF-TERM)
 16168         GO TO 4130-EP-DO-LF-EP.
 16169
 16170 4126-EP-DO-LF-CNCL-NP.
 16171
 16172     IF WE-LFAMT = ZERO
 16173        GO TO 4190-EP-DO-LF-COMM.
 16174
 16175     MOVE CR-DT                      TO  DC-GREG-DATE-CYMD.
 16176     MOVE 'L'                        TO  DC-OPTION-CODE.
 16177     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 16178     MOVE DC-BIN-DATE-1              TO  CP-CERT-EFF-DT.
 16179
 16180     IF CR-LOAN-1ST-PMT-DT NOT = ZEROS
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 311
* ECS010MO.cbl
 16181       MOVE CR-LOAN-1ST-PMT-DT       TO  DC-GREG-DATE-1-YMD
 16182       MOVE '3'                      TO  DC-OPTION-CODE
 16183       PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X
 16184       MOVE DC-BIN-DATE-1            TO  CP-FIRST-PAY-DATE
 16185     ELSE
 16186       MOVE CP-CERT-EFF-DT           TO  DC-BIN-DATE-1
 16187       MOVE '6'                      TO  DC-OPTION-CODE
 16188       MOVE +1                       TO  DC-ELAPSED-MONTHS
 16189       MOVE +0                       TO  DC-ELAPSED-DAYS
 16190       PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X
 16191       MOVE DC-BIN-DATE-2            TO  CP-FIRST-PAY-DATE.
 16192
 16193     MOVE CR-LFAMT                   TO  CP-ORIGINAL-BENEFIT.
 16194     MOVE CR-APR                     TO  CP-LOAN-APR.
 16195     MOVE CR-LF-TERM                 TO  CP-ORIGINAL-TERM.
 16196     MOVE CR-LOAN-TERM               TO  CP-LOAN-TERM.
 16197     MOVE REM-TRM3                   TO  CP-REMAINING-TERM.
 16198     MOVE CLAS-I-CALC-TYPE (CLAS-INDEXL) TO  CP-SPECIAL-CALC-CD.
 16199     MOVE CLAS-I-RL-AH     (CLAS-INDEXL) TO  CP-BENEFIT-TYPE.
 16200     MOVE CLAS-I-EP        (CLAS-INDEXL) TO  CP-EARNING-METHOD.
 16201
 16202     CALL 'ELRAMTX' USING CALCULATION-PASS-AREA.
 16203
 16204     IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'Z'
 16205       COMPUTE CNC-BEN = (CP-REMAMT-FACTOR * (TEMP-7 / +1000))
 16206       GO TO 4130-EP-DO-LF-EP
 16207     ELSE
 16208       COMPUTE CNC-BEN = (CP-REMAMT-FACTOR * (WE-LFAMT / +1000)).
 16209
 16210     GO TO 4190-EP-DO-LF-COMM.
 16211
 16212 4128-EP-DO-LF-CNCL-FUL.
 16213
 16214     IF WE-LFAMT = ZERO
 16215        GO TO 4190-EP-DO-LF-COMM.
 16216
 16217     MOVE CR-APR              TO NP-APR.
 16218     MOVE CR-LF-TERM          TO NP-ORIG.
 16219     MOVE REM-TRM3            TO NP-REM.
 16220     MOVE '2'                 TO NP-OPT.
 16221     MOVE CR-AHPRM            TO NP-AHPRM.
 16222     MOVE CR-ACCOUNT          TO NP-ACCOUNT.
 16223     MOVE CR-LFAMT            TO NP-BENEFIT.
 16224
 16225*    CALL 'FULNETRM'
 16226*        USING NP-APR NP-ORIG NP-REM NP-OPT NP-BENEFIT NP-AHPRM
 16227*              NP-ACCOUNT NP-REMAINING.
 16228
 16229     MOVE NP-REMAINING TO CNC-BEN.
 16230
 16231     GO TO 4190-EP-DO-LF-COMM.
 16232
 16233 4130-EP-DO-LF-EP.
 16234
 16235     MOVE SPACE                  TO STATUTORY-SWITCH.
 16236
 16237     MOVE EOM-RUN-DATE TO VALUATION-DT.
 16238     MOVE '5'           TO W-VAL-SOURCE.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 312
* ECS010MO.cbl
 16239
 16240     IF REIN-EP-FLG = 'R'
 16241       IF REIN-REM-SW (SUB5) = 'I'
 16242           COMPUTE EPR-R78 = WE-LFPRM + WE-LFPRM-ALT
 16243           MOVE EPR-R78             TO EPR-PRO  EPR-ST
 16244           GO TO 4190-EP-DO-LF-COMM.
 16245
 16246     IF REIN-EP-FLG = 'R'
 16247         IF REIN-LF-RUNOFF-SW (SUB5) = 'N'  AND
 16248            EARNING-STOP-DATE LESS THAN VALUATION-DT
 16249             MOVE '*'               TO LIFE-EARNED-SWITCH
 16250             MOVE EARNING-STOP-DATE TO VALUATION-DT
 16251             MOVE '10'              TO W-VAL-SOURCE.
 16252
 16253     PERFORM 8500-REMAINING-TERM-ROUTINE THRU 8599-REM-TERM-X.
 16254
 16255     IF REM-TRM2 GREATER CR-LF-TERM
 16256         MOVE +0 TO EPR-R78  EPR-PRO  EPR-ST
 16257         GO TO 4190-EP-DO-LF-COMM.
 16258
 16259     IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'Z'
 16260         GO TO 4180-EP-DO-LF-EP-SUM.
 16261
 16262     IF CLAS-I-EP (CLAS-INDEXL) = 'B'
 16263         IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'L'
 16264             IF REM-TRM2 NOT GREATER THAN +0
 16265                 COMPUTE EPR-R78 = WE-LFPRM + WE-LFPRM-ALT
 16266                 MOVE EPR-R78 TO EPR-PRO  EPR-ST
 16267                 GO TO 4190-EP-DO-LF-COMM
 16268             ELSE
 16269                 NEXT SENTENCE
 16270         ELSE
 16271             IF W-BAL-REMTRM NOT GREATER +0
 16272                 COMPUTE EPR-R78 = WE-LFPRM + WE-LFPRM-ALT
 16273                 MOVE EPR-R78 TO EPR-PRO  EPR-ST
 16274                 GO TO 4190-EP-DO-LF-COMM
 16275             ELSE
 16276                 NEXT SENTENCE
 16277     ELSE
 16278        IF DTE-CLIENT = 'NCL'  AND
 16279           CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'B'
 16280            MOVE WE-LFPRM TO EPR-R78  EPR-PRO  EPR-ST
 16281        ELSE
 16282         IF REM-TRM2 NOT GREATER +0  OR
 16283            CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'B'
 16284             MOVE WE-LFPRM TO EPR-R78  EPR-PRO  EPR-ST
 16285             GO TO 4190-EP-DO-LF-COMM.
 16286
 16287     MOVE +1 TO ACTIVE-COUNT.
 16288
 16289     IF CLAS-I-EP (CLAS-INDEXL) = 'T'
 16290         GO TO 4140-EP-DO-LF-EP-TEX.
 16291
 16292     IF CLAS-I-EP (CLAS-INDEXL) = 'N'
 16293         GO TO 4150-EP-DO-LF-EP-NP.
 16294
 16295*    IF STATE-ABBR (CLAS-INDEXS) = 'OH'
 16296     IF (STATE-ABBR (CLAS-INDEXS) = 'OH') AND
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 313
* ECS010MO.cbl
 16297        (CR-RATING-CLASS NOT = 'L ')
 16298         IF (CR-APR GREATER THAN ZERO)  AND
 16299            (CR-LF-TERM GREATER THAN 060)  AND
 16300            (CR-DT GREATER THAN 19831031)
 16301             MOVE '*'             TO STATUTORY-SWITCH
 16302              GO TO 4150-EP-DO-LF-EP-NP.
 16303
 16304     IF STATE-ABBR (CLAS-INDEXS) = 'MT'
 16305         IF (CR-APR GREATER THAN ZERO)  AND
 16306            (CR-LF-TERM GREATER THAN 061)  AND
 16307            (CR-DT GREATER THAN 19830318)
 16308             MOVE '*'             TO STATUTORY-SWITCH
 16309              GO TO 4150-EP-DO-LF-EP-NP.
 16310
 16311     IF STATE-ABBR (CLAS-INDEXS) = 'UT'
 16312         IF (CR-APR GREATER THAN ZERO)  AND
 16313            (CR-LF-TERM GREATER THAN 062)  AND
 16314            (CR-DT GREATER THAN 19810831)  AND
 16315            (CR-DT LESS THAN 19830901)
 16316             MOVE '*'             TO STATUTORY-SWITCH
 16317              GO TO 4150-EP-DO-LF-EP-NP.
 16318
 16319     IF STATE-ABBR (CLAS-INDEXS) = 'RI'
 16320         IF (CR-APR GREATER THAN ZERO)  AND
 16321            (CR-LF-TERM GREATER THAN 060)  AND
 16322            (CR-DT GREATER THAN 19831231)
 16323             MOVE '*'             TO STATUTORY-SWITCH
 16324              GO TO 4150-EP-DO-LF-EP-NP.
 16325
 16326     GO TO 4160-EP-DO-LF-EP-R78.
 16327
 16328 4140-EP-DO-LF-EP-TEX.
 16329
 16330     IF CR-PMT-FREQ = 0
 16331       DISPLAY '*************************************'
 16332       DISPLAY '***** CR-PMT-FREQ EQUAL TO ZERO *****'
 16333       DISPLAY '*************************************'
 16334       DISPLAY '***** CR-FULL-CONTROL -->' CR-FULL-CONTROL
 16335       DISPLAY '*************************************'
 16336       COMPUTE TEX-FACT-4 =
 16337          (CR-LF-TERM * CR-LF-TERM) +
 16338                               (WS-CR-PMT-FREQ * CR-LF-TERM)
 16339     ELSE
 16340        COMPUTE TEX-FACT-4 =
 16341         (CR-LF-TERM * CR-LF-TERM) + (CR-PMT-FREQ * CR-LF-TERM).
 16342
 16343     IF CR-PMT-FREQ = 0
 16344       DIVIDE REM-TRM1 BY WS-CR-PMT-FREQ
 16345           GIVING TEX-FACT-5
 16346               REMAINDER TEX-FACT-6
 16347     ELSE
 16348        DIVIDE REM-TRM1 BY CR-PMT-FREQ
 16349            GIVING TEX-FACT-5
 16350                REMAINDER TEX-FACT-6.
 16351
 16352     IF CR-PMT-FREQ > 0
 16353        MOVE CR-PMT-FREQ TO WS-CR-PMT-FREQ.
 16354
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 314
* ECS010MO.cbl
 16355     COMPUTE TEX-FACT-5 = TEX-FACT-5 * CR-PMT-FREQ.
 16356     COMPUTE TEX-FACT-7 = (TEX-FACT-5 * TEX-FACT-5) +
 16357         (TEX-FACT-5 * CR-PMT-FREQ) +
 16358         (2 * (TEX-FACT-6 * (TEX-FACT-5 + CR-PMT-FREQ))).
 16359     COMPUTE TEX-FACT-8 ROUNDED = TEX-FACT-7 / TEX-FACT-4.
 16360
 16361     COMPUTE EPR-R78 ROUNDED = WE-LFPRM - (WE-LFPRM * TEX-FACT-8).
 16362
 16363     GO TO 4170-EP-DO-LF-EP-PRO.
 16364
 16365 4150-EP-DO-LF-EP-NP.
 16366
 16367     IF WE-LFPRM = ZERO
 16368         GO TO 4160-EP-DO-LF-EP-R78.
 16369
 16370     IF DTE-CLIENT = 'CRI'
 16371       IF STATE-ABBR (CLAS-INDEXS) = ('AB' OR 'BC' OR 'MB' OR
 16372             'NS' OR 'ON' OR 'NB' OR 'NF' OR 'QB' OR 'SK' OR 'PE')
 16373           GO TO 4160-EP-DO-LF-EP-R78.
 16374
 16375     IF DTE-CLIENT = 'NCL'
 16376       IF CR-DT LESS THAN 19910101
 16377           GO TO 4160-EP-DO-LF-EP-R78.
 16378
 16379     IF REM-TRM1 = CR-LF-TERM
 16380         MOVE +0 TO EPR-R78  EPR-PRO  EPR-ST
 16381         GO TO 4190-EP-DO-LF-COMM.
 16382
 16383     MOVE CR-APR TO NP-APR.
 16384     MOVE CR-LF-TERM TO NP-ORIG  NP-CAP.
 16385     MOVE REM-TRM1 TO NP-REM.
 16386     MOVE CLAS-I-CALC-TYPE (CLAS-INDEXL) TO NP-OPT.
 16387     IF NP-OPT = 'T' OR 'U' OR 'V' OR 'W' OR 'X'
 16388         MOVE CR-LOAN-TERM TO NP-ORIG.
 16389
 16390     MOVE 'R' TO NP-OPT.
 16391     CALL 'ECSNETRM'
 16392         USING NP-APR NP-ORIG NP-REM NP-OPT NP-CAP NP-FACTOR.
 16393
 16394     COMPUTE EPR-R78 ROUNDED = WE-LFPRM - (NP-FACTOR * WE-LFPRM).
 16395
 16396     IF STATUTORY-REQUIREMENT
 16397         MOVE EPR-R78                TO EPR-ST.
 16398
 16399 4160-EP-DO-LF-EP-R78.
 16400
 16401     IF (CLAS-I-CALC-TYPE (CLAS-INDEXL) EQUAL 'B') AND
 16402        (DTE-CLIENT EQUAL 'NCL')
 16403        IF (CR-CCYY EQUAL EOM-CCYY) AND
 16404           (CR-MO EQUAL EOM-MO)
 16405           MOVE '*'            TO OB-DATE-1-SWITCH
 16406           MOVE EW-REIN-CO     TO WS-OB-REIN-CO (SUB3)
 16407           MOVE LIFE-OVERRIDE-L1 TO WS-OB-LF-AH (SUB3)
 16408           MOVE CR-LFTYP       TO WS-OB-BENEFIT-CODE (SUB3)
 16409           COMPUTE WS-EPR-R78 (SUB3 1) =
 16410                   WS-EPR-R78 (SUB3 1) + (WE-LFPRM * .5)
 16411           GO TO 4190-EP-DO-LF-COMM
 16412        ELSE
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 315
* ECS010MO.cbl
 16413        IF (CR-CCYY EQUAL OB-CCYY (1)) AND
 16414           (CR-MO EQUAL OB-MO (1))
 16415           MOVE '*'            TO OB-DATE-2-SWITCH
 16416           MOVE EW-REIN-CO     TO WS-OB-REIN-CO (SUB3)
 16417           MOVE LIFE-OVERRIDE-L1 TO WS-OB-LF-AH (SUB3)
 16418           MOVE CR-LFTYP       TO WS-OB-BENEFIT-CODE (SUB3)
 16419           COMPUTE WS-EPR-R78 (SUB3 2) =
 16420                   WS-EPR-R78 (SUB3 2) + (WE-LFPRM * .5)
 16421           GO TO 4190-EP-DO-LF-COMM
 16422        ELSE
 16423        IF (CR-CCYY EQUAL OB-CCYY (2)) AND
 16424           (CR-MO EQUAL OB-MO (2))
 16425           MOVE '*'            TO OB-DATE-3-SWITCH
 16426           MOVE EW-REIN-CO     TO WS-OB-REIN-CO (SUB3)
 16427           MOVE LIFE-OVERRIDE-L1 TO WS-OB-LF-AH (SUB3)
 16428           MOVE CR-LFTYP       TO WS-OB-BENEFIT-CODE (SUB3)
 16429           COMPUTE WS-EPR-R78 (SUB3 3) =
 16430                   WS-EPR-R78 (SUB3 3) + (WE-LFPRM * .5)
 16431           GO TO 4190-EP-DO-LF-COMM
 16432        ELSE
 16433           GO TO 4190-EP-DO-LF-COMM.
 16434
 16435     COMPUTE TEMP-1 = CR-LF-TERM * (CR-LF-TERM + 1).
 16436
 16437     IF DTE-R78 = '1'
 16438         COMPUTE TEMP-2 = REM-TRM1 * REM-TRM1
 16439     ELSE
 16440         COMPUTE TEMP-2 = REM-TRM1 * (REM-TRM1 + 1).
 16441
 16442     COMPUTE TEMP-4 ROUNDED EQUAL TEMP-2 / TEMP-1.
 16443
 16444     IF REM-TRM1 GREATER THAN +0
 16445         COMPUTE TEMP-7 ROUNDED EQUAL
 16446             WE-LFPRM - (WE-LFPRM * TEMP-4)
 16447     ELSE
 16448         MOVE WE-LFPRM                TO TEMP-7.
 16449
 16450     IF STATE-ABBR (CLAS-INDEXS) = 'AL'
 16451         MOVE TEMP-7                 TO EPR-ST.
 16452
 16453     IF CLAS-I-EP (CLAS-INDEXL) NOT = 'B'
 16454         MOVE ZEROS                  TO TEMP-8
 16455         GO TO 4165-END-LF-EP-R78.
 16456
 16457     IF EPR-ST = ZEROS
 16458         MOVE TEMP-7                 TO EPR-ST.
 16459
 16460     IF CLAS-I-CALC-TYPE (CLAS-INDEXL) NOT = 'L'
 16461         COMPUTE TEMP-1 = (CR-LF-TERM + 1) * (CR-LF-TERM + 2)
 16462         COMPUTE TEMP-2 = (REM-TRM1 + 1) * (REM-TRM1 + 2)
 16463         IF DTE-R78 = '1'
 16464             COMPUTE TEMP-2 = (REM-TRM1 + 1) * (REM-TRM1 + 1).
 16465
 16466     COMPUTE TEMP-4 ROUNDED EQUAL TEMP-2 / TEMP-1.
 16467
 16468     COMPUTE TEMP-8 ROUNDED =
 16469               WE-LFPRM-ALT - (WE-LFPRM-ALT * TEMP-4).
 16470
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 316
* ECS010MO.cbl
 16471 4165-END-LF-EP-R78.
 16472
 16473     IF EPR-R78 = ZEROS
 16474         COMPUTE EPR-R78 = TEMP-7 + TEMP-8
 16475     ELSE
 16476         COMPUTE EPR-R78 = EPR-R78 + TEMP-8.
 16477
 16478 4170-EP-DO-LF-EP-PRO.
 16479
 16480     IF DTE-CLIENT = 'MIC' OR 'MCC'
 16481         COMPUTE TEMP-5 ROUNDED = (REM-TRM1 - .5) / CR-LF-TERM
 16482     ELSE
 16483         COMPUTE TEMP-5 ROUNDED = REM-TRM1 / CR-LF-TERM.
 16484
 16485     IF REM-TRM1 GREATER THAN +0
 16486         COMPUTE TEMP-7 ROUNDED = WE-LFPRM - (WE-LFPRM * TEMP-5)
 16487     ELSE
 16488         MOVE WE-LFPRM                  TO TEMP-7.
 16489
 16490     IF CLAS-I-EP (CLAS-INDEXL) NOT = 'B'
 16491         MOVE ZEROS                     TO TEMP-8
 16492         GO TO 4175-END-LF-EP-PRO.
 16493
 16494     IF CLAS-I-CALC-TYPE (CLAS-INDEXL) NOT = 'L'
 16495         IF DTE-CLIENT = 'MIC' OR 'MCC'
 16496             COMPUTE TEMP-5 ROUNDED =
 16497                           (REM-TRM1 + .5) / (CR-LF-TERM + 1)
 16498         ELSE
 16499             COMPUTE TEMP-5 ROUNDED =
 16500                           (REM-TRM1 + 1) / (CR-LF-TERM + 1).
 16501
 16502     COMPUTE TEMP-8 ROUNDED =
 16503                   WE-LFPRM-ALT - (WE-LFPRM-ALT * TEMP-5).
 16504
 16505     COMPUTE EPR-ST = EPR-ST + TEMP-8.
 16506
 16507 4175-END-LF-EP-PRO.
 16508
 16509     COMPUTE EPR-PRO = TEMP-7 + TEMP-8.
 16510
 16511     GO TO 4185-EP-DO-LF-STATUTORY.
 16512
 16513 4180-EP-DO-LF-EP-SUM.
 16514
 16515     IF REM-TRM1 NOT GREATER +0
 16516         COMPUTE EPR-R78 = (WE-LFPRM + WE-LFPRM-ALT) - WE-LFRFND
 16517         MOVE EPR-R78 TO EPR-PRO  EPR-ST
 16518         GO TO 4190-EP-DO-LF-COMM.
 16519
 16520     COMPUTE ACTIVE-COUNT = CR-LIVES - CR-SUM-CAN-CNT-ITD.
 16521
 16522     IF WE-LFPRM = ZERO  AND  WE-LFPRM-ALT = ZERO
 16523         MOVE ZEROS                 TO TEMP-7
 16524     ELSE
 16525         COMPUTE TEMP-7 ROUNDED = WE-LFPRM - (WE-LFRFND *
 16526                       (WE-LFPRM / (WE-LFPRM + WE-LFPRM-ALT))).
 16527
 16528     IF TEMP-7 NOT GREATER ZERO
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 317
* ECS010MO.cbl
 16529         IF CLAS-I-EP (CLAS-INDEXL) NOT = 'B'
 16530             MOVE ZEROS             TO EPR-R78  EPR-PRO  EPR-ST
 16531             GO TO 4190-EP-DO-LF-COMM
 16532         ELSE
 16533             MOVE ZEROS             TO TEMP-7.
 16534
 16535     COMPUTE TEMP-1 = CR-LF-TERM * (CR-LF-TERM + 1).
 16536     COMPUTE TEMP-2 = REM-TRM1 * (REM-TRM1 + 1).
 16537     IF DTE-R78 = '1'
 16538         COMPUTE TEMP-2 = REM-TRM1 * REM-TRM1.
 16539
 16540     COMPUTE TEMP-4 ROUNDED = TEMP-2 / TEMP-1.
 16541     COMPUTE TEMP-5 ROUNDED = REM-TRM1 / CR-LF-TERM.
 16542
 16543     COMPUTE EPR-R78 ROUNDED = TEMP-7 - (TEMP-7 * TEMP-4).
 16544
 16545     COMPUTE EPR-PRO ROUNDED = TEMP-7 - (TEMP-7 * TEMP-5).
 16546
 16547     IF CLAS-I-EP (CLAS-INDEXL) NOT = 'B'
 16548         GO TO 4185-EP-DO-LF-STATUTORY.
 16549
 16550     MOVE EPR-R78                  TO EPR-ST.
 16551
 16552     IF WE-LFPRM = ZERO  AND  WE-LFPRM-ALT = ZERO
 16553         MOVE ZEROS                 TO TEMP-8
 16554     ELSE
 16555         COMPUTE TEMP-8 ROUNDED = WE-LFPRM-ALT - (WE-LFRFND *
 16556                     (WE-LFPRM-ALT / (WE-LFPRM + WE-LFPRM-ALT))).
 16557
 16558     IF TEMP-8 NOT GREATER ZERO
 16559         GO TO 4185-EP-DO-LF-STATUTORY.
 16560
 16561     COMPUTE EPR-R78 ROUNDED = EPR-R78 +
 16562                              (TEMP-8 - (TEMP-8 * TEMP-4)).
 16563
 16564     COMPUTE EPR-PRO ROUNDED = EPR-PRO +
 16565                              (TEMP-8 - (TEMP-8 * TEMP-5)).
 16566
 16567     COMPUTE EPR-ST ROUNDED = EPR-ST +
 16568                             (TEMP-8 - (TEMP-8 * TEMP-5)).
 16569
 16570 4185-EP-DO-LF-STATUTORY.
 16571
 16572*07635      IF STATE-ABBR (CLAS-INDEXS) = 'AL'
 16573*07636          MOVE EPR-R78                TO EPR-ST.
 16574     IF STATE-ABBR (CLAS-INDEXS) = 'WY'
 16575         MOVE EPR-PRO                TO EPR-ST.
 16576
 16577     IF (DTE-CLIENT = 'CID') AND
 16578        (STATE-ABBR (CLAS-INDEXS) = 'VA' OR 'TX') AND
 16579        (CLAS-I-RL-AH (CLAS-INDEXL) NOT = 'L') AND
 16580        (CLAS-I-EP (CLAS-INDEXL) NOT = 'B')
 16581           GO TO 4187-EP-DO-LF-STAT-ROA
 16582     END-IF.
 16583
 16584     IF EPR-ST NOT = ZEROS
 16585         GO TO 4190-EP-DO-LF-COMM.
 16586
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 318
* ECS010MO.cbl
 16587     IF CLAS-I-RL-AH (CLAS-INDEXL) = 'R'
 16588         MOVE EPR-R78                TO EPR-ST
 16589     ELSE
 16590         MOVE EPR-PRO                TO EPR-ST.
 16591
 16592     GO TO 4190-EP-DO-LF-COMM.
 16593
 16594 4187-EP-DO-LF-STAT-ROA.
 16595     PERFORM 4196-CALC-REM-AMT THRU 4199-EXIT.
 16596     MOVE CR-DT                      TO DC-GREG-DATE-CYMD.
 16597     MOVE 'L'                        TO DC-OPTION-CODE.
 16598     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 16599     MOVE DC-BIN-DATE-1              TO CP-CERT-EFF-DT.
 16600     IF CR-LOAN-1ST-PMT-DT IS NOT = ZEROS
 16601        MOVE CR-LOAN-1ST-PMT-DT      TO  DC-GREG-DATE-1-YMD
 16602        MOVE '3'                     TO  DC-OPTION-CODE
 16603        PERFORM 8000-DATE-CONVERT-ROUTINE THRU
 16604                              8099-DATE-CONVERT-X
 16605        MOVE DC-BIN-DATE-1           TO  CP-FIRST-PAY-DATE
 16606     ELSE
 16607        MOVE CP-CERT-EFF-DT          TO  DC-BIN-DATE-1
 16608        MOVE +1                      TO  DC-ELAPSED-MONTHS
 16609        MOVE +0                      TO  DC-ELAPSED-DAYS
 16610        MOVE '6'                     TO  DC-OPTION-CODE
 16611        PERFORM 8000-DATE-CONVERT-ROUTINE THRU
 16612                              8099-DATE-CONVERT-X
 16613        MOVE DC-BIN-DATE-2           TO  CP-FIRST-PAY-DATE
 16614     END-IF.
 16615     MOVE REM-TRM1                   TO CP-REMAINING-TERM.
 16616     MOVE CLAS-I-RL-AH (CLAS-INDEXL) TO CP-BENEFIT-TYPE.
 16617     MOVE SPACES                     TO CP-ACCT-FLD-5.
 16618     MOVE DTE-CLIENT                 TO CP-COMPANY-ID.
 16619     MOVE STATE-SUB (CLAS-INDEXS)    TO CP-STATE.
 16620     MOVE STATE-ABBR (CLAS-INDEXS)   TO CP-STATE-STD-ABBRV.
 16621     MOVE CR-AGE                     TO CP-ISSUE-AGE.
 16622     MOVE CR-LFPRM                   TO CP-ORIGINAL-PREMIUM
 16623     MOVE CR-LF-CRIT-PERIOD          TO CP-CRITICAL-MONTHS
 16624     MOVE CR-LF-TERM                 TO CP-ORIGINAL-TERM
 16625                                        CP-LOAN-TERM.
 16626     MOVE CR-LFAMT                   TO CP-ORIGINAL-BENEFIT
 16627                                        CP-RATING-BENEFIT-AMT.
 16628     MOVE WS-REM-AMT                 TO CP-REMAINING-BENEFIT
 16629     MOVE CR-APR                     TO CP-LOAN-APR.
 16630     MOVE CR-PMT-FREQ                TO CP-PAY-FREQUENCY.
 16631     MOVE CLAS-I-EP (CLAS-INDEXL)    TO CP-RATING-METHOD.
 16632     MOVE '6'                        TO CP-EARNING-METHOD.
 16633     MOVE '3'                        TO CP-PROCESS-TYPE.
 16634     MOVE ' '                        TO CP-SPECIAL-CALC-CD.
 16635     IF CR-RATING-CLASS NOT = SPACE AND ZERO
 16636         MOVE CR-RATING-CLASS        TO CP-CLASS-CODE
 16637     ELSE
 16638         MOVE AM-CAL-TABLE           TO CP-CLASS-CODE.
 16639     MOVE CR-LF-DEV-CODE             TO CP-DEVIATION-CODE.
 16640     MOVE CR-LF-DEV-PCT              TO CP-RATE-DEV-PCT.
 16641     MOVE CR-LFTYP                   TO CP-BENEFIT-CD.
 16642     MOVE DTE-CLASIC-COMPANY-CD      TO CP-COMPANY-CD.
 16643     MOVE CR-PMT-EXTENSION-DAYS      TO CP-TERM-OR-EXT-DAYS.
 16644     MOVE LIFE-OVERRIDE-L1           TO CP-LIFE-OVERRIDE-CODE.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 319
* ECS010MO.cbl
 16645
 16646     IF CP-STATE-STD-ABBRV = 'OR'
 16647        COMPUTE CP-RATING-BENEFIT-AMT = CR-LFAMT + CR-LFAMT-ALT
 16648     END-IF
 16649
 16650     IF (CP-RATE-AS-STANDARD) AND (CP-EARN-AS-NET-PAY)
 16651        COMPUTE CP-ORIGINAL-BENEFIT =
 16652         (CR-LFAMT - CR-LFPRM)
 16653     END-IF
 16654
 16655     IF CP-TRUNCATED-LIFE
 16656        MOVE CR-LOAN-TERM            TO CP-LOAN-TERM
 16657     END-IF
 16658
 16659     IF CP-TERM-IS-DAYS
 16660        MOVE CR-LF-TERM-IN-DAYS    TO CP-TERM-OR-EXT-DAYS
 16661     ELSE
 16662        MOVE ZEROS                 TO CP-TERM-OR-EXT-DAYS
 16663     END-IF
 16664
 16665     CALL 'ELRFNDX' USING CALCULATION-PASS-AREA.
 16666
 16667     COMPUTE EPR-ST = WE-LFPRM - CP-CALC-REFUND.
 16668
 16669 4190-EP-DO-LF-COMM.
 16670
 16671     MOVE +0 TO SUB1.
 16672     PERFORM 4300-EP-COMM-LOOP THRU 4350-EP-COMM-LOOP-X
 16673         10 TIMES.
 16674
 16675     IF REIN-EP-FLG NOT = 'R'  OR
 16676        CR-POLICY-IS-REIN-ONLY
 16677         MOVE ISS-BEN TO GROSS-ISS-BEN-LF
 16678         MOVE CNC-BEN TO GROSS-CNC-BEN-LF
 16679         MOVE ISS-PRM TO GROSS-ISS-PRM-LF
 16680         MOVE CNC-PRM TO GROSS-CNC-PRM-LF.
 16681
 16682     ADD ISS-BEN TO EW-ISS-BEN.
 16683     ADD GROSS-ISS-BEN-LF TO EW-ISS-BEN-GROSS.
 16684     ADD CNC-BEN TO EW-CNC-BEN.
 16685     ADD GROSS-CNC-BEN-LF TO EW-CNC-BEN-GROSS.
 16686     ADD ISS-PRM TO EW-ISS-PRM.
 16687     ADD GROSS-ISS-PRM-LF TO EW-ISS-PRM-GROSS.
 16688     ADD CNC-PRM TO EW-CNC-PRM.
 16689     ADD GROSS-CNC-PRM-LF TO EW-CNC-PRM-GROSS.
 16690
 16691     COMPUTE EW-EPR-R78 = EW-EPR-R78 + EPR-R78.
 16692     COMPUTE EW-EPR-PRO = EW-EPR-PRO + EPR-PRO.
 16693     COMPUTE EW-EPR-ST  = EW-EPR-ST  + EPR-ST.
 16694
 16695     IF CR-LF-ISS-PREM-TAX NOT NUMERIC
 16696        MOVE +0                  TO CR-LF-ISS-PREM-TAX
 16697     END-IF
 16698     IF CR-LF-CNC-PREM-TAX NOT NUMERIC
 16699        MOVE +0                  TO CR-LF-CNC-PREM-TAX
 16700     END-IF
 16701
 16702     COMPUTE ISS-PRMTAX =
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 320
* ECS010MO.cbl
 16703        (ISS-PRM * CR-LF-ISS-PREM-TAX) -
 16704        (CNC-PRM * CR-LF-CNC-PREM-TAX)
 16705
 16706     COMPUTE EW-ISS-PRM-TAX = EW-ISS-PRM-TAX + ISS-PRMTAX
 16707
 16708     IF LIFE-FULLY-EARNED
 16709         COMPUTE EW-EPR-R78-ADJ = EW-EPR-R78-ADJ +
 16710                                            (ISS-PRM - EPR-R78)
 16711         COMPUTE EW-EPR-PRO-ADJ = EW-EPR-PRO-ADJ +
 16712                                            (ISS-PRM - EPR-PRO)
 16713         COMPUTE EW-EPR-ST-ADJ  = EW-EPR-ST-ADJ +
 16714                                            (ISS-PRM - EPR-ST).
 16715
 16716     IF  DTE-OPT-RESERVE-METHOD-AUTH
 16717         IF  REIN-EP-FLG NOT = 'R'
 16718                 OR
 16719             CR-POLICY-IS-REIN-ONLY
 16720             MOVE 'L'      TO W-CLAIM-TYPE
 16721             MOVE EPR-R78  TO W-OPT-R78
 16722             MOVE EPR-PRO  TO W-OPT-PRO
 16723             MOVE EPR-ST   TO W-OPT-ST
 16724             PERFORM 4600-GET-OPT-IBNR THRU 4600-EXIT
 16725             MOVE ZEROS    TO EW-CLM-IBNR
 16726         ELSE
 16727             IF  STOP-LF-DATE LESS THAN EOM-RUN-DATE
 16728                 MOVE 'N'        TO EPEC-LINE-NOT-USED-IND (SUB3)
 16729                 MOVE ZEROS      TO EW-CLM-IBNR
 16730             ELSE
 16731                 MOVE ZEROS      TO EW-CLM-IBNR
 16732     ELSE
 16733         IF  DTE-CLIENT NOT EQUAL 'ITG'
 16734             ADD WE-DTH-IBNR
 16735                       TO EW-CLM-IBNR
 16736         ELSE
 16737             IF  CLAS-I-BAL (CLAS-INDEXL) = 'B'
 16738                     AND
 16739                 CR-DT GREATER THAN LAST-YRS-DATE
 16740                 COMPUTE  EW-CLM-IBNR
 16741                     = EW-CLM-IBNR + (WE-LFAMT * .0000500).
 16742
 16743     ADD WE-DTH-PAYCUR TO EW-CLM-PAYCUR.
 16744     ADD WE-DTH-FUTRSV TO EW-CLM-FUTRSV.
 16745
 16746 4191-CONTINUE.
 16747
 16748     MOVE 'Y'          TO EW-LEVEL-USED.
 16749
 16750     IF CR-POLICY-UNDERWRITTEN
 16751         MOVE EPEC-WORK       TO EPEC-LEVELS-II (SUB3)
 16752         MOVE EPEC-OPT-WORK-TABLE
 16753                              TO EPEC-UNDW-OPT-DATA-TABLE
 16754     ELSE
 16755         MOVE EPEC-WORK       TO EPEC-LEVELS (SUB3)
 16756         MOVE EPEC-OPT-WORK-TABLE
 16757                              TO EPEC-OPT-DATA-TABLE.
 16758
 16759     GO TO 4200-EP-DO-AH.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 321
* ECS010MO.cbl
 16761 4194-SLOT-INTO-EFFECTED-MONTHS.
 16762
 16763     IF  CR-DT NOT GREATER THAN EOM-DATE (SUBM)
 16764             AND
 16765         CR-LF-EXPIRE-DATE GREATER THAN EOM-DATE (SUBM)
 16766             AND
 16767         (CR-LF-CANC-DT GREATER THAN EOM-DATE (SUBM)
 16768                 OR
 16769          CR-LF-CANC-DT EQUAL ZEROS)
 16770             AND
 16771         (CR-LF-CLAIM-EXIT-DATE GREATER THAN EOM-DATE (SUBM)
 16772                 OR
 16773          CR-LF-CLAIM-EXIT-DATE EQUAL ZEROS)
 16774         MOVE 'Y'                 TO W-TABLE-USED-SW
 16775         IF  CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'Z'
 16776             COMPUTE EPEC-LIFE-CTR (SUB3 SUBM) ROUNDED
 16777                 = EPEC-LIFE-CTR (SUB3 SUBM)
 16778                 + CR-LIVES
 16779         ELSE
 16780             COMPUTE EPEC-LIFE-CTR (SUB3 SUBM)
 16781                 = EPEC-LIFE-CTR (SUB3 SUBM) + 1.
 16782
 16783 4194-EXIT.
 16784     EXIT.
 16785
 16786 4196-CALC-REM-AMT.
 16787
 16788     IF CR-LFTYP = 'QD'
 16789        MOVE +15.0               TO CR-APR
 16790     END-IF
 16791
 16792     MOVE +0                     TO WS-REM-AMT
 16793     IF CLAS-I-RL-AH (CLAS-INDEXL) = 'L' OR 'P'
 16794        IF CLAS-I-EP (CLAS-INDEXL) = 'B' OR 'K' OR 'L'
 16795           COMPUTE WS-REM-AMT =
 16796             CR-LFAMT + CR-LFAMT-ALT
 16797        ELSE
 16798           MOVE CR-LFAMT         TO WS-REM-AMT
 16799        END-IF
 16800        GO TO 4199-EXIT
 16801     END-IF
 16802
 16803     COMPUTE INTERMED ROUNDED = CR-LFAMT / CR-LF-TERM
 16804
 16805     IF REM-TRM1 = CR-LF-TERM
 16806        IF CLAS-I-EP (CLAS-INDEXL) = 'B' OR 'K' OR 'L'
 16807           COMPUTE WS-REM-AMT =
 16808             CR-LFAMT + CR-LFAMT-ALT
 16809        ELSE
 16810           MOVE CR-LFAMT         TO WS-REM-AMT
 16811        END-IF
 16812        GO TO 4199-EXIT
 16813     END-IF
 16814
 16815     IF CLAS-I-EP (CLAS-INDEXL) = 'B' OR 'K' OR 'L'
 16816        GO TO 4198-ORDINARY-REM
 16817     END-IF
 16818
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 322
* ECS010MO.cbl
 16819     IF CLAS-I-EP (CLAS-INDEXL) = 'T'
 16820        GO TO 4198-CALC-TEXAS-REM
 16821     END-IF
 16822
 16823     IF CR-LFTYP = 'QD'
 16824        MOVE +15.0               TO CR-APR
 16825        MOVE 'N'                 TO
 16826                       CLAS-I-CALC-TYPE (CLAS-INDEXL)
 16827        GO TO 4198-CALC-NET-PAY-REM
 16828     END-IF
 16829
 16830     IF CLAS-I-EP (CLAS-INDEXL) = 'N'
 16831        GO TO 4198-CALC-NET-PAY-REM
 16832     END-IF
 16833
 16834     IF (STATE-ABBR (CLAS-INDEXS) = 'OH') AND
 16835        (CR-RATING-CLASS NOT = 'L ')
 16836         IF (CR-LF-TERM GREATER THAN +60) AND
 16837            (CR-DT GREATER THAN 19831031) AND
 16838            (CR-APR GREATER THAN ZERO)
 16839             GO TO 4198-CALC-NET-PAY-REM
 16840        END-IF
 16841     END-IF
 16842
 16843     IF STATE-ABBR (CLAS-INDEXS) = 'MT'
 16844         IF (CR-LF-TERM GREATER THAN +61) AND
 16845            (CR-DT  GREATER THAN 19830318) AND
 16846            (CR-APR GREATER THAN ZERO)
 16847             GO TO 4198-CALC-NET-PAY-REM
 16848        END-IF
 16849     END-IF
 16850
 16851     IF STATE-ABBR (CLAS-INDEXS) = 'UT'
 16852         IF (CR-LF-TERM GREATER THAN +62) AND
 16853            (CR-DT  GREATER THAN 19810831) AND
 16854            (CR-DT  LESS THAN 19830901) AND
 16855            (CR-APR GREATER THAN ZERO)
 16856             GO TO 4198-CALC-NET-PAY-REM
 16857        END-IF
 16858     END-IF
 16859
 16860     IF STATE-ABBR (CLAS-INDEXS) = 'RI'
 16861         IF (CR-LF-TERM GREATER THAN +60) AND
 16862            (CR-DT  GREATER THAN 19831231) AND
 16863            (CR-APR GREATER THAN ZERO)
 16864             GO TO 4198-CALC-NET-PAY-REM
 16865        END-IF
 16866     END-IF
 16867
 16868     .
 16869 4198-ORDINARY-REM.
 16870
 16871     IF CLAS-I-EP (CLAS-INDEXL) = 'B' OR 'K' OR 'L'
 16872         COMPUTE WS-REM-AMT ROUNDED =
 16873                  (INTERMED * REM-TRM2) + CR-LFAMT-ALT
 16874     ELSE
 16875         COMPUTE WS-REM-AMT ROUNDED = INTERMED * REM-TRM2
 16876     END-IF
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 323
* ECS010MO.cbl
 16877
 16878     GO TO 4199-EXIT
 16879
 16880     .
 16881 4198-CALC-TEXAS-REM.
 16882
 16883     DIVIDE CR-LFAMT BY CR-LF-TERM
 16884         GIVING TEX-FACT-1.
 16885     DIVIDE REM-TRM2 BY CR-PMT-FREQ
 16886         GIVING TEX-FACT-2
 16887         REMAINDER TEX-FACT-3.
 16888
 16889     IF TEX-FACT-3 NOT = ZERO
 16890         ADD +1                  TO TEX-FACT-2
 16891     END-IF
 16892
 16893     IF (TEX-FACT-2 * CR-PMT-FREQ) = CR-LF-TERM
 16894         MOVE CR-LFAMT           TO WS-REM-AMT
 16895     ELSE
 16896         COMPUTE WS-REM-AMT ROUNDED =
 16897             (TEX-FACT-1 * (TEX-FACT-2 * CR-PMT-FREQ))
 16898     END-IF
 16899
 16900     GO TO 4199-EXIT
 16901
 16902     .
 16903 4198-CALC-NET-PAY-REM.
 16904
 16905     MOVE CR-DT                      TO DC-GREG-DATE-CYMD.
 16906     MOVE 'L'                        TO DC-OPTION-CODE.
 16907     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 16908     MOVE DC-BIN-DATE-1              TO CP-CERT-EFF-DT.
 16909
 16910     IF CR-LOAN-1ST-PMT-DT IS NOT = ZEROS
 16911        MOVE CR-LOAN-1ST-PMT-DT  TO  DC-GREG-DATE-1-YMD
 16912        MOVE '3'                 TO  DC-OPTION-CODE
 16913        PERFORM 8000-DATE-CONVERT-ROUTINE THRU
 16914                                  8099-DATE-CONVERT-X
 16915        MOVE DC-BIN-DATE-1       TO  CP-FIRST-PAY-DATE
 16916     ELSE
 16917        MOVE CP-CERT-EFF-DT      TO  DC-BIN-DATE-1
 16918        MOVE +1                  TO  DC-ELAPSED-MONTHS
 16919        MOVE +0                  TO  DC-ELAPSED-DAYS
 16920        MOVE '6'                 TO  DC-OPTION-CODE
 16921        PERFORM 8000-DATE-CONVERT-ROUTINE THRU
 16922                                  8099-DATE-CONVERT-X
 16923        MOVE DC-BIN-DATE-2       TO  CP-FIRST-PAY-DATE
 16924     END-IF
 16925
 16926     IF CLAS-I-EP (CLAS-INDEXL) = 'B' OR 'K' OR 'L'
 16927        COMPUTE CP-ORIGINAL-BENEFIT = CR-LFAMT + CR-LFAMT-ALT
 16928     ELSE
 16929        MOVE CR-LFAMT            TO  CP-ORIGINAL-BENEFIT
 16930     END-IF
 16931     MOVE CR-APR                 TO  CP-LOAN-APR
 16932     MOVE CR-LF-TERM             TO  CP-ORIGINAL-TERM
 16933     MOVE CR-LOAN-TERM           TO  CP-LOAN-TERM
 16934     MOVE REM-TRM2               TO  CP-REMAINING-TERM
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 324
* ECS010MO.cbl
 16935     MOVE CLAS-I-CALC-TYPE (CLAS-INDEXL)
 16936                                 TO CP-SPECIAL-CALC-CD
 16937     MOVE CLAS-I-RL-AH (CLAS-INDEXL)
 16938                                 TO  CP-BENEFIT-TYPE
 16939     MOVE CLAS-I-EP (CLAS-INDEXL)
 16940                                 TO  CP-EARNING-METHOD
 16941
 16942     CALL 'ELRAMTX' USING CALCULATION-PASS-AREA
 16943
 16944     MOVE CP-REMAINING-AMT       TO  WS-REM-AMT
 16945
 16946     .
 16947 4199-EXIT.
 16948     EXIT.
 16949
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 325
* ECS010MO.cbl
 16951******************************************************************
 16952***   C A L C U L A T E   A & H   E A R N E D   P R E M I U M  ***
 16953******************************************************************
 16954
 16955 4200-EP-DO-AH.
 16956
 16957*     DISPLAY ' MADE IT TO 4200 '
 16958     MOVE +0                         TO ISS-BEN  EPR-R78
 16959                                        CNC-BEN  EPR-PRO
 16960                                        ISS-PRM  EPR-ST
 16961                                        CNC-PRM
 16962                                        WX-CLM-AMT
 16963                                        WX-CLM-EXP
 16964                                        WX-CLM-CNT
 16965                                        WX-CLM-CRT
 16966                                        WX-ACTIVE-COUNT
 16967                                        ISS-PRMTAX
 16968                                        WX-CNC-CNT.
 16969     MOVE SPACE                      TO A-H-EARNED-SWITCH.
 16970
 16971     IF CR-AHTYP = ZERO
 16972         GO TO 4295-EP-DO-COUNT.
 16973
 16974     IF REIN-EP-FLG = 'R'
 16975         IF REIN-AH-FLG (SUB5) = SPACE
 16976             GO TO 4295-EP-DO-COUNT.
 16977
 16978     MOVE AH-OVERRIDE-L1       TO WE-LF-AH.
 16979     MOVE CR-AHTYP             TO WE-BEN-TYPE.
 16980     PERFORM 4400-EP-FIND-TAB-ENT THRU 4499-EP-FIND-TAB-ENT-X.
 16981
 16982     IF CR-POLICY-IS-DECLINED  OR
 16983        CR-POLICY-IS-VOID
 16984         GO TO 4290-CONTINUE.
 16985
 16986     MOVE CR-AH-TERM           TO ORIG-TERM.
 16987
 16988     IF CR-DT GREATER EW-COV-DTE
 16989         MOVE CR-DT            TO EW-COV-DTE.
 16990
 16991     IF NOT CR-POLICY-IS-RESTORE  AND
 16992        NOT CR-POLICY-IS-REISSUE
 16993        AND NOT CR-POLICY-IS-MONTHLY
 16994         MOVE WE-AHAMT         TO ISS-BEN
 16995         COMPUTE EW-ORIG-TERM = EW-ORIG-TERM + ORIG-TERM
 16996         COMPUTE EW-AGE = EW-AGE + CR-AGE
 16997         COMPUTE EW-AGE-BEN = EW-AGE-BEN + (CR-AGE * ISS-BEN)
 16998         COMPUTE EW-TERM-BEN = EW-TERM-BEN +
 16999                                   (ORIG-TERM * ISS-BEN).
 17000
 17001     MOVE CLAS-INDEXA     TO W-NDX.
 17002     MOVE RUN-DATE        TO VALUATION-DT
 17003     MOVE '6'             TO W-VAL-SOURCE.
 17004
 17005     IF REIN-EP-FLG = 'R'
 17006         IF REIN-AH-RUNOFF-SW (SUB5) = 'N'  AND
 17007            EARNING-STOP-DATE LESS THAN VALUATION-DT
 17008             MOVE EARNING-STOP-DATE TO VALUATION-DT
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 326
* ECS010MO.cbl
 17009             MOVE '10'              TO W-VAL-SOURCE.
 17010
 17011*     DISPLAY ' B4 RTRM'
 17012     PERFORM 8500-REMAINING-TERM-ROUTINE THRU 8599-REM-TERM-X.
 17013*     DISPLAY ' AFTER RTRM'
 17014
 17015     IF (CR-AH-CURRENT-STATUS = '1' OR '4') AND
 17016        (REM-TRM3 GREATER ZERO)
 17017        IF CLAS-I-CALC-TYPE (CLAS-INDEXA) = 'Z'
 17018            COMPUTE EW-INFORCE-CNT = EW-INFORCE-CNT +
 17019                                  (CR-LIVES - CR-SUM-CAN-CNT-ITD)
 17020            COMPUTE EW-REM-TERM = EW-REM-TERM +
 17021                     (REM-TRM3 * (CR-LIVES - CR-SUM-CAN-CNT-ITD))
 17022          ELSE
 17023            COMPUTE EW-INFORCE-CNT = EW-INFORCE-CNT + 1
 17024            COMPUTE EW-REM-TERM = EW-REM-TERM + REM-TRM3.
 17025
 17026     IF  DTE-OPT-RESERVE-METHOD-UNAUTH
 17027         GO TO 4210-BY-OPT-LOGIC.
 17028
 17029     IF  CR-DT NOT GREATER THAN EOM-DATE (13)
 17030             AND
 17031         CR-AH-EXPIRE-DATE GREATER THAN EOM-DATE (1)
 17032             AND
 17033         (CR-AH-CANC-DT GREATER THAN EOM-DATE (1)
 17034                 OR
 17035          CR-AH-CANC-DT EQUAL ZEROS)
 17036         MOVE 'Y'                TO EPEC-LIFE-CTR-USED-IND (SUB3)
 17037         PERFORM 4296-SLOT-INTO-EFFECTED-MONTHS THRU 4296-EXIT
 17038                 VARYING
 17039             SUBM FROM +1 BY +1
 17040                 UNTIL
 17041             SUBM GREATER THAN +13.
 17042
 17043     MOVE EW-SUB-KEY             TO EPEC-SUB-KEY-OPT (SUB3).
 17044     MOVE EW-REIN-CO             TO EPEC-REIN-CO-OPT (SUB3).
 17045
 17046 4210-BY-OPT-LOGIC.
 17047
 17048     IF CLAS-I-CALC-TYPE (CLAS-INDEXA) = 'Z'
 17049         ADD CR-LIVES TO EW-ISS-CNT
 17050         MOVE WE-AHPRM TO ISS-PRM
 17051         COMPUTE EW-ORIG-TERM = EW-ORIG-TERM +
 17052                                (ORIG-TERM * CR-LIVES)
 17053         COMPUTE EW-AGE = EW-AGE + (CR-AGE * CR-LIVES)
 17054         COMPUTE EW-AGE-BEN = EW-AGE-BEN + (CR-AGE * ISS-BEN)
 17055         COMPUTE EW-TERM-BEN = EW-TERM-BEN +
 17056                                   (ORIG-TERM * ISS-BEN)
 17057         PERFORM 4825-EP-DO-AH-CNCL-SUM THRU 4899-EXIT
 17058         GO TO 4225-CONTINUE.
 17059
 17060     IF (NOT CR-POLICY-IS-RESTORE) AND
 17061        (NOT CR-POLICY-IS-REISSUE)
 17062        AND (NOT CR-POLICY-IS-MONTHLY)
 17063        ADD +1 TO EW-ISS-CNT.
 17064
 17065     PERFORM 4800-CALC-EARNED-PREMIUM-AH THRU 4899-EXIT.
 17066
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 327
* ECS010MO.cbl
 17067 4225-CONTINUE.
 17068
 17069*     DISPLAY ' 4225 '
 17070     IF  EPEC-CLM-EXP (SUB3)  NUMERIC
 17071         NEXT  SENTENCE
 17072       ELSE
 17073         MOVE ZEROS TO EPEC-CLM-EXP (SUB3).
 17074
 17075     ADD WX-CLM-AMT              TO EW-CLM-AMT.
 17076     ADD WX-CLM-EXP              TO EPEC-CLM-EXP (SUB3).
 17077     ADD WX-CLM-CNT              TO EW-CLM-CNT.
 17078     ADD WX-CLM-CRT              TO EW-CLM-CRT.
 17079     ADD WX-ACTIVE-COUNT         TO ACTIVE-COUNT.
 17080     ADD WX-CNC-CNT              TO EW-CNC-CNT.
 17081
 17082     MOVE +0           TO SUB1.
 17083     PERFORM 4300-EP-COMM-LOOP THRU 4350-EP-COMM-LOOP-X
 17084         10 TIMES.
 17085     MOVE +0                     TO SUB16
 17086     PERFORM 4375-EP-BANK-COMM   THRU 4375-EXIT VARYING
 17087        WS-SUB1 FROM +1 BY +1 UNTIL WS-SUB1 > +10
 17088
 17089     IF REIN-EP-FLG NOT = 'R'  OR
 17090        CR-POLICY-IS-REIN-ONLY
 17091         MOVE ISS-BEN TO GROSS-ISS-BEN-AH
 17092         MOVE CNC-BEN TO GROSS-CNC-BEN-AH
 17093         MOVE ISS-PRM TO GROSS-ISS-PRM-AH
 17094         MOVE CNC-PRM TO GROSS-CNC-PRM-AH.
 17095
 17096     ADD ISS-BEN TO EW-ISS-BEN.
 17097     ADD GROSS-ISS-BEN-AH TO EW-ISS-BEN-GROSS.
 17098     ADD CNC-BEN TO EW-CNC-BEN.
 17099     ADD GROSS-CNC-BEN-AH TO EW-CNC-BEN-GROSS.
 17100     ADD ISS-PRM TO EW-ISS-PRM.
 17101     ADD GROSS-ISS-PRM-AH TO EW-ISS-PRM-GROSS.
 17102     ADD CNC-PRM TO EW-CNC-PRM.
 17103     ADD GROSS-CNC-PRM-AH TO EW-CNC-PRM-GROSS.
 17104
 17105     COMPUTE EW-EPR-R78 = EW-EPR-R78 + EPR-R78.
 17106     COMPUTE EW-EPR-PRO = EW-EPR-PRO + EPR-PRO.
 17107     COMPUTE EW-EPR-ST  = EW-EPR-ST  + EPR-ST.
 17108
 17109     IF CR-AH-ISS-PREM-TAX NOT NUMERIC
 17110        MOVE ZEROS               TO CR-AH-ISS-PREM-TAX
 17111     END-IF
 17112     IF CR-AH-CNC-PREM-TAX NOT NUMERIC
 17113        MOVE ZEROS               TO CR-AH-CNC-PREM-TAX
 17114     END-IF
 17115     COMPUTE ISS-PRMTAX =
 17116        (ISS-PRM * CR-AH-ISS-PREM-TAX) -
 17117        (CNC-PRM * CR-AH-CNC-PREM-TAX)
 17118     COMPUTE EW-ISS-PRM-TAX = EW-ISS-PRM-TAX + ISS-PRMTAX
 17119
 17120     IF A-H-FULLY-EARNED
 17121         COMPUTE EW-EPR-R78-ADJ = EW-EPR-R78-ADJ +
 17122                                            (ISS-PRM - EPR-R78)
 17123         COMPUTE EW-EPR-PRO-ADJ = EW-EPR-PRO-ADJ +
 17124                                            (ISS-PRM - EPR-PRO)
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 328
* ECS010MO.cbl
 17125         COMPUTE EW-EPR-ST-ADJ  = EW-EPR-ST-ADJ +
 17126                                            (ISS-PRM - EPR-ST).
 17127
 17128     IF  DTE-OPT-RESERVE-METHOD-AUTH
 17129         IF  REIN-EP-FLG NOT = 'R'
 17130                 OR
 17131             CR-POLICY-IS-REIN-ONLY
 17132             MOVE 'A'      TO W-CLAIM-TYPE
 17133             MOVE EPR-R78  TO W-OPT-R78
 17134             MOVE EPR-PRO  TO W-OPT-PRO
 17135             MOVE EPR-ST   TO W-OPT-ST
 17136             PERFORM 4600-GET-OPT-IBNR THRU 4600-EXIT
 17137             MOVE ZEROS    TO EW-CLM-IBNR
 17138         ELSE
 17139             IF  STOP-AH-DATE LESS THAN EOM-RUN-DATE
 17140                 MOVE 'N'   TO EPEC-LINE-NOT-USED-IND (SUB3)
 17141                 MOVE ZEROS TO EW-CLM-IBNR
 17142             ELSE
 17143                 MOVE ZEROS TO EW-CLM-IBNR
 17144     ELSE
 17145         IF  DTE-CLIENT NOT EQUAL 'ITG'
 17146             ADD WE-DIS-IBNR     TO EW-CLM-IBNR
 17147         ELSE
 17148             IF  CLAS-I-BAL (CLAS-INDEXA) NOT EQUAL 'B'
 17149                 IF  CR-AH-POLICY-IS-ACTIVE
 17150                     COMPUTE  EW-CLM-IBNR  =  EW-CLM-IBNR
 17151                              + ((WE-AHPRM - EPR-PRO) * .0730000)
 17152                 ELSE
 17153                     NEXT SENTENCE
 17154             ELSE
 17155                 IF  CR-DT GREATER THAN LAST-YRS-DATE
 17156                     COMPUTE  EW-CLM-IBNR
 17157                         = EW-CLM-IBNR + (WE-AHPRM * .0600000).
 17158
 17159     ADD WE-DIS-PAYCUR TO EW-CLM-PAYCUR.
 17160     ADD WE-DIS-FUTRSV TO EW-CLM-FUTRSV.
 17161
 17162 4290-CONTINUE.
 17163*     DISPLAY ' 4290 '
 17164
 17165     MOVE 'Y'          TO EW-LEVEL-USED.
 17166
 17167     IF CR-POLICY-UNDERWRITTEN
 17168         MOVE EPEC-WORK       TO EPEC-LEVELS-II (SUB3)
 17169         MOVE EPEC-OPT-WORK-TABLE
 17170                              TO EPEC-UNDW-OPT-DATA-TABLE
 17171     ELSE
 17172         MOVE EPEC-WORK       TO EPEC-LEVELS (SUB3)
 17173         MOVE EPEC-OPT-WORK-TABLE
 17174                              TO EPEC-OPT-DATA-TABLE.
 17175
 17176
 17177 4295-EP-DO-COUNT.
 17178
 17179     IF REIN-EP-FLG = 'R'
 17180         ADD ACTIVE-COUNT TO BC-R-A-CERTS
 17181     ELSE
 17182         ADD ACTIVE-COUNT TO BC-G-A-CERTS.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 329
* ECS010MO.cbl
 17183
 17184     GO TO 4299-EPBX.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 330
* ECS010MO.cbl
 17186 4296-SLOT-INTO-EFFECTED-MONTHS.
 17187
 17188     IF  CR-DT NOT GREATER THAN EOM-DATE (SUBM)
 17189             AND
 17190         CR-AH-EXPIRE-DATE GREATER THAN EOM-DATE (SUBM)
 17191             AND
 17192         (CR-AH-CANC-DT GREATER THAN EOM-DATE (SUBM)
 17193                 OR
 17194          CR-AH-CANC-DT EQUAL ZEROS)
 17195         MOVE 'Y'                 TO W-TABLE-USED-SW
 17196         IF  CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'Z'
 17197             COMPUTE EPEC-LIFE-CTR (SUB3 SUBM) ROUNDED
 17198                 = EPEC-LIFE-CTR (SUB3 SUBM)
 17199                 + CR-LIVES
 17200         ELSE
 17201             COMPUTE EPEC-LIFE-CTR (SUB3 SUBM)
 17202                 = EPEC-LIFE-CTR (SUB3 SUBM) + 1.
 17203
 17204 4296-EXIT.
 17205     EXIT.
 17206
 17207 4299-EPBX.
 17208     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 331
* ECS010MO.cbl
 17210******************************************************************
 17211***    C A L C U L A T E   E A R N E D   C O M M I S S I O N   ***
 17212******************************************************************
 17213
 17214 4300-EP-COMM-LOOP.
 17215*     DISPLAY ' 4300 '
 17216     IF DTE-CLIENT = 'DMD'
 17217         GO TO 4350-EP-COMM-LOOP-X.
 17218
 17219     ADD +1                         TO SUB1.
 17220     MOVE ZEROS                     TO SUB16.
 17221
 17222     IF CR-ADDL-CLP NOT NUMERIC
 17223        MOVE ZEROS               TO CR-ADDL-CLP
 17224     END-IF
 17225     IF CR-COM-AGT (SUB1) = SPACES OR ZEROS
 17226         GO TO 4350-EP-COMM-LOOP-X.
 17227
 17228 4300-AGENT-LOOP.
 17229
 17230     ADD +1                         TO SUB16.
 17231
 17232     IF SUB16 GREATER THAN WS-LOOP-MAX
 17233         DISPLAY 'ERROR OCCURRED - MAXIMUM AGENT LEVELS EXCEEDED'
 17234         DISPLAY 'CONTROL= ' CR-FULL-CONTROL
 17235         MOVE 'ERR0R OCCURRED - MAXIMUM AGENT LEVELS EXCEEDED'
 17236                                     TO WS-ABEND-MESSAGE
 17237         MOVE DC-ERROR-CODE          TO WS-ABEND-FILE-STATUS
 17238         MOVE 4001                   TO WS-ABEND-CODE
 17239         GO TO ABEND-PGM.
 17240
 17241     IF EW-AGT-NO (SUB16) = SPACES
 17242         MOVE CR-COM-AGT  (SUB1)     TO EW-AGT-NO   (SUB16)
 17243         MOVE CR-AGT-TYPE (SUB1)     TO EW-AGT-TYPE (SUB16)
 17244     ELSE
 17245         IF (CR-COM-AGT (SUB1)  = EW-AGT-NO   (SUB16)) AND
 17246            (CR-AGT-TYPE (SUB1) = EW-AGT-TYPE (SUB16))
 17247             NEXT SENTENCE
 17248         ELSE
 17249             GO TO 4300-AGENT-LOOP.
 17250
 17251     IF EW-LF-AH = AH-OVERRIDE-L1
 17252         GO TO 4350-EP-COMM-LOOP-A.
 17253
 17254     IF (DTE-CLIENT = 'DCC')
 17255        AND (REIN-EP-FLG = 'R')
 17256        AND (CR-AGT-TYPE (SUB1) = 'P' OR 'T')
 17257        AND (WE-LFPRM NOT = ZEROS)
 17258        IF CLAS-I-BEN-CATEGORY (CLAS-INDEXL) = 'D'
 17259           COMPUTE ISS-WK ROUNDED =
 17260              CR-LF-NSP-PRM * CR-LCOM-L (SUB1)
 17261        ELSE
 17262           COMPUTE WS-CEDE-FACT = RWF-LFAMT /
 17263               (CR-LFAMT + CR-LFAMT-ALT)
 17264           COMPUTE ISS-WK ROUNDED = ((CR-LFPRM + CR-LFPRM-ALT)
 17265              * WS-CEDE-FACT) * CR-LCOM-L (SUB1)
 17266        END-IF
 17267     ELSE
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 332
* ECS010MO.cbl
 17268        IF CR-AGT-TYPE (SUB1) = 'B' OR 'I' OR 'K' OR 'L'
 17269                             OR 'J'
 17270           COMPUTE ISS-WK = CR-LCOM-L (SUB1) * +1000
 17271        ELSE
 17272           IF CR-AGT-TYPE (SUB1) = 'A'
 17273              COMPUTE ISS-WK ROUNDED =
 17274                   CR-LF-CLP * CR-LCOM-L (SUB1)
 17275           ELSE
 17276              IF (CR-AGT-TYPE (SUB1) = 'O' OR 'P' OR 'M')
 17277                 AND (CLAS-I-BEN-CATEGORY (CLAS-INDEXL) = 'D')
 17278                 COMPUTE ISS-WK ROUNDED =
 17279                      CR-LF-CLP * CR-LCOM-L (SUB1)
 17280                 DISPLAY ' MADE IT TO LF DD AGT P '
 17281                    CR-LF-CLP ' ' CR-LCOM-L (SUB1)
 17282              ELSE
 17283                 COMPUTE ISS-WK  ROUNDED = ISS-PRM
 17284                    * CR-LCOM-L (SUB1)
 17285              END-IF
 17286           END-IF
 17287        END-IF
 17288     END-IF
 17289
 17290     COMPUTE EW-ISS-COM (SUB16) = EW-ISS-COM (SUB16) + ISS-WK.
 17291
 17292     MOVE ZEROS                  TO CNC-WK
 17293                                    CNC-FACT
 17294     IF DTE-CLIENT EQUAL 'XXX'
 17295         IF NOT CR-NO-LF-CHARGEBACK
 17296            COMPUTE CNC-WK  ROUNDED = CNC-PRM * CR-LCOM-L (SUB1)
 17297            COMPUTE EW-CNC-COM (SUB16) = EW-CNC-COM (SUB16)
 17298                                + CNC-WK
 17299            GO TO 4300-CONTINUE-LOOP.
 17300
 17301     IF (WS-LEVELS-CHARGEBACK-SWITCHES = SPACES) OR
 17302        (WS-LF-CHARGEBACK-SW (SUB1) EQUAL 'Y')
 17303
 17304      IF (DTE-CLIENT = 'DCC')
 17305         AND (REIN-EP-FLG = 'R')
 17306         AND (CR-AGT-TYPE (SUB1) = 'P' OR 'T')
 17307         AND (WE-LFRFND NOT = ZEROS)
 17308         IF CLAS-I-BEN-CATEGORY (CLAS-INDEXL) = 'D'
 17309            COMPUTE CNC-FACT = CNC-PRM / ISS-PRM
 17310            COMPUTE CNC-WK ROUNDED = CNC-FACT * CR-LF-CLP *
 17311               CR-LCOM-L (SUB1)
 17312            IF CR-ACCOUNT = '05500500DD'
 17313               DISPLAY ' REIN P D ' CNC-FACT ' ' CNC-WK
 17314            END-IF
 17315         ELSE
 17316            COMPUTE WS-CEDE-FACT = RWF-LFAMT / CR-LFAMT
 17317            COMPUTE CNC-WK ROUNDED = (CR-LFRFND * WS-CEDE-FACT)
 17318               * CR-LCOM-L (SUB1)
 17319         END-IF
 17320      ELSE
 17321        IF (CR-AGT-TYPE (SUB1) = 'B' OR 'I'
 17322                              OR 'L' OR 'J' OR 'K')
 17323           AND (CNC-PRM > +0)
 17324           COMPUTE CNC-FACT = CNC-PRM / ISS-PRM
 17325           COMPUTE CNC-WK = CNC-FACT *
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 333
* ECS010MO.cbl
 17326              (CR-LCOM-L (SUB1) * +1000)
 17327        ELSE
 17328           IF (CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'G' OR 'L')
 17329               AND (CR-AHTYP NOT = '00' AND '  ')
 17330              AND (CR-AGT-TYPE (SUB1) = 'C' OR 'D')
 17331              COMPUTE CNC-FACT = CNC-PRM / ISS-PRM
 17332              COMPUTE CNC-WK = CNC-FACT *
 17333                 (CR-AHPRM - (CR-LFPRM-ALT
 17334                 + CR-ADDL-CLP))
 17335           ELSE
 17336             IF (CR-AGT-TYPE (SUB1) = 'A')
 17337                       OR
 17338              ((CR-AGT-TYPE (SUB1) = 'O' OR 'P' OR 'M')
 17339                 AND (CLAS-I-BEN-CATEGORY (CLAS-INDEXL) = 'D'))
 17340              COMPUTE CNC-FACT = CNC-PRM / ISS-PRM
 17341              COMPUTE CNC-WK ROUNDED = CNC-FACT * CR-LF-CLP *
 17342                CR-LCOM-L (SUB1)
 17343             ELSE
 17344               COMPUTE CNC-WK  ROUNDED =
 17345                 CNC-PRM * CR-LCOM-L (SUB1)
 17346             END-IF
 17347           END-IF
 17348        END-IF
 17349      END-IF
 17350        COMPUTE EW-CNC-COM (SUB16) =
 17351                                  EW-CNC-COM (SUB16) + CNC-WK
 17352     END-IF
 17353
 17354     .
 17355 4300-CONTINUE-LOOP.
 17356
 17357*     DISPLAY ' 4300 CONTINUE '
 17358     IF ((ISS-PRM - CNC-PRM) = ZEROS)
 17359               OR
 17360        ((ISS-WK - CNC-WK) = ZEROS)
 17361        MOVE ZEROS              TO COMM-WK
 17362     ELSE
 17363        COMPUTE EC-FACT ROUNDED =
 17364           EPR-R78 / (ISS-PRM - CNC-PRM)
 17365        COMPUTE COMM-WK ROUNDED = EC-FACT * (ISS-WK - CNC-WK)
 17366     END-IF
 17367
 17368     COMPUTE EW-ECR-R78 (SUB16) = EW-ECR-R78 (SUB16) + COMM-WK.
 17369
 17370     IF ((ISS-PRM - CNC-PRM) = ZEROS)
 17371               OR
 17372        ((ISS-WK - CNC-WK) = ZEROS)
 17373        MOVE ZEROS              TO COMM-WK
 17374     ELSE
 17375        COMPUTE EC-FACT ROUNDED =
 17376           EPR-PRO / (ISS-PRM - CNC-PRM)
 17377        COMPUTE COMM-WK ROUNDED = EC-FACT * (ISS-WK - CNC-WK)
 17378     END-IF
 17379     COMPUTE EW-ECR-PRO (SUB16) = EW-ECR-PRO (SUB16) + COMM-WK.
 17380
 17381     IF ((ISS-PRM - CNC-PRM) = ZEROS)
 17382               OR
 17383        ((ISS-WK - CNC-WK) = ZEROS)
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 334
* ECS010MO.cbl
 17384        MOVE ZEROS              TO COMM-WK
 17385     ELSE
 17386        COMPUTE EC-FACT ROUNDED =
 17387           EPR-ST / (ISS-PRM - CNC-PRM)
 17388        COMPUTE COMM-WK ROUNDED = EC-FACT * (ISS-WK - CNC-WK)
 17389     END-IF
 17390
 17391     COMPUTE EW-ECR-ST (SUB16) = EW-ECR-ST (SUB16) + COMM-WK.
 17392
 17393     IF LIFE-FULLY-EARNED
 17394         COMPUTE COMM-WK ROUNDED = (ISS-PRM - EPR-R78) *
 17395                                                CR-LCOM-L (SUB1)
 17396         COMPUTE EW-ECR-R78-ADJ (SUB16) =
 17397                               EW-ECR-R78-ADJ (SUB16) + COMM-WK
 17398         COMPUTE COMM-WK ROUNDED = (ISS-PRM - EPR-PRO) *
 17399                                                CR-LCOM-L (SUB1)
 17400         COMPUTE EW-ECR-PRO-ADJ (SUB16) =
 17401                               EW-ECR-PRO-ADJ (SUB16) + COMM-WK.
 17402
 17403     GO TO 4350-EP-COMM-LOOP-X.
 17404
 17405 4350-EP-COMM-LOOP-A.
 17406
 17407     IF (DTE-CLIENT = 'DCC')
 17408        AND (REIN-EP-FLG = 'R')
 17409        AND (CR-AGT-TYPE (SUB1) = 'P' OR 'T')
 17410        AND (WE-AHPRM NOT = ZEROS)
 17411
 17412        IF CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'D'
 17413           COMPUTE ISS-WK ROUNDED =
 17414              CR-AH-NSP-PRM * CR-LCOM-AH (SUB1)
 17415        ELSE
 17416           COMPUTE WS-CEDE-FACT = RWF-AHAMT / CR-AHAMT
 17417           COMPUTE ISS-WK ROUNDED = (CR-AHPRM * WS-CEDE-FACT)
 17418              * CR-LCOM-AH (SUB1)
 17419        END-IF
 17420     ELSE
 17421        IF CR-AGT-TYPE (SUB1) = 'B' OR 'I' OR 'K' OR 'L' OR 'J'
 17422           COMPUTE ISS-WK = CR-LCOM-AH (SUB1) * +1000
 17423        ELSE
 17424           IF (CR-AGT-TYPE (SUB1) = 'D' OR 'C')
 17425             AND (CLAS-I-BEN-CATEGORY (CLAS-INDEXA)) = 'G' OR 'L'
 17426              COMPUTE ISS-WK = CR-AHPRM - (CR-LFPRM-ALT
 17427              + CR-ADDL-CLP)
 17428           ELSE
 17429              IF (CR-AGT-TYPE (SUB1) = 'M')
 17430                 AND (CLAS-I-BEN-CATEGORY (CLAS-INDEXA)
 17431                              = 'G' OR 'L')
 17432                 COMPUTE ISS-WK ROUNDED =
 17433                    CR-LFPRM-ALT * CR-LCOM-AH (SUB1)
 17434              ELSE
 17435                 IF CR-AGT-TYPE (SUB1) = 'A'
 17436                    COMPUTE ISS-WK ROUNDED =
 17437                      CR-AH-CLP * CR-LCOM-AH (SUB1)
 17438                 ELSE
 17439                    IF (CR-AGT-TYPE (SUB1) = 'O' OR 'P' OR 'M')
 17440                       AND (CLAS-I-BEN-CATEGORY (CLAS-INDEXA) =
 17441                                     'D')
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 335
* ECS010MO.cbl
 17442                       COMPUTE ISS-WK ROUNDED =
 17443                         CR-AH-CLP * CR-LCOM-AH (SUB1)
 17444                    ELSE
 17445                       COMPUTE ISS-WK  ROUNDED =
 17446                         ISS-PRM * CR-LCOM-AH (SUB1)
 17447                    END-IF
 17448                 END-IF
 17449              END-IF
 17450           END-IF
 17451        END-IF
 17452     END-IF
 17453
 17454     COMPUTE EW-ISS-COM (SUB16) =
 17455             EW-ISS-COM (SUB16) + ISS-WK.
 17456
 17457     MOVE ZEROS                  TO CNC-WK
 17458     IF DTE-CLIENT EQUAL 'XXX'
 17459         IF NOT CR-NO-LF-CHARGEBACK
 17460           COMPUTE CNC-WK  ROUNDED = CNC-PRM * CR-LCOM-AH (SUB1)
 17461           COMPUTE EW-CNC-COM (SUB16) =
 17462                   EW-CNC-COM (SUB16) + CNC-WK
 17463           GO TO 4300-CONTINUE-LOOP-AH.
 17464
 17465
 17466     IF (WS-LEVELS-CHARGEBACK-SWITCHES = SPACES) OR
 17467        (WS-AH-CHARGEBACK-SW (SUB1) EQUAL 'Y')
 17468      IF (DTE-CLIENT = 'DCC')
 17469         AND (REIN-EP-FLG = 'R')
 17470         AND (CR-AGT-TYPE (SUB1) = 'P' OR 'T')
 17471         AND (WE-AHRFND NOT = ZEROS)
 17472         IF (CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'D')
 17473            COMPUTE CNC-FACT = CR-AHRFND / CR-AHPRM
 17474            COMPUTE CNC-WK ROUNDED = CNC-FACT *
 17475                       CR-AH-NSP-PRM * CR-LCOM-AH (SUB1)
 17476         ELSE
 17477            COMPUTE WS-CEDE-FACT = RWF-AHAMT / CR-AHAMT
 17478            COMPUTE CNC-WK ROUNDED = (CR-AHRFND * WS-CEDE-FACT)
 17479            * CR-LCOM-AH (SUB1)
 17480         END-IF
 17481      ELSE
 17482        IF (CR-AGT-TYPE (SUB1) = 'B' OR 'I'
 17483                              OR 'L' OR 'J' OR 'K')
 17484           AND (CNC-PRM > +0)
 17485           COMPUTE CNC-FACT = CNC-PRM / ISS-PRM
 17486           COMPUTE CNC-WK = CNC-FACT *
 17487              (CR-LCOM-AH (SUB1) * +1000)
 17488        ELSE
 17489           IF (CR-AGT-TYPE (SUB1) = 'M')
 17490              AND (CLAS-I-BEN-CATEGORY (CLAS-INDEXA)
 17491                              = 'G' OR 'L')
 17492              COMPUTE CNC-FACT = CR-AHRFND / CR-AHPRM
 17493              COMPUTE CNC-WK = CNC-FACT *
 17494                 (CR-LFPRM-ALT * CR-LCOM-AH (SUB1))
 17495           ELSE
 17496              IF CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'G' OR 'L'
 17497                 COMPUTE CNC-FACT = CR-AHRFND / CR-AHPRM
 17498                 COMPUTE CNC-WK = CNC-FACT *
 17499                 (CR-AHPRM - (CR-LFPRM-ALT
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 336
* ECS010MO.cbl
 17500                    + CR-ADDL-CLP))
 17501              ELSE
 17502                 IF (CR-AGT-TYPE (SUB1) = 'A')
 17503                           OR
 17504                    ((CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'D')
 17505                    AND (CR-AGT-TYPE (SUB1) = 'O' OR 'P' OR 'M'))
 17506                    COMPUTE CNC-FACT = CR-AHRFND / CR-AHPRM
 17507                    COMPUTE CNC-WK ROUNDED = CNC-FACT *
 17508                       CR-AH-NSP-PRM * CR-LCOM-AH (SUB1)
 17509                 ELSE
 17510                    COMPUTE CNC-WK  ROUNDED =
 17511                      CNC-PRM * CR-LCOM-AH (SUB1)
 17512                 END-IF
 17513              END-IF
 17514           END-IF
 17515        END-IF
 17516*       END-IF
 17517      END-IF
 17518        COMPUTE EW-CNC-COM (SUB16) =
 17519           EW-CNC-COM (SUB16) + CNC-WK
 17520     END-IF
 17521
 17522     .
 17523 4300-CONTINUE-LOOP-AH.
 17524
 17525*     DISPLAY ' 4300-CONTINUE-LOOP-AH '
 17526     IF ((ISS-PRM - CNC-PRM) = ZEROS)
 17527                OR
 17528        ((ISS-WK - CNC-WK) = ZEROS)
 17529        MOVE ZEROS          TO COMM-WK
 17530     ELSE
 17531        COMPUTE EC-FACT ROUNDED =
 17532           EPR-R78 / (ISS-PRM - CNC-PRM)
 17533        COMPUTE COMM-WK ROUNDED = EC-FACT * (ISS-WK - CNC-WK)
 17534     END-IF
 17535
 17536     COMPUTE EW-ECR-R78 (SUB16) = EW-ECR-R78 (SUB16) + COMM-WK.
 17537
 17538     IF ((ISS-PRM - CNC-PRM) = ZEROS)
 17539                OR
 17540        ((ISS-WK - CNC-WK) = ZEROS)
 17541        MOVE ZEROS          TO COMM-WK
 17542     ELSE
 17543        COMPUTE EC-FACT ROUNDED =
 17544           EPR-PRO / (ISS-PRM - CNC-PRM)
 17545        COMPUTE COMM-WK ROUNDED = EC-FACT * (ISS-WK - CNC-WK)
 17546     END-IF
 17547
 17548     COMPUTE EW-ECR-PRO (SUB16) = EW-ECR-PRO (SUB16) + COMM-WK.
 17549
 17550     IF ((ISS-PRM - CNC-PRM) = ZEROS)
 17551                OR
 17552        ((ISS-WK - CNC-WK) = ZEROS)
 17553        MOVE ZEROS          TO COMM-WK
 17554     ELSE
 17555        COMPUTE EC-FACT ROUNDED =
 17556           EPR-ST / (ISS-PRM - CNC-PRM)
 17557        COMPUTE COMM-WK ROUNDED = EC-FACT * (ISS-WK - CNC-WK)
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 337
* ECS010MO.cbl
 17558     END-IF
 17559
 17560     COMPUTE EW-ECR-ST (SUB16) = EW-ECR-ST (SUB16) + COMM-WK.
 17561
 17562     IF A-H-FULLY-EARNED
 17563         COMPUTE COMM-WK ROUNDED = (ISS-PRM - EPR-R78) *
 17564                                                CR-LCOM-AH (SUB1)
 17565         COMPUTE EW-ECR-R78-ADJ (SUB16) =
 17566                               EW-ECR-R78-ADJ (SUB16) + COMM-WK
 17567         COMPUTE COMM-WK ROUNDED = (ISS-PRM - EPR-PRO) *
 17568                                                CR-LCOM-AH (SUB1)
 17569         COMPUTE EW-ECR-PRO-ADJ (SUB16) =
 17570                               EW-ECR-PRO-ADJ (SUB16) + COMM-WK.
 17571
 17572 4350-EP-COMM-LOOP-X.
 17573     EXIT.
 17574
 17575
 17576
 17577
 17578******************************************************************
 17579***    C A L C U L A T E   E A R N E D  BANK COMMISSION        ***
 17580******************************************************************
 17581
 17582 4375-EP-BANK-COMM.
 17583*     DISPLAY ' 4375 '
 17584
 17585     IF CS-AGT (SUB1) = SPACES OR ZEROS
 17586        GO TO 4375-EXIT
 17587     END-IF
 17588     .
 17589 4375-BANK-LOOP.
 17590
 17591     ADD +1                      TO SUB16
 17592
 17593     IF EW-LF-AH NOT = AH-OVERRIDE-L1
 17594        GO TO 4375-EXIT
 17595     END-IF
 17596
 17597     IF SUB16 GREATER THAN WS-LOOP-MAX
 17598         DISPLAY 'ERROR OCCURRED - MAXIMUM BANK  LEVELS EXCEEDED'
 17599         DISPLAY 'CONTROL= ' CR-FULL-CONTROL
 17600         MOVE 'ERR0R OCCURRED - MAXIMUM AGENT LEVELS EXCEEDED'
 17601                                     TO WS-ABEND-MESSAGE
 17602         MOVE DC-ERROR-CODE          TO WS-ABEND-FILE-STATUS
 17603         MOVE 4001                   TO WS-ABEND-CODE
 17604         PERFORM ABEND-PGM
 17605     END-IF
 17606
 17607     IF EW-AGT-NO (SUB16) = SPACES
 17608        MOVE CS-AGT (SUB1)       TO EW-AGT-NO   (SUB16)
 17609        MOVE CS-COM-TYP (SUB1)   TO EW-AGT-TYPE (SUB16)
 17610     ELSE
 17611        IF (CS-AGT (SUB1) = EW-AGT-NO   (SUB16)) AND
 17612           (CS-COM-TYP (SUB1) = EW-AGT-TYPE (SUB16))
 17613           CONTINUE
 17614        ELSE
 17615           GO TO 4375-BANK-LOOP
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 338
* ECS010MO.cbl
 17616        END-IF
 17617     END-IF
 17618
 17619     IF CS-COM-TYP  (SUB1) = 'B'
 17620        MOVE CS-SPP-FEES (SUB1)  TO ISS-WK
 17621     END-IF
 17622
 17623     COMPUTE EW-ISS-COM (SUB16) = EW-ISS-COM (SUB16) + ISS-WK.
 17624
 17625     MOVE ZEROS                  TO CNC-WK
 17626                                    CNC-FACT
 17627
 17628     IF (CS-COM-TYP (SUB1) = 'B')
 17629        AND (CNC-PRM > +0)
 17630        COMPUTE CNC-FACT = CNC-PRM / ISS-PRM
 17631        COMPUTE CNC-WK = CNC-FACT * CS-SPP-FEES (SUB1)
 17632     END-IF
 17633
 17634     COMPUTE EW-CNC-COM (SUB16) =
 17635                  EW-CNC-COM (SUB16) + CNC-WK
 17636
 17637     IF ((ISS-PRM - CNC-PRM) = ZEROS)
 17638                OR
 17639        ((ISS-WK - CNC-WK) = ZEROS)
 17640        MOVE ZEROS          TO COMM-WK
 17641     ELSE
 17642        COMPUTE EC-FACT ROUNDED =
 17643           EPR-R78 / (ISS-PRM - CNC-PRM)
 17644        COMPUTE COMM-WK ROUNDED = EC-FACT * (ISS-WK - CNC-WK)
 17645     END-IF
 17646
 17647     COMPUTE EW-ECR-R78 (SUB16) = EW-ECR-R78 (SUB16) + COMM-WK.
 17648
 17649     IF ((ISS-PRM - CNC-PRM) = ZEROS)
 17650                OR
 17651        ((ISS-WK - CNC-WK) = ZEROS)
 17652        MOVE ZEROS          TO COMM-WK
 17653     ELSE
 17654        COMPUTE EC-FACT ROUNDED =
 17655           EPR-PRO / (ISS-PRM - CNC-PRM)
 17656        COMPUTE COMM-WK ROUNDED = EC-FACT * (ISS-WK - CNC-WK)
 17657     END-IF
 17658
 17659     COMPUTE EW-ECR-PRO (SUB16) = EW-ECR-PRO (SUB16) + COMM-WK.
 17660
 17661     IF ((ISS-PRM - CNC-PRM) = ZEROS)
 17662                OR
 17663        ((ISS-WK - CNC-WK) = ZEROS)
 17664        MOVE ZEROS          TO COMM-WK
 17665     ELSE
 17666        COMPUTE EC-FACT ROUNDED =
 17667           EPR-ST / (ISS-PRM - CNC-PRM)
 17668        COMPUTE COMM-WK ROUNDED = EC-FACT * (ISS-WK - CNC-WK)
 17669     END-IF
 17670
 17671     COMPUTE EW-ECR-ST (SUB16) = EW-ECR-ST (SUB16) + COMM-WK.
 17672
 17673     IF A-H-FULLY-EARNED
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 339
* ECS010MO.cbl
 17674        MOVE CS-SPP-FEES (SUB1)  TO COMM-WK
 17675        COMPUTE EW-ECR-R78-ADJ (SUB16) =
 17676                               EW-ECR-R78-ADJ (SUB16) + COMM-WK
 17677        COMPUTE EW-ECR-PRO-ADJ (SUB16) =
 17678                               EW-ECR-PRO-ADJ (SUB16) + COMM-WK
 17679     END-IF
 17680
 17681     .
 17682 4375-EXIT.
 17683     EXIT.
 17684
 17685******************************************************************
 17686******************************************************************
 17687******************************************************************
 17688******************************************************************
 17689******************************************************************
 17690******************************************************************
 17691******************************************************************
 17692******************************************************************
 17693******************************************************************
 17694******************************************************************
 17695***  C A L C U L A T E   L I F E   S T A R T I N G  E A R N E D***
 17696******************************************************************
 17697
 17698 S-4100-EP-DO-LF.
 17699
 17700     MOVE +0                         TO EPR-R78  EARNED-BY-CANCEL
 17701                                        EPR-PRO
 17702                                        EPR-ST.
 17703
 17704     MOVE RCT-EARNING-START-DT (CO-SUB) TO DC-GREG-DATE-CYMD.
 17705     MOVE 'L'                    TO DC-OPTION-CODE.
 17706     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 17707
 17708     MOVE +0                     TO DC-ELAPSED-MONTHS.
 17709     MOVE -1                     TO DC-ELAPSED-DAYS.
 17710     MOVE '6'                    TO DC-OPTION-CODE.
 17711     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 17712
 17713     MOVE +0                     TO DC-ELAPSED-MONTHS
 17714                                    DC-ELAPSED-DAYS.
 17715
 17716     MOVE DC-BIN-DATE-2          TO DC-BIN-DATE-1.
 17717     MOVE ' '                    TO DC-OPTION-CODE.
 17718     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 17719
 17720     IF NO-CONVERSION-ERROR
 17721        MOVE DC-GREG-DATE-CYMD   TO EARNING-START-DATE
 17722     ELSE
 17723         DISPLAY 'ERROR OCCURED CONVERTING EARNING START DATE '
 17724                 'FOR REIN. CO. ' RCT-REIN-CO (CO-SUB)
 17725                 '  START DATE:' RCT-EARNING-START-DT (CO-SUB)
 17726         MOVE 'ERROR OCCURED CONVERTING EARNING START DATE '
 17727                                     TO WS-ABEND-MESSAGE
 17728         MOVE DC-ERROR-CODE          TO WS-ABEND-FILE-STATUS
 17729         MOVE 4001                   TO WS-ABEND-CODE
 17730         GO TO ABEND-PGM.
 17731
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 340
* ECS010MO.cbl
 17732     IF CR-LFTYP = ZERO
 17733         GO TO S-4200-EP-DO-AH.
 17734
 17735     IF REIN-LF-FLG (SUB5) = SPACE
 17736         GO TO S-4200-EP-DO-AH.
 17737
 17738     MOVE LIFE-OVERRIDE-L1       TO WE-LF-AH.
 17739     MOVE CR-LFTYP               TO WE-BEN-TYPE.
 17740     PERFORM 4400-EP-FIND-TAB-ENT THRU 4499-EP-FIND-TAB-ENT-X.
 17741
 17742     MOVE CR-LF-TERM             TO ORIG-TERM.
 17743     MOVE CLAS-INDEXL            TO W-NDX.
 17744
 17745 S-4120-EP-DO-LF-CNCL.
 17746
 17747     IF CR-LF-STATUS-AT-CANCEL = ' '  AND
 17748        CLAS-I-CALC-TYPE (CLAS-INDEXL) NOT = 'Z'
 17749         GO TO S-4130-EP-DO-LF-EP.
 17750
 17751     COMPUTE EARNED-BY-CANCEL =
 17752                       (WE-LFPRM + WE-LFPRM-ALT) - WE-LFRFND.
 17753
 17754 S-4130-EP-DO-LF-EP.
 17755
 17756     MOVE SPACE                  TO STATUTORY-SWITCH.
 17757
 17758     MOVE EARNING-START-DATE     TO VALUATION-DT.
 17759     MOVE '9'                    TO W-VAL-SOURCE.
 17760     PERFORM 8500-REMAINING-TERM-ROUTINE THRU 8599-REM-TERM-X.
 17761
 17762     IF REM-TRM2 GREATER CR-LF-TERM
 17763         MOVE +0 TO EPR-R78  EPR-PRO  EPR-ST
 17764         GO TO S-4190-EP-DO-LF-COMM.
 17765
 17766     IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'Z'
 17767         GO TO S-4180-EP-DO-LF-EP-SUM.
 17768
 17769     IF CLAS-I-EP (CLAS-INDEXL) = 'B'
 17770         IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'L'
 17771             IF REM-TRM2 NOT GREATER THAN +0
 17772                 COMPUTE EPR-R78 = WE-LFPRM + WE-LFPRM-ALT
 17773                 MOVE EPR-R78 TO EPR-PRO  EPR-ST
 17774                 GO TO S-4190-EP-DO-LF-COMM
 17775             ELSE
 17776                 NEXT SENTENCE
 17777         ELSE
 17778             IF W-BAL-REMTRM NOT GREATER +0
 17779                 COMPUTE EPR-R78 = WE-LFPRM + WE-LFPRM-ALT
 17780                 MOVE EPR-R78 TO EPR-PRO  EPR-ST
 17781                 GO TO S-4190-EP-DO-LF-COMM
 17782             ELSE
 17783                 NEXT SENTENCE
 17784     ELSE
 17785        IF (DTE-CLIENT EQUAL 'NCL') AND
 17786           (CLAS-I-CALC-TYPE (CLAS-INDEXL) EQUAL 'B')
 17787             MOVE WE-LFPRM TO EPR-R78  EPR-PRO  EPR-ST
 17788        ELSE
 17789         IF REM-TRM2 NOT GREATER +0  OR
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 341
* ECS010MO.cbl
 17790            CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'B'
 17791             MOVE WE-LFPRM TO EPR-R78  EPR-PRO  EPR-ST
 17792             GO TO S-4190-EP-DO-LF-COMM.
 17793
 17794     IF CLAS-I-EP (CLAS-INDEXL) = 'T'
 17795         GO TO S-4140-EP-DO-LF-EP-TEX.
 17796
 17797     IF CLAS-I-EP (CLAS-INDEXL) = 'N'
 17798         GO TO S-4150-EP-DO-LF-EP-NP.
 17799
 17800*    IF STATE-ABBR (CLAS-INDEXS) = 'OH'
 17801     IF (STATE-ABBR (CLAS-INDEXS) = 'OH') AND
 17802        (CR-RATING-CLASS NOT = 'L ')
 17803         IF (CR-APR GREATER THAN ZERO)  AND
 17804            (CR-LF-TERM GREATER THAN 060)  AND
 17805            (CR-DT GREATER THAN 19831031)
 17806             MOVE '*'             TO STATUTORY-SWITCH
 17807              GO TO S-4150-EP-DO-LF-EP-NP.
 17808
 17809     IF STATE-ABBR (CLAS-INDEXS) = 'MT'
 17810         IF (CR-APR GREATER THAN ZERO)  AND
 17811            (CR-LF-TERM GREATER THAN 061)  AND
 17812            (CR-DT GREATER THAN 19830318)
 17813             MOVE '*'             TO STATUTORY-SWITCH
 17814              GO TO S-4150-EP-DO-LF-EP-NP.
 17815
 17816     IF STATE-ABBR (CLAS-INDEXS) = 'UT'
 17817         IF (CR-APR GREATER THAN ZERO)  AND
 17818            (CR-LF-TERM GREATER THAN 062)  AND
 17819            (CR-DT GREATER THAN 19810831)  AND
 17820            (CR-DT LESS THAN 19830901)
 17821             MOVE '*'             TO STATUTORY-SWITCH
 17822              GO TO S-4150-EP-DO-LF-EP-NP.
 17823
 17824     IF STATE-ABBR (CLAS-INDEXS) = 'RI'
 17825         IF (CR-APR GREATER THAN ZERO)  AND
 17826            (CR-LF-TERM GREATER THAN 060)  AND
 17827            (CR-DT GREATER THAN 19831231)
 17828             MOVE '*'             TO STATUTORY-SWITCH
 17829              GO TO S-4150-EP-DO-LF-EP-NP.
 17830
 17831     GO TO S-4160-EP-DO-LF-EP-R78.
 17832
 17833 S-4140-EP-DO-LF-EP-TEX.
 17834
 17835     COMPUTE TEX-FACT-4 =
 17836         (CR-LF-TERM * CR-LF-TERM) + (CR-PMT-FREQ * CR-LF-TERM).
 17837     DIVIDE REM-TRM1 BY CR-PMT-FREQ
 17838         GIVING TEX-FACT-5
 17839             REMAINDER TEX-FACT-6.
 17840     COMPUTE TEX-FACT-5 = TEX-FACT-5 * CR-PMT-FREQ.
 17841     COMPUTE TEX-FACT-7 = (TEX-FACT-5 * TEX-FACT-5) +
 17842         (TEX-FACT-5 * CR-PMT-FREQ) +
 17843         (2 * (TEX-FACT-6 * (TEX-FACT-5 + CR-PMT-FREQ))).
 17844     COMPUTE TEX-FACT-8 ROUNDED = TEX-FACT-7 / TEX-FACT-4.
 17845
 17846     COMPUTE EPR-R78 ROUNDED = WE-LFPRM - (WE-LFPRM * TEX-FACT-8).
 17847
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 342
* ECS010MO.cbl
 17848     GO TO S-4170-EP-DO-LF-EP-PRO.
 17849
 17850 S-4150-EP-DO-LF-EP-NP.
 17851
 17852     IF WE-LFPRM = ZERO
 17853         GO TO S-4160-EP-DO-LF-EP-R78.
 17854
 17855     IF DTE-CLIENT = 'CRI'
 17856       IF STATE-ABBR (CLAS-INDEXS) = ('AB' OR 'BC' OR 'MB' OR
 17857             'NS' OR 'ON' OR 'NB' OR 'NF' OR 'QB' OR 'SK' OR 'PE')
 17858           GO TO S-4160-EP-DO-LF-EP-R78.
 17859
 17860     IF DTE-CLIENT = 'NCL'
 17861       IF CR-DT LESS THAN 19910101
 17862           GO TO S-4160-EP-DO-LF-EP-R78.
 17863
 17864     IF REM-TRM1 = CR-LF-TERM
 17865         MOVE +0 TO EPR-R78  EPR-PRO  EPR-ST
 17866         GO TO S-4190-EP-DO-LF-COMM.
 17867
 17868     MOVE CR-APR TO NP-APR.
 17869     MOVE CR-LF-TERM TO NP-ORIG  NP-CAP.
 17870     MOVE REM-TRM1 TO NP-REM.
 17871     MOVE CLAS-I-CALC-TYPE (CLAS-INDEXL) TO NP-OPT.
 17872     IF NP-OPT = 'T' OR 'U' OR 'V' OR 'W' OR 'X'
 17873         MOVE CR-LOAN-TERM TO NP-ORIG.
 17874     MOVE 'R' TO NP-OPT.
 17875     CALL 'ECSNETRM'
 17876         USING NP-APR NP-ORIG NP-REM NP-OPT NP-CAP NP-FACTOR.
 17877
 17878     COMPUTE EPR-R78 ROUNDED = WE-LFPRM - (NP-FACTOR * WE-LFPRM).
 17879
 17880     IF STATUTORY-REQUIREMENT
 17881         MOVE EPR-R78                TO EPR-ST.
 17882
 17883 S-4160-EP-DO-LF-EP-R78.
 17884
 17885     IF (CLAS-I-CALC-TYPE (CLAS-INDEXL) EQUAL 'B') AND
 17886        (DTE-CLIENT EQUAL 'NCL')
 17887        IF (CR-CCYY EQUAL EOM-CCYY) AND
 17888           (CR-MO EQUAL EOM-MO)
 17889           MOVE '*'            TO OB-DATE-1-SWITCH
 17890           MOVE EW-REIN-CO     TO WS-OB-REIN-CO (SUB3)
 17891           MOVE LIFE-OVERRIDE-L1 TO WS-OB-LF-AH (SUB3)
 17892           MOVE CR-LFTYP       TO WS-OB-BENEFIT-CODE (SUB3)
 17893           COMPUTE WS-EPR-R78 (SUB3 1) =
 17894                   WS-EPR-R78 (SUB3 1) - (WE-LFPRM * .5)
 17895           GO TO S-4190-EP-DO-LF-COMM
 17896        ELSE
 17897        IF (CR-CCYY EQUAL OB-CCYY (1)) AND
 17898           (CR-MO EQUAL OB-MO (1))
 17899           MOVE '*'            TO OB-DATE-2-SWITCH
 17900           MOVE EW-REIN-CO     TO WS-OB-REIN-CO (SUB3)
 17901           MOVE LIFE-OVERRIDE-L1 TO WS-OB-LF-AH (SUB3)
 17902           MOVE CR-LFTYP       TO WS-OB-BENEFIT-CODE (SUB3)
 17903           COMPUTE WS-EPR-R78 (SUB3 2) =
 17904                   WS-EPR-R78 (SUB3 2) - (WE-LFPRM * .5)
 17905           GO TO S-4190-EP-DO-LF-COMM
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 343
* ECS010MO.cbl
 17906        ELSE
 17907        IF (CR-CCYY EQUAL OB-CCYY (2)) AND
 17908           (CR-MO EQUAL OB-MO (2))
 17909           MOVE '*'            TO OB-DATE-3-SWITCH
 17910           MOVE EW-REIN-CO     TO WS-OB-REIN-CO (SUB3)
 17911           MOVE LIFE-OVERRIDE-L1 TO WS-OB-LF-AH (SUB3)
 17912           MOVE CR-LFTYP       TO WS-OB-BENEFIT-CODE (SUB3)
 17913           COMPUTE WS-EPR-R78 (SUB3 3) =
 17914                   WS-EPR-R78 (SUB3 3) - (WE-LFPRM * .5)
 17915           GO TO S-4190-EP-DO-LF-COMM
 17916        ELSE
 17917           GO TO S-4190-EP-DO-LF-COMM.
 17918
 17919     COMPUTE TEMP-1 = CR-LF-TERM * (CR-LF-TERM + 1).
 17920
 17921     IF DTE-R78 = '1'
 17922         COMPUTE TEMP-2 = REM-TRM1 * REM-TRM1
 17923     ELSE
 17924         COMPUTE TEMP-2 = REM-TRM1 * (REM-TRM1 + 1).
 17925
 17926     COMPUTE TEMP-4 ROUNDED EQUAL TEMP-2 / TEMP-1.
 17927
 17928     IF REM-TRM1 GREATER THAN +0
 17929         COMPUTE TEMP-7 ROUNDED EQUAL
 17930             WE-LFPRM - (WE-LFPRM * TEMP-4)
 17931     ELSE
 17932         MOVE WE-LFPRM                TO TEMP-7.
 17933
 17934     IF STATE-ABBR (CLAS-INDEXS) = 'AL'
 17935         MOVE TEMP-7                 TO EPR-ST.
 17936
 17937     IF CLAS-I-EP (CLAS-INDEXL) NOT = 'B'
 17938         MOVE ZEROS                  TO TEMP-8
 17939         GO TO S-4165-END-LF-EP-R78.
 17940
 17941     IF EPR-ST NOT = ZEROS
 17942         MOVE TEMP-7                 TO EPR-ST.
 17943
 17944     IF CLAS-I-CALC-TYPE (CLAS-INDEXL) NOT = 'L'
 17945         COMPUTE TEMP-1 = (CR-LF-TERM + 1) * (CR-LF-TERM + 2)
 17946         COMPUTE TEMP-2 = (REM-TRM1 + 1) * (REM-TRM1 + 2)
 17947         IF DTE-R78 = '1'
 17948             COMPUTE TEMP-2 = (REM-TRM1 + 1) * (REM-TRM1 + 1).
 17949
 17950     COMPUTE TEMP-4 ROUNDED EQUAL TEMP-2 / TEMP-1.
 17951
 17952     COMPUTE TEMP-8 ROUNDED =
 17953               WE-LFPRM-ALT - (WE-LFPRM-ALT * TEMP-4).
 17954
 17955 S-4165-END-LF-EP-R78.
 17956
 17957     IF EPR-R78 = ZEROS
 17958         COMPUTE EPR-R78 = TEMP-7 + TEMP-8
 17959     ELSE
 17960         COMPUTE EPR-R78 = EPR-R78 + TEMP-8.
 17961
 17962 S-4170-EP-DO-LF-EP-PRO.
 17963
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 344
* ECS010MO.cbl
 17964     IF DTE-CLIENT = 'MIC' OR 'MCC'
 17965         COMPUTE TEMP-5 ROUNDED = (REM-TRM1 - .5) / CR-LF-TERM
 17966     ELSE
 17967         COMPUTE TEMP-5 ROUNDED = REM-TRM1 / CR-LF-TERM.
 17968
 17969     IF REM-TRM1 GREATER THAN +0
 17970         COMPUTE TEMP-7 ROUNDED = WE-LFPRM - (WE-LFPRM * TEMP-5)
 17971     ELSE
 17972         MOVE WE-LFPRM                  TO TEMP-7.
 17973
 17974     IF CLAS-I-EP (CLAS-INDEXL) NOT = 'B'
 17975         MOVE ZEROS                     TO TEMP-8
 17976         GO TO S-4175-END-LF-EP-PRO.
 17977
 17978     IF CLAS-I-CALC-TYPE (CLAS-INDEXL) NOT = 'L'
 17979         IF DTE-CLIENT = 'MIC' OR 'MCC'
 17980             COMPUTE TEMP-5 ROUNDED =
 17981                           (REM-TRM1 + .5) / (CR-LF-TERM + 1)
 17982         ELSE
 17983             COMPUTE TEMP-5 ROUNDED =
 17984                           (REM-TRM1 + 1) / (CR-LF-TERM + 1).
 17985
 17986     COMPUTE TEMP-8 ROUNDED =
 17987                   WE-LFPRM-ALT - (WE-LFPRM-ALT * TEMP-5).
 17988
 17989     COMPUTE EPR-ST = EPR-ST + TEMP-8.
 17990
 17991 S-4175-END-LF-EP-PRO.
 17992
 17993     COMPUTE EPR-PRO = TEMP-7 + TEMP-8.
 17994
 17995     GO TO S-4185-EP-DO-LF-STATUTORY.
 17996
 17997 S-4180-EP-DO-LF-EP-SUM.
 17998
 17999     IF REM-TRM1 NOT GREATER +0
 18000         COMPUTE EPR-R78 = (WE-LFPRM + WE-LFPRM-ALT) - WE-LFRFND
 18001         MOVE EPR-R78 TO EPR-PRO  EPR-ST
 18002         GO TO S-4190-EP-DO-LF-COMM.
 18003
 18004     IF WE-LFPRM = ZERO  AND  WE-LFPRM-ALT = ZERO
 18005         MOVE ZEROS                 TO TEMP-7
 18006     ELSE
 18007         COMPUTE TEMP-7 ROUNDED = WE-LFPRM - (WE-LFRFND *
 18008                       (WE-LFPRM / (WE-LFPRM + WE-LFPRM-ALT))).
 18009
 18010     IF TEMP-7 NOT GREATER ZERO
 18011         IF CLAS-I-EP (CLAS-INDEXL) NOT = 'B'
 18012             MOVE ZEROS             TO EPR-R78  EPR-PRO  EPR-ST
 18013             GO TO S-4190-EP-DO-LF-COMM
 18014         ELSE
 18015             MOVE ZEROS             TO TEMP-7.
 18016
 18017     COMPUTE TEMP-1 = CR-LF-TERM * (CR-LF-TERM + 1).
 18018     COMPUTE TEMP-2 = REM-TRM1 * (REM-TRM1 + 1).
 18019     IF DTE-R78 = '1'
 18020         COMPUTE TEMP-2 = REM-TRM1 * REM-TRM1.
 18021
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 345
* ECS010MO.cbl
 18022     COMPUTE TEMP-4 ROUNDED = TEMP-2 / TEMP-1.
 18023     COMPUTE TEMP-5 ROUNDED = REM-TRM1 / CR-LF-TERM.
 18024
 18025     COMPUTE EPR-R78 ROUNDED = TEMP-7 - (TEMP-7 * TEMP-4).
 18026
 18027     COMPUTE EPR-PRO ROUNDED = TEMP-7 - (TEMP-7 * TEMP-5).
 18028
 18029     IF CLAS-I-EP (CLAS-INDEXL) NOT = 'B'
 18030         GO TO S-4185-EP-DO-LF-STATUTORY.
 18031
 18032     MOVE EPR-R78                  TO EPR-ST.
 18033
 18034     IF WE-LFPRM = ZERO  AND  WE-LFPRM-ALT = ZERO
 18035         MOVE ZEROS                 TO TEMP-8
 18036     ELSE
 18037         COMPUTE TEMP-8 ROUNDED = WE-LFPRM-ALT - (WE-LFRFND *
 18038                     (WE-LFPRM-ALT / (WE-LFPRM + WE-LFPRM-ALT))).
 18039
 18040     IF TEMP-8 NOT GREATER ZERO
 18041         GO TO S-4185-EP-DO-LF-STATUTORY.
 18042
 18043     COMPUTE EPR-R78 ROUNDED = EPR-R78 +
 18044                              (TEMP-8 - (TEMP-8 * TEMP-4)).
 18045
 18046     COMPUTE EPR-PRO ROUNDED = EPR-PRO +
 18047                              (TEMP-8 - (TEMP-8 * TEMP-5)).
 18048
 18049     COMPUTE EPR-ST ROUNDED = EPR-ST +
 18050                             (TEMP-8 - (TEMP-8 * TEMP-5)).
 18051
 18052 S-4185-EP-DO-LF-STATUTORY.
 18053
 18054*08472      IF STATE-ABBR (CLAS-INDEXS) = 'AL'
 18055*08473          MOVE EPR-R78                TO EPR-ST.
 18056
 18057     IF STATE-ABBR (CLAS-INDEXS) = 'WY'
 18058         MOVE EPR-PRO                TO EPR-ST.
 18059
 18060     IF (DTE-CLIENT = 'CID') AND
 18061        (STATE-ABBR (CLAS-INDEXS) = 'VA' OR 'TX') AND
 18062        (CLAS-I-RL-AH (CLAS-INDEXL) NOT = 'L') AND
 18063        (CLAS-I-EP (CLAS-INDEXL) NOT = 'B')
 18064           GO TO S-4187-EP-DO-LF-STAT-ROA
 18065     END-IF.
 18066
 18067     IF EPR-ST NOT = ZEROS
 18068         GO TO S-4190-EP-DO-LF-COMM.
 18069
 18070     IF CLAS-I-RL-AH (CLAS-INDEXL) = 'R'
 18071         MOVE EPR-R78                TO EPR-ST
 18072     ELSE
 18073         MOVE EPR-PRO                TO EPR-ST.
 18074
 18075     GO TO S-4190-EP-DO-LF-COMM.
 18076
 18077 S-4187-EP-DO-LF-STAT-ROA.
 18078     PERFORM 4196-CALC-REM-AMT THRU 4199-EXIT.
 18079     MOVE CR-DT                      TO DC-GREG-DATE-CYMD.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 346
* ECS010MO.cbl
 18080     MOVE 'L'                        TO DC-OPTION-CODE.
 18081     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 18082     MOVE DC-BIN-DATE-1              TO CP-CERT-EFF-DT.
 18083     IF CR-LOAN-1ST-PMT-DT IS NOT = ZEROS
 18084        MOVE CR-LOAN-1ST-PMT-DT  TO  DC-GREG-DATE-1-YMD
 18085        MOVE '3'                 TO  DC-OPTION-CODE
 18086        PERFORM 8000-DATE-CONVERT-ROUTINE THRU
 18087                              8099-DATE-CONVERT-X
 18088        MOVE DC-BIN-DATE-1       TO  CP-FIRST-PAY-DATE
 18089     ELSE
 18090        MOVE CP-CERT-EFF-DT      TO  DC-BIN-DATE-1
 18091        MOVE +1                  TO  DC-ELAPSED-MONTHS
 18092        MOVE +0                  TO  DC-ELAPSED-DAYS
 18093        MOVE '6'                 TO  DC-OPTION-CODE
 18094        PERFORM 8000-DATE-CONVERT-ROUTINE THRU
 18095                              8099-DATE-CONVERT-X
 18096        MOVE DC-BIN-DATE-2       TO  CP-FIRST-PAY-DATE
 18097     END-IF
 18098     MOVE REM-TRM1                   TO CP-REMAINING-TERM.
 18099     MOVE CLAS-I-RL-AH (CLAS-INDEXL) TO CP-BENEFIT-TYPE.
 18100     MOVE SPACES                     TO CP-ACCT-FLD-5.
 18101     MOVE DTE-CLIENT                 TO CP-COMPANY-ID.
 18102     MOVE STATE-SUB (CLAS-INDEXS)    TO CP-STATE.
 18103     MOVE STATE-ABBR (CLAS-INDEXS)   TO CP-STATE-STD-ABBRV.
 18104     MOVE CR-AGE                     TO CP-ISSUE-AGE.
 18105     MOVE CR-LFPRM                   TO CP-ORIGINAL-PREMIUM
 18106     MOVE CR-LF-CRIT-PERIOD          TO CP-CRITICAL-MONTHS
 18107     MOVE CR-LF-TERM                 TO CP-ORIGINAL-TERM
 18108                                        CP-LOAN-TERM.
 18109     MOVE CR-LFAMT                   TO CP-ORIGINAL-BENEFIT
 18110                                        CP-RATING-BENEFIT-AMT.
 18111     IF  CP-REMAINING-AMT NOT GREATER THAN ZEROS
 18112         MOVE ZEROS                  TO CP-REMAINING-BENEFIT
 18113     ELSE
 18114         MOVE CP-REMAINING-AMT       TO CP-REMAINING-BENEFIT
 18115     END-IF.
 18116     MOVE CR-APR                     TO CP-LOAN-APR.
 18117     MOVE CR-PMT-FREQ                TO CP-PAY-FREQUENCY.
 18118     MOVE CLAS-I-EP (CLAS-INDEXL)    TO CP-RATING-METHOD.
 18119     MOVE '6'                        TO CP-EARNING-METHOD.
 18120     MOVE '3'                        TO CP-PROCESS-TYPE.
 18121     MOVE ' '                        TO CP-SPECIAL-CALC-CD.
 18122     IF CR-RATING-CLASS NOT = SPACE AND ZERO
 18123         MOVE CR-RATING-CLASS        TO CP-CLASS-CODE
 18124     ELSE
 18125         MOVE AM-CAL-TABLE           TO CP-CLASS-CODE.
 18126     MOVE CR-LF-DEV-CODE             TO CP-DEVIATION-CODE.
 18127     MOVE CR-LF-DEV-PCT              TO CP-RATE-DEV-PCT.
 18128     MOVE CR-LFTYP                   TO CP-BENEFIT-CD.
 18129     MOVE DTE-CLASIC-COMPANY-CD      TO CP-COMPANY-CD.
 18130     MOVE CR-PMT-EXTENSION-DAYS      TO CP-TERM-OR-EXT-DAYS.
 18131     MOVE LIFE-OVERRIDE-L1           TO CP-LIFE-OVERRIDE-CODE.
 18132
 18133
 18134     IF CP-STATE-STD-ABBRV = 'OR'
 18135        COMPUTE CP-RATING-BENEFIT-AMT = CR-LFAMT + CR-LFAMT-ALT
 18136     END-IF
 18137
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 347
* ECS010MO.cbl
 18138     IF (CP-RATE-AS-STANDARD) AND (CP-EARN-AS-NET-PAY)
 18139        COMPUTE CP-ORIGINAL-BENEFIT =
 18140         (CR-LFAMT - CR-LFPRM)
 18141     END-IF
 18142
 18143     IF CP-TRUNCATED-LIFE
 18144        MOVE CR-LOAN-TERM            TO CP-LOAN-TERM
 18145     END-IF
 18146
 18147     IF CP-TERM-IS-DAYS
 18148        MOVE CR-LF-TERM-IN-DAYS    TO CP-TERM-OR-EXT-DAYS
 18149     ELSE
 18150        MOVE ZEROS                 TO CP-TERM-OR-EXT-DAYS
 18151     END-IF
 18152
 18153     CALL 'ELRFNDX' USING CALCULATION-PASS-AREA
 18154
 18155     COMPUTE EPR-ST = WE-LFPRM - CP-CALC-REFUND.
 18156
 18157 S-4190-EP-DO-LF-COMM.
 18158
 18159     IF EARNED-BY-CANCEL = ZEROS
 18160         GO TO S-4195-LF-COMM-CONTINUE.
 18161
 18162     IF EPR-R78 GREATER THAN EARNED-BY-CANCEL
 18163         MOVE EARNED-BY-CANCEL     TO EPR-R78.
 18164
 18165     IF EPR-PRO GREATER THAN EARNED-BY-CANCEL
 18166         MOVE EARNED-BY-CANCEL     TO EPR-PRO.
 18167
 18168     IF EPR-ST  GREATER THAN EARNED-BY-CANCEL
 18169         MOVE EARNED-BY-CANCEL     TO EPR-ST.
 18170
 18171 S-4195-LF-COMM-CONTINUE.
 18172
 18173     MOVE +0 TO SUB1.
 18174     PERFORM S-4300-EP-COMM-LOOP THRU S-4399-EP-COMM-LOOP-X
 18175         10 TIMES.
 18176
 18177     COMPUTE EW-EPR-R78 = EW-EPR-R78 - EPR-R78.
 18178     COMPUTE EW-EPR-PRO = EW-EPR-PRO - EPR-PRO.
 18179     COMPUTE EW-EPR-ST  = EW-EPR-ST  - EPR-ST.
 18180
 18181     COMPUTE EW-EPR-R78-ADJ = EW-EPR-R78-ADJ + EPR-R78.
 18182     COMPUTE EW-EPR-PRO-ADJ = EW-EPR-PRO-ADJ + EPR-PRO.
 18183     COMPUTE EW-EPR-ST-ADJ  = EW-EPR-ST-ADJ  + EPR-ST.
 18184
 18185     MOVE 'Y'          TO EW-LEVEL-USED.
 18186
 18187     IF CR-POLICY-UNDERWRITTEN
 18188         MOVE EPEC-WORK       TO EPEC-LEVELS-II (SUB3)
 18189
 18190     ELSE
 18191         MOVE EPEC-WORK       TO EPEC-LEVELS (SUB3).
 18192
 18193     GO TO S-4200-EP-DO-AH.
 18194
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 348
* ECS010MO.cbl
 18196******************************************************************
 18197***  C A L C U L A T E   A & H   S T A R T   E A R N E D       ***
 18198******************************************************************
 18199
 18200 S-4200-EP-DO-AH.
 18201
 18202     MOVE +0                         TO EPR-R78  EARNED-BY-CANCEL
 18203                                        EPR-PRO
 18204                                        EPR-ST.
 18205
 18206     IF CR-AHTYP = ZERO
 18207         GO TO S-4299-EPBX.
 18208
 18209     IF REIN-AH-FLG (SUB5) = SPACE
 18210         GO TO S-4299-EPBX.
 18211
 18212     MOVE AH-OVERRIDE-L1       TO WE-LF-AH.
 18213     MOVE CR-AHTYP             TO WE-BEN-TYPE.
 18214     PERFORM 4400-EP-FIND-TAB-ENT THRU 4499-EP-FIND-TAB-ENT-X.
 18215
 18216     MOVE CR-AH-TERM           TO ORIG-TERM.
 18217     MOVE CLAS-INDEXA          TO W-NDX.
 18218
 18219     MOVE EARNING-START-DATE     TO VALUATION-DT.
 18220     MOVE '9'                    TO W-VAL-SOURCE.
 18221     PERFORM 8500-REMAINING-TERM-ROUTINE THRU 8599-REM-TERM-X.
 18222
 18223 S-4220-EP-DO-AH-CNCL.
 18224
 18225     IF CR-AH-STATUS-AT-CANCEL NOT = ' '
 18226         COMPUTE EARNED-BY-CANCEL = WE-AHPRM - WE-AHRFND.
 18227
 18228 S-4230-EP-DO-AH-EP.
 18229
 18230     IF REM-TRM2 GREATER CR-AH-TERM
 18231         MOVE +0 TO EPR-R78  EPR-PRO  EPR-ST
 18232         GO TO S-4290-EP-DO-AH-COMM.
 18233
 18234     IF CLAS-I-CALC-TYPE (CLAS-INDEXA) = 'Z'
 18235         COMPUTE WE-AHPRM = WE-AHPRM - WE-AHRFND.
 18236
 18237 S-4235-CHECK-OB-AH-NCL.
 18238
 18239     IF (DTE-CLIENT EQUAL 'NCL') AND
 18240        (CLAS-I-CALC-TYPE (CLAS-INDEXA) EQUAL 'B')
 18241           MOVE WE-AHPRM         TO EPR-R78
 18242                                    EPR-PRO
 18243                                    EPR-ST
 18244        IF (CR-CCYY EQUAL EOM-CCYY) AND
 18245           (CR-MO EQUAL EOM-MO)
 18246           MOVE '*'            TO OB-DATE-1-SWITCH
 18247           MOVE EW-REIN-CO     TO WS-OB-REIN-CO (SUB3)
 18248           MOVE AH-OVERRIDE-L1 TO WS-OB-LF-AH (SUB3)
 18249           MOVE CR-AHTYP       TO WS-OB-BENEFIT-CODE (SUB3)
 18250           COMPUTE WS-EPR-R78 (SUB3 1) =
 18251                   WS-EPR-R78 (SUB3 1) - (WE-AHPRM * .5)
 18252            GO TO S-4290-EP-DO-AH-COMM
 18253        ELSE
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 349
* ECS010MO.cbl
 18254        IF (CR-CCYY EQUAL OB-CCYY (1)) AND
 18255           (CR-MO EQUAL OB-MO (1))
 18256           MOVE '*'            TO OB-DATE-2-SWITCH
 18257           MOVE EW-REIN-CO     TO WS-OB-REIN-CO (SUB3)
 18258           MOVE AH-OVERRIDE-L1 TO WS-OB-LF-AH (SUB3)
 18259           MOVE CR-AHTYP       TO WS-OB-BENEFIT-CODE (SUB3)
 18260           COMPUTE WS-EPR-R78 (SUB3 2) =
 18261                   WS-EPR-R78 (SUB3 2) - (WE-AHPRM * .5)
 18262            GO TO S-4290-EP-DO-AH-COMM
 18263        ELSE
 18264        IF (CR-CCYY EQUAL OB-CCYY (2)) AND
 18265           (CR-MO EQUAL OB-MO (2))
 18266           MOVE '*'            TO OB-DATE-3-SWITCH
 18267           MOVE EW-REIN-CO     TO WS-OB-REIN-CO (SUB3)
 18268           MOVE AH-OVERRIDE-L1 TO WS-OB-LF-AH (SUB3)
 18269           MOVE CR-AHTYP       TO WS-OB-BENEFIT-CODE (SUB3)
 18270           COMPUTE WS-EPR-R78 (SUB3 3) =
 18271                   WS-EPR-R78 (SUB3 3) - (WE-AHPRM * .5)
 18272            GO TO S-4290-EP-DO-AH-COMM
 18273        ELSE
 18274            GO TO S-4290-EP-DO-AH-COMM.
 18275
 18276     IF REM-TRM2 NOT GREATER +0
 18277         MOVE WE-AHPRM TO EPR-R78  EPR-PRO  EPR-ST
 18278         GO TO S-4290-EP-DO-AH-COMM.
 18279
 18280     IF CLAS-I-CALC-TYPE (CLAS-INDEXA) = 'B'
 18281         MOVE WE-AHPRM TO EPR-R78  EPR-PRO  EPR-ST
 18282         GO TO S-4290-EP-DO-AH-COMM.
 18283
 18284     COMPUTE TEMP-1 = CR-AH-TERM * (CR-AH-TERM + 1).
 18285     COMPUTE TEMP-2 = REM-TRM1 * (REM-TRM1 + 1).
 18286     IF DTE-R78 = '1'
 18287         COMPUTE TEMP-2 = REM-TRM1 * REM-TRM1.
 18288     COMPUTE TEMP-4 ROUNDED = TEMP-2 / TEMP-1.
 18289
 18290     IF DTE-CLIENT = 'MIC' OR 'MCC'
 18291         COMPUTE TEMP-5 ROUNDED = (REM-TRM1 - .5) / CR-AH-TERM
 18292     ELSE
 18293         COMPUTE TEMP-5 ROUNDED = REM-TRM1 / CR-AH-TERM.
 18294
 18295     COMPUTE EPR-R78 ROUNDED = WE-AHPRM * TEMP-4.
 18296     COMPUTE EPR-R78 = WE-AHPRM - EPR-R78.
 18297
 18298     COMPUTE EPR-PRO ROUNDED = WE-AHPRM * TEMP-5.
 18299     COMPUTE EPR-PRO = WE-AHPRM - EPR-PRO.
 18300
 18301     MOVE  CLAS-I-EP (CLAS-INDEXA) TO AH-EARN-METHOD.
 18302
 18303*    IF AM-EARN-METHOD-A NOT EQUAL SPACES AND ZEROS
 18304*        MOVE AM-EARN-METHOD-A TO AH-EARN-METHOD.
 18305
 18306     MOVE SPACES TO STATUTORY-SWITCH-AH.
 18307
 18308     IF (STATE-ABBR (CLAS-INDEXS) = 'VA') AND
 18309        (CR-DT GREATER THAN  19921231)
 18310         IF CR-AH-TERM GREATER THAN  +61
 18311             MOVE 'A' TO AH-EARN-METHOD
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 350
* ECS010MO.cbl
 18312             MOVE '*' TO STATUTORY-SWITCH-AH
 18313             GO TO S-4245-EP-DO-AH-EP-AN
 18314         ELSE
 18315             GO TO S-4250-EP-DO-AH-STATUTORY.
 18316
 18317     IF AH-EARN-METHOD EQUAL 'N'
 18318         GO TO S-4240-EP-DO-AH-EP-NP.
 18319
 18320     IF AH-EARN-METHOD EQUAL 'A' OR 'C'
 18321         MOVE 'A' TO AH-EARN-METHOD
 18322         GO TO S-4245-EP-DO-AH-EP-AN.
 18323
 18324     GO TO S-4250-EP-DO-AH-STATUTORY.
 18325
 18326 S-4240-EP-DO-AH-EP-NP.
 18327
 18328     IF WE-AHPRM = ZERO
 18329         GO TO S-4250-EP-DO-AH-STATUTORY.
 18330
 18331     IF CR-APR GREATER THAN +0
 18332         NEXT SENTENCE
 18333     ELSE
 18334         GO TO S-4250-EP-DO-AH-STATUTORY.
 18335
 18336     IF DTE-CLIENT = 'NCL'
 18337       IF CR-DT LESS THAN 19910101
 18338           GO TO S-4250-EP-DO-AH-STATUTORY.
 18339
 18340     IF REM-TRM1 = CR-AH-TERM
 18341         MOVE +0 TO EPR-R78  EPR-PRO  EPR-ST
 18342         GO TO S-4290-EP-DO-AH-COMM.
 18343
 18344     MOVE CR-APR TO NP-APR.
 18345     MOVE CR-AH-TERM TO NP-ORIG  NP-CAP.
 18346     MOVE REM-TRM1 TO NP-REM.
 18347     MOVE CLAS-I-CALC-TYPE (CLAS-INDEXA) TO NP-OPT.
 18348     IF NP-OPT = 'T' OR 'U' OR 'V' OR 'W' OR 'X'
 18349         MOVE CR-LOAN-TERM TO NP-ORIG.
 18350     MOVE 'R' TO NP-OPT.
 18351     CALL 'ECSNETRM'
 18352         USING NP-APR NP-ORIG NP-REM NP-OPT NP-CAP NP-FACTOR.
 18353
 18354     COMPUTE EPR-R78 ROUNDED = WE-AHPRM - (NP-FACTOR * WE-AHPRM).
 18355
 18356     GO TO S-4250-EP-DO-AH-STATUTORY.
 18357
 18358 S-4245-EP-DO-AH-EP-AN.
 18359     MOVE CR-DT                      TO DC-GREG-DATE-CYMD.
 18360     MOVE 'L'                        TO DC-OPTION-CODE.
 18361     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 18362     MOVE DC-BIN-DATE-1              TO CP-CERT-EFF-DT.
 18363     MOVE CLAS-I-RL-AH (CLAS-INDEXA) TO CP-BENEFIT-TYPE.
 18364     MOVE SPACES                     TO CP-ACCT-FLD-5.
 18365     MOVE DTE-CLIENT                 TO CP-COMPANY-ID.
 18366     MOVE STATE-SUB (CLAS-INDEXS)    TO CP-STATE.
 18367     MOVE STATE-ABBR (CLAS-INDEXS)   TO CP-STATE-STD-ABBRV.
 18368     MOVE CR-AGE                     TO CP-ISSUE-AGE.
 18369     MOVE REM-TRM1                   TO CP-ORIGINAL-TERM.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 351
* ECS010MO.cbl
 18370     MOVE CR-AHAMT                   TO CP-ORIGINAL-BENEFIT
 18371                                        CP-RATING-BENEFIT-AMT.
 18372     IF CP-STATE-STD-ABBRV = 'OR'
 18373         COMPUTE CP-RATING-BENEFIT-AMT =
 18374                                  CR-AHAMT * REM-TRM1.
 18375     MOVE CR-APR                     TO CP-LOAN-APR.
 18376     MOVE CR-PMT-FREQ                TO CP-PAY-FREQUENCY.
 18377     MOVE AH-EARN-METHOD             TO CP-EARNING-METHOD.
 18378     MOVE '3'                        TO CP-PROCESS-TYPE.
 18379     MOVE CLAS-I-BAL (CLAS-INDEXA)   TO CP-SPECIAL-CALC-CD.
 18380     MOVE CR-LOAN-TERM               TO CP-LOAN-TERM.
 18381
 18382     IF CR-RATING-CLASS NOT = SPACE AND ZERO
 18383         MOVE CR-RATING-CLASS        TO CP-CLASS-CODE
 18384     ELSE
 18385         MOVE AM-CAL-TABLE           TO CP-CLASS-CODE.
 18386
 18387     MOVE AM-AH-DEVIATION            TO CP-DEVIATION-CODE.
 18388     MOVE CR-AHTYP                   TO CP-BENEFIT-CD.
 18389     MOVE DTE-CLASIC-COMPANY-CD      TO CP-COMPANY-CD.
 18390     MOVE CR-PMT-EXTENSION-DAYS      TO CP-TERM-OR-EXT-DAYS.
 18391     MOVE AH-OVERRIDE-L1             TO CP-AH-OVERRIDE-CODE.
 18392     MOVE AM-AH-DEVIATION-PCT        TO CP-RATE-DEV-PCT.
 18393
 18394     PERFORM 8100-GET-RATE THRU 8199-GET-RATE-X.
 18395
 18396     IF CP-ERROR-RATE-NOT-FOUND  OR
 18397        CP-ERROR-RATE-IS-ZERO  OR
 18398        CP-ERROR-IN-DATES
 18399         GO TO S-4250-EP-DO-AH-STATUTORY.
 18400
 18401     COMPUTE EPR-R78 ROUNDED =
 18402             ((REM-TRM1 * WE-AHAMT) / +100) *
 18403               CP-PREMIUM-RATE.
 18404
 18405     COMPUTE EPR-R78 = WE-AHPRM - EPR-R78.
 18406
 18407     IF STATUTORY-REQUIREMENT-AH
 18408         MOVE EPR-R78                TO EPR-ST
 18409         GO TO S-4290-EP-DO-AH-COMM.
 18410
 18411 S-4250-EP-DO-AH-STATUTORY.
 18412     IF (DTE-CLIENT EQUAL 'CID') AND
 18413        (STATE-ABBR (CLAS-INDEXS) = 'VA')
 18414         GO TO S-4267-EP-DO-AH-STAT-ROA
 18415     END-IF.
 18416
 18417 S-4250-EP-DO-AH-STATUTORY-VA.
 18418
 18419     MOVE EPR-R78                    TO EPR-ST.
 18420
 18421     MOVE +0                         TO SUB1.
 18422
 18423 S-4255-EP-AH-STAT-LOOP.
 18424     ADD +1 TO SUB1.
 18425
 18426     IF STATE-ABBR (CLAS-INDEXS) = AH-RES-STATE-ENT (SUB1)
 18427         MOVE EPR-PRO                TO EPR-ST
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 352
* ECS010MO.cbl
 18428     ELSE
 18429         IF AH-RES-STATE-ENT (SUB1) NOT = HIGH-VALUES
 18430             GO TO S-4255-EP-AH-STAT-LOOP.
 18431
 18432     IF (STATE-ABBR (CLAS-INDEXS) = 'OH'  AND
 18433         CR-DT GREATER THAN 19831031)
 18434                    OR
 18435        (STATE-ABBR (CLAS-INDEXS) = 'OK'  AND
 18436         CR-DT GREATER THAN 19820629)
 18437                    OR
 18438        (STATE-ABBR (CLAS-INDEXS) = 'TX'  AND
 18439         CR-DT GREATER THAN 19830831)
 18440             COMPUTE EPR-ST = (EPR-R78 + EPR-PRO) / 2.
 18441
 18442     IF DTE-CLIENT = 'CSO'  OR  'CID'
 18443       IF STATE-ABBR (CLAS-INDEXS) = 'CO'
 18444         IF CR-DT LESS THAN 19970101
 18445             MOVE EPR-R78            TO EPR-ST
 18446         ELSE
 18447             COMPUTE EPR-ST = (EPR-R78 + EPR-PRO) / 2.
 18448
 18449     GO TO S-4290-EP-DO-AH-COMM.
 18450
 18451 S-4267-EP-DO-AH-STAT-ROA.
 18452     MOVE CR-DT                      TO DC-GREG-DATE-CYMD.
 18453     MOVE 'L'                        TO DC-OPTION-CODE.
 18454     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 18455     MOVE DC-BIN-DATE-1              TO CP-CERT-EFF-DT.
 18456     MOVE CLAS-I-RL-AH (CLAS-INDEXA) TO CP-BENEFIT-TYPE.
 18457     MOVE SPACES                     TO CP-ACCT-FLD-5.
 18458     MOVE DTE-CLIENT                 TO CP-COMPANY-ID.
 18459     MOVE STATE-SUB (CLAS-INDEXS)    TO CP-STATE.
 18460     MOVE STATE-ABBR (CLAS-INDEXS)   TO CP-STATE-STD-ABBRV.
 18461     MOVE CR-AGE                     TO CP-ISSUE-AGE.
 18462     MOVE REM-TRM1                   TO CP-ORIGINAL-TERM.
 18463     MOVE CR-AHAMT                   TO CP-ORIGINAL-BENEFIT
 18464                                        CP-RATING-BENEFIT-AMT.
 18465     IF CP-STATE-STD-ABBRV = 'OR'
 18466         COMPUTE CP-RATING-BENEFIT-AMT =
 18467                                  CR-AHAMT * REM-TRM1.
 18468     MOVE CR-APR                     TO CP-LOAN-APR.
 18469     MOVE CR-PMT-FREQ                TO CP-PAY-FREQUENCY.
 18470     MOVE 'A'                        TO CP-EARNING-METHOD.
 18471     MOVE '3'                        TO CP-PROCESS-TYPE.
 18472     MOVE CLAS-I-BAL (CLAS-INDEXA)   TO CP-SPECIAL-CALC-CD.
 18473     MOVE CR-LOAN-TERM               TO CP-LOAN-TERM.
 18474     IF CR-RATING-CLASS NOT = SPACE AND ZERO
 18475         MOVE CR-RATING-CLASS        TO CP-CLASS-CODE
 18476     ELSE
 18477         MOVE AM-CAL-TABLE           TO CP-CLASS-CODE.
 18478     MOVE AM-AH-DEVIATION            TO CP-DEVIATION-CODE.
 18479     MOVE CR-AHTYP                   TO CP-BENEFIT-CD.
 18480     MOVE DTE-CLASIC-COMPANY-CD      TO CP-COMPANY-CD.
 18481     MOVE CR-PMT-EXTENSION-DAYS      TO CP-TERM-OR-EXT-DAYS.
 18482     MOVE AH-OVERRIDE-L1             TO CP-AH-OVERRIDE-CODE.
 18483     MOVE AM-AH-DEVIATION-PCT        TO CP-RATE-DEV-PCT.
 18484
 18485     PERFORM 8100-GET-RATE THRU 8199-GET-RATE-X.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 353
* ECS010MO.cbl
 18486
 18487     IF CP-ERROR-RATE-NOT-FOUND  OR
 18488        CP-ERROR-RATE-IS-ZERO  OR
 18489        CP-ERROR-IN-DATES
 18490         GO TO S-4250-EP-DO-AH-STATUTORY-VA.
 18491
 18492     COMPUTE EPR-ST ROUNDED =
 18493             ((REM-TRM1 * WE-AHAMT) / +100) *
 18494               CP-PREMIUM-RATE.
 18495
 18496     COMPUTE EPR-ST = WE-AHPRM - EPR-ST.
 18497
 18498     GO TO S-4290-EP-DO-AH-COMM.
 18499
 18500 S-4290-EP-DO-AH-COMM.
 18501
 18502     IF EARNED-BY-CANCEL = ZEROS
 18503         GO TO S-4295-AH-COMM-CONTINUE.
 18504
 18505     IF EPR-R78 GREATER THAN EARNED-BY-CANCEL
 18506         MOVE EARNED-BY-CANCEL     TO EPR-R78.
 18507
 18508     IF EPR-PRO GREATER THAN EARNED-BY-CANCEL
 18509         MOVE EARNED-BY-CANCEL     TO EPR-PRO.
 18510
 18511     IF EPR-ST  GREATER THAN EARNED-BY-CANCEL
 18512         MOVE EARNED-BY-CANCEL     TO EPR-ST.
 18513
 18514 S-4295-AH-COMM-CONTINUE.
 18515
 18516     MOVE +0           TO SUB1.
 18517     PERFORM S-4300-EP-COMM-LOOP THRU S-4399-EP-COMM-LOOP-X
 18518         10 TIMES.
 18519
 18520     COMPUTE EW-EPR-R78 = EW-EPR-R78 - EPR-R78.
 18521     COMPUTE EW-EPR-PRO = EW-EPR-PRO - EPR-PRO.
 18522     COMPUTE EW-EPR-ST  = EW-EPR-ST  - EPR-ST.
 18523
 18524     COMPUTE EW-EPR-R78-ADJ = EW-EPR-R78-ADJ + EPR-R78.
 18525     COMPUTE EW-EPR-PRO-ADJ = EW-EPR-PRO-ADJ + EPR-PRO.
 18526     COMPUTE EW-EPR-ST-ADJ  = EW-EPR-ST-ADJ  + EPR-ST.
 18527
 18528     MOVE 'Y'          TO EW-LEVEL-USED.
 18529
 18530     IF CR-POLICY-UNDERWRITTEN
 18531         MOVE EPEC-WORK       TO EPEC-LEVELS-II (SUB3)
 18532     ELSE
 18533         MOVE EPEC-WORK       TO EPEC-LEVELS (SUB3).
 18534
 18535
 18536 S-4299-EPBX.
 18537     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 354
* ECS010MO.cbl
 18539******************************************************************
 18540***    C A L C U L A T E   S T A R T   E A R N E D   C O M M   ***
 18541******************************************************************
 18542
 18543 S-4300-EP-COMM-LOOP.
 18544
 18545     ADD +1 TO SUB1.
 18546     IF CR-COM-AGT (SUB1) = SPACES OR ZEROS
 18547         GO TO S-4399-EP-COMM-LOOP-X.
 18548
 18549     IF EW-LF-AH = AH-OVERRIDE-L1
 18550         GO TO S-4350-EP-COMM-LOOP-A.
 18551
 18552*    IF CR-AGT-TYPE (SUB1) = 'K'
 18553*       COMPUTE COMM-WK =
 18554     COMPUTE COMM-WK ROUNDED = EPR-R78 * CR-LCOM-L (SUB1).
 18555     COMPUTE EW-ECR-R78 (SUB1) = EW-ECR-R78 (SUB1) - COMM-WK.
 18556     COMPUTE EW-ECR-R78-ADJ (SUB1) =
 18557                                 EW-ECR-R78-ADJ (SUB1) + COMM-WK.
 18558
 18559     COMPUTE COMM-WK ROUNDED = EPR-PRO * CR-LCOM-L (SUB1).
 18560     COMPUTE EW-ECR-PRO (SUB1) = EW-ECR-PRO (SUB1) - COMM-WK.
 18561     COMPUTE EW-ECR-PRO-ADJ (SUB1) =
 18562                                 EW-ECR-PRO-ADJ (SUB1) + COMM-WK.
 18563
 18564     COMPUTE COMM-WK ROUNDED = EPR-ST * CR-LCOM-L (SUB1).
 18565     COMPUTE EW-ECR-ST (SUB1) = EW-ECR-ST (SUB1) - COMM-WK.
 18566
 18567     GO TO S-4399-EP-COMM-LOOP-X.
 18568
 18569 S-4350-EP-COMM-LOOP-A.
 18570
 18571     COMPUTE COMM-WK ROUNDED = EPR-R78 * CR-LCOM-AH (SUB1).
 18572     COMPUTE EW-ECR-R78 (SUB1) = EW-ECR-R78 (SUB1) - COMM-WK.
 18573     COMPUTE EW-ECR-R78-ADJ (SUB1) =
 18574                                 EW-ECR-R78-ADJ (SUB1) + COMM-WK.
 18575
 18576     COMPUTE COMM-WK ROUNDED = EPR-PRO * CR-LCOM-AH (SUB1).
 18577     COMPUTE EW-ECR-PRO (SUB1) = EW-ECR-PRO (SUB1) - COMM-WK.
 18578     COMPUTE EW-ECR-PRO-ADJ (SUB1) =
 18579                                 EW-ECR-PRO-ADJ (SUB1) + COMM-WK.
 18580
 18581     COMPUTE COMM-WK ROUNDED = EPR-ST * CR-LCOM-AH (SUB1).
 18582     COMPUTE EW-ECR-ST (SUB1) = EW-ECR-ST (SUB1) - COMM-WK.
 18583
 18584 S-4399-EP-COMM-LOOP-X.
 18585     EXIT.
 18586
 18587******************************************************************
 18588******************************************************************
 18589******************************************************************
 18590******************************************************************
 18591******************************************************************
 18592******************************************************************
 18593******************************************************************
 18594******************************************************************
 18595******************************************************************
 18596******************************************************************
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 355
* ECS010MO.cbl
 18598******************************************************************
 18599***     F I N D   R E I N S U R A N C E   T A B L E   S U B    ***
 18600******************************************************************
 18601
 18602 4400-EP-FIND-TAB-ENT.
 18603
 18604     IF WE-REIN-CO = EPEC-SUB-REIN (SUB9)
 18605         GO TO 4490-EP-FIND-TAB-SUB.
 18606     MOVE +1 TO SUB9.
 18607
 18608 4450-EP-FIND-TAB-LOOP.
 18609
 18610     IF WE-REIN-CO = EPEC-SUB-REIN (SUB9)
 18611         GO TO 4490-EP-FIND-TAB-SUB.
 18612     IF EPEC-SUB-REIN (SUB9) = ZEROS
 18613         MOVE WE-REIN-CO TO EPEC-SUB-REIN (SUB9)
 18614         GO TO 4490-EP-FIND-TAB-SUB.
 18615
 18616     ADD +1 TO SUB9.
 18617     IF SUB9 GREATER THAN +31
 18618         DISPLAY 'EPEC SUBSCRIPT TABLE FULL ' AM-MSTR-CNTRL
 18619         MOVE 0201 TO WS-ABEND-CODE
 18620         DISPLAY '******************************'
 18621         DISPLAY '***** ERROR LOCATION 020 *****'
 18622         DISPLAY '******************************'
 18623         MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
 18624         GO TO ABEND-PGM.
 18625
 18626     GO TO 4450-EP-FIND-TAB-LOOP.
 18627
 18628 4490-EP-FIND-TAB-SUB.
 18629
 18630     IF WE-LF-AH = LIFE-OVERRIDE-L1
 18631         IF EPEC-SUB-LF (SUB9 CLAS-INDEXL) = ZERO
 18632             ADD +1 TO SUB10
 18633             MOVE SUB10 TO SUB3
 18634             MOVE SUB10 TO EPEC-SUB-LF (SUB9 CLAS-INDEXL)
 18635         ELSE
 18636             MOVE EPEC-SUB-LF (SUB9 CLAS-INDEXL) TO SUB3.
 18637
 18638     IF WE-LF-AH = AH-OVERRIDE-L1
 18639         IF EPEC-SUB-AH (SUB9 CLAS-INDEXA) = ZERO
 18640             ADD +1 TO SUB10
 18641             MOVE SUB10 TO SUB3
 18642             MOVE SUB10 TO EPEC-SUB-AH (SUB9 CLAS-INDEXA)
 18643         ELSE
 18644             MOVE EPEC-SUB-AH (SUB9 CLAS-INDEXA) TO SUB3.
 18645
 18646*    IF SUB3 GREATER THAN +220
 18647*    IF SUB3 GREATER THAN +300
 18648     IF SUB3 GREATER THAN +900
 18649         DISPLAY 'SUB3 VALUE IS - ' SUB3
 18650         DISPLAY 'EPEC WORK TABLE FULL ' AM-MSTR-CNTRL
 18651         MOVE 0202 TO WS-ABEND-CODE
 18652         DISPLAY '******************************'
 18653         DISPLAY '***** ERROR LOCATION 021 *****'
 18654         DISPLAY '******************************'
 18655         MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 356
* ECS010MO.cbl
 18656         GO TO ABEND-PGM.
 18657
 18658     IF CR-POLICY-UNDERWRITTEN
 18659         MOVE EPEC-LEVELS-II (SUB3)  TO EPEC-WORK
 18660         MOVE EPEC-UNDW-OPT-DATA-TABLE
 18661                                     TO EPEC-OPT-WORK-TABLE
 18662     ELSE
 18663         MOVE EPEC-LEVELS (SUB3)     TO EPEC-WORK
 18664         MOVE EPEC-OPT-DATA-TABLE    TO EPEC-OPT-WORK-TABLE.
 18665
 18666     MOVE WE-REIN-CO         TO EW-REIN-CO
 18667                                EPEC-REIN-CO (SUB3)
 18668                                EPEC-REIN-CO-II (SUB3).
 18669     MOVE WE-LF-AH           TO EW-LF-AH
 18670                                EPEC-LF-AH (SUB3)
 18671                                EPEC-LF-AH-II (SUB3).
 18672     MOVE WE-BEN-TYPE        TO EW-BEN-TYPE
 18673                                EPEC-BEN-TYPE (SUB3)
 18674                                EPEC-BEN-TYPE-II (SUB3).
 18675
 18676 4499-EP-FIND-TAB-ENT-X.
 18677     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 357
* ECS010MO.cbl
 18679******************************************************************
 18680***         B U I L D   S U M M A R Y   E X T R A C T S        ***
 18681******************************************************************
 18682
 18683 4500-BUILD-EPEC-EXTRACT.
 18684
 18685     IF DTE-CLIENT = 'DCC'
 18686        PERFORM 4541-CALC-IBNR   THRU 4541-EXIT
 18687     END-IF
 18688
 18689     PERFORM 4510-BUILD-EPEC-EXT THRU 4519-BUILD-EPEC-EXT-X
 18690         VARYING SUB2 FROM +1 BY +1
 18691             UNTIL EPEC-REIN-CO (SUB2) = ZEROS.
 18692
 18693     PERFORM 4550-CLEAR-EPEC-TOTALS THRU 4589-CLEAR-EPEC-TOTALS-X.
 18694
 18695     GO TO 4599-BUILD-EPEC-EXTRACT-X.
 18696
 18697
 18698 4510-BUILD-EPEC-EXT.
 18699
 18700     MOVE EPEC-LEVELS (SUB2)            TO EPEC-WORK.
 18701     MOVE EPEC-OPT-DATA-TABLE           TO EPEC-OPT-WORK-TABLE.
 18702     IF EW-LEVEL-USED = 'Y'
 18703         MOVE SPACE                     TO W-UNDERWRITING-SW
 18704         PERFORM 4511-BUILD-EPEC-RECORD THRU
 18705                 4518-BUILD-EPEC-RCD-X.
 18706
 18707     MOVE EPEC-LEVELS-II (SUB2)         TO EPEC-WORK.
 18708     MOVE EPEC-UNDW-OPT-DATA-TABLE      TO EPEC-OPT-WORK-TABLE.
 18709     IF EW-LEVEL-USED = 'Y'
 18710         MOVE '*'                       TO W-UNDERWRITING-SW
 18711         PERFORM 4511-BUILD-EPEC-RECORD THRU
 18712                 4518-BUILD-EPEC-RCD-X.
 18713
 18714     GO TO 4519-BUILD-EPEC-EXT-X.
 18715
 18716 4511-BUILD-EPEC-RECORD.
 18717
 18718     MOVE SPACES                        TO EP-RECORD.
 18719     MOVE 'EP'                          TO EP-RECORD-ID.
 18720     MOVE DTE-CLASIC-COMPANY-CD         TO EP-COMPANY-CD.
 18721     MOVE AM-MSTR-CNTRL                 TO EP-CONTROL.
 18722     MOVE AM-EXPIRE-DT                  TO WS-EP-EXP-DTE-N.
 18723     MOVE AM-EFFECT-DT                  TO EP-EFF-DTE
 18724                                           WS-EP-EFF-DTE-N.
 18725     MOVE EW-REIN-CO                    TO EP-REI-CO.
 18726     IF EP-REI-CO NOT = SPACES
 18727         MOVE 'R'                       TO EP-REIN.
 18728     MOVE EW-LF-AH                      TO EP-RCD-TYPE.
 18729     MOVE EW-BEN-TYPE                   TO EP-BEN-CODE.
 18730
 18731     MOVE EW-ISS-CNT                    TO EP-ISS-CNT.
 18732     MOVE EW-ISS-BEN                    TO EP-ISS-BEN.
 18733     MOVE EW-ISS-BEN-GROSS              TO EP-ISS-BEN-GROSS.
 18734
 18735     MOVE EW-CNC-CNT                    TO EP-CNC-CNT.
 18736     MOVE EW-CNC-BEN                    TO EP-CNC-BEN.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 358
* ECS010MO.cbl
 18737     MOVE EW-CNC-BEN-GROSS              TO EP-CNC-BEN-GROSS.
 18738
 18739     MOVE EW-ISS-PRM                    TO EP-ISS-PRM.
 18740     MOVE EW-ISS-PRM-GROSS              TO EP-ISS-PRM-GROSS.
 18741     MOVE EW-CNC-PRM                    TO EP-CNC-PRM.
 18742     MOVE EW-CNC-PRM-GROSS              TO EP-CNC-PRM-GROSS.
 18743
 18744     IF DTE-CLIENT NOT = 'NCL'
 18745         GO TO 4512-BUILD-EPEC-CONTINUE.
 18746
 18747     IF W-UNDERWRITTEN-DATA
 18748         GO TO 4512-BUILD-EPEC-CONTINUE.
 18749
 18750     IF AM-EXPIRE-DT NOT GREATER THAN EOM-RUN-DATE
 18751         GO TO 4512-BUILD-EPEC-CONTINUE.
 18752
 18753     IF WS-OB-REIN-CO (SUB2) = EW-REIN-CO  AND
 18754        WS-OB-LF-AH (SUB2) = EW-LF-AH  AND
 18755        WS-OB-BENEFIT-CODE (SUB2) = EW-BEN-TYPE
 18756         NEXT SENTENCE
 18757     ELSE
 18758         GO TO 4512-BUILD-EPEC-CONTINUE.
 18759
 18760     IF OB-DATE-1-USED  OR
 18761        OB-DATE-2-USED  OR
 18762        OB-DATE-3-USED
 18763         NEXT SENTENCE
 18764     ELSE
 18765         GO TO 4512-BUILD-EPEC-CONTINUE.
 18766
 18767     IF OB-DATE-1-USED
 18768         IF WS-EPR-R78 (SUB2 1) NOT EQUAL +0
 18769             COMPUTE EW-EPR-R78 = EW-ISS-PRM - EW-CNC-PRM -
 18770                           EW-EPR-R78-ADJ - WS-EPR-R78 (SUB2 1)
 18771             MOVE EW-EPR-R78    TO EW-EPR-PRO
 18772                                   EW-EPR-ST
 18773             GO TO 4512-BUILD-EPEC-CONTINUE
 18774         ELSE
 18775             GO TO 4512-BUILD-EPEC-CONTINUE.
 18776
 18777     IF OB-DATE-2-USED
 18778         IF WS-EPR-R78 (SUB2 2) NOT EQUAL +0
 18779             COMPUTE EW-EPR-R78 = EW-ISS-PRM - EW-CNC-PRM -
 18780                           EW-EPR-R78-ADJ - WS-EPR-R78 (SUB2 2)
 18781             MOVE EW-EPR-R78    TO EW-EPR-PRO
 18782                                   EW-EPR-ST
 18783             GO TO 4512-BUILD-EPEC-CONTINUE
 18784         ELSE
 18785             GO TO 4512-BUILD-EPEC-CONTINUE.
 18786
 18787     IF OB-DATE-3-USED
 18788         IF WS-EPR-R78 (SUB2 3) NOT EQUAL +0
 18789             COMPUTE EW-EPR-R78 = EW-ISS-PRM - EW-CNC-PRM -
 18790                           EW-EPR-R78-ADJ - WS-EPR-R78 (SUB2 3)
 18791             MOVE EW-EPR-R78    TO EW-EPR-PRO
 18792                                   EW-EPR-ST
 18793             GO TO 4512-BUILD-EPEC-CONTINUE
 18794         ELSE
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 359
* ECS010MO.cbl
 18795             GO TO 4512-BUILD-EPEC-CONTINUE.
 18796
 18797 4512-BUILD-EPEC-CONTINUE.
 18798
 18799     MOVE EW-EPR-R78                    TO EP-PRM-78.
 18800     MOVE EW-EPR-PRO                    TO EP-PRM-PR.
 18801     MOVE EW-EPR-ST                     TO EP-PRM-ST.
 18802
 18803     MOVE EW-EPR-R78-ADJ                TO EP-PRM-78-ADJ.
 18804     MOVE EW-EPR-PRO-ADJ                TO EP-PRM-PR-ADJ.
 18805     MOVE EW-EPR-ST-ADJ                 TO EP-PRM-ST-ADJ.
 18806
 18807     MOVE EW-ISS-PRM-TAX                TO EP-PRM-TAX
 18808
 18809     MOVE EW-CLM-AMT                    TO EP-CLM-AMT.
 18810     MOVE EW-CLM-CNT                    TO EP-CLM-CNT.
 18811     MOVE EW-CLM-CRT                    TO EP-CLM-CRT.
 18812
 18813     MOVE EW-CLM-PAYCUR                 TO EP-CLM-DU.
 18814     MOVE ZEROS                         TO EP-CLM-PV.
 18815
 18816     IF EP-RCD-TYPE = 'A' OR 'U'
 18817         IF CARRIER-UEP-PCT (CLAS-INDEXCN) NOT = ZEROS
 18818             PERFORM 4599A-CALC-IBNR THRU 4599A-CALC-EXIT.
 18819
 18820     MOVE EW-CLM-IBNR                   TO EP-CLM-IBNR.
 18821
 18822     MOVE EW-CLM-FUTRSV                 TO EP-LOSS-RESV.
 18823     MOVE ZEROS                         TO EP-CLAIM-ADJ.
 18824
 18825     MOVE EW-INFORCE-CNT                TO EP-INFORCE-CNT.
 18826
 18827     IF EW-ISS-CNT = ZERO
 18828         MOVE ZERO                      TO EP-AVG-ORIG-TERM
 18829                                           EP-AVG-AGE
 18830       ELSE
 18831         COMPUTE EP-AVG-ORIG-TERM ROUNDED =
 18832                                EW-ORIG-TERM / EW-ISS-CNT
 18833         COMPUTE EP-AVG-AGE ROUNDED = EW-AGE / EW-ISS-CNT.
 18834
 18835     IF EW-INFORCE-CNT = ZERO
 18836         MOVE ZERO                      TO EP-AVG-REM-TERM
 18837       ELSE
 18838         COMPUTE EP-AVG-REM-TERM ROUNDED =
 18839                             EW-REM-TERM / EW-INFORCE-CNT.
 18840
 18841     IF EW-ISS-BEN = ZERO
 18842         MOVE ZERO                      TO EP-WEIGHTED-ORIG-TERM
 18843                                           EP-WEIGHTED-AGE
 18844       ELSE
 18845         COMPUTE EP-WEIGHTED-ORIG-TERM ROUNDED =
 18846                                  EW-TERM-BEN / EW-ISS-BEN
 18847         COMPUTE EP-WEIGHTED-AGE ROUNDED =
 18848                                   EW-AGE-BEN / EW-ISS-BEN.
 18849
 18850     MOVE ZEROS                         TO
 18851         EP-RETRO-EXPENSES  EP-RETRO-PAYMENTS  EP-RETRO-OTH-COMM
 18852         EP-MORT-RESV       EP-IN-FORCE        EP-ADJUST.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 360
* ECS010MO.cbl
 18853
 18854     MOVE EW-COV-DTE                    TO EP-HI-COV-DT
 18855                                           WS-EP-HI-COV-DT-N.
 18856     MOVE HIGH-CERT                     TO EP-HI-CERT
 18857                                           WS-EP-HI-CERT-N.
 18858     MOVE LOW-CERT                      TO EP-LO-CERT
 18859                                           WS-EP-LO-CERT-N.
 18860     IF DTE-PGM-OPT = '3'
 18861         MOVE 'P'                       TO EP-PURGE.
 18862
 18863     IF  DTE-OPT-RESERVE-METHOD-UNAUTH
 18864         GO TO 4514-CONTINUE.
 18865
 18866     MOVE EPEC-CLM-EXP (SUB2)    TO EP-CLM-EXP.
 18867
 18868     IF  EPEC-LIFE-CTR-NOT-USED (SUB2)
 18869         MOVE +1                 TO EP-LIFE-YEARS
 18870     ELSE
 18871         MOVE ZEROS              TO W-LIFE-YEARS
 18872         PERFORM 4515-DETERMINE-LIFE-YEARS THRU 4515-EXIT
 18873                 VARYING
 18874             SUBM FROM +1 BY +1
 18875                 UNTIL
 18876             SUBM GREATER THAN +13
 18877         COMPUTE W-LIFE-YEARS-INT ROUNDED
 18878             = W-LIFE-YEARS / 12
 18879             - (EPEC-LIFE-CTR (SUB2 1)
 18880             + EPEC-LIFE-CTR (SUB2 13)) / 24
 18881         COMPUTE EP-LIFE-YEARS ROUNDED = W-LIFE-YEARS-INT
 18882         IF  EP-LIFE-YEARS LESS THAN +1
 18883             MOVE +1             TO EP-LIFE-YEARS.
 18884
 18885 4514-CONTINUE.
 18886
 18887     PERFORM 4900-WRITE-SUMMARY-EXTRACTS THRU 4999-WRT-SUMMARY-X.
 18888
 18889     MOVE SPACES                        TO EC-RECORD.
 18890     MOVE '1'                           TO WS-SEQ-NBR.
 18891     MOVE +0                            TO SUB3.
 18892     MOVE +0                            TO SUB4.
 18893     PERFORM 4520-BUILD-EPEC-LOAD-COMM
 18894         THRU 4539-BUILD-EPEC-LOAD-COMM-X
 18895         UNTIL SUB4  GREATER THAN WS-LOOP-MAX.
 18896
 18897     GO TO 4518-BUILD-EPEC-RCD-X.
 18898
 18899 4515-DETERMINE-LIFE-YEARS.
 18900
 18901     ADD EPEC-LIFE-CTR (SUB2 SUBM)      TO W-LIFE-YEARS.
 18902
 18903 4515-EXIT.
 18904     EXIT.
 18905
 18906 4518-BUILD-EPEC-RCD-X.
 18907     EXIT.
 18908
 18909 4519-BUILD-EPEC-EXT-X.
 18910     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 361
* ECS010MO.cbl
 18911
 18912 4520-BUILD-EPEC-LOAD-COMM.
 18913
 18914     PERFORM 4545-BUILD-BASE  THRU  4545-BUILD-BASE-X.
 18915
 18916     ADD +1 TO SUB3  SUB4.
 18917     MOVE ZEROS                  TO LEVELS-BUILT.
 18918
 18919 4530-BUILD-EPEC-LOAD-COMM-LOOP.
 18920
 18921     IF SUB4 GREATER THAN WS-LOOP-MAX
 18922         IF AGT-SW = 'X'
 18923             PERFORM 4900-WRITE-SUMMARY-EXTRACTS
 18924                 THRU 4999-WRT-SUMMARY-X
 18925             MOVE ' '            TO AGT-SW
 18926             MOVE WS-LOOP-MAX    TO  SUB4
 18927             GO TO 4539-BUILD-EPEC-LOAD-COMM-X
 18928         ELSE
 18929             GO TO 4539-BUILD-EPEC-LOAD-COMM-X.
 18930
 18931     IF LEVELS-BUILT EQUAL +5
 18932         IF AGT-SW = 'X'
 18933             PERFORM 4900-WRITE-SUMMARY-EXTRACTS
 18934                 THRU 4999-WRT-SUMMARY-X
 18935             MOVE ' '            TO AGT-SW
 18936             MOVE ZEROS          TO LEVELS-BUILT
 18937             ADD 1 TO WS-SEQ-NBR
 18938             PERFORM 4545-BUILD-BASE  THRU  4545-BUILD-BASE-X
 18939             PERFORM 4540-BUILD-EPEC-CLEAR  THRU
 18940                     4540-BUILD-CLEAR-X
 18941                 VARYING SUB3 FROM +1 BY +1
 18942                 UNTIL SUB3 GREATER THAN +5
 18943             MOVE +1             TO SUB3
 18944             GO TO 4531-BUILD-EPEC-LOAD-COMM
 18945         ELSE
 18946             MOVE +1             TO SUB3
 18947             MOVE ZEROS          TO LEVELS-BUILT
 18948             GO TO 4531-BUILD-EPEC-LOAD-COMM.
 18949
 18950     IF SUB4 GREATER THAN WS-LOOP-MAX
 18951         IF AGT-SW = 'X'
 18952             PERFORM 4900-WRITE-SUMMARY-EXTRACTS
 18953                 THRU 4999-WRT-SUMMARY-X
 18954             MOVE ' '                   TO AGT-SW
 18955             GO TO 4539-BUILD-EPEC-LOAD-COMM-X
 18956         ELSE
 18957             GO TO 4539-BUILD-EPEC-LOAD-COMM-X.
 18958
 18959 4531-BUILD-EPEC-LOAD-COMM.
 18960
 18961     IF (EW-AGT-NO (SUB4) = SPACES)
 18962                  OR
 18963        ((EW-ISS-COM (SUB4) = ZEROS) AND
 18964         (EW-CNC-COM (SUB4) = ZEROS) AND
 18965         (EW-ECR-R78 (SUB4) = ZEROS) AND
 18966         (EW-ECR-R78-ADJ (SUB4) = ZEROS) AND
 18967         (EW-ECR-PRO (SUB4) = ZEROS) AND
 18968         (EW-ECR-PRO-ADJ (SUB4) = ZEROS) AND
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 362
* ECS010MO.cbl
 18969         (EW-ECR-ST (SUB4) = ZEROS))
 18970         PERFORM 4540-BUILD-EPEC-CLEAR
 18971             THRU 4540-BUILD-CLEAR-X
 18972         ADD +1 TO SUB4
 18973         GO TO 4530-BUILD-EPEC-LOAD-COMM-LOOP.
 18974
 18975     MOVE 'X'                           TO AGT-SW.
 18976     MOVE EW-AGT-NO (SUB4)              TO EC-AGT-NO (SUB3).
 18977     MOVE EW-AGT-TYPE (SUB4)            TO EC-AGT-TYPE (SUB3).
 18978     MOVE EW-ISS-COM (SUB4)             TO EC-ISS-COMM (SUB3).
 18979     MOVE EW-CNC-COM (SUB4)             TO EC-CNC-COMM (SUB3).
 18980     MOVE EW-ECR-R78 (SUB4)             TO EC-COMM-78 (SUB3).
 18981     MOVE EW-ECR-PRO (SUB4)             TO EC-COMM-PR (SUB3).
 18982     MOVE EW-ECR-ST (SUB4)              TO EC-COMM-ST (SUB3).
 18983     MOVE EW-ECR-R78-ADJ (SUB4)         TO EC-COMM-78-ADJ (SUB3).
 18984     MOVE EW-ECR-PRO-ADJ (SUB4)         TO EC-COMM-PR-ADJ (SUB3).
 18985
 18986     ADD +1 TO SUB3 SUB4 LEVELS-BUILT.
 18987
 18988     GO TO 4530-BUILD-EPEC-LOAD-COMM-LOOP.
 18989
 18990 4539-BUILD-EPEC-LOAD-COMM-X.
 18991     EXIT.
 18992
 18993 4540-BUILD-EPEC-CLEAR.
 18994
 18995     MOVE ZEROS                         TO EC-AGT-NO (SUB3).
 18996     MOVE SPACE                         TO EC-AGT-TYPE (SUB3).
 18997     MOVE ZEROS                         TO EC-ISS-COMM (SUB3)
 18998                                           EC-CNC-COMM (SUB3)
 18999                                           EC-COMM-78 (SUB3)
 19000                                           EC-COMM-PR (SUB3)
 19001                                           EC-COMM-ST (SUB3)
 19002                                           EC-COMM-78-ADJ (SUB3)
 19003                                           EC-COMM-PR-ADJ (SUB3).
 19004
 19005 4540-BUILD-CLEAR-X.
 19006     EXIT.
 19007
 19008 4541-CALC-IBNR.
 19009
 19010     MOVE +0                    TO TOT-AH-IBNR
 19011                                   TOT-AH-PRM
 19012                                   TOT-AH-PD-CLMS
 19013                                   TOT-AH-CLMRSV
 19014                                   TOT-LF-IBNR
 19015                                   TOT-LF-PRM
 19016                                   TOT-LF-PD-CLMS
 19017                                   TOT-LF-CLMRSV
 19018
 19019     MOVE +0                    TO RTOT-AH-IBNR
 19020                                   RTOT-AH-PRM
 19021                                   RTOT-AH-PD-CLMS
 19022                                   RTOT-AH-CLMRSV
 19023                                   RTOT-LF-IBNR
 19024                                   RTOT-LF-PRM
 19025                                   RTOT-LF-PD-CLMS
 19026                                   RTOT-LF-CLMRSV
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 363
* ECS010MO.cbl
 19027
 19028     PERFORM VARYING SUB2 FROM +1 BY +1 UNTIL
 19029        (SUB2 > +900)
 19030        OR (EPEC-REIN-CO (SUB2) = ZEROS)
 19031*       IF W-UNDERWRITTEN-DATA
 19032*          MOVE EPEC-LEVELS-II (SUB2)
 19033*                                TO EPEC-WORK
 19034*       ELSE
 19035           MOVE EPEC-LEVELS (SUB2)
 19036                                 TO EPEC-WORK
 19037*       END-IF
 19038        IF EW-REIN-CO = SPACES
 19039           IF EW-LF-AH = 'L'
 19040              COMPUTE TOT-LF-PRM = TOT-LF-PRM
 19041                 + EW-EPR-ST
 19042              COMPUTE TOT-LF-PD-CLMS = TOT-LF-PD-CLMS
 19043                 + EW-CLM-AMT
 19044              COMPUTE TOT-LF-CLMRSV = TOT-LF-CLMRSV
 19045                 + EW-CLM-PAYCUR + EW-CLM-FUTRSV
 19046           ELSE
 19047              COMPUTE TOT-AH-PRM = TOT-AH-PRM
 19048                 + EW-EPR-ST
 19049              COMPUTE TOT-AH-PD-CLMS = TOT-AH-PD-CLMS
 19050                 + EW-CLM-AMT
 19051              COMPUTE TOT-AH-CLMRSV = TOT-AH-CLMRSV
 19052                 + EW-CLM-PAYCUR + EW-CLM-FUTRSV
 19053        ELSE
 19054           IF EW-LF-AH = 'L'
 19055              COMPUTE RTOT-LF-PRM = RTOT-LF-PRM
 19056                 + EW-EPR-ST
 19057              COMPUTE RTOT-LF-PD-CLMS = RTOT-LF-PD-CLMS
 19058                 + EW-CLM-AMT
 19059              COMPUTE RTOT-LF-CLMRSV = RTOT-LF-CLMRSV
 19060                 + EW-CLM-PAYCUR + EW-CLM-FUTRSV
 19061           ELSE
 19062              COMPUTE RTOT-AH-PRM = RTOT-AH-PRM
 19063                 + EW-EPR-ST
 19064              COMPUTE RTOT-AH-PD-CLMS = RTOT-AH-PD-CLMS
 19065                 + EW-CLM-AMT
 19066              COMPUTE RTOT-AH-CLMRSV = RTOT-AH-CLMRSV
 19067                 + EW-CLM-PAYCUR + EW-CLM-FUTRSV
 19068           END-IF
 19069        END-IF
 19070     END-PERFORM
 19071
 19072     COMPUTE TOT-AH-IBNR = (TOT-AH-PRM * .6)
 19073        - TOT-AH-PD-CLMS - TOT-AH-CLMRSV
 19074     IF TOT-AH-IBNR < ZEROS
 19075        COMPUTE TOT-AH-IBNR = TOT-AH-PRM * .15
 19076     END-IF
 19077     COMPUTE TOT-LF-IBNR = (TOT-LF-PRM * .6)
 19078        - TOT-LF-PD-CLMS - TOT-LF-CLMRSV
 19079     IF TOT-LF-IBNR < ZEROS
 19080        COMPUTE TOT-LF-IBNR = TOT-LF-PRM * .15
 19081     END-IF
 19082
 19083     COMPUTE RTOT-AH-IBNR = (RTOT-AH-PRM * .6)
 19084        - RTOT-AH-PD-CLMS - RTOT-AH-CLMRSV
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 364
* ECS010MO.cbl
 19085     IF RTOT-AH-IBNR < ZEROS
 19086        COMPUTE RTOT-AH-IBNR = RTOT-AH-PRM * .15
 19087     END-IF
 19088     COMPUTE RTOT-LF-IBNR = (RTOT-LF-PRM * .6)
 19089        - RTOT-LF-PD-CLMS - RTOT-LF-CLMRSV
 19090     IF RTOT-LF-IBNR < ZEROS
 19091        COMPUTE RTOT-LF-IBNR = RTOT-LF-PRM * .15
 19092     END-IF
 19093
 19094     PERFORM VARYING SUB2 FROM +1 BY +1 UNTIL
 19095        (SUB2 > +900)
 19096        OR (EPEC-REIN-CO (SUB2) = ZEROS)
 19097*       IF W-UNDERWRITTEN-DATA
 19098*          MOVE EPEC-LEVELS-II (SUB2)
 19099*                                TO EPEC-WORK
 19100*       ELSE
 19101           MOVE EPEC-LEVELS (SUB2)
 19102                                 TO EPEC-WORK
 19103*       END-IF
 19104        IF EW-REIN-CO = SPACES
 19105           IF EW-LF-AH = 'L'
 19106              COMPUTE IBNR-FACT ROUNDED = EW-EPR-ST
 19107                 / TOT-LF-PRM
 19108              COMPUTE EW-CLM-IBNR ROUNDED = IBNR-FACT
 19109                 * RTOT-LF-IBNR
 19110*                * TOT-LF-IBNR
 19111           ELSE
 19112              COMPUTE IBNR-FACT ROUNDED = EW-EPR-ST
 19113                 / TOT-AH-PRM
 19114              COMPUTE EW-CLM-IBNR ROUNDED = IBNR-FACT
 19115                 * RTOT-AH-IBNR
 19116*                * TOT-AH-IBNR
 19117           END-IF
 19118        ELSE
 19119           IF EW-LF-AH = 'L'
 19120              COMPUTE IBNR-FACT ROUNDED = EW-EPR-ST
 19121                 / RTOT-LF-PRM
 19122              COMPUTE EW-CLM-IBNR ROUNDED = IBNR-FACT
 19123                 * RTOT-LF-IBNR
 19124           ELSE
 19125              COMPUTE IBNR-FACT ROUNDED = EW-EPR-ST
 19126                 / RTOT-AH-PRM
 19127              COMPUTE EW-CLM-IBNR ROUNDED = IBNR-FACT
 19128                 * RTOT-AH-IBNR
 19129           END-IF
 19130        END-IF
 19131*       IF W-UNDERWRITTEN-DATA
 19132*          MOVE EPEC-WORK        TO EPEC-LEVELS-II (SUB2)
 19133*       ELSE
 19134           MOVE EPEC-WORK        TO EPEC-LEVELS (SUB2)
 19135*       END-IF
 19136     END-PERFORM
 19137
 19138     .
 19139 4541-EXIT.
 19140     EXIT.
 19141
 19142 4545-BUILD-BASE.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 365
* ECS010MO.cbl
 19143
 19144     MOVE 'EC'                   TO EC-RECORD-ID.
 19145     MOVE DTE-CLASIC-COMPANY-CD  TO EP-COMPANY-CD.
 19146     MOVE AM-MSTR-CNTRL          TO EC-CONTROL.
 19147     MOVE AM-EXPIRE-DT           TO WS-EC-EXP-DTE-N.
 19148     MOVE AM-EFFECT-DT           TO EC-EFF-DTE
 19149                                    WS-EC-EFF-DTE.
 19150     MOVE EW-REIN-CO             TO EC-REI-CO.
 19151     IF EC-REI-CO NOT = SPACES
 19152         MOVE 'R'                TO EC-REIN.
 19153     MOVE EW-LF-AH               TO EC-RCD-TYPE.
 19154     MOVE EW-BEN-TYPE            TO EC-BEN-CODE.
 19155     IF DTE-PGM-OPT = '3'
 19156         MOVE 'P'                TO EC-PURGE.
 19157     MOVE WS-SEQ-NBR             TO EC-SEQ-NBR.
 19158
 19159 4545-BUILD-BASE-X.
 19160     EXIT.
 19161
 19162******************************************************************
 19163***        CLEAR EARNED PREMIUM  AND  REINSURANCE TOTALS       ***
 19164******************************************************************
 19165
 19166 4550-CLEAR-EPEC-TOTALS.
 19167
 19168     MOVE LOW-CERT             TO SV-LO-CERT.
 19169     MOVE HIGH-CERT            TO SV-HI-CERT.
 19170     MOVE SPACES               TO LOW-CTL.
 19171     MOVE ZEROS                TO LOW-CERT  HIGH-CERT.
 19172
 19173     MOVE +1                   TO SUB9.
 19174     MOVE +0                   TO SUB10.
 19175     MOVE ZERO                 TO EW-REIN-CO
 19176                                  EW-BEN-TYPE.
 19177     MOVE SPACE                TO EP-FLG
 19178                                  EW-LF-AH
 19179                                  EW-LEVEL-USED
 19180                                  W-TABLE-USED-SW.
 19181
 19182     MOVE +0                   TO EW-ISS-BEN     EW-ISS-BEN-GROSS
 19183                                  EW-CNC-BEN     EW-CNC-BEN-GROSS
 19184                                  EW-ISS-PRM     EW-ISS-PRM-GROSS
 19185                                  EW-CNC-PRM     EW-CNC-PRM-GROSS
 19186                                  EW-EPR-R78     EW-EPR-R78-ADJ
 19187                                  EW-EPR-PRO     EW-EPR-PRO-ADJ
 19188                                  EW-EPR-ST      EW-EPR-ST-ADJ
 19189                                  EW-CLM-AMT     EW-COV-DTE
 19190                                  EW-CLM-IBNR    EW-CLM-PAYCUR
 19191                                  EW-CLM-FUTRSV  EW-CLM-CNT
 19192                                  EW-CLM-CRT     EW-ISS-CNT
 19193                                  EW-CNC-CNT     EW-AGE
 19194                                  EW-ORIG-TERM   EW-INFORCE-CNT
 19195                                  EW-AGE-BEN     EW-TERM-BEN
 19196                                  EW-ISS-PRM-TAX
 19197                                  EW-REM-TERM.
 19198
 19199     MOVE +1 TO SUB1.
 19200     PERFORM 4555-CLEAR-EPEC-COMM WS-LOOP-MAX TIMES.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 366
* ECS010MO.cbl
 19201     PERFORM 4560-CLEAR-EPEC-ALL VARYING SUB1 FROM +1 BY +1
 19202         UNTIL EPEC-REIN-CO (SUB1) = ZEROS.
 19203     MOVE EPEC-OPT-WORK-TABLE    TO EPEC-OPT-DATA-TABLE
 19204                                    EPEC-UNDW-OPT-DATA-TABLE.
 19205     PERFORM 4570-CLEAR-EPEC-SUB-A VARYING SUB1 FROM +1 BY +1
 19206         UNTIL EPEC-SUB-REIN (SUB1) = ZEROS.
 19207
 19208     PERFORM 4590-INIT-OB THRU 4590-EXIT
 19209         VARYING SUB3 FROM +1 BY +1
 19210*        UNTIL SUB3 GREATER THAN +300.
 19211*        UNTIL SUB3 GREATER THAN +220.
 19212         UNTIL SUB3 GREATER THAN +900.
 19213
 19214     GO TO 4589-CLEAR-EPEC-TOTALS-X.
 19215
 19216 4555-CLEAR-EPEC-COMM.
 19217
 19218     MOVE +0 TO EW-ISS-COM (SUB1)  EW-CNC-COM (SUB1)
 19219                EW-ECR-R78 (SUB1)  EW-ECR-R78-ADJ (SUB1)
 19220                EW-ECR-PRO (SUB1)  EW-ECR-PRO-ADJ (SUB1)
 19221                EW-ECR-ST  (SUB1).
 19222     MOVE SPACES                 TO EW-AGT-NO (SUB1)
 19223                                    EW-AGT-TYPE (SUB1).
 19224
 19225     ADD +1 TO SUB1.
 19226
 19227 4560-CLEAR-EPEC-ALL.
 19228
 19229     MOVE EPEC-WORK              TO EPEC-LEVELS (SUB1)
 19230                                    EPEC-LEVELS-II (SUB1).
 19231     MOVE W-LIFE-YEARS-ZERO      TO EPEC-OPT-GRP (SUB1).
 19232
 19233 4570-CLEAR-EPEC-SUB-A.
 19234
 19235     MOVE ZEROS TO EPEC-SUB-REIN (SUB1).
 19236     PERFORM 4580-CLEAR-EPEC-SUB-B VARYING SUB2 FROM +1 BY +1
 19237*        UNTIL SUB2 GREATER +300.
 19238         UNTIL SUB2 GREATER +900.
 19239
 19240 4580-CLEAR-EPEC-SUB-B.
 19241
 19242     MOVE ZEROS TO EPEC-SUB-LF (SUB1 SUB2).
 19243     MOVE ZEROS TO EPEC-SUB-AH (SUB1 SUB2).
 19244
 19245 4589-CLEAR-EPEC-TOTALS-X.
 19246     EXIT.
 19247
 19248 4590-INIT-OB.
 19249
 19250     MOVE +0 TO WS-EPR-R78 (SUB3 1).
 19251     MOVE +0 TO WS-EPR-R78 (SUB3 2).
 19252     MOVE +0 TO WS-EPR-R78 (SUB3 3).
 19253
 19254 4590-EXIT.
 19255     EXIT.
 19256
 19257 4599-BUILD-EPEC-EXTRACT-X.
 19258     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 367
* ECS010MO.cbl
 19259
 19260*********************************************************
 19261*  THIS ROUTINE IS USED TO CALCULATE THE A&H IBNR       *
 19262*  RESERVES USING A PERCENTAGE OF THE UNEARNED PREMIUM. *
 19263*  THESE PERCENTAGES ARE ENTERED THROUGH SCREEN EL105A  *
 19264*  (CARRIER CONTROLS) AND PASSED THROUGHOUT THE SYSTEM  *
 19265*  IN THE DATE CARD.                                    *
 19266*  'CARRIER-UEP-PCT' IS THE ACTUAL PERCENT PER CARRIER. *
 19267*********************************************************
 19268
 19269 4599A-CALC-IBNR.
 19270
 19271     COMPUTE EW-CLM-IBNR =  ((EP-ISS-PRM - EP-CNC-PRM) -
 19272        (((EP-PRM-78 + EP-PRM-78-ADJ)
 19273                              * CARRIER-R78-PCT (CLAS-INDEXCN)) +
 19274         ((EP-PRM-PR + EP-PRM-PR-ADJ)
 19275                              * CARRIER-PRO-PCT (CLAS-INDEXCN))))
 19276                         * CARRIER-UEP-PCT (CLAS-INDEXCN).
 19277
 19278     IF EW-CLM-IBNR NOT GREATER THAN ZEROS
 19279         MOVE ZEROS                 TO EW-CLM-IBNR
 19280         GO TO 4599A-CALC-EXIT.
 19281
 19282     IF EP-REIN = 'R'
 19283         MOVE 'Y'                   TO W-REIN-PROCESS-IND.
 19284
 19285     PERFORM 4740-CREATE-DETAIL-EXTR THRU 4740-EXIT.
 19286
 19287 4599A-CALC-EXIT.
 19288      EXIT.
 19289 4599B-SEARCH.
 19290      EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 368
* ECS010MO.cbl
 19292******************************************************************
 19293***         CALCULATE OPTIONAL METHOD I B N R                  ***
 19294******************************************************************
 19295
 19296 4600-GET-OPT-IBNR.
 19297
 19298     IF  CR-POLICY-IS-ACTIVE
 19299         IF  CR-POLICY-IS-REISSUE
 19300             OR CR-POLICY-IS-MONTHLY
 19301             IF  W-LIFE
 19302                 GO TO 4600-EXIT
 19303             ELSE
 19304                 NEXT SENTENCE
 19305         ELSE
 19306             NEXT SENTENCE
 19307     ELSE
 19308         IF  W-LIFE
 19309             GO TO 4600-EXIT.
 19310
 19311     IF  W-LIFE
 19312         PERFORM 4620-DETERMINE-LIFE-IBNR THRU 4620-EXIT
 19313     ELSE
 19314         PERFORM 4640-GET-A-H-EARNED-PREMIUM THRU 4640-EXIT.
 19315
 19316 4600-EXIT.
 19317     EXIT.
 19318
 19319 4620-DETERMINE-LIFE-IBNR.
 19320
 19321     IF  CR-LF-POLICY-IS-ACTIVE
 19322         ADD +1                  TO W-LF-ACTIVE
 19323         IF  CR-LF-POLICY-IS-REISSUE
 19324             OR CR-LF-POLICY-IS-MONTHLY
 19325             MOVE ZEROS          TO W-WK-IBNR
 19326             ADD +1              TO W-LF-REISSUE
 19327             GO TO 4620-EXIT
 19328         ELSE
 19329             NEXT SENTENCE
 19330     ELSE
 19331         ADD +1                  TO W-LF-INACTIVE
 19332         MOVE ZEROS              TO W-WK-IBNR
 19333         GO TO 4620-EXIT.
 19334
 19335     IF  CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'B'
 19336         MOVE ZEROS              TO W-WK-IBNR
 19337         ADD +1                  TO W-LF-CALC-B
 19338         GO TO 4620-EXIT.
 19339
 19340     IF  (CLAS-I-EP (CLAS-INDEXL) = 'B'
 19341                 AND
 19342             CLAS-I-CALC-TYPE (CLAS-INDEXL) NOT = 'L'
 19343                 AND
 19344             W-BAL-REMTRM NOT GREATER THAN ZERO)
 19345             OR
 19346         (CLAS-I-EP (CLAS-INDEXL) = 'B'
 19347                 AND
 19348             CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'L'
 19349                 AND
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 369
* ECS010MO.cbl
 19350             REM-TRM2 NOT GREATER THAN ZERO)
 19351         MOVE ZEROS              TO W-WK-IBNR
 19352         ADD +1                  TO W-LF-BALLOON
 19353         GO TO 4620-EXIT
 19354     ELSE
 19355         IF  (CLAS-I-EP (CLAS-INDEXL) NOT = 'B'
 19356                 AND
 19357             REM-TRM2 NOT GREATER THAN ZERO)
 19358             ADD +1              TO W-LF-REMTERM-0
 19359             MOVE ZEROS          TO W-WK-IBNR
 19360             GO TO 4620-EXIT.
 19361
 19362     PERFORM 4680-CALC-REMAINING-AMT-LF THRU 4680-EXIT.
 19363
 19364     IF  CP-REMAINING-AMT NOT GREATER THAN ZEROS
 19365         ADD +1                  TO W-LF-REMAMT-0
 19366         MOVE ZEROS              TO W-WK-IBNR
 19367         GO TO 4620-EXIT.
 19368
 19369     IF  AM-LIFE-IBNR-PCT NUMERIC
 19370             AND
 19371         AM-LIFE-IBNR-PCT GREATER THAN ZEROS
 19372         COMPUTE W-WK-IBNR ROUNDED
 19373             = CP-REMAINING-AMT
 19374             / 1000
 19375             * AM-LIFE-IBNR-PCT
 19376     ELSE
 19377         COMPUTE W-WK-IBNR ROUNDED
 19378             = CP-REMAINING-AMT
 19379             / 1000
 19380             * COMPANY-IBNR-LIFE-FACTOR.
 19381
 19382     IF  CR-LF-IS-REIN-ONLY
 19383         ADD +1                  TO W-LF-REIN
 19384     ELSE
 19385         ADD +1                  TO W-LF-DATA-USED
 19386         ADD W-WK-IBNR           TO W-LIFE-IBNR-IN
 19387         ADD CP-REMAINING-AMT    TO W-LIFE-REMAINING-AMT
 19388         IF  CR-LFTYP = '01'
 19389             ADD CP-REMAINING-AMT
 19390                                 TO W-01-REMAMT
 19391             ADD +1              TO W-01-DATA-USED
 19392         ELSE
 19393         IF  CR-LFTYP = '02'
 19394             ADD CP-REMAINING-AMT
 19395                                 TO W-02-REMAMT
 19396             ADD +1              TO W-02-DATA-USED
 19397         ELSE
 19398         IF  CR-LFTYP = '03'
 19399             ADD CP-REMAINING-AMT
 19400                                 TO W-03-REMAMT
 19401             ADD +1              TO W-03-DATA-USED
 19402         ELSE
 19403         IF  CR-LFTYP = '04'
 19404             ADD CP-REMAINING-AMT
 19405                                 TO W-04-REMAMT
 19406             ADD +1              TO W-04-DATA-USED
 19407         ELSE
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 370
* ECS010MO.cbl
 19408         IF  CR-LFTYP = '05'
 19409             ADD CP-REMAINING-AMT
 19410                                 TO W-05-REMAMT
 19411             ADD +1              TO W-05-DATA-USED
 19412         ELSE
 19413         IF  CR-LFTYP = '06'
 19414             ADD CP-REMAINING-AMT
 19415                                 TO W-06-REMAMT
 19416             ADD +1              TO W-06-DATA-USED
 19417         ELSE
 19418         IF  CR-LFTYP = '30'
 19419             ADD CP-REMAINING-AMT
 19420                                 TO W-30-REMAMT
 19421             ADD +1              TO W-30-DATA-USED
 19422         ELSE
 19423         IF  CR-LFTYP = '31'
 19424             ADD CP-REMAINING-AMT
 19425                                 TO W-31-REMAMT
 19426             ADD +1              TO W-31-DATA-USED
 19427         ELSE
 19428             ADD CP-REMAINING-AMT
 19429                                 TO W-XX-REMAMT
 19430             ADD +1              TO W-XX-DATA-USED.
 19431
 19432     IF  CR-POLICY-IS-REIN-ONLY
 19433             OR
 19434         CR-LF-IS-REIN-ONLY
 19435         ADD ISS-BEN             TO EPEC-REIN-ISS-BEN (SUB3)
 19436         MOVE 'R'                TO EPEC-REIN-ONLY-IND (SUB3)
 19437         ADD W-WK-IBNR           TO EPEC-LIFE-IBNR (SUB3)
 19438     ELSE
 19439         ADD W-WK-IBNR           TO EPEC-LIFE-IBNR (SUB3).
 19440
 19441 4620-EXIT.
 19442     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 371
* ECS010MO.cbl
 19444 4640-GET-A-H-EARNED-PREMIUM.
 19445
 19446     IF  CR-AH-POLICY-IS-ACTIVE
 19447         ADD +1                  TO W-AH-ACTIVE
 19448         IF  CR-AH-POLICY-IS-REISSUE
 19449             OR CR-AH-POLICY-IS-MONTHLY
 19450             ADD +1              TO W-AH-REISSUE
 19451         ELSE
 19452             NEXT SENTENCE
 19453     ELSE
 19454         ADD +1                  TO W-AH-INACTIVE.
 19455
 19456     IF  CLAS-I-CALC-TYPE (CLAS-INDEXA) = 'B'
 19457         ADD +1                  TO W-AH-CALC-B
 19458         GO TO 4640-EXIT.
 19459
 19460     IF  REM-TRM2 NOT GREATER THAN ZEROS
 19461         MOVE 'Y'                TO W-RTRM-0-SW
 19462     ELSE
 19463         MOVE SPACES             TO W-RTRM-0-SW.
 19464
 19465     PERFORM 4660-DETERMINE-EARNED-PREMIUM THRU 4660-EXIT.
 19466
 19467****** NOTE:  THERE IS AN ASSUMPTION THAT STATISTICALLY ONLY ONE
 19468******        ACTUALLY CLAIM PER 90 DAY PERIOD AND THAT THE CLAIM
 19469******        ITD FIELD (CR-DISAMT) CONTAINS ONLY THE AMOUNT OF
 19470******        THAT CLAIM.
 19471
 19472     PERFORM 4650-DETERMINE-CLM-AMT-AH THRU 4650-EXIT.
 19473
 19474     IF  CR-POLICY-IS-REIN-ONLY
 19475              OR
 19476         CR-AH-IS-REIN-ONLY
 19477         ADD +1                  TO W-AH-REIN
 19478         ADD ISS-BEN             TO EPEC-REIN-ISS-BEN (SUB3)
 19479         MOVE 'R'                TO EPEC-REIN-ONLY-IND (SUB3)
 19480         ADD W-CLMAMT            TO EPEC-CLAIMS-MADE-PAID (SUB3)
 19481         ADD W-EARNED-PREMIUM    TO EPEC-EARNED-PREMIUM-AH (SUB3)
 19482         GO TO 4640-EXIT.
 19483
 19484     ADD W-EARNED-PREMIUM        TO EPEC-EARNED-PREMIUM-AH (SUB3)
 19485                                    W-EPEC-EP-IN.
 19486     ADD W-CLMAMT                TO EPEC-CLAIMS-MADE-PAID (SUB3)
 19487                                    W-CLAIMS-MADE-PAID-IN.
 19488     ADD +1                      TO W-AH-DATA-USED.
 19489     ADD W-EARNED-PREMIUM-1      TO W-EPEC-EP-1.
 19490     ADD W-EARNED-PREMIUM-2      TO W-EPEC-EP-2.
 19491
 19492     IF  W-CLMAMT GREATER THAN ZEROS
 19493         ADD +1                  TO W-AH-CLAIM-CTR
 19494         ADD W-EARNED-PREMIUM    TO W-AH-CLAIM-EP.
 19495
 19496     IF  W-RTRM-0
 19497             AND
 19498         NOT CR-POLICY-IS-REIN-ONLY
 19499             AND
 19500         NOT CR-AH-IS-REIN-ONLY
 19501         ADD W-CLMAMT            TO W-RTRM-0-CLMAMT
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 372
* ECS010MO.cbl
 19502         ADD W-EARNED-PREMIUM-1  TO W-RTRM-EP-1
 19503         ADD W-EARNED-PREMIUM-2  TO W-RTRM-EP-2
 19504         ADD W-EARNED-PREMIUM    TO W-RTRM-EP
 19505         ADD +1                  TO W-AH-REMTERM-0.
 19506
 19507 4640-EXIT.
 19508     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 373
* ECS010MO.cbl
 19510 4650-DETERMINE-CLM-AMT-AH.
 19511
 19512     MOVE ZEROS                  TO W-CLMAMT.
 19513
 19514     IF  CR-DIS-DT NOT GREATER THAN ZEROS
 19515             OR
 19516         CR-DIS-DT NOT GREATER THAN W-CUTOFF-DATE
 19517         GO TO 4650-EXIT.
 19518
 19519     IF  CR-DIS-PTO-DT GREATER THAN ZEROS
 19520             AND
 19521         CR-DIS-PTO-DT GREATER THAN CR-DIS-DT
 19522         MOVE CR-DIS-DT              TO DC-GREG-DATE-CYMD
 19523         MOVE 'L'                    TO DC-OPTION-CODE
 19524         PERFORM 8000-DATE-CONVERT-ROUTINE
 19525             THRU 8099-DATE-CONVERT-X
 19526         MOVE DC-BIN-DATE-1          TO W-DIS-DT
 19527         MOVE CR-DIS-PTO-DT          TO DC-GREG-DATE-CYMD
 19528         MOVE 'L'                    TO DC-OPTION-CODE
 19529         PERFORM 8000-DATE-CONVERT-ROUTINE
 19530             THRU 8099-DATE-CONVERT-X
 19531         MOVE DC-BIN-DATE-1          TO W-DIS-PTO-DT
 19532         IF  DATE-CONVERSION-ERROR
 19533             DISPLAY 'CERT DATES ERROR' CR-FULL-CONTROL
 19534             MOVE 'CERT DATES ERROR' TO WS-ABEND-MESSAGE
 19535             MOVE DC-ERROR-CODE      TO WS-ABEND-FILE-STATUS
 19536             MOVE 0303               TO WS-ABEND-CODE
 19537             MOVE WS-ABEND-CODE      TO WS-RETURN-CODE
 19538             GO TO ABEND-PGM
 19539         ELSE
 19540             MOVE W-DIS-DT           TO DC-BIN-DATE-1
 19541             MOVE W-DIS-PTO-DT       TO DC-BIN-DATE-2
 19542             MOVE '1'                TO DC-OPTION-CODE
 19543             MOVE ZEROS              TO DC-ELAPSED-MONTHS
 19544                                        DC-ELAPSED-DAYS
 19545             PERFORM 8000-DATE-CONVERT-ROUTINE
 19546                 THRU 8099-DATE-CONVERT-X
 19547             IF  DATE-CONVERSION-ERROR
 19548                 DISPLAY 'DIS TO PTO DATE ERROR '
 19549                     CR-FULL-CONTROL
 19550                 MOVE 'DIS TO PTO DATE ERROR '
 19551                                     TO WS-ABEND-MESSAGE
 19552                 MOVE DC-ERROR-CODE  TO WS-ABEND-FILE-STATUS
 19553                 MOVE 0303           TO WS-ABEND-CODE
 19554                 MOVE WS-ABEND-CODE  TO WS-RETURN-CODE
 19555                 GO TO ABEND-PGM
 19556             ELSE
 19557                 COMPUTE W-CLMAMT ROUNDED
 19558                     = CR-AHAMT
 19559                     * (DC-ELAPSED-DAYS / 30)
 19560                 GO TO 4650-EXIT.
 19561
 19562     IF  CR-DIS-PAY-DT NOT GREATER THAN ZEROS
 19563             OR
 19564         CR-DIS-PAY-DT LESS THAN CR-DIS-DT
 19565         GO TO 4650-EXIT.
 19566
 19567     COMPUTE W-90-DAY-MAX ROUNDED
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 374
* ECS010MO.cbl
 19568         = CR-AHAMT * 3.
 19569
 19570     IF  CR-DISAMT NOT GREATER THAN W-90-DAY-MAX
 19571         MOVE CR-DISAMT          TO W-CLMAMT
 19572     ELSE
 19573         MOVE W-90-DAY-MAX       TO W-CLMAMT.
 19574
 19575     IF  NOT CR-POLICY-IS-REIN-ONLY
 19576              AND
 19577         NOT CR-AH-IS-REIN-ONLY
 19578         ADD +1          TO W-CLM-EXCEPT-CNT
 19579         ADD W-CLMAMT    TO W-CLM-EXCEPT-AMT.
 19580
 19581 4650-EXIT.
 19582     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 375
* ECS010MO.cbl
 19584 4660-DETERMINE-EARNED-PREMIUM.
 19585
 19586     MOVE ZEROS                  TO W-EARNED-PREMIUM.
 19587
 19588     PERFORM 4670-CALC-EP THRU 4670-EXIT.
 19589
 19590     MOVE W-EARNED-PREMIUM       TO W-EARNED-PREMIUM-1.
 19591
 19592     IF  CR-ENTRY-DATE NOT GREATER THAN W-CUTOFF-DATE
 19593         MOVE ZEROS              TO W-EARNED-PREMIUM
 19594         MOVE W-CUTOFF-DATE      TO VALUATION-DT
 19595         MOVE '7'                TO W-VAL-SOURCE
 19596         PERFORM 8500-REMAINING-TERM-ROUTINE
 19597             THRU 8599-REM-TERM-X
 19598         PERFORM 4666-SAVE-AHCR-DATA THRU 4666-EXIT
 19599         PERFORM 4800-CALC-EARNED-PREMIUM-AH THRU 4899-EXIT
 19600         PERFORM 4668-RESTORE-AHCR-DATA THRU 4668-EXIT
 19601         MOVE EPR-R78            TO W-OPT-R78
 19602         MOVE EPR-PRO            TO W-OPT-PRO
 19603         MOVE EPR-ST             TO W-OPT-ST
 19604         PERFORM 4670-CALC-EP THRU 4670-EXIT
 19605         MOVE W-EARNED-PREMIUM   TO W-EARNED-PREMIUM-2
 19606     ELSE
 19607         MOVE ZEROS              TO W-EARNED-PREMIUM-2.
 19608
 19609     COMPUTE W-EARNED-PREMIUM ROUNDED
 19610         = W-EARNED-PREMIUM-1 - W-EARNED-PREMIUM-2.
 19611
 19612     IF  W-EARNED-PREMIUM LESS THAN ZERO
 19613         ADD +1                  TO W-EP-LESS-THAN-0
 19614         MOVE ZERO               TO W-EARNED-PREMIUM.
 19615
 19616 4660-EXIT.
 19617     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 376
* ECS010MO.cbl
 19619 4666-SAVE-AHCR-DATA.
 19620
 19621     MOVE SPACES                 TO WX-STATUS-AT-CANCEL
 19622                                    WX-STATUS-AT-SETTLEMENT.
 19623
 19624     MOVE ZEROS                  TO WX-CANC-DT
 19625                                    WX-EOM-RUN-DATE
 19626                                    WX-SETTLEMENT-EXIT-DATE.
 19627
 19628     IF  CR-AH-CANC-DT GREATER THAN W-CUTOFF-DATE
 19629         MOVE CR-AH-CANC-DT      TO WX-CANC-DT
 19630         MOVE CR-AH-STATUS-AT-CANCEL
 19631                                 TO WX-STATUS-AT-CANCEL
 19632         MOVE ZEROS              TO CR-AH-CANC-DT
 19633                                    WS-CR-AH-CANC-DT-N
 19634         MOVE SPACES             TO CR-AH-STATUS-AT-CANCEL.
 19635
 19636     IF  CR-AH-SETTLEMENT-EXIT-DATE GREATER THAN W-CUTOFF-DATE
 19637         MOVE CR-AH-SETTLEMENT-EXIT-DATE
 19638                                 TO WX-SETTLEMENT-EXIT-DATE
 19639         MOVE CR-AH-STATUS-AT-SETTLEMENT
 19640                                 TO WX-STATUS-AT-SETTLEMENT
 19641         MOVE ZEROS              TO CR-AH-SETTLEMENT-EXIT-DATE
 19642                                 WS-CR-AH-SETTLEMENT-EXIT-DATEN
 19643         MOVE SPACES             TO CR-AH-STATUS-AT-SETTLEMENT.
 19644
 19645     MOVE EOM-RUN-DATE           TO WX-EOM-RUN-DATE.
 19646     MOVE W-CUTOFF-DATE          TO EOM-RUN-DATE.
 19647
 19648 4666-EXIT.
 19649     EXIT.
 19650
 19651 4668-RESTORE-AHCR-DATA.
 19652
 19653     IF  WX-CANC-DT GREATER THAN W-CUTOFF-DATE
 19654         MOVE WX-CANC-DT         TO CR-AH-CANC-DT
 19655                                    WS-CR-AH-CANC-DT-N
 19656         MOVE WX-STATUS-AT-CANCEL
 19657                                 TO CR-AH-STATUS-AT-CANCEL.
 19658
 19659     IF  WX-SETTLEMENT-EXIT-DATE GREATER THAN W-CUTOFF-DATE
 19660         MOVE WX-SETTLEMENT-EXIT-DATE
 19661                                 TO CR-AH-SETTLEMENT-EXIT-DATE
 19662                                 WS-CR-AH-SETTLEMENT-EXIT-DATEN
 19663         MOVE WX-STATUS-AT-SETTLEMENT
 19664                                 TO CR-AH-STATUS-AT-SETTLEMENT.
 19665
 19666     MOVE WX-EOM-RUN-DATE        TO EOM-RUN-DATE.
 19667
 19668 4668-EXIT.
 19669     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 377
* ECS010MO.cbl
 19671 4670-CALC-EP.
 19672
 19673     IF  STATE-ABBR (CLAS-INDEXS) = 'WY'
 19674         MOVE W-OPT-PRO          TO W-EARNED-PREMIUM
 19675         ADD W-EARNED-PREMIUM    TO W-WY-EP
 19676         GO TO 4670-EXIT.
 19677
 19678     IF  STATE-ABBR (CLAS-INDEXS) = 'VA'
 19679         MOVE W-OPT-ST           TO W-EARNED-PREMIUM
 19680         ADD W-EARNED-PREMIUM    TO W-VA-EP
 19681         GO TO 4670-EXIT.
 19682
 19683***** NOTE THIS ASSUMES THAT ONLY A&H COVERAGES ARE PROCESSED HERE
 19684
 19685     IF  CLAS-I-EP (CLAS-INDEXA) = 'M'
 19686         COMPUTE W-EARNED-PREMIUM
 19687             = (W-OPT-PRO + W-OPT-R78) / +2
 19688         ADD W-EARNED-PREMIUM    TO W-M-EP
 19689     ELSE
 19690         IF  CLAS-I-EP (CLAS-INDEXA) = 'R'
 19691             MOVE W-OPT-R78      TO W-EARNED-PREMIUM
 19692             ADD W-EARNED-PREMIUM
 19693                                 TO W-R-EP
 19694         ELSE
 19695             IF  CLAS-I-EP (CLAS-INDEXA) = 'P'
 19696                 MOVE W-OPT-PRO  TO W-EARNED-PREMIUM
 19697                 ADD W-EARNED-PREMIUM
 19698                                 TO W-P-EP
 19699             ELSE
 19700                 IF  CLAS-I-EP (CLAS-INDEXA) = '1'
 19701                     COMPUTE W-EARNED-PREMIUM ROUNDED
 19702                         = (W-OPT-PRO * +.6667)
 19703                         + (W-OPT-R78 * +.3333)
 19704                     ADD W-EARNED-PREMIUM
 19705                                 TO W-1-EP
 19706                 ELSE
 19707                     ADD +1      TO W-OTHERS-COUNT
 19708                     MOVE ZEROS  TO W-EARNED-PREMIUM.
 19709
 19710 4670-EXIT.
 19711     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 378
* ECS010MO.cbl
 19713 4680-CALC-REMAINING-AMT-LF.
 19714
 19715     MOVE LOW-VALUES             TO CP-INSURED-BIRTH-DT.
 19716     MOVE CR-AGE                 TO CP-ISSUE-AGE.
 19717     MOVE CR-APR                 TO CP-LOAN-APR.
 19718     MOVE CR-LOAN-TERM           TO CP-LOAN-TERM.
 19719
 19720     IF  CR-PMT-FREQ NOT GREATER THAN ZERO
 19721         MOVE +1                 TO CR-PMT-FREQ.
 19722
 19723     MOVE CR-PMT-FREQ            TO CP-PAY-FREQUENCY.
 19724
 19725     MOVE REM-TRM2               TO CP-REMAINING-TERM.
 19726     MOVE CR-LFAMT               TO CP-ORIGINAL-BENEFIT
 19727                                    CP-RATING-BENEFIT-AMT.
 19728     IF CP-STATE-STD-ABBRV = 'OR'
 19729         COMPUTE CP-RATING-BENEFIT-AMT = CR-LFAMT + CR-LFAMT-ALT.
 19730     MOVE CR-LFAMT-ALT           TO CP-ALTERNATE-BENEFIT.
 19731     MOVE CR-LFPRM               TO CP-ORIGINAL-PREMIUM.
 19732     MOVE ZEROS                  TO CP-REMAINING-AMT
 19733                                    CP-REMAINING-AMT-PRV
 19734                                    CP-RETURN-CODE
 19735                                    CP-RETURN-CODE-2.
 19736
 19737
 19738     CALL 'ELRAMTX' USING CALCULATION-PASS-AREA
 19739
 19740     IF  CP-RETURN-CODE NOT = ZERO
 19741         MOVE 'ERROR OCCURED REMAINING AMT CALCULATIONS'
 19742                             TO WS-ABEND-MESSAGE
 19743         MOVE CP-RETURN-CODE TO WS-ABEND-FILE-STATUS
 19744         MOVE 2001           TO WS-ABEND-CODE
 19745         GO TO ABEND-PGM.
 19746
 19747 4680-EXIT.
 19748     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 379
* ECS010MO.cbl
 19750******************************************************************
 19751***  BUILDS ACCOUNT LEVEL IBNR (DIRECT AND REIN)               ***
 19752******************************************************************
 19753
 19754 4700-CALC-OPT-IBNR.
 19755
 19756     MOVE EPEC-OPT-DATA-TABLE    TO EPEC-OPT-WORK-TABLE.
 19757     MOVE SPACE                  TO W-UNDERWRITING-SW.
 19758
 19759     PERFORM 4710-PROCESS-THRU-EPEC-TABLE THRU 4710-EXIT
 19760             VARYING
 19761         SUB2 FROM +1 BY +1
 19762             UNTIL
 19763*        SUB2 GREATER THAN 300.
 19764*        SUB2 GREATER THAN 220.
 19765         SUB2 GREATER THAN 900.
 19766
 19767     MOVE EPEC-UNDW-OPT-DATA-TABLE
 19768                                 TO EPEC-OPT-WORK-TABLE.
 19769     MOVE '*'                    TO W-UNDERWRITING-SW.
 19770
 19771     PERFORM 4710-PROCESS-THRU-EPEC-TABLE THRU 4710-EXIT
 19772             VARYING
 19773         SUB2 FROM +1 BY +1
 19774             UNTIL
 19775*        SUB2 GREATER THAN 300.
 19776*        SUB2 GREATER THAN 220.
 19777         SUB2 GREATER THAN 900.
 19778
 19779 4700-EXIT.
 19780     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 380
* ECS010MO.cbl
 19782 4710-PROCESS-THRU-EPEC-TABLE.
 19783
 19784     IF  EPEC-REIN-CO-OPT (SUB2) = ZEROS
 19785         GO TO 4710-EXIT.
 19786
 19787     IF  W-UNDERWRITTEN-DATA
 19788         MOVE EPEC-LEVELS-II (SUB2)  TO EPEC-WORK
 19789     ELSE
 19790         MOVE EPEC-LEVELS (SUB2)     TO EPEC-WORK.
 19791
 19792     IF EW-LEVEL-USED NOT = 'Y'
 19793         GO TO 4710-EXIT.
 19794
 19795     IF  EW-REIN-CO GREATER THAN SPACES
 19796         MOVE 'Y'                TO W-REIN-PROCESS-SW
 19797         IF  EPEC-REIN-ONLY-DATA (SUB2)
 19798             PERFORM 4760-PROCESS-REIN-ONLY THRU 4760-EXIT
 19799             IF  W-WK-IBNR GREATER THAN ZEROS
 19800                 PERFORM 4770-CREATE-REIN-DETAIL THRU 4770-EXIT
 19801                 GO TO 4710-EXIT
 19802             ELSE
 19803                 GO TO 4710-EXIT
 19804         ELSE
 19805             IF  EW-CLM-IBNR GREATER THAN ZEROS
 19806                 PERFORM 4770-CREATE-REIN-DETAIL THRU 4770-EXIT
 19807                 GO TO 4710-EXIT
 19808             ELSE
 19809                 GO TO 4710-EXIT.
 19810
 19811     MOVE SPACES                 TO W-REIN-PROCESS-SW.
 19812
 19813     IF  EW-LF-AH EQUAL 'L'
 19814         IF  EPEC-LIFE-IBNR (SUB2) EQUAL ZEROS
 19815             GO TO 4710-EXIT
 19816         ELSE
 19817             PERFORM 4720-PROCESS-LIFE THRU 4720-EXIT
 19818             ADD W-WK-IBNR       TO W-LIFE-IBNR
 19819     ELSE
 19820         IF  EPEC-EARNED-PREMIUM-AH (SUB2)
 19821                 GREATER THAN ZEROS
 19822             PERFORM 4730-PROCESS-A-H THRU 4730-EXIT
 19823             ADD W-WK-IBNR       TO W-AH-IBNR
 19824         ELSE
 19825             GO TO 4710-EXIT.
 19826
 19827     MOVE W-WK-IBNR              TO EW-CLM-IBNR.
 19828     MOVE EW-ISS-BEN             TO W-ISS-BEN.
 19829     MOVE EW-ISS-BEN-GROSS       TO W-ISS-BEN-GROSS.
 19830
 19831     IF  W-UNDERWRITTEN-DATA
 19832         MOVE EPEC-WORK          TO EPEC-LEVELS-II (SUB2)
 19833     ELSE
 19834         MOVE EPEC-WORK          TO EPEC-LEVELS (SUB2).
 19835
 19836
 19837     PERFORM 4740-CREATE-DETAIL-EXTR THRU 4740-EXIT.
 19838     PERFORM 4750-UPDATE-REIN THRU 4750-EXIT.
 19839
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 381
* ECS010MO.cbl
 19840 4710-EXIT.
 19841     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 382
* ECS010MO.cbl
 19843 4720-PROCESS-LIFE.
 19844
 19845     MOVE EPEC-LIFE-IBNR (SUB2)  TO W-WK-IBNR.
 19846
 19847 4720-EXIT.
 19848     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 383
* ECS010MO.cbl
 19850 4730-PROCESS-A-H.
 19851
 19852     IF  AM-TARGET-LOSS-RATIO NUMERIC
 19853             AND
 19854         AM-TARGET-LOSS-RATIO NOT EQUAL ZERO
 19855         MOVE AM-TARGET-LOSS-RATIO
 19856                                 TO W-TARGET-LOSS-RATIO
 19857     ELSE
 19858         IF  CLAS-INDEXS NOT GREATER THAN CLAS-MAXS
 19859             MOVE STATE-TARGET-LOSS-RATIO (CLAS-INDEXS)
 19860                                 TO W-TARGET-LOSS-RATIO
 19861             PERFORM 4735-GET-BUSINESS-ADJUSTMENT THRU 4735-EXIT.
 19862
 19863     IF  W-NOT-REIN-PROCESS
 19864         ADD EPEC-EARNED-PREMIUM-AH (SUB2) TO W-EPEC-EP
 19865         ADD EPEC-CLAIMS-MADE-PAID (SUB2)  TO W-CLAIMS-MADE-PAID.
 19866
 19867     COMPUTE W-IBNR-1 ROUNDED
 19868         = EPEC-EARNED-PREMIUM-AH (SUB2)
 19869         * COMPANY-IBNR-AH-FACTOR
 19870         * W-TARGET-LOSS-RATIO.
 19871
 19872     COMPUTE W-IBNR-2 ROUNDED
 19873         = (EPEC-EARNED-PREMIUM-AH (SUB2)
 19874         * W-TARGET-LOSS-RATIO)
 19875         - EPEC-CLAIMS-MADE-PAID (SUB2).
 19876
 19877     IF  W-IBNR-1 GREATER THAN W-IBNR-2
 19878         MOVE W-IBNR-1           TO W-WK-IBNR
 19879         IF  W-NOT-REIN-PROCESS
 19880             ADD +1              TO W-AH-IBNR-1-CNT
 19881             ADD W-IBNR-1        TO W-AH-IBNR-1
 19882         ELSE
 19883             NEXT SENTENCE
 19884     ELSE
 19885         MOVE W-IBNR-2           TO W-WK-IBNR
 19886         IF  W-NOT-REIN-PROCESS
 19887             ADD +1              TO W-AH-IBNR-2-CNT
 19888             ADD W-IBNR-2        TO W-AH-IBNR-2.
 19889
 19890 4730-EXIT.
 19891     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 384
* ECS010MO.cbl
 19893 4735-GET-BUSINESS-ADJUSTMENT.
 19894
 19895     IF  CR-GRPTYP NOT NUMERIC
 19896         MOVE '99'               TO INDEXBS
 19897     ELSE
 19898         MOVE CR-GRPTYP          TO INDEXBS.
 19899
 19900     IF  BUS-TRGT-LOSS-RATIO-MOD (INDEXBS) NUMERIC
 19901             AND
 19902         BUS-TRGT-LOSS-RATIO-MOD (INDEXBS)
 19903             NOT EQUAL ZEROS
 19904             AND
 19905         BUS-TRGT-LOSS-RATIO-MOD (INDEXBS)
 19906             NOT EQUAL +1.0000
 19907         MOVE INDEXBS           TO W-EDIT-7
 19908         COMPUTE W-TARGET-LOSS-RATIO ROUNDED
 19909             = W-TARGET-LOSS-RATIO
 19910             * BUS-TRGT-LOSS-RATIO-MOD (INDEXBS).
 19911
 19912 4735-EXIT.
 19913     EXIT.
 19914
 19915 4740-CREATE-DETAIL-EXTR.
 19916
 19917     IF DTE-PGM-OPT NOT = '1'
 19918         GO TO 4740-EXIT.
 19919
 19920     IF  EW-CLM-IBNR NOT GREATER THAN ZEROS
 19921         GO TO 4740-EXIT.
 19922
 19923     MOVE EOM-RUN-DATE           TO INCURRED-DATE.
 19924     MOVE ZEROS                  TO REPORTED-DATE
 19925                                    PAY-TO-DATE.
 19926
 19927     MOVE SPACES                 TO TR-DTL2.
 19928     MOVE 'ACTBENIBNR'           TO TRD-CERT.
 19929
 19930     MOVE EOM-YR                 TO TRD-ISYR.
 19931     MOVE EOM-MO                 TO TRD-ISMO.
 19932     MOVE EOM-DA                 TO TRD-ISDA.
 19933     MOVE ZERO                   TO TRD-AGE.
 19934
 19935     IF  EW-LF-AH EQUAL 'L'
 19936         MOVE LIFE-OVERRIDE-L6   TO TRD-RSV-DESC
 19937     ELSE
 19938         MOVE AH-OVERRIDE-L6     TO TRD-RSV-DESC.
 19939
 19940     MOVE SPACES                 TO TRD-PAYCURX
 19941                                    TRD-PAYCUR-SPACE
 19942                                    TRD-FUTRSV-SPACE
 19943                                    TRD-FUTRSVX.
 19944
 19945     MOVE EW-CLM-IBNR            TO TRD-IBNR.
 19946     MOVE 'IBNR'                 TO TRD-IBNRX.
 19947     MOVE EW-BEN-TYPE            TO TRD-BENEFIT-CODE.
 19948     MOVE 'BENEFIT - '           TO TRD-BENEFIT-X.
 19949
 19950     IF  W-UNDERWRITTEN-DATA
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 385
* ECS010MO.cbl
 19951         IF  W-REIN-IN-PROCESS
 19952             MOVE ' ACCT/BEN REIN RSV UW'
 19953                                 TO TRD-RSV-ACTION
 19954         ELSE
 19955             MOVE ' ACCT/BEN RESERVES UW'
 19956                                 TO TRD-RSV-ACTION
 19957     ELSE
 19958         IF  W-REIN-IN-PROCESS
 19959             MOVE ' ACCT/BEN REIN RSV'
 19960                                 TO TRD-RSV-ACTION
 19961         ELSE
 19962             MOVE ' ACCT/BEN RESERVES'
 19963                                 TO TRD-RSV-ACTION.
 19964
 19965     PERFORM 8690-PRINT-DETAIL-LINE THRU 8699-PRT-DETAIL-X.
 19966
 19967     MOVE SPACES                 TO DETAIL-EXTRACT.
 19968
 19969     IF  W-REIN-IN-PROCESS
 19970         MOVE EW-REIN-CO         TO DE-REI-COMP
 19971         MOVE 'R'                TO DE-REIN
 19972         MOVE EW-CLM-IBNR        TO DE-REI-IBNR
 19973         MOVE ZEROS              TO DE-IBNR
 19974     ELSE
 19975         MOVE EW-CLM-IBNR        TO DE-IBNR
 19976         MOVE ZEROS              TO DE-REI-IBNR.
 19977
 19978     MOVE 'DE'                   TO DE-RECORD-ID.
 19979     MOVE 'Y'                    TO DE-TRANS.
 19980     MOVE 'IBNRRSV'              TO DE-CLMNO.
 19981     MOVE '1'                    TO DE-ENTRY-STATUS.
 19982     MOVE 'ACTBENIBNR'           TO DE-CERT.
 19983
 19984     MOVE EOM-RUN-DATE           TO DE-EFF
 19985                                    WS-DE-EFF-N
 19986                                    DE-ENTRY-DTE
 19987                                    WS-DE-ENTRY-DTE-N.
 19988     MOVE INCURRED-DATE          TO DE-RSV-INCUR
 19989                                    WS-DE-RSV-INCUR-N.
 19990
 19991     MOVE AM-COMPANY-CD          TO DE-COMPANY-CD.
 19992     MOVE AM-MSTR-CNTRL          TO DE-CNTRL1.
 19993     MOVE AM-EXPIRE-DT           TO DE-ACC-EXP-DTE-RSV
 19994                                    WS-DE-ACC-EXP-DTE-RSV-N.
 19995     MOVE AM-EFFECT-DT           TO DE-ACC-EFF-DTE-RSV
 19996                                    WS-DE-ACC-EFF-DTE-RSV-N.
 19997
 19998     MOVE AM-NAME                TO DE-RSV-ACC-NAME.
 19999     MOVE AM-RECALC-COMM         TO DE-RECALC-CODE.
 20000     MOVE AM-REMIT-TO            TO DE-REMIT-TO.
 20001     MOVE AM-REPORT-CODE-1       TO DE-REPORT-CODE-1.
 20002     MOVE AM-REPORT-CODE-2       TO DE-REPORT-CODE-2.
 20003     MOVE AM-POOL-PRIME          TO DE-NCL-POOL-CODE.
 20004     MOVE AM-IG                  TO DE-IG.
 20005
 20006     IF W-UNDERWRITTEN-DATA
 20007         MOVE 'Y'                TO DE-UNDERWRITING-CODE
 20008     ELSE
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 386
* ECS010MO.cbl
 20009         MOVE 'N'                TO DE-UNDERWRITING-CODE.
 20010
 20011     IF  EW-LF-AH EQUAL 'L'
 20012         MOVE EW-BEN-TYPE        TO DE-LF-TYPE
 20013         MOVE '1'                TO DE-RESERVE-TYPE
 20014         MOVE ZEROS              TO DE-AH-TYPE
 20015     ELSE
 20016         MOVE EW-BEN-TYPE        TO DE-AH-TYPE
 20017         MOVE '2'                TO DE-RESERVE-TYPE
 20018         MOVE ZEROS              TO DE-LF-TYPE.
 20019
 20020     MOVE SPACES                 TO DE-NAME
 20021                                    DE-ACC-GPCD
 20022                                    DE-AH-STAT-CDE
 20023                                    DE-LF-STAT-CDE
 20024                                    DE-MEMBER-NO
 20025                                    DE-NAME
 20026                                    DE-SEX.
 20027     MOVE ZEROS                  TO DE-AGE
 20028                                    DE-AH-BEN
 20029                                    DE-AH-CANC-DTE
 20030                                    WS-DE-AH-CANC-DTE-N
 20031                                    DE-AH-CANC-EXIT-DT
 20032                                    WS-DE-AH-CANC-EXIT-DT-N
 20033                                    DE-AH-PRM
 20034                                    DE-AH-RFND
 20035                                    DE-AH-TERM
 20036                                    DE-APR
 20037                                    DE-CANCEL-CNT-ITD
 20038                                    DE-CANCEL-CNT-YTD
 20039                                    DE-FUTRSV
 20040                                    DE-LF-BEN
 20041                                    DE-LF-BEN-ALT
 20042                                    DE-LF-CANC-DTE
 20043                                    WS-DE-LF-CANC-DTE-N
 20044                                    DE-LF-CANC-EXIT-DT
 20045                                    WS-DE-LF-CANC-EXIT-DT-N
 20046                                    DE-LF-CNBEN
 20047                                    DE-LF-CNBEN-ALT
 20048                                    DE-LF-PRM
 20049                                    DE-LF-PRM-ALT
 20050                                    DE-LF-RFND
 20051                                    DE-LF-TERM
 20052                                    DE-LIVES
 20053                                    DE-PAYCUR
 20054                                    DE-PMT-FREQ
 20055                                    DE-REI-AHAMT
 20056                                    DE-REI-AHPRM
 20057                                    DE-REI-AHRFND
 20058                                    DE-REI-CNAMT
 20059                                    DE-REI-FUTRSV
 20060                                    DE-REI-LFAMT
 20061                                    DE-REI-LFPRM
 20062                                    DE-REI-LFRFND
 20063                                    DE-REI-PAYCUR
 20064                                    DE-RSV-REPORTED
 20065                                    DE-RSV-PAYTO
 20066                                    WS-DE-RSV-PAYTO-N
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 387
* ECS010MO.cbl
 20067                                    DE-MOB-NET-TOT-FEES
 20068                                    DE-SOC-SEC-NO.
 20069
 20070     MOVE SPACES                 TO W-REIN-PROCESS-IND.
 20071
 20072     PERFORM 2500-WRITE-DETAIL-EXTRACTS
 20073         THRU 2599-WRT-DETAIL-X.
 20074     ADD +1                      TO BC-G-CRS.
 20075
 20076 4740-EXIT.
 20077     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 388
* ECS010MO.cbl
 20079 4750-UPDATE-REIN.
 20080
 20081     COMPUTE SUB3 = SUB2 + 1.
 20082
 20083     IF  W-UNDERWRITTEN-DATA
 20084         MOVE EPEC-SUB-KEY-II (SUB2)
 20085                                 TO W-SUB-KEY
 20086     ELSE
 20087         MOVE EPEC-SUB-KEY (SUB2)
 20088                                 TO W-SUB-KEY.
 20089
 20090     PERFORM 4755-MATCH-REIN-EPEC THRU 4755-EXIT
 20091             VARYING
 20092         SUB3 FROM SUB3 BY +1
 20093             UNTIL
 20094         SUB3 GREATER THAN +900
 20095*        SUB3 GREATER THAN +220
 20096*        SUB3 GREATER THAN +300
 20097             OR
 20098         EPEC-LF-AH-OPT (SUB3) EQUAL SPACES.
 20099
 20100 4750-EXIT.
 20101     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 389
* ECS010MO.cbl
 20103 4755-MATCH-REIN-EPEC.
 20104
 20105     IF  W-UNDERWRITTEN-DATA
 20106         MOVE EPEC-LEVELS-II (SUB3)
 20107                                 TO EPEC-WORK
 20108     ELSE
 20109         MOVE EPEC-LEVELS (SUB3) TO EPEC-WORK.
 20110
 20111     IF  EPEC-LINE-NOT-USED (SUB3)
 20112         GO TO 4755-EXIT.
 20113
 20114     IF  EW-SUB-KEY NOT EQUAL W-SUB-KEY
 20115             OR
 20116         EW-REIN-CO EQUAL SPACES
 20117         GO TO 4755-EXIT.
 20118
 20119     IF  W-ISS-BEN GREATER THAN ZEROS
 20120         IF  EPEC-REIN-ONLY-DATA (SUB3)
 20121             COMPUTE W-FACTOR ROUNDED
 20122                 = (EW-ISS-BEN
 20123                 - EPEC-REIN-ISS-BEN (SUB3))
 20124                 / W-ISS-BEN
 20125         ELSE
 20126             COMPUTE W-FACTOR ROUNDED
 20127                 = EW-ISS-BEN
 20128                 / W-ISS-BEN.
 20129
 20130     COMPUTE EW-CLM-IBNR ROUNDED
 20131         = EW-CLM-IBNR
 20132         + (W-WK-IBNR * W-FACTOR).
 20133
 20134     IF  W-UNDERWRITTEN-DATA
 20135         MOVE EPEC-WORK          TO EPEC-LEVELS-II (SUB3)
 20136     ELSE
 20137         MOVE EPEC-WORK          TO EPEC-LEVELS (SUB3).
 20138
 20139 4755-EXIT.
 20140     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 390
* ECS010MO.cbl
 20142 4760-PROCESS-REIN-ONLY.
 20143
 20144     MOVE ZEROS                  TO W-WK-IBNR.
 20145
 20146     IF  EPEC-LINE-NOT-USED (SUB2)
 20147         GO TO 4760-EXIT.
 20148
 20149     IF  EW-LF-AH EQUAL 'L'
 20150         IF  EPEC-LIFE-IBNR (SUB2) EQUAL ZEROS
 20151             GO TO 4760-EXIT
 20152         ELSE
 20153             PERFORM 4720-PROCESS-LIFE THRU 4720-EXIT
 20154             ADD W-WK-IBNR       TO EW-CLM-IBNR
 20155     ELSE
 20156         IF  EPEC-EARNED-PREMIUM-AH (SUB2) EQUAL ZEROS
 20157             GO TO 4760-EXIT
 20158         ELSE
 20159             PERFORM 4730-PROCESS-A-H THRU 4730-EXIT
 20160             ADD W-WK-IBNR       TO EW-CLM-IBNR.
 20161
 20162 4760-EXIT.
 20163     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 391
* ECS010MO.cbl
 20165 4770-CREATE-REIN-DETAIL.
 20166
 20167     MOVE 'Y'                    TO W-REIN-PROCESS-IND.
 20168     PERFORM 4740-CREATE-DETAIL-EXTR THRU 4740-EXIT.
 20169
 20170 4770-EXIT.
 20171     EXIT.
 20172
 20173 4799-EXIT.
 20174     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 392
* ECS010MO.cbl
 20176 4800-CALC-EARNED-PREMIUM-AH.
 20177
 20178     MOVE +0                         TO CNC-BEN  EPR-R78
 20179                                        ISS-PRM  EPR-PRO
 20180                                        CNC-PRM  EPR-ST
 20181                                        WX-CLM-AMT
 20182                                        WX-CLM-EXP
 20183                                        WX-CLM-CNT
 20184                                        WX-CLM-CRT
 20185                                        WX-CNC-CNT
 20186                                        ISS-PRMTAX
 20187                                        WX-ACTIVE-COUNT.
 20188     MOVE SPACE                      TO A-H-EARNED-SWITCH.
 20189
 20190     MOVE WE-AHPRM TO ISS-PRM.
 20191
 20192     IF DTE-CLIENT = 'GIC'
 20193         IF REIN-EP-FLG NOT = 'R'  AND
 20194            CLAS-I-CALC-TYPE (CLAS-INDEXA) = 'B'  AND
 20195            (CR-ENTRY-STATUS NOT = '5' AND '3' AND 'M')
 20196            MOVE CR-AHPRM-CALC TO ISS-PRM.
 20197
 20198     IF REIN-EP-FLG = 'R'  AND
 20199        REIN-AH-RUNOFF-SW (SUB5) = 'N'
 20200         NEXT SENTENCE
 20201     ELSE
 20202         GO TO 4810-EP-DO-AH-CLM.
 20203
 20204     IF CR-DIS-DT NOT GREATER THAN EARNING-STOP-DATE
 20205         IF WE-DSPY-AMT NOT = +0
 20206             ADD WE-DSPY-AMT    TO WX-CLM-AMT
 20207             ADD WE-DSPY-EXP    TO WX-CLM-EXP
 20208             ADD CR-NUM-DIS-CLM TO WX-CLM-CNT
 20209             ADD +1             TO WX-CLM-CNT.
 20210
 20211     IF CR-AH-STATUS-AT-SETTLEMENT NOT = ' '
 20212         IF CR-DIS-DT GREATER THAN EARNING-STOP-DATE
 20213             GO TO 4830-EP-DO-AH-EP.
 20214
 20215     IF CR-AH-STATUS-AT-CANCEL NOT = ' '
 20216         IF CR-AH-CANC-DT GREATER THAN EARNING-STOP-DATE
 20217             GO TO 4830-EP-DO-AH-EP.
 20218
 20219     GO TO 4815-EP-DO-AH-CLM-EPR.
 20220
 20221 4810-EP-DO-AH-CLM.
 20222
 20223     IF WE-DSPY-AMT NOT = +0
 20224         ADD WE-DSPY-AMT    TO WX-CLM-AMT
 20225         ADD WE-DSPY-EXP    TO WX-CLM-EXP
 20226         ADD CR-NUM-DIS-CLM TO WX-CLM-CNT
 20227         ADD +1             TO WX-CLM-CNT.
 20228
 20229 4815-EP-DO-AH-CLM-EPR.
 20230
 20231     IF CR-AH-STATUS-AT-SETTLEMENT NOT = ' '
 20232         MOVE WE-AHPRM TO EPR-R78  EPR-PRO  EPR-ST.
 20233
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 393
* ECS010MO.cbl
 20234 4820-EP-DO-AH-CNCL.
 20235
 20236     IF CR-AH-STATUS-AT-CANCEL = ' '
 20237         IF CR-AH-STATUS-AT-SETTLEMENT NOT = ' '  AND
 20238            CLAS-I-CALC-TYPE (CLAS-INDEXA) NOT = 'Z'
 20239             GO TO 4899-EXIT
 20240         ELSE
 20241             GO TO 4830-EP-DO-AH-EP.
 20242
 20243     IF (DTE-CLIENT = 'DCC')
 20244        AND (CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'G' OR 'L')
 20245        IF CR-AHRFND NOT = ZEROS
 20246           ADD +1                TO WX-CNC-CNT
 20247        END-IF
 20248     ELSE
 20249        ADD +1                   TO WX-CNC-CNT
 20250     END-IF
 20251
 20252     MOVE WE-AHRFND TO CNC-PRM.
 20253
 20254*    MOVE CR-DT                 TO  DC-GREG-DATE-CYMD.
 20255*    MOVE 'L'                   TO  DC-OPTION-CODE.
 20256*    PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 20257*    MOVE DC-BIN-DATE-1         TO  WS-CR-BIN-DATE.
 20258
 20259     MOVE CR-AH-CANC-DT         TO DC-GREG-DATE-CYMD.
 20260     MOVE 'L'                   TO  DC-OPTION-CODE.
 20261     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 20262     MOVE DC-BIN-DATE-1         TO  WS-BIN-CANCEL-DATE.
 20263
 20264     MOVE WS-CR-BIN-DATE          TO  DC-BIN-DATE-1.
 20265     MOVE WS-BIN-CANCEL-DATE      TO  DC-BIN-DATE-2.
 20266     MOVE '1'                     TO  DC-OPTION-CODE.
 20267     MOVE ZEROS                   TO  MONTHS-DIFF-AH.
 20268     MOVE ZEROS                   TO  DC-ELAPSED-MONTHS
 20269                                      DC-ODD-DAYS-OVER
 20270                                      DC-ELAPSED-DAYS.
 20271     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 20272     MOVE DC-ELAPSED-MONTHS       TO  MONTHS-DIFF-AH.
 20273
 20274     IF DC-ODD-DAYS-OVER   GREATER THAN  ZERO
 20275         ADD  +1                  TO  MONTHS-DIFF-AH.
 20276
 20277     MOVE  'YYYYYYYYYY'           TO  WS-AH-CHARGEBACK-LEVELS.
 20278
 20279     IF DTE-CLIENT = 'ACE'
 20280         GO TO 4820-CONTINUE-AH-CANCEL.
 20281
 20282     MOVE  ZEROS                  TO  SUB.
 20283
 20284 4820-AH-CHARGEBACK-LOOP.
 20285
 20286     ADD    +1                    TO  SUB.
 20287
 20288     IF  SUB  GREATER THAN  +10
 20289         GO TO  4820-CONTINUE-AH-CANCEL.
 20290
 20291     IF  AM-COMM-CHARGEBACK (SUB)  NOT  NUMERIC  OR
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 394
* ECS010MO.cbl
 20292         AM-COMM-CHARGEBACK (SUB)  =  ZEROS
 20293         GO TO  4820-AH-CHARGEBACK-LOOP.
 20294
 20295     IF  AM-COMM-CHARGEBACK (SUB)  EQUAL    '99'
 20296         MOVE  'N'    TO  WS-AH-CHARGEBACK-SW (SUB).
 20297
 20298     IF  (MONTHS-DIFF-AH GREATER THAN AM-COMM-CHARGEBACK (SUB))
 20299         OR (CR-AHRFND = ZEROS)
 20300         MOVE  'N'        TO  WS-AH-CHARGEBACK-SW (SUB)
 20301     END-IF
 20302
 20303     GO TO  4820-AH-CHARGEBACK-LOOP.
 20304
 20305
 20306 4820-CONTINUE-AH-CANCEL.
 20307
 20308     IF DTE-CLIENT = 'GIC'
 20309         IF REIN-EP-FLG NOT = 'R'  AND
 20310            CLAS-I-CALC-TYPE (CLAS-INDEXA) = 'B'
 20311            MOVE CR-AHRFND-CALC TO CNC-PRM.
 20312
 20313     COMPUTE EPR-R78 = WE-AHPRM - WE-AHRFND.
 20314     MOVE EPR-R78 TO EPR-PRO  EPR-ST.
 20315
 20316     IF CR-AH-LUMP-SUM-DISAB
 20317         GO TO 4899-EXIT.
 20318
 20319     MOVE WE-AHAMT TO CNC-BEN.
 20320
 20321     GO TO 4899-EXIT.
 20322
 20323 4825-EP-DO-AH-CNCL-SUM.
 20324
 20325     IF WE-DSPY-AMT NOT = +0
 20326         ADD WE-DSPY-AMT    TO WX-CLM-AMT
 20327         ADD WE-DSPY-EXP    TO WX-CLM-EXP
 20328         ADD CR-NUM-DIS-CLM TO WX-CLM-CNT
 20329         ADD +1             TO WX-CLM-CNT.
 20330
 20331     IF WE-AHRFND = ZERO
 20332        GO TO 4830-EP-DO-AH-EP.
 20333
 20334     MOVE WE-AHRFND TO CNC-PRM.
 20335
 20336     ADD CR-SUM-CAN-CNT-ITD TO WX-CNC-CNT.
 20337
 20338     MOVE  'YYYYYYYYYY'           TO  WS-AH-CHARGEBACK-LEVELS.
 20339
 20340     IF WE-AHRFND NOT LESS WE-AHPRM
 20341         MOVE WE-AHAMT TO CNC-BEN
 20342          GO TO 4830-EP-DO-AH-EP.
 20343
 20344     COMPUTE TEMP-6 ROUNDED = WE-AHRFND / WE-AHPRM.
 20345     COMPUTE TEMP-7 ROUNDED = TEMP-6 * WE-AHAMT.
 20346     MOVE TEMP-7 TO CNC-BEN.
 20347
 20348 4830-EP-DO-AH-EP.
 20349
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 395
* ECS010MO.cbl
 20350     MOVE EOM-RUN-DATE TO VALUATION-DT.
 20351     MOVE '8'           TO W-VAL-SOURCE.
 20352
 20353     IF REIN-EP-FLG = 'R'
 20354       IF REIN-REM-SW (SUB5) = 'I'
 20355           MOVE WE-AHPRM            TO EPR-R78  EPR-PRO  EPR-ST
 20356           GO TO 4899-EXIT.
 20357
 20358     IF REIN-EP-FLG = 'R'
 20359         IF REIN-AH-RUNOFF-SW (SUB5) = 'N'  AND
 20360            EARNING-STOP-DATE LESS THAN VALUATION-DT
 20361             MOVE '*'               TO A-H-EARNED-SWITCH
 20362             MOVE EARNING-STOP-DATE TO VALUATION-DT
 20363             MOVE '10'              TO W-VAL-SOURCE.
 20364
 20365     PERFORM 8500-REMAINING-TERM-ROUTINE THRU 8599-REM-TERM-X.
 20366
 20367     IF REM-TRM2 GREATER CR-AH-TERM
 20368         MOVE +0 TO EPR-R78  EPR-PRO  EPR-ST
 20369         GO TO 4899-EXIT.
 20370
 20371     IF CLAS-I-CALC-TYPE (CLAS-INDEXA) = 'Z'
 20372         COMPUTE WE-AHPRM = WE-AHPRM - WE-AHRFND.
 20373*
 20374 4835-CHECK-OB-AH-NCL.
 20375
 20376     IF (DTE-CLIENT EQUAL 'NCL') AND
 20377        (CLAS-I-CALC-TYPE (CLAS-INDEXA) EQUAL 'B')
 20378           MOVE WE-AHPRM         TO EPR-R78
 20379                                    EPR-PRO
 20380                                    EPR-ST
 20381        IF (CR-CCYY EQUAL EOM-CCYY) AND
 20382           (CR-MO EQUAL EOM-MO)
 20383           MOVE '*'            TO OB-DATE-1-SWITCH
 20384           MOVE EW-REIN-CO     TO WS-OB-REIN-CO (SUB3)
 20385           MOVE AH-OVERRIDE-L1 TO WS-OB-LF-AH (SUB3)
 20386           MOVE CR-AHTYP       TO WS-OB-BENEFIT-CODE (SUB3)
 20387           COMPUTE WS-EPR-R78 (SUB3 1) =
 20388                   WS-EPR-R78 (SUB3 1) + (WE-AHPRM * .5)
 20389           GO TO 4899-EXIT
 20390        ELSE
 20391        IF (CR-CCYY EQUAL OB-CCYY (1)) AND
 20392           (CR-MO EQUAL OB-MO (1))
 20393           MOVE '*'            TO OB-DATE-2-SWITCH
 20394           MOVE EW-REIN-CO     TO WS-OB-REIN-CO (SUB3)
 20395           MOVE AH-OVERRIDE-L1 TO WS-OB-LF-AH (SUB3)
 20396           MOVE CR-AHTYP       TO WS-OB-BENEFIT-CODE (SUB3)
 20397           COMPUTE WS-EPR-R78 (SUB3 2) =
 20398                   WS-EPR-R78 (SUB3 2) + (WE-AHPRM * .5)
 20399           GO TO 4899-EXIT
 20400        ELSE
 20401        IF (CR-CCYY EQUAL OB-CCYY (2)) AND
 20402           (CR-MO EQUAL OB-MO (2))
 20403           MOVE '*'            TO OB-DATE-3-SWITCH
 20404           MOVE EW-REIN-CO     TO WS-OB-REIN-CO (SUB3)
 20405           MOVE AH-OVERRIDE-L1 TO WS-OB-LF-AH (SUB3)
 20406           MOVE CR-AHTYP       TO WS-OB-BENEFIT-CODE (SUB3)
 20407           COMPUTE WS-EPR-R78 (SUB3 3) =
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 396
* ECS010MO.cbl
 20408                   WS-EPR-R78 (SUB3 3) + (WE-AHPRM * .5)
 20409           GO TO 4899-EXIT
 20410        ELSE
 20411           GO TO 4899-EXIT.
 20412
 20413     IF REM-TRM2 NOT GREATER +0
 20414         MOVE WE-AHPRM TO EPR-R78  EPR-PRO  EPR-ST
 20415         GO TO 4899-EXIT.
 20416
 20417     IF CLAS-I-CALC-TYPE (CLAS-INDEXA) = 'B'
 20418         MOVE WE-AHPRM TO EPR-R78  EPR-PRO  EPR-ST
 20419         GO TO 4899-EXIT.
 20420
 20421     IF CLAS-I-CALC-TYPE (CLAS-INDEXA) NOT = 'Z'
 20422         MOVE +1 TO WX-ACTIVE-COUNT
 20423     ELSE
 20424         COMPUTE WX-ACTIVE-COUNT = CR-LIVES - CR-SUM-CAN-CNT-ITD.
 20425
 20426     COMPUTE TEMP-1 = CR-AH-TERM * (CR-AH-TERM + 1).
 20427     COMPUTE TEMP-2 = REM-TRM1 * (REM-TRM1 + 1).
 20428     IF DTE-R78 = '1'
 20429         COMPUTE TEMP-2 = REM-TRM1 * REM-TRM1.
 20430     COMPUTE TEMP-4 ROUNDED = TEMP-2 / TEMP-1.
 20431
 20432     IF DTE-CLIENT = 'MIC' OR 'MCC'
 20433         COMPUTE TEMP-5 ROUNDED = (REM-TRM1 - .5) / CR-AH-TERM
 20434     ELSE
 20435         COMPUTE TEMP-5 ROUNDED = REM-TRM1 / CR-AH-TERM.
 20436
 20437     COMPUTE EPR-R78 ROUNDED = WE-AHPRM * TEMP-4.
 20438     COMPUTE EPR-R78 = WE-AHPRM - EPR-R78.
 20439
 20440     COMPUTE EPR-PRO ROUNDED = WE-AHPRM * TEMP-5.
 20441     COMPUTE EPR-PRO = WE-AHPRM - EPR-PRO.
 20442
 20443     MOVE CLAS-I-EP (CLAS-INDEXA) TO AH-EARN-METHOD.
 20444
 20445*    IF AM-EARN-METHOD-A NOT EQUAL SPACES AND ZEROS
 20446*        MOVE AM-EARN-METHOD-A TO AH-EARN-METHOD.
 20447
 20448     MOVE SPACES TO STATUTORY-SWITCH-AH.
 20449
 20450     IF (STATE-ABBR (CLAS-INDEXS) = 'VA') AND
 20451        (CR-DT GREATER THAN  19921231)
 20452        AND (DTE-CLIENT NOT = 'DCC')
 20453         IF CR-AH-TERM GREATER THAN  +61
 20454             MOVE 'A' TO AH-EARN-METHOD
 20455             MOVE '*' TO STATUTORY-SWITCH-AH
 20456             GO TO 4845-EP-DO-AH-EP-AN
 20457         ELSE
 20458             GO TO 4860-EP-DO-AH-STATUTORY.
 20459
 20460     IF (AH-EARN-METHOD EQUAL 'N')
 20461                  OR
 20462        ((DTE-CLIENT = 'DCC')
 20463         AND (CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'G' OR 'L')
 20464         AND (CLAS-I-REFUND-METHOD (CLAS-INDEXA) NOT = 'G'))
 20465         GO TO 4840-EP-DO-AH-EP-NP
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 397
* ECS010MO.cbl
 20466     END-IF
 20467
 20468     IF AH-EARN-METHOD EQUAL 'A' OR 'C'
 20469         MOVE 'A' TO AH-EARN-METHOD
 20470         GO TO 4845-EP-DO-AH-EP-AN.
 20471
 20472     GO TO 4860-EP-DO-AH-STATUTORY.
 20473
 20474 4840-EP-DO-AH-EP-NP.
 20475
 20476     IF WE-AHPRM = ZERO
 20477         GO TO 4860-EP-DO-AH-STATUTORY.
 20478
 20479     IF CR-APR GREATER THAN +0
 20480         NEXT SENTENCE
 20481     ELSE
 20482         GO TO 4860-EP-DO-AH-STATUTORY.
 20483
 20484     IF DTE-CLIENT = 'NCL'
 20485       IF CR-DT LESS THAN 19910101
 20486           GO TO 4860-EP-DO-AH-STATUTORY.
 20487
 20488     IF REM-TRM1 = CR-AH-TERM
 20489         MOVE +0 TO EPR-R78  EPR-PRO  EPR-ST
 20490         GO TO 4899-EXIT.
 20491
 20492     MOVE CR-APR TO NP-APR.
 20493     MOVE CR-AH-TERM TO NP-ORIG  NP-CAP.
 20494     MOVE REM-TRM1 TO NP-REM.
 20495     MOVE CLAS-I-CALC-TYPE (CLAS-INDEXA) TO NP-OPT.
 20496     IF NP-OPT = 'T' OR 'U' OR 'V' OR 'W' OR 'X'
 20497         MOVE CR-LOAN-TERM TO NP-ORIG.
 20498
 20499     IF (DTE-CLIENT = 'DCC')
 20500        AND (CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'G' OR 'L')
 20501        MOVE 'S'                 TO NP-OPT
 20502     ELSE
 20503        MOVE 'R'                 TO NP-OPT
 20504     END-IF
 20505
 20506
 20507*    MOVE 'R' TO NP-OPT.
 20508     CALL 'ECSNETRM'
 20509         USING NP-APR NP-ORIG NP-REM NP-OPT NP-CAP NP-FACTOR.
 20510
 20511     IF (DTE-CLIENT = 'DCC')
 20512        AND (CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'G' OR 'L')
 20513        COMPUTE EPR-ST ROUNDED =
 20514           WE-AHPRM - (NP-FACTOR * WE-AHPRM)
 20515        GO TO 4899-EXIT
 20516     ELSE
 20517        COMPUTE EPR-R78 ROUNDED =
 20518           WE-AHPRM - (NP-FACTOR * WE-AHPRM)
 20519     END-IF
 20520
 20521     GO TO 4860-EP-DO-AH-STATUTORY.
 20522
 20523 4845-EP-DO-AH-EP-AN.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 398
* ECS010MO.cbl
 20524     MOVE CR-DT                      TO DC-GREG-DATE-CYMD.
 20525     MOVE 'L'                        TO DC-OPTION-CODE.
 20526     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 20527     MOVE DC-BIN-DATE-1              TO CP-CERT-EFF-DT.
 20528     MOVE CLAS-I-RL-AH (CLAS-INDEXA) TO CP-BENEFIT-TYPE.
 20529     MOVE SPACES                     TO CP-ACCT-FLD-5.
 20530     MOVE DTE-CLIENT                 TO CP-COMPANY-ID.
 20531     MOVE STATE-SUB (CLAS-INDEXS)    TO CP-STATE.
 20532     MOVE STATE-ABBR (CLAS-INDEXS)   TO CP-STATE-STD-ABBRV.
 20533     MOVE CR-AGE                     TO CP-ISSUE-AGE.
 20534     MOVE REM-TRM1                   TO CP-ORIGINAL-TERM.
 20535     MOVE CR-AHAMT                   TO CP-ORIGINAL-BENEFIT
 20536                                        CP-RATING-BENEFIT-AMT.
 20537     IF CP-STATE-STD-ABBRV = 'OR'
 20538         COMPUTE CP-RATING-BENEFIT-AMT =
 20539                                  CR-AHAMT * REM-TRM1.
 20540     MOVE CR-APR                     TO CP-LOAN-APR.
 20541     MOVE CR-PMT-FREQ                TO CP-PAY-FREQUENCY.
 20542     MOVE AH-EARN-METHOD             TO CP-EARNING-METHOD.
 20543     MOVE '3'                        TO CP-PROCESS-TYPE.
 20544     MOVE CLAS-I-BAL (CLAS-INDEXA)   TO CP-SPECIAL-CALC-CD.
 20545     MOVE CR-LOAN-TERM               TO CP-LOAN-TERM.
 20546     IF CR-RATING-CLASS NOT = SPACE AND ZERO
 20547         MOVE CR-RATING-CLASS        TO CP-CLASS-CODE
 20548     ELSE
 20549         MOVE AM-CAL-TABLE           TO CP-CLASS-CODE.
 20550     MOVE AM-AH-DEVIATION            TO CP-DEVIATION-CODE.
 20551     MOVE CR-AHTYP                   TO CP-BENEFIT-CD.
 20552     MOVE DTE-CLASIC-COMPANY-CD      TO CP-COMPANY-CD.
 20553     MOVE CR-PMT-EXTENSION-DAYS      TO CP-TERM-OR-EXT-DAYS.
 20554     MOVE AH-OVERRIDE-L1             TO CP-AH-OVERRIDE-CODE.
 20555     MOVE AM-AH-DEVIATION-PCT        TO CP-RATE-DEV-PCT.
 20556
 20557     PERFORM 8100-GET-RATE THRU 8199-GET-RATE-X.
 20558
 20559     IF CP-ERROR-RATE-NOT-FOUND  OR
 20560        CP-ERROR-RATE-IS-ZERO  OR
 20561        CP-ERROR-IN-DATES
 20562         GO TO 4860-EP-DO-AH-STATUTORY.
 20563
 20564     COMPUTE EPR-R78 ROUNDED =
 20565             ((REM-TRM1 * WE-AHAMT) / +100) *
 20566               CP-PREMIUM-RATE.
 20567
 20568     COMPUTE EPR-R78 = WE-AHPRM - EPR-R78.
 20569
 20570     IF STATUTORY-REQUIREMENT-AH
 20571         MOVE EPR-R78                TO EPR-ST
 20572         GO TO 4899-EXIT.
 20573
 20574 4860-EP-DO-AH-STATUTORY.
 20575     IF (DTE-CLIENT EQUAL 'CID') AND
 20576        (STATE-ABBR (CLAS-INDEXS) = 'VA')
 20577         GO TO 4867-EP-DO-AH-STAT-ROA
 20578     END-IF.
 20579
 20580 4860-EP-DO-AH-STATUTORY-VA.
 20581
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 399
* ECS010MO.cbl
 20582     IF (DTE-CLIENT = 'DCC')
 20583        AND (CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'G' OR 'L')
 20584        AND (CLAS-I-REFUND-METHOD (CLAS-INDEXA) = 'G')
 20585        AND (CLAS-I-BEN (CLAS-INDEXA) NOT = '55' AND '56')
 20586        MOVE EPR-R78             TO EPR-ST
 20587        GO TO 4899-EXIT
 20588     END-IF
 20589
 20590     IF (DTE-CLIENT = 'DCC')
 20591        AND (CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'G' OR 'L')
 20592        AND (CLAS-I-REFUND-METHOD (CLAS-INDEXA) = 'G')
 20593        AND (CLAS-I-BEN (CLAS-INDEXA) = '55' OR '56')
 20594        MOVE +1.0000                TO TEMP-6
 20595        IF REM-TRM1 < +9
 20596           COMPUTE TEMP-6 =
 20597              ((9 - (9 - REM-TRM1)) - 1)
 20598              * +.125
 20599        END-IF
 20600        COMPUTE EPR-ST ROUNDED = WE-AHPRM - (WE-AHPRM * TEMP-6)
 20601        MOVE EPR-ST              TO EPR-R78
 20602                                    EPR-PRO
 20603        GO TO 4899-EXIT
 20604     END-IF
 20605
 20606     MOVE EPR-R78                    TO EPR-ST.
 20607
 20608     MOVE +0                         TO SUB1.
 20609
 20610 4865-EP-AH-STAT-LOOP.
 20611     ADD +1 TO SUB1.
 20612
 20613     IF STATE-ABBR (CLAS-INDEXS) = AH-RES-STATE-ENT (SUB1)
 20614         MOVE EPR-PRO                TO EPR-ST
 20615     ELSE
 20616         IF AH-RES-STATE-ENT (SUB1) NOT = HIGH-VALUES
 20617             GO TO 4865-EP-AH-STAT-LOOP.
 20618
 20619     IF (STATE-ABBR (CLAS-INDEXS) = 'OH'  AND
 20620         CR-DT GREATER THAN 19831031)  OR
 20621
 20622        (STATE-ABBR (CLAS-INDEXS) = 'OK'  AND
 20623         CR-DT GREATER THAN 19820629)  OR
 20624
 20625        (STATE-ABBR (CLAS-INDEXS) = 'TX'  AND
 20626         CR-DT GREATER THAN 19830831)
 20627
 20628         COMPUTE EPR-ST = (EPR-R78 + EPR-PRO) / 2.
 20629
 20630     IF DTE-CLIENT = 'CSO'  OR  'CID'
 20631       IF STATE-ABBR (CLAS-INDEXS) = 'CO'
 20632         IF CR-DT LESS THAN 19970101
 20633             MOVE EPR-R78            TO EPR-ST
 20634         ELSE
 20635             COMPUTE EPR-ST = (EPR-R78 + EPR-PRO) / 2.
 20636
 20637     IF DTE-CLIENT = 'DCC'
 20638        IF CLAS-I-BAL (CLAS-INDEXA) = 'C'
 20639           MOVE EPR-PRO          TO EPR-ST
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 400
* ECS010MO.cbl
 20640        ELSE
 20641           COMPUTE EPR-ST = (EPR-R78 + EPR-PRO) / 2
 20642        END-IF
 20643     END-IF
 20644     .
 20645     GO TO 4899-EXIT.
 20646
 20647 4867-EP-DO-AH-STAT-ROA.
 20648     MOVE CR-DT                      TO DC-GREG-DATE-CYMD.
 20649     MOVE 'L'                        TO DC-OPTION-CODE.
 20650     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 20651     MOVE DC-BIN-DATE-1              TO CP-CERT-EFF-DT.
 20652     MOVE CLAS-I-RL-AH (CLAS-INDEXA) TO CP-BENEFIT-TYPE.
 20653     MOVE SPACES                     TO CP-ACCT-FLD-5.
 20654     MOVE DTE-CLIENT                 TO CP-COMPANY-ID.
 20655     MOVE STATE-SUB (CLAS-INDEXS)    TO CP-STATE.
 20656     MOVE STATE-ABBR (CLAS-INDEXS)   TO CP-STATE-STD-ABBRV.
 20657     MOVE CR-AGE                     TO CP-ISSUE-AGE.
 20658     MOVE REM-TRM1                   TO CP-ORIGINAL-TERM.
 20659     MOVE CR-AHAMT                   TO CP-ORIGINAL-BENEFIT
 20660                                        CP-RATING-BENEFIT-AMT.
 20661     IF CP-STATE-STD-ABBRV = 'OR'
 20662         COMPUTE CP-RATING-BENEFIT-AMT =
 20663                                  CR-AHAMT * REM-TRM1.
 20664     MOVE CR-APR                     TO CP-LOAN-APR.
 20665     MOVE CR-PMT-FREQ                TO CP-PAY-FREQUENCY.
 20666     MOVE 'A'                        TO CP-EARNING-METHOD.
 20667     MOVE '3'                        TO CP-PROCESS-TYPE.
 20668     MOVE CLAS-I-BAL (CLAS-INDEXA)   TO CP-SPECIAL-CALC-CD.
 20669     MOVE CR-LOAN-TERM               TO CP-LOAN-TERM.
 20670     IF CR-RATING-CLASS NOT = SPACE AND ZERO
 20671         MOVE CR-RATING-CLASS        TO CP-CLASS-CODE
 20672     ELSE
 20673         MOVE AM-CAL-TABLE           TO CP-CLASS-CODE.
 20674     MOVE AM-AH-DEVIATION            TO CP-DEVIATION-CODE.
 20675     MOVE CR-AHTYP                   TO CP-BENEFIT-CD.
 20676     MOVE DTE-CLASIC-COMPANY-CD      TO CP-COMPANY-CD.
 20677     MOVE CR-PMT-EXTENSION-DAYS      TO CP-TERM-OR-EXT-DAYS.
 20678     MOVE AH-OVERRIDE-L1             TO CP-AH-OVERRIDE-CODE.
 20679     MOVE AM-AH-DEVIATION-PCT        TO CP-RATE-DEV-PCT.
 20680
 20681     PERFORM 8100-GET-RATE THRU 8199-GET-RATE-X.
 20682
 20683     IF CP-ERROR-RATE-NOT-FOUND  OR
 20684        CP-ERROR-RATE-IS-ZERO  OR
 20685        CP-ERROR-IN-DATES
 20686         GO TO 4860-EP-DO-AH-STATUTORY-VA.
 20687
 20688     COMPUTE EPR-ST ROUNDED =
 20689             ((REM-TRM1 * WE-AHAMT) / +100) *
 20690               CP-PREMIUM-RATE.
 20691
 20692     COMPUTE EPR-ST = WE-AHPRM - EPR-ST.
 20693
 20694     GO TO 4899-EXIT.
 20695
 20696 4899-EXIT.
 20697     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 401
* ECS010MO.cbl
 20698******************************************************************
 20699***         W R I T E   S U M M A R Y   E X T R A C T S        ***
 20700******************************************************************
 20701
 20702 4900-WRITE-SUMMARY-EXTRACTS.
 20703
 20704     IF DTE-CLIENT = 'HER'
 20705         IF EP-RECORD-ID = 'EC'  AND
 20706            EP-REINCO = 'LNL'
 20707             GO TO 4999-WRT-SUMMARY-X.
 20708
 20709     MOVE EOM-RUN-DATE            TO EP-RUN-DTE
 20710                                     WS-EP-RUN-DTE-N.
 20711
 20712     IF W-UNDERWRITTEN-DATA
 20713         MOVE 'Y'                 TO EP-UNDERWRITING-CODE
 20714     ELSE
 20715         MOVE 'N'                 TO EP-UNDERWRITING-CODE.
 20716
 20717     IF  DTE-OPT-RESERVE-METHOD-AUTH
 20718         IF VALID-EP-ID
 20719             MOVE 'Y'             TO EP-NEW-DATA-IND.
 20720
 20721     WRITE EP-RECORD.
 20722
 20723     ADD +1                       TO EP-CNT.
 20724
 20725 4999-WRT-SUMMARY-X.
 20726     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 402
* ECS010MO.cbl
 20728******************************************************************
 20729***       T O T A L   P A G E   S E T U P   R O U T I N E      ***
 20730******************************************************************
 20731
 20732 5000-DATE-RANGE-BREAK.
 20733
 20734     IF NO-TRANSACTION-WAS-PROCESSED
 20735         GO TO 5099-DATE-RANGE-BREAK-X.
 20736
 20737     ADD +1  TO RANGE-CNT.
 20738     MOVE +1 TO SUB6.
 20739     MOVE +2 TO SUB7.
 20740     PERFORM 5800-ADD-PAGES-LEVELS THRU 5899-ADD-PAGES-LEVELS-X.
 20741     IF LN-CNT GREATER +50
 20742         PERFORM 8700-PRINT-REPORT-HEADINGS THRU
 20743                 8750-PRT-RANGE-HEADING.
 20744
 20745     MOVE SPACES                     TO PRT.
 20746     PERFORM 8800-PRINT-ROUTINE.
 20747     MOVE 'DATE RANGE'               TO TPH2-DESC.
 20748     MOVE '  TOTALS'                 TO TPH3-DESC.
 20749     PERFORM 6100-ACCT-TOTAL-HEADINGS THRU 6199-PAGE-HEADINGS-X.
 20750     PERFORM 6500-PRINT-TOTAL-PAGE THRU 6599-TOTAL-PAGE-PRINT-X.
 20751     PERFORM 5900-CLEAR-TOTAL-PAGES
 20752         THRU 5999-CLEAR-TOTAL-PAGES-X
 20753             VARYING SUB6 FROM 1 BY 1 UNTIL SUB6 GREATER 1.
 20754
 20755 5099-DATE-RANGE-BREAK-X.
 20756     EXIT.
 20757
 20758 5100-ACCOUNT-BREAK.
 20759
 20760     IF RANGE-CNT NOT = +0
 20761         PERFORM 5000-DATE-RANGE-BREAK
 20762             THRU 5099-DATE-RANGE-BREAK-X
 20763     ELSE
 20764         MOVE +1 TO SUB6
 20765         MOVE +2 TO SUB7
 20766         PERFORM 5800-ADD-PAGES-LEVELS
 20767             THRU 5899-ADD-PAGES-LEVELS-X
 20768         PERFORM 5900-CLEAR-TOTAL-PAGES
 20769             THRU 5999-CLEAR-TOTAL-PAGES-X
 20770                 VARYING SUB6 FROM 1 BY 1 UNTIL SUB6 GREATER 1.
 20771
 20772     MOVE +0 TO RANGE-CNT.
 20773     PERFORM 7500-ADD-UP-REIN-CO THRU 7599-ADD-UP-REIN-X
 20774         VARYING B-SUB FROM 1 BY 1
 20775             UNTIL B-SUB GREATER THAN 50  OR
 20776                   RB-COMPANY (B-SUB) = SPACES.
 20777     PERFORM 7900-CLEAR-BILLING-TABLE THRU 7999-CLEAR-BILLING-X
 20778         VARYING B-SUB FROM 1 BY 1
 20779             UNTIL B-SUB GREATER THAN 50.
 20780
 20781     IF ACCT-FLG = SPACE
 20782         GO TO 5199-ACCOUNT-BREAK-X.
 20783
 20784     MOVE SPACE TO ACCT-FLG.
 20785     MOVE +2 TO SUB6.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 403
* ECS010MO.cbl
 20786     MOVE +3 TO SUB7.
 20787     PERFORM 5800-ADD-PAGES-LEVELS THRU 5899-ADD-PAGES-LEVELS-X.
 20788     IF LN-CNT GREATER +50
 20789         PERFORM 8700-PRINT-REPORT-HEADINGS THRU
 20790                 8725-PRT-ACCT-HEADING.
 20791
 20792     MOVE SPACES                     TO PRT.
 20793     PERFORM 8800-PRINT-ROUTINE.
 20794     MOVE 'ACCOUNT'                  TO TPH2-DESC.
 20795     MOVE ' TOTALS'                  TO TPH3-DESC.
 20796     PERFORM 6100-ACCT-TOTAL-HEADINGS THRU 6199-PAGE-HEADINGS-X.
 20797     PERFORM 6500-PRINT-TOTAL-PAGE THRU 6599-TOTAL-PAGE-PRINT-X.
 20798     PERFORM 5900-CLEAR-TOTAL-PAGES
 20799         THRU 5999-CLEAR-TOTAL-PAGES-X
 20800             VARYING SUB6 FROM 2 BY 1 UNTIL SUB6 GREATER 2.
 20801
 20802 5199-ACCOUNT-BREAK-X.
 20803     EXIT.
 20804
 20805 5200-STATE-BREAK.
 20806
 20807     PERFORM 5100-ACCOUNT-BREAK THRU 5199-ACCOUNT-BREAK-X.
 20808     MOVE ZEROS TO SV-LO-CERT  SV-HI-CERT.
 20809     MOVE +3 TO SUB6.
 20810     MOVE +4 TO SUB7.
 20811     PERFORM 5800-ADD-PAGES-LEVELS THRU 5899-ADD-PAGES-LEVELS-X.
 20812
 20813     IF STATE-FLG = SPACE
 20814         GO TO 5299-STATE-BREAK-X.
 20815
 20816     MOVE SPACE         TO STATE-FLG.
 20817     PERFORM 8700-PRINT-REPORT-HEADINGS.
 20818     MOVE 'STATE'       TO TPH1-TYPE.
 20819     MOVE HLD-STATE     TO STATE-L.
 20820
 20821     PERFORM 8200-STATE-CODE-LOOKUP THRU 8299-STATE-LOOKUP-X.
 20822
 20823     IF HLD-STATE NOT = STATE-SUB (CLAS-INDEXS)
 20824         MOVE SPACES          TO TPH1-DESC
 20825         MOVE HLD-STATE       TO TPH1-ST-CODE
 20826         MOVE 'UNKNOWN STATE' TO TPH1-ST-DESC
 20827     ELSE
 20828         MOVE SPACES TO TPH1-DESC
 20829         MOVE STATE-SUB (CLAS-INDEXS) TO TPH1-ST-CODE
 20830         MOVE STATE-PIC (CLAS-INDEXS) TO TPH1-ST-DESC.
 20831
 20832     MOVE 'STATE'  TO TPH2-DESC.
 20833     MOVE 'TOTALS' TO TPH3-DESC.
 20834     PERFORM 6000-TOTAL-PAGE-HEADINGS THRU 6199-PAGE-HEADINGS-X.
 20835     PERFORM 6500-PRINT-TOTAL-PAGE THRU 6599-TOTAL-PAGE-PRINT-X.
 20836     PERFORM 5900-CLEAR-TOTAL-PAGES
 20837         THRU 5999-CLEAR-TOTAL-PAGES-X
 20838             VARYING SUB6 FROM 3 BY 1 UNTIL SUB6 GREATER 3.
 20839
 20840 5299-STATE-BREAK-X.
 20841     EXIT.
 20842
 20843 5300-COMP-BREAK.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 404
* ECS010MO.cbl
 20844
 20845     PERFORM 5200-STATE-BREAK THRU 5299-STATE-BREAK-X.
 20846     MOVE +4 TO SUB6.
 20847     MOVE +5 TO SUB7.
 20848     PERFORM 5800-ADD-PAGES-LEVELS THRU 5899-ADD-PAGES-LEVELS-X.
 20849
 20850     IF COMP-FLG = SPACE
 20851         GO TO 5399-COMP-BREAK-X.
 20852
 20853     MOVE ' ' TO COMP-FLG.
 20854     PERFORM 8700-PRINT-REPORT-HEADINGS.
 20855     MOVE 'COMPANY'                   TO TPH1-TYPE.
 20856     MOVE HLD-GROUPING                TO TPH1-DESC.
 20857     MOVE 'COMPANY'                   TO TPH2-DESC.
 20858     MOVE ' TOTALS'                   TO TPH3-DESC.
 20859     PERFORM 6000-TOTAL-PAGE-HEADINGS THRU 6199-PAGE-HEADINGS-X.
 20860     PERFORM 6500-PRINT-TOTAL-PAGE THRU 6599-TOTAL-PAGE-PRINT-X.
 20861     PERFORM 5900-CLEAR-TOTAL-PAGES
 20862         THRU 5999-CLEAR-TOTAL-PAGES-X
 20863             VARYING SUB6 FROM 4 BY 1 UNTIL SUB6 GREATER 4.
 20864
 20865 5399-COMP-BREAK-X.
 20866     EXIT.
 20867
 20868 5400-CARR-BREAK.
 20869
 20870     PERFORM 5300-COMP-BREAK THRU 5399-COMP-BREAK-X.
 20871     MOVE +5 TO SUB6.
 20872     MOVE +6 TO SUB7.
 20873     PERFORM 5800-ADD-PAGES-LEVELS THRU 5899-ADD-PAGES-LEVELS-X.
 20874
 20875     IF CARR-FLG = SPACE
 20876         GO TO 5499-CARR-BREAK-X.
 20877
 20878     MOVE ' ' TO CARR-FLG.
 20879     PERFORM 8700-PRINT-REPORT-HEADINGS.
 20880     MOVE 'CARRIER'               TO TPH1-TYPE.
 20881     MOVE HLD-CARRIER             TO TPH1-DESC.
 20882     MOVE 'CARRIER'               TO TPH2-DESC.
 20883     MOVE ' TOTALS'               TO TPH3-DESC.
 20884     PERFORM 6000-TOTAL-PAGE-HEADINGS THRU 6199-PAGE-HEADINGS-X.
 20885     PERFORM 6500-PRINT-TOTAL-PAGE THRU 6599-TOTAL-PAGE-PRINT-X.
 20886     PERFORM 5900-CLEAR-TOTAL-PAGES
 20887         THRU 5999-CLEAR-TOTAL-PAGES-X
 20888             VARYING SUB6 FROM 5 BY 1 UNTIL SUB6 GREATER 5.
 20889
 20890 5499-CARR-BREAK-X.
 20891     EXIT.
 20892
 20893 5500-FINAL-BREAK.
 20894
 20895     PERFORM 5400-CARR-BREAK THRU 5499-CARR-BREAK-X.
 20896
 20897     IF FINAL-FLG = SPACE
 20898         GO TO 5599-FINAL-BREAK-X.
 20899
 20900     IF DTE-FICH = '1'
 20901         MOVE '2'  TO  DTE-FICH.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 405
* ECS010MO.cbl
 20902     MOVE +6 TO SUB6.
 20903     PERFORM 8700-PRINT-REPORT-HEADINGS.
 20904     MOVE SPACES   TO TPH1-TYPE.
 20905     MOVE SPACES   TO TPH1-DESC.
 20906     MOVE 'FINAL'  TO TPH2-DESC.
 20907     MOVE 'TOTALS' TO TPH3-DESC.
 20908     PERFORM 6000-TOTAL-PAGE-HEADINGS THRU 6199-PAGE-HEADINGS-X.
 20909     PERFORM 6500-PRINT-TOTAL-PAGE THRU 6599-TOTAL-PAGE-PRINT-X.
 20910
 20911 5599-FINAL-BREAK-X.
 20912     EXIT.
 20913
 20914 5800-ADD-PAGES-LEVELS.
 20915
 20916     ADD TPL-ISS-PRM (SUB6)  TO TPL-ISS-PRM (SUB7).
 20917     ADD TPA-ISS-PRM (SUB6)  TO TPA-ISS-PRM (SUB7).
 20918     ADD TPL-CNC-PRM (SUB6)  TO TPL-CNC-PRM (SUB7).
 20919     ADD TPA-CNC-PRM (SUB6)  TO TPA-CNC-PRM (SUB7).
 20920     ADD TPL-ACCT-COM (SUB6) TO TPL-ACCT-COM (SUB7).
 20921     ADD TPA-ACCT-COM (SUB6) TO TPA-ACCT-COM (SUB7).
 20922     ADD TPL-CLAIMS (SUB6)   TO TPL-CLAIMS (SUB7).
 20923     ADD TPA-CLAIMS (SUB6)   TO TPA-CLAIMS (SUB7).
 20924
 20925 5899-ADD-PAGES-LEVELS-X.
 20926     EXIT.
 20927
 20928 5900-CLEAR-TOTAL-PAGES.
 20929
 20930     MOVE +0 TO TPL-ISS-PRM (SUB6)  TPA-ISS-PRM (SUB6)
 20931             TPL-CNC-PRM (SUB6)     TPA-CNC-PRM (SUB6)
 20932             TPL-ACCT-COM (SUB6)    TPA-ACCT-COM (SUB6)
 20933             TPL-CLAIMS (SUB6)      TPA-CLAIMS (SUB6).
 20934
 20935 5999-CLEAR-TOTAL-PAGES-X.
 20936     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 406
* ECS010MO.cbl
 20938******************************************************************
 20939***       T O T A L   P A G E   P R I N T   R O U T I N E      ***
 20940******************************************************************
 20941
 20942 6000-TOTAL-PAGE-HEADINGS.
 20943
 20944     MOVE TOTAL-PAGE-HD1 TO PRT.
 20945     PERFORM 8800-PRINT-ROUTINE.
 20946
 20947 6100-ACCT-TOTAL-HEADINGS.
 20948
 20949     MOVE TOTAL-PAGE-HD2 TO PRT.
 20950     MOVE '0' TO P-CTL.
 20951     PERFORM 8800-PRINT-ROUTINE.
 20952     MOVE TOTAL-PAGE-HD3 TO PRT.
 20953     MOVE ' ' TO P-CTL.
 20954     PERFORM 8800-PRINT-ROUTINE.
 20955     PERFORM 8800-PRINT-ROUTINE.
 20956     MOVE +81 TO LN-CNT.
 20957
 20958 6199-PAGE-HEADINGS-X.
 20959     EXIT.
 20960
 20961 6500-PRINT-TOTAL-PAGE.
 20962
 20963     MOVE SPACES             TO TOTAL-PAGE-DETAIL.
 20964     MOVE LIFE-OVERRIDE-L6   TO TPD-DESC.
 20965     MOVE TPL-ISS-PRM (SUB6) TO TPD-ISS-PRM.
 20966
 20967     IF SUB6 = 6 AND ME-DO-UPDATE
 20968         MOVE TPL-ISS-PRM (6) TO ME-010-PREM-L.
 20969
 20970     MOVE TPL-CNC-PRM (SUB6) TO TPD-CNC-PRM.
 20971
 20972     IF SUB6 = 6 AND ME-DO-UPDATE
 20973         MOVE TPL-CNC-PRM (6) TO ME-010-REF-L.
 20974
 20975     COMPUTE TPD-NET-PRM =
 20976         TPL-ISS-PRM (SUB6) - TPL-CNC-PRM (SUB6).
 20977
 20978     IF SUB6 = 6 AND ME-DO-UPDATE
 20979         SUBTRACT TPL-CNC-PRM (6) FROM TPL-ISS-PRM (6)
 20980         GIVING ME-010-NET-L.
 20981
 20982     MOVE TPL-ACCT-COM (SUB6) TO TPD-ACCT-COM.
 20983
 20984     IF SUB6 = 6 AND ME-DO-UPDATE
 20985         MOVE TPL-ACCT-COM (6) TO ME-010-COMM-L.
 20986
 20987     COMPUTE TPD-PREM-COMP =
 20988         TPL-ISS-PRM (SUB6) - TPL-CNC-PRM (SUB6)
 20989                            - TPL-ACCT-COM (SUB6).
 20990     MOVE TPL-CLAIMS (SUB6)   TO TPD-CLAIMS.
 20991
 20992     IF SUB6 = 6 AND ME-DO-UPDATE
 20993         MOVE TPL-CLAIMS (6) TO ME-010-PMT-L.
 20994
 20995     IF SUB6 = 6
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 407
* ECS010MO.cbl
 20996         MOVE TPL-CLAIMS (6)          TO WS-ME-BAL-AMT
 20997         MOVE WS-BALANCE-DESCRIPTION1 TO WS-ME-BAL-DESCRIP
 20998         WRITE ME-ECS010-BALANCE-REC  FROM WS-ME-BALANCE-REC
 20999     END-IF.
 21000
 21001     MOVE TOTAL-PAGE-DETAIL   TO PRT.
 21002     PERFORM 8800-PRINT-ROUTINE.
 21003     MOVE SPACES             TO TOTAL-PAGE-DETAIL.
 21004     MOVE AH-OVERRIDE-L6     TO TPD-DESC.
 21005     MOVE TPA-ISS-PRM (SUB6) TO TPD-ISS-PRM.
 21006     MOVE TPA-CNC-PRM (SUB6) TO TPD-CNC-PRM.
 21007
 21008     IF SUB6 = 6 AND ME-DO-UPDATE
 21009         MOVE TPA-ISS-PRM (6) TO ME-010-PREM-AH
 21010         MOVE TPA-CNC-PRM (6) TO ME-010-REF-AH.
 21011
 21012     COMPUTE TPD-NET-PRM =
 21013         TPA-ISS-PRM (SUB6) - TPA-CNC-PRM (SUB6).
 21014
 21015     IF SUB6 = 6 AND ME-DO-UPDATE
 21016         SUBTRACT TPA-CNC-PRM (6) FROM TPA-ISS-PRM (6)
 21017         GIVING ME-010-NET-AH.
 21018
 21019     MOVE TPA-ACCT-COM (SUB6) TO TPD-ACCT-COM.
 21020
 21021     IF SUB6 = 6 AND ME-DO-UPDATE
 21022         MOVE TPA-ACCT-COM (6) TO ME-010-COMM-AH.
 21023
 21024     COMPUTE TPD-PREM-COMP =
 21025         TPA-ISS-PRM (SUB6) - TPA-CNC-PRM (SUB6)
 21026                            - TPA-ACCT-COM (SUB6).
 21027     MOVE TPA-CLAIMS (SUB6)   TO TPD-CLAIMS.
 21028
 21029     IF SUB6 = 6 AND ME-DO-UPDATE
 21030         MOVE TPA-CLAIMS (6) TO ME-010-PMT-AH.
 21031
 21032     IF SUB6 = 6
 21033         MOVE TPA-CLAIMS (6)          TO WS-ME-BAL-AMT
 21034         MOVE WS-BALANCE-DESCRIPTION2 TO WS-ME-BAL-DESCRIP
 21035         WRITE ME-ECS010-BALANCE-REC  FROM WS-ME-BALANCE-REC
 21036     END-IF.
 21037
 21038     MOVE TOTAL-PAGE-DETAIL   TO PRT.
 21039     PERFORM 8800-PRINT-ROUTINE.
 21040
 21041     MOVE 'TOTAL' TO TPD-DESC.
 21042
 21043     COMPUTE TPD-ISS-PRM =
 21044         TPL-ISS-PRM (SUB6) + TPA-ISS-PRM (SUB6).
 21045
 21046     COMPUTE TPD-CNC-PRM =
 21047         TPL-CNC-PRM (SUB6) + TPA-CNC-PRM (SUB6).
 21048
 21049     COMPUTE TPD-NET-PRM =
 21050         TPL-ISS-PRM (SUB6) + TPA-ISS-PRM (SUB6)
 21051         - TPL-CNC-PRM (SUB6) - TPA-CNC-PRM (SUB6).
 21052
 21053     COMPUTE TPD-ACCT-COM =
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 408
* ECS010MO.cbl
 21054         TPL-ACCT-COM (SUB6) + TPA-ACCT-COM (SUB6).
 21055
 21056     COMPUTE TPD-PREM-COMP =
 21057         TPL-ISS-PRM (SUB6) + TPA-ISS-PRM (SUB6)
 21058         - TPL-CNC-PRM (SUB6) - TPA-CNC-PRM (SUB6)
 21059         - TPL-ACCT-COM (SUB6) - TPA-ACCT-COM (SUB6).
 21060
 21061     COMPUTE TPD-CLAIMS =
 21062         TPL-CLAIMS (SUB6) + TPA-CLAIMS (SUB6).
 21063
 21064     IF SV-LO-CERT = ZEROS  AND  SV-HI-CERT = ZEROS
 21065         NEXT SENTENCE
 21066     ELSE
 21067         MOVE SV-LO-CERT (6:6) TO TPD-LO-CERT
 21068         MOVE SV-HI-CERT (6:6) TO TPD-HI-CERT
 21069         MOVE ZEROS TO SV-LO-CERT  SV-HI-CERT.
 21070*        MOVE SV-LO-CERT (4:8)    TO TPD-LO-CERT
 21071*        MOVE SV-HI-CERT (4:8)    TO TPD-HI-CERT
 21072*        MOVE ZEROS               TO SV-LO-CERT
 21073*                                    SV-HI-CERT.
 21074
 21075     MOVE TOTAL-PAGE-DETAIL       TO PRT.
 21076     MOVE '0'                     TO P-CTL.
 21077     PERFORM 8800-PRINT-ROUTINE.
 21078     PERFORM 8800-PRINT-ROUTINE.
 21079
 21080 6599-TOTAL-PAGE-PRINT-X.
 21081     EXIT.
 21082*
 21083*
 21084*
 21085**START***********************************************************
 21086*      CUSTOM CODING FOR CLIENT "DMD"            PROJECT# 6475
 21087*            PARAGRAPHS  XXXX THRU 6700-COMM-EXIT
 21088******************************************************************
 21089*
 21090 6650-GET-RES-STATE-COMM.
 21091*6650-BROWSE-FORWARD.
 21092
 21093     IF DTE-CLIENT NOT = 'DMD'
 21094         GO TO 6700-COMM-EXIT.
 21095
 21096     MOVE CR-COMPANY-CD       TO WS-ERRESC-COMPANY-CD.
 21097     MOVE CR-CARRIER          TO WS-ERRESC-CARRIER.
 21098     MOVE CR-GROUPING         TO WS-ERRESC-GROUP.
 21099     MOVE CR-STATE            TO WS-ERRESC-STATE.
 21100     MOVE CR-ACCOUNT          TO WS-ERRESC-ACCOUNT.
 21101     MOVE WK-AGT              TO WS-ERRESC-AGENT.
 21102     MOVE CR-CERT-NO (1:2)    TO WS-ERRESC-RES-STATE.
 21103     MOVE CR-DT               TO WS-YYYYMMDD-DT.
 21104
 21105     MOVE WS-YYYYMMDD-DT      TO WS-ERRESC-EXPIRE-DT.
 21106
 21107*POSITION FILE AT STARTING KEY RECORD(COMPANY, CARRIER, GROUP, STA
 21108*ACCOUNT,AGENT, RESIDENT STATE) AND RESC-EXPIRE-DATE SET BY THE
 21109*VALUE OF PB-CERT-EFF-DT
 21110*
 21111     MOVE WS-ERRESC-KEY        TO ERRESC-RECORD-KEY.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 409
* ECS010MO.cbl
 21112
 21113     START ERRESC-IN KEY NOT LESS THAN ERRESC-RECORD-KEY.
 21114
 21115     IF ERRESC-FILE-STATUS NOT EQUAL '00'
 21116         GO TO 6700-COMM-EXIT.
 21117
 21118*GET RECORD WHERE POSITIONED
 21119
 21120 6650-READ-ERRESC-NEXT.
 21121     READ ERRESC-IN NEXT RECORD.
 21122
 21123     IF ERRESC-FILE-STATUS NOT EQUAL '00'
 21124         GO TO 6700-COMM-EXIT.
 21125
 21126*GOT GOOD RECORD ??    FIRST 32 POSITIONS MUST MATCH  !!!!!!
 21127
 21128     IF ERRESC-RECORD-KEY (1:32) EQUAL TO WS-ERRESC-KEY (1:32)
 21129        NEXT SENTENCE
 21130     ELSE
 21131         GO TO 6700-COMM-EXIT.
 21132
 21133     IF WS-YYYYMMDD-DT < RESC-EXPIRE-DATE
 21134         NEXT SENTENCE
 21135     ELSE
 21136         GO TO 6650-READ-ERRESC-NEXT.
 21137
 21138*  CR-DT  = WS-YYYYMMDD-DT
 21139*CHECK TO SEE IF CERTIFICATE EFFECTIVE DATE IS WITHIN ACCOUNT
 21140*RESIDENT STATE COMMISSION RECORD'S EFFECTIVE TIME PERIOD???
 21141
 21142     IF WS-YYYYMMDD-DT IS LESS THAN RESC-EFFECTIVE-DATE
 21143         GO TO 6700-COMM-EXIT.
 21144
 21145* SEARCH FOR MATCHING CATEGORY CODE ENTRY
 21146
 21147     MOVE ZEROS               TO WS-SUB WS-SUB1.
 21148
 21149     PERFORM 6680-SEARCH-CATEGORY THRU 6680-EXIT.
 21150
 21151     IF WS-SUB1 IS GREATER THAN ZERO
 21152         IF RESC-COMMISSION-PER (WS-SUB) NOT NUMERIC
 21153             PERFORM 6680-SET-TABLE-CODE
 21154         ELSE
 21155             PERFORM 6680-SET-COMMISSION.
 21156
 21157     GO TO 6700-COMM-EXIT.
 21158
 21159 6680-SET-TABLE-CODE.
 21160     IF RESC-COMMISSION-TAB (WS-SUB) EQUAL SPACES
 21161        MOVE ZEROS             TO WS-SUB1
 21162     ELSE
 21163* DEFAULT TO AH-COVERAGE TO READ COMMISSION TABLE(CTBL)
 21164* TO COMPUTE AH COMMISSION.
 21165        MOVE CR-AHTYP          TO CTBL-BEN-CODE
 21166        MOVE CR-AH-TERM        TO WS-COMM-TERM
 21167        MOVE AH-OVERRIDE-L1    TO CTBL-BEN-TYPE
 21168        MOVE RESC-COMMISSION-TAB (WS-SUB)
 21169                               TO CTBL-TABLE-CD
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 410
* ECS010MO.cbl
 21170        PERFORM 6680-READ-CTBL-TABLE
 21171        IF ERCTBL-FILE-STATUS NOT EQUAL '00'
 21172           MOVE ZEROS          TO WS-SUB1.
 21173
 21174 6680-READ-CTBL-TABLE.
 21175*
 21176* WHEN CR-AHTYP = ZEROS READ COMMISSION TABLE(CTBL)
 21177* TO COMPUTE LIFE COMMISSION
 21178
 21179     IF CR-AHTYP = ZERO
 21180        MOVE LIFE-OVERRIDE-L1  TO CTBL-BEN-TYPE
 21181        MOVE CR-LFTYP          TO CTBL-BEN-CODE
 21182        MOVE CR-LF-TERM        TO WS-COMM-TERM.
 21183
 21184     PERFORM 1300-READ-ERCTBL-FILE THRU 1399-READ-ERCTBL-X.
 21185
 21186     IF ERCTBL-FILE-STATUS EQUAL '00'
 21187* COMPUTE A-H COMMISSION WHEN CR-AHTYP IS NOT ZEROS
 21188        IF CR-AHTYP NOT = ZERO
 21189             COMPUTE COMM-CK-AMT = CR-AHAMT * CR-AH-TERM
 21190             MOVE CR-AH-TERM        TO WS-COMM-TERM
 21191             PERFORM 1400-GET-COMM-PERCENT THRU 1489-GET-PERCENT-X
 21192             MOVE WK-RATE           TO WS-COMMISSION
 21193                                       PB-I-AH-COMMISSION
 21194        ELSE
 21195* COMPUTE LIFE COMMISSION WHEN CR-AHTYP IS ZEROS
 21196             MOVE CR-LFAMT    TO COMM-CK-AMT
 21197             MOVE CR-LF-TERM  TO WS-COMM-TERM
 21198             PERFORM 1400-GET-COMM-PERCENT THRU 1489-GET-PERCENT-X
 21199             MOVE WK-RATE     TO WS-COMMISSION
 21200                                 PB-I-LIFE-COMMISSION.
 21201
 21202 6680-SET-COMMISSION.
 21203     IF RESC-COMMISSION-PER (WS-SUB) EQUAL ZEROS
 21204           MOVE ZEROS         TO WS-SUB1
 21205       ELSE
 21206           MOVE RESC-COMMISSION-PER (WS-SUB)
 21207                              TO WS-COMMISSION WK-RATE
 21208           IF CR-AHTYP NOT = ZERO
 21209                MOVE WS-COMMISSION TO PB-I-AH-COMMISSION
 21210           ELSE
 21211                MOVE WS-COMMISSION TO PB-I-LIFE-COMMISSION.
 21212
 21213 6680-SEARCH-CATEGORY.
 21214     ADD +1 TO WS-SUB.
 21215
 21216     IF WS-SUB IS GREATER THAN +12
 21217         GO TO 6680-EXIT.
 21218
 21219     IF CR-CERT-NO (4:1) = RESC-COVERAGE-CAT (WS-SUB)
 21220          MOVE WS-SUB         TO WS-SUB1
 21221          GO TO 6680-EXIT.
 21222
 21223     GO TO 6680-SEARCH-CATEGORY.
 21224
 21225 6680-EXIT.
 21226     EXIT.
 21227
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 411
* ECS010MO.cbl
 21228 6700-COMM-EXIT.
 21229     EXIT.
 21230*
 21231*END***************CUSTOM CODE FOR CLIENT "DMD"*************
 21232
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 412
* ECS010MO.cbl
 21234******************************************************************
 21235***         C L I E N T   B I L L I N G   R O U T I N E        ***
 21236******************************************************************
 21237
 21238 7000-CLIENT-BILLING-ROUTINE.
 21239*
 21240*
 21241* LEAVE THE ABOVE 2 LINES IN TO PREVENT LOSING THE LINE ABOVE
 21242
 21243     MOVE +0 TO BC-NET-WRIT BC-NET-WRIT-OB BC-NET-WRIT-SP
 21244                BC-G-ISS      BC-G-CNC   BC-G-CLM
 21245                BC-G-CRS      BC-G-CTN   BC-R-ISS      BC-R-CNC
 21246                BC-R-CLM      BC-R-CRS   BC-R-CTN      BC-COMM
 21247                BC-NEW-ACCTS  BC-ACCTS   BC-ACT-ACCTS
 21248                BC-G-CERTS    BC-G-A-CERTS  BC-R-CERTS
 21249                BC-R-A-CERTS  BC-ER-ACCTS   BC-CS-ACCTS.
 21250
 21251 7099-BILL-X.
 21252     EXIT.
 21253
 21254
 21255 7500-ADD-UP-REIN-CO.
 21256
 21257     IF RB-COMPANY (B-SUB) NOT = SPACES
 21258         ADD RB-COUNT (B-SUB) TO BC-CS-ACCTS.
 21259
 21260 7599-ADD-UP-REIN-X.
 21261     EXIT.
 21262
 21263 7900-CLEAR-BILLING-TABLE.
 21264
 21265     MOVE SPACES TO RB-COMPANY (B-SUB).
 21266     MOVE 0      TO RB-COUNT (B-SUB).
 21267
 21268 7999-CLEAR-BILLING-X.
 21269     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 413
* ECS010MO.cbl
 21271******************************************************************
 21272***         M I S C E L L A N E O U S   R O U T I N E S        ***
 21273******************************************************************
 21274
 21275 8000-DATE-CONVERT-ROUTINE.
 21276
 21277     CALL 'ELDATCX' USING DATE-CONVERSION-DATA.
 21278
 21279 8099-DATE-CONVERT-X.
 21280     EXIT.
 21281
 21282 8000R-CONVERT-STOP-DATE.
 21283
 21284     MOVE RWF-EP-STOP-DATE        TO DC-GREG-DATE-CYMD.
 21285     MOVE 'L'                     TO DC-OPTION-CODE.
 21286     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 21287     MOVE +0                      TO DC-ELAPSED-MONTHS.
 21288     MOVE -1                      TO DC-ELAPSED-DAYS.
 21289     MOVE '6'                     TO DC-OPTION-CODE.
 21290     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 21291     MOVE +0                      TO DC-ELAPSED-MONTHS
 21292                                     DC-ELAPSED-DAYS.
 21293     MOVE DC-BIN-DATE-2           TO DC-BIN-DATE-1.
 21294     MOVE ' '                     TO DC-OPTION-CODE.
 21295     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 21296
 21297     IF NO-CONVERSION-ERROR
 21298         MOVE DC-GREG-DATE-CYMD   TO EARNING-STOP-DATE
 21299     ELSE
 21300         DISPLAY 'ERROR OCCURED CONVERTING EARNING STOP '
 21301                 'DATE IN REIN TABLE: ' CR-REIN-TABLE
 21302                 '  STOP DATE: ' RWF-EP-STOP-DATE
 21303         MOVE 'ERROR OCCURED CONVERTING EARNING STOP DATE '
 21304                                  TO WS-ABEND-MESSAGE
 21305         MOVE DC-ERROR-CODE       TO WS-ABEND-FILE-STATUS
 21306         MOVE 4002                TO WS-ABEND-CODE
 21307         GO TO ABEND-PGM.
 21308
 21309 8099R-STOP-DATE-X.
 21310     EXIT.
 21311
 21312
 21313 8100-GET-RATE.
 21314
 21315     CALL 'ELRATEX' USING CALCULATION-PASS-AREA.
 21316
 21317 8199-GET-RATE-X.
 21318     EXIT.
 21319
 21320
 21321 8200-STATE-CODE-LOOKUP.
 21322
 21323     IF CLAS-INDEXS NOT GREATER CLAS-MAXS  AND
 21324        CLAS-INDEXS NOT = ZERO
 21325         IF STATE-L = STATE-SUB (CLAS-INDEXS)
 21326             GO TO 8299-STATE-LOOKUP-X.
 21327
 21328     MOVE CLAS-STARTS TO CLAS-INDEXS.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 414
* ECS010MO.cbl
 21329
 21330 8250-STATE-LOOKUP-LOOP.
 21331
 21332     IF CLAS-INDEXS GREATER CLAS-MAXS  OR  CLAS-INDEXS = ZERO
 21333         MOVE 0302 TO WS-ABEND-CODE
 21334         DISPLAY 'STATE CODE ' STATE-L ' NOT IN STATE TABLE'
 21335         DISPLAY '******************************'
 21336         DISPLAY '***** ERROR LOCATION 022 *****'
 21337         DISPLAY '******************************'
 21338         MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
 21339         GO TO ABEND-PGM.
 21340
 21341     IF STATE-L NOT = STATE-SUB (CLAS-INDEXS)
 21342         ADD +1 TO CLAS-INDEXS
 21343         GO TO 8250-STATE-LOOKUP-LOOP.
 21344
 21345 8299-STATE-LOOKUP-X.
 21346     EXIT.
 21347
 21348
 21349 8300-LIFE-TYPE-LOOKUP.
 21350
 21351     IF CLAS-INDEXL NOT GREATER CLAS-MAXL  AND
 21352        CLAS-INDEXL NOT = ZERO
 21353         IF CLAS-LOOK = CLAS-I-BEN (CLAS-INDEXL)
 21354             GO TO 8399-LIFE-LOOKUP-X.
 21355
 21356     MOVE CLAS-STARTL TO CLAS-INDEXL.
 21357
 21358 8350-LIFE-LOOKUP-LOOP.
 21359
 21360     IF CLAS-INDEXL GREATER CLAS-MAXL  OR  CLAS-INDEXL = ZERO
 21361         MOVE 0401 TO WS-ABEND-CODE
 21362         DISPLAY 'LIFE TYPE ' CLAS-LOOK ' NOT IN TYPE TABLE'
 21363         DISPLAY '    PENDING CONTROL = ' PENDING-MATCH-CONTROL
 21364         DISPLAY '       CERT CONTROL = ' CR-FULL-CONTROL
 21365         DISPLAY '******************************'
 21366         DISPLAY '***** ERROR LOCATION 023 *****'
 21367         DISPLAY '******************************'
 21368         MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
 21369         IF DTE-CLIENT = 'NCL'
 21370                      OR 'CID'
 21371             MOVE CLAS-STARTL      TO CLAS-INDEXL
 21372             MOVE '05'             TO CLAS-LOOK
 21373             GO TO 8350-LIFE-LOOKUP-LOOP
 21374         ELSE
 21375             GO TO ABEND-PGM.
 21376
 21377     IF CLAS-LOOK NOT = CLAS-I-BEN (CLAS-INDEXL)
 21378         ADD +1 TO CLAS-INDEXL
 21379         GO TO 8350-LIFE-LOOKUP-LOOP.
 21380
 21381     IF CLAS-I-EP (CLAS-INDEXL) = 'U'
 21382         MOVE 'R'                    TO CLAS-I-EP (CLAS-INDEXL).
 21383
 21384 8399-LIFE-LOOKUP-X.
 21385     EXIT.
 21386
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 415
* ECS010MO.cbl
 21387
 21388 8400-A-H-TYPE-LOOKUP.
 21389
 21390     IF CLAS-INDEXA NOT GREATER CLAS-MAXA  AND
 21391        CLAS-INDEXA NOT = ZERO
 21392         IF CLAS-LOOK = CLAS-I-BEN (CLAS-INDEXA)
 21393             GO TO 8499-A-H-LOOKUP-X.
 21394
 21395     MOVE CLAS-STARTA TO CLAS-INDEXA.
 21396
 21397 8450-A-H-LOOKUP-LOOP.
 21398
 21399     IF CLAS-INDEXA GREATER CLAS-MAXA  OR  CLAS-INDEXA = ZERO
 21400         MOVE 0402 TO WS-ABEND-CODE
 21401         DISPLAY 'A&H TYPE ' CLAS-LOOK ' NOT IN TYPE TABLE'
 21402         DISPLAY '    PENDING CONTROL = ' PENDING-MATCH-CONTROL
 21403         DISPLAY '       CERT CONTROL = ' CR-FULL-CONTROL
 21404         DISPLAY '******************************'
 21405         DISPLAY '***** ERROR LOCATION 024 *****'
 21406         DISPLAY '******************************'
 21407         MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
 21408         IF DTE-CLIENT = 'NCL'
 21409             MOVE CLAS-STARTA      TO CLAS-INDEXA
 21410             MOVE '05'             TO CLAS-LOOK
 21411             GO TO 8450-A-H-LOOKUP-LOOP
 21412         ELSE
 21413             GO TO ABEND-PGM.
 21414
 21415     IF CLAS-LOOK NOT = CLAS-I-BEN (CLAS-INDEXA)
 21416         ADD +1 TO CLAS-INDEXA
 21417         GO TO 8450-A-H-LOOKUP-LOOP.
 21418
 21419 8499-A-H-LOOKUP-X.
 21420     EXIT.
 21421
 21422 8500-REMAINING-TERM-ROUTINE.
 21423
 21424     MOVE ZEROS                      TO CP-REMAINING-TERM
 21425                                        CP-REMAINING-TERM-1
 21426                                        CP-REMAINING-TERM-2
 21427                                        CP-REMAINING-TERM-3
 21428                                        CP-RETURN-CODE
 21429                                        CP-RETURN-CODE-2
 21430                                        REM-TRM1
 21431                                        REM-TRM2
 21432                                        REM-TRM3
 21433                                        TEM-TRM1.
 21434     MOVE SPACES                     TO CP-REM-TERM-METHOD.
 21435
 21436     MOVE CR-DT                      TO DC-GREG-DATE-CYMD.
 21437     MOVE 'L'                        TO DC-OPTION-CODE.
 21438     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 21439
 21440     IF  NO-CONVERSION-ERROR
 21441         MOVE DC-BIN-DATE-1          TO CP-CERT-EFF-DT
 21442     ELSE
 21443         MOVE 'ERROR OCCURED CONVERTING CR-DT'
 21444                                     TO WS-ABEND-MESSAGE
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 416
* ECS010MO.cbl
 21445         MOVE DC-ERROR-CODE          TO WS-ABEND-FILE-STATUS
 21446         MOVE 3001                   TO WS-ABEND-CODE
 21447         GO TO ABEND-PGM.
 21448
 21449     MOVE LOW-VALUES                 TO CP-FIRST-PAY-DATE
 21450
 21451     IF  CR-LOAN-1ST-PMT-DT NOT NUMERIC
 21452         MOVE ZEROS                  TO CR-LOAN-1ST-PMT-DT.
 21453
 21454     IF  CR-LOAN-1ST-PMT-DT NOT = ZEROS
 21455         MOVE CR-LOAN-1ST-PMT-DT     TO DC-GREG-DATE-1-YMD
 21456         MOVE ZEROS                  TO DC-ELAPSED-MONTHS
 21457                                        DC-ELAPSED-DAYS
 21458         MOVE '3'                    TO DC-OPTION-CODE
 21459         PERFORM 8000-DATE-CONVERT-ROUTINE THRU
 21460                 8099-DATE-CONVERT-X
 21461         IF  NO-CONVERSION-ERROR
 21462             MOVE DC-BIN-DATE-1      TO CP-FIRST-PAY-DATE
 21463         ELSE
 21464             MOVE ZEROS              TO CR-LOAN-1ST-PMT-DT.
 21465
 21466     IF  CP-FIRST-PAY-DATE LESS THAN CP-CERT-EFF-DT
 21467         MOVE ZEROS                  TO CR-LOAN-1ST-PMT-DT.
 21468
 21469     IF  CR-LOAN-1ST-PMT-DT = ZEROS
 21470         MOVE CP-CERT-EFF-DT         TO DC-BIN-DATE-1
 21471         MOVE +1                     TO DC-ELAPSED-MONTHS
 21472         MOVE ZEROS                  TO DC-ELAPSED-DAYS
 21473         MOVE '6'                    TO DC-OPTION-CODE
 21474         PERFORM 8000-DATE-CONVERT-ROUTINE THRU
 21475                 8099-DATE-CONVERT-X
 21476         IF  NO-CONVERSION-ERROR
 21477             MOVE DC-BIN-DATE-2      TO CP-FIRST-PAY-DATE
 21478             MOVE DC-GREG-DATE-1-YMD TO CR-LOAN-1ST-PMT-DT
 21479         ELSE
 21480             MOVE 'ERROR OCCURED DETERMINING 1ST PAY DATE '
 21481                                     TO WS-ABEND-MESSAGE
 21482             MOVE DC-ERROR-CODE      TO WS-ABEND-FILE-STATUS
 21483             MOVE 3002               TO WS-ABEND-CODE
 21484             GO TO ABEND-PGM.
 21485
 21486     MOVE VALUATION-DT               TO DC-GREG-DATE-CYMD.
 21487     MOVE 'L'                        TO DC-OPTION-CODE.
 21488     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 21489
 21490     IF  NO-CONVERSION-ERROR
 21491         MOVE DC-BIN-DATE-1          TO CP-VALUATION-DT
 21492     ELSE
 21493         DISPLAY 'ERROR CONVERTING VALUATION DATE, SOURCE - '
 21494             W-VAL-ERROR (W-VAL-SOURCE)
 21495         DISPLAY '   KEY - ' CR-FULL-CONTROL
 21496             ' VALUATION DT - ' VALUATION-DT ' ERROR - '
 21497             DC-ERROR-CODE
 21498         DISPLAY '   STATUS: ' CR-ENTRY-STATUS ' LF: ' CR-LFTYP
 21499         ' ' CR-LF-CURRENT-STATUS '-' CR-LF-STATUS-AT-CANCEL '-'
 21500             CR-LF-STATUS-AT-DEATH ' AH: ' CR-AHTYP ' '
 21501             CR-AH-CURRENT-STATUS '-' CR-AH-STATUS-AT-CANCEL '-'
 21502             CR-AH-STATUS-AT-SETTLEMENT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 417
* ECS010MO.cbl
 21503*        MOVE 'ERROR OCCURED CONVERTING VALUATION DATE'
 21504*                                    TO WS-ABEND-MESSAGE
 21505*        MOVE DC-ERROR-CODE          TO WS-ABEND-FILE-STATUS
 21506*        MOVE 3003                   TO WS-ABEND-CODE
 21507*        GO TO ABEND-PGM.
 21508
 21509     MOVE STATE-SUB (CLAS-INDEXS)    TO CP-STATE.
 21510     MOVE STATE-ABBR (CLAS-INDEXS)   TO CP-STATE-STD-ABBRV.
 21511     MOVE '3'                        TO CP-PROCESS-TYPE.
 21512     MOVE DTE-CLASIC-COMPANY-CD      TO CP-COMPANY-CD.
 21513     MOVE DTE-CLIENT                 TO CP-COMPANY-ID.
 21514     MOVE SPACES                     TO CP-ACCT-FLD-5.
 21515
 21516*    MOVE CLAS-CO-REM-TERM-CALC (W-NDX)
 21517*                                    TO CP-REM-TERM-METHOD.
 21518
 21519     IF  DTE-CLIENT = 'FIM'
 21520         MOVE '5'                    TO CP-REM-TERM-METHOD.
 21521
 21522     IF DTE-CLIENT = 'FLI' OR 'FLU'
 21523         IF WE-LF-AH = AH-OVERRIDE-L1
 21524             MOVE '2'                TO CP-REM-TERM-METHOD
 21525         ELSE
 21526             IF CR-LFTYP = '01' OR '03'
 21527                 MOVE '4'            TO CP-REM-TERM-METHOD
 21528             ELSE
 21529                 IF CR-LFTYP = '02' OR '04'
 21530                     MOVE '2'        TO CP-REM-TERM-METHOD.
 21531
 21532     IF  DTE-CLIENT = 'CSL'
 21533         IF  CR-CARRIER = '2'
 21534             IF  CR-LFTYP = '07' OR  '08'
 21535                 MOVE '4'            TO CP-REM-TERM-METHOD.
 21536
 21537     IF  DTE-CLIENT = 'POS'
 21538         IF  CR-CARRIER = '1'
 21539             MOVE '1'                TO CP-REM-TERM-METHOD
 21540         ELSE
 21541             MOVE '2'                TO CP-REM-TERM-METHOD.
 21542
 21543     IF  CP-REM-TERM-METHOD = SPACES OR LOW-VALUES
 21544         MOVE DTE-REM-TRM            TO CP-REM-TERM-METHOD.
 21545
 21546     IF  WE-LF-AH EQUAL AH-OVERRIDE-L1
 21547         GO TO 8540-CALC-REM-TERM-AH.
 21548
 21549 8520-CALC-REM-TERM-LIFE.
 21550
 21551     MOVE CLAS-I-EP (CLAS-INDEXL)    TO CP-EARNING-METHOD.
 21552     MOVE CLAS-I-RL-AH (CLAS-INDEXL) TO CP-BENEFIT-TYPE.
 21553     MOVE CLAS-I-BAL (CLAS-INDEXL)   TO CP-SPECIAL-CALC-CD.
 21554*    MOVE ORIG-TERM                  TO CP-ORIGINAL-TERM.
 21555     MOVE CR-LF-TERM                 TO CP-ORIGINAL-TERM
 21556                                        CP-LOAN-TERM.
 21557
 21558     IF  CLAS-I-EP (CLAS-INDEXL) EQUAL 'B'
 21559             AND
 21560         CLAS-I-CALC-TYPE (CLAS-INDEXL) NOT EQUAL 'L'
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 418
* ECS010MO.cbl
 21561         ADD +1                      TO CP-ORIGINAL-TERM
 21562                                        CP-LOAN-TERM.
 21563
 21564     IF  CP-TERM-IS-DAYS
 21565         MOVE CR-LF-TERM-IN-DAYS     TO CP-TERM-OR-EXT-DAYS
 21566     ELSE
 21567         MOVE ZEROS                  TO CP-TERM-OR-EXT-DAYS.
 21568
 21569     MOVE DTE-REM-TRM-CALC-OPTION    TO CP-REM-TRM-CALC-OPTION.
 21570
 21571     IF  CP-ORIGINAL-TERM NOT GREATER THAN ZEROS
 21572         ADD +1                      TO W-ORGTRM-0-LF
 21573         DISPLAY 'LF TRM NOT GREATER THAN +0 - '
 21574             CR-FULL-CONTROL
 21575         GO TO 8599-REM-TERM-X.
 21576
 21577     CALL 'ELRTRMX' USING CALCULATION-PASS-AREA.
 21578
 21579     IF  CP-RETURN-CODE NOT EQUAL ZEROS
 21580         ADD +1                      TO W-RET-CODE-LF
 21581         GO TO 8599-REM-TERM-X.
 21582*
 21583*        MOVE 'ERROR OCCURED REMAINING TERM CALCULATION - LF'
 21584*                                    TO WS-ABEND-MESSAGE
 21585*        MOVE CP-RETURN-CODE         TO WS-ABEND-FILE-STATUS
 21586*        MOVE 2002                   TO WS-ABEND-CODE
 21587*        GO TO ABEND-PGM.
 21588
 21589     IF  CLAS-I-EP (CLAS-INDEXL) EQUAL 'B'
 21590             AND
 21591         CLAS-I-CALC-TYPE (CLAS-INDEXL) NOT EQUAL 'L'
 21592         MOVE CP-REMAINING-TERM-2    TO W-BAL-REMTRM
 21593         COMPUTE CP-REMAINING-TERM-1 = CP-REMAINING-TERM-1 - 1
 21594         COMPUTE CP-REMAINING-TERM-2 = CP-REMAINING-TERM-2 - 1.
 21595
 21596     IF  CP-REMAINING-TERM-1 NEGATIVE
 21597         MOVE ZEROS                  TO CP-REMAINING-TERM-1.
 21598
 21599     IF  CP-REMAINING-TERM-2 NEGATIVE
 21600         MOVE ZEROS                  TO CP-REMAINING-TERM-2.
 21601
 21602     IF DTE-CLIENT = 'NCL'
 21603         MOVE CP-REMAINING-TERM-1    TO CP-REMAINING-TERM-2
 21604                                        CP-REMAINING-TERM-3.
 21605
 21606     MOVE CP-REMAINING-TERM-1        TO REM-TRM1.
 21607     MOVE CP-REMAINING-TERM-2        TO REM-TRM2.
 21608     MOVE CP-REMAINING-TERM-3        TO REM-TRM3.
 21609     MOVE CP-ODD-DAYS                TO TEM-TRM1.
 21610
 21611     GO TO 8599-REM-TERM-X.
 21612
 21613 8520-EXIT.
 21614     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 419
* ECS010MO.cbl
 21616 8540-CALC-REM-TERM-AH.
 21617
 21618     MOVE CLAS-I-EP (CLAS-INDEXA)    TO CP-EARNING-METHOD.
 21619     MOVE CLAS-I-RL-AH (CLAS-INDEXA) TO CP-BENEFIT-TYPE.
 21620     MOVE CLAS-I-BAL (CLAS-INDEXA)   TO CP-SPECIAL-CALC-CD.
 21621     MOVE CR-AH-TERM                 TO CP-ORIGINAL-TERM
 21622                                        CP-LOAN-TERM.
 21623     MOVE ZEROS                      TO CP-TERM-OR-EXT-DAYS.
 21624
 21625     MOVE DTE-REM-TRM-CALC-OPTION    TO CP-REM-TRM-CALC-OPTION.
 21626
 21627     IF  CP-ORIGINAL-TERM NOT GREATER THAN ZEROS
 21628         DISPLAY 'AH TRM NOT GREATER THAN +0 - '
 21629             CR-FULL-CONTROL
 21630         ADD +1                      TO W-ORGTRM-0-AH
 21631         GO TO 8599-REM-TERM-X.
 21632
 21633     CALL 'ELRTRMX' USING CALCULATION-PASS-AREA.
 21634
 21635     IF  CP-RETURN-CODE NOT EQUAL ZEROS
 21636         ADD +1                      TO W-RET-CODE-AH
 21637         GO TO 8599-REM-TERM-X.
 21638*
 21639*        MOVE 'ERROR OCCURED REMAINING TERM CALCULATION - AH'
 21640*                                    TO WS-ABEND-MESSAGE
 21641*        MOVE CP-RETURN-CODE         TO WS-ABEND-FILE-STATUS
 21642*        MOVE 2001                   TO WS-ABEND-CODE
 21643*        GO TO ABEND-PGM.
 21644
 21645     IF DTE-CLIENT = 'NCL'
 21646         MOVE CP-REMAINING-TERM-1    TO CP-REMAINING-TERM-2
 21647                                        CP-REMAINING-TERM-3.
 21648
 21649     MOVE CP-REMAINING-TERM-1        TO REM-TRM1.
 21650     MOVE CP-REMAINING-TERM-2        TO REM-TRM2.
 21651     MOVE CP-REMAINING-TERM-3        TO REM-TRM3.
 21652     MOVE CP-ODD-DAYS                TO TEM-TRM1.
 21653
 21654 8599-REM-TERM-X.
 21655     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 420
* ECS010MO.cbl
 21657
 21658******************************************************************
 21659***     " D I S P L A Y "  P R I N T   R O U T I N E           ***
 21660******************************************************************
 21661
 21662 8600-DISPLAY-PRT.
 21663
 21664     IF  DIS-LINE-CNT GREATER THAN 59
 21665         PERFORM 8600-DISPLAY-HD THRU
 21666             8600-HD-EXIT.
 21667
 21668     ADD  1  TO DIS-LINE-CNT.
 21669     WRITE DISPLAY-REC FROM DISPLAY-LINE.
 21670     MOVE  SPACES TO DISPLAY-REC
 21671                     DISPLAY-LINE.
 21672
 21673 8600-DISPLAY-EXIT.
 21674     EXIT.
 21675
 21676
 21677 8600-DISPLAY-HD.
 21678
 21679     MOVE '1'  TO  DISPLAY-CC.
 21680     MOVE ZEROS TO DIS-LINE-CNT.
 21681     WRITE DISPLAY-REC FROM DISPLAY-HD-1.
 21682     ADD +1 TO DIS-LINE-CNT.
 21683     MOVE ' '  TO  DISPLAY-CC.
 21684     MOVE SPACES TO DISPLAY-REC.
 21685     WRITE DISPLAY-REC.
 21686     ADD +1 TO DIS-LINE-CNT.
 21687     MOVE WS-CURRENT-DATE  TO  DIS-DATE.
 21688     WRITE DISPLAY-REC FROM DISPLAY-HD-2.
 21689     ADD +1 TO DIS-LINE-CNT.
 21690     MOVE SPACES TO DISPLAY-REC.
 21691     ADD +1 TO DIS-LINE-CNT.
 21692     WRITE DISPLAY-REC.
 21693
 21694 8600-HD-EXIT.
 21695     EXIT.
 21696
 21697******************************************************************
 21698***      T R A N S A C T I O N   P R I N T   R O U T I N E     ***
 21699******************************************************************
 21700
 21701 8600-SETUP-DETAIL-LINE.
 21702
 21703     MOVE SPACES                TO TR-DTL2.
 21704
 21705     MOVE CR-CERT-NO            TO TRD-CERT.
 21706     MOVE CR-YR                 TO TRD-ISYR.
 21707     MOVE CR-MO                 TO TRD-ISMO.
 21708     MOVE CR-DA                 TO TRD-ISDA.
 21709     MOVE CR-AGE                TO TRD-AGE.
 21710
 21711 8689-SETUP-DETAIL-X.
 21712     EXIT.
 21713
 21714 8690-PRINT-DETAIL-LINE.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 421
* ECS010MO.cbl
 21715
 21716     IF LN-CNT GREATER THAN LN-MX
 21717         PERFORM 8700-PRINT-REPORT-HEADINGS THRU
 21718                 8799-PRT-HEADINGS-X.
 21719     MOVE TRD-CERT TO SV-TRD-CERT.
 21720     MOVE TRD-ISDT TO SV-TRD-ISDT.
 21721
 21722     IF TRD-CERT = LST-TRD-CERT  AND  TRD-ISDT = LST-TRD-ISDT
 21723         MOVE SPACES TO TRD-CERT  TRD-ISDT  TRD-AGE.
 21724
 21725     MOVE SV-TRD-CERT TO LST-TRD-CERT.
 21726     MOVE SV-TRD-ISDT TO LST-TRD-ISDT.
 21727     MOVE TR-DTL TO PRT.
 21728
 21729     IF NOT WS-CHANGE-REC
 21730         MOVE '/'                TO TRD-IS-S1  TRD-IS-S2
 21731     ELSE
 21732         MOVE 'N'                TO  WS-CHANGE-REC-SW.
 21733
 21734     PERFORM 8800-PRINT-ROUTINE.
 21735
 21736 8699-PRT-DETAIL-X.
 21737     EXIT.
 21738
 21739 8700-PRINT-REPORT-HEADINGS.
 21740     ADD +1 TO PG-CNT.
 21741     MOVE PG-CNT TO TR-PG.
 21742     MOVE +0 TO LN-CNT.
 21743     MOVE TR-HD-1 TO PRT.
 21744     PERFORM 8800-PRINT-ROUTINE.
 21745     MOVE TR-HD-2 TO PRT.
 21746     PERFORM 8800-PRINT-ROUTINE.
 21747     MOVE TR-HD-3 TO PRT.
 21748     PERFORM 8800-PRINT-ROUTINE.
 21749     ADD +1 TO LN-CNT.
 21750
 21751 8725-PRT-ACCT-HEADING.
 21752     MOVE TR-HD-4 TO PRT.
 21753     PERFORM 8800-PRINT-ROUTINE.
 21754     MOVE TR-HD-5 TO PRT.
 21755     PERFORM 8800-PRINT-ROUTINE.
 21756
 21757 8750-PRT-RANGE-HEADING.
 21758     MOVE TR-HD-6 TO PRT.
 21759     PERFORM 8800-PRINT-ROUTINE.
 21760
 21761 8775-PRT-COLUMN-HEADINGS.
 21762     MOVE TR-HD-7 TO PRT.
 21763     PERFORM 8800-PRINT-ROUTINE.
 21764     MOVE TR-HD-8 TO PRT.
 21765     PERFORM 8800-PRINT-ROUTINE.
 21766     MOVE TR-HD-9 TO PRT.
 21767     PERFORM 8800-PRINT-ROUTINE.
 21768     PERFORM 8800-PRINT-ROUTINE.
 21769
 21770 8799-PRT-HEADINGS-X.
 21771     EXIT.
 21772
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 422
* ECS010MO.cbl
 21773 8800-PRINT-ROUTINE.
 21774     MOVE P-CTL TO X.
 21775     PERFORM 8900-PRINT-A-LINE THRU 8999-PRT-LINE-X.
 21776     ADD +1 TO LN-CNT.
 21777     MOVE SPACES TO PRT.
 21778
 21779 8900-PRINT-A-LINE.
*21780                             COPY ELCPRT2.
 21781******************************************************************04/15/98
 21782*                                                                *ELCPRT2
 21783*                                                                *ELCPRT2
 21784*                            ELCPRT2                             *   LV005
 21785*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**5
 21786*                            VMOD=2.002                          *   CL**5
 21787*                                                                *   CL**4
 21788******************************************************************   CL**4
 21789                                                                     CL**4
 21790     IF DTE-FICH NOT = SPACE AND                                     CL**4
 21791        FICH-OPEN    = SPACE                                         CL**4
 21792         MOVE 'X'                TO  FICH-OPEN                       CL**4
 21793         OPEN OUTPUT FICH.                                           CL**4
 21794                                                                     CL**4
 21795     IF DTE-FICH NOT = SPACE                                         CL**4
 21796         MOVE X                  TO  P-CTL                           CL**4
 21797         WRITE FICH-REC FROM PRT.                                    CL**4
 21798                                                                     CL**4
 21799     IF DTE-FICH = SPACE OR '2'                                      CL**4
 21800       MOVE X                    TO  P-CTL                           CL**4
 21801       IF P-CTL = ' '                                                CL**4
 21802         WRITE PRT AFTER ADVANCING 1 LINE                            CL**4
 21803       ELSE                                                          CL**4
 21804         IF P-CTL = '0'                                              CL**4
 21805           WRITE PRT AFTER ADVANCING 2 LINES                         CL**4
 21806         ELSE                                                        CL**4
 21807           IF P-CTL = '-'                                            CL**4
 21808             WRITE PRT AFTER ADVANCING 3 LINES                       CL**4
 21809           ELSE                                                      CL**4
 21810             WRITE PRT AFTER ADVANCING PAGE.                         CL**4
 21811                                                                     CL**4
 21812******************************************************************   CL**4
 21813
 21814 8999-PRT-LINE-X.
 21815     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 423
* ECS010MO.cbl
 21817******************************************************************
 21818***          E N D   O F   J O B   P R O C E S S I N G         ***
 21819******************************************************************
 21820
 21821 9910-EOJ-1.
 21822     IF TR-CNT = ZERO
 21823         IF (DTE-PGM-OPT = '2' OR '3') OR
 21824            (DTE-CLIENT = 'LGX' OR 'FNA' OR 'HER' OR 'NCL' OR
 21825                          'ITY' OR 'DAC' OR 'FLC')
 21826             NEXT SENTENCE
 21827         ELSE
 21828             MOVE 'NO INPUT TRANSACTIONS' TO WS-ABEND-MESSAGE
 21829             MOVE 0703                    TO WS-ABEND-CODE
 21830             DISPLAY '******************************'
 21831             DISPLAY '***** ERROR LOCATION 025 *****'
 21832             DISPLAY '******************************'
 21833             MOVE WS-ABEND-CODE           TO WS-RETURN-CODE
 21834             GO TO ABEND-PGM.
 21835
 21836     MOVE '*'         TO TRANS-EOF-FLAG.
 21837     MOVE HIGH-VALUES TO PENDING-MATCH-CONTROL.
 21838
 21839     IF EOF-ON-CERT
 21840         PERFORM 0400-WRITE-CERT-RECORD THRU 0499-WRITE-CERT-X
 21841         GO TO 9940-EOJ-FIN.
 21842
 21843     GO TO 0330-MATCH-PENDING-TO-CERT.
 21844
 21845 9920-EOJ-2.
 21846     MOVE '*'         TO CERT-EOF-FLAG.
 21847     MOVE HIGH-VALUES TO CIR-CONTROL.
 21848
 21849     IF EOF-ON-TRANS
 21850         PERFORM 0400-WRITE-CERT-RECORD THRU 0499-WRITE-CERT-X
 21851         MOVE HIGH-VALUES TO CERTIFICATE-RECORD
 21852         GO TO 9940-EOJ-FIN.
 21853
 21854     GO TO 0299-READ-CERT-X.
 21855
 21856 9930-EOJ-3.
 21857     IF PROCESSING-COMPLETED
 21858         GO TO 9950-EOJ-FIN-GO.
 21859
 21860     DISPLAY 'MISSING ACCOUNT MASTER - '  CR-ACCT-CONTROL.
 21861     MOVE 'MISSING ACCOUNT MASTER'
 21862                               TO WS-ABEND-MESSAGE.
 21863     MOVE 0302                 TO WS-ABEND-CODE.
 21864     DISPLAY '******************************'
 21865     DISPLAY '***** ERROR LOCATION 026 *****'
 21866     DISPLAY '******************************'
 21867     MOVE WS-ABEND-CODE        TO WS-RETURN-CODE.
 21868     GO TO ABEND-PGM.
 21869
 21870 9940-EOJ-FIN.
 21871     MOVE '*'        TO PROCESSING-FLAG.
 21872     MOVE LOW-VALUES TO CERTIFICATE-RECORD.
 21873
 21874     PERFORM 0100-ACCT-MASTER-READ-ROUTINE THRU
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 424
* ECS010MO.cbl
 21875             0199-READ-ACCOUNT-X.
 21876     GO TO 9940-EOJ-FIN.
 21877
 21878 9950-EOJ-FIN-GO.
 21879     PERFORM 5500-FINAL-BREAK THRU 5599-FINAL-BREAK-X.
 21880     MOVE HIGH-VALUES TO ACCOUNT-MASTER.
 21881*
 21882*
 21883* LEAVE THE ABOVE 2 LINE IN TO PREVENT LOSING THE LINE ABOVE
 21884     PERFORM 7000-CLIENT-BILLING-ROUTINE THRU 7099-BILL-X.
 21885
 21886 9960-NO-TOTS.
 21887
 21888     MOVE +15                    TO LN-CNT.
 21889     MOVE CMIN-CNT               TO TTL-PT-CNT.
 21890     IF ME-DO-UPDATE
 21891         MOVE CMIN-CNT           TO ME-010-CERT-IN.
 21892
 21893     MOVE CMIN-CNT                TO WS-ME-BAL-AMT.
 21894     MOVE WS-BALANCE-DESCRIPTION3 TO WS-ME-BAL-DESCRIP.
 21895     WRITE ME-ECS010-BALANCE-REC  FROM WS-ME-BALANCE-REC.
 21896
 21897
 21898     MOVE 'INPUT CERTIFICATE MASTER RECORDS' TO TTL-HD-DS.
 21899     MOVE TR-TTL-HD              TO PRT.
 21900     PERFORM 8800-PRINT-ROUTINE.
 21901     ADD +1 TO LN-CNT.
 21902     MOVE TR-CNT                TO TTL-PT-CNT.
 21903     MOVE 'TRANSACTION RECORDS' TO TTL-HD-DS.
 21904     MOVE TR-TTL-HD             TO PRT.
 21905     PERFORM 8800-PRINT-ROUTINE.
 21906     ADD +1 TO LN-CNT.
 21907
 21908     IF DUP-CNT = ZERO
 21909         GO TO 9969-CHECK-MISMATCHED-TOTS.
 21910
 21911     MOVE DUP-CNT                 TO TTL-PT-CNT.
 21912
 21913     IF ME-DO-UPDATE
 21914         MOVE DUP-CNT            TO ME-010-DUP-ISS.
 21915
 21916     MOVE 'DUPE ISSUES DROPPED  ' TO TTL-HD-DS.
 21917     MOVE TR-TTL-HD               TO PRT.
 21918     PERFORM 8800-PRINT-ROUTINE.
 21919     PERFORM 8800-PRINT-ROUTINE.
 21920     ADD +1 TO LN-CNT.
 21921
 21922     MOVE '1'                           TO  DTL-REC-TYPE.
 21923     MOVE 'ISS'                         TO  DTL-REC-TYPE-DESC.
 21924     MOVE SPACES                        TO  DTL-CERT-IN-CONTROL.
 21925     MOVE 'DUPLICATE CERTIFICATE RECORD WILL BE'
 21926                                        TO  DTL-CERT-OUT-CONTROL.
 21927     MOVE SPACES                        TO  MISMATCH-DETAIL-2.
 21928     MOVE ' LIFE PREMIUM = '            TO  MD2-LF-PREM-DESC.
 21929     MOVE ' A&H  PREMIUM = '            TO  MD2-LF-ALT-PREM-DESC.
 21930
 21931     MOVE +1 TO SUB3.
 21932 9965-PRT-DUPES.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 425
* ECS010MO.cbl
 21933
 21934     IF  MISMATCH-LINE-COUNT GREATER THAN +56
 21935         ADD +1                  TO  MISMATCH-PAGE-NUMBER
 21936         MOVE MISMATCH-PAGE-NUMBER
 21937                                 TO  TR-PG
 21938         MOVE MISMATCH-HEADING-1 TO  MISMATCH-RPT
 21939         MOVE MR-CTL             TO  X
 21940         MOVE X TO LCP-ASA
 21941         PERFORM LCP-WRITE-POS-MISMATCH-RPT
 21942             THRU LCP-WRITE-END-MISMATCH-RPT
 21943         MOVE TR-HD-2            TO  MISMATCH-RPT
 21944         MOVE MR-CTL             TO  X
 21945         MOVE X TO LCP-ASA
 21946         PERFORM LCP-WRITE-POS-MISMATCH-RPT
 21947             THRU LCP-WRITE-END-MISMATCH-RPT
 21948         MOVE TR-HD-3            TO  MISMATCH-RPT
 21949         MOVE MR-CTL             TO  X
 21950         MOVE X TO LCP-ASA
 21951         PERFORM LCP-WRITE-POS-MISMATCH-RPT
 21952             THRU LCP-WRITE-END-MISMATCH-RPT
 21953         MOVE MISMATCH-HEADING-2 TO  MISMATCH-RPT
 21954         MOVE MR-CTL             TO  X
 21955         MOVE X TO LCP-ASA
 21956         PERFORM LCP-WRITE-POS-MISMATCH-RPT
 21957             THRU LCP-WRITE-END-MISMATCH-RPT
 21958         MOVE +6                 TO  MISMATCH-LINE-COUNT.
 21959
 21960     MOVE DUPE-ENTRY (SUB3)             TO  DTL-MATCH-CONTROL.
 21961
 21962     MOVE MISMATCH-DETAIL               TO  MISMATCH-RPT.
 21963     MOVE MR-CTL                        TO  X.
 21964     ADD +2                             TO  MISMATCH-LINE-COUNT.
 21965
 21966     MOVE X TO LCP-ASA
 21967     PERFORM LCP-WRITE-POS-MISMATCH-RPT
 21968         THRU LCP-WRITE-END-MISMATCH-RPT.
 21969
 21970     MOVE  DUPE-LF-PRM (SUB3)           TO  MD2-LF-PREM.
 21971     MOVE  DUPE-AH-PRM (SUB3)           TO  MD2-LF-ALT-PREM.
 21972
 21973     ADD  DUPE-LF-PRM (SUB3)            TO  W-MM-LF-PRM.
 21974     ADD  DUPE-AH-PRM (SUB3)            TO  W-MM-AH-PRM.
 21975
 21976     MOVE DUPE-STATUS (SUB3)            TO  MD2-AH-PREM-DESC.
 21977     IF  DUPE-STATUS (SUB3)  =  '2'
 21978         MOVE  'POLICY IS PENDING '     TO  MD2-AH-PREM-DESC.
 21979     IF  DUPE-STATUS (SUB3)  =  '5'
 21980         MOVE  'POLICY IS REISSUE '     TO  MD2-AH-PREM-DESC.
 21981     IF  DUPE-STATUS (SUB3)  =  'M'
 21982         MOVE  'POLICY IS MONTHLY '     TO  MD2-AH-PREM-DESC.
 21983     IF  DUPE-STATUS (SUB3)  =  '9'
 21984         MOVE  'POLICY REIN ONLY  '     TO  MD2-AH-PREM-DESC.
 21985     IF  DUPE-STATUS (SUB3)  =  'D'
 21986         MOVE  'POLICY IS DECLINED'     TO  MD2-AH-PREM-DESC.
 21987     IF  DUPE-STATUS (SUB3)  =  'V'
 21988         MOVE  'POLICY IS VOIDED  '     TO  MD2-AH-PREM-DESC.
 21989     IF  DUPE-STATUS (SUB3)  =  'P'
 21990         MOVE  'POLICY PREM ACCTNG'     TO  MD2-AH-PREM-DESC.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 426
* ECS010MO.cbl
 21991
 21992     MOVE MISMATCH-DETAIL-2             TO  MISMATCH-RPT.
 21993     MOVE MR-CTL                        TO  X.
 21994     ADD +1                             TO  MISMATCH-LINE-COUNT.
 21995
 21996     MOVE X TO LCP-ASA
 21997     PERFORM LCP-WRITE-POS-MISMATCH-RPT
 21998         THRU LCP-WRITE-END-MISMATCH-RPT.
 21999
 22000     IF SUB3 LESS THAN DUP-CNT
 22001         ADD +1 TO SUB3
 22002         GO TO 9965-PRT-DUPES.
 22003
 22004 9969-CHECK-MISMATCHED-TOTS.
 22005
 22006     IF W-MM-LF-PRM = ZEROS  AND
 22007        W-MM-AH-PRM = ZEROS  AND
 22008        W-MM-LF-RFD = ZEROS  AND
 22009        W-MM-AH-RFD = ZEROS  AND
 22010        W-MM-LF-CLM = ZEROS  AND
 22011        W-MM-AH-CLM = ZEROS
 22012         GO TO 9970-FIN-TOTS.
 22013
 22014     MOVE SPACES                        TO  MISMATCH-RPT.
 22015     MOVE '0'                           TO  MR-CTL  X.
 22016     MOVE X TO LCP-ASA
 22017     PERFORM LCP-WRITE-POS-MISMATCH-RPT
 22018         THRU LCP-WRITE-END-MISMATCH-RPT.
 22019
 22020     MOVE 'TOT LF PREMS  = '            TO  MD2-LF-PREM-DESC.
 22021     MOVE 'TOT AH PREMS  = '            TO  MD2-LF-ALT-PREM-DESC.
 22022     MOVE ' TOTAL PREMIUMS = '          TO  MD2-AH-PREM-DESC.
 22023
 22024     MOVE W-MM-LF-PRM                   TO MD2-LF-PREM.
 22025     MOVE W-MM-AH-PRM                   TO MD2-LF-ALT-PREM.
 22026     COMPUTE MD2-AH-PREM = W-MM-LF-PRM + W-MM-AH-PRM.
 22027
 22028     MOVE MISMATCH-DETAIL-2             TO  MISMATCH-RPT.
 22029     MOVE '0'                           TO  MR-CTL  X.
 22030     MOVE X TO LCP-ASA
 22031     PERFORM LCP-WRITE-POS-MISMATCH-RPT
 22032         THRU LCP-WRITE-END-MISMATCH-RPT.
 22033
 22034     MOVE 'TOT LF RFNDS  = '            TO  MD2-LF-PREM-DESC.
 22035     MOVE 'TOT AH RFNDS  = '            TO  MD2-LF-ALT-PREM-DESC.
 22036     MOVE ' TOTAL REFUNDS  = '          TO  MD2-AH-PREM-DESC.
 22037
 22038     MOVE W-MM-LF-RFD                   TO MD2-LF-PREM.
 22039     MOVE W-MM-AH-RFD                   TO MD2-LF-ALT-PREM.
 22040     COMPUTE MD2-AH-PREM = W-MM-LF-RFD + W-MM-AH-RFD.
 22041
 22042     MOVE MISMATCH-DETAIL-2             TO  MISMATCH-RPT.
 22043     MOVE '0'                           TO  MR-CTL  X.
 22044     MOVE X TO LCP-ASA
 22045     PERFORM LCP-WRITE-POS-MISMATCH-RPT
 22046         THRU LCP-WRITE-END-MISMATCH-RPT.
 22047
 22048     MOVE 'TOT LF CLAIMS = '            TO  MD2-LF-PREM-DESC.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 427
* ECS010MO.cbl
 22049     MOVE 'TOT AH CLAIMS = '            TO  MD2-LF-ALT-PREM-DESC.
 22050     MOVE ' TOTAL CLAIMS   = '          TO  MD2-AH-PREM-DESC.
 22051
 22052     MOVE W-MM-LF-CLM                   TO MD2-LF-PREM.
 22053     MOVE W-MM-AH-CLM                   TO MD2-LF-ALT-PREM.
 22054     COMPUTE MD2-AH-PREM = W-MM-LF-CLM + W-MM-AH-CLM.
 22055
 22056     MOVE MISMATCH-DETAIL-2             TO  MISMATCH-RPT.
 22057     MOVE '0'                           TO  MR-CTL  X.
 22058     MOVE X TO LCP-ASA
 22059     PERFORM LCP-WRITE-POS-MISMATCH-RPT
 22060         THRU LCP-WRITE-END-MISMATCH-RPT.
 22061
 22062 9970-FIN-TOTS.
 22063
 22064     MOVE CMOT-CNT                TO TTL-PT-CNT.
 22065
 22066     IF ME-DO-UPDATE
 22067         MOVE CMOT-CNT           TO ME-010-CERT-OUT.
 22068
 22069     MOVE 'OUTPUT CERTIFICATE MASTER RECORDS' TO TTL-HD-DS.
 22070     MOVE TR-TTL-HD               TO PRT.
 22071     PERFORM 8800-PRINT-ROUTINE.
 22072
 22073     MOVE CMOT-CNT                TO WS-ME50-BAL-AMT-LOW.
 22074     MOVE CMOT-CNT                TO WS-ME50-BAL-AMT-HIGH.
 22075     MOVE WS-BAL50-DESCRIPTION    TO WS-ME50-BAL-DESCRIP.
 22076     WRITE ME50-ECS010-BALANCE-REC FROM WS-ME50-BALANCE-REC.
 22077
 22078     MOVE DE-CNT                  TO TTL-PT-CNT.
 22079     MOVE 'DETAIL EXTRACT RECORDS' TO TTL-HD-DS.
 22080     MOVE TR-TTL-HD               TO PRT.
 22081     PERFORM 8800-PRINT-ROUTINE.
 22082
 22083     MOVE EP-CNT                  TO TTL-PT-CNT.
 22084     MOVE 'SUMMARY EXTRACTS RECORDS' TO TTL-HD-DS.
 22085     MOVE TR-TTL-HD               TO PRT.
 22086     PERFORM 8800-PRINT-ROUTINE.
 22087     PERFORM 8800-PRINT-ROUTINE.
 22088
 22089     MOVE ERACCTT-READS           TO TTL-PT-CNT.
 22090     MOVE 'VSAM ACCOUNT MASTER FILE READS' TO TTL-HD-DS.
 22091     MOVE TR-TTL-HD               TO PRT.
 22092     PERFORM 8800-PRINT-ROUTINE.
 22093
 22094     MOVE ERRTBL-READS            TO TTL-PT-CNT.
 22095     MOVE 'VSAM REINSURANCE TABLE FILE READS' TO TTL-HD-DS.
 22096     MOVE TR-TTL-HD               TO PRT.
 22097     PERFORM 8800-PRINT-ROUTINE.
 22098
 22099     MOVE ERCTBL-READS            TO TTL-PT-CNT.
 22100     MOVE 'VSAM COMMISSION TABLE FILE READS' TO TTL-HD-DS.
 22101     MOVE TR-TTL-HD               TO PRT.
 22102     PERFORM 8800-PRINT-ROUTINE.
 22103
 22104     IF  DTE-OPT-RESERVE-METHOD-UNAUTH
 22105         GO TO 9990-FINAL-CLOSE.
 22106
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 428
* ECS010MO.cbl
 22107**** MOST OF THE LINES WRITTEN BELOW ARE USED TO VERIFY
 22108**** REPORT TOTALS, ETC, THAT CANNOT BE VERIFIED ANY OTHER
 22109**** WAY.  MOST OF THESE FIELDS WILL BE DELETED WHEN ALL
 22110**** PILOT COMPANIES HAVE BEEN SUCCESSFULLY PROCESSED.
 22111
 22112     MOVE W-POLICY-ACTIVE-CTR     TO TTL-PT-CNT.
 22113     MOVE 'ACTIVE POLICIES'       TO TTL-HD-DS.
 22114     MOVE TR-TTL-HD               TO PRT.
 22115     PERFORM 8800-PRINT-ROUTINE.
 22116
 22117     MOVE W-POLICY-INACTIVE-CTR   TO TTL-PT-CNT.
 22118     MOVE 'INACTIVE POLICIES'     TO TTL-HD-DS.
 22119     MOVE TR-TTL-HD               TO PRT.
 22120     PERFORM 8800-PRINT-ROUTINE.
 22121
 22122     MOVE W-POLICY-REISSUE-CTR    TO TTL-PT-CNT.
 22123     MOVE 'REISSUE POLICIES'      TO TTL-HD-DS.
 22124     MOVE TR-TTL-HD               TO PRT.
 22125     PERFORM 8800-PRINT-ROUTINE.
 22126
 22127     MOVE W-POLICY-REIN-CTR       TO TTL-PT-CNT.
 22128     MOVE 'REINSURANCE ONLY POLICIES' TO TTL-HD-DS.
 22129     MOVE TR-TTL-HD               TO PRT.
 22130     PERFORM 8800-PRINT-ROUTINE.
 22131
 22132     MOVE W-POL-ISSUES            TO TTL-PT-CNT.
 22133     MOVE 'ISSUE TRANSACTIONS'    TO TTL-HD-DS.
 22134     MOVE TR-TTL-HD               TO PRT.
 22135     PERFORM 8800-PRINT-ROUTINE.
 22136
 22137     MOVE W-AH-ISSUES             TO TTL-PT-CNT.
 22138     MOVE 'AH ISSUE TRANSACTIONS' TO TTL-HD-DS.
 22139     MOVE TR-TTL-HD               TO PRT.
 22140     PERFORM 8800-PRINT-ROUTINE.
 22141
 22142     MOVE W-LF-ISSUES             TO TTL-PT-CNT.
 22143     MOVE 'LF ISSUE TRANSACTIONS' TO TTL-HD-DS.
 22144     MOVE TR-TTL-HD               TO PRT.
 22145     PERFORM 8800-PRINT-ROUTINE.
 22146
 22147     MOVE W-PENDING-CLMS          TO TTL-PT-CNT.
 22148     MOVE 'CLAIM TRANSACTIONS'    TO TTL-HD-DS.
 22149     MOVE TR-TTL-HD               TO PRT.
 22150     PERFORM 8800-PRINT-ROUTINE.
 22151
 22152     MOVE W-AH-CLAIMS             TO TTL-PT-CNT.
 22153     MOVE 'AH CLAIMS TRANSACTIONS' TO TTL-HD-DS.
 22154     MOVE TR-TTL-HD               TO PRT.
 22155     PERFORM 8800-PRINT-ROUTINE.
 22156
 22157     MOVE W-LF-CLAIMS             TO TTL-PT-CNT.
 22158     MOVE 'LF CLAIMS TRANSACTIONS' TO TTL-HD-DS.
 22159     MOVE TR-TTL-HD               TO PRT.
 22160     PERFORM 8800-PRINT-ROUTINE.
 22161
 22162     MOVE W-AH-RESERVES           TO TTL-PT-CNT.
 22163     MOVE 'AH RESERVES TRANSACTIONS' TO TTL-HD-DS.
 22164     MOVE TR-TTL-HD               TO PRT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 429
* ECS010MO.cbl
 22165     PERFORM 8800-PRINT-ROUTINE.
 22166
 22167     MOVE W-LF-RESERVES           TO TTL-PT-CNT.
 22168     MOVE 'LF RESERVES TRANSACTIONS' TO TTL-HD-DS.
 22169     MOVE TR-TTL-HD               TO PRT.
 22170     PERFORM 8800-PRINT-ROUTINE.
 22171
 22172     MOVE W-AH-ACTIVE             TO TTL-PT-CNT.
 22173     MOVE 'AH RECORDS ACTIVE '    TO TTL-HD-DS.
 22174     MOVE TR-TTL-HD               TO PRT.
 22175     PERFORM 8800-PRINT-ROUTINE.
 22176
 22177     MOVE W-AH-INACTIVE           TO TTL-PT-CNT.
 22178     MOVE 'AH RECORDS INACTIVE'   TO TTL-HD-DS.
 22179     MOVE TR-TTL-HD               TO PRT.
 22180     PERFORM 8800-PRINT-ROUTINE.
 22181
 22182     MOVE W-AH-REISSUE            TO TTL-PT-CNT.
 22183     MOVE 'AH REISSUE REJECTS'    TO TTL-HD-DS.
 22184     MOVE TR-TTL-HD               TO PRT.
 22185     PERFORM 8800-PRINT-ROUTINE.
 22186
 22187     MOVE W-AH-REIN               TO TTL-PT-CNT.
 22188     MOVE 'AH REIN ONLY      '    TO TTL-HD-DS.
 22189     MOVE TR-TTL-HD               TO PRT.
 22190     PERFORM 8800-PRINT-ROUTINE.
 22191
 22192     MOVE W-AH-CALC-B             TO TTL-PT-CNT.
 22193     MOVE 'AH CALC B REJECTS'     TO TTL-HD-DS.
 22194     MOVE TR-TTL-HD               TO PRT.
 22195     PERFORM 8800-PRINT-ROUTINE.
 22196
 22197     MOVE W-AHTYP-99              TO TTL-PT-CNT.
 22198     MOVE 'AH TYPE CHANGED TO 99' TO TTL-HD-DS.
 22199     MOVE TR-TTL-HD               TO PRT.
 22200     PERFORM 8800-PRINT-ROUTINE.
 22201
 22202     MOVE W-ORGTRM-0-AH           TO TTL-PT-CNT.
 22203     MOVE 'AH ORIGINAL TERM = 0 ' TO TTL-HD-DS.
 22204     MOVE TR-TTL-HD               TO PRT.
 22205     PERFORM 8800-PRINT-ROUTINE.
 22206
 22207     MOVE W-RET-CODE-AH           TO TTL-PT-CNT.
 22208     MOVE 'AH RET CODE TERM = 0 ' TO TTL-HD-DS.
 22209     MOVE TR-TTL-HD               TO PRT.
 22210     PERFORM 8800-PRINT-ROUTINE.
 22211
 22212     MOVE W-AH-REMTERM-0          TO TTL-PT-CNT.
 22213     MOVE 'AH REMAINING TERM = 0' TO TTL-HD-DS.
 22214     MOVE TR-TTL-HD               TO PRT.
 22215     PERFORM 8800-PRINT-ROUTINE.
 22216
 22217     MOVE W-AH-DATA-USED          TO TTL-PT-CNT.
 22218     MOVE 'AH RECORDS ACCEPTED DURING PROCESSING' TO TTL-HD-DS.
 22219     MOVE TR-TTL-HD               TO PRT.
 22220     PERFORM 8800-PRINT-ROUTINE.
 22221
 22222     MOVE W-LF-ACTIVE             TO TTL-PT-CNT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 430
* ECS010MO.cbl
 22223     MOVE 'LF RECORDS ACTIVE '    TO TTL-HD-DS.
 22224     MOVE TR-TTL-HD               TO PRT.
 22225     PERFORM 8800-PRINT-ROUTINE.
 22226
 22227     MOVE W-LF-INACTIVE           TO TTL-PT-CNT.
 22228     MOVE 'LF RECORDS INACTIVE'   TO TTL-HD-DS.
 22229     MOVE TR-TTL-HD               TO PRT.
 22230     PERFORM 8800-PRINT-ROUTINE.
 22231
 22232     MOVE W-LF-BALLOON            TO TTL-PT-CNT.
 22233     MOVE 'LF BALLOON REJECTS'    TO TTL-HD-DS.
 22234     MOVE TR-TTL-HD               TO PRT.
 22235     PERFORM 8800-PRINT-ROUTINE.
 22236
 22237     MOVE W-LF-REISSUE            TO TTL-PT-CNT.
 22238     MOVE 'LF REISSUE REJECTS'    TO TTL-HD-DS.
 22239     MOVE TR-TTL-HD               TO PRT.
 22240     PERFORM 8800-PRINT-ROUTINE.
 22241
 22242     MOVE W-LF-REIN               TO TTL-PT-CNT.
 22243     MOVE 'LF REIN ONLY      '    TO TTL-HD-DS.
 22244     MOVE TR-TTL-HD               TO PRT.
 22245     PERFORM 8800-PRINT-ROUTINE.
 22246
 22247     MOVE W-LF-CALC-B             TO TTL-PT-CNT.
 22248     MOVE 'LF CALC B REJECTS'     TO TTL-HD-DS.
 22249     MOVE TR-TTL-HD               TO PRT.
 22250     PERFORM 8800-PRINT-ROUTINE.
 22251
 22252     MOVE W-ORGTRM-0-LF           TO TTL-PT-CNT.
 22253     MOVE 'LF ORIGINAL TERM = 0 ' TO TTL-HD-DS.
 22254     MOVE TR-TTL-HD               TO PRT.
 22255     PERFORM 8800-PRINT-ROUTINE.
 22256
 22257     MOVE W-RET-CODE-LF           TO TTL-PT-CNT.
 22258     MOVE 'LF RET CODE TERM = 0 ' TO TTL-HD-DS.
 22259     MOVE TR-TTL-HD               TO PRT.
 22260     PERFORM 8800-PRINT-ROUTINE.
 22261
 22262     MOVE W-LF-REMTERM-0          TO TTL-PT-CNT.
 22263     MOVE 'LF REMTERM = 0 REJECTS' TO TTL-HD-DS.
 22264     MOVE TR-TTL-HD               TO PRT.
 22265     PERFORM 8800-PRINT-ROUTINE.
 22266
 22267     MOVE W-LF-REMAMT-0           TO TTL-PT-CNT.
 22268     MOVE 'LF REMAMT = 0 REJECTS' TO TTL-HD-DS.
 22269     MOVE TR-TTL-HD               TO PRT.
 22270     PERFORM 8800-PRINT-ROUTINE.
 22271
 22272     MOVE W-LFTYP-99              TO TTL-PT-CNT.
 22273     MOVE 'LF TYPE CHANGED TO 99' TO TTL-HD-DS.
 22274     MOVE TR-TTL-HD               TO PRT.
 22275     PERFORM 8800-PRINT-ROUTINE.
 22276
 22277     MOVE W-LF-DATA-USED          TO TTL-PT-CNT.
 22278     MOVE 'LF RECORDS ACCEPTED DURING PROCESSING' TO TTL-HD-DS.
 22279     MOVE TR-TTL-HD               TO PRT.
 22280     PERFORM 8800-PRINT-ROUTINE.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 431
* ECS010MO.cbl
 22281
 22282     MOVE W-EPEC-EP-IN            TO TTL-PT-CNT.
 22283     MOVE 'AH EARNED PREMIUM LAST 90 DAYS - DET ' TO TTL-HD-DS.
 22284     MOVE TR-TTL-HD               TO PRT.
 22285     PERFORM 8800-PRINT-ROUTINE.
 22286
 22287     MOVE W-EPEC-EP               TO TTL-PT-CNT.
 22288     MOVE 'AH EARNED PREMIUM LAST 90 DAYS       ' TO TTL-HD-DS.
 22289     MOVE TR-TTL-HD               TO PRT.
 22290     PERFORM 8800-PRINT-ROUTINE.
 22291
 22292     MOVE W-EPEC-EP-2             TO TTL-PT-CNT.
 22293     MOVE 'AH EARNED PREMIUM 90 DAYS AGO        ' TO TTL-HD-DS.
 22294     MOVE TR-TTL-HD               TO PRT.
 22295     PERFORM 8800-PRINT-ROUTINE.
 22296
 22297     MOVE W-EP-LESS-THAN-0        TO TTL-PT-CNT.
 22298     MOVE 'AH RECORDS WITH 90 DAY EP < +0       ' TO TTL-HD-DS.
 22299     MOVE TR-TTL-HD               TO PRT.
 22300     PERFORM 8800-PRINT-ROUTINE.
 22301
 22302     MOVE W-EPEC-EP-1             TO TTL-PT-CNT.
 22303     MOVE 'AH EARNED PREMIUM TODAY              ' TO TTL-HD-DS.
 22304     MOVE TR-TTL-HD               TO PRT.
 22305     PERFORM 8800-PRINT-ROUTINE.
 22306
 22307     MOVE W-AH-CLAIM-CTR          TO TTL-PT-CNT.
 22308     MOVE 'AH COVERAGES WITH QUALIFIED CLAIMS'
 22309                                  TO TTL-HD-DS.
 22310     MOVE TR-TTL-HD               TO PRT.
 22311     PERFORM 8800-PRINT-ROUTINE.
 22312
 22313     MOVE W-AH-CLAIM-EP           TO TTL-PT-CNT.
 22314     MOVE 'AH EARNED PREM WITH QUALIFIED CLAIMS'
 22315                                  TO TTL-HD-DS.
 22316     MOVE TR-TTL-HD               TO PRT.
 22317     PERFORM 8800-PRINT-ROUTINE.
 22318
 22319     MOVE W-CLAIMS-MADE-PAID-IN   TO TTL-PT-CNT.
 22320     MOVE 'AH CLAIMS MADE AND PAID LAST 90 DAYS- DET'
 22321                                  TO TTL-HD-DS.
 22322     MOVE TR-TTL-HD               TO PRT.
 22323     PERFORM 8800-PRINT-ROUTINE.
 22324
 22325     MOVE W-CLAIMS-MADE-PAID      TO TTL-PT-CNT.
 22326     MOVE 'AH CLAIMS MADE AND PAID LAST 90 DAYS'
 22327                                  TO TTL-HD-DS.
 22328     MOVE TR-TTL-HD               TO PRT.
 22329     PERFORM 8800-PRINT-ROUTINE.
 22330
 22331     MOVE W-CLM-EXCEPT-CNT        TO TTL-PT-CNT.
 22332     MOVE 'AH CLAIMS CALCD. USING ITD AMOUNT'
 22333                                  TO TTL-HD-DS.
 22334     MOVE TR-TTL-HD               TO PRT.
 22335     PERFORM 8800-PRINT-ROUTINE.
 22336
 22337     MOVE W-CLM-EXCEPT-AMT        TO TTL-PT-CNT.
 22338     MOVE 'AH CLAIMS AMT USING ITD AMOUNT'
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 432
* ECS010MO.cbl
 22339                                  TO TTL-HD-DS.
 22340     MOVE TR-TTL-HD               TO PRT.
 22341     PERFORM 8800-PRINT-ROUTINE.
 22342
 22343     MOVE W-AH-IBNR-1             TO TTL-PT-CNT.
 22344     MOVE 'A&H IBNR-1'            TO TTL-HD-DS.
 22345     MOVE TR-TTL-HD               TO PRT.
 22346     PERFORM 8800-PRINT-ROUTINE.
 22347
 22348     MOVE W-AH-IBNR-2             TO TTL-PT-CNT.
 22349     MOVE 'A&H IBNR-2'            TO TTL-HD-DS.
 22350     MOVE TR-TTL-HD               TO PRT.
 22351     PERFORM 8800-PRINT-ROUTINE.
 22352
 22353     MOVE W-LIFE-IBNR-IN          TO TTL-PT-CNT.
 22354     MOVE 'LIFE IBNR - DETAIL'    TO TTL-HD-DS.
 22355     MOVE TR-TTL-HD               TO PRT.
 22356     PERFORM 8800-PRINT-ROUTINE.
 22357
 22358     MOVE W-LIFE-IBNR             TO TTL-PT-CNT.
 22359     MOVE 'LIFE IBNR'             TO TTL-HD-DS.
 22360     MOVE TR-TTL-HD               TO PRT.
 22361     PERFORM 8800-PRINT-ROUTINE.
 22362
 22363     MOVE W-LIFE-REMAINING-AMT    TO TTL-PT-CNT.
 22364     MOVE 'LIFE REMAINING-AMT '   TO TTL-HD-DS.
 22365     MOVE TR-TTL-HD               TO PRT.
 22366     PERFORM 8800-PRINT-ROUTINE.
 22367
 22368     MOVE W-01-REMAMT             TO TTL-PT-CNT.
 22369     MOVE '01 REMAINING-AMT '     TO TTL-HD-DS.
 22370     MOVE TR-TTL-HD               TO PRT.
 22371     PERFORM 8800-PRINT-ROUTINE.
 22372
 22373     MOVE W-01-DATA-USED          TO TTL-PT-CNT.
 22374     MOVE '01 CERT COUNT    '     TO TTL-HD-DS.
 22375     MOVE TR-TTL-HD               TO PRT.
 22376     PERFORM 8800-PRINT-ROUTINE.
 22377
 22378     MOVE W-02-REMAMT             TO TTL-PT-CNT.
 22379     MOVE '02 REMAINING-AMT '     TO TTL-HD-DS.
 22380     MOVE TR-TTL-HD               TO PRT.
 22381     PERFORM 8800-PRINT-ROUTINE.
 22382
 22383     MOVE W-02-DATA-USED          TO TTL-PT-CNT.
 22384     MOVE '02 CERT COUNT    '     TO TTL-HD-DS.
 22385     MOVE TR-TTL-HD               TO PRT.
 22386     PERFORM 8800-PRINT-ROUTINE.
 22387
 22388     MOVE W-03-REMAMT             TO TTL-PT-CNT.
 22389     MOVE '03 REMAINING-AMT '     TO TTL-HD-DS.
 22390     MOVE TR-TTL-HD               TO PRT.
 22391     PERFORM 8800-PRINT-ROUTINE.
 22392
 22393     MOVE W-03-DATA-USED          TO TTL-PT-CNT.
 22394     MOVE '03 CERT COUNT    '     TO TTL-HD-DS.
 22395     MOVE TR-TTL-HD               TO PRT.
 22396     PERFORM 8800-PRINT-ROUTINE.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 433
* ECS010MO.cbl
 22397
 22398     MOVE W-04-REMAMT             TO TTL-PT-CNT.
 22399     MOVE '04 REMAINING-AMT '     TO TTL-HD-DS.
 22400     MOVE TR-TTL-HD               TO PRT.
 22401     PERFORM 8800-PRINT-ROUTINE.
 22402
 22403     MOVE W-04-DATA-USED          TO TTL-PT-CNT.
 22404     MOVE '04 CERT COUNT    '     TO TTL-HD-DS.
 22405     MOVE TR-TTL-HD               TO PRT.
 22406     PERFORM 8800-PRINT-ROUTINE.
 22407
 22408     MOVE W-05-REMAMT             TO TTL-PT-CNT.
 22409     MOVE '05 REMAINING-AMT '     TO TTL-HD-DS.
 22410     MOVE TR-TTL-HD               TO PRT.
 22411     PERFORM 8800-PRINT-ROUTINE.
 22412
 22413     MOVE W-05-DATA-USED          TO TTL-PT-CNT.
 22414     MOVE '05 CERT COUNT    '     TO TTL-HD-DS.
 22415     MOVE TR-TTL-HD               TO PRT.
 22416     PERFORM 8800-PRINT-ROUTINE.
 22417
 22418     MOVE W-06-REMAMT             TO TTL-PT-CNT.
 22419     MOVE '06 REMAINING-AMT '     TO TTL-HD-DS.
 22420     MOVE TR-TTL-HD               TO PRT.
 22421     PERFORM 8800-PRINT-ROUTINE.
 22422
 22423     MOVE W-06-DATA-USED          TO TTL-PT-CNT.
 22424     MOVE '06 CERT COUNT    '     TO TTL-HD-DS.
 22425     MOVE TR-TTL-HD               TO PRT.
 22426     PERFORM 8800-PRINT-ROUTINE.
 22427
 22428     MOVE W-30-REMAMT             TO TTL-PT-CNT.
 22429     MOVE '30 REMAINING-AMT '     TO TTL-HD-DS.
 22430     MOVE TR-TTL-HD               TO PRT.
 22431     PERFORM 8800-PRINT-ROUTINE.
 22432
 22433     MOVE W-30-DATA-USED          TO TTL-PT-CNT.
 22434     MOVE '30 CERT COUNT    '     TO TTL-HD-DS.
 22435     MOVE TR-TTL-HD               TO PRT.
 22436     PERFORM 8800-PRINT-ROUTINE.
 22437
 22438     MOVE W-31-REMAMT             TO TTL-PT-CNT.
 22439     MOVE '31 REMAINING-AMT '     TO TTL-HD-DS.
 22440     MOVE TR-TTL-HD               TO PRT.
 22441     PERFORM 8800-PRINT-ROUTINE.
 22442
 22443     MOVE W-31-DATA-USED          TO TTL-PT-CNT.
 22444     MOVE '31 CERT COUNT    '     TO TTL-HD-DS.
 22445     MOVE TR-TTL-HD               TO PRT.
 22446     PERFORM 8800-PRINT-ROUTINE.
 22447
 22448     MOVE W-XX-REMAMT             TO TTL-PT-CNT.
 22449     MOVE 'XX REMAINING-AMT '     TO TTL-HD-DS.
 22450     MOVE TR-TTL-HD               TO PRT.
 22451     PERFORM 8800-PRINT-ROUTINE.
 22452
 22453     MOVE W-XX-DATA-USED          TO TTL-PT-CNT.
 22454     MOVE 'XX CERT COUNT    '     TO TTL-HD-DS.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 434
* ECS010MO.cbl
 22455     MOVE TR-TTL-HD               TO PRT.
 22456     PERFORM 8800-PRINT-ROUTINE.
 22457
 22458     MOVE W-1-EP                  TO TTL-PT-CNT.
 22459     MOVE 'TYPE 1 EP        '     TO TTL-HD-DS.
 22460     MOVE TR-TTL-HD               TO PRT.
 22461     PERFORM 8800-PRINT-ROUTINE.
 22462
 22463     MOVE W-P-EP                  TO TTL-PT-CNT.
 22464     MOVE 'TYPE P EP        '     TO TTL-HD-DS.
 22465     MOVE TR-TTL-HD               TO PRT.
 22466     PERFORM 8800-PRINT-ROUTINE.
 22467
 22468     MOVE W-M-EP                  TO TTL-PT-CNT.
 22469     MOVE 'TYPE M EP        '     TO TTL-HD-DS.
 22470     MOVE TR-TTL-HD               TO PRT.
 22471     PERFORM 8800-PRINT-ROUTINE.
 22472
 22473     MOVE W-R-EP                  TO TTL-PT-CNT.
 22474     MOVE 'TYPE R EP        '     TO TTL-HD-DS.
 22475     MOVE TR-TTL-HD               TO PRT.
 22476     PERFORM 8800-PRINT-ROUTINE.
 22477
 22478     MOVE W-WY-EP                 TO TTL-PT-CNT.
 22479     MOVE 'EP FOR STATE WY  '     TO TTL-HD-DS.
 22480     MOVE TR-TTL-HD               TO PRT.
 22481     PERFORM 8800-PRINT-ROUTINE.
 22482
 22483     MOVE W-VA-EP                 TO TTL-PT-CNT.
 22484     MOVE 'EP FOR STATE VA  '     TO TTL-HD-DS.
 22485     MOVE TR-TTL-HD               TO PRT.
 22486     PERFORM 8800-PRINT-ROUTINE.
 22487
 22488     MOVE W-OTHERS-COUNT          TO TTL-PT-CNT.
 22489     MOVE 'AH COUNT OF OTHERS'    TO TTL-HD-DS.
 22490     MOVE TR-TTL-HD               TO PRT.
 22491     PERFORM 8800-PRINT-ROUTINE.
 22492
 22493     MOVE W-RTRM-0-CLMAMT         TO TTL-PT-CNT.
 22494     MOVE 'CLM AMT OF THOSE CERTS WITH RTRM=0'    TO TTL-HD-DS.
 22495     MOVE TR-TTL-HD               TO PRT.
 22496     PERFORM 8800-PRINT-ROUTINE.
 22497
 22498     MOVE W-RTRM-EP-1             TO TTL-PT-CNT.
 22499     MOVE 'EP1 OF THOSE CERTS WITH RTRM=0'    TO TTL-HD-DS.
 22500     MOVE TR-TTL-HD               TO PRT.
 22501     PERFORM 8800-PRINT-ROUTINE.
 22502
 22503     MOVE W-RTRM-EP-2             TO TTL-PT-CNT.
 22504     MOVE 'EP2 OF THOSE CERTS WITH RTRM=0'    TO TTL-HD-DS.
 22505     MOVE TR-TTL-HD               TO PRT.
 22506     PERFORM 8800-PRINT-ROUTINE.
 22507
 22508     MOVE W-RTRM-EP               TO TTL-PT-CNT.
 22509     MOVE 'EP OF THOSE CERTS WITH RTRM=0'    TO TTL-HD-DS.
 22510     MOVE TR-TTL-HD               TO PRT.
 22511     PERFORM 8800-PRINT-ROUTINE.
 22512
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 435
* ECS010MO.cbl
 22513     MOVE W-AH-IBNR-1             TO TTL-PT-CNT.
 22514     MOVE 'IBNR1 FROM EQUATION 1' TO TTL-HD-DS.
 22515     MOVE TR-TTL-HD               TO PRT.
 22516     PERFORM 8800-PRINT-ROUTINE.
 22517
 22518     MOVE W-AH-IBNR-1-CNT         TO TTL-PT-CNT.
 22519     MOVE 'REC CNT FROM EQUATION 1' TO TTL-HD-DS.
 22520     MOVE TR-TTL-HD               TO PRT.
 22521     PERFORM 8800-PRINT-ROUTINE.
 22522
 22523     MOVE W-AH-IBNR-2             TO TTL-PT-CNT.
 22524     MOVE 'IBNR2 FROM EQUATION 2' TO TTL-HD-DS.
 22525     MOVE TR-TTL-HD               TO PRT.
 22526     PERFORM 8800-PRINT-ROUTINE.
 22527
 22528     MOVE W-AH-IBNR-2-CNT         TO TTL-PT-CNT.
 22529     MOVE 'REC CNT FROM EQUATION 2' TO TTL-HD-DS.
 22530     MOVE TR-TTL-HD               TO PRT.
 22531     PERFORM 8800-PRINT-ROUTINE.
 22532
 22533 9990-FINAL-CLOSE.
*22534                             COPY ELCPRTC.
 22535******************************************************************04/15/98
 22536*                                                                *ELCPRTC
 22537*                                                                *ELCPRTC
 22538*                            ELCPRTC.                            *   LV003
 22539*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
 22540*                            VMOD=2.002                          *   CL**2
 22541*       CLOSE FICH FILE IF OPEN                                  *ELCPRTC
 22542*                                                                *ELCPRTC
 22543* NOTE- USE ELCPRTCX IF USING ELCPRT2X (ONLINE REPORT SAVE)      *   CL**2
 22544******************************************************************ELCPRTC
 22545                                                                  ELCPRTC
 22546      IF FICH-OPEN NOT = SPACE                                    ELCPRTC
 22547          CLOSE FICH.                                             ELCPRTC
 22548                                                                  ELCPRTC
 22549******************************************************************ELCPRTC
 22550
 22551     IF DTE-CLIENT = 'DMD'
 22552         CLOSE ERRESC-IN.
 22553
 22554     PERFORM 8600-DISPLAY-HD   THRU  8600-HD-EXIT.
 22555
 22556     DISPLAY ' '.
 22557     DISPLAY '* * * * * * * * * * * * * * * * * *'.
 22558     DISPLAY ' DISPLAY ERROR COUNT = '  ERROR-COUNT.
 22559     DISPLAY '* * * * * * * * * * * * * * * * * *'.
 22560     DISPLAY ' '.
 22561
 22562     MOVE    ' DISPLAY ERROR COUNT = '
 22563       TO  DIS-LINE-REASON.
 22564     MOVE  ERROR-COUNT
 22565       TO  DIS-LINE-REC.
 22566         PERFORM 8600-DISPLAY-PRT  THRU  8600-DISPLAY-EXIT.
 22567
 22568     CLOSE ERACCTT-IN  CERT-MASTER-IN  PRINT-COPY  MISMATCH-REPORT
 22569           DISPLAY-PRT
 22570           ME-ECS010-BALANCE
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 436
* ECS010MO.cbl
 22571           ME50-ECS010-BALANCE
 22572           PENDING-EXTRACT  SUMMARY-EXTR.
 22573
 22574     IF DTE-PGM-OPT = '1'
 22575         CLOSE CERT-MASTER-OUT
 22576               DETAIL-EXTR.
 22577
 22578     IF ERACCTT-FILE-STATUS NOT = '00'
 22579         MOVE '12'                TO ABEND-CODE-1
 22580         MOVE ERACCTT-FILE-STATUS TO ABEND-CODE-2
 22581         DISPLAY '******************************'
 22582         DISPLAY '***** ERROR LOCATION 027 *****'
 22583         DISPLAY '******************************'
 22584         MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
 22585           GO TO ABEND-PGM.
 22586
 22587     IF COMM-OPEN-SW = 'X'
 22588         CLOSE ERCTBL
 22589         IF ERCTBL-FILE-STATUS NOT = '00'
 22590             MOVE '42'               TO ABEND-CODE-1
 22591             MOVE ERCTBL-FILE-STATUS TO ABEND-CODE-2
 22592             DISPLAY '******************************'
 22593             DISPLAY '***** ERROR LOCATION 028 *****'
 22594             DISPLAY '******************************'
 22595             MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
 22596             GO TO ABEND-PGM.
 22597
 22598     IF REIN-OPEN-SW = 'X'
 22599         CLOSE ERRTBL-IN
 22600         IF ERRTBL-FILE-STATUS NOT = '00'
 22601             MOVE '22'               TO ABEND-CODE-1
 22602             MOVE ERRTBL-FILE-STATUS TO ABEND-CODE-2
 22603             DISPLAY '******************************'
 22604             DISPLAY '***** ERROR LOCATION 029 *****'
 22605             DISPLAY '******************************'
 22606             MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
 22607             GO TO ABEND-PGM.
 22608
 22609     MOVE 'C'                         TO CP-IO-FUNCTION.
 22610     PERFORM 8100-GET-RATE THRU 8199-GET-RATE-X.
 22611     IF IO-ERROR
 22612         MOVE 'ERROR OCCURED CLOSING - ELRATE'
 22613                                      TO WS-ABEND-MESSAGE
 22614         MOVE 0302                    TO WS-RETURN-CODE
 22615         DISPLAY '******************************'
 22616         DISPLAY '***** ERROR LOCATION 030 *****'
 22617         DISPLAY '******************************'
 22618         MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
 22619         GO TO ABEND-PGM.
 22620
 22621     IF ME-DO-UPDATE
 22622           MOVE ME-START-TIME        TO ME-010-START
*  12-S***************************************************             ( 284)**
**    Operand ME-010-START is not declared
 22623           MOVE ME-CNDS-DATE         TO ME-010-RUN-DT
 22624           ACCEPT WS-TIME-OF-DAY   FROM TIME
 22625           MOVE WS-TIME              TO ME-010-END
*  12-S*************************************************               ( 436)**
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 437
* ECS010MO.cbl
**    Operand ME-010-END is not declared
 22626           ADD 1 TO ME-010-RUN-CT
 22627           REWRITE MONTH-END-BALANCES
 22628           DISPLAY 'MONTH-END BALANCES POSTED'
 22629           CLOSE ERMEBL-INOUT
 22630     ELSE
 22631         DISPLAY 'MONTH-END BALANCES NOT POSTED'.
 22632
 22633     GO TO 9999-END-THE-JOB.
 22634
 22635 CERT-DATE-LOAD.
*22636     COPY ELCCRTM1.
 22637******************************************************************04/15/98
 22638*                                                                *ELCCRTM1
 22639*                                                                *ELCCRTM1
 22640*                            ELCCRTM1                            *   LV003
 22641*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
 22642*                            VMOD=2.001                          *ELCCRTM1
 22643*                                                                *ELCCRTM1
 22644*   COPY FILE VARIABLES TO WORKING STORAGE                       *ELCCRTM1
 22645*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCCRTM1
 22646*                                                                *ELCCRTM1
 22647******************************************************************ELCCRTM1
 22648     MOVE CR-DT                   TO  WS-CR-DT-N.                    CL**2
 22649     MOVE CR-LF-EXPIRE-DATE       TO  WS-CR-LF-EXPIRE-DATE-N.        CL**2
 22650     MOVE CR-AH-EXPIRE-DATE       TO  WS-CR-AH-EXPIRE-DATE-N.        CL**2
 22651     MOVE CR-ENTRY-DATE           TO  WS-CR-ENTRY-DATE-N.            CL**2
 22652     MOVE CR-LF-CANC-DT           TO  WS-CR-LF-CANC-DT-N.            CL**2
 22653     MOVE CR-LF-CANCEL-EXIT-DATE  TO  WS-CR-LF-CANCEL-EXIT-DATE-N.   CL**2
 22654     MOVE CR-LF-CLAIM-EXIT-DATE   TO  WS-CR-LF-CLAIM-EXIT-DATE-N.    CL**2
 22655     MOVE CR-AH-CANC-DT           TO  WS-CR-AH-CANC-DT-N.            CL**2
 22656     MOVE CR-AH-CANCEL-EXIT-DATE  TO                                 CL**2
 22657                                  WS-CR-AH-CANCEL-EXIT-DATE-N.       CL**2
 22658     MOVE CR-AH-SETTLEMENT-EXIT-DATE TO                           ELCCRTM1
 22659                                 WS-CR-AH-SETTLEMENT-EXIT-DATEN.     CL**2
 22660     MOVE CR-DTH-DT               TO  WS-CR-DTH-DT-N.                CL**2
 22661     MOVE CR-DTH-PAY-DT           TO  WS-CR-DTH-PAY-DT-N.            CL**2
 22662     MOVE CR-DIS-DT               TO  WS-CR-DIS-DT-N.                CL**2
 22663     MOVE CR-DIS-PAY-DT           TO  WS-CR-DIS-PAY-DT-N.            CL**2
 22664     MOVE CR-DIS-PTO-DT           TO  WS-CR-DIS-PTO-DT-N.            CL**2
 22665     PERFORM  VARYING COPY-NDX FROM 1 BY 1 UNTIL COPY-NDX > 5     ELCCRTM1
 22666           MOVE CR-DIS-INCUR-DT (COPY-NDX)   TO                   ELCCRTM1
 22667                                WS-CR-DIS-INCUR-DT-N (COPY-NDX)      CL**2
 22668     END-PERFORM.                                                 ELCCRTM1
 22669                                                                  ELCCRTM1
 22670
 22671 EXTRACT-DATE-LOAD.
*22672     COPY ELCEXTM1.
 22673******************************************************************04/15/98
 22674*                                                                *ELCEXTM1
 22675*                                                                *ELCEXTM1
 22676*                            ELCEXTM1                            *   LV010
 22677*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL*10
 22678*                            VMOD=2.001                          *ELCEXTM1
 22679*                                                                *ELCEXTM1
 22680*   COPY FILE VARIABLES TO WORKING STORAGE                       *ELCEXTM1
 22681*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCEXTM1
 22682*                                                                *ELCEXTM1
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 438
* ECS010MO.cbl (/apps/prod/cid1p/copy/ELCEXTM1)
 22683******************************************************************ELCEXTM1
 22684                                                                  ELCEXTM1
 22685     MOVE DE-EFF                     TO  WS-DE-EFF-N.                CL**9
 22686     MOVE DE-LF-CANC-DTE             TO  WS-DE-LF-CANC-DTE-N.        CL**9
 22687     MOVE DE-LF-CANC-EXIT-DT         TO  WS-DE-LF-CANC-EXIT-DT-N.    CL**9
 22688     MOVE DE-AH-CANC-DTE             TO  WS-DE-AH-CANC-DTE-N.        CL**9
 22689     MOVE DE-AH-CANC-EXIT-DT         TO  WS-DE-AH-CANC-EXIT-DT-N.    CL**9
 22690     MOVE DE-ENTRY-DTE               TO  WS-DE-ENTRY-DTE-N.          CL**9
 22691                                                                     CL**9
 22692     EVALUATE TRUE                                                   CL**5
 22693        WHEN DE-ISSUE      OR                                        CL**8
 22694             DE-RC-ISSUE   OR                                        CL**8
 22695             DE-RR-RC-ISS  OR                                        CL**8
 22696             DE-CANCEL     OR                                        CL**8
 22697             DE-RC-CANCEL  OR                                        CL**8
 22698             DE-RR-RC-CNC                                            CL**8
 22699           MOVE DE-PROC-DT           TO  WS-DE-PROC-DT-N             CL**9
 22700                                                                     CL**9
 22701        WHEN DE-CLAIM      OR                                        CL**8
 22702             DE-RR-RC-CLM                                            CL**6
 22703           MOVE DE-INCUR             TO  WS-DE-INCUR-N               CL**9
 22704           MOVE DE-PAY               TO  WS-DE-PAY-N                 CL**9
 22705           MOVE DE-PAID-TO           TO  WS-DE-PAID-TO-N             CL**9
 22706           MOVE DE-ACC-EXP-DTE       TO  WS-DE-ACC-EXP-DTE-N         CL**9
 22707           MOVE DE-ACC-EFF-DTE       TO  WS-DE-ACC-EFF-DTE-N         CL**9
 22708           MOVE DE-CLM-PROC-DT       TO  WS-DE-CLM-PROC-DT-N         CL**9
 22709                                                                     CL**9
 22710        WHEN DE-RESERVE                                              CL**9
 22711           MOVE DE-RSV-INCUR         TO  WS-DE-RSV-INCUR-N           CL**9
 22712           MOVE DE-RSV-PAYTO         TO  WS-DE-RSV-PAYTO-N           CL**9
 22713           MOVE DE-ACC-EXP-DTE-RSV                                   CL**5
 22714                                     TO  WS-DE-ACC-EXP-DTE-RSV-N     CL**9
 22715           MOVE DE-ACC-EFF-DTE-RSV                                   CL**9
 22716                                     TO  WS-DE-ACC-EFF-DTE-RSV-N     CL**9
 22717           MOVE DE-RSV-PROC-DT       TO  WS-DE-RSV-PROC-DT-N         CL**9
 22718     END-EVALUATE.                                                   CL**9
 22719                                                                     CL**9
 22720
 22721 EXTRACT-DATE-RELOAD.
*22722     COPY ELCEXTM2.
 22723******************************************************************04/15/98
 22724*                                                                *ELCEXTM2
 22725*                                                                *ELCEXTM2
 22726*                            ELCEXTM2                            *   LV011
 22727*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL*11
 22728*                            VMOD=2.001                          *ELCEXTM2
 22729*                                                                *ELCEXTM2
 22730*   COPY WORKING STORAGE TO  FILE VARIABLES                      *ELCEXTM2
 22731*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCEXTM2
 22732*                                                                *   CL**9
 22733******************************************************************ELCEXTM2
 22734                                                                  ELCEXTM2
 22735     MOVE WS-DE-EFF-N                TO  DE-EFF.                     CL*10
 22736     MOVE WS-DE-LF-CANC-DTE-N        TO  DE-LF-CANC-DTE.             CL*10
 22737     MOVE WS-DE-LF-CANC-EXIT-DT-N    TO  DE-LF-CANC-EXIT-DT.         CL*10
 22738     MOVE WS-DE-AH-CANC-DTE-N        TO  DE-AH-CANC-DTE.             CL*10
 22739     MOVE WS-DE-AH-CANC-EXIT-DT-N    TO  DE-AH-CANC-EXIT-DT.         CL*10
 22740     MOVE WS-DE-ENTRY-DTE-N          TO  DE-ENTRY-DTE.               CL*10
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 439
* ECS010MO.cbl (/apps/prod/cid1p/copy/ELCEXTM2)
 22741                                                                     CL*10
 22742     EVALUATE TRUE                                                   CL*10
 22743        WHEN DE-ISSUE      OR                                        CL*10
 22744             DE-RC-ISSUE   OR                                        CL*10
 22745             DE-RR-RC-ISS  OR                                        CL*10
 22746             DE-CANCEL     OR                                        CL*10
 22747             DE-RC-CANCEL  OR                                        CL*10
 22748             DE-RR-RC-CNC                                            CL*10
 22749           MOVE WS-DE-PROC-DT-N      TO  DE-PROC-DT                  CL*10
 22750                                                                     CL*10
 22751        WHEN DE-CLAIM      OR                                        CL*10
 22752             DE-RR-RC-CLM                                            CL**7
 22753           MOVE WS-DE-INCUR-N        TO  DE-INCUR                    CL*10
 22754           MOVE WS-DE-PAY-N          TO  DE-PAY                      CL*10
 22755           MOVE WS-DE-PAID-TO-N      TO  DE-PAID-TO                  CL*10
 22756           MOVE WS-DE-ACC-EXP-DTE-N  TO  DE-ACC-EXP-DTE              CL*10
 22757           MOVE WS-DE-ACC-EFF-DTE-N  TO  DE-ACC-EFF-DTE              CL*10
 22758           MOVE WS-DE-CLM-PROC-DT-N  TO  DE-CLM-PROC-DT              CL*10
 22759                                                                     CL*10
 22760        WHEN DE-RESERVE                                              CL**7
 22761            MOVE WS-DE-RSV-INCUR-N   TO  DE-RSV-INCUR                CL*10
 22762            MOVE WS-DE-RSV-PAYTO-N   TO  DE-RSV-PAYTO                CL*10
 22763            MOVE WS-DE-ACC-EXP-DTE-RSV-N                             CL*10
 22764                                     TO  DE-ACC-EXP-DTE-RSV          CL*10
 22765            MOVE WS-DE-ACC-EFF-DTE-RSV-N                             CL**4
 22766                                     TO  DE-ACC-EFF-DTE-RSV          CL*10
 22767            MOVE WS-DE-RSV-PROC-DT-N TO  DE-RSV-PROC-DT              CL*10
 22768     END-EVALUATE.                                                   CL**5
 22769                                                                  ELCEXTM2
 22770
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 440
* ECS010MO.cbl
 22772 ABEND-PGM.
 22773     DISPLAY '******************************'
 22774     DISPLAY '***** ABEND PGM **************'
 22775     DISPLAY '******************************'
*22776                             COPY ELCABEND.
 22777***************************************************************** 04/14/98
 22778*                                                               * ELCABEND
 22779*                            ELCABEND.                          *    LV003
 22780*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
 22781*                            VMOD 2.002                              CL**2
 22782*                                                               * ELCABEND
 22783*                THIS SECTION DISPLAYS THE NECESSARY MESSAGES   * ELCABEND
 22784*            AND THEN ABENDS.                                   * ELCABEND
 22785*                                                               * ELCABEND
 22786*  NO  CID  MODS  IN  COPYBOOK  ELCABEND                        * ELCABEND
 22787*                                                               * ELCABEND
 22788***************************************************************** ELCABEND
 22789*APS-010.                                                         ELCABEND
 22790     DISPLAY WS-ABEND-MESSAGE.                                    ELCABEND
 22791     DISPLAY WS-ABEND-MESSAGE UPON CONSOLE.                       ELCABEND
 22792                                                                  ELCABEND
 22793     IF WS-ABEND-FILE-STATUS NOT = ZERO                           ELCABEND
 22794         DISPLAY 'FILE STATUS = ' WS-ABEND-FILE-STATUS            ELCABEND
 22795         DISPLAY 'FILE STATUS = ' WS-ABEND-FILE-STATUS            ELCABEND
 22796                                 UPON CONSOLE.                    ELCABEND
 22797                                                                  ELCABEND
 22798     IF WS-RETURN-CODE NOT = ZERO                                 ELCABEND
 22799         DISPLAY 'RETURN CODE = '  WS-RETURN-CODE                 ELCABEND
 22800         DISPLAY 'RETURN CODE = '  WS-RETURN-CODE                 ELCABEND
 22801                                 UPON CONSOLE.                    ELCABEND
 22802                                                                  ELCABEND
 22803     DISPLAY 'PROGRAM WILL NOW ABEND **************'              ELCABEND
 22804     DISPLAY 'PROGRAM WILL NOW ABEND **************'              ELCABEND
 22805                                 UPON CONSOLE.                    ELCABEND
 22806                                                                  ELCABEND
 22807     DIVIDE WS-ZERO BY WS-ZERO GIVING WS-ZERO.                    ELCABEND
 22808     CALL 'ABORTME'.
 22809                                                                  ELCABEND
 22810 APS-EXIT.                                                        ELCABEND
 22811     EXIT.                                                        ELCABEND
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 441
* ECS010MO.cbl
 22813 9999-END-THE-JOB.
 22814
 22815     DISPLAY ' '.
 22816     DISPLAY '****** THE END OF MESSAGES CREATED BY '
 22817         'ECS010 ******'
 22818     DISPLAY ' '.
 22819     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 442
* ECS010MO.cbl
 22820/
 22821 LCP-WRITE-POS-MISMATCH-RPT SECTION.
 22822     IF LCP-ASA = '+'
 22823         WRITE MISMATCH-RPT AFTER 0 LINE
 22824     ELSE
 22825     IF LCP-ASA = ' '
 22826         WRITE MISMATCH-RPT AFTER ADVANCING 1 LINE
 22827     ELSE
 22828     IF LCP-ASA = '0'
 22829         WRITE MISMATCH-RPT AFTER ADVANCING 2 LINE
 22830     ELSE
 22831     IF LCP-ASA = '-'
 22832         WRITE MISMATCH-RPT AFTER ADVANCING 3 LINE
 22833     ELSE
 22834     IF LCP-ASA = '1'
 22835         WRITE MISMATCH-RPT AFTER ADVANCING PAGE
 22836     ELSE
 22837     IF LCP-ASA = '2'
 22838         WRITE MISMATCH-RPT AFTER ADVANCING LCP-CH2
 22839     ELSE
 22840     IF LCP-ASA = '3'
 22841         WRITE MISMATCH-RPT AFTER ADVANCING LCP-CH3
 22842     ELSE
 22843     IF LCP-ASA = '4'
 22844         WRITE MISMATCH-RPT AFTER ADVANCING LCP-CH4
 22845     ELSE
 22846     IF LCP-ASA = '5'
 22847         WRITE MISMATCH-RPT AFTER ADVANCING LCP-CH5
 22848     ELSE
 22849     IF LCP-ASA = '6'
 22850         WRITE MISMATCH-RPT AFTER ADVANCING LCP-CH6
 22851     ELSE
 22852     IF LCP-ASA = '7'
 22853         WRITE MISMATCH-RPT AFTER ADVANCING LCP-CH7
 22854     ELSE
 22855     IF LCP-ASA = '8'
 22856         WRITE MISMATCH-RPT AFTER ADVANCING LCP-CH8
 22857     ELSE
 22858     IF LCP-ASA = '9'
 22859         WRITE MISMATCH-RPT AFTER ADVANCING LCP-CH9
 22860     ELSE
 22861     IF LCP-ASA = 'A'
 22862         WRITE MISMATCH-RPT AFTER ADVANCING LCP-CH10
 22863     ELSE
 22864     IF LCP-ASA = 'B'
 22865         WRITE MISMATCH-RPT AFTER ADVANCING LCP-CH11
 22866     ELSE
 22867     IF LCP-ASA = 'C'
 22868         WRITE MISMATCH-RPT AFTER ADVANCING LCP-CH12
 22869     ELSE
 22870     IF LCP-ASA = 'V'
 22871         WRITE MISMATCH-RPT AFTER ADVANCING LCP-P01
 22872     ELSE
 22873     IF LCP-ASA = 'W'
 22874         WRITE MISMATCH-RPT AFTER ADVANCING LCP-P02
 22875     ELSE
 22876     DISPLAY 'ASA CODE ERROR'.
 22877 LCP-WRITE-END-MISMATCH-RPT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 443
* ECS010MO.cbl
 22878     EXIT.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Last message on page:  436
* Total Messages:     5
* Unrecoverable :     0                    Severe  :     2
* Errors        :     3                    Warnings:     0
* Informational :     0                    Flags   :     0
* Data:     2176773     Code:           0
