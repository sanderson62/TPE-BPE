* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   1
* ISD052.cbl
* Options: int("ISD052.int") anim csi verbose NOBOUND PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("ISD052.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"ebmlsfile" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" NOCHECKDIV NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"32" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"ISD052.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"ISD052.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR NOSTICKY-LINKAGE
*          NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"2" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2 PROGRAM-ID.    ISD052.
     3 AUTHOR.        DAN DRYDEN.
     4 DATE-WRITTEN.  JANUARY, 1999.
     5
     6*****************************************************************
     7* THIS PROGRAM CALLS IEBGENER (COBGENER) FOR AS MANY TIMES      *
     8* AS THERE ARE CHARACTERS IN THE PARAMETER.   FOR EXAMPLE:      *
     9*                                                               *
    10* //ISD052  EXEC PGM=ISD052,PARM='ATH'                          *
    11* //SYSUT1  DD   DSN=...............                            *
    12* //SYSUTA  DD   SYSOUT=A                                       *
    13* //SYSUTT  DD   SYSOUT=T                                       *
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   2
* ISD052.cbl
    14* //SYSUTH  DD   SYSOUT=H                                       *
    15*                                                               *
    16* COPIES THE DATASET ON SYSUT1 TO OUTPUT CLASSES A H AND T      *
    17* THIS WILL WORK FOR ANY LRECL AND ANY BLKSIZE                  *
    18* IT WILL ALSO WORK FOR COPYING DATASET TO DATASET              *
    19*****************************************************************
    20
    21 DATA DIVISION.
    22
    23 WORKING-STORAGE SECTION.
    24
    25 01  FILLER.
    26     05  SUB         PIC S9(4)  BINARY.
    27     05  SYSUT1      PIC X(8)   VALUE 'SYSUT1  '.
    28     05  SYSUT2      PIC X(8)   VALUE 'SYSUT   '.
    29
    30
    31
    32 LINKAGE SECTION.
    33
    34 01  PARM.
    35     05  PARM-LENGTH     PIC S9(4)  COMP.
    36     05  PARM-CLASS OCCURS 100 TIMES PIC X.
    37
    38
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   3
* ISD052.cbl
    40*
    41 PROCEDURE DIVISION USING PARM.
    42*
    43     IF PARM-LENGTH = +0
    44        MOVE 'A' TO SYSUT2(6:1)
    45        CALL 'COBGENER' USING SYSUT1, SYSUT2
    46     ELSE
    47        PERFORM VARYING SUB FROM 1 BY 1 UNTIL SUB > PARM-LENGTH
    48           MOVE PARM-CLASS(SUB) TO SYSUT2(6:1)
    49           CALL 'COBGENER' USING SYSUT1, SYSUT2
    50        END-PERFORM
    51     END-IF
    52
    53     STOP RUN.
    54
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:         580     Code:         139
