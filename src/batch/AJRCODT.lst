* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   1
* AJRCODT.cbl
* Options: int("AJRCODT.int") anim csi verbose NOBOUND PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("AJRCODT.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"ebmlsfile" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" NOCHECKDIV NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"32" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"AJRCODT.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"AJRCODT.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR NOSTICKY-LINKAGE
*          NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"2" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2 PROGRAM-ID.    AJRCODT.
     3 AUTHOR.        AJR.
     4 DATE-COMPILED. 06-Oct-15 17:18.
     5*REMARKS.
     6******************************************************************
     7*                   C H A N G E   L O G
     8*
     9* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    10*-----------------------------------------------------------------
    11*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    12* EFFECTIVE    NUMBER
    13*-----------------------------------------------------------------
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   2
* AJRCODT.cbl
    14* INITIALIZE CO-FIRST-WRITTEN-DT TO X'9F01' (01/01/06)
    15******************************************************************
    17 ENVIRONMENT DIVISION.
    18 INPUT-OUTPUT SECTION.
    19 FILE-CONTROL.
    20
    21     SELECT ERCOMP       ASSIGN TO ERCOMP
    22                         ACCESS IS DYNAMIC
    23                         ORGANIZATION IS INDEXED
    24                         FILE STATUS IS ERCOMP-FILE-STATUS
    25                         RECORD KEY IS CO-CONTROL-PRIMARY.
    26
    27 DATA DIVISION.
    28 FILE SECTION.
    29
    30 FD  ERCOMP.
    31
*   32                                 COPY ERCCOMP.
    33******************************************************************
    34*                                                                *
    35*                                                                *
    36*                            ERCCOMP                             *
    37*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
    38*                            VMOD=2.019                          *
    39*                                                                *
    40*   ONLINE CREDIT SYSTEM                                         *
    41*                                                                *
    42*   FILE DESCRIPTION = COMPENSATION MASTER                       *
    43*                                                                *
    44*   FILE TYPE = VSAM,KSDS                                        *
    45*   RECORD SIZE = 700   RECFORM = FIXED                          *
    46*                                                                *
    47*   BASE CLUSTER NAME = ERCOMP                   RKP=2,LEN=29    *
    48*       ALTERNATE PATH = NONE                                    *
    49*                                                                *
    50*   LOG = NO                                                     *
    51*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
    52*                                                                *
    53******************************************************************
    54*                   C H A N G E   L O G
    55*
    56* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    57*-----------------------------------------------------------------
    58*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    59* EFFECTIVE    NUMBER
    60*-----------------------------------------------------------------
    61* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
    62* 041105    2005031100003  PEMA  ADD TYPE CODE FOR BANKS
    63* 092205    2005050300006  PEMA  ADD LEASE FEE
    64* 032406    2006022800001  AJRA  ADD FIRST WRITTEN DATE
    65* 072406    2006022400001  PEMA  ADD REF EDIT FLD ON B RECS
    66* 062907    2004020600003  PEMA  ADD WITHOLDING PERCENT
    67* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
    68* 020310  CR2008100900004  PEMA  ADD REF4 EXTRACT PROCESSING
    69* 071712  CR2012042700005  PEMA  ADD OVER 120 FOR AHL ONLY
    70******************************************************************
    71
    72 01  COMPENSATION-MASTER.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   3
* AJRCODT.cbl (/apps/prod/cid1p/copy/ERCCOMP)
    73     12  CO-RECORD-ID                          PIC XX.
    74         88  VALID-CO-ID                          VALUE 'CO'.
    75
    76     12  CO-CONTROL-PRIMARY.
    77         16  CO-COMPANY-CD                     PIC X.
    78         16  CO-CONTROL.
    79             20  CO-CTL-1.
    80                 24  CO-CARR-GROUP.
    81                     28  CO-CARRIER            PIC X.
    82                     28  CO-GROUPING.
    83                         32  CO-GROUP-PREFIX   PIC XXX.
    84                         32  CO-GROUP-PRIME    PIC XXX.
    85                 24  CO-RESP-NO.
    86                     28  CO-RESP-PREFIX        PIC X(4).
    87                     28  CO-RESP-PRIME         PIC X(6).
    88             20  CO-CTL-2.
    89                 24  CO-ACCOUNT.
    90                     28  CO-ACCT-PREFIX        PIC X(4).
    91                     28  CO-ACCT-PRIME         PIC X(6).
    92         16  CO-TYPE                           PIC X.
    93             88  CO-COMPANY-TYPE                  VALUE 'C'.
    94             88  CO-GEN-AGENT-TYPE     VALUE 'G' 'B'.
    95             88  CO-ACCOUNT-TYPE                  VALUE 'A'.
    96
    97     12  CO-MAINT-INFORMATION.
    98         16  CO-LAST-MAINT-DT                  PIC XX.
    99         16  CO-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
   100         16  CO-LAST-MAINT-USER                PIC X(4).
   101     12  FILLER                                PIC XX.
   102     12  CO-STMT-TYPE                          PIC XXX.
   103     12  CO-COMP-TYPE                          PIC X.
   104         88  CO-COMP-IS-SPPDD                    VALUE '1'.
   105     12  CO-STMT-OWNER                         PIC X(4).
   106     12  CO-BALANCE-CONTROL                    PIC X.
   107         88  CO-CARRY-BALANCE                     VALUE 'Y'.
   108         88  CO-NO-BALANCE                        VALUE 'N'.
   109
   110     12  CO-INTERNAL-CONTROL-1                 PIC X.
   111         88  CO-AUTO-GENERATED-THIS-RUN           VALUE 'X'.
   112         88  CO-AUTO-GENERATED                    VALUE 'Y'.
   113         88  CO-NOT-AUTO-GENERATED                VALUE 'N'.
   114
   115     12  CO-INTERNAL-CONTROL-2                 PIC X.
   116         88  CO-STATEMENT-THIS-RUN                VALUE 'Y'.
   117         88  CO-NO-STATEMENT-THIS-RUN             VALUE 'N'.
   118
   119     12  CO-GA-WITHOLD-PCT                     PIC S9V9999 COMP-3.
   120     12  CO-GA-DIRECT-DEP                      PIC X.
   121     12  CO-FUTURE-SPACE                       PIC X.
   122         88  CO-FUTURE-NOT-USED                   VALUE ' '.
   123
   124     12  CO-ACCT-NAME                          PIC X(30).
   125     12  CO-MAIL-NAME                          PIC X(30).
   126     12  CO-ADDR-1                             PIC X(30).
   127     12  CO-ADDR-2                             PIC X(30).
   128     12  CO-ADDR-3.
   129         16  CO-ADDR-CITY                      PIC X(27).
   130         16  CO-ADDR-STATE                     PIC XX.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   4
* AJRCODT.cbl (/apps/prod/cid1p/copy/ERCCOMP)
   131     12  CO-CSO-1099                           PIC X.
   132     12  CO-ZIP.
   133         16  CO-ZIP-PRIME.
   134             20  CO-ZIP-PRI-1ST                PIC X.
   135                 88  CO-CANADIAN-POST-CODE  VALUE 'A' THRU 'Z'.
   136             20  FILLER                        PIC X(4).
   137         16  CO-ZIP-PLUS4                      PIC X(4).
   138     12  CO-CANADIAN-POSTAL-CODE  REDEFINES  CO-ZIP.
   139         16  CO-CAN-POSTAL-1                   PIC XXX.
   140         16  CO-CAN-POSTAL-2                   PIC XXX.
   141         16  FILLER                            PIC XXX.
   142     12  CO-SOC-SEC                            PIC X(13).
   143     12  CO-TELEPHONE.
   144         16  CO-AREA-CODE                      PIC XXX.
   145         16  CO-PREFIX                         PIC XXX.
   146         16  CO-PHONE                          PIC X(4).
   147
   148     12  CO-ROLADEX-PRINT-DT                   PIC XX.
   149
   150     12  CO-AR-BAL-LEVEL                       PIC X.
   151         88  CO-AR-REF-LVL                        VALUE '1'.
   152         88  CO-AR-BILL-REF-LVL                   VALUE '1'.
   153         88  CO-AR-BILL-LVL                       VALUE '2'.
   154         88  CO-AR-AGT-LVL                        VALUE '3'.
   155         88  CO-AR-FR-LVL                         VALUE '4'.
   156
   157     12  CO-AR-NORMAL-PRINT                    PIC X.
   158         88  CO-AR-BILL-IS-PRINTED                VALUE 'Y'.
   159         88  CO-AR-BILL-NOT-PRINTED               VALUE 'N'.
   160
   161     12  CO-AR-SUMMARY-CODE                    PIC X(6).
   162
   163     12  CO-AR-REPORTING                       PIC X.
   164         88  CO-AR-NET-REPORT                     VALUE 'N'.
   165         88  CO-AR-GROSS-REPORT                   VALUE 'G'.
   166
   167     12  CO-AR-PULL-CHECK                      PIC X.
   168         88  CO-AR-CHECKS-PULLED                  VALUE 'Y'.
   169         88  CO-AR-CHECKS-NOT-PULLED              VALUE 'N'.
   170
   171     12  CO-AR-BALANCE-PRINT                   PIC X.
   172         88  CO-AR-PRINT-NO-BALANCE               VALUE 'N'.
   173
   174     12  CO-AR-LAST-RUN-CODE                   PIC X.
   175         88  CO-AR-LAST-RUN-ANNUAL                VALUE 'A'.
   176         88  CO-AR-LAST-RUN-CYCLE                 VALUE 'C'.
   177         88  CO-AR-LAST-RUN-EOM                   VALUE 'M'.
   178
   179     12  CO-LAST-EOM-STMT-DT                   PIC XX.
   180
   181     12  CO-USER-CODE                          PIC X.
   182     12  CO-REPORT-GROUP-ID                    PIC X(12).
   183
   184******************************************************************
   185*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN THE TOTALS AS OF
   186*    THE LAST MONTH END RUN.
   187******************************************************************
   188
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   5
* AJRCODT.cbl (/apps/prod/cid1p/copy/ERCCOMP)
   189     12  CO-LAST-ACTIVITY-DATE.
   190         16  CO-ACT-YEAR                       PIC 99.
   191         16  CO-ACT-MONTH                      PIC 99.
   192         16  CO-ACT-DAY                        PIC 99.
   193
   194     12  CO-LAST-STMT-DT.
   195         16  CO-LAST-STMT-YEAR                 PIC 99.
   196         16  CO-LAST-STMT-MONTH                PIC 99.
   197         16  CO-LAST-STMT-DAY                  PIC 99.
   198
   199     12  CO-MO-END-TOTALS.
   200         16  CO-MONTHLY-TOTALS.
   201             20  CO-BAL-FWD                PIC S9(7)V99   COMP-3.
   202             20  CO-CUR-COM                PIC S9(7)V99   COMP-3.
   203             20  CO-CUR-CHG                PIC S9(7)V99   COMP-3.
   204             20  CO-CUR-PMT                PIC S9(7)V99   COMP-3.
   205             20  CO-END-BAL                PIC S9(7)V99   COMP-3.
   206
   207         16  CO-AGING-TOTALS.
   208             20  CO-CUR                    PIC S9(7)V99   COMP-3.
   209             20  CO-OV30                   PIC S9(7)V99   COMP-3.
   210             20  CO-OV60                   PIC S9(7)V99   COMP-3.
   211             20  CO-OV90                   PIC S9(7)V99   COMP-3.
   212
   213         16  CO-YTD-TOTALS.
   214             20  CO-YTD-COM                PIC S9(7)V99   COMP-3.
   215             20  CO-YTD-OV                 PIC S9(7)V99   COMP-3.
   216
   217         16  CO-OVER-UNDER-TOTALS.
   218             20  CO-CUR-OVR-UNDR           PIC S9(7)V99   COMP-3.
   219             20  CO-YTD-OVR-UNDR           PIC S9(7)V99   COMP-3.
   220
   221     12  CO-MISCELLANEOUS-TOTALS.
   222         16  CO-FICA-TOTALS.
   223             20  CO-CUR-FICA               PIC S9(7)V99   COMP-3.
   224             20  CO-YTD-FICA               PIC S9(7)V99   COMP-3.
   225
   226         16  CO-CLAIM-TOTALS.
   227             20  CO-LF-CLM-AMT             PIC S9(9)V99   COMP-3.
   228             20  CO-AH-CLM-AMT             PIC S9(9)V99   COMP-3.
   229
   230******************************************************************
   231*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN TOTALS THAT
   232*    REPRESENT CURRENT MONTH (TOTALS OF CYCLES).
   233******************************************************************
   234
   235     12  CO-CURRENT-TOTALS.
   236         16  CO-CURRENT-LAST-STMT-DT.
   237             20  CO-CURRENT-LAST-STMT-YEAR     PIC 99.
   238             20  CO-CURRENT-LAST-STMT-MONTH    PIC 99.
   239             20  CO-CURRENT-LAST-STMT-DAY      PIC 99.
   240
   241         16  CO-CURRENT-MONTHLY-TOTALS.
   242             20  CO-CURRENT-BAL-FWD        PIC S9(7)V99   COMP-3.
   243             20  CO-CURRENT-CUR-COM        PIC S9(7)V99   COMP-3.
   244             20  CO-CURRENT-CUR-CHG        PIC S9(7)V99   COMP-3.
   245             20  CO-CURRENT-CUR-PMT        PIC S9(7)V99   COMP-3.
   246             20  CO-CURRENT-END-BAL        PIC S9(7)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   6
* AJRCODT.cbl (/apps/prod/cid1p/copy/ERCCOMP)
   247
   248         16  CO-CURRENT-AGING-TOTALS.
   249             20  CO-CURRENT-CUR            PIC S9(7)V99   COMP-3.
   250             20  CO-CURRENT-OV30           PIC S9(7)V99   COMP-3.
   251             20  CO-CURRENT-OV60           PIC S9(7)V99   COMP-3.
   252             20  CO-CURRENT-OV90           PIC S9(7)V99   COMP-3.
   253
   254         16  CO-CURRENT-YTD-TOTALS.
   255             20  CO-CURRENT-YTD-COM        PIC S9(7)V99   COMP-3.
   256             20  CO-CURRENT-YTD-OV         PIC S9(7)V99   COMP-3.
   257
   258     12  CO-PAID-COMM-TOTALS.
   259         16  CO-YTD-PAID-COMMS.
   260             20  CO-YTD-PAID-COM           PIC S9(7)V99   COMP-3.
   261             20  CO-YTD-PAID-OV            PIC S9(7)V99   COMP-3.
   262
   263     12  CO-CURRENT-MONTH-ACTIVITY         PIC X.
   264         88  CO-HAS-CURR-MONTH-ACTIVITY       VALUE 'Y'.
   265         88  CO-NO-CURR-MONTH-ACTIVITY        VALUE 'N'.
   266
   267     12  CO-DELINQUENT-LETTER-CODE         PIC X.
   268         88  CO-ACCOUNT-1ST-LETTER            VALUE 'A'.
   269         88  CO-ACCOUNT-2ND-LETTER            VALUE 'B'.
   270         88  CO-AGENT-1ST-LETTER              VALUE 'B'.
   271         88  CO-AGENT-2ND-LETTER              VALUE 'G'.
   272         88  CO-OVERWRITE-LETTER              VALUE 'O'.
   273         88  CO-MEMO-TO-REGION-MGR            VALUE 'M'.
   274         88  CO-FINAL-LETTER                  VALUE 'F'.
   275         88  CO-RECONCILING                   VALUE 'R'.
   276         88  CO-PHONE-CALL                    VALUE 'P'.
   277         88  CO-LEGAL                         VALUE 'L'.
   278         88  CO-COLLECTION-AGENCY             VALUE 'C'.
   279         88  CO-WRITE-OFF                     VALUE 'W'.
   280         88  CO-NO-ACTION                     VALUE 'N' ' '.
   281
   282     12  CO-CSR-CODE                       PIC X(4).
   283
   284     12  CO-GA-STATUS-INFO.
   285         16  CO-GA-EFFECTIVE-DT            PIC XX.
   286         16  CO-GA-TERMINATION-DT          PIC XX.
   287         16  CO-GA-STATUS-CODE             PIC X.
   288             88  CO-GA-ACTIVE                 VALUE 'A'.
   289             88  CO-GA-INACTIVE               VALUE 'I'.
   290             88  CO-GA-PENDING                VALUE 'P'.
   291         16  CO-GA-COMMENTS.
   292             20  CO-GA-COMMENT-1           PIC X(40).
   293             20  CO-GA-COMMENT-2           PIC X(40).
   294             20  CO-GA-COMMENT-3           PIC X(40).
   295             20  CO-GA-COMMENT-4           PIC X(40).
   296
   297     12  CO-RPTCD2                         PIC X(10).
   298     12  CO-AHL-OVER120-DATA REDEFINES CO-RPTCD2.
   299         16  CO-OV120                      PIC S9(7)V99   COMP-3.
   300         16  CO-CURRENT-OV120              PIC S9(7)V99   COMP-3.
   301
   302     12  CO-TYPE-AGENT                     PIC X(01).
   303         88  CO-CORPORATION                   VALUE 'C'.
   304         88  CO-PARTNERSHIP                   VALUE 'P'.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   7
* AJRCODT.cbl (/apps/prod/cid1p/copy/ERCCOMP)
   305         88  CO-SOLE-PROPRIETOR               VALUE 'S'.
   306         88  CO-TRUST                         VALUE 'T'.
   307         88  CO-UNKNOWN                       VALUE ' ' 'X'.
   308
   309     12  CO-FAXNO.
   310         16  CO-FAX-AREA-CODE                  PIC XXX.
   311         16  CO-FAX-PREFIX                     PIC XXX.
   312         16  CO-FAX-PHONE                      PIC X(4).
   313
   314     12  CO-BANK-INFORMATION.
   315         16  CO-BANK-TRANSIT-NO                PIC X(8).
   316         16  CO-BANK-TRANSIT-NON REDEFINES
   317             CO-BANK-TRANSIT-NO                PIC 9(8).
   318
   319         16  CO-BANK-ACCOUNT-NUMBER            PIC X(17).
   320     12  CO-MISC-DEDUCT-INFO REDEFINES
   321                  CO-BANK-INFORMATION.
   322         16  CO-MD-GL-ACCT                     PIC X(10).
   323         16  CO-MD-DIV                         PIC XX.
   324         16  CO-MD-CENTER                      PIC X(4).
   325         16  CO-MD-AMT                        PIC S9(5)V99 COMP-3.
   326         16  CO-CREATE-AP-CHECK                PIC X.
   327         16  CO-DELIVER-CK-TO-MEL              PIC X.
   328         16  FILLER                            PIC XXX.
   329     12  CO-ACH-STATUS                         PIC X.
   330         88  CO-ACH-ACTIVE                         VALUE 'A'.
   331         88  CO-ACH-PENDING                        VALUE 'P'.
   332
   333     12  CO-BILL-SW                            PIC X.
   334     12  CO-CONTROL-NAME                       PIC X(30).
   335     12  CO-MAX-BANK-FEE-LEASE                 PIC S999V99 COMP-3.
   336     12  CO-MAX-BANK-FEE                       PIC S999V99 COMP-3.
   337     12  CO-CLP-STATE                          PIC XX.
   338     12  CO-FIRST-WRITTEN-DT                   PIC XX.
   339     12  CO-SPP-REFUND-EDIT                    PIC X.
   340
   341******************************************************************
   342
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   8
* AJRCODT.cbl
   344 WORKING-STORAGE SECTION.
   345 77  FILLER  PIC X(32) VALUE '********************************'.
   346 77  FILLER  PIC X(32) VALUE '     AJRCODT WORKING STORAGE    '.
   347 77  FILLER  PIC X(32) VALUE '********************************'.
   348
   349
   350 01  WS-MISC.
   351     05  WS-EOF-SW               PIC X      VALUE SPACES.
   352         88  END-OF-ERCOMP                  VALUE 'Y'.
   353     05  ERCOMP-FILE-STATUS      PIC XX     VALUE '00'.
   354     05  SUB1            COMP-3  PIC S9(3)  VALUE +0.
   355     05  WS-COMPANY-CD           PIC X(01)  VALUE SPACE.
   356
   357     05  WS-INITIAL-DT           PIC XX     VALUE X'9F01'.
   358
   359     05  WS-ERCOMP-IN            PIC 9(7)   VALUE ZEROS.
   360     05  WS-ERCOMP-FIX           PIC 9(7)   VALUE ZEROS.
   361
   362 01  WS-ABEND-AREA.
   363     05  WS-ABEND-FILE-STATUS    PIC X(02).
   364     05  WS-ABEND-MESSAGE        PIC X(80) VALUE SPACES.
   365     05  WS-RETURN-CODE          PIC S9(04)  COMP VALUE +0.
   366     05  WS-ZERO                 PIC S9(01) VALUE +0 COMP-3.
   367
   368 01  WORK-ABEND-CODE.
   369     12  WAC-1                   PIC X.
   370     12  WAC-2                   PIC X.
   371     12  WAC-3-4.
   372         16  WAC-3               PIC X.
   373         16  WAC-4               PIC X.
   374
   375
   376 01  ABEND-FIELDS.
   377     12  PGM-SUB                 PIC S999 COMP  VALUE +158.
   378     12  FIRST-TIME-SW           PIC X  VALUE 'Y'.
   379         88  FIRST-TIME                 VALUE 'Y'.
   380
*  381                                 COPY ELCDATE.
   382******************************************************************06/11/98
   383*                                                                *ELCDATE
   384*                                                                *ELCDATE
   385*                            ELCDATE.                            *   LV023
   386*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL*16
   387*                            VMOD=2.003                           ELCDATE
   388*                                                                *ELCDATE
   389*                                                                *ELCDATE
   390*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *ELCDATE
   391*                 LENGTH = 200                                   *   CL*19
   392******************************************************************ELCDATE
   393                                                                  ELCDATE
   394 01  DATE-CONVERSION-DATA.                                        ELCDATE
   395     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.    CL*19
   396     12  DC-OPTION-CODE                PIC X.                        CL*15
   397         88  BIN-TO-GREG                VALUE ' '.                ELCDATE
   398         88  ELAPSED-BETWEEN-BIN        VALUE '1'.                ELCDATE
   399         88  EDIT-GREG-TO-BIN           VALUE '2'.                ELCDATE
   400         88  YMD-GREG-TO-BIN            VALUE '3'.                ELCDATE
   401         88  MDY-GREG-TO-BIN            VALUE '4'.                ELCDATE
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   9
* AJRCODT.cbl (/apps/prod/cid1p/copy/ELCDATE)
   402         88  JULIAN-TO-BIN              VALUE '5'.                ELCDATE
   403         88  BIN-PLUS-ELAPSED           VALUE '6'.                ELCDATE
   404         88  FIND-CENTURY               VALUE '7'.                   CL*22
   405         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.                ELCDATE
   406         88  EDIT-GREG-TO-BIN-3         VALUE '9'.                ELCDATE
   407         88  YMD-GREG-TO-BIN-3          VALUE 'A'.                ELCDATE
   408         88  MDY-GREG-TO-BIN-3          VALUE 'B'.                ELCDATE
   409         88  JULIAN-TO-BIN-3            VALUE 'C'.                ELCDATE
   410         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.                ELCDATE
   411         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.                   CL*14
   412         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.                   CL*14
   413         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.                   CL*14
   414         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.         CL*14
   415         88  CHECK-LEAP-YEAR            VALUE 'H'.                   CL*14
   416         88  BIN-3-TO-GREG              VALUE 'I'.                   CL*14
   417         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.                   CL*14
   418         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.                   CL*14
   419         88  CYMD-GREG-TO-BIN           VALUE 'L'.                   CL*14
   420         88  MDCY-GREG-TO-BIN           VALUE 'M'.                   CL*14
   421         88  MDY-GREG-TO-JULIAN         VALUE 'N'.                   CL*14
   422         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.                   CL*14
   423         88  YMD-GREG-TO-JULIAN         VALUE 'P'.                   CL*14
   424         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.                   CL*14
   425         88  THREE-CHARACTER-BIN                                  ELCDATE
   426                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.       CL*14
   427         88  GREGORIAN-TO-BIN                                        CL**2
   428                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.    CL*14
   429         88  BIN-TO-GREGORIAN                                        CL**2
   430                  VALUES ' ' '1' 'I' '8' 'G'.                        CL*14
   431         88  JULIAN-TO-BINARY                                        CL**2
   432                  VALUES '5' 'C' 'E' 'F'.                            CL*14
   433     12  DC-ERROR-CODE                 PIC X.                        CL*15
   434         88  NO-CONVERSION-ERROR        VALUE ' '.                   CL**3
   435         88  DATE-CONVERSION-ERROR                                ELCDATE
   436                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.        CL*14
   437         88  DATE-IS-ZERO               VALUE '1'.                ELCDATE
   438         88  DATE-IS-NON-NUMERIC        VALUE '2'.                ELCDATE
   439         88  DATE-IS-INVALID            VALUE '3'.                ELCDATE
   440         88  DATE1-GREATER-DATE2        VALUE '4'.                ELCDATE
   441         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.                ELCDATE
   442         88  DATE-INVALID-OPTION        VALUE '9'.                ELCDATE
   443         88  INVALID-CENTURY            VALUE 'A'.                ELCDATE
   444         88  ONLY-CENTURY               VALUE 'B'.                ELCDATE
   445         88  ONLY-LEAP-YEAR             VALUE 'C'.                ELCDATE
   446         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.              CL**3
   447     12  DC-END-OF-MONTH               PIC X.                        CL*15
   448         88  CALCULATE-END-OF-MONTH     VALUE '1'.                ELCDATE
   449     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.         CL*15
   450         88  USE-NORMAL-PROCESS         VALUE ' '.                ELCDATE
   451         88  ADJUST-DOWN-100-YRS        VALUE '1'.                ELCDATE
   452         88  ADJUST-UP-100-YRS          VALUE '2'.                ELCDATE
   453     12  FILLER                        PIC X.                        CL*15
   454     12  DC-CONVERSION-DATES.                                        CL*15
   455         16  DC-BIN-DATE-1             PIC XX.                       CL*15
   456         16  DC-BIN-DATE-2             PIC XX.                       CL*15
   457         16  DC-GREG-DATE-1-EDIT       PIC X(08).                    CL*15
   458         16  DC-GREG-DATE-1-EDIT-R REDEFINES                         CL*15
   459                       DC-GREG-DATE-1-EDIT.                       ELCDATE
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  10
* AJRCODT.cbl (/apps/prod/cid1p/copy/ELCDATE)
   460             20  DC-EDIT1-MONTH        PIC 99.                       CL*15
   461             20  SLASH1-1              PIC X.                        CL*15
   462             20  DC-EDIT1-DAY          PIC 99.                       CL*15
   463             20  SLASH1-2              PIC X.                        CL*15
   464             20  DC-EDIT1-YEAR         PIC 99.                       CL*15
   465         16  DC-GREG-DATE-2-EDIT       PIC X(08).                    CL*15
   466         16  DC-GREG-DATE-2-EDIT-R REDEFINES                         CL*15
   467                     DC-GREG-DATE-2-EDIT.                         ELCDATE
   468             20  DC-EDIT2-MONTH        PIC 99.                       CL*15
   469             20  SLASH2-1              PIC X.                        CL*15
   470             20  DC-EDIT2-DAY          PIC 99.                       CL*15
   471             20  SLASH2-2              PIC X.                        CL*15
   472             20  DC-EDIT2-YEAR         PIC 99.                       CL*15
   473         16  DC-GREG-DATE-1-YMD        PIC 9(06).                    CL*15
   474         16  DC-GREG-DATE-1-YMD-R  REDEFINES                         CL*15
   475                     DC-GREG-DATE-1-YMD.                          ELCDATE
   476             20  DC-YMD-YEAR           PIC 99.                       CL*15
   477             20  DC-YMD-MONTH          PIC 99.                       CL*15
   478             20  DC-YMD-DAY            PIC 99.                       CL*15
   479         16  DC-GREG-DATE-1-MDY        PIC 9(06).                    CL*15
   480         16  DC-GREG-DATE-1-MDY-R REDEFINES                          CL*15
   481                      DC-GREG-DATE-1-MDY.                         ELCDATE
   482             20  DC-MDY-MONTH          PIC 99.                       CL*15
   483             20  DC-MDY-DAY            PIC 99.                       CL*15
   484             20  DC-MDY-YEAR           PIC 99.                       CL*15
   485         16  DC-GREG-DATE-1-ALPHA.                                   CL*15
   486             20  DC-ALPHA-MONTH        PIC X(10).                    CL*15
   487             20  DC-ALPHA-DAY          PIC 99.                       CL*15
   488             20  FILLER                PIC XX.                       CL*15
   489             20  DC-ALPHA-CENTURY.                                   CL*15
   490                 24 DC-ALPHA-CEN-N     PIC 99.                       CL*15
   491             20  DC-ALPHA-YEAR         PIC 99.                       CL*15
   492         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.           CL*15
   493         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.           CL*15
   494         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.           CL*15
   495         16  DC-JULIAN-DATE            PIC 9(05).                    CL*15
   496         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE                CL*20
   497                                       PIC 9(05).                    CL*20
   498         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.                  CL*15
   499             20  DC-JULIAN-YEAR        PIC 99.                       CL*15
   500             20  DC-JULIAN-DAYS        PIC 999.                      CL*15
   501         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.       CL*15
   502         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.    CL*15
   503         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.    CL*15
   504     12  DATE-CONVERSION-VARIBLES.                                   CL*15
   505         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.            CL*15
   506         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.          CL*15
   507             20  FILLER                PIC 9(3).                     CL*15
   508             20  HOLD-CEN-1-CCYY.                                    CL*15
   509                 24  HOLD-CEN-1-CC     PIC 99.                       CL*17
   510                 24  HOLD-CEN-1-YY     PIC 99.                       CL*17
   511             20  HOLD-CEN-1-MO         PIC 99.                       CL*17
   512             20  HOLD-CEN-1-DA         PIC 99.                       CL*17
   513         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.            CL*15
   514             20  HOLD-CEN-1-R-MO       PIC 99.                       CL*17
   515             20  HOLD-CEN-1-R-DA       PIC 99.                       CL*17
   516             20  HOLD-CEN-1-R-CCYY.                                  CL*15
   517                 24  HOLD-CEN-1-R-CC   PIC 99.                       CL*17
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  11
* AJRCODT.cbl (/apps/prod/cid1p/copy/ELCDATE)
   518                 24  HOLD-CEN-1-R-YY   PIC 99.                       CL*17
   519             20  FILLER                PIC 9(3).                     CL*15
   520         16  HOLD-CENTURY-1-X.                                       CL*15
   521             20  FILLER                PIC X(3)  VALUE SPACES.       CL*15
   522             20  HOLD-CEN-1-X-CCYY.                                  CL*15
   523                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.          CL*17
   524                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.          CL*17
   525             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.          CL*17
   526             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.          CL*17
   527         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.          CL*15
   528             20  HOLD-CEN-1-R-X-MO     PIC XX.                       CL*17
   529             20  HOLD-CEN-1-R-X-DA     PIC XX.                       CL*17
   530             20  HOLD-CEN-1-R-X-CCYY.                                CL*15
   531                 24  HOLD-CEN-1-R-X-CC PIC XX.                       CL*17
   532                 24  HOLD-CEN-1-R-X-YY PIC XX.                       CL*17
   533             20  FILLER                PIC XXX.                      CL*23
   534         16  DC-BIN-DATE-EXPAND-1      PIC XXX.                      CL*15
   535         16  DC-BIN-DATE-EXPAND-2      PIC XXX.                      CL*15
   536         16  DC-JULIAN-DATE-1          PIC 9(07).                    CL*15
   537         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.          CL*15
   538             20  DC-JULIAN-1-CCYY.                                   CL*15
   539                 24  DC-JULIAN-1-CC    PIC 99.                       CL*15
   540                 24  DC-JULIAN-1-YR    PIC 99.                       CL*15
   541             20  DC-JULIAN-DA-1        PIC 999.                      CL*15
   542         16  DC-JULIAN-DATE-2          PIC 9(07).                    CL*15
   543         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.          CL*15
   544             20  DC-JULIAN-2-CCYY.                                   CL*15
   545                 24  DC-JULIAN-2-CC    PIC 99.                       CL*15
   546                 24  DC-JULIAN-2-YR    PIC 99.                       CL*15
   547             20  DC-JULIAN-DA-2        PIC 999.                      CL*15
   548         16  DC-GREG-DATE-A-EDIT.                                    CL*15
   549             20  DC-EDITA-MONTH        PIC 99.                       CL*15
   550             20  SLASHA-1              PIC X VALUE '/'.              CL*15
   551             20  DC-EDITA-DAY          PIC 99.                       CL*15
   552             20  SLASHA-2              PIC X VALUE '/'.              CL*15
   553             20  DC-EDITA-CCYY.                                      CL*15
   554                 24  DC-EDITA-CENT     PIC 99.                       CL*15
   555                 24  DC-EDITA-YEAR     PIC 99.                       CL*15
   556         16  DC-GREG-DATE-B-EDIT.                                    CL*15
   557             20  DC-EDITB-MONTH        PIC 99.                       CL*15
   558             20  SLASHB-1              PIC X VALUE '/'.              CL*15
   559             20  DC-EDITB-DAY          PIC 99.                       CL*15
   560             20  SLASHB-2              PIC X VALUE '/'.              CL*15
   561             20  DC-EDITB-CCYY.                                      CL*15
   562                 24  DC-EDITB-CENT     PIC 99.                       CL*15
   563                 24  DC-EDITB-YEAR     PIC 99.                       CL*15
   564         16  DC-GREG-DATE-CYMD         PIC 9(08).                    CL*15
   565         16  DC-GREG-DATE-CYMD-R REDEFINES                           CL*15
   566                              DC-GREG-DATE-CYMD.                  ELCDATE
   567             20  DC-CYMD-CEN           PIC 99.                       CL*15
   568             20  DC-CYMD-YEAR          PIC 99.                       CL*15
   569             20  DC-CYMD-MONTH         PIC 99.                       CL*15
   570             20  DC-CYMD-DAY           PIC 99.                       CL*15
   571         16  DC-GREG-DATE-MDCY         PIC 9(08).                    CL*15
   572         16  DC-GREG-DATE-MDCY-R REDEFINES                           CL*15
   573                              DC-GREG-DATE-MDCY.                  ELCDATE
   574             20  DC-MDCY-MONTH         PIC 99.                       CL*15
   575             20  DC-MDCY-DAY           PIC 99.                       CL*15
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  12
* AJRCODT.cbl (/apps/prod/cid1p/copy/ELCDATE)
   576             20  DC-MDCY-CEN           PIC 99.                       CL*15
   577             20  DC-MDCY-YEAR          PIC 99.                       CL*15
   578    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.      ELCDATE
   579        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.        ELCDATE
   580    12  DC-EL310-DATE                  PIC X(21).                    CL*26
   581    12  FILLER                         PIC X(28).                    CL*26
   582
   583 PROCEDURE DIVISION.
   584
   585 0000-BEGIN.
   586
   587     PERFORM 0020-OPEN-FILES     THRU 0020-EXIT
   588     PERFORM 0040-INIT           THRU 0040-EXIT
   589
   590     PERFORM 0050-PROCESS-FILE   THRU 0050-EXIT UNTIL
   591          (END-OF-ERCOMP)
   592
   593     PERFORM 0030-CLOSE-FILES    THRU 0030-EXIT
   594
   595     DISPLAY ' RECORDS IN    ' WS-ERCOMP-IN
   596     DISPLAY ' RECORDS FIXED ' WS-ERCOMP-FIX
   597     GOBACK
   598     .
   599 0002-EXIT.
   600     EXIT.
   601
   602 0020-OPEN-FILES.
   603
   604     OPEN I-O ERCOMP
   605
   606     IF ERCOMP-FILE-STATUS NOT = '00' AND '97'
   607        DISPLAY ' ERCOMP OPEN ERROR ' ERCOMP-FILE-STATUS
   608        PERFORM ABEND-PGM
   609     END-IF
   610
   611     .
   612
   613 0020-EXIT.
   614     EXIT.
   615
   616 0030-CLOSE-FILES.
   617
   618     CLOSE ERCOMP
   619
   620     IF ERCOMP-FILE-STATUS NOT = '00' AND '97'
   621        DISPLAY ' ERCOMP CLOSE ERROR ' ERCOMP-FILE-STATUS
   622        PERFORM ABEND-PGM
   623     END-IF
   624
   625     .
   626
   627 0030-EXIT.
   628     EXIT.
   629
   630 0040-INIT.
   631
   632     PERFORM 0120-START-ERCOMP   THRU 0120-EXIT
   633     PERFORM 0110-READ-ERCOMP    THRU 0110-EXIT
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  13
* AJRCODT.cbl
   634     .
   635
   636 0040-EXIT.
   637     EXIT.
   638
   639 0050-PROCESS-FILE.
   640
   641     IF CO-RESP-NO = '0005500108' OR '0005500166' OR
   642         '0005500189' OR '0005500190' OR '0005500193' OR
   643         '0005500199' OR '0005500329' OR '0005500341' OR
   644         '0005500342' OR '0005500352' OR '0005500353' OR
   645         '05500365CE' OR '05500367CE' OR '0005500161' OR
   646         '0005500165' OR '0005500188' OR '0005500197' OR
   647         '0005500356' OR '0005500357' OR '0005500358' OR
   648         '0005500167' OR '0005500177' OR '0005500179' OR
   649         '0005500181' OR '0005500187' OR '0005500196' OR
   650         '0005500182' OR '0005500159' OR '0005500160' OR
   651         '0005500162' OR '0005500163' OR '0005500180' OR
   652         '0005500184' OR '0005500330' OR '0005500359' OR
   653         '0005500113' OR '0005500114' OR '0005500115' OR
   654         '0005500116' OR '0005500119' OR '0005500200' OR
   655         '0005500168' OR '0005500178' OR '0005500126' OR
   656         '0005500128' OR '0005500122' OR '0005500123' OR
   657         '0005500124' OR '0005500343'
   658           MOVE LOW-VALUES TO CO-FIRST-WRITTEN-DT
   659     ELSE
   660           MOVE WS-INITIAL-DT TO CO-FIRST-WRITTEN-DT
   661     END-IF
   662
   663     PERFORM 0080-REWRITE-ERCOMP THRU 0080-EXIT
   664
   665     PERFORM 0110-READ-ERCOMP    THRU 0110-EXIT
   666
   667     .
   668
   669 0050-EXIT.
   670     EXIT.
   671
   672 0080-REWRITE-ERCOMP.
   673
   674     REWRITE COMPENSATION-MASTER
   675
   676     IF ERCOMP-FILE-STATUS = '00'
   677        ADD 1                    TO WS-ERCOMP-FIX
   678     ELSE
   679        DISPLAY ' ERCOMP REWRITE ERROR ' ERCOMP-FILE-STATUS
   680        PERFORM ABEND-PGM
   681     END-IF
   682
   683     .
   684 0080-EXIT.
   685     EXIT.
   686
   687 0110-READ-ERCOMP.
   688
   689     READ ERCOMP NEXT RECORD
   690
   691     IF (ERCOMP-FILE-STATUS = '10' OR '23')
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  14
* AJRCODT.cbl
   692        SET END-OF-ERCOMP        TO TRUE
   693     ELSE
   694        IF ERCOMP-FILE-STATUS NOT = '00'
   695           DISPLAY ' ERCOMP READ ERROR ' ERCOMP-FILE-STATUS
   696           PERFORM ABEND-PGM
   697        END-IF
   698     END-IF
   699
   700     IF NOT END-OF-ERCOMP
   701         ADD +1              TO WS-ERCOMP-IN
   702     END-IF
   703
   704     .
   705 0110-EXIT.
   706     EXIT.
   707
   708 0120-START-ERCOMP.
   709
   710     MOVE LOW-VALUES             TO CO-CONTROL-PRIMARY
   711     MOVE X'01'                  TO CO-COMPANY-CD
   712
   713     START ERCOMP KEY NOT < CO-CONTROL-PRIMARY
   714
   715     IF ERCOMP-FILE-STATUS = '10' OR '23'
   716        SET END-OF-ERCOMP        TO TRUE
   717     ELSE
   718        IF ERCOMP-FILE-STATUS NOT = '00'
   719           DISPLAY ' ERCOMP START ERROR ' ERCOMP-FILE-STATUS
   720           PERFORM ABEND-PGM
   721        END-IF
   722     END-IF
   723
   724     .
   725 0120-EXIT.
   726     EXIT.
   727
   728 8510-DATE-CONVERSION.
   729
   730     CALL 'ELDATCX' USING DATE-CONVERSION-DATA
   731
   732     .
   733
   734 8590-EXIT.
   735     EXIT.
   736
   737
   738
   739
   740 ABEND-PGM.
*  741                                 COPY ELCABEND.
   742***************************************************************** 04/14/98
   743*                                                               * ELCABEND
   744*                            ELCABEND.                          *    LV003
   745*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
   746*                            VMOD 2.002                              CL**2
   747*                                                               * ELCABEND
   748*                THIS SECTION DISPLAYS THE NECESSARY MESSAGES   * ELCABEND
   749*            AND THEN ABENDS.                                   * ELCABEND
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  15
* AJRCODT.cbl (/apps/prod/cid1p/copy/ELCABEND)
   750*                                                               * ELCABEND
   751*  NO  CID  MODS  IN  COPYBOOK  ELCABEND                        * ELCABEND
   752*                                                               * ELCABEND
   753***************************************************************** ELCABEND
   754*APS-010.                                                         ELCABEND
   755     DISPLAY WS-ABEND-MESSAGE.                                    ELCABEND
   756     DISPLAY WS-ABEND-MESSAGE UPON CONSOLE.                       ELCABEND
   757                                                                  ELCABEND
   758     IF WS-ABEND-FILE-STATUS NOT = ZERO                           ELCABEND
   759         DISPLAY 'FILE STATUS = ' WS-ABEND-FILE-STATUS            ELCABEND
   760         DISPLAY 'FILE STATUS = ' WS-ABEND-FILE-STATUS            ELCABEND
   761                                 UPON CONSOLE.                    ELCABEND
   762                                                                  ELCABEND
   763     IF WS-RETURN-CODE NOT = ZERO                                 ELCABEND
   764         DISPLAY 'RETURN CODE = '  WS-RETURN-CODE                 ELCABEND
   765         DISPLAY 'RETURN CODE = '  WS-RETURN-CODE                 ELCABEND
   766                                 UPON CONSOLE.                    ELCABEND
   767                                                                  ELCABEND
   768     DISPLAY 'PROGRAM WILL NOW ABEND **************'              ELCABEND
   769     DISPLAY 'PROGRAM WILL NOW ABEND **************'              ELCABEND
   770                                 UPON CONSOLE.                    ELCABEND
   771                                                                  ELCABEND
   772     DIVIDE WS-ZERO BY WS-ZERO GIVING WS-ZERO.                    ELCABEND
   773     CALL 'ABORTME'.
   774                                                                  ELCABEND
   775 APS-EXIT.                                                        ELCABEND
   776     EXIT.                                                        ELCABEND
   777
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:        2140     Code:        1938
