* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   1
* ECS010T1.cbl
* Options: int("ECS010T1.int") anim csi verbose NOBOUND PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("ECS010T1.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"ebmlsfile" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" NOCHECKDIV NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"32" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"ECS010T1.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST
*          "ECS010T1.lst" LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0"
*          NOMAPNAME NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT
*          NOMOVELENCHECK NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT
*          NONCHAR NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR NOSTICKY-LINKAGE
*          NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"2" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                 ECS010.
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 04/27/94 07:51:58.
     7*              PROGRAM REVIEWED FOR YEAR 2000 COMPLIANCE
     8*                            VMOD=2.082.
     9
    10*AUTHOR.        LOGIC, INC.
    11*               DALLAS, TEXAS.
    12
    13*DATE-COMPILED.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   2
* ECS010T1.cbl
    14
    15*SECURITY.   *****************************************************
    16*            *                                                   *
    17*            *   THIS PROGRAM IS THE PROPERTY OF LOGIC, INC.     *
    18*            *                                                   *
    19*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
    20*            *   OF LOGIC, INC. IS EXPRESSLY PROHIBITED WITHOUT  *
    21*            *   THE PRIOR WRITTEN PERMISSION OF LOGIC INC.      *
    22*            *                                                   *
    23*            *****************************************************
    24
    25*REMARKS.
    26*        THIS PROGRAM ACCEPTS VALIDATED TRANSACTIONS FROM EL522
    27*        AND APPLIES THEM TO THE CERTIFICATE MASTER FILE.
    28*        EXTRACTS ARE PRODUCED FOR PRODUCTION  EARNED PREMIUM &
    29*        LOSS, REINSURANCE, COMMISSIONS, CLAIMS REGISTER, ETC.
    30******************************************************************
    31*                   C H A N G E   L O G
    32*
    33* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    34*-----------------------------------------------------------------
    35*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    36* EFFECTIVE    NUMBER
    37*-----------------------------------------------------------------
    38* 061802                   PEMA  ADD PROCESS FOR PEOPLES
    39* 062602    2002061900011  SMVA  CHANGE SYS009 SYSOUT TO FILE WITH
    40*                              ORGANIZATION AS LINE SEQUENTIAL
    41* 070102                   SMVA  CLEAN UP COMPILE ERRORS
    42* 080702    2002061800008  PEMA  ADD PROCESS FOR SUNFLOWER
    43* 092602    2002091900008  PEMA  INCREASE NUMBER OF MAXIMUM
    44*                                  BENEFIT CODES FROM 450 TO 900
    45* 111402    2001061800003  PEMA  ADD DCC PROCESSING
    46* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
    47* 052703                   PEMA  MODIFY CEDE BALLOON PREM TO NSP
    48* 070203                   PEMA  BUILD REIN COMP DATA FOR NSP
    49* 100703    2003080800002  PEMA  ADD SUPER GAP PROCESSING
    50* 123003                   PEMA  MODIFY COMPUTE STMTS FOR REIN
    51* 040504    2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
    52* 062104    2004050700001  SMVA  ADD NEW FILES TO AUTOMATE ME BALANCING
    53* 102204    2004101500007  PEMA  IBNR FOR DCC
    54* 111204    2004110300005  PEMA  SPLIT SPP BANK FEE
    55* 123004                   PEMA  ADD REFUND PROCESSING FOR "MONTHLY"
    56* 020305    2005020000000  PEMA  ADD CLP STATE PROCESSING
    57* 092705  CR2005050300006  PEMA  ADD SPP LEASES
    58* 052306  CR2006050800002  PEMA  ADD COMM TYPE 'J'
    59* 061206  CR2006050500001  PEMA  ADD FIRST PREMIER BANK
    60* 011207                   PEMA  PASS SIG SW TO BATCH CERT FILE
    61* 041508  CR2008030300004  PEMA  ADD POST CARD REFUND PROCESSING
    62* 042408  CR2007110500003  PEMA  ADD REFUND INTEREST PROCESSING
    63* 050808  IR2008050100002  PEMA  CHECK FOR LF AMT = ZERO
    64* 080808  IR2008080100002  PEMA  CHECK FOR AH AMT = ZERO
    65* 111208  IR2008111000001  PEMA  CORRECT BANK FEE CALC.
    66******************************************************************
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   3
* ECS010T1.cbl
    68 ENVIRONMENT DIVISION.
    69 CONFIGURATION SECTION.
    70 SPECIAL-NAMES.
    71     C02 IS LCP-CH2
    72     C03 IS LCP-CH3
    73     C04 IS LCP-CH4
    74     C05 IS LCP-CH5
    75     C06 IS LCP-CH6
    76     C07 IS LCP-CH7
    77     C08 IS LCP-CH8
    78     C09 IS LCP-CH9
    79     C10 IS LCP-CH10
    80     C11 IS LCP-CH11
    81     C12 IS LCP-CH12
    82     S01 IS LCP-P01
    83     S02 IS LCP-P02.
    84
    85 INPUT-OUTPUT SECTION.
    86 FILE-CONTROL.
    87
    88     SELECT PENDING-EXTRACT  ASSIGN TO SYS005.
    89
    90     SELECT CERT-MASTER-IN   ASSIGN TO SYS010.
    91
    92     SELECT ERACCTT-IN       ASSIGN TO ERACCTT
    93                             ACCESS IS SEQUENTIAL
    94                             ORGANIZATION IS INDEXED
    95                             FILE STATUS IS ERACCTT-FILE-STATUS
    96                             RECORD KEY IS AM-CONTROL-PRIMARY.
    97
    98     SELECT ERRTBL-IN        ASSIGN TO ERRTBLT
    99                             ACCESS IS DYNAMIC
   100                             ORGANIZATION IS INDEXED
   101                             FILE STATUS IS ERRTBL-FILE-STATUS
   102                             RECORD KEY IS RE-CONTROL-PRIMARY.
   103
   104     SELECT ERCTBL           ASSIGN TO ERCTBLT
   105                             ACCESS IS DYNAMIC
   106                             ORGANIZATION IS INDEXED
   107                             FILE STATUS IS ERCTBL-FILE-STATUS
   108                             RECORD KEY IS CT-CONTROL-PRIMARY.
   109
   110     SELECT ERMEBL-INOUT     ASSIGN TO ERMEBL
   111                             ORGANIZATION INDEXED
   112                             ACCESS DYNAMIC
   113                             RECORD KEY ME-CONTROL-PRIMARY
   114                             FILE STATUS ERMEBL-FILE-STATUS.
   115
   116     SELECT ERRESC-IN        ASSIGN TO ERRESC
   117                             ORGANIZATION IS INDEXED
   118                             ACCESS IS DYNAMIC
   119                             RECORD KEY IS ERRESC-RECORD-KEY
   120                             FILE STATUS IS ERRESC-FILE-STATUS.
   121
   122     SELECT ELCRTT           ASSIGN TO ELCRTT
   123                             ACCESS IS DYNAMIC
   124                             ORGANIZATION IS INDEXED
   125                             FILE STATUS IS ELCRTT-FILE-STATUS
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   4
* ECS010T1.cbl
   126                             RECORD KEY IS CS-CONTROL-PRIMARY.
   127
   128     SELECT ERAGTC           ASSIGN TO ERAGTC
   129                             ACCESS IS DYNAMIC
   130                             ORGANIZATION IS INDEXED
   131                             FILE STATUS IS ERAGTC-FILE-STATUS
   132                             RECORD KEY IS AG-CONTROL-PRIMARY.
   133
   134     SELECT CERT-MASTER-OUT  ASSIGN TO SYS011.
   135
   136     SELECT DETAIL-EXTR      ASSIGN TO SYS017.
   137
   138     SELECT SUMMARY-EXTR     ASSIGN TO SYS018.
   139
   140
   141     SELECT ME-ECS010-BALANCE
   142                             ASSIGN TO SYS012
   143                             ORGANIZATION IS LINE SEQUENTIAL.
   144
   145     SELECT ME50-ECS010-BALANCE
   146                             ASSIGN TO SYS013
   147                             ORGANIZATION IS LINE SEQUENTIAL.
   148
   149     SELECT DISPLAY-PRT      ASSIGN TO SYS022.
   150
   151     SELECT DISK-DATE        ASSIGN TO SYS019.
   152
   153     SELECT PRINT-COPY       ASSIGN TO SYS008.
   154
   155     SELECT MISMATCH-REPORT  ASSIGN TO SYS009.
   156
   157     SELECT FICH             ASSIGN TO SYS020.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   5
* ECS010T1.cbl
   159 DATA DIVISION.
   160 FILE SECTION.
   161
   162 FD  PENDING-EXTRACT
   163     BLOCK CONTAINS 0 RECORDS
   164     RECORDING MODE F.
   165
*  166                             COPY ERCEXTD.
   167******************************************************************04/29/98
   168*                                                                *ERCEXTD
   169*                                                                *ERCEXTD
   170*                            ERCEXTD                             *   LV002
   171*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
   172*                            VMOD=2.002                          *   CL**2
   173*                                                                *ERCEXTD
   174*   FILE DESCRIPTION = ONLINE TO BATCH FILE INTERFACE AND REPORT *ERCEXTD
   175*                      EXTRACT FOR OFFLINE REPORTING.            *ERCEXTD
   176*                                                                *ERCEXTD
   177*     THIS FILE IS CREATED FROM ERCEXTR EXTRACT INTERFACE        *ERCEXTD
   178*  FOR THE FOLLOWING RECORD TYPES. THE MAIN BODY OF EACH RECORD  *ERCEXTD
   179*  CONTAINS A STRAIGHT COPY OF THE EX-DATA-AREA IN EXCEXTR.      *ERCEXTD
   180*                                                                *ERCEXTD
   181*         RECORD                                                 *ERCEXTD
   182*          TYPE          PROGRAM USING                           *ERCEXTD
   183*        --------        --------------------------------        *ERCEXTD
   184*           A             EL522  PENDING BUSINESS EXTRACT        *ERCEXTD
   185*           B             EL522  PENDING CLAIMS   EXTRACT        *ERCEXTD
   186*           C             EL522  CERT CHANGES     EXTRACT        *ERCEXTD
   187*                                                                *ERCEXTD
   188* -------------------------------------------------------------- *ERCEXTD
   189*                                                                *ERCEXTD
   190*   FILE TYPE = SEQUENTIAL                                       *ERCEXTD
   191*   RECORD SIZE = 588   RECFORM = FIX                            *ERCEXTD
   192*                                                                *ERCEXTD
   193*   FILENAME = EREXTD                                            *ERCEXTD
   194*                                                                *ERCEXTD
   195******************************************************************ERCEXTD
   196                                                                  ERCEXTD
   197 01  EXTRACT-DATA-RECORD.                                         ERCEXTD
   198     12  ED-RECORD-ID                        PIC XX.              ERCEXTD
   199         88  VALID-IN-ID                           VALUE 'ED'.    ERCEXTD
   200                                                                  ERCEXTD
   201     12  ED-RECORD-TYPE                      PIC X.               ERCEXTD
   202         88  ED-PENDING-BUSINESS                   VALUE 'A'.     ERCEXTD
   203         88  ED-PENDING-CLAIMS                     VALUE 'B'.     ERCEXTD
   204         88  ED-CERT-CHANGES                       VALUE 'C'.     ERCEXTD
   205                                                                  ERCEXTD
   206     12  ED-DATA-AREAS                       PIC X(585).          ERCEXTD
   207                                                                  ERCEXTD
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   6
* ECS010T1.cbl
   209 FD  CERT-MASTER-IN
*  210                             COPY ECSCRIFD.
   211******************************************************************07/10/97
   212*                                                                *ECSCRIFD
   213*                            ECSCRIFD                            *   LV001
   214*                            VMOD 2.005                          *ECSCRIFD
   215*                                                                *ECSCRIFD
   216*  NO CID MODS FOR COPYBOOK ECSCRIFD                             *ECSCRIFD
   217*                                                                *ECSCRIFD
   218******************************************************************ECSCRIFD
   219     BLOCK CONTAINS 0 RECORDS
   220     RECORDING MODE F.                                            ECSCRIFD
   221                                                                  ECSCRIFD
   222 01  CERT-IN-RECORD.                                              ECSCRIFD
   223                                                                  ECSCRIFD
   224     12  FILLER                            PIC XXX.               ECSCRIFD
   225     12  CIR-CONTROL                       PIC X(36).             ECSCRIFD
   226     12  FILLER                            PIC X(66).             ECSCRIFD
   227     12  CIR-JOINT-AGE                     PIC 99.                ECSCRIFD
   228     12  FILLER                            PIC X(20).             ECSCRIFD
   229     12  CIR-LFTYP                         PIC XX.                ECSCRIFD
   230     12  FILLER                            PIC X(14).             ECSCRIFD
   231     12  CIR-LFAMT                         PIC S9(9)V99   COMP-3. ECSCRIFD
   232     12  FILLER                            PIC X(39).             ECSCRIFD
   233     12  CIR-LFRFND-CALC                   PIC S9(7)V99   COMP-3. ECSCRIFD
   234     12  FILLER                            PIC X(45).             ECSCRIFD
   235     12  CIR-AHTYP                         PIC XX.                ECSCRIFD
   236     12  FILLER                            PIC X(35).             ECSCRIFD
   237     12  CIR-AHRFND-CALC                   PIC S9(7)V99   COMP-3. ECSCRIFD
   238     12  FILLER                            PIC X(41).             ECSCRIFD
   239     12  CIR-APR                           PIC S999V9(4)  COMP-3. ECSCRIFD
   240     12  FILLER                            PIC X(48).             ECSCRIFD
   241     12  CIR-REIN-TABLE                    PIC XXX.               ECSCRIFD
   242     12  FILLER                            PIC X(9).              ECSCRIFD
   243     12  CIR-SUM-CAN-CNT-YTD               PIC S999       COMP-3. ECSCRIFD
   244     12  FILLER                            PIC X(120).            ECSCRIFD
   245     12  CIR-DTHAMT-YTD                    PIC S9(9)V99   COMP-3. ECSCRIFD
   246     12  FILLER                            PIC X(73).             ECSCRIFD
   247     12  CIR-DISAMT-YTD                    PIC S9(9)V99   COMP-3. ECSCRIFD
   248     12  FILLER                            PIC X(464).            ECSCRIFD
   249                                                                  ECSCRIFD
   250******************************************************************ECSCRIFD
   251
   252 01  CI-RECORD.
   253     12  FILLER          PIC  X(03).
   254     12  CI-ACCOUNT-CONTROL.
   255         16  CI-CARRIER      PIC  X(01).
   256         16  CI-GROUPING     PIC  X(06).
   257         16  CI-STATE        PIC  X(02).
   258         16  CI-ACCOUNT      PIC  X(10).
   259     12  FILLER          PIC  X(06).
   260     12  CI-CERT-NO.
   261         16  CI-CERT     PIC X(10).
   262         16  CI-CERT-SFX PIC X.
   263     12  FILLER          PIC  X(1017).
   264
   265******************************************************
   266*   THIS FILE DEFINITION WAS ADDED TO ACCOMMODATE THE EXECUTION
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   7
* ECS010T1.cbl
   267*   OF A "MID MONTH" BILLING REPORT (EL562) FOR
   268*   COMMERCIAL FEDERAL BANK
   269******************************************************
   270 01  CF-RECORD.
   271     12  FILLER          PIC X(759).
   272     12  CF-THIRD-AGENT  PIC X(10).
   273     12  FILLER          PIC X(7).
   274     12  CF-FOURTH-AGENT PIC X(10).
   275     12  FILLER          PIC X(270).
   276
   277******************************************************
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   8
* ECS010T1.cbl
   279 FD  ERACCTT-IN.
   280
*  281                             COPY ERCACCT.
   282******************************************************************04/19/98
   283*                                                                *ERCACCT
   284*                                                                *ERCACCT
   285*                            ERCACCT                             *   LV031
   286*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL*31
   287*                            VMOD=2.031                          *ERCACCT
   288*                                                                *ERCACCT
   289*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *ERCACCT
   290*                                                                *ERCACCT
   291*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *ERCACCT
   292*   VSAM ACCOUNT MASTER FILES.                                   *ERCACCT
   293*                                                                *ERCACCT
   294*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *ERCACCT
   295*                                                                *ERCACCT
   296*   FILE TYPE = VSAM,KSDS                                        *ERCACCT
   297*   RECORD SIZE = 2000  RECFORM = FIX                            *ERCACCT
   298*                                                                *ERCACCT
   299*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *ERCACCT
   300*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *ERCACCT
   301*                                                                *ERCACCT
   302*   LOG = NO                                                     *ERCACCT
   303*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *ERCACCT
   304*                                                                *ERCACCT
   305*                                                                *ERCACCT
   306******************************************************************ERCACCT
   307*                   C H A N G E   L O G
   308*
   309* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   310*-----------------------------------------------------------------
   311*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   312* EFFECTIVE    NUMBER
   313*-----------------------------------------------------------------
   314* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
   315* 092705    2005050300006  PEMA  ADD SPP LEASES
   316* 022808    2007083100002  PEMA  ADD FREEZE STATUS
   317* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
   318* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
   319* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
   320* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
   321******************************************************************
   322                                                                  ERCACCT
   323 01  ACCOUNT-MASTER.                                              ERCACCT
   324     12  AM-RECORD-ID                      PIC XX.                ERCACCT
   325         88  VALID-AM-ID                      VALUE 'AM'.         ERCACCT
   326                                                                  ERCACCT
   327     12  AM-CONTROL-PRIMARY.                                      ERCACCT
   328         16  AM-COMPANY-CD                 PIC X.                 ERCACCT
   329         16  AM-MSTR-CNTRL.                                       ERCACCT
   330             20  AM-CONTROL-A.                                    ERCACCT
   331                 24  AM-CARRIER            PIC X.                 ERCACCT
   332                 24  AM-GROUPING.                                 ERCACCT
   333                     28 AM-GROUPING-PREFIX PIC XXX.               ERCACCT
   334                     28 AM-GROUPING-PRIME  PIC XXX.               ERCACCT
   335                 24  AM-STATE              PIC XX.                ERCACCT
   336                 24  AM-ACCOUNT.                                  ERCACCT
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   9
* ECS010T1.cbl (/apps/prod/cid1p/copy/ERCACCT)
   337                     28  AM-ACCOUNT-PREFIX PIC X(4).              ERCACCT
   338                     28  AM-ACCOUNT-PRIME  PIC X(6).              ERCACCT
   339             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A            ERCACCT
   340                                           PIC X(19).             ERCACCT
   341             20  AM-CNTRL-B.                                      ERCACCT
   342                 24  AM-EXPIRATION-DT      PIC XX.                ERCACCT
   343                 24  FILLER                PIC X(4).              ERCACCT
   344             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.                 ERCACCT
   345                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.     ERCACCT
   346                                                                  ERCACCT
   347     12  AM-CONTROL-BY-VAR-GRP.                                   ERCACCT
   348         16  AM-COMPANY-CD-A1              PIC X.                 ERCACCT
   349         16  AM-VG-CARRIER                 PIC X.                 ERCACCT
   350         16  AM-VG-GROUPING                PIC X(6).              ERCACCT
   351         16  AM-VG-STATE                   PIC XX.                ERCACCT
   352         16  AM-VG-ACCOUNT                 PIC X(10).             ERCACCT
   353         16  AM-VG-DATE.                                          ERCACCT
   354             20  AM-VG-EXPIRATION-DT       PIC XX.                ERCACCT
   355             20  FILLER                    PIC X(4).              ERCACCT
   356         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE                  ERCACCT
   357                                           PIC 9(11)      COMP-3. ERCACCT
   358     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
   359         16  FILLER                        PIC X(10).
   360         16  AM-VG-KEY3.
   361             20  AM-VG3-ACCOUNT            PIC X(10).
   362             20  AM-VG3-EXP-DT             PIC XX.
   363         16  FILLER                        PIC X(4).
   364     12  AM-MAINT-INFORMATION.                                    ERCACCT
   365         16  AM-LAST-MAINT-DT              PIC XX.                ERCACCT
   366         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3. ERCACCT
   367         16  AM-LAST-MAINT-USER            PIC X(4).              ERCACCT
   368         16  FILLER                        PIC XX.                ERCACCT
   369                                                                  ERCACCT
   370     12  AM-EFFECTIVE-DT                   PIC XX.                ERCACCT
   371     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3. ERCACCT
   372                                                                  ERCACCT
   373     12  AM-PREV-DATES  COMP-3.                                   ERCACCT
   374         16  AM-PREV-EXP-DT                PIC 9(11).             ERCACCT
   375         16  AM-PREV-EFF-DT                PIC 9(11).             ERCACCT
   376                                                                  ERCACCT
   377     12  AM-REPORT-CODE-1                  PIC X(10).             ERCACCT
   378     12  AM-REPORT-CODE-2                  PIC X(10).             ERCACCT
   379                                                                  ERCACCT
   380     12  AM-CITY-CODE                      PIC X(4).              ERCACCT
   381     12  AM-COUNTY-PARISH                  PIC X(6).              ERCACCT
   382                                                                  ERCACCT
   383     12  AM-NAME                           PIC X(30).             ERCACCT
   384     12  AM-PERSON                         PIC X(30).             ERCACCT
   385     12  AM-ADDRS                          PIC X(30).             ERCACCT
   386     12  AM-CITY.
   387         16  AM-ADDR-CITY                  PIC X(28).
   388         16  AM-ADDR-STATE                 PIC XX.
   389     12  AM-ZIP.                                                  ERCACCT
   390         16  AM-ZIP-PRIME.                                        ERCACCT
   391             20  AM-ZIP-PRI-1ST            PIC X.                 ERCACCT
   392                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'. ERCACCT
   393             20  FILLER                    PIC X(4).              ERCACCT
   394         16  AM-ZIP-PLUS4                  PIC X(4).              ERCACCT
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  10
* ECS010T1.cbl (/apps/prod/cid1p/copy/ERCACCT)
   395     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.              ERCACCT
   396         16  AM-CAN-POSTAL-1               PIC XXX.               ERCACCT
   397         16  AM-CAN-POSTAL-2               PIC XXX.               ERCACCT
   398         16  FILLER                        PIC XXX.               ERCACCT
   399     12  AM-TEL-NO.                                               ERCACCT
   400         16  AM-AREA-CODE                  PIC 999.               ERCACCT
   401         16  AM-TEL-PRE                    PIC 999.               ERCACCT
   402         16  AM-TEL-NBR                    PIC 9(4).              ERCACCT
   403     12  AM-TEL-LOC                        PIC X.                 ERCACCT
   404         88  AM-TEL-AT-HOME                   VALUE 'H'.          ERCACCT
   405         88  AM-TEL-AT-BUSINESS               VALUE 'B'.          ERCACCT
   406                                                                  ERCACCT
   407     12  AM-COMM-STRUCTURE.                                       ERCACCT
   408         16  AM-DEFN-1.                                           ERCACCT
   409             20  AM-AGT-COMMS       OCCURS 10 TIMES.              ERCACCT
   410                 24  AM-AGT.                                      ERCACCT
   411                     28  AM-AGT-PREFIX     PIC X(4).              ERCACCT
   412                     28  AM-AGT-PRIME      PIC X(6).              ERCACCT
   413                 24  AM-COM-TYP            PIC X.                 ERCACCT
   414                 24  AM-L-COM              PIC SV9(5)     COMP-3. ERCACCT
   415                 24  AM-J-COM              PIC SV9(5)     COMP-3. ERCACCT
   416                 24  AM-A-COM              PIC SV9(5)     COMP-3. ERCACCT
   417                 24  AM-RECALC-LV-INDIC    PIC X.                 ERCACCT
   418                 24  AM-RETRO-LV-INDIC     PIC X.                 ERCACCT
   419                 24  AM-GL-CODES           PIC X.                 ERCACCT
   420                 24  AM-COMM-CHARGEBACK    PIC 9(02).             ERCACCT
   421                 24  FILLER                PIC X(01).             ERCACCT
   422         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.                   ERCACCT
   423             20  AM-COM-TBLS        OCCURS 10 TIMES.              ERCACCT
   424                 24  FILLER                PIC X(11).             ERCACCT
   425                 24  AM-L-COMA             PIC XXX.               ERCACCT
   426                 24  AM-J-COMA             PIC XXX.               ERCACCT
   427                 24  AM-A-COMA             PIC XXX.               ERCACCT
   428                 24  FILLER                PIC X(6).              ERCACCT
   429                                                                  ERCACCT
   430     12  AM-COMM-CHANGE-STATUS             PIC X.                 ERCACCT
   431         88  AM-COMMISSIONS-CHANGED           VALUE '*'.          ERCACCT
   432                                                                  ERCACCT
   433     12  AM-CSR-CODE                       PIC X(4).              ERCACCT
   434                                                                  ERCACCT
   435     12  AM-BILLING-STATUS                 PIC X.                 ERCACCT
   436         88  AM-ACCOUNT-BILLED                VALUE 'B'.          ERCACCT
   437         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.          ERCACCT
   438     12  AM-AUTO-REFUND-SW                 PIC X.                 ERCACCT
   439         88  AUTO-REFUNDS-USED                VALUE 'Y'.          ERCACCT
   440         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.      ERCACCT
   441     12  AM-GPCD                           PIC 99.                ERCACCT
   442     12  AM-IG                             PIC X.                 ERCACCT
   443         88  AM-HAS-INDIVIDUAL                VALUE '1'.          ERCACCT
   444         88  AM-HAS-GROUP                     VALUE '2'.          ERCACCT
   445     12  AM-STATUS                         PIC X.                 ERCACCT
   446         88  AM-ACCOUNT-ACTIVE                VALUE '0'.          ERCACCT
   447         88  AM-ACCOUNT-INACTIVE              VALUE '1'.          ERCACCT
   448         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.          ERCACCT
   449         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
   450         88  AM-ACCOUNT-FROZEN                VALUE '4'.
   451         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
   452     12  AM-REMIT-TO                       PIC 99.                ERCACCT
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  11
* ECS010T1.cbl (/apps/prod/cid1p/copy/ERCACCT)
   453     12  AM-ID-NO                          PIC X(11).             ERCACCT
   454                                                                  ERCACCT
   455     12  AM-CAL-TABLE                      PIC XX.                ERCACCT
   456     12  AM-LF-DEVIATION                   PIC XXX.               ERCACCT
   457     12  AM-AH-DEVIATION                   PIC XXX.               ERCACCT
   458     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3. ERCACCT
   459     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3. ERCACCT
   460     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3. ERCACCT
   461     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3. ERCACCT
   462     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3. ERCACCT
   463     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3. ERCACCT
   464                                                                  ERCACCT
   465     12  AM-USER-FIELDS.                                          ERCACCT
   466         16  AM-FLD-1                      PIC XX.                ERCACCT
   467         16  AM-FLD-2                      PIC XX.                ERCACCT
   468         16  AM-FLD-3                      PIC XX.                ERCACCT
   469         16  AM-FLD-4                      PIC XX.                ERCACCT
   470         16  AM-FLD-5                      PIC XX.                ERCACCT
   471                                                                  ERCACCT
   472     12  AM-1ST-PROD-DATE.                                        ERCACCT
   473         16  AM-1ST-PROD-YR                PIC XX.                ERCACCT
   474         16  AM-1ST-PROD-MO                PIC XX.                ERCACCT
   475         16  AM-1ST-PROD-DA                PIC XX.                ERCACCT
   476     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.     ERCACCT
   477     12  AM-CERTS-PURGED-DATE.                                    ERCACCT
   478         16  AM-PUR-YR                     PIC XX.                ERCACCT
   479         16  AM-PUR-MO                     PIC XX.                ERCACCT
   480         16  AM-PUR-DA                     PIC XX.                ERCACCT
   481     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.     ERCACCT
   482     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.     ERCACCT
   483     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.     ERCACCT
   484     12  AM-INACTIVE-DATE.                                        ERCACCT
   485         16  AM-INA-MO                     PIC 99.                ERCACCT
   486         16  AM-INA-DA                     PIC 99.                ERCACCT
   487         16  AM-INA-YR                     PIC 99.                ERCACCT
   488     12  AM-AR-HI-CERT-DATE                PIC XX.                ERCACCT
   489                                                                  ERCACCT
   490     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3. ERCACCT
   491     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3. ERCACCT
   492                                                                  ERCACCT
   493     12  AM-OB-PAYMENT-MODE                PIC X.                 ERCACCT
   494         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.      ERCACCT
   495         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.          ERCACCT
   496         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.          ERCACCT
   497         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.          ERCACCT
   498                                                                  ERCACCT
   499     12  AM-AH-ONLY-INDICATOR              PIC X.                 ERCACCT
   500         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.      ERCACCT
   501         88  AM-NO-AH-ONLY                    VALUE 'N'.          ERCACCT
   502                                                                  ERCACCT
   503     12  AM-EDIT-LOAN-OFC                  PIC X(01).             ERCACCT
   504                                                                  ERCACCT
   505     12  AM-OVER-SHORT.                                           ERCACCT
   506         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3. ERCACCT
   507         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3. ERCACCT
   508                                                                  ERCACCT
   509     12  AM-DCC-PRODUCT-CODE               PIC XXX.
   510     12  AM-DCC-CLP-STATE                  PIC XX.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  12
* ECS010T1.cbl (/apps/prod/cid1p/copy/ERCACCT)
   511                                                                  ERCACCT
   512     12  AM-RECALC-COMM                    PIC X.                 ERCACCT
   513     12  AM-RECALC-REIN                    PIC X.                 ERCACCT
   514                                                                  ERCACCT
   515     12  AM-REI-TABLE                      PIC XXX.               ERCACCT
   516     12  AM-REI-ET-LF                      PIC X.                 ERCACCT
   517     12  AM-REI-ET-AH                      PIC X.                 ERCACCT
   518     12  AM-REI-PE-LF                      PIC X.                 ERCACCT
   519     12  AM-REI-PE-AH                      PIC X.                 ERCACCT
   520     12  AM-REI-PRT-ST                     PIC X.                 ERCACCT
   521     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3. ERCACCT
   522     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3. ERCACCT
   523     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3. ERCACCT
   524     12  AM-REI-GROUP-A                    PIC X(6).              ERCACCT
   525     12  AM-REI-MORT                       PIC X(4).              ERCACCT
   526     12  AM-REI-PRT-OW                     PIC X.                 ERCACCT
   527     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3. ERCACCT
   528     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3. ERCACCT
   529     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3. ERCACCT
   530     12  AM-REI-GROUP-B                    PIC X(6).              ERCACCT
   531                                                                  ERCACCT
   532     12  AM-TRUST-TYPE                     PIC X(2).              ERCACCT
   533                                                                  ERCACCT
   534     12  AM-EMPLOYER-STMT-USED             PIC X.                 ERCACCT
   535     12  AM-GROUPED-CHECKS-Y-N             PIC X.                 ERCACCT
   536                                                                  ERCACCT
   537     12  AM-STD-AH-TYPE                    PIC XX.                ERCACCT
   538     12  AM-EARN-METHODS.                                         ERCACCT
   539         16  AM-EARN-METHOD-R              PIC X.                 ERCACCT
   540             88 AM-REF-RL-R78                 VALUE 'R'.          ERCACCT
   541             88 AM-REF-RL-PR                  VALUE 'P'.          ERCACCT
   542             88 AM-REF-RL-MEAN                VALUE 'M'.          ERCACCT
   543             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.          ERCACCT
   544         16  AM-EARN-METHOD-L              PIC X.                 ERCACCT
   545             88 AM-REF-LL-R78                 VALUE 'R'.          ERCACCT
   546             88 AM-REF-LL-PR                  VALUE 'P'.          ERCACCT
   547             88 AM-REF-LL-MEAN                VALUE 'M'.          ERCACCT
   548             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.          ERCACCT
   549         16  AM-EARN-METHOD-A              PIC X.                 ERCACCT
   550             88 AM-REF-AH-R78                 VALUE 'R'.          ERCACCT
   551             88 AM-REF-AH-PR                  VALUE 'P'.          ERCACCT
   552             88 AM-REF-AH-MEAN                VALUE 'M'.          ERCACCT
   553             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.          ERCACCT
   554             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.          ERCACCT
   555             88 AM-REF-AH-NET                 VALUE 'N'.          ERCACCT
   556                                                                  ERCACCT
   557     12  AM-TOL-PREM                       PIC S999V99    COMP-3. ERCACCT
   558     12  AM-TOL-REF                        PIC S999V99    COMP-3. ERCACCT
   559     12  AM-TOL-CLM                        PIC S999V99    COMP-3. ERCACCT
   560                                                                  ERCACCT
   561     12  AM-RET-Y-N                        PIC X.                 ERCACCT
   562     12  AM-RET-P-E                        PIC X.                 ERCACCT
   563     12  AM-LF-RET                         PIC S9V9999    COMP-3. ERCACCT
   564     12  AM-AH-RET                         PIC S9V9999    COMP-3. ERCACCT
   565     12  AM-RET-GRP                        PIC X(6).              ERCACCT
   566     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.                    ERCACCT
   567         16  AM-POOL-PRIME                 PIC XXX.               ERCACCT
   568         16  AM-POOL-SUB                   PIC XXX.               ERCACCT
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  13
* ECS010T1.cbl (/apps/prod/cid1p/copy/ERCACCT)
   569     12  AM-RETRO-EARNINGS.                                       ERCACCT
   570         16  AM-RET-EARN-R                 PIC X.                 ERCACCT
   571         16  AM-RET-EARN-L                 PIC X.                 ERCACCT
   572         16  AM-RET-EARN-A                 PIC X.                 ERCACCT
   573     12  AM-RET-ST-TAX-USE                 PIC X.                 ERCACCT
   574         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.  ERCACCT
   575         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.      ERCACCT
   576     12  AM-RETRO-BEG-EARNINGS.                                   ERCACCT
   577         16  AM-RET-BEG-EARN-R             PIC X.                 ERCACCT
   578         16  AM-RET-BEG-EARN-L             PIC X.                 ERCACCT
   579         16  AM-RET-BEG-EARN-A             PIC X.                 ERCACCT
   580     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3. ERCACCT
   581     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3. ERCACCT
   582                                                                  ERCACCT
   583     12  AM-USER-SELECT-OPTIONS.                                  ERCACCT
   584         16  AM-USER-SELECT-1              PIC X(10).             ERCACCT
   585         16  AM-USER-SELECT-2              PIC X(10).             ERCACCT
   586         16  AM-USER-SELECT-3              PIC X(10).             ERCACCT
   587         16  AM-USER-SELECT-4              PIC X(10).             ERCACCT
   588         16  AM-USER-SELECT-5              PIC X(10).             ERCACCT
   589                                                                  ERCACCT
   590     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3. ERCACCT
   591                                                                  ERCACCT
   592     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3. ERCACCT
   593                                                                  ERCACCT
   594     12  AM-RPT045A-SWITCH                 PIC X.                 ERCACCT
   595         88  RPT045A-OFF                   VALUE 'N'.             ERCACCT
   596                                                                  ERCACCT
   597     12  AM-INSURANCE-LIMITS.                                     ERCACCT
   598         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3. ERCACCT
   599         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3. ERCACCT
   600                                                                  ERCACCT
   601     12  AM-PROFILE-CHANGE-SWITCH          PIC X.                 ERCACCT
   602         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.          ERCACCT
   603                                                                  ERCACCT
   604     12  AM-DISMBR-COVERAGE-SW             PIC X.                 ERCACCT
   605         88  AM-DISMBR-COVERAGE               VALUE 'Y'.          ERCACCT
   606         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.          ERCACCT
   607                                                                  ERCACCT
   608     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3. ERCACCT
   609                                                                  ERCACCT
   610     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3. ERCACCT
   611     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
   612     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
   613     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
   614     12  AM-DCC-UEF-STATE                  PIC XX.
   615     12  FILLER                            PIC XXX.
   616     12  AM-REPORT-CODE-3                  PIC X(10).
   617*    12  FILLER                            PIC X(22).             ERCACCT
   618                                                                  ERCACCT
   619     12  AM-RESERVE-DATE.                                         ERCACCT
   620         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.    ERCACCT
   621         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.    ERCACCT
   622         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.    ERCACCT
   623                                                                  ERCACCT
   624     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.                ERCACCT
   625     12  AM-NOTIFICATION-TYPES.                                   ERCACCT
   626         16  AM-NOTIF-OF-LETTERS           PIC X.                 ERCACCT
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  14
* ECS010T1.cbl (/apps/prod/cid1p/copy/ERCACCT)
   627         16  AM-NOTIF-OF-PAYMENTS          PIC X.                 ERCACCT
   628         16  AM-NOTIF-OF-REPORTS           PIC X.                 ERCACCT
   629         16  AM-NOTIF-OF-STATUS            PIC X.                 ERCACCT
   630                                                                  ERCACCT
   631     12  AM-BENEFIT-TABLE-USAGE            PIC X.                 ERCACCT
   632         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.          ERCACCT
   633         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.          ERCACCT
   634         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.          ERCACCT
   635         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.     ERCACCT
   636                                                                  ERCACCT
   637     12  AM-BENEFIT-CONTROLS.                                     ERCACCT
   638         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.            ERCACCT
   639             20  AM-BENEFIT-CODE           PIC XX.                ERCACCT
   640             20  AM-BENEFIT-TYPE           PIC X.                 ERCACCT
   641             20  AM-BENEFIT-REVISION       PIC XXX.               ERCACCT
   642             20  AM-BENEFIT-REM-TERM       PIC X.                 ERCACCT
   643             20  AM-BENEFIT-RETRO-Y-N      PIC X.                 ERCACCT
   644             20  FILLER                    PIC XX.                ERCACCT
   645         16  FILLER                        PIC X(80).             ERCACCT
   646                                                                  ERCACCT
   647     12  AM-TRANSFER-DATA.                                        ERCACCT
   648         16  AM-TRANSFERRED-FROM.                                 ERCACCT
   649             20  AM-TRNFROM-CARRIER        PIC X.                 ERCACCT
   650             20  AM-TRNFROM-GROUPING.                             ERCACCT
   651                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.               ERCACCT
   652                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.               ERCACCT
   653             20  AM-TRNFROM-STATE          PIC XX.                ERCACCT
   654             20  AM-TRNFROM-ACCOUNT.                              ERCACCT
   655                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).             ERCACCT
   656                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).              ERCACCT
   657             20  AM-TRNFROM-DTE            PIC XX.                ERCACCT
   658         16  AM-TRANSFERRED-TO.                                   ERCACCT
   659             20  AM-TRNTO-CARRIER          PIC X.                 ERCACCT
   660             20  AM-TRNTO-GROUPING.                               ERCACCT
   661                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.               ERCACCT
   662                 24  AM-TRNTO-GRP-PRIME    PIC XXX.               ERCACCT
   663             20  AM-TRNTO-STATE            PIC XX.                ERCACCT
   664             20  AM-TRNTO-ACCOUNT.                                ERCACCT
   665                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).              ERCACCT
   666                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).              ERCACCT
   667             20  AM-TRNTO-DTE              PIC XX.                ERCACCT
   668         16  FILLER                        PIC X(10).             ERCACCT
   669                                                                  ERCACCT
   670     12  AM-SAVED-REMIT-TO                 PIC 99.                ERCACCT
   671                                                                  ERCACCT
   672     12  AM-COMM-STRUCTURE-SAVED.                                 ERCACCT
   673         16  AM-DEFN-1-SAVED.                                     ERCACCT
   674             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.           ERCACCT
   675                 24  AM-AGT-SV             PIC X(10).             ERCACCT
   676                 24  AM-COM-TYP-SV         PIC X.                 ERCACCT
   677                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3. ERCACCT
   678                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3. ERCACCT
   679                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3. ERCACCT
   680                 24  AM-RECALC-LV-INDIC-SV PIC X.                 ERCACCT
   681                 24  FILLER                PIC X.                 ERCACCT
   682                 24  AM-GL-CODES-SV        PIC X.                 ERCACCT
   683                 24  AM-COM-CHARGEBACK-SV  PIC 99.                ERCACCT
   684                 24  FILLER                PIC X.                 ERCACCT
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  15
* ECS010T1.cbl (/apps/prod/cid1p/copy/ERCACCT)
   685         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.       ERCACCT
   686             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.            ERCACCT
   687                 24  FILLER                PIC X(11).             ERCACCT
   688                 24  AM-L-COMA-SV          PIC XXX.               ERCACCT
   689                 24  AM-J-COMA-SV          PIC XXX.               ERCACCT
   690                 24  AM-A-COMA-SV          PIC XXX.               ERCACCT
   691                 24  FILLER                PIC X(6).              ERCACCT
   692                                                                  ERCACCT
   693     12  AM-FLC-NET-PREMIUM-ALLOWANCE.                            ERCACCT
   694         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.                 ERCACCT
   695            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3. ERCACCT
   696            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3. ERCACCT
   697            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3. ERCACCT
   698                                                                  ERCACCT
   699     12  AM-ORIG-DEALER-NO                 PIC X(10).             ERCACCT
   700     12  FILLER                            PIC X(120).            ERCACCT
   701                                                                  ERCACCT
   702     12  AM-ACCOUNT-EXECUTIVE-DATA.                               ERCACCT
   703         16  AM-CONTROL-NAME               PIC X(30).             ERCACCT
   704         16  AM-EXECUTIVE-ONE.                                    ERCACCT
   705             20  AM-EXEC1-NAME             PIC X(15).             ERCACCT
   706             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)       ERCACCT
   707                                                          COMP-3. ERCACCT
   708             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)       ERCACCT
   709                                                          COMP-3. ERCACCT
   710         16  AM-EXECUTIVE-TWO.                                    ERCACCT
   711             20  AM-EXEC2-NAME             PIC X(15).             ERCACCT
   712             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)       ERCACCT
   713                                                          COMP-3. ERCACCT
   714             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)       ERCACCT
   715                                                          COMP-3. ERCACCT
   716                                                                  ERCACCT
   717     12  AM-RETRO-ADDITIONAL-DATA.                                ERCACCT
   718         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3. ERCACCT
   719         16  AM-RETRO-PREM-P-E             PIC X.                 ERCACCT
   720         16  AM-RETRO-CLMS-P-I             PIC X.                 ERCACCT
   721         16  AM-RETRO-RET-BRACKET-LF.                             ERCACCT
   722             20  AM-RETRO-RET-METHOD-LF    PIC X.                 ERCACCT
   723                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.      ERCACCT
   724                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.          ERCACCT
   725             20  AM-RETRO-RET-BASIS-LF     PIC X.                 ERCACCT
   726                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.      ERCACCT
   727                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.          ERCACCT
   728             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.           ERCACCT
   729                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3. ERCACCT
   730                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3. ERCACCT
   731         16  AM-RETRO-RET-BRACKET-AH.                             ERCACCT
   732             20  AM-RETRO-RET-METHOD-AH    PIC X.                 ERCACCT
   733                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.      ERCACCT
   734                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.          ERCACCT
   735                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.          ERCACCT
   736             20  AM-RETRO-RET-BASIS-AH     PIC X.                 ERCACCT
   737                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.      ERCACCT
   738                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.          ERCACCT
   739             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.           ERCACCT
   740                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3. ERCACCT
   741                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3. ERCACCT
   742                                                                  ERCACCT
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  16
* ECS010T1.cbl (/apps/prod/cid1p/copy/ERCACCT)
   743     12  AM-COMMENTS.                                             ERCACCT
   744         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.ERCACCT
   745                                                                  ERCACCT
   746     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.         ERCACCT
   747         16  AM-FLI-RETRO-SHARE-CODE       PIC X.                 ERCACCT
   748         16  AM-FLI-BILLING-CODE           PIC X.                 ERCACCT
   749         16  AM-FLI-ALT-STATE-CODE         PIC XX.                ERCACCT
   750         16  AM-FLI-UNITED-IDENT           PIC X.                 ERCACCT
   751         16  AM-FLI-INTEREST-LOST-DATA.                           ERCACCT
   752             20  AM-FLI-BANK-NO            PIC X(5).              ERCACCT
   753             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3. ERCACCT
   754             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3. ERCACCT
   755             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3. ERCACCT
   756         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.            ERCACCT
   757             20  AM-FLI-AGT                PIC X(9).              ERCACCT
   758             20  AM-FLI-AGT-COMM-ACC       PIC X.                 ERCACCT
   759             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3. ERCACCT
   760         16  FILLER                        PIC X(102).            ERCACCT
   761                                                                  ERCACCT
   762     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.         ERCACCT
   763         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.          ERCACCT
   764             20  AM-BENEFIT-DMD-CODE         PIC XX.              ERCACCT
   765             20  AM-BENEFIT-DMD-TYPE         PIC X.               ERCACCT
   766             20  AM-BENEFIT-DMD-REVISION     PIC XXX.             ERCACCT
   767             20  AM-BENEFIT-DMD-REM-TERM     PIC X.               ERCACCT
   768             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.               ERCACCT
   769         16  FILLER                          PIC X(10).           ERCACCT
   770******************************************************************ERCACCT
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  17
* ECS010T1.cbl
   772 FD  ERRTBL-IN.
   773
*  774                             COPY ERCREIN.
   775******************************************************************07/27/93
   776*                                                                *ERCREIN
   777*                            ERCREIN                             *   LV009
   778*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   779*                            VMOD=2.010                          *   CL**9
   780*                                                                *ERCREIN
   781*   ONLINE CREDIT SYSTEM                                         *ERCREIN
   782*                                                                *ERCREIN
   783*   FILE DESCRIPTION = REINSURANCE MASTER FILE                   *ERCREIN
   784*                                                                *ERCREIN
   785*   FILE TYPE = VSAM,KSDS                                        *ERCREIN
   786*   RECORD SIZE = 4000  RECFORM = FIXED                          *ERCREIN
   787*                                                                *ERCREIN
   788*   BASE CLUSTER NAME = ERREIN                   RKP=2,LEN=8     *ERCREIN
   789*       ALTERNATE PATH = NONE                                    *ERCREIN
   790*                                                                *ERCREIN
   791*   LOG = NO                                                     *ERCREIN
   792*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *ERCREIN
   793*                                                                *ERCREIN
   794******************************************************************ERCREIN
   795*                   C H A N G E   L O G
   796*
   797* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   798*-----------------------------------------------------------------
   799*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   800* EFFECTIVE    NUMBER
   801*-----------------------------------------------------------------
   802* 103101    2001100100006  SMVA  ADD STATE EXHIBIT REPORT OPTION F
   803* 032707    2007032100006  PEMA  ADD EXCISE TAX CAPABILITY
   804******************************************************************
   805 01  REINSURANCE-RECORD.                                          ERCREIN
   806     12  RE-RECORD-ID                      PIC XX.                ERCREIN
   807         88  VALID-RE-ID                      VALUE 'RE'.         ERCREIN
   808                                                                  ERCREIN
   809     12  RE-CONTROL-PRIMARY.                                      ERCREIN
   810         16  RE-COMPANY-CD                 PIC X.                 ERCREIN
   811         16  RE-KEY.                                              ERCREIN
   812             20  RE-CODE                   PIC X.                 ERCREIN
   813                 88  RE-TABLE-RECORD          VALUE 'A'.          ERCREIN
   814                 88  RE-COMPANY-RECORD        VALUE 'B'.          ERCREIN
   815             20  RE-TABLE                  PIC XXX.               ERCREIN
   816             20  FILLER                    PIC XXX.               ERCREIN
   817         16  RE-COMPANY-KEY REDEFINES RE-KEY.                     ERCREIN
   818             20  FILLER                    PIC X.                 ERCREIN
   819             20  RE-COMPANY.                                      ERCREIN
   820                 24  RE-COMP-PRIME         PIC XXX.               ERCREIN
   821                 24  RE-COMP-SUB           PIC XXX.               ERCREIN
   822                                                                  ERCREIN
   823     12  RE-MAINT-INFORMATION.                                    ERCREIN
   824         16  RE-LAST-MAINT-DT              PIC XX.                ERCREIN
   825         16  RE-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3. ERCREIN
   826         16  RE-LAST-MAINT-USER            PIC X(4).              ERCREIN
   827         16  FILLER                        PIC X(10).             ERCREIN
   828                                                                  ERCREIN
   829     12  RE-TABLE-DATA.                                           ERCREIN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  18
* ECS010T1.cbl (/apps/prod/cid1p/copy/ERCREIN)
   830         16  RE-100-COMP                   PIC 99.                ERCREIN
   831                                                                  ERCREIN
   832         16  RE-COMP-INFO    OCCURS 30 TIMES.                     ERCREIN
   833             20  RE-REI-COMP-NO.                                  ERCREIN
   834                 24  RE-REI-COMP           PIC XXX.               ERCREIN
   835                 24  RE-REI-COMP-SUB       PIC XXX.               ERCREIN
   836             20  RE-LF-QC                  PIC X.                 ERCREIN
   837             20  RE-AH-QC                  PIC X.                 ERCREIN
   838             20  RE-LO-DATE                PIC 9(11)     COMP-3.  ERCREIN
   839             20  RE-HI-DATE                PIC 9(11)     COMP-3.  ERCREIN
   840             20  RE-LFAGE-LO               PIC 99.                ERCREIN
   841             20  RE-LFAGE-HI               PIC 99.                ERCREIN
   842             20  RE-AHAGE-LO               PIC 99.                ERCREIN
   843             20  RE-AHAGE-HI               PIC 99.                ERCREIN
   844             20  RE-LFTRM-LO               PIC S999       COMP-3. ERCREIN
   845             20  RE-LFTRM-HI               PIC S999       COMP-3. ERCREIN
   846             20  RE-AHTRM-LO               PIC S999       COMP-3. ERCREIN
   847             20  RE-AHTRM-HI               PIC S999       COMP-3. ERCREIN
   848             20  RE-LF-PCT                 PIC S9V9999    COMP-3. ERCREIN
   849             20  RE-AH-PCT                 PIC S9V9999    COMP-3. ERCREIN
   850             20  RE-LF-LIM-LO              PIC S9(9)V99   COMP-3. ERCREIN
   851             20  RE-LF-LIM-HI              PIC S9(9)V99   COMP-3. ERCREIN
   852             20  RE-LF-LO                  PIC S9(9)V99   COMP-3. ERCREIN
   853             20  RE-LF-HI                  PIC S9(9)V99   COMP-3. ERCREIN
   854             20  RE-AHBEN-LIM-LO           PIC S9(7)V99   COMP-3. ERCREIN
   855             20  RE-AHBEN-LIM-HI           PIC S9(7)V99   COMP-3. ERCREIN
   856             20  RE-AHBEN-LO               PIC S9(7)V99   COMP-3. ERCREIN
   857             20  RE-AHBEN-HI               PIC S9(7)V99   COMP-3. ERCREIN
   858             20  RE-AHMOA-LIM-LO           PIC S9(7)V99   COMP-3. ERCREIN
   859             20  RE-AHMOA-LIM-HI           PIC S9(7)V99   COMP-3. ERCREIN
   860             20  RE-AHMOA-LO               PIC S9(7)V99   COMP-3. ERCREIN
   861             20  RE-AHMOA-HI               PIC S9(7)V99   COMP-3. ERCREIN
   862             20  RE-LF-BEN-CODE            PIC X.                 ERCREIN
   863             20  RE-AH-BEN-CODE            PIC X.                 ERCREIN
   864             20  RE-INTERACTIVE            PIC X.                 ERCREIN
   865             20  RE-REMAINING              PIC X.                 ERCREIN
   866             20  RE-LF-RUNOFF-SW           PIC X.                      000
   867             20  RE-AH-RUNOFF-SW           PIC X.                      000
   868             20  FILLER                    PIC X(19).                  000
   869                                                                  ERCREIN
   870         16  RE-COMP-INFO-END              PIC X(6).              ERCREIN
   871         16  RE-NSP-ST-CD-LF               PIC XX.                ERCREIN
   872         16  RE-NSP-ST-CD-AH               PIC XX.                ERCREIN
   873         16  RE-TABLE-CARRIER-SECURITY     PIC X.                 ERCREIN
   874             88  NO-TABLE-CARRIER-SECURITY    VALUE SPACE.        ERCREIN
   875                                                                  ERCREIN
   876         16  FILLER                        PIC X(27).             ERCREIN
   877                                                                  ERCREIN
   878     12  RE-COMPANY-DATA   REDEFINES   RE-TABLE-DATA.             ERCREIN
   879         16  RE-NAME                       PIC X(30).             ERCREIN
   880         16  RE-LF-PE                      PIC X.                 ERCREIN
   881         16  RE-AH-PE                      PIC X.                 ERCREIN
   882         16  RE-LF-FEE                     PIC S9V9999    COMP-3. ERCREIN
   883         16  RE-AH-FEE                     PIC S9V9999    COMP-3. ERCREIN
   884         16  RE-AH-PR-PCT                  PIC S9V9999    COMP-3. ERCREIN
   885         16  RE-AH-78-PCT                  PIC S9V9999    COMP-3. ERCREIN
   886         16  RE-PRT-ST                     PIC X.                 ERCREIN
   887         16  RE-PRT-OW                     PIC X.                 ERCREIN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  19
* ECS010T1.cbl (/apps/prod/cid1p/copy/ERCREIN)
   888         16  RE-MORT-CODE                  PIC X(4).              ERCREIN
   889         16  RE-CLAIM-CODE                 PIC X.                 ERCREIN
   890         16  RE-ZERO-LF-FEE                PIC X.                 ERCREIN
   891         16  RE-ZERO-AH-FEE                PIC X.                 ERCREIN
   892         16  RE-CEDE-NAME                  PIC X(30).             ERCREIN
   893         16  RE-LF-COMM                    PIC X.                 ERCREIN
   894         16  RE-AH-COMM                    PIC X.                 ERCREIN
   895         16  RE-LF-TAX                     PIC X.                 ERCREIN
   896         16  RE-AH-TAX                     PIC X.                 ERCREIN
   897         16  RE-CLM-INCURRED-LIM           PIC 9(11)  COMP-3.     ERCREIN
   898         16  RE-LF-IBNR-PCT                PIC SV999      COMP-3. ERCREIN
   899         16  RE-AH-IBNR-PCT                PIC SV999      COMP-3. ERCREIN
   900                                                                  ERCREIN
   901         16  RE-COMP-CARRIER-SECURITY      PIC X.                 ERCREIN
   902             88  NO-COMP-CARRIER-SECURITY     VALUE SPACE.        ERCREIN
   903                                                                  ERCREIN
   904         16  RE-LF-CEDING-FEE-BRACKETS.                           ERCREIN
   905             20  RE-LF-FEE-METHOD          PIC X.                 ERCREIN
   906                 88  RE-LF-FEE-BRACKETED         VALUE '1' '2'.   ERCREIN
   907                 88  RE-LF-FEE-METHOD-1          VALUE '1'.       ERCREIN
   908                 88  RE-LF-FEE-METHOD-2          VALUE '2'.       ERCREIN
   909                 88  RE-LF-FEE-PERCENT           VALUE ' ' 'P'.   ERCREIN
   910             20  RE-LF-FEE-BASIS           PIC X.                 ERCREIN
   911                 88  RE-LF-GROSS-CEDED             VALUE '1'.     ERCREIN
   912                 88  RE-LF-NET-CEDED               VALUE '2'.     ERCREIN
   913                 88  RE-LF-GROSS-WRITTEN           VALUE '3'.     ERCREIN
   914                 88  RE-LF-NET-WRITTEN             VALUE '4'.     ERCREIN
   915                 88  RE-LF-COMBINE-GROSS-CEDED     VALUE '5'.     ERCREIN
   916                 88  RE-LF-COMBINE-NET-CEDED       VALUE '6'.     ERCREIN
   917                 88  RE-LF-COMBINE-GROSS-WRITTEN   VALUE '7'.     ERCREIN
   918                 88  RE-LF-COMBINE-NET-WRITTEN     VALUE '8'.     ERCREIN
   919             20  FILLER                    PIC XXX.               ERCREIN
   920             20  RE-LF-FEE-RANGES  OCCURS 6 TIMES.                ERCREIN
   921                 24  RE-LF-FEE-RANGE-PCT   PIC S9V9999    COMP-3. ERCREIN
   922                 24  RE-LF-FEE-THRU-AMT    PIC S9(7)V99   COMP-3. ERCREIN
   923                                                                  ERCREIN
   924         16  RE-AH-CEDING-FEE-BRACKETS.                           ERCREIN
   925             20  RE-AH-FEE-METHOD          PIC X.                 ERCREIN
   926                 88  RE-AH-FEE-BRACKETED         VALUE '1' '2'.   ERCREIN
   927                 88  RE-AH-FEE-METHOD-1          VALUE '1'.       ERCREIN
   928                 88  RE-AH-FEE-METHOD-2          VALUE '2'.       ERCREIN
   929                 88  RE-AH-FEE-PERCENT           VALUE ' ' 'P'.   ERCREIN
   930             20  RE-AH-FEE-BASIS           PIC X.                 ERCREIN
   931                 88  RE-AH-GROSS-CEDED             VALUE '1'.     ERCREIN
   932                 88  RE-AH-NET-CEDED               VALUE '2'.     ERCREIN
   933                 88  RE-AH-GROSS-WRITTEN           VALUE '3'.     ERCREIN
   934                 88  RE-AH-NET-WRITTEN             VALUE '4'.     ERCREIN
   935                 88  RE-AH-COMBINE-GROSS-CEDED     VALUE '5'.     ERCREIN
   936                 88  RE-AH-COMBINE-NET-CEDED       VALUE '6'.     ERCREIN
   937                 88  RE-AH-COMBINE-GROSS-WRITTEN   VALUE '7'.     ERCREIN
   938                 88  RE-AH-COMBINE-NET-WRITTEN     VALUE '8'.     ERCREIN
   939             20  FILLER                    PIC XXX.               ERCREIN
   940             20  RE-AH-FEE-RANGES  OCCURS 6 TIMES.                ERCREIN
   941                 24  RE-AH-FEE-RANGE-PCT   PIC S9V9999    COMP-3. ERCREIN
   942                 24  RE-AH-FEE-THRU-AMT    PIC S9(7)V99   COMP-3. ERCREIN
   943                                                                  ERCREIN
   944         16  RE-EARNING-START-DT           PIC 9(11)  COMP-3.     ERCREIN
   945                                                                  ERCREIN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  20
* ECS010T1.cbl (/apps/prod/cid1p/copy/ERCREIN)
   946         16  RE-OLD-CEDING-STMT            PIC X.                    CL**4
   947                                                                  ERCREIN
   948         16  RE-LF-CLM-PCT                 PIC S9V9999    COMP-3. ERCREIN
   949         16  RE-AH-CLM-PCT                 PIC S9V9999    COMP-3. ERCREIN
   950         16  RE-LF-CLM-MAX                 PIC S9(7)V99   COMP-3. ERCREIN
   951         16  RE-AH-CLM-MAX                 PIC S9(7)V99   COMP-3. ERCREIN
   952         16  RE-LF-PR-PCT                  PIC S9V9999    COMP-3. ERCREIN
   953         16  RE-LF-78-PCT                  PIC S9V9999    COMP-3. ERCREIN
   954         16  RE-REINS-GROUPING-CODE        PIC X(6).              ERCREIN
   955         16  RE-MORT-SW                    PIC X.                 ERCREIN
   956         16  RE-CEDING-TYPE-FLAG           PIC X.                    CL**2
   957             88  RE-NO-CESSION-TYPE                VALUE ' '.        CL**2
   958             88  RE-CEDED                          VALUE 'C'.        CL**2
   959             88  RE-ASSUMED                        VALUE 'A'.        CL**2
   960             88  RE-PHANTOM                        VALUE 'P'.        CL**2
   961                                                                  ERCREIN
   962         16  RE-CEDING-STMT-OPT-A          PIC X.                    CL**3
   963             88  REPORT-A-WANTED    VALUE ' ' 'Y'.                   CL**3
   964         16  RE-CEDING-STMT-OPT-B          PIC X.                    CL**3
   965             88  REPORT-B-WANTED    VALUE ' ' 'Y'.                   CL**3
   966         16  RE-CEDING-STMT-OPT-C          PIC X.                    CL**3
   967             88  REPORT-C-WANTED    VALUE ' ' 'Y'.                   CL**3
   968         16  RE-CEDING-STMT-OPT-D          PIC X.                    CL**3
   969             88  REPORT-D-WANTED    VALUE ' ' 'Y'.                   CL**3
   970         16  RE-CEDING-STMT-OPT-E          PIC X.                    CL**3
   971             88  REPORT-E-WANTED    VALUE ' ' 'Y'.                   CL**3
   972                                                                     CL**3
   973         16  RE-PRT-CRSV                   PIC X.                    CL**5
   974                                                                     CL**5
   975         16  RE-GL-CENTER                  PIC X(4).                 CL**6
   976                                                                     CL**8
   977         16  RE-CUSTODIAL-BAL              PIC S9(7)V99   COMP-3.    CL**8
   978                                                                     CL**8
   979         16  RE-EARNING-STOP-DT            PIC 9(11)  COMP-3.        CL**9
   980                                                                     CL**9
   981         16  RE-EARN-STOP-CODE             PIC X.                    CL**9
   982             88  STOP-LIFE-EARNING  VALUE 'L' 'B'.                   CL**9
   983             88  STOP-AH-EARNING    VALUE 'A' 'B'.                   CL**9
   984
   985         16  RE-STATE-EXHIBIT-OPT-F        PIC X.
   986             88  RPTF-ECS152-WANTED VALUE ' ' 'Y'.
   987                                                                     CL**9
   988         16  RE-EXCISE-TAX                 PIC S9V9999 COMP-3.
   989         16  FILLER                        PIC X(2281).              CL**9
   990                                                                  ERCREIN
   991         16  RE-DESC OCCURS 18 TIMES       PIC X(79).             ERCREIN
   992                                                                  ERCREIN
   993******************************************************************ERCREIN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  21
* ECS010T1.cbl
   995 FD  ERCTBL.
   996
*  997                             COPY ERCCTBL.
   998******************************************************************04/29/98
   999*                                                                *ERCCTBL
  1000*                                                                *ERCCTBL
  1001*                            ERCCTBL                             *   LV002
  1002*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  1003*                            VMOD=2.003                              CL**2
  1004*                                                                *ERCCTBL
  1005*   ONLINE CREDIT SYSTEM                                         *ERCCTBL
  1006*                                                                *ERCCTBL
  1007*   FILE DESCRIPTION = COMPENSATION TABLE                        *ERCCTBL
  1008*                                                                *ERCCTBL
  1009*   FILE TYPE = VSAM,KSDS                                        *ERCCTBL
  1010*   RECORD SIZE = 200   RECFORM = FIXED                          *ERCCTBL
  1011*                                                                *ERCCTBL
  1012*   BASE CLUSTER NAME = ERCTBL                   RKP=2,LEN=7     *ERCCTBL
  1013*       ALTERNATE PATH = NONE                                    *ERCCTBL
  1014*                                                                *ERCCTBL
  1015*   LOG = NO                                                     *ERCCTBL
  1016*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *ERCCTBL
  1017*                                                                *ERCCTBL
  1018*                                                                *ERCCTBL
  1019******************************************************************ERCCTBL
  1020                                                                  ERCCTBL
  1021 01  COMM-TABLE-RECORD.                                           ERCCTBL
  1022     12  CT-RECORD-ID                      PIC XX.                ERCCTBL
  1023         88  VALID-CT-ID                      VALUE 'CT'.         ERCCTBL
  1024                                                                  ERCCTBL
  1025     12  CT-CONTROL-PRIMARY.                                      ERCCTBL
  1026         16  CT-COMPANY-CD                 PIC X.                 ERCCTBL
  1027         16  CT-TABLE                      PIC XXX.               ERCCTBL
  1028         16  CT-CNTRL-2.                                          ERCCTBL
  1029             20  CT-BEN-TYPE               PIC X.                 ERCCTBL
  1030             20  CT-BEN-CODE               PIC XX.                ERCCTBL
  1031                                                                  ERCCTBL
  1032     12  CT-MAINT-INFORMATION.                                    ERCCTBL
  1033         16  CT-LAST-MAINT-DT              PIC XX.                ERCCTBL
  1034         16  CT-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3. ERCCTBL
  1035         16  CT-LAST-MAINT-USER            PIC X(4).              ERCCTBL
  1036         16  FILLER                        PIC X(31).             ERCCTBL
  1037                                                                  ERCCTBL
  1038     12  CT-LIMITS.                                               ERCCTBL
  1039         16  CT-TBF OCCURS 3 TIMES         PIC S9(7)V99   COMP-3. ERCCTBL
  1040                                                                  ERCCTBL
  1041         16  CT-AGE OCCURS 3 TIMES         PIC S99        COMP-3. ERCCTBL
  1042                                                                  ERCCTBL
  1043         16  CT-TRM OCCURS 3 TIMES         PIC S999       COMP-3. ERCCTBL
  1044                                                                  ERCCTBL
  1045     12  CT-RATES.                                                ERCCTBL
  1046         16  CT-RTX          OCCURS 27 TIMES.                     ERCCTBL
  1047             20  CT-RT                     PIC SV9(5)     COMP-3. ERCCTBL
  1048             20  CT-RT-R   REDEFINES                              ERCCTBL
  1049                 CT-RT                     PIC XXX.               ERCCTBL
  1050                                                                  ERCCTBL
  1051     12  FILLER                            PIC  X(42).            ERCCTBL
  1052                                                                  ERCCTBL
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  22
* ECS010T1.cbl
  1053******************************************************************ERCCTBL
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  23
* ECS010T1.cbl
  1055 FD  ERMEBL-INOUT.
  1056
* 1057                             COPY ERCMEBL.
  1058******************************************************************
  1059*
  1060*
  1061*                            ERCMEBL                             *
  1062*                                                                *
  1063*    FILE DESCRIPTION = REPOSITORY FOR MONTH-END BALANCES FROM   *
  1064*                       SEVERAL PROGRAMS (IDENTIFIED IN BYTES    *
  1065*                       4-6 OF THE FIELD NAMES) AND BY EL541     *
  1066*                       FOR REPORTING DISCREPANCIES AND RUN TIME.*
  1067*                                                                *
  1068*    FILE TYPE = VSAM, KSDS                                      *
  1069*    RECORD SIZE = 765       RECFORM = FIXED                     *
  1070*                                                                *
  1071*    BASE CLUSTER = ERMEBL         KEY SIZE  =  5                *
  1072*    ALTERNATE PATHS = NONE        STARTING IN  3                *
  1073*                                                                *
  1074******************************************************************
  1075
  1076******************************************************************
  1077*                   C H A N G E   L O G
  1078*
  1079* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1080*-----------------------------------------------------------------
  1081*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1082* EFFECTIVE    NUMBER
  1083*-----------------------------------------------------------------
  1084* 070714  CR2013060600001  PEMA  AUTOMATE EOM BALANCING
  1085******************************************************************
  1086 01  MONTH-END-BALANCES.
  1087     12  ME-RECORD-ID            PIC  XX.
  1088     12  ME-CONTROL-PRIMARY.
  1089         16  ME-COMPANY          PIC  XXX.
  1090         16  ME-MOYR             PIC  9999       COMP.
  1091     12  ME-010-PREM-L           PIC S9(9)V99    COMP-3.
  1092     12  ME-010-PREM-AH          PIC S9(9)V99    COMP-3.
  1093     12  ME-010-REF-L            PIC S9(9)V99    COMP-3.
  1094     12  ME-010-REF-AH           PIC S9(9)V99    COMP-3.
  1095     12  ME-010-NET-L            PIC S9(9)V99    COMP-3.
  1096     12  ME-010-NET-AH           PIC S9(9)V99    COMP-3.
  1097     12  ME-010-COMM-L           PIC S9(9)V99    COMP-3.
  1098     12  ME-010-COMM-AH          PIC S9(9)V99    COMP-3.
  1099     12  ME-010-PMT-L            PIC S9(9)V99    COMP-3.
  1100     12  ME-010-PMT-AH           PIC S9(9)V99    COMP-3.
  1101     12  ME-010-CERT-IN          PIC S9(7)       COMP-3.
  1102     12  ME-010-CERT-OUT         PIC S9(7)       COMP-3.
  1103     12  ME-010-DUP-ISS          PIC S9(7)       COMP-3.
  1104     12  ME-010-RUN-DT           PIC  9(6)       COMP-3.
  1105*    12  ME-010-START            PIC  9(6)       COMP-3.
  1106*    12  ME-010-END              PIC  9(6)       COMP-3.
  1107     12  ME-010-RUN-CT           PIC S9(3)       COMP-3.
  1108     12  ME-018-COMM-Y           PIC S9(9)V99    COMP-3.
  1109     12  ME-018-COMM-1           PIC S9(9)V99    COMP-3.
  1110     12  ME-018-OW-Y             PIC S9(9)V99    COMP-3.
  1111     12  ME-018-OW-1             PIC S9(9)V99    COMP-3.
  1112     12  ME-018-RUN-DT           PIC  9(6)       COMP-3.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  24
* ECS010T1.cbl (/apps/prod/cid1p/copy/ERCMEBL)
  1113*    12  ME-018-START            PIC  9(6)       COMP-3.
  1114*    12  ME-018-END              PIC  9(6)       COMP-3.
  1115     12  ME-018-RUN-CT           PIC S9(3)       COMP-3.
  1116     12  ME-019-PREM-L           PIC S9(9)V99    COMP-3.
  1117     12  ME-019-PREM-AH          PIC S9(9)V99    COMP-3.
  1118     12  ME-019-REF-L            PIC S9(9)V99    COMP-3.
  1119     12  ME-019-REF-AH           PIC S9(9)V99    COMP-3.
  1120     12  ME-019-COMM-L           PIC S9(9)V99    COMP-3.
  1121     12  ME-019-COMM-AH          PIC S9(9)V99    COMP-3.
  1122     12  ME-019-OR-L             PIC S9(9)V99    COMP-3.
  1123     12  ME-019-OR-AH            PIC S9(9)V99    COMP-3.
  1124     12  ME-019-RUN-DT           PIC  9(6)       COMP-3.
  1125*    12  ME-019-START            PIC  9(6)       COMP-3.
  1126*    12  ME-019-END              PIC  9(6)       COMP-3.
  1127     12  ME-019-RUN-CT           PIC S9(3)       COMP-3.
  1128     12  ME-030-CLMS-L           PIC S9(9)V99    COMP-3.
  1129     12  ME-030-CLMS-AH          PIC S9(9)V99    COMP-3.
  1130     12  ME-030-RUN-DT           PIC  9(6)       COMP-3.
  1131*    12  ME-030-START            PIC  9(6)       COMP-3.
  1132*    12  ME-030-END              PIC  9(6)       COMP-3.
  1133     12  ME-030-RUN-CT           PIC S9(3)       COMP-3.
  1134     12  ME-032-RESV-L           PIC S9(9)V99    COMP-3.
  1135     12  ME-032-RESV-AH          PIC S9(9)V99    COMP-3.
  1136     12  ME-032-RUN-DT           PIC  9(6)       COMP-3.
  1137*    12  ME-032-START            PIC  9(6)       COMP-3.
  1138*    12  ME-032-END              PIC  9(6)       COMP-3.
  1139     12  ME-032-RUN-CT           PIC S9(3)       COMP-3.
  1140     12  ME-035-NET-L            PIC S9(9)V99    COMP-3.
  1141     12  ME-035-NET-AH           PIC S9(9)V99    COMP-3.
  1142     12  ME-035-RUN-DT           PIC S9(6)       COMP-3.
  1143*    12  ME-035-START            PIC S9(6)       COMP-3.
  1144*    12  ME-035-END              PIC S9(6)       COMP-3.
  1145     12  ME-035-RUN-CT           PIC S9(3)       COMP-3.
  1146     12  ME-038-RECS-IN          PIC S9(7)       COMP-3.
  1147     12  ME-038-RECS-OUT         PIC S9(7)       COMP-3.
  1148     12  ME-038-RUN-DT           PIC  9(6)       COMP-3.
  1149*    12  ME-038-START            PIC  9(6)       COMP-3.
  1150*    12  ME-038-END              PIC  9(6)       COMP-3.
  1151     12  ME-038-RUN-CT           PIC S9(3)       COMP-3.
  1152     12  ME-041-RETROS           PIC S9(9)V99    COMP-3.
  1153     12  ME-041-RUN-DT           PIC  9(6)       COMP-3.
  1154*    12  ME-041-START            PIC  9(6)       COMP-3.
  1155*    12  ME-041-END              PIC  9(6)       COMP-3.
  1156     12  ME-041-RUN-CT           PIC S9(3)       COMP-3.
  1157     12  ME-050-CERT-IN          PIC S9(7)       COMP-3.
  1158     12  ME-050-CERT-OUT         PIC S9(7)       COMP-3.
  1159*    12  ME-050-START            PIC  9(6)       COMP-3.
  1160     12  ME-050-RUN-DT           PIC  9(6)       COMP-3.
  1161*    12  ME-050-END              PIC  9(6)       COMP-3.
  1162     12  ME-050-RUN-CT           PIC S9(3)       COMP-3.
  1163     12  ME-061-PREM             PIC S9(9)V99    COMP-3.
  1164     12  ME-061-COMM             PIC S9(9)V99    COMP-3.
  1165     12  ME-061-OR               PIC S9(9)V99    COMP-3.
  1166     12  ME-061-PY-ADJ           PIC S9(9)V99    COMP-3.
  1167     12  ME-061-COMM-RCALC       PIC S9(9)V99    COMP-3.
  1168     12  ME-061-OR-RCALC         PIC S9(9)V99    COMP-3.
  1169     12  ME-061-PREM-RCALC       PIC S9(9)V99    COMP-3.
  1170     12  ME-061-RUN-DT           PIC  9(6)       COMP-3.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  25
* ECS010T1.cbl (/apps/prod/cid1p/copy/ERCMEBL)
  1171*    12  ME-061-START            PIC  9(6)       COMP-3.
  1172*    12  ME-061-END              PIC  9(6)       COMP-3.
  1173     12  ME-061-RUN-CT           PIC S9(3)       COMP-3.
  1174     12  ME-080-MORT-ERRS        PIC  9(7)       COMP-3.
  1175     12  ME-080-RUN-DT           PIC  9(6)       COMP-3.
  1176*    12  ME-080-START            PIC  9(6)       COMP-3.
  1177*    12  ME-080-END              PIC  9(6)       COMP-3.
  1178     12  ME-080-RUN-CT           PIC S9(3)       COMP-3.
  1179     12  ME-315-RESV-L           PIC S9(9)V99    COMP-3.
  1180     12  ME-315-RESV-AH          PIC S9(9)V99    COMP-3.
  1181     12  ME-315-RUN-DT           PIC  9(6)       COMP-3.
  1182*    12  ME-315-START            PIC  9(6)       COMP-3.
  1183*    12  ME-315-END              PIC  9(6)       COMP-3.
  1184     12  ME-315-RUN-CT           PIC S9(3)       COMP-3.
  1185     12  ME-331-FLAG             PIC  9.
  1186     12  ME-331-RUN-DT           PIC  9(6)       COMP-3.
  1187*    12  ME-331-START            PIC  9(6)       COMP-3.
  1188*    12  ME-331-END              PIC  9(6)       COMP-3.
  1189     12  ME-331-RUN-CT           PIC S9(3)       COMP-3.
  1190     12  ME-341-NOT-FOUND        PIC S9(7)       COMP-3.
  1191     12  ME-341-RUN-DT           PIC  9(6)       COMP-3.
  1192*    12  ME-341-START            PIC  9(6)       COMP-3.
  1193*    12  ME-341-END              PIC  9(6)       COMP-3.
  1194     12  ME-341-RUN-CT           PIC S9(3)       COMP-3.
  1195     12  ME-501-FLAG             PIC  9.
  1196     12  ME-501-RUN-DT           PIC  9(6)       COMP-3.
  1197     12  ME-501-START            PIC  9(6)       COMP-3.
  1198     12  ME-501-END              PIC  9(6)       COMP-3.
  1199     12  ME-501-RUN-CT           PIC S9(3)       COMP-3.
  1200     12  ME-509-FLAG             PIC  9.
  1201     12  ME-509-RUN-DT           PIC  9(6)       COMP-3.
  1202     12  ME-509-START            PIC  9(6)       COMP-3.
  1203     12  ME-509-END              PIC  9(6)       COMP-3.
  1204     12  ME-509-RUN-CT           PIC S9(3)       COMP-3.
  1205     12  ME-522-PY-ADJ           PIC S9(9)V99    COMP-3.
  1206     12  ME-522-RETROS           PIC S9(9)V99    COMP-3.
  1207     12  ME-522-PROC-CLM-L       PIC S9(9)V99    COMP-3.
  1208     12  ME-522-PROC-CLM-AH      PIC S9(9)V99    COMP-3.
  1209     12  ME-522-ALL-CLM-L        PIC S9(9)V99    COMP-3.
  1210     12  ME-522-ALL-CLM-AH       PIC S9(9)V99    COMP-3.
  1211     12  ME-522-PROC-RSV-L       PIC S9(9)V99    COMP-3.
  1212     12  ME-522-PROC-RSV-AH      PIC S9(9)V99    COMP-3.
  1213     12  ME-522-ALL-RSV-L        PIC S9(9)V99    COMP-3.
  1214     12  ME-522-ALL-RSV-AH       PIC S9(9)V99    COMP-3.
  1215     12  ME-522-PREM-L           PIC S9(9)V99    COMP-3.
  1216     12  ME-522-PREM-AH          PIC S9(9)V99    COMP-3.
  1217     12  ME-522-REF-L            PIC S9(9)V99    COMP-3.
  1218     12  ME-522-REF-AH           PIC S9(9)V99    COMP-3.
  1219     12  ME-522-RUN-DT           PIC  9(6)       COMP-3.
  1220     12  ME-522-START            PIC  9(6)       COMP-3.
  1221     12  ME-522-END              PIC  9(6)       COMP-3.
  1222     12  ME-522-RUN-CT           PIC S9(3)       COMP-3.
  1223     12  ME-524-CLMS-L           PIC S9(9)V99    COMP-3.
  1224     12  ME-524-CLMS-AH          PIC S9(9)V99    COMP-3.
  1225     12  ME-524-RESV-L           PIC S9(9)V99    COMP-3.
  1226     12  ME-524-RESV-AH          PIC S9(9)V99    COMP-3.
  1227     12  ME-524-RUN-DT           PIC  9(6)       COMP-3.
  1228     12  ME-524-START            PIC  9(6)       COMP-3.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  26
* ECS010T1.cbl (/apps/prod/cid1p/copy/ERCMEBL)
  1229     12  ME-524-END              PIC  9(6)       COMP-3.
  1230     12  ME-524-RUN-CT           PIC S9(3)       COMP-3.
  1231     12  ME-525-FLAG             PIC  9.
  1232     12  ME-525-RUN-DT           PIC  9(6)       COMP-3.
  1233     12  ME-525-START            PIC  9(6)       COMP-3.
  1234     12  ME-525-END              PIC  9(6)       COMP-3.
  1235     12  ME-525-RUN-CT           PIC S9(3)       COMP-3.
  1236     12  ME-048-RECS-IN          PIC S9(7)       COMP-3.
  1237     12  ME-048-RECS-OUT         PIC S9(7)       COMP-3.
  1238     12  ME-048-RUN-DT           PIC  9(6)       COMP-3.
  1239     12  ME-048-START            PIC  9(6)       COMP-3.
  1240     12  ME-048-END              PIC  9(6)       COMP-3.
  1241     12  ME-048-RUN-CT           PIC S9(3)       COMP-3.
  1242     12  ME-041-REIN-ADJ         PIC S9(9)V99    COMP-3.
  1243
  1244     12  ME-019-CLMS-L           PIC S9(9)V99    COMP-3.
  1245     12  ME-019-CLMS-AH          PIC S9(9)V99    COMP-3.
  1246     12  ME-035-COMM-TOT         PIC S9(9)V99    COMP-3.
  1247     12  ME-035-CLMS-L           PIC S9(9)V99    COMP-3.
  1248     12  ME-035-CLMS-AH          PIC S9(9)V99    COMP-3.
  1249     12  ME-041-RECS-IN          PIC S9(9)       COMP-3.
  1250     12  ME-041-RECS-OUT         PIC S9(9)       COMP-3.
  1251     12  ME-050-ACT-L            PIC S9(7)       COMP-3.
  1252     12  ME-050-ACT-AH           PIC S9(7)       COMP-3.
  1253     12  ME-061-CLMS             PIC S9(9)V99    COMP-3.
  1254     12  ME-341-CLMS-L           PIC S9(9)V99    COMP-3.
  1255     12  ME-341-CLMS-AH          PIC S9(9)V99    COMP-3.
  1256     12  ME-515-CLMS-WRAP        PIC S9(7)V99    COMP-3.
  1257     12  ME-515-RESV-WRAP        PIC S9(7)V99    COMP-3.
  1258     12  ME-317-CLMS-TOT         PIC S9(9)V99    comp-3.
  1259     12  ME-325-CLMS-TOT         PIC S9(9)V99    comp-3.
  1260     12  ME-020-PREM-TOT         PIC S9(11)V99   COMP-3.
  1261     12  ME-020-CLMS-TOT         PIC S9(9)V99    COMP-3.
  1262     12  ME-020-RESV-TOT         PIC S9(9)V99    COMP-3.
  1263     12  ME-063-OW               PIC S9(9)V99    COMP-3.
  1264     12  ME-082-ACT-L            PIC S9(7)       COMP-3.
  1265     12  ME-082-ACT-AH           PIC S9(7)       COMP-3.
  1266     12  ME-016-RECS-IN          PIC S9(9)       COMP-3.
  1267     12  ME-016-RECS-OUT         PIC S9(9)       COMP-3.
  1268     12  ME-562-PREM-TOT         PIC S9(9)V99    COMP-3.
  1269     12  ME-562-COMM-TOT         PIC S9(9)V99    COMP-3.
  1270     12  ME-524-CLMS-TOT-CM      PIC S9(9)V99    comp-3.
  1271     12  ME-523-PREM-TOT         PIC S9(9)V99    COMP-3.
  1272     12  ME-064-BEG-BAL          PIC S9(9)V99    COMP-3.
  1273     12  ME-064-END-BAL          PIC S9(9)V99    COMP-3.
  1274     12  ME-010-MM-PREM-TOT      PIC S9(9)V99    COMP-3.
  1275     12  ME-010-MM-TOT-CLMS      PIC S9(9)V99    COMP-3.
  1276     12  ME-010-MM-TOT-RESV      PIC S9(9)V99    COMP-3.
  1277     12  ME-080-MORT-RESV        PIC S9(9)V99    COMP-3.
  1278
  1279     12  FILLER                  PIC  X(09).
  1280*    12  FILLER                  PIC  X(88).
  1281******************************************************************
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  27
* ECS010T1.cbl
  1283 FD  CERT-MASTER-OUT
* 1284                             COPY ECSCROFD.
  1285******************************************************************07/10/97
  1286*                                                                *ECSCROFD
  1287*                            ECSCROFD                            *   LV001
  1288*                            VMOD=2.002                          *ECSCROFD
  1289*                                                                *ECSCROFD
  1290*  NO CID MODS IN COPYBOOK ECSCROFD.                             *ECSCROFD
  1291*                                                                *ECSCROFD
  1292******************************************************************ECSCROFD
  1293     RECORDING MODE F                                             ECSCROFD
  1294     LABEL RECORDS STANDARD                                       ECSCROFD
  1295     BLOCK CONTAINS 0 RECORDS
  1296     RECORD CONTAINS 1056 CHARACTERS.                             ECSCROFD
  1297 01  CERT-OUT-RECORD.                                             ECSCROFD
  1298     12  FILLER                            PIC  XXX.              ECSCROFD
  1299     12  COR-CONTROL                       PIC  X(36).            ECSCROFD
  1300     12  FILLER                            PIC  X(1017).          ECSCROFD
  1301                                                                  ECSCROFD
  1302******************************************************************ECSCROFD
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  28
* ECS010T1.cbl
  1304 FD  DETAIL-EXTR
  1305     BLOCK CONTAINS 0 RECORDS
  1306     RECORDING MODE F.
  1307
* 1308                             COPY ECSEXT01.
  1309******************************************************************04/29/98
  1310*                                                                *ECSEXT01
  1311*                            ECSEXT01                            *   LV015
  1312*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL*15
  1313*                            VMOD=2.015                          *ECSEXT01
  1314*                                                                *ECSEXT01
  1315*   FILE DESCRIPTION =  DETAIL EXTRACTS                          *ECSEXT01
  1316*                       (PREMIUM, COMM., CLAIMS, AND RESERVES)   *ECSEXT01
  1317*                                                                *ECSEXT01
  1318*   FILE TYPE = SEQUENTIAL                                       *ECSEXT01
  1319*   RECORD SIZE = 510  RECFORM = FIXED                           *ECSEXT01
  1320*                                                                *ECSEXT01
  1321*   KEY DATA =                                   START=5, LEN=36 *ECSEXT01
  1322*                                                                *ECSEXT01
  1323******************************************************************ECSEXT01
  1324******************************************************************
  1325*                   C H A N G E   L O G
  1326*
  1327* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1328*-----------------------------------------------------------------
  1329*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1330* EFFECTIVE    NUMBER
  1331*-----------------------------------------------------------------
  1332* 040504    2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  1333* 042110  CR2010010400006  PEMA  ADD FIELDS FOR EMERALD 032
  1334* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  1335* 071211  CR2010012700001  PEMA  ADD SPP DEALER DIRECT
  1336* 112911  CR2011083000003  PEMA  ADD SPPDDF TRUNCATED
  1337* 032612  CR2011110200001  PEMA  AHL CHANGES
  1338******************************************************************
  1339                                                                  ECSEXT01
  1340 01  DETAIL-EXTRACT.                                              ECSEXT01
  1341     02 DETAIL-FILE.                                              ECSEXT01
  1342     12  DE-RECORD-ID                      PIC XX.                ECSEXT01
  1343         88  VALID-DE-ID                      VALUE 'DE'.         ECSEXT01
  1344                                                                  ECSEXT01
  1345     12  DE-COMPANY-CD                     PIC X.                 ECSEXT01
  1346                                                                  ECSEXT01
  1347     12  DE-REIN                           PIC X.                 ECSEXT01
  1348                                                                  ECSEXT01
  1349     12  DE-CONTROL.                                              ECSEXT01
  1350         16  DE-CNTRL1.                                           ECSEXT01
  1351             20  DE-CARRIER                PIC X.                 ECSEXT01
  1352             20  DE-GROUPING.                                     ECSEXT01
  1353                 24  DE-GROUP-PREFIX       PIC XXX.               ECSEXT01
  1354                 24  DE-GROUP-PRIME        PIC XXX.               ECSEXT01
  1355             20  DE-STATE                  PIC XX.                ECSEXT01
  1356             20  DE-ACCOUNT.                                      ECSEXT01
  1357                 24  DE-ACCT-PREFIX        PIC X(4).              ECSEXT01
  1358                 24  DE-ACCT-PRIME         PIC X(6).              ECSEXT01
  1359         16  DE-CNTRL2.                                           ECSEXT01
  1360             20  DE-EFF                    PIC 9(11)  COMP-3.     ECSEXT01
  1361             20  DE-CERT.                                         ECSEXT01
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  29
* ECS010T1.cbl (/apps/prod/cid1p/copy/ECSEXT01)
  1362                 24 DE-CERT-NO.                                   ECSEXT01
  1363                     28  DE-CRT-PREFIX     PIC XXX.               ECSEXT01
  1364                     28  DE-CRT-PRIME      PIC X(7).              ECSEXT01
  1365                 24  DE-CRT-SUF            PIC X.                 ECSEXT01
  1366                                                                  ECSEXT01
  1367     12  DE-TRANS                          PIC X.                 ECSEXT01
  1368         88  DE-ISSUE                         VALUE 'I'.          ECSEXT01
  1369         88  DE-RC-ISSUE                      VALUE '8'.          ECSEXT01
  1370         88  DE-CANCEL                        VALUE 'C'.          ECSEXT01
  1371         88  DE-RC-CANCEL                     VALUE '7'.          ECSEXT01
  1372         88  DE-CLAIM                         VALUE 'X'.          ECSEXT01
  1373         88  DE-RESTORE                       VALUE 'R'.          ECSEXT01
  1374         88  DE-RESERVE                       VALUE 'Y'.          ECSEXT01
  1375         88  DE-RR-RC-ISS                     VALUE 'J'.          ECSEXT01
  1376         88  DE-RR-RC-CNC                     VALUE 'K'.          ECSEXT01
  1377         88  DE-RR-RC-CLM                     VALUE 'L'.          ECSEXT01
  1378                                                                  ECSEXT01
  1379     12  DE-REPORT-CODE-1                  PIC X(10).             ECSEXT01
  1380     12  DE-REPORT-CODE-2                  PIC X(10).             ECSEXT01
  1381                                                                  ECSEXT01
  1382     12  DE-NAME.                                                 ECSEXT01
  1383         16  DE-LNAME                      PIC X(15).             ECSEXT01
  1384         16  DE-FNAME.                                            ECSEXT01
  1385             20  DE-1ST-INIT-FNAME         PIC X.                 ECSEXT01
  1386             20  FILLER                    PIC X(9).              ECSEXT01
  1387         16  DE-INIT                       PIC X.                 ECSEXT01
  1388     12  DE-AGE                            PIC 99.                ECSEXT01
  1389     12  DE-SEX                            PIC X.                 ECSEXT01
  1390     12  DE-SOC-SEC-NO                     PIC X(11).             ECSEXT01
  1391                                                                  ECSEXT01
  1392     12  DE-LF-TYPE                        PIC XX.                ECSEXT01
  1393     12  DE-LF-TERM                        PIC 999        COMP-3. ECSEXT01
  1394     12  DE-LF-BEN                         PIC S9(9)V99   COMP-3. ECSEXT01
  1395     12  DE-LF-CNBEN                       PIC S9(9)V99   COMP-3. ECSEXT01
  1396     12  DE-LF-PRM                         PIC S9(7)V99   COMP-3. ECSEXT01
  1397     12  DE-LF-BEN-ALT                     PIC S9(9)V99   COMP-3. ECSEXT01
  1398     12  DE-LF-CNBEN-ALT                   PIC S9(9)V99   COMP-3. ECSEXT01
  1399     12  DE-LF-PRM-ALT                     PIC S9(7)V99   COMP-3. ECSEXT01
  1400     12  DE-LF-RFND                        PIC S9(7)V99   COMP-3. ECSEXT01
  1401                                                                  ECSEXT01
  1402     12  DE-LF-STAT-CDE                    PIC X.                 ECSEXT01
  1403     12  DE-LF-PREV-STAT                   PIC X.                 ECSEXT01
  1404     12  DE-LF-CANC-DTE                    PIC 9(11)      COMP-3. ECSEXT01
  1405     12  DE-LF-CANC-EXIT-DT                PIC 9(11)      COMP-3. ECSEXT01
  1406                                                                  ECSEXT01
  1407     12  DE-AH-TYPE                        PIC XX.                ECSEXT01
  1408     12  DE-AH-TERM                        PIC 999        COMP-3. ECSEXT01
  1409     12  DE-AH-BEN                         PIC S9(7)V99   COMP-3. ECSEXT01
  1410     12  DE-AH-PRM                         PIC S9(7)V99   COMP-3. ECSEXT01
  1411     12  DE-AH-RFND                        PIC S9(7)V99   COMP-3. ECSEXT01
  1412                                                                  ECSEXT01
  1413     12  DE-AH-STAT-CDE                    PIC X.                 ECSEXT01
  1414     12  DE-AH-PREV-STAT                   PIC X.                 ECSEXT01
  1415     12  DE-AH-CANC-DTE                    PIC 9(11)  COMP-3.     ECSEXT01
  1416     12  DE-AH-CANC-EXIT-DT                PIC 9(11)  COMP-3.     ECSEXT01
  1417                                                                  ECSEXT01
  1418     12  DE-LIVES                          PIC S9(7)      COMP-3. ECSEXT01
  1419     12  DE-ADDL-CLP REDEFINES DE-LIVES
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  30
* ECS010T1.cbl (/apps/prod/cid1p/copy/ECSEXT01)
  1420                                           PIC S9(5)V99   COMP-3.
  1421     12  DE-NUM-BILLED                     PIC S9(7)      COMP-3. ECSEXT01
  1422     12  FILLER REDEFINES DE-NUM-BILLED.
  1423         16  DE-CLP-STATE                  PIC XX.
  1424         16  DE-DCC-DDF-REM-TRM3           PIC S999       COMP-3.
  1425     12  DE-CANCEL-CNT-ITD                 PIC S999       COMP-3. ECSEXT01
  1426     12  DE-CANCEL-CNT-YTD                 PIC S999       COMP-3. ECSEXT01
  1427                                                                  ECSEXT01
  1428     12  DE-APR                            PIC S999V9(4)  COMP-3. ECSEXT01
  1429     12  DE-PMT-FREQ                       PIC 99.                ECSEXT01
  1430     12  DE-ACC-GPCD                       PIC XX.                ECSEXT01
  1431     12  DE-IG                             PIC X.                 ECSEXT01
  1432     12  DE-REMIT-TO                       PIC XX.                ECSEXT01
  1433*    12  DE-MEMBER-NO                      PIC X(12).             ECSEXT01
  1434     12  DE-MEMBER-NO.                                            ECSEXT01
  1435         16  DE-MASTER-POLICY              PIC X(06).             ECSEXT01
  1436         16  DE-ZIP                        PIC 9(05)    COMP-3.   ECSEXT01
  1437         16  FILLER                        PIC X(03).             ECSEXT01
  1438     12  DE-LN-OFFICER                     PIC XXX.               ECSEXT01
  1439                                                                  ECSEXT01
  1440     12  DE-AUTO-GEND-IND                  PIC X.                 ECSEXT01
  1441         88  DE-AUTO-GEND-REINS            VALUE 'R'.             ECSEXT01
  1442                                                                  ECSEXT01
  1443     12  DE-ENTRY-STATUS                   PIC X.                 ECSEXT01
  1444     12  DE-ENTRY-DTE                      PIC 9(11)      COMP-3. ECSEXT01
  1445                                                                  ECSEXT01
  1446     12  DE-REI-AREA.                                             ECSEXT01
  1447         16  DE-REI-COMP.                                         ECSEXT01
  1448             20  DE-REINCO                 PIC XXX.               ECSEXT01
  1449             20  DE-REINCO-SUB             PIC XXX.               ECSEXT01
  1450         16  DE-REI-LFAMT                  PIC S9(9)V99   COMP-3. ECSEXT01
  1451         16  DE-REI-LFPRM                  PIC S9(7)V99   COMP-3. ECSEXT01
  1452         16  DE-REI-LFRFND                 PIC S9(7)V99   COMP-3. ECSEXT01
  1453         16  DE-REI-AHAMT                  PIC S9(7)V99   COMP-3. ECSEXT01
  1454         16  DE-REI-AHPRM                  PIC S9(7)V99   COMP-3. ECSEXT01
  1455         16  DE-REI-AHRFND                 PIC S9(7)V99   COMP-3. ECSEXT01
  1456         16  DE-REI-CNAMT                  PIC S9(9)V99   COMP-3. ECSEXT01
  1457                                                                  ECSEXT01
  1458     12  DE-MOB-NET-TOT-FEES               PIC S9(7)V99   COMP-3.
  1459     12  FILLER REDEFINES DE-MOB-NET-TOT-FEES.
  1460         16  DE-IU-RATE-UP                 PIC S9(5)V99 COMP-3.
  1461         16  F                             PIC X.
  1462*    12  FILLER                            PIC X(5).              ECSEXT01
  1463                                                                  ECSEXT01
  1464     12  DE-BILLED-AREA.                                          ECSEXT01
  1465         16  DE-GL-INTERFACE-CODES.                               ECSEXT01
  1466             20  DE-GL-CODES               PIC X  OCCURS 10 TIMES.ECSEXT01
  1467                                                                  ECSEXT01
  1468         16  DE-BILL-SW                    PIC X.                 ECSEXT01
  1469             88  DE-RECORD-ON-HOLD            VALUE 'H'.          ECSEXT01
  1470             88  DE-RECORD-RETURNED           VALUE 'R'.          ECSEXT01
  1471             88  DE-RECORD-ENDORSED           VALUE 'E'.          ECSEXT01
  1472             88  DE-OVERRIDE-LIFE             VALUE 'L'.          ECSEXT01
  1473             88  DE-OVERRIDE-AH               VALUE 'A'.          ECSEXT01
  1474             88  DE-OVERRIDE-BOTH             VALUE 'B'.          ECSEXT01
  1475                                                                  ECSEXT01
  1476         16  DE-REFUND-SW                  PIC X.                 ECSEXT01
  1477             88  DE-REFUND-CREATED            VALUE 'Y'.          ECSEXT01
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  31
* ECS010T1.cbl (/apps/prod/cid1p/copy/ECSEXT01)
  1478                                                                  ECSEXT01
  1479         16  DE-BILLED-LFPRM               PIC S9(7)V99   COMP-3. ECSEXT01
  1480         16  DE-BILLED-LFRFND              PIC S9(7)V99   COMP-3. ECSEXT01
  1481         16  DE-BILLED-AHPRM               PIC S9(7)V99   COMP-3. ECSEXT01
  1482         16  DE-BILLED-AHRFND              PIC S9(7)V99   COMP-3. ECSEXT01
  1483                                                                  ECSEXT01
  1484         16  DE-GA-BILL-STATUS             PIC X  OCCURS 5 TIMES. ECSEXT01
  1485*            88  DE-NO-PRE-BILL-GA            VALUE ' '.          ECSEXT01
  1486*            88  DE-BILLED-GA                 VALUE 'B'.          ECSEXT01
  1487                                                                  ECSEXT01
  1488     12  DE-BILL-STATUS                    PIC X.                 ECSEXT01
  1489         88  DE-NO-PRE-BILL                   VALUE ' '.          ECSEXT01
  1490         88  DE-BILLED                        VALUE 'B'.          ECSEXT01
  1491         88  DE-REVERSE                       VALUE 'R'.          ECSEXT01
  1492                                                                  ECSEXT01
  1493     12  DE-REVERSE-REASONS.                                      ECSEXT01
  1494         16  DE-REVERSE-REASON-1           PIC X.                 ECSEXT01
  1495         16  DE-REVERSE-REASON-2           PIC X.                 ECSEXT01
  1496     12  DE-CANCEL-REASON                  PIC X.
  1497                                                                  ECSEXT01
  1498     12  DE-RECALC-CODE                    PIC X.                 ECSEXT01
  1499     12  DE-RECALC-TYPE                    PIC X.                 ECSEXT01
  1500                                                                  ECSEXT01
  1501     12  DE-CHARGEBACK-CODES.                                     ECSEXT01
  1502         16  DE-LF-COMM-CHARGEBACK         PIC X.                 ECSEXT01
  1503             88  DE-NO-LF-CHARGEBACK          VALUE 'N'.          ECSEXT01
  1504         16  DE-AH-COMM-CHARGEBACK         PIC X.                 ECSEXT01
  1505             88  DE-NO-AH-CHARGEBACK          VALUE 'N'.          ECSEXT01
  1506                                                                  ECSEXT01
  1507     12  DE-UNDERWRITING-CODE              PIC X.                 ECSEXT01
  1508         88  DE-POLICY-UNDERWRITTEN           VALUE 'Y'.          ECSEXT01
  1509                                                                  ECSEXT01
  1510     12  DE-NCL-POOL-CODE                  PIC XXX.               ECSEXT01
  1511     12  FILLER REDEFINES DE-NCL-POOL-CODE.
  1512         16  DE-LOAN-TERM                  PIC S999 COMP-3.
  1513         16  FILLER                        PIC X.
  1514                                                                  ECSEXT01
  1515****************************************************************  ECSEXT01
  1516**** CLAIM EXTRACT AND RESERVE EXTRACT IS REDEFINED AT THIS POINT ECSEXT01
  1517****************************************************************  ECSEXT01
  1518     12  DE-COMM-LEVELS.                                          ECSEXT01
  1519         16  DE-AGT-LEVELS     OCCURS  10  TIMES.                 ECSEXT01
  1520             20  DE-AGT.                                          ECSEXT01
  1521                 24  DE-AGT-PREFIX         PIC X(4).              ECSEXT01
  1522                 24  DE-AGT-PRIME          PIC X(6).              ECSEXT01
  1523             20  DE-AGT-TYPE               PIC X.                 ECSEXT01
  1524             20  DE-L-PC                   PIC SV9(5)     COMP-3. ECSEXT01
  1525             20  DE-A-PC                   PIC SV9(5)     COMP-3. ECSEXT01
  1526                                                                  ECSEXT01
  1527     12  DE-PROC-DT                        PIC 9(11)      COMP-3. ECSEXT01
  1528****************************************************************  ECSEXT01
  1529*******                 CLAIM EXTRACT                      *****  ECSEXT01
  1530****************************************************************  ECSEXT01
  1531     02 DE-CLAIM-EXTRACT     REDEFINES     DETAIL-FILE.           ECSEXT01
  1532     12  FILLER                            PIC X(334).            ECSEXT01
  1533     12  DE-TYPE                           PIC X.                 ECSEXT01
  1534         88  DE-DTH                           VALUE '1'.          ECSEXT01
  1535         88  DE-AH                            VALUE '2'.          ECSEXT01
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  32
* ECS010T1.cbl (/apps/prod/cid1p/copy/ECSEXT01)
  1536         88  DE-OB-DTH                        VALUE '3'.          ECSEXT01
  1537         88  DE-OB-AH                         VALUE '4'.          ECSEXT01
  1538         88  DE-DEATH                         VALUES '1' '3'.     ECSEXT01
  1539         88  DE-DISABILITY                    VALUES '2' '4'.     ECSEXT01
  1540                                                                  ECSEXT01
  1541     12  DE-CLAIM-AMT                      PIC S9(9)V99   COMP-3. ECSEXT01
  1542     12  DE-REI-CLAIM-AMT                  PIC S9(9)V99   COMP-3. ECSEXT01
  1543                                                                  ECSEXT01
  1544     12  DE-INCUR                          PIC 9(11)      COMP-3. ECSEXT01
  1545     12  DE-REPORTED.                                             ECSEXT01
  1546         16  DE-RPT-YR                     PIC 99.                ECSEXT01
  1547         16  DE-RPT-MO                     PIC 99.                ECSEXT01
  1548         16  DE-RPT-DA                     PIC 99.                ECSEXT01
  1549     12  DE-PAY                            PIC 9(11)      COMP-3. ECSEXT01
  1550     12  DE-PAID-TO                        PIC 9(11)      COMP-3. ECSEXT01
  1551                                                                  ECSEXT01
  1552     12  DE-CNUM                           PIC X(7).              ECSEXT01
  1553     12  DE-CHECK                          PIC X(7).              ECSEXT01
  1554     12  DE-PMT-TRAILER-SEQ                PIC S9(4)       COMP.  ECSEXT01
  1555     12  DE-DAYS-DISAB                     PIC 999.               ECSEXT01
  1556     12  DE-CLM-AGE                        PIC 99.                ECSEXT01
  1557     12  DE-PAY-CODE                       PIC X.                 ECSEXT01
  1558         88  DE-PARTIAL-PAYMENT               VALUE 'P'.          ECSEXT01
  1559         88  DE-FINAL-PAYMENT                 VALUE 'F'.          ECSEXT01
  1560         88  DE-LUMP-SUM-PAYMENT              VALUE 'S'.          ECSEXT01
  1561         88  DE-ADDITIONAL-PAYMENT            VALUE 'X'.          ECSEXT01
  1562         88  DE-CHARGEABLE-EXPENSE            VALUE 'E'.          ECSEXT01
  1563         88  DE-NON-CHARGEABLE-EXPENSE        VALUE 'E'.          ECSEXT01
  1564         88  DE-VOIDED-PAYMENT                VALUE 'V'.          ECSEXT01
  1565                                                                  ECSEXT01
  1566     12  DE-CLM-ERR                        PIC XX.                ECSEXT01
  1567                                                                  ECSEXT01
  1568     12  DE-ACC-NAME                       PIC X(30).             ECSEXT01
  1569     12  DE-ACC-EXP-DTE                    PIC 9(11)  COMP-3.     ECSEXT01
  1570     12  DE-ACC-EFF-DTE                    PIC 9(11)  COMP-3.     ECSEXT01
  1571     12  FILLER                            PIC XX.                ECSEXT01
  1572     12  DE-LOAN-OFFICER                   PIC XXX.               ECSEXT01
  1573                                                                  ECSEXT01
  1574     12  DE-LOAN-TYPE                      PIC X(02).             ECSEXT01
  1575     12  DE-BENEFICIARY                    PIC X(10).
  1576     12  filler redefines de-beneficiary.
  1577         16  de-birth-date                 pic 9(11)  comp-3.
  1578         16  f                             pic x(4).
  1579     12  DE-LOAN-CLASS                     PIC X(02).             ECSEXT01
  1580     12  DE-LOSS-CODE                      PIC X(06).             ECSEXT01
  1581     12  DE-ASSOCIATES                     PIC X(01).             ECSEXT01
  1582     12  DE-LEGAL-STATE                    PIC X(02).             ECSEXT01
  1583     12  DE-CLM-CAUSE                      PIC X(6).              ECSEXT01
  1584     12  DE-CLM-CLASS                      PIC XX.
  1585     12  DE-CLM-DEV                        PIC XXX.
  1586     12  DE-XYCOR-CLAIM-NO                 PIC X(9).
  1587     12  de-xycor-cert-seq                 pic x(3).
  1588     12  DE-XYCOR-CHECK-NO                 PIC X(8).
  1589     12  DE-XYCOR-ACTION-CD                PIC XXX.
  1590     12  DE-XYCOR-STATUS                   PIC X.
  1591     12  FILLER                            PIC X(4).              ECSEXT01
  1592                                                                  ECSEXT01
  1593     12  DE-CLM-PROC-DT                    PIC 9(11)  COMP-3.        CL**2
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  33
* ECS010T1.cbl (/apps/prod/cid1p/copy/ECSEXT01)
  1594                                                                  ECSEXT01
  1595****************************************************************  ECSEXT01
  1596*******               RESERVE EXTRACT                      *****  ECSEXT01
  1597****************************************************************  ECSEXT01
  1598     02 DE-RESERVE-EXTRACT     REDEFINES     DETAIL-FILE.         ECSEXT01
  1599     12  FILLER                            PIC X(334).            ECSEXT01
  1600                                                                  ECSEXT01
  1601     12  DE-RESERVE-TYPE                   PIC X.                 ECSEXT01
  1602         88  DE-LIFE-RSV                      VALUE '1' '3'.      ECSEXT01
  1603         88  DE-AH-RSV                        VALUE '2' '4'.      ECSEXT01
  1604                                                                  ECSEXT01
  1605     12  DE-IBNR                           PIC S9(7)V99   COMP-3. ECSEXT01
  1606     12  DE-PAYCUR                         PIC S9(7)V99   COMP-3. ECSEXT01
  1607     12  DE-FUTRSV                         PIC S9(7)V99   COMP-3. ECSEXT01
  1608                                                                  ECSEXT01
  1609     12  DE-CLMNO                          PIC X(7).              ECSEXT01
  1610                                                                  ECSEXT01
  1611     12  DE-RSV-INCUR                      PIC 9(11)      COMP-3. ECSEXT01
  1612     12  DE-RSV-REPORTED.                                         ECSEXT01
  1613         16  DE-RSV-RPT-YR                 PIC 99.                ECSEXT01
  1614         16  DE-RSV-RPT-MO                 PIC 99.                ECSEXT01
  1615         16  DE-RSV-RPT-DA                 PIC 99.                ECSEXT01
  1616     12  DE-RSV-PAYTO                      PIC 9(11)      COMP-3. ECSEXT01
  1617                                                                  ECSEXT01
  1618     12  DE-REI-IBNR                       PIC S9(7)V99   COMP-3. ECSEXT01
  1619     12  DE-REI-PAYCUR                     PIC S9(7)V99   COMP-3. ECSEXT01
  1620     12  DE-REI-FUTRSV                     PIC S9(7)V99   COMP-3. ECSEXT01
  1621                                                                  ECSEXT01
  1622     12  DE-RSV-ACC-NAME                   PIC X(30).             ECSEXT01
  1623     12  DE-ACC-EXP-DTE-RSV                PIC 9(11)      COMP-3. ECSEXT01
  1624     12  DE-ACC-EFF-DTE-RSV                PIC 9(11)      COMP-3. ECSEXT01
  1625                                                                  ECSEXT01
  1626     12  DE-MANUAL-RSV-SWITCH              PIC X.                 ECSEXT01
  1627                                                                  ECSEXT01
  1628     12  DE-RATE-CLASS                     PIC XX.
  1629     12  DE-DEV-CODE                       PIC XXX.
  1630     12  DE-RSV-REM-TERM                   PIC S999       COMP-3.
  1631     12  DE-RSV-REM-BENEFIT                PIC S9(9)V99   COMP-3.
  1632     12  FILLER                            PIC X(58).             ECSEXT01
  1633                                                                  ECSEXT01
  1634     12  DE-RSV-PROC-DT                    PIC 9(11)  COMP-3.        CL**2
  1635******************************************************************ECSEXT01
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  34
* ECS010T1.cbl
  1637 FD  SUMMARY-EXTR
  1638     BLOCK CONTAINS 0 RECORDS
  1639     RECORDING MODE F.
  1640
* 1641                             COPY ECSEPC01.
  1642******************************************************************
  1643*                                                                *
  1644*                            ECSEPC01                            *
  1645*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1646*                            VMOD=2.008                          *
  1647*                                                                *
  1648*   FILE DESCRIPTION =  EARNED PREM / EARNED COMM  (E.P.E.C.)    *
  1649*                                                                *
  1650*   FILE TYPE = SEQUENTIAL                                       *
  1651*   RECORD SIZE = 325  RECFORM = FIXED                           *
  1652*                                                                *
  1653*   KEY DATA =                                  START=5, LEN=31  *
  1654*                                                                *
  1655*  NO  CID  MODS  IN  COPYBOOK  ECSEPC01                         *
  1656*                                                                *
  1657******************************************************************
  1658
  1659 01  EP-RECORD.
  1660     02 EP-FILE.
  1661     12  EP-RECORD-ID                      PIC XX.
  1662         88  VALID-EP-ID                      VALUE 'EP'.
  1663
  1664     12  EP-COMPANY-CD                     PIC X.
  1665
  1666     12  EP-REIN                           PIC X.
  1667         88  EP-REIN-EXTRACT                  VALUE 'R'.
  1668
  1669     12  EP-CONTROL.
  1670         16  EP-CNTRL-1.
  1671             20  EP-COMPANY.
  1672                 24  EP-CARRIER            PIC X.
  1673                 24  EP-GROUPING.
  1674                     28  EP-GROUP-PREFIX   PIC XXX.
  1675                     28  EP-GROUP-PRIME    PIC XXX.
  1676             20  EP-STATE                  PIC XX.
  1677             20  EP-ACCOUNT.
  1678                 24  EP-ACCT-PREFIX        PIC X(4).
  1679                 24  EP-ACCT-PRIME         PIC X(6).
  1680         16  EP-CNTRL-2.
  1681             20  EP-DATES.
  1682                 24  EP-EXP-DTE            PIC 9(11)   COMP-3.
  1683                 24  EP-EFF-DTE            PIC 9(11)   COMP-3.
  1684
  1685     12  EP-REI-CO.
  1686         16  EP-REINCO                     PIC XXX.
  1687         16  EP-REINCO-SUB                 PIC XXX.
  1688
  1689     12  EP-RCD-TYPE                       PIC X.
  1690         88  EP-BEN-TYPE-LIFE                 VALUE 'L'.
  1691         88  EP-BEN-TYPE-AH                   VALUE 'A'.
  1692         88  EP-BEN-TYPE-PROPERTY             VALUE 'P'.
  1693         88  EP-BEN-TYPE-UNEMPLOYMENT         VALUE 'U'.
  1694         88  EP-BEN-TYPE-DISMEMBURMENT        VALUE 'D'.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  35
* ECS010T1.cbl (/apps/prod/cid1p/copy/ECSEPC01)
  1695         88  EP-BEN-TYPE-AD-D                 VALUE 'E'.
  1696     12  EP-BEN-CODE                       PIC XX.
  1697     12  FILLER                            PIC X.
  1698
  1699     12  EP-ISS-CNT                        PIC S9(7)      COMP-3.
  1700     12  EP-ISS-BEN                        PIC S9(11)V99  COMP-3.
  1701     12  EP-ISS-BEN-GROSS                  PIC S9(11)V99  COMP-3.
  1702
  1703     12  EP-CNC-CNT                        PIC S9(7)      COMP-3.
  1704     12  EP-CNC-BEN                        PIC S9(11)V99  COMP-3.
  1705     12  EP-CNC-BEN-GROSS                  PIC S9(11)V99  COMP-3.
  1706
  1707     12  EP-ISS-PRM                        PIC S9(9)V99   COMP-3.
  1708     12  EP-ISS-PRM-GROSS                  PIC S9(9)V99   COMP-3.
  1709     12  EP-CNC-PRM                        PIC S9(9)V99   COMP-3.
  1710     12  EP-CNC-PRM-GROSS                  PIC S9(9)V99   COMP-3.
  1711
  1712     12  EP-PRM-78                         PIC S9(9)V99   COMP-3.
  1713     12  EP-PRM-PR                         PIC S9(9)V99   COMP-3.
  1714     12  EP-PRM-ST                         PIC S9(9)V99   COMP-3.
  1715
  1716     12  EP-CLM-AMT                        PIC S9(9)V99   COMP-3.
  1717     12  EP-CLM-CNT                        PIC S9(7)      COMP-3.
  1718     12  EP-CLM-CRT                        PIC S9(7)      COMP-3.
  1719
  1720     12  EP-CLM-DU                         PIC S9(7)V99   COMP-3.
  1721     12  EP-CLM-PV                         PIC S9(7)V99   COMP-3.
  1722     12  EP-CLM-IBNR                       PIC S9(7)V99   COMP-3.
  1723     12  EP-LOSS-RESV                      PIC S9(7)V99   COMP-3.
  1724     12  EP-CLAIM-ADJ                      PIC S9(7)V99   COMP-3.
  1725
  1726     12  EP-RETRO-EXPENSES                 PIC S9(7)V99   COMP-3.
  1727     12  EP-RETRO-PAYMENTS                 PIC S9(7)V99   COMP-3.
  1728     12  EP-RETRO-OTH-COMM                 PIC S9(7)V99   COMP-3.
  1729
  1730     12  EP-MORT-RESV                      PIC S9(11)V9(6) COMP-3.
  1731     12  EP-IN-FORCE                       PIC S9(11)V99   COMP-3.
  1732     12  EP-ADJUST                         PIC S9(7)V99    COMP-3.
  1733
  1734     12  EP-SPECIFIC-OPT-RSV-FIELDS.
  1735         16  EP-LIFE-YEARS                 PIC S9(9)      COMP-3.
  1736         16  EP-NEW-DATA-IND               PIC X(01).
  1737             88  EP-NEW-DATA                   VALUE 'Y'.
  1738         16  EP-CLM-EXP                    PIC S9(9)V99   COMP-3.
  1739         16  FILLER                        PIC X(19).
  1740
  1741     12  EP-PRM-78-ADJ                     PIC S9(9)V99   COMP-3.
  1742     12  EP-PRM-PR-ADJ                     PIC S9(9)V99   COMP-3.
  1743     12  EP-PRM-ST-ADJ                     PIC S9(9)V99   COMP-3.
  1744
  1745     12  FILLER                            PIC XXX.
  1746
  1747     12  EP-UNDERWRITING-CODE              PIC X.
  1748         88  EP-UNDERWRITTEN-DATA             VALUE 'Y'.
  1749
  1750     12  EP-PRM-TAX                        PIC S9(7)V99   COMP-3.
  1751
  1752     12  FILLER                            PIC X(29).
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  36
* ECS010T1.cbl (/apps/prod/cid1p/copy/ECSEPC01)
  1753*    12  FILLER                            PIC X(34).
  1754
  1755     12  EP-AVG-AGE                        PIC S9(3)      COMP-3.
  1756     12  EP-AVG-ORIG-TERM                  PIC S9(3)      COMP-3.
  1757     12  EP-WEIGHTED-AGE                   PIC S9(3)      COMP-3.
  1758     12  EP-WEIGHTED-ORIG-TERM             PIC S9(3)      COMP-3.
  1759     12  EP-AVG-REM-TERM                   PIC S9(3)      COMP-3.
  1760     12  EP-INFORCE-CNT                    PIC S9(9)      COMP-3.
  1761
  1762     12  EP-HI-COV-DT                      PIC 9(11)      COMP-3.
  1763
  1764     12  EP-HI-CERT                        PIC 9(11)      COMP-3.
  1765     12  EP-LO-CERT                        PIC 9(11)      COMP-3.
  1766
  1767     12  EP-PURGE                          PIC X.
  1768         88  EP-DATA-FROM-PURGED-CERTS        VALUE 'P'.
  1769
  1770     12  EP-RUN-DTE                        PIC 9(11)      COMP-3.
  1771
  1772     02 EC-RECORD     REDEFINES     EP-FILE.
  1773     12  EC-RECORD-ID                      PIC XX.
  1774         88  VALID-EC-ID                      VALUE 'EC'.
  1775
  1776     12  EC-COMPANY-CD                     PIC X.
  1777
  1778     12  EC-REIN                           PIC X.
  1779         88  EC-REIN-EXTRACT                  VALUE 'R'.
  1780
  1781     12  EC-CONTROL.
  1782         16  EC-CARRIER                    PIC X.
  1783         16  EC-GROUPING.
  1784             20  EC-GROUP-PREFIX           PIC XXX.
  1785             20  EC-GROUP-PRIME            PIC XXX.
  1786         16  EC-STATE                      PIC XX.
  1787         16  EC-ACCOUNT.
  1788             20  EC-ACCT-PREFIX            PIC X(4).
  1789             20  EC-ACCT-PRIME             PIC X(6).
  1790         16  EC-DATES.
  1791             20  EC-EXP-DTE                PIC 9(11)    COMP-3.
  1792             20  EC-EFF-DTE                PIC 9(11)    COMP-3.
  1793
  1794     12  EC-REI-CO.
  1795         16  EC-REINCO                     PIC XXX.
  1796         16  EC-REINCO-SUB                 PIC XXX.
  1797
  1798     12  EC-RCD-TYPE                       PIC X.
  1799         88  EC-BEN-TYPE-LIFE                 VALUE 'L'.
  1800         88  EC-BEN-TYPE-AH                   VALUE 'A'.
  1801         88  EC-BEN-TYPE-PROPERTY             VALUE 'P'.
  1802         88  EC-BEN-TYPE-UNEMPLOYMENT         VALUE 'U'.
  1803         88  EC-BEN-TYPE-DISMEMBURMENT        VALUE 'D'.
  1804     12  EC-BEN-CODE                       PIC XX.
  1805     12  EC-SEQ-NBR                        PIC X.
  1806         88  EC-COMP-LEVELS-1-5               VALUE '1'.
  1807         88  EC-COMP-LEVELS-6-10              VALUE '2'.
  1808
  1809     12  EC-AGENTS-DATA.
  1810         16  EC-AGENTS-LEVEL     OCCURS   5   TIMES.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  37
* ECS010T1.cbl (/apps/prod/cid1p/copy/ECSEPC01)
  1811             20  EC-AGT-NO.
  1812                 24  EC-AGT-PREFIX         PIC X(4).
  1813                 24  EC-AGT-PRIME          PIC X(6).
  1814             20  EC-AGT-TYPE               PIC X.
  1815             20  EC-ISS-COMM               PIC S9(9)V99   COMP-3.
  1816             20  EC-CNC-COMM               PIC S9(9)V99   COMP-3.
  1817             20  EC-COMM-78                PIC S9(9)V99   COMP-3.
  1818             20  EC-COMM-PR                PIC S9(9)V99   COMP-3.
  1819             20  EC-COMM-ST                PIC S9(9)V99   COMP-3.
  1820
  1821     12  EC-UNDERWRITING-CODE              PIC X.
  1822         88  EC-UNDERWRITTEN-DATA             VALUE 'Y'.
  1823
  1824     12  EC-AGENTS-DATA-II.
  1825         16  EC-AGENTS-LEVEL-II  OCCURS   5   TIMES.
  1826             20  EC-COMM-78-ADJ            PIC S9(9)V99   COMP-3.
  1827             20  EC-COMM-PR-ADJ            PIC S9(9)V99   COMP-3.
  1828
  1829     12  FILLER                            PIC X(7).
  1830
  1831     12  EC-PURGE                          PIC X.
  1832         88  EC-DATA-FROM-PURGED-CERTS        VALUE 'P'.
  1833
  1834     12  EC-RUN-DTE                        PIC 9(11)     COMP-3.
  1835
  1836******************************************************************
  1837
  1838 FD  ERRESC-IN.
* 1839                             COPY ERCRESC.
  1840******************************************************************04/29/98
  1841*                                                                *ERCRESC
  1842*                            ERCRESC                             *   LV002
  1843*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  1844*                            VMOD=2.003                          *   CL**2
  1845*                                                                *ERCRESC
  1846*   FILE DESCRIPTION = ACCOUNT RESIDENT STATE COMMISSION         *ERCRESC
  1847*                                                                *ERCRESC
  1848*   FILE TYPE = VSAM,KSDS                                        *ERCRESC
  1849*   RECORD SIZE = 103 RECFORM = FIXED                            *ERCRESC
  1850*                                                                *ERCRESC
  1851*   BASE CLUSTER NAME = ERRESC                    RKP=00,LEN=37  *ERCRESC
  1852*       ALTERNATE PATH1 = NONE                                   *ERCRESC
  1853*                                                                *ERCRESC
  1854*   LOG = NO                                                     *ERCRESC
  1855*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *ERCRESC
  1856*                                                                *ERCRESC
  1857******************************************************************ERCRESC
  1858                                                                  ERCRESC
  1859 01  ACCOUNT-RESIDENT-ST-COMMISSION.                              ERCRESC
  1860                                                                  ERCRESC
  1861     10  ERRESC-RECORD-KEY.                                       ERCRESC
  1862         15  RESC-COMPANY-CD           PIC   X.                   ERCRESC
  1863         15  RESC-CARRIER              PIC   X.                   ERCRESC
  1864         15  RESC-GROUP                PIC   X(6).                ERCRESC
  1865         15  RESC-STATE                PIC   XX.                  ERCRESC
  1866         15  RESC-ACCOUNT              PIC   X(10).               ERCRESC
  1867         15  RESC-AGENT                PIC   X(10).               ERCRESC
  1868         15  RESC-RESIDENT-STATE       PIC   XX.                  ERCRESC
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  38
* ECS010T1.cbl (/apps/prod/cid1p/copy/ERCRESC)
  1869         15  RESC-EXPIRE-DATE          PIC  9(8) COMP-3.          ERCRESC
  1870*                                           YYYYMMDD              ERCRESC
  1871     10  RESC-EFFECTIVE-DATE           PIC  9(8) COMP-3.          ERCRESC
  1872                                                                  ERCRESC
  1873     10  RESC-COMM-RECORD-DATA.                                   ERCRESC
  1874         15  RESC-COMMISSIONS OCCURS 12 TIMES.                    ERCRESC
  1875             20 RESC-COVERAGE-CAT      PIC    X.                  ERCRESC
  1876             20 RESC-COMMISSION-PER    PIC SV9(5) COMP-3.         ERCRESC
  1877             20 RESC-COMMISSION-TAB REDEFINES                     ERCRESC
  1878                RESC-COMMISSION-PER    PIC  XXX.                  ERCRESC
  1879                                                                  ERCRESC
  1880     10  RESC-MAINT-BY                 PIC X(4).                  ERCRESC
  1881     10  RESC-LST-MAINT-TIME           PIC 9(7)   COMP-3.         ERCRESC
  1882     10  RESC-LST-MAINT-DATE           PIC 9(8)   COMP-3.         ERCRESC
  1883*                                          YYYYMMDD               ERCRESC
  1884 FD  ELCRTT.
  1885
* 1886                             COPY ELCCRTT.
  1887******************************************************************
  1888*                                                                *ELCCRTT
  1889*                            ELCCRTT.                            *
  1890*                                                                *ELCCRTT
  1891*   FILE DESCRIPTION = CERTIFICATE TRAILERS                      *ELCCRTT
  1892*                                                                *ELCCRTT
  1893*   FILE TYPE = VSAM,KSDS                                        *ELCCRTT
  1894*   RECORD SIZE = 552  RECFORM = FIXED                           *ELCCRTT
  1895*                                                                *ELCCRTT
  1896*   BASE CLUSTER = ELCRTT                         RKP=2,LEN=34   *ELCCRTT
  1897*                                                                *ELCCRTT
  1898*   LOG = YES                                                    *ELCCRTT
  1899*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *ELCCRTT
  1900******************************************************************
  1901*                   C H A N G E   L O G
  1902*
  1903* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1904*-----------------------------------------------------------------
  1905*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1906* EFFECTIVE    NUMBER
  1907*-----------------------------------------------------------------
  1908* 111204                   PEMA  NEW FILE TO SPLIT BANK COMM
  1909* 040109  2009031600001    AJRA  ADD NEW TRAILER TYPE AND REDEFINE DATA
  1910* 012010  2009061500002    AJRA  ADD FLAG FOR REFUND WITH OPEN CLAIM
  1911* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  1912* 061013  CR2012113000002  PEMA  SPP CLAIM RELATED CHANGES
  1913* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  1914* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  1915* 022715  CR2015010800003  PEMA  AGENT SIGNATURE
  1916******************************************************************
  1917                                                                  ELCCRTT
  1918 01  CERTIFICATE-TRAILERS.                                        ELCCRTT
  1919     12  CS-RECORD-ID                      PIC XX.                ELCCRTT
  1920         88  VALID-CS-ID                      VALUE 'CS'.         ELCCRTT
  1921                                                                  ELCCRTT
  1922     12  CS-CONTROL-PRIMARY.                                      ELCCRTT
  1923         16  CS-COMPANY-CD                 PIC X.                 ELCCRTT
  1924         16  CS-CARRIER                    PIC X.                 ELCCRTT
  1925         16  CS-GROUPING                   PIC X(6).              ELCCRTT
  1926         16  CS-STATE                      PIC XX.                ELCCRTT
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  39
* ECS010T1.cbl (/apps/prod/cid1p/copy/ELCCRTT)
  1927         16  CS-ACCOUNT                    PIC X(10).
  1928         16  CS-CERT-EFF-DT                PIC XX.                ELCCRTT
  1929         16  CS-CERT-NO.                                          ELCCRTT
  1930             20  CS-CERT-PRIME             PIC X(10).             ELCCRTT
  1931             20  CS-CERT-SFX               PIC X.                 ELCCRTT
  1932         16  CS-TRAILER-TYPE               PIC X.
  1933             88  COMM-TRLR           VALUE 'A'.
  1934             88  CLAIM-HISTORY-TRLR  VALUE 'B'.
  1935             88  CERT-DATA-TRLR      VALUE 'C'.
  1936                                                                  ELCCRTT
  1937     12  CS-DATA-AREA                      PIC X(516).
  1938
  1939     12  CS-BANK-COMMISSIONS REDEFINES CS-DATA-AREA.
  1940         16  CS-BANK-COMMISSION-AREA.
  1941             20  CS-BANK-COMMS       OCCURS 10.
  1942                 24  CS-AGT                PIC X(10).
  1943                 24  CS-COM-TYP            PIC X.
  1944                 24  CS-SPP-FEES           PIC S9(5)V99   COMP-3.
  1945                 24  CS-RECALC-LV-INDIC    PIC X.
  1946                 24  FILLER                PIC X(10).
  1947
  1948         16  FILLER                        PIC X(256).
  1949
  1950     12  CS-CLAIM-HISTORY-TRAILER REDEFINES CS-DATA-AREA.
  1951****  TO CALC NO OF BENEFITS PAID = (CS-DAYS-PAID / 30)
  1952
  1953         16  CS-MB-CLAIM-DATA OCCURS 24.
  1954             20  CS-CLAIM-NO               PIC X(7).
  1955             20  CS-CLAIM-TYPE             PIC X.
  1956                 88  CS-AH-CLM               VALUE 'A'.
  1957                 88  CS-IU-CLM               VALUE 'I'.
  1958                 88  CS-GP-CLM               VALUE 'G'.
  1959                 88  CS-LF-CLM               VALUE 'L'.
  1960                 88  CS-PR-CLM               VALUE 'P'.
  1961                 88  CS-FL-CLM               VALUE 'F'.
  1962             20  CS-INSURED-TYPE           PIC X.
  1963                 88  CS-PRIM-INSURED          VALUE 'P'.
  1964                 88  CS-CO-BORROWER           VALUE 'C'.
  1965             20  CS-BENEFIT-PERIOD         PIC 99.
  1966             20  CS-DAYS-PAID              PIC S9(5) COMP-3.
  1967             20  CS-TOTAL-PAID             PIC S9(7)V99 COMP-3.
  1968             20  CS-REMAINING-BENS         PIC S999 COMP-3.
  1969         16  FILLER                        PIC X(12).
  1970
  1971     12  CS-CERT-DATA REDEFINES CS-DATA-AREA.
  1972         16  CS-VIN-NUMBER                 PIC X(17).
  1973         16  CS-REFUND-CLAIM-FLAG          PIC X(01).
  1974         16  CS-INS-AGE-DEFAULT-FLAG       PIC X(01).
  1975         16  CS-JNT-AGE-DEFAULT-FLAG       PIC X(01).
  1976         16  cs-agent-name.
  1977             20  cs-agent-fname            pic x(20).
  1978             20  cs-agent-mi               pic x.
  1979             20  cs-agent-lname            pic x(25).
  1980         16  cs-license-no                 pic x(15).
  1981         16  cs-npn-number                 pic x(10).
  1982         16  cs-agent-edit-status          pic x.
  1983             88  cs-ae-refer-to-manager      value 'M'.
  1984             88  cs-ae-cover-sheet           value 'C'.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  40
* ECS010T1.cbl (/apps/prod/cid1p/copy/ELCCRTT)
  1985             88  cs-ae-sig-form              value 'S'.
  1986             88  cs-ae-verified              value 'V'.
  1987             88  cs-unidentified-signature   value 'U'.
  1988             88  cs-cert-returned            value 'R'.
  1989             88  cs-accept-no-commission     value 'N'.
  1990         16  FILLER                        PIC X(424).
  1991*        16  FILLER                        PIC X(496).
  1992
  1993 FD  ERAGTC.
  1994
* 1995                             COPY ERCAGTC.
  1996******************************************************************
  1997*                                                                *
  1998*                                                                *
  1999*                            ERCAGTC                             *
  2000*                            VMOD=2.001                          *
  2001*                                                                *
  2002*   ONLINE CREDIT SYSTEM                                         *
  2003*                                                                *
  2004*   FILE DESCRIPTION = AGENT COMMISSIONS                         *
  2005*                                                                *
  2006*   FILE TYPE = VSAM,KSDS                                        *
  2007*   RECORD SIZE = 450   RECFORM = FIXED                          *
  2008*                                                                *
  2009*   BASE CLUSTER NAME = ERAGTC                   RKP=2,LEN=21    *
  2010*       ALTERNATE PATH = NONE                                    *
  2011*                                                                *
  2012*   LOG = NO                                                     *
  2013*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2014*                                                                *
  2015******************************************************************
  2016*                   C H A N G E   L O G
  2017*
  2018* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2019*-----------------------------------------------------------------
  2020*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2021* EFFECTIVE    NUMBER
  2022*-----------------------------------------------------------------
  2023* 111004    2004110300005  PEMA  ADD DISTRIBUTION OF ADDENDUM FEE
  2024* 111004                         NEW FILE AND COPYBOOK
  2025* 092205                   PEMA  ADD PROCESSING FOR SPP LEASE
  2026******************************************************************
  2027
  2028 01  AGENT-COMMISSIONS.
  2029     12  AG-RECORD-ID                          PIC XX.
  2030         88  VALID-CO-ID                          VALUE 'AG'.
  2031
  2032     12  AG-CONTROL-PRIMARY.
  2033         16  AG-COMPANY-CD                     PIC X.
  2034         16  AG-CONTROL.
  2035             20  AG-CTL-1.
  2036                 24  AG-CARR-GROUP.
  2037                     28  AG-CARRIER            PIC X.
  2038                     28  AG-GROUPING           PIC X(6).
  2039                 24  AG-BANK                   PIC X(10).
  2040             20  AG-CTL-2.
  2041                 24  AG-EXP-DT                 PIC XX.
  2042         16  AG-TYPE                           PIC X.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  41
* ECS010T1.cbl (/apps/prod/cid1p/copy/ERCAGTC)
  2043             88  AG-GEN-AGENT-TYPE                VALUE 'G'.
  2044             88  AG-ACCOUNT-TYPE                  VALUE 'A'.
  2045
  2046     12  AG-MAINT-INFORMATION.
  2047         16  AG-LAST-MAINT-DT                  PIC XX.
  2048         16  AG-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  2049         16  AG-LAST-MAINT-USER                PIC X(4).
  2050         16  FILLER                            PIC X(10).
  2051
  2052     12  AG-EFF-DT                             PIC XX.
  2053     12  AG-COMM-STRUCTURE.
  2054         16  AG-AGT-COMMS OCCURS 10.
  2055             20  AG-AGT                PIC X(10).
  2056             20  AG-COM-TYP            PIC X.
  2057             20  AG-SPP-FEES           PIC S9(5)V99   COMP-3.
  2058             20  AG-RECALC-LV-INDIC    PIC X.
  2059             20  AG-SPP-LFEES          PIC S9(5)V99   COMP-3.
  2060             20  AG-LRCALC-LV-INDIC    PIC X.
  2061             20  FILLER                PIC X(05).
  2062
  2063     12  FILLER                  PIC X(145).
  2064******************************************************************
  2065
  2066 FD  ME-ECS010-BALANCE
  2067     RECORDING MODE IS F
  2068     BLOCK CONTAINS 0 RECORDS.
  2069 01  ME-ECS010-BALANCE-REC    PIC X(83).
  2070
  2071 FD  ME50-ECS010-BALANCE
  2072     RECORDING MODE IS F
  2073     BLOCK CONTAINS 0 RECORDS.
  2074 01  ME50-ECS010-BALANCE-REC  PIC X(95).
  2075
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  42
* ECS010T1.cbl
  2077 FD  DISK-DATE
* 2078                             COPY ELCDTEFD.
  2079******************************************************************04/15/98
  2080*                                                                *ELCDTEFD
  2081*                                                                *ELCDTEFD
  2082*                            ELCDTEFD.                           *   LV002
  2083*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  2084*                            VMOD=2.007                          *   CL**2
  2085*                                                                *ELCDTEFD
  2086******************************************************************ELCDTEFD
  2087     BLOCK CONTAINS 0 RECORDS
  2088     RECORDING MODE F.                                            ELCDTEFD
  2089                                                                  ELCDTEFD
  2090 01  DATE-DISK.                                                   ELCDTEFD
  2091     12  DD-ID                       PIC  X(4).                   ELCDTEFD
  2092     12  FILLER                      PIC  X(14).                  ELCDTEFD
  2093     12  DD-CR1                      PIC  9.                      ELCDTEFD
  2094     12  DD-CR1N                     PIC  X(30).                  ELCDTEFD
  2095     12  DD-CR2                      PIC  9.                      ELCDTEFD
  2096     12  DD-CR2N                     PIC  X(30).                  ELCDTEFD
  2097     12  FILLER                      PIC  X(20).                  ELCDTEFD
  2098                                                                  ELCDTEFD
  2099 01  DATE-DISK-R.                                                 ELCDTEFD
  2100     12  FILLER                      PIC  X(4).                   ELCDTEFD
  2101     12  DD-ST           OCCURS 3 TIMES                           ELCDTEFD
  2102                                     PIC  X(32).                  ELCDTEFD
  2103                                                                  ELCDTEFD
  2104 01  DATE-DISK-T.                                                 ELCDTEFD
  2105     12  FILLER                      PIC  X(4).                   ELCDTEFD
  2106     12  DD-TYPE         OCCURS 2 TIMES                           ELCDTEFD
  2107                                     PIC  X(48).                  ELCDTEFD
  2108                                                                  ELCDTEFD
  2109 01  DATE-DISK-M.                                                 ELCDTEFD
  2110     12  FILLER                      PIC  X(4).                   ELCDTEFD
  2111     12  DD-MORT         OCCURS 2 TIMES                           ELCDTEFD
  2112                                     PIC  X(48).                  ELCDTEFD
  2113                                                                  ELCDTEFD
  2114 01  DATE-DISK-P.                                                 ELCDTEFD
  2115     12  DD-IDA                      PIC  XX.                     ELCDTEFD
  2116     12  DD-IDX                      PIC  99.                     ELCDTEFD
  2117     12  DD-DATA                     PIC  X(96).                  ELCDTEFD
  2118     12  FILLER  REDEFINES DD-DATA.                               ELCDTEFD
  2119         16  DD-PS-PIC   OCCURS 50 TIMES                          ELCDTEFD
  2120                                     PIC  X.                      ELCDTEFD
  2121         16  FILLER                  PIC  X(46).                  ELCDTEFD
  2122     12  FILLER  REDEFINES DD-DATA.                               ELCDTEFD
  2123         16  DD-PS-PICO  OCCURS 20 TIMES.                         ELCDTEFD
  2124             20  DD-PS-PRT           PIC  X.                      ELCDTEFD
  2125             20  DD-PS-FMT           PIC  X.                      ELCDTEFD
  2126             20  DD-PS-PRC           PIC  X.                      ELCDTEFD
  2127             20  DD-PS-TOT           PIC  X.                      ELCDTEFD
  2128         16  FILLER                  PIC  X(16).                  ELCDTEFD
  2129                                                                  ELCDTEFD
  2130 01  DATE-DISK-E.                                                 ELCDTEFD
  2131     12  FILLER                      PIC  X(4).                   ELCDTEFD
  2132     12  DD-EDIT         OCCURS 24 TIMES                          ELCDTEFD
  2133                                     PIC  X(4).                   ELCDTEFD
  2134                                                                  ELCDTEFD
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  43
* ECS010T1.cbl (/apps/prod/cid1p/copy/ELCDTEFD)
  2135 01  DATE-DISK-C.                                                 ELCDTEFD
  2136     12  FILLER                      PIC  X(7).                   ELCDTEFD
  2137     12  DD-CARR1-SECPAY-SW          PIC  X.
  2138     12  DD-CARR1-UEP-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
  2139     12  DD-CARR1-R78-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
  2140     12  DD-CARR1-PRO-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
  2141     12  DD-CARR1                    PIC  X.                      ELCDTEFD
  2142     12  DD-CARR1S                   PIC  XX.                     ELCDTEFD
  2143     12  DD-CARR1N                   PIC  X(30).                  ELCDTEFD
  2144     12  DD-CARR2                    PIC  X.                      ELCDTEFD
  2145     12  DD-CARR2S                   PIC  XX.                     ELCDTEFD
  2146     12  DD-CARR2N                   PIC  X(30).                  ELCDTEFD
  2147     12  DD-CARR2-UEP-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
  2148     12  DD-CARR2-R78-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
  2149     12  DD-CARR2-PRO-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
  2150     12  DD-CARR2-SECPAY-SW          PIC  X.
  2151     12  FILLER                      PIC  X(7).                   ELCDTEFD
  2152                                                                  ELCDTEFD
  2153 01  DATE-DISK-OPT.                                               ELCDTEFD
  2154     12  FILLER                      PIC  X(04).                  ELCDTEFD
  2155     12  DD-TLR-DATA.                                             ELCDTEFD
  2156         16  DD-TLR                  OCCURS 32 TIMES              ELCDTEFD
  2157                                     PIC  X(03).                  ELCDTEFD
  2158     12  DD-STATE-DATA REDEFINES DD-TLR-DATA.                     ELCDTEFD
  2159         16  DD-STATE-FLDS           OCCURS 16 TIMES              ELCDTEFD
  2160                                     PIC  X(06).                  ELCDTEFD
  2161     12  DD-CARR-DATA REDEFINES DD-TLR-DATA.                      ELCDTEFD
  2162         16  DD-CARR-FLDS            OCCURS 13 TIMES              ELCDTEFD
  2163                                     PIC  X(07).                  ELCDTEFD
  2164         16  FILLER                  PIC  X(05).                  ELCDTEFD
  2165     12  DD-MISC-DATA REDEFINES DD-TLR-DATA                       ELCDTEFD
  2166                                     PIC  X(96).                  ELCDTEFD
  2167******************************************************************ELCDTEFD
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  44
* ECS010T1.cbl
  2169 FD  PRINT-COPY
* 2170                             COPY ELCPRTFD.
  2171******************************************************************04/15/98
  2172*                                                                *ELCPRTFD
  2173*                                                                *ELCPRTFD
  2174*                            ELCPRTFD.                           *   LV003
  2175*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
  2176*                            VMOD=2.006                          *ELCPRTFD
  2177******************************************************************ELCPRTFD
  2178     RECORDING MODE F                                             ELCPRTFD
  2179     LABEL RECORDS OMITTED                                        ELCPRTFD
  2180     BLOCK CONTAINS 0 RECORDS
  2181     RECORD CONTAINS 133 CHARACTERS.                              ELCPRTFD
  2182 01  PRT.                                                         ELCPRTFD
  2183     12  P-CTL               PIC  X.                                 CL**2
  2184     12  P-DATA              PIC  X(132).                         ELCPRTFD
  2185******************************************************************ELCPRTFD
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  45
* ECS010T1.cbl
  2187 FD  MISMATCH-REPORT
  2188     RECORDING MODE F.
  2189
  2190 01  MISMATCH-RPT.
  2191     12  MR-CTL              PIC X.
  2192     12  MR-DATA             PIC X(132).
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  46
* ECS010T1.cbl
  2194 FD  FICH
* 2195                             COPY ELCFCHFD.
  2196******************************************************************04/15/98
  2197*                                                                *ELCFCHFD
  2198*                            ELCFCHFD.                           *   LV003
  2199*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  2200*                            VMOD=2.004                          *   CL**3
  2201*                                                                *ELCFCHFD
  2202******************************************************************ELCFCHFD
  2203     BLOCK CONTAINS 0 RECORDS
  2204     RECORDING MODE F.                                            ELCFCHFD
  2205                                                                  ELCFCHFD
  2206 01  FICH-REC                            PIC   X(133).            ELCFCHFD
  2207******************************************************************ELCFCHFD
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  47
* ECS010T1.cbl
  2209 FD  DISPLAY-PRT
  2210     RECORDING MODE IS F
  2211     LABEL RECORDS ARE STANDARD
  2212     BLOCK CONTAINS 0 RECORDS
  2213     RECORD CONTAINS 133 CHARACTERS.
  2214
  2215 01  DISPLAY-REC.
  2216     05  DISPLAY-CC           PIC X.
  2217     05  DISPLAY-INFO         PIC X(132).
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  48
* ECS010T1.cbl
  2219 WORKING-STORAGE SECTION.
  2220 77  LCP-ASA                       PIC X.
  2221 77  FILLER  PIC X(32)  VALUE '********************************'.
  2222 77  FILLER  PIC X(32)  VALUE '*     ECS010 WORKING-STORAGE    '.
  2223 77  FILLER  PIC X(32)  VALUE '******** VMOD=2.082 ************'.
  2224
  2225 77  WS-DISP-AMT             PIC Z,ZZZ,ZZZ.99    VALUE ZEROS.
  2226 77  ERROR-COUNT             PIC 9(7)            VALUE ZEROS.
  2227 77  DIS-LINE-CNT            PIC 99              VALUE ZEROS.
  2228 77  PGM-SUB                 PIC S999    COMP    VALUE +010.
  2229 77  FIRST-ACCOUNT           PIC S9      COMP-3  VALUE +1.
  2230 77  FIRST-CERT              PIC S9      COMP-3  VALUE +1.
  2231 77  TR-CNT                  PIC S9(5)   COMP-3  VALUE +0.
  2232 77  CMIN-CNT                PIC S9(7)   COMP-3  VALUE +0.
  2233 77  CMOT-CNT                PIC S9(7)   COMP-3  VALUE +0.
  2234 77  DE-CNT                  PIC S9(7)   COMP-3  VALUE +0.
  2235 77  EP-CNT                  PIC S9(7)   COMP-3  VALUE +0.
  2236 77  LN-CNT                  PIC S999    COMP-3  VALUE +61.
  2237 77  PG-CNT                  PIC S9(5)   COMP-3  VALUE +0.
  2238 77  DUP-CNT                 PIC S9(5)   COMP-3  VALUE +0.
  2239 77  DISABILITY-TBL-MAX      PIC S9              VALUE +5.
  2240 77  DUP-MAX                 PIC S9(5)   COMP-3  VALUE +500.
  2241 77  RANGE-CNT               PIC S999    COMP-3  VALUE +0.
  2242 77  ERACCTT-READS           PIC S9(7)   COMP-3  VALUE +0.
  2243 77  ERAGTC-READS            PIC S9(7)   COMP-3  VALUE +0.
  2244 77  ELCRTT-READS            PIC S9(7)   COMP-3  VALUE +0.
  2245 77  ERRTBL-READS            PIC S9(7)   COMP-3  VALUE +0.
  2246 77  ERCTBL-READS            PIC S9(7)   COMP-3  VALUE +0.
  2247 77  FLA-CLM-REIN-BASE       PIC S9(9)V99 COMP-3.
  2248 77  WK-RATE                 PIC S99V9(5) COMP-3 VALUE +0.
  2249 77  COMM-CK-AMT             PIC S9(9)V99 COMP-3 VALUE +0.
  2250 77  ADJ-FLA-REIN-BASE       PIC S9(9)V9(4) COMP-3.
  2251 77  ISS-WK                  PIC S9(9)V99 COMP-3 VALUE +0.
  2252 77  CNC-WK                  PIC S9(9)V99 COMP-3 VALUE +0.
  2253 77  CNC-FACT                PIC S9(3)V9(7) COMP-3 VALUE +0.
  2254 77  COMM-WK                 PIC S9(9)V99 COMP-3 VALUE +0.
  2255 77  X                       PIC X.
  2256 77  DD-FLG                  PIC X               VALUE SPACE.
  2257 77  AGT-SW                  PIC X               VALUE SPACE.
  2258 77  RC-COMM-FLG             PIC X               VALUE SPACE.
  2259 77  RECALC-TYPE             PIC X               VALUE SPACE.
  2260 77  LIFE-REFUND             PIC S9(7)V99        COMP-3.
  2261 77  LIFE-REFUND-CALC        PIC S9(7)V99        COMP-3.
  2262 77  A-H-REFUND              PIC S9(7)V99        COMP-3.
  2263 77  A-H-REFUND-CALC         PIC S9(7)V99        COMP-3.
  2264 77  YTD-CANCEL-CNT          PIC S9(3)           COMP-3.
  2265 77  MISMATCH-COUNT          PIC S9(5)           VALUE +0.
  2266 77  MISMATCH-LINE-COUNT     PIC S9(5)           VALUE +99.
  2267 77  MISMATCH-PAGE-NUMBER    PIC S9(5)           VALUE +0.
  2268 77  SV-HI-CERT              PIC 9(11)           VALUE ZEROS.
  2269 77  SV-LO-CERT              PIC 9(11)           VALUE ZEROS.
  2270 77  LST-TRD-CERT            PIC X(11)           VALUE SPACES.
  2271 77  SV-TRD-CERT             PIC X(11).
  2272 77  LST-TRD-ISDT            PIC X(10)           VALUE SPACES.
  2273 77  SV-TRD-ISDT             PIC X(10).
  2274 77  SAVE-EXTRACT            PIC X(510)          VALUE SPACES.
  2275*77  W-TLR                   PIC S9(01)V9(04) COMP-3 VALUE +.40.
  2276*77  W-AH-FACTOR             PIC S9(01)V9(04) COMP-3 VALUE +.50.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  49
* ECS010T1.cbl
  2277 77  W-EPEC-EP               PIC S9(11)V9(02) COMP-3 VALUE +0.
  2278 77  W-EPEC-EP-IN            PIC S9(11)V9(02) COMP-3 VALUE +0.
  2279 77  W-EPEC-EP-1             PIC S9(11)V9(02) COMP-3 VALUE +0.
  2280 77  W-EPEC-EP-2             PIC S9(11)V9(02) COMP-3 VALUE +0.
  2281 77  W-P-EP                  PIC S9(11)V9(02) COMP-3 VALUE +0.
  2282 77  W-M-EP                  PIC S9(11)V9(02) COMP-3 VALUE +0.
  2283 77  W-R-EP                  PIC S9(11)V9(02) COMP-3 VALUE +0.
  2284 77  W-WY-EP                 PIC S9(11)V9(02) COMP-3 VALUE +0.
  2285 77  W-VA-EP                 PIC S9(11)V9(02) COMP-3 VALUE +0.
  2286 77  W-1-EP                  PIC S9(11)V9(02) COMP-3 VALUE +0.
  2287 77  W-OTHERS-COUNT          PIC S9(11)       COMP-3 VALUE +0.
  2288 77  W-AH-CLAIM-EP           PIC S9(11)V9(02) COMP-3 VALUE +0.
  2289 77  W-AH-CLAIM-CTR          PIC S9(11)       COMP-3 VALUE +0.
  2290 77  W-EP-LESS-THAN-0        PIC S9(11)       COMP-3 VALUE +0.
  2291 77  W-CLAIMS-MADE-PAID-IN   PIC S9(11)V9(02) COMP-3 VALUE +0.
  2292 77  W-CLAIMS-MADE-PAID      PIC S9(11)V9(02) COMP-3 VALUE +0.
  2293 77  W-AH-IBNR               PIC S9(11)V9(02) COMP-3 VALUE +0.
  2294 77  W-AH-IBNR-1             PIC S9(11)V9(02) COMP-3 VALUE +0.
  2295 77  W-AH-IBNR-1-CNT         PIC S9(11)       COMP-3 VALUE +0.
  2296 77  W-AH-IBNR-2             PIC S9(11)V9(02) COMP-3 VALUE +0.
  2297 77  W-AH-IBNR-2-CNT         PIC S9(11)       COMP-3 VALUE +0.
  2298 77  W-LIFE-IBNR             PIC S9(11)V9(02) COMP-3 VALUE +0.
  2299 77  W-LIFE-IBNR-IN          PIC S9(11)V9(02) COMP-3 VALUE +0.
  2300 77  W-LIFE-REMAINING-AMT    PIC S9(11)V9(02) COMP-3 VALUE +0.
  2301 77  W-RTRM-0-CLMAMT         PIC S9(11)V9(02) COMP-3 VALUE +0.
  2302 77  W-CLM-EXCEPT-CNT        PIC S9(11)       COMP-3 VALUE +0.
  2303 77  W-CLM-EXCEPT-AMT        PIC S9(11)V9(02) COMP-3 VALUE +0.
  2304 77  W-RTRM-0-CNT            PIC S9(11)       COMP-3 VALUE +0.
  2305 77  W-RTRM-EP-1             PIC S9(11)V9(02) COMP-3 VALUE +0.
  2306 77  W-RTRM-EP-2             PIC S9(11)V9(02) COMP-3 VALUE +0.
  2307 77  W-RTRM-EP               PIC S9(11)V9(02) COMP-3 VALUE +0.
  2308 77  W-01-REMAMT             PIC S9(11)V9(02) COMP-3 VALUE +0.
  2309 77  W-01-DATA-USED          PIC S9(11)       COMP-3 VALUE +0.
  2310 77  W-02-REMAMT             PIC S9(11)V9(02) COMP-3 VALUE +0.
  2311 77  W-02-DATA-USED          PIC S9(11)       COMP-3 VALUE +0.
  2312 77  W-03-REMAMT             PIC S9(11)V9(02) COMP-3 VALUE +0.
  2313 77  W-03-DATA-USED          PIC S9(11)       COMP-3 VALUE +0.
  2314 77  W-04-REMAMT             PIC S9(11)V9(02) COMP-3 VALUE +0.
  2315 77  W-04-DATA-USED          PIC S9(11)       COMP-3 VALUE +0.
  2316 77  W-05-REMAMT             PIC S9(11)V9(02) COMP-3 VALUE +0.
  2317 77  W-05-DATA-USED          PIC S9(11)       COMP-3 VALUE +0.
  2318 77  W-06-REMAMT             PIC S9(11)V9(02) COMP-3 VALUE +0.
  2319 77  W-06-DATA-USED          PIC S9(11)       COMP-3 VALUE +0.
  2320 77  W-30-REMAMT             PIC S9(11)V9(02) COMP-3 VALUE +0.
  2321 77  W-30-DATA-USED          PIC S9(11)       COMP-3 VALUE +0.
  2322 77  W-31-REMAMT             PIC S9(11)V9(02) COMP-3 VALUE +0.
  2323 77  W-31-DATA-USED          PIC S9(11)       COMP-3 VALUE +0.
  2324 77  W-XX-REMAMT             PIC S9(11)V9(02) COMP-3 VALUE +0.
  2325 77  WS-TOT-PRM-AMT          PIC S9(11)V9(02) COMP-3 VALUE +0.
  2326 77  W-XX-DATA-USED          PIC S9(11)       COMP-3 VALUE +0.
  2327 77  W-MM-LF-PRM             PIC S9(7)V99     COMP-3 VALUE +0.
  2328 77  W-MM-AH-PRM             PIC S9(7)V99     COMP-3 VALUE +0.
  2329 77  W-MM-LF-RFD             PIC S9(7)V99     COMP-3 VALUE +0.
  2330 77  W-MM-AH-RFD             PIC S9(7)V99     COMP-3 VALUE +0.
  2331 77  W-MM-LF-CLM             PIC S9(7)V99     COMP-3 VALUE +0.
  2332 77  W-MM-AH-CLM             PIC S9(7)V99     COMP-3 VALUE +0.
  2333 77  WS-CEDE-FACT            PIC S9V9(4)      COMP-3 VALUE +0.
  2334 77  WS-SAVE-CARR            PIC X                   VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  50
* ECS010T1.cbl
  2335 77  WS-LOOP-MAX             PIC S99          COMP-3 VALUE +10.
  2336 77  WS-CR-PMT-FREQ          PIC 99           VALUE ZEROS.
  2337 77  WS-WE-LFPRM             PIC S9(7)V99    COMP-3 VALUE +0.
  2338 77  WS-FIRST-K              PIC X                  VALUE ' '.
  2339 77  WS-DLR-INC-CHG-BACK     PIC X                  VALUE ' '.
  2340 77  TOT-AH-IBNR             PIC S9(11)V99 COMP-3 VALUE +0.
  2341 77  TOT-AH-PRM              PIC S9(11)V99 COMP-3 VALUE +0.
  2342 77  TOT-AH-PD-CLMS          PIC S9(11)V99 COMP-3 VALUE +0.
  2343 77  TOT-AH-CLMRSV           PIC S9(11)V99 COMP-3 VALUE +0.
  2344 77  TOT-LF-IBNR             PIC S9(11)V99 COMP-3 VALUE +0.
  2345 77  TOT-LF-PRM              PIC S9(11)V99 COMP-3 VALUE +0.
  2346 77  TOT-LF-PD-CLMS          PIC S9(11)V99 COMP-3 VALUE +0.
  2347 77  TOT-LF-CLMRSV           PIC S9(11)V99 COMP-3 VALUE +0.
  2348 77  RTOT-AH-IBNR            PIC S9(11)V99 COMP-3 VALUE +0.
  2349 77  RTOT-AH-PRM             PIC S9(11)V99 COMP-3 VALUE +0.
  2350 77  RTOT-AH-PD-CLMS         PIC S9(11)V99 COMP-3 VALUE +0.
  2351 77  RTOT-AH-CLMRSV          PIC S9(11)V99 COMP-3 VALUE +0.
  2352 77  RTOT-LF-IBNR            PIC S9(11)V99 COMP-3 VALUE +0.
  2353 77  RTOT-LF-PRM             PIC S9(11)V99 COMP-3 VALUE +0.
  2354 77  RTOT-LF-PD-CLMS         PIC S9(11)V99 COMP-3 VALUE +0.
  2355 77  RTOT-LF-CLMRSV          PIC S9(11)V99 COMP-3 VALUE +0.
  2356 77  IBNR-FACT               PIC S9(3)V9(7) COMP-3 VALUE +0.
  2357
  2358 01  MONTH-END-DATA.
  2359     12  ME-START-DATE.
  2360         16  ME-START-MO         PIC 99.
  2361         16  FILLER              PIC X.
  2362         16  ME-START-DA         PIC 99.
  2363         16  FILLER              PIC X.
  2364         16  ME-START-YR         PIC 99.
  2365     12  ME-CNDS-DATE            PIC 9(6).
  2366     12  ME-CNDS-DATE-R REDEFINES ME-CNDS-DATE.
  2367         16  ME-CNDS-MO          PIC 99.
  2368         16  ME-CNDS-DA          PIC 99.
  2369         16  ME-CNDS-YR          PIC 99.
  2370     12  ME-START-TIME           PIC 9(6).
  2371     12  ME-UPDATE-FLAG          PIC X VALUE 'Y'.
  2372         88  ME-DO-UPDATE        VALUE 'Y'.
  2373         88  ME-NO-UPDATE        VALUE 'N'.
  2374     12  MONTH-END-MOYR          PIC S9(5) COMP-3.
  2375
  2376 01  WS-BALANCE-DESCRIPTION1       PIC X(50)  VALUE
  2377     'Life Claims Paid'.
  2378
  2379 01  WS-BALANCE-DESCRIPTION2       PIC X(50)  VALUE
  2380     'A&H Claims Paid'.
  2381
  2382 01  WS-BALANCE-DESCRIPTION3       PIC X(50)  VALUE
  2383     'Output Certificate Master Records Prior Month'.
  2384
  2385 01  WS-BAL50-DESCRIPTION          PIC X(50)  VALUE
  2386     'ECS010 Out Recs should match EL331 Offline Certs  '.
  2387
  2388 01  WS-ME-BALANCE-REC.
  2389     12  WS-ME-BAL-JOB           PIC X(11)  VALUE SPACES.
  2390     12  WS-ME-BAL-DELIM1        PIC X(01)  VALUE ';'.
  2391     12  WS-ME-BAL-STEP          PIC X(08)  VALUE 'ECS010  '.
  2392     12  WS-ME-BAL-DELIM2        PIC X(01)  VALUE ';'.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  51
* ECS010T1.cbl
  2393     12  WS-ME-BAL-AMT           PIC ZZZ,ZZZ,ZZ9.
  2394     12  WS-ME-BAL-DELIM3        PIC X(01)  VALUE ';'.
  2395     12  WS-ME-BAL-DESCRIP       PIC X(50)  VALUE SPACES.
  2396
  2397 01  WS-ME50-BALANCE-REC.
  2398     12  WS-ME50-BAL-JOB           PIC X(11)  VALUE SPACES.
  2399     12  WS-ME50-BAL-DELIM1        PIC X(01)  VALUE ';'.
  2400     12  WS-ME50-BAL-STEP          PIC X(08)  VALUE 'ECS010  '.
  2401     12  WS-ME50-BAL-DELIM2        PIC X(01)  VALUE ';'.
  2402     12  WS-ME50-BAL-AMT-LOW       PIC ZZZ,ZZZ,ZZ9.
  2403     12  WS-ME50-BAL-DELIM3        PIC X(01)  VALUE ';'.
  2404     12  WS-ME50-BAL-AMT-HIGH      PIC ZZZ,ZZZ,ZZ9.
  2405     12  WS-ME50-BAL-DELIM4        PIC X(01)  VALUE ';'.
  2406     12  WS-ME50-BAL-DESCRIP       PIC X(50)  VALUE SPACES.
  2407
  2408 01  WS-PREV-BANK-COMM-KEY       PIC X(21)  VALUE LOW-VALUES.
  2409 01  WS-BANK-INIT                PIC X(260) VALUE SPACES.
  2410 01  WS-BANK-COMMISSIONS.
  2411     12  WS-BANK-COMMS           OCCURS 10.
  2412         16  WS-BNK-AGT          PIC X(10).
  2413         16  WS-BNK-TYPE         PIC X.
  2414         16  WS-BNK-SPP-FEES     PIC S9(5)V99  COMP-3.
  2415         16  WS-BNK-RECALC       PIC X.
  2416         16  FILLER              PIC X(10).
  2417
  2418 01  PENDING-MATCH-CONTROL.
  2419     12  PENDING-ACCOUNT-CONTROL.
  2420         16  PEND-MATCH-CARRIER    PIC X.
  2421         16  PEND-MATCH-GROUPING   PIC X(6).
  2422         16  PEND-MATCH-STATE      PIC XX.
  2423         16  PEND-MATCH-ACCOUNT    PIC X(10).
  2424     12  PEND-MATCH-EFF-DTE        PIC 9(11) COMP-3.
  2425     12  PEND-MATCH-CERT-NO.
  2426         16  PEND-MATCH-CERT       PIC X(10).
  2427         16  PEND-MATCH-CERT-SFX   PIC X.
  2428 01  PENDING-RECORD-TYPE           PIC X.
  2429     88  ISSUE-TRANSACTION            VALUE '1'.
  2430     88  CANCEL-TRANSACTION           VALUE '2'.
  2431     88  CLAIM-TRANSACTION            VALUE '3'.
  2432     88  RESERVE-TRANSACTION          VALUE '4'.
  2433     88  UPDATE-TRANSACTION           VALUE '5'.
  2434
  2435 01  CLM-INCUR-REIN-DATE.
  2436     12  CIRD-CCYY.
  2437         16  CIRD-CC         PIC 99.
  2438         16  CIRD-YR         PIC 99.
  2439     12  CIRD-MO             PIC 99.
  2440
  2441 01  HIGH-CERT               PIC 9(11)           VALUE ZEROS.
  2442
  2443 01  LOW-CERT                PIC 9(11)           VALUE ZEROS.
  2444
  2445 01  REIN-BILLING-TABLE.
  2446     12  REIN-CO-ENTRIES OCCURS 50 TIMES.
  2447         16  RB-COMPANY      PIC X(6).
  2448         16  RB-COUNT        PIC S9(5)   COMP-3.
  2449
  2450 01  B-SUB                   PIC S9(4)   COMP.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  52
* ECS010T1.cbl
  2451
  2452 01  BINARY-COUNTERS     COMP      SYNC.
  2453     12  IA                  PIC S999            VALUE +0.
  2454     12  IB                  PIC S999            VALUE +0.
  2455     12  SUB                 PIC S999            VALUE +0.
  2456     12  SUBM                PIC S999            VALUE +0.
  2457     12  SUB3                PIC S999            VALUE +0.
  2458     12  SUB4                PIC S999            VALUE +0.
  2459     12  SUB5                PIC S999            VALUE +0.
  2460     12  SUB6                PIC S999            VALUE +0.
  2461     12  SUB7                PIC S999            VALUE +0.
  2462     12  SUB8                PIC S999            VALUE +0.
  2463     12  SUB9                PIC S999            VALUE +0.
  2464     12  SUB10               PIC S999            VALUE +0.
  2465     12  SUB11               PIC S999            VALUE +0.
  2466     12  SUB12               PIC S999            VALUE +0.
  2467     12  SUB13               PIC S999            VALUE +0.
  2468     12  SUB14               PIC S999            VALUE +0.
  2469     12  SUB15               PIC S999            VALUE +0.
  2470     12  SUB16               PIC S999            VALUE +0.
  2471     12  LEVELS-BUILT        PIC S999            VALUE +0.
  2472 01  WS-SEQ-NBR              PIC 9               VALUE ZERO.
  2473
  2474 01  WS.
  2475     12  WS-RETURN-CODE        PIC S9(4)   COMP   VALUE +0.
  2476     12  WS-ABEND-MESSAGE      PIC X(80)          VALUE SPACES.
  2477     12  WS-ABEND-FILE-STATUS  PIC XX             VALUE ZEROS.
  2478     12  WS-ZERO               PIC S9      COMP-3 VALUE +0.
  2479
  2480     12  WS-ABEND-CODE         PIC 9(4).
  2481     12  ABEND-CODE  REDEFINES  WS-ABEND-CODE.
  2482         16  ABEND-CODE-1    PIC XX.
  2483         16  ABEND-CODE-2.
  2484             20  AC2-ONE     PIC X.
  2485             20  AC2-TWO     PIC X.
  2486
  2487     12  CTBL-SEARCH.
  2488         16  CTBL-COMP-CD    PIC X.
  2489         16  CTBL-TABLE-CD   PIC XXX.
  2490         16  CTBL-BEN-TYPE   PIC X.
  2491         16  CTBL-BEN-CODE   PIC XX.
  2492     12  LAST-CTBL           PIC X(7)            VALUE SPACES.
  2493     12  COMM-OPEN-SW        PIC X               VALUE SPACES.
  2494     12  WS-COMM-TERM        PIC S999            COMP-3.
  2495     12  CTBL-ERROR-SWITCH   PIC X               VALUE SPACE.
  2496         88  CTBL-ERROR         VALUE '*'.
  2497
  2498     12  REIN-SPEC.
  2499         16  REIN-SPEC-A     PIC X.
  2500         16  REIN-SPEC-B     PIC X.
  2501         16  REIN-SPEC-C     PIC X.
  2502
  2503     12  WS-CHECK-NUMBER.
  2504         16  WS-CHECK-NO     PIC X(4).
  2505         16  FILLER          PIC XXX.
  2506
  2507     12  AH-EARN-METHOD      PIC X               VALUE SPACES.
  2508         88  AH-EARN-ANTICIPATION                VALUE 'A' 'C'.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  53
* ECS010T1.cbl
  2509         88  AH-EARN-NET                         VALUE 'N'.
  2510
  2511 01  ERACCTT-FILE-STATUS     PIC XX VALUE ZEROS.
  2512 01  ERCTBL-FILE-STATUS      PIC XX VALUE ZEROS.
  2513 01  ERMEBL-FILE-STATUS      PIC XX VALUE ZEROS.
  2514 01  ERRTBL-FILE-STATUS      PIC XX VALUE ZEROS.
  2515 01  ERRESC-FILE-STATUS      PIC XX VALUE ZEROS.
  2516 01  ERAGTC-FILE-STATUS      PIC XX VALUE ZEROS.
  2517 01  ELCRTT-FILE-STATUS      PIC XX VALUE ZEROS.
  2518
  2519 01  MONTHS-DIFF-LF          PIC S9(05) VALUE +0.
  2520 01  MONTHS-DIFF-AH          PIC S9(05) VALUE +0.
  2521 01  WS-CR-BIN-DATE          PIC XX VALUE LOW-VALUES.
  2522 01  WS-BIN-CANCEL-DATE      PIC XX VALUE LOW-VALUES.
  2523
  2524 01  WS-LEVELS-CHARGEBACK-SWITCHES.
  2525     12  WS-LF-CHARGEBACK-LEVELS.
  2526         16  WS-LF-CHARGEBACK-SW   PIC X(01) OCCURS 10 TIMES.
  2527     12  WS-AH-CHARGEBACK-LEVELS.
  2528         16  WS-AH-CHARGEBACK-SW   PIC X(01) OCCURS 10 TIMES.
  2529*****************************************************************
  2530*        WORKING STORAGE AREA FOR CLIENT-DMD               START*
  2531*****************************************************************
  2532*RESIDENT STATE TAXES MASTER(ERRESC)
  2533*
  2534 01  WORK-AREAS.
  2535     12  WS-ERRESC-KEY.
  2536         16 WS-ERRESC-SEARCH-KEY.
  2537             20  WS-ERRESC-COMPANY-CD PIC  X.
  2538             20  WS-ERRESC-CARRIER    PIC  X.
  2539             20  WS-ERRESC-GROUP      PIC X(6).
  2540             20  WS-ERRESC-STATE      PIC XX.
  2541             20  WS-ERRESC-ACCOUNT    PIC X(10).
  2542         16 WS-ERRESC-RESIDUAL-KEY.
  2543             20  WS-ERRESC-AGENT      PIC X(10).
  2544             20  WS-ERRESC-RES-STATE  PIC XX.
  2545             20  WS-ERRESC-EXPIRE-DT  PIC 9(8) COMP-3.
  2546*                                          YYYYMMDD
  2547     12  WS-YYYYMMDD-DT               PIC 9(8).
  2548     12  WS-COMMISSION                PIC SV9(5) COMP-3.
  2549     12  WS-SUB                       PIC    99  COMP-3.
  2550     12  WS-SUB1                      PIC    99  COMP-3.
  2551*****************************************************************
  2552*        WORKING STORAGE AREA FOR CLIENT-DMD                 END*
  2553*****************************************************************
  2554
  2555 01  COMM-WORK-AREAS.
  2556     12  FILLER              PIC  X(17)
  2557         VALUE 'COMMON WORK AREAS'.
  2558     12  ACCT-COMM-LF        PIC SV9(5)  COMP-3.
  2559     12  ACCT-COMM-AH        PIC SV9(5)  COMP-3.
  2560     12  W-AH-ACTIVE         PIC S9(13)  COMP-3 VALUE ZEROS.
  2561     12  W-AH-CALC-B         PIC S9(13)  COMP-3 VALUE ZEROS.
  2562     12  W-AH-CLAIMS         PIC S9(13)  COMP-3 VALUE ZEROS.
  2563     12  W-AH-DATA-USED      PIC S9(13)  COMP-3 VALUE ZEROS.
  2564     12  W-AH-INACTIVE       PIC S9(13)  COMP-3 VALUE ZEROS.
  2565     12  W-AH-ISSUES         PIC S9(13)  COMP-3 VALUE ZEROS.
  2566     12  W-AH-REIN           PIC S9(13)  COMP-3 VALUE ZEROS.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  54
* ECS010T1.cbl
  2567     12  W-AH-REISSUE        PIC S9(13)  COMP-3 VALUE ZEROS.
  2568     12  W-AH-REMTERM-0      PIC S9(13)  COMP-3 VALUE ZEROS.
  2569     12  W-AH-RESERVES       PIC S9(13)  COMP-3 VALUE ZEROS.
  2570     12  W-AH-RESV           PIC S9(13)  COMP-3 VALUE ZEROS.
  2571     12  W-AHTYP-99          PIC S9(13)  COMP-3 VALUE ZEROS.
  2572     12  W-BAL-REMTRM        PIC S9(05)V99  COMP-3.
  2573     12  W-CERT-COUNT        PIC S9(08)  COMP.
  2574     12  W-COUNT             PIC S9(08)  COMP   VALUE +0.
  2575     12  W-CLMAMT            PIC S9(07)V9(02)   VALUE ZEROS.
  2576     12  W-90-DAY-MAX        PIC S9(07)V9(02)   VALUE ZEROS.
  2577
  2578     12  W-EARNED-PREMIUM    PIC S9(07)V9(02)
  2579                                         COMP-3 VALUE ZEROS.
  2580     12  W-EARNED-PREMIUM-1  PIC S9(07)V9(02)
  2581                                         COMP-3 VALUE ZEROS.
  2582     12  W-EARNED-PREMIUM-2  PIC S9(07)V9(02)
  2583                                         COMP-3 VALUE ZEROS.
  2584     12  W-EDIT-FIELD        PIC ----------9.
  2585     12  W-EDIT-FIELD2       PIC ----------9.99.
  2586     12  W-EDIT-7            PIC Z(06)9.
  2587     12  W-FACTOR            PIC S9(09)V9(08)
  2588                                         COMP-3 VALUE ZEROS.
  2589     12  W-IBNR-1            PIC S9(07)V9(02)
  2590                                         COMP-3 VALUE ZEROS.
  2591     12  W-IBNR-2            PIC S9(07)V9(02)
  2592                                         COMP-3 VALUE ZEROS.
  2593     12  W-ISS-BEN           PIC S9(11)V9(02)
  2594                                         COMP-3 VALUE ZEROS.
  2595     12  W-ISS-BEN-GROSS     PIC S9(11)V9(02)
  2596                                         COMP-3 VALUE ZEROS.
  2597     12  W-LF-ACTIVE         PIC S9(13)  COMP-3 VALUE ZEROS.
  2598     12  W-LF-BALLOON        PIC S9(13)  COMP-3 VALUE ZEROS.
  2599     12  W-LF-CLAIMS         PIC S9(13)  COMP-3 VALUE ZEROS.
  2600     12  W-LF-CALC-B         PIC S9(13)  COMP-3 VALUE ZEROS.
  2601     12  W-LF-DATA-USED      PIC S9(13)  COMP-3 VALUE ZEROS.
  2602     12  W-LF-INACTIVE       PIC S9(13)  COMP-3 VALUE ZEROS.
  2603     12  W-LF-ISSUES         PIC S9(13)  COMP-3 VALUE ZEROS.
  2604     12  W-LF-REMAMT-0       PIC S9(13)  COMP-3 VALUE ZEROS.
  2605     12  W-LF-REMTERM-0      PIC S9(13)  COMP-3 VALUE ZEROS.
  2606     12  W-LF-REIN           PIC S9(13)  COMP-3 VALUE ZEROS.
  2607     12  W-LF-REISSUE        PIC S9(13)  COMP-3 VALUE ZEROS.
  2608     12  W-LF-RESERVES       PIC S9(13)  COMP-3 VALUE ZEROS.
  2609     12  W-LF-RESV           PIC S9(13)  COMP-3 VALUE ZEROS.
  2610     12  W-LFTYP-99          PIC S9(13)  COMP-3 VALUE ZEROS.
  2611     12  W-LIFE-YEARS        PIC S9(09)  COMP-3 VALUE ZEROS.
  2612     12  W-LIFE-YEARS-INT    PIC S9(09)V9(06)
  2613                                         COMP-3 VALUE ZEROS.
  2614     12  W-NDX               PIC S9(03)  COMP-3 VALUE ZEROS.
  2615     12  W-ORGTRM-0-AH       PIC S9(13)  COMP-3 VALUE ZEROS.
  2616     12  W-ORGTRM-0-LF       PIC S9(13)  COMP-3 VALUE ZEROS.
  2617     12  W-RET-CODE-AH       PIC S9(13)  COMP-3 VALUE ZEROS.
  2618     12  W-RET-CODE-LF       PIC S9(13)  COMP-3 VALUE ZEROS.
  2619     12  W-PENDING-CLMS      PIC S9(13)  COMP-3 VALUE ZEROS.
  2620     12  W-POL-ISSUES        PIC S9(13)  COMP-3 VALUE ZEROS.
  2621     12  W-POLICY-ACTIVE-CTR PIC S9(13)  COMP-3 VALUE ZEROS.
  2622     12  W-POLICY-INACTIVE-CTR
  2623                             PIC S9(13)  COMP-3 VALUE ZEROS.
  2624     12  W-POLICY-REISSUE-CTR
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  55
* ECS010T1.cbl
  2625                             PIC S9(13)  COMP-3 VALUE ZEROS.
  2626     12  W-POLICY-REIN-CTR   PIC S9(13)  COMP-3 VALUE ZEROS.
  2627     12  W-POLICY-INACTIVE   PIC S9(13)  COMP-3 VALUE ZEROS.
  2628     12  W-TARGET-LOSS-RATIO PIC S9(01)V9(04)
  2629                                         COMP-3 VALUE ZEROS.
  2630     12  W-VAL-SOURCE        PIC S9(03)  COMP-3 VALUE ZEROS.
  2631     12  W-WK-IBNR           PIC S9(07)V9(02)
  2632                                         COMP-3 VALUE ZEROS.
  2633
  2634     12  W-CLAIM-TYPE        PIC  X(01).
  2635         88  W-A-H                              VALUE 'A'.
  2636         88  W-LIFE                             VALUE 'L'.
  2637     12  W-CUTOFF-DATE       PIC  9(08).
  2638     12  W-DIS-DT            PIC  XX.
  2639     12  W-DIS-PTO-DT        PIC  XX.
  2640     12  WK-LEVEL.
  2641         16  WK-AGT          PIC X(10).
  2642         16  WK-A-TYPE       PIC X.
  2643         16  WK-L-RT         PIC SV9(5)  COMP-3.
  2644         16  WK-J-RT         PIC SV9(5)  COMP-3.
  2645         16  WK-A-RT         PIC SV9(5)  COMP-3.
  2646         16  FILLER          PIC X(6).
  2647     12  WK-LEVEL-R REDEFINES WK-LEVEL.
  2648         16  FILLER          PIC X(11).
  2649         16  WK-L-RTX        PIC X(3).
  2650         16  WK-J-RTX        PIC X(3).
  2651         16  WK-A-RTX        PIC X(3).
  2652         16  FILLER          PIC X(6).
  2653     12  WK-NEW-RATES.
  2654         16  WK-N-R      OCCURS 10.
  2655             20  WK-N-AGT    PIC X(10).
  2656             20  WK-N-TYPE   PIC X.
  2657             20  WK-L-RT1    PIC SV9(5)  COMP-3.
  2658             20  WK-A-RT1    PIC SV9(5)  COMP-3.
  2659     12  W-LIFE-YEARS-ZERO.
  2660         16  FILLER          PIC  X(06)         VALUE ZEROS.
  2661         16  FILLER          PIC  X(01)         VALUE SPACES.
  2662         16  FILLER          PIC  X(02)         VALUE ZEROS.
  2663         16  FILLER          PIC  X(01)         VALUE SPACES.
  2664         16  FILLER          PIC  X(01)         VALUE SPACES.
  2665         16  FILLER          PIC  X(01)         VALUE SPACES.
  2666         16  FILLER          PIC S9(09)  COMP-3 VALUE ZEROS.
  2667         16  FILLER          PIC S9(09)  COMP-3 VALUE ZEROS.
  2668         16  FILLER          PIC S9(09)  COMP-3 VALUE ZEROS.
  2669         16  FILLER          PIC S9(09)  COMP-3 VALUE ZEROS.
  2670         16  FILLER          PIC S9(09)  COMP-3 VALUE ZEROS.
  2671         16  FILLER          PIC S9(09)  COMP-3 VALUE ZEROS.
  2672         16  FILLER          PIC S9(09)  COMP-3 VALUE ZEROS.
  2673         16  FILLER          PIC S9(09)  COMP-3 VALUE ZEROS.
  2674         16  FILLER          PIC S9(09)  COMP-3 VALUE ZEROS.
  2675         16  FILLER          PIC S9(09)  COMP-3 VALUE ZEROS.
  2676         16  FILLER          PIC S9(09)  COMP-3 VALUE ZEROS.
  2677         16  FILLER          PIC S9(09)  COMP-3 VALUE ZEROS.
  2678         16  FILLER          PIC S9(09)  COMP-3 VALUE ZEROS.
  2679         16  FILLER          PIC S9(09)V9(02) COMP-3
  2680                                                VALUE ZEROS.
  2681         16  FILLER          PIC S9(09)V9(02) COMP-3
  2682                                                VALUE ZEROS.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  56
* ECS010T1.cbl
  2683         16  FILLER          PIC S9(09)V9(02) COMP-3
  2684                                                VALUE ZEROS.
  2685         16  FILLER          PIC S9(09)V9(02) COMP-3
  2686                                                VALUE ZEROS.
  2687         16  FILLER          PIC S9(11)V9(02) COMP-3
  2688                                                VALUE ZEROS.
  2689
  2690     12  W-REIN-PROCESS-IND  PIC  X(01)         VALUE SPACES.
  2691         88 W-REIN-IN-PROCESS                   VALUE 'Y'.
  2692     12  W-REIN-PROCESS-SW   PIC  X(01)         VALUE SPACES.
  2693         88  W-REIN-PROCESS                     VALUE 'Y'.
  2694         88  W-NOT-REIN-PROCESS                 VALUE SPACES.
  2695     12  W-SELECTION-SW      PIC  X(01)         VALUE SPACES.
  2696         88  W-SELECTION-ON                     VALUE 'Y'.
  2697         88  W-SELECTION-OFF                    VALUE SPACES.
  2698     12  W-RTRM-0-SW         PIC  X(01)         VALUE SPACES.
  2699         88  W-RTRM-0                           VALUE 'Y'.
  2700         88  W-RTRM-NOT-0                       VALUE SPACES.
  2701     12  W-SUB-KEY           PIC  X(03)         VALUE SPACES.
  2702     12  W-TABLE-USED-SW     PIC  X(01)         VALUE SPACES.
  2703         88  W-TABLE-USED                       VALUE 'Y'.
  2704         88  W-TABLE-NOT-USED                   VALUE SPACES.
  2705     12  W-UNDERWRITING-SW   PIC  X             VALUE SPACES.
  2706         88  W-UNDERWRITTEN-DATA                VALUE '*'.
  2707
  2708     12  W-VAL-ERRORS.
  2709         16  FILLER          PIC  X(40)
  2710             VALUE 'PENDING CANC PROCESS - CR-LF-CANC-DT - '.
  2711         16  FILLER          PIC  X(40)
  2712             VALUE 'EPEC PROCESS - LIFE - RUN DATE - '.
  2713         16  FILLER          PIC  X(40)
  2714             VALUE 'EPEC CANCEL - LIFE - CR-LF-CANC-DT - '.
  2715         16  FILLER          PIC  X(40)
  2716             VALUE 'EPEC CANCEL LIFE SUM - CR-LF-CANC-DT - '.
  2717         16  FILLER          PIC  X(40)
  2718             VALUE 'EOM RUN DATE - EPEC - COMM - '.
  2719         16  FILLER          PIC  X(40)
  2720             VALUE 'RUN DATE EPEC - A&H - '.
  2721         16  FILLER          PIC  X(40)
  2722             VALUE 'CUTOFF DTE (OPT-MTHD) - '.
  2723         16  FILLER          PIC  X(40)
  2724             VALUE 'EOM RUN DATE - A&H EARNED PREMIUM - '.
  2725         16  FILLER          PIC  X(40)
  2726             VALUE 'EARNINGS START DATE - REIN CO RCD - '.
  2727     12  FILLER REDEFINES W-VAL-ERRORS.
  2728         16  W-VAL-ERROR OCCURS 9 TIMES
  2729                             PIC  X(40).
  2730
  2731     12  W-WORK-DATE         PIC  X(02).
  2732     12  SAVE-WK-NEW-RATES.
  2733         16  FILLER          PIC X(170).
  2734
  2735***   The following data area is for NCL only
  2736*    12  W-WORK-OB-DATA OCCURS 300.
  2737*    12  W-WORK-OB-DATA OCCURS 220.
  2738     12  W-WORK-OB-DATA OCCURS 900.
  2739         16  WS-OB-REIN-CO       PIC X(06).
  2740         16  WS-OB-LF-AH         PIC X.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  57
* ECS010T1.cbl
  2741         16  WS-OB-BENEFIT-CODE  PIC XX.
  2742         16  WS-OB-EARNED OCCURS 3.
  2743             20  WS-EPR-R78   PIC S9(09)V99 COMP-3.
  2744
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  58
* ECS010T1.cbl
  2746 01  EPEC-WORK-AREAS.
  2747     12  WE-REIN-CO          PIC X(6).
  2748     12  WE-LF-AH            PIC X.
  2749     12  WE-BEN-TYPE         PIC XX.
  2750     12  WE-LFAMT            PIC S9(9)V99    COMP-3.
  2751     12  WE-LFPRM            PIC S9(7)V99    COMP-3.
  2752     12  WE-LFAMT-ALT        PIC S9(9)V99    COMP-3.
  2753     12  WE-LFPRM-ALT        PIC S9(7)V99    COMP-3.
  2754     12  WE-LFRFND           PIC S9(7)V99    COMP-3.
  2755     12  WE-DTHAMT           PIC S9(9)V99    COMP-3.
  2756     12  WE-DTHEXP           PIC S9(9)V99    COMP-3.
  2757     12  WE-NUM-DTH-CLM      PIC S999        COMP-3.
  2758     12  WE-DTH-IBNR         PIC S9(7)V99    COMP-3.
  2759     12  WE-DTH-PAYCUR       PIC S9(7)V99    COMP-3.
  2760     12  WE-DTH-FUTRSV       PIC S9(7)V99    COMP-3.
  2761     12  WE-AHAMT            PIC S9(9)V99    COMP-3.
  2762     12  WE-AHPRM            PIC S9(7)V99    COMP-3.
  2763     12  WE-AHRFND           PIC S9(7)V99    COMP-3.
  2764     12  WE-DSPY-AMT         PIC S9(9)V99    COMP-3.
  2765     12  WE-DSPY-EXP         PIC S9(9)V99    COMP-3.
  2766     12  WE-NUM-DIS-CLM      PIC S999        COMP-3.
  2767     12  WE-DIS-IBNR         PIC S9(7)V99    COMP-3.
  2768     12  WE-DIS-PAYCUR       PIC S9(7)V99    COMP-3.
  2769     12  WE-DIS-FUTRSV       PIC S9(7)V99    COMP-3.
  2770     12  ISS-BEN             PIC S9(9)V99    COMP-3.
  2771     12  CNC-BEN             PIC S9(9)V99    COMP-3.
  2772     12  ISS-PRM             PIC S9(7)V99    COMP-3.
  2773     12  ISS-PRMTAX          PIC S9(7)V99    COMP-3.
  2774     12  CNC-PRM             PIC S9(7)V99    COMP-3.
  2775     12  GROSS-ISS-BEN-LF    PIC S9(9)V99    COMP-3.
  2776     12  GROSS-CNC-BEN-LF    PIC S9(9)V99    COMP-3.
  2777     12  GROSS-ISS-PRM-LF    PIC S9(7)V99    COMP-3.
  2778     12  GROSS-CNC-PRM-LF    PIC S9(7)V99    COMP-3.
  2779     12  GROSS-ISS-BEN-AH    PIC S9(7)V99    COMP-3.
  2780     12  GROSS-CNC-BEN-AH    PIC S9(7)V99    COMP-3.
  2781     12  GROSS-ISS-PRM-AH    PIC S9(7)V99    COMP-3.
  2782     12  GROSS-CNC-PRM-AH    PIC S9(7)V99    COMP-3.
  2783     12  EARNED-BY-CANCEL    PIC S9(7)V99    COMP-3.
  2784     12  EPR-R78             PIC S9(7)V99    COMP-3.
  2785     12  EPR-PRO             PIC S9(7)V99    COMP-3.
  2786     12  EPR-ST              PIC S9(7)V99    COMP-3.
  2787     12  W-OPT-R78           PIC S9(7)V99    COMP-3.
  2788     12  W-OPT-PRO           PIC S9(7)V99    COMP-3.
  2789     12  W-OPT-ST            PIC S9(7)V99    COMP-3.
  2790     12  WX-ACTIVE-COUNT     PIC S9          COMP-3.
  2791     12  WX-CANC-DT          PIC 9(11)       COMP-3.
  2792     12  WX-CLM-AMT          PIC S9(9)V99    COMP-3.
  2793     12  WX-CLM-EXP          PIC S9(9)V99    COMP-3.
  2794     12  WX-CLM-CNT          PIC S9(7)       COMP-3.
  2795     12  WX-CLM-CRT          PIC S9(7)       COMP-3.
  2796     12  WX-CNC-CNT          PIC S9(7)       COMP-3.
  2797     12  WX-CLAIM-EXIT-DATE  PIC  9(11)      COMP-3.
  2798     12  WX-SETTLEMENT-EXIT-DATE
  2799                             PIC  9(11)      COMP-3.
  2800     12  WX-STATUS-AT-CANCEL PIC  X(1).
  2801     12  WX-STATUS-AT-DEATH  PIC  X(1).
  2802     12  WX-STATUS-AT-SETTLEMENT
  2803                             PIC  X(1).
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  59
* ECS010T1.cbl
  2804     12  WX-EOM-RUN-DATE     PIC  9(11)      COMP-3.
  2805
  2806 01  EPEC-WORK.
  2807     12  EW-REIN-CO          PIC X(6).
  2808     12  EW-SUB-KEY.
  2809         16  EW-LF-AH        PIC X.
  2810         16  EW-BEN-TYPE     PIC XX.
  2811     12  EW-ISS-BEN          PIC S9(11)V99   COMP-3.
  2812     12  EW-ISS-BEN-GROSS    PIC S9(11)V99   COMP-3.
  2813     12  EW-CNC-BEN          PIC S9(11)V99   COMP-3.
  2814     12  EW-CNC-BEN-GROSS    PIC S9(11)V99   COMP-3.
  2815     12  EW-ISS-PRM          PIC S9(9)V99    COMP-3.
  2816     12  EW-ISS-PRM-GROSS    PIC S9(9)V99    COMP-3.
  2817     12  EW-CNC-PRM          PIC S9(9)V99    COMP-3.
  2818     12  EW-CNC-PRM-GROSS    PIC S9(9)V99    COMP-3.
  2819     12  EW-EPR-R78          PIC S9(9)V99    COMP-3.
  2820     12  EW-EPR-R78-ADJ      PIC S9(9)V99    COMP-3.
  2821     12  EW-EPR-PRO          PIC S9(9)V99    COMP-3.
  2822     12  EW-EPR-PRO-ADJ      PIC S9(9)V99    COMP-3.
  2823     12  EW-EPR-ST           PIC S9(9)V99    COMP-3.
  2824     12  EW-EPR-ST-ADJ       PIC S9(9)V99    COMP-3.
  2825     12  EW-CLM-AMT          PIC S9(9)V99    COMP-3.
  2826     12  EW-CLM-IBNR         PIC S9(7)V99    COMP-3.
  2827     12  EW-CLM-PAYCUR       PIC S9(7)V99    COMP-3.
  2828     12  EW-CLM-FUTRSV       PIC S9(7)V99    COMP-3.
  2829     12  EW-CLM-CNT          PIC S9(7)       COMP-3.
  2830     12  EW-CLM-CRT          PIC S9(7)       COMP-3.
  2831     12  EW-ISS-CNT          PIC S9(7)       COMP-3.
  2832     12  EW-CNC-CNT          PIC S9(7)       COMP-3.
  2833     12  EW-ISS-PRM-TAX      PIC S9(7)V99    COMP-3.
  2834     12  EW-AGENTS       OCCURS 10.
  2835         16  EW-AGT-NO       PIC X(10).
  2836         16  EW-AGT-TYPE     PIC X.
  2837         16  EW-ISS-COM      PIC S9(9)V99    COMP-3.
  2838         16  EW-CNC-COM      PIC S9(9)V99    COMP-3.
  2839         16  EW-ECR-R78      PIC S9(9)V99    COMP-3.
  2840         16  EW-ECR-R78-ADJ  PIC S9(9)V99    COMP-3.
  2841         16  EW-ECR-PRO      PIC S9(9)V99    COMP-3.
  2842         16  EW-ECR-PRO-ADJ  PIC S9(9)V99    COMP-3.
  2843         16  EW-ECR-ST       PIC S9(9)V99    COMP-3.
  2844     12  EW-COV-DTE          PIC 9(11)       COMP-3.
  2845     12  EW-INFORCE-CNT      PIC S9(9)       COMP-3.
  2846     12  EW-ORIG-TERM        PIC S9(9)       COMP-3.
  2847     12  EW-REM-TERM         PIC S9(9)       COMP-3.
  2848     12  EW-AGE              PIC S9(9)       COMP-3.
  2849     12  EW-AGE-BEN          PIC S9(11)      COMP-3.
  2850     12  EW-TERM-BEN         PIC S9(11)      COMP-3.
  2851     12  EW-LEVEL-USED       PIC X.
  2852
  2853 01  EPEC-TOTALS.
  2854     12  EPEC-LEVELS     OCCURS 900.
  2855*    12  EPEC-LEVELS     OCCURS 220.
  2856*    12  EPEC-LEVELS     OCCURS 300.
  2857         16  EPEC-REIN-CO          PIC X(6).
  2858         16  EPEC-SUB-KEY.
  2859             24  EPEC-LF-AH        PIC X.
  2860             24  EPEC-BEN-TYPE     PIC XX.
  2861*        16  FILLER                PIC X(694).
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  60
* ECS010T1.cbl
  2862         16  FILLER                PIC X(699).
  2863     12  EPEC-LEVELS-END           PIC X(6).
  2864
  2865 01  EPEC-UNDERWRITTEN-TOTALS.
  2866     12  EPEC-LEVELS-II  OCCURS 900.
  2867*    12  EPEC-LEVELS-II  OCCURS 220.
  2868*    12  EPEC-LEVELS-II  OCCURS 300.
  2869         16  EPEC-REIN-CO-II       PIC X(6).
  2870         16  EPEC-SUB-KEY-II.
  2871             24  EPEC-LF-AH-II     PIC X.
  2872             24  EPEC-BEN-TYPE-II  PIC XX.
  2873*        16  FILLER                PIC X(694).
  2874         16  FILLER                PIC X(699).
  2875     12  EPEC-LEVELS-END-II        PIC X(6).
  2876
  2877
  2878 01  FILLER                      PIC  X(11)
  2879                                 VALUE 'OPT RSV TBL'.
  2880*
  2881* THE 'PIC' VALUE OF THE NEXT 2 DATA NAMES IS 300 OCCURANCES
  2882*  TIMES THE SIZE OF THE DATA NAME THAT OCCURS.
  2883*  EX: EPEC-OPT-GRP  (300) TIMES THE TOTAL SIZE OF FIELDS IN
  2884*      EPEC-OPT-GRP  (108)
  2885*
  2886*      300 X 108 = 32400.
  2887*
  2888 01  EPEC-OPT-DATA-TABLE.
  2889*    12  FILLER                  PIC X(32400).
  2890*    12  FILLER                  PIC X(23760).
  2891     12  FILLER                  PIC X(97200).
  2892
  2893 01  FILLER                      PIC  X(16)
  2894                                 VALUE 'OPT RSV TBL UNDW'.
  2895 01  EPEC-UNDW-OPT-DATA-TABLE.
  2896*    12  FILLER                  PIC X(32400).
  2897*    12  FILLER                  PIC X(23760).
  2898     12  FILLER                  PIC X(97200).
  2899
  2900 01  FILLER                      PIC  X(16)
  2901                                 VALUE 'OPT RSV TBL WORK'.
  2902 01  EPEC-OPT-WORK-TABLE.
  2903*    12  EPEC-OPT-GRP        OCCURS 300.
  2904*    12  EPEC-OPT-GRP        OCCURS 220.
  2905     12  EPEC-OPT-GRP        OCCURS 900.
  2906         16  EPEC-REIN-CO-OPT
  2907                             PIC  X(06).
  2908         16  EPEC-SUB-KEY-OPT.
  2909             24  EPEC-LF-AH-OPT
  2910                             PIC  X(01).
  2911             24  EPEC-BEN-TYPE-OPT
  2912                             PIC  X(02).
  2913         16  EPEC-OPT-DATA.
  2914             20  EPEC-REIN-ONLY-IND
  2915                             PIC  X(01).
  2916                 88  EPEC-REIN-ONLY-DATA   VALUE 'R'.
  2917             20  EPEC-LINE-NOT-USED-IND
  2918                             PIC  X(01).
  2919                 88  EPEC-LINE-NOT-USED    VALUE 'N'.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  61
* ECS010T1.cbl
  2920             20  EPEC-LIFE-CTR-USED-IND
  2921                             PIC  X(01).
  2922                 88  EPEC-LIFE-CTR-USED    VALUE 'Y'.
  2923                 88  EPEC-LIFE-CTR-NOT-USED
  2924                                           VALUE ' '.
  2925             20  EPEC-LIFE-CTR   OCCURS 13 TIMES
  2926                             PIC S9(09)       COMP-3.
  2927             20  EPEC-EARNED-PREMIUM-AH
  2928                             PIC S9(09)V9(02) COMP-3.
  2929             20  EPEC-CLAIMS-MADE-PAID
  2930                             PIC S9(09)V9(02) COMP-3.
  2931             20  EPEC-CLM-EXP
  2932                             PIC S9(09)V9(02) COMP-3.
  2933             20  EPEC-LIFE-IBNR
  2934                             PIC S9(09)V9(02) COMP-3.
  2935             20  EPEC-REIN-ISS-BEN
  2936                             PIC S9(11)V9(02) COMP-3.
  2937
  2938 01  FILLER                  PIC X(09)
  2939                                 VALUE 'EOM TABLE'.
  2940
  2941 01  EOM-DATE-TABLE.
  2942     12  EOM-DATE            OCCURS 13
  2943                             PIC 9(08).
  2944
  2945 01  EPEC-SUBS.
  2946     12  EPEC-SUB-LEVELS OCCURS 31.
  2947         16  EPEC-SUB-REIN   PIC X(6).
  2948         16  EPEC-SUB-LF     PIC S999  COMP  OCCURS 900.
  2949         16  EPEC-SUB-AH     PIC S999  COMP  OCCURS 900.
  2950     12  EPEC-SUBS-END       PIC X(6).
  2951
  2952 01  SAVE-REIN-WORK.
  2953     12  REIN-SUB-1          PIC S9(4)   COMP    VALUE +0.
  2954     12  REIN-SUB-2          PIC S9(4)   COMP    VALUE +0.
  2955     12  REIN-MAX            PIC S9(4)   COMP    VALUE +32.
  2956     12  REIN-LOW-TIME       PIC 9(6)            VALUE 999999.
  2957     12  REIN-LOW-SUB        PIC S9(4)   COMP    VALUE +1.
  2958
  2959 01  SAVE-REIN-TABLE.
  2960     12  SAVE-REIN-ENTRY     OCCURS 32 TIMES.
  2961         16  SR-TIME         PIC 9(6).
  2962         16  SR-ENTRY.
  2963             20  FILLER      PIC XX.
  2964             20  SR-CONTROL  PIC X(8).
  2965             20  FILLER      PIC X(3990).
  2966
  2967
* 2968                             COPY ECSRITAB.
  2969******************************************************************04/29/98
  2970*                                                                *ECSRITAB
  2971*                            ECSRITAB                            *   LV015
  2972*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL*15
  2973*                            VMOD=2.015                          *ECSRITAB
  2974*                                                                *ECSRITAB
  2975*  NO  CID  MODS  IN  COPYBOOK  ECSRITAB                         *ECSRITAB
  2976*                                                                *ECSRITAB
  2977******************************************************************ECSRITAB
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  62
* ECS010T1.cbl (/apps/prod/cid1p/copy/ECSRITAB)
  2978 01  REIN-WORK-AREAS.                                             ECSRITAB
  2979     12  RW-LFAMT                PIC S9(9)V99  VALUE +0   COMP-3. ECSRITAB
  2980     12  RW-AHWRK                PIC S9(9)V99  VALUE +0   COMP-3. ECSRITAB
  2981     12  RW-LFPRM                PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  2982     12  RW-LFPRMC               PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  2983     12  RW-LFRFND               PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  2984     12  RW-AHPRM                PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  2985     12  RW-AHPRMC               PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  2986     12  RW-AHRFND               PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  2987     12  RW-LFCLMWK              PIC S9(9)V99  VALUE +0   COMP-3. ECSRITAB
  2988     12  RW-AHCLMWK              PIC S9(9)V99  VALUE +0   COMP-3. ECSRITAB
  2989     12  RW-AH-INCURRED-DETAIL.                                   ECSRITAB
  2990         16  RW-AH-INCURRED-DATA OCCURS 5 TIMES.                  ECSRITAB
  2991             20  RW-AH-INCUR-DT  PIC 9(11) COMP-3.                   CL**2
  2992             20  RW-AH-CLM-AMT   PIC S9(9)V99             COMP-3. ECSRITAB
  2993             20  RW-AH-CLM-EXP   PIC S9(9)V99             COMP-3. ECSRITAB
  2994     12  RW-LFCLM                PIC S9(9)V99  VALUE +0   COMP-3. ECSRITAB
  2995     12  RW-AHCLM                PIC S9(9)V99  VALUE +0   COMP-3. ECSRITAB
  2996     12  RW-AH-LIMIT             PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  2997     12  RW-LFIBNR               PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  2998     12  RW-LFPAYCUR             PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  2999     12  RW-LFFUTRSV             PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  3000     12  RW-AHIBNR               PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  3001     12  RW-AHPAYCUR             PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  3002     12  RW-AHFUTRSV             PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  3003     12  RW-LFIBNRWK             PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  3004     12  RW-LFPAYCURWK           PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  3005     12  RW-LFFUTRSVWK           PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  3006     12  RW-AHIBNRWK             PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  3007     12  RW-AHPAYCURWK           PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  3008     12  RW-AHFUTRSVWK           PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  3009     12  RW-AHLIM-LO             PIC S9(9)V99  VALUE +0   COMP-3. ECSRITAB
  3010     12  RW-AHLIM-HI             PIC S9(9)V99  VALUE +0   COMP-3. ECSRITAB
  3011     12  RW-ACCUM-LF             PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  3012     12  RW-ACCUM-AH             PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  3013     12  RW-ACCUM-CLM            PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  3014     12  RW-ACCUM-IBNR           PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  3015     12  RW-ACCUM-PAYCUR         PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  3016     12  RW-ACCUM-FUTRSV         PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  3017                                                                  ECSRITAB
  3018 01  REIN-HOLD-AREAS.                                             ECSRITAB
  3019     12  REIN-LEVELS       OCCURS 30 TIMES.                       ECSRITAB
  3020         16  REIN-COMP               PIC X(6).                    ECSRITAB
  3021         16  REIN-LF-AH-FLGS.                                     ECSRITAB
  3022             20  REIN-LF-FLG         PIC X.                       ECSRITAB
  3023             20  REIN-AH-FLG         PIC X.                       ECSRITAB
  3024         16  REIN-WORK-FLDS.                                      ECSRITAB
  3025             20  REIN-LFAMT          PIC S9(9)V99   COMP-3.       ECSRITAB
  3026             20  REIN-LFPRM          PIC S9(7)V99   COMP-3.       ECSRITAB
  3027             20  REIN-AHAMT          PIC S9(7)V99   COMP-3.       ECSRITAB
  3028             20  REIN-AHPRM          PIC S9(7)V99   COMP-3.       ECSRITAB
  3029             20  REIN-LFRFND         PIC S9(7)V99   COMP-3.       ECSRITAB
  3030             20  REIN-AHRFND         PIC S9(7)V99   COMP-3.       ECSRITAB
  3031             20  REIN-LFCLM          PIC S9(9)V99   COMP-3.       ECSRITAB
  3032             20  REIN-AHCLM          PIC S9(9)V99   COMP-3.       ECSRITAB
  3033             20  REIN-LFCLML         PIC S9(9)V99   COMP-3.       ECSRITAB
  3034             20  REIN-AHCLML         PIC S9(9)V99   COMP-3.       ECSRITAB
  3035             20  REIN-DIS-IBNR       PIC S9(7)V99   COMP-3.       ECSRITAB
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  63
* ECS010T1.cbl (/apps/prod/cid1p/copy/ECSRITAB)
  3036             20  REIN-DIS-PAYCUR     PIC S9(7)V99   COMP-3.       ECSRITAB
  3037             20  REIN-DIS-FUTRSV     PIC S9(7)V99   COMP-3.       ECSRITAB
  3038             20  REIN-DIS-IBNRL      PIC S9(7)V99   COMP-3.       ECSRITAB
  3039             20  REIN-DIS-PAYCURL    PIC S9(7)V99   COMP-3.       ECSRITAB
  3040             20  REIN-DIS-FUTRSVL    PIC S9(7)V99   COMP-3.       ECSRITAB
  3041             20  REIN-DTH-IBNR       PIC S9(7)V99   COMP-3.       ECSRITAB
  3042             20  REIN-DTH-PAYCUR     PIC S9(7)V99   COMP-3.       ECSRITAB
  3043             20  REIN-DTH-FUTRSV     PIC S9(7)V99   COMP-3.       ECSRITAB
  3044             20  REIN-DTH-IBNRL      PIC S9(7)V99   COMP-3.       ECSRITAB
  3045             20  REIN-DTH-PAYCURL    PIC S9(7)V99   COMP-3.       ECSRITAB
  3046             20  REIN-DTH-FUTRSVL    PIC S9(7)V99   COMP-3.       ECSRITAB
  3047             20  REIN-AH-LIMIT       PIC S9(7)V99   COMP-3.       ECSRITAB
  3048             20  REIN-REM-SW         PIC X.                       ECSRITAB
  3049             20  REIN-REM-AH-100     PIC X.                       ECSRITAB
  3050             20  REIN-EP-STOP-DATE   PIC 9(11)      COMP-3.          CL**4
  3051             20  REIN-LF-RUNOFF-SW   PIC X.                       ECSRITAB
  3052             20  REIN-AH-RUNOFF-SW   PIC X.                       ECSRITAB
  3053     12  REIN-LEVELS-END             PIC X(6).                    ECSRITAB
  3054                                                                  ECSRITAB
  3055     12  RWF-FIELDS.                                              ECSRITAB
  3056         16  RWF-LFAMT               PIC S9(9)V99   COMP-3.       ECSRITAB
  3057         16  RWF-LFPRM               PIC S9(7)V99   COMP-3.       ECSRITAB
  3058         16  RWF-AHAMT               PIC S9(7)V99   COMP-3.       ECSRITAB
  3059         16  RWF-AHPRM               PIC S9(7)V99   COMP-3.       ECSRITAB
  3060         16  RWF-LFRFND              PIC S9(7)V99   COMP-3.       ECSRITAB
  3061         16  RWF-AHRFND              PIC S9(7)V99   COMP-3.       ECSRITAB
  3062         16  RWF-LFCLM               PIC S9(9)V99   COMP-3.       ECSRITAB
  3063         16  RWF-AHCLM               PIC S9(9)V99   COMP-3.       ECSRITAB
  3064         16  RWF-LFCLML              PIC S9(9)V99   COMP-3.       ECSRITAB
  3065         16  RWF-AHCLML              PIC S9(9)V99   COMP-3.       ECSRITAB
  3066         16  RWF-DIS-IBNR            PIC S9(7)V99   COMP-3.       ECSRITAB
  3067         16  RWF-DIS-PAYCUR          PIC S9(7)V99   COMP-3.       ECSRITAB
  3068         16  RWF-DIS-FUTRSV          PIC S9(7)V99   COMP-3.       ECSRITAB
  3069         16  RWF-DIS-IBNRL           PIC S9(7)V99   COMP-3.       ECSRITAB
  3070         16  RWF-DIS-PAYCURL         PIC S9(7)V99   COMP-3.       ECSRITAB
  3071         16  RWF-DIS-FUTRSVL         PIC S9(7)V99   COMP-3.       ECSRITAB
  3072         16  RWF-DTH-IBNR            PIC S9(7)V99   COMP-3.       ECSRITAB
  3073         16  RWF-DTH-PAYCUR          PIC S9(7)V99   COMP-3.       ECSRITAB
  3074         16  RWF-DTH-FUTRSV          PIC S9(7)V99   COMP-3.       ECSRITAB
  3075         16  RWF-DTH-IBNRL           PIC S9(7)V99   COMP-3.       ECSRITAB
  3076         16  RWF-DTH-PAYCURL         PIC S9(7)V99   COMP-3.       ECSRITAB
  3077         16  RWF-DTH-FUTRSVL         PIC S9(7)V99   COMP-3.       ECSRITAB
  3078         16  RWF-AH-LIMIT            PIC S9(7)V99   COMP-3.       ECSRITAB
  3079         16  RWF-REM-SW              PIC X.                       ECSRITAB
  3080         16  RWF-REM-AH-100          PIC X.                       ECSRITAB
  3081         16  RWF-EP-STOP-DATE        PIC 9(11)      COMP-3.          CL**3
  3082         16  RWF-LF-RUNOFF-SW        PIC X.                       ECSRITAB
  3083         16  RWF-AH-RUNOFF-SW        PIC X.                       ECSRITAB
  3084                                                                  ECSRITAB
  3085     12  WT-COMP-INFO.                                            ECSRITAB
  3086         16  WT-REI-COMP             PIC X(6).                    ECSRITAB
  3087         16  WT-LF-QC                PIC X.                       ECSRITAB
  3088         16  WT-AH-QC                PIC X.                       ECSRITAB
  3089         16  WT-LO-DATE              PIC 9(11)     COMP-3.           CL**2
  3090         16  WT-HI-DATE              PIC 9(11)     COMP-3.           CL**2
  3091         16  WT-LFAGE-LO             PIC 99.                      ECSRITAB
  3092         16  WT-LFAGE-HI             PIC 99.                      ECSRITAB
  3093         16  WT-AHAGE-LO             PIC 99.                      ECSRITAB
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  64
* ECS010T1.cbl (/apps/prod/cid1p/copy/ECSRITAB)
  3094         16  WT-AHAGE-HI             PIC 99.                      ECSRITAB
  3095         16  WT-LFTRM-LO             PIC S999       COMP-3.       ECSRITAB
  3096         16  WT-LFTRM-HI             PIC S999       COMP-3.       ECSRITAB
  3097         16  WT-AHTRM-LO             PIC S999       COMP-3.       ECSRITAB
  3098         16  WT-AHTRM-HI             PIC S999       COMP-3.       ECSRITAB
  3099         16  WT-LF-PCT               PIC S9V9999    COMP-3.       ECSRITAB
  3100         16  WT-AH-PCT               PIC S9V9999    COMP-3.       ECSRITAB
  3101         16  WT-LF-LIM-LO            PIC S9(9)V99   COMP-3.       ECSRITAB
  3102         16  WT-LF-LIM-HI            PIC S9(9)V99   COMP-3.       ECSRITAB
  3103         16  WT-LF-LO                PIC S9(9)V99   COMP-3.       ECSRITAB
  3104         16  WT-LF-HI                PIC S9(9)V99   COMP-3.       ECSRITAB
  3105         16  WT-AHBEN-LIM-LO         PIC S9(7)V99   COMP-3.       ECSRITAB
  3106         16  WT-AHBEN-LIM-HI         PIC S9(7)V99   COMP-3.       ECSRITAB
  3107         16  WT-AHBEN-LO             PIC S9(7)V99   COMP-3.       ECSRITAB
  3108         16  WT-AHBEN-HI             PIC S9(7)V99   COMP-3.       ECSRITAB
  3109         16  WT-AHMOA-LIM-LO         PIC S9(7)V99   COMP-3.       ECSRITAB
  3110         16  WT-AHMOA-LIM-HI         PIC S9(7)V99   COMP-3.       ECSRITAB
  3111         16  WT-AHMOA-LO             PIC S9(7)V99   COMP-3.       ECSRITAB
  3112         16  WT-AHMOA-HI             PIC S9(7)V99   COMP-3.       ECSRITAB
  3113         16  WT-LF-BEN-CODE          PIC X.                       ECSRITAB
  3114         16  WT-AH-BEN-CODE          PIC X.                       ECSRITAB
  3115         16  WT-INTERACTIVE          PIC X.                       ECSRITAB
  3116         16  WT-REMAINING            PIC X.                       ECSRITAB
  3117         16  FILLER                  PIC X(21).                   ECSRITAB
  3118                                                                  ECSRITAB
  3119 01  REIN-MISC-WORK-FIELDS.                                       ECSRITAB
  3120     12  SUB1                    PIC S9(4)       COMP.            ECSRITAB
  3121     12  SUB2                    PIC S9(4)       COMP.            ECSRITAB
  3122     12  CO-SUB                  PIC S9(4)       COMP.            ECSRITAB
  3123     12  INC-SUB                 PIC S999        COMP.            ECSRITAB
  3124     12  MORTALITY-SUB           PIC S999        COMP.            ECSRITAB
  3125     12  REIN-FACTOR             PIC S99V9(7)  COMP-3   VALUE +0. ECSRITAB
  3126     12  REIN-CALCED-LIFE        PIC S9(7)V99  COMP-3   VALUE +0. ECSRITAB
  3127     12  REIN-CALCED-AH          PIC S9(7)V99  COMP-3   VALUE +0. ECSRITAB
  3128     12  REIN-RISK-AMOUNT        PIC S9(11)V99 COMP-3   VALUE +0. ECSRITAB
  3129     12  REIN-MONTH-REDUCE       PIC S9(7)V99  COMP-3   VALUE +0. ECSRITAB
  3130     12  REIN-CEDE-TERM          PIC S999V99   COMP-3   VALUE +0. ECSRITAB
  3131     12  REIN-WORKA              PIC S999      COMP-3   VALUE +0. ECSRITAB
  3132     12  REIN-EARN-LF-TERM       PIC S999      COMP-3   VALUE +0. ECSRITAB
  3133     12  REIN-EARN-AH-TERM       PIC S999      COMP-3   VALUE +0. ECSRITAB
  3134     12  REIN-LCNC-EARN-TERM     PIC S999      COMP-3   VALUE +0. ECSRITAB
  3135     12  REIN-ACNC-EARN-TERM     PIC S999      COMP-3   VALUE +0. ECSRITAB
  3136     12  REIN-LF-CLM-MONTHS      PIC S999      COMP-3   VALUE +0. ECSRITAB
  3137     12  REIN-AH-CLM-MONTHS      PIC S999      COMP-3   VALUE +0. ECSRITAB
  3138     12  REIN-AH-CLM-MTH-1       PIC S999      COMP-3   VALUE +0. ECSRITAB
  3139     12  REIN-AH-CLM-MTH-2       PIC S999      COMP-3   VALUE +0. ECSRITAB
  3140     12  REIN-AH-CLM-MTH-3       PIC S999      COMP-3   VALUE +0. ECSRITAB
  3141     12  REIN-AH-CLM-MTH-4       PIC S999      COMP-3   VALUE +0. ECSRITAB
  3142     12  REIN-AH-CLM-MTH-5       PIC S999      COMP-3   VALUE +0. ECSRITAB
  3143     12  REIN-AH-PRIOR-CLMS-PAID PIC S9(11)V99 COMP-3   VALUE +0. ECSRITAB
  3144                                                                  ECSRITAB
  3145     12  REIN-VOID-LF-SW         PIC X    VALUE ' '.              ECSRITAB
  3146         88  VOIDING-LF-CANCEL            VALUE '*'.              ECSRITAB
  3147     12  REIN-VOID-AH-SW         PIC X    VALUE ' '.              ECSRITAB
  3148         88  VOIDING-AH-CANCEL            VALUE '*'.              ECSRITAB
  3149     12  REIN-ADDL-LF-SW         PIC X    VALUE ' '.              ECSRITAB
  3150         88  ADDITIONAL-LF-CANCEL         VALUE '*'.              ECSRITAB
  3151     12  REIN-ADDL-AH-SW         PIC X    VALUE ' '.              ECSRITAB
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  65
* ECS010T1.cbl (/apps/prod/cid1p/copy/ECSRITAB)
  3152         88  ADDITIONAL-AH-CANCEL         VALUE '*'.              ECSRITAB
  3153     12  REIN-CANCEL-LF-SW       PIC X    VALUE ' '.              ECSRITAB
  3154         88  FLAT-CANCEL-LF               VALUE '*'.              ECSRITAB
  3155     12  REIN-CANCEL-AH-SW       PIC X    VALUE ' '.              ECSRITAB
  3156         88  FLAT-CANCEL-AH               VALUE '*'.              ECSRITAB
  3157                                                                  ECSRITAB
  3158     12  REIN-BEN-CODE           PIC X.                           ECSRITAB
  3159         88  CEDING-SINGLE-PREM-ONLY      VALUE 'A'.              ECSRITAB
  3160         88  CEDING-OUT-BALANCE-ONLY      VALUE 'B'.              ECSRITAB
  3161         88  CEDING-REDUCING-ONLY         VALUE 'C'  'F'.         ECSRITAB
  3162         88  CEDING-LEVEL-ONLY            VALUE 'D'  'E'.         ECSRITAB
  3163         88  CEDING-GROUP-ONLY            VALUE 'G'.              ECSRITAB
  3164         88  CEDING-GROUP-RED-LIFE-ONLY   VALUE 'H'.              ECSRITAB
  3165         88  CEDING-INDIVIDUAL-ONLY       VALUE 'I'.              ECSRITAB
  3166         88  CEDING-JOINT-ONLY            VALUE 'J'.              ECSRITAB
  3167         88  CEDING-SGL-PREM-REDUCING     VALUE 'K'.              ECSRITAB
  3168         88  CEDING-SGL-PREM-GROUP        VALUE 'L'.              ECSRITAB
  3169         88  CEDING-GROUP-LEVEL-ONLY      VALUE 'M'.              ECSRITAB
  3170         88  CEDING-SGL-PREM-GRP-REDUCING VALUE 'N'.              ECSRITAB
  3171         88  CEDING-SGL-PREM-GROUP-LEVEL  VALUE 'P'.              ECSRITAB
  3172         88  CEDING-GROUP-REDUCING-ONLY   VALUE 'R'.              ECSRITAB
  3173         88  CEDING-SINGLE-POLICIES-ONLY  VALUE 'S'.              ECSRITAB
  3174         88  CEDING-AH-ONLY               VALUE '1'.              ECSRITAB
  3175         88  CEDING-PROPERTY-ONLY         VALUE '2'.              ECSRITAB
  3176         88  CEDING-UNEMPLOYMENT-ONLY     VALUE '3'.              ECSRITAB
  3177         88  CEDING-AD-D-ONLY             VALUE '4'.              ECSRITAB
  3178         88  CEDING-LIFE-ONLY             VALUE '5'.              ECSRITAB
  3179         88  CEDING-DISMEMBERMENT-ONLY    VALUE '6'.              ECSRITAB
  3180         88  CEDING-7-DAY-RETRO           VALUE '7'.              ECSRITAB
  3181         88  CEDING-14-DAY-RETRO          VALUE '8'.              ECSRITAB
  3182     12  REIN-OPEN-SW            PIC X           VALUE SPACE.     ECSRITAB
  3183     12  REIN-SEARCH.                                             ECSRITAB
  3184         16  REIN-SRCH-COMP-CD   PIC X           VALUE SPACE.     ECSRITAB
  3185         16  REIN-SRCH-CODE      PIC X           VALUE SPACE.     ECSRITAB
  3186         16  REIN-SRCH           PIC XXX         VALUE SPACE.     ECSRITAB
  3187         16  FILLER              PIC XXX         VALUE LOW-VALUE. ECSRITAB
  3188     12  SAVE-REIN-SRCH          PIC XXX         VALUE SPACE.     ECSRITAB
  3189     12  REIN-BUS-FLAG           PIC X           VALUE SPACE.     ECSRITAB
  3190     12  RATE-WORK               PIC S9(8)V9(5)  COMP-3.          ECSRITAB
  3191     12  RATE-WORK-L             PIC S9(8)V9(5)  COMP-3.          ECSRITAB
  3192     12  RATE-WORK-A             PIC S9(8)V9(5)  COMP-3.          ECSRITAB
  3193     12  RS-LIFE-BEN             PIC S9(9)V99  COMP-3   VALUE +0. ECSRITAB
  3194     12  RS-LIFE-PREM            PIC S9(7)V99  COMP-3   VALUE +0. ECSRITAB
  3195     12  RS-AH-BEN               PIC S9(9)V99  COMP-3   VALUE +0. ECSRITAB
  3196     12  RS-AH-PREM              PIC S9(7)V99  COMP-3   VALUE +0. ECSRITAB
  3197     12  RS-LP-CALC              PIC S9(7)V99  COMP-3   VALUE +0. ECSRITAB
  3198     12  RS-AP-CALC              PIC S9(7)V99  COMP-3   VALUE +0. ECSRITAB
  3199     12  RS-R-LB                 PIC S9(9)V99  COMP-3   VALUE +0. ECSRITAB
  3200     12  RS-R-LP                 PIC S9(7)V99  COMP-3   VALUE +0. ECSRITAB
  3201     12  RS-R-AB                 PIC S9(9)V99  COMP-3   VALUE +0. ECSRITAB
  3202     12  RS-R-AP                 PIC S9(7)V99  COMP-3   VALUE +0. ECSRITAB
  3203     12  RS-R-LPC                PIC S9(7)V99  COMP-3   VALUE +0. ECSRITAB
  3204     12  RS-R-APC                PIC S9(7)V99  COMP-3   VALUE +0. ECSRITAB
  3205     12  BIN-RWF-EP-STOP-DT      PIC XX        VALUE SPACES.      ECSRITAB
  3206     12  BIN-CNT                 PIC 9(3)      VALUE ZEROES.      ECSRITAB
  3207     12  BIN-CR-DIS-DT           PIC XX        VALUE SPACES.      ECSRITAB
  3208     12  BIN-WT-HIGH-DT          PIC XX        VALUE SPACES.      ECSRITAB
  3209     12  BIN-WT-LO-DT            PIC XX        VALUE SPACES.      ECSRITAB
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  66
* ECS010T1.cbl (/apps/prod/cid1p/copy/ECSRITAB)
  3210     12  BIN-LF-CANC-DT          PIC XX        VALUE SPACES.      ECSRITAB
  3211     12  BIN-AH-CANC-DT          PIC XX        VALUE SPACES.      ECSRITAB
  3212     12  BIN-CR-DTH-DT           PIC XX        VALUE SPACES.      ECSRITAB
  3213                                                                  ECSRITAB
  3214 01  REIN-CO-HOLD-TABLE.                                          ECSRITAB
  3215* ELCPSEVR MUST BE MODIFIED IF THE "OCCURS" IS CHANGED.           ECSRITAB
  3216     12  REIN-CO-HOLD-ENTRIES  OCCURS 1500 TIMES.                 ECSRITAB
  3217         16  RCT-REIN-CO         PIC X(6).                        ECSRITAB
  3218         16  RCT-CLM-CUTOFF-DT   PIC 9(11)  COMP-3.               ECSRITAB
  3219         16  RCT-EARNING-START-DT PIC 9(11)  COMP-3.              ECSRITAB
  3220         16  RCT-EARNING-STOP-DT PIC 9(11)  COMP-3.               ECSRITAB
  3221         16  RCT-EARN-STOP-CODE  PIC X.                           ECSRITAB
  3222         16  RCT-LF-CLM-PCT      PIC S9V9(4)    COMP-3.           ECSRITAB
  3223         16  RCT-LF-CLM-MAX      PIC S9(9)V99   COMP-3.           ECSRITAB
  3224         16  RCT-AH-CLM-PCT      PIC S9V9(4)    COMP-3.           ECSRITAB
  3225         16  RCT-AH-CLM-MAX      PIC S9(9)V99   COMP-3.           ECSRITAB
  3226                                                                  ECSRITAB
  3227 01  REIN-CO-HOLD-TABLE-2.                                        ECSRITAB
  3228     12  RC2-CO-HOLD-ENTRIES  OCCURS 1500 TIMES.                  ECSRITAB
  3229         16  RC2-REIN-CO.                                         ECSRITAB
  3230             20  RC2-CO-PRIME    PIC XXX.                         ECSRITAB
  3231             20  RC2-CO-SUB      PIC XXX.                         ECSRITAB
  3232         16  RC2-LF-R78-PCT      PIC S9V9(4)    COMP-3.           ECSRITAB
  3233         16  RC2-LF-PRO-PCT      PIC S9V9(4)    COMP-3.           ECSRITAB
  3234         16  RC2-AH-R78-PCT      PIC S9V9(4)    COMP-3.           ECSRITAB
  3235         16  RC2-AH-PRO-PCT      PIC S9V9(4)    COMP-3.           ECSRITAB
  3236         16  RC2-CO-NAME         PIC X(30).                       ECSRITAB
  3237         16  RC2-ECS152-RPT      PIC X.                           ECSRITAB
  3238                                                                  ECSRITAB
  3239 01  REIN-MORT-CD-HOLD-TABLE.                                     ECSRITAB
  3240     12  REIN-MORT-CD-ENTRIES  OCCURS 1500 TIMES.                 ECSRITAB
  3241         16  RCT-MORT-CO         PIC X(6).                        ECSRITAB
  3242         16  RCT-MORT-CODE       PIC X(4).                        ECSRITAB
  3243     12  REIN-INDEX              PIC S9(4)    COMP    VALUE +0.   ECSRITAB
  3244                                                                  ECSRITAB
  3245 01  BIN-RCT-ITEMS-TABLE.                                         ECSRITAB
  3246     12  BIN-RCT-ITEMS OCCURS 1500 TIMES.                         ECSRITAB
  3247         16  BIN-RCT-CLM-CUTOFF-DT    PIC XX.                     ECSRITAB
  3248         16  BIN-RCT-EARNING-START-DT PIC XX.                     ECSRITAB
  3249         16  BIN-RCT-EARNING-STOP-DT  PIC XX.                     ECSRITAB
  3250 01  BIN-RW-ITEMS-TABLE.                                          ECSRITAB
  3251     12  BIN-RW-ITEMS OCCURS 5 TIMES.                             ECSRITAB
  3252         16  BIN-RW-AH-INCUR-DT       PIC XX.                     ECSRITAB
  3253                                                                  ECSRITAB
  3254 01  REIN-CO-TABLE-ENT-CNT       PIC S9(4)    COMP-3  VALUE +1500.ECSRITAB
  3255******************************************************************ECSRITAB
  3256
* 3257                             COPY ELCPSEVR.
  3258******************************************************************04/16/98
  3259*                                                                *ELCPSEVR
  3260*                                                                *ELCPSEVR
  3261*                            ELCPSEVR                            *   LV003
  3262*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  3263*                            VMOD=2.001                          *ELCPSEVR
  3264*                                                                *ELCPSEVR
  3265*   WORKING STORAGE FOR DATE VARIABLES CREATED                   *ELCPSEVR
  3266*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCPSEVR
  3267*                                                                *ELCPSEVR
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  67
* ECS010T1.cbl (/apps/prod/cid1p/copy/ELCPSEVR)
  3268******************************************************************ELCPSEVR
  3269                                                                  ELCPSEVR
  3270 01  WS-PD-SUMMARY-DETAIL-EXTR-DT.                                ELCPSEVR
  3271     05  WS-PSC-CID-LOW.                                          ELCPSEVR
  3272         10  FILLER               PIC 999.                        ELCPSEVR
  3273         10  PSC-CID-LOW-CCYY     PIC 9(04).                      ELCPSEVR
  3274         10  PSC-CID-LOW-CCYR  REDEFINES  PSC-CID-LOW-CCYY.       ELCPSEVR
  3275             15  PSC-CID-LOW-CC   PIC 99.                            CL**3
  3276             15  PSC-CID-LOW-YY   PIC 99.                            CL**3
  3277         10  PSC-CID-LOW-MM       PIC 99.                            CL**3
  3278         10  PSC-CID-LOW-DD       PIC 99.                            CL**3
  3279     05  WS-PSC-CID-LOW-N REDEFINES                                  CL**2
  3280            WS-PSC-CID-LOW        PIC 9(11).                         CL**2
  3281     05  WS-PSC-CID-HIGH.                                         ELCPSEVR
  3282         10  FILLER              PIC 999.                         ELCPSEVR
  3283         10  PSC-CID-HIGH-CCYY   PIC 9(04).                       ELCPSEVR
  3284         10  PSC-CID-HIGH-CCYR  REDEFINES  PSC-CID-HIGH-CCYY.     ELCPSEVR
  3285             15  PSC-CID-HIGH-CC PIC 99.                             CL**3
  3286             15  PSC-CID-HIGH-YY PIC 99.                             CL**3
  3287         10  PSC-CID-HIGH-MM     PIC 99.                             CL**3
  3288         10  PSC-CID-HIGH-DD     PIC 99.                             CL**3
  3289     05  WS-PSC-CID-HIGH-N REDEFINES                                 CL**2
  3290            WS-PSC-CID-HIGH          PIC 9(11).                      CL**2
  3291 01  WS-REIN-WORK-AREAS.                                          ELCPSEVR
  3292     05  WS-REIN-CO-HOLD-ENTRIES  OCCURS 1500 TIMES               ELCPSEVR
  3293                 INDEXED BY CPSE-NDX.                             ELCPSEVR
  3294         10  WS-RCT-CLM-CUTOFF-DT.                                ELCPSEVR
  3295             15  FILLER              PIC 999.                     ELCPSEVR
  3296             15  RCT-CUTOFF-CCYY     PIC 9(04).                   ELCPSEVR
  3297             15  RCT-CUTOFF-CCYR  REDEFINES  RCT-CUTOFF-CCYY.     ELCPSEVR
  3298                 20  RCT-CUTOFF-CC   PIC 99.                      ELCPSEVR
  3299                 20  RCT-CUTOFF-YR   PIC 99.                      ELCPSEVR
  3300             15  RCT-CUTOFF-MO       PIC 99.                      ELCPSEVR
  3301             15  RCT-CUTOFF-DA       PIC 99.                      ELCPSEVR
  3302         10  WS-RCT-CLM-CUTOFF-DT-N REDEFINES                        CL**2
  3303                WS-RCT-CLM-CUTOFF-DT PIC 9(11).                      CL**2
  3304         10  WS-RCT-EARNING-START-DT.                             ELCPSEVR
  3305             15  FILLER              PIC 999.                     ELCPSEVR
  3306             15  RCT-START-CCYY      PIC 9(04).                   ELCPSEVR
  3307             15  RCT-START-CCYR  REDEFINES  RCT-START-CCYY.       ELCPSEVR
  3308                 20  RCT-START-CC    PIC 99.                      ELCPSEVR
  3309                 20  RCT-START-YR    PIC 99.                      ELCPSEVR
  3310             15  RCT-START-MO        PIC 99.                      ELCPSEVR
  3311             15  RCT-START-DA        PIC 99.                      ELCPSEVR
  3312         10  WS-RCT-EARNING-START-DT-N REDEFINES                     CL**2
  3313                WS-RCT-EARNING-START-DT  PIC 9(11).                  CL**2
  3314         10  WS-RCT-EARNING-STOP-DT.                              ELCPSEVR
  3315             15  FILLER              PIC 999.                     ELCPSEVR
  3316             15  RCT-STOP-CCYY       PIC 9(04).                   ELCPSEVR
  3317             15  RCT-STOP-CCYR  REDEFINES  RCT-STOP-CCYY.         ELCPSEVR
  3318                 20  RCT-STOP-CC     PIC 99.                      ELCPSEVR
  3319                 20  RCT-STOP-YR     PIC 99.                      ELCPSEVR
  3320             15  RCT-STOP-MO         PIC 99.                      ELCPSEVR
  3321             15  RCT-STOP-DA         PIC 99.                      ELCPSEVR
  3322         10  WS-RCT-EARNING-STOP-DT-N REDEFINES                      CL**2
  3323                WS-RCT-EARNING-STOP-DT   PIC 9(11).                  CL**2
  3324     05  WS-RWF-EP-STOP-DATE.                                     ELCPSEVR
  3325         10  FILLER              PIC 999.                         ELCPSEVR
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  68
* ECS010T1.cbl (/apps/prod/cid1p/copy/ELCPSEVR)
  3326         10  RWF-EP-STOP-CCYY    PIC 9(04).                       ELCPSEVR
  3327         10  RWF-EP-STOP-CCYR REDEFINES  RWF-EP-STOP-CCYY.        ELCPSEVR
  3328             15  RWF-EP-STOP-CC  PIC 99.                          ELCPSEVR
  3329             15  RWF-EP-STOP-YR  PIC 99.                          ELCPSEVR
  3330         10  RWF-EP-STOP-MO      PIC 99.                          ELCPSEVR
  3331         10  RWF-EP-STOP-DA      PIC 99.                          ELCPSEVR
  3332     05  WS-RWF-EP-STOP-DATE-N REDEFINES                             CL**2
  3333            WS-RWF-EP-STOP-DATE  PIC 9(11).                          CL**2
  3334
* 3335                             COPY ELCEPCVR.
  3336******************************************************************05/15/98
  3337*                                                                *ELCEPCVR
  3338*                                                                *ELCEPCVR
  3339*                            ELCEPCVR                            *   LV003
  3340*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  3341*                            VMOD=2.001                          *ELCEPCVR
  3342*                                                                *ELCEPCVR
  3343*   WORKING STORAGE FOR DATE VARIABLES CREATED                   *ELCEPCVR
  3344*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCEPCVR
  3345*                                                                *ELCEPCVR
  3346******************************************************************ELCEPCVR
  3347 01  WS-EP-RECORD-DATE.                                           ELCEPCVR
  3348     05  WS-EP-EXP-DTE.                                           ELCEPCVR
  3349         10  FILLER            PIC 999.                           ELCEPCVR
  3350         10  EP-EXP-CCYY       PIC 9(04).                         ELCEPCVR
  3351         10  EP-EXP-CCYR  REDEFINES  EP-EXP-CCYY.                 ELCEPCVR
  3352             15  EP-EXP-CC     PIC 99.                            ELCEPCVR
  3353             15  EP-EXP-YR     PIC 99.                            ELCEPCVR
  3354         10  EP-EXP-MO         PIC 99.                            ELCEPCVR
  3355         10  EP-EXP-DA         PIC 99.                            ELCEPCVR
  3356     05  WS-EP-EXP-DTE-N REDEFINES                                   CL**3
  3357            WS-EP-EXP-DTE      PIC 9(11).                            CL**3
  3358     05  WS-EC-EXP-DTE REDEFINES WS-EP-EXP-DTE.                      CL**5
  3359         10  FILLER            PIC 999.                              CL**5
  3360         10  EC-EXP-CCYY       PIC 9(04).                            CL**5
  3361         10  EC-EXP-CCYR  REDEFINES  EC-EXP-CCYY.                    CL**5
  3362             15  EC-EXP-CC     PIC 99.                               CL**5
  3363             15  EC-EXP-YR     PIC 99.                               CL**5
  3364         10  EC-EXP-MO         PIC 99.                               CL**5
  3365         10  EC-EXP-DA         PIC 99.                               CL**5
  3366     05  WS-EC-EXP-DTE-N REDEFINES                                   CL**5
  3367            WS-EC-EXP-DTE      PIC 9(11).                            CL**5
  3368     05  WS-EP-EFF-DTE.                                           ELCEPCVR
  3369         10  FILLER            PIC 999.                           ELCEPCVR
  3370         10  EP-EFF-CCYY       PIC 9(04).                         ELCEPCVR
  3371         10  EP-EFF-CCYR  REDEFINES  EP-EFF-CCYY.                 ELCEPCVR
  3372             15  EP-EFF-CC     PIC 99.                            ELCEPCVR
  3373             15  EP-EFF-YR     PIC 99.                            ELCEPCVR
  3374         10  EP-EFF-MO         PIC 99.                            ELCEPCVR
  3375         10  EP-EFF-DA         PIC 99.                            ELCEPCVR
  3376     05  WS-EP-EFF-DTE-N REDEFINES                                   CL**3
  3377            WS-EP-EFF-DTE      PIC 9(11).                            CL**3
  3378     05  WS-EC-EFF-DTE REDEFINES WS-EP-EFF-DTE.                      CL**5
  3379         10  FILLER            PIC 999.                              CL**5
  3380         10  EC-EFF-CCYY       PIC 9(04).                            CL**5
  3381         10  EC-EFF-CCYR  REDEFINES  EC-EFF-CCYY.                    CL**5
  3382             15  EC-EFF-CC     PIC 99.                               CL**5
  3383             15  EC-EFF-YR     PIC 99.                               CL**5
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  69
* ECS010T1.cbl (/apps/prod/cid1p/copy/ELCEPCVR)
  3384         10  EC-EFF-MO         PIC 99.                               CL**5
  3385         10  EC-EFF-DA         PIC 99.                               CL**5
  3386     05  WS-EC-EFF-DTE-N REDEFINES                                   CL**5
  3387            WS-EC-EFF-DTE      PIC 9(11).                            CL**5
  3388     05  WS-EP-HI-COV-DT.                                         ELCEPCVR
  3389         10  FILLER            PIC 999.                           ELCEPCVR
  3390         10  EP-COV-CCYY       PIC 9(04).                         ELCEPCVR
  3391         10  EP-COV-CCYR  REDEFINES  EP-COV-CCYY.                 ELCEPCVR
  3392             15  EP-COV-CC     PIC 99.                            ELCEPCVR
  3393             15  EP-COV-YR     PIC 99.                            ELCEPCVR
  3394         10  EP-COV-MO         PIC 99.                            ELCEPCVR
  3395         10  EP-COV-DA         PIC 99.                            ELCEPCVR
  3396     05  WS-EP-HI-COV-DT-N REDEFINES                                 CL**3
  3397            WS-EP-HI-COV-DT    PIC 9(11).                            CL**3
  3398     05  WS-EP-HI-CERT.                                           ELCEPCVR
  3399         10  FILLER            PIC 999.                           ELCEPCVR
  3400         10  EP-HI-CCYY        PIC 9(04).                         ELCEPCVR
  3401         10  EP-HI-CCYR  REDEFINES  EP-HI-CCYY.                   ELCEPCVR
  3402             15  EP-HI-CC      PIC 99.                            ELCEPCVR
  3403             15  EP-HI-YR      PIC 99.                            ELCEPCVR
  3404         10  EP-HI-MO          PIC 99.                            ELCEPCVR
  3405         10  EP-HI-DA          PIC 99.                            ELCEPCVR
  3406     05  WS-EP-HI-CERT-N REDEFINES                                   CL**3
  3407            WS-EP-HI-CERT      PIC 9(11).                            CL**3
  3408     05  WS-EP-LO-CERT.                                           ELCEPCVR
  3409         10  FILLER            PIC 999.                           ELCEPCVR
  3410         10  EP-LO-CCYY        PIC 9(04).                         ELCEPCVR
  3411         10  EP-LO-CCYR  REDEFINES   EP-LO-CCYY.                  ELCEPCVR
  3412             15  EP-LO-CC      PIC 99.                            ELCEPCVR
  3413             15  EP-LO-YR      PIC 99.                            ELCEPCVR
  3414         10  EP-LO-MO          PIC 99.                            ELCEPCVR
  3415         10  EP-LO-DA          PIC 99.                            ELCEPCVR
  3416     05  WS-EP-LO-CERT-N REDEFINES                                   CL**3
  3417            WS-EP-LO-CERT      PIC 9(11).                            CL**3
  3418     05  WS-EP-RUN-DTE.                                           ELCEPCVR
  3419         10  FILLER            PIC 999.                           ELCEPCVR
  3420         10  EP-RUN-CCYY       PIC 9(04).                         ELCEPCVR
  3421         10  EP-RUN-CCYR  REDEFINES  EP-RUN-CCYY.                 ELCEPCVR
  3422             15  EP-RUN-CC     PIC 99.                            ELCEPCVR
  3423             15  EP-RUN-YR     PIC 99.                            ELCEPCVR
  3424         10  EP-RUN-MO         PIC 99.                            ELCEPCVR
  3425         10  EP-RUN-DA         PIC 99.                            ELCEPCVR
  3426     05  WS-EP-RUN-DTE-N REDEFINES                                   CL**3
  3427            WS-EP-RUN-DTE      PIC 9(11).                            CL**3
  3428     05  WS-EC-RUN-DTE REDEFINES WS-EP-RUN-DTE.                      CL**5
  3429         10  FILLER            PIC 999.                           ELCEPCVR
  3430         10  EC-RUN-CCYY       PIC 9(04).                         ELCEPCVR
  3431         10  EC-RUN-CCYR  REDEFINES  EC-RUN-CCYY.                 ELCEPCVR
  3432             15  EC-RUN-CC     PIC 99.                            ELCEPCVR
  3433             15  EC-RUN-YR     PIC 99.                            ELCEPCVR
  3434         10  EC-RUN-MO         PIC 99.                            ELCEPCVR
  3435         10  EC-RUN-DA         PIC 99.                            ELCEPCVR
  3436     05  WS-EC-RUN-DTE-N REDEFINES                                   CL**3
  3437            WS-EC-RUN-DTE      PIC 9(11).                            CL**3
  3438
* 3439                             COPY ELCREINV.
  3440******************************************************************04/18/98
  3441*                                                                *ELCREINV
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  70
* ECS010T1.cbl (/apps/prod/cid1p/copy/ELCREINV)
  3442*                                                                *ELCREINV
  3443*                            ELCREINV                            *   LV003
  3444*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  3445*                            VMOD=2.001                          *ELCREINV
  3446*                                                                *ELCREINV
  3447*   WORKING STORAGE FOR DATE VARIABLES CREATED                   *ELCREINV
  3448*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCREINV
  3449*                                                                *ELCREINV
  3450******************************************************************ELCREINV
  3451                                                                  ELCREINV
  3452 01  WS-REINSURANCE-RECORD-DATE.                                  ELCREINV
  3453     05  WS-RE-LO-DATE.                                              CL**3
  3454         10 FILLER                     PIC 999.                      CL**3
  3455         10 RE-LO-CCYY                 PIC 9(04).                    CL**3
  3456         10 RE-LO-CCYR  REDEFINES  RE-LO-CCYY.                       CL**3
  3457            15 RE-LO-CC                PIC 99.                       CL**3
  3458            15 RE-LO-YR                PIC 99.                       CL**3
  3459         10 RE-LO-MO                   PIC 99.                       CL**3
  3460         10 RE-LO-DA                   PIC 99.                       CL**3
  3461     05  WS-RE-LO-DATE-N REDEFINES                                   CL**3
  3462            WS-RE-LO-DATE              PIC 9(11).                    CL**3
  3463     05  WS-RE-HI-DATE.                                              CL**3
  3464         10 FILLER                     PIC 999.                      CL**3
  3465         10 RE-HI-CCYY                 PIC 9(04).                    CL**3
  3466         10 RE-HI-CCYR  REDEFINES  RE-HI-CCYY.                       CL**3
  3467            15 RE-HI-CC                PIC 99.                       CL**3
  3468            15 RE-HI-YR                PIC 99.                       CL**3
  3469         10 RE-HI-MO                   PIC 99.                       CL**3
  3470         10 RE-HI-DA                   PIC 99.                       CL**3
  3471     05  WS-RE-HI-DATE-N REDEFINES                                   CL**3
  3472            WS-RE-HI-DATE              PIC 9(11).                    CL**3
  3473     05  WS-RE-CLM-INCURRED-LIM.                                  ELCREINV
  3474         10 FILLER                     PIC 999.                   ELCREINV
  3475         10 RE-CLM-CCYY                PIC 9(04).                 ELCREINV
  3476         10 RE-CLM-CCYR  REDEFINES  RE-CLM-CCYY.                  ELCREINV
  3477            15 RE-CLM-CC               PIC 99.                    ELCREINV
  3478            15 RE-CLM-YR               PIC 99.                    ELCREINV
  3479         10 RE-CLM-MO                  PIC 99.                    ELCREINV
  3480         10 RE-CLM-DA                  PIC 99.                    ELCREINV
  3481     05  WS-RE-CLM-INCURRED-LIM-N REDEFINES                          CL**2
  3482            WS-RE-CLM-INCURRED-LIM     PIC 9(11).                    CL**2
  3483     05  WS-RE-EARNING-START-DT.                                  ELCREINV
  3484         10  FILLER                    PIC 999.                   ELCREINV
  3485         10  RE-EARN-CCYY              PIC 9(04).                 ELCREINV
  3486         10  RE-EARN-CCYR  REDEFINES  RE-EARN-CCYY.               ELCREINV
  3487             15  RE-EARN-CC            PIC 99.                    ELCREINV
  3488             15  RE-EARN-YR            PIC 99.                    ELCREINV
  3489         10  RE-EARN-MO                PIC 99.                    ELCREINV
  3490         10  RE-EARN-DA                PIC 99.                    ELCREINV
  3491     05  WS-RE-EARNING-START-DT-N REDEFINES                          CL**2
  3492            WS-RE-EARNING-START-DT     PIC 9(11).                    CL**2
  3493     05  WS-RE-EARNING-STOP-DT.                                   ELCREINV
  3494         10  FILLER                    PIC 999.                   ELCREINV
  3495         10  RE-EARN-STOP-CCYY         PIC 9(04).                 ELCREINV
  3496         10  RE-EARN-STOP-CCYR  REDEFINES  RE-EARN-STOP-CCYY.     ELCREINV
  3497             15  RE-EARN-STOP-CC       PIC 99.                    ELCREINV
  3498             15  RE-EARN-STOP-YR       PIC 99.                    ELCREINV
  3499         10  RE-EARN-STOP-MO           PIC 99.                    ELCREINV
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  71
* ECS010T1.cbl (/apps/prod/cid1p/copy/ELCREINV)
  3500         10  RE-EARN-STOP-DA           PIC 99.                    ELCREINV
  3501     05  WS-RE-EARNING-STOP-DT-N REDEFINES                           CL**2
  3502            WS-RE-EARNING-STOP-DT      PIC 9(11).                    CL**2
  3503
  3504 01  RC-REIN-HOLD-AREAS.
  3505     12  RC-REIN-LEVELS  OCCURS 30.
  3506         16  RC-REIN-COMP    PIC X(6).
  3507         16  RC-OLD-ISS      PIC X.
  3508         16  RC-NEW-ISS      PIC X.
  3509         16  RC-OLD-CNC      PIC X.
  3510         16  RC-NEW-CNC      PIC X.
  3511         16  RC-OLD-LF-CLM   PIC X.
  3512         16  RC-OLD-AH-CLM   PIC X.
  3513         16  RC-NEW-LF-CLM   PIC X.
  3514         16  RC-NEW-AH-CLM   PIC X.
  3515         16  RC-REIN-LFAMT   PIC S9(9)V99    COMP-3.
  3516         16  RC-REIN-LFPRM   PIC S9(7)V99    COMP-3.
  3517         16  RC-REIN-AHAMT   PIC S9(7)V99    COMP-3.
  3518         16  RC-REIN-AHPRM   PIC S9(7)V99    COMP-3.
  3519         16  RC-REIN-LFRFND  PIC S9(7)V99    COMP-3.
  3520         16  RC-REIN-AHRFND  PIC S9(7)V99    COMP-3.
  3521         16  RC-REIN-LFCLM   PIC S9(9)V99    COMP-3.
  3522         16  RC-REIN-AHCLM   PIC S9(9)V99    COMP-3.
  3523         16  RC-REIN-REM-SW  PIC X.
  3524     12  RC-REIN-LEVELS-END  PIC X(6).
  3525
  3526 01  TOTAL-PAGES-COUNTERS    COMP-3.
  3527     12  TPC-COUNTERS    OCCURS 6.
  3528         16  TPL-ISS-PRM     PIC S9(9)V99.
  3529         16  TPA-ISS-PRM     PIC S9(9)V99.
  3530         16  TPL-CNC-PRM     PIC S9(9)V99.
  3531         16  TPA-CNC-PRM     PIC S9(9)V99.
  3532         16  TPL-ACCT-COM    PIC S9(9)V99.
  3533         16  TPA-ACCT-COM    PIC S9(9)V99.
  3534         16  TPL-CLAIMS      PIC S9(9)V99.
  3535         16  TPA-CLAIMS      PIC S9(9)V99.
  3536
  3537 01  HLD-DTS SYNC.
  3538     12  EOM-RUN-DATE        PIC 9(08).
  3539     12  EOM-RUN-DATE-R REDEFINES EOM-RUN-DATE.
  3540         16  EOM-CCYY.
  3541             20  EOM-CC      PIC 99.
  3542             20  EOM-YR      PIC 99.
  3543         16  EOM-MO          PIC 99.
  3544         16  EOM-DA          PIC 99.
  3545
  3546****   1ST OCCURRENCE IS MONTHEND DATE MINUS ONE MONTH
  3547****   2ND OCCURRENCE IS MONTHEND DATE MINUS TWO MONTHS
  3548     12  OB-RUN-DATES OCCURS 2.
  3549         16  OB-CCYY         PIC 9(4).
  3550         16  OB-MO           PIC 99.
  3551         16  OB-DA           PIC 99.
  3552
  3553     12  OB-DATE-1-SWITCH    PIC X           VALUE SPACE.
  3554         88  OB-DATE-1-USED     VALUE '*'.
  3555     12  OB-DATE-2-SWITCH    PIC X           VALUE SPACE.
  3556         88  OB-DATE-2-USED     VALUE '*'.
  3557     12  OB-DATE-3-SWITCH    PIC X           VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  72
* ECS010T1.cbl
  3558         88  OB-DATE-3-USED     VALUE '*'.
  3559     12  EARNING-START-DATE  PIC 9(08).
  3560     12  EARNING-START-DATE-R REDEFINES  EARNING-START-DATE.
  3561         16  E-ERN-START-CC  PIC 99.
  3562         16  E-ERN-START-YR  PIC 99.
  3563         16  E-ERN-START-MO  PIC 99.
  3564         16  E-ERN-START-DA  PIC 99.
  3565     12  EARNING-STOP-DATE   PIC 9(08).
  3566     12  EARNING-STOP-DATE-R REDEFINES  EARNING-STOP-DATE.
  3567         16  E-ERN-STOP-CC   PIC 99.
  3568         16  E-ERN-STOP-YR   PIC 99.
  3569         16  E-ERN-STOP-MO   PIC 99.
  3570         16  E-ERN-STOP-DA   PIC 99.
  3571     12  STOP-LF-DATE        PIC 9(08).
  3572     12  STOP-LF-DATE-R REDEFINES STOP-LF-DATE.
  3573         16  STOP-LF-CC      PIC 99.
  3574         16  STOP-LF-YR      PIC 99.
  3575         16  STOP-LF-MO      PIC 99.
  3576         16  STOP-LF-DA      PIC 99.
  3577     12  STOP-AH-DATE        PIC 9(08).
  3578     12  STOP-AH-DATE-R REDEFINES STOP-AH-DATE.
  3579         16  STOP-AH-CC      PIC 99.
  3580         16  STOP-AH-YR      PIC 99.
  3581         16  STOP-AH-MO      PIC 99.
  3582         16  STOP-AH-DA      PIC 99.
  3583     12  BIN-VALUATION-DT    PIC XX.
  3584     12  BIN-EOM-RUN-DATE    PIC XX.
  3585     12  LAST-YRS-DATE       PIC 9(08).
  3586     12  LAST-YRS-DATE-R  REDEFINES  LAST-YRS-DATE.
  3587         16  LYD-CCYY        PIC 9(04).
  3588         16  LYD-CCYR REDEFINES LYD-CCYY.
  3589             20  LYD-CC      PIC 99.
  3590             20  LYD-YR      PIC 99.
  3591         16  LYD-MO          PIC 99.
  3592         16  LYD-DA          PIC 99.
  3593     12  VALUATION-DT        PIC 9(08)  VALUE 0.
  3594     12  VALUATION-DT-R REDEFINES VALUATION-DT.
  3595         16  VAL-CC          PIC 99.
  3596         16  VAL-YR          PIC 99.
  3597         16  VAL-MO          PIC 99.
  3598         16  VAL-DA          PIC 99.
  3599     12  INCURRED-DATE       PIC 9(08).
  3600     12  INCURRED-DATE-R REDEFINES INCURRED-DATE.
  3601         16  DTO-CC          PIC 99.
  3602         16  DTO-YR          PIC 99.
  3603         16  DTO-MO          PIC 99.
  3604         16  DTO-DA          PIC 99.
  3605     12  REPORTED-DATE.
  3606         16  RPT-YR          PIC 99.
  3607         16  RPT-MO          PIC 99.
  3608         16  RPT-DA          PIC 99.
  3609     12  PAYMENT-DATE        PIC 9(08).
  3610     12  PAYMENT-DATE-R REDEFINES PAYMENT-DATE.
  3611         16  PAY-CC          PIC 99.
  3612         16  PAY-YR          PIC 99.
  3613         16  PAY-MO          PIC 99.
  3614         16  PAY-DA          PIC 99.
  3615     12  PAY-TO-DATE         PIC 9(8).
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  73
* ECS010T1.cbl
  3616     12  PAY-TO-DATE-R  REDEFINES PAY-TO-DATE.
  3617         16  PAYTO-CC        PIC 99.
  3618         16  PAYTO-YR        PIC 99.
  3619         16  PAYTO-MO        PIC 99.
  3620         16  PAYTO-DA        PIC 99.
  3621
  3622 01  AH-RES-STATE-TABLE.
  3623     12  FILLER              PIC X(42)       VALUE
  3624             'AKALAZCADEGAIDILKSKYLAMDMIMTNVOHORSCSDWIWY'.
  3625     12  FILLER              PIC XX          VALUE HIGH-VALUES.
  3626
  3627 01  AH-RES-STATE-TAB REDEFINES AH-RES-STATE-TABLE.
  3628     12  AH-RES-STATE-ENT    PIC XX      OCCURS 22 TIMES.
  3629
  3630 01  BILLING-COUNTERS    COMP-3.
  3631     12  BC-NET-WRIT         PIC S9(7)V99        VALUE +0.
  3632     12  BC-NET-WRIT-SP      PIC S9(7)V99        VALUE +0.
  3633     12  BC-NET-WRIT-OB      PIC S9(7)V99        VALUE +0.
  3634     12  BC-G-ISS            PIC S9(5)           VALUE +0.
  3635     12  BC-G-CNC            PIC S9(5)           VALUE +0.
  3636     12  BC-G-CLM            PIC S9(5)           VALUE +0.
  3637     12  BC-G-CRS            PIC S9(5)           VALUE +0.
  3638     12  BC-G-CTN            PIC S9(5)           VALUE +0.
  3639     12  BC-R-ISS            PIC S9(5)           VALUE +0.
  3640     12  BC-R-CNC            PIC S9(5)           VALUE +0.
  3641     12  BC-R-CLM            PIC S9(5)           VALUE +0.
  3642     12  BC-R-CRS            PIC S9(5)           VALUE +0.
  3643     12  BC-R-CTN            PIC S9(5)           VALUE +0.
  3644     12  BC-COMM             PIC S9(5)           VALUE +0.
  3645     12  BC-NEW-ACCTS        PIC S9(5)           VALUE +0.
  3646     12  BC-ACCTS            PIC S9(5)           VALUE +0.
  3647     12  BC-ACT-ACCTS        PIC S9(5)           VALUE +0.
  3648     12  BC-G-CERTS          PIC S9(7)           VALUE +0.
  3649     12  BC-G-A-CERTS        PIC S9(7)           VALUE +0.
  3650     12  BC-R-CERTS          PIC S9(7)           VALUE +0.
  3651     12  BC-R-A-CERTS        PIC S9(7)           VALUE +0.
  3652     12  BC-ER-ACCTS         PIC S9(5)           VALUE +0.
  3653     12  BC-CS-ACCTS         PIC S9(5)           VALUE +0.
  3654     12  ACTIVE-COUNT        PIC S9              VALUE +0.
  3655
  3656 01  FLAGS SYNC.
  3657     12  BILLED-SWITCH           PIC X           VALUE 'N'.
  3658         88  CHECK-BILLED                        VALUE 'Y'.
  3659     12  TRANS-EOF-FLAG          PIC X           VALUE SPACE.
  3660         88  EOF-ON-TRANS                        VALUE '*'.
  3661     12  CERT-EOF-FLAG           PIC X           VALUE SPACE.
  3662         88  EOF-ON-CERT                         VALUE '*'.
  3663     12  PROCESSING-FLAG         PIC X           VALUE SPACE.
  3664         88  PROCESSING-COMPLETED                VALUE '*'.
  3665     12  DEATH-VOID-FLAG         PIC X           VALUE SPACE.
  3666         88  DEATH-CLAIM-VOIDED                  VALUE '*'.
  3667     12  CERT-CHANGE-FLAG        PIC X           VALUE SPACE.
  3668         88  PRINTING-CERT-CHANGES               VALUE '*'.
  3669     12  STATUTORY-SWITCH        PIC X           VALUE SPACE.
  3670         88  STATUTORY-REQUIREMENT               VALUE '*'.
  3671     12  STATUTORY-SWITCH-AH     PIC X           VALUE SPACE.
  3672         88  STATUTORY-REQUIREMENT-AH            VALUE '*'.
  3673     12  LIFE-EARNED-SWITCH      PIC X           VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  74
* ECS010T1.cbl
  3674         88  LIFE-FULLY-EARNED                   VALUE '*'.
  3675     12  A-H-EARNED-SWITCH       PIC X           VALUE SPACE.
  3676         88  A-H-FULLY-EARNED                    VALUE '*'.
  3677     12  CNCL-FLG            PIC X               VALUE SPACE.
  3678     12  TRANSACTION-FLAG    PIC X               VALUE SPACE.
  3679         88  NO-TRANSACTION-WAS-PROCESSED    VALUE SPACE.
  3680         88  TRANSACTION-WAS-PROCESSED       VALUE '*'.
  3681     12  RISK-REIN-FLAG      PIC X               VALUE SPACE.
  3682         88  REIN-IS-RISK-PREMIUM            VALUE '*'.
  3683     12  RISK-PREM-FLAG      PIC X               VALUE SPACE.
  3684         88  UPDATING-RISK-PREMIUMS          VALUE '*'.
  3685     12  EP-FLG              PIC X               VALUE SPACE.
  3686     12  END-FLG             PIC X               VALUE SPACE.
  3687     12  PRIOR-MATCH-CNTRL   PIC X(36)           VALUE LOW-VALUE.
  3688     12  PRIOR-CERT-IN-CNTRL PIC X(36)           VALUE LOW-VALUE.
  3689     12  ACCT-FLG            PIC X               VALUE SPACE.
  3690     12  STATE-FLG           PIC X               VALUE SPACE.
  3691     12  COMP-FLG            PIC X               VALUE SPACE.
  3692     12  CARR-FLG            PIC X               VALUE SPACE.
  3693     12  FINAL-FLG           PIC X               VALUE SPACE.
  3694     12  LOW-CTL             PIC X(19)           VALUE SPACES.
  3695     12  REIN-FLG            PIC X               VALUE SPACE.
  3696     12  REIN-EP-FLG         PIC X               VALUE SPACE.
  3697     12  REIN-RT-SW          PIC X               VALUE SPACE.
  3698
  3699 01  TEXAS-REG-WORK-AREAS   SYNC.
  3700     12  TEX-FACT-1          PIC S9(9)V99    COMP-3.
  3701     12  TEX-FACT-2          PIC S999        COMP-3.
  3702     12  TEX-FACT-3          PIC S999        COMP-3.
  3703     12  TEX-FACT-4          PIC S9(7)       COMP-3.
  3704     12  TEX-FACT-5          PIC S999        COMP-3.
  3705     12  TEX-FACT-6          PIC S999        COMP-3.
  3706     12  TEX-FACT-7          PIC S9(7)       COMP-3.
  3707     12  TEX-FACT-8          PIC S9V9(6)     COMP-3.
  3708     12  TEX-FACT-9          PIC S9(4)V9(11) COMP-3.
  3709
  3710 01  NET-PAY-INTERFACE.
  3711     12  NP-APR              PIC S999V9(4)   COMP-3.
  3712     12  NP-ORIG             PIC S999        COMP-3.
  3713     12  NP-REM              PIC S999        COMP-3.
  3714     12  NP-OPT              PIC X.
  3715     12  NP-CAP              PIC S999        COMP-3.
  3716     12  NP-FACTOR           PIC S9(4)V9(9)  COMP-3.
  3717     12  NP-WORK1            PIC S9(9)V9(9)  COMP-3.
  3718     12  NP-WORK2            PIC S9(9)V9(9)  COMP-3.
  3719     12  NP-BENEFIT          PIC S9(9)V99    COMP-3.
  3720     12  NP-REMAINING        PIC S9(9)V99    COMP-3.
  3721     12  NP-AHPRM            PIC S9(7)V99    COMP-3.
  3722     12  NP-ACCOUNT          PIC X(10).
  3723
  3724 01  HOLDERS SYNC.
  3725     12  DIS-IBNR            PIC S9(7)V99 COMP-3 VALUE +0.
  3726     12  DIS-PAYCUR          PIC S9(7)V99 COMP-3 VALUE +0.
  3727     12  DIS-FUTRSV          PIC S9(7)V99 COMP-3 VALUE +0.
  3728     12  DTH-IBNR            PIC S9(7)V99 COMP-3 VALUE +0.
  3729     12  DTH-PAYCUR          PIC S9(7)V99 COMP-3 VALUE +0.
  3730     12  DTH-FUTRSV          PIC S9(7)V99 COMP-3 VALUE +0.
  3731     12  EXCESS-RESERVE      PIC S9(7)V99 COMP-3 VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  75
* ECS010T1.cbl
  3732     12  H-LFCM              PIC S9(9)V99 COMP-3 VALUE +0.
  3733     12  H-AHCM              PIC S9(9)V99 COMP-3 VALUE +0.
  3734     12  TEMP-1              PIC S9(5)V99 COMP-3 VALUE +0.
  3735     12  TEMP-2              PIC S9(5)V99 COMP-3 VALUE +0.
  3736     12  TEMP-3              PIC S9(5)V99 COMP-3 VALUE +0.
  3737     12  TEMP-4              PIC S9V9(6)  COMP-3 VALUE +0.
  3738     12  TEMP-5              PIC S9V9(6)  COMP-3 VALUE +0.
  3739     12  TEMP-6              PIC S99V9(6) COMP-3 VALUE +0.
  3740     12  TEMP-7              PIC S9(9)V99 COMP-3 VALUE +0.
  3741     12  TEMP-8              PIC S9(9)V99 COMP-3 VALUE +0.
  3742     12  REM-TRM1            PIC S999V99  COMP-3.
  3743     12  REM-TRM2            PIC S999V99  COMP-3.
  3744     12  REM-TRM3            PIC S999V99  COMP-3.
  3745     12  TEM-TRM1            PIC S999V99  COMP-3.
  3746     12  MAX-REM-TERM        PIC S999V99  COMP-3.
  3747     12  ORIG-TERM           PIC S999V99  COMP-3.
  3748     12  HLD-CONTROL.
  3749         16  HLD-CARRIER     PIC X               VALUE SPACES.
  3750         16  HLD-GROUPING    PIC X(6)            VALUE SPACES.
  3751         16  HLD-STATE       PIC XX              VALUE SPACES.
  3752         16  HLD-ACCT        PIC X(10)           VALUE SPACES.
  3753     12  LN-MX               PIC S999     COMP-3 VALUE +56.
  3754
  3755 01  DISPLAY-IBNR-LINE.
  3756     05  FILLER                  PIC X       VALUE SPACES.
  3757     05  DIL-COMMENT             PIC X(20)   VALUE SPACES.
  3758     05  FILLER                  PIC XX      VALUE SPACES.
  3759     05  DIL-TYPE                PIC X       VALUE SPACES.
  3760     05  FILLER                  PIC X       VALUE SPACES.
  3761     05  DIL-BEN-CODE            PIC ZZ      VALUE SPACES.
  3762     05  FILLER                  PIC XXX     VALUE SPACES.
  3763     05  DIL-AMOUNT              PIC ZZZ9.99999-.
  3764
  3765 01  DISPLAY-HD-1.
  3766     05  FILLER      PIC X       VALUE SPACES.
  3767     05  FILLER      PIC X(50)   VALUE SPACES.
  3768     05  FILLER      PIC X(23)   VALUE 'PROCESSING ERROR REPORT'.
  3769     05  FILLER      PIC X(51)   VALUE SPACES.
  3770     05  FILLER      PIC X(8)    VALUE 'ECS010 '.
  3771
  3772 01  DISPLAY-HD-2.
  3773     05  FILLER                 PIC X       VALUE SPACE.
  3774     05  FILLER                 PIC X(57)   VALUE SPACES.
  3775     05  DIS-DATE               PIC X(8).
  3776     05  FILLER                 PIC X(66)   VALUE SPACES.
  3777
  3778 01  DISPLAY-LINE.
  3779     05  DL-FULL.
  3780         10  FILLER           PIC X       VALUE SPACE.
  3781         10  DIS-LINE-REASON  PIC X(32)   VALUE SPACES.
  3782         10  DIS-LINE-REC     PIC X(100)  VALUE SPACES.
  3783
  3784 01  PRT-HDNGS SYNC.
  3785     12  TR-HD-1.
  3786         16  FILLER      PIC X       VALUE '1'.
  3787         16  FILLER      PIC X(53)   VALUE SPACES.
  3788         16  FILLER      PIC X(18)   VALUE 'TRANSACTION REPORT'.
  3789         16  FILLER      PIC X(48)   VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  76
* ECS010T1.cbl
  3790         16  FILLER      PIC X(8)    VALUE 'ECS010 '.
  3791     12  TR-HD-2.
  3792         16  FILLER      PIC X       VALUE SPACE.
  3793         16  FILLER      PIC X(47)   VALUE SPACES.
  3794         16  TRHDNM      PIC X(30).
  3795         16  FILLER      PIC X(42)   VALUE SPACES.
  3796         16  TR-RN-DT    PIC X(8).
  3797     12  TR-HD-3.
  3798         16  FILLER      PIC X       VALUE SPACE.
  3799         16  FILLER      PIC X(53)   VALUE SPACES.
  3800         16  TR-MODAYR   PIC X(18).
  3801         16  FILLER      PIC X       VALUE SPACE.
  3802         16  TR-YRASK    PIC X       VALUE SPACE.
  3803         16  FILLER      PIC X(46)   VALUE SPACES.
  3804         16  FILLER      PIC X(5)    VALUE 'PAGE '.
  3805         16  TR-PG       PIC ZZ,ZZ9.
  3806     12  TR-HD-4.
  3807         16  FILLER      PIC X       VALUE SPACE.
  3808         16  TR-AGCY     PIC X(30).
  3809     12  TR-HD-5.
  3810         16  FILLER      PIC X       VALUE SPACE.
  3811         16  TR-CARR     PIC X.
  3812         16  FILLER      PIC X       VALUE '-'.
  3813         16  TR-GROUP    PIC X(6).
  3814         16  FILLER      PIC X       VALUE '-'.
  3815         16  TR-ST-NO    PIC X(2).
  3816         16  FILLER      PIC X       VALUE '-'.
  3817         16  TR-AG-NO    PIC X(10).
  3818         16  FILLER      PIC X(23)   VALUE SPACES.
  3819         16  TR5-RP-TYP.
  3820             20  FILLER  PIC X(20)   VALUE
  3821                     '* * * * TRANSACTION '.
  3822             20  FILLER  PIC X(15)   VALUE 'LISTING * * * *'.
  3823     12  TR-HD-6.
  3824         16  FILLER      PIC X       VALUE SPACE.
  3825         16  TR-CE-MO    PIC XX.
  3826         16  FILLER      PIC X       VALUE '-'.
  3827         16  TR-CE-DA    PIC XX.
  3828         16  FILLER      PIC X       VALUE '-'.
  3829         16  TR-CE-YR    PIC XX.
  3830         16  FILLER      PIC X(6)    VALUE '  TO  '.
  3831         16  TR-CX.
  3832             20  TR-CX-MO PIC XX.
  3833             20  HSHR1    PIC X.
  3834             20  TR-CX-DA PIC XX.
  3835             20  HSHR2    PIC X.
  3836             20  TR-CX-YR PIC XX.
  3837     12  TR-HD-7.
  3838         16  FILLER  PIC X      VALUE '0'.
  3839         16  FILLER  PIC X(24)  VALUE SPACES.
  3840         16  FILLER  PIC X(19)  VALUE '*----------------- '.
  3841         16  TR-7-LF PIC X(6).
  3842         16  FILLER  PIC X(9)   VALUE ' COVERAGE'.
  3843         16  FILLER  PIC X(19)  VALUE ' -----------------*'.
  3844         16  FILLER  PIC X(20)  VALUE '  *---------------- '.
  3845         16  TR-7-AH PIC X(6).
  3846         16  FILLER  PIC X(10)  VALUE ' COVERAGE '.
  3847         16  FILLER  PIC X(19)  VALUE ' -----------------*'.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  77
* ECS010T1.cbl
  3848     12  TR-HD-8.
  3849         16  FILLER  PIC X      VALUE SPACE.
  3850         16  FILLER  PIC X(24)  VALUE '   CERT      ISSUE      '.
  3851         16  FILLER  PIC X(24)  VALUE '        PREMIUM    COMMI'.
  3852         16  FILLER  PIC X(24)  VALUE 'SSION   ACTION          '.
  3853         16  FILLER  PIC X(24)  VALUE '                PREMIUM '.
  3854         16  FILLER  PIC X(22)  VALUE '   COMMISSION   ACTION'.
  3855     12  TR-HD-9.
  3856         16  FILLER  PIC X      VALUE SPACE.
  3857         16  FILLER  PIC X(24)  VALUE '  NUMBER      DATE  AGE '.
  3858         16  FILLER  PIC X(24)  VALUE 'TYP TRM  / REFUND    /  '.
  3859         16  FILLER  PIC X(24)  VALUE 'CLAIM    DATE     ACTION'.
  3860         16  FILLER  PIC X(24)  VALUE '  ST    TYP TRM  / REFUN'.
  3861         16  FILLER  PIC X(24)  VALUE 'D    /  CLAIM    DATE   '.
  3862         16  FILLER  PIC X(12)  VALUE '  ACTION  ST'.
  3863     12  TR-TTL-HD.
  3864         16  FILLER      PIC X       VALUE '0'.
  3865         16  TTL-PT-CNT  PIC ZZZZ,ZZZ,ZZZ,ZZ9.
  3866         16  FILLER      PIC XX      VALUE SPACES.
  3867         16  TTL-HD-DS   PIC X(60)   VALUE
  3868             'ECS010 CONTROL TOTALS'.
  3869
  3870 01  TR-DTL.
  3871     12  FILLER                  PIC X           VALUE SPACE.
  3872     12  TR-DTL1.
  3873         16  TRD-CERT            PIC X(11).
  3874         16  TRD-ISDT.
  3875             20  FILLER          PIC X           VALUE SPACE.
  3876             20  TRD-ISMO        PIC XX.
  3877             20  TRD-IS-S1       PIC X           VALUE '/'.
  3878             20  TRD-ISDA        PIC XX.
  3879             20  TRD-IS-S2       PIC X           VALUE '/'.
  3880             20  TRD-ISYR        PIC XX.
  3881             20  FILLER          PIC X           VALUE SPACE.
  3882         16  TRD-AGE             PIC XX.
  3883     12  TR-DTL2.
  3884         16  FILLER              PIC X           VALUE SPACE.
  3885         16  TRD-LFTYP           PIC XXX.
  3886         16  FILLER              PIC X           VALUE SPACE.
  3887         16  TRD-LFTRM           PIC ZZ9.
  3888         16  TRD-LFPRM-RFND      PIC ZZZZ,ZZZ.99  BLANK WHEN ZERO.
  3889         16  TRD-LFCOM-CLM       PIC ZZZZ,ZZZ.99- BLANK WHEN ZERO.
  3890         16  TRD-LFACTDT.
  3891             20  FILLER          PIC X           VALUE SPACE.
  3892             20  TRD-LFACTMO     PIC XX.
  3893             20  TRD-LF-S1       PIC X           VALUE '/'.
  3894             20  TRD-LFACTDA     PIC XX.
  3895             20  TRD-LF-S2       PIC X           VALUE '/'.
  3896             20  TRD-LFACTYR     PIC XX.
  3897             20  FILLER          PIC X           VALUE SPACE.
  3898         16  TRD-LF-ACTION       PIC X(10)       VALUE SPACE.
  3899         16  FILLER              PIC X           VALUE SPACE.
  3900         16  TRD-LF-STATUS       PIC X.
  3901         16  FILLER              PIC X(4)        VALUE SPACE.
  3902         16  TRD-AHTYP           PIC XXX.
  3903         16  FILLER              PIC X           VALUE SPACE.
  3904         16  TRD-AHTRM           PIC ZZ9.
  3905         16  TRD-AHPRM-RFND      PIC ZZZZ,ZZZ.99  BLANK WHEN ZERO.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  78
* ECS010T1.cbl
  3906         16  TRD-AHCOM-CLM       PIC ZZZZ,ZZZ.99- BLANK WHEN ZERO.
  3907         16  TRD-AHACTDT.
  3908             20  FILLER          PIC X           VALUE SPACE.
  3909             20  TRD-AHACTMO     PIC XX.
  3910             20  TRD-AH-S1       PIC X           VALUE '/'.
  3911             20  TRD-AHACTDA     PIC XX.
  3912             20  TRD-AH-S2       PIC X           VALUE '/'.
  3913             20  TRD-AHACTYR     PIC XX.
  3914             20  FILLER          PIC X           VALUE SPACE.
  3915         16  TRD-AH-ACTION       PIC X(10)       VALUE SPACE.
  3916         16  FILLER              PIC X           VALUE SPACE.
  3917         16  TRD-AH-STATUS       PIC X.
  3918     12  TR-DTL3 REDEFINES TR-DTL2.
  3919         16  FILLER              PIC X(20).
  3920         16  TRD-IBNR            PIC ZZZ,ZZZ.99-.
  3921         16  FILLER              PIC X.
  3922         16  TRD-IBNRX           PIC X(4).
  3923         16  FILLER              PIC X(2).
  3924         16  TRD-PAYCUR          PIC ZZZ,ZZZ.99-.
  3925         16  TRD-PAYCUR-SPACE REDEFINES TRD-PAYCUR
  3926                                 PIC X(11).
  3927         16  FILLER              PIC X.
  3928         16  TRD-PAYCURX         PIC X(8).
  3929         16  FILLER              PIC X(2).
  3930         16  TRD-FUTRSV-DATA.
  3931             20  TRD-FUTRSV      PIC ZZZ,ZZZ.99-.
  3932             20  TRD-FUTRSV-SPACE REDEFINES TRD-FUTRSV
  3933                                 PIC X(11).
  3934             20  FILLER          PIC X.
  3935             20  TRD-FUTRSVX     PIC X(6).
  3936         16  TRD-BENEFIT-DATA REDEFINES TRD-FUTRSV-DATA.
  3937             20  TRD-BENEFIT-X   PIC X(10).
  3938             20  TRD-BENEFIT-CODE
  3939                                 PIC X(02).
  3940             20  FILLER          PIC X(06).
  3941         16  FILLER              PIC X(4).
  3942         16  TRD-RSV-DESC        PIC X(6).
  3943         16  TRD-RSV-ACTION      PIC X(21).
  3944
  3945 01  DET-PR-UREC.
  3946     12  FILLER              PIC X(7)     VALUE ' AGE - '.
  3947     12  DET-AGE             PIC 99         BLANK WHEN ZERO.
  3948     12  FILLER              PIC X(11)    VALUE ' JT. AGE - '.
  3949     12  DET-JT-AGE          PIC 99         BLANK WHEN ZERO.
  3950     12  FILLER              PIC X(7)     VALUE ' SEX - '.
  3951     12  DET-SEX             PIC X.
  3952     12  FILLER              PIC X(9)     VALUE '   APR - '.
  3953     12  DET-PR-APR          PIC Z9.999     BLANK WHEN ZERO.
  3954     12  FILLER              PIC X(9)     VALUE '  MEM# - '.
  3955     12  DET-PR-MEM          PIC X(12).
  3956     12  FILLER              PIC X(9)     VALUE '   SS# - '.
  3957     12  DET-PR-SS           PIC X(11).
  3958     12  FILLER              PIC XXX      VALUE SPACES.
  3959     12  DET-1-ACTION        PIC X(20)    VALUE ' MAINTENANCE'.
  3960
  3961 01  DET-PR-UREC-2.
  3962     12  FILLER              PIC X        VALUE SPACE.
  3963     12  DET-LF-DESC         PIC XX.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  79
* ECS010T1.cbl
  3964     12  FILLER              PIC X(10)    VALUE ' TERM CHG '.
  3965     12  DET-O-LF-TERM       PIC 999        BLANK WHEN ZERO.
  3966     12  FILLER              PIC X(4)     VALUE ' TO '.
  3967     12  DET-N-LF-TERM       PIC 999        BLANK WHEN ZERO.
  3968     12  FILLER              PIC X        VALUE SPACE.
  3969     12  DET-AH-DESC         PIC XX.
  3970     12  FILLER              PIC X(10)    VALUE ' TERM CHG '.
  3971     12  DET-O-AH-TERM       PIC 999        BLANK WHEN ZERO.
  3972     12  FILLER              PIC X(4)     VALUE ' TO '.
  3973     12  DET-N-AH-TERM       PIC 999        BLANK WHEN ZERO.
  3974     12  FILLER              PIC X(12)    VALUE ' OLD LIVES -'.
  3975     12  DET-O-LIVES         PIC ZZZZ999    BLANK WHEN ZERO.
  3976     12  FILLER              PIC X(12)    VALUE ' NEW LIVES -'.
  3977     12  DET-N-LIVES         PIC ZZZZ999    BLANK WHEN ZERO.
  3978     12  FILLER              PIC X(5)     VALUE SPACES.
  3979     12  DET-2-ACTION        PIC X(20)    VALUE ' MAINTENANCE'.
  3980
  3981 01  DET-PR-UREC-3.
  3982     12  FILLER              PIC X(7)     VALUE ' I/G - '.
  3983     12  DET-IND-GRP         PIC X.
  3984     12  FILLER              PIC X(13)    VALUE '  PMT FREQ - '.
  3985     12  DET-PMT-FREQ        PIC 99         BLANK WHEN ZERO.
  3986     12  FILLER              PIC X(14)    VALUE '  POL FORM# - '.
  3987     12  DET-POL-FORM        PIC X(12).
  3988     12  FILLER              PIC X(14)    VALUE '  LOAN OFF# - '.
  3989     12  DET-LOAN-OFFICER    PIC XXX.
  3990     12  FILLER              PIC X(14)    VALUE '  USER CODE - '.
  3991     12  DET-USER-CODE       PIC X.
  3992     12  FILLER              PIC X(8)     VALUE SPACES.
  3993     12  DET-3-ACTION        PIC X(20)    VALUE ' MAINTENANCE'.
  3994
  3995 01  DET-PR-UREC-4.
  3996     12  FILLER              PIC X(18) VALUE ' CLM DEDUCT AMT - '.
  3997     12  DET-CLM-DEDUCT      PIC 99999.99   BLANK WHEN ZERO.
  3998     12  FILLER              PIC X(18) VALUE ' CAN DEDUCT AMT - '.
  3999     12  DET-CAN-DEDUCT      PIC 99999.99   BLANK WHEN ZERO.
  4000     12  FILLER              PIC X(37)    VALUE SPACES.
  4001     12  DET-3-ACTION        PIC X(20)    VALUE ' MAINTENANCE'.
  4002
  4003 01  DET-PR-UREC-5.
  4004     12  FILLER              PIC X(13) VALUE ' LF BEN CD - '.
  4005     12  DET-LF-BEN-CD       PIC XX.
  4006     12  FILLER              PIC X(11) VALUE ' LF PREM - '.
  4007     12  DET-LF-PREM         PIC ZZZZZZZ.99   BLANK WHEN ZERO.
  4008     12  FILLER              PIC X(11) VALUE ' LF BENE - '.
  4009     12  DET-LF-BEN          PIC ZZZZZZZZZ.99   BLANK WHEN ZERO.
  4010     12  FILLER              PIC X(30)    VALUE SPACES.
  4011     12  DET-3-ACTION        PIC X(20)    VALUE ' MAINTENANCE'.
  4012
  4013 01  DET-PR-UREC-6.
  4014     12  FILLER              PIC X(13) VALUE ' AH BEN CD - '.
  4015     12  DET-AH-BEN-CD       PIC XX.
  4016     12  FILLER              PIC X(11) VALUE ' AH PREM - '.
  4017     12  DET-AH-PREM         PIC ZZZZZZZ.99   BLANK WHEN ZERO.
  4018     12  FILLER              PIC X(11) VALUE ' AH BENE - '.
  4019     12  DET-AH-BEN          PIC ZZZZZZZZZ.99   BLANK WHEN ZERO.
  4020     12  FILLER              PIC X(30)    VALUE SPACES.
  4021     12  DET-3-ACTION        PIC X(20)    VALUE ' MAINTENANCE'.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  80
* ECS010T1.cbl
  4022
  4023 01  WS-CHANGE-REC-SW        PIC X  VALUE 'N'.
  4024     88  WS-CHANGE-REC              VALUE 'Y'.
  4025
  4026 01  TOTAL-PAGE-HD1.
  4027     12  FILLER              PIC X               VALUE SPACE.
  4028     12  TPH1-TYPE           PIC X(8).
  4029     12  TPH1-DESC.
  4030         16  TPH1-ST-CODE    PIC XX.
  4031         16  FILLER          PIC XXX.
  4032         16  TPH1-ST-DESC    PIC X(20).
  4033
  4034 01  TOTAL-PAGE-HD2.
  4035     12  FILLER              PIC X           VALUE SPACE.
  4036     12  TPH2-DESC           PIC X(20)       VALUE SPACES.
  4037     12  FILLER              PIC X(7)        VALUE 'WRITTEN'.
  4038     12  FILLER              PIC X(9)        VALUE SPACES.
  4039     12  FILLER              PIC X(9)        VALUE 'CANCELLED'.
  4040     12  FILLER              PIC X(11)       VALUE SPACES.
  4041     12  FILLER              PIC X(3)        VALUE 'NET'.
  4042     12  FILLER              PIC X(11)       VALUE SPACES.
  4043     12  FILLER              PIC X(7)        VALUE 'ACCOUNT'.
  4044     12  FILLER              PIC X(10)       VALUE SPACES.
  4045     12  FILLER              PIC X(10)       VALUE 'NET PREM -'.
  4046
  4047 01  TOTAL-PAGE-HD3.
  4048     12  FILLER              PIC X           VALUE SPACE.
  4049     12  TPH3-DESC           PIC X(20)       VALUE SPACES.
  4050     12  FILLER              PIC X(7)        VALUE 'PREMIUM'.
  4051     12  FILLER              PIC X(10)       VALUE SPACES.
  4052     12  FILLER              PIC X(7)        VALUE 'PREMIUM'.
  4053     12  FILLER              PIC X(10)       VALUE SPACES.
  4054     12  FILLER              PIC X(7)        VALUE 'PREMIUM'.
  4055     12  FILLER              PIC X(7)        VALUE SPACES.
  4056     12  FILLER              PIC X(10)       VALUE 'COMMISSION'.
  4057     12  FILLER              PIC X(08)       VALUE SPACES.
  4058     12  FILLER              PIC X(09)       VALUE 'ACCT COMP'.
  4059     12  FILLER              PIC X(11)       VALUE SPACES.
  4060     12  FILLER              PIC X(6)        VALUE 'CLAIMS'.
  4061
  4062 01  TOTAL-PAGE-DETAIL.
  4063     12  FILLER              PIC X(5).
  4064     12  TPD-DESC            PIC X(6).
  4065     12  FILLER              PIC X(3).
  4066     12  TPD-ISS-PRM         PIC ZZZ,ZZZ,ZZZ.99-.
  4067     12  FILLER              PIC X(2).
  4068     12  TPD-CNC-PRM         PIC ZZZ,ZZZ,ZZZ.99-.
  4069     12  FILLER              PIC X(2).
  4070     12  TPD-NET-PRM         PIC ZZZ,ZZZ,ZZZ.99-.
  4071     12  FILLER              PIC X(2).
  4072     12  TPD-ACCT-COM        PIC ZZZ,ZZZ,ZZZ.99-.
  4073     12  FILLER              PIC X(2).
  4074     12  TPD-PREM-COMP       PIC ZZZ,ZZZ,ZZZ.99-.
  4075     12  FILLER              PIC X(2).
  4076     12  TPD-CLAIMS          PIC ZZZ,ZZZ,ZZZ.99-.
  4077     12  FILLER              PIC X(4).
  4078     12  TPD-LO-CERT         PIC X(6).
  4079     12  FILLER              PIC X(2).
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  81
* ECS010T1.cbl
  4080     12  TPD-HI-CERT         PIC X(6).
  4081*    12  FILLER              PIC X.
  4082*    12  TPD-LO-CERT         PIC X(8).
  4083*    12  FILLER              PIC X.
  4084*    12  TPD-HI-CERT         PIC X(8).
  4085
  4086 01  DUPE-CERT-TABLE.
  4087     12  DUPE-ENTRIES  OCCURS 1000 TIMES.
  4088         16  DUPE-ENTRY      PIC X(36).
  4089         16  DUPE-STATUS     PIC X(01).
  4090         16  DUPE-LF-PRM     PIC S9(7)V99    COMP-3.
  4091         16  DUPE-AH-PRM     PIC S9(7)V99    COMP-3.
  4092
  4093 01  MISMATCH-HEADING-1.
  4094     12  FILLER              PIC X           VALUE '1'.
  4095     12  FILLER              PIC X(45)       VALUE SPACES.
  4096     12  FILLER              PIC X(42)       VALUE
  4097             'MISMATCHED TRANS AND DUPLICATE CERT REPORT'.
  4098     12  FILLER              PIC X(35)       VALUE SPACES.
  4099     12  FILLER              PIC X(10)       VALUE 'ECS010    '.
  4100
  4101 01  MISMATCH-HEADING-2.
  4102     12  FILLER              PIC X           VALUE '0'.
  4103     12  FILLER              PIC X(44)       VALUE
  4104             ' C  GRP ST  ACCT    EFF DTE  CERT      REC T'.
  4105     12  FILLER              PIC X(44)       VALUE
  4106             'YPE      CERT IN CONTROL                    '.
  4107     12  FILLER              PIC X(44)       VALUE
  4108             '        CERT OUT CONTROL           STATUS   '.
  4109
  4110 01  MISMATCH-DETAIL.
  4111     12  FILLER              PIC X           VALUE '0'.
  4112     12  FILLER              PIC X           VALUE SPACES.
  4113     12  DTL-MATCH-CONTROL   PIC X(36).
  4114     12  FILLER              PIC X(3)        VALUE SPACES.
  4115     12  DTL-REC-TYPE        PIC X.
  4116     12  FILLER              PIC X(2)        VALUE SPACES.
  4117     12  DTL-REC-TYPE-DESC   PIC X(3).
  4118     12  FILLER              PIC X(3)        VALUE SPACES.
  4119     12  DTL-CERT-IN-CONTROL
  4120                             PIC X(36).
  4121     12  FILLER              PIC X           VALUE SPACES.
  4122     12  DTL-CERT-OUT-CONTROL
  4123                             PIC X(36).
  4124     12  FILLER              PIC X           VALUE SPACES.
  4125     12  DTL-STATUS          PIC X(7)        VALUE 'DROPPED'.
  4126     12  FILLER              PIC X(2)        VALUE SPACES.
  4127
  4128 01  MISMATCH-DETAIL-2.
  4129     12  FILLER              PIC X           VALUE ' '.
  4130     12  FILLER              PIC X           VALUE SPACES.
  4131     12  MD2-LF-PREM-DESC    PIC X(16)       VALUE
  4132             ' LIFE PREMIUM = '.
  4133     12  MD2-LF-PREM         PIC Z,ZZZ,ZZZ.99-.
  4134     12  FILLER              PIC X           VALUE SPACES.
  4135     12  MD2-LF-ALT-PREM-DESC PIC X(16)       VALUE
  4136             'LIFE ALT PREM = '.
  4137     12  MD2-LF-ALT-PREM     PIC Z,ZZZ,ZZZ.99-.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  82
* ECS010T1.cbl
  4138     12  FILLER              PIC XX          VALUE SPACES.
  4139     12  MD2-AH-PREM-DESC    PIC X(18)       VALUE
  4140             'A/H PREMIUM = '.
  4141     12  MD2-AH-PREM         PIC Z,ZZZ,ZZZ.99-.
  4142     12  FILLER              PIC X(39)       VALUE SPACES.
  4143
  4144 01  MISMATCH-DETAIL-3.
  4145     12  FILLER              PIC X           VALUE ' '.
  4146     12  FILLER              PIC X           VALUE SPACES.
  4147     12  FILLER              PIC X(16)       VALUE
  4148             ' LIFE  REFUND = '.
  4149     12  MD3-LF-REFUND       PIC Z,ZZZ,ZZZ.99-.
  4150     12  FILLER              PIC X           VALUE SPACES.
  4151     12  FILLER              PIC X(16)       VALUE
  4152             'A & H  REFUND = '.
  4153     12  MD3-AH-REFUND       PIC Z,ZZZ,ZZZ.99-.
  4154     12  FILLER              PIC X(72)       VALUE SPACES.
  4155
  4156 01  MISMATCH-DETAIL-4.
  4157     12  FILLER              PIC X           VALUE ' '.
  4158     12  FILLER              PIC X           VALUE SPACES.
  4159     12  FILLER              PIC X(16)       VALUE
  4160             ' LIFE  CLAIM  = '.
  4161     12  MD4-LF-CLAIM        PIC Z,ZZZ,ZZZ.99-.
  4162     12  FILLER              PIC X           VALUE SPACES.
  4163     12  FILLER              PIC X(16)       VALUE
  4164             'A & H  CLAIM  = '.
  4165     12  MD4-AH-CLAIM        PIC Z,ZZZ,ZZZ.99-.
  4166     12  FILLER              PIC X(72)       VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  83
* ECS010T1.cbl
  4168*
  4169*
  4170* LEAVE THE ABOVE 2 LINES IN TO PREVENT LOSING THE LINE ABOVE
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  84
* ECS010T1.cbl
  4172 01  PB-STARTS-HERE              PIC X(48)
  4173       VALUE '*****  PENDING BUSINESS RECORD STARTS HERE  ****'.
  4174
* 4175                             COPY ERCPNDB.
  4176******************************************************************
  4177*                                                                *
  4178*                                                                *
  4179*                            ERCPNDB.                            *
  4180*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4181*                            VMOD=2.025                          *
  4182*                                                                *
  4183*   FILE DESCRIPTION = PENDING NEW BUSINESS (ISSUES AND CANCELS) *
  4184*                                                                *
  4185******************************************************************
  4186*   NOTE: IF THIS FORMAT IS CHANGED, THE SORT RECORD IN THE      *
  4187*         EL861 A/R SYSTEM MAY NEED TO BE CHANGED.               *
  4188******************************************************************
  4189*                                                                *
  4190*                                                                *
  4191*   FILE TYPE = VSAM,KSDS                                        *
  4192*   RECORD SIZE = 585  RECFORM = FIXED                           *
  4193*                                                                *
  4194*   BASE CLUSTER = ERPNDB                         RKP=2,LEN=11   *
  4195*       ALTERNATE PATH1 = ERPNDB2  (BY CAR GRP STATE ACCOUNT     *
  4196*                                  EFF-DT CERT CHG-SEQ REC-TYPE) *
  4197*                                                 RKP=13,LEN=36  *
  4198*       ALTERNATE PATH2 = ERPNDB3  (BY CO, ORIGINAL BATCH, SEQ.  *
  4199*                                      AND CHG-SEQ.)             *
  4200*                                                RKP=49,LEN=11   *
  4201*       ALTERNATE PATH3 = ERPNDB4  (BY CO, CSR-ID, BATCH, SEQ.   *
  4202*                                      AND CHG-SEQ.)             *
  4203*                                                RKP=60,LEN=15   *
  4204*                                                                *
  4205*   LOG = NO                                                     *
  4206*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4207******************************************************************
  4208******************************************************************
  4209*                   C H A N G E   L O G
  4210*
  4211* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4212*-----------------------------------------------------------------
  4213*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4214* EFFECTIVE    NUMBER
  4215*-----------------------------------------------------------------
  4216* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  4217* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  4218* 011904                   PEMA  ADD TOTAL FEE PROCESSING
  4219* 040504    2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  4220* 020305    2005020000000  PEMA  ADD CLP STATE TO PNDB RECORD
  4221* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  4222* 032306                   PEMA  ADD BOW LOAN NUMBER
  4223* 081606    2006080800002  PEMA  ADD VIN, ISSUES ONLY
  4224* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
  4225* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  4226* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  4227* 032109    2009021700002  PEMA  ADD CRED BENE TO PNDB REC
  4228* 072209  CR2008101500003  AJRA  ADD BORROWER FIRST NAME TO ENDORSEMENT
  4229* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  85
* ECS010T1.cbl (/apps/prod/cid1p/copy/ERCPNDB)
  4230* 071211  CR2010012700001  PEMA  ADD SPP DEALER DIRECT
  4231* 073114  CR2014012300001  PEMA  ADD CU CARRIER 7 PROCESSING
  4232******************************************************************
  4233
  4234 01  PENDING-BUSINESS.
  4235     12  PB-RECORD-ID                     PIC XX.
  4236         88  VALID-PB-ID                        VALUE 'PB'.
  4237
  4238     12  PB-CONTROL-PRIMARY.
  4239         16  PB-COMPANY-CD                PIC X.
  4240         16  PB-ENTRY-BATCH               PIC X(6).
  4241         16  PB-BATCH-SEQ-NO              PIC S9(4)     COMP.
  4242         16  PB-BATCH-CHG-SEQ-NO          PIC S9(4)     COMP.
  4243
  4244     12  PB-CONTROL-BY-ACCOUNT.
  4245         16  PB-COMPANY-CD-A1             PIC X.
  4246         16  PB-CARRIER                   PIC X.
  4247         16  PB-GROUPING.
  4248             20  PB-GROUPING-PREFIX       PIC XXX.
  4249             20  PB-GROUPING-PRIME        PIC XXX.
  4250         16  PB-STATE                     PIC XX.
  4251         16  PB-ACCOUNT.
  4252             20  PB-ACCOUNT-PREFIX        PIC X(4).
  4253             20  PB-ACCOUNT-PRIME         PIC X(6).
  4254         16  PB-CERT-EFF-DT               PIC XX.
  4255         16  PB-CERT-NO.
  4256             20  PB-CERT-PRIME            PIC X(10).
  4257             20  PB-CERT-SFX              PIC X.
  4258         16  PB-ALT-CHG-SEQ-NO            PIC S9(4)     COMP.
  4259
  4260         16  PB-RECORD-TYPE               PIC X.
  4261             88  PB-MAILING-DATA                VALUE '0'.
  4262             88  PB-ISSUE                       VALUE '1'.
  4263             88  PB-CANCELLATION                VALUE '2'.
  4264             88  PB-BATCH-TRAILER               VALUE '9'.
  4265
  4266     12  PB-CONTROL-BY-ORIG-BATCH.
  4267         16  PB-ORIGINAL-COMPANY-CD       PIC X.
  4268         16  PB-ORIGINAL-ENTRY-BATCH      PIC X(6).
  4269         16  PB-ORIGINAL-SEQ-NO           PIC S9(4)     COMP.
  4270         16  PB-ORIGINAL-CHG-SEQ-NO       PIC S9(4)     COMP.
  4271
  4272     12  PB-CONTROL-BY-CSR.
  4273         16  PB-CSR-COMPANY-CD            PIC X.
  4274         16  PB-CSR-ID                    PIC X(4).
  4275         16  PB-CSR-ENTRY-BATCH           PIC X(6).
  4276         16  PB-CSR-BATCH-SEQ-NO          PIC S9(4)     COMP.
  4277         16  PB-CSR-BATCH-CHG-SEQ-NO      PIC S9(4)     COMP.
  4278******************************************************************
  4279*    MAILING DATA IS PROCESSED IN ONLY PRGS. EL512 & EL513       *
  4280******************************************************************
  4281
  4282     12  PB-LAST-MAINT-DT                 PIC XX.
  4283     12  PB-LAST-MAINT-BY                 PIC X(4).
  4284     12  PB-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.
  4285
  4286     12  PB-RECORD-BODY                   PIC X(375).
  4287
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  86
* ECS010T1.cbl (/apps/prod/cid1p/copy/ERCPNDB)
  4288     12  PB-ISSUE-RECORD   REDEFINES PB-RECORD-BODY.
  4289         16  PB-CERT-ORIGIN               PIC X.
  4290             88  CLASIC-CREATED-CERT         VALUE '1'.
  4291         16  PB-I-NAME.
  4292             20  PB-I-INSURED-LAST-NAME   PIC X(15).
  4293             20  PB-I-INSURED-FIRST-NAME.
  4294                 24  PB-I-INSURED-1ST-INIT PIC X.
  4295                 24  FILLER                PIC X(9).
  4296             20  PB-I-INSURED-MIDDLE-INIT PIC X.
  4297         16  PB-I-AGE                     PIC S99   COMP-3.
  4298         16  PB-I-JOINT-AGE               PIC S99   COMP-3.
  4299         16  PB-I-BIRTHDAY                PIC XX.
  4300         16  PB-I-INSURED-SEX             PIC X.
  4301             88  PB-SEX-MALE     VALUE 'M'.
  4302             88  PB-SEX-FEMALE   VALUE 'F'.
  4303
  4304         16  PB-I-LF-TERM                 PIC S999   COMP-3.
  4305         16  PB-I-AH-TERM                 PIC S999   COMP-3.
  4306         16  PB-I-LOAN-TERM               PIC S999   COMP-3.
  4307         16  PB-I-PAY-FREQUENCY           PIC S99    COMP-3.
  4308         16  PB-I-SKIP-CODE               PIC X.
  4309             88  PB-NO-MONTHS-SKIPPED      VALUE ' ' '0'.
  4310             88  PB-SKIP-JULY              VALUE '1'.
  4311             88  PB-SKIP-AUGUST            VALUE '2'.
  4312             88  PB-SKIP-SEPTEMBER         VALUE '3'.
  4313             88  PB-SKIP-JULY-AUG          VALUE '4'.
  4314             88  PB-SKIP-AUG-SEPT          VALUE '5'.
  4315             88  PB-SKIP-JULY-AUG-SEPT     VALUE '6'.
  4316             88  PB-SKIP-JUNE-JULY-AUG     VALUE '7'.
  4317             88  PB-SKIP-JUNE              VALUE '8'.
  4318             88  PB-SKIP-JUNE-JULY         VALUE '9'.
  4319             88  PB-SKIP-AUG-SEPT-OCT      VALUE 'A'.
  4320             88  PB-SKIP-BI-WKLY-3RD-PMT   VALUE 'X'.
  4321         16  PB-I-TERM-TYPE               PIC X.
  4322             88  PB-PAID-MONTHLY           VALUE ' ' 'M'.
  4323             88  PB-PAID-WEEKLY            VALUE 'W'.
  4324             88  PB-PAID-SEMI-MONTHLY      VALUE 'S'.
  4325             88  PB-PAID-BI-WEEKLY         VALUE 'B'.
  4326             88  PB-PAID-13-YEARLY         VALUE 'T'.
  4327         16  PB-I-NO-OF-PAYMENTS          PIC S999   COMP-3.
  4328         16  PB-I-POLICY-FORM-NO          PIC X(12).
  4329         16  PB-I-DATA-ENTRY-SW           PIC X.
  4330             88  PB-EFF-DT-PROCESSING      VALUE '1' ' '.
  4331             88  PB-EXT-DAYS-PROCESSING    VALUE '2'.
  4332             88  PB-EXPIRE-DT-PROCESSING   VALUE '3'.
  4333             88  PB-1ST-PMT-DT-PROCESSING  VALUE '4'.
  4334         16  PB-I-PAYMENT-AMOUNT          PIC S9(7)V99  COMP-3.
  4335         16  PB-I-DCC-OVER-CHG-AMT        PIC S9(5)V99  COMP-3.
  4336*        16  PB-I-MICROFILM-NO            PIC S9(9)      COMP-3.
  4337         16  PB-I-AH-CLP                  PIC S9(5)V99 COMP-3.
  4338         16  FILLER                       PIC X.
  4339
  4340         16  PB-I-LIFE-BENEFIT-CD         PIC XX.
  4341             88  PB-VALID-LIFE               VALUE '01' THRU '89'.
  4342             88  PB-INVALID-LIFE             VALUE '  ' '00'
  4343                                                   '90' THRU '99'.
  4344         16  PB-I-LF-BENEFIT-CD   REDEFINES PB-I-LIFE-BENEFIT-CD
  4345                                          PIC XX.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  87
* ECS010T1.cbl (/apps/prod/cid1p/copy/ERCPNDB)
  4346         16  PB-I-LF-BENEFIT-AMT          PIC S9(9)V99   COMP-3.
  4347         16  PB-I-AMOUNT-FINANCED REDEFINES
  4348                  PB-I-LF-BENEFIT-AMT     PIC S9(9)V99   COMP-3.
  4349         16  PB-I-LF-ALT-BENEFIT-AMT      PIC S9(9)V99   COMP-3.
  4350         16  PB-I-UNPAID-CASH-PRICE REDEFINES
  4351                  PB-I-LF-ALT-BENEFIT-AMT PIC S9(9)V99   COMP-3.
  4352         16  PB-I-LF-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  4353         16  PB-I-LF-ALT-PREMIUM-AMT      PIC S9(7)V99   COMP-3.
  4354         16  PB-I-CLP-AMOUNT REDEFINES
  4355                  PB-I-LF-ALT-PREMIUM-AMT PIC S9(7)V99   COMP-3.
  4356         16  PB-I-LF-CALC-FLAG            PIC X.
  4357             88 PB-COMP-LF-PREM               VALUE '?'.
  4358         16  PB-I-LF-PREM-CALC            PIC S9(7)V99   COMP-3.
  4359         16  PB-I-LF-ALT-PREM-CALC        PIC S9(7)V99   COMP-3.
  4360         16  PB-I-LF-RATE                 PIC S99V9(5)   COMP-3.
  4361         16  PB-I-LF-ALT-RATE             PIC S99V9(5)   COMP-3.
  4362         16  PB-I-LF-POLICY-FEE           PIC S9(3)V99   COMP-3.
  4363         16  PB-I-LF-REI-RATE             PIC S99V9(5)   COMP-3.
  4364         16  PB-I-LF-ALT-REI-RATE         PIC S99V9(5)   COMP-3.
  4365         16  PB-I-LF-ABBR                 PIC XXX.
  4366         16  PB-I-LF-INPUT-CD             PIC XX.
  4367
  4368         16  PB-I-AH-BENEFIT-CD           PIC XX.
  4369             88  PB-VALID-AH                 VALUE '01' THRU '89'.
  4370             88  PB-INVALID-AH               VALUE '  ' '00'
  4371                                                   '90' THRU '99'.
  4372         16  PB-I-AH-BENEFIT-AMT          PIC S9(7)V99   COMP-3.
  4373         16  PB-I-AH-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  4374         16  PB-I-AH-CALC-FLAG            PIC X.
  4375             88 PB-COMP-AH-PREM                  VALUE '?'.
  4376         16  PB-I-AH-PREM-CALC            PIC S9(7)V99   COMP-3.
  4377         16  PB-I-AH-RATE                 PIC S99V9(5)   COMP-3.
  4378         16  PB-I-AH-POLICY-FEE           PIC S9(3)V99   COMP-3.
  4379         16  PB-I-AH-REI-RATE             PIC S99V9(5)   COMP-3.
  4380         16  PB-I-AH-RATE-TRM             PIC S999       COMP-3.
  4381         16  PB-I-AH-ABBR                 PIC XXX.
  4382         16  PB-I-AH-INPUT-CD             PIC XXX.
  4383
  4384         16  PB-I-SPECIAL-REIN-CODE       PIC X.
  4385         16  PB-I-REIN-TABLE              PIC XXX.
  4386         16  PB-I-BUSINESS-TYPE           PIC 99.
  4387         16  PB-I-INDV-GRP-CD             PIC X.
  4388         16  PB-I-MORT-CODE.
  4389             20  PB-I-TABLE               PIC X.
  4390             20  PB-I-INTEREST            PIC XX.
  4391             20  PB-I-MORT-TYP            PIC X.
  4392         16  PB-I-LF-CRIT-PER             PIC S9(3)      COMP-3.
  4393         16  PB-I-AH-CRIT-PER             PIC S9(3)      COMP-3.
  4394         16  PB-I-LF-CLP                  PIC S9(5)V99   COMP-3.
  4395         16  PB-I-INDV-GRP-OVRD           PIC X.
  4396         16  PB-I-RATE-CLASS-OVRD         PIC XX.
  4397         16  PB-I-SIG-SW                  PIC X.
  4398             88  PB-POLICY-SIGNED             VALUE 'Y'.
  4399         16  PB-I-RATE-CLASS              PIC XX.
  4400         16  PB-I-RATE-DEVIATION-LF       PIC XXX.
  4401         16  PB-I-RATE-DEVIATION-AH       PIC XXX.
  4402         16  PB-I-RATE-DEV-PCT-LF         PIC S9V9(6)    COMP-3.
  4403         16  PB-I-RATE-DEV-PCT-AH         PIC S9V9(6)    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  88
* ECS010T1.cbl (/apps/prod/cid1p/copy/ERCPNDB)
  4404         16  PB-I-LIFE-COMMISSION         PIC SV9(5)     COMP-3.
  4405         16  PB-I-JOINT-COMMISSION        PIC SV9(5)     COMP-3.
  4406         16  PB-I-AH-COMMISSION           PIC SV9(5)     COMP-3.
  4407         16  PB-I-BENEFIT-TYPE            PIC XXX.
  4408         16  PB-I-OB-FLAG                 PIC X.
  4409             88  PB-I-OB                      VALUE 'B'.
  4410             88  PB-I-SUMMARY                 VALUE 'Z'.
  4411         16  PB-I-ENTRY-STATUS            PIC X.
  4412             88  PB-I-POLICY-IS-ACTIVE        VALUE '1' '3' '4'
  4413                                              'M' '5' '9' '2'.
  4414             88  PB-I-NORMAL-ENTRY            VALUE '1'.
  4415             88  PB-I-POLICY-PENDING          VALUE '2'.
  4416             88  PB-I-CONVERSION-ENTRY        VALUE '4'.
  4417             88  PB-I-POLICY-IS-REISSUE       VALUE '5'.
  4418             88  PB-I-POLICY-IS-CASH          VALUE 'C'.
  4419             88  PB-I-POLICY-IS-MONTHLY       VALUE 'M'.
  4420             88  PB-I-REIN-ONLY               VALUE '9'.
  4421             88  PB-I-POLICY-IS-DECLINED      VALUE 'D'.
  4422             88  PB-I-POLICY-IS-VOIDED        VALUE 'V'.
  4423             88  PB-I-PREM-ACCTNG-ONLY        VALUE 'P'.
  4424             88  PB-I-UNDERWRITE-POLICY       VALUE 'U'.
  4425         16  PB-I-INT-CODE                PIC X.
  4426             88  PB-ADD-ON-INTEREST           VALUE 'A'.
  4427             88  PB-SIMPLE-INTEREST           VALUE 'S'.
  4428         16  PB-I-LOAN-APR                PIC 9(3)V9(4)   COMP-3.
  4429         16  PB-I-SOC-SEC-NO              PIC X(11).
  4430         16  PB-I-MEMBER-NO               PIC X(12).
  4431         16  PB-I-CURR-SEQ                PIC S9(4)       COMP.
  4432*        16  PB-I-LOAN-OFFICER            PIC XXX.
  4433         16  PB-I-OLD-LOF                 PIC XXX.
  4434         16  PB-I-LF-EXPIRE-DT            PIC XX.
  4435         16  PB-I-AH-EXPIRE-DT            PIC XX.
  4436         16  PB-I-EXTENTION-DAYS          PIC S999        COMP-3.
  4437         16  PB-I-TERM-IN-DAYS            PIC S9(5)       COMP-3.
  4438         16  PB-I-LIFE-INDICATOR          PIC X.
  4439             88  PB-I-JOINT-COVERAGE         VALUE 'J'.
  4440         16  PB-I-LIVES                   PIC S9(7)       COMP-3.
  4441         16  PB-I-DDF-IU-RATE-UP REDEFINES PB-I-LIVES
  4442                                          PIC S9(5)V99    COMP-3.
  4443         16  PB-I-MAIL-ADDRS-SW           PIC X.
  4444             88 PB-I-MAIL-ADDRS-NOT-PRESENT  VALUE ' '.
  4445             88 PB-I-MAIL-ADDRS-PRESENT      VALUE '1'.
  4446         16  PB-I-1ST-PMT-DT              PIC XX.
  4447         16  PB-I-JOINT-INSURED.
  4448             20 PB-I-JOINT-LAST-NAME      PIC X(15).
  4449             20 PB-I-JOINT-FIRST-NAME.
  4450                24  PB-I-JOINT-FIRST-INIT PIC X.
  4451                24  FILLER                PIC X(9).
  4452             20 PB-I-JOINT-MIDDLE-INIT    PIC X.
  4453*        16  PB-I-BENEFICIARY-NAME        PIC X(25).
  4454         16  PB-I-BENEFICIARY-NAME.
  4455             20  PB-I-BANK-NUMBER         PIC X(10).
  4456             20  FILLER                   PIC X(15).
  4457         16  PB-I-LAST-ADD-ON-DT          PIC XX.
  4458         16  PB-I-REFERENCE               PIC X(12).
  4459         16  FILLER REDEFINES PB-I-REFERENCE.
  4460             20  PB-I-TOT-FEES            PIC S9(7)V99 COMP-3.
  4461             20  PB-I-TOT-FEES-CALC       PIC S9(7)V99 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  89
* ECS010T1.cbl (/apps/prod/cid1p/copy/ERCPNDB)
  4462             20  PB-I-CLP-STATE           PIC XX.
  4463         16  PB-I-UNDERWRITING-STATUS     PIC X.
  4464             88  PB-I-POLICY-ACCEPTED         VALUE 'A' 'N'.
  4465             88  PB-I-POLICY-DECLINED         VALUE 'D'.
  4466             88  PB-I-NEEDS-UNDERWRITING      VALUE 'U'.
  4467         16  PB-I-STATE-TAX               PIC S9(7)V99 COMP-3.
  4468         16  PB-I-MUNI-TAX                PIC S9(7)V99 COMP-3.
  4469         16  PB-I-RESIDENT-STATE          PIC XX.
  4470         16  PB-I-RATE-CODE               PIC X(4).
  4471         16  PB-I-NUM-BILLED              PIC S9(7)    COMP-3.
  4472         16  PB-I-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  4473         16  PB-I-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  4474         16  PB-I-BANK-FEE                PIC S999V99  COMP-3.
  4475         16  PB-I-BANK-NOCHRGB            PIC 99.
  4476         16  PB-I-ADDL-CLP                PIC S9(5)V99 COMP-3.
  4477         16  PB-I-JOINT-BIRTHDAY          PIC XX.
  4478
  4479     12  PB-CANCEL-RECORD   REDEFINES PB-RECORD-BODY.
  4480         16  PB-C-LF-CANCEL-VOID-SW       PIC X.
  4481             88  PB-C-LF-CANCEL-VOIDED        VALUE '1'.
  4482         16  PB-C-CANCEL-ORIGIN           PIC X.
  4483             88  PB-C-CLAIM-CREATED-CANCEL   VALUE '1'.
  4484         16  PB-C-LF-CANCEL-DT            PIC XX.
  4485         16  PB-C-LF-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  4486         16  PB-C-LF-CALC-REQ             PIC X.
  4487             88 PB-COMP-LF-CANCEL            VALUE '?'.
  4488         16  PB-C-LF-REF-CALC             PIC S9(7)V99    COMP-3.
  4489         16  PB-C-LF-REM-TERM             PIC S9(3)       COMP-3.
  4490         16  PB-C-AH-CANCEL-VOID-SW       PIC X.
  4491             88  PB-C-AH-CANCEL-VOIDED        VALUE '1'.
  4492         16  PB-C-AH-CANCEL-DT            PIC XX.
  4493         16  PB-C-AH-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  4494         16  PB-C-AH-CALC-REQ             PIC X.
  4495             88 PB-COMP-AH-CANCEL            VALUE '?'.
  4496         16  PB-C-AH-REF-CALC             PIC S9(7)V99    COMP-3.
  4497         16  PB-C-AH-REM-TERM             PIC S9(3)       COMP-3.
  4498         16  PB-C-LAST-NAME               PIC X(15).
  4499         16  PB-C-REFUND-SW               PIC X.
  4500             88  PB-C-REFUND-CREATED          VALUE 'Y'.
  4501             88  PB-C-REFUND-REQUESTED        VALUE 'R'.
  4502         16  PB-C-LIVES                   PIC S9(3)       COMP-3.
  4503         16  PB-C-PAYEE-CODE              PIC X(6).
  4504         16  PB-C-LF-REFUND-OVERRIDE      PIC X.
  4505         16  PB-C-AH-REFUND-OVERRIDE      PIC X.
  4506         16  PB-C-LF-COMM-CHARGEBACK      PIC X.
  4507         16  PB-C-AH-COMM-CHARGEBACK      PIC X.
  4508         16  PB-C-REFERENCE               PIC X(12).
  4509         16  PB-C-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  4510         16  PB-C-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  4511         16  PB-C-POST-CARD-IND           PIC X.
  4512         16  PB-C-CANCEL-REASON           PIC X.
  4513         16  PB-C-REF-INTERFACE-SW        PIC X.
  4514         16  PB-C-LF-RFND-CLP             PIC S9(5)V99 COMP-3.
  4515         16  PB-C-AH-RFND-CLP             PIC S9(5)V99 COMP-3.
  4516         16  FILLER                       PIC X(01).
  4517*        16  FILLER                       PIC X(18).
  4518         16  PB-C-POLICY-FORM-NO          PIC X(12).
  4519*        16  PB-C-MICROFILM-NO            PIC S9(9)      COMP-3.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  90
* ECS010T1.cbl (/apps/prod/cid1p/copy/ERCPNDB)
  4520         16  PB-C-NH-INT-ON-REFS          PIC S9(7)V99   COMP-3.
  4521         16  PB-CANCELED-CERT-DATA.
  4522             20  PB-CI-INSURED-NAME.
  4523                 24  PB-CI-LAST-NAME      PIC X(15).
  4524                 24  PB-CI-INITIALS       PIC XX.
  4525             20  PB-CI-INSURED-AGE        PIC S99         COMP-3.
  4526             20  PB-CI-INSURED-SEX        PIC X.
  4527             20  PB-CI-LF-TERM            PIC S999        COMP-3.
  4528             20  PB-CI-LF-BENEFIT-CD      PIC XX.
  4529             20  PB-CI-LF-BENEFIT-AMT     PIC S9(9)V99    COMP-3.
  4530             20  PB-CI-LF-ALT-BENEFIT-AMT PIC S9(9)V99    COMP-3.
  4531             20  PB-CI-LF-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  4532             20  PB-CI-LF-ALT-PREMIUM-AMT PIC S9(7)V99    COMP-3.
  4533             20  PB-CI-AH-TERM            PIC S999        COMP-3.
  4534             20  PB-CI-AH-BENEFIT-CD      PIC XX.
  4535             20  PB-CI-AH-BENEFIT-AMT     PIC S9(7)V99    COMP-3.
  4536             20  PB-CI-AH-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  4537             20  PB-CI-RATE-CLASS         PIC XX.
  4538             20  PB-CI-RATE-DEV-LF        PIC XXX.
  4539             20  PB-CI-RATE-DEV-AH        PIC XXX.
  4540             20  PB-CI-RATE-DEV-PCT-LF    PIC S9V9(6)     COMP-3.
  4541             20  PB-CI-RATE-DEV-PCT-AH    PIC S9V9(6)     COMP-3.
  4542             20  PB-CI-LIFE-COMMISSION    PIC SV9(5)      COMP-3.
  4543             20  PB-CI-AH-COMMISSION      PIC SV9(5)      COMP-3.
  4544             20  PB-CI-LF-ABBR            PIC X(3).
  4545             20  PB-CI-AH-ABBR            PIC X(3).
  4546             20  PB-CI-OB-FLAG            PIC X.
  4547                 88  PB-CI-OB                VALUE 'B'.
  4548             20  PB-CI-LF-POLICY-STATUS   PIC X.
  4549                 88  PB-CI-LF-POLICY-IS-ACTIVE       VALUE '1' '3'
  4550                                           'M' '4' '5' '9' '2'.
  4551                 88  PB-CI-LF-NORMAL-ENTRY           VALUE '1'.
  4552                 88  PB-CI-LF-POLICY-PENDING         VALUE '2'.
  4553                 88  PB-CI-LF-POLICY-IS-RESTORE      VALUE '3'.
  4554                 88  PB-CI-LF-CONVERSION-ENTRY       VALUE '4'.
  4555                 88  PB-CI-LF-POLICY-IS-REISSUE      VALUE '5'.
  4556                 88  PB-CI-LF-POLICY-IS-CASH         VALUE 'C'.
  4557                 88  PB-CI-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  4558                 88  PB-CI-LF-LUMP-SUM-DISAB         VALUE '6'.
  4559                 88  PB-CI-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  4560                 88  PB-CI-LF-CANCEL-APPLIED         VALUE '8'.
  4561                 88  PB-CI-LF-REIN-ONLY              VALUE '9'.
  4562                 88  PB-CI-LF-POLICY-IS-DECLINED     VALUE 'D'.
  4563                 88  PB-CI-LF-POLICY-IS-VOID         VALUE 'V'.
  4564             20  PB-CI-AH-POLICY-STATUS   PIC X.
  4565                 88  PB-CI-AH-POLICY-IS-ACTIVE       VALUE '1' '3'
  4566                                           'M' '4' '5' '9' '2'.
  4567                 88  PB-CI-AH-NORMAL-ENTRY           VALUE '1'.
  4568                 88  PB-CI-AH-POLICY-PENDING         VALUE '2'.
  4569                 88  PB-CI-AH-POLICY-IS-RESTORE      VALUE '3'.
  4570                 88  PB-CI-AH-CONVERSION-ENTRY       VALUE '4'.
  4571                 88  PB-CI-AH-POLICY-IS-REISSUE      VALUE '5'.
  4572                 88  PB-CI-AH-POLICY-IS-CASH         VALUE 'C'.
  4573                 88  PB-CI-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  4574                 88  PB-CI-AH-LUMP-SUM-DISAB         VALUE '6'.
  4575                 88  PB-CI-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  4576                 88  PB-CI-AH-CANCEL-APPLIED         VALUE '8'.
  4577                 88  PB-CI-AH-REIN-ONLY              VALUE '9'.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  91
* ECS010T1.cbl (/apps/prod/cid1p/copy/ERCPNDB)
  4578                 88  PB-CI-AH-POLICY-IS-DECLINED     VALUE 'D'.
  4579                 88  PB-CI-AH-POLICY-IS-VOID         VALUE 'V'.
  4580             20  PB-CI-PAY-FREQUENCY      PIC 99.
  4581             20  PB-CI-LOAN-APR           PIC 9(3)V9(4)   COMP-3.
  4582             20  PB-CI-SOC-SEC-NO         PIC X(11).
  4583             20  PB-CI-MEMBER-NO          PIC X(12).
  4584             20  PB-CI-INT-CODE           PIC X.
  4585                 88  PB-CI-ADD-ON                  VALUE 'A'.
  4586                 88  PB-CI-SIMPLE                  VALUE 'S'.
  4587             20  PB-CI-LOAN-TERM          PIC S999        COMP-3.
  4588             20  PB-CI-LOAN-1ST-PMT-DT    PIC X(2).
  4589             20  PB-CI-COMP-EXCP-SW       PIC X.
  4590                 88  PB-CI-NO-COMP-EXCP            VALUE ' '.
  4591                 88  PB-CI-CERT-HAS-ERCOMM-ENTRY   VALUE '1'.
  4592             20  PB-CI-ENTRY-STATUS       PIC X.
  4593             20  PB-CI-CURR-SEQ           PIC S9(4)       COMP.
  4594             20  PB-CI-AH-PAID-THRU-DT    PIC XX.
  4595             20  PB-CI-AH-SETTLEMENT-DT   PIC XX.
  4596             20  PB-CI-DEATH-DT           PIC XX.
  4597             20  PB-CI-LF-PRIOR-CANCEL-DT PIC XX.
  4598             20  PB-CI-AH-PRIOR-CANCEL-DT PIC XX.
  4599             20  PB-CI-AH-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  4600             20  PB-CI-LF-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  4601             20  PB-CI-CREDIT-INTERFACE-SW-1 PIC X.
  4602             20  PB-CI-CREDIT-INTERFACE-SW-2 PIC X.
  4603             20  PB-CI-ENTRY-DT              PIC XX.
  4604             20  PB-CI-ENTRY-BATCH           PIC X(6).
  4605             20  PB-CI-LF-EXPIRE-DT          PIC XX.
  4606             20  PB-CI-AH-EXPIRE-DT          PIC XX.
  4607             20  PB-CI-EXTENTION-DAYS        PIC S999     COMP-3.
  4608             20  PB-CI-TERM-IN-DAYS          PIC S9(5)    COMP-3.
  4609             20  PB-CI-OLD-LOF               PIC XXX.
  4610*            20  PB-CI-LOAN-OFFICER          PIC XXX.
  4611             20  PB-CI-LIVES                 PIC S9(3)    COMP-3.
  4612             20  PB-CI-LF-CRIT-PER           PIC S9(3)    COMP-3.
  4613             20  PB-CI-AH-CRIT-PER           PIC S9(3)    COMP-3.
  4614             20  PB-CI-INDV-GRP-CD           PIC X.
  4615             20  PB-CI-BENEFICIARY-NAME.
  4616                 24  PB-CI-BANK-NUMBER       PIC X(10).
  4617                 24  FILLER                  PIC X(15).
  4618             20  PB-CI-NOTE-SW               PIC X.
  4619             20  PB-CI-CANCEL-FEE            PIC S9(3)V99 COMP-3.
  4620             20  PB-CI-MUNI-TAX              PIC S9(7)V99 COMP-3.
  4621             20  PB-CI-STATE-TAX             PIC S9(7)V99 COMP-3.
  4622             20  PB-CI-ADDL-CLP              PIC S9(5)V99 COMP-3.
  4623             20  PB-CI-LOAN-OFFICER          PIC X(5).
  4624             20  PB-CI-BOW-LOAN-NUMBER       PIC X(14).
  4625             20  PB-CI-FIRST-NAME            PIC X(10).
  4626             20  PB-CI-DDF-IU-RATE-UP        PIC S9(5)V99 COMP-3.
  4627
  4628         16  FILLER                       PIC X(13).
  4629*032306  16  FILLER                       PIC X(27).
  4630*        16  FILLER                       PIC X(46).
  4631
  4632     12  PB-MAIL-RECORD    REDEFINES PB-RECORD-BODY.
  4633         16  FILLER                       PIC X(10).
  4634         16  PB-M-INSURED-LAST-NAME       PIC X(15).
  4635         16  PB-M-INSURED-FIRST-NAME      PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  92
* ECS010T1.cbl (/apps/prod/cid1p/copy/ERCPNDB)
  4636         16  PB-M-INSURED-MID-INIT        PIC X.
  4637         16  PB-M-INSURED-AGE             PIC 99.
  4638         16  PB-M-INSURED-BIRTHDAY        PIC XX.
  4639         16  PB-M-INSURED-SEX             PIC X.
  4640         16  PB-M-INSURED-SOC-SEC-NO      PIC X(11).
  4641         16  PB-M-INSURED-ADDRESS-1       PIC X(30).
  4642         16  PB-M-INSURED-ADDRESS-2       PIC X(30).
  4643         16  PB-M-INSURED-CITY-STATE.
  4644             20  PB-M-INSURED-CITY        PIC X(28).
  4645             20  PB-M-INSURED-STATE       PIC XX.
  4646         16  PB-M-INSURED-ZIP-CODE.
  4647             20  PB-M-INSURED-ZIP-PRIME.
  4648                 24  PB-M-INSURED-ZIP-1   PIC X.
  4649                     88  PB-M-CANADIAN-POST-CODE
  4650                                             VALUE 'A' THRU 'Z'.
  4651                 24  FILLER               PIC X(4).
  4652             20  PB-M-INSURED-ZIP-PLUS4   PIC X(4).
  4653         16  PB-M-INSURED-CANADIAN-ZIP  REDEFINES
  4654                                        PB-M-INSURED-ZIP-CODE.
  4655             20  PM-M-INS-CAN-POST1       PIC XXX.
  4656             20  PM-M-INS-CAN-POST2       PIC XXX.
  4657             20  FILLER                   PIC XXX.
  4658         16  PB-M-INSURED-PHONE-NO        PIC 9(10).
  4659         16  PB-M-JOINT-BIRTHDAY          PIC XX.
  4660         16  PB-M-CRED-BENE-NAME          PIC X(30).
  4661         16  PB-M-CRED-BENE-ADDR1         PIC X(30).
  4662         16  PB-M-CRED-BENE-ADDR2         PIC X(30).
  4663         16  PB-M-CRED-BENE-CITYST.
  4664             20  PB-M-CRED-BENE-CITY      PIC X(28).
  4665             20  PB-M-CRED-BENE-STATE     PIC XX.
  4666
  4667         16  FILLER                       PIC X(92).
  4668
  4669     12  PB-BATCH-RECORD   REDEFINES PB-RECORD-BODY.
  4670         16  FILLER                       PIC X(10).
  4671         16  PB-B-LF-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4672         16  PB-B-LF-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4673         16  PB-B-LF-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4674         16  PB-B-LF-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4675         16  PB-B-LF-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4676         16  PB-B-LF-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4677         16  PB-B-AH-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4678         16  PB-B-AH-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4679         16  PB-B-AH-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4680         16  PB-B-AH-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4681         16  PB-B-AH-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4682         16  PB-B-AH-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4683         16  PB-B-ISSUE-CNT-REMITTED      PIC S9(5)    COMP-3.
  4684         16  PB-B-ISSUE-CNT-ENTERED       PIC S9(5)    COMP-3.
  4685         16  PB-B-CANCEL-CNT-REMITTED     PIC S9(5)    COMP-3.
  4686         16  PB-B-CANCEL-CNT-ENTERED      PIC S9(5)    COMP-3.
  4687         16  PB-B-HIGHEST-SEQ-NO          PIC S9(4)    COMP.
  4688         16  PB-ACCOUNT-NAME              PIC X(30).
  4689         16  PB-PREM-REF-RPT-FLAG         PIC X.
  4690         16  PB-REFERENCE                 PIC X(12).
  4691         16  PB-B-RECEIVED-DT             PIC XX.
  4692         16  FILLER                       PIC X(234).
  4693
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  93
* ECS010T1.cbl (/apps/prod/cid1p/copy/ERCPNDB)
  4694     12  PB-RECORD-STATUS.
  4695         16  PB-CREDIT-SELECT-DT          PIC XX.
  4696         16  PB-CREDIT-ACCEPT-DT          PIC XX.
  4697         16  PB-BILLED-DT                 PIC XX.
  4698         16  PB-BILLING-STATUS            PIC X.
  4699             88  PB-ENTRY-REVERSED            VALUE 'R'.
  4700             88  PB-EL860-INTERNAL-ERROR      VALUE 'E'.
  4701             88  PB-EL860-INTERNAL-PROCESS    VALUE 'P'.
  4702         16  PB-RECORD-BILL               PIC X.
  4703             88  PB-RECORD-ON-HOLD            VALUE 'H'.
  4704             88  PB-RECORD-RETURNED           VALUE 'R'.
  4705             88  PB-RECORD-ENDORSED           VALUE 'E'.
  4706             88  PB-OVERRIDE-LIFE             VALUE 'L'.
  4707             88  PB-OVERRIDE-AH               VALUE 'A'.
  4708             88  PB-OVERRIDE-BOTH             VALUE 'B'.
  4709         16  PB-BATCH-ENTRY               PIC X.
  4710             88  PB-POLICY-IS-DECLINED        VALUE 'D'.
  4711             88  PB-REIN-ONLY-CERT            VALUE 'R'.
  4712             88  PB-REISSUED-CERT             VALUE 'E'.
  4713             88  PB-CASH-CERT                 VALUE 'C'.
  4714             88  PB-MONTHLY-CERT              VALUE 'M'.
  4715             88  PB-PREM-ACCTNG-ONLY          VALUE 'P'.
  4716             88  PB-NEEDS-UNDERWRITING        VALUE 'U'.
  4717             88  PB-POLICY-IS-VOIDED          VALUE 'V'.
  4718         16  PB-FORCE-CODE                PIC X.
  4719             88  PB-FORCE-OFF                 VALUE ' ' '0'.
  4720             88  PB-ISSUE-FORCE               VALUE 'A' 'O'.
  4721             88  PB-CANCEL-FORCE              VALUE '8'.
  4722             88  PB-ALL-ISSUE-FORCED          VALUE 'A' 'O'.
  4723             88  PB-ALL-CANCEL-FORCED         VALUE '8'.
  4724             88  PB-ALL-CANCEL-FORCED-NO-FEE  VALUE '9'.
  4725             88  PB-CANCEL-DATE-FORCED        VALUE 'D'.
  4726             88  PB-CANCEL-DATE-FORCED-NO-FEE VALUE 'E'.
  4727             88  PB-ISSUE-DATE-FORCED         VALUE 'D'.
  4728             88  PB-OVERCHARGE-FORCE          VALUE 'O'.
  4729         16  PB-FATAL-FLAG                PIC X.
  4730             88  PB-FATAL-ERRORS              VALUE 'X'.
  4731         16  PB-FORCE-ER-CD               PIC X.
  4732             88  PB-FORCE-ERRORS              VALUE 'F'.
  4733             88  PB-UNFORCED-ERRORS           VALUE 'X'.
  4734         16  PB-WARN-ER-CD                PIC X.
  4735             88  PB-WARNING-ERRORS            VALUE 'W'.
  4736         16  FILLER                       PIC X.
  4737         16  PB-OUT-BAL-CD                PIC X.
  4738             88  PB-OUT-OF-BAL                VALUE 'O'.
  4739         16  PB-LIFE-OVERRIDE-L1          PIC X.
  4740         16  PB-AH-OVERRIDE-L1            PIC X.
  4741         16  PB-INPUT-DT                  PIC XX.
  4742         16  PB-INPUT-BY                  PIC X(4).
  4743         16  PB-CHG-COUNT                 PIC 9(3)        COMP-3.
  4744         16  PB-CALC-TOLERANCE            PIC 9(3)V99     COMP-3.
  4745         16  PB-TOLERANCE-REJECT-SW       PIC X.
  4746         16  PB-LF-EARNING-METHOD         PIC X.
  4747         16  PB-AH-EARNING-METHOD         PIC X.
  4748         16  PB-LF-TERM-CALC-METHOD       PIC X.
  4749         16  PB-AH-TERM-CALC-METHOD       PIC X.
  4750         16  PB-REIN-CD                   PIC XXX.
  4751         16  PB-LF-REFUND-TYPE            PIC X.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  94
* ECS010T1.cbl (/apps/prod/cid1p/copy/ERCPNDB)
  4752         16  PB-AH-REFUND-TYPE            PIC X.
  4753         16  PB-ACCT-EFF-DT               PIC XX.
  4754         16  PB-ACCT-EXP-DT               PIC XX.
  4755         16  PB-COMPANY-ID                PIC X(3).
  4756         16  PB-LF-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  4757         16  PB-AH-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  4758         16  PB-SV-CARRIER                PIC X.
  4759         16  PB-SV-GROUPING               PIC X(6).
  4760         16  PB-SV-STATE                  PIC XX.
  4761         16  PB-CONFIRMATION-REPT-DT      PIC XX.
  4762         16  PB-GA-BILLING-INFO.
  4763             20  PB-GA-BILL-DT OCCURS 5 TIMES
  4764                                          PIC XX.
  4765         16  PB-SV-REMIT-TO  REDEFINES
  4766             PB-GA-BILLING-INFO           PIC X(10).
  4767         16  PB-NO-OF-ERRORS              PIC S9(3) COMP-3.
  4768         16  PB-I-LOAN-OFFICER            PIC X(5).
  4769         16  PB-I-VIN                     PIC X(17).
  4770
  4771         16  FILLER                       PIC X(04).
  4772         16  IMNET-BYPASS-SW              PIC X.
  4773
  4774******************************************************************
  4775*                COMMON EDIT ERRORS                              *
  4776******************************************************************
  4777
  4778     12  PB-COMMON-ERRORS.
  4779         16  PB-COMMON-ERROR    OCCURS 10 TIMES
  4780                                           PIC S9(4)     COMP.
  4781
  4782******************************************************************
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  95
* ECS010T1.cbl
  4784 01  PC-STARTS-HERE              PIC X(48)
  4785       VALUE '*****   PENDING CLAIMS RECORD STARTS HERE   ****'.
  4786
* 4787                             COPY ERCPNDC.
  4788******************************************************************04/29/98
  4789*                                                                *ERCPNDC
  4790*                                                                *ERCPNDC
  4791*                            ERCPNDC                             *   LV003
  4792*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
  4793*                            VMOD=2.004                          *   CL**2
  4794*                                                                *ERCPNDC
  4795*   FILE DESCRIPTION = PENDING CLAIM TRANSACTIONS                *ERCPNDC
  4796*                      PAYMENTS, RESERVES, EXPENSES              *ERCPNDC
  4797*                                                                *ERCPNDC
  4798*   FILE TYPE = VSAM,KSDS                                        *ERCPNDC
  4799*   RECORD SIZE = 500  RECFORM = FIXED                           *ERCPNDC
  4800*                                                                *ERCPNDC
  4801*   BASE CLUSTER = ERPNDC                         RKP=2,LEN=50   *ERCPNDC
  4802*       ALTERNATE PATHS = NONE                                   *ERCPNDC
  4803*                                                                *ERCPNDC
  4804*   LOG = YES                                                    *ERCPNDC
  4805*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *ERCPNDC
  4806******************************************************************ERCPNDC
  4807                                                                  ERCPNDC
  4808 01  PENDING-CLAIMS.                                              ERCPNDC
  4809     12  PC-RECORD-ID                     PIC XX.                 ERCPNDC
  4810         88  VALID-PC-ID                      VALUE 'PC'.         ERCPNDC
  4811                                                                  ERCPNDC
  4812     12  PC-CONTROL-PRIMARY.                                      ERCPNDC
  4813         16  PC-COMPANY-CD                PIC X.                  ERCPNDC
  4814         16  PC-CARRIER                   PIC X.                  ERCPNDC
  4815         16  PC-GROUPING.                                         ERCPNDC
  4816             20  PC-GROUPING-PREFIX       PIC XXX.                ERCPNDC
  4817             20  PC-GROUPING-PRIME        PIC XXX.                ERCPNDC
  4818         16  PC-STATE                     PIC XX.                 ERCPNDC
  4819         16  PC-ACCOUNT.                                          ERCPNDC
  4820             20  PC-ACCOUNT-PREFIX        PIC X(4).               ERCPNDC
  4821             20  PC-ACCOUNT-PRIME         PIC X(6).               ERCPNDC
  4822         16  PC-CERT-EFF-DT               PIC XX.                 ERCPNDC
  4823         16  PC-CERT-NO.                                          ERCPNDC
  4824             20  PC-CERT-PRIME            PIC X(10).              ERCPNDC
  4825             20  PC-CERT-SFX              PIC X.                  ERCPNDC
  4826         16  PC-CLAIM-NO                  PIC X(7).               ERCPNDC
  4827         16  PC-CHECK-NO                  PIC X(7).               ERCPNDC
  4828                                                                  ERCPNDC
  4829         16  PC-RECORD-TYPE               PIC X.                  ERCPNDC
  4830             88  PC-CLAIMS                    VALUE '1'.          ERCPNDC
  4831             88  PC-RESERVES                  VALUE '2'.          ERCPNDC
  4832         16  PC-RECORD-SEQUENCE           PIC S9(4)     COMP.     ERCPNDC
  4833                                                                  ERCPNDC
  4834     12  PC-LAST-MAINT-DT                 PIC XX.                 ERCPNDC
  4835     12  PC-LAST-MAINT-BY                 PIC X(4).               ERCPNDC
  4836     12  PC-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.   ERCPNDC
  4837                                                                  ERCPNDC
  4838     12  PC-CLAIM-RECORD.                                         ERCPNDC
  4839         16  PC-CLAIM-TYPE                PIC X.                  ERCPNDC
  4840             88  PC-LF-CLAIM                  VALUE '1'.          ERCPNDC
  4841             88  PC-AH-CLAIM                  VALUE '2'.          ERCPNDC
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  96
* ECS010T1.cbl (/apps/prod/cid1p/copy/ERCPNDC)
  4842             88  PC-OB-LF-CLAIM               VALUE '3'.          ERCPNDC
  4843             88  PC-OB-AH-CLAIM               VALUE '4'.          ERCPNDC
  4844         16  PC-PAYMENT-DT                PIC XX.                 ERCPNDC
  4845         16  PC-PAID-THRU-DT              PIC XX.                 ERCPNDC
  4846         16  PC-REPORTED-DT               PIC XX.                 ERCPNDC
  4847         16  PC-INCURRED-DT               PIC XX.                 ERCPNDC
  4848         16  PC-NO-OF-DAYS-PAID           PIC S9(3)     COMP-3.   ERCPNDC
  4849         16  PC-CLAIM-PAYMENT             PIC S9(7)V99  COMP-3.   ERCPNDC
  4850         16  PC-AGE-AT-CLAIM              PIC 99.                 ERCPNDC
  4851         16  FILLER                       PIC XX.                 ERCPNDC
  4852         16  PC-PAYMENT-TYPE              PIC X.                  ERCPNDC
  4853             88  PC-PARTIAL-PAYMENT           VALUE '1'.          ERCPNDC
  4854             88  PC-FINAL-PAYMENT             VALUE '2'.          ERCPNDC
  4855             88  PC-LUMP-SUM-PAYMENT          VALUE '3'.          ERCPNDC
  4856             88  PC-ADDITIONAL-PAYMENT        VALUE '4'.          ERCPNDC
  4857             88  PC-CHARGEBLE-EXPENSE         VALUE '5'.          ERCPNDC
  4858             88  PC-NON-CHARGEBLE-EXPENSE     VALUE '6'.          ERCPNDC
  4859             88  PC-VOIDED-PAYMENT            VALUE '9'.          ERCPNDC
  4860                                                                  ERCPNDC
  4861         16  PC-FUTURE-RESERVE-AMT        PIC S9(7)V99  COMP-3.   ERCPNDC
  4862         16  PC-IBNR-RESERVE-AMT          PIC S9(7)V99  COMP-3.   ERCPNDC
  4863         16  PC-PTC-RESERVE-AMT           PIC S9(7)V99  COMP-3.   ERCPNDC
  4864         16  PC-MANUAL-RESERVE-AMT        PIC S9(7)V99  COMP-3.   ERCPNDC
  4865                                                                  ERCPNDC
  4866         16  PC-SV-CARRIER                PIC X.                  ERCPNDC
  4867         16  PC-SV-GROUPING               PIC X(6).               ERCPNDC
  4868         16  PC-SV-STATE                  PIC XX.                 ERCPNDC
  4869                                                                  ERCPNDC
  4870         16  PC-VOID-SW                   PIC X.                  ERCPNDC
  4871             88  PC-PUT-CERT-INFORCE          VALUE '1'.          ERCPNDC
  4872                                                                  ERCPNDC
  4873         16  PC-CAUSE-CODE                PIC X(6).               ERCPNDC
  4874         16  FILLER                       PIC X(48).              ERCPNDC
  4875                                                                  ERCPNDC
  4876         16  PC-CLAIMED-CERT-DATA.                                ERCPNDC
  4877             20  PC-CC-INSURED-NAME.                              ERCPNDC
  4878                 24  PC-CC-LAST-NAME      PIC X(15).              ERCPNDC
  4879                 24  PC-CC-INITIALS       PIC XX.                 ERCPNDC
  4880             20  PC-CC-INSURED-AGE        PIC S99.                ERCPNDC
  4881             20  PC-CC-INSURED-SEX        PIC X.                  ERCPNDC
  4882             20  PC-CC-ORIG-TERM          PIC S999        COMP-3. ERCPNDC
  4883             20  PC-CC-LF-BENEFIT-CD      PIC XX.                 ERCPNDC
  4884             20  PC-CC-LIFE-BENEFIT-AMT   PIC S9(9)V99    COMP-3. ERCPNDC
  4885             20  PC-CC-ALT-LF-BENEFIT-AMT PIC S9(9)V99    COMP-3. ERCPNDC
  4886             20  PC-CC-LIFE-PREMIUM       PIC S9(7)V99    COMP-3. ERCPNDC
  4887             20  PC-CC-AH-BENEFIT-CD      PIC XX.                 ERCPNDC
  4888             20  PC-CC-AH-BENEFIT-AMT     PIC S9(7)V99    COMP-3. ERCPNDC
  4889             20  PC-CC-AH-PREMIUM-AMT     PIC S9(7)V99    COMP-3. ERCPNDC
  4890             20  PC-CC-RATE-CLASS         PIC XX.                 ERCPNDC
  4891             20  PC-CC-RATE-DEV           PIC XXX.                ERCPNDC
  4892             20  PC-CC-OB-FLAG            PIC X.                  ERCPNDC
  4893                 88  PC-CC-OB                VALUE 'B'.           ERCPNDC
  4894             20  PC-CC-AH-POLICY-STATUS   PIC X.                  ERCPNDC
  4895                 88  PC-CCA-POLICY-IS-ACTIVE        VALUE '1' '3' ERCPNDC
  4896                                               '4' '5' '9' '2'.   ERCPNDC
  4897                 88  PC-CCA-NORMAL-ENTRY            VALUE '1'.    ERCPNDC
  4898                 88  PC-CCA-POLICY-PENDING          VALUE '2'.    ERCPNDC
  4899                 88  PC-CCA-POLICY-IS-RESTORE       VALUE '3'.    ERCPNDC
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  97
* ECS010T1.cbl (/apps/prod/cid1p/copy/ERCPNDC)
  4900                 88  PC-CCA-CONVERSION-ENTRY        VALUE '4'.    ERCPNDC
  4901                 88  PC-CCA-POLICY-IS-REISSUE       VALUE '5'.    ERCPNDC
  4902                 88  PC-CCA-LUMP-SUM-DISAB          VALUE '6'.    ERCPNDC
  4903                 88  PC-CCA-DEATH-CLAIM-APPLIED     VALUE '7'.    ERCPNDC
  4904                 88  PC-CCA-CANCEL-APPLIED          VALUE '8'.    ERCPNDC
  4905                 88  PC-CCA-REIN-ONLY               VALUE '9'.    ERCPNDC
  4906             20  PC-CC-LF-POLICY-STATUS   PIC X.                  ERCPNDC
  4907                 88  PC-CCL-POLICY-IS-ACTIVE        VALUE '1' '3' ERCPNDC
  4908                                               '4' '5' '9' '2'.   ERCPNDC
  4909                 88  PC-CCL-NORMAL-ENTRY            VALUE '1'.    ERCPNDC
  4910                 88  PC-CCL-POLICY-PENDING          VALUE '2'.    ERCPNDC
  4911                 88  PC-CCL-POLICY-IS-RESTORE       VALUE '3'.    ERCPNDC
  4912                 88  PC-CCL-CONVERSION-ENTRY        VALUE '4'.    ERCPNDC
  4913                 88  PC-CCL-POLICY-IS-REISSUE       VALUE '5'.    ERCPNDC
  4914                 88  PC-CCL-LUMP-SUM-DISAB          VALUE '6'.    ERCPNDC
  4915                 88  PC-CCL-DEATH-CLAIM-APPLIED     VALUE '7'.    ERCPNDC
  4916                 88  PC-CCL-CANCEL-APPLIED          VALUE '8'.    ERCPNDC
  4917                 88  PC-CCL-REIN-ONLY               VALUE '9'.    ERCPNDC
  4918             20  PC-CC-PAY-FREQUENCY      PIC 99.                 ERCPNDC
  4919             20  PC-CC-LOAN-APR           PIC 9(3)V9(4)   COMP-3. ERCPNDC
  4920             20  PC-CC-SOC-SEC-NO         PIC X(11).              ERCPNDC
  4921             20  PC-CC-MEMBER-NO          PIC X(12).              ERCPNDC
  4922             20  PC-CC-INT-CODE           PIC X.                  ERCPNDC
  4923                 88  PC-CC-ADD-ON                  VALUE 'A'.     ERCPNDC
  4924                 88  PC-CC-SIMPLE                  VALUE 'S'.     ERCPNDC
  4925             20  PC-CC-CAPPED-TERM        PIC 999.                ERCPNDC
  4926             20  PC-CC-PRIOR-LUMP-PMT     PIC S9(7)V99  COMP-3.   ERCPNDC
  4927             20  PC-CC-PRIOR-DEATH-AMT    PIC S9(9)V99  COMP-3.   ERCPNDC
  4928             20  PC-CC-CANCEL-DT          PIC XX.                 ERCPNDC
  4929             20  PC-CC-DEATH-DT           PIC XX.                 ERCPNDC
  4930             20  PC-CC-SETTLEMENT-DT      PIC XX.                 ERCPNDC
  4931             20  PC-CC-PRIOR-STATUS       PIC X.                  ERCPNDC
  4932             20  PC-CC-CERT-ENTRY-STATUS  PIC X.                  ERCPNDC
  4933         16  PC-TRLR-SEQ-NO               PIC S9(4)     COMP.     ERCPNDC
  4934         16  PC-CC-CLP-STATE              PIC XX.
  4935         16  FILLER                       PIC X(14).              ERCPNDC
  4936         16  PC-REMAINING-BENEFIT         PIC S9(9)V99  COMP-3.   ERCPNDC
  4937         16  PC-REMAINING-TERM            PIC S9(3)     COMP-3.   ERCPNDC
  4938         16  FILLER                       PIC X(34).              ERCPNDC
  4939                                                                  ERCPNDC
  4940     12  PC-RECORD-STATUS.                                        ERCPNDC
  4941         16  PC-CREDIT-SELECT-DT          PIC XX.                 ERCPNDC
  4942         16  PC-CREDIT-ACCEPT-DT          PIC XX.                 ERCPNDC
  4943         16  FILLER                       PIC XX.                 ERCPNDC
  4944         16  PC-FATAL-FLAG                PIC X.                  ERCPNDC
  4945             88  PC-FATAL-ERRORS             VALUE 'X'.           ERCPNDC
  4946         16  PC-FORCE-CODE                PIC X.                  ERCPNDC
  4947             88  PC-FORCE-OFF                VALUE ' ' '0'.       ERCPNDC
  4948             88  PC-CLAIM-FORCE              VALUE '6' '7'        ERCPNDC
  4949                                                     '8'.         ERCPNDC
  4950         16  PC-FORCE-ER-CD               PIC X.                  ERCPNDC
  4951             88  PC-FORCE-ERRORS             VALUE 'F'.           ERCPNDC
  4952             88  PC-UNFORCED-ERRORS          VALUE 'X'.           ERCPNDC
  4953         16  PC-WARN-ER-CD                PIC X.                  ERCPNDC
  4954             88  PC-WARNING-ERRORS           VALUE 'W'.           ERCPNDC
  4955         16  PC-LF-OVERRIDE-L1            PIC X.                  ERCPNDC
  4956         16  PC-AH-OVERRIDE-L1            PIC X.                  ERCPNDC
  4957         16  FILLER                       PIC X(17).              ERCPNDC
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  98
* ECS010T1.cbl (/apps/prod/cid1p/copy/ERCPNDC)
  4958         16  PC-CERT-UPDATE-SW            PIC X.                  ERCPNDC
  4959             88  PC-CERT-DATA-CAPTURED       VALUE '1'.           ERCPNDC
  4960         16  PC-COMPANY-ID                PIC XXX.                ERCPNDC
  4961         16  PC-INPUT-DT                  PIC XX.                 ERCPNDC
  4962                                                                  ERCPNDC
  4963     12  PC-ERROR-FLAGS.                                          ERCPNDC
  4964         16  PC-STANDARD-ERRORS.                                  ERCPNDC
  4965             20  PC-STD-ERROR-FLAGS   OCCURS 25 TIMES PIC X.      ERCPNDC
  4966         16  PC-TRANSACTION-ERRORS.                               ERCPNDC
  4967             20  PC-TRN-ERROR-FLAGS   OCCURS 75 TIMES PIC X.      ERCPNDC
  4968                                                                  ERCPNDC
  4969     12  PC-ERR-FLAGS-R REDEFINES  PC-ERROR-FLAGS.                ERCPNDC
  4970         16  PC-ERR-FLAG              OCCURS 100 TIMES PIC X.     ERCPNDC
  4971                                                                  ERCPNDC
  4972     12  FILLER                           PIC X(25).              ERCPNDC
  4973                                                                  ERCPNDC
  4974******************************************************************ERCPNDC
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  99
* ECS010T1.cbl
  4976 01  CC-STARTS-HERE              PIC X(48)
  4977       VALUE '***** CERTIFICATE CHANGE RECORD STARTS HERE ****'.
  4978
* 4979                             COPY ERCCRTC.
  4980******************************************************************04/29/98
  4981*                                                                *ERCCRTC
  4982*                                                                *ERCCRTC
  4983*                            ERCCRTC                             *   LV003
  4984*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  4985*                            VMOD=2.005                          *   CL**3
  4986*                                                                *ERCCRTC
  4987*   FILE DESCRIPTION = PENDING CHANGES TO CERTIFICATE RECORD     *ERCCRTC
  4988*                      (MAINTENANCE ONLY - SEE ERCPNDB FOR NEW   *ERCCRTC
  4989*                       ISSUES AND CANCELS)                      *ERCCRTC
  4990*   FILE TYPE = VSAM,KSDS                                        *ERCCRTC
  4991*   RECORD SIZE = 300  RECFORM = FIXED                           *ERCCRTC
  4992*                                                                *ERCCRTC
  4993*   BASE CLUSTER = ERCRTC                         RKP=2,LEN=37   *ERCCRTC
  4994*       ALTERNATE PATHS = NONE                                   *ERCCRTC
  4995*                                                                *ERCCRTC
  4996*   LOG = YES                                                    *ERCCRTC
  4997*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *ERCCRTC
  4998******************************************************************ERCCRTC
  4999*                   C H A N G E   L O G
  5000*
  5001* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5002*-----------------------------------------------------------------
  5003*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5004* EFFECTIVE    NUMBER
  5005*-----------------------------------------------------------------
  5006* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  5007******************************************************************
  5008 01  PENDING-MAINT-TO-CERT-FILE.                                  ERCCRTC
  5009     12  CC-RECORD-ID                     PIC XX.                 ERCCRTC
  5010         88  VALID-CC-ID                        VALUE 'CC'.       ERCCRTC
  5011                                                                  ERCCRTC
  5012     12  CC-CONTROL-PRIMARY.                                      ERCCRTC
  5013         16  CC-COMPANY-CD                PIC X.                  ERCCRTC
  5014         16  CC-CARRIER                   PIC X.                  ERCCRTC
  5015         16  CC-GROUPING                  PIC X(6).               ERCCRTC
  5016         16  CC-STATE                     PIC XX.                 ERCCRTC
  5017         16  CC-ACCOUNT                   PIC X(10).              ERCCRTC
  5018         16  CC-CERT-EFF-DT               PIC XX.                 ERCCRTC
  5019         16  CC-CERT-NO.                                          ERCCRTC
  5020             20  CC-CERT-PRIME            PIC X(10).              ERCCRTC
  5021             20  CC-CERT-SFX              PIC X.                  ERCCRTC
  5022                                                                  ERCCRTC
  5023         16  CC-FILE-SEQ-NO               PIC S9(8)     COMP.     ERCCRTC
  5024                                                                  ERCCRTC
  5025     12  CC-LAST-MAINT-DT                 PIC XX.                 ERCCRTC
  5026     12  CC-LAST-MAINT-BY                 PIC X(4).               ERCCRTC
  5027     12  CC-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.   ERCCRTC
  5028                                                                  ERCCRTC
  5029     12  CC-RECORD-BODY                   PIC X(191).             ERCCRTC
  5030                                                                  ERCCRTC
  5031     12  CC-CHANGES-RECORD   REDEFINES CC-RECORD-BODY.            ERCCRTC
  5032         16  FILLER                       PIC X(10).              ERCCRTC
  5033         16  CC-NAME.                                             ERCCRTC
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 100
* ECS010T1.cbl (/apps/prod/cid1p/copy/ERCCRTC)
  5034             20  CC-INSURED-LAST-NAME     PIC X(15).              ERCCRTC
  5035             20  CC-INSURED-FIRST-NAME.                           ERCCRTC
  5036                 24  CC-INSURED-1ST-INIT  PIC X.                  ERCCRTC
  5037                 24  FILLER               PIC X(9).               ERCCRTC
  5038             20  CC-INSURED-INITIAL2      PIC XX.                 ERCCRTC
  5039         16  CC-AGE                       PIC S99.                ERCCRTC
  5040         16  CC-INSURED-JOINT-AGE         PIC S99.                ERCCRTC
  5041         16  CC-BIRTHDAY                  PIC XX.                 ERCCRTC
  5042         16  CC-INSURED-SEX               PIC X.                  ERCCRTC
  5043             88  CC-SEX-MALE                 VALUE 'M'.           ERCCRTC
  5044             88  CC-SEX-FEMALE               VALUE 'F'.           ERCCRTC
  5045         16  CC-JOINT-INSURED-NAME.                               ERCCRTC
  5046             20  CC-JT-LAST-NAME          PIC X(15).              ERCCRTC
  5047             20  CC-JT-FIRST-NAME.                                ERCCRTC
  5048                 24  CC-JT-1ST-INIT       PIC X.                  ERCCRTC
  5049                 24  FILLER               PIC X(9).               ERCCRTC
  5050             20  CC-JT-INITIAL            PIC X.                  ERCCRTC
  5051         16  CC-LOAN-APR                  PIC 9(3)V9(4).          ERCCRTC
  5052         16  CC-PAY-FREQUENCY             PIC S99.                ERCCRTC
  5053         16  CC-BENEFICIARY               PIC X(25).              ERCCRTC
  5054         16  CC-POLICY-FORM-NO            PIC X(12).              ERCCRTC
  5055         16  CC-PREMIUM-TYPE              PIC X.                  ERCCRTC
  5056         16  CC-IND-GRP-TYPE              PIC X.                  ERCCRTC
  5057         16  CC-LOAN-NUMBER               PIC X(8).               ERCCRTC
  5058         16  CC-LOAN-BALANCE              PIC S9(7)V99  COMP-3.   ERCCRTC
  5059         16  CC-OLD-LOF                   PIC XXX.
  5060*        16  CC-LOAN-OFFICER              PIC XXX.                ERCCRTC
  5061         16  CC-USER-FIELD                PIC X.                  ERCCRTC
  5062         16  CC-SOC-SEC-NO                PIC X(11).              ERCCRTC
  5063         16  CC-MEMBER-NO                 PIC X(12).              ERCCRTC
  5064         16  CC-LF-ORIG-TERM              PIC S9(3).              ERCCRTC
  5065         16  CC-AH-ORIG-TERM              PIC S9(3).              ERCCRTC
  5066         16  FILLER                       PIC X(3).               ERCCRTC
  5067         16  CC-CLAIM-DEDUCT-WITHHELD     PIC S9(5)V99  COMP-3.   ERCCRTC
  5068         16  CC-CANCEL-DEDUCT-WITHHELD    PIC S9(5)V99  COMP-3.   ERCCRTC
  5069         16  CC-LIVES                     PIC S9(7)     COMP-3.   ERCCRTC
  5070         16  CC-BILLED                    PIC S9(7)     COMP-3.   ERCCRTC
  5071         16  CC-LOAN-OFFICER              PIC X(5).
  5072         16  FILLER                       PIC XXX.                ERCCRTC
  5073     12  CC-RECORD-STATUS.                                        ERCCRTC
  5074         16  CC-CREDIT-SELECT-DT          PIC XX.                 ERCCRTC
  5075         16  CC-CREDIT-ACCEPT-DT          PIC XX.                 ERCCRTC
  5076     12  CC-ADDITIONAL-LF-DATA.                                   ERCCRTC
  5077         16  CC-LF-BENEFIT-CD             PIC XX.                 ERCCRTC
  5078         16  CC-LF-PREMIUM-AMT            PIC S9(7)V99  COMP-3.   ERCCRTC
  5079         16  CC-LF-BENEFIT-AMT            PIC S9(9)V99  COMP-3.   ERCCRTC
  5080         16  CC-LF-EXPIRY-DT              PIC XX.                 ERCCRTC
  5081     12  CC-INPUT-DT                      PIC XX.                 ERCCRTC
  5082     12  CC-ERROR-FLAGS.                                          ERCCRTC
  5083         16  CC-STANDARD-ERRORS.                                  ERCCRTC
  5084             20  FILLER                   PIC X    OCCURS 10.     ERCCRTC
  5085         16  CC-TRANSACTION-ERRORS.                               ERCCRTC
  5086             20  FILLER                   PIC X    OCCURS 10.     ERCCRTC
  5087     12  CC-ADDITIONAL-AH-DATA.                                   ERCCRTC
  5088         16  CC-AH-BENEFIT-CD             PIC XX.                 ERCCRTC
  5089         16  CC-AH-PREMIUM-AMT            PIC S9(7)V99  COMP-3.   ERCCRTC
  5090         16  CC-AH-BENEFIT-AMT            PIC S9(7)V99  COMP-3.   ERCCRTC
  5091         16  CC-AH-EXPIRY-DT              PIC XX.                 ERCCRTC
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 101
* ECS010T1.cbl (/apps/prod/cid1p/copy/ERCCRTC)
  5092                                                                  ERCCRTC
  5093     12  FILLER                           PIC X(05).              ERCCRTC
  5094******************************************************************ERCCRTC
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 102
* ECS010T1.cbl
  5096 01  CR-STARTS-HERE              PIC X(48)
  5097       VALUE '***** CERTIFICATE MASTER RECORD STARTS HERE ****'.
  5098
* 5099                             COPY ECSCRT01.
  5100******************************************************************
  5101*                                                                *
  5102*                            ECSCRT01                            *
  5103*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5104*                            VMOD=2.016                          *
  5105*                                                                *
  5106*   FILE DESCRIPTION = CERTIFICATE RECORD    (OFF-LINE)          *
  5107*                                                                *
  5108*   FILE TYPE = SEQUENTIAL
  5109*   RECORD SIZE = 1056 RECFORM = FIXED                           *
  5110*                                                                *
  5111*   KEY DATA =                         START=4, LEN=36           *
  5112*                                                                *
  5113*  NO  CID  MODS  IN  COPYBOOK  ECSCRT01                         *
  5114*                                                                *
  5115******************************************************************
  5116******************************************************************
  5117*                   C H A N G E   L O G
  5118*
  5119* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5120*-----------------------------------------------------------------
  5121*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5122* EFFECTIVE    NUMBER
  5123*-----------------------------------------------------------------
  5124* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  5125* 100703    2003080800002  PEMA  ADD SUPER GAP PROCESSING
  5126* 040504    2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  5127* 020305    2005020000000  PEMA  ADD CLP STATE TO CERT RECORD
  5128* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  5129* 042408    2007110500003  PEMA  ADD REFUND INTEREST PROCESSING
  5130* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  5131* 032612  CR2011110200001  PEMA  AHL CHANGES
  5132* 052814  CR2014012300001  PEMA  DCC CREDIT UNION CHANGES
  5133* 090314  CR2014081300001  PEMA  LOAD CERTS INVOLVED IN THAO
  5134******************************************************************
  5135
  5136 01  CERTIFICATE-RECORD.
  5137     12  CR-RECORD-ID                      PIC XX.
  5138         88  VALID-CR-ID                      VALUE 'CR'.
  5139
  5140     12  CR-COMPANY-CD                     PIC X.
  5141
  5142     12  CR-FULL-CONTROL.
  5143         16  CR-CONTROL-1.
  5144             20  CR-ACCT-CONTROL.
  5145                 24  CR-CARRIER            PIC X.
  5146                 24  CR-GROUPING.
  5147                     28  CR-GROUP-PREFIX   PIC XXX.
  5148                     28  CR-GROUP-PRIME    PIC XXX.
  5149                 24  CR-STATE              PIC XX.
  5150                 24  CR-ACCOUNT.
  5151                     28  CR-ACCT-PREFIX    PIC X(4).
  5152                     28  CR-ACCT-PRIME     PIC X(6).
  5153             20  CR-DT                     PIC 9(11)  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 103
* ECS010T1.cbl (/apps/prod/cid1p/copy/ECSCRT01)
  5154         16  CR-CERT-NO.
  5155             20  CR-CERT.
  5156                 24  CR-CERT-PREFIX        PIC X(3).
  5157                 24  CR-CERT-PRIME         PIC X(7).
  5158             20  CR-CERT-SFX               PIC X.
  5159
  5160     12  CR-INSUREDS-PROFILE.
  5161         16  CR-NAME.
  5162             20  CR-LNAME                  PIC X(15).
  5163             20  CR-FNAME.
  5164                 24  CR-1ST-INITIAL        PIC X.
  5165                 24  FILLER                PIC X(9).
  5166             20  CR-INIT                   PIC X.
  5167         16  CR-AGE                        PIC 99.
  5168         16  CR-SEX                        PIC X.
  5169             88  CR-SEX-MALE                  VALUE 'M'.
  5170             88  CR-SEX-FEMALE                VALUE 'F'.
  5171         16  CR-SOC-SEC                    PIC X(11).
  5172         16  CR-JOINT-NAME.
  5173             20  CR-JT-LNAME               PIC X(15).
  5174             20  CR-JT-FNAME.
  5175                 24  CR-JT-1ST-INIT        PIC X.
  5176                 24  FILLER                PIC X(9).
  5177             20  CR-JT-INIT                PIC X.
  5178         16  CR-JOINT-AGE                  PIC 99.
  5179
  5180         16  cr-ahl-ah-claim-no            pic x(9).
  5181         16  cr-ahl-ah-cert-seq            pic x(3).
  5182         16  cr-hst-proc-lf                pic x.
  5183         16  f                             pic x(7).
  5184
  5185     12  CR-LF-COVERAGE-DATA.
  5186         16  CR-LFTYP                      PIC XX.
  5187         16  CR-LF-TERM                    PIC S999       COMP-3.
  5188         16  CR-LF-CRIT-PERIOD             PIC S999       COMP-3.
  5189         16  CR-LF-TERM-IN-DAYS            PIC S9(5)      COMP-3.
  5190         16  CR-LF-DEV-CODE                PIC XXX.
  5191         16  CR-LF-DEV-PCT                 PIC S9V9(6)    COMP-3.
  5192
  5193         16  CR-LFAMT                      PIC S9(9)V99   COMP-3.
  5194         16  CR-LFPRM                      PIC S9(7)V99   COMP-3.
  5195         16  CR-LFPRM-CALC                 PIC S9(7)V99   COMP-3.
  5196         16  CR-LFPRM-RATE                 PIC S99V9(5)   COMP-3.
  5197
  5198         16  CR-LFAMT-ALT                  PIC S9(9)V99   COMP-3.
  5199         16  CR-LFPRM-ALT                  PIC S9(7)V99   COMP-3.
  5200         16  CR-LFPRM-CALC-ALT             PIC S9(7)V99   COMP-3.
  5201         16  CR-LFPRM-RATE-ALT             PIC S99V9(5)   COMP-3.
  5202
  5203         16  CR-LFRFND                     PIC S9(7)V99   COMP-3.
  5204         16  CR-LFRFND-CALC                PIC S9(7)V99   COMP-3.
  5205
  5206         16  CR-LF-NSP-PRM                 PIC S9(7)V99   COMP-3.
  5207         16  CR-LF-NSP-PRM-RATE            PIC S99V9(5)   COMP-3.
  5208
  5209         16  CR-LF-REFUND-TYPE             PIC X.
  5210         16  CR-LF-POLICY-FEE              PIC S9(3)V99   COMP-3.
  5211
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 104
* ECS010T1.cbl (/apps/prod/cid1p/copy/ECSCRT01)
  5212         16  CR-LF-COMM-CHARGEBACK         PIC X.
  5213             88  CR-NO-LF-CHARGEBACK          VALUE 'N'.
  5214
  5215         16  CR-LF-REI-RISK-PRM            PIC S9(7)V99   COMP-3.
  5216
  5217         16  CR-LF-EXPIRE-DATE             PIC 9(11)      COMP-3.
  5218         16  CR-LF-ISS-PREM-TAX            PIC S9V9(4)    COMP-3.
  5219         16  CR-LF-CNC-PREM-TAX            PIC S9V9(4)    COMP-3.
  5220
  5221         16  cr-ahl-lf-claim-no            pic x(9).
  5222         16  cr-ahl-lf-cert-seq            pic x(3).
  5223         16  FILLER                        PIC XX.
  5224
  5225     12  CR-AH-COVERAGE-DATA.
  5226         16  CR-AHTYP                      PIC XX.
  5227         16  CR-AH-TERM                    PIC S999       COMP-3.
  5228         16  CR-AH-CRIT-PERIOD             PIC S999       COMP-3.
  5229         16  CR-AH-DEV-CODE                PIC XXX.
  5230         16  CR-AH-DEV-PCT                 PIC S9V9(6)    COMP-3.
  5231
  5232         16  CR-AHAMT                      PIC S9(7)V99   COMP-3.
  5233         16  CR-AHPRM                      PIC S9(7)V99   COMP-3.
  5234         16  CR-AHPRM-CALC                 PIC S9(7)V99   COMP-3.
  5235         16  CR-AHPRM-RATE                 PIC S99V9(5)   COMP-3.
  5236
  5237         16  CR-AHRFND                     PIC S9(7)V99   COMP-3.
  5238         16  CR-AHRFND-CALC                PIC S9(7)V99   COMP-3.
  5239
  5240         16  CR-AH-NSP-PRM                 PIC S9(7)V99   COMP-3.
  5241         16  CR-AH-NSP-PRM-RATE            PIC S99V9(5)   COMP-3.
  5242
  5243         16  CR-AH-REFUND-TYPE             PIC X.
  5244         16  CR-AH-POLICY-FEE              PIC S9(3)V99   COMP-3.
  5245
  5246         16  CR-AH-COMM-CHARGEBACK         PIC X.
  5247             88  CR-NO-AH-CHARGEBACK          VALUE 'N'.
  5248
  5249         16  CR-AH-REI-RISK-PRM            PIC S9(7)V99   COMP-3.
  5250
  5251         16  CR-AH-EXPIRE-DATE             PIC 9(11)      COMP-3.
  5252         16  CR-AH-ISS-PREM-TAX            PIC S9V9(4)    COMP-3.
  5253         16  CR-AH-CNC-PREM-TAX            PIC S9V9(4)    COMP-3.
  5254
  5255         16  FILLER                        PIC XX.
  5256*        16  FILLER                        PIC X(8).
  5257
  5258     12  CR-LOAN-DATA.
  5259         16  CR-LIVES                      PIC S9(7)      COMP-3.
  5260         16  CR-DDF-IU-RATE-UP REDEFINES CR-LIVES
  5261                                           PIC S9(5)V99   COMP-3.
  5262         16  CR-BILLED                     PIC S9(7)      COMP-3.
  5263         16  CR-APR                        PIC S999V9(4)  COMP-3.
  5264         16  CR-PMT-FREQ                   PIC 99.
  5265         16  CR-LOAN-TERM                  PIC S999       COMP-3.
  5266         16  CR-RATING-CLASS               PIC XX.
  5267         16  CR-POLICY-FORM-NO             PIC X(12).
  5268         16  CR-GRPTYP                     PIC XX.
  5269         16  CR-IND-GRP                    PIC X.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 105
* ECS010T1.cbl (/apps/prod/cid1p/copy/ECSCRT01)
  5270             88  CR-INDIVIDUAL                VALUE '1'.
  5271             88  CR-GROUP                     VALUE '2'.
  5272         16  CR-SKIP                       PIC 99.
  5273             88  NO-MONTHS-SKIPPED            VALUE 00.
  5274             88  SKIP-JULY                    VALUE 01.
  5275             88  SKIP-AUGUST                  VALUE 02.
  5276             88  SKIP-SEPTEMBER               VALUE 03.
  5277             88  SKIP-JULY-AUG                VALUE 04.
  5278             88  SKIP-AUG-SEPT                VALUE 05.
  5279             88  SKIP-JULY-AUG-SEPT           VALUE 06.
  5280             88  SKIP-JUNE-JULY-AUG           VALUE 07.
  5281             88  SKIP-JUNE                    VALUE 08.
  5282             88  SKIP-JUNE-JULY               VALUE 09.
  5283             88  SKIP-AUG-SEPT-OCT            VALUE 10.
  5284             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 11.
  5285         16  CR-RESIDENT-STATE             PIC XX.
  5286         16  CR-RATE-CODE.
  5287             20  CR-LF-CLASS-CD            PIC XX.
  5288             20  CR-AH-CLASS-CD            PIC XX.
  5289         16  CR-MORT.
  5290             20  CR-TAB                    PIC X.
  5291             20  CR-INT                    PIC 99.
  5292             20  CR-GRP                    PIC X.
  5293         16  CR-MEMBER-NO                  PIC X(12).
  5294         16  CR-OLD-LOF                    PIC XXX.
  5295*        16  CR-LOAN-OFFICER               PIC XXX.
  5296         16  CR-REIN-TABLE                 PIC XXX.
  5297         16  CR-REIN-SPEC                  PIC X.
  5298         16  CR-LOAN-1ST-PMT-DT.
  5299             20  CR-1ST-PMT-YR             PIC 99.
  5300             20  CR-1ST-PMT-MO             PIC 99.
  5301             20  CR-1ST-PMT-DA             PIC 99.
  5302         16  CR-SUM-CAN-CNT-ITD            PIC S999       COMP-3.
  5303         16  CR-SUM-CAN-CNT-YTD            PIC S999       COMP-3.
  5304         16  CR-PMT-EXTENSION-DAYS         PIC S999       COMP-3.
  5305         16  CR-LAST-ADD-ON-DT             PIC XX.
  5306
  5307         16  CR-UNDERWRITING-CODE          PIC X.
  5308             88  CR-POLICY-UNDERWRITTEN       VALUE 'Y'.
  5309
  5310         16  CR-STATE-TAX                  PIC S9(7)V99   COMP-3.
  5311         16  CR-MUNI-TAX                   PIC S9(7)V99   COMP-3.
  5312         16  CR-CANCEL-STATE-TAX           PIC S9(7)V99   COMP-3.
  5313         16  CR-CANCEL-MUNI-TAX            PIC S9(7)V99   COMP-3.
  5314
  5315     12  CR-STATUS-INFORMATION.
  5316         16  CR-ENTRY-STATUS               PIC X.
  5317             88  CR-NORMAL-ENTRY              VALUE '1'.
  5318             88  CR-POLICY-IS-RESTORE         VALUE '3'.
  5319             88  CR-CONVERSION-ENTRY          VALUE '4'.
  5320             88  CR-POLICY-IS-REISSUE         VALUE '5'.
  5321             88  CR-POLICY-IS-CASH            VALUE 'C'.
  5322             88  CR-POLICY-IS-MONTHLY         VALUE 'M'.
  5323             88  CR-POLICY-IS-REIN-ONLY       VALUE '9'.
  5324             88  CR-POLICY-IS-DECLINED        VALUE 'D'.
  5325             88  CR-POLICY-IS-VOID            VALUE 'V'.
  5326             88  CR-POLICY-IS-PREM-ONLY       VALUE 'P'.
  5327             88  CR-POLICY-IS-ACTIVE          VALUE '1' '3' '4'
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 106
* ECS010T1.cbl (/apps/prod/cid1p/copy/ECSCRT01)
  5328                                                'C' '5' '9' 'P'.
  5329         16  CR-ENTRY-DATE                 PIC 9(11)  COMP-3.
  5330
  5331         16  CR-LF-STATUS-AT-CANCEL        PIC X.
  5332         16  CR-LF-CANC-DT                 PIC 9(11)  COMP-3.
  5333         16  CR-LF-CANCEL-EXIT-DATE        PIC 9(11)  COMP-3.
  5334
  5335         16  CR-LF-STATUS-AT-DEATH         PIC X.
  5336         16  CR-LF-CLAIM-EXIT-DATE         PIC 9(11)  COMP-3.
  5337
  5338         16  CR-LF-CURRENT-STATUS          PIC X.
  5339             88  CR-LF-NORMAL-ENTRY           VALUE '1'.
  5340             88  CR-LF-POLICY-PENDING         VALUE '2'.
  5341             88  CR-LF-POLICY-IS-RESTORE      VALUE '3'.
  5342             88  CR-LF-CONVERSION-ENTRY       VALUE '4'.
  5343             88  CR-LF-POLICY-IS-REISSUE      VALUE '5'.
  5344             88  CR-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  5345             88  CR-LF-LUMP-SUM-DISAB         VALUE '6'.
  5346             88  CR-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  5347             88  CR-LF-CANCEL-APPLIED         VALUE '8'.
  5348             88  CR-LF-IS-REIN-ONLY           VALUE '9'.
  5349             88  CR-LF-IS-DECLINED            VALUE 'D'.
  5350             88  CR-LF-IS-VOID                VALUE 'V'.
  5351             88  CR-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  5352                                                    '4' '5' '9'.
  5353
  5354         16  CR-AH-STATUS-AT-CANCEL        PIC X.
  5355
  5356         16  CR-AH-CANC-DT                 PIC 9(11)  COMP-3.
  5357         16  CR-AH-CANCEL-EXIT-DATE        PIC 9(11)  COMP-3.
  5358
  5359         16  CR-AH-STATUS-AT-SETTLEMENT    PIC X.
  5360         16  CR-AH-SETTLEMENT-EXIT-DATE    PIC 9(11)  COMP-3.
  5361
  5362         16  CR-AH-CURRENT-STATUS          PIC X.
  5363             88  CR-AH-NORMAL-ENTRY           VALUE '1'.
  5364             88  CR-AH-POLICY-PENDING         VALUE '2'.
  5365             88  CR-AH-POLICY-IS-RESTORE      VALUE '3'.
  5366             88  CR-AH-CONVERSION-ENTRY       VALUE '4'.
  5367             88  CR-AH-POLICY-IS-REISSUE      VALUE '5'.
  5368             88  CR-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  5369             88  CR-AH-LUMP-SUM-DISAB         VALUE '6'.
  5370             88  CR-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  5371             88  CR-AH-CANCEL-APPLIED         VALUE '8'.
  5372             88  CR-AH-IS-REIN-ONLY           VALUE '9'.
  5373             88  CR-AH-IS-DECLINED            VALUE 'D'.
  5374             88  CR-AH-IS-VOID                VALUE 'V'.
  5375             88  CR-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  5376                                                    '4' '5' '9'.
  5377         16  CR-LOAN-OFFICER               PIC X(5).
  5378         16  CR-CANCEL-REASON              PIC X.
  5379         16  cr-xycor-lf-cov-code          pic x(4).
  5380         16  cr-xycor-ah-cov-code          pic x(4).
  5381         16  cr-temp-epiq                  pic x(4).
  5382         16  FILLER                        PIC XX.
  5383
  5384     12  CR-DEATH-CLAIM-DATA.
  5385         16  CR-NUM-DTH-CLM                PIC S999       COMP-3.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 107
* ECS010T1.cbl (/apps/prod/cid1p/copy/ECSCRT01)
  5386
  5387         16  CR-DTH-DT                     PIC 9(11)      COMP-3.
  5388         16  CR-DTH-RPT-DT.
  5389             20  CR-DTH-RPT-YR             PIC 99.
  5390             20  CR-DTH-RPT-MO             PIC 99.
  5391             20  CR-DTH-RPT-DA             PIC 99.
  5392         16  CR-DTH-PAY-DT                 PIC 9(11)      COMP-3.
  5393
  5394         16  CR-DTHAMT                     PIC S9(9)V99   COMP-3.
  5395         16  CR-DTHAMT-YTD                 PIC S9(9)V99   COMP-3.
  5396         16  CR-DTHAMT-LAST                PIC S9(9)V99   COMP-3.
  5397         16  CR-DTHEXP                     PIC S9(7)V99   COMP-3.
  5398         16  CR-DTHEXP-YTD                 PIC S9(7)V99   COMP-3.
  5399
  5400         16  CR-DTH-AGE                    PIC 99.
  5401         16  CR-DTH-PAY-CD                 PIC X.
  5402         16  CR-DEATH-CAUSE                PIC X(6).
  5403
  5404         16  FILLER                        PIC X(16).
  5405
  5406     12  CR-DISAB-CLAIM-DATA.
  5407         16  CR-NUM-DIS-CLM                PIC S999       COMP-3.
  5408
  5409         16  CR-DIS-DT                     PIC 9(11)      COMP-3.
  5410         16  CR-DIS-RPT-DT.
  5411             20  CR-DIS-RPT-YR             PIC 99.
  5412             20  CR-DIS-RPT-MO             PIC 99.
  5413             20  CR-DIS-RPT-DA             PIC 99.
  5414         16  CR-DIS-PAY-DT                 PIC 9(11)      COMP-3.
  5415         16  CR-DIS-PTO-DT                 PIC 9(11)      COMP-3.
  5416
  5417         16  CR-DISAMT                     PIC S9(9)V99   COMP-3.
  5418         16  CR-DISAMT-YTD                 PIC S9(9)V99   COMP-3.
  5419         16  CR-DISAMT-LAST                PIC S9(9)V99   COMP-3.
  5420         16  CR-DISEXP                     PIC S9(7)V99   COMP-3.
  5421         16  CR-DISEXP-YTD                 PIC S9(7)V99   COMP-3.
  5422
  5423         16  CR-DAYS-DISAB                 PIC 999        COMP-3.
  5424         16  CR-DIS-PAY-CD                 PIC X.
  5425         16  FILLER                        PIC XX.
  5426
  5427         16  CR-DISAB-INCURRED-DETAIL.
  5428             20  CR-DISAB-DETAIL-DATA  OCCURS 5 TIMES.
  5429**ELCCRTVR MUST BE CHANGED IF THE "OCCURS" IS CHANGED.
  5430                 24  CR-DIS-INCUR-DT       PIC 9(11)     COMP-3.
  5431                 24  CR-INCUR-DISAMT       PIC S9(9)V99  COMP-3.
  5432                 24  CR-INCUR-DISEXP       PIC S9(9)V99  COMP-3.
  5433
  5434         16  CR-DISAB-CAUSE                PIC X(6).
  5435         16  FILLER                        PIC X(14).
  5436
  5437     12  CR-REMIT-TO                       PIC 99.
  5438
  5439     12  CR-COMPENSATION-LEVELS.
  5440         16  CR-AGT-LEVELS      OCCURS 10 TIMES.
  5441             20  CR-COM-AGT.
  5442                 24  CR-COM-AGT-PREFIX     PIC X(4).
  5443                 24  CR-COM-AGT-PRIME      PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 108
* ECS010T1.cbl (/apps/prod/cid1p/copy/ECSCRT01)
  5444             20  CR-AGT-TYPE               PIC X.
  5445             20  CR-LCOM-L                 PIC SV9(5)     COMP-3.
  5446             20  CR-LCOM-AH                PIC SV9(5)     COMP-3.
  5447
  5448     12  CR-BANK-NOCHRGB-MONTHS            PIC 99.
  5449     12  CR-MOB-NET-TOT-FEES               PIC S9(7)V99   COMP-3.
  5450     12  CR-ADDL-CLP                       PIC S9(5)V99   COMP-3.
  5451     12  CR-CLP-STATE                      PIC XX.
  5452     12  CR-POST-CARD-IND                  PIC X.
  5453     12  CR-LF-CLP                         PIC S9(5)V99   COMP-3.
  5454     12  CR-AH-CLP                         PIC S9(5)V99   COMP-3.
  5455     12  CR-DCC-PRODUCT-CODE               PIC XXX.
  5456     12  CR-LF-RFND-CLP                    PIC S9(5)V99   COMP-3.
  5457     12  CR-AH-RFND-CLP                    PIC S9(5)V99   COMP-3.
  5458     12  FILLER                            PIC X(07).
  5459
  5460     12  CR-CSR-CODE                       PIC XXX.
  5461
  5462     12  CR-CLAIM-DEDUCT-WITHHELD          PIC S9(5)V99   COMP-3.
  5463     12  CR-CANCEL-DEDUCT-WITHHELD         PIC S9(5)V99   COMP-3.
  5464
  5465     12  CR-MICROFILM-NUMBERS.
  5466*        16  CR-ISS-MICROFILM-NO           PIC S9(9)      COMP-3.
  5467         16  FILLER                        PIC X(5).
  5468     12  CR-NH-INT-ON-REF                  PIC S9(7)V99   COMP-3.
  5469
  5470     12  CR-USER-CODE                      PIC X.
  5471     12  CR-USER-FUTURE                    PIC X(9).
  5472
  5473     12  CR-BENEFICIARY.
  5474         16  CR-BANK-NO                    PIC X(10).
  5475         16  FILLER                        PIC X(15).
  5476
  5477     12  CR-ENTRY-BATCH                    PIC X(6).
  5478     12  CR-LF-EXIT-BATCH                  PIC X(6).
  5479     12  CR-AH-EXIT-BATCH                  PIC X(6).
  5480
  5481     12  CR-NOTE-SW                        PIC X.
  5482
  5483     12  CR-ORIGIN-INDICATOR               PIC X.
  5484         88  CR-ENTERED-MANUALLY              VALUE '1'.
  5485         88  CR-CREATED-FROM-TAPE-LOAD        VALUE '2'.
  5486
  5487     12  CR-LF-CNC-ENT-DT                  PIC 9(11)  COMP-3.
  5488     12  CR-AH-CNC-ENT-DT                  PIC 9(11)  COMP-3.
  5489     12  FILLER                            PIC X(33).
  5490
  5491******************************************************************
* 5492                             COPY ELCCRTVR.
  5493***************************************************************** 04/24/98
  5494*                                                                *ELCCRTVR
  5495*                                                                *ELCCRTVR
  5496*                            ELCCRTVR                            *   LV003
  5497*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  5498*                            VMOD=2.001                          *ELCCRTVR
  5499*                                                                *ELCCRTVR
  5500*   WORKING STORAGE FOR DATE VARIABLES CREATED                   *ELCCRTVR
  5501*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCCRTVR
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 109
* ECS010T1.cbl (/apps/prod/cid1p/copy/ELCCRTVR)
  5502*                                                                *ELCCRTVR
  5503******************************************************************ELCCRTVR
  5504                                                                  ELCCRTVR
  5505 01  WS-CERTIFICATE-RECORD-DATE.                                  ELCCRTVR
  5506     05  WS-CR-DT.                                                ELCCRTVR
  5507         10  FILLER                PIC 999.                       ELCCRTVR
  5508         10  CR-CCYY               PIC 9(04).                     ELCCRTVR
  5509         10  CR-CCYR  REDEFINES  CR-CCYY.                         ELCCRTVR
  5510             15  CR-CC             PIC 99.                        ELCCRTVR
  5511             15  CR-YR             PIC 99.                        ELCCRTVR
  5512         10  CR-MO                 PIC 99.                        ELCCRTVR
  5513         10  CR-DA                 PIC 99.                        ELCCRTVR
  5514     05  WS-CR-DT-N REDEFINES                                        CL**2
  5515            WS-CR-DT               PIC 9(11).                        CL**2
  5516     05  WS-CR-LF-EXPIRE-DATE.                                    ELCCRTVR
  5517         10  FILLER                    PIC 999.                   ELCCRTVR
  5518         10  CR-LF-EXPIRE-CCYY         PIC 9(04).                 ELCCRTVR
  5519         10  CR-LF-EXPIRE-CCYR  REDEFINES  CR-LF-EXPIRE-CCYY.     ELCCRTVR
  5520             15  CR-LF-EXPIRE-CC       PIC 99.                    ELCCRTVR
  5521             15  CR-LF-EXPIRE-YR       PIC 99.                    ELCCRTVR
  5522         10  CR-LF-EXPIRE-MO           PIC 99.                    ELCCRTVR
  5523         10  CR-LF-EXPIRE-DA           PIC 99.                    ELCCRTVR
  5524     05  WS-CR-LF-EXPIRE-DATE-N REDEFINES                            CL**2
  5525            WS-CR-LF-EXPIRE-DATE       PIC 9(11).                    CL**2
  5526     05  WS-CR-AH-EXPIRE-DATE.                                    ELCCRTVR
  5527         10  FILLER                    PIC 999.                   ELCCRTVR
  5528         10  CR-AH-EXPIRE-CCYY         PIC 9(04).                 ELCCRTVR
  5529         10  CR-AH-EXPIRE-CCYR   REDEFINES CR-AH-EXPIRE-CCYY.     ELCCRTVR
  5530             15  CR-AH-EXPIRE-CC       PIC 99.                    ELCCRTVR
  5531             15  CR-AH-EXPIRE-YR       PIC 99.                    ELCCRTVR
  5532         10  CR-AH-EXPIRE-MO           PIC 99.                    ELCCRTVR
  5533         10  CR-AH-EXPIRE-DA           PIC 99.                    ELCCRTVR
  5534     05  WS-CR-AH-EXPIRE-DATE-N REDEFINES                            CL**2
  5535            WS-CR-AH-EXPIRE-DATE       PIC 9(11).                    CL**2
  5536     05  WS-CR-ENTRY-DATE.                                        ELCCRTVR
  5537         10  FILLER                    PIC 999.                   ELCCRTVR
  5538         10  CR-ENTRY-CCYY             PIC 9(04).                 ELCCRTVR
  5539         10  CR-ENTRY-CCYR  REDEFINES  CR-ENTRY-CCYY.             ELCCRTVR
  5540             15 CR-ENTRY-CC            PIC 99.                    ELCCRTVR
  5541             15 CR-ENTRY-YR            PIC 99.                    ELCCRTVR
  5542         10  CR-ENTRY-MO               PIC 99.                    ELCCRTVR
  5543         10  CR-ENTRY-DA               PIC 99.                    ELCCRTVR
  5544     05  WS-CR-ENTRY-DATE-N REDEFINES                                CL**2
  5545            WS-CR-ENTRY-DATE           PIC 9(11).                    CL**2
  5546     05  WS-CR-LF-CANC-DT.                                        ELCCRTVR
  5547         10  FILLER                    PIC 999.                   ELCCRTVR
  5548         10  CR-LF-CNC-CCYY            PIC 9(04).                 ELCCRTVR
  5549         10  CR-LF-CNC-CCYR   REDEFINES CR-LF-CNC-CCYY.           ELCCRTVR
  5550             15  CR-LF-CNC-CC          PIC 99.                    ELCCRTVR
  5551             15  CR-LF-CNC-YR          PIC 99.                    ELCCRTVR
  5552         10  CR-LF-CNC-MO              PIC 99.                    ELCCRTVR
  5553         10  CR-LF-CNC-DA              PIC 99.                    ELCCRTVR
  5554     05  WS-CR-LF-CANC-DT-N REDEFINES                                CL**2
  5555            WS-CR-LF-CANC-DT           PIC 9(11).                    CL**2
  5556     05  WS-CR-LF-CANCEL-EXIT-DATE.                               ELCCRTVR
  5557         10  FILLER                    PIC 999.                   ELCCRTVR
  5558         10  CR-LF-CEX-CCYY            PIC 9(04).                 ELCCRTVR
  5559         10  CR-LF-CEX-CCYR  REDEFINES  CR-LF-CEX-CCYY.              CL**3
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 110
* ECS010T1.cbl (/apps/prod/cid1p/copy/ELCCRTVR)
  5560             15  CR-LF-CEX-CC          PIC 99.                    ELCCRTVR
  5561             15  CR-LF-CEX-YR          PIC 99.                    ELCCRTVR
  5562         10  CR-LF-CEX-MO              PIC 99.                    ELCCRTVR
  5563         10  CR-LF-CEX-DA              PIC 99.                    ELCCRTVR
  5564     05  WS-CR-LF-CANCEL-EXIT-DATE-N REDEFINES                       CL**2
  5565            WS-CR-LF-CANCEL-EXIT-DATE  PIC 9(11).                    CL**2
  5566     05  WS-CR-LF-CLAIM-EXIT-DATE.                                ELCCRTVR
  5567         10  FILLER                    PIC 999.                   ELCCRTVR
  5568         10  CR-LF-DEX-CCYY            PIC 9(04).                 ELCCRTVR
  5569         10  CR-LF-DEX-CCYR  REDEFINES  CR-LF-DEX-CCYY.           ELCCRTVR
  5570             15  CR-LF-DEX-CC          PIC 99.                    ELCCRTVR
  5571             15  CR-LF-DEX-YR          PIC 99.                    ELCCRTVR
  5572         10  CR-LF-DEX-MO              PIC 99.                    ELCCRTVR
  5573         10  CR-LF-DEX-DA              PIC 99.                    ELCCRTVR
  5574     05  WS-CR-LF-CLAIM-EXIT-DATE-N REDEFINES                        CL**2
  5575            WS-CR-LF-CLAIM-EXIT-DATE   PIC 9(11).                    CL**2
  5576     05  WS-CR-AH-CANC-DT.                                        ELCCRTVR
  5577         10  FILLER                    PIC 999.                   ELCCRTVR
  5578         10  CR-AH-CNC-CCYY            PIC 9(04).                 ELCCRTVR
  5579         10  CR-AH-CNC-CCYR  REDEFINES  CR-AH-CNC-CCYY.           ELCCRTVR
  5580             15  CR-AH-CNC-CC          PIC 99.                    ELCCRTVR
  5581             15  CR-AH-CNC-YR          PIC 99.                    ELCCRTVR
  5582         10  CR-AH-CNC-MO              PIC 99.                    ELCCRTVR
  5583         10  CR-AH-CNC-DA              PIC 99.                    ELCCRTVR
  5584     05  WS-CR-AH-CANC-DT-N  REDEFINES                               CL**2
  5585            WS-CR-AH-CANC-DT           PIC 9(11).                    CL**2
  5586     05  WS-CR-AH-CANCEL-EXIT-DATE.                               ELCCRTVR
  5587         10  FILLER                    PIC 999.                   ELCCRTVR
  5588         10  CR-AH-CEX-CCYY            PIC 9(04).                 ELCCRTVR
  5589         10  CR-AH-CEX-CCYR  REDEFINES  CR-AH-CEX-CCYY.           ELCCRTVR
  5590             15  CR-AH-CEX-CC          PIC 99.                    ELCCRTVR
  5591             15  CR-AH-CEX-YR          PIC 99.                    ELCCRTVR
  5592         10  CR-AH-CEX-MO              PIC 99.                    ELCCRTVR
  5593         10  CR-AH-CEX-DA              PIC 99.                    ELCCRTVR
  5594     05  WS-CR-AH-CANCEL-EXIT-DATE-N REDEFINES                       CL**2
  5595            WS-CR-AH-CANCEL-EXIT-DATE  PIC 9(11).                    CL**2
  5596     05  WS-CR-AH-SETTLEMENT-EXIT-DATE.                           ELCCRTVR
  5597         10  FILLER                    PIC 999.                   ELCCRTVR
  5598         10  CR-AH-DEX-CCYY            PIC 9(04).                 ELCCRTVR
  5599         10  CR-AH-DEX-CCYR  REDEFINES  CR-AH-DEX-CCYY.           ELCCRTVR
  5600             15  CR-AH-DEX-CC          PIC 99.                    ELCCRTVR
  5601             15  CR-AH-DEX-YR          PIC 99.                    ELCCRTVR
  5602         10  CR-AH-DEX-MO              PIC 99.                    ELCCRTVR
  5603         10  CR-AH-DEX-DA              PIC 99.                    ELCCRTVR
  5604     05  WS-CR-AH-SETTLEMENT-EXIT-DATEN REDEFINES                    CL**5
  5605          WS-CR-AH-SETTLEMENT-EXIT-DATE   PIC 9(11).                 CL**5
  5606     05  WS-CR-DTH-DT.                                            ELCCRTVR
  5607         10  FILLER                    PIC 999.                   ELCCRTVR
  5608         10  CR-DTH-CCYY               PIC 9(04).                 ELCCRTVR
  5609         10  CR-DTH-CCYR  REDEFINES  CR-DTH-CCYY.                 ELCCRTVR
  5610             15  CR-DTH-CC             PIC 99.                    ELCCRTVR
  5611             15  CR-DTH-YR             PIC 99.                    ELCCRTVR
  5612         10  CR-DTH-MO                 PIC 99.                    ELCCRTVR
  5613         10  CR-DTH-DA                 PIC 99.                    ELCCRTVR
  5614     05  WS-CR-DTH-DT-N REDEFINES                                    CL**2
  5615            WS-CR-DTH-DT               PIC 9(11).                    CL**2
  5616     05  WS-CR-DTH-PAY-DT.                                        ELCCRTVR
  5617         10  FILLER                    PIC 999.                   ELCCRTVR
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 111
* ECS010T1.cbl (/apps/prod/cid1p/copy/ELCCRTVR)
  5618         10  CR-DTH-PAY-CCYY           PIC 9(04).                 ELCCRTVR
  5619         10  CR-DTH-PAY-CCYR  REDEFINES CR-DTH-PAY-CCYY.          ELCCRTVR
  5620             15  CR-DTH-PAY-CC         PIC 99.                    ELCCRTVR
  5621             15  CR-DTH-PAY-YR         PIC 99.                    ELCCRTVR
  5622         10  CR-DTH-PAY-MO             PIC 99.                    ELCCRTVR
  5623         10  CR-DTH-PAY-DA             PIC 99.                    ELCCRTVR
  5624     05  WS-CR-DTH-PAY-DT-N REDEFINES                                CL**2
  5625            WS-CR-DTH-PAY-DT           PIC 9(11).                    CL**2
  5626     05  WS-CR-DIS-DT.                                            ELCCRTVR
  5627         10  FILLER                    PIC 999.                   ELCCRTVR
  5628         10  CR-DIS-CCYY               PIC 9(04).                 ELCCRTVR
  5629         10  CR-DIS-CCYR  REDEFINES  CR-DIS-CCYY.                 ELCCRTVR
  5630             15  CR-DIS-CC             PIC 99.                    ELCCRTVR
  5631             15  CR-DIS-YR             PIC 99.                    ELCCRTVR
  5632         10  CR-DIS-MO                 PIC 99.                    ELCCRTVR
  5633         10  CR-DIS-DA                 PIC 99.                    ELCCRTVR
  5634     05  WS-CR-DIS-DT-N REDEFINES                                    CL**2
  5635            WS-CR-DIS-DT               PIC 9(11).                    CL**2
  5636     05  WS-CR-DIS-PAY-DT.                                        ELCCRTVR
  5637         10  FILLER                    PIC 999.                   ELCCRTVR
  5638         10  CR-DIS-PAY-CCYY           PIC 9(04).                 ELCCRTVR
  5639         10  CR-DIS-PAY-CCYR  REDEFINES  CR-DIS-PAY-CCYY.         ELCCRTVR
  5640             15  CR-DIS-PAY-CC         PIC 99.                    ELCCRTVR
  5641             15  CR-DIS-PAY-YR         PIC 99.                    ELCCRTVR
  5642         10  CR-DIS-PAY-MO             PIC 99.                    ELCCRTVR
  5643         10  CR-DIS-PAY-DA             PIC 99.                    ELCCRTVR
  5644     05  WS-CR-DIS-PAY-DT-N REDEFINES                                CL**2
  5645            WS-CR-DIS-PAY-DT           PIC 9(11).                    CL**2
  5646     05  WS-CR-DIS-PTO-DT.                                        ELCCRTVR
  5647         10  FILLER                    PIC 999.                   ELCCRTVR
  5648         10  CR-DIS-PTO-CCYY           PIC 9(04).                 ELCCRTVR
  5649         10  CR-DIS-PTO-CCYR  REDEFINES  CR-DIS-PTO-CCYY.         ELCCRTVR
  5650             15  CR-DIS-PTO-CC         PIC 99.                    ELCCRTVR
  5651             15  CR-DIS-PTO-YR         PIC 99.                    ELCCRTVR
  5652         10  CR-DIS-PTO-MO             PIC 99.                    ELCCRTVR
  5653         10  CR-DIS-PTO-DA             PIC 99.                    ELCCRTVR
  5654     05  WS-CR-DIS-PTO-DT-N REDEFINES                                CL**2
  5655            WS-CR-DIS-PTO-DT           PIC 9(11).                    CL**2
  5656     05  COPY-NDX                      PIC 9.                        CL**6
  5657     05  WS-DIS-INCUR-DT OCCURS 5 TIMES.                             CL**6
  5658         10  WS-CR-DIS-INCUR-DT.                                  ELCCRTVR
  5659             15  FILLER                PIC 999.                   ELCCRTVR
  5660             15  CR-DIS-INC-CCYY       PIC 9(04).                 ELCCRTVR
  5661             15  CR-DIS-INC-CCYR  REDEFINES  CR-DIS-INC-CCYY.     ELCCRTVR
  5662                 20  CR-DIS-INC-CC     PIC 99.                    ELCCRTVR
  5663                 20  CR-DIS-INC-YR     PIC 99.                    ELCCRTVR
  5664             15  CR-DIS-INC-MO         PIC 99.                    ELCCRTVR
  5665             15  CR-DIS-INC-DA         PIC 99.                    ELCCRTVR
  5666         10  WS-CR-DIS-INCUR-DT-N REDEFINES                          CL**2
  5667                WS-CR-DIS-INCUR-DT     PIC 9(11).                    CL**2
  5668
  5669 01  INITIALIZED-CERTIFICATE     PIC X(1056).
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 112
* ECS010T1.cbl
* 5671                             COPY ELCDATE.
  5672******************************************************************06/11/98
  5673*                                                                *ELCDATE
  5674*                                                                *ELCDATE
  5675*                            ELCDATE.                            *   LV023
  5676*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL*16
  5677*                            VMOD=2.003                           ELCDATE
  5678*                                                                *ELCDATE
  5679*                                                                *ELCDATE
  5680*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *ELCDATE
  5681*                 LENGTH = 200                                   *   CL*19
  5682******************************************************************ELCDATE
  5683                                                                  ELCDATE
  5684 01  DATE-CONVERSION-DATA.                                        ELCDATE
  5685     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.    CL*19
  5686     12  DC-OPTION-CODE                PIC X.                        CL*15
  5687         88  BIN-TO-GREG                VALUE ' '.                ELCDATE
  5688         88  ELAPSED-BETWEEN-BIN        VALUE '1'.                ELCDATE
  5689         88  EDIT-GREG-TO-BIN           VALUE '2'.                ELCDATE
  5690         88  YMD-GREG-TO-BIN            VALUE '3'.                ELCDATE
  5691         88  MDY-GREG-TO-BIN            VALUE '4'.                ELCDATE
  5692         88  JULIAN-TO-BIN              VALUE '5'.                ELCDATE
  5693         88  BIN-PLUS-ELAPSED           VALUE '6'.                ELCDATE
  5694         88  FIND-CENTURY               VALUE '7'.                   CL*22
  5695         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.                ELCDATE
  5696         88  EDIT-GREG-TO-BIN-3         VALUE '9'.                ELCDATE
  5697         88  YMD-GREG-TO-BIN-3          VALUE 'A'.                ELCDATE
  5698         88  MDY-GREG-TO-BIN-3          VALUE 'B'.                ELCDATE
  5699         88  JULIAN-TO-BIN-3            VALUE 'C'.                ELCDATE
  5700         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.                ELCDATE
  5701         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.                   CL*14
  5702         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.                   CL*14
  5703         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.                   CL*14
  5704         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.         CL*14
  5705         88  CHECK-LEAP-YEAR            VALUE 'H'.                   CL*14
  5706         88  BIN-3-TO-GREG              VALUE 'I'.                   CL*14
  5707         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.                   CL*14
  5708         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.                   CL*14
  5709         88  CYMD-GREG-TO-BIN           VALUE 'L'.                   CL*14
  5710         88  MDCY-GREG-TO-BIN           VALUE 'M'.                   CL*14
  5711         88  MDY-GREG-TO-JULIAN         VALUE 'N'.                   CL*14
  5712         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.                   CL*14
  5713         88  YMD-GREG-TO-JULIAN         VALUE 'P'.                   CL*14
  5714         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.                   CL*14
  5715         88  THREE-CHARACTER-BIN                                  ELCDATE
  5716                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.       CL*14
  5717         88  GREGORIAN-TO-BIN                                        CL**2
  5718                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.    CL*14
  5719         88  BIN-TO-GREGORIAN                                        CL**2
  5720                  VALUES ' ' '1' 'I' '8' 'G'.                        CL*14
  5721         88  JULIAN-TO-BINARY                                        CL**2
  5722                  VALUES '5' 'C' 'E' 'F'.                            CL*14
  5723     12  DC-ERROR-CODE                 PIC X.                        CL*15
  5724         88  NO-CONVERSION-ERROR        VALUE ' '.                   CL**3
  5725         88  DATE-CONVERSION-ERROR                                ELCDATE
  5726                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.        CL*14
  5727         88  DATE-IS-ZERO               VALUE '1'.                ELCDATE
  5728         88  DATE-IS-NON-NUMERIC        VALUE '2'.                ELCDATE
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 113
* ECS010T1.cbl (/apps/prod/cid1p/copy/ELCDATE)
  5729         88  DATE-IS-INVALID            VALUE '3'.                ELCDATE
  5730         88  DATE1-GREATER-DATE2        VALUE '4'.                ELCDATE
  5731         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.                ELCDATE
  5732         88  DATE-INVALID-OPTION        VALUE '9'.                ELCDATE
  5733         88  INVALID-CENTURY            VALUE 'A'.                ELCDATE
  5734         88  ONLY-CENTURY               VALUE 'B'.                ELCDATE
  5735         88  ONLY-LEAP-YEAR             VALUE 'C'.                ELCDATE
  5736         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.              CL**3
  5737     12  DC-END-OF-MONTH               PIC X.                        CL*15
  5738         88  CALCULATE-END-OF-MONTH     VALUE '1'.                ELCDATE
  5739     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.         CL*15
  5740         88  USE-NORMAL-PROCESS         VALUE ' '.                ELCDATE
  5741         88  ADJUST-DOWN-100-YRS        VALUE '1'.                ELCDATE
  5742         88  ADJUST-UP-100-YRS          VALUE '2'.                ELCDATE
  5743     12  FILLER                        PIC X.                        CL*15
  5744     12  DC-CONVERSION-DATES.                                        CL*15
  5745         16  DC-BIN-DATE-1             PIC XX.                       CL*15
  5746         16  DC-BIN-DATE-2             PIC XX.                       CL*15
  5747         16  DC-GREG-DATE-1-EDIT       PIC X(08).                    CL*15
  5748         16  DC-GREG-DATE-1-EDIT-R REDEFINES                         CL*15
  5749                       DC-GREG-DATE-1-EDIT.                       ELCDATE
  5750             20  DC-EDIT1-MONTH        PIC 99.                       CL*15
  5751             20  SLASH1-1              PIC X.                        CL*15
  5752             20  DC-EDIT1-DAY          PIC 99.                       CL*15
  5753             20  SLASH1-2              PIC X.                        CL*15
  5754             20  DC-EDIT1-YEAR         PIC 99.                       CL*15
  5755         16  DC-GREG-DATE-2-EDIT       PIC X(08).                    CL*15
  5756         16  DC-GREG-DATE-2-EDIT-R REDEFINES                         CL*15
  5757                     DC-GREG-DATE-2-EDIT.                         ELCDATE
  5758             20  DC-EDIT2-MONTH        PIC 99.                       CL*15
  5759             20  SLASH2-1              PIC X.                        CL*15
  5760             20  DC-EDIT2-DAY          PIC 99.                       CL*15
  5761             20  SLASH2-2              PIC X.                        CL*15
  5762             20  DC-EDIT2-YEAR         PIC 99.                       CL*15
  5763         16  DC-GREG-DATE-1-YMD        PIC 9(06).                    CL*15
  5764         16  DC-GREG-DATE-1-YMD-R  REDEFINES                         CL*15
  5765                     DC-GREG-DATE-1-YMD.                          ELCDATE
  5766             20  DC-YMD-YEAR           PIC 99.                       CL*15
  5767             20  DC-YMD-MONTH          PIC 99.                       CL*15
  5768             20  DC-YMD-DAY            PIC 99.                       CL*15
  5769         16  DC-GREG-DATE-1-MDY        PIC 9(06).                    CL*15
  5770         16  DC-GREG-DATE-1-MDY-R REDEFINES                          CL*15
  5771                      DC-GREG-DATE-1-MDY.                         ELCDATE
  5772             20  DC-MDY-MONTH          PIC 99.                       CL*15
  5773             20  DC-MDY-DAY            PIC 99.                       CL*15
  5774             20  DC-MDY-YEAR           PIC 99.                       CL*15
  5775         16  DC-GREG-DATE-1-ALPHA.                                   CL*15
  5776             20  DC-ALPHA-MONTH        PIC X(10).                    CL*15
  5777             20  DC-ALPHA-DAY          PIC 99.                       CL*15
  5778             20  FILLER                PIC XX.                       CL*15
  5779             20  DC-ALPHA-CENTURY.                                   CL*15
  5780                 24 DC-ALPHA-CEN-N     PIC 99.                       CL*15
  5781             20  DC-ALPHA-YEAR         PIC 99.                       CL*15
  5782         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.           CL*15
  5783         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.           CL*15
  5784         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.           CL*15
  5785         16  DC-JULIAN-DATE            PIC 9(05).                    CL*15
  5786         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE                CL*20
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 114
* ECS010T1.cbl (/apps/prod/cid1p/copy/ELCDATE)
  5787                                       PIC 9(05).                    CL*20
  5788         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.                  CL*15
  5789             20  DC-JULIAN-YEAR        PIC 99.                       CL*15
  5790             20  DC-JULIAN-DAYS        PIC 999.                      CL*15
  5791         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.       CL*15
  5792         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.    CL*15
  5793         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.    CL*15
  5794     12  DATE-CONVERSION-VARIBLES.                                   CL*15
  5795         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.            CL*15
  5796         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.          CL*15
  5797             20  FILLER                PIC 9(3).                     CL*15
  5798             20  HOLD-CEN-1-CCYY.                                    CL*15
  5799                 24  HOLD-CEN-1-CC     PIC 99.                       CL*17
  5800                 24  HOLD-CEN-1-YY     PIC 99.                       CL*17
  5801             20  HOLD-CEN-1-MO         PIC 99.                       CL*17
  5802             20  HOLD-CEN-1-DA         PIC 99.                       CL*17
  5803         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.            CL*15
  5804             20  HOLD-CEN-1-R-MO       PIC 99.                       CL*17
  5805             20  HOLD-CEN-1-R-DA       PIC 99.                       CL*17
  5806             20  HOLD-CEN-1-R-CCYY.                                  CL*15
  5807                 24  HOLD-CEN-1-R-CC   PIC 99.                       CL*17
  5808                 24  HOLD-CEN-1-R-YY   PIC 99.                       CL*17
  5809             20  FILLER                PIC 9(3).                     CL*15
  5810         16  HOLD-CENTURY-1-X.                                       CL*15
  5811             20  FILLER                PIC X(3)  VALUE SPACES.       CL*15
  5812             20  HOLD-CEN-1-X-CCYY.                                  CL*15
  5813                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.          CL*17
  5814                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.          CL*17
  5815             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.          CL*17
  5816             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.          CL*17
  5817         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.          CL*15
  5818             20  HOLD-CEN-1-R-X-MO     PIC XX.                       CL*17
  5819             20  HOLD-CEN-1-R-X-DA     PIC XX.                       CL*17
  5820             20  HOLD-CEN-1-R-X-CCYY.                                CL*15
  5821                 24  HOLD-CEN-1-R-X-CC PIC XX.                       CL*17
  5822                 24  HOLD-CEN-1-R-X-YY PIC XX.                       CL*17
  5823             20  FILLER                PIC XXX.                      CL*23
  5824         16  DC-BIN-DATE-EXPAND-1      PIC XXX.                      CL*15
  5825         16  DC-BIN-DATE-EXPAND-2      PIC XXX.                      CL*15
  5826         16  DC-JULIAN-DATE-1          PIC 9(07).                    CL*15
  5827         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.          CL*15
  5828             20  DC-JULIAN-1-CCYY.                                   CL*15
  5829                 24  DC-JULIAN-1-CC    PIC 99.                       CL*15
  5830                 24  DC-JULIAN-1-YR    PIC 99.                       CL*15
  5831             20  DC-JULIAN-DA-1        PIC 999.                      CL*15
  5832         16  DC-JULIAN-DATE-2          PIC 9(07).                    CL*15
  5833         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.          CL*15
  5834             20  DC-JULIAN-2-CCYY.                                   CL*15
  5835                 24  DC-JULIAN-2-CC    PIC 99.                       CL*15
  5836                 24  DC-JULIAN-2-YR    PIC 99.                       CL*15
  5837             20  DC-JULIAN-DA-2        PIC 999.                      CL*15
  5838         16  DC-GREG-DATE-A-EDIT.                                    CL*15
  5839             20  DC-EDITA-MONTH        PIC 99.                       CL*15
  5840             20  SLASHA-1              PIC X VALUE '/'.              CL*15
  5841             20  DC-EDITA-DAY          PIC 99.                       CL*15
  5842             20  SLASHA-2              PIC X VALUE '/'.              CL*15
  5843             20  DC-EDITA-CCYY.                                      CL*15
  5844                 24  DC-EDITA-CENT     PIC 99.                       CL*15
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 115
* ECS010T1.cbl (/apps/prod/cid1p/copy/ELCDATE)
  5845                 24  DC-EDITA-YEAR     PIC 99.                       CL*15
  5846         16  DC-GREG-DATE-B-EDIT.                                    CL*15
  5847             20  DC-EDITB-MONTH        PIC 99.                       CL*15
  5848             20  SLASHB-1              PIC X VALUE '/'.              CL*15
  5849             20  DC-EDITB-DAY          PIC 99.                       CL*15
  5850             20  SLASHB-2              PIC X VALUE '/'.              CL*15
  5851             20  DC-EDITB-CCYY.                                      CL*15
  5852                 24  DC-EDITB-CENT     PIC 99.                       CL*15
  5853                 24  DC-EDITB-YEAR     PIC 99.                       CL*15
  5854         16  DC-GREG-DATE-CYMD         PIC 9(08).                    CL*15
  5855         16  DC-GREG-DATE-CYMD-R REDEFINES                           CL*15
  5856                              DC-GREG-DATE-CYMD.                  ELCDATE
  5857             20  DC-CYMD-CEN           PIC 99.                       CL*15
  5858             20  DC-CYMD-YEAR          PIC 99.                       CL*15
  5859             20  DC-CYMD-MONTH         PIC 99.                       CL*15
  5860             20  DC-CYMD-DAY           PIC 99.                       CL*15
  5861         16  DC-GREG-DATE-MDCY         PIC 9(08).                    CL*15
  5862         16  DC-GREG-DATE-MDCY-R REDEFINES                           CL*15
  5863                              DC-GREG-DATE-MDCY.                  ELCDATE
  5864             20  DC-MDCY-MONTH         PIC 99.                       CL*15
  5865             20  DC-MDCY-DAY           PIC 99.                       CL*15
  5866             20  DC-MDCY-CEN           PIC 99.                       CL*15
  5867             20  DC-MDCY-YEAR          PIC 99.                       CL*15
  5868    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.      ELCDATE
  5869        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.        ELCDATE
  5870    12  DC-EL310-DATE                  PIC X(21).                    CL*26
  5871    12  FILLER                         PIC X(28).                    CL*26
* 5872                             COPY ELCFUNDT.
  5873***************************************************************** 12/03/98
  5874*                                                               * ELCFUNDT
  5875*                            ELCFUNDT.                          *    LV004
  5876*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE *             CL**4
  5877*                            VMOD=2.001                         * ELCFUNDT
  5878*                                                               * ELCFUNDT
  5879*           COPYBOOK FOR THE FUNCTION DATE FORMAT               * ELCFUNDT
  5880*                                                               * ELCFUNDT
  5881***************************************************************** ELCFUNDT
  5882                                                                  ELCFUNDT
  5883                                                                  ELCFUNDT
  5884 01  FUNCTION-DATE.                                                  CL**2
  5885     05  WS-FN-DATE                PIC 9(8)    VALUE ZEROS.          CL**3
  5886     05  WS-FN-CYMD  REDEFINES  WS-FN-DATE.                          CL**3
  5887         10  WS-FN-CCYR            PIC 9(4).                         CL**3
  5888         10  WS-FN-CCYY  REDEFINES  WS-FN-CCYR.                      CL**3
  5889             15  WS-FN-CC          PIC 99.                           CL**3
  5890             15  WS-FN-YR          PIC 99.                           CL**3
  5891         10  WS-FN-MO              PIC 99.                           CL**3
  5892         10  WS-FN-DA              PIC 99.                           CL**3
  5893     05  WS-FN-HOURS               PIC 99      VALUE ZEROS.          CL**3
  5894     05  WS-FN-MINUTES             PIC 99      VALUE ZEROS.          CL**3
  5895     05  WS-FN-SECONDS             PIC 99      VALUE ZEROS.          CL**3
  5896     05  WS-FN-HUNDSECS            PIC 99      VALUE ZEROS.          CL**3
  5897     05  WS-FN-GMT-IND             PIC X       VALUE SPACES.         CL**2
  5898         88  WS-BEHIND-GMT                     VALUE '-'.            CL**2
  5899         88  WS-AFTER-GMT                      VALUE '+'.            CL**2
  5900         88  WS-NO-GMT                         VALUE ZERO.           CL**2
  5901     05  WS-FN-GMT-HOURS           PIC 99      VALUE ZEROS.          CL**2
  5902     05  WS-FN-GMT-MINUTES         PIC 99      VALUE ZEROS.          CL**2
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 116
* ECS010T1.cbl
  5903
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 117
* ECS010T1.cbl
  5905 01  CPA-STARTS-HERE             PIC X(48)
  5906       VALUE '***** CALCULATION PASS AREA STARTS HERE ********'.
* 5907                             COPY ELCCALC.
  5908******************************************************************04/15/98
  5909*                                                                *ELCCALC
  5910*                           ELCCALC.                            *    LV003
  5911*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
  5912*                            VMOD=2.025                          *   CL**3
  5913*                                                                *   CL**2
  5914*   DESCRIPTION:  DATA TO BE PASSED TO REMAINING TERM ROUTINE    *   CL**2
  5915*                 REMAINING AMOUNT ROUTINE, LOSS RESERVE ROUTINE *   CL**2
  5916*                 REFUND CALCULATIONS ROUTINE, EARNINGS CALCU -  *   CL**2
  5917*                 LATIONS ROUTINE, AND THE RATING ROUTINE.       *   CL**2
  5918*                                                                *   CL**2
  5919*  PASSED TO ELRTRM                                              *   CL**2
  5920*  -----------------                                             *   CL**2
  5921*  METHOD CODE (I.E. FULL MONTH, HALF ADJ, ETC)                  *   CL**2
  5922*  ORIGINAL TERM                                                 *   CL**2
  5923*  BEGINNING DATE                                                *   CL**2
  5924*  ENDING DATE                                                   *   CL**2
  5925*  COMPANY I.D.                                                  *   CL**2
  5926*  ACCOUNT MASTER USER FIELD                                     *   CL**2
  5927*  PROCESS SWITCH (CANCEL, CLAIM)                                *   CL**2
  5928*  FREE LOOK DAYS                                                *   CL**2
  5929*                                                                *   CL**2
  5930*  RETURNED FROM ELRTRM                                          *   CL**2
  5931*  ---------------------                                         *   CL**2
  5932*  REMAINING TERM 1 - USED FOR EARNINGS                          *   CL**2
  5933*  REMAINING TERM 2 - USED FOR BENEFIT CALCULATIONS              *   CL**2
  5934*  REMAINING TERM 3 - USED FOR CLAIM BENEFITS                    *   CL**2
  5935*  ODD DAYS - REMAINING DAYS PAST FULL MONTHS                    *   CL**2
  5936*----------------------------------------------------------------*   CL**2
  5937*  PASSED TO ELRAMT                                              *   CL**2
  5938*  ----------------                                              *   CL**2
  5939*  REMAINING TERM 1 OR 2 OR 3 (FROM ELRTRM)                      *   CL**2
  5940*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *   CL**2
  5941*  ORIGINAL AMOUNT                                               *   CL**2
  5942*  ALTERNATE BENEFIT (BALLON)                                    *   CL**2
  5943*  A.P.R. - NET PAY ONLY                                         *   CL**2
  5944*  METHOD                                                            CL**2
  5945*  PAYMENT FREQUENCY - FOR FARM PLAN                             *   CL**2
  5946*  COMPANY I.D.                                                  *   CL**2
  5947*  BENEFIT TYPE                                                  *   CL**2
  5948*                                                                *   CL**2
  5949*  RETURNED FROM ELRAMT                                          *   CL**2
  5950*  --------------------                                          *   CL**2
  5951*  REMAINING AMOUNT 1 - CURRENT                                  *   CL**2
  5952*  REMAINING AMOUNT 2 - PREVIOUS MONTH                           *   CL**2
  5953*  REMAINING AMOUNT FACTOR                                           CL**2
  5954*----------------------------------------------------------------*   CL**2
  5955*  PASSED TO ELRESV                                              *   CL**2
  5956*  -----------------                                             *   CL**2
  5957*  CERTIFICATE EFFECTIVE DATE                                    *   CL**2
  5958*  VALUATION DATE                                                *   CL**2
  5959*  PAID THRU DATE                                                *   CL**2
  5960*  BENEFIT                                                       *   CL**2
  5961*  INCURRED DATE                                                 *   CL**2
  5962*  REPORTED DATE                                                 *   CL**2
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 118
* ECS010T1.cbl (/apps/prod/cid1p/copy/ELCCALC)
  5963*  ISSUE AGE                                                     *   CL**2
  5964*  TERM                                                          *   CL**2
  5965*  CDT PERCENT                                                   *   CL**2
  5966*  CDT METHOD (I.E. INTERPOLATED, AVERAGE, ETC)                  *   CL**2
  5967* *CLAIM TYPE (LIFE, A/H)                                        *   CL**2
  5968* *REMAINING BENEFIT (FROM ELRAMT)                               *   CL**2
  5969* *ONLY FIELDS REQUIRED FOR LIFE CLAIMS                          *   CL**2
  5970*                                                                *   CL**2
  5971*  RETURNED FROM ELRESV                                          *   CL**2
  5972*  --------------------                                          *   CL**2
  5973*  CDT TABLE USED                                                *   CL**2
  5974*  CDT FACTOR USED                                               *   CL**2
  5975*  PAY TO CURRENT RESERVE                                        *   CL**2
  5976*  I.B.N.R. - A/H ONLY                                           *   CL**2
  5977*  FUTURE (ACCRUED) AH ONLY                                      *   CL**2
  5978*----------------------------------------------------------------*   CL**2
  5979*  PASSED TO ELRATE                                              *   CL**2
  5980*  ----------------                                              *   CL**2
  5981*  CERT ISSUE DATE                                               *   CL**2
  5982*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *   CL**2
  5983*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *   CL**2
  5984*  CAPPED TERM   (ONLY FOR TRUNCATED LIFE)                       *   CL**2
  5985*  STATE CODE (CLIENT DEFINED)                                   *   CL**2
  5986*  STATE CODE (STANDARD P.O. ABBRV)                              *   CL**2
  5987*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *   CL**2
  5988*  DEVIATION CODE                                                *   CL**2
  5989*  ISSUE AGE                                                     *   CL**2
  5990*  ORIGINAL BENEFIT AMOUNT                                       *   CL**2
  5991*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *   CL**2
  5992*  PROCESS TYPE (ISSUE OR CANCEL)                                *   CL**2
  5993*  BENEFIT KIND (LIFE OR A/H)                                    *   CL**2
  5994*  A.P.R.                                                        *   CL**2
  5995*  METHOD                                                            CL**2
  5996*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *   CL**2
  5997*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *   CL**2
  5998*  COMPANY I.D. (3 CHARACTER)                                    *   CL**2
  5999*  BENEFIT CODE                                                  *   CL**2
  6000*  BENEFIT OVERRIDE CODE                                         *   CL**2
  6001*  MAXIMUM MONTHLY BENEFIT (FROM ACCT MASTER - CSL ONLY)         *   CL**2
  6002*  MAXIMUM TOTAL BENEFIT (FROM ACCT MASTER - CSL ONLY)           *   CL**2
  6003*  JOINT INDICATOR (CSL ONLY)                                    *   CL**2
  6004*  FIRST PAYMENT DATE (CSL ONLY)                                 *   CL**2
  6005*  PERIODIC PAYMENT AMOUNT (IN CP-REMAINING-TERM - CSL ONLY)     *   CL**2
  6006*                                                                *   CL**2
  6007*  RETURNED FROM ELRATE                                          *   CL**2
  6008*  --------------------                                          *   CL**2
  6009*  CALCULATED PREMIUM                                            *   CL**2
  6010*  PREMIUM RATE                                                  *   CL**2
  6011*  MORTALITY CODE                                                *   CL**2
  6012*  MAX ATTAINED AGE                                              *   CL**2
  6013*  MAX AGE                                                       *   CL**2
  6014*  MAX TERM                                                      *   CL**2
  6015*  MAX MONTHLY BENEFIT                                           *   CL**2
  6016*  MAX TOTAL BENIFIT                                             *   CL**2
  6017*  COMPOSITE RATE (OPEN-END ONLY)                                *   CL**2
  6018*----------------------------------------------------------------*   CL**2
  6019*  PASSED TO ELRFND                                              *   CL**2
  6020*  ----------------                                              *   CL**2
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 119
* ECS010T1.cbl (/apps/prod/cid1p/copy/ELCCALC)
  6021*  CERT ISSUE DATE                                               *   CL**2
  6022*  REFUND DATE                                                   *   CL**2
  6023*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *   CL**2
  6024*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *   CL**2
  6025*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *   CL**2
  6026*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *   CL**2
  6027*  STATE CODE (CLIENT DEFINED)                                   *   CL**2
  6028*  STATE CODE (STANDARD P.O. ABBRV)                              *   CL**2
  6029*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *   CL**2
  6030*  DEVIATION CODE                                                *   CL**2
  6031*  ISSUE AGE                                                     *   CL**2
  6032*  ORIGINAL BENEFIT AMOUNT                                       *   CL**2
  6033*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *   CL**2
  6034*  PROCESS TYPE (CANCEL)                                         *   CL**2
  6035*  BENEFIT KIND (LIFE OR A/H)                                    *   CL**2
  6036*  A.P.R.                                                        *   CL**2
  6037*  EARNING METHOD - (CODE FROM BENEFIT, STATE OR ACCOUNT RECORD) *   CL**2
  6038*  RATING METHOD -  (CODE FROM BENEFIT)                          *   CL**2
  6039*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *   CL**2
  6040*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *   CL**2
  6041*  COMPANY I.D. (3 CHARACTER)                                    *   CL**2
  6042*  BENEFIT CODE                                                  *   CL**2
  6043*  BENEFIT OVERRIDE CODE                                         *   CL**2
  6044*                                                                *   CL**2
  6045*  RETURNED FROM ELRFND                                          *   CL**2
  6046*  --------------------                                          *   CL**2
  6047*  CALCULATED REFUND                                             *   CL**2
  6048*----------------------------------------------------------------*   CL**2
  6049*  PASSED TO ELEARN                                              *   CL**2
  6050*  ----------------                                              *   CL**2
  6051*  CERT ISSUE DATE                                               *   CL**2
  6052*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *   CL**2
  6053*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *   CL**2
  6054*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *   CL**2
  6055*  STATE CODE (CLIENT DEFINED)                                   *   CL**2
  6056*  STATE CODE (STANDARD P.O. ABBRV)                              *   CL**2
  6057*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *   CL**2
  6058*  DEVIATION CODE                                                *   CL**2
  6059*  ISSUE AGE                                                     *   CL**2
  6060*  ORIGINAL BENEFIT AMOUNT                                       *   CL**2
  6061*  BENEFIT KIND (LIFE OR A/H)                                    *   CL**2
  6062*  A.P.R.                                                        *   CL**2
  6063*  METHOD - (EARNING CODE FROM BENEFIT RECORD)                   *   CL**2
  6064*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *   CL**2
  6065*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *   CL**2
  6066*  COMPANY I.D. (3 CHARACTER)                                    *   CL**2
  6067*  BENEFIT CODE                                                  *   CL**2
  6068*  BENEFIT OVERRIDE CODE                                         *   CL**2
  6069*                                                                *   CL**2
  6070*  RETURNED FROM ELEARN                                          *   CL**2
  6071*  --------------------                                          *   CL**2
  6072*  INDICATED  EARNINGS                                           *   CL**2
  6073*----------------------------------------------------------------*   CL**2
  6074*                 LENGTH = 450                                   *   CL**2
  6075*                                                                *   CL**2
  6076******************************************************************   CL**2
  6077******************************************************************
  6078*                   C H A N G E   L O G
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 120
* ECS010T1.cbl (/apps/prod/cid1p/copy/ELCCALC)
  6079*
  6080* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6081*-----------------------------------------------------------------
  6082*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6083* EFFECTIVE    NUMBER
  6084*-----------------------------------------------------------------
  6085* 010303    2001061800003  PEMA  ADD DCC/MONTHLY PROCESSING
  6086* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  6087* 101807    2007100100007  PEMA  EXPAND CLM RESERVE FIELDS
  6088* 010410    2008021200005  PEMA  ADD FIELDS FOR MN NET PAY BALLOON
  6089* 010410    2009050700003  PEMA  ADD FIELDS FOR SPP-DD
  6090* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  6091* 041710    2007111300001  AJRA  ADD CLAIM CALC SW FOR SC NP+6
  6092* 101110  CR2010012700001  PEMA ADD DDF REFUND/UEP PROCESSING
  6093* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  6094* 040615  CR2013072200002  PEMA  ADD EXTRA PERIODS
  6095******************************************************************
  6096                                                                     CL**2
  6097 01  CALCULATION-PASS-AREA.                                          CL**2
  6098     12  CP-COMM-LENGTH            PIC S9(4)         VALUE +450      CL**2
  6099                                     COMP.                           CL**2
  6100                                                                     CL**2
  6101     12  CP-RETURN-CODE            PIC X             VALUE ZERO.     CL**2
  6102       88  NO-CP-ERROR                             VALUE ZERO.       CL**2
  6103       88  CP-ERROR-OCCURED VALUE '1' '2' '3' '4' '5' '6' '7' '8'    CL**2
  6104                                  '9' 'A' 'B' 'C' 'D' 'E' 'H'.       CL**2
  6105       88  CP-ERROR-IN-AMOUNTS                     VALUE '1'.        CL**2
  6106       88  CP-ERROR-IN-DATES                       VALUE '2'.        CL**2
  6107       88  CP-ERROR-IN-OPTIONS                     VALUE '3'.        CL**2
  6108       88  CP-ERROR-IN-TERMS                       VALUE '4'.        CL**2
  6109       88  CP-ERROR-IN-FREQUENCY                   VALUE '5'.        CL**2
  6110       88  CP-ERROR-RATE-NOT-FOUND                 VALUE '6'.        CL**2
  6111       88  CP-ERROR-RATE-IS-ZERO                   VALUE '7'.        CL**2
  6112       88  CP-ERROR-AMT-OUTSIDE-LIMIT              VALUE '8'.        CL**2
  6113       88  CP-ERROR-TERM-OUTSIDE-LIMIT             VALUE '9'.        CL**2
  6114       88  CP-ERROR-AGE-OUTSIDE-LIMIT              VALUE 'A'.        CL**2
  6115       88  CP-ERROR-ATT-OUTSIDE-LIMIT              VALUE 'B'.        CL**2
  6116       88  CP-ERROR-TOT-OUTSIDE-LIMIT              VALUE 'C'.        CL**2
  6117       88  CP-ERROR-RATE-FILE-NOTOPEN              VALUE 'D'.        CL**2
  6118       88  CP-ERROR-ISSUE-AGE-ZERO                 VALUE 'E'.        CL**2
  6119       88  CP-ERROR-NO-LIMITS-CRI                  VALUE 'F'.        CL**2
  6120       88  CP-ERROR-DIV-BY-ZERO                    VALUE 'G'.        CL**2
  6121       88  CP-ERROR-LOAN-TERM                      VALUE 'H'.        CL**2
  6122                                                                     CL**2
  6123     12  CP-RETURN-CODE-2          PIC X             VALUE ZERO.     CL**2
  6124       88  NO-CP-ERROR-2                           VALUE ZERO.       CL**2
  6125***********************  INPUT AREAS ****************************    CL**2
  6126                                                                     CL**2
  6127     12  CP-CALCULATION-AREA.                                        CL**2
  6128         16  CP-ACCOUNT-NUMBER     PIC X(10)       VALUE SPACES.     CL**2
  6129         16  CP-CERT-EFF-DT        PIC XX.                           CL**2
  6130         16  CP-VALUATION-DT       PIC XX.                           CL**2
  6131         16  CP-PAID-THRU-DT       PIC XX.                           CL**2
  6132         16  CP-BENEFIT-TYPE       PIC X.                            CL**2
  6133           88  CP-AH                               VALUE 'A' 'D'     CL**2
  6134                                                   'I' 'U'.          CL**2
  6135           88  CP-REDUCING-LIFE                    VALUE 'R'.        CL**2
  6136           88  CP-LEVEL-LIFE                       VALUE 'L' 'P'.    CL**2
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 121
* ECS010T1.cbl (/apps/prod/cid1p/copy/ELCCALC)
  6137         16  CP-INCURRED-DT        PIC XX.                           CL**2
  6138         16  CP-REPORTED-DT        PIC XX.                           CL**2
  6139         16  CP-ACCT-FLD-5         PIC XX            VALUE SPACE.    CL**2
  6140         16  CP-COMPANY-ID         PIC XXX           VALUE SPACE.    CL**2
  6141         16  CP-ISSUE-AGE          PIC S9(3)         VALUE ZERO      CL**2
  6142                                     COMP-3.                         CL**2
  6143         16  CP-CDT-PERCENT        PIC S9(3)V99      VALUE ZERO      CL**2
  6144                                     COMP-3.                         CL**2
  6145         16  CP-CDT-METHOD         PIC X.                            CL**2
  6146           88  CP-CDT-ROUND-NEAR                   VALUE '1'.        CL**2
  6147           88  CP-CDT-ROUND-HIGH                   VALUE '2'.        CL**2
  6148           88  CP-CDT-INTERPOLATED                 VALUE '3'.        CL**2
  6149         16  CP-CLAIM-TYPE         PIC X.                            CL**2
  6150           88  CP-AH-CLAIM                         VALUE 'A'.        CL**2
  6151           88  CP-LIFE-CLAIM                       VALUE 'L'.        CL**2
  6152         16  CP-ORIGINAL-TERM      PIC S9(3)         VALUE ZERO      CL**2
  6153                                     COMP-3.                         CL**2
  6154         16  CP-ORIGINAL-BENEFIT   PIC S9(9)V99      VALUE ZERO      CL**2
  6155                                     COMP-3.                         CL**2
  6156         16  CP-ORIGINAL-PREMIUM   PIC S9(7)V99      VALUE ZERO      CL**2
  6157                                     COMP-3.                         CL**2
  6158         16  CP-REMAINING-TERM     PIC S9(3)V99      VALUE ZERO      CL**2
  6159                                     COMP-3.                         CL**2
  6160         16  CP-REMAINING-BENEFIT  PIC S9(9)V99      VALUE ZERO      CL**2
  6161                                     COMP-3.                         CL**2
  6162         16  CP-LOAN-APR           PIC S9(3)V9(4)    VALUE ZERO      CL**2
  6163                                     COMP-3.                         CL**2
  6164         16  CP-PAY-FREQUENCY      PIC S9(3)         VALUE ZERO      CL**2
  6165                                     COMP-3.                         CL**2
  6166         16  CP-REM-TERM-METHOD    PIC X.                            CL**2
  6167           88  CP-EARN-AFTER-15TH                  VALUE '1'.        CL**2
  6168           88  CP-EARN-ON-HALF-MONTH               VALUE '2'.        CL**2
  6169           88  CP-EARN-ON-1ST-DAY                  VALUE '3'.        CL**2
  6170           88  CP-EARN-ON-FULL-MONTH               VALUE '4'.        CL**2
  6171           88  CP-EARN-WITH-NO-DAYS                VALUE '5'.        CL**2
  6172           88  CP-EARN-AFTER-14TH                  VALUE '6'.        CL**2
  6173           88  CP-EARN-AFTER-16TH                  VALUE '7'.        CL**2
  6174         16  CP-EARNING-METHOD     PIC X.                            CL**2
  6175           88  CP-EARN-BY-R78                      VALUE '1' 'R'.    CL**2
  6176           88  CP-EARN-BY-PRORATA                  VALUE '2' 'P'.    CL**2
  6177           88  CP-EARN-AS-CALIF                    VALUE '3' 'C'.    CL**2
  6178           88  CP-EARN-AS-TEXAS                    VALUE '4' 'T'.    CL**2
  6179           88  CP-EARN-AS-FARM-PLAN                VALUE '4' 'T'.    CL**2
  6180           88  CP-EARN-AS-NET-PAY                  VALUE '5' 'N'.    CL**2
  6181           88  CP-EARN-ANTICIPATION                VALUE '6' 'A'.    CL**2
  6182           88  CP-EARN-AS-MEAN                     VALUE '8' 'M'.    CL**2
  6183           88  CP-EARN-AS-SUM-OF-DIGITS            VALUE '9'.        CL**2
  6184           88  CP-EARN-AS-REG-BALLOON              VALUE 'B'.        CL**2
  6185           88  CP-GAP-NON-REFUNDABLE               VALUE 'G'.
  6186           88  CP-GAP-ACTUARIAL                    VALUE 'S'.
  6187           88  CP-DCC-SPP-DDF                      VALUE 'D' 'I'.
  6188           88  CP-DCC-SPP-DDF-IU                   VALUE 'I'.
  6189         16  CP-PROCESS-TYPE       PIC X.                            CL**2
  6190           88  CP-CLAIM                            VALUE '1'.        CL**2
  6191           88  CP-CANCEL                           VALUE '2'.        CL**2
  6192           88  CP-ISSUE                            VALUE '3'.        CL**2
  6193         16  CP-SPECIAL-CALC-CD    PIC X.                            CL**2
  6194           88  CP-OUTSTANDING-BAL              VALUE 'O'.            CL**2
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 122
* ECS010T1.cbl (/apps/prod/cid1p/copy/ELCCALC)
  6195           88  CP-1-MTH-INTEREST               VALUE ' '.            CL**2
  6196           88  CP-0-MTH-INTEREST               VALUE 'A'.            CL**2
  6197           88  CP-OB-OFFLINE-RESERVED          VALUE 'B'.            CL**2
  6198           88  CP-CRITICAL-PERIOD              VALUE 'C'.            CL**2
  6199           88  CP-TERM-IS-DAYS                 VALUE 'D'.            CL**2
  6200           88  CP-USE-PREM-AS-ENTERED          VALUE 'E'.            CL**2
  6201           88  CP-FARM-PLAN                    VALUE 'F'.            CL**2
  6202           88  CP-RATE-AS-STANDARD             VALUE 'G'.            CL**2
  6203           88  CP-2-MTH-INTEREST               VALUE 'I'.            CL**2
  6204           88  CP-3-MTH-INTEREST               VALUE 'J'.            CL**2
  6205           88  CP-4-MTH-INTEREST               VALUE 'K'.            CL**2
  6206           88  CP-BALLOON-LAST-PMT             VALUE 'L'.            CL**2
  6207           88  CP-MORTGAGE-REC                 VALUE 'M'.            CL**2
  6208           88  CP-OUTSTANDING-BALANCE          VALUE 'O'.            CL**2
  6209           88  CP-NET-PAY-PRUDENTIAL           VALUE 'P'.            CL**2
  6210           88  CP-NET-PAY-SIMPLE               VALUE 'S'.            CL**2
  6211           88  CP-TRUNCATED-LIFE               VALUE 'T' 'U' 'V'     CL**2
  6212                                                     'W' 'X'.        CL**2
  6213           88  CP-TRUNCATE-0-MTH               VALUE 'T'.            CL**2
  6214           88  CP-TRUNCATE-1-MTH               VALUE 'U'.            CL**2
  6215           88  CP-TRUNCATE-2-MTH               VALUE 'V'.            CL**2
  6216           88  CP-TRUNCATE-3-MTH               VALUE 'W'.            CL**2
  6217           88  CP-TRUNCATE-4-MTH               VALUE 'X'.            CL**2
  6218           88  CP-SUMMARY-REC                  VALUE 'Z'.            CL**2
  6219           88  CP-PROPERTY-BENEFIT             VALUE '2'.            CL**2
  6220           88  CP-UNEMPLOYMENT-BENEFIT         VALUE '3'.            CL**2
  6221           88  CP-AD-D-BENEFIT                 VALUE '4'.            CL**2
  6222           88  CP-CSL-METH-1                   VALUE '5'.            CL**2
  6223           88  CP-CSL-METH-2                   VALUE '6'.            CL**2
  6224           88  CP-CSL-METH-3                   VALUE '7'.            CL**2
  6225           88  CP-CSL-METH-4                   VALUE '8'.            CL**2
  6226                                                                     CL**2
  6227         16  CP-LOAN-TERM          PIC S9(3)       VALUE ZERO        CL**2
  6228                                     COMP-3.                         CL**2
  6229         16  CP-CLASS-CODE         PIC XX          VALUE ZERO.       CL**2
  6230         16  CP-DEVIATION-CODE     PIC XXX         VALUE ZERO.       CL**2
  6231         16  CP-STATE              PIC XX          VALUE SPACE.      CL**2
  6232         16  CP-STATE-STD-ABBRV    PIC XX          VALUE SPACE.      CL**2
  6233         16  CP-BENEFIT-CD         PIC XX          VALUE ZERO.       CL**2
  6234           88  CP-CSL-VALID-NP-BENEFIT-CD VALUES '12' '13'           CL**2
  6235               '34' '35' '36' '37' '44' '45' '46' '47' '72' '73'.    CL**2
  6236         16  CP-R78-OPTION         PIC X.                            CL**2
  6237           88  CP-TERM-TIMES-TERM-PLUS-1           VALUE ' '.        CL**2
  6238           88  CP-TERM-TIMES-TERM                  VALUE '1'.        CL**2
  6239                                                                     CL**2
  6240         16  CP-COMPANY-CD         PIC X             VALUE SPACE.    CL**2
  6241         16  CP-IBNR-RESERVE-SW    PIC X.                            CL**2
  6242         16  CP-CLAIM-STATUS       PIC X.                            CL**2
  6243         16  CP-RATE-FILE          PIC X.                            CL**2
  6244         16  CP-TERM-OR-EXT-DAYS   PIC S9(05)        VALUE ZERO      CL**2
  6245                                     COMP-3.                         CL**2
  6246                                                                     CL**2
  6247         16  CP-LIFE-OVERRIDE-CODE PIC X.                            CL**2
  6248         16  CP-AH-OVERRIDE-CODE   PIC X.                            CL**2
  6249                                                                     CL**2
  6250         16  CP-RATE-DEV-PCT       PIC S9V9(6)       VALUE ZERO      CL**2
  6251                                     COMP-3.
  6252         16  CP-CLP-RATE-UP        REDEFINES CP-RATE-DEV-PCT
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 123
* ECS010T1.cbl (/apps/prod/cid1p/copy/ELCCALC)
  6253                                   PIC S9(5)V99 COMP-3.
  6254         16  CP-CRITICAL-MONTHS    PIC S9(3)         VALUE ZERO      CL**2
  6255                                     COMP-3.                         CL**2
  6256         16  CP-ALTERNATE-BENEFIT  PIC S9(9)V99      VALUE ZERO      CL**2
  6257                                     COMP-3.                         CL**2
  6258         16  CP-ALTERNATE-PREMIUM  PIC S9(7)V99      VALUE ZERO      CL**2
  6259                                     COMP-3.
  6260         16  CP-DDF-CSO-ADMIN-FEE REDEFINES CP-ALTERNATE-PREMIUM
  6261                                  PIC S9(7)V99 COMP-3.
  6262                                                                     CL**2
  6263         16  CP-PAID-FROM-DATE     PIC X(02).                        CL**2
  6264         16  CP-CLAIM-CALC-METHOD  PIC X(01).                        CL**2
  6265         16  CP-EXT-DAYS-CALC      PIC X.                            CL**2
  6266           88  CP-EXT-NO-CHG                   VALUE ' '.            CL**2
  6267           88  CP-EXT-CHG-LF                   VALUE '1'.            CL**2
  6268           88  CP-EXT-CHG-AH                   VALUE '2'.            CL**2
  6269           88  CP-EXT-CHG-LF-AH                VALUE '3'.            CL**2
  6270         16  CP-DOMICILE-STATE     PIC XX.                           CL**2
  6271         16  CP-CARRIER            PIC X.                            CL**2
  6272         16  CP-REIN-FLAG          PIC X.                            CL**2
  6273         16  CP-REM-TRM-CALC-OPTION PIC X.                           CL**2
  6274           88  VALID-REM-TRM-CALC-OPTION    VALUE '1'                CL**2
  6275                      '2' '3' '4' '5'.                               CL**2
  6276           88  CP-CALC-OPTION-DEFAULT       VALUE '4'.               CL**2
  6277           88  CP-CONSIDER-EXTENSION        VALUE '3' '4' '5'.       CL**2
  6278           88  CP-30-DAY-MONTH              VALUE '1' '3' '5'.       CL**2
  6279           88  CP-NO-EXT-30-DAY-MONTH       VALUE '1'.               CL**2
  6280           88  CP-NO-EXT-ACTUAL-DAYS        VALUE '2'.               CL**2
  6281           88  CP-EXT-30-DAY-MONTH          VALUE '3'.               CL**2
  6282           88  CP-EXT-ACTUAL-DAYS           VALUE '4'.               CL**2
  6283           88  CP-USE-EXP-AND-1ST-PMT       VALUE '5'.
  6284         16  CP-SIG-SWITCH         PIC X.                            CL**2
  6285         16  CP-RATING-METHOD      PIC X.                            CL**2
  6286           88  CP-RATE-AS-R78                      VALUE '1' 'R'.    CL**2
  6287           88  CP-RATE-AS-PRORATA                  VALUE '2' 'P'.    CL**2
  6288           88  CP-RATE-AS-CALIF                    VALUE '3' 'C'.    CL**2
  6289           88  CP-RATE-AS-TEXAS                    VALUE '4' 'T'.    CL**2
  6290           88  CP-RATE-AS-FARM-PLAN                VALUE '4' 'T'.    CL**2
  6291           88  CP-RATE-AS-NET-PAY                  VALUE '5' 'N'.    CL**2
  6292           88  CP-RATE-AS-ANTICIPATION             VALUE '6' 'A'.    CL**2
  6293           88  CP-RATE-AS-MEAN                     VALUE '8' 'M'.    CL**2
  6294           88  CP-RATE-AS-REG-BALLOON              VALUE 'B'.        CL**2
  6295         16  CP-SALES-TAX          PIC S9V9999     VALUE  ZEROS      CL**2
  6296                                     COMP-3.                         CL**2
  6297         16  CP-BEN-CATEGORY       PIC X.
  6298         16  CP-DCC-LF-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  6299         16  CP-DCC-ACT-COMM REDEFINES CP-DCC-LF-RATE
  6300                                   PIC S99V9(5) COMP-3.
  6301         16  CP-DCC-AH-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  6302         16  CP-DCC-PMF-COMM REDEFINES CP-DCC-AH-RATE
  6303                                   PIC S99V9(5) COMP-3.
  6304         16  CP-DAYS-TO-1ST-PMT    PIC S999     COMP-3 VALUE +0.
  6305         16  CP-AH-BALLOON-SW      PIC X  VALUE ' '.
  6306         16  CP-EXPIRE-DT          PIC XX.
  6307         16  CP-LF-CLAIM-CALC-SW   PIC X  VALUE ' '.
  6308         16  CP-DDF-HI-FACT        PIC S9V999   COMP-3 VALUE +0.
  6309         16  CP-DDF-LO-FACT        PIC S9V999   COMP-3 VALUE +0.
  6310         16  CP-DDF-CLP            PIC S9(5)V99 COMP-3 VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 124
* ECS010T1.cbl (/apps/prod/cid1p/copy/ELCCALC)
  6311         16  CP-DDF-SPEC-CALC      PIC X.
  6312             88  CP-CALC-GROSS-FEE        VALUE 'G'.
  6313             88  CP-CALC-CLP              VALUE 'C'.
  6314         16  CP-IU-RATE-UP         PIC S9(5)V99   COMP-3 VALUE +0.
  6315         16  CP-CANCEL-REASON      PIC X.
  6316         16  CP-DDF-ADMIN-FEES     PIC S9(5)V99 COMP-3 VALUE +0.
  6317         16  CP-PMT-MODE           PIC X.
  6318         16  CP-NO-OF-PMTS         PIC S999 COMP-3 VALUE +0.
  6319         16  CP-1ST-YR-ALLOW       PIC S999V99 COMP-3 VALUE +0.
  6320         16  CP-DDF-COMM-AND-MFEE  PIC S9(5)V99 COMP-3 VALUE +0.
  6321         16  CP-DDF-YR1AF          PIC S9(5)V99 COMP-3 VALUE +0.
  6322         16  FILLER                PIC X.
  6323                                                                     CL**2
  6324***************    OUTPUT FROM ELRESV   ************************     CL**2
  6325                                                                     CL**2
  6326         16  CP-CDT-TABLE          PIC 9             VALUE ZERO.     CL**2
  6327                                                                     CL**2
  6328         16  CP-CDT-FACTOR         PIC S9(5)V9(6)    VALUE ZERO      CL**2
  6329                                     COMP-3.                         CL**2
  6330         16  CP-PTC-RESERVE        PIC S9(7)V99   VALUE ZERO         CL**2
  6331                                     COMP-3.                         CL**2
  6332         16  CP-IBNR-RESERVE       PIC S9(7)V99   VALUE ZERO         CL**2
  6333                                     COMP-3.                         CL**2
  6334         16  CP-FUTURE-RESERVE     PIC S9(7)V99   VALUE ZERO         CL**2
  6335                                     COMP-3.                         CL**2
  6336         16  FILLER                PIC X(09).                        CL**2
  6337***************    OUTPUT FROM ELRTRM   *************************    CL**2
  6338                                                                     CL**2
  6339         16  CP-REMAINING-TERM-1   PIC S9(4)V9    VALUE ZERO         CL**2
  6340                                     COMP-3.                         CL**2
  6341         16  CP-REMAINING-TERM-2   PIC S9(4)V9    VALUE ZERO         CL**2
  6342                                     COMP-3.                         CL**2
  6343         16  CP-REMAINING-TERM-3   PIC S9(4)V9    VALUE ZERO         CL**2
  6344                                     COMP-3.                         CL**2
  6345         16  CP-ODD-DAYS           PIC S9(3)      VALUE ZERO         CL**2
  6346                                     COMP-3.                         CL**2
  6347         16  FILLER                PIC X(12).                        CL**2
  6348                                                                     CL**2
  6349***************    OUTPUT FROM ELRAMT   *************************    CL**2
  6350                                                                     CL**2
  6351         16  CP-REMAINING-AMT      PIC S9(9)V99   VALUE ZERO         CL**2
  6352                                     COMP-3.                         CL**2
  6353         16  CP-REMAINING-AMT-PRV  PIC S9(9)V99   VALUE ZERO         CL**2
  6354                                     COMP-3.                         CL**2
  6355         16  FILLER                PIC X(12).                        CL**2
  6356                                                                     CL**2
  6357***************    OUTPUT FROM ELRATE   *************************    CL**2
  6358                                                                     CL**2
  6359         16  CP-CALC-PREMIUM       PIC S9(7)V99   VALUE ZERO         CL**2
  6360                                     COMP-3.                         CL**2
  6361         16  CP-PREMIUM-RATE       PIC S9(2)V9(5) VALUE ZERO         CL**2
  6362                                     COMP-3.                         CL**2
  6363         16  CP-MORTALITY-CODE     PIC X(4).                         CL**2
  6364         16  CP-RATE-EDIT-FLAG     PIC X.                            CL**2
  6365             88  CP-RATES-NEED-APR                  VALUE '1'.       CL**2
  6366         16  CP-COMPOSITE-RATE     PIC S99V999    VALUE ZERO         CL**2
  6367                                     COMP-3.                         CL**2
  6368         16  CP-POLICY-FEE         PIC S9(3)V99 VALUE +0 COMP-3.     CL**2
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 125
* ECS010T1.cbl (/apps/prod/cid1p/copy/ELCCALC)
  6369         16  CP-LF-PREM            PIC S9(7)V99 VALUE +0 COMP-3.
  6370         16  CP-LF-BALLOON-PREM REDEFINES CP-LF-PREM
  6371                                   PIC S9(7)V99 COMP-3.
  6372         16  FILLER                PIC X(07).                        CL**2
  6373                                                                     CL**2
  6374***************    OUTPUT FROM ELRFND   *************************    CL**2
  6375                                                                     CL**2
  6376         16  CP-CALC-REFUND        PIC S9(7)V99   VALUE ZERO         CL**2
  6377                                     COMP-3.                         CL**2
  6378         16  CP-REFUND-TYPE-USED   PIC X.                            CL**2
  6379           88  CP-R-AS-R78                         VALUE '1'.        CL**2
  6380           88  CP-R-AS-PRORATA                     VALUE '2'.        CL**2
  6381           88  CP-R-AS-CALIF                       VALUE '3'.        CL**2
  6382           88  CP-R-AS-TEXAS                       VALUE '4'.        CL**2
  6383           88  CP-R-AS-FARM-PLAN                   VALUE '4'.        CL**2
  6384           88  CP-R-AS-NET-PAY                     VALUE '5'.        CL**2
  6385           88  CP-R-AS-ANTICIPATION                VALUE '6'.        CL**2
  6386           88  CP-R-AS-MEAN                        VALUE '8'.        CL**2
  6387           88  CP-R-AS-SUM-OF-DIGITS               VALUE '9'.        CL**2
  6388           88  CP-R-AS-GAP-NON-REFUND              VALUE 'G'.
  6389           88  CP-R-AS-GAP-ACTUARIAL               VALUE 'S'.
  6390           88  CP-R-AS-SPP-DDF                     VALUE 'D'.
  6391           88  CP-R-AS-SPP-DDF-IU                  VALUE 'I'.
  6392           88  CP-R-AS-REPOSSESSION                VALUE 'R'.
  6393         16  FILLER                PIC X(12).                        CL**2
  6394                                                                     CL**2
  6395***************    OUTPUT FROM ELEARN   *************************    CL**2
  6396                                                                     CL**2
  6397         16  CP-R78-U-PRM          PIC S9(7)V99   VALUE ZERO         CL**2
  6398                                     COMP-3.                         CL**2
  6399         16  CP-R78-U-PRM-ALT      PIC S9(7)V99   VALUE ZERO         CL**2
  6400                                     COMP-3.                         CL**2
  6401         16  CP-PRORATA-U-PRM      PIC S9(7)V99   VALUE ZERO         CL**2
  6402                                     COMP-3.                         CL**2
  6403         16  CP-PRORATA-U-PRM-ALT  PIC S9(7)V99   VALUE ZERO         CL**2
  6404                                     COMP-3.                         CL**2
  6405         16  CP-STATE-U-PRM        PIC S9(7)V99   VALUE ZERO         CL**2
  6406                                     COMP-3.                         CL**2
  6407         16  CP-DOMICILE-U-PRM     PIC S9(7)V99   VALUE ZERO         CL**2
  6408                                     COMP-3.                         CL**2
  6409         16  CP-EARNING-TYPE-USED  PIC X.                            CL**2
  6410           88  CP-E-AS-SPECIAL                     VALUE 'S'.        CL**2
  6411           88  CP-E-AS-R78                         VALUE '1'.        CL**2
  6412           88  CP-E-AS-PRORATA                     VALUE '2'.        CL**2
  6413           88  CP-E-AS-TEXAS                       VALUE '4'.        CL**2
  6414           88  CP-E-AS-FARM-PLAN                   VALUE '4'.        CL**2
  6415           88  CP-E-AS-NET-PAY                     VALUE '5'.        CL**2
  6416           88  CP-E-AS-ANTICIPATION                VALUE '6'.        CL**2
  6417           88  CP-E-AS-MEAN                        VALUE '8'.        CL**2
  6418           88  CP-E-AS-SUM-OF-DIGITS               VALUE '9'.        CL**2
  6419         16  FILLER                PIC X(12).                        CL**2
  6420                                                                     CL**2
  6421***************    OUTPUT FROM ELPMNT   *************************    CL**2
  6422                                                                     CL**2
  6423         16  CP-ACTUAL-DAYS        PIC S9(05)     VALUE ZERO         CL**2
  6424                                     COMP-3.                         CL**2
  6425         16  CP-CLAIM-PAYMENT      PIC S9(7)V99   VALUE ZERO         CL**2
  6426                                     COMP-3.                         CL**2
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 126
* ECS010T1.cbl (/apps/prod/cid1p/copy/ELCCALC)
  6427         16  FILLER                PIC X(12).                        CL**2
  6428                                                                     CL**2
  6429***************   MISC WORK AREAS    *****************************   CL**2
  6430         16  CP-TOTAL-PAID         PIC S9(7)V99   VALUE ZERO         CL**2
  6431                                     COMP-3.                         CL**2
  6432         16  CP-R-MAX-ATT-AGE      PIC S9(3)      VALUE ZERO         CL**2
  6433                                     COMP-3.                         CL**2
  6434         16  CP-R-MAX-AGE          PIC S9(3)      VALUE ZERO         CL**2
  6435                                     COMP-3.                         CL**2
  6436         16  CP-R-MAX-TERM         PIC S9(5)      VALUE ZERO         CL**2
  6437                                     COMP-3.                         CL**2
  6438         16  CP-R-MAX-TOT-BEN      PIC S9(7)V99   VALUE ZERO         CL**2
  6439                                     COMP-3.                         CL**2
  6440         16  CP-R-MAX-MON-BEN      PIC S9(7)V99   VALUE ZERO         CL**2
  6441                                     COMP-3.                         CL**2
  6442         16  CP-IO-FUNCTION        PIC X          VALUE SPACE.       CL**2
  6443             88  OPEN-RATE-FILE                   VALUE 'O'.         CL**2
  6444             88  CLOSE-RATE-FILE                  VALUE 'C'.         CL**2
  6445             88  IO-ERROR                         VALUE 'E'.         CL**2
  6446                                                                     CL**2
  6447         16  CP-FIRST-PAY-DATE     PIC XX.                           CL**2
  6448                                                                     CL**2
  6449         16  CP-JOINT-INDICATOR    PIC X.                            CL**2
  6450                                                                     CL**2
  6451         16  CP-RESERVE-REMAINING-TERM                               CL**2
  6452                                   PIC S9(4)V9    VALUE ZERO         CL**2
  6453                                     COMP-3.                         CL**2
  6454                                                                     CL**2
  6455         16  CP-INSURED-BIRTH-DT   PIC XX.                           CL**2
  6456                                                                     CL**2
  6457         16  CP-INCURRED-AGE       PIC S9(3)      VALUE ZERO         CL**2
  6458                                     COMP-3.                         CL**2
  6459                                                                     CL**2
  6460         16  CP-MONTHLY-PAYMENT    PIC S9(5)V99   VALUE ZERO         CL**2
  6461                                     COMP-3.                         CL**2
  6462                                                                     CL**2
  6463         16  CP-RATING-BENEFIT-AMT PIC S9(9)V99   VALUE ZERO         CL**2
  6464                                     COMP-3.                         CL**2
  6465                                                                     CL**2
  6466         16  CP-ODD-DAYS-TO-PMT    PIC S9(3)      VALUE ZERO         CL**2
  6467                                     COMP-3.                         CL**2
  6468                                                                     CL**2
  6469         16  CP-MNTHS-TO-FIRST-PMT PIC S9(3)      VALUE ZERO         CL**2
  6470                                     COMP-3.                         CL**2
  6471                                                                     CL**2
  6472         16  CP-REMAMT-FACTOR      PIC S9(4)V9(9) VALUE ZEROS        CL**2
  6473                                     COMP-3.                         CL**2
  6474                                                                     CL**2
  6475         16  CP-FREE-LOOK          PIC S9(3)      VALUE ZERO         CL**2
  6476                                     COMP-3.                         CL**2
  6477                                                                     CL**2
  6478         16  CP-ROA-REFUND         PIC X          VALUE 'N'.         CL**2
  6479             88  CP-ROA-PREM-AT-REFUND            VALUE 'Y'.         CL**2
  6480                                                                     CL**2
  6481         16  CP-NET-BENEFIT-AMT    PIC S9(9)V99   VALUE ZERO         CL**2
  6482                                     COMP-3.                         CL**2
  6483         16  CP-SCNP-6MO-AMT       PIC S9(9)V99   VALUE ZERO
  6484                                     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 127
* ECS010T1.cbl (/apps/prod/cid1p/copy/ELCCALC)
  6485         16  CP-MONTH              PIC S999     COMP-3 VALUE +0.
  6486         16  cp-extra-periods      pic 9 value zeros.
  6487         16  cp-net-only-state     pic x value spaces.
  6488         16  FILLER                PIC X(13).                        CL**2
  6489******************************************************************   CL**2
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 128
* ECS010T1.cbl
* 6491                             COPY ELCDTECX.
  6492******************************************************************06/05/98
  6493*                                                                *ELCDTECX
  6494*                            ELCDTECX.                           *   LV005
  6495*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  6496*                            VMOD=2.015                          *ELCDTECX
  6497*                                                                *ELCDTECX
  6498*      WORKING STORAGE COPY CODE FOR APPLICATIONS CALLING        *ELCDTECX
  6499*      THE DATE CARD DISK FILE. ( READ ROUTINE = ELCDTERX,       *ELCDTECX
  6500*      AND DISK FILE FD = ELCDTEFX)                              *ELCDTECX
  6501*                                                                *ELCDTECX
  6502******************************************************************ELCDTECX
  6503******************************************************************
  6504*                   C H A N G E   L O G
  6505*
  6506* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6507*-----------------------------------------------------------------
  6508*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6509* EFFECTIVE    NUMBER
  6510*-----------------------------------------------------------------
  6511* 092602    2002091900008  PEMA  INCREASE NUMBER OF MAXIMUM
  6512*                                  BENEFIT CODES FROM 300 TO 900
  6513* 090803    2003080800002  PEMA  ADD CATEGORY FOR SUPER GAP
  6514* 051304    2003080800002  SMVA  ADD REFUND METHOD
  6515* 071714    2013100100002  PEMA  FIX CRIT PERIOD EDITS
  6516******************************************************************
  6517 01  DATE-CARD.                                                   ELCDTECX
  6518     12  DATX-COD                    PIC  X(4).                   ELCDTECX
  6519     12  RUN-DATE                    PIC  9(11)  COMP-3.          ELCDTECX
  6520     12  ALPH-DATE                   PIC  X(18).                  ELCDTECX
  6521     12  EP-DT                       PIC  9(11)  COMP-3.          ELCDTECX
  6522     12  PEND-ACT-FILE               PIC  XX.                     ELCDTECX
  6523     12  EP-SW                       PIC  X.                      ELCDTECX
  6524         88  NO-EP-EXTRACTS          VALUE SPACE.                 ELCDTECX
  6525     12  TAPE-BATCHES                PIC  X.                      ELCDTECX
  6526         88  TP-PREL-BAL             VALUE '1'.                   ELCDTECX
  6527     12  BIN-RUN-DATE                PIC  XX.                     ELCDTECX
  6528     12  RUN-CENTURY.                                             ELCDTECX
  6529         16 RUN-CENTURY-N            PIC  99.                        CL**4
  6530     12  FILLER                      PIC  X.                         CL**4
  6531     12  CLAS-MORT-OVRD              PIC  X(4).                   ELCDTECX
  6532     12  FILLER                      PIC  XXX.                    ELCDTECX
  6533     12  COMPANY-NAME                PIC  X(30).                  ELCDTECX
  6534                                                                  ELCDTECX
  6535 01  FILLER                          PIC  X(7)                       CL**6
  6536                                          VALUE 'OPTIONS'.        ELCDTECX
  6537 01  DATE-CARD-OPTIONS.                                           ELCDTECX
  6538     12  DATE-OPTIONS-ID             PIC  X(4).                   ELCDTECX
  6539     12  DTE-MIN-PREM                PIC  99V99.                  ELCDTECX
  6540     12  DTE-LANGUAGE-IND            PIC  X.                      ELCDTECX
  6541         88  DTE-LANGUAGE-IS-FR           VALUE 'F'.              ELCDTECX
  6542         88  DTE-LANGUAGE-IS-ENG          VALUE 'E'.              ELCDTECX
  6543     12  DTE-MIN-AGE                 PIC  99.                     ELCDTECX
  6544     12  DTE-DEFAULT-AGE             PIC  99.                     ELCDTECX
  6545     12  FILLER                      PIC  X.                      ELCDTECX
  6546     12  DTE-MAX-TERM                PIC  999.                    ELCDTECX
  6547     12  DTE-COMP-VG                 PIC  X.                      ELCDTECX
  6548     12  DTE-REM-TRM                 PIC  X.                      ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 129
* ECS010T1.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  6549     12  DTE-PRM-CK                  PIC S99V99.                  ELCDTECX
  6550     12  DTE-PRORATA                 PIC  X.                      ELCDTECX
  6551     12  DTE-CLM-REJ                 PIC  X.                      ELCDTECX
  6552     12  DTE-REF-REJ                 PIC  X.                      ELCDTECX
  6553     12  DTE-COM-TBL-USED            PIC  X.                      ELCDTECX
  6554     12  FILLER                      PIC  X.                      ELCDTECX
  6555     12  DTE-QTR-CO                  PIC  X.                      ELCDTECX
  6556     12  DTE-REF-CK                  PIC S99V99.                  ELCDTECX
  6557     12  DTE-CLM-CK                  PIC S99V99.                  ELCDTECX
  6558     12  DTE-CONV-DT                 PIC 9(11) COMP-3.               CL**2
  6559     12  DTE-DEFAULT-SEX             PIC  X.                      ELCDTECX
  6560     12  DTE-EPL-FORMAT              PIC  X.                      ELCDTECX
  6561     12  FILLER                      PIC  X.                      ELCDTECX
  6562     12  DTE-JT-AGE                  PIC  X.                      ELCDTECX
  6563     12  DTE-KEY-BIRTH               PIC  X.                      ELCDTECX
  6564     12  DTE-REINSURANCE             PIC  X.                      ELCDTECX
  6565     12  DTE-CLAIM-SORT              PIC  X.                      ELCDTECX
  6566     12  DTE-WRT-OFF                 PIC  S99V99.                 ELCDTECX
  6567     12  DTE-R78                     PIC  X.                      ELCDTECX
  6568     12  DTE-DLY-BILL                PIC  X.                      ELCDTECX
  6569     12  DTE-ALT-MORT-CODE           PIC  X(4).                   ELCDTECX
  6570     12  DTE-CLAIM-PAID-THRU-TO      PIC  X.                      ELCDTECX
  6571     12  DTE-COMPENSATION-ACCESS     PIC  X.                      ELCDTECX
  6572     12  DTE-MORTG-ACCESS-CNTL       PIC  X.                      ELCDTECX
  6573     12  DTE-MP-ALT-MORT-CODE        PIC  X(4).                   ELCDTECX
  6574     12  DTE-MORTALITY-AGE-CALC-METHOD                            ELCDTECX
  6575                                     PIC  X.                      ELCDTECX
  6576         88  DTE-USE-TABLE-ASSIGNED-METHOD VALUE '1'              ELCDTECX
  6577                                                 ' '.             ELCDTECX
  6578         88  DTE-USE-ALL-AGE-LAST          VALUE '2'.             ELCDTECX
  6579         88  DTE-USE-ALL-AGE-NEAR          VALUE '3'.             ELCDTECX
  6580     12  DTE-RESERVE-OPTION-SWITCH   PIC  X.                      ELCDTECX
  6581         88  DTE-OPT-RESERVE-METHOD-AUTH       VALUE 'Y'.         ELCDTECX
  6582         88  DTE-OPT-RESERVE-METHOD-UNAUTH     VALUE 'N' ' '.     ELCDTECX
  6583     12  DTE-REM-TRM-CALC-OPTION     PIC  X.                      ELCDTECX
  6584     12  DTE-EXPERIENCE-RETENTION-AGE                             ELCDTECX
  6585                                     PIC  9.                         CL**4
  6586     12  DTE-SYSTEM.                                              ELCDTECX
  6587         16  DTE-SYS-A-CREDIT        PIC  X.                      ELCDTECX
  6588         16  DTE-SYS-B-PEND-CLAIM    PIC  X.                      ELCDTECX
  6589         16  DTE-SYS-C-CONFIRMATIONS PIC  X.                      ELCDTECX
  6590         16  DTE-SYS-D-DEMAND-BILL   PIC  X.                      ELCDTECX
  6591         16  DTE-SYS-E-CLASIC-CLAIMS PIC  X.                      ELCDTECX
  6592         16  DTE-SYS-F-CLASIC-CREDIT PIC  X.                      ELCDTECX
  6593         16  DTE-SYS-G-AR-USED       PIC  X.                      ELCDTECX
  6594         16  DTE-SYS-H               PIC  X.                      ELCDTECX
  6595         16  DTE-SYS-I               PIC  X.                      ELCDTECX
  6596         16  DTE-SYS-J               PIC  X.                      ELCDTECX
  6597         16  DTE-SYS-K               PIC  X.                      ELCDTECX
  6598         16  DTE-SYS-L               PIC  X.                      ELCDTECX
  6599         16  DTE-SYS-M               PIC  X.                      ELCDTECX
  6600         16  DTE-SYS-N               PIC  X.                      ELCDTECX
  6601         16  DTE-SYS-O               PIC  X.                      ELCDTECX
  6602         16  DTE-SYS-P               PIC  X.                      ELCDTECX
  6603         16  DTE-SYS-Q               PIC  X.                      ELCDTECX
  6604         16  DTE-SYS-R               PIC  X.                      ELCDTECX
  6605         16  DTE-SYS-S               PIC  X.                      ELCDTECX
  6606         16  DTE-SYS-T               PIC  X.                      ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 130
* ECS010T1.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  6607         16  DTE-SYS-U               PIC  X.                      ELCDTECX
  6608         16  DTE-SYS-V               PIC  X.                      ELCDTECX
  6609         16  DTE-SYS-W               PIC  X.                      ELCDTECX
  6610         16  DTE-SYS-X               PIC  X.                      ELCDTECX
  6611         16  DTE-SYS-Y               PIC  X.                      ELCDTECX
  6612         16  DTE-SYS-Z               PIC  X.                      ELCDTECX
  6613     12  FILLER                      REDEFINES DTE-SYSTEM.        ELCDTECX
  6614         16  DTE-SYS-CODE            OCCURS 26 TIMES              ELCDTECX
  6615                                     PIC  X.                      ELCDTECX
  6616     12  DTE-CLIENT                  PIC  XXX.                    ELCDTECX
  6617                                                                  ELCDTECX
  6618 01  CLASIC-SYSTEM-CODES.                                         ELCDTECX
  6619     12  DTE-COLC-ID                 PIC  X(4).                   ELCDTECX
  6620     12  DTE-CLASIC-COMPANY-CD       PIC  X.                      ELCDTECX
  6621     12  DTE-CLASIC-COMPANY-NUMBER   PIC  999.                    ELCDTECX
  6622*    12  DTE-CLASIC-CLAIM-ACCESS     PIC  X.                      ELCDTECX
  6623     12  FILLER                      PIC  X.                      ELCDTECX
  6624     12  CLASIC-REIN-MAINT           PIC  XX.                     ELCDTECX
  6625     12  CLASIC-COMP-MAINT           PIC  XX.                     ELCDTECX
  6626     12  CLASIC-ACCT-MAINT           PIC  XX.                     ELCDTECX
  6627     12  CLASIC-CTBL-MAINT           PIC  XX.                     ELCDTECX
  6628     12  CLASIC-RATE-MAINT           PIC  XX.                     ELCDTECX
  6629     12  CLASIC-CREDIT-EOM-DT        PIC  XX.                     ELCDTECX
  6630     12  CLASIC-CLAIMS-EOM-DT        PIC  XX.                     ELCDTECX
  6631                                                                  ELCDTECX
  6632     12  LIFE-OVERRIDE-L1            PIC  X.                      ELCDTECX
  6633     12  LIFE-OVERRIDE-L2            PIC  XX.                     ELCDTECX
  6634     12  LIFE-OVERRIDE-L6            PIC  X(6).                   ELCDTECX
  6635     12  LIFE-OVERRIDE-L12           PIC  X(12).                  ELCDTECX
  6636                                                                  ELCDTECX
  6637     12  AH-OVERRIDE-L1              PIC  X.                      ELCDTECX
  6638     12  AH-OVERRIDE-L2              PIC  XX.                     ELCDTECX
  6639     12  AH-OVERRIDE-L6              PIC  X(6).                   ELCDTECX
  6640     12  AH-OVERRIDE-L12             PIC  X(12).                  ELCDTECX
  6641                                                                  ELCDTECX
  6642     12  CLAS-REPORT-CD1-CAPTION     PIC  X(10).                  ELCDTECX
  6643     12  CLAS-REPORT-CD2-CAPTION     PIC  X(10).                  ELCDTECX
  6644                                                                  ELCDTECX
  6645     12  CLASIC-MORTG-EOM-DT         PIC  XX.                     ELCDTECX
  6646     12  CLASIC-AR-EOM-DT            PIC  XX.                     ELCDTECX
  6647                                                                  ELCDTECX
  6648     12  FILLER                      PIC  X(11)      VALUE SPACE. ELCDTECX
  6649                                                                  ELCDTECX
  6650 01  DATE-CARD-FACTORS.                                           ELCDTECX
  6651     12  DATE-FACTOR-ID              PIC  X(4).                   ELCDTECX
  6652     12  FAC-1                       PIC S999V9(5).               ELCDTECX
  6653     12  FAC-2                       PIC S999V9(5).               ELCDTECX
  6654     12  FAC-3                       PIC S999V9(5).               ELCDTECX
  6655     12  FAC-4                       PIC S999V9(5).               ELCDTECX
  6656     12  FAC-5                       PIC S999V9(5).               ELCDTECX
  6657     12  FAC-6                       PIC S999V9(5).               ELCDTECX
  6658                                                                  ELCDTECX
  6659 01  FILLER                          PIC  X(12)                   ELCDTECX
  6660                                          VALUE 'COMPANY NAME'.   ELCDTECX
  6661 01  COMPANY-NAME-TABLE.                                          ELCDTECX
  6662     12  C-N-TBL                     OCCURS 6 TIMES.              ELCDTECX
  6663         16  CNT-ID                  PIC  X.                      ELCDTECX
  6664         16  CNT-NAME                PIC  X(30).                  ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 131
* ECS010T1.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  6665                                                                  ELCDTECX
  6666 01  FILLER                          PIC  X(11)                   ELCDTECX
  6667                                          VALUE 'STATE NAMES'.    ELCDTECX
  6668 01  STATE-NAMES.                                                 ELCDTECX
  6669     12  STATE-NAME-FLD              OCCURS 75 TIMES.             ELCDTECX
  6670         16  STATE-SUB               PIC  XX.                     ELCDTECX
  6671         16  STATE-PIC1.                                          ELCDTECX
  6672             20  STATE-ABBR          PIC  XX.                     ELCDTECX
  6673             20  FILLER              PIC  XXX.                    ELCDTECX
  6674             20  STATE-PIC           PIC  X(20).                  ELCDTECX
  6675             20  STATE-CALL-EARN     PIC  X.                      ELCDTECX
  6676             20  STATE-CALL-BREAK    PIC  X.                      ELCDTECX
  6677             20  STATE-PRIM-FAC-DEV  PIC  XXX.                    ELCDTECX
  6678                                                                  ELCDTECX
  6679 01  FILLER                          PIC  X(13)                   ELCDTECX
  6680                                          VALUE 'CARRIER NAMES'.  ELCDTECX
  6681 01  CARRIER-NAMES.                                               ELCDTECX
  6682     12  CARRIER-NAME-FLD            OCCURS 25 TIMES.             ELCDTECX
  6683         16  CARRIER-SUB             PIC  X.                      ELCDTECX
  6684         16  CARRIER-DOM-ST          PIC  XX.                     ELCDTECX
  6685         16  CARRIER-PIC             PIC  X(30).                  ELCDTECX
  6686         16  CARRIER-UEP-PCT         PIC  S9V9(4) COMP-3.            CL**6
  6687         16  CARRIER-R78-PCT         PIC  S9V9(4) COMP-3.            CL**6
  6688         16  CARRIER-PRO-PCT         PIC  S9V9(4) COMP-3.            CL**6
  6689*        16  FILLER                  PIC  X.                      ELCDTECX
  6690         16  CARRIER-SEC-PAY         PIC  X.
  6691             88  SEC-PAY-CARRIER          VALUE 'Y'.
  6692                                                                  ELCDTECX
  6693 01  FILLER                          PIC  X(9)                       CL**6
  6694                                          VALUE 'INS TYPES'.      ELCDTECX
  6695 01  CLAS-INS-TYPES.                                              ELCDTECX
  6696*    12 CLAS-ALL-TYPES               OCCURS 300 TIMES.            ELCDTECX
  6697     12 CLAS-ALL-TYPES               OCCURS 900 TIMES.            ELCDTECX
  6698         16  CLAS-I-BEN              PIC  XX.                     ELCDTECX
  6699         16  CLAS-I-AB3.                                          ELCDTECX
  6700             20  FILLER              PIC  X.                      ELCDTECX
  6701             20  CLAS-I-AB2.                                      ELCDTECX
  6702                 24  FILLER          PIC  X.                      ELCDTECX
  6703                 24  CLAS-I-AB1      PIC  X.                      ELCDTECX
  6704         16  CLAS-I-AB3-AH REDEFINES CLAS-I-AB3.                  ELCDTECX
  6705             20  CLAS-EXCLUSION      PIC  XX.                        CL**4
  6706             20  FILLER              PIC  X.                         CL**4
  6707         16  CLAS-I-AB10.                                         ELCDTECX
  6708             20  FILLER              PIC  X(9).                   ELCDTECX
  6709             20  CLAS-I-REIN-YN      PIC  X.                      ELCDTECX
  6710         16  CLAS-I-COMMENT          PIC  X(10).                  ELCDTECX
  6711         16  CLAS-I-JOINT            PIC  X.                      ELCDTECX
  6712         16  CLAS-I-RL-AH            PIC  X.                      ELCDTECX
  6713         16  CLAS-I-CALC-TYPE.                                    ELCDTECX
  6714             20  CLAS-I-BAL          PIC  X.                      ELCDTECX
  6715         16  CLAS-I-EP               PIC  X.                      ELCDTECX
  6716         16  CLAS-CO-BEN-I-G-CD      PIC  X.                      ELCDTECX
  6717         16  CLAS-CO-REM-TERM-CALC   PIC  X.                      ELCDTECX
  6718         16  CLAS-I-BEN-CATEGORY     PIC  X.
  6719         16  CLAS-I-REFUND-METHOD    PIC  X.
  6720         16  CLAS-I-MAX-BENEFITS     PIC 99.
  6721         16  FILLER                  PIC  XXX.
  6722                                                                  ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 132
* ECS010T1.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  6723 01  FILLER                          PIC  X(16)                   ELCDTECX
  6724                                     VALUE 'MORTALITY TABLES'.    ELCDTECX
  6725 01  CLAS-MORTALITY-CODES.                                        ELCDTECX
  6726     12  CLAS-MORT-FLD               OCCURS 99 TIMES              ELCDTECX
  6727                                     INDEXED BY CLAS-MORT-NDX.    ELCDTECX
  6728         16  CLAS-MORT-CODE          PIC  X(4).                      CL**6
  6729         16  CLAS-MORT-J-CODE        PIC  X.                         CL**5
  6730         16  CLAS-MORT-J-FACT        PIC S9V9(4).                    CL**6
  6731         16  CLAS-MORT-DESC.                                      ELCDTECX
  6732             20  CLAS-RESERVE-ADJ    PIC  999.                       CL**6
  6733             20  FILLER              PIC  XX.                        CL**5
  6734             20  CLAS-YEAR           PIC  X(4).                      CL**6
  6735             20  FILLER              PIC  X.                         CL**5
  6736             20  CLAS-TABLE-TYPE     PIC  XXX.                       CL**6
  6737             20  FILLER              PIC  X.                         CL**5
  6738             20  CLAS-AGE-METHOD     PIC  XX.                        CL**5
  6739             20  FILLER              PIC  X.                         CL**5
  6740             20  CLAS-INTEREST       PIC  99.99.                     CL**5
  6741             20  FILLER              PIC  X(5).                      CL**6
  6742                                                                  ELCDTECX
  6743 01  FILLER                          PIC  X(15)                   ELCDTECX
  6744                                     VALUE 'BUSINESS TABLES'.     ELCDTECX
  6745 01  CLAS-BUSINESS-CLASSES.                                       ELCDTECX
  6746     12  CLAS-BUSC-FLD               OCCURS 50 TIMES.             ELCDTECX
  6747         16  CLAS-BUSC-CODE          PIC  99.                     ELCDTECX
  6748         16  CLAS-BUSC-GROUP         PIC  X.                      ELCDTECX
  6749         16  CLAS-BUSC-DESC          PIC  X(19).                  ELCDTECX
  6750         16  CLAS-BUSC-EXCL          PIC  X.                         CL**5
  6751         16  FILLER                  PIC  X(4).                      CL**6
  6752                                                                  ELCDTECX
  6753 01  FILLER                          PIC  X(7)                       CL**6
  6754                                     VALUE 'INDEXES'.             ELCDTECX
  6755 01  CLAS-INDEX-TBL.                                              ELCDTECX
  6756     12  CLAX-ID                     PIC  X(4).                   ELCDTECX
  6757     12  CLAS-STARTC                 PIC S9(4) COMP.              ELCDTECX
  6758     12  CLAS-MAXC                   PIC S9(4) COMP.              ELCDTECX
  6759     12  CLAS-STARTL                 PIC S9(4) COMP.              ELCDTECX
  6760     12  CLAS-MAXL                   PIC S9(4) COMP.              ELCDTECX
  6761     12  CLAS-STARTA                 PIC S9(4) COMP.              ELCDTECX
  6762     12  CLAS-MAXA                   PIC S9(4) COMP.              ELCDTECX
  6763     12  CLAS-STARTM                 PIC S9(4) COMP.              ELCDTECX
  6764     12  CLAS-MAXM                   PIC S9(4) COMP.              ELCDTECX
  6765     12  CLAS-STARTB                 PIC S9(4) COMP.              ELCDTECX
  6766     12  CLAS-MAXB                   PIC S9(4) COMP.              ELCDTECX
  6767     12  CLAS-STARTS                 PIC S9(4) COMP.              ELCDTECX
  6768     12  CLAS-MAXS                   PIC S9(4) COMP.              ELCDTECX
  6769     12  CLAS-STARTE                 PIC S9(4) COMP.              ELCDTECX
  6770     12  CLAS-MAXE                   PIC S9(4) COMP.              ELCDTECX
  6771     12  CLAS-STARTCN                PIC S9(4) COMP.              ELCDTECX
  6772     12  CLAS-MAXCN                  PIC S9(4) COMP.              ELCDTECX
  6773                                                                  ELCDTECX
  6774 01  CLAS-TYPE-MISC.                                              ELCDTECX
  6775     12  CLAS-INDEXC                 PIC S9(4) COMP.              ELCDTECX
  6776     12  CLAS-INDEXL                 PIC S9(4) COMP.              ELCDTECX
  6777     12  CLAS-INDEXA                 PIC S9(4) COMP.              ELCDTECX
  6778     12  CLAS-INDEXM                 PIC S9(4) COMP.              ELCDTECX
  6779     12  CLAS-INDEXB                 PIC S9(4) COMP.              ELCDTECX
  6780     12  CLAS-INDEXS                 PIC S9(4) COMP.              ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 133
* ECS010T1.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  6781     12  CLAS-INDEXE                 PIC S9(4) COMP.              ELCDTECX
  6782     12  CLAS-INDEX                  PIC S9(4) COMP.              ELCDTECX
  6783     12  CLAS-INDEXEN                PIC S9(4) COMP.              ELCDTECX
  6784     12  CLAS-INDEXCN                PIC S9(4) COMP.              ELCDTECX
  6785     12  CLAS-INDEXON                PIC S9(4) COMP.              ELCDTECX
  6786                                                                  ELCDTECX
  6787 01  FILLER                          PIC  X(13)                   ELCDTECX
  6788                                     VALUE 'MISCELLANEOUS'.       ELCDTECX
  6789 01  CLAS-MISC.                                                   ELCDTECX
  6790     12  DTE-FICH                    PIC  X.                      ELCDTECX
  6791         88  FICH-NO                 VALUE SPACE.                 ELCDTECX
  6792         88  FICH-ONLY               VALUE '1'.                   ELCDTECX
  6793         88  FICH-BOTH               VALUE '2'.                   ELCDTECX
  6794     12  FICH-OPEN                   PIC  X.                      ELCDTECX
  6795     12  REPT-OPEN                   PIC  X.                      ELCDTECX
  6796     12  DTE-PGM-OPT                 PIC  9.                         CL**5
  6797     12  DTE-PRT-OPT                 PIC  X.                      ELCDTECX
  6798     12  DTE-FMT-OPT                 PIC  9.                      ELCDTECX
  6799     12  DTE-PRC-OPT                 PIC  9.                      ELCDTECX
  6800     12  DTE-TOT-OPT                 PIC  9.                      ELCDTECX
  6801     12  CLAS-LOOK                   PIC  XX.                     ELCDTECX
  6802     12  DTE-TOT-LINES               PIC S9(8)      COMP.         ELCDTECX
  6803     12  STATE-L                     PIC  XX.                     ELCDTECX
  6804     12  CLAS-CN                     PIC  99.                     ELCDTECX
  6805     12  CLAS-CO                     PIC  99.                     ELCDTECX
  6806     12  DTE-VSAM-FLAGS                              VALUE ZERO.  ELCDTECX
  6807         16  DTE-F-1                 PIC  X.                      ELCDTECX
  6808         16  DTE-F-2                 PIC  X.                      ELCDTECX
  6809     12  DTE-ABEND-WORK.                                          ELCDTECX
  6810         16  DTE-ABEND-CD-1          PIC  XX         VALUE SPACES.ELCDTECX
  6811         16  DTE-ABEND-CD-2          PIC  XX         VALUE SPACES.ELCDTECX
  6812                                                                  ELCDTECX
  6813 01  FILLER                          PIC  X(12)                   ELCDTECX
  6814                                     VALUE 'WORKING DATE'.        ELCDTECX
  6815 01  WS-DATE-AND-TIME.                                            ELCDTECX
  6816     12  WS-ACCEPT-DATE.                                          ELCDTECX
  6817         16  WS-AD-YY                PIC  99.                     ELCDTECX
  6818         16  WS-AD-MM                PIC  99.                     ELCDTECX
  6819         16  WS-AD-DD                PIC  99.                     ELCDTECX
  6820     12  WS-CURRENT-DATE.                                         ELCDTECX
  6821         16  WS-CD-MM                PIC  99.                     ELCDTECX
  6822         16  FILLER                  PIC  X          VALUE '/'.   ELCDTECX
  6823         16  WS-CD-DD                PIC  99.                     ELCDTECX
  6824         16  FILLER                  PIC  X          VALUE '/'.   ELCDTECX
  6825         16  WS-CD-YY                PIC  99.                     ELCDTECX
  6826     12  WS-TIME-OF-DAY.                                          ELCDTECX
  6827         16  WS-TIME                 PIC  9(6).                   ELCDTECX
  6828         16  WS-HUN-SEC              PIC  99.                     ELCDTECX
  6829                                                                  ELCDTECX
  6830 01  FILLER                          PIC  X(12)                   ELCDTECX
  6831                                     VALUE 'CARRIER CLMS'.        ELCDTECX
  6832 01  CARRIER-OPT-CLAIM-DATA.                                      ELCDTECX
  6833     12  CARRIER-FLDS                OCCURS 25 TIMES.             ELCDTECX
  6834         16  CARRIER-IBNR-SWITCH     PIC  X.                         CL**5
  6835         16  CARRIER-IBNR-PERCENT    PIC S9V9(4) COMP-3.             CL**6
  6836         16  CARRIER-CIDA-DISCOUNT   PIC S9V9(4) COMP-3.             CL**6
  6837                                                                  ELCDTECX
  6838 01  FILLER                          PIC  X(10)                   ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 134
* ECS010T1.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  6839                                     VALUE 'STATE TLRS'.          ELCDTECX
  6840 01  STATE-TARGET-LOSS-RATIOS.                                    ELCDTECX
  6841     12  STATE-TLR-FLD               OCCURS 75 TIMES.             ELCDTECX
  6842         16  STATE-TARGET-LOSS-RATIO PIC S9V9(4) COMP-3.             CL**6
  6843         16  STATE-CALC-INTEREST     PIC S9V9(4) COMP-3.             CL**6
  6844                                                                  ELCDTECX
  6845 01  FILLER                          PIC  X(13)                   ELCDTECX
  6846                                     VALUE 'BUSINESS TLRS'.       ELCDTECX
  6847 01  BUSINESS-TRGT-LOSS-RATIO-MODS.                               ELCDTECX
  6848     12  BUS-TLRM-FLD                OCCURS 99 TIMES.             ELCDTECX
  6849         16  BUS-TRGT-LOSS-RATIO-MOD PIC S9V9(4) COMP-3.             CL**6
  6850                                                                  ELCDTECX
  6851 01  FILLER                          PIC  X(13)                   ELCDTECX
  6852                                     VALUE 'MISC CLM DATA'.       ELCDTECX
  6853 01  MISC-OPT-CLM-RSV-DATA.                                       ELCDTECX
  6854     12  COMPANY-CALC-INTEREST       PIC S9V9(4) COMP-3.             CL**6
  6855     12  COMPANY-CIDA-DISCOUNT       PIC S9V9(4) COMP-3.             CL**6
  6856     12  COMPANY-CRDB-TABLE-SELECTION                             ELCDTECX
  6857                                     PIC  X.                         CL**5
  6858     12  COMPANY-IBNR-AH-FACTOR      PIC S9V9(4) COMP-3.             CL**6
  6859     12  COMPANY-IBNR-LAG-MONTH      PIC S999    COMP-3.             CL**6
  6860     12  COMPANY-IBNR-LIFE-FACTOR    PIC S9V9(4) COMP-3.             CL**6
  6861     12  COMPANY-OPTION-START-DATE   PIC  XX.                        CL**5
  6862     12  INDEXBS                     PIC S9(4)   COMP.               CL**6
  6863     12  INDEXCA                     PIC S9(4)   COMP.               CL**6
  6864     12  INDEXST                     PIC S9(4)   COMP.               CL**6
  6865     12  FILLER                      PIC  X(75).                  ELCDTECX
  6866******************************************************************ELCDTECX
  6867*01  MISC-CARR-PCT-DATA.                                          00001521
  6868*    12  DD-CARR1-UEP-PCT            PIC S9V9(4) COMP-3.          00001522
  6869*    12  DD-CARR1-R78-PCT            PIC S9V9(4) COMP-3.          00001522
  6870*    12  DD-CARR1-PRO-PCT            PIC S9V9(4) COMP-3.          00001522
  6871*    12  DD-CARR2-UEP-PCT            PIC S9V9(4) COMP-3.          00001522
  6872*    12  DD-CARR2-R78-PCT            PIC S9V9(4) COMP-3.          00001522
  6873*    12  DD-CARR2-PRO-PCT            PIC S9V9(4) COMP-3.          00001522
  6874******************************************************************ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 135
* ECS010T1.cbl
* 6876                             COPY ELCDTEVR.
  6877***************************************************************** 04/15/98
  6878*                                                                *ELCDTEVR
  6879*                                                                *ELCDTEVR
  6880*                            ELCDTEVR.                           *   LV003
  6881*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
  6882*                            VMOD=2.001                          *   CL**2
  6883*                                                                *ELCDTEVR
  6884*   WORKING STORAGE FOR DATE VARIABLES CREATED                   *ELCDTEVR
  6885*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCDTEVR
  6886*                                                                *ELCDTEVR
  6887******************************************************************ELCDTEVR
  6888 01  WS-DATE-CARD-DATE.                                           ELCDTEVR
  6889     05  WS-RUN-DATE.                                             ELCDTEVR
  6890         10  FILLER                  PIC  9(03).                  ELCDTEVR
  6891         10  RUN-CCYY                PIC  9(04).                  ELCDTEVR
  6892         10  RUN-CCYR  REDEFINES  RUN-CCYY.                       ELCDTEVR
  6893             15  RUN-CC              PIC  99.                     ELCDTEVR
  6894             15  RUN-YR              PIC  99.                     ELCDTEVR
  6895         10  RUN-MO                  PIC  99.                     ELCDTEVR
  6896         10  RUN-DA                  PIC  99.                     ELCDTEVR
  6897     05  WS-RUN-DATE-N REDEFINES                                     CL**2
  6898            WS-RUN-DATE              PIC 9(11).                      CL**2
  6899     05  WS-EP-DT.                                                ELCDTEVR
  6900         10  FILLER                  PIC  9(03).                  ELCDTEVR
  6901         10  EP-CCYY                 PIC  9(04).                  ELCDTEVR
  6902         10  EP-CCYR  REDEFINES  EP-CCYY.                         ELCDTEVR
  6903             15  EP-CC               PIC  99.                     ELCDTEVR
  6904             15  EP-YR               PIC  99.                     ELCDTEVR
  6905         10  EP-MO                   PIC  99.                     ELCDTEVR
  6906         10  EP-DA                   PIC  99.                     ELCDTEVR
  6907     05  WS-EP-DT-N REDEFINES                                        CL**2
  6908            WS-EP-DT                 PIC 9(11).                      CL**2
  6909     05  WS-DTE-CONV-DT.                                             CL**4
  6910         10  FILLER                  PIC  9(03).                     CL**4
  6911         10  DTE-CONV-CCYY           PIC  9(04).                     CL**4
  6912         10  DTE-CONV-CCYR  REDEFINES  DTE-CONV-CCYY.                CL**4
  6913             15  DTE-CONV-CC         PIC  99.                        CL**4
  6914             15  DTE-CONV-YR         PIC  99.                        CL**4
  6915         10  DTE-CONV-MO             PIC  99.                        CL**4
  6916         10  DTE-CONV-DA             PIC  99.                        CL**4
  6917     05  WS-DTE-CONV-DT-N REDEFINES                                  CL**4
  6918            WS-DTE-CONV-DT           PIC  9(11).                     CL**4
  6919 01  WS-BALANCE-FORWARD-DATE.                                     ELCDTEVR
  6920     05  WS-BF-LAST-ACTIVITY-DATE.                                ELCDTEVR
  6921         10  FILLER                            PIC 999.           ELCDTEVR
  6922         10  BF-ACT-CCYY                       PIC 9(04).         ELCDTEVR
  6923         10  BF-ACT-CCYR  REDEFINES  BF-ACT-CCYY.                 ELCDTEVR
  6924             15  BF-ACT-CC                     PIC 99.            ELCDTEVR
  6925             15  BF-ACT-YEAR                   PIC 99.            ELCDTEVR
  6926         10  BF-ACT-MONTH                      PIC 99.            ELCDTEVR
  6927         10  BF-ACT-DAY                        PIC 99.            ELCDTEVR
  6928     05  WS-BF-LAST-ACTIVITY-DATE-N REDEFINES                        CL**2
  6929            WS-BF-LAST-ACTIVITY-DATE           PIC 9(11).            CL**2
  6930     05  WS-BF-CURRENT-LAST-STMT-DT.                              ELCDTEVR
  6931         10  FILLER                            PIC 999.           ELCDTEVR
  6932         10  BF-CURRENT-LAST-STMT-CEN          PIC 99.            ELCDTEVR
  6933         10  BF-CURRENT-LAST-STMT-YEAR         PIC 99.            ELCDTEVR
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 136
* ECS010T1.cbl (/apps/prod/cid1p/copy/ELCDTEVR)
  6934         10  BF-CURRENT-LAST-STMT-MONTH        PIC 99.            ELCDTEVR
  6935         10  BF-CURRENT-LAST-STMT-DAY          PIC 99.            ELCDTEVR
  6936     05  WS-BF-CURRENT-LAST-STMT-DT-N REDEFINES                      CL**2
  6937            WS-BF-CURRENT-LAST-STMT-DT        PIC 9(11).             CL**2
  6938 01  WS-ADD-CONF-TRANSACTIONS-DTE.                                ELCDTEVR
  6939     05  WS-AC-CERT-EFF-DATE.                                     ELCDTEVR
  6940         10  FILLER                            PIC 999.           ELCDTEVR
  6941         10  AC-CERT-CCYY                      PIC 9(04).         ELCDTEVR
  6942         10  AC-CERT-CCYR  REDEFINES  AC-CERT-CCYY.               ELCDTEVR
  6943             15  AC-CERT-CC                    PIC 99.            ELCDTEVR
  6944             15  AC-CERT-YR                    PIC 99.            ELCDTEVR
  6945         10  AC-CERT-MO                        PIC 99.            ELCDTEVR
  6946         10  AC-CERT-DA                        PIC 99.            ELCDTEVR
  6947     05  WS-AC-CERT-EFF-DATE-N REDEFINES                             CL**2
  6948            WS-AC-CERT-EFF-DATE                PIC 9(11).            CL**2
  6949     05  WS-AC-LIFE-CANCEL-DATE.                                  ELCDTEVR
  6950         10  FILLER                            PIC 999.           ELCDTEVR
  6951         10  AC-LIFE-CANCEL-CCYY               PIC 9(04).         ELCDTEVR
  6952         10  AC-LIFE-CANCEL-CCYR REDEFINES AC-LIFE-CANCEL-CCYY.   ELCDTEVR
  6953             15  AC-LIFE-CANCEL-CC             PIC 99.            ELCDTEVR
  6954             15  AC-LIFE-CANCEL-YR             PIC 99.            ELCDTEVR
  6955         10  AC-LIFE-CANCEL-MO                 PIC 99.            ELCDTEVR
  6956         10  AC-LIFE-CANCEL-DA                 PIC 99.            ELCDTEVR
  6957     05  WS-AC-LIFE-CANCEL-DATE-N REDEFINES                          CL**2
  6958            WS-AC-LIFE-CANCEL-DATE             PIC 9(11).            CL**2
  6959     05  WS-AC-AH-CANCEL-DATE.                                    ELCDTEVR
  6960         10  FILLER                            PIC 999.           ELCDTEVR
  6961         10  AC-AH-CANCEL-CCYY                 PIC 9(04).         ELCDTEVR
  6962         10  AC-AH-CANCEL-CCYR  REDEFINES  AC-AH-CANCEL-CCYY.     ELCDTEVR
  6963             15  AC-AH-CANCEL-CC               PIC 99.            ELCDTEVR
  6964             15  AC-AH-CANCEL-YR               PIC 99.            ELCDTEVR
  6965         10  AC-AH-CANCEL-MO                   PIC 99.            ELCDTEVR
  6966         10  AC-AH-CANCEL-DA                   PIC 99.            ELCDTEVR
  6967     05  WS-AC-AH-CANCEL-DATE-N REDEFINES                            CL**2
  6968            WS-AC-AH-CANCEL-DATE               PIC 9(11).            CL**2
  6969 01  WS-RATE-RECORD.                                              ELCDTEVR
  6970         05  WS-RT-EXPIRY-DATE.                                   ELCDTEVR
  6971             10  FILLER                        PIC 999.           ELCDTEVR
  6972             10  RT-EXP-CCYY                   PIC 9(04).         ELCDTEVR
  6973             10  RT-EXP-CCYR  REDEFINES  RT-EXP-CCYY.             ELCDTEVR
  6974                 15  RT-EXP-CC                 PIC 99.            ELCDTEVR
  6975                 15  RT-EXP-YR                 PIC 99.            ELCDTEVR
  6976             10  RT-EXP-MO                     PIC 99.            ELCDTEVR
  6977             10  RT-EXP-DA                     PIC 99.            ELCDTEVR
  6978         05  WS-RT-EXPIRY-DATE-N REDEFINES                           CL**2
  6979                WS-RT-EXPIRY-DATE              PIC 9(11).            CL**2
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 137
* ECS010T1.cbl
* 6981                             COPY ELCACCTV.
  6982******************************************************************04/14/98
  6983*                                                                *ELCACCTV
  6984*                            ELCACCTV                            *   LV002
  6985*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  6986*                            VMOD=2.001                          *ELCACCTV
  6987*                                                                *ELCACCTV
  6988*   WORKING STORAGE FOR DATE VARIABLES CREATED                   *ELCACCTV
  6989*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCACCTV
  6990*                                                                *ELCACCTV
  6991*  NO  CID  MODS  IN  COPYBOOK  ELCACCTV                         *ELCACCTV
  6992*                                                                *ELCACCTV
  6993******************************************************************ELCACCTV
  6994                                                                  ELCACCTV
  6995 01  WS-ACCOUNT-MASTER-DATE.                                      ELCACCTV
  6996                                                                  ELCACCTV
  6997     05  WS-AM-EXPIRE-DT.                                         ELCACCTV
  6998         10  FILLER            PIC 999.                           ELCACCTV
  6999         10  AM-EXP-CCYY       PIC 9(04).                         ELCACCTV
  7000         10  AM-EXP-CCYR  REDEFINES  AM-EXP-CCYY.                 ELCACCTV
  7001             15  AM-EXP-CC     PIC 99.                            ELCACCTV
  7002             15  AM-EXP-YR     PIC 99.                            ELCACCTV
  7003         10  AM-EXP-MO         PIC 99.                               CL**5
  7004         10  AM-EXP-DA         PIC 99.                               CL**5
  7005     05  WS-AM-EXPIRE-DT-N REDEFINES                                 CL**3
  7006            WS-AM-EXPIRE-DT    PIC 9(11).                            CL**4
  7007     05  WS-AM-VG-EXP-DATE.                                       ELCACCTV
  7008         10  FILLER                    PIC 999.                   ELCACCTV
  7009         10  AM-VG-EXP-CCYY            PIC 9(04).                 ELCACCTV
  7010         10  AM-VG-EXP-CCYR  REDEFINES  AM-VG-EXP-CCYY.           ELCACCTV
  7011             15  AM-VG-EXP-CC          PIC 99.                    ELCACCTV
  7012             15  AM-VG-EXP-YR          PIC 99.                    ELCACCTV
  7013         10  AM-VG-EXP-MO              PIC 99.                    ELCACCTV
  7014         10  AM-VG-EXP-DA              PIC 99.                    ELCACCTV
  7015     05  WS-AM-VG-EXP-DATE-N REDEFINES                               CL**3
  7016            WS-AM-VG-EXP-DATE          PIC 9(11).                    CL**4
  7017     05  WS-AM-EFFECT-DT.                                         ELCACCTV
  7018         10  FILLER                    PIC 999.                   ELCACCTV
  7019         10  AM-EFF-CCYY               PIC 9(04).                 ELCACCTV
  7020         10  AM-EFF-CCYR  REDEFINES  AM-EFF-CCYY.                 ELCACCTV
  7021             15  AM-EFF-CC             PIC 99.                    ELCACCTV
  7022             15  AM-EFF-YR             PIC 99.                    ELCACCTV
  7023         10  AM-EFF-MO                 PIC 99.                    ELCACCTV
  7024         10  AM-EFF-DA                 PIC 99.                    ELCACCTV
  7025     05  WS-AM-EFFECT-DT-N REDEFINES                                 CL**3
  7026            WS-AM-EFFECT-DT            PIC 9(11).                    CL**4
  7027     05  WS-AM-PREV-EXP-DT.                                       ELCACCTV
  7028         10 FILLER                     PIC 999.                   ELCACCTV
  7029         10 AM-PREV-EXP-DT-CCYY        PIC 9(04).                 ELCACCTV
  7030         10 AM-PREV-EXP-DT-CCYR  REDEFINES  AM-PREV-EXP-DT-CCYY.  ELCACCTV
  7031            15 AM-PREV-EXP-DT-CC       PIC 99.                    ELCACCTV
  7032            15 AM-PREV-EXP-DT-YR       PIC 99.                    ELCACCTV
  7033         10 AM-PREV-EXP-MO             PIC 99.                    ELCACCTV
  7034         10 AM-PREV-EXP-DA             PIC 99.                    ELCACCTV
  7035     05  WS-AM-PREV-EXP-DT-N REDEFINES                               CL**3
  7036            WS-AM-PREV-EXP-DT          PIC 9(11).                    CL**3
  7037     05  WS-AM-PREV-EFF-DT.                                       ELCACCTV
  7038         10 FILLER                     PIC 999.                   ELCACCTV
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 138
* ECS010T1.cbl (/apps/prod/cid1p/copy/ELCACCTV)
  7039         10 AM-PREV-EFF-CCYY           PIC 9(04).                 ELCACCTV
  7040         10 AM-PREV-EFF-CCYR  REDEFINES  AM-PREV-EFF-CCYY.        ELCACCTV
  7041            15 AM-PREV-EFF-CC          PIC 99.                    ELCACCTV
  7042            15 AM-PREV-EFF-YR          PIC 99.                    ELCACCTV
  7043         10 AM-PREV-EFF-MO             PIC 99.                    ELCACCTV
  7044         10 AM-PREV-EFF-DA             PIC 99.                    ELCACCTV
  7045     05  WS-AM-PREV-EFF-DT-N REDEFINES                               CL**3
  7046            WS-AM-PREV-EFF-DT          PIC 9(11).                    CL**3
  7047     05  WS-AM-ANNIVERSARY-DATE.                                  ELCACCTV
  7048         10  FILLER                    PIC 999.                   ELCACCTV
  7049         10  AM-AN-CCYY                PIC 9(04).                 ELCACCTV
  7050         10  AM-AN-CCYR  REDEFINES  AM-AN-CCYY.                   ELCACCTV
  7051             15  AM-AN-CC              PIC 99.                    ELCACCTV
  7052             15  AM-AN-YR              PIC 99.                    ELCACCTV
  7053         10  AM-AN-MO                  PIC 99.                    ELCACCTV
  7054         10  AM-AN-DA                  PIC 99.                    ELCACCTV
  7055     05  WS-AM-ANNIVERSARY-DATE-N REDEFINES                          CL**3
  7056            WS-AM-ANNIVERSARY-DATE     PIC 9(11).                    CL**4
  7057     05  WS-AM-HI-CERT-DATE.                                      ELCACCTV
  7058         10  FILLER                    PIC 999.                   ELCACCTV
  7059         10  AM-HI-CCYY                PIC 9(04).                 ELCACCTV
  7060         10  AM-HI-CCYR  REDEFINES  AM-HI-CCYY.                   ELCACCTV
  7061             15  AM-HI-CC              PIC 99.                    ELCACCTV
  7062             15  AM-HI-YR              PIC 99.                    ELCACCTV
  7063         10  AM-HI-MO                  PIC 99.                    ELCACCTV
  7064         10  AM-HI-DA                  PIC 99.                    ELCACCTV
  7065     05  WS-AM-HI-CERT-DATE-N REDEFINES                              CL**3
  7066            WS-AM-HI-CERT-DATE         PIC 9(11).                    CL**3
  7067     05  WS-AM-LO-CERT-DATE.                                      ELCACCTV
  7068         10  FILLER                    PIC 999.                   ELCACCTV
  7069         10  AM-LO-CCYY                PIC 9(04).                 ELCACCTV
  7070         10  AM-LO-CCYR  REDEFINES  AM-LO-CCYY.                   ELCACCTV
  7071             15  AM-LO-CC              PIC 99.                    ELCACCTV
  7072             15  AM-LO-YR              PIC 99.                    ELCACCTV
  7073         10  AM-LO-MO                  PIC 99.                    ELCACCTV
  7074         10  AM-LO-DA                  PIC 99.                    ELCACCTV
  7075     05  WS-AM-LO-CERT-DATE-N REDEFINES                              CL**3
  7076            WS-AM-LO-CERT-DATE         PIC 9(11).                    CL**3
  7077     05  WS-AM-ENTRY-DATE.                                        ELCACCTV
  7078         10  FILLER                    PIC 999.                   ELCACCTV
  7079         10  AM-ENT-CCYY               PIC 9(04).                 ELCACCTV
  7080         10  AM-ENT-CCYR  REDEFINES  AM-ENT-CCYY.                 ELCACCTV
  7081             15  AM-ENT-CC             PIC 99.                    ELCACCTV
  7082             15  AM-ENT-YR             PIC 99.                    ELCACCTV
  7083         10  AM-ENT-MO                 PIC 99.                    ELCACCTV
  7084         10  AM-ENT-DA                 PIC 99.                    ELCACCTV
  7085     05  WS-AM-ENTRY-DATE-N REDEFINES                                CL**3
  7086            WS-AM-ENTRY-DATE           PIC 9(11).                    CL**3
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 139
* ECS010T1.cbl
* 7088                             COPY ELCEXTVR.
  7089******************************************************************04/15/98
  7090*                                                                *ELCEXTVR
  7091*                                                                *ELCEXTVR
  7092*                             ELCEXTVR                           *   LV002
  7093*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  7094*                            VMOD=2.001                          *ELCEXTVR
  7095*                                                                *ELCEXTVR
  7096*   WORKING STORAGE FOR DATE VARIABLES CREATED                   *ELCEXTVR
  7097*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCEXTVR
  7098*                                                                *ELCEXTVR
  7099******************************************************************ELCEXTVR
  7100 01  WS-CALL-EXTRACT-DATE.                                        ELCEXTVR
  7101     05  WS-EX-EFF-DATE.                                          ELCEXTVR
  7102         10  FILLER              PIC 999.                         ELCEXTVR
  7103         10  EX-EFF-DATE-CCYY    PIC 9(04).                       ELCEXTVR
  7104         10  EX-EFF-DATE-CCYR  REDEFINES  EX-EFF-DATE-CCYY.       ELCEXTVR
  7105             15  EX-EFF-DATE-CC  PIC 99.                          ELCEXTVR
  7106             15  EX-EFF-DATE-YR  PIC 99.                          ELCEXTVR
  7107         10  EX-EFF-DATE-MO      PIC 99.                          ELCEXTVR
  7108         10  EX-EFF-DATE-DA      PIC 99.                          ELCEXTVR
  7109     05  WS-EX-EFF-DATE-N REDEFINES                                  CL**2
  7110            WS-EX-EFF-DATE       PIC 9(11).                          CL**2
  7111 01  WS-DETAIL-EXTRACT-DATE.                                      ELCEXTVR
  7112     05  WS-DE-EFF.                                               ELCEXTVR
  7113         10  FILLER              PIC 999.                         ELCEXTVR
  7114         10  DE-EF-CCYY          PIC 9(04).                       ELCEXTVR
  7115         10  DE-EF-CCYR  REDEFINES  DE-EF-CCYY.                   ELCEXTVR
  7116             15  DE-EF-CC        PIC 99.                          ELCEXTVR
  7117             15  DE-EF-YR        PIC 99.                          ELCEXTVR
  7118         10  DE-EF-MO            PIC 99.                          ELCEXTVR
  7119         10  DE-EF-DA            PIC 99.                          ELCEXTVR
  7120     05  WS-DE-EFF-N REDEFINES                                       CL**2
  7121            WS-DE-EFF            PIC 9(11).                          CL**2
  7122     05  WS-DE-LF-CANC-DTE.                                       ELCEXTVR
  7123         10  FILLER              PIC 999.                         ELCEXTVR
  7124         10  DE-LF-CANC-CCYY     PIC 9(04).                       ELCEXTVR
  7125         10  DE-LF-CANC-CCYR  REDEFINES  DE-LF-CANC-CCYY.         ELCEXTVR
  7126             15  DE-LF-CANC-CC   PIC 99.                          ELCEXTVR
  7127             15  DE-LF-CANC-YR   PIC 99.                          ELCEXTVR
  7128         10  DE-LF-CANC-MO       PIC 99.                          ELCEXTVR
  7129         10  DE-LF-CANC-DA       PIC 99.                          ELCEXTVR
  7130     05  WS-DE-LF-CANC-DTE-N REDEFINES                               CL**2
  7131            WS-DE-LF-CANC-DTE       PIC 9(11).                       CL**2
  7132     05  WS-DE-LF-CANC-EXIT-DT.                                   ELCEXTVR
  7133         10  FILLER                 PIC 999.                      ELCEXTVR
  7134         10  DE-LF-CANC-EXIT-CCYY   PIC 9(04).                    ELCEXTVR
  7135         10  DE-LF-CANC-EXIT-CCYR REDEFINES DE-LF-CANC-EXIT-CCYY. ELCEXTVR
  7136             15  DE-LF-CANC-EXIT-CC PIC 99.                       ELCEXTVR
  7137             15  DE-LF-CANC-EXIT-YR PIC 99.                       ELCEXTVR
  7138         10  DE-LF-CANC-EXIT-MO     PIC 99.                       ELCEXTVR
  7139         10  DE-LF-CANC-EXIT-DA     PIC 99.                       ELCEXTVR
  7140     05  WS-DE-LF-CANC-EXIT-DT-N REDEFINES                           CL**3
  7141            WS-DE-LF-CANC-EXIT-DT   PIC 9(11).                       CL**2
  7142     05  WS-DE-AH-CANC-DTE.                                       ELCEXTVR
  7143         10  FILLER                 PIC 999.                      ELCEXTVR
  7144         10  DE-AH-CANC-CCYY        PIC 9(04).                    ELCEXTVR
  7145         10  DE-AH-CANC-CCYR  REDEFINES  DE-AH-CANC-CCYY.         ELCEXTVR
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 140
* ECS010T1.cbl (/apps/prod/cid1p/copy/ELCEXTVR)
  7146             15  DE-AH-CANC-CC      PIC 99.                       ELCEXTVR
  7147             15  DE-AH-CANC-YR      PIC 99.                       ELCEXTVR
  7148         10  DE-AH-CANC-MO          PIC 99.                       ELCEXTVR
  7149         10  DE-AH-CANC-DA          PIC 99.                       ELCEXTVR
  7150     05  WS-DE-AH-CANC-DTE-N REDEFINES                               CL**4
  7151            WS-DE-AH-CANC-DTE       PIC 9(11).                       CL**2
  7152     05  WS-DE-AH-CANC-EXIT-DT.                                   ELCEXTVR
  7153         10  FILLER                 PIC 999.                      ELCEXTVR
  7154         10  DE-AH-CANC-EXIT-CCYY   PIC 9(04).                    ELCEXTVR
  7155         10  DE-AH-CANC-EXIT-CCYR REDEFINES DE-AH-CANC-EXIT-CCYY. ELCEXTVR
  7156             15  DE-AH-CANC-EXIT-CC PIC 99.                       ELCEXTVR
  7157             15  DE-AH-CANC-EXIT-YR PIC 99.                       ELCEXTVR
  7158         10  DE-AH-CANC-EXIT-MO     PIC 99.                       ELCEXTVR
  7159         10  DE-AH-CANC-EXIT-DA     PIC 99.                       ELCEXTVR
  7160     05  WS-DE-AH-CANC-EXIT-DT-N REDEFINES                           CL**2
  7161            WS-DE-AH-CANC-EXIT-DT   PIC 9(11).                       CL**2
  7162     05  WS-DE-ENTRY-DTE.                                         ELCEXTVR
  7163         10  FILLER                 PIC 999.                      ELCEXTVR
  7164         10  DE-ENTRY-CCYY          PIC 9(04).                    ELCEXTVR
  7165         10  DE-ENTRY-CCYR  REDEFINES  DE-ENTRY-CCYY.             ELCEXTVR
  7166             15  DE-ENTRY-CC        PIC 99.                       ELCEXTVR
  7167             15  DE-ENTRY-YR        PIC 99.                       ELCEXTVR
  7168         10  DE-ENTRY-MO            PIC 99.                       ELCEXTVR
  7169         10  DE-ENTRY-DA            PIC 99.                       ELCEXTVR
  7170     05  WS-DE-ENTRY-DTE-N REDEFINES                                 CL**2
  7171            WS-DE-ENTRY-DTE         PIC 9(11).                       CL**2
  7172     05  WS-DE-PROC-DT.                                           ELCEXTVR
  7173         10  FILLER                 PIC 999.                      ELCEXTVR
  7174         10  DE-PD-CCYY             PIC 9(04).                    ELCEXTVR
  7175         10  DE-PD-CCYR  REDEFINES  DE-PD-CCYY.                   ELCEXTVR
  7176             15  DE-PD-CC           PIC 99.                       ELCEXTVR
  7177             15  DE-PD-YR           PIC 99.                       ELCEXTVR
  7178         10  DE-PD-MO               PIC 99.                       ELCEXTVR
  7179         10  DE-PD-DA               PIC 99.                       ELCEXTVR
  7180     05  WS-DE-PROC-DT-N REDEFINES                                   CL**2
  7181            WS-DE-PROC-DT           PIC 9(11).                       CL**2
  7182     05  WS-DE-CLM-PROC-DT REDEFINES WS-DE-PROC-DT.                  CL**5
  7183         10  FILLER                 PIC 999.                         CL**5
  7184         10  DE-CP-CCYY             PIC 9(04).                       CL**5
  7185         10  DE-CP-CCYR  REDEFINES  DE-CP-CCYY.                      CL**6
  7186             15  DE-CP-CC           PIC 99.                          CL**5
  7187             15  DE-CP-YR           PIC 99.                          CL**5
  7188         10  DE-CP-MO               PIC 99.                          CL**5
  7189         10  DE-CP-DA               PIC 99.                          CL**5
  7190     05  WS-DE-CLM-PROC-DT-N REDEFINES                               CL**5
  7191            WS-DE-CLM-PROC-DT              PIC 9(11).                CL**5
  7192     05  WS-DE-RSV-PROC-DT REDEFINES WS-DE-PROC-DT.                  CL**5
  7193         10  FILLER                 PIC 999.                         CL**5
  7194         10  DE-RP-CCYY             PIC 9(04).                       CL**5
  7195         10  DE-RP-CCYR  REDEFINES  DE-RP-CCYY.                      CL**6
  7196             15  DE-RP-CC           PIC 99.                          CL**5
  7197             15  DE-RP-YR           PIC 99.                          CL**5
  7198         10  DE-RP-MO                      PIC 99.                   CL**5
  7199         10  DE-RP-DA                      PIC 99.                   CL**5
  7200     05  WS-DE-RSV-PROC-DT-N REDEFINES                               CL**5
  7201            WS-DE-RSV-PROC-DT              PIC 9(11).                CL**5
  7202     05  WS-DE-INCUR.                                             ELCEXTVR
  7203         10  FILLER                 PIC 999.                      ELCEXTVR
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 141
* ECS010T1.cbl (/apps/prod/cid1p/copy/ELCEXTVR)
  7204         10  DE-INCUR-CCYY          PIC 9(04).                    ELCEXTVR
  7205         10  DE-INCUR-CCYR  REDEFINES  DE-INCUR-CCYY.             ELCEXTVR
  7206             15  DE-INCUR-CC        PIC 99.                       ELCEXTVR
  7207             15  DE-INCUR-YR        PIC 99.                       ELCEXTVR
  7208         10  DE-INCUR-MO            PIC 99.                       ELCEXTVR
  7209         10  DE-INCUR-DA            PIC 99.                       ELCEXTVR
  7210     05  WS-DE-INCUR-N REDEFINES                                     CL**2
  7211            WS-DE-INCUR             PIC 9(11).                       CL**2
  7212     05  WS-DE-PAY.                                               ELCEXTVR
  7213         10  FILLER                 PIC 999.                      ELCEXTVR
  7214         10  DE-PAY-CCYY            PIC 9(04).                    ELCEXTVR
  7215         10  DE-PAY-CCYR  REDEFINES  DE-PAY-CCYY.                 ELCEXTVR
  7216             15  DE-PAY-CC          PIC 99.                       ELCEXTVR
  7217             15  DE-PAY-YR          PIC 99.                       ELCEXTVR
  7218         10  DE-PAY-MO              PIC 99.                       ELCEXTVR
  7219         10  DE-PAY-DA              PIC 99.                       ELCEXTVR
  7220     05  WS-DE-PAY-N REDEFINES                                       CL**2
  7221            WS-DE-PAY               PIC 9(11).                       CL**2
  7222     05  WS-DE-PAID-TO.                                           ELCEXTVR
  7223         10  FILLER                 PIC 999.                      ELCEXTVR
  7224         10  DE-PTO-CCYY            PIC 9(04).                    ELCEXTVR
  7225         10  DE-PTO-CCYR  REDEFINES  DE-PTO-CCYY.                 ELCEXTVR
  7226             15  DE-PTO-CC          PIC 99.                       ELCEXTVR
  7227             15  DE-PTO-YR          PIC 99.                       ELCEXTVR
  7228         10  DE-PTO-MO              PIC 99.                       ELCEXTVR
  7229         10  DE-PTO-DA              PIC 99.                       ELCEXTVR
  7230     05  WS-DE-PAID-TO-N REDEFINES                                   CL**2
  7231            WS-DE-PAID-TO           PIC 9(11).                       CL**2
  7232     05  WS-DE-ACC-EXP-DTE.                                       ELCEXTVR
  7233         10 FILLER                  PIC 999.                      ELCEXTVR
  7234         10 DE-ACC-EXP-CCYY         PIC 9(04).                    ELCEXTVR
  7235         10 DE-ACC-EXP-CCYR  REDEFINES  DE-ACC-EXP-CCYY.          ELCEXTVR
  7236            15 DE-ACC-EXP-CC        PIC 99.                       ELCEXTVR
  7237            15 DE-ACC-EXP-YR        PIC 99.                       ELCEXTVR
  7238         10 DE-ACC-EXP-MO           PIC 99.                       ELCEXTVR
  7239         10 DE-ACC-EXP-DA           PIC 99.                       ELCEXTVR
  7240     05  WS-DE-ACC-EXP-DTE-N REDEFINES                               CL**2
  7241            WS-DE-ACC-EXP-DTE       PIC 9(11).                       CL**2
  7242     05  WS-DE-ACC-EFF-DTE.                                       ELCEXTVR
  7243         10 FILLER                  PIC 999.                      ELCEXTVR
  7244         10 DE-ACC-EFF-CCYY         PIC 9(04).                    ELCEXTVR
  7245         10 DE-ACC-EFF-CCYR  REDEFINES  DE-ACC-EFF-CCYY.          ELCEXTVR
  7246            15 DE-ACC-EFF-CC        PIC 99.                       ELCEXTVR
  7247            15 DE-ACC-EFF-YR        PIC 99.                       ELCEXTVR
  7248         10 DE-ACC-EFF-MO           PIC 99.                       ELCEXTVR
  7249         10 DE-ACC-EFF-DA           PIC 99.                       ELCEXTVR
  7250     05  WS-DE-ACC-EFF-DTE-N REDEFINES                               CL**2
  7251            WS-DE-ACC-EFF-DTE       PIC 9(11).                       CL**2
  7252     05  WS-DE-RSV-INCUR.                                         ELCEXTVR
  7253         10  FILLER                 PIC 999.                      ELCEXTVR
  7254         10  DE-RSV-INCUR-CCYY      PIC 9(04).                    ELCEXTVR
  7255         10  DE-RSV-INCUR-CCYR  REDEFINES  DE-RSV-INCUR-CCYY.     ELCEXTVR
  7256             15  DE-RSV-INCUR-CC    PIC 99.                       ELCEXTVR
  7257             15  DE-RSV-INCUR-YR    PIC 99.                       ELCEXTVR
  7258         10  DE-RSV-INCUR-MO        PIC 99.                       ELCEXTVR
  7259         10  DE-RSV-INCUR-DA        PIC 99.                       ELCEXTVR
  7260     05  WS-DE-RSV-INCUR-N REDEFINES                                 CL**2
  7261            WS-DE-RSV-INCUR         PIC 9(11).                       CL**2
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 142
* ECS010T1.cbl (/apps/prod/cid1p/copy/ELCEXTVR)
  7262     05  WS-DE-RSV-PAYTO.                                         ELCEXTVR
  7263         10  FILLER                 PIC 999.                      ELCEXTVR
  7264         10  DE-RSV-PAYTO-CCYY      PIC 9(04).                    ELCEXTVR
  7265         10  DE-RSV-PAYTO-CCYR  REDEFINES  DE-RSV-PAYTO-CCYY.     ELCEXTVR
  7266             15  DE-RSV-PAYTO-CC    PIC 99.                       ELCEXTVR
  7267             15  DE-RSV-PAYTO-YR    PIC 99.                       ELCEXTVR
  7268         10  DE-RSV-PAYTO-MO        PIC 99.                       ELCEXTVR
  7269         10  DE-RSV-PAYTO-DA        PIC 99.                       ELCEXTVR
  7270     05  WS-DE-RSV-PAYTO-N REDEFINES                                 CL**2
  7271            WS-DE-RSV-PAYTO         PIC 9(11).                       CL**2
  7272     05  WS-DE-ACC-EXP-DTE-RSV.                                   ELCEXTVR
  7273         10  FILLER                        PIC 999.               ELCEXTVR
  7274         10  DE-ACC-EXP-DTE-RSV-CCYY       PIC 9(04).             ELCEXTVR
  7275         10  DE-ACC-EXP-DTE-RSV-CCYR REDEFINES                    ELCEXTVR
  7276                             DE-ACC-EXP-DTE-RSV-CCYY.             ELCEXTVR
  7277             15  DE-ACC-EXP-DTE-RSV-CC     PIC 99.                ELCEXTVR
  7278             15  DE-ACC-EXP-DTE-RSV-YR     PIC 99.                ELCEXTVR
  7279         10  DE-ACC-EXP-DTE-RSV-MO         PIC 99.                ELCEXTVR
  7280         10  DE-ACC-EXP-DTE-RSV-DA         PIC 99.                ELCEXTVR
  7281     05  WS-DE-ACC-EXP-DTE-RSV-N REDEFINES                           CL**2
  7282            WS-DE-ACC-EXP-DTE-RSV          PIC 9(11).                CL**2
  7283     05  WS-DE-ACC-EFF-DTE-RSV.                                   ELCEXTVR
  7284         10  FILLER                        PIC 999.               ELCEXTVR
  7285         10  DE-ACC-EFF-DTE-RSV-CCYY       PIC 9(04).             ELCEXTVR
  7286         10  DE-ACC-EFF-DTE-RSV-CCYR  REDEFINES                   ELCEXTVR
  7287                                DE-ACC-EFF-DTE-RSV-CCYY.          ELCEXTVR
  7288             15  DE-ACC-EFF-DTE-RSV-CC     PIC 99.                ELCEXTVR
  7289             15  DE-ACC-EFF-DTE-RSV-YR     PIC 99.                ELCEXTVR
  7290         10  DE-ACC-EFF-DTE-RSV-MO         PIC 99.                ELCEXTVR
  7291         10  DE-ACC-EFF-DTE-RSV-DA         PIC 99.                ELCEXTVR
  7292     05  WS-DE-ACC-EFF-DTE-RSV-N REDEFINES                           CL**2
  7293            WS-DE-ACC-EFF-DTE-RSV          PIC 9(11).                CL**2
  7294                                                                     CL**5
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 143
* ECS010T1.cbl
  7296 PROCEDURE DIVISION.
  7297
  7298 0000-START.
  7299
  7300******************************************************************
  7301***        D A T E   C A R D   L O A D   R O U T I N E         ***
  7302******************************************************************
  7303
  7304*0003-LOAD-DATE-CARD.
* 7305                             COPY ELCDTERX.
  7306******************************************************************04/15/98
  7307*                                                                *ELCDTERX
  7308*                                                                *ELCDTERX
  7309*                            ELCDTERX.                           *   LV002
  7310*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  7311*                            VMOD=2.007                          *ELCDTERX
  7312*                                                                *ELCDTERX
  7313*      LOAD DATE CARD DISK FILE INTO WORKING STORAGE AREA        *ELCDTERX
  7314*      (COPY CODE FOR W/S = ELCDTECX AND COPY CODE FOR FD        *ELCDTERX
  7315*      = ELCDTEFD)                                               *ELCDTERX
  7316*                                                                *ELCDTERX
  7317******************************************************************ELCDTERX
  7318                                                                  ELCDTERX
  7319     ACCEPT WS-ACCEPT-DATE       FROM  DATE.                      ELCDTERX
  7320                                                                  ELCDTERX
  7321     MOVE WS-AD-YY               TO  WS-CD-YY.                    ELCDTERX
  7322     MOVE WS-AD-MM               TO  WS-CD-MM.                    ELCDTERX
  7323     MOVE WS-AD-DD               TO  WS-CD-DD.                    ELCDTERX
  7324                                                                  ELCDTERX
  7325     ACCEPT WS-TIME-OF-DAY       FROM  TIME.                      ELCDTERX
  7326                                                                  ELCDTERX
  7327******************************************************************ELCDTERX
  7328*    NOTE: THE FOLLOWING STATEMENT IS USED TO ELIMINATE COB II    ELCDTERX
  7329*          WARNING MESSAGES.                                      ELCDTERX
  7330******************************************************************ELCDTERX
  7331     IF WS-CD-YY = LOW-VALUES                                     ELCDTERX
  7332         COMPUTE PGM-SUB = PGM-SUB + 1.                           ELCDTERX
  7333                                                                  ELCDTERX
  7334     OPEN INPUT DISK-DATE.                                        ELCDTERX
  7335                                                                  ELCDTERX
  7336     MOVE SPACE TO DATE-CARD         CLAS-BUSINESS-CLASSES        ELCDTERX
  7337                   STATE-NAMES       CLAS-MORTALITY-CODES         ELCDTERX
  7338                   CLAS-INS-TYPES    COMPANY-NAME-TABLE           ELCDTERX
  7339                   DATE-CARD-OPTIONS DATE-CARD-FACTORS            ELCDTERX
  7340                   CLAX-ID           CLAS-MISC                    ELCDTERX
  7341                   CARRIER-NAMES     CLASIC-SYSTEM-CODES          ELCDTERX
  7342                   CARRIER-OPT-CLAIM-DATA                         ELCDTERX
  7343                   STATE-TARGET-LOSS-RATIOS                       ELCDTERX
  7344                   BUSINESS-TRGT-LOSS-RATIO-MODS                  ELCDTERX
  7345                   MISC-OPT-CLM-RSV-DATA.                         ELCDTERX
  7346                                                                  ELCDTERX
  7347     MOVE LOW-VALUES TO CLAS-INDEX-TBL CLAS-TYPE-MISC.            ELCDTERX
  7348                                                                  ELCDTERX
  7349     MOVE ZERO TO CLAS-CN DTE-TOT-LINES CLAS-CO                   ELCDTERX
  7350                  INDEXCA INDEXBS INDEXST.                        ELCDTERX
  7351                                                                  ELCDTERX
  7352     COMPUTE CLAS-CN = PGM-SUB / +50.                             ELCDTERX
  7353     COMPUTE CLAS-CO = PGM-SUB / +20.                             ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 144
* ECS010T1.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  7354     COMPUTE CLAS-INDEXEN = PGM-SUB - (CLAS-CN * +50).            ELCDTERX
  7355     COMPUTE CLAS-INDEXON = PGM-SUB - (CLAS-CO * +20).            ELCDTERX
  7356                                                                  ELCDTERX
  7357     IF CLAS-INDEXEN = ZERO                                       ELCDTERX
  7358         MOVE +50               TO CLAS-INDEXEN                   ELCDTERX
  7359     ELSE                                                         ELCDTERX
  7360         ADD +1                 TO CLAS-CN.                       ELCDTERX
  7361                                                                  ELCDTERX
  7362     IF CLAS-INDEXON = ZERO                                       ELCDTERX
  7363         MOVE +20               TO CLAS-INDEXON                   ELCDTERX
  7364     ELSE                                                         ELCDTERX
  7365         ADD +1                 TO CLAS-CO.                       ELCDTERX
  7366                                                                  ELCDTERX
  7367 0005-READ--CARD.                                                 ELCDTERX
  7368     READ DISK-DATE                                               ELCDTERX
  7369         AT END CLOSE DISK-DATE                                   ELCDTERX
  7370             GO TO 0060-READ--TEST.                               ELCDTERX
  7371                                                                  ELCDTERX
  7372     MOVE ZERO                   TO CLAS-INDEX.                   ELCDTERX
  7373                                                                  ELCDTERX
  7374     IF DD-ID = 'CLAS' OR 'LIFE' OR 'GLED'                        ELCDTERX
  7375         MOVE DATE-DISK          TO DATE-CARD                     ELCDTERX
  7376         MOVE RUN-DATE           TO WS-RUN-DATE-N                    CL**2
  7377         MOVE EP-DT              TO WS-EP-DT-N                       CL**2
  7378         GO TO 0005-READ--CARD.                                   ELCDTERX
  7379                                                                  ELCDTERX
  7380     IF DD-ID = 'CLAD'                                            ELCDTERX
  7381         MOVE DATE-DISK          TO DATE-CARD-OPTIONS             ELCDTERX
  7382         GO TO 0005-READ--CARD.                                   ELCDTERX
  7383                                                                  ELCDTERX
  7384     IF DD-ID = 'CLAX'                                            ELCDTERX
  7385         MOVE DATE-DISK          TO CLAS-INDEX-TBL                ELCDTERX
  7386         GO TO 0005-READ--CARD.                                   ELCDTERX
  7387                                                                  ELCDTERX
  7388     IF DD-ID = 'CLAF'                                            ELCDTERX
  7389         MOVE DATE-DISK          TO DATE-CARD-FACTORS             ELCDTERX
  7390         GO TO 0005-READ--CARD.                                   ELCDTERX
  7391                                                                  ELCDTERX
  7392     IF DD-ID = 'CLAC'                                            ELCDTERX
  7393         GO TO 0010-READ--CLAC.                                   ELCDTERX
  7394                                                                  ELCDTERX
  7395     IF DD-ID = 'CARR'                                            ELCDTERX
  7396         GO TO 0015-READ--CARR.                                   ELCDTERX
  7397                                                                  ELCDTERX
  7398     IF DD-ID = 'STAT'                                            ELCDTERX
  7399         GO TO 0020-READ--STAT.                                   ELCDTERX
  7400                                                                  ELCDTERX
  7401     IF DD-ID = 'BUSC'                                            ELCDTERX
  7402         GO TO 0025-READ--BUSC.                                   ELCDTERX
  7403                                                                  ELCDTERX
  7404     IF DD-ID = 'MORT'                                            ELCDTERX
  7405         GO TO 0030-READ--MORT.                                   ELCDTERX
  7406                                                                  ELCDTERX
  7407     IF DD-ID = 'CLAI'                                            ELCDTERX
  7408         GO TO 0040-READ--CLAI.                                   ELCDTERX
  7409                                                                  ELCDTERX
  7410     IF DD-ID = 'COLC'                                            ELCDTERX
  7411         GO TO 0065-READ--COLC.                                   ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 145
* ECS010T1.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  7412                                                                  ELCDTERX
  7413     IF DD-IDX NUMERIC AND                                        ELCDTERX
  7414        DD-IDA = 'CL'                                             ELCDTERX
  7415         GO TO 0035-READ--CLXX.                                   ELCDTERX
  7416                                                                  ELCDTERX
  7417     IF DD-IDX NUMERIC AND                                        ELCDTERX
  7418        DD-IDA = 'PO'                                             ELCDTERX
  7419         GO TO 0050-READ--POXX.                                   ELCDTERX
  7420                                                                  ELCDTERX
  7421     IF DD-ID = 'OPCA'                                            ELCDTERX
  7422         GO TO 0070-READ--OPCA.                                   ELCDTERX
  7423                                                                  ELCDTERX
  7424     IF DD-ID = 'OPST'                                            ELCDTERX
  7425         GO TO 0072-READ--OPST.                                   ELCDTERX
  7426                                                                  ELCDTERX
  7427     IF DD-ID = 'OPBS'                                            ELCDTERX
  7428         GO TO 0074-READ--OPBS.                                   ELCDTERX
  7429                                                                  ELCDTERX
  7430     IF DD-ID = 'OPMS'                                            ELCDTERX
  7431         MOVE DD-MISC-DATA       TO MISC-OPT-CLM-RSV-DATA.        ELCDTERX
  7432                                                                  ELCDTERX
  7433     GO TO 0005-READ--CARD.                                       ELCDTERX
  7434                                                                  ELCDTERX
  7435 0010-READ--CLAC.                                                 ELCDTERX
  7436     ADD 1                       TO CLAS-INDEXC.                  ELCDTERX
  7437     MOVE DD-CR1                 TO CNT-ID (CLAS-INDEXC).         ELCDTERX
  7438     MOVE DD-CR1N                TO CNT-NAME (CLAS-INDEXC).       ELCDTERX
  7439     ADD 1                       TO CLAS-INDEXC.                  ELCDTERX
  7440     MOVE DD-CR2                 TO CNT-ID (CLAS-INDEXC).         ELCDTERX
  7441     MOVE DD-CR2N                TO CNT-NAME (CLAS-INDEXC).       ELCDTERX
  7442     GO TO 0005-READ--CARD.                                       ELCDTERX
  7443                                                                  ELCDTERX
  7444 0015-READ--CARR.                                                 ELCDTERX
  7445     ADD 1  TO  CLAS-INDEXCN.                                     ELCDTERX
  7446     IF CLAS-INDEXCN LESS THAN +26                                ELCDTERX
  7447        MOVE DD-CARR1         TO CARRIER-SUB (CLAS-INDEXCN)
  7448        MOVE DD-CARR1S        TO CARRIER-DOM-ST (CLAS-INDEXCN)
  7449        MOVE DD-CARR1N        TO CARRIER-PIC (CLAS-INDEXCN)
  7450        MOVE DD-CARR1-UEP-PCT TO CARRIER-UEP-PCT (CLAS-INDEXCN)
  7451        MOVE DD-CARR1-R78-PCT TO CARRIER-R78-PCT (CLAS-INDEXCN)
  7452        MOVE DD-CARR1-PRO-PCT TO CARRIER-PRO-PCT (CLAS-INDEXCN)
  7453        MOVE DD-CARR1-SECPAY-SW
  7454                               TO CARRIER-SEC-PAY (CLAS-INDEXCN)
  7455     END-IF
  7456                                                                  ELCDTERX
  7457     ADD 1  TO  CLAS-INDEXCN.                                     ELCDTERX
  7458     IF CLAS-INDEXCN LESS THAN +26                                ELCDTERX
  7459        MOVE DD-CARR2         TO CARRIER-SUB (CLAS-INDEXCN)
  7460        MOVE DD-CARR2S        TO CARRIER-DOM-ST (CLAS-INDEXCN)
  7461        MOVE DD-CARR2N        TO CARRIER-PIC (CLAS-INDEXCN)
  7462        MOVE DD-CARR2-UEP-PCT TO CARRIER-UEP-PCT (CLAS-INDEXCN)
  7463        MOVE DD-CARR2-R78-PCT TO CARRIER-R78-PCT (CLAS-INDEXCN)
  7464        MOVE DD-CARR2-PRO-PCT TO CARRIER-PRO-PCT (CLAS-INDEXCN)
  7465        MOVE DD-CARR2-SECPAY-SW
  7466                              TO CARRIER-SEC-PAY (CLAS-INDEXCN)
  7467     END-IF
  7468                                                                  ELCDTERX
  7469                                                                  ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 146
* ECS010T1.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  7470     GO TO 0005-READ--CARD.                                       ELCDTERX
  7471                                                                  ELCDTERX
  7472 0020-READ--STAT.                                                 ELCDTERX
  7473     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  7474     IF CLAS-INDEX GREATER 3  OR                                  ELCDTERX
  7475        DD-ST (CLAS-INDEX) = SPACE                                ELCDTERX
  7476         GO TO 0005-READ--CARD.                                   ELCDTERX
  7477                                                                  ELCDTERX
  7478     ADD 1                       TO CLAS-INDEXS.                  ELCDTERX
  7479     MOVE DD-ST (CLAS-INDEX)     TO STATE-NAME-FLD (CLAS-INDEXS). ELCDTERX
  7480     GO TO 0020-READ--STAT.                                       ELCDTERX
  7481                                                                  ELCDTERX
  7482 0025-READ--BUSC.                                                 ELCDTERX
  7483     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  7484     IF CLAS-INDEX GREATER 3  OR                                  ELCDTERX
  7485        DD-ST (CLAS-INDEX) = SPACE                                ELCDTERX
  7486         GO TO 0005-READ--CARD.                                   ELCDTERX
  7487                                                                  ELCDTERX
  7488     ADD 1                       TO CLAS-INDEXB.                  ELCDTERX
  7489     MOVE DD-ST (CLAS-INDEX)     TO CLAS-BUSC-FLD (CLAS-INDEXB).  ELCDTERX
  7490     GO TO 0025-READ--BUSC.                                       ELCDTERX
  7491                                                                  ELCDTERX
  7492 0030-READ--MORT.                                                 ELCDTERX
  7493     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  7494     IF CLAS-INDEX GREATER 2  OR                                  ELCDTERX
  7495        DD-MORT (CLAS-INDEX) = SPACE                              ELCDTERX
  7496         GO TO 0005-READ--CARD.                                   ELCDTERX
  7497                                                                  ELCDTERX
  7498     ADD 1                       TO CLAS-INDEXM.                  ELCDTERX
  7499     MOVE DD-MORT (CLAS-INDEX)   TO CLAS-MORT-FLD (CLAS-INDEXM).  ELCDTERX
  7500     GO TO 0030-READ--MORT.                                       ELCDTERX
  7501                                                                  ELCDTERX
  7502 0035-READ--CLXX.                                                 ELCDTERX
  7503     IF DD-IDX NOT = CLAS-CN                                      ELCDTERX
  7504          GO TO 0005-READ--CARD.                                  ELCDTERX
  7505                                                                  ELCDTERX
  7506     IF DD-PS-PIC (CLAS-INDEXEN) = 'X'                            ELCDTERX
  7507         DISPLAY '***********************************************'ELCDTERX
  7508         DISPLAY 'PROGRAM ECS-', PGM-SUB, ' NOT SCHEDULED TO RUN' ELCDTERX
  7509         DISPLAY '***********************************************'ELCDTERX
  7510         GO TO 0055-READ--STOP.                                   ELCDTERX
  7511                                                                  ELCDTERX
  7512     IF DD-PS-PIC (CLAS-INDEXEN) NOT LESS 'A'  AND                ELCDTERX
  7513        DD-PS-PIC (CLAS-INDEXEN) NOT GREATER 'I'                  ELCDTERX
  7514         MOVE '1'                TO DTE-FICH.                     ELCDTERX
  7515                                                                  ELCDTERX
  7516     IF DD-PS-PIC (CLAS-INDEXEN) NOT LESS 'J'  AND                ELCDTERX
  7517        DD-PS-PIC (CLAS-INDEXEN) NOT GREATER 'R'                  ELCDTERX
  7518         MOVE '2'                TO DTE-FICH.                     ELCDTERX
  7519                                                                  ELCDTERX
  7520*    MOVE DD-PS-PIC (CLAS-INDEXEN) TO DTE-PGM-OPT.                ELCDTERX
  7521     GO TO 0005-READ--CARD.                                       ELCDTERX
  7522                                                                  ELCDTERX
  7523 0040-READ--CLAI.                                                 ELCDTERX
  7524     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  7525     IF CLAS-INDEX GREATER 2  OR                                  ELCDTERX
  7526        DD-TYPE (CLAS-INDEX) = SPACE                              ELCDTERX
  7527         GO TO 0005-READ--CARD.                                   ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 147
* ECS010T1.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  7528                                                                  ELCDTERX
  7529     ADD 1                       TO CLAS-INDEXA.                  ELCDTERX
  7530     MOVE DD-TYPE (CLAS-INDEX) TO CLAS-ALL-TYPES (CLAS-INDEXA).   ELCDTERX
  7531     GO TO 0040-READ--CLAI.                                       ELCDTERX
  7532                                                                  ELCDTERX
  7533 0045-READ--DUMP.                                                 ELCDTERX
  7534     MOVE +999 TO WS-RETURN-CODE                                  ELCDTERX
  7535     MOVE 'MISSING AND/OR INVALID CLAS DATE CARD'                 ELCDTERX
  7536                                 TO  WS-ABEND-MESSAGE             ELCDTERX
  7537     PERFORM ABEND-PGM.                                           ELCDTERX
  7538                                                                  ELCDTERX
  7539 0050-READ--POXX.                                                 ELCDTERX
  7540     IF DD-IDX NOT = CLAS-CO                                      ELCDTERX
  7541         GO TO 0005-READ--CARD.                                   ELCDTERX
  7542                                                                  ELCDTERX
  7543     IF DD-PS-PRC (CLAS-INDEXON) = 'X'                            ELCDTERX
  7544         DISPLAY '***********************************************'ELCDTERX
  7545         DISPLAY 'ECS - ', PGM-SUB, ' IS NOT SCHEDULED TO RUN'    ELCDTERX
  7546         DISPLAY '***********************************************'ELCDTERX
  7547         GO TO 0055-READ--STOP.                                   ELCDTERX
  7548                                                                  ELCDTERX
  7549     MOVE DD-PS-PRT (CLAS-INDEXON) TO DTE-PRT-OPT.                ELCDTERX
  7550     MOVE DD-PS-FMT (CLAS-INDEXON) TO DTE-FMT-OPT.                ELCDTERX
  7551     MOVE DD-PS-PRC (CLAS-INDEXON) TO DTE-PRC-OPT DTE-PGM-OPT.    ELCDTERX
  7552     MOVE DD-PS-TOT (CLAS-INDEXON) TO DTE-TOT-OPT.                ELCDTERX
  7553                                                                  ELCDTERX
  7554     IF DTE-PRT-OPT = 'B'                                         ELCDTERX
  7555         MOVE '2'                  TO DTE-FICH.                   ELCDTERX
  7556     IF DTE-PRT-OPT = 'F'                                         ELCDTERX
  7557         MOVE '1'                  TO DTE-FICH.                   ELCDTERX
  7558                                                                  ELCDTERX
  7559     GO TO 0005-READ--CARD.                                       ELCDTERX
  7560                                                                  ELCDTERX
  7561 0055-READ--STOP.                                                 ELCDTERX
  7562     GOBACK.                                                      ELCDTERX
  7563                                                                  ELCDTERX
  7564 0060-READ--TEST.                                                 ELCDTERX
  7565     IF DATX-COD        = SPACE  OR                               ELCDTERX
  7566        CLAX-ID         = SPACE  OR                               ELCDTERX
  7567        DATE-OPTIONS-ID = SPACE                                   ELCDTERX
  7568         GO TO 0045-READ--DUMP.                                   ELCDTERX
  7569                                                                  ELCDTERX
  7570     MOVE LOW-VALUE TO CLAS-TYPE-MISC.                            ELCDTERX
  7571     GO TO 0079-READ--EXIT.                                       ELCDTERX
  7572                                                                  ELCDTERX
  7573 0065-READ--COLC.                                                 ELCDTERX
  7574     MOVE DATE-DISK              TO CLASIC-SYSTEM-CODES.          ELCDTERX
  7575     GO TO 0005-READ--CARD.                                       ELCDTERX
  7576                                                                  ELCDTERX
  7577 0070-READ--OPCA.                                                 ELCDTERX
  7578                                                                  ELCDTERX
  7579     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  7580                                                                  ELCDTERX
  7581     IF  CLAS-INDEX GREATER 13                                    ELCDTERX
  7582             OR                                                   ELCDTERX
  7583         DD-CARR-FLDS (CLAS-INDEX) = SPACE                        ELCDTERX
  7584         GO TO 0005-READ--CARD.                                   ELCDTERX
  7585                                                                  ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 148
* ECS010T1.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  7586     ADD 1                       TO INDEXCA.                      ELCDTERX
  7587     MOVE DD-CARR-FLDS (CLAS-INDEX)                               ELCDTERX
  7588                                 TO CARRIER-FLDS (INDEXCA).       ELCDTERX
  7589     GO TO 0070-READ--OPCA.                                       ELCDTERX
  7590                                                                  ELCDTERX
  7591 0072-READ--OPST.                                                 ELCDTERX
  7592                                                                  ELCDTERX
  7593     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  7594                                                                  ELCDTERX
  7595     IF  CLAS-INDEX GREATER 16                                    ELCDTERX
  7596             OR                                                   ELCDTERX
  7597         DD-TLR (CLAS-INDEX) = SPACE                              ELCDTERX
  7598         GO TO 0005-READ--CARD.                                   ELCDTERX
  7599                                                                  ELCDTERX
  7600     ADD 1                       TO INDEXST.                      ELCDTERX
  7601     MOVE DD-STATE-FLDS (CLAS-INDEX)                              ELCDTERX
  7602                                 TO STATE-TLR-FLD (INDEXST).      ELCDTERX
  7603     GO TO 0072-READ--OPST.                                       ELCDTERX
  7604                                                                  ELCDTERX
  7605 0074-READ--OPBS.                                                 ELCDTERX
  7606                                                                  ELCDTERX
  7607     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  7608                                                                  ELCDTERX
  7609     IF  CLAS-INDEX GREATER 32                                    ELCDTERX
  7610             OR                                                   ELCDTERX
  7611         DD-TLR (CLAS-INDEX) = SPACE                              ELCDTERX
  7612         GO TO 0005-READ--CARD.                                   ELCDTERX
  7613                                                                  ELCDTERX
  7614     ADD 1                       TO INDEXBS.                      ELCDTERX
  7615     MOVE DD-TLR (CLAS-INDEX)    TO BUS-TLRM-FLD (INDEXBS).       ELCDTERX
  7616     GO TO 0074-READ--OPBS.                                       ELCDTERX
  7617                                                                  ELCDTERX
  7618 0079-READ--EXIT.                                                 ELCDTERX
  7619*    EXIT.                                                        ELCDTERX
  7620******************************************************************ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 149
* ECS010T1.cbl
  7622******************************************************************
  7623***           O P E N   F I L E S   R O U T I N E              ***
  7624******************************************************************
  7625
  7626     DISPLAY ' '.
  7627     DISPLAY '****** THE FOLLOWING MESSAGES WERE CREATED BY '
  7628         'ECS010 ******'
  7629     DISPLAY ' '.
  7630
  7631     MOVE FUNCTION CURRENT-DATE  TO FUNCTION-DATE
  7632     MOVE 'Y'                    TO DC-FORCE-EL310-DATE-SW
  7633     MOVE FUNCTION-DATE          TO DC-EL310-DATE
  7634     .
  7635 0080-OPEN-FILES.
  7636*    IF DTE-PGM-OPT = '1'
  7637*       open output detail-extr
  7638*    end-if
  7639     OPEN INPUT  PENDING-EXTRACT
  7640                 CERT-MASTER-IN
  7641                 ERACCTT-IN
  7642                 ERAGTC
  7643
  7644          I-O    ERMEBL-INOUT
  7645                 ELCRTT
  7646
  7647          OUTPUT SUMMARY-EXTR
  7648                 ME-ECS010-BALANCE
  7649                 ME50-ECS010-BALANCE
  7650                 DISPLAY-PRT
  7651                 MISMATCH-REPORT
  7652                 PRINT-COPY.
  7653
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 150
* ECS010T1.cbl
  7655*START*************CUSTOM CODE FOR CLIENT "DMD"*************
  7656     IF DTE-CLIENT NOT = 'DMD'
  7657         NEXT SENTENCE
  7658     ELSE
  7659         OPEN INPUT ERRESC-IN
  7660            IF ERRESC-FILE-STATUS   = '00' OR '97'
  7661                NEXT SENTENCE
  7662            ELSE
  7663                MOVE ERRESC-FILE-STATUS TO WS-ABEND-FILE-STATUS
  7664                MOVE 'ERROR OPENING ERRESC FILE'
  7665                                        TO WS-ABEND-MESSAGE
  7666                GO TO ABEND-PGM.
  7667*END***************CUSTOM CODE FOR CLIENT "DMD"*************
  7668
  7669     IF ERACCTT-FILE-STATUS  = '00'  OR  '97'
  7670         NEXT SENTENCE
  7671       ELSE
  7672         MOVE '11'                    TO ABEND-CODE-1
  7673         MOVE ERACCTT-FILE-STATUS     TO ABEND-CODE-2
  7674         MOVE WS-ABEND-CODE           TO WS-RETURN-CODE
  7675         GO TO ABEND-PGM.
  7676
  7677     IF ELCRTT-FILE-STATUS  = '00'  OR  '97'
  7678        CONTINUE
  7679     ELSE
  7680        DISPLAY ' OPEN ERROR ELCRTT '
  7681        MOVE '31'                TO ABEND-CODE-1
  7682        MOVE ELCRTT-FILE-STATUS  TO ABEND-CODE-2
  7683        MOVE WS-ABEND-CODE       TO WS-RETURN-CODE
  7684        GO TO ABEND-PGM
  7685     END-IF
  7686
  7687     IF ERAGTC-FILE-STATUS  = '00'  OR  '97'
  7688        CONTINUE
  7689     ELSE
  7690        DISPLAY ' OPEN ERROR ERAGTC '
  7691        MOVE '41'                TO ABEND-CODE-1
  7692        MOVE ERAGTC-FILE-STATUS  TO ABEND-CODE-2
  7693        MOVE WS-ABEND-CODE       TO WS-RETURN-CODE
  7694        GO TO ABEND-PGM
  7695     END-IF
  7696
  7697     IF ERMEBL-FILE-STATUS  = '00'  OR  '97'
  7698         NEXT SENTENCE
  7699       ELSE
  7700         MOVE 'N'                     TO ME-UPDATE-FLAG.
  7701
  7702     IF DTE-PGM-OPT = '1'
  7703         OPEN OUTPUT  CERT-MASTER-OUT
  7704                      DETAIL-EXTR
  7705     ELSE
  7706         MOVE HIGH-VALUES             TO PENDING-MATCH-CONTROL
  7707         MOVE '*'                     TO TRANS-EOF-FLAG.
  7708
  7709     MOVE 'R'                         TO CP-RATE-FILE.
  7710     MOVE 'O'                         TO CP-IO-FUNCTION.
  7711     PERFORM 8100-GET-RATE THRU 8199-GET-RATE-X.
  7712     IF IO-ERROR
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 151
* ECS010T1.cbl
  7713         MOVE 'ERROR OCCURED OPENING - ELRATE'
  7714                                      TO WS-ABEND-MESSAGE
  7715         MOVE 0302                    TO WS-RETURN-CODE
  7716         GO TO ABEND-PGM.
  7717
  7718******************************************************************
  7719***       I N I T I A L I Z A T I O N   R O U T I N E          ***
  7720******************************************************************
  7721
  7722 0090-INITIALIZATION-ROUTINE.
  7723
  7724     ACCEPT WS-TIME-OF-DAY   FROM TIME.
  7725     MOVE WS-TIME                     TO ME-START-TIME.
  7726     MOVE WS-CURRENT-DATE             TO ME-START-DATE
  7727                                         TR-RN-DT.
  7728     MOVE ME-START-MO                 TO ME-CNDS-MO.
  7729     MOVE ME-START-DA                 TO ME-CNDS-DA.
  7730     MOVE ME-START-YR                 TO ME-CNDS-YR.
  7731     COMPUTE MONTH-END-MOYR = (RUN-CCYY * 12) + RUN-MO.
  7732     MOVE COMPANY-NAME                TO TRHDNM.
  7733     MOVE ALPH-DATE                   TO TR-MODAYR.
  7734     MOVE RUN-DATE                    TO EOM-RUN-DATE.
  7735     MOVE BIN-RUN-DATE                TO BIN-EOM-RUN-DATE.
  7736
  7737     MOVE EOM-RUN-DATE                TO  LAST-YRS-DATE.
  7738     COMPUTE LYD-CCYY = LYD-CCYY - 1.
  7739     COMPUTE LYD-MO = LYD-MO - 1.
  7740     IF LYD-MO = ZERO
  7741         MOVE 12                      TO LYD-MO
  7742         COMPUTE LYD-CCYY = LYD-CCYY - 1.
  7743
  7744     MOVE BIN-EOM-RUN-DATE       TO BIN-VALUATION-DT.
  7745
  7746
  7747     IF DTE-CLIENT = 'CID'
  7748         MOVE 'CILGM15'          TO  WS-ME-BAL-JOB
  7749         MOVE 'CILGM15'          TO  WS-ME50-BAL-JOB
  7750     ELSE
  7751         MOVE 'CIDCLGM15'        TO  WS-ME-BAL-JOB
  7752         MOVE 'CIDCLGM15'        TO  WS-ME50-BAL-JOB
  7753     END-IF.
  7754
  7755     IF  NOT DTE-OPT-RESERVE-METHOD-AUTH
  7756         GO TO 0090-CONTINUE.
  7757
  7758     MOVE BIN-VALUATION-DT       TO DC-BIN-DATE-1.
  7759     MOVE -12                    TO DC-ELAPSED-MONTHS.
  7760     MOVE ZEROS                  TO DC-ELAPSED-DAYS.
  7761     MOVE '6'                    TO DC-OPTION-CODE.
  7762     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
  7763
  7764     IF  DC-ERROR-CODE NOT EQUAL SPACES
  7765         MOVE '**** WORK DATE CALC ERROR ****'
  7766                                 TO WS-ABEND-MESSAGE
  7767         MOVE '90'               TO ABEND-CODE-1
  7768         MOVE '0'                TO AC2-ONE
  7769         MOVE DC-ERROR-CODE      TO AC2-TWO
  7770         MOVE WS-ABEND-CODE      TO WS-RETURN-CODE
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 152
* ECS010T1.cbl
  7771         GO TO ABEND-PGM.
  7772
  7773     MOVE DC-BIN-DATE-2          TO  W-WORK-DATE.
  7774
  7775     MOVE DC-GREG-DATE-CYMD      TO  EOM-DATE (01).
  7776     MOVE EOM-RUN-DATE           TO  EOM-DATE (13).
  7777
  7778     PERFORM 0095-GET-EOM-DATES THRU 0095-EXIT
  7779             VARYING
  7780         SUBM FROM +2 BY +1
  7781             UNTIL
  7782         SUBM GREATER THAN +12.
  7783
  7784     DISPLAY 'END OF MONTH TABLE VALUES USED BY ECS010 - '.
  7785
  7786     PERFORM 0096-DISPLAY-EOM-DATES THRU 0096-EXIT
  7787             VARYING
  7788         SUBM FROM +1 BY +1
  7789             UNTIL
  7790         SUBM GREATER THAN +13.
  7791
  7792     MOVE BIN-VALUATION-DT       TO DC-BIN-DATE-1.
  7793*    MOVE -90                    TO DC-ELAPSED-DAYS.
  7794     MOVE ZEROS                  TO DC-ELAPSED-DAYS
  7795                                    DC-ELAPSED-MONTHS.
  7796     SUBTRACT COMPANY-IBNR-LAG-MONTH FROM DC-ELAPSED-MONTHS.
  7797     MOVE 1                      TO DC-END-OF-MONTH.
  7798     MOVE '6'                    TO DC-OPTION-CODE.
  7799     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
  7800
  7801     IF  DC-ERROR-CODE NOT EQUAL SPACES
  7802         MOVE '**** CUT OFF DATE ERROR ****'
  7803                                 TO WS-ABEND-MESSAGE
  7804         MOVE '90'               TO ABEND-CODE-1
  7805         MOVE '0'                TO AC2-ONE
  7806         MOVE DC-ERROR-CODE      TO AC2-TWO
  7807         MOVE WS-ABEND-CODE      TO WS-RETURN-CODE
  7808         GO TO ABEND-PGM.
  7809
  7810     MOVE DC-GREG-DATE-CYMD      TO W-CUTOFF-DATE.
  7811     DISPLAY ' CUT OFF DATE - '  W-CUTOFF-DATE.
  7812
  7813 0090-CONTINUE.
  7814
  7815     MOVE BIN-VALUATION-DT       TO DC-BIN-DATE-1.
  7816     MOVE -1                     TO DC-ELAPSED-MONTHS.
  7817     MOVE +0                     TO DC-ELAPSED-DAYS.
  7818     MOVE '6'                    TO DC-OPTION-CODE.
  7819     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
  7820
  7821     IF NO-CONVERSION-ERROR
  7822        MOVE DC-GREG-DATE-CYMD   TO OB-RUN-DATES (1).
  7823
  7824     MOVE DC-BIN-DATE-2          TO DC-BIN-DATE-1.
  7825     MOVE -1                     TO DC-ELAPSED-MONTHS.
  7826     MOVE +0                     TO DC-ELAPSED-DAYS.
  7827     MOVE '6'                    TO DC-OPTION-CODE.
  7828     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 153
* ECS010T1.cbl
  7829
  7830     IF NO-CONVERSION-ERROR
  7831        MOVE DC-GREG-DATE-CYMD   TO OB-RUN-DATES (2).
  7832
  7833     MOVE +0                     TO DC-ELAPSED-MONTHS
  7834                                    DC-ELAPSED-DAYS.
  7835
  7836     MOVE SPACES                 TO CERTIFICATE-RECORD.
  7837     MOVE 'CR'                   TO CR-RECORD-ID.
  7838     MOVE ZEROS                  TO
  7839               CR-AGE                  CR-JOINT-AGE
  7840               CR-LFTYP                CR-AHTYP
  7841               CR-LF-TERM              CR-AH-TERM
  7842               CR-LF-CRIT-PERIOD       CR-AH-CRIT-PERIOD
  7843               CR-LF-TERM-IN-DAYS
  7844               CR-LF-DEV-PCT           CR-AH-DEV-PCT
  7845               CR-LFAMT                CR-AHAMT
  7846               CR-LFPRM                CR-AHPRM
  7847               CR-LF-POLICY-FEE        CR-AH-POLICY-FEE
  7848               CR-LFPRM-CALC           CR-AHPRM-CALC
  7849               CR-LFPRM-RATE           CR-AHPRM-RATE
  7850               CR-LFAMT-ALT
  7851               CR-LFPRM-ALT            CR-ISS-MICROFILM-NO
*  12-S*********************************************************       (   0)**
**    Operand CR-ISS-MICROFILM-NO is not declared
  7852               CR-LFPRM-CALC-ALT       CR-NH-INT-ON-REF
  7853               CR-LFPRM-RATE-ALT
  7854               CR-LFRFND               CR-AHRFND
  7855               CR-LFRFND-CALC          CR-AHRFND-CALC
  7856               CR-LF-NSP-PRM           CR-AH-NSP-PRM
  7857               CR-LF-NSP-PRM-RATE      CR-AH-NSP-PRM-RATE
  7858               CR-LF-REI-RISK-PRM      CR-AH-REI-RISK-PRM
  7859               CR-LF-EXPIRE-DATE       CR-AH-EXPIRE-DATE
  7860               CR-LIVES                CR-APR
  7861               CR-BILLED
  7862               CR-LF-ISS-PREM-TAX      CR-AH-ISS-PREM-TAX
  7863               CR-LF-CNC-PREM-TAX      CR-AH-CNC-PREM-TAX
  7864               CR-PMT-FREQ             CR-LOAN-TERM
  7865               CR-SKIP                 CR-LOAN-1ST-PMT-DT
  7866               CR-SUM-CAN-CNT-ITD      CR-SUM-CAN-CNT-YTD
  7867               CR-PMT-EXTENSION-DAYS   CR-ENTRY-DATE
  7868               CR-LF-CANC-DT           CR-AH-CANC-DT
  7869               CR-LF-CANCEL-EXIT-DATE  CR-AH-CANCEL-EXIT-DATE
  7870               CR-LF-CLAIM-EXIT-DATE   CR-AH-SETTLEMENT-EXIT-DATE
  7871               CR-NUM-DTH-CLM          CR-NUM-DIS-CLM
  7872               CR-DTH-DT               CR-DIS-DT
  7873               CR-DTH-RPT-DT           CR-DIS-RPT-DT
  7874               CR-DTH-PAY-DT           CR-DIS-PAY-DT
  7875                                       CR-DIS-PTO-DT
  7876               CR-DTHAMT               CR-DISAMT
  7877               CR-DTHAMT-YTD           CR-DISAMT-YTD
  7878               CR-DTHAMT-LAST          CR-DISAMT-LAST
  7879               CR-DTHEXP               CR-DISEXP
  7880               CR-DTHEXP-YTD           CR-DISEXP-YTD
  7881               CR-DTH-AGE              CR-DAYS-DISAB
  7882               CR-DIS-INCUR-DT (1)     CR-CLAIM-DEDUCT-WITHHELD
  7883               CR-INCUR-DISAMT (1)     CR-CANCEL-DEDUCT-WITHHELD
  7884               CR-INCUR-DISEXP (1)     CR-REMIT-TO
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 154
* ECS010T1.cbl
  7885               CR-CANCEL-STATE-TAX     CR-CANCEL-MUNI-TAX
  7886               CR-MOB-NET-TOT-FEES
  7887               CR-ADDL-CLP.
  7888
  7889     MOVE CR-DISAB-DETAIL-DATA (1)  TO CR-DISAB-DETAIL-DATA (2)
  7890                                       CR-DISAB-DETAIL-DATA (3)
  7891                                       CR-DISAB-DETAIL-DATA (4)
  7892                                       CR-DISAB-DETAIL-DATA (5).
  7893
  7894     MOVE CERTIFICATE-RECORD     TO INITIALIZED-CERTIFICATE.
  7895
  7896     MOVE SPACES                 TO WS-BANK-COMMISSIONS
  7897     PERFORM VARYING IA FROM +1 BY +1 UNTIL
  7898        IA > +10
  7899        MOVE ZEROS               TO WS-BNK-SPP-FEES (IA)
  7900     END-PERFORM
  7901     MOVE WS-BANK-COMMISSIONS    TO WS-BANK-INIT
  7902
  7903     MOVE LOW-VALUES   TO ACCOUNT-MASTER   CERTIFICATE-RECORD.
  7904
  7905     MOVE HIGH-VALUES  TO REIN-HOLD-AREAS  RC-REIN-HOLD-AREAS
  7906                          EPEC-TOTALS      EPEC-SUBS
  7907                          EPEC-UNDERWRITTEN-TOTALS.
  7908
  7909     MOVE ZEROS        TO EPEC-LEVELS-END  EPEC-SUBS-END
  7910                          EPEC-LEVELS-END-II.
  7911     MOVE SPACES       TO REIN-LEVELS-END  RC-REIN-LEVELS-END
  7912                          DUPE-CERT-TABLE.
  7913
  7914     PERFORM CLEAR-REIN-HOLD        THRU CLEAR-REIN-HOLD-X.
  7915     PERFORM 4550-CLEAR-EPEC-TOTALS THRU 4589-CLEAR-EPEC-TOTALS-X.
  7916     PERFORM 5900-CLEAR-TOTAL-PAGES THRU 5999-CLEAR-TOTAL-PAGES-X
  7917                VARYING SUB6 FROM 1 BY 1 UNTIL SUB6 GREATER 6.
  7918     PERFORM 7900-CLEAR-BILLING-TABLE THRU 7999-CLEAR-BILLING-X
  7919                VARYING B-SUB FROM 1 BY 1 UNTIL B-SUB GREATER 50.
  7920
  7921     IF RUN-DATE NOT = EP-DT
  7922         MOVE '*'                     TO TR-YRASK.
  7923     MOVE LIFE-OVERRIDE-L6            TO TR-7-LF.
  7924     MOVE LIFE-OVERRIDE-L2            TO DET-LF-DESC.
  7925     MOVE AH-OVERRIDE-L6              TO TR-7-AH.
  7926     MOVE AH-OVERRIDE-L2              TO DET-AH-DESC.
  7927
  7928     IF DTE-CLIENT = 'FIA' OR 'TAO' OR 'PEK'
  7929         MOVE +1000                   TO DUP-MAX.
  7930
  7931     MOVE DTE-CLIENT                  TO ME-COMPANY.
  7932     MOVE MONTH-END-MOYR              TO ME-MOYR.
  7933     IF ME-DO-UPDATE
  7934         READ ERMEBL-INOUT INVALID KEY
  7935                       CLOSE ERMEBL-INOUT
  7936                       MOVE 'N'       TO ME-UPDATE-FLAG.
  7937
  7938     GO TO 0150-READ-ACCOUNT-MASTER.
  7939
  7940 0090-EXIT.
  7941     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 155
* ECS010T1.cbl
  7943 0095-GET-EOM-DATES.
  7944
  7945     MOVE W-WORK-DATE            TO DC-BIN-DATE-1.
  7946     MOVE '6'                    TO DC-OPTION-CODE.
  7947     MOVE 1                      TO DC-ELAPSED-MONTHS
  7948                                    DC-END-OF-MONTH.
  7949     MOVE ZEROS                  TO DC-ELAPSED-DAYS.
  7950     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
  7951
  7952     IF  DC-ERROR-CODE NOT EQUAL SPACES
  7953         MOVE '**** EOM PLUS 1 DATE CALC ERROR ****'
  7954                                 TO WS-ABEND-MESSAGE
  7955         MOVE '90'               TO ABEND-CODE-1
  7956         MOVE '0'                TO AC2-ONE
  7957         MOVE DC-ERROR-CODE      TO AC2-TWO
  7958         MOVE WS-ABEND-CODE      TO WS-RETURN-CODE
  7959         GO TO ABEND-PGM.
  7960
  7961     MOVE DC-BIN-DATE-2          TO  W-WORK-DATE
  7962                                     DC-BIN-DATE-1.
  7963     MOVE SPACES                 TO  DC-BIN-DATE-2.
  7964     MOVE ' '                    TO  DC-OPTION-CODE.
  7965     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
  7966
  7967     IF  DC-ERROR-CODE NOT EQUAL SPACES
  7968         MOVE '**** YMD EOM DATE CALC ERROR ****'
  7969                                 TO WS-ABEND-MESSAGE
  7970         MOVE '90'               TO ABEND-CODE-1
  7971         MOVE '0'                TO AC2-ONE
  7972         MOVE DC-ERROR-CODE      TO AC2-TWO
  7973         MOVE WS-ABEND-CODE      TO WS-RETURN-CODE
  7974         GO TO ABEND-PGM.
  7975
  7976     MOVE DC-GREG-DATE-CYMD      TO  EOM-DATE (SUBM).
  7977
  7978 0095-EXIT.
  7979     EXIT.
  7980
  7981 0096-DISPLAY-EOM-DATES.
  7982
  7983     DISPLAY SUBM '. ' EOM-DATE (SUBM).
  7984
  7985 0096-EXIT.
  7986     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 156
* ECS010T1.cbl
  7988******************************************************************
  7989***    R E A D   A C C O U N T   M A S T E R   R O U T I N E   ***
  7990******************************************************************
  7991
  7992 0100-ACCT-MASTER-READ-ROUTINE.
  7993
  7994     IF EP-FLG = '1'
  7995        ADD +1                   TO BC-ACT-ACCTS
  7996        IF DTE-OPT-RESERVE-METHOD-AUTH
  7997           PERFORM 4700-CALC-OPT-IBNR
  7998                                 THRU 4700-EXIT
  7999        END-IF
  8000        PERFORM 4500-BUILD-EPEC-EXTRACT
  8001                                 THRU 4599-BUILD-EPEC-EXTRACT-X
  8002     END-IF
  8003
  8004     IF TRANSACTION-WAS-PROCESSED
  8005         MOVE '1'                     TO ACCT-FLG
  8006                                         STATE-FLG
  8007                                         COMP-FLG
  8008                                         CARR-FLG
  8009                                         FINAL-FLG.
  8010
  8011 0150-READ-ACCOUNT-MASTER.
  8012
  8013     READ ERACCTT-IN AT END
  8014         GO TO 9930-EOJ-3.
  8015
  8016     ADD +1                            TO ERACCTT-READS.
  8017
* 8018     COPY ELCACCTI.
  8019******************************************************************04/14/98
  8020*                                                                *ELCACCTI
  8021*                            ELCACCTI                            *   LV003
  8022*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
  8023*                            VMOD=2.001                          *ELCACCTI
  8024*                                                                *ELCACCTI
  8025*   COPY FILE VARIABLES TO WORKING STORAGE                       *ELCACCTI
  8026*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCACCTI
  8027*                                                                *ELCACCTI
  8028*  NO  CID  MODS  IN  COPYBOOK  ELCACCTI                         *ELCACCTI
  8029*                                                                *ELCACCTI
  8030******************************************************************ELCACCTI
  8031     MOVE AM-EXPIRE-DT           TO  WS-AM-EXPIRE-DT-N.              CL**2
  8032     MOVE AM-VG-EXP-DATE         TO  WS-AM-VG-EXP-DATE-N.            CL**2
  8033     MOVE AM-EFFECT-DT           TO  WS-AM-EFFECT-DT-N.              CL**2
  8034     MOVE AM-PREV-EXP-DT         TO  WS-AM-PREV-EXP-DT-N.            CL**2
  8035     MOVE AM-PREV-EFF-DT         TO  WS-AM-PREV-EFF-DT-N             CL**2
  8036     MOVE AM-ANNIVERSARY-DATE    TO  WS-AM-ANNIVERSARY-DATE-N.       CL**2
  8037     MOVE AM-HI-CERT-DATE        TO  WS-AM-HI-CERT-DATE-N.           CL**2
  8038     MOVE AM-LO-CERT-DATE        TO  WS-AM-LO-CERT-DATE-N.           CL**2
  8039     MOVE AM-ENTRY-DATE          TO  WS-AM-ENTRY-DATE-N.             CL**2
  8040
  8041     IF FIRST-ACCOUNT EQUAL +1
  8042        MOVE +0                  TO FIRST-ACCOUNT
  8043        GO TO 0190-PROCESS-NEW-ACCOUNT.
  8044
  8045     IF AM-CARRIER NOT = HLD-CARRIER
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 157
* ECS010T1.cbl
  8046         PERFORM 5400-CARR-BREAK THRU 5499-CARR-BREAK-X
  8047     ELSE
  8048     IF AM-GROUPING NOT = HLD-GROUPING
  8049         PERFORM 5300-COMP-BREAK THRU 5399-COMP-BREAK-X
  8050     ELSE
  8051     IF AM-STATE NOT = HLD-STATE
  8052         PERFORM 5200-STATE-BREAK THRU 5299-STATE-BREAK-X
  8053     ELSE
  8054     IF AM-ACCOUNT NOT = HLD-ACCT
  8055         PERFORM 5100-ACCOUNT-BREAK THRU 5199-ACCOUNT-BREAK-X
  8056     ELSE
  8057     PERFORM 5000-DATE-RANGE-BREAK THRU 5099-DATE-RANGE-BREAK-X.
  8058
  8059     IF (AM-CARRIER NOT = HLD-CARRIER) OR
  8060        (AM-GROUPING NOT = HLD-GROUPING)
  8061         PERFORM 7000-CLIENT-BILLING-ROUTINE THRU 7099-BILL-X.
  8062
  8063 0190-PROCESS-NEW-ACCOUNT.
  8064
  8065     IF AM-CARRIER NOT = HLD-CARRIER
  8066         PERFORM 0199A-CARRIER-TABLE-LOOKUP THRU 0199A-LOOKUP-XIT.
  8067
  8068     MOVE AM-CONTROL-A          TO HLD-CONTROL.
  8069     MOVE AM-CARRIER            TO TR-CARR.
  8070     MOVE AM-GROUPING           TO TR-GROUP.
  8071     MOVE AM-ACCOUNT            TO TR-AG-NO.
  8072     MOVE AM-NAME               TO TR-AGCY.
  8073     MOVE AM-EFF-MO             TO TR-CE-MO.
  8074     MOVE AM-EFF-DA             TO TR-CE-DA.
  8075     MOVE AM-EFF-YR             TO TR-CE-YR.
  8076     MOVE AM-STATE              TO TR-ST-NO.
  8077     IF AM-EXPIRE-DT =  99999999999
  8078         MOVE 'CURRENT '        TO TR-CX
  8079     ELSE
  8080         MOVE AM-EXP-MO         TO TR-CX-MO
  8081         MOVE AM-EXP-DA         TO TR-CX-DA
  8082         MOVE AM-EXP-YR         TO TR-CX-YR
  8083         MOVE '-'               TO HSHR1  HSHR2.
  8084
  8085     ADD +1 TO BC-ACCTS.
  8086
  8087     IF AM-RECORD-ID = '**'
  8088         ADD +1 TO BC-NEW-ACCTS.
  8089     IF AM-RET-Y-N = 'Y' OR 'I' OR 'G' OR 'L' OR 'D'
  8090         ADD +1 TO BC-ER-ACCTS.
  8091
  8092     MOVE ZEROS                 TO SV-LO-CERT
  8093                                   SV-HI-CERT.
  8094     MOVE SPACE                 TO TRANSACTION-FLAG
  8095                                   LST-TRD-CERT
  8096                                   LST-TRD-ISDT
  8097                                   OB-DATE-1-SWITCH
  8098                                   OB-DATE-2-SWITCH
  8099                                   OB-DATE-3-SWITCH.
  8100     MOVE +81                   TO LN-CNT.
  8101
  8102 0199-READ-ACCOUNT-X.
  8103     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 158
* ECS010T1.cbl
  8104
  8105 0199A-CARRIER-TABLE-LOOKUP.
  8106
  8107     PERFORM 0199B-SEARCH-CARRIER-TABLE
  8108            VARYING CLAS-INDEXCN FROM 1 BY 1
  8109         UNTIL AM-CARRIER = CARRIER-SUB (CLAS-INDEXCN)  OR
  8110               CLAS-INDEXCN GREATER CLAS-MAXCN.
  8111
  8112     IF CLAS-INDEXCN GREATER CLAS-MAXCN
  8113         DISPLAY 'CARRIER NOT IN CARRIER NAME TABLE: ' AM-CARRIER
  8114         MOVE '** CARRIER NOT IN CARRIER NAME TABLE **'
  8115                                 TO WS-ABEND-MESSAGE
  8116         MOVE 4004               TO WS-ABEND-CODE
  8117         MOVE WS-ABEND-CODE      TO WS-RETURN-CODE
  8118         GO TO ABEND-PGM.
  8119
  8120 0199A-LOOKUP-XIT.
  8121     EXIT.
  8122 0199B-SEARCH-CARRIER-TABLE.
  8123     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 159
* ECS010T1.cbl
  8125******************************************************************
  8126***       R E A D   C E R T   M A S T E R   R O U T I N E      ***
  8127******************************************************************
  8128
  8129 0200-CERT-MASTER-READ-ROUTINE.
  8130
  8131     IF EOF-ON-CERT
  8132         GO TO 0299-READ-CERT-X.
  8133
  8134     IF FIRST-CERT EQUAL +1
  8135        MOVE +0                  TO FIRST-CERT
  8136        GO TO 0250-READ-CERT-MASTER.
  8137
  8138     MOVE CERT-IN-RECORD             TO CERTIFICATE-RECORD.
  8139
  8140     PERFORM CERT-DATE-LOAD.
  8141
  8142     IF CR-IND-GRP = 'I'  OR  '1'
  8143         MOVE '1'                    TO CR-IND-GRP
  8144     ELSE
  8145         MOVE '2'                    TO CR-IND-GRP.
  8146
  8147     IF CR-LF-REI-RISK-PRM NOT NUMERIC
  8148         MOVE ZEROS                TO CR-LF-REI-RISK-PRM.
  8149     IF CR-AH-REI-RISK-PRM NOT NUMERIC
  8150         MOVE ZEROS                TO CR-AH-REI-RISK-PRM.
  8151
  8152************ TEMP CODE TO INITIALIZE RISK PREM FIELDS ************
  8153     IF DTE-CLIENT NOT = 'NSL'
  8154         MOVE ZEROS                TO CR-LF-REI-RISK-PRM
  8155                                      CR-AH-REI-RISK-PRM.
  8156******************************************************************
  8157
  8158     IF CR-CLAIM-DEDUCT-WITHHELD NOT NUMERIC
  8159         MOVE ZEROS                TO CR-CLAIM-DEDUCT-WITHHELD.
  8160     IF CR-CANCEL-DEDUCT-WITHHELD NOT NUMERIC
  8161         MOVE ZEROS                TO CR-CANCEL-DEDUCT-WITHHELD.
  8162
  8163     MOVE CR-STATE                   TO STATE-L.
  8164     PERFORM 8200-STATE-CODE-LOOKUP THRU 8299-STATE-LOOKUP-X.
  8165
  8166     IF CR-LFTYP NOT = ZERO
  8167         MOVE CR-LFTYP               TO CLAS-LOOK
  8168         PERFORM 8300-LIFE-TYPE-LOOKUP THRU 8399-LIFE-LOOKUP-X.
  8169
  8170     IF CR-AHTYP NOT = ZERO
  8171         MOVE CR-AHTYP               TO CLAS-LOOK
  8172         PERFORM 8400-A-H-TYPE-LOOKUP THRU 8499-A-H-LOOKUP-X.
  8173
  8174     MOVE CR-DT                  TO DC-GREG-DATE-CYMD
  8175     MOVE 'L'                    TO DC-OPTION-CODE
  8176     MOVE +0                     TO DC-ELAPSED-MONTHS
  8177                                    DC-ELAPSED-DAYS
  8178     PERFORM 8000-DATE-CONVERT-ROUTINE
  8179                                 THRU 8099-DATE-CONVERT-X
  8180     MOVE DC-BIN-DATE-1          TO WS-CR-BIN-DATE
  8181
  8182     IF (DTE-CLIENT = 'DCC')
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 160
* ECS010T1.cbl
  8183        AND (CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'G' OR 'L')
  8184        PERFORM 0395-GET-CERT-TRLRS
  8185                                 THRU 0395-EXIT
  8186     END-IF
  8187
  8188     IF RUN-MO NOT = 01
  8189         GO TO 0250-READ-CERT-MASTER.
  8190
  8191     MOVE ZERO                 TO CR-DTHAMT-YTD  CR-DISAMT-YTD
  8192                                  CR-DTHEXP-YTD  CR-DISEXP-YTD.
  8193
  8194     IF ((CR-LFTYP NOT = ZERO)  AND
  8195         (CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'Z'))  OR
  8196        ((CR-AHTYP NOT = ZERO)  AND
  8197         (CLAS-I-CALC-TYPE (CLAS-INDEXA) = 'Z'))
  8198           MOVE ZERO           TO CR-SUM-CAN-CNT-YTD.
  8199
  8200     .
  8201 0250-READ-CERT-MASTER.
  8202
  8203     READ CERT-MASTER-IN
  8204               AT END GO TO 9920-EOJ-2.
  8205
  8206     ADD +1 TO CMIN-CNT.
  8207
  8208*     DISPLAY ' READ CERT ' CIR-CONTROL
  8209     IF CIR-CONTROL LESS THAN PRIOR-CERT-IN-CNTRL
  8210         DISPLAY 'SEQUENCE ERROR ON CERT MASTER'
  8211         DISPLAY 'FIRST  - '  PRIOR-CERT-IN-CNTRL
  8212         DISPLAY 'SECOND - '  CIR-CONTROL
  8213         MOVE 0612                    TO WS-ABEND-CODE
  8214         MOVE WS-ABEND-CODE           TO WS-RETURN-CODE
  8215         GO TO ABEND-PGM.
  8216
  8217     IF CIR-CONTROL = PRIOR-CERT-IN-CNTRL
  8218         DISPLAY 'DUPLICATE CERT ON FILE'  PRIOR-CERT-IN-CNTRL
  8219         IF DTE-CLIENT EQUAL 'SEN'
  8220            GO TO 0250-READ-CERT-MASTER
  8221         ELSE
  8222            MOVE 'DUPLICATE CERT ON FILE'
  8223                                      TO WS-ABEND-MESSAGE
  8224            MOVE 0302                 TO WS-ABEND-CODE
  8225            MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
  8226            GO TO ABEND-PGM.
  8227
  8228******************************************************
  8229*   THIS LOGIC WAS ADDED TO ACCOMMODATE THE EXECUTION
  8230*   OF A "MID MONTH" BILLING REPORT (EL562) FOR
  8231*   COMMERCIAL FEDERAL BANK AND PEOPLES TRUST
  8232******************************************************
  8233     IF DTE-CLIENT = 'CID'
  8234        IF COMPANY-NAME = '      COMMERCIAL FEDERAL'
  8235           IF (CF-THIRD-AGENT  = '0000713100') OR
  8236              (CF-FOURTH-AGENT = '0000713100')
  8237              CONTINUE
  8238           ELSE
  8239              GO TO 0250-READ-CERT-MASTER
  8240           END-IF
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 161
* ECS010T1.cbl
  8241        ELSE
  8242           IF COMPANY-NAME = '        PEOPLES TRUST'
  8243              IF CI-ACCOUNT = '0000845800'
  8244                 CONTINUE
  8245              ELSE
  8246                 GO TO 0250-READ-CERT-MASTER
  8247              END-IF
  8248           ELSE
  8249              IF COMPANY-NAME = '        SUNFLOWER BANK'
  8250                 IF (CF-THIRD-AGENT  = '0000681700') OR
  8251                    (CF-FOURTH-AGENT = '0000681700')
  8252                    CONTINUE
  8253                 ELSE
  8254                    GO TO 0250-READ-CERT-MASTER
  8255                 END-IF
  8256              ELSE
  8257                 IF COMPANY-NAME = '      FIRST PREMIER BANK'
  8258                    IF CI-ACCOUNT = '0001107200'
  8259                       CONTINUE
  8260                    ELSE
  8261                       GO TO 0250-READ-CERT-MASTER
  8262                    END-IF
  8263                 END-IF
  8264              END-IF
  8265           END-IF
  8266        END-IF
  8267     END-IF
  8268
  8269******************************************************
  8270     MOVE CIR-CONTROL                 TO PRIOR-CERT-IN-CNTRL.
  8271
  8272 0299-READ-CERT-X.
  8273     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 162
* ECS010T1.cbl
  8275******************************************************************
  8276***     R E A D   P E N D I N G   F I L E   R O U T I N E      ***
  8277******************************************************************
  8278
  8279 0300-READ-PENDING-TRANSACTIONS.
  8280
  8281     READ PENDING-EXTRACT
  8282                   AT END GO TO 9910-EOJ-1.
  8283
  8284     MOVE SPACE                    TO PENDING-RECORD-TYPE.
  8285
  8286     IF NOT ED-PENDING-BUSINESS  AND
  8287        NOT ED-PENDING-CLAIMS  AND
  8288        NOT ED-CERT-CHANGES
  8289           DISPLAY 'INVALID EXTRACT TYPE INTO ECS010 - TYPE = '
  8290                                               ED-RECORD-TYPE
  8291           MOVE 0301                        TO WS-ABEND-CODE
  8292           MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
  8293           GO TO ABEND-PGM.
  8294
  8295     PERFORM 0310-SET-UP-MATCHING-KEY THRU 0310-EXIT.
  8296
  8297     IF DTE-CLIENT = 'NCL'
  8298         IF PEND-MATCH-EFF-DTE LESS THAN 19400101
  8299             DISPLAY 'TRANS DROPPED: ' PENDING-MATCH-CONTROL
  8300                     '  TRANS TYPE: ' PENDING-RECORD-TYPE
  8301             GO TO 0300-READ-PENDING-TRANSACTIONS.
  8302
  8303     IF PENDING-MATCH-CONTROL  LESS THAN  PRIOR-MATCH-CNTRL
  8304         DISPLAY 'SEQUENCE ERROR ON TRANSACTION FILE'
  8305         DISPLAY ' PRIOR SEQ.   = '  PRIOR-MATCH-CNTRL
  8306         DISPLAY ' CURRENT SEQ. = '  PENDING-MATCH-CONTROL
  8307         MOVE 0603                    TO WS-ABEND-CODE
  8308         MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
  8309         GO TO ABEND-PGM.
  8310
  8311     ADD +1 TO TR-CNT.
  8312
  8313     IF ISSUE-TRANSACTION   OR
  8314        CANCEL-TRANSACTION  OR
  8315        CLAIM-TRANSACTION   OR
  8316        RESERVE-TRANSACTION OR
  8317        UPDATE-TRANSACTION
  8318         MOVE PENDING-MATCH-CONTROL   TO PRIOR-MATCH-CNTRL
  8319         GO TO 0330-MATCH-PENDING-TO-CERT.
  8320
  8321     DISPLAY 'INVALID TRANSACTION INTO ECS010 '.
  8322
  8323     DISPLAY 'INVALID TRANSACTION INTO ECS010 '.
  8324     DISPLAY '  MATCH CONTROL: ' PENDING-MATCH-CONTROL ' TYPE: ('
  8325             PENDING-RECORD-TYPE ')'.
  8326
  8327     MOVE 0301                   TO WS-ABEND-CODE.
  8328     MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
  8329     GO TO ABEND-PGM.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 163
* ECS010T1.cbl
  8331 0310-SET-UP-MATCHING-KEY.
  8332
  8333     IF ED-PENDING-BUSINESS
  8334         MOVE ED-DATA-AREAS      TO PENDING-BUSINESS
  8335         MOVE PB-CARRIER         TO PEND-MATCH-CARRIER
  8336         MOVE PB-GROUPING        TO PEND-MATCH-GROUPING
  8337         MOVE PB-STATE           TO PEND-MATCH-STATE
  8338         MOVE PB-ACCOUNT         TO PEND-MATCH-ACCOUNT
  8339         MOVE PB-CERT-EFF-DT     TO DC-BIN-DATE-1
  8340         MOVE PB-CERT-NO         TO PEND-MATCH-CERT-NO
  8341         MOVE PB-RECORD-TYPE     TO PENDING-RECORD-TYPE.
  8342
  8343     IF ED-PENDING-CLAIMS
  8344         ADD +1                  TO W-PENDING-CLMS
  8345         MOVE ED-DATA-AREAS      TO PENDING-CLAIMS
  8346         MOVE PC-CARRIER         TO PEND-MATCH-CARRIER
  8347         MOVE PC-GROUPING        TO PEND-MATCH-GROUPING
  8348         MOVE PC-STATE           TO PEND-MATCH-STATE
  8349         MOVE PC-ACCOUNT         TO PEND-MATCH-ACCOUNT
  8350         MOVE PC-CERT-EFF-DT     TO DC-BIN-DATE-1
  8351         MOVE PC-CERT-NO         TO PEND-MATCH-CERT-NO
  8352         IF PC-CLAIMS
  8353             MOVE '3'            TO PENDING-RECORD-TYPE
  8354         ELSE
  8355             IF PC-RESERVES
  8356                 MOVE '4'        TO PENDING-RECORD-TYPE.
  8357
  8358     IF ED-CERT-CHANGES
  8359         MOVE ED-DATA-AREAS      TO PENDING-MAINT-TO-CERT-FILE
  8360         MOVE CC-CARRIER         TO PEND-MATCH-CARRIER
  8361         MOVE CC-GROUPING        TO PEND-MATCH-GROUPING
  8362         MOVE CC-STATE           TO PEND-MATCH-STATE
  8363         MOVE CC-ACCOUNT         TO PEND-MATCH-ACCOUNT
  8364         MOVE CC-CERT-EFF-DT     TO DC-BIN-DATE-1
  8365         MOVE CC-CERT-NO         TO PEND-MATCH-CERT-NO
  8366         MOVE '5'                TO PENDING-RECORD-TYPE.
  8367
  8368     MOVE ' '                    TO DC-OPTION-CODE.
  8369     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
  8370     MOVE DC-GREG-DATE-CYMD      TO PEND-MATCH-EFF-DTE.
  8371
  8372 0310-EXIT.
  8373     EXIT.
  8374
  8375******************************************************************
  8376***    M A T C H   P E N D I N G   F I L E   T O   C E R T     ***
  8377******************************************************************
  8378
  8379 0330-MATCH-PENDING-TO-CERT.
  8380
  8381     IF PENDING-MATCH-CONTROL  LESS THAN  CR-FULL-CONTROL
  8382         GO TO 0390-CERT-MISMATCH-ERROR.
  8383
  8384     IF PENDING-MATCH-CONTROL  EQUAL   CR-FULL-CONTROL
  8385*       DISPLAY ' EQUAL PEND ' PENDING-MATCH-CONTROL
  8386       IF CLAIM-TRANSACTION
  8387*         DISPLAY ' CLAIM '
  8388         IF NOT PC-CHARGEBLE-EXPENSE  AND
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 164
* ECS010T1.cbl
  8389            NOT PC-NON-CHARGEBLE-EXPENSE
  8390             IF ((PC-CLAIM-TYPE = '1' OR '3') AND CR-LFTYP = '00')
  8391                                      OR
  8392                ((PC-CLAIM-TYPE = '2' OR '4') AND CR-AHTYP = '00')
  8393                  GO TO 0390-CERT-MISMATCH-ERROR.
  8394
  8395     IF PENDING-MATCH-CONTROL  EQUAL   CR-FULL-CONTROL
  8396       IF RESERVE-TRANSACTION
  8397*         DISPLAY ' RESV '
  8398         IF ((PC-CLAIM-TYPE = '1' OR '3') AND CR-LFTYP = '00')
  8399                                  OR
  8400            ((PC-CLAIM-TYPE = '2' OR '4') AND CR-AHTYP = '00')
  8401              GO TO 0390-CERT-MISMATCH-ERROR.
  8402
  8403     IF PENDING-MATCH-CONTROL  EQUAL   CR-FULL-CONTROL
  8404         IF ISSUE-TRANSACTION
  8405*           DISPLAY ' ISSUE '
  8406             GO TO 0380-DUPLICATE-CERT-ERROR
  8407         ELSE
  8408             GO TO 0350-MATCH-PENDING-TO-ACCOUNT.
  8409
  8410     IF PENDING-MATCH-CONTROL  NOT LESS THAN  CIR-CONTROL
  8411         PERFORM 0400-WRITE-CERT-RECORD THRU 0499-WRITE-CERT-X
  8412         PERFORM 0200-CERT-MASTER-READ-ROUTINE THRU
  8413                                               0299-READ-CERT-X
  8414         GO TO 0330-MATCH-PENDING-TO-CERT.
  8415
  8416     IF ISSUE-TRANSACTION
  8417         PERFORM 0400-WRITE-CERT-RECORD THRU 0499-WRITE-CERT-X
  8418     ELSE
  8419         GO TO 0390-CERT-MISMATCH-ERROR.
  8420
  8421 0350-MATCH-PENDING-TO-ACCOUNT.
  8422
  8423     IF PENDING-ACCOUNT-CONTROL LESS THAN AM-CONTROL-A
  8424       ADD +1  TO ERROR-COUNT
  8425         MOVE    '*** MISMATCH BETWEEN PENDING TRAN AND ACCOUNT'
  8426           TO  DL-FULL
  8427             PERFORM 8600-DISPLAY-PRT  THRU  8600-DISPLAY-EXIT
  8428         MOVE    ' PENDING CONTROL = '
  8429           TO  DIS-LINE-REASON
  8430         MOVE  PENDING-MATCH-CONTROL
  8431           TO  DIS-LINE-REC
  8432             PERFORM 8600-DISPLAY-PRT  THRU  8600-DISPLAY-EXIT
  8433         MOVE    ' KEY OF PENDING REC BYPASSED - '
  8434           TO  DIS-LINE-REASON
  8435         MOVE  PENDING-MATCH-CONTROL
  8436           TO  DIS-LINE-REC
  8437             PERFORM 8600-DISPLAY-PRT  THRU  8600-DISPLAY-EXIT
  8438         MOVE  SPACES
  8439           TO  DISPLAY-LINE
  8440             PERFORM 8600-DISPLAY-PRT  THRU  8600-DISPLAY-EXIT
  8442         DISPLAY '*** MISMATCH BETWEEN PENDING TRAN AND ACCOUNT'
  8443         DISPLAY '    PENDING CONTROL = ' PENDING-MATCH-CONTROL
  8444         DISPLAY 'PENDING REC BYPASSED - ' PENDING-MATCH-CONTROL
  8445         DISPLAY 'TRAN TYPE =   '  PENDING-RECORD-TYPE
  8446         DISPLAY '  TYPE  1=ISS   2=CAN   3=CLM   4=RSV   5=CHG'
  8447         DISPLAY '    ACCOUNT CONTROL = '
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 165
* ECS010T1.cbl
  8448         AM-MSTR-CNTRL AM-EFFECT-DT
  8449         IF DTE-CLIENT = 'UAL'  OR  'NCL' OR 'CID'
  8450            DISPLAY 'TRANS BYPASSED.... CLIENT = ' DTE-CLIENT
  8451            GO TO 0300-READ-PENDING-TRANSACTIONS
  8452         ELSE
  8453            MOVE 'MISMATCH BETWEEN PENDING TRAN AND ACCOUNT'
  8454                                      TO WS-ABEND-MESSAGE
  8455            MOVE 0302 TO WS-ABEND-CODE
  8456            MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
  8457            GO TO ABEND-PGM.
  8458
  8459     IF PENDING-ACCOUNT-CONTROL GREATER AM-CONTROL-A
  8460         PERFORM 0100-ACCT-MASTER-READ-ROUTINE THRU
  8461                                              0199-READ-ACCOUNT-X
  8462         GO TO 0350-MATCH-PENDING-TO-ACCOUNT.
  8463
  8464     IF PEND-MATCH-EFF-DTE NOT LESS THAN AM-EFFECT-DT  AND
  8465        PEND-MATCH-EFF-DTE LESS THAN AM-EXPIRE-DT
  8466         GO TO 0500-APPLY-PENDING-BUSINESS.
  8467
  8468     PERFORM 0100-ACCT-MASTER-READ-ROUTINE THRU
  8469                                       0199-READ-ACCOUNT-X.
  8470     GO TO 0350-MATCH-PENDING-TO-ACCOUNT.
  8471
  8472
  8473 0370-ACCOUNT-MISMATCH-ERROR.
  8474
  8475     DISPLAY 'MISMATCH ACCOUNT ERROR'
  8476     DISPLAY '    ACCOUNT CONTROL = ' AM-MSTR-CNTRL AM-EFFECT-DT.
  8477     MOVE 'MISMATCH ACCOUNT ERROR'
  8478                               TO WS-ABEND-MESSAGE.
  8479     MOVE 0302 TO WS-ABEND-CODE.
  8480         DISPLAY '******************************'
  8481         DISPLAY '***** ERROR LOCATION 009 *****'
  8482         DISPLAY '******************************'
  8483     MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
  8484     GO TO ABEND-PGM.
  8485
  8486
  8487 0380-DUPLICATE-CERT-ERROR.
  8488
  8489     IF PB-I-OB  OR  PB-I-SUMMARY
  8490         GO TO 0300-READ-PENDING-TRANSACTIONS.
  8491
  8492     ADD +1 TO DUP-CNT.
  8493
  8494     IF DUP-CNT NOT GREATER THAN DUP-MAX
  8495         MOVE CR-FULL-CONTROL           TO DUPE-ENTRY (DUP-CNT)
  8496         COMPUTE DUPE-LF-PRM (DUP-CNT) = PB-I-LF-PREMIUM-AMT +
  8497                                         PB-I-LF-ALT-PREMIUM-AMT
  8498         MOVE  PB-I-AH-PREMIUM-AMT      TO  DUPE-AH-PRM (DUP-CNT)
  8499         MOVE  PB-I-ENTRY-STATUS        TO  DUPE-STATUS (DUP-CNT)
  8500         GO TO 0300-READ-PENDING-TRANSACTIONS.
  8501
  8502     DISPLAY 'MORE THAN ' DUP-MAX ' DUPLICATE ISSUES PROCESSED'.
  8503     GO TO 0300-READ-PENDING-TRANSACTIONS.
  8504
  8505*    MOVE 0301 TO WS-ABEND-CODE.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 166
* ECS010T1.cbl
  8506*    MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
  8507*    GO TO ABEND-PGM.
  8508
  8509
  8510 0390-CERT-MISMATCH-ERROR.
  8511
  8512     IF ISSUE-TRANSACTION  OR
  8513        CANCEL-TRANSACTION  OR
  8514        CLAIM-TRANSACTION
  8515         ADD +1                  TO  MISMATCH-COUNT.
  8516
  8517     IF DTE-CLIENT  =  'CID'  OR  'CSO'
  8518       ADD  +1  TO  ERROR-COUNT
  8519         MOVE    '*** MISMATCH BETWEEN CERT AND TRANS'
  8520           TO  DL-FULL
  8521             PERFORM 8600-DISPLAY-PRT  THRU  8600-DISPLAY-EXIT
  8522         MOVE    ' TRANS CONTROL = '
  8523           TO  DIS-LINE-REASON
  8524         MOVE  PENDING-MATCH-CONTROL
  8525           TO  DIS-LINE-REC
  8526             PERFORM 8600-DISPLAY-PRT  THRU  8600-DISPLAY-EXIT
  8527         MOVE    ' TRANS TYPE    = '
  8528           TO  DIS-LINE-REASON
  8529         MOVE  PENDING-RECORD-TYPE
  8530           TO  DIS-LINE-REC
  8531             PERFORM 8600-DISPLAY-PRT  THRU  8600-DISPLAY-EXIT
  8532         MOVE '  TYPE: 1=ISS   2=CAN   3=CLM   4=RSV   5=CHG'
  8533           TO  DL-FULL
  8534             PERFORM 8600-DISPLAY-PRT  THRU  8600-DISPLAY-EXIT
  8535         MOVE    ' CERT IN CTL   = '
  8536           TO  DIS-LINE-REASON
  8537         MOVE  CIR-CONTROL
  8538           TO  DIS-LINE-REC
  8539             PERFORM 8600-DISPLAY-PRT  THRU  8600-DISPLAY-EXIT
  8540         MOVE    ' BYPASSED TRANS  = '
  8541           TO  DIS-LINE-REASON
  8542         MOVE  PENDING-MATCH-CONTROL
  8543           TO  DIS-LINE-REC
  8544             PERFORM 8600-DISPLAY-PRT  THRU  8600-DISPLAY-EXIT
  8545         MOVE  SPACES
  8546           TO  DISPLAY-LINE
  8547             PERFORM 8600-DISPLAY-PRT  THRU  8600-DISPLAY-EXIT
  8548         DISPLAY 'BYPASSED TRANS = ' PENDING-MATCH-CONTROL.
  8549
  8550     MOVE PENDING-MATCH-CONTROL  TO  DTL-MATCH-CONTROL.
  8551     MOVE PENDING-RECORD-TYPE    TO  DTL-REC-TYPE.
  8552
  8553     IF ISSUE-TRANSACTION
  8554         MOVE 'ISS'              TO  DTL-REC-TYPE-DESC
  8555     ELSE
  8556         IF CANCEL-TRANSACTION
  8557             MOVE 'CAN'          TO  DTL-REC-TYPE-DESC
  8558         ELSE
  8559             IF CLAIM-TRANSACTION
  8560                 MOVE 'CLM'      TO  DTL-REC-TYPE-DESC
  8561             ELSE
  8562                 IF RESERVE-TRANSACTION
  8563                     MOVE 'RES'  TO  DTL-REC-TYPE-DESC
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 167
* ECS010T1.cbl
  8564                 ELSE
  8565                     IF UPDATE-TRANSACTION
  8566                         MOVE 'CHG'
  8567                                 TO  DTL-REC-TYPE-DESC.
  8568
  8569     MOVE CIR-CONTROL            TO  DTL-CERT-IN-CONTROL.
  8570     MOVE CR-FULL-CONTROL        TO  DTL-CERT-OUT-CONTROL.
  8571     MOVE 'DROPPED'              TO  DTL-STATUS.
  8572
  8573     IF ISSUE-TRANSACTION
  8574         MOVE PB-I-LF-PREMIUM-AMT
  8575                                 TO  MD2-LF-PREM
  8576         MOVE PB-I-LF-ALT-PREMIUM-AMT
  8577                                 TO  MD2-LF-ALT-PREM
  8578         MOVE PB-I-AH-PREMIUM-AMT
  8579                                 TO  MD2-AH-PREM
  8580         ADD PB-I-LF-PREMIUM-AMT TO W-MM-LF-PRM
  8581         ADD PB-I-LF-ALT-PREMIUM-AMT TO W-MM-LF-PRM
  8582         ADD PB-I-AH-PREMIUM-AMT TO W-MM-AH-PRM
  8583     ELSE
  8584         IF CANCEL-TRANSACTION
  8585             MOVE PB-C-LF-CANCEL-AMT
  8586                                 TO  MD3-LF-REFUND
  8587             MOVE PB-C-AH-CANCEL-AMT
  8588                                 TO  MD3-AH-REFUND
  8589             ADD PB-C-LF-CANCEL-AMT TO W-MM-LF-RFD
  8590             ADD PB-C-AH-CANCEL-AMT TO W-MM-AH-RFD
  8591         ELSE
  8592             IF CLAIM-TRANSACTION
  8593                 IF PC-LF-CLAIM  OR  PC-OB-LF-CLAIM
  8594                     MOVE PC-CLAIM-PAYMENT  TO MD4-LF-CLAIM
  8595                     MOVE ZEROS             TO MD4-AH-CLAIM
  8596                     ADD PC-CLAIM-PAYMENT TO W-MM-LF-CLM
  8597                 ELSE
  8598                     MOVE ZEROS             TO MD4-LF-CLAIM
  8599                     MOVE PC-CLAIM-PAYMENT  TO MD4-AH-CLAIM
  8600                     ADD PC-CLAIM-PAYMENT TO W-MM-AH-CLM.
  8601
  8602     IF  MISMATCH-LINE-COUNT GREATER THAN +56
  8603         ADD +1                  TO  MISMATCH-PAGE-NUMBER
  8604         MOVE MISMATCH-PAGE-NUMBER
  8605                                 TO  TR-PG
  8606         MOVE MISMATCH-HEADING-1 TO  MISMATCH-RPT
  8607         MOVE MR-CTL             TO  X
  8608         MOVE X TO LCP-ASA
  8609         PERFORM LCP-WRITE-POS-MISMATCH-RPT
  8610             THRU LCP-WRITE-END-MISMATCH-RPT
  8611         MOVE TR-HD-2            TO  MISMATCH-RPT
  8612         MOVE MR-CTL             TO  X
  8613         MOVE X TO LCP-ASA
  8614         PERFORM LCP-WRITE-POS-MISMATCH-RPT
  8615             THRU LCP-WRITE-END-MISMATCH-RPT
  8616         MOVE TR-HD-3            TO  MISMATCH-RPT
  8617         MOVE MR-CTL             TO  X
  8618         MOVE X TO LCP-ASA
  8619         PERFORM LCP-WRITE-POS-MISMATCH-RPT
  8620             THRU LCP-WRITE-END-MISMATCH-RPT
  8621         MOVE MISMATCH-HEADING-2 TO  MISMATCH-RPT
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 168
* ECS010T1.cbl
  8622         MOVE MR-CTL             TO  X
  8623         MOVE X TO LCP-ASA
  8624         PERFORM LCP-WRITE-POS-MISMATCH-RPT
  8625             THRU LCP-WRITE-END-MISMATCH-RPT
  8626         MOVE +6                 TO  MISMATCH-LINE-COUNT.
  8627
  8628     MOVE MISMATCH-DETAIL        TO  MISMATCH-RPT.
  8629     MOVE MR-CTL                 TO  X.
  8630     ADD +2                      TO  MISMATCH-LINE-COUNT.
  8631
  8632     MOVE X TO LCP-ASA
  8633     PERFORM LCP-WRITE-POS-MISMATCH-RPT
  8634         THRU LCP-WRITE-END-MISMATCH-RPT.
  8635
  8636     IF ISSUE-TRANSACTION
  8637         MOVE MISMATCH-DETAIL-2  TO  MISMATCH-RPT
  8638         MOVE MR-CTL             TO  X
  8639         ADD +1                  TO  MISMATCH-LINE-COUNT
  8640         MOVE X TO LCP-ASA
  8641         PERFORM LCP-WRITE-POS-MISMATCH-RPT
  8642             THRU LCP-WRITE-END-MISMATCH-RPT.
  8643
  8644     IF CANCEL-TRANSACTION
  8645         MOVE MISMATCH-DETAIL-3  TO  MISMATCH-RPT
  8646         MOVE MR-CTL             TO  X
  8647         ADD +1                  TO  MISMATCH-LINE-COUNT
  8648         MOVE X TO LCP-ASA
  8649         PERFORM LCP-WRITE-POS-MISMATCH-RPT
  8650             THRU LCP-WRITE-END-MISMATCH-RPT.
  8651
  8652     IF CLAIM-TRANSACTION
  8653         MOVE MISMATCH-DETAIL-4  TO  MISMATCH-RPT
  8654         MOVE MR-CTL             TO  X
  8655         ADD +1                  TO  MISMATCH-LINE-COUNT
  8656         MOVE X TO LCP-ASA
  8657         PERFORM LCP-WRITE-POS-MISMATCH-RPT
  8658             THRU LCP-WRITE-END-MISMATCH-RPT.
  8659
  8660     MOVE SPACES                 TO  MISMATCH-RPT.
  8661
  8662     GO TO 0300-READ-PENDING-TRANSACTIONS.
  8663
  8664 0395-GET-CERT-TRLRS.
  8665
  8666     MOVE WS-BANK-INIT           TO WS-BANK-COMMISSIONS
  8667     MOVE DTE-CLASIC-COMPANY-CD  TO CS-COMPANY-CD
  8668     MOVE CR-CARRIER             TO CS-CARRIER
  8669     MOVE CR-GROUPING            TO CS-GROUPING
  8670     MOVE CR-STATE               TO CS-STATE
  8671     MOVE CR-ACCOUNT             TO CS-ACCOUNT
  8672     MOVE WS-CR-BIN-DATE         TO CS-CERT-EFF-DT
  8673     MOVE CR-CERT-NO             TO CS-CERT-NO
  8674     MOVE 'A'                    TO CS-TRAILER-TYPE
  8675
  8676     READ ELCRTT
  8677
  8678     IF ELCRTT-FILE-STATUS = '00'
  8679        MOVE CS-BANK-COMMISSION-AREA
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 169
* ECS010T1.cbl
  8680                                 TO WS-BANK-COMMISSIONS
  8681     ELSE
  8682        IF ELCRTT-FILE-STATUS NOT = '10' AND '23'
  8683           DISPLAY ' BAD READ    ELCRTT ' ELCRTT-FILE-STATUS
  8684           PERFORM ABEND-PGM
  8685        END-IF
  8686     END-IF
  8687
  8688     .
  8689 0395-EXIT.
  8690     EXIT.
  8691
  8692******************************************************************
  8693***       W R I T E   C E R T I F I C A T E   R E C O R D      ***
  8694******************************************************************
  8695
  8696 0400-WRITE-CERT-RECORD.
  8697*     DISPLAY ' MADE 400 WRITE ' CR-FULL-CONTROL
  8698
  8699     IF CERTIFICATE-RECORD = LOW-VALUES
  8700         GO TO 0499-WRITE-CERT-X.
  8701
  8702     IF CR-ACCT-CONTROL LESS THAN AM-CONTROL-A
  8703         DISPLAY '*** MISMATCH BETWEEN CERT MASTER AND ACCOUNT'
  8704         DISPLAY '    CERT. CONTROL = ' CR-FULL-CONTROL
  8705         ADD  +1  TO  ERROR-COUNT
  8706         MOVE    '*** CERT ACCT LESS THAN TRANS ACCT'
  8707           TO  DL-FULL
  8708             PERFORM 8600-DISPLAY-PRT  THRU  8600-DISPLAY-EXIT
  8709         MOVE    ' CERT. CONTROL = '
  8710           TO  DIS-LINE-REASON
  8711         MOVE  CR-FULL-CONTROL
  8712           TO  DIS-LINE-REC
  8713             PERFORM 8600-DISPLAY-PRT  THRU  8600-DISPLAY-EXIT
  8714         MOVE  SPACES
  8715           TO  DISPLAY-LINE
  8716             PERFORM 8600-DISPLAY-PRT  THRU  8600-DISPLAY-EXIT
  8717            WRITE CERT-OUT-RECORD FROM CERTIFICATE-RECORD
  8718            ADD +1 TO CMOT-CNT
  8719            PERFORM 0200-CERT-MASTER-READ-ROUTINE
  8720               GO TO 0400-WRITE-CERT-RECORD.
  8721
  8722*          GO TO 0370-ACCOUNT-MISMATCH-ERROR.
  8723
  8724     IF CR-ACCT-CONTROL GREATER THAN AM-CONTROL-A
  8725         PERFORM 0100-ACCT-MASTER-READ-ROUTINE THRU
  8726                                              0199-READ-ACCOUNT-X
  8727         GO TO 0400-WRITE-CERT-RECORD.
  8728
  8729     IF CR-DT LESS THAN AM-EFFECT-DT  OR
  8730        CR-DT NOT LESS THAN AM-EXPIRE-DT
  8731         PERFORM 0100-ACCT-MASTER-READ-ROUTINE THRU
  8732                                              0199-READ-ACCOUNT-X
  8733         GO TO 0400-WRITE-CERT-RECORD.
  8734
  8735*     DISPLAY ' BEFORE REIN '
  8736     PERFORM 3000-REINSURE-ROUTINE THRU 3099-REINSURE-ROUTINE-X.
  8737*     DISPLAY ' AFTER REIN '
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 170
* ECS010T1.cbl
  8738
  8739     IF CR-LFTYP = ZEROS  AND
  8740        CR-DTHEXP NOT = ZEROS
  8741         ADD +1                     TO W-LFTYP-99
  8742         MOVE '99'                  TO CR-LFTYP  CLAS-LOOK
  8743         PERFORM 8300-LIFE-TYPE-LOOKUP THRU 8399-LIFE-LOOKUP-X.
  8744
  8745     IF CR-AHTYP = ZEROS  AND
  8746        CR-DISEXP NOT = ZEROS
  8747         ADD +1                     TO W-AHTYP-99
  8748         MOVE '99'                  TO CR-AHTYP  CLAS-LOOK
  8749         PERFORM 8400-A-H-TYPE-LOOKUP THRU 8499-A-H-LOOKUP-X.
  8750
  8751*     DISPLAY ' BEFORE EP BUMP'
  8752     PERFORM 4000-EP-BUMP-RTN THRU 4099-EP-BUMP-RTN-X.
  8753*     DISPLAY ' AFTER EP BUMP'
  8754
  8755     IF CR-LFTYP = '99'
  8756         MOVE '00'                  TO CR-LFTYP.
  8757     IF CR-AHTYP = '99'
  8758         MOVE '00'                  TO CR-AHTYP.
  8759
  8760     IF CR-ISS-MICROFILM-NO NOT NUMERIC
*  12-S**************************                                      ( 153)**
**    Operand CR-ISS-MICROFILM-NO is not declared
  8761         MOVE ZEROS                 TO CR-ISS-MICROFILM-NO.
*  12-S*********************************************************       ( 170)**
**    Operand CR-ISS-MICROFILM-NO is not declared
  8762
  8763     IF CR-NH-INT-ON-REF NOT NUMERIC
  8764         MOVE ZEROS                 TO CR-NH-INT-ON-REF
  8765     END-IF
  8766
  8767     IF  CR-POLICY-IS-ACTIVE
  8768         ADD +1                  TO W-POLICY-ACTIVE-CTR
  8769         IF  CR-POLICY-IS-REISSUE
  8770             OR CR-POLICY-IS-MONTHLY
  8771             ADD +1              TO W-POLICY-REISSUE-CTR
  8772         ELSE
  8773             IF  CR-POLICY-IS-REIN-ONLY
  8774                 ADD +1          TO W-POLICY-REIN-CTR
  8775             ELSE
  8776                 NEXT SENTENCE
  8777     ELSE
  8778         ADD +1                  TO W-POLICY-INACTIVE-CTR.
  8779
  8780     IF DTE-PGM-OPT = '1'
  8781       IF REIN-IS-RISK-PREMIUM  AND
  8782          CR-ENTRY-DATE NOT = EOM-RUN-DATE
  8783         IF NOT CR-POLICY-IS-REISSUE  AND
  8784            NOT CR-POLICY-IS-DECLINED  AND
  8785            NOT CR-POLICY-IS-VOID
  8786            AND NOT CR-POLICY-IS-MONTHLY
  8787             MOVE '*'            TO RISK-PREM-FLAG
  8788             PERFORM 3100-REINSURE-ISSUE THRU
  8789                     3199-REINSURE-ISSUE-X.
  8790
* 8791     COPY ELCCRTM2.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 171
* ECS010T1.cbl (/apps/prod/cid1p/copy/ELCCRTM2)
  8792******************************************************************04/16/98
  8793*                                                                *ELCCRTM2
  8794*                                                                *ELCCRTM2
  8795*                            ELCCRTM2                            *   LV004
  8796*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
  8797*                            VMOD=2.001                          *ELCCRTM2
  8798*                                                                *ELCCRTM2
  8799*   COPY WORKING STORAGE TO FILE VARIABLES                       *ELCCRTM2
  8800*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCCRTM2
  8801*                                                                *ELCCRTM2
  8802******************************************************************ELCCRTM2
  8803     MOVE WS-CR-DT-N                 TO  CR-DT.                      CL**2
  8804     MOVE WS-CR-LF-EXPIRE-DATE-N     TO  CR-LF-EXPIRE-DATE.          CL**2
  8805     MOVE WS-CR-AH-EXPIRE-DATE-N     TO  CR-AH-EXPIRE-DATE.          CL**2
  8806     MOVE WS-CR-ENTRY-DATE-N         TO  CR-ENTRY-DATE.              CL**2
  8807     MOVE WS-CR-LF-CANC-DT-N         TO  CR-LF-CANC-DT.              CL**2
  8808     MOVE WS-CR-LF-CANCEL-EXIT-DATE-N TO                             CL**2
  8809                                     CR-LF-CANCEL-EXIT-DATE.         CL**2
  8810     MOVE WS-CR-LF-CLAIM-EXIT-DATE-N TO  CR-LF-CLAIM-EXIT-DATE.      CL**2
  8811     MOVE WS-CR-AH-CANC-DT-N         TO  CR-AH-CANC-DT.              CL**2
  8812     MOVE WS-CR-AH-CANCEL-EXIT-DATE-N TO CR-AH-CANCEL-EXIT-DATE.     CL**2
  8813     MOVE WS-CR-AH-SETTLEMENT-EXIT-DATEN TO                          CL**2
  8814                                  CR-AH-SETTLEMENT-EXIT-DATE.     ELCCRTM2
  8815     MOVE WS-CR-DTH-DT-N             TO  CR-DTH-DT.                  CL**2
  8816     MOVE WS-CR-DTH-PAY-DT-N         TO  CR-DTH-PAY-DT.              CL**2
  8817     MOVE WS-CR-DIS-DT-N             TO  CR-DIS-DT.                  CL**2
  8818     MOVE WS-CR-DIS-PAY-DT-N         TO  CR-DIS-PAY-DT.              CL**2
  8819     MOVE WS-CR-DIS-PTO-DT-N         TO  CR-DIS-PTO-DT.              CL**2
  8820                                                                     CL**4
  8821     PERFORM  VARYING COPY-NDX FROM 1 BY 1                           CL**4
  8822                UNTIL COPY-NDX > 5                                   CL**4
  8823           MOVE WS-CR-DIS-INCUR-DT-N (COPY-NDX)   TO                 CL**2
  8824                                  CR-DIS-INCUR-DT (COPY-NDX)      ELCCRTM2
  8825     END-PERFORM.                                                 ELCCRTM2
  8826                                                                  ELCCRTM2
  8827
  8828     IF DTE-PGM-OPT = '1'
  8829         WRITE CERT-OUT-RECORD FROM CERTIFICATE-RECORD
  8830         ADD +1 TO CMOT-CNT.
  8831
  8832     MOVE SPACE                  TO REIN-FLG
  8833                                    RISK-REIN-FLAG
  8834                                    RISK-PREM-FLAG
  8835                                    RC-COMM-FLG.
  8836
  8837 0499-WRITE-CERT-X.
  8838     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 172
* ECS010T1.cbl
  8840******************************************************************
  8841***     A P P L Y   P E N D I N G   T R A N S A C T I O N S    ***
  8842******************************************************************
  8843
  8844 0500-APPLY-PENDING-BUSINESS.
  8845
  8846     IF CANCEL-TRANSACTION
  8847*         DISPLAY ' CANCEL TRAN ' CIR-CONTROL
  8848         GO TO 0600-PROCESS-CANCELLATIONS.
  8849
  8850     IF CLAIM-TRANSACTION
  8851*        DISPLAY ' CLAIM TRAN ' CIR-CONTROL
  8852         GO TO 0700-PROCESS-CLAIMS.
  8853
  8854     IF RESERVE-TRANSACTION
  8855*        DISPLAY ' RESV TRAN ' CIR-CONTROL
  8856         GO TO 0800-PROCESS-RESERVES.
  8857
  8858     IF UPDATE-TRANSACTION
  8859*        DISPLAY ' UPD TRAN ' CIR-CONTROL
  8860         GO TO 0900-PROCESS-CERT-CHANGES.
  8861
  8862******************************************************************
  8863***     P R O C E S S   I S S U E   T R A N S A C T I O N S    ***
  8864******************************************************************
  8865
  8866 0505-PROCESS-ISSUES.
  8867
  8868     MOVE INITIALIZED-CERTIFICATE TO CERTIFICATE-RECORD.
  8869     PERFORM CERT-DATE-LOAD.
  8870
  8871     ADD +1                      TO  W-POL-ISSUES.
  8872
  8873     MOVE PB-COMPANY-CD          TO  CR-COMPANY-CD.
  8874     MOVE PB-CARRIER             TO  CR-CARRIER.
  8875     MOVE PB-GROUPING            TO  CR-GROUPING.
  8876     MOVE PB-STATE               TO  CR-STATE.
  8877     MOVE PB-ACCOUNT             TO  CR-ACCOUNT.
  8878     MOVE PB-CERT-EFF-DT         TO  DC-BIN-DATE-1
  8879                                     WS-CR-BIN-DATE
  8880     MOVE ' '                    TO  DC-OPTION-CODE.
  8881     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
  8882     MOVE DC-GREG-DATE-CYMD      TO  CR-DT
  8883                                     WS-CR-DT-N.
  8884     MOVE PB-CERT-NO             TO  CR-CERT-NO.
  8885
  8886*     DISPLAY ' PROC ISS ' CR-FULL-CONTROL
  8887     MOVE PB-I-NAME              TO  CR-NAME.
  8888     MOVE PB-I-AGE               TO  CR-AGE.
  8889     MOVE PB-I-INSURED-SEX       TO  CR-SEX.
  8890     MOVE PB-I-SOC-SEC-NO        TO  CR-SOC-SEC.
  8891
  8892     IF PB-I-JOINT-COVERAGE
  8893         MOVE PB-I-JOINT-INSURED TO  CR-JOINT-NAME
  8894         MOVE PB-I-JOINT-AGE     TO  CR-JOINT-AGE
  8895     ELSE
  8896        IF (DTE-CLIENT EQUAL 'BOA')  AND
  8897           (PB-I-JOINT-INSURED NOT EQUAL SPACES)
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 173
* ECS010T1.cbl
  8898             MOVE PB-I-JOINT-INSURED TO  CR-JOINT-NAME.
  8899
  8900     IF PB-I-SUMMARY  OR
  8901        DTE-CLIENT = 'DMD'
  8902         MOVE PB-I-LIVES         TO  CR-LIVES.
  8903
  8904     IF PB-I-NUM-BILLED NOT NUMERIC
  8905        MOVE ZEROS               TO PB-I-NUM-BILLED.
  8906
  8907     IF PB-I-STATE-TAX NOT NUMERIC
  8908        MOVE ZEROS               TO PB-I-STATE-TAX.
  8909
  8910     IF PB-I-MUNI-TAX NOT NUMERIC
  8911        MOVE ZEROS               TO PB-I-MUNI-TAX.
  8912     IF PB-I-TOT-FEES NOT NUMERIC
  8913        MOVE ZEROS               TO PB-I-TOT-FEES
  8914     END-IF
  8915     IF PB-I-ADDL-CLP NOT NUMERIC
  8916        MOVE ZEROS               TO PB-I-ADDL-CLP
  8917     END-IF
  8918
  8919     MOVE PB-I-TOT-FEES          TO  CR-MOB-NET-TOT-FEES
  8920     MOVE PB-I-ADDL-CLP          TO  CR-ADDL-CLP
  8921     MOVE PB-I-CLP-STATE         TO  CR-CLP-STATE
  8922     MOVE PB-I-NUM-BILLED        TO  CR-BILLED.
  8923     MOVE PB-I-STATE-TAX         TO  CR-STATE-TAX.
  8924     MOVE PB-I-RESIDENT-STATE    TO  CR-RESIDENT-STATE.
  8925     MOVE PB-I-RATE-CODE         TO  CR-RATE-CODE.
  8926     MOVE PB-I-MUNI-TAX          TO  CR-MUNI-TAX.
  8927     MOVE PB-I-LOAN-APR          TO  CR-APR.
  8928     MOVE PB-I-PAY-FREQUENCY     TO  CR-PMT-FREQ.
  8929     MOVE PB-I-LOAN-TERM         TO  CR-LOAN-TERM.
  8930
  8931     IF PB-I-RATE-CLASS-OVRD = SPACES
  8932         MOVE PB-I-RATE-CLASS    TO  CR-RATING-CLASS
  8933     ELSE
  8934         MOVE PB-I-RATE-CLASS-OVRD TO CR-RATING-CLASS.
  8935
  8936     MOVE PB-I-POLICY-FORM-NO    TO  CR-POLICY-FORM-NO.
  8937     MOVE PB-I-BUSINESS-TYPE     TO  CR-GRPTYP.
  8938
  8939     IF PB-I-INDV-GRP-OVRD = SPACES
  8940         MOVE PB-I-INDV-GRP-CD   TO  CR-IND-GRP
  8941     ELSE
  8942         MOVE PB-I-INDV-GRP-OVRD TO  CR-IND-GRP.
  8943
  8944     IF CR-IND-GRP = 'I'  OR  '1'
  8945         MOVE '1'                TO  CR-IND-GRP
  8946     ELSE
  8947         MOVE '2'                TO  CR-IND-GRP.
  8948
  8949     IF PB-I-SKIP-CODE = '1'
  8950         MOVE 01                 TO  CR-SKIP.
  8951     IF PB-I-SKIP-CODE = '2'
  8952         MOVE 02                 TO  CR-SKIP.
  8953     IF PB-I-SKIP-CODE = '3'
  8954         MOVE 03                 TO  CR-SKIP.
  8955     IF PB-I-SKIP-CODE = '4'
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 174
* ECS010T1.cbl
  8956         MOVE 04                 TO  CR-SKIP.
  8957     IF PB-I-SKIP-CODE = '5'
  8958         MOVE 05                 TO  CR-SKIP.
  8959     IF PB-I-SKIP-CODE = '6'
  8960         MOVE 06                 TO  CR-SKIP.
  8961     IF PB-I-SKIP-CODE = '7'
  8962         MOVE 07                 TO  CR-SKIP.
  8963     IF PB-I-SKIP-CODE = '8'
  8964         MOVE 08                 TO  CR-SKIP.
  8965     IF PB-I-SKIP-CODE = '9'
  8966         MOVE 09                 TO  CR-SKIP.
  8967     IF PB-I-SKIP-CODE = 'A'
  8968         MOVE 10                 TO  CR-SKIP.
  8969     IF PB-I-SKIP-CODE = 'X'
  8970         MOVE 11                 TO  CR-SKIP.
  8971
  8972     MOVE PB-I-MORT-CODE         TO  CR-MORT.
  8973     MOVE PB-I-MEMBER-NO         TO  CR-MEMBER-NO.
  8974     MOVE PB-I-LOAN-OFFICER      TO  CR-LOAN-OFFICER.
  8975
  8976     IF PB-I-SPECIAL-REIN-CODE NOT = SPACE
  8977         MOVE PB-I-SPECIAL-REIN-CODE TO CR-REIN-SPEC
  8978                                        REIN-SPEC-A
  8979                                        REIN-SPEC-B
  8980                                        REIN-SPEC-C
  8981         MOVE REIN-SPEC          TO CR-REIN-TABLE
  8982     ELSE
  8983         MOVE AM-REI-TABLE       TO CR-REIN-TABLE.
  8984
  8985     MOVE PB-I-1ST-PMT-DT        TO  DC-BIN-DATE-1.
  8986     MOVE ' '                    TO  DC-OPTION-CODE.
  8987     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
  8988     MOVE DC-GREG-DATE-1-YMD     TO  CR-LOAN-1ST-PMT-DT.
  8989
  8990     MOVE PB-I-EXTENTION-DAYS    TO  CR-PMT-EXTENSION-DAYS.
  8991
  8992     IF PB-I-LAST-ADD-ON-DT  =  ZEROS  OR  SPACES
  8993         MOVE LOW-VALUES          TO CR-LAST-ADD-ON-DT
  8994     ELSE
  8995         MOVE PB-I-LAST-ADD-ON-DT TO CR-LAST-ADD-ON-DT.
  8996
  8997     IF PB-I-UNDERWRITING-STATUS = 'A'  OR  'D'
  8998         MOVE 'Y'                TO  CR-UNDERWRITING-CODE.
  8999
  9000     IF PB-BATCH-ENTRY = SPACE  OR
  9001        (PB-I-ENTRY-STATUS = '2'  OR  'U')
  9002         MOVE '1'                TO  CR-ENTRY-STATUS
  9003     ELSE
  9004         MOVE PB-I-ENTRY-STATUS  TO  CR-ENTRY-STATUS.
  9005
  9006     IF PB-POLICY-IS-DECLINED
  9007         MOVE 'D'                TO  CR-ENTRY-STATUS.
  9008
  9009     IF PB-POLICY-IS-VOIDED
  9010         MOVE 'V'                TO  CR-ENTRY-STATUS.
  9011
  9012***  IF DTE-CLIENT NOT = 'CRI'
  9013***      IF PB-I-PREM-ACCTNG-ONLY
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 175
* ECS010T1.cbl
  9014***          MOVE '1'            TO  CR-ENTRY-STATUS.
  9015
  9016     MOVE EOM-RUN-DATE           TO  CR-ENTRY-DATE
  9017                                     WS-CR-ENTRY-DATE-N.
  9018
  9019     IF PB-I-MICROFILM-NO NUMERIC
*  12-S************************                                        ( 170)**
**    Operand PB-I-MICROFILM-NO is not declared
  9020         MOVE PB-I-MICROFILM-NO  TO CR-ISS-MICROFILM-NO.
*  12-S******************************                                  ( 175)**
**    Operand PB-I-MICROFILM-NO is not declared
  9021
  9022     IF DTE-CLIENT = 'TIH' OR 'FLA' OR 'TII' OR
  9023        'TMS' OR 'NCL' OR 'HER' OR 'CID' OR 'DCC'
  9024         MOVE PB-I-SIG-SW        TO CR-USER-CODE
  9025     END-IF
  9026
  9027*************************************************
  9028***  ADDED IN 06/93 WHEN CERTIFICATE-RECORD   ***
  9029***  WAS CONVERTED TO 1056 BYTES.             ***
  9030*************************************************
  9031     MOVE PB-ENTRY-BATCH         TO  CR-ENTRY-BATCH.
  9032     MOVE PB-I-BENEFICIARY-NAME  TO  CR-BENEFICIARY.
  9033
  9034     MOVE PB-LAST-MAINT-BY       TO  CR-CSR-CODE.
  9035
  9036     MOVE CR-STATE               TO STATE-L.
  9037
  9038     PERFORM 8200-STATE-CODE-LOOKUP THRU 8299-STATE-LOOKUP-X.
  9039
  9040     PERFORM 8600-SETUP-DETAIL-LINE THRU 8689-SETUP-DETAIL-X.
  9041
  9042***************************************************
  9043***  WHEN AN ISSUE WAS PROCESSED THAT HAD       ***
  9044***  INVALID BENEFIT CODES LOCATED IN BOTH      ***
  9045***  BENEFITS,  THE 'ACTION' ON THE DETAIL LIST ***
  9046***  LINE WAS BYPASSED - ONLY THE CERTIFICATE,  ***
  9047***  THE EFFECTIVE DATE AND THE AGE PRINTED.    ***
  9048***************************************************
  9049     IF (PB-INVALID-LIFE AND PB-INVALID-AH)
  9050         IF CR-LF-POLICY-IS-RESTORE
  9051             MOVE 'RESTORED  '          TO TRD-LF-ACTION
  9052             GO TO 0530-PROCESS-ISSUE-CONTINUED
  9053         ELSE
  9054         IF CR-LF-POLICY-IS-REISSUE
  9055             MOVE 'RE-ISSUED '          TO TRD-LF-ACTION
  9056             GO TO 0530-PROCESS-ISSUE-CONTINUED
  9057         ELSE
  9058         IF CR-LF-IS-REIN-ONLY
  9059             MOVE 'REIN. ONLY'          TO TRD-LF-ACTION
  9060             GO TO 0530-PROCESS-ISSUE-CONTINUED
  9061         ELSE
  9062         IF CR-LF-IS-DECLINED
  9063             MOVE 'DECLINED  '          TO TRD-LF-ACTION
  9064             GO TO 0530-PROCESS-ISSUE-CONTINUED
  9065         ELSE
  9066         IF CR-LF-IS-VOID
  9067             MOVE 'VOIDED    '          TO TRD-LF-ACTION
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 176
* ECS010T1.cbl
  9068             GO TO 0530-PROCESS-ISSUE-CONTINUED
  9069         ELSE
  9070         IF CR-LF-POLICY-IS-MONTHLY
  9071            MOVE 'MONTHLY'       TO TRD-LF-ACTION
  9072            GO TO 0530-PROCESS-ISSUE-CONTINUED.
  9073
  9074
  9075 0510-PROCESS-LIFE-ISSUE.
  9076
  9077     IF PB-INVALID-LIFE
  9078         GO TO 0520-PROCESS-A-H-ISSUE.
  9079
  9080     MOVE PB-I-LF-BENEFIT-CD     TO  CLAS-LOOK.
  9081     PERFORM 8300-LIFE-TYPE-LOOKUP THRU 8399-LIFE-LOOKUP-X.
  9082     MOVE CLAS-LOOK              TO  PB-I-LF-BENEFIT-CD.
  9083
  9084     MOVE PB-I-LF-BENEFIT-CD     TO  CR-LFTYP.
  9085     MOVE PB-I-LF-TERM           TO  CR-LF-TERM.
  9086     MOVE PB-I-LF-CRIT-PER       TO  CR-LF-CRIT-PERIOD.
  9087     MOVE PB-I-TERM-IN-DAYS      TO  CR-LF-TERM-IN-DAYS.
  9088     MOVE PB-I-RATE-DEVIATION-LF TO  CR-LF-DEV-CODE.
  9089     MOVE PB-I-RATE-DEV-PCT-LF   TO  CR-LF-DEV-PCT.
  9090
  9091     MOVE PB-I-LF-BENEFIT-AMT    TO  CR-LFAMT.
  9092     MOVE PB-I-LF-PREMIUM-AMT    TO  CR-LFPRM.
  9093     IF PB-I-LF-POLICY-FEE  NUMERIC
  9094         MOVE PB-I-LF-POLICY-FEE TO  CR-LF-POLICY-FEE.
  9095     MOVE PB-I-LF-PREM-CALC      TO  CR-LFPRM-CALC.
  9096     MOVE PB-I-LF-RATE           TO  CR-LFPRM-RATE.
  9097
  9098     IF PB-I-LF-PREM-TAX NUMERIC
  9099        MOVE PB-I-LF-PREM-TAX    TO CR-LF-ISS-PREM-TAX
  9100     END-IF
  9101
  9102
  9103     IF PB-I-LF-REI-RATE NOT = ZEROS
  9104        IF DTE-CLIENT = 'DCC'
  9105           CONTINUE
  9106*          PERFORM 0795-DCC-NSP-LF  THRU 0795-EXIT
  9107        ELSE
  9108           MOVE PB-I-LF-REI-RATE TO CR-LF-NSP-PRM-RATE
  9109           COMPUTE CR-LF-NSP-PRM ROUNDED =
  9110                          (CR-LFAMT / 100) * PB-I-LF-REI-RATE
  9111        END-IF
  9112     END-IF
  9113
  9114     IF CLAS-I-EP (CLAS-INDEXL) = 'B'
  9115         MOVE PB-I-LF-ALT-BENEFIT-AMT TO CR-LFAMT-ALT
  9116         MOVE PB-I-LF-ALT-PREMIUM-AMT TO CR-LFPRM-ALT
  9117         MOVE PB-I-LF-ALT-PREM-CALC   TO CR-LFPRM-CALC-ALT
  9118         MOVE PB-I-LF-ALT-RATE        TO CR-LFPRM-RATE-ALT
  9119         IF PB-I-LF-ALT-REI-RATE NOT = ZEROS
  9120             COMPUTE CR-LF-NSP-PRM ROUNDED =  CR-LF-NSP-PRM +
  9121                 ((CR-LFAMT-ALT / 100) * PB-I-LF-ALT-REI-RATE).
  9122
  9123     MOVE PB-I-LF-EXPIRE-DT      TO  DC-BIN-DATE-1.
  9124     MOVE ' '                    TO  DC-OPTION-CODE.
  9125     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 177
* ECS010T1.cbl
  9126     MOVE DC-GREG-DATE-CYMD      TO  CR-LF-EXPIRE-DATE
  9127                                     WS-CR-LF-EXPIRE-DATE-N.
  9128
  9129     IF CR-ENTRY-STATUS = 'P'
  9130         MOVE '1'                TO  CR-LF-CURRENT-STATUS
  9131     ELSE
  9132         MOVE CR-ENTRY-STATUS    TO  CR-LF-CURRENT-STATUS.
  9133
  9134     MOVE CLAS-I-AB3 (CLAS-INDEXL)  TO TRD-LFTYP.
  9135     MOVE CR-LF-TERM                TO TRD-LFTRM.
  9136     COMPUTE TRD-LFPRM-RFND = CR-LFPRM + CR-LFPRM-ALT.
  9137     MOVE 'ISSUE     '              TO TRD-LF-ACTION.
  9138     MOVE CR-LF-CURRENT-STATUS      TO TRD-LF-STATUS.
  9139
  9140     IF CR-LF-POLICY-IS-RESTORE
  9141         MOVE 'RESTORED  '          TO TRD-LF-ACTION.
  9142     IF CR-LF-POLICY-IS-REISSUE
  9143         MOVE 'RE-ISSUED '          TO TRD-LF-ACTION.
  9144     IF CR-LF-IS-REIN-ONLY
  9145         MOVE 'REIN. ONLY'          TO TRD-LF-ACTION.
  9146
  9147     IF CR-LF-IS-DECLINED
  9148         MOVE 'DECLINED  '          TO TRD-LF-ACTION.
  9149
  9150     IF CR-LF-IS-VOID
  9151         MOVE 'VOIDED    '          TO TRD-LF-ACTION.
  9152     IF CR-LF-POLICY-IS-MONTHLY
  9153         MOVE 'MONTHLY   '          TO TRD-LF-ACTION.
  9154
  9155     ADD +1                      TO  W-LF-ISSUES.
  9156
  9157 0520-PROCESS-A-H-ISSUE.
  9158
  9159     IF PB-INVALID-AH
  9160         GO TO 0530-PROCESS-ISSUE-CONTINUED.
  9161
  9162     MOVE PB-I-AH-BENEFIT-CD     TO CLAS-LOOK.
  9163     PERFORM 8400-A-H-TYPE-LOOKUP THRU 8499-A-H-LOOKUP-X.
  9164     MOVE CLAS-LOOK              TO  PB-I-AH-BENEFIT-CD.
  9165
  9166     MOVE PB-I-AH-BENEFIT-CD     TO  CR-AHTYP.
  9167     MOVE PB-I-AH-TERM           TO  CR-AH-TERM.
  9168     MOVE PB-I-AH-CRIT-PER       TO  CR-AH-CRIT-PERIOD.
  9169     MOVE PB-I-RATE-DEVIATION-AH TO  CR-AH-DEV-CODE.
  9170     MOVE PB-I-RATE-DEV-PCT-AH   TO  CR-AH-DEV-PCT.
  9171
  9172     MOVE PB-I-AH-BENEFIT-AMT    TO  CR-AHAMT.
  9173     MOVE PB-I-AH-PREMIUM-AMT    TO  CR-AHPRM.
  9174     IF PB-I-AH-POLICY-FEE  NUMERIC
  9175         MOVE PB-I-AH-POLICY-FEE TO  CR-AH-POLICY-FEE.
  9176     MOVE PB-I-AH-PREM-CALC      TO  CR-AHPRM-CALC.
  9177     MOVE PB-I-AH-RATE           TO  CR-AHPRM-RATE.
  9178
  9179     IF PB-I-AH-PREM-TAX NUMERIC
  9180        MOVE PB-I-AH-PREM-TAX    TO CR-AH-ISS-PREM-TAX
  9181     END-IF
  9182
  9183     IF PB-I-AH-REI-RATE NOT = ZEROS
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 178
* ECS010T1.cbl
  9184        IF DTE-CLIENT = 'DCC'
  9185           CONTINUE
  9186        ELSE
  9187           MOVE PB-I-AH-REI-RATE   TO  CR-AH-NSP-PRM-RATE
  9188           COMPUTE CR-AH-NSP-PRM ROUNDED =
  9189             ((CR-AHAMT * CR-AH-TERM) / 100) * PB-I-AH-REI-RATE
  9190        END-IF
  9191     END-IF
  9192
  9193     IF CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'G' OR 'L'
  9194        MOVE PB-I-AMOUNT-FINANCED TO CR-LFAMT
  9195        MOVE PB-I-UNPAID-CASH-PRICE TO CR-LFAMT-ALT
  9196        MOVE PB-I-CLP-AMOUNT     TO CR-LFPRM-ALT
  9197     END-IF
  9198     MOVE PB-I-AH-EXPIRE-DT      TO  DC-BIN-DATE-1.
  9199     MOVE ' '                    TO  DC-OPTION-CODE.
  9200     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
  9201     MOVE DC-GREG-DATE-CYMD      TO  CR-AH-EXPIRE-DATE
  9202                                     WS-CR-AH-EXPIRE-DATE-N.
  9203
  9204     IF CR-ENTRY-STATUS = 'P'
  9205         MOVE '1'                TO  CR-AH-CURRENT-STATUS
  9206     ELSE
  9207         MOVE CR-ENTRY-STATUS    TO  CR-AH-CURRENT-STATUS.
  9208
  9209     MOVE CLAS-I-AB3 (CLAS-INDEXA)  TO TRD-AHTYP.
  9210     MOVE CR-AH-TERM                TO TRD-AHTRM.
  9211     MOVE CR-AHPRM                  TO TRD-AHPRM-RFND.
  9212     MOVE 'ISSUE     '              TO TRD-AH-ACTION.
  9213     MOVE CR-AH-CURRENT-STATUS      TO TRD-AH-STATUS.
  9214
  9215     IF CR-AH-POLICY-IS-RESTORE
  9216         MOVE 'RESTORED  '          TO TRD-AH-ACTION.
  9217     IF CR-AH-POLICY-IS-REISSUE
  9218         MOVE 'RE-ISSUED '          TO TRD-AH-ACTION.
  9219     IF CR-AH-IS-REIN-ONLY
  9220         MOVE 'REIN. ONLY'          TO TRD-AH-ACTION.
  9221
  9222     IF CR-AH-IS-DECLINED
  9223         MOVE 'DECLINED  '          TO TRD-AH-ACTION.
  9224
  9225     IF CR-AH-IS-VOID
  9226         MOVE 'VOIDED    '          TO TRD-AH-ACTION.
  9227     IF CR-AH-POLICY-IS-MONTHLY
  9228         MOVE 'MONTHLY   '          TO TRD-AH-ACTION.
  9229
  9230     ADD +1                      TO  W-AH-ISSUES.
  9231
  9232 0530-PROCESS-ISSUE-CONTINUED.
  9233
  9234     PERFORM 1000-SET-COMMISSION-STRUCTURE THRU 1499-SET-COMM-X.
  9235     MOVE WK-NEW-RATES           TO CR-COMPENSATION-LEVELS.
  9236     MOVE  SPACES                TO WS-LEVELS-CHARGEBACK-SWITCHES.
  9237     PERFORM 1500-GET-ACCT-LEVEL-LF-COMM THRU 1519-ACCT-LF-COMM-X.
  9238
  9239     IF (DTE-CLIENT = 'DCC')
  9240        AND (CR-AHTYP NOT = '00' AND '  ')
  9241        IF CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'G' OR 'L'
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 179
* ECS010T1.cbl
  9242           PERFORM 0920-GET-BANK-FEES
  9243                                 THRU 0920-EXIT
  9244           PERFORM 0930-BUILD-CERT-TRLR
  9245                                 THRU 0930-EXIT
  9246           PERFORM 0395-GET-CERT-TRLRS
  9247                                 THRU 0395-EXIT
  9248        END-IF
  9249     END-IF
  9250
  9251     IF DTE-CLIENT = 'DCC'
  9252        IF CR-LF-DEV-PCT NOT = +0 AND +1
  9253           COMPUTE CR-LF-NSP-PRM ROUNDED =
  9254              (CR-LFPRM + CR-LFPRM-ALT) -
  9255              ((CR-LFPRM + CR-LFPRM-ALT) * CR-LCOM-L (1))
  9256*             ((CR-LFPRM + CR-LFPRM-ALT) * WK-L-RT1 (1))
  9257        END-IF
  9258     END-IF
  9259
  9260     IF CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'G' OR 'L'
  9261        MOVE CR-LFPRM-ALT        TO CR-AH-NSP-PRM
  9262     ELSE
  9263        IF DTE-CLIENT = 'DCC'
  9264           IF CR-AH-DEV-PCT NOT = +0 AND +1
  9265              COMPUTE CR-AH-NSP-PRM ROUNDED =
  9266              CR-AHPRM -
  9267              (CR-AHPRM * CR-LCOM-AH (1))
  9268*             (CR-AHPRM * WK-A-RT1 (1))
  9269           END-IF
  9270        END-IF
  9271     END-IF
  9272
  9273     IF CR-ENTRY-STATUS = 'P'
  9274         MOVE '1'                   TO CR-ENTRY-STATUS.
  9275
  9276     IF CR-POLICY-IS-REISSUE  OR
  9277        CR-POLICY-IS-REIN-ONLY OR
  9278        CR-POLICY-IS-DECLINED OR
  9279        CR-POLICY-IS-VOID
  9280        OR CR-POLICY-IS-MONTHLY
  9281         GO TO 0590-END-ISSUE-PROCESSING.
  9282
  9283     ADD CR-LFPRM TO TPL-ISS-PRM (1).
  9284     IF CLAS-I-BEN-CATEGORY (CLAS-INDEXA) NOT = 'G' AND 'L'
  9285        ADD CR-LFPRM-ALT TO TPL-ISS-PRM (1)
  9286     END-IF
  9287     ADD CR-AHPRM TO TPA-ISS-PRM (1).
  9288
  9289     IF NOT PB-INVALID-LIFE
  9290         COMPUTE H-LFCM ROUNDED =
  9291                    (CR-LFPRM + CR-LFPRM-ALT) * ACCT-COMM-LF
  9292         MOVE H-LFCM                   TO TRD-LFCOM-CLM
  9293         ADD H-LFCM                    TO TPL-ACCT-COM (1).
  9294
  9295     IF NOT PB-INVALID-AH
  9296        IF CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'G' OR 'L'
  9297           COMPUTE H-AHCM ROUNDED = CR-AHPRM - (CR-LFPRM-ALT
  9298           + CR-ADDL-CLP)
  9299        ELSE
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 180
* ECS010T1.cbl
  9300           COMPUTE H-AHCM ROUNDED = CR-AHPRM * ACCT-COMM-AH
  9301        END-IF
  9302        MOVE H-AHCM                   TO TRD-AHCOM-CLM
  9303        ADD H-AHCM                    TO TPA-ACCT-COM (1)
  9304     END-IF
  9305
  9306     ADD +1 TO BC-G-ISS.
  9307     ADD +1 TO BC-COMM.
  9308     ADD CR-LFPRM TO BC-NET-WRIT.
  9309     IF CLAS-I-BEN-CATEGORY (CLAS-INDEXA) NOT = 'G' AND 'L'
  9310        ADD CR-LFPRM-ALT TO BC-NET-WRIT
  9311     END-IF
  9312     ADD CR-AHPRM TO BC-NET-WRIT.
  9313
  9314     IF CLAS-I-BAL (CLAS-INDEXL) = 'B'
  9315        ADD CR-LFPRM             TO BC-NET-WRIT-OB
  9316        ADD CR-LFPRM-ALT         TO BC-NET-WRIT-OB
  9317     ELSE
  9318        ADD CR-LFPRM             TO BC-NET-WRIT-SP
  9319        IF CLAS-I-BEN-CATEGORY (CLAS-INDEXA) NOT = 'G' AND 'L'
  9320           ADD CR-LFPRM-ALT      TO BC-NET-WRIT-SP
  9321        END-IF
  9322     END-IF
  9323
  9324     IF  CLAS-I-BAL (CLAS-INDEXA) = 'B'
  9325         ADD CR-AHPRM            TO BC-NET-WRIT-OB
  9326     ELSE
  9327         ADD CR-AHPRM            TO BC-NET-WRIT-SP.
  9328
  9329 0590-END-ISSUE-PROCESSING.
  9330
  9331     PERFORM 8690-PRINT-DETAIL-LINE THRU 8699-PRT-DETAIL-X.
  9332
  9333     PERFORM 3000-REINSURE-ROUTINE THRU 3099-REINSURE-ROUTINE-X.
  9334
  9335     IF NOT CR-POLICY-IS-REIN-ONLY  AND
  9336        NOT CR-POLICY-IS-DECLINED  AND
  9337        NOT CR-POLICY-IS-VOID
  9338         MOVE 'Y' TO BILLED-SWITCH
  9339         PERFORM 2100-BUILD-ISSUE-EXTRACT THRU 2199-BLD-ISSUE-X.
  9340
  9341     IF NOT CR-POLICY-IS-REISSUE  AND
  9342        NOT CR-POLICY-IS-DECLINED  AND
  9343        NOT CR-POLICY-IS-VOID
  9344        AND NOT CR-POLICY-IS-MONTHLY
  9345         PERFORM 3100-REINSURE-ISSUE THRU 3199-REINSURE-ISSUE-X.
  9346
  9347     MOVE '*'                   TO TRANSACTION-FLAG.
  9348     GO TO 0300-READ-PENDING-TRANSACTIONS.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 181
* ECS010T1.cbl
  9350******************************************************************
  9351***    P R O C E S S   C A N C E L   T R A N S A C T I O N S   ***
  9352******************************************************************
  9353
  9354 0600-PROCESS-CANCELLATIONS.
  9355
  9356*     DISPLAY ' PROC CNC ' CR-FULL-CONTROL
  9357     PERFORM 3000-REINSURE-ROUTINE THRU 3099-REINSURE-ROUTINE-X.
  9358
  9359     IF AM-RECALC-COMM = ('Y' OR '1')
  9360        PERFORM 1600-RECALC-COMM-EXTR
  9361                                 THRU 1899-RECALC-COMM-EXTR-X
  9362        MOVE ' '                 TO RECALC-TYPE
  9363     END-IF
  9364
  9365     MOVE CR-LFRFND               TO LIFE-REFUND.
  9366     MOVE CR-LFRFND-CALC          TO LIFE-REFUND-CALC.
  9367     MOVE CR-AHRFND               TO A-H-REFUND.
  9368     MOVE CR-AHRFND-CALC          TO A-H-REFUND-CALC.
  9369     MOVE CR-SUM-CAN-CNT-YTD      TO YTD-CANCEL-CNT.
  9370
  9371     MOVE PB-C-LF-CANCEL-AMT      TO CR-LFRFND.
  9372     IF CR-LFRFND-CALC = ZEROS
  9373         MOVE PB-C-LF-REF-CALC    TO CR-LFRFND-CALC
  9374                                     LIFE-REFUND-CALC
  9375     ELSE
  9376         MOVE PB-C-LF-CANCEL-AMT  TO CR-LFRFND-CALC.
  9377
  9378     MOVE PB-C-AH-CANCEL-AMT      TO CR-AHRFND.
  9379
  9380     IF CR-AHRFND-CALC = ZEROS
  9381        MOVE PB-C-AH-REF-CALC    TO CR-AHRFND-CALC
  9382                                    A-H-REFUND-CALC
  9383     ELSE
  9384        MOVE PB-C-AH-CANCEL-AMT  TO CR-AHRFND-CALC
  9385     END-IF
  9386
  9387     IF PB-C-POST-CARD-IND = 'Y' OR 'N'
  9388        MOVE PB-C-POST-CARD-IND  TO CR-POST-CARD-IND
  9389     ELSE
  9390        MOVE SPACES              TO CR-POST-CARD-IND
  9391     END-IF
  9392
  9393*    MOVE CR-DT                 TO  DC-GREG-DATE-CYMD.
  9394*    MOVE 'L'                   TO  DC-OPTION-CODE.
  9395*    PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
  9396*    MOVE DC-BIN-DATE-1         TO  WS-CR-BIN-DATE.
  9397
  9398     IF PB-C-NH-INT-ON-REFS NUMERIC
  9399        AND PB-C-NH-INT-ON-REFS NOT = ZEROS
  9400        MOVE PB-C-NH-INT-ON-REFS  TO CR-NH-INT-ON-REF
  9401     END-IF
  9402
  9403     IF PB-CI-STATE-TAX NOT NUMERIC
  9404        MOVE ZEROS               TO PB-CI-STATE-TAX.
  9405
  9406     IF PB-CI-MUNI-TAX NOT NUMERIC
  9407        MOVE ZEROS               TO PB-CI-MUNI-TAX.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 182
* ECS010T1.cbl
  9408
  9409     IF CR-CANCEL-STATE-TAX NUMERIC
  9410         ADD PB-CI-STATE-TAX  TO CR-CANCEL-STATE-TAX
  9411       ELSE
  9412         MOVE PB-CI-STATE-TAX TO CR-CANCEL-STATE-TAX.
  9413
  9414     IF CR-CANCEL-MUNI-TAX NUMERIC
  9415         ADD PB-CI-MUNI-TAX   TO CR-CANCEL-MUNI-TAX
  9416       ELSE
  9417         MOVE PB-CI-MUNI-TAX  TO CR-CANCEL-MUNI-TAX.
  9418
  9419     MOVE ZEROS                  TO MONTHS-DIFF-LF
  9420                                    MONTHS-DIFF-AH.
  9421
  9422     PERFORM 8600-SETUP-DETAIL-LINE THRU 8689-SETUP-DETAIL-X.
  9423
  9424 0630-PROCESS-LIFE-CANCEL.
  9425
  9426     IF CR-LFTYP = ZERO  OR
  9427        PB-C-LF-CANCEL-DT = LOW-VALUES  OR  SPACES
  9428         MOVE ZEROS               TO H-LFCM
  9429         GO TO 0650-PROCESS-A-H-CANCEL.
  9430
  9431     IF PB-C-LF-PREM-TAX NUMERIC
  9432        MOVE PB-C-LF-PREM-TAX    TO CR-LF-CNC-PREM-TAX
  9433     END-IF
  9434     MOVE PB-C-LF-CANCEL-DT       TO  DC-BIN-DATE-1.
  9435     MOVE ' '                     TO  DC-OPTION-CODE.
  9436     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
  9437     MOVE DC-GREG-DATE-CYMD       TO  CR-LF-CANC-DT
  9438                                      WS-CR-LF-CANC-DT-N.
  9439
  9440
  9441     MOVE PB-INPUT-DT            TO DC-BIN-DATE-1
  9442     MOVE ' '                    TO DC-OPTION-CODE
  9443     PERFORM 8000-DATE-CONVERT-ROUTINE
  9444                                 THRU 8099-DATE-CONVERT-X
  9445     IF CR-LF-CNC-ENT-DT NOT NUMERIC
  9446        MOVE ZEROS TO CR-LF-CNC-ENT-DT
  9447     END-IF
  9448     IF NO-CONVERSION-ERROR
  9449        IF CR-LF-CNC-ENT-DT = ZEROS
  9450           MOVE DC-GREG-DATE-CYMD TO CR-LF-CNC-ENT-DT
  9451        END-IF
  9452     END-IF
  9453
  9454     MOVE WS-CR-BIN-DATE          TO  DC-BIN-DATE-1.
  9455     MOVE PB-C-LF-CANCEL-DT       TO  DC-BIN-DATE-2.
  9456     MOVE '1'                     TO  DC-OPTION-CODE.
  9457     MOVE ' '                     TO  DC-CENTURY-ADJUSTMENT.
  9458     MOVE ZEROS                   TO  DC-ELAPSED-MONTHS
  9459                                      DC-ODD-DAYS-OVER
  9460                                      DC-ELAPSED-DAYS.
  9461     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
  9462     MOVE DC-ELAPSED-MONTHS       TO  MONTHS-DIFF-LF.
  9463
  9464     IF DC-ODD-DAYS-OVER   GREATER THAN  ZERO
  9465         ADD  +1                  TO  MONTHS-DIFF-LF.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 183
* ECS010T1.cbl
  9466
  9467     MOVE  'YYYYYYYYYY'           TO  WS-LF-CHARGEBACK-LEVELS.
  9468
  9469     MOVE  ZEROS                  TO  SUB.
  9470
  9471 0635-LIFE-CHARGEBACK-LOOP.
  9472
  9473     ADD    +1                    TO  SUB.
  9474
  9475     IF  SUB  GREATER THAN  +10
  9476         GO TO  0640-CONTINUE-LIFE-CANCEL.
  9477
  9478     IF  AM-COMM-CHARGEBACK (SUB)  NOT  NUMERIC  OR
  9479         AM-COMM-CHARGEBACK (SUB)  =  ZEROS
  9480         GO TO  0635-LIFE-CHARGEBACK-LOOP.
  9481
  9482     IF  AM-COMM-CHARGEBACK (SUB)  EQUAL    '99'
  9483         MOVE  'N'    TO  WS-LF-CHARGEBACK-SW (SUB).
  9484
  9485     IF  MONTHS-DIFF-LF GREATER THAN AM-COMM-CHARGEBACK (SUB)
  9486         MOVE  'N'        TO  WS-LF-CHARGEBACK-SW (SUB).
  9487
  9488     GO TO  0635-LIFE-CHARGEBACK-LOOP.
  9489
  9490
  9491 0640-CONTINUE-LIFE-CANCEL.
  9492
  9493     IF DC-ODD-DAYS-OVER GREATER THAN ZEROS
  9494        SUBTRACT +1 FROM MONTHS-DIFF-LF.
  9495
  9496     PERFORM 1500-GET-ACCT-LEVEL-LF-COMM THRU 1519-ACCT-LF-COMM-X.
  9497
  9498     IF DTE-CLIENT = 'GIC'
  9499         IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'B'
  9500             MOVE CR-LFPRM-CALC   TO CR-LFRFND-CALC
  9501                                     LIFE-REFUND-CALC.
  9502
  9503*    IF DTE-CLIENT = 'TMS'
  9504     MOVE PB-LF-REFUND-TYPE      TO CR-LF-REFUND-TYPE
  9505
  9506     IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'Z'
  9507         MOVE PB-C-LIVES               TO CR-SUM-CAN-CNT-YTD
  9508     ELSE
  9509         IF CR-LF-CANCEL-EXIT-DATE = ZEROS
  9510             MOVE CR-LF-CURRENT-STATUS TO CR-LF-STATUS-AT-CANCEL
  9511             MOVE '8'                  TO CR-LF-CURRENT-STATUS
  9512             MOVE PB-C-LF-COMM-CHARGEBACK TO CR-LF-COMM-CHARGEBACK
  9513             MOVE EOM-RUN-DATE      TO CR-LF-CANCEL-EXIT-DATE
  9514                                       WS-CR-LF-CANCEL-EXIT-DATE-N
  9515         ELSE
  9516             IF CR-LF-CURRENT-STATUS = '6'
  9517                 MOVE '8'              TO CR-LF-CURRENT-STATUS
  9518                 MOVE PB-C-LF-COMM-CHARGEBACK
  9519                                       TO CR-LF-COMM-CHARGEBACK
  9520                 MOVE EOM-RUN-DATE TO CR-LF-CANCEL-EXIT-DATE
  9521                                      WS-CR-LF-CANCEL-EXIT-DATE-N.
  9522
  9523*************************************************
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 184
* ECS010T1.cbl
  9524***  ADDED IN 06/93 WHEN CERTIFICATE-RECORD   ***
  9525***  WAS CONVERTED TO 1056 BYTES.             ***
  9526*************************************************
  9527     MOVE PB-ENTRY-BATCH               TO CR-LF-EXIT-BATCH.
  9528
  9529     MOVE CLAS-I-AB3 (CLAS-INDEXL)     TO TRD-LFTYP.
  9530     MOVE CR-LF-TERM                   TO TRD-LFTRM.
  9531     MOVE CR-LFRFND                    TO TRD-LFPRM-RFND.
  9532
  9533     COMPUTE H-LFCM ROUNDED =
  9534                              (CR-LFRFND * ACCT-COMM-LF) * (-1).
  9535     MOVE H-LFCM                       TO TRD-LFCOM-CLM.
  9536
  9537     MOVE CR-LF-CNC-MO                 TO TRD-LFACTMO.
  9538     MOVE CR-LF-CNC-DA                 TO TRD-LFACTDA.
  9539     MOVE CR-LF-CNC-YR                 TO TRD-LFACTYR.
  9540     MOVE '/'                          TO TRD-LF-S1  TRD-LF-S2.
  9541
  9542     MOVE 'CANCEL    '                 TO TRD-LF-ACTION.
  9543     MOVE CR-LF-CURRENT-STATUS         TO TRD-LF-STATUS.
  9544
  9545 0650-PROCESS-A-H-CANCEL.
  9546
  9547     IF CR-AHTYP = ZERO  OR
  9548        PB-C-AH-CANCEL-DT = LOW-VALUES  OR  SPACES
  9549         MOVE ZEROS               TO H-AHCM
  9550         GO TO 0660-PROCESS-CANCEL-CONTINUE.
  9551
  9552*    MOVE CR-DT                 TO  DC-GREG-DATE-CYMD.
  9553*    MOVE 'L'                   TO  DC-OPTION-CODE.
  9554*    PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
  9555*    MOVE DC-BIN-DATE-1         TO  WS-CR-BIN-DATE.
  9556
  9557     MOVE PB-C-AH-CANCEL-DT       TO  DC-BIN-DATE-1.
  9558     MOVE ' '                     TO  DC-OPTION-CODE.
  9559     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
  9560     MOVE DC-GREG-DATE-CYMD       TO  CR-AH-CANC-DT
  9561                                      WS-CR-AH-CANC-DT-N.
  9562
  9563     MOVE PB-INPUT-DT            TO DC-BIN-DATE-1
  9564     MOVE ' '                    TO DC-OPTION-CODE
  9565     PERFORM 8000-DATE-CONVERT-ROUTINE
  9566                                 THRU 8099-DATE-CONVERT-X
  9567     IF CR-AH-CNC-ENT-DT NOT NUMERIC
  9568        MOVE ZEROS TO CR-AH-CNC-ENT-DT
  9569     END-IF
  9570     IF NO-CONVERSION-ERROR
  9571        IF CR-AH-CNC-ENT-DT = ZEROS
  9572           MOVE DC-GREG-DATE-CYMD TO CR-AH-CNC-ENT-DT
  9573        END-IF
  9574     END-IF
  9575
  9576     IF PB-C-AH-PREM-TAX NUMERIC
  9577        MOVE PB-C-AH-PREM-TAX    TO CR-AH-CNC-PREM-TAX
  9578     END-IF
  9579     MOVE WS-CR-BIN-DATE          TO  DC-BIN-DATE-1.
  9580     MOVE PB-C-AH-CANCEL-DT       TO  DC-BIN-DATE-2.
  9581     MOVE '1'                     TO  DC-OPTION-CODE.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 185
* ECS010T1.cbl
  9582     MOVE ' '                     TO  DC-CENTURY-ADJUSTMENT.
  9583     MOVE ZEROS                   TO  DC-ELAPSED-MONTHS
  9584                                      DC-ODD-DAYS-OVER
  9585                                      DC-ELAPSED-DAYS.
  9586     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
  9587     MOVE DC-ELAPSED-MONTHS       TO  MONTHS-DIFF-AH.
  9588
  9589     IF  DC-ODD-DAYS-OVER   GREATER THAN   ZERO
  9590          ADD  +1                 TO  MONTHS-DIFF-AH.
  9591
  9592     MOVE  'YYYYYYYYYY'           TO  WS-AH-CHARGEBACK-LEVELS.
  9593     IF CR-BANK-NOCHRGB-MONTHS NOT NUMERIC
  9594        MOVE ZEROS               TO CR-BANK-NOCHRGB-MONTHS
  9595     END-IF
  9596*    IF DTE-CLIENT = 'DCC'
  9597*       IF (CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'G' OR 'L')
  9598*          AND (CR-BANK-NOCHRGB-MONTHS > ZEROS)
  9599*          PERFORM VARYING SUB FROM +1 BY +1 UNTIL
  9600*             (CR-BANK-NO = CR-COM-AGT (SUB))
  9601*             OR (SUB > +10)
  9602*          END-PERFORM
  9603*          IF CR-BANK-NO = CR-COM-AGT (SUB)
  9604*             MOVE CR-BANK-NOCHRGB-MONTHS
  9605*                                TO AM-COMM-CHARGEBACK (SUB)
  9606*          END-IF
  9607*       END-IF
  9608*    END-IF
  9609
  9610
  9611     MOVE 'Y'                     TO WS-FIRST-K
  9612     MOVE ' '                     TO WS-DLR-INC-CHG-BACK
  9613     MOVE  ZEROS                  TO  SUB.
  9614
  9615 0653-A-H-CHARGEBACK-LOOP.
  9616
  9617     ADD    +1                    TO  SUB.
  9618
  9619     IF  SUB  GREATER THAN  +10
  9620         GO TO  0655-CONTINUE-A-H-CANCEL.
  9621
  9622     IF  AM-COMM-CHARGEBACK (SUB)  NOT  NUMERIC  OR
  9623         AM-COMM-CHARGEBACK (SUB)  =  ZEROS
  9624         GO TO  0653-A-H-CHARGEBACK-LOOP.
  9625
  9626     IF  AM-COMM-CHARGEBACK (SUB)  EQUAL    '99'
  9627         MOVE  'N'    TO  WS-AH-CHARGEBACK-SW (SUB).
  9628
  9629     IF  (MONTHS-DIFF-AH GREATER THAN AM-COMM-CHARGEBACK (SUB))
  9630         OR ((DTE-CLIENT = 'DCC')
  9631             AND (CR-AHRFND = ZEROS))
  9632         MOVE  'N'        TO  WS-AH-CHARGEBACK-SW (SUB).
  9633
  9634     GO TO  0653-A-H-CHARGEBACK-LOOP.
  9635
  9636
  9637 0655-CONTINUE-A-H-CANCEL.
  9638
  9639     IF DC-ODD-DAYS-OVER GREATER THAN ZEROS
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 186
* ECS010T1.cbl
  9640        SUBTRACT +1 FROM MONTHS-DIFF-AH.
  9641
  9642     PERFORM 1550-GET-ACCT-LEVEL-AH-COMM THRU 1599-ACCT-AH-COMM-X.
  9643
  9644     IF DTE-CLIENT = 'GIC'
  9645         IF CLAS-I-CALC-TYPE (CLAS-INDEXA) = 'B'
  9646             MOVE CR-AHPRM-CALC   TO CR-AHRFND-CALC
  9647                                     A-H-REFUND-CALC.
  9648
  9649*    IF DTE-CLIENT = 'TMS'
  9650     MOVE PB-AH-REFUND-TYPE      TO CR-AH-REFUND-TYPE
  9651*    DISPLAY ' PEND AH REF TYPE ' PB-AH-REFUND-TYPE
  9652
  9653
  9654     IF CLAS-I-CALC-TYPE (CLAS-INDEXA) = 'Z'
  9655         MOVE PB-C-LIVES               TO CR-SUM-CAN-CNT-YTD
  9656     ELSE
  9657         IF CR-AH-CANCEL-EXIT-DATE = ZEROS
  9658             MOVE CR-AH-CURRENT-STATUS TO CR-AH-STATUS-AT-CANCEL
  9659             MOVE '8'                  TO CR-AH-CURRENT-STATUS
  9660             MOVE PB-C-AH-COMM-CHARGEBACK TO CR-AH-COMM-CHARGEBACK
  9661             MOVE EOM-RUN-DATE    TO CR-AH-CANCEL-EXIT-DATE
  9662                                     WS-CR-AH-CANCEL-EXIT-DATE-N
  9663         ELSE
  9664             IF CR-AH-CURRENT-STATUS = '7'
  9665                 MOVE '8'              TO CR-AH-CURRENT-STATUS
  9666                 MOVE PB-C-AH-COMM-CHARGEBACK
  9667                                       TO CR-AH-COMM-CHARGEBACK
  9668                 MOVE EOM-RUN-DATE TO CR-AH-CANCEL-EXIT-DATE
  9669                                      WS-CR-AH-CANCEL-EXIT-DATE-N.
  9670
  9671*************************************************
  9672***  ADDED IN 06/93 WHEN CERTIFICATE-RECORD   ***
  9673***  WAS CONVERTED TO 1056 BYTES.             ***
  9674*************************************************
  9675     MOVE PB-ENTRY-BATCH               TO CR-AH-EXIT-BATCH.
  9676
  9677     MOVE CLAS-I-AB3 (CLAS-INDEXA)     TO TRD-AHTYP.
  9678     MOVE CR-AH-TERM                   TO TRD-AHTRM.
  9679     MOVE CR-AHRFND                    TO TRD-AHPRM-RFND.
  9680
  9681     IF CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'G' OR 'L'
  9682        COMPUTE CNC-FACT = CR-AHRFND / CR-AHPRM
  9683        COMPUTE H-AHCM ROUNDED = CNC-FACT *
  9684           (CR-AHPRM - (CR-LFPRM-ALT
  9685           + CR-ADDL-CLP)) * -1
  9686     ELSE
  9687        COMPUTE H-AHCM ROUNDED =
  9688          (CR-AHRFND * ACCT-COMM-AH) * (-1)
  9689     END-IF
  9690
  9691     MOVE H-AHCM                       TO TRD-AHCOM-CLM.
  9692
  9693     MOVE CR-AH-CNC-MO                 TO TRD-AHACTMO.
  9694     MOVE CR-AH-CNC-DA                 TO TRD-AHACTDA.
  9695     MOVE CR-AH-CNC-YR                 TO TRD-AHACTYR
  9696     MOVE '/'                          TO TRD-AH-S1  TRD-AH-S2.
  9697
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 187
* ECS010T1.cbl
  9698     MOVE 'CANCEL    '                 TO TRD-AH-ACTION.
  9699     MOVE CR-AH-CURRENT-STATUS         TO TRD-AH-STATUS.
  9700
  9701 0660-PROCESS-CANCEL-CONTINUE.
  9702
  9703     PERFORM 8690-PRINT-DETAIL-LINE THRU 8699-PRT-DETAIL-X.
  9704
  9705     IF CR-POLICY-IS-REIN-ONLY
  9706        GO TO 0660-CONT.
  9707
  9708     MOVE 'Y'                    TO BILLED-SWITCH.
  9709     PERFORM 2200-BUILD-CANCEL-EXTRACT THRU 2299-BLD-CANCEL-X.
  9710
  9711     IF CR-POLICY-IS-MONTHLY
  9712        GO TO 0660-CONT
  9713     END-IF
  9714
  9715     ADD +1                      TO BC-G-CNC.
  9716     ADD +1                      TO BC-COMM.
  9717     SUBTRACT CR-LFRFND FROM BC-NET-WRIT.
  9718     SUBTRACT CR-AHRFND FROM BC-NET-WRIT.
  9719     ADD CR-LFRFND               TO TPL-CNC-PRM (1).
  9720     ADD H-LFCM                  TO TPL-ACCT-COM (1).
  9721     ADD CR-AHRFND               TO TPA-CNC-PRM (1).
  9722     ADD H-AHCM                  TO TPA-ACCT-COM (1).
  9723
  9724     IF  CLAS-I-BAL (CLAS-INDEXL) = 'B'
  9725         SUBTRACT CR-LFRFND FROM BC-NET-WRIT-OB
  9726     ELSE
  9727         SUBTRACT CR-LFRFND FROM BC-NET-WRIT-SP.
  9728
  9729     IF  CLAS-I-BAL (CLAS-INDEXA) = 'B'
  9730         SUBTRACT CR-AHRFND FROM BC-NET-WRIT-OB
  9731     ELSE
  9732         SUBTRACT CR-AHRFND FROM BC-NET-WRIT-SP.
  9733
  9734
  9735 0660-CONT.
  9736
  9737     MOVE MONTHS-DIFF-LF            TO REIN-LCNC-EARN-TERM.
  9738     MOVE MONTHS-DIFF-AH            TO REIN-ACNC-EARN-TERM.
  9739
  9740     IF CR-LFRFND NEGATIVE
  9741       IF CR-LFRFND + LIFE-REFUND = ZEROS
  9742           MOVE '*'                 TO REIN-VOID-LF-SW.
  9743     IF CR-AHRFND NEGATIVE
  9744       IF CR-AHRFND + A-H-REFUND = ZEROS
  9745           MOVE '*'                 TO REIN-VOID-AH-SW.
  9746
  9747     IF CR-LFRFND NOT = ZEROS
  9748       IF CR-LF-CANCEL-EXIT-DATE NOT = EOM-RUN-DATE
  9749           MOVE '*'                 TO REIN-ADDL-LF-SW.
  9750     IF CR-AHRFND NOT = ZEROS
  9751       IF CR-AH-CANCEL-EXIT-DATE NOT = EOM-RUN-DATE
  9752           MOVE '*'                 TO REIN-ADDL-AH-SW.
  9753
  9754     IF CR-DT = CR-LF-CANC-DT
  9755       MOVE '*'                     TO REIN-CANCEL-LF-SW.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 188
* ECS010T1.cbl
  9756     IF CR-DT = CR-AH-CANC-DT
  9757       MOVE '*'                     TO REIN-CANCEL-AH-SW.
  9758
  9759     PERFORM 3200-REINSURE-CANCEL THRU 3299-REINSURE-CANCEL-X.
  9760
  9761     MOVE SPACES                    TO REIN-VOID-LF-SW
  9762                                       REIN-VOID-AH-SW
  9763                                       REIN-ADDL-LF-SW
  9764                                       REIN-ADDL-AH-SW.
  9765
  9766     COMPUTE CR-LFRFND = LIFE-REFUND + PB-C-LF-CANCEL-AMT.
  9767     MOVE LIFE-REFUND-CALC          TO CR-LFRFND-CALC.
  9768
  9769     COMPUTE CR-AHRFND = A-H-REFUND  + PB-C-AH-CANCEL-AMT.
  9770     MOVE A-H-REFUND-CALC           TO CR-AHRFND-CALC.
  9771
  9772     IF (CR-LFTYP NOT = ZERO  AND
  9773        CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'Z')  OR
  9774        (CR-AHTYP NOT = ZERO  AND
  9775        CLAS-I-CALC-TYPE (CLAS-INDEXA) = 'Z')
  9776         ADD PB-C-LIVES                TO CR-SUM-CAN-CNT-ITD
  9777         COMPUTE CR-SUM-CAN-CNT-YTD = YTD-CANCEL-CNT + PB-C-LIVES.
  9778
  9779 0670-LIFE-CANCEL-VOID.
  9780
  9781     IF CR-LFTYP NOT = ZERO  AND
  9782        CR-LFRFND = ZERO  AND
  9783        PB-C-LF-CANCEL-AMT NEGATIVE
  9784         NEXT SENTENCE
  9785     ELSE
  9786         GO TO 0680-A-H-CANCEL-VOID.
  9787
  9788     MOVE ZEROS                        TO CR-LF-CANCEL-EXIT-DATE
  9789                                       WS-CR-LF-CANCEL-EXIT-DATE-N
  9790                                          CR-LF-CANC-DT
  9791                                          WS-CR-LF-CANC-DT-N
  9792                                          CR-LFRFND-CALC.
  9793
  9794     MOVE SPACES                       TO CR-LF-COMM-CHARGEBACK.
  9795
  9796     IF CR-LF-CANCEL-APPLIED
  9797         MOVE CR-LF-STATUS-AT-CANCEL   TO CR-LF-CURRENT-STATUS
  9798         MOVE ' '                      TO CR-LF-STATUS-AT-CANCEL
  9799     ELSE
  9800         MOVE CR-LF-STATUS-AT-CANCEL   TO CR-LF-STATUS-AT-DEATH
  9801         MOVE ' '                      TO CR-LF-STATUS-AT-CANCEL.
  9802
  9803     PERFORM 8600-SETUP-DETAIL-LINE THRU 8689-SETUP-DETAIL-X.
  9804
  9805     MOVE 'VOID CANCL'                 TO TRD-LF-ACTION.
  9806     MOVE CR-LF-CURRENT-STATUS         TO TRD-LF-STATUS.
  9807
  9808     PERFORM 8690-PRINT-DETAIL-LINE THRU 8699-PRT-DETAIL-X.
  9809
  9810 0680-A-H-CANCEL-VOID.
  9811
  9812     IF CR-AHTYP NOT = ZERO  AND
  9813        CR-AHRFND = ZERO  AND
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 189
* ECS010T1.cbl
  9814        PB-C-AH-CANCEL-AMT NEGATIVE
  9815         NEXT SENTENCE
  9816     ELSE
  9817         GO TO 0690-END-CANCEL-PROCESSING.
  9818
  9819     MOVE ZEROS                      TO CR-AH-CANCEL-EXIT-DATE
  9820                                     WS-CR-AH-CANCEL-EXIT-DATE-N
  9821                                        CR-AH-CANC-DT
  9822                                        WS-CR-AH-CANC-DT-N
  9823                                        CR-AHRFND-CALC.
  9824
  9825     MOVE SPACES                        TO CR-AH-COMM-CHARGEBACK.
  9826
  9827     IF CR-AH-CANCEL-APPLIED
  9828         MOVE CR-AH-STATUS-AT-CANCEL    TO CR-AH-CURRENT-STATUS
  9829         MOVE ' '                       TO CR-AH-STATUS-AT-CANCEL
  9830     ELSE
  9831         MOVE CR-AH-STATUS-AT-CANCEL
  9832                                    TO CR-AH-STATUS-AT-SETTLEMENT
  9833         MOVE ' '                       TO CR-AH-STATUS-AT-CANCEL.
  9834
  9835     PERFORM 8600-SETUP-DETAIL-LINE THRU 8689-SETUP-DETAIL-X.
  9836
  9837     MOVE 'VOID CANCL'                  TO TRD-AH-ACTION.
  9838     MOVE CR-AH-CURRENT-STATUS          TO TRD-AH-STATUS.
  9839
  9840     PERFORM 8690-PRINT-DETAIL-LINE THRU 8699-PRT-DETAIL-X.
  9841
  9842 0690-END-CANCEL-PROCESSING.
  9843
  9844     IF CR-LF-CANC-DT = ZEROS  AND
  9845        CR-AH-CANC-DT = ZEROS
  9846         MOVE ZEROS             TO CR-NH-INT-ON-REF
  9847     END-IF
  9848
  9849     IF LIFE-REFUND = ZERO  AND  A-H-REFUND = ZERO
  9850         NEXT SENTENCE
  9851     ELSE
  9852         MOVE 'X'               TO REIN-RT-SW
  9853         PERFORM 3200-REINSURE-CANCEL THRU 3299-REINSURE-CANCEL-X
  9854         MOVE ' '               TO REIN-RT-SW.
  9855
  9856     MOVE '*'                   TO TRANSACTION-FLAG.
  9857     GO TO 0300-READ-PENDING-TRANSACTIONS.
  9858
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 190
* ECS010T1.cbl
  9860******************************************************************
  9861***    P R O C E S S   C L A I M S   T R A N S A C T I O N S   ***
  9862******************************************************************
  9863
  9864 0700-PROCESS-CLAIMS.
  9865
  9866     IF NOT PC-LF-CLAIM  AND  NOT  PC-OB-LF-CLAIM  AND
  9867        NOT PC-AH-CLAIM  AND  NOT  PC-OB-AH-CLAIM
  9868         DISPLAY 'INVALID CLAIM TYPE TO ECS010 '
  9869             PENDING-MATCH-CONTROL
  9870         MOVE 0301 TO WS-ABEND-CODE
  9871         DISPLAY '******************************'
  9872         DISPLAY '***** ERROR LOCATION 011 *****'
  9873         DISPLAY '******************************'
  9874         MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
  9875         GO TO ABEND-PGM.
  9876
  9877     PERFORM 3000-REINSURE-ROUTINE THRU 3099-REINSURE-ROUTINE-X.
  9878
  9879     ADD +1                       TO  W-LF-CLAIMS.
  9880
  9881     MOVE PC-INCURRED-DT          TO  DC-BIN-DATE-1.
  9882     MOVE ' '                     TO  DC-OPTION-CODE.
  9883     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
  9884     MOVE DC-GREG-DATE-CYMD       TO  INCURRED-DATE.
  9885
  9886     MOVE PC-REPORTED-DT          TO  DC-BIN-DATE-1.
  9887     MOVE ' '                     TO  DC-OPTION-CODE.
  9888     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
  9889     MOVE DC-GREG-DATE-1-YMD      TO  REPORTED-DATE.
  9890
  9891     MOVE PC-PAYMENT-DT           TO  DC-BIN-DATE-1.
  9892     MOVE ' '                     TO  DC-OPTION-CODE.
  9893     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
  9894     MOVE DC-GREG-DATE-CYMD       TO  PAYMENT-DATE.
  9895
  9896     MOVE PC-PAID-THRU-DT         TO  DC-BIN-DATE-1.
  9897     MOVE ' '                     TO  DC-OPTION-CODE.
  9898     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
  9899     MOVE DC-GREG-DATE-CYMD       TO  PAY-TO-DATE.
  9900
  9901     PERFORM 8600-SETUP-DETAIL-LINE THRU 8689-SETUP-DETAIL-X.
  9902
  9903     IF DTE-CLIENT = 'LAP'  OR  'RMC'
  9904       MOVE PC-CHECK-NO            TO WS-CHECK-NUMBER
  9905       IF WS-CHECK-NO = 'DEDU'  OR  ' DED'  OR  '0DED'
  9906         IF CR-CLAIM-DEDUCT-WITHHELD = +99999.99
  9907             MOVE PC-CLAIM-PAYMENT TO CR-CLAIM-DEDUCT-WITHHELD
  9908         ELSE
  9909             ADD PC-CLAIM-PAYMENT  TO CR-CLAIM-DEDUCT-WITHHELD.
  9910
  9911     IF PC-AH-CLAIM  OR  PC-OB-AH-CLAIM
  9912         GO TO 0750-PROCESS-DISABILITY-CLAIM.
  9913
  9914******************************************************************
  9915***           P R O C E S S   D E A T H   C L A I M            ***
  9916******************************************************************
  9917
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 191
* ECS010T1.cbl
  9918     IF REIN-IS-RISK-PREMIUM
  9919       IF CR-DTH-DT = ZEROS
  9920           MOVE INCURRED-DATE      TO DC-GREG-DATE-CYMD
  9921           PERFORM 3025-CALC-ELAPSED-MONTHS THRU 3026-CALC-EXIT
  9922           MOVE DC-ELAPSED-MONTHS  TO REIN-LF-CLM-MONTHS.
  9923
  9924     MOVE INCURRED-DATE            TO CR-DTH-DT
  9925                                      WS-CR-DTH-DT-N.
  9926
  9927     IF PC-CHARGEBLE-EXPENSE  OR
  9928        PC-NON-CHARGEBLE-EXPENSE
  9929         IF CR-LFTYP = '00'
  9930             MOVE '99'             TO CR-LFTYP  CLAS-LOOK
  9931             PERFORM 8300-LIFE-TYPE-LOOKUP THRU
  9932                     8399-LIFE-LOOKUP-X.
  9933
  9934     IF PC-CHARGEBLE-EXPENSE  OR
  9935        PC-NON-CHARGEBLE-EXPENSE
  9936         ADD PC-CLAIM-PAYMENT      TO CR-DTHEXP
  9937         ADD PC-CLAIM-PAYMENT      TO CR-DTHEXP-YTD
  9938         ADD PC-CLAIM-PAYMENT      TO TPL-CLAIMS (1)
  9939         MOVE PC-CLAIM-PAYMENT     TO TRD-LFCOM-CLM
  9940         MOVE 'CLAIM EXP '         TO TRD-LF-ACTION
  9941         GO TO 0780-END-CLAIMS-PROCESSING.
  9942
  9943     ADD +1                       TO  CR-NUM-DTH-CLM.
  9944     MOVE REPORTED-DATE           TO  CR-DTH-RPT-DT.
  9945     MOVE PAYMENT-DATE            TO  CR-DTH-PAY-DT
  9946                                      WS-CR-DTH-PAY-DT-N.
  9947
  9948     ADD PC-CLAIM-PAYMENT         TO  CR-DTHAMT.
  9949     ADD PC-CLAIM-PAYMENT         TO  CR-DTHAMT-YTD.
  9950     MOVE PC-CLAIM-PAYMENT        TO  CR-DTHAMT-LAST.
  9951     MOVE PC-AGE-AT-CLAIM         TO  CR-DTH-AGE.
  9952     IF CR-DTH-PAY-CD NOT = 'F'
  9953         MOVE PC-PAYMENT-TYPE     TO  CR-DTH-PAY-CD.
  9954     INSPECT CR-DTH-PAY-CD
  9955         CONVERTING '12349' TO 'PFSXV'.
  9956     MOVE PC-CAUSE-CODE           TO  CR-DEATH-CAUSE.
  9957
  9958     IF (LIFE-OVERRIDE-L1 EQUAL 'P'  OR
  9959         CLAS-I-RL-AH (CLAS-INDEXL) EQUAL 'P')
  9960       AND
  9961       (CR-DTHAMT LESS THAN (CR-LFAMT + CR-LFAMT-ALT)
  9962       OR
  9963        DTE-CLIENT = 'ACC' OR 'FDL')
  9964        NEXT SENTENCE
  9965     ELSE
  9966     IF (CLAS-I-CALC-TYPE (CLAS-INDEXL) NOT = 'Z')
  9967         IF CR-LF-CLAIM-EXIT-DATE = ZEROS
  9968             MOVE CR-LF-CURRENT-STATUS TO CR-LF-STATUS-AT-DEATH
  9969             MOVE '7'            TO CR-LF-CURRENT-STATUS
  9970             MOVE EOM-RUN-DATE   TO CR-LF-CLAIM-EXIT-DATE
  9971                                    WS-CR-LF-CLAIM-EXIT-DATE-N.
  9972
  9973     MOVE CLAS-I-AB3 (CLAS-INDEXL)     TO TRD-LFTYP.
  9974     MOVE CR-LF-TERM                   TO TRD-LFTRM.
  9975     MOVE PC-CLAIM-PAYMENT        TO  TRD-LFCOM-CLM.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 192
* ECS010T1.cbl
  9976     IF CLAS-I-RL-AH (CLAS-INDEXL) = 'P'
  9977         MOVE 'PROPERTY  '       TO TRD-LF-ACTION
  9978     ELSE
  9979         MOVE 'CLAIM PYMT'       TO TRD-LF-ACTION.
  9980     MOVE CR-LF-CURRENT-STATUS   TO TRD-LF-STATUS.
  9981
  9982     IF NOT CR-POLICY-IS-REIN-ONLY
  9983         ADD PC-CLAIM-PAYMENT    TO TPL-CLAIMS (1).
  9984
  9985 0720-CANCEL-AH-COVERAGE.
  9986
  9987     IF CR-AHTYP = ZEROS  OR
  9988        NOT CR-AH-POLICY-IS-ACTIVE
  9989         GO TO 0740-DEATH-CLAIM-VOID.
  9990
  9991     MOVE CR-AH-CURRENT-STATUS          TO CR-AH-STATUS-AT-CANCEL.
  9992     MOVE '7'                           TO CR-AH-CURRENT-STATUS.
  9993     MOVE CR-DTH-DT                     TO CR-AH-CANC-DT
  9994                                           WS-CR-AH-CANC-DT-N.
  9995     MOVE EOM-RUN-DATE               TO CR-AH-CANCEL-EXIT-DATE
  9996                                     WS-CR-AH-CANCEL-EXIT-DATE-N.
  9997
  9998     MOVE CLAS-I-AB3 (CLAS-INDEXA)      TO TRD-AHTYP.
  9999     MOVE CR-AH-TERM                    TO TRD-AHTRM.
 10000     MOVE CR-DTH-MO                     TO TRD-AHACTMO.
 10001     MOVE CR-DTH-DA                     TO TRD-AHACTDA.
 10002     MOVE CR-DTH-YR                     TO TRD-AHACTYR.
 10003     MOVE '/'                           TO TRD-AH-S1  TRD-AH-S2.
 10004     MOVE 'CLAIM CANC'                  TO TRD-AH-ACTION.
 10005     MOVE CR-AH-CURRENT-STATUS          TO TRD-AH-STATUS.
 10006
 10007 0740-DEATH-CLAIM-VOID.
 10008
 10009     IF CR-DTHAMT = ZERO  AND
 10010        PC-CLAIM-PAYMENT NEGATIVE
 10011         NEXT SENTENCE
 10012     ELSE
 10013         GO TO 0780-END-CLAIMS-PROCESSING.
 10014
 10015     MOVE '*'                           TO DEATH-VOID-FLAG.
 10016
 10017     MOVE ZEROS                         TO CR-LF-CLAIM-EXIT-DATE
 10018                                        WS-CR-LF-CLAIM-EXIT-DATE-N
 10019                                           CR-NUM-DTH-CLM
 10020                                           CR-DTH-RPT-DT
 10021                                           CR-DTH-PAY-DT
 10022                                           WS-CR-DTH-PAY-DT-N
 10023*                                          CR-DTHAMT-YTD
 10024*                                          CR-DTHAMT-LAST
 10025                                           CR-DTH-AGE.
 10026     MOVE ' '                           TO CR-DTH-PAY-CD.
 10027
 10028     IF CR-LF-DEATH-CLAIM-APPLIED
 10029         MOVE CR-LF-STATUS-AT-DEATH     TO CR-LF-CURRENT-STATUS
 10030         MOVE ' '                       TO CR-LF-STATUS-AT-DEATH
 10031     ELSE
 10032         MOVE CR-LF-STATUS-AT-DEATH     TO CR-LF-STATUS-AT-CANCEL
 10033         MOVE ' '                       TO CR-LF-STATUS-AT-DEATH.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 193
* ECS010T1.cbl
 10034
 10035     MOVE 'VOID CLAIM'                  TO TRD-LF-ACTION.
 10036     MOVE CR-LF-CURRENT-STATUS          TO TRD-LF-STATUS.
 10037
 10038     IF CR-AH-DEATH-CLAIM-APPLIED
 10039         MOVE CR-AH-STATUS-AT-CANCEL    TO CR-AH-CURRENT-STATUS
 10040         MOVE ' '                       TO CR-AH-STATUS-AT-CANCEL
 10041         MOVE ZEROS                     TO CR-AH-CANC-DT
 10042                                           WS-CR-AH-CANC-DT-N
 10043                                           CR-AH-CANCEL-EXIT-DATE
 10044                                       WS-CR-AH-CANCEL-EXIT-DATE-N
 10045         MOVE CLAS-I-AB3 (CLAS-INDEXA)  TO TRD-AHTYP
 10046         MOVE CR-AH-TERM                TO TRD-AHTRM
 10047         MOVE 'VOID CANCL'              TO TRD-AH-ACTION
 10048         MOVE CR-AH-CURRENT-STATUS      TO TRD-AH-STATUS.
 10049
 10050     GO TO 0780-END-CLAIMS-PROCESSING.
 10051
 10052******************************************************************
 10053***       P R O C E S S   D I S A B I L I T Y   C L A I M      ***
 10054******************************************************************
 10055
 10056 0750-PROCESS-DISABILITY-CLAIM.
 10057
 10058     ADD +1                       TO W-AH-CLAIMS.
 10059
 10060     MOVE INCURRED-DATE           TO CR-DIS-DT
 10061                                     WS-CR-DIS-DT-N.
 10062
 10063     PERFORM 0790-TABLE-DISAB-PERIODS THRU 0791-TABLE-AH-EXIT.
 10064
 10065     IF REIN-AH-CLM-MONTHS = +1
 10066         MOVE REIN-AH-CLM-MTH-1        TO REIN-AH-CLM-MONTHS
 10067     ELSE
 10068       IF REIN-AH-CLM-MONTHS = +2
 10069           MOVE REIN-AH-CLM-MTH-2      TO REIN-AH-CLM-MONTHS
 10070       ELSE
 10071         IF REIN-AH-CLM-MONTHS = +3
 10072             MOVE REIN-AH-CLM-MTH-3    TO REIN-AH-CLM-MONTHS
 10073         ELSE
 10074           IF REIN-AH-CLM-MONTHS = +4
 10075               MOVE REIN-AH-CLM-MTH-4  TO REIN-AH-CLM-MONTHS
 10076           ELSE
 10077               MOVE REIN-AH-CLM-MTH-5  TO REIN-AH-CLM-MONTHS.
 10078
 10079     IF PC-CHARGEBLE-EXPENSE  OR
 10080        PC-NON-CHARGEBLE-EXPENSE
 10081         IF CR-AHTYP = '00'
 10082             MOVE '99'             TO CR-AHTYP  CLAS-LOOK
 10083             PERFORM 8400-A-H-TYPE-LOOKUP THRU
 10084                     8499-A-H-LOOKUP-X.
 10085
 10086     IF PC-CHARGEBLE-EXPENSE  OR
 10087        PC-NON-CHARGEBLE-EXPENSE
 10088         ADD PC-CLAIM-PAYMENT      TO CR-DISEXP
 10089         ADD PC-CLAIM-PAYMENT      TO CR-DISEXP-YTD
 10090         ADD PC-CLAIM-PAYMENT      TO TPA-CLAIMS (1)
 10091         MOVE PC-CLAIM-PAYMENT     TO TRD-AHCOM-CLM
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 194
* ECS010T1.cbl
 10092         MOVE 'CLAIM EXP '         TO TRD-AH-ACTION
 10093         GO TO 0780-END-CLAIMS-PROCESSING.
 10094
 10095     ADD +1                       TO CR-NUM-DIS-CLM.
 10096
 10097     MOVE REPORTED-DATE           TO  CR-DIS-RPT-DT.
 10098     MOVE PAYMENT-DATE            TO  CR-DIS-PAY-DT
 10099                                      WS-CR-DIS-PAY-DT-N.
 10100     MOVE PAY-TO-DATE             TO  CR-DIS-PTO-DT
 10101                                      WS-CR-DIS-PTO-DT-N.
 10102
 10103     ADD  PC-CLAIM-PAYMENT         TO CR-DISAMT.
 10104     ADD  PC-CLAIM-PAYMENT         TO CR-DISAMT-YTD.
 10105     MOVE PC-CLAIM-PAYMENT         TO CR-DISAMT-LAST.
 10106
 10107     MOVE PC-NO-OF-DAYS-PAID       TO CR-DAYS-DISAB.
 10108     IF CR-DIS-PAY-CD NOT = 'S'
 10109         MOVE PC-PAYMENT-TYPE      TO CR-DIS-PAY-CD.
 10110     INSPECT CR-DIS-PAY-CD
 10111         CONVERTING '12349' TO 'PFSXV'.
 10112     MOVE PC-CAUSE-CODE            TO CR-DISAB-CAUSE.
 10113
 10114     IF PC-LUMP-SUM-PAYMENT
 10115         IF CR-AH-SETTLEMENT-EXIT-DATE = ZEROS
 10116           MOVE CR-AH-CURRENT-STATUS TO CR-AH-STATUS-AT-SETTLEMENT
 10117           MOVE '6'                  TO CR-AH-CURRENT-STATUS
 10118           MOVE EOM-RUN-DATE    TO CR-AH-SETTLEMENT-EXIT-DATE
 10119                                   WS-CR-AH-SETTLEMENT-EXIT-DATEN.
 10120
 10121     MOVE CLAS-I-AB3 (CLAS-INDEXA) TO TRD-AHTYP.
 10122     MOVE CR-AH-TERM               TO TRD-AHTRM.
 10123     MOVE PC-CLAIM-PAYMENT         TO TRD-AHCOM-CLM.
 10124     MOVE 'CLAIM PYMT'             TO TRD-AH-ACTION.
 10125     MOVE CR-AH-CURRENT-STATUS     TO TRD-AH-STATUS.
 10126
 10127     IF NOT CR-POLICY-IS-REIN-ONLY
 10128         ADD PC-CLAIM-PAYMENT      TO TPA-CLAIMS (1).
 10129
 10130     IF NOT PC-LUMP-SUM-PAYMENT
 10131         GO TO 0780-END-CLAIMS-PROCESSING.
 10132
 10133 0770-CANCEL-LF-COVERAGE.
 10134
 10135     IF CR-LFTYP = ZEROS  OR
 10136        NOT CR-LF-POLICY-IS-ACTIVE
 10137         GO TO 0780-END-CLAIMS-PROCESSING.
 10138
 10139     MOVE CR-LF-CURRENT-STATUS          TO CR-LF-STATUS-AT-CANCEL.
 10140     MOVE '6'                           TO CR-LF-CURRENT-STATUS.
 10141     MOVE CR-DIS-PAY-DT                 TO CR-LF-CANC-DT
 10142                                           WS-CR-LF-CANC-DT-N.
 10143     MOVE EOM-RUN-DATE               TO CR-LF-CANCEL-EXIT-DATE
 10144                                     WS-CR-LF-CANCEL-EXIT-DATE-N.
 10145
 10146     MOVE CLAS-I-AB3 (CLAS-INDEXL)      TO TRD-LFTYP.
 10147     MOVE CR-LF-TERM                    TO TRD-LFTRM.
 10148     MOVE CR-DIS-PAY-MO                 TO TRD-LFACTMO.
 10149     MOVE CR-DIS-PAY-DA                 TO TRD-LFACTDA.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 195
* ECS010T1.cbl
 10150     MOVE CR-DIS-PAY-YR                 TO TRD-LFACTYR.
 10151     MOVE '/'                           TO TRD-LF-S1  TRD-LF-S2.
 10152     MOVE 'CLAIM CANC'                  TO TRD-LF-ACTION.
 10153     MOVE CR-LF-CURRENT-STATUS          TO TRD-LF-STATUS.
 10154
 10155 0780-END-CLAIMS-PROCESSING.
 10156
 10157     IF PC-LF-CLAIM  OR  PC-OB-LF-CLAIM
 10158         MOVE DTO-MO               TO TRD-LFACTMO
 10159         MOVE DTO-DA               TO TRD-LFACTDA
 10160         MOVE DTO-YR               TO TRD-LFACTYR
 10161         MOVE '/'                  TO TRD-LF-S1  TRD-LF-S2
 10162     ELSE
 10163         MOVE PAY-MO               TO TRD-AHACTMO
 10164         MOVE PAY-DA               TO TRD-AHACTDA
 10165         MOVE PAY-YR               TO TRD-AHACTYR
 10166         MOVE '/'                  TO TRD-AH-S1  TRD-AH-S2.
 10167
 10168     PERFORM 8690-PRINT-DETAIL-LINE THRU 8699-PRT-DETAIL-X.
 10169
 10170     IF NOT CR-POLICY-IS-REIN-ONLY
 10171         PERFORM 2300-BUILD-CLAIM-EXTRACT THRU 2399-BLD-CLAIM-X
 10172         ADD +1                    TO BC-G-CLM.
 10173
 10174     PERFORM 3300-REINSURE-CLAIM THRU 3399-REINSURE-CLAIM-X.
 10175
 10176     IF DEATH-CLAIM-VOIDED
 10177         MOVE ZEROS                TO CR-DTH-DT
 10178                                      WS-CR-DTH-DT-N.
 10179     MOVE SPACE                    TO DEATH-VOID-FLAG.
 10180
 10181     MOVE '*'                      TO TRANSACTION-FLAG.
 10182     GO TO 0300-READ-PENDING-TRANSACTIONS.
 10183
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 196
* ECS010T1.cbl
 10185 0790-TABLE-DISAB-PERIODS.
 10186
 10187     MOVE +1                       TO SUB14.
 10188     PERFORM 0794-REVIEW-TABLE     THRU 0794-REVIEW-TABLE-EXIT.
 10189
 10190     MOVE +1                       TO SUB14.
 10191
 10192**************************************************************
 10193**                                                          **
 10194**   THIS ROUTINE SEARCHES THROUGH THE DISAB-DETAIL-DATA    **
 10195**  AND MATCHES INCURRED DATE.  IT THEN ADDS THE AMOUNT OF  **
 10196**  THE CLAIM TO THAT OCCURRENCE.  IF THE INCURRED DATE     **
 10197**  DOES NOT MATCH ANY PREVIOUS INCURRED DATE,  IT WILL     **
 10198**  INITIALIZE THE NEXT OCCURRENCE.  (OLDEST TO MOST RECENT)**
 10199**                                                          **
 10200**    IF ALL 5 OCCURRENCES ARE FILLED,  THE TWO OLDEST      **
 10201**  AMOUNTS ARE COMBINED LEAVING THE LAST OCCURRENCE OPEN   **
 10202**  FOR THE MOST RECENT CLAIM INFORMATION.                  **
 10203**                                                          **
 10204**************************************************************
 10205
 10206 0791-TABLE-AH-AMOUNT.
 10207
 10208     IF SUB14 GREATER THAN DISABILITY-TBL-MAX
 10209         PERFORM 0792-MOVE-TABLE  THRU 0792-MOVE-TABLE-EXIT.
 10210
 10211     IF CR-DIS-INCUR-DT (SUB14)  EQUAL ZEROS
 10212         MOVE INCURRED-DATE        TO CR-DIS-INCUR-DT (SUB14)
 10213                                      WS-CR-DIS-INCUR-DT-N (SUB14)
 10214         IF REIN-IS-RISK-PREMIUM
 10215             MOVE INCURRED-DATE     TO DC-GREG-DATE-CYMD
 10216             PERFORM 3025-CALC-ELAPSED-MONTHS THRU 3026-CALC-EXIT
 10217             IF SUB14 = +1
 10218               MOVE DC-ELAPSED-MONTHS TO REIN-AH-CLM-MTH-1
 10219             ELSE
 10220             IF SUB14 = +2
 10221               MOVE DC-ELAPSED-MONTHS TO REIN-AH-CLM-MTH-2
 10222             ELSE
 10223             IF SUB14 = +3
 10224               MOVE DC-ELAPSED-MONTHS TO REIN-AH-CLM-MTH-3
 10225             ELSE
 10226             IF SUB14 = +4
 10227               MOVE DC-ELAPSED-MONTHS TO REIN-AH-CLM-MTH-4
 10228             ELSE
 10229               MOVE DC-ELAPSED-MONTHS TO REIN-AH-CLM-MTH-5.
 10230
 10231
 10232     IF INCURRED-DATE EQUAL CR-DIS-INCUR-DT (SUB14)
 10233         MOVE SUB14                TO REIN-AH-CLM-MONTHS
 10234         COMPUTE REIN-AH-PRIOR-CLMS-PAID = CR-INCUR-DISAMT (SUB14)
 10235                                        +  CR-INCUR-DISEXP (SUB14)
 10236         IF PC-CHARGEBLE-EXPENSE  OR
 10237            PC-NON-CHARGEBLE-EXPENSE
 10238             ADD PC-CLAIM-PAYMENT  TO CR-INCUR-DISEXP (SUB14)
 10239             GO TO 0791-TABLE-AH-EXIT
 10240         ELSE
 10241             ADD  PC-CLAIM-PAYMENT TO CR-INCUR-DISAMT (SUB14)
 10242             GO TO 0791-TABLE-AH-EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 197
* ECS010T1.cbl
 10243
 10244     ADD +1                       TO SUB14.
 10245
 10246     GO TO 0791-TABLE-AH-AMOUNT.
 10247
 10248 0791-TABLE-AH-EXIT.
 10249     EXIT.
 10250
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 198
* ECS010T1.cbl
 10252**************************************************************
 10253**                                                          **
 10254** THIS ROUTINE IS PERFORMED WHEN THERE HAVE BEEN MORE THAN **
 10255** 5 DISABILITY PERIODS ATTACHED TO THE SAME CERTIFICATE.   **
 10256**                                                          **
 10257** THE SECOND OCCURRENCE IS ADDED TO THE 1ST OCCURRENCE     **
 10258** COMBINING THE TWO OLDEST OCCURRENCES INTO ONE BUCKET     **
 10259** THE NEWEST CLAIM INFORMATION IS MOVED INTO THE LAST      **
 10260** OCCURRENCE.                                              **
 10261**************************************************************
 10262 0792-MOVE-TABLE.
 10263
 10264     MOVE CR-DIS-INCUR-DT (2)  TO CR-DIS-INCUR-DT (1)
 10265                                  WS-CR-DIS-INCUR-DT-N (1).
 10266     ADD  CR-INCUR-DISAMT (2)  TO CR-INCUR-DISAMT (1).
 10267     ADD  CR-INCUR-DISEXP (2)  TO CR-INCUR-DISEXP (1).
 10268
 10269     MOVE +2                   TO SUB14.
 10270     MOVE +3                   TO SUB15.
 10271     PERFORM 0794A-BUMP-TBL    THRU 0794A-BUMP-TBL-EXIT.
 10272
 10273     MOVE DISABILITY-TBL-MAX   TO SUB14.
 10274
 10275     MOVE INCURRED-DATE        TO CR-DIS-INCUR-DT (SUB14)
 10276                                  WS-CR-DIS-INCUR-DT-N (SUB14).
 10277
 10278 0792-MOVE-TABLE-EXIT.
 10279     EXIT.
 10280
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 199
* ECS010T1.cbl
 10282**************************************************************
 10283**                                                          **
 10284**  A REVIEW OF ALL OCCURRENCES IS PERFORMED TO ELIMINATE   **
 10285** ANY WITH NO PAYMENTS OR EXPENSES ATTACHED. THESE CAN     **
 10286** OCCUR WHEN DISABILITY PAYMENTS HAVE BEEN VOIDED, BECAUSE **
 10287** CLAIM ATTACHED TO WRONG CERTIFICATE, OR WRONG CLAIM TYPE **
 10288** PAID, OR A CHANGE IN THE INCURRED DATE OF A CLAIM.       **
 10289**************************************************************
 10290
 10291 0794-REVIEW-TABLE.
 10292
 10293     IF SUB14 GREATER THAN DISABILITY-TBL-MAX
 10294         GO TO 0794-REVIEW-TABLE-EXIT.
 10295
 10296     IF CR-DIS-INCUR-DT (SUB14) EQUAL ZEROS
 10297         GO TO 0794-REVIEW-TABLE-EXIT.
 10298
 10299     IF CR-INCUR-DISAMT (SUB14) EQUAL ZEROS  AND
 10300        CR-INCUR-DISEXP (SUB14) EQUAL ZEROS
 10301         DISPLAY CR-ACCOUNT ' ' CR-CERT-NO ' ' SUB14
 10302         MOVE ZEROS            TO CR-DIS-INCUR-DT (SUB14)
 10303                                  WS-CR-DIS-INCUR-DT-N (SUB14)
 10304         MOVE SUB14            TO SUB15
 10305         ADD +1                TO SUB15
 10306         PERFORM 0794A-BUMP-TBL   THRU 0794A-BUMP-TBL-EXIT
 10307         MOVE +1               TO SUB14
 10308         GO TO 0794-REVIEW-TABLE.
 10309
 10310     ADD +1                    TO SUB14.
 10311
 10312     GO TO 0794-REVIEW-TABLE.
 10313
 10314 0794-REVIEW-TABLE-EXIT.
 10315     EXIT.
 10316
 10317 0794A-BUMP-TBL.
 10318
 10319     IF SUB15 GREATER THAN DISABILITY-TBL-MAX
 10320         GO TO 0794A-BUMP-TBL-EXIT.
 10321
 10322     MOVE CR-DISAB-DETAIL-DATA (SUB15)  TO
 10323                             CR-DISAB-DETAIL-DATA (SUB14).
 10324
 10325     MOVE ZEROS                TO CR-DIS-INCUR-DT (SUB15)
 10326                                  WS-CR-DIS-INCUR-DT-N (SUB15)
 10327                                  CR-INCUR-DISAMT (SUB15)
 10328                                  CR-INCUR-DISEXP (SUB15).
 10329
 10330     ADD +1                    TO SUB14
 10331                                  SUB15.
 10332     GO TO 0794A-BUMP-TBL.
 10333
 10334 0794A-BUMP-TBL-EXIT.
 10335     EXIT.
 10336
 10337 0795-DCC-NSP-LF.
 10338
 10339     MOVE CR-DT                      TO DC-GREG-DATE-CYMD.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 200
* ECS010T1.cbl
 10340     MOVE 'L'                        TO DC-OPTION-CODE.
 10341     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 10342     MOVE DC-BIN-DATE-1              TO CP-CERT-EFF-DT.
 10343     MOVE SPACES                     TO CP-ACCT-FLD-5.
 10344     MOVE DTE-CLIENT                 TO CP-COMPANY-ID.
 10345     MOVE CR-AGE                     TO CP-ISSUE-AGE.
 10346     MOVE CR-APR                     TO CP-LOAN-APR.
 10347     MOVE CR-PMT-FREQ                TO CP-PAY-FREQUENCY.
 10348     MOVE CR-LOAN-TERM               TO CP-LOAN-TERM.
 10349     MOVE ZEROS                      TO CP-DEVIATION-CODE.
 10350     MOVE CR-RATING-CLASS            TO CP-CLASS-CODE.
 10351
 10352     MOVE '3'                        TO CP-PROCESS-TYPE.
 10353     MOVE DTE-CLASIC-COMPANY-CD      TO CP-COMPANY-CD.
 10354     MOVE CR-PMT-EXTENSION-DAYS      TO CP-TERM-OR-EXT-DAYS.
 10355
 10356     IF CR-LFTYP = ZERO
 10357         GO TO 0795-EXIT
 10358     END-IF
 10359
 10360     IF (CLAS-I-BAL (CLAS-INDEXL) = 'B')
 10361         GO TO 0795-EXIT
 10362     END-IF
 10363     MOVE CR-LFPRM                   TO CP-ORIGINAL-PREMIUM
 10364     MOVE CLAS-I-RL-AH (CLAS-INDEXL) TO CP-BENEFIT-TYPE.
 10365     MOVE CR-LF-TERM                 TO CP-ORIGINAL-TERM.
 10366     MOVE CR-LFAMT                   TO CP-ORIGINAL-BENEFIT
 10367                                        CP-RATING-BENEFIT-AMT.
 10368     MOVE CLAS-I-EP (CLAS-INDEXL)    TO CP-EARNING-METHOD.
 10369     MOVE CLAS-I-BAL (CLAS-INDEXL)   TO CP-SPECIAL-CALC-CD.
 10370     MOVE CR-LFTYP                   TO CP-BENEFIT-CD.
 10371     MOVE LIFE-OVERRIDE-L1           TO CP-LIFE-OVERRIDE-CODE.
 10372     MOVE ZEROS                      TO CP-RATE-DEV-PCT.
 10373     MOVE CR-STATE                   TO CP-STATE.
 10374     MOVE STATE-ABBR (CLAS-INDEXS)   TO CP-STATE-STD-ABBRV.
 10375
 10376     IF CP-STATE-STD-ABBRV = 'OR'
 10377         COMPUTE CP-RATING-BENEFIT-AMT = CR-LFAMT + CR-LFAMT-ALT.
 10378
 10379     PERFORM 8100-GET-RATE THRU 8199-GET-RATE-X.
 10380
 10381     IF CP-ERROR-RATE-NOT-FOUND  OR
 10382        CP-ERROR-RATE-IS-ZERO
 10383         MOVE 'LIFE NET SINGLE PREMIUM RATE NOT FOUND'
 10384                                     TO WS-ABEND-MESSAGE
 10385         MOVE 0302                   TO WS-ABEND-CODE
 10386         DISPLAY '******************************'
 10387         DISPLAY '***** ERROR LOCATION 018 *****'
 10388         DISPLAY '******************************'
 10389         MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
 10390         GO TO ABEND-PGM.
 10391
 10392     MOVE CP-CALC-PREMIUM          TO CR-LF-NSP-PRM.
 10393
 10394*    COMPUTE CR-LF-NSP-PRM ROUNDED =
 10395*                      (CR-LFAMT / 100) * CP-PREMIUM-RATE.
 10396
 10397     COMPUTE CR-LF-NSP-PRM ROUNDED =  CR-LF-NSP-PRM +
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 201
* ECS010T1.cbl
 10398                   ((CR-LFAMT-ALT / 100) * CP-PREMIUM-RATE).
 10399
 10400     MOVE CP-PREMIUM-RATE            TO CR-LF-NSP-PRM-RATE.
 10401
 10402 0795-exit.
 10403     exit.
 10404
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 202
* ECS010T1.cbl
 10406******************************************************************
 10407***   P R O C E S S   R E S E R V E   T R A N S A C T I O N S  ***
 10408******************************************************************
 10409
 10410 0800-PROCESS-RESERVES.
 10411
 10412     IF PC-AH-CLAIM  OR  PC-OB-AH-CLAIM
 10413       IF CARRIER-UEP-PCT (CLAS-INDEXCN) NOT = ZEROS
 10414           MOVE ZEROS             TO  PC-IBNR-RESERVE-AMT.
 10415
 10416     PERFORM 3000-REINSURE-ROUTINE THRU 3099-REINSURE-ROUTINE-X.
 10417
 10418     MOVE PC-INCURRED-DT          TO  DC-BIN-DATE-1.
 10419     MOVE ' '                     TO  DC-OPTION-CODE.
 10420     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 10421     MOVE DC-GREG-DATE-CYMD       TO  INCURRED-DATE.
 10422
 10423     MOVE PC-REPORTED-DT          TO  DC-BIN-DATE-1.
 10424     MOVE ' '                     TO  DC-OPTION-CODE.
 10425     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 10426     MOVE DC-GREG-DATE-1-YMD      TO  REPORTED-DATE.
 10427
 10428     MOVE PC-PAID-THRU-DT         TO  DC-BIN-DATE-1.
 10429     MOVE ' '                     TO  DC-OPTION-CODE.
 10430     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 10431     MOVE DC-GREG-DATE-CYMD       TO  PAY-TO-DATE.
 10432
 10433     PERFORM 8600-SETUP-DETAIL-LINE THRU 8689-SETUP-DETAIL-X.
 10434
 10435     IF PC-LF-CLAIM  OR  PC-OB-LF-CLAIM
 10436         ADD +1                     TO W-LF-RESERVES
 10437         ADD PC-IBNR-RESERVE-AMT    TO DTH-IBNR
 10438         ADD PC-PTC-RESERVE-AMT     TO DTH-PAYCUR
 10439         ADD PC-FUTURE-RESERVE-AMT  TO DTH-FUTRSV
 10440         ADD PC-MANUAL-RESERVE-AMT  TO DTH-FUTRSV
 10441         MOVE INCURRED-DATE         TO CR-DTH-DT
 10442                                       WS-CR-DTH-DT-N
 10443         MOVE LIFE-OVERRIDE-L6      TO TRD-RSV-DESC
 10444
 10445     ELSE
 10446         ADD +1                     TO W-AH-RESERVES
 10447         ADD PC-IBNR-RESERVE-AMT    TO DIS-IBNR
 10448         ADD PC-PTC-RESERVE-AMT     TO DIS-PAYCUR
 10449         ADD PC-FUTURE-RESERVE-AMT  TO DIS-FUTRSV
 10450         ADD PC-MANUAL-RESERVE-AMT  TO DIS-FUTRSV
 10451         MOVE INCURRED-DATE         TO CR-DIS-DT
 10452                                       WS-CR-DIS-DT-N
 10453         MOVE AH-OVERRIDE-L6        TO TRD-RSV-DESC.
 10454
 10455     MOVE PC-IBNR-RESERVE-AMT       TO TRD-IBNR.
 10456     MOVE 'IBNR'                    TO TRD-IBNRX.
 10457     MOVE PC-PTC-RESERVE-AMT        TO TRD-PAYCUR.
 10458     MOVE 'PAY CURR'                TO TRD-PAYCURX.
 10459     COMPUTE TRD-FUTRSV EQUAL
 10460            (PC-FUTURE-RESERVE-AMT + PC-MANUAL-RESERVE-AMT).
 10461     MOVE 'FUTURE'                  TO TRD-FUTRSVX.
 10462     MOVE ' CLAIM RESERVES      '   TO TRD-RSV-ACTION.
 10463
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 203
* ECS010T1.cbl
 10464 0820-END-RESERVE-PROCESSING.
 10465
 10466     PERFORM 8690-PRINT-DETAIL-LINE THRU 8699-PRT-DETAIL-X.
 10467
 10468     IF NOT CR-POLICY-IS-REIN-ONLY
 10469         PERFORM 2400-BUILD-RESERVE-EXTRACT THRU
 10470                                            2499-BLD-RESERVE-X
 10471         ADD +1 TO BC-G-CRS.
 10472
 10473     PERFORM 3400-REINSURE-RESERVE THRU 3499-REINSURE-RESERVE-X.
 10474
 10475     MOVE '*'                    TO TRANSACTION-FLAG.
 10476     GO TO 0300-READ-PENDING-TRANSACTIONS.
 10477
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 204
* ECS010T1.cbl
 10479******************************************************************
 10480***    P R O C E S S   C H A N G E   T R A N S A C T I O N S   ***
 10481******************************************************************
 10482
 10483 0900-PROCESS-CERT-CHANGES.
 10484
 10485     PERFORM 8600-SETUP-DETAIL-LINE THRU 8689-SETUP-DETAIL-X.
 10486
 10487     IF CC-AGE NOT NUMERIC  OR
 10488        CC-AGE = CR-AGE
 10489         MOVE ZEROS TO CC-AGE.
 10490
 10491     IF CC-INSURED-JOINT-AGE NOT NUMERIC  OR
 10492        CC-INSURED-JOINT-AGE = CR-JOINT-AGE
 10493         MOVE ZEROS TO CC-INSURED-JOINT-AGE.
 10494
 10495     IF CC-INSURED-SEX NOT = 'M'  AND
 10496        CC-INSURED-SEX NOT = 'F'
 10497         MOVE SPACES TO CC-INSURED-SEX.
 10498
 10499     IF CC-LOAN-APR NOT NUMERIC  OR
 10500        CC-LOAN-APR = CR-APR
 10501         MOVE ZEROS TO CC-LOAN-APR.
 10502
 10503     IF CC-PAY-FREQUENCY NOT NUMERIC  OR
 10504        CC-PAY-FREQUENCY = CR-PMT-FREQ
 10505         MOVE ZEROS TO CC-PAY-FREQUENCY.
 10506
 10507     IF CC-IND-GRP-TYPE NOT = '1'  AND
 10508        CC-IND-GRP-TYPE NOT = '2'
 10509         MOVE SPACES TO CC-IND-GRP-TYPE.
 10510
 10511     IF CC-CLAIM-DEDUCT-WITHHELD NOT NUMERIC  OR
 10512        CC-CLAIM-DEDUCT-WITHHELD = CR-CLAIM-DEDUCT-WITHHELD
 10513         MOVE ZEROS TO CC-CLAIM-DEDUCT-WITHHELD.
 10514
 10515     IF CC-CANCEL-DEDUCT-WITHHELD NOT NUMERIC  OR
 10516        CC-CANCEL-DEDUCT-WITHHELD = CR-CANCEL-DEDUCT-WITHHELD
 10517         MOVE ZEROS TO CC-CANCEL-DEDUCT-WITHHELD.
 10518
 10519     IF CC-LF-ORIG-TERM NOT NUMERIC  OR
 10520        CC-LF-ORIG-TERM = CR-LF-TERM  OR
 10521        CR-LFTYP = ZEROS
 10522         MOVE ZEROS TO CC-LF-ORIG-TERM.
 10523
 10524     IF CC-AH-ORIG-TERM NOT NUMERIC  OR
 10525        CC-AH-ORIG-TERM = CR-AH-TERM  OR
 10526        CR-AHTYP = ZEROS
 10527         MOVE ZEROS TO CC-AH-ORIG-TERM.
 10528
 10529     IF CR-BILLED NOT NUMERIC
 10530         MOVE ZEROS TO CR-BILLED.
 10531
 10532     IF CR-LIVES NOT NUMERIC
 10533         MOVE ZEROS TO CR-LIVES.
 10534
 10535     IF CC-LIVES NOT NUMERIC  OR
 10536        CC-LIVES = CR-LIVES
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 205
* ECS010T1.cbl
 10537         MOVE ZEROS TO CC-LIVES.
 10538
 10539     IF CC-BILLED NOT NUMERIC  OR
 10540        CC-BILLED = CR-BILLED
 10541         MOVE ZEROS TO CC-BILLED.
 10542
 10543     IF CC-INSURED-LAST-NAME NOT = SPACES
 10544         MOVE CC-INSURED-LAST-NAME   TO CR-LNAME.
 10545     IF CC-INSURED-FIRST-NAME NOT = SPACES
 10546         MOVE CC-INSURED-FIRST-NAME  TO CR-FNAME.
 10547     IF CC-INSURED-INITIAL2 NOT = SPACES
 10548         MOVE CC-INSURED-INITIAL2    TO CR-INIT.
 10549     IF CC-JT-LAST-NAME NOT = SPACES
 10550         MOVE CC-JT-LAST-NAME        TO CR-JT-LNAME.
 10551     IF CC-JT-FIRST-NAME NOT = SPACES
 10552         MOVE CC-JT-FIRST-NAME       TO CR-JT-FNAME.
 10553     IF CC-JT-INITIAL NOT = SPACES
 10554         MOVE CC-JT-INITIAL          TO CR-JT-INIT.
 10555
 10556     IF CC-AGE NOT = ZEROS
 10557         MOVE CC-AGE                 TO CR-AGE
 10558                                        DET-AGE
 10559     ELSE
 10560         MOVE ZEROS                  TO DET-AGE.
 10561
 10562     IF CC-INSURED-JOINT-AGE NOT = ZEROS
 10563         MOVE CC-INSURED-JOINT-AGE   TO CR-JOINT-AGE
 10564                                        DET-JT-AGE
 10565     ELSE
 10566         MOVE ZEROS                  TO DET-JT-AGE.
 10567
 10568     IF CC-INSURED-SEX NOT = SPACES
 10569         MOVE CC-INSURED-SEX         TO CR-SEX
 10570                                        DET-SEX
 10571     ELSE
 10572         MOVE SPACE                  TO DET-SEX.
 10573
 10574     IF CC-MEMBER-NO NOT = SPACES
 10575         MOVE CC-MEMBER-NO           TO CR-MEMBER-NO
 10576                                        DET-PR-MEM
 10577     ELSE
 10578         MOVE SPACES                 TO DET-PR-MEM.
 10579
 10580     IF CC-SOC-SEC-NO NOT = SPACES
 10581         MOVE CC-SOC-SEC-NO          TO CR-SOC-SEC
 10582                                        DET-PR-SS
 10583     ELSE
 10584         MOVE SPACES                 TO DET-PR-SS.
 10585
 10586     IF CC-LOAN-APR NOT = ZEROS
 10587         MOVE CC-LOAN-APR            TO CR-APR
 10588                                        DET-PR-APR
 10589     ELSE
 10590         MOVE ZEROS                  TO DET-PR-APR.
 10591
 10592     IF CC-AGE NOT = ZERO  OR
 10593        CC-INSURED-JOINT-AGE NOT = ZERO  OR
 10594        CC-INSURED-SEX NOT = SPACE  OR
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 206
* ECS010T1.cbl
 10595        CC-MEMBER-NO NOT = SPACES  OR
 10596        CC-SOC-SEC-NO NOT = SPACES  OR
 10597        CC-LOAN-APR NOT = ZERO
 10598         MOVE DET-PR-UREC            TO TR-DTL2
 10599         MOVE 'Y'                    TO WS-CHANGE-REC-SW
 10600         PERFORM 8690-PRINT-DETAIL-LINE THRU 8699-PRT-DETAIL-X.
 10601
 10602     IF CC-LF-ORIG-TERM NOT = ZEROS
 10603         MOVE CR-LF-TERM             TO DET-O-LF-TERM
 10604         MOVE CC-LF-ORIG-TERM        TO CR-LF-TERM
 10605                                        DET-N-LF-TERM
 10606     ELSE
 10607         MOVE ZEROS                  TO DET-O-LF-TERM
 10608                                        DET-N-LF-TERM.
 10609
 10610     IF CC-AH-ORIG-TERM NOT = ZEROS
 10611         MOVE CR-AH-TERM             TO DET-O-AH-TERM
 10612         MOVE CC-AH-ORIG-TERM        TO CR-AH-TERM
 10613                                        DET-N-AH-TERM
 10614     ELSE
 10615         MOVE ZEROS                  TO DET-O-AH-TERM
 10616                                        DET-N-AH-TERM.
 10617
 10618     IF CC-LIVES NOT = ZEROS
 10619         MOVE CR-LIVES               TO DET-O-LIVES
 10620         MOVE CC-LIVES               TO CR-LIVES
 10621                                        DET-N-LIVES
 10622     ELSE
 10623         MOVE ZEROS                  TO DET-O-LIVES
 10624                                        DET-N-LIVES.
 10625
 10626     IF CC-BILLED NOT  = ZEROES
 10627         MOVE CC-BILLED              TO CR-BILLED.
 10628
 10629     IF CC-LF-ORIG-TERM NOT = ZERO  OR
 10630        CC-AH-ORIG-TERM NOT = ZERO  OR
 10631        CC-LIVES NOT = ZERO
 10632         MOVE DET-PR-UREC-2          TO TR-DTL2
 10633         MOVE 'Y'                    TO WS-CHANGE-REC-SW
 10634         PERFORM 8690-PRINT-DETAIL-LINE THRU 8699-PRT-DETAIL-X.
 10635
 10636     IF CC-IND-GRP-TYPE NOT = SPACES
 10637         MOVE CC-IND-GRP-TYPE        TO CR-IND-GRP
 10638                                        DET-IND-GRP
 10639     ELSE
 10640         MOVE SPACE                  TO DET-IND-GRP.
 10641
 10642     IF CC-PAY-FREQUENCY NOT = ZEROS
 10643         MOVE CC-PAY-FREQUENCY       TO CR-PMT-FREQ
 10644                                        DET-PMT-FREQ
 10645     ELSE
 10646         MOVE ZEROS                  TO DET-PMT-FREQ.
 10647
 10648     IF CC-POLICY-FORM-NO NOT = SPACES
 10649         MOVE CC-POLICY-FORM-NO      TO CR-POLICY-FORM-NO
 10650                                        DET-POL-FORM
 10651     ELSE
 10652         MOVE SPACES                 TO DET-POL-FORM.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 207
* ECS010T1.cbl
 10653
 10654     IF CC-LOAN-OFFICER NOT = SPACES
 10655         MOVE CC-LOAN-OFFICER        TO CR-LOAN-OFFICER
 10656                                        DET-LOAN-OFFICER
 10657     ELSE
 10658         MOVE SPACES                 TO DET-LOAN-OFFICER.
 10659
 10660     IF CC-USER-FIELD NOT = SPACES
 10661         MOVE CC-USER-FIELD          TO CR-USER-CODE
 10662                                        DET-USER-CODE
 10663     ELSE
 10664         MOVE SPACE                  TO DET-USER-CODE.
 10665
 10666     IF CC-IND-GRP-TYPE NOT = SPACE  OR
 10667        CC-PAY-FREQUENCY NOT = ZEROS  OR
 10668        CC-POLICY-FORM-NO NOT = SPACES  OR
 10669        CC-LOAN-OFFICER NOT = SPACES  OR
 10670        CC-USER-FIELD NOT = SPACES
 10671         MOVE DET-PR-UREC-3          TO TR-DTL2
 10672         MOVE 'Y'                    TO WS-CHANGE-REC-SW
 10673         PERFORM 8690-PRINT-DETAIL-LINE THRU 8699-PRT-DETAIL-X.
 10674
 10675     IF CC-CLAIM-DEDUCT-WITHHELD NOT = ZEROS
 10676         MOVE CC-CLAIM-DEDUCT-WITHHELD
 10677                                     TO CR-CLAIM-DEDUCT-WITHHELD
 10678                                        DET-CLM-DEDUCT
 10679     ELSE
 10680         MOVE ZEROS                  TO DET-CLM-DEDUCT.
 10681
 10682     IF CC-CANCEL-DEDUCT-WITHHELD NOT = ZEROS
 10683         MOVE CC-CANCEL-DEDUCT-WITHHELD
 10684                                     TO CR-CANCEL-DEDUCT-WITHHELD
 10685                                        DET-CAN-DEDUCT
 10686     ELSE
 10687         MOVE ZEROS                  TO DET-CAN-DEDUCT.
 10688
 10689     IF CC-CLAIM-DEDUCT-WITHHELD NOT = ZEROS  OR
 10690        CC-CANCEL-DEDUCT-WITHHELD NOT = ZEROS
 10691         MOVE DET-PR-UREC-4          TO TR-DTL2
 10692         MOVE 'Y'                    TO WS-CHANGE-REC-SW
 10693         PERFORM 8690-PRINT-DETAIL-LINE THRU 8699-PRT-DETAIL-X.
 10694
 10695     IF CC-LF-PREMIUM-AMT NOT NUMERIC
 10696         MOVE ZEROS              TO  CC-LF-PREMIUM-AMT.
 10697
 10698     IF CC-LF-BENEFIT-AMT NOT NUMERIC
 10699         MOVE ZEROS              TO  CC-LF-BENEFIT-AMT.
 10700
 10701     IF CC-AH-PREMIUM-AMT NOT NUMERIC
 10702         MOVE ZEROS              TO  CC-AH-PREMIUM-AMT.
 10703
 10704     IF CC-AH-BENEFIT-AMT NOT NUMERIC
 10705         MOVE ZEROS              TO  CC-AH-BENEFIT-AMT.
 10706
 10707     IF CC-LF-BENEFIT-CD NOT = SPACES
 10708         MOVE CC-LF-BENEFIT-CD   TO  CR-LFTYP
 10709                                     DET-LF-BEN-CD
 10710     ELSE
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 208
* ECS010T1.cbl
 10711         MOVE SPACES             TO DET-LF-BEN-CD.
 10712
 10713     IF CC-LF-PREMIUM-AMT NOT = ZEROS
 10714         MOVE CC-LF-PREMIUM-AMT  TO  CR-LFPRM
 10715                                     DET-LF-PREM
 10716     ELSE
 10717         MOVE ZEROS              TO DET-LF-PREM.
 10718
 10719     IF CC-LF-BENEFIT-AMT NOT = ZEROS
 10720         MOVE CC-LF-BENEFIT-AMT  TO  CR-LFAMT
 10721                                     DET-LF-BEN
 10722     ELSE
 10723         MOVE ZEROS              TO DET-LF-BEN.
 10724
 10725     IF (CC-LF-BENEFIT-CD NOT = SPACES)  OR
 10726        (CC-LF-PREMIUM-AMT NOT = ZEROS)  OR
 10727        (CC-LF-BENEFIT-AMT NOT = ZEROS)
 10728         MOVE DET-PR-UREC-5          TO TR-DTL2
 10729         MOVE 'Y'                    TO WS-CHANGE-REC-SW
 10730         PERFORM 8690-PRINT-DETAIL-LINE THRU 8699-PRT-DETAIL-X.
 10731
 10732     IF CC-AH-BENEFIT-CD NOT = SPACES
 10733         MOVE CC-AH-BENEFIT-CD   TO  CR-AHTYP
 10734                                     DET-AH-BEN-CD
 10735     ELSE
 10736         MOVE SPACES             TO DET-AH-BEN-CD.
 10737
 10738     IF CC-AH-PREMIUM-AMT NOT = ZEROS
 10739         MOVE CC-AH-PREMIUM-AMT  TO  CR-AHPRM
 10740                                     DET-AH-PREM
 10741     ELSE
 10742         MOVE ZEROS              TO DET-AH-PREM.
 10743
 10744     IF CC-AH-BENEFIT-AMT NOT = ZEROS
 10745         MOVE CC-AH-BENEFIT-AMT  TO  CR-AHAMT
 10746                                     DET-AH-BEN
 10747     ELSE
 10748         MOVE ZEROS              TO DET-AH-BEN.
 10749
 10750     IF CC-AH-BENEFIT-CD NOT = SPACES OR
 10751        CC-AH-PREMIUM-AMT NOT = ZEROS OR
 10752        CC-AH-BENEFIT-AMT NOT = ZEROS
 10753         MOVE DET-PR-UREC-6          TO TR-DTL2
 10754         MOVE 'Y'                    TO WS-CHANGE-REC-SW
 10755         PERFORM 8690-PRINT-DETAIL-LINE THRU 8699-PRT-DETAIL-X.
 10756
 10757 0910-END-CHANGE-PROCESSING.
 10758
 10759     IF CR-LNAME = ALL '*'
 10760         MOVE SPACES                 TO CR-LNAME.
 10761     IF CR-FNAME = ALL '*'
 10762         MOVE SPACES                 TO CR-FNAME.
 10763     IF CR-INIT = '*'
 10764         MOVE SPACES                 TO CR-INIT.
 10765     IF CR-SOC-SEC = ALL '*'
 10766         MOVE SPACES                 TO CR-SOC-SEC.
 10767     IF CR-JT-LNAME = ALL '*'
 10768         MOVE SPACES                 TO CR-JT-LNAME.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 209
* ECS010T1.cbl
 10769     IF CR-JT-FNAME = ALL '*'
 10770         MOVE SPACES                 TO CR-JT-FNAME.
 10771     IF CR-JT-INIT = '*'
 10772         MOVE SPACES                 TO CR-JT-INIT.
 10773     IF CR-POLICY-FORM-NO = ALL '*'
 10774         MOVE SPACES                 TO CR-POLICY-FORM-NO.
 10775     IF CR-MEMBER-NO = ALL '*'
 10776         MOVE SPACES                 TO CR-MEMBER-NO.
 10777     IF CR-LOAN-OFFICER = ALL '*'
 10778         MOVE SPACES                 TO CR-LOAN-OFFICER.
 10779     IF CR-USER-CODE = ALL '*'
 10780         MOVE SPACES                 TO CR-USER-CODE.
 10781
 10782     ADD +1 TO BC-G-CTN.
 10783     GO TO 0300-READ-PENDING-TRANSACTIONS.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 210
* ECS010T1.cbl
 10785 0920-GET-BANK-FEES.
 10786
 10787     IF CR-CERT-NO = '0008771354 '
 10788        DISPLAY ' MADE IT TO 0920 '
 10789     END-IF
 10790
 10791     MOVE DTE-CLASIC-COMPANY-CD  TO AG-COMPANY-CD
 10792     MOVE CR-CARRIER             TO AG-CARRIER
 10793     MOVE CR-GROUPING            TO AG-GROUPING
 10794     MOVE CR-BANK-NO             TO AG-BANK
 10795     MOVE WS-CR-BIN-DATE         TO AG-EXP-DT
 10796     MOVE 'B'                    TO AG-TYPE
 10797
 10798*    IF WS-PREV-BANK-COMM-KEY = AG-CONTROL-PRIMARY
 10799*       PERFORM 0925-BUILD-WORK-BNK-COMM
 10800*                                THRU 0925-EXIT
 10801*       GO TO 0920-EXIT
 10802*    END-IF
 10803
 10804     START ERAGTC KEY NOT < AG-CONTROL-PRIMARY
 10805
 10806     IF CR-CERT-NO = '0008771354 '
 10807        DISPLAY ' MADE IT AFTER START '
 10808     END-IF
 10809
 10810     .
 10811 0920-READ-ERAGTC.
 10812
 10813     IF ERAGTC-FILE-STATUS = '00'
 10814        READ ERAGTC NEXT RECORD
 10815     IF CR-CERT-NO = '0008771354 '
 10816        DISPLAY ' MADE ONE READ '
 10817     END-IF
 10818
 10819        IF ERAGTC-FILE-STATUS = '00'
 10820           IF (CR-CARRIER         = AG-CARRIER)
 10821              AND (CR-GROUPING    = AG-GROUPING)
 10822              AND (CR-BANK-NO     = AG-BANK)
 10823              IF WS-CR-BIN-DATE  = AG-EXP-DT
 10824                 GO TO 0920-READ-ERAGTC
 10825              ELSE
 10826                 IF (WS-CR-BIN-DATE NOT < AG-EFF-DT)
 10827                    AND (WS-CR-BIN-DATE < AG-EXP-DT)
 10828                    PERFORM 0925-BUILD-WORK-BNK-COMM
 10829                                 THRU 0925-EXIT
 10830                    MOVE AG-CONTROL-PRIMARY
 10831                                 TO WS-PREV-BANK-COMM-KEY
 10832                    GO TO 0920-EXIT
 10833                 END-IF
 10834              END-IF
 10835           END-IF
 10836        END-IF
 10837     END-IF
 10838
 10839     MOVE WS-BANK-INIT           TO WS-BANK-COMMISSIONS
 10840*    PERFORM 0925-BUILD-WORK-BNK-COMM
 10841
 10842     IF (CR-BANK-NO NOT = SPACES AND ZEROS)
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 211
* ECS010T1.cbl
 10843        AND (PB-I-BANK-FEE NOT = ZEROS)
 10844        MOVE CR-BANK-NO          TO WS-BNK-AGT (1)
 10845        MOVE 'B'                 TO WS-BNK-TYPE (1)
 10846        MOVE PB-I-BANK-FEE       TO WS-BNK-SPP-FEES (1)
 10847        MOVE ' '                 TO WS-BNK-RECALC (1)
 10848        MOVE +2                  TO IB
 10849     END-IF
 10850
 10851     .
 10852 0920-EXIT.
 10853     EXIT.
 10854
 10855 0925-BUILD-WORK-BNK-COMM.
 10856
 10857     IF CR-CERT-NO = '0008771354 '
 10858        DISPLAY ' MADE IT TO 0925 '
 10859     END-IF
 10860
 10861     MOVE +1                     TO IA IB
 10862
 10863*    IF (CR-BANK-NO NOT = SPACES AND ZEROS)
 10864*       AND (PB-I-BANK-FEE NOT = ZEROS)
 10865*       MOVE CR-BANK-NO          TO WS-BNK-AGT (IB)
 10866*       MOVE 'B'                 TO WS-BNK-TYPE (IB)
 10867*       MOVE PB-I-BANK-FEE       TO WS-BNK-SPP-FEES (IB)
 10868*       MOVE ' '                 TO WS-BNK-RECALC (IB)
 10869*       ADD +1                   TO IB
 10870*    END-IF
 10871*    .
 10872*0925-BUILD-CONTINUE.
 10873
 10874     IF CR-CERT-NO = '00087735841'
 10875        DISPLAY ' WS-BNK-AGT ' WS-BNK-AGT (1)
 10876        MOVE WS-BNK-SPP-FEES (1) TO WS-DISP-AMT
 10877        DISPLAY ' WS-BNK-FEE ' WS-DISP-AMT
 10878     END-IF
 10879
 10880*    PERFORM VARYING IA FROM +2 BY +1 UNTIL
 10881     PERFORM VARYING IA FROM +1 BY +1 UNTIL
 10882        (IA > +10)
 10883        OR (IB > +10)
 10884        IF AG-AGT (IA) NOT = SPACES AND ZEROS
 10885           MOVE AG-AGT (IA)      TO WS-BNK-AGT (IB)
 10886           MOVE 'B'              TO WS-BNK-TYPE (IB)
 10887*          MOVE AG-COM-TYP (IA)  TO WS-BNK-TYPE (IB)
 10888           IF AG-SPP-FEES (IA) NOT NUMERIC
 10889              MOVE ZEROS         TO AG-SPP-FEES (IA)
 10890           END-IF
 10891           MOVE AG-SPP-FEES (IA) TO WS-BNK-SPP-FEES (IB)
 10892           MOVE AG-RECALC-LV-INDIC (IA)
 10893                                 TO WS-BNK-RECALC (IB)
 10894        ELSE
 10895           MOVE SPACES           TO WS-BNK-AGT (IB)
 10896                                    WS-BNK-TYPE (IB)
 10897                                    WS-BNK-RECALC (IB)
 10898           MOVE ZEROS            TO WS-BNK-SPP-FEES (IB)
 10899        END-IF
 10900        ADD +1                   TO IB
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 212
* ECS010T1.cbl
 10901     END-PERFORM
 10902
 10903     .
 10904 0925-EXIT.
 10905     EXIT.
 10906
 10907 0930-BUILD-CERT-TRLR.
 10908
 10909     MOVE SPACES                 TO CERTIFICATE-TRAILERS
 10910     MOVE 'CS'                   TO CS-RECORD-ID
 10911     MOVE DTE-CLASIC-COMPANY-CD  TO CS-COMPANY-CD
 10912     MOVE CR-CARRIER             TO CS-CARRIER
 10913     MOVE CR-GROUPING            TO CS-GROUPING
 10914     MOVE CR-STATE               TO CS-STATE
 10915     MOVE CR-ACCOUNT             TO CS-ACCOUNT
 10916     MOVE WS-CR-BIN-DATE         TO CS-CERT-EFF-DT
 10917     MOVE CR-CERT-NO             TO CS-CERT-NO
 10918     MOVE 'A'                    TO CS-TRAILER-TYPE
 10919
 10920     MOVE WS-BANK-COMMISSIONS    TO CS-BANK-COMMISSION-AREA
 10921
 10922     IF CS-AGT (1) NOT = SPACES AND ZEROS
 10923        WRITE CERTIFICATE-TRAILERS
 10924        IF ELCRTT-FILE-STATUS = '00'
 10925           CONTINUE
 10926        ELSE
 10927           IF ELCRTT-FILE-STATUS = '22'
 10928              READ ELCRTT
 10929              IF ELCRTT-FILE-STATUS = '00'
 10930                 MOVE WS-BANK-COMMISSIONS
 10931                                 TO CS-BANK-COMMISSION-AREA
 10932                 REWRITE CERTIFICATE-TRAILERS
 10933                 IF ELCRTT-FILE-STATUS NOT = '00'
 10934                    DISPLAY ' BAD REWRITE ELCRTT '
 10935                                 ELCRTT-FILE-STATUS
 10936                    PERFORM ABEND-PGM
 10937                 END-IF
 10938              ELSE
 10939                 DISPLAY ' BAD READ    ELCRTT '
 10940                                  ELCRTT-FILE-STATUS
 10941                 PERFORM ABEND-PGM
 10942              END-IF
 10943           ELSE
 10944              DISPLAY ' BAD WRITE ELCRTT '
 10945                                 ELCRTT-FILE-STATUS
 10946              PERFORM ABEND-PGM
 10947           END-IF
 10948        END-IF
 10949     END-IF
 10950
 10951     .
 10952 0930-EXIT.
 10953     EXIT.
 10954
 10955******************************************************************
 10956***      S E T   C O M M I S S I O N   S T R U C T U R E       ***
 10957******************************************************************
 10958
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 213
* ECS010T1.cbl
 10959 1000-SET-COMMISSION-STRUCTURE.
 10960
 10961     MOVE +1                     TO IA
 10962                                    IB.
 10963
 10964 1100-GET-COMMISSION-LEVEL.
 10965
 10966     MOVE AM-AGT-COMMS (IA)      TO WK-LEVEL.
 10967
 10968     IF WK-AGT = '0000000000' OR SPACES
 10969         MOVE +0                 TO WK-L-RT
 10970                                    WK-J-RT
 10971                                    WK-A-RT
 10972         GO TO 1200-SET-COMMISSION-LEVEL.
 10973
 10974 1110-LIFE-COMMISSION.
 10975
 10976     IF CR-LFTYP = ZERO  OR
 10977       (CR-ENTRY-STATUS = 'P' OR 'D' OR 'V')
 10978         MOVE +0 TO WK-L-RT
 10979                    WK-J-RT
 10980         GO TO 1130-A-H-COMMISSION.
 10981
 10982     IF CLAS-I-JOINT (CLAS-INDEXL) = 'J'
 10983         GO TO 1120-JOINT-LIFE-COMMISSION.
 10984
 10985     IF WK-L-RT NUMERIC
 10986        AND (WK-L-RTX (3:1) NOT = 'L' AND 'M')
 10987         MOVE WK-L-RT                TO WS-COMMISSION
 10988         PERFORM 6650-GET-RES-STATE-COMM  THRU 6700-COMM-EXIT
 10989         MOVE WS-COMMISSION          TO WK-L-RT
 10990         GO TO 1130-A-H-COMMISSION.
 10991
 10992     MOVE LIFE-OVERRIDE-L1           TO CTBL-BEN-TYPE.
 10993     MOVE CR-LFTYP                   TO CTBL-BEN-CODE.
 10994     MOVE ZEROS                      TO WS-SUB1.
 10995     PERFORM 6650-GET-RES-STATE-COMM  THRU 6700-COMM-EXIT
 10996
 10997     IF WS-SUB1 = ZEROS
 10998         MOVE WK-L-RTX               TO CTBL-TABLE-CD
 10999     ELSE
 11000         MOVE WK-RATE                TO WK-L-RT
 11001         GO TO 1130-A-H-COMMISSION.
 11002
 11003     PERFORM 1300-READ-ERCTBL-FILE THRU 1399-READ-ERCTBL-X.
 11004
 11005     MOVE CR-LFAMT                   TO COMM-CK-AMT.
 11006     MOVE CR-LF-TERM                 TO WS-COMM-TERM.
 11007     PERFORM 1400-GET-COMM-PERCENT THRU 1489-GET-PERCENT-X.
 11008     MOVE WK-RATE                    TO WK-L-RT.
 11009
 11010     GO TO 1130-A-H-COMMISSION.
 11011
 11012 1120-JOINT-LIFE-COMMISSION.
 11013
 11014     IF WK-J-RT NUMERIC
 11015        AND (WK-J-RTX (3:1) NOT = 'L' AND 'M')
 11016         MOVE WK-J-RT                TO WS-COMMISSION
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 214
* ECS010T1.cbl
 11017         PERFORM 6650-GET-RES-STATE-COMM  THRU 6700-COMM-EXIT
 11018         MOVE WS-COMMISSION          TO WK-J-RT
 11019         GO TO 1130-A-H-COMMISSION.
 11020
 11021     MOVE LIFE-OVERRIDE-L1           TO CTBL-BEN-TYPE.
 11022     MOVE CR-LFTYP                   TO CTBL-BEN-CODE.
 11023     MOVE ZEROS                      TO WS-SUB1.
 11024     PERFORM 6650-GET-RES-STATE-COMM  THRU 6700-COMM-EXIT
 11025
 11026     IF WS-SUB1 = ZEROS
 11027         MOVE WK-J-RTX               TO CTBL-TABLE-CD
 11028     ELSE
 11029         MOVE WK-RATE                TO WK-J-RT
 11030         GO TO 1130-A-H-COMMISSION.
 11031
 11032     PERFORM 1300-READ-ERCTBL-FILE THRU 1399-READ-ERCTBL-X.
 11033
 11034     MOVE CR-LFAMT                   TO COMM-CK-AMT.
 11035     MOVE CR-LF-TERM                 TO WS-COMM-TERM.
 11036     PERFORM 1400-GET-COMM-PERCENT THRU 1489-GET-PERCENT-X.
 11037     MOVE WK-RATE                    TO WK-J-RT.
 11038
 11039 1130-A-H-COMMISSION.
 11040
 11041     IF CR-AHTYP = ZERO  OR
 11042       (CR-ENTRY-STATUS = 'P' OR 'D' OR 'V')
 11043         MOVE +0 TO WK-A-RT
 11044         GO TO 1200-SET-COMMISSION-LEVEL.
 11045
 11046     IF WK-A-RT NUMERIC
 11047        AND (WK-A-RTX (3:1) NOT = 'L' AND 'M')
 11048         MOVE WK-A-RT                TO WS-COMMISSION
 11049         PERFORM 6650-GET-RES-STATE-COMM  THRU 6700-COMM-EXIT
 11050         MOVE WS-COMMISSION          TO WK-A-RT
 11051         GO TO 1200-SET-COMMISSION-LEVEL.
 11052
 11053     MOVE AH-OVERRIDE-L1             TO CTBL-BEN-TYPE.
 11054     MOVE CR-AHTYP                   TO CTBL-BEN-CODE.
 11055     MOVE ZEROS                      TO WS-SUB1.
 11056     PERFORM 6650-GET-RES-STATE-COMM  THRU 6700-COMM-EXIT
 11057
 11058     IF WS-SUB1 = ZEROS
 11059         MOVE WK-A-RTX               TO CTBL-TABLE-CD
 11060     ELSE
 11061         MOVE WK-RATE                TO WK-A-RT
 11062         GO TO 1200-SET-COMMISSION-LEVEL.
 11063
 11064     PERFORM 1300-READ-ERCTBL-FILE THRU 1399-READ-ERCTBL-X.
 11065
 11066     COMPUTE COMM-CK-AMT = CR-AHAMT * CR-AH-TERM.
 11067     MOVE CR-AH-TERM                 TO WS-COMM-TERM.
 11068     PERFORM 1400-GET-COMM-PERCENT THRU 1489-GET-PERCENT-X.
 11069     MOVE WK-RATE                    TO WK-A-RT.
 11070
 11071 1200-SET-COMMISSION-LEVEL.
 11072
 11073     MOVE WK-AGT                      TO WK-N-AGT  (IA).
 11074     IF WK-AGT = '0000000000' OR SPACES
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 215
* ECS010T1.cbl
 11075         MOVE SPACE                   TO WK-N-TYPE (IA)
 11076     ELSE
 11077         MOVE WK-A-TYPE               TO WK-N-TYPE (IA).
 11078
 11079     IF CR-LFTYP = ZERO
 11080         MOVE +0                      TO WK-L-RT1  (IA)
 11081     ELSE
 11082         IF CLAS-I-JOINT (CLAS-INDEXL) = 'J'
 11083             MOVE WK-J-RT             TO WK-L-RT1 (IA)
 11084         ELSE
 11085             MOVE WK-L-RT             TO WK-L-RT1 (IA).
 11086
 11087     MOVE WK-A-RT                     TO WK-A-RT1 (IA).
 11088
 11089     IF RC-COMM-FLG = 'X'
 11090        IF (AM-RECALC-LV-INDIC (IA) = 'N')
 11091*          OR ((CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'G' OR 'L')
 11092*             AND (IA = +5))
 11093            MOVE CR-COM-AGT  (IA)         TO WK-N-AGT  (IA)
 11094            MOVE CR-AGT-TYPE (IA)         TO WK-N-TYPE (IA)
 11095            MOVE CR-LCOM-L   (IA)         TO WK-L-RT1  (IA)
 11096            MOVE CR-LCOM-AH  (IA)         TO WK-A-RT1  (IA).
 11097
 11098     IF IA LESS THAN +10
 11099         ADD +1 TO IA
 11100         GO TO 1100-GET-COMMISSION-LEVEL.
 11101
 11102     GO TO 1499-SET-COMM-X.
 11103
 11104 1300-READ-ERCTBL-FILE.
 11105
 11106     IF CTBL-SEARCH = LAST-CTBL
 11107         GO TO 1399-READ-ERCTBL-X.
 11108
 11109     MOVE SPACE                          TO CTBL-ERROR-SWITCH.
 11110
 11111     IF COMM-OPEN-SW = ' '
 11112         MOVE 'X'                        TO COMM-OPEN-SW
 11113         MOVE DTE-CLASIC-COMPANY-CD      TO CTBL-COMP-CD
 11114         OPEN INPUT ERCTBL
 11115         IF ERCTBL-FILE-STATUS = '00'  OR  '97'
 11116             NEXT SENTENCE
 11117            ELSE
 11118             MOVE '41'                   TO ABEND-CODE-1
 11119             MOVE ERCTBL-FILE-STATUS     TO ABEND-CODE-2
 11120             DISPLAY '******************************'
 11121             DISPLAY '***** ERROR LOCATION 012 *****'
 11122             DISPLAY '******************************'
 11123             DISPLAY '******************************'
 11124             MOVE WS-ABEND-CODE          TO WS-RETURN-CODE
 11125             GO TO ABEND-PGM.
 11126
 11127     MOVE CTBL-SEARCH                    TO CT-CONTROL-PRIMARY
 11128                                            LAST-CTBL.
 11129     READ ERCTBL.
 11130
 11131     IF ERCTBL-FILE-STATUS = '23'
 11132         DISPLAY 'INVALID COMM TABLE CODE FOR: ' CR-FULL-CONTROL
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 216
* ECS010T1.cbl
 11133                 ' ENTERED: ' CR-ENTRY-STATUS '-' CR-ENTRY-DATE
 11134                 ' CTBL: ' CTBL-SEARCH
 11135         MOVE '*'                TO CTBL-ERROR-SWITCH
 11136         MOVE '44'               TO ABEND-CODE-1
 11137         MOVE ERCTBL-FILE-STATUS TO ABEND-CODE-2
 11138         DISPLAY 'CT-CONTROL-PRIMARY = ' CT-CONTROL-PRIMARY
 11139         DISPLAY '******************************'
 11140         DISPLAY '***** ERROR LOCATION 013 *****'
 11141         DISPLAY '******************************'
 11142         MOVE WS-ABEND-CODE      TO WS-RETURN-CODE
 11143*        IF DTE-CLIENT NOT = 'NCL'
 11144         IF DTE-CLIENT NOT = 'NCL' AND 'CID' AND 'CSO'
 11145             GO TO ABEND-PGM
 11146         ELSE
 11147             NEXT SENTENCE
 11148     ELSE
 11149         IF ERCTBL-FILE-STATUS NOT = '00'
 11150             MOVE 'READ ERROR ON ERCTBL' TO WS-ABEND-MESSAGE
 11151             MOVE '44'               TO ABEND-CODE-1
 11152             MOVE ERCTBL-FILE-STATUS TO ABEND-CODE-2
 11153             DISPLAY '******************************'
 11154             DISPLAY '***** ERROR LOCATION 014 *****'
 11155             DISPLAY '******************************'
 11156             MOVE WS-ABEND-CODE      TO WS-RETURN-CODE
 11157             GO TO ABEND-PGM.
 11158
 11159     ADD +1                            TO ERCTBL-READS.
 11160
 11161 1399-READ-ERCTBL-X.
 11162     EXIT.
 11163
 11164 1400-GET-COMM-PERCENT.
 11165
 11166     IF CTBL-ERROR
 11167         MOVE ZEROS                      TO WK-RATE
 11168         GO TO 1489-GET-PERCENT-X.
 11169
 11170     MOVE +1 TO IB.
 11171     IF (COMM-CK-AMT GREATER CT-TBF (1)) AND
 11172        (CT-TBF (1) NOT EQUAL +9999999.99)
 11173         ADD +9 TO IB
 11174         IF (COMM-CK-AMT GREATER CT-TBF (2)) AND
 11175            (CT-TBF (2) NOT EQUAL +9999999.99)
 11176             ADD +9 TO IB.
 11177
 11178     IF CR-AGE GREATER CT-AGE (1)
 11179         ADD +3 TO IB
 11180         IF CR-AGE GREATER CT-AGE (2)
 11181             ADD +3 TO IB.
 11182
 11183     IF WS-COMM-TERM GREATER CT-TRM (1)
 11184         ADD +1 TO IB
 11185         IF WS-COMM-TERM GREATER CT-TRM (2)
 11186             ADD +1 TO IB.
 11187
 11188     IF CT-RT (IB) NOT NUMERIC
 11189         MOVE LAST-CTBL     TO CT-CONTROL-PRIMARY
 11190         MOVE CT-RT-R (IB)  TO CTBL-TABLE-CD
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 217
* ECS010T1.cbl
 11191         GO TO 1300-READ-ERCTBL-FILE.
 11192
 11193     MOVE CT-RT (IB) TO WK-RATE.
 11194
 11195 1489-GET-PERCENT-X.
 11196     EXIT.
 11197
 11198 1499-SET-COMM-X.
 11199     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 218
* ECS010T1.cbl
 11201******************************************************************
 11202***  C O M P U T E   A C C T   L E V E L   C O M M I S S I O N ***
 11203******************************************************************
 11204
 11205 1500-GET-ACCT-LEVEL-LF-COMM.
 11206
 11207     MOVE ZEROS                      TO ACCT-COMM-LF
 11208                                        ACCT-COMM-AH.
 11209
 11210     MOVE +1                         TO IA.
 11211
 11212 1510-ACCT-LEVEL-LOOP.
 11213
 11214     IF CR-AGT-TYPE (IA) = 'C'  OR  'D' OR 'F' OR 'S'
 11215         IF WS-LEVELS-CHARGEBACK-SWITCHES = SPACES
 11216             ADD CR-LCOM-L (IA)  TO ACCT-COMM-LF
 11217             ADD CR-LCOM-AH (IA) TO ACCT-COMM-AH
 11218         ELSE
 11219             IF WS-LF-CHARGEBACK-SW (IA)  =  'Y'
 11220                 ADD CR-LCOM-L (IA)  TO ACCT-COMM-LF.
 11221
 11222     IF IA LESS THAN +10
 11223         ADD +1 TO IA
 11224         GO TO 1510-ACCT-LEVEL-LOOP.
 11225
 11226 1519-ACCT-LF-COMM-X.
 11227     EXIT.
 11228
 11229
 11230 1550-GET-ACCT-LEVEL-AH-COMM.
 11231
 11232     MOVE ZEROS                      TO ACCT-COMM-AH.
 11233
 11234     MOVE +1                         TO IA.
 11235
 11236 1555-ACCT-LEVEL-LOOP.
 11237
 11238     IF CR-AGT-TYPE (IA) = 'C'  OR  'D' OR 'F' OR 'S'
 11239         IF WS-AH-CHARGEBACK-SW (IA)  =  'Y'
 11240             ADD CR-LCOM-AH (IA)  TO ACCT-COMM-AH.
 11241
 11242     IF IA LESS THAN +10
 11243         ADD +1 TO IA
 11244         GO TO 1555-ACCT-LEVEL-LOOP.
 11245
 11246 1599-ACCT-AH-COMM-X.
 11247     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 219
* ECS010T1.cbl
 11249******************************************************************
 11250***      C O M M I S S I O N   R E C A L C   R O U T I N E     ***
 11251******************************************************************
 11252
 11253 1600-RECALC-COMM-EXTR.
 11254
 11255     IF RC-COMM-FLG = 'X'  OR
 11256        (DTE-PGM-OPT = '2'  OR  '3')  OR
 11257        CR-POLICY-IS-DECLINED  OR
 11258        CR-POLICY-IS-VOID
 11259         GO TO 1899-RECALC-COMM-EXTR-X.
 11260
 11261     MOVE 'X'                           TO RC-COMM-FLG.
 11262
 11263     IF CR-ENTRY-DATE = EOM-RUN-DATE
 11264         GO TO 1899-RECALC-COMM-EXTR-X.
 11265
 11266     PERFORM 1000-SET-COMMISSION-STRUCTURE THRU 1499-SET-COMM-X.
 11267
 11268     IF CR-COMPENSATION-LEVELS = WK-NEW-RATES
 11269         GO TO 1899-RECALC-COMM-EXTR-X.
 11270
 11271     MOVE WK-NEW-RATES                  TO SAVE-WK-NEW-RATES.
 11272
 11273     PERFORM 1610-CK-DUPLICATE-ENTRIES
 11274         THRU 1619-CK-DUPLICATE-ENTRIES-XIT
 11275             VARYING SUB11 FROM 1 BY 1 UNTIL SUB11 GREATER 10.
 11276
 11277     IF CR-COMPENSATION-LEVELS = WK-NEW-RATES
 11278         MOVE SAVE-WK-NEW-RATES         TO CR-COMPENSATION-LEVELS
 11279                                           WK-NEW-RATES
 11280         GO TO 1899-RECALC-COMM-EXTR-X.
 11281
 11282     MOVE +1                            TO SUB8.
 11283     GO TO 1700-REVERSE-OLD-COMM-LOOP.
 11284
 11285 1610-CK-DUPLICATE-ENTRIES.
 11286     PERFORM 1620-CK-DUPL-ENTR-NEW
 11287         THRU 1629-CK-DUPL-ENTR-NEW-XIT
 11288             VARYING SUB12 FROM 1 BY 1 UNTIL SUB12 GREATER 10.
 11289
 11290 1619-CK-DUPLICATE-ENTRIES-XIT.
 11291     EXIT.
 11292
 11293 1620-CK-DUPL-ENTR-NEW.
 11294     IF CR-AGT-LEVELS (SUB11) = WK-N-R (SUB12)
 11295         MOVE SPACES                    TO CR-COM-AGT (SUB11)
 11296         MOVE SPACE                     TO CR-AGT-TYPE (SUB11)
 11297         MOVE +0                        TO CR-LCOM-L (SUB11)
 11298                                           CR-LCOM-AH (SUB11)
 11299         MOVE CR-AGT-LEVELS (SUB11)     TO WK-N-R (SUB12)
 11300         MOVE 11                        TO SUB12.
 11301
 11302 1629-CK-DUPL-ENTR-NEW-XIT.
 11303     EXIT.
 11304
 11305 1700-REVERSE-OLD-COMM-LOOP.
 11306     COMPUTE CR-LCOM-L (SUB8) = CR-LCOM-L (SUB8) * -1.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 220
* ECS010T1.cbl
 11307     COMPUTE CR-LCOM-AH (SUB8) = CR-LCOM-AH (SUB8) * -1.
 11308
 11309     IF SUB8 LESS THAN +10
 11310         ADD +1 TO SUB8
 11311         GO TO 1700-REVERSE-OLD-COMM-LOOP.
 11312
 11313     MOVE 'O' TO RECALC-TYPE.
 11314
 11315     PERFORM 1710-DO-R-C-EXTRACTS THRU 1719-DO-R-C-EXTRACTS-X.
 11316
 11317     GO TO 1800-MOVE-NEW-COMM-RATES.
 11318
 11319 1710-DO-R-C-EXTRACTS.
 11320
 11321     PERFORM 2000-INITIALIZE-DETAIL-EXTRACT THRU 2099-INIT-DTL-X.
 11322
 11323     PERFORM 1720-CHECK-COMM-LEVELS
 11324         THRU 1729-CHECK-COMM-LEVELS-EXIT
 11325             VARYING SUB13 FROM +1 BY +1
 11326                 UNTIL SUB13 GREATER THAN 10.
 11327
 11328     MOVE '8'                           TO DE-TRANS.
 11329     MOVE RECALC-TYPE                   TO DE-RECALC-TYPE.
 11330*****PERFORM EXTRACT-DATE-RELOAD.
 11331     MOVE DETAIL-EXTRACT                TO SAVE-EXTRACT.
 11332     PERFORM 2500-WRITE-DETAIL-EXTRACTS THRU 2599-WRT-DETAIL-X.
 11333     MOVE SAVE-EXTRACT                  TO DETAIL-EXTRACT.
 11334     PERFORM EXTRACT-DATE-LOAD.
 11335     MOVE 'R'                           TO DE-REIN.
 11336     MOVE DETAIL-EXTRACT                TO SAVE-EXTRACT.
 11337     MOVE +1                            TO SUB1.
 11338     PERFORM 3110-REINSURE-ISSUE-LOOP
 11339         THRU 3119-REINSURE-ISSUE-LOOP-END.
 11340
 11341     IF CR-LF-CANCEL-APPLIED  OR  CR-AH-CANCEL-APPLIED
 11342         PERFORM 2200-BUILD-CANCEL-EXTRACT THRU
 11343                                       2259-END-CANCEL-BUILD
 11344         PERFORM 1720-CHECK-COMM-LEVELS
 11345             THRU 1729-CHECK-COMM-LEVELS-EXIT
 11346                 VARYING SUB13 FROM +1 BY +1
 11347                     UNTIL SUB13 GREATER THAN 10
 11348         MOVE '7'                       TO DE-TRANS
 11349         MOVE RECALC-TYPE               TO DE-RECALC-TYPE
 11350*********PERFORM EXTRACT-DATE-RELOAD
 11351         MOVE DETAIL-EXTRACT            TO SAVE-EXTRACT
 11352         PERFORM 2500-WRITE-DETAIL-EXTRACTS THRU 2599-WRT-DETAIL-X
 11353         MOVE SAVE-EXTRACT              TO DETAIL-EXTRACT
 11354         PERFORM EXTRACT-DATE-LOAD
 11355         MOVE 'R'                       TO DE-REIN
 11356         MOVE DETAIL-EXTRACT            TO SAVE-EXTRACT
 11357         MOVE +1                        TO SUB1
 11358         PERFORM 3210-REINSURE-CANCEL-LOOP
 11359             THRU 3219-REINSURE-CANCEL-LOOP-END.
 11360
 11361 1719-DO-R-C-EXTRACTS-X.
 11362     EXIT.
 11363
 11364 1720-CHECK-COMM-LEVELS.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 221
* ECS010T1.cbl
 11365
 11366     IF  DE-AGT (SUB13)       =  SPACES  AND
 11367         DE-AGT-TYPE (SUB13)  =  SPACES  AND
 11368         DE-L-PC (SUB13)      =  ZEROS   AND
 11369         DE-A-PC (SUB13)      =  ZEROS
 11370         MOVE '0000000000'        TO  DE-AGT (SUB13).
 11371
 11372 1729-CHECK-COMM-LEVELS-EXIT.
 11373     EXIT.
 11374
 11375 1800-MOVE-NEW-COMM-RATES.
 11376     MOVE WK-NEW-RATES                  TO CR-COMPENSATION-LEVELS.
 11377     MOVE 'N'                           TO RECALC-TYPE.
 11378     PERFORM 1710-DO-R-C-EXTRACTS THRU 1719-DO-R-C-EXTRACTS-X.
 11379     MOVE SAVE-WK-NEW-RATES             TO WK-NEW-RATES
 11380                                           CR-COMPENSATION-LEVELS.
 11381     IF DTE-CLIENT = 'DCC'
 11382        IF CR-LF-NSP-PRM NOT = ZEROS
 11383           COMPUTE CR-LF-NSP-PRM ROUNDED =
 11384              (CR-LFPRM + CR-LFPRM-ALT) -
 11385              ((CR-LFPRM + CR-LFPRM-ALT) * CR-LCOM-L (1))
 11386        END-IF
 11387        IF (CR-AH-NSP-PRM NOT = ZEROS)
 11388           AND (CLAS-I-BEN-CATEGORY (CLAS-INDEXA)
 11389                                        NOT = 'G' AND 'L')
 11390           COMPUTE CR-AH-NSP-PRM ROUNDED =
 11391           CR-AHPRM -
 11392           (CR-AHPRM * CR-LCOM-AH (1))
 11393        END-IF
 11394     END-IF
 11395     .
 11396
 11397 1899-RECALC-COMM-EXTR-X.
 11398     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 222
* ECS010T1.cbl
 11400******************************************************************
 11401***      I N I T I A L I Z E   D E T A I L   E X T R A C T     ***
 11402******************************************************************
 11403
 11404 2000-INITIALIZE-DETAIL-EXTRACT.
 11405
 11406     MOVE SPACES                   TO DETAIL-EXTRACT.
 11407
 11408     MOVE 'DE'                     TO DE-RECORD-ID.
 11409     MOVE CR-COMPANY-CD            TO DE-COMPANY-CD.
 11410     MOVE CR-FULL-CONTROL          TO DE-CONTROL.
 11411
 11412     MOVE AM-REPORT-CODE-1         TO DE-REPORT-CODE-1.
 11413     MOVE AM-REPORT-CODE-2         TO DE-REPORT-CODE-2.
 11414
 11415     MOVE CR-NAME                  TO DE-NAME.
 11416     MOVE CR-AGE                   TO DE-AGE.
 11417     MOVE CR-SEX                   TO DE-SEX.
 11418     MOVE CR-SOC-SEC               TO DE-SOC-SEC-NO.
 11419
 11420     MOVE CR-LFTYP                 TO DE-LF-TYPE.
 11421     MOVE CR-LF-TERM               TO DE-LF-TERM.
 11422     MOVE CR-LFAMT                 TO DE-LF-BEN.
 11423     MOVE ZEROS                    TO DE-LF-CNBEN.
 11424     MOVE CR-LFPRM                 TO DE-LF-PRM.
 11425     MOVE CR-LFAMT-ALT             TO DE-LF-BEN-ALT.
 11426     MOVE ZEROS                    TO DE-LF-CNBEN-ALT.
 11427     MOVE CR-LFPRM-ALT             TO DE-LF-PRM-ALT.
 11428     MOVE ZEROS                    TO DE-LF-RFND.
 11429
 11430     MOVE CR-LF-CURRENT-STATUS     TO DE-LF-STAT-CDE.
 11431     MOVE ZEROS                    TO DE-LF-CANC-DTE
 11432                                      DE-LF-CANC-EXIT-DT.
 11433
 11434     MOVE CR-AHTYP                 TO DE-AH-TYPE.
 11435     MOVE CR-AH-TERM               TO DE-AH-TERM.
 11436     MOVE CR-AHAMT                 TO DE-AH-BEN.
 11437     MOVE CR-AHPRM                 TO DE-AH-PRM.
 11438     MOVE ZEROS                    TO DE-AH-RFND.
 11439
 11440     MOVE CR-AH-CURRENT-STATUS     TO DE-AH-STAT-CDE.
 11441     MOVE ZEROS                    TO DE-AH-CANC-DTE
 11442                                      DE-AH-CANC-EXIT-DT.
 11443     MOVE CR-MOB-NET-TOT-FEES      TO DE-MOB-NET-TOT-FEES.
 11444
 11445     IF DTE-CLIENT = 'DCC'
 11446        MOVE CR-ADDL-CLP         TO DE-ADDL-CLP
 11447        MOVE CR-CLP-STATE        TO DE-CLP-STATE
 11448     ELSE
 11449        IF (CR-LFTYP NOT = ZERO   AND
 11450           CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'Z')  OR
 11451           (CR-AHTYP NOT = ZERO  AND
 11452           CLAS-I-CALC-TYPE (CLAS-INDEXA) = 'Z')
 11453           MOVE CR-LIVES           TO DE-LIVES
 11454           MOVE ZERO               TO DE-CANCEL-CNT-ITD
 11455                                      DE-CANCEL-CNT-YTD
 11456        END-IF
 11457     END-IF
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 223
* ECS010T1.cbl
 11458
 11459     MOVE CR-MEMBER-NO             TO DE-MEMBER-NO.
 11460     IF AM-ZIP-PRIME NUMERIC
 11461        MOVE AM-ZIP-PRIME          TO DE-ZIP
 11462      ELSE
 11463        MOVE ZEROS                 TO DE-ZIP.
 11464     MOVE CR-LOAN-OFFICER          TO DE-LN-OFFICER.
 11465
 11466     MOVE CR-APR                   TO DE-APR.
 11467     MOVE CR-PMT-FREQ              TO DE-PMT-FREQ.
 11468     MOVE CR-GRPTYP                TO DE-ACC-GPCD.
 11469     MOVE CR-IND-GRP               TO DE-IG.
 11470     MOVE AM-REMIT-TO              TO DE-REMIT-TO.
 11471     MOVE CR-MEMBER-NO             TO DE-MEMBER-NO.
 11472
 11473     MOVE CR-ENTRY-STATUS          TO DE-ENTRY-STATUS.
 11474     MOVE CR-ENTRY-DATE            TO DE-ENTRY-DTE.
 11475
 11476     MOVE CR-UNDERWRITING-CODE     TO DE-UNDERWRITING-CODE.
 11477     MOVE AM-POOL-PRIME            TO DE-NCL-POOL-CODE.
 11478
 11479     MOVE ZEROS                    TO DE-REI-LFAMT  DE-REI-LFPRM
 11480                                      DE-REI-AHAMT  DE-REI-AHPRM
 11481                                      DE-REI-LFRFND DE-REI-AHRFND
 11482                                      DE-REI-CNAMT.
 11483
 11484     MOVE +1                       TO SUB1.
 11485
 11486     PERFORM EXTRACT-DATE-LOAD.
 11487
 11488     MOVE ZEROS                    TO WS-DE-PROC-DT-N
 11489                                      WS-DE-INCUR-N
 11490                                      WS-DE-PAY-N
 11491                                      WS-DE-PAID-TO-N
 11492                                      WS-DE-ACC-EXP-DTE-N
 11493                                      WS-DE-ACC-EFF-DTE-N
 11494                                      WS-DE-RSV-INCUR-N
 11495                                      WS-DE-RSV-PAYTO-N
 11496                                      WS-DE-ACC-EXP-DTE-RSV-N
 11497                                      WS-DE-ACC-EFF-DTE-RSV-N.
 11498
 11499 2090-GL-CODE-LOOP.
 11500
 11501     MOVE AM-GL-CODES (SUB1)       TO DE-GL-CODES (SUB1).
 11502
 11503     IF SUB1 LESS THAN +10
 11504         ADD +1 TO SUB1
 11505         GO TO 2090-GL-CODE-LOOP.
 11506
 11507     MOVE AM-RECALC-COMM           TO DE-RECALC-CODE.
 11508
 11509     MOVE CR-COMPENSATION-LEVELS   TO DE-COMM-LEVELS.
 11510
 11511     IF (DTE-CLIENT = 'DCC')
 11512        AND (CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'G' OR 'L')
 11513        AND (RECALC-TYPE = SPACES)
 11514        MOVE +1                  TO IA
 11515        IF CR-CERT-NO = '0008773536 '
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 224
* ECS010T1.cbl
 11516           DISPLAY ' MADE IT TO 2000 '
 11517           DISPLAY ' CERT AREA  REIN ' DE-REIN
 11518           PERFORM VARYING IB FROM +1 BY +1 UNTIL
 11519              (IB > +10)
 11520              IF CR-COM-AGT (IB) NOT = SPACES AND ZEROS
 11521                 MOVE IB TO DIL-BEN-CODE
 11522                 MOVE CR-LCOM-AH (IB) TO DIL-AMOUNT
 11523                 MOVE CR-COM-AGT (IB) TO DIL-COMMENT
 11524                 DISPLAY DISPLAY-IBNR-LINE
 11525              END-IF
 11526           END-PERFORM
 11527           DISPLAY ' TRLR AREA  '
 11528           DISPLAY ' CS CERT NO ' CS-CERT-NO
 11529           PERFORM VARYING IB FROM +1 BY +1 UNTIL
 11530              (IB > +10)
 11531              IF WS-BNK-AGT (IB) NOT = SPACES AND ZEROS
 11532                 MOVE IB TO DIL-BEN-CODE
 11533                 MOVE WS-BNK-SPP-FEES (IB) TO DIL-AMOUNT
 11534                 MOVE WS-BNK-AGT (IB) TO DIL-COMMENT
 11535                 DISPLAY DISPLAY-IBNR-LINE
 11536              END-IF
 11537           END-PERFORM
 11538        END-IF
 11539        PERFORM VARYING IB FROM +1 BY +1 UNTIL
 11540           IB > +10
 11541           IF DE-AGT (IB) NOT = SPACES AND ZEROS
 11542              CONTINUE
 11543           ELSE
 11544              IF WS-BNK-AGT (IA) NOT = SPACES AND ZEROS
 11545                 MOVE WS-BNK-AGT (IA)  TO DE-AGT (IB)
 11546                 MOVE WS-BNK-TYPE (IA) TO DE-AGT-TYPE (IB)
 11547                 COMPUTE DE-A-PC (IB) =
 11548                        WS-BNK-SPP-FEES (IA) / +1000
 11549                 MOVE +0              TO DE-L-PC (IB)
 11550                 ADD +1               TO IA
 11551              END-IF
 11552*             IF CS-AGT (IA) NOT = SPACES AND ZEROS
 11553*                MOVE CS-AGT (IA)     TO DE-AGT (IB)
 11554*                MOVE CS-COM-TYP (IA) TO DE-AGT-TYPE (IB)
 11555*                COMPUTE DE-A-PC (IB) = CS-SPP-FEES (IA) / +1000
 11556*                MOVE +0              TO DE-L-PC (IB)
 11557*                ADD +1               TO IA
 11558*             END-IF
 11559           END-IF
 11560        END-PERFORM
 11561     END-IF
 11562
 11563
 11564
 11565     .
 11566 2099-INIT-DTL-X.
 11567     EXIT.
 11568
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 225
* ECS010T1.cbl
 11570******************************************************************
 11571***            B U I L D   I S S U E   E X T R A C T           ***
 11572******************************************************************
 11573
 11574 2100-BUILD-ISSUE-EXTRACT.
 11575
 11576     PERFORM 2000-INITIALIZE-DETAIL-EXTRACT THRU 2099-INIT-DTL-X.
 11577
 11578     MOVE 'I'                      TO DE-TRANS.
 11579
 11580     IF CHECK-BILLED
 11581         MOVE 'N' TO BILLED-SWITCH
 11582     ELSE
 11583         GO TO 2190-WRITE-ISSUE-EXTRACT.
 11584
 11585     MOVE +1                        TO SUB1.
 11586 2150-GA-BILL-LOOP.
 11587
 11588     IF PB-GA-BILL-DT (SUB1) NOT = LOW-VALUES  AND  SPACES
 11589         MOVE 'B'                   TO DE-GA-BILL-STATUS (SUB1).
 11590
 11591     IF SUB1 LESS THAN +5
 11592         ADD +1 TO SUB1
 11593         GO TO 2150-GA-BILL-LOOP.
 11594
 11595     MOVE PB-RECORD-BILL            TO DE-BILL-SW.
 11596     MOVE ZEROS                     TO DE-BILLED-LFPRM
 11597                                       DE-BILLED-LFRFND
 11598                                       DE-BILLED-AHPRM
 11599                                       DE-BILLED-AHRFND.
 11600
 11601     IF PB-BILLED-DT = LOW-VALUES  OR  SPACES
 11602         IF PB-LF-BILLED-AMTS = ZERO  AND
 11603            PB-AH-BILLED-AMTS = ZERO
 11604             MOVE ' '                    TO DE-BILL-STATUS
 11605         ELSE
 11606             IF PB-LF-BILLED-AMTS = PB-I-LF-PREMIUM-AMT  AND
 11607                PB-AH-BILLED-AMTS = PB-I-AH-PREMIUM-AMT
 11608                 MOVE 'B'                TO DE-BILL-STATUS
 11609             ELSE
 11610                 MOVE 'R'                TO DE-BILL-STATUS
 11611                 MOVE PB-LF-BILLED-AMTS  TO DE-BILLED-LFPRM
 11612                 MOVE PB-AH-BILLED-AMTS  TO DE-BILLED-AHPRM
 11613     ELSE
 11614         MOVE 'B'                        TO DE-BILL-STATUS.
 11615
 11616 2190-WRITE-ISSUE-EXTRACT.
 11617
 11618     PERFORM 2500-WRITE-DETAIL-EXTRACTS THRU 2599-WRT-DETAIL-X.
 11619
 11620 2199-BLD-ISSUE-X.
 11621     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 226
* ECS010T1.cbl
 11623******************************************************************
 11624***           B U I L D   C A N C E L   E X T R A C T          ***
 11625******************************************************************
 11626
 11627 2200-BUILD-CANCEL-EXTRACT.
 11628
 11629     PERFORM 2000-INITIALIZE-DETAIL-EXTRACT THRU 2099-INIT-DTL-X.
 11630
 11631     MOVE 'C'                           TO DE-TRANS.
 11632
 11633     IF CR-LFTYP = ZERO
 11634         GO TO 2250-CONTINUE-CANCEL-BUILD.
 11635
 11636     IF CLAS-I-CALC-TYPE (CLAS-INDEXL) NOT = 'Z'
 11637         IF (CR-LF-STATUS-AT-CANCEL = ' ' OR '7')  AND
 11638             CR-LFRFND = +0
 11639              MOVE +0                   TO TEMP-5
 11640              GO TO 2250-CONTINUE-CANCEL-BUILD.
 11641
 11642     IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'Z'
 11643          IF CR-LFRFND = +0
 11644              GO TO 2250-CONTINUE-CANCEL-BUILD.
 11645
 11646     MOVE +1 TO TEMP-5.
 11647     MOVE CR-LF-TERM             TO ORIG-TERM.
 11648     MOVE CR-LF-CANC-DT          TO VALUATION-DT.
 11649     MOVE LIFE-OVERRIDE-L1       TO WE-LF-AH.
 11650     MOVE '1'                    TO W-VAL-SOURCE.
 11651     PERFORM 8500-REMAINING-TERM-ROUTINE THRU 8599-REM-TERM-X.
 11652
 11653     IF CLAS-I-RL-AH (CLAS-INDEXL) = 'L' OR 'P'
 11654         MOVE CR-LFAMT TO DE-LF-CNBEN
 11655         GO TO 2250-CONTINUE-CANCEL-BUILD.
 11656
 11657     IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'Z'
 11658         GO TO 2220-BLD-DE-CANCEL-SUM.
 11659
 11660     IF REM-TRM3 = CR-LF-TERM
 11661         MOVE CR-LFAMT TO DE-LF-CNBEN
 11662         GO TO 2250-CONTINUE-CANCEL-BUILD.
 11663
 11664     IF CLAS-I-EP (CLAS-INDEXL) = 'T'
 11665         GO TO 2210-BLD-DE-CANCEL-TEX.
 11666
 11667     IF DTE-CLIENT = 'NCL'
 11668         IF CR-DT LESS THAN 19910101
 11669             GO TO 2205-BLD-DE-CANCEL-BEN.
 11670
 11671     IF CLAS-I-EP (CLAS-INDEXL) = 'N'
 11672         GO TO 2230-BLD-DE-CANCEL-NP.
 11673
 11674     IF DTE-CLIENT = 'FUL'
 11675         GO TO 2240-BLD-DE-CANCEL-FUL.
 11676
 11677*    IF STATE-ABBR (CLAS-INDEXS) = 'OH'
 11678     IF (STATE-ABBR (CLAS-INDEXS) = 'OH') AND
 11679        (CR-RATING-CLASS NOT = 'L ')
 11680         IF (CR-APR GREATER THAN ZERO)  AND
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 227
* ECS010T1.cbl
 11681            (CR-LF-TERM GREATER THAN 060)  AND
 11682            (CR-DT GREATER THAN 19831031)
 11683              GO TO 2230-BLD-DE-CANCEL-NP.
 11684
 11685     IF STATE-ABBR (CLAS-INDEXS) = 'MT'
 11686         IF (CR-APR GREATER THAN ZERO)  AND
 11687            (CR-LF-TERM GREATER THAN 061)  AND
 11688            (CR-DT GREATER THAN 19830318)
 11689              GO TO 2230-BLD-DE-CANCEL-NP.
 11690
 11691     IF STATE-ABBR (CLAS-INDEXS) = 'UT'
 11692         IF (CR-APR GREATER THAN ZERO)  AND
 11693            (CR-LF-TERM GREATER THAN 062)  AND
 11694            (CR-DT GREATER THAN 19810831)  AND
 11695            (CR-DT LESS THAN 19830901)
 11696              GO TO 2230-BLD-DE-CANCEL-NP.
 11697
 11698     IF STATE-ABBR (CLAS-INDEXS) = 'RI'
 11699         IF (CR-APR GREATER THAN ZERO)  AND
 11700            (CR-LF-TERM GREATER THAN 060)  AND
 11701            (CR-DT GREATER THAN 19831231)
 11702              GO TO 2230-BLD-DE-CANCEL-NP.
 11703
 11704 2205-BLD-DE-CANCEL-BEN.
 11705
 11706     IF CR-LF-TERM EQUAL +0
 11707         MOVE +0          TO TEMP-5
 11708     ELSE
 11709         COMPUTE TEMP-5 = REM-TRM3 / CR-LF-TERM.
 11710
 11711     COMPUTE DE-LF-CNBEN = CR-LFAMT * TEMP-5.
 11712
 11713     GO TO 2250-CONTINUE-CANCEL-BUILD.
 11714
 11715 2210-BLD-DE-CANCEL-TEX.
 11716
 11717     DIVIDE CR-LFAMT BY CR-LF-TERM
 11718         GIVING TEX-FACT-1.
 11719     DIVIDE REM-TRM3 BY CR-PMT-FREQ
 11720         GIVING TEX-FACT-2
 11721             REMAINDER TEX-FACT-3.
 11722     IF TEX-FACT-3 NOT = ZERO
 11723         ADD +1 TO TEX-FACT-2.
 11724     COMPUTE DE-LF-CNBEN =
 11725         (TEX-FACT-1 * (TEX-FACT-2 * CR-PMT-FREQ)).
 11726
 11727     IF CR-LFAMT EQUAL +0
 11728         MOVE +0                  TO TEMP-5
 11729     ELSE
 11730         COMPUTE TEMP-5 = DE-LF-CNBEN / CR-LFAMT.
 11731
 11732     GO TO 2250-CONTINUE-CANCEL-BUILD.
 11733
 11734 2220-BLD-DE-CANCEL-SUM.
 11735
 11736     MOVE CR-SUM-CAN-CNT-YTD      TO DE-CANCEL-CNT-YTD.
 11737     MOVE CR-SUM-CAN-CNT-ITD      TO DE-CANCEL-CNT-ITD.
 11738
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 228
* ECS010T1.cbl
 11739     IF CR-LFRFND NOT LESS CR-LFPRM
 11740         MOVE CR-LFAMT           TO DE-LF-CNBEN
 11741          GO TO 2250-CONTINUE-CANCEL-BUILD.
 11742
 11743     COMPUTE TEMP-6 ROUNDED = CR-LFRFND / CR-LFPRM.
 11744     COMPUTE TEMP-7 ROUNDED = TEMP-6 * CR-LFAMT.
 11745     IF CLAS-I-RL-AH (CLAS-INDEXL) = 'L' OR 'P'
 11746         MOVE TEMP-7             TO DE-LF-CNBEN
 11747       ELSE
 11748         COMPUTE TEMP-5 = REM-TRM3 / CR-LF-TERM
 11749         COMPUTE DE-LF-CNBEN = TEMP-7 * TEMP-5.
 11750
 11751     IF CR-LFAMT EQUAL +0
 11752         MOVE +0                  TO TEMP-5
 11753     ELSE
 11754         COMPUTE TEMP-5 ROUNDED =  DE-LF-CNBEN / CR-LFAMT.
 11755
 11756     IF CLAS-I-EP (CLAS-INDEXL) NOT = 'N'
 11757         GO TO 2250-CONTINUE-CANCEL-BUILD.
 11758
 11759 2230-BLD-DE-CANCEL-NP.
 11760
 11761     MOVE CR-DT                      TO  DC-GREG-DATE-CYMD.
 11762     MOVE 'L'                        TO  DC-OPTION-CODE.
 11763     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 11764     MOVE DC-BIN-DATE-1              TO  CP-CERT-EFF-DT.
 11765
 11766     IF CR-LOAN-1ST-PMT-DT NOT = ZEROS
 11767       MOVE CR-LOAN-1ST-PMT-DT       TO  DC-GREG-DATE-1-YMD
 11768       MOVE '3'                      TO  DC-OPTION-CODE
 11769       PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X
 11770       MOVE DC-BIN-DATE-1            TO  CP-FIRST-PAY-DATE
 11771     ELSE
 11772       MOVE CP-CERT-EFF-DT           TO  DC-BIN-DATE-1
 11773       MOVE '6'                      TO  DC-OPTION-CODE
 11774       MOVE +1                       TO  DC-ELAPSED-MONTHS
 11775       MOVE +0                       TO  DC-ELAPSED-DAYS
 11776       PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X
 11777       MOVE DC-BIN-DATE-2            TO  CP-FIRST-PAY-DATE.
 11778
 11779     MOVE CR-RATING-CLASS            TO  CP-CLASS-CODE
 11780     MOVE CR-LFAMT                   TO  CP-ORIGINAL-BENEFIT.
 11781     MOVE CR-APR                     TO  CP-LOAN-APR.
 11782     MOVE CR-LF-TERM                 TO  CP-ORIGINAL-TERM.
 11783     MOVE CR-LOAN-TERM               TO  CP-LOAN-TERM.
 11784     MOVE REM-TRM3                   TO  CP-REMAINING-TERM.
 11785     MOVE CLAS-I-CALC-TYPE (CLAS-INDEXL) TO  CP-SPECIAL-CALC-CD.
 11786     MOVE CLAS-I-RL-AH     (CLAS-INDEXL) TO  CP-BENEFIT-TYPE.
 11787     MOVE CLAS-I-EP        (CLAS-INDEXL) TO  CP-EARNING-METHOD.
 11788
 11789     CALL 'ELRAMTX' USING CALCULATION-PASS-AREA.
 11790
 11791     IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'Z'
 11792         COMPUTE DE-LF-CNBEN =
 11793                 CP-REMAMT-FACTOR * (TEMP-7 / +1000)
 11794      ELSE
 11795          COMPUTE DE-LF-CNBEN =
 11796                  CP-REMAMT-FACTOR * (CR-LFAMT / +1000).
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 229
* ECS010T1.cbl
 11797
 11798     IF CR-LFAMT EQUAL +0
 11799         MOVE +0                  TO TEMP-5
 11800     ELSE
 11801         COMPUTE TEMP-5 = DE-LF-CNBEN / CR-LFAMT.
 11802
 11803     GO TO 2250-CONTINUE-CANCEL-BUILD.
 11804
 11805 2240-BLD-DE-CANCEL-FUL.
 11806
 11807     MOVE CR-APR                  TO NP-APR.
 11808     MOVE CR-LF-TERM              TO NP-ORIG.
 11809     MOVE REM-TRM3                TO NP-REM.
 11810     MOVE '2'                     TO NP-OPT.
 11811     MOVE CR-AHPRM                TO NP-AHPRM.
 11812     MOVE CR-ACCOUNT              TO NP-ACCOUNT.
 11813     MOVE CR-LFAMT                TO NP-BENEFIT.
 11814
 11815*    CALL 'FULNETRM'
 11816*        USING NP-APR NP-ORIG NP-REM NP-OPT NP-BENEFIT NP-AHPRM
 11817*              NP-ACCOUNT NP-REMAINING.
 11818
 11819     MOVE NP-REMAINING            TO DE-LF-CNBEN.
 11820
 11821     IF CR-LFAMT EQUAL +0
 11822         MOVE +0                  TO TEMP-5
 11823     ELSE
 11824         COMPUTE TEMP-5 = DE-LF-CNBEN / CR-LFAMT.
 11825
 11826 2250-CONTINUE-CANCEL-BUILD.
 11827
 11828     MOVE CR-LFRFND                   TO DE-LF-RFND.
 11829     MOVE CR-LF-STATUS-AT-CANCEL      TO DE-LF-PREV-STAT.
 11830     MOVE CR-LF-CANC-DT               TO DE-LF-CANC-DTE
 11831                                         WS-DE-LF-CANC-DTE-N.
 11832     MOVE CR-LF-CANCEL-EXIT-DATE      TO DE-LF-CANC-EXIT-DT
 11833                                         WS-DE-LF-CANC-EXIT-DT-N.
 11834     MOVE CR-LF-COMM-CHARGEBACK       TO DE-LF-COMM-CHARGEBACK.
 11835
 11836     MOVE CR-AHRFND                   TO DE-AH-RFND.
 11837
 11838     IF DTE-CLIENT = 'DCC'
 11839        IF DE-AH-RFND = ZEROS
 11840           MOVE ZEROS                 TO DE-ADDL-CLP
 11841        END-IF
 11842     END-IF
 11843
 11844     MOVE CR-AH-STATUS-AT-CANCEL      TO DE-AH-PREV-STAT.
 11845     MOVE CR-AH-CANC-DT               TO DE-AH-CANC-DTE
 11846                                         WS-DE-AH-CANC-DTE-N.
 11847     MOVE CR-AH-CANCEL-EXIT-DATE      TO DE-AH-CANC-EXIT-DT
 11848                                         WS-DE-AH-CANC-EXIT-DT-N.
 11849     MOVE CR-AH-COMM-CHARGEBACK       TO DE-AH-COMM-CHARGEBACK.
 11850
 11851     IF PB-LAST-MAINT-BY = 'E570'
 11852         MOVE 'R'                     TO DE-AUTO-GEND-IND.
 11853
 11854     IF CHECK-BILLED
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 230
* ECS010T1.cbl
 11855         MOVE 'N' TO BILLED-SWITCH
 11856     ELSE
 11857         GO TO 2259-END-CANCEL-BUILD.
 11858
 11859     MOVE +1                        TO SUB1.
 11860 2255-GA-BILL-LOOP.
 11861
 11862     IF PB-GA-BILL-DT (SUB1) NOT = LOW-VALUES  AND  SPACES
 11863         MOVE 'B'                   TO DE-GA-BILL-STATUS (SUB1).
 11864
 11865     IF SUB1 LESS THAN +5
 11866         ADD +1 TO SUB1
 11867         GO TO 2255-GA-BILL-LOOP.
 11868
 11869     MOVE PB-RECORD-BILL            TO DE-BILL-SW.
 11870     MOVE PB-C-REFUND-SW            TO DE-REFUND-SW.
 11871     MOVE ZEROS                     TO DE-BILLED-LFPRM
 11872                                       DE-BILLED-LFRFND
 11873                                       DE-BILLED-AHPRM
 11874                                       DE-BILLED-AHRFND.
 11875
 11876     IF PB-BILLED-DT = LOW-VALUES  OR  SPACES
 11877         IF PB-LF-BILLED-AMTS = ZERO  AND
 11878            PB-AH-BILLED-AMTS = ZERO
 11879             MOVE ' '                    TO DE-BILL-STATUS
 11880         ELSE
 11881             IF PB-LF-BILLED-AMTS = PB-C-LF-CANCEL-AMT  AND
 11882                PB-AH-BILLED-AMTS = PB-C-AH-CANCEL-AMT
 11883                 MOVE 'B'                TO DE-BILL-STATUS
 11884             ELSE
 11885                 MOVE 'R'                TO DE-BILL-STATUS
 11886                 MOVE PB-LF-BILLED-AMTS  TO DE-BILLED-LFRFND
 11887                 MOVE PB-AH-BILLED-AMTS  TO DE-BILLED-AHRFND
 11888     ELSE
 11889         MOVE 'B'                        TO DE-BILL-STATUS.
 11890
 11891 2259-END-CANCEL-BUILD.
 11892     EXIT.
 11893
 11894 2290-WRITE-CANCEL-EXTRACT.
 11895
 11896     PERFORM 2500-WRITE-DETAIL-EXTRACTS THRU 2599-WRT-DETAIL-X.
 11897
 11898 2299-BLD-CANCEL-X.
 11899     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 231
* ECS010T1.cbl
 11901******************************************************************
 11902***            B U I L D   C L A I M   E X T R A C T           ***
 11903******************************************************************
 11904
 11905 2300-BUILD-CLAIM-EXTRACT.
 11906
 11907     PERFORM 2000-INITIALIZE-DETAIL-EXTRACT THRU 2099-INIT-DTL-X.
 11908
 11909     MOVE 'X'                       TO DE-TRANS.
 11910
 11911     MOVE PC-CLAIM-TYPE             TO DE-TYPE.
 11912
 11913     MOVE PC-CLAIM-PAYMENT          TO DE-CLAIM-AMT.
 11914     MOVE ZEROS                     TO DE-REI-CLAIM-AMT.
 11915
 11916     MOVE INCURRED-DATE             TO DE-INCUR
 11917                                       WS-DE-INCUR-N.
 11918     MOVE REPORTED-DATE             TO DE-REPORTED.
 11919     MOVE PAYMENT-DATE              TO DE-PAY
 11920                                       WS-DE-PAY-N.
 11921     MOVE PAY-TO-DATE               TO DE-PAID-TO
 11922                                       WS-DE-PAID-TO-N.
 11923
 11924     MOVE PC-CLAIM-NO               TO DE-CNUM.
 11925     MOVE PC-CHECK-NO               TO DE-CHECK.
 11926     MOVE PC-TRLR-SEQ-NO            TO DE-PMT-TRAILER-SEQ.
 11927     MOVE PC-NO-OF-DAYS-PAID        TO DE-DAYS-DISAB.
 11928     MOVE PC-AGE-AT-CLAIM           TO DE-CLM-AGE.
 11929     MOVE PC-PAYMENT-TYPE           TO DE-PAY-CODE.
 11930     INSPECT DE-PAY-CODE
 11931         CONVERTING '1234569' TO 'PFSXEEV'.
 11932
 11933     MOVE AM-NAME                   TO DE-ACC-NAME.
 11934     MOVE AM-EXPIRE-DT              TO DE-ACC-EXP-DTE
 11935                                       WS-DE-ACC-EXP-DTE-N.
 11936     MOVE AM-EFFECT-DT              TO DE-ACC-EFF-DTE
 11937                                       WS-DE-ACC-EFF-DTE-N.
 11938     MOVE PC-CAUSE-CODE             TO DE-CLM-CAUSE.
 11939     MOVE CR-LOAN-OFFICER           TO DE-LOAN-OFFICER.
 11940
 11941     IF DE-DTH  OR  DE-OB-DTH
 11942         MOVE CR-LF-STATUS-AT-DEATH TO DE-LF-PREV-STAT
 11943     ELSE
 11944         IF CR-AH-LUMP-SUM-DISAB
 11945             MOVE CR-AH-STATUS-AT-SETTLEMENT
 11946                                    TO DE-AH-PREV-STAT.
 11947
 11948     IF PC-LAST-MAINT-BY EQUAL 'E570'
 11949         MOVE 'R'                     TO DE-AUTO-GEND-IND.
 11950
 11951 2390-WRITE-CLAIM-EXTRACT.
 11952
 11953     PERFORM 2500-WRITE-DETAIL-EXTRACTS THRU 2599-WRT-DETAIL-X.
 11954
 11955 2399-BLD-CLAIM-X.
 11956     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 232
* ECS010T1.cbl
 11958******************************************************************
 11959***          B U I L D   R E S E R V E   E X T R A C T         ***
 11960******************************************************************
 11961
 11962 2400-BUILD-RESERVE-EXTRACT.
 11963
 11964     PERFORM 2000-INITIALIZE-DETAIL-EXTRACT THRU 2099-INIT-DTL-X.
 11965
 11966     MOVE 'Y'                         TO DE-TRANS.
 11967     MOVE PC-CLAIM-TYPE               TO DE-RESERVE-TYPE.
 11968
 11969     MOVE PC-IBNR-RESERVE-AMT         TO DE-IBNR.
 11970     MOVE PC-PTC-RESERVE-AMT          TO DE-PAYCUR.
 11971     MOVE PC-FUTURE-RESERVE-AMT       TO DE-FUTRSV.
 11972     ADD  PC-MANUAL-RESERVE-AMT       TO DE-FUTRSV.
 11973
 11974     IF DTE-CLIENT  =  'NCL'
 11975        IF PC-MANUAL-RESERVE-AMT  GREATER THAN   ZEROS
 11976            MOVE 'Y'                  TO DE-MANUAL-RSV-SWITCH.
 11977
 11978     MOVE PC-CLAIM-NO                 TO DE-CLMNO.
 11979
 11980     MOVE AM-EXPIRE-DT                TO DE-ACC-EXP-DTE-RSV
 11981                                         WS-DE-ACC-EXP-DTE-RSV-N.
 11982
 11983     MOVE AM-EFFECT-DT                TO DE-ACC-EFF-DTE-RSV
 11984                                         WS-DE-ACC-EFF-DTE-RSV-N.
 11985
 11986     MOVE INCURRED-DATE               TO DE-RSV-INCUR
 11987                                         WS-DE-RSV-INCUR-N.
 11988     MOVE REPORTED-DATE               TO DE-RSV-REPORTED.
 11989     MOVE PAY-TO-DATE                 TO DE-RSV-PAYTO
 11990                                         WS-DE-RSV-PAYTO-N.
 11991
 11992     MOVE ZEROS                       TO DE-REI-IBNR
 11993                                         DE-REI-PAYCUR
 11994                                         DE-REI-FUTRSV.
 11995
 11996     MOVE AM-NAME                     TO DE-RSV-ACC-NAME.
 11997
 11998     IF PC-LAST-MAINT-BY EQUAL 'E570'
 11999         MOVE 'R'                     TO DE-AUTO-GEND-IND.
 12000
 12001 2490-WRITE-RESERVE-EXTRACT.
 12002
 12003     PERFORM 2500-WRITE-DETAIL-EXTRACTS THRU 2599-WRT-DETAIL-X.
 12004
 12005 2499-BLD-RESERVE-X.
 12006     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 233
* ECS010T1.cbl
 12008******************************************************************
 12009***          W R I T E   D E T A I L   E X T R A C T S         ***
 12010******************************************************************
 12011
 12012 2500-WRITE-DETAIL-EXTRACTS.
 12013
 12014
 12015     MOVE  ZEROS            TO  SUB.
 12016
 12017     IF  NOT  DE-CANCEL  AND   NOT  DE-RC-CANCEL
 12018         GO TO 2520-WRITE-CONTINUE.
 12019
 12020 2510-ZERO-CHARGEBACK-LOOP.
 12021
 12022     ADD  +1                TO  SUB.
 12023
 12024     IF  SUB    GREATER  THAN     +10
 12025         GO TO  2520-WRITE-CONTINUE.
 12026
 12027*    DISPLAY ' CERT NO ' CR-CERT-NO
 12028*    DISPLAY ' REFUND TYPE ' CR-AH-REFUND-TYPE
 12029*    DISPLAY '  SUB  ' SUB '   ' WS-AH-CHARGEBACK-SW (SUB)
 12030
 12031
 12032     IF  WS-LF-CHARGEBACK-SW (SUB)  = 'N'
 12033         MOVE  ZEROS            TO  DE-L-PC (SUB).
 12034
 12035     IF  (WS-AH-CHARGEBACK-SW (SUB)  = 'N')
 12036                   OR
 12037         ((CR-AH-REFUND-TYPE = 'G')
 12038         AND (CR-AHRFND = ZEROS))
 12039         MOVE  ZEROS             TO DE-A-PC (SUB)
 12040     END-IF
 12041
 12042     GO TO 2510-ZERO-CHARGEBACK-LOOP.
 12043
 12044 2520-WRITE-CONTINUE.
 12045
 12046     IF DTE-CLIENT NOT = 'HER'
 12047         GO TO 2590-WRITE-EXTRACTS.
 12048
 12049     IF DE-REINCO NOT = 'LNL'
 12050         GO TO 2590-WRITE-EXTRACTS.
 12051
 12052     IF DE-CLAIM  OR  DE-RESERVE  OR  DE-RR-RC-CLM
 12053         GO TO 2590-WRITE-EXTRACTS.
 12054
 12055     IF DE-AGT-TYPE (1)  = 'D'   MOVE 'C'    TO DE-AGT-TYPE (1).
 12056     IF DE-AGT-TYPE (2)  = 'P'   MOVE 'O'    TO DE-AGT-TYPE (2).
 12057     IF DE-AGT-TYPE (3)  = 'P'   MOVE 'O'    TO DE-AGT-TYPE (3).
 12058     IF DE-AGT-TYPE (4)  = 'P'   MOVE 'O'    TO DE-AGT-TYPE (4).
 12059     IF DE-AGT-TYPE (5)  = 'P'   MOVE 'O'    TO DE-AGT-TYPE (5).
 12060     IF DE-AGT-TYPE (6)  = 'P'   MOVE 'O'    TO DE-AGT-TYPE (6).
 12061     IF DE-AGT-TYPE (7)  = 'P'   MOVE 'O'    TO DE-AGT-TYPE (7).
 12062     IF DE-AGT-TYPE (8)  = 'P'   MOVE 'O'    TO DE-AGT-TYPE (8).
 12063     IF DE-AGT-TYPE (9)  = 'P'   MOVE 'O'    TO DE-AGT-TYPE (9).
 12064     IF DE-AGT-TYPE (10) = 'P'   MOVE 'O'    TO DE-AGT-TYPE (10).
 12065
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 234
* ECS010T1.cbl
 12066     IF DE-AGT-TYPE (1)  = 'S'   MOVE 'F'    TO DE-AGT-TYPE (1).
 12067     IF DE-AGT-TYPE (2)  = 'B'   MOVE 'G'    TO DE-AGT-TYPE (2).
 12068     IF DE-AGT-TYPE (3)  = 'B'   MOVE 'G'    TO DE-AGT-TYPE (3).
 12069     IF DE-AGT-TYPE (4)  = 'B'   MOVE 'G'    TO DE-AGT-TYPE (4).
 12070     IF DE-AGT-TYPE (5)  = 'B'   MOVE 'G'    TO DE-AGT-TYPE (5).
 12071     IF DE-AGT-TYPE (6)  = 'B'   MOVE 'G'    TO DE-AGT-TYPE (6).
 12072     IF DE-AGT-TYPE (7)  = 'B'   MOVE 'G'    TO DE-AGT-TYPE (7).
 12073     IF DE-AGT-TYPE (8)  = 'B'   MOVE 'G'    TO DE-AGT-TYPE (8).
 12074     IF DE-AGT-TYPE (9)  = 'B'   MOVE 'G'    TO DE-AGT-TYPE (9).
 12075     IF DE-AGT-TYPE (10) = 'B'   MOVE 'G'    TO DE-AGT-TYPE (10).
 12076
 12077
 12078 2590-WRITE-EXTRACTS.
 12079
 12080     MOVE EOM-RUN-DATE            TO DE-PROC-DT
 12081                                     WS-DE-PROC-DT-N.
 12082
 12083     IF DTE-PGM-OPT = '1'
 12084         ADD +1                   TO DE-CNT
 12085*********PERFORM EXTRACT-DATE-RELOAD
 12086         WRITE DETAIL-EXTRACT.
 12087
 12088
 12089 2599-WRT-DETAIL-X.
 12090     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 235
* ECS010T1.cbl
 12092******************************************************************
 12093***         R E I N S U R A N C E   P R O C E S S I N G        ***
 12094******************************************************************
 12095
 12096 3000-REINSURE-ROUTINE.
 12097
 12098     IF (CR-POLICY-IS-DECLINED) OR
 12099        (CR-POLICY-IS-VOID)
 12100        GO TO 3099-REINSURE-ROUTINE-X.
 12101
 12102     IF REIN-FLG = 'X'
 12103         GO TO 3099-REINSURE-ROUTINE-X.
 12104
 12105     MOVE 'X' TO REIN-FLG.
 12106
 12107     PERFORM CLEAR-REIN-HOLD THRU CLEAR-REIN-HOLD-X.
 12108
 12109     IF CR-REIN-TABLE = SPACES OR ZEROS
 12110         GO TO 3030-RE-CALCULATE-REINSURANCE.
 12111
 12112******************************************************************
 12113***    R E A D   R E I N S U R A N C E   T A B L E   F I L E   ***
 12114******************************************************************
 12115
 12116 3010-RR-READ-REIN.
 12117
 12118     IF REIN-OPEN-SW = ' '
 12119         MOVE 'X'                       TO REIN-OPEN-SW
 12120         MOVE DTE-CLASIC-COMPANY-CD     TO REIN-SRCH-COMP-CD
 12121         MOVE 'A'                       TO REIN-SRCH-CODE
 12122         OPEN INPUT ERRTBL-IN
 12123         IF ERRTBL-FILE-STATUS = '00'  OR  '97'
 12124             PERFORM REIN-CO-TABLE-BUILD THRU REIN-BUILD-EXIT
 12125          ELSE
 12126             MOVE '21'                  TO ABEND-CODE-1
 12127             MOVE ERRTBL-FILE-STATUS    TO ABEND-CODE-2
 12128             DISPLAY '******************************'
 12129             DISPLAY '***** ERROR LOCATION 015 *****'
 12130             DISPLAY '******************************'
 12131             MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
 12132             GO TO ABEND-PGM.
 12133
 12134     IF CR-REIN-TABLE = REIN-SRCH
 12135         GO TO 3019-RR-READ-REIN-X.
 12136
 12137     MOVE +0                            TO REIN-SUB-1.
 12138     MOVE 999999                        TO REIN-LOW-TIME.
 12139     MOVE CR-REIN-TABLE                 TO REIN-SRCH.
 12140
 12141 3011-RR-CHECK-REIN-SAVE-TABLE.
 12142
 12143     ADD +1                             TO REIN-SUB-1.
 12144     IF REIN-SUB-1 GREATER THAN REIN-MAX  OR
 12145        REIN-SUB-1 GREATER THAN REIN-SUB-2
 12146         GO TO 3015-RR-READ-ERRTBL.
 12147
 12148     IF REIN-SEARCH = SR-CONTROL (REIN-SUB-1)
 12149         MOVE SR-ENTRY (REIN-SUB-1)     TO REINSURANCE-RECORD
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 236
* ECS010T1.cbl
 12150         ACCEPT WS-TIME-OF-DAY   FROM TIME
 12151         MOVE WS-TIME                   TO SR-TIME (REIN-SUB-1)
 12152         GO TO 3019-RR-READ-REIN-X.
 12153
 12154     IF SR-TIME (REIN-SUB-1) LESS THAN REIN-LOW-TIME
 12155         MOVE SR-TIME (REIN-SUB-1)      TO REIN-LOW-TIME
 12156         MOVE REIN-SUB-1                TO REIN-LOW-SUB.
 12157
 12158     GO TO 3011-RR-CHECK-REIN-SAVE-TABLE.
 12159
 12160 3015-RR-READ-ERRTBL.
 12161
 12162     MOVE REIN-SEARCH                   TO RE-CONTROL-PRIMARY.
 12163
 12164     READ ERRTBL-IN.
 12165
 12166     IF ERRTBL-FILE-STATUS  = '23'
 12167         DISPLAY 'INVALID REINSURANCE TABLE CODE - ' REIN-SRCH
 12168                                           ' ' CR-FULL-CONTROL
 12169         MOVE '24'                      TO ABEND-CODE-1
 12170         MOVE ERRTBL-FILE-STATUS        TO ABEND-CODE-2
 12171         DISPLAY '******************************'
 12172         DISPLAY '***** ERROR LOCATION 016 *****'
 12173         DISPLAY '******************************'
 12174         MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
 12175         GO TO ABEND-PGM.
 12176
 12177     IF ERRTBL-FILE-STATUS  = '00'  OR  '97'
 12178         NEXT SENTENCE
 12179       ELSE
 12180         MOVE '24'                      TO ABEND-CODE-1
 12181         MOVE ERRTBL-FILE-STATUS        TO ABEND-CODE-2
 12182         DISPLAY '******************************'
 12183         DISPLAY '***** ERROR LOCATION 017 *****'
 12184         DISPLAY '******************************'
 12185         MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
 12186         GO TO ABEND-PGM.
 12187
 12188     ADD +1                            TO ERRTBL-READS.
 12189
 12190     IF REIN-SUB-1 GREATER THAN REIN-MAX
 12191         MOVE REINSURANCE-RECORD       TO SR-ENTRY (REIN-LOW-SUB)
 12192         ACCEPT WS-TIME-OF-DAY   FROM TIME
 12193         MOVE WS-TIME                  TO SR-TIME (REIN-LOW-SUB)
 12194     ELSE
 12195         MOVE REINSURANCE-RECORD       TO SR-ENTRY (REIN-SUB-1)
 12196         ACCEPT WS-TIME-OF-DAY   FROM TIME
 12197         MOVE WS-TIME                  TO SR-TIME (REIN-SUB-1)
 12198         MOVE REIN-SUB-1               TO REIN-SUB-2.
 12199
 12200 3019-RR-READ-REIN-X.
 12201     EXIT.
 12202
 12203 3020-CALCULATE-REINSURANCE.
 12204
 12205*    IF DTE-CLIENT = '???'  AND
 12206*       (CR-REIN-TABLE = 'SE1')
 12207*        PERFORM 3640-NSP-REIN-RATING-ROUTINE THRU 3669-NSP-REIN-X
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 237
* ECS010T1.cbl
 12208*        IF CR-STATE NOT = STATE-L
 12209*            MOVE CR-STATE             TO STATE-L
 12210*            PERFORM 8200-STATE-CODE-LOOKUP
 12211*                         THRU 8299-STATE-LOOKUP-X.
 12212
 12213
 12214*    IF DTE-CLIENT = 'DCC'
 12215*       IF CR-LF-NSP-PRM NOT = ZEROS
 12216*          COMPUTE CR-LF-NSP-PRM ROUNDED =
 12217*             (CR-LFPRM + CR-LFPRM-ALT) -
 12218*             ((CR-LFPRM + CR-LFPRM-ALT) * CR-LCOM-L (1))
 12219*       END-IF
 12220*       IF CR-AH-NSP-PRM NOT = ZEROS
 12221*          COMPUTE CR-AH-NSP-PRM ROUNDED =
 12222*          CR-AHPRM -
 12223*          (CR-AHPRM * CR-LCOM-AH (1))
 12224*       END-IF
 12225*    END-IF
 12226
 12227
 12228     IF RE-REMAINING (1) = 'I'
 12229         MOVE '*'                      TO RISK-REIN-FLAG
 12230     ELSE
 12231         GO TO 3029-CONTINUE-REIN-CALC.
 12232
 12233     MOVE SPACE                        TO REIN-CANCEL-LF-SW
 12234                                          REIN-CANCEL-AH-SW.
 12235     MOVE ZEROS                        TO REIN-EARN-LF-TERM
 12236                                          REIN-LCNC-EARN-TERM
 12237                                          REIN-LF-CLM-MONTHS
 12238                                          REIN-EARN-AH-TERM
 12239                                          REIN-ACNC-EARN-TERM
 12240                                          REIN-AH-PRIOR-CLMS-PAID
 12241                                          REIN-AH-CLM-MONTHS
 12242                                          REIN-AH-CLM-MTH-1
 12243                                          REIN-AH-CLM-MTH-2
 12244                                          REIN-AH-CLM-MTH-3
 12245                                          REIN-AH-CLM-MTH-4
 12246                                          REIN-AH-CLM-MTH-5.
 12247
 12248*    MOVE CR-DT                        TO DC-GREG-DATE-CYMD.
 12249*    MOVE 'L'                          TO DC-OPTION-CODE.
 12250*    PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 12251*    MOVE DC-BIN-DATE-1                TO WS-CR-BIN-DATE.
 12252
 12253     IF CR-LFTYP = ZEROS  OR  SPACES
 12254         GO TO 3023-CONTINUE.
 12255
 12256     MOVE EOM-RUN-DATE                 TO VALUATION-DT.
 12257
 12258     IF CR-LF-CANCEL-EXIT-DATE NOT = ZEROS
 12259       IF CR-LF-CANCEL-EXIT-DATE LESS THAN VALUATION-DT
 12260           MOVE CR-LF-CANCEL-EXIT-DATE TO VALUATION-DT.
 12261
 12262     IF CR-LF-CLAIM-EXIT-DATE NOT = ZEROS
 12263       IF CR-LF-CLAIM-EXIT-DATE LESS THAN VALUATION-DT
 12264           MOVE CR-LF-CLAIM-EXIT-DATE  TO VALUATION-DT.
 12265
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 238
* ECS010T1.cbl
 12266     MOVE VALUATION-DT                 TO DC-GREG-DATE-CYMD.
 12267     PERFORM 3025-CALC-ELAPSED-MONTHS THRU 3026-CALC-EXIT.
 12268
 12269     IF DC-ELAPSED-MONTHS GREATER THAN CR-LF-TERM
 12270         MOVE CR-LF-TERM               TO MONTHS-DIFF-LF
 12271     ELSE
 12272         MOVE DC-ELAPSED-MONTHS        TO MONTHS-DIFF-LF.
 12273
 12274     IF CR-LF-CANC-DT NOT = ZEROS
 12275         MOVE CR-LF-CANC-DT            TO DC-GREG-DATE-CYMD
 12276         PERFORM 3025-CALC-ELAPSED-MONTHS THRU 3026-CALC-EXIT
 12277         MOVE DC-ELAPSED-MONTHS        TO REIN-LCNC-EARN-TERM
 12278         IF CR-DT = CR-LF-CANC-DT
 12279             MOVE '*'                  TO REIN-CANCEL-LF-SW.
 12280
 12281     IF CR-DTH-DT NOT = ZEROS
 12282         MOVE CR-DTH-DT                TO DC-GREG-DATE-CYMD
 12283         PERFORM 3025-CALC-ELAPSED-MONTHS THRU 3026-CALC-EXIT
 12284         MOVE DC-ELAPSED-MONTHS        TO REIN-LF-CLM-MONTHS.
 12285
 12286     MOVE MONTHS-DIFF-LF               TO REIN-EARN-LF-TERM.
 12287
 12288
 12289 3023-CONTINUE.
 12290
 12291     IF CR-AHTYP = ZEROS  OR  SPACES
 12292        GO TO 3029-CONTINUE-REIN-CALC.
 12293
 12294     MOVE EOM-RUN-DATE                 TO VALUATION-DT.
 12295
 12296     IF CR-AH-CANCEL-EXIT-DATE NOT = ZEROS
 12297       IF CR-AH-CANCEL-EXIT-DATE LESS THAN VALUATION-DT
 12298           MOVE CR-AH-CANCEL-EXIT-DATE TO VALUATION-DT.
 12299
 12300     IF CR-AH-SETTLEMENT-EXIT-DATE NOT = ZEROS
 12301       IF CR-AH-SETTLEMENT-EXIT-DATE LESS THAN VALUATION-DT
 12302           MOVE CR-AH-SETTLEMENT-EXIT-DATE TO VALUATION-DT.
 12303
 12304     MOVE VALUATION-DT                 TO DC-GREG-DATE-CYMD.
 12305     PERFORM 3025-CALC-ELAPSED-MONTHS THRU 3026-CALC-EXIT.
 12306
 12307     IF DC-ELAPSED-MONTHS GREATER THAN CR-AH-TERM
 12308         MOVE CR-AH-TERM               TO MONTHS-DIFF-AH
 12309     ELSE
 12310         MOVE DC-ELAPSED-MONTHS        TO MONTHS-DIFF-AH.
 12311
 12312     IF CR-AH-CANC-DT NOT = ZEROS
 12313         MOVE CR-AH-CANC-DT           TO DC-GREG-DATE-CYMD
 12314         PERFORM 3025-CALC-ELAPSED-MONTHS THRU 3026-CALC-EXIT
 12315         MOVE DC-ELAPSED-MONTHS        TO REIN-ACNC-EARN-TERM
 12316         IF CR-DT = CR-AH-CANC-DT
 12317             MOVE '*'                  TO REIN-CANCEL-AH-SW.
 12318
 12319     IF CR-DIS-INCUR-DT (1) NOT = ZEROS
 12320         MOVE CR-DIS-INCUR-DT (1)    TO DC-GREG-DATE-CYMD
 12321         PERFORM 3025-CALC-ELAPSED-MONTHS THRU 3026-CALC-EXIT
 12322         MOVE DC-ELAPSED-MONTHS        TO REIN-AH-CLM-MTH-1.
 12323
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 239
* ECS010T1.cbl
 12324     IF CR-DIS-INCUR-DT (2) NOT = ZEROS
 12325         MOVE CR-DIS-INCUR-DT (2)    TO DC-GREG-DATE-CYMD
 12326         PERFORM 3025-CALC-ELAPSED-MONTHS THRU 3026-CALC-EXIT
 12327         MOVE DC-ELAPSED-MONTHS        TO REIN-AH-CLM-MTH-2.
 12328
 12329     IF CR-DIS-INCUR-DT (3) NOT = ZEROS
 12330         MOVE CR-DIS-INCUR-DT (3)      TO DC-GREG-DATE-CYMD
 12331         PERFORM 3025-CALC-ELAPSED-MONTHS THRU 3026-CALC-EXIT
 12332         MOVE DC-ELAPSED-MONTHS        TO REIN-AH-CLM-MTH-3.
 12333
 12334     IF CR-DIS-INCUR-DT (4) NOT = ZEROS
 12335         MOVE CR-DIS-INCUR-DT (4)    TO DC-GREG-DATE-CYMD
 12336         PERFORM 3025-CALC-ELAPSED-MONTHS THRU 3026-CALC-EXIT
 12337         MOVE DC-ELAPSED-MONTHS        TO REIN-AH-CLM-MTH-4.
 12338
 12339     IF CR-DIS-INCUR-DT (5) NOT = ZEROS
 12340         MOVE CR-DIS-INCUR-DT (5)    TO DC-GREG-DATE-CYMD
 12341         PERFORM 3025-CALC-ELAPSED-MONTHS THRU 3026-CALC-EXIT
 12342         MOVE DC-ELAPSED-MONTHS        TO REIN-AH-CLM-MTH-5.
 12343
 12344     MOVE MONTHS-DIFF-AH               TO REIN-EARN-AH-TERM.
 12345
 12346
 12347     GO TO 3029-CONTINUE-REIN-CALC.
 12348
 12349
 12350 3025-CALC-ELAPSED-MONTHS.
 12351
 12352     MOVE 'L'                          TO DC-OPTION-CODE.
 12353     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 12354     MOVE DC-BIN-DATE-1                TO DC-BIN-DATE-2.
 12355     MOVE WS-CR-BIN-DATE               TO DC-BIN-DATE-1.
 12356     MOVE '1'                          TO DC-OPTION-CODE.
 12357     MOVE ' '                          TO DC-CENTURY-ADJUSTMENT.
 12358     MOVE ZEROS                        TO DC-ELAPSED-MONTHS
 12359                                          DC-ODD-DAYS-OVER
 12360                                          DC-ELAPSED-DAYS.
 12361     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 12362
 12363 3026-CALC-EXIT.
 12364     EXIT.
 12365
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 240
* ECS010T1.cbl
 12367 3029-CONTINUE-REIN-CALC.
 12368
*12369                             COPY ECSRTPFM.
 12370******************************************************************07/10/97
 12371*                                                                *ECSRTPFM
 12372*                            ECSRTPFM                            *   LV001
 12373*                            VMOD=2.002                          *ECSRTPFM
 12374*                                                                *ECSRTPFM
 12375******************************************************************ECSRTPFM
 12376                                                                  ECSRTPFM
 12377     IF    CR-LFAMT  NUMERIC                                      00000072
 12378           NEXT SENTENCE                                          00000073
 12379        ELSE                                                      00000074
 12380           MOVE ZEROS TO CR-LFAMT.                                00000075
 12381                                                                  00000076
 12382     IF    CR-LFAMT-ALT  NUMERIC                                  00000077
 12383           NEXT SENTENCE                                          00000078
 12384        ELSE                                                      00000079
 12385           MOVE ZEROS TO CR-LFAMT-ALT.                            00000080
 12386                                                                  00000081
 12387                                                                  00000082
 12388     IF    CR-LFPRM  NUMERIC                                      00000083
 12389           NEXT SENTENCE                                          00000084
 12390        ELSE                                                      00000085
 12391           MOVE ZEROS TO CR-LFPRM.                                00000086
 12392                                                                  00000087
 12393     IF    CR-LFPRM-ALT  NUMERIC                                  00000088
 12394           NEXT SENTENCE                                          00000089
 12395        ELSE                                                      00000090
 12396           MOVE ZEROS TO CR-LFPRM-ALT.                            00000091
 12397                                                                  00000092
 12398                                                                  00000093
 12399     IF    CR-LFPRM-CALC  NUMERIC                                 00000094
 12400           NEXT SENTENCE                                          00000095
 12401        ELSE                                                      00000096
 12402           MOVE ZEROS TO CR-LFPRM-CALC.                           00000097
 12403                                                                  00000098
 12404     IF    CR-LFPRM-CALC-ALT  NUMERIC                             00000099
 12405           NEXT SENTENCE                                          00000100
 12406        ELSE                                                      00000101
 12407           MOVE ZEROS TO CR-LFPRM-CALC-ALT.                       00000102
 12408                                                                  00000103
 12409     IF    CR-LF-NSP-PRM  NUMERIC                                 00000104
 12410           NEXT SENTENCE                                          00000105
 12411        ELSE                                                      00000106
 12412           MOVE ZEROS TO CR-LF-NSP-PRM.                           00000107
 12413                                                                  00000108
 12414     COMPUTE RS-R-LB = CR-LFAMT + CR-LFAMT-ALT.                   ECSRTPFM
 12415     COMPUTE RS-R-LP = CR-LFPRM + CR-LFPRM-ALT.                   ECSRTPFM
 12416     IF RE-NSP-ST-CD-LF = ZEROS  OR  SPACES                       ECSRTPFM
 12417         COMPUTE RS-R-LPC = CR-LFPRM-CALC + CR-LFPRM-CALC-ALT     ECSRTPFM
 12418     ELSE                                                         ECSRTPFM
 12419         MOVE CR-LF-NSP-PRM         TO RS-R-LPC.                  ECSRTPFM
 12420     MOVE RS-R-LPC                  TO REIN-CALCED-LIFE.          ECSRTPFM
 12421                                                                  ECSRTPFM
 12422     MOVE CR-AHAMT                  TO RS-R-AB.                   ECSRTPFM
 12423     MOVE CR-AHPRM                  TO RS-R-AP.                   ECSRTPFM
 12424     IF RE-NSP-ST-CD-AH = ZEROS  OR  SPACES                       ECSRTPFM
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 241
* ECS010T1.cbl (/apps/prod/cid1p/copy/ECSRTPFM)
 12425         MOVE CR-AHPRM-CALC         TO RS-R-APC                   ECSRTPFM
 12426     ELSE                                                         ECSRTPFM
 12427         MOVE CR-AH-NSP-PRM         TO RS-R-APC.                  ECSRTPFM
 12428     MOVE RS-R-APC                  TO REIN-CALCED-AH.            ECSRTPFM
 12429                                                                  ECSRTPFM
 12430     PERFORM REINSURE-CALC THRU REINSURE-CALC-X                   ECSRTPFM
 12431         VARYING SUB1 FROM +1 BY +1                               ECSRTPFM
 12432             UNTIL RE-REI-COMP-NO (SUB1) = SPACES.                ECSRTPFM
 12433                                                                  ECSRTPFM
 12434
 12435     MOVE 'X'                  TO REIN-RT-SW.
 12436     PERFORM 3200-REINSURE-CANCEL THRU 3299-REINSURE-CANCEL-X.
 12437     PERFORM 3300-REINSURE-CLAIM THRU 3399-REINSURE-CLAIM-X.
 12438     MOVE ' '                  TO REIN-RT-SW.
 12439
 12440 3030-RE-CALCULATE-REINSURANCE.
 12441
 12442     IF AM-RECALC-REIN = 'Y'
 12443         IF CR-REIN-TABLE NOT = AM-REI-TABLE  AND
 12444            CR-REIN-SPEC = SPACE  AND
 12445            CR-ENTRY-DATE NOT = EOM-RUN-DATE
 12446             PERFORM 3600-RC-REINSURANCE
 12447                 THRU 3799-RC-REINSURANCE-X.
 12448
 12449     PERFORM 3040-REIN-REC-CNT THRU 3049-RRC-XIT
 12450         VARYING SUB1 FROM 1 BY 1
 12451             UNTIL REIN-COMP (SUB1) = SPACES.
 12452
 12453     GO TO 3099-REINSURE-ROUTINE-X.
 12454
 12455 3040-REIN-REC-CNT.
 12456
 12457     IF REIN-LF-AH-FLGS (SUB1) = SPACES
 12458         GO TO 3049-RRC-XIT.
 12459
 12460     PERFORM 3050-REIN-COMP-ADD THRU 3059-RCA-XIT
 12461         VARYING B-SUB FROM 1 BY 1
 12462             UNTIL B-SUB GREATER THAN 50.
 12463
 12464 3049-RRC-XIT.
 12465     EXIT.
 12466
 12467 3050-REIN-COMP-ADD.
 12468
 12469     IF RB-COMPANY (B-SUB) = SPACES
 12470         MOVE REIN-COMP (SUB1) TO RB-COMPANY (B-SUB).
 12471     IF RB-COMPANY (B-SUB) = REIN-COMP (SUB1)
 12472         MOVE 1   TO RB-COUNT (B-SUB)
 12473         MOVE +50 TO B-SUB.
 12474
 12475 3059-RCA-XIT.
 12476     EXIT.
 12477
 12478 3099-REINSURE-ROUTINE-X.
 12479     EXIT.
 12480
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 242
* ECS010T1.cbl
 12482******************************************************************
 12483***                R E I N S U R E   I S S U E S               ***
 12484******************************************************************
 12485
 12486 3100-REINSURE-ISSUE.
 12487
 12488     IF  REIN-COMP (1) = SPACES
 12489         GO TO 3199-REINSURE-ISSUE-X.
 12490
 12491     PERFORM 2000-INITIALIZE-DETAIL-EXTRACT THRU 2099-INIT-DTL-X.
 12492     MOVE ZEROS    TO RW-ACCUM-LF  RW-ACCUM-AH.
 12493     MOVE 'I'      TO DE-TRANS.
 12494     MOVE 'R'      TO DE-REIN.
 12495*****PERFORM EXTRACT-DATE-RELOAD.
 12496     MOVE DETAIL-EXTRACT TO SAVE-EXTRACT.
 12497     MOVE +1       TO SUB1.
 12498
 12499 3110-REINSURE-ISSUE-LOOP.
 12500
 12501     IF REIN-COMP (SUB1) = SPACES
 12502         GO TO 3119-REINSURE-ISSUE-LOOP-END.
 12503
 12504     IF UPDATING-RISK-PREMIUMS
 12505       IF REIN-REM-SW (SUB1) NOT = 'I'
 12506         ADD +1 TO SUB1
 12507         GO TO 3110-REINSURE-ISSUE-LOOP.
 12508
 12509     IF REIN-REM-SW (SUB1) = 'Z'
 12510         ADD +1 TO SUB1
 12511         GO TO 3110-REINSURE-ISSUE-LOOP.
 12512
 12513     MOVE REIN-COMP (SUB1)      TO DE-REI-COMP.
 12514     MOVE REIN-WORK-FLDS (SUB1) TO RWF-FIELDS.
 12515     MOVE RWF-LFAMT             TO DE-REI-LFAMT.
 12516     MOVE RWF-LFPRM             TO DE-REI-LFPRM.
 12517     MOVE RWF-AHAMT             TO DE-REI-AHAMT.
 12518     MOVE RWF-AHPRM             TO DE-REI-AHPRM.
 12519
 12520     IF REIN-REM-SW (SUB1) NOT = 'I'
 12521         GO TO 3115-CONTINUE-ISSUE-LOOP.
 12522
 12523     IF RWF-LFPRM = ZEROS  AND
 12524        RWF-AHPRM = ZEROS
 12525         GO TO 3115-CONTINUE-ISSUE-LOOP.
 12526
 12527     IF RWF-LFPRM NOT = ZEROS
 12528         COMPUTE DE-REI-LFPRM = RWF-LFPRM - CR-LF-REI-RISK-PRM
 12529         MOVE RWF-LFPRM         TO CR-LF-REI-RISK-PRM.
 12530
 12531     IF RWF-AHPRM NOT = ZEROS
 12532         COMPUTE DE-REI-AHPRM = RWF-AHPRM - CR-AH-REI-RISK-PRM
 12533         MOVE RWF-AHPRM         TO CR-AH-REI-RISK-PRM.
 12534
 12535 3115-CONTINUE-ISSUE-LOOP.
 12536
 12537     ADD DE-REI-LFPRM           TO RW-ACCUM-LF.
 12538     ADD DE-REI-AHPRM           TO RW-ACCUM-AH.
 12539
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 243
* ECS010T1.cbl
 12540     IF DE-REI-LFAMT NOT = ZERO
 12541        OR DE-REI-LFPRM NOT = ZERO
 12542        OR DE-REI-AHAMT NOT = ZERO
 12543        OR DE-REI-AHPRM NOT = ZERO
 12544         PERFORM 2500-WRITE-DETAIL-EXTRACTS THRU
 12545                 2599-WRT-DETAIL-X
 12546         ADD +1 TO BC-R-ISS.
 12547
 12548     ADD +1 TO SUB1.
 12549     MOVE SAVE-EXTRACT TO DETAIL-EXTRACT.
 12550     PERFORM EXTRACT-DATE-LOAD.
 12551
 12552     GO TO 3110-REINSURE-ISSUE-LOOP.
 12553
 12554 3119-REINSURE-ISSUE-LOOP-END.
 12555     EXIT.
 12556
 12557 3190-REINSURE-ISSUE-PRINT.
 12558
 12559     PERFORM 8600-SETUP-DETAIL-LINE THRU 8689-SETUP-DETAIL-X.
 12560     IF RW-ACCUM-LF NOT = ZERO
 12561         MOVE CLAS-I-AB3 (CLAS-INDEXL) TO TRD-LFTYP
 12562         MOVE CR-LF-TERM               TO TRD-LFTRM
 12563         MOVE RW-ACCUM-LF         TO TRD-LFPRM-RFND
 12564         MOVE 'REIN CEDED'        TO TRD-LF-ACTION.
 12565     IF RW-ACCUM-AH NOT = ZERO
 12566         MOVE CLAS-I-AB3 (CLAS-INDEXA) TO TRD-AHTYP
 12567         MOVE CR-AH-TERM               TO TRD-AHTRM
 12568         MOVE RW-ACCUM-AH         TO TRD-AHPRM-RFND
 12569         MOVE 'REIN CEDED'        TO TRD-AH-ACTION.
 12570     IF RW-ACCUM-LF NOT = ZERO  OR  RW-ACCUM-AH NOT = ZERO
 12571         PERFORM 8690-PRINT-DETAIL-LINE THRU 8699-PRT-DETAIL-X.
 12572
 12573 3199-REINSURE-ISSUE-X.
 12574     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 244
* ECS010T1.cbl
 12576******************************************************************
 12577***               R E I N S U R E   C A N C E L S              ***
 12578******************************************************************
 12579
 12580 3200-REINSURE-CANCEL.
 12581
 12582     IF REIN-COMP (1) = SPACES
 12583         GO TO 3299-REINSURE-CANCEL-X.
 12584
 12585     IF CR-LFRFND = ZERO
 12586        AND CR-AHRFND = ZERO
 12587         GO TO 3299-REINSURE-CANCEL-X.
 12588
 12589     PERFORM REINSURE-CALC-CANCEL THRU REINSURE-CALC-CANCEL-X
 12590             VARYING SUB1 FROM +1 BY +1 UNTIL
 12591                       REIN-COMP (SUB1) = SPACES.
 12592
 12593     IF REIN-RT-SW = 'X'
 12594         GO TO 3299-REINSURE-CANCEL-X.
 12595
 12596     PERFORM 2200-BUILD-CANCEL-EXTRACT THRU 2259-END-CANCEL-BUILD.
 12597     MOVE ZEROS    TO RW-ACCUM-LF  RW-ACCUM-AH.
 12598     MOVE 'R'      TO DE-REIN.
 12599*****PERFORM EXTRACT-DATE-RELOAD.
 12600     MOVE DETAIL-EXTRACT TO SAVE-EXTRACT.
 12601     MOVE +1       TO SUB1.
 12602
 12603 3210-REINSURE-CANCEL-LOOP.
 12604
 12605     IF REIN-COMP (SUB1) = SPACES
 12606         GO TO 3219-REINSURE-CANCEL-LOOP-END.
 12607
 12608     IF REIN-REM-SW (SUB1) = 'Z'
 12609         ADD +1        TO SUB1
 12610         MOVE SAVE-EXTRACT TO DETAIL-EXTRACT
 12611         PERFORM EXTRACT-DATE-LOAD
 12612         GO TO 3210-REINSURE-CANCEL-LOOP.
 12613
 12614     MOVE REIN-COMP (SUB1)      TO DE-REI-COMP.
 12615     MOVE REIN-WORK-FLDS (SUB1) TO RWF-FIELDS.
 12616
 12617     MOVE RWF-LFRFND            TO DE-REI-LFRFND.
 12618     MOVE RWF-AHRFND            TO DE-REI-AHRFND.
 12619     MOVE RWF-LFAMT             TO DE-REI-LFAMT.
 12620     MOVE RWF-LFPRM             TO DE-REI-LFPRM.
 12621     MOVE RWF-AHAMT             TO DE-REI-AHAMT.
 12622     MOVE RWF-AHPRM             TO DE-REI-AHPRM.
 12623     ADD RWF-LFRFND             TO RW-ACCUM-LF.
 12624     ADD RWF-AHRFND             TO RW-ACCUM-AH.
 12625     COMPUTE DE-REI-CNAMT = RWF-LFAMT * TEMP-5.
 12626
 12627     IF REIN-REM-SW (SUB1) NOT = 'I'
 12628         GO TO 3215-CONTINUE-CANCEL-LOOP.
 12629
 12630     IF CR-LF-CANCEL-EXIT-DATE = EOM-RUN-DATE  OR
 12631        VOIDING-LF-CANCEL
 12632         NEXT SENTENCE
 12633     ELSE
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 245
* ECS010T1.cbl
 12634         MOVE ZEROS             TO DE-REI-LFRFND.
 12635
 12636     IF CR-AH-CANCEL-EXIT-DATE = EOM-RUN-DATE  OR
 12637        VOIDING-AH-CANCEL
 12638         NEXT SENTENCE
 12639     ELSE
 12640         MOVE ZEROS             TO DE-REI-AHRFND.
 12641
 12642 3215-CONTINUE-CANCEL-LOOP.
 12643
 12644     IF RWF-LF-RUNOFF-SW = 'N'
 12645         IF DE-LF-CANC-DTE NOT LESS THAN RWF-EP-STOP-DATE
 12646             MOVE ZEROS         TO DE-LF-TYPE
 12647                                   DE-REI-LFAMT
 12648                                   DE-REI-LFPRM
 12649                                   DE-REI-LFRFND
 12650                                   DE-REI-CNAMT.
 12651
 12652     IF RWF-AH-RUNOFF-SW = 'N'
 12653         IF DE-AH-CANC-DTE NOT LESS THAN RWF-EP-STOP-DATE
 12654             MOVE ZEROS         TO DE-AH-TYPE
 12655                                   DE-REI-AHAMT
 12656                                   DE-REI-AHPRM
 12657                                   DE-REI-AHRFND.
 12658
 12659     IF DE-REI-LFAMT NOT = ZERO
 12660        OR DE-REI-LFPRM NOT = ZERO
 12661        OR DE-REI-AHAMT NOT = ZERO
 12662        OR DE-REI-AHPRM NOT = ZERO
 12663        OR DE-REI-LFRFND NOT = ZERO
 12664        OR DE-REI-AHRFND NOT = ZERO
 12665        OR DE-REI-CNAMT NOT = ZERO
 12666         PERFORM 2500-WRITE-DETAIL-EXTRACTS THRU
 12667                                            2599-WRT-DETAIL-X
 12668         ADD +1 TO BC-R-CNC.
 12669
 12670     ADD +1 TO SUB1.
 12671     MOVE SAVE-EXTRACT TO DETAIL-EXTRACT.
 12672     PERFORM EXTRACT-DATE-LOAD.
 12673     GO TO 3210-REINSURE-CANCEL-LOOP.
 12674
 12675 3219-REINSURE-CANCEL-LOOP-END.
 12676     EXIT.
 12677
 12678 3290-REINSURE-CANCEL-PRINT.
 12679
 12680     PERFORM 8600-SETUP-DETAIL-LINE THRU 8689-SETUP-DETAIL-X.
 12681     IF RW-ACCUM-LF NOT = ZERO
 12682         MOVE CLAS-I-AB3 (CLAS-INDEXL) TO TRD-LFTYP
 12683         MOVE CR-LF-TERM               TO TRD-LFTRM
 12684         MOVE RW-ACCUM-LF         TO TRD-LFPRM-RFND
 12685         MOVE 'REIN CANCL'        TO TRD-LF-ACTION.
 12686     IF RW-ACCUM-AH NOT = ZERO
 12687         MOVE CLAS-I-AB3 (CLAS-INDEXA) TO TRD-AHTYP
 12688         MOVE CR-AH-TERM               TO TRD-AHTRM
 12689         MOVE RW-ACCUM-AH         TO TRD-AHPRM-RFND
 12690         MOVE 'REIN CANCL'        TO TRD-AH-ACTION.
 12691     IF RW-ACCUM-LF NOT = ZERO  OR  RW-ACCUM-AH NOT = ZERO
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 246
* ECS010T1.cbl
 12692         PERFORM 8690-PRINT-DETAIL-LINE THRU 8699-PRT-DETAIL-X.
 12693
 12694 3299-REINSURE-CANCEL-X.
 12695     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 247
* ECS010T1.cbl
 12697******************************************************************
 12698***                R E I N S U R E   C L A I M S               ***
 12699******************************************************************
 12700
 12701 3300-REINSURE-CLAIM.
 12702
 12703*    IF DTE-CLIENT = '???'
 12704*       IF (REIN-RT-SW NOT = 'X')  AND
 12705*          (PC-PAYMENT-TYPE = '5' OR '6')
 12706*        GO TO 3399-REINSURE-CLAIM-X.
 12707
 12708     IF REIN-COMP (1) = SPACES
 12709         GO TO 3399-REINSURE-CLAIM-X.
 12710
 12711     IF REIN-RT-SW = 'X'
 12712         MOVE CR-DTHAMT   TO RW-LFCLMWK
 12713         ADD  CR-DTHEXP   TO RW-LFCLMWK
 12714         MOVE CR-DISAMT   TO RW-AHCLMWK
 12715         ADD  CR-DISEXP   TO RW-AHCLMWK
 12716     ELSE
 12717         IF PC-CLAIM-TYPE  = 1 OR 3
 12718             MOVE PC-CLAIM-PAYMENT    TO RW-LFCLMWK
 12719             MOVE +0                  TO RW-AHCLMWK
 12720         ELSE
 12721             MOVE PC-CLAIM-PAYMENT    TO RW-AHCLMWK
 12722             MOVE +0                  TO RW-LFCLMWK.
 12723
 12724     MOVE +0                          TO RW-LFCLM
 12725                                         RW-AHCLM.
 12726     IF RW-LFCLMWK = ZERO
 12727        AND RW-AHCLMWK = ZERO
 12728         GO TO 3399-REINSURE-CLAIM-X.
 12729
 12730     PERFORM REINSURE-CALC-CLAIM THRU REINSURE-CALC-CLAIM-X
 12731         VARYING SUB1 FROM +1 BY +1
 12732             UNTIL REIN-COMP (SUB1) = SPACES.
 12733
 12734     IF REIN-RT-SW = 'X'
 12735         GO TO 3399-REINSURE-CLAIM-X.
 12736
 12737     PERFORM 2300-BUILD-CLAIM-EXTRACT.
 12738     MOVE ZEROS                TO RW-ACCUM-CLM.
 12739     MOVE 'R'                  TO DE-REIN.
 12740*****PERFORM EXTRACT-DATE-RELOAD.
 12741     MOVE DETAIL-EXTRACT       TO SAVE-EXTRACT.
 12742     MOVE +1                   TO SUB1.
 12743
 12744 3310-REINSURE-CLAIM-LOOP.
 12745
 12746     IF REIN-COMP (SUB1) = SPACES
 12747         GO TO 3390-REINSURE-CLAIM-PRINT.
 12748
 12749     IF REIN-REM-SW (SUB1) = 'Z'
 12750         ADD +1        TO SUB1
 12751         MOVE SAVE-EXTRACT TO DETAIL-EXTRACT
 12752         PERFORM EXTRACT-DATE-LOAD
 12753         GO TO 3310-REINSURE-CLAIM-LOOP.
 12754
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 248
* ECS010T1.cbl
 12755     MOVE REIN-COMP (SUB1)      TO DE-REI-COMP.
 12756     MOVE REIN-WORK-FLDS (SUB1) TO RWF-FIELDS.
 12757
 12758     IF PC-CLAIM-TYPE  = 1 OR 3
 12759         IF RWF-LF-RUNOFF-SW = 'N'
 12760           IF CR-DTH-DT NOT LESS THAN RWF-EP-STOP-DATE
 12761               GO TO 3330-REINSURE-CLAIM-LOOP-ADD.
 12762
 12763     IF PC-CLAIM-TYPE  = 2 OR 4
 12764         IF RWF-AH-RUNOFF-SW = 'N'
 12765           IF CR-DIS-DT NOT LESS THAN RWF-EP-STOP-DATE
 12766               GO TO 3330-REINSURE-CLAIM-LOOP-ADD.
 12767
 12768     MOVE RWF-LFAMT             TO DE-REI-LFAMT.
 12769     MOVE RWF-LFPRM             TO DE-REI-LFPRM.
 12770     MOVE RWF-AHAMT             TO DE-REI-AHAMT.
 12771     MOVE RWF-AHPRM             TO DE-REI-AHPRM.
 12772
 12773     IF PC-CLAIM-TYPE  = 1 OR 3
 12774         MOVE RWF-LFCLML TO DE-REI-CLAIM-AMT
 12775         ADD RWF-LFCLML  TO RW-ACCUM-CLM
 12776     ELSE
 12777         MOVE RWF-AHCLML TO DE-REI-CLAIM-AMT
 12778         ADD RWF-AHCLML  TO RW-ACCUM-CLM.
 12779
 12780     IF PC-CLAIM-TYPE = 1 OR 3
 12781         IF +0 = DE-REI-LFPRM AND DE-REI-LFAMT
 12782            AND DE-REI-CLAIM-AMT
 12783             GO TO 3330-REINSURE-CLAIM-LOOP-ADD
 12784         ELSE
 12785             GO TO 3320-REINSURE-CLAIM-LOOP-GO
 12786     ELSE
 12787         IF +0 = DE-REI-AHPRM AND DE-REI-AHAMT
 12788            AND DE-REI-CLAIM-AMT
 12789             GO TO 3330-REINSURE-CLAIM-LOOP-ADD
 12790         ELSE
 12791             GO TO 3320-REINSURE-CLAIM-LOOP-GO.
 12792
 12793 3320-REINSURE-CLAIM-LOOP-GO.
 12794
 12795     PERFORM 2500-WRITE-DETAIL-EXTRACTS THRU 2599-WRT-DETAIL-X.
 12796     ADD +1                     TO BC-R-CLM.
 12797
 12798 3330-REINSURE-CLAIM-LOOP-ADD.
 12799
 12800     ADD +1                     TO SUB1.
 12801     MOVE SAVE-EXTRACT          TO DETAIL-EXTRACT.
 12802     PERFORM EXTRACT-DATE-LOAD.
 12803     GO TO 3310-REINSURE-CLAIM-LOOP.
 12804
 12805 3390-REINSURE-CLAIM-PRINT.
 12806
 12807     PERFORM 8600-SETUP-DETAIL-LINE THRU 8689-SETUP-DETAIL-X.
 12808     IF PC-CLAIM-TYPE = '1'  OR  '3'
 12809         MOVE CLAS-I-AB3 (CLAS-INDEXL) TO TRD-LFTYP
 12810         MOVE CR-LF-TERM               TO TRD-LFTRM
 12811         MOVE RW-ACCUM-CLM     TO TRD-LFCOM-CLM
 12812         MOVE 'REIN CLAIM'     TO TRD-LF-ACTION
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 249
* ECS010T1.cbl
 12813     ELSE
 12814         MOVE CLAS-I-AB3 (CLAS-INDEXA) TO TRD-AHTYP
 12815         MOVE CR-AH-TERM               TO TRD-AHTRM
 12816         MOVE RW-ACCUM-CLM     TO TRD-AHCOM-CLM
 12817         MOVE CR-DIS-MO        TO TRD-AHACTMO
 12818         MOVE CR-DIS-DA        TO TRD-AHACTDA
 12819         MOVE CR-DIS-YR        TO TRD-AHACTYR
 12820         MOVE '/'              TO TRD-AH-S1  TRD-AH-S2
 12821         MOVE 'REIN CLAIM'     TO TRD-AH-ACTION.
 12822     PERFORM 8690-PRINT-DETAIL-LINE THRU 8699-PRT-DETAIL-X.
 12823
 12824 3399-REINSURE-CLAIM-X.
 12825     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 250
* ECS010T1.cbl
 12827******************************************************************
 12828***              R E I N S U R E   R E S E R V E S             ***
 12829******************************************************************
 12830
 12831 3400-REINSURE-RESERVE.
 12832
 12833     IF REIN-COMP (1) = SPACES
 12834         GO TO 3499-REINSURE-RESERVE-X.
 12835
 12836     IF PC-CLAIM-TYPE = '1' OR '3'
 12837         MOVE PC-IBNR-RESERVE-AMT    TO RW-LFIBNRWK
 12838         MOVE PC-PTC-RESERVE-AMT     TO RW-LFPAYCURWK
 12839         MOVE PC-FUTURE-RESERVE-AMT  TO RW-LFFUTRSVWK
 12840         ADD  PC-MANUAL-RESERVE-AMT  TO RW-LFFUTRSVWK
 12841         MOVE +0 TO RW-AHIBNRWK  RW-AHPAYCURWK  RW-AHFUTRSVWK
 12842     ELSE
 12843         MOVE PC-IBNR-RESERVE-AMT    TO RW-AHIBNRWK
 12844         MOVE PC-PTC-RESERVE-AMT     TO RW-AHPAYCURWK
 12845         MOVE PC-FUTURE-RESERVE-AMT  TO RW-AHFUTRSVWK
 12846         ADD  PC-MANUAL-RESERVE-AMT  TO RW-AHFUTRSVWK
 12847         MOVE +0 TO RW-LFIBNRWK  RW-LFPAYCURWK  RW-LFFUTRSVWK.
 12848
 12849     MOVE +0 TO RW-LFIBNR  RW-LFPAYCUR  RW-LFFUTRSV
 12850                RW-AHIBNR  RW-AHPAYCUR  RW-AHFUTRSV.
 12851     IF +0 = RW-LFIBNRWK AND RW-LFPAYCURWK AND RW-LFFUTRSVWK
 12852         AND RW-AHIBNRWK AND RW-AHPAYCURWK AND RW-AHFUTRSVWK
 12853          GO TO 3499-REINSURE-RESERVE-X.
 12854
 12855     IF DTE-CLIENT NOT = 'MIC'
 12856         GO TO 3405-REINSURE-RESERVE-CONT.
 12857
 12858     IF PC-CLAIM-TYPE = '1'  OR  '3'
 12859         GO TO 3405-REINSURE-RESERVE-CONT.
 12860
 12861     MOVE PC-CERT-EFF-DT             TO CP-CERT-EFF-DT.
 12862     MOVE BIN-VALUATION-DT           TO CP-VALUATION-DT.
 12863     MOVE PC-PAID-THRU-DT            TO CP-PAID-THRU-DT.
 12864     MOVE 'A'                        TO CP-BENEFIT-TYPE
 12865                                        CP-CLAIM-TYPE.
 12866     MOVE PC-INCURRED-DT             TO CP-INCURRED-DT.
 12867     MOVE PC-REPORTED-DT             TO CP-REPORTED-DT.
 12868     MOVE DTE-CLIENT                 TO CP-COMPANY-ID.
 12869     MOVE CR-AGE                     TO CP-ISSUE-AGE.
 12870     MOVE ZEROS                      TO CP-CDT-PERCENT.
 12871     MOVE '3'                        TO CP-CDT-METHOD.
 12872     MOVE CR-AH-TERM                 TO CP-ORIGINAL-TERM.
 12873     MOVE CR-AHAMT                   TO CP-ORIGINAL-BENEFIT
 12874                                        CP-RATING-BENEFIT-AMT.
 12875     MOVE PC-REMAINING-TERM          TO CP-REMAINING-TERM.
 12876     MOVE 'O'                        TO CP-CLAIM-STATUS.
 12877
 12878 3405-REINSURE-RESERVE-CONT.
 12879
 12880     PERFORM 3500-REINSURE-CALC-RESERVE
 12881         THRU 3599-REINSURE-CALC-RESERVE-X
 12882             VARYING SUB1 FROM +1 BY +1
 12883                 UNTIL REIN-COMP (SUB1) = SPACES.
 12884
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 251
* ECS010T1.cbl
 12885     PERFORM 2400-BUILD-RESERVE-EXTRACT.
 12886     MOVE +0 TO RW-ACCUM-IBNR  RW-ACCUM-PAYCUR  RW-ACCUM-FUTRSV.
 12887     MOVE 'R'            TO DE-REIN.
 12888*****PERFORM EXTRACT-DATE-RELOAD.
 12889     MOVE DETAIL-EXTRACT TO SAVE-EXTRACT.
 12890     MOVE +1             TO SUB1.
 12891
 12892 3410-REINSURE-RESERVE-LOOP.
 12893
 12894     IF REIN-COMP (SUB1) = SPACES
 12895         GO TO 3490-REINSURE-RESERVE-PRINT.
 12896
 12897     IF REIN-REM-SW (SUB1) = 'Z'
 12898         ADD +1 TO SUB1
 12899         GO TO 3410-REINSURE-RESERVE-LOOP.
 12900
 12901     MOVE REIN-COMP (SUB1)      TO DE-REI-COMP.
 12902     MOVE REIN-WORK-FLDS (SUB1) TO RWF-FIELDS.
 12903
 12904     IF PC-CLAIM-TYPE  = 1 OR 3
 12905         IF RWF-LF-RUNOFF-SW = 'N'
 12906           IF CR-DTH-DT NOT LESS THAN RWF-EP-STOP-DATE
 12907               GO TO 3415-REINSURE-RESERVE-LOOP-ADD.
 12908
 12909     IF PC-CLAIM-TYPE  = 2 OR 4
 12910         IF RWF-AH-RUNOFF-SW = 'N'
 12911           IF CR-DIS-DT NOT LESS THAN RWF-EP-STOP-DATE
 12912               GO TO 3415-REINSURE-RESERVE-LOOP-ADD.
 12913
 12914     MOVE RWF-LFAMT             TO DE-REI-LFAMT.
 12915     MOVE RWF-LFPRM             TO DE-REI-LFPRM.
 12916     MOVE RWF-AHAMT             TO DE-REI-AHAMT.
 12917     MOVE RWF-AHPRM             TO DE-REI-AHPRM.
 12918
 12919     IF PC-CLAIM-TYPE = 1 OR 3
 12920         MOVE RWF-DTH-IBNRL   TO DE-REI-IBNR
 12921         MOVE RWF-DTH-PAYCURL TO DE-REI-PAYCUR
 12922         MOVE RWF-DTH-FUTRSVL TO DE-REI-FUTRSV
 12923     ELSE
 12924         MOVE RWF-DIS-IBNRL   TO DE-REI-IBNR
 12925         MOVE RWF-DIS-PAYCURL TO DE-REI-PAYCUR
 12926         MOVE RWF-DIS-FUTRSVL TO DE-REI-FUTRSV.
 12927
 12928     ADD DE-REI-IBNR            TO RW-ACCUM-IBNR.
 12929     ADD DE-REI-PAYCUR          TO RW-ACCUM-PAYCUR.
 12930     ADD DE-REI-FUTRSV          TO RW-ACCUM-FUTRSV.
 12931
 12932     IF +0 NOT = DE-REI-LFAMT OR DE-REI-LFPRM OR DE-REI-AHAMT
 12933        OR DE-REI-AHPRM OR DE-REI-IBNR OR DE-REI-PAYCUR
 12934        OR DE-REI-FUTRSV
 12935         PERFORM 2500-WRITE-DETAIL-EXTRACTS THRU
 12936                                            2599-WRT-DETAIL-X
 12937         ADD +1 TO BC-R-CRS.
 12938
 12939 3415-REINSURE-RESERVE-LOOP-ADD.
 12940
 12941     ADD +1 TO SUB1.
 12942     MOVE SAVE-EXTRACT TO DETAIL-EXTRACT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 252
* ECS010T1.cbl
 12943     PERFORM EXTRACT-DATE-LOAD.
 12944     GO TO 3410-REINSURE-RESERVE-LOOP.
 12945
 12946 3490-REINSURE-RESERVE-PRINT.
 12947
 12948     IF RW-ACCUM-IBNR   = ZERO  AND
 12949        RW-ACCUM-PAYCUR = ZERO  AND
 12950        RW-ACCUM-FUTRSV = ZERO
 12951         GO TO 3499-REINSURE-RESERVE-X.
 12952
 12953     PERFORM 8600-SETUP-DETAIL-LINE THRU 8689-SETUP-DETAIL-X.
 12954     MOVE RW-ACCUM-IBNR             TO TRD-IBNR.
 12955     MOVE 'IBNR'                    TO TRD-IBNRX.
 12956     MOVE RW-ACCUM-PAYCUR           TO TRD-PAYCUR.
 12957     MOVE 'PAY CURR'                TO TRD-PAYCURX.
 12958     MOVE RW-ACCUM-FUTRSV           TO TRD-FUTRSV.
 12959     MOVE 'FUTURE'                  TO TRD-FUTRSVX.
 12960
 12961     IF PC-CLAIM-TYPE = 1
 12962         MOVE LIFE-OVERRIDE-L6      TO TRD-RSV-DESC
 12963     ELSE
 12964         MOVE AH-OVERRIDE-L6        TO TRD-RSV-DESC.
 12965     MOVE ' REIN. CLAIM RESERVES'   TO TRD-RSV-ACTION.
 12966
 12967     PERFORM 8690-PRINT-DETAIL-LINE THRU 8699-PRT-DETAIL-X.
 12968
 12969 3499-REINSURE-RESERVE-X.
 12970     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 253
* ECS010T1.cbl
 12972******************************************************************
 12973***        C A L C U L A T E   R E I N   R E S E R V E S       ***
 12974******************************************************************
 12975
 12976 3500-REINSURE-CALC-RESERVE.
 12977
 12978     MOVE REIN-WORK-FLDS (SUB1) TO RWF-FIELDS.
 12979     MOVE +0 TO RWF-DTH-IBNRL RWF-DTH-PAYCURL  RWF-DTH-FUTRSVL
 12980                RWF-DIS-IBNRL  RWF-DIS-PAYCURL  RWF-DIS-FUTRSVL.
 12981
 12982     PERFORM REIN-FIND-CO-LOOP THRU FIND-REI-CO-EXIT
 12983        VARYING CO-SUB FROM 1 BY 1 UNTIL
 12984          (RCT-REIN-CO (CO-SUB) = REIN-COMP (SUB1))
 12985       OR (CO-SUB GREATER REIN-CO-TABLE-ENT-CNT).
 12986
 12987     IF CO-SUB GREATER REIN-CO-TABLE-ENT-CNT
 12988        MOVE ZERO TO CO-SUB.
 12989
 12990     IF CO-SUB NOT = ZERO
 12991        IF RCT-CLM-CUTOFF-DT (CO-SUB) NOT = ZERO
 12992           IF PC-CLAIM-TYPE = '1' OR '3'
 12993             IF CR-DTH-DT LESS THAN RCT-CLM-CUTOFF-DT (CO-SUB)
 12994                 GO TO 3540-CONT-REIN-CALC-RESERVE.
 12995
 12996     IF PC-CLAIM-TYPE  = 1 OR 3
 12997         IF RWF-LF-RUNOFF-SW = 'N'
 12998           IF CR-DTH-DT NOT LESS THAN RWF-EP-STOP-DATE
 12999               GO TO 3540-CONT-REIN-CALC-RESERVE.
 13000
 13001     IF CO-SUB NOT = ZERO
 13002        IF RCT-CLM-CUTOFF-DT (CO-SUB) NOT = ZERO
 13003           IF PC-CLAIM-TYPE = '2' OR '4'
 13004             IF CR-DIS-DT LESS THAN RCT-CLM-CUTOFF-DT (CO-SUB)
 13005                 GO TO 3540-CONT-REIN-CALC-RESERVE.
 13006
 13007     IF PC-CLAIM-TYPE  = 2 OR 4
 13008         IF RWF-AH-RUNOFF-SW = 'N'
 13009           IF CR-DIS-DT NOT LESS THAN RWF-EP-STOP-DATE
 13010               GO TO 3540-CONT-REIN-CALC-RESERVE.
 13011
 13012     IF DTE-CLIENT NOT = 'MIC'
 13013         GO TO 3505-REIN-CALC-RESERVE-CONT.
 13014
 13015     IF PC-CLAIM-TYPE = '1'  OR  '3'
 13016         GO TO 3505-REIN-CALC-RESERVE-CONT.
 13017
 13018     MOVE PC-FUTURE-RESERVE-AMT        TO RW-AHFUTRSVWK.
 13019
 13020     IF CR-AHTYP = ZERO  OR
 13021        CO-SUB = ZERO
 13022         GO TO 3505-REIN-CALC-RESERVE-CONT
 13023     ELSE
 13024         IF RCT-AH-CLM-MAX (CO-SUB) = ZERO
 13025             GO TO 3505-REIN-CALC-RESERVE-CONT.
 13026
 13027     COMPUTE MAX-REM-TERM ROUNDED =
 13028                         RCT-AH-CLM-MAX (CO-SUB) / CR-AHAMT.
 13029
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 254
* ECS010T1.cbl
 13030     IF MAX-REM-TERM NOT LESS THAN CP-REMAINING-TERM
 13031         GO TO 3505-REIN-CALC-RESERVE-CONT.
 13032
 13033     COMPUTE CP-ORIGINAL-TERM =
 13034                 CR-AH-TERM - CP-REMAINING-TERM + MAX-REM-TERM.
 13035
 13036     CALL 'ELRESVX' USING CALCULATION-PASS-AREA.
 13037
 13038     IF  CP-RETURN-CODE = ZERO
 13039         MOVE CP-FUTURE-RESERVE    TO RW-AHFUTRSVWK.
 13040
 13041 3505-REIN-CALC-RESERVE-CONT.
 13042
 13043     IF SUB1 = RE-100-COMP
 13044         GO TO 3520-REIN-REMAINDER-RSRV.
 13045
 13046     IF CR-LFAMT NOT = ZERO  AND
 13047        RWF-LFAMT NOT = ZERO
 13048         IF DTE-CLIENT NOT = 'MIC'
 13049             COMPUTE RWF-DTH-IBNRL = (RW-LFIBNRWK *
 13050                         RWF-LFAMT) / (CR-LFAMT + CR-LFAMT-ALT)
 13051             COMPUTE RWF-DTH-PAYCURL = (RW-LFPAYCURWK *
 13052                         RWF-LFAMT) / (CR-LFAMT + CR-LFAMT-ALT)
 13053             COMPUTE RWF-DTH-FUTRSVL = (RW-LFFUTRSVWK *
 13054                         RWF-LFAMT) / (CR-LFAMT + CR-LFAMT-ALT)
 13055         ELSE
 13056             MOVE RW-LFIBNRWK         TO RWF-DTH-IBNRL
 13057             MOVE RW-LFPAYCURWK       TO RWF-DTH-PAYCURL
 13058             MOVE RW-LFFUTRSVWK       TO RWF-DTH-FUTRSVL.
 13059
 13060     IF CR-AHAMT NOT = ZERO  AND
 13061        RWF-AHAMT NOT = ZERO
 13062         IF DTE-CLIENT NOT = 'MIC'
 13063             COMPUTE RWF-DIS-IBNRL = (RW-AHIBNRWK *
 13064                         RWF-AHAMT) / CR-AHAMT
 13065             COMPUTE RWF-DIS-PAYCURL = (RW-AHPAYCURWK *
 13066                         RWF-AHAMT) / CR-AHAMT
 13067             COMPUTE RWF-DIS-FUTRSVL = (RW-AHFUTRSVWK *
 13068                         RWF-AHAMT) / CR-AHAMT
 13069         ELSE
 13070             MOVE RW-AHIBNRWK         TO RWF-DIS-IBNRL
 13071             MOVE RW-AHPAYCURWK       TO RWF-DIS-PAYCURL
 13072             MOVE RW-AHFUTRSVWK       TO RWF-DIS-FUTRSVL.
 13073
 13074 3510-REINSURE-CALC-RESERVE-ADD.
 13075
 13076     ADD RWF-DTH-IBNRL   TO RWF-DTH-IBNR.
 13077     ADD RWF-DTH-PAYCURL TO RWF-DTH-PAYCUR.
 13078     ADD RWF-DTH-FUTRSVL TO RWF-DTH-FUTRSV.
 13079     ADD RWF-DIS-IBNRL   TO RWF-DIS-IBNR.
 13080     ADD RWF-DIS-PAYCURL TO RWF-DIS-PAYCUR.
 13081     ADD RWF-DIS-FUTRSVL TO RWF-DIS-FUTRSV.
 13082
 13083     IF DTE-CLIENT NOT = 'MIC'  AND  'MCC'
 13084         GO TO 3519-REINSURE-CALC-RESERVE-END.
 13085
 13086     IF CO-SUB = ZERO
 13087         GO TO 3519-REINSURE-CALC-RESERVE-END.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 255
* ECS010T1.cbl
 13088
 13089 3513-REIN-CHK-LF-RSRV-LIMIT.
 13090     IF RCT-LF-CLM-MAX (CO-SUB) = ZERO
 13091         GO TO 3515-REIN-CHK-AH-RSRV-LIMIT.
 13092
 13093     IF RWF-DTH-IBNR GREATER THAN RCT-LF-CLM-MAX (CO-SUB)
 13094         MOVE RCT-LF-CLM-MAX (CO-SUB) TO RWF-DTH-IBNR.
 13095
 13096     COMPUTE EXCESS-RESERVE = RCT-LF-CLM-MAX (CO-SUB) -
 13097                                      (RWF-LFCLM +
 13098                                       RWF-DTH-PAYCUR +
 13099                                       RWF-DTH-FUTRSV).
 13100
 13101     IF EXCESS-RESERVE NOT LESS THAN ZERO
 13102         GO TO 3515-REIN-CHK-AH-RSRV-LIMIT.
 13103
 13104     ADD EXCESS-RESERVE TO RWF-DTH-PAYCURL.
 13105
 13106     IF RWF-DTH-PAYCURL LESS THAN ZERO
 13107         ADD RWF-DTH-PAYCURL TO RWF-DTH-FUTRSVL
 13108         MOVE ZEROS TO RWF-DTH-PAYCURL.
 13109     IF RWF-DTH-FUTRSVL LESS THAN ZERO
 13110         MOVE ZEROS TO RWF-DTH-FUTRSVL.
 13111
 13112     ADD EXCESS-RESERVE TO RWF-DTH-PAYCUR.
 13113
 13114     IF RWF-DTH-PAYCUR LESS THAN ZERO
 13115         ADD RWF-DTH-PAYCUR TO RWF-DTH-FUTRSV
 13116         MOVE ZEROS TO RWF-DTH-PAYCUR.
 13117     IF RWF-DTH-FUTRSV LESS THAN ZERO
 13118         MOVE ZEROS TO RWF-DTH-FUTRSV.
 13119
 13120 3515-REIN-CHK-AH-RSRV-LIMIT.
 13121     IF RCT-AH-CLM-MAX (CO-SUB) = ZERO
 13122         GO TO 3519-REINSURE-CALC-RESERVE-END.
 13123
 13124     IF RWF-DIS-IBNR GREATER THAN RCT-AH-CLM-MAX (CO-SUB)
 13125         MOVE RCT-AH-CLM-MAX (CO-SUB) TO RWF-DIS-IBNR.
 13126
 13127     COMPUTE EXCESS-RESERVE = RCT-AH-CLM-MAX (CO-SUB) -
 13128                                      (RWF-AHCLM +
 13129                                       RWF-DIS-PAYCUR +
 13130                                       RWF-DIS-FUTRSV).
 13131
 13132     IF EXCESS-RESERVE NOT LESS THAN ZERO
 13133         GO TO 3519-REINSURE-CALC-RESERVE-END.
 13134
 13135     ADD EXCESS-RESERVE TO RWF-DIS-PAYCURL.
 13136
 13137     IF RWF-DIS-PAYCURL LESS THAN ZERO
 13138         ADD RWF-DIS-PAYCURL TO RWF-DIS-FUTRSVL
 13139         MOVE ZEROS TO RWF-DIS-PAYCURL.
 13140     IF RWF-DIS-FUTRSVL LESS THAN ZERO
 13141         MOVE ZEROS TO RWF-DIS-FUTRSVL.
 13142
 13143     ADD EXCESS-RESERVE TO RWF-DIS-PAYCUR.
 13144
 13145     IF RWF-DIS-PAYCUR LESS THAN ZERO
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 256
* ECS010T1.cbl
 13146         ADD RWF-DIS-PAYCUR TO RWF-DIS-FUTRSV
 13147         MOVE ZEROS TO RWF-DIS-PAYCUR.
 13148     IF RWF-DIS-FUTRSV LESS THAN ZERO
 13149         MOVE ZEROS TO RWF-DIS-FUTRSV.
 13150
 13151 3519-REINSURE-CALC-RESERVE-END.
 13152
 13153     IF +0 NOT = RWF-DTH-IBNR OR RWF-DTH-PAYCUR
 13154        OR RWF-DTH-FUTRSV
 13155         MOVE 'X' TO REIN-LF-FLG (SUB1).
 13156
 13157     IF +0 NOT = RWF-DIS-IBNR OR RWF-DIS-PAYCUR
 13158        OR RWF-DIS-FUTRSV
 13159         MOVE 'X' TO REIN-AH-FLG (SUB1).
 13160
 13161     GO TO 3540-CONT-REIN-CALC-RESERVE.
 13162
 13163 3520-REIN-REMAINDER-RSRV.
 13164
 13165     MOVE RW-LFIBNRWK   TO RWF-DTH-IBNRL.
 13166     MOVE RW-LFPAYCURWK TO RWF-DTH-PAYCURL.
 13167     MOVE RW-LFFUTRSVWK TO RWF-DTH-FUTRSVL.
 13168     MOVE RW-AHIBNRWK   TO RWF-DIS-IBNRL.
 13169     MOVE RW-AHPAYCURWK TO RWF-DIS-PAYCURL.
 13170     MOVE RW-AHFUTRSVWK TO RWF-DIS-FUTRSVL.
 13171
 13172     PERFORM 3530-REIN-SUB-RSRV
 13173         THRU 3539-REIN-SUB-RSRV-X
 13174             VARYING SUB2 FROM +1 BY +1 UNTIL SUB2 = SUB1.
 13175
 13176     GO TO 3510-REINSURE-CALC-RESERVE-ADD.
 13177
 13178 3530-REIN-SUB-RSRV.
 13179
 13180     SUBTRACT REIN-DTH-IBNRL (SUB2)   FROM RWF-DTH-IBNRL.
 13181     SUBTRACT REIN-DTH-PAYCURL (SUB2) FROM RWF-DTH-PAYCURL.
 13182     SUBTRACT REIN-DTH-FUTRSVL (SUB2) FROM RWF-DTH-FUTRSVL.
 13183     SUBTRACT REIN-DIS-IBNRL (SUB2)   FROM RWF-DIS-IBNRL.
 13184     SUBTRACT REIN-DIS-PAYCURL (SUB2) FROM RWF-DIS-PAYCURL.
 13185     SUBTRACT REIN-DIS-FUTRSVL (SUB2) FROM RWF-DIS-FUTRSVL.
 13186
 13187 3539-REIN-SUB-RSRV-X.
 13188     EXIT.
 13189
 13190 3540-CONT-REIN-CALC-RESERVE.
 13191
 13192     IF REIN-LF-AH-FLGS (SUB1) NOT = SPACES
 13193         MOVE 'X' TO REIN-BUS-FLAG.
 13194     MOVE RWF-FIELDS TO REIN-WORK-FLDS (SUB1).
 13195
 13196 3599-REINSURE-CALC-RESERVE-X.
 13197     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 257
* ECS010T1.cbl
 13199******************************************************************
 13200***       R E I N S U R A N C E   C A L C U L A T I O N S      ***
 13201******************************************************************
 13202
 13203*REINSURANCE-CALCULATIONS.
*13204                             COPY ECSRIRTN.
 13205******************************************************************04/30/98
 13206*                                                                *ECSRIRTN
 13207*                            ECSRIRTN                            *   LV012
 13208*                            VMOD=2.025.                         *ECSRIRTN
 13209*                                                                *ECSRIRTN
 13210******************************************************************ECSRIRTN
 13211******************************************************************
 13212*                   C H A N G E   L O G
 13213*
 13214* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
 13215*-----------------------------------------------------------------
 13216*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
 13217* EFFECTIVE    NUMBER
 13218*-----------------------------------------------------------------
 13219* 062703                   PEMA  ADD DCC CLIENT ID TO
 13220*                                SPECIAL CEDED CLAIM CALC
 13221* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
 13222* 052114  CR2014051900001  PEMA  ADD ROUNDING TO PREM TAX CALC
 13223                                                                  ECSRIRTN
 13224 REINSURE-CALC.                                                   ECSRIRTN
 13225                                                                  ECSRIRTN
 13226     MOVE RE-REI-COMP-NO (SUB1) TO REIN-COMP (SUB1).              ECSRIRTN
 13227     MOVE REIN-WORK-FLDS (SUB1) TO RWF-FIELDS.                    ECSRIRTN
 13228     MOVE RE-COMP-INFO (SUB1)   TO WT-COMP-INFO.                  ECSRIRTN
 13229     MOVE WT-REMAINING          TO RWF-REM-SW                     ECSRIRTN
 13230                                   REIN-REM-SW (SUB1).            ECSRIRTN
 13231                                                                  ECSRIRTN
 13232     MOVE ZEROS                 TO RWF-EP-STOP-DATE               ECSRIRTN
 13233                                   WS-RWF-EP-STOP-DATE-N             CL*12
 13234                                   REIN-EP-STOP-DATE (SUB1).      ECSRIRTN
 13235                                                                  ECSRIRTN
 13236     MOVE 'Y'                   TO RWF-LF-RUNOFF-SW               ECSRIRTN
 13237                                   REIN-LF-RUNOFF-SW (SUB1)       ECSRIRTN
 13238                                   RWF-AH-RUNOFF-SW               ECSRIRTN
 13239                                   REIN-AH-RUNOFF-SW (SUB1).      ECSRIRTN
 13240                                                                  ECSRIRTN
 13241     PERFORM REIN-FIND-CO-LOOP THRU FIND-REI-CO-EXIT              ECSRIRTN
 13242        VARYING CO-SUB FROM 1 BY 1 UNTIL                          ECSRIRTN
 13243          (RCT-REIN-CO (CO-SUB) = REIN-COMP (SUB1))  OR           ECSRIRTN
 13244          (CO-SUB GREATER REIN-CO-TABLE-ENT-CNT)     OR           ECSRIRTN
 13245          (RCT-REIN-CO (CO-SUB) = SPACES).                        ECSRIRTN
 13246                                                                  ECSRIRTN
 13247     IF (CO-SUB GREATER REIN-CO-TABLE-ENT-CNT)  OR                ECSRIRTN
 13248        (RCT-REIN-CO (CO-SUB) = SPACES)                           ECSRIRTN
 13249         GO TO CALC-CONTINUED.                                    ECSRIRTN
 13250                                                                  ECSRIRTN
 13251     MOVE RCT-EARNING-STOP-DT (CO-SUB) TO RWF-EP-STOP-DATE        ECSRIRTN
 13252                                          WS-RWF-EP-STOP-DATE-N      CL*12
 13253                                          REIN-EP-STOP-DATE (SUB1)ECSRIRTN
 13254                                                                  ECSRIRTN
 13255     IF RWF-EP-STOP-DATE = ZEROS                                  ECSRIRTN
 13256         GO TO CALC-CONTINUED.                                    ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 258
* ECS010T1.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 13257                                                                  ECSRIRTN
 13258     IF RCT-EARN-STOP-CODE (CO-SUB) = 'L'  OR  'B'                ECSRIRTN
 13259         MOVE 'N'               TO RWF-LF-RUNOFF-SW               ECSRIRTN
 13260                                   REIN-LF-RUNOFF-SW (SUB1).      ECSRIRTN
 13261                                                                  ECSRIRTN
 13262     IF RCT-EARN-STOP-CODE (CO-SUB) = 'A'  OR  'B'                ECSRIRTN
 13263         MOVE 'N'               TO RWF-AH-RUNOFF-SW               ECSRIRTN
 13264                                   REIN-AH-RUNOFF-SW (SUB1).      ECSRIRTN
 13265                                                                  ECSRIRTN
 13266 CALC-CONTINUED.                                                  ECSRIRTN
 13267                                                                  ECSRIRTN
 13268     COMPUTE RS-LIFE-BEN  = CR-LFAMT + CR-LFAMT-ALT.              ECSRIRTN
 13269     COMPUTE RS-LIFE-PREM = CR-LFPRM + CR-LFPRM-ALT.              ECSRIRTN
 13270                                                                  ECSRIRTN
 13271     IF RE-NSP-ST-CD-LF = ZEROS  OR  SPACES                       ECSRIRTN
 13272         COMPUTE RS-LP-CALC = CR-LFPRM-CALC + CR-LFPRM-CALC-ALT   ECSRIRTN
 13273     ELSE                                                         ECSRIRTN
 13274         MOVE CR-LF-NSP-PRM         TO RS-LP-CALC.                ECSRIRTN
 13275     MOVE RS-LP-CALC                TO REIN-CALCED-LIFE.          ECSRIRTN
 13276                                                                  ECSRIRTN
 13277     MOVE CR-AHAMT                  TO RS-AH-BEN.                 ECSRIRTN
 13278     MOVE CR-AHPRM                  TO RS-AH-PREM.                ECSRIRTN
 13279     IF RE-NSP-ST-CD-AH = ZEROS  OR  SPACES                       ECSRIRTN
 13280         MOVE CR-AHPRM-CALC         TO RS-AP-CALC                 ECSRIRTN
 13281     ELSE                                                         ECSRIRTN
 13282         MOVE CR-AH-NSP-PRM         TO RS-AP-CALC.                ECSRIRTN
 13283     MOVE RS-AP-CALC                TO REIN-CALCED-AH.            ECSRIRTN
 13284                                                                  ECSRIRTN
 13285     IF WT-REMAINING = 'Y' OR 'Z' OR 'L' OR 'R'                   ECSRIRTN
 13286         MOVE RS-R-LB               TO RS-LIFE-BEN                ECSRIRTN
 13287         MOVE RS-R-LP               TO RS-LIFE-PREM               ECSRIRTN
 13288         MOVE RS-R-LPC              TO RS-LP-CALC                 ECSRIRTN
 13289         MOVE RS-R-AB               TO RS-AH-BEN                  ECSRIRTN
 13290         MOVE RS-R-AP               TO RS-AH-PREM                 ECSRIRTN
 13291         MOVE RS-R-APC              TO RS-AP-CALC.                ECSRIRTN
 13292                                                                  ECSRIRTN
 13293     IF SUB1 = RE-100-COMP                                        ECSRIRTN
 13294         GO TO REINSURE-CALC-REMAINDER.                           ECSRIRTN
 13295                                                                  ECSRIRTN
 13296     IF CR-DT LESS WT-LO-DATE                                        CL**2
 13297         GO TO REINSURE-CALC-X.                                   ECSRIRTN
 13298                                                                  ECSRIRTN
 13299     IF CR-DT NOT LESS WT-HI-DATE                                    CL**2
 13300         GO TO REINSURE-CALC-X.                                   ECSRIRTN
 13301                                                                  ECSRIRTN
 13302     PERFORM REINSURE-CK-LIFE      THRU REINSURE-CK-LIFE-X.       ECSRIRTN
 13303     PERFORM REINSURE-CK-AH        THRU REINSURE-CK-AH-X.         ECSRIRTN
 13304                                                                  ECSRIRTN
 13305     IF WT-INTERACTIVE = 'E'                                      ECSRIRTN
 13306         PERFORM REIN-CHECK-INTERACT-E THRU REIN-INTERACT-CHECK-X.ECSRIRTN
 13307                                                                  ECSRIRTN
 13308     IF WT-INTERACTIVE = 'X'                                      ECSRIRTN
 13309       IF  (REIN-LF-FLG (SUB1) = 'X' AND REIN-AH-FLG (SUB1) = 'X')ECSRIRTN
 13310        OR (REIN-LF-FLG (SUB1) = 'X' AND REIN-AH-FLG (SUB1) = ' ')ECSRIRTN
 13311        OR (REIN-LF-FLG (SUB1) = ' ' AND REIN-AH-FLG (SUB1) = 'X')ECSRIRTN
 13312           NEXT SENTENCE                                          ECSRIRTN
 13313       ELSE                                                       ECSRIRTN
 13314           MOVE 'Y' TO REIN-LF-FLG (SUB1)                         ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 259
* ECS010T1.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 13315                       REIN-AH-FLG (SUB1).                        ECSRIRTN
 13316                                                                  ECSRIRTN
 13317     IF WT-INTERACTIVE = 'Y'                                      ECSRIRTN
 13318         IF REIN-LF-FLG (SUB1) = 'X' AND                          ECSRIRTN
 13319            REIN-AH-FLG (SUB1) = 'Y'                              ECSRIRTN
 13320             MOVE 'X' TO REIN-AH-FLG (SUB1).                      ECSRIRTN
 13321                                                                  ECSRIRTN
 13322     IF WT-INTERACTIVE = 'Y'                                      ECSRIRTN
 13323         IF REIN-AH-FLG (SUB1) = 'X' AND                          ECSRIRTN
 13324            REIN-LF-FLG (SUB1) = 'Y'                              ECSRIRTN
 13325             MOVE 'X' TO REIN-LF-FLG (SUB1).                      ECSRIRTN
 13326                                                                  ECSRIRTN
 13327     IF WT-INTERACTIVE = 'Z'                                      ECSRIRTN
 13328         IF REIN-LF-FLG (SUB1) = 'X'                              ECSRIRTN
 13329             IF REIN-AH-FLG (SUB1) = 'Y'                          ECSRIRTN
 13330                 MOVE 'X' TO REIN-AH-FLG (SUB1)                   ECSRIRTN
 13331             ELSE                                                 ECSRIRTN
 13332                 NEXT SENTENCE                                    ECSRIRTN
 13333         ELSE                                                     ECSRIRTN
 13334             MOVE 'Y' TO REIN-LF-FLG (SUB1)                       ECSRIRTN
 13335                         REIN-AH-FLG (SUB1).                      ECSRIRTN
 13336                                                                  ECSRIRTN
 13337     IF WT-INTERACTIVE = 'W'                                      ECSRIRTN
 13338         IF REIN-AH-FLG (SUB1) = 'X'                              ECSRIRTN
 13339             IF REIN-LF-FLG (SUB1) = 'Y'                          ECSRIRTN
 13340                 MOVE 'X' TO REIN-LF-FLG (SUB1)                   ECSRIRTN
 13341             ELSE                                                 ECSRIRTN
 13342                 NEXT SENTENCE                                    ECSRIRTN
 13343         ELSE                                                     ECSRIRTN
 13344             MOVE 'Y' TO REIN-LF-FLG (SUB1)                       ECSRIRTN
 13345                         REIN-AH-FLG (SUB1).                      ECSRIRTN
 13346                                                                  ECSRIRTN
 13347     IF REIN-LF-FLG (SUB1) = 'X'                                  ECSRIRTN
 13348         PERFORM REIN-CALC-LIFE THRU REIN-CALC-LIFE-X.            ECSRIRTN
 13349                                                                  ECSRIRTN
 13350     IF REIN-LF-FLG (SUB1) = 'E'                                  ECSRIRTN
 13351         PERFORM REIN-LF-SKIP-LIMIT THRU REIN-CALC-LIFE-X         ECSRIRTN
 13352         MOVE 'X' TO REIN-LF-FLG (SUB1).                          ECSRIRTN
 13353                                                                  ECSRIRTN
 13354     IF REIN-AH-FLG (SUB1) = 'X'                                  ECSRIRTN
 13355         PERFORM REIN-CALC-AH THRU REIN-CALC-AH-X.                ECSRIRTN
 13356                                                                  ECSRIRTN
 13357     IF REIN-AH-FLG (SUB1) = 'E'                                  ECSRIRTN
 13358         PERFORM REIN-AH-SKIP-LIMIT THRU REIN-CALC-AH-X           ECSRIRTN
 13359         MOVE 'X'                TO  REIN-AH-FLG (SUB1).          ECSRIRTN
 13360                                                                  ECSRIRTN
 13361     IF REIN-LF-FLG (SUB1) NOT = 'X'                              ECSRIRTN
 13362         MOVE SPACE TO REIN-LF-FLG (SUB1).                        ECSRIRTN
 13363                                                                  ECSRIRTN
 13364     IF REIN-AH-FLG (SUB1) NOT = 'X'                              ECSRIRTN
 13365         MOVE SPACE TO REIN-AH-FLG (SUB1).                        ECSRIRTN
 13366                                                                  ECSRIRTN
 13367     GO TO REINSURE-CALC-X.                                       ECSRIRTN
 13368                                                                  ECSRIRTN
 13369 REINSURE-CK-LIFE.                                                ECSRIRTN
 13370                                                                  ECSRIRTN
 13371     IF CR-LFTYP = ZERO                                           ECSRIRTN
 13372         GO TO REINSURE-CK-LIFE-X.                                ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 260
* ECS010T1.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 13373                                                                  ECSRIRTN
 13374     IF WT-LF-PCT = ZERO                                          ECSRIRTN
 13375         GO TO REINSURE-CK-LIFE-X.                                ECSRIRTN
 13376                                                                  ECSRIRTN
 13377     IF DTE-CLIENT = 'CSO' OR 'CSI'                               ECSRIRTN
 13378         IF CLAS-I-REIN-YN (CLAS-INDEXL) = 'N'                    ECSRIRTN
 13379             GO TO REINSURE-CK-LIFE-X.                            ECSRIRTN
 13380                                                                  ECSRIRTN
 13381     MOVE WT-LF-BEN-CODE                TO REIN-BEN-CODE.         ECSRIRTN
 13382                                                                  ECSRIRTN
 13383     IF CEDING-PROPERTY-ONLY                                      ECSRIRTN
 13384         IF CLAS-I-CALC-TYPE (CLAS-INDEXL) NOT = '2'              ECSRIRTN
 13385             GO TO REINSURE-CK-LIFE-X                             ECSRIRTN
 13386         ELSE                                                     ECSRIRTN
 13387             NEXT SENTENCE                                        ECSRIRTN
 13388     ELSE                                                         ECSRIRTN
 13389         IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = '2'                  ECSRIRTN
 13390             GO TO REINSURE-CK-LIFE-X.                            ECSRIRTN
 13391                                                                  ECSRIRTN
 13392     IF CEDING-AD-D-ONLY                                          ECSRIRTN
 13393         IF CLAS-I-CALC-TYPE (CLAS-INDEXL) NOT = '4'              ECSRIRTN
 13394             GO TO REINSURE-CK-LIFE-X                             ECSRIRTN
 13395         ELSE                                                     ECSRIRTN
 13396             NEXT SENTENCE                                        ECSRIRTN
 13397     ELSE                                                         ECSRIRTN
 13398         IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = '4'                  ECSRIRTN
 13399             GO TO REINSURE-CK-LIFE-X.                            ECSRIRTN
 13400                                                                  ECSRIRTN
 13401     IF CEDING-SINGLE-PREM-ONLY                                   ECSRIRTN
 13402         IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'B'                  ECSRIRTN
 13403             GO TO REINSURE-CK-LIFE-X.                            ECSRIRTN
 13404                                                                  ECSRIRTN
 13405     IF CEDING-OUT-BALANCE-ONLY                                   ECSRIRTN
 13406         IF CLAS-I-CALC-TYPE (CLAS-INDEXL) NOT = 'B'              ECSRIRTN
 13407            GO TO REINSURE-CK-LIFE-X.                             ECSRIRTN
 13408                                                                  ECSRIRTN
 13409     IF CEDING-REDUCING-ONLY                                      ECSRIRTN
 13410         IF CLAS-I-RL-AH (CLAS-INDEXL) = 'L' OR 'P'               ECSRIRTN
 13411             GO TO REINSURE-CK-LIFE-X.                            ECSRIRTN
 13412                                                                  ECSRIRTN
 13413     IF CEDING-LEVEL-ONLY                                         ECSRIRTN
 13414         IF CLAS-I-RL-AH (CLAS-INDEXL) = 'R'                      ECSRIRTN
 13415            GO TO REINSURE-CK-LIFE-X.                             ECSRIRTN
 13416                                                                  ECSRIRTN
 13417     IF CEDING-GROUP-ONLY                                         ECSRIRTN
 13418         IF CR-IND-GRP NOT = '2'                                  ECSRIRTN
 13419             GO TO REINSURE-CK-LIFE-X.                            ECSRIRTN
 13420                                                                  ECSRIRTN
 13421     IF CEDING-GROUP-RED-LIFE-ONLY                                ECSRIRTN
 13422         IF (CR-IND-GRP = '1')  OR                                ECSRIRTN
 13423            (CLAS-I-RL-AH (CLAS-INDEXL) = 'L' OR 'P') OR          ECSRIRTN
 13424            (CR-AHTYP NOT = ZERO)                                 ECSRIRTN
 13425             GO TO REINSURE-CK-LIFE-X.                            ECSRIRTN
 13426                                                                  ECSRIRTN
 13427     IF CEDING-GROUP-REDUCING-ONLY                                ECSRIRTN
 13428         IF (CR-IND-GRP = '1')  OR                                ECSRIRTN
 13429            (CLAS-I-RL-AH (CLAS-INDEXL) = 'L' OR 'P')             ECSRIRTN
 13430             GO TO REINSURE-CK-LIFE-X.                            ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 261
* ECS010T1.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 13431                                                                  ECSRIRTN
 13432     IF CEDING-INDIVIDUAL-ONLY                                    ECSRIRTN
 13433         IF CR-IND-GRP NOT = '1'                                  ECSRIRTN
 13434             GO TO REINSURE-CK-LIFE-X.                            ECSRIRTN
 13435                                                                  ECSRIRTN
 13436     IF CEDING-JOINT-ONLY                                         ECSRIRTN
 13437         IF CLAS-I-JOINT (CLAS-INDEXL) NOT = 'J'                  ECSRIRTN
 13438             GO TO REINSURE-CK-LIFE-X.                            ECSRIRTN
 13439                                                                  ECSRIRTN
 13440     IF CEDING-SGL-PREM-REDUCING                                  ECSRIRTN
 13441        IF (CLAS-I-RL-AH (CLAS-INDEXL) = 'L' OR 'P')  OR          ECSRIRTN
 13442           CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'B'                   ECSRIRTN
 13443            GO TO REINSURE-CK-LIFE-X.                             ECSRIRTN
 13444                                                                  ECSRIRTN
 13445     IF CEDING-SGL-PREM-GROUP                                     ECSRIRTN
 13446         IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'B'  OR              ECSRIRTN
 13447            CR-IND-GRP = '1'                                      ECSRIRTN
 13448             GO TO REINSURE-CK-LIFE-X.                            ECSRIRTN
 13449                                                                  ECSRIRTN
 13450     IF CEDING-GROUP-LEVEL-ONLY                                   ECSRIRTN
 13451         IF CLAS-I-RL-AH (CLAS-INDEXL) = 'R'  OR                  ECSRIRTN
 13452            CR-IND-GRP = '1'                                      ECSRIRTN
 13453             GO TO REINSURE-CK-LIFE-X.                            ECSRIRTN
 13454                                                                  ECSRIRTN
 13455     IF CEDING-SGL-PREM-GRP-REDUCING                              ECSRIRTN
 13456         IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'B'  OR              ECSRIRTN
 13457            (CLAS-I-RL-AH (CLAS-INDEXL) = 'L' OR 'P')  OR         ECSRIRTN
 13458            CR-IND-GRP = '1'                                      ECSRIRTN
 13459             GO TO REINSURE-CK-LIFE-X.                            ECSRIRTN
 13460                                                                  ECSRIRTN
 13461     IF CEDING-SGL-PREM-GROUP-LEVEL                               ECSRIRTN
 13462         IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'B'  OR              ECSRIRTN
 13463            CLAS-I-RL-AH (CLAS-INDEXL) = 'R'  OR                  ECSRIRTN
 13464            CR-IND-GRP = '1'                                      ECSRIRTN
 13465             GO TO REINSURE-CK-LIFE-X.                            ECSRIRTN
 13466                                                                  ECSRIRTN
 13467     IF CEDING-SINGLE-POLICIES-ONLY                               ECSRIRTN
 13468         IF CLAS-I-JOINT (CLAS-INDEXL) = 'J'                      ECSRIRTN
 13469            GO TO REINSURE-CK-LIFE-X.                             ECSRIRTN
 13470                                                                  ECSRIRTN
 13471     IF DTE-CLIENT EQUAL 'NCL'                                    ECSRIRTN
 13472        MOVE 'Y'                 TO REIN-LF-FLG (SUB1).           ECSRIRTN
 13473                                                                  ECSRIRTN
 13474     IF CR-AGE LESS WT-LFAGE-LO                                   ECSRIRTN
 13475         GO TO REINSURE-CK-LIFE-X.                                ECSRIRTN
 13476                                                                  ECSRIRTN
 13477     IF CR-AGE GREATER WT-LFAGE-HI                                ECSRIRTN
 13478         GO TO REINSURE-CK-LIFE-X.                                ECSRIRTN
 13479                                                                  ECSRIRTN
 13480     IF CR-LF-TERM  NUMERIC                                       00002331
 13481        NEXT SENTENCE                                             00002332
 13482     ELSE                                                         00002333
 13483        MOVE ZEROS               TO CR-LF-TERM                    00002334
 13484     END-IF
 13485                                                                  00002335
 13486     IF CR-LF-TERM LESS WT-LFTRM-LO                               ECSRIRTN
 13487         GO TO REINSURE-CK-LIFE-X.                                ECSRIRTN
 13488                                                                  ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 262
* ECS010T1.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 13489     IF CR-LF-TERM GREATER WT-LFTRM-HI                            ECSRIRTN
 13490         GO TO REINSURE-CK-LIFE-X.                                ECSRIRTN
 13491                                                                  ECSRIRTN
 13492     MOVE 'Y' TO REIN-LF-FLG (SUB1).                              ECSRIRTN
 13493                                                                  ECSRIRTN
 13494     IF RS-LIFE-BEN NOT GREATER WT-LF-LIM-LO                      ECSRIRTN
 13495         GO TO REINSURE-CK-LIFE-X.                                ECSRIRTN
 13496                                                                  ECSRIRTN
 13497     IF RS-LIFE-BEN GREATER WT-LF-LIM-HI                          ECSRIRTN
 13498         GO TO REINSURE-CK-LIFE-X.                                ECSRIRTN
 13499                                                                  ECSRIRTN
 13500     MOVE 'X' TO REIN-LF-FLG (SUB1).                              ECSRIRTN
 13501                                                                  ECSRIRTN
 13502 REINSURE-CK-LIFE-X.                                              ECSRIRTN
 13503     EXIT.                                                        ECSRIRTN
 13504                                                                  ECSRIRTN
 13505 REINSURE-CK-AH.                                                  ECSRIRTN
 13506                                                                  ECSRIRTN
 13507     IF CR-AHTYP = ZERO                                           ECSRIRTN
 13508         GO TO REINSURE-CK-AH-X.                                  ECSRIRTN
 13509                                                                  ECSRIRTN
 13510     IF WT-AH-PCT = ZERO                                          ECSRIRTN
 13511         GO TO REINSURE-CK-AH-X.                                  ECSRIRTN
 13512                                                                  ECSRIRTN
 13513     IF DTE-CLIENT = 'CSO' OR 'CSI'                               ECSRIRTN
 13514         IF CLAS-I-REIN-YN (CLAS-INDEXA) = 'N'                    ECSRIRTN
 13515             GO TO REINSURE-CK-AH-X.                              ECSRIRTN
 13516                                                                  ECSRIRTN
 13517     MOVE WT-AH-BEN-CODE                TO REIN-BEN-CODE.         ECSRIRTN
 13518                                                                  ECSRIRTN
 13519     IF CEDING-UNEMPLOYMENT-ONLY                                  ECSRIRTN
 13520         IF CLAS-I-CALC-TYPE (CLAS-INDEXA) NOT = '3'              ECSRIRTN
 13521             GO TO REINSURE-CK-AH-X                               ECSRIRTN
 13522         ELSE                                                     ECSRIRTN
 13523             NEXT SENTENCE                                        ECSRIRTN
 13524     ELSE                                                         ECSRIRTN
 13525         IF CLAS-I-CALC-TYPE (CLAS-INDEXA) = '3'                  ECSRIRTN
 13526             GO TO REINSURE-CK-AH-X.                              ECSRIRTN
 13527                                                                  ECSRIRTN
 13528     IF CEDING-SINGLE-PREM-ONLY                                   ECSRIRTN
 13529         IF CLAS-I-CALC-TYPE (CLAS-INDEXA) = 'B'                  ECSRIRTN
 13530             GO TO REINSURE-CK-AH-X.                              ECSRIRTN
 13531                                                                  ECSRIRTN
 13532     IF CEDING-JOINT-ONLY                                         ECSRIRTN
 13533         IF CLAS-I-JOINT (CLAS-INDEXA) NOT = 'J'                  ECSRIRTN
 13534             GO TO REINSURE-CK-AH-X.                              ECSRIRTN
 13535                                                                  ECSRIRTN
 13536     IF CEDING-OUT-BALANCE-ONLY                                   ECSRIRTN
 13537         IF CLAS-I-CALC-TYPE (CLAS-INDEXA) NOT = 'B'              ECSRIRTN
 13538             GO TO REINSURE-CK-AH-X.                              ECSRIRTN
 13539                                                                  ECSRIRTN
 13540     IF CEDING-GROUP-ONLY                                         ECSRIRTN
 13541         IF CR-IND-GRP NOT = '2'                                  ECSRIRTN
 13542             GO TO REINSURE-CK-AH-X.                              ECSRIRTN
 13543                                                                  ECSRIRTN
 13544     IF CEDING-SGL-PREM-GROUP                                     ECSRIRTN
 13545         IF CLAS-I-CALC-TYPE (CLAS-INDEXA) = 'B'  OR              ECSRIRTN
 13546            CR-IND-GRP = '1'                                      ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 263
* ECS010T1.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 13547             GO TO REINSURE-CK-AH-X.                              ECSRIRTN
 13548                                                                  ECSRIRTN
 13549     IF CEDING-INDIVIDUAL-ONLY                                    ECSRIRTN
 13550         IF CR-IND-GRP NOT = '1'                                  ECSRIRTN
 13551             GO TO REINSURE-CK-AH-X.                              ECSRIRTN
 13552                                                                  ECSRIRTN
 13553     IF CEDING-SINGLE-POLICIES-ONLY                               ECSRIRTN
 13554         IF CLAS-I-JOINT (CLAS-INDEXA) = 'J'                      ECSRIRTN
 13555            GO TO REINSURE-CK-AH-X.                               ECSRIRTN
 13556                                                                  ECSRIRTN
 13557     IF CEDING-7-DAY-RETRO                                        ECSRIRTN
 13558         IF CLAS-I-AB3 (CLAS-INDEXA) NOT = (' 7R'  AND  '07R')    ECSRIRTN
 13559            GO TO REINSURE-CK-AH-X.                               ECSRIRTN
 13560                                                                  ECSRIRTN
 13561     IF CEDING-14-DAY-RETRO                                       ECSRIRTN
 13562         IF CLAS-I-AB3 (CLAS-INDEXA) NOT = '14R'                  ECSRIRTN
 13563             GO TO REINSURE-CK-AH-X.                              ECSRIRTN
 13564                                                                  ECSRIRTN
 13565     IF DTE-CLIENT EQUAL 'NCL'                                    ECSRIRTN
 13566        MOVE 'Y'                 TO REIN-AH-FLG (SUB1).           ECSRIRTN
 13567                                                                  ECSRIRTN
 13568     IF CR-AGE LESS WT-AHAGE-LO                                   ECSRIRTN
 13569         GO TO REINSURE-CK-AH-X.                                  ECSRIRTN
 13570                                                                  ECSRIRTN
 13571     IF CR-AGE GREATER WT-AHAGE-HI                                ECSRIRTN
 13572         GO TO REINSURE-CK-AH-X.                                  ECSRIRTN
 13573                                                                  ECSRIRTN
 13574     IF CR-AH-TERM  NUMERIC                                       00002331
 13575        NEXT SENTENCE                                             00002332
 13576     ELSE                                                         00002333
 13577        MOVE ZEROS               TO CR-AH-TERM                    00002334
 13578     END-IF
 13579                                                                  00002335
 13580     IF CR-AH-TERM LESS WT-AHTRM-LO                               ECSRIRTN
 13581         GO TO REINSURE-CK-AH-X.                                  ECSRIRTN
 13582                                                                  ECSRIRTN
 13583     IF CR-AH-TERM GREATER WT-AHTRM-HI                            ECSRIRTN
 13584         GO TO REINSURE-CK-AH-X.                                  ECSRIRTN
 13585                                                                  ECSRIRTN
 13586     MOVE 'Y' TO REIN-AH-FLG (SUB1).                              ECSRIRTN
 13587                                                                  ECSRIRTN
 13588     IF WT-AHBEN-LIM-LO = ZERO                                    ECSRIRTN
 13589         AND WT-AHBEN-LIM-HI = ZERO                               ECSRIRTN
 13590             MOVE +9999999.99 TO WT-AHBEN-LIM-LO                  ECSRIRTN
 13591                                 WT-AHBEN-LIM-HI.                 ECSRIRTN
 13592                                                                  ECSRIRTN
 13593     IF WT-AHMOA-LIM-LO = ZERO                                    ECSRIRTN
 13594         AND WT-AHMOA-LIM-HI = ZERO                               ECSRIRTN
 13595             MOVE +9999999.99 TO WT-AHMOA-LIM-LO                  ECSRIRTN
 13596                                 WT-AHMOA-LIM-HI.                 ECSRIRTN
 13597                                                                  ECSRIRTN
 13598     COMPUTE RW-AHLIM-LO = CR-AH-TERM * WT-AHMOA-LIM-LO.          ECSRIRTN
 13599     COMPUTE RW-AHLIM-HI = CR-AH-TERM * WT-AHMOA-LIM-HI.          ECSRIRTN
 13600                                                                  ECSRIRTN
 13601     IF RW-AHLIM-LO GREATER WT-AHBEN-LIM-LO                       ECSRIRTN
 13602         MOVE WT-AHBEN-LIM-LO TO RW-AHLIM-LO.                     ECSRIRTN
 13603                                                                  ECSRIRTN
 13604     IF RW-AHLIM-HI GREATER WT-AHBEN-LIM-HI                       ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 264
* ECS010T1.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 13605         MOVE WT-AHBEN-LIM-HI TO RW-AHLIM-HI.                     ECSRIRTN
 13606                                                                  ECSRIRTN
 13607     MOVE RW-AHLIM-LO TO RWF-AH-LIMIT.                            ECSRIRTN
 13608                                                                  ECSRIRTN
 13609     COMPUTE RW-AHWRK = RS-AH-BEN * CR-AH-TERM.                   ECSRIRTN
 13610                                                                  ECSRIRTN
 13611     IF RW-AHWRK NOT GREATER RW-AHLIM-LO                          ECSRIRTN
 13612         GO TO REINSURE-CK-AH-X.                                  ECSRIRTN
 13613                                                                  ECSRIRTN
 13614     IF RW-AHWRK GREATER RW-AHLIM-HI                              ECSRIRTN
 13615         GO TO REINSURE-CK-AH-X.                                  ECSRIRTN
 13616                                                                  ECSRIRTN
 13617     MOVE 'X' TO REIN-AH-FLG (SUB1).                              ECSRIRTN
 13618                                                                  ECSRIRTN
 13619 REINSURE-CK-AH-X.                                                ECSRIRTN
 13620     EXIT.                                                        ECSRIRTN
 13621                                                                  ECSRIRTN
 13622 REIN-CHECK-INTERACT-E.                                           ECSRIRTN
 13623                                                                  ECSRIRTN
 13624     IF RS-LIFE-BEN = ZERO  OR                                    ECSRIRTN
 13625        RS-AH-BEN = ZERO                                          ECSRIRTN
 13626         GO TO REIN-INTERACT-CHECK-X.                             ECSRIRTN
 13627                                                                  ECSRIRTN
 13628     IF REIN-LF-FLG (SUB1) NOT = 'X'  AND                         ECSRIRTN
 13629        REIN-AH-FLG (SUB1) NOT = 'X'                              ECSRIRTN
 13630         GO TO REIN-INTERACT-CHECK-X.                             ECSRIRTN
 13631                                                                  ECSRIRTN
 13632     MOVE 'X'                    TO REIN-LF-FLG (SUB1)            ECSRIRTN
 13633                                    REIN-AH-FLG (SUB1).           ECSRIRTN
 13634                                                                  ECSRIRTN
 13635     IF WT-AHBEN-LO = ZERO                                        ECSRIRTN
 13636         AND WT-AHBEN-HI = ZERO                                   ECSRIRTN
 13637             MOVE +9999999.99    TO  WT-AHBEN-LO                  ECSRIRTN
 13638                                     WT-AHBEN-HI.                 ECSRIRTN
 13639     IF WT-AHMOA-LO = ZERO                                        ECSRIRTN
 13640         AND WT-AHMOA-HI = ZERO                                   ECSRIRTN
 13641             MOVE +9999999.99    TO  WT-AHMOA-LO                  ECSRIRTN
 13642                                     WT-AHMOA-HI.                 ECSRIRTN
 13643                                                                  ECSRIRTN
 13644     COMPUTE RW-AHLIM-LO = CR-AH-TERM * WT-AHMOA-LO.              ECSRIRTN
 13645     COMPUTE RW-AHLIM-HI = CR-AH-TERM * WT-AHMOA-HI.              ECSRIRTN
 13646                                                                  ECSRIRTN
 13647     IF RW-AHLIM-LO GREATER WT-AHBEN-LO                           ECSRIRTN
 13648         MOVE WT-AHBEN-LO        TO  RW-AHLIM-LO.                 ECSRIRTN
 13649                                                                  ECSRIRTN
 13650     IF RW-AHLIM-HI GREATER WT-AHBEN-HI                           ECSRIRTN
 13651         MOVE WT-AHBEN-HI        TO  RW-AHLIM-HI.                 ECSRIRTN
 13652                                                                  ECSRIRTN
 13653     COMPUTE RW-AHWRK = RS-AH-BEN * CR-AH-TERM.                   ECSRIRTN
 13654                                                                  ECSRIRTN
 13655     IF RW-AHWRK GREATER RW-AHLIM-HI                              ECSRIRTN
 13656         MOVE RW-AHLIM-HI        TO  RW-AHWRK.                    ECSRIRTN
 13657                                                                  ECSRIRTN
 13658     IF RW-AHWRK GREATER RW-AHLIM-LO                              ECSRIRTN
 13659         COMPUTE RATE-WORK-A ROUNDED = (RW-AHWRK - RW-AHLIM-LO)   ECSRIRTN
 13660                                       / RW-AHWRK                 ECSRIRTN
 13661       ELSE                                                       ECSRIRTN
 13662         MOVE ZERO               TO RATE-WORK-A.                  ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 265
* ECS010T1.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 13663                                                                  ECSRIRTN
 13664     IF RS-LIFE-BEN GREATER WT-LF-LO                              ECSRIRTN
 13665         COMPUTE RATE-WORK-L ROUNDED = (RS-LIFE-BEN - WT-LF-LO)   ECSRIRTN
 13666                                       / RS-LIFE-BEN              ECSRIRTN
 13667       ELSE                                                       ECSRIRTN
 13668         MOVE ZERO               TO RATE-WORK-L.                  ECSRIRTN
 13669                                                                  ECSRIRTN
 13670     IF (RS-LIFE-BEN GREATER WT-LF-LO) AND                        ECSRIRTN
 13671        (RW-AHWRK NOT GREATER RW-AHLIM-LO)                        ECSRIRTN
 13672          MOVE 'E'               TO REIN-AH-FLG (SUB1)            ECSRIRTN
 13673          COMPUTE RWF-AHAMT ROUNDED = (RW-AHWRK * RATE-WORK-L)    ECSRIRTN
 13674                                      / CR-AH-TERM.               ECSRIRTN
 13675                                                                  ECSRIRTN
 13676     IF (RW-AHWRK GREATER RW-AHLIM-LO) AND                        ECSRIRTN
 13677        (RS-LIFE-BEN NOT GREATER WT-LF-LO)                        ECSRIRTN
 13678          MOVE 'E'               TO REIN-LF-FLG (SUB1)            ECSRIRTN
 13679          IF (RW-AHWRK - RW-AHLIM-LO) NOT GREATER RS-LIFE-BEN     ECSRIRTN
 13680               COMPUTE RWF-LFAMT = RW-AHWRK - RW-AHLIM-LO         ECSRIRTN
 13681            ELSE                                                  ECSRIRTN
 13682                MOVE RS-LIFE-BEN TO RWF-LFAMT.                    ECSRIRTN
 13683                                                                  ECSRIRTN
 13684     IF (RW-AHWRK GREATER RW-AHLIM-LO) AND                        ECSRIRTN
 13685        (RS-LIFE-BEN GREATER WT-LF-LO)                            ECSRIRTN
 13686        IF RATE-WORK-L GREATER RATE-WORK-A                        ECSRIRTN
 13687          MOVE 'E'               TO REIN-AH-FLG (SUB1)            ECSRIRTN
 13688          COMPUTE RWF-AHAMT ROUNDED = (RW-AHWRK * RATE-WORK-L)    ECSRIRTN
 13689                                      / CR-AH-TERM                ECSRIRTN
 13690         ELSE                                                     ECSRIRTN
 13691          MOVE 'E'               TO REIN-LF-FLG (SUB1)            ECSRIRTN
 13692          IF (RW-AHWRK - RW-AHLIM-LO) NOT GREATER RS-LIFE-BEN     ECSRIRTN
 13693               COMPUTE RWF-LFAMT = RW-AHWRK - RW-AHLIM-LO         ECSRIRTN
 13694            ELSE                                                  ECSRIRTN
 13695                MOVE RS-LIFE-BEN TO RWF-LFAMT.                    ECSRIRTN
 13696                                                                  ECSRIRTN
 13697 REIN-INTERACT-CHECK-X.                                           ECSRIRTN
 13698     EXIT.                                                        ECSRIRTN
 13699                                                                  ECSRIRTN
 13700                                                                  ECSRIRTN
 13701 REIN-CALC-LIFE.                                                  ECSRIRTN
 13702                                                                  ECSRIRTN
 13703     IF RS-LIFE-BEN NOT GREATER WT-LF-HI                          ECSRIRTN
 13704         MOVE RS-LIFE-BEN TO RWF-LFAMT                            ECSRIRTN
 13705     ELSE                                                         ECSRIRTN
 13706         MOVE WT-LF-HI TO RWF-LFAMT.                              ECSRIRTN
 13707                                                                  ECSRIRTN
 13708     IF RS-LIFE-BEN LESS WT-LF-LO                                 ECSRIRTN
 13709         MOVE +0 TO RWF-LFAMT                                     ECSRIRTN
 13710     ELSE                                                         ECSRIRTN
 13711         IF WT-REMAINING NOT = 'L'                                ECSRIRTN
 13712           IF RS-LIFE-BEN LESS THAN ZERO                          ECSRIRTN
 13713               COMPUTE RWF-LFAMT ROUNDED = WT-LF-PCT * RS-LIFE-BENECSRIRTN
 13714           ELSE                                                   ECSRIRTN
 13715               COMPUTE RWF-LFAMT ROUNDED = WT-LF-PCT *            ECSRIRTN
 13716                                          (RWF-LFAMT - WT-LF-LO). ECSRIRTN
 13717                                                                  ECSRIRTN
 13718 REIN-LF-SKIP-LIMIT.                                              ECSRIRTN
 13719                                                                  ECSRIRTN
 13720     MOVE +0 TO RW-LFPRM  RW-LFPRMC.                              ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 266
* ECS010T1.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 13721                                                                  ECSRIRTN
 13722     IF WT-REMAINING = 'I'                                        ECSRIRTN
 13723         GO TO REIN-CALC-LF-RISK-PREM.                            ECSRIRTN
 13724                                                                  ECSRIRTN
 13725     IF WT-REMAINING = 'L'                                        ECSRIRTN
 13726         COMPUTE RWF-LFPRM ROUNDED = RS-LIFE-PREM * WT-LF-PCT     ECSRIRTN
 13727         GO TO REIN-CALC-LIFE-X.                                  ECSRIRTN
 13728                                                                  ECSRIRTN
 13729     IF RS-LIFE-BEN NOT = ZERO                                    ECSRIRTN
 13730         COMPUTE RW-LFPRM ROUNDED = (RS-LIFE-PREM *               ECSRIRTN
 13731                   RWF-LFAMT) / RS-LIFE-BEN                       ECSRIRTN
 13732         COMPUTE RW-LFPRMC ROUNDED = (RS-LP-CALC *                ECSRIRTN
 13733                   RWF-LFAMT) / RS-LIFE-BEN                       ECSRIRTN
 13734     ELSE                                                         ECSRIRTN
 13735         IF WT-LF-LIM-LO = ZERO                                   ECSRIRTN
 13736             COMPUTE RW-LFPRM ROUNDED = RS-LIFE-PREM * WT-LF-PCT  ECSRIRTN
 13737             COMPUTE RW-LFPRMC ROUNDED = RS-LP-CALC * WT-LF-PCT.  ECSRIRTN
 13738                                                                  ECSRIRTN
 13739     IF ((WT-LF-QC = '1' OR '3') OR                                  CL**8
 13740         (WT-LF-QC = '2' AND                                         CL**8
 13741          PGM-SUB = +50  AND                                         CL**8
 13742          DTE-CLIENT = 'LAP'))                                       CL**8
 13743          MOVE RW-LFPRM TO RWF-LFPRM                                 CL**8
 13744     ELSE                                                         ECSRIRTN
 13745         MOVE RW-LFPRMC TO RWF-LFPRM.                             ECSRIRTN
 13746                                                                  ECSRIRTN
 13747     IF WT-REMAINING = 'Y' OR 'Z' OR 'X' OR 'N'                   ECSRIRTN
 13748         COMPUTE RS-R-LB = RS-R-LB - RWF-LFAMT                    ECSRIRTN
 13749         COMPUTE RS-R-LP = RS-R-LP - RW-LFPRM                     ECSRIRTN
 13750         COMPUTE RS-R-LPC = RS-R-LPC - RW-LFPRMC.                 ECSRIRTN
 13751                                                                  ECSRIRTN
 13752     GO TO REIN-CALC-LIFE-X.                                      ECSRIRTN
 13753                                                                  ECSRIRTN
 13754 REIN-CALC-LF-RISK-PREM.                                          ECSRIRTN
 13755                                                                  ECSRIRTN
 13756     IF RWF-LFAMT NOT GREATER THAN +0                             ECSRIRTN
 13757         MOVE ZEROS                 TO RWF-LFPRM                  ECSRIRTN
 13758         GO TO REIN-CALC-LIFE-X.                                  ECSRIRTN
 13759                                                                  ECSRIRTN
 13760     MOVE RWF-LFAMT                 TO REIN-RISK-AMOUNT.          ECSRIRTN
 13761     COMPUTE REIN-MONTH-REDUCE = RS-LIFE-BEN / CR-LF-TERM.        ECSRIRTN
 13762     MOVE +0                        TO REIN-WORKA                 ECSRIRTN
 13763                                       RW-LFPRM.                  ECSRIRTN
 13764                                                                  ECSRIRTN
 13765 REIN-LF-RISK-PREM-LOOP.                                          ECSRIRTN
 13766                                                                  ECSRIRTN
 13767     COMPUTE RW-LFPRM = RW-LFPRM +                                ECSRIRTN
 13768                ((REIN-RISK-AMOUNT / +1000) * CR-LF-NSP-PRM-RATE).ECSRIRTN
 13769                                                                  ECSRIRTN
 13770     IF CLAS-I-RL-AH (CLAS-INDEXL) NOT = 'L'                      ECSRIRTN
 13771        SUBTRACT REIN-MONTH-REDUCE FROM REIN-RISK-AMOUNT.         ECSRIRTN
 13772                                                                  ECSRIRTN
 13773     IF REIN-WORKA = REIN-EARN-LF-TERM  OR                        ECSRIRTN
 13774        REIN-RISK-AMOUNT LESS THAN +0                             ECSRIRTN
 13775         MOVE RW-LFPRM              TO RWF-LFPRM                  ECSRIRTN
 13776     ELSE                                                         ECSRIRTN
 13777         ADD +1 TO REIN-WORKA                                     ECSRIRTN
 13778         GO TO REIN-LF-RISK-PREM-LOOP.                            ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 267
* ECS010T1.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 13779                                                                  ECSRIRTN
 13780                                                                  ECSRIRTN
 13781 REIN-CALC-LIFE-X.                                                ECSRIRTN
 13782     EXIT.                                                        ECSRIRTN
 13783                                                                  ECSRIRTN
 13784 REIN-CALC-AH.                                                    ECSRIRTN
 13785                                                                  ECSRIRTN
 13786     IF WT-AHBEN-LO = ZERO                                        ECSRIRTN
 13787         AND WT-AHBEN-HI = ZERO                                   ECSRIRTN
 13788             MOVE +9999999.99 TO WT-AHBEN-LO                      ECSRIRTN
 13789                                 WT-AHBEN-HI.                     ECSRIRTN
 13790                                                                  ECSRIRTN
 13791     IF WT-AHMOA-LO = ZERO                                        ECSRIRTN
 13792         AND WT-AHMOA-HI = ZERO                                   ECSRIRTN
 13793             MOVE +9999999.99 TO WT-AHMOA-LO                      ECSRIRTN
 13794                                 WT-AHMOA-HI.                     ECSRIRTN
 13795                                                                  ECSRIRTN
 13796     COMPUTE RW-AHLIM-LO = CR-AH-TERM * WT-AHMOA-LO.              ECSRIRTN
 13797     COMPUTE RW-AHLIM-HI = CR-AH-TERM * WT-AHMOA-HI.              ECSRIRTN
 13798                                                                  ECSRIRTN
 13799     IF RW-AHLIM-LO GREATER WT-AHBEN-LO                           ECSRIRTN
 13800         MOVE WT-AHBEN-LO TO RW-AHLIM-LO.                         ECSRIRTN
 13801                                                                  ECSRIRTN
 13802     IF RW-AHLIM-HI GREATER WT-AHBEN-HI                           ECSRIRTN
 13803         MOVE WT-AHBEN-HI TO RW-AHLIM-HI.                         ECSRIRTN
 13804                                                                  ECSRIRTN
 13805     IF RW-AHWRK GREATER RW-AHLIM-HI                              ECSRIRTN
 13806         MOVE RW-AHLIM-HI TO RW-AHWRK.                            ECSRIRTN
 13807                                                                  ECSRIRTN
 13808     IF RW-AHWRK LESS RW-AHLIM-LO                                 ECSRIRTN
 13809         MOVE +0 TO RWF-AHAMT                                     ECSRIRTN
 13810     ELSE                                                         ECSRIRTN
 13811         IF WT-REMAINING = 'L'                                    ECSRIRTN
 13812             COMPUTE RWF-AHAMT ROUNDED = RW-AHWRK / CR-AH-TERM    ECSRIRTN
 13813         ELSE                                                     ECSRIRTN
 13814             COMPUTE RWF-AHAMT ROUNDED =                          ECSRIRTN
 13815             ((RW-AHWRK - RW-AHLIM-LO) / CR-AH-TERM) * WT-AH-PCT. ECSRIRTN
 13816                                                                  ECSRIRTN
 13817 REIN-AH-SKIP-LIMIT.                                              ECSRIRTN
 13818                                                                  ECSRIRTN
 13819     IF WT-REMAINING = 'I'                                        ECSRIRTN
 13820         GO TO REIN-CALC-AH-RISK-PREM.                            ECSRIRTN
 13821                                                                  ECSRIRTN
 13822     IF WT-REMAINING = 'L'                                        ECSRIRTN
 13823         COMPUTE RWF-AHPRM ROUNDED = RS-AH-PREM * WT-AH-PCT       ECSRIRTN
 13824         GO TO REIN-CALC-AH-X.                                    ECSRIRTN
 13825                                                                  ECSRIRTN
 13826     IF RS-AH-BEN NOT = ZERO                                      ECSRIRTN
 13827         COMPUTE RW-AHPRM ROUNDED = (RS-AH-PREM *                 ECSRIRTN
 13828                   RWF-AHAMT) / RS-AH-BEN                         ECSRIRTN
 13829         COMPUTE RW-AHPRMC ROUNDED = (RS-AP-CALC *                ECSRIRTN
 13830                   RWF-AHAMT) / RS-AH-BEN                         ECSRIRTN
 13831     ELSE                                                         ECSRIRTN
 13832         IF RW-AHLIM-LO = ZERO                                    ECSRIRTN
 13833             COMPUTE RW-AHPRM ROUNDED = RS-AH-PREM * WT-AH-PCT    ECSRIRTN
 13834             COMPUTE RW-AHPRMC ROUNDED = RS-AP-CALC * WT-AH-PCT.  ECSRIRTN
 13835                                                                  ECSRIRTN
 13836     IF ((WT-AH-QC = '1' OR '3') OR                                  CL**8
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 268
* ECS010T1.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 13837         (WT-AH-QC = '2' AND                                         CL**8
 13838          PGM-SUB = +50  AND                                         CL**8
 13839          DTE-CLIENT = 'LAP'))                                       CL**8
 13840         MOVE RW-AHPRM TO RWF-AHPRM                               ECSRIRTN
 13841     ELSE                                                         ECSRIRTN
 13842         MOVE RW-AHPRMC TO RWF-AHPRM.                             ECSRIRTN
 13843                                                                  ECSRIRTN
 13844     IF RE-NSP-ST-CD-AH = SPACES OR ZERO                          ECSRIRTN
 13845         IF (WT-REMAINING = 'Y' OR 'Z') AND (WT-AH-QC = '1')      ECSRIRTN
 13846            AND (RWF-AHAMT = RS-R-AB) AND (RWF-AHAMT NOT = +0)    ECSRIRTN
 13847                MOVE 'Y' TO RWF-REM-AH-100.                       ECSRIRTN
 13848                                                                  ECSRIRTN
 13849     IF WT-REMAINING = 'Y' OR 'Z' OR 'X' OR 'N'                   ECSRIRTN
 13850         COMPUTE RS-R-AB = RS-R-AB - RWF-AHAMT                    ECSRIRTN
 13851         COMPUTE RS-R-AP = RS-R-AP - RW-AHPRM                     ECSRIRTN
 13852         COMPUTE RS-R-APC = RS-R-APC - RW-AHPRMC.                 ECSRIRTN
 13853                                                                  ECSRIRTN
 13854     GO TO REIN-CALC-AH-X.                                        ECSRIRTN
 13855                                                                  ECSRIRTN
 13856 REIN-CALC-AH-RISK-PREM.                                          ECSRIRTN
 13857                                                                  ECSRIRTN
 13858     IF RWF-AHAMT NOT GREATER THAN +0                             ECSRIRTN
 13859         MOVE ZEROS                 TO RWF-AHPRM                  ECSRIRTN
 13860         GO TO REIN-CALC-AH-X.                                    ECSRIRTN
 13861                                                                  ECSRIRTN
 13862     COMPUTE REIN-RISK-AMOUNT = RWF-AHAMT * CR-AH-TERM.           ECSRIRTN
 13863     MOVE RS-AH-BEN              TO REIN-MONTH-REDUCE.            ECSRIRTN
 13864     MOVE +0                     TO REIN-WORKA                    ECSRIRTN
 13865                                    RW-AHPRM.                     ECSRIRTN
 13866                                                                  ECSRIRTN
 13867 REIN-AH-RISK-PREM-LOOP.                                          ECSRIRTN
 13868                                                                  ECSRIRTN
 13869     COMPUTE RW-AHPRM = RW-AHPRM +                                ECSRIRTN
 13870                ((REIN-RISK-AMOUNT / +1000) * CR-AH-NSP-PRM-RATE).ECSRIRTN
 13871                                                                  ECSRIRTN
 13872     SUBTRACT REIN-MONTH-REDUCE FROM REIN-RISK-AMOUNT.            ECSRIRTN
 13873                                                                  ECSRIRTN
 13874     IF REIN-WORKA = REIN-EARN-AH-TERM  OR                        ECSRIRTN
 13875        REIN-RISK-AMOUNT LESS THAN +0                             ECSRIRTN
 13876         MOVE RW-AHPRM          TO RWF-AHPRM                      ECSRIRTN
 13877     ELSE                                                         ECSRIRTN
 13878         ADD +1 TO REIN-WORKA                                     ECSRIRTN
 13879         GO TO REIN-AH-RISK-PREM-LOOP.                            ECSRIRTN
 13880                                                                  ECSRIRTN
 13881                                                                  ECSRIRTN
 13882 REIN-CALC-AH-X.                                                  ECSRIRTN
 13883     EXIT.                                                        ECSRIRTN
 13884                                                                  ECSRIRTN
 13885 REINSURE-CALC-REMAINDER.                                         ECSRIRTN
 13886                                                                  ECSRIRTN
 13887     COMPUTE RWF-LFAMT = CR-LFAMT + CR-LFAMT-ALT.                 ECSRIRTN
 13888     COMPUTE RWF-LFPRM = CR-LFPRM + CR-LFPRM-ALT.                 ECSRIRTN
 13889     MOVE CR-AHAMT TO RWF-AHAMT.                                  ECSRIRTN
 13890     MOVE CR-AHPRM TO RWF-AHPRM.                                  ECSRIRTN
 13891                                                                  ECSRIRTN
 13892     PERFORM REINSURE-SUBTRACT THRU REINSURE-SUBTRACT-X           ECSRIRTN
 13893         VARYING SUB2 FROM +1 BY +1 UNTIL SUB2 = SUB1.            ECSRIRTN
 13894                                                                  ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 269
* ECS010T1.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 13895     IF RWF-LFAMT NOT = ZEROS OR                                  ECSRIRTN
 13896        RWF-LFPRM NOT = ZEROS                                     ECSRIRTN
 13897           MOVE 'X' TO REIN-LF-FLG (SUB1).                        ECSRIRTN
 13898                                                                  ECSRIRTN
 13899     IF RWF-AHAMT NOT = ZEROS OR                                  ECSRIRTN
 13900        RWF-AHPRM NOT = ZEROS                                     ECSRIRTN
 13901           MOVE 'X' TO REIN-AH-FLG (SUB1).                        ECSRIRTN
 13902                                                                  ECSRIRTN
 13903 REINSURE-CALC-X.                                                 ECSRIRTN
 13904                                                                  ECSRIRTN
 13905     IF REIN-LF-AH-FLGS (SUB1) NOT = SPACES                       ECSRIRTN
 13906         MOVE 'X' TO REIN-BUS-FLAG.                               ECSRIRTN
 13907                                                                  ECSRIRTN
 13908     MOVE RWF-FIELDS TO REIN-WORK-FLDS (SUB1).                    ECSRIRTN
 13909                                                                  ECSRIRTN
 13910 REINSURE-SUBTRACT.                                               ECSRIRTN
 13911                                                                  ECSRIRTN
 13912     SUBTRACT REIN-LFAMT (SUB2) FROM RWF-LFAMT.                   ECSRIRTN
 13913     SUBTRACT REIN-LFPRM (SUB2) FROM RWF-LFPRM.                   ECSRIRTN
 13914     SUBTRACT REIN-AHAMT (SUB2) FROM RWF-AHAMT.                   ECSRIRTN
 13915     SUBTRACT REIN-AHPRM (SUB2) FROM RWF-AHPRM.                   ECSRIRTN
 13916                                                                  ECSRIRTN
 13917 REINSURE-SUBTRACT-X.                                             ECSRIRTN
 13918     EXIT.                                                        ECSRIRTN
 13919                                                                  ECSRIRTN
 13920 REINSURE-CALC-CANCEL.                                            ECSRIRTN
 13921                                                                  ECSRIRTN
 13922     MOVE REIN-WORK-FLDS (SUB1) TO RWF-FIELDS.                    ECSRIRTN
 13923     MOVE RE-COMP-INFO (SUB1) TO WT-COMP-INFO.                    ECSRIRTN
 13924                                                                  ECSRIRTN
 13925     IF SUB1 = RE-100-COMP                                        ECSRIRTN
 13926         GO TO REINSURE-REMAINDER-CANCEL.                         ECSRIRTN
 13927                                                                  ECSRIRTN
 13928     IF REIN-LF-FLG (SUB1) NOT = 'X'                              ECSRIRTN
 13929         GO TO REINSURE-CALC-CANCEL-AH.                           ECSRIRTN
 13930                                                                  ECSRIRTN
 13931     IF RWF-LF-RUNOFF-SW = 'N'                                    ECSRIRTN
 13932         IF CR-LF-CANC-DT NOT LESS THAN RWF-EP-STOP-DATE             CL**3
 13933             GO TO REINSURE-CALC-CANCEL-AH.                       ECSRIRTN
 13934                                                                  ECSRIRTN
 13935     IF WT-REMAINING = 'I'                                        ECSRIRTN
 13936         GO TO REINSURE-CALC-LF-RISK-CANCEL.                      ECSRIRTN
 13937                                                                  ECSRIRTN
 13938     IF WT-REMAINING = 'L'                                        ECSRIRTN
 13939         COMPUTE RWF-LFRFND ROUNDED = CR-LFRFND * WT-LF-PCT       ECSRIRTN
 13940         GO TO REINSURE-CALC-CANCEL-AH.                           ECSRIRTN
 13941                                                                  ECSRIRTN
 13942     IF CR-LFPRM = ZERO                                           ECSRIRTN
 13943        MOVE ZERO                TO REIN-FACTOR
 13944     ELSE                                                         ECSRIRTN
 13945        IF DTE-CLIENT = 'GIC'  AND
 13946           CLAS-I-BAL (CLAS-INDEXL) = 'B'
 13947           MOVE +1.0             TO REIN-FACTOR
 13948        ELSE
 13949           IF DTE-CLIENT = 'DCC'
 13950              COMPUTE REIN-FACTOR = CR-LFRFND /
 13951                 (CR-LFPRM + CR-LFPRM-ALT)
 13952           ELSE
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 270
* ECS010T1.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 13953              COMPUTE REIN-FACTOR ROUNDED =  CR-LFRFND-CALC /
 13954                 (CR-LFPRM + CR-LFPRM-ALT)
 13955            END-IF
 13956         END-IF
 13957     END-IF
 13958                                                                  ECSRIRTN
 13959     IF CR-LFAMT NOT = ZERO                                       ECSRIRTN
 13960         IF DTE-CLIENT = 'GTL'  OR  'UAL'  OR  'NCL'  OR  'CVL'   ECSRIRTN
 13961             IF WT-LF-QC = ('1' OR '4')                           ECSRIRTN
 13962                 COMPUTE RWF-LFRFND ROUNDED =  ((CR-LFRFND *      ECSRIRTN
 13963                         RWF-LFAMT) / (CR-LFAMT + CR-LFAMT-ALT))  ECSRIRTN
 13964             ELSE                                                 ECSRIRTN
 13965                 COMPUTE RWF-LFRFND =                             ECSRIRTN
 13966                            REIN-FACTOR * REIN-CALCED-LIFE        ECSRIRTN
 13967                 COMPUTE RWF-LFRFND ROUNDED =  ((RWF-LFRFND *     ECSRIRTN
 13968                         RWF-LFAMT) / (CR-LFAMT + CR-LFAMT-ALT))  ECSRIRTN
 13969         ELSE                                                     ECSRIRTN
 13970             IF WT-LF-QC = ('1' OR '4')                           ECSRIRTN
 13971                 compute rein-factor rounded =
 13972                    RWF-LFAMT / (CR-LFAMT + CR-LFAMT-ALT)
 13973                 COMPUTE RWF-LFRFND ROUNDED =  CR-LFRFND *
 13974                    rein-factor
 13975             ELSE                                                 ECSRIRTN
 13976*                COMPUTE RWF-LFRFND = REIN-FACTOR
 13977*                   * REIN-CALCED-LIFE *
 13978*                   (RWF-LFAMT / (CR-LFAMT + CR-LFAMT-ALT)).
 13979                 COMPUTE RWF-LFRFND =                             ECSRIRTN
 13980                            REIN-FACTOR * REIN-CALCED-LIFE        ECSRIRTN
 13981                 COMPUTE RWF-LFRFND ROUNDED =  (RWF-LFRFND *
 13982                        RWF-LFAMT) / (CR-LFAMT + CR-LFAMT-ALT).
 13983                                                                  ECSRIRTN
 13984     IF CR-LFAMT = ZERO                                           ECSRIRTN
 13985         IF WT-LF-LIM-LO = ZERO                                   ECSRIRTN
 13986             IF WT-LF-QC = ('1' OR '4')                           ECSRIRTN
 13987                 COMPUTE RWF-LFRFND ROUNDED =                     ECSRIRTN
 13988                       CR-LFRFND * WT-LF-PCT                      ECSRIRTN
 13989             ELSE                                                 ECSRIRTN
 13990                 COMPUTE RWF-LFRFND =                             ECSRIRTN
 13991                            REIN-FACTOR * REIN-CALCED-LIFE        ECSRIRTN
 13992                 COMPUTE RWF-LFRFND ROUNDED =                     ECSRIRTN
 13993                       RWF-LFRFND * WT-LF-PCT.                    ECSRIRTN
 13994                                                                  ECSRIRTN
 13995     GO TO REINSURE-CALC-CANCEL-AH.                               ECSRIRTN
 13996                                                                  ECSRIRTN
 13997                                                                  ECSRIRTN
 13998 REINSURE-CALC-LF-RISK-CANCEL.                                    ECSRIRTN
 13999                                                                  ECSRIRTN
 14000     IF RWF-LFAMT NOT GREATER THAN +0  OR                         ECSRIRTN
 14001       (CR-LF-CANC-DT = ZEROS)                                       CL*10
 14002         MOVE ZERO                    TO RWF-LFRFND               ECSRIRTN
 14003         GO TO REINSURE-CALC-CANCEL-AH.                           ECSRIRTN
 14004                                                                  ECSRIRTN
 14005     IF REIN-RT-SW NOT = 'X'                                      ECSRIRTN
 14006       IF VOIDING-LF-CANCEL                                       ECSRIRTN
 14007           COMPUTE RWF-LFRFND = RWF-LFRFND * (-1)                 ECSRIRTN
 14008           GO TO REINSURE-CALC-CANCEL-AH                          ECSRIRTN
 14009       ELSE                                                       ECSRIRTN
 14010           IF ADDITIONAL-LF-CANCEL                                ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 271
* ECS010T1.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 14011               GO TO REINSURE-CALC-CANCEL-AH.                     ECSRIRTN
 14012                                                                  ECSRIRTN
 14013     IF FLAT-CANCEL-LF                                            ECSRIRTN
 14014         MOVE RWF-LFPRM               TO RWF-LFRFND               ECSRIRTN
 14015         GO TO REINSURE-CALC-CANCEL-AH.                           ECSRIRTN
 14016                                                                  ECSRIRTN
 14017     IF REIN-EARN-LF-TERM = REIN-LCNC-EARN-TERM                   ECSRIRTN
 14018         MOVE ZERO                    TO RWF-LFRFND               ECSRIRTN
 14019         GO TO REINSURE-CALC-CANCEL-AH.                           ECSRIRTN
 14020                                                                  ECSRIRTN
 14021     MOVE RWF-LFAMT                   TO REIN-RISK-AMOUNT.        ECSRIRTN
 14022     COMPUTE REIN-MONTH-REDUCE = RS-LIFE-BEN / CR-LF-TERM.        ECSRIRTN
 14023     MOVE +0                          TO REIN-WORKA               ECSRIRTN
 14024                                         RW-LFRFND.               ECSRIRTN
 14025                                                                  ECSRIRTN
 14026 REINSURE-LF-RISK-CANCEL-LOOP.                                    ECSRIRTN
 14027                                                                  ECSRIRTN
 14028     COMPUTE RW-LFRFND = RW-LFRFND +                              ECSRIRTN
 14029                ((REIN-RISK-AMOUNT / +1000) * CR-LF-NSP-PRM-RATE).ECSRIRTN
 14030                                                                  ECSRIRTN
 14031     IF CLAS-I-RL-AH (CLAS-INDEXL) NOT = 'L'                      ECSRIRTN
 14032        SUBTRACT REIN-MONTH-REDUCE FROM REIN-RISK-AMOUNT.         ECSRIRTN
 14033                                                                  ECSRIRTN
 14034     IF REIN-WORKA = REIN-LCNC-EARN-TERM  OR                      ECSRIRTN
 14035        REIN-RISK-AMOUNT LESS THAN +0                             ECSRIRTN
 14036         COMPUTE RWF-LFRFND = RWF-LFPRM - RW-LFRFND               ECSRIRTN
 14037     ELSE                                                         ECSRIRTN
 14038         ADD +1 TO REIN-WORKA                                     ECSRIRTN
 14039         GO TO REINSURE-LF-RISK-CANCEL-LOOP.                      ECSRIRTN
 14040                                                                  ECSRIRTN
 14041                                                                  ECSRIRTN
 14042 REINSURE-CALC-CANCEL-AH.                                         ECSRIRTN
 14043                                                                  ECSRIRTN
 14044     IF REIN-AH-FLG (SUB1) NOT = 'X'                              ECSRIRTN
 14045         GO TO REINSURE-CALC-CANCEL-SKIP.                         ECSRIRTN
 14046                                                                  ECSRIRTN
 14047     IF RWF-AH-RUNOFF-SW = 'N'                                    ECSRIRTN
 14048         IF CR-AH-CANC-DT NOT LESS THAN RWF-EP-STOP-DATE             CL**4
 14049             GO TO REINSURE-CALC-CANCEL-SKIP.                     ECSRIRTN
 14050                                                                  ECSRIRTN
 14051     IF RWF-REM-AH-100 = 'Y'                                      ECSRIRTN
 14052         MOVE CR-AHRFND TO RWF-AHRFND                             ECSRIRTN
 14053         PERFORM REINSURE-SUB-REM-CANCEL THRU                     ECSRIRTN
 14054             REINSURE-SUB-REM-CANCEL-X                            ECSRIRTN
 14055                 VARYING SUB2 FROM +1 BY +1 UNTIL SUB2 = SUB1     ECSRIRTN
 14056         GO TO REINSURE-CALC-CANCEL-SKIP.                         ECSRIRTN
 14057                                                                  ECSRIRTN
 14058     IF WT-REMAINING = 'I'                                        ECSRIRTN
 14059         GO TO REINSURE-CALC-AH-RISK-CANCEL.                      ECSRIRTN
 14060                                                                  ECSRIRTN
 14061     IF WT-REMAINING = 'L'                                        ECSRIRTN
 14062         COMPUTE RWF-AHRFND ROUNDED = CR-AHRFND * WT-AH-PCT       ECSRIRTN
 14063         GO TO REINSURE-CALC-CANCEL-SKIP.                         ECSRIRTN
 14064                                                                  ECSRIRTN
 14065     IF CR-AHPRM = ZERO                                           ECSRIRTN
 14066        MOVE ZERO                TO REIN-FACTOR
 14067     ELSE
 14068        IF DTE-CLIENT = 'GIC'  AND
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 272
* ECS010T1.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 14069           CLAS-I-BAL (CLAS-INDEXA) = 'B'
 14070            MOVE +1.0            TO REIN-FACTOR
 14071        ELSE
 14072           IF DTE-CLIENT = 'DCC'
 14073              COMPUTE REIN-FACTOR =
 14074                 CR-AHRFND / CR-AHPRM
 14075           ELSE
 14076              COMPUTE REIN-FACTOR ROUNDED =
 14077                                CR-AHRFND-CALC / CR-AHPRM
 14078           END-IF
 14079        END-IF
 14080     END-IF
 14081
 14082     IF CR-AHAMT NOT = ZERO
 14083        IF (DTE-CLIENT = 'DCC')
 14084           AND (CLAS-I-REFUND-METHOD (CLAS-INDEXA) = 'D')
 14085           MOVE CR-AH-RFND-CLP   TO RWF-AHRFND
 14086        ELSE
 14087           IF WT-AH-QC = ('1' OR '4')
 14088              compute rein-factor rounded = rwf-ahamt / cr-ahamt
 14089              compute rwf-ahrfnd rounded =
 14090                 cr-ahrfnd * rein-factor
 14091           ELSE
 14092              COMPUTE RWF-AHRFND = REIN-FACTOR * REIN-CALCED-AH
 14093              COMPUTE RWF-AHRFND ROUNDED = (RWF-AHRFND *
 14094                       RWF-AHAMT) / CR-AHAMT
 14095           END-IF
 14096        END-IF
 14097     ELSE
 14098        IF RWF-AH-LIMIT = ZERO
 14099           IF WT-AH-QC = ('1' OR '4')
 14100              COMPUTE RWF-AHRFND ROUNDED =
 14101                       CR-AHRFND * WT-AH-PCT
 14102           ELSE
 14103              COMPUTE RWF-AHRFND =
 14104                            REIN-FACTOR * REIN-CALCED-AH
 14105              COMPUTE RWF-AHRFND ROUNDED =
 14106                       RWF-AHRFND * WT-AH-PCT
 14107           END-IF
 14108        END-IF
 14109     END-IF
 14110
 14111     GO TO REINSURE-CALC-CANCEL-SKIP.                             ECSRIRTN
 14112                                                                  ECSRIRTN
 14113                                                                  ECSRIRTN
 14114 REINSURE-CALC-AH-RISK-CANCEL.                                    ECSRIRTN
 14115                                                                  ECSRIRTN
 14116     IF RWF-AHAMT NOT GREATER THAN +0  OR                         ECSRIRTN
 14117       (CR-AH-CANC-DT = ZEROS)                                       CL*10
 14118         MOVE ZERO                    TO RWF-AHRFND               ECSRIRTN
 14119         GO TO REINSURE-CALC-CANCEL-SKIP.                         ECSRIRTN
 14120                                                                  ECSRIRTN
 14121     IF REIN-RT-SW NOT = 'X'                                      ECSRIRTN
 14122       IF VOIDING-AH-CANCEL                                       ECSRIRTN
 14123           COMPUTE RWF-AHRFND = RWF-AHRFND * (-1)                 ECSRIRTN
 14124           GO TO REINSURE-CALC-CANCEL-SKIP                        ECSRIRTN
 14125       ELSE                                                       ECSRIRTN
 14126           IF ADDITIONAL-AH-CANCEL                                ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 273
* ECS010T1.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 14127               GO TO REINSURE-CALC-CANCEL-SKIP.                   ECSRIRTN
 14128                                                                  ECSRIRTN
 14129     IF FLAT-CANCEL-AH                                            ECSRIRTN
 14130         MOVE RWF-AHPRM               TO RWF-AHRFND               ECSRIRTN
 14131         GO TO REINSURE-CALC-CANCEL-SKIP.                         ECSRIRTN
 14132                                                                  ECSRIRTN
 14133     IF REIN-EARN-AH-TERM = REIN-ACNC-EARN-TERM                   ECSRIRTN
 14134         MOVE ZERO                    TO RWF-AHRFND               ECSRIRTN
 14135         GO TO REINSURE-CALC-CANCEL-SKIP.                         ECSRIRTN
 14136                                                                  ECSRIRTN
 14137     MOVE RS-AH-BEN              TO REIN-MONTH-REDUCE.            ECSRIRTN
 14138     COMPUTE REIN-RISK-AMOUNT = RWF-AHAMT * CR-AH-TERM.           ECSRIRTN
 14139     MOVE +0                     TO REIN-WORKA                    ECSRIRTN
 14140                                    RW-AHRFND.                    ECSRIRTN
 14141                                                                  ECSRIRTN
 14142 REINSURE-AH-RISK-CANCEL-LOOP.                                    ECSRIRTN
 14143                                                                  ECSRIRTN
 14144     COMPUTE RW-AHRFND = RW-AHRFND +                              ECSRIRTN
 14145                ((REIN-RISK-AMOUNT / +1000) * CR-AH-NSP-PRM-RATE).ECSRIRTN
 14146                                                                  ECSRIRTN
 14147     SUBTRACT REIN-MONTH-REDUCE FROM REIN-RISK-AMOUNT.            ECSRIRTN
 14148                                                                  ECSRIRTN
 14149     IF REIN-WORKA = REIN-ACNC-EARN-TERM  OR                      ECSRIRTN
 14150        REIN-RISK-AMOUNT LESS THAN +0                             ECSRIRTN
 14151         COMPUTE RWF-AHRFND = RWF-AHPRM - RW-AHRFND               ECSRIRTN
 14152     ELSE                                                         ECSRIRTN
 14153         ADD +1 TO REIN-WORKA                                     ECSRIRTN
 14154         GO TO REINSURE-AH-RISK-CANCEL-LOOP.                      ECSRIRTN
 14155                                                                  ECSRIRTN
 14156                                                                  ECSRIRTN
 14157 REINSURE-CALC-CANCEL-SKIP.                                       ECSRIRTN
 14158                                                                  ECSRIRTN
 14159     IF RWF-LFRFND NOT = ZEROS                                    ECSRIRTN
 14160         MOVE 'X' TO REIN-LF-FLG (SUB1).                          ECSRIRTN
 14161                                                                  ECSRIRTN
 14162     IF RWF-AHRFND NOT = ZEROS                                    ECSRIRTN
 14163         MOVE 'X' TO REIN-AH-FLG (SUB1).                          ECSRIRTN
 14164                                                                  ECSRIRTN
 14165     GO TO REINSURE-CALC-CANCEL-X.                                ECSRIRTN
 14166                                                                  ECSRIRTN
 14167 REINSURE-REMAINDER-CANCEL.                                       ECSRIRTN
 14168                                                                  ECSRIRTN
 14169     MOVE CR-LFRFND TO RWF-LFRFND.                                ECSRIRTN
 14170     MOVE CR-AHRFND TO RWF-AHRFND.                                ECSRIRTN
 14171                                                                  ECSRIRTN
 14172     PERFORM REINSURE-SUBTRACT-CANCEL THRU                        ECSRIRTN
 14173         REINSURE-SUBTRACT-CANCEL-X                               ECSRIRTN
 14174             VARYING SUB2 FROM +1 BY +1 UNTIL SUB2 = SUB1.        ECSRIRTN
 14175                                                                  ECSRIRTN
 14176     IF RWF-LFRFND NOT = ZEROS                                    ECSRIRTN
 14177         MOVE 'X' TO REIN-LF-FLG (SUB1).                          ECSRIRTN
 14178                                                                  ECSRIRTN
 14179     IF RWF-AHRFND NOT = ZEROS                                    ECSRIRTN
 14180         MOVE 'X' TO REIN-AH-FLG (SUB1).                          ECSRIRTN
 14181                                                                  ECSRIRTN
 14182 REINSURE-CALC-CANCEL-X.                                          ECSRIRTN
 14183                                                                  ECSRIRTN
 14184     IF REIN-LF-AH-FLGS (SUB1) NOT = SPACES                       ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 274
* ECS010T1.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 14185         MOVE 'X' TO REIN-BUS-FLAG.                               ECSRIRTN
 14186                                                                  ECSRIRTN
 14187     MOVE RWF-FIELDS TO REIN-WORK-FLDS (SUB1).                    ECSRIRTN
 14188                                                                  ECSRIRTN
 14189 REINSURE-SUBTRACT-CANCEL.                                        ECSRIRTN
 14190                                                                  ECSRIRTN
 14191     SUBTRACT REIN-LFRFND (SUB2) FROM RWF-LFRFND.                 ECSRIRTN
 14192     SUBTRACT REIN-AHRFND (SUB2) FROM RWF-AHRFND.                 ECSRIRTN
 14193                                                                  ECSRIRTN
 14194 REINSURE-SUBTRACT-CANCEL-X.                                      ECSRIRTN
 14195     EXIT.                                                        ECSRIRTN
 14196                                                                  ECSRIRTN
 14197 REINSURE-SUB-REM-CANCEL.                                         ECSRIRTN
 14198                                                                  ECSRIRTN
 14199     IF REIN-REM-SW (SUB2) = 'Y' OR 'Z' OR 'X' OR 'N'             ECSRIRTN
 14200         SUBTRACT REIN-AHRFND (SUB2) FROM RWF-AHRFND.             ECSRIRTN
 14201                                                                  ECSRIRTN
 14202 REINSURE-SUB-REM-CANCEL-X.                                       ECSRIRTN
 14203     EXIT.                                                        ECSRIRTN
 14204                                                                  ECSRIRTN
 14205 REINSURE-CALC-CLAIM.                                             ECSRIRTN
 14206                                                                  ECSRIRTN
 14207     MOVE REIN-WORK-FLDS (SUB1) TO RWF-FIELDS.                    ECSRIRTN
 14208     MOVE RE-COMP-INFO (SUB1) TO WT-COMP-INFO.                    ECSRIRTN
 14209                                                                  ECSRIRTN
 14210     IF SUB1 = RE-100-COMP                                        ECSRIRTN
 14211         GO TO REINSURE-REMAINDER-CLAIM.                          ECSRIRTN
 14212                                                                  ECSRIRTN
 14213     PERFORM REIN-FIND-CO-LOOP THRU FIND-REI-CO-EXIT              ECSRIRTN
 14214        VARYING CO-SUB FROM 1 BY 1 UNTIL                          ECSRIRTN
 14215          (RCT-REIN-CO (CO-SUB) = REIN-COMP (SUB1))  OR           ECSRIRTN
 14216          (CO-SUB GREATER REIN-CO-TABLE-ENT-CNT)     OR           ECSRIRTN
 14217          (RCT-REIN-CO (CO-SUB) = SPACES).                        ECSRIRTN
 14218                                                                  ECSRIRTN
 14219     IF (CO-SUB GREATER REIN-CO-TABLE-ENT-CNT)  OR                ECSRIRTN
 14220        (RCT-REIN-CO (CO-SUB) = SPACES)                           ECSRIRTN
 14221          MOVE ZERO TO CO-SUB.                                    ECSRIRTN
 14222                                                                  ECSRIRTN
 14223     MOVE ZEROS                TO RWF-LFCLML                      ECSRIRTN
 14224                                  RWF-AHCLML.                     ECSRIRTN
 14225                                                                  ECSRIRTN
 14226     IF REIN-LF-FLG (SUB1) NOT = 'X'                              ECSRIRTN
 14227         GO TO REINSURE-CALC-CLAIM-AH.                            ECSRIRTN
 14228                                                                  ECSRIRTN
 14229     IF RW-LFCLMWK = ZEROS                                        ECSRIRTN
 14230         GO TO REINSURE-CALC-CLAIM-AH.                            ECSRIRTN
 14231                                                                  ECSRIRTN
 14232     IF CO-SUB NOT = ZERO                                         ECSRIRTN
 14233         IF RCT-CLM-CUTOFF-DT (CO-SUB) NOT = ZERO                 ECSRIRTN
 14234             IF CR-DTH-DT LESS RCT-CLM-CUTOFF-DT (CO-SUB)         ECSRIRTN
 14235                 GO TO REINSURE-CALC-CLAIM-AH.                    ECSRIRTN
 14236                                                                  ECSRIRTN
 14237     IF RWF-LF-RUNOFF-SW = 'N'                                    ECSRIRTN
 14238         IF CR-DTH-DT NOT LESS THAN RWF-EP-STOP-DATE                 CL**6
 14239                 GO TO REINSURE-CALC-CLAIM-AH.                    ECSRIRTN
 14240                                                                  ECSRIRTN
 14241     IF WT-REMAINING = 'I'                                        ECSRIRTN
 14242         GO TO REINSURE-CALC-LF-RISK-CLAIM.                       ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 275
* ECS010T1.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 14243                                                                  ECSRIRTN
 14244     IF WT-REMAINING = 'L'                                        ECSRIRTN
 14245         IF REIN-RT-SW = 'X'                                      ECSRIRTN
 14246             IF RW-LFCLMWK GREATER WT-LF-HI                       ECSRIRTN
 14247                 MOVE WT-LF-HI TO RWF-LFCLM                       ECSRIRTN
 14248             ELSE                                                 ECSRIRTN
 14249                 MOVE RW-LFCLMWK TO RWF-LFCLM                     ECSRIRTN
 14250         ELSE                                                     ECSRIRTN
 14251             IF (RW-LFCLMWK + RWF-LFCLM) GREATER WT-LF-HI         ECSRIRTN
 14252                 COMPUTE RWF-LFCLML = WT-LF-HI - RWF-LFCLM        ECSRIRTN
 14253                 MOVE WT-LF-HI TO RWF-LFCLM                       ECSRIRTN
 14254             ELSE                                                 ECSRIRTN
 14255                 MOVE RW-LFCLMWK TO RWF-LFCLML                    ECSRIRTN
 14256                 ADD RWF-LFCLML TO RWF-LFCLM.                     ECSRIRTN
 14257                                                                  ECSRIRTN
 14258     IF WT-REMAINING = 'L'                                        ECSRIRTN
 14259         GO TO REINSURE-CALC-CLAIM-AH.                            ECSRIRTN
 14260                                                                  ECSRIRTN
 14261     IF CR-LFAMT NOT = ZERO                                       ECSRIRTN
 14262         IF DTE-CLIENT = 'GTL'  OR  'UAL'  OR  'NCL'  OR  'CVL'   ECSRIRTN
 14263            OR 'DCC'
 14264             COMPUTE RWF-LFCLML ROUNDED =  ((RW-LFCLMWK *         ECSRIRTN
 14265                         RWF-LFAMT) / (CR-LFAMT + CR-LFAMT-ALT))  ECSRIRTN
 14266         ELSE                                                     ECSRIRTN
 14267             COMPUTE RWF-LFCLML ROUNDED =  RW-LFCLMWK *           ECSRIRTN
 14268                        (RWF-LFAMT / (CR-LFAMT + CR-LFAMT-ALT)).  ECSRIRTN
 14269                                                                  ECSRIRTN
 14270     IF CR-LFAMT = ZERO                                           ECSRIRTN
 14271         IF WT-LF-LIM-LO = ZERO                                   ECSRIRTN
 14272             COMPUTE RWF-LFCLML ROUNDED =                         ECSRIRTN
 14273                       RW-LFCLMWK * WT-LF-PCT.                    ECSRIRTN
 14274                                                                  ECSRIRTN
 14275     IF CO-SUB NOT = ZERO                                         ECSRIRTN
 14276         IF RCT-LF-CLM-PCT (CO-SUB) NOT = ZERO                    ECSRIRTN
 14277             COMPUTE RWF-LFCLML ROUNDED =                         ECSRIRTN
 14278                          RW-LFCLMWK * RCT-LF-CLM-PCT (CO-SUB).   ECSRIRTN
 14279                                                                  ECSRIRTN
 14280     IF CO-SUB NOT = ZERO                                         ECSRIRTN
 14281         IF RCT-LF-CLM-MAX (CO-SUB) NOT = ZERO                    ECSRIRTN
 14282             IF REIN-RT-SW = 'X'                                  ECSRIRTN
 14283               IF RWF-LFCLML GREATER RCT-LF-CLM-MAX (CO-SUB)      ECSRIRTN
 14284                     MOVE RCT-LF-CLM-MAX (CO-SUB) TO RWF-LFCLM    ECSRIRTN
 14285                      GO TO REINSURE-CALC-CLAIM-AH                ECSRIRTN
 14286                  ELSE                                            ECSRIRTN
 14287                     MOVE RWF-LFCLML TO RWF-LFCLM                 ECSRIRTN
 14288                      GO TO REINSURE-CALC-CLAIM-AH                ECSRIRTN
 14289              ELSE                                                ECSRIRTN
 14290                 IF (RWF-LFCLML + RWF-LFCLM) GREATER              ECSRIRTN
 14291                                           RCT-LF-CLM-MAX (CO-SUB)ECSRIRTN
 14292                     COMPUTE RWF-LFCLML =                         ECSRIRTN
 14293                               RCT-LF-CLM-MAX (CO-SUB) - RWF-LFCLMECSRIRTN
 14294                     MOVE RCT-LF-CLM-MAX (CO-SUB) TO RWF-LFCLM    ECSRIRTN
 14295                      GO TO REINSURE-CALC-CLAIM-AH.               ECSRIRTN
 14296                                                                  ECSRIRTN
 14297     ADD RWF-LFCLML TO RWF-LFCLM.                                 ECSRIRTN
 14298                                                                  ECSRIRTN
 14299     GO TO REINSURE-CALC-CLAIM-AH.                                ECSRIRTN
 14300                                                                  ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 276
* ECS010T1.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 14301                                                                  ECSRIRTN
 14302 REINSURE-CALC-LF-RISK-CLAIM.                                     ECSRIRTN
 14303                                                                  ECSRIRTN
 14304     IF RWF-LFAMT NOT GREATER THAN +0                             ECSRIRTN
 14305         GO TO REINSURE-CALC-CLAIM-AH.                            ECSRIRTN
 14306                                                                  ECSRIRTN
 14307     IF CLAS-I-RL-AH (CLAS-INDEXL) = 'L'                          ECSRIRTN
 14308         MOVE RWF-LFAMT                   TO REIN-RISK-AMOUNT     ECSRIRTN
 14309     ELSE                                                         ECSRIRTN
 14310         COMPUTE REIN-RISK-AMOUNT = RWF-LFAMT -                   ECSRIRTN
 14311                ((RS-LIFE-BEN / CR-LF-TERM) * REIN-LF-CLM-MONTHS).ECSRIRTN
 14312                                                                  ECSRIRTN
 14313     IF REIN-RISK-AMOUNT NOT GREATER THAN +0                      ECSRIRTN
 14314         GO TO REINSURE-CALC-CLAIM-AH.                            ECSRIRTN
 14315                                                                  ECSRIRTN
 14316     IF REIN-RT-SW = 'X'                                          ECSRIRTN
 14317         IF RW-LFCLMWK GREATER THAN REIN-RISK-AMOUNT              ECSRIRTN
 14318             MOVE REIN-RISK-AMOUNT        TO RWF-LFCLM            ECSRIRTN
 14319         ELSE                                                     ECSRIRTN
 14320             MOVE RW-LFCLMWK              TO RWF-LFCLM            ECSRIRTN
 14321     ELSE                                                         ECSRIRTN
 14322         IF (RW-LFCLMWK + RWF-LFCLM) GREATER THAN REIN-RISK-AMOUNTECSRIRTN
 14323             COMPUTE RWF-LFCLML = REIN-RISK-AMOUNT - RWF-LFCLM    ECSRIRTN
 14324             MOVE REIN-RISK-AMOUNT        TO RWF-LFCLM            ECSRIRTN
 14325         ELSE                                                     ECSRIRTN
 14326             MOVE RW-LFCLMWK              TO RWF-LFCLML           ECSRIRTN
 14327             ADD RW-LFCLMWK TO RWF-LFCLM.                         ECSRIRTN
 14328                                                                  ECSRIRTN
 14329                                                                  ECSRIRTN
 14330 REINSURE-CALC-CLAIM-AH.                                          ECSRIRTN
 14331                                                                  ECSRIRTN
 14332     IF REIN-AH-FLG (SUB1) NOT = 'X'                              ECSRIRTN
 14333         GO TO REINSURE-CALC-CLAIM-X.                             ECSRIRTN
 14334                                                                  ECSRIRTN
 14335     IF RW-AHCLMWK = ZEROS                                        ECSRIRTN
 14336         GO TO REINSURE-CALC-CLAIM-SKIP.                          ECSRIRTN
 14337                                                                  ECSRIRTN
 14338     IF REIN-RT-SW NOT = 'X'                                      ECSRIRTN
 14339         GO TO REINSURE-CALC-AH-DETAIL.                           ECSRIRTN
 14340                                                                  ECSRIRTN
 14341     MOVE CR-DISAB-INCURRED-DETAIL    TO RW-AH-INCURRED-DETAIL.   ECSRIRTN
 14342     MOVE ZEROS                       TO RW-AHCLMWK.              ECSRIRTN
 14343                                                                  ECSRIRTN
 14344     PERFORM CHECK-MULTIPLE-DISABILITIES THRU CHECK-DISABS-EXIT   ECSRIRTN
 14345             VARYING                                              ECSRIRTN
 14346         INC-SUB FROM +1 BY +1                                    ECSRIRTN
 14347             UNTIL                                                ECSRIRTN
 14348         INC-SUB GREATER THAN +5.                                 ECSRIRTN
 14349                                                                  ECSRIRTN
 14350     IF RW-AHCLMWK = ZEROS                                        ECSRIRTN
 14351         GO TO REINSURE-CALC-CLAIM-SKIP                           ECSRIRTN
 14352     ELSE                                                         ECSRIRTN
 14353         GO TO REINSURE-CALC-AH-CONTINUED.                        ECSRIRTN
 14354                                                                  ECSRIRTN
 14355 CHECK-MULTIPLE-DISABILITIES.                                     ECSRIRTN
 14356                                                                  ECSRIRTN
 14357     IF RW-AH-INCUR-DT (INC-SUB) = ZEROS                          ECSRIRTN
 14358         GO TO CHECK-DISABS-EXIT.                                 ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 277
* ECS010T1.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 14359                                                                  ECSRIRTN
 14360     IF CO-SUB NOT = ZERO                                         ECSRIRTN
 14361       IF RCT-CLM-CUTOFF-DT (CO-SUB) NOT = ZERO                   ECSRIRTN
 14362           IF RW-AH-INCUR-DT (INC-SUB) LESS THAN                  ECSRIRTN
 14363                       RCT-CLM-CUTOFF-DT (CO-SUB)                    CL**5
 14364               MOVE ZEROS             TO RW-AH-CLM-AMT (INC-SUB)  ECSRIRTN
 14365                                         RW-AH-CLM-EXP (INC-SUB)  ECSRIRTN
 14366               GO TO CHECK-DISABS-EXIT.                           ECSRIRTN
 14367                                                                  ECSRIRTN
 14368     IF RWF-AH-RUNOFF-SW = 'N'                                    ECSRIRTN
 14369       IF RW-AH-INCUR-DT (INC-SUB) NOT LESS THAN RWF-EP-STOP-DATE ECSRIRTN
 14370           MOVE ZEROS                 TO RW-AH-CLM-AMT (INC-SUB)  ECSRIRTN
 14371                                         RW-AH-CLM-EXP (INC-SUB)  ECSRIRTN
 14372           GO TO CHECK-DISABS-EXIT.                               ECSRIRTN
 14373                                                                  ECSRIRTN
 14374     IF WT-REMAINING NOT = 'I'                                    ECSRIRTN
 14375         COMPUTE RW-AHCLMWK = RW-AHCLMWK                          ECSRIRTN
 14376                             + RW-AH-CLM-AMT (INC-SUB)            ECSRIRTN
 14377                             + RW-AH-CLM-EXP (INC-SUB)            ECSRIRTN
 14378         GO TO CHECK-DISABS-EXIT.                                 ECSRIRTN
 14379                                                                  ECSRIRTN
 14380     IF RWF-AHAMT NOT GREATER THAN +0                             ECSRIRTN
 14381         GO TO CHECK-DISABS-EXIT.                                 ECSRIRTN
 14382                                                                  ECSRIRTN
 14383     IF INC-SUB = +1                                              ECSRIRTN
 14384         MOVE REIN-AH-CLM-MTH-1       TO REIN-AH-CLM-MONTHS.      ECSRIRTN
 14385     IF INC-SUB = +2                                              ECSRIRTN
 14386         MOVE REIN-AH-CLM-MTH-2       TO REIN-AH-CLM-MONTHS.      ECSRIRTN
 14387     IF INC-SUB = +3                                              ECSRIRTN
 14388         MOVE REIN-AH-CLM-MTH-3       TO REIN-AH-CLM-MONTHS.      ECSRIRTN
 14389     IF INC-SUB = +4                                              ECSRIRTN
 14390         MOVE REIN-AH-CLM-MTH-4       TO REIN-AH-CLM-MONTHS.      ECSRIRTN
 14391     IF INC-SUB = +5                                              ECSRIRTN
 14392         MOVE REIN-AH-CLM-MTH-5       TO REIN-AH-CLM-MONTHS.      ECSRIRTN
 14393                                                                  ECSRIRTN
 14394     COMPUTE REIN-RISK-AMOUNT = (RWF-AHAMT * CR-AH-TERM) -        ECSRIRTN
 14395                                (RS-AH-BEN * REIN-AH-CLM-MONTHS). ECSRIRTN
 14396                                                                  ECSRIRTN
 14397     IF REIN-RISK-AMOUNT NOT GREATER THAN +0                      ECSRIRTN
 14398         GO TO CHECK-DISABS-EXIT.                                 ECSRIRTN
 14399                                                                  ECSRIRTN
 14400     IF (RW-AH-CLM-AMT (INC-SUB) + RW-AH-CLM-EXP (INC-SUB))       ECSRIRTN
 14401              GREATER THAN REIN-RISK-AMOUNT                       ECSRIRTN
 14402         COMPUTE RW-AHCLMWK = RW-AHCLMWK + REIN-RISK-AMOUNT       ECSRIRTN
 14403     ELSE                                                         ECSRIRTN
 14404         COMPUTE RW-AHCLMWK = RW-AHCLMWK                          ECSRIRTN
 14405                             + RW-AH-CLM-AMT (INC-SUB)            ECSRIRTN
 14406                             + RW-AH-CLM-EXP (INC-SUB).           ECSRIRTN
 14407                                                                  ECSRIRTN
 14408 CHECK-DISABS-EXIT.                                               ECSRIRTN
 14409      EXIT.                                                       ECSRIRTN
 14410                                                                  ECSRIRTN
 14411 REINSURE-CALC-AH-DETAIL.                                         ECSRIRTN
 14412                                                                  ECSRIRTN
 14413     IF RW-AHCLMWK = ZEROS                                        ECSRIRTN
 14414         GO TO REINSURE-CALC-CLAIM-SKIP.                          ECSRIRTN
 14415                                                                  ECSRIRTN
 14416     IF CO-SUB NOT = ZERO                                         ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 278
* ECS010T1.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 14417         IF RCT-CLM-CUTOFF-DT (CO-SUB) NOT = ZERO                 ECSRIRTN
 14418             IF CR-DIS-DT LESS RCT-CLM-CUTOFF-DT (CO-SUB)            CL*11
 14419                 GO TO REINSURE-CALC-CLAIM-SKIP.                  ECSRIRTN
 14420                                                                  ECSRIRTN
 14421     IF RWF-AH-RUNOFF-SW = 'N'                                    ECSRIRTN
 14422         IF CR-DIS-DT NOT LESS THAN RWF-EP-STOP-DATE                 CL**6
 14423             GO TO REINSURE-CALC-CLAIM-SKIP.                      ECSRIRTN
 14424                                                                  ECSRIRTN
 14425 REINSURE-CALC-AH-CONTINUED.                                      ECSRIRTN
 14426                                                                  ECSRIRTN
 14427     IF RWF-REM-AH-100 = 'Y'                                      ECSRIRTN
 14428         MOVE RW-AHCLMWK TO RWF-AHCLML                            ECSRIRTN
 14429         PERFORM REINSURE-SUB-REM-CLAIM THRU                      ECSRIRTN
 14430             REINSURE-SUB-REM-CLAIM-X                             ECSRIRTN
 14431                 VARYING SUB2 FROM +1 BY +1 UNTIL SUB2 = SUB1     ECSRIRTN
 14432         ADD RWF-AHCLML TO RWF-AHCLM                              ECSRIRTN
 14433         GO TO REINSURE-CALC-CLAIM-SKIP.                          ECSRIRTN
 14434                                                                  ECSRIRTN
 14435     IF WT-REMAINING = 'I'                                        ECSRIRTN
 14436         GO TO REINSURE-CALC-AH-RISK-CLAIM.                       ECSRIRTN
 14437                                                                  ECSRIRTN
 14438     IF WT-REMAINING = 'L'                                        ECSRIRTN
 14439         IF REIN-RT-SW = 'X'                                      ECSRIRTN
 14440             IF RW-AHCLMWK GREATER WT-AHBEN-HI                    ECSRIRTN
 14441                 MOVE WT-AHBEN-HI TO RWF-AHCLM                    ECSRIRTN
 14442             ELSE                                                 ECSRIRTN
 14443                 MOVE RW-AHCLMWK TO RWF-AHCLM                     ECSRIRTN
 14444         ELSE                                                     ECSRIRTN
 14445             IF (RW-AHCLMWK + RWF-AHCLM) GREATER WT-AHBEN-HI      ECSRIRTN
 14446                 COMPUTE RWF-AHCLML = WT-AHBEN-HI - RWF-AHCLM     ECSRIRTN
 14447                 MOVE WT-AHBEN-HI TO RWF-AHCLM                    ECSRIRTN
 14448             ELSE                                                 ECSRIRTN
 14449                 MOVE RW-AHCLMWK TO RWF-AHCLML                    ECSRIRTN
 14450                 ADD RWF-AHCLML TO RWF-AHCLM.                     ECSRIRTN
 14451                                                                  ECSRIRTN
 14452     IF WT-REMAINING = 'L'                                        ECSRIRTN
 14453         GO TO REINSURE-CALC-CLAIM-SKIP.                          ECSRIRTN
 14454                                                                  ECSRIRTN
 14455     IF CR-AHAMT NOT = ZERO                                       ECSRIRTN
 14456         COMPUTE RWF-AHCLML ROUNDED = (RW-AHCLMWK *               ECSRIRTN
 14457                            RWF-AHAMT) / CR-AHAMT                 ECSRIRTN
 14458     ELSE                                                         ECSRIRTN
 14459         IF RWF-AH-LIMIT = ZERO                                   ECSRIRTN
 14460             COMPUTE RWF-AHCLML ROUNDED =                         ECSRIRTN
 14461                       RW-AHCLMWK * WT-AH-PCT.                    ECSRIRTN
 14462                                                                  ECSRIRTN
 14463     IF CO-SUB NOT = ZERO                                         ECSRIRTN
 14464         IF RCT-AH-CLM-PCT (CO-SUB) NOT = ZERO                    ECSRIRTN
 14465             COMPUTE RWF-AHCLML ROUNDED =                         ECSRIRTN
 14466                           RW-AHCLMWK * RCT-AH-CLM-PCT (CO-SUB).  ECSRIRTN
 14467                                                                  ECSRIRTN
 14468     IF CO-SUB NOT = ZERO                                         ECSRIRTN
 14469         IF RCT-AH-CLM-MAX (CO-SUB) NOT = ZERO                    ECSRIRTN
 14470             IF REIN-RT-SW = 'X'                                  ECSRIRTN
 14471               IF RWF-AHCLML GREATER RCT-AH-CLM-MAX (CO-SUB)      ECSRIRTN
 14472                     MOVE RCT-AH-CLM-MAX (CO-SUB) TO RWF-AHCLM    ECSRIRTN
 14473                      GO TO REINSURE-CALC-CLAIM-SKIP              ECSRIRTN
 14474                  ELSE                                            ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 279
* ECS010T1.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 14475                     MOVE RWF-AHCLML TO RWF-AHCLM                 ECSRIRTN
 14476                      GO TO REINSURE-CALC-CLAIM-SKIP              ECSRIRTN
 14477              ELSE                                                ECSRIRTN
 14478                 IF (RWF-AHCLML + RWF-AHCLM) GREATER              ECSRIRTN
 14479                                           RCT-AH-CLM-MAX (CO-SUB)ECSRIRTN
 14480                     COMPUTE RWF-AHCLML =                         ECSRIRTN
 14481                               RCT-AH-CLM-MAX (CO-SUB) - RWF-AHCLMECSRIRTN
 14482                     MOVE RCT-AH-CLM-MAX (CO-SUB) TO RWF-AHCLM    ECSRIRTN
 14483                      GO TO REINSURE-CALC-CLAIM-SKIP.             ECSRIRTN
 14484                                                                  ECSRIRTN
 14485                                                                  ECSRIRTN
 14486     IF DTE-CLIENT = 'FLA'                                        ECSRIRTN
 14487        IF REIN-COMP (SUB1) = ('200000' OR '210000' OR            ECSRIRTN
 14488                               '220000' OR '230000')              ECSRIRTN
 14489           PERFORM FLA-SPEC-REIN-CLMS THRU                        ECSRIRTN
 14490               E-FLA-SPEC-REIN-CLMS.                              ECSRIRTN
 14491                                                                  ECSRIRTN
 14492     ADD RWF-AHCLML TO RWF-AHCLM.                                 ECSRIRTN
 14493                                                                  ECSRIRTN
 14494     GO TO REINSURE-CALC-CLAIM-SKIP.                              ECSRIRTN
 14495                                                                  ECSRIRTN
 14496                                                                  ECSRIRTN
 14497 REINSURE-CALC-AH-RISK-CLAIM.                                     ECSRIRTN
 14498                                                                  ECSRIRTN
 14499     IF RWF-AHAMT NOT GREATER THAN +0                             ECSRIRTN
 14500         GO TO REINSURE-CALC-CLAIM-SKIP.                          ECSRIRTN
 14501                                                                  ECSRIRTN
 14502     IF REIN-RT-SW = 'X'                                          ECSRIRTN
 14503         MOVE RW-AHCLMWK              TO RWF-AHCLM                ECSRIRTN
 14504         GO TO REINSURE-CALC-CLAIM-SKIP.                          ECSRIRTN
 14505                                                                  ECSRIRTN
 14506     COMPUTE REIN-RISK-AMOUNT = (RWF-AHAMT * CR-AH-TERM) -        ECSRIRTN
 14507                                (RS-AH-BEN * REIN-AH-CLM-MONTHS). ECSRIRTN
 14508                                                                  ECSRIRTN
 14509     IF REIN-RISK-AMOUNT NOT GREATER THAN +0                      ECSRIRTN
 14510         GO TO REINSURE-CALC-CLAIM-SKIP.                          ECSRIRTN
 14511                                                                  ECSRIRTN
 14512     IF REIN-AH-PRIOR-CLMS-PAID GREATER THAN REIN-RISK-AMOUNT     ECSRIRTN
 14513         GO TO REINSURE-CALC-CLAIM-SKIP.                          ECSRIRTN
 14514                                                                  ECSRIRTN
 14515     IF (RW-AHCLMWK + REIN-AH-PRIOR-CLMS-PAID)                    ECSRIRTN
 14516                                GREATER THAN REIN-RISK-AMOUNT     ECSRIRTN
 14517         COMPUTE RWF-AHCLML = REIN-RISK-AMOUNT                    ECSRIRTN
 14518                             - REIN-AH-PRIOR-CLMS-PAID            ECSRIRTN
 14519         MOVE REIN-RISK-AMOUNT        TO RWF-AHCLM                ECSRIRTN
 14520     ELSE                                                         ECSRIRTN
 14521         MOVE RW-AHCLMWK              TO RWF-AHCLML               ECSRIRTN
 14522         ADD RW-AHCLMWK TO RWF-AHCLM.                             ECSRIRTN
 14523                                                                  ECSRIRTN
 14524                                                                  ECSRIRTN
 14525 REINSURE-CALC-CLAIM-SKIP.                                        ECSRIRTN
 14526                                                                  ECSRIRTN
 14527     IF RWF-LFCLM NOT = ZEROS                                     ECSRIRTN
 14528         MOVE 'X' TO REIN-LF-FLG (SUB1).                          ECSRIRTN
 14529                                                                  ECSRIRTN
 14530     IF RWF-AHCLM NOT = ZEROS                                     ECSRIRTN
 14531         MOVE 'X' TO REIN-AH-FLG (SUB1).                          ECSRIRTN
 14532                                                                  ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 280
* ECS010T1.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 14533     GO TO REINSURE-CALC-CLAIM-X.                                 ECSRIRTN
 14534                                                                  ECSRIRTN
 14535 REINSURE-REMAINDER-CLAIM.                                        ECSRIRTN
 14536                                                                  ECSRIRTN
 14537     MOVE RW-LFCLMWK TO RWF-LFCLML.                               ECSRIRTN
 14538     MOVE RW-AHCLMWK TO RWF-AHCLML.                               ECSRIRTN
 14539                                                                  ECSRIRTN
 14540     PERFORM REINSURE-SUBTRACT-CLAIM THRU                         ECSRIRTN
 14541         REINSURE-SUBTRACT-CLAIM-X                                ECSRIRTN
 14542             VARYING SUB2 FROM +1 BY +1 UNTIL SUB2 = SUB1.        ECSRIRTN
 14543                                                                  ECSRIRTN
 14544     ADD RWF-LFCLML TO RWF-LFCLM.                                 ECSRIRTN
 14545     ADD RWF-AHCLML TO RWF-AHCLM.                                 ECSRIRTN
 14546                                                                  ECSRIRTN
 14547     IF RWF-LFCLM NOT = ZEROS                                     ECSRIRTN
 14548         MOVE 'X' TO REIN-LF-FLG (SUB1).                          ECSRIRTN
 14549                                                                  ECSRIRTN
 14550     IF RWF-AHCLM NOT = ZEROS                                     ECSRIRTN
 14551         MOVE 'X' TO REIN-AH-FLG (SUB1).                          ECSRIRTN
 14552                                                                  ECSRIRTN
 14553 REINSURE-CALC-CLAIM-X.                                           ECSRIRTN
 14554                                                                  ECSRIRTN
 14555     IF REIN-LF-AH-FLGS (SUB1) NOT = SPACES                       ECSRIRTN
 14556         MOVE 'X' TO REIN-BUS-FLAG.                               ECSRIRTN
 14557                                                                  ECSRIRTN
 14558     MOVE RWF-FIELDS TO REIN-WORK-FLDS (SUB1).                    ECSRIRTN
 14559                                                                  ECSRIRTN
 14560 REINSURE-SUBTRACT-CLAIM.                                         ECSRIRTN
 14561                                                                  ECSRIRTN
 14562     SUBTRACT REIN-LFCLML (SUB2) FROM RWF-LFCLML.                 ECSRIRTN
 14563     SUBTRACT REIN-AHCLML (SUB2) FROM RWF-AHCLML.                 ECSRIRTN
 14564                                                                  ECSRIRTN
 14565 REINSURE-SUBTRACT-CLAIM-X.                                       ECSRIRTN
 14566     EXIT.                                                        ECSRIRTN
 14567                                                                  ECSRIRTN
 14568 REINSURE-SUB-REM-CLAIM.                                          ECSRIRTN
 14569                                                                  ECSRIRTN
 14570     IF REIN-REM-SW (SUB2) = 'Y' OR 'Z' OR 'X' OR 'N'             ECSRIRTN
 14571         SUBTRACT REIN-AHCLML (SUB2) FROM RWF-AHCLML.             ECSRIRTN
 14572                                                                  ECSRIRTN
 14573 REINSURE-SUB-REM-CLAIM-X.                                        ECSRIRTN
 14574     EXIT.                                                        ECSRIRTN
 14575                                                                  ECSRIRTN
 14576                                                                  ECSRIRTN
 14577 CLEAR-REIN-HOLD.                                                 ECSRIRTN
 14578                                                                  ECSRIRTN
 14579     MOVE SPACES TO REIN-COMP (1).                                ECSRIRTN
 14580     MOVE SPACES TO REIN-LF-AH-FLGS (1).                          ECSRIRTN
 14581     MOVE SPACES TO REIN-REM-SW (1).                              ECSRIRTN
 14582     MOVE SPACES TO REIN-REM-AH-100 (1).                          ECSRIRTN
 14583                                                                  ECSRIRTN
 14584     MOVE +0 TO REIN-LFAMT (1)  REIN-LFPRM (1)  REIN-AHAMT (1)    ECSRIRTN
 14585         REIN-AHPRM (1)  REIN-LFRFND (1)  REIN-AHRFND (1)         ECSRIRTN
 14586         REIN-LFCLM (1)  REIN-AHCLM (1)  REIN-LFCLML (1)          ECSRIRTN
 14587         REIN-AHCLML (1)  REIN-DIS-IBNR (1)  REIN-DIS-PAYCUR (1)  ECSRIRTN
 14588         REIN-DIS-FUTRSV (1)  REIN-DTH-IBNR (1)                   ECSRIRTN
 14589         REIN-DTH-PAYCUR (1)  REIN-DTH-FUTRSV (1)                 ECSRIRTN
 14590         REIN-DIS-IBNRL (1)  REIN-DIS-PAYCURL (1)                 ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 281
* ECS010T1.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 14591         REIN-DIS-FUTRSVL (1)  REIN-DTH-IBNRL (1)                 ECSRIRTN
 14592         REIN-DTH-PAYCURL (1)  REIN-DTH-FUTRSVL (1)               ECSRIRTN
 14593         REIN-AH-LIMIT (1).                                       ECSRIRTN
 14594                                                                  ECSRIRTN
 14595     PERFORM CLEAR-REIN-HOLD-ALL VARYING SUB1 FROM 2 BY 1         ECSRIRTN
 14596         UNTIL REIN-COMP (SUB1) = SPACES.                         ECSRIRTN
 14597                                                                  ECSRIRTN
 14598     GO TO CLEAR-REIN-HOLD-X.                                     ECSRIRTN
 14599                                                                  ECSRIRTN
 14600 CLEAR-REIN-HOLD-ALL.                                             ECSRIRTN
 14601                                                                  ECSRIRTN
 14602     MOVE REIN-LEVELS (1) TO REIN-LEVELS (SUB1).                  ECSRIRTN
 14603                                                                  ECSRIRTN
 14604 CLEAR-REIN-HOLD-X.                                               ECSRIRTN
 14605     EXIT.                                                        ECSRIRTN
 14606                                                                  ECSRIRTN
 14607 FLA-SPEC-REIN-CLMS.                                              ECSRIRTN
 14608                                                                  ECSRIRTN
 14609     MOVE +250.00 TO FLA-CLM-REIN-BASE  ADJ-FLA-REIN-BASE.        ECSRIRTN
 14610                                                                  ECSRIRTN
 14611     IF REIN-COMP (SUB1) = '230000'                               ECSRIRTN
 14612         MOVE +100.00 TO FLA-CLM-REIN-BASE  ADJ-FLA-REIN-BASE.    ECSRIRTN
 14613                                                                  ECSRIRTN
 14614     IF CR-AHAMT NOT = ZERO                                       ECSRIRTN
 14615         COMPUTE ADJ-FLA-REIN-BASE ROUNDED =                      ECSRIRTN
 14616             (RW-AHCLMWK / CR-AHAMT) * FLA-CLM-REIN-BASE.         ECSRIRTN
 14617                                                                  ECSRIRTN
 14618     IF REIN-RT-SW = 'X'                                          ECSRIRTN
 14619         MOVE CR-DIS-CC TO CIRD-CC                                ECSRIRTN
 14620         MOVE CR-DIS-YR TO CIRD-YR                                ECSRIRTN
 14621         MOVE CR-DIS-MO TO CIRD-MO                                ECSRIRTN
 14622     ELSE                                                         ECSRIRTN
 14623         MOVE DTO-CC    TO CIRD-CC                                ECSRIRTN
 14624         MOVE DTO-YR    TO CIRD-YR                                ECSRIRTN
 14625         MOVE DTO-MO    TO CIRD-MO.                               ECSRIRTN
 14626                                                                  ECSRIRTN
 14627     MOVE ZEROS TO RWF-AHCLML.                                    ECSRIRTN
 14628                                                                  ECSRIRTN
 14629     IF CLM-INCUR-REIN-DATE LESS '197809'  AND                    ECSRIRTN
 14630        CR-AHAMT GREATER FLA-CLM-REIN-BASE                        ECSRIRTN
 14631         COMPUTE RWF-AHCLML = RW-AHCLMWK - ADJ-FLA-REIN-BASE.     ECSRIRTN
 14632                                                                  ECSRIRTN
 14633     IF CLM-INCUR-REIN-DATE GREATER '197806'                      ECSRIRTN
 14634         COMPUTE RWF-AHCLML = RWF-AHCLML + (RW-AHCLMWK * +.9).    ECSRIRTN
 14635                                                                  ECSRIRTN
 14636 E-FLA-SPEC-REIN-CLMS.                                            ECSRIRTN
 14637     EXIT.                                                        ECSRIRTN
 14638                                                                  ECSRIRTN
 14639 REIN-FIND-CO-LOOP.                                               ECSRIRTN
 14640                                                                  ECSRIRTN
 14641     CONTINUE.                                                    ECSRIRTN
 14642*  DUMMY PARAGRAPH - NO CODE NEEDED.                              ECSRIRTN
 14643 FIND-REI-CO-EXIT.                                                ECSRIRTN
 14644     EXIT.                                                        ECSRIRTN
 14645                                                                  ECSRIRTN
 14646 REIN-CO-TABLE-BUILD.                                             ECSRIRTN
 14647                                                                  ECSRIRTN
 14648     PERFORM ZERO-RCT-ENTRIES THRU ZERO-RCT-EXIT                  ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 282
* ECS010T1.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 14649         VARYING CO-SUB FROM 1 BY 1                               ECSRIRTN
 14650                   UNTIL CO-SUB GREATER REIN-CO-TABLE-ENT-CNT.    ECSRIRTN
 14651                                                                  ECSRIRTN
 14652     PERFORM ZERO-RC2-ENTRIES THRU ZERO-RC2-EXIT                  ECSRIRTN
 14653         VARYING CO-SUB FROM 1 BY 1                               ECSRIRTN
 14654                   UNTIL CO-SUB GREATER REIN-CO-TABLE-ENT-CNT.    ECSRIRTN
 14655                                                                  ECSRIRTN
 14656     MOVE LOW-VALUES          TO RE-CONTROL-PRIMARY.              ECSRIRTN
 14657                                                                  ECSRIRTN
 14658     START ERRTBL-IN                                              ECSRIRTN
 14659           KEY IS GREATER THAN RE-CONTROL-PRIMARY                 ECSRIRTN
 14660             INVALID KEY                                          ECSRIRTN
 14661               GO TO REIN-BUILD-EXIT.                             ECSRIRTN
 14662                                                                  ECSRIRTN
 14663     MOVE 0 TO CO-SUB.                                            ECSRIRTN
 14664     MOVE 0 TO SUB1.                                              ECSRIRTN
 14665 REIN-CO-BUILD-LOOP.                                              ECSRIRTN
 14666                                                                  ECSRIRTN
 14667     READ ERRTBL-IN  NEXT RECORD.                                 ECSRIRTN
 14668                                                                  ECSRIRTN
 14669     IF ERRTBL-FILE-STATUS = '10'                                 ECSRIRTN
 14670        GO TO REIN-BUILD-EXIT.                                    ECSRIRTN
 14671                                                                  ECSRIRTN
 14672     IF ERRTBL-FILE-STATUS NOT = ZERO                             ECSRIRTN
 14673        MOVE ERRTBL-FILE-STATUS TO WS-ABEND-FILE-STATUS           ECSRIRTN
 14674        MOVE 'READ ERROR ON FILE - ERRTBL'                        ECSRIRTN
 14675                                  TO WS-ABEND-MESSAGE             ECSRIRTN
 14676        GO TO ABEND-PGM.                                          ECSRIRTN
 14677                                                                  ECSRIRTN
 14678     IF RE-CODE NOT = 'B'                                         ECSRIRTN
 14679        GO TO REIN-CO-BUILD-LOOP.                                 ECSRIRTN
 14680                                                                  ECSRIRTN
 14681     IF RE-CLM-INCURRED-LIM NOT NUMERIC                           ECSRIRTN
 14682        MOVE ZERO TO RE-CLM-INCURRED-LIM.                         ECSRIRTN
 14683                                                                  ECSRIRTN
 14684     IF RE-EARNING-START-DT NOT NUMERIC                           ECSRIRTN
 14685        MOVE ZERO TO RE-EARNING-START-DT.                         ECSRIRTN
 14686                                                                  ECSRIRTN
 14687     IF RE-EARNING-STOP-DT NOT NUMERIC                            ECSRIRTN
 14688        MOVE ZERO TO RE-EARNING-STOP-DT.                          ECSRIRTN
 14689                                                                  ECSRIRTN
 14690     PERFORM VARYING CPSE-NDX FROM 1 BY 1 UNTIL CPSE-NDX > 1500   ECSRIRTN
 14691        MOVE RCT-CLM-CUTOFF-DT (CPSE-NDX)                         ECSRIRTN
*1118-E***************************************                         ( 175)**
**    Index-name belongs to different table - unexpected behaviour may occur
 14692                        TO  WS-RCT-CLM-CUTOFF-DT-N (CPSE-NDX)        CL*12
 14693        MOVE RCT-EARNING-START-DT (CPSE-NDX)                      ECSRIRTN
*1118-E******************************************                      ( 282)**
**    Index-name belongs to different table - unexpected behaviour may occur
 14694                        TO  WS-RCT-EARNING-START-DT-N (CPSE-NDX)     CL*12
 14695        MOVE RCT-EARNING-STOP-DT (CPSE-NDX)                       ECSRIRTN
*1118-E*****************************************                       ( 282)**
**    Index-name belongs to different table - unexpected behaviour may occur
 14696                        TO  WS-RCT-EARNING-STOP-DT-N (CPSE-NDX)      CL*12
 14697     END-PERFORM.                                                 ECSRIRTN
 14698     MOVE RWF-EP-STOP-DATE       TO  WS-RWF-EP-STOP-DATE-N.          CL*12
 14699                                                                  ECSRIRTN
 14700     IF RE-LF-CLM-PCT NOT NUMERIC                                 ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 283
* ECS010T1.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 14701        MOVE ZERO TO RE-LF-CLM-PCT.                               ECSRIRTN
 14702                                                                  ECSRIRTN
 14703     IF RE-AH-CLM-PCT NOT NUMERIC                                 ECSRIRTN
 14704        MOVE ZERO TO RE-AH-CLM-PCT.                               ECSRIRTN
 14705                                                                  ECSRIRTN
 14706     IF RE-LF-CLM-MAX NOT NUMERIC                                 ECSRIRTN
 14707        MOVE ZERO TO RE-LF-CLM-MAX.                               ECSRIRTN
 14708                                                                  ECSRIRTN
 14709     IF RE-AH-CLM-MAX NOT NUMERIC                                 ECSRIRTN
 14710        MOVE ZERO TO RE-AH-CLM-MAX.                               ECSRIRTN
 14711                                                                  ECSRIRTN
 14712     IF (RE-AH-CLM-MAX = ZERO) AND                                ECSRIRTN
 14713        (RE-LF-CLM-MAX = ZERO) AND                                ECSRIRTN
 14714        (RE-AH-CLM-PCT = ZERO) AND                                ECSRIRTN
 14715        (RE-LF-CLM-PCT = ZERO) AND                                ECSRIRTN
 14716        (RE-CLM-INCURRED-LIM = ZERO) AND                          ECSRIRTN
 14717        (RE-EARNING-START-DT = ZERO) AND                          ECSRIRTN
 14718        (RE-EARNING-STOP-DT = ZERO)                               ECSRIRTN
 14719          GO TO REIN-CO-BUILD-EPR.                                ECSRIRTN
 14720                                                                  ECSRIRTN
 14721     ADD +1 TO CO-SUB.                                            ECSRIRTN
 14722                                                                  ECSRIRTN
 14723     IF CO-SUB GREATER REIN-CO-TABLE-ENT-CNT                      ECSRIRTN
 14724        MOVE 0202 TO WS-RETURN-CODE                               ECSRIRTN
 14725        DISPLAY 'REINSURANCE COMPANY SAVE TABLE EXCEEDED'         ECSRIRTN
 14726        DISPLAY 'ERROR DETECTED IN ECSRIRTN, SEE ECSRITAB'        ECSRIRTN
 14727        MOVE 'REINSURANCE COMPANY SAVE TABLE EXCEEDED'            ECSRIRTN
 14728                                  TO WS-ABEND-MESSAGE             ECSRIRTN
 14729        GO TO ABEND-PGM.                                          ECSRIRTN
 14730                                                                  ECSRIRTN
 14731     MOVE RE-COMPANY           TO RCT-REIN-CO (CO-SUB).              CL**7
 14732                                                                  ECSRIRTN
 14733     MOVE RE-CLM-INCURRED-LIM  TO RCT-CLM-CUTOFF-DT (CO-SUB)      ECSRIRTN
 14734                               WS-RCT-CLM-CUTOFF-DT-N (CO-SUB).      CL*12
 14735     MOVE RE-EARNING-START-DT  TO RCT-EARNING-START-DT (CO-SUB)   ECSRIRTN
 14736                               WS-RCT-EARNING-START-DT-N (CO-SUB).   CL*12
 14737     MOVE RE-EARNING-STOP-DT   TO RCT-EARNING-STOP-DT (CO-SUB)    ECSRIRTN
 14738                               WS-RCT-EARNING-STOP-DT-N (CO-SUB).    CL*12
 14739                                                                  ECSRIRTN
 14740     IF RE-EARN-STOP-CODE = 'A'  OR  'L'                          ECSRIRTN
 14741         MOVE RE-EARN-STOP-CODE  TO RCT-EARN-STOP-CODE (CO-SUB)   ECSRIRTN
 14742     ELSE                                                         ECSRIRTN
 14743         MOVE 'B'                TO RCT-EARN-STOP-CODE (CO-SUB).  ECSRIRTN
 14744                                                                  ECSRIRTN
 14745     MOVE RE-LF-CLM-PCT  TO RCT-LF-CLM-PCT (CO-SUB).              ECSRIRTN
 14746     MOVE RE-AH-CLM-PCT  TO RCT-AH-CLM-PCT (CO-SUB).              ECSRIRTN
 14747     MOVE RE-LF-CLM-MAX  TO RCT-LF-CLM-MAX (CO-SUB).              ECSRIRTN
 14748     MOVE RE-AH-CLM-MAX  TO RCT-AH-CLM-MAX (CO-SUB).              ECSRIRTN
 14749                                                                  ECSRIRTN
 14750 REIN-CO-BUILD-EPR.                                               ECSRIRTN
 14751                                                                  ECSRIRTN
 14752     IF RE-AH-PR-PCT  NOT NUMERIC                                 ECSRIRTN
 14753        MOVE ZERO TO RE-AH-PR-PCT.                                ECSRIRTN
 14754                                                                  ECSRIRTN
 14755     IF RE-AH-78-PCT  NOT NUMERIC                                 ECSRIRTN
 14756        MOVE ZERO TO RE-AH-78-PCT.                                ECSRIRTN
 14757                                                                  ECSRIRTN
 14758     IF RE-LF-PR-PCT  NOT NUMERIC                                 ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 284
* ECS010T1.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 14759        MOVE ZERO TO RE-LF-PR-PCT.                                ECSRIRTN
 14760                                                                  ECSRIRTN
 14761     IF RE-LF-78-PCT  NOT NUMERIC                                 ECSRIRTN
 14762        MOVE ZERO TO RE-LF-78-PCT.                                ECSRIRTN
 14763                                                                  ECSRIRTN
 14764     ADD +1 TO SUB1.                                              ECSRIRTN
 14765                                                                  ECSRIRTN
 14766     IF SUB1 GREATER REIN-CO-TABLE-ENT-CNT                        ECSRIRTN
 14767        MOVE 0201 TO WS-RETURN-CODE                               ECSRIRTN
 14768        MOVE 'REINSURANCE COMPANY SAVE TABLE EXCEEDED'            ECSRIRTN
 14769                                  TO WS-ABEND-MESSAGE             ECSRIRTN
 14770        GO TO ABEND-PGM.                                          ECSRIRTN
 14771                                                                  ECSRIRTN
 14772     MOVE RE-COMPANY     TO RC2-REIN-CO    (SUB1).                ECSRIRTN
 14773     MOVE RE-AH-PR-PCT   TO RC2-AH-PRO-PCT (SUB1).                ECSRIRTN
 14774     MOVE RE-AH-78-PCT   TO RC2-AH-R78-PCT (SUB1).                ECSRIRTN
 14775     MOVE RE-LF-PR-PCT   TO RC2-LF-PRO-PCT (SUB1).                ECSRIRTN
 14776     MOVE RE-LF-78-PCT   TO RC2-LF-R78-PCT (SUB1).                ECSRIRTN
 14777     MOVE RE-NAME        TO RC2-CO-NAME    (SUB1).                ECSRIRTN
 14778     if re-state-exhibit-opt-f = 'Y'
 14779        move 'Y'         to rc2-ecs152-rpt (sub1)
 14780     else
 14781        move 'N'         to rc2-ecs152-rpt (sub1)
 14782     end-if
 14783                                                                  ECSRIRTN
 14784     GO TO REIN-CO-BUILD-LOOP.                                    ECSRIRTN
 14785                                                                  ECSRIRTN
 14786 REIN-BUILD-EXIT.                                                 ECSRIRTN
 14787     EXIT.                                                        ECSRIRTN
 14788                                                                  ECSRIRTN
 14789 ZERO-RCT-ENTRIES.                                                ECSRIRTN
 14790                                                                  ECSRIRTN
 14791     MOVE SPACES TO REIN-CO-HOLD-ENTRIES (CO-SUB).                ECSRIRTN
 14792                                                                  ECSRIRTN
 14793     MOVE ZERO   TO RCT-CLM-CUTOFF-DT (CO-SUB)                    ECSRIRTN
 14794                    WS-RCT-CLM-CUTOFF-DT-N (CO-SUB)                  CL*12
 14795                    RCT-EARNING-START-DT (CO-SUB)                 ECSRIRTN
 14796                    WS-RCT-EARNING-START-DT-N (CO-SUB)               CL*12
 14797                    RCT-EARNING-STOP-DT (CO-SUB)                  ECSRIRTN
 14798                    WS-RCT-EARNING-STOP-DT-N (CO-SUB)                CL*12
 14799                    RCT-LF-CLM-PCT    (CO-SUB)                    ECSRIRTN
 14800                    RCT-AH-CLM-PCT    (CO-SUB)                    ECSRIRTN
 14801                    RCT-LF-CLM-MAX    (CO-SUB)                    ECSRIRTN
 14802                    RCT-AH-CLM-MAX    (CO-SUB).                   ECSRIRTN
 14803                                                                  ECSRIRTN
 14804 ZERO-RCT-EXIT.                                                   ECSRIRTN
 14805     EXIT.                                                        ECSRIRTN
 14806                                                                  ECSRIRTN
 14807 ZERO-RC2-ENTRIES.                                                ECSRIRTN
 14808                                                                  ECSRIRTN
 14809     MOVE SPACES TO RC2-CO-NAME (CO-SUB)                          ECSRIRTN
 14810                    RC2-REIN-CO (CO-SUB).                         ECSRIRTN
 14811     move spaces      to rc2-ecs152-rpt (co-sub)
 14812                                                                  ECSRIRTN
 14813     MOVE ZERO   TO RC2-LF-R78-PCT    (CO-SUB)                    ECSRIRTN
 14814                    RC2-LF-PRO-PCT    (CO-SUB)                    ECSRIRTN
 14815                    RC2-AH-R78-PCT    (CO-SUB)                    ECSRIRTN
 14816                    RC2-AH-PRO-PCT    (CO-SUB).                   ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 285
* ECS010T1.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 14817                                                                  ECSRIRTN
 14818 ZERO-RC2-EXIT.                                                   ECSRIRTN
 14819     EXIT.                                                        ECSRIRTN
 14820******************************************************************ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 286
* ECS010T1.cbl
 14822******************************************************************
 14823***   R E C A L C U L A T I O N   O F   R E I N S U R A N C E  ***
 14824******************************************************************
 14825
 14826 3600-RC-REINSURANCE.
 14827
 14828     IF DTE-PGM-OPT NOT = '1'
 14829         GO TO 3799-RC-REINSURANCE-X.
 14830
 14831     IF DTE-CLIENT = 'WSL'
 14832         IF CR-REIN-TABLE = '00A'
 14833             GO TO 3799-RC-REINSURANCE-X.
 14834
 14835     IF CR-REIN-TABLE = SPACES OR ZEROS
 14836         PERFORM CLEAR-REIN-HOLD THRU CLEAR-REIN-HOLD-X.
 14837
 14838 3610-CLEAR-RC-REIN.
 14839
 14840     MOVE SPACES TO RC-REIN-LEVELS (1).
 14841     MOVE ZEROS  TO RC-REIN-LFAMT (1)
 14842                    RC-REIN-LFPRM (1)
 14843                    RC-REIN-AHAMT (1)
 14844                    RC-REIN-AHPRM (1)
 14845                    RC-REIN-LFRFND (1)
 14846                    RC-REIN-AHRFND (1)
 14847                    RC-REIN-LFCLM (1)
 14848                    RC-REIN-AHCLM (1).
 14849
 14850     PERFORM 3620-CLEAR-RC-LEVELS VARYING SUB1 FROM +2 BY +1
 14851         UNTIL RC-REIN-COMP (SUB1) = SPACES.
 14852
 14853     MOVE +1 TO SUB1.
 14854     MOVE +0 TO SUB2.
 14855
 14856     GO TO 3630-RC-REIN-LOOP-1.
 14857
 14858 3620-CLEAR-RC-LEVELS.
 14859
 14860     MOVE RC-REIN-LEVELS (1) TO RC-REIN-LEVELS (SUB1).
 14861
 14862
 14863 3630-RC-REIN-LOOP-1.
 14864
 14865     IF REIN-LF-AH-FLGS (SUB1) NOT = SPACES
 14866         ADD +1 TO SUB2
 14867         MOVE REIN-COMP (SUB1)   TO RC-REIN-COMP (SUB2)
 14868         MOVE REIN-LFAMT (SUB1)  TO RC-REIN-LFAMT (SUB2)
 14869         MOVE REIN-LFPRM (SUB1)  TO RC-REIN-LFPRM (SUB2)
 14870         MOVE REIN-AHAMT (SUB1)  TO RC-REIN-AHAMT (SUB2)
 14871         MOVE REIN-AHPRM (SUB1)  TO RC-REIN-AHPRM (SUB2)
 14872         MOVE REIN-LFRFND (SUB1) TO RC-REIN-LFRFND (SUB2)
 14873         MOVE REIN-AHRFND (SUB1) TO RC-REIN-AHRFND (SUB2)
 14874         MOVE REIN-LFCLM (SUB1)  TO RC-REIN-LFCLM (SUB2)
 14875         MOVE REIN-AHCLM (SUB1)  TO RC-REIN-AHCLM (SUB2)
 14876         MOVE REIN-REM-SW (SUB1) TO RC-REIN-REM-SW (SUB2).
 14877
 14878     ADD +1 TO SUB1.
 14879     IF REIN-COMP (SUB1) NOT = SPACES
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 287
* ECS010T1.cbl
 14880         GO TO 3630-RC-REIN-LOOP-1.
 14881
 14882     PERFORM CLEAR-REIN-HOLD THRU CLEAR-REIN-HOLD-X.
 14883
 14884     MOVE AM-REI-TABLE TO CR-REIN-TABLE.
 14885     IF CR-REIN-TABLE = SPACES OR ZEROS
 14886         MOVE +1                     TO SUB1
 14887         GO TO 3710-RC-REIN-LOOP-2.
 14888
 14889     PERFORM 3010-RR-READ-REIN THRU 3019-RR-READ-REIN-X.
 14890
 14891 3640-NSP-REIN-RATING-ROUTINE.
 14892
 14893     MOVE CR-DT                      TO DC-GREG-DATE-CYMD.
 14894     MOVE 'L'                        TO DC-OPTION-CODE.
 14895     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 14896     MOVE DC-BIN-DATE-1              TO CP-CERT-EFF-DT.
 14897     MOVE SPACES                     TO CP-ACCT-FLD-5.
 14898     MOVE DTE-CLIENT                 TO CP-COMPANY-ID.
 14899     MOVE CR-AGE                     TO CP-ISSUE-AGE.
 14900     MOVE CR-APR                     TO CP-LOAN-APR.
 14901     MOVE CR-PMT-FREQ                TO CP-PAY-FREQUENCY.
 14902     MOVE CR-LOAN-TERM               TO CP-LOAN-TERM.
 14903     MOVE ZEROS                      TO CP-DEVIATION-CODE.
 14904     MOVE ZEROS                      TO CP-CLASS-CODE.
 14905
 14906     IF DTE-CLIENT = 'TIC'
 14907        IF CR-REIN-TABLE = '01T' OR '02T' OR '03T'
 14908            MOVE ZERO                TO CP-CLASS-CODE
 14909        ELSE
 14910            MOVE CR-RATING-CLASS     TO CP-CLASS-CODE.
 14911
 14912     MOVE '3'                        TO CP-PROCESS-TYPE.
 14913     MOVE DTE-CLASIC-COMPANY-CD      TO CP-COMPANY-CD.
 14914     MOVE CR-PMT-EXTENSION-DAYS      TO CP-TERM-OR-EXT-DAYS.
 14915
 14916 3650-NSP-REIN-LIFE.
 14917
 14918     IF CR-LFTYP = ZERO
 14919         GO TO 3660-NSP-REIN-AH.
 14920     IF (RE-NSP-ST-CD-LF = ZEROS OR SPACES)
 14921        OR (DTE-CLIENT = 'DCC')
 14922         GO TO 3660-NSP-REIN-AH.
 14923     IF DTE-CLIENT NOT = 'LBL'
 14924         IF (CLAS-I-BAL (CLAS-INDEXL) = 'B')
 14925             GO TO 3660-NSP-REIN-AH.
 14926
 14927     IF RE-NSP-ST-CD-LF NOT = STATE-L
 14928         MOVE RE-NSP-ST-CD-LF        TO STATE-L
 14929         PERFORM 8200-STATE-CODE-LOOKUP THRU 8299-STATE-LOOKUP-X.
 14930
 14931     MOVE CLAS-I-RL-AH (CLAS-INDEXL) TO CP-BENEFIT-TYPE.
 14932     MOVE CR-LF-TERM                 TO CP-ORIGINAL-TERM.
 14933     MOVE CR-LFAMT                   TO CP-ORIGINAL-BENEFIT
 14934                                        CP-RATING-BENEFIT-AMT.
 14935     MOVE CLAS-I-EP (CLAS-INDEXL)    TO CP-EARNING-METHOD.
 14936     MOVE CLAS-I-BAL (CLAS-INDEXL)   TO CP-SPECIAL-CALC-CD.
 14937     MOVE CR-LFTYP                   TO CP-BENEFIT-CD.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 288
* ECS010T1.cbl
 14938     MOVE LIFE-OVERRIDE-L1           TO CP-LIFE-OVERRIDE-CODE.
 14939     MOVE AM-LF-DEVIATION-PCT        TO CP-RATE-DEV-PCT.
 14940     MOVE RE-NSP-ST-CD-LF            TO CP-STATE.
 14941     MOVE STATE-ABBR (CLAS-INDEXS)   TO CP-STATE-STD-ABBRV.
 14942
 14943     IF CP-STATE-STD-ABBRV = 'OR'
 14944         COMPUTE CP-RATING-BENEFIT-AMT = CR-LFAMT + CR-LFAMT-ALT.
 14945
 14946     PERFORM 8100-GET-RATE THRU 8199-GET-RATE-X.
 14947
 14948     IF CP-ERROR-RATE-NOT-FOUND  OR
 14949        CP-ERROR-RATE-IS-ZERO
 14950         MOVE 'LIFE NET SINGLE PREMIUM RATE NOT FOUND'
 14951                                     TO WS-ABEND-MESSAGE
 14952         MOVE 0302                   TO WS-ABEND-CODE
 14953         DISPLAY '******************************'
 14954         DISPLAY '***** ERROR LOCATION 018 *****'
 14955         DISPLAY '******************************'
 14956         MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
 14957         GO TO ABEND-PGM.
 14958
 14959     MOVE CP-CALC-PREMIUM          TO CR-LF-NSP-PRM.
 14960
 14961*    COMPUTE CR-LF-NSP-PRM ROUNDED =
 14962*                      (CR-LFAMT / 100) * CP-PREMIUM-RATE.
 14963
 14964     COMPUTE CR-LF-NSP-PRM ROUNDED =  CR-LF-NSP-PRM +
 14965                   ((CR-LFAMT-ALT / 100) * CP-PREMIUM-RATE).
 14966
 14967     MOVE CP-PREMIUM-RATE            TO CR-LF-NSP-PRM-RATE.
 14968
 14969 3660-NSP-REIN-AH.
 14970
 14971     IF CR-AHTYP = ZERO
 14972         GO TO 3669-NSP-REIN-X.
 14973     IF (RE-NSP-ST-CD-AH = ZEROS OR SPACES)
 14974        OR (DTE-CLIENT = 'DCC')
 14975         GO TO 3669-NSP-REIN-X.
 14976     IF DTE-CLIENT NOT = 'LBL'
 14977         IF (CLAS-I-BAL (CLAS-INDEXA) = 'B')
 14978             GO TO 3669-NSP-REIN-X.
 14979
 14980     IF RE-NSP-ST-CD-AH NOT = STATE-L
 14981         MOVE RE-NSP-ST-CD-AH        TO STATE-L
 14982         PERFORM 8200-STATE-CODE-LOOKUP THRU 8299-STATE-LOOKUP-X.
 14983
 14984     MOVE CLAS-I-RL-AH (CLAS-INDEXA) TO CP-BENEFIT-TYPE.
 14985     MOVE CR-AH-TERM                 TO CP-ORIGINAL-TERM.
 14986     MOVE CR-AHAMT                   TO CP-ORIGINAL-BENEFIT
 14987                                        CP-RATING-BENEFIT-AMT.
 14988     MOVE CLAS-I-EP (CLAS-INDEXA)    TO CP-EARNING-METHOD.
 14989     MOVE CLAS-I-BAL (CLAS-INDEXA)   TO CP-SPECIAL-CALC-CD.
 14990     MOVE CR-AHTYP                   TO CP-BENEFIT-CD.
 14991     MOVE AH-OVERRIDE-L1             TO CP-AH-OVERRIDE-CODE.
 14992     MOVE AM-AH-DEVIATION-PCT        TO CP-RATE-DEV-PCT.
 14993     MOVE RE-NSP-ST-CD-AH            TO CP-STATE.
 14994     MOVE STATE-ABBR (CLAS-INDEXS)   TO CP-STATE-STD-ABBRV.
 14995
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 289
* ECS010T1.cbl
 14996     IF CP-STATE-STD-ABBRV = 'OR'
 14997         COMPUTE CP-RATING-BENEFIT-AMT = CR-AHAMT * CR-AH-TERM.
 14998
 14999     PERFORM 8100-GET-RATE THRU 8199-GET-RATE-X.
 15000
 15001     IF CP-ERROR-RATE-NOT-FOUND  OR
 15002        CP-ERROR-RATE-IS-ZERO
 15003         MOVE 'A&H NET SINGLE PREMIUM RATE NOT FOUND'
 15004                                     TO WS-ABEND-MESSAGE
 15005         MOVE 0302                   TO WS-ABEND-CODE
 15006         DISPLAY '******************************'
 15007         DISPLAY '***** ERROR LOCATION 019 *****'
 15008         DISPLAY '******************************'
 15009         MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
 15010         GO TO ABEND-PGM.
 15011
 15012     COMPUTE CR-AH-NSP-PRM ROUNDED =
 15013             ((CR-AHAMT * CR-AH-TERM) / 100) * CP-PREMIUM-RATE.
 15014
 15015     MOVE CP-PREMIUM-RATE            TO CR-AH-NSP-PRM-RATE.
 15016
 15017 3669-NSP-REIN-X.
 15018     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 290
* ECS010T1.cbl
 15020******************************************************************
 15021***        R E C A L C U L A T E   R E I N S U R A N C E       ***
 15022******************************************************************
 15023
 15024 3700-RC-REIN-PERF-CALC.
 15025
*15026                             COPY ECSRTPFM.
 15027******************************************************************07/10/97
 15028*                                                                *ECSRTPFM
 15029*                            ECSRTPFM                            *   LV001
 15030*                            VMOD=2.002                          *ECSRTPFM
 15031*                                                                *ECSRTPFM
 15032******************************************************************ECSRTPFM
 15033                                                                  ECSRTPFM
 15034     IF    CR-LFAMT  NUMERIC                                      00000072
 15035           NEXT SENTENCE                                          00000073
 15036        ELSE                                                      00000074
 15037           MOVE ZEROS TO CR-LFAMT.                                00000075
 15038                                                                  00000076
 15039     IF    CR-LFAMT-ALT  NUMERIC                                  00000077
 15040           NEXT SENTENCE                                          00000078
 15041        ELSE                                                      00000079
 15042           MOVE ZEROS TO CR-LFAMT-ALT.                            00000080
 15043                                                                  00000081
 15044                                                                  00000082
 15045     IF    CR-LFPRM  NUMERIC                                      00000083
 15046           NEXT SENTENCE                                          00000084
 15047        ELSE                                                      00000085
 15048           MOVE ZEROS TO CR-LFPRM.                                00000086
 15049                                                                  00000087
 15050     IF    CR-LFPRM-ALT  NUMERIC                                  00000088
 15051           NEXT SENTENCE                                          00000089
 15052        ELSE                                                      00000090
 15053           MOVE ZEROS TO CR-LFPRM-ALT.                            00000091
 15054                                                                  00000092
 15055                                                                  00000093
 15056     IF    CR-LFPRM-CALC  NUMERIC                                 00000094
 15057           NEXT SENTENCE                                          00000095
 15058        ELSE                                                      00000096
 15059           MOVE ZEROS TO CR-LFPRM-CALC.                           00000097
 15060                                                                  00000098
 15061     IF    CR-LFPRM-CALC-ALT  NUMERIC                             00000099
 15062           NEXT SENTENCE                                          00000100
 15063        ELSE                                                      00000101
 15064           MOVE ZEROS TO CR-LFPRM-CALC-ALT.                       00000102
 15065                                                                  00000103
 15066     IF    CR-LF-NSP-PRM  NUMERIC                                 00000104
 15067           NEXT SENTENCE                                          00000105
 15068        ELSE                                                      00000106
 15069           MOVE ZEROS TO CR-LF-NSP-PRM.                           00000107
 15070                                                                  00000108
 15071     COMPUTE RS-R-LB = CR-LFAMT + CR-LFAMT-ALT.                   ECSRTPFM
 15072     COMPUTE RS-R-LP = CR-LFPRM + CR-LFPRM-ALT.                   ECSRTPFM
 15073     IF RE-NSP-ST-CD-LF = ZEROS  OR  SPACES                       ECSRTPFM
 15074         COMPUTE RS-R-LPC = CR-LFPRM-CALC + CR-LFPRM-CALC-ALT     ECSRTPFM
 15075     ELSE                                                         ECSRTPFM
 15076         MOVE CR-LF-NSP-PRM         TO RS-R-LPC.                  ECSRTPFM
 15077     MOVE RS-R-LPC                  TO REIN-CALCED-LIFE.          ECSRTPFM
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 291
* ECS010T1.cbl (/apps/prod/cid1p/copy/ECSRTPFM)
 15078                                                                  ECSRTPFM
 15079     MOVE CR-AHAMT                  TO RS-R-AB.                   ECSRTPFM
 15080     MOVE CR-AHPRM                  TO RS-R-AP.                   ECSRTPFM
 15081     IF RE-NSP-ST-CD-AH = ZEROS  OR  SPACES                       ECSRTPFM
 15082         MOVE CR-AHPRM-CALC         TO RS-R-APC                   ECSRTPFM
 15083     ELSE                                                         ECSRTPFM
 15084         MOVE CR-AH-NSP-PRM         TO RS-R-APC.                  ECSRTPFM
 15085     MOVE RS-R-APC                  TO REIN-CALCED-AH.            ECSRTPFM
 15086                                                                  ECSRTPFM
 15087     PERFORM REINSURE-CALC THRU REINSURE-CALC-X                   ECSRTPFM
 15088         VARYING SUB1 FROM +1 BY +1                               ECSRTPFM
 15089             UNTIL RE-REI-COMP-NO (SUB1) = SPACES.                ECSRTPFM
 15090                                                                  ECSRTPFM
 15091
 15092     IF CR-STATE NOT = STATE-L
 15093         MOVE CR-STATE               TO STATE-L
 15094         PERFORM 8200-STATE-CODE-LOOKUP THRU 8299-STATE-LOOKUP-X.
 15095
 15096     MOVE 'X'                     TO REIN-RT-SW.
 15097     PERFORM 3200-REINSURE-CANCEL THRU 3299-REINSURE-CANCEL-X.
 15098     PERFORM 3300-REINSURE-CLAIM THRU 3399-REINSURE-CLAIM-X.
 15099     MOVE ' '                     TO REIN-RT-SW.
 15100
 15101 3710-RC-REIN-LOOP-2.
 15102
 15103     IF REIN-COMP (SUB1) = SPACES
 15104         GO TO 3730-RC-REIN-EXTRACTS.
 15105
 15106     IF REIN-LF-AH-FLGS (SUB1) = SPACES
 15107        ADD +1 TO SUB1
 15108         GO TO 3710-RC-REIN-LOOP-2.
 15109
 15110     MOVE +1 TO SUB2.
 15111
 15112 3720-RC-REIN-LOOP-3.
 15113
 15114     IF RC-REIN-COMP (SUB2) = SPACES
 15115         ADD +1 TO SUB1
 15116         GO TO 3710-RC-REIN-LOOP-2.
 15117
 15118     IF REIN-COMP (SUB1) NOT = RC-REIN-COMP (SUB2)
 15119         ADD +1 TO SUB2
 15120         GO TO 3720-RC-REIN-LOOP-3.
 15121
 15122     IF REIN-LFAMT (SUB1) = RC-REIN-LFAMT (SUB2)
 15123        AND REIN-LFPRM (SUB1) = RC-REIN-LFPRM (SUB2)
 15124        AND REIN-AHAMT (SUB1) = RC-REIN-AHAMT (SUB2)
 15125        AND REIN-AHPRM (SUB1) = RC-REIN-AHPRM (SUB2)
 15126         MOVE 'X' TO RC-OLD-ISS (SUB2)
 15127         MOVE 'X' TO RC-NEW-ISS (SUB1).
 15128
 15129     IF REIN-LFRFND (SUB1) = RC-REIN-LFRFND (SUB2)
 15130        AND REIN-AHRFND (SUB1) = RC-REIN-AHRFND (SUB2)
 15131         MOVE 'X' TO RC-OLD-CNC (SUB2)
 15132         MOVE 'X' TO RC-NEW-CNC (SUB1).
 15133
 15134     IF REIN-LFCLM (SUB1) = RC-REIN-LFCLM (SUB2)
 15135         MOVE 'X' TO RC-OLD-LF-CLM (SUB2)
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 292
* ECS010T1.cbl
 15136         MOVE 'X' TO RC-NEW-LF-CLM (SUB1).
 15137
 15138     IF REIN-AHCLM (SUB1) = RC-REIN-AHCLM (SUB2)
 15139         MOVE 'X' TO RC-OLD-AH-CLM (SUB2)
 15140         MOVE 'X' TO RC-NEW-AH-CLM (SUB1).
 15141
 15142     ADD +1 TO SUB2.
 15143     GO TO 3720-RC-REIN-LOOP-3.
 15144
 15145 3730-RC-REIN-EXTRACTS.
 15146
 15147     PERFORM 2000-INITIALIZE-DETAIL-EXTRACT THRU 2099-INIT-DTL-X.
 15148     MOVE 'R' TO DE-REIN.
 15149     MOVE 'J' TO DE-TRANS.
 15150*****PERFORM EXTRACT-DATE-RELOAD.
 15151     MOVE DETAIL-EXTRACT TO SAVE-EXTRACT.
 15152     MOVE +1 TO SUB1.
 15153
 15154 3740-RC-REIN-OLD-ISSUE.
 15155
 15156     IF RC-REIN-COMP (SUB1) = SPACES
 15157         MOVE +1 TO SUB1
 15158         GO TO 3745-RC-REIN-NEW-ISSUE.
 15159
 15160     IF RC-REIN-REM-SW (SUB1) = 'Z'
 15161         ADD +1 TO SUB1
 15162         GO TO 3740-RC-REIN-OLD-ISSUE.
 15163
 15164     IF RC-OLD-ISS (SUB1) = 'X'
 15165         ADD +1 TO SUB1
 15166         GO TO 3740-RC-REIN-OLD-ISSUE.
 15167
 15168     IF RC-REIN-LFAMT (SUB1) = ZERO
 15169        AND RC-REIN-LFPRM (SUB1) = ZERO
 15170        AND RC-REIN-AHAMT (SUB1) = ZERO
 15171        AND RC-REIN-AHPRM (SUB1) = ZERO
 15172         ADD +1 TO SUB1
 15173         GO TO 3740-RC-REIN-OLD-ISSUE.
 15174
 15175     MOVE SAVE-EXTRACT TO DETAIL-EXTRACT.
 15176     PERFORM EXTRACT-DATE-LOAD.
 15177     MOVE RC-REIN-COMP (SUB1) TO DE-REI-COMP.
 15178     MULTIPLY RC-REIN-LFAMT (SUB1) BY -1 GIVING DE-REI-LFAMT.
 15179     MULTIPLY RC-REIN-LFPRM (SUB1) BY -1 GIVING DE-REI-LFPRM.
 15180     MULTIPLY RC-REIN-AHAMT (SUB1) BY -1 GIVING DE-REI-AHAMT.
 15181     MULTIPLY RC-REIN-AHPRM (SUB1) BY -1 GIVING DE-REI-AHPRM.
 15182     PERFORM 2500-WRITE-DETAIL-EXTRACTS THRU 2599-WRT-DETAIL-X.
 15183
 15184     ADD +1 TO BC-R-ISS.
 15185     ADD +1 TO SUB1.
 15186     GO TO 3740-RC-REIN-OLD-ISSUE.
 15187
 15188 3745-RC-REIN-NEW-ISSUE.
 15189
 15190     IF REIN-COMP (SUB1) = SPACES
 15191         PERFORM 2200-BUILD-CANCEL-EXTRACT THRU
 15192                                         2259-END-CANCEL-BUILD
 15193         MOVE 'R'      TO DE-REIN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 293
* ECS010T1.cbl
 15194         MOVE 'K'      TO DE-TRANS
 15195*********PERFORM EXTRACT-DATE-RELOAD
 15196         MOVE DETAIL-EXTRACT TO SAVE-EXTRACT
 15197         MOVE +1       TO SUB1
 15198         GO TO 3750-RC-REIN-OLD-CANCEL.
 15199
 15200     IF REIN-REM-SW (SUB1) = 'Z'
 15201         ADD +1 TO SUB1
 15202         GO TO 3745-RC-REIN-NEW-ISSUE.
 15203
 15204     IF RC-NEW-ISS (SUB1) = 'X'
 15205         ADD +1 TO SUB1
 15206         GO TO 3745-RC-REIN-NEW-ISSUE.
 15207
 15208     IF REIN-LFAMT (SUB1) = ZERO
 15209        AND REIN-LFPRM (SUB1) = ZERO
 15210        AND REIN-AHAMT (SUB1) = ZERO
 15211        AND REIN-AHPRM (SUB1) = ZERO
 15212         ADD +1 TO SUB1
 15213         GO TO 3745-RC-REIN-NEW-ISSUE.
 15214
 15215     MOVE SAVE-EXTRACT      TO DETAIL-EXTRACT.
 15216     PERFORM EXTRACT-DATE-LOAD.
 15217     MOVE REIN-COMP (SUB1)  TO DE-REI-COMP.
 15218     MOVE REIN-LFAMT (SUB1) TO DE-REI-LFAMT.
 15219     MOVE REIN-LFPRM (SUB1) TO DE-REI-LFPRM.
 15220     MOVE REIN-AHAMT (SUB1) TO DE-REI-AHAMT.
 15221     MOVE REIN-AHPRM (SUB1) TO DE-REI-AHPRM.
 15222     PERFORM 2500-WRITE-DETAIL-EXTRACTS THRU 2599-WRT-DETAIL-X.
 15223
 15224     ADD +1 TO BC-R-ISS.
 15225     ADD +1 TO SUB1.
 15226     GO TO 3745-RC-REIN-NEW-ISSUE.
 15227
 15228 3750-RC-REIN-OLD-CANCEL.
 15229
 15230     IF RC-REIN-COMP (SUB1) = SPACES
 15231         MOVE +1 TO SUB1
 15232         GO TO 3755-RC-REIN-NEW-CANCEL.
 15233
 15234     IF RC-REIN-REM-SW (SUB1) = 'Z'
 15235         ADD +1 TO SUB1
 15236         GO TO 3750-RC-REIN-OLD-CANCEL.
 15237
 15238     IF RC-OLD-CNC (SUB1) = 'X'
 15239         ADD +1 TO SUB1
 15240         GO TO 3750-RC-REIN-OLD-CANCEL.
 15241
 15242     IF RC-REIN-LFRFND (SUB1) = ZERO
 15243        AND RC-REIN-AHRFND (SUB1) = ZERO
 15244         ADD +1 TO SUB1
 15245         GO TO 3750-RC-REIN-OLD-CANCEL.
 15246
 15247     MOVE SAVE-EXTRACT        TO DETAIL-EXTRACT.
 15248     PERFORM EXTRACT-DATE-LOAD.
 15249     MOVE RC-REIN-COMP (SUB1) TO DE-REI-COMP.
 15250     MULTIPLY RC-REIN-LFRFND (SUB1) BY -1 GIVING DE-REI-LFRFND.
 15251     MULTIPLY RC-REIN-AHRFND (SUB1) BY -1 GIVING DE-REI-AHRFND.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 294
* ECS010T1.cbl
 15252     PERFORM 2500-WRITE-DETAIL-EXTRACTS THRU 2599-WRT-DETAIL-X.
 15253
 15254     ADD +1 TO BC-R-CNC.
 15255     ADD +1 TO SUB1.
 15256     GO TO 3750-RC-REIN-OLD-CANCEL.
 15257
 15258 3755-RC-REIN-NEW-CANCEL.
 15259
 15260     IF REIN-COMP (SUB1) = SPACES
 15261         PERFORM 2000-INITIALIZE-DETAIL-EXTRACT
 15262         MOVE 'R' TO DE-REIN
 15263         MOVE 'L' TO DE-TRANS
 15264*********PERFORM EXTRACT-DATE-RELOAD
 15265         MOVE DETAIL-EXTRACT TO SAVE-EXTRACT
 15266         MOVE +1 TO SUB1
 15267         GO TO 3760-RC-REIN-OLD-CLAIM.
 15268
 15269     IF REIN-REM-SW (SUB1) = 'Z'
 15270         ADD +1 TO SUB1
 15271         GO TO 3755-RC-REIN-NEW-CANCEL.
 15272
 15273     IF RC-NEW-CNC (SUB1) = 'X'
 15274         ADD +1 TO SUB1
 15275         GO TO 3755-RC-REIN-NEW-CANCEL.
 15276
 15277     IF REIN-LFRFND (SUB1) = ZERO
 15278        AND REIN-AHRFND (SUB1) = ZERO
 15279         ADD +1 TO SUB1
 15280         GO TO 3755-RC-REIN-NEW-CANCEL.
 15281
 15282     MOVE SAVE-EXTRACT       TO DETAIL-EXTRACT.
 15283     PERFORM EXTRACT-DATE-LOAD.
 15284     MOVE REIN-COMP (SUB1)   TO DE-REI-COMP.
 15285     MOVE REIN-LFRFND (SUB1) TO DE-REI-LFRFND.
 15286     MOVE REIN-AHRFND (SUB1) TO DE-REI-AHRFND.
 15287     PERFORM 2500-WRITE-DETAIL-EXTRACTS THRU 2599-WRT-DETAIL-X.
 15288
 15289     ADD +1 TO BC-R-CNC.
 15290     ADD +1 TO SUB1.
 15291     GO TO 3755-RC-REIN-NEW-CANCEL.
 15292
 15293 3760-RC-REIN-OLD-CLAIM.
 15294
 15295     IF RC-REIN-COMP (SUB1) = SPACES
 15296         MOVE +1 TO SUB1
 15297         GO TO 3780-RC-REIN-NEW-CLAIM.
 15298
 15299     IF RC-REIN-REM-SW (SUB1) = 'Z'
 15300         ADD +1 TO SUB1
 15301         GO TO 3760-RC-REIN-OLD-CLAIM.
 15302
 15303     IF RC-OLD-LF-CLM (SUB1) = 'X'
 15304         GO TO 3770-RC-REIN-OLD-AH-CLM.
 15305
 15306     IF RC-REIN-LFCLM (SUB1) = ZERO
 15307         GO TO 3770-RC-REIN-OLD-AH-CLM.
 15308
 15309     MOVE SAVE-EXTRACT         TO DETAIL-EXTRACT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 295
* ECS010T1.cbl
 15310     PERFORM EXTRACT-DATE-LOAD.
 15311     MOVE RC-REIN-COMP (SUB1)  TO DE-REI-COMP.
 15312     MOVE RC-REIN-LFAMT (SUB1) TO DE-REI-LFAMT.
 15313     MOVE RC-REIN-LFPRM (SUB1) TO DE-REI-LFPRM.
 15314     MOVE RC-REIN-AHAMT (SUB1) TO DE-REI-AHAMT.
 15315     MOVE RC-REIN-AHPRM (SUB1) TO DE-REI-AHPRM.
 15316     MULTIPLY RC-REIN-LFCLM (SUB1) BY -1 GIVING DE-REI-CLAIM-AMT.
 15317     MOVE CR-DTHAMT     TO DE-CLAIM-AMT.
 15318     ADD  CR-DTHEXP     TO DE-CLAIM-AMT.
 15319     MOVE CR-DTH-PAY-DT TO DE-PAY
 15320                           WS-DE-PAY-N.
 15321
 15322     IF CLAS-I-BAL (CLAS-INDEXL) = 'B'
 15323         MOVE '3' TO DE-TYPE
 15324     ELSE
 15325         MOVE '1' TO DE-TYPE.
 15326
 15327     PERFORM 2500-WRITE-DETAIL-EXTRACTS THRU 2599-WRT-DETAIL-X.
 15328
 15329     ADD +1 TO BC-R-CLM.
 15330
 15331 3770-RC-REIN-OLD-AH-CLM.
 15332
 15333     IF RC-OLD-AH-CLM (SUB1) = 'X'
 15334         ADD +1 TO SUB1
 15335         GO TO 3760-RC-REIN-OLD-CLAIM.
 15336
 15337     IF RC-REIN-AHCLM (SUB1) = ZERO
 15338         ADD +1 TO SUB1
 15339         GO TO 3760-RC-REIN-OLD-CLAIM.
 15340
 15341     MOVE SAVE-EXTRACT         TO DETAIL-EXTRACT.
 15342     PERFORM EXTRACT-DATE-LOAD.
 15343     MOVE RC-REIN-COMP (SUB1)  TO DE-REI-COMP.
 15344     MOVE RC-REIN-LFAMT (SUB1) TO DE-REI-LFAMT.
 15345     MOVE RC-REIN-LFPRM (SUB1) TO DE-REI-LFPRM.
 15346     MOVE RC-REIN-AHAMT (SUB1) TO DE-REI-AHAMT.
 15347     MOVE RC-REIN-AHPRM (SUB1) TO DE-REI-AHPRM.
 15348     MULTIPLY RC-REIN-AHCLM (SUB1) BY -1 GIVING DE-REI-CLAIM-AMT.
 15349     MOVE CR-DISAMT     TO DE-CLAIM-AMT.
 15350     ADD  CR-DISEXP     TO DE-CLAIM-AMT.
 15351     MOVE CR-DIS-PAY-DT TO DE-PAY
 15352                           WS-DE-PAY-N.
 15353
 15354     IF CLAS-I-BAL (CLAS-INDEXA) = 'B'
 15355         MOVE '4' TO DE-TYPE
 15356     ELSE
 15357         MOVE '2' TO DE-TYPE.
 15358
 15359     PERFORM 2500-WRITE-DETAIL-EXTRACTS THRU 2599-WRT-DETAIL-X.
 15360
 15361     ADD +1 TO BC-R-CLM.
 15362     ADD +1 TO SUB1.
 15363
 15364     GO TO 3760-RC-REIN-OLD-CLAIM.
 15365
 15366 3780-RC-REIN-NEW-CLAIM.
 15367
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 296
* ECS010T1.cbl
 15368     IF REIN-COMP (SUB1) = SPACES
 15369         GO TO 3799-RC-REINSURANCE-X.
 15370
 15371     IF REIN-REM-SW (SUB1) = 'Z'
 15372         ADD +1 TO SUB1
 15373         GO TO 3780-RC-REIN-NEW-CLAIM.
 15374
 15375     IF RC-NEW-LF-CLM (SUB1) = 'X'
 15376         GO TO 3790-RC-REIN-NEW-AH-CLM.
 15377
 15378     IF REIN-LFCLM (SUB1) = ZERO
 15379         GO TO 3790-RC-REIN-NEW-AH-CLM.
 15380
 15381     MOVE SAVE-EXTRACT      TO DETAIL-EXTRACT.
 15382     PERFORM EXTRACT-DATE-LOAD.
 15383     MOVE REIN-COMP (SUB1)  TO DE-REI-COMP.
 15384     MOVE REIN-LFAMT (SUB1) TO DE-REI-LFAMT.
 15385     MOVE REIN-LFPRM (SUB1) TO DE-REI-LFPRM.
 15386     MOVE REIN-AHAMT (SUB1) TO DE-REI-AHAMT.
 15387     MOVE REIN-AHPRM (SUB1) TO DE-REI-AHPRM.
 15388     MOVE REIN-LFCLM (SUB1) TO DE-REI-CLAIM-AMT.
 15389     MOVE CR-DTHAMT         TO DE-CLAIM-AMT.
 15390     ADD  CR-DTHEXP         TO DE-CLAIM-AMT.
 15391     MOVE CR-DTH-PAY-DT     TO DE-PAY
 15392                               WS-DE-PAY-N.
 15393
 15394     IF CLAS-I-BAL (CLAS-INDEXL) = 'B'
 15395         MOVE '3' TO DE-TYPE
 15396     ELSE
 15397         MOVE '1' TO DE-TYPE.
 15398
 15399     PERFORM 2500-WRITE-DETAIL-EXTRACTS THRU 2599-WRT-DETAIL-X.
 15400
 15401     ADD +1 TO BC-R-CLM.
 15402
 15403 3790-RC-REIN-NEW-AH-CLM.
 15404
 15405     IF RC-NEW-AH-CLM (SUB1) = 'X'
 15406         ADD +1 TO SUB1
 15407         GO TO 3780-RC-REIN-NEW-CLAIM.
 15408
 15409     IF REIN-AHCLM (SUB1) = ZERO
 15410         ADD +1 TO SUB1
 15411         GO TO 3780-RC-REIN-NEW-CLAIM.
 15412
 15413     MOVE SAVE-EXTRACT      TO DETAIL-EXTRACT.
 15414     PERFORM EXTRACT-DATE-LOAD.
 15415     MOVE REIN-COMP (SUB1)  TO DE-REI-COMP.
 15416     MOVE REIN-LFAMT (SUB1) TO DE-REI-LFAMT.
 15417     MOVE REIN-LFPRM (SUB1) TO DE-REI-LFPRM.
 15418     MOVE REIN-AHAMT (SUB1) TO DE-REI-AHAMT.
 15419     MOVE REIN-AHPRM (SUB1) TO DE-REI-AHPRM.
 15420     MOVE REIN-AHCLM (SUB1) TO DE-REI-CLAIM-AMT.
 15421     MOVE CR-DISAMT         TO DE-CLAIM-AMT.
 15422     ADD  CR-DISEXP         TO DE-CLAIM-AMT.
 15423     MOVE CR-DIS-PAY-DT     TO DE-PAY
 15424                               WS-DE-PAY-N.
 15425
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 297
* ECS010T1.cbl
 15426     IF CLAS-I-BAL (CLAS-INDEXA) = 'B'
 15427         MOVE '4' TO DE-TYPE
 15428     ELSE
 15429         MOVE '2' TO DE-TYPE.
 15430
 15431     PERFORM 2500-WRITE-DETAIL-EXTRACTS THRU 2599-WRT-DETAIL-X.
 15432
 15433     ADD +1 TO BC-R-CLM.
 15434     ADD +1 TO SUB1.
 15435
 15436     GO TO 3780-RC-REIN-NEW-CLAIM.
 15437
 15438 3799-RC-REINSURANCE-X.
 15439     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 298
* ECS010T1.cbl
 15441******************************************************************
 15442***    E A R N E D   P R E M I U M   C A L C U L A T I O N S   ***
 15443******************************************************************
 15444
 15445 4000-EP-BUMP-RTN.
 15446
 15447     IF AM-RECALC-COMM = ('Y' OR '1')
 15448        PERFORM 1600-RECALC-COMM-EXTR
 15449                                 THRU 1899-RECALC-COMM-EXTR-X
 15450        MOVE ' '                 TO RECALC-TYPE
 15451     END-IF
 15452
 15453     MOVE '1'    TO EP-FLG.
 15454     ADD +1      TO BC-G-CERTS.
 15455
 15456     MOVE CR-DT               TO HIGH-CERT.
 15457     IF CR-ACCT-CONTROL NOT = LOW-CTL
 15458         MOVE CR-DT           TO LOW-CERT
 15459         MOVE CR-ACCT-CONTROL TO LOW-CTL.
 15460
 15461     IF CR-POLICY-IS-REIN-ONLY
 15462         MOVE +0           TO GROSS-ISS-BEN-LF   GROSS-ISS-BEN-AH
 15463                              GROSS-CNC-BEN-LF   GROSS-CNC-BEN-AH
 15464                              GROSS-ISS-PRM-LF   GROSS-ISS-PRM-AH
 15465                              GROSS-CNC-PRM-LF   GROSS-CNC-PRM-AH
 15466                              DTH-IBNR           DIS-IBNR
 15467                              DTH-PAYCUR         DIS-PAYCUR
 15468                              DTH-FUTRSV         DIS-FUTRSV
 15469         GO TO 4050-EP-DO-REINSURE.
 15470
 15471     MOVE CR-LFAMT       TO WE-LFAMT.
 15472     MOVE CR-LFPRM       TO WE-LFPRM.
 15473     IF CR-LFTYP NOT = ZEROS
 15474         IF CLAS-I-EP (CLAS-INDEXL) = 'B'
 15475             MOVE CR-LFAMT-ALT        TO WE-LFAMT-ALT
 15476             MOVE CR-LFPRM-ALT        TO WE-LFPRM-ALT
 15477         ELSE
 15478             MOVE ZEROS               TO WE-LFAMT-ALT
 15479                                         WE-LFPRM-ALT.
 15480
 15481     MOVE SPACES         TO REIN-EP-FLG
 15482                            WE-REIN-CO.
 15483     MOVE CR-LFRFND      TO WE-LFRFND.
 15484     MOVE CR-DTHAMT      TO WE-DTHAMT.
 15485     ADD  CR-DTHEXP      TO WE-DTHAMT.
 15486     MOVE CR-DTHEXP      TO WE-DTHEXP.
 15487     MOVE CR-NUM-DTH-CLM TO WE-NUM-DTH-CLM.
 15488     MOVE DTH-IBNR       TO WE-DTH-IBNR.
 15489     MOVE DTH-PAYCUR     TO WE-DTH-PAYCUR.
 15490     MOVE DTH-FUTRSV     TO WE-DTH-FUTRSV.
 15491
 15492     MOVE CR-AHPRM       TO WE-AHPRM.
 15493     MOVE CR-AHAMT       TO WE-AHAMT.
 15494     MOVE CR-AHRFND      TO WE-AHRFND.
 15495     MOVE CR-DISAMT      TO WE-DSPY-AMT.
 15496     ADD  CR-DISEXP      TO WE-DSPY-AMT.
 15497     MOVE CR-DISEXP      TO WE-DSPY-EXP.
 15498     MOVE CR-NUM-DIS-CLM TO WE-NUM-DIS-CLM.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 299
* ECS010T1.cbl
 15499     MOVE DIS-IBNR       TO WE-DIS-IBNR.
 15500     MOVE DIS-PAYCUR     TO WE-DIS-PAYCUR.
 15501     MOVE DIS-FUTRSV     TO WE-DIS-FUTRSV.
 15502
 15503     IF CR-POLICY-IS-RESTORE  OR
 15504        CR-POLICY-IS-REISSUE
 15505        OR CR-POLICY-IS-MONTHLY
 15506         MOVE ZEROS      TO WE-LFPRM
 15507                            WE-LFPRM-ALT
 15508                            WE-AHPRM.
 15509
 15510     MOVE +0               TO GROSS-ISS-BEN-LF   GROSS-ISS-BEN-AH
 15511                              GROSS-CNC-BEN-LF   GROSS-CNC-BEN-AH
 15512                              GROSS-ISS-PRM-LF   GROSS-ISS-PRM-AH
 15513                              GROSS-CNC-PRM-LF   GROSS-CNC-PRM-AH
 15514                              DTH-IBNR           DIS-IBNR
 15515                              DTH-PAYCUR         DIS-PAYCUR
 15516                              DTH-FUTRSV         DIS-FUTRSV.
 15517
 15518*     DISPLAY ' B4 4100 '
 15519     PERFORM 4100-EP-DO-LF THRU 4299-EPBX.
 15520*     DISPLAY ' AFTER 4100 '
 15521
 15522     IF CR-POLICY-IS-DECLINED  OR
 15523        CR-POLICY-IS-VOID
 15524         GO TO 4099-EP-BUMP-RTN-X.
 15525
 15526 4050-EP-DO-REINSURE.
 15527
 15528     MOVE 'R' TO REIN-EP-FLG.
 15529     MOVE +1  TO SUB5.
 15530
 15531 4090-EP-DO-REINSURE-LOOP.
 15532
 15533*     DISPLAY ' 4090 '
 15534     IF REIN-COMP (SUB5) = SPACES
 15535         MOVE SPACE TO REIN-EP-FLG
 15536         GO TO 4099-EP-BUMP-RTN-X.
 15537
 15538     IF REIN-REM-SW (SUB5) = 'Z'  OR
 15539        REIN-LF-AH-FLGS (SUB5) = SPACES
 15540         ADD +1 TO SUB5
 15541         GO TO 4090-EP-DO-REINSURE-LOOP.
 15542
 15543     PERFORM REIN-FIND-CO-LOOP THRU FIND-REI-CO-EXIT
 15544        VARYING CO-SUB FROM 1 BY 1 UNTIL
 15545          (RCT-REIN-CO (CO-SUB) = REIN-COMP (SUB5))  OR
 15546          (CO-SUB GREATER REIN-CO-TABLE-ENT-CNT)     OR
 15547          (RCT-REIN-CO (CO-SUB) = SPACES).
 15548
 15549     IF (CO-SUB GREATER REIN-CO-TABLE-ENT-CNT)  OR
 15550        (RCT-REIN-CO (CO-SUB) = SPACES)
 15551        MOVE ZERO TO CO-SUB.
 15552
 15553*     DISPLAY ' 4090 A '
 15554*     DISPLAY ' AM RECALC ' AM-RECALC-COMM
 15555     ADD +1 TO BC-R-CERTS.
 15556     MOVE REIN-COMP (SUB5)      TO WE-REIN-CO.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 300
* ECS010T1.cbl
 15557     MOVE REIN-WORK-FLDS (SUB5) TO RWF-FIELDS.
 15558     MOVE RE-COMP-INFO (SUB5)   TO WT-COMP-INFO
 15559
 15560     IF (DTE-CLIENT = 'DCC')
 15561        AND (CR-LFAMT + CR-LFAMT-ALT) > ZEROS
 15562*        DISPLAY ' B4 CEDE FACT '
 15563*        DISPLAY ' CR-LFAMT ' CR-LFAMT
 15564*        DISPLAY ' CR-LFAMT-ALT ' CR-LFAMT-ALT
 15565*        DISPLAY ' RWF-LFAMT ' RWF-LFAMT
 15566        COMPUTE WS-CEDE-FACT =
 15567           RWF-LFAMT / (CR-LFAMT + CR-LFAMT-ALT)
 15568*        DISPLAY ' AFTER CEDE FACT '
 15569        IF (AM-RECALC-COMM = ('Y' OR '1'))
 15570           AND (CLAS-I-BEN-CATEGORY (CLAS-INDEXA)
 15571                                     NOT = 'G' AND 'L')
 15572           COMPUTE RWF-LFPRM = CR-LF-NSP-PRM * WS-CEDE-FACT
 15573*          COMPUTE RWF-LFRFND ROUNDED = CR-LF-NSP-PRM
 15574*          / (CR-LFPRM + CR-LFPRM-ALT) * CR-LFRFND
 15575           COMPUTE RWF-LFRFND ROUNDED = (CR-LFRFND
 15576           / (CR-LFPRM + CR-LFPRM-ALT)) * CR-LF-NSP-PRM
 15577        END-IF
 15578     END-IF
 15579
 15580     MOVE RWF-LFPRM      TO WE-LFPRM.
 15581     MOVE RWF-LFAMT      TO WE-LFAMT.
 15582     MOVE RWF-LFRFND     TO WE-LFRFND.
 15583     MOVE RWF-LFCLM      TO WE-DTHAMT.
 15584     MOVE RWF-DTH-IBNR   TO WE-DTH-IBNR.
 15585     MOVE RWF-DTH-PAYCUR TO WE-DTH-PAYCUR.
 15586     MOVE RWF-DTH-FUTRSV TO WE-DTH-FUTRSV.
 15587     MOVE +0             TO WE-LFAMT-ALT
 15588                            WE-LFPRM-ALT
 15589                            WE-DTHEXP
 15590                            WE-NUM-DTH-CLM.
 15591
 15592*     DISPLAY ' 4090 B '
 15593     IF (DTE-CLIENT EQUAL 'NSL') AND
 15594        (CR-REIN-TABLE EQUAL 'NAR')
 15595        CONTINUE
 15596     ELSE
 15597      IF CLAS-I-EP (CLAS-INDEXL) EQUAL 'B'
 15598       IF (CR-LFAMT + CR-LFAMT-ALT) GREATER THAN +0
 15599        COMPUTE WS-CEDE-FACT ROUNDED EQUAL
 15600            RWF-LFAMT / (CR-LFAMT + CR-LFAMT-ALT)
 15601        COMPUTE WE-LFAMT ROUNDED EQUAL
 15602                           CR-LFAMT * WS-CEDE-FACT
 15603        COMPUTE WE-LFAMT-ALT ROUNDED EQUAL
 15604                           CR-LFAMT-ALT * WS-CEDE-FACT
 15605        IF (DTE-CLIENT = 'CID')
 15606           AND (CR-LF-NSP-PRM > +0)
 15607           AND (CR-ENTRY-DATE > 20031130)
 15608           AND (WT-LF-QC NOT = '1' AND '3')
 15609           COMPUTE WE-LFPRM ROUNDED = (CR-LF-NSP-PRM *
 15610              RWF-LFAMT) / (CR-LFAMT + CR-LFAMT-ALT)
 15611           MOVE +0            TO WE-LFPRM-ALT
 15612        ELSE
 15613          IF (DTE-CLIENT = 'CID')
 15614             AND (CR-LF-NSP-PRM > +0)
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 301
* ECS010T1.cbl
 15615             AND (CR-ENTRY-DATE > 20030430)
 15616             AND (WT-LF-QC NOT = '1' AND '3')
 15617             COMPUTE WE-LFPRM = CR-LF-NSP-PRM * WS-CEDE-FACT
 15618             MOVE +0            TO WE-LFPRM-ALT
 15619          ELSE
 15620             COMPUTE WE-LFPRM ROUNDED EQUAL
 15621                           CR-LFPRM * WS-CEDE-FACT
 15622             COMPUTE WE-LFPRM-ALT ROUNDED EQUAL
 15623                           CR-LFPRM-ALT * WS-CEDE-FACT
 15624          END-IF
 15625        END-IF
 15626        IF (DTE-CLIENT = 'CID')
 15627           AND (CR-LF-NSP-PRM > +0)
 15628           AND (CR-LFRFND-CALC > +0)
 15629           AND (CR-LF-CANCEL-EXIT-DATE > 20031130)
 15630           AND (WT-LF-QC NOT = '1' AND '4')
 15631           COMPUTE REIN-FACTOR ROUNDED =  CR-LFRFND-CALC /
 15632              (CR-LFPRM + CR-LFPRM-ALT)
 15633           COMPUTE WE-LFRFND =
 15634              REIN-FACTOR * REIN-CALCED-LIFE
 15635           COMPUTE WE-LFRFND ROUNDED =  (WE-LFRFND
 15636              * RWF-LFAMT) / (CR-LFAMT + CR-LFAMT-ALT)
 15637*          COMPUTE WE-LFRFND = CR-LFRFND-CALC / (CR-LFPRM
 15638*             + CR-LFPRM-ALT) * CR-LF-NSP-PRM
 15639*             * RWF-LFAMT / (CR-LFAMT + CR-LFAMT-ALT)
 15640        ELSE
 15641
 15642          IF (DTE-CLIENT = 'CID')
 15643           AND (CR-LF-NSP-PRM > +0)
 15644           AND (CR-LFRFND-CALC > +0)
 15645           AND (CR-LF-CANCEL-EXIT-DATE > 20030430)
 15646           AND (WT-LF-QC NOT = '1' AND '4')
 15647           COMPUTE WS-WE-LFPRM = CR-LF-NSP-PRM * WS-CEDE-FACT
 15648           COMPUTE WE-LFRFND = (CR-LFRFND-CALC / (CR-LFPRM
 15649              + CR-LFPRM-ALT)) * (WS-WE-LFPRM)
 15650
 15651          END-IF
 15652        END-IF
 15653       ELSE
 15654         MOVE +0 TO WS-CEDE-FACT
 15655       END-IF
 15656      END-IF
 15657     END-IF
 15658
 15659*     DISPLAY ' 4090 C '
 15660     IF DTE-CLIENT = 'DCC'
 15661        IF (AM-RECALC-COMM = ('Y' OR '1'))
 15662           AND (CLAS-I-BEN-CATEGORY (CLAS-INDEXA)
 15663                                   NOT = 'G' AND 'L')
 15664           AND (CR-AHAMT NOT = ZEROS)
 15665*        DISPLAY ' CR-AHAMT ' CR-AHAMT
 15666           COMPUTE WS-CEDE-FACT =
 15667               RWF-AHAMT / CR-AHAMT
 15668           COMPUTE RWF-AHPRM = CR-AH-NSP-PRM * WS-CEDE-FACT
 15669*          COMPUTE RWF-AHRFND ROUNDED = CR-AH-NSP-PRM
 15670*          / CR-AHPRM * CR-AHRFND
 15671           COMPUTE RWF-AHRFND ROUNDED = (CR-AHRFND
 15672           / CR-AHPRM) * CR-AH-NSP-PRM
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 302
* ECS010T1.cbl
 15673        END-IF
 15674     END-IF
 15675
 15676     MOVE RWF-AHPRM      TO WE-AHPRM.
 15677
 15678     MOVE RWF-AHAMT      TO WE-AHAMT
 15679     MOVE RWF-AHRFND     TO WE-AHRFND.
 15680     MOVE RWF-AHCLM      TO WE-DSPY-AMT.
 15681     MOVE +0             TO WE-DSPY-EXP
 15682                            WE-NUM-DIS-CLM.
 15683     MOVE RWF-DIS-IBNR   TO WE-DIS-IBNR.
 15684     MOVE RWF-DIS-PAYCUR TO WE-DIS-PAYCUR.
 15685     MOVE RWF-DIS-FUTRSV TO WE-DIS-FUTRSV.
 15686
 15687     IF  RWF-LF-RUNOFF-SW = 'N'
 15688             OR
 15689         RWF-AH-RUNOFF-SW = 'N'
 15690         PERFORM 8000R-CONVERT-STOP-DATE THRU 8099R-STOP-DATE-X.
 15691
 15692     IF  RWF-LF-RUNOFF-SW = 'N'
 15693         MOVE EARNING-STOP-DATE    TO STOP-LF-DATE
 15694     ELSE
 15695         MOVE 99999999             TO STOP-LF-DATE.
 15696
 15697     IF  RWF-AH-RUNOFF-SW = 'N'
 15698         MOVE EARNING-STOP-DATE    TO STOP-AH-DATE
 15699     ELSE
 15700         MOVE 99999999             TO STOP-AH-DATE.
 15701
 15702     IF CR-POLICY-IS-RESTORE  OR
 15703        CR-POLICY-IS-REISSUE
 15704        OR CR-POLICY-IS-MONTHLY
 15705         MOVE ZEROS      TO WE-LFPRM
 15706                            WE-LFPRM-ALT
 15707                            WE-AHPRM.
 15708
 15709*     DISPLAY ' B4 4100-EP-DO-LF '
 15710     PERFORM 4100-EP-DO-LF THRU 4299-EPBX.
 15711*     DISPLAY ' AFTER 4100-EP-DO-LF '
 15712
 15713     IF CO-SUB NOT = ZERO
 15714       IF RCT-EARNING-START-DT (CO-SUB) NOT = ZERO
 15715         IF CR-DT LESS THAN RCT-EARNING-START-DT (CO-SUB)
 15716             PERFORM S-4100-EP-DO-LF THRU S-4299-EPBX.
 15717
 15718     ADD +1 TO SUB5.
 15719     GO TO 4090-EP-DO-REINSURE-LOOP.
 15720
 15721 4099-EP-BUMP-RTN-X.
 15722     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 303
* ECS010T1.cbl
 15724******************************************************************
 15725***  C A L C U L A T E   L I F E   E A R N E D   P R E M I U M ***
 15726******************************************************************
 15727
 15728 4100-EP-DO-LF.
 15729
 15730     MOVE +0                         TO ISS-BEN  EPR-R78
 15731                                        CNC-BEN  EPR-PRO
 15732                                        ISS-PRM  EPR-ST
 15733                                        ISS-PRMTAX
 15734                                        CNC-PRM  ACTIVE-COUNT.
 15735     MOVE SPACE                      TO LIFE-EARNED-SWITCH.
 15736
 15737     IF CR-LFTYP = ZERO
 15738         GO TO 4200-EP-DO-AH.
 15739
 15740     IF REIN-EP-FLG = 'R'
 15741         IF REIN-LF-FLG (SUB5) = SPACE
 15742             GO TO 4200-EP-DO-AH.
 15743
 15744     IF CR-APR NOT NUMERIC
 15745         MOVE ZERO TO CR-APR.
 15746
 15747     MOVE LIFE-OVERRIDE-L1       TO WE-LF-AH.
 15748     MOVE CR-LFTYP               TO WE-BEN-TYPE.
 15749     PERFORM 4400-EP-FIND-TAB-ENT THRU 4499-EP-FIND-TAB-ENT-X.
 15750
 15751     IF CR-POLICY-IS-DECLINED  OR
 15752        CR-POLICY-IS-VOID
 15753         GO TO 4191-CONTINUE.
 15754
 15755     MOVE CR-LF-TERM             TO ORIG-TERM.
 15756     MOVE CLAS-INDEXL            TO W-NDX.
 15757
 15758     IF CR-DT GREATER EW-COV-DTE
 15759         MOVE CR-DT              TO EW-COV-DTE.
 15760
 15761     IF (NOT CR-POLICY-IS-RESTORE) AND
 15762        (NOT CR-POLICY-IS-REISSUE)
 15763        AND (NOT CR-POLICY-IS-MONTHLY)
 15764         COMPUTE ISS-BEN = WE-LFAMT + WE-LFAMT-ALT
 15765         IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'Z'
 15766             ADD CR-LIVES TO EW-ISS-CNT
 15767             COMPUTE EW-ORIG-TERM = EW-ORIG-TERM +
 15768                                    (ORIG-TERM * CR-LIVES)
 15769             COMPUTE EW-AGE = EW-AGE + (CR-AGE * CR-LIVES)
 15770             COMPUTE EW-AGE-BEN = EW-AGE-BEN + (CR-AGE * ISS-BEN)
 15771             COMPUTE EW-TERM-BEN = EW-TERM-BEN +
 15772                                   (ORIG-TERM * ISS-BEN)
 15773         ELSE
 15774             ADD +1 TO EW-ISS-CNT
 15775             COMPUTE EW-ORIG-TERM = EW-ORIG-TERM + ORIG-TERM
 15776             COMPUTE EW-AGE = EW-AGE + CR-AGE
 15777             COMPUTE EW-AGE-BEN = EW-AGE-BEN + (CR-AGE * ISS-BEN)
 15778             COMPUTE EW-TERM-BEN = EW-TERM-BEN +
 15779                                   (ORIG-TERM * ISS-BEN).
 15780
 15781     MOVE RUN-DATE        TO VALUATION-DT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 304
* ECS010T1.cbl
 15782     MOVE '2'             TO W-VAL-SOURCE.
 15783
 15784     IF REIN-EP-FLG = 'R'
 15785         IF REIN-LF-RUNOFF-SW (SUB5) = 'N' AND
 15786            EARNING-STOP-DATE LESS THAN VALUATION-DT
 15787             MOVE EARNING-STOP-DATE TO VALUATION-DT
 15788             MOVE '10'              TO W-VAL-SOURCE.
 15789
 15790     PERFORM 8500-REMAINING-TERM-ROUTINE THRU 8599-REM-TERM-X.
 15791
 15792     IF (CR-LF-CURRENT-STATUS = '1' OR '4') AND
 15793        (REM-TRM3 GREATER ZERO)
 15794        IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'Z'
 15795            COMPUTE EW-INFORCE-CNT = EW-INFORCE-CNT +
 15796                                  (CR-LIVES - CR-SUM-CAN-CNT-ITD)
 15797            COMPUTE EW-REM-TERM = EW-REM-TERM +
 15798                     (REM-TRM3 * (CR-LIVES - CR-SUM-CAN-CNT-ITD))
 15799          ELSE
 15800            COMPUTE EW-INFORCE-CNT = EW-INFORCE-CNT + 1
 15801            COMPUTE EW-REM-TERM = EW-REM-TERM + REM-TRM3.
 15802
 15803     COMPUTE ISS-PRM = WE-LFPRM + WE-LFPRM-ALT.
 15804
 15805     IF DTE-CLIENT = 'GIC'
 15806         IF REIN-EP-FLG NOT = 'R'  AND
 15807            CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'B'  AND
 15808            (CR-ENTRY-STATUS NOT = '5' AND '3' AND 'M')
 15809            MOVE CR-LFPRM-CALC TO ISS-PRM.
 15810
 15811     IF  DTE-OPT-RESERVE-METHOD-UNAUTH
 15812         GO TO 4105-EP-DO-LF-REIN-CHK.
 15813
 15814     IF  CR-DT NOT GREATER THAN EOM-DATE (13)
 15815             AND
 15816         CR-LF-EXPIRE-DATE GREATER THAN EOM-DATE (1)
 15817             AND
 15818         (CR-LF-CANC-DT GREATER THAN EOM-DATE (1)
 15819                 OR
 15820             CR-LF-CANC-DT EQUAL ZEROS)
 15821             AND
 15822         (CR-LF-CLAIM-EXIT-DATE GREATER THAN EOM-DATE (1)
 15823                 OR
 15824             CR-LF-CLAIM-EXIT-DATE EQUAL ZEROS)
 15825         MOVE 'Y'               TO  EPEC-LIFE-CTR-USED-IND (SUB3)
 15826         PERFORM 4194-SLOT-INTO-EFFECTED-MONTHS THRU 4194-EXIT
 15827                 VARYING
 15828             SUBM FROM +1 BY +1
 15829                 UNTIL
 15830             SUBM GREATER THAN +13.
 15831
 15832     MOVE EW-SUB-KEY             TO EPEC-SUB-KEY-OPT (SUB3).
 15833     MOVE EW-REIN-CO             TO EPEC-REIN-CO-OPT (SUB3).
 15834
 15835 4105-EP-DO-LF-REIN-CHK.
 15836
 15837     IF REIN-EP-FLG = 'R'  AND
 15838        REIN-LF-RUNOFF-SW (SUB5) = 'N'
 15839         NEXT SENTENCE
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 305
* ECS010T1.cbl
 15840     ELSE
 15841         GO TO 4110-EP-DO-LF-CLM.
 15842
 15843     IF CR-LF-STATUS-AT-CANCEL NOT = ' '
 15844         IF CR-LF-CANC-DT GREATER THAN EARNING-STOP-DATE
 15845             GO TO 4130-EP-DO-LF-EP.
 15846
 15847     IF CR-LF-STATUS-AT-DEATH NOT = ' '
 15848         IF CR-DTH-DT GREATER THAN EARNING-STOP-DATE
 15849             GO TO 4130-EP-DO-LF-EP.
 15850
 15851 4110-EP-DO-LF-CLM.
 15852
 15853     IF  EPEC-CLM-EXP (SUB3)  NUMERIC
 15854         NEXT  SENTENCE
 15855       ELSE
 15856         MOVE ZEROS TO EPEC-CLM-EXP (SUB3).
 15857
 15858     ADD WE-DTHAMT      TO EW-CLM-AMT.
 15859     ADD WE-DTHEXP      TO EPEC-CLM-EXP (SUB3).
 15860
 15861     IF CR-LF-STATUS-AT-DEATH = ' '
 15862         IF CLAS-I-CALC-TYPE (CLAS-INDEXL) NOT = 'B'
 15863             GO TO 4115-EP-DO-LF-CLM-EPR.
 15864
 15865     ADD WE-NUM-DTH-CLM TO EW-CLM-CNT.
 15866     ADD +1             TO EW-CLM-CRT.
 15867
 15868 4115-EP-DO-LF-CLM-EPR.
 15869
 15870     IF CR-LF-STATUS-AT-DEATH NOT = ' '
 15871         COMPUTE EPR-R78 = WE-LFPRM + WE-LFPRM-ALT
 15872         MOVE EPR-R78 TO EPR-PRO  EPR-ST
 15873     END-IF
 15874     .
 15875 4120-EP-DO-LF-CNCL.
 15876
 15877     IF CR-LF-STATUS-AT-CANCEL = ' '  AND
 15878        CLAS-I-CALC-TYPE (CLAS-INDEXL) NOT = 'Z'
 15879         IF CR-LF-STATUS-AT-DEATH NOT = ' '
 15880             GO TO 4190-EP-DO-LF-COMM
 15881         ELSE
 15882             GO TO 4130-EP-DO-LF-EP.
 15883
 15884     IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'Z'
 15885         ADD CR-SUM-CAN-CNT-ITD TO EW-CNC-CNT
 15886         GO TO 4124-EP-DO-LF-CNCL-SUM.
 15887
 15888     ADD +1                       TO EW-CNC-CNT.
 15889
 15890     MOVE WE-LFRFND               TO CNC-PRM.
 15891
 15892     IF DTE-CLIENT = 'GIC'
 15893         IF REIN-EP-FLG NOT = 'R'  AND
 15894            CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'B'
 15895             MOVE CR-LFRFND-CALC TO CNC-PRM.
 15896
 15897*    MOVE CR-DT                 TO  DC-GREG-DATE-CYMD.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 306
* ECS010T1.cbl
 15898*    MOVE 'L'                   TO  DC-OPTION-CODE.
 15899*    PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 15900*    MOVE DC-BIN-DATE-1         TO  WS-CR-BIN-DATE.
 15901
 15902     MOVE CR-LF-CANC-DT         TO  DC-GREG-DATE-CYMD.
 15903     MOVE 'L'                   TO  DC-OPTION-CODE.
 15904     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 15905     MOVE DC-BIN-DATE-1         TO  WS-BIN-CANCEL-DATE.
 15906
 15907     MOVE WS-CR-BIN-DATE          TO  DC-BIN-DATE-1.
 15908     MOVE WS-BIN-CANCEL-DATE      TO  DC-BIN-DATE-2.
 15909     MOVE '1'                     TO  DC-OPTION-CODE.
 15910     MOVE ZEROS                   TO  MONTHS-DIFF-LF.
 15911     MOVE ' '                     TO  DC-CENTURY-ADJUSTMENT.
 15912     MOVE ZEROS                   TO  DC-ELAPSED-MONTHS
 15913                                      DC-ODD-DAYS-OVER
 15914                                      DC-ELAPSED-DAYS.
 15915     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 15916     MOVE DC-ELAPSED-MONTHS       TO  MONTHS-DIFF-LF.
 15917
 15918     IF DC-ODD-DAYS-OVER   GREATER THAN  ZERO
 15919         ADD  +1                  TO  MONTHS-DIFF-LF.
 15920
 15921     MOVE  'YYYYYYYYYY'           TO  WS-LF-CHARGEBACK-LEVELS.
 15922
 15923     IF DTE-CLIENT = 'ACE'
 15924         GO TO 4120-CONTINUE-LIFE-CANCEL.
 15925
 15926     MOVE  ZEROS                  TO  SUB.
 15927
 15928 4120-LIFE-CHARGEBACK-LOOP.
 15929
 15930     ADD    +1                    TO  SUB.
 15931
 15932     IF  SUB  GREATER THAN  +10
 15933         GO TO  4120-CONTINUE-LIFE-CANCEL.
 15934
 15935     IF  AM-COMM-CHARGEBACK (SUB)  NOT  NUMERIC  OR
 15936         AM-COMM-CHARGEBACK (SUB)  =  ZEROS
 15937         GO TO  4120-LIFE-CHARGEBACK-LOOP.
 15938
 15939     IF  AM-COMM-CHARGEBACK (SUB)  EQUAL    '99'
 15940         MOVE  'N'    TO  WS-LF-CHARGEBACK-SW (SUB).
 15941
 15942     IF  MONTHS-DIFF-LF GREATER THAN AM-COMM-CHARGEBACK (SUB)
 15943         MOVE  'N'        TO  WS-LF-CHARGEBACK-SW (SUB).
 15944
 15945     GO TO  4120-LIFE-CHARGEBACK-LOOP.
 15946
 15947
 15948 4120-CONTINUE-LIFE-CANCEL.
 15949
 15950     COMPUTE EPR-R78 = (WE-LFPRM + WE-LFPRM-ALT) - WE-LFRFND.
 15951     MOVE EPR-R78 TO EPR-PRO  EPR-ST.
 15952
 15953     IF WE-LFRFND = +0 AND WE-DTHAMT NOT = +0
 15954         GO TO 4190-EP-DO-LF-COMM.
 15955
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 307
* ECS010T1.cbl
 15956     IF CLAS-I-RL-AH (CLAS-INDEXL) = 'L' OR 'P'
 15957         COMPUTE CNC-BEN = WE-LFAMT + WE-LFAMT-ALT
 15958         GO TO 4190-EP-DO-LF-COMM.
 15959
 15960     MOVE CR-LF-CANC-DT TO VALUATION-DT.
 15961     MOVE '3'           TO W-VAL-SOURCE.
 15962     PERFORM 8500-REMAINING-TERM-ROUTINE THRU 8599-REM-TERM-X.
 15963
 15964     IF REM-TRM3 = CR-LF-TERM
 15965         COMPUTE CNC-BEN = WE-LFAMT + WE-LFAMT-ALT
 15966         GO TO 4190-EP-DO-LF-COMM.
 15967
 15968     IF CLAS-I-EP (CLAS-INDEXL) = 'T'
 15969         GO TO 4122-EP-DO-LF-CNCL-TEX.
 15970
 15971     IF DTE-CLIENT = 'NCL'
 15972         IF CR-DT LESS THAN 19910101
 15973             GO TO 4121-EP-DO-LF-CNC-BEN.
 15974
 15975     IF CLAS-I-EP (CLAS-INDEXL) = 'N'
 15976         GO TO 4126-EP-DO-LF-CNCL-NP.
 15977
 15978     IF DTE-CLIENT = 'FUL'
 15979         GO TO 4128-EP-DO-LF-CNCL-FUL.
 15980
 15981*    IF STATE-ABBR (CLAS-INDEXS) = 'OH'
 15982     IF (STATE-ABBR (CLAS-INDEXS) = 'OH') AND
 15983        (CR-RATING-CLASS NOT = 'L ')
 15984         IF (CR-APR GREATER THAN ZERO)  AND
 15985            (CR-LF-TERM GREATER THAN 060)  AND
 15986            (CR-DT GREATER THAN 19831031)
 15987              GO TO 4126-EP-DO-LF-CNCL-NP.
 15988
 15989     IF STATE-ABBR (CLAS-INDEXS) = 'MT'
 15990         IF (CR-APR GREATER THAN ZERO)  AND
 15991            (CR-LF-TERM GREATER THAN 061)  AND
 15992            (CR-DT GREATER THAN 19830318)
 15993              GO TO 4126-EP-DO-LF-CNCL-NP.
 15994
 15995     IF STATE-ABBR (CLAS-INDEXS) = 'UT'
 15996         IF (CR-APR GREATER THAN ZERO)  AND
 15997            (CR-LF-TERM GREATER THAN 062)  AND
 15998            (CR-DT GREATER THAN 19810831)  AND
 15999            (CR-DT LESS THAN 19830901)
 16000              GO TO 4126-EP-DO-LF-CNCL-NP.
 16001
 16002     IF STATE-ABBR (CLAS-INDEXS) = 'RI'
 16003         IF (CR-APR GREATER THAN ZERO)  AND
 16004            (CR-LF-TERM GREATER THAN 060)  AND
 16005            (CR-DT GREATER THAN 19831231)
 16006              GO TO 4126-EP-DO-LF-CNCL-NP.
 16007
 16008 4121-EP-DO-LF-CNC-BEN.
 16009
 16010     COMPUTE TEMP-4 ROUNDED EQUAL REM-TRM3 / CR-LF-TERM.
 16011
 16012     COMPUTE TEMP-3 ROUNDED EQUAL
 16013         (WE-LFAMT + WE-LFAMT-ALT) * TEMP-4.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 308
* ECS010T1.cbl
 16014
 16015     MOVE TEMP-3                 TO CNC-BEN.
 16016
 16017     GO TO 4190-EP-DO-LF-COMM.
 16018
 16019 4122-EP-DO-LF-CNCL-TEX.
 16020
 16021     DIVIDE WE-LFAMT BY CR-LF-TERM
 16022         GIVING TEX-FACT-1.
 16023     DIVIDE REM-TRM3 BY CR-PMT-FREQ
 16024         GIVING TEX-FACT-2
 16025             REMAINDER TEX-FACT-3.
 16026     IF TEX-FACT-3 NOT = ZERO
 16027         ADD +1 TO TEX-FACT-2.
 16028
 16029     COMPUTE CNC-BEN = (TEX-FACT-1 * (TEX-FACT-2 * CR-PMT-FREQ)).
 16030
 16031     GO TO 4190-EP-DO-LF-COMM.
 16032
 16033 4124-EP-DO-LF-CNCL-SUM.
 16034
 16035     IF WE-LFRFND = ZERO
 16036         GO TO 4130-EP-DO-LF-EP.
 16037
 16038     MOVE WE-LFRFND TO CNC-PRM.
 16039
 16040     MOVE  'YYYYYYYYYY'           TO  WS-LF-CHARGEBACK-LEVELS.
 16041
 16042     IF WE-LFRFND NOT LESS WE-LFPRM
 16043         MOVE WE-LFAMT TO CNC-BEN
 16044          GO TO 4130-EP-DO-LF-EP.
 16045
 16046
 16047     COMPUTE TEMP-7 ROUNDED = WE-LFAMT * (WE-LFRFND / WE-LFPRM).
 16048
 16049     IF CLAS-I-RL-AH (CLAS-INDEXL) = 'L' OR 'P'
 16050         MOVE TEMP-7 TO CNC-BEN
 16051          GO TO 4130-EP-DO-LF-EP.
 16052
 16053     MOVE CR-LF-CANC-DT TO VALUATION-DT.
 16054     MOVE '4'           TO W-VAL-SOURCE.
 16055     PERFORM 8500-REMAINING-TERM-ROUTINE THRU 8599-REM-TERM-X.
 16056
 16057     IF CLAS-I-EP (CLAS-INDEXL) NOT = 'N'
 16058         COMPUTE CNC-BEN = TEMP-7 * (REM-TRM3 / CR-LF-TERM)
 16059         GO TO 4130-EP-DO-LF-EP.
 16060
 16061 4126-EP-DO-LF-CNCL-NP.
 16062
 16063     IF WE-LFAMT = ZERO
 16064        GO TO 4190-EP-DO-LF-COMM.
 16065
 16066     MOVE CR-DT                      TO  DC-GREG-DATE-CYMD.
 16067     MOVE 'L'                        TO  DC-OPTION-CODE.
 16068     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 16069     MOVE DC-BIN-DATE-1              TO  CP-CERT-EFF-DT.
 16070
 16071     IF CR-LOAN-1ST-PMT-DT NOT = ZEROS
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 309
* ECS010T1.cbl
 16072       MOVE CR-LOAN-1ST-PMT-DT       TO  DC-GREG-DATE-1-YMD
 16073       MOVE '3'                      TO  DC-OPTION-CODE
 16074       PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X
 16075       MOVE DC-BIN-DATE-1            TO  CP-FIRST-PAY-DATE
 16076     ELSE
 16077       MOVE CP-CERT-EFF-DT           TO  DC-BIN-DATE-1
 16078       MOVE '6'                      TO  DC-OPTION-CODE
 16079       MOVE +1                       TO  DC-ELAPSED-MONTHS
 16080       MOVE +0                       TO  DC-ELAPSED-DAYS
 16081       PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X
 16082       MOVE DC-BIN-DATE-2            TO  CP-FIRST-PAY-DATE.
 16083
 16084     MOVE CR-LFAMT                   TO  CP-ORIGINAL-BENEFIT.
 16085     MOVE CR-APR                     TO  CP-LOAN-APR.
 16086     MOVE CR-LF-TERM                 TO  CP-ORIGINAL-TERM.
 16087     MOVE CR-LOAN-TERM               TO  CP-LOAN-TERM.
 16088     MOVE REM-TRM3                   TO  CP-REMAINING-TERM.
 16089     MOVE CLAS-I-CALC-TYPE (CLAS-INDEXL) TO  CP-SPECIAL-CALC-CD.
 16090     MOVE CLAS-I-RL-AH     (CLAS-INDEXL) TO  CP-BENEFIT-TYPE.
 16091     MOVE CLAS-I-EP        (CLAS-INDEXL) TO  CP-EARNING-METHOD.
 16092
 16093     CALL 'ELRAMTX' USING CALCULATION-PASS-AREA.
 16094
 16095     IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'Z'
 16096       COMPUTE CNC-BEN = (CP-REMAMT-FACTOR * (TEMP-7 / +1000))
 16097       GO TO 4130-EP-DO-LF-EP
 16098     ELSE
 16099       COMPUTE CNC-BEN = (CP-REMAMT-FACTOR * (WE-LFAMT / +1000)).
 16100
 16101     GO TO 4190-EP-DO-LF-COMM.
 16102
 16103 4128-EP-DO-LF-CNCL-FUL.
 16104
 16105     IF WE-LFAMT = ZERO
 16106        GO TO 4190-EP-DO-LF-COMM.
 16107
 16108     MOVE CR-APR              TO NP-APR.
 16109     MOVE CR-LF-TERM          TO NP-ORIG.
 16110     MOVE REM-TRM3            TO NP-REM.
 16111     MOVE '2'                 TO NP-OPT.
 16112     MOVE CR-AHPRM            TO NP-AHPRM.
 16113     MOVE CR-ACCOUNT          TO NP-ACCOUNT.
 16114     MOVE CR-LFAMT            TO NP-BENEFIT.
 16115
 16116*    CALL 'FULNETRM'
 16117*        USING NP-APR NP-ORIG NP-REM NP-OPT NP-BENEFIT NP-AHPRM
 16118*              NP-ACCOUNT NP-REMAINING.
 16119
 16120     MOVE NP-REMAINING TO CNC-BEN.
 16121
 16122     GO TO 4190-EP-DO-LF-COMM.
 16123
 16124 4130-EP-DO-LF-EP.
 16125
 16126     MOVE SPACE                  TO STATUTORY-SWITCH.
 16127
 16128     MOVE EOM-RUN-DATE TO VALUATION-DT.
 16129     MOVE '5'           TO W-VAL-SOURCE.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 310
* ECS010T1.cbl
 16130
 16131     IF REIN-EP-FLG = 'R'
 16132       IF REIN-REM-SW (SUB5) = 'I'
 16133           COMPUTE EPR-R78 = WE-LFPRM + WE-LFPRM-ALT
 16134           MOVE EPR-R78             TO EPR-PRO  EPR-ST
 16135           GO TO 4190-EP-DO-LF-COMM.
 16136
 16137     IF REIN-EP-FLG = 'R'
 16138         IF REIN-LF-RUNOFF-SW (SUB5) = 'N'  AND
 16139            EARNING-STOP-DATE LESS THAN VALUATION-DT
 16140             MOVE '*'               TO LIFE-EARNED-SWITCH
 16141             MOVE EARNING-STOP-DATE TO VALUATION-DT
 16142             MOVE '10'              TO W-VAL-SOURCE.
 16143
 16144     PERFORM 8500-REMAINING-TERM-ROUTINE THRU 8599-REM-TERM-X.
 16145
 16146     IF REM-TRM2 GREATER CR-LF-TERM
 16147         MOVE +0 TO EPR-R78  EPR-PRO  EPR-ST
 16148         GO TO 4190-EP-DO-LF-COMM.
 16149
 16150     IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'Z'
 16151         GO TO 4180-EP-DO-LF-EP-SUM.
 16152
 16153     IF CLAS-I-EP (CLAS-INDEXL) = 'B'
 16154         IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'L'
 16155             IF REM-TRM2 NOT GREATER THAN +0
 16156                 COMPUTE EPR-R78 = WE-LFPRM + WE-LFPRM-ALT
 16157                 MOVE EPR-R78 TO EPR-PRO  EPR-ST
 16158                 GO TO 4190-EP-DO-LF-COMM
 16159             ELSE
 16160                 NEXT SENTENCE
 16161         ELSE
 16162             IF W-BAL-REMTRM NOT GREATER +0
 16163                 COMPUTE EPR-R78 = WE-LFPRM + WE-LFPRM-ALT
 16164                 MOVE EPR-R78 TO EPR-PRO  EPR-ST
 16165                 GO TO 4190-EP-DO-LF-COMM
 16166             ELSE
 16167                 NEXT SENTENCE
 16168     ELSE
 16169        IF DTE-CLIENT = 'NCL'  AND
 16170           CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'B'
 16171            MOVE WE-LFPRM TO EPR-R78  EPR-PRO  EPR-ST
 16172        ELSE
 16173         IF REM-TRM2 NOT GREATER +0  OR
 16174            CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'B'
 16175             MOVE WE-LFPRM TO EPR-R78  EPR-PRO  EPR-ST
 16176             GO TO 4190-EP-DO-LF-COMM.
 16177
 16178     MOVE +1 TO ACTIVE-COUNT.
 16179
 16180     IF CLAS-I-EP (CLAS-INDEXL) = 'T'
 16181         GO TO 4140-EP-DO-LF-EP-TEX.
 16182
 16183     IF CLAS-I-EP (CLAS-INDEXL) = 'N'
 16184         GO TO 4150-EP-DO-LF-EP-NP.
 16185
 16186*    IF STATE-ABBR (CLAS-INDEXS) = 'OH'
 16187     IF (STATE-ABBR (CLAS-INDEXS) = 'OH') AND
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 311
* ECS010T1.cbl
 16188        (CR-RATING-CLASS NOT = 'L ')
 16189         IF (CR-APR GREATER THAN ZERO)  AND
 16190            (CR-LF-TERM GREATER THAN 060)  AND
 16191            (CR-DT GREATER THAN 19831031)
 16192             MOVE '*'             TO STATUTORY-SWITCH
 16193              GO TO 4150-EP-DO-LF-EP-NP.
 16194
 16195     IF STATE-ABBR (CLAS-INDEXS) = 'MT'
 16196         IF (CR-APR GREATER THAN ZERO)  AND
 16197            (CR-LF-TERM GREATER THAN 061)  AND
 16198            (CR-DT GREATER THAN 19830318)
 16199             MOVE '*'             TO STATUTORY-SWITCH
 16200              GO TO 4150-EP-DO-LF-EP-NP.
 16201
 16202     IF STATE-ABBR (CLAS-INDEXS) = 'UT'
 16203         IF (CR-APR GREATER THAN ZERO)  AND
 16204            (CR-LF-TERM GREATER THAN 062)  AND
 16205            (CR-DT GREATER THAN 19810831)  AND
 16206            (CR-DT LESS THAN 19830901)
 16207             MOVE '*'             TO STATUTORY-SWITCH
 16208              GO TO 4150-EP-DO-LF-EP-NP.
 16209
 16210     IF STATE-ABBR (CLAS-INDEXS) = 'RI'
 16211         IF (CR-APR GREATER THAN ZERO)  AND
 16212            (CR-LF-TERM GREATER THAN 060)  AND
 16213            (CR-DT GREATER THAN 19831231)
 16214             MOVE '*'             TO STATUTORY-SWITCH
 16215              GO TO 4150-EP-DO-LF-EP-NP.
 16216
 16217     GO TO 4160-EP-DO-LF-EP-R78.
 16218
 16219 4140-EP-DO-LF-EP-TEX.
 16220
 16221     IF CR-PMT-FREQ = 0
 16222       DISPLAY '*************************************'
 16223       DISPLAY '***** CR-PMT-FREQ EQUAL TO ZERO *****'
 16224       DISPLAY '*************************************'
 16225       DISPLAY '***** CR-FULL-CONTROL -->' CR-FULL-CONTROL
 16226       DISPLAY '*************************************'
 16227       COMPUTE TEX-FACT-4 =
 16228          (CR-LF-TERM * CR-LF-TERM) +
 16229                               (WS-CR-PMT-FREQ * CR-LF-TERM)
 16230     ELSE
 16231        COMPUTE TEX-FACT-4 =
 16232         (CR-LF-TERM * CR-LF-TERM) + (CR-PMT-FREQ * CR-LF-TERM).
 16233
 16234     IF CR-PMT-FREQ = 0
 16235       DIVIDE REM-TRM1 BY WS-CR-PMT-FREQ
 16236           GIVING TEX-FACT-5
 16237               REMAINDER TEX-FACT-6
 16238     ELSE
 16239        DIVIDE REM-TRM1 BY CR-PMT-FREQ
 16240            GIVING TEX-FACT-5
 16241                REMAINDER TEX-FACT-6.
 16242
 16243     IF CR-PMT-FREQ > 0
 16244        MOVE CR-PMT-FREQ TO WS-CR-PMT-FREQ.
 16245
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 312
* ECS010T1.cbl
 16246     COMPUTE TEX-FACT-5 = TEX-FACT-5 * CR-PMT-FREQ.
 16247     COMPUTE TEX-FACT-7 = (TEX-FACT-5 * TEX-FACT-5) +
 16248         (TEX-FACT-5 * CR-PMT-FREQ) +
 16249         (2 * (TEX-FACT-6 * (TEX-FACT-5 + CR-PMT-FREQ))).
 16250     COMPUTE TEX-FACT-8 ROUNDED = TEX-FACT-7 / TEX-FACT-4.
 16251
 16252     COMPUTE EPR-R78 ROUNDED = WE-LFPRM - (WE-LFPRM * TEX-FACT-8).
 16253
 16254     GO TO 4170-EP-DO-LF-EP-PRO.
 16255
 16256 4150-EP-DO-LF-EP-NP.
 16257
 16258     IF WE-LFPRM = ZERO
 16259         GO TO 4160-EP-DO-LF-EP-R78.
 16260
 16261     IF DTE-CLIENT = 'CRI'
 16262       IF STATE-ABBR (CLAS-INDEXS) = ('AB' OR 'BC' OR 'MB' OR
 16263             'NS' OR 'ON' OR 'NB' OR 'NF' OR 'QB' OR 'SK' OR 'PE')
 16264           GO TO 4160-EP-DO-LF-EP-R78.
 16265
 16266     IF DTE-CLIENT = 'NCL'
 16267       IF CR-DT LESS THAN 19910101
 16268           GO TO 4160-EP-DO-LF-EP-R78.
 16269
 16270     IF REM-TRM1 = CR-LF-TERM
 16271         MOVE +0 TO EPR-R78  EPR-PRO  EPR-ST
 16272         GO TO 4190-EP-DO-LF-COMM.
 16273
 16274     MOVE CR-APR TO NP-APR.
 16275     MOVE CR-LF-TERM TO NP-ORIG  NP-CAP.
 16276     MOVE REM-TRM1 TO NP-REM.
 16277     MOVE CLAS-I-CALC-TYPE (CLAS-INDEXL) TO NP-OPT.
 16278     IF NP-OPT = 'T' OR 'U' OR 'V' OR 'W' OR 'X'
 16279         MOVE CR-LOAN-TERM TO NP-ORIG.
 16280
 16281     MOVE 'R' TO NP-OPT.
 16282     CALL 'ECSNETRM'
 16283         USING NP-APR NP-ORIG NP-REM NP-OPT NP-CAP NP-FACTOR.
 16284
 16285     COMPUTE EPR-R78 ROUNDED = WE-LFPRM - (NP-FACTOR * WE-LFPRM).
 16286
 16287     IF STATUTORY-REQUIREMENT
 16288         MOVE EPR-R78                TO EPR-ST.
 16289
 16290 4160-EP-DO-LF-EP-R78.
 16291
 16292     IF (CLAS-I-CALC-TYPE (CLAS-INDEXL) EQUAL 'B') AND
 16293        (DTE-CLIENT EQUAL 'NCL')
 16294        IF (CR-CCYY EQUAL EOM-CCYY) AND
 16295           (CR-MO EQUAL EOM-MO)
 16296           MOVE '*'            TO OB-DATE-1-SWITCH
 16297           MOVE EW-REIN-CO     TO WS-OB-REIN-CO (SUB3)
 16298           MOVE LIFE-OVERRIDE-L1 TO WS-OB-LF-AH (SUB3)
 16299           MOVE CR-LFTYP       TO WS-OB-BENEFIT-CODE (SUB3)
 16300           COMPUTE WS-EPR-R78 (SUB3 1) =
 16301                   WS-EPR-R78 (SUB3 1) + (WE-LFPRM * .5)
 16302           GO TO 4190-EP-DO-LF-COMM
 16303        ELSE
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 313
* ECS010T1.cbl
 16304        IF (CR-CCYY EQUAL OB-CCYY (1)) AND
 16305           (CR-MO EQUAL OB-MO (1))
 16306           MOVE '*'            TO OB-DATE-2-SWITCH
 16307           MOVE EW-REIN-CO     TO WS-OB-REIN-CO (SUB3)
 16308           MOVE LIFE-OVERRIDE-L1 TO WS-OB-LF-AH (SUB3)
 16309           MOVE CR-LFTYP       TO WS-OB-BENEFIT-CODE (SUB3)
 16310           COMPUTE WS-EPR-R78 (SUB3 2) =
 16311                   WS-EPR-R78 (SUB3 2) + (WE-LFPRM * .5)
 16312           GO TO 4190-EP-DO-LF-COMM
 16313        ELSE
 16314        IF (CR-CCYY EQUAL OB-CCYY (2)) AND
 16315           (CR-MO EQUAL OB-MO (2))
 16316           MOVE '*'            TO OB-DATE-3-SWITCH
 16317           MOVE EW-REIN-CO     TO WS-OB-REIN-CO (SUB3)
 16318           MOVE LIFE-OVERRIDE-L1 TO WS-OB-LF-AH (SUB3)
 16319           MOVE CR-LFTYP       TO WS-OB-BENEFIT-CODE (SUB3)
 16320           COMPUTE WS-EPR-R78 (SUB3 3) =
 16321                   WS-EPR-R78 (SUB3 3) + (WE-LFPRM * .5)
 16322           GO TO 4190-EP-DO-LF-COMM
 16323        ELSE
 16324           GO TO 4190-EP-DO-LF-COMM.
 16325
 16326     COMPUTE TEMP-1 = CR-LF-TERM * (CR-LF-TERM + 1).
 16327
 16328     IF DTE-R78 = '1'
 16329         COMPUTE TEMP-2 = REM-TRM1 * REM-TRM1
 16330     ELSE
 16331         COMPUTE TEMP-2 = REM-TRM1 * (REM-TRM1 + 1).
 16332
 16333     COMPUTE TEMP-4 ROUNDED EQUAL TEMP-2 / TEMP-1.
 16334
 16335     IF REM-TRM1 GREATER THAN +0
 16336         COMPUTE TEMP-7 ROUNDED EQUAL
 16337             WE-LFPRM - (WE-LFPRM * TEMP-4)
 16338     ELSE
 16339         MOVE WE-LFPRM                TO TEMP-7.
 16340
 16341     IF CLAS-I-EP (CLAS-INDEXL) NOT = 'B'
 16342         MOVE ZEROS                  TO TEMP-8
 16343         GO TO 4165-END-LF-EP-R78.
 16344
 16345     IF EPR-ST = ZEROS
 16346         MOVE TEMP-7                 TO EPR-ST.
 16347
 16348     IF CLAS-I-CALC-TYPE (CLAS-INDEXL) NOT = 'L'
 16349         COMPUTE TEMP-1 = (CR-LF-TERM + 1) * (CR-LF-TERM + 2)
 16350         COMPUTE TEMP-2 = (REM-TRM1 + 1) * (REM-TRM1 + 2)
 16351         IF DTE-R78 = '1'
 16352             COMPUTE TEMP-2 = (REM-TRM1 + 1) * (REM-TRM1 + 1).
 16353
 16354     COMPUTE TEMP-4 ROUNDED EQUAL TEMP-2 / TEMP-1.
 16355
 16356     COMPUTE TEMP-8 ROUNDED =
 16357               WE-LFPRM-ALT - (WE-LFPRM-ALT * TEMP-4).
 16358
 16359 4165-END-LF-EP-R78.
 16360
 16361     IF EPR-R78 = ZEROS
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 314
* ECS010T1.cbl
 16362         COMPUTE EPR-R78 = TEMP-7 + TEMP-8
 16363     ELSE
 16364         COMPUTE EPR-R78 = EPR-R78 + TEMP-8.
 16365
 16366 4170-EP-DO-LF-EP-PRO.
 16367
 16368     IF DTE-CLIENT = 'MIC' OR 'MCC'
 16369         COMPUTE TEMP-5 ROUNDED = (REM-TRM1 - .5) / CR-LF-TERM
 16370     ELSE
 16371         COMPUTE TEMP-5 ROUNDED = REM-TRM1 / CR-LF-TERM.
 16372
 16373     IF REM-TRM1 GREATER THAN +0
 16374         COMPUTE TEMP-7 ROUNDED = WE-LFPRM - (WE-LFPRM * TEMP-5)
 16375     ELSE
 16376         MOVE WE-LFPRM                  TO TEMP-7.
 16377
 16378     IF CLAS-I-EP (CLAS-INDEXL) NOT = 'B'
 16379         MOVE ZEROS                     TO TEMP-8
 16380         GO TO 4175-END-LF-EP-PRO.
 16381
 16382     IF CLAS-I-CALC-TYPE (CLAS-INDEXL) NOT = 'L'
 16383         IF DTE-CLIENT = 'MIC' OR 'MCC'
 16384             COMPUTE TEMP-5 ROUNDED =
 16385                           (REM-TRM1 + .5) / (CR-LF-TERM + 1)
 16386         ELSE
 16387             COMPUTE TEMP-5 ROUNDED =
 16388                           (REM-TRM1 + 1) / (CR-LF-TERM + 1).
 16389
 16390     COMPUTE TEMP-8 ROUNDED =
 16391                   WE-LFPRM-ALT - (WE-LFPRM-ALT * TEMP-5).
 16392
 16393     COMPUTE EPR-ST = EPR-ST + TEMP-8.
 16394
 16395 4175-END-LF-EP-PRO.
 16396
 16397     COMPUTE EPR-PRO = TEMP-7 + TEMP-8.
 16398
 16399     GO TO 4185-EP-DO-LF-STATUTORY.
 16400
 16401 4180-EP-DO-LF-EP-SUM.
 16402
 16403     IF REM-TRM1 NOT GREATER +0
 16404         COMPUTE EPR-R78 = (WE-LFPRM + WE-LFPRM-ALT) - WE-LFRFND
 16405         MOVE EPR-R78 TO EPR-PRO  EPR-ST
 16406         GO TO 4190-EP-DO-LF-COMM.
 16407
 16408     COMPUTE ACTIVE-COUNT = CR-LIVES - CR-SUM-CAN-CNT-ITD.
 16409
 16410     IF WE-LFPRM = ZERO  AND  WE-LFPRM-ALT = ZERO
 16411         MOVE ZEROS                 TO TEMP-7
 16412     ELSE
 16413         COMPUTE TEMP-7 ROUNDED = WE-LFPRM - (WE-LFRFND *
 16414                       (WE-LFPRM / (WE-LFPRM + WE-LFPRM-ALT))).
 16415
 16416     IF TEMP-7 NOT GREATER ZERO
 16417         IF CLAS-I-EP (CLAS-INDEXL) NOT = 'B'
 16418             MOVE ZEROS             TO EPR-R78  EPR-PRO  EPR-ST
 16419             GO TO 4190-EP-DO-LF-COMM
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 315
* ECS010T1.cbl
 16420         ELSE
 16421             MOVE ZEROS             TO TEMP-7.
 16422
 16423     COMPUTE TEMP-1 = CR-LF-TERM * (CR-LF-TERM + 1).
 16424     COMPUTE TEMP-2 = REM-TRM1 * (REM-TRM1 + 1).
 16425     IF DTE-R78 = '1'
 16426         COMPUTE TEMP-2 = REM-TRM1 * REM-TRM1.
 16427
 16428     COMPUTE TEMP-4 ROUNDED = TEMP-2 / TEMP-1.
 16429     COMPUTE TEMP-5 ROUNDED = REM-TRM1 / CR-LF-TERM.
 16430
 16431     COMPUTE EPR-R78 ROUNDED = TEMP-7 - (TEMP-7 * TEMP-4).
 16432
 16433     COMPUTE EPR-PRO ROUNDED = TEMP-7 - (TEMP-7 * TEMP-5).
 16434
 16435     IF CLAS-I-EP (CLAS-INDEXL) NOT = 'B'
 16436         GO TO 4185-EP-DO-LF-STATUTORY.
 16437
 16438     MOVE EPR-R78                  TO EPR-ST.
 16439
 16440     IF WE-LFPRM = ZERO  AND  WE-LFPRM-ALT = ZERO
 16441         MOVE ZEROS                 TO TEMP-8
 16442     ELSE
 16443         COMPUTE TEMP-8 ROUNDED = WE-LFPRM-ALT - (WE-LFRFND *
 16444                     (WE-LFPRM-ALT / (WE-LFPRM + WE-LFPRM-ALT))).
 16445
 16446     IF TEMP-8 NOT GREATER ZERO
 16447         GO TO 4185-EP-DO-LF-STATUTORY.
 16448
 16449     COMPUTE EPR-R78 ROUNDED = EPR-R78 +
 16450                              (TEMP-8 - (TEMP-8 * TEMP-4)).
 16451
 16452     COMPUTE EPR-PRO ROUNDED = EPR-PRO +
 16453                              (TEMP-8 - (TEMP-8 * TEMP-5)).
 16454
 16455     COMPUTE EPR-ST ROUNDED = EPR-ST +
 16456                             (TEMP-8 - (TEMP-8 * TEMP-5)).
 16457
 16458 4185-EP-DO-LF-STATUTORY.
 16459
 16460     IF STATE-ABBR (CLAS-INDEXS) = 'AL'
 16461         MOVE EPR-R78                TO EPR-ST.
 16462     IF STATE-ABBR (CLAS-INDEXS) = 'WY'
 16463         MOVE EPR-PRO                TO EPR-ST.
 16464
 16465     IF EPR-ST NOT = ZEROS
 16466         GO TO 4190-EP-DO-LF-COMM.
 16467
 16468     IF CLAS-I-RL-AH (CLAS-INDEXL) = 'R'
 16469         MOVE EPR-R78                TO EPR-ST
 16470     ELSE
 16471         MOVE EPR-PRO                TO EPR-ST.
 16472
 16473 4190-EP-DO-LF-COMM.
 16474
 16475     MOVE +0 TO SUB1.
 16476     PERFORM 4300-EP-COMM-LOOP THRU 4350-EP-COMM-LOOP-X
 16477         10 TIMES.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 316
* ECS010T1.cbl
 16478
 16479     IF REIN-EP-FLG NOT = 'R'  OR
 16480        CR-POLICY-IS-REIN-ONLY
 16481         MOVE ISS-BEN TO GROSS-ISS-BEN-LF
 16482         MOVE CNC-BEN TO GROSS-CNC-BEN-LF
 16483         MOVE ISS-PRM TO GROSS-ISS-PRM-LF
 16484         MOVE CNC-PRM TO GROSS-CNC-PRM-LF.
 16485
 16486     ADD ISS-BEN TO EW-ISS-BEN.
 16487     ADD GROSS-ISS-BEN-LF TO EW-ISS-BEN-GROSS.
 16488     ADD CNC-BEN TO EW-CNC-BEN.
 16489     ADD GROSS-CNC-BEN-LF TO EW-CNC-BEN-GROSS.
 16490     ADD ISS-PRM TO EW-ISS-PRM.
 16491     ADD GROSS-ISS-PRM-LF TO EW-ISS-PRM-GROSS.
 16492     ADD CNC-PRM TO EW-CNC-PRM.
 16493     ADD GROSS-CNC-PRM-LF TO EW-CNC-PRM-GROSS.
 16494
 16495     COMPUTE EW-EPR-R78 = EW-EPR-R78 + EPR-R78.
 16496     COMPUTE EW-EPR-PRO = EW-EPR-PRO + EPR-PRO.
 16497     COMPUTE EW-EPR-ST  = EW-EPR-ST  + EPR-ST.
 16498
 16499     IF CR-LF-ISS-PREM-TAX NOT NUMERIC
 16500        MOVE +0                  TO CR-LF-ISS-PREM-TAX
 16501     END-IF
 16502     IF CR-LF-CNC-PREM-TAX NOT NUMERIC
 16503        MOVE +0                  TO CR-LF-CNC-PREM-TAX
 16504     END-IF
 16505
 16506     COMPUTE ISS-PRMTAX =
 16507        (ISS-PRM * CR-LF-ISS-PREM-TAX) -
 16508        (CNC-PRM * CR-LF-CNC-PREM-TAX)
 16509
 16510     COMPUTE EW-ISS-PRM-TAX = EW-ISS-PRM-TAX + ISS-PRMTAX
 16511
 16512     IF LIFE-FULLY-EARNED
 16513         COMPUTE EW-EPR-R78-ADJ = EW-EPR-R78-ADJ +
 16514                                            (ISS-PRM - EPR-R78)
 16515         COMPUTE EW-EPR-PRO-ADJ = EW-EPR-PRO-ADJ +
 16516                                            (ISS-PRM - EPR-PRO)
 16517         COMPUTE EW-EPR-ST-ADJ  = EW-EPR-ST-ADJ +
 16518                                            (ISS-PRM - EPR-ST).
 16519
 16520     IF  DTE-OPT-RESERVE-METHOD-AUTH
 16521         IF  REIN-EP-FLG NOT = 'R'
 16522                 OR
 16523             CR-POLICY-IS-REIN-ONLY
 16524             MOVE 'L'      TO W-CLAIM-TYPE
 16525             MOVE EPR-R78  TO W-OPT-R78
 16526             MOVE EPR-PRO  TO W-OPT-PRO
 16527             MOVE EPR-ST   TO W-OPT-ST
 16528             PERFORM 4600-GET-OPT-IBNR THRU 4600-EXIT
 16529             MOVE ZEROS    TO EW-CLM-IBNR
 16530         ELSE
 16531             IF  STOP-LF-DATE LESS THAN EOM-RUN-DATE
 16532                 MOVE 'N'        TO EPEC-LINE-NOT-USED-IND (SUB3)
 16533                 MOVE ZEROS      TO EW-CLM-IBNR
 16534             ELSE
 16535                 MOVE ZEROS      TO EW-CLM-IBNR
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 317
* ECS010T1.cbl
 16536     ELSE
 16537         IF  DTE-CLIENT NOT EQUAL 'ITG'
 16538             ADD WE-DTH-IBNR
 16539                       TO EW-CLM-IBNR
 16540         ELSE
 16541             IF  CLAS-I-BAL (CLAS-INDEXL) = 'B'
 16542                     AND
 16543                 CR-DT GREATER THAN LAST-YRS-DATE
 16544                 COMPUTE  EW-CLM-IBNR
 16545                     = EW-CLM-IBNR + (WE-LFAMT * .0000500).
 16546
 16547     ADD WE-DTH-PAYCUR TO EW-CLM-PAYCUR.
 16548     ADD WE-DTH-FUTRSV TO EW-CLM-FUTRSV.
 16549
 16550 4191-CONTINUE.
 16551
 16552     MOVE 'Y'          TO EW-LEVEL-USED.
 16553
 16554     IF CR-POLICY-UNDERWRITTEN
 16555         MOVE EPEC-WORK       TO EPEC-LEVELS-II (SUB3)
 16556         MOVE EPEC-OPT-WORK-TABLE
 16557                              TO EPEC-UNDW-OPT-DATA-TABLE
 16558     ELSE
 16559         MOVE EPEC-WORK       TO EPEC-LEVELS (SUB3)
 16560         MOVE EPEC-OPT-WORK-TABLE
 16561                              TO EPEC-OPT-DATA-TABLE.
 16562
 16563     GO TO 4200-EP-DO-AH.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 318
* ECS010T1.cbl
 16565 4194-SLOT-INTO-EFFECTED-MONTHS.
 16566
 16567     IF  CR-DT NOT GREATER THAN EOM-DATE (SUBM)
 16568             AND
 16569         CR-LF-EXPIRE-DATE GREATER THAN EOM-DATE (SUBM)
 16570             AND
 16571         (CR-LF-CANC-DT GREATER THAN EOM-DATE (SUBM)
 16572                 OR
 16573          CR-LF-CANC-DT EQUAL ZEROS)
 16574             AND
 16575         (CR-LF-CLAIM-EXIT-DATE GREATER THAN EOM-DATE (SUBM)
 16576                 OR
 16577          CR-LF-CLAIM-EXIT-DATE EQUAL ZEROS)
 16578         MOVE 'Y'                 TO W-TABLE-USED-SW
 16579         IF  CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'Z'
 16580             COMPUTE EPEC-LIFE-CTR (SUB3 SUBM) ROUNDED
 16581                 = EPEC-LIFE-CTR (SUB3 SUBM)
 16582                 + CR-LIVES
 16583         ELSE
 16584             COMPUTE EPEC-LIFE-CTR (SUB3 SUBM)
 16585                 = EPEC-LIFE-CTR (SUB3 SUBM) + 1.
 16586
 16587 4194-EXIT.
 16588     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 319
* ECS010T1.cbl
 16590******************************************************************
 16591***   C A L C U L A T E   A & H   E A R N E D   P R E M I U M  ***
 16592******************************************************************
 16593
 16594 4200-EP-DO-AH.
 16595
 16596*     DISPLAY ' MADE IT TO 4200 '
 16597     MOVE +0                         TO ISS-BEN  EPR-R78
 16598                                        CNC-BEN  EPR-PRO
 16599                                        ISS-PRM  EPR-ST
 16600                                        CNC-PRM
 16601                                        WX-CLM-AMT
 16602                                        WX-CLM-EXP
 16603                                        WX-CLM-CNT
 16604                                        WX-CLM-CRT
 16605                                        WX-ACTIVE-COUNT
 16606                                        ISS-PRMTAX
 16607                                        WX-CNC-CNT.
 16608     MOVE SPACE                      TO A-H-EARNED-SWITCH.
 16609
 16610     IF CR-AHTYP = ZERO
 16611         GO TO 4295-EP-DO-COUNT.
 16612
 16613     IF REIN-EP-FLG = 'R'
 16614         IF REIN-AH-FLG (SUB5) = SPACE
 16615             GO TO 4295-EP-DO-COUNT.
 16616
 16617     MOVE AH-OVERRIDE-L1       TO WE-LF-AH.
 16618     MOVE CR-AHTYP             TO WE-BEN-TYPE.
 16619     PERFORM 4400-EP-FIND-TAB-ENT THRU 4499-EP-FIND-TAB-ENT-X.
 16620
 16621     IF CR-POLICY-IS-DECLINED  OR
 16622        CR-POLICY-IS-VOID
 16623         GO TO 4290-CONTINUE.
 16624
 16625     MOVE CR-AH-TERM           TO ORIG-TERM.
 16626
 16627     IF CR-DT GREATER EW-COV-DTE
 16628         MOVE CR-DT            TO EW-COV-DTE.
 16629
 16630     IF NOT CR-POLICY-IS-RESTORE  AND
 16631        NOT CR-POLICY-IS-REISSUE
 16632        AND NOT CR-POLICY-IS-MONTHLY
 16633         MOVE WE-AHAMT         TO ISS-BEN
 16634         COMPUTE EW-ORIG-TERM = EW-ORIG-TERM + ORIG-TERM
 16635         COMPUTE EW-AGE = EW-AGE + CR-AGE
 16636         COMPUTE EW-AGE-BEN = EW-AGE-BEN + (CR-AGE * ISS-BEN)
 16637         COMPUTE EW-TERM-BEN = EW-TERM-BEN +
 16638                                   (ORIG-TERM * ISS-BEN).
 16639
 16640     MOVE CLAS-INDEXA     TO W-NDX.
 16641     MOVE RUN-DATE        TO VALUATION-DT
 16642     MOVE '6'             TO W-VAL-SOURCE.
 16643
 16644     IF REIN-EP-FLG = 'R'
 16645         IF REIN-AH-RUNOFF-SW (SUB5) = 'N'  AND
 16646            EARNING-STOP-DATE LESS THAN VALUATION-DT
 16647             MOVE EARNING-STOP-DATE TO VALUATION-DT
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 320
* ECS010T1.cbl
 16648             MOVE '10'              TO W-VAL-SOURCE.
 16649
 16650*     DISPLAY ' B4 RTRM'
 16651     PERFORM 8500-REMAINING-TERM-ROUTINE THRU 8599-REM-TERM-X.
 16652*     DISPLAY ' AFTER RTRM'
 16653
 16654     IF (CR-AH-CURRENT-STATUS = '1' OR '4') AND
 16655        (REM-TRM3 GREATER ZERO)
 16656        IF CLAS-I-CALC-TYPE (CLAS-INDEXA) = 'Z'
 16657            COMPUTE EW-INFORCE-CNT = EW-INFORCE-CNT +
 16658                                  (CR-LIVES - CR-SUM-CAN-CNT-ITD)
 16659            COMPUTE EW-REM-TERM = EW-REM-TERM +
 16660                     (REM-TRM3 * (CR-LIVES - CR-SUM-CAN-CNT-ITD))
 16661          ELSE
 16662            COMPUTE EW-INFORCE-CNT = EW-INFORCE-CNT + 1
 16663            COMPUTE EW-REM-TERM = EW-REM-TERM + REM-TRM3.
 16664
 16665     IF  DTE-OPT-RESERVE-METHOD-UNAUTH
 16666         GO TO 4210-BY-OPT-LOGIC.
 16667
 16668     IF  CR-DT NOT GREATER THAN EOM-DATE (13)
 16669             AND
 16670         CR-AH-EXPIRE-DATE GREATER THAN EOM-DATE (1)
 16671             AND
 16672         (CR-AH-CANC-DT GREATER THAN EOM-DATE (1)
 16673                 OR
 16674          CR-AH-CANC-DT EQUAL ZEROS)
 16675         MOVE 'Y'                TO EPEC-LIFE-CTR-USED-IND (SUB3)
 16676         PERFORM 4296-SLOT-INTO-EFFECTED-MONTHS THRU 4296-EXIT
 16677                 VARYING
 16678             SUBM FROM +1 BY +1
 16679                 UNTIL
 16680             SUBM GREATER THAN +13.
 16681
 16682     MOVE EW-SUB-KEY             TO EPEC-SUB-KEY-OPT (SUB3).
 16683     MOVE EW-REIN-CO             TO EPEC-REIN-CO-OPT (SUB3).
 16684
 16685 4210-BY-OPT-LOGIC.
 16686
 16687     IF CLAS-I-CALC-TYPE (CLAS-INDEXA) = 'Z'
 16688         ADD CR-LIVES TO EW-ISS-CNT
 16689         MOVE WE-AHPRM TO ISS-PRM
 16690         COMPUTE EW-ORIG-TERM = EW-ORIG-TERM +
 16691                                (ORIG-TERM * CR-LIVES)
 16692         COMPUTE EW-AGE = EW-AGE + (CR-AGE * CR-LIVES)
 16693         COMPUTE EW-AGE-BEN = EW-AGE-BEN + (CR-AGE * ISS-BEN)
 16694         COMPUTE EW-TERM-BEN = EW-TERM-BEN +
 16695                                   (ORIG-TERM * ISS-BEN)
 16696         PERFORM 4825-EP-DO-AH-CNCL-SUM THRU 4899-EXIT
 16697         GO TO 4225-CONTINUE.
 16698
 16699     IF (NOT CR-POLICY-IS-RESTORE) AND
 16700        (NOT CR-POLICY-IS-REISSUE)
 16701        AND (NOT CR-POLICY-IS-MONTHLY)
 16702        ADD +1 TO EW-ISS-CNT.
 16703
 16704     PERFORM 4800-CALC-EARNED-PREMIUM-AH THRU 4899-EXIT.
 16705
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 321
* ECS010T1.cbl
 16706 4225-CONTINUE.
 16707
 16708*     DISPLAY ' 4225 '
 16709     IF  EPEC-CLM-EXP (SUB3)  NUMERIC
 16710         NEXT  SENTENCE
 16711       ELSE
 16712         MOVE ZEROS TO EPEC-CLM-EXP (SUB3).
 16713
 16714     ADD WX-CLM-AMT              TO EW-CLM-AMT.
 16715     ADD WX-CLM-EXP              TO EPEC-CLM-EXP (SUB3).
 16716     ADD WX-CLM-CNT              TO EW-CLM-CNT.
 16717     ADD WX-CLM-CRT              TO EW-CLM-CRT.
 16718     ADD WX-ACTIVE-COUNT         TO ACTIVE-COUNT.
 16719     ADD WX-CNC-CNT              TO EW-CNC-CNT.
 16720
 16721     MOVE +0           TO SUB1.
 16722     PERFORM 4300-EP-COMM-LOOP THRU 4350-EP-COMM-LOOP-X
 16723         10 TIMES.
 16724     MOVE +0                     TO SUB16
 16725     PERFORM 4375-EP-BANK-COMM   THRU 4375-EXIT VARYING
 16726        WS-SUB1 FROM +1 BY +1 UNTIL WS-SUB1 > +10
 16727
 16728     IF REIN-EP-FLG NOT = 'R'  OR
 16729        CR-POLICY-IS-REIN-ONLY
 16730         MOVE ISS-BEN TO GROSS-ISS-BEN-AH
 16731         MOVE CNC-BEN TO GROSS-CNC-BEN-AH
 16732         MOVE ISS-PRM TO GROSS-ISS-PRM-AH
 16733         MOVE CNC-PRM TO GROSS-CNC-PRM-AH.
 16734
 16735     ADD ISS-BEN TO EW-ISS-BEN.
 16736     ADD GROSS-ISS-BEN-AH TO EW-ISS-BEN-GROSS.
 16737     ADD CNC-BEN TO EW-CNC-BEN.
 16738     ADD GROSS-CNC-BEN-AH TO EW-CNC-BEN-GROSS.
 16739     ADD ISS-PRM TO EW-ISS-PRM.
 16740     ADD GROSS-ISS-PRM-AH TO EW-ISS-PRM-GROSS.
 16741     ADD CNC-PRM TO EW-CNC-PRM.
 16742     ADD GROSS-CNC-PRM-AH TO EW-CNC-PRM-GROSS.
 16743
 16744     COMPUTE EW-EPR-R78 = EW-EPR-R78 + EPR-R78.
 16745     COMPUTE EW-EPR-PRO = EW-EPR-PRO + EPR-PRO.
 16746     COMPUTE EW-EPR-ST  = EW-EPR-ST  + EPR-ST.
 16747
 16748     IF CR-AH-ISS-PREM-TAX NOT NUMERIC
 16749        MOVE ZEROS               TO CR-AH-ISS-PREM-TAX
 16750     END-IF
 16751     IF CR-AH-CNC-PREM-TAX NOT NUMERIC
 16752        MOVE ZEROS               TO CR-AH-CNC-PREM-TAX
 16753     END-IF
 16754     COMPUTE ISS-PRMTAX =
 16755        (ISS-PRM * CR-AH-ISS-PREM-TAX) -
 16756        (CNC-PRM * CR-AH-CNC-PREM-TAX)
 16757     COMPUTE EW-ISS-PRM-TAX = EW-ISS-PRM-TAX + ISS-PRMTAX
 16758
 16759     IF A-H-FULLY-EARNED
 16760         COMPUTE EW-EPR-R78-ADJ = EW-EPR-R78-ADJ +
 16761                                            (ISS-PRM - EPR-R78)
 16762         COMPUTE EW-EPR-PRO-ADJ = EW-EPR-PRO-ADJ +
 16763                                            (ISS-PRM - EPR-PRO)
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 322
* ECS010T1.cbl
 16764         COMPUTE EW-EPR-ST-ADJ  = EW-EPR-ST-ADJ +
 16765                                            (ISS-PRM - EPR-ST).
 16766
 16767     IF  DTE-OPT-RESERVE-METHOD-AUTH
 16768         IF  REIN-EP-FLG NOT = 'R'
 16769                 OR
 16770             CR-POLICY-IS-REIN-ONLY
 16771             MOVE 'A'      TO W-CLAIM-TYPE
 16772             MOVE EPR-R78  TO W-OPT-R78
 16773             MOVE EPR-PRO  TO W-OPT-PRO
 16774             MOVE EPR-ST   TO W-OPT-ST
 16775             PERFORM 4600-GET-OPT-IBNR THRU 4600-EXIT
 16776             MOVE ZEROS    TO EW-CLM-IBNR
 16777         ELSE
 16778             IF  STOP-AH-DATE LESS THAN EOM-RUN-DATE
 16779                 MOVE 'N'   TO EPEC-LINE-NOT-USED-IND (SUB3)
 16780                 MOVE ZEROS TO EW-CLM-IBNR
 16781             ELSE
 16782                 MOVE ZEROS TO EW-CLM-IBNR
 16783     ELSE
 16784         IF  DTE-CLIENT NOT EQUAL 'ITG'
 16785             ADD WE-DIS-IBNR     TO EW-CLM-IBNR
 16786         ELSE
 16787             IF  CLAS-I-BAL (CLAS-INDEXA) NOT EQUAL 'B'
 16788                 IF  CR-AH-POLICY-IS-ACTIVE
 16789                     COMPUTE  EW-CLM-IBNR  =  EW-CLM-IBNR
 16790                              + ((WE-AHPRM - EPR-PRO) * .0730000)
 16791                 ELSE
 16792                     NEXT SENTENCE
 16793             ELSE
 16794                 IF  CR-DT GREATER THAN LAST-YRS-DATE
 16795                     COMPUTE  EW-CLM-IBNR
 16796                         = EW-CLM-IBNR + (WE-AHPRM * .0600000).
 16797
 16798     ADD WE-DIS-PAYCUR TO EW-CLM-PAYCUR.
 16799     ADD WE-DIS-FUTRSV TO EW-CLM-FUTRSV.
 16800
 16801 4290-CONTINUE.
 16802*     DISPLAY ' 4290 '
 16803
 16804     MOVE 'Y'          TO EW-LEVEL-USED.
 16805
 16806     IF CR-POLICY-UNDERWRITTEN
 16807         MOVE EPEC-WORK       TO EPEC-LEVELS-II (SUB3)
 16808         MOVE EPEC-OPT-WORK-TABLE
 16809                              TO EPEC-UNDW-OPT-DATA-TABLE
 16810     ELSE
 16811         MOVE EPEC-WORK       TO EPEC-LEVELS (SUB3)
 16812         MOVE EPEC-OPT-WORK-TABLE
 16813                              TO EPEC-OPT-DATA-TABLE.
 16814
 16815
 16816 4295-EP-DO-COUNT.
 16817
 16818     IF REIN-EP-FLG = 'R'
 16819         ADD ACTIVE-COUNT TO BC-R-A-CERTS
 16820     ELSE
 16821         ADD ACTIVE-COUNT TO BC-G-A-CERTS.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 323
* ECS010T1.cbl
 16822
 16823     GO TO 4299-EPBX.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 324
* ECS010T1.cbl
 16825 4296-SLOT-INTO-EFFECTED-MONTHS.
 16826
 16827     IF  CR-DT NOT GREATER THAN EOM-DATE (SUBM)
 16828             AND
 16829         CR-AH-EXPIRE-DATE GREATER THAN EOM-DATE (SUBM)
 16830             AND
 16831         (CR-AH-CANC-DT GREATER THAN EOM-DATE (SUBM)
 16832                 OR
 16833          CR-AH-CANC-DT EQUAL ZEROS)
 16834         MOVE 'Y'                 TO W-TABLE-USED-SW
 16835         IF  CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'Z'
 16836             COMPUTE EPEC-LIFE-CTR (SUB3 SUBM) ROUNDED
 16837                 = EPEC-LIFE-CTR (SUB3 SUBM)
 16838                 + CR-LIVES
 16839         ELSE
 16840             COMPUTE EPEC-LIFE-CTR (SUB3 SUBM)
 16841                 = EPEC-LIFE-CTR (SUB3 SUBM) + 1.
 16842
 16843 4296-EXIT.
 16844     EXIT.
 16845
 16846 4299-EPBX.
 16847     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 325
* ECS010T1.cbl
 16849******************************************************************
 16850***    C A L C U L A T E   E A R N E D   C O M M I S S I O N   ***
 16851******************************************************************
 16852
 16853 4300-EP-COMM-LOOP.
 16854*     DISPLAY ' 4300 '
 16855     IF DTE-CLIENT = 'DMD'
 16856         GO TO 4350-EP-COMM-LOOP-X.
 16857
 16858     ADD +1                         TO SUB1.
 16859     MOVE ZEROS                     TO SUB16.
 16860
 16861     IF CR-ADDL-CLP NOT NUMERIC
 16862        MOVE ZEROS               TO CR-ADDL-CLP
 16863     END-IF
 16864     IF CR-COM-AGT (SUB1) = SPACES OR ZEROS
 16865         GO TO 4350-EP-COMM-LOOP-X.
 16866
 16867 4300-AGENT-LOOP.
 16868
 16869     ADD +1                         TO SUB16.
 16870
 16871     IF SUB16 GREATER THAN WS-LOOP-MAX
 16872         DISPLAY 'ERROR OCCURRED - MAXIMUM AGENT LEVELS EXCEEDED'
 16873         DISPLAY 'CONTROL= ' CR-FULL-CONTROL
 16874         MOVE 'ERR0R OCCURRED - MAXIMUM AGENT LEVELS EXCEEDED'
 16875                                     TO WS-ABEND-MESSAGE
 16876         MOVE DC-ERROR-CODE          TO WS-ABEND-FILE-STATUS
 16877         MOVE 4001                   TO WS-ABEND-CODE
 16878         GO TO ABEND-PGM.
 16879
 16880     IF EW-AGT-NO (SUB16) = SPACES
 16881         MOVE CR-COM-AGT  (SUB1)     TO EW-AGT-NO   (SUB16)
 16882         MOVE CR-AGT-TYPE (SUB1)     TO EW-AGT-TYPE (SUB16)
 16883     ELSE
 16884         IF (CR-COM-AGT (SUB1)  = EW-AGT-NO   (SUB16)) AND
 16885            (CR-AGT-TYPE (SUB1) = EW-AGT-TYPE (SUB16))
 16886             NEXT SENTENCE
 16887         ELSE
 16888             GO TO 4300-AGENT-LOOP.
 16889
 16890     IF EW-LF-AH = AH-OVERRIDE-L1
 16891         GO TO 4350-EP-COMM-LOOP-A.
 16892
 16893     IF (DTE-CLIENT = 'DCC')
 16894        AND (REIN-EP-FLG = 'R')
 16895        AND (CR-AGT-TYPE (SUB1) = 'P' OR 'T')
 16896        AND (WE-LFPRM NOT = ZEROS)
 16897        COMPUTE WS-CEDE-FACT = RWF-LFAMT /
 16898            (CR-LFAMT + CR-LFAMT-ALT)
 16899*       COMPUTE ISS-WK ROUNDED = ((WE-LFPRM + WE-LFPRM-ALT)
 16900        COMPUTE ISS-WK ROUNDED = ((CR-LFPRM + CR-LFPRM-ALT)
 16901           * WS-CEDE-FACT) * CR-LCOM-L (SUB1)
 16902     ELSE
 16903        IF CR-AGT-TYPE (SUB1) = 'B' OR 'I' OR 'K' OR 'L'
 16904                             OR 'J'
 16905           COMPUTE ISS-WK = CR-LCOM-L (SUB1) * +1000
 16906        ELSE
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 326
* ECS010T1.cbl
 16907           COMPUTE ISS-WK  ROUNDED = ISS-PRM * CR-LCOM-L (SUB1)
 16908        END-IF
 16909     END-IF
 16910
 16911     COMPUTE EW-ISS-COM (SUB16) = EW-ISS-COM (SUB16) + ISS-WK.
 16912
 16913     MOVE ZEROS                  TO CNC-WK
 16914                                    CNC-FACT
 16915     IF DTE-CLIENT EQUAL 'XXX'
 16916         IF NOT CR-NO-LF-CHARGEBACK
 16917            COMPUTE CNC-WK  ROUNDED = CNC-PRM * CR-LCOM-L (SUB1)
 16918            COMPUTE EW-CNC-COM (SUB16) = EW-CNC-COM (SUB16)
 16919                                + CNC-WK
 16920            GO TO 4300-CONTINUE-LOOP.
 16921
 16922
 16923     IF (WS-LEVELS-CHARGEBACK-SWITCHES = SPACES) OR
 16924        (WS-LF-CHARGEBACK-SW (SUB1) EQUAL 'Y')
 16925*       IF (CR-AGT-TYPE (SUB1) = 'K')
 16926*          AND (CNC-PRM > +0)
 16927*          COMPUTE CNC-WK = CR-LCOM-L (SUB1) * +1000
 16928*       ELSE
 16929        IF (CR-AGT-TYPE (SUB1) = 'B' OR 'I'
 16930                              OR 'L' OR 'J' OR 'K')
 16931           AND (CNC-PRM > +0)
 16932           COMPUTE CNC-FACT = CNC-PRM / ISS-PRM
 16933           COMPUTE CNC-WK = CNC-FACT *
 16934              (CR-LCOM-L (SUB1) * +1000)
 16935        ELSE
 16936           IF (CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'G' OR 'L')
 16937              AND (CR-AGT-TYPE (SUB1) = 'C' OR 'D')
 16938              COMPUTE CNC-FACT = CNC-PRM / ISS-PRM
 16939              COMPUTE CNC-WK = CNC-FACT *
 16940                 (CR-AHPRM - (CR-LFPRM-ALT
 16941                 + CR-ADDL-CLP))
 16942           ELSE
 16943              COMPUTE CNC-WK  ROUNDED =
 16944                 CNC-PRM * CR-LCOM-L (SUB1)
 16945           END-IF
 16946        END-IF
 16947*       END-IF
 16948        COMPUTE EW-CNC-COM (SUB16) =
 16949                                  EW-CNC-COM (SUB16) + CNC-WK
 16950     END-IF
 16951     .
 16952 4300-CONTINUE-LOOP.
 16953
 16954*     DISPLAY ' 4300 CONTINUE '
 16955     IF ((ISS-PRM - CNC-PRM) = ZEROS)
 16956               OR
 16957        ((ISS-WK - CNC-WK) = ZEROS)
 16958        MOVE ZEROS              TO COMM-WK
 16959     ELSE
 16960        COMPUTE COMM-WK ROUNDED = EPR-R78 /
 16961        (ISS-PRM - CNC-PRM) * (ISS-WK - CNC-WK)
 16962     END-IF
 16963
 16964     COMPUTE EW-ECR-R78 (SUB16) = EW-ECR-R78 (SUB16) + COMM-WK.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 327
* ECS010T1.cbl
 16965
 16966     IF ((ISS-PRM - CNC-PRM) = ZEROS)
 16967               OR
 16968        ((ISS-WK - CNC-WK) = ZEROS)
 16969        MOVE ZEROS              TO COMM-WK
 16970     ELSE
 16971        COMPUTE COMM-WK ROUNDED = EPR-PRO /
 16972        (ISS-PRM - CNC-PRM) * (ISS-WK - CNC-WK)
 16973     END-IF
 16974     COMPUTE EW-ECR-PRO (SUB16) = EW-ECR-PRO (SUB16) + COMM-WK.
 16975
 16976     IF ((ISS-PRM - CNC-PRM) = ZEROS)
 16977               OR
 16978        ((ISS-WK - CNC-WK) = ZEROS)
 16979        MOVE ZEROS              TO COMM-WK
 16980     ELSE
 16981        COMPUTE COMM-WK ROUNDED = EPR-ST /
 16982        (ISS-PRM - CNC-PRM) * (ISS-WK - CNC-WK)
 16983     END-IF
 16984
 16985     COMPUTE EW-ECR-ST (SUB16) = EW-ECR-ST (SUB16) + COMM-WK.
 16986
 16987     IF LIFE-FULLY-EARNED
 16988         COMPUTE COMM-WK ROUNDED = (ISS-PRM - EPR-R78) *
 16989                                                CR-LCOM-L (SUB1)
 16990         COMPUTE EW-ECR-R78-ADJ (SUB16) =
 16991                               EW-ECR-R78-ADJ (SUB16) + COMM-WK
 16992         COMPUTE COMM-WK ROUNDED = (ISS-PRM - EPR-PRO) *
 16993                                                CR-LCOM-L (SUB1)
 16994         COMPUTE EW-ECR-PRO-ADJ (SUB16) =
 16995                               EW-ECR-PRO-ADJ (SUB16) + COMM-WK.
 16996
 16997     GO TO 4350-EP-COMM-LOOP-X.
 16998
 16999 4350-EP-COMM-LOOP-A.
 17000
 17001     IF (DTE-CLIENT = 'DCC')
 17002        AND (REIN-EP-FLG = 'R')
 17003        AND (CR-AGT-TYPE (SUB1) = 'P' OR 'T')
 17004        AND (WE-AHPRM NOT = ZEROS)
 17005        COMPUTE WS-CEDE-FACT = RWF-AHAMT / CR-AHAMT
 17006        COMPUTE ISS-WK ROUNDED = (CR-AHPRM * WS-CEDE-FACT)
 17007*       COMPUTE ISS-WK ROUNDED = (WE-AHPRM * WS-CEDE-FACT)
 17008           * CR-LCOM-AH (SUB1)
 17009     ELSE
 17010        IF CR-AGT-TYPE (SUB1) = 'B' OR 'I' OR 'K' OR 'L' OR 'J'
 17011           COMPUTE ISS-WK = CR-LCOM-AH (SUB1) * +1000
 17012        ELSE
 17013           IF (CR-AGT-TYPE (SUB1) = 'D' OR 'C')
 17014             AND (CLAS-I-BEN-CATEGORY (CLAS-INDEXA)) = 'G' OR 'L'
 17015              COMPUTE ISS-WK = CR-AHPRM - (CR-LFPRM-ALT
 17016              + CR-ADDL-CLP)
 17017           ELSE
 17018              IF (CR-AGT-TYPE (SUB1) = 'M')
 17019                 AND (CLAS-I-BEN-CATEGORY (CLAS-INDEXA)
 17020                              = 'G' OR 'L')
 17021                 COMPUTE ISS-WK ROUNDED =
 17022                    CR-LFPRM-ALT * CR-LCOM-AH (SUB1)
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 328
* ECS010T1.cbl
 17023              ELSE
 17024                 COMPUTE ISS-WK  ROUNDED =
 17025                    ISS-PRM * CR-LCOM-AH (SUB1)
 17026              END-IF
 17027           END-IF
 17028        END-IF
 17029     END-IF
 17030
 17031     COMPUTE EW-ISS-COM (SUB16) =
 17032             EW-ISS-COM (SUB16) + ISS-WK.
 17033
 17034     MOVE ZEROS                  TO CNC-WK
 17035     IF DTE-CLIENT EQUAL 'XXX'
 17036         IF NOT CR-NO-LF-CHARGEBACK
 17037           COMPUTE CNC-WK  ROUNDED = CNC-PRM * CR-LCOM-AH (SUB1)
 17038           COMPUTE EW-CNC-COM (SUB16) =
 17039                   EW-CNC-COM (SUB16) + CNC-WK
 17040           GO TO 4300-CONTINUE-LOOP-AH.
 17041
 17042
 17043     IF (WS-LEVELS-CHARGEBACK-SWITCHES = SPACES) OR
 17044        (WS-AH-CHARGEBACK-SW (SUB1) EQUAL 'Y')
 17045      IF (DTE-CLIENT = 'DCC')
 17046         AND (REIN-EP-FLG = 'R')
 17047         AND (CR-AGT-TYPE (SUB1) = 'P' OR 'T')
 17048         AND (WE-AHRFND NOT = ZEROS)
 17049         COMPUTE WS-CEDE-FACT = RWF-AHAMT / CR-AHAMT
 17050         COMPUTE CNC-WK ROUNDED = (CR-AHRFND * WS-CEDE-FACT)
 17051            * CR-LCOM-AH (SUB1)
 17052      ELSE
 17053*       IF (CR-AGT-TYPE (SUB1) = 'K')
 17054*          AND (CNC-PRM > +0)
 17055*          COMPUTE CNC-WK = CR-LCOM-AH (SUB1) * +1000
 17056*       ELSE
 17057        IF (CR-AGT-TYPE (SUB1) = 'B' OR 'I'
 17058                              OR 'L' OR 'J' OR 'K')
 17059           AND (CNC-PRM > +0)
 17060           COMPUTE CNC-FACT = CNC-PRM / ISS-PRM
 17061           COMPUTE CNC-WK = CNC-FACT *
 17062              (CR-LCOM-AH (SUB1) * +1000)
 17063        ELSE
 17064           IF (CR-AGT-TYPE (SUB1) = 'M')
 17065              AND (CLAS-I-BEN-CATEGORY (CLAS-INDEXA)
 17066                              = 'G' OR 'L')
 17067              COMPUTE CNC-FACT = CR-AHRFND / CR-AHPRM
 17068              COMPUTE CNC-WK = CNC-FACT *
 17069                 (CR-LFPRM-ALT * CR-LCOM-AH (SUB1))
 17070           ELSE
 17071              IF CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'G' OR 'L'
 17072                 COMPUTE CNC-FACT = CR-AHRFND / CR-AHPRM
 17073                 COMPUTE CNC-WK = CNC-FACT *
 17074                 (CR-AHPRM - (CR-LFPRM-ALT
 17075                    + CR-ADDL-CLP))
 17076              ELSE
 17077                 COMPUTE CNC-WK  ROUNDED =
 17078                    CNC-PRM * CR-LCOM-AH (SUB1)
 17079              END-IF
 17080           END-IF
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 329
* ECS010T1.cbl
 17081        END-IF
 17082*       END-IF
 17083      END-IF
 17084        COMPUTE EW-CNC-COM (SUB16) =
 17085           EW-CNC-COM (SUB16) + CNC-WK
 17086     END-IF
 17087
 17088     .
 17089 4300-CONTINUE-LOOP-AH.
 17090
 17091*     DISPLAY ' 4300-CONTINUE-LOOP-AH '
 17092     IF ((ISS-PRM - CNC-PRM) = ZEROS)
 17093                OR
 17094        ((ISS-WK - CNC-WK) = ZEROS)
 17095        MOVE ZEROS          TO COMM-WK
 17096     ELSE
 17097        COMPUTE COMM-WK ROUNDED = EPR-R78 /
 17098        (ISS-PRM - CNC-PRM) * (ISS-WK - CNC-WK)
 17099     END-IF
 17100
 17101     COMPUTE EW-ECR-R78 (SUB16) = EW-ECR-R78 (SUB16) + COMM-WK.
 17102
 17103     IF ((ISS-PRM - CNC-PRM) = ZEROS)
 17104                OR
 17105        ((ISS-WK - CNC-WK) = ZEROS)
 17106        MOVE ZEROS          TO COMM-WK
 17107     ELSE
 17108        COMPUTE COMM-WK ROUNDED = EPR-PRO /
 17109        (ISS-PRM - CNC-PRM) * (ISS-WK - CNC-WK)
 17110     END-IF
 17111
 17112     COMPUTE EW-ECR-PRO (SUB16) = EW-ECR-PRO (SUB16) + COMM-WK.
 17113
 17114     IF ((ISS-PRM - CNC-PRM) = ZEROS)
 17115                OR
 17116        ((ISS-WK - CNC-WK) = ZEROS)
 17117        MOVE ZEROS          TO COMM-WK
 17118     ELSE
 17119        COMPUTE COMM-WK ROUNDED = EPR-ST  /
 17120        (ISS-PRM - CNC-PRM) * (ISS-WK - CNC-WK)
 17121     END-IF
 17122
 17123     COMPUTE EW-ECR-ST (SUB16) = EW-ECR-ST (SUB16) + COMM-WK.
 17124
 17125     IF A-H-FULLY-EARNED
 17126         COMPUTE COMM-WK ROUNDED = (ISS-PRM - EPR-R78) *
 17127                                                CR-LCOM-AH (SUB1)
 17128         COMPUTE EW-ECR-R78-ADJ (SUB16) =
 17129                               EW-ECR-R78-ADJ (SUB16) + COMM-WK
 17130         COMPUTE COMM-WK ROUNDED = (ISS-PRM - EPR-PRO) *
 17131                                                CR-LCOM-AH (SUB1)
 17132         COMPUTE EW-ECR-PRO-ADJ (SUB16) =
 17133                               EW-ECR-PRO-ADJ (SUB16) + COMM-WK.
 17134
 17135 4350-EP-COMM-LOOP-X.
 17136     EXIT.
 17137
 17138
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 330
* ECS010T1.cbl
 17139
 17140
 17141******************************************************************
 17142***    C A L C U L A T E   E A R N E D  BANK COMMISSION        ***
 17143******************************************************************
 17144
 17145 4375-EP-BANK-COMM.
 17146*     DISPLAY ' 4375 '
 17147
 17148     IF CS-AGT (SUB1) = SPACES OR ZEROS
 17149        GO TO 4375-EXIT
 17150     END-IF
 17151     .
 17152 4375-BANK-LOOP.
 17153
 17154     ADD +1                      TO SUB16
 17155
 17156     IF EW-LF-AH NOT = AH-OVERRIDE-L1
 17157        GO TO 4375-EXIT
 17158     END-IF
 17159
 17160     IF SUB16 GREATER THAN WS-LOOP-MAX
 17161         DISPLAY 'ERROR OCCURRED - MAXIMUM BANK  LEVELS EXCEEDED'
 17162         DISPLAY 'CONTROL= ' CR-FULL-CONTROL
 17163         MOVE 'ERR0R OCCURRED - MAXIMUM AGENT LEVELS EXCEEDED'
 17164                                     TO WS-ABEND-MESSAGE
 17165         MOVE DC-ERROR-CODE          TO WS-ABEND-FILE-STATUS
 17166         MOVE 4001                   TO WS-ABEND-CODE
 17167         PERFORM ABEND-PGM
 17168     END-IF
 17169
 17170     IF EW-AGT-NO (SUB16) = SPACES
 17171        MOVE CS-AGT (SUB1)       TO EW-AGT-NO   (SUB16)
 17172        MOVE CS-COM-TYP (SUB1)   TO EW-AGT-TYPE (SUB16)
 17173     ELSE
 17174        IF (CS-AGT (SUB1) = EW-AGT-NO   (SUB16)) AND
 17175           (CS-COM-TYP (SUB1) = EW-AGT-TYPE (SUB16))
 17176           CONTINUE
 17177        ELSE
 17178           GO TO 4375-BANK-LOOP
 17179        END-IF
 17180     END-IF
 17181
 17182     IF CS-COM-TYP  (SUB1) = 'B'
 17183        MOVE CS-SPP-FEES (SUB1)  TO ISS-WK
 17184     END-IF
 17185
 17186     COMPUTE EW-ISS-COM (SUB16) = EW-ISS-COM (SUB16) + ISS-WK.
 17187
 17188     MOVE ZEROS                  TO CNC-WK
 17189                                    CNC-FACT
 17190
 17191     IF (CS-COM-TYP (SUB1) = 'B')
 17192        AND (CNC-PRM > +0)
 17193        COMPUTE CNC-FACT = CNC-PRM / ISS-PRM
 17194        COMPUTE CNC-WK = CNC-FACT * CS-SPP-FEES (SUB1)
 17195     END-IF
 17196
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 331
* ECS010T1.cbl
 17197     COMPUTE EW-CNC-COM (SUB16) =
 17198                  EW-CNC-COM (SUB16) + CNC-WK
 17199
 17200     IF ((ISS-PRM - CNC-PRM) = ZEROS)
 17201                OR
 17202        ((ISS-WK - CNC-WK) = ZEROS)
 17203        MOVE ZEROS          TO COMM-WK
 17204     ELSE
 17205        COMPUTE COMM-WK ROUNDED = EPR-R78 /
 17206        (ISS-PRM - CNC-PRM) * (ISS-WK - CNC-WK)
 17207     END-IF
 17208
 17209     COMPUTE EW-ECR-R78 (SUB16) = EW-ECR-R78 (SUB16) + COMM-WK.
 17210
 17211     IF ((ISS-PRM - CNC-PRM) = ZEROS)
 17212                OR
 17213        ((ISS-WK - CNC-WK) = ZEROS)
 17214        MOVE ZEROS          TO COMM-WK
 17215     ELSE
 17216        COMPUTE COMM-WK ROUNDED = EPR-PRO /
 17217        (ISS-PRM - CNC-PRM) * (ISS-WK - CNC-WK)
 17218     END-IF
 17219
 17220     COMPUTE EW-ECR-PRO (SUB16) = EW-ECR-PRO (SUB16) + COMM-WK.
 17221
 17222     IF ((ISS-PRM - CNC-PRM) = ZEROS)
 17223                OR
 17224        ((ISS-WK - CNC-WK) = ZEROS)
 17225        MOVE ZEROS          TO COMM-WK
 17226     ELSE
 17227        COMPUTE COMM-WK ROUNDED = EPR-ST  /
 17228        (ISS-PRM - CNC-PRM) * (ISS-WK - CNC-WK)
 17229     END-IF
 17230
 17231     COMPUTE EW-ECR-ST (SUB16) = EW-ECR-ST (SUB16) + COMM-WK.
 17232
 17233     IF A-H-FULLY-EARNED
 17234        MOVE CS-SPP-FEES (SUB1)  TO COMM-WK
 17235        COMPUTE EW-ECR-R78-ADJ (SUB16) =
 17236                               EW-ECR-R78-ADJ (SUB16) + COMM-WK
 17237        COMPUTE EW-ECR-PRO-ADJ (SUB16) =
 17238                               EW-ECR-PRO-ADJ (SUB16) + COMM-WK
 17239     END-IF
 17240
 17241     .
 17242 4375-EXIT.
 17243     EXIT.
 17244
 17245******************************************************************
 17246******************************************************************
 17247******************************************************************
 17248******************************************************************
 17249******************************************************************
 17250******************************************************************
 17251******************************************************************
 17252******************************************************************
 17253******************************************************************
 17254******************************************************************
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 332
* ECS010T1.cbl
 17255***  C A L C U L A T E   L I F E   S T A R T I N G  E A R N E D***
 17256******************************************************************
 17257
 17258 S-4100-EP-DO-LF.
 17259
 17260     MOVE +0                         TO EPR-R78  EARNED-BY-CANCEL
 17261                                        EPR-PRO
 17262                                        EPR-ST.
 17263
 17264     MOVE RCT-EARNING-START-DT (CO-SUB) TO DC-GREG-DATE-CYMD.
 17265     MOVE 'L'                    TO DC-OPTION-CODE.
 17266     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 17267
 17268     MOVE +0                     TO DC-ELAPSED-MONTHS.
 17269     MOVE -1                     TO DC-ELAPSED-DAYS.
 17270     MOVE '6'                    TO DC-OPTION-CODE.
 17271     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 17272
 17273     MOVE +0                     TO DC-ELAPSED-MONTHS
 17274                                    DC-ELAPSED-DAYS.
 17275
 17276     MOVE DC-BIN-DATE-2          TO DC-BIN-DATE-1.
 17277     MOVE ' '                    TO DC-OPTION-CODE.
 17278     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 17279
 17280     IF NO-CONVERSION-ERROR
 17281        MOVE DC-GREG-DATE-CYMD   TO EARNING-START-DATE
 17282     ELSE
 17283         DISPLAY 'ERROR OCCURED CONVERTING EARNING START DATE '
 17284                 'FOR REIN. CO. ' RCT-REIN-CO (CO-SUB)
 17285                 '  START DATE:' RCT-EARNING-START-DT (CO-SUB)
 17286         MOVE 'ERROR OCCURED CONVERTING EARNING START DATE '
 17287                                     TO WS-ABEND-MESSAGE
 17288         MOVE DC-ERROR-CODE          TO WS-ABEND-FILE-STATUS
 17289         MOVE 4001                   TO WS-ABEND-CODE
 17290         GO TO ABEND-PGM.
 17291
 17292     IF CR-LFTYP = ZERO
 17293         GO TO S-4200-EP-DO-AH.
 17294
 17295     IF REIN-LF-FLG (SUB5) = SPACE
 17296         GO TO S-4200-EP-DO-AH.
 17297
 17298     MOVE LIFE-OVERRIDE-L1       TO WE-LF-AH.
 17299     MOVE CR-LFTYP               TO WE-BEN-TYPE.
 17300     PERFORM 4400-EP-FIND-TAB-ENT THRU 4499-EP-FIND-TAB-ENT-X.
 17301
 17302     MOVE CR-LF-TERM             TO ORIG-TERM.
 17303     MOVE CLAS-INDEXL            TO W-NDX.
 17304
 17305 S-4120-EP-DO-LF-CNCL.
 17306
 17307     IF CR-LF-STATUS-AT-CANCEL = ' '  AND
 17308        CLAS-I-CALC-TYPE (CLAS-INDEXL) NOT = 'Z'
 17309         GO TO S-4130-EP-DO-LF-EP.
 17310
 17311     COMPUTE EARNED-BY-CANCEL =
 17312                       (WE-LFPRM + WE-LFPRM-ALT) - WE-LFRFND.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 333
* ECS010T1.cbl
 17313
 17314 S-4130-EP-DO-LF-EP.
 17315
 17316     MOVE SPACE                  TO STATUTORY-SWITCH.
 17317
 17318     MOVE EARNING-START-DATE     TO VALUATION-DT.
 17319     MOVE '9'                    TO W-VAL-SOURCE.
 17320     PERFORM 8500-REMAINING-TERM-ROUTINE THRU 8599-REM-TERM-X.
 17321
 17322     IF REM-TRM2 GREATER CR-LF-TERM
 17323         MOVE +0 TO EPR-R78  EPR-PRO  EPR-ST
 17324         GO TO S-4190-EP-DO-LF-COMM.
 17325
 17326     IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'Z'
 17327         GO TO S-4180-EP-DO-LF-EP-SUM.
 17328
 17329     IF CLAS-I-EP (CLAS-INDEXL) = 'B'
 17330         IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'L'
 17331             IF REM-TRM2 NOT GREATER THAN +0
 17332                 COMPUTE EPR-R78 = WE-LFPRM + WE-LFPRM-ALT
 17333                 MOVE EPR-R78 TO EPR-PRO  EPR-ST
 17334                 GO TO S-4190-EP-DO-LF-COMM
 17335             ELSE
 17336                 NEXT SENTENCE
 17337         ELSE
 17338             IF W-BAL-REMTRM NOT GREATER +0
 17339                 COMPUTE EPR-R78 = WE-LFPRM + WE-LFPRM-ALT
 17340                 MOVE EPR-R78 TO EPR-PRO  EPR-ST
 17341                 GO TO S-4190-EP-DO-LF-COMM
 17342             ELSE
 17343                 NEXT SENTENCE
 17344     ELSE
 17345        IF (DTE-CLIENT EQUAL 'NCL') AND
 17346           (CLAS-I-CALC-TYPE (CLAS-INDEXL) EQUAL 'B')
 17347             MOVE WE-LFPRM TO EPR-R78  EPR-PRO  EPR-ST
 17348        ELSE
 17349         IF REM-TRM2 NOT GREATER +0  OR
 17350            CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'B'
 17351             MOVE WE-LFPRM TO EPR-R78  EPR-PRO  EPR-ST
 17352             GO TO S-4190-EP-DO-LF-COMM.
 17353
 17354     IF CLAS-I-EP (CLAS-INDEXL) = 'T'
 17355         GO TO S-4140-EP-DO-LF-EP-TEX.
 17356
 17357     IF CLAS-I-EP (CLAS-INDEXL) = 'N'
 17358         GO TO S-4150-EP-DO-LF-EP-NP.
 17359
 17360*    IF STATE-ABBR (CLAS-INDEXS) = 'OH'
 17361     IF (STATE-ABBR (CLAS-INDEXS) = 'OH') AND
 17362        (CR-RATING-CLASS NOT = 'L ')
 17363         IF (CR-APR GREATER THAN ZERO)  AND
 17364            (CR-LF-TERM GREATER THAN 060)  AND
 17365            (CR-DT GREATER THAN 19831031)
 17366             MOVE '*'             TO STATUTORY-SWITCH
 17367              GO TO S-4150-EP-DO-LF-EP-NP.
 17368
 17369     IF STATE-ABBR (CLAS-INDEXS) = 'MT'
 17370         IF (CR-APR GREATER THAN ZERO)  AND
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 334
* ECS010T1.cbl
 17371            (CR-LF-TERM GREATER THAN 061)  AND
 17372            (CR-DT GREATER THAN 19830318)
 17373             MOVE '*'             TO STATUTORY-SWITCH
 17374              GO TO S-4150-EP-DO-LF-EP-NP.
 17375
 17376     IF STATE-ABBR (CLAS-INDEXS) = 'UT'
 17377         IF (CR-APR GREATER THAN ZERO)  AND
 17378            (CR-LF-TERM GREATER THAN 062)  AND
 17379            (CR-DT GREATER THAN 19810831)  AND
 17380            (CR-DT LESS THAN 19830901)
 17381             MOVE '*'             TO STATUTORY-SWITCH
 17382              GO TO S-4150-EP-DO-LF-EP-NP.
 17383
 17384     IF STATE-ABBR (CLAS-INDEXS) = 'RI'
 17385         IF (CR-APR GREATER THAN ZERO)  AND
 17386            (CR-LF-TERM GREATER THAN 060)  AND
 17387            (CR-DT GREATER THAN 19831231)
 17388             MOVE '*'             TO STATUTORY-SWITCH
 17389              GO TO S-4150-EP-DO-LF-EP-NP.
 17390
 17391     GO TO S-4160-EP-DO-LF-EP-R78.
 17392
 17393 S-4140-EP-DO-LF-EP-TEX.
 17394
 17395     COMPUTE TEX-FACT-4 =
 17396         (CR-LF-TERM * CR-LF-TERM) + (CR-PMT-FREQ * CR-LF-TERM).
 17397     DIVIDE REM-TRM1 BY CR-PMT-FREQ
 17398         GIVING TEX-FACT-5
 17399             REMAINDER TEX-FACT-6.
 17400     COMPUTE TEX-FACT-5 = TEX-FACT-5 * CR-PMT-FREQ.
 17401     COMPUTE TEX-FACT-7 = (TEX-FACT-5 * TEX-FACT-5) +
 17402         (TEX-FACT-5 * CR-PMT-FREQ) +
 17403         (2 * (TEX-FACT-6 * (TEX-FACT-5 + CR-PMT-FREQ))).
 17404     COMPUTE TEX-FACT-8 ROUNDED = TEX-FACT-7 / TEX-FACT-4.
 17405
 17406     COMPUTE EPR-R78 ROUNDED = WE-LFPRM - (WE-LFPRM * TEX-FACT-8).
 17407
 17408     GO TO S-4170-EP-DO-LF-EP-PRO.
 17409
 17410 S-4150-EP-DO-LF-EP-NP.
 17411
 17412     IF WE-LFPRM = ZERO
 17413         GO TO S-4160-EP-DO-LF-EP-R78.
 17414
 17415     IF DTE-CLIENT = 'CRI'
 17416       IF STATE-ABBR (CLAS-INDEXS) = ('AB' OR 'BC' OR 'MB' OR
 17417             'NS' OR 'ON' OR 'NB' OR 'NF' OR 'QB' OR 'SK' OR 'PE')
 17418           GO TO S-4160-EP-DO-LF-EP-R78.
 17419
 17420     IF DTE-CLIENT = 'NCL'
 17421       IF CR-DT LESS THAN 19910101
 17422           GO TO S-4160-EP-DO-LF-EP-R78.
 17423
 17424     IF REM-TRM1 = CR-LF-TERM
 17425         MOVE +0 TO EPR-R78  EPR-PRO  EPR-ST
 17426         GO TO S-4190-EP-DO-LF-COMM.
 17427
 17428     MOVE CR-APR TO NP-APR.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 335
* ECS010T1.cbl
 17429     MOVE CR-LF-TERM TO NP-ORIG  NP-CAP.
 17430     MOVE REM-TRM1 TO NP-REM.
 17431     MOVE CLAS-I-CALC-TYPE (CLAS-INDEXL) TO NP-OPT.
 17432     IF NP-OPT = 'T' OR 'U' OR 'V' OR 'W' OR 'X'
 17433         MOVE CR-LOAN-TERM TO NP-ORIG.
 17434     MOVE 'R' TO NP-OPT.
 17435     CALL 'ECSNETRM'
 17436         USING NP-APR NP-ORIG NP-REM NP-OPT NP-CAP NP-FACTOR.
 17437
 17438     COMPUTE EPR-R78 ROUNDED = WE-LFPRM - (NP-FACTOR * WE-LFPRM).
 17439
 17440     IF STATUTORY-REQUIREMENT
 17441         MOVE EPR-R78                TO EPR-ST.
 17442
 17443 S-4160-EP-DO-LF-EP-R78.
 17444
 17445     IF (CLAS-I-CALC-TYPE (CLAS-INDEXL) EQUAL 'B') AND
 17446        (DTE-CLIENT EQUAL 'NCL')
 17447        IF (CR-CCYY EQUAL EOM-CCYY) AND
 17448           (CR-MO EQUAL EOM-MO)
 17449           MOVE '*'            TO OB-DATE-1-SWITCH
 17450           MOVE EW-REIN-CO     TO WS-OB-REIN-CO (SUB3)
 17451           MOVE LIFE-OVERRIDE-L1 TO WS-OB-LF-AH (SUB3)
 17452           MOVE CR-LFTYP       TO WS-OB-BENEFIT-CODE (SUB3)
 17453           COMPUTE WS-EPR-R78 (SUB3 1) =
 17454                   WS-EPR-R78 (SUB3 1) - (WE-LFPRM * .5)
 17455           GO TO S-4190-EP-DO-LF-COMM
 17456        ELSE
 17457        IF (CR-CCYY EQUAL OB-CCYY (1)) AND
 17458           (CR-MO EQUAL OB-MO (1))
 17459           MOVE '*'            TO OB-DATE-2-SWITCH
 17460           MOVE EW-REIN-CO     TO WS-OB-REIN-CO (SUB3)
 17461           MOVE LIFE-OVERRIDE-L1 TO WS-OB-LF-AH (SUB3)
 17462           MOVE CR-LFTYP       TO WS-OB-BENEFIT-CODE (SUB3)
 17463           COMPUTE WS-EPR-R78 (SUB3 2) =
 17464                   WS-EPR-R78 (SUB3 2) - (WE-LFPRM * .5)
 17465           GO TO S-4190-EP-DO-LF-COMM
 17466        ELSE
 17467        IF (CR-CCYY EQUAL OB-CCYY (2)) AND
 17468           (CR-MO EQUAL OB-MO (2))
 17469           MOVE '*'            TO OB-DATE-3-SWITCH
 17470           MOVE EW-REIN-CO     TO WS-OB-REIN-CO (SUB3)
 17471           MOVE LIFE-OVERRIDE-L1 TO WS-OB-LF-AH (SUB3)
 17472           MOVE CR-LFTYP       TO WS-OB-BENEFIT-CODE (SUB3)
 17473           COMPUTE WS-EPR-R78 (SUB3 3) =
 17474                   WS-EPR-R78 (SUB3 3) - (WE-LFPRM * .5)
 17475           GO TO S-4190-EP-DO-LF-COMM
 17476        ELSE
 17477           GO TO S-4190-EP-DO-LF-COMM.
 17478
 17479     COMPUTE TEMP-1 = CR-LF-TERM * (CR-LF-TERM + 1).
 17480
 17481     IF DTE-R78 = '1'
 17482         COMPUTE TEMP-2 = REM-TRM1 * REM-TRM1
 17483     ELSE
 17484         COMPUTE TEMP-2 = REM-TRM1 * (REM-TRM1 + 1).
 17485
 17486     COMPUTE TEMP-4 ROUNDED EQUAL TEMP-2 / TEMP-1.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 336
* ECS010T1.cbl
 17487
 17488     IF REM-TRM1 GREATER THAN +0
 17489         COMPUTE TEMP-7 ROUNDED EQUAL
 17490             WE-LFPRM - (WE-LFPRM * TEMP-4)
 17491     ELSE
 17492         MOVE WE-LFPRM                TO TEMP-7.
 17493
 17494     IF CLAS-I-EP (CLAS-INDEXL) NOT = 'B'
 17495         MOVE ZEROS                  TO TEMP-8
 17496         GO TO S-4165-END-LF-EP-R78.
 17497
 17498     IF EPR-ST NOT = ZEROS
 17499         MOVE TEMP-7                 TO EPR-ST.
 17500
 17501     IF CLAS-I-CALC-TYPE (CLAS-INDEXL) NOT = 'L'
 17502         COMPUTE TEMP-1 = (CR-LF-TERM + 1) * (CR-LF-TERM + 2)
 17503         COMPUTE TEMP-2 = (REM-TRM1 + 1) * (REM-TRM1 + 2)
 17504         IF DTE-R78 = '1'
 17505             COMPUTE TEMP-2 = (REM-TRM1 + 1) * (REM-TRM1 + 1).
 17506
 17507     COMPUTE TEMP-4 ROUNDED EQUAL TEMP-2 / TEMP-1.
 17508
 17509     COMPUTE TEMP-8 ROUNDED =
 17510               WE-LFPRM-ALT - (WE-LFPRM-ALT * TEMP-4).
 17511
 17512 S-4165-END-LF-EP-R78.
 17513
 17514     IF EPR-R78 = ZEROS
 17515         COMPUTE EPR-R78 = TEMP-7 + TEMP-8
 17516     ELSE
 17517         COMPUTE EPR-R78 = EPR-R78 + TEMP-8.
 17518
 17519 S-4170-EP-DO-LF-EP-PRO.
 17520
 17521     IF DTE-CLIENT = 'MIC' OR 'MCC'
 17522         COMPUTE TEMP-5 ROUNDED = (REM-TRM1 - .5) / CR-LF-TERM
 17523     ELSE
 17524         COMPUTE TEMP-5 ROUNDED = REM-TRM1 / CR-LF-TERM.
 17525
 17526     IF REM-TRM1 GREATER THAN +0
 17527         COMPUTE TEMP-7 ROUNDED = WE-LFPRM - (WE-LFPRM * TEMP-5)
 17528     ELSE
 17529         MOVE WE-LFPRM                  TO TEMP-7.
 17530
 17531     IF CLAS-I-EP (CLAS-INDEXL) NOT = 'B'
 17532         MOVE ZEROS                     TO TEMP-8
 17533         GO TO S-4175-END-LF-EP-PRO.
 17534
 17535     IF CLAS-I-CALC-TYPE (CLAS-INDEXL) NOT = 'L'
 17536         IF DTE-CLIENT = 'MIC' OR 'MCC'
 17537             COMPUTE TEMP-5 ROUNDED =
 17538                           (REM-TRM1 + .5) / (CR-LF-TERM + 1)
 17539         ELSE
 17540             COMPUTE TEMP-5 ROUNDED =
 17541                           (REM-TRM1 + 1) / (CR-LF-TERM + 1).
 17542
 17543     COMPUTE TEMP-8 ROUNDED =
 17544                   WE-LFPRM-ALT - (WE-LFPRM-ALT * TEMP-5).
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 337
* ECS010T1.cbl
 17545
 17546     COMPUTE EPR-ST = EPR-ST + TEMP-8.
 17547
 17548 S-4175-END-LF-EP-PRO.
 17549
 17550     COMPUTE EPR-PRO = TEMP-7 + TEMP-8.
 17551
 17552     GO TO S-4185-EP-DO-LF-STATUTORY.
 17553
 17554 S-4180-EP-DO-LF-EP-SUM.
 17555
 17556     IF REM-TRM1 NOT GREATER +0
 17557         COMPUTE EPR-R78 = (WE-LFPRM + WE-LFPRM-ALT) - WE-LFRFND
 17558         MOVE EPR-R78 TO EPR-PRO  EPR-ST
 17559         GO TO S-4190-EP-DO-LF-COMM.
 17560
 17561     IF WE-LFPRM = ZERO  AND  WE-LFPRM-ALT = ZERO
 17562         MOVE ZEROS                 TO TEMP-7
 17563     ELSE
 17564         COMPUTE TEMP-7 ROUNDED = WE-LFPRM - (WE-LFRFND *
 17565                       (WE-LFPRM / (WE-LFPRM + WE-LFPRM-ALT))).
 17566
 17567     IF TEMP-7 NOT GREATER ZERO
 17568         IF CLAS-I-EP (CLAS-INDEXL) NOT = 'B'
 17569             MOVE ZEROS             TO EPR-R78  EPR-PRO  EPR-ST
 17570             GO TO S-4190-EP-DO-LF-COMM
 17571         ELSE
 17572             MOVE ZEROS             TO TEMP-7.
 17573
 17574     COMPUTE TEMP-1 = CR-LF-TERM * (CR-LF-TERM + 1).
 17575     COMPUTE TEMP-2 = REM-TRM1 * (REM-TRM1 + 1).
 17576     IF DTE-R78 = '1'
 17577         COMPUTE TEMP-2 = REM-TRM1 * REM-TRM1.
 17578
 17579     COMPUTE TEMP-4 ROUNDED = TEMP-2 / TEMP-1.
 17580     COMPUTE TEMP-5 ROUNDED = REM-TRM1 / CR-LF-TERM.
 17581
 17582     COMPUTE EPR-R78 ROUNDED = TEMP-7 - (TEMP-7 * TEMP-4).
 17583
 17584     COMPUTE EPR-PRO ROUNDED = TEMP-7 - (TEMP-7 * TEMP-5).
 17585
 17586     IF CLAS-I-EP (CLAS-INDEXL) NOT = 'B'
 17587         GO TO S-4185-EP-DO-LF-STATUTORY.
 17588
 17589     MOVE EPR-R78                  TO EPR-ST.
 17590
 17591     IF WE-LFPRM = ZERO  AND  WE-LFPRM-ALT = ZERO
 17592         MOVE ZEROS                 TO TEMP-8
 17593     ELSE
 17594         COMPUTE TEMP-8 ROUNDED = WE-LFPRM-ALT - (WE-LFRFND *
 17595                     (WE-LFPRM-ALT / (WE-LFPRM + WE-LFPRM-ALT))).
 17596
 17597     IF TEMP-8 NOT GREATER ZERO
 17598         GO TO S-4185-EP-DO-LF-STATUTORY.
 17599
 17600     COMPUTE EPR-R78 ROUNDED = EPR-R78 +
 17601                              (TEMP-8 - (TEMP-8 * TEMP-4)).
 17602
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 338
* ECS010T1.cbl
 17603     COMPUTE EPR-PRO ROUNDED = EPR-PRO +
 17604                              (TEMP-8 - (TEMP-8 * TEMP-5)).
 17605
 17606     COMPUTE EPR-ST ROUNDED = EPR-ST +
 17607                             (TEMP-8 - (TEMP-8 * TEMP-5)).
 17608
 17609 S-4185-EP-DO-LF-STATUTORY.
 17610
 17611     IF STATE-ABBR (CLAS-INDEXS) = 'AL'
 17612         MOVE EPR-R78                TO EPR-ST.
 17613
 17614     IF STATE-ABBR (CLAS-INDEXS) = 'WY'
 17615         MOVE EPR-PRO                TO EPR-ST.
 17616
 17617     IF EPR-ST NOT = ZEROS
 17618         GO TO S-4190-EP-DO-LF-COMM.
 17619
 17620     IF CLAS-I-RL-AH (CLAS-INDEXL) = 'R'
 17621         MOVE EPR-R78                TO EPR-ST
 17622     ELSE
 17623         MOVE EPR-PRO                TO EPR-ST.
 17624
 17625 S-4190-EP-DO-LF-COMM.
 17626
 17627     IF EARNED-BY-CANCEL = ZEROS
 17628         GO TO S-4195-LF-COMM-CONTINUE.
 17629
 17630     IF EPR-R78 GREATER THAN EARNED-BY-CANCEL
 17631         MOVE EARNED-BY-CANCEL     TO EPR-R78.
 17632
 17633     IF EPR-PRO GREATER THAN EARNED-BY-CANCEL
 17634         MOVE EARNED-BY-CANCEL     TO EPR-PRO.
 17635
 17636     IF EPR-ST  GREATER THAN EARNED-BY-CANCEL
 17637         MOVE EARNED-BY-CANCEL     TO EPR-ST.
 17638
 17639 S-4195-LF-COMM-CONTINUE.
 17640
 17641     MOVE +0 TO SUB1.
 17642     PERFORM S-4300-EP-COMM-LOOP THRU S-4399-EP-COMM-LOOP-X
 17643         10 TIMES.
 17644
 17645     COMPUTE EW-EPR-R78 = EW-EPR-R78 - EPR-R78.
 17646     COMPUTE EW-EPR-PRO = EW-EPR-PRO - EPR-PRO.
 17647     COMPUTE EW-EPR-ST  = EW-EPR-ST  - EPR-ST.
 17648
 17649     COMPUTE EW-EPR-R78-ADJ = EW-EPR-R78-ADJ + EPR-R78.
 17650     COMPUTE EW-EPR-PRO-ADJ = EW-EPR-PRO-ADJ + EPR-PRO.
 17651     COMPUTE EW-EPR-ST-ADJ  = EW-EPR-ST-ADJ  + EPR-ST.
 17652
 17653     MOVE 'Y'          TO EW-LEVEL-USED.
 17654
 17655     IF CR-POLICY-UNDERWRITTEN
 17656         MOVE EPEC-WORK       TO EPEC-LEVELS-II (SUB3)
 17657
 17658     ELSE
 17659         MOVE EPEC-WORK       TO EPEC-LEVELS (SUB3).
 17660
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 339
* ECS010T1.cbl
 17661     GO TO S-4200-EP-DO-AH.
 17662
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 340
* ECS010T1.cbl
 17664******************************************************************
 17665***  C A L C U L A T E   A & H   S T A R T   E A R N E D       ***
 17666******************************************************************
 17667
 17668 S-4200-EP-DO-AH.
 17669
 17670     MOVE +0                         TO EPR-R78  EARNED-BY-CANCEL
 17671                                        EPR-PRO
 17672                                        EPR-ST.
 17673
 17674     IF CR-AHTYP = ZERO
 17675         GO TO S-4299-EPBX.
 17676
 17677     IF REIN-AH-FLG (SUB5) = SPACE
 17678         GO TO S-4299-EPBX.
 17679
 17680     MOVE AH-OVERRIDE-L1       TO WE-LF-AH.
 17681     MOVE CR-AHTYP             TO WE-BEN-TYPE.
 17682     PERFORM 4400-EP-FIND-TAB-ENT THRU 4499-EP-FIND-TAB-ENT-X.
 17683
 17684     MOVE CR-AH-TERM           TO ORIG-TERM.
 17685     MOVE CLAS-INDEXA          TO W-NDX.
 17686
 17687     MOVE EARNING-START-DATE     TO VALUATION-DT.
 17688     MOVE '9'                    TO W-VAL-SOURCE.
 17689     PERFORM 8500-REMAINING-TERM-ROUTINE THRU 8599-REM-TERM-X.
 17690
 17691 S-4220-EP-DO-AH-CNCL.
 17692
 17693     IF CR-AH-STATUS-AT-CANCEL NOT = ' '
 17694         COMPUTE EARNED-BY-CANCEL = WE-AHPRM - WE-AHRFND.
 17695
 17696 S-4230-EP-DO-AH-EP.
 17697
 17698     IF REM-TRM2 GREATER CR-AH-TERM
 17699         MOVE +0 TO EPR-R78  EPR-PRO  EPR-ST
 17700         GO TO S-4290-EP-DO-AH-COMM.
 17701
 17702     IF CLAS-I-CALC-TYPE (CLAS-INDEXA) = 'Z'
 17703         COMPUTE WE-AHPRM = WE-AHPRM - WE-AHRFND.
 17704
 17705 S-4235-CHECK-OB-AH-NCL.
 17706
 17707     IF (DTE-CLIENT EQUAL 'NCL') AND
 17708        (CLAS-I-CALC-TYPE (CLAS-INDEXA) EQUAL 'B')
 17709           MOVE WE-AHPRM         TO EPR-R78
 17710                                    EPR-PRO
 17711                                    EPR-ST
 17712        IF (CR-CCYY EQUAL EOM-CCYY) AND
 17713           (CR-MO EQUAL EOM-MO)
 17714           MOVE '*'            TO OB-DATE-1-SWITCH
 17715           MOVE EW-REIN-CO     TO WS-OB-REIN-CO (SUB3)
 17716           MOVE AH-OVERRIDE-L1 TO WS-OB-LF-AH (SUB3)
 17717           MOVE CR-AHTYP       TO WS-OB-BENEFIT-CODE (SUB3)
 17718           COMPUTE WS-EPR-R78 (SUB3 1) =
 17719                   WS-EPR-R78 (SUB3 1) - (WE-AHPRM * .5)
 17720            GO TO S-4290-EP-DO-AH-COMM
 17721        ELSE
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 341
* ECS010T1.cbl
 17722        IF (CR-CCYY EQUAL OB-CCYY (1)) AND
 17723           (CR-MO EQUAL OB-MO (1))
 17724           MOVE '*'            TO OB-DATE-2-SWITCH
 17725           MOVE EW-REIN-CO     TO WS-OB-REIN-CO (SUB3)
 17726           MOVE AH-OVERRIDE-L1 TO WS-OB-LF-AH (SUB3)
 17727           MOVE CR-AHTYP       TO WS-OB-BENEFIT-CODE (SUB3)
 17728           COMPUTE WS-EPR-R78 (SUB3 2) =
 17729                   WS-EPR-R78 (SUB3 2) - (WE-AHPRM * .5)
 17730            GO TO S-4290-EP-DO-AH-COMM
 17731        ELSE
 17732        IF (CR-CCYY EQUAL OB-CCYY (2)) AND
 17733           (CR-MO EQUAL OB-MO (2))
 17734           MOVE '*'            TO OB-DATE-3-SWITCH
 17735           MOVE EW-REIN-CO     TO WS-OB-REIN-CO (SUB3)
 17736           MOVE AH-OVERRIDE-L1 TO WS-OB-LF-AH (SUB3)
 17737           MOVE CR-AHTYP       TO WS-OB-BENEFIT-CODE (SUB3)
 17738           COMPUTE WS-EPR-R78 (SUB3 3) =
 17739                   WS-EPR-R78 (SUB3 3) - (WE-AHPRM * .5)
 17740            GO TO S-4290-EP-DO-AH-COMM
 17741        ELSE
 17742            GO TO S-4290-EP-DO-AH-COMM.
 17743
 17744     IF REM-TRM2 NOT GREATER +0
 17745         MOVE WE-AHPRM TO EPR-R78  EPR-PRO  EPR-ST
 17746         GO TO S-4290-EP-DO-AH-COMM.
 17747
 17748     IF CLAS-I-CALC-TYPE (CLAS-INDEXA) = 'B'
 17749         MOVE WE-AHPRM TO EPR-R78  EPR-PRO  EPR-ST
 17750         GO TO S-4290-EP-DO-AH-COMM.
 17751
 17752     COMPUTE TEMP-1 = CR-AH-TERM * (CR-AH-TERM + 1).
 17753     COMPUTE TEMP-2 = REM-TRM1 * (REM-TRM1 + 1).
 17754     IF DTE-R78 = '1'
 17755         COMPUTE TEMP-2 = REM-TRM1 * REM-TRM1.
 17756     COMPUTE TEMP-4 ROUNDED = TEMP-2 / TEMP-1.
 17757
 17758     IF DTE-CLIENT = 'MIC' OR 'MCC'
 17759         COMPUTE TEMP-5 ROUNDED = (REM-TRM1 - .5) / CR-AH-TERM
 17760     ELSE
 17761         COMPUTE TEMP-5 ROUNDED = REM-TRM1 / CR-AH-TERM.
 17762
 17763     COMPUTE EPR-R78 ROUNDED = WE-AHPRM * TEMP-4.
 17764     COMPUTE EPR-R78 = WE-AHPRM - EPR-R78.
 17765
 17766     COMPUTE EPR-PRO ROUNDED = WE-AHPRM * TEMP-5.
 17767     COMPUTE EPR-PRO = WE-AHPRM - EPR-PRO.
 17768
 17769     MOVE  CLAS-I-EP (CLAS-INDEXA) TO AH-EARN-METHOD.
 17770
 17771*    IF AM-EARN-METHOD-A NOT EQUAL SPACES AND ZEROS
 17772*        MOVE AM-EARN-METHOD-A TO AH-EARN-METHOD.
 17773
 17774     MOVE SPACES TO STATUTORY-SWITCH-AH.
 17775
 17776     IF (STATE-ABBR (CLAS-INDEXS) = 'VA') AND
 17777        (CR-DT GREATER THAN  19921231)
 17778         IF CR-AH-TERM GREATER THAN  +61
 17779             MOVE 'A' TO AH-EARN-METHOD
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 342
* ECS010T1.cbl
 17780             MOVE '*' TO STATUTORY-SWITCH-AH
 17781             GO TO S-4245-EP-DO-AH-EP-AN
 17782         ELSE
 17783             GO TO S-4250-EP-DO-AH-STATUTORY.
 17784
 17785     IF AH-EARN-METHOD EQUAL 'N'
 17786         GO TO S-4240-EP-DO-AH-EP-NP.
 17787
 17788     IF AH-EARN-METHOD EQUAL 'A' OR 'C'
 17789         MOVE 'A' TO AH-EARN-METHOD
 17790         GO TO S-4245-EP-DO-AH-EP-AN.
 17791
 17792     GO TO S-4250-EP-DO-AH-STATUTORY.
 17793
 17794 S-4240-EP-DO-AH-EP-NP.
 17795
 17796     IF WE-AHPRM = ZERO
 17797         GO TO S-4250-EP-DO-AH-STATUTORY.
 17798
 17799     IF CR-APR GREATER THAN +0
 17800         NEXT SENTENCE
 17801     ELSE
 17802         GO TO S-4250-EP-DO-AH-STATUTORY.
 17803
 17804     IF DTE-CLIENT = 'NCL'
 17805       IF CR-DT LESS THAN 19910101
 17806           GO TO S-4250-EP-DO-AH-STATUTORY.
 17807
 17808     IF REM-TRM1 = CR-AH-TERM
 17809         MOVE +0 TO EPR-R78  EPR-PRO  EPR-ST
 17810         GO TO S-4290-EP-DO-AH-COMM.
 17811
 17812     MOVE CR-APR TO NP-APR.
 17813     MOVE CR-AH-TERM TO NP-ORIG  NP-CAP.
 17814     MOVE REM-TRM1 TO NP-REM.
 17815     MOVE CLAS-I-CALC-TYPE (CLAS-INDEXA) TO NP-OPT.
 17816     IF NP-OPT = 'T' OR 'U' OR 'V' OR 'W' OR 'X'
 17817         MOVE CR-LOAN-TERM TO NP-ORIG.
 17818     MOVE 'R' TO NP-OPT.
 17819     CALL 'ECSNETRM'
 17820         USING NP-APR NP-ORIG NP-REM NP-OPT NP-CAP NP-FACTOR.
 17821
 17822     COMPUTE EPR-R78 ROUNDED = WE-AHPRM - (NP-FACTOR * WE-AHPRM).
 17823
 17824     GO TO S-4250-EP-DO-AH-STATUTORY.
 17825
 17826 S-4245-EP-DO-AH-EP-AN.
 17827     MOVE CR-DT                      TO DC-GREG-DATE-CYMD.
 17828     MOVE 'L'                        TO DC-OPTION-CODE.
 17829     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 17830     MOVE DC-BIN-DATE-1              TO CP-CERT-EFF-DT.
 17831     MOVE CLAS-I-RL-AH (CLAS-INDEXA) TO CP-BENEFIT-TYPE.
 17832     MOVE SPACES                     TO CP-ACCT-FLD-5.
 17833     MOVE DTE-CLIENT                 TO CP-COMPANY-ID.
 17834     MOVE STATE-SUB (CLAS-INDEXS)    TO CP-STATE.
 17835     MOVE STATE-ABBR (CLAS-INDEXS)   TO CP-STATE-STD-ABBRV.
 17836     MOVE CR-AGE                     TO CP-ISSUE-AGE.
 17837     MOVE REM-TRM1                   TO CP-ORIGINAL-TERM.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 343
* ECS010T1.cbl
 17838     MOVE CR-AHAMT                   TO CP-ORIGINAL-BENEFIT
 17839                                        CP-RATING-BENEFIT-AMT.
 17840     IF CP-STATE-STD-ABBRV = 'OR'
 17841         COMPUTE CP-RATING-BENEFIT-AMT =
 17842                                  CR-AHAMT * REM-TRM1.
 17843     MOVE CR-APR                     TO CP-LOAN-APR.
 17844     MOVE CR-PMT-FREQ                TO CP-PAY-FREQUENCY.
 17845     MOVE AH-EARN-METHOD             TO CP-EARNING-METHOD.
 17846     MOVE '3'                        TO CP-PROCESS-TYPE.
 17847     MOVE CLAS-I-BAL (CLAS-INDEXA)   TO CP-SPECIAL-CALC-CD.
 17848     MOVE CR-LOAN-TERM               TO CP-LOAN-TERM.
 17849
 17850     IF CR-RATING-CLASS NOT = SPACE AND ZERO
 17851         MOVE CR-RATING-CLASS        TO CP-CLASS-CODE
 17852     ELSE
 17853         MOVE AM-CAL-TABLE           TO CP-CLASS-CODE.
 17854
 17855     MOVE AM-AH-DEVIATION            TO CP-DEVIATION-CODE.
 17856     MOVE CR-AHTYP                   TO CP-BENEFIT-CD.
 17857     MOVE DTE-CLASIC-COMPANY-CD      TO CP-COMPANY-CD.
 17858     MOVE CR-PMT-EXTENSION-DAYS      TO CP-TERM-OR-EXT-DAYS.
 17859     MOVE AH-OVERRIDE-L1             TO CP-AH-OVERRIDE-CODE.
 17860     MOVE AM-AH-DEVIATION-PCT        TO CP-RATE-DEV-PCT.
 17861
 17862     PERFORM 8100-GET-RATE THRU 8199-GET-RATE-X.
 17863
 17864     IF CP-ERROR-RATE-NOT-FOUND  OR
 17865        CP-ERROR-RATE-IS-ZERO  OR
 17866        CP-ERROR-IN-DATES
 17867         GO TO S-4250-EP-DO-AH-STATUTORY.
 17868
 17869     COMPUTE EPR-R78 ROUNDED =
 17870             ((REM-TRM1 * WE-AHAMT) / +100) *
 17871               CP-PREMIUM-RATE.
 17872
 17873     COMPUTE EPR-R78 = WE-AHPRM - EPR-R78.
 17874
 17875     IF STATUTORY-REQUIREMENT-AH
 17876         MOVE EPR-R78                TO EPR-ST
 17877         GO TO S-4290-EP-DO-AH-COMM.
 17878
 17879 S-4250-EP-DO-AH-STATUTORY.
 17880     MOVE EPR-R78                    TO EPR-ST.
 17881
 17882     MOVE +0                         TO SUB1.
 17883
 17884 S-4255-EP-AH-STAT-LOOP.
 17885     ADD +1 TO SUB1.
 17886
 17887     IF STATE-ABBR (CLAS-INDEXS) = AH-RES-STATE-ENT (SUB1)
 17888         MOVE EPR-PRO                TO EPR-ST
 17889     ELSE
 17890         IF AH-RES-STATE-ENT (SUB1) NOT = HIGH-VALUES
 17891             GO TO S-4255-EP-AH-STAT-LOOP.
 17892
 17893     IF (STATE-ABBR (CLAS-INDEXS) = 'OH'  AND
 17894         CR-DT GREATER THAN 19831031)
 17895                    OR
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 344
* ECS010T1.cbl
 17896        (STATE-ABBR (CLAS-INDEXS) = 'OK'  AND
 17897         CR-DT GREATER THAN 19820629)
 17898                    OR
 17899        (STATE-ABBR (CLAS-INDEXS) = 'TX'  AND
 17900         CR-DT GREATER THAN 19830831)
 17901             COMPUTE EPR-ST = (EPR-R78 + EPR-PRO) / 2.
 17902
 17903     IF DTE-CLIENT = 'CSO'  OR  'CID'
 17904       IF STATE-ABBR (CLAS-INDEXS) = 'CO'
 17905         IF CR-DT LESS THAN 19970101
 17906             MOVE EPR-R78            TO EPR-ST
 17907         ELSE
 17908             COMPUTE EPR-ST = (EPR-R78 + EPR-PRO) / 2.
 17909
 17910 S-4290-EP-DO-AH-COMM.
 17911
 17912     IF EARNED-BY-CANCEL = ZEROS
 17913         GO TO S-4295-AH-COMM-CONTINUE.
 17914
 17915     IF EPR-R78 GREATER THAN EARNED-BY-CANCEL
 17916         MOVE EARNED-BY-CANCEL     TO EPR-R78.
 17917
 17918     IF EPR-PRO GREATER THAN EARNED-BY-CANCEL
 17919         MOVE EARNED-BY-CANCEL     TO EPR-PRO.
 17920
 17921     IF EPR-ST  GREATER THAN EARNED-BY-CANCEL
 17922         MOVE EARNED-BY-CANCEL     TO EPR-ST.
 17923
 17924 S-4295-AH-COMM-CONTINUE.
 17925
 17926     MOVE +0           TO SUB1.
 17927     PERFORM S-4300-EP-COMM-LOOP THRU S-4399-EP-COMM-LOOP-X
 17928         10 TIMES.
 17929
 17930     COMPUTE EW-EPR-R78 = EW-EPR-R78 - EPR-R78.
 17931     COMPUTE EW-EPR-PRO = EW-EPR-PRO - EPR-PRO.
 17932     COMPUTE EW-EPR-ST  = EW-EPR-ST  - EPR-ST.
 17933
 17934     COMPUTE EW-EPR-R78-ADJ = EW-EPR-R78-ADJ + EPR-R78.
 17935     COMPUTE EW-EPR-PRO-ADJ = EW-EPR-PRO-ADJ + EPR-PRO.
 17936     COMPUTE EW-EPR-ST-ADJ  = EW-EPR-ST-ADJ  + EPR-ST.
 17937
 17938     MOVE 'Y'          TO EW-LEVEL-USED.
 17939
 17940     IF CR-POLICY-UNDERWRITTEN
 17941         MOVE EPEC-WORK       TO EPEC-LEVELS-II (SUB3)
 17942     ELSE
 17943         MOVE EPEC-WORK       TO EPEC-LEVELS (SUB3).
 17944
 17945
 17946 S-4299-EPBX.
 17947     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 345
* ECS010T1.cbl
 17949******************************************************************
 17950***    C A L C U L A T E   S T A R T   E A R N E D   C O M M   ***
 17951******************************************************************
 17952
 17953 S-4300-EP-COMM-LOOP.
 17954
 17955     ADD +1 TO SUB1.
 17956     IF CR-COM-AGT (SUB1) = SPACES OR ZEROS
 17957         GO TO S-4399-EP-COMM-LOOP-X.
 17958
 17959     IF EW-LF-AH = AH-OVERRIDE-L1
 17960         GO TO S-4350-EP-COMM-LOOP-A.
 17961
 17962*    IF CR-AGT-TYPE (SUB1) = 'K'
 17963*       COMPUTE COMM-WK =
 17964     COMPUTE COMM-WK ROUNDED = EPR-R78 * CR-LCOM-L (SUB1).
 17965     COMPUTE EW-ECR-R78 (SUB1) = EW-ECR-R78 (SUB1) - COMM-WK.
 17966     COMPUTE EW-ECR-R78-ADJ (SUB1) =
 17967                                 EW-ECR-R78-ADJ (SUB1) + COMM-WK.
 17968
 17969     COMPUTE COMM-WK ROUNDED = EPR-PRO * CR-LCOM-L (SUB1).
 17970     COMPUTE EW-ECR-PRO (SUB1) = EW-ECR-PRO (SUB1) - COMM-WK.
 17971     COMPUTE EW-ECR-PRO-ADJ (SUB1) =
 17972                                 EW-ECR-PRO-ADJ (SUB1) + COMM-WK.
 17973
 17974     COMPUTE COMM-WK ROUNDED = EPR-ST * CR-LCOM-L (SUB1).
 17975     COMPUTE EW-ECR-ST (SUB1) = EW-ECR-ST (SUB1) - COMM-WK.
 17976
 17977     GO TO S-4399-EP-COMM-LOOP-X.
 17978
 17979 S-4350-EP-COMM-LOOP-A.
 17980
 17981     COMPUTE COMM-WK ROUNDED = EPR-R78 * CR-LCOM-AH (SUB1).
 17982     COMPUTE EW-ECR-R78 (SUB1) = EW-ECR-R78 (SUB1) - COMM-WK.
 17983     COMPUTE EW-ECR-R78-ADJ (SUB1) =
 17984                                 EW-ECR-R78-ADJ (SUB1) + COMM-WK.
 17985
 17986     COMPUTE COMM-WK ROUNDED = EPR-PRO * CR-LCOM-AH (SUB1).
 17987     COMPUTE EW-ECR-PRO (SUB1) = EW-ECR-PRO (SUB1) - COMM-WK.
 17988     COMPUTE EW-ECR-PRO-ADJ (SUB1) =
 17989                                 EW-ECR-PRO-ADJ (SUB1) + COMM-WK.
 17990
 17991     COMPUTE COMM-WK ROUNDED = EPR-ST * CR-LCOM-AH (SUB1).
 17992     COMPUTE EW-ECR-ST (SUB1) = EW-ECR-ST (SUB1) - COMM-WK.
 17993
 17994 S-4399-EP-COMM-LOOP-X.
 17995     EXIT.
 17996
 17997******************************************************************
 17998******************************************************************
 17999******************************************************************
 18000******************************************************************
 18001******************************************************************
 18002******************************************************************
 18003******************************************************************
 18004******************************************************************
 18005******************************************************************
 18006******************************************************************
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 346
* ECS010T1.cbl
 18008******************************************************************
 18009***     F I N D   R E I N S U R A N C E   T A B L E   S U B    ***
 18010******************************************************************
 18011
 18012 4400-EP-FIND-TAB-ENT.
 18013
 18014     IF WE-REIN-CO = EPEC-SUB-REIN (SUB9)
 18015         GO TO 4490-EP-FIND-TAB-SUB.
 18016     MOVE +1 TO SUB9.
 18017
 18018 4450-EP-FIND-TAB-LOOP.
 18019
 18020     IF WE-REIN-CO = EPEC-SUB-REIN (SUB9)
 18021         GO TO 4490-EP-FIND-TAB-SUB.
 18022     IF EPEC-SUB-REIN (SUB9) = ZEROS
 18023         MOVE WE-REIN-CO TO EPEC-SUB-REIN (SUB9)
 18024         GO TO 4490-EP-FIND-TAB-SUB.
 18025
 18026     ADD +1 TO SUB9.
 18027     IF SUB9 GREATER THAN +31
 18028         DISPLAY 'EPEC SUBSCRIPT TABLE FULL ' AM-MSTR-CNTRL
 18029         MOVE 0201 TO WS-ABEND-CODE
 18030         DISPLAY '******************************'
 18031         DISPLAY '***** ERROR LOCATION 020 *****'
 18032         DISPLAY '******************************'
 18033         MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
 18034         GO TO ABEND-PGM.
 18035
 18036     GO TO 4450-EP-FIND-TAB-LOOP.
 18037
 18038 4490-EP-FIND-TAB-SUB.
 18039
 18040     IF WE-LF-AH = LIFE-OVERRIDE-L1
 18041         IF EPEC-SUB-LF (SUB9 CLAS-INDEXL) = ZERO
 18042             ADD +1 TO SUB10
 18043             MOVE SUB10 TO SUB3
 18044             MOVE SUB10 TO EPEC-SUB-LF (SUB9 CLAS-INDEXL)
 18045         ELSE
 18046             MOVE EPEC-SUB-LF (SUB9 CLAS-INDEXL) TO SUB3.
 18047
 18048     IF WE-LF-AH = AH-OVERRIDE-L1
 18049         IF EPEC-SUB-AH (SUB9 CLAS-INDEXA) = ZERO
 18050             ADD +1 TO SUB10
 18051             MOVE SUB10 TO SUB3
 18052             MOVE SUB10 TO EPEC-SUB-AH (SUB9 CLAS-INDEXA)
 18053         ELSE
 18054             MOVE EPEC-SUB-AH (SUB9 CLAS-INDEXA) TO SUB3.
 18055
 18056*    IF SUB3 GREATER THAN +220
 18057*    IF SUB3 GREATER THAN +300
 18058     IF SUB3 GREATER THAN +900
 18059         DISPLAY 'SUB3 VALUE IS - ' SUB3
 18060         DISPLAY 'EPEC WORK TABLE FULL ' AM-MSTR-CNTRL
 18061         MOVE 0202 TO WS-ABEND-CODE
 18062         DISPLAY '******************************'
 18063         DISPLAY '***** ERROR LOCATION 021 *****'
 18064         DISPLAY '******************************'
 18065         MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 347
* ECS010T1.cbl
 18066         GO TO ABEND-PGM.
 18067
 18068     IF CR-POLICY-UNDERWRITTEN
 18069         MOVE EPEC-LEVELS-II (SUB3)  TO EPEC-WORK
 18070         MOVE EPEC-UNDW-OPT-DATA-TABLE
 18071                                     TO EPEC-OPT-WORK-TABLE
 18072     ELSE
 18073         MOVE EPEC-LEVELS (SUB3)     TO EPEC-WORK
 18074         MOVE EPEC-OPT-DATA-TABLE    TO EPEC-OPT-WORK-TABLE.
 18075
 18076     MOVE WE-REIN-CO         TO EW-REIN-CO
 18077                                EPEC-REIN-CO (SUB3)
 18078                                EPEC-REIN-CO-II (SUB3).
 18079     MOVE WE-LF-AH           TO EW-LF-AH
 18080                                EPEC-LF-AH (SUB3)
 18081                                EPEC-LF-AH-II (SUB3).
 18082     MOVE WE-BEN-TYPE        TO EW-BEN-TYPE
 18083                                EPEC-BEN-TYPE (SUB3)
 18084                                EPEC-BEN-TYPE-II (SUB3).
 18085
 18086 4499-EP-FIND-TAB-ENT-X.
 18087     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 348
* ECS010T1.cbl
 18089******************************************************************
 18090***         B U I L D   S U M M A R Y   E X T R A C T S        ***
 18091******************************************************************
 18092
 18093 4500-BUILD-EPEC-EXTRACT.
 18094
 18095     IF DTE-CLIENT = 'DCC'
 18096        PERFORM 4541-CALC-IBNR   THRU 4541-EXIT
 18097     END-IF
 18098
 18099     PERFORM 4510-BUILD-EPEC-EXT THRU 4519-BUILD-EPEC-EXT-X
 18100         VARYING SUB2 FROM +1 BY +1
 18101             UNTIL EPEC-REIN-CO (SUB2) = ZEROS.
 18102
 18103     PERFORM 4550-CLEAR-EPEC-TOTALS THRU 4589-CLEAR-EPEC-TOTALS-X.
 18104
 18105     GO TO 4599-BUILD-EPEC-EXTRACT-X.
 18106
 18107
 18108 4510-BUILD-EPEC-EXT.
 18109
 18110     MOVE EPEC-LEVELS (SUB2)            TO EPEC-WORK.
 18111     MOVE EPEC-OPT-DATA-TABLE           TO EPEC-OPT-WORK-TABLE.
 18112     IF EW-LEVEL-USED = 'Y'
 18113         MOVE SPACE                     TO W-UNDERWRITING-SW
 18114         PERFORM 4511-BUILD-EPEC-RECORD THRU
 18115                 4518-BUILD-EPEC-RCD-X.
 18116
 18117     MOVE EPEC-LEVELS-II (SUB2)         TO EPEC-WORK.
 18118     MOVE EPEC-UNDW-OPT-DATA-TABLE      TO EPEC-OPT-WORK-TABLE.
 18119     IF EW-LEVEL-USED = 'Y'
 18120         MOVE '*'                       TO W-UNDERWRITING-SW
 18121         PERFORM 4511-BUILD-EPEC-RECORD THRU
 18122                 4518-BUILD-EPEC-RCD-X.
 18123
 18124     GO TO 4519-BUILD-EPEC-EXT-X.
 18125
 18126 4511-BUILD-EPEC-RECORD.
 18127
 18128     MOVE SPACES                        TO EP-RECORD.
 18129     MOVE 'EP'                          TO EP-RECORD-ID.
 18130     MOVE DTE-CLASIC-COMPANY-CD         TO EP-COMPANY-CD.
 18131     MOVE AM-MSTR-CNTRL                 TO EP-CONTROL.
 18132     MOVE AM-EXPIRE-DT                  TO WS-EP-EXP-DTE-N.
 18133     MOVE AM-EFFECT-DT                  TO EP-EFF-DTE
 18134                                           WS-EP-EFF-DTE-N.
 18135     MOVE EW-REIN-CO                    TO EP-REI-CO.
 18136     IF EP-REI-CO NOT = SPACES
 18137         MOVE 'R'                       TO EP-REIN.
 18138     MOVE EW-LF-AH                      TO EP-RCD-TYPE.
 18139     MOVE EW-BEN-TYPE                   TO EP-BEN-CODE.
 18140
 18141     MOVE EW-ISS-CNT                    TO EP-ISS-CNT.
 18142     MOVE EW-ISS-BEN                    TO EP-ISS-BEN.
 18143     MOVE EW-ISS-BEN-GROSS              TO EP-ISS-BEN-GROSS.
 18144
 18145     MOVE EW-CNC-CNT                    TO EP-CNC-CNT.
 18146     MOVE EW-CNC-BEN                    TO EP-CNC-BEN.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 349
* ECS010T1.cbl
 18147     MOVE EW-CNC-BEN-GROSS              TO EP-CNC-BEN-GROSS.
 18148
 18149     MOVE EW-ISS-PRM                    TO EP-ISS-PRM.
 18150     MOVE EW-ISS-PRM-GROSS              TO EP-ISS-PRM-GROSS.
 18151     MOVE EW-CNC-PRM                    TO EP-CNC-PRM.
 18152     MOVE EW-CNC-PRM-GROSS              TO EP-CNC-PRM-GROSS.
 18153
 18154     IF DTE-CLIENT NOT = 'NCL'
 18155         GO TO 4512-BUILD-EPEC-CONTINUE.
 18156
 18157     IF W-UNDERWRITTEN-DATA
 18158         GO TO 4512-BUILD-EPEC-CONTINUE.
 18159
 18160     IF AM-EXPIRE-DT NOT GREATER THAN EOM-RUN-DATE
 18161         GO TO 4512-BUILD-EPEC-CONTINUE.
 18162
 18163     IF WS-OB-REIN-CO (SUB2) = EW-REIN-CO  AND
 18164        WS-OB-LF-AH (SUB2) = EW-LF-AH  AND
 18165        WS-OB-BENEFIT-CODE (SUB2) = EW-BEN-TYPE
 18166         NEXT SENTENCE
 18167     ELSE
 18168         GO TO 4512-BUILD-EPEC-CONTINUE.
 18169
 18170     IF OB-DATE-1-USED  OR
 18171        OB-DATE-2-USED  OR
 18172        OB-DATE-3-USED
 18173         NEXT SENTENCE
 18174     ELSE
 18175         GO TO 4512-BUILD-EPEC-CONTINUE.
 18176
 18177     IF OB-DATE-1-USED
 18178         IF WS-EPR-R78 (SUB2 1) NOT EQUAL +0
 18179             COMPUTE EW-EPR-R78 = EW-ISS-PRM - EW-CNC-PRM -
 18180                           EW-EPR-R78-ADJ - WS-EPR-R78 (SUB2 1)
 18181             MOVE EW-EPR-R78    TO EW-EPR-PRO
 18182                                   EW-EPR-ST
 18183             GO TO 4512-BUILD-EPEC-CONTINUE
 18184         ELSE
 18185             GO TO 4512-BUILD-EPEC-CONTINUE.
 18186
 18187     IF OB-DATE-2-USED
 18188         IF WS-EPR-R78 (SUB2 2) NOT EQUAL +0
 18189             COMPUTE EW-EPR-R78 = EW-ISS-PRM - EW-CNC-PRM -
 18190                           EW-EPR-R78-ADJ - WS-EPR-R78 (SUB2 2)
 18191             MOVE EW-EPR-R78    TO EW-EPR-PRO
 18192                                   EW-EPR-ST
 18193             GO TO 4512-BUILD-EPEC-CONTINUE
 18194         ELSE
 18195             GO TO 4512-BUILD-EPEC-CONTINUE.
 18196
 18197     IF OB-DATE-3-USED
 18198         IF WS-EPR-R78 (SUB2 3) NOT EQUAL +0
 18199             COMPUTE EW-EPR-R78 = EW-ISS-PRM - EW-CNC-PRM -
 18200                           EW-EPR-R78-ADJ - WS-EPR-R78 (SUB2 3)
 18201             MOVE EW-EPR-R78    TO EW-EPR-PRO
 18202                                   EW-EPR-ST
 18203             GO TO 4512-BUILD-EPEC-CONTINUE
 18204         ELSE
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 350
* ECS010T1.cbl
 18205             GO TO 4512-BUILD-EPEC-CONTINUE.
 18206
 18207 4512-BUILD-EPEC-CONTINUE.
 18208
 18209     MOVE EW-EPR-R78                    TO EP-PRM-78.
 18210     MOVE EW-EPR-PRO                    TO EP-PRM-PR.
 18211     MOVE EW-EPR-ST                     TO EP-PRM-ST.
 18212
 18213     MOVE EW-EPR-R78-ADJ                TO EP-PRM-78-ADJ.
 18214     MOVE EW-EPR-PRO-ADJ                TO EP-PRM-PR-ADJ.
 18215     MOVE EW-EPR-ST-ADJ                 TO EP-PRM-ST-ADJ.
 18216
 18217     MOVE EW-ISS-PRM-TAX                TO EP-PRM-TAX
 18218
 18219     MOVE EW-CLM-AMT                    TO EP-CLM-AMT.
 18220     MOVE EW-CLM-CNT                    TO EP-CLM-CNT.
 18221     MOVE EW-CLM-CRT                    TO EP-CLM-CRT.
 18222
 18223     MOVE EW-CLM-PAYCUR                 TO EP-CLM-DU.
 18224     MOVE ZEROS                         TO EP-CLM-PV.
 18225
 18226     IF EP-RCD-TYPE = 'A' OR 'U'
 18227         IF CARRIER-UEP-PCT (CLAS-INDEXCN) NOT = ZEROS
 18228             PERFORM 4599A-CALC-IBNR THRU 4599A-CALC-EXIT.
 18229
 18230     MOVE EW-CLM-IBNR                   TO EP-CLM-IBNR.
 18231
 18232     MOVE EW-CLM-FUTRSV                 TO EP-LOSS-RESV.
 18233     MOVE ZEROS                         TO EP-CLAIM-ADJ.
 18234
 18235     MOVE EW-INFORCE-CNT                TO EP-INFORCE-CNT.
 18236
 18237     IF EW-ISS-CNT = ZERO
 18238         MOVE ZERO                      TO EP-AVG-ORIG-TERM
 18239                                           EP-AVG-AGE
 18240       ELSE
 18241         COMPUTE EP-AVG-ORIG-TERM ROUNDED =
 18242                                EW-ORIG-TERM / EW-ISS-CNT
 18243         COMPUTE EP-AVG-AGE ROUNDED = EW-AGE / EW-ISS-CNT.
 18244
 18245     IF EW-INFORCE-CNT = ZERO
 18246         MOVE ZERO                      TO EP-AVG-REM-TERM
 18247       ELSE
 18248         COMPUTE EP-AVG-REM-TERM ROUNDED =
 18249                             EW-REM-TERM / EW-INFORCE-CNT.
 18250
 18251     IF EW-ISS-BEN = ZERO
 18252         MOVE ZERO                      TO EP-WEIGHTED-ORIG-TERM
 18253                                           EP-WEIGHTED-AGE
 18254       ELSE
 18255         COMPUTE EP-WEIGHTED-ORIG-TERM ROUNDED =
 18256                                  EW-TERM-BEN / EW-ISS-BEN
 18257         COMPUTE EP-WEIGHTED-AGE ROUNDED =
 18258                                   EW-AGE-BEN / EW-ISS-BEN.
 18259
 18260     MOVE ZEROS                         TO
 18261         EP-RETRO-EXPENSES  EP-RETRO-PAYMENTS  EP-RETRO-OTH-COMM
 18262         EP-MORT-RESV       EP-IN-FORCE        EP-ADJUST.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 351
* ECS010T1.cbl
 18263
 18264     MOVE EW-COV-DTE                    TO EP-HI-COV-DT
 18265                                           WS-EP-HI-COV-DT-N.
 18266     MOVE HIGH-CERT                     TO EP-HI-CERT
 18267                                           WS-EP-HI-CERT-N.
 18268     MOVE LOW-CERT                      TO EP-LO-CERT
 18269                                           WS-EP-LO-CERT-N.
 18270     IF DTE-PGM-OPT = '3'
 18271         MOVE 'P'                       TO EP-PURGE.
 18272
 18273     IF  DTE-OPT-RESERVE-METHOD-UNAUTH
 18274         GO TO 4514-CONTINUE.
 18275
 18276     MOVE EPEC-CLM-EXP (SUB2)    TO EP-CLM-EXP.
 18277
 18278     IF  EPEC-LIFE-CTR-NOT-USED (SUB2)
 18279         MOVE +1                 TO EP-LIFE-YEARS
 18280     ELSE
 18281         MOVE ZEROS              TO W-LIFE-YEARS
 18282         PERFORM 4515-DETERMINE-LIFE-YEARS THRU 4515-EXIT
 18283                 VARYING
 18284             SUBM FROM +1 BY +1
 18285                 UNTIL
 18286             SUBM GREATER THAN +13
 18287         COMPUTE W-LIFE-YEARS-INT ROUNDED
 18288             = W-LIFE-YEARS / 12
 18289             - (EPEC-LIFE-CTR (SUB2 1)
 18290             + EPEC-LIFE-CTR (SUB2 13)) / 24
 18291         COMPUTE EP-LIFE-YEARS ROUNDED = W-LIFE-YEARS-INT
 18292         IF  EP-LIFE-YEARS LESS THAN +1
 18293             MOVE +1             TO EP-LIFE-YEARS.
 18294
 18295 4514-CONTINUE.
 18296
 18297     PERFORM 4900-WRITE-SUMMARY-EXTRACTS THRU 4999-WRT-SUMMARY-X.
 18298
 18299     MOVE SPACES                        TO EC-RECORD.
 18300     MOVE '1'                           TO WS-SEQ-NBR.
 18301     MOVE +0                            TO SUB3.
 18302     MOVE +0                            TO SUB4.
 18303     PERFORM 4520-BUILD-EPEC-LOAD-COMM
 18304         THRU 4539-BUILD-EPEC-LOAD-COMM-X
 18305         UNTIL SUB4  GREATER THAN WS-LOOP-MAX.
 18306
 18307     GO TO 4518-BUILD-EPEC-RCD-X.
 18308
 18309 4515-DETERMINE-LIFE-YEARS.
 18310
 18311     ADD EPEC-LIFE-CTR (SUB2 SUBM)      TO W-LIFE-YEARS.
 18312
 18313 4515-EXIT.
 18314     EXIT.
 18315
 18316 4518-BUILD-EPEC-RCD-X.
 18317     EXIT.
 18318
 18319 4519-BUILD-EPEC-EXT-X.
 18320     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 352
* ECS010T1.cbl
 18321
 18322 4520-BUILD-EPEC-LOAD-COMM.
 18323
 18324     PERFORM 4545-BUILD-BASE  THRU  4545-BUILD-BASE-X.
 18325
 18326     ADD +1 TO SUB3  SUB4.
 18327     MOVE ZEROS                  TO LEVELS-BUILT.
 18328
 18329 4530-BUILD-EPEC-LOAD-COMM-LOOP.
 18330
 18331     IF SUB4 GREATER THAN WS-LOOP-MAX
 18332         IF AGT-SW = 'X'
 18333             PERFORM 4900-WRITE-SUMMARY-EXTRACTS
 18334                 THRU 4999-WRT-SUMMARY-X
 18335             MOVE ' '            TO AGT-SW
 18336             MOVE WS-LOOP-MAX    TO  SUB4
 18337             GO TO 4539-BUILD-EPEC-LOAD-COMM-X
 18338         ELSE
 18339             GO TO 4539-BUILD-EPEC-LOAD-COMM-X.
 18340
 18341     IF LEVELS-BUILT EQUAL +5
 18342         IF AGT-SW = 'X'
 18343             PERFORM 4900-WRITE-SUMMARY-EXTRACTS
 18344                 THRU 4999-WRT-SUMMARY-X
 18345             MOVE ' '            TO AGT-SW
 18346             MOVE ZEROS          TO LEVELS-BUILT
 18347             ADD 1 TO WS-SEQ-NBR
 18348             PERFORM 4545-BUILD-BASE  THRU  4545-BUILD-BASE-X
 18349             PERFORM 4540-BUILD-EPEC-CLEAR  THRU
 18350                     4540-BUILD-CLEAR-X
 18351                 VARYING SUB3 FROM +1 BY +1
 18352                 UNTIL SUB3 GREATER THAN +5
 18353             MOVE +1             TO SUB3
 18354             GO TO 4531-BUILD-EPEC-LOAD-COMM
 18355         ELSE
 18356             MOVE +1             TO SUB3
 18357             MOVE ZEROS          TO LEVELS-BUILT
 18358             GO TO 4531-BUILD-EPEC-LOAD-COMM.
 18359
 18360     IF SUB4 GREATER THAN WS-LOOP-MAX
 18361         IF AGT-SW = 'X'
 18362             PERFORM 4900-WRITE-SUMMARY-EXTRACTS
 18363                 THRU 4999-WRT-SUMMARY-X
 18364             MOVE ' '                   TO AGT-SW
 18365             GO TO 4539-BUILD-EPEC-LOAD-COMM-X
 18366         ELSE
 18367             GO TO 4539-BUILD-EPEC-LOAD-COMM-X.
 18368
 18369 4531-BUILD-EPEC-LOAD-COMM.
 18370
 18371     IF (EW-AGT-NO (SUB4) = SPACES)
 18372                  OR
 18373        ((EW-ISS-COM (SUB4) = ZEROS) AND
 18374         (EW-CNC-COM (SUB4) = ZEROS) AND
 18375         (EW-ECR-R78 (SUB4) = ZEROS) AND
 18376         (EW-ECR-R78-ADJ (SUB4) = ZEROS) AND
 18377         (EW-ECR-PRO (SUB4) = ZEROS) AND
 18378         (EW-ECR-PRO-ADJ (SUB4) = ZEROS) AND
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 353
* ECS010T1.cbl
 18379         (EW-ECR-ST (SUB4) = ZEROS))
 18380         PERFORM 4540-BUILD-EPEC-CLEAR
 18381             THRU 4540-BUILD-CLEAR-X
 18382         ADD +1 TO SUB4
 18383         GO TO 4530-BUILD-EPEC-LOAD-COMM-LOOP.
 18384
 18385     MOVE 'X'                           TO AGT-SW.
 18386     MOVE EW-AGT-NO (SUB4)              TO EC-AGT-NO (SUB3).
 18387     MOVE EW-AGT-TYPE (SUB4)            TO EC-AGT-TYPE (SUB3).
 18388     MOVE EW-ISS-COM (SUB4)             TO EC-ISS-COMM (SUB3).
 18389     MOVE EW-CNC-COM (SUB4)             TO EC-CNC-COMM (SUB3).
 18390     MOVE EW-ECR-R78 (SUB4)             TO EC-COMM-78 (SUB3).
 18391     MOVE EW-ECR-PRO (SUB4)             TO EC-COMM-PR (SUB3).
 18392     MOVE EW-ECR-ST (SUB4)              TO EC-COMM-ST (SUB3).
 18393     MOVE EW-ECR-R78-ADJ (SUB4)         TO EC-COMM-78-ADJ (SUB3).
 18394     MOVE EW-ECR-PRO-ADJ (SUB4)         TO EC-COMM-PR-ADJ (SUB3).
 18395
 18396     ADD +1 TO SUB3 SUB4 LEVELS-BUILT.
 18397
 18398     GO TO 4530-BUILD-EPEC-LOAD-COMM-LOOP.
 18399
 18400 4539-BUILD-EPEC-LOAD-COMM-X.
 18401     EXIT.
 18402
 18403 4540-BUILD-EPEC-CLEAR.
 18404
 18405     MOVE ZEROS                         TO EC-AGT-NO (SUB3).
 18406     MOVE SPACE                         TO EC-AGT-TYPE (SUB3).
 18407     MOVE ZEROS                         TO EC-ISS-COMM (SUB3)
 18408                                           EC-CNC-COMM (SUB3)
 18409                                           EC-COMM-78 (SUB3)
 18410                                           EC-COMM-PR (SUB3)
 18411                                           EC-COMM-ST (SUB3)
 18412                                           EC-COMM-78-ADJ (SUB3)
 18413                                           EC-COMM-PR-ADJ (SUB3).
 18414
 18415 4540-BUILD-CLEAR-X.
 18416     EXIT.
 18417
 18418 4541-CALC-IBNR.
 18419
 18420     MOVE +0                    TO TOT-AH-IBNR
 18421                                   TOT-AH-PRM
 18422                                   TOT-AH-PD-CLMS
 18423                                   TOT-AH-CLMRSV
 18424                                   TOT-LF-IBNR
 18425                                   TOT-LF-PRM
 18426                                   TOT-LF-PD-CLMS
 18427                                   TOT-LF-CLMRSV
 18428
 18429     MOVE +0                    TO RTOT-AH-IBNR
 18430                                   RTOT-AH-PRM
 18431                                   RTOT-AH-PD-CLMS
 18432                                   RTOT-AH-CLMRSV
 18433                                   RTOT-LF-IBNR
 18434                                   RTOT-LF-PRM
 18435                                   RTOT-LF-PD-CLMS
 18436                                   RTOT-LF-CLMRSV
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 354
* ECS010T1.cbl
 18437
 18438     PERFORM VARYING SUB2 FROM +1 BY +1 UNTIL
 18439        (SUB2 > +900)
 18440        OR (EPEC-REIN-CO (SUB2) = ZEROS)
 18441*       IF W-UNDERWRITTEN-DATA
 18442*          MOVE EPEC-LEVELS-II (SUB2)
 18443*                                TO EPEC-WORK
 18444*       ELSE
 18445           MOVE EPEC-LEVELS (SUB2)
 18446                                 TO EPEC-WORK
 18447*       END-IF
 18448        IF EW-REIN-CO = SPACES
 18449           IF EW-LF-AH = 'L'
 18450              COMPUTE TOT-LF-PRM = TOT-LF-PRM
 18451                 + EW-EPR-ST
 18452              COMPUTE TOT-LF-PD-CLMS = TOT-LF-PD-CLMS
 18453                 + EW-CLM-AMT
 18454              COMPUTE TOT-LF-CLMRSV = TOT-LF-CLMRSV
 18455                 + EW-CLM-PAYCUR + EW-CLM-FUTRSV
 18456           ELSE
 18457              COMPUTE TOT-AH-PRM = TOT-AH-PRM
 18458                 + EW-EPR-ST
 18459              COMPUTE TOT-AH-PD-CLMS = TOT-AH-PD-CLMS
 18460                 + EW-CLM-AMT
 18461              COMPUTE TOT-AH-CLMRSV = TOT-AH-CLMRSV
 18462                 + EW-CLM-PAYCUR + EW-CLM-FUTRSV
 18463        ELSE
 18464           IF EW-LF-AH = 'L'
 18465              COMPUTE RTOT-LF-PRM = RTOT-LF-PRM
 18466                 + EW-EPR-ST
 18467              COMPUTE RTOT-LF-PD-CLMS = RTOT-LF-PD-CLMS
 18468                 + EW-CLM-AMT
 18469              COMPUTE RTOT-LF-CLMRSV = RTOT-LF-CLMRSV
 18470                 + EW-CLM-PAYCUR + EW-CLM-FUTRSV
 18471           ELSE
 18472              COMPUTE RTOT-AH-PRM = RTOT-AH-PRM
 18473                 + EW-EPR-ST
 18474              COMPUTE RTOT-AH-PD-CLMS = RTOT-AH-PD-CLMS
 18475                 + EW-CLM-AMT
 18476              COMPUTE RTOT-AH-CLMRSV = RTOT-AH-CLMRSV
 18477                 + EW-CLM-PAYCUR + EW-CLM-FUTRSV
 18478           END-IF
 18479        END-IF
 18480     END-PERFORM
 18481
 18482     COMPUTE TOT-AH-IBNR = (TOT-AH-PRM * .6)
 18483        - TOT-AH-PD-CLMS - TOT-AH-CLMRSV
 18484     IF TOT-AH-IBNR < ZEROS
 18485        COMPUTE TOT-AH-IBNR = TOT-AH-PRM * .15
 18486     END-IF
 18487     COMPUTE TOT-LF-IBNR = (TOT-LF-PRM * .6)
 18488        - TOT-LF-PD-CLMS - TOT-LF-CLMRSV
 18489     IF TOT-LF-IBNR < ZEROS
 18490        COMPUTE TOT-LF-IBNR = TOT-LF-PRM * .15
 18491     END-IF
 18492
 18493     COMPUTE RTOT-AH-IBNR = (RTOT-AH-PRM * .6)
 18494        - RTOT-AH-PD-CLMS - RTOT-AH-CLMRSV
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 355
* ECS010T1.cbl
 18495     IF RTOT-AH-IBNR < ZEROS
 18496        COMPUTE RTOT-AH-IBNR = RTOT-AH-PRM * .15
 18497     END-IF
 18498     COMPUTE RTOT-LF-IBNR = (RTOT-LF-PRM * .6)
 18499        - RTOT-LF-PD-CLMS - RTOT-LF-CLMRSV
 18500     IF RTOT-LF-IBNR < ZEROS
 18501        COMPUTE RTOT-LF-IBNR = RTOT-LF-PRM * .15
 18502     END-IF
 18503
 18504     PERFORM VARYING SUB2 FROM +1 BY +1 UNTIL
 18505        (SUB2 > +900)
 18506        OR (EPEC-REIN-CO (SUB2) = ZEROS)
 18507*       IF W-UNDERWRITTEN-DATA
 18508*          MOVE EPEC-LEVELS-II (SUB2)
 18509*                                TO EPEC-WORK
 18510*       ELSE
 18511           MOVE EPEC-LEVELS (SUB2)
 18512                                 TO EPEC-WORK
 18513*       END-IF
 18514        IF EW-REIN-CO = SPACES
 18515           IF EW-LF-AH = 'L'
 18516              COMPUTE IBNR-FACT ROUNDED = EW-EPR-ST
 18517                 / TOT-LF-PRM
 18518              COMPUTE EW-CLM-IBNR ROUNDED = IBNR-FACT
 18519                 * RTOT-LF-IBNR
 18520*                * TOT-LF-IBNR
 18521           ELSE
 18522              COMPUTE IBNR-FACT ROUNDED = EW-EPR-ST
 18523                 / TOT-AH-PRM
 18524              COMPUTE EW-CLM-IBNR ROUNDED = IBNR-FACT
 18525                 * RTOT-AH-IBNR
 18526*                * TOT-AH-IBNR
 18527           END-IF
 18528        ELSE
 18529           IF EW-LF-AH = 'L'
 18530              COMPUTE IBNR-FACT ROUNDED = EW-EPR-ST
 18531                 / RTOT-LF-PRM
 18532              COMPUTE EW-CLM-IBNR ROUNDED = IBNR-FACT
 18533                 * RTOT-LF-IBNR
 18534           ELSE
 18535              COMPUTE IBNR-FACT ROUNDED = EW-EPR-ST
 18536                 / RTOT-AH-PRM
 18537              COMPUTE EW-CLM-IBNR ROUNDED = IBNR-FACT
 18538                 * RTOT-AH-IBNR
 18539           END-IF
 18540        END-IF
 18541*       IF W-UNDERWRITTEN-DATA
 18542*          MOVE EPEC-WORK        TO EPEC-LEVELS-II (SUB2)
 18543*       ELSE
 18544           MOVE EPEC-WORK        TO EPEC-LEVELS (SUB2)
 18545*       END-IF
 18546     END-PERFORM
 18547
 18548     .
 18549 4541-EXIT.
 18550     EXIT.
 18551
 18552 4545-BUILD-BASE.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 356
* ECS010T1.cbl
 18553
 18554     MOVE 'EC'                   TO EC-RECORD-ID.
 18555     MOVE DTE-CLASIC-COMPANY-CD  TO EP-COMPANY-CD.
 18556     MOVE AM-MSTR-CNTRL          TO EC-CONTROL.
 18557     MOVE AM-EXPIRE-DT           TO WS-EC-EXP-DTE-N.
 18558     MOVE AM-EFFECT-DT           TO EC-EFF-DTE
 18559                                    WS-EC-EFF-DTE.
 18560     MOVE EW-REIN-CO             TO EC-REI-CO.
 18561     IF EC-REI-CO NOT = SPACES
 18562         MOVE 'R'                TO EC-REIN.
 18563     MOVE EW-LF-AH               TO EC-RCD-TYPE.
 18564     MOVE EW-BEN-TYPE            TO EC-BEN-CODE.
 18565     IF DTE-PGM-OPT = '3'
 18566         MOVE 'P'                TO EC-PURGE.
 18567     MOVE WS-SEQ-NBR             TO EC-SEQ-NBR.
 18568
 18569 4545-BUILD-BASE-X.
 18570     EXIT.
 18571
 18572******************************************************************
 18573***        CLEAR EARNED PREMIUM  AND  REINSURANCE TOTALS       ***
 18574******************************************************************
 18575
 18576 4550-CLEAR-EPEC-TOTALS.
 18577
 18578     MOVE LOW-CERT             TO SV-LO-CERT.
 18579     MOVE HIGH-CERT            TO SV-HI-CERT.
 18580     MOVE SPACES               TO LOW-CTL.
 18581     MOVE ZEROS                TO LOW-CERT  HIGH-CERT.
 18582
 18583     MOVE +1                   TO SUB9.
 18584     MOVE +0                   TO SUB10.
 18585     MOVE ZERO                 TO EW-REIN-CO
 18586                                  EW-BEN-TYPE.
 18587     MOVE SPACE                TO EP-FLG
 18588                                  EW-LF-AH
 18589                                  EW-LEVEL-USED
 18590                                  W-TABLE-USED-SW.
 18591
 18592     MOVE +0                   TO EW-ISS-BEN     EW-ISS-BEN-GROSS
 18593                                  EW-CNC-BEN     EW-CNC-BEN-GROSS
 18594                                  EW-ISS-PRM     EW-ISS-PRM-GROSS
 18595                                  EW-CNC-PRM     EW-CNC-PRM-GROSS
 18596                                  EW-EPR-R78     EW-EPR-R78-ADJ
 18597                                  EW-EPR-PRO     EW-EPR-PRO-ADJ
 18598                                  EW-EPR-ST      EW-EPR-ST-ADJ
 18599                                  EW-CLM-AMT     EW-COV-DTE
 18600                                  EW-CLM-IBNR    EW-CLM-PAYCUR
 18601                                  EW-CLM-FUTRSV  EW-CLM-CNT
 18602                                  EW-CLM-CRT     EW-ISS-CNT
 18603                                  EW-CNC-CNT     EW-AGE
 18604                                  EW-ORIG-TERM   EW-INFORCE-CNT
 18605                                  EW-AGE-BEN     EW-TERM-BEN
 18606                                  EW-ISS-PRM-TAX
 18607                                  EW-REM-TERM.
 18608
 18609     MOVE +1 TO SUB1.
 18610     PERFORM 4555-CLEAR-EPEC-COMM WS-LOOP-MAX TIMES.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 357
* ECS010T1.cbl
 18611     PERFORM 4560-CLEAR-EPEC-ALL VARYING SUB1 FROM +1 BY +1
 18612         UNTIL EPEC-REIN-CO (SUB1) = ZEROS.
 18613     MOVE EPEC-OPT-WORK-TABLE    TO EPEC-OPT-DATA-TABLE
 18614                                    EPEC-UNDW-OPT-DATA-TABLE.
 18615     PERFORM 4570-CLEAR-EPEC-SUB-A VARYING SUB1 FROM +1 BY +1
 18616         UNTIL EPEC-SUB-REIN (SUB1) = ZEROS.
 18617
 18618     PERFORM 4590-INIT-OB THRU 4590-EXIT
 18619         VARYING SUB3 FROM +1 BY +1
 18620*        UNTIL SUB3 GREATER THAN +300.
 18621*        UNTIL SUB3 GREATER THAN +220.
 18622         UNTIL SUB3 GREATER THAN +900.
 18623
 18624     GO TO 4589-CLEAR-EPEC-TOTALS-X.
 18625
 18626 4555-CLEAR-EPEC-COMM.
 18627
 18628     MOVE +0 TO EW-ISS-COM (SUB1)  EW-CNC-COM (SUB1)
 18629                EW-ECR-R78 (SUB1)  EW-ECR-R78-ADJ (SUB1)
 18630                EW-ECR-PRO (SUB1)  EW-ECR-PRO-ADJ (SUB1)
 18631                EW-ECR-ST  (SUB1).
 18632     MOVE SPACES                 TO EW-AGT-NO (SUB1)
 18633                                    EW-AGT-TYPE (SUB1).
 18634
 18635     ADD +1 TO SUB1.
 18636
 18637 4560-CLEAR-EPEC-ALL.
 18638
 18639     MOVE EPEC-WORK              TO EPEC-LEVELS (SUB1)
 18640                                    EPEC-LEVELS-II (SUB1).
 18641     MOVE W-LIFE-YEARS-ZERO      TO EPEC-OPT-GRP (SUB1).
 18642
 18643 4570-CLEAR-EPEC-SUB-A.
 18644
 18645     MOVE ZEROS TO EPEC-SUB-REIN (SUB1).
 18646     PERFORM 4580-CLEAR-EPEC-SUB-B VARYING SUB2 FROM +1 BY +1
 18647*        UNTIL SUB2 GREATER +300.
 18648         UNTIL SUB2 GREATER +900.
 18649
 18650 4580-CLEAR-EPEC-SUB-B.
 18651
 18652     MOVE ZEROS TO EPEC-SUB-LF (SUB1 SUB2).
 18653     MOVE ZEROS TO EPEC-SUB-AH (SUB1 SUB2).
 18654
 18655 4589-CLEAR-EPEC-TOTALS-X.
 18656     EXIT.
 18657
 18658 4590-INIT-OB.
 18659
 18660     MOVE +0 TO WS-EPR-R78 (SUB3 1).
 18661     MOVE +0 TO WS-EPR-R78 (SUB3 2).
 18662     MOVE +0 TO WS-EPR-R78 (SUB3 3).
 18663
 18664 4590-EXIT.
 18665     EXIT.
 18666
 18667 4599-BUILD-EPEC-EXTRACT-X.
 18668     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 358
* ECS010T1.cbl
 18669
 18670*********************************************************
 18671*  THIS ROUTINE IS USED TO CALCULATE THE A&H IBNR       *
 18672*  RESERVES USING A PERCENTAGE OF THE UNEARNED PREMIUM. *
 18673*  THESE PERCENTAGES ARE ENTERED THROUGH SCREEN EL105A  *
 18674*  (CARRIER CONTROLS) AND PASSED THROUGHOUT THE SYSTEM  *
 18675*  IN THE DATE CARD.                                    *
 18676*  'CARRIER-UEP-PCT' IS THE ACTUAL PERCENT PER CARRIER. *
 18677*********************************************************
 18678
 18679 4599A-CALC-IBNR.
 18680
 18681     COMPUTE EW-CLM-IBNR =  ((EP-ISS-PRM - EP-CNC-PRM) -
 18682        (((EP-PRM-78 + EP-PRM-78-ADJ)
 18683                              * CARRIER-R78-PCT (CLAS-INDEXCN)) +
 18684         ((EP-PRM-PR + EP-PRM-PR-ADJ)
 18685                              * CARRIER-PRO-PCT (CLAS-INDEXCN))))
 18686                         * CARRIER-UEP-PCT (CLAS-INDEXCN).
 18687
 18688     IF EW-CLM-IBNR NOT GREATER THAN ZEROS
 18689         MOVE ZEROS                 TO EW-CLM-IBNR
 18690         GO TO 4599A-CALC-EXIT.
 18691
 18692     IF EP-REIN = 'R'
 18693         MOVE 'Y'                   TO W-REIN-PROCESS-IND.
 18694
 18695     PERFORM 4740-CREATE-DETAIL-EXTR THRU 4740-EXIT.
 18696
 18697 4599A-CALC-EXIT.
 18698      EXIT.
 18699 4599B-SEARCH.
 18700      EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 359
* ECS010T1.cbl
 18702******************************************************************
 18703***         CALCULATE OPTIONAL METHOD I B N R                  ***
 18704******************************************************************
 18705
 18706 4600-GET-OPT-IBNR.
 18707
 18708     IF  CR-POLICY-IS-ACTIVE
 18709         IF  CR-POLICY-IS-REISSUE
 18710             OR CR-POLICY-IS-MONTHLY
 18711             IF  W-LIFE
 18712                 GO TO 4600-EXIT
 18713             ELSE
 18714                 NEXT SENTENCE
 18715         ELSE
 18716             NEXT SENTENCE
 18717     ELSE
 18718         IF  W-LIFE
 18719             GO TO 4600-EXIT.
 18720
 18721     IF  W-LIFE
 18722         PERFORM 4620-DETERMINE-LIFE-IBNR THRU 4620-EXIT
 18723     ELSE
 18724         PERFORM 4640-GET-A-H-EARNED-PREMIUM THRU 4640-EXIT.
 18725
 18726 4600-EXIT.
 18727     EXIT.
 18728
 18729 4620-DETERMINE-LIFE-IBNR.
 18730
 18731     IF  CR-LF-POLICY-IS-ACTIVE
 18732         ADD +1                  TO W-LF-ACTIVE
 18733         IF  CR-LF-POLICY-IS-REISSUE
 18734             OR CR-LF-POLICY-IS-MONTHLY
 18735             MOVE ZEROS          TO W-WK-IBNR
 18736             ADD +1              TO W-LF-REISSUE
 18737             GO TO 4620-EXIT
 18738         ELSE
 18739             NEXT SENTENCE
 18740     ELSE
 18741         ADD +1                  TO W-LF-INACTIVE
 18742         MOVE ZEROS              TO W-WK-IBNR
 18743         GO TO 4620-EXIT.
 18744
 18745     IF  CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'B'
 18746         MOVE ZEROS              TO W-WK-IBNR
 18747         ADD +1                  TO W-LF-CALC-B
 18748         GO TO 4620-EXIT.
 18749
 18750     IF  (CLAS-I-EP (CLAS-INDEXL) = 'B'
 18751                 AND
 18752             CLAS-I-CALC-TYPE (CLAS-INDEXL) NOT = 'L'
 18753                 AND
 18754             W-BAL-REMTRM NOT GREATER THAN ZERO)
 18755             OR
 18756         (CLAS-I-EP (CLAS-INDEXL) = 'B'
 18757                 AND
 18758             CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'L'
 18759                 AND
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 360
* ECS010T1.cbl
 18760             REM-TRM2 NOT GREATER THAN ZERO)
 18761         MOVE ZEROS              TO W-WK-IBNR
 18762         ADD +1                  TO W-LF-BALLOON
 18763         GO TO 4620-EXIT
 18764     ELSE
 18765         IF  (CLAS-I-EP (CLAS-INDEXL) NOT = 'B'
 18766                 AND
 18767             REM-TRM2 NOT GREATER THAN ZERO)
 18768             ADD +1              TO W-LF-REMTERM-0
 18769             MOVE ZEROS          TO W-WK-IBNR
 18770             GO TO 4620-EXIT.
 18771
 18772     PERFORM 4680-CALC-REMAINING-AMT-LF THRU 4680-EXIT.
 18773
 18774     IF  CP-REMAINING-AMT NOT GREATER THAN ZEROS
 18775         ADD +1                  TO W-LF-REMAMT-0
 18776         MOVE ZEROS              TO W-WK-IBNR
 18777         GO TO 4620-EXIT.
 18778
 18779     IF  AM-LIFE-IBNR-PCT NUMERIC
 18780             AND
 18781         AM-LIFE-IBNR-PCT GREATER THAN ZEROS
 18782         COMPUTE W-WK-IBNR ROUNDED
 18783             = CP-REMAINING-AMT
 18784             / 1000
 18785             * AM-LIFE-IBNR-PCT
 18786     ELSE
 18787         COMPUTE W-WK-IBNR ROUNDED
 18788             = CP-REMAINING-AMT
 18789             / 1000
 18790             * COMPANY-IBNR-LIFE-FACTOR.
 18791
 18792     IF  CR-LF-IS-REIN-ONLY
 18793         ADD +1                  TO W-LF-REIN
 18794     ELSE
 18795         ADD +1                  TO W-LF-DATA-USED
 18796         ADD W-WK-IBNR           TO W-LIFE-IBNR-IN
 18797         ADD CP-REMAINING-AMT    TO W-LIFE-REMAINING-AMT
 18798         IF  CR-LFTYP = '01'
 18799             ADD CP-REMAINING-AMT
 18800                                 TO W-01-REMAMT
 18801             ADD +1              TO W-01-DATA-USED
 18802         ELSE
 18803         IF  CR-LFTYP = '02'
 18804             ADD CP-REMAINING-AMT
 18805                                 TO W-02-REMAMT
 18806             ADD +1              TO W-02-DATA-USED
 18807         ELSE
 18808         IF  CR-LFTYP = '03'
 18809             ADD CP-REMAINING-AMT
 18810                                 TO W-03-REMAMT
 18811             ADD +1              TO W-03-DATA-USED
 18812         ELSE
 18813         IF  CR-LFTYP = '04'
 18814             ADD CP-REMAINING-AMT
 18815                                 TO W-04-REMAMT
 18816             ADD +1              TO W-04-DATA-USED
 18817         ELSE
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 361
* ECS010T1.cbl
 18818         IF  CR-LFTYP = '05'
 18819             ADD CP-REMAINING-AMT
 18820                                 TO W-05-REMAMT
 18821             ADD +1              TO W-05-DATA-USED
 18822         ELSE
 18823         IF  CR-LFTYP = '06'
 18824             ADD CP-REMAINING-AMT
 18825                                 TO W-06-REMAMT
 18826             ADD +1              TO W-06-DATA-USED
 18827         ELSE
 18828         IF  CR-LFTYP = '30'
 18829             ADD CP-REMAINING-AMT
 18830                                 TO W-30-REMAMT
 18831             ADD +1              TO W-30-DATA-USED
 18832         ELSE
 18833         IF  CR-LFTYP = '31'
 18834             ADD CP-REMAINING-AMT
 18835                                 TO W-31-REMAMT
 18836             ADD +1              TO W-31-DATA-USED
 18837         ELSE
 18838             ADD CP-REMAINING-AMT
 18839                                 TO W-XX-REMAMT
 18840             ADD +1              TO W-XX-DATA-USED.
 18841
 18842     IF  CR-POLICY-IS-REIN-ONLY
 18843             OR
 18844         CR-LF-IS-REIN-ONLY
 18845         ADD ISS-BEN             TO EPEC-REIN-ISS-BEN (SUB3)
 18846         MOVE 'R'                TO EPEC-REIN-ONLY-IND (SUB3)
 18847         ADD W-WK-IBNR           TO EPEC-LIFE-IBNR (SUB3)
 18848     ELSE
 18849         ADD W-WK-IBNR           TO EPEC-LIFE-IBNR (SUB3).
 18850
 18851 4620-EXIT.
 18852     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 362
* ECS010T1.cbl
 18854 4640-GET-A-H-EARNED-PREMIUM.
 18855
 18856     IF  CR-AH-POLICY-IS-ACTIVE
 18857         ADD +1                  TO W-AH-ACTIVE
 18858         IF  CR-AH-POLICY-IS-REISSUE
 18859             OR CR-AH-POLICY-IS-MONTHLY
 18860             ADD +1              TO W-AH-REISSUE
 18861         ELSE
 18862             NEXT SENTENCE
 18863     ELSE
 18864         ADD +1                  TO W-AH-INACTIVE.
 18865
 18866     IF  CLAS-I-CALC-TYPE (CLAS-INDEXA) = 'B'
 18867         ADD +1                  TO W-AH-CALC-B
 18868         GO TO 4640-EXIT.
 18869
 18870     IF  REM-TRM2 NOT GREATER THAN ZEROS
 18871         MOVE 'Y'                TO W-RTRM-0-SW
 18872     ELSE
 18873         MOVE SPACES             TO W-RTRM-0-SW.
 18874
 18875     PERFORM 4660-DETERMINE-EARNED-PREMIUM THRU 4660-EXIT.
 18876
 18877****** NOTE:  THERE IS AN ASSUMPTION THAT STATISTICALLY ONLY ONE
 18878******        ACTUALLY CLAIM PER 90 DAY PERIOD AND THAT THE CLAIM
 18879******        ITD FIELD (CR-DISAMT) CONTAINS ONLY THE AMOUNT OF
 18880******        THAT CLAIM.
 18881
 18882     PERFORM 4650-DETERMINE-CLM-AMT-AH THRU 4650-EXIT.
 18883
 18884     IF  CR-POLICY-IS-REIN-ONLY
 18885              OR
 18886         CR-AH-IS-REIN-ONLY
 18887         ADD +1                  TO W-AH-REIN
 18888         ADD ISS-BEN             TO EPEC-REIN-ISS-BEN (SUB3)
 18889         MOVE 'R'                TO EPEC-REIN-ONLY-IND (SUB3)
 18890         ADD W-CLMAMT            TO EPEC-CLAIMS-MADE-PAID (SUB3)
 18891         ADD W-EARNED-PREMIUM    TO EPEC-EARNED-PREMIUM-AH (SUB3)
 18892         GO TO 4640-EXIT.
 18893
 18894     ADD W-EARNED-PREMIUM        TO EPEC-EARNED-PREMIUM-AH (SUB3)
 18895                                    W-EPEC-EP-IN.
 18896     ADD W-CLMAMT                TO EPEC-CLAIMS-MADE-PAID (SUB3)
 18897                                    W-CLAIMS-MADE-PAID-IN.
 18898     ADD +1                      TO W-AH-DATA-USED.
 18899     ADD W-EARNED-PREMIUM-1      TO W-EPEC-EP-1.
 18900     ADD W-EARNED-PREMIUM-2      TO W-EPEC-EP-2.
 18901
 18902     IF  W-CLMAMT GREATER THAN ZEROS
 18903         ADD +1                  TO W-AH-CLAIM-CTR
 18904         ADD W-EARNED-PREMIUM    TO W-AH-CLAIM-EP.
 18905
 18906     IF  W-RTRM-0
 18907             AND
 18908         NOT CR-POLICY-IS-REIN-ONLY
 18909             AND
 18910         NOT CR-AH-IS-REIN-ONLY
 18911         ADD W-CLMAMT            TO W-RTRM-0-CLMAMT
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 363
* ECS010T1.cbl
 18912         ADD W-EARNED-PREMIUM-1  TO W-RTRM-EP-1
 18913         ADD W-EARNED-PREMIUM-2  TO W-RTRM-EP-2
 18914         ADD W-EARNED-PREMIUM    TO W-RTRM-EP
 18915         ADD +1                  TO W-AH-REMTERM-0.
 18916
 18917 4640-EXIT.
 18918     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 364
* ECS010T1.cbl
 18920 4650-DETERMINE-CLM-AMT-AH.
 18921
 18922     MOVE ZEROS                  TO W-CLMAMT.
 18923
 18924     IF  CR-DIS-DT NOT GREATER THAN ZEROS
 18925             OR
 18926         CR-DIS-DT NOT GREATER THAN W-CUTOFF-DATE
 18927         GO TO 4650-EXIT.
 18928
 18929     IF  CR-DIS-PTO-DT GREATER THAN ZEROS
 18930             AND
 18931         CR-DIS-PTO-DT GREATER THAN CR-DIS-DT
 18932         MOVE CR-DIS-DT              TO DC-GREG-DATE-CYMD
 18933         MOVE 'L'                    TO DC-OPTION-CODE
 18934         PERFORM 8000-DATE-CONVERT-ROUTINE
 18935             THRU 8099-DATE-CONVERT-X
 18936         MOVE DC-BIN-DATE-1          TO W-DIS-DT
 18937         MOVE CR-DIS-PTO-DT          TO DC-GREG-DATE-CYMD
 18938         MOVE 'L'                    TO DC-OPTION-CODE
 18939         PERFORM 8000-DATE-CONVERT-ROUTINE
 18940             THRU 8099-DATE-CONVERT-X
 18941         MOVE DC-BIN-DATE-1          TO W-DIS-PTO-DT
 18942         IF  DATE-CONVERSION-ERROR
 18943             DISPLAY 'CERT DATES ERROR' CR-FULL-CONTROL
 18944             MOVE 'CERT DATES ERROR' TO WS-ABEND-MESSAGE
 18945             MOVE DC-ERROR-CODE      TO WS-ABEND-FILE-STATUS
 18946             MOVE 0303               TO WS-ABEND-CODE
 18947             MOVE WS-ABEND-CODE      TO WS-RETURN-CODE
 18948             GO TO ABEND-PGM
 18949         ELSE
 18950             MOVE W-DIS-DT           TO DC-BIN-DATE-1
 18951             MOVE W-DIS-PTO-DT       TO DC-BIN-DATE-2
 18952             MOVE '1'                TO DC-OPTION-CODE
 18953             MOVE ZEROS              TO DC-ELAPSED-MONTHS
 18954                                        DC-ELAPSED-DAYS
 18955             PERFORM 8000-DATE-CONVERT-ROUTINE
 18956                 THRU 8099-DATE-CONVERT-X
 18957             IF  DATE-CONVERSION-ERROR
 18958                 DISPLAY 'DIS TO PTO DATE ERROR '
 18959                     CR-FULL-CONTROL
 18960                 MOVE 'DIS TO PTO DATE ERROR '
 18961                                     TO WS-ABEND-MESSAGE
 18962                 MOVE DC-ERROR-CODE  TO WS-ABEND-FILE-STATUS
 18963                 MOVE 0303           TO WS-ABEND-CODE
 18964                 MOVE WS-ABEND-CODE  TO WS-RETURN-CODE
 18965                 GO TO ABEND-PGM
 18966             ELSE
 18967                 COMPUTE W-CLMAMT ROUNDED
 18968                     = CR-AHAMT
 18969                     * (DC-ELAPSED-DAYS / 30)
 18970                 GO TO 4650-EXIT.
 18971
 18972     IF  CR-DIS-PAY-DT NOT GREATER THAN ZEROS
 18973             OR
 18974         CR-DIS-PAY-DT LESS THAN CR-DIS-DT
 18975         GO TO 4650-EXIT.
 18976
 18977     COMPUTE W-90-DAY-MAX ROUNDED
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 365
* ECS010T1.cbl
 18978         = CR-AHAMT * 3.
 18979
 18980     IF  CR-DISAMT NOT GREATER THAN W-90-DAY-MAX
 18981         MOVE CR-DISAMT          TO W-CLMAMT
 18982     ELSE
 18983         MOVE W-90-DAY-MAX       TO W-CLMAMT.
 18984
 18985     IF  NOT CR-POLICY-IS-REIN-ONLY
 18986              AND
 18987         NOT CR-AH-IS-REIN-ONLY
 18988         ADD +1          TO W-CLM-EXCEPT-CNT
 18989         ADD W-CLMAMT    TO W-CLM-EXCEPT-AMT.
 18990
 18991 4650-EXIT.
 18992     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 366
* ECS010T1.cbl
 18994 4660-DETERMINE-EARNED-PREMIUM.
 18995
 18996     MOVE ZEROS                  TO W-EARNED-PREMIUM.
 18997
 18998     PERFORM 4670-CALC-EP THRU 4670-EXIT.
 18999
 19000     MOVE W-EARNED-PREMIUM       TO W-EARNED-PREMIUM-1.
 19001
 19002     IF  CR-ENTRY-DATE NOT GREATER THAN W-CUTOFF-DATE
 19003         MOVE ZEROS              TO W-EARNED-PREMIUM
 19004         MOVE W-CUTOFF-DATE      TO VALUATION-DT
 19005         MOVE '7'                TO W-VAL-SOURCE
 19006         PERFORM 8500-REMAINING-TERM-ROUTINE
 19007             THRU 8599-REM-TERM-X
 19008         PERFORM 4666-SAVE-AHCR-DATA THRU 4666-EXIT
 19009         PERFORM 4800-CALC-EARNED-PREMIUM-AH THRU 4899-EXIT
 19010         PERFORM 4668-RESTORE-AHCR-DATA THRU 4668-EXIT
 19011         MOVE EPR-R78            TO W-OPT-R78
 19012         MOVE EPR-PRO            TO W-OPT-PRO
 19013         MOVE EPR-ST             TO W-OPT-ST
 19014         PERFORM 4670-CALC-EP THRU 4670-EXIT
 19015         MOVE W-EARNED-PREMIUM   TO W-EARNED-PREMIUM-2
 19016     ELSE
 19017         MOVE ZEROS              TO W-EARNED-PREMIUM-2.
 19018
 19019     COMPUTE W-EARNED-PREMIUM ROUNDED
 19020         = W-EARNED-PREMIUM-1 - W-EARNED-PREMIUM-2.
 19021
 19022     IF  W-EARNED-PREMIUM LESS THAN ZERO
 19023         ADD +1                  TO W-EP-LESS-THAN-0
 19024         MOVE ZERO               TO W-EARNED-PREMIUM.
 19025
 19026 4660-EXIT.
 19027     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 367
* ECS010T1.cbl
 19029 4666-SAVE-AHCR-DATA.
 19030
 19031     MOVE SPACES                 TO WX-STATUS-AT-CANCEL
 19032                                    WX-STATUS-AT-SETTLEMENT.
 19033
 19034     MOVE ZEROS                  TO WX-CANC-DT
 19035                                    WX-EOM-RUN-DATE
 19036                                    WX-SETTLEMENT-EXIT-DATE.
 19037
 19038     IF  CR-AH-CANC-DT GREATER THAN W-CUTOFF-DATE
 19039         MOVE CR-AH-CANC-DT      TO WX-CANC-DT
 19040         MOVE CR-AH-STATUS-AT-CANCEL
 19041                                 TO WX-STATUS-AT-CANCEL
 19042         MOVE ZEROS              TO CR-AH-CANC-DT
 19043                                    WS-CR-AH-CANC-DT-N
 19044         MOVE SPACES             TO CR-AH-STATUS-AT-CANCEL.
 19045
 19046     IF  CR-AH-SETTLEMENT-EXIT-DATE GREATER THAN W-CUTOFF-DATE
 19047         MOVE CR-AH-SETTLEMENT-EXIT-DATE
 19048                                 TO WX-SETTLEMENT-EXIT-DATE
 19049         MOVE CR-AH-STATUS-AT-SETTLEMENT
 19050                                 TO WX-STATUS-AT-SETTLEMENT
 19051         MOVE ZEROS              TO CR-AH-SETTLEMENT-EXIT-DATE
 19052                                 WS-CR-AH-SETTLEMENT-EXIT-DATEN
 19053         MOVE SPACES             TO CR-AH-STATUS-AT-SETTLEMENT.
 19054
 19055     MOVE EOM-RUN-DATE           TO WX-EOM-RUN-DATE.
 19056     MOVE W-CUTOFF-DATE          TO EOM-RUN-DATE.
 19057
 19058 4666-EXIT.
 19059     EXIT.
 19060
 19061 4668-RESTORE-AHCR-DATA.
 19062
 19063     IF  WX-CANC-DT GREATER THAN W-CUTOFF-DATE
 19064         MOVE WX-CANC-DT         TO CR-AH-CANC-DT
 19065                                    WS-CR-AH-CANC-DT-N
 19066         MOVE WX-STATUS-AT-CANCEL
 19067                                 TO CR-AH-STATUS-AT-CANCEL.
 19068
 19069     IF  WX-SETTLEMENT-EXIT-DATE GREATER THAN W-CUTOFF-DATE
 19070         MOVE WX-SETTLEMENT-EXIT-DATE
 19071                                 TO CR-AH-SETTLEMENT-EXIT-DATE
 19072                                 WS-CR-AH-SETTLEMENT-EXIT-DATEN
 19073         MOVE WX-STATUS-AT-SETTLEMENT
 19074                                 TO CR-AH-STATUS-AT-SETTLEMENT.
 19075
 19076     MOVE WX-EOM-RUN-DATE        TO EOM-RUN-DATE.
 19077
 19078 4668-EXIT.
 19079     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 368
* ECS010T1.cbl
 19081 4670-CALC-EP.
 19082
 19083     IF  STATE-ABBR (CLAS-INDEXS) = 'WY'
 19084         MOVE W-OPT-PRO          TO W-EARNED-PREMIUM
 19085         ADD W-EARNED-PREMIUM    TO W-WY-EP
 19086         GO TO 4670-EXIT.
 19087
 19088     IF  STATE-ABBR (CLAS-INDEXS) = 'VA'
 19089         MOVE W-OPT-ST           TO W-EARNED-PREMIUM
 19090         ADD W-EARNED-PREMIUM    TO W-VA-EP
 19091         GO TO 4670-EXIT.
 19092
 19093***** NOTE THIS ASSUMES THAT ONLY A&H COVERAGES ARE PROCESSED HERE
 19094
 19095     IF  CLAS-I-EP (CLAS-INDEXA) = 'M'
 19096         COMPUTE W-EARNED-PREMIUM
 19097             = (W-OPT-PRO + W-OPT-R78) / +2
 19098         ADD W-EARNED-PREMIUM    TO W-M-EP
 19099     ELSE
 19100         IF  CLAS-I-EP (CLAS-INDEXA) = 'R'
 19101             MOVE W-OPT-R78      TO W-EARNED-PREMIUM
 19102             ADD W-EARNED-PREMIUM
 19103                                 TO W-R-EP
 19104         ELSE
 19105             IF  CLAS-I-EP (CLAS-INDEXA) = 'P'
 19106                 MOVE W-OPT-PRO  TO W-EARNED-PREMIUM
 19107                 ADD W-EARNED-PREMIUM
 19108                                 TO W-P-EP
 19109             ELSE
 19110                 IF  CLAS-I-EP (CLAS-INDEXA) = '1'
 19111                     COMPUTE W-EARNED-PREMIUM ROUNDED
 19112                         = (W-OPT-PRO * +.6667)
 19113                         + (W-OPT-R78 * +.3333)
 19114                     ADD W-EARNED-PREMIUM
 19115                                 TO W-1-EP
 19116                 ELSE
 19117                     ADD +1      TO W-OTHERS-COUNT
 19118                     MOVE ZEROS  TO W-EARNED-PREMIUM.
 19119
 19120 4670-EXIT.
 19121     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 369
* ECS010T1.cbl
 19123 4680-CALC-REMAINING-AMT-LF.
 19124
 19125     MOVE LOW-VALUES             TO CP-INSURED-BIRTH-DT.
 19126     MOVE CR-AGE                 TO CP-ISSUE-AGE.
 19127     MOVE CR-APR                 TO CP-LOAN-APR.
 19128     MOVE CR-LOAN-TERM           TO CP-LOAN-TERM.
 19129
 19130     IF  CR-PMT-FREQ NOT GREATER THAN ZERO
 19131         MOVE +1                 TO CR-PMT-FREQ.
 19132
 19133     MOVE CR-PMT-FREQ            TO CP-PAY-FREQUENCY.
 19134
 19135     MOVE REM-TRM2               TO CP-REMAINING-TERM.
 19136     MOVE CR-LFAMT               TO CP-ORIGINAL-BENEFIT
 19137                                    CP-RATING-BENEFIT-AMT.
 19138     IF CP-STATE-STD-ABBRV = 'OR'
 19139         COMPUTE CP-RATING-BENEFIT-AMT = CR-LFAMT + CR-LFAMT-ALT.
 19140     MOVE CR-LFAMT-ALT           TO CP-ALTERNATE-BENEFIT.
 19141     MOVE CR-LFPRM               TO CP-ORIGINAL-PREMIUM.
 19142     MOVE ZEROS                  TO CP-REMAINING-AMT
 19143                                    CP-REMAINING-AMT-PRV
 19144                                    CP-RETURN-CODE
 19145                                    CP-RETURN-CODE-2.
 19146
 19147
 19148     CALL 'ELRAMTX' USING CALCULATION-PASS-AREA
 19149
 19150     IF  CP-RETURN-CODE NOT = ZERO
 19151         MOVE 'ERROR OCCURED REMAINING AMT CALCULATIONS'
 19152                             TO WS-ABEND-MESSAGE
 19153         MOVE CP-RETURN-CODE TO WS-ABEND-FILE-STATUS
 19154         MOVE 2001           TO WS-ABEND-CODE
 19155         GO TO ABEND-PGM.
 19156
 19157 4680-EXIT.
 19158     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 370
* ECS010T1.cbl
 19160******************************************************************
 19161***  BUILDS ACCOUNT LEVEL IBNR (DIRECT AND REIN)               ***
 19162******************************************************************
 19163
 19164 4700-CALC-OPT-IBNR.
 19165
 19166     MOVE EPEC-OPT-DATA-TABLE    TO EPEC-OPT-WORK-TABLE.
 19167     MOVE SPACE                  TO W-UNDERWRITING-SW.
 19168
 19169     PERFORM 4710-PROCESS-THRU-EPEC-TABLE THRU 4710-EXIT
 19170             VARYING
 19171         SUB2 FROM +1 BY +1
 19172             UNTIL
 19173*        SUB2 GREATER THAN 300.
 19174*        SUB2 GREATER THAN 220.
 19175         SUB2 GREATER THAN 900.
 19176
 19177     MOVE EPEC-UNDW-OPT-DATA-TABLE
 19178                                 TO EPEC-OPT-WORK-TABLE.
 19179     MOVE '*'                    TO W-UNDERWRITING-SW.
 19180
 19181     PERFORM 4710-PROCESS-THRU-EPEC-TABLE THRU 4710-EXIT
 19182             VARYING
 19183         SUB2 FROM +1 BY +1
 19184             UNTIL
 19185*        SUB2 GREATER THAN 300.
 19186*        SUB2 GREATER THAN 220.
 19187         SUB2 GREATER THAN 900.
 19188
 19189 4700-EXIT.
 19190     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 371
* ECS010T1.cbl
 19192 4710-PROCESS-THRU-EPEC-TABLE.
 19193
 19194     IF  EPEC-REIN-CO-OPT (SUB2) = ZEROS
 19195         GO TO 4710-EXIT.
 19196
 19197     IF  W-UNDERWRITTEN-DATA
 19198         MOVE EPEC-LEVELS-II (SUB2)  TO EPEC-WORK
 19199     ELSE
 19200         MOVE EPEC-LEVELS (SUB2)     TO EPEC-WORK.
 19201
 19202     IF EW-LEVEL-USED NOT = 'Y'
 19203         GO TO 4710-EXIT.
 19204
 19205     IF  EW-REIN-CO GREATER THAN SPACES
 19206         MOVE 'Y'                TO W-REIN-PROCESS-SW
 19207         IF  EPEC-REIN-ONLY-DATA (SUB2)
 19208             PERFORM 4760-PROCESS-REIN-ONLY THRU 4760-EXIT
 19209             IF  W-WK-IBNR GREATER THAN ZEROS
 19210                 PERFORM 4770-CREATE-REIN-DETAIL THRU 4770-EXIT
 19211                 GO TO 4710-EXIT
 19212             ELSE
 19213                 GO TO 4710-EXIT
 19214         ELSE
 19215             IF  EW-CLM-IBNR GREATER THAN ZEROS
 19216                 PERFORM 4770-CREATE-REIN-DETAIL THRU 4770-EXIT
 19217                 GO TO 4710-EXIT
 19218             ELSE
 19219                 GO TO 4710-EXIT.
 19220
 19221     MOVE SPACES                 TO W-REIN-PROCESS-SW.
 19222
 19223     IF  EW-LF-AH EQUAL 'L'
 19224         IF  EPEC-LIFE-IBNR (SUB2) EQUAL ZEROS
 19225             GO TO 4710-EXIT
 19226         ELSE
 19227             PERFORM 4720-PROCESS-LIFE THRU 4720-EXIT
 19228             ADD W-WK-IBNR       TO W-LIFE-IBNR
 19229     ELSE
 19230         IF  EPEC-EARNED-PREMIUM-AH (SUB2)
 19231                 GREATER THAN ZEROS
 19232             PERFORM 4730-PROCESS-A-H THRU 4730-EXIT
 19233             ADD W-WK-IBNR       TO W-AH-IBNR
 19234         ELSE
 19235             GO TO 4710-EXIT.
 19236
 19237     MOVE W-WK-IBNR              TO EW-CLM-IBNR.
 19238     MOVE EW-ISS-BEN             TO W-ISS-BEN.
 19239     MOVE EW-ISS-BEN-GROSS       TO W-ISS-BEN-GROSS.
 19240
 19241     IF  W-UNDERWRITTEN-DATA
 19242         MOVE EPEC-WORK          TO EPEC-LEVELS-II (SUB2)
 19243     ELSE
 19244         MOVE EPEC-WORK          TO EPEC-LEVELS (SUB2).
 19245
 19246
 19247     PERFORM 4740-CREATE-DETAIL-EXTR THRU 4740-EXIT.
 19248     PERFORM 4750-UPDATE-REIN THRU 4750-EXIT.
 19249
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 372
* ECS010T1.cbl
 19250 4710-EXIT.
 19251     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 373
* ECS010T1.cbl
 19253 4720-PROCESS-LIFE.
 19254
 19255     MOVE EPEC-LIFE-IBNR (SUB2)  TO W-WK-IBNR.
 19256
 19257 4720-EXIT.
 19258     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 374
* ECS010T1.cbl
 19260 4730-PROCESS-A-H.
 19261
 19262     IF  AM-TARGET-LOSS-RATIO NUMERIC
 19263             AND
 19264         AM-TARGET-LOSS-RATIO NOT EQUAL ZERO
 19265         MOVE AM-TARGET-LOSS-RATIO
 19266                                 TO W-TARGET-LOSS-RATIO
 19267     ELSE
 19268         IF  CLAS-INDEXS NOT GREATER THAN CLAS-MAXS
 19269             MOVE STATE-TARGET-LOSS-RATIO (CLAS-INDEXS)
 19270                                 TO W-TARGET-LOSS-RATIO
 19271             PERFORM 4735-GET-BUSINESS-ADJUSTMENT THRU 4735-EXIT.
 19272
 19273     IF  W-NOT-REIN-PROCESS
 19274         ADD EPEC-EARNED-PREMIUM-AH (SUB2) TO W-EPEC-EP
 19275         ADD EPEC-CLAIMS-MADE-PAID (SUB2)  TO W-CLAIMS-MADE-PAID.
 19276
 19277     COMPUTE W-IBNR-1 ROUNDED
 19278         = EPEC-EARNED-PREMIUM-AH (SUB2)
 19279         * COMPANY-IBNR-AH-FACTOR
 19280         * W-TARGET-LOSS-RATIO.
 19281
 19282     COMPUTE W-IBNR-2 ROUNDED
 19283         = (EPEC-EARNED-PREMIUM-AH (SUB2)
 19284         * W-TARGET-LOSS-RATIO)
 19285         - EPEC-CLAIMS-MADE-PAID (SUB2).
 19286
 19287     IF  W-IBNR-1 GREATER THAN W-IBNR-2
 19288         MOVE W-IBNR-1           TO W-WK-IBNR
 19289         IF  W-NOT-REIN-PROCESS
 19290             ADD +1              TO W-AH-IBNR-1-CNT
 19291             ADD W-IBNR-1        TO W-AH-IBNR-1
 19292         ELSE
 19293             NEXT SENTENCE
 19294     ELSE
 19295         MOVE W-IBNR-2           TO W-WK-IBNR
 19296         IF  W-NOT-REIN-PROCESS
 19297             ADD +1              TO W-AH-IBNR-2-CNT
 19298             ADD W-IBNR-2        TO W-AH-IBNR-2.
 19299
 19300 4730-EXIT.
 19301     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 375
* ECS010T1.cbl
 19303 4735-GET-BUSINESS-ADJUSTMENT.
 19304
 19305     IF  CR-GRPTYP NOT NUMERIC
 19306         MOVE '99'               TO INDEXBS
 19307     ELSE
 19308         MOVE CR-GRPTYP          TO INDEXBS.
 19309
 19310     IF  BUS-TRGT-LOSS-RATIO-MOD (INDEXBS) NUMERIC
 19311             AND
 19312         BUS-TRGT-LOSS-RATIO-MOD (INDEXBS)
 19313             NOT EQUAL ZEROS
 19314             AND
 19315         BUS-TRGT-LOSS-RATIO-MOD (INDEXBS)
 19316             NOT EQUAL +1.0000
 19317         MOVE INDEXBS           TO W-EDIT-7
 19318         COMPUTE W-TARGET-LOSS-RATIO ROUNDED
 19319             = W-TARGET-LOSS-RATIO
 19320             * BUS-TRGT-LOSS-RATIO-MOD (INDEXBS).
 19321
 19322 4735-EXIT.
 19323     EXIT.
 19324
 19325 4740-CREATE-DETAIL-EXTR.
 19326
 19327     IF DTE-PGM-OPT NOT = '1'
 19328         GO TO 4740-EXIT.
 19329
 19330     IF  EW-CLM-IBNR NOT GREATER THAN ZEROS
 19331         GO TO 4740-EXIT.
 19332
 19333     MOVE EOM-RUN-DATE           TO INCURRED-DATE.
 19334     MOVE ZEROS                  TO REPORTED-DATE
 19335                                    PAY-TO-DATE.
 19336
 19337     MOVE SPACES                 TO TR-DTL2.
 19338     MOVE 'ACTBENIBNR'           TO TRD-CERT.
 19339
 19340     MOVE EOM-YR                 TO TRD-ISYR.
 19341     MOVE EOM-MO                 TO TRD-ISMO.
 19342     MOVE EOM-DA                 TO TRD-ISDA.
 19343     MOVE ZERO                   TO TRD-AGE.
 19344
 19345     IF  EW-LF-AH EQUAL 'L'
 19346         MOVE LIFE-OVERRIDE-L6   TO TRD-RSV-DESC
 19347     ELSE
 19348         MOVE AH-OVERRIDE-L6     TO TRD-RSV-DESC.
 19349
 19350     MOVE SPACES                 TO TRD-PAYCURX
 19351                                    TRD-PAYCUR-SPACE
 19352                                    TRD-FUTRSV-SPACE
 19353                                    TRD-FUTRSVX.
 19354
 19355     MOVE EW-CLM-IBNR            TO TRD-IBNR.
 19356     MOVE 'IBNR'                 TO TRD-IBNRX.
 19357     MOVE EW-BEN-TYPE            TO TRD-BENEFIT-CODE.
 19358     MOVE 'BENEFIT - '           TO TRD-BENEFIT-X.
 19359
 19360     IF  W-UNDERWRITTEN-DATA
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 376
* ECS010T1.cbl
 19361         IF  W-REIN-IN-PROCESS
 19362             MOVE ' ACCT/BEN REIN RSV UW'
 19363                                 TO TRD-RSV-ACTION
 19364         ELSE
 19365             MOVE ' ACCT/BEN RESERVES UW'
 19366                                 TO TRD-RSV-ACTION
 19367     ELSE
 19368         IF  W-REIN-IN-PROCESS
 19369             MOVE ' ACCT/BEN REIN RSV'
 19370                                 TO TRD-RSV-ACTION
 19371         ELSE
 19372             MOVE ' ACCT/BEN RESERVES'
 19373                                 TO TRD-RSV-ACTION.
 19374
 19375     PERFORM 8690-PRINT-DETAIL-LINE THRU 8699-PRT-DETAIL-X.
 19376
 19377     MOVE SPACES                 TO DETAIL-EXTRACT.
 19378
 19379     IF  W-REIN-IN-PROCESS
 19380         MOVE EW-REIN-CO         TO DE-REI-COMP
 19381         MOVE 'R'                TO DE-REIN
 19382         MOVE EW-CLM-IBNR        TO DE-REI-IBNR
 19383         MOVE ZEROS              TO DE-IBNR
 19384     ELSE
 19385         MOVE EW-CLM-IBNR        TO DE-IBNR
 19386         MOVE ZEROS              TO DE-REI-IBNR.
 19387
 19388     MOVE 'DE'                   TO DE-RECORD-ID.
 19389     MOVE 'Y'                    TO DE-TRANS.
 19390     MOVE 'IBNRRSV'              TO DE-CLMNO.
 19391     MOVE '1'                    TO DE-ENTRY-STATUS.
 19392     MOVE 'ACTBENIBNR'           TO DE-CERT.
 19393
 19394     MOVE EOM-RUN-DATE           TO DE-EFF
 19395                                    WS-DE-EFF-N
 19396                                    DE-ENTRY-DTE
 19397                                    WS-DE-ENTRY-DTE-N.
 19398     MOVE INCURRED-DATE          TO DE-RSV-INCUR
 19399                                    WS-DE-RSV-INCUR-N.
 19400
 19401     MOVE AM-COMPANY-CD          TO DE-COMPANY-CD.
 19402     MOVE AM-MSTR-CNTRL          TO DE-CNTRL1.
 19403     MOVE AM-EXPIRE-DT           TO DE-ACC-EXP-DTE-RSV
 19404                                    WS-DE-ACC-EXP-DTE-RSV-N.
 19405     MOVE AM-EFFECT-DT           TO DE-ACC-EFF-DTE-RSV
 19406                                    WS-DE-ACC-EFF-DTE-RSV-N.
 19407
 19408     MOVE AM-NAME                TO DE-RSV-ACC-NAME.
 19409     MOVE AM-RECALC-COMM         TO DE-RECALC-CODE.
 19410     MOVE AM-REMIT-TO            TO DE-REMIT-TO.
 19411     MOVE AM-REPORT-CODE-1       TO DE-REPORT-CODE-1.
 19412     MOVE AM-REPORT-CODE-2       TO DE-REPORT-CODE-2.
 19413     MOVE AM-POOL-PRIME          TO DE-NCL-POOL-CODE.
 19414     MOVE AM-IG                  TO DE-IG.
 19415
 19416     IF W-UNDERWRITTEN-DATA
 19417         MOVE 'Y'                TO DE-UNDERWRITING-CODE
 19418     ELSE
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 377
* ECS010T1.cbl
 19419         MOVE 'N'                TO DE-UNDERWRITING-CODE.
 19420
 19421     IF  EW-LF-AH EQUAL 'L'
 19422         MOVE EW-BEN-TYPE        TO DE-LF-TYPE
 19423         MOVE '1'                TO DE-RESERVE-TYPE
 19424         MOVE ZEROS              TO DE-AH-TYPE
 19425     ELSE
 19426         MOVE EW-BEN-TYPE        TO DE-AH-TYPE
 19427         MOVE '2'                TO DE-RESERVE-TYPE
 19428         MOVE ZEROS              TO DE-LF-TYPE.
 19429
 19430     MOVE SPACES                 TO DE-NAME
 19431                                    DE-ACC-GPCD
 19432                                    DE-AH-STAT-CDE
 19433                                    DE-LF-STAT-CDE
 19434                                    DE-MEMBER-NO
 19435                                    DE-NAME
 19436                                    DE-SEX.
 19437     MOVE ZEROS                  TO DE-AGE
 19438                                    DE-AH-BEN
 19439                                    DE-AH-CANC-DTE
 19440                                    WS-DE-AH-CANC-DTE-N
 19441                                    DE-AH-CANC-EXIT-DT
 19442                                    WS-DE-AH-CANC-EXIT-DT-N
 19443                                    DE-AH-PRM
 19444                                    DE-AH-RFND
 19445                                    DE-AH-TERM
 19446                                    DE-APR
 19447                                    DE-CANCEL-CNT-ITD
 19448                                    DE-CANCEL-CNT-YTD
 19449                                    DE-FUTRSV
 19450                                    DE-LF-BEN
 19451                                    DE-LF-BEN-ALT
 19452                                    DE-LF-CANC-DTE
 19453                                    WS-DE-LF-CANC-DTE-N
 19454                                    DE-LF-CANC-EXIT-DT
 19455                                    WS-DE-LF-CANC-EXIT-DT-N
 19456                                    DE-LF-CNBEN
 19457                                    DE-LF-CNBEN-ALT
 19458                                    DE-LF-PRM
 19459                                    DE-LF-PRM-ALT
 19460                                    DE-LF-RFND
 19461                                    DE-LF-TERM
 19462                                    DE-LIVES
 19463                                    DE-PAYCUR
 19464                                    DE-PMT-FREQ
 19465                                    DE-REI-AHAMT
 19466                                    DE-REI-AHPRM
 19467                                    DE-REI-AHRFND
 19468                                    DE-REI-CNAMT
 19469                                    DE-REI-FUTRSV
 19470                                    DE-REI-LFAMT
 19471                                    DE-REI-LFPRM
 19472                                    DE-REI-LFRFND
 19473                                    DE-REI-PAYCUR
 19474                                    DE-RSV-REPORTED
 19475                                    DE-RSV-PAYTO
 19476                                    WS-DE-RSV-PAYTO-N
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 378
* ECS010T1.cbl
 19477                                    DE-MOB-NET-TOT-FEES
 19478                                    DE-SOC-SEC-NO.
 19479
 19480     MOVE SPACES                 TO W-REIN-PROCESS-IND.
 19481
 19482     PERFORM 2500-WRITE-DETAIL-EXTRACTS
 19483         THRU 2599-WRT-DETAIL-X.
 19484     ADD +1                      TO BC-G-CRS.
 19485
 19486 4740-EXIT.
 19487     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 379
* ECS010T1.cbl
 19489 4750-UPDATE-REIN.
 19490
 19491     COMPUTE SUB3 = SUB2 + 1.
 19492
 19493     IF  W-UNDERWRITTEN-DATA
 19494         MOVE EPEC-SUB-KEY-II (SUB2)
 19495                                 TO W-SUB-KEY
 19496     ELSE
 19497         MOVE EPEC-SUB-KEY (SUB2)
 19498                                 TO W-SUB-KEY.
 19499
 19500     PERFORM 4755-MATCH-REIN-EPEC THRU 4755-EXIT
 19501             VARYING
 19502         SUB3 FROM SUB3 BY +1
 19503             UNTIL
 19504         SUB3 GREATER THAN +900
 19505*        SUB3 GREATER THAN +220
 19506*        SUB3 GREATER THAN +300
 19507             OR
 19508         EPEC-LF-AH-OPT (SUB3) EQUAL SPACES.
 19509
 19510 4750-EXIT.
 19511     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 380
* ECS010T1.cbl
 19513 4755-MATCH-REIN-EPEC.
 19514
 19515     IF  W-UNDERWRITTEN-DATA
 19516         MOVE EPEC-LEVELS-II (SUB3)
 19517                                 TO EPEC-WORK
 19518     ELSE
 19519         MOVE EPEC-LEVELS (SUB3) TO EPEC-WORK.
 19520
 19521     IF  EPEC-LINE-NOT-USED (SUB3)
 19522         GO TO 4755-EXIT.
 19523
 19524     IF  EW-SUB-KEY NOT EQUAL W-SUB-KEY
 19525             OR
 19526         EW-REIN-CO EQUAL SPACES
 19527         GO TO 4755-EXIT.
 19528
 19529     IF  W-ISS-BEN GREATER THAN ZEROS
 19530         IF  EPEC-REIN-ONLY-DATA (SUB3)
 19531             COMPUTE W-FACTOR ROUNDED
 19532                 = (EW-ISS-BEN
 19533                 - EPEC-REIN-ISS-BEN (SUB3))
 19534                 / W-ISS-BEN
 19535         ELSE
 19536             COMPUTE W-FACTOR ROUNDED
 19537                 = EW-ISS-BEN
 19538                 / W-ISS-BEN.
 19539
 19540     COMPUTE EW-CLM-IBNR ROUNDED
 19541         = EW-CLM-IBNR
 19542         + (W-WK-IBNR * W-FACTOR).
 19543
 19544     IF  W-UNDERWRITTEN-DATA
 19545         MOVE EPEC-WORK          TO EPEC-LEVELS-II (SUB3)
 19546     ELSE
 19547         MOVE EPEC-WORK          TO EPEC-LEVELS (SUB3).
 19548
 19549 4755-EXIT.
 19550     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 381
* ECS010T1.cbl
 19552 4760-PROCESS-REIN-ONLY.
 19553
 19554     MOVE ZEROS                  TO W-WK-IBNR.
 19555
 19556     IF  EPEC-LINE-NOT-USED (SUB2)
 19557         GO TO 4760-EXIT.
 19558
 19559     IF  EW-LF-AH EQUAL 'L'
 19560         IF  EPEC-LIFE-IBNR (SUB2) EQUAL ZEROS
 19561             GO TO 4760-EXIT
 19562         ELSE
 19563             PERFORM 4720-PROCESS-LIFE THRU 4720-EXIT
 19564             ADD W-WK-IBNR       TO EW-CLM-IBNR
 19565     ELSE
 19566         IF  EPEC-EARNED-PREMIUM-AH (SUB2) EQUAL ZEROS
 19567             GO TO 4760-EXIT
 19568         ELSE
 19569             PERFORM 4730-PROCESS-A-H THRU 4730-EXIT
 19570             ADD W-WK-IBNR       TO EW-CLM-IBNR.
 19571
 19572 4760-EXIT.
 19573     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 382
* ECS010T1.cbl
 19575 4770-CREATE-REIN-DETAIL.
 19576
 19577     MOVE 'Y'                    TO W-REIN-PROCESS-IND.
 19578     PERFORM 4740-CREATE-DETAIL-EXTR THRU 4740-EXIT.
 19579
 19580 4770-EXIT.
 19581     EXIT.
 19582
 19583 4799-EXIT.
 19584     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 383
* ECS010T1.cbl
 19586 4800-CALC-EARNED-PREMIUM-AH.
 19587
 19588     MOVE +0                         TO CNC-BEN  EPR-R78
 19589                                        ISS-PRM  EPR-PRO
 19590                                        CNC-PRM  EPR-ST
 19591                                        WX-CLM-AMT
 19592                                        WX-CLM-EXP
 19593                                        WX-CLM-CNT
 19594                                        WX-CLM-CRT
 19595                                        WX-CNC-CNT
 19596                                        ISS-PRMTAX
 19597                                        WX-ACTIVE-COUNT.
 19598     MOVE SPACE                      TO A-H-EARNED-SWITCH.
 19599
 19600     MOVE WE-AHPRM TO ISS-PRM.
 19601
 19602     IF DTE-CLIENT = 'GIC'
 19603         IF REIN-EP-FLG NOT = 'R'  AND
 19604            CLAS-I-CALC-TYPE (CLAS-INDEXA) = 'B'  AND
 19605            (CR-ENTRY-STATUS NOT = '5' AND '3' AND 'M')
 19606            MOVE CR-AHPRM-CALC TO ISS-PRM.
 19607
 19608     IF REIN-EP-FLG = 'R'  AND
 19609        REIN-AH-RUNOFF-SW (SUB5) = 'N'
 19610         NEXT SENTENCE
 19611     ELSE
 19612         GO TO 4810-EP-DO-AH-CLM.
 19613
 19614     IF CR-DIS-DT NOT GREATER THAN EARNING-STOP-DATE
 19615         IF WE-DSPY-AMT NOT = +0
 19616             ADD WE-DSPY-AMT    TO WX-CLM-AMT
 19617             ADD WE-DSPY-EXP    TO WX-CLM-EXP
 19618             ADD CR-NUM-DIS-CLM TO WX-CLM-CNT
 19619             ADD +1             TO WX-CLM-CNT.
 19620
 19621     IF CR-AH-STATUS-AT-SETTLEMENT NOT = ' '
 19622         IF CR-DIS-DT GREATER THAN EARNING-STOP-DATE
 19623             GO TO 4830-EP-DO-AH-EP.
 19624
 19625     IF CR-AH-STATUS-AT-CANCEL NOT = ' '
 19626         IF CR-AH-CANC-DT GREATER THAN EARNING-STOP-DATE
 19627             GO TO 4830-EP-DO-AH-EP.
 19628
 19629     GO TO 4815-EP-DO-AH-CLM-EPR.
 19630
 19631 4810-EP-DO-AH-CLM.
 19632
 19633     IF WE-DSPY-AMT NOT = +0
 19634         ADD WE-DSPY-AMT    TO WX-CLM-AMT
 19635         ADD WE-DSPY-EXP    TO WX-CLM-EXP
 19636         ADD CR-NUM-DIS-CLM TO WX-CLM-CNT
 19637         ADD +1             TO WX-CLM-CNT.
 19638
 19639 4815-EP-DO-AH-CLM-EPR.
 19640
 19641     IF CR-AH-STATUS-AT-SETTLEMENT NOT = ' '
 19642         MOVE WE-AHPRM TO EPR-R78  EPR-PRO  EPR-ST.
 19643
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 384
* ECS010T1.cbl
 19644 4820-EP-DO-AH-CNCL.
 19645
 19646     IF CR-AH-STATUS-AT-CANCEL = ' '
 19647         IF CR-AH-STATUS-AT-SETTLEMENT NOT = ' '  AND
 19648            CLAS-I-CALC-TYPE (CLAS-INDEXA) NOT = 'Z'
 19649             GO TO 4899-EXIT
 19650         ELSE
 19651             GO TO 4830-EP-DO-AH-EP.
 19652
 19653     IF (DTE-CLIENT = 'DCC')
 19654        AND (CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'G' OR 'L')
 19655        IF CR-AHRFND NOT = ZEROS
 19656           ADD +1                TO WX-CNC-CNT
 19657        END-IF
 19658     ELSE
 19659        ADD +1                   TO WX-CNC-CNT
 19660     END-IF
 19661
 19662     MOVE WE-AHRFND TO CNC-PRM.
 19663
 19664*    MOVE CR-DT                 TO  DC-GREG-DATE-CYMD.
 19665*    MOVE 'L'                   TO  DC-OPTION-CODE.
 19666*    PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 19667*    MOVE DC-BIN-DATE-1         TO  WS-CR-BIN-DATE.
 19668
 19669     MOVE CR-AH-CANC-DT         TO DC-GREG-DATE-CYMD.
 19670     MOVE 'L'                   TO  DC-OPTION-CODE.
 19671     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 19672     MOVE DC-BIN-DATE-1         TO  WS-BIN-CANCEL-DATE.
 19673
 19674     MOVE WS-CR-BIN-DATE          TO  DC-BIN-DATE-1.
 19675     MOVE WS-BIN-CANCEL-DATE      TO  DC-BIN-DATE-2.
 19676     MOVE '1'                     TO  DC-OPTION-CODE.
 19677     MOVE ZEROS                   TO  MONTHS-DIFF-AH.
 19678     MOVE ZEROS                   TO  DC-ELAPSED-MONTHS
 19679                                      DC-ODD-DAYS-OVER
 19680                                      DC-ELAPSED-DAYS.
 19681     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 19682     MOVE DC-ELAPSED-MONTHS       TO  MONTHS-DIFF-AH.
 19683
 19684     IF DC-ODD-DAYS-OVER   GREATER THAN  ZERO
 19685         ADD  +1                  TO  MONTHS-DIFF-AH.
 19686
 19687     MOVE  'YYYYYYYYYY'           TO  WS-AH-CHARGEBACK-LEVELS.
 19688
 19689     IF DTE-CLIENT = 'ACE'
 19690         GO TO 4820-CONTINUE-AH-CANCEL.
 19691
 19692     MOVE  ZEROS                  TO  SUB.
 19693
 19694 4820-AH-CHARGEBACK-LOOP.
 19695
 19696     ADD    +1                    TO  SUB.
 19697
 19698     IF  SUB  GREATER THAN  +10
 19699         GO TO  4820-CONTINUE-AH-CANCEL.
 19700
 19701     IF  AM-COMM-CHARGEBACK (SUB)  NOT  NUMERIC  OR
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 385
* ECS010T1.cbl
 19702         AM-COMM-CHARGEBACK (SUB)  =  ZEROS
 19703         GO TO  4820-AH-CHARGEBACK-LOOP.
 19704
 19705     IF  AM-COMM-CHARGEBACK (SUB)  EQUAL    '99'
 19706         MOVE  'N'    TO  WS-AH-CHARGEBACK-SW (SUB).
 19707
 19708     IF  (MONTHS-DIFF-AH GREATER THAN AM-COMM-CHARGEBACK (SUB))
 19709         OR (CR-AHRFND = ZEROS)
 19710         MOVE  'N'        TO  WS-AH-CHARGEBACK-SW (SUB)
 19711     END-IF
 19712
 19713     GO TO  4820-AH-CHARGEBACK-LOOP.
 19714
 19715
 19716 4820-CONTINUE-AH-CANCEL.
 19717
 19718     IF DTE-CLIENT = 'GIC'
 19719         IF REIN-EP-FLG NOT = 'R'  AND
 19720            CLAS-I-CALC-TYPE (CLAS-INDEXA) = 'B'
 19721            MOVE CR-AHRFND-CALC TO CNC-PRM.
 19722
 19723     COMPUTE EPR-R78 = WE-AHPRM - WE-AHRFND.
 19724     MOVE EPR-R78 TO EPR-PRO  EPR-ST.
 19725
 19726     IF CR-AH-LUMP-SUM-DISAB
 19727         GO TO 4899-EXIT.
 19728
 19729     MOVE WE-AHAMT TO CNC-BEN.
 19730
 19731     GO TO 4899-EXIT.
 19732
 19733 4825-EP-DO-AH-CNCL-SUM.
 19734
 19735     IF WE-DSPY-AMT NOT = +0
 19736         ADD WE-DSPY-AMT    TO WX-CLM-AMT
 19737         ADD WE-DSPY-EXP    TO WX-CLM-EXP
 19738         ADD CR-NUM-DIS-CLM TO WX-CLM-CNT
 19739         ADD +1             TO WX-CLM-CNT.
 19740
 19741     IF WE-AHRFND = ZERO
 19742        GO TO 4830-EP-DO-AH-EP.
 19743
 19744     MOVE WE-AHRFND TO CNC-PRM.
 19745
 19746     ADD CR-SUM-CAN-CNT-ITD TO WX-CNC-CNT.
 19747
 19748     MOVE  'YYYYYYYYYY'           TO  WS-AH-CHARGEBACK-LEVELS.
 19749
 19750     IF WE-AHRFND NOT LESS WE-AHPRM
 19751         MOVE WE-AHAMT TO CNC-BEN
 19752          GO TO 4830-EP-DO-AH-EP.
 19753
 19754     COMPUTE TEMP-6 ROUNDED = WE-AHRFND / WE-AHPRM.
 19755     COMPUTE TEMP-7 ROUNDED = TEMP-6 * WE-AHAMT.
 19756     MOVE TEMP-7 TO CNC-BEN.
 19757
 19758 4830-EP-DO-AH-EP.
 19759
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 386
* ECS010T1.cbl
 19760     MOVE EOM-RUN-DATE TO VALUATION-DT.
 19761     MOVE '8'           TO W-VAL-SOURCE.
 19762
 19763     IF REIN-EP-FLG = 'R'
 19764       IF REIN-REM-SW (SUB5) = 'I'
 19765           MOVE WE-AHPRM            TO EPR-R78  EPR-PRO  EPR-ST
 19766           GO TO 4899-EXIT.
 19767
 19768     IF REIN-EP-FLG = 'R'
 19769         IF REIN-AH-RUNOFF-SW (SUB5) = 'N'  AND
 19770            EARNING-STOP-DATE LESS THAN VALUATION-DT
 19771             MOVE '*'               TO A-H-EARNED-SWITCH
 19772             MOVE EARNING-STOP-DATE TO VALUATION-DT
 19773             MOVE '10'              TO W-VAL-SOURCE.
 19774
 19775     PERFORM 8500-REMAINING-TERM-ROUTINE THRU 8599-REM-TERM-X.
 19776
 19777     IF REM-TRM2 GREATER CR-AH-TERM
 19778         MOVE +0 TO EPR-R78  EPR-PRO  EPR-ST
 19779         GO TO 4899-EXIT.
 19780
 19781     IF CLAS-I-CALC-TYPE (CLAS-INDEXA) = 'Z'
 19782         COMPUTE WE-AHPRM = WE-AHPRM - WE-AHRFND.
 19783*
 19784 4835-CHECK-OB-AH-NCL.
 19785
 19786     IF (DTE-CLIENT EQUAL 'NCL') AND
 19787        (CLAS-I-CALC-TYPE (CLAS-INDEXA) EQUAL 'B')
 19788           MOVE WE-AHPRM         TO EPR-R78
 19789                                    EPR-PRO
 19790                                    EPR-ST
 19791        IF (CR-CCYY EQUAL EOM-CCYY) AND
 19792           (CR-MO EQUAL EOM-MO)
 19793           MOVE '*'            TO OB-DATE-1-SWITCH
 19794           MOVE EW-REIN-CO     TO WS-OB-REIN-CO (SUB3)
 19795           MOVE AH-OVERRIDE-L1 TO WS-OB-LF-AH (SUB3)
 19796           MOVE CR-AHTYP       TO WS-OB-BENEFIT-CODE (SUB3)
 19797           COMPUTE WS-EPR-R78 (SUB3 1) =
 19798                   WS-EPR-R78 (SUB3 1) + (WE-AHPRM * .5)
 19799           GO TO 4899-EXIT
 19800        ELSE
 19801        IF (CR-CCYY EQUAL OB-CCYY (1)) AND
 19802           (CR-MO EQUAL OB-MO (1))
 19803           MOVE '*'            TO OB-DATE-2-SWITCH
 19804           MOVE EW-REIN-CO     TO WS-OB-REIN-CO (SUB3)
 19805           MOVE AH-OVERRIDE-L1 TO WS-OB-LF-AH (SUB3)
 19806           MOVE CR-AHTYP       TO WS-OB-BENEFIT-CODE (SUB3)
 19807           COMPUTE WS-EPR-R78 (SUB3 2) =
 19808                   WS-EPR-R78 (SUB3 2) + (WE-AHPRM * .5)
 19809           GO TO 4899-EXIT
 19810        ELSE
 19811        IF (CR-CCYY EQUAL OB-CCYY (2)) AND
 19812           (CR-MO EQUAL OB-MO (2))
 19813           MOVE '*'            TO OB-DATE-3-SWITCH
 19814           MOVE EW-REIN-CO     TO WS-OB-REIN-CO (SUB3)
 19815           MOVE AH-OVERRIDE-L1 TO WS-OB-LF-AH (SUB3)
 19816           MOVE CR-AHTYP       TO WS-OB-BENEFIT-CODE (SUB3)
 19817           COMPUTE WS-EPR-R78 (SUB3 3) =
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 387
* ECS010T1.cbl
 19818                   WS-EPR-R78 (SUB3 3) + (WE-AHPRM * .5)
 19819           GO TO 4899-EXIT
 19820        ELSE
 19821           GO TO 4899-EXIT.
 19822
 19823     IF REM-TRM2 NOT GREATER +0
 19824         MOVE WE-AHPRM TO EPR-R78  EPR-PRO  EPR-ST
 19825         GO TO 4899-EXIT.
 19826
 19827     IF CLAS-I-CALC-TYPE (CLAS-INDEXA) = 'B'
 19828         MOVE WE-AHPRM TO EPR-R78  EPR-PRO  EPR-ST
 19829         GO TO 4899-EXIT.
 19830
 19831     IF CLAS-I-CALC-TYPE (CLAS-INDEXA) NOT = 'Z'
 19832         MOVE +1 TO WX-ACTIVE-COUNT
 19833     ELSE
 19834         COMPUTE WX-ACTIVE-COUNT = CR-LIVES - CR-SUM-CAN-CNT-ITD.
 19835
 19836     COMPUTE TEMP-1 = CR-AH-TERM * (CR-AH-TERM + 1).
 19837     COMPUTE TEMP-2 = REM-TRM1 * (REM-TRM1 + 1).
 19838     IF DTE-R78 = '1'
 19839         COMPUTE TEMP-2 = REM-TRM1 * REM-TRM1.
 19840     COMPUTE TEMP-4 ROUNDED = TEMP-2 / TEMP-1.
 19841
 19842     IF DTE-CLIENT = 'MIC' OR 'MCC'
 19843         COMPUTE TEMP-5 ROUNDED = (REM-TRM1 - .5) / CR-AH-TERM
 19844     ELSE
 19845         COMPUTE TEMP-5 ROUNDED = REM-TRM1 / CR-AH-TERM.
 19846
 19847     COMPUTE EPR-R78 ROUNDED = WE-AHPRM * TEMP-4.
 19848     COMPUTE EPR-R78 = WE-AHPRM - EPR-R78.
 19849
 19850     COMPUTE EPR-PRO ROUNDED = WE-AHPRM * TEMP-5.
 19851     COMPUTE EPR-PRO = WE-AHPRM - EPR-PRO.
 19852
 19853     MOVE CLAS-I-EP (CLAS-INDEXA) TO AH-EARN-METHOD.
 19854
 19855*    IF AM-EARN-METHOD-A NOT EQUAL SPACES AND ZEROS
 19856*        MOVE AM-EARN-METHOD-A TO AH-EARN-METHOD.
 19857
 19858     MOVE SPACES TO STATUTORY-SWITCH-AH.
 19859
 19860     IF (STATE-ABBR (CLAS-INDEXS) = 'VA') AND
 19861        (CR-DT GREATER THAN  19921231)
 19862        AND (DTE-CLIENT NOT = 'DCC')
 19863         IF CR-AH-TERM GREATER THAN  +61
 19864             MOVE 'A' TO AH-EARN-METHOD
 19865             MOVE '*' TO STATUTORY-SWITCH-AH
 19866             GO TO 4845-EP-DO-AH-EP-AN
 19867         ELSE
 19868             GO TO 4860-EP-DO-AH-STATUTORY.
 19869
 19870     IF (AH-EARN-METHOD EQUAL 'N')
 19871                  OR
 19872        ((DTE-CLIENT = 'DCC')
 19873         AND (CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'G' OR 'L')
 19874         AND (CLAS-I-REFUND-METHOD (CLAS-INDEXA) NOT = 'G'))
 19875         GO TO 4840-EP-DO-AH-EP-NP
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 388
* ECS010T1.cbl
 19876     END-IF
 19877
 19878     IF AH-EARN-METHOD EQUAL 'A' OR 'C'
 19879         MOVE 'A' TO AH-EARN-METHOD
 19880         GO TO 4845-EP-DO-AH-EP-AN.
 19881
 19882     GO TO 4860-EP-DO-AH-STATUTORY.
 19883
 19884 4840-EP-DO-AH-EP-NP.
 19885
 19886     IF WE-AHPRM = ZERO
 19887         GO TO 4860-EP-DO-AH-STATUTORY.
 19888
 19889     IF CR-APR GREATER THAN +0
 19890         NEXT SENTENCE
 19891     ELSE
 19892         GO TO 4860-EP-DO-AH-STATUTORY.
 19893
 19894     IF DTE-CLIENT = 'NCL'
 19895       IF CR-DT LESS THAN 19910101
 19896           GO TO 4860-EP-DO-AH-STATUTORY.
 19897
 19898     IF REM-TRM1 = CR-AH-TERM
 19899         MOVE +0 TO EPR-R78  EPR-PRO  EPR-ST
 19900         GO TO 4899-EXIT.
 19901
 19902     MOVE CR-APR TO NP-APR.
 19903     MOVE CR-AH-TERM TO NP-ORIG  NP-CAP.
 19904     MOVE REM-TRM1 TO NP-REM.
 19905     MOVE CLAS-I-CALC-TYPE (CLAS-INDEXA) TO NP-OPT.
 19906     IF NP-OPT = 'T' OR 'U' OR 'V' OR 'W' OR 'X'
 19907         MOVE CR-LOAN-TERM TO NP-ORIG.
 19908
 19909     IF (DTE-CLIENT = 'DCC')
 19910        AND (CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'G' OR 'L')
 19911        MOVE 'S'                 TO NP-OPT
 19912     ELSE
 19913        MOVE 'R'                 TO NP-OPT
 19914     END-IF
 19915
 19916
 19917*    MOVE 'R' TO NP-OPT.
 19918     CALL 'ECSNETRM'
 19919         USING NP-APR NP-ORIG NP-REM NP-OPT NP-CAP NP-FACTOR.
 19920
 19921     IF (DTE-CLIENT = 'DCC')
 19922        AND (CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'G' OR 'L')
 19923        COMPUTE EPR-ST ROUNDED =
 19924           WE-AHPRM - (NP-FACTOR * WE-AHPRM)
 19925        GO TO 4899-EXIT
 19926     ELSE
 19927        COMPUTE EPR-R78 ROUNDED =
 19928           WE-AHPRM - (NP-FACTOR * WE-AHPRM)
 19929     END-IF
 19930
 19931     GO TO 4860-EP-DO-AH-STATUTORY.
 19932
 19933 4845-EP-DO-AH-EP-AN.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 389
* ECS010T1.cbl
 19934     MOVE CR-DT                      TO DC-GREG-DATE-CYMD.
 19935     MOVE 'L'                        TO DC-OPTION-CODE.
 19936     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 19937     MOVE DC-BIN-DATE-1              TO CP-CERT-EFF-DT.
 19938     MOVE CLAS-I-RL-AH (CLAS-INDEXA) TO CP-BENEFIT-TYPE.
 19939     MOVE SPACES                     TO CP-ACCT-FLD-5.
 19940     MOVE DTE-CLIENT                 TO CP-COMPANY-ID.
 19941     MOVE STATE-SUB (CLAS-INDEXS)    TO CP-STATE.
 19942     MOVE STATE-ABBR (CLAS-INDEXS)   TO CP-STATE-STD-ABBRV.
 19943     MOVE CR-AGE                     TO CP-ISSUE-AGE.
 19944     MOVE REM-TRM1                   TO CP-ORIGINAL-TERM.
 19945     MOVE CR-AHAMT                   TO CP-ORIGINAL-BENEFIT
 19946                                        CP-RATING-BENEFIT-AMT.
 19947     IF CP-STATE-STD-ABBRV = 'OR'
 19948         COMPUTE CP-RATING-BENEFIT-AMT =
 19949                                  CR-AHAMT * REM-TRM1.
 19950     MOVE CR-APR                     TO CP-LOAN-APR.
 19951     MOVE CR-PMT-FREQ                TO CP-PAY-FREQUENCY.
 19952     MOVE AH-EARN-METHOD             TO CP-EARNING-METHOD.
 19953     MOVE '3'                        TO CP-PROCESS-TYPE.
 19954     MOVE CLAS-I-BAL (CLAS-INDEXA)   TO CP-SPECIAL-CALC-CD.
 19955     MOVE CR-LOAN-TERM               TO CP-LOAN-TERM.
 19956     IF CR-RATING-CLASS NOT = SPACE AND ZERO
 19957         MOVE CR-RATING-CLASS        TO CP-CLASS-CODE
 19958     ELSE
 19959         MOVE AM-CAL-TABLE           TO CP-CLASS-CODE.
 19960     MOVE AM-AH-DEVIATION            TO CP-DEVIATION-CODE.
 19961     MOVE CR-AHTYP                   TO CP-BENEFIT-CD.
 19962     MOVE DTE-CLASIC-COMPANY-CD      TO CP-COMPANY-CD.
 19963     MOVE CR-PMT-EXTENSION-DAYS      TO CP-TERM-OR-EXT-DAYS.
 19964     MOVE AH-OVERRIDE-L1             TO CP-AH-OVERRIDE-CODE.
 19965     MOVE AM-AH-DEVIATION-PCT        TO CP-RATE-DEV-PCT.
 19966
 19967     PERFORM 8100-GET-RATE THRU 8199-GET-RATE-X.
 19968
 19969     IF CP-ERROR-RATE-NOT-FOUND  OR
 19970        CP-ERROR-RATE-IS-ZERO  OR
 19971        CP-ERROR-IN-DATES
 19972         GO TO 4860-EP-DO-AH-STATUTORY.
 19973
 19974     COMPUTE EPR-R78 ROUNDED =
 19975             ((REM-TRM1 * WE-AHAMT) / +100) *
 19976               CP-PREMIUM-RATE.
 19977
 19978     COMPUTE EPR-R78 = WE-AHPRM - EPR-R78.
 19979
 19980     IF STATUTORY-REQUIREMENT-AH
 19981         MOVE EPR-R78                TO EPR-ST
 19982         GO TO 4899-EXIT.
 19983
 19984 4860-EP-DO-AH-STATUTORY.
 19985
 19986     IF (DTE-CLIENT = 'DCC')
 19987        AND (CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'G' OR 'L')
 19988        AND (CLAS-I-REFUND-METHOD (CLAS-INDEXA) = 'G')
 19989        MOVE EPR-R78             TO EPR-ST
 19990        GO TO 4899-EXIT
 19991     END-IF
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 390
* ECS010T1.cbl
 19992
 19993     MOVE EPR-R78                    TO EPR-ST.
 19994
 19995     MOVE +0                         TO SUB1.
 19996
 19997 4865-EP-AH-STAT-LOOP.
 19998     ADD +1 TO SUB1.
 19999
 20000     IF STATE-ABBR (CLAS-INDEXS) = AH-RES-STATE-ENT (SUB1)
 20001         MOVE EPR-PRO                TO EPR-ST
 20002     ELSE
 20003         IF AH-RES-STATE-ENT (SUB1) NOT = HIGH-VALUES
 20004             GO TO 4865-EP-AH-STAT-LOOP.
 20005
 20006     IF (STATE-ABBR (CLAS-INDEXS) = 'OH'  AND
 20007         CR-DT GREATER THAN 19831031)  OR
 20008
 20009        (STATE-ABBR (CLAS-INDEXS) = 'OK'  AND
 20010         CR-DT GREATER THAN 19820629)  OR
 20011
 20012        (STATE-ABBR (CLAS-INDEXS) = 'TX'  AND
 20013         CR-DT GREATER THAN 19830831)
 20014
 20015         COMPUTE EPR-ST = (EPR-R78 + EPR-PRO) / 2.
 20016
 20017     IF DTE-CLIENT = 'CSO'  OR  'CID'
 20018       IF STATE-ABBR (CLAS-INDEXS) = 'CO'
 20019         IF CR-DT LESS THAN 19970101
 20020             MOVE EPR-R78            TO EPR-ST
 20021         ELSE
 20022             COMPUTE EPR-ST = (EPR-R78 + EPR-PRO) / 2.
 20023
 20024     IF DTE-CLIENT = 'DCC'
 20025        IF CLAS-I-BAL (CLAS-INDEXA) = 'C'
 20026           MOVE EPR-PRO          TO EPR-ST
 20027        ELSE
 20028           COMPUTE EPR-ST = (EPR-R78 + EPR-PRO) / 2
 20029        END-IF
 20030     END-IF
 20031     .
 20032 4899-EXIT.
 20033     EXIT.
 20034******************************************************************
 20035***         W R I T E   S U M M A R Y   E X T R A C T S        ***
 20036******************************************************************
 20037
 20038 4900-WRITE-SUMMARY-EXTRACTS.
 20039
 20040     IF DTE-CLIENT = 'HER'
 20041         IF EP-RECORD-ID = 'EC'  AND
 20042            EP-REINCO = 'LNL'
 20043             GO TO 4999-WRT-SUMMARY-X.
 20044
 20045     MOVE EOM-RUN-DATE            TO EP-RUN-DTE
 20046                                     WS-EP-RUN-DTE-N.
 20047
 20048     IF W-UNDERWRITTEN-DATA
 20049         MOVE 'Y'                 TO EP-UNDERWRITING-CODE
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 391
* ECS010T1.cbl
 20050     ELSE
 20051         MOVE 'N'                 TO EP-UNDERWRITING-CODE.
 20052
 20053     IF  DTE-OPT-RESERVE-METHOD-AUTH
 20054         IF VALID-EP-ID
 20055             MOVE 'Y'             TO EP-NEW-DATA-IND.
 20056
 20057     WRITE EP-RECORD.
 20058
 20059     ADD +1                       TO EP-CNT.
 20060
 20061 4999-WRT-SUMMARY-X.
 20062     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 392
* ECS010T1.cbl
 20064******************************************************************
 20065***       T O T A L   P A G E   S E T U P   R O U T I N E      ***
 20066******************************************************************
 20067
 20068 5000-DATE-RANGE-BREAK.
 20069
 20070     IF NO-TRANSACTION-WAS-PROCESSED
 20071         GO TO 5099-DATE-RANGE-BREAK-X.
 20072
 20073     ADD +1  TO RANGE-CNT.
 20074     MOVE +1 TO SUB6.
 20075     MOVE +2 TO SUB7.
 20076     PERFORM 5800-ADD-PAGES-LEVELS THRU 5899-ADD-PAGES-LEVELS-X.
 20077     IF LN-CNT GREATER +50
 20078         PERFORM 8700-PRINT-REPORT-HEADINGS THRU
 20079                 8750-PRT-RANGE-HEADING.
 20080
 20081     MOVE SPACES                     TO PRT.
 20082     PERFORM 8800-PRINT-ROUTINE.
 20083     MOVE 'DATE RANGE'               TO TPH2-DESC.
 20084     MOVE '  TOTALS'                 TO TPH3-DESC.
 20085     PERFORM 6100-ACCT-TOTAL-HEADINGS THRU 6199-PAGE-HEADINGS-X.
 20086     PERFORM 6500-PRINT-TOTAL-PAGE THRU 6599-TOTAL-PAGE-PRINT-X.
 20087     PERFORM 5900-CLEAR-TOTAL-PAGES
 20088         THRU 5999-CLEAR-TOTAL-PAGES-X
 20089             VARYING SUB6 FROM 1 BY 1 UNTIL SUB6 GREATER 1.
 20090
 20091 5099-DATE-RANGE-BREAK-X.
 20092     EXIT.
 20093
 20094 5100-ACCOUNT-BREAK.
 20095
 20096     IF RANGE-CNT NOT = +0
 20097         PERFORM 5000-DATE-RANGE-BREAK
 20098             THRU 5099-DATE-RANGE-BREAK-X
 20099     ELSE
 20100         MOVE +1 TO SUB6
 20101         MOVE +2 TO SUB7
 20102         PERFORM 5800-ADD-PAGES-LEVELS
 20103             THRU 5899-ADD-PAGES-LEVELS-X
 20104         PERFORM 5900-CLEAR-TOTAL-PAGES
 20105             THRU 5999-CLEAR-TOTAL-PAGES-X
 20106                 VARYING SUB6 FROM 1 BY 1 UNTIL SUB6 GREATER 1.
 20107
 20108     MOVE +0 TO RANGE-CNT.
 20109     PERFORM 7500-ADD-UP-REIN-CO THRU 7599-ADD-UP-REIN-X
 20110         VARYING B-SUB FROM 1 BY 1
 20111             UNTIL B-SUB GREATER THAN 50  OR
 20112                   RB-COMPANY (B-SUB) = SPACES.
 20113     PERFORM 7900-CLEAR-BILLING-TABLE THRU 7999-CLEAR-BILLING-X
 20114         VARYING B-SUB FROM 1 BY 1
 20115             UNTIL B-SUB GREATER THAN 50.
 20116
 20117     IF ACCT-FLG = SPACE
 20118         GO TO 5199-ACCOUNT-BREAK-X.
 20119
 20120     MOVE SPACE TO ACCT-FLG.
 20121     MOVE +2 TO SUB6.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 393
* ECS010T1.cbl
 20122     MOVE +3 TO SUB7.
 20123     PERFORM 5800-ADD-PAGES-LEVELS THRU 5899-ADD-PAGES-LEVELS-X.
 20124     IF LN-CNT GREATER +50
 20125         PERFORM 8700-PRINT-REPORT-HEADINGS THRU
 20126                 8725-PRT-ACCT-HEADING.
 20127
 20128     MOVE SPACES                     TO PRT.
 20129     PERFORM 8800-PRINT-ROUTINE.
 20130     MOVE 'ACCOUNT'                  TO TPH2-DESC.
 20131     MOVE ' TOTALS'                  TO TPH3-DESC.
 20132     PERFORM 6100-ACCT-TOTAL-HEADINGS THRU 6199-PAGE-HEADINGS-X.
 20133     PERFORM 6500-PRINT-TOTAL-PAGE THRU 6599-TOTAL-PAGE-PRINT-X.
 20134     PERFORM 5900-CLEAR-TOTAL-PAGES
 20135         THRU 5999-CLEAR-TOTAL-PAGES-X
 20136             VARYING SUB6 FROM 2 BY 1 UNTIL SUB6 GREATER 2.
 20137
 20138 5199-ACCOUNT-BREAK-X.
 20139     EXIT.
 20140
 20141 5200-STATE-BREAK.
 20142
 20143     PERFORM 5100-ACCOUNT-BREAK THRU 5199-ACCOUNT-BREAK-X.
 20144     MOVE ZEROS TO SV-LO-CERT  SV-HI-CERT.
 20145     MOVE +3 TO SUB6.
 20146     MOVE +4 TO SUB7.
 20147     PERFORM 5800-ADD-PAGES-LEVELS THRU 5899-ADD-PAGES-LEVELS-X.
 20148
 20149     IF STATE-FLG = SPACE
 20150         GO TO 5299-STATE-BREAK-X.
 20151
 20152     MOVE SPACE         TO STATE-FLG.
 20153     PERFORM 8700-PRINT-REPORT-HEADINGS.
 20154     MOVE 'STATE'       TO TPH1-TYPE.
 20155     MOVE HLD-STATE     TO STATE-L.
 20156
 20157     PERFORM 8200-STATE-CODE-LOOKUP THRU 8299-STATE-LOOKUP-X.
 20158
 20159     IF HLD-STATE NOT = STATE-SUB (CLAS-INDEXS)
 20160         MOVE SPACES          TO TPH1-DESC
 20161         MOVE HLD-STATE       TO TPH1-ST-CODE
 20162         MOVE 'UNKNOWN STATE' TO TPH1-ST-DESC
 20163     ELSE
 20164         MOVE SPACES TO TPH1-DESC
 20165         MOVE STATE-SUB (CLAS-INDEXS) TO TPH1-ST-CODE
 20166         MOVE STATE-PIC (CLAS-INDEXS) TO TPH1-ST-DESC.
 20167
 20168     MOVE 'STATE'  TO TPH2-DESC.
 20169     MOVE 'TOTALS' TO TPH3-DESC.
 20170     PERFORM 6000-TOTAL-PAGE-HEADINGS THRU 6199-PAGE-HEADINGS-X.
 20171     PERFORM 6500-PRINT-TOTAL-PAGE THRU 6599-TOTAL-PAGE-PRINT-X.
 20172     PERFORM 5900-CLEAR-TOTAL-PAGES
 20173         THRU 5999-CLEAR-TOTAL-PAGES-X
 20174             VARYING SUB6 FROM 3 BY 1 UNTIL SUB6 GREATER 3.
 20175
 20176 5299-STATE-BREAK-X.
 20177     EXIT.
 20178
 20179 5300-COMP-BREAK.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 394
* ECS010T1.cbl
 20180
 20181     PERFORM 5200-STATE-BREAK THRU 5299-STATE-BREAK-X.
 20182     MOVE +4 TO SUB6.
 20183     MOVE +5 TO SUB7.
 20184     PERFORM 5800-ADD-PAGES-LEVELS THRU 5899-ADD-PAGES-LEVELS-X.
 20185
 20186     IF COMP-FLG = SPACE
 20187         GO TO 5399-COMP-BREAK-X.
 20188
 20189     MOVE ' ' TO COMP-FLG.
 20190     PERFORM 8700-PRINT-REPORT-HEADINGS.
 20191     MOVE 'COMPANY'                   TO TPH1-TYPE.
 20192     MOVE HLD-GROUPING                TO TPH1-DESC.
 20193     MOVE 'COMPANY'                   TO TPH2-DESC.
 20194     MOVE ' TOTALS'                   TO TPH3-DESC.
 20195     PERFORM 6000-TOTAL-PAGE-HEADINGS THRU 6199-PAGE-HEADINGS-X.
 20196     PERFORM 6500-PRINT-TOTAL-PAGE THRU 6599-TOTAL-PAGE-PRINT-X.
 20197     PERFORM 5900-CLEAR-TOTAL-PAGES
 20198         THRU 5999-CLEAR-TOTAL-PAGES-X
 20199             VARYING SUB6 FROM 4 BY 1 UNTIL SUB6 GREATER 4.
 20200
 20201 5399-COMP-BREAK-X.
 20202     EXIT.
 20203
 20204 5400-CARR-BREAK.
 20205
 20206     PERFORM 5300-COMP-BREAK THRU 5399-COMP-BREAK-X.
 20207     MOVE +5 TO SUB6.
 20208     MOVE +6 TO SUB7.
 20209     PERFORM 5800-ADD-PAGES-LEVELS THRU 5899-ADD-PAGES-LEVELS-X.
 20210
 20211     IF CARR-FLG = SPACE
 20212         GO TO 5499-CARR-BREAK-X.
 20213
 20214     MOVE ' ' TO CARR-FLG.
 20215     PERFORM 8700-PRINT-REPORT-HEADINGS.
 20216     MOVE 'CARRIER'               TO TPH1-TYPE.
 20217     MOVE HLD-CARRIER             TO TPH1-DESC.
 20218     MOVE 'CARRIER'               TO TPH2-DESC.
 20219     MOVE ' TOTALS'               TO TPH3-DESC.
 20220     PERFORM 6000-TOTAL-PAGE-HEADINGS THRU 6199-PAGE-HEADINGS-X.
 20221     PERFORM 6500-PRINT-TOTAL-PAGE THRU 6599-TOTAL-PAGE-PRINT-X.
 20222     PERFORM 5900-CLEAR-TOTAL-PAGES
 20223         THRU 5999-CLEAR-TOTAL-PAGES-X
 20224             VARYING SUB6 FROM 5 BY 1 UNTIL SUB6 GREATER 5.
 20225
 20226 5499-CARR-BREAK-X.
 20227     EXIT.
 20228
 20229 5500-FINAL-BREAK.
 20230
 20231     PERFORM 5400-CARR-BREAK THRU 5499-CARR-BREAK-X.
 20232
 20233     IF FINAL-FLG = SPACE
 20234         GO TO 5599-FINAL-BREAK-X.
 20235
 20236     IF DTE-FICH = '1'
 20237         MOVE '2'  TO  DTE-FICH.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 395
* ECS010T1.cbl
 20238     MOVE +6 TO SUB6.
 20239     PERFORM 8700-PRINT-REPORT-HEADINGS.
 20240     MOVE SPACES   TO TPH1-TYPE.
 20241     MOVE SPACES   TO TPH1-DESC.
 20242     MOVE 'FINAL'  TO TPH2-DESC.
 20243     MOVE 'TOTALS' TO TPH3-DESC.
 20244     PERFORM 6000-TOTAL-PAGE-HEADINGS THRU 6199-PAGE-HEADINGS-X.
 20245     PERFORM 6500-PRINT-TOTAL-PAGE THRU 6599-TOTAL-PAGE-PRINT-X.
 20246
 20247 5599-FINAL-BREAK-X.
 20248     EXIT.
 20249
 20250 5800-ADD-PAGES-LEVELS.
 20251
 20252     ADD TPL-ISS-PRM (SUB6)  TO TPL-ISS-PRM (SUB7).
 20253     ADD TPA-ISS-PRM (SUB6)  TO TPA-ISS-PRM (SUB7).
 20254     ADD TPL-CNC-PRM (SUB6)  TO TPL-CNC-PRM (SUB7).
 20255     ADD TPA-CNC-PRM (SUB6)  TO TPA-CNC-PRM (SUB7).
 20256     ADD TPL-ACCT-COM (SUB6) TO TPL-ACCT-COM (SUB7).
 20257     ADD TPA-ACCT-COM (SUB6) TO TPA-ACCT-COM (SUB7).
 20258     ADD TPL-CLAIMS (SUB6)   TO TPL-CLAIMS (SUB7).
 20259     ADD TPA-CLAIMS (SUB6)   TO TPA-CLAIMS (SUB7).
 20260
 20261 5899-ADD-PAGES-LEVELS-X.
 20262     EXIT.
 20263
 20264 5900-CLEAR-TOTAL-PAGES.
 20265
 20266     MOVE +0 TO TPL-ISS-PRM (SUB6)  TPA-ISS-PRM (SUB6)
 20267             TPL-CNC-PRM (SUB6)     TPA-CNC-PRM (SUB6)
 20268             TPL-ACCT-COM (SUB6)    TPA-ACCT-COM (SUB6)
 20269             TPL-CLAIMS (SUB6)      TPA-CLAIMS (SUB6).
 20270
 20271 5999-CLEAR-TOTAL-PAGES-X.
 20272     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 396
* ECS010T1.cbl
 20274******************************************************************
 20275***       T O T A L   P A G E   P R I N T   R O U T I N E      ***
 20276******************************************************************
 20277
 20278 6000-TOTAL-PAGE-HEADINGS.
 20279
 20280     MOVE TOTAL-PAGE-HD1 TO PRT.
 20281     PERFORM 8800-PRINT-ROUTINE.
 20282
 20283 6100-ACCT-TOTAL-HEADINGS.
 20284
 20285     MOVE TOTAL-PAGE-HD2 TO PRT.
 20286     MOVE '0' TO P-CTL.
 20287     PERFORM 8800-PRINT-ROUTINE.
 20288     MOVE TOTAL-PAGE-HD3 TO PRT.
 20289     MOVE ' ' TO P-CTL.
 20290     PERFORM 8800-PRINT-ROUTINE.
 20291     PERFORM 8800-PRINT-ROUTINE.
 20292     MOVE +81 TO LN-CNT.
 20293
 20294 6199-PAGE-HEADINGS-X.
 20295     EXIT.
 20296
 20297 6500-PRINT-TOTAL-PAGE.
 20298
 20299     MOVE SPACES             TO TOTAL-PAGE-DETAIL.
 20300     MOVE LIFE-OVERRIDE-L6   TO TPD-DESC.
 20301     MOVE TPL-ISS-PRM (SUB6) TO TPD-ISS-PRM.
 20302
 20303     IF SUB6 = 6 AND ME-DO-UPDATE
 20304         MOVE TPL-ISS-PRM (6) TO ME-010-PREM-L.
 20305
 20306     MOVE TPL-CNC-PRM (SUB6) TO TPD-CNC-PRM.
 20307
 20308     IF SUB6 = 6 AND ME-DO-UPDATE
 20309         MOVE TPL-CNC-PRM (6) TO ME-010-REF-L.
 20310
 20311     COMPUTE TPD-NET-PRM =
 20312         TPL-ISS-PRM (SUB6) - TPL-CNC-PRM (SUB6).
 20313
 20314     IF SUB6 = 6 AND ME-DO-UPDATE
 20315         SUBTRACT TPL-CNC-PRM (6) FROM TPL-ISS-PRM (6)
 20316         GIVING ME-010-NET-L.
 20317
 20318     MOVE TPL-ACCT-COM (SUB6) TO TPD-ACCT-COM.
 20319
 20320     IF SUB6 = 6 AND ME-DO-UPDATE
 20321         MOVE TPL-ACCT-COM (6) TO ME-010-COMM-L.
 20322
 20323     COMPUTE TPD-PREM-COMP =
 20324         TPL-ISS-PRM (SUB6) - TPL-CNC-PRM (SUB6)
 20325                            - TPL-ACCT-COM (SUB6).
 20326     MOVE TPL-CLAIMS (SUB6)   TO TPD-CLAIMS.
 20327
 20328     IF SUB6 = 6 AND ME-DO-UPDATE
 20329         MOVE TPL-CLAIMS (6) TO ME-010-PMT-L.
 20330
 20331     IF SUB6 = 6
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 397
* ECS010T1.cbl
 20332         MOVE TPL-CLAIMS (6)          TO WS-ME-BAL-AMT
 20333         MOVE WS-BALANCE-DESCRIPTION1 TO WS-ME-BAL-DESCRIP
 20334         WRITE ME-ECS010-BALANCE-REC  FROM WS-ME-BALANCE-REC
 20335     END-IF.
 20336
 20337     MOVE TOTAL-PAGE-DETAIL   TO PRT.
 20338     PERFORM 8800-PRINT-ROUTINE.
 20339     MOVE SPACES             TO TOTAL-PAGE-DETAIL.
 20340     MOVE AH-OVERRIDE-L6     TO TPD-DESC.
 20341     MOVE TPA-ISS-PRM (SUB6) TO TPD-ISS-PRM.
 20342     MOVE TPA-CNC-PRM (SUB6) TO TPD-CNC-PRM.
 20343
 20344     IF SUB6 = 6 AND ME-DO-UPDATE
 20345         MOVE TPA-ISS-PRM (6) TO ME-010-PREM-AH
 20346         MOVE TPA-CNC-PRM (6) TO ME-010-REF-AH.
 20347
 20348     COMPUTE TPD-NET-PRM =
 20349         TPA-ISS-PRM (SUB6) - TPA-CNC-PRM (SUB6).
 20350
 20351     IF SUB6 = 6 AND ME-DO-UPDATE
 20352         SUBTRACT TPA-CNC-PRM (6) FROM TPA-ISS-PRM (6)
 20353         GIVING ME-010-NET-AH.
 20354
 20355     MOVE TPA-ACCT-COM (SUB6) TO TPD-ACCT-COM.
 20356
 20357     IF SUB6 = 6 AND ME-DO-UPDATE
 20358         MOVE TPA-ACCT-COM (6) TO ME-010-COMM-AH.
 20359
 20360     COMPUTE TPD-PREM-COMP =
 20361         TPA-ISS-PRM (SUB6) - TPA-CNC-PRM (SUB6)
 20362                            - TPA-ACCT-COM (SUB6).
 20363     MOVE TPA-CLAIMS (SUB6)   TO TPD-CLAIMS.
 20364
 20365     IF SUB6 = 6 AND ME-DO-UPDATE
 20366         MOVE TPA-CLAIMS (6) TO ME-010-PMT-AH.
 20367
 20368     IF SUB6 = 6
 20369         MOVE TPA-CLAIMS (6)          TO WS-ME-BAL-AMT
 20370         MOVE WS-BALANCE-DESCRIPTION2 TO WS-ME-BAL-DESCRIP
 20371         WRITE ME-ECS010-BALANCE-REC  FROM WS-ME-BALANCE-REC
 20372     END-IF.
 20373
 20374     MOVE TOTAL-PAGE-DETAIL   TO PRT.
 20375     PERFORM 8800-PRINT-ROUTINE.
 20376
 20377     MOVE 'TOTAL' TO TPD-DESC.
 20378
 20379     COMPUTE TPD-ISS-PRM =
 20380         TPL-ISS-PRM (SUB6) + TPA-ISS-PRM (SUB6).
 20381
 20382     COMPUTE TPD-CNC-PRM =
 20383         TPL-CNC-PRM (SUB6) + TPA-CNC-PRM (SUB6).
 20384
 20385     COMPUTE TPD-NET-PRM =
 20386         TPL-ISS-PRM (SUB6) + TPA-ISS-PRM (SUB6)
 20387         - TPL-CNC-PRM (SUB6) - TPA-CNC-PRM (SUB6).
 20388
 20389     COMPUTE TPD-ACCT-COM =
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 398
* ECS010T1.cbl
 20390         TPL-ACCT-COM (SUB6) + TPA-ACCT-COM (SUB6).
 20391
 20392     COMPUTE TPD-PREM-COMP =
 20393         TPL-ISS-PRM (SUB6) + TPA-ISS-PRM (SUB6)
 20394         - TPL-CNC-PRM (SUB6) - TPA-CNC-PRM (SUB6)
 20395         - TPL-ACCT-COM (SUB6) - TPA-ACCT-COM (SUB6).
 20396
 20397     COMPUTE TPD-CLAIMS =
 20398         TPL-CLAIMS (SUB6) + TPA-CLAIMS (SUB6).
 20399
 20400     IF SV-LO-CERT = ZEROS  AND  SV-HI-CERT = ZEROS
 20401         NEXT SENTENCE
 20402     ELSE
 20403         MOVE SV-LO-CERT (6:6) TO TPD-LO-CERT
 20404         MOVE SV-HI-CERT (6:6) TO TPD-HI-CERT
 20405         MOVE ZEROS TO SV-LO-CERT  SV-HI-CERT.
 20406*        MOVE SV-LO-CERT (4:8)    TO TPD-LO-CERT
 20407*        MOVE SV-HI-CERT (4:8)    TO TPD-HI-CERT
 20408*        MOVE ZEROS               TO SV-LO-CERT
 20409*                                    SV-HI-CERT.
 20410
 20411     MOVE TOTAL-PAGE-DETAIL       TO PRT.
 20412     MOVE '0'                     TO P-CTL.
 20413     PERFORM 8800-PRINT-ROUTINE.
 20414     PERFORM 8800-PRINT-ROUTINE.
 20415
 20416 6599-TOTAL-PAGE-PRINT-X.
 20417     EXIT.
 20418*
 20419*
 20420*
 20421**START***********************************************************
 20422*      CUSTOM CODING FOR CLIENT "DMD"            PROJECT# 6475
 20423*            PARAGRAPHS  XXXX THRU 6700-COMM-EXIT
 20424******************************************************************
 20425*
 20426 6650-GET-RES-STATE-COMM.
 20427*6650-BROWSE-FORWARD.
 20428
 20429     IF DTE-CLIENT NOT = 'DMD'
 20430         GO TO 6700-COMM-EXIT.
 20431
 20432     MOVE CR-COMPANY-CD       TO WS-ERRESC-COMPANY-CD.
 20433     MOVE CR-CARRIER          TO WS-ERRESC-CARRIER.
 20434     MOVE CR-GROUPING         TO WS-ERRESC-GROUP.
 20435     MOVE CR-STATE            TO WS-ERRESC-STATE.
 20436     MOVE CR-ACCOUNT          TO WS-ERRESC-ACCOUNT.
 20437     MOVE WK-AGT              TO WS-ERRESC-AGENT.
 20438     MOVE CR-CERT-NO (1:2)    TO WS-ERRESC-RES-STATE.
 20439     MOVE CR-DT               TO WS-YYYYMMDD-DT.
 20440
 20441     MOVE WS-YYYYMMDD-DT      TO WS-ERRESC-EXPIRE-DT.
 20442
 20443*POSITION FILE AT STARTING KEY RECORD(COMPANY, CARRIER, GROUP, STA
 20444*ACCOUNT,AGENT, RESIDENT STATE) AND RESC-EXPIRE-DATE SET BY THE
 20445*VALUE OF PB-CERT-EFF-DT
 20446*
 20447     MOVE WS-ERRESC-KEY        TO ERRESC-RECORD-KEY.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 399
* ECS010T1.cbl
 20448
 20449     START ERRESC-IN KEY NOT LESS THAN ERRESC-RECORD-KEY.
 20450
 20451     IF ERRESC-FILE-STATUS NOT EQUAL '00'
 20452         GO TO 6700-COMM-EXIT.
 20453
 20454*GET RECORD WHERE POSITIONED
 20455
 20456 6650-READ-ERRESC-NEXT.
 20457     READ ERRESC-IN NEXT RECORD.
 20458
 20459     IF ERRESC-FILE-STATUS NOT EQUAL '00'
 20460         GO TO 6700-COMM-EXIT.
 20461
 20462*GOT GOOD RECORD ??    FIRST 32 POSITIONS MUST MATCH  !!!!!!
 20463
 20464     IF ERRESC-RECORD-KEY (1:32) EQUAL TO WS-ERRESC-KEY (1:32)
 20465        NEXT SENTENCE
 20466     ELSE
 20467         GO TO 6700-COMM-EXIT.
 20468
 20469     IF WS-YYYYMMDD-DT < RESC-EXPIRE-DATE
 20470         NEXT SENTENCE
 20471     ELSE
 20472         GO TO 6650-READ-ERRESC-NEXT.
 20473
 20474*  CR-DT  = WS-YYYYMMDD-DT
 20475*CHECK TO SEE IF CERTIFICATE EFFECTIVE DATE IS WITHIN ACCOUNT
 20476*RESIDENT STATE COMMISSION RECORD'S EFFECTIVE TIME PERIOD???
 20477
 20478     IF WS-YYYYMMDD-DT IS LESS THAN RESC-EFFECTIVE-DATE
 20479         GO TO 6700-COMM-EXIT.
 20480
 20481* SEARCH FOR MATCHING CATEGORY CODE ENTRY
 20482
 20483     MOVE ZEROS               TO WS-SUB WS-SUB1.
 20484
 20485     PERFORM 6680-SEARCH-CATEGORY THRU 6680-EXIT.
 20486
 20487     IF WS-SUB1 IS GREATER THAN ZERO
 20488         IF RESC-COMMISSION-PER (WS-SUB) NOT NUMERIC
 20489             PERFORM 6680-SET-TABLE-CODE
 20490         ELSE
 20491             PERFORM 6680-SET-COMMISSION.
 20492
 20493     GO TO 6700-COMM-EXIT.
 20494
 20495 6680-SET-TABLE-CODE.
 20496     IF RESC-COMMISSION-TAB (WS-SUB) EQUAL SPACES
 20497        MOVE ZEROS             TO WS-SUB1
 20498     ELSE
 20499* DEFAULT TO AH-COVERAGE TO READ COMMISSION TABLE(CTBL)
 20500* TO COMPUTE AH COMMISSION.
 20501        MOVE CR-AHTYP          TO CTBL-BEN-CODE
 20502        MOVE CR-AH-TERM        TO WS-COMM-TERM
 20503        MOVE AH-OVERRIDE-L1    TO CTBL-BEN-TYPE
 20504        MOVE RESC-COMMISSION-TAB (WS-SUB)
 20505                               TO CTBL-TABLE-CD
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 400
* ECS010T1.cbl
 20506        PERFORM 6680-READ-CTBL-TABLE
 20507        IF ERCTBL-FILE-STATUS NOT EQUAL '00'
 20508           MOVE ZEROS          TO WS-SUB1.
 20509
 20510 6680-READ-CTBL-TABLE.
 20511*
 20512* WHEN CR-AHTYP = ZEROS READ COMMISSION TABLE(CTBL)
 20513* TO COMPUTE LIFE COMMISSION
 20514
 20515     IF CR-AHTYP = ZERO
 20516        MOVE LIFE-OVERRIDE-L1  TO CTBL-BEN-TYPE
 20517        MOVE CR-LFTYP          TO CTBL-BEN-CODE
 20518        MOVE CR-LF-TERM        TO WS-COMM-TERM.
 20519
 20520     PERFORM 1300-READ-ERCTBL-FILE THRU 1399-READ-ERCTBL-X.
 20521
 20522     IF ERCTBL-FILE-STATUS EQUAL '00'
 20523* COMPUTE A-H COMMISSION WHEN CR-AHTYP IS NOT ZEROS
 20524        IF CR-AHTYP NOT = ZERO
 20525             COMPUTE COMM-CK-AMT = CR-AHAMT * CR-AH-TERM
 20526             MOVE CR-AH-TERM        TO WS-COMM-TERM
 20527             PERFORM 1400-GET-COMM-PERCENT THRU 1489-GET-PERCENT-X
 20528             MOVE WK-RATE           TO WS-COMMISSION
 20529                                       PB-I-AH-COMMISSION
 20530        ELSE
 20531* COMPUTE LIFE COMMISSION WHEN CR-AHTYP IS ZEROS
 20532             MOVE CR-LFAMT    TO COMM-CK-AMT
 20533             MOVE CR-LF-TERM  TO WS-COMM-TERM
 20534             PERFORM 1400-GET-COMM-PERCENT THRU 1489-GET-PERCENT-X
 20535             MOVE WK-RATE     TO WS-COMMISSION
 20536                                 PB-I-LIFE-COMMISSION.
 20537
 20538 6680-SET-COMMISSION.
 20539     IF RESC-COMMISSION-PER (WS-SUB) EQUAL ZEROS
 20540           MOVE ZEROS         TO WS-SUB1
 20541       ELSE
 20542           MOVE RESC-COMMISSION-PER (WS-SUB)
 20543                              TO WS-COMMISSION WK-RATE
 20544           IF CR-AHTYP NOT = ZERO
 20545                MOVE WS-COMMISSION TO PB-I-AH-COMMISSION
 20546           ELSE
 20547                MOVE WS-COMMISSION TO PB-I-LIFE-COMMISSION.
 20548
 20549 6680-SEARCH-CATEGORY.
 20550     ADD +1 TO WS-SUB.
 20551
 20552     IF WS-SUB IS GREATER THAN +12
 20553         GO TO 6680-EXIT.
 20554
 20555     IF CR-CERT-NO (4:1) = RESC-COVERAGE-CAT (WS-SUB)
 20556          MOVE WS-SUB         TO WS-SUB1
 20557          GO TO 6680-EXIT.
 20558
 20559     GO TO 6680-SEARCH-CATEGORY.
 20560
 20561 6680-EXIT.
 20562     EXIT.
 20563
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 401
* ECS010T1.cbl
 20564 6700-COMM-EXIT.
 20565     EXIT.
 20566*
 20567*END***************CUSTOM CODE FOR CLIENT "DMD"*************
 20568
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 402
* ECS010T1.cbl
 20570******************************************************************
 20571***         C L I E N T   B I L L I N G   R O U T I N E        ***
 20572******************************************************************
 20573
 20574 7000-CLIENT-BILLING-ROUTINE.
 20575*
 20576*
 20577* LEAVE THE ABOVE 2 LINES IN TO PREVENT LOSING THE LINE ABOVE
 20578
 20579     MOVE +0 TO BC-NET-WRIT BC-NET-WRIT-OB BC-NET-WRIT-SP
 20580                BC-G-ISS      BC-G-CNC   BC-G-CLM
 20581                BC-G-CRS      BC-G-CTN   BC-R-ISS      BC-R-CNC
 20582                BC-R-CLM      BC-R-CRS   BC-R-CTN      BC-COMM
 20583                BC-NEW-ACCTS  BC-ACCTS   BC-ACT-ACCTS
 20584                BC-G-CERTS    BC-G-A-CERTS  BC-R-CERTS
 20585                BC-R-A-CERTS  BC-ER-ACCTS   BC-CS-ACCTS.
 20586
 20587 7099-BILL-X.
 20588     EXIT.
 20589
 20590
 20591 7500-ADD-UP-REIN-CO.
 20592
 20593     IF RB-COMPANY (B-SUB) NOT = SPACES
 20594         ADD RB-COUNT (B-SUB) TO BC-CS-ACCTS.
 20595
 20596 7599-ADD-UP-REIN-X.
 20597     EXIT.
 20598
 20599 7900-CLEAR-BILLING-TABLE.
 20600
 20601     MOVE SPACES TO RB-COMPANY (B-SUB).
 20602     MOVE 0      TO RB-COUNT (B-SUB).
 20603
 20604 7999-CLEAR-BILLING-X.
 20605     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 403
* ECS010T1.cbl
 20607******************************************************************
 20608***         M I S C E L L A N E O U S   R O U T I N E S        ***
 20609******************************************************************
 20610
 20611 8000-DATE-CONVERT-ROUTINE.
 20612
 20613     CALL 'ELDATCX' USING DATE-CONVERSION-DATA.
 20614
 20615 8099-DATE-CONVERT-X.
 20616     EXIT.
 20617
 20618 8000R-CONVERT-STOP-DATE.
 20619
 20620     MOVE RWF-EP-STOP-DATE        TO DC-GREG-DATE-CYMD.
 20621     MOVE 'L'                     TO DC-OPTION-CODE.
 20622     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 20623     MOVE +0                      TO DC-ELAPSED-MONTHS.
 20624     MOVE -1                      TO DC-ELAPSED-DAYS.
 20625     MOVE '6'                     TO DC-OPTION-CODE.
 20626     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 20627     MOVE +0                      TO DC-ELAPSED-MONTHS
 20628                                     DC-ELAPSED-DAYS.
 20629     MOVE DC-BIN-DATE-2           TO DC-BIN-DATE-1.
 20630     MOVE ' '                     TO DC-OPTION-CODE.
 20631     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 20632
 20633     IF NO-CONVERSION-ERROR
 20634         MOVE DC-GREG-DATE-CYMD   TO EARNING-STOP-DATE
 20635     ELSE
 20636         DISPLAY 'ERROR OCCURED CONVERTING EARNING STOP '
 20637                 'DATE IN REIN TABLE: ' CR-REIN-TABLE
 20638                 '  STOP DATE: ' RWF-EP-STOP-DATE
 20639         MOVE 'ERROR OCCURED CONVERTING EARNING STOP DATE '
 20640                                  TO WS-ABEND-MESSAGE
 20641         MOVE DC-ERROR-CODE       TO WS-ABEND-FILE-STATUS
 20642         MOVE 4002                TO WS-ABEND-CODE
 20643         GO TO ABEND-PGM.
 20644
 20645 8099R-STOP-DATE-X.
 20646     EXIT.
 20647
 20648
 20649 8100-GET-RATE.
 20650
 20651     CALL 'ELRATEX' USING CALCULATION-PASS-AREA.
 20652
 20653 8199-GET-RATE-X.
 20654     EXIT.
 20655
 20656
 20657 8200-STATE-CODE-LOOKUP.
 20658
 20659     IF CLAS-INDEXS NOT GREATER CLAS-MAXS  AND
 20660        CLAS-INDEXS NOT = ZERO
 20661         IF STATE-L = STATE-SUB (CLAS-INDEXS)
 20662             GO TO 8299-STATE-LOOKUP-X.
 20663
 20664     MOVE CLAS-STARTS TO CLAS-INDEXS.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 404
* ECS010T1.cbl
 20665
 20666 8250-STATE-LOOKUP-LOOP.
 20667
 20668     IF CLAS-INDEXS GREATER CLAS-MAXS  OR  CLAS-INDEXS = ZERO
 20669         MOVE 0302 TO WS-ABEND-CODE
 20670         DISPLAY 'STATE CODE ' STATE-L ' NOT IN STATE TABLE'
 20671         DISPLAY '******************************'
 20672         DISPLAY '***** ERROR LOCATION 022 *****'
 20673         DISPLAY '******************************'
 20674         MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
 20675         GO TO ABEND-PGM.
 20676
 20677     IF STATE-L NOT = STATE-SUB (CLAS-INDEXS)
 20678         ADD +1 TO CLAS-INDEXS
 20679         GO TO 8250-STATE-LOOKUP-LOOP.
 20680
 20681 8299-STATE-LOOKUP-X.
 20682     EXIT.
 20683
 20684
 20685 8300-LIFE-TYPE-LOOKUP.
 20686
 20687     IF CLAS-INDEXL NOT GREATER CLAS-MAXL  AND
 20688        CLAS-INDEXL NOT = ZERO
 20689         IF CLAS-LOOK = CLAS-I-BEN (CLAS-INDEXL)
 20690             GO TO 8399-LIFE-LOOKUP-X.
 20691
 20692     MOVE CLAS-STARTL TO CLAS-INDEXL.
 20693
 20694 8350-LIFE-LOOKUP-LOOP.
 20695
 20696     IF CLAS-INDEXL GREATER CLAS-MAXL  OR  CLAS-INDEXL = ZERO
 20697         MOVE 0401 TO WS-ABEND-CODE
 20698         DISPLAY 'LIFE TYPE ' CLAS-LOOK ' NOT IN TYPE TABLE'
 20699         DISPLAY '    PENDING CONTROL = ' PENDING-MATCH-CONTROL
 20700         DISPLAY '       CERT CONTROL = ' CR-FULL-CONTROL
 20701         DISPLAY '******************************'
 20702         DISPLAY '***** ERROR LOCATION 023 *****'
 20703         DISPLAY '******************************'
 20704         MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
 20705         IF DTE-CLIENT = 'NCL'
 20706                      OR 'CID'
 20707             MOVE CLAS-STARTL      TO CLAS-INDEXL
 20708             MOVE '05'             TO CLAS-LOOK
 20709             GO TO 8350-LIFE-LOOKUP-LOOP
 20710         ELSE
 20711             GO TO ABEND-PGM.
 20712
 20713     IF CLAS-LOOK NOT = CLAS-I-BEN (CLAS-INDEXL)
 20714         ADD +1 TO CLAS-INDEXL
 20715         GO TO 8350-LIFE-LOOKUP-LOOP.
 20716
 20717     IF CLAS-I-EP (CLAS-INDEXL) = 'U'
 20718         MOVE 'R'                    TO CLAS-I-EP (CLAS-INDEXL).
 20719
 20720 8399-LIFE-LOOKUP-X.
 20721     EXIT.
 20722
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 405
* ECS010T1.cbl
 20723
 20724 8400-A-H-TYPE-LOOKUP.
 20725
 20726     IF CLAS-INDEXA NOT GREATER CLAS-MAXA  AND
 20727        CLAS-INDEXA NOT = ZERO
 20728         IF CLAS-LOOK = CLAS-I-BEN (CLAS-INDEXA)
 20729             GO TO 8499-A-H-LOOKUP-X.
 20730
 20731     MOVE CLAS-STARTA TO CLAS-INDEXA.
 20732
 20733 8450-A-H-LOOKUP-LOOP.
 20734
 20735     IF CLAS-INDEXA GREATER CLAS-MAXA  OR  CLAS-INDEXA = ZERO
 20736         MOVE 0402 TO WS-ABEND-CODE
 20737         DISPLAY 'A&H TYPE ' CLAS-LOOK ' NOT IN TYPE TABLE'
 20738         DISPLAY '    PENDING CONTROL = ' PENDING-MATCH-CONTROL
 20739         DISPLAY '       CERT CONTROL = ' CR-FULL-CONTROL
 20740         DISPLAY '******************************'
 20741         DISPLAY '***** ERROR LOCATION 024 *****'
 20742         DISPLAY '******************************'
 20743         MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
 20744         IF DTE-CLIENT = 'NCL'
 20745             MOVE CLAS-STARTA      TO CLAS-INDEXA
 20746             MOVE '05'             TO CLAS-LOOK
 20747             GO TO 8450-A-H-LOOKUP-LOOP
 20748         ELSE
 20749             GO TO ABEND-PGM.
 20750
 20751     IF CLAS-LOOK NOT = CLAS-I-BEN (CLAS-INDEXA)
 20752         ADD +1 TO CLAS-INDEXA
 20753         GO TO 8450-A-H-LOOKUP-LOOP.
 20754
 20755 8499-A-H-LOOKUP-X.
 20756     EXIT.
 20757
 20758 8500-REMAINING-TERM-ROUTINE.
 20759
 20760     MOVE ZEROS                      TO CP-REMAINING-TERM
 20761                                        CP-REMAINING-TERM-1
 20762                                        CP-REMAINING-TERM-2
 20763                                        CP-REMAINING-TERM-3
 20764                                        CP-RETURN-CODE
 20765                                        CP-RETURN-CODE-2
 20766                                        REM-TRM1
 20767                                        REM-TRM2
 20768                                        REM-TRM3
 20769                                        TEM-TRM1.
 20770     MOVE SPACES                     TO CP-REM-TERM-METHOD.
 20771
 20772     MOVE CR-DT                      TO DC-GREG-DATE-CYMD.
 20773     MOVE 'L'                        TO DC-OPTION-CODE.
 20774     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 20775
 20776     IF  NO-CONVERSION-ERROR
 20777         MOVE DC-BIN-DATE-1          TO CP-CERT-EFF-DT
 20778     ELSE
 20779         MOVE 'ERROR OCCURED CONVERTING CR-DT'
 20780                                     TO WS-ABEND-MESSAGE
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 406
* ECS010T1.cbl
 20781         MOVE DC-ERROR-CODE          TO WS-ABEND-FILE-STATUS
 20782         MOVE 3001                   TO WS-ABEND-CODE
 20783         GO TO ABEND-PGM.
 20784
 20785     MOVE LOW-VALUES                 TO CP-FIRST-PAY-DATE
 20786
 20787     IF  CR-LOAN-1ST-PMT-DT NOT NUMERIC
 20788         MOVE ZEROS                  TO CR-LOAN-1ST-PMT-DT.
 20789
 20790     IF  CR-LOAN-1ST-PMT-DT NOT = ZEROS
 20791         MOVE CR-LOAN-1ST-PMT-DT     TO DC-GREG-DATE-1-YMD
 20792         MOVE ZEROS                  TO DC-ELAPSED-MONTHS
 20793                                        DC-ELAPSED-DAYS
 20794         MOVE '3'                    TO DC-OPTION-CODE
 20795         PERFORM 8000-DATE-CONVERT-ROUTINE THRU
 20796                 8099-DATE-CONVERT-X
 20797         IF  NO-CONVERSION-ERROR
 20798             MOVE DC-BIN-DATE-1      TO CP-FIRST-PAY-DATE
 20799         ELSE
 20800             MOVE ZEROS              TO CR-LOAN-1ST-PMT-DT.
 20801
 20802     IF  CP-FIRST-PAY-DATE LESS THAN CP-CERT-EFF-DT
 20803         MOVE ZEROS                  TO CR-LOAN-1ST-PMT-DT.
 20804
 20805     IF  CR-LOAN-1ST-PMT-DT = ZEROS
 20806         MOVE CP-CERT-EFF-DT         TO DC-BIN-DATE-1
 20807         MOVE +1                     TO DC-ELAPSED-MONTHS
 20808         MOVE ZEROS                  TO DC-ELAPSED-DAYS
 20809         MOVE '6'                    TO DC-OPTION-CODE
 20810         PERFORM 8000-DATE-CONVERT-ROUTINE THRU
 20811                 8099-DATE-CONVERT-X
 20812         IF  NO-CONVERSION-ERROR
 20813             MOVE DC-BIN-DATE-2      TO CP-FIRST-PAY-DATE
 20814             MOVE DC-GREG-DATE-1-YMD TO CR-LOAN-1ST-PMT-DT
 20815         ELSE
 20816             MOVE 'ERROR OCCURED DETERMINING 1ST PAY DATE '
 20817                                     TO WS-ABEND-MESSAGE
 20818             MOVE DC-ERROR-CODE      TO WS-ABEND-FILE-STATUS
 20819             MOVE 3002               TO WS-ABEND-CODE
 20820             GO TO ABEND-PGM.
 20821
 20822     MOVE VALUATION-DT               TO DC-GREG-DATE-CYMD.
 20823     MOVE 'L'                        TO DC-OPTION-CODE.
 20824     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 20825
 20826     IF  NO-CONVERSION-ERROR
 20827         MOVE DC-BIN-DATE-1          TO CP-VALUATION-DT
 20828     ELSE
 20829         DISPLAY 'ERROR CONVERTING VALUATION DATE, SOURCE - '
 20830             W-VAL-ERROR (W-VAL-SOURCE)
 20831         DISPLAY '   KEY - ' CR-FULL-CONTROL
 20832             ' VALUATION DT - ' VALUATION-DT ' ERROR - '
 20833             DC-ERROR-CODE
 20834         DISPLAY '   STATUS: ' CR-ENTRY-STATUS ' LF: ' CR-LFTYP
 20835         ' ' CR-LF-CURRENT-STATUS '-' CR-LF-STATUS-AT-CANCEL '-'
 20836             CR-LF-STATUS-AT-DEATH ' AH: ' CR-AHTYP ' '
 20837             CR-AH-CURRENT-STATUS '-' CR-AH-STATUS-AT-CANCEL '-'
 20838             CR-AH-STATUS-AT-SETTLEMENT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 407
* ECS010T1.cbl
 20839*        MOVE 'ERROR OCCURED CONVERTING VALUATION DATE'
 20840*                                    TO WS-ABEND-MESSAGE
 20841*        MOVE DC-ERROR-CODE          TO WS-ABEND-FILE-STATUS
 20842*        MOVE 3003                   TO WS-ABEND-CODE
 20843*        GO TO ABEND-PGM.
 20844
 20845     MOVE STATE-SUB (CLAS-INDEXS)    TO CP-STATE.
 20846     MOVE STATE-ABBR (CLAS-INDEXS)   TO CP-STATE-STD-ABBRV.
 20847     MOVE '3'                        TO CP-PROCESS-TYPE.
 20848     MOVE DTE-CLASIC-COMPANY-CD      TO CP-COMPANY-CD.
 20849     MOVE DTE-CLIENT                 TO CP-COMPANY-ID.
 20850     MOVE SPACES                     TO CP-ACCT-FLD-5.
 20851
 20852*    MOVE CLAS-CO-REM-TERM-CALC (W-NDX)
 20853*                                    TO CP-REM-TERM-METHOD.
 20854
 20855     IF  DTE-CLIENT = 'FIM'
 20856         MOVE '5'                    TO CP-REM-TERM-METHOD.
 20857
 20858     IF DTE-CLIENT = 'FLI' OR 'FLU'
 20859         IF WE-LF-AH = AH-OVERRIDE-L1
 20860             MOVE '2'                TO CP-REM-TERM-METHOD
 20861         ELSE
 20862             IF CR-LFTYP = '01' OR '03'
 20863                 MOVE '4'            TO CP-REM-TERM-METHOD
 20864             ELSE
 20865                 IF CR-LFTYP = '02' OR '04'
 20866                     MOVE '2'        TO CP-REM-TERM-METHOD.
 20867
 20868     IF  DTE-CLIENT = 'CSL'
 20869         IF  CR-CARRIER = '2'
 20870             IF  CR-LFTYP = '07' OR  '08'
 20871                 MOVE '4'            TO CP-REM-TERM-METHOD.
 20872
 20873     IF  DTE-CLIENT = 'POS'
 20874         IF  CR-CARRIER = '1'
 20875             MOVE '1'                TO CP-REM-TERM-METHOD
 20876         ELSE
 20877             MOVE '2'                TO CP-REM-TERM-METHOD.
 20878
 20879     IF  CP-REM-TERM-METHOD = SPACES OR LOW-VALUES
 20880         MOVE DTE-REM-TRM            TO CP-REM-TERM-METHOD.
 20881
 20882     IF  WE-LF-AH EQUAL AH-OVERRIDE-L1
 20883         GO TO 8540-CALC-REM-TERM-AH.
 20884
 20885 8520-CALC-REM-TERM-LIFE.
 20886
 20887     MOVE CLAS-I-EP (CLAS-INDEXL)    TO CP-EARNING-METHOD.
 20888     MOVE CLAS-I-RL-AH (CLAS-INDEXL) TO CP-BENEFIT-TYPE.
 20889     MOVE CLAS-I-BAL (CLAS-INDEXL)   TO CP-SPECIAL-CALC-CD.
 20890*    MOVE ORIG-TERM                  TO CP-ORIGINAL-TERM.
 20891     MOVE CR-LF-TERM                 TO CP-ORIGINAL-TERM
 20892                                        CP-LOAN-TERM.
 20893
 20894     IF  CLAS-I-EP (CLAS-INDEXL) EQUAL 'B'
 20895             AND
 20896         CLAS-I-CALC-TYPE (CLAS-INDEXL) NOT EQUAL 'L'
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 408
* ECS010T1.cbl
 20897         ADD +1                      TO CP-ORIGINAL-TERM
 20898                                        CP-LOAN-TERM.
 20899
 20900     IF  CP-TERM-IS-DAYS
 20901         MOVE CR-LF-TERM-IN-DAYS     TO CP-TERM-OR-EXT-DAYS
 20902     ELSE
 20903         MOVE ZEROS                  TO CP-TERM-OR-EXT-DAYS.
 20904
 20905     MOVE DTE-REM-TRM-CALC-OPTION    TO CP-REM-TRM-CALC-OPTION.
 20906
 20907     IF  CP-ORIGINAL-TERM NOT GREATER THAN ZEROS
 20908         ADD +1                      TO W-ORGTRM-0-LF
 20909         DISPLAY 'LF TRM NOT GREATER THAN +0 - '
 20910             CR-FULL-CONTROL
 20911         GO TO 8599-REM-TERM-X.
 20912
 20913     CALL 'ELRTRMX' USING CALCULATION-PASS-AREA.
 20914
 20915     IF  CP-RETURN-CODE NOT EQUAL ZEROS
 20916         ADD +1                      TO W-RET-CODE-LF
 20917         GO TO 8599-REM-TERM-X.
 20918*
 20919*        MOVE 'ERROR OCCURED REMAINING TERM CALCULATION - LF'
 20920*                                    TO WS-ABEND-MESSAGE
 20921*        MOVE CP-RETURN-CODE         TO WS-ABEND-FILE-STATUS
 20922*        MOVE 2002                   TO WS-ABEND-CODE
 20923*        GO TO ABEND-PGM.
 20924
 20925     IF  CLAS-I-EP (CLAS-INDEXL) EQUAL 'B'
 20926             AND
 20927         CLAS-I-CALC-TYPE (CLAS-INDEXL) NOT EQUAL 'L'
 20928         MOVE CP-REMAINING-TERM-2    TO W-BAL-REMTRM
 20929         COMPUTE CP-REMAINING-TERM-1 = CP-REMAINING-TERM-1 - 1
 20930         COMPUTE CP-REMAINING-TERM-2 = CP-REMAINING-TERM-2 - 1.
 20931
 20932     IF  CP-REMAINING-TERM-1 NEGATIVE
 20933         MOVE ZEROS                  TO CP-REMAINING-TERM-1.
 20934
 20935     IF  CP-REMAINING-TERM-2 NEGATIVE
 20936         MOVE ZEROS                  TO CP-REMAINING-TERM-2.
 20937
 20938     IF DTE-CLIENT = 'NCL'
 20939         MOVE CP-REMAINING-TERM-1    TO CP-REMAINING-TERM-2
 20940                                        CP-REMAINING-TERM-3.
 20941
 20942     MOVE CP-REMAINING-TERM-1        TO REM-TRM1.
 20943     MOVE CP-REMAINING-TERM-2        TO REM-TRM2.
 20944     MOVE CP-REMAINING-TERM-3        TO REM-TRM3.
 20945     MOVE CP-ODD-DAYS                TO TEM-TRM1.
 20946
 20947     GO TO 8599-REM-TERM-X.
 20948
 20949 8520-EXIT.
 20950     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 409
* ECS010T1.cbl
 20952 8540-CALC-REM-TERM-AH.
 20953
 20954     MOVE CLAS-I-EP (CLAS-INDEXA)    TO CP-EARNING-METHOD.
 20955     MOVE CLAS-I-RL-AH (CLAS-INDEXA) TO CP-BENEFIT-TYPE.
 20956     MOVE CLAS-I-BAL (CLAS-INDEXA)   TO CP-SPECIAL-CALC-CD.
 20957     MOVE CR-AH-TERM                 TO CP-ORIGINAL-TERM
 20958                                        CP-LOAN-TERM.
 20959     MOVE ZEROS                      TO CP-TERM-OR-EXT-DAYS.
 20960
 20961     MOVE DTE-REM-TRM-CALC-OPTION    TO CP-REM-TRM-CALC-OPTION.
 20962
 20963     IF  CP-ORIGINAL-TERM NOT GREATER THAN ZEROS
 20964         DISPLAY 'AH TRM NOT GREATER THAN +0 - '
 20965             CR-FULL-CONTROL
 20966         ADD +1                      TO W-ORGTRM-0-AH
 20967         GO TO 8599-REM-TERM-X.
 20968
 20969     CALL 'ELRTRMX' USING CALCULATION-PASS-AREA.
 20970
 20971     IF  CP-RETURN-CODE NOT EQUAL ZEROS
 20972         ADD +1                      TO W-RET-CODE-AH
 20973         GO TO 8599-REM-TERM-X.
 20974*
 20975*        MOVE 'ERROR OCCURED REMAINING TERM CALCULATION - AH'
 20976*                                    TO WS-ABEND-MESSAGE
 20977*        MOVE CP-RETURN-CODE         TO WS-ABEND-FILE-STATUS
 20978*        MOVE 2001                   TO WS-ABEND-CODE
 20979*        GO TO ABEND-PGM.
 20980
 20981     IF DTE-CLIENT = 'NCL'
 20982         MOVE CP-REMAINING-TERM-1    TO CP-REMAINING-TERM-2
 20983                                        CP-REMAINING-TERM-3.
 20984
 20985     MOVE CP-REMAINING-TERM-1        TO REM-TRM1.
 20986     MOVE CP-REMAINING-TERM-2        TO REM-TRM2.
 20987     MOVE CP-REMAINING-TERM-3        TO REM-TRM3.
 20988     MOVE CP-ODD-DAYS                TO TEM-TRM1.
 20989
 20990 8599-REM-TERM-X.
 20991     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 410
* ECS010T1.cbl
 20993
 20994******************************************************************
 20995***     " D I S P L A Y "  P R I N T   R O U T I N E           ***
 20996******************************************************************
 20997
 20998 8600-DISPLAY-PRT.
 20999
 21000     IF  DIS-LINE-CNT GREATER THAN 59
 21001         PERFORM 8600-DISPLAY-HD THRU
 21002             8600-HD-EXIT.
 21003
 21004     ADD  1  TO DIS-LINE-CNT.
 21005     WRITE DISPLAY-REC FROM DISPLAY-LINE.
 21006     MOVE  SPACES TO DISPLAY-REC
 21007                     DISPLAY-LINE.
 21008
 21009 8600-DISPLAY-EXIT.
 21010     EXIT.
 21011
 21012
 21013 8600-DISPLAY-HD.
 21014
 21015     MOVE '1'  TO  DISPLAY-CC.
 21016     MOVE ZEROS TO DIS-LINE-CNT.
 21017     WRITE DISPLAY-REC FROM DISPLAY-HD-1.
 21018     ADD +1 TO DIS-LINE-CNT.
 21019     MOVE ' '  TO  DISPLAY-CC.
 21020     MOVE SPACES TO DISPLAY-REC.
 21021     WRITE DISPLAY-REC.
 21022     ADD +1 TO DIS-LINE-CNT.
 21023     MOVE WS-CURRENT-DATE  TO  DIS-DATE.
 21024     WRITE DISPLAY-REC FROM DISPLAY-HD-2.
 21025     ADD +1 TO DIS-LINE-CNT.
 21026     MOVE SPACES TO DISPLAY-REC.
 21027     ADD +1 TO DIS-LINE-CNT.
 21028     WRITE DISPLAY-REC.
 21029
 21030 8600-HD-EXIT.
 21031     EXIT.
 21032
 21033******************************************************************
 21034***      T R A N S A C T I O N   P R I N T   R O U T I N E     ***
 21035******************************************************************
 21036
 21037 8600-SETUP-DETAIL-LINE.
 21038
 21039     MOVE SPACES                TO TR-DTL2.
 21040
 21041     MOVE CR-CERT-NO            TO TRD-CERT.
 21042     MOVE CR-YR                 TO TRD-ISYR.
 21043     MOVE CR-MO                 TO TRD-ISMO.
 21044     MOVE CR-DA                 TO TRD-ISDA.
 21045     MOVE CR-AGE                TO TRD-AGE.
 21046
 21047 8689-SETUP-DETAIL-X.
 21048     EXIT.
 21049
 21050 8690-PRINT-DETAIL-LINE.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 411
* ECS010T1.cbl
 21051
 21052     IF LN-CNT GREATER THAN LN-MX
 21053         PERFORM 8700-PRINT-REPORT-HEADINGS THRU
 21054                 8799-PRT-HEADINGS-X.
 21055     MOVE TRD-CERT TO SV-TRD-CERT.
 21056     MOVE TRD-ISDT TO SV-TRD-ISDT.
 21057
 21058     IF TRD-CERT = LST-TRD-CERT  AND  TRD-ISDT = LST-TRD-ISDT
 21059         MOVE SPACES TO TRD-CERT  TRD-ISDT  TRD-AGE.
 21060
 21061     MOVE SV-TRD-CERT TO LST-TRD-CERT.
 21062     MOVE SV-TRD-ISDT TO LST-TRD-ISDT.
 21063     MOVE TR-DTL TO PRT.
 21064
 21065     IF NOT WS-CHANGE-REC
 21066         MOVE '/'                TO TRD-IS-S1  TRD-IS-S2
 21067     ELSE
 21068         MOVE 'N'                TO  WS-CHANGE-REC-SW.
 21069
 21070     PERFORM 8800-PRINT-ROUTINE.
 21071
 21072 8699-PRT-DETAIL-X.
 21073     EXIT.
 21074
 21075 8700-PRINT-REPORT-HEADINGS.
 21076     ADD +1 TO PG-CNT.
 21077     MOVE PG-CNT TO TR-PG.
 21078     MOVE +0 TO LN-CNT.
 21079     MOVE TR-HD-1 TO PRT.
 21080     PERFORM 8800-PRINT-ROUTINE.
 21081     MOVE TR-HD-2 TO PRT.
 21082     PERFORM 8800-PRINT-ROUTINE.
 21083     MOVE TR-HD-3 TO PRT.
 21084     PERFORM 8800-PRINT-ROUTINE.
 21085     ADD +1 TO LN-CNT.
 21086
 21087 8725-PRT-ACCT-HEADING.
 21088     MOVE TR-HD-4 TO PRT.
 21089     PERFORM 8800-PRINT-ROUTINE.
 21090     MOVE TR-HD-5 TO PRT.
 21091     PERFORM 8800-PRINT-ROUTINE.
 21092
 21093 8750-PRT-RANGE-HEADING.
 21094     MOVE TR-HD-6 TO PRT.
 21095     PERFORM 8800-PRINT-ROUTINE.
 21096
 21097 8775-PRT-COLUMN-HEADINGS.
 21098     MOVE TR-HD-7 TO PRT.
 21099     PERFORM 8800-PRINT-ROUTINE.
 21100     MOVE TR-HD-8 TO PRT.
 21101     PERFORM 8800-PRINT-ROUTINE.
 21102     MOVE TR-HD-9 TO PRT.
 21103     PERFORM 8800-PRINT-ROUTINE.
 21104     PERFORM 8800-PRINT-ROUTINE.
 21105
 21106 8799-PRT-HEADINGS-X.
 21107     EXIT.
 21108
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 412
* ECS010T1.cbl
 21109 8800-PRINT-ROUTINE.
 21110     MOVE P-CTL TO X.
 21111     PERFORM 8900-PRINT-A-LINE THRU 8999-PRT-LINE-X.
 21112     ADD +1 TO LN-CNT.
 21113     MOVE SPACES TO PRT.
 21114
 21115 8900-PRINT-A-LINE.
*21116                             COPY ELCPRT2.
 21117******************************************************************04/15/98
 21118*                                                                *ELCPRT2
 21119*                                                                *ELCPRT2
 21120*                            ELCPRT2                             *   LV005
 21121*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**5
 21122*                            VMOD=2.002                          *   CL**5
 21123*                                                                *   CL**4
 21124******************************************************************   CL**4
 21125                                                                     CL**4
 21126     IF DTE-FICH NOT = SPACE AND                                     CL**4
 21127        FICH-OPEN    = SPACE                                         CL**4
 21128         MOVE 'X'                TO  FICH-OPEN                       CL**4
 21129         OPEN OUTPUT FICH.                                           CL**4
 21130                                                                     CL**4
 21131     IF DTE-FICH NOT = SPACE                                         CL**4
 21132         MOVE X                  TO  P-CTL                           CL**4
 21133         WRITE FICH-REC FROM PRT.                                    CL**4
 21134                                                                     CL**4
 21135     IF DTE-FICH = SPACE OR '2'                                      CL**4
 21136       MOVE X                    TO  P-CTL                           CL**4
 21137       IF P-CTL = ' '                                                CL**4
 21138         WRITE PRT AFTER ADVANCING 1 LINE                            CL**4
 21139       ELSE                                                          CL**4
 21140         IF P-CTL = '0'                                              CL**4
 21141           WRITE PRT AFTER ADVANCING 2 LINES                         CL**4
 21142         ELSE                                                        CL**4
 21143           IF P-CTL = '-'                                            CL**4
 21144             WRITE PRT AFTER ADVANCING 3 LINES                       CL**4
 21145           ELSE                                                      CL**4
 21146             WRITE PRT AFTER ADVANCING PAGE.                         CL**4
 21147                                                                     CL**4
 21148******************************************************************   CL**4
 21149
 21150 8999-PRT-LINE-X.
 21151     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 413
* ECS010T1.cbl
 21153******************************************************************
 21154***          E N D   O F   J O B   P R O C E S S I N G         ***
 21155******************************************************************
 21156
 21157 9910-EOJ-1.
 21158     IF TR-CNT = ZERO
 21159         IF (DTE-PGM-OPT = '2' OR '3') OR
 21160            (DTE-CLIENT = 'LGX' OR 'FNA' OR 'HER' OR 'NCL' OR
 21161                          'ITY' OR 'DAC' OR 'FLC')
 21162             NEXT SENTENCE
 21163         ELSE
 21164             MOVE 'NO INPUT TRANSACTIONS' TO WS-ABEND-MESSAGE
 21165             MOVE 0703                    TO WS-ABEND-CODE
 21166             DISPLAY '******************************'
 21167             DISPLAY '***** ERROR LOCATION 025 *****'
 21168             DISPLAY '******************************'
 21169             MOVE WS-ABEND-CODE           TO WS-RETURN-CODE
 21170             GO TO ABEND-PGM.
 21171
 21172     MOVE '*'         TO TRANS-EOF-FLAG.
 21173     MOVE HIGH-VALUES TO PENDING-MATCH-CONTROL.
 21174
 21175     IF EOF-ON-CERT
 21176         PERFORM 0400-WRITE-CERT-RECORD THRU 0499-WRITE-CERT-X
 21177         GO TO 9940-EOJ-FIN.
 21178
 21179     GO TO 0330-MATCH-PENDING-TO-CERT.
 21180
 21181 9920-EOJ-2.
 21182     MOVE '*'         TO CERT-EOF-FLAG.
 21183     MOVE HIGH-VALUES TO CIR-CONTROL.
 21184
 21185     IF EOF-ON-TRANS
 21186         PERFORM 0400-WRITE-CERT-RECORD THRU 0499-WRITE-CERT-X
 21187         MOVE HIGH-VALUES TO CERTIFICATE-RECORD
 21188         GO TO 9940-EOJ-FIN.
 21189
 21190     GO TO 0299-READ-CERT-X.
 21191
 21192 9930-EOJ-3.
 21193     IF PROCESSING-COMPLETED
 21194         GO TO 9950-EOJ-FIN-GO.
 21195
 21196     DISPLAY 'MISSING ACCOUNT MASTER - '  CR-ACCT-CONTROL.
 21197     MOVE 'MISSING ACCOUNT MASTER'
 21198                               TO WS-ABEND-MESSAGE.
 21199     MOVE 0302                 TO WS-ABEND-CODE.
 21200     DISPLAY '******************************'
 21201     DISPLAY '***** ERROR LOCATION 026 *****'
 21202     DISPLAY '******************************'
 21203     MOVE WS-ABEND-CODE        TO WS-RETURN-CODE.
 21204     GO TO ABEND-PGM.
 21205
 21206 9940-EOJ-FIN.
 21207     MOVE '*'        TO PROCESSING-FLAG.
 21208     MOVE LOW-VALUES TO CERTIFICATE-RECORD.
 21209
 21210     PERFORM 0100-ACCT-MASTER-READ-ROUTINE THRU
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 414
* ECS010T1.cbl
 21211             0199-READ-ACCOUNT-X.
 21212     GO TO 9940-EOJ-FIN.
 21213
 21214 9950-EOJ-FIN-GO.
 21215     PERFORM 5500-FINAL-BREAK THRU 5599-FINAL-BREAK-X.
 21216     MOVE HIGH-VALUES TO ACCOUNT-MASTER.
 21217*
 21218*
 21219* LEAVE THE ABOVE 2 LINE IN TO PREVENT LOSING THE LINE ABOVE
 21220     PERFORM 7000-CLIENT-BILLING-ROUTINE THRU 7099-BILL-X.
 21221
 21222 9960-NO-TOTS.
 21223
 21224     MOVE +15                    TO LN-CNT.
 21225     MOVE CMIN-CNT               TO TTL-PT-CNT.
 21226     IF ME-DO-UPDATE
 21227         MOVE CMIN-CNT           TO ME-010-CERT-IN.
 21228
 21229     MOVE CMIN-CNT                TO WS-ME-BAL-AMT.
 21230     MOVE WS-BALANCE-DESCRIPTION3 TO WS-ME-BAL-DESCRIP.
 21231     WRITE ME-ECS010-BALANCE-REC  FROM WS-ME-BALANCE-REC.
 21232
 21233
 21234     MOVE 'INPUT CERTIFICATE MASTER RECORDS' TO TTL-HD-DS.
 21235     MOVE TR-TTL-HD              TO PRT.
 21236     PERFORM 8800-PRINT-ROUTINE.
 21237     ADD +1 TO LN-CNT.
 21238     MOVE TR-CNT                TO TTL-PT-CNT.
 21239     MOVE 'TRANSACTION RECORDS' TO TTL-HD-DS.
 21240     MOVE TR-TTL-HD             TO PRT.
 21241     PERFORM 8800-PRINT-ROUTINE.
 21242     ADD +1 TO LN-CNT.
 21243
 21244     IF DUP-CNT = ZERO
 21245         GO TO 9969-CHECK-MISMATCHED-TOTS.
 21246
 21247     MOVE DUP-CNT                 TO TTL-PT-CNT.
 21248
 21249     IF ME-DO-UPDATE
 21250         MOVE DUP-CNT            TO ME-010-DUP-ISS.
 21251
 21252     MOVE 'DUPE ISSUES DROPPED  ' TO TTL-HD-DS.
 21253     MOVE TR-TTL-HD               TO PRT.
 21254     PERFORM 8800-PRINT-ROUTINE.
 21255     PERFORM 8800-PRINT-ROUTINE.
 21256     ADD +1 TO LN-CNT.
 21257
 21258     MOVE '1'                           TO  DTL-REC-TYPE.
 21259     MOVE 'ISS'                         TO  DTL-REC-TYPE-DESC.
 21260     MOVE SPACES                        TO  DTL-CERT-IN-CONTROL.
 21261     MOVE 'DUPLICATE CERTIFICATE RECORD WILL BE'
 21262                                        TO  DTL-CERT-OUT-CONTROL.
 21263     MOVE SPACES                        TO  MISMATCH-DETAIL-2.
 21264     MOVE ' LIFE PREMIUM = '            TO  MD2-LF-PREM-DESC.
 21265     MOVE ' A&H  PREMIUM = '            TO  MD2-LF-ALT-PREM-DESC.
 21266
 21267     MOVE +1 TO SUB3.
 21268 9965-PRT-DUPES.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 415
* ECS010T1.cbl
 21269
 21270     IF  MISMATCH-LINE-COUNT GREATER THAN +56
 21271         ADD +1                  TO  MISMATCH-PAGE-NUMBER
 21272         MOVE MISMATCH-PAGE-NUMBER
 21273                                 TO  TR-PG
 21274         MOVE MISMATCH-HEADING-1 TO  MISMATCH-RPT
 21275         MOVE MR-CTL             TO  X
 21276         MOVE X TO LCP-ASA
 21277         PERFORM LCP-WRITE-POS-MISMATCH-RPT
 21278             THRU LCP-WRITE-END-MISMATCH-RPT
 21279         MOVE TR-HD-2            TO  MISMATCH-RPT
 21280         MOVE MR-CTL             TO  X
 21281         MOVE X TO LCP-ASA
 21282         PERFORM LCP-WRITE-POS-MISMATCH-RPT
 21283             THRU LCP-WRITE-END-MISMATCH-RPT
 21284         MOVE TR-HD-3            TO  MISMATCH-RPT
 21285         MOVE MR-CTL             TO  X
 21286         MOVE X TO LCP-ASA
 21287         PERFORM LCP-WRITE-POS-MISMATCH-RPT
 21288             THRU LCP-WRITE-END-MISMATCH-RPT
 21289         MOVE MISMATCH-HEADING-2 TO  MISMATCH-RPT
 21290         MOVE MR-CTL             TO  X
 21291         MOVE X TO LCP-ASA
 21292         PERFORM LCP-WRITE-POS-MISMATCH-RPT
 21293             THRU LCP-WRITE-END-MISMATCH-RPT
 21294         MOVE +6                 TO  MISMATCH-LINE-COUNT.
 21295
 21296     MOVE DUPE-ENTRY (SUB3)             TO  DTL-MATCH-CONTROL.
 21297
 21298     MOVE MISMATCH-DETAIL               TO  MISMATCH-RPT.
 21299     MOVE MR-CTL                        TO  X.
 21300     ADD +2                             TO  MISMATCH-LINE-COUNT.
 21301
 21302     MOVE X TO LCP-ASA
 21303     PERFORM LCP-WRITE-POS-MISMATCH-RPT
 21304         THRU LCP-WRITE-END-MISMATCH-RPT.
 21305
 21306     MOVE  DUPE-LF-PRM (SUB3)           TO  MD2-LF-PREM.
 21307     MOVE  DUPE-AH-PRM (SUB3)           TO  MD2-LF-ALT-PREM.
 21308
 21309     ADD  DUPE-LF-PRM (SUB3)            TO  W-MM-LF-PRM.
 21310     ADD  DUPE-AH-PRM (SUB3)            TO  W-MM-AH-PRM.
 21311
 21312     MOVE DUPE-STATUS (SUB3)            TO  MD2-AH-PREM-DESC.
 21313     IF  DUPE-STATUS (SUB3)  =  '2'
 21314         MOVE  'POLICY IS PENDING '     TO  MD2-AH-PREM-DESC.
 21315     IF  DUPE-STATUS (SUB3)  =  '5'
 21316         MOVE  'POLICY IS REISSUE '     TO  MD2-AH-PREM-DESC.
 21317     IF  DUPE-STATUS (SUB3)  =  'M'
 21318         MOVE  'POLICY IS MONTHLY '     TO  MD2-AH-PREM-DESC.
 21319     IF  DUPE-STATUS (SUB3)  =  '9'
 21320         MOVE  'POLICY REIN ONLY  '     TO  MD2-AH-PREM-DESC.
 21321     IF  DUPE-STATUS (SUB3)  =  'D'
 21322         MOVE  'POLICY IS DECLINED'     TO  MD2-AH-PREM-DESC.
 21323     IF  DUPE-STATUS (SUB3)  =  'V'
 21324         MOVE  'POLICY IS VOIDED  '     TO  MD2-AH-PREM-DESC.
 21325     IF  DUPE-STATUS (SUB3)  =  'P'
 21326         MOVE  'POLICY PREM ACCTNG'     TO  MD2-AH-PREM-DESC.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 416
* ECS010T1.cbl
 21327
 21328     MOVE MISMATCH-DETAIL-2             TO  MISMATCH-RPT.
 21329     MOVE MR-CTL                        TO  X.
 21330     ADD +1                             TO  MISMATCH-LINE-COUNT.
 21331
 21332     MOVE X TO LCP-ASA
 21333     PERFORM LCP-WRITE-POS-MISMATCH-RPT
 21334         THRU LCP-WRITE-END-MISMATCH-RPT.
 21335
 21336     IF SUB3 LESS THAN DUP-CNT
 21337         ADD +1 TO SUB3
 21338         GO TO 9965-PRT-DUPES.
 21339
 21340 9969-CHECK-MISMATCHED-TOTS.
 21341
 21342     IF W-MM-LF-PRM = ZEROS  AND
 21343        W-MM-AH-PRM = ZEROS  AND
 21344        W-MM-LF-RFD = ZEROS  AND
 21345        W-MM-AH-RFD = ZEROS  AND
 21346        W-MM-LF-CLM = ZEROS  AND
 21347        W-MM-AH-CLM = ZEROS
 21348         GO TO 9970-FIN-TOTS.
 21349
 21350     MOVE SPACES                        TO  MISMATCH-RPT.
 21351     MOVE '0'                           TO  MR-CTL  X.
 21352     MOVE X TO LCP-ASA
 21353     PERFORM LCP-WRITE-POS-MISMATCH-RPT
 21354         THRU LCP-WRITE-END-MISMATCH-RPT.
 21355
 21356     MOVE 'TOT LF PREMS  = '            TO  MD2-LF-PREM-DESC.
 21357     MOVE 'TOT AH PREMS  = '            TO  MD2-LF-ALT-PREM-DESC.
 21358     MOVE ' TOTAL PREMIUMS = '          TO  MD2-AH-PREM-DESC.
 21359
 21360     MOVE W-MM-LF-PRM                   TO MD2-LF-PREM.
 21361     MOVE W-MM-AH-PRM                   TO MD2-LF-ALT-PREM.
 21362     COMPUTE MD2-AH-PREM = W-MM-LF-PRM + W-MM-AH-PRM.
 21363
 21364     MOVE MISMATCH-DETAIL-2             TO  MISMATCH-RPT.
 21365     MOVE '0'                           TO  MR-CTL  X.
 21366     MOVE X TO LCP-ASA
 21367     PERFORM LCP-WRITE-POS-MISMATCH-RPT
 21368         THRU LCP-WRITE-END-MISMATCH-RPT.
 21369
 21370     MOVE 'TOT LF RFNDS  = '            TO  MD2-LF-PREM-DESC.
 21371     MOVE 'TOT AH RFNDS  = '            TO  MD2-LF-ALT-PREM-DESC.
 21372     MOVE ' TOTAL REFUNDS  = '          TO  MD2-AH-PREM-DESC.
 21373
 21374     MOVE W-MM-LF-RFD                   TO MD2-LF-PREM.
 21375     MOVE W-MM-AH-RFD                   TO MD2-LF-ALT-PREM.
 21376     COMPUTE MD2-AH-PREM = W-MM-LF-RFD + W-MM-AH-RFD.
 21377
 21378     MOVE MISMATCH-DETAIL-2             TO  MISMATCH-RPT.
 21379     MOVE '0'                           TO  MR-CTL  X.
 21380     MOVE X TO LCP-ASA
 21381     PERFORM LCP-WRITE-POS-MISMATCH-RPT
 21382         THRU LCP-WRITE-END-MISMATCH-RPT.
 21383
 21384     MOVE 'TOT LF CLAIMS = '            TO  MD2-LF-PREM-DESC.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 417
* ECS010T1.cbl
 21385     MOVE 'TOT AH CLAIMS = '            TO  MD2-LF-ALT-PREM-DESC.
 21386     MOVE ' TOTAL CLAIMS   = '          TO  MD2-AH-PREM-DESC.
 21387
 21388     MOVE W-MM-LF-CLM                   TO MD2-LF-PREM.
 21389     MOVE W-MM-AH-CLM                   TO MD2-LF-ALT-PREM.
 21390     COMPUTE MD2-AH-PREM = W-MM-LF-CLM + W-MM-AH-CLM.
 21391
 21392     MOVE MISMATCH-DETAIL-2             TO  MISMATCH-RPT.
 21393     MOVE '0'                           TO  MR-CTL  X.
 21394     MOVE X TO LCP-ASA
 21395     PERFORM LCP-WRITE-POS-MISMATCH-RPT
 21396         THRU LCP-WRITE-END-MISMATCH-RPT.
 21397
 21398 9970-FIN-TOTS.
 21399
 21400     MOVE CMOT-CNT                TO TTL-PT-CNT.
 21401
 21402     IF ME-DO-UPDATE
 21403         MOVE CMOT-CNT           TO ME-010-CERT-OUT.
 21404
 21405     MOVE 'OUTPUT CERTIFICATE MASTER RECORDS' TO TTL-HD-DS.
 21406     MOVE TR-TTL-HD               TO PRT.
 21407     PERFORM 8800-PRINT-ROUTINE.
 21408
 21409     MOVE CMOT-CNT                TO WS-ME50-BAL-AMT-LOW.
 21410     MOVE CMOT-CNT                TO WS-ME50-BAL-AMT-HIGH.
 21411     MOVE WS-BAL50-DESCRIPTION    TO WS-ME50-BAL-DESCRIP.
 21412     WRITE ME50-ECS010-BALANCE-REC FROM WS-ME50-BALANCE-REC.
 21413
 21414     MOVE DE-CNT                  TO TTL-PT-CNT.
 21415     MOVE 'DETAIL EXTRACT RECORDS' TO TTL-HD-DS.
 21416     MOVE TR-TTL-HD               TO PRT.
 21417     PERFORM 8800-PRINT-ROUTINE.
 21418
 21419     MOVE EP-CNT                  TO TTL-PT-CNT.
 21420     MOVE 'SUMMARY EXTRACTS RECORDS' TO TTL-HD-DS.
 21421     MOVE TR-TTL-HD               TO PRT.
 21422     PERFORM 8800-PRINT-ROUTINE.
 21423     PERFORM 8800-PRINT-ROUTINE.
 21424
 21425     MOVE ERACCTT-READS           TO TTL-PT-CNT.
 21426     MOVE 'VSAM ACCOUNT MASTER FILE READS' TO TTL-HD-DS.
 21427     MOVE TR-TTL-HD               TO PRT.
 21428     PERFORM 8800-PRINT-ROUTINE.
 21429
 21430     MOVE ERRTBL-READS            TO TTL-PT-CNT.
 21431     MOVE 'VSAM REINSURANCE TABLE FILE READS' TO TTL-HD-DS.
 21432     MOVE TR-TTL-HD               TO PRT.
 21433     PERFORM 8800-PRINT-ROUTINE.
 21434
 21435     MOVE ERCTBL-READS            TO TTL-PT-CNT.
 21436     MOVE 'VSAM COMMISSION TABLE FILE READS' TO TTL-HD-DS.
 21437     MOVE TR-TTL-HD               TO PRT.
 21438     PERFORM 8800-PRINT-ROUTINE.
 21439
 21440     IF  DTE-OPT-RESERVE-METHOD-UNAUTH
 21441         GO TO 9990-FINAL-CLOSE.
 21442
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 418
* ECS010T1.cbl
 21443**** MOST OF THE LINES WRITTEN BELOW ARE USED TO VERIFY
 21444**** REPORT TOTALS, ETC, THAT CANNOT BE VERIFIED ANY OTHER
 21445**** WAY.  MOST OF THESE FIELDS WILL BE DELETED WHEN ALL
 21446**** PILOT COMPANIES HAVE BEEN SUCCESSFULLY PROCESSED.
 21447
 21448     MOVE W-POLICY-ACTIVE-CTR     TO TTL-PT-CNT.
 21449     MOVE 'ACTIVE POLICIES'       TO TTL-HD-DS.
 21450     MOVE TR-TTL-HD               TO PRT.
 21451     PERFORM 8800-PRINT-ROUTINE.
 21452
 21453     MOVE W-POLICY-INACTIVE-CTR   TO TTL-PT-CNT.
 21454     MOVE 'INACTIVE POLICIES'     TO TTL-HD-DS.
 21455     MOVE TR-TTL-HD               TO PRT.
 21456     PERFORM 8800-PRINT-ROUTINE.
 21457
 21458     MOVE W-POLICY-REISSUE-CTR    TO TTL-PT-CNT.
 21459     MOVE 'REISSUE POLICIES'      TO TTL-HD-DS.
 21460     MOVE TR-TTL-HD               TO PRT.
 21461     PERFORM 8800-PRINT-ROUTINE.
 21462
 21463     MOVE W-POLICY-REIN-CTR       TO TTL-PT-CNT.
 21464     MOVE 'REINSURANCE ONLY POLICIES' TO TTL-HD-DS.
 21465     MOVE TR-TTL-HD               TO PRT.
 21466     PERFORM 8800-PRINT-ROUTINE.
 21467
 21468     MOVE W-POL-ISSUES            TO TTL-PT-CNT.
 21469     MOVE 'ISSUE TRANSACTIONS'    TO TTL-HD-DS.
 21470     MOVE TR-TTL-HD               TO PRT.
 21471     PERFORM 8800-PRINT-ROUTINE.
 21472
 21473     MOVE W-AH-ISSUES             TO TTL-PT-CNT.
 21474     MOVE 'AH ISSUE TRANSACTIONS' TO TTL-HD-DS.
 21475     MOVE TR-TTL-HD               TO PRT.
 21476     PERFORM 8800-PRINT-ROUTINE.
 21477
 21478     MOVE W-LF-ISSUES             TO TTL-PT-CNT.
 21479     MOVE 'LF ISSUE TRANSACTIONS' TO TTL-HD-DS.
 21480     MOVE TR-TTL-HD               TO PRT.
 21481     PERFORM 8800-PRINT-ROUTINE.
 21482
 21483     MOVE W-PENDING-CLMS          TO TTL-PT-CNT.
 21484     MOVE 'CLAIM TRANSACTIONS'    TO TTL-HD-DS.
 21485     MOVE TR-TTL-HD               TO PRT.
 21486     PERFORM 8800-PRINT-ROUTINE.
 21487
 21488     MOVE W-AH-CLAIMS             TO TTL-PT-CNT.
 21489     MOVE 'AH CLAIMS TRANSACTIONS' TO TTL-HD-DS.
 21490     MOVE TR-TTL-HD               TO PRT.
 21491     PERFORM 8800-PRINT-ROUTINE.
 21492
 21493     MOVE W-LF-CLAIMS             TO TTL-PT-CNT.
 21494     MOVE 'LF CLAIMS TRANSACTIONS' TO TTL-HD-DS.
 21495     MOVE TR-TTL-HD               TO PRT.
 21496     PERFORM 8800-PRINT-ROUTINE.
 21497
 21498     MOVE W-AH-RESERVES           TO TTL-PT-CNT.
 21499     MOVE 'AH RESERVES TRANSACTIONS' TO TTL-HD-DS.
 21500     MOVE TR-TTL-HD               TO PRT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 419
* ECS010T1.cbl
 21501     PERFORM 8800-PRINT-ROUTINE.
 21502
 21503     MOVE W-LF-RESERVES           TO TTL-PT-CNT.
 21504     MOVE 'LF RESERVES TRANSACTIONS' TO TTL-HD-DS.
 21505     MOVE TR-TTL-HD               TO PRT.
 21506     PERFORM 8800-PRINT-ROUTINE.
 21507
 21508     MOVE W-AH-ACTIVE             TO TTL-PT-CNT.
 21509     MOVE 'AH RECORDS ACTIVE '    TO TTL-HD-DS.
 21510     MOVE TR-TTL-HD               TO PRT.
 21511     PERFORM 8800-PRINT-ROUTINE.
 21512
 21513     MOVE W-AH-INACTIVE           TO TTL-PT-CNT.
 21514     MOVE 'AH RECORDS INACTIVE'   TO TTL-HD-DS.
 21515     MOVE TR-TTL-HD               TO PRT.
 21516     PERFORM 8800-PRINT-ROUTINE.
 21517
 21518     MOVE W-AH-REISSUE            TO TTL-PT-CNT.
 21519     MOVE 'AH REISSUE REJECTS'    TO TTL-HD-DS.
 21520     MOVE TR-TTL-HD               TO PRT.
 21521     PERFORM 8800-PRINT-ROUTINE.
 21522
 21523     MOVE W-AH-REIN               TO TTL-PT-CNT.
 21524     MOVE 'AH REIN ONLY      '    TO TTL-HD-DS.
 21525     MOVE TR-TTL-HD               TO PRT.
 21526     PERFORM 8800-PRINT-ROUTINE.
 21527
 21528     MOVE W-AH-CALC-B             TO TTL-PT-CNT.
 21529     MOVE 'AH CALC B REJECTS'     TO TTL-HD-DS.
 21530     MOVE TR-TTL-HD               TO PRT.
 21531     PERFORM 8800-PRINT-ROUTINE.
 21532
 21533     MOVE W-AHTYP-99              TO TTL-PT-CNT.
 21534     MOVE 'AH TYPE CHANGED TO 99' TO TTL-HD-DS.
 21535     MOVE TR-TTL-HD               TO PRT.
 21536     PERFORM 8800-PRINT-ROUTINE.
 21537
 21538     MOVE W-ORGTRM-0-AH           TO TTL-PT-CNT.
 21539     MOVE 'AH ORIGINAL TERM = 0 ' TO TTL-HD-DS.
 21540     MOVE TR-TTL-HD               TO PRT.
 21541     PERFORM 8800-PRINT-ROUTINE.
 21542
 21543     MOVE W-RET-CODE-AH           TO TTL-PT-CNT.
 21544     MOVE 'AH RET CODE TERM = 0 ' TO TTL-HD-DS.
 21545     MOVE TR-TTL-HD               TO PRT.
 21546     PERFORM 8800-PRINT-ROUTINE.
 21547
 21548     MOVE W-AH-REMTERM-0          TO TTL-PT-CNT.
 21549     MOVE 'AH REMAINING TERM = 0' TO TTL-HD-DS.
 21550     MOVE TR-TTL-HD               TO PRT.
 21551     PERFORM 8800-PRINT-ROUTINE.
 21552
 21553     MOVE W-AH-DATA-USED          TO TTL-PT-CNT.
 21554     MOVE 'AH RECORDS ACCEPTED DURING PROCESSING' TO TTL-HD-DS.
 21555     MOVE TR-TTL-HD               TO PRT.
 21556     PERFORM 8800-PRINT-ROUTINE.
 21557
 21558     MOVE W-LF-ACTIVE             TO TTL-PT-CNT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 420
* ECS010T1.cbl
 21559     MOVE 'LF RECORDS ACTIVE '    TO TTL-HD-DS.
 21560     MOVE TR-TTL-HD               TO PRT.
 21561     PERFORM 8800-PRINT-ROUTINE.
 21562
 21563     MOVE W-LF-INACTIVE           TO TTL-PT-CNT.
 21564     MOVE 'LF RECORDS INACTIVE'   TO TTL-HD-DS.
 21565     MOVE TR-TTL-HD               TO PRT.
 21566     PERFORM 8800-PRINT-ROUTINE.
 21567
 21568     MOVE W-LF-BALLOON            TO TTL-PT-CNT.
 21569     MOVE 'LF BALLOON REJECTS'    TO TTL-HD-DS.
 21570     MOVE TR-TTL-HD               TO PRT.
 21571     PERFORM 8800-PRINT-ROUTINE.
 21572
 21573     MOVE W-LF-REISSUE            TO TTL-PT-CNT.
 21574     MOVE 'LF REISSUE REJECTS'    TO TTL-HD-DS.
 21575     MOVE TR-TTL-HD               TO PRT.
 21576     PERFORM 8800-PRINT-ROUTINE.
 21577
 21578     MOVE W-LF-REIN               TO TTL-PT-CNT.
 21579     MOVE 'LF REIN ONLY      '    TO TTL-HD-DS.
 21580     MOVE TR-TTL-HD               TO PRT.
 21581     PERFORM 8800-PRINT-ROUTINE.
 21582
 21583     MOVE W-LF-CALC-B             TO TTL-PT-CNT.
 21584     MOVE 'LF CALC B REJECTS'     TO TTL-HD-DS.
 21585     MOVE TR-TTL-HD               TO PRT.
 21586     PERFORM 8800-PRINT-ROUTINE.
 21587
 21588     MOVE W-ORGTRM-0-LF           TO TTL-PT-CNT.
 21589     MOVE 'LF ORIGINAL TERM = 0 ' TO TTL-HD-DS.
 21590     MOVE TR-TTL-HD               TO PRT.
 21591     PERFORM 8800-PRINT-ROUTINE.
 21592
 21593     MOVE W-RET-CODE-LF           TO TTL-PT-CNT.
 21594     MOVE 'LF RET CODE TERM = 0 ' TO TTL-HD-DS.
 21595     MOVE TR-TTL-HD               TO PRT.
 21596     PERFORM 8800-PRINT-ROUTINE.
 21597
 21598     MOVE W-LF-REMTERM-0          TO TTL-PT-CNT.
 21599     MOVE 'LF REMTERM = 0 REJECTS' TO TTL-HD-DS.
 21600     MOVE TR-TTL-HD               TO PRT.
 21601     PERFORM 8800-PRINT-ROUTINE.
 21602
 21603     MOVE W-LF-REMAMT-0           TO TTL-PT-CNT.
 21604     MOVE 'LF REMAMT = 0 REJECTS' TO TTL-HD-DS.
 21605     MOVE TR-TTL-HD               TO PRT.
 21606     PERFORM 8800-PRINT-ROUTINE.
 21607
 21608     MOVE W-LFTYP-99              TO TTL-PT-CNT.
 21609     MOVE 'LF TYPE CHANGED TO 99' TO TTL-HD-DS.
 21610     MOVE TR-TTL-HD               TO PRT.
 21611     PERFORM 8800-PRINT-ROUTINE.
 21612
 21613     MOVE W-LF-DATA-USED          TO TTL-PT-CNT.
 21614     MOVE 'LF RECORDS ACCEPTED DURING PROCESSING' TO TTL-HD-DS.
 21615     MOVE TR-TTL-HD               TO PRT.
 21616     PERFORM 8800-PRINT-ROUTINE.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 421
* ECS010T1.cbl
 21617
 21618     MOVE W-EPEC-EP-IN            TO TTL-PT-CNT.
 21619     MOVE 'AH EARNED PREMIUM LAST 90 DAYS - DET ' TO TTL-HD-DS.
 21620     MOVE TR-TTL-HD               TO PRT.
 21621     PERFORM 8800-PRINT-ROUTINE.
 21622
 21623     MOVE W-EPEC-EP               TO TTL-PT-CNT.
 21624     MOVE 'AH EARNED PREMIUM LAST 90 DAYS       ' TO TTL-HD-DS.
 21625     MOVE TR-TTL-HD               TO PRT.
 21626     PERFORM 8800-PRINT-ROUTINE.
 21627
 21628     MOVE W-EPEC-EP-2             TO TTL-PT-CNT.
 21629     MOVE 'AH EARNED PREMIUM 90 DAYS AGO        ' TO TTL-HD-DS.
 21630     MOVE TR-TTL-HD               TO PRT.
 21631     PERFORM 8800-PRINT-ROUTINE.
 21632
 21633     MOVE W-EP-LESS-THAN-0        TO TTL-PT-CNT.
 21634     MOVE 'AH RECORDS WITH 90 DAY EP < +0       ' TO TTL-HD-DS.
 21635     MOVE TR-TTL-HD               TO PRT.
 21636     PERFORM 8800-PRINT-ROUTINE.
 21637
 21638     MOVE W-EPEC-EP-1             TO TTL-PT-CNT.
 21639     MOVE 'AH EARNED PREMIUM TODAY              ' TO TTL-HD-DS.
 21640     MOVE TR-TTL-HD               TO PRT.
 21641     PERFORM 8800-PRINT-ROUTINE.
 21642
 21643     MOVE W-AH-CLAIM-CTR          TO TTL-PT-CNT.
 21644     MOVE 'AH COVERAGES WITH QUALIFIED CLAIMS'
 21645                                  TO TTL-HD-DS.
 21646     MOVE TR-TTL-HD               TO PRT.
 21647     PERFORM 8800-PRINT-ROUTINE.
 21648
 21649     MOVE W-AH-CLAIM-EP           TO TTL-PT-CNT.
 21650     MOVE 'AH EARNED PREM WITH QUALIFIED CLAIMS'
 21651                                  TO TTL-HD-DS.
 21652     MOVE TR-TTL-HD               TO PRT.
 21653     PERFORM 8800-PRINT-ROUTINE.
 21654
 21655     MOVE W-CLAIMS-MADE-PAID-IN   TO TTL-PT-CNT.
 21656     MOVE 'AH CLAIMS MADE AND PAID LAST 90 DAYS- DET'
 21657                                  TO TTL-HD-DS.
 21658     MOVE TR-TTL-HD               TO PRT.
 21659     PERFORM 8800-PRINT-ROUTINE.
 21660
 21661     MOVE W-CLAIMS-MADE-PAID      TO TTL-PT-CNT.
 21662     MOVE 'AH CLAIMS MADE AND PAID LAST 90 DAYS'
 21663                                  TO TTL-HD-DS.
 21664     MOVE TR-TTL-HD               TO PRT.
 21665     PERFORM 8800-PRINT-ROUTINE.
 21666
 21667     MOVE W-CLM-EXCEPT-CNT        TO TTL-PT-CNT.
 21668     MOVE 'AH CLAIMS CALCD. USING ITD AMOUNT'
 21669                                  TO TTL-HD-DS.
 21670     MOVE TR-TTL-HD               TO PRT.
 21671     PERFORM 8800-PRINT-ROUTINE.
 21672
 21673     MOVE W-CLM-EXCEPT-AMT        TO TTL-PT-CNT.
 21674     MOVE 'AH CLAIMS AMT USING ITD AMOUNT'
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 422
* ECS010T1.cbl
 21675                                  TO TTL-HD-DS.
 21676     MOVE TR-TTL-HD               TO PRT.
 21677     PERFORM 8800-PRINT-ROUTINE.
 21678
 21679     MOVE W-AH-IBNR-1             TO TTL-PT-CNT.
 21680     MOVE 'A&H IBNR-1'            TO TTL-HD-DS.
 21681     MOVE TR-TTL-HD               TO PRT.
 21682     PERFORM 8800-PRINT-ROUTINE.
 21683
 21684     MOVE W-AH-IBNR-2             TO TTL-PT-CNT.
 21685     MOVE 'A&H IBNR-2'            TO TTL-HD-DS.
 21686     MOVE TR-TTL-HD               TO PRT.
 21687     PERFORM 8800-PRINT-ROUTINE.
 21688
 21689     MOVE W-LIFE-IBNR-IN          TO TTL-PT-CNT.
 21690     MOVE 'LIFE IBNR - DETAIL'    TO TTL-HD-DS.
 21691     MOVE TR-TTL-HD               TO PRT.
 21692     PERFORM 8800-PRINT-ROUTINE.
 21693
 21694     MOVE W-LIFE-IBNR             TO TTL-PT-CNT.
 21695     MOVE 'LIFE IBNR'             TO TTL-HD-DS.
 21696     MOVE TR-TTL-HD               TO PRT.
 21697     PERFORM 8800-PRINT-ROUTINE.
 21698
 21699     MOVE W-LIFE-REMAINING-AMT    TO TTL-PT-CNT.
 21700     MOVE 'LIFE REMAINING-AMT '   TO TTL-HD-DS.
 21701     MOVE TR-TTL-HD               TO PRT.
 21702     PERFORM 8800-PRINT-ROUTINE.
 21703
 21704     MOVE W-01-REMAMT             TO TTL-PT-CNT.
 21705     MOVE '01 REMAINING-AMT '     TO TTL-HD-DS.
 21706     MOVE TR-TTL-HD               TO PRT.
 21707     PERFORM 8800-PRINT-ROUTINE.
 21708
 21709     MOVE W-01-DATA-USED          TO TTL-PT-CNT.
 21710     MOVE '01 CERT COUNT    '     TO TTL-HD-DS.
 21711     MOVE TR-TTL-HD               TO PRT.
 21712     PERFORM 8800-PRINT-ROUTINE.
 21713
 21714     MOVE W-02-REMAMT             TO TTL-PT-CNT.
 21715     MOVE '02 REMAINING-AMT '     TO TTL-HD-DS.
 21716     MOVE TR-TTL-HD               TO PRT.
 21717     PERFORM 8800-PRINT-ROUTINE.
 21718
 21719     MOVE W-02-DATA-USED          TO TTL-PT-CNT.
 21720     MOVE '02 CERT COUNT    '     TO TTL-HD-DS.
 21721     MOVE TR-TTL-HD               TO PRT.
 21722     PERFORM 8800-PRINT-ROUTINE.
 21723
 21724     MOVE W-03-REMAMT             TO TTL-PT-CNT.
 21725     MOVE '03 REMAINING-AMT '     TO TTL-HD-DS.
 21726     MOVE TR-TTL-HD               TO PRT.
 21727     PERFORM 8800-PRINT-ROUTINE.
 21728
 21729     MOVE W-03-DATA-USED          TO TTL-PT-CNT.
 21730     MOVE '03 CERT COUNT    '     TO TTL-HD-DS.
 21731     MOVE TR-TTL-HD               TO PRT.
 21732     PERFORM 8800-PRINT-ROUTINE.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 423
* ECS010T1.cbl
 21733
 21734     MOVE W-04-REMAMT             TO TTL-PT-CNT.
 21735     MOVE '04 REMAINING-AMT '     TO TTL-HD-DS.
 21736     MOVE TR-TTL-HD               TO PRT.
 21737     PERFORM 8800-PRINT-ROUTINE.
 21738
 21739     MOVE W-04-DATA-USED          TO TTL-PT-CNT.
 21740     MOVE '04 CERT COUNT    '     TO TTL-HD-DS.
 21741     MOVE TR-TTL-HD               TO PRT.
 21742     PERFORM 8800-PRINT-ROUTINE.
 21743
 21744     MOVE W-05-REMAMT             TO TTL-PT-CNT.
 21745     MOVE '05 REMAINING-AMT '     TO TTL-HD-DS.
 21746     MOVE TR-TTL-HD               TO PRT.
 21747     PERFORM 8800-PRINT-ROUTINE.
 21748
 21749     MOVE W-05-DATA-USED          TO TTL-PT-CNT.
 21750     MOVE '05 CERT COUNT    '     TO TTL-HD-DS.
 21751     MOVE TR-TTL-HD               TO PRT.
 21752     PERFORM 8800-PRINT-ROUTINE.
 21753
 21754     MOVE W-06-REMAMT             TO TTL-PT-CNT.
 21755     MOVE '06 REMAINING-AMT '     TO TTL-HD-DS.
 21756     MOVE TR-TTL-HD               TO PRT.
 21757     PERFORM 8800-PRINT-ROUTINE.
 21758
 21759     MOVE W-06-DATA-USED          TO TTL-PT-CNT.
 21760     MOVE '06 CERT COUNT    '     TO TTL-HD-DS.
 21761     MOVE TR-TTL-HD               TO PRT.
 21762     PERFORM 8800-PRINT-ROUTINE.
 21763
 21764     MOVE W-30-REMAMT             TO TTL-PT-CNT.
 21765     MOVE '30 REMAINING-AMT '     TO TTL-HD-DS.
 21766     MOVE TR-TTL-HD               TO PRT.
 21767     PERFORM 8800-PRINT-ROUTINE.
 21768
 21769     MOVE W-30-DATA-USED          TO TTL-PT-CNT.
 21770     MOVE '30 CERT COUNT    '     TO TTL-HD-DS.
 21771     MOVE TR-TTL-HD               TO PRT.
 21772     PERFORM 8800-PRINT-ROUTINE.
 21773
 21774     MOVE W-31-REMAMT             TO TTL-PT-CNT.
 21775     MOVE '31 REMAINING-AMT '     TO TTL-HD-DS.
 21776     MOVE TR-TTL-HD               TO PRT.
 21777     PERFORM 8800-PRINT-ROUTINE.
 21778
 21779     MOVE W-31-DATA-USED          TO TTL-PT-CNT.
 21780     MOVE '31 CERT COUNT    '     TO TTL-HD-DS.
 21781     MOVE TR-TTL-HD               TO PRT.
 21782     PERFORM 8800-PRINT-ROUTINE.
 21783
 21784     MOVE W-XX-REMAMT             TO TTL-PT-CNT.
 21785     MOVE 'XX REMAINING-AMT '     TO TTL-HD-DS.
 21786     MOVE TR-TTL-HD               TO PRT.
 21787     PERFORM 8800-PRINT-ROUTINE.
 21788
 21789     MOVE W-XX-DATA-USED          TO TTL-PT-CNT.
 21790     MOVE 'XX CERT COUNT    '     TO TTL-HD-DS.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 424
* ECS010T1.cbl
 21791     MOVE TR-TTL-HD               TO PRT.
 21792     PERFORM 8800-PRINT-ROUTINE.
 21793
 21794     MOVE W-1-EP                  TO TTL-PT-CNT.
 21795     MOVE 'TYPE 1 EP        '     TO TTL-HD-DS.
 21796     MOVE TR-TTL-HD               TO PRT.
 21797     PERFORM 8800-PRINT-ROUTINE.
 21798
 21799     MOVE W-P-EP                  TO TTL-PT-CNT.
 21800     MOVE 'TYPE P EP        '     TO TTL-HD-DS.
 21801     MOVE TR-TTL-HD               TO PRT.
 21802     PERFORM 8800-PRINT-ROUTINE.
 21803
 21804     MOVE W-M-EP                  TO TTL-PT-CNT.
 21805     MOVE 'TYPE M EP        '     TO TTL-HD-DS.
 21806     MOVE TR-TTL-HD               TO PRT.
 21807     PERFORM 8800-PRINT-ROUTINE.
 21808
 21809     MOVE W-R-EP                  TO TTL-PT-CNT.
 21810     MOVE 'TYPE R EP        '     TO TTL-HD-DS.
 21811     MOVE TR-TTL-HD               TO PRT.
 21812     PERFORM 8800-PRINT-ROUTINE.
 21813
 21814     MOVE W-WY-EP                 TO TTL-PT-CNT.
 21815     MOVE 'EP FOR STATE WY  '     TO TTL-HD-DS.
 21816     MOVE TR-TTL-HD               TO PRT.
 21817     PERFORM 8800-PRINT-ROUTINE.
 21818
 21819     MOVE W-VA-EP                 TO TTL-PT-CNT.
 21820     MOVE 'EP FOR STATE VA  '     TO TTL-HD-DS.
 21821     MOVE TR-TTL-HD               TO PRT.
 21822     PERFORM 8800-PRINT-ROUTINE.
 21823
 21824     MOVE W-OTHERS-COUNT          TO TTL-PT-CNT.
 21825     MOVE 'AH COUNT OF OTHERS'    TO TTL-HD-DS.
 21826     MOVE TR-TTL-HD               TO PRT.
 21827     PERFORM 8800-PRINT-ROUTINE.
 21828
 21829     MOVE W-RTRM-0-CLMAMT         TO TTL-PT-CNT.
 21830     MOVE 'CLM AMT OF THOSE CERTS WITH RTRM=0'    TO TTL-HD-DS.
 21831     MOVE TR-TTL-HD               TO PRT.
 21832     PERFORM 8800-PRINT-ROUTINE.
 21833
 21834     MOVE W-RTRM-EP-1             TO TTL-PT-CNT.
 21835     MOVE 'EP1 OF THOSE CERTS WITH RTRM=0'    TO TTL-HD-DS.
 21836     MOVE TR-TTL-HD               TO PRT.
 21837     PERFORM 8800-PRINT-ROUTINE.
 21838
 21839     MOVE W-RTRM-EP-2             TO TTL-PT-CNT.
 21840     MOVE 'EP2 OF THOSE CERTS WITH RTRM=0'    TO TTL-HD-DS.
 21841     MOVE TR-TTL-HD               TO PRT.
 21842     PERFORM 8800-PRINT-ROUTINE.
 21843
 21844     MOVE W-RTRM-EP               TO TTL-PT-CNT.
 21845     MOVE 'EP OF THOSE CERTS WITH RTRM=0'    TO TTL-HD-DS.
 21846     MOVE TR-TTL-HD               TO PRT.
 21847     PERFORM 8800-PRINT-ROUTINE.
 21848
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 425
* ECS010T1.cbl
 21849     MOVE W-AH-IBNR-1             TO TTL-PT-CNT.
 21850     MOVE 'IBNR1 FROM EQUATION 1' TO TTL-HD-DS.
 21851     MOVE TR-TTL-HD               TO PRT.
 21852     PERFORM 8800-PRINT-ROUTINE.
 21853
 21854     MOVE W-AH-IBNR-1-CNT         TO TTL-PT-CNT.
 21855     MOVE 'REC CNT FROM EQUATION 1' TO TTL-HD-DS.
 21856     MOVE TR-TTL-HD               TO PRT.
 21857     PERFORM 8800-PRINT-ROUTINE.
 21858
 21859     MOVE W-AH-IBNR-2             TO TTL-PT-CNT.
 21860     MOVE 'IBNR2 FROM EQUATION 2' TO TTL-HD-DS.
 21861     MOVE TR-TTL-HD               TO PRT.
 21862     PERFORM 8800-PRINT-ROUTINE.
 21863
 21864     MOVE W-AH-IBNR-2-CNT         TO TTL-PT-CNT.
 21865     MOVE 'REC CNT FROM EQUATION 2' TO TTL-HD-DS.
 21866     MOVE TR-TTL-HD               TO PRT.
 21867     PERFORM 8800-PRINT-ROUTINE.
 21868
 21869 9990-FINAL-CLOSE.
*21870                             COPY ELCPRTC.
 21871******************************************************************04/15/98
 21872*                                                                *ELCPRTC
 21873*                                                                *ELCPRTC
 21874*                            ELCPRTC.                            *   LV003
 21875*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
 21876*                            VMOD=2.002                          *   CL**2
 21877*       CLOSE FICH FILE IF OPEN                                  *ELCPRTC
 21878*                                                                *ELCPRTC
 21879* NOTE- USE ELCPRTCX IF USING ELCPRT2X (ONLINE REPORT SAVE)      *   CL**2
 21880******************************************************************ELCPRTC
 21881                                                                  ELCPRTC
 21882      IF FICH-OPEN NOT = SPACE                                    ELCPRTC
 21883          CLOSE FICH.                                             ELCPRTC
 21884                                                                  ELCPRTC
 21885******************************************************************ELCPRTC
 21886
 21887     IF DTE-CLIENT = 'DMD'
 21888         CLOSE ERRESC-IN.
 21889
 21890     PERFORM 8600-DISPLAY-HD   THRU  8600-HD-EXIT.
 21891
 21892     DISPLAY ' '.
 21893     DISPLAY '* * * * * * * * * * * * * * * * * *'.
 21894     DISPLAY ' DISPLAY ERROR COUNT = '  ERROR-COUNT.
 21895     DISPLAY '* * * * * * * * * * * * * * * * * *'.
 21896     DISPLAY ' '.
 21897
 21898     MOVE    ' DISPLAY ERROR COUNT = '
 21899       TO  DIS-LINE-REASON.
 21900     MOVE  ERROR-COUNT
 21901       TO  DIS-LINE-REC.
 21902         PERFORM 8600-DISPLAY-PRT  THRU  8600-DISPLAY-EXIT.
 21903
 21904     CLOSE ERACCTT-IN  CERT-MASTER-IN  PRINT-COPY  MISMATCH-REPORT
 21905           DISPLAY-PRT
 21906           ME-ECS010-BALANCE
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 426
* ECS010T1.cbl
 21907           ME50-ECS010-BALANCE
 21908           PENDING-EXTRACT  SUMMARY-EXTR.
 21909
 21910     IF DTE-PGM-OPT = '1'
 21911         CLOSE CERT-MASTER-OUT
 21912               DETAIL-EXTR.
 21913
 21914     IF ERACCTT-FILE-STATUS NOT = '00'
 21915         MOVE '12'                TO ABEND-CODE-1
 21916         MOVE ERACCTT-FILE-STATUS TO ABEND-CODE-2
 21917         DISPLAY '******************************'
 21918         DISPLAY '***** ERROR LOCATION 027 *****'
 21919         DISPLAY '******************************'
 21920         MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
 21921           GO TO ABEND-PGM.
 21922
 21923     IF COMM-OPEN-SW = 'X'
 21924         CLOSE ERCTBL
 21925         IF ERCTBL-FILE-STATUS NOT = '00'
 21926             MOVE '42'               TO ABEND-CODE-1
 21927             MOVE ERCTBL-FILE-STATUS TO ABEND-CODE-2
 21928             DISPLAY '******************************'
 21929             DISPLAY '***** ERROR LOCATION 028 *****'
 21930             DISPLAY '******************************'
 21931             MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
 21932             GO TO ABEND-PGM.
 21933
 21934     IF REIN-OPEN-SW = 'X'
 21935         CLOSE ERRTBL-IN
 21936         IF ERRTBL-FILE-STATUS NOT = '00'
 21937             MOVE '22'               TO ABEND-CODE-1
 21938             MOVE ERRTBL-FILE-STATUS TO ABEND-CODE-2
 21939             DISPLAY '******************************'
 21940             DISPLAY '***** ERROR LOCATION 029 *****'
 21941             DISPLAY '******************************'
 21942             MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
 21943             GO TO ABEND-PGM.
 21944
 21945     MOVE 'C'                         TO CP-IO-FUNCTION.
 21946     PERFORM 8100-GET-RATE THRU 8199-GET-RATE-X.
 21947     IF IO-ERROR
 21948         MOVE 'ERROR OCCURED CLOSING - ELRATE'
 21949                                      TO WS-ABEND-MESSAGE
 21950         MOVE 0302                    TO WS-RETURN-CODE
 21951         DISPLAY '******************************'
 21952         DISPLAY '***** ERROR LOCATION 030 *****'
 21953         DISPLAY '******************************'
 21954         MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
 21955         GO TO ABEND-PGM.
 21956
 21957     IF ME-DO-UPDATE
 21958           MOVE ME-START-TIME        TO ME-010-START
*  12-S***************************************************             ( 282)**
**    Operand ME-010-START is not declared
 21959           MOVE ME-CNDS-DATE         TO ME-010-RUN-DT
 21960           ACCEPT WS-TIME-OF-DAY   FROM TIME
 21961           MOVE WS-TIME              TO ME-010-END
*  12-S*************************************************               ( 426)**
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 427
* ECS010T1.cbl
**    Operand ME-010-END is not declared
 21962           ADD 1 TO ME-010-RUN-CT
 21963           REWRITE MONTH-END-BALANCES
 21964           DISPLAY 'MONTH-END BALANCES POSTED'
 21965           CLOSE ERMEBL-INOUT
 21966     ELSE
 21967         DISPLAY 'MONTH-END BALANCES NOT POSTED'.
 21968
 21969     GO TO 9999-END-THE-JOB.
 21970
 21971 CERT-DATE-LOAD.
*21972     COPY ELCCRTM1.
 21973******************************************************************04/15/98
 21974*                                                                *ELCCRTM1
 21975*                                                                *ELCCRTM1
 21976*                            ELCCRTM1                            *   LV003
 21977*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
 21978*                            VMOD=2.001                          *ELCCRTM1
 21979*                                                                *ELCCRTM1
 21980*   COPY FILE VARIABLES TO WORKING STORAGE                       *ELCCRTM1
 21981*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCCRTM1
 21982*                                                                *ELCCRTM1
 21983******************************************************************ELCCRTM1
 21984     MOVE CR-DT                   TO  WS-CR-DT-N.                    CL**2
 21985     MOVE CR-LF-EXPIRE-DATE       TO  WS-CR-LF-EXPIRE-DATE-N.        CL**2
 21986     MOVE CR-AH-EXPIRE-DATE       TO  WS-CR-AH-EXPIRE-DATE-N.        CL**2
 21987     MOVE CR-ENTRY-DATE           TO  WS-CR-ENTRY-DATE-N.            CL**2
 21988     MOVE CR-LF-CANC-DT           TO  WS-CR-LF-CANC-DT-N.            CL**2
 21989     MOVE CR-LF-CANCEL-EXIT-DATE  TO  WS-CR-LF-CANCEL-EXIT-DATE-N.   CL**2
 21990     MOVE CR-LF-CLAIM-EXIT-DATE   TO  WS-CR-LF-CLAIM-EXIT-DATE-N.    CL**2
 21991     MOVE CR-AH-CANC-DT           TO  WS-CR-AH-CANC-DT-N.            CL**2
 21992     MOVE CR-AH-CANCEL-EXIT-DATE  TO                                 CL**2
 21993                                  WS-CR-AH-CANCEL-EXIT-DATE-N.       CL**2
 21994     MOVE CR-AH-SETTLEMENT-EXIT-DATE TO                           ELCCRTM1
 21995                                 WS-CR-AH-SETTLEMENT-EXIT-DATEN.     CL**2
 21996     MOVE CR-DTH-DT               TO  WS-CR-DTH-DT-N.                CL**2
 21997     MOVE CR-DTH-PAY-DT           TO  WS-CR-DTH-PAY-DT-N.            CL**2
 21998     MOVE CR-DIS-DT               TO  WS-CR-DIS-DT-N.                CL**2
 21999     MOVE CR-DIS-PAY-DT           TO  WS-CR-DIS-PAY-DT-N.            CL**2
 22000     MOVE CR-DIS-PTO-DT           TO  WS-CR-DIS-PTO-DT-N.            CL**2
 22001     PERFORM  VARYING COPY-NDX FROM 1 BY 1 UNTIL COPY-NDX > 5     ELCCRTM1
 22002           MOVE CR-DIS-INCUR-DT (COPY-NDX)   TO                   ELCCRTM1
 22003                                WS-CR-DIS-INCUR-DT-N (COPY-NDX)      CL**2
 22004     END-PERFORM.                                                 ELCCRTM1
 22005                                                                  ELCCRTM1
 22006
 22007 EXTRACT-DATE-LOAD.
*22008     COPY ELCEXTM1.
 22009******************************************************************04/15/98
 22010*                                                                *ELCEXTM1
 22011*                                                                *ELCEXTM1
 22012*                            ELCEXTM1                            *   LV010
 22013*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL*10
 22014*                            VMOD=2.001                          *ELCEXTM1
 22015*                                                                *ELCEXTM1
 22016*   COPY FILE VARIABLES TO WORKING STORAGE                       *ELCEXTM1
 22017*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCEXTM1
 22018*                                                                *ELCEXTM1
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 428
* ECS010T1.cbl (/apps/prod/cid1p/copy/ELCEXTM1)
 22019******************************************************************ELCEXTM1
 22020                                                                  ELCEXTM1
 22021     MOVE DE-EFF                     TO  WS-DE-EFF-N.                CL**9
 22022     MOVE DE-LF-CANC-DTE             TO  WS-DE-LF-CANC-DTE-N.        CL**9
 22023     MOVE DE-LF-CANC-EXIT-DT         TO  WS-DE-LF-CANC-EXIT-DT-N.    CL**9
 22024     MOVE DE-AH-CANC-DTE             TO  WS-DE-AH-CANC-DTE-N.        CL**9
 22025     MOVE DE-AH-CANC-EXIT-DT         TO  WS-DE-AH-CANC-EXIT-DT-N.    CL**9
 22026     MOVE DE-ENTRY-DTE               TO  WS-DE-ENTRY-DTE-N.          CL**9
 22027                                                                     CL**9
 22028     EVALUATE TRUE                                                   CL**5
 22029        WHEN DE-ISSUE      OR                                        CL**8
 22030             DE-RC-ISSUE   OR                                        CL**8
 22031             DE-RR-RC-ISS  OR                                        CL**8
 22032             DE-CANCEL     OR                                        CL**8
 22033             DE-RC-CANCEL  OR                                        CL**8
 22034             DE-RR-RC-CNC                                            CL**8
 22035           MOVE DE-PROC-DT           TO  WS-DE-PROC-DT-N             CL**9
 22036                                                                     CL**9
 22037        WHEN DE-CLAIM      OR                                        CL**8
 22038             DE-RR-RC-CLM                                            CL**6
 22039           MOVE DE-INCUR             TO  WS-DE-INCUR-N               CL**9
 22040           MOVE DE-PAY               TO  WS-DE-PAY-N                 CL**9
 22041           MOVE DE-PAID-TO           TO  WS-DE-PAID-TO-N             CL**9
 22042           MOVE DE-ACC-EXP-DTE       TO  WS-DE-ACC-EXP-DTE-N         CL**9
 22043           MOVE DE-ACC-EFF-DTE       TO  WS-DE-ACC-EFF-DTE-N         CL**9
 22044           MOVE DE-CLM-PROC-DT       TO  WS-DE-CLM-PROC-DT-N         CL**9
 22045                                                                     CL**9
 22046        WHEN DE-RESERVE                                              CL**9
 22047           MOVE DE-RSV-INCUR         TO  WS-DE-RSV-INCUR-N           CL**9
 22048           MOVE DE-RSV-PAYTO         TO  WS-DE-RSV-PAYTO-N           CL**9
 22049           MOVE DE-ACC-EXP-DTE-RSV                                   CL**5
 22050                                     TO  WS-DE-ACC-EXP-DTE-RSV-N     CL**9
 22051           MOVE DE-ACC-EFF-DTE-RSV                                   CL**9
 22052                                     TO  WS-DE-ACC-EFF-DTE-RSV-N     CL**9
 22053           MOVE DE-RSV-PROC-DT       TO  WS-DE-RSV-PROC-DT-N         CL**9
 22054     END-EVALUATE.                                                   CL**9
 22055                                                                     CL**9
 22056
 22057 EXTRACT-DATE-RELOAD.
*22058     COPY ELCEXTM2.
 22059******************************************************************04/15/98
 22060*                                                                *ELCEXTM2
 22061*                                                                *ELCEXTM2
 22062*                            ELCEXTM2                            *   LV011
 22063*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL*11
 22064*                            VMOD=2.001                          *ELCEXTM2
 22065*                                                                *ELCEXTM2
 22066*   COPY WORKING STORAGE TO  FILE VARIABLES                      *ELCEXTM2
 22067*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCEXTM2
 22068*                                                                *   CL**9
 22069******************************************************************ELCEXTM2
 22070                                                                  ELCEXTM2
 22071     MOVE WS-DE-EFF-N                TO  DE-EFF.                     CL*10
 22072     MOVE WS-DE-LF-CANC-DTE-N        TO  DE-LF-CANC-DTE.             CL*10
 22073     MOVE WS-DE-LF-CANC-EXIT-DT-N    TO  DE-LF-CANC-EXIT-DT.         CL*10
 22074     MOVE WS-DE-AH-CANC-DTE-N        TO  DE-AH-CANC-DTE.             CL*10
 22075     MOVE WS-DE-AH-CANC-EXIT-DT-N    TO  DE-AH-CANC-EXIT-DT.         CL*10
 22076     MOVE WS-DE-ENTRY-DTE-N          TO  DE-ENTRY-DTE.               CL*10
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 429
* ECS010T1.cbl (/apps/prod/cid1p/copy/ELCEXTM2)
 22077                                                                     CL*10
 22078     EVALUATE TRUE                                                   CL*10
 22079        WHEN DE-ISSUE      OR                                        CL*10
 22080             DE-RC-ISSUE   OR                                        CL*10
 22081             DE-RR-RC-ISS  OR                                        CL*10
 22082             DE-CANCEL     OR                                        CL*10
 22083             DE-RC-CANCEL  OR                                        CL*10
 22084             DE-RR-RC-CNC                                            CL*10
 22085           MOVE WS-DE-PROC-DT-N      TO  DE-PROC-DT                  CL*10
 22086                                                                     CL*10
 22087        WHEN DE-CLAIM      OR                                        CL*10
 22088             DE-RR-RC-CLM                                            CL**7
 22089           MOVE WS-DE-INCUR-N        TO  DE-INCUR                    CL*10
 22090           MOVE WS-DE-PAY-N          TO  DE-PAY                      CL*10
 22091           MOVE WS-DE-PAID-TO-N      TO  DE-PAID-TO                  CL*10
 22092           MOVE WS-DE-ACC-EXP-DTE-N  TO  DE-ACC-EXP-DTE              CL*10
 22093           MOVE WS-DE-ACC-EFF-DTE-N  TO  DE-ACC-EFF-DTE              CL*10
 22094           MOVE WS-DE-CLM-PROC-DT-N  TO  DE-CLM-PROC-DT              CL*10
 22095                                                                     CL*10
 22096        WHEN DE-RESERVE                                              CL**7
 22097            MOVE WS-DE-RSV-INCUR-N   TO  DE-RSV-INCUR                CL*10
 22098            MOVE WS-DE-RSV-PAYTO-N   TO  DE-RSV-PAYTO                CL*10
 22099            MOVE WS-DE-ACC-EXP-DTE-RSV-N                             CL*10
 22100                                     TO  DE-ACC-EXP-DTE-RSV          CL*10
 22101            MOVE WS-DE-ACC-EFF-DTE-RSV-N                             CL**4
 22102                                     TO  DE-ACC-EFF-DTE-RSV          CL*10
 22103            MOVE WS-DE-RSV-PROC-DT-N TO  DE-RSV-PROC-DT              CL*10
 22104     END-EVALUATE.                                                   CL**5
 22105                                                                  ELCEXTM2
 22106
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 430
* ECS010T1.cbl
 22108 ABEND-PGM.
 22109     DISPLAY '******************************'
 22110     DISPLAY '***** ABEND PGM **************'
 22111     DISPLAY '******************************'
*22112                             COPY ELCABEND.
 22113***************************************************************** 04/14/98
 22114*                                                               * ELCABEND
 22115*                            ELCABEND.                          *    LV003
 22116*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
 22117*                            VMOD 2.002                              CL**2
 22118*                                                               * ELCABEND
 22119*                THIS SECTION DISPLAYS THE NECESSARY MESSAGES   * ELCABEND
 22120*            AND THEN ABENDS.                                   * ELCABEND
 22121*                                                               * ELCABEND
 22122*  NO  CID  MODS  IN  COPYBOOK  ELCABEND                        * ELCABEND
 22123*                                                               * ELCABEND
 22124***************************************************************** ELCABEND
 22125*APS-010.                                                         ELCABEND
 22126     DISPLAY WS-ABEND-MESSAGE.                                    ELCABEND
 22127     DISPLAY WS-ABEND-MESSAGE UPON CONSOLE.                       ELCABEND
 22128                                                                  ELCABEND
 22129     IF WS-ABEND-FILE-STATUS NOT = ZERO                           ELCABEND
 22130         DISPLAY 'FILE STATUS = ' WS-ABEND-FILE-STATUS            ELCABEND
 22131         DISPLAY 'FILE STATUS = ' WS-ABEND-FILE-STATUS            ELCABEND
 22132                                 UPON CONSOLE.                    ELCABEND
 22133                                                                  ELCABEND
 22134     IF WS-RETURN-CODE NOT = ZERO                                 ELCABEND
 22135         DISPLAY 'RETURN CODE = '  WS-RETURN-CODE                 ELCABEND
 22136         DISPLAY 'RETURN CODE = '  WS-RETURN-CODE                 ELCABEND
 22137                                 UPON CONSOLE.                    ELCABEND
 22138                                                                  ELCABEND
 22139     DISPLAY 'PROGRAM WILL NOW ABEND **************'              ELCABEND
 22140     DISPLAY 'PROGRAM WILL NOW ABEND **************'              ELCABEND
 22141                                 UPON CONSOLE.                    ELCABEND
 22142                                                                  ELCABEND
 22143     DIVIDE WS-ZERO BY WS-ZERO GIVING WS-ZERO.                    ELCABEND
 22144     CALL 'ABORTME'.
 22145                                                                  ELCABEND
 22146 APS-EXIT.                                                        ELCABEND
 22147     EXIT.                                                        ELCABEND
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 431
* ECS010T1.cbl
 22149 9999-END-THE-JOB.
 22150
 22151     DISPLAY ' '.
 22152     DISPLAY '****** THE END OF MESSAGES CREATED BY '
 22153         'ECS010 ******'
 22154     DISPLAY ' '.
 22155     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 432
* ECS010T1.cbl
 22156/
 22157 LCP-WRITE-POS-MISMATCH-RPT SECTION.
 22158     IF LCP-ASA = '+'
 22159         WRITE MISMATCH-RPT AFTER 0 LINE
 22160     ELSE
 22161     IF LCP-ASA = ' '
 22162         WRITE MISMATCH-RPT AFTER ADVANCING 1 LINE
 22163     ELSE
 22164     IF LCP-ASA = '0'
 22165         WRITE MISMATCH-RPT AFTER ADVANCING 2 LINE
 22166     ELSE
 22167     IF LCP-ASA = '-'
 22168         WRITE MISMATCH-RPT AFTER ADVANCING 3 LINE
 22169     ELSE
 22170     IF LCP-ASA = '1'
 22171         WRITE MISMATCH-RPT AFTER ADVANCING PAGE
 22172     ELSE
 22173     IF LCP-ASA = '2'
 22174         WRITE MISMATCH-RPT AFTER ADVANCING LCP-CH2
 22175     ELSE
 22176     IF LCP-ASA = '3'
 22177         WRITE MISMATCH-RPT AFTER ADVANCING LCP-CH3
 22178     ELSE
 22179     IF LCP-ASA = '4'
 22180         WRITE MISMATCH-RPT AFTER ADVANCING LCP-CH4
 22181     ELSE
 22182     IF LCP-ASA = '5'
 22183         WRITE MISMATCH-RPT AFTER ADVANCING LCP-CH5
 22184     ELSE
 22185     IF LCP-ASA = '6'
 22186         WRITE MISMATCH-RPT AFTER ADVANCING LCP-CH6
 22187     ELSE
 22188     IF LCP-ASA = '7'
 22189         WRITE MISMATCH-RPT AFTER ADVANCING LCP-CH7
 22190     ELSE
 22191     IF LCP-ASA = '8'
 22192         WRITE MISMATCH-RPT AFTER ADVANCING LCP-CH8
 22193     ELSE
 22194     IF LCP-ASA = '9'
 22195         WRITE MISMATCH-RPT AFTER ADVANCING LCP-CH9
 22196     ELSE
 22197     IF LCP-ASA = 'A'
 22198         WRITE MISMATCH-RPT AFTER ADVANCING LCP-CH10
 22199     ELSE
 22200     IF LCP-ASA = 'B'
 22201         WRITE MISMATCH-RPT AFTER ADVANCING LCP-CH11
 22202     ELSE
 22203     IF LCP-ASA = 'C'
 22204         WRITE MISMATCH-RPT AFTER ADVANCING LCP-CH12
 22205     ELSE
 22206     IF LCP-ASA = 'V'
 22207         WRITE MISMATCH-RPT AFTER ADVANCING LCP-P01
 22208     ELSE
 22209     IF LCP-ASA = 'W'
 22210         WRITE MISMATCH-RPT AFTER ADVANCING LCP-P02
 22211     ELSE
 22212     DISPLAY 'ASA CODE ERROR'.
 22213 LCP-WRITE-END-MISMATCH-RPT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 433
* ECS010T1.cbl
 22214     EXIT.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Last message on page:  426
* Total Messages:    10
* Unrecoverable :     0                    Severe  :     7
* Errors        :     3                    Warnings:     0
* Informational :     0                    Flags   :     0
* Data:     2176749     Code:           0
