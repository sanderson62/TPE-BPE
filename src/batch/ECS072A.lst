* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   1
* ECS072A.cbl
* Options: int("ECS072A.int") anim csi verbose NOBOUND PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("ECS072A.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"ebmlsfile" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" NOCHECKDIV NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"32" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"ECS072A.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"ECS072A.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR NOSTICKY-LINKAGE
*          NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"2" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                ECS072A.
     4*AUTHOR.     Pablo
     5*            Colleyville, TX.
     6*DATE-COMPILED.
     7
     8*SECURITY.   *****************************************************
     9*            *                                                   *
    10*            *   THIS PROGRAM IS THE PROPERTY OF CSO.            *
    11*            *                                                   *
    12*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
    13*            *   OF CSO         IS EXPRESSLY PROHIBITED WITHOUT  *
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   2
* ECS072A.cbl
    14*            *   THE PRIOR WRITTEN PERMISSION OF CSO.            *
    15*            *                                                   *
    16*            *****************************************************
    17
    18*REMARKS. THIS PROGRAM REPORTS THE RATES JOURNAL FILE
    19
    20 ENVIRONMENT DIVISION.
    21
    22 INPUT-OUTPUT SECTION.
    23
    24 FILE-CONTROL.
    25
    26     SELECT RT-JOURNAL-IN    ASSIGN TO SYS010.
    27     SELECT PRINTX           ASSIGN TO SYS008.
    28     SELECT DISK-DATE        ASSIGN TO SYS019.
    29     SELECT FICH             ASSIGN TO SYS020.
    30
    31 DATA DIVISION.
    32
    33 FILE SECTION.
    34
    35 FD  RT-JOURNAL-IN
    36     BLOCK CONTAINS 0 RECORDS
    37     RECORDING MODE F.
    38
    39 01  RT-JOURNAL-IN-REC.
    40     05  filler                  pic x(34).
    41     05  rt-jp-rest-of-rec       pic x(2000).
    42
    43
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   3
* ECS072A.cbl
    45 FD  PRINTX
*   46                                 COPY ELCPRTFD.
    47******************************************************************04/15/98
    48*                                                                *ELCPRTFD
    49*                                                                *ELCPRTFD
    50*                            ELCPRTFD.                           *   LV003
    51*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
    52*                            VMOD=2.006                          *ELCPRTFD
    53******************************************************************ELCPRTFD
    54     RECORDING MODE F                                             ELCPRTFD
    55     LABEL RECORDS OMITTED                                        ELCPRTFD
    56     BLOCK CONTAINS 0 RECORDS
    57     RECORD CONTAINS 133 CHARACTERS.                              ELCPRTFD
    58 01  PRT.                                                         ELCPRTFD
    59     12  P-CTL               PIC  X.                                 CL**2
    60     12  P-DATA              PIC  X(132).                         ELCPRTFD
    61******************************************************************ELCPRTFD
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   4
* ECS072A.cbl
    63 FD  FICH
*   64                                 COPY ELCFCHFD.
    65******************************************************************04/15/98
    66*                                                                *ELCFCHFD
    67*                            ELCFCHFD.                           *   LV003
    68*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
    69*                            VMOD=2.004                          *   CL**3
    70*                                                                *ELCFCHFD
    71******************************************************************ELCFCHFD
    72     BLOCK CONTAINS 0 RECORDS
    73     RECORDING MODE F.                                            ELCFCHFD
    74                                                                  ELCFCHFD
    75 01  FICH-REC                            PIC   X(133).            ELCFCHFD
    76******************************************************************ELCFCHFD
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   5
* ECS072A.cbl
    78 FD  DISK-DATE
*   79                                 COPY ELCDTEFD.
    80******************************************************************04/15/98
    81*                                                                *ELCDTEFD
    82*                                                                *ELCDTEFD
    83*                            ELCDTEFD.                           *   LV002
    84*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
    85*                            VMOD=2.007                          *   CL**2
    86*                                                                *ELCDTEFD
    87******************************************************************ELCDTEFD
    88     BLOCK CONTAINS 0 RECORDS
    89     RECORDING MODE F.                                            ELCDTEFD
    90                                                                  ELCDTEFD
    91 01  DATE-DISK.                                                   ELCDTEFD
    92     12  DD-ID                       PIC  X(4).                   ELCDTEFD
    93     12  FILLER                      PIC  X(14).                  ELCDTEFD
    94     12  DD-CR1                      PIC  9.                      ELCDTEFD
    95     12  DD-CR1N                     PIC  X(30).                  ELCDTEFD
    96     12  DD-CR2                      PIC  9.                      ELCDTEFD
    97     12  DD-CR2N                     PIC  X(30).                  ELCDTEFD
    98     12  FILLER                      PIC  X(20).                  ELCDTEFD
    99                                                                  ELCDTEFD
   100 01  DATE-DISK-R.                                                 ELCDTEFD
   101     12  FILLER                      PIC  X(4).                   ELCDTEFD
   102     12  DD-ST           OCCURS 3 TIMES                           ELCDTEFD
   103                                     PIC  X(32).                  ELCDTEFD
   104                                                                  ELCDTEFD
   105 01  DATE-DISK-T.                                                 ELCDTEFD
   106     12  FILLER                      PIC  X(4).                   ELCDTEFD
   107     12  DD-TYPE         OCCURS 2 TIMES                           ELCDTEFD
   108                                     PIC  X(48).                  ELCDTEFD
   109                                                                  ELCDTEFD
   110 01  DATE-DISK-M.                                                 ELCDTEFD
   111     12  FILLER                      PIC  X(4).                   ELCDTEFD
   112     12  DD-MORT         OCCURS 2 TIMES                           ELCDTEFD
   113                                     PIC  X(48).                  ELCDTEFD
   114                                                                  ELCDTEFD
   115 01  DATE-DISK-P.                                                 ELCDTEFD
   116     12  DD-IDA                      PIC  XX.                     ELCDTEFD
   117     12  DD-IDX                      PIC  99.                     ELCDTEFD
   118     12  DD-DATA                     PIC  X(96).                  ELCDTEFD
   119     12  FILLER  REDEFINES DD-DATA.                               ELCDTEFD
   120         16  DD-PS-PIC   OCCURS 50 TIMES                          ELCDTEFD
   121                                     PIC  X.                      ELCDTEFD
   122         16  FILLER                  PIC  X(46).                  ELCDTEFD
   123     12  FILLER  REDEFINES DD-DATA.                               ELCDTEFD
   124         16  DD-PS-PICO  OCCURS 20 TIMES.                         ELCDTEFD
   125             20  DD-PS-PRT           PIC  X.                      ELCDTEFD
   126             20  DD-PS-FMT           PIC  X.                      ELCDTEFD
   127             20  DD-PS-PRC           PIC  X.                      ELCDTEFD
   128             20  DD-PS-TOT           PIC  X.                      ELCDTEFD
   129         16  FILLER                  PIC  X(16).                  ELCDTEFD
   130                                                                  ELCDTEFD
   131 01  DATE-DISK-E.                                                 ELCDTEFD
   132     12  FILLER                      PIC  X(4).                   ELCDTEFD
   133     12  DD-EDIT         OCCURS 24 TIMES                          ELCDTEFD
   134                                     PIC  X(4).                   ELCDTEFD
   135                                                                  ELCDTEFD
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   6
* ECS072A.cbl (/apps/prod/cid1p/copy/ELCDTEFD)
   136 01  DATE-DISK-C.                                                 ELCDTEFD
   137     12  FILLER                      PIC  X(7).                   ELCDTEFD
   138     12  DD-CARR1-SECPAY-SW          PIC  X.
   139     12  DD-CARR1-UEP-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   140     12  DD-CARR1-R78-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   141     12  DD-CARR1-PRO-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   142     12  DD-CARR1                    PIC  X.                      ELCDTEFD
   143     12  DD-CARR1S                   PIC  XX.                     ELCDTEFD
   144     12  DD-CARR1N                   PIC  X(30).                  ELCDTEFD
   145     12  DD-CARR2                    PIC  X.                      ELCDTEFD
   146     12  DD-CARR2S                   PIC  XX.                     ELCDTEFD
   147     12  DD-CARR2N                   PIC  X(30).                  ELCDTEFD
   148     12  DD-CARR2-UEP-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   149     12  DD-CARR2-R78-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   150     12  DD-CARR2-PRO-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   151     12  DD-CARR2-SECPAY-SW          PIC  X.
   152     12  FILLER                      PIC  X(7).                   ELCDTEFD
   153                                                                  ELCDTEFD
   154 01  DATE-DISK-OPT.                                               ELCDTEFD
   155     12  FILLER                      PIC  X(04).                  ELCDTEFD
   156     12  DD-TLR-DATA.                                             ELCDTEFD
   157         16  DD-TLR                  OCCURS 32 TIMES              ELCDTEFD
   158                                     PIC  X(03).                  ELCDTEFD
   159     12  DD-STATE-DATA REDEFINES DD-TLR-DATA.                     ELCDTEFD
   160         16  DD-STATE-FLDS           OCCURS 16 TIMES              ELCDTEFD
   161                                     PIC  X(06).                  ELCDTEFD
   162     12  DD-CARR-DATA REDEFINES DD-TLR-DATA.                      ELCDTEFD
   163         16  DD-CARR-FLDS            OCCURS 13 TIMES              ELCDTEFD
   164                                     PIC  X(07).                  ELCDTEFD
   165         16  FILLER                  PIC  X(05).                  ELCDTEFD
   166     12  DD-MISC-DATA REDEFINES DD-TLR-DATA                       ELCDTEFD
   167                                     PIC  X(96).                  ELCDTEFD
   168******************************************************************ELCDTEFD
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   7
* ECS072A.cbl
   170 WORKING-STORAGE SECTION.
   171 01  LCP-ABND-CODE                 PIC S999 COMP VALUE +519.
   172 77  FILLER  PIC X(32) VALUE '********************************'.
   173 77  FILLER  PIC X(32) VALUE '     ECS072A WORKING-STORAGE    '.
   174 77  FILLER  PIC X(32) VALUE '*****VMOD=2.001*****************'.
   175
   176 77  ACTR                        PIC S99     COMP.
   177 77  BCTR                        PIC S99     COMP.
   178 77  CTR                         PIC S999    COMP.
   179 77  CTS                         PIC S999    COMP.
   180 77  CTT                         PIC S999    COMP.
   181 77  WK-1                        PIC S999    COMP-3.
   182 77  X                           PIC X.
   183 77  T-FLD                       PIC S9(6)V9(5)  COMP-3.
   184 77  PAGER                       PIC S9(4)   VALUE +1.
   185 77  LINE-CNT                    PIC S9(4)   VALUE ZEROS.
   186 77  CTA                         PIC 9.
   187 77  MO-RTS                      PIC S999    COMP-3    VALUE +360.
   188 77  ws-records-processed        pic 9(5) value zeros.
   189
   190 01  JOURNAL-RECORD.
   191     12  jp-date                 pic s9(5) comp-3.
   192     12  jp-time                 pic s9(7) comp-3.
   193     12  JP-USER-ID              PIC X(4).
   194     12  JP-FILE-ID              PIC X(8).
   195     12  JP-PROGRAM-ID           PIC X(8).
   196     12  JP-RECORD-TYPE          PIC X.
   197         88 JP-ADD                  VALUE 'A'.
   198         88 JP-BEFORE-CHANGE        VALUE 'B'.
   199         88 JP-AFTER-CHANGE         VALUE 'C'.
   200         88 JP-DELETE               VALUE 'D'.
   201         88 JP-GENERIC-DELETE       VALUE 'G'.
   202         88 JP-KEY-CHG-DELETE       VALUE 'K'.
   203         88 JP-KEY-CHG-ADD          VALUE 'N'.
   204     12  JP-GENERIC-KEY-LENGTH   PIC S9(4)   COMP.
   205     12  JP-RECORD-AREA          pic x(2000).
   206
*  207                                 COPY ERCRATE.
   208******************************************************************01/20/90
   209*                                                                *ERCRATE
   210*                                                                *ERCRATE
   211*                            ERCRATE                             *   LV007
   212*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   213*                            VMOD=2.008                          *   CL**7
   214*                                                                *ERCRATE
   215*   ONLINE CREDIT SYSTEM                                         *ERCRATE
   216*                                                                *ERCRATE
   217*   FILE DESCRIPTION = RATES MASTER FILE                         *ERCRATE
   218*                                                                *ERCRATE
   219*   FILE TYPE = VSAM,KSDS                                        *ERCRATE
   220*   RECORD SIZE = 1765  RECFORM = FIXED                          *ERCRATE
   221*                                                                *ERCRATE
   222*   BASE CLUSTER NAME = ERRATE                   RKP=2,LEN=28    *ERCRATE
   223*       ALTERNATE PATH = NONE                                    *ERCRATE
   224*                                                                *ERCRATE
   225*   LOG = NO                                                     *ERCRATE
   226*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *ERCRATE
   227*                                                                *ERCRATE
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   8
* ECS072A.cbl (/apps/prod/cid1p/copy/ERCRATE)
   228******************************************************************ERCRATE
   229                                                                  ERCRATE
   230 01  RATE-RECORD.                                                 ERCRATE
   231     12  RT-RECORD-ID                      PIC XX.                ERCRATE
   232         88  VALID-RT-ID                      VALUE 'RT'.         ERCRATE
   233                                                                  ERCRATE
   234     12  RT-CONTROL-PRIMARY.                                      ERCRATE
   235         16  RT-COMPANY-CD                 PIC X.                 ERCRATE
   236         16  RT-STATE-CODE.                                       ERCRATE
   237             20  RT-ST-CODE                PIC XX.                ERCRATE
   238             20  RT-ST-CLASS               PIC XX.                ERCRATE
   239             20  RT-ST-DEV                 PIC XXX.               ERCRATE
   240         16  RT-L-AH-CODE.                                        ERCRATE
   241             20  RT-L-AH                   PIC X.                 ERCRATE
   242             20  RT-LAH-NUM                PIC XX.                   CL**3
   243         16  RT-LIMITS.                                           ERCRATE
   244             20  RT-HIGH-AGE               PIC 99.                ERCRATE
   245             20  RT-HIGH-AMT               PIC 9(6).              ERCRATE
   246             20  RT-FUTURE                 PIC XX.                ERCRATE
   247             20  RT-SEX                    PIC X.                 ERCRATE
   248         16  RT-EXPIRY-DATE                PIC 9(11)  COMP-3.     ERCRATE
   249                                                                  ERCRATE
   250     12  RT-MAINT-INFORMATION.                                    ERCRATE
   251         16  RT-LAST-MAINT-DT              PIC XX.                ERCRATE
   252         16  RT-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3. ERCRATE
   253         16  RT-LAST-MAINT-USER            PIC X(4).              ERCRATE
   254         16  FILLER                        PIC X(10).             ERCRATE
   255                                                                  ERCRATE
   256     12  RT-STRUCTURE-COMMENT              PIC X(50).             ERCRATE
   257     12  RT-RATE-COMMENT                   PIC X(50).             ERCRATE
   258                                                                  ERCRATE
   259     12  CSL-RESERVED                      PIC X(10).                CL**7
   260     12  FILLER                            PIC X(12).                CL**7
   261                                                                  ERCRATE
   262     12  RT-MAX-AGE                        PIC 99.                ERCRATE
   263                                                                  ERCRATE
   264     12  RT-LIFE-LIMS-FLDS.                                       ERCRATE
   265         16  RT-LIFE-MORT-CODE             PIC X(4).              ERCRATE
   266         16  RT-LIFE-EXCEPTIONS   OCCURS 8 TIMES.                 ERCRATE
   267             20  RT-L-EX-AGE               PIC 99.                ERCRATE
   268             20  RT-L-EX-TERM              PIC S999       COMP-3. ERCRATE
   269             20  RT-L-EX-FACE              PIC S9(7)      COMP-3. ERCRATE
   270         16  FILLER                        PIC X(20).             ERCRATE
   271                                                                  ERCRATE
   272     12  RT-AH-LIMS-FLDS   REDEFINES   RT-LIFE-LIMS-FLDS.         ERCRATE
   273         16  RT-AH-EXCEPTIONS   OCCURS 8 TIMES.                   ERCRATE
   274             20  RT-AH-AGE                 PIC 99.                ERCRATE
   275             20  RT-AH-TERM                PIC S999       COMP-3. ERCRATE
   276             20  RT-AH-BEN-M               PIC S9(5)      COMP-3. ERCRATE
   277             20  RT-AH-BEN-F               PIC S9(7)      COMP-3. ERCRATE
   278                                                                  ERCRATE
   279     12  RT-LIFE-RATES.                                           ERCRATE
   280         16  RT-L-RATE  OCCURS 360 TIMES   PIC S99V9(5)   COMP-3. ERCRATE
   281                                                                  ERCRATE
   282     12  RT-AH-RATES   REDEFINES   RT-LIFE-RATES.                 ERCRATE
   283         16  RT-AH-RATE  OCCURS 360 TIMES  PIC S99V9(5)   COMP-3. ERCRATE
   284                                                                  ERCRATE
   285     12  RT-DAILY-RATE                     PIC S99V9(5)   COMP-3.    CL**2
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   9
* ECS072A.cbl (/apps/prod/cid1p/copy/ERCRATE)
   286                                                                     CL**2
   287     12  RT-DISCOUNT-OPTION                PIC X.                    CL**5
   288         88  RT-DO-NOT-USE                     VALUE ' '.            CL**5
   289         88  RT-USE-DISCOUNT-FACTOR            VALUE '1'.            CL**5
   290         88  RT-USE-APR-AS-DISCOUNT            VALUE '2'.            CL**5
   291                                                                     CL**5
   292     12  RT-DISCOUNT-RATE                  PIC S99V9(5)   COMP-3.    CL**5
   293     12  RT-DISCOUNT-OB-RATE               PIC S99V9(5)   COMP-3.    CL**5
   294                                                                     CL**5
   295     12  RT-COMPOSITE-OPTION               PIC X.                    CL**6
   296         88  RT-NO-COMPOSITE                   VALUE ' '.            CL**6
   297         88  RT-USE-COMPOSITE-RATE             VALUE '1'.            CL**6
   298                                                                     CL**6
   299     12  RT-COMPOSITE-RATE                 PIC S99V9(5)   COMP-3.    CL**6
   300                                                                     CL**6
   301     12  RT-POLICY-FEE                     PIC S9(3)V99   COMP-3.    CL**7
   302     12  FILLER                            PIC X(13).                CL**7
   303                                                                     CL**4
   304     12  RT-TYPE-RATE                      PIC X.                    CL**4
   305         88  RT-IS-STND                        VALUE ' ' 'S'.        CL**4
   306         88  RT-IS-OB                          VALUE 'O'.            CL**4
   307                                                                  ERCRATE
   308     12  RT-SRT-ALPHA                      PIC X.                 ERCRATE
   309                                                                  ERCRATE
   310     12  RT-CONTROL-2.                                            ERCRATE
   311         16  RTC-1                         PIC X(7).              ERCRATE
   312         16  RTC-3                         PIC X(11).             ERCRATE
   313         16  RTC-4                         PIC 9(11) COMP-3.      ERCRATE
   314         16  RTC-2                         PIC X(3).              ERCRATE
   315******************************************************************ERCRATE
   316 01  WS-ABEND.
   317     12  WS-RETURN-CODE          PIC S9(4)       VALUE ZERO.
   318     12  WS-ZERO                 PIC S9          VALUE ZERO.
   319     12  WS-ABEND-MESSAGE        PIC X(80)       VALUE SPACES.
   320     12  WS-ABEND-FILE-STATUS    PIC XX          VALUE ZERO.
   321
   322 01  WS.
   323     12  PGM-SUB                 PIC S999    COMP    VALUE +072.
   324     12  RATE-FILE-STATUS        PIC XX          VALUE ZERO.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  10
* ECS072A.cbl
*  326     COPY ELCDTECX.
   327******************************************************************06/05/98
   328*                                                                *ELCDTECX
   329*                            ELCDTECX.                           *   LV005
   330*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
   331*                            VMOD=2.015                          *ELCDTECX
   332*                                                                *ELCDTECX
   333*      WORKING STORAGE COPY CODE FOR APPLICATIONS CALLING        *ELCDTECX
   334*      THE DATE CARD DISK FILE. ( READ ROUTINE = ELCDTERX,       *ELCDTECX
   335*      AND DISK FILE FD = ELCDTEFX)                              *ELCDTECX
   336*                                                                *ELCDTECX
   337******************************************************************ELCDTECX
   338******************************************************************
   339*                   C H A N G E   L O G
   340*
   341* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   342*-----------------------------------------------------------------
   343*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   344* EFFECTIVE    NUMBER
   345*-----------------------------------------------------------------
   346* 092602    2002091900008  PEMA  INCREASE NUMBER OF MAXIMUM
   347*                                  BENEFIT CODES FROM 300 TO 900
   348* 090803    2003080800002  PEMA  ADD CATEGORY FOR SUPER GAP
   349* 051304    2003080800002  SMVA  ADD REFUND METHOD
   350* 071714    2013100100002  PEMA  FIX CRIT PERIOD EDITS
   351******************************************************************
   352 01  DATE-CARD.                                                   ELCDTECX
   353     12  DATX-COD                    PIC  X(4).                   ELCDTECX
   354     12  RUN-DATE                    PIC  9(11)  COMP-3.          ELCDTECX
   355     12  ALPH-DATE                   PIC  X(18).                  ELCDTECX
   356     12  EP-DT                       PIC  9(11)  COMP-3.          ELCDTECX
   357     12  PEND-ACT-FILE               PIC  XX.                     ELCDTECX
   358     12  EP-SW                       PIC  X.                      ELCDTECX
   359         88  NO-EP-EXTRACTS          VALUE SPACE.                 ELCDTECX
   360     12  TAPE-BATCHES                PIC  X.                      ELCDTECX
   361         88  TP-PREL-BAL             VALUE '1'.                   ELCDTECX
   362     12  BIN-RUN-DATE                PIC  XX.                     ELCDTECX
   363     12  RUN-CENTURY.                                             ELCDTECX
   364         16 RUN-CENTURY-N            PIC  99.                        CL**4
   365     12  FILLER                      PIC  X.                         CL**4
   366     12  CLAS-MORT-OVRD              PIC  X(4).                   ELCDTECX
   367     12  FILLER                      PIC  XXX.                    ELCDTECX
   368     12  COMPANY-NAME                PIC  X(30).                  ELCDTECX
   369                                                                  ELCDTECX
   370 01  FILLER                          PIC  X(7)                       CL**6
   371                                          VALUE 'OPTIONS'.        ELCDTECX
   372 01  DATE-CARD-OPTIONS.                                           ELCDTECX
   373     12  DATE-OPTIONS-ID             PIC  X(4).                   ELCDTECX
   374     12  DTE-MIN-PREM                PIC  99V99.                  ELCDTECX
   375     12  DTE-LANGUAGE-IND            PIC  X.                      ELCDTECX
   376         88  DTE-LANGUAGE-IS-FR           VALUE 'F'.              ELCDTECX
   377         88  DTE-LANGUAGE-IS-ENG          VALUE 'E'.              ELCDTECX
   378     12  DTE-MIN-AGE                 PIC  99.                     ELCDTECX
   379     12  DTE-DEFAULT-AGE             PIC  99.                     ELCDTECX
   380     12  FILLER                      PIC  X.                      ELCDTECX
   381     12  DTE-MAX-TERM                PIC  999.                    ELCDTECX
   382     12  DTE-COMP-VG                 PIC  X.                      ELCDTECX
   383     12  DTE-REM-TRM                 PIC  X.                      ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  11
* ECS072A.cbl (/apps/prod/cid1p/copy/ELCDTECX)
   384     12  DTE-PRM-CK                  PIC S99V99.                  ELCDTECX
   385     12  DTE-PRORATA                 PIC  X.                      ELCDTECX
   386     12  DTE-CLM-REJ                 PIC  X.                      ELCDTECX
   387     12  DTE-REF-REJ                 PIC  X.                      ELCDTECX
   388     12  DTE-COM-TBL-USED            PIC  X.                      ELCDTECX
   389     12  FILLER                      PIC  X.                      ELCDTECX
   390     12  DTE-QTR-CO                  PIC  X.                      ELCDTECX
   391     12  DTE-REF-CK                  PIC S99V99.                  ELCDTECX
   392     12  DTE-CLM-CK                  PIC S99V99.                  ELCDTECX
   393     12  DTE-CONV-DT                 PIC 9(11) COMP-3.               CL**2
   394     12  DTE-DEFAULT-SEX             PIC  X.                      ELCDTECX
   395     12  DTE-EPL-FORMAT              PIC  X.                      ELCDTECX
   396     12  FILLER                      PIC  X.                      ELCDTECX
   397     12  DTE-JT-AGE                  PIC  X.                      ELCDTECX
   398     12  DTE-KEY-BIRTH               PIC  X.                      ELCDTECX
   399     12  DTE-REINSURANCE             PIC  X.                      ELCDTECX
   400     12  DTE-CLAIM-SORT              PIC  X.                      ELCDTECX
   401     12  DTE-WRT-OFF                 PIC  S99V99.                 ELCDTECX
   402     12  DTE-R78                     PIC  X.                      ELCDTECX
   403     12  DTE-DLY-BILL                PIC  X.                      ELCDTECX
   404     12  DTE-ALT-MORT-CODE           PIC  X(4).                   ELCDTECX
   405     12  DTE-CLAIM-PAID-THRU-TO      PIC  X.                      ELCDTECX
   406     12  DTE-COMPENSATION-ACCESS     PIC  X.                      ELCDTECX
   407     12  DTE-MORTG-ACCESS-CNTL       PIC  X.                      ELCDTECX
   408     12  DTE-MP-ALT-MORT-CODE        PIC  X(4).                   ELCDTECX
   409     12  DTE-MORTALITY-AGE-CALC-METHOD                            ELCDTECX
   410                                     PIC  X.                      ELCDTECX
   411         88  DTE-USE-TABLE-ASSIGNED-METHOD VALUE '1'              ELCDTECX
   412                                                 ' '.             ELCDTECX
   413         88  DTE-USE-ALL-AGE-LAST          VALUE '2'.             ELCDTECX
   414         88  DTE-USE-ALL-AGE-NEAR          VALUE '3'.             ELCDTECX
   415     12  DTE-RESERVE-OPTION-SWITCH   PIC  X.                      ELCDTECX
   416         88  DTE-OPT-RESERVE-METHOD-AUTH       VALUE 'Y'.         ELCDTECX
   417         88  DTE-OPT-RESERVE-METHOD-UNAUTH     VALUE 'N' ' '.     ELCDTECX
   418     12  DTE-REM-TRM-CALC-OPTION     PIC  X.                      ELCDTECX
   419     12  DTE-EXPERIENCE-RETENTION-AGE                             ELCDTECX
   420                                     PIC  9.                         CL**4
   421     12  DTE-SYSTEM.                                              ELCDTECX
   422         16  DTE-SYS-A-CREDIT        PIC  X.                      ELCDTECX
   423         16  DTE-SYS-B-PEND-CLAIM    PIC  X.                      ELCDTECX
   424         16  DTE-SYS-C-CONFIRMATIONS PIC  X.                      ELCDTECX
   425         16  DTE-SYS-D-DEMAND-BILL   PIC  X.                      ELCDTECX
   426         16  DTE-SYS-E-CLASIC-CLAIMS PIC  X.                      ELCDTECX
   427         16  DTE-SYS-F-CLASIC-CREDIT PIC  X.                      ELCDTECX
   428         16  DTE-SYS-G-AR-USED       PIC  X.                      ELCDTECX
   429         16  DTE-SYS-H               PIC  X.                      ELCDTECX
   430         16  DTE-SYS-I               PIC  X.                      ELCDTECX
   431         16  DTE-SYS-J               PIC  X.                      ELCDTECX
   432         16  DTE-SYS-K               PIC  X.                      ELCDTECX
   433         16  DTE-SYS-L               PIC  X.                      ELCDTECX
   434         16  DTE-SYS-M               PIC  X.                      ELCDTECX
   435         16  DTE-SYS-N               PIC  X.                      ELCDTECX
   436         16  DTE-SYS-O               PIC  X.                      ELCDTECX
   437         16  DTE-SYS-P               PIC  X.                      ELCDTECX
   438         16  DTE-SYS-Q               PIC  X.                      ELCDTECX
   439         16  DTE-SYS-R               PIC  X.                      ELCDTECX
   440         16  DTE-SYS-S               PIC  X.                      ELCDTECX
   441         16  DTE-SYS-T               PIC  X.                      ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  12
* ECS072A.cbl (/apps/prod/cid1p/copy/ELCDTECX)
   442         16  DTE-SYS-U               PIC  X.                      ELCDTECX
   443         16  DTE-SYS-V               PIC  X.                      ELCDTECX
   444         16  DTE-SYS-W               PIC  X.                      ELCDTECX
   445         16  DTE-SYS-X               PIC  X.                      ELCDTECX
   446         16  DTE-SYS-Y               PIC  X.                      ELCDTECX
   447         16  DTE-SYS-Z               PIC  X.                      ELCDTECX
   448     12  FILLER                      REDEFINES DTE-SYSTEM.        ELCDTECX
   449         16  DTE-SYS-CODE            OCCURS 26 TIMES              ELCDTECX
   450                                     PIC  X.                      ELCDTECX
   451     12  DTE-CLIENT                  PIC  XXX.                    ELCDTECX
   452                                                                  ELCDTECX
   453 01  CLASIC-SYSTEM-CODES.                                         ELCDTECX
   454     12  DTE-COLC-ID                 PIC  X(4).                   ELCDTECX
   455     12  DTE-CLASIC-COMPANY-CD       PIC  X.                      ELCDTECX
   456     12  DTE-CLASIC-COMPANY-NUMBER   PIC  999.                    ELCDTECX
   457*    12  DTE-CLASIC-CLAIM-ACCESS     PIC  X.                      ELCDTECX
   458     12  FILLER                      PIC  X.                      ELCDTECX
   459     12  CLASIC-REIN-MAINT           PIC  XX.                     ELCDTECX
   460     12  CLASIC-COMP-MAINT           PIC  XX.                     ELCDTECX
   461     12  CLASIC-ACCT-MAINT           PIC  XX.                     ELCDTECX
   462     12  CLASIC-CTBL-MAINT           PIC  XX.                     ELCDTECX
   463     12  CLASIC-RATE-MAINT           PIC  XX.                     ELCDTECX
   464     12  CLASIC-CREDIT-EOM-DT        PIC  XX.                     ELCDTECX
   465     12  CLASIC-CLAIMS-EOM-DT        PIC  XX.                     ELCDTECX
   466                                                                  ELCDTECX
   467     12  LIFE-OVERRIDE-L1            PIC  X.                      ELCDTECX
   468     12  LIFE-OVERRIDE-L2            PIC  XX.                     ELCDTECX
   469     12  LIFE-OVERRIDE-L6            PIC  X(6).                   ELCDTECX
   470     12  LIFE-OVERRIDE-L12           PIC  X(12).                  ELCDTECX
   471                                                                  ELCDTECX
   472     12  AH-OVERRIDE-L1              PIC  X.                      ELCDTECX
   473     12  AH-OVERRIDE-L2              PIC  XX.                     ELCDTECX
   474     12  AH-OVERRIDE-L6              PIC  X(6).                   ELCDTECX
   475     12  AH-OVERRIDE-L12             PIC  X(12).                  ELCDTECX
   476                                                                  ELCDTECX
   477     12  CLAS-REPORT-CD1-CAPTION     PIC  X(10).                  ELCDTECX
   478     12  CLAS-REPORT-CD2-CAPTION     PIC  X(10).                  ELCDTECX
   479                                                                  ELCDTECX
   480     12  CLASIC-MORTG-EOM-DT         PIC  XX.                     ELCDTECX
   481     12  CLASIC-AR-EOM-DT            PIC  XX.                     ELCDTECX
   482                                                                  ELCDTECX
   483     12  FILLER                      PIC  X(11)      VALUE SPACE. ELCDTECX
   484                                                                  ELCDTECX
   485 01  DATE-CARD-FACTORS.                                           ELCDTECX
   486     12  DATE-FACTOR-ID              PIC  X(4).                   ELCDTECX
   487     12  FAC-1                       PIC S999V9(5).               ELCDTECX
   488     12  FAC-2                       PIC S999V9(5).               ELCDTECX
   489     12  FAC-3                       PIC S999V9(5).               ELCDTECX
   490     12  FAC-4                       PIC S999V9(5).               ELCDTECX
   491     12  FAC-5                       PIC S999V9(5).               ELCDTECX
   492     12  FAC-6                       PIC S999V9(5).               ELCDTECX
   493                                                                  ELCDTECX
   494 01  FILLER                          PIC  X(12)                   ELCDTECX
   495                                          VALUE 'COMPANY NAME'.   ELCDTECX
   496 01  COMPANY-NAME-TABLE.                                          ELCDTECX
   497     12  C-N-TBL                     OCCURS 6 TIMES.              ELCDTECX
   498         16  CNT-ID                  PIC  X.                      ELCDTECX
   499         16  CNT-NAME                PIC  X(30).                  ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  13
* ECS072A.cbl (/apps/prod/cid1p/copy/ELCDTECX)
   500                                                                  ELCDTECX
   501 01  FILLER                          PIC  X(11)                   ELCDTECX
   502                                          VALUE 'STATE NAMES'.    ELCDTECX
   503 01  STATE-NAMES.                                                 ELCDTECX
   504     12  STATE-NAME-FLD              OCCURS 75 TIMES.             ELCDTECX
   505         16  STATE-SUB               PIC  XX.                     ELCDTECX
   506         16  STATE-PIC1.                                          ELCDTECX
   507             20  STATE-ABBR          PIC  XX.                     ELCDTECX
   508             20  FILLER              PIC  XXX.                    ELCDTECX
   509             20  STATE-PIC           PIC  X(20).                  ELCDTECX
   510             20  STATE-CALL-EARN     PIC  X.                      ELCDTECX
   511             20  STATE-CALL-BREAK    PIC  X.                      ELCDTECX
   512             20  STATE-PRIM-FAC-DEV  PIC  XXX.                    ELCDTECX
   513                                                                  ELCDTECX
   514 01  FILLER                          PIC  X(13)                   ELCDTECX
   515                                          VALUE 'CARRIER NAMES'.  ELCDTECX
   516 01  CARRIER-NAMES.                                               ELCDTECX
   517     12  CARRIER-NAME-FLD            OCCURS 25 TIMES.             ELCDTECX
   518         16  CARRIER-SUB             PIC  X.                      ELCDTECX
   519         16  CARRIER-DOM-ST          PIC  XX.                     ELCDTECX
   520         16  CARRIER-PIC             PIC  X(30).                  ELCDTECX
   521         16  CARRIER-UEP-PCT         PIC  S9V9(4) COMP-3.            CL**6
   522         16  CARRIER-R78-PCT         PIC  S9V9(4) COMP-3.            CL**6
   523         16  CARRIER-PRO-PCT         PIC  S9V9(4) COMP-3.            CL**6
   524*        16  FILLER                  PIC  X.                      ELCDTECX
   525         16  CARRIER-SEC-PAY         PIC  X.
   526             88  SEC-PAY-CARRIER          VALUE 'Y'.
   527                                                                  ELCDTECX
   528 01  FILLER                          PIC  X(9)                       CL**6
   529                                          VALUE 'INS TYPES'.      ELCDTECX
   530 01  CLAS-INS-TYPES.                                              ELCDTECX
   531*    12 CLAS-ALL-TYPES               OCCURS 300 TIMES.            ELCDTECX
   532     12 CLAS-ALL-TYPES               OCCURS 900 TIMES.            ELCDTECX
   533         16  CLAS-I-BEN              PIC  XX.                     ELCDTECX
   534         16  CLAS-I-AB3.                                          ELCDTECX
   535             20  FILLER              PIC  X.                      ELCDTECX
   536             20  CLAS-I-AB2.                                      ELCDTECX
   537                 24  FILLER          PIC  X.                      ELCDTECX
   538                 24  CLAS-I-AB1      PIC  X.                      ELCDTECX
   539         16  CLAS-I-AB3-AH REDEFINES CLAS-I-AB3.                  ELCDTECX
   540             20  CLAS-EXCLUSION      PIC  XX.                        CL**4
   541             20  FILLER              PIC  X.                         CL**4
   542         16  CLAS-I-AB10.                                         ELCDTECX
   543             20  FILLER              PIC  X(9).                   ELCDTECX
   544             20  CLAS-I-REIN-YN      PIC  X.                      ELCDTECX
   545         16  CLAS-I-COMMENT          PIC  X(10).                  ELCDTECX
   546         16  CLAS-I-JOINT            PIC  X.                      ELCDTECX
   547         16  CLAS-I-RL-AH            PIC  X.                      ELCDTECX
   548         16  CLAS-I-CALC-TYPE.                                    ELCDTECX
   549             20  CLAS-I-BAL          PIC  X.                      ELCDTECX
   550         16  CLAS-I-EP               PIC  X.                      ELCDTECX
   551         16  CLAS-CO-BEN-I-G-CD      PIC  X.                      ELCDTECX
   552         16  CLAS-CO-REM-TERM-CALC   PIC  X.                      ELCDTECX
   553         16  CLAS-I-BEN-CATEGORY     PIC  X.
   554         16  CLAS-I-REFUND-METHOD    PIC  X.
   555         16  CLAS-I-MAX-BENEFITS     PIC 99.
   556         16  FILLER                  PIC  XXX.
   557                                                                  ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  14
* ECS072A.cbl (/apps/prod/cid1p/copy/ELCDTECX)
   558 01  FILLER                          PIC  X(16)                   ELCDTECX
   559                                     VALUE 'MORTALITY TABLES'.    ELCDTECX
   560 01  CLAS-MORTALITY-CODES.                                        ELCDTECX
   561     12  CLAS-MORT-FLD               OCCURS 99 TIMES              ELCDTECX
   562                                     INDEXED BY CLAS-MORT-NDX.    ELCDTECX
   563         16  CLAS-MORT-CODE          PIC  X(4).                      CL**6
   564         16  CLAS-MORT-J-CODE        PIC  X.                         CL**5
   565         16  CLAS-MORT-J-FACT        PIC S9V9(4).                    CL**6
   566         16  CLAS-MORT-DESC.                                      ELCDTECX
   567             20  CLAS-RESERVE-ADJ    PIC  999.                       CL**6
   568             20  FILLER              PIC  XX.                        CL**5
   569             20  CLAS-YEAR           PIC  X(4).                      CL**6
   570             20  FILLER              PIC  X.                         CL**5
   571             20  CLAS-TABLE-TYPE     PIC  XXX.                       CL**6
   572             20  FILLER              PIC  X.                         CL**5
   573             20  CLAS-AGE-METHOD     PIC  XX.                        CL**5
   574             20  FILLER              PIC  X.                         CL**5
   575             20  CLAS-INTEREST       PIC  99.99.                     CL**5
   576             20  FILLER              PIC  X(5).                      CL**6
   577                                                                  ELCDTECX
   578 01  FILLER                          PIC  X(15)                   ELCDTECX
   579                                     VALUE 'BUSINESS TABLES'.     ELCDTECX
   580 01  CLAS-BUSINESS-CLASSES.                                       ELCDTECX
   581     12  CLAS-BUSC-FLD               OCCURS 50 TIMES.             ELCDTECX
   582         16  CLAS-BUSC-CODE          PIC  99.                     ELCDTECX
   583         16  CLAS-BUSC-GROUP         PIC  X.                      ELCDTECX
   584         16  CLAS-BUSC-DESC          PIC  X(19).                  ELCDTECX
   585         16  CLAS-BUSC-EXCL          PIC  X.                         CL**5
   586         16  FILLER                  PIC  X(4).                      CL**6
   587                                                                  ELCDTECX
   588 01  FILLER                          PIC  X(7)                       CL**6
   589                                     VALUE 'INDEXES'.             ELCDTECX
   590 01  CLAS-INDEX-TBL.                                              ELCDTECX
   591     12  CLAX-ID                     PIC  X(4).                   ELCDTECX
   592     12  CLAS-STARTC                 PIC S9(4) COMP.              ELCDTECX
   593     12  CLAS-MAXC                   PIC S9(4) COMP.              ELCDTECX
   594     12  CLAS-STARTL                 PIC S9(4) COMP.              ELCDTECX
   595     12  CLAS-MAXL                   PIC S9(4) COMP.              ELCDTECX
   596     12  CLAS-STARTA                 PIC S9(4) COMP.              ELCDTECX
   597     12  CLAS-MAXA                   PIC S9(4) COMP.              ELCDTECX
   598     12  CLAS-STARTM                 PIC S9(4) COMP.              ELCDTECX
   599     12  CLAS-MAXM                   PIC S9(4) COMP.              ELCDTECX
   600     12  CLAS-STARTB                 PIC S9(4) COMP.              ELCDTECX
   601     12  CLAS-MAXB                   PIC S9(4) COMP.              ELCDTECX
   602     12  CLAS-STARTS                 PIC S9(4) COMP.              ELCDTECX
   603     12  CLAS-MAXS                   PIC S9(4) COMP.              ELCDTECX
   604     12  CLAS-STARTE                 PIC S9(4) COMP.              ELCDTECX
   605     12  CLAS-MAXE                   PIC S9(4) COMP.              ELCDTECX
   606     12  CLAS-STARTCN                PIC S9(4) COMP.              ELCDTECX
   607     12  CLAS-MAXCN                  PIC S9(4) COMP.              ELCDTECX
   608                                                                  ELCDTECX
   609 01  CLAS-TYPE-MISC.                                              ELCDTECX
   610     12  CLAS-INDEXC                 PIC S9(4) COMP.              ELCDTECX
   611     12  CLAS-INDEXL                 PIC S9(4) COMP.              ELCDTECX
   612     12  CLAS-INDEXA                 PIC S9(4) COMP.              ELCDTECX
   613     12  CLAS-INDEXM                 PIC S9(4) COMP.              ELCDTECX
   614     12  CLAS-INDEXB                 PIC S9(4) COMP.              ELCDTECX
   615     12  CLAS-INDEXS                 PIC S9(4) COMP.              ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  15
* ECS072A.cbl (/apps/prod/cid1p/copy/ELCDTECX)
   616     12  CLAS-INDEXE                 PIC S9(4) COMP.              ELCDTECX
   617     12  CLAS-INDEX                  PIC S9(4) COMP.              ELCDTECX
   618     12  CLAS-INDEXEN                PIC S9(4) COMP.              ELCDTECX
   619     12  CLAS-INDEXCN                PIC S9(4) COMP.              ELCDTECX
   620     12  CLAS-INDEXON                PIC S9(4) COMP.              ELCDTECX
   621                                                                  ELCDTECX
   622 01  FILLER                          PIC  X(13)                   ELCDTECX
   623                                     VALUE 'MISCELLANEOUS'.       ELCDTECX
   624 01  CLAS-MISC.                                                   ELCDTECX
   625     12  DTE-FICH                    PIC  X.                      ELCDTECX
   626         88  FICH-NO                 VALUE SPACE.                 ELCDTECX
   627         88  FICH-ONLY               VALUE '1'.                   ELCDTECX
   628         88  FICH-BOTH               VALUE '2'.                   ELCDTECX
   629     12  FICH-OPEN                   PIC  X.                      ELCDTECX
   630     12  REPT-OPEN                   PIC  X.                      ELCDTECX
   631     12  DTE-PGM-OPT                 PIC  9.                         CL**5
   632     12  DTE-PRT-OPT                 PIC  X.                      ELCDTECX
   633     12  DTE-FMT-OPT                 PIC  9.                      ELCDTECX
   634     12  DTE-PRC-OPT                 PIC  9.                      ELCDTECX
   635     12  DTE-TOT-OPT                 PIC  9.                      ELCDTECX
   636     12  CLAS-LOOK                   PIC  XX.                     ELCDTECX
   637     12  DTE-TOT-LINES               PIC S9(8)      COMP.         ELCDTECX
   638     12  STATE-L                     PIC  XX.                     ELCDTECX
   639     12  CLAS-CN                     PIC  99.                     ELCDTECX
   640     12  CLAS-CO                     PIC  99.                     ELCDTECX
   641     12  DTE-VSAM-FLAGS                              VALUE ZERO.  ELCDTECX
   642         16  DTE-F-1                 PIC  X.                      ELCDTECX
   643         16  DTE-F-2                 PIC  X.                      ELCDTECX
   644     12  DTE-ABEND-WORK.                                          ELCDTECX
   645         16  DTE-ABEND-CD-1          PIC  XX         VALUE SPACES.ELCDTECX
   646         16  DTE-ABEND-CD-2          PIC  XX         VALUE SPACES.ELCDTECX
   647                                                                  ELCDTECX
   648 01  FILLER                          PIC  X(12)                   ELCDTECX
   649                                     VALUE 'WORKING DATE'.        ELCDTECX
   650 01  WS-DATE-AND-TIME.                                            ELCDTECX
   651     12  WS-ACCEPT-DATE.                                          ELCDTECX
   652         16  WS-AD-YY                PIC  99.                     ELCDTECX
   653         16  WS-AD-MM                PIC  99.                     ELCDTECX
   654         16  WS-AD-DD                PIC  99.                     ELCDTECX
   655     12  WS-CURRENT-DATE.                                         ELCDTECX
   656         16  WS-CD-MM                PIC  99.                     ELCDTECX
   657         16  FILLER                  PIC  X          VALUE '/'.   ELCDTECX
   658         16  WS-CD-DD                PIC  99.                     ELCDTECX
   659         16  FILLER                  PIC  X          VALUE '/'.   ELCDTECX
   660         16  WS-CD-YY                PIC  99.                     ELCDTECX
   661     12  WS-TIME-OF-DAY.                                          ELCDTECX
   662         16  WS-TIME                 PIC  9(6).                   ELCDTECX
   663         16  WS-HUN-SEC              PIC  99.                     ELCDTECX
   664                                                                  ELCDTECX
   665 01  FILLER                          PIC  X(12)                   ELCDTECX
   666                                     VALUE 'CARRIER CLMS'.        ELCDTECX
   667 01  CARRIER-OPT-CLAIM-DATA.                                      ELCDTECX
   668     12  CARRIER-FLDS                OCCURS 25 TIMES.             ELCDTECX
   669         16  CARRIER-IBNR-SWITCH     PIC  X.                         CL**5
   670         16  CARRIER-IBNR-PERCENT    PIC S9V9(4) COMP-3.             CL**6
   671         16  CARRIER-CIDA-DISCOUNT   PIC S9V9(4) COMP-3.             CL**6
   672                                                                  ELCDTECX
   673 01  FILLER                          PIC  X(10)                   ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  16
* ECS072A.cbl (/apps/prod/cid1p/copy/ELCDTECX)
   674                                     VALUE 'STATE TLRS'.          ELCDTECX
   675 01  STATE-TARGET-LOSS-RATIOS.                                    ELCDTECX
   676     12  STATE-TLR-FLD               OCCURS 75 TIMES.             ELCDTECX
   677         16  STATE-TARGET-LOSS-RATIO PIC S9V9(4) COMP-3.             CL**6
   678         16  STATE-CALC-INTEREST     PIC S9V9(4) COMP-3.             CL**6
   679                                                                  ELCDTECX
   680 01  FILLER                          PIC  X(13)                   ELCDTECX
   681                                     VALUE 'BUSINESS TLRS'.       ELCDTECX
   682 01  BUSINESS-TRGT-LOSS-RATIO-MODS.                               ELCDTECX
   683     12  BUS-TLRM-FLD                OCCURS 99 TIMES.             ELCDTECX
   684         16  BUS-TRGT-LOSS-RATIO-MOD PIC S9V9(4) COMP-3.             CL**6
   685                                                                  ELCDTECX
   686 01  FILLER                          PIC  X(13)                   ELCDTECX
   687                                     VALUE 'MISC CLM DATA'.       ELCDTECX
   688 01  MISC-OPT-CLM-RSV-DATA.                                       ELCDTECX
   689     12  COMPANY-CALC-INTEREST       PIC S9V9(4) COMP-3.             CL**6
   690     12  COMPANY-CIDA-DISCOUNT       PIC S9V9(4) COMP-3.             CL**6
   691     12  COMPANY-CRDB-TABLE-SELECTION                             ELCDTECX
   692                                     PIC  X.                         CL**5
   693     12  COMPANY-IBNR-AH-FACTOR      PIC S9V9(4) COMP-3.             CL**6
   694     12  COMPANY-IBNR-LAG-MONTH      PIC S999    COMP-3.             CL**6
   695     12  COMPANY-IBNR-LIFE-FACTOR    PIC S9V9(4) COMP-3.             CL**6
   696     12  COMPANY-OPTION-START-DATE   PIC  XX.                        CL**5
   697     12  INDEXBS                     PIC S9(4)   COMP.               CL**6
   698     12  INDEXCA                     PIC S9(4)   COMP.               CL**6
   699     12  INDEXST                     PIC S9(4)   COMP.               CL**6
   700     12  FILLER                      PIC  X(75).                  ELCDTECX
   701******************************************************************ELCDTECX
   702*01  MISC-CARR-PCT-DATA.                                          00001521
   703*    12  DD-CARR1-UEP-PCT            PIC S9V9(4) COMP-3.          00001522
   704*    12  DD-CARR1-R78-PCT            PIC S9V9(4) COMP-3.          00001522
   705*    12  DD-CARR1-PRO-PCT            PIC S9V9(4) COMP-3.          00001522
   706*    12  DD-CARR2-UEP-PCT            PIC S9V9(4) COMP-3.          00001522
   707*    12  DD-CARR2-R78-PCT            PIC S9V9(4) COMP-3.          00001522
   708*    12  DD-CARR2-PRO-PCT            PIC S9V9(4) COMP-3.          00001522
   709******************************************************************ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  17
* ECS072A.cbl
*  711     COPY ELCDTEVR.
   712***************************************************************** 04/15/98
   713*                                                                *ELCDTEVR
   714*                                                                *ELCDTEVR
   715*                            ELCDTEVR.                           *   LV003
   716*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
   717*                            VMOD=2.001                          *   CL**2
   718*                                                                *ELCDTEVR
   719*   WORKING STORAGE FOR DATE VARIABLES CREATED                   *ELCDTEVR
   720*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCDTEVR
   721*                                                                *ELCDTEVR
   722******************************************************************ELCDTEVR
   723 01  WS-DATE-CARD-DATE.                                           ELCDTEVR
   724     05  WS-RUN-DATE.                                             ELCDTEVR
   725         10  FILLER                  PIC  9(03).                  ELCDTEVR
   726         10  RUN-CCYY                PIC  9(04).                  ELCDTEVR
   727         10  RUN-CCYR  REDEFINES  RUN-CCYY.                       ELCDTEVR
   728             15  RUN-CC              PIC  99.                     ELCDTEVR
   729             15  RUN-YR              PIC  99.                     ELCDTEVR
   730         10  RUN-MO                  PIC  99.                     ELCDTEVR
   731         10  RUN-DA                  PIC  99.                     ELCDTEVR
   732     05  WS-RUN-DATE-N REDEFINES                                     CL**2
   733            WS-RUN-DATE              PIC 9(11).                      CL**2
   734     05  WS-EP-DT.                                                ELCDTEVR
   735         10  FILLER                  PIC  9(03).                  ELCDTEVR
   736         10  EP-CCYY                 PIC  9(04).                  ELCDTEVR
   737         10  EP-CCYR  REDEFINES  EP-CCYY.                         ELCDTEVR
   738             15  EP-CC               PIC  99.                     ELCDTEVR
   739             15  EP-YR               PIC  99.                     ELCDTEVR
   740         10  EP-MO                   PIC  99.                     ELCDTEVR
   741         10  EP-DA                   PIC  99.                     ELCDTEVR
   742     05  WS-EP-DT-N REDEFINES                                        CL**2
   743            WS-EP-DT                 PIC 9(11).                      CL**2
   744     05  WS-DTE-CONV-DT.                                             CL**4
   745         10  FILLER                  PIC  9(03).                     CL**4
   746         10  DTE-CONV-CCYY           PIC  9(04).                     CL**4
   747         10  DTE-CONV-CCYR  REDEFINES  DTE-CONV-CCYY.                CL**4
   748             15  DTE-CONV-CC         PIC  99.                        CL**4
   749             15  DTE-CONV-YR         PIC  99.                        CL**4
   750         10  DTE-CONV-MO             PIC  99.                        CL**4
   751         10  DTE-CONV-DA             PIC  99.                        CL**4
   752     05  WS-DTE-CONV-DT-N REDEFINES                                  CL**4
   753            WS-DTE-CONV-DT           PIC  9(11).                     CL**4
   754 01  WS-BALANCE-FORWARD-DATE.                                     ELCDTEVR
   755     05  WS-BF-LAST-ACTIVITY-DATE.                                ELCDTEVR
   756         10  FILLER                            PIC 999.           ELCDTEVR
   757         10  BF-ACT-CCYY                       PIC 9(04).         ELCDTEVR
   758         10  BF-ACT-CCYR  REDEFINES  BF-ACT-CCYY.                 ELCDTEVR
   759             15  BF-ACT-CC                     PIC 99.            ELCDTEVR
   760             15  BF-ACT-YEAR                   PIC 99.            ELCDTEVR
   761         10  BF-ACT-MONTH                      PIC 99.            ELCDTEVR
   762         10  BF-ACT-DAY                        PIC 99.            ELCDTEVR
   763     05  WS-BF-LAST-ACTIVITY-DATE-N REDEFINES                        CL**2
   764            WS-BF-LAST-ACTIVITY-DATE           PIC 9(11).            CL**2
   765     05  WS-BF-CURRENT-LAST-STMT-DT.                              ELCDTEVR
   766         10  FILLER                            PIC 999.           ELCDTEVR
   767         10  BF-CURRENT-LAST-STMT-CEN          PIC 99.            ELCDTEVR
   768         10  BF-CURRENT-LAST-STMT-YEAR         PIC 99.            ELCDTEVR
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  18
* ECS072A.cbl (/apps/prod/cid1p/copy/ELCDTEVR)
   769         10  BF-CURRENT-LAST-STMT-MONTH        PIC 99.            ELCDTEVR
   770         10  BF-CURRENT-LAST-STMT-DAY          PIC 99.            ELCDTEVR
   771     05  WS-BF-CURRENT-LAST-STMT-DT-N REDEFINES                      CL**2
   772            WS-BF-CURRENT-LAST-STMT-DT        PIC 9(11).             CL**2
   773 01  WS-ADD-CONF-TRANSACTIONS-DTE.                                ELCDTEVR
   774     05  WS-AC-CERT-EFF-DATE.                                     ELCDTEVR
   775         10  FILLER                            PIC 999.           ELCDTEVR
   776         10  AC-CERT-CCYY                      PIC 9(04).         ELCDTEVR
   777         10  AC-CERT-CCYR  REDEFINES  AC-CERT-CCYY.               ELCDTEVR
   778             15  AC-CERT-CC                    PIC 99.            ELCDTEVR
   779             15  AC-CERT-YR                    PIC 99.            ELCDTEVR
   780         10  AC-CERT-MO                        PIC 99.            ELCDTEVR
   781         10  AC-CERT-DA                        PIC 99.            ELCDTEVR
   782     05  WS-AC-CERT-EFF-DATE-N REDEFINES                             CL**2
   783            WS-AC-CERT-EFF-DATE                PIC 9(11).            CL**2
   784     05  WS-AC-LIFE-CANCEL-DATE.                                  ELCDTEVR
   785         10  FILLER                            PIC 999.           ELCDTEVR
   786         10  AC-LIFE-CANCEL-CCYY               PIC 9(04).         ELCDTEVR
   787         10  AC-LIFE-CANCEL-CCYR REDEFINES AC-LIFE-CANCEL-CCYY.   ELCDTEVR
   788             15  AC-LIFE-CANCEL-CC             PIC 99.            ELCDTEVR
   789             15  AC-LIFE-CANCEL-YR             PIC 99.            ELCDTEVR
   790         10  AC-LIFE-CANCEL-MO                 PIC 99.            ELCDTEVR
   791         10  AC-LIFE-CANCEL-DA                 PIC 99.            ELCDTEVR
   792     05  WS-AC-LIFE-CANCEL-DATE-N REDEFINES                          CL**2
   793            WS-AC-LIFE-CANCEL-DATE             PIC 9(11).            CL**2
   794     05  WS-AC-AH-CANCEL-DATE.                                    ELCDTEVR
   795         10  FILLER                            PIC 999.           ELCDTEVR
   796         10  AC-AH-CANCEL-CCYY                 PIC 9(04).         ELCDTEVR
   797         10  AC-AH-CANCEL-CCYR  REDEFINES  AC-AH-CANCEL-CCYY.     ELCDTEVR
   798             15  AC-AH-CANCEL-CC               PIC 99.            ELCDTEVR
   799             15  AC-AH-CANCEL-YR               PIC 99.            ELCDTEVR
   800         10  AC-AH-CANCEL-MO                   PIC 99.            ELCDTEVR
   801         10  AC-AH-CANCEL-DA                   PIC 99.            ELCDTEVR
   802     05  WS-AC-AH-CANCEL-DATE-N REDEFINES                            CL**2
   803            WS-AC-AH-CANCEL-DATE               PIC 9(11).            CL**2
   804 01  WS-RATE-RECORD.                                              ELCDTEVR
   805         05  WS-RT-EXPIRY-DATE.                                   ELCDTEVR
   806             10  FILLER                        PIC 999.           ELCDTEVR
   807             10  RT-EXP-CCYY                   PIC 9(04).         ELCDTEVR
   808             10  RT-EXP-CCYR  REDEFINES  RT-EXP-CCYY.             ELCDTEVR
   809                 15  RT-EXP-CC                 PIC 99.            ELCDTEVR
   810                 15  RT-EXP-YR                 PIC 99.            ELCDTEVR
   811             10  RT-EXP-MO                     PIC 99.            ELCDTEVR
   812             10  RT-EXP-DA                     PIC 99.            ELCDTEVR
   813         05  WS-RT-EXPIRY-DATE-N REDEFINES                           CL**2
   814                WS-RT-EXPIRY-DATE              PIC 9(11).            CL**2
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  19
* ECS072A.cbl
   816 01  data-line-0.
   817     12  filler                  pic x(16).
   818     12  DL0-COMMENT             PIC X(20).
   819     12  FILLER                  PIC X(5).
   820     12  DL0-USER                PIC X(4).
   821     12  FILLER                  PIC X(5).
   822     12  DL0-DATE                PIC X(10).
   823     12  FILLER                  PIC X(5).
   824     12  DL0-TIME                PIC 9(6).
   825     12  FILLER                  PIC X(5).
   826     12  DL0-PROGRAM             PIC X(8).
   827
   828 01  DATA-LINE-1.
   829     12  FILLER                  PIC X       VALUE SPACE.
   830     12  FILLER                  PIC X(6)    VALUE 'STATE '.
   831     12  DL-1AA                  PIC XX.
   832     12  FILLER                  PIC XXX     VALUE ' - '.
   833     12  DL-1A                   PIC X(30).
   834     12  FILLER                  PIC X(5)    VALUE SPACE.
   835     12  DL-1DTE                 PIC X(28).
   836     12  FILLER                  PIC X(5)    VALUE SPACES.
   837     12  DL-COMNT                PIC X(50).
   838
   839 01  DATA-LINE-1A.
   840     12  FILLER                  PIC X(11)   VALUE SPACES.
   841     12  FILLER                  PIC X(8)    VALUE 'CLASS = '.
   842     12  DL-CLASS                PIC XX.
   843     12  FILLER                  PIC X(16)
   844         VALUE '    DEVIATION = '.
   845     12  DL-DEV                  PIC XXX.
   846     12  FILLER                  PIC X(15)
   847         VALUE '    HIGH AGE = '.
   848     12  DL-HI-AGE               PIC XX.
   849
   850 01  DATA-LINE-2.
   851     12  FILLER                  PIC X(11)   VALUE '        *'.
   852     12  DL-2-OVRD               PIC X(12).
   853     12  DL-2A                   PIC XX.
   854     12  FILLER                  PIC XXX     VALUE ' - '.
   855     12  DL-2B                   PIC X(12).
   856     12  FILLER                  PIC X(5)    VALUE SPACES.
   857     12  DL-2A-COMNT             PIC X(50).
   858
   859 01  DATA-LINE-4.
   860     12  FILLER                  PIC X(11)   VALUE SPACES.
   861     12  DL-4-OVRD               PIC X(06).
   862     12  FILLER      PIC X(11)
   863         VALUE ' MORTALITY '.
   864     12  FILLER                  PIC X(7)    VALUE 'CODE = '.
   865     12  DL-4C                   PIC X(4)    VALUE SPACES.
   866     12  FILLER                  PIC XXX     VALUE ' = '.
   867     12  DL-4B                   PIC X(26).
   868
   869 01  DATA-LINE-4A.
   870     12  FILLER                  PIC X(11)   VALUE SPACES.
   871     12  FILLER      PIC X(22)
   872         VALUE 'MAXIMUM ATTAINED AGE '.
   873     12  DL-4AGE                 PIC Z9.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  20
* ECS072A.cbl
   874
   875 01  DATA-LINE-5.
   876     12  FILLER                  PIC X(11)   VALUE SPACES.
   877     12  FILLER      PIC X(29)
   878         VALUE 'EXCEPTIONS     AGE'.
   879     12  DL-5A               OCCURS 8.
   880         16  DL-5B               PIC ZZ.
   881         16  DL-5C               PIC X(8).
   882
   883 01  DATA-LINE-6.
   884     12  FILLER                  PIC X(26)   VALUE SPACES.
   885     12  FILLER                  PIC X(13)   VALUE 'TERM'.
   886     12  DL-6A               OCCURS 8.
   887         16  DL-6B               PIC ZZZ.
   888         16  DL-6C               PIC X(7).
   889
   890 01  DATA-LINE-7.
   891     12  FILLER                  PIC X(26)   VALUE SPACES.
   892     12  FILLER                  PIC X(9)    VALUE 'FACE'.
   893     12  DL-7A               OCCURS 8.
   894         16  DL-7B               PIC Z(7).
   895         16  DL-7C               PIC X(3).
   896
   897 01  DATA-LINE-8.
   898     12  FILLER                  PIC X(11)   VALUE SPACES.
   899     12  DL-8-OVRD               PIC X(06).
   900     12  FILLER                  PIC X(17)
   901         VALUE ' RATES BY MONTHS'.
   902
   903 01  DATA-LINE-9.
   904     12  FILLER                  PIC X(16)   VALUE SPACES.
   905     12  FILLER                  PIC X(10)   VALUE '   1'.
   906     12  FILLER                  PIC X(10)   VALUE '   2'.
   907     12  FILLER                  PIC X(10)   VALUE '   3'.
   908     12  FILLER                  PIC X(10)   VALUE '   4'.
   909     12  FILLER                  PIC X(10)   VALUE '   5'.
   910     12  FILLER                  PIC X(10)   VALUE '   6'.
   911     12  FILLER                  PIC X(10)   VALUE '   7'.
   912     12  FILLER                  PIC X(10)   VALUE '   8'.
   913     12  FILLER                  PIC X(10)   VALUE '   9'.
   914     12  FILLER                  PIC X(10)   VALUE '  10'.
   915     12  FILLER                  PIC X(10)   VALUE '  11'.
   916     12  FILLER                  PIC X(10)   VALUE '  12'.
   917
   918 01  DATA-LINE-10.
   919     12  FILLER                  PIC X(5)    VALUE SPACES.
   920     12  FILLER                  PIC X(4)    VALUE 'YEAR'.
   921     12  DL-10A                  PIC ZZ9.
   922     12  DL-10B              OCCURS 12.
   923         16  DL-10C              PIC XX.
   924         16  DL-10D              PIC ZZ.Z(5).
   925     12  FILLER                  PIC XXXX    VALUE SPACES.
   926
   927 01  DATA-LINE-11.
   928     12  FILLER                  PIC X(11)   VALUE '        *'.
   929     12  DL-11-OVRD              PIC X(12).
   930     12  FILLER                  PIC X(5)    VALUE 'TYPE'.
   931     12  DL-11A                  PIC XX.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  21
* ECS072A.cbl
   932     12  FILLER                  PIC XXX     VALUE ' - '.
   933     12  DL-11B                  PIC X(12).
   934     12  FILLER                  PIC X(5)    VALUE SPACES.
   935     12  DL-11A-COMM             PIC X(50).
   936
   937 01  DATA-LINE-12.
   938     12  FILLER                  PIC X(11)   VALUE SPACES.
   939     12  FILLER                  PIC X(29)
   940         VALUE 'EXCEPTIONS     AGE'.
   941     12  DL-12A              OCCURS 8.
   942         16  DL-12B              PIC ZZ.
   943         16  DL-12C              PIC X(8).
   944
   945 01  DATA-LINE-12A.
   946     12  FILLER                  PIC X(26)   VALUE SPACES.
   947     12  FILLER                  PIC X(13)   VALUE 'TERM'.
   948     12  DL-12A-TERM     OCCURS 8.
   949         16  DL-12A-T            PIC ZZZ.
   950         16  DL-12A-FIL          PIC X(7).
   951
   952
   953 01  DATA-LINE-13.
   954     12  FILLER                  PIC X(26)   VALUE SPACES.
   955     12  FILLER                  PIC X(11)   VALUE 'BENEFIT'.
   956     12  DL-13A              OCCURS 8.
   957         16  DL-13B              PIC Z(5).
   958         16  DL-13C              PIC X(5).
   959
   960 01  DATA-LINE-13A.
   961     12  FILLER                  PIC X(26)   VALUE SPACES.
   962     12  FILLER                  PIC X(9)    VALUE 'FACE'.
   963     12  DL-13A-BENF     OCCURS 8 TIMES.
   964         16  DL-13A-BF           PIC Z(7).
   965         16  DL-13A-FIL          PIC X(3).
   966
   967 01  DATA-LINE-14.
   968     12  FILLER                  PIC X(11)   VALUE SPACES.
   969     12  DL-14-OVRD              PIC X(06).
   970     12  FILLER                  PIC X(18)
   971         VALUE ' RATES BY MONTHS'.
   972
   973 01  TRAILER-LINE.
   974     12  FILLER                  PIC X(110) VALUE SPACES.
   975     12  TRAILER-DESC            PIC X(12)  VALUE SPACES.
   976     12  TRAILER-DETL            PIC X(8)   VALUE SPACES.
   977
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  22
* ECS072A.cbl
   979 01  HEAD-1.
   980     12  FILLER                  PIC X(45)   VALUE SPACES.
   981     12  H1-OVRD-1               PIC X(12).
   982     12  FILLER                  PIC X(05)   VALUE ' AND '.
   983     12  H1-OVRD-2               PIC X(12).
   984     12  FILLER                  PIC X(06)   VALUE ' RATES'.
   985     12  FILLER                  PIC X(39)   VALUE SPACES.
   986     12  FILLER                  PIC X(8)    VALUE 'ECS072 '.
   987
   988 01  HEAD-2.
   989     12  FILLER                  PIC X(47)   VALUE SPACES.
   990     12  H1-A                    PIC X(30).
   991     12  FILLER                  PIC X(42)   VALUE SPACES.
   992     12  H2-DATE                 PIC X(8).
   993
   994 01  HEAD-2A.
   995     12  FILLER                  PIC X(53)   VALUE SPACES.
   996     12  H2A-DATE                PIC X(18).
   997     12  FILLER                  PIC X(48)   VALUE SPACES.
   998     12  FILLER                  PIC X(5)    VALUE 'PAGE '.
   999     12  DL-1D                   PIC ZZ,ZZ9.
  1000
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  23
* ECS072A.cbl
  1002 01  PRETTY-DATE.
  1003     12  PRETTY-MO               PIC Z9.
  1004     12  FILLER                  PIC X       VALUE '-'.
  1005     12  PRETTY-DAY              PIC 99.
  1006     12  FILLER                  PIC X       VALUE '-'.
  1007     12  PRETTY-YR               PIC 99.
  1008
  1009 01  L1-CUR-DTE.
  1010     12  FILLER      PIC X(27)
  1011         VALUE 'THESE ARE THE CURRENT RATES'.
  1012
  1013 01  L1-DATER.
  1014     12  FILLER                  PIC X(20)
  1015         VALUE 'THESE RATES EXPIRED'.
  1016     12  L1D-FILL                PIC X(8).
  1017
* 1018                                 COPY ELCDATE.
  1019******************************************************************06/11/98
  1020*                                                                *ELCDATE
  1021*                                                                *ELCDATE
  1022*                            ELCDATE.                            *   LV023
  1023*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL*16
  1024*                            VMOD=2.003                           ELCDATE
  1025*                                                                *ELCDATE
  1026*                                                                *ELCDATE
  1027*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *ELCDATE
  1028*                 LENGTH = 200                                   *   CL*19
  1029******************************************************************ELCDATE
  1030                                                                  ELCDATE
  1031 01  DATE-CONVERSION-DATA.                                        ELCDATE
  1032     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.    CL*19
  1033     12  DC-OPTION-CODE                PIC X.                        CL*15
  1034         88  BIN-TO-GREG                VALUE ' '.                ELCDATE
  1035         88  ELAPSED-BETWEEN-BIN        VALUE '1'.                ELCDATE
  1036         88  EDIT-GREG-TO-BIN           VALUE '2'.                ELCDATE
  1037         88  YMD-GREG-TO-BIN            VALUE '3'.                ELCDATE
  1038         88  MDY-GREG-TO-BIN            VALUE '4'.                ELCDATE
  1039         88  JULIAN-TO-BIN              VALUE '5'.                ELCDATE
  1040         88  BIN-PLUS-ELAPSED           VALUE '6'.                ELCDATE
  1041         88  FIND-CENTURY               VALUE '7'.                   CL*22
  1042         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.                ELCDATE
  1043         88  EDIT-GREG-TO-BIN-3         VALUE '9'.                ELCDATE
  1044         88  YMD-GREG-TO-BIN-3          VALUE 'A'.                ELCDATE
  1045         88  MDY-GREG-TO-BIN-3          VALUE 'B'.                ELCDATE
  1046         88  JULIAN-TO-BIN-3            VALUE 'C'.                ELCDATE
  1047         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.                ELCDATE
  1048         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.                   CL*14
  1049         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.                   CL*14
  1050         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.                   CL*14
  1051         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.         CL*14
  1052         88  CHECK-LEAP-YEAR            VALUE 'H'.                   CL*14
  1053         88  BIN-3-TO-GREG              VALUE 'I'.                   CL*14
  1054         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.                   CL*14
  1055         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.                   CL*14
  1056         88  CYMD-GREG-TO-BIN           VALUE 'L'.                   CL*14
  1057         88  MDCY-GREG-TO-BIN           VALUE 'M'.                   CL*14
  1058         88  MDY-GREG-TO-JULIAN         VALUE 'N'.                   CL*14
  1059         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.                   CL*14
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  24
* ECS072A.cbl (/apps/prod/cid1p/copy/ELCDATE)
  1060         88  YMD-GREG-TO-JULIAN         VALUE 'P'.                   CL*14
  1061         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.                   CL*14
  1062         88  THREE-CHARACTER-BIN                                  ELCDATE
  1063                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.       CL*14
  1064         88  GREGORIAN-TO-BIN                                        CL**2
  1065                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.    CL*14
  1066         88  BIN-TO-GREGORIAN                                        CL**2
  1067                  VALUES ' ' '1' 'I' '8' 'G'.                        CL*14
  1068         88  JULIAN-TO-BINARY                                        CL**2
  1069                  VALUES '5' 'C' 'E' 'F'.                            CL*14
  1070     12  DC-ERROR-CODE                 PIC X.                        CL*15
  1071         88  NO-CONVERSION-ERROR        VALUE ' '.                   CL**3
  1072         88  DATE-CONVERSION-ERROR                                ELCDATE
  1073                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.        CL*14
  1074         88  DATE-IS-ZERO               VALUE '1'.                ELCDATE
  1075         88  DATE-IS-NON-NUMERIC        VALUE '2'.                ELCDATE
  1076         88  DATE-IS-INVALID            VALUE '3'.                ELCDATE
  1077         88  DATE1-GREATER-DATE2        VALUE '4'.                ELCDATE
  1078         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.                ELCDATE
  1079         88  DATE-INVALID-OPTION        VALUE '9'.                ELCDATE
  1080         88  INVALID-CENTURY            VALUE 'A'.                ELCDATE
  1081         88  ONLY-CENTURY               VALUE 'B'.                ELCDATE
  1082         88  ONLY-LEAP-YEAR             VALUE 'C'.                ELCDATE
  1083         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.              CL**3
  1084     12  DC-END-OF-MONTH               PIC X.                        CL*15
  1085         88  CALCULATE-END-OF-MONTH     VALUE '1'.                ELCDATE
  1086     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.         CL*15
  1087         88  USE-NORMAL-PROCESS         VALUE ' '.                ELCDATE
  1088         88  ADJUST-DOWN-100-YRS        VALUE '1'.                ELCDATE
  1089         88  ADJUST-UP-100-YRS          VALUE '2'.                ELCDATE
  1090     12  FILLER                        PIC X.                        CL*15
  1091     12  DC-CONVERSION-DATES.                                        CL*15
  1092         16  DC-BIN-DATE-1             PIC XX.                       CL*15
  1093         16  DC-BIN-DATE-2             PIC XX.                       CL*15
  1094         16  DC-GREG-DATE-1-EDIT       PIC X(08).                    CL*15
  1095         16  DC-GREG-DATE-1-EDIT-R REDEFINES                         CL*15
  1096                       DC-GREG-DATE-1-EDIT.                       ELCDATE
  1097             20  DC-EDIT1-MONTH        PIC 99.                       CL*15
  1098             20  SLASH1-1              PIC X.                        CL*15
  1099             20  DC-EDIT1-DAY          PIC 99.                       CL*15
  1100             20  SLASH1-2              PIC X.                        CL*15
  1101             20  DC-EDIT1-YEAR         PIC 99.                       CL*15
  1102         16  DC-GREG-DATE-2-EDIT       PIC X(08).                    CL*15
  1103         16  DC-GREG-DATE-2-EDIT-R REDEFINES                         CL*15
  1104                     DC-GREG-DATE-2-EDIT.                         ELCDATE
  1105             20  DC-EDIT2-MONTH        PIC 99.                       CL*15
  1106             20  SLASH2-1              PIC X.                        CL*15
  1107             20  DC-EDIT2-DAY          PIC 99.                       CL*15
  1108             20  SLASH2-2              PIC X.                        CL*15
  1109             20  DC-EDIT2-YEAR         PIC 99.                       CL*15
  1110         16  DC-GREG-DATE-1-YMD        PIC 9(06).                    CL*15
  1111         16  DC-GREG-DATE-1-YMD-R  REDEFINES                         CL*15
  1112                     DC-GREG-DATE-1-YMD.                          ELCDATE
  1113             20  DC-YMD-YEAR           PIC 99.                       CL*15
  1114             20  DC-YMD-MONTH          PIC 99.                       CL*15
  1115             20  DC-YMD-DAY            PIC 99.                       CL*15
  1116         16  DC-GREG-DATE-1-MDY        PIC 9(06).                    CL*15
  1117         16  DC-GREG-DATE-1-MDY-R REDEFINES                          CL*15
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  25
* ECS072A.cbl (/apps/prod/cid1p/copy/ELCDATE)
  1118                      DC-GREG-DATE-1-MDY.                         ELCDATE
  1119             20  DC-MDY-MONTH          PIC 99.                       CL*15
  1120             20  DC-MDY-DAY            PIC 99.                       CL*15
  1121             20  DC-MDY-YEAR           PIC 99.                       CL*15
  1122         16  DC-GREG-DATE-1-ALPHA.                                   CL*15
  1123             20  DC-ALPHA-MONTH        PIC X(10).                    CL*15
  1124             20  DC-ALPHA-DAY          PIC 99.                       CL*15
  1125             20  FILLER                PIC XX.                       CL*15
  1126             20  DC-ALPHA-CENTURY.                                   CL*15
  1127                 24 DC-ALPHA-CEN-N     PIC 99.                       CL*15
  1128             20  DC-ALPHA-YEAR         PIC 99.                       CL*15
  1129         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.           CL*15
  1130         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.           CL*15
  1131         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.           CL*15
  1132         16  DC-JULIAN-DATE            PIC 9(05).                    CL*15
  1133         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE                CL*20
  1134                                       PIC 9(05).                    CL*20
  1135         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.                  CL*15
  1136             20  DC-JULIAN-YEAR        PIC 99.                       CL*15
  1137             20  DC-JULIAN-DAYS        PIC 999.                      CL*15
  1138         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.       CL*15
  1139         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.    CL*15
  1140         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.    CL*15
  1141     12  DATE-CONVERSION-VARIBLES.                                   CL*15
  1142         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.            CL*15
  1143         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.          CL*15
  1144             20  FILLER                PIC 9(3).                     CL*15
  1145             20  HOLD-CEN-1-CCYY.                                    CL*15
  1146                 24  HOLD-CEN-1-CC     PIC 99.                       CL*17
  1147                 24  HOLD-CEN-1-YY     PIC 99.                       CL*17
  1148             20  HOLD-CEN-1-MO         PIC 99.                       CL*17
  1149             20  HOLD-CEN-1-DA         PIC 99.                       CL*17
  1150         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.            CL*15
  1151             20  HOLD-CEN-1-R-MO       PIC 99.                       CL*17
  1152             20  HOLD-CEN-1-R-DA       PIC 99.                       CL*17
  1153             20  HOLD-CEN-1-R-CCYY.                                  CL*15
  1154                 24  HOLD-CEN-1-R-CC   PIC 99.                       CL*17
  1155                 24  HOLD-CEN-1-R-YY   PIC 99.                       CL*17
  1156             20  FILLER                PIC 9(3).                     CL*15
  1157         16  HOLD-CENTURY-1-X.                                       CL*15
  1158             20  FILLER                PIC X(3)  VALUE SPACES.       CL*15
  1159             20  HOLD-CEN-1-X-CCYY.                                  CL*15
  1160                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.          CL*17
  1161                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.          CL*17
  1162             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.          CL*17
  1163             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.          CL*17
  1164         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.          CL*15
  1165             20  HOLD-CEN-1-R-X-MO     PIC XX.                       CL*17
  1166             20  HOLD-CEN-1-R-X-DA     PIC XX.                       CL*17
  1167             20  HOLD-CEN-1-R-X-CCYY.                                CL*15
  1168                 24  HOLD-CEN-1-R-X-CC PIC XX.                       CL*17
  1169                 24  HOLD-CEN-1-R-X-YY PIC XX.                       CL*17
  1170             20  FILLER                PIC XXX.                      CL*23
  1171         16  DC-BIN-DATE-EXPAND-1      PIC XXX.                      CL*15
  1172         16  DC-BIN-DATE-EXPAND-2      PIC XXX.                      CL*15
  1173         16  DC-JULIAN-DATE-1          PIC 9(07).                    CL*15
  1174         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.          CL*15
  1175             20  DC-JULIAN-1-CCYY.                                   CL*15
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  26
* ECS072A.cbl (/apps/prod/cid1p/copy/ELCDATE)
  1176                 24  DC-JULIAN-1-CC    PIC 99.                       CL*15
  1177                 24  DC-JULIAN-1-YR    PIC 99.                       CL*15
  1178             20  DC-JULIAN-DA-1        PIC 999.                      CL*15
  1179         16  DC-JULIAN-DATE-2          PIC 9(07).                    CL*15
  1180         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.          CL*15
  1181             20  DC-JULIAN-2-CCYY.                                   CL*15
  1182                 24  DC-JULIAN-2-CC    PIC 99.                       CL*15
  1183                 24  DC-JULIAN-2-YR    PIC 99.                       CL*15
  1184             20  DC-JULIAN-DA-2        PIC 999.                      CL*15
  1185         16  DC-GREG-DATE-A-EDIT.                                    CL*15
  1186             20  DC-EDITA-MONTH        PIC 99.                       CL*15
  1187             20  SLASHA-1              PIC X VALUE '/'.              CL*15
  1188             20  DC-EDITA-DAY          PIC 99.                       CL*15
  1189             20  SLASHA-2              PIC X VALUE '/'.              CL*15
  1190             20  DC-EDITA-CCYY.                                      CL*15
  1191                 24  DC-EDITA-CENT     PIC 99.                       CL*15
  1192                 24  DC-EDITA-YEAR     PIC 99.                       CL*15
  1193         16  DC-GREG-DATE-B-EDIT.                                    CL*15
  1194             20  DC-EDITB-MONTH        PIC 99.                       CL*15
  1195             20  SLASHB-1              PIC X VALUE '/'.              CL*15
  1196             20  DC-EDITB-DAY          PIC 99.                       CL*15
  1197             20  SLASHB-2              PIC X VALUE '/'.              CL*15
  1198             20  DC-EDITB-CCYY.                                      CL*15
  1199                 24  DC-EDITB-CENT     PIC 99.                       CL*15
  1200                 24  DC-EDITB-YEAR     PIC 99.                       CL*15
  1201         16  DC-GREG-DATE-CYMD         PIC 9(08).                    CL*15
  1202         16  DC-GREG-DATE-CYMD-R REDEFINES                           CL*15
  1203                              DC-GREG-DATE-CYMD.                  ELCDATE
  1204             20  DC-CYMD-CEN           PIC 99.                       CL*15
  1205             20  DC-CYMD-YEAR          PIC 99.                       CL*15
  1206             20  DC-CYMD-MONTH         PIC 99.                       CL*15
  1207             20  DC-CYMD-DAY           PIC 99.                       CL*15
  1208         16  DC-GREG-DATE-MDCY         PIC 9(08).                    CL*15
  1209         16  DC-GREG-DATE-MDCY-R REDEFINES                           CL*15
  1210                              DC-GREG-DATE-MDCY.                  ELCDATE
  1211             20  DC-MDCY-MONTH         PIC 99.                       CL*15
  1212             20  DC-MDCY-DAY           PIC 99.                       CL*15
  1213             20  DC-MDCY-CEN           PIC 99.                       CL*15
  1214             20  DC-MDCY-YEAR          PIC 99.                       CL*15
  1215    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.      ELCDATE
  1216        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.        ELCDATE
  1217    12  DC-EL310-DATE                  PIC X(21).                    CL*26
  1218    12  FILLER                         PIC X(28).                    CL*26
  1219
  1220 PROCEDURE DIVISION.
  1221
  1222 0100-GET-CLAS-CARD.
  1223
* 1224     COPY ELCDTERX.
  1225******************************************************************04/15/98
  1226*                                                                *ELCDTERX
  1227*                                                                *ELCDTERX
  1228*                            ELCDTERX.                           *   LV002
  1229*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  1230*                            VMOD=2.007                          *ELCDTERX
  1231*                                                                *ELCDTERX
  1232*      LOAD DATE CARD DISK FILE INTO WORKING STORAGE AREA        *ELCDTERX
  1233*      (COPY CODE FOR W/S = ELCDTECX AND COPY CODE FOR FD        *ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  27
* ECS072A.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  1234*      = ELCDTEFD)                                               *ELCDTERX
  1235*                                                                *ELCDTERX
  1236******************************************************************ELCDTERX
  1237                                                                  ELCDTERX
  1238     ACCEPT WS-ACCEPT-DATE       FROM  DATE.                      ELCDTERX
  1239                                                                  ELCDTERX
  1240     MOVE WS-AD-YY               TO  WS-CD-YY.                    ELCDTERX
  1241     MOVE WS-AD-MM               TO  WS-CD-MM.                    ELCDTERX
  1242     MOVE WS-AD-DD               TO  WS-CD-DD.                    ELCDTERX
  1243                                                                  ELCDTERX
  1244     ACCEPT WS-TIME-OF-DAY       FROM  TIME.                      ELCDTERX
  1245                                                                  ELCDTERX
  1246******************************************************************ELCDTERX
  1247*    NOTE: THE FOLLOWING STATEMENT IS USED TO ELIMINATE COB II    ELCDTERX
  1248*          WARNING MESSAGES.                                      ELCDTERX
  1249******************************************************************ELCDTERX
  1250     IF WS-CD-YY = LOW-VALUES                                     ELCDTERX
  1251         COMPUTE PGM-SUB = PGM-SUB + 1.                           ELCDTERX
  1252                                                                  ELCDTERX
  1253     OPEN INPUT DISK-DATE.                                        ELCDTERX
  1254                                                                  ELCDTERX
  1255     MOVE SPACE TO DATE-CARD         CLAS-BUSINESS-CLASSES        ELCDTERX
  1256                   STATE-NAMES       CLAS-MORTALITY-CODES         ELCDTERX
  1257                   CLAS-INS-TYPES    COMPANY-NAME-TABLE           ELCDTERX
  1258                   DATE-CARD-OPTIONS DATE-CARD-FACTORS            ELCDTERX
  1259                   CLAX-ID           CLAS-MISC                    ELCDTERX
  1260                   CARRIER-NAMES     CLASIC-SYSTEM-CODES          ELCDTERX
  1261                   CARRIER-OPT-CLAIM-DATA                         ELCDTERX
  1262                   STATE-TARGET-LOSS-RATIOS                       ELCDTERX
  1263                   BUSINESS-TRGT-LOSS-RATIO-MODS                  ELCDTERX
  1264                   MISC-OPT-CLM-RSV-DATA.                         ELCDTERX
  1265                                                                  ELCDTERX
  1266     MOVE LOW-VALUES TO CLAS-INDEX-TBL CLAS-TYPE-MISC.            ELCDTERX
  1267                                                                  ELCDTERX
  1268     MOVE ZERO TO CLAS-CN DTE-TOT-LINES CLAS-CO                   ELCDTERX
  1269                  INDEXCA INDEXBS INDEXST.                        ELCDTERX
  1270                                                                  ELCDTERX
  1271     COMPUTE CLAS-CN = PGM-SUB / +50.                             ELCDTERX
  1272     COMPUTE CLAS-CO = PGM-SUB / +20.                             ELCDTERX
  1273     COMPUTE CLAS-INDEXEN = PGM-SUB - (CLAS-CN * +50).            ELCDTERX
  1274     COMPUTE CLAS-INDEXON = PGM-SUB - (CLAS-CO * +20).            ELCDTERX
  1275                                                                  ELCDTERX
  1276     IF CLAS-INDEXEN = ZERO                                       ELCDTERX
  1277         MOVE +50               TO CLAS-INDEXEN                   ELCDTERX
  1278     ELSE                                                         ELCDTERX
  1279         ADD +1                 TO CLAS-CN.                       ELCDTERX
  1280                                                                  ELCDTERX
  1281     IF CLAS-INDEXON = ZERO                                       ELCDTERX
  1282         MOVE +20               TO CLAS-INDEXON                   ELCDTERX
  1283     ELSE                                                         ELCDTERX
  1284         ADD +1                 TO CLAS-CO.                       ELCDTERX
  1285                                                                  ELCDTERX
  1286 0005-READ--CARD.                                                 ELCDTERX
  1287     READ DISK-DATE                                               ELCDTERX
  1288         AT END CLOSE DISK-DATE                                   ELCDTERX
  1289             GO TO 0060-READ--TEST.                               ELCDTERX
  1290                                                                  ELCDTERX
  1291     MOVE ZERO                   TO CLAS-INDEX.                   ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  28
* ECS072A.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  1292                                                                  ELCDTERX
  1293     IF DD-ID = 'CLAS' OR 'LIFE' OR 'GLED'                        ELCDTERX
  1294         MOVE DATE-DISK          TO DATE-CARD                     ELCDTERX
  1295         MOVE RUN-DATE           TO WS-RUN-DATE-N                    CL**2
  1296         MOVE EP-DT              TO WS-EP-DT-N                       CL**2
  1297         GO TO 0005-READ--CARD.                                   ELCDTERX
  1298                                                                  ELCDTERX
  1299     IF DD-ID = 'CLAD'                                            ELCDTERX
  1300         MOVE DATE-DISK          TO DATE-CARD-OPTIONS             ELCDTERX
  1301         GO TO 0005-READ--CARD.                                   ELCDTERX
  1302                                                                  ELCDTERX
  1303     IF DD-ID = 'CLAX'                                            ELCDTERX
  1304         MOVE DATE-DISK          TO CLAS-INDEX-TBL                ELCDTERX
  1305         GO TO 0005-READ--CARD.                                   ELCDTERX
  1306                                                                  ELCDTERX
  1307     IF DD-ID = 'CLAF'                                            ELCDTERX
  1308         MOVE DATE-DISK          TO DATE-CARD-FACTORS             ELCDTERX
  1309         GO TO 0005-READ--CARD.                                   ELCDTERX
  1310                                                                  ELCDTERX
  1311     IF DD-ID = 'CLAC'                                            ELCDTERX
  1312         GO TO 0010-READ--CLAC.                                   ELCDTERX
  1313                                                                  ELCDTERX
  1314     IF DD-ID = 'CARR'                                            ELCDTERX
  1315         GO TO 0015-READ--CARR.                                   ELCDTERX
  1316                                                                  ELCDTERX
  1317     IF DD-ID = 'STAT'                                            ELCDTERX
  1318         GO TO 0020-READ--STAT.                                   ELCDTERX
  1319                                                                  ELCDTERX
  1320     IF DD-ID = 'BUSC'                                            ELCDTERX
  1321         GO TO 0025-READ--BUSC.                                   ELCDTERX
  1322                                                                  ELCDTERX
  1323     IF DD-ID = 'MORT'                                            ELCDTERX
  1324         GO TO 0030-READ--MORT.                                   ELCDTERX
  1325                                                                  ELCDTERX
  1326     IF DD-ID = 'CLAI'                                            ELCDTERX
  1327         GO TO 0040-READ--CLAI.                                   ELCDTERX
  1328                                                                  ELCDTERX
  1329     IF DD-ID = 'COLC'                                            ELCDTERX
  1330         GO TO 0065-READ--COLC.                                   ELCDTERX
  1331                                                                  ELCDTERX
  1332     IF DD-IDX NUMERIC AND                                        ELCDTERX
  1333        DD-IDA = 'CL'                                             ELCDTERX
  1334         GO TO 0035-READ--CLXX.                                   ELCDTERX
  1335                                                                  ELCDTERX
  1336     IF DD-IDX NUMERIC AND                                        ELCDTERX
  1337        DD-IDA = 'PO'                                             ELCDTERX
  1338         GO TO 0050-READ--POXX.                                   ELCDTERX
  1339                                                                  ELCDTERX
  1340     IF DD-ID = 'OPCA'                                            ELCDTERX
  1341         GO TO 0070-READ--OPCA.                                   ELCDTERX
  1342                                                                  ELCDTERX
  1343     IF DD-ID = 'OPST'                                            ELCDTERX
  1344         GO TO 0072-READ--OPST.                                   ELCDTERX
  1345                                                                  ELCDTERX
  1346     IF DD-ID = 'OPBS'                                            ELCDTERX
  1347         GO TO 0074-READ--OPBS.                                   ELCDTERX
  1348                                                                  ELCDTERX
  1349     IF DD-ID = 'OPMS'                                            ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  29
* ECS072A.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  1350         MOVE DD-MISC-DATA       TO MISC-OPT-CLM-RSV-DATA.        ELCDTERX
  1351                                                                  ELCDTERX
  1352     GO TO 0005-READ--CARD.                                       ELCDTERX
  1353                                                                  ELCDTERX
  1354 0010-READ--CLAC.                                                 ELCDTERX
  1355     ADD 1                       TO CLAS-INDEXC.                  ELCDTERX
  1356     MOVE DD-CR1                 TO CNT-ID (CLAS-INDEXC).         ELCDTERX
  1357     MOVE DD-CR1N                TO CNT-NAME (CLAS-INDEXC).       ELCDTERX
  1358     ADD 1                       TO CLAS-INDEXC.                  ELCDTERX
  1359     MOVE DD-CR2                 TO CNT-ID (CLAS-INDEXC).         ELCDTERX
  1360     MOVE DD-CR2N                TO CNT-NAME (CLAS-INDEXC).       ELCDTERX
  1361     GO TO 0005-READ--CARD.                                       ELCDTERX
  1362                                                                  ELCDTERX
  1363 0015-READ--CARR.                                                 ELCDTERX
  1364     ADD 1  TO  CLAS-INDEXCN.                                     ELCDTERX
  1365     IF CLAS-INDEXCN LESS THAN +26                                ELCDTERX
  1366        MOVE DD-CARR1         TO CARRIER-SUB (CLAS-INDEXCN)
  1367        MOVE DD-CARR1S        TO CARRIER-DOM-ST (CLAS-INDEXCN)
  1368        MOVE DD-CARR1N        TO CARRIER-PIC (CLAS-INDEXCN)
  1369        MOVE DD-CARR1-UEP-PCT TO CARRIER-UEP-PCT (CLAS-INDEXCN)
  1370        MOVE DD-CARR1-R78-PCT TO CARRIER-R78-PCT (CLAS-INDEXCN)
  1371        MOVE DD-CARR1-PRO-PCT TO CARRIER-PRO-PCT (CLAS-INDEXCN)
  1372        MOVE DD-CARR1-SECPAY-SW
  1373                               TO CARRIER-SEC-PAY (CLAS-INDEXCN)
  1374     END-IF
  1375                                                                  ELCDTERX
  1376     ADD 1  TO  CLAS-INDEXCN.                                     ELCDTERX
  1377     IF CLAS-INDEXCN LESS THAN +26                                ELCDTERX
  1378        MOVE DD-CARR2         TO CARRIER-SUB (CLAS-INDEXCN)
  1379        MOVE DD-CARR2S        TO CARRIER-DOM-ST (CLAS-INDEXCN)
  1380        MOVE DD-CARR2N        TO CARRIER-PIC (CLAS-INDEXCN)
  1381        MOVE DD-CARR2-UEP-PCT TO CARRIER-UEP-PCT (CLAS-INDEXCN)
  1382        MOVE DD-CARR2-R78-PCT TO CARRIER-R78-PCT (CLAS-INDEXCN)
  1383        MOVE DD-CARR2-PRO-PCT TO CARRIER-PRO-PCT (CLAS-INDEXCN)
  1384        MOVE DD-CARR2-SECPAY-SW
  1385                              TO CARRIER-SEC-PAY (CLAS-INDEXCN)
  1386     END-IF
  1387                                                                  ELCDTERX
  1388                                                                  ELCDTERX
  1389     GO TO 0005-READ--CARD.                                       ELCDTERX
  1390                                                                  ELCDTERX
  1391 0020-READ--STAT.                                                 ELCDTERX
  1392     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  1393     IF CLAS-INDEX GREATER 3  OR                                  ELCDTERX
  1394        DD-ST (CLAS-INDEX) = SPACE                                ELCDTERX
  1395         GO TO 0005-READ--CARD.                                   ELCDTERX
  1396                                                                  ELCDTERX
  1397     ADD 1                       TO CLAS-INDEXS.                  ELCDTERX
  1398     MOVE DD-ST (CLAS-INDEX)     TO STATE-NAME-FLD (CLAS-INDEXS). ELCDTERX
  1399     GO TO 0020-READ--STAT.                                       ELCDTERX
  1400                                                                  ELCDTERX
  1401 0025-READ--BUSC.                                                 ELCDTERX
  1402     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  1403     IF CLAS-INDEX GREATER 3  OR                                  ELCDTERX
  1404        DD-ST (CLAS-INDEX) = SPACE                                ELCDTERX
  1405         GO TO 0005-READ--CARD.                                   ELCDTERX
  1406                                                                  ELCDTERX
  1407     ADD 1                       TO CLAS-INDEXB.                  ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  30
* ECS072A.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  1408     MOVE DD-ST (CLAS-INDEX)     TO CLAS-BUSC-FLD (CLAS-INDEXB).  ELCDTERX
  1409     GO TO 0025-READ--BUSC.                                       ELCDTERX
  1410                                                                  ELCDTERX
  1411 0030-READ--MORT.                                                 ELCDTERX
  1412     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  1413     IF CLAS-INDEX GREATER 2  OR                                  ELCDTERX
  1414        DD-MORT (CLAS-INDEX) = SPACE                              ELCDTERX
  1415         GO TO 0005-READ--CARD.                                   ELCDTERX
  1416                                                                  ELCDTERX
  1417     ADD 1                       TO CLAS-INDEXM.                  ELCDTERX
  1418     MOVE DD-MORT (CLAS-INDEX)   TO CLAS-MORT-FLD (CLAS-INDEXM).  ELCDTERX
  1419     GO TO 0030-READ--MORT.                                       ELCDTERX
  1420                                                                  ELCDTERX
  1421 0035-READ--CLXX.                                                 ELCDTERX
  1422     IF DD-IDX NOT = CLAS-CN                                      ELCDTERX
  1423          GO TO 0005-READ--CARD.                                  ELCDTERX
  1424                                                                  ELCDTERX
  1425     IF DD-PS-PIC (CLAS-INDEXEN) = 'X'                            ELCDTERX
  1426         DISPLAY '***********************************************'ELCDTERX
  1427         DISPLAY 'PROGRAM ECS-', PGM-SUB, ' NOT SCHEDULED TO RUN' ELCDTERX
  1428         DISPLAY '***********************************************'ELCDTERX
  1429         GO TO 0055-READ--STOP.                                   ELCDTERX
  1430                                                                  ELCDTERX
  1431     IF DD-PS-PIC (CLAS-INDEXEN) NOT LESS 'A'  AND                ELCDTERX
  1432        DD-PS-PIC (CLAS-INDEXEN) NOT GREATER 'I'                  ELCDTERX
  1433         MOVE '1'                TO DTE-FICH.                     ELCDTERX
  1434                                                                  ELCDTERX
  1435     IF DD-PS-PIC (CLAS-INDEXEN) NOT LESS 'J'  AND                ELCDTERX
  1436        DD-PS-PIC (CLAS-INDEXEN) NOT GREATER 'R'                  ELCDTERX
  1437         MOVE '2'                TO DTE-FICH.                     ELCDTERX
  1438                                                                  ELCDTERX
  1439*    MOVE DD-PS-PIC (CLAS-INDEXEN) TO DTE-PGM-OPT.                ELCDTERX
  1440     GO TO 0005-READ--CARD.                                       ELCDTERX
  1441                                                                  ELCDTERX
  1442 0040-READ--CLAI.                                                 ELCDTERX
  1443     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  1444     IF CLAS-INDEX GREATER 2  OR                                  ELCDTERX
  1445        DD-TYPE (CLAS-INDEX) = SPACE                              ELCDTERX
  1446         GO TO 0005-READ--CARD.                                   ELCDTERX
  1447                                                                  ELCDTERX
  1448     ADD 1                       TO CLAS-INDEXA.                  ELCDTERX
  1449     MOVE DD-TYPE (CLAS-INDEX) TO CLAS-ALL-TYPES (CLAS-INDEXA).   ELCDTERX
  1450     GO TO 0040-READ--CLAI.                                       ELCDTERX
  1451                                                                  ELCDTERX
  1452 0045-READ--DUMP.                                                 ELCDTERX
  1453     MOVE +999 TO WS-RETURN-CODE                                  ELCDTERX
  1454     MOVE 'MISSING AND/OR INVALID CLAS DATE CARD'                 ELCDTERX
  1455                                 TO  WS-ABEND-MESSAGE             ELCDTERX
  1456     PERFORM ABEND-PGM.                                           ELCDTERX
  1457                                                                  ELCDTERX
  1458 0050-READ--POXX.                                                 ELCDTERX
  1459     IF DD-IDX NOT = CLAS-CO                                      ELCDTERX
  1460         GO TO 0005-READ--CARD.                                   ELCDTERX
  1461                                                                  ELCDTERX
  1462     IF DD-PS-PRC (CLAS-INDEXON) = 'X'                            ELCDTERX
  1463         DISPLAY '***********************************************'ELCDTERX
  1464         DISPLAY 'ECS - ', PGM-SUB, ' IS NOT SCHEDULED TO RUN'    ELCDTERX
  1465         DISPLAY '***********************************************'ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  31
* ECS072A.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  1466         GO TO 0055-READ--STOP.                                   ELCDTERX
  1467                                                                  ELCDTERX
  1468     MOVE DD-PS-PRT (CLAS-INDEXON) TO DTE-PRT-OPT.                ELCDTERX
  1469     MOVE DD-PS-FMT (CLAS-INDEXON) TO DTE-FMT-OPT.                ELCDTERX
  1470     MOVE DD-PS-PRC (CLAS-INDEXON) TO DTE-PRC-OPT DTE-PGM-OPT.    ELCDTERX
  1471     MOVE DD-PS-TOT (CLAS-INDEXON) TO DTE-TOT-OPT.                ELCDTERX
  1472                                                                  ELCDTERX
  1473     IF DTE-PRT-OPT = 'B'                                         ELCDTERX
  1474         MOVE '2'                  TO DTE-FICH.                   ELCDTERX
  1475     IF DTE-PRT-OPT = 'F'                                         ELCDTERX
  1476         MOVE '1'                  TO DTE-FICH.                   ELCDTERX
  1477                                                                  ELCDTERX
  1478     GO TO 0005-READ--CARD.                                       ELCDTERX
  1479                                                                  ELCDTERX
  1480 0055-READ--STOP.                                                 ELCDTERX
  1481     GOBACK.                                                      ELCDTERX
  1482                                                                  ELCDTERX
  1483 0060-READ--TEST.                                                 ELCDTERX
  1484     IF DATX-COD        = SPACE  OR                               ELCDTERX
  1485        CLAX-ID         = SPACE  OR                               ELCDTERX
  1486        DATE-OPTIONS-ID = SPACE                                   ELCDTERX
  1487         GO TO 0045-READ--DUMP.                                   ELCDTERX
  1488                                                                  ELCDTERX
  1489     MOVE LOW-VALUE TO CLAS-TYPE-MISC.                            ELCDTERX
  1490     GO TO 0079-READ--EXIT.                                       ELCDTERX
  1491                                                                  ELCDTERX
  1492 0065-READ--COLC.                                                 ELCDTERX
  1493     MOVE DATE-DISK              TO CLASIC-SYSTEM-CODES.          ELCDTERX
  1494     GO TO 0005-READ--CARD.                                       ELCDTERX
  1495                                                                  ELCDTERX
  1496 0070-READ--OPCA.                                                 ELCDTERX
  1497                                                                  ELCDTERX
  1498     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  1499                                                                  ELCDTERX
  1500     IF  CLAS-INDEX GREATER 13                                    ELCDTERX
  1501             OR                                                   ELCDTERX
  1502         DD-CARR-FLDS (CLAS-INDEX) = SPACE                        ELCDTERX
  1503         GO TO 0005-READ--CARD.                                   ELCDTERX
  1504                                                                  ELCDTERX
  1505     ADD 1                       TO INDEXCA.                      ELCDTERX
  1506     MOVE DD-CARR-FLDS (CLAS-INDEX)                               ELCDTERX
  1507                                 TO CARRIER-FLDS (INDEXCA).       ELCDTERX
  1508     GO TO 0070-READ--OPCA.                                       ELCDTERX
  1509                                                                  ELCDTERX
  1510 0072-READ--OPST.                                                 ELCDTERX
  1511                                                                  ELCDTERX
  1512     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  1513                                                                  ELCDTERX
  1514     IF  CLAS-INDEX GREATER 16                                    ELCDTERX
  1515             OR                                                   ELCDTERX
  1516         DD-TLR (CLAS-INDEX) = SPACE                              ELCDTERX
  1517         GO TO 0005-READ--CARD.                                   ELCDTERX
  1518                                                                  ELCDTERX
  1519     ADD 1                       TO INDEXST.                      ELCDTERX
  1520     MOVE DD-STATE-FLDS (CLAS-INDEX)                              ELCDTERX
  1521                                 TO STATE-TLR-FLD (INDEXST).      ELCDTERX
  1522     GO TO 0072-READ--OPST.                                       ELCDTERX
  1523                                                                  ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  32
* ECS072A.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  1524 0074-READ--OPBS.                                                 ELCDTERX
  1525                                                                  ELCDTERX
  1526     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  1527                                                                  ELCDTERX
  1528     IF  CLAS-INDEX GREATER 32                                    ELCDTERX
  1529             OR                                                   ELCDTERX
  1530         DD-TLR (CLAS-INDEX) = SPACE                              ELCDTERX
  1531         GO TO 0005-READ--CARD.                                   ELCDTERX
  1532                                                                  ELCDTERX
  1533     ADD 1                       TO INDEXBS.                      ELCDTERX
  1534     MOVE DD-TLR (CLAS-INDEX)    TO BUS-TLRM-FLD (INDEXBS).       ELCDTERX
  1535     GO TO 0074-READ--OPBS.                                       ELCDTERX
  1536                                                                  ELCDTERX
  1537 0079-READ--EXIT.                                                 ELCDTERX
  1538*    EXIT.                                                        ELCDTERX
  1539******************************************************************ELCDTERX
  1540
  1541     MOVE COMPANY-NAME           TO H1-A.
  1542     MOVE ALPH-DATE              TO H2A-DATE.
  1543     MOVE CLAS-STARTM            TO CLAS-INDEXM.
  1544
  1545 0110-SPACE-PRNT-ROUTINE.
  1546
  1547     MOVE 1                      TO CTR.
  1548     PERFORM 0120-SPACER-RTN 8 TIMES.
  1549     MOVE SPACE TO DL-10C (9) DL-10C (10) DL-10C (11) DL-10C (12).
  1550     GO TO 0140-OPEN-FILES.
  1551
  1552 0120-SPACER-RTN.
  1553
  1554     MOVE SPACES TO DL-5C (CTR)  DL-6C (CTR)  DL-7C (CTR).
  1555     MOVE SPACES TO DL-10C (CTR)  DL-12C (CTR)  DL-13C (CTR).
  1556     ADD 1 TO CTR.
  1557
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  33
* ECS072A.cbl
  1559 0140-OPEN-FILES.
  1560
  1561     OPEN INPUT RT-JOURNAL-IN
  1562         OUTPUT PRINTX.
  1563
  1564     MOVE WS-CURRENT-DATE        TO H2-DATE.
  1565     MOVE LOW-VALUES             TO RT-CONTROL-PRIMARY.
  1566     MOVE DTE-CLASIC-COMPANY-CD  TO RT-COMPANY-CD.
  1567
  1568 0150-READ-MASTER-RATE.
  1569
  1570     READ RT-JOURNAL-IN AT END
  1571        GO TO 0510-EOJ-CLOSER
  1572     END-READ
  1573
  1574     MOVE rt-jp-rest-of-rec      TO JOURNAL-RECORD
  1575     MOVE JP-RECORD-AREA         TO RATE-record
  1576
  1577     IF RT-COMPANY-CD NOT = DTE-CLASIC-COMPANY-CD
  1578        GO TO 0150-READ-MASTER-RATE
  1579     END-IF
  1580
* 1581     COPY ELCRTEM1.
  1582******************************************************************04/16/98
  1583*                                                                *ELCRTEM1
  1584*                                                                *ELCRTEM1
  1585*                            ELCRTEM1                            *   LV002
  1586*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  1587*                            VMOD=2.001                          *ELCRTEM1
  1588*                                                                *ELCRTEM1
  1589*   COPY FILE VARIABLES TO WORKING STORAGE                       *ELCRTEM1
  1590*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCRTEM1
  1591*                                                                *ELCRTEM1
  1592******************************************************************ELCRTEM1
  1593     MOVE RT-EXPIRY-DATE    TO  WS-RT-EXPIRY-DATE-N.                 CL**2
  1594
  1595     add 1 to ws-records-processed
  1596     MOVE RT-ST-CODE             TO DL-1AA.
  1597     MOVE RT-ST-DEV              TO DL-DEV.
  1598     MOVE RT-STATE-CODE          TO STATE-L.
  1599
  1600 0160-LOOK-UP-STATE.
* 1601                             COPY ECSSTLOK.
  1602******************************************************************07/10/97
  1603*                                                                *ECSSTLOK
  1604*                            ECSSTLOK                            *   LV001
  1605*                            VMOD=2.001                         * ECSSTLOK
  1606*                                                                *ECSSTLOK
  1607*  NO  CID  MODS  IN  COPYBOOK  ECSSTLOK                         *ECSSTLOK
  1608*                                                                *ECSSTLOK
  1609******************************************************************ECSSTLOK
  1610 STATE--START.                                                    ECSSTLOK
  1611     MOVE ZERO TO CLAS-INDEXS.                                    ECSSTLOK
  1612                                                                  ECSSTLOK
  1613 STATE--LOOP.                                                     ECSSTLOK
  1614     ADD 1 TO CLAS-INDEXS.                                        ECSSTLOK
  1615     IF CLAS-INDEXS IS GREATER THAN CLAS-MAXS                     ECSSTLOK
  1616         MOVE SPACE TO STATE-L                                    ECSSTLOK
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  34
* ECS072A.cbl (/apps/prod/cid1p/copy/ECSSTLOK)
  1617         GO TO STATE--EXIT.                                       ECSSTLOK
  1618                                                                  ECSSTLOK
  1619     IF STATE-L NOT = STATE-SUB (CLAS-INDEXS)                     ECSSTLOK
  1620         GO TO STATE--LOOP.                                       ECSSTLOK
  1621                                                                  ECSSTLOK
  1622 STATE--EXIT.                                                     ECSSTLOK
  1623     EXIT.
  1624******************************************************************ECSSTLOK
  1625
  1626     MOVE STATE-PIC (CLAS-INDEXS) TO DL-1A.
  1627
  1628     IF RT-EXP-DA = 99
  1629         MOVE L1-CUR-DTE         TO DL-1DTE
  1630     ELSE
  1631         MOVE RT-EXP-YR          TO PRETTY-YR
  1632         MOVE RT-EXP-MO          TO PRETTY-MO
  1633         MOVE RT-EXP-DA          TO PRETTY-DAY
  1634         MOVE PRETTY-DATE        TO L1D-FILL
  1635         MOVE L1-DATER           TO DL-1DTE.
  1636
  1637     MOVE PAGER                  TO DL-1D.
  1638     ADD 1 TO PAGER.
  1639     MOVE ZEROS                  TO LINE-CNT.
  1640     MOVE '1'                    TO X.
  1641     MOVE LIFE-OVERRIDE-L12      TO H1-OVRD-1.
  1642     MOVE   AH-OVERRIDE-L12      TO H1-OVRD-2.
  1643     MOVE HEAD-1                 TO P-DATA.
  1644     PERFORM 0260-PRT-RTN THRU 0270-PRT-RTN-EXIT.
  1645     MOVE HEAD-2                 TO P-DATA.
  1646     PERFORM 0260-PRT-RTN THRU 0270-PRT-RTN-EXIT.
  1647     MOVE HEAD-2A                TO P-DATA.
  1648     PERFORM 0260-PRT-RTN THRU 0270-PRT-RTN-EXIT.
  1649     MOVE '0'                    TO X.
  1650
  1651     move jp-user-id             to dl0-user
  1652     move jp-program-id          to dl0-program
  1653     move jp-time                to dl0-time
  1654     move jp-date                to dc-julian-date
  1655     move '5'                    to dc-option-code
  1656     perform 8500-date-convert   thru 8500-exit
  1657     if no-conversion-error
  1658        move dc-greg-date-a-edit to dl0-date
  1659     else
  1660        move 'xx/xx/xxxx'        to dl0-date
  1661     end-if
  1662     evaluate jp-record-type
  1663        when 'A'
  1664           MOVE 'NEW RECORD IMAGE'
  1665                                 TO DL0-COMMENT
  1666        WHEN 'B'
  1667           MOVE 'BEFORE IMAGE'   TO DL0-COMMENT
  1668        WHEN 'C'
  1669           MOVE 'AFTER IMAGE'    TO DL0-COMMENT
  1670        WHEN 'D'
  1671           MOVE 'DELETED IMAGE'  TO DL0-COMMENT
  1672        WHEN OTHER
  1673           MOVE 'UNIDENTIFIED'   TO DL0-COMMENT
  1674     end-evaluate
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  35
* ECS072A.cbl
  1675
  1676     move data-line-0            to p-data
  1677     perform 0260-prt-rtn        thru 0270-prt-rtn-exit
  1678
  1679     MOVE RT-ST-CLASS            TO DL-CLASS.
  1680     MOVE RT-HIGH-AGE            TO DL-HI-AGE.
  1681     MOVE RT-STRUCTURE-COMMENT   TO DL-COMNT.
  1682
  1683     MOVE DATA-LINE-1            TO P-DATA.
  1684     PERFORM 0260-PRT-RTN THRU 0270-PRT-RTN-EXIT.
  1685     MOVE DATA-LINE-1A           TO P-DATA.
  1686     PERFORM 0260-PRT-RTN THRU 0270-PRT-RTN-EXIT.
  1687     MOVE '0'                    TO X.
  1688     IF RT-L-AH NOT = 'L'
  1689         GO TO 0220-DOING-A-AND-H.
  1690
  1691 0170-PRINT-THIS-LIFE.
  1692
  1693     MOVE RT-LAH-NUM             TO DL-2A.
  1694     MOVE LIFE-OVERRIDE-L12      TO DL-2-OVRD.
  1695     PERFORM 0440-FIND-L-NAME THRU 0460-E-F-L-NAME.
  1696     MOVE RT-RATE-COMMENT        TO DL-2A-COMNT.
  1697     MOVE DATA-LINE-2            TO P-DATA.
  1698     PERFORM 0260-PRT-RTN THRU 0270-PRT-RTN-EXIT.
  1699     MOVE SPACES                 TO DL-4B.
  1700
  1701     IF RT-LIFE-MORT-CODE NOT = CLAS-MORT-CODE (CLAS-INDEXM)
  1702         MOVE CLAS-STARTM        TO CLAS-INDEXM.
  1703
  1704 0180-MORT-DESC-LOOP.
  1705
  1706     IF RT-LIFE-MORT-CODE = CLAS-MORT-CODE (CLAS-INDEXM)
  1707         MOVE CLAS-MORT-DESC (CLAS-INDEXM) TO DL-4B
  1708     ELSE
  1709         ADD +1 TO CLAS-INDEXM
  1710         IF CLAS-INDEXM NOT GREATER THAN CLAS-MAXM
  1711             GO TO 0180-MORT-DESC-LOOP.
  1712
  1713     MOVE LIFE-OVERRIDE-L6       TO DL-4-OVRD.
  1714     MOVE RT-LIFE-MORT-CODE      TO DL-4C.
  1715     MOVE DATA-LINE-4            TO P-DATA.
  1716     PERFORM 0260-PRT-RTN THRU 0270-PRT-RTN-EXIT.
  1717     MOVE RT-MAX-AGE             TO DL-4AGE.
  1718     MOVE DATA-LINE-4A           TO P-DATA.
  1719     PERFORM 0260-PRT-RTN THRU 0270-PRT-RTN-EXIT.
  1720     MOVE 1                      TO CTS.
  1721     PERFORM 0320-L-X-AGE 8 TIMES.
  1722     MOVE DATA-LINE-5            TO P-DATA.
  1723     PERFORM 0260-PRT-RTN THRU 0270-PRT-RTN-EXIT.
  1724     MOVE 1                      TO CTS.
  1725     PERFORM 0340-L-X-TERM 8 TIMES.
  1726     MOVE DATA-LINE-6            TO P-DATA.
  1727     PERFORM 0260-PRT-RTN THRU 0270-PRT-RTN-EXIT.
  1728     MOVE 1                      TO CTS.
  1729     PERFORM 0350-L-X-FACE 8 TIMES.
  1730     MOVE DATA-LINE-7            TO P-DATA.
  1731     PERFORM 0260-PRT-RTN THRU 0270-PRT-RTN-EXIT.
  1732     MOVE '-'                    TO X.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  36
* ECS072A.cbl
  1733     MOVE LIFE-OVERRIDE-L6       TO DL-8-OVRD.
  1734     MOVE DATA-LINE-8            TO P-DATA.
  1735     PERFORM 0260-PRT-RTN THRU 0270-PRT-RTN-EXIT.
  1736     MOVE '0'                    TO X.
  1737     MOVE DATA-LINE-9            TO P-DATA.
  1738     PERFORM 0260-PRT-RTN THRU 0270-PRT-RTN-EXIT.
  1739     MOVE 1                      TO CTT.
  1740
  1741 0190-CALC-YEAR-NUMBER-L.
  1742
  1743     COMPUTE WK-1 = (CTT + 11) / 12.
  1744     MOVE WK-1                   TO DL-10A.
  1745     MOVE CTT                    TO CTS.
  1746     MOVE ZERO                   TO T-FLD.
  1747     PERFORM 0330-LIFE-RATE-ADD 12 TIMES.
  1748
  1749     IF T-FLD = ZERO
  1750         ADD 12 TO CTT
  1751         GO TO 0200-CK-LIFE-END.
  1752
  1753     MOVE 1                      TO CTS.
  1754     PERFORM 0360-FILL-LIFE-RATES 12 TIMES.
  1755     MOVE DATA-LINE-10           TO P-DATA.
  1756     PERFORM 0260-PRT-RTN THRU 0270-PRT-RTN-EXIT.
  1757
  1758 0200-CK-LIFE-END.
  1759
  1760     IF CTT NOT GREATER MO-RTS
  1761         GO TO 0190-CALC-YEAR-NUMBER-L.
  1762
  1763     PERFORM 0290-TRAILER-ROUTINE THRU 0300-TRAILER-ROUTINE-X.
  1764     GO TO 0150-READ-MASTER-RATE.
  1765
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  37
* ECS072A.cbl
  1767 0220-DOING-A-AND-H.
  1768
  1769     MOVE AH-OVERRIDE-L12        TO DL-11-OVRD.
  1770     MOVE RT-LAH-NUM             TO DL-11A.
  1771     PERFORM 0470-FIND-D-NAME THRU 0490-E-F-D-NAME.
  1772     MOVE RT-RATE-COMMENT        TO DL-11A-COMM.
  1773     MOVE DATA-LINE-11           TO P-DATA.
  1774     PERFORM 0260-PRT-RTN THRU 0270-PRT-RTN-EXIT.
  1775     MOVE RT-MAX-AGE             TO DL-4AGE.
  1776     MOVE DATA-LINE-4A           TO P-DATA.
  1777     PERFORM 0260-PRT-RTN THRU 0270-PRT-RTN-EXIT.
  1778     MOVE 1                      TO CTS.
  1779     PERFORM 0380-AH-X-AGE 8 TIMES.
  1780     MOVE DATA-LINE-12           TO P-DATA.
  1781     PERFORM 0260-PRT-RTN THRU 0270-PRT-RTN-EXIT.
  1782     MOVE 1 TO CTS.
  1783     PERFORM 0390-AH-X-TERM 8 TIMES.
  1784     MOVE DATA-LINE-12A          TO P-DATA.
  1785     PERFORM 0260-PRT-RTN THRU 0270-PRT-RTN-EXIT.
  1786     MOVE 1                      TO CTS.
  1787     PERFORM 0400-AH-X-BEN 8 TIMES.
  1788     MOVE DATA-LINE-13           TO P-DATA.
  1789     PERFORM 0260-PRT-RTN THRU 0270-PRT-RTN-EXIT.
  1790     MOVE 1 TO CTS.
  1791     PERFORM 0410-AH-X-FACE 8 TIMES.
  1792     MOVE DATA-LINE-13A          TO P-DATA.
  1793     PERFORM 0260-PRT-RTN THRU 0270-PRT-RTN-EXIT.
  1794     MOVE '-'                    TO X.
  1795     MOVE AH-OVERRIDE-L6         TO DL-14-OVRD.
  1796     MOVE DATA-LINE-14           TO P-DATA.
  1797     PERFORM 0260-PRT-RTN THRU 0270-PRT-RTN-EXIT.
  1798     MOVE '0'                    TO X.
  1799     MOVE DATA-LINE-9            TO P-DATA.
  1800     PERFORM 0260-PRT-RTN THRU 0270-PRT-RTN-EXIT.
  1801     MOVE 1                      TO CTT.
  1802
  1803 0230-CALC-YEAR-NUMBER-AH.
  1804
  1805     COMPUTE WK-1 = (CTT + 11) / 12.
  1806     MOVE WK-1                   TO DL-10A.
  1807     MOVE CTT                    TO CTS.
  1808     MOVE ZERO                   TO T-FLD.
  1809     PERFORM 0370-AH-RATE-ADD 12 TIMES.
  1810
  1811     IF T-FLD = ZERO
  1812         ADD 12 TO CTT
  1813         GO TO 0240-CK-AH-END.
  1814
  1815     MOVE 1                      TO CTS.
  1816     PERFORM 0420-FILL-AH-RATES 12 TIMES.
  1817     MOVE DATA-LINE-10           TO P-DATA.
  1818     PERFORM 0260-PRT-RTN THRU 0270-PRT-RTN-EXIT.
  1819
  1820 0240-CK-AH-END.
  1821
  1822     IF CTT NOT GREATER MO-RTS
  1823         GO TO 0230-CALC-YEAR-NUMBER-AH.
  1824
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  38
* ECS072A.cbl
  1825     PERFORM 0290-TRAILER-ROUTINE THRU 0300-TRAILER-ROUTINE-X.
  1826     GO TO 0150-READ-MASTER-RATE.
  1827
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  39
* ECS072A.cbl
  1829 0260-PRT-RTN.
* 1830                                 COPY ELCPRT2.
  1831******************************************************************04/15/98
  1832*                                                                *ELCPRT2
  1833*                                                                *ELCPRT2
  1834*                            ELCPRT2                             *   LV005
  1835*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**5
  1836*                            VMOD=2.002                          *   CL**5
  1837*                                                                *   CL**4
  1838******************************************************************   CL**4
  1839                                                                     CL**4
  1840     IF DTE-FICH NOT = SPACE AND                                     CL**4
  1841        FICH-OPEN    = SPACE                                         CL**4
  1842         MOVE 'X'                TO  FICH-OPEN                       CL**4
  1843         OPEN OUTPUT FICH.                                           CL**4
  1844                                                                     CL**4
  1845     IF DTE-FICH NOT = SPACE                                         CL**4
  1846         MOVE X                  TO  P-CTL                           CL**4
  1847         WRITE FICH-REC FROM PRT.                                    CL**4
  1848                                                                     CL**4
  1849     IF DTE-FICH = SPACE OR '2'                                      CL**4
  1850       MOVE X                    TO  P-CTL                           CL**4
  1851       IF P-CTL = ' '                                                CL**4
  1852         WRITE PRT AFTER ADVANCING 1 LINE                            CL**4
  1853       ELSE                                                          CL**4
  1854         IF P-CTL = '0'                                              CL**4
  1855           WRITE PRT AFTER ADVANCING 2 LINES                         CL**4
  1856         ELSE                                                        CL**4
  1857           IF P-CTL = '-'                                            CL**4
  1858             WRITE PRT AFTER ADVANCING 3 LINES                       CL**4
  1859           ELSE                                                      CL**4
  1860             WRITE PRT AFTER ADVANCING PAGE.                         CL**4
  1861                                                                     CL**4
  1862******************************************************************   CL**4
  1863     ADD 1 TO LINE-CNT.
  1864
  1865     IF X = '0'
  1866         ADD 1 TO LINE-CNT
  1867     ELSE
  1868         IF X = '-'
  1869             ADD 2 TO LINE-CNT.
  1870
  1871     MOVE ' '                    TO X.
  1872
  1873 0270-PRT-RTN-EXIT.    EXIT.
  1874
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  40
* ECS072A.cbl
  1876 0290-TRAILER-ROUTINE.
  1877
  1878     IF LINE-CNT LESS 48
  1879         MOVE SPACES             TO P-DATA
  1880         PERFORM 0260-PRT-RTN THRU 0270-PRT-RTN-EXIT
  1881         GO TO 0290-TRAILER-ROUTINE.
  1882
  1883     MOVE 'STATE'                TO TRAILER-DESC.
  1884     MOVE RT-ST-CODE             TO TRAILER-DETL.
  1885     MOVE TRAILER-LINE           TO P-DATA.
  1886     PERFORM 0260-PRT-RTN THRU 0270-PRT-RTN-EXIT.
  1887     MOVE 'CLASS'                TO TRAILER-DESC.
  1888     MOVE RT-ST-CLASS            TO TRAILER-DETL.
  1889     MOVE TRAILER-LINE           TO P-DATA.
  1890     PERFORM 0260-PRT-RTN THRU 0270-PRT-RTN-EXIT.
  1891     MOVE 'DEVIATION'            TO TRAILER-DESC.
  1892     MOVE RT-ST-DEV              TO TRAILER-DETL.
  1893     MOVE TRAILER-LINE           TO P-DATA.
  1894     PERFORM 0260-PRT-RTN THRU 0270-PRT-RTN-EXIT.
  1895     MOVE 'TYPE'                 TO TRAILER-DESC.
  1896     MOVE RT-L-AH-CODE           TO TRAILER-DETL.
  1897     MOVE TRAILER-LINE           TO P-DATA.
  1898     PERFORM 0260-PRT-RTN THRU 0270-PRT-RTN-EXIT.
  1899     MOVE 'HIGH AGE'             TO TRAILER-DESC.
  1900     MOVE RT-HIGH-AGE            TO TRAILER-DETL.
  1901     MOVE TRAILER-LINE           TO P-DATA.
  1902     PERFORM 0260-PRT-RTN THRU 0270-PRT-RTN-EXIT.
  1903     MOVE RT-EXP-YR              TO PRETTY-YR.
  1904     MOVE RT-EXP-MO              TO PRETTY-MO.
  1905     MOVE RT-EXP-DA              TO PRETTY-DAY.
  1906     MOVE PRETTY-DATE            TO TRAILER-DETL.
  1907     MOVE 'EXP DATE'             TO TRAILER-DESC.
  1908     MOVE TRAILER-LINE           TO P-DATA.
  1909     PERFORM 0260-PRT-RTN THRU 0270-PRT-RTN-EXIT.
  1910
  1911 0300-TRAILER-ROUTINE-X.     EXIT.
  1912
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  41
* ECS072A.cbl
  1914 0320-L-X-AGE.
  1915
  1916     MOVE RT-L-EX-AGE (CTS)      TO DL-5B (CTS).
  1917     ADD 1 TO CTS.
  1918
  1919 0330-LIFE-RATE-ADD.
  1920
  1921     ADD RT-L-RATE (CTS)         TO T-FLD.
  1922     ADD 1 TO CTS.
  1923
  1924 0340-L-X-TERM.
  1925
  1926     MOVE RT-L-EX-TERM (CTS)     TO DL-6B (CTS).
  1927     ADD 1 TO CTS.
  1928
  1929 0350-L-X-FACE.
  1930
  1931     MOVE RT-L-EX-FACE (CTS)     TO DL-7B (CTS).
  1932     ADD 1 TO CTS.
  1933
  1934 0360-FILL-LIFE-RATES.
  1935
  1936     MOVE RT-L-RATE (CTT)        TO DL-10D (CTS).
  1937     ADD 1 TO CTT.
  1938     ADD 1 TO CTS.
  1939
  1940 0370-AH-RATE-ADD.
  1941
  1942     ADD RT-AH-RATE (CTS)        TO T-FLD.
  1943     ADD 1 TO CTS.
  1944
  1945 0380-AH-X-AGE.
  1946
  1947     MOVE RT-AH-AGE (CTS)        TO DL-12B (CTS).
  1948     ADD 1 TO CTS.
  1949
  1950 0390-AH-X-TERM.
  1951
  1952     MOVE RT-AH-TERM (CTS)       TO DL-12A-T (CTS).
  1953     MOVE SPACES                 TO DL-12A-FIL (CTS).
  1954     ADD 1 TO CTS.
  1955
  1956 0400-AH-X-BEN.
  1957
  1958     MOVE RT-AH-BEN-M (CTS)      TO DL-13B (CTS).
  1959     ADD 1 TO CTS.
  1960
  1961 0410-AH-X-FACE.
  1962
  1963     MOVE RT-AH-BEN-F (CTS)      TO DL-13A-BF (CTS).
  1964     MOVE SPACES                 TO DL-13A-FIL (CTS).
  1965     ADD 1 TO CTS.
  1966
  1967 0420-FILL-AH-RATES.
  1968
  1969     MOVE RT-AH-RATE (CTT)       TO DL-10D (CTS).
  1970     ADD 1 TO CTT.
  1971     ADD 1 TO CTS.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  42
* ECS072A.cbl
  1972
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  43
* ECS072A.cbl
  1974 0440-FIND-L-NAME.
  1975
  1976     MOVE SPACES                 TO DL-2B.
  1977
  1978     IF CLAS-STARTL = ZERO
  1979         GO TO 0460-E-F-L-NAME.
  1980
  1981     MOVE CLAS-STARTL            TO CLAS-INDEXL.
  1982
  1983 0450-FLN-LOOP.
  1984
  1985     IF CLAS-I-BEN (CLAS-INDEXL) = RT-LAH-NUM
  1986         MOVE CLAS-I-AB10 (CLAS-INDEXL) TO DL-2B
  1987         GO TO 0460-E-F-L-NAME.
  1988
  1989     ADD +1 TO CLAS-INDEXL.
  1990
  1991     IF CLAS-INDEXL NOT GREATER THAN CLAS-MAXL
  1992         GO TO 0450-FLN-LOOP.
  1993
  1994 0460-E-F-L-NAME.     EXIT.
  1995
  1996
  1997 0470-FIND-D-NAME.
  1998
  1999     MOVE SPACES                 TO DL-11B.
  2000
  2001     IF CLAS-STARTA = ZERO
  2002         GO TO 0490-E-F-D-NAME.
  2003
  2004     MOVE CLAS-STARTA            TO CLAS-INDEXA.
  2005
  2006 0480-FDN-LOOP.
  2007
  2008     IF CLAS-I-BEN (CLAS-INDEXA) = RT-LAH-NUM
  2009         MOVE CLAS-I-AB10 (CLAS-INDEXA) TO DL-11B
  2010         GO TO 0490-E-F-D-NAME.
  2011
  2012     ADD +1 TO CLAS-INDEXA.
  2013
  2014     IF CLAS-INDEXA NOT GREATER THAN CLAS-MAXA
  2015         GO TO 0480-FDN-LOOP.
  2016
  2017 0490-E-F-D-NAME.     EXIT.
  2018
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  44
* ECS072A.cbl
  2020 0510-EOJ-CLOSER.
  2021
  2022     if ws-records-processed = zeros
  2023        MOVE '1'                 TO X
  2024        MOVE LIFE-OVERRIDE-L12   TO H1-OVRD-1
  2025        MOVE   AH-OVERRIDE-L12   TO H1-OVRD-2
  2026        MOVE HEAD-1              TO P-DATA
  2027        PERFORM 0260-PRT-RTN THRU 0270-PRT-RTN-EXIT
  2028        MOVE HEAD-2              TO P-DATA
  2029        PERFORM 0260-PRT-RTN THRU 0270-PRT-RTN-EXIT
  2030        MOVE HEAD-2A             TO P-DATA
  2031        PERFORM 0260-PRT-RTN THRU 0270-PRT-RTN-EXIT
  2032        move '0'                 to X
  2033        move 'No changes made today '
  2034                                 to data-line-0 (17:30)
  2035        move data-line-0         to p-data
  2036        PERFORM 0260-PRT-RTN THRU 0270-PRT-RTN-EXIT
  2037     end-if
  2038
* 2039                             COPY ELCPRTC.
  2040******************************************************************04/15/98
  2041*                                                                *ELCPRTC
  2042*                                                                *ELCPRTC
  2043*                            ELCPRTC.                            *   LV003
  2044*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
  2045*                            VMOD=2.002                          *   CL**2
  2046*       CLOSE FICH FILE IF OPEN                                  *ELCPRTC
  2047*                                                                *ELCPRTC
  2048* NOTE- USE ELCPRTCX IF USING ELCPRT2X (ONLINE REPORT SAVE)      *   CL**2
  2049******************************************************************ELCPRTC
  2050                                                                  ELCPRTC
  2051      IF FICH-OPEN NOT = SPACE                                    ELCPRTC
  2052          CLOSE FICH.                                             ELCPRTC
  2053                                                                  ELCPRTC
  2054******************************************************************ELCPRTC
  2055
  2056     CLOSE rt-journal-in
  2057           PRINTX.
  2058
  2059     GOBACK.
  2060
  2061 8500-DATE-CONVERT.
  2062
  2063     CALL 'ELDATCX' USING DATE-CONVERSION-DATA
  2064
  2065     .
  2066 8500-EXIT.
  2067     EXIT.
  2068
  2069 ABEND-PGM SECTION.
*                                      COPY ELCABEND.
  2070***************************************************************** 04/14/98
  2071*                                                               * ELCABEND
  2072*                            ELCABEND.                          *    LV003
  2073*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
  2074*                            VMOD 2.002                              CL**2
  2075*                                                               * ELCABEND
  2076*                THIS SECTION DISPLAYS THE NECESSARY MESSAGES   * ELCABEND
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  45
* ECS072A.cbl (/apps/prod/cid1p/copy/ELCABEND)
  2077*            AND THEN ABENDS.                                   * ELCABEND
  2078*                                                               * ELCABEND
  2079*  NO  CID  MODS  IN  COPYBOOK  ELCABEND                        * ELCABEND
  2080*                                                               * ELCABEND
  2081***************************************************************** ELCABEND
  2082*APS-010.                                                         ELCABEND
  2083     DISPLAY WS-ABEND-MESSAGE.                                    ELCABEND
  2084     DISPLAY WS-ABEND-MESSAGE UPON CONSOLE.                       ELCABEND
  2085                                                                  ELCABEND
  2086     IF WS-ABEND-FILE-STATUS NOT = ZERO                           ELCABEND
  2087         DISPLAY 'FILE STATUS = ' WS-ABEND-FILE-STATUS            ELCABEND
  2088         DISPLAY 'FILE STATUS = ' WS-ABEND-FILE-STATUS            ELCABEND
  2089                                 UPON CONSOLE.                    ELCABEND
  2090                                                                  ELCABEND
  2091     IF WS-RETURN-CODE NOT = ZERO                                 ELCABEND
  2092         DISPLAY 'RETURN CODE = '  WS-RETURN-CODE                 ELCABEND
  2093         DISPLAY 'RETURN CODE = '  WS-RETURN-CODE                 ELCABEND
  2094                                 UPON CONSOLE.                    ELCABEND
  2095                                                                  ELCABEND
  2096     DISPLAY 'PROGRAM WILL NOW ABEND **************'              ELCABEND
  2097     DISPLAY 'PROGRAM WILL NOW ABEND **************'              ELCABEND
  2098                                 UPON CONSOLE.                    ELCABEND
  2099                                                                  ELCABEND
  2100     DIVIDE WS-ZERO BY WS-ZERO GIVING WS-ZERO.                    ELCABEND
  2101     CALL 'ABORTME'.
  2102                                                                  ELCABEND
  2103 APS-EXIT.                                                        ELCABEND
  2104     EXIT.                                                        ELCABEND
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:       56112     Code:        6746
