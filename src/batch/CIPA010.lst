* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   1
* CIPA010.cbl
* Options: int("CIPA010.int") anim csi verbose NOBOUND PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("CIPA010.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"ebmlsfile" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" NOCHECKDIV NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"32" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"CIPA010.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"CIPA010.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR NOSTICKY-LINKAGE
*          NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"2" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2 PROGRAM-ID.    CIPA010.
     3 DATE-WRITTEN.  NOV, 1999.
     4
     5*****************************************************************
     6*  N O T E:
     7*  ========
     8*  THIS PROGRAM PRODUCES REPORTS FOR SELECTED ACCOUNTS FROM
     9*  THE ECS021 FICH FILE.
    10*
    11*  MOST REPORTS ARE PRODUCED MONTHLY, SOME ARE PRODUCED
    12*  SEMI-ANNUALLY.
    13******************************************************************
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   2
* CIPA010.cbl
    14*                   C H A N G E   L O G
    15*
    16* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    17*-----------------------------------------------------------------
    18*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    19* EFFECTIVE    NUMBER
    20*-----------------------------------------------------------------
    21* 020504    2004020200016  SMVA  REMOVE OLD CODE, CHG RMRO RPT CODE TO
    22*                                -N AND -S, REMOVE SERO & ADD SAND
    23* 033004    2003081500005  PEMA  ADD CO AND IA TO
    24*                                   MWAUTO - NE FILE EXTRACT
    25* 080504    2004080400006  SMVA  ADD NCRO REPORT
    26* 032910    2010032500002  AJRA  ADD SMRO TO TOTAL
    27******************************************************************
    28*
    29 ENVIRONMENT DIVISION.
    30
    31 INPUT-OUTPUT SECTION.
    32
    33 FILE-CONTROL.
    34
    35     SELECT ECS021-FICHE
    36         ASSIGN TO SYS010.
    37
    38     SELECT TOTAL-REPORT
    39         ASSIGN TO SYS020.
    40
    41     SELECT MWAUTO-SD-REPORT
    42         ASSIGN TO SYS023.
    43
    44     SELECT MWAUTO-NE-REPORT
    45         ASSIGN TO SYS024.
    46
    47     SELECT NCRO-REPORT
    48         ASSIGN TO SYS025.
    49
    50     SELECT DISK-DATE
    51         ASSIGN TO SYS019.
    52
    53 DATA DIVISION.
    54
    55 FILE SECTION.
    56
    57 FD  DISK-DATE
*                            COPY ELCDTEFD.
    58******************************************************************04/15/98
    59*                                                                *ELCDTEFD
    60*                                                                *ELCDTEFD
    61*                            ELCDTEFD.                           *   LV002
    62*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
    63*                            VMOD=2.007                          *   CL**2
    64*                                                                *ELCDTEFD
    65******************************************************************ELCDTEFD
    66     BLOCK CONTAINS 0 RECORDS
    67     RECORDING MODE F.                                            ELCDTEFD
    68                                                                  ELCDTEFD
    69 01  DATE-DISK.                                                   ELCDTEFD
    70     12  DD-ID                       PIC  X(4).                   ELCDTEFD
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   3
* CIPA010.cbl (/apps/prod/cid1p/copy/ELCDTEFD)
    71     12  FILLER                      PIC  X(14).                  ELCDTEFD
    72     12  DD-CR1                      PIC  9.                      ELCDTEFD
    73     12  DD-CR1N                     PIC  X(30).                  ELCDTEFD
    74     12  DD-CR2                      PIC  9.                      ELCDTEFD
    75     12  DD-CR2N                     PIC  X(30).                  ELCDTEFD
    76     12  FILLER                      PIC  X(20).                  ELCDTEFD
    77                                                                  ELCDTEFD
    78 01  DATE-DISK-R.                                                 ELCDTEFD
    79     12  FILLER                      PIC  X(4).                   ELCDTEFD
    80     12  DD-ST           OCCURS 3 TIMES                           ELCDTEFD
    81                                     PIC  X(32).                  ELCDTEFD
    82                                                                  ELCDTEFD
    83 01  DATE-DISK-T.                                                 ELCDTEFD
    84     12  FILLER                      PIC  X(4).                   ELCDTEFD
    85     12  DD-TYPE         OCCURS 2 TIMES                           ELCDTEFD
    86                                     PIC  X(48).                  ELCDTEFD
    87                                                                  ELCDTEFD
    88 01  DATE-DISK-M.                                                 ELCDTEFD
    89     12  FILLER                      PIC  X(4).                   ELCDTEFD
    90     12  DD-MORT         OCCURS 2 TIMES                           ELCDTEFD
    91                                     PIC  X(48).                  ELCDTEFD
    92                                                                  ELCDTEFD
    93 01  DATE-DISK-P.                                                 ELCDTEFD
    94     12  DD-IDA                      PIC  XX.                     ELCDTEFD
    95     12  DD-IDX                      PIC  99.                     ELCDTEFD
    96     12  DD-DATA                     PIC  X(96).                  ELCDTEFD
    97     12  FILLER  REDEFINES DD-DATA.                               ELCDTEFD
    98         16  DD-PS-PIC   OCCURS 50 TIMES                          ELCDTEFD
    99                                     PIC  X.                      ELCDTEFD
   100         16  FILLER                  PIC  X(46).                  ELCDTEFD
   101     12  FILLER  REDEFINES DD-DATA.                               ELCDTEFD
   102         16  DD-PS-PICO  OCCURS 20 TIMES.                         ELCDTEFD
   103             20  DD-PS-PRT           PIC  X.                      ELCDTEFD
   104             20  DD-PS-FMT           PIC  X.                      ELCDTEFD
   105             20  DD-PS-PRC           PIC  X.                      ELCDTEFD
   106             20  DD-PS-TOT           PIC  X.                      ELCDTEFD
   107         16  FILLER                  PIC  X(16).                  ELCDTEFD
   108                                                                  ELCDTEFD
   109 01  DATE-DISK-E.                                                 ELCDTEFD
   110     12  FILLER                      PIC  X(4).                   ELCDTEFD
   111     12  DD-EDIT         OCCURS 24 TIMES                          ELCDTEFD
   112                                     PIC  X(4).                   ELCDTEFD
   113                                                                  ELCDTEFD
   114 01  DATE-DISK-C.                                                 ELCDTEFD
   115     12  FILLER                      PIC  X(7).                   ELCDTEFD
   116     12  DD-CARR1-SECPAY-SW          PIC  X.
   117     12  DD-CARR1-UEP-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   118     12  DD-CARR1-R78-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   119     12  DD-CARR1-PRO-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   120     12  DD-CARR1                    PIC  X.                      ELCDTEFD
   121     12  DD-CARR1S                   PIC  XX.                     ELCDTEFD
   122     12  DD-CARR1N                   PIC  X(30).                  ELCDTEFD
   123     12  DD-CARR2                    PIC  X.                      ELCDTEFD
   124     12  DD-CARR2S                   PIC  XX.                     ELCDTEFD
   125     12  DD-CARR2N                   PIC  X(30).                  ELCDTEFD
   126     12  DD-CARR2-UEP-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   127     12  DD-CARR2-R78-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   128     12  DD-CARR2-PRO-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   4
* CIPA010.cbl (/apps/prod/cid1p/copy/ELCDTEFD)
   129     12  DD-CARR2-SECPAY-SW          PIC  X.
   130     12  FILLER                      PIC  X(7).                   ELCDTEFD
   131                                                                  ELCDTEFD
   132 01  DATE-DISK-OPT.                                               ELCDTEFD
   133     12  FILLER                      PIC  X(04).                  ELCDTEFD
   134     12  DD-TLR-DATA.                                             ELCDTEFD
   135         16  DD-TLR                  OCCURS 32 TIMES              ELCDTEFD
   136                                     PIC  X(03).                  ELCDTEFD
   137     12  DD-STATE-DATA REDEFINES DD-TLR-DATA.                     ELCDTEFD
   138         16  DD-STATE-FLDS           OCCURS 16 TIMES              ELCDTEFD
   139                                     PIC  X(06).                  ELCDTEFD
   140     12  DD-CARR-DATA REDEFINES DD-TLR-DATA.                      ELCDTEFD
   141         16  DD-CARR-FLDS            OCCURS 13 TIMES              ELCDTEFD
   142                                     PIC  X(07).                  ELCDTEFD
   143         16  FILLER                  PIC  X(05).                  ELCDTEFD
   144     12  DD-MISC-DATA REDEFINES DD-TLR-DATA                       ELCDTEFD
   145                                     PIC  X(96).                  ELCDTEFD
   146******************************************************************ELCDTEFD
   147
   148 FD  ECS021-FICHE
   149     LABEL RECORDS ARE STANDARD
   150     RECORDING MODE IS F
   151     RECORD CONTAINS 133 CHARACTERS
   152     BLOCK CONTAINS 0 RECORDS.
   153 01  FICHE-RECORD.
   154     05  CC                  PIC X(001).
   155     05  FILLER              PIC X(132).
   156
   157 FD  TOTAL-REPORT
   158     LABEL RECORDS ARE STANDARD
   159     RECORDING MODE IS F
   160     RECORD CONTAINS 179 CHARACTERS
   161     BLOCK CONTAINS 0 RECORDS.
   162 01  TOTAL-RPT-RECORD             PIC X(179).
   163
   164 FD  MWAUTO-SD-REPORT
   165     LABEL RECORDS ARE STANDARD
   166     RECORDING MODE IS F
   167     RECORD CONTAINS 179 CHARACTERS
   168     BLOCK CONTAINS 0 RECORDS.
   169 01  MWAUTO-SD-RECORD            PIC X(179).
   170
   171 FD  MWAUTO-NE-REPORT
   172     LABEL RECORDS ARE STANDARD
   173     RECORDING MODE IS F
   174     RECORD CONTAINS 179 CHARACTERS
   175     BLOCK CONTAINS 0 RECORDS.
   176 01  MWAUTO-NE-RECORD             PIC X(179).
   177
   178 FD  NCRO-REPORT
   179     LABEL RECORDS ARE STANDARD
   180     RECORDING MODE IS F
   181     RECORD CONTAINS 179 CHARACTERS
   182     BLOCK CONTAINS 0 RECORDS.
   183 01  NCRO-RECORD                  PIC X(179).
   184
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   5
* CIPA010.cbl
   186
   187 WORKING-STORAGE SECTION.
   188
   189 01  WORK.
   190     05  EOF-SW              PIC X       VALUE 'N'.
   191         88  EOF                         VALUE 'Y'.
   192     05  WS-RETURN-CODE      PIC 99      VALUE ZEROS.
   193     05  WS-ABEND-MESSAGE    PIC X(80)   VALUE SPACES.
   194     05  PGM-SUB             PIC 999     VALUE ZEROS.
   195     05  SEL-SW              PIC X       VALUE SPACE.
   196     05  TOTAL-RPT-SW        PIC X       VALUE SPACE.
   197     05  MWAUTO-SD-SW        PIC X       VALUE SPACE.
   198     05  MWAUTO-NE-SW        PIC X       VALUE SPACE.
   199     05  NCRO-SW             PIC X       VALUE SPACE.
   200     05  SYS014-STATUS       PIC X(2)    VALUE SPACE.
   201     05  S0C7                PIC S9      COMP-3.
   202     05  SAVE-ACCOUNT-NAME   PIC X(30)   VALUE SPACE.
   203
   204 01  WS-ACCT                 PIC X(10)   VALUE SPACES.
   205     88  SD-DO-NOT-PRT   VALUE '0000013300' '0000013330'
   206                               '0000013430' '0000013450'
   207                               '0000013570' '0000013580'
   208                               '0000013600' '0000013610'
   209                               '0000013620' '0000013690'
   210                               '0000013700' '0000013720'
   211                               '0000013780' '0000013840'
   212                               '0000013850' '0000013920'
   213                               '0000013960' '0000015510'
   214                               '0000015530' '0000015720'
   215                               '0000015740' '0000018010'
   216                               '0000018050' '0000018080'
   217                               '0000018110' '0000018170'
   218                               '0000018200' '0000018210'.
   219
   220*****************************************************************
   221*   DATE CARD INFORMATION                                       *
   222*****************************************************************
   223
*  224     COPY ELCDTECX.
   225******************************************************************06/05/98
   226*                                                                *ELCDTECX
   227*                            ELCDTECX.                           *   LV005
   228*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
   229*                            VMOD=2.015                          *ELCDTECX
   230*                                                                *ELCDTECX
   231*      WORKING STORAGE COPY CODE FOR APPLICATIONS CALLING        *ELCDTECX
   232*      THE DATE CARD DISK FILE. ( READ ROUTINE = ELCDTERX,       *ELCDTECX
   233*      AND DISK FILE FD = ELCDTEFX)                              *ELCDTECX
   234*                                                                *ELCDTECX
   235******************************************************************ELCDTECX
   236******************************************************************
   237*                   C H A N G E   L O G
   238*
   239* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   240*-----------------------------------------------------------------
   241*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   242* EFFECTIVE    NUMBER
   243*-----------------------------------------------------------------
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   6
* CIPA010.cbl (/apps/prod/cid1p/copy/ELCDTECX)
   244* 092602    2002091900008  PEMA  INCREASE NUMBER OF MAXIMUM
   245*                                  BENEFIT CODES FROM 300 TO 900
   246* 090803    2003080800002  PEMA  ADD CATEGORY FOR SUPER GAP
   247* 051304    2003080800002  SMVA  ADD REFUND METHOD
   248* 071714    2013100100002  PEMA  FIX CRIT PERIOD EDITS
   249******************************************************************
   250 01  DATE-CARD.                                                   ELCDTECX
   251     12  DATX-COD                    PIC  X(4).                   ELCDTECX
   252     12  RUN-DATE                    PIC  9(11)  COMP-3.          ELCDTECX
   253     12  ALPH-DATE                   PIC  X(18).                  ELCDTECX
   254     12  EP-DT                       PIC  9(11)  COMP-3.          ELCDTECX
   255     12  PEND-ACT-FILE               PIC  XX.                     ELCDTECX
   256     12  EP-SW                       PIC  X.                      ELCDTECX
   257         88  NO-EP-EXTRACTS          VALUE SPACE.                 ELCDTECX
   258     12  TAPE-BATCHES                PIC  X.                      ELCDTECX
   259         88  TP-PREL-BAL             VALUE '1'.                   ELCDTECX
   260     12  BIN-RUN-DATE                PIC  XX.                     ELCDTECX
   261     12  RUN-CENTURY.                                             ELCDTECX
   262         16 RUN-CENTURY-N            PIC  99.                        CL**4
   263     12  FILLER                      PIC  X.                         CL**4
   264     12  CLAS-MORT-OVRD              PIC  X(4).                   ELCDTECX
   265     12  FILLER                      PIC  XXX.                    ELCDTECX
   266     12  COMPANY-NAME                PIC  X(30).                  ELCDTECX
   267                                                                  ELCDTECX
   268 01  FILLER                          PIC  X(7)                       CL**6
   269                                          VALUE 'OPTIONS'.        ELCDTECX
   270 01  DATE-CARD-OPTIONS.                                           ELCDTECX
   271     12  DATE-OPTIONS-ID             PIC  X(4).                   ELCDTECX
   272     12  DTE-MIN-PREM                PIC  99V99.                  ELCDTECX
   273     12  DTE-LANGUAGE-IND            PIC  X.                      ELCDTECX
   274         88  DTE-LANGUAGE-IS-FR           VALUE 'F'.              ELCDTECX
   275         88  DTE-LANGUAGE-IS-ENG          VALUE 'E'.              ELCDTECX
   276     12  DTE-MIN-AGE                 PIC  99.                     ELCDTECX
   277     12  DTE-DEFAULT-AGE             PIC  99.                     ELCDTECX
   278     12  FILLER                      PIC  X.                      ELCDTECX
   279     12  DTE-MAX-TERM                PIC  999.                    ELCDTECX
   280     12  DTE-COMP-VG                 PIC  X.                      ELCDTECX
   281     12  DTE-REM-TRM                 PIC  X.                      ELCDTECX
   282     12  DTE-PRM-CK                  PIC S99V99.                  ELCDTECX
   283     12  DTE-PRORATA                 PIC  X.                      ELCDTECX
   284     12  DTE-CLM-REJ                 PIC  X.                      ELCDTECX
   285     12  DTE-REF-REJ                 PIC  X.                      ELCDTECX
   286     12  DTE-COM-TBL-USED            PIC  X.                      ELCDTECX
   287     12  FILLER                      PIC  X.                      ELCDTECX
   288     12  DTE-QTR-CO                  PIC  X.                      ELCDTECX
   289     12  DTE-REF-CK                  PIC S99V99.                  ELCDTECX
   290     12  DTE-CLM-CK                  PIC S99V99.                  ELCDTECX
   291     12  DTE-CONV-DT                 PIC 9(11) COMP-3.               CL**2
   292     12  DTE-DEFAULT-SEX             PIC  X.                      ELCDTECX
   293     12  DTE-EPL-FORMAT              PIC  X.                      ELCDTECX
   294     12  FILLER                      PIC  X.                      ELCDTECX
   295     12  DTE-JT-AGE                  PIC  X.                      ELCDTECX
   296     12  DTE-KEY-BIRTH               PIC  X.                      ELCDTECX
   297     12  DTE-REINSURANCE             PIC  X.                      ELCDTECX
   298     12  DTE-CLAIM-SORT              PIC  X.                      ELCDTECX
   299     12  DTE-WRT-OFF                 PIC  S99V99.                 ELCDTECX
   300     12  DTE-R78                     PIC  X.                      ELCDTECX
   301     12  DTE-DLY-BILL                PIC  X.                      ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   7
* CIPA010.cbl (/apps/prod/cid1p/copy/ELCDTECX)
   302     12  DTE-ALT-MORT-CODE           PIC  X(4).                   ELCDTECX
   303     12  DTE-CLAIM-PAID-THRU-TO      PIC  X.                      ELCDTECX
   304     12  DTE-COMPENSATION-ACCESS     PIC  X.                      ELCDTECX
   305     12  DTE-MORTG-ACCESS-CNTL       PIC  X.                      ELCDTECX
   306     12  DTE-MP-ALT-MORT-CODE        PIC  X(4).                   ELCDTECX
   307     12  DTE-MORTALITY-AGE-CALC-METHOD                            ELCDTECX
   308                                     PIC  X.                      ELCDTECX
   309         88  DTE-USE-TABLE-ASSIGNED-METHOD VALUE '1'              ELCDTECX
   310                                                 ' '.             ELCDTECX
   311         88  DTE-USE-ALL-AGE-LAST          VALUE '2'.             ELCDTECX
   312         88  DTE-USE-ALL-AGE-NEAR          VALUE '3'.             ELCDTECX
   313     12  DTE-RESERVE-OPTION-SWITCH   PIC  X.                      ELCDTECX
   314         88  DTE-OPT-RESERVE-METHOD-AUTH       VALUE 'Y'.         ELCDTECX
   315         88  DTE-OPT-RESERVE-METHOD-UNAUTH     VALUE 'N' ' '.     ELCDTECX
   316     12  DTE-REM-TRM-CALC-OPTION     PIC  X.                      ELCDTECX
   317     12  DTE-EXPERIENCE-RETENTION-AGE                             ELCDTECX
   318                                     PIC  9.                         CL**4
   319     12  DTE-SYSTEM.                                              ELCDTECX
   320         16  DTE-SYS-A-CREDIT        PIC  X.                      ELCDTECX
   321         16  DTE-SYS-B-PEND-CLAIM    PIC  X.                      ELCDTECX
   322         16  DTE-SYS-C-CONFIRMATIONS PIC  X.                      ELCDTECX
   323         16  DTE-SYS-D-DEMAND-BILL   PIC  X.                      ELCDTECX
   324         16  DTE-SYS-E-CLASIC-CLAIMS PIC  X.                      ELCDTECX
   325         16  DTE-SYS-F-CLASIC-CREDIT PIC  X.                      ELCDTECX
   326         16  DTE-SYS-G-AR-USED       PIC  X.                      ELCDTECX
   327         16  DTE-SYS-H               PIC  X.                      ELCDTECX
   328         16  DTE-SYS-I               PIC  X.                      ELCDTECX
   329         16  DTE-SYS-J               PIC  X.                      ELCDTECX
   330         16  DTE-SYS-K               PIC  X.                      ELCDTECX
   331         16  DTE-SYS-L               PIC  X.                      ELCDTECX
   332         16  DTE-SYS-M               PIC  X.                      ELCDTECX
   333         16  DTE-SYS-N               PIC  X.                      ELCDTECX
   334         16  DTE-SYS-O               PIC  X.                      ELCDTECX
   335         16  DTE-SYS-P               PIC  X.                      ELCDTECX
   336         16  DTE-SYS-Q               PIC  X.                      ELCDTECX
   337         16  DTE-SYS-R               PIC  X.                      ELCDTECX
   338         16  DTE-SYS-S               PIC  X.                      ELCDTECX
   339         16  DTE-SYS-T               PIC  X.                      ELCDTECX
   340         16  DTE-SYS-U               PIC  X.                      ELCDTECX
   341         16  DTE-SYS-V               PIC  X.                      ELCDTECX
   342         16  DTE-SYS-W               PIC  X.                      ELCDTECX
   343         16  DTE-SYS-X               PIC  X.                      ELCDTECX
   344         16  DTE-SYS-Y               PIC  X.                      ELCDTECX
   345         16  DTE-SYS-Z               PIC  X.                      ELCDTECX
   346     12  FILLER                      REDEFINES DTE-SYSTEM.        ELCDTECX
   347         16  DTE-SYS-CODE            OCCURS 26 TIMES              ELCDTECX
   348                                     PIC  X.                      ELCDTECX
   349     12  DTE-CLIENT                  PIC  XXX.                    ELCDTECX
   350                                                                  ELCDTECX
   351 01  CLASIC-SYSTEM-CODES.                                         ELCDTECX
   352     12  DTE-COLC-ID                 PIC  X(4).                   ELCDTECX
   353     12  DTE-CLASIC-COMPANY-CD       PIC  X.                      ELCDTECX
   354     12  DTE-CLASIC-COMPANY-NUMBER   PIC  999.                    ELCDTECX
   355*    12  DTE-CLASIC-CLAIM-ACCESS     PIC  X.                      ELCDTECX
   356     12  FILLER                      PIC  X.                      ELCDTECX
   357     12  CLASIC-REIN-MAINT           PIC  XX.                     ELCDTECX
   358     12  CLASIC-COMP-MAINT           PIC  XX.                     ELCDTECX
   359     12  CLASIC-ACCT-MAINT           PIC  XX.                     ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   8
* CIPA010.cbl (/apps/prod/cid1p/copy/ELCDTECX)
   360     12  CLASIC-CTBL-MAINT           PIC  XX.                     ELCDTECX
   361     12  CLASIC-RATE-MAINT           PIC  XX.                     ELCDTECX
   362     12  CLASIC-CREDIT-EOM-DT        PIC  XX.                     ELCDTECX
   363     12  CLASIC-CLAIMS-EOM-DT        PIC  XX.                     ELCDTECX
   364                                                                  ELCDTECX
   365     12  LIFE-OVERRIDE-L1            PIC  X.                      ELCDTECX
   366     12  LIFE-OVERRIDE-L2            PIC  XX.                     ELCDTECX
   367     12  LIFE-OVERRIDE-L6            PIC  X(6).                   ELCDTECX
   368     12  LIFE-OVERRIDE-L12           PIC  X(12).                  ELCDTECX
   369                                                                  ELCDTECX
   370     12  AH-OVERRIDE-L1              PIC  X.                      ELCDTECX
   371     12  AH-OVERRIDE-L2              PIC  XX.                     ELCDTECX
   372     12  AH-OVERRIDE-L6              PIC  X(6).                   ELCDTECX
   373     12  AH-OVERRIDE-L12             PIC  X(12).                  ELCDTECX
   374                                                                  ELCDTECX
   375     12  CLAS-REPORT-CD1-CAPTION     PIC  X(10).                  ELCDTECX
   376     12  CLAS-REPORT-CD2-CAPTION     PIC  X(10).                  ELCDTECX
   377                                                                  ELCDTECX
   378     12  CLASIC-MORTG-EOM-DT         PIC  XX.                     ELCDTECX
   379     12  CLASIC-AR-EOM-DT            PIC  XX.                     ELCDTECX
   380                                                                  ELCDTECX
   381     12  FILLER                      PIC  X(11)      VALUE SPACE. ELCDTECX
   382                                                                  ELCDTECX
   383 01  DATE-CARD-FACTORS.                                           ELCDTECX
   384     12  DATE-FACTOR-ID              PIC  X(4).                   ELCDTECX
   385     12  FAC-1                       PIC S999V9(5).               ELCDTECX
   386     12  FAC-2                       PIC S999V9(5).               ELCDTECX
   387     12  FAC-3                       PIC S999V9(5).               ELCDTECX
   388     12  FAC-4                       PIC S999V9(5).               ELCDTECX
   389     12  FAC-5                       PIC S999V9(5).               ELCDTECX
   390     12  FAC-6                       PIC S999V9(5).               ELCDTECX
   391                                                                  ELCDTECX
   392 01  FILLER                          PIC  X(12)                   ELCDTECX
   393                                          VALUE 'COMPANY NAME'.   ELCDTECX
   394 01  COMPANY-NAME-TABLE.                                          ELCDTECX
   395     12  C-N-TBL                     OCCURS 6 TIMES.              ELCDTECX
   396         16  CNT-ID                  PIC  X.                      ELCDTECX
   397         16  CNT-NAME                PIC  X(30).                  ELCDTECX
   398                                                                  ELCDTECX
   399 01  FILLER                          PIC  X(11)                   ELCDTECX
   400                                          VALUE 'STATE NAMES'.    ELCDTECX
   401 01  STATE-NAMES.                                                 ELCDTECX
   402     12  STATE-NAME-FLD              OCCURS 75 TIMES.             ELCDTECX
   403         16  STATE-SUB               PIC  XX.                     ELCDTECX
   404         16  STATE-PIC1.                                          ELCDTECX
   405             20  STATE-ABBR          PIC  XX.                     ELCDTECX
   406             20  FILLER              PIC  XXX.                    ELCDTECX
   407             20  STATE-PIC           PIC  X(20).                  ELCDTECX
   408             20  STATE-CALL-EARN     PIC  X.                      ELCDTECX
   409             20  STATE-CALL-BREAK    PIC  X.                      ELCDTECX
   410             20  STATE-PRIM-FAC-DEV  PIC  XXX.                    ELCDTECX
   411                                                                  ELCDTECX
   412 01  FILLER                          PIC  X(13)                   ELCDTECX
   413                                          VALUE 'CARRIER NAMES'.  ELCDTECX
   414 01  CARRIER-NAMES.                                               ELCDTECX
   415     12  CARRIER-NAME-FLD            OCCURS 25 TIMES.             ELCDTECX
   416         16  CARRIER-SUB             PIC  X.                      ELCDTECX
   417         16  CARRIER-DOM-ST          PIC  XX.                     ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   9
* CIPA010.cbl (/apps/prod/cid1p/copy/ELCDTECX)
   418         16  CARRIER-PIC             PIC  X(30).                  ELCDTECX
   419         16  CARRIER-UEP-PCT         PIC  S9V9(4) COMP-3.            CL**6
   420         16  CARRIER-R78-PCT         PIC  S9V9(4) COMP-3.            CL**6
   421         16  CARRIER-PRO-PCT         PIC  S9V9(4) COMP-3.            CL**6
   422*        16  FILLER                  PIC  X.                      ELCDTECX
   423         16  CARRIER-SEC-PAY         PIC  X.
   424             88  SEC-PAY-CARRIER          VALUE 'Y'.
   425                                                                  ELCDTECX
   426 01  FILLER                          PIC  X(9)                       CL**6
   427                                          VALUE 'INS TYPES'.      ELCDTECX
   428 01  CLAS-INS-TYPES.                                              ELCDTECX
   429*    12 CLAS-ALL-TYPES               OCCURS 300 TIMES.            ELCDTECX
   430     12 CLAS-ALL-TYPES               OCCURS 900 TIMES.            ELCDTECX
   431         16  CLAS-I-BEN              PIC  XX.                     ELCDTECX
   432         16  CLAS-I-AB3.                                          ELCDTECX
   433             20  FILLER              PIC  X.                      ELCDTECX
   434             20  CLAS-I-AB2.                                      ELCDTECX
   435                 24  FILLER          PIC  X.                      ELCDTECX
   436                 24  CLAS-I-AB1      PIC  X.                      ELCDTECX
   437         16  CLAS-I-AB3-AH REDEFINES CLAS-I-AB3.                  ELCDTECX
   438             20  CLAS-EXCLUSION      PIC  XX.                        CL**4
   439             20  FILLER              PIC  X.                         CL**4
   440         16  CLAS-I-AB10.                                         ELCDTECX
   441             20  FILLER              PIC  X(9).                   ELCDTECX
   442             20  CLAS-I-REIN-YN      PIC  X.                      ELCDTECX
   443         16  CLAS-I-COMMENT          PIC  X(10).                  ELCDTECX
   444         16  CLAS-I-JOINT            PIC  X.                      ELCDTECX
   445         16  CLAS-I-RL-AH            PIC  X.                      ELCDTECX
   446         16  CLAS-I-CALC-TYPE.                                    ELCDTECX
   447             20  CLAS-I-BAL          PIC  X.                      ELCDTECX
   448         16  CLAS-I-EP               PIC  X.                      ELCDTECX
   449         16  CLAS-CO-BEN-I-G-CD      PIC  X.                      ELCDTECX
   450         16  CLAS-CO-REM-TERM-CALC   PIC  X.                      ELCDTECX
   451         16  CLAS-I-BEN-CATEGORY     PIC  X.
   452         16  CLAS-I-REFUND-METHOD    PIC  X.
   453         16  CLAS-I-MAX-BENEFITS     PIC 99.
   454         16  FILLER                  PIC  XXX.
   455                                                                  ELCDTECX
   456 01  FILLER                          PIC  X(16)                   ELCDTECX
   457                                     VALUE 'MORTALITY TABLES'.    ELCDTECX
   458 01  CLAS-MORTALITY-CODES.                                        ELCDTECX
   459     12  CLAS-MORT-FLD               OCCURS 99 TIMES              ELCDTECX
   460                                     INDEXED BY CLAS-MORT-NDX.    ELCDTECX
   461         16  CLAS-MORT-CODE          PIC  X(4).                      CL**6
   462         16  CLAS-MORT-J-CODE        PIC  X.                         CL**5
   463         16  CLAS-MORT-J-FACT        PIC S9V9(4).                    CL**6
   464         16  CLAS-MORT-DESC.                                      ELCDTECX
   465             20  CLAS-RESERVE-ADJ    PIC  999.                       CL**6
   466             20  FILLER              PIC  XX.                        CL**5
   467             20  CLAS-YEAR           PIC  X(4).                      CL**6
   468             20  FILLER              PIC  X.                         CL**5
   469             20  CLAS-TABLE-TYPE     PIC  XXX.                       CL**6
   470             20  FILLER              PIC  X.                         CL**5
   471             20  CLAS-AGE-METHOD     PIC  XX.                        CL**5
   472             20  FILLER              PIC  X.                         CL**5
   473             20  CLAS-INTEREST       PIC  99.99.                     CL**5
   474             20  FILLER              PIC  X(5).                      CL**6
   475                                                                  ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  10
* CIPA010.cbl (/apps/prod/cid1p/copy/ELCDTECX)
   476 01  FILLER                          PIC  X(15)                   ELCDTECX
   477                                     VALUE 'BUSINESS TABLES'.     ELCDTECX
   478 01  CLAS-BUSINESS-CLASSES.                                       ELCDTECX
   479     12  CLAS-BUSC-FLD               OCCURS 50 TIMES.             ELCDTECX
   480         16  CLAS-BUSC-CODE          PIC  99.                     ELCDTECX
   481         16  CLAS-BUSC-GROUP         PIC  X.                      ELCDTECX
   482         16  CLAS-BUSC-DESC          PIC  X(19).                  ELCDTECX
   483         16  CLAS-BUSC-EXCL          PIC  X.                         CL**5
   484         16  FILLER                  PIC  X(4).                      CL**6
   485                                                                  ELCDTECX
   486 01  FILLER                          PIC  X(7)                       CL**6
   487                                     VALUE 'INDEXES'.             ELCDTECX
   488 01  CLAS-INDEX-TBL.                                              ELCDTECX
   489     12  CLAX-ID                     PIC  X(4).                   ELCDTECX
   490     12  CLAS-STARTC                 PIC S9(4) COMP.              ELCDTECX
   491     12  CLAS-MAXC                   PIC S9(4) COMP.              ELCDTECX
   492     12  CLAS-STARTL                 PIC S9(4) COMP.              ELCDTECX
   493     12  CLAS-MAXL                   PIC S9(4) COMP.              ELCDTECX
   494     12  CLAS-STARTA                 PIC S9(4) COMP.              ELCDTECX
   495     12  CLAS-MAXA                   PIC S9(4) COMP.              ELCDTECX
   496     12  CLAS-STARTM                 PIC S9(4) COMP.              ELCDTECX
   497     12  CLAS-MAXM                   PIC S9(4) COMP.              ELCDTECX
   498     12  CLAS-STARTB                 PIC S9(4) COMP.              ELCDTECX
   499     12  CLAS-MAXB                   PIC S9(4) COMP.              ELCDTECX
   500     12  CLAS-STARTS                 PIC S9(4) COMP.              ELCDTECX
   501     12  CLAS-MAXS                   PIC S9(4) COMP.              ELCDTECX
   502     12  CLAS-STARTE                 PIC S9(4) COMP.              ELCDTECX
   503     12  CLAS-MAXE                   PIC S9(4) COMP.              ELCDTECX
   504     12  CLAS-STARTCN                PIC S9(4) COMP.              ELCDTECX
   505     12  CLAS-MAXCN                  PIC S9(4) COMP.              ELCDTECX
   506                                                                  ELCDTECX
   507 01  CLAS-TYPE-MISC.                                              ELCDTECX
   508     12  CLAS-INDEXC                 PIC S9(4) COMP.              ELCDTECX
   509     12  CLAS-INDEXL                 PIC S9(4) COMP.              ELCDTECX
   510     12  CLAS-INDEXA                 PIC S9(4) COMP.              ELCDTECX
   511     12  CLAS-INDEXM                 PIC S9(4) COMP.              ELCDTECX
   512     12  CLAS-INDEXB                 PIC S9(4) COMP.              ELCDTECX
   513     12  CLAS-INDEXS                 PIC S9(4) COMP.              ELCDTECX
   514     12  CLAS-INDEXE                 PIC S9(4) COMP.              ELCDTECX
   515     12  CLAS-INDEX                  PIC S9(4) COMP.              ELCDTECX
   516     12  CLAS-INDEXEN                PIC S9(4) COMP.              ELCDTECX
   517     12  CLAS-INDEXCN                PIC S9(4) COMP.              ELCDTECX
   518     12  CLAS-INDEXON                PIC S9(4) COMP.              ELCDTECX
   519                                                                  ELCDTECX
   520 01  FILLER                          PIC  X(13)                   ELCDTECX
   521                                     VALUE 'MISCELLANEOUS'.       ELCDTECX
   522 01  CLAS-MISC.                                                   ELCDTECX
   523     12  DTE-FICH                    PIC  X.                      ELCDTECX
   524         88  FICH-NO                 VALUE SPACE.                 ELCDTECX
   525         88  FICH-ONLY               VALUE '1'.                   ELCDTECX
   526         88  FICH-BOTH               VALUE '2'.                   ELCDTECX
   527     12  FICH-OPEN                   PIC  X.                      ELCDTECX
   528     12  REPT-OPEN                   PIC  X.                      ELCDTECX
   529     12  DTE-PGM-OPT                 PIC  9.                         CL**5
   530     12  DTE-PRT-OPT                 PIC  X.                      ELCDTECX
   531     12  DTE-FMT-OPT                 PIC  9.                      ELCDTECX
   532     12  DTE-PRC-OPT                 PIC  9.                      ELCDTECX
   533     12  DTE-TOT-OPT                 PIC  9.                      ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  11
* CIPA010.cbl (/apps/prod/cid1p/copy/ELCDTECX)
   534     12  CLAS-LOOK                   PIC  XX.                     ELCDTECX
   535     12  DTE-TOT-LINES               PIC S9(8)      COMP.         ELCDTECX
   536     12  STATE-L                     PIC  XX.                     ELCDTECX
   537     12  CLAS-CN                     PIC  99.                     ELCDTECX
   538     12  CLAS-CO                     PIC  99.                     ELCDTECX
   539     12  DTE-VSAM-FLAGS                              VALUE ZERO.  ELCDTECX
   540         16  DTE-F-1                 PIC  X.                      ELCDTECX
   541         16  DTE-F-2                 PIC  X.                      ELCDTECX
   542     12  DTE-ABEND-WORK.                                          ELCDTECX
   543         16  DTE-ABEND-CD-1          PIC  XX         VALUE SPACES.ELCDTECX
   544         16  DTE-ABEND-CD-2          PIC  XX         VALUE SPACES.ELCDTECX
   545                                                                  ELCDTECX
   546 01  FILLER                          PIC  X(12)                   ELCDTECX
   547                                     VALUE 'WORKING DATE'.        ELCDTECX
   548 01  WS-DATE-AND-TIME.                                            ELCDTECX
   549     12  WS-ACCEPT-DATE.                                          ELCDTECX
   550         16  WS-AD-YY                PIC  99.                     ELCDTECX
   551         16  WS-AD-MM                PIC  99.                     ELCDTECX
   552         16  WS-AD-DD                PIC  99.                     ELCDTECX
   553     12  WS-CURRENT-DATE.                                         ELCDTECX
   554         16  WS-CD-MM                PIC  99.                     ELCDTECX
   555         16  FILLER                  PIC  X          VALUE '/'.   ELCDTECX
   556         16  WS-CD-DD                PIC  99.                     ELCDTECX
   557         16  FILLER                  PIC  X          VALUE '/'.   ELCDTECX
   558         16  WS-CD-YY                PIC  99.                     ELCDTECX
   559     12  WS-TIME-OF-DAY.                                          ELCDTECX
   560         16  WS-TIME                 PIC  9(6).                   ELCDTECX
   561         16  WS-HUN-SEC              PIC  99.                     ELCDTECX
   562                                                                  ELCDTECX
   563 01  FILLER                          PIC  X(12)                   ELCDTECX
   564                                     VALUE 'CARRIER CLMS'.        ELCDTECX
   565 01  CARRIER-OPT-CLAIM-DATA.                                      ELCDTECX
   566     12  CARRIER-FLDS                OCCURS 25 TIMES.             ELCDTECX
   567         16  CARRIER-IBNR-SWITCH     PIC  X.                         CL**5
   568         16  CARRIER-IBNR-PERCENT    PIC S9V9(4) COMP-3.             CL**6
   569         16  CARRIER-CIDA-DISCOUNT   PIC S9V9(4) COMP-3.             CL**6
   570                                                                  ELCDTECX
   571 01  FILLER                          PIC  X(10)                   ELCDTECX
   572                                     VALUE 'STATE TLRS'.          ELCDTECX
   573 01  STATE-TARGET-LOSS-RATIOS.                                    ELCDTECX
   574     12  STATE-TLR-FLD               OCCURS 75 TIMES.             ELCDTECX
   575         16  STATE-TARGET-LOSS-RATIO PIC S9V9(4) COMP-3.             CL**6
   576         16  STATE-CALC-INTEREST     PIC S9V9(4) COMP-3.             CL**6
   577                                                                  ELCDTECX
   578 01  FILLER                          PIC  X(13)                   ELCDTECX
   579                                     VALUE 'BUSINESS TLRS'.       ELCDTECX
   580 01  BUSINESS-TRGT-LOSS-RATIO-MODS.                               ELCDTECX
   581     12  BUS-TLRM-FLD                OCCURS 99 TIMES.             ELCDTECX
   582         16  BUS-TRGT-LOSS-RATIO-MOD PIC S9V9(4) COMP-3.             CL**6
   583                                                                  ELCDTECX
   584 01  FILLER                          PIC  X(13)                   ELCDTECX
   585                                     VALUE 'MISC CLM DATA'.       ELCDTECX
   586 01  MISC-OPT-CLM-RSV-DATA.                                       ELCDTECX
   587     12  COMPANY-CALC-INTEREST       PIC S9V9(4) COMP-3.             CL**6
   588     12  COMPANY-CIDA-DISCOUNT       PIC S9V9(4) COMP-3.             CL**6
   589     12  COMPANY-CRDB-TABLE-SELECTION                             ELCDTECX
   590                                     PIC  X.                         CL**5
   591     12  COMPANY-IBNR-AH-FACTOR      PIC S9V9(4) COMP-3.             CL**6
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  12
* CIPA010.cbl (/apps/prod/cid1p/copy/ELCDTECX)
   592     12  COMPANY-IBNR-LAG-MONTH      PIC S999    COMP-3.             CL**6
   593     12  COMPANY-IBNR-LIFE-FACTOR    PIC S9V9(4) COMP-3.             CL**6
   594     12  COMPANY-OPTION-START-DATE   PIC  XX.                        CL**5
   595     12  INDEXBS                     PIC S9(4)   COMP.               CL**6
   596     12  INDEXCA                     PIC S9(4)   COMP.               CL**6
   597     12  INDEXST                     PIC S9(4)   COMP.               CL**6
   598     12  FILLER                      PIC  X(75).                  ELCDTECX
   599******************************************************************ELCDTECX
   600*01  MISC-CARR-PCT-DATA.                                          00001521
   601*    12  DD-CARR1-UEP-PCT            PIC S9V9(4) COMP-3.          00001522
   602*    12  DD-CARR1-R78-PCT            PIC S9V9(4) COMP-3.          00001522
   603*    12  DD-CARR1-PRO-PCT            PIC S9V9(4) COMP-3.          00001522
   604*    12  DD-CARR2-UEP-PCT            PIC S9V9(4) COMP-3.          00001522
   605*    12  DD-CARR2-R78-PCT            PIC S9V9(4) COMP-3.          00001522
   606*    12  DD-CARR2-PRO-PCT            PIC S9V9(4) COMP-3.          00001522
   607******************************************************************ELCDTECX
*  608     COPY ELCDTEVR.
   609***************************************************************** 04/15/98
   610*                                                                *ELCDTEVR
   611*                                                                *ELCDTEVR
   612*                            ELCDTEVR.                           *   LV003
   613*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
   614*                            VMOD=2.001                          *   CL**2
   615*                                                                *ELCDTEVR
   616*   WORKING STORAGE FOR DATE VARIABLES CREATED                   *ELCDTEVR
   617*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCDTEVR
   618*                                                                *ELCDTEVR
   619******************************************************************ELCDTEVR
   620 01  WS-DATE-CARD-DATE.                                           ELCDTEVR
   621     05  WS-RUN-DATE.                                             ELCDTEVR
   622         10  FILLER                  PIC  9(03).                  ELCDTEVR
   623         10  RUN-CCYY                PIC  9(04).                  ELCDTEVR
   624         10  RUN-CCYR  REDEFINES  RUN-CCYY.                       ELCDTEVR
   625             15  RUN-CC              PIC  99.                     ELCDTEVR
   626             15  RUN-YR              PIC  99.                     ELCDTEVR
   627         10  RUN-MO                  PIC  99.                     ELCDTEVR
   628         10  RUN-DA                  PIC  99.                     ELCDTEVR
   629     05  WS-RUN-DATE-N REDEFINES                                     CL**2
   630            WS-RUN-DATE              PIC 9(11).                      CL**2
   631     05  WS-EP-DT.                                                ELCDTEVR
   632         10  FILLER                  PIC  9(03).                  ELCDTEVR
   633         10  EP-CCYY                 PIC  9(04).                  ELCDTEVR
   634         10  EP-CCYR  REDEFINES  EP-CCYY.                         ELCDTEVR
   635             15  EP-CC               PIC  99.                     ELCDTEVR
   636             15  EP-YR               PIC  99.                     ELCDTEVR
   637         10  EP-MO                   PIC  99.                     ELCDTEVR
   638         10  EP-DA                   PIC  99.                     ELCDTEVR
   639     05  WS-EP-DT-N REDEFINES                                        CL**2
   640            WS-EP-DT                 PIC 9(11).                      CL**2
   641     05  WS-DTE-CONV-DT.                                             CL**4
   642         10  FILLER                  PIC  9(03).                     CL**4
   643         10  DTE-CONV-CCYY           PIC  9(04).                     CL**4
   644         10  DTE-CONV-CCYR  REDEFINES  DTE-CONV-CCYY.                CL**4
   645             15  DTE-CONV-CC         PIC  99.                        CL**4
   646             15  DTE-CONV-YR         PIC  99.                        CL**4
   647         10  DTE-CONV-MO             PIC  99.                        CL**4
   648         10  DTE-CONV-DA             PIC  99.                        CL**4
   649     05  WS-DTE-CONV-DT-N REDEFINES                                  CL**4
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  13
* CIPA010.cbl (/apps/prod/cid1p/copy/ELCDTEVR)
   650            WS-DTE-CONV-DT           PIC  9(11).                     CL**4
   651 01  WS-BALANCE-FORWARD-DATE.                                     ELCDTEVR
   652     05  WS-BF-LAST-ACTIVITY-DATE.                                ELCDTEVR
   653         10  FILLER                            PIC 999.           ELCDTEVR
   654         10  BF-ACT-CCYY                       PIC 9(04).         ELCDTEVR
   655         10  BF-ACT-CCYR  REDEFINES  BF-ACT-CCYY.                 ELCDTEVR
   656             15  BF-ACT-CC                     PIC 99.            ELCDTEVR
   657             15  BF-ACT-YEAR                   PIC 99.            ELCDTEVR
   658         10  BF-ACT-MONTH                      PIC 99.            ELCDTEVR
   659         10  BF-ACT-DAY                        PIC 99.            ELCDTEVR
   660     05  WS-BF-LAST-ACTIVITY-DATE-N REDEFINES                        CL**2
   661            WS-BF-LAST-ACTIVITY-DATE           PIC 9(11).            CL**2
   662     05  WS-BF-CURRENT-LAST-STMT-DT.                              ELCDTEVR
   663         10  FILLER                            PIC 999.           ELCDTEVR
   664         10  BF-CURRENT-LAST-STMT-CEN          PIC 99.            ELCDTEVR
   665         10  BF-CURRENT-LAST-STMT-YEAR         PIC 99.            ELCDTEVR
   666         10  BF-CURRENT-LAST-STMT-MONTH        PIC 99.            ELCDTEVR
   667         10  BF-CURRENT-LAST-STMT-DAY          PIC 99.            ELCDTEVR
   668     05  WS-BF-CURRENT-LAST-STMT-DT-N REDEFINES                      CL**2
   669            WS-BF-CURRENT-LAST-STMT-DT        PIC 9(11).             CL**2
   670 01  WS-ADD-CONF-TRANSACTIONS-DTE.                                ELCDTEVR
   671     05  WS-AC-CERT-EFF-DATE.                                     ELCDTEVR
   672         10  FILLER                            PIC 999.           ELCDTEVR
   673         10  AC-CERT-CCYY                      PIC 9(04).         ELCDTEVR
   674         10  AC-CERT-CCYR  REDEFINES  AC-CERT-CCYY.               ELCDTEVR
   675             15  AC-CERT-CC                    PIC 99.            ELCDTEVR
   676             15  AC-CERT-YR                    PIC 99.            ELCDTEVR
   677         10  AC-CERT-MO                        PIC 99.            ELCDTEVR
   678         10  AC-CERT-DA                        PIC 99.            ELCDTEVR
   679     05  WS-AC-CERT-EFF-DATE-N REDEFINES                             CL**2
   680            WS-AC-CERT-EFF-DATE                PIC 9(11).            CL**2
   681     05  WS-AC-LIFE-CANCEL-DATE.                                  ELCDTEVR
   682         10  FILLER                            PIC 999.           ELCDTEVR
   683         10  AC-LIFE-CANCEL-CCYY               PIC 9(04).         ELCDTEVR
   684         10  AC-LIFE-CANCEL-CCYR REDEFINES AC-LIFE-CANCEL-CCYY.   ELCDTEVR
   685             15  AC-LIFE-CANCEL-CC             PIC 99.            ELCDTEVR
   686             15  AC-LIFE-CANCEL-YR             PIC 99.            ELCDTEVR
   687         10  AC-LIFE-CANCEL-MO                 PIC 99.            ELCDTEVR
   688         10  AC-LIFE-CANCEL-DA                 PIC 99.            ELCDTEVR
   689     05  WS-AC-LIFE-CANCEL-DATE-N REDEFINES                          CL**2
   690            WS-AC-LIFE-CANCEL-DATE             PIC 9(11).            CL**2
   691     05  WS-AC-AH-CANCEL-DATE.                                    ELCDTEVR
   692         10  FILLER                            PIC 999.           ELCDTEVR
   693         10  AC-AH-CANCEL-CCYY                 PIC 9(04).         ELCDTEVR
   694         10  AC-AH-CANCEL-CCYR  REDEFINES  AC-AH-CANCEL-CCYY.     ELCDTEVR
   695             15  AC-AH-CANCEL-CC               PIC 99.            ELCDTEVR
   696             15  AC-AH-CANCEL-YR               PIC 99.            ELCDTEVR
   697         10  AC-AH-CANCEL-MO                   PIC 99.            ELCDTEVR
   698         10  AC-AH-CANCEL-DA                   PIC 99.            ELCDTEVR
   699     05  WS-AC-AH-CANCEL-DATE-N REDEFINES                            CL**2
   700            WS-AC-AH-CANCEL-DATE               PIC 9(11).            CL**2
   701 01  WS-RATE-RECORD.                                              ELCDTEVR
   702         05  WS-RT-EXPIRY-DATE.                                   ELCDTEVR
   703             10  FILLER                        PIC 999.           ELCDTEVR
   704             10  RT-EXP-CCYY                   PIC 9(04).         ELCDTEVR
   705             10  RT-EXP-CCYR  REDEFINES  RT-EXP-CCYY.             ELCDTEVR
   706                 15  RT-EXP-CC                 PIC 99.            ELCDTEVR
   707                 15  RT-EXP-YR                 PIC 99.            ELCDTEVR
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  14
* CIPA010.cbl (/apps/prod/cid1p/copy/ELCDTEVR)
   708             10  RT-EXP-MO                     PIC 99.            ELCDTEVR
   709             10  RT-EXP-DA                     PIC 99.            ELCDTEVR
   710         05  WS-RT-EXPIRY-DATE-N REDEFINES                           CL**2
   711                WS-RT-EXPIRY-DATE              PIC 9(11).            CL**2
   712
   713*****************************************************************
   714*   COMPANIES TO BE SELECTED FOR REPORTING                      *
   715*****************************************************************
   716
   717 01  DATE-CARD-LINE.
   718     05  FILLER                 PIC X(21)
   719                      VALUE 'DATE CARD MONTH IS = '.
   720     05  PR-DATE                PIC X(02)    VALUE SPACES.
   721     05  FILLER                 PIC X(109)   VALUE SPACES.
   722
   723 01  ROUTE-RECORD.
   724     05  R-CC                   PIC X(01)    VALUE SPACES.
   725     05  R-REC.
   726         10  FILLER             PIC X(10)    VALUE SPACES.
   727         10  R-ROUTE-TO         PIC X(10)    VALUE 'ROUTE TO: '.
   728         10  FILLER             PIC X(05)    VALUE SPACES.
   729         10  R-INFO             PIC X(60)    VALUE SPACES.
   730         10  FILLER             PIC X(47)    VALUE SPACES.
   731
   732 01  STARS.
   733     05  FILLER             PIC X(50)   VALUE
   734         '* * * * * * * * * * * * * * * * * * * * * * * * * '.
   735     05  FILLER             PIC X(50)   VALUE
   736         '* * * * * * * * * * * * * * * * * * * * * * * * * '.
   737     05  FILLER             PIC X(30)   VALUE
   738         '* * * * * * * * * * * * * * * '.
   739
   740 01  WORK-RECORD.
   741     05  WORK-KEY.
   742         10  WORK-ACCOUNT       PIC X(030)    VALUE SPACE.
   743         10  WORK-COPY          PIC 9(001)    VALUE ZERO.
   744         10  WORK-REPORT        PIC X(007)    VALUE SPACE.
   745         10  WORK-LINE-NO       PIC 9(007)    VALUE ZERO.
   746     05  WORK-LINE              PIC X(133)    VALUE SPACE.
   747
   748 01  HDG1.
   749     05  FILLER                 PIC X(16).
   750     05  HDG1-ACCT              PIC X(10).
   751     05  FILLER                 PIC X(95).
   752     05  HDG1-REPORT            PIC X(06).
   753     05  FILLER                 PIC X(06).
   754
   755 01  HDG2.
   756     05  FILLER                 PIC X(01).
   757     05  HDG2-ST-HDG            PIC X(15).
   758     05  HDG2-ST                PIC X(02).
   759     05  FILLER                 PIC X(115).
   760
   761 01  HDG3.
   762     05  FILLER                 PIC X(01).
   763     05  HDG3-ACCT-HDG          PIC X(15).
   764     05  HDG3-ACCT              PIC X(10).
   765     05  FILLER                 PIC X(107).
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  15
* CIPA010.cbl
   766
   767 01  WK-DATE.
   768     05  WK-MO                  PIC X(02)  VALUE SPACES.
   769     05  FILLER                 PIC X(01)  VALUE SPACES.
   770     05  WK-DA                  PIC X(02)  VALUE SPACES.
   771     05  FILLER                 PIC X(01)  VALUE SPACES.
   772     05  WK-YR                  PIC X(02)  VALUE SPACES.
   773
   774 PROCEDURE DIVISION.
   775
   776 0000-DATE-ROUTINE SECTION.
*  777                        COPY ELCDTERX.
   778******************************************************************04/15/98
   779*                                                                *ELCDTERX
   780*                                                                *ELCDTERX
   781*                            ELCDTERX.                           *   LV002
   782*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
   783*                            VMOD=2.007                          *ELCDTERX
   784*                                                                *ELCDTERX
   785*      LOAD DATE CARD DISK FILE INTO WORKING STORAGE AREA        *ELCDTERX
   786*      (COPY CODE FOR W/S = ELCDTECX AND COPY CODE FOR FD        *ELCDTERX
   787*      = ELCDTEFD)                                               *ELCDTERX
   788*                                                                *ELCDTERX
   789******************************************************************ELCDTERX
   790                                                                  ELCDTERX
   791     ACCEPT WS-ACCEPT-DATE       FROM  DATE.                      ELCDTERX
   792                                                                  ELCDTERX
   793     MOVE WS-AD-YY               TO  WS-CD-YY.                    ELCDTERX
   794     MOVE WS-AD-MM               TO  WS-CD-MM.                    ELCDTERX
   795     MOVE WS-AD-DD               TO  WS-CD-DD.                    ELCDTERX
   796                                                                  ELCDTERX
   797     ACCEPT WS-TIME-OF-DAY       FROM  TIME.                      ELCDTERX
   798                                                                  ELCDTERX
   799******************************************************************ELCDTERX
   800*    NOTE: THE FOLLOWING STATEMENT IS USED TO ELIMINATE COB II    ELCDTERX
   801*          WARNING MESSAGES.                                      ELCDTERX
   802******************************************************************ELCDTERX
   803     IF WS-CD-YY = LOW-VALUES                                     ELCDTERX
   804         COMPUTE PGM-SUB = PGM-SUB + 1.                           ELCDTERX
   805                                                                  ELCDTERX
   806     OPEN INPUT DISK-DATE.                                        ELCDTERX
   807                                                                  ELCDTERX
   808     MOVE SPACE TO DATE-CARD         CLAS-BUSINESS-CLASSES        ELCDTERX
   809                   STATE-NAMES       CLAS-MORTALITY-CODES         ELCDTERX
   810                   CLAS-INS-TYPES    COMPANY-NAME-TABLE           ELCDTERX
   811                   DATE-CARD-OPTIONS DATE-CARD-FACTORS            ELCDTERX
   812                   CLAX-ID           CLAS-MISC                    ELCDTERX
   813                   CARRIER-NAMES     CLASIC-SYSTEM-CODES          ELCDTERX
   814                   CARRIER-OPT-CLAIM-DATA                         ELCDTERX
   815                   STATE-TARGET-LOSS-RATIOS                       ELCDTERX
   816                   BUSINESS-TRGT-LOSS-RATIO-MODS                  ELCDTERX
   817                   MISC-OPT-CLM-RSV-DATA.                         ELCDTERX
   818                                                                  ELCDTERX
   819     MOVE LOW-VALUES TO CLAS-INDEX-TBL CLAS-TYPE-MISC.            ELCDTERX
   820                                                                  ELCDTERX
   821     MOVE ZERO TO CLAS-CN DTE-TOT-LINES CLAS-CO                   ELCDTERX
   822                  INDEXCA INDEXBS INDEXST.                        ELCDTERX
   823                                                                  ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  16
* CIPA010.cbl (/apps/prod/cid1p/copy/ELCDTERX)
   824     COMPUTE CLAS-CN = PGM-SUB / +50.                             ELCDTERX
   825     COMPUTE CLAS-CO = PGM-SUB / +20.                             ELCDTERX
   826     COMPUTE CLAS-INDEXEN = PGM-SUB - (CLAS-CN * +50).            ELCDTERX
   827     COMPUTE CLAS-INDEXON = PGM-SUB - (CLAS-CO * +20).            ELCDTERX
   828                                                                  ELCDTERX
   829     IF CLAS-INDEXEN = ZERO                                       ELCDTERX
   830         MOVE +50               TO CLAS-INDEXEN                   ELCDTERX
   831     ELSE                                                         ELCDTERX
   832         ADD +1                 TO CLAS-CN.                       ELCDTERX
   833                                                                  ELCDTERX
   834     IF CLAS-INDEXON = ZERO                                       ELCDTERX
   835         MOVE +20               TO CLAS-INDEXON                   ELCDTERX
   836     ELSE                                                         ELCDTERX
   837         ADD +1                 TO CLAS-CO.                       ELCDTERX
   838                                                                  ELCDTERX
   839 0005-READ--CARD.                                                 ELCDTERX
   840     READ DISK-DATE                                               ELCDTERX
   841         AT END CLOSE DISK-DATE                                   ELCDTERX
   842             GO TO 0060-READ--TEST.                               ELCDTERX
   843                                                                  ELCDTERX
   844     MOVE ZERO                   TO CLAS-INDEX.                   ELCDTERX
   845                                                                  ELCDTERX
   846     IF DD-ID = 'CLAS' OR 'LIFE' OR 'GLED'                        ELCDTERX
   847         MOVE DATE-DISK          TO DATE-CARD                     ELCDTERX
   848         MOVE RUN-DATE           TO WS-RUN-DATE-N                    CL**2
   849         MOVE EP-DT              TO WS-EP-DT-N                       CL**2
   850         GO TO 0005-READ--CARD.                                   ELCDTERX
   851                                                                  ELCDTERX
   852     IF DD-ID = 'CLAD'                                            ELCDTERX
   853         MOVE DATE-DISK          TO DATE-CARD-OPTIONS             ELCDTERX
   854         GO TO 0005-READ--CARD.                                   ELCDTERX
   855                                                                  ELCDTERX
   856     IF DD-ID = 'CLAX'                                            ELCDTERX
   857         MOVE DATE-DISK          TO CLAS-INDEX-TBL                ELCDTERX
   858         GO TO 0005-READ--CARD.                                   ELCDTERX
   859                                                                  ELCDTERX
   860     IF DD-ID = 'CLAF'                                            ELCDTERX
   861         MOVE DATE-DISK          TO DATE-CARD-FACTORS             ELCDTERX
   862         GO TO 0005-READ--CARD.                                   ELCDTERX
   863                                                                  ELCDTERX
   864     IF DD-ID = 'CLAC'                                            ELCDTERX
   865         GO TO 0010-READ--CLAC.                                   ELCDTERX
   866                                                                  ELCDTERX
   867     IF DD-ID = 'CARR'                                            ELCDTERX
   868         GO TO 0015-READ--CARR.                                   ELCDTERX
   869                                                                  ELCDTERX
   870     IF DD-ID = 'STAT'                                            ELCDTERX
   871         GO TO 0020-READ--STAT.                                   ELCDTERX
   872                                                                  ELCDTERX
   873     IF DD-ID = 'BUSC'                                            ELCDTERX
   874         GO TO 0025-READ--BUSC.                                   ELCDTERX
   875                                                                  ELCDTERX
   876     IF DD-ID = 'MORT'                                            ELCDTERX
   877         GO TO 0030-READ--MORT.                                   ELCDTERX
   878                                                                  ELCDTERX
   879     IF DD-ID = 'CLAI'                                            ELCDTERX
   880         GO TO 0040-READ--CLAI.                                   ELCDTERX
   881                                                                  ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  17
* CIPA010.cbl (/apps/prod/cid1p/copy/ELCDTERX)
   882     IF DD-ID = 'COLC'                                            ELCDTERX
   883         GO TO 0065-READ--COLC.                                   ELCDTERX
   884                                                                  ELCDTERX
   885     IF DD-IDX NUMERIC AND                                        ELCDTERX
   886        DD-IDA = 'CL'                                             ELCDTERX
   887         GO TO 0035-READ--CLXX.                                   ELCDTERX
   888                                                                  ELCDTERX
   889     IF DD-IDX NUMERIC AND                                        ELCDTERX
   890        DD-IDA = 'PO'                                             ELCDTERX
   891         GO TO 0050-READ--POXX.                                   ELCDTERX
   892                                                                  ELCDTERX
   893     IF DD-ID = 'OPCA'                                            ELCDTERX
   894         GO TO 0070-READ--OPCA.                                   ELCDTERX
   895                                                                  ELCDTERX
   896     IF DD-ID = 'OPST'                                            ELCDTERX
   897         GO TO 0072-READ--OPST.                                   ELCDTERX
   898                                                                  ELCDTERX
   899     IF DD-ID = 'OPBS'                                            ELCDTERX
   900         GO TO 0074-READ--OPBS.                                   ELCDTERX
   901                                                                  ELCDTERX
   902     IF DD-ID = 'OPMS'                                            ELCDTERX
   903         MOVE DD-MISC-DATA       TO MISC-OPT-CLM-RSV-DATA.        ELCDTERX
   904                                                                  ELCDTERX
   905     GO TO 0005-READ--CARD.                                       ELCDTERX
   906                                                                  ELCDTERX
   907 0010-READ--CLAC.                                                 ELCDTERX
   908     ADD 1                       TO CLAS-INDEXC.                  ELCDTERX
   909     MOVE DD-CR1                 TO CNT-ID (CLAS-INDEXC).         ELCDTERX
   910     MOVE DD-CR1N                TO CNT-NAME (CLAS-INDEXC).       ELCDTERX
   911     ADD 1                       TO CLAS-INDEXC.                  ELCDTERX
   912     MOVE DD-CR2                 TO CNT-ID (CLAS-INDEXC).         ELCDTERX
   913     MOVE DD-CR2N                TO CNT-NAME (CLAS-INDEXC).       ELCDTERX
   914     GO TO 0005-READ--CARD.                                       ELCDTERX
   915                                                                  ELCDTERX
   916 0015-READ--CARR.                                                 ELCDTERX
   917     ADD 1  TO  CLAS-INDEXCN.                                     ELCDTERX
   918     IF CLAS-INDEXCN LESS THAN +26                                ELCDTERX
   919        MOVE DD-CARR1         TO CARRIER-SUB (CLAS-INDEXCN)
   920        MOVE DD-CARR1S        TO CARRIER-DOM-ST (CLAS-INDEXCN)
   921        MOVE DD-CARR1N        TO CARRIER-PIC (CLAS-INDEXCN)
   922        MOVE DD-CARR1-UEP-PCT TO CARRIER-UEP-PCT (CLAS-INDEXCN)
   923        MOVE DD-CARR1-R78-PCT TO CARRIER-R78-PCT (CLAS-INDEXCN)
   924        MOVE DD-CARR1-PRO-PCT TO CARRIER-PRO-PCT (CLAS-INDEXCN)
   925        MOVE DD-CARR1-SECPAY-SW
   926                               TO CARRIER-SEC-PAY (CLAS-INDEXCN)
   927     END-IF
   928                                                                  ELCDTERX
   929     ADD 1  TO  CLAS-INDEXCN.                                     ELCDTERX
   930     IF CLAS-INDEXCN LESS THAN +26                                ELCDTERX
   931        MOVE DD-CARR2         TO CARRIER-SUB (CLAS-INDEXCN)
   932        MOVE DD-CARR2S        TO CARRIER-DOM-ST (CLAS-INDEXCN)
   933        MOVE DD-CARR2N        TO CARRIER-PIC (CLAS-INDEXCN)
   934        MOVE DD-CARR2-UEP-PCT TO CARRIER-UEP-PCT (CLAS-INDEXCN)
   935        MOVE DD-CARR2-R78-PCT TO CARRIER-R78-PCT (CLAS-INDEXCN)
   936        MOVE DD-CARR2-PRO-PCT TO CARRIER-PRO-PCT (CLAS-INDEXCN)
   937        MOVE DD-CARR2-SECPAY-SW
   938                              TO CARRIER-SEC-PAY (CLAS-INDEXCN)
   939     END-IF
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  18
* CIPA010.cbl (/apps/prod/cid1p/copy/ELCDTERX)
   940                                                                  ELCDTERX
   941                                                                  ELCDTERX
   942     GO TO 0005-READ--CARD.                                       ELCDTERX
   943                                                                  ELCDTERX
   944 0020-READ--STAT.                                                 ELCDTERX
   945     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
   946     IF CLAS-INDEX GREATER 3  OR                                  ELCDTERX
   947        DD-ST (CLAS-INDEX) = SPACE                                ELCDTERX
   948         GO TO 0005-READ--CARD.                                   ELCDTERX
   949                                                                  ELCDTERX
   950     ADD 1                       TO CLAS-INDEXS.                  ELCDTERX
   951     MOVE DD-ST (CLAS-INDEX)     TO STATE-NAME-FLD (CLAS-INDEXS). ELCDTERX
   952     GO TO 0020-READ--STAT.                                       ELCDTERX
   953                                                                  ELCDTERX
   954 0025-READ--BUSC.                                                 ELCDTERX
   955     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
   956     IF CLAS-INDEX GREATER 3  OR                                  ELCDTERX
   957        DD-ST (CLAS-INDEX) = SPACE                                ELCDTERX
   958         GO TO 0005-READ--CARD.                                   ELCDTERX
   959                                                                  ELCDTERX
   960     ADD 1                       TO CLAS-INDEXB.                  ELCDTERX
   961     MOVE DD-ST (CLAS-INDEX)     TO CLAS-BUSC-FLD (CLAS-INDEXB).  ELCDTERX
   962     GO TO 0025-READ--BUSC.                                       ELCDTERX
   963                                                                  ELCDTERX
   964 0030-READ--MORT.                                                 ELCDTERX
   965     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
   966     IF CLAS-INDEX GREATER 2  OR                                  ELCDTERX
   967        DD-MORT (CLAS-INDEX) = SPACE                              ELCDTERX
   968         GO TO 0005-READ--CARD.                                   ELCDTERX
   969                                                                  ELCDTERX
   970     ADD 1                       TO CLAS-INDEXM.                  ELCDTERX
   971     MOVE DD-MORT (CLAS-INDEX)   TO CLAS-MORT-FLD (CLAS-INDEXM).  ELCDTERX
   972     GO TO 0030-READ--MORT.                                       ELCDTERX
   973                                                                  ELCDTERX
   974 0035-READ--CLXX.                                                 ELCDTERX
   975     IF DD-IDX NOT = CLAS-CN                                      ELCDTERX
   976          GO TO 0005-READ--CARD.                                  ELCDTERX
   977                                                                  ELCDTERX
   978     IF DD-PS-PIC (CLAS-INDEXEN) = 'X'                            ELCDTERX
   979         DISPLAY '***********************************************'ELCDTERX
   980         DISPLAY 'PROGRAM ECS-', PGM-SUB, ' NOT SCHEDULED TO RUN' ELCDTERX
   981         DISPLAY '***********************************************'ELCDTERX
   982         GO TO 0055-READ--STOP.                                   ELCDTERX
   983                                                                  ELCDTERX
   984     IF DD-PS-PIC (CLAS-INDEXEN) NOT LESS 'A'  AND                ELCDTERX
   985        DD-PS-PIC (CLAS-INDEXEN) NOT GREATER 'I'                  ELCDTERX
   986         MOVE '1'                TO DTE-FICH.                     ELCDTERX
   987                                                                  ELCDTERX
   988     IF DD-PS-PIC (CLAS-INDEXEN) NOT LESS 'J'  AND                ELCDTERX
   989        DD-PS-PIC (CLAS-INDEXEN) NOT GREATER 'R'                  ELCDTERX
   990         MOVE '2'                TO DTE-FICH.                     ELCDTERX
   991                                                                  ELCDTERX
   992*    MOVE DD-PS-PIC (CLAS-INDEXEN) TO DTE-PGM-OPT.                ELCDTERX
   993     GO TO 0005-READ--CARD.                                       ELCDTERX
   994                                                                  ELCDTERX
   995 0040-READ--CLAI.                                                 ELCDTERX
   996     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
   997     IF CLAS-INDEX GREATER 2  OR                                  ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  19
* CIPA010.cbl (/apps/prod/cid1p/copy/ELCDTERX)
   998        DD-TYPE (CLAS-INDEX) = SPACE                              ELCDTERX
   999         GO TO 0005-READ--CARD.                                   ELCDTERX
  1000                                                                  ELCDTERX
  1001     ADD 1                       TO CLAS-INDEXA.                  ELCDTERX
  1002     MOVE DD-TYPE (CLAS-INDEX) TO CLAS-ALL-TYPES (CLAS-INDEXA).   ELCDTERX
  1003     GO TO 0040-READ--CLAI.                                       ELCDTERX
  1004                                                                  ELCDTERX
  1005 0045-READ--DUMP.                                                 ELCDTERX
  1006     MOVE +999 TO WS-RETURN-CODE                                  ELCDTERX
  1007     MOVE 'MISSING AND/OR INVALID CLAS DATE CARD'                 ELCDTERX
  1008                                 TO  WS-ABEND-MESSAGE             ELCDTERX
  1009     PERFORM ABEND-PGM.                                           ELCDTERX
  1010                                                                  ELCDTERX
  1011 0050-READ--POXX.                                                 ELCDTERX
  1012     IF DD-IDX NOT = CLAS-CO                                      ELCDTERX
  1013         GO TO 0005-READ--CARD.                                   ELCDTERX
  1014                                                                  ELCDTERX
  1015     IF DD-PS-PRC (CLAS-INDEXON) = 'X'                            ELCDTERX
  1016         DISPLAY '***********************************************'ELCDTERX
  1017         DISPLAY 'ECS - ', PGM-SUB, ' IS NOT SCHEDULED TO RUN'    ELCDTERX
  1018         DISPLAY '***********************************************'ELCDTERX
  1019         GO TO 0055-READ--STOP.                                   ELCDTERX
  1020                                                                  ELCDTERX
  1021     MOVE DD-PS-PRT (CLAS-INDEXON) TO DTE-PRT-OPT.                ELCDTERX
  1022     MOVE DD-PS-FMT (CLAS-INDEXON) TO DTE-FMT-OPT.                ELCDTERX
  1023     MOVE DD-PS-PRC (CLAS-INDEXON) TO DTE-PRC-OPT DTE-PGM-OPT.    ELCDTERX
  1024     MOVE DD-PS-TOT (CLAS-INDEXON) TO DTE-TOT-OPT.                ELCDTERX
  1025                                                                  ELCDTERX
  1026     IF DTE-PRT-OPT = 'B'                                         ELCDTERX
  1027         MOVE '2'                  TO DTE-FICH.                   ELCDTERX
  1028     IF DTE-PRT-OPT = 'F'                                         ELCDTERX
  1029         MOVE '1'                  TO DTE-FICH.                   ELCDTERX
  1030                                                                  ELCDTERX
  1031     GO TO 0005-READ--CARD.                                       ELCDTERX
  1032                                                                  ELCDTERX
  1033 0055-READ--STOP.                                                 ELCDTERX
  1034     GOBACK.                                                      ELCDTERX
  1035                                                                  ELCDTERX
  1036 0060-READ--TEST.                                                 ELCDTERX
  1037     IF DATX-COD        = SPACE  OR                               ELCDTERX
  1038        CLAX-ID         = SPACE  OR                               ELCDTERX
  1039        DATE-OPTIONS-ID = SPACE                                   ELCDTERX
  1040         GO TO 0045-READ--DUMP.                                   ELCDTERX
  1041                                                                  ELCDTERX
  1042     MOVE LOW-VALUE TO CLAS-TYPE-MISC.                            ELCDTERX
  1043     GO TO 0079-READ--EXIT.                                       ELCDTERX
  1044                                                                  ELCDTERX
  1045 0065-READ--COLC.                                                 ELCDTERX
  1046     MOVE DATE-DISK              TO CLASIC-SYSTEM-CODES.          ELCDTERX
  1047     GO TO 0005-READ--CARD.                                       ELCDTERX
  1048                                                                  ELCDTERX
  1049 0070-READ--OPCA.                                                 ELCDTERX
  1050                                                                  ELCDTERX
  1051     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  1052                                                                  ELCDTERX
  1053     IF  CLAS-INDEX GREATER 13                                    ELCDTERX
  1054             OR                                                   ELCDTERX
  1055         DD-CARR-FLDS (CLAS-INDEX) = SPACE                        ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  20
* CIPA010.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  1056         GO TO 0005-READ--CARD.                                   ELCDTERX
  1057                                                                  ELCDTERX
  1058     ADD 1                       TO INDEXCA.                      ELCDTERX
  1059     MOVE DD-CARR-FLDS (CLAS-INDEX)                               ELCDTERX
  1060                                 TO CARRIER-FLDS (INDEXCA).       ELCDTERX
  1061     GO TO 0070-READ--OPCA.                                       ELCDTERX
  1062                                                                  ELCDTERX
  1063 0072-READ--OPST.                                                 ELCDTERX
  1064                                                                  ELCDTERX
  1065     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  1066                                                                  ELCDTERX
  1067     IF  CLAS-INDEX GREATER 16                                    ELCDTERX
  1068             OR                                                   ELCDTERX
  1069         DD-TLR (CLAS-INDEX) = SPACE                              ELCDTERX
  1070         GO TO 0005-READ--CARD.                                   ELCDTERX
  1071                                                                  ELCDTERX
  1072     ADD 1                       TO INDEXST.                      ELCDTERX
  1073     MOVE DD-STATE-FLDS (CLAS-INDEX)                              ELCDTERX
  1074                                 TO STATE-TLR-FLD (INDEXST).      ELCDTERX
  1075     GO TO 0072-READ--OPST.                                       ELCDTERX
  1076                                                                  ELCDTERX
  1077 0074-READ--OPBS.                                                 ELCDTERX
  1078                                                                  ELCDTERX
  1079     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  1080                                                                  ELCDTERX
  1081     IF  CLAS-INDEX GREATER 32                                    ELCDTERX
  1082             OR                                                   ELCDTERX
  1083         DD-TLR (CLAS-INDEX) = SPACE                              ELCDTERX
  1084         GO TO 0005-READ--CARD.                                   ELCDTERX
  1085                                                                  ELCDTERX
  1086     ADD 1                       TO INDEXBS.                      ELCDTERX
  1087     MOVE DD-TLR (CLAS-INDEX)    TO BUS-TLRM-FLD (INDEXBS).       ELCDTERX
  1088     GO TO 0074-READ--OPBS.                                       ELCDTERX
  1089                                                                  ELCDTERX
  1090 0079-READ--EXIT.                                                 ELCDTERX
  1091*    EXIT.                                                        ELCDTERX
  1092******************************************************************ELCDTERX
  1093
  1094     MOVE  RUN-MO         TO   WK-MO.
  1095
  1096     DISPLAY '  '.
  1097     DISPLAY 'RUN-MO = '  RUN-MO.
  1098
  1099     PERFORM INITIALIZATION.
  1100
  1101     MOVE ' ' TO R-CC.
  1102     MOVE STARS TO R-REC.
  1103     MOVE  ROUTE-RECORD TO WORK-LINE.
  1104     WRITE TOTAL-RPT-RECORD  FROM WORK-RECORD.
  1105     WRITE MWAUTO-SD-RECORD  FROM WORK-RECORD.
  1106     WRITE NCRO-RECORD       FROM WORK-RECORD.
  1107     IF RUN-MO = 06 OR 12
  1108         WRITE MWAUTO-NE-RECORD  FROM WORK-RECORD.
  1109
  1110     MOVE  ' ' TO R-CC.
  1111     MOVE  SPACES TO R-REC.
  1112     MOVE  ROUTE-RECORD TO WORK-LINE.
  1113     WRITE TOTAL-RPT-RECORD  FROM WORK-RECORD.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  21
* CIPA010.cbl
  1114     WRITE MWAUTO-SD-RECORD  FROM WORK-RECORD.
  1115     WRITE NCRO-RECORD       FROM WORK-RECORD.
  1116     IF RUN-MO = 06 OR 12
  1117         WRITE MWAUTO-NE-RECORD  FROM WORK-RECORD.
  1118
  1119     MOVE  ' ' TO R-CC.
  1120     MOVE  'ROUTE TO: ' TO R-ROUTE-TO.
  1121     MOVE  'C R E D I T   I N S U R A N C E   D I V I S I O N'
  1122                  TO R-INFO.
  1123     MOVE  ROUTE-RECORD TO WORK-LINE.
  1124     WRITE TOTAL-RPT-RECORD  FROM WORK-RECORD.
  1125     WRITE MWAUTO-SD-RECORD  FROM WORK-RECORD.
  1126     WRITE NCRO-RECORD       FROM WORK-RECORD.
  1127     IF RUN-MO = 06 OR 12
  1128         WRITE MWAUTO-NE-RECORD  FROM WORK-RECORD.
  1129
  1130     MOVE  ' ' TO R-CC.
  1131     MOVE  SPACES TO R-REC.
  1132     MOVE  ROUTE-RECORD TO WORK-LINE.
  1133     WRITE TOTAL-RPT-RECORD  FROM WORK-RECORD.
  1134     WRITE MWAUTO-SD-RECORD  FROM WORK-RECORD.
  1135     WRITE NCRO-RECORD       FROM WORK-RECORD.
  1136     IF RUN-MO = 06 OR 12
  1137         WRITE MWAUTO-NE-RECORD  FROM WORK-RECORD.
  1138
  1139     MOVE  ' ' TO R-CC.
  1140     MOVE  '    ATTN: ' TO R-ROUTE-TO.
  1141     MOVE
  1142        'T I M   W O O D'  TO R-INFO.
  1143     MOVE  ROUTE-RECORD TO WORK-LINE.
  1144     WRITE TOTAL-RPT-RECORD  FROM WORK-RECORD.
  1145     WRITE MWAUTO-SD-RECORD  FROM WORK-RECORD.
  1146     IF RUN-MO = 06 OR 12
  1147         WRITE MWAUTO-NE-RECORD  FROM WORK-RECORD.
  1148
  1149     MOVE  ' ' TO R-CC.
  1150     MOVE  SPACES TO R-REC.
  1151     MOVE  ROUTE-RECORD TO WORK-LINE.
  1152     WRITE TOTAL-RPT-RECORD  FROM WORK-RECORD.
  1153     WRITE MWAUTO-SD-RECORD  FROM WORK-RECORD.
  1154     IF RUN-MO = 06 OR 12
  1155         WRITE MWAUTO-NE-RECORD  FROM WORK-RECORD.
  1156
  1157     MOVE  ' ' TO R-CC.
  1158     MOVE  SPACES TO R-ROUTE-TO.
  1159     MOVE
  1160        'R E P O R T   C O D E   1   T O T A L   P A G E S'
  1161           TO  R-INFO.
  1162     MOVE  ROUTE-RECORD TO WORK-LINE.
  1163     WRITE TOTAL-RPT-RECORD FROM WORK-RECORD.
  1164
  1165     MOVE
  1166       'R E P O R T   C O D E   1  -  M W A U T O   SD'
  1167           TO  R-INFO.
  1168     MOVE  ROUTE-RECORD TO WORK-LINE.
  1169     WRITE MWAUTO-SD-RECORD FROM WORK-RECORD.
  1170
  1171     MOVE
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  22
* CIPA010.cbl
  1172       'R E P O R T   C O D E   1  -  N C R O         '
  1173           TO  R-INFO.
  1174     MOVE  ROUTE-RECORD TO WORK-LINE.
  1175     WRITE NCRO-RECORD      FROM WORK-RECORD.
  1176
  1177     IF RUN-MO = 06 OR 12
  1178        MOVE
  1179          'R E P O R T   C O D E   1  -  M W A U T O   NE'
  1180              TO  R-INFO
  1181        MOVE  ROUTE-RECORD TO WORK-LINE
  1182        WRITE MWAUTO-NE-RECORD FROM WORK-RECORD
  1183     END-IF
  1184
  1185     MOVE  ' ' TO R-CC.
  1186     MOVE  SPACES TO R-REC.
  1187     MOVE  ROUTE-RECORD TO WORK-LINE.
  1188     WRITE TOTAL-RPT-RECORD  FROM WORK-RECORD.
  1189     WRITE MWAUTO-SD-RECORD  FROM WORK-RECORD.
  1190     WRITE NCRO-RECORD       FROM WORK-RECORD.
  1191     IF RUN-MO = 06 OR 12
  1192         WRITE MWAUTO-NE-RECORD  FROM WORK-RECORD.
  1193
  1194     MOVE  ' ' TO R-CC.
  1195     MOVE  SPACES       TO R-ROUTE-TO.
  1196     MOVE  '"ECS021" OUTPUT FROM PROGRAM "CIPA010"' TO R-INFO.
  1197     MOVE  ROUTE-RECORD TO WORK-LINE.
  1198     WRITE TOTAL-RPT-RECORD  FROM WORK-RECORD.
  1199     WRITE MWAUTO-SD-RECORD  FROM WORK-RECORD.
  1200     WRITE NCRO-RECORD       FROM WORK-RECORD.
  1201     IF RUN-MO = 06 OR 12
  1202         WRITE MWAUTO-NE-RECORD  FROM WORK-RECORD.
  1203
  1204     MOVE  ' ' TO R-CC.
  1205     MOVE  SPACES TO R-REC.
  1206     MOVE  ROUTE-RECORD TO WORK-LINE.
  1207     WRITE TOTAL-RPT-RECORD  FROM WORK-RECORD.
  1208     WRITE MWAUTO-SD-RECORD  FROM WORK-RECORD.
  1209     WRITE NCRO-RECORD       FROM WORK-RECORD.
  1210     IF RUN-MO = 06 OR 12
  1211         WRITE MWAUTO-NE-RECORD  FROM WORK-RECORD.
  1212
  1213     MOVE  ' ' TO R-CC.
  1214     MOVE  STARS  TO R-REC.
  1215     MOVE  ROUTE-RECORD TO WORK-LINE.
  1216     WRITE TOTAL-RPT-RECORD  FROM WORK-RECORD.
  1217     WRITE MWAUTO-SD-RECORD  FROM WORK-RECORD.
  1218     WRITE NCRO-RECORD       FROM WORK-RECORD.
  1219     IF RUN-MO = 06 OR 12
  1220         WRITE MWAUTO-NE-RECORD  FROM WORK-RECORD.
  1221
  1222     MOVE  '1' TO R-CC.
  1223     MOVE  SPACES TO R-REC.
  1224     MOVE  ROUTE-RECORD TO WORK-LINE.
  1225     WRITE TOTAL-RPT-RECORD  FROM WORK-RECORD.
  1226     WRITE MWAUTO-SD-RECORD  FROM WORK-RECORD.
  1227     WRITE NCRO-RECORD       FROM WORK-RECORD.
  1228     IF RUN-MO = 06 OR 12
  1229         WRITE MWAUTO-NE-RECORD  FROM WORK-RECORD.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  23
* CIPA010.cbl
  1230
  1231 ROUTE-TO-DONE.
  1232
  1233     PERFORM PROCESS-FILE UNTIL EOF.
  1234
  1235     PERFORM END-OF-JOB.
  1236
  1237     STOP RUN.
  1238
  1239 PROCESS-FILE SECTION.
  1240
  1241     READ ECS021-FICHE
  1242         AT END MOVE 'Y' TO EOF-SW.
  1243     IF EOF
  1244         GO TO PROCESS-FILE-X.
  1245     IF CC = '1'
  1246         PERFORM CHECK-REPORT.
  1247     IF SEL-SW = 'Y'
  1248         MOVE FICHE-RECORD TO WORK-LINE
  1249         PERFORM WRITE-REPORT.
  1250
  1251 PROCESS-FILE-X.
  1252     EXIT.
  1253
  1254 CHECK-REPORT SECTION.
  1255
  1256****************************************************************
  1257*  THIS ROUTINE CHECKS THE HEADING LINES ON EACH PAGE. IT SETS *
  1258*  THE SWITCHES TO 'Y' IF HEADINGS ARE TO BE PRINTED.          *
  1259*  THEY ARE SET TO "N" IF THE PAGE IS NOT TO BE PRINTED.       *
  1260****************************************************************
  1261
  1262*  NOTE - INITIALIZE THE FOLLOWING SWITCHES TO "NO".
  1263
  1264     MOVE 'N' TO TOTAL-RPT-SW.
  1265     MOVE 'N' TO MWAUTO-SD-SW.
  1266     MOVE 'N' TO MWAUTO-NE-SW.
  1267     MOVE 'N' TO NCRO-SW.
  1268     MOVE 'N' TO SEL-SW.
  1269     MOVE FICHE-RECORD  TO  HDG1.
  1270     READ ECS021-FICHE INTO HDG2.
  1271     READ ECS021-FICHE INTO HDG3.
  1272     MOVE HDG1-ACCT TO SAVE-ACCOUNT-NAME.
  1273     PERFORM CHECK-ACCOUNT.
  1274     IF SEL-SW = 'Y'
  1275         PERFORM WRITE-HEADINGS.
  1276
  1277 CHECK-REPORT-X.
  1278     EXIT.
  1279
  1280 CHECK-ACCOUNT SECTION.
  1281
  1282*  TOTAL PAGES
  1283
  1284     IF (HDG1-ACCT = 'RMRO-N    ' OR 'RMRO-S    ' OR 'MWAUTO    '
  1285                  OR 'ROTH      ' OR 'SWRO      ' OR 'VANDE KAMP'
  1286                  OR 'IARO      ' OR 'NCRO      ' OR 'AM EQ     '
  1287                  OR 'MIDWEST   ' OR 'SAND      ' OR 'SMRO      ')
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  24
* CIPA010.cbl
  1288         AND HDG2-ST-HDG = SPACES
  1289         AND HDG3-ACCT-HDG = SPACES
  1290             MOVE 'Y' TO SEL-SW
  1291             MOVE 'Y' TO TOTAL-RPT-SW.
  1292
  1293     MOVE HDG3-ACCT TO WS-ACCT.
  1294
  1295*  MWAUTO SD
  1296
  1297     IF HDG1-ACCT = 'MWAUTO    '
  1298         AND HDG2-ST = 'SD'
  1299         AND NOT SD-DO-NOT-PRT
  1300             MOVE 'Y' TO SEL-SW
  1301             MOVE 'Y' TO MWAUTO-SD-SW
  1302             GO TO CHECK-ACCT-X.
  1303
  1304     IF HDG1-ACCT = 'MWAUTO    '
  1305         AND HDG2-ST = 'SD'
  1306         AND HDG3-ACCT-HDG = SPACES
  1307             MOVE 'Y' TO SEL-SW
  1308             MOVE 'Y' TO MWAUTO-SD-SW
  1309             GO TO CHECK-ACCT-X.
  1310
  1311*  NCRO
  1312
  1313     IF HDG1-ACCT = 'NCRO      '
  1314         MOVE 'Y' TO SEL-SW
  1315         MOVE 'Y' TO NCRO-SW
  1316         GO TO CHECK-ACCT-X
  1317     END-IF.
  1318
  1319     IF RUN-MO NOT = (6 AND 12)
  1320         GO TO CHECK-ACCT-X.
  1321
  1322*  MWAUTO NE
  1323
  1324     IF (HDG1-ACCT = 'MWAUTO    ')
  1325        AND (HDG2-ST = 'NE' OR 'CO' OR 'IA')
  1326             MOVE 'Y' TO SEL-SW
  1327             MOVE 'Y' TO MWAUTO-NE-SW
  1328             GO TO CHECK-ACCT-X.
  1329
  1330 CHECK-ACCT-X.
  1331     EXIT.
  1332
  1333 WRITE-REPORT SECTION.
  1334
  1335     ADD 1 TO WORK-LINE-NO.
  1336
  1337     MOVE 1 TO WORK-COPY.
  1338
  1339*  TOTAL REPORT
  1340
  1341     IF TOTAL-RPT-SW = 'Y'
  1342         WRITE TOTAL-RPT-RECORD FROM WORK-RECORD.
  1343
  1344*  MWAUTO SD
  1345
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  25
* CIPA010.cbl
  1346     IF MWAUTO-SD-SW = 'Y'
  1347         WRITE MWAUTO-SD-RECORD FROM WORK-RECORD
  1348         GO TO WRITE-REPORT-X.
  1349
  1350*  MWAUTO NE
  1351
  1352     IF MWAUTO-NE-SW = 'Y'
  1353         WRITE MWAUTO-NE-RECORD FROM WORK-RECORD
  1354         GO TO WRITE-REPORT-X.
  1355
  1356*  NCRO
  1357
  1358     IF NCRO-SW = 'Y'
  1359         WRITE NCRO-RECORD      FROM WORK-RECORD
  1360         GO TO WRITE-REPORT-X
  1361     END-IF.
  1362
  1363 WRITE-REPORT-X.
  1364     EXIT.
  1365
  1366 WRITE-HEADINGS SECTION.
  1367
  1368     MOVE SAVE-ACCOUNT-NAME TO WORK-ACCOUNT.
  1369     MOVE HDG1-REPORT       TO WORK-REPORT.
  1370     MOVE HDG1        TO WORK-LINE.
  1371     PERFORM WRITE-REPORT.
  1372     MOVE HDG2        TO WORK-LINE.
  1373     PERFORM WRITE-REPORT.
  1374
  1375 WRITE-HEADINGS-X.
  1376     EXIT.
  1377
  1378 INITIALIZATION SECTION.
  1379
  1380
  1381     OPEN INPUT  ECS021-FICHE.
  1382     OPEN OUTPUT TOTAL-REPORT.
  1383     OPEN OUTPUT MWAUTO-SD-REPORT.
  1384     OPEN OUTPUT NCRO-REPORT.
  1385     IF RUN-MO = 06 OR 12
  1386         OPEN OUTPUT MWAUTO-NE-REPORT
  1387     END-IF.
  1388
  1389 INITIALIZATION-X.
  1390     EXIT.
  1391
  1392
  1393 END-OF-JOB SECTION.
  1394
  1395     CLOSE ECS021-FICHE
  1396           TOTAL-REPORT
  1397           MWAUTO-SD-REPORT
  1398           NCRO-REPORT.
  1399     IF RUN-MO = 06 OR 12
  1400         CLOSE MWAUTO-NE-REPORT
  1401     END-IF.
  1402
  1403 END-OF-JOB-X.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  26
* CIPA010.cbl
  1404     EXIT.
  1405
  1406 ABEND-PGM SECTION.
  1407
  1408     DISPLAY
  1409     'PROGRAM CIPA010 INTENTIONALLY ABENDED WITH A S0C7.'.
  1410     DISPLAY 'SEE ERROR MESSAGE ABOVE.'.
  1411     MOVE +16 TO RETURN-CODE.
  1412     ADD +1 TO S0C7.
  1413
  1414 ABEND-X.
  1415     EXIT.
  1416
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:       49888     Code:        8253
