* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   1
* PEMAMF9.cbl
* Options: int("PEMAMF9.int") anim csi verbose NOBOUND PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("PEMAMF9.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"ebmlsfile" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" NOCHECKDIV NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"32" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"PEMAMF9.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"PEMAMF9.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR NOSTICKY-LINKAGE
*          NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"2" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2 PROGRAM-ID. PEMAMF9.
     3 AUTHOR.     PABLO.
     4 DATE-COMPILED. 06-Oct-15 17:19.
     6 ENVIRONMENT DIVISION.
     7 INPUT-OUTPUT SECTION.
     8 FILE-CONTROL.
     9     SELECT ERACCT           ASSIGN TO ERACCT
    10                             ORGANIZATION IS INDEXED
    11                             ACCESS IS DYNAMIC
    12                             RECORD KEY IS AM-CONTROL-PRIMARY
    13                             FILE STATUS IS ERACCT-FILE-STATUS.
    14
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   2
* PEMAMF9.cbl
    15 DATA DIVISION.
    16 FILE SECTION.
    17
    18 FD  ERACCT.
    19
*   20                                 COPY ERCACCT.
    21******************************************************************04/19/98
    22*                                                                *ERCACCT
    23*                                                                *ERCACCT
    24*                            ERCACCT                             *   LV031
    25*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL*31
    26*                            VMOD=2.031                          *ERCACCT
    27*                                                                *ERCACCT
    28*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *ERCACCT
    29*                                                                *ERCACCT
    30*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *ERCACCT
    31*   VSAM ACCOUNT MASTER FILES.                                   *ERCACCT
    32*                                                                *ERCACCT
    33*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *ERCACCT
    34*                                                                *ERCACCT
    35*   FILE TYPE = VSAM,KSDS                                        *ERCACCT
    36*   RECORD SIZE = 2000  RECFORM = FIX                            *ERCACCT
    37*                                                                *ERCACCT
    38*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *ERCACCT
    39*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *ERCACCT
    40*                                                                *ERCACCT
    41*   LOG = NO                                                     *ERCACCT
    42*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *ERCACCT
    43*                                                                *ERCACCT
    44*                                                                *ERCACCT
    45******************************************************************ERCACCT
    46*                   C H A N G E   L O G
    47*
    48* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    49*-----------------------------------------------------------------
    50*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    51* EFFECTIVE    NUMBER
    52*-----------------------------------------------------------------
    53* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
    54* 092705    2005050300006  PEMA  ADD SPP LEASES
    55* 022808    2007083100002  PEMA  ADD FREEZE STATUS
    56* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
    57* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
    58* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
    59* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
    60******************************************************************
    61                                                                  ERCACCT
    62 01  ACCOUNT-MASTER.                                              ERCACCT
    63     12  AM-RECORD-ID                      PIC XX.                ERCACCT
    64         88  VALID-AM-ID                      VALUE 'AM'.         ERCACCT
    65                                                                  ERCACCT
    66     12  AM-CONTROL-PRIMARY.                                      ERCACCT
    67         16  AM-COMPANY-CD                 PIC X.                 ERCACCT
    68         16  AM-MSTR-CNTRL.                                       ERCACCT
    69             20  AM-CONTROL-A.                                    ERCACCT
    70                 24  AM-CARRIER            PIC X.                 ERCACCT
    71                 24  AM-GROUPING.                                 ERCACCT
    72                     28 AM-GROUPING-PREFIX PIC XXX.               ERCACCT
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   3
* PEMAMF9.cbl (/apps/prod/cid1p/copy/ERCACCT)
    73                     28 AM-GROUPING-PRIME  PIC XXX.               ERCACCT
    74                 24  AM-STATE              PIC XX.                ERCACCT
    75                 24  AM-ACCOUNT.                                  ERCACCT
    76                     28  AM-ACCOUNT-PREFIX PIC X(4).              ERCACCT
    77                     28  AM-ACCOUNT-PRIME  PIC X(6).              ERCACCT
    78             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A            ERCACCT
    79                                           PIC X(19).             ERCACCT
    80             20  AM-CNTRL-B.                                      ERCACCT
    81                 24  AM-EXPIRATION-DT      PIC XX.                ERCACCT
    82                 24  FILLER                PIC X(4).              ERCACCT
    83             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.                 ERCACCT
    84                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.     ERCACCT
    85                                                                  ERCACCT
    86     12  AM-CONTROL-BY-VAR-GRP.                                   ERCACCT
    87         16  AM-COMPANY-CD-A1              PIC X.                 ERCACCT
    88         16  AM-VG-CARRIER                 PIC X.                 ERCACCT
    89         16  AM-VG-GROUPING                PIC X(6).              ERCACCT
    90         16  AM-VG-STATE                   PIC XX.                ERCACCT
    91         16  AM-VG-ACCOUNT                 PIC X(10).             ERCACCT
    92         16  AM-VG-DATE.                                          ERCACCT
    93             20  AM-VG-EXPIRATION-DT       PIC XX.                ERCACCT
    94             20  FILLER                    PIC X(4).              ERCACCT
    95         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE                  ERCACCT
    96                                           PIC 9(11)      COMP-3. ERCACCT
    97     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
    98         16  FILLER                        PIC X(10).
    99         16  AM-VG-KEY3.
   100             20  AM-VG3-ACCOUNT            PIC X(10).
   101             20  AM-VG3-EXP-DT             PIC XX.
   102         16  FILLER                        PIC X(4).
   103     12  AM-MAINT-INFORMATION.                                    ERCACCT
   104         16  AM-LAST-MAINT-DT              PIC XX.                ERCACCT
   105         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3. ERCACCT
   106         16  AM-LAST-MAINT-USER            PIC X(4).              ERCACCT
   107         16  FILLER                        PIC XX.                ERCACCT
   108                                                                  ERCACCT
   109     12  AM-EFFECTIVE-DT                   PIC XX.                ERCACCT
   110     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3. ERCACCT
   111                                                                  ERCACCT
   112     12  AM-PREV-DATES  COMP-3.                                   ERCACCT
   113         16  AM-PREV-EXP-DT                PIC 9(11).             ERCACCT
   114         16  AM-PREV-EFF-DT                PIC 9(11).             ERCACCT
   115                                                                  ERCACCT
   116     12  AM-REPORT-CODE-1                  PIC X(10).             ERCACCT
   117     12  AM-REPORT-CODE-2                  PIC X(10).             ERCACCT
   118                                                                  ERCACCT
   119     12  AM-CITY-CODE                      PIC X(4).              ERCACCT
   120     12  AM-COUNTY-PARISH                  PIC X(6).              ERCACCT
   121                                                                  ERCACCT
   122     12  AM-NAME                           PIC X(30).             ERCACCT
   123     12  AM-PERSON                         PIC X(30).             ERCACCT
   124     12  AM-ADDRS                          PIC X(30).             ERCACCT
   125     12  AM-CITY.
   126         16  AM-ADDR-CITY                  PIC X(28).
   127         16  AM-ADDR-STATE                 PIC XX.
   128     12  AM-ZIP.                                                  ERCACCT
   129         16  AM-ZIP-PRIME.                                        ERCACCT
   130             20  AM-ZIP-PRI-1ST            PIC X.                 ERCACCT
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   4
* PEMAMF9.cbl (/apps/prod/cid1p/copy/ERCACCT)
   131                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'. ERCACCT
   132             20  FILLER                    PIC X(4).              ERCACCT
   133         16  AM-ZIP-PLUS4                  PIC X(4).              ERCACCT
   134     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.              ERCACCT
   135         16  AM-CAN-POSTAL-1               PIC XXX.               ERCACCT
   136         16  AM-CAN-POSTAL-2               PIC XXX.               ERCACCT
   137         16  FILLER                        PIC XXX.               ERCACCT
   138     12  AM-TEL-NO.                                               ERCACCT
   139         16  AM-AREA-CODE                  PIC 999.               ERCACCT
   140         16  AM-TEL-PRE                    PIC 999.               ERCACCT
   141         16  AM-TEL-NBR                    PIC 9(4).              ERCACCT
   142     12  AM-TEL-LOC                        PIC X.                 ERCACCT
   143         88  AM-TEL-AT-HOME                   VALUE 'H'.          ERCACCT
   144         88  AM-TEL-AT-BUSINESS               VALUE 'B'.          ERCACCT
   145                                                                  ERCACCT
   146     12  AM-COMM-STRUCTURE.                                       ERCACCT
   147         16  AM-DEFN-1.                                           ERCACCT
   148             20  AM-AGT-COMMS       OCCURS 10 TIMES.              ERCACCT
   149                 24  AM-AGT.                                      ERCACCT
   150                     28  AM-AGT-PREFIX     PIC X(4).              ERCACCT
   151                     28  AM-AGT-PRIME      PIC X(6).              ERCACCT
   152                 24  AM-COM-TYP            PIC X.                 ERCACCT
   153                 24  AM-L-COM              PIC SV9(5)     COMP-3. ERCACCT
   154                 24  AM-J-COM              PIC SV9(5)     COMP-3. ERCACCT
   155                 24  AM-A-COM              PIC SV9(5)     COMP-3. ERCACCT
   156                 24  AM-RECALC-LV-INDIC    PIC X.                 ERCACCT
   157                 24  AM-RETRO-LV-INDIC     PIC X.                 ERCACCT
   158                 24  AM-GL-CODES           PIC X.                 ERCACCT
   159                 24  AM-COMM-CHARGEBACK    PIC 9(02).             ERCACCT
   160                 24  FILLER                PIC X(01).             ERCACCT
   161         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.                   ERCACCT
   162             20  AM-COM-TBLS        OCCURS 10 TIMES.              ERCACCT
   163                 24  FILLER                PIC X(11).             ERCACCT
   164                 24  AM-L-COMA             PIC XXX.               ERCACCT
   165                 24  AM-J-COMA             PIC XXX.               ERCACCT
   166                 24  AM-A-COMA             PIC XXX.               ERCACCT
   167                 24  FILLER                PIC X(6).              ERCACCT
   168                                                                  ERCACCT
   169     12  AM-COMM-CHANGE-STATUS             PIC X.                 ERCACCT
   170         88  AM-COMMISSIONS-CHANGED           VALUE '*'.          ERCACCT
   171                                                                  ERCACCT
   172     12  AM-CSR-CODE                       PIC X(4).              ERCACCT
   173                                                                  ERCACCT
   174     12  AM-BILLING-STATUS                 PIC X.                 ERCACCT
   175         88  AM-ACCOUNT-BILLED                VALUE 'B'.          ERCACCT
   176         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.          ERCACCT
   177     12  AM-AUTO-REFUND-SW                 PIC X.                 ERCACCT
   178         88  AUTO-REFUNDS-USED                VALUE 'Y'.          ERCACCT
   179         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.      ERCACCT
   180     12  AM-GPCD                           PIC 99.                ERCACCT
   181     12  AM-IG                             PIC X.                 ERCACCT
   182         88  AM-HAS-INDIVIDUAL                VALUE '1'.          ERCACCT
   183         88  AM-HAS-GROUP                     VALUE '2'.          ERCACCT
   184     12  AM-STATUS                         PIC X.                 ERCACCT
   185         88  AM-ACCOUNT-ACTIVE                VALUE '0'.          ERCACCT
   186         88  AM-ACCOUNT-INACTIVE              VALUE '1'.          ERCACCT
   187         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.          ERCACCT
   188         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   5
* PEMAMF9.cbl (/apps/prod/cid1p/copy/ERCACCT)
   189         88  AM-ACCOUNT-FROZEN                VALUE '4'.
   190         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
   191     12  AM-REMIT-TO                       PIC 99.                ERCACCT
   192     12  AM-ID-NO                          PIC X(11).             ERCACCT
   193                                                                  ERCACCT
   194     12  AM-CAL-TABLE                      PIC XX.                ERCACCT
   195     12  AM-LF-DEVIATION                   PIC XXX.               ERCACCT
   196     12  AM-AH-DEVIATION                   PIC XXX.               ERCACCT
   197     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3. ERCACCT
   198     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3. ERCACCT
   199     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3. ERCACCT
   200     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3. ERCACCT
   201     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3. ERCACCT
   202     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3. ERCACCT
   203                                                                  ERCACCT
   204     12  AM-USER-FIELDS.                                          ERCACCT
   205         16  AM-FLD-1                      PIC XX.                ERCACCT
   206         16  AM-FLD-2                      PIC XX.                ERCACCT
   207         16  AM-FLD-3                      PIC XX.                ERCACCT
   208         16  AM-FLD-4                      PIC XX.                ERCACCT
   209         16  AM-FLD-5                      PIC XX.                ERCACCT
   210                                                                  ERCACCT
   211     12  AM-1ST-PROD-DATE.                                        ERCACCT
   212         16  AM-1ST-PROD-YR                PIC XX.                ERCACCT
   213         16  AM-1ST-PROD-MO                PIC XX.                ERCACCT
   214         16  AM-1ST-PROD-DA                PIC XX.                ERCACCT
   215     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.     ERCACCT
   216     12  AM-CERTS-PURGED-DATE.                                    ERCACCT
   217         16  AM-PUR-YR                     PIC XX.                ERCACCT
   218         16  AM-PUR-MO                     PIC XX.                ERCACCT
   219         16  AM-PUR-DA                     PIC XX.                ERCACCT
   220     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.     ERCACCT
   221     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.     ERCACCT
   222     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.     ERCACCT
   223     12  AM-INACTIVE-DATE.                                        ERCACCT
   224         16  AM-INA-MO                     PIC 99.                ERCACCT
   225         16  AM-INA-DA                     PIC 99.                ERCACCT
   226         16  AM-INA-YR                     PIC 99.                ERCACCT
   227     12  AM-AR-HI-CERT-DATE                PIC XX.                ERCACCT
   228                                                                  ERCACCT
   229     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3. ERCACCT
   230     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3. ERCACCT
   231                                                                  ERCACCT
   232     12  AM-OB-PAYMENT-MODE                PIC X.                 ERCACCT
   233         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.      ERCACCT
   234         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.          ERCACCT
   235         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.          ERCACCT
   236         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.          ERCACCT
   237                                                                  ERCACCT
   238     12  AM-AH-ONLY-INDICATOR              PIC X.                 ERCACCT
   239         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.      ERCACCT
   240         88  AM-NO-AH-ONLY                    VALUE 'N'.          ERCACCT
   241                                                                  ERCACCT
   242     12  AM-EDIT-LOAN-OFC                  PIC X(01).             ERCACCT
   243                                                                  ERCACCT
   244     12  AM-OVER-SHORT.                                           ERCACCT
   245         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3. ERCACCT
   246         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3. ERCACCT
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   6
* PEMAMF9.cbl (/apps/prod/cid1p/copy/ERCACCT)
   247                                                                  ERCACCT
   248     12  AM-DCC-PRODUCT-CODE               PIC XXX.
   249     12  AM-DCC-CLP-STATE                  PIC XX.
   250                                                                  ERCACCT
   251     12  AM-RECALC-COMM                    PIC X.                 ERCACCT
   252     12  AM-RECALC-REIN                    PIC X.                 ERCACCT
   253                                                                  ERCACCT
   254     12  AM-REI-TABLE                      PIC XXX.               ERCACCT
   255     12  AM-REI-ET-LF                      PIC X.                 ERCACCT
   256     12  AM-REI-ET-AH                      PIC X.                 ERCACCT
   257     12  AM-REI-PE-LF                      PIC X.                 ERCACCT
   258     12  AM-REI-PE-AH                      PIC X.                 ERCACCT
   259     12  AM-REI-PRT-ST                     PIC X.                 ERCACCT
   260     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3. ERCACCT
   261     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3. ERCACCT
   262     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3. ERCACCT
   263     12  AM-REI-GROUP-A                    PIC X(6).              ERCACCT
   264     12  AM-REI-MORT                       PIC X(4).              ERCACCT
   265     12  AM-REI-PRT-OW                     PIC X.                 ERCACCT
   266     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3. ERCACCT
   267     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3. ERCACCT
   268     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3. ERCACCT
   269     12  AM-REI-GROUP-B                    PIC X(6).              ERCACCT
   270                                                                  ERCACCT
   271     12  AM-TRUST-TYPE                     PIC X(2).              ERCACCT
   272                                                                  ERCACCT
   273     12  AM-EMPLOYER-STMT-USED             PIC X.                 ERCACCT
   274     12  AM-GROUPED-CHECKS-Y-N             PIC X.                 ERCACCT
   275                                                                  ERCACCT
   276     12  AM-STD-AH-TYPE                    PIC XX.                ERCACCT
   277     12  AM-EARN-METHODS.                                         ERCACCT
   278         16  AM-EARN-METHOD-R              PIC X.                 ERCACCT
   279             88 AM-REF-RL-R78                 VALUE 'R'.          ERCACCT
   280             88 AM-REF-RL-PR                  VALUE 'P'.          ERCACCT
   281             88 AM-REF-RL-MEAN                VALUE 'M'.          ERCACCT
   282             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.          ERCACCT
   283         16  AM-EARN-METHOD-L              PIC X.                 ERCACCT
   284             88 AM-REF-LL-R78                 VALUE 'R'.          ERCACCT
   285             88 AM-REF-LL-PR                  VALUE 'P'.          ERCACCT
   286             88 AM-REF-LL-MEAN                VALUE 'M'.          ERCACCT
   287             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.          ERCACCT
   288         16  AM-EARN-METHOD-A              PIC X.                 ERCACCT
   289             88 AM-REF-AH-R78                 VALUE 'R'.          ERCACCT
   290             88 AM-REF-AH-PR                  VALUE 'P'.          ERCACCT
   291             88 AM-REF-AH-MEAN                VALUE 'M'.          ERCACCT
   292             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.          ERCACCT
   293             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.          ERCACCT
   294             88 AM-REF-AH-NET                 VALUE 'N'.          ERCACCT
   295                                                                  ERCACCT
   296     12  AM-TOL-PREM                       PIC S999V99    COMP-3. ERCACCT
   297     12  AM-TOL-REF                        PIC S999V99    COMP-3. ERCACCT
   298     12  AM-TOL-CLM                        PIC S999V99    COMP-3. ERCACCT
   299                                                                  ERCACCT
   300     12  AM-RET-Y-N                        PIC X.                 ERCACCT
   301     12  AM-RET-P-E                        PIC X.                 ERCACCT
   302     12  AM-LF-RET                         PIC S9V9999    COMP-3. ERCACCT
   303     12  AM-AH-RET                         PIC S9V9999    COMP-3. ERCACCT
   304     12  AM-RET-GRP                        PIC X(6).              ERCACCT
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   7
* PEMAMF9.cbl (/apps/prod/cid1p/copy/ERCACCT)
   305     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.                    ERCACCT
   306         16  AM-POOL-PRIME                 PIC XXX.               ERCACCT
   307         16  AM-POOL-SUB                   PIC XXX.               ERCACCT
   308     12  AM-RETRO-EARNINGS.                                       ERCACCT
   309         16  AM-RET-EARN-R                 PIC X.                 ERCACCT
   310         16  AM-RET-EARN-L                 PIC X.                 ERCACCT
   311         16  AM-RET-EARN-A                 PIC X.                 ERCACCT
   312     12  AM-RET-ST-TAX-USE                 PIC X.                 ERCACCT
   313         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.  ERCACCT
   314         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.      ERCACCT
   315     12  AM-RETRO-BEG-EARNINGS.                                   ERCACCT
   316         16  AM-RET-BEG-EARN-R             PIC X.                 ERCACCT
   317         16  AM-RET-BEG-EARN-L             PIC X.                 ERCACCT
   318         16  AM-RET-BEG-EARN-A             PIC X.                 ERCACCT
   319     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3. ERCACCT
   320     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3. ERCACCT
   321                                                                  ERCACCT
   322     12  AM-USER-SELECT-OPTIONS.                                  ERCACCT
   323         16  AM-USER-SELECT-1              PIC X(10).             ERCACCT
   324         16  AM-USER-SELECT-2              PIC X(10).             ERCACCT
   325         16  AM-USER-SELECT-3              PIC X(10).             ERCACCT
   326         16  AM-USER-SELECT-4              PIC X(10).             ERCACCT
   327         16  AM-USER-SELECT-5              PIC X(10).             ERCACCT
   328                                                                  ERCACCT
   329     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3. ERCACCT
   330                                                                  ERCACCT
   331     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3. ERCACCT
   332                                                                  ERCACCT
   333     12  AM-RPT045A-SWITCH                 PIC X.                 ERCACCT
   334         88  RPT045A-OFF                   VALUE 'N'.             ERCACCT
   335                                                                  ERCACCT
   336     12  AM-INSURANCE-LIMITS.                                     ERCACCT
   337         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3. ERCACCT
   338         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3. ERCACCT
   339                                                                  ERCACCT
   340     12  AM-PROFILE-CHANGE-SWITCH          PIC X.                 ERCACCT
   341         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.          ERCACCT
   342                                                                  ERCACCT
   343     12  AM-DISMBR-COVERAGE-SW             PIC X.                 ERCACCT
   344         88  AM-DISMBR-COVERAGE               VALUE 'Y'.          ERCACCT
   345         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.          ERCACCT
   346                                                                  ERCACCT
   347     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3. ERCACCT
   348                                                                  ERCACCT
   349     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3. ERCACCT
   350     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
   351     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
   352     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
   353     12  AM-DCC-UEF-STATE                  PIC XX.
   354     12  FILLER                            PIC XXX.
   355     12  AM-REPORT-CODE-3                  PIC X(10).
   356*    12  FILLER                            PIC X(22).             ERCACCT
   357                                                                  ERCACCT
   358     12  AM-RESERVE-DATE.                                         ERCACCT
   359         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.    ERCACCT
   360         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.    ERCACCT
   361         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.    ERCACCT
   362                                                                  ERCACCT
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   8
* PEMAMF9.cbl (/apps/prod/cid1p/copy/ERCACCT)
   363     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.                ERCACCT
   364     12  AM-NOTIFICATION-TYPES.                                   ERCACCT
   365         16  AM-NOTIF-OF-LETTERS           PIC X.                 ERCACCT
   366         16  AM-NOTIF-OF-PAYMENTS          PIC X.                 ERCACCT
   367         16  AM-NOTIF-OF-REPORTS           PIC X.                 ERCACCT
   368         16  AM-NOTIF-OF-STATUS            PIC X.                 ERCACCT
   369                                                                  ERCACCT
   370     12  AM-BENEFIT-TABLE-USAGE            PIC X.                 ERCACCT
   371         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.          ERCACCT
   372         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.          ERCACCT
   373         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.          ERCACCT
   374         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.     ERCACCT
   375                                                                  ERCACCT
   376     12  AM-BENEFIT-CONTROLS.                                     ERCACCT
   377         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.            ERCACCT
   378             20  AM-BENEFIT-CODE           PIC XX.                ERCACCT
   379             20  AM-BENEFIT-TYPE           PIC X.                 ERCACCT
   380             20  AM-BENEFIT-REVISION       PIC XXX.               ERCACCT
   381             20  AM-BENEFIT-REM-TERM       PIC X.                 ERCACCT
   382             20  AM-BENEFIT-RETRO-Y-N      PIC X.                 ERCACCT
   383             20  FILLER                    PIC XX.                ERCACCT
   384         16  FILLER                        PIC X(80).             ERCACCT
   385                                                                  ERCACCT
   386     12  AM-TRANSFER-DATA.                                        ERCACCT
   387         16  AM-TRANSFERRED-FROM.                                 ERCACCT
   388             20  AM-TRNFROM-CARRIER        PIC X.                 ERCACCT
   389             20  AM-TRNFROM-GROUPING.                             ERCACCT
   390                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.               ERCACCT
   391                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.               ERCACCT
   392             20  AM-TRNFROM-STATE          PIC XX.                ERCACCT
   393             20  AM-TRNFROM-ACCOUNT.                              ERCACCT
   394                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).             ERCACCT
   395                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).              ERCACCT
   396             20  AM-TRNFROM-DTE            PIC XX.                ERCACCT
   397         16  AM-TRANSFERRED-TO.                                   ERCACCT
   398             20  AM-TRNTO-CARRIER          PIC X.                 ERCACCT
   399             20  AM-TRNTO-GROUPING.                               ERCACCT
   400                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.               ERCACCT
   401                 24  AM-TRNTO-GRP-PRIME    PIC XXX.               ERCACCT
   402             20  AM-TRNTO-STATE            PIC XX.                ERCACCT
   403             20  AM-TRNTO-ACCOUNT.                                ERCACCT
   404                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).              ERCACCT
   405                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).              ERCACCT
   406             20  AM-TRNTO-DTE              PIC XX.                ERCACCT
   407         16  FILLER                        PIC X(10).             ERCACCT
   408                                                                  ERCACCT
   409     12  AM-SAVED-REMIT-TO                 PIC 99.                ERCACCT
   410                                                                  ERCACCT
   411     12  AM-COMM-STRUCTURE-SAVED.                                 ERCACCT
   412         16  AM-DEFN-1-SAVED.                                     ERCACCT
   413             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.           ERCACCT
   414                 24  AM-AGT-SV             PIC X(10).             ERCACCT
   415                 24  AM-COM-TYP-SV         PIC X.                 ERCACCT
   416                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3. ERCACCT
   417                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3. ERCACCT
   418                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3. ERCACCT
   419                 24  AM-RECALC-LV-INDIC-SV PIC X.                 ERCACCT
   420                 24  FILLER                PIC X.                 ERCACCT
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   9
* PEMAMF9.cbl (/apps/prod/cid1p/copy/ERCACCT)
   421                 24  AM-GL-CODES-SV        PIC X.                 ERCACCT
   422                 24  AM-COM-CHARGEBACK-SV  PIC 99.                ERCACCT
   423                 24  FILLER                PIC X.                 ERCACCT
   424         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.       ERCACCT
   425             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.            ERCACCT
   426                 24  FILLER                PIC X(11).             ERCACCT
   427                 24  AM-L-COMA-SV          PIC XXX.               ERCACCT
   428                 24  AM-J-COMA-SV          PIC XXX.               ERCACCT
   429                 24  AM-A-COMA-SV          PIC XXX.               ERCACCT
   430                 24  FILLER                PIC X(6).              ERCACCT
   431                                                                  ERCACCT
   432     12  AM-FLC-NET-PREMIUM-ALLOWANCE.                            ERCACCT
   433         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.                 ERCACCT
   434            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3. ERCACCT
   435            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3. ERCACCT
   436            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3. ERCACCT
   437                                                                  ERCACCT
   438     12  AM-ORIG-DEALER-NO                 PIC X(10).             ERCACCT
   439     12  FILLER                            PIC X(120).            ERCACCT
   440                                                                  ERCACCT
   441     12  AM-ACCOUNT-EXECUTIVE-DATA.                               ERCACCT
   442         16  AM-CONTROL-NAME               PIC X(30).             ERCACCT
   443         16  AM-EXECUTIVE-ONE.                                    ERCACCT
   444             20  AM-EXEC1-NAME             PIC X(15).             ERCACCT
   445             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)       ERCACCT
   446                                                          COMP-3. ERCACCT
   447             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)       ERCACCT
   448                                                          COMP-3. ERCACCT
   449         16  AM-EXECUTIVE-TWO.                                    ERCACCT
   450             20  AM-EXEC2-NAME             PIC X(15).             ERCACCT
   451             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)       ERCACCT
   452                                                          COMP-3. ERCACCT
   453             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)       ERCACCT
   454                                                          COMP-3. ERCACCT
   455                                                                  ERCACCT
   456     12  AM-RETRO-ADDITIONAL-DATA.                                ERCACCT
   457         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3. ERCACCT
   458         16  AM-RETRO-PREM-P-E             PIC X.                 ERCACCT
   459         16  AM-RETRO-CLMS-P-I             PIC X.                 ERCACCT
   460         16  AM-RETRO-RET-BRACKET-LF.                             ERCACCT
   461             20  AM-RETRO-RET-METHOD-LF    PIC X.                 ERCACCT
   462                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.      ERCACCT
   463                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.          ERCACCT
   464             20  AM-RETRO-RET-BASIS-LF     PIC X.                 ERCACCT
   465                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.      ERCACCT
   466                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.          ERCACCT
   467             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.           ERCACCT
   468                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3. ERCACCT
   469                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3. ERCACCT
   470         16  AM-RETRO-RET-BRACKET-AH.                             ERCACCT
   471             20  AM-RETRO-RET-METHOD-AH    PIC X.                 ERCACCT
   472                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.      ERCACCT
   473                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.          ERCACCT
   474                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.          ERCACCT
   475             20  AM-RETRO-RET-BASIS-AH     PIC X.                 ERCACCT
   476                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.      ERCACCT
   477                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.          ERCACCT
   478             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.           ERCACCT
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  10
* PEMAMF9.cbl (/apps/prod/cid1p/copy/ERCACCT)
   479                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3. ERCACCT
   480                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3. ERCACCT
   481                                                                  ERCACCT
   482     12  AM-COMMENTS.                                             ERCACCT
   483         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.ERCACCT
   484                                                                  ERCACCT
   485     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.         ERCACCT
   486         16  AM-FLI-RETRO-SHARE-CODE       PIC X.                 ERCACCT
   487         16  AM-FLI-BILLING-CODE           PIC X.                 ERCACCT
   488         16  AM-FLI-ALT-STATE-CODE         PIC XX.                ERCACCT
   489         16  AM-FLI-UNITED-IDENT           PIC X.                 ERCACCT
   490         16  AM-FLI-INTEREST-LOST-DATA.                           ERCACCT
   491             20  AM-FLI-BANK-NO            PIC X(5).              ERCACCT
   492             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3. ERCACCT
   493             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3. ERCACCT
   494             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3. ERCACCT
   495         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.            ERCACCT
   496             20  AM-FLI-AGT                PIC X(9).              ERCACCT
   497             20  AM-FLI-AGT-COMM-ACC       PIC X.                 ERCACCT
   498             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3. ERCACCT
   499         16  FILLER                        PIC X(102).            ERCACCT
   500                                                                  ERCACCT
   501     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.         ERCACCT
   502         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.          ERCACCT
   503             20  AM-BENEFIT-DMD-CODE         PIC XX.              ERCACCT
   504             20  AM-BENEFIT-DMD-TYPE         PIC X.               ERCACCT
   505             20  AM-BENEFIT-DMD-REVISION     PIC XXX.             ERCACCT
   506             20  AM-BENEFIT-DMD-REM-TERM     PIC X.               ERCACCT
   507             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.               ERCACCT
   508         16  FILLER                          PIC X(10).           ERCACCT
   509******************************************************************ERCACCT
   510
   511 WORKING-STORAGE SECTION.
   512 77  S1                          PIC S999 COMP-3 VALUE +0.
   513 77  S2                          PIC S999 COMP-3 VALUE +0.
   514 77  WS-IO-SW                    PIC X VALUE SPACES.
   515     88  WS-REWRITE                 VALUE 'R'.
   516 77  WS-WORK-CITY                PIC X(30).
   517 77  WS-REPORT-CODE-1            PIC X(10) VALUE SPACES.
   518 01  WS-STATUS-CODES.
   519     05  ERACCT-FILE-STATUS      PIC XX  VALUE '00'.
   520     05  WS-EOF-SW               PIC X   VALUE SPACES.
   521         88  END-OF-ERACCT               VALUE 'Y'.
   522
   523 01  WS-HOLD-ERACCT              PIC X(2000) VALUE LOW-VALUES.
   524 01  WS-WORK-FIELDS.
   525     05  WS-DCC-COMP             PIC X.
   526     05  WS-CID-COMP             PIC X.
   527     05  WS-HIGH-SEQ             PIC X         VALUE ' '.
   528         88  FOUND-HIGH-SEQ-NO                 VALUE 'Y'.
   529     05  WS-ABEND-FLD            PIC 9         VALUE ZEROS.
   530     05  WS-ZERO-FLD             PIC 9         VALUE ZEROS.
   531     05  WS-ERACCT-RECS-IN       PIC 9(9)      VALUE ZEROS.
   532     05  WS-ERACCT-RECS-BYPASS   PIC 9(9)      VALUE ZEROS.
   533     05  WS-ERACCT-RECS-FIX      PIC 9(9)      VALUE ZEROS.
   534     05  WS-ERACCT-RECS-ADD      PIC 9(9)      VALUE ZEROS.
   535     05  WS-ERACCT-RECS-DEL      PIC 9(9)      VALUE ZEROS.
   536     05  WS-DISPLAY-CNT          PIC Z,ZZZ,ZZ9 VALUE ZEROS.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  11
* PEMAMF9.cbl
   537     05  WS-CURRENT-AM-KEY       PIC X(19)     VALUE LOW-VALUES.
   538
   539 PROCEDURE DIVISION.
   540 0000-MAINLINE.
   541
   542     PERFORM 0100-OPEN-FILES     THRU 0100-EXIT
   543     PERFORM 0200-INITIALIZE     THRU 0200-EXIT
   544
   545     PERFORM 0300-PROCESS        THRU 0300-EXIT UNTIL
   546        END-OF-ERACCT
   547     PERFORM 3000-CLOSE-FILES    THRU 3000-EXIT
   548     PERFORM 4000-FINAL-TOTALS   THRU 4000-EXIT
   549     GOBACK
   550
   551     .
   552 0000-EXIT.
   553     EXIT.
   554
   555 0100-OPEN-FILES.
   556
   557*    OPEN INPUT ERACCT
   558     OPEN I-O   ERACCT
   559
   560     IF ERACCT-FILE-STATUS = '00'
   561        CONTINUE
   562     ELSE
   563        DISPLAY ' ERROR - ERACCT - OPEN ' ERACCT-FILE-STATUS
   564        PERFORM 9999-ABEND-RTN
   565     END-IF
   566
   567     .
   568 0100-EXIT.
   569     EXIT.
   570
   571 0200-INITIALIZE.
   572
   573     MOVE SPACES                 TO WS-EOF-SW
   574     MOVE ZEROS                  TO WS-ERACCT-RECS-IN
   575                                    WS-ERACCT-RECS-BYPASS
   576                                    WS-ERACCT-RECS-FIX
   577                                    WS-ERACCT-RECS-ADD
   578                                    WS-ERACCT-RECS-DEL
   579
   580     MOVE X'04'                  TO WS-CID-COMP
   581     MOVE X'05'                  TO WS-DCC-COMP
   582
   583     PERFORM 1100-START-ERACCT   THRU 1100-EXIT
   584     PERFORM 1200-READ-ERACCT    THRU 1200-EXIT
   585
   586     .
   587 0200-EXIT.
   588     EXIT.
   589
   590 0300-PROCESS.
   591
   592     IF (AM-REPORT-CODE-3 = 'RLIC')
   593        AND (AM-REPORT-CODE-2 = '00000000  ')
   594        PERFORM 0400-PROCESS     THRU 0400-EXIT
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  12
* PEMAMF9.cbl
   595     ELSE
   596        ADD 1                    TO WS-ERACCT-RECS-BYPASS
   597     END-IF
   598
   599*    IF (AM-CARRIER = '9')
   600*       AND (AM-ACCOUNT (1:4) = '0700' OR '7000')
   601*       AND (AM-ACCOUNT (1:2) = '09')
   602*       AND (AM-STATE = 'SC' OR 'NC')
   603*       AND (AM-REPORT-CODE-1 = 'JM&A' OR 'UNI')
   604*       PERFORM 0400-PROCESS     THRU 0400-EXIT
   605*    ELSE
   606*       ADD 1                    TO WS-ERACCT-RECS-BYPASS
   607*    END-IF
   608
   609     PERFORM 1200-READ-ERACCT    THRU 1200-EXIT
   610
   611     .
   612 0300-EXIT.
   613     EXIT.
   614
   615 0400-PROCESS.
   616
   617*    IF SPACES = AM-CAL-TABLE OR AM-LF-DEVIATION
   618*       OR AM-AH-DEVIATION
   619*       IF AM-CAL-TABLE = SPACES
   620*          DISPLAY ' CHANGING CLASS ON ' AM-STATE ' ' AM-ACCOUNT
   621*             ' FROM ' AM-CAL-TABLE ' TO 00 '
   622*          MOVE ZEROS            TO AM-CAL-TABLE
   623*       END-IF
   624*       IF AM-LF-DEVIATION = SPACES
   625*          MOVE ZEROS            TO AM-LF-DEVIATION
   626*          DISPLAY ' CHANGING LF DEV ON ' AM-STATE ' ' AM-ACCOUNT
   627*             ' TO ZEROS '
   628*       END-IF
   629*       IF AM-AH-DEVIATION = SPACES
   630*          MOVE ZEROS            TO AM-AH-DEVIATION
   631*          DISPLAY ' CHANGING AH DEV ON ' AM-STATE ' ' AM-ACCOUNT
   632*             ' TO ZEROS '
   633*       END-IF
   634*       SET WS-REWRITE           TO TRUE
   635*       PERFORM 2100-REWRITE-ERACCT THRU 2100-EXIT
   636*    END-IF
   637
   638*    IF (AM-ACCOUNT (1:3) = '700')
   639*       AND (AM-ACCOUNT (10:1) = 'L')
   640*          DISPLAY ' SPACING OUT DLR NO ON ' AM-STATE
   641*          ' ' AM-ACCOUNT
   642*       MOVE SPACES              TO AM-ORIG-DEALER-NO
   643*       SET WS-REWRITE           TO TRUE
   644*    END-IF
   645
   646*    EVALUATE TRUE
   647*       WHEN AM-STATE = 'AL' OR 'NC' OR 'PA'
   648*          PERFORM 0410-FIX-COMMENT
   649*                                THRU 0410-EXIT
   650
   651*       WHEN AM-STATE = 'AZ' OR 'CO' OR 'MT' OR
   652*                       'NH' OR 'OR' OR 'TX'
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  13
* PEMAMF9.cbl
   653*          PERFORM 0420-FIX-CLASS
   654*                                THRU 0420-EXIT
   655*    END-EVALUATE
   656
   657*    PERFORM 0410-FIX-COMMENT    THRU 0410-EXIT
   658
   659*    PERFORM 0430-FIX-REST       THRU 0430-EXIT
   660
   661*    MOVE SPACES                 TO WS-REPORT-CODE-1
   662*    EVALUATE AM-REPORT-CODE-1
   663*       WHEN 'FLRO'
   664*          MOVE 'SERO'           TO WS-REPORT-CODE-1
   665*       WHEN 'CRO'
   666*          MOVE 'SERO'           TO WS-REPORT-CODE-1
   667*    END-EVALUATE
   668
   669*    IF WS-REPORT-CODE-1 NOT = SPACES
   670*       DISPLAY ' FIXING ACCT ' AM-STATE ' ' AM-ACCOUNT
   671*          ' FROM ' AM-REPORT-CODE-1 ' TO ' WS-REPORT-CODE-1
   672*       MOVE WS-REPORT-CODE-1    TO AM-REPORT-CODE-1
   673*       PERFORM 2100-REWRITE-ERACCT
   674*                                THRU 2100-EXIT
   675*    END-IF
   676
   677     MOVE 'RLIC'                 TO AM-REPORT-CODE-2
   678     PERFORM 2100-REWRITE-ERACCT THRU 2100-EXIT
   679
   680     .
   681 0400-EXIT.
   682     EXIT.
   683
   684 0410-FIX-COMMENT.
   685
   686*    EVALUATE AM-STATE
   687*       WHEN 'AL'
   688*          MOVE 'AL (COMBO $1 NO HA) 7-21-06'
   689*                                TO AM-COMMENT-LINE (1)
   690*          MOVE '30470C AL Rev (CID 520)'
   691*                                TO AM-COMMENT-LINE (2)
   692*       WHEN 'NC'
   693*          MOVE '30470C NC Rev  (CID-502)      '
   694*                                TO AM-COMMENT-LINE (2)
   695*       WHEN 'PA'
   696*          MOVE 'PA (Combo $1-BAGE-NO HA) 7-21-06'
   697*                                TO AM-COMMENT-LINE (1)
   698*          MOVE '30470A PA Rev/30470C PA Rev (CID-372)'
   699*                                TO AM-COMMENT-LINE (2)
   700*       WHEN OTHER
   701*          DISPLAY ' HOW IN THE WORLD DID I GET HERE - 0410 '
   702*             AM-STATE
   703*    END-EVALUATE
   704
   705*    EVALUATE AM-STATE
   706*       WHEN 'SC'
   707*          MOVE 'SC (Combo $1-No HA) 30491C Sc 7-21-06'
   708*                                TO AM-COMMENT-LINE (1)
   709*          MOVE '30491C SC (CID-522)'
   710*                                TO AM-COMMENT-LINE (2)
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  14
* PEMAMF9.cbl
   711*       WHEN 'NC'
   712*          PERFORM VARYING S1 FROM +49 BY -1 UNTIL
   713*             S1 < +5
   714*             IF AM-COMMENT-LINE (2) (S1:2) = 'NP'
   715*                MOVE SPACES     TO AM-COMMENT-LINE (2) (S1:2)
   716*                MOVE +4         TO S1
   717*             END-IF
   718*          END-PERFORM
   719*       WHEN OTHER
   720*          DISPLAY ' HOW IN THE WORLD DID I GET HERE - 0410 '
   721*             AM-STATE
   722*    END-EVALUATE
   723
   724     .
   725 0410-EXIT.
   726     EXIT.
   727
   728 0420-FIX-CLASS.
   729
   730     EVALUATE AM-STATE
   731        WHEN 'AZ'
   732           MOVE '04'             TO AM-CAL-TABLE
   733        WHEN 'CO'
   734           MOVE 'CR'             TO AM-CAL-TABLE
   735        WHEN 'MT'
   736           MOVE '70'             TO AM-CAL-TABLE
   737        WHEN 'NH'
   738           MOVE 'B '             TO AM-CAL-TABLE
   739        WHEN 'OR'
   740           MOVE '02'             TO AM-CAL-TABLE
   741        WHEN 'TX'
   742           MOVE 'EE'             TO AM-CAL-TABLE
   743        WHEN OTHER
   744           DISPLAY ' HOW IN THE WORLD DID I GET HERE - 0420 '
   745              AM-STATE
   746     END-EVALUATE
   747
   748     .
   749 0420-EXIT.
   750     EXIT.
   751
   752 0430-FIX-REST.
   753
   754     MOVE +1                     TO S2
   755     PERFORM VARYING S1 FROM +1 BY +1 UNTIL
   756        (S1 > +30)
   757        IF AM-CITY (S1:1) NOT = ','
   758           MOVE AM-CITY (S1:1)   TO WS-WORK-CITY (S2:1)
   759           ADD +1                TO S2
   760        END-IF
   761     END-PERFORM
   762     MOVE WS-WORK-CITY           TO AM-CITY
   763
   764     .
   765 0430-EXIT.
   766     EXIT.
   767
   768 1100-START-ERACCT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  15
* PEMAMF9.cbl
   769
   770     MOVE LOW-VALUES             TO AM-CONTROL-PRIMARY
   771     MOVE WS-CID-COMP            TO AM-COMPANY-CD
   772
   773     START ERACCT KEY >= AM-CONTROL-PRIMARY
   774     IF ERACCT-FILE-STATUS NOT = '00'
   775        DISPLAY ' ERROR - ERACCT - START ' ERACCT-FILE-STATUS
   776        PERFORM 9999-ABEND-RTN
   777     END-IF
   778
   779     .
   780 1100-EXIT.
   781     EXIT.
   782
   783 1200-READ-ERACCT.
   784
   785     READ ERACCT NEXT RECORD
   786
   787     IF (ERACCT-FILE-STATUS = '10' OR '23')
   788        OR (AM-COMPANY-CD > WS-CID-COMP)
   789        SET END-OF-ERACCT             TO TRUE
   790     ELSE
   791        IF ERACCT-FILE-STATUS NOT = '00'
   792           DISPLAY ' ERROR - ERACCT - READ NEXT '
   793              ERACCT-FILE-STATUS
   794           PERFORM 9999-ABEND-RTN
   795        ELSE
   796           ADD 1                 TO WS-ERACCT-RECS-IN
   797        END-IF
   798     END-IF
   799
   800     MOVE AM-CONTROL-A           TO WS-CURRENT-AM-KEY
   801
   802     .
   803 1200-EXIT.
   804     EXIT.
   805
   806 2100-REWRITE-ERACCT.
   807
   808     DISPLAY 'ERACCT REWRITE ' AM-CARRIER ' ' AM-STATE ' '
   809        AM-ACCOUNT ' ' AM-REPORT-CODE-2 ' ' AM-REPORT-CODE-3
   810*    DISPLAY ' '
   811
   812*    MOVE '00' TO ERACCT-FILE-STATUS
   813     REWRITE ACCOUNT-MASTER
   814
   815     IF ERACCT-FILE-STATUS = '00'
   816         ADD 1                   TO WS-ERACCT-RECS-FIX
   817     ELSE
   818         DISPLAY 'ERACCT, BAD REWRITE '
   819         DISPLAY '*** STATUS CODE IS ' ERACCT-FILE-STATUS
   820         PERFORM 9999-ABEND-RTN
   821     END-IF
   822
   823     .
   824 2100-EXIT.
   825     EXIT.
   826
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  16
* PEMAMF9.cbl
   827 2200-WRITE-ERACCT.
   828
   829     DISPLAY 'ERACCT   WRITE ' AM-CONTROL-A
   830     DISPLAY ' '
   831
   832     WRITE ACCOUNT-MASTER
   833
   834     IF ERACCT-FILE-STATUS = '00'
   835         ADD 1                   TO WS-ERACCT-RECS-ADD
   836     ELSE
   837         DISPLAY 'ERACCT, BAD   WRITE '
   838         DISPLAY '*** STATUS CODE IS ' ERACCT-FILE-STATUS
   839         PERFORM 9999-ABEND-RTN
   840     END-IF
   841
   842     .
   843 2200-EXIT.
   844     EXIT.
   845
   846 2300-DELETE-ERACCT.
   847
   848     DISPLAY 'ERACCT  DELETE ' AM-CONTROL-A
   849     DISPLAY ' '
   850
   851     DELETE ERACCT
   852
   853     IF ERACCT-FILE-STATUS = '00'
   854         ADD 1                   TO WS-ERACCT-RECS-DEL
   855*        SET END-OF-ERACCT             TO TRUE
   856     ELSE
   857         DISPLAY 'ERACCT, BAD  DELETE '
   858         DISPLAY '*** STATUS CODE IS ' ERACCT-FILE-STATUS
   859         PERFORM 9999-ABEND-RTN
   860     END-IF
   861
   862     .
   863 2300-EXIT.
   864     EXIT.
   865
   866 3000-CLOSE-FILES.
   867
   868     CLOSE ERACCT
   869
   870     .
   871 3000-EXIT.
   872     EXIT.
   873
   874 4000-FINAL-TOTALS.
   875
   876     DISPLAY '**************************************************'
   877     DISPLAY '***                                            ***'
   878
   879     MOVE WS-ERACCT-RECS-IN      TO WS-DISPLAY-CNT
   880     DISPLAY '***  ACCT MASTER RECS IN         = ' WS-DISPLAY-CNT
   881
   882     MOVE WS-ERACCT-RECS-BYPASS  TO WS-DISPLAY-CNT
   883     DISPLAY '***  ACCT MASTER RECS BYPASSED   = ' WS-DISPLAY-CNT
   884
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  17
* PEMAMF9.cbl
   885     MOVE WS-ERACCT-RECS-FIX     TO WS-DISPLAY-CNT
   886     DISPLAY '***  ACCT MASTER RECS FIXED      = ' WS-DISPLAY-CNT
   887
   888     MOVE WS-ERACCT-RECS-ADD     TO WS-DISPLAY-CNT
   889     DISPLAY '***  ACCT MASTER RECS ADDED      = ' WS-DISPLAY-CNT
   890
   891     MOVE WS-ERACCT-RECS-DEL     TO WS-DISPLAY-CNT
   892     DISPLAY '***  ACCT MASTER RECS DELETED    = ' WS-DISPLAY-CNT
   893
   894     DISPLAY '***                                            ***'
   895     DISPLAY '**************************************************'
   896
   897     .
   898 4000-EXIT.
   899     EXIT.
   900
   901 9999-ABEND-RTN.
   902
   903     DISPLAY '*** ACCOUNT MSTR CONVERSION PROGRAM ABENDING ***'
   904     DISPLAY '************************************************'
   905
   906     MOVE 1                      TO WS-ABEND-FLD
   907     MOVE 0                      TO WS-ZERO-FLD
   908
   909     COMPUTE WS-ABEND-FLD = WS-ABEND-FLD / WS-ZERO-FLD
   910
   911     .
   912 9999-EXIT.
   913     EXIT.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:        5180     Code:        2017
