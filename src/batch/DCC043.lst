* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   1
* DCC043.cbl
* Options: int("DCC043.int") anim csi verbose NOBOUND PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("DCC043.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"ebmlsfile" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" NOCHECKDIV NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"32" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"DCC043.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"DCC043.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR NOSTICKY-LINKAGE
*          NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"2" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                DCC043.
     4*                           VMOD=2.001.
     5*AUTHOR.     CSO.
     6*            OMAHA, NEBRASKA.
     7
     8*SECURITY.   *****************************************************
     9*            *                                                   *
    10*            *   THIS PROGRAM IS THE PROPERTY OF CSO             *
    11*            *                                                   *
    12*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
    13*            *   OF CSO         IS EXPRESSLY PROHIBITED WITHOUT  *
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   2
* DCC043.cbl
    14*            *   THE PRIOR WRITTEN PERMISSION OF CSO.            *
    15*            *                                                   *
    16*            *****************************************************
    17
    18*REMARKS.    THIS PROGRAM WILL READ THE EPEC FILE AND PRINT
    19*            EARNED REVIEW STATEMENTS.
    20
    21*            AN OPTIONAL CARD INPUT MAY BE USED TO SPECIFY A
    22*        FORMAT OTHER THAN YTD AND ITD.
    23
    24*        FORMAT OF INPUT IS -
    25*         CC 1-2    CARD I.D. 'RF'
    26*            3-5    CLIENT-ID
    27*            6      LEFT SIDE FORMAT  (RIGHT SIDE ALWAYS ITD)
    28
    29*                  BLANK  USE DATE IN CC 7-14 AS BEGINNING DATE
    30*                      1  YTD
    31*                      2  QTD
    32*                      3  LAST 3 MOS.
    33*                      4  LAST 6 MOS.
    34*                      5  LAST 12 MOS.
    35*                      6  LAST MONTH
    36
    37*            7-14   BEGINNING DATE  (CCYYMMDD)
    38
    39******************************************************************
    40*                   C H A N G E   L O G
    41*
    42* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    43*-----------------------------------------------------------------
    44*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    45* EFFECTIVE    NUMBER
    46*-----------------------------------------------------------------
    47* 060402    2002060300014  SMVA  MOVE PAGE # FROM BOTTOM TO TOP
    48* 061302    2002061200004  SMVA  REMOVE ECS043B HARDCOPY - PRTN043
    49* 090908    2008090300001  AJRA  FIX RETRO CALC FOR COMMISSION
    50*                                FIX DIVIDE BY ZERO
    51* 051810 CR2010042900001   PEMA  SPEARATE CITY AND STATE
    52******************************************************************
    53
    54
    55 ENVIRONMENT DIVISION.
    56 INPUT-OUTPUT SECTION.
    57 FILE-CONTROL.
    58
    59     SELECT  SORT-WORK       ASSIGN TO SYS001-DA-FBA1-S-SORTWK1.
    60     SELECT  PRNTR           ASSIGN TO SYS008-UR-1403-S-SYS008.
    61     SELECT  EPEC-FILE       ASSIGN TO SYS010-UT-2400-S-SYS010.
    62     SELECT  ACC-MSTR        ASSIGN TO ERACCTT
    63                             ACCESS IS SEQUENTIAL
    64                             ORGANIZATION IS INDEXED
    65                             FILE STATUS IS ERACCTT-FILE-STATUS
    66                             RECORD KEY IS AM-CONTROL-PRIMARY.
    67     SELECT  ERPLAN-IN       ASSIGN TO ERPLAN
    68                             ORGANIZATION IS INDEXED
    69                             ACCESS IS DYNAMIC
    70                             FILE STATUS IS ERPLAN-FILE-STATUS
    71                             RECORD KEY IS PL-CONTROL-PRIMARY.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   3
* DCC043.cbl
    72     SELECT  DISK-DATE       ASSIGN TO SYS019-UT-FBA1-S-SYS019.
    73     SELECT  WORK-FILE       ASSIGN TO SYS012
    74             ORGANIZATION IS LINE SEQUENTIAL.
    75     SELECT  FICH            ASSIGN TO SYS020-UT-2400-S-SYS020.
    76     SELECT  CONTROL-CARD    ASSIGN TO SYS006-UR-2540R-S-SYS006.
    77
    78
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   4
* DCC043.cbl
    80 DATA DIVISION.
    81 FILE SECTION.
    82
    83 SD  SORT-WORK.
    84
    85 01  SW-REC-OUT.
    86     12  SW-RPT-TYPE-ID-OUT  PIC X.
    87     12  SW-CTL-OUT          PIC X(35).
    88     12  FILLER              PIC X(1198).
    89
    90 FD  WORK-FILE
    91     BLOCK CONTAINS 0 RECORDS
    92     RECORDING MODE F.
    93
    94 01  WORK-FILE-REC           PIC X(1288).
    95
    96 FD  CONTROL-CARD
    97     BLOCK CONTAINS 0 RECORDS
    98     RECORDING MODE F.
    99
   100 01  CARD-IN-AREA            PIC X(80).
   101
   102 FD  PRNTR
*  103                             COPY ELCPRTFD.
   104******************************************************************04/15/98
   105*                                                                *ELCPRTFD
   106*                                                                *ELCPRTFD
   107*                            ELCPRTFD.                           *   LV003
   108*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
   109*                            VMOD=2.006                          *ELCPRTFD
   110******************************************************************ELCPRTFD
   111     RECORDING MODE F                                             ELCPRTFD
   112     LABEL RECORDS OMITTED                                        ELCPRTFD
   113     BLOCK CONTAINS 0 RECORDS
   114     RECORD CONTAINS 133 CHARACTERS.                              ELCPRTFD
   115 01  PRT.                                                         ELCPRTFD
   116     12  P-CTL               PIC  X.                                 CL**2
   117     12  P-DATA              PIC  X(132).                         ELCPRTFD
   118******************************************************************ELCPRTFD
   119
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   5
* DCC043.cbl
   121 FD  EPEC-FILE
*  122                             COPY ECSEPCFD.
   123******************************************************************07/10/97
   124*                                                                *ECSEPCFD
   125*                            ECSEPCFD                            *   LV001
   126*                            VMOD=2.002                          *ECSEPCFD
   127*                                                                *ECSEPCFD
   128*  NO  CID  MODS  IN  COPYBOOK  ECSEPCFD                         *ECSEPCFD
   129*                                                                *ECSEPCFD
   130******************************************************************ECSEPCFD
   131     RECORDING MODE F                                             ECSEPCFD
   132     LABEL RECORDS STANDARD                                       ECSEPCFD
   133     BLOCK CONTAINS 0 RECORDS
   134     RECORD CONTAINS 325 CHARACTERS.                              ECSEPCFD
   135******************************************************************ECSEPCFD
*  136                             COPY ECSEPC01.
   137******************************************************************
   138*                                                                *
   139*                            ECSEPC01                            *
   140*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   141*                            VMOD=2.008                          *
   142*                                                                *
   143*   FILE DESCRIPTION =  EARNED PREM / EARNED COMM  (E.P.E.C.)    *
   144*                                                                *
   145*   FILE TYPE = SEQUENTIAL                                       *
   146*   RECORD SIZE = 325  RECFORM = FIXED                           *
   147*                                                                *
   148*   KEY DATA =                                  START=5, LEN=31  *
   149*                                                                *
   150*  NO  CID  MODS  IN  COPYBOOK  ECSEPC01                         *
   151*                                                                *
   152******************************************************************
   153
   154 01  EP-RECORD.
   155     02 EP-FILE.
   156     12  EP-RECORD-ID                      PIC XX.
   157         88  VALID-EP-ID                      VALUE 'EP'.
   158
   159     12  EP-COMPANY-CD                     PIC X.
   160
   161     12  EP-REIN                           PIC X.
   162         88  EP-REIN-EXTRACT                  VALUE 'R'.
   163
   164     12  EP-CONTROL.
   165         16  EP-CNTRL-1.
   166             20  EP-COMPANY.
   167                 24  EP-CARRIER            PIC X.
   168                 24  EP-GROUPING.
   169                     28  EP-GROUP-PREFIX   PIC XXX.
   170                     28  EP-GROUP-PRIME    PIC XXX.
   171             20  EP-STATE                  PIC XX.
   172             20  EP-ACCOUNT.
   173                 24  EP-ACCT-PREFIX        PIC X(4).
   174                 24  EP-ACCT-PRIME         PIC X(6).
   175         16  EP-CNTRL-2.
   176             20  EP-DATES.
   177                 24  EP-EXP-DTE            PIC 9(11)   COMP-3.
   178                 24  EP-EFF-DTE            PIC 9(11)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   6
* DCC043.cbl (/apps/prod/cid1p/copy/ECSEPC01)
   179
   180     12  EP-REI-CO.
   181         16  EP-REINCO                     PIC XXX.
   182         16  EP-REINCO-SUB                 PIC XXX.
   183
   184     12  EP-RCD-TYPE                       PIC X.
   185         88  EP-BEN-TYPE-LIFE                 VALUE 'L'.
   186         88  EP-BEN-TYPE-AH                   VALUE 'A'.
   187         88  EP-BEN-TYPE-PROPERTY             VALUE 'P'.
   188         88  EP-BEN-TYPE-UNEMPLOYMENT         VALUE 'U'.
   189         88  EP-BEN-TYPE-DISMEMBURMENT        VALUE 'D'.
   190         88  EP-BEN-TYPE-AD-D                 VALUE 'E'.
   191     12  EP-BEN-CODE                       PIC XX.
   192     12  FILLER                            PIC X.
   193
   194     12  EP-ISS-CNT                        PIC S9(7)      COMP-3.
   195     12  EP-ISS-BEN                        PIC S9(11)V99  COMP-3.
   196     12  EP-ISS-BEN-GROSS                  PIC S9(11)V99  COMP-3.
   197
   198     12  EP-CNC-CNT                        PIC S9(7)      COMP-3.
   199     12  EP-CNC-BEN                        PIC S9(11)V99  COMP-3.
   200     12  EP-CNC-BEN-GROSS                  PIC S9(11)V99  COMP-3.
   201
   202     12  EP-ISS-PRM                        PIC S9(9)V99   COMP-3.
   203     12  EP-ISS-PRM-GROSS                  PIC S9(9)V99   COMP-3.
   204     12  EP-CNC-PRM                        PIC S9(9)V99   COMP-3.
   205     12  EP-CNC-PRM-GROSS                  PIC S9(9)V99   COMP-3.
   206
   207     12  EP-PRM-78                         PIC S9(9)V99   COMP-3.
   208     12  EP-PRM-PR                         PIC S9(9)V99   COMP-3.
   209     12  EP-PRM-ST                         PIC S9(9)V99   COMP-3.
   210
   211     12  EP-CLM-AMT                        PIC S9(9)V99   COMP-3.
   212     12  EP-CLM-CNT                        PIC S9(7)      COMP-3.
   213     12  EP-CLM-CRT                        PIC S9(7)      COMP-3.
   214
   215     12  EP-CLM-DU                         PIC S9(7)V99   COMP-3.
   216     12  EP-CLM-PV                         PIC S9(7)V99   COMP-3.
   217     12  EP-CLM-IBNR                       PIC S9(7)V99   COMP-3.
   218     12  EP-LOSS-RESV                      PIC S9(7)V99   COMP-3.
   219     12  EP-CLAIM-ADJ                      PIC S9(7)V99   COMP-3.
   220
   221     12  EP-RETRO-EXPENSES                 PIC S9(7)V99   COMP-3.
   222     12  EP-RETRO-PAYMENTS                 PIC S9(7)V99   COMP-3.
   223     12  EP-RETRO-OTH-COMM                 PIC S9(7)V99   COMP-3.
   224
   225     12  EP-MORT-RESV                      PIC S9(11)V9(6) COMP-3.
   226     12  EP-IN-FORCE                       PIC S9(11)V99   COMP-3.
   227     12  EP-ADJUST                         PIC S9(7)V99    COMP-3.
   228
   229     12  EP-SPECIFIC-OPT-RSV-FIELDS.
   230         16  EP-LIFE-YEARS                 PIC S9(9)      COMP-3.
   231         16  EP-NEW-DATA-IND               PIC X(01).
   232             88  EP-NEW-DATA                   VALUE 'Y'.
   233         16  EP-CLM-EXP                    PIC S9(9)V99   COMP-3.
   234         16  FILLER                        PIC X(19).
   235
   236     12  EP-PRM-78-ADJ                     PIC S9(9)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   7
* DCC043.cbl (/apps/prod/cid1p/copy/ECSEPC01)
   237     12  EP-PRM-PR-ADJ                     PIC S9(9)V99   COMP-3.
   238     12  EP-PRM-ST-ADJ                     PIC S9(9)V99   COMP-3.
   239
   240     12  FILLER                            PIC XXX.
   241
   242     12  EP-UNDERWRITING-CODE              PIC X.
   243         88  EP-UNDERWRITTEN-DATA             VALUE 'Y'.
   244
   245     12  EP-PRM-TAX                        PIC S9(7)V99   COMP-3.
   246
   247     12  FILLER                            PIC X(29).
   248*    12  FILLER                            PIC X(34).
   249
   250     12  EP-AVG-AGE                        PIC S9(3)      COMP-3.
   251     12  EP-AVG-ORIG-TERM                  PIC S9(3)      COMP-3.
   252     12  EP-WEIGHTED-AGE                   PIC S9(3)      COMP-3.
   253     12  EP-WEIGHTED-ORIG-TERM             PIC S9(3)      COMP-3.
   254     12  EP-AVG-REM-TERM                   PIC S9(3)      COMP-3.
   255     12  EP-INFORCE-CNT                    PIC S9(9)      COMP-3.
   256
   257     12  EP-HI-COV-DT                      PIC 9(11)      COMP-3.
   258
   259     12  EP-HI-CERT                        PIC 9(11)      COMP-3.
   260     12  EP-LO-CERT                        PIC 9(11)      COMP-3.
   261
   262     12  EP-PURGE                          PIC X.
   263         88  EP-DATA-FROM-PURGED-CERTS        VALUE 'P'.
   264
   265     12  EP-RUN-DTE                        PIC 9(11)      COMP-3.
   266
   267     02 EC-RECORD     REDEFINES     EP-FILE.
   268     12  EC-RECORD-ID                      PIC XX.
   269         88  VALID-EC-ID                      VALUE 'EC'.
   270
   271     12  EC-COMPANY-CD                     PIC X.
   272
   273     12  EC-REIN                           PIC X.
   274         88  EC-REIN-EXTRACT                  VALUE 'R'.
   275
   276     12  EC-CONTROL.
   277         16  EC-CARRIER                    PIC X.
   278         16  EC-GROUPING.
   279             20  EC-GROUP-PREFIX           PIC XXX.
   280             20  EC-GROUP-PRIME            PIC XXX.
   281         16  EC-STATE                      PIC XX.
   282         16  EC-ACCOUNT.
   283             20  EC-ACCT-PREFIX            PIC X(4).
   284             20  EC-ACCT-PRIME             PIC X(6).
   285         16  EC-DATES.
   286             20  EC-EXP-DTE                PIC 9(11)    COMP-3.
   287             20  EC-EFF-DTE                PIC 9(11)    COMP-3.
   288
   289     12  EC-REI-CO.
   290         16  EC-REINCO                     PIC XXX.
   291         16  EC-REINCO-SUB                 PIC XXX.
   292
   293     12  EC-RCD-TYPE                       PIC X.
   294         88  EC-BEN-TYPE-LIFE                 VALUE 'L'.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   8
* DCC043.cbl (/apps/prod/cid1p/copy/ECSEPC01)
   295         88  EC-BEN-TYPE-AH                   VALUE 'A'.
   296         88  EC-BEN-TYPE-PROPERTY             VALUE 'P'.
   297         88  EC-BEN-TYPE-UNEMPLOYMENT         VALUE 'U'.
   298         88  EC-BEN-TYPE-DISMEMBURMENT        VALUE 'D'.
   299     12  EC-BEN-CODE                       PIC XX.
   300     12  EC-SEQ-NBR                        PIC X.
   301         88  EC-COMP-LEVELS-1-5               VALUE '1'.
   302         88  EC-COMP-LEVELS-6-10              VALUE '2'.
   303
   304     12  EC-AGENTS-DATA.
   305         16  EC-AGENTS-LEVEL     OCCURS   5   TIMES.
   306             20  EC-AGT-NO.
   307                 24  EC-AGT-PREFIX         PIC X(4).
   308                 24  EC-AGT-PRIME          PIC X(6).
   309             20  EC-AGT-TYPE               PIC X.
   310             20  EC-ISS-COMM               PIC S9(9)V99   COMP-3.
   311             20  EC-CNC-COMM               PIC S9(9)V99   COMP-3.
   312             20  EC-COMM-78                PIC S9(9)V99   COMP-3.
   313             20  EC-COMM-PR                PIC S9(9)V99   COMP-3.
   314             20  EC-COMM-ST                PIC S9(9)V99   COMP-3.
   315
   316     12  EC-UNDERWRITING-CODE              PIC X.
   317         88  EC-UNDERWRITTEN-DATA             VALUE 'Y'.
   318
   319     12  EC-AGENTS-DATA-II.
   320         16  EC-AGENTS-LEVEL-II  OCCURS   5   TIMES.
   321             20  EC-COMM-78-ADJ            PIC S9(9)V99   COMP-3.
   322             20  EC-COMM-PR-ADJ            PIC S9(9)V99   COMP-3.
   323
   324     12  FILLER                            PIC X(7).
   325
   326     12  EC-PURGE                          PIC X.
   327         88  EC-DATA-FROM-PURGED-CERTS        VALUE 'P'.
   328
   329     12  EC-RUN-DTE                        PIC 9(11)     COMP-3.
   330
   331******************************************************************
   332
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   9
* DCC043.cbl
   334 FD  ACC-MSTR.
*  335                             COPY ERCACCT.
   336******************************************************************04/19/98
   337*                                                                *ERCACCT
   338*                                                                *ERCACCT
   339*                            ERCACCT                             *   LV031
   340*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL*31
   341*                            VMOD=2.031                          *ERCACCT
   342*                                                                *ERCACCT
   343*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *ERCACCT
   344*                                                                *ERCACCT
   345*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *ERCACCT
   346*   VSAM ACCOUNT MASTER FILES.                                   *ERCACCT
   347*                                                                *ERCACCT
   348*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *ERCACCT
   349*                                                                *ERCACCT
   350*   FILE TYPE = VSAM,KSDS                                        *ERCACCT
   351*   RECORD SIZE = 2000  RECFORM = FIX                            *ERCACCT
   352*                                                                *ERCACCT
   353*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *ERCACCT
   354*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *ERCACCT
   355*                                                                *ERCACCT
   356*   LOG = NO                                                     *ERCACCT
   357*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *ERCACCT
   358*                                                                *ERCACCT
   359*                                                                *ERCACCT
   360******************************************************************ERCACCT
   361*                   C H A N G E   L O G
   362*
   363* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   364*-----------------------------------------------------------------
   365*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   366* EFFECTIVE    NUMBER
   367*-----------------------------------------------------------------
   368* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
   369* 092705    2005050300006  PEMA  ADD SPP LEASES
   370* 022808    2007083100002  PEMA  ADD FREEZE STATUS
   371* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
   372* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
   373* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
   374* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
   375******************************************************************
   376                                                                  ERCACCT
   377 01  ACCOUNT-MASTER.                                              ERCACCT
   378     12  AM-RECORD-ID                      PIC XX.                ERCACCT
   379         88  VALID-AM-ID                      VALUE 'AM'.         ERCACCT
   380                                                                  ERCACCT
   381     12  AM-CONTROL-PRIMARY.                                      ERCACCT
   382         16  AM-COMPANY-CD                 PIC X.                 ERCACCT
   383         16  AM-MSTR-CNTRL.                                       ERCACCT
   384             20  AM-CONTROL-A.                                    ERCACCT
   385                 24  AM-CARRIER            PIC X.                 ERCACCT
   386                 24  AM-GROUPING.                                 ERCACCT
   387                     28 AM-GROUPING-PREFIX PIC XXX.               ERCACCT
   388                     28 AM-GROUPING-PRIME  PIC XXX.               ERCACCT
   389                 24  AM-STATE              PIC XX.                ERCACCT
   390                 24  AM-ACCOUNT.                                  ERCACCT
   391                     28  AM-ACCOUNT-PREFIX PIC X(4).              ERCACCT
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  10
* DCC043.cbl (/apps/prod/cid1p/copy/ERCACCT)
   392                     28  AM-ACCOUNT-PRIME  PIC X(6).              ERCACCT
   393             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A            ERCACCT
   394                                           PIC X(19).             ERCACCT
   395             20  AM-CNTRL-B.                                      ERCACCT
   396                 24  AM-EXPIRATION-DT      PIC XX.                ERCACCT
   397                 24  FILLER                PIC X(4).              ERCACCT
   398             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.                 ERCACCT
   399                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.     ERCACCT
   400                                                                  ERCACCT
   401     12  AM-CONTROL-BY-VAR-GRP.                                   ERCACCT
   402         16  AM-COMPANY-CD-A1              PIC X.                 ERCACCT
   403         16  AM-VG-CARRIER                 PIC X.                 ERCACCT
   404         16  AM-VG-GROUPING                PIC X(6).              ERCACCT
   405         16  AM-VG-STATE                   PIC XX.                ERCACCT
   406         16  AM-VG-ACCOUNT                 PIC X(10).             ERCACCT
   407         16  AM-VG-DATE.                                          ERCACCT
   408             20  AM-VG-EXPIRATION-DT       PIC XX.                ERCACCT
   409             20  FILLER                    PIC X(4).              ERCACCT
   410         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE                  ERCACCT
   411                                           PIC 9(11)      COMP-3. ERCACCT
   412     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
   413         16  FILLER                        PIC X(10).
   414         16  AM-VG-KEY3.
   415             20  AM-VG3-ACCOUNT            PIC X(10).
   416             20  AM-VG3-EXP-DT             PIC XX.
   417         16  FILLER                        PIC X(4).
   418     12  AM-MAINT-INFORMATION.                                    ERCACCT
   419         16  AM-LAST-MAINT-DT              PIC XX.                ERCACCT
   420         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3. ERCACCT
   421         16  AM-LAST-MAINT-USER            PIC X(4).              ERCACCT
   422         16  FILLER                        PIC XX.                ERCACCT
   423                                                                  ERCACCT
   424     12  AM-EFFECTIVE-DT                   PIC XX.                ERCACCT
   425     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3. ERCACCT
   426                                                                  ERCACCT
   427     12  AM-PREV-DATES  COMP-3.                                   ERCACCT
   428         16  AM-PREV-EXP-DT                PIC 9(11).             ERCACCT
   429         16  AM-PREV-EFF-DT                PIC 9(11).             ERCACCT
   430                                                                  ERCACCT
   431     12  AM-REPORT-CODE-1                  PIC X(10).             ERCACCT
   432     12  AM-REPORT-CODE-2                  PIC X(10).             ERCACCT
   433                                                                  ERCACCT
   434     12  AM-CITY-CODE                      PIC X(4).              ERCACCT
   435     12  AM-COUNTY-PARISH                  PIC X(6).              ERCACCT
   436                                                                  ERCACCT
   437     12  AM-NAME                           PIC X(30).             ERCACCT
   438     12  AM-PERSON                         PIC X(30).             ERCACCT
   439     12  AM-ADDRS                          PIC X(30).             ERCACCT
   440     12  AM-CITY.
   441         16  AM-ADDR-CITY                  PIC X(28).
   442         16  AM-ADDR-STATE                 PIC XX.
   443     12  AM-ZIP.                                                  ERCACCT
   444         16  AM-ZIP-PRIME.                                        ERCACCT
   445             20  AM-ZIP-PRI-1ST            PIC X.                 ERCACCT
   446                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'. ERCACCT
   447             20  FILLER                    PIC X(4).              ERCACCT
   448         16  AM-ZIP-PLUS4                  PIC X(4).              ERCACCT
   449     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.              ERCACCT
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  11
* DCC043.cbl (/apps/prod/cid1p/copy/ERCACCT)
   450         16  AM-CAN-POSTAL-1               PIC XXX.               ERCACCT
   451         16  AM-CAN-POSTAL-2               PIC XXX.               ERCACCT
   452         16  FILLER                        PIC XXX.               ERCACCT
   453     12  AM-TEL-NO.                                               ERCACCT
   454         16  AM-AREA-CODE                  PIC 999.               ERCACCT
   455         16  AM-TEL-PRE                    PIC 999.               ERCACCT
   456         16  AM-TEL-NBR                    PIC 9(4).              ERCACCT
   457     12  AM-TEL-LOC                        PIC X.                 ERCACCT
   458         88  AM-TEL-AT-HOME                   VALUE 'H'.          ERCACCT
   459         88  AM-TEL-AT-BUSINESS               VALUE 'B'.          ERCACCT
   460                                                                  ERCACCT
   461     12  AM-COMM-STRUCTURE.                                       ERCACCT
   462         16  AM-DEFN-1.                                           ERCACCT
   463             20  AM-AGT-COMMS       OCCURS 10 TIMES.              ERCACCT
   464                 24  AM-AGT.                                      ERCACCT
   465                     28  AM-AGT-PREFIX     PIC X(4).              ERCACCT
   466                     28  AM-AGT-PRIME      PIC X(6).              ERCACCT
   467                 24  AM-COM-TYP            PIC X.                 ERCACCT
   468                 24  AM-L-COM              PIC SV9(5)     COMP-3. ERCACCT
   469                 24  AM-J-COM              PIC SV9(5)     COMP-3. ERCACCT
   470                 24  AM-A-COM              PIC SV9(5)     COMP-3. ERCACCT
   471                 24  AM-RECALC-LV-INDIC    PIC X.                 ERCACCT
   472                 24  AM-RETRO-LV-INDIC     PIC X.                 ERCACCT
   473                 24  AM-GL-CODES           PIC X.                 ERCACCT
   474                 24  AM-COMM-CHARGEBACK    PIC 9(02).             ERCACCT
   475                 24  FILLER                PIC X(01).             ERCACCT
   476         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.                   ERCACCT
   477             20  AM-COM-TBLS        OCCURS 10 TIMES.              ERCACCT
   478                 24  FILLER                PIC X(11).             ERCACCT
   479                 24  AM-L-COMA             PIC XXX.               ERCACCT
   480                 24  AM-J-COMA             PIC XXX.               ERCACCT
   481                 24  AM-A-COMA             PIC XXX.               ERCACCT
   482                 24  FILLER                PIC X(6).              ERCACCT
   483                                                                  ERCACCT
   484     12  AM-COMM-CHANGE-STATUS             PIC X.                 ERCACCT
   485         88  AM-COMMISSIONS-CHANGED           VALUE '*'.          ERCACCT
   486                                                                  ERCACCT
   487     12  AM-CSR-CODE                       PIC X(4).              ERCACCT
   488                                                                  ERCACCT
   489     12  AM-BILLING-STATUS                 PIC X.                 ERCACCT
   490         88  AM-ACCOUNT-BILLED                VALUE 'B'.          ERCACCT
   491         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.          ERCACCT
   492     12  AM-AUTO-REFUND-SW                 PIC X.                 ERCACCT
   493         88  AUTO-REFUNDS-USED                VALUE 'Y'.          ERCACCT
   494         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.      ERCACCT
   495     12  AM-GPCD                           PIC 99.                ERCACCT
   496     12  AM-IG                             PIC X.                 ERCACCT
   497         88  AM-HAS-INDIVIDUAL                VALUE '1'.          ERCACCT
   498         88  AM-HAS-GROUP                     VALUE '2'.          ERCACCT
   499     12  AM-STATUS                         PIC X.                 ERCACCT
   500         88  AM-ACCOUNT-ACTIVE                VALUE '0'.          ERCACCT
   501         88  AM-ACCOUNT-INACTIVE              VALUE '1'.          ERCACCT
   502         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.          ERCACCT
   503         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
   504         88  AM-ACCOUNT-FROZEN                VALUE '4'.
   505         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
   506     12  AM-REMIT-TO                       PIC 99.                ERCACCT
   507     12  AM-ID-NO                          PIC X(11).             ERCACCT
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  12
* DCC043.cbl (/apps/prod/cid1p/copy/ERCACCT)
   508                                                                  ERCACCT
   509     12  AM-CAL-TABLE                      PIC XX.                ERCACCT
   510     12  AM-LF-DEVIATION                   PIC XXX.               ERCACCT
   511     12  AM-AH-DEVIATION                   PIC XXX.               ERCACCT
   512     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3. ERCACCT
   513     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3. ERCACCT
   514     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3. ERCACCT
   515     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3. ERCACCT
   516     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3. ERCACCT
   517     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3. ERCACCT
   518                                                                  ERCACCT
   519     12  AM-USER-FIELDS.                                          ERCACCT
   520         16  AM-FLD-1                      PIC XX.                ERCACCT
   521         16  AM-FLD-2                      PIC XX.                ERCACCT
   522         16  AM-FLD-3                      PIC XX.                ERCACCT
   523         16  AM-FLD-4                      PIC XX.                ERCACCT
   524         16  AM-FLD-5                      PIC XX.                ERCACCT
   525                                                                  ERCACCT
   526     12  AM-1ST-PROD-DATE.                                        ERCACCT
   527         16  AM-1ST-PROD-YR                PIC XX.                ERCACCT
   528         16  AM-1ST-PROD-MO                PIC XX.                ERCACCT
   529         16  AM-1ST-PROD-DA                PIC XX.                ERCACCT
   530     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.     ERCACCT
   531     12  AM-CERTS-PURGED-DATE.                                    ERCACCT
   532         16  AM-PUR-YR                     PIC XX.                ERCACCT
   533         16  AM-PUR-MO                     PIC XX.                ERCACCT
   534         16  AM-PUR-DA                     PIC XX.                ERCACCT
   535     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.     ERCACCT
   536     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.     ERCACCT
   537     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.     ERCACCT
   538     12  AM-INACTIVE-DATE.                                        ERCACCT
   539         16  AM-INA-MO                     PIC 99.                ERCACCT
   540         16  AM-INA-DA                     PIC 99.                ERCACCT
   541         16  AM-INA-YR                     PIC 99.                ERCACCT
   542     12  AM-AR-HI-CERT-DATE                PIC XX.                ERCACCT
   543                                                                  ERCACCT
   544     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3. ERCACCT
   545     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3. ERCACCT
   546                                                                  ERCACCT
   547     12  AM-OB-PAYMENT-MODE                PIC X.                 ERCACCT
   548         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.      ERCACCT
   549         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.          ERCACCT
   550         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.          ERCACCT
   551         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.          ERCACCT
   552                                                                  ERCACCT
   553     12  AM-AH-ONLY-INDICATOR              PIC X.                 ERCACCT
   554         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.      ERCACCT
   555         88  AM-NO-AH-ONLY                    VALUE 'N'.          ERCACCT
   556                                                                  ERCACCT
   557     12  AM-EDIT-LOAN-OFC                  PIC X(01).             ERCACCT
   558                                                                  ERCACCT
   559     12  AM-OVER-SHORT.                                           ERCACCT
   560         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3. ERCACCT
   561         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3. ERCACCT
   562                                                                  ERCACCT
   563     12  AM-DCC-PRODUCT-CODE               PIC XXX.
   564     12  AM-DCC-CLP-STATE                  PIC XX.
   565                                                                  ERCACCT
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  13
* DCC043.cbl (/apps/prod/cid1p/copy/ERCACCT)
   566     12  AM-RECALC-COMM                    PIC X.                 ERCACCT
   567     12  AM-RECALC-REIN                    PIC X.                 ERCACCT
   568                                                                  ERCACCT
   569     12  AM-REI-TABLE                      PIC XXX.               ERCACCT
   570     12  AM-REI-ET-LF                      PIC X.                 ERCACCT
   571     12  AM-REI-ET-AH                      PIC X.                 ERCACCT
   572     12  AM-REI-PE-LF                      PIC X.                 ERCACCT
   573     12  AM-REI-PE-AH                      PIC X.                 ERCACCT
   574     12  AM-REI-PRT-ST                     PIC X.                 ERCACCT
   575     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3. ERCACCT
   576     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3. ERCACCT
   577     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3. ERCACCT
   578     12  AM-REI-GROUP-A                    PIC X(6).              ERCACCT
   579     12  AM-REI-MORT                       PIC X(4).              ERCACCT
   580     12  AM-REI-PRT-OW                     PIC X.                 ERCACCT
   581     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3. ERCACCT
   582     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3. ERCACCT
   583     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3. ERCACCT
   584     12  AM-REI-GROUP-B                    PIC X(6).              ERCACCT
   585                                                                  ERCACCT
   586     12  AM-TRUST-TYPE                     PIC X(2).              ERCACCT
   587                                                                  ERCACCT
   588     12  AM-EMPLOYER-STMT-USED             PIC X.                 ERCACCT
   589     12  AM-GROUPED-CHECKS-Y-N             PIC X.                 ERCACCT
   590                                                                  ERCACCT
   591     12  AM-STD-AH-TYPE                    PIC XX.                ERCACCT
   592     12  AM-EARN-METHODS.                                         ERCACCT
   593         16  AM-EARN-METHOD-R              PIC X.                 ERCACCT
   594             88 AM-REF-RL-R78                 VALUE 'R'.          ERCACCT
   595             88 AM-REF-RL-PR                  VALUE 'P'.          ERCACCT
   596             88 AM-REF-RL-MEAN                VALUE 'M'.          ERCACCT
   597             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.          ERCACCT
   598         16  AM-EARN-METHOD-L              PIC X.                 ERCACCT
   599             88 AM-REF-LL-R78                 VALUE 'R'.          ERCACCT
   600             88 AM-REF-LL-PR                  VALUE 'P'.          ERCACCT
   601             88 AM-REF-LL-MEAN                VALUE 'M'.          ERCACCT
   602             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.          ERCACCT
   603         16  AM-EARN-METHOD-A              PIC X.                 ERCACCT
   604             88 AM-REF-AH-R78                 VALUE 'R'.          ERCACCT
   605             88 AM-REF-AH-PR                  VALUE 'P'.          ERCACCT
   606             88 AM-REF-AH-MEAN                VALUE 'M'.          ERCACCT
   607             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.          ERCACCT
   608             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.          ERCACCT
   609             88 AM-REF-AH-NET                 VALUE 'N'.          ERCACCT
   610                                                                  ERCACCT
   611     12  AM-TOL-PREM                       PIC S999V99    COMP-3. ERCACCT
   612     12  AM-TOL-REF                        PIC S999V99    COMP-3. ERCACCT
   613     12  AM-TOL-CLM                        PIC S999V99    COMP-3. ERCACCT
   614                                                                  ERCACCT
   615     12  AM-RET-Y-N                        PIC X.                 ERCACCT
   616     12  AM-RET-P-E                        PIC X.                 ERCACCT
   617     12  AM-LF-RET                         PIC S9V9999    COMP-3. ERCACCT
   618     12  AM-AH-RET                         PIC S9V9999    COMP-3. ERCACCT
   619     12  AM-RET-GRP                        PIC X(6).              ERCACCT
   620     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.                    ERCACCT
   621         16  AM-POOL-PRIME                 PIC XXX.               ERCACCT
   622         16  AM-POOL-SUB                   PIC XXX.               ERCACCT
   623     12  AM-RETRO-EARNINGS.                                       ERCACCT
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  14
* DCC043.cbl (/apps/prod/cid1p/copy/ERCACCT)
   624         16  AM-RET-EARN-R                 PIC X.                 ERCACCT
   625         16  AM-RET-EARN-L                 PIC X.                 ERCACCT
   626         16  AM-RET-EARN-A                 PIC X.                 ERCACCT
   627     12  AM-RET-ST-TAX-USE                 PIC X.                 ERCACCT
   628         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.  ERCACCT
   629         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.      ERCACCT
   630     12  AM-RETRO-BEG-EARNINGS.                                   ERCACCT
   631         16  AM-RET-BEG-EARN-R             PIC X.                 ERCACCT
   632         16  AM-RET-BEG-EARN-L             PIC X.                 ERCACCT
   633         16  AM-RET-BEG-EARN-A             PIC X.                 ERCACCT
   634     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3. ERCACCT
   635     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3. ERCACCT
   636                                                                  ERCACCT
   637     12  AM-USER-SELECT-OPTIONS.                                  ERCACCT
   638         16  AM-USER-SELECT-1              PIC X(10).             ERCACCT
   639         16  AM-USER-SELECT-2              PIC X(10).             ERCACCT
   640         16  AM-USER-SELECT-3              PIC X(10).             ERCACCT
   641         16  AM-USER-SELECT-4              PIC X(10).             ERCACCT
   642         16  AM-USER-SELECT-5              PIC X(10).             ERCACCT
   643                                                                  ERCACCT
   644     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3. ERCACCT
   645                                                                  ERCACCT
   646     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3. ERCACCT
   647                                                                  ERCACCT
   648     12  AM-RPT045A-SWITCH                 PIC X.                 ERCACCT
   649         88  RPT045A-OFF                   VALUE 'N'.             ERCACCT
   650                                                                  ERCACCT
   651     12  AM-INSURANCE-LIMITS.                                     ERCACCT
   652         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3. ERCACCT
   653         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3. ERCACCT
   654                                                                  ERCACCT
   655     12  AM-PROFILE-CHANGE-SWITCH          PIC X.                 ERCACCT
   656         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.          ERCACCT
   657                                                                  ERCACCT
   658     12  AM-DISMBR-COVERAGE-SW             PIC X.                 ERCACCT
   659         88  AM-DISMBR-COVERAGE               VALUE 'Y'.          ERCACCT
   660         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.          ERCACCT
   661                                                                  ERCACCT
   662     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3. ERCACCT
   663                                                                  ERCACCT
   664     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3. ERCACCT
   665     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
   666     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
   667     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
   668     12  AM-DCC-UEF-STATE                  PIC XX.
   669     12  FILLER                            PIC XXX.
   670     12  AM-REPORT-CODE-3                  PIC X(10).
   671*    12  FILLER                            PIC X(22).             ERCACCT
   672                                                                  ERCACCT
   673     12  AM-RESERVE-DATE.                                         ERCACCT
   674         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.    ERCACCT
   675         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.    ERCACCT
   676         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.    ERCACCT
   677                                                                  ERCACCT
   678     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.                ERCACCT
   679     12  AM-NOTIFICATION-TYPES.                                   ERCACCT
   680         16  AM-NOTIF-OF-LETTERS           PIC X.                 ERCACCT
   681         16  AM-NOTIF-OF-PAYMENTS          PIC X.                 ERCACCT
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  15
* DCC043.cbl (/apps/prod/cid1p/copy/ERCACCT)
   682         16  AM-NOTIF-OF-REPORTS           PIC X.                 ERCACCT
   683         16  AM-NOTIF-OF-STATUS            PIC X.                 ERCACCT
   684                                                                  ERCACCT
   685     12  AM-BENEFIT-TABLE-USAGE            PIC X.                 ERCACCT
   686         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.          ERCACCT
   687         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.          ERCACCT
   688         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.          ERCACCT
   689         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.     ERCACCT
   690                                                                  ERCACCT
   691     12  AM-BENEFIT-CONTROLS.                                     ERCACCT
   692         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.            ERCACCT
   693             20  AM-BENEFIT-CODE           PIC XX.                ERCACCT
   694             20  AM-BENEFIT-TYPE           PIC X.                 ERCACCT
   695             20  AM-BENEFIT-REVISION       PIC XXX.               ERCACCT
   696             20  AM-BENEFIT-REM-TERM       PIC X.                 ERCACCT
   697             20  AM-BENEFIT-RETRO-Y-N      PIC X.                 ERCACCT
   698             20  FILLER                    PIC XX.                ERCACCT
   699         16  FILLER                        PIC X(80).             ERCACCT
   700                                                                  ERCACCT
   701     12  AM-TRANSFER-DATA.                                        ERCACCT
   702         16  AM-TRANSFERRED-FROM.                                 ERCACCT
   703             20  AM-TRNFROM-CARRIER        PIC X.                 ERCACCT
   704             20  AM-TRNFROM-GROUPING.                             ERCACCT
   705                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.               ERCACCT
   706                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.               ERCACCT
   707             20  AM-TRNFROM-STATE          PIC XX.                ERCACCT
   708             20  AM-TRNFROM-ACCOUNT.                              ERCACCT
   709                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).             ERCACCT
   710                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).              ERCACCT
   711             20  AM-TRNFROM-DTE            PIC XX.                ERCACCT
   712         16  AM-TRANSFERRED-TO.                                   ERCACCT
   713             20  AM-TRNTO-CARRIER          PIC X.                 ERCACCT
   714             20  AM-TRNTO-GROUPING.                               ERCACCT
   715                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.               ERCACCT
   716                 24  AM-TRNTO-GRP-PRIME    PIC XXX.               ERCACCT
   717             20  AM-TRNTO-STATE            PIC XX.                ERCACCT
   718             20  AM-TRNTO-ACCOUNT.                                ERCACCT
   719                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).              ERCACCT
   720                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).              ERCACCT
   721             20  AM-TRNTO-DTE              PIC XX.                ERCACCT
   722         16  FILLER                        PIC X(10).             ERCACCT
   723                                                                  ERCACCT
   724     12  AM-SAVED-REMIT-TO                 PIC 99.                ERCACCT
   725                                                                  ERCACCT
   726     12  AM-COMM-STRUCTURE-SAVED.                                 ERCACCT
   727         16  AM-DEFN-1-SAVED.                                     ERCACCT
   728             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.           ERCACCT
   729                 24  AM-AGT-SV             PIC X(10).             ERCACCT
   730                 24  AM-COM-TYP-SV         PIC X.                 ERCACCT
   731                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3. ERCACCT
   732                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3. ERCACCT
   733                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3. ERCACCT
   734                 24  AM-RECALC-LV-INDIC-SV PIC X.                 ERCACCT
   735                 24  FILLER                PIC X.                 ERCACCT
   736                 24  AM-GL-CODES-SV        PIC X.                 ERCACCT
   737                 24  AM-COM-CHARGEBACK-SV  PIC 99.                ERCACCT
   738                 24  FILLER                PIC X.                 ERCACCT
   739         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.       ERCACCT
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  16
* DCC043.cbl (/apps/prod/cid1p/copy/ERCACCT)
   740             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.            ERCACCT
   741                 24  FILLER                PIC X(11).             ERCACCT
   742                 24  AM-L-COMA-SV          PIC XXX.               ERCACCT
   743                 24  AM-J-COMA-SV          PIC XXX.               ERCACCT
   744                 24  AM-A-COMA-SV          PIC XXX.               ERCACCT
   745                 24  FILLER                PIC X(6).              ERCACCT
   746                                                                  ERCACCT
   747     12  AM-FLC-NET-PREMIUM-ALLOWANCE.                            ERCACCT
   748         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.                 ERCACCT
   749            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3. ERCACCT
   750            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3. ERCACCT
   751            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3. ERCACCT
   752                                                                  ERCACCT
   753     12  AM-ORIG-DEALER-NO                 PIC X(10).             ERCACCT
   754     12  FILLER                            PIC X(120).            ERCACCT
   755                                                                  ERCACCT
   756     12  AM-ACCOUNT-EXECUTIVE-DATA.                               ERCACCT
   757         16  AM-CONTROL-NAME               PIC X(30).             ERCACCT
   758         16  AM-EXECUTIVE-ONE.                                    ERCACCT
   759             20  AM-EXEC1-NAME             PIC X(15).             ERCACCT
   760             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)       ERCACCT
   761                                                          COMP-3. ERCACCT
   762             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)       ERCACCT
   763                                                          COMP-3. ERCACCT
   764         16  AM-EXECUTIVE-TWO.                                    ERCACCT
   765             20  AM-EXEC2-NAME             PIC X(15).             ERCACCT
   766             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)       ERCACCT
   767                                                          COMP-3. ERCACCT
   768             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)       ERCACCT
   769                                                          COMP-3. ERCACCT
   770                                                                  ERCACCT
   771     12  AM-RETRO-ADDITIONAL-DATA.                                ERCACCT
   772         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3. ERCACCT
   773         16  AM-RETRO-PREM-P-E             PIC X.                 ERCACCT
   774         16  AM-RETRO-CLMS-P-I             PIC X.                 ERCACCT
   775         16  AM-RETRO-RET-BRACKET-LF.                             ERCACCT
   776             20  AM-RETRO-RET-METHOD-LF    PIC X.                 ERCACCT
   777                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.      ERCACCT
   778                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.          ERCACCT
   779             20  AM-RETRO-RET-BASIS-LF     PIC X.                 ERCACCT
   780                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.      ERCACCT
   781                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.          ERCACCT
   782             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.           ERCACCT
   783                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3. ERCACCT
   784                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3. ERCACCT
   785         16  AM-RETRO-RET-BRACKET-AH.                             ERCACCT
   786             20  AM-RETRO-RET-METHOD-AH    PIC X.                 ERCACCT
   787                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.      ERCACCT
   788                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.          ERCACCT
   789                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.          ERCACCT
   790             20  AM-RETRO-RET-BASIS-AH     PIC X.                 ERCACCT
   791                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.      ERCACCT
   792                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.          ERCACCT
   793             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.           ERCACCT
   794                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3. ERCACCT
   795                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3. ERCACCT
   796                                                                  ERCACCT
   797     12  AM-COMMENTS.                                             ERCACCT
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  17
* DCC043.cbl (/apps/prod/cid1p/copy/ERCACCT)
   798         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.ERCACCT
   799                                                                  ERCACCT
   800     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.         ERCACCT
   801         16  AM-FLI-RETRO-SHARE-CODE       PIC X.                 ERCACCT
   802         16  AM-FLI-BILLING-CODE           PIC X.                 ERCACCT
   803         16  AM-FLI-ALT-STATE-CODE         PIC XX.                ERCACCT
   804         16  AM-FLI-UNITED-IDENT           PIC X.                 ERCACCT
   805         16  AM-FLI-INTEREST-LOST-DATA.                           ERCACCT
   806             20  AM-FLI-BANK-NO            PIC X(5).              ERCACCT
   807             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3. ERCACCT
   808             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3. ERCACCT
   809             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3. ERCACCT
   810         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.            ERCACCT
   811             20  AM-FLI-AGT                PIC X(9).              ERCACCT
   812             20  AM-FLI-AGT-COMM-ACC       PIC X.                 ERCACCT
   813             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3. ERCACCT
   814         16  FILLER                        PIC X(102).            ERCACCT
   815                                                                  ERCACCT
   816     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.         ERCACCT
   817         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.          ERCACCT
   818             20  AM-BENEFIT-DMD-CODE         PIC XX.              ERCACCT
   819             20  AM-BENEFIT-DMD-TYPE         PIC X.               ERCACCT
   820             20  AM-BENEFIT-DMD-REVISION     PIC XXX.             ERCACCT
   821             20  AM-BENEFIT-DMD-REM-TERM     PIC X.               ERCACCT
   822             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.               ERCACCT
   823         16  FILLER                          PIC X(10).           ERCACCT
   824******************************************************************ERCACCT
   825
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  18
* DCC043.cbl
   827 FD  ERPLAN-IN.
*  828                             COPY ERCPLAN.
   829******************************************************************04/29/98
   830*                                                                *ERCPLAN
   831*                                                                *ERCPLAN
   832*                            ERCPLAN                             *   LV003
   833*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
   834*                            VMOD=2.003                          *   CL**2
   835*                                                                *ERCPLAN
   836*   CREDIT SYSTEM ACCOUNT PLAN MASTER FILE                       *ERCPLAN
   837*                                                                *ERCPLAN
   838*   THIS COPYBOOK IS USED FOR THE ONLINE VSAM ACCOUNT            *ERCPLAN
   839*   PLAN MASTER                                                  *ERCPLAN
   840*                                                                *ERCPLAN
   841*   FILE DESCRIPTION = ACCOUNT OR PRODUCER PLAN MASTER           *ERCPLAN
   842*                                                                *ERCPLAN
   843*   FILE TYPE = VSAM,KSDS                                        *ERCPLAN
   844*   RECORD SIZE = 420   RECFORM = FIX                            *ERCPLAN
   845*                                                                *ERCPLAN
   846*   BASE CLUSTER NAME = ERPLAN                    RKP=2,LEN=26   *ERCPLAN
   847*       ALTERNATE PATH1 = N/A                                    *ERCPLAN
   848*                                                                *ERCPLAN
   849*   LOG = NO                                                     *ERCPLAN
   850*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *ERCPLAN
   851*                                                                *ERCPLAN
   852*                                                                *ERCPLAN
   853******************************************************************ERCPLAN
   854                                                                  ERCPLAN
   855 01  PLAN-MASTER.                                                 ERCPLAN
   856     12  PL-RECORD-ID                      PIC XX.                ERCPLAN
   857         88  VALID-PL-ID                      VALUE 'PL'.         ERCPLAN
   858                                                                  ERCPLAN
   859     12  PL-CONTROL-PRIMARY.                                      ERCPLAN
   860         16  PL-COMPANY-CD                 PIC X.                 ERCPLAN
   861         16  PL-MSTR-CNTRL.                                       ERCPLAN
   862             20  PL-CONTROL-A.                                    ERCPLAN
   863                 24  PL-CARRIER            PIC X.                 ERCPLAN
   864                 24  PL-GROUPING           PIC X(6).              ERCPLAN
   865                 24  PL-STATE              PIC XX.                ERCPLAN
   866                 24  PL-ACCOUNT            PIC X(10).             ERCPLAN
   867             20  PL-BENEFIT-TYPE           PIC X.                 ERCPLAN
   868             20  PL-BENEFIT-CODE           PIC XX.                ERCPLAN
   869             20  PL-REVISION-NO            PIC X(3).              ERCPLAN
   870                                                                  ERCPLAN
   871     12  PL-CONTROL-BY-VAR-GRP.                                   ERCPLAN
   872         16  PL-COMPANY-CD-A1              PIC X.                 ERCPLAN
   873         16  PL-VG-CARRIER                 PIC X.                 ERCPLAN
   874         16  PL-VG-GROUPING                PIC X(6).              ERCPLAN
   875         16  PL-VG-STATE                   PIC XX.                ERCPLAN
   876         16  PL-VG-ACCOUNT                 PIC X(10).             ERCPLAN
   877         16  PL-BENEFIT-TYPE-A1            PIC X.                 ERCPLAN
   878         16  PL-BENEFIT-CODE-A1            PIC XX.                ERCPLAN
   879         16  PL-REVISION-NO-A1             PIC 999.               ERCPLAN
   880                                                                  ERCPLAN
   881     12  PL-MAINT-INFORMATION.                                    ERCPLAN
   882         16  PL-LAST-MAINT-DT              PIC XX.                ERCPLAN
   883         16  PL-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3. ERCPLAN
   884         16  PL-LAST-MAINT-USER            PIC X(4).              ERCPLAN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  19
* DCC043.cbl (/apps/prod/cid1p/copy/ERCPLAN)
   885         16  FILLER                        PIC XX.                ERCPLAN
   886                                                                  ERCPLAN
   887     12  PL-LIABILITY-LIMITS.                                     ERCPLAN
   888         16  PL-ATT-AGE                    PIC S99        COMP-3. ERCPLAN
   889         16  PL-L-LIMITS        OCCURS 8 TIMES.                   ERCPLAN
   890             20  PL-LM-AGE                 PIC S99        COMP-3. ERCPLAN
   891             20  PL-LM-DUR                 PIC S999       COMP-3. ERCPLAN
   892             20  PL-LM-MOA                 PIC S9(4)      COMP-3. ERCPLAN
   893             20  PL-LM-AMT                 PIC S9(6)      COMP-3. ERCPLAN
   894                                                                  ERCPLAN
   895     12  FILLER                            PIC X(30).             ERCPLAN
   896                                                                  ERCPLAN
   897     12  PL-GL-ACCOUNT-NOS.                                       ERCPLAN
   898         16  PL-PREMIUM-GL                 PIC X(8).              ERCPLAN
   899         16  PL-COMM-GL                    PIC X(8).              ERCPLAN
   900         16  PL-CLAIM-GL                   PIC X(8).              ERCPLAN
   901     12  FILLER                            PIC X(24).             ERCPLAN
   902     12  PL-TOLERANCES.                                           ERCPLAN
   903         16  PL-TOL-PREM-AMT               PIC S999V99    COMP-3. ERCPLAN
   904         16  PL-TOL-REF-AMT                PIC S999V99    COMP-3. ERCPLAN
   905         16  PL-TOL-CLM-AMT                PIC S999V99    COMP-3. ERCPLAN
   906         16  PL-TOL-PREM-PCT               PIC S9V9999    COMP-3. ERCPLAN
   907         16  PL-TOL-REF-PCT                PIC S9V9999    COMP-3. ERCPLAN
   908         16  PL-TOL-CLM-PCT                PIC S9V9999    COMP-3. ERCPLAN
   909     12  PL-OVER-SHORT.                                           ERCPLAN
   910         16  PL-OVER-SHORT-AMT             PIC S999V99    COMP-3. ERCPLAN
   911         16  PL-OVER-SHORT-PCT             PIC S9V9(4)    COMP-3. ERCPLAN
   912     12  FILLER                            PIC X(24).             ERCPLAN
   913     12  PLAN-MISC.                                               ERCPLAN
   914         16  PL-POLICY-FEE                 PIC S9(3)V99   COMP-3. ERCPLAN
   915         16  PL-STATE-TAX                  PIC S9V9999    COMP-3. ERCPLAN
   916         16  PL-IG                         PIC X.                 ERCPLAN
   917         16  PL-RETRO-RET                  PIC S9V9999    COMP-3. ERCPLAN
   918         16  PL-POLICY-FORM                PIC X(12).             ERCPLAN
   919         16  PL-EDIT-FOR-FORM              PIC X(01).             ERCPLAN
   920         16  PL-DEV-CODE                   PIC XXX.               ERCPLAN
   921         16  PL-DEV-PCT                    PIC S9V9(6)    COMP-3. ERCPLAN
   922         16  PL-CALC-METHOD                PIC X.                 ERCPLAN
   923         16  PL-BENEFIT-GROUP              PIC X(05).             ERCPLAN
   924         16  PL-SALES-TAX                  PIC S9V9999    COMP-3. ERCPLAN
   925                                                                  ERCPLAN
   926         16  FILLER                        PIC X(99).             ERCPLAN
   927******************************************************************ERCPLAN
   928
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  20
* DCC043.cbl
   930 FD  DISK-DATE
*  931                             COPY ELCDTEFD.
   932******************************************************************04/15/98
   933*                                                                *ELCDTEFD
   934*                                                                *ELCDTEFD
   935*                            ELCDTEFD.                           *   LV002
   936*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
   937*                            VMOD=2.007                          *   CL**2
   938*                                                                *ELCDTEFD
   939******************************************************************ELCDTEFD
   940     BLOCK CONTAINS 0 RECORDS
   941     RECORDING MODE F.                                            ELCDTEFD
   942                                                                  ELCDTEFD
   943 01  DATE-DISK.                                                   ELCDTEFD
   944     12  DD-ID                       PIC  X(4).                   ELCDTEFD
   945     12  FILLER                      PIC  X(14).                  ELCDTEFD
   946     12  DD-CR1                      PIC  9.                      ELCDTEFD
   947     12  DD-CR1N                     PIC  X(30).                  ELCDTEFD
   948     12  DD-CR2                      PIC  9.                      ELCDTEFD
   949     12  DD-CR2N                     PIC  X(30).                  ELCDTEFD
   950     12  FILLER                      PIC  X(20).                  ELCDTEFD
   951                                                                  ELCDTEFD
   952 01  DATE-DISK-R.                                                 ELCDTEFD
   953     12  FILLER                      PIC  X(4).                   ELCDTEFD
   954     12  DD-ST           OCCURS 3 TIMES                           ELCDTEFD
   955                                     PIC  X(32).                  ELCDTEFD
   956                                                                  ELCDTEFD
   957 01  DATE-DISK-T.                                                 ELCDTEFD
   958     12  FILLER                      PIC  X(4).                   ELCDTEFD
   959     12  DD-TYPE         OCCURS 2 TIMES                           ELCDTEFD
   960                                     PIC  X(48).                  ELCDTEFD
   961                                                                  ELCDTEFD
   962 01  DATE-DISK-M.                                                 ELCDTEFD
   963     12  FILLER                      PIC  X(4).                   ELCDTEFD
   964     12  DD-MORT         OCCURS 2 TIMES                           ELCDTEFD
   965                                     PIC  X(48).                  ELCDTEFD
   966                                                                  ELCDTEFD
   967 01  DATE-DISK-P.                                                 ELCDTEFD
   968     12  DD-IDA                      PIC  XX.                     ELCDTEFD
   969     12  DD-IDX                      PIC  99.                     ELCDTEFD
   970     12  DD-DATA                     PIC  X(96).                  ELCDTEFD
   971     12  FILLER  REDEFINES DD-DATA.                               ELCDTEFD
   972         16  DD-PS-PIC   OCCURS 50 TIMES                          ELCDTEFD
   973                                     PIC  X.                      ELCDTEFD
   974         16  FILLER                  PIC  X(46).                  ELCDTEFD
   975     12  FILLER  REDEFINES DD-DATA.                               ELCDTEFD
   976         16  DD-PS-PICO  OCCURS 20 TIMES.                         ELCDTEFD
   977             20  DD-PS-PRT           PIC  X.                      ELCDTEFD
   978             20  DD-PS-FMT           PIC  X.                      ELCDTEFD
   979             20  DD-PS-PRC           PIC  X.                      ELCDTEFD
   980             20  DD-PS-TOT           PIC  X.                      ELCDTEFD
   981         16  FILLER                  PIC  X(16).                  ELCDTEFD
   982                                                                  ELCDTEFD
   983 01  DATE-DISK-E.                                                 ELCDTEFD
   984     12  FILLER                      PIC  X(4).                   ELCDTEFD
   985     12  DD-EDIT         OCCURS 24 TIMES                          ELCDTEFD
   986                                     PIC  X(4).                   ELCDTEFD
   987                                                                  ELCDTEFD
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  21
* DCC043.cbl (/apps/prod/cid1p/copy/ELCDTEFD)
   988 01  DATE-DISK-C.                                                 ELCDTEFD
   989     12  FILLER                      PIC  X(7).                   ELCDTEFD
   990     12  DD-CARR1-SECPAY-SW          PIC  X.
   991     12  DD-CARR1-UEP-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   992     12  DD-CARR1-R78-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   993     12  DD-CARR1-PRO-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   994     12  DD-CARR1                    PIC  X.                      ELCDTEFD
   995     12  DD-CARR1S                   PIC  XX.                     ELCDTEFD
   996     12  DD-CARR1N                   PIC  X(30).                  ELCDTEFD
   997     12  DD-CARR2                    PIC  X.                      ELCDTEFD
   998     12  DD-CARR2S                   PIC  XX.                     ELCDTEFD
   999     12  DD-CARR2N                   PIC  X(30).                  ELCDTEFD
  1000     12  DD-CARR2-UEP-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
  1001     12  DD-CARR2-R78-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
  1002     12  DD-CARR2-PRO-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
  1003     12  DD-CARR2-SECPAY-SW          PIC  X.
  1004     12  FILLER                      PIC  X(7).                   ELCDTEFD
  1005                                                                  ELCDTEFD
  1006 01  DATE-DISK-OPT.                                               ELCDTEFD
  1007     12  FILLER                      PIC  X(04).                  ELCDTEFD
  1008     12  DD-TLR-DATA.                                             ELCDTEFD
  1009         16  DD-TLR                  OCCURS 32 TIMES              ELCDTEFD
  1010                                     PIC  X(03).                  ELCDTEFD
  1011     12  DD-STATE-DATA REDEFINES DD-TLR-DATA.                     ELCDTEFD
  1012         16  DD-STATE-FLDS           OCCURS 16 TIMES              ELCDTEFD
  1013                                     PIC  X(06).                  ELCDTEFD
  1014     12  DD-CARR-DATA REDEFINES DD-TLR-DATA.                      ELCDTEFD
  1015         16  DD-CARR-FLDS            OCCURS 13 TIMES              ELCDTEFD
  1016                                     PIC  X(07).                  ELCDTEFD
  1017         16  FILLER                  PIC  X(05).                  ELCDTEFD
  1018     12  DD-MISC-DATA REDEFINES DD-TLR-DATA                       ELCDTEFD
  1019                                     PIC  X(96).                  ELCDTEFD
  1020******************************************************************ELCDTEFD
  1021
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  22
* DCC043.cbl
  1023 FD  FICH
* 1024                             COPY ELCFCHFD.
  1025******************************************************************04/15/98
  1026*                                                                *ELCFCHFD
  1027*                            ELCFCHFD.                           *   LV003
  1028*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  1029*                            VMOD=2.004                          *   CL**3
  1030*                                                                *ELCFCHFD
  1031******************************************************************ELCFCHFD
  1032     BLOCK CONTAINS 0 RECORDS
  1033     RECORDING MODE F.                                            ELCFCHFD
  1034                                                                  ELCFCHFD
  1035 01  FICH-REC                            PIC   X(133).            ELCFCHFD
  1036******************************************************************ELCFCHFD
  1037
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  23
* DCC043.cbl
  1039 WORKING-STORAGE SECTION.
  1040
  1041 77  FILLER  PIC X(32) VALUE '********************************'.
  1042 77  FILLER  PIC X(32) VALUE '     DCC043 WORKING STORAGE     '.
  1043 77  FILLER  PIC X(32) VALUE '***********VMOD=2.001 **********'.
  1044
  1045 77  NO-OF-RECORDS-RELEASED  PIC S9(9)      COMP-3  VALUE +0.
  1046 77  NDX                     PIC S999            COMP.
  1047 77  SA                      PIC S999            COMP.
  1048 77  SB                      PIC S999            COMP.
  1049 77  SC                      PIC S999            COMP.
  1050 77  SE                      PIC S999            COMP.
  1051 77  SF                      PIC S999            COMP.
  1052 77  SG                      PIC S999            COMP.
  1053 77  SH                      PIC S999            COMP.
  1054 77  CL                      PIC S999            COMP.
  1055 77  AL                      PIC S999            COMP.
  1056 77  AN                      PIC S999            COMP.
  1057 77  WS-SEQ-NBR              PIC S9              COMP   VALUE +0.
  1058 77  PAGE-CNT                PIC S9(5)           COMP-3 VALUE +0.
  1059 77  LINE-CNT                PIC S999            COMP-3 VALUE +99.
  1060 77  PGM-SUB                 PIC S999            COMP-3 VALUE +43.
  1061 77  X                       PIC X.
  1062 77  BREAK-1-SWITCH          PIC X       VALUE SPACES.
  1063 77  WS-EP-CODE              PIC X.
  1064 77  WS-OB-CODE              PIC X.
  1065 77  SAVE-DA-UP              PIC S9(9)V99.
  1066 77  SAVE-DA-UC              PIC S9(9)V99.
  1067 77  SAVE-DA-GA-UC           PIC S9(9)V99.
  1068 77  SAVE-DA-PCT-E-PREM      PIC S9(9)V99.
  1069 77  SAVE-DA-PCT-UP          PIC S9(9)V99.
  1070 77  SAVE-BEG-DATE           PIC 9(11)     VALUE ZERO.
  1071 77  WS-RETRO-FLAG           PIC X.
  1072
  1073 01  SPACE-LINE                PIC X(132)  VALUE SPACES.
  1074
  1075 01  WS-ABEND-STORAGE.
  1076     12  WS-RETURN-CODE        PIC S9(4)   VALUE ZERO COMP.
  1077     12  WS-ABEND-MESSAGE      PIC X(80)   VALUE SPACES.
  1078     12  WS-ABEND-FILE-STATUS  PIC XX      VALUE ZERO.
  1079     12  WS-ZERO               PIC S9      VALUE ZERO COMP-3.
  1080
  1081     12  WS-ABEND-CODE         PIC 9(4).
  1082     12  WORK-ABEND-CODE       REDEFINES     WS-ABEND-CODE.
  1083         16  W-ABEND-CODE-1    PIC XX.
  1084         16  W-ABEND-CODE-2    PIC XX.
  1085     12  ERACCTT-FILE-STATUS   PIC XX.
  1086     12  ERPLAN-FILE-STATUS    PIC XX.
  1087
  1088 01  WORK-MSG.
  1089     05  FILLER              PIC X    VALUE SPACE.
  1090     05  W-MM                PIC XX.
  1091     05  FILLER              PIC X    VALUE '/'.
  1092     05  W-DD                PIC XX.
  1093     05  FILLER              PIC X    VALUE '/'.
  1094     05  W-CCYY              PIC X(4).
  1095     05  FILLER        PIC X(9)  VALUE ' TO DATE '.
  1096
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  24
* DCC043.cbl
  1097 01  FORMAT-CONTROL-CARD.
  1098     05  FC-ID               PIC XX.
  1099     05  FC-CLIENT           PIC XXX.
  1100     05  FC-CODE             PIC X.
  1101     05  FC-DATE             PIC 9(8).
  1102     05  FC-DATE-R  REDEFINES  FC-DATE.
  1103         10  FC-CCYY         PIC 9(04).
  1104         10  FC-CCYR REDEFINES FC-CCYY.
  1105             15  FC-CC       PIC 99.
  1106             15  FC-YY       PIC 99.
  1107         10  FC-MM           PIC 99.
  1108         10  FC-DD           PIC 99.
  1109     05  FILLER              PIC X(66).
  1110
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  25
* DCC043.cbl
  1112 01  SW-REC.
  1113     12  SW-RPT-TYPE-ID      PIC X.
  1114         88  ACCOUNT-RPT        VALUE 'A'.
  1115         88  RETRO-GROUP-RPT    VALUE 'B'.
  1116         88  GA-ACCOUNT-RPT     VALUE 'C'.
  1117     12  SW-CTL.
  1118         16  SW-GA           PIC X(10).
  1119         16  SW-CARR         PIC X.
  1120         16  SW-COMP         PIC XXXXXX.
  1121         16  SW-STATE        PIC XX.
  1122         16  SW-ACCT         PIC X(10).
  1123         16  SW-EXP-DT       PIC 9(11)  COMP-3.
  1124     12  SW-EFF-DT           PIC 9(11)  COMP-3.
  1125     12  SW-NAME             PIC X(30).
  1126     12  SW-ADDRS            PIC X(20).
  1127     12  SW-CITY             PIC X(20).
  1128     12  SW-ZIP.
  1129         16  SW-ZIP-PRIME.
  1130             20  FILLER      PIC X(01).
  1131                 88  SW-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  1132             20  FILLER      PIC X(04).
  1133         16  SW-ZIP-PLUS4    PIC X(04).
  1134     12  SW-CANADIAN-POSTAL-CODES REDEFINES SW-ZIP.
  1135         16  SW-CAN-POST-CODE-1
  1136                             PIC X(03).
  1137         16  SW-CAN-POST-CODE-2
  1138                             PIC X(03).
  1139         16  FILLER          PIC X(03).
  1140     12  SW-LRET             PIC S9V9(4)     COMP-3.
  1141     12  SW-ARET             PIC S9V9(4)     COMP-3.
  1142     12  SW-RET-Y-N          PIC X.
  1143     12  SW-RET-TYP          PIC X.
  1144     12  SW-GA-FLAG          PIC X.
  1145     12  SW-ACCUMS           PIC X(1080).
  1146     12  SW-BEG-DATE         PIC 9(11)       COMP-3.
  1147     12  SW-RETRO-LIMIT      PIC S9(7)       COMP-3.
  1148     12  SW-PREM-P-E         PIC X.
  1149     12  SW-CLMS-P-I         PIC X.
  1150     12  FILLER              PIC X(12).
  1151
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  26
* DCC043.cbl
  1153 01  WS-ACCT-CONTROL.
  1154     12  WS-MSTR-CNTRL       PIC X(25)   VALUE LOW-VALUES.
  1155     12  WS-EFFECT           PIC 9(11)  COMP-3  VALUE ZEROS.
  1156
  1157 01  WS-SAVE-CONTROL.
  1158     12  WS-SAVE-CARR        PIC X.
  1159     12  WS-SAVE-COMP        PIC XXXXXX.
  1160     12  WS-SAVE-STATE       PIC XX.
  1161     12  WS-SAVE-ACCT        PIC X(10).
  1162     12  WS-SAVE-EXP-DATE    PIC 9(11)  COMP-3.
  1163     12  WS-SAVE-EFF-DATE    PIC 9(11)  COMP-3.
  1164
  1165 01  ws-prev-rpt-type        pic x.
  1166 01  WS-SAVE-CTL.
  1167     12  WS-SAVE-GA          PIC X(10).
  1168     12  WS-SAVE-CAR         PIC X.
  1169     12  WS-SAVE-CMP         PIC XXXXXX.
  1170     12  WS-SAVE-ST          PIC XX.
  1171     12  WS-SAVE-ACC         PIC X(10).
  1172     12  WS-SAVE-EXP         PIC 9(11)  COMP-3.
  1173
  1174 01  WS-PLAN-CONTROL.
  1175     12  WS-PL-COMPANY-CD    PIC X          VALUE SPACE.
  1176     12  WS-PL-CONTROL-A.
  1177         16  WS-PL-CARRIER       PIC X      VALUE SPACE.
  1178         16  WS-PL-GROUPING      PIC X(6)   VALUE SPACES.
  1179         16  WS-PL-STATE         PIC XX     VALUE SPACES.
  1180         16  WS-PL-ACCOUNT       PIC X(10)  VALUE SPACES.
  1181     12  WS-PL-BENEFIT-TYPE  PIC X          VALUE SPACE.
  1182     12  WS-PL-BENEFIT-CODE  PIC XX         VALUE SPACE.
  1183     12  WS-PL-REVISION-NO   PIC X(3)       VALUE SPACES.
  1184
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  27
* DCC043.cbl
  1186 01  MISC.
  1187     12  RETENT-FACT         PIC S9V9(5)   VALUE +0.
  1188     12  ERP-PERCENT         PIC S9V9(5)   VALUE +0.
  1189     12  EXP-FACTOR          PIC S9V9(5)   VALUE +0.
  1190     12  LIFE-RETENT         PIC S9V9(5)     COMP-3  VALUE +0.
  1191     12  AH-RETENT           PIC S9V9(5)     COMP-3  VALUE +0.
  1192     12  SAVE-RETRO-LIMIT    PIC S9(7)       COMP-3.
  1193     12  ANNUALIZED-PREM     PIC S9(9)V99    COMP-3.
  1194     12  WS-MIN-LOSS         PIC S9(5)V99    COMP-3.
  1195     12  HEAD-SW             PIC X         VALUE SPACE.
  1196     12  NBR-OF-MTHS         PIC 99        VALUE 12.
  1197     12  SAVE-GA-FLAG        PIC X.
  1198     12  SAVE-RET-Y-N        PIC X.
  1199     12  SAVE-RET-TYP        PIC X.
  1200     12  SAVE-PREM-P-E       PIC X.
  1201     12  SAVE-CLMS-P-I       PIC X.
  1202     12  WS-EXCLUSION-SWITCH PIC X             VALUE SPACE.
  1203         88  EXCLUDING-BENEFIT  VALUE '*'.
  1204
  1205 01  BEG-DATE                PIC 9(11).
  1206 01  BEG-DATE-R REDEFINES BEG-DATE.
  1207     12 FILLER               PIC 999.
  1208     12  BD-CCYY             PIC 9(04).
  1209     12  BD-CCYR REDEFINES BD-CCYY.
  1210         16  BD-CC           PIC 99.
  1211         16  BD-YR           PIC 99.
  1212     12  BD-MO               PIC 99.
  1213     12  BD-DA               PIC 99.
  1214
  1215 01  RUN-DT                  PIC 9(11).
  1216 01  RUN-DT-R REDEFINES RUN-DT.
  1217     12  FILLER              PIC 999.
  1218     12  RD-CCYY             PIC 9(04).
  1219     12  RD-CCYR REDEFINES RD-CCYY.
  1220         16  RD-CC           PIC 99.
  1221         16  RD-YR           PIC 99.
  1222     12  RD-MO               PIC 99.
  1223     12  RD-DA               PIC 99.
  1224
  1225 01  WORK-DATE           PIC 9(11).
  1226 01  WORK-DATE-R  REDEFINES  WORK-DATE.
  1227     12  FILLER          PIC 999.
  1228     12  WK-CCYY         PIC 9(04).
  1229     12  WK-CCYR REDEFINES WK-CCYY.
  1230         16  WK-CC       PIC 99.
  1231         16  WK-YR       PIC 99.
  1232     12  WK-MO           PIC 99.
  1233     12  WK-DA           PIC 99.
  1234
  1235 01  ZONE-GROUP.
  1236     03  ZON                 PIC XXX       VALUE 'ZON'.
  1237     03  Z-G                 PIC XXX.
  1238
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  28
* DCC043.cbl
  1240*
  1241*  1 lf beg 2 ah beg  3 life end 4 ah end
  1242***     da-isp    issue premium
  1243***     da-tax    premium tax
  1244***     da-cnp    cancel premium
  1245***     da-up     uep iss - cnc - earn prem
  1246***     da-clm    claim pmts
  1247***     da-exp    retro expenses
  1248***     da-cps    retro payments
  1249***     da-otc    retro other comm
  1250***     da-lrv    claim reserves, ptc+fut+ibnr
  1251***     da-caj    claim adjustment
  1252***     da-isc    account comm c or d agt typs
  1253***     da-cnc    account cnc comm
  1254***     da-uc     acct unearn comm
  1255***     da-isc-addl o/w iss comm retro A
  1256***     da-cnc-addl o/w cnc comm retro a
  1257***     da-uc-addl  o/w unearn   retro a
  1258***     da-ga-isc
  1259***     da-ga-cnc
  1260***     da-ga-uc
  1261***     da-pct-e-prem  net written * ret pct
  1262***     da-cso-admin  S agt type commission
  1263***     da ccc-admin  retention less S agt typ comm
  1264
  1265
  1266
  1267* THE DETAIL AND AGENTS ACCUMULATORS ARE USED AS FOLLOWS
  1268*
  1269*    OCCURRENCE 1 = LIFE BEGINNING DATA
  1270*    OCCURRENCE 2 = A&H BEGINNING DATA
  1271*    OCCURRENCE 3 = LIFE CURRENT DATA
  1272*    OCCURRENCE 4 = A&H CURRENT DATA
  1273*
  1274 01  DETAIL-ACCUMULATORS     COMP-3.
  1275     12  DETAIL-ACCUMS   OCCURS 4 TIMES.
  1276         16  DA-ISP          PIC S9(9)V99.
  1277         16  DA-TAX          PIC S9(9)V99.
  1278         16  DA-CNP          PIC S9(9)V99.
  1279         16  DA-UP           PIC S9(9)V99.
  1280         16  DA-CLM          PIC S9(9)V99.
  1281         16  DA-EXP          PIC S9(9)V99.
  1282         16  DA-CPS          PIC S9(9)V99.
  1283         16  DA-OTC          PIC S9(9)V99.
  1284         16  DA-LRV          PIC S9(9)V99.
  1285         16  DA-CAJ          PIC S9(9)V99.
  1286         16  DA-ISC          PIC S9(9)V99.
  1287         16  DA-CNC          PIC S9(9)V99.
  1288         16  DA-UC           PIC S9(9)V99.
  1289         16  DA-ISC-ADDL     PIC S9(9)V99.
  1290         16  DA-CNC-ADDL     PIC S9(9)V99.
  1291         16  DA-UC-ADDL      PIC S9(9)V99.
  1292         16  DA-GA-ISC       PIC S9(9)V99.
  1293         16  DA-GA-CNC       PIC S9(9)V99.
  1294         16  DA-GA-UC        PIC S9(9)V99.
  1295         16  DA-PCT-E-PREM   PIC S9(9)V99.
  1296         16  da-cso-admin    pic s9(9)v99.
  1297         16  da-ccc-admin    pic s9(9)v99.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  29
* DCC043.cbl
  1298
  1299 01  TEMP-GA-ACCUMS.
  1300     12  GA-LEVELS.
  1301         16  GA-LEVELS OCCURS 10 TIMES.
  1302             20  XDA-GA-NO       PIC X(10).
  1303             20  XDA-GA-TYPE     PIC X.
  1304             20  ACCUM-LEVELS OCCURS 4 TIMES.
  1305                 24  XDA-GA-ISC      PIC S9(9)V99    COMP-3.
  1306                 24  XDA-GA-CNC      PIC S9(9)V99    COMP-3.
  1307                 24  XDA-GA-UC       PIC S9(9)V99    COMP-3.
  1308
  1309 01  EC-REC-MAX                  PIC S99 COMP-3 VALUE +10.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  30
* DCC043.cbl
  1311*
  1312* THE PRINT ACCUMULATORS ARE USED AS FOLLOWS
  1313*
  1314*    A SET CONSISTS OF 6 ACCUMULATORS
  1315*
  1316*        OCCURRENCE 1 = LIFE TOTAL PERIOD
  1317*        OCCURRENCE 2 = A&H TOTAL FOR PERIOD
  1318*        OCCURRENCE 3 = COMBINED TOTAL FOR PERIOD
  1319*        OCCURRENCE 4 = LIFE TOTAL FOR INCEPTION-TO-DATE
  1320*        OCCURRENCE 5 = A&H TOTAL FOR INCEPTION-TO-DATE
  1321*        OCCURRENCE 6 = COMBINED TOTAL FOR INCEPTION-TO-DATE
  1322*
  1323*    THERE ARE 6 SETS
  1324*
  1325*        SET 1 = LEVEL 1 (DATE RANGE TOTALS)
  1326*        SET 2 = LEVEL 2 (ACCOUNT TOTALS)
  1327*        SET 3 = LEVEL 3 (STATE TOTALS)
  1328*        SET 4 = LEVEL 4 (COMPANY TOTALS)
  1329*        SET 5 = LEVEL 5 (CARRIER TOTALS)
  1330*        SET 6 = LEVEL 6 (FINAL TOTALS)
  1331*
  1332***     PA-NW   01 net written prem
  1333***     PA-BR   02 beg reserves
  1334***     PA-ER   03 end reserves
  1335***     PA-EP   04 earned premium
  1336***     PA-PE   05 pct of earned (100 - retention)
  1337***     PA-PL   06 Paid claims
  1338***     PA-BLR  07 beg loss reserves
  1339***     PA-ELR  08 end loss reserves
  1340***     PA-TL   09 total loss reserves
  1341***     PA-RC   10 retained comm (C&D AGT TYPS)
  1342***     PA-OC   11 other commission
  1343***     PA-TC   12 total commission
  1344***     PA-CP   13 retro payments
  1345***     PA-EX   14 state tax
  1346***     PA-TE   15 total expenses
  1347***     PA-BA   16 net balance or loss
  1348***     PA-NTE  17 net total expenses
  1349***     PA-NBA  18 pa-ep - pa-nte bal @ end of period
  1350***     PA-EC   19 earned commission
  1351***     PA-GARC 20 ga net commission
  1352***     PA-GAEC 21 ga earned commission
  1353***     PA-GACU 22 ga net commission
  1354***     PA-CU   23 written or earn based on option
  1355***     PA-GATC 24 acct comm + o/w comm
  1356***     PA-GAGT 25 pa-gaba - retro exp paid - pa-nba
  1357***     PA-GABA 26 pct of earned + pa-gate
  1358***     PA-GATE 27 net expenses + ga net comm
  1359
  1360***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_***
  1361***                                                            ***
  1362***  date range totals    01 ===> 06     lfper,ahper,totper    ***
  1363***                                      lfitd,ahitd,totitd    ***
  1364***  account    totals    07 ===> 12     lfper,ahper,totper    ***
  1365***                                      lfitd,ahitd,totitd    ***
  1366***  state      totals    13 ===> 18     lfper,ahper,totper    ***
  1367***                                      lfitd,ahitd,totitd    ***
  1368***  grouping   totals    19 ===> 24     lfper,ahper,totper    ***
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  31
* DCC043.cbl
  1369***                                      lfitd,ahitd,totitd    ***
  1370***  carrier    totals    25 ===> 30     lfper,ahper,totper    ***
  1371***                                      lfitd,ahitd,totitd    ***
  1372***  final      totals    31 ===> 36     lfper,ahper,totper    ***
  1373***                                      lfitd,ahitd,totitd    ***
  1374***                                                            ***
  1375***_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-***
  1376
  1377
  1378 01  PRINT-ACCUMULATORS      COMP-3.
  1379     12  PRINT-ACCUMS    OCCURS 36.
  1380         16  PA-NW           PIC S9(9)V99.     *> 01
  1381         16  PA-BR           PIC S9(9)V99.
  1382         16  PA-ER           PIC S9(9)V99.
  1383         16  PA-EP           PIC S9(9)V99.
  1384         16  PA-PE           PIC S9(9)V99.     *> 05
  1385         16  PA-PL           PIC S9(9)V99.
  1386         16  PA-BLR          PIC S9(9)V99.
  1387         16  PA-ELR          PIC S9(9)V99.
  1388         16  PA-TL           PIC S9(9)V99.
  1389         16  PA-RC           PIC S9(9)V99.     *>  10
  1390         16  PA-OC           PIC S9(9)V99.
  1391         16  PA-TC           PIC S9(9)V99.
  1392         16  PA-CP           PIC S9(9)V99.
  1393         16  PA-EX           PIC S9(9)V99.
  1394         16  PA-TE           PIC S9(9)V99.     *>  15
  1395         16  PA-BA           PIC S9(9)V99.
  1396         16  PA-NTE          PIC S9(9)V99.
  1397         16  PA-NBA          PIC S9(9)V99.
  1398         16  PA-EC           PIC S9(9)V99.
  1399         16  PA-GARC         PIC S9(9)V99.     *>  20
  1400         16  PA-GAEC         PIC S9(9)V99.
  1401         16  PA-GACU         PIC S9(9)V99.
  1402         16  PA-CU           PIC S9(9)V99.
  1403         16  PA-GATC         PIC S9(9)V99.
  1404         16  PA-GAGT         PIC S9(9)V99.     *>  25
  1405         16  PA-GABA         PIC S9(9)V99.
  1406         16  PA-GATE         PIC S9(9)V99.
  1407         16  pa-cso-admin    pic s9(9)v99.
  1408         16  pa-ccc-admin    pic s9(9)v99.
  1409         16  pa-tot-clp      pic s9(9)v99.     *>  30
  1410 01  PRINT-ACCUMULATORS-R    REDEFINES PRINT-ACCUMULATORS  COMP-3.
  1411     12  PRINT-ACCUMS-R  OCCURS 6.
  1412         16  PRINT-ACCUMS-SL OCCURS 6.
  1413             20  PRINT-ACCUMS-L OCCURS 30.
  1414                 24  PA-AMT  PIC S9(9)V99.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  32
* DCC043.cbl
  1416
  1417*
  1418* THE FOLLOWING ACCUMULATORS ARE FOR THE PERCENTS
  1419*    TO BE PRINTED ON THE RETRO
  1420*
  1421 01  PERCENT-ACCUMULATORS    COMP-3.
  1422     12  PER-ACCUMS      OCCURS 2.
  1423       14  PER-ACCUMS-X   OCCURS 30.
  1424         16  PT-PRCNT        PIC S9(4)V9(4).
  1425
  1426 01  DESC-TABLE.
  1427     12  FILLER              PIC X(33)   VALUE
  1428             '1. NET WRITTEN PREMIUM      00101'.
  1429     12  FILLER              PIC X(33)   VALUE
  1430             '2. PLUS BEGINNING RESERVE   00202'.
  1431     12  FILLER              PIC X(33)   VALUE
  1432             '3. LESS ENDING RESERVE      00303'.
  1433     12  FILLER              PIC X(33)   VALUE
  1434             '4. EARNED PREMIUM           00404'.
  1435     12  FILLER              PIC X(33)   VALUE
  1436             '5. PERCENT OF EARNED PREMIUM00505'.
  1437     12  FILLER              PIC X(33)   VALUE
  1438             '6. EXPENSES                 -0000'.
  1439     12  FILLER              PIC X(33)   VALUE
  1440             ' A. LOSSES                  00000'.
  1441     12  FILLER              PIC X(33)   VALUE
  1442             '  1. PAID                    0606'.
  1443     12  FILLER              PIC X(33)   VALUE
  1444             '  2. LESS BEG. LOSS RESERVE  0707'.
  1445     12  FILLER              PIC X(33)   VALUE
  1446             '  3. PLUS END. LOSS RESERVE  0808'.
  1447     12  FILLER              PIC X(33)   VALUE
  1448             '  4. TOTAL                   0909'.
  1449     12  FILLER              PIC X(33)   VALUE
  1450             ' B. COMMISSIONS             00000'.
  1451     12  FILLER              PIC X(33)   VALUE
  1452             '  1. RETAINED                2323'.
  1453     12  FILLER              PIC X(33)   VALUE
  1454             '  2. OTHER COMMISSION PAID   1111'.
  1455     12  FILLER              PIC X(33)   VALUE
  1456             '  3. OVERWRITE               2222'.
  1457     12  FILLER              PIC X(33)   VALUE
  1458**           '  3. TOTAL                   12  '.
  1459             '  3. TOTAL                       '.
  1460     12  FILLER              PIC X(33)   VALUE
  1461**           '  4. TOTAL                     24'.
  1462             '  4. TOTAL                   2424'.
  1463     12  WS-EX-LINE          PIC X(33)   VALUE
  1464             ' C. OTHER EXPENSE           01414'.
  1465     12  FILLER              PIC X(33)   VALUE
  1466             '7. TOTAL EXPENSE            01727'.
  1467     12  WS-BAL-LINE-1       PIC X(33)   VALUE
  1468             '8. BALANCE AT END OF PERIOD 01826'.
  1469     12  WS-BAL-LINE-2       PIC X(33)   VALUE
  1470             '   (LINE 5 MINUS LINE 7)     0000'.
  1471     12  FILLER              PIC X(33)   VALUE
  1472             '9. ACCOUNT BALANCES         0  18'.
  1473     12  FILLER              PIC X(33)   VALUE
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  33
* DCC043.cbl
  1474             '9. EXPERIENCE REFUND PRV PD 013  '.
  1475     12  FILLER              PIC X(33)   VALUE
  1476             '10. EXPERIENCE REFUND PRV PD0  13'.
  1477     12  FILLER              PIC X(33)   VALUE
  1478             '10. NET BALANCE OR LOSS     -16  '.
  1479     12  FILLER              PIC X(33)   VALUE
  1480             '11. NET BALANCE OR LOSS     -  25'.
  1481     12  FILLER              PIC X(33)   VALUE
  1482             '11. CSO ADMIN FEE           02828'.
  1483     12  FILLER              PIC X(33)   VALUE
  1484             '12. CCC ADMIN FEE           02929'.
  1485     12  FILLER              PIC X(33)   VALUE
  1486             '13. TOTAL CLP PREMIUM       03030'.
  1487     12  FILLER              PIC X(33)   VALUE HIGH-VALUES.
  1488 01  DESC-TABLE-R    REDEFINES DESC-TABLE.
  1489     12  DT-TB-ENT   OCCURS 30.
  1490         16  DT-ENTRY    PIC X(28).
  1491         16  DT-CTL-CHAR PIC X.
  1492         16  DT-SUBSCR   OCCURS 2.
  1493             20  DT-SS-R.
  1494                 24  DT-SS   PIC 99.
  1495
  1496 01  DESC-TABLE-DESCRIPTIONS.
  1497     12  TAX-EXPENSE-LINE     PIC X(33)   VALUE
  1498             ' C. TAXES AND OTHER EXPENSES01414'.
  1499     12  EXPENSE-LINE        PIC X(33)   VALUE
  1500             ' C. OTHER EXPENSE           01414'.
  1501     12  BALANCE-LINE-1      PIC X(33)   VALUE
  1502             '8. BALANCE AT END OF PERIOD 01826'.
  1503     12  BALANCE-LINE-2      PIC X(33)   VALUE
  1504             '   (LINE 5 MINUS LINE 7)     0000'.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  34
* DCC043.cbl
  1506
  1507 01  HEAD-1.
  1508     12  H1-NAME         PIC X(30)   VALUE SPACES.
  1509     12  FILLER          PIC X(21)   VALUE SPACES.
  1510     12  FILLER          PIC X(20)   VALUE 'CREDIT INSURANCE EAR'.
  1511     12  FILLER          PIC X(10)   VALUE 'NED REVIEW'.
  1512     12  FILLER          PIC X(38)   VALUE SPACES.
  1513     12  FILLER          PIC X(6)    VALUE 'ECS043'.
  1514     12  H1-REPORT-SUF   PIC X       VALUE SPACES.
  1515
  1516 01  HEAD-2.
  1517     12  H2-ADDR         PIC X(30)   VALUE SPACES.
  1518     12  FILLER          PIC X(21)   VALUE SPACES.
  1519     12  HD-COMP         PIC X(30)   VALUE SPACES.
  1520     12  FILLER          PIC X(38)   VALUE SPACES.
  1521     12  HD-RD           PIC X(8)    VALUE SPACES.
  1522
  1523 01  HEAD-3.
  1524     12  H3-ADDR         PIC X(20)   VALUE SPACES.
  1525     12  FILLER          PIC X       VALUE SPACES.
  1526     12  H3-ZIP.
  1527         16  H3-ZIP-PRIME
  1528                         PIC X(5).
  1529         16  H3-DASH     PIC X.
  1530         16  H3-ZIP-PLUS4
  1531                         PIC X(4).
  1532     12  H3-CANADIAN-POSTAL-CODE REDEFINES H3-ZIP.
  1533         16  H3-CAN-POSTAL-CODE-1
  1534                         PIC X(3).
  1535         16  H3-DASH-CAN PIC X.
  1536         16  H3-CAN-POSTAL-CODE-2
  1537                         PIC X(3).
  1538         16  H3-CAN-FILLER
  1539                         PIC X(3).
  1540     12  FILLER          PIC X(26)   VALUE SPACES.
  1541     12  HD-AD           PIC X(18)   VALUE SPACES.
  1542     12  FILLER          PIC X(44)   VALUE SPACES.
  1543     12  FILLER          PIC X(05)   VALUE
  1544         'PAGE '.
  1545     12  H3-PAGE         PIC ZZZZ9.
  1546
  1547 01  HEAD-4.
  1548     12  FILLER          PIC X(20)   VALUE 'COMP    ST ACCOUNT  '.
  1549     12  H4-FT           PIC X(20)   VALUE '       FROM    TO'.
  1550     12  FILLER          PIC X(5)    VALUE SPACES.
  1551     12  H4-GROUP        PIC X(6)    VALUE SPACES.
  1552
  1553 01  HEAD-5.
  1554     12  H5-CARR         PIC X       VALUE SPACES.
  1555     12  H5-COMP         PIC X(6)    VALUE SPACES.
  1556     12  FILLER          PIC X       VALUE SPACES.
  1557     12  H5-ST           PIC XX      VALUE SPACES.
  1558     12  FILLER          PIC X       VALUE SPACES.
  1559     12  H5-ACCT         PIC X(10)   VALUE SPACES.
  1560     12  FILLER          PIC X       VALUE SPACES.
  1561     12  H5-FMO          PIC XX      VALUE SPACES.
  1562     12  H5-FS1          PIC X       VALUE '-'.
  1563     12  H5-FDA          PIC XX      VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  35
* DCC043.cbl
  1564     12  H5-FS2          PIC X       VALUE '-'.
  1565     12  H5-FYR          PIC XX      VALUE SPACES.
  1566     12  FILLER          PIC X       VALUE SPACES.
  1567     12  H5-TMO          PIC XX      VALUE SPACES.
  1568     12  H5-TS1          PIC X       VALUE '-'.
  1569     12  H5-TDA          PIC XX      VALUE SPACES.
  1570     12  H5-TS2          PIC X       VALUE '-'.
  1571     12  H5-TYR          PIC XX      VALUE SPACES.
  1572     12  FILLER          PIC X(4)    VALUE SPACES.
  1573     12  H5-GROUP        PIC X(10)   VALUE SPACES.
  1574     12  H5-MESSAGE      PIC X(40)   VALUE SPACES.
  1575     12  END-CHARACTER   PIC X       VALUE ' '.
  1576
  1577 01  HEAD-6.
  1578     12  FILLER          PIC X(15)   VALUE '***************'.
  1579     12  H6-YTD-HD.
  1580         14  FILLER      PIC X(8)    VALUE '*  LAST '.
  1581         14  H6-MTHS     PIC Z9.
  1582         14  FILLER      PIC X(10)   VALUE ' MONTHS  *'.
  1583     12  H6-YTD-HD-R  REDEFINES H6-YTD-HD.
  1584         16  H6R-FILLER  PIC X.
  1585         16  H6R-MO      PIC XX.
  1586         16  H6R-DASH1   PIC X.
  1587         16  H6R-DA      PIC XX.
  1588         16  H6R-DASH2   PIC X.
  1589         16  H6R-CCYY    PIC X(4).
  1590         16  H6R-MSG     PIC X(9).
  1591     12  FILLER          PIC X(15)   VALUE '***************'.
  1592     12  FILLER          PIC X(29)   VALUE SPACES.
  1593     12  FILLER          PIC X(16)   VALUE '****************'.
  1594     12  FILLER          PIC X(21)  VALUE '  INCEPTION TO DATE  '.
  1595     12  FILLER          PIC X(16)   VALUE '****************'.
  1596
  1597 01  HEAD-7.
  1598     12  HEAD-7-PLUG-1   PIC X(12)   VALUE SPACES.
  1599     12  FILLER          PIC X(1)    VALUE SPACES.
  1600     12  HEAD-7-PLUG-2   PIC X(12)   VALUE SPACES.
  1601     12  FILLER          PIC X(15)   VALUE '         TOTAL '.
  1602     12  FILLER          PIC X(20)   VALUE '   PERCENT          '.
  1603     12  FILLER          PIC X(20)   VALUE '                    '.
  1604     12  HEAD-7-PLUG-3   PIC X(12)   VALUE SPACES.
  1605     12  FILLER          PIC X       VALUE SPACES.
  1606     12  HEAD-7-PLUG-4   PIC X(12)   VALUE SPACES.
  1607     12  FILLER          PIC X(15)   VALUE '           TOTA'.
  1608     12  FILLER          PIC X(12)   VALUE 'L    PERCENT'.
  1609
  1610 01  HEAD-8-STATE.
  1611     12  FILLER          PIC X(8)    VALUE '  STATE '.
  1612     12  H8-ST           PIC XX      VALUE SPACES.
  1613     12  FILLER          PIC X(7)    VALUE ' TOTALS'.
  1614
  1615 01  HEAD-8-COMP.
  1616     12  FILLER          PIC X(10)   VALUE '  COMPANY '.
  1617     12  H8-COMP         PIC X(6)    VALUE SPACES.
  1618     12  FILLER          PIC X(7)    VALUE ' TOTALS'.
  1619
  1620 01  HEAD-8-CARR.
  1621     12  FILLER          PIC X(10)   VALUE '  CARRIER '.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  36
* DCC043.cbl
  1622     12  H8-CARR         PIC X       VALUE SPACES.
  1623     12  FILLER          PIC X(7)    VALUE ' TOTALS'.
  1624
  1625 01  HEAD-8-GROUP.
  1626     12  H-8-G           PIC X(8)    VALUE '  GROUP '.
  1627     12  H8-GROUP        PIC X(6)    VALUE SPACES.
  1628     12  FILLER          PIC X(7)    VALUE ' TOTALS'.
  1629
  1630 01  HEAD-8-GA.
  1631     12  FILLER          PIC X(8)    VALUE '   G.A. '.
  1632     12  H8-GA           PIC X(10)   VALUE SPACES.
  1633     12  FILLER          PIC X(7)    VALUE ' TOTALS'.
  1634
  1635 01  HEAD-8-FINAL.
  1636     12  FILLER          PIC X(20)   VALUE '  FINAL       TOTALS'.
  1637
  1638*01  HEAD-9.
  1639*    12  FILLER          PIC X(127)  VALUE SPACES.
  1640*    12  H9-PAGE         PIC ZZZZ9.
  1641
  1642 01  DETAIL-LINE.
  1643     12  DL-YLF          PIC ZZ,ZZZ,ZZZ.99-.
  1644     12  DL-YAH          PIC ZZ,ZZZ,ZZZ.99-.
  1645     12  DL-YT           PIC ZZ,ZZZ,ZZZ.99-.
  1646     12  DL-YPT          PIC ZZZZ.99-    BLANK WHEN ZERO.
  1647     12  FILLER          PIC X.
  1648     12  DL-DESC         PIC X(28).
  1649     12  DL-ILF          PIC ZZZ,ZZZ,ZZZ.99-.
  1650     12  DL-IAH          PIC ZZZ,ZZZ,ZZZ.99-.
  1651     12  DL-IT           PIC ZZZ,ZZZ,ZZZ.99-.
  1652     12  DL-IPT          PIC ZZZZ.99-    BLANK WHEN ZERO.
  1653
* 1654                                    COPY ELCDATE.
  1655******************************************************************06/11/98
  1656*                                                                *ELCDATE
  1657*                                                                *ELCDATE
  1658*                            ELCDATE.                            *   LV023
  1659*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL*16
  1660*                            VMOD=2.003                           ELCDATE
  1661*                                                                *ELCDATE
  1662*                                                                *ELCDATE
  1663*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *ELCDATE
  1664*                 LENGTH = 200                                   *   CL*19
  1665******************************************************************ELCDATE
  1666                                                                  ELCDATE
  1667 01  DATE-CONVERSION-DATA.                                        ELCDATE
  1668     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.    CL*19
  1669     12  DC-OPTION-CODE                PIC X.                        CL*15
  1670         88  BIN-TO-GREG                VALUE ' '.                ELCDATE
  1671         88  ELAPSED-BETWEEN-BIN        VALUE '1'.                ELCDATE
  1672         88  EDIT-GREG-TO-BIN           VALUE '2'.                ELCDATE
  1673         88  YMD-GREG-TO-BIN            VALUE '3'.                ELCDATE
  1674         88  MDY-GREG-TO-BIN            VALUE '4'.                ELCDATE
  1675         88  JULIAN-TO-BIN              VALUE '5'.                ELCDATE
  1676         88  BIN-PLUS-ELAPSED           VALUE '6'.                ELCDATE
  1677         88  FIND-CENTURY               VALUE '7'.                   CL*22
  1678         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.                ELCDATE
  1679         88  EDIT-GREG-TO-BIN-3         VALUE '9'.                ELCDATE
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  37
* DCC043.cbl (/apps/prod/cid1p/copy/ELCDATE)
  1680         88  YMD-GREG-TO-BIN-3          VALUE 'A'.                ELCDATE
  1681         88  MDY-GREG-TO-BIN-3          VALUE 'B'.                ELCDATE
  1682         88  JULIAN-TO-BIN-3            VALUE 'C'.                ELCDATE
  1683         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.                ELCDATE
  1684         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.                   CL*14
  1685         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.                   CL*14
  1686         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.                   CL*14
  1687         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.         CL*14
  1688         88  CHECK-LEAP-YEAR            VALUE 'H'.                   CL*14
  1689         88  BIN-3-TO-GREG              VALUE 'I'.                   CL*14
  1690         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.                   CL*14
  1691         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.                   CL*14
  1692         88  CYMD-GREG-TO-BIN           VALUE 'L'.                   CL*14
  1693         88  MDCY-GREG-TO-BIN           VALUE 'M'.                   CL*14
  1694         88  MDY-GREG-TO-JULIAN         VALUE 'N'.                   CL*14
  1695         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.                   CL*14
  1696         88  YMD-GREG-TO-JULIAN         VALUE 'P'.                   CL*14
  1697         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.                   CL*14
  1698         88  THREE-CHARACTER-BIN                                  ELCDATE
  1699                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.       CL*14
  1700         88  GREGORIAN-TO-BIN                                        CL**2
  1701                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.    CL*14
  1702         88  BIN-TO-GREGORIAN                                        CL**2
  1703                  VALUES ' ' '1' 'I' '8' 'G'.                        CL*14
  1704         88  JULIAN-TO-BINARY                                        CL**2
  1705                  VALUES '5' 'C' 'E' 'F'.                            CL*14
  1706     12  DC-ERROR-CODE                 PIC X.                        CL*15
  1707         88  NO-CONVERSION-ERROR        VALUE ' '.                   CL**3
  1708         88  DATE-CONVERSION-ERROR                                ELCDATE
  1709                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.        CL*14
  1710         88  DATE-IS-ZERO               VALUE '1'.                ELCDATE
  1711         88  DATE-IS-NON-NUMERIC        VALUE '2'.                ELCDATE
  1712         88  DATE-IS-INVALID            VALUE '3'.                ELCDATE
  1713         88  DATE1-GREATER-DATE2        VALUE '4'.                ELCDATE
  1714         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.                ELCDATE
  1715         88  DATE-INVALID-OPTION        VALUE '9'.                ELCDATE
  1716         88  INVALID-CENTURY            VALUE 'A'.                ELCDATE
  1717         88  ONLY-CENTURY               VALUE 'B'.                ELCDATE
  1718         88  ONLY-LEAP-YEAR             VALUE 'C'.                ELCDATE
  1719         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.              CL**3
  1720     12  DC-END-OF-MONTH               PIC X.                        CL*15
  1721         88  CALCULATE-END-OF-MONTH     VALUE '1'.                ELCDATE
  1722     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.         CL*15
  1723         88  USE-NORMAL-PROCESS         VALUE ' '.                ELCDATE
  1724         88  ADJUST-DOWN-100-YRS        VALUE '1'.                ELCDATE
  1725         88  ADJUST-UP-100-YRS          VALUE '2'.                ELCDATE
  1726     12  FILLER                        PIC X.                        CL*15
  1727     12  DC-CONVERSION-DATES.                                        CL*15
  1728         16  DC-BIN-DATE-1             PIC XX.                       CL*15
  1729         16  DC-BIN-DATE-2             PIC XX.                       CL*15
  1730         16  DC-GREG-DATE-1-EDIT       PIC X(08).                    CL*15
  1731         16  DC-GREG-DATE-1-EDIT-R REDEFINES                         CL*15
  1732                       DC-GREG-DATE-1-EDIT.                       ELCDATE
  1733             20  DC-EDIT1-MONTH        PIC 99.                       CL*15
  1734             20  SLASH1-1              PIC X.                        CL*15
  1735             20  DC-EDIT1-DAY          PIC 99.                       CL*15
  1736             20  SLASH1-2              PIC X.                        CL*15
  1737             20  DC-EDIT1-YEAR         PIC 99.                       CL*15
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  38
* DCC043.cbl (/apps/prod/cid1p/copy/ELCDATE)
  1738         16  DC-GREG-DATE-2-EDIT       PIC X(08).                    CL*15
  1739         16  DC-GREG-DATE-2-EDIT-R REDEFINES                         CL*15
  1740                     DC-GREG-DATE-2-EDIT.                         ELCDATE
  1741             20  DC-EDIT2-MONTH        PIC 99.                       CL*15
  1742             20  SLASH2-1              PIC X.                        CL*15
  1743             20  DC-EDIT2-DAY          PIC 99.                       CL*15
  1744             20  SLASH2-2              PIC X.                        CL*15
  1745             20  DC-EDIT2-YEAR         PIC 99.                       CL*15
  1746         16  DC-GREG-DATE-1-YMD        PIC 9(06).                    CL*15
  1747         16  DC-GREG-DATE-1-YMD-R  REDEFINES                         CL*15
  1748                     DC-GREG-DATE-1-YMD.                          ELCDATE
  1749             20  DC-YMD-YEAR           PIC 99.                       CL*15
  1750             20  DC-YMD-MONTH          PIC 99.                       CL*15
  1751             20  DC-YMD-DAY            PIC 99.                       CL*15
  1752         16  DC-GREG-DATE-1-MDY        PIC 9(06).                    CL*15
  1753         16  DC-GREG-DATE-1-MDY-R REDEFINES                          CL*15
  1754                      DC-GREG-DATE-1-MDY.                         ELCDATE
  1755             20  DC-MDY-MONTH          PIC 99.                       CL*15
  1756             20  DC-MDY-DAY            PIC 99.                       CL*15
  1757             20  DC-MDY-YEAR           PIC 99.                       CL*15
  1758         16  DC-GREG-DATE-1-ALPHA.                                   CL*15
  1759             20  DC-ALPHA-MONTH        PIC X(10).                    CL*15
  1760             20  DC-ALPHA-DAY          PIC 99.                       CL*15
  1761             20  FILLER                PIC XX.                       CL*15
  1762             20  DC-ALPHA-CENTURY.                                   CL*15
  1763                 24 DC-ALPHA-CEN-N     PIC 99.                       CL*15
  1764             20  DC-ALPHA-YEAR         PIC 99.                       CL*15
  1765         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.           CL*15
  1766         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.           CL*15
  1767         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.           CL*15
  1768         16  DC-JULIAN-DATE            PIC 9(05).                    CL*15
  1769         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE                CL*20
  1770                                       PIC 9(05).                    CL*20
  1771         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.                  CL*15
  1772             20  DC-JULIAN-YEAR        PIC 99.                       CL*15
  1773             20  DC-JULIAN-DAYS        PIC 999.                      CL*15
  1774         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.       CL*15
  1775         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.    CL*15
  1776         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.    CL*15
  1777     12  DATE-CONVERSION-VARIBLES.                                   CL*15
  1778         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.            CL*15
  1779         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.          CL*15
  1780             20  FILLER                PIC 9(3).                     CL*15
  1781             20  HOLD-CEN-1-CCYY.                                    CL*15
  1782                 24  HOLD-CEN-1-CC     PIC 99.                       CL*17
  1783                 24  HOLD-CEN-1-YY     PIC 99.                       CL*17
  1784             20  HOLD-CEN-1-MO         PIC 99.                       CL*17
  1785             20  HOLD-CEN-1-DA         PIC 99.                       CL*17
  1786         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.            CL*15
  1787             20  HOLD-CEN-1-R-MO       PIC 99.                       CL*17
  1788             20  HOLD-CEN-1-R-DA       PIC 99.                       CL*17
  1789             20  HOLD-CEN-1-R-CCYY.                                  CL*15
  1790                 24  HOLD-CEN-1-R-CC   PIC 99.                       CL*17
  1791                 24  HOLD-CEN-1-R-YY   PIC 99.                       CL*17
  1792             20  FILLER                PIC 9(3).                     CL*15
  1793         16  HOLD-CENTURY-1-X.                                       CL*15
  1794             20  FILLER                PIC X(3)  VALUE SPACES.       CL*15
  1795             20  HOLD-CEN-1-X-CCYY.                                  CL*15
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  39
* DCC043.cbl (/apps/prod/cid1p/copy/ELCDATE)
  1796                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.          CL*17
  1797                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.          CL*17
  1798             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.          CL*17
  1799             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.          CL*17
  1800         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.          CL*15
  1801             20  HOLD-CEN-1-R-X-MO     PIC XX.                       CL*17
  1802             20  HOLD-CEN-1-R-X-DA     PIC XX.                       CL*17
  1803             20  HOLD-CEN-1-R-X-CCYY.                                CL*15
  1804                 24  HOLD-CEN-1-R-X-CC PIC XX.                       CL*17
  1805                 24  HOLD-CEN-1-R-X-YY PIC XX.                       CL*17
  1806             20  FILLER                PIC XXX.                      CL*23
  1807         16  DC-BIN-DATE-EXPAND-1      PIC XXX.                      CL*15
  1808         16  DC-BIN-DATE-EXPAND-2      PIC XXX.                      CL*15
  1809         16  DC-JULIAN-DATE-1          PIC 9(07).                    CL*15
  1810         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.          CL*15
  1811             20  DC-JULIAN-1-CCYY.                                   CL*15
  1812                 24  DC-JULIAN-1-CC    PIC 99.                       CL*15
  1813                 24  DC-JULIAN-1-YR    PIC 99.                       CL*15
  1814             20  DC-JULIAN-DA-1        PIC 999.                      CL*15
  1815         16  DC-JULIAN-DATE-2          PIC 9(07).                    CL*15
  1816         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.          CL*15
  1817             20  DC-JULIAN-2-CCYY.                                   CL*15
  1818                 24  DC-JULIAN-2-CC    PIC 99.                       CL*15
  1819                 24  DC-JULIAN-2-YR    PIC 99.                       CL*15
  1820             20  DC-JULIAN-DA-2        PIC 999.                      CL*15
  1821         16  DC-GREG-DATE-A-EDIT.                                    CL*15
  1822             20  DC-EDITA-MONTH        PIC 99.                       CL*15
  1823             20  SLASHA-1              PIC X VALUE '/'.              CL*15
  1824             20  DC-EDITA-DAY          PIC 99.                       CL*15
  1825             20  SLASHA-2              PIC X VALUE '/'.              CL*15
  1826             20  DC-EDITA-CCYY.                                      CL*15
  1827                 24  DC-EDITA-CENT     PIC 99.                       CL*15
  1828                 24  DC-EDITA-YEAR     PIC 99.                       CL*15
  1829         16  DC-GREG-DATE-B-EDIT.                                    CL*15
  1830             20  DC-EDITB-MONTH        PIC 99.                       CL*15
  1831             20  SLASHB-1              PIC X VALUE '/'.              CL*15
  1832             20  DC-EDITB-DAY          PIC 99.                       CL*15
  1833             20  SLASHB-2              PIC X VALUE '/'.              CL*15
  1834             20  DC-EDITB-CCYY.                                      CL*15
  1835                 24  DC-EDITB-CENT     PIC 99.                       CL*15
  1836                 24  DC-EDITB-YEAR     PIC 99.                       CL*15
  1837         16  DC-GREG-DATE-CYMD         PIC 9(08).                    CL*15
  1838         16  DC-GREG-DATE-CYMD-R REDEFINES                           CL*15
  1839                              DC-GREG-DATE-CYMD.                  ELCDATE
  1840             20  DC-CYMD-CEN           PIC 99.                       CL*15
  1841             20  DC-CYMD-YEAR          PIC 99.                       CL*15
  1842             20  DC-CYMD-MONTH         PIC 99.                       CL*15
  1843             20  DC-CYMD-DAY           PIC 99.                       CL*15
  1844         16  DC-GREG-DATE-MDCY         PIC 9(08).                    CL*15
  1845         16  DC-GREG-DATE-MDCY-R REDEFINES                           CL*15
  1846                              DC-GREG-DATE-MDCY.                  ELCDATE
  1847             20  DC-MDCY-MONTH         PIC 99.                       CL*15
  1848             20  DC-MDCY-DAY           PIC 99.                       CL*15
  1849             20  DC-MDCY-CEN           PIC 99.                       CL*15
  1850             20  DC-MDCY-YEAR          PIC 99.                       CL*15
  1851    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.      ELCDATE
  1852        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.        ELCDATE
  1853    12  DC-EL310-DATE                  PIC X(21).                    CL*26
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  40
* DCC043.cbl
  1854    12  FILLER                         PIC X(28).                    CL*26
  1855
* 1856                                    COPY ELCDTECX.
  1857******************************************************************06/05/98
  1858*                                                                *ELCDTECX
  1859*                            ELCDTECX.                           *   LV005
  1860*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  1861*                            VMOD=2.015                          *ELCDTECX
  1862*                                                                *ELCDTECX
  1863*      WORKING STORAGE COPY CODE FOR APPLICATIONS CALLING        *ELCDTECX
  1864*      THE DATE CARD DISK FILE. ( READ ROUTINE = ELCDTERX,       *ELCDTECX
  1865*      AND DISK FILE FD = ELCDTEFX)                              *ELCDTECX
  1866*                                                                *ELCDTECX
  1867******************************************************************ELCDTECX
  1868******************************************************************
  1869*                   C H A N G E   L O G
  1870*
  1871* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1872*-----------------------------------------------------------------
  1873*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1874* EFFECTIVE    NUMBER
  1875*-----------------------------------------------------------------
  1876* 092602    2002091900008  PEMA  INCREASE NUMBER OF MAXIMUM
  1877*                                  BENEFIT CODES FROM 300 TO 900
  1878* 090803    2003080800002  PEMA  ADD CATEGORY FOR SUPER GAP
  1879* 051304    2003080800002  SMVA  ADD REFUND METHOD
  1880* 071714    2013100100002  PEMA  FIX CRIT PERIOD EDITS
  1881******************************************************************
  1882 01  DATE-CARD.                                                   ELCDTECX
  1883     12  DATX-COD                    PIC  X(4).                   ELCDTECX
  1884     12  RUN-DATE                    PIC  9(11)  COMP-3.          ELCDTECX
  1885     12  ALPH-DATE                   PIC  X(18).                  ELCDTECX
  1886     12  EP-DT                       PIC  9(11)  COMP-3.          ELCDTECX
  1887     12  PEND-ACT-FILE               PIC  XX.                     ELCDTECX
  1888     12  EP-SW                       PIC  X.                      ELCDTECX
  1889         88  NO-EP-EXTRACTS          VALUE SPACE.                 ELCDTECX
  1890     12  TAPE-BATCHES                PIC  X.                      ELCDTECX
  1891         88  TP-PREL-BAL             VALUE '1'.                   ELCDTECX
  1892     12  BIN-RUN-DATE                PIC  XX.                     ELCDTECX
  1893     12  RUN-CENTURY.                                             ELCDTECX
  1894         16 RUN-CENTURY-N            PIC  99.                        CL**4
  1895     12  FILLER                      PIC  X.                         CL**4
  1896     12  CLAS-MORT-OVRD              PIC  X(4).                   ELCDTECX
  1897     12  FILLER                      PIC  XXX.                    ELCDTECX
  1898     12  COMPANY-NAME                PIC  X(30).                  ELCDTECX
  1899                                                                  ELCDTECX
  1900 01  FILLER                          PIC  X(7)                       CL**6
  1901                                          VALUE 'OPTIONS'.        ELCDTECX
  1902 01  DATE-CARD-OPTIONS.                                           ELCDTECX
  1903     12  DATE-OPTIONS-ID             PIC  X(4).                   ELCDTECX
  1904     12  DTE-MIN-PREM                PIC  99V99.                  ELCDTECX
  1905     12  DTE-LANGUAGE-IND            PIC  X.                      ELCDTECX
  1906         88  DTE-LANGUAGE-IS-FR           VALUE 'F'.              ELCDTECX
  1907         88  DTE-LANGUAGE-IS-ENG          VALUE 'E'.              ELCDTECX
  1908     12  DTE-MIN-AGE                 PIC  99.                     ELCDTECX
  1909     12  DTE-DEFAULT-AGE             PIC  99.                     ELCDTECX
  1910     12  FILLER                      PIC  X.                      ELCDTECX
  1911     12  DTE-MAX-TERM                PIC  999.                    ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  41
* DCC043.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  1912     12  DTE-COMP-VG                 PIC  X.                      ELCDTECX
  1913     12  DTE-REM-TRM                 PIC  X.                      ELCDTECX
  1914     12  DTE-PRM-CK                  PIC S99V99.                  ELCDTECX
  1915     12  DTE-PRORATA                 PIC  X.                      ELCDTECX
  1916     12  DTE-CLM-REJ                 PIC  X.                      ELCDTECX
  1917     12  DTE-REF-REJ                 PIC  X.                      ELCDTECX
  1918     12  DTE-COM-TBL-USED            PIC  X.                      ELCDTECX
  1919     12  FILLER                      PIC  X.                      ELCDTECX
  1920     12  DTE-QTR-CO                  PIC  X.                      ELCDTECX
  1921     12  DTE-REF-CK                  PIC S99V99.                  ELCDTECX
  1922     12  DTE-CLM-CK                  PIC S99V99.                  ELCDTECX
  1923     12  DTE-CONV-DT                 PIC 9(11) COMP-3.               CL**2
  1924     12  DTE-DEFAULT-SEX             PIC  X.                      ELCDTECX
  1925     12  DTE-EPL-FORMAT              PIC  X.                      ELCDTECX
  1926     12  FILLER                      PIC  X.                      ELCDTECX
  1927     12  DTE-JT-AGE                  PIC  X.                      ELCDTECX
  1928     12  DTE-KEY-BIRTH               PIC  X.                      ELCDTECX
  1929     12  DTE-REINSURANCE             PIC  X.                      ELCDTECX
  1930     12  DTE-CLAIM-SORT              PIC  X.                      ELCDTECX
  1931     12  DTE-WRT-OFF                 PIC  S99V99.                 ELCDTECX
  1932     12  DTE-R78                     PIC  X.                      ELCDTECX
  1933     12  DTE-DLY-BILL                PIC  X.                      ELCDTECX
  1934     12  DTE-ALT-MORT-CODE           PIC  X(4).                   ELCDTECX
  1935     12  DTE-CLAIM-PAID-THRU-TO      PIC  X.                      ELCDTECX
  1936     12  DTE-COMPENSATION-ACCESS     PIC  X.                      ELCDTECX
  1937     12  DTE-MORTG-ACCESS-CNTL       PIC  X.                      ELCDTECX
  1938     12  DTE-MP-ALT-MORT-CODE        PIC  X(4).                   ELCDTECX
  1939     12  DTE-MORTALITY-AGE-CALC-METHOD                            ELCDTECX
  1940                                     PIC  X.                      ELCDTECX
  1941         88  DTE-USE-TABLE-ASSIGNED-METHOD VALUE '1'              ELCDTECX
  1942                                                 ' '.             ELCDTECX
  1943         88  DTE-USE-ALL-AGE-LAST          VALUE '2'.             ELCDTECX
  1944         88  DTE-USE-ALL-AGE-NEAR          VALUE '3'.             ELCDTECX
  1945     12  DTE-RESERVE-OPTION-SWITCH   PIC  X.                      ELCDTECX
  1946         88  DTE-OPT-RESERVE-METHOD-AUTH       VALUE 'Y'.         ELCDTECX
  1947         88  DTE-OPT-RESERVE-METHOD-UNAUTH     VALUE 'N' ' '.     ELCDTECX
  1948     12  DTE-REM-TRM-CALC-OPTION     PIC  X.                      ELCDTECX
  1949     12  DTE-EXPERIENCE-RETENTION-AGE                             ELCDTECX
  1950                                     PIC  9.                         CL**4
  1951     12  DTE-SYSTEM.                                              ELCDTECX
  1952         16  DTE-SYS-A-CREDIT        PIC  X.                      ELCDTECX
  1953         16  DTE-SYS-B-PEND-CLAIM    PIC  X.                      ELCDTECX
  1954         16  DTE-SYS-C-CONFIRMATIONS PIC  X.                      ELCDTECX
  1955         16  DTE-SYS-D-DEMAND-BILL   PIC  X.                      ELCDTECX
  1956         16  DTE-SYS-E-CLASIC-CLAIMS PIC  X.                      ELCDTECX
  1957         16  DTE-SYS-F-CLASIC-CREDIT PIC  X.                      ELCDTECX
  1958         16  DTE-SYS-G-AR-USED       PIC  X.                      ELCDTECX
  1959         16  DTE-SYS-H               PIC  X.                      ELCDTECX
  1960         16  DTE-SYS-I               PIC  X.                      ELCDTECX
  1961         16  DTE-SYS-J               PIC  X.                      ELCDTECX
  1962         16  DTE-SYS-K               PIC  X.                      ELCDTECX
  1963         16  DTE-SYS-L               PIC  X.                      ELCDTECX
  1964         16  DTE-SYS-M               PIC  X.                      ELCDTECX
  1965         16  DTE-SYS-N               PIC  X.                      ELCDTECX
  1966         16  DTE-SYS-O               PIC  X.                      ELCDTECX
  1967         16  DTE-SYS-P               PIC  X.                      ELCDTECX
  1968         16  DTE-SYS-Q               PIC  X.                      ELCDTECX
  1969         16  DTE-SYS-R               PIC  X.                      ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  42
* DCC043.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  1970         16  DTE-SYS-S               PIC  X.                      ELCDTECX
  1971         16  DTE-SYS-T               PIC  X.                      ELCDTECX
  1972         16  DTE-SYS-U               PIC  X.                      ELCDTECX
  1973         16  DTE-SYS-V               PIC  X.                      ELCDTECX
  1974         16  DTE-SYS-W               PIC  X.                      ELCDTECX
  1975         16  DTE-SYS-X               PIC  X.                      ELCDTECX
  1976         16  DTE-SYS-Y               PIC  X.                      ELCDTECX
  1977         16  DTE-SYS-Z               PIC  X.                      ELCDTECX
  1978     12  FILLER                      REDEFINES DTE-SYSTEM.        ELCDTECX
  1979         16  DTE-SYS-CODE            OCCURS 26 TIMES              ELCDTECX
  1980                                     PIC  X.                      ELCDTECX
  1981     12  DTE-CLIENT                  PIC  XXX.                    ELCDTECX
  1982                                                                  ELCDTECX
  1983 01  CLASIC-SYSTEM-CODES.                                         ELCDTECX
  1984     12  DTE-COLC-ID                 PIC  X(4).                   ELCDTECX
  1985     12  DTE-CLASIC-COMPANY-CD       PIC  X.                      ELCDTECX
  1986     12  DTE-CLASIC-COMPANY-NUMBER   PIC  999.                    ELCDTECX
  1987*    12  DTE-CLASIC-CLAIM-ACCESS     PIC  X.                      ELCDTECX
  1988     12  FILLER                      PIC  X.                      ELCDTECX
  1989     12  CLASIC-REIN-MAINT           PIC  XX.                     ELCDTECX
  1990     12  CLASIC-COMP-MAINT           PIC  XX.                     ELCDTECX
  1991     12  CLASIC-ACCT-MAINT           PIC  XX.                     ELCDTECX
  1992     12  CLASIC-CTBL-MAINT           PIC  XX.                     ELCDTECX
  1993     12  CLASIC-RATE-MAINT           PIC  XX.                     ELCDTECX
  1994     12  CLASIC-CREDIT-EOM-DT        PIC  XX.                     ELCDTECX
  1995     12  CLASIC-CLAIMS-EOM-DT        PIC  XX.                     ELCDTECX
  1996                                                                  ELCDTECX
  1997     12  LIFE-OVERRIDE-L1            PIC  X.                      ELCDTECX
  1998     12  LIFE-OVERRIDE-L2            PIC  XX.                     ELCDTECX
  1999     12  LIFE-OVERRIDE-L6            PIC  X(6).                   ELCDTECX
  2000     12  LIFE-OVERRIDE-L12           PIC  X(12).                  ELCDTECX
  2001                                                                  ELCDTECX
  2002     12  AH-OVERRIDE-L1              PIC  X.                      ELCDTECX
  2003     12  AH-OVERRIDE-L2              PIC  XX.                     ELCDTECX
  2004     12  AH-OVERRIDE-L6              PIC  X(6).                   ELCDTECX
  2005     12  AH-OVERRIDE-L12             PIC  X(12).                  ELCDTECX
  2006                                                                  ELCDTECX
  2007     12  CLAS-REPORT-CD1-CAPTION     PIC  X(10).                  ELCDTECX
  2008     12  CLAS-REPORT-CD2-CAPTION     PIC  X(10).                  ELCDTECX
  2009                                                                  ELCDTECX
  2010     12  CLASIC-MORTG-EOM-DT         PIC  XX.                     ELCDTECX
  2011     12  CLASIC-AR-EOM-DT            PIC  XX.                     ELCDTECX
  2012                                                                  ELCDTECX
  2013     12  FILLER                      PIC  X(11)      VALUE SPACE. ELCDTECX
  2014                                                                  ELCDTECX
  2015 01  DATE-CARD-FACTORS.                                           ELCDTECX
  2016     12  DATE-FACTOR-ID              PIC  X(4).                   ELCDTECX
  2017     12  FAC-1                       PIC S999V9(5).               ELCDTECX
  2018     12  FAC-2                       PIC S999V9(5).               ELCDTECX
  2019     12  FAC-3                       PIC S999V9(5).               ELCDTECX
  2020     12  FAC-4                       PIC S999V9(5).               ELCDTECX
  2021     12  FAC-5                       PIC S999V9(5).               ELCDTECX
  2022     12  FAC-6                       PIC S999V9(5).               ELCDTECX
  2023                                                                  ELCDTECX
  2024 01  FILLER                          PIC  X(12)                   ELCDTECX
  2025                                          VALUE 'COMPANY NAME'.   ELCDTECX
  2026 01  COMPANY-NAME-TABLE.                                          ELCDTECX
  2027     12  C-N-TBL                     OCCURS 6 TIMES.              ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  43
* DCC043.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  2028         16  CNT-ID                  PIC  X.                      ELCDTECX
  2029         16  CNT-NAME                PIC  X(30).                  ELCDTECX
  2030                                                                  ELCDTECX
  2031 01  FILLER                          PIC  X(11)                   ELCDTECX
  2032                                          VALUE 'STATE NAMES'.    ELCDTECX
  2033 01  STATE-NAMES.                                                 ELCDTECX
  2034     12  STATE-NAME-FLD              OCCURS 75 TIMES.             ELCDTECX
  2035         16  STATE-SUB               PIC  XX.                     ELCDTECX
  2036         16  STATE-PIC1.                                          ELCDTECX
  2037             20  STATE-ABBR          PIC  XX.                     ELCDTECX
  2038             20  FILLER              PIC  XXX.                    ELCDTECX
  2039             20  STATE-PIC           PIC  X(20).                  ELCDTECX
  2040             20  STATE-CALL-EARN     PIC  X.                      ELCDTECX
  2041             20  STATE-CALL-BREAK    PIC  X.                      ELCDTECX
  2042             20  STATE-PRIM-FAC-DEV  PIC  XXX.                    ELCDTECX
  2043                                                                  ELCDTECX
  2044 01  FILLER                          PIC  X(13)                   ELCDTECX
  2045                                          VALUE 'CARRIER NAMES'.  ELCDTECX
  2046 01  CARRIER-NAMES.                                               ELCDTECX
  2047     12  CARRIER-NAME-FLD            OCCURS 25 TIMES.             ELCDTECX
  2048         16  CARRIER-SUB             PIC  X.                      ELCDTECX
  2049         16  CARRIER-DOM-ST          PIC  XX.                     ELCDTECX
  2050         16  CARRIER-PIC             PIC  X(30).                  ELCDTECX
  2051         16  CARRIER-UEP-PCT         PIC  S9V9(4) COMP-3.            CL**6
  2052         16  CARRIER-R78-PCT         PIC  S9V9(4) COMP-3.            CL**6
  2053         16  CARRIER-PRO-PCT         PIC  S9V9(4) COMP-3.            CL**6
  2054*        16  FILLER                  PIC  X.                      ELCDTECX
  2055         16  CARRIER-SEC-PAY         PIC  X.
  2056             88  SEC-PAY-CARRIER          VALUE 'Y'.
  2057                                                                  ELCDTECX
  2058 01  FILLER                          PIC  X(9)                       CL**6
  2059                                          VALUE 'INS TYPES'.      ELCDTECX
  2060 01  CLAS-INS-TYPES.                                              ELCDTECX
  2061*    12 CLAS-ALL-TYPES               OCCURS 300 TIMES.            ELCDTECX
  2062     12 CLAS-ALL-TYPES               OCCURS 900 TIMES.            ELCDTECX
  2063         16  CLAS-I-BEN              PIC  XX.                     ELCDTECX
  2064         16  CLAS-I-AB3.                                          ELCDTECX
  2065             20  FILLER              PIC  X.                      ELCDTECX
  2066             20  CLAS-I-AB2.                                      ELCDTECX
  2067                 24  FILLER          PIC  X.                      ELCDTECX
  2068                 24  CLAS-I-AB1      PIC  X.                      ELCDTECX
  2069         16  CLAS-I-AB3-AH REDEFINES CLAS-I-AB3.                  ELCDTECX
  2070             20  CLAS-EXCLUSION      PIC  XX.                        CL**4
  2071             20  FILLER              PIC  X.                         CL**4
  2072         16  CLAS-I-AB10.                                         ELCDTECX
  2073             20  FILLER              PIC  X(9).                   ELCDTECX
  2074             20  CLAS-I-REIN-YN      PIC  X.                      ELCDTECX
  2075         16  CLAS-I-COMMENT          PIC  X(10).                  ELCDTECX
  2076         16  CLAS-I-JOINT            PIC  X.                      ELCDTECX
  2077         16  CLAS-I-RL-AH            PIC  X.                      ELCDTECX
  2078         16  CLAS-I-CALC-TYPE.                                    ELCDTECX
  2079             20  CLAS-I-BAL          PIC  X.                      ELCDTECX
  2080         16  CLAS-I-EP               PIC  X.                      ELCDTECX
  2081         16  CLAS-CO-BEN-I-G-CD      PIC  X.                      ELCDTECX
  2082         16  CLAS-CO-REM-TERM-CALC   PIC  X.                      ELCDTECX
  2083         16  CLAS-I-BEN-CATEGORY     PIC  X.
  2084         16  CLAS-I-REFUND-METHOD    PIC  X.
  2085         16  CLAS-I-MAX-BENEFITS     PIC 99.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  44
* DCC043.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  2086         16  FILLER                  PIC  XXX.
  2087                                                                  ELCDTECX
  2088 01  FILLER                          PIC  X(16)                   ELCDTECX
  2089                                     VALUE 'MORTALITY TABLES'.    ELCDTECX
  2090 01  CLAS-MORTALITY-CODES.                                        ELCDTECX
  2091     12  CLAS-MORT-FLD               OCCURS 99 TIMES              ELCDTECX
  2092                                     INDEXED BY CLAS-MORT-NDX.    ELCDTECX
  2093         16  CLAS-MORT-CODE          PIC  X(4).                      CL**6
  2094         16  CLAS-MORT-J-CODE        PIC  X.                         CL**5
  2095         16  CLAS-MORT-J-FACT        PIC S9V9(4).                    CL**6
  2096         16  CLAS-MORT-DESC.                                      ELCDTECX
  2097             20  CLAS-RESERVE-ADJ    PIC  999.                       CL**6
  2098             20  FILLER              PIC  XX.                        CL**5
  2099             20  CLAS-YEAR           PIC  X(4).                      CL**6
  2100             20  FILLER              PIC  X.                         CL**5
  2101             20  CLAS-TABLE-TYPE     PIC  XXX.                       CL**6
  2102             20  FILLER              PIC  X.                         CL**5
  2103             20  CLAS-AGE-METHOD     PIC  XX.                        CL**5
  2104             20  FILLER              PIC  X.                         CL**5
  2105             20  CLAS-INTEREST       PIC  99.99.                     CL**5
  2106             20  FILLER              PIC  X(5).                      CL**6
  2107                                                                  ELCDTECX
  2108 01  FILLER                          PIC  X(15)                   ELCDTECX
  2109                                     VALUE 'BUSINESS TABLES'.     ELCDTECX
  2110 01  CLAS-BUSINESS-CLASSES.                                       ELCDTECX
  2111     12  CLAS-BUSC-FLD               OCCURS 50 TIMES.             ELCDTECX
  2112         16  CLAS-BUSC-CODE          PIC  99.                     ELCDTECX
  2113         16  CLAS-BUSC-GROUP         PIC  X.                      ELCDTECX
  2114         16  CLAS-BUSC-DESC          PIC  X(19).                  ELCDTECX
  2115         16  CLAS-BUSC-EXCL          PIC  X.                         CL**5
  2116         16  FILLER                  PIC  X(4).                      CL**6
  2117                                                                  ELCDTECX
  2118 01  FILLER                          PIC  X(7)                       CL**6
  2119                                     VALUE 'INDEXES'.             ELCDTECX
  2120 01  CLAS-INDEX-TBL.                                              ELCDTECX
  2121     12  CLAX-ID                     PIC  X(4).                   ELCDTECX
  2122     12  CLAS-STARTC                 PIC S9(4) COMP.              ELCDTECX
  2123     12  CLAS-MAXC                   PIC S9(4) COMP.              ELCDTECX
  2124     12  CLAS-STARTL                 PIC S9(4) COMP.              ELCDTECX
  2125     12  CLAS-MAXL                   PIC S9(4) COMP.              ELCDTECX
  2126     12  CLAS-STARTA                 PIC S9(4) COMP.              ELCDTECX
  2127     12  CLAS-MAXA                   PIC S9(4) COMP.              ELCDTECX
  2128     12  CLAS-STARTM                 PIC S9(4) COMP.              ELCDTECX
  2129     12  CLAS-MAXM                   PIC S9(4) COMP.              ELCDTECX
  2130     12  CLAS-STARTB                 PIC S9(4) COMP.              ELCDTECX
  2131     12  CLAS-MAXB                   PIC S9(4) COMP.              ELCDTECX
  2132     12  CLAS-STARTS                 PIC S9(4) COMP.              ELCDTECX
  2133     12  CLAS-MAXS                   PIC S9(4) COMP.              ELCDTECX
  2134     12  CLAS-STARTE                 PIC S9(4) COMP.              ELCDTECX
  2135     12  CLAS-MAXE                   PIC S9(4) COMP.              ELCDTECX
  2136     12  CLAS-STARTCN                PIC S9(4) COMP.              ELCDTECX
  2137     12  CLAS-MAXCN                  PIC S9(4) COMP.              ELCDTECX
  2138                                                                  ELCDTECX
  2139 01  CLAS-TYPE-MISC.                                              ELCDTECX
  2140     12  CLAS-INDEXC                 PIC S9(4) COMP.              ELCDTECX
  2141     12  CLAS-INDEXL                 PIC S9(4) COMP.              ELCDTECX
  2142     12  CLAS-INDEXA                 PIC S9(4) COMP.              ELCDTECX
  2143     12  CLAS-INDEXM                 PIC S9(4) COMP.              ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  45
* DCC043.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  2144     12  CLAS-INDEXB                 PIC S9(4) COMP.              ELCDTECX
  2145     12  CLAS-INDEXS                 PIC S9(4) COMP.              ELCDTECX
  2146     12  CLAS-INDEXE                 PIC S9(4) COMP.              ELCDTECX
  2147     12  CLAS-INDEX                  PIC S9(4) COMP.              ELCDTECX
  2148     12  CLAS-INDEXEN                PIC S9(4) COMP.              ELCDTECX
  2149     12  CLAS-INDEXCN                PIC S9(4) COMP.              ELCDTECX
  2150     12  CLAS-INDEXON                PIC S9(4) COMP.              ELCDTECX
  2151                                                                  ELCDTECX
  2152 01  FILLER                          PIC  X(13)                   ELCDTECX
  2153                                     VALUE 'MISCELLANEOUS'.       ELCDTECX
  2154 01  CLAS-MISC.                                                   ELCDTECX
  2155     12  DTE-FICH                    PIC  X.                      ELCDTECX
  2156         88  FICH-NO                 VALUE SPACE.                 ELCDTECX
  2157         88  FICH-ONLY               VALUE '1'.                   ELCDTECX
  2158         88  FICH-BOTH               VALUE '2'.                   ELCDTECX
  2159     12  FICH-OPEN                   PIC  X.                      ELCDTECX
  2160     12  REPT-OPEN                   PIC  X.                      ELCDTECX
  2161     12  DTE-PGM-OPT                 PIC  9.                         CL**5
  2162     12  DTE-PRT-OPT                 PIC  X.                      ELCDTECX
  2163     12  DTE-FMT-OPT                 PIC  9.                      ELCDTECX
  2164     12  DTE-PRC-OPT                 PIC  9.                      ELCDTECX
  2165     12  DTE-TOT-OPT                 PIC  9.                      ELCDTECX
  2166     12  CLAS-LOOK                   PIC  XX.                     ELCDTECX
  2167     12  DTE-TOT-LINES               PIC S9(8)      COMP.         ELCDTECX
  2168     12  STATE-L                     PIC  XX.                     ELCDTECX
  2169     12  CLAS-CN                     PIC  99.                     ELCDTECX
  2170     12  CLAS-CO                     PIC  99.                     ELCDTECX
  2171     12  DTE-VSAM-FLAGS                              VALUE ZERO.  ELCDTECX
  2172         16  DTE-F-1                 PIC  X.                      ELCDTECX
  2173         16  DTE-F-2                 PIC  X.                      ELCDTECX
  2174     12  DTE-ABEND-WORK.                                          ELCDTECX
  2175         16  DTE-ABEND-CD-1          PIC  XX         VALUE SPACES.ELCDTECX
  2176         16  DTE-ABEND-CD-2          PIC  XX         VALUE SPACES.ELCDTECX
  2177                                                                  ELCDTECX
  2178 01  FILLER                          PIC  X(12)                   ELCDTECX
  2179                                     VALUE 'WORKING DATE'.        ELCDTECX
  2180 01  WS-DATE-AND-TIME.                                            ELCDTECX
  2181     12  WS-ACCEPT-DATE.                                          ELCDTECX
  2182         16  WS-AD-YY                PIC  99.                     ELCDTECX
  2183         16  WS-AD-MM                PIC  99.                     ELCDTECX
  2184         16  WS-AD-DD                PIC  99.                     ELCDTECX
  2185     12  WS-CURRENT-DATE.                                         ELCDTECX
  2186         16  WS-CD-MM                PIC  99.                     ELCDTECX
  2187         16  FILLER                  PIC  X          VALUE '/'.   ELCDTECX
  2188         16  WS-CD-DD                PIC  99.                     ELCDTECX
  2189         16  FILLER                  PIC  X          VALUE '/'.   ELCDTECX
  2190         16  WS-CD-YY                PIC  99.                     ELCDTECX
  2191     12  WS-TIME-OF-DAY.                                          ELCDTECX
  2192         16  WS-TIME                 PIC  9(6).                   ELCDTECX
  2193         16  WS-HUN-SEC              PIC  99.                     ELCDTECX
  2194                                                                  ELCDTECX
  2195 01  FILLER                          PIC  X(12)                   ELCDTECX
  2196                                     VALUE 'CARRIER CLMS'.        ELCDTECX
  2197 01  CARRIER-OPT-CLAIM-DATA.                                      ELCDTECX
  2198     12  CARRIER-FLDS                OCCURS 25 TIMES.             ELCDTECX
  2199         16  CARRIER-IBNR-SWITCH     PIC  X.                         CL**5
  2200         16  CARRIER-IBNR-PERCENT    PIC S9V9(4) COMP-3.             CL**6
  2201         16  CARRIER-CIDA-DISCOUNT   PIC S9V9(4) COMP-3.             CL**6
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  46
* DCC043.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  2202                                                                  ELCDTECX
  2203 01  FILLER                          PIC  X(10)                   ELCDTECX
  2204                                     VALUE 'STATE TLRS'.          ELCDTECX
  2205 01  STATE-TARGET-LOSS-RATIOS.                                    ELCDTECX
  2206     12  STATE-TLR-FLD               OCCURS 75 TIMES.             ELCDTECX
  2207         16  STATE-TARGET-LOSS-RATIO PIC S9V9(4) COMP-3.             CL**6
  2208         16  STATE-CALC-INTEREST     PIC S9V9(4) COMP-3.             CL**6
  2209                                                                  ELCDTECX
  2210 01  FILLER                          PIC  X(13)                   ELCDTECX
  2211                                     VALUE 'BUSINESS TLRS'.       ELCDTECX
  2212 01  BUSINESS-TRGT-LOSS-RATIO-MODS.                               ELCDTECX
  2213     12  BUS-TLRM-FLD                OCCURS 99 TIMES.             ELCDTECX
  2214         16  BUS-TRGT-LOSS-RATIO-MOD PIC S9V9(4) COMP-3.             CL**6
  2215                                                                  ELCDTECX
  2216 01  FILLER                          PIC  X(13)                   ELCDTECX
  2217                                     VALUE 'MISC CLM DATA'.       ELCDTECX
  2218 01  MISC-OPT-CLM-RSV-DATA.                                       ELCDTECX
  2219     12  COMPANY-CALC-INTEREST       PIC S9V9(4) COMP-3.             CL**6
  2220     12  COMPANY-CIDA-DISCOUNT       PIC S9V9(4) COMP-3.             CL**6
  2221     12  COMPANY-CRDB-TABLE-SELECTION                             ELCDTECX
  2222                                     PIC  X.                         CL**5
  2223     12  COMPANY-IBNR-AH-FACTOR      PIC S9V9(4) COMP-3.             CL**6
  2224     12  COMPANY-IBNR-LAG-MONTH      PIC S999    COMP-3.             CL**6
  2225     12  COMPANY-IBNR-LIFE-FACTOR    PIC S9V9(4) COMP-3.             CL**6
  2226     12  COMPANY-OPTION-START-DATE   PIC  XX.                        CL**5
  2227     12  INDEXBS                     PIC S9(4)   COMP.               CL**6
  2228     12  INDEXCA                     PIC S9(4)   COMP.               CL**6
  2229     12  INDEXST                     PIC S9(4)   COMP.               CL**6
  2230     12  FILLER                      PIC  X(75).                  ELCDTECX
  2231******************************************************************ELCDTECX
  2232*01  MISC-CARR-PCT-DATA.                                          00001521
  2233*    12  DD-CARR1-UEP-PCT            PIC S9V9(4) COMP-3.          00001522
  2234*    12  DD-CARR1-R78-PCT            PIC S9V9(4) COMP-3.          00001522
  2235*    12  DD-CARR1-PRO-PCT            PIC S9V9(4) COMP-3.          00001522
  2236*    12  DD-CARR2-UEP-PCT            PIC S9V9(4) COMP-3.          00001522
  2237*    12  DD-CARR2-R78-PCT            PIC S9V9(4) COMP-3.          00001522
  2238*    12  DD-CARR2-PRO-PCT            PIC S9V9(4) COMP-3.          00001522
  2239******************************************************************ELCDTECX
  2240
* 2241                                    COPY ELCDTEVR.
  2242***************************************************************** 04/15/98
  2243*                                                                *ELCDTEVR
  2244*                                                                *ELCDTEVR
  2245*                            ELCDTEVR.                           *   LV003
  2246*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
  2247*                            VMOD=2.001                          *   CL**2
  2248*                                                                *ELCDTEVR
  2249*   WORKING STORAGE FOR DATE VARIABLES CREATED                   *ELCDTEVR
  2250*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCDTEVR
  2251*                                                                *ELCDTEVR
  2252******************************************************************ELCDTEVR
  2253 01  WS-DATE-CARD-DATE.                                           ELCDTEVR
  2254     05  WS-RUN-DATE.                                             ELCDTEVR
  2255         10  FILLER                  PIC  9(03).                  ELCDTEVR
  2256         10  RUN-CCYY                PIC  9(04).                  ELCDTEVR
  2257         10  RUN-CCYR  REDEFINES  RUN-CCYY.                       ELCDTEVR
  2258             15  RUN-CC              PIC  99.                     ELCDTEVR
  2259             15  RUN-YR              PIC  99.                     ELCDTEVR
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  47
* DCC043.cbl (/apps/prod/cid1p/copy/ELCDTEVR)
  2260         10  RUN-MO                  PIC  99.                     ELCDTEVR
  2261         10  RUN-DA                  PIC  99.                     ELCDTEVR
  2262     05  WS-RUN-DATE-N REDEFINES                                     CL**2
  2263            WS-RUN-DATE              PIC 9(11).                      CL**2
  2264     05  WS-EP-DT.                                                ELCDTEVR
  2265         10  FILLER                  PIC  9(03).                  ELCDTEVR
  2266         10  EP-CCYY                 PIC  9(04).                  ELCDTEVR
  2267         10  EP-CCYR  REDEFINES  EP-CCYY.                         ELCDTEVR
  2268             15  EP-CC               PIC  99.                     ELCDTEVR
  2269             15  EP-YR               PIC  99.                     ELCDTEVR
  2270         10  EP-MO                   PIC  99.                     ELCDTEVR
  2271         10  EP-DA                   PIC  99.                     ELCDTEVR
  2272     05  WS-EP-DT-N REDEFINES                                        CL**2
  2273            WS-EP-DT                 PIC 9(11).                      CL**2
  2274     05  WS-DTE-CONV-DT.                                             CL**4
  2275         10  FILLER                  PIC  9(03).                     CL**4
  2276         10  DTE-CONV-CCYY           PIC  9(04).                     CL**4
  2277         10  DTE-CONV-CCYR  REDEFINES  DTE-CONV-CCYY.                CL**4
  2278             15  DTE-CONV-CC         PIC  99.                        CL**4
  2279             15  DTE-CONV-YR         PIC  99.                        CL**4
  2280         10  DTE-CONV-MO             PIC  99.                        CL**4
  2281         10  DTE-CONV-DA             PIC  99.                        CL**4
  2282     05  WS-DTE-CONV-DT-N REDEFINES                                  CL**4
  2283            WS-DTE-CONV-DT           PIC  9(11).                     CL**4
  2284 01  WS-BALANCE-FORWARD-DATE.                                     ELCDTEVR
  2285     05  WS-BF-LAST-ACTIVITY-DATE.                                ELCDTEVR
  2286         10  FILLER                            PIC 999.           ELCDTEVR
  2287         10  BF-ACT-CCYY                       PIC 9(04).         ELCDTEVR
  2288         10  BF-ACT-CCYR  REDEFINES  BF-ACT-CCYY.                 ELCDTEVR
  2289             15  BF-ACT-CC                     PIC 99.            ELCDTEVR
  2290             15  BF-ACT-YEAR                   PIC 99.            ELCDTEVR
  2291         10  BF-ACT-MONTH                      PIC 99.            ELCDTEVR
  2292         10  BF-ACT-DAY                        PIC 99.            ELCDTEVR
  2293     05  WS-BF-LAST-ACTIVITY-DATE-N REDEFINES                        CL**2
  2294            WS-BF-LAST-ACTIVITY-DATE           PIC 9(11).            CL**2
  2295     05  WS-BF-CURRENT-LAST-STMT-DT.                              ELCDTEVR
  2296         10  FILLER                            PIC 999.           ELCDTEVR
  2297         10  BF-CURRENT-LAST-STMT-CEN          PIC 99.            ELCDTEVR
  2298         10  BF-CURRENT-LAST-STMT-YEAR         PIC 99.            ELCDTEVR
  2299         10  BF-CURRENT-LAST-STMT-MONTH        PIC 99.            ELCDTEVR
  2300         10  BF-CURRENT-LAST-STMT-DAY          PIC 99.            ELCDTEVR
  2301     05  WS-BF-CURRENT-LAST-STMT-DT-N REDEFINES                      CL**2
  2302            WS-BF-CURRENT-LAST-STMT-DT        PIC 9(11).             CL**2
  2303 01  WS-ADD-CONF-TRANSACTIONS-DTE.                                ELCDTEVR
  2304     05  WS-AC-CERT-EFF-DATE.                                     ELCDTEVR
  2305         10  FILLER                            PIC 999.           ELCDTEVR
  2306         10  AC-CERT-CCYY                      PIC 9(04).         ELCDTEVR
  2307         10  AC-CERT-CCYR  REDEFINES  AC-CERT-CCYY.               ELCDTEVR
  2308             15  AC-CERT-CC                    PIC 99.            ELCDTEVR
  2309             15  AC-CERT-YR                    PIC 99.            ELCDTEVR
  2310         10  AC-CERT-MO                        PIC 99.            ELCDTEVR
  2311         10  AC-CERT-DA                        PIC 99.            ELCDTEVR
  2312     05  WS-AC-CERT-EFF-DATE-N REDEFINES                             CL**2
  2313            WS-AC-CERT-EFF-DATE                PIC 9(11).            CL**2
  2314     05  WS-AC-LIFE-CANCEL-DATE.                                  ELCDTEVR
  2315         10  FILLER                            PIC 999.           ELCDTEVR
  2316         10  AC-LIFE-CANCEL-CCYY               PIC 9(04).         ELCDTEVR
  2317         10  AC-LIFE-CANCEL-CCYR REDEFINES AC-LIFE-CANCEL-CCYY.   ELCDTEVR
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  48
* DCC043.cbl (/apps/prod/cid1p/copy/ELCDTEVR)
  2318             15  AC-LIFE-CANCEL-CC             PIC 99.            ELCDTEVR
  2319             15  AC-LIFE-CANCEL-YR             PIC 99.            ELCDTEVR
  2320         10  AC-LIFE-CANCEL-MO                 PIC 99.            ELCDTEVR
  2321         10  AC-LIFE-CANCEL-DA                 PIC 99.            ELCDTEVR
  2322     05  WS-AC-LIFE-CANCEL-DATE-N REDEFINES                          CL**2
  2323            WS-AC-LIFE-CANCEL-DATE             PIC 9(11).            CL**2
  2324     05  WS-AC-AH-CANCEL-DATE.                                    ELCDTEVR
  2325         10  FILLER                            PIC 999.           ELCDTEVR
  2326         10  AC-AH-CANCEL-CCYY                 PIC 9(04).         ELCDTEVR
  2327         10  AC-AH-CANCEL-CCYR  REDEFINES  AC-AH-CANCEL-CCYY.     ELCDTEVR
  2328             15  AC-AH-CANCEL-CC               PIC 99.            ELCDTEVR
  2329             15  AC-AH-CANCEL-YR               PIC 99.            ELCDTEVR
  2330         10  AC-AH-CANCEL-MO                   PIC 99.            ELCDTEVR
  2331         10  AC-AH-CANCEL-DA                   PIC 99.            ELCDTEVR
  2332     05  WS-AC-AH-CANCEL-DATE-N REDEFINES                            CL**2
  2333            WS-AC-AH-CANCEL-DATE               PIC 9(11).            CL**2
  2334 01  WS-RATE-RECORD.                                              ELCDTEVR
  2335         05  WS-RT-EXPIRY-DATE.                                   ELCDTEVR
  2336             10  FILLER                        PIC 999.           ELCDTEVR
  2337             10  RT-EXP-CCYY                   PIC 9(04).         ELCDTEVR
  2338             10  RT-EXP-CCYR  REDEFINES  RT-EXP-CCYY.             ELCDTEVR
  2339                 15  RT-EXP-CC                 PIC 99.            ELCDTEVR
  2340                 15  RT-EXP-YR                 PIC 99.            ELCDTEVR
  2341             10  RT-EXP-MO                     PIC 99.            ELCDTEVR
  2342             10  RT-EXP-DA                     PIC 99.            ELCDTEVR
  2343         05  WS-RT-EXPIRY-DATE-N REDEFINES                           CL**2
  2344                WS-RT-EXPIRY-DATE              PIC 9(11).            CL**2
  2345
* 2346                                    COPY ELCACCTV.
  2347******************************************************************04/14/98
  2348*                                                                *ELCACCTV
  2349*                            ELCACCTV                            *   LV002
  2350*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  2351*                            VMOD=2.001                          *ELCACCTV
  2352*                                                                *ELCACCTV
  2353*   WORKING STORAGE FOR DATE VARIABLES CREATED                   *ELCACCTV
  2354*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCACCTV
  2355*                                                                *ELCACCTV
  2356*  NO  CID  MODS  IN  COPYBOOK  ELCACCTV                         *ELCACCTV
  2357*                                                                *ELCACCTV
  2358******************************************************************ELCACCTV
  2359                                                                  ELCACCTV
  2360 01  WS-ACCOUNT-MASTER-DATE.                                      ELCACCTV
  2361                                                                  ELCACCTV
  2362     05  WS-AM-EXPIRE-DT.                                         ELCACCTV
  2363         10  FILLER            PIC 999.                           ELCACCTV
  2364         10  AM-EXP-CCYY       PIC 9(04).                         ELCACCTV
  2365         10  AM-EXP-CCYR  REDEFINES  AM-EXP-CCYY.                 ELCACCTV
  2366             15  AM-EXP-CC     PIC 99.                            ELCACCTV
  2367             15  AM-EXP-YR     PIC 99.                            ELCACCTV
  2368         10  AM-EXP-MO         PIC 99.                               CL**5
  2369         10  AM-EXP-DA         PIC 99.                               CL**5
  2370     05  WS-AM-EXPIRE-DT-N REDEFINES                                 CL**3
  2371            WS-AM-EXPIRE-DT    PIC 9(11).                            CL**4
  2372     05  WS-AM-VG-EXP-DATE.                                       ELCACCTV
  2373         10  FILLER                    PIC 999.                   ELCACCTV
  2374         10  AM-VG-EXP-CCYY            PIC 9(04).                 ELCACCTV
  2375         10  AM-VG-EXP-CCYR  REDEFINES  AM-VG-EXP-CCYY.           ELCACCTV
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  49
* DCC043.cbl (/apps/prod/cid1p/copy/ELCACCTV)
  2376             15  AM-VG-EXP-CC          PIC 99.                    ELCACCTV
  2377             15  AM-VG-EXP-YR          PIC 99.                    ELCACCTV
  2378         10  AM-VG-EXP-MO              PIC 99.                    ELCACCTV
  2379         10  AM-VG-EXP-DA              PIC 99.                    ELCACCTV
  2380     05  WS-AM-VG-EXP-DATE-N REDEFINES                               CL**3
  2381            WS-AM-VG-EXP-DATE          PIC 9(11).                    CL**4
  2382     05  WS-AM-EFFECT-DT.                                         ELCACCTV
  2383         10  FILLER                    PIC 999.                   ELCACCTV
  2384         10  AM-EFF-CCYY               PIC 9(04).                 ELCACCTV
  2385         10  AM-EFF-CCYR  REDEFINES  AM-EFF-CCYY.                 ELCACCTV
  2386             15  AM-EFF-CC             PIC 99.                    ELCACCTV
  2387             15  AM-EFF-YR             PIC 99.                    ELCACCTV
  2388         10  AM-EFF-MO                 PIC 99.                    ELCACCTV
  2389         10  AM-EFF-DA                 PIC 99.                    ELCACCTV
  2390     05  WS-AM-EFFECT-DT-N REDEFINES                                 CL**3
  2391            WS-AM-EFFECT-DT            PIC 9(11).                    CL**4
  2392     05  WS-AM-PREV-EXP-DT.                                       ELCACCTV
  2393         10 FILLER                     PIC 999.                   ELCACCTV
  2394         10 AM-PREV-EXP-DT-CCYY        PIC 9(04).                 ELCACCTV
  2395         10 AM-PREV-EXP-DT-CCYR  REDEFINES  AM-PREV-EXP-DT-CCYY.  ELCACCTV
  2396            15 AM-PREV-EXP-DT-CC       PIC 99.                    ELCACCTV
  2397            15 AM-PREV-EXP-DT-YR       PIC 99.                    ELCACCTV
  2398         10 AM-PREV-EXP-MO             PIC 99.                    ELCACCTV
  2399         10 AM-PREV-EXP-DA             PIC 99.                    ELCACCTV
  2400     05  WS-AM-PREV-EXP-DT-N REDEFINES                               CL**3
  2401            WS-AM-PREV-EXP-DT          PIC 9(11).                    CL**3
  2402     05  WS-AM-PREV-EFF-DT.                                       ELCACCTV
  2403         10 FILLER                     PIC 999.                   ELCACCTV
  2404         10 AM-PREV-EFF-CCYY           PIC 9(04).                 ELCACCTV
  2405         10 AM-PREV-EFF-CCYR  REDEFINES  AM-PREV-EFF-CCYY.        ELCACCTV
  2406            15 AM-PREV-EFF-CC          PIC 99.                    ELCACCTV
  2407            15 AM-PREV-EFF-YR          PIC 99.                    ELCACCTV
  2408         10 AM-PREV-EFF-MO             PIC 99.                    ELCACCTV
  2409         10 AM-PREV-EFF-DA             PIC 99.                    ELCACCTV
  2410     05  WS-AM-PREV-EFF-DT-N REDEFINES                               CL**3
  2411            WS-AM-PREV-EFF-DT          PIC 9(11).                    CL**3
  2412     05  WS-AM-ANNIVERSARY-DATE.                                  ELCACCTV
  2413         10  FILLER                    PIC 999.                   ELCACCTV
  2414         10  AM-AN-CCYY                PIC 9(04).                 ELCACCTV
  2415         10  AM-AN-CCYR  REDEFINES  AM-AN-CCYY.                   ELCACCTV
  2416             15  AM-AN-CC              PIC 99.                    ELCACCTV
  2417             15  AM-AN-YR              PIC 99.                    ELCACCTV
  2418         10  AM-AN-MO                  PIC 99.                    ELCACCTV
  2419         10  AM-AN-DA                  PIC 99.                    ELCACCTV
  2420     05  WS-AM-ANNIVERSARY-DATE-N REDEFINES                          CL**3
  2421            WS-AM-ANNIVERSARY-DATE     PIC 9(11).                    CL**4
  2422     05  WS-AM-HI-CERT-DATE.                                      ELCACCTV
  2423         10  FILLER                    PIC 999.                   ELCACCTV
  2424         10  AM-HI-CCYY                PIC 9(04).                 ELCACCTV
  2425         10  AM-HI-CCYR  REDEFINES  AM-HI-CCYY.                   ELCACCTV
  2426             15  AM-HI-CC              PIC 99.                    ELCACCTV
  2427             15  AM-HI-YR              PIC 99.                    ELCACCTV
  2428         10  AM-HI-MO                  PIC 99.                    ELCACCTV
  2429         10  AM-HI-DA                  PIC 99.                    ELCACCTV
  2430     05  WS-AM-HI-CERT-DATE-N REDEFINES                              CL**3
  2431            WS-AM-HI-CERT-DATE         PIC 9(11).                    CL**3
  2432     05  WS-AM-LO-CERT-DATE.                                      ELCACCTV
  2433         10  FILLER                    PIC 999.                   ELCACCTV
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  50
* DCC043.cbl (/apps/prod/cid1p/copy/ELCACCTV)
  2434         10  AM-LO-CCYY                PIC 9(04).                 ELCACCTV
  2435         10  AM-LO-CCYR  REDEFINES  AM-LO-CCYY.                   ELCACCTV
  2436             15  AM-LO-CC              PIC 99.                    ELCACCTV
  2437             15  AM-LO-YR              PIC 99.                    ELCACCTV
  2438         10  AM-LO-MO                  PIC 99.                    ELCACCTV
  2439         10  AM-LO-DA                  PIC 99.                    ELCACCTV
  2440     05  WS-AM-LO-CERT-DATE-N REDEFINES                              CL**3
  2441            WS-AM-LO-CERT-DATE         PIC 9(11).                    CL**3
  2442     05  WS-AM-ENTRY-DATE.                                        ELCACCTV
  2443         10  FILLER                    PIC 999.                   ELCACCTV
  2444         10  AM-ENT-CCYY               PIC 9(04).                 ELCACCTV
  2445         10  AM-ENT-CCYR  REDEFINES  AM-ENT-CCYY.                 ELCACCTV
  2446             15  AM-ENT-CC             PIC 99.                    ELCACCTV
  2447             15  AM-ENT-YR             PIC 99.                    ELCACCTV
  2448         10  AM-ENT-MO                 PIC 99.                    ELCACCTV
  2449         10  AM-ENT-DA                 PIC 99.                    ELCACCTV
  2450     05  WS-AM-ENTRY-DATE-N REDEFINES                                CL**3
  2451            WS-AM-ENTRY-DATE           PIC 9(11).                    CL**3
  2452
* 2453                                    COPY ELCEPCVR.
  2454******************************************************************05/15/98
  2455*                                                                *ELCEPCVR
  2456*                                                                *ELCEPCVR
  2457*                            ELCEPCVR                            *   LV003
  2458*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  2459*                            VMOD=2.001                          *ELCEPCVR
  2460*                                                                *ELCEPCVR
  2461*   WORKING STORAGE FOR DATE VARIABLES CREATED                   *ELCEPCVR
  2462*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCEPCVR
  2463*                                                                *ELCEPCVR
  2464******************************************************************ELCEPCVR
  2465 01  WS-EP-RECORD-DATE.                                           ELCEPCVR
  2466     05  WS-EP-EXP-DTE.                                           ELCEPCVR
  2467         10  FILLER            PIC 999.                           ELCEPCVR
  2468         10  EP-EXP-CCYY       PIC 9(04).                         ELCEPCVR
  2469         10  EP-EXP-CCYR  REDEFINES  EP-EXP-CCYY.                 ELCEPCVR
  2470             15  EP-EXP-CC     PIC 99.                            ELCEPCVR
  2471             15  EP-EXP-YR     PIC 99.                            ELCEPCVR
  2472         10  EP-EXP-MO         PIC 99.                            ELCEPCVR
  2473         10  EP-EXP-DA         PIC 99.                            ELCEPCVR
  2474     05  WS-EP-EXP-DTE-N REDEFINES                                   CL**3
  2475            WS-EP-EXP-DTE      PIC 9(11).                            CL**3
  2476     05  WS-EC-EXP-DTE REDEFINES WS-EP-EXP-DTE.                      CL**5
  2477         10  FILLER            PIC 999.                              CL**5
  2478         10  EC-EXP-CCYY       PIC 9(04).                            CL**5
  2479         10  EC-EXP-CCYR  REDEFINES  EC-EXP-CCYY.                    CL**5
  2480             15  EC-EXP-CC     PIC 99.                               CL**5
  2481             15  EC-EXP-YR     PIC 99.                               CL**5
  2482         10  EC-EXP-MO         PIC 99.                               CL**5
  2483         10  EC-EXP-DA         PIC 99.                               CL**5
  2484     05  WS-EC-EXP-DTE-N REDEFINES                                   CL**5
  2485            WS-EC-EXP-DTE      PIC 9(11).                            CL**5
  2486     05  WS-EP-EFF-DTE.                                           ELCEPCVR
  2487         10  FILLER            PIC 999.                           ELCEPCVR
  2488         10  EP-EFF-CCYY       PIC 9(04).                         ELCEPCVR
  2489         10  EP-EFF-CCYR  REDEFINES  EP-EFF-CCYY.                 ELCEPCVR
  2490             15  EP-EFF-CC     PIC 99.                            ELCEPCVR
  2491             15  EP-EFF-YR     PIC 99.                            ELCEPCVR
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  51
* DCC043.cbl (/apps/prod/cid1p/copy/ELCEPCVR)
  2492         10  EP-EFF-MO         PIC 99.                            ELCEPCVR
  2493         10  EP-EFF-DA         PIC 99.                            ELCEPCVR
  2494     05  WS-EP-EFF-DTE-N REDEFINES                                   CL**3
  2495            WS-EP-EFF-DTE      PIC 9(11).                            CL**3
  2496     05  WS-EC-EFF-DTE REDEFINES WS-EP-EFF-DTE.                      CL**5
  2497         10  FILLER            PIC 999.                              CL**5
  2498         10  EC-EFF-CCYY       PIC 9(04).                            CL**5
  2499         10  EC-EFF-CCYR  REDEFINES  EC-EFF-CCYY.                    CL**5
  2500             15  EC-EFF-CC     PIC 99.                               CL**5
  2501             15  EC-EFF-YR     PIC 99.                               CL**5
  2502         10  EC-EFF-MO         PIC 99.                               CL**5
  2503         10  EC-EFF-DA         PIC 99.                               CL**5
  2504     05  WS-EC-EFF-DTE-N REDEFINES                                   CL**5
  2505            WS-EC-EFF-DTE      PIC 9(11).                            CL**5
  2506     05  WS-EP-HI-COV-DT.                                         ELCEPCVR
  2507         10  FILLER            PIC 999.                           ELCEPCVR
  2508         10  EP-COV-CCYY       PIC 9(04).                         ELCEPCVR
  2509         10  EP-COV-CCYR  REDEFINES  EP-COV-CCYY.                 ELCEPCVR
  2510             15  EP-COV-CC     PIC 99.                            ELCEPCVR
  2511             15  EP-COV-YR     PIC 99.                            ELCEPCVR
  2512         10  EP-COV-MO         PIC 99.                            ELCEPCVR
  2513         10  EP-COV-DA         PIC 99.                            ELCEPCVR
  2514     05  WS-EP-HI-COV-DT-N REDEFINES                                 CL**3
  2515            WS-EP-HI-COV-DT    PIC 9(11).                            CL**3
  2516     05  WS-EP-HI-CERT.                                           ELCEPCVR
  2517         10  FILLER            PIC 999.                           ELCEPCVR
  2518         10  EP-HI-CCYY        PIC 9(04).                         ELCEPCVR
  2519         10  EP-HI-CCYR  REDEFINES  EP-HI-CCYY.                   ELCEPCVR
  2520             15  EP-HI-CC      PIC 99.                            ELCEPCVR
  2521             15  EP-HI-YR      PIC 99.                            ELCEPCVR
  2522         10  EP-HI-MO          PIC 99.                            ELCEPCVR
  2523         10  EP-HI-DA          PIC 99.                            ELCEPCVR
  2524     05  WS-EP-HI-CERT-N REDEFINES                                   CL**3
  2525            WS-EP-HI-CERT      PIC 9(11).                            CL**3
  2526     05  WS-EP-LO-CERT.                                           ELCEPCVR
  2527         10  FILLER            PIC 999.                           ELCEPCVR
  2528         10  EP-LO-CCYY        PIC 9(04).                         ELCEPCVR
  2529         10  EP-LO-CCYR  REDEFINES   EP-LO-CCYY.                  ELCEPCVR
  2530             15  EP-LO-CC      PIC 99.                            ELCEPCVR
  2531             15  EP-LO-YR      PIC 99.                            ELCEPCVR
  2532         10  EP-LO-MO          PIC 99.                            ELCEPCVR
  2533         10  EP-LO-DA          PIC 99.                            ELCEPCVR
  2534     05  WS-EP-LO-CERT-N REDEFINES                                   CL**3
  2535            WS-EP-LO-CERT      PIC 9(11).                            CL**3
  2536     05  WS-EP-RUN-DTE.                                           ELCEPCVR
  2537         10  FILLER            PIC 999.                           ELCEPCVR
  2538         10  EP-RUN-CCYY       PIC 9(04).                         ELCEPCVR
  2539         10  EP-RUN-CCYR  REDEFINES  EP-RUN-CCYY.                 ELCEPCVR
  2540             15  EP-RUN-CC     PIC 99.                            ELCEPCVR
  2541             15  EP-RUN-YR     PIC 99.                            ELCEPCVR
  2542         10  EP-RUN-MO         PIC 99.                            ELCEPCVR
  2543         10  EP-RUN-DA         PIC 99.                            ELCEPCVR
  2544     05  WS-EP-RUN-DTE-N REDEFINES                                   CL**3
  2545            WS-EP-RUN-DTE      PIC 9(11).                            CL**3
  2546     05  WS-EC-RUN-DTE REDEFINES WS-EP-RUN-DTE.                      CL**5
  2547         10  FILLER            PIC 999.                           ELCEPCVR
  2548         10  EC-RUN-CCYY       PIC 9(04).                         ELCEPCVR
  2549         10  EC-RUN-CCYR  REDEFINES  EC-RUN-CCYY.                 ELCEPCVR
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  52
* DCC043.cbl (/apps/prod/cid1p/copy/ELCEPCVR)
  2550             15  EC-RUN-CC     PIC 99.                            ELCEPCVR
  2551             15  EC-RUN-YR     PIC 99.                            ELCEPCVR
  2552         10  EC-RUN-MO         PIC 99.                            ELCEPCVR
  2553         10  EC-RUN-DA         PIC 99.                            ELCEPCVR
  2554     05  WS-EC-RUN-DTE-N REDEFINES                                   CL**3
  2555            WS-EC-RUN-DTE      PIC 9(11).                            CL**3
  2556
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  53
* DCC043.cbl
  2558 PROCEDURE DIVISION.
  2559 0100-READ-DATE-CARD.
* 2560                             COPY ELCDTERX SUPPRESS.
  2876
  2877     MOVE LIFE-OVERRIDE-L12     TO HEAD-7-PLUG-1
  2878                                   HEAD-7-PLUG-3.
  2879     MOVE AH-OVERRIDE-L12       TO HEAD-7-PLUG-2
  2880                                   HEAD-7-PLUG-4.
  2881     MOVE WS-CURRENT-DATE TO HD-RD.
  2882     MOVE ALPH-DATE       TO HD-AD.
  2883     MOVE COMPANY-NAME    TO HD-COMP.
  2884
  2885     MOVE LOW-VALUES      TO END-CHARACTER.
  2886     MOVE SPACES          TO END-CHARACTER.
  2887
  2888     MOVE RUN-DATE        TO RUN-DT
  2889                             BEG-DATE.
  2890
  2891     OPEN INPUT CONTROL-CARD.
  2892
  2893     READ CONTROL-CARD INTO FORMAT-CONTROL-CARD
  2894          AT END   MOVE '1' TO FC-CODE
  2895                   GO TO 0130-BUILD-SELECT-DATES.
  2896
  2897 0110-READ-CARD-LOOP.
  2898     IF FC-ID = 'RF'
  2899         IF FC-CLIENT = DTE-CLIENT
  2900             GO TO 0120-FLUSH-REMAINING-CARDS.
  2901
  2902     READ CONTROL-CARD INTO FORMAT-CONTROL-CARD
  2903          AT END   MOVE '1' TO FC-CODE
  2904                   GO TO 0130-BUILD-SELECT-DATES.
  2905
  2906     GO TO 0110-READ-CARD-LOOP.
  2907
  2908 0120-FLUSH-REMAINING-CARDS.
  2909     READ CONTROL-CARD
  2910            AT END GO TO 0130-BUILD-SELECT-DATES.
  2911
  2912     GO TO 0120-FLUSH-REMAINING-CARDS.
  2913
  2914 0130-BUILD-SELECT-DATES.
  2915     IF DTE-PGM-OPT = '5' OR '7'   *> ANNIVERSARY
  2916        MOVE 'RF'       TO FC-ID
  2917        MOVE DTE-CLIENT TO FC-CLIENT
  2918        MOVE '5'        TO FC-CODE
  2919        MOVE RUN-DATE   TO FC-DATE.
  2920
  2921     IF FC-CODE = ' '
  2922       IF FC-DATE NOT NUMERIC  OR
  2923          FC-DATE = ZEROS
  2924          MOVE 'INVALID BEGIN DATE  ' TO WS-ABEND-MESSAGE
  2925          GO TO ABEND-PGM.
  2926
  2927     IF FC-CODE = ' '
  2928         MOVE FC-DATE   TO BEG-DATE
  2929         MOVE FC-MM     TO W-MM
  2930         MOVE FC-DD     TO W-DD
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  54
* DCC043.cbl
  2931         MOVE FC-CCYY   TO W-CCYY
  2932         MOVE WORK-MSG  TO H6-YTD-HD
  2933         GO TO 0140-SORT-CONTROL.
  2934
  2935     IF DTE-PGM-OPT = '5'
  2936         MOVE FC-DATE   TO BEG-DATE.
  2937
  2938     IF FC-CODE = ('1' OR '5')
  2939         SUBTRACT 1 FROM BD-CCYY
  2940         IF FC-CODE = '1'
  2941              MOVE 31   TO BD-DA
  2942              MOVE 12   TO BD-MO
  2943              MOVE '*   YEAR TO DATE   *' TO H6-YTD-HD
  2944              GO TO 0140-SORT-CONTROL
  2945         ELSE
  2946              MOVE '*  LAST 12 MONTHS  *' TO H6-YTD-HD
  2947              MOVE BEG-DATE TO SAVE-BEG-DATE
  2948              GO TO 0140-SORT-CONTROL.
  2949
  2950     IF FC-CODE = '2'
  2951         MOVE '* QUARTER TO DATE  *' TO H6-YTD-HD
  2952         IF RD-MO LESS 3
  2953             MOVE 12    TO BD-MO
  2954             MOVE 31    TO BD-DA
  2955             SUBTRACT 1 FROM BD-CCYY
  2956             GO TO 0140-SORT-CONTROL
  2957         ELSE
  2958             IF RD-MO LESS 6
  2959                 MOVE 03 TO BD-MO
  2960                 MOVE 31 TO BD-DA
  2961                 GO TO 0140-SORT-CONTROL
  2962             ELSE
  2963                 IF BD-MO LESS 9
  2964                     MOVE 06 TO BD-MO
  2965                     MOVE 30 TO BD-DA
  2966                     GO TO 0140-SORT-CONTROL
  2967                 ELSE
  2968                     MOVE 09 TO BD-MO
  2969                     MOVE 30 TO BD-DA
  2970                     GO TO 0140-SORT-CONTROL.
  2971
  2972     MOVE BIN-RUN-DATE          TO DC-BIN-DATE-1.
  2973     MOVE '6'                   TO DC-OPTION-CODE.
  2974
  2975     EVALUATE FC-CODE
  2976        WHEN '3'
  2977           MOVE '*   LAST 3 MONTHS  *' TO H6-YTD-HD
  2978           MOVE  -3 TO DC-ELAPSED-MONTHS
  2979        WHEN '4'
  2980           MOVE '*   LAST 6 MONTHS  *' TO H6-YTD-HD
  2981           MOVE  -6 TO DC-ELAPSED-MONTHS
  2982        WHEN '6'
  2983           MOVE '*    LAST MONTH    *' TO H6-YTD-HD
  2984           MOVE  -1 TO DC-ELAPSED-MONTHS
  2985     END-EVALUATE.
  2986
  2987     MOVE ZEROS                 TO DC-ELAPSED-DAYS.
  2988     MOVE '1'                   TO DC-END-OF-MONTH.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  55
* DCC043.cbl
  2989     PERFORM 8510-DATE-CONVERSION THRU 8590-EXIT.
  2990     MOVE DC-GREG-DATE-CYMD     TO BEG-DATE.
  2991
  2992
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  56
* DCC043.cbl
  2994 0140-SORT-CONTROL.
  2995     SORT SORT-WORK ON
  2996         ASCENDING  SW-RPT-TYPE-ID-OUT
  2997                    SW-CTL-OUT
  2998         INPUT PROCEDURE 0150-BUILD-EXTRACTS
  2999         OUTPUT PROCEDURE
  3000             0745-OUTPUT-PROCEDURE THRU 1090-CLOSE-EXIT.
  3001
  3002     IF SORT-RETURN NOT = ZERO AND 4
  3003          MOVE SORT-RETURN            TO WS-RETURN-CODE
  3004          MOVE 'UNSUCCESSFUL SORT RC' TO WS-ABEND-MESSAGE
  3005          GO TO ABEND-PGM.
  3006
  3007     GOBACK.
  3008
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  57
* DCC043.cbl
  3010 0150-BUILD-EXTRACTS SECTION.
  3011
  3012     display ' begin 0150 '
  3013     .
  3014 0160-BEGIN-PROCESSING.
  3015     OPEN INPUT
  3016             ACC-MSTR
  3017             ERPLAN-IN
  3018             EPEC-FILE
  3019         OUTPUT WORK-FILE
  3020             PRNTR.
  3021
  3022     IF ERACCTT-FILE-STATUS  = '00' OR '97'
  3023         NEXT SENTENCE
  3024       ELSE
  3025         MOVE '11'                TO W-ABEND-CODE-1
  3026         MOVE ERACCTT-FILE-STATUS TO W-ABEND-CODE-2
  3027         MOVE WS-ABEND-CODE       TO WS-RETURN-CODE
  3028         MOVE 'OPEN ERROR - ERACCTT' TO WS-ABEND-MESSAGE
  3029         GO TO ABEND-PGM.
  3030
  3031     IF ERPLAN-FILE-STATUS  = '00' OR '97'
  3032         NEXT SENTENCE
  3033       ELSE
  3034         MOVE '12'                TO W-ABEND-CODE-1
  3035         MOVE ERPLAN-FILE-STATUS  TO W-ABEND-CODE-2
  3036         MOVE WS-ABEND-CODE       TO WS-RETURN-CODE
  3037         MOVE 'OPEN ERROR - ERPLAN ' TO WS-ABEND-MESSAGE
  3038         GO TO ABEND-PGM.
  3039
  3040*** detail accums occurs 4
  3041     PERFORM 0550-ZERO-DA  VARYING SA FROM 1 BY 1
  3042                           UNTIL SA GREATER 4.
  3043***  print accums occurs 36
  3044     PERFORM 0560-ZERO-PA  VARYING SB FROM 1 BY 1
  3045                           UNTIL SB GREATER 36.
  3046
  3047     PERFORM 0570-ZERO-XDA VARYING CL FROM 1 BY 1
  3048                           UNTIL CL GREATER 10.
  3049
  3050     PERFORM 0240-READ-EXTRACT THRU 0240-EXIT.
  3051     PERFORM 0260-READ-ACCT    THRU 0260-EXIT.
  3052
  3053     MOVE EP-CONTROL TO WS-SAVE-CONTROL.
  3054
  3055     GO TO 0200-CHECK-ACCT-MSTR.
  3056
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  58
* DCC043.cbl
  3058 0170-CHECK-CONTROL.
  3059
  3060     display ' made 0170 '
  3061
  3062     PERFORM 0250-CHECK-PLAN  THRU 0250-EXIT.
  3063
  3064     IF EXCLUDING-BENEFIT
  3065        GO TO 0190-BYPASS-ACCUM.
  3066
  3067     IF DTE-PGM-OPT = '5'
  3068        AND AM-AN-MO NOT = RUN-MO
  3069        GO TO 0190-BYPASS-ACCUM.
  3070
  3071     IF AM-RET-Y-N = 'L'
  3072         IF EP-RCD-TYPE NOT = LIFE-OVERRIDE-L1
  3073             GO TO 0190-BYPASS-ACCUM.
  3074
  3075     IF AM-RET-Y-N = 'D'
  3076         IF EP-RCD-TYPE NOT = AH-OVERRIDE-L1
  3077             GO TO 0190-BYPASS-ACCUM.
  3078
  3079     IF EP-RECORD-ID = 'EP'
  3080         IF EP-RCD-TYPE = LIFE-OVERRIDE-L1
  3081             ADD EP-RETRO-PAYMENTS TO DA-CPS (3)
  3082             ADD EP-RETRO-EXPENSES TO DA-EXP (3)
  3083             ADD EP-RETRO-OTH-COMM TO DA-OTC (3)
  3084         ELSE
  3085             ADD EP-RETRO-PAYMENTS TO DA-CPS (4)
  3086             ADD EP-RETRO-EXPENSES TO DA-EXP (4)
  3087             ADD EP-RETRO-OTH-COMM TO DA-OTC (4).
  3088
  3089     IF EP-RECORD-ID = 'EP'
  3090         IF EP-RUN-DTE NOT GREATER BEG-DATE
  3091             IF EP-RCD-TYPE = LIFE-OVERRIDE-L1
  3092                 ADD EP-RETRO-PAYMENTS TO DA-CPS (1)
  3093                 ADD EP-RETRO-EXPENSES TO DA-EXP (1)
  3094                 ADD EP-RETRO-OTH-COMM TO DA-OTC (1)
  3095             ELSE
  3096                 ADD EP-RETRO-PAYMENTS TO DA-CPS (2)
  3097                 ADD EP-RETRO-EXPENSES TO DA-EXP (2)
  3098                 ADD EP-RETRO-OTH-COMM TO DA-OTC (2).
  3099
  3100     IF EP-PURGE = 'P'
  3101         IF EP-RUN-DTE GREATER BEG-DATE
  3102             MOVE 'Q' TO EP-PURGE
  3103             GO TO 0180-TEST-ACCUM
  3104         ELSE
  3105             GO TO 0180-TEST-ACCUM.
  3106
  3107     IF EP-RUN-CCYY = RD-CCYY  AND
  3108        EP-RUN-MO = RD-MO
  3109         MOVE '2' TO EP-PURGE
  3110         GO TO 0180-TEST-ACCUM.
  3111
  3112     IF EP-RUN-CCYY = BD-CCYY  AND
  3113        EP-RUN-MO = BD-MO
  3114         MOVE '1' TO EP-PURGE
  3115         GO TO 0180-TEST-ACCUM.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  59
* DCC043.cbl
  3116
  3117     GO TO 0190-BYPASS-ACCUM.
  3118
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  60
* DCC043.cbl
  3120 0180-TEST-ACCUM.
  3121     display ' made 0180 ' ep-account ' ' am-ret-y-n
  3122     IF EP-RECORD-ID = 'EP'
  3123         IF EP-PURGE = ('1' OR 'P')
  3124             IF EP-RCD-TYPE = LIFE-OVERRIDE-L1
  3125                 MOVE +1 TO SA
  3126                 MOVE LIFE-RETENT   TO RETENT-FACT
  3127                 PERFORM 0640-EP-ADD THRU 0640-EXIT
  3128             ELSE
  3129                 MOVE +2 TO SA
  3130                 MOVE   AH-RETENT   TO RETENT-FACT
  3131                 PERFORM 0640-EP-ADD THRU 0640-EXIT.
  3132
  3133     IF EP-RECORD-ID = 'EP'
  3134         IF EP-PURGE = ('2' OR 'P' OR 'Q')
  3135             IF EP-RCD-TYPE = LIFE-OVERRIDE-L1
  3136                 MOVE +3 TO SA
  3137                 MOVE LIFE-RETENT   TO RETENT-FACT
  3138                 PERFORM 0640-EP-ADD THRU 0640-EXIT
  3139             ELSE
  3140                 MOVE +4 TO SA
  3141                 MOVE   AH-RETENT   TO RETENT-FACT
  3142                 PERFORM 0640-EP-ADD THRU 0640-EXIT.
  3143
  3144     IF EP-RECORD-ID = 'EC'
  3145         IF EP-PURGE = ('1' OR 'P')
  3146             IF EP-RCD-TYPE = LIFE-OVERRIDE-L1
  3147                 MOVE +1 TO SA
  3148                 PERFORM 0690-EC-ADD THRU 0729-EXIT
  3149             ELSE
  3150                 MOVE +2 TO SA
  3151                 PERFORM 0690-EC-ADD THRU 0729-EXIT.
  3152
  3153     IF EP-RECORD-ID = 'EC'
  3154         IF EP-PURGE = ('2' OR 'P' OR 'Q')
  3155             IF EP-RCD-TYPE = LIFE-OVERRIDE-L1
  3156                 MOVE +3 TO SA
  3157                 PERFORM 0690-EC-ADD THRU 0729-EXIT
  3158             ELSE
  3159                 MOVE +4 TO SA
  3160                 PERFORM 0690-EC-ADD THRU 0729-EXIT.
  3161
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  61
* DCC043.cbl
  3163 0190-BYPASS-ACCUM.
  3164     display ' made 0190 '
  3165     PERFORM 0240-READ-EXTRACT THRU 0240-EXIT.
  3166
  3167     IF EP-CONTROL = WS-SAVE-CONTROL
  3168         GO TO 0170-CHECK-CONTROL.
  3169
  3170     PERFORM 0280-CALCULATE-RETRO THRU 0330-EXIT.
  3171
  3172     IF EP-CONTROL = HIGH-VALUES
  3173         GO TO 0220-BUILD-EXTRACTS-EXIT.
  3174
  3175     MOVE EP-CONTROL TO WS-SAVE-CONTROL.
  3176
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  62
* DCC043.cbl
  3178 0200-CHECK-ACCT-MSTR.
  3179     display ' made 0200 ' ws-acct-control (1:19) ' '
  3180        ws-save-control (1:19) ' ' WS-SAVE-EXP-DATE
  3181     IF WS-ACCT-CONTROL LESS WS-SAVE-CONTROL
  3182         IF AM-GPCD = 98
  3183             PERFORM 0360-BUILD-DUMMY-GA
  3184             PERFORM 0260-READ-ACCT THRU 0260-EXIT
  3185             GO TO 0200-CHECK-ACCT-MSTR
  3186         ELSE
  3187             PERFORM 0260-READ-ACCT THRU 0260-EXIT
  3188             GO TO 0200-CHECK-ACCT-MSTR.
  3189
  3190 0210-NO-ACCT-MSTR.
  3191     IF WS-ACCT-CONTROL GREATER WS-SAVE-CONTROL
  3192         PERFORM 0270-NO-ACCT-MSG
  3193         PERFORM 0240-READ-EXTRACT THRU 0240-EXIT
  3194         IF EP-CONTROL = HIGH-VALUES
  3195             GO TO 0220-BUILD-EXTRACTS-EXIT
  3196         ELSE
  3197             MOVE EP-CONTROL TO WS-SAVE-CONTROL
  3198             GO TO 0200-CHECK-ACCT-MSTR.
  3199
  3200     IF DTE-PGM-OPT = '7'
  3201         PERFORM 0215-COMPUTE-BEG-DATE THRU 0215-EXIT.
  3202
  3203     GO TO 0170-CHECK-CONTROL.
  3204
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  63
* DCC043.cbl
  3206 0215-COMPUTE-BEG-DATE.
  3207     IF (AM-ANNIVERSARY-DATE NOT NUMERIC) OR
  3208        (AM-AN-MO LESS 01 OR GREATER 12)
  3209            MOVE SAVE-BEG-DATE TO BEG-DATE
  3210            GO TO 0215-EXIT.
  3211
  3212     MOVE RD-CCYY  TO BD-CCYY.
  3213     MOVE AM-AN-MO TO BD-MO.
  3214
  3215     IF BD-MO NOT LESS RD-MO
  3216         SUBTRACT 1 FROM BD-CCYY.
  3217
  3218     IF BD-MO = 04 OR 06 OR 09 OR 11
  3219         MOVE 30 TO BD-DA
  3220     ELSE
  3221         MOVE 31 TO BD-DA.
  3222
  3223     IF BD-MO = 02
  3224         MOVE BD-CCYY     TO HOLD-CEN-1-CCYY
  3225         MOVE 'H'         TO DC-OPTION-CODE
  3226         PERFORM 8510-DATE-CONVERSION THRU 8590-EXIT
  3227         IF ONLY-LEAP-YEAR
  3228             MOVE HOLD-CEN-1-DA TO BD-DA
  3229         ELSE
  3230             MOVE 28            TO BD-DA.
  3231
  3232 0215-EXIT.
  3233     EXIT.
  3234
  3235 0220-BUILD-EXTRACTS-EXIT.
  3236     CLOSE
  3237         ACC-MSTR
  3238         ERPLAN-IN
  3239         EPEC-FILE.
  3240
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  64
* DCC043.cbl
  3242****************************************************************
  3243*                                                              *
  3244****************************************************************
  3245
  3246 0230-PERFORMED-ROUTINES SECTION.
  3247
  3248 0240-READ-EXTRACT.
  3249     READ EPEC-FILE AT END
  3250          MOVE HIGH-VALUES TO EP-CONTROL
  3251          GO TO 0240-EXIT.
  3252
  3253     IF EP-RECORD-ID NOT = 'EP' AND 'EC'
  3254         GO TO 0240-READ-EXTRACT.
  3255
  3256     IF EP-REIN = 'R'
  3257         GO TO 0240-READ-EXTRACT.
  3258
  3259     IF EP-RUN-DTE GREATER RUN-DT
  3260         GO TO 0240-READ-EXTRACT.
  3261
* 3262     COPY ELCEPCM1.
  3263******************************************************************05/15/98
  3264*                                                                *ELCEPCM1
  3265*                                                                *ELCEPCM1
  3266*                            ELCEPCM1                            *   LV007
  3267*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**5
  3268*                            VMOD=2.001                          *ELCEPCM1
  3269*                                                                *ELCEPCM1
  3270*   COPY FILE VARIABLES TO WORKING STORAGE                       *ELCEPCM1
  3271*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCEPCM1
  3272*                                                                *ELCEPCM1
  3273******************************************************************ELCEPCM1
  3274                                                                     CL**7
  3275     MOVE EP-EXP-DTE         TO  WS-EP-EXP-DTE-N                     CL**7
  3276                                 WS-EC-EXP-DTE-N.                    CL**7
  3277     MOVE EP-EFF-DTE         TO  WS-EP-EFF-DTE-N                     CL**7
  3278                                 WS-EC-EFF-DTE-N.                    CL**7
  3279     MOVE EP-RUN-DTE         TO  WS-EP-RUN-DTE-N                     CL**7
  3280                                 WS-EC-RUN-DTE-N.                    CL**7
  3281                                                                     CL**7
  3282     IF VALID-EP-ID                                                  CL**7
  3283         MOVE EP-HI-COV-DT   TO  WS-EP-HI-COV-DT-N                   CL**7
  3284         MOVE EP-HI-CERT     TO  WS-EP-HI-CERT-N                     CL**7
  3285         MOVE EP-LO-CERT     TO  WS-EP-LO-CERT-N.                    CL**7
  3286                                                                     CL**7
  3287
  3288 0240-EXIT.
  3289     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  65
* DCC043.cbl
  3291
  3292 0250-CHECK-PLAN.
  3293
  3294     PERFORM 0650-EP-EARN-TYPE THRU 0680-EXIT.
  3295
  3296*    IF AM-RET-Y-N = ' '   OR  'N'
  3297*        MOVE +1.0 TO LIFE-RETENT AH-RETENT
  3298*        GO TO 0250-EXIT.
  3299
  3300
  3301     IF EP-COMPANY-CD  EQUAL  WS-PL-COMPANY-CD   AND
  3302        EP-CNTRL-1     EQUAL  WS-PL-CONTROL-A    AND
  3303        EP-RCD-TYPE    EQUAL  WS-PL-BENEFIT-TYPE AND
  3304        EP-BEN-CODE    EQUAL  WS-PL-BENEFIT-CODE
  3305            GO TO 0250-EXIT.
  3306
  3307     MOVE EP-COMPANY-CD       TO WS-PL-COMPANY-CD.
  3308     MOVE EP-CNTRL-1          TO WS-PL-CONTROL-A.
  3309     MOVE EP-RCD-TYPE         TO WS-PL-BENEFIT-TYPE.
  3310     MOVE EP-BEN-CODE         TO WS-PL-BENEFIT-CODE.
  3311
  3312     MOVE SPACE               TO WS-EXCLUSION-SWITCH.
  3313
  3314     MOVE +1                  TO NDX.
  3315
  3316 0250-PLAN-LOOP.
  3317
  3318     IF NDX GREATER THAN +20
  3319        MOVE +1                 TO NDX
  3320        GO TO 025A-EDIT-FOR-SPECIAL.
  3321
  3322     IF AM-BENEFIT-CODE (NDX)  EQUAL EP-BEN-CODE AND
  3323        AM-BENEFIT-TYPE (NDX)  EQUAL EP-RCD-TYPE
  3324          MOVE AM-BENEFIT-REVISION (NDX) TO WS-PL-REVISION-NO
  3325          MOVE WS-PLAN-CONTROL     TO PL-CONTROL-PRIMARY
  3326          GO TO 0250-READ-PLAN
  3327     ELSE
  3328        ADD +1                TO NDX
  3329        GO TO 0250-PLAN-LOOP.
  3330
  3331 0250-READ-PLAN.
  3332
  3333     IF AM-BENEFIT-RETRO-Y-N (NDX) = 'N'
  3334         MOVE '*'              TO WS-EXCLUSION-SWITCH
  3335         GO TO 0250-EXIT.
  3336
  3337     READ ERPLAN-IN.
  3338
  3339     IF ERPLAN-FILE-STATUS  EQUAL '00'
  3340         NEXT SENTENCE
  3341     ELSE
  3342        IF ERPLAN-FILE-STATUS  EQUAL '23'
  3343            GO TO 0250-PLAN-NOT-FOUND
  3344        ELSE
  3345            MOVE ERPLAN-FILE-STATUS  TO WS-ABEND-FILE-STATUS
  3346            MOVE 'READ ERROR - ERPLAN ' TO WS-ABEND-MESSAGE
  3347            DISPLAY '**BAD PLAN FILE READ'
  3348            DISPLAY '**ERPLAN-FILE-STATUS= ' ERPLAN-FILE-STATUS
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  66
* DCC043.cbl
  3349            GO TO ABEND-PGM.
  3350
  3351     IF EP-COMPANY-CD  EQUAL  PL-COMPANY-CD   AND
  3352        EP-CNTRL-1     EQUAL  PL-CONTROL-A    AND
  3353        EP-RCD-TYPE    EQUAL  PL-BENEFIT-TYPE AND
  3354        AM-BENEFIT-CODE (NDX)  EQUAL  PL-BENEFIT-CODE
  3355           NEXT SENTENCE
  3356     ELSE
  3357           GO TO 0250-PLAN-NOT-FOUND.
  3358
  3359     IF AM-RET-Y-N = ' '   OR  'N'
  3360         MOVE +1.0 TO LIFE-RETENT AH-RETENT
  3361         GO TO 0250-EXIT.
  3362
  3363     IF PL-RETRO-RET EQUAL ZEROS
  3364         GO TO 0250-PLAN-NOT-FOUND.
  3365
  3366     IF EP-RCD-TYPE = LIFE-OVERRIDE-L1
  3367         COMPUTE LIFE-RETENT = 1 - PL-RETRO-RET
  3368         GO TO 0250-EXIT
  3369     ELSE
  3370         COMPUTE AH-RETENT   = 1 - PL-RETRO-RET
  3371         GO TO 0250-EXIT.
  3372
  3373 025A-EDIT-FOR-SPECIAL.
  3374
  3375     IF (AM-BENEFIT-CODE (NDX) EQUAL '99')
  3376      AND
  3377        (AM-BENEFIT-TYPE (NDX) EQUAL EP-RCD-TYPE)
  3378          MOVE AM-BENEFIT-REVISION (NDX) TO WS-PL-REVISION-NO
  3379          MOVE AM-BENEFIT-CODE (NDX)     TO WS-PL-BENEFIT-CODE
  3380          MOVE WS-PLAN-CONTROL           TO PL-CONTROL-PRIMARY
  3381          GO TO 0250-READ-PLAN.
  3382
  3383     IF (AM-BENEFIT-CODE (NDX) EQUAL '91')
  3384      AND
  3385        (AM-BENEFIT-TYPE (NDX) EQUAL LIFE-OVERRIDE-L1)
  3386        AND
  3387          AM-BENEFIT-TYPE (NDX) EQUAL EP-RCD-TYPE
  3388          IF CLAS-CO-BEN-I-G-CD (CLAS-INDEXL) EQUAL 'I'
  3389              AND CLAS-I-RL-AH (CLAS-INDEXL) EQUAL 'R'
  3390          MOVE AM-BENEFIT-REVISION (NDX) TO WS-PL-REVISION-NO
  3391          MOVE AM-BENEFIT-CODE (NDX)     TO WS-PL-BENEFIT-CODE
  3392          MOVE WS-PLAN-CONTROL           TO PL-CONTROL-PRIMARY
  3393          GO TO 0250-READ-PLAN.
  3394
  3395     IF (AM-BENEFIT-CODE (NDX) EQUAL '91')
  3396      AND
  3397        (AM-BENEFIT-TYPE (NDX) EQUAL AH-OVERRIDE-L1)
  3398      AND
  3399        (AM-BENEFIT-TYPE (NDX) EQUAL EP-RCD-TYPE)
  3400         IF CLAS-CO-BEN-I-G-CD (CLAS-INDEXL) EQUAL 'I'
  3401            MOVE AM-BENEFIT-REVISION (NDX) TO WS-PL-REVISION-NO
  3402            MOVE AM-BENEFIT-CODE (NDX)   TO WS-PL-BENEFIT-CODE
  3403            MOVE WS-PLAN-CONTROL         TO PL-CONTROL-PRIMARY
  3404            GO TO 0250-READ-PLAN.
  3405
  3406     IF (AM-BENEFIT-CODE (NDX) EQUAL '92')
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  67
* DCC043.cbl
  3407      AND
  3408        (AM-BENEFIT-TYPE (NDX) EQUAL LIFE-OVERRIDE-L1)
  3409      AND
  3410        (AM-BENEFIT-TYPE (NDX) EQUAL EP-RCD-TYPE)
  3411         IF (CLAS-CO-BEN-I-G-CD (CLAS-INDEXL) EQUAL 'G')
  3412           AND (CLAS-I-RL-AH (CLAS-INDEXL) EQUAL 'R')
  3413             MOVE AM-BENEFIT-REVISION (NDX) TO WS-PL-REVISION-NO
  3414             MOVE AM-BENEFIT-CODE (NDX)   TO WS-PL-BENEFIT-CODE
  3415             MOVE WS-PLAN-CONTROL         TO PL-CONTROL-PRIMARY
  3416             GO TO 0250-READ-PLAN.
  3417
  3418     IF (AM-BENEFIT-CODE (NDX) EQUAL '92')
  3419      AND
  3420        (AM-BENEFIT-TYPE (NDX) EQUAL AH-OVERRIDE-L1)
  3421      AND
  3422        (AM-BENEFIT-TYPE (NDX) EQUAL EP-RCD-TYPE)
  3423         IF (CLAS-CO-BEN-I-G-CD (CLAS-INDEXL) EQUAL 'G')
  3424             MOVE AM-BENEFIT-REVISION (NDX) TO WS-PL-REVISION-NO
  3425             MOVE AM-BENEFIT-CODE (NDX)   TO WS-PL-BENEFIT-CODE
  3426             MOVE WS-PLAN-CONTROL         TO PL-CONTROL-PRIMARY
  3427             GO TO 0250-READ-PLAN.
  3428
  3429     IF (AM-BENEFIT-CODE (NDX) EQUAL '93')
  3430      AND
  3431        (AM-BENEFIT-TYPE (NDX) EQUAL LIFE-OVERRIDE-L1)
  3432      AND
  3433        (AM-BENEFIT-TYPE (NDX) EQUAL EP-RCD-TYPE)
  3434         IF (CLAS-CO-BEN-I-G-CD (CLAS-INDEXL) EQUAL 'I')
  3435           AND (CLAS-I-RL-AH (CLAS-INDEXL) EQUAL 'P' OR 'L')
  3436             MOVE AM-BENEFIT-REVISION (NDX) TO WS-PL-REVISION-NO
  3437             MOVE AM-BENEFIT-CODE (NDX)   TO WS-PL-BENEFIT-CODE
  3438             MOVE WS-PLAN-CONTROL         TO PL-CONTROL-PRIMARY
  3439             GO TO 0250-READ-PLAN.
  3440
  3441     IF (AM-BENEFIT-CODE (NDX) EQUAL '94')
  3442      AND
  3443        (AM-BENEFIT-TYPE (NDX) EQUAL LIFE-OVERRIDE-L1)
  3444      AND
  3445        (AM-BENEFIT-TYPE (NDX) EQUAL EP-RCD-TYPE)
  3446         IF (CLAS-CO-BEN-I-G-CD (CLAS-INDEXL) EQUAL 'G')
  3447           AND (CLAS-I-RL-AH (CLAS-INDEXL) EQUAL 'P' OR 'L')
  3448             MOVE AM-BENEFIT-REVISION (NDX) TO WS-PL-REVISION-NO
  3449             MOVE AM-BENEFIT-CODE (NDX)   TO WS-PL-BENEFIT-CODE
  3450             MOVE WS-PLAN-CONTROL         TO PL-CONTROL-PRIMARY
  3451             GO TO 0250-READ-PLAN.
  3452
  3453     IF (AM-BENEFIT-CODE (NDX) EQUAL '98')
  3454      AND
  3455        (AM-BENEFIT-TYPE (NDX) EQUAL EP-RCD-TYPE)
  3456             MOVE AM-BENEFIT-REVISION (NDX) TO WS-PL-REVISION-NO
  3457             MOVE AM-BENEFIT-CODE (NDX)   TO WS-PL-BENEFIT-CODE
  3458             MOVE WS-PLAN-CONTROL         TO PL-CONTROL-PRIMARY
  3459             GO TO 0250-READ-PLAN.
  3460
  3461     IF NDX NOT LESS THAN +20
  3462       GO TO 0250-PLAN-NOT-FOUND
  3463     ELSE
  3464       ADD  +1                 TO NDX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  68
* DCC043.cbl
  3465       GO TO 025A-EDIT-FOR-SPECIAL.
  3466
  3467
  3468 0250-PLAN-NOT-FOUND.
  3469     IF AM-RET-Y-N = ' '   OR  'N'
  3470         MOVE +1.0 TO LIFE-RETENT AH-RETENT
  3471         GO TO 0250-EXIT
  3472     ELSE
  3473         COMPUTE LIFE-RETENT = 1 - AM-LF-RET
  3474         COMPUTE AH-RETENT   = 1 - AM-AH-RET
  3475         GO TO 0250-EXIT.
  3476
  3477 0250-EXIT.
  3478     EXIT.
  3479
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  69
* DCC043.cbl
  3481 0260-READ-ACCT.
  3482     READ ACC-MSTR
  3483             AT END MOVE HIGH-VALUES TO WS-ACCT-CONTROL
  3484                    GO TO 0260-EXIT.
  3485
* 3486     COPY ELCACCTI.
  3487******************************************************************04/14/98
  3488*                                                                *ELCACCTI
  3489*                            ELCACCTI                            *   LV003
  3490*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
  3491*                            VMOD=2.001                          *ELCACCTI
  3492*                                                                *ELCACCTI
  3493*   COPY FILE VARIABLES TO WORKING STORAGE                       *ELCACCTI
  3494*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCACCTI
  3495*                                                                *ELCACCTI
  3496*  NO  CID  MODS  IN  COPYBOOK  ELCACCTI                         *ELCACCTI
  3497*                                                                *ELCACCTI
  3498******************************************************************ELCACCTI
  3499     MOVE AM-EXPIRE-DT           TO  WS-AM-EXPIRE-DT-N.              CL**2
  3500     MOVE AM-VG-EXP-DATE         TO  WS-AM-VG-EXP-DATE-N.            CL**2
  3501     MOVE AM-EFFECT-DT           TO  WS-AM-EFFECT-DT-N.              CL**2
  3502     MOVE AM-PREV-EXP-DT         TO  WS-AM-PREV-EXP-DT-N.            CL**2
  3503     MOVE AM-PREV-EFF-DT         TO  WS-AM-PREV-EFF-DT-N             CL**2
  3504     MOVE AM-ANNIVERSARY-DATE    TO  WS-AM-ANNIVERSARY-DATE-N.       CL**2
  3505     MOVE AM-HI-CERT-DATE        TO  WS-AM-HI-CERT-DATE-N.           CL**2
  3506     MOVE AM-LO-CERT-DATE        TO  WS-AM-LO-CERT-DATE-N.           CL**2
  3507     MOVE AM-ENTRY-DATE          TO  WS-AM-ENTRY-DATE-N.             CL**2
  3508
  3509     MOVE AM-MSTR-CNTRL TO WS-MSTR-CNTRL.
  3510     MOVE AM-EFFECT-DT  TO WS-EFFECT.
  3511
  3512     IF AM-RET-ST-TAX-USE = 'Y' OR 'P' OR 'E'
  3513        MOVE TAX-EXPENSE-LINE    TO WS-EX-LINE
  3514     ELSE
  3515        MOVE EXPENSE-LINE        TO WS-EX-LINE
  3516     END-IF
  3517
  3518     IF DTE-PGM-OPT  = '5' AND
  3519        AM-AN-MO NOT = RUN-MO
  3520         MOVE SPACES TO AM-RETRO-POOL
  3521         MOVE +0.0   TO AM-LF-RET AM-AH-RET
  3522         MOVE 'N'    TO AM-RET-Y-N.
  3523
  3524     IF DTE-CLIENT = 'GIC'
  3525         MOVE 'P' TO AM-RET-P-E.
  3526     IF AM-RETRO-QUALIFY-LIMIT NOT NUMERIC  OR
  3527        AM-RETRO-QUALIFY-LIMIT = ZEROS
  3528         MOVE -9999999         TO AM-RETRO-QUALIFY-LIMIT.
  3529
  3530     IF AM-RET-P-E NOT = 'P'  AND  'E'
  3531         MOVE 'E'              TO AM-RET-P-E.
  3532     IF AM-RETRO-PREM-P-E NOT = 'P'  AND  'E'
  3533         MOVE AM-RET-P-E       TO AM-RETRO-PREM-P-E.
  3534     IF AM-RETRO-CLMS-P-I NOT = 'P'  AND  'I'
  3535         MOVE 'I'              TO AM-RETRO-CLMS-P-I.
  3536     IF AM-RETRO-RET-METHOD-LF NOT = 'P'  AND  'S'
  3537         MOVE 'P'              TO AM-RETRO-RET-METHOD-LF.
  3538     IF AM-RETRO-RET-BASIS-LF NOT = 'P'  AND  'E'
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  70
* DCC043.cbl
  3539         MOVE 'P'              TO AM-RETRO-RET-BASIS-LF.
  3540     IF AM-RETRO-RET-METHOD-AH NOT = 'P'  AND  'S'  AND  'L'
  3541         MOVE 'P'              TO AM-RETRO-RET-METHOD-AH.
  3542     IF AM-RETRO-RET-BASIS-AH NOT = 'P'  AND  'E'
  3543         MOVE 'P'              TO AM-RETRO-RET-BASIS-AH.
  3544
  3545     IF AM-RETRO-USE-LIFE-METHOD
  3546         MOVE AM-RETRO-RET-BRACKET-LF TO AM-RETRO-RET-BRACKET-AH.
  3547
  3548 0260-EXIT.
  3549     EXIT.
  3550
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  71
* DCC043.cbl
  3552 0270-NO-ACCT-MSG.
  3553     IF LINE-CNT GREATER +55
  3554         MOVE ZERO   TO LINE-CNT
  3555         MOVE '1'    TO X
  3556         MOVE HEAD-1 TO P-DATA
  3557         PERFORM 0610-PRT-RTN THRU 0630-EXIT
  3558         MOVE ' '    TO X
  3559         MOVE HEAD-2 TO P-DATA
  3560         PERFORM 0610-PRT-RTN THRU 0630-EXIT
  3561         ADD +1               TO PAGE-CNT
  3562         MOVE PAGE-CNT        TO H3-PAGE
  3563         MOVE ' '    TO X
  3564         MOVE HEAD-3 TO P-DATA
  3565         PERFORM 0610-PRT-RTN THRU 0630-EXIT
  3566         MOVE ' '    TO X
  3567         MOVE HEAD-4 TO P-DATA
  3568         PERFORM 0610-PRT-RTN THRU 0630-EXIT
  3569         MOVE ' '    TO X
  3570         MOVE SPACES TO P-DATA
  3571         PERFORM 0610-PRT-RTN THRU 0630-EXIT.
  3572
  3573     MOVE WS-SAVE-CARR     TO H5-CARR.
  3574     MOVE WS-SAVE-COMP     TO H5-COMP.
  3575     MOVE WS-SAVE-STATE    TO H5-ST.
  3576     MOVE WS-SAVE-ACCT     TO H5-ACCT.
  3577     MOVE WS-SAVE-EXP-DATE TO WORK-DATE.
  3578     MOVE WK-YR            TO H5-TYR.
  3579     MOVE WK-MO            TO H5-TMO.
  3580     MOVE WK-DA            TO H5-TDA.
  3581     MOVE WS-SAVE-EFF-DATE TO WORK-DATE.
  3582     MOVE WK-YR            TO H5-FYR.
  3583     MOVE WK-MO            TO H5-FMO.
  3584     MOVE WK-DA            TO H5-FDA.
  3585     MOVE ' NO MATCHING ACCOUNT MASTER' TO H5-MESSAGE.
  3586     MOVE ' '              TO X.
  3587     MOVE HEAD-5           TO P-DATA.
  3588     PERFORM 0610-PRT-RTN THRU 0630-EXIT.
  3589
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  72
* DCC043.cbl
  3591 0280-CALCULATE-RETRO.
  3592******************************************************************
  3593*              SPECIAL LOSS-RESERVE CALCULATION FOR OLI
  3594
  3595     display ' made 0280 '
  3596     IF DTE-CLIENT NOT = 'POS'
  3597         GO TO 0290-SKIP-CC.
  3598
  3599     IF AM-CARRIER NOT = '1'
  3600         GO TO 0290-SKIP-CC.
  3601
  3602     IF AM-FLD-5 NOT = 'CC'
  3603         GO TO 0290-SKIP-CC.
  3604
  3605     COMPUTE DA-LRV (1) = (+.40 * ((DA-ISP (1) - DA-CNP (1))
  3606                     - DA-UP (1))) - DA-CLM (1).
  3607     COMPUTE DA-LRV (2) = (+.40 * ((DA-ISP (2) - DA-CNP (2))
  3608                     - DA-UP (2))) - DA-CLM (2).
  3609     COMPUTE DA-LRV (3) = (+.40 * ((DA-ISP (3) - DA-CNP (3))
  3610                     - DA-UP (3))) - DA-CLM (3).
  3611     COMPUTE DA-LRV (4) = (+.40 * ((DA-ISP (4) - DA-CNP (4))
  3612                     - DA-UP (4))) - DA-CLM (4).
  3613
  3614     IF DA-LRV (1) LESS ZERO
  3615         ADD DA-LRV (1) TO DA-LRV (2)
  3616         MOVE ZEROS TO DA-LRV (1)
  3617         IF DA-LRV (2) LESS ZERO
  3618             MOVE ZEROS TO DA-LRV (2).
  3619
  3620     IF DA-LRV (2) LESS ZERO
  3621         ADD DA-LRV (2) TO DA-LRV (1)
  3622         MOVE ZEROS TO DA-LRV (2)
  3623         IF DA-LRV (1) LESS ZERO
  3624             MOVE ZEROS TO DA-LRV (1).
  3625
  3626     IF DA-LRV (3) LESS ZERO
  3627         ADD DA-LRV (3) TO DA-LRV (4)
  3628         MOVE ZEROS TO DA-LRV (3)
  3629         IF DA-LRV (4) LESS ZERO
  3630             MOVE ZEROS TO DA-LRV (4).
  3631
  3632     IF DA-LRV (4) LESS ZERO
  3633         ADD DA-LRV (4) TO DA-LRV (3)
  3634         MOVE ZEROS TO DA-LRV (4)
  3635         IF DA-LRV (3) LESS ZERO
  3636             MOVE ZEROS TO DA-LRV (3).
  3637
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  73
* DCC043.cbl
  3639******************************************************************
  3640**       END OF SPECIAL OLI CODING
  3641******************************************************************
  3642
  3643 0290-SKIP-CC.
  3644
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  74
* DCC043.cbl
  3646 0300-CALC-RETRO-A.
  3647
  3648     display ' made 0300 ' ep-account
  3649
  3650     MOVE +1 TO SA.
  3651     MOVE +3 TO SB.
  3652     MOVE +1 TO SC.
  3653     MOVE +3 TO SF.
  3654     PERFORM 0380-COMPUTE-YTD THRU 0390-EXIT.
  3655     MOVE +2 TO SA.
  3656     MOVE +4 TO SB.
  3657     MOVE +2 TO SC.
  3658     PERFORM 0380-COMPUTE-YTD THRU 0390-EXIT.
  3659     MOVE +3 TO SB.
  3660     MOVE +4 TO SC.
  3661     MOVE +6 TO SF.
  3662     PERFORM 0400-COMPUTE-ITD THRU 0410-EXIT.
  3663     MOVE +4 TO SB.
  3664     MOVE +5 TO SC.
  3665     PERFORM 0400-COMPUTE-ITD THRU 0410-EXIT.
  3666     MOVE SPACES       TO SW-REC.
  3667     MOVE 'A'          TO SW-RPT-TYPE-ID.
  3668     MOVE AM-NAME      TO SW-NAME.
  3669     MOVE AM-ADDRS     TO SW-ADDRS.
  3670     MOVE SPACES       TO SW-CITY.
  3671     STRING AM-ADDR-CITY ' ' AM-ADDR-STATE
  3672        DELIMITED BY '  ' INTO SW-CITY
  3673     END-STRING
  3674     MOVE AM-ZIP       TO SW-ZIP.
  3675     MOVE AM-EXPIRE-DT TO SW-EXP-DT.
  3676     MOVE AM-EFFECT-DT TO SW-EFF-DT.
  3677
  3678     IF PA-EP (4) NOT EQUAL ZEROS
  3679        COMPUTE LIFE-RETENT ROUNDED =
  3680            PA-PE (4) / PA-EP (4)
  3681     ELSE
  3682        MOVE +0.0      TO LIFE-RETENT.
  3683
  3684     IF PA-EP (5) NOT EQUAL ZEROS
  3685        COMPUTE AH-RETENT  ROUNDED =
  3686            PA-PE (5) / PA-EP (5)
  3687     ELSE
  3688        MOVE +0.0      TO AH-RETENT.
  3689
  3690     MOVE LIFE-RETENT  TO SW-LRET.
  3691     MOVE AH-RETENT    TO SW-ARET.
  3692     MOVE AM-RET-Y-N   TO SW-RET-Y-N.
  3693     MOVE AM-RET-P-E   TO SW-RET-TYP.
  3694     MOVE AM-RETRO-PREM-P-E TO SW-PREM-P-E.
  3695     MOVE AM-RETRO-CLMS-P-I TO SW-CLMS-P-I.
  3696     MOVE AM-RETRO-QUALIFY-LIMIT   TO SW-RETRO-LIMIT.
  3697     MOVE PRINT-ACCUMS-R (1) TO SW-ACCUMS.
  3698     MOVE AM-CARRIER   TO SW-CARR.
  3699     MOVE AM-GROUPING  TO SW-COMP.
  3700     MOVE AM-STATE     TO SW-STATE.
  3701     MOVE AM-ACCOUNT   TO SW-ACCT.
  3702     MOVE BEG-DATE     TO SW-BEG-DATE.
  3703
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  75
* DCC043.cbl
  3704 0310-EXIT.
  3705     EXIT.
  3706
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  76
* DCC043.cbl
  3708 0320-CONT-RETRO-A.
  3709     display ' made 0320 ' ep-account ' ' am-ret-y-n ' '
  3710        am-retro-pool
  3711     IF AM-RET-Y-N = 'Y' OR 'I' OR 'G' OR 'L' OR 'D'
  3712         display ' release 1 '
  3713         RELEASE SW-REC-OUT FROM SW-REC
  3714         WRITE WORK-FILE-REC FROM SW-REC
  3715         ADD +1 TO NO-OF-RECORDS-RELEASED.
  3716
  3717     IF AM-RETRO-POOL NOT = SPACES AND NOT = ZEROS
  3718         MOVE AM-RETRO-POOL TO SW-GA
  3719         MOVE 'B'           TO SW-RPT-TYPE-ID
  3720         IF DTE-CLIENT NOT = 'VSL'
  3721            display ' release 2 '
  3722             RELEASE SW-REC-OUT FROM SW-REC
  3723         WRITE WORK-FILE-REC FROM SW-REC
  3724             ADD +1 TO NO-OF-RECORDS-RELEASED
  3725         ELSE
  3726             IF AM-RET-Y-N = 'Y' OR 'I' OR 'G' OR 'L' OR 'D'
  3727                 RELEASE SW-REC-OUT FROM SW-REC
  3728         WRITE WORK-FILE-REC FROM SW-REC
  3729                 ADD +1 TO NO-OF-RECORDS-RELEASED.
  3730
  3731     IF DTE-CLIENT = 'TAO'
  3732         MOVE AM-USER-FIELDS TO Z-G
  3733         MOVE ZONE-GROUP     TO SW-GA
  3734         MOVE 'B'            TO SW-RPT-TYPE-ID
  3735         RELEASE SW-REC-OUT FROM SW-REC
  3736         WRITE WORK-FILE-REC FROM SW-REC
  3737         ADD +1             TO NO-OF-RECORDS-RELEASED.
  3738
  3739     MOVE ZEROS TO DA-ISC-ADDL (1) DA-CNC-ADDL (1) DA-UC-ADDL (1)
  3740                   DA-ISC-ADDL (2) DA-CNC-ADDL (2) DA-UC-ADDL (2)
  3741                   DA-ISC-ADDL (3) DA-CNC-ADDL (3) DA-UC-ADDL (3)
  3742                   DA-ISC-ADDL (4) DA-CNC-ADDL (4) DA-UC-ADDL (4).
  3743
  3744     PERFORM 0340-GA-EXT-LOOP THRU 0350-EXIT
  3745         VARYING CL FROM 1 BY 1 UNTIL CL GREATER EC-REC-MAX.
  3746
  3747     IF AM-GPCD = 98
  3748         MOVE AM-ACCOUNT  TO SW-GA
  3749         MOVE 'X'         TO SW-GA-FLAG
  3750         MOVE HIGH-VALUES TO SW-CARR SW-COMP SW-STATE
  3751         MOVE 'C'         TO SW-RPT-TYPE-ID
  3752         display ' release 3 '
  3753         RELEASE SW-REC-OUT FROM SW-REC
  3754         WRITE WORK-FILE-REC FROM SW-REC
  3755         ADD +1 TO NO-OF-RECORDS-RELEASED.
  3756
  3757     PERFORM 0550-ZERO-DA VARYING SA FROM 1 BY 1
  3758                          UNTIL SA GREATER 4.
  3759     PERFORM 0560-ZERO-PA VARYING SB FROM 1 BY 1
  3760                          UNTIL SB GREATER 6.
  3761     PERFORM 0570-ZERO-XDA VARYING CL FROM 1 BY 1
  3762                          UNTIL CL GREATER 10.
  3763
  3764 0330-EXIT.
  3765     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  77
* DCC043.cbl
  3766
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  78
* DCC043.cbl
  3768 0340-GA-EXT-LOOP.
  3769     display ' made it to 0340 '
  3770     IF XDA-GA-TYPE (CL) = 'O' OR 'P' OR 'G' OR 'B' or 'S'
  3771         NEXT SENTENCE
  3772      ELSE
  3773         GO TO 0350-EXIT.
  3774
  3775     MOVE XDA-GA-ISC (CL, 1) TO DA-GA-ISC (1).
  3776     MOVE XDA-GA-ISC (CL, 2) TO DA-GA-ISC (2).
  3777     MOVE XDA-GA-ISC (CL, 3) TO DA-GA-ISC (3).
  3778     MOVE XDA-GA-ISC (CL, 4) TO DA-GA-ISC (4).
  3779     MOVE XDA-GA-CNC (CL, 1) TO DA-GA-CNC (1).
  3780     MOVE XDA-GA-CNC (CL, 2) TO DA-GA-CNC (2).
  3781     MOVE XDA-GA-CNC (CL, 3) TO DA-GA-CNC (3).
  3782     MOVE XDA-GA-CNC (CL, 4) TO DA-GA-CNC (4).
  3783     MOVE XDA-GA-UC  (CL, 1) TO DA-GA-UC  (1).
  3784     MOVE XDA-GA-UC  (CL, 2) TO DA-GA-UC  (2).
  3785     MOVE XDA-GA-UC  (CL, 3) TO DA-GA-UC  (3).
  3786     MOVE XDA-GA-UC  (CL, 4) TO DA-GA-UC  (4).
  3787
  3788     MOVE 3 TO SB.
  3789     PERFORM 0560-ZERO-PA.
  3790     MOVE 6 TO SB.
  3791     PERFORM 0560-ZERO-PA.
  3792     PERFORM 0300-CALC-RETRO-A THRU 0310-EXIT.
  3793     MOVE XDA-GA-NO (CL)         TO SW-GA.
  3794     MOVE 'C'                    TO SW-RPT-TYPE-ID.
  3795     display ' release 4 '
  3796     RELEASE SW-REC-OUT FROM SW-REC.
  3797         WRITE WORK-FILE-REC FROM SW-REC
  3798     ADD +1 TO NO-OF-RECORDS-RELEASED.
  3799
  3800 0350-EXIT.
  3801     EXIT.
  3802
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  79
* DCC043.cbl
  3804 0360-BUILD-DUMMY-GA.
  3805
  3806     MOVE SPACES       TO SW-REC.
  3807     MOVE -9999999     TO SW-RETRO-LIMIT.
  3808     MOVE 'X'          TO SW-GA-FLAG.
  3809     MOVE 'C'          TO SW-RPT-TYPE-ID.
  3810     MOVE AM-NAME      TO SW-NAME.
  3811     MOVE AM-ADDRS     TO SW-ADDRS.
  3812     MOVE SPACES       TO SW-CITY.
  3813     STRING AM-ADDR-CITY ' ' AM-ADDR-STATE
  3814        DELIMITED BY '  ' INTO SW-CITY
  3815     END-STRING
  3816     MOVE AM-ZIP       TO SW-ZIP.
  3817     MOVE AM-EXPIRE-DT TO SW-EXP-DT.
  3818     MOVE AM-EFFECT-DT TO SW-EFF-DT.
  3819
  3820     IF AM-RET-Y-N = ' '   OR  'N'
  3821         MOVE +1.0 TO SW-LRET SW-ARET
  3822     ELSE
  3823         COMPUTE SW-LRET = 1 - AM-LF-RET
  3824         COMPUTE SW-ARET = 1 - AM-AH-RET.
  3825
  3826     MOVE AM-RET-P-E         TO SW-RET-TYP.
  3827     MOVE PRINT-ACCUMS-R (6) TO SW-ACCUMS.
  3828     MOVE HIGH-VALUES        TO SW-CARR SW-COMP SW-STATE.
  3829     MOVE AM-ACCOUNT         TO SW-ACCT SW-GA.
  3830         display ' release 5 '
  3831     RELEASE SW-REC-OUT FROM SW-REC.
  3832         WRITE WORK-FILE-REC FROM SW-REC
  3833     ADD +1 TO NO-OF-RECORDS-RELEASED.
  3834
  3835 0370-EXIT.
  3836     EXIT.
  3837
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  80
* DCC043.cbl
  3839 0380-COMPUTE-YTD.
  3840     display ' made 0380 ' sc
  3841     COMPUTE PA-NW (SC) = (DA-ISP (SB) - DA-CNP (SB)) -
  3842                          (DA-ISP (SA) - DA-CNP (SA)).
  3843
  3844     IF AM-RETRO-PREM-P-E = 'E'
  3845         MOVE DA-UP (SA) TO PA-BR (SC)
  3846         MOVE DA-UP (SB) TO PA-ER (SC).
  3847
  3848     COMPUTE PA-EP (SC) = PA-NW (SC) + PA-BR (SC) - PA-ER (SC).
  3849
  3850     COMPUTE PA-PE (SC) = DA-PCT-E-PREM (SB) - DA-PCT-E-PREM (SA).
  3851
  3852     COMPUTE PA-PL (SC) = DA-CLM (SB) - DA-CLM (SA).
  3853
  3854     IF AM-RETRO-CLMS-P-I = 'I'
  3855         MOVE DA-LRV (SA) TO PA-BLR (SC)
  3856         MOVE DA-LRV (SB) TO PA-ELR (SC).
  3857
  3858     IF DTE-CLIENT = 'ABL'
  3859         COMPUTE PA-BLR (SC) =   DA-LRV (SA) +
  3860         ((((DA-ISP (SB) - DA-ISP (SA)) -
  3861            (DA-CNP (SB) - DA-CNP (SA))) - DA-UP (SA)) * .25)
  3862         COMPUTE PA-ELR (SC) =   DA-LRV (SB) + (PA-EP (SC) * .25).
  3863
  3864     IF DTE-CLIENT = 'GIC'
  3865         IF SC = +1
  3866             COMPUTE PA-BLR (SC) =  PA-BR (SC) * .00
  3867             COMPUTE PA-ELR (SC) =  PA-ER (SC) * .00
  3868         ELSE
  3869             COMPUTE PA-BLR (SC) =  PA-BR (SC) * .12
  3870             COMPUTE PA-ELR (SC) =  PA-ER (SC) * .12.
  3871
  3872     IF AM-RET-MIN-LOSS-L NOT NUMERIC
  3873         MOVE +0 TO AM-RET-MIN-LOSS-L.
  3874
  3875     IF AM-RET-MIN-LOSS-A NOT NUMERIC
  3876         MOVE +0 TO AM-RET-MIN-LOSS-A.
  3877
  3878     IF SC = +1
  3879         COMPUTE WS-MIN-LOSS ROUNDED =
  3880            (PA-EP (SC) * AM-RET-MIN-LOSS-L) - PA-PL (SC)
  3881                                              + PA-BLR (SC)
  3882        ELSE
  3883         COMPUTE WS-MIN-LOSS ROUNDED =
  3884            (PA-EP (SC) * AM-RET-MIN-LOSS-A) - PA-PL (SC)
  3885                                              + PA-BLR (SC).
  3886     IF SC = +1
  3887         IF AM-RET-MIN-LOSS-L = ZERO
  3888            MOVE ZERO TO WS-MIN-LOSS.
  3889
  3890     IF SC = +2
  3891         IF AM-RET-MIN-LOSS-A = ZERO
  3892            MOVE ZERO TO WS-MIN-LOSS.
  3893
  3894     IF WS-MIN-LOSS GREATER PA-ELR (SC)
  3895         MOVE WS-MIN-LOSS TO PA-ELR (SC).
  3896
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  81
* DCC043.cbl
  3897     COMPUTE PA-TL (SC) = PA-PL (SC) - PA-BLR (SC) + PA-ELR (SC).
  3898
  3899     COMPUTE PA-RC (SC) = ((DA-ISC (SB) - DA-CNC (SB)) -
  3900                           (DA-ISC (SA) - DA-CNC (SA))) +
  3901                          ((DA-ISC-ADDL (SB) - DA-CNC-ADDL (SB)) -
  3902                           (DA-ISC-ADDL (SA) - DA-CNC-ADDL (SA))).
  3903
  3904     COMPUTE PA-EC (SC) = PA-RC (SC) + (DA-UC (SA) - DA-UC (SB))
  3905                         + (DA-UC-ADDL (SA) - DA-UC-ADDL (SB)).
  3906
  3907     IF AM-RET-P-E = 'P'
  3908         MOVE PA-RC (SC) TO PA-CU (SC)
  3909      ELSE
  3910         MOVE PA-EC (SC) TO PA-CU (SC).
  3911
  3912     COMPUTE PA-OC (SC) = DA-OTC (SB) - DA-OTC (SA).
  3913     COMPUTE PA-TC (SC) = pa-rc (sc) + PA-OC (SC) + pa-gacu (sc)
  3914
  3915     if am-account = '0005500614'
  3916        display ' found 5500614 *** '
  3917        display ' pa tc    ' pa-tc (sc)
  3918        display ' pa rc    ' pa-rc (sc)
  3919        display ' pa cu    ' pa-cu (sc)
  3920        display ' pa oc    ' pa-oc (sc)
  3921     end-if
  3922
  3923     COMPUTE PA-CP (SC) = DA-CPS (SB) - DA-CPS (SA).
  3924
  3925     IF DTE-CLIENT = 'FLA'
  3926         COMPUTE PA-EX (SC) = PA-NW (SC) * .11
  3927      ELSE
  3928         COMPUTE PA-EX (SC) = DA-EXP (SB) - DA-EXP (SA).
  3929
  3930     IF AM-RET-ST-TAX-USE = 'Y' OR 'P' OR 'E'
  3931         IF (AM-RET-P-E = 'P') OR (AM-RET-ST-TAX-USE = 'P')
  3932              IF SC = 1
  3933                 COMPUTE PA-EX (SC) =  PA-EX (SC) +
  3934*                          (PA-NW (SC) * AM-REI-LF-TAX)
  3935                    (DA-TAX (SB) - DA-TAX (SA))
  3936               ELSE
  3937                 COMPUTE PA-EX (SC) =  PA-EX (SC) +
  3938*                          (PA-NW (SC) * AM-REI-AH-TAX)
  3939                    (DA-TAX (SB) - DA-TAX (SA))
  3940          ELSE
  3941              IF PA-NW (SC) <> 0
  3942                 IF SC = 1
  3943                    COMPUTE PA-EX (SC) =  PA-EX (SC) +
  3944*                             (PA-EP (SC) * AM-REI-LF-TAX)
  3945                       (PA-EP (SC) / PA-NW (SC)) *
  3946                       (DA-TAX (SB) - DA-TAX (SA))
  3947                  ELSE
  3948                    COMPUTE PA-EX (SC) =  PA-EX (SC) +
  3949*                             (PA-EP (SC) * AM-REI-AH-TAX).
  3950                       (PA-EP (SC) / PA-NW (SC)) *
  3951                       (DA-TAX (SB) - DA-TAX (SA)).
  3952
  3953*    COMPUTE PA-TE (SC) = PA-TL (SC) + PA-TC (SC)
  3954*                         + PA-CP (SC) + PA-EX (SC).
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  82
* DCC043.cbl
  3955
  3956     COMPUTE PA-GACU (SC) = (DA-GA-ISC (SB) - DA-GA-CNC (SB))
  3957        - (DA-GA-ISC (Sa) - DA-GA-CNC (Sa))
  3958
  3959     COMPUTE PA-TC (SC) = pa-rc (sc) + PA-OC (SC) + pa-gacu (sc)
  3960     COMPUTE PA-TE (SC) = PA-TL (SC) + PA-TC (SC)
  3961                          + PA-CP (SC) + PA-EX (SC).
  3962     COMPUTE PA-GATC (SC) = PA-rC (SC) + PA-GACU (SC).
  3963
  3964     if am-account = '0005500614'
  3965        display ' found 5500614 YTD '
  3966        display ' pa tl       ' pa-tl (sc)
  3967        display ' pa tc       ' pa-tc (sc)
  3968        display ' pa cp       ' pa-cp (sc)
  3969        display ' pa ex       ' pa-ex (sc)
  3970        display ' pa pe       ' pa-pe (sc)
  3971        display ' pa isc cur  ' da-isc (sb)
  3972        display ' pa cnc cur  ' da-cnc (sb)
  3973        display ' pagaisccur  ' da-ga-isc (sb)
  3974        display ' pagacnccur  ' da-ga-cnc (sb)
  3975
  3976        display ' pa isc per  ' da-isc (sa)
  3977        display ' pa cnc per  ' da-cnc (sa)
  3978        display ' pagaiscper  ' da-ga-isc (sa)
  3979        display ' pagacncper  ' da-ga-cnc (sa)
  3980     end-if
  3981
  3982     compute pa-cso-admin (sc) =
  3983        da-cso-admin (sb) - da-cso-admin (sa)
  3984     compute pa-ccc-admin (sc) =
  3985        (pa-nw (sc) - pa-pe (sc)) -
  3986           (da-cso-admin (sb) - da-cso-admin (sc))
  3987     COMPUTE PA-BA (SC) = PA-PE (SC) - PA-TE (SC).
  3988     COMPUTE PA-NTE (SC) = PA-TL (SC) + PA-TC (SC) + PA-EX (SC).
  3989
  3990     if am-account = '0005500614'
  3991        display ' pa nte      ' pa-nte (sc)
  3992        display ' pa ba       ' pa-ba  (sc)
  3993        display ' pa pe       ' pa-pe  (sc)
  3994        display ' pa te       ' pa-te  (sc)
  3995     end-if
  3996
  3997     COMPUTE PA-NBA (SC) = PA-PE (SC) - PA-NTE (SC).
  3998     compute pa-tot-clp (sc) = pa-nw (sc) -
  3999        (((da-isc (sb) - da-cnc (sb)) +
  4000        (da-ga-isc (sb) - da-ga-cnc (sb)) +
  4001                 da-cso-admin (sb))
  4002                     -
  4003         ((da-isc (sa) - da-cnc (sa)) +
  4004         (da-ga-isc (sa) - da-ga-cnc (sa)) +
  4005                 da-cso-admin (sa)))
  4006
  4007     display ' pa tot clp  ' pa-tot-clp (sc) ' ' sc
  4008
  4009     COMPUTE PA-GARC (SC) = (DA-GA-ISC (SB) - DA-GA-CNC (SB)) -
  4010                   (DA-GA-ISC (SA) - DA-GA-CNC (SA)).
  4011     COMPUTE PA-GAEC (SC) = PA-GARC (SC) + DA-GA-UC (SA) -
  4012                                        DA-GA-UC (SB).
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  83
* DCC043.cbl
  4013     PERFORM 0520-ADD-PA-LEVELS.
  4014
  4015 0390-EXIT.
  4016     EXIT.
  4017
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  84
* DCC043.cbl
  4019 0400-COMPUTE-ITD.
  4020     display ' made 0400 '
  4021     COMPUTE PA-NW (SC) = DA-ISP (SB) - DA-CNP (SB).
  4022
  4023     IF AM-RETRO-PREM-P-E = 'E'
  4024         MOVE DA-UP (SB)       TO PA-ER (SC).
  4025
  4026     COMPUTE PA-EP (SC) = PA-NW (SC) - PA-ER (SC).
  4027
  4028     MOVE DA-PCT-E-PREM (SB)   TO PA-PE (SC).
  4029
  4030     MOVE DA-CLM (SB)          TO PA-PL (SC).
  4031
  4032     IF AM-RETRO-CLMS-P-I = 'I'
  4033         MOVE DA-LRV (SB)      TO PA-ELR (SC).
  4034
  4035     IF DTE-CLIENT = 'ABL'
  4036         COMPUTE PA-ELR (SC) = DA-LRV (SB) + (PA-EP (SC) * .25).
  4037
  4038     IF DTE-CLIENT = 'GIC'
  4039         IF SC = +4
  4040             COMPUTE PA-ELR (SC) =  PA-ER (SC) * .00
  4041         ELSE
  4042             COMPUTE PA-ELR (SC) =  PA-ER (SC) * .12.
  4043
  4044     IF AM-RET-MIN-LOSS-L NOT NUMERIC
  4045         MOVE +0 TO AM-RET-MIN-LOSS-L.
  4046
  4047     IF AM-RET-MIN-LOSS-A NOT NUMERIC
  4048         MOVE +0 TO AM-RET-MIN-LOSS-A.
  4049
  4050     IF SC = +4
  4051         COMPUTE WS-MIN-LOSS ROUNDED =
  4052            (PA-EP (SC) * AM-RET-MIN-LOSS-L) - PA-PL (SC)
  4053     ELSE
  4054         COMPUTE WS-MIN-LOSS ROUNDED =
  4055            (PA-EP (SC) * AM-RET-MIN-LOSS-A) - PA-PL (SC).
  4056
  4057     IF SC = +4
  4058         IF AM-RET-MIN-LOSS-L = ZERO
  4059            MOVE ZERO TO WS-MIN-LOSS.
  4060
  4061     IF SC = +5
  4062         IF AM-RET-MIN-LOSS-A = ZERO
  4063            MOVE ZERO TO WS-MIN-LOSS.
  4064
  4065     IF WS-MIN-LOSS GREATER PA-ELR (SC)
  4066         MOVE WS-MIN-LOSS TO PA-ELR (SC).
  4067
  4068     COMPUTE PA-TL (SC) = PA-PL (SC) + PA-ELR (SC).
  4069
  4070
  4071     COMPUTE PA-RC (SC) = (DA-ISC (SB) - DA-CNC (SB)) +
  4072                          (DA-ISC-ADDL (SB) - DA-CNC-ADDL (SB)).
  4073     COMPUTE PA-EC (SC) =
  4074                  PA-RC (SC) - DA-UC (SB) - DA-UC-ADDL (SB).
  4075
  4076     IF AM-RET-P-E = 'P'
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  85
* DCC043.cbl
  4077         MOVE PA-RC (SC) TO PA-CU (SC)
  4078     ELSE
  4079         MOVE PA-EC (SC) TO PA-CU (SC).
  4080
  4081     MOVE DA-OTC (SB) TO PA-OC (SC).
  4082*    COMPUTE PA-TC (SC) = PA-CU (SC) + PA-OC (SC).
  4083     MOVE DA-CPS (SB) TO PA-CP (SC).
  4084
  4085     IF DTE-CLIENT = 'FLA'
  4086        COMPUTE PA-EX (SC) = PA-NW (SC) * .11
  4087     ELSE
  4088        MOVE DA-EXP (SB) TO PA-EX (SC)
  4089     END-IF
  4090
  4091*    MOVE 'P' TO AM-RET-ST-TAX-USE
  4092*    MOVE 'P' TO AM-RET-P-E
  4093     IF AM-RET-ST-TAX-USE = 'Y' OR 'P' OR 'E'
  4094        IF (AM-RET-P-E = 'P') OR (AM-RET-ST-TAX-USE = 'P')
  4095           IF SC = 4
  4096              COMPUTE PA-EX (SC) =  PA-EX (SC) +
  4097*                (PA-NW (SC) * AM-REI-LF-TAX)
  4098                 DA-TAX (SB)
  4099           ELSE
  4100              COMPUTE PA-EX (SC) =  PA-EX (SC) +
  4101*                (PA-NW (SC) * AM-REI-AH-TAX)
  4102                 DA-TAX (SB)
  4103           END-IF
  4104        ELSE
  4105          IF PA-NW (SC) <> 0
  4106           IF SC = 4
  4107              COMPUTE PA-EX (SC) =  PA-EX (SC) +
  4108*                (PA-EP (SC) * AM-REI-LF-TAX)
  4109                 ((PA-EP (SC) / PA-NW (SC)) * DA-TAX (SB))
  4110           ELSE
  4111              COMPUTE PA-EX (SC) =  PA-EX (SC) +
  4112*                (PA-EP (SC) * AM-REI-AH-TAX).
  4113                 ((PA-EP (SC) / PA-NW (SC)) * DA-TAX (SB))
  4114           END-IF
  4115          END-IF
  4116        END-IF
  4117     END-IF
  4118
  4119*    COMPUTE PA-TE (SC) = PA-TL (SC) + PA-TC (SC)
  4120*                       + PA-CP (SC) + PA-EX (SC).
  4121     compute pa-cso-admin (sc) = da-cso-admin (sb)
  4122     compute pa-ccc-admin (sc) =
  4123        (pa-nw (sc) - pa-pe (sc)) - da-cso-admin (sb)
  4124
  4125     compute pa-tot-clp (sc) = pa-nw (sc) -
  4126        ((da-isc (sb) - da-cnc (sb)) +
  4127        (da-ga-isc (sb) - da-ga-cnc (sb))
  4128        + da-cso-admin (sb))
  4129
  4130*    COMPUTE PA-NTE (SC) = PA-TL (SC) + PA-TC (SC) + PA-EX (SC).
  4131     COMPUTE PA-GARC (SC) = DA-GA-ISC (SB) - DA-GA-CNC (SB).
  4132     COMPUTE PA-GACU (SC) = DA-GA-ISC (SB) - DA-GA-CNC (SB).
  4133     COMPUTE PA-GATC (SC) = PA-rC (SC) + PA-GACU (SC).
  4134     COMPUTE PA-GAEC (SC) = PA-GARC (SC) - DA-GA-UC (SB).
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  86
* DCC043.cbl
  4135     COMPUTE PA-TC (SC) = PA-CU (SC) + PA-OC (SC) + pa-gacu (sc).
  4136     COMPUTE PA-TE (SC) = PA-TL (SC) + PA-TC (SC)
  4137                        + PA-CP (SC) + PA-EX (SC).
  4138     COMPUTE PA-BA (SC) = PA-PE (SC) - PA-TE (SC).
  4139     COMPUTE PA-NTE (SC) = PA-TL (SC) + PA-TC (SC) + PA-EX (SC).
  4140     COMPUTE PA-NBA (SC) = PA-PE (SC) - PA-NTE (SC).
  4141     if da-ga-isc (sb) noT = zeros
  4142        display sw-rpt-type-id ' ' am-account ' calc itd '
  4143           da-ga-isc (sb) ' ' sb ' ' sc
  4144        display ' paba ' pa-ba    (sc)
  4145        display ' pape ' pa-pe    (sc)
  4146        display ' tc   ' pa-tc    (sc)
  4147        display ' tl   ' pa-tl    (sc)
  4148        display ' cp   ' pa-cp    (sc)
  4149        display ' ex   ' pa-ex    (sc)
  4150        display ' te   ' pa-te    (sc)
  4151        display ' garc ' PA-GARC  (sc)
  4152        display ' gaec ' PA-GAEC  (sc)
  4153        display ' gacu ' PA-GACU  (sc)
  4154        display ' cu   ' PA-CU    (sc)
  4155        display ' gatc ' PA-GATC  (sc)
  4156        display ' gagt ' PA-GAGT  (sc)
  4157        display ' gaba ' PA-GABA  (sc)
  4158        display ' gate ' PA-GATE  (sc)
  4159        display ' tclp ' pa-tot-clp (sc)
  4160        display ' cso  ' pa-cso-admin (sc)
  4161        display ' ccc  ' pa-ccc-admin (sc)
  4162     end-if
  4163
  4164     PERFORM 0520-ADD-PA-LEVELS.
  4165
  4166 0410-EXIT.
  4167     EXIT.
  4168
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  87
* DCC043.cbl
  4170 0420-CALCULATE-GA.
  4171
  4172     display ' made 0420 ' ws-save-ga ' ' sc
  4173     COMPUTE PA-PE (SC) ROUNDED = PA-EP (SC) * RETENT-FACT.
  4174
  4175     IF SAVE-RET-TYP = 'E'
  4176         MOVE PA-GAEC (SC) TO PA-GACU (SC)
  4177     ELSE
  4178         MOVE PA-GARC (SC) TO PA-GACU (SC).
  4179
  4180     display ' 0420 ' pa-garc (sc) ' ' pa-gacu (sc)
  4181     COMPUTE PA-GATC (SC) = PA-rC (SC) + PA-GACU (SC).
  4182     COMPUTE PA-GATE (SC) = PA-NTE (SC) + PA-GACU (SC).
  4183     COMPUTE PA-GABA (SC) = PA-PE (SC) - PA-GATE (SC).
  4184     COMPUTE PA-GAGT (SC) = PA-GABA (SC) - PA-CP (SC)
  4185                                      - PA-NBA (SC).
  4186     ADD PA-GACU (SC) TO PA-GACU (SF).
  4187     ADD PA-GATC (SC) TO PA-GATC (SF).
  4188     ADD PA-GATE (SC) TO PA-GATE (SF).
  4189     ADD PA-GABA (SC) TO PA-GABA (SF).
  4190     ADD PA-GAGT (SC) TO PA-GAGT (SF).
  4191
  4192 0430-EXIT.
  4193
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  88
* DCC043.cbl
  4195 0440-GENERATE-RETRO.
  4196     display ' made 0440 '
  4197     IF DTE-PGM-OPT = '1'
  4198         AND H1-REPORT-SUF NOT = 'A'
  4199     OR DTE-PGM-OPT = '2'
  4200         AND H1-REPORT-SUF NOT = 'B'
  4201     OR DTE-PGM-OPT = '3'
  4202         AND H1-REPORT-SUF NOT = 'C'
  4203             GO TO 0470-EXIT.
  4204
  4205     IF DTE-PGM-OPT = ('5' OR '6' OR '7') AND
  4206        H1-REPORT-SUF NOT = ('A' AND 'B')
  4207          GO TO 0470-EXIT.
  4208
  4209     PERFORM 0580-ZERO-PCNT VARYING SB FROM 1 BY 1
  4210                            UNTIL SB GREATER 2
  4211       AFTER SC FROM 1 BY 1 UNTIL SC GREATER 30.
  4212
  4213     MOVE +1 TO SE.
  4214     PERFORM 0480-COMPUTE-PERCENTS THRU 0490-EXIT.
  4215     MOVE +2 TO SE.
  4216     ADD +3 TO SF.
  4217
  4218     PERFORM 0480-COMPUTE-PERCENTS THRU 0490-EXIT.
  4219     PERFORM 0590-HEADING-ROUTINE  THRU 0600-EXIT.
  4220
  4221     if sh = +1
  4222        move '13. TOTAL CLP    ' to dt-entry (29)
  4223     else
  4224        move '14. TOTAL CLP    ' to dt-entry (29)
  4225     end-if
  4226
  4227     IF HEAD-SW = '1' OR '2'
  4228         IF SAVE-RET-TYP = 'E'
  4229             MOVE '  1. EARNED '         TO DT-ENTRY (13)
  4230         ELSE
  4231             MOVE '  1. RETAINED '       TO DT-ENTRY (13)
  4232     ELSE
  4233         MOVE '  1. ACCOUNT COMMISSION ' TO DT-ENTRY (13).
  4234
  4235     MOVE +1 TO SB.
  4236
  4237 0450-PRINT-LOOP.
  4238
  4239     display ' made 0450 ' sb ' ' sh ' ' dt-ss-r (sb sh)
  4240
  4241     IF DT-SS-R (SB SH) = SPACES
  4242         GO TO 0460-CHECK-NEXT-LINE.
  4243
  4244     IF DT-SS-R (SB SH) = '00'
  4245         MOVE DT-CTL-CHAR (SB) TO X
  4246         MOVE DT-ENTRY (SB)    TO DL-DESC
  4247         MOVE DETAIL-LINE      TO P-DATA
  4248         PERFORM 0610-PRT-RTN THRU 0630-EXIT
  4249         GO TO 0460-CHECK-NEXT-LINE.
  4250
  4251     MOVE DT-CTL-CHAR (SB) TO X.
  4252     MOVE DT-SS (SB SH)    TO SA.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  89
* DCC043.cbl
  4253
  4254     PERFORM 0500-PRINT-DETAIL THRU 0510-EXIT.
  4255
  4256 0460-CHECK-NEXT-LINE.
  4257     ADD +1 TO SB.
  4258     IF DT-CTL-CHAR (SB) NOT = HIGH-VALUES
  4259         GO TO 0450-PRINT-LOOP.
  4260
  4261     MOVE '-'    TO X.
  4262     MOVE SPACES TO P-DATA.
  4263     PERFORM 0610-PRT-RTN THRU 0630-EXIT.
  4264*    IF (DTE-FMT-OPT  =  2)        AND
  4265*       (BREAK-1-SWITCH NOT = ' ')   AND
  4266*       (H1-REPORT-SUF = 'A')
  4267*       NEXT SENTENCE
  4268*    ELSE
  4269*       ADD 1 TO PAGE-CNT.
  4270*    MOVE PAGE-CNT TO H9-PAGE.
  4271*    MOVE HEAD-9   TO P-DATA.
  4272*    PERFORM 0610-PRT-RTN THRU 0630-EXIT.
  4273
  4274 0470-EXIT.
  4275     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  90
* DCC043.cbl
  4277
  4278 0480-COMPUTE-PERCENTS.
  4279     IF PA-EP (SF) = ZERO
  4280         GO TO 0490-EXIT.
  4281
  4282     COMPUTE PT-PRCNT (SE 5) ROUNDED =
  4283         PA-PE (SF) / PA-EP (SF).
  4284     COMPUTE PT-PRCNT (SE 9) ROUNDED =
  4285         PA-TL (SF) / PA-EP (SF).
  4286     COMPUTE PT-PRCNT (SE 12) ROUNDED =
  4287         PA-TC (SF) / PA-EP (SF).
  4288
  4289     IF DTE-CLIENT = 'TAO'  AND  PA-NW (SF) NOT = ZERO
  4290         COMPUTE PT-PRCNT (SE 12) ROUNDED =
  4291             PA-TC (SF) / PA-NW (SF).
  4292
  4293     COMPUTE PT-PRCNT (SE 13) ROUNDED =
  4294         PA-CP (SF) / PA-EP (SF).
  4295     COMPUTE PT-PRCNT (SE 14) ROUNDED =
  4296         PA-EX (SF) / PA-EP (SF).
  4297     COMPUTE PT-PRCNT (SE 16) ROUNDED =
  4298         PA-BA (SF) / PA-EP (SF).
  4299     COMPUTE PT-PRCNT (SE 17) ROUNDED =
  4300         PA-NTE (SF) / PA-EP (SF).
  4301     COMPUTE PT-PRCNT (SE 18) ROUNDED =
  4302         PA-NBA (SF) / PA-EP (SF).
  4303     COMPUTE PT-PRCNT (SE 24) ROUNDED =
  4304         PA-GATC (SF) / PA-EP (SF).
  4305     COMPUTE PT-PRCNT (SE 25) ROUNDED =
  4306         PA-GAGT (SF) / PA-EP (SF).
  4307     COMPUTE PT-PRCNT (SE 26) ROUNDED =
  4308         PA-GABA (SF) / PA-EP (SF).
  4309     COMPUTE PT-PRCNT (SE 27) ROUNDED =
  4310         PA-GATE (SF) / PA-EP (SF).
  4311     COMPUTE PT-PRCNT (SE 28) ROUNDED =
  4312         PA-cso-admin (SF) / PA-EP (SF)
  4313     COMPUTE PT-PRCNT (SE 29) ROUNDED =
  4314         PA-ccc-admin (SF) / PA-EP (SF)
  4315     COMPUTE PT-PRCNT (SE 30) ROUNDED =
  4316         PA-TOT-CLP (SF) / PA-EP (SF)
  4317
  4318     COMPUTE PT-PRCNT (SE 5)  =  PT-PRCNT (SE 5)  * +100.
  4319     COMPUTE PT-PRCNT (SE 9)  =  PT-PRCNT (SE 9)  * +100.
  4320     COMPUTE PT-PRCNT (SE 12) =  PT-PRCNT (SE 12) * +100.
  4321     COMPUTE PT-PRCNT (SE 13) =  PT-PRCNT (SE 13) * +100.
  4322     COMPUTE PT-PRCNT (SE 14) =  PT-PRCNT (SE 14) * +100.
  4323     COMPUTE PT-PRCNT (SE 16) =  PT-PRCNT (SE 16) * +100.
  4324     COMPUTE PT-PRCNT (SE 17) =  PT-PRCNT (SE 17) * +100.
  4325     COMPUTE PT-PRCNT (SE 18) =  PT-PRCNT (SE 18) * +100.
  4326     COMPUTE PT-PRCNT (SE 24) =  PT-PRCNT (SE 24) * +100.
  4327     COMPUTE PT-PRCNT (SE 25) =  PT-PRCNT (SE 25) * +100.
  4328     COMPUTE PT-PRCNT (SE 26) =  PT-PRCNT (SE 26) * +100.
  4329     COMPUTE PT-PRCNT (SE 27) =  PT-PRCNT (SE 27) * +100.
  4330     COMPUTE PT-PRCNT (SE 28) =  PT-PRCNT (SE 28) * +100.
  4331     COMPUTE PT-PRCNT (SE 29) =  PT-PRCNT (SE 29) * +100.
  4332     COMPUTE PT-PRCNT (SE 30) =  PT-PRCNT (SE 30) * +100.
  4333
  4334 0490-EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  91
* DCC043.cbl
  4335     EXIT.
  4336
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  92
* DCC043.cbl
  4338 0500-PRINT-DETAIL.
  4339     display ' made 0500 ' sg ' ' sa
  4340*    if sa = 22
  4341        display ' pa amt4 ' sg ' ' pa-amt (sg 4 sa) ' '
  4342           dt-entry (sb)
  4343        display ' pa amt5 ' sg ' ' pa-amt (sg 5 sa)
  4344        display ' pa amt6 ' sg ' ' pa-amt (sg 6 sa)
  4345*    end-if
  4346     MOVE PA-AMT (SG 1 SA) TO DL-YLF.
  4347     MOVE PA-AMT (SG 2 SA) TO DL-YAH.
  4348     MOVE PA-AMT (SG 3 SA) TO DL-YT.
  4349     MOVE PT-PRCNT (1 SA)  TO DL-YPT.
  4350     MOVE DT-ENTRY (SB)    TO DL-DESC.
  4351     MOVE PA-AMT (SG 4 SA) TO DL-ILF.
  4352     MOVE PA-AMT (SG 5 SA) TO DL-IAH.
  4353     MOVE PA-AMT (SG 6 SA) TO DL-IT.
  4354     MOVE PT-PRCNT (2 SA)  TO DL-IPT.
  4355     MOVE DETAIL-LINE      TO P-DATA.
  4356     PERFORM 0610-PRT-RTN THRU 0630-EXIT.
  4357     MOVE SPACES           TO DETAIL-LINE  P-DATA.
  4358
  4359 0510-EXIT.
  4360     EXIT.
  4361
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  93
* DCC043.cbl
  4363 0520-ADD-PA-LEVELS.
  4364     ADD PA-NW   (SC) TO PA-NW   (SF).
  4365     ADD PA-BR   (SC) TO PA-BR   (SF).
  4366     ADD PA-ER   (SC) TO PA-ER   (SF).
  4367     ADD PA-EP   (SC) TO PA-EP   (SF).
  4368     ADD PA-PE   (SC) TO PA-PE   (SF).
  4369     ADD PA-PL   (SC) TO PA-PL   (SF).
  4370     ADD PA-BLR  (SC) TO PA-BLR  (SF).
  4371     ADD PA-ELR  (SC) TO PA-ELR  (SF).
  4372     ADD PA-TL   (SC) TO PA-TL   (SF).
  4373     ADD PA-RC   (SC) TO PA-RC   (SF).
  4374     ADD PA-OC   (SC) TO PA-OC   (SF).
  4375     ADD PA-TC   (SC) TO PA-TC   (SF).
  4376     ADD PA-CP   (SC) TO PA-CP   (SF).
  4377     ADD PA-EX   (SC) TO PA-EX   (SF).
  4378     ADD PA-TE   (SC) TO PA-TE   (SF).
  4379     ADD PA-BA   (SC) TO PA-BA   (SF).
  4380     ADD PA-NTE  (SC) TO PA-NTE  (SF).
  4381     ADD PA-NBA  (SC) TO PA-NBA  (SF).
  4382     ADD PA-EC   (SC) TO PA-EC   (SF).
  4383     ADD PA-GARC (SC) TO PA-GARC (SF).
  4384     ADD PA-GAEC (SC) TO PA-GAEC (SF).
  4385     ADD PA-GACU (SC) TO PA-GACU (SF).
  4386     ADD PA-CU   (SC) TO PA-CU   (SF).
  4387     ADD PA-GATC (SC) TO PA-GATC (SF).
  4388     ADD PA-GAGT (SC) TO PA-GAGT (SF).
  4389     ADD PA-GABA (SC) TO PA-GABA (SF).
  4390     ADD PA-GATE (SC) TO PA-GATE (SF)
  4391     ADD PA-TOT-CLP (SC) TO PA-TOT-CLP(SF)
  4392     add pa-cso-admin (sc) to pa-cso-admin (sf)
  4393     add pa-ccc-admin (sc) to pa-ccc-admin (sf)
  4394
  4395     .
  4396 0530-ADD-UP-LEVELS.
  4397     PERFORM 0520-ADD-PA-LEVELS.
  4398     ADD +1 TO SC
  4399               SF.
  4400
  4401 0540-EXIT.
  4402     EXIT.
  4403
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  94
* DCC043.cbl
  4405 0550-ZERO-DA.
  4406     MOVE +0 TO DA-ISP (SA)  DA-CNP (SA)  DA-UP (SA)   DA-UC (SA)
  4407                DA-TAX (SA)
  4408                DA-CLM (SA)  DA-EXP (SA)  DA-CPS (SA)  DA-OTC (SA)
  4409                DA-LRV (SA)  DA-CAJ (SA)  DA-ISC (SA)  DA-CNC (SA)
  4410                DA-ISC-ADDL (SA) DA-CNC-ADDL (SA) DA-UC-ADDL (SA)
  4411                DA-GA-ISC (SA)   DA-GA-CNC (SA)   DA-GA-UC (SA)
  4412                DA-PCT-E-PREM (SA)
  4413                da-cso-admin (sa) da-ccc-admin (sa)
  4414     .
  4415 0560-ZERO-PA.
  4416     MOVE +0 TO PA-NW (SB)  PA-BR (SB) PA-ER (SB)  PA-EP (SB)
  4417                PA-PE (SB)  PA-PL (SB) PA-BLR (SB) PA-ELR (SB)
  4418                PA-TL (SB)  PA-RC (SB) PA-OC (SB)  PA-TC (SB)
  4419                PA-CP (SB)  PA-EX (SB) PA-TE (SB)  PA-BA (SB)
  4420                PA-NTE (SB) PA-NBA (SB)   PA-EC (SB)
  4421                PA-GARC (SB)  PA-GAEC (SB)  PA-GACU (SB)
  4422                PA-GATC (SB)  PA-GAGT (SB)  PA-GABA (SB)
  4423                PA-GATE (SB)  PA-CU (SB)
  4424                PA-TOT-CLP (SB) pa-cso-admin (sb)
  4425                pa-ccc-admin (sb)
  4426     .
  4427 0570-ZERO-XDA.
  4428
  4429     PERFORM 0575-ZERO-XDA VARYING SA FROM 1 BY 1
  4430                           UNTIL SA GREATER THAN 4.
  4431
  4432 0575-ZERO-XDA.
  4433
  4434     MOVE SPACES                 TO  XDA-GA-NO (CL)
  4435                                     XDA-GA-TYPE (CL).
  4436     MOVE ZEROS                  TO  XDA-GA-ISC (CL SA)
  4437                                     XDA-GA-CNC (CL SA)
  4438                                     XDA-GA-UC  (CL SA).
  4439
  4440 0580-ZERO-PCNT.
  4441     MOVE +0 TO PT-PRCNT (SB SC).
  4442
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  95
* DCC043.cbl
  4444 0590-HEADING-ROUTINE.
  4445     IF DTE-PGM-OPT = '1'
  4446         AND H1-REPORT-SUF NOT = 'A'
  4447     OR DTE-PGM-OPT = '2'
  4448         AND H1-REPORT-SUF NOT = 'B'
  4449     OR DTE-PGM-OPT = '3'
  4450         AND H1-REPORT-SUF NOT = 'C'
  4451             GO TO 0600-EXIT.
  4452
  4453     IF DTE-PGM-OPT = ('5' OR '6' OR '7') AND
  4454        H1-REPORT-SUF NOT = ('A' AND 'B')
  4455        GO TO 0600-EXIT.
  4456
  4457     MOVE '1'    TO X.
  4458     MOVE HEAD-1 TO P-DATA.
  4459     PERFORM 0610-PRT-RTN THRU 0630-EXIT.
  4460     MOVE ' '    TO X.
  4461     MOVE HEAD-2 TO P-DATA.
  4462     PERFORM 0610-PRT-RTN THRU 0630-EXIT.
  4463     ADD +1               TO PAGE-CNT.
  4464     MOVE PAGE-CNT        TO H3-PAGE.
  4465     MOVE HEAD-3 TO P-DATA.
  4466     PERFORM 0610-PRT-RTN THRU 0630-EXIT.
  4467
  4468     IF HEAD-SW = '1' OR '2'
  4469         MOVE '0'    TO X
  4470         MOVE HEAD-4 TO P-DATA
  4471         PERFORM 0610-PRT-RTN THRU 0630-EXIT
  4472         MOVE ' '    TO X
  4473         MOVE HEAD-5 TO P-DATA
  4474         PERFORM 0610-PRT-RTN THRU 0630-EXIT.
  4475
  4476     MOVE '0' TO X.
  4477     IF DTE-PGM-OPT = '7'
  4478         IF HEAD-SW NOT = '1' AND '2'
  4479             MOVE '* CONTRACT TO DATE *' TO H6-YTD-HD
  4480         ELSE
  4481             MOVE BD-MO     TO H6R-MO
  4482             MOVE BD-DA     TO H6R-DA
  4483             MOVE BD-CCYY   TO H6R-CCYY
  4484             MOVE '-'       TO H6R-DASH1 H6R-DASH2
  4485             MOVE ' TO DATE '       TO H6R-MSG
  4486             MOVE ' '       TO H6R-FILLER.
  4487
  4488     MOVE HEAD-6 TO P-DATA.
  4489     PERFORM 0610-PRT-RTN THRU 0630-EXIT.
  4490     MOVE ' '    TO X.
  4491     MOVE HEAD-7 TO P-DATA.
  4492     PERFORM 0610-PRT-RTN THRU 0630-EXIT.
  4493     MOVE '0'    TO X.
  4494
  4495 0600-EXIT.
  4496     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  96
* DCC043.cbl
  4498
  4499 0610-PRT-RTN.
  4500****  THE FOLLOWING CLIENT CODING SUPPRESSES DATE BREAKS ON '43A'.
  4501
  4502     IF (DTE-FMT-OPT  =  2)        AND
  4503        (BREAK-1-SWITCH NOT = ' ')   AND
  4504        (H1-REPORT-SUF = 'A')
  4505             MOVE SPACES TO P-DATA  DETAIL-LINE
  4506             GO TO 0630-EXIT.
  4507
  4508 0620-PRT-REST.
  4509*                            COPY ELCPRT2.
* 4510                             COPY PRTN043.
  4511******************************************************************
  4512*                                                                *
  4513*  THIS IS A CSO VERSION OF COPYBOOK ELCPRTN TO ALLOW INDIVIDUAL *
  4514*  CHANGES FOR DELETING PAPER PRINT OF ECS043A.     (CSOMOD #759)*
  4515*  ALL REPORTS WILL STILL GO TO FICH.                            *
  4516*                                                                *
  4517******************************************************************
  4518*                                                                *
  4519*                            ELCPRTN                             *
  4520*                            VMOD=2.002                          *
  4521*                                                                *
  4522******************************************************************
  4523*                   C H A N G E   L O G
  4524*
  4525* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4526*-----------------------------------------------------------------
  4527*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4528* EFFECTIVE    NUMBER
  4529*-----------------------------------------------------------------
  4530* 061302    2002061200004  SMVA  REMOVE ECS043B HARDCOPY
  4531******************************************************************
  4532
  4533     IF DTE-FICH NOT = SPACE AND
  4534        FICH-OPEN    = SPACE
  4535         MOVE 'X' TO FICH-OPEN
  4536         OPEN OUTPUT FICH.
  4537
  4538     IF DTE-FICH NOT = SPACE
  4539         MOVE X TO P-CTL
  4540         WRITE FICH-REC FROM PRT.
  4541
  4542     IF H1-REPORT-SUF = 'A' OR 'B' OR 'C'
  4543         GO TO SKIP-A-REPORT.
  4544
  4545     IF DTE-FICH = SPACE OR '2'
  4546       MOVE X                    TO  P-CTL
  4547       IF P-CTL = ' '
  4548         WRITE PRT AFTER ADVANCING 1 LINE
  4549       ELSE
  4550         IF P-CTL = '0'
  4551           WRITE PRT AFTER ADVANCING 2 LINES
  4552         ELSE
  4553           IF P-CTL = '-'
  4554             WRITE PRT AFTER ADVANCING 3 LINES
  4555           ELSE
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  97
* DCC043.cbl (/apps/prod/cid1p/copy/PRTN043)
  4556             WRITE PRT AFTER ADVANCING PAGE.
  4557
  4558******************************************************************
  4559
  4560******************************************************************
  4561 SKIP-A-REPORT.
  4562     MOVE SPACES TO P-DATA  DETAIL-LINE.
  4563
  4564 0630-EXIT.
  4565     EXIT.
  4566
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  98
* DCC043.cbl
  4568 0640-EP-ADD.
  4569     display ' made 0640 ep add '
  4570
  4571     ADD EP-ISS-PRM TO DA-ISP (SA).
  4572     IF EP-PRM-TAX NUMERIC
  4573        ADD EP-PRM-TAX TO DA-TAX (SA).
  4574     ADD EP-CNC-PRM TO DA-CNP (SA).
  4575     ADD EP-CLM-AMT TO DA-CLM (SA).
  4576     ADD EP-CLM-DU TO DA-LRV (SA).
  4577
  4578     IF DTE-CLIENT NOT = 'ABL'
  4579         ADD EP-CLM-IBNR TO DA-LRV (SA).
  4580
  4581     ADD EP-LOSS-RESV TO DA-LRV (SA).
  4582     ADD EP-CLAIM-ADJ TO DA-CAJ (SA).
  4583
  4584     IF DTE-CLIENT = 'ABL'
  4585         ADD EP-CLAIM-ADJ TO DA-CLM (SA).
  4586
  4587*    PERFORM 0650-EP-EARN-TYPE THRU 0680-EXIT.
  4588
  4589     MOVE DA-UP (SA) TO SAVE-DA-UP.
  4590     MOVE 0                    TO SAVE-DA-PCT-UP.
  4591
  4592     IF WS-EP-CODE = 'R' OR 'N' OR 'U' OR 'A' OR 'T'
  4593         COMPUTE SAVE-DA-PCT-UP =
  4594                       ((EP-ISS-PRM - EP-CNC-PRM) - EP-PRM-78)
  4595         COMPUTE DA-UP (SA) = DA-UP (SA) +
  4596                       ((EP-ISS-PRM - EP-CNC-PRM) - EP-PRM-78).
  4597
  4598     IF WS-EP-CODE = 'P'
  4599         COMPUTE SAVE-DA-PCT-UP =
  4600                       ((EP-ISS-PRM - EP-CNC-PRM) - EP-PRM-PR)
  4601         COMPUTE DA-UP (SA) = DA-UP (SA) +
  4602                       ((EP-ISS-PRM - EP-CNC-PRM) - EP-PRM-PR).
  4603
  4604     IF (WS-EP-CODE = 'B' OR 'K' OR 'L')
  4605         COMPUTE SAVE-DA-PCT-UP =
  4606                       ((EP-ISS-PRM - EP-CNC-PRM) - EP-PRM-ST)
  4607         COMPUTE DA-UP (SA) = DA-UP (SA) +
  4608                       ((EP-ISS-PRM - EP-CNC-PRM) - EP-PRM-ST).
  4609
  4610     IF WS-EP-CODE = 'M'
  4611         COMPUTE SAVE-DA-PCT-UP =
  4612             ((EP-ISS-PRM - EP-CNC-PRM) -
  4613               ((EP-PRM-PR + EP-PRM-78) * .5))
  4614         COMPUTE DA-UP (SA) = DA-UP (SA) +
  4615             ((EP-ISS-PRM - EP-CNC-PRM) -
  4616               ((EP-PRM-PR + EP-PRM-78) * .5)).
  4617
  4618     IF WS-EP-CODE = '1'
  4619         COMPUTE SAVE-DA-PCT-UP =
  4620             ((EP-ISS-PRM - EP-CNC-PRM) -
  4621              ((EP-PRM-PR * +.6667) + (EP-PRM-78 * +.3333)))
  4622         COMPUTE DA-UP (SA) = DA-UP (SA) +
  4623             ((EP-ISS-PRM - EP-CNC-PRM) -
  4624              ((EP-PRM-PR * +.6667) + (EP-PRM-78 * +.3333))).
  4625
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  99
* DCC043.cbl
  4626     IF WS-EP-CODE = '2'
  4627         COMPUTE SAVE-DA-PCT-UP =
  4628             ((EP-ISS-PRM - EP-CNC-PRM) -
  4629              ((EP-PRM-PR * +.80) + (EP-PRM-78 * +.20)))
  4630         COMPUTE DA-UP (SA) = DA-UP (SA) +
  4631             ((EP-ISS-PRM - EP-CNC-PRM) -
  4632              ((EP-PRM-PR * +.80) + (EP-PRM-78 * +.20))).
  4633
  4634     IF AM-RETRO-PREM-P-E = 'E'
  4635         COMPUTE SAVE-DA-PCT-E-PREM  ROUNDED  =
  4636             (EP-ISS-PRM - EP-CNC-PRM - SAVE-DA-PCT-UP)
  4637                                                 * RETENT-FACT
  4638     ELSE
  4639         COMPUTE SAVE-DA-PCT-E-PREM  ROUNDED  =
  4640                       (EP-ISS-PRM - EP-CNC-PRM) * RETENT-FACT.
  4641
  4642     ADD SAVE-DA-PCT-E-PREM      TO DA-PCT-E-PREM (SA).
  4643
  4644 0640-EXIT.
  4645     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 100
* DCC043.cbl
  4647
  4648 0650-EP-EARN-TYPE.
  4649     MOVE CLAS-STARTS TO CLAS-INDEXS.
  4650
  4651 0652-ST-LOOK-UP.
  4652     IF AM-STATE = STATE-SUB (CLAS-INDEXS)
  4653         NEXT SENTENCE
  4654      ELSE
  4655          ADD +1 TO CLAS-INDEXS
  4656          IF CLAS-INDEXS NOT GREATER CLAS-MAXS
  4657              GO TO 0652-ST-LOOK-UP
  4658           ELSE
  4659             DISPLAY ' INVALID STATE CODE -' AM-STATE
  4660             MOVE    ' INVALID STATE CODE -' TO WS-ABEND-MESSAGE
  4661             MOVE 0402      TO WS-RETURN-CODE
  4662             GO TO ABEND-PGM.
  4663
  4664     IF EP-RCD-TYPE = AH-OVERRIDE-L1
  4665         MOVE CLAS-STARTA TO CLAS-INDEXA
  4666         GO TO 0670-EP-EARN-AH.
  4667
  4668     MOVE CLAS-STARTL TO CLAS-INDEXL.
  4669
  4670 0660-EP-EARN-TYPE-LOOP.
  4671     IF (CLAS-INDEXL GREATER CLAS-MAXL) OR (CLAS-INDEXL = ZERO)
  4672         DISPLAY ' INVALID LIFE BENEFIT TYPE -' EP-BEN-CODE
  4673         MOVE ' INVALID LIFE BENEFIT TYPE -' TO WS-ABEND-MESSAGE
  4674         MOVE 0401            TO WS-RETURN-CODE
  4675         GO TO ABEND-PGM.
  4676
  4677     IF EP-BEN-CODE NOT = CLAS-I-BEN (CLAS-INDEXL)
  4678         ADD +1 TO CLAS-INDEXL
  4679         GO TO 0660-EP-EARN-TYPE-LOOP.
  4680
  4681     MOVE CLAS-I-EP (CLAS-INDEXL) TO WS-EP-CODE.
  4682
  4683     IF STATE-ABBR (CLAS-INDEXS) = 'WY'
  4684          MOVE 'P' TO WS-EP-CODE.
  4685
  4686     IF DTE-CLIENT = 'ITG'
  4687          MOVE 'P' TO WS-EP-CODE.
  4688
  4689     IF CLAS-I-RL-AH (CLAS-INDEXL) = 'R'
  4690       AND (AM-RET-EARN-R NOT = SPACE AND ZERO)
  4691           MOVE AM-RET-EARN-R TO WS-EP-CODE.
  4692     IF (CLAS-I-RL-AH (CLAS-INDEXL) = 'L' OR 'P')
  4693       AND (AM-RET-EARN-L NOT = SPACE AND ZERO)
  4694           MOVE AM-RET-EARN-L TO WS-EP-CODE.
  4695
  4696     MOVE CLAS-I-BAL (CLAS-INDEXL) TO WS-OB-CODE.
  4697
  4698     IF CLAS-I-RL-AH (CLAS-INDEXL) = 'R'
  4699       AND (SA = 1 OR 2)
  4700       AND (AM-RET-BEG-EARN-R NOT = SPACE AND ZERO)
  4701           MOVE AM-RET-BEG-EARN-R TO WS-EP-CODE.
  4702
  4703     IF (CLAS-I-RL-AH (CLAS-INDEXL) = 'L' OR 'P')
  4704       AND (SA = 1 OR 2)
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 101
* DCC043.cbl
  4705       AND (AM-RET-BEG-EARN-L NOT = SPACE AND ZERO)
  4706           MOVE AM-RET-BEG-EARN-L TO WS-EP-CODE.
  4707
  4708     GO TO 0680-EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 102
* DCC043.cbl
  4710
  4711 0670-EP-EARN-AH.
  4712     IF (CLAS-INDEXA GREATER CLAS-MAXA) OR (CLAS-INDEXA = ZERO)
  4713         DISPLAY ' INVALID A&H BENEFIT TYPE -' EP-BEN-CODE
  4714         MOVE    ' INVALID A&H BENEFIT TYPE -' TO WS-ABEND-MESSAGE
  4715         MOVE 0402         TO WS-RETURN-CODE
  4716         GO TO ABEND-PGM.
  4717
  4718     IF EP-BEN-CODE NOT = CLAS-I-BEN (CLAS-INDEXA)
  4719         ADD +1 TO CLAS-INDEXA
  4720         GO TO 0670-EP-EARN-AH.
  4721
  4722     MOVE CLAS-I-EP (CLAS-INDEXA) TO WS-EP-CODE.
  4723
  4724     IF STATE-ABBR (CLAS-INDEXS) = 'WY'
  4725          MOVE 'P' TO WS-EP-CODE.
  4726
  4727     IF DTE-CLIENT = 'ITG'
  4728          MOVE 'P' TO WS-EP-CODE.
  4729
  4730     IF CLAS-I-RL-AH (CLAS-INDEXA) = 'A'
  4731       AND (AM-RET-EARN-A NOT = SPACE AND ZERO)
  4732           MOVE AM-RET-EARN-A TO WS-EP-CODE.
  4733
  4734     IF CLAS-I-RL-AH (CLAS-INDEXA) = 'A'
  4735       AND (SA = 1 OR 2)
  4736       AND (AM-RET-BEG-EARN-A NOT = SPACE AND ZERO)
  4737           MOVE AM-RET-BEG-EARN-A TO WS-EP-CODE.
  4738
  4739     IF DTE-CLIENT = 'ITY'
  4740         IF EP-CARRIER = '5' OR '7'
  4741              MOVE '1' TO WS-EP-CODE.
  4742
  4743     IF DTE-CLIENT = 'GIC'
  4744         IF CLAS-I-BAL (CLAS-INDEXA) NOT = 'B'
  4745              MOVE '2' TO WS-EP-CODE.
  4746
  4747     IF DTE-CLIENT = 'AN1' OR 'TFS' OR 'NIS' OR
  4748                     'UW1' OR 'DDB' OR 'GSL'
  4749         MOVE 'M'                  TO WS-EP-CODE.
  4750
  4751     MOVE CLAS-I-BAL (CLAS-INDEXA) TO WS-OB-CODE.
  4752
  4753 0680-EXIT.
  4754     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 103
* DCC043.cbl
  4756
  4757 0690-EC-ADD.
  4758     display ' made 0690 ec add '
  4759     PERFORM 0700-ACCT-EC-ADD  THRU 0710-EXIT
  4760         VARYING CL FROM 1 BY 1 UNTIL CL GREATER THAN +5.
  4761
  4762     GO TO 0729-EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 104
* DCC043.cbl
  4764
  4765 0700-ACCT-EC-ADD.
  4766******************************************************************
  4767*         CL - AGENT LEVEL WITHIN EC RECORD
  4768*         AL - AGENT LEVEL WITHIN GA TABLE
  4769*         SA - BEGINNING / CURRENT   LIFE/AH INDICATOR
  4770******************************************************************
  4771
  4772     IF EC-AGT-NO (CL) = ZEROS
  4773         GO TO 0710-EXIT.
  4774
  4775     IF EC-SEQ-NBR GREATER THAN 1
  4776         MOVE EC-SEQ-NBR         TO  WS-SEQ-NBR
  4777         SUBTRACT +1 FROM WS-SEQ-NBR
  4778         COMPUTE AL = WS-SEQ-NBR * 5.
  4779
  4780     PERFORM 0725-CHECK-AM-RETRO  THRU  0725-EXIT.
  4781
  4782     IF WS-RETRO-FLAG = 'N'
  4783        GO TO 0710-EXIT.
  4784
  4785     MOVE +1                     TO  AL.
  4786
  4787 0700-LOOP.
  4788
  4789     IF EC-AGT-NO (CL) = XDA-GA-NO (AL)
  4790         GO TO 0705-ACCUM.
  4791
  4792     IF XDA-GA-NO (AL) = SPACES
  4793         MOVE EC-AGT-NO (CL)     TO  XDA-GA-NO (AL)
  4794         MOVE EC-AGT-TYPE (CL)   TO  XDA-GA-TYPE (AL)
  4795         GO TO 0705-ACCUM.
  4796
  4797     ADD +1 TO AL.
  4798
  4799     IF AL GREATER THAN EC-REC-MAX
  4800         MOVE 'NO OF EC RECORDS EXCEED TABLE LIMIT'
  4801                                 TO  WS-ABEND-MESSAGE
  4802         GO TO ABEND-PGM.
  4803
  4804     GO TO 0700-LOOP.
  4805
  4806 0705-ACCUM.
  4807
  4808     IF EC-AGT-TYPE (CL) = 'C' OR 'D'
  4809         ADD EC-ISS-COMM (CL) TO DA-ISC (SA)
  4810         ADD EC-CNC-COMM (CL) TO DA-CNC (SA).
  4811
  4812     IF EC-AGT-TYPE (CL) = 'O' OR 'P' or 'S'
  4813        ADD EC-ISS-COMM (CL) TO XDA-GA-ISC (AL SA)
  4814        ADD EC-CNC-COMM (CL) TO XDA-GA-CNC (AL SA)
  4815        IF WS-RETRO-FLAG = 'A'
  4816           if ec-agt-type (cl) not = 'S'
  4817              ADD EC-ISS-COMM (CL) TO DA-ga-ISC (SA)
  4818              ADD EC-CNC-COMM (CL) TO DA-ga-cnc (SA)
  4819           else
  4820              compute da-cso-admin (sa) = da-cso-admin (sa) +
  4821                 (ec-iss-comm (cl) - ec-cnc-comm (cl))
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 105
* DCC043.cbl
  4822           end-if
  4823           display ' accum ga ' ep-account ' ' da-ga-isc (sa)
  4824              ' ' sa
  4825        end-if
  4826     end-if
  4827
  4828
  4829
  4830
  4831
  4832*     IF EC-AGT-TYPE (CL) = 'O' OR 'P'
  4833*         ADD EC-ISS-COMM (CL) TO XDA-GA-ISC (AL SA)
  4834*         ADD EC-CNC-COMM (CL) TO XDA-GA-CNC (AL SA)
  4835**02281        IF AM-RETRO-LV-INDIC (AL) = 'A'
  4836*       IF WS-RETRO-FLAG = 'A'
  4837**          ADD EC-ISS-COMM (CL) TO DA-ISC-ADDL (SA)
  4838**          ADD EC-CNC-COMM (CL) TO DA-CNC-ADDL (SA).
  4839*           ADD EC-ISS-COMM (CL) TO DA-ga-ISC (SA)
  4840*           ADD EC-CNC-COMM (CL) TO DA-ga-cnc (SA)
  4841*           display ' accum ga ' ep-account ' ' da-ga-isc (sa)
  4842*              ' ' sa
  4843*        end-if
  4844*     end-if
  4845
  4846
  4847
  4848
  4849
  4850
  4851
  4852
  4853
  4854*    MOVE DA-UC (SA) TO SAVE-DA-UC.
  4855*    MOVE XDA-GA-UC (SA AL) TO SAVE-DA-GA-UC.
  4856
  4857     IF WS-EP-CODE = 'R' OR 'N' OR 'U' OR 'A' OR 'T'
  4858        IF EC-AGT-TYPE (CL) = 'C' OR 'D'
  4859         COMPUTE DA-UC (SA) = DA-UC (SA) +
  4860             ((EC-ISS-COMM (CL) - EC-CNC-COMM (CL)) -
  4861              EC-COMM-78 (CL))
  4862        ELSE
  4863         IF EC-AGT-TYPE (CL) = 'O' OR 'P' or 'S'
  4864          COMPUTE XDA-GA-UC (AL SA) = XDA-GA-UC (AL SA) +
  4865             ((EC-ISS-COMM (CL) - EC-CNC-COMM (CL)) -
  4866              EC-COMM-78 (CL))
  4867*02298             IF AM-RETRO-LV-INDIC (AL) = 'A'
  4868            IF WS-RETRO-FLAG = 'A'
  4869               compute da-ga-uc (sa) = da-ga-uc (sa) +
  4870*              COMPUTE DA-UC-ADDL (SA) = DA-UC-ADDL (SA) +
  4871                  ((EC-ISS-COMM (CL) - EC-CNC-COMM (CL)) -
  4872                    EC-COMM-78 (CL)).
  4873
  4874     IF WS-EP-CODE = 'P'
  4875       IF EC-AGT-TYPE (CL) = 'C' OR 'D'
  4876         COMPUTE DA-UC (SA) = DA-UC (SA) +
  4877             ((EC-ISS-COMM (CL) - EC-CNC-COMM (CL)) -
  4878              EC-COMM-PR (CL))
  4879       ELSE
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 106
* DCC043.cbl
  4880        IF EC-AGT-TYPE (CL) = 'O' OR 'P' or 'S'
  4881         COMPUTE XDA-GA-UC (AL SA) = XDA-GA-UC (AL SA) +
  4882             ((EC-ISS-COMM (CL) - EC-CNC-COMM (CL)) -
  4883              EC-COMM-PR (CL))
  4884*02313             IF AM-RETRO-LV-INDIC (AL) = 'A'
  4885            IF WS-RETRO-FLAG = 'A'
  4886               compute da-ga-uc (sa) = da-ga-uc (sa) +
  4887*              COMPUTE DA-UC-ADDL (SA) = DA-UC-ADDL (SA) +
  4888                ((EC-ISS-COMM (CL) - EC-CNC-COMM (CL)) -
  4889                  EC-COMM-PR (CL)).
  4890
  4891     IF (WS-EP-CODE = 'B' OR 'K' OR 'L')
  4892       IF EC-AGT-TYPE (CL) = 'C' OR 'D'
  4893         COMPUTE DA-UC (SA) = DA-UC (SA) +
  4894             ((EC-ISS-COMM (CL) - EC-CNC-COMM (CL)) -
  4895              EC-COMM-ST (CL))
  4896       ELSE
  4897        IF EC-AGT-TYPE (CL) = 'O' OR 'P' or 'S'
  4898         COMPUTE XDA-GA-UC (AL SA) = XDA-GA-UC (AL SA) +
  4899             ((EC-ISS-COMM (CL) - EC-CNC-COMM (CL)) -
  4900              EC-COMM-ST (CL))
  4901*02328             IF AM-RETRO-LV-INDIC (AL) = 'A'
  4902            IF WS-RETRO-FLAG = 'A'
  4903               compute da-ga-uc (sa) = da-ga-uc (sa) +
  4904*              COMPUTE DA-UC-ADDL (SA) = DA-UC-ADDL (SA) +
  4905                ((EC-ISS-COMM (CL) - EC-CNC-COMM (CL)) -
  4906                  EC-COMM-ST (CL)).
  4907
  4908     IF WS-EP-CODE = 'M'
  4909         IF EC-AGT-TYPE (CL) = 'C' OR 'D'
  4910                 COMPUTE DA-UC (SA) = DA-UC (SA) +
  4911                    ((EC-ISS-COMM (CL) - EC-CNC-COMM (CL)) -
  4912                      ((EC-COMM-PR (CL) + EC-COMM-78 (CL)) * .5))
  4913          ELSE
  4914           IF EC-AGT-TYPE (CL) = 'O' OR 'P' or 'S'
  4915                 COMPUTE XDA-GA-UC (AL SA) = XDA-GA-UC (AL SA) +
  4916                    ((EC-ISS-COMM (CL) - EC-CNC-COMM (CL)) -
  4917                      ((EC-COMM-PR (CL) + EC-COMM-78 (CL)) * .5))
  4918*02343                IF AM-RETRO-LV-INDIC (AL) = 'A'
  4919            IF WS-RETRO-FLAG = 'A'
  4920               compute da-ga-uc (sa) = da-ga-uc (sa) +
  4921*                  COMPUTE DA-UC-ADDL (SA) = DA-UC-ADDL (SA) +
  4922                    ((EC-ISS-COMM (CL) - EC-CNC-COMM (CL)) -
  4923                      ((EC-COMM-PR (CL) + EC-COMM-78 (CL)) * .5)).
  4924
  4925     IF WS-EP-CODE = '1'
  4926         IF EC-AGT-TYPE (CL) = 'C' OR 'D'
  4927                 COMPUTE DA-UC (SA) = DA-UC (SA) +
  4928                      ((EC-ISS-COMM (CL) - EC-CNC-COMM (CL)) -
  4929                      ((EC-COMM-PR (CL) * +.6667) +
  4930                       (EC-COMM-78 (CL) * +.3333)))
  4931         ELSE
  4932             IF EC-AGT-TYPE (CL) = 'O' OR 'P' or 'S'
  4933                 COMPUTE XDA-GA-UC (AL SA) = XDA-GA-UC (AL SA) +
  4934                      ((EC-ISS-COMM (CL) - EC-CNC-COMM (CL)) -
  4935                      ((EC-COMM-PR (CL) * +.6667) +
  4936                       (EC-COMM-78 (CL) * +.3333)))
  4937*02360                  IF AM-RETRO-LV-INDIC (AL) = 'A'
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 107
* DCC043.cbl
  4938                 IF WS-RETRO-FLAG = 'A'
  4939               compute da-ga-uc (sa) = da-ga-uc (sa) +
  4940*                    COMPUTE DA-UC-ADDL (SA) = DA-UC-ADDL (SA) +
  4941                      ((EC-ISS-COMM (CL) - EC-CNC-COMM (CL)) -
  4942                      ((EC-COMM-PR (CL) * +.6667) +
  4943                       (EC-COMM-78 (CL) * +.3333))).
  4944
  4945     IF WS-EP-CODE = '2'
  4946         IF EC-AGT-TYPE (CL) = 'C' OR 'D'
  4947                 COMPUTE DA-UC (SA) = DA-UC (SA) +
  4948                      ((EC-ISS-COMM (CL) - EC-CNC-COMM (CL)) -
  4949                      ((EC-COMM-PR (CL) * +.80) +
  4950                       (EC-COMM-78 (CL) * +.20)))
  4951         ELSE
  4952             IF EC-AGT-TYPE (CL) = 'O' OR 'P' or 'S'
  4953                 COMPUTE XDA-GA-UC (AL SA) = XDA-GA-UC (AL SA) +
  4954                      ((EC-ISS-COMM (CL) - EC-CNC-COMM (CL)) -
  4955                      ((EC-COMM-PR (CL) * +.80) +
  4956                       (EC-COMM-78 (CL) * +.20)))
  4957*02378                  IF AM-RETRO-LV-INDIC (AL) = 'A'
  4958                 IF WS-RETRO-FLAG = 'A'
  4959               compute da-ga-uc (sa) = da-ga-uc (sa) +
  4960*                    COMPUTE DA-UC-ADDL (SA) = DA-UC-ADDL (SA) +
  4961                      ((EC-ISS-COMM (CL) - EC-CNC-COMM (CL)) -
  4962                      ((EC-COMM-PR (CL) * +.80) +
  4963                       (EC-COMM-78 (CL) * +.20))).
  4964
  4965 0710-EXIT.
  4966     EXIT.
  4967
  4968 0725-CHECK-AM-RETRO.
  4969
  4970     MOVE SPACE                  TO  WS-RETRO-FLAG.
  4971
  4972     PERFORM 0725-CHECK-LOOP VARYING AN FROM 1 BY 1
  4973                             UNTIL AN GREATER THAN 10.
  4974 0725-CHECK-LOOP.
  4975
  4976     IF EC-AGT-NO (CL) = AM-AGT (AN)
  4977         MOVE AM-RETRO-LV-INDIC (AN)
  4978                                 TO  WS-RETRO-FLAG
  4979         MOVE +11                TO  AN.
  4980
  4981 0725-EXIT.
  4982     EXIT.
  4983
  4984 0729-EXIT.
  4985     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 108
* DCC043.cbl
  4987
  4988 0730-RETURN-SORTED-FILE.
  4989
  4990      display ' made 0730 return '
  4991
  4992     IF SW-CTL NOT = HIGH-VALUES
  4993         RETURN SORT-WORK  INTO  SW-REC
  4994                    AT END MOVE HIGH-VALUES TO SW-RPT-TYPE-ID
  4995                                               SW-CTL.
  4996     if sw-ctl not = high-values
  4997        display ' return sw-rec ' sw-rec (1:30)
  4998     end-if
  4999
  5000     .
  5001 0730-EXIT.
  5002     EXIT.
  5003
  5004 0740-MOVE-SW-REC.
  5005
  5006     display ' made 0740 move sw '
  5007     IF SW-RPT-TYPE-ID = 'C'
  5008         IF DTE-CLIENT = 'LBL'
  5009             MOVE 'E'            TO SW-RET-TYP.
  5010
  5011     MOVE SW-NAME                TO H1-NAME.
  5012     MOVE SW-ADDRS               TO H2-ADDR.
  5013     MOVE SW-CITY                TO H3-ADDR.
  5014
  5015     IF  SW-CANADIAN-POST-CODE
  5016         MOVE SW-CAN-POST-CODE-1 TO H3-CAN-POSTAL-CODE-1
  5017         MOVE SW-CAN-POST-CODE-2 TO H3-CAN-POSTAL-CODE-2
  5018         MOVE SPACES             TO H3-DASH-CAN
  5019                                    H3-CAN-FILLER
  5020
  5021     ELSE
  5022         MOVE SW-ZIP-PRIME       TO H3-ZIP-PRIME
  5023
  5024         IF  SW-ZIP-PLUS4 = SPACES OR ZEROS
  5025             MOVE SPACES         TO H3-ZIP-PLUS4 H3-DASH
  5026
  5027         ELSE
  5028             MOVE SW-ZIP-PLUS4   TO H3-ZIP-PLUS4
  5029             MOVE '-'            TO H3-DASH.
  5030
  5031     MOVE SW-CARR                TO H5-CARR.
  5032     MOVE SW-COMP                TO H5-COMP.
  5033     MOVE SW-STATE               TO H5-ST.
  5034     MOVE SW-ACCT                TO H5-ACCT.
  5035     MOVE '-'                    TO H5-FS1 H5-FS2 H5-TS1 H5-TS2.
  5036     MOVE SW-EFF-DT              TO WORK-DATE.
  5037     MOVE WK-MO                  TO H5-FMO.
  5038     MOVE WK-DA                  TO H5-FDA.
  5039     MOVE WK-YR                  TO H5-FYR.
  5040     MOVE SW-EXP-DT              TO WORK-DATE.
  5041     MOVE WK-MO                  TO H5-TMO.
  5042     MOVE WK-DA                  TO H5-TDA.
  5043     MOVE WK-YR                  TO H5-TYR.
  5044     MOVE SW-ACCUMS              TO PRINT-ACCUMS-R (1).
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 109
* DCC043.cbl
  5045     MOVE SW-CTL                 TO WS-SAVE-CTL.
  5046     MOVE SW-GA-FLAG             TO SAVE-GA-FLAG.
  5047     MOVE SW-RET-Y-N             TO SAVE-RET-Y-N.
  5048     MOVE SW-RET-TYP             TO SAVE-RET-TYP.
  5049     MOVE SW-LRET                TO LIFE-RETENT.
  5050     MOVE SW-ARET                TO AH-RETENT.
  5051     MOVE SW-RETRO-LIMIT         TO SAVE-RETRO-LIMIT.
  5052     MOVE SW-PREM-P-E            TO SAVE-PREM-P-E.
  5053     MOVE SW-CLMS-P-I            TO SAVE-CLMS-P-I.
  5054     MOVE SW-BEG-DATE            TO BEG-DATE.
  5055
  5056     IF SW-RPT-TYPE-ID = 'B'
  5057         MOVE 'GROUP'            TO H4-GROUP
  5058         MOVE SW-GA              TO H5-GROUP.
  5059
  5060     MOVE SW-GA                  TO ZONE-GROUP.
  5061
  5062     IF SW-RPT-TYPE-ID = 'B' AND ZON = 'ZON'
  5063         MOVE '  ZONE'           TO H4-GROUP
  5064         INSPECT H5-GROUP CONVERTING 'ZON' TO '   '.
  5065
  5066     IF SW-RPT-TYPE-ID = 'C'
  5067         if sw-ga = low-values
  5068            move spaces to sw-ga
  5069         end-if
  5070         MOVE ' G.A.'            TO H4-GROUP
  5071         MOVE SW-GA              TO H5-GROUP.
  5072
  5073*    PERFORM 0730-RETURN-SORTED-FILE THRU 0730-EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 110
* DCC043.cbl
  5075 0745-OUTPUT-PROCEDURE SECTION.
  5076     IF NO-OF-RECORDS-RELEASED = +0
  5077        GO TO 1080-E-O-J.
  5078
  5079     display ' begin output procedure '
  5080     .
  5081 0750-PRINT-REPORT SECTION.
  5082
  5083     display ' made 0750 '
  5084     PERFORM 0730-RETURN-SORTED-FILE THRU 0730-EXIT.
  5085
  5086     move sw-rpt-type-id         to ws-prev-rpt-type
  5087     IF SW-RPT-TYPE-ID = 'B'
  5088         GO TO 0900-PRINT-GROUP-TOTALS.
  5089
  5090     IF SW-RPT-TYPE-ID = 'C'
  5091         GO TO 0990-PRINT-GA-TOTALS.
  5092
  5093     MOVE 'A'    TO H1-REPORT-SUF
  5094                    ws-prev-rpt-type
  5095     PERFORM 0740-MOVE-SW-REC.
  5096     PERFORM 0730-RETURN-SORTED-FILE THRU 0730-EXIT.
  5097
  5098     MOVE SPACES TO H5-MESSAGE.
  5099
  5100     .
  5101 0760-CHECK-BREAK.
  5102     display ' made 0760 '
  5103
  5104     if sw-rpt-type-id not = ws-prev-rpt-type
  5105        move 'X' to break-1-switch
  5106        move sw-rpt-type-id to ws-prev-rpt-type
  5107        go to 0770-for-one-a-record
  5108     end-if
  5109
  5110     IF SW-CARR NOT = WS-SAVE-CAR
  5111         GO TO 0860-BREAK-5.
  5112     IF SW-COMP NOT = WS-SAVE-CMP
  5113         GO TO 0840-BREAK-4.
  5114     IF SW-STATE NOT = WS-SAVE-ST
  5115         GO TO 0820-BREAK-3.
  5116     IF SW-ACCT NOT = WS-SAVE-ACC
  5117         GO TO 0800-BREAK-2.
  5118
  5119     GO TO 0780-BREAK-1.
  5120
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 111
* DCC043.cbl
  5122 0770-BREAK-RETURN.
  5123     display ' made 0770 break return '
  5124     PERFORM 0740-MOVE-SW-REC.
  5125     PERFORM 0730-RETURN-SORTED-FILE THRU 0730-EXIT.
  5126
  5127 0770-for-one-a-record.
  5128
  5129     IF SW-CTL = HIGH-VALUES
  5130         PERFORM 0880-BREAK-6
  5131         GO TO 1080-E-O-J
  5132     ELSE
  5133         IF SW-RPT-TYPE-ID = 'B'
  5134             PERFORM 0880-BREAK-6
  5135             GO TO 0900-PRINT-GROUP-TOTALS
  5136         ELSE
  5137             IF SW-RPT-TYPE-ID = 'C'
  5138                 PERFORM 0880-BREAK-6
  5139                 GO TO 0990-PRINT-GA-TOTALS
  5140             ELSE
  5141                 GO TO 0760-CHECK-BREAK.
  5142
  5143 0780-BREAK-1.
  5144     display ' made 0780 break 1 '
  5145     MOVE 'X'            TO BREAK-1-SWITCH.
  5146     MOVE '1'            TO HEAD-SW.
  5147     MOVE 'FROM      TO' TO H4-FT.
  5148     MOVE +1             TO SG.
  5149     MOVE +3             TO SF.
  5150     MOVE +1             TO SH.
  5151
  5152     IF DTE-CLIENT NOT = 'ITG'
  5153         PERFORM 0440-GENERATE-RETRO THRU 0470-EXIT.
  5154
  5155     MOVE +1 TO SC.
  5156     MOVE +7 TO SF.
  5157     PERFORM 0530-ADD-UP-LEVELS 6 TIMES.
  5158** Zero the date range totals
  5159     PERFORM 0560-ZERO-PA VARYING SB FROM 1 BY 1
  5160                          UNTIL SB GREATER 6.
  5161
  5162 0790-BREAK-1-EXIT.
  5163     GO TO 0770-BREAK-RETURN.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 112
* DCC043.cbl
  5165
  5166 0800-BREAK-2.
  5167     display ' made 0800 break 2'
  5168     IF BREAK-1-SWITCH NOT = ' '
  5169         PERFORM 0780-BREAK-1
  5170     ELSE
  5171         MOVE +1 TO SC
  5172         MOVE +7 TO SF
  5173         PERFORM 0530-ADD-UP-LEVELS 6 TIMES
  5174** Zero the date range totals
  5175         PERFORM 0560-ZERO-PA VARYING SB FROM 1 BY 1
  5176                              UNTIL SB GREATER 6.
  5177
  5178     MOVE SPACES TO BREAK-1-SWITCH.
  5179     MOVE '2'    TO HEAD-SW.
  5180
  5181     MOVE SPACES TO H4-FT  H5-FMO  H5-FS1  H5-FDA  H5-FS2  H5-FYR
  5182                    H5-TMO  H5-TS1  H5-TDA  H5-TS2  H5-TYR.
  5183
  5184     IF FC-CODE = ' '  OR  '5'
  5185         MOVE PA-NW (9)             TO ANNUALIZED-PREM.
  5186     IF FC-CODE = '1'
  5187         COMPUTE ANNUALIZED-PREM = (PA-NW (9) / RD-MO) * 12.
  5188     IF FC-CODE = '2'
  5189         IF RD-MO = 01 OR 04 OR 07 OR 10
  5190             COMPUTE ANNUALIZED-PREM =  PA-NW (9) * 12
  5191         ELSE
  5192             IF RD-MO = 02 OR 05 OR 08 OR 11
  5193                 COMPUTE ANNUALIZED-PREM =  PA-NW (9) * 6
  5194             ELSE
  5195                 COMPUTE ANNUALIZED-PREM =  PA-NW (9) * 4.
  5196     IF FC-CODE = '3'
  5197         COMPUTE ANNUALIZED-PREM =  PA-NW (9) * 4.
  5198     IF FC-CODE = '4'
  5199         COMPUTE ANNUALIZED-PREM =  PA-NW (9) * 2.
  5200     IF FC-CODE = '6'
  5201         COMPUTE ANNUALIZED-PREM =  PA-NW (9) * 12.
  5202
  5203     IF ANNUALIZED-PREM GREATER THAN SAVE-RETRO-LIMIT
  5204         MOVE +2   TO SG
  5205         MOVE +9   TO SF
  5206         MOVE +1   TO SH
  5207         PERFORM 0440-GENERATE-RETRO THRU 0470-EXIT
  5208         MOVE +7   TO SC
  5209         MOVE +13  TO SF
  5210         PERFORM 0530-ADD-UP-LEVELS 6 TIMES.
  5211
  5212** Zero the account    totals
  5213     PERFORM 0560-ZERO-PA VARYING SB FROM 7 BY 1
  5214                          UNTIL SB GREATER 12.
  5215
  5216 0810-BREAK-2-EXIT.
  5217     GO TO 0770-BREAK-RETURN.
  5218
  5219 0820-BREAK-3.
  5220     display ' made 0820 break 3 '
  5221     PERFORM 0800-BREAK-2.
  5222     MOVE '3'           TO HEAD-SW.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 113
* DCC043.cbl
  5223     MOVE WS-SAVE-ST    TO H8-ST.
  5224     MOVE HEAD-8-STATE  TO H2-ADDR.
  5225     MOVE SPACES        TO H1-NAME  H3-ADDR  H3-ZIP.
  5226     MOVE +3            TO SG.
  5227     MOVE +15           TO SF.
  5228     PERFORM 0440-GENERATE-RETRO THRU 0470-EXIT.
  5229     MOVE +13           TO SC.
  5230     MOVE +19           TO SF.
  5231     PERFORM 0530-ADD-UP-LEVELS 6 TIMES.
  5232** Zero the state      totals
  5233     PERFORM 0560-ZERO-PA VARYING SB FROM 13 BY 1
  5234                          UNTIL SB GREATER 18.
  5235
  5236     MOVE BALANCE-LINE-1 TO WS-BAL-LINE-1.
  5237     MOVE BALANCE-LINE-2 TO WS-BAL-LINE-2.
  5238
  5239 0830-BREAK-3-EXIT.
  5240     GO TO 0770-BREAK-RETURN.
  5241
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 114
* DCC043.cbl
  5243 0840-BREAK-4.
  5244     display ' made 0840 break 4 '
  5245     PERFORM 0820-BREAK-3.
  5246     MOVE '4'         TO HEAD-SW.
  5247     MOVE WS-SAVE-CMP TO H8-COMP.
  5248     MOVE HEAD-8-COMP TO H2-ADDR.
  5249     MOVE +4          TO SG.
  5250     MOVE +21         TO SF.
  5251     PERFORM 0440-GENERATE-RETRO THRU 0470-EXIT.
  5252     MOVE +19         TO SC.
  5253     MOVE +25         TO SF.
  5254     PERFORM 0530-ADD-UP-LEVELS 6 TIMES.
  5255** Zero the grouping   totals
  5256     PERFORM 0560-ZERO-PA VARYING SB FROM 19 BY 1
  5257                          UNTIL SB GREATER 24.
  5258
  5259 0850-BREAK-4-EXIT.
  5260     GO TO 0770-BREAK-RETURN.
  5261
  5262 0860-BREAK-5.
  5263     display ' made 0860 break 5 '
  5264
  5265     PERFORM 0840-BREAK-4.
  5266     MOVE '5'         TO HEAD-SW.
  5267     MOVE WS-SAVE-CAR TO H8-CARR.
  5268     MOVE HEAD-8-CARR TO H2-ADDR.
  5269     MOVE +5          TO SG.
  5270     MOVE +27         TO SF.
  5271     PERFORM 0440-GENERATE-RETRO THRU 0470-EXIT.
  5272     MOVE +25         TO SC.
  5273     MOVE +31         TO SF.
  5274     PERFORM 0530-ADD-UP-LEVELS 6 TIMES.
  5275** Zero the carrier    totals
  5276     PERFORM 0560-ZERO-PA VARYING SB FROM 25 BY 1
  5277                          UNTIL SB GREATER 30.
  5278
  5279 0870-BREAK-5-EXIT.
  5280     GO TO 0770-BREAK-RETURN.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 115
* DCC043.cbl
  5282
  5283 0880-BREAK-6.
  5284     display ' made 0860 break 5 '
  5285     PERFORM 0860-BREAK-5.
  5286     MOVE '6'          TO HEAD-SW.
  5287     MOVE HEAD-8-FINAL TO H2-ADDR.
  5288     MOVE +6           TO SG.
  5289     MOVE +33          TO SF.
  5290     PERFORM 0440-GENERATE-RETRO THRU 0470-EXIT.
  5291
  5292 0890-BREAK-6-EXIT.
  5293     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 116
* DCC043.cbl
  5295
  5296 0900-PRINT-GROUP-TOTALS.
  5297** Zero all            totals
  5298     PERFORM 0560-ZERO-PA VARYING SB FROM 1 BY 1
  5299                          UNTIL SB GREATER 36.
  5300     MOVE 'B' TO H1-REPORT-SUF.
  5301     PERFORM 0740-MOVE-SW-REC.
  5302     PERFORM 0730-RETURN-SORTED-FILE THRU 0730-EXIT.
  5303
  5304     if sw-rpt-type-id not = ws-prev-rpt-type
  5305*       PERFORM 0880-BREAK-6
  5306        move sw-rpt-type-id to ws-prev-rpt-type
  5307        go to 0920-for-one-b-record
  5308     end-if
  5309
  5310     .
  5311 0910-CHECK-GROUP-BREAK.
  5312     IF SW-GA NOT = WS-SAVE-GA
  5313         GO TO 0970-BREAK-GROUP-3.
  5314
  5315     IF SW-CARR  NOT = WS-SAVE-CAR OR
  5316        SW-COMP  NOT = WS-SAVE-CMP OR
  5317        SW-STATE NOT = WS-SAVE-ST  OR
  5318        SW-ACCT  NOT = WS-SAVE-ACC
  5319           GO TO 0950-BREAK-GROUP-2.
  5320
  5321     GO TO 0930-BREAK-GROUP-1.
  5322
  5323 0920-BREAK-GROUP-RETURN.
  5324     PERFORM 0740-MOVE-SW-REC.
  5325     PERFORM 0730-RETURN-SORTED-FILE THRU 0730-EXIT.
  5326
  5327 0920-for-one-b-record.
  5328
  5329     IF SW-CTL = HIGH-VALUES
  5330         PERFORM 0970-BREAK-GROUP-3
  5331         GO TO 1080-E-O-J
  5332     ELSE
  5333         IF SW-RPT-TYPE-ID = 'C'
  5334             PERFORM 0970-BREAK-GROUP-3
  5335             GO TO 0990-PRINT-GA-TOTALS
  5336         ELSE
  5337             GO TO 0910-CHECK-GROUP-BREAK.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 117
* DCC043.cbl
  5339
  5340 0930-BREAK-GROUP-1.
  5341     MOVE +1 TO SC.
  5342     MOVE +7 TO SF.
  5343     PERFORM 0530-ADD-UP-LEVELS 6 TIMES.
  5344** Zero the date range totals
  5345     PERFORM 0560-ZERO-PA VARYING SB FROM 1 BY 1
  5346                          UNTIL SB GREATER 6.
  5347
  5348 0940-BREAK-GROUP-1-EXIT.
  5349     GO TO 0920-BREAK-GROUP-RETURN.
  5350
  5351 0950-BREAK-GROUP-2.
  5352     PERFORM 0930-BREAK-GROUP-1.
  5353     MOVE '2'    TO HEAD-SW.
  5354     MOVE SPACES TO H4-FT  H5-FMO  H5-FS1  H5-FDA  H5-FS2  H5-FYR
  5355                    H5-TMO H5-TS1  H5-TDA  H5-TS2  H5-TYR.
  5356     MOVE +2     TO SG.
  5357     MOVE +9     TO SF.
  5358     MOVE +1     TO SH.
  5359     PERFORM 0440-GENERATE-RETRO THRU 0470-EXIT.
  5360     MOVE +7     TO SC.
  5361     MOVE +13    TO SF.
  5362     PERFORM 0530-ADD-UP-LEVELS 6 TIMES.
  5363** Zero the account    totals
  5364     PERFORM 0560-ZERO-PA VARYING SB FROM 7 BY 1
  5365                          UNTIL SB GREATER 12.
  5366
  5367 0960-BREAK-GROUP-2-EXIT.
  5368     GO TO 0920-BREAK-GROUP-RETURN.
  5369
  5370 0970-BREAK-GROUP-3.
  5371     PERFORM 0950-BREAK-GROUP-2.
  5372     MOVE '3'        TO HEAD-SW.
  5373     MOVE WS-SAVE-GA TO H8-GROUP  ZONE-GROUP.
  5374     MOVE '  GROUP'  TO H-8-G.
  5375
  5376     IF ZON = 'ZON'
  5377         INSPECT H8-GROUP CONVERTING 'ZON' TO '   '
  5378         MOVE '  ZONE' TO H-8-G.
  5379*
  5380*  SKIP 1 ADDITIONAL PAGE TO PRINT GROUP TOTALS ON A
  5381*  SEPARATE PAGE BY ITSELF.
  5382*
  5383     MOVE '1'              TO X.
  5384     MOVE SPACE-LINE       TO P-DATA.
  5385     PERFORM 0610-PRT-RTN THRU 0630-EXIT.
  5386
  5387     MOVE HEAD-8-GROUP TO H2-ADDR.
  5388     MOVE SPACES       TO H1-NAME  H3-ADDR  H3-ZIP.
  5389     MOVE +3           TO SG.
  5390     MOVE +15          TO SF.
  5391     PERFORM 0440-GENERATE-RETRO THRU 0470-EXIT.
  5392*
  5393*  SKIP 1 ADDITIONAL PAGE TO PRINT GROUP TOTALS ON A
  5394*  SEPARATE PAGE BY ITSELF.
  5395*
  5396     MOVE '1'              TO X.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 118
* DCC043.cbl
  5397     MOVE SPACE-LINE       TO P-DATA.
  5398     PERFORM 0610-PRT-RTN THRU 0630-EXIT.
  5399
  5400     MOVE +13          TO SC.
  5401     MOVE +19          TO SF.
  5402     PERFORM 0530-ADD-UP-LEVELS 6 TIMES.
  5403** Zero the state      totals
  5404     PERFORM 0560-ZERO-PA VARYING SB FROM 13 BY 1
  5405                          UNTIL SB GREATER 18.
  5406
  5407 0980-BREAK-GROUP-3-EXIT.
  5408     GO TO 0920-BREAK-GROUP-RETURN.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 119
* DCC043.cbl
  5410 0990-PRINT-GA-TOTALS.
  5411     display ' made 0990 print ga totals '
  5412** Zero all            totals
  5413     PERFORM 0560-ZERO-PA VARYING SB FROM 1 BY 1
  5414                          UNTIL SB GREATER 36.
  5415     MOVE 'C' TO H1-REPORT-SUF.
  5416     PERFORM 0740-MOVE-SW-REC.
  5417     PERFORM 0730-RETURN-SORTED-FILE THRU 0730-EXIT.
  5418
  5419 1000-CHECK-GA-BREAK.
  5420     display ' made 1000 check ga break '
  5421     IF SW-GA NOT = WS-SAVE-GA
  5422         GO TO 1060-BREAK-GA-3.
  5423
  5424     IF SW-CARR  NOT = WS-SAVE-CAR  OR
  5425        SW-COMP  NOT = WS-SAVE-CMP  OR
  5426        SW-STATE NOT = WS-SAVE-ST   OR
  5427        SW-ACCT  NOT = WS-SAVE-ACC
  5428           GO TO 1040-BREAK-GA-2.
  5429
  5430     GO TO 1020-BREAK-GA-1.
  5431
  5432 1010-BREAK-GA-RETURN.
  5433     display ' made 1010 check ga return '
  5434     PERFORM 0740-MOVE-SW-REC.
  5435     PERFORM 0730-RETURN-SORTED-FILE THRU 0730-EXIT.
  5436
  5437     IF SW-CTL = HIGH-VALUES
  5438         PERFORM 1060-BREAK-GA-3
  5439         GO TO 1080-E-O-J.
  5440
  5441     GO TO 1000-CHECK-GA-BREAK.
  5442
  5443 1020-BREAK-GA-1.
  5444     display ' made 1020 break ga 1 '
  5445     MOVE +1 TO SC.
  5446     MOVE +7 TO SF.
  5447     PERFORM 0530-ADD-UP-LEVELS 6 TIMES.
  5448     PERFORM 0560-ZERO-PA VARYING SB FROM 1 BY 1
  5449                          UNTIL SB GREATER 6.
  5450
  5451 1030-BREAK-GA-1-EXIT.
  5452     GO TO 1010-BREAK-GA-RETURN.
  5453
  5454 1040-BREAK-GA-2.
  5455     display ' made 1040 break ga 2 '
  5456     PERFORM 1020-BREAK-GA-1.
  5457
  5458     IF LIFE-RETENT = ZERO
  5459         MOVE ZEROS TO PA-NBA (7) PA-NBA (10).
  5460
  5461     IF AH-RETENT = ZERO
  5462         MOVE ZEROS TO PA-NBA (8) PA-NBA (11).
  5463
  5464     ADD PA-NBA (7) PA-NBA (8) GIVING PA-NBA (9).
  5465     ADD PA-NBA (10) PA-NBA (11) GIVING PA-NBA (12).
  5466
  5467     MOVE '2' TO HEAD-SW.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 120
* DCC043.cbl
  5468     MOVE SPACES TO H4-FT  H5-FMO  H5-FS1  H5-FDA  H5-FS2  H5-FYR
  5469                    H5-TMO H5-TS1  H5-TDA  H5-TS2  H5-TYR.
  5470
  5471     MOVE +2 TO SG.
  5472     MOVE +9 TO SF.
  5473     MOVE +1 TO SH.
  5474     PERFORM 0440-GENERATE-RETRO THRU 0470-EXIT.
  5475
  5476     IF PA-NBA (7) LESS +0
  5477         ADD PA-NBA (7) TO PA-NBA (8)
  5478         MOVE +0 TO PA-NBA (7)
  5479         IF PA-NBA (8) LESS +0
  5480             MOVE +0 TO PA-NBA (8).
  5481
  5482     IF PA-NBA (8) LESS +0
  5483         ADD PA-NBA (8) TO PA-NBA (7)
  5484         MOVE +0 TO PA-NBA (8)
  5485         IF PA-NBA (7) LESS +0
  5486             MOVE +0 TO PA-NBA (7).
  5487
  5488     COMPUTE PA-NBA (9) = PA-NBA (7) + PA-NBA (8).
  5489
  5490     IF SAVE-RET-Y-N = SPACE  OR  'N'
  5491         MOVE ZEROS  TO  PA-NBA (7)  PA-NBA (8)  PA-NBA (9).
  5492
  5493     IF PA-NBA (10) LESS +0
  5494         ADD PA-NBA (10) TO PA-NBA (11)
  5495         MOVE +0 TO PA-NBA (10)
  5496         IF PA-NBA (11) LESS +0
  5497             MOVE +0 TO PA-NBA (11).
  5498
  5499     IF PA-NBA (11) LESS +0
  5500         ADD PA-NBA (11) TO PA-NBA (10)
  5501         MOVE +0 TO PA-NBA (11)
  5502         IF PA-NBA (10) LESS +0
  5503             MOVE +0 TO PA-NBA (10).
  5504
  5505     COMPUTE PA-NBA (12) = PA-NBA (10) + PA-NBA (11).
  5506
  5507     IF SAVE-RET-Y-N = SPACE  OR  'N'
  5508         MOVE ZEROS  TO  PA-NBA (10)  PA-NBA (11)  PA-NBA (12).
  5509
  5510     MOVE +7  TO SC.
  5511     MOVE +13 TO SF.
  5512     PERFORM 0530-ADD-UP-LEVELS 6 TIMES.
  5513     PERFORM 0560-ZERO-PA VARYING SB FROM 7 BY 1
  5514                          UNTIL SB GREATER 12.
  5515
  5516 1050-BREAK-GA-2-EXIT.
  5517     GO TO 1010-BREAK-GA-RETURN.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 121
* DCC043.cbl
  5519
  5520 1060-BREAK-GA-3.
  5521     display ' made 1060 break ga 3 '
  5522     PERFORM 1040-BREAK-GA-2.
  5523     MOVE '3'        TO HEAD-SW.
  5524     MOVE WS-SAVE-GA TO H8-GA.
  5525     MOVE HEAD-8-GA  TO H2-ADDR.
  5526     MOVE SPACES     TO H1-NAME  H3-ADDR  H3-ZIP.
  5527*    MOVE +1.0       TO LIFE-RETENT AH-RETENT.
  5528
  5529     IF DTE-CLIENT = 'GIC'
  5530         MOVE 'P' TO SAVE-RET-TYP
  5531     ELSE
  5532         MOVE 'E' TO SAVE-RET-TYP.
  5533
  5534     MOVE +3    TO SG.
  5535     MOVE +15   TO SF.
  5536     MOVE +2    TO SH.
  5537     MOVE LIFE-RETENT TO RETENT-FACT.
  5538     MOVE +13   TO SC.
  5539     MOVE +15   TO SF.
  5540*    PERFORM 0420-CALCULATE-GA THRU 0430-EXIT.
  5541     MOVE AH-RETENT TO RETENT-FACT.
  5542     MOVE +14   TO SC.
  5543*    PERFORM 0420-CALCULATE-GA THRU 0430-EXIT.
  5544     MOVE LIFE-RETENT TO RETENT-FACT.
  5545     MOVE +16   TO SC.
  5546     MOVE +18   TO SF.
  5547*    PERFORM 0420-CALCULATE-GA THRU 0430-EXIT.
  5548     MOVE AH-RETENT TO RETENT-FACT.
  5549     MOVE +17 TO SC.
  5550*    PERFORM 0420-CALCULATE-GA THRU 0430-EXIT.
  5551
  5552     ADD PA-PE (13) PA-PE (14) GIVING PA-PE (15).
  5553     ADD PA-PE (16) PA-PE (17) GIVING PA-PE (18).
  5554
  5555     MOVE +15 TO SF.
  5556
  5557     PERFORM 0440-GENERATE-RETRO THRU 0470-EXIT.
  5558     PERFORM 0560-ZERO-PA VARYING SB FROM 13 BY 1
  5559                          UNTIL SB GREATER 18.
  5560
  5561 1070-BREAK-GA-3-EXIT.
  5562     GO TO 1010-BREAK-GA-RETURN.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 122
* DCC043.cbl
  5564 1080-E-O-J.
  5565     CLOSE WORK-FILE
  5566         PRNTR.
  5567
  5568 1090-CLOSE-FICH.
* 5569                             COPY ELCPRTC.
  5570******************************************************************04/15/98
  5571*                                                                *ELCPRTC
  5572*                                                                *ELCPRTC
  5573*                            ELCPRTC.                            *   LV003
  5574*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
  5575*                            VMOD=2.002                          *   CL**2
  5576*       CLOSE FICH FILE IF OPEN                                  *ELCPRTC
  5577*                                                                *ELCPRTC
  5578* NOTE- USE ELCPRTCX IF USING ELCPRT2X (ONLINE REPORT SAVE)      *   CL**2
  5579******************************************************************ELCPRTC
  5580                                                                  ELCPRTC
  5581      IF FICH-OPEN NOT = SPACE                                    ELCPRTC
  5582          CLOSE FICH.                                             ELCPRTC
  5583                                                                  ELCPRTC
  5584******************************************************************ELCPRTC
  5585
  5586 1090-CLOSE-EXIT.
  5587     EXIT.
  5588
* 5589 COPY ELCDCS.
  5590****************************************************************  04/15/98
  5591*                                                              *  ELCDCS
  5592*                                                              *  ELCDCS
  5593*                            ELCDCS.                           *     LV003
  5594*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  5595*                            VMOD=2.002                        *     CL**3
  5596*                                                              *  ELCDCS
  5597*           THIS SECTION CALLS THE DATE CONVERSION SUBROUTINE. *  ELCDCS
  5598****************************************************************. ELCDCS
  5599                                                                  ELCDCS
  5600 8510-DATE-CONVERSION.                                            ELCDCS
  5601     CALL 'ELDATCX' USING DATE-CONVERSION-DATA.                   ELCDCS
  5602                                                                  ELCDCS
  5603 8590-EXIT.                                                       ELCDCS
  5604     EXIT.                                                        ELCDCS
  5605                                                                  ELCDCS
  5606
  5607 ABEND-PGM SECTION.
* 5608                             COPY ELCABEND SUPPRESS.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:       67940     Code:       37092
