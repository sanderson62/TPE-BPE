* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   1
* ECS152.cbl
* Options: int("ECS152.int") anim csi verbose NOBOUND PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("ECS152.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"ebmlsfile" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" NOCHECKDIV NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"32" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"ECS152.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"ECS152.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR NOSTICKY-LINKAGE
*          NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"2" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.                                         09/28/98
     2                                                                  ECS152
     3 PROGRAM-ID.                 ECS152.                                 LV008
     4*              PROGRAM CONVERTED BY                               ECS152
     5*              COBOL CONVERSION AID PO 5785-ABJ                   ECS152
     6*              CONVERSION DATE 10/17/97 08:54:30.                 ECS152
     7*                            VMOD=2.005.                          ECS152
     8*                                                                 ECS152
     9*AUTHOR.     LOGIC, INC.                                          ECS152
    10*            DALLAS, TEXAS                                        ECS152
    11                                                                  ECS152
    12*DATE-COMPILED.                                                   ECS152
    13*SECURITY.   *****************************************************ECS152
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   2
* ECS152.cbl
    14*            *                                                   *ECS152
    15*            *   THIS PROGRAM IS THE PROPERTY OF LOGIC, INC.     *ECS152
    16*            *                                                   *ECS152
    17*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *ECS152
    18*            *   OF LOGIC, INC. IS EXPRESSLY PROHIBITED WITHOUT  *ECS152
    19*            *   THE PRIOR WRITTEN PERMISSION OF LOGIC INC.      *ECS152
    20*            *                                                   *ECS152
    21*            *****************************************************ECS152
    22                                                                  ECS152
    23*REMARKS.  PRINT POLICY EXHIBIT FOR FILES B AND C.                ECS152
    24*          NO PROGRAM OPTION (DEFAULT TO '2') WILL NOT PRINT      ECS152
    25*          ACCOUNT TOTALS.                                        ECS152
    26*          OPTION '1' WILL PRINT ACCOUNT TOTALS.                  ECS152
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   3
* ECS152.cbl
    28******************************************************************
    29*                   C H A N G E   L O G
    30*
    31* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    32*-----------------------------------------------------------------
    33*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    34* EFFECTIVE    NUMBER
    35*-----------------------------------------------------------------
    36* 121510 CR2009120700001   PEMA  FORCE BEGINNING TOTALS TO MATCH ENDING
    37******************************************************************
    38 ENVIRONMENT DIVISION.                                            ECS152
    39 CONFIGURATION SECTION.                                           ECS152
    40 SPECIAL-NAMES.                                                   ECS152
    41     C02 IS LCP-CH2                                               ECS152
    42     C03 IS LCP-CH3                                               ECS152
    43     C04 IS LCP-CH4                                               ECS152
    44     C05 IS LCP-CH5                                               ECS152
    45     C06 IS LCP-CH6                                               ECS152
    46     C07 IS LCP-CH7                                               ECS152
    47     C08 IS LCP-CH8                                               ECS152
    48     C09 IS LCP-CH9                                               ECS152
    49     C10 IS LCP-CH10                                              ECS152
    50     C11 IS LCP-CH11                                              ECS152
    51     C12 IS LCP-CH12                                              ECS152
    52     S01 IS LCP-P01                                               ECS152
    53     S02 IS LCP-P02.                                              ECS152
    54 INPUT-OUTPUT SECTION.                                            ECS152
    55 FILE-CONTROL.                                                    ECS152
    56     SELECT EXTR-IN-B    ASSIGN TO SYS010-UT-2400-S-SYS010.       ECS152
    57     SELECT EXTR-IN-C    ASSIGN TO SYS011-UT-2400-S-SYS011.       ECS152
    58     SELECT DISK-DATE    ASSIGN TO SYS019-UT-FBA1-S-SYS019.       ECS152
    59     SELECT PRT-FILE     ASSIGN TO SYS008-UR-1403-S-SYS008.       ECS152
    60     SELECT FICH         ASSIGN TO SYS020-UT-2400-S-SYS020.       ECS152
    61     SELECT SORT-FILE    ASSIGN TO SYS001-UT-FBA1-S-SORTWK1.      ECS152
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   4
* ECS152.cbl
    63 DATA DIVISION.                                                   ECS152
    64 FILE SECTION.                                                    ECS152
    65 FD  EXTR-IN-B                                                    ECS152
    66     BLOCK CONTAINS 0 RECORDS
    67     RECORDING MODE F.                                            ECS152
    68                                                                  ECS152
    69 01  EXTR-RECORD-B               PIC X(2701).                     ECS152
    70                                                                  ECS152
    71                                                                  ECS152
    72 FD  EXTR-IN-C                                                    ECS152
    73     BLOCK CONTAINS 0 RECORDS
    74     RECORDING MODE F.                                            ECS152
    75                                                                  ECS152
    76 01  EXTR-RECORD-C               PIC X(2701).                     ECS152
    77 01  EXTR-C-REDEFINE.
    78     05  EC-REINS-CO             PIC X(6).
    79     05  EC-CARRIER              PIC X.
    80     05  EC-GROUP                PIC X(6).
    81     05  F                       PIC X(2688).
    82
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   5
* ECS152.cbl
    84 FD  DISK-DATE                                                    ECS152
*   85                             COPY ELCDTEFD.                       ECS152
    86******************************************************************04/15/98
    87*                                                                *ELCDTEFD
    88*                                                                *ELCDTEFD
    89*                            ELCDTEFD.                           *   LV002
    90*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
    91*                            VMOD=2.007                          *   CL**2
    92*                                                                *ELCDTEFD
    93******************************************************************ELCDTEFD
    94     BLOCK CONTAINS 0 RECORDS
    95     RECORDING MODE F.                                            ELCDTEFD
    96                                                                  ELCDTEFD
    97 01  DATE-DISK.                                                   ELCDTEFD
    98     12  DD-ID                       PIC  X(4).                   ELCDTEFD
    99     12  FILLER                      PIC  X(14).                  ELCDTEFD
   100     12  DD-CR1                      PIC  9.                      ELCDTEFD
   101     12  DD-CR1N                     PIC  X(30).                  ELCDTEFD
   102     12  DD-CR2                      PIC  9.                      ELCDTEFD
   103     12  DD-CR2N                     PIC  X(30).                  ELCDTEFD
   104     12  FILLER                      PIC  X(20).                  ELCDTEFD
   105                                                                  ELCDTEFD
   106 01  DATE-DISK-R.                                                 ELCDTEFD
   107     12  FILLER                      PIC  X(4).                   ELCDTEFD
   108     12  DD-ST           OCCURS 3 TIMES                           ELCDTEFD
   109                                     PIC  X(32).                  ELCDTEFD
   110                                                                  ELCDTEFD
   111 01  DATE-DISK-T.                                                 ELCDTEFD
   112     12  FILLER                      PIC  X(4).                   ELCDTEFD
   113     12  DD-TYPE         OCCURS 2 TIMES                           ELCDTEFD
   114                                     PIC  X(48).                  ELCDTEFD
   115                                                                  ELCDTEFD
   116 01  DATE-DISK-M.                                                 ELCDTEFD
   117     12  FILLER                      PIC  X(4).                   ELCDTEFD
   118     12  DD-MORT         OCCURS 2 TIMES                           ELCDTEFD
   119                                     PIC  X(48).                  ELCDTEFD
   120                                                                  ELCDTEFD
   121 01  DATE-DISK-P.                                                 ELCDTEFD
   122     12  DD-IDA                      PIC  XX.                     ELCDTEFD
   123     12  DD-IDX                      PIC  99.                     ELCDTEFD
   124     12  DD-DATA                     PIC  X(96).                  ELCDTEFD
   125     12  FILLER  REDEFINES DD-DATA.                               ELCDTEFD
   126         16  DD-PS-PIC   OCCURS 50 TIMES                          ELCDTEFD
   127                                     PIC  X.                      ELCDTEFD
   128         16  FILLER                  PIC  X(46).                  ELCDTEFD
   129     12  FILLER  REDEFINES DD-DATA.                               ELCDTEFD
   130         16  DD-PS-PICO  OCCURS 20 TIMES.                         ELCDTEFD
   131             20  DD-PS-PRT           PIC  X.                      ELCDTEFD
   132             20  DD-PS-FMT           PIC  X.                      ELCDTEFD
   133             20  DD-PS-PRC           PIC  X.                      ELCDTEFD
   134             20  DD-PS-TOT           PIC  X.                      ELCDTEFD
   135         16  FILLER                  PIC  X(16).                  ELCDTEFD
   136                                                                  ELCDTEFD
   137 01  DATE-DISK-E.                                                 ELCDTEFD
   138     12  FILLER                      PIC  X(4).                   ELCDTEFD
   139     12  DD-EDIT         OCCURS 24 TIMES                          ELCDTEFD
   140                                     PIC  X(4).                   ELCDTEFD
   141                                                                  ELCDTEFD
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   6
* ECS152.cbl (/apps/prod/cid1p/copy/ELCDTEFD)
   142 01  DATE-DISK-C.                                                 ELCDTEFD
   143     12  FILLER                      PIC  X(7).                   ELCDTEFD
   144     12  DD-CARR1-SECPAY-SW          PIC  X.
   145     12  DD-CARR1-UEP-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   146     12  DD-CARR1-R78-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   147     12  DD-CARR1-PRO-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   148     12  DD-CARR1                    PIC  X.                      ELCDTEFD
   149     12  DD-CARR1S                   PIC  XX.                     ELCDTEFD
   150     12  DD-CARR1N                   PIC  X(30).                  ELCDTEFD
   151     12  DD-CARR2                    PIC  X.                      ELCDTEFD
   152     12  DD-CARR2S                   PIC  XX.                     ELCDTEFD
   153     12  DD-CARR2N                   PIC  X(30).                  ELCDTEFD
   154     12  DD-CARR2-UEP-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   155     12  DD-CARR2-R78-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   156     12  DD-CARR2-PRO-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   157     12  DD-CARR2-SECPAY-SW          PIC  X.
   158     12  FILLER                      PIC  X(7).                   ELCDTEFD
   159                                                                  ELCDTEFD
   160 01  DATE-DISK-OPT.                                               ELCDTEFD
   161     12  FILLER                      PIC  X(04).                  ELCDTEFD
   162     12  DD-TLR-DATA.                                             ELCDTEFD
   163         16  DD-TLR                  OCCURS 32 TIMES              ELCDTEFD
   164                                     PIC  X(03).                  ELCDTEFD
   165     12  DD-STATE-DATA REDEFINES DD-TLR-DATA.                     ELCDTEFD
   166         16  DD-STATE-FLDS           OCCURS 16 TIMES              ELCDTEFD
   167                                     PIC  X(06).                  ELCDTEFD
   168     12  DD-CARR-DATA REDEFINES DD-TLR-DATA.                      ELCDTEFD
   169         16  DD-CARR-FLDS            OCCURS 13 TIMES              ELCDTEFD
   170                                     PIC  X(07).                  ELCDTEFD
   171         16  FILLER                  PIC  X(05).                  ELCDTEFD
   172     12  DD-MISC-DATA REDEFINES DD-TLR-DATA                       ELCDTEFD
   173                                     PIC  X(96).                  ELCDTEFD
   174******************************************************************ELCDTEFD
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   7
* ECS152.cbl
   176 FD  PRT-FILE                                                     ECS152
*  177                             COPY ELCPRTFD.                       ECS152
   178******************************************************************04/15/98
   179*                                                                *ELCPRTFD
   180*                                                                *ELCPRTFD
   181*                            ELCPRTFD.                           *   LV003
   182*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
   183*                            VMOD=2.006                          *ELCPRTFD
   184******************************************************************ELCPRTFD
   185     RECORDING MODE F                                             ELCPRTFD
   186     LABEL RECORDS OMITTED                                        ELCPRTFD
   187     BLOCK CONTAINS 0 RECORDS
   188     RECORD CONTAINS 133 CHARACTERS.                              ELCPRTFD
   189 01  PRT.                                                         ELCPRTFD
   190     12  P-CTL               PIC  X.                                 CL**2
   191     12  P-DATA              PIC  X(132).                         ELCPRTFD
   192******************************************************************ELCPRTFD
   193                                                                  ECS152
   194 FD  FICH                                                         ECS152
*  195                             COPY ELCFCHFD.                       ECS152
   196******************************************************************04/15/98
   197*                                                                *ELCFCHFD
   198*                            ELCFCHFD.                           *   LV003
   199*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
   200*                            VMOD=2.004                          *   CL**3
   201*                                                                *ELCFCHFD
   202******************************************************************ELCFCHFD
   203     BLOCK CONTAINS 0 RECORDS
   204     RECORDING MODE F.                                            ELCFCHFD
   205                                                                  ELCFCHFD
   206 01  FICH-REC                            PIC   X(133).            ELCFCHFD
   207******************************************************************ELCFCHFD
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   8
* ECS152.cbl
   209 SD  SORT-FILE.                                                   ECS152
   210                                                                  ECS152
   211 01  SORT-REC.                                                    ECS152
   212     05  SORT-KEY        PIC X(41).                               ECS152
   213     05  FILLER          PIC X(2660).                             ECS152
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   9
* ECS152.cbl
   215 WORKING-STORAGE SECTION.                                         ECS152
   216 77  FILLER  PIC X(32) VALUE '********************************'.  ECS152
   217 77  FILLER  PIC X(32) VALUE '     ECS152 WORKING STORAGE     '.  ECS152
   218 77  FILLER  PIC X(32) VALUE '*****VMOD=2.005 ****************'.  ECS152
   219                                                                  ECS152
   220 77  EOJ-SW                      PIC X VALUE 'N'.                 ECS152
   221 77  PAGE-CNT                    PIC 9(5) VALUE ZERO.             ECS152
   222 77  FIRST-READ                  PIC X VALUE 'Y'.                 ECS152
   223 77  STATE-INDEX                 PIC XX VALUE SPACES.             ECS152
   224 77  DO-PRINT                    PIC X VALUE SPACE.               ECS152
   225 77  PRINT-SW                    PIC X VALUE SPACE.               ECS152
   226 77  LCP-ASA                     PIC X.                           ECS152
   227                                                                  ECS152
   228 01  FILE-SW                     PIC X.                           ECS152
   229     88  FILE-1                            VALUE '1'.             ECS152
   230     88  FILE-2                            VALUE '2'.             ECS152
   231     88  FILE-3                            VALUE '3'.             ECS152
   232                                                                  ECS152
   233 01  WS-REPORT-TITLE             PIC X(10)  VALUE SPACES.
   234 01  WS.                                                          ECS152
   235     03  WS-ZERO                 PIC S9      VALUE +0 COMP-3.     ECS152
   236     03  WS-RETURN-CODE          PIC S9(4)   VALUE +0 COMP-3.     ECS152
   237     03  WS-ABEND-MESSAGE        PIC X(80)   VALUE SPACES.        ECS152
   238     03  WS-ABEND-FILE-STATUS    PIC XX      VALUE ZERO.          ECS152
   239     03  ABEND-CODE              PIC X(4)    VALUE ZERO.          ECS152
   240     03  ABEND-OPTION            PIC X       VALUE 'Y'.           ECS152
   241     03  PGM-SUB                 PIC S9(3)   VALUE +152 COMP.     ECS152
   242                                                                  ECS152
   243 01  WS-WORK-DATE                PIC 9(11).                          CL**6
   244 01  WS-WORK-DATE-R  REDEFINES  WS-WORK-DATE.                        CL**5
   245     03  FILLER                  PIC 999.                            CL**5
   246     03  WS-CCYY                 PIC 9(4).                           CL**5
   247     03  WS-CCYR  REDEFINES  WS-CCYY.                                CL**5
   248         05  WS-CENT             PIC 99.                             CL**5
   249         05  WS-YEAR             PIC 99.                             CL**5
   250     03  WS-MONTH                PIC 99.                             CL**8
   251     03  WS-DAY                  PIC 99.                             CL**5
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  10
* ECS152.cbl
   253 01  HD-1.                                                        ECS152
   254     03  FILLER                  PIC X(12) VALUE '1TOTALS FOR '.  ECS152
   255     03  HD-1-MSG                PIC X(21) VALUE SPACES.          ECS152
   256     03  HD-1-MSGA               PIC X(17) VALUE SPACES.          ECS152
   257*    03  FILLER                  PIC X(17) VALUE SPACES.          ECS152
   258     03  HD-1-COMP               PIC X(30) VALUE SPACES.          ECS152
   259     03  FILLER                  PIC X(45) VALUE SPACES.          ECS152
   260     03  FILLER                  PIC X(8)  VALUE 'ECS-152'.       ECS152
   261                                                                  ECS152
   262 01  HD-2.                                                        ECS152
   263     03  FILLER                  PIC X(12) VALUE '   CARRIER  '.  ECS152
   264     03  HD-2-CARRIER            PIC X VALUE SPACE.               ECS152
   265     03  FILLER                  PIC X(38) VALUE SPACES.          ECS152
   266     03  HD-2-REIN.                                               ECS152
   267         05  HD-2-REIN-MSG       PIC X(26) VALUE SPACES.          ECS152
   268         05  HD-2-REIN-COMP      PIC X(4) VALUE SPACES.           ECS152
   269     03  FILLER                  PIC X(44) VALUE SPACES.          ECS152
   270     03  HD-2-IPL                PIC X(8) VALUE SPACES.           ECS152
   271                                                                  ECS152
   272 01  HD-3.                                                        ECS152
   273     03  FILLER                  PIC X(12) VALUE '  GROUPING  '.  ECS152
   274     03  HD-3-COMPANY            PIC X(6)  VALUE SPACES.          ECS152
   275     03  FILLER                  PIC X(28) VALUE SPACES.          ECS152
   276     03  HD-3-TITLE              PIC X(26) VALUE SPACES.          ECS152
   277     03  HD-3-MSG                PIC X(20) VALUE SPACES.          ECS152
   278     03  FILLER                  PIC X(41) VALUE SPACES.          ECS152
   279                                                                  ECS152
   280 01  HD-4.                                                        ECS152
   281     03  FILLER                  PIC X(12) VALUE '   STATE    '.  ECS152
   282     03  HD-4-STATE              PIC X(20) VALUE SPACES.          ECS152
   283     03  FILLER                  PIC X(86) VALUE SPACES.          ECS152
   284     03  FILLER                  PIC X(5)  VALUE 'PAGE '.         ECS152
   285     03  HD-4-PAGE               PIC ZZ,ZZZ.                      ECS152
   286     03  FILLER                  PIC X(4) VALUE SPACES.           ECS152
   287                                                                  ECS152
   288 01  HD-5.                                                        ECS152
   289     03  FILLER                  PIC X(12) VALUE '   ACCOUNT  '.  ECS152
   290     03  HD-5-ACCOUNT            PIC X(10) VALUE SPACES.          ECS152
   291     03  FILLER                  PIC X(26) VALUE SPACES.          ECS152
   292     03  FILLER                  PIC X(22)                        ECS152
   293         VALUE 'FOR PERIOD STARTING - '.                          ECS152
   294     03  HD-5-MONTH              PIC X(10).                       ECS152
   295     03  HD-5-DAY                PIC XX.                          ECS152
   296     03  FILLER                  PIC X(2) VALUE ', '.                CL**3
   297     03  HD-5-CENT               PIC XX.                             CL**3
   298     03  HD-5-YEAR               PIC XX.                             CL**3
   299     03  FILLER                  PIC X(45) VALUE SPACES.          ECS152
   300                                                                  ECS152
   301 01  HD-6.                                                        ECS152
   302     03  FILLER                  PIC X(3)  VALUE SPACES.          ECS152
   303     03  HD-6-MSG                PIC X(53) VALUE SPACES.          ECS152
   304     03  FILLER                  PIC X(10)                        ECS152
   305         VALUE 'ENDING  - '.                                      ECS152
   306     03  HD-6-MONTH              PIC X(10).                       ECS152
   307     03  HD-6-DAY                PIC XX.                          ECS152
   308     03  FILLER                  PIC X(2) VALUE ', '.                CL**3
   309     03  HD-6-CENT               PIC XX.                             CL**3
   310     03  HD-6-YEAR               PIC XX.                             CL**3
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  11
* ECS152.cbl
   311     03  FILLER                  PIC X(49) VALUE SPACES.          ECS152
   312                                                                  ECS152
   313 01  HD-7.                                                        ECS152
   314     03  FILLER                  PIC X(41) VALUE '0'.             ECS152
   315     03  FILLER                  PIC X(43)                        ECS152
   316         VALUE '*****  G R O U P   C E R T I F I C A T E S '.     ECS152
   317     03  FILLER                  PIC X(6)                         ECS152
   318         VALUE ' *****'.                                          ECS152
   319     03  FILLER                  PIC X(43) VALUE SPACES.          ECS152
   320                                                                  ECS152
   321 01  HD-8.                                                        ECS152
   322     03  FILLER                  PIC X(41) VALUE '0'.             ECS152
   323     03  FILLER                  PIC X(44)                        ECS152
   324         VALUE '*****  I N D I V I D U A L   P O L I C I E S'.    ECS152
   325     03  FILLER                  PIC X(7) VALUE '  *****'.        ECS152
   326     03  FILLER                  PIC X(41) VALUE SPACES.          ECS152
   327                                                                  ECS152
   328 01  HD-9.                                                        ECS152
   329     03  FILLER                  PIC X(50) VALUE SPACES.          ECS152
   330     03  HD-9-MSG                PIC X(32) VALUE SPACES.          ECS152
   331     03  FILLER                  PIC X(51) VALUE SPACES.          ECS152
   332                                                                  ECS152
   333 01  HD-MESSAGES.                                                 ECS152
   334     03  HD-MSG1                 PIC X(20)                        ECS152
   335         VALUE 'COMPLETE BUSINESS - '.                            ECS152
   336     03  HD-MSG2                 PIC X(20)                        ECS152
   337         VALUE 'REINSURED BUSINESS -'.                            ECS152
   338     03  HD-MSG3                 PIC X(26)                        ECS152
   339         VALUE 'FOR REINSURANCE COMPANY - '.                      ECS152
   340     03  HD-MSG4                 PIC X(26)                        ECS152
   341         VALUE '- CERTIFICATE ACTIVITY ON '.                      ECS152
   342     03  HD-MSG5                 PIC X(26)                        ECS152
   343         VALUE ' - CERTIFICATE EXHIBIT ON '.                      ECS152
   344     03  HD-MSG6.                                                 ECS152
   345         05  FILLER              PIC X(21)                        ECS152
   346             VALUE 'REINSURANCE COMPANY  '.                       ECS152
   347         05  HD-MSG6-REIN        PIC X(7).                        ECS152
   348     03  HD-MSG7                 PIC X(31)                        ECS152
   349         VALUE '******************************'.                  ECS152
   350                                                                  ECS152
   351 01  HD-10.                                                       ECS152
   352     03  FILLER                  PIC X(26)                        ECS152
   353         VALUE '0 BENEFIT TYPE'.                                  ECS152
   354     03  FILLER                  PIC X(37)                        ECS152
   355         VALUE 'I S S U E D'.                                     ECS152
   356     03  FILLER                  PIC X(36)                        ECS152
   357         VALUE 'C A N C E L L E D'.                               ECS152
   358     03  FILLER                  PIC X(23)                        ECS152
   359         VALUE 'C L A I M S'.                                     ECS152
   360     03  FILLER                  PIC X(11)                        ECS152
   361         VALUE 'E A R N E D'.                                     ECS152
   362                                                                  ECS152
   363 01  HD-11.                                                       ECS152
   364     03  FILLER                  PIC X(17)                        ECS152
   365         VALUE ' **************'.                                 ECS152
   366     03  FILLER                  PIC X(40)                        ECS152
   367         VALUE '************************************'.            ECS152
   368     03  FILLER                  PIC X(39)                        ECS152
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  12
* ECS152.cbl
   369         VALUE '************************************'.            ECS152
   370     03  FILLER                  PIC X(24)                        ECS152
   371         VALUE '*********************'.                           ECS152
   372     03  FILLER                  PIC X(13)                        ECS152
   373         VALUE '*************'.                                   ECS152
   374                                                                  ECS152
   375 01  HD-12.                                                       ECS152
   376     03  FILLER                  PIC X(17) VALUE SPACES.          ECS152
   377     03  FILLER                  PIC X(8) VALUE '-COUNT-'.        ECS152
   378     03  FILLER                  PIC X(16)                        ECS152
   379         VALUE '----AMOUNT----'.                                  ECS152
   380     03  FILLER                  PIC X(12)                        ECS152
   381         VALUE '--PREMIUM---'.                                    ECS152
   382     03  FILLER                  PIC X(4) VALUE SPACES.           ECS152
   383     03  FILLER                  PIC X(8) VALUE '-COUNT-'.        ECS152
   384     03  FILLER                  PIC X(16)                        ECS152
   385         VALUE '----AMOUNT----'.                                  ECS152
   386     03  FILLER                  PIC X(12)                        ECS152
   387         VALUE '--PREMIUM---'.                                    ECS152
   388     03  FILLER                  PIC X(3) VALUE SPACES.           ECS152
   389     03  FILLER                  PIC X(8) VALUE '-COUNT-'.        ECS152
   390     03  FILLER                  PIC X(16)                        ECS152
   391         VALUE '---AMOUNT----'.                                   ECS152
   392     03  FILLER                  PIC X(13)                        ECS152
   393         VALUE '----AMOUNT---'.                                   ECS152
   394                                                                  ECS152
   395 01  HD-13.                                                       ECS152
   396     03  FILLER                  PIC X(7) VALUE '-'.              ECS152
   397     03  FILLER                  PIC X(33)                        ECS152
   398         VALUE '**** E X H I B I T   I T E M ****'.               ECS152
   399     03  FILLER                  PIC X(10) VALUE SPACES.          ECS152
   400     03  FILLER                  PIC X(30)                        ECS152
   401         VALUE '***** GROUP CERTIFICATES *****'.                  ECS152
   402     03  FILLER                  PIC X(10) VALUE SPACES.          ECS152
   403     03  FILLER                  PIC X(31)                        ECS152
   404         VALUE '***** INDIVIDUAL POLICIES *****'.                 ECS152
   405     03  FILLER                  PIC X(12) VALUE SPACES.          ECS152
   406                                                                  ECS152
   407 01  HD-14.                                                       ECS152
   408     03  FILLER                  PIC X(50) VALUE SPACES.          ECS152
   409     03  FILLER                  PIC X(16) VALUE '-COUNT-'.       ECS152
   410     03  FILLER                  PIC X(24) VALUE '----AMOUNT----'.ECS152
   411     03  FILLER                  PIC X(17) VALUE '-COUNT-'.       ECS152
   412     03  FILLER                  PIC X(26) VALUE '----AMOUNT----'.ECS152
   413                                                                  ECS152
   414 01  HD-15.                                                       ECS152
   415     03  FILLER                  PIC X(41) VALUE '-'.             ECS152
   416     03  FILLER                  PIC X(46)                        ECS152
   417         VALUE '****  A AND H CLAIMS PAID IN THIS PERIOD  ****'.  ECS152
   418     03  FILLER                  PIC X(46) VALUE SPACES.          ECS152
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  13
* ECS152.cbl
   420 01  DETAIL-1.                                                    ECS152
   421     03  FILLER                  PIC X VALUE SPACE.               ECS152
   422     03  D1-MSG                  PIC X(15) VALUE SPACES.          ECS152
   423     03  D1-ISS-CNT              PIC ZZZ,ZZZ-.                    ECS152
   424     03  D1-ISS-AMT              PIC ZZZZ,ZZZ,ZZZ.ZZ-.            ECS152
   425     03  D1-ISS-PRM              PIC ZZ,ZZZ,ZZZ.ZZ-.              ECS152
   426     03  FILLER                  PIC XX VALUE SPACES.             ECS152
   427     03  D1-CAN-CNT              PIC ZZZ,ZZZ-.                    ECS152
   428     03  D1-CAN-AMT              PIC ZZZZ,ZZZ,ZZZ.ZZ-.            ECS152
   429     03  D1-CAN-PRM              PIC ZZ,ZZZ,ZZZ.ZZ-.              ECS152
   430     03  FILLER                  PIC X VALUE SPACES.              ECS152
   431     03  D1-CLM-CNT              PIC ZZZ,ZZZ-.                    ECS152
   432     03  D1-CLM-AMT              PIC ZZ,ZZZ,ZZZ.ZZ-.              ECS152
   433     03  FILLER                  PIC X VALUE SPACE.               ECS152
   434     03  D1-ERN-AMT              PIC ZZZ,ZZZ,ZZZ.ZZ-.             ECS152
   435                                                                  ECS152
   436 01  DETAIL-2.                                                    ECS152
   437     03  FILLER                  PIC X(7) VALUE SPACES.           ECS152
   438     03  D2-MSG                  PIC X(34) VALUE SPACES.          ECS152
   439     03  FILLER                  PIC X(6) VALUE SPACES.           ECS152
   440     03  D2-GRP-CNT              PIC ZZ,ZZZ,ZZZ-.                 ECS152
   441     03  FILLER                  PIC X(6) VALUE SPACES.           ECS152
   442     03  D2-GRP-AMT              PIC ZZ,ZZZ,ZZZ,ZZZ.ZZ-.          ECS152
   443     03  FILLER                  PIC X(5) VALUE SPACES.           ECS152
   444     03  D2-IND-CNT              PIC ZZ,ZZZ,ZZZ-.                 ECS152
   445     03  FILLER                  PIC X(7) VALUE SPACES.           ECS152
   446     03  D2-IND-AMT              PIC ZZ,ZZZ,ZZZ,ZZZ.ZZ-.          ECS152
   447     03  FILLER                  PIC X(10) VALUE SPACES.          ECS152
   448                                                                  ECS152
   449 01  WORK-INDEX.                                                  ECS152
   450     03 Y                        PIC S9(2) COMP.                  ECS152
   451     03 Z                        PIC S9(2) COMP.                  ECS152
   452                                                                  ECS152
   453 01  DETAIL-3.                                                    ECS152
   454     03  FILLER                  PIC X(41) VALUE SPACES.          ECS152
   455     03  D3-MSG                  PIC X(27) VALUE SPACES.          ECS152
   456     03  D3-AH-AMT               PIC ZZ,ZZZ,ZZZ,ZZZ.99-.          ECS152
   457     03  FILLER                  PIC X(47) VALUE SPACES.          ECS152
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  14
* ECS152.cbl
   459 01  MONTH-TABLE.                                                 ECS152
   460     03  FILLER                  PIC X(10) VALUE 'JANUARY   '.    ECS152
   461     03  FILLER                  PIC X(10) VALUE 'FEBRUARY  '.    ECS152
   462     03  FILLER                  PIC X(10) VALUE 'MARCH     '.    ECS152
   463     03  FILLER                  PIC X(10) VALUE 'APRIL     '.    ECS152
   464     03  FILLER                  PIC X(10) VALUE 'MAY       '.    ECS152
   465     03  FILLER                  PIC X(10) VALUE 'JUNE      '.    ECS152
   466     03  FILLER                  PIC X(10) VALUE 'JULY      '.    ECS152
   467     03  FILLER                  PIC X(10) VALUE 'AUGUST    '.    ECS152
   468     03  FILLER                  PIC X(10) VALUE 'SEPTEMBER '.    ECS152
   469     03  FILLER                  PIC X(10) VALUE 'OCTOBER   '.    ECS152
   470     03  FILLER                  PIC X(10) VALUE 'NOVEMBER  '.    ECS152
   471     03  FILLER                  PIC X(10) VALUE 'DECEMBER  '.    ECS152
   472                                                                  ECS152
   473 01  MONTH-TABLE-A     REDEFINES MONTH-TABLE.                     ECS152
   474     03  MONTH-SUB               OCCURS 12 TIMES.                 ECS152
   475         05  MONTH-ALPHA         PIC X(10).                       ECS152
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  15
* ECS152.cbl
   477 01  TABLE-1.                                                     ECS152
   478     03  TABLE-1-GRP     OCCURS 3 TIMES.                          ECS152
   479         05  TABLE-1-DTL OCCURS 10 TIMES.                         ECS152
   480             07  TBL-ISSUE-CNT   PIC S9(13)          COMP-3.      ECS152
   481             07  TBL-ISSUE-AMT   PIC S9(11)V99       COMP-3.      ECS152
   482             07  TBL-ISSUE-PREM  PIC S9(11)V99       COMP-3.      ECS152
   483             07  TBL-CANCEL-CNT  PIC S9(13)          COMP-3.      ECS152
   484             07  TBL-CANCEL-AMT  PIC S9(11)V99       COMP-3.      ECS152
   485             07  TBL-CANCEL-PREM PIC S9(11)V99       COMP-3.      ECS152
   486             07  TBL-CLAIM-CNT   PIC S9(13)          COMP-3.      ECS152
   487             07  TBL-CLAIM-AMT   PIC S9(11)V99       COMP-3.      ECS152
   488             07  TBL-EARN-PREM   PIC S9(11)V99       COMP-3.      ECS152
   489                                                                  ECS152
   490 01  TABLE-2.                                                     ECS152
   491     03  TABLE-2-GRP     OCCURS 3 TIMES.                          ECS152
   492         05  TBL-2-DTL   OCCURS 9 TIMES.                          ECS152
   493             07  TBL-GRP-CNT     PIC S9(13)          COMP-3.      ECS152
   494             07  TBL-GRP-AMT     PIC S9(11)V99       COMP-3.      ECS152
   495             07  TBL-IND-CNT     PIC S9(13)          COMP-3.      ECS152
   496             07  TBL-IND-AMT     PIC S9(11)V99       COMP-3.      ECS152
   497                                                                  ECS152
   498 01  TABLE-3.                                                     ECS152
   499     03  TABLE-3-GRP     OCCURS 9 TIMES.                          ECS152
   500         05  T3-GRP-CNT          PIC S9(13)          COMP-3.      ECS152
   501         05  T3-GRP-AMT          PIC S9(11)V99       COMP-3.      ECS152
   502         05  T3-IND-CNT          PIC S9(13)          COMP-3.      ECS152
   503         05  T3-IND-AMT          PIC S9(11)V99       COMP-3.      ECS152
   504                                                                  ECS152
   505 01  TABLE-4.                                                     ECS152
   506     03  TABLE-4-GRP     OCCURS 3 TIMES.                          ECS152
   507         05  TABLE-4-DTL OCCURS 10 TIMES.                         ECS152
   508             07  T4-ISSUE-CNT    PIC S9(13)          COMP-3.      ECS152
   509             07  T4-ISSUE-AMT    PIC S9(11)V99       COMP-3.      ECS152
   510             07  T4-ISSUE-PREM   PIC S9(11)V99       COMP-3.      ECS152
   511             07  T4-CANCEL-CNT   PIC S9(13)          COMP-3.      ECS152
   512             07  T4-CANCEL-AMT   PIC S9(11)V99       COMP-3.      ECS152
   513             07  T4-CANCEL-PREM  PIC S9(11)V99       COMP-3.      ECS152
   514             07  T4-CLAIM-CNT    PIC S9(13)          COMP-3.      ECS152
   515             07  T4-CLAIM-AMT    PIC S9(11)V99       COMP-3.      ECS152
   516             07  T4-EARN-PREM    PIC S9(11)V99       COMP-3.      ECS152
   517                                                                  ECS152
   518 01  TABLE-5.                                                     ECS152
   519     03  TABLE-5-GRP     OCCURS 3 TIMES.                          ECS152
   520         05  TBL-5-DTL   OCCURS 9 TIMES.                          ECS152
   521             07  T5-GRP-CNT      PIC S9(13)          COMP-3.      ECS152
   522             07  T5-GRP-AMT      PIC S9(11)V99       COMP-3.      ECS152
   523             07  T5-IND-CNT      PIC S9(13)          COMP-3.      ECS152
   524             07  T5-IND-AMT      PIC S9(11)V99       COMP-3.      ECS152
   525                                                                  ECS152
   526 01  P1-MESS-R.                                                   ECS152
   527     03  FILLER                  PIC X(32)                        ECS152
   528         VALUE 'TERMS OF 1 MONTH THRU 120 MONTHS'.                ECS152
   529     03  FILLER                  PIC X(32)                        ECS152
   530         VALUE 'TERMS 61 MONTHS THRU 120 MONTHS '.                ECS152
   531     03  FILLER                  PIC X(32)                        ECS152
   532         VALUE 'TERMS GREATER THAN 120 MONTHS   '.                ECS152
   533                                                                  ECS152
   534 01  PAGE-1-MESSAGE REDEFINES P1-MESS-R.                          ECS152
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  16
* ECS152.cbl
   535     03  P1-MESS         OCCURS 3 TIMES.                          ECS152
   536         05  P1-MSG-1            PIC X(32).                       ECS152
   537                                                                  ECS152
   538 01  TABLE-FOR-PRINT-G.                                           ECS152
   539     03  REPORT-G-SWITCHES  OCCURS 3 TIMES.                       ECS152
   540         05  R-SW-G              PIC X.                           ECS152
   541                                                                  ECS152
   542 01  TABLE-FOR-PRINT-I.                                           ECS152
   543     03  REPORT-I-SWITCHES  OCCURS 3 TIMES.                       ECS152
   544         05  R-SW-I              PIC X.                           ECS152
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  17
* ECS152.cbl
   546 01  TOTAL-PRINT-AMOUNTS         COMP-3.                          ECS152
   547     03  G1-ISS-CNT              PIC S9(13).                      ECS152
   548     03  G1-ISS-AMT              PIC S9(11)V99.                   ECS152
   549     03  G1-ISS-PRM              PIC S9(11)V99.                   ECS152
   550     03  G1-CAN-CNT              PIC S9(13).                      ECS152
   551     03  G1-CAN-AMT              PIC S9(11)V99.                   ECS152
   552     03  G1-CAN-PRM              PIC S9(11)V99.                   ECS152
   553     03  G1-CLM-CNT              PIC S9(13).                      ECS152
   554     03  G1-CLM-AMT              PIC S9(11)V99.                   ECS152
   555     03  G1-ERN-PRM              PIC S9(11)V99.                   ECS152
   556                                                                  ECS152
   557 01  TOTAL-AMOUNTS               COMP-3.                          ECS152
   558     03  T1-ISS-CNT              PIC S9(13).                      ECS152
   559     03  T1-ISS-AMT              PIC S9(11)V99.                   ECS152
   560     03  T1-ISS-PRM              PIC S9(11)V99.                   ECS152
   561     03  T1-CAN-CNT              PIC S9(13).                      ECS152
   562     03  T1-CAN-AMT              PIC S9(11)V99.                   ECS152
   563     03  T1-CAN-PRM              PIC S9(11)V99.                   ECS152
   564     03  T1-CLM-CNT              PIC S9(13).                      ECS152
   565     03  T1-CLM-AMT              PIC S9(11)V99.                   ECS152
   566     03  T1-ERN-PRM              PIC S9(11)V99.                   ECS152
   567                                                                  ECS152
   568 01  TOT-AH-ACCUM.                                                ECS152
   569     03  TOT-AH-PD-THIS          PIC S9(11)V99 COMP-3.            ECS152
   570     03  TOT-AH-PD-LAST          PIC S9(11)V99 COMP-3.            ECS152
   571                                                                  ECS152
   572 01  GRAND-TOT-AH-ACCUM.                                          ECS152
   573     03  G-TOT-AH-PD-THIS        PIC S9(11)V99 COMP-3.            ECS152
   574     03  G-TOT-AH-PD-LAST        PIC S9(11)V99 COMP-3.            ECS152
   575                                                                  ECS152
   576 01  ZERO-FIELDS-1               COMP-3.                          ECS152
   577     03  FILLER                  PIC S9(13)      VALUE +0.        ECS152
   578     03  FILLER                  PIC S9(11)V99   VALUE +0.        ECS152
   579     03  FILLER                  PIC S9(11)V99   VALUE +0.        ECS152
   580     03  FILLER                  PIC S9(13)      VALUE +0.        ECS152
   581     03  FILLER                  PIC S9(11)V99   VALUE +0.        ECS152
   582     03  FILLER                  PIC S9(11)V99   VALUE +0.        ECS152
   583     03  FILLER                  PIC S9(13)      VALUE +0.        ECS152
   584     03  FILLER                  PIC S9(11)V99   VALUE +0.        ECS152
   585     03  FILLER                  PIC S9(11)V99   VALUE +0.        ECS152
   586                                                                  ECS152
   587 01  ZERO-FIELDS-2               COMP-3.                          ECS152
   588     03  FILLER                  PIC S9(13)      VALUE +0.        ECS152
   589     03  FILLER                  PIC S9(11)V99   VALUE +0.        ECS152
   590     03  FILLER                  PIC S9(13)      VALUE +0.        ECS152
   591     03  FILLER                  PIC S9(11)V99   VALUE +0.        ECS152
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  18
* ECS152.cbl
   593 01  CONTROL-AREA.                                                ECS152
   594     03  CONTROL-A.                                               ECS152
   595         05  CNTRL-REIN-CO       PIC X(6)  VALUE LOW-VALUES.      ECS152
   596         05  CNTRL-CARRIER       PIC X     VALUE LOW-VALUES.      ECS152
   597         05  CNTRL-COMPANY       PIC X(6)  VALUE LOW-VALUES.      ECS152
   598         05  CNTRL-STATE         PIC XX    VALUE LOW-VALUES.      ECS152
   599         05  CNTRL-ACCOUNT       PIC X(10) VALUE LOW-VALUES.      ECS152
   600     03  CNTRL-ST-SEQ            PIC XX    VALUE LOW-VALUES.      ECS152
   601     03  CNTRL-REC-TYPE          PIC 99    VALUE ZERO.            ECS152
   602                                                                  ECS152
   603 01  RANGE-DATES.                                                 ECS152
   604     03  CNTRL-START             PIC 9(11).                          CL**7
   605     03  CNTRL-END               PIC 9(11).                          CL**7
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  19
* ECS152.cbl
   607 01  THE-RECORD.                                                  ECS152
   608     03  ER-SORT-KEY.                                             ECS152
   609         05  ER-CONTROL.                                          ECS152
   610             07  ER-REINS-CO     PIC X(06).                       ECS152
   611             07  ER-CARRIER      PIC X(01).                       ECS152
   612             07  ER-COMPANY      PIC X(06).                       ECS152
   613             07  ER-STATE        PIC X(02).                       ECS152
   614             07  ER-ACCOUNT      PIC X(10).                       ECS152
   615         05  ER-ST-SEQ           PIC X(02).                       ECS152
   616         05  ER-REC-TYPE         PIC 99.                          ECS152
   617     03  ER-PERIOD-START         PIC 9(11)   COMP-3.                 CL**3
   618     03  ER-PERIOD-END           PIC 9(11)   COMP-3.                 CL**3
   619     03  ER-ACTIVITY-TOTALS.                                      ECS152
   620         05  ER-TERM-GROUP       OCCURS 3 TIMES.                  ECS152
   621*                1 = 0-60 MONTHS                                  ECS152
   622*                2 = 61-120 MONTHS                                ECS152
   623*                3 = 121 AND OVER.                                ECS152
   624             07  ER-TYPE-GROUPS  OCCURS 10 TIMES.                 ECS152
   625*                    1 = LIFE(R-GP)      6 = LIFE(R-IND)          ECS152
   626*                    2 = LIFE(L-GP)      7 = LIFE(L-IND)          ECS152
   627*                    3 = LIFE(OB-GP)     8 = LIFE(OB-IND)         ECS152
   628*                    4 = AH(GP)          9 = AH(IND)              ECS152
   629*                    5 = AH(OB-GP)      10 = AH(OB-IND)           ECS152
   630                 09  ER-ISSUE-CNT    PIC S9(13)      COMP-3.      ECS152
   631                 09  ER-ISSUE-AMT    PIC S9(11)V99   COMP-3.      ECS152
   632                 09  ER-ISSUE-PREM   PIC S9(11)V99   COMP-3.      ECS152
   633                 09  ER-CANCEL-CNT   PIC S9(13)      COMP-3.      ECS152
   634                 09  ER-CANCEL-AMT   PIC S9(11)V99   COMP-3.      ECS152
   635                 09  ER-CANCEL-PREM  PIC S9(11)V99   COMP-3.      ECS152
   636                 09  ER-CLAIM-CNT    PIC S9(13)      COMP-3.      ECS152
   637                 09  ER-CLAIM-AMT    PIC S9(11)V99   COMP-3.      ECS152
   638                 09  ER-EARN-PREM    PIC S9(11)V99   COMP-3.      ECS152
   639     03  ER-EXHIBIT-TOTALS.                                       ECS152
   640         05  ER-TERM-GROUP-E     OCCURS 3 TIMES.                  ECS152
   641*                1 = 0-60 MONTHS                                  ECS152
   642*                2 = 61-120 MONTHS                                ECS152
   643*                3 = 121 AND OVER                                 ECS152
   644             07  ER-LINE-DETAIL  OCCURS 9 TIMES.                  ECS152
   645*                1 = INFORCE PREVIOUS PER  6 = CANCEL IN PERIOD   ECS152
   646*                2 = ISSUED IN PERIOD      7 = DECREASES IN PERIODECS152
   647*                3 = TOTAL INFORCE-START   8 = TOTAL DEC IN PERIODECS152
   648*                4 = DEATHS IN PERIOD      9 = TOTAL INFORCE (END)ECS152
   649*                5 = EXPIRED IN PERIOD                            ECS152
   650                                                                  ECS152
   651                 09  ER-GROUP-CNT    PIC S9(13)      COMP-3.      ECS152
   652                 09  ER-GROUP-AMT    PIC S9(11)V99   COMP-3.      ECS152
   653                 09  ER-IND-CNT      PIC S9(13)      COMP-3.      ECS152
   654                 09  ER-IND-AMT      PIC S9(11)V99   COMP-3.      ECS152
   655                                                                  ECS152
   656     03  ER-AH-PD-THIS               PIC 9(11)V99    COMP-3.      ECS152
   657     03  ER-AH-PD-LAST               PIC 9(11)V99    COMP-3.      ECS152
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  20
* ECS152.cbl
*  659 COPY                       ELCDTECX.                                CL**3
   660******************************************************************06/05/98
   661*                                                                *ELCDTECX
   662*                            ELCDTECX.                           *   LV005
   663*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
   664*                            VMOD=2.015                          *ELCDTECX
   665*                                                                *ELCDTECX
   666*      WORKING STORAGE COPY CODE FOR APPLICATIONS CALLING        *ELCDTECX
   667*      THE DATE CARD DISK FILE. ( READ ROUTINE = ELCDTERX,       *ELCDTECX
   668*      AND DISK FILE FD = ELCDTEFX)                              *ELCDTECX
   669*                                                                *ELCDTECX
   670******************************************************************ELCDTECX
   671******************************************************************
   672*                   C H A N G E   L O G
   673*
   674* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   675*-----------------------------------------------------------------
   676*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   677* EFFECTIVE    NUMBER
   678*-----------------------------------------------------------------
   679* 092602    2002091900008  PEMA  INCREASE NUMBER OF MAXIMUM
   680*                                  BENEFIT CODES FROM 300 TO 900
   681* 090803    2003080800002  PEMA  ADD CATEGORY FOR SUPER GAP
   682* 051304    2003080800002  SMVA  ADD REFUND METHOD
   683* 071714    2013100100002  PEMA  FIX CRIT PERIOD EDITS
   684******************************************************************
   685 01  DATE-CARD.                                                   ELCDTECX
   686     12  DATX-COD                    PIC  X(4).                   ELCDTECX
   687     12  RUN-DATE                    PIC  9(11)  COMP-3.          ELCDTECX
   688     12  ALPH-DATE                   PIC  X(18).                  ELCDTECX
   689     12  EP-DT                       PIC  9(11)  COMP-3.          ELCDTECX
   690     12  PEND-ACT-FILE               PIC  XX.                     ELCDTECX
   691     12  EP-SW                       PIC  X.                      ELCDTECX
   692         88  NO-EP-EXTRACTS          VALUE SPACE.                 ELCDTECX
   693     12  TAPE-BATCHES                PIC  X.                      ELCDTECX
   694         88  TP-PREL-BAL             VALUE '1'.                   ELCDTECX
   695     12  BIN-RUN-DATE                PIC  XX.                     ELCDTECX
   696     12  RUN-CENTURY.                                             ELCDTECX
   697         16 RUN-CENTURY-N            PIC  99.                        CL**4
   698     12  FILLER                      PIC  X.                         CL**4
   699     12  CLAS-MORT-OVRD              PIC  X(4).                   ELCDTECX
   700     12  FILLER                      PIC  XXX.                    ELCDTECX
   701     12  COMPANY-NAME                PIC  X(30).                  ELCDTECX
   702                                                                  ELCDTECX
   703 01  FILLER                          PIC  X(7)                       CL**6
   704                                          VALUE 'OPTIONS'.        ELCDTECX
   705 01  DATE-CARD-OPTIONS.                                           ELCDTECX
   706     12  DATE-OPTIONS-ID             PIC  X(4).                   ELCDTECX
   707     12  DTE-MIN-PREM                PIC  99V99.                  ELCDTECX
   708     12  DTE-LANGUAGE-IND            PIC  X.                      ELCDTECX
   709         88  DTE-LANGUAGE-IS-FR           VALUE 'F'.              ELCDTECX
   710         88  DTE-LANGUAGE-IS-ENG          VALUE 'E'.              ELCDTECX
   711     12  DTE-MIN-AGE                 PIC  99.                     ELCDTECX
   712     12  DTE-DEFAULT-AGE             PIC  99.                     ELCDTECX
   713     12  FILLER                      PIC  X.                      ELCDTECX
   714     12  DTE-MAX-TERM                PIC  999.                    ELCDTECX
   715     12  DTE-COMP-VG                 PIC  X.                      ELCDTECX
   716     12  DTE-REM-TRM                 PIC  X.                      ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  21
* ECS152.cbl (/apps/prod/cid1p/copy/ELCDTECX)
   717     12  DTE-PRM-CK                  PIC S99V99.                  ELCDTECX
   718     12  DTE-PRORATA                 PIC  X.                      ELCDTECX
   719     12  DTE-CLM-REJ                 PIC  X.                      ELCDTECX
   720     12  DTE-REF-REJ                 PIC  X.                      ELCDTECX
   721     12  DTE-COM-TBL-USED            PIC  X.                      ELCDTECX
   722     12  FILLER                      PIC  X.                      ELCDTECX
   723     12  DTE-QTR-CO                  PIC  X.                      ELCDTECX
   724     12  DTE-REF-CK                  PIC S99V99.                  ELCDTECX
   725     12  DTE-CLM-CK                  PIC S99V99.                  ELCDTECX
   726     12  DTE-CONV-DT                 PIC 9(11) COMP-3.               CL**2
   727     12  DTE-DEFAULT-SEX             PIC  X.                      ELCDTECX
   728     12  DTE-EPL-FORMAT              PIC  X.                      ELCDTECX
   729     12  FILLER                      PIC  X.                      ELCDTECX
   730     12  DTE-JT-AGE                  PIC  X.                      ELCDTECX
   731     12  DTE-KEY-BIRTH               PIC  X.                      ELCDTECX
   732     12  DTE-REINSURANCE             PIC  X.                      ELCDTECX
   733     12  DTE-CLAIM-SORT              PIC  X.                      ELCDTECX
   734     12  DTE-WRT-OFF                 PIC  S99V99.                 ELCDTECX
   735     12  DTE-R78                     PIC  X.                      ELCDTECX
   736     12  DTE-DLY-BILL                PIC  X.                      ELCDTECX
   737     12  DTE-ALT-MORT-CODE           PIC  X(4).                   ELCDTECX
   738     12  DTE-CLAIM-PAID-THRU-TO      PIC  X.                      ELCDTECX
   739     12  DTE-COMPENSATION-ACCESS     PIC  X.                      ELCDTECX
   740     12  DTE-MORTG-ACCESS-CNTL       PIC  X.                      ELCDTECX
   741     12  DTE-MP-ALT-MORT-CODE        PIC  X(4).                   ELCDTECX
   742     12  DTE-MORTALITY-AGE-CALC-METHOD                            ELCDTECX
   743                                     PIC  X.                      ELCDTECX
   744         88  DTE-USE-TABLE-ASSIGNED-METHOD VALUE '1'              ELCDTECX
   745                                                 ' '.             ELCDTECX
   746         88  DTE-USE-ALL-AGE-LAST          VALUE '2'.             ELCDTECX
   747         88  DTE-USE-ALL-AGE-NEAR          VALUE '3'.             ELCDTECX
   748     12  DTE-RESERVE-OPTION-SWITCH   PIC  X.                      ELCDTECX
   749         88  DTE-OPT-RESERVE-METHOD-AUTH       VALUE 'Y'.         ELCDTECX
   750         88  DTE-OPT-RESERVE-METHOD-UNAUTH     VALUE 'N' ' '.     ELCDTECX
   751     12  DTE-REM-TRM-CALC-OPTION     PIC  X.                      ELCDTECX
   752     12  DTE-EXPERIENCE-RETENTION-AGE                             ELCDTECX
   753                                     PIC  9.                         CL**4
   754     12  DTE-SYSTEM.                                              ELCDTECX
   755         16  DTE-SYS-A-CREDIT        PIC  X.                      ELCDTECX
   756         16  DTE-SYS-B-PEND-CLAIM    PIC  X.                      ELCDTECX
   757         16  DTE-SYS-C-CONFIRMATIONS PIC  X.                      ELCDTECX
   758         16  DTE-SYS-D-DEMAND-BILL   PIC  X.                      ELCDTECX
   759         16  DTE-SYS-E-CLASIC-CLAIMS PIC  X.                      ELCDTECX
   760         16  DTE-SYS-F-CLASIC-CREDIT PIC  X.                      ELCDTECX
   761         16  DTE-SYS-G-AR-USED       PIC  X.                      ELCDTECX
   762         16  DTE-SYS-H               PIC  X.                      ELCDTECX
   763         16  DTE-SYS-I               PIC  X.                      ELCDTECX
   764         16  DTE-SYS-J               PIC  X.                      ELCDTECX
   765         16  DTE-SYS-K               PIC  X.                      ELCDTECX
   766         16  DTE-SYS-L               PIC  X.                      ELCDTECX
   767         16  DTE-SYS-M               PIC  X.                      ELCDTECX
   768         16  DTE-SYS-N               PIC  X.                      ELCDTECX
   769         16  DTE-SYS-O               PIC  X.                      ELCDTECX
   770         16  DTE-SYS-P               PIC  X.                      ELCDTECX
   771         16  DTE-SYS-Q               PIC  X.                      ELCDTECX
   772         16  DTE-SYS-R               PIC  X.                      ELCDTECX
   773         16  DTE-SYS-S               PIC  X.                      ELCDTECX
   774         16  DTE-SYS-T               PIC  X.                      ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  22
* ECS152.cbl (/apps/prod/cid1p/copy/ELCDTECX)
   775         16  DTE-SYS-U               PIC  X.                      ELCDTECX
   776         16  DTE-SYS-V               PIC  X.                      ELCDTECX
   777         16  DTE-SYS-W               PIC  X.                      ELCDTECX
   778         16  DTE-SYS-X               PIC  X.                      ELCDTECX
   779         16  DTE-SYS-Y               PIC  X.                      ELCDTECX
   780         16  DTE-SYS-Z               PIC  X.                      ELCDTECX
   781     12  FILLER                      REDEFINES DTE-SYSTEM.        ELCDTECX
   782         16  DTE-SYS-CODE            OCCURS 26 TIMES              ELCDTECX
   783                                     PIC  X.                      ELCDTECX
   784     12  DTE-CLIENT                  PIC  XXX.                    ELCDTECX
   785                                                                  ELCDTECX
   786 01  CLASIC-SYSTEM-CODES.                                         ELCDTECX
   787     12  DTE-COLC-ID                 PIC  X(4).                   ELCDTECX
   788     12  DTE-CLASIC-COMPANY-CD       PIC  X.                      ELCDTECX
   789     12  DTE-CLASIC-COMPANY-NUMBER   PIC  999.                    ELCDTECX
   790*    12  DTE-CLASIC-CLAIM-ACCESS     PIC  X.                      ELCDTECX
   791     12  FILLER                      PIC  X.                      ELCDTECX
   792     12  CLASIC-REIN-MAINT           PIC  XX.                     ELCDTECX
   793     12  CLASIC-COMP-MAINT           PIC  XX.                     ELCDTECX
   794     12  CLASIC-ACCT-MAINT           PIC  XX.                     ELCDTECX
   795     12  CLASIC-CTBL-MAINT           PIC  XX.                     ELCDTECX
   796     12  CLASIC-RATE-MAINT           PIC  XX.                     ELCDTECX
   797     12  CLASIC-CREDIT-EOM-DT        PIC  XX.                     ELCDTECX
   798     12  CLASIC-CLAIMS-EOM-DT        PIC  XX.                     ELCDTECX
   799                                                                  ELCDTECX
   800     12  LIFE-OVERRIDE-L1            PIC  X.                      ELCDTECX
   801     12  LIFE-OVERRIDE-L2            PIC  XX.                     ELCDTECX
   802     12  LIFE-OVERRIDE-L6            PIC  X(6).                   ELCDTECX
   803     12  LIFE-OVERRIDE-L12           PIC  X(12).                  ELCDTECX
   804                                                                  ELCDTECX
   805     12  AH-OVERRIDE-L1              PIC  X.                      ELCDTECX
   806     12  AH-OVERRIDE-L2              PIC  XX.                     ELCDTECX
   807     12  AH-OVERRIDE-L6              PIC  X(6).                   ELCDTECX
   808     12  AH-OVERRIDE-L12             PIC  X(12).                  ELCDTECX
   809                                                                  ELCDTECX
   810     12  CLAS-REPORT-CD1-CAPTION     PIC  X(10).                  ELCDTECX
   811     12  CLAS-REPORT-CD2-CAPTION     PIC  X(10).                  ELCDTECX
   812                                                                  ELCDTECX
   813     12  CLASIC-MORTG-EOM-DT         PIC  XX.                     ELCDTECX
   814     12  CLASIC-AR-EOM-DT            PIC  XX.                     ELCDTECX
   815                                                                  ELCDTECX
   816     12  FILLER                      PIC  X(11)      VALUE SPACE. ELCDTECX
   817                                                                  ELCDTECX
   818 01  DATE-CARD-FACTORS.                                           ELCDTECX
   819     12  DATE-FACTOR-ID              PIC  X(4).                   ELCDTECX
   820     12  FAC-1                       PIC S999V9(5).               ELCDTECX
   821     12  FAC-2                       PIC S999V9(5).               ELCDTECX
   822     12  FAC-3                       PIC S999V9(5).               ELCDTECX
   823     12  FAC-4                       PIC S999V9(5).               ELCDTECX
   824     12  FAC-5                       PIC S999V9(5).               ELCDTECX
   825     12  FAC-6                       PIC S999V9(5).               ELCDTECX
   826                                                                  ELCDTECX
   827 01  FILLER                          PIC  X(12)                   ELCDTECX
   828                                          VALUE 'COMPANY NAME'.   ELCDTECX
   829 01  COMPANY-NAME-TABLE.                                          ELCDTECX
   830     12  C-N-TBL                     OCCURS 6 TIMES.              ELCDTECX
   831         16  CNT-ID                  PIC  X.                      ELCDTECX
   832         16  CNT-NAME                PIC  X(30).                  ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  23
* ECS152.cbl (/apps/prod/cid1p/copy/ELCDTECX)
   833                                                                  ELCDTECX
   834 01  FILLER                          PIC  X(11)                   ELCDTECX
   835                                          VALUE 'STATE NAMES'.    ELCDTECX
   836 01  STATE-NAMES.                                                 ELCDTECX
   837     12  STATE-NAME-FLD              OCCURS 75 TIMES.             ELCDTECX
   838         16  STATE-SUB               PIC  XX.                     ELCDTECX
   839         16  STATE-PIC1.                                          ELCDTECX
   840             20  STATE-ABBR          PIC  XX.                     ELCDTECX
   841             20  FILLER              PIC  XXX.                    ELCDTECX
   842             20  STATE-PIC           PIC  X(20).                  ELCDTECX
   843             20  STATE-CALL-EARN     PIC  X.                      ELCDTECX
   844             20  STATE-CALL-BREAK    PIC  X.                      ELCDTECX
   845             20  STATE-PRIM-FAC-DEV  PIC  XXX.                    ELCDTECX
   846                                                                  ELCDTECX
   847 01  FILLER                          PIC  X(13)                   ELCDTECX
   848                                          VALUE 'CARRIER NAMES'.  ELCDTECX
   849 01  CARRIER-NAMES.                                               ELCDTECX
   850     12  CARRIER-NAME-FLD            OCCURS 25 TIMES.             ELCDTECX
   851         16  CARRIER-SUB             PIC  X.                      ELCDTECX
   852         16  CARRIER-DOM-ST          PIC  XX.                     ELCDTECX
   853         16  CARRIER-PIC             PIC  X(30).                  ELCDTECX
   854         16  CARRIER-UEP-PCT         PIC  S9V9(4) COMP-3.            CL**6
   855         16  CARRIER-R78-PCT         PIC  S9V9(4) COMP-3.            CL**6
   856         16  CARRIER-PRO-PCT         PIC  S9V9(4) COMP-3.            CL**6
   857*        16  FILLER                  PIC  X.                      ELCDTECX
   858         16  CARRIER-SEC-PAY         PIC  X.
   859             88  SEC-PAY-CARRIER          VALUE 'Y'.
   860                                                                  ELCDTECX
   861 01  FILLER                          PIC  X(9)                       CL**6
   862                                          VALUE 'INS TYPES'.      ELCDTECX
   863 01  CLAS-INS-TYPES.                                              ELCDTECX
   864*    12 CLAS-ALL-TYPES               OCCURS 300 TIMES.            ELCDTECX
   865     12 CLAS-ALL-TYPES               OCCURS 900 TIMES.            ELCDTECX
   866         16  CLAS-I-BEN              PIC  XX.                     ELCDTECX
   867         16  CLAS-I-AB3.                                          ELCDTECX
   868             20  FILLER              PIC  X.                      ELCDTECX
   869             20  CLAS-I-AB2.                                      ELCDTECX
   870                 24  FILLER          PIC  X.                      ELCDTECX
   871                 24  CLAS-I-AB1      PIC  X.                      ELCDTECX
   872         16  CLAS-I-AB3-AH REDEFINES CLAS-I-AB3.                  ELCDTECX
   873             20  CLAS-EXCLUSION      PIC  XX.                        CL**4
   874             20  FILLER              PIC  X.                         CL**4
   875         16  CLAS-I-AB10.                                         ELCDTECX
   876             20  FILLER              PIC  X(9).                   ELCDTECX
   877             20  CLAS-I-REIN-YN      PIC  X.                      ELCDTECX
   878         16  CLAS-I-COMMENT          PIC  X(10).                  ELCDTECX
   879         16  CLAS-I-JOINT            PIC  X.                      ELCDTECX
   880         16  CLAS-I-RL-AH            PIC  X.                      ELCDTECX
   881         16  CLAS-I-CALC-TYPE.                                    ELCDTECX
   882             20  CLAS-I-BAL          PIC  X.                      ELCDTECX
   883         16  CLAS-I-EP               PIC  X.                      ELCDTECX
   884         16  CLAS-CO-BEN-I-G-CD      PIC  X.                      ELCDTECX
   885         16  CLAS-CO-REM-TERM-CALC   PIC  X.                      ELCDTECX
   886         16  CLAS-I-BEN-CATEGORY     PIC  X.
   887         16  CLAS-I-REFUND-METHOD    PIC  X.
   888         16  CLAS-I-MAX-BENEFITS     PIC 99.
   889         16  FILLER                  PIC  XXX.
   890                                                                  ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  24
* ECS152.cbl (/apps/prod/cid1p/copy/ELCDTECX)
   891 01  FILLER                          PIC  X(16)                   ELCDTECX
   892                                     VALUE 'MORTALITY TABLES'.    ELCDTECX
   893 01  CLAS-MORTALITY-CODES.                                        ELCDTECX
   894     12  CLAS-MORT-FLD               OCCURS 99 TIMES              ELCDTECX
   895                                     INDEXED BY CLAS-MORT-NDX.    ELCDTECX
   896         16  CLAS-MORT-CODE          PIC  X(4).                      CL**6
   897         16  CLAS-MORT-J-CODE        PIC  X.                         CL**5
   898         16  CLAS-MORT-J-FACT        PIC S9V9(4).                    CL**6
   899         16  CLAS-MORT-DESC.                                      ELCDTECX
   900             20  CLAS-RESERVE-ADJ    PIC  999.                       CL**6
   901             20  FILLER              PIC  XX.                        CL**5
   902             20  CLAS-YEAR           PIC  X(4).                      CL**6
   903             20  FILLER              PIC  X.                         CL**5
   904             20  CLAS-TABLE-TYPE     PIC  XXX.                       CL**6
   905             20  FILLER              PIC  X.                         CL**5
   906             20  CLAS-AGE-METHOD     PIC  XX.                        CL**5
   907             20  FILLER              PIC  X.                         CL**5
   908             20  CLAS-INTEREST       PIC  99.99.                     CL**5
   909             20  FILLER              PIC  X(5).                      CL**6
   910                                                                  ELCDTECX
   911 01  FILLER                          PIC  X(15)                   ELCDTECX
   912                                     VALUE 'BUSINESS TABLES'.     ELCDTECX
   913 01  CLAS-BUSINESS-CLASSES.                                       ELCDTECX
   914     12  CLAS-BUSC-FLD               OCCURS 50 TIMES.             ELCDTECX
   915         16  CLAS-BUSC-CODE          PIC  99.                     ELCDTECX
   916         16  CLAS-BUSC-GROUP         PIC  X.                      ELCDTECX
   917         16  CLAS-BUSC-DESC          PIC  X(19).                  ELCDTECX
   918         16  CLAS-BUSC-EXCL          PIC  X.                         CL**5
   919         16  FILLER                  PIC  X(4).                      CL**6
   920                                                                  ELCDTECX
   921 01  FILLER                          PIC  X(7)                       CL**6
   922                                     VALUE 'INDEXES'.             ELCDTECX
   923 01  CLAS-INDEX-TBL.                                              ELCDTECX
   924     12  CLAX-ID                     PIC  X(4).                   ELCDTECX
   925     12  CLAS-STARTC                 PIC S9(4) COMP.              ELCDTECX
   926     12  CLAS-MAXC                   PIC S9(4) COMP.              ELCDTECX
   927     12  CLAS-STARTL                 PIC S9(4) COMP.              ELCDTECX
   928     12  CLAS-MAXL                   PIC S9(4) COMP.              ELCDTECX
   929     12  CLAS-STARTA                 PIC S9(4) COMP.              ELCDTECX
   930     12  CLAS-MAXA                   PIC S9(4) COMP.              ELCDTECX
   931     12  CLAS-STARTM                 PIC S9(4) COMP.              ELCDTECX
   932     12  CLAS-MAXM                   PIC S9(4) COMP.              ELCDTECX
   933     12  CLAS-STARTB                 PIC S9(4) COMP.              ELCDTECX
   934     12  CLAS-MAXB                   PIC S9(4) COMP.              ELCDTECX
   935     12  CLAS-STARTS                 PIC S9(4) COMP.              ELCDTECX
   936     12  CLAS-MAXS                   PIC S9(4) COMP.              ELCDTECX
   937     12  CLAS-STARTE                 PIC S9(4) COMP.              ELCDTECX
   938     12  CLAS-MAXE                   PIC S9(4) COMP.              ELCDTECX
   939     12  CLAS-STARTCN                PIC S9(4) COMP.              ELCDTECX
   940     12  CLAS-MAXCN                  PIC S9(4) COMP.              ELCDTECX
   941                                                                  ELCDTECX
   942 01  CLAS-TYPE-MISC.                                              ELCDTECX
   943     12  CLAS-INDEXC                 PIC S9(4) COMP.              ELCDTECX
   944     12  CLAS-INDEXL                 PIC S9(4) COMP.              ELCDTECX
   945     12  CLAS-INDEXA                 PIC S9(4) COMP.              ELCDTECX
   946     12  CLAS-INDEXM                 PIC S9(4) COMP.              ELCDTECX
   947     12  CLAS-INDEXB                 PIC S9(4) COMP.              ELCDTECX
   948     12  CLAS-INDEXS                 PIC S9(4) COMP.              ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  25
* ECS152.cbl (/apps/prod/cid1p/copy/ELCDTECX)
   949     12  CLAS-INDEXE                 PIC S9(4) COMP.              ELCDTECX
   950     12  CLAS-INDEX                  PIC S9(4) COMP.              ELCDTECX
   951     12  CLAS-INDEXEN                PIC S9(4) COMP.              ELCDTECX
   952     12  CLAS-INDEXCN                PIC S9(4) COMP.              ELCDTECX
   953     12  CLAS-INDEXON                PIC S9(4) COMP.              ELCDTECX
   954                                                                  ELCDTECX
   955 01  FILLER                          PIC  X(13)                   ELCDTECX
   956                                     VALUE 'MISCELLANEOUS'.       ELCDTECX
   957 01  CLAS-MISC.                                                   ELCDTECX
   958     12  DTE-FICH                    PIC  X.                      ELCDTECX
   959         88  FICH-NO                 VALUE SPACE.                 ELCDTECX
   960         88  FICH-ONLY               VALUE '1'.                   ELCDTECX
   961         88  FICH-BOTH               VALUE '2'.                   ELCDTECX
   962     12  FICH-OPEN                   PIC  X.                      ELCDTECX
   963     12  REPT-OPEN                   PIC  X.                      ELCDTECX
   964     12  DTE-PGM-OPT                 PIC  9.                         CL**5
   965     12  DTE-PRT-OPT                 PIC  X.                      ELCDTECX
   966     12  DTE-FMT-OPT                 PIC  9.                      ELCDTECX
   967     12  DTE-PRC-OPT                 PIC  9.                      ELCDTECX
   968     12  DTE-TOT-OPT                 PIC  9.                      ELCDTECX
   969     12  CLAS-LOOK                   PIC  XX.                     ELCDTECX
   970     12  DTE-TOT-LINES               PIC S9(8)      COMP.         ELCDTECX
   971     12  STATE-L                     PIC  XX.                     ELCDTECX
   972     12  CLAS-CN                     PIC  99.                     ELCDTECX
   973     12  CLAS-CO                     PIC  99.                     ELCDTECX
   974     12  DTE-VSAM-FLAGS                              VALUE ZERO.  ELCDTECX
   975         16  DTE-F-1                 PIC  X.                      ELCDTECX
   976         16  DTE-F-2                 PIC  X.                      ELCDTECX
   977     12  DTE-ABEND-WORK.                                          ELCDTECX
   978         16  DTE-ABEND-CD-1          PIC  XX         VALUE SPACES.ELCDTECX
   979         16  DTE-ABEND-CD-2          PIC  XX         VALUE SPACES.ELCDTECX
   980                                                                  ELCDTECX
   981 01  FILLER                          PIC  X(12)                   ELCDTECX
   982                                     VALUE 'WORKING DATE'.        ELCDTECX
   983 01  WS-DATE-AND-TIME.                                            ELCDTECX
   984     12  WS-ACCEPT-DATE.                                          ELCDTECX
   985         16  WS-AD-YY                PIC  99.                     ELCDTECX
   986         16  WS-AD-MM                PIC  99.                     ELCDTECX
   987         16  WS-AD-DD                PIC  99.                     ELCDTECX
   988     12  WS-CURRENT-DATE.                                         ELCDTECX
   989         16  WS-CD-MM                PIC  99.                     ELCDTECX
   990         16  FILLER                  PIC  X          VALUE '/'.   ELCDTECX
   991         16  WS-CD-DD                PIC  99.                     ELCDTECX
   992         16  FILLER                  PIC  X          VALUE '/'.   ELCDTECX
   993         16  WS-CD-YY                PIC  99.                     ELCDTECX
   994     12  WS-TIME-OF-DAY.                                          ELCDTECX
   995         16  WS-TIME                 PIC  9(6).                   ELCDTECX
   996         16  WS-HUN-SEC              PIC  99.                     ELCDTECX
   997                                                                  ELCDTECX
   998 01  FILLER                          PIC  X(12)                   ELCDTECX
   999                                     VALUE 'CARRIER CLMS'.        ELCDTECX
  1000 01  CARRIER-OPT-CLAIM-DATA.                                      ELCDTECX
  1001     12  CARRIER-FLDS                OCCURS 25 TIMES.             ELCDTECX
  1002         16  CARRIER-IBNR-SWITCH     PIC  X.                         CL**5
  1003         16  CARRIER-IBNR-PERCENT    PIC S9V9(4) COMP-3.             CL**6
  1004         16  CARRIER-CIDA-DISCOUNT   PIC S9V9(4) COMP-3.             CL**6
  1005                                                                  ELCDTECX
  1006 01  FILLER                          PIC  X(10)                   ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  26
* ECS152.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  1007                                     VALUE 'STATE TLRS'.          ELCDTECX
  1008 01  STATE-TARGET-LOSS-RATIOS.                                    ELCDTECX
  1009     12  STATE-TLR-FLD               OCCURS 75 TIMES.             ELCDTECX
  1010         16  STATE-TARGET-LOSS-RATIO PIC S9V9(4) COMP-3.             CL**6
  1011         16  STATE-CALC-INTEREST     PIC S9V9(4) COMP-3.             CL**6
  1012                                                                  ELCDTECX
  1013 01  FILLER                          PIC  X(13)                   ELCDTECX
  1014                                     VALUE 'BUSINESS TLRS'.       ELCDTECX
  1015 01  BUSINESS-TRGT-LOSS-RATIO-MODS.                               ELCDTECX
  1016     12  BUS-TLRM-FLD                OCCURS 99 TIMES.             ELCDTECX
  1017         16  BUS-TRGT-LOSS-RATIO-MOD PIC S9V9(4) COMP-3.             CL**6
  1018                                                                  ELCDTECX
  1019 01  FILLER                          PIC  X(13)                   ELCDTECX
  1020                                     VALUE 'MISC CLM DATA'.       ELCDTECX
  1021 01  MISC-OPT-CLM-RSV-DATA.                                       ELCDTECX
  1022     12  COMPANY-CALC-INTEREST       PIC S9V9(4) COMP-3.             CL**6
  1023     12  COMPANY-CIDA-DISCOUNT       PIC S9V9(4) COMP-3.             CL**6
  1024     12  COMPANY-CRDB-TABLE-SELECTION                             ELCDTECX
  1025                                     PIC  X.                         CL**5
  1026     12  COMPANY-IBNR-AH-FACTOR      PIC S9V9(4) COMP-3.             CL**6
  1027     12  COMPANY-IBNR-LAG-MONTH      PIC S999    COMP-3.             CL**6
  1028     12  COMPANY-IBNR-LIFE-FACTOR    PIC S9V9(4) COMP-3.             CL**6
  1029     12  COMPANY-OPTION-START-DATE   PIC  XX.                        CL**5
  1030     12  INDEXBS                     PIC S9(4)   COMP.               CL**6
  1031     12  INDEXCA                     PIC S9(4)   COMP.               CL**6
  1032     12  INDEXST                     PIC S9(4)   COMP.               CL**6
  1033     12  FILLER                      PIC  X(75).                  ELCDTECX
  1034******************************************************************ELCDTECX
  1035*01  MISC-CARR-PCT-DATA.                                          00001521
  1036*    12  DD-CARR1-UEP-PCT            PIC S9V9(4) COMP-3.          00001522
  1037*    12  DD-CARR1-R78-PCT            PIC S9V9(4) COMP-3.          00001522
  1038*    12  DD-CARR1-PRO-PCT            PIC S9V9(4) COMP-3.          00001522
  1039*    12  DD-CARR2-UEP-PCT            PIC S9V9(4) COMP-3.          00001522
  1040*    12  DD-CARR2-R78-PCT            PIC S9V9(4) COMP-3.          00001522
  1041*    12  DD-CARR2-PRO-PCT            PIC S9V9(4) COMP-3.          00001522
  1042******************************************************************ELCDTECX
  1043                                                                  ECS152
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  27
* ECS152.cbl
* 1045 COPY                       ELCDTEVR.                                CL**3
  1046***************************************************************** 04/15/98
  1047*                                                                *ELCDTEVR
  1048*                                                                *ELCDTEVR
  1049*                            ELCDTEVR.                           *   LV003
  1050*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
  1051*                            VMOD=2.001                          *   CL**2
  1052*                                                                *ELCDTEVR
  1053*   WORKING STORAGE FOR DATE VARIABLES CREATED                   *ELCDTEVR
  1054*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCDTEVR
  1055*                                                                *ELCDTEVR
  1056******************************************************************ELCDTEVR
  1057 01  WS-DATE-CARD-DATE.                                           ELCDTEVR
  1058     05  WS-RUN-DATE.                                             ELCDTEVR
  1059         10  FILLER                  PIC  9(03).                  ELCDTEVR
  1060         10  RUN-CCYY                PIC  9(04).                  ELCDTEVR
  1061         10  RUN-CCYR  REDEFINES  RUN-CCYY.                       ELCDTEVR
  1062             15  RUN-CC              PIC  99.                     ELCDTEVR
  1063             15  RUN-YR              PIC  99.                     ELCDTEVR
  1064         10  RUN-MO                  PIC  99.                     ELCDTEVR
  1065         10  RUN-DA                  PIC  99.                     ELCDTEVR
  1066     05  WS-RUN-DATE-N REDEFINES                                     CL**2
  1067            WS-RUN-DATE              PIC 9(11).                      CL**2
  1068     05  WS-EP-DT.                                                ELCDTEVR
  1069         10  FILLER                  PIC  9(03).                  ELCDTEVR
  1070         10  EP-CCYY                 PIC  9(04).                  ELCDTEVR
  1071         10  EP-CCYR  REDEFINES  EP-CCYY.                         ELCDTEVR
  1072             15  EP-CC               PIC  99.                     ELCDTEVR
  1073             15  EP-YR               PIC  99.                     ELCDTEVR
  1074         10  EP-MO                   PIC  99.                     ELCDTEVR
  1075         10  EP-DA                   PIC  99.                     ELCDTEVR
  1076     05  WS-EP-DT-N REDEFINES                                        CL**2
  1077            WS-EP-DT                 PIC 9(11).                      CL**2
  1078     05  WS-DTE-CONV-DT.                                             CL**4
  1079         10  FILLER                  PIC  9(03).                     CL**4
  1080         10  DTE-CONV-CCYY           PIC  9(04).                     CL**4
  1081         10  DTE-CONV-CCYR  REDEFINES  DTE-CONV-CCYY.                CL**4
  1082             15  DTE-CONV-CC         PIC  99.                        CL**4
  1083             15  DTE-CONV-YR         PIC  99.                        CL**4
  1084         10  DTE-CONV-MO             PIC  99.                        CL**4
  1085         10  DTE-CONV-DA             PIC  99.                        CL**4
  1086     05  WS-DTE-CONV-DT-N REDEFINES                                  CL**4
  1087            WS-DTE-CONV-DT           PIC  9(11).                     CL**4
  1088 01  WS-BALANCE-FORWARD-DATE.                                     ELCDTEVR
  1089     05  WS-BF-LAST-ACTIVITY-DATE.                                ELCDTEVR
  1090         10  FILLER                            PIC 999.           ELCDTEVR
  1091         10  BF-ACT-CCYY                       PIC 9(04).         ELCDTEVR
  1092         10  BF-ACT-CCYR  REDEFINES  BF-ACT-CCYY.                 ELCDTEVR
  1093             15  BF-ACT-CC                     PIC 99.            ELCDTEVR
  1094             15  BF-ACT-YEAR                   PIC 99.            ELCDTEVR
  1095         10  BF-ACT-MONTH                      PIC 99.            ELCDTEVR
  1096         10  BF-ACT-DAY                        PIC 99.            ELCDTEVR
  1097     05  WS-BF-LAST-ACTIVITY-DATE-N REDEFINES                        CL**2
  1098            WS-BF-LAST-ACTIVITY-DATE           PIC 9(11).            CL**2
  1099     05  WS-BF-CURRENT-LAST-STMT-DT.                              ELCDTEVR
  1100         10  FILLER                            PIC 999.           ELCDTEVR
  1101         10  BF-CURRENT-LAST-STMT-CEN          PIC 99.            ELCDTEVR
  1102         10  BF-CURRENT-LAST-STMT-YEAR         PIC 99.            ELCDTEVR
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  28
* ECS152.cbl (/apps/prod/cid1p/copy/ELCDTEVR)
  1103         10  BF-CURRENT-LAST-STMT-MONTH        PIC 99.            ELCDTEVR
  1104         10  BF-CURRENT-LAST-STMT-DAY          PIC 99.            ELCDTEVR
  1105     05  WS-BF-CURRENT-LAST-STMT-DT-N REDEFINES                      CL**2
  1106            WS-BF-CURRENT-LAST-STMT-DT        PIC 9(11).             CL**2
  1107 01  WS-ADD-CONF-TRANSACTIONS-DTE.                                ELCDTEVR
  1108     05  WS-AC-CERT-EFF-DATE.                                     ELCDTEVR
  1109         10  FILLER                            PIC 999.           ELCDTEVR
  1110         10  AC-CERT-CCYY                      PIC 9(04).         ELCDTEVR
  1111         10  AC-CERT-CCYR  REDEFINES  AC-CERT-CCYY.               ELCDTEVR
  1112             15  AC-CERT-CC                    PIC 99.            ELCDTEVR
  1113             15  AC-CERT-YR                    PIC 99.            ELCDTEVR
  1114         10  AC-CERT-MO                        PIC 99.            ELCDTEVR
  1115         10  AC-CERT-DA                        PIC 99.            ELCDTEVR
  1116     05  WS-AC-CERT-EFF-DATE-N REDEFINES                             CL**2
  1117            WS-AC-CERT-EFF-DATE                PIC 9(11).            CL**2
  1118     05  WS-AC-LIFE-CANCEL-DATE.                                  ELCDTEVR
  1119         10  FILLER                            PIC 999.           ELCDTEVR
  1120         10  AC-LIFE-CANCEL-CCYY               PIC 9(04).         ELCDTEVR
  1121         10  AC-LIFE-CANCEL-CCYR REDEFINES AC-LIFE-CANCEL-CCYY.   ELCDTEVR
  1122             15  AC-LIFE-CANCEL-CC             PIC 99.            ELCDTEVR
  1123             15  AC-LIFE-CANCEL-YR             PIC 99.            ELCDTEVR
  1124         10  AC-LIFE-CANCEL-MO                 PIC 99.            ELCDTEVR
  1125         10  AC-LIFE-CANCEL-DA                 PIC 99.            ELCDTEVR
  1126     05  WS-AC-LIFE-CANCEL-DATE-N REDEFINES                          CL**2
  1127            WS-AC-LIFE-CANCEL-DATE             PIC 9(11).            CL**2
  1128     05  WS-AC-AH-CANCEL-DATE.                                    ELCDTEVR
  1129         10  FILLER                            PIC 999.           ELCDTEVR
  1130         10  AC-AH-CANCEL-CCYY                 PIC 9(04).         ELCDTEVR
  1131         10  AC-AH-CANCEL-CCYR  REDEFINES  AC-AH-CANCEL-CCYY.     ELCDTEVR
  1132             15  AC-AH-CANCEL-CC               PIC 99.            ELCDTEVR
  1133             15  AC-AH-CANCEL-YR               PIC 99.            ELCDTEVR
  1134         10  AC-AH-CANCEL-MO                   PIC 99.            ELCDTEVR
  1135         10  AC-AH-CANCEL-DA                   PIC 99.            ELCDTEVR
  1136     05  WS-AC-AH-CANCEL-DATE-N REDEFINES                            CL**2
  1137            WS-AC-AH-CANCEL-DATE               PIC 9(11).            CL**2
  1138 01  WS-RATE-RECORD.                                              ELCDTEVR
  1139         05  WS-RT-EXPIRY-DATE.                                   ELCDTEVR
  1140             10  FILLER                        PIC 999.           ELCDTEVR
  1141             10  RT-EXP-CCYY                   PIC 9(04).         ELCDTEVR
  1142             10  RT-EXP-CCYR  REDEFINES  RT-EXP-CCYY.             ELCDTEVR
  1143                 15  RT-EXP-CC                 PIC 99.            ELCDTEVR
  1144                 15  RT-EXP-YR                 PIC 99.            ELCDTEVR
  1145             10  RT-EXP-MO                     PIC 99.            ELCDTEVR
  1146             10  RT-EXP-DA                     PIC 99.            ELCDTEVR
  1147         05  WS-RT-EXPIRY-DATE-N REDEFINES                           CL**2
  1148                WS-RT-EXPIRY-DATE              PIC 9(11).            CL**2
  1149                                                                     CL**3
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  29
* ECS152.cbl
  1151 PROCEDURE DIVISION.                                              ECS152
  1152 0100-READ-DATE.                                                  ECS152
  1153
  1154     ACCEPT      WS-REPORT-TITLE.
  1155
  1156     IF WS-REPORT-TITLE = 'NON CREDIT'
  1157        MOVE ' NON CREDIT '      TO HD-1-MSGA
  1158     ELSE
  1159        IF WS-REPORT-TITLE = 'CREDIT'
  1160           MOVE ' ONLY CREDIT '  TO HD-1-MSGA
  1161        ELSE
  1162           MOVE SPACES           TO HD-1-MSGA
  1163        END-IF
  1164     END-IF
  1165
* 1166                             COPY ELCDTERX.                       ECS152
  1167******************************************************************04/15/98
  1168*                                                                *ELCDTERX
  1169*                                                                *ELCDTERX
  1170*                            ELCDTERX.                           *   LV002
  1171*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  1172*                            VMOD=2.007                          *ELCDTERX
  1173*                                                                *ELCDTERX
  1174*      LOAD DATE CARD DISK FILE INTO WORKING STORAGE AREA        *ELCDTERX
  1175*      (COPY CODE FOR W/S = ELCDTECX AND COPY CODE FOR FD        *ELCDTERX
  1176*      = ELCDTEFD)                                               *ELCDTERX
  1177*                                                                *ELCDTERX
  1178******************************************************************ELCDTERX
  1179                                                                  ELCDTERX
  1180     ACCEPT WS-ACCEPT-DATE       FROM  DATE.                      ELCDTERX
  1181                                                                  ELCDTERX
  1182     MOVE WS-AD-YY               TO  WS-CD-YY.                    ELCDTERX
  1183     MOVE WS-AD-MM               TO  WS-CD-MM.                    ELCDTERX
  1184     MOVE WS-AD-DD               TO  WS-CD-DD.                    ELCDTERX
  1185                                                                  ELCDTERX
  1186     ACCEPT WS-TIME-OF-DAY       FROM  TIME.                      ELCDTERX
  1187                                                                  ELCDTERX
  1188******************************************************************ELCDTERX
  1189*    NOTE: THE FOLLOWING STATEMENT IS USED TO ELIMINATE COB II    ELCDTERX
  1190*          WARNING MESSAGES.                                      ELCDTERX
  1191******************************************************************ELCDTERX
  1192     IF WS-CD-YY = LOW-VALUES                                     ELCDTERX
  1193         COMPUTE PGM-SUB = PGM-SUB + 1.                           ELCDTERX
  1194                                                                  ELCDTERX
  1195     OPEN INPUT DISK-DATE.                                        ELCDTERX
  1196                                                                  ELCDTERX
  1197     MOVE SPACE TO DATE-CARD         CLAS-BUSINESS-CLASSES        ELCDTERX
  1198                   STATE-NAMES       CLAS-MORTALITY-CODES         ELCDTERX
  1199                   CLAS-INS-TYPES    COMPANY-NAME-TABLE           ELCDTERX
  1200                   DATE-CARD-OPTIONS DATE-CARD-FACTORS            ELCDTERX
  1201                   CLAX-ID           CLAS-MISC                    ELCDTERX
  1202                   CARRIER-NAMES     CLASIC-SYSTEM-CODES          ELCDTERX
  1203                   CARRIER-OPT-CLAIM-DATA                         ELCDTERX
  1204                   STATE-TARGET-LOSS-RATIOS                       ELCDTERX
  1205                   BUSINESS-TRGT-LOSS-RATIO-MODS                  ELCDTERX
  1206                   MISC-OPT-CLM-RSV-DATA.                         ELCDTERX
  1207                                                                  ELCDTERX
  1208     MOVE LOW-VALUES TO CLAS-INDEX-TBL CLAS-TYPE-MISC.            ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  30
* ECS152.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  1209                                                                  ELCDTERX
  1210     MOVE ZERO TO CLAS-CN DTE-TOT-LINES CLAS-CO                   ELCDTERX
  1211                  INDEXCA INDEXBS INDEXST.                        ELCDTERX
  1212                                                                  ELCDTERX
  1213     COMPUTE CLAS-CN = PGM-SUB / +50.                             ELCDTERX
  1214     COMPUTE CLAS-CO = PGM-SUB / +20.                             ELCDTERX
  1215     COMPUTE CLAS-INDEXEN = PGM-SUB - (CLAS-CN * +50).            ELCDTERX
  1216     COMPUTE CLAS-INDEXON = PGM-SUB - (CLAS-CO * +20).            ELCDTERX
  1217                                                                  ELCDTERX
  1218     IF CLAS-INDEXEN = ZERO                                       ELCDTERX
  1219         MOVE +50               TO CLAS-INDEXEN                   ELCDTERX
  1220     ELSE                                                         ELCDTERX
  1221         ADD +1                 TO CLAS-CN.                       ELCDTERX
  1222                                                                  ELCDTERX
  1223     IF CLAS-INDEXON = ZERO                                       ELCDTERX
  1224         MOVE +20               TO CLAS-INDEXON                   ELCDTERX
  1225     ELSE                                                         ELCDTERX
  1226         ADD +1                 TO CLAS-CO.                       ELCDTERX
  1227                                                                  ELCDTERX
  1228 0005-READ--CARD.                                                 ELCDTERX
  1229     READ DISK-DATE                                               ELCDTERX
  1230         AT END CLOSE DISK-DATE                                   ELCDTERX
  1231             GO TO 0060-READ--TEST.                               ELCDTERX
  1232                                                                  ELCDTERX
  1233     MOVE ZERO                   TO CLAS-INDEX.                   ELCDTERX
  1234                                                                  ELCDTERX
  1235     IF DD-ID = 'CLAS' OR 'LIFE' OR 'GLED'                        ELCDTERX
  1236         MOVE DATE-DISK          TO DATE-CARD                     ELCDTERX
  1237         MOVE RUN-DATE           TO WS-RUN-DATE-N                    CL**2
  1238         MOVE EP-DT              TO WS-EP-DT-N                       CL**2
  1239         GO TO 0005-READ--CARD.                                   ELCDTERX
  1240                                                                  ELCDTERX
  1241     IF DD-ID = 'CLAD'                                            ELCDTERX
  1242         MOVE DATE-DISK          TO DATE-CARD-OPTIONS             ELCDTERX
  1243         GO TO 0005-READ--CARD.                                   ELCDTERX
  1244                                                                  ELCDTERX
  1245     IF DD-ID = 'CLAX'                                            ELCDTERX
  1246         MOVE DATE-DISK          TO CLAS-INDEX-TBL                ELCDTERX
  1247         GO TO 0005-READ--CARD.                                   ELCDTERX
  1248                                                                  ELCDTERX
  1249     IF DD-ID = 'CLAF'                                            ELCDTERX
  1250         MOVE DATE-DISK          TO DATE-CARD-FACTORS             ELCDTERX
  1251         GO TO 0005-READ--CARD.                                   ELCDTERX
  1252                                                                  ELCDTERX
  1253     IF DD-ID = 'CLAC'                                            ELCDTERX
  1254         GO TO 0010-READ--CLAC.                                   ELCDTERX
  1255                                                                  ELCDTERX
  1256     IF DD-ID = 'CARR'                                            ELCDTERX
  1257         GO TO 0015-READ--CARR.                                   ELCDTERX
  1258                                                                  ELCDTERX
  1259     IF DD-ID = 'STAT'                                            ELCDTERX
  1260         GO TO 0020-READ--STAT.                                   ELCDTERX
  1261                                                                  ELCDTERX
  1262     IF DD-ID = 'BUSC'                                            ELCDTERX
  1263         GO TO 0025-READ--BUSC.                                   ELCDTERX
  1264                                                                  ELCDTERX
  1265     IF DD-ID = 'MORT'                                            ELCDTERX
  1266         GO TO 0030-READ--MORT.                                   ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  31
* ECS152.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  1267                                                                  ELCDTERX
  1268     IF DD-ID = 'CLAI'                                            ELCDTERX
  1269         GO TO 0040-READ--CLAI.                                   ELCDTERX
  1270                                                                  ELCDTERX
  1271     IF DD-ID = 'COLC'                                            ELCDTERX
  1272         GO TO 0065-READ--COLC.                                   ELCDTERX
  1273                                                                  ELCDTERX
  1274     IF DD-IDX NUMERIC AND                                        ELCDTERX
  1275        DD-IDA = 'CL'                                             ELCDTERX
  1276         GO TO 0035-READ--CLXX.                                   ELCDTERX
  1277                                                                  ELCDTERX
  1278     IF DD-IDX NUMERIC AND                                        ELCDTERX
  1279        DD-IDA = 'PO'                                             ELCDTERX
  1280         GO TO 0050-READ--POXX.                                   ELCDTERX
  1281                                                                  ELCDTERX
  1282     IF DD-ID = 'OPCA'                                            ELCDTERX
  1283         GO TO 0070-READ--OPCA.                                   ELCDTERX
  1284                                                                  ELCDTERX
  1285     IF DD-ID = 'OPST'                                            ELCDTERX
  1286         GO TO 0072-READ--OPST.                                   ELCDTERX
  1287                                                                  ELCDTERX
  1288     IF DD-ID = 'OPBS'                                            ELCDTERX
  1289         GO TO 0074-READ--OPBS.                                   ELCDTERX
  1290                                                                  ELCDTERX
  1291     IF DD-ID = 'OPMS'                                            ELCDTERX
  1292         MOVE DD-MISC-DATA       TO MISC-OPT-CLM-RSV-DATA.        ELCDTERX
  1293                                                                  ELCDTERX
  1294     GO TO 0005-READ--CARD.                                       ELCDTERX
  1295                                                                  ELCDTERX
  1296 0010-READ--CLAC.                                                 ELCDTERX
  1297     ADD 1                       TO CLAS-INDEXC.                  ELCDTERX
  1298     MOVE DD-CR1                 TO CNT-ID (CLAS-INDEXC).         ELCDTERX
  1299     MOVE DD-CR1N                TO CNT-NAME (CLAS-INDEXC).       ELCDTERX
  1300     ADD 1                       TO CLAS-INDEXC.                  ELCDTERX
  1301     MOVE DD-CR2                 TO CNT-ID (CLAS-INDEXC).         ELCDTERX
  1302     MOVE DD-CR2N                TO CNT-NAME (CLAS-INDEXC).       ELCDTERX
  1303     GO TO 0005-READ--CARD.                                       ELCDTERX
  1304                                                                  ELCDTERX
  1305 0015-READ--CARR.                                                 ELCDTERX
  1306     ADD 1  TO  CLAS-INDEXCN.                                     ELCDTERX
  1307     IF CLAS-INDEXCN LESS THAN +26                                ELCDTERX
  1308        MOVE DD-CARR1         TO CARRIER-SUB (CLAS-INDEXCN)
  1309        MOVE DD-CARR1S        TO CARRIER-DOM-ST (CLAS-INDEXCN)
  1310        MOVE DD-CARR1N        TO CARRIER-PIC (CLAS-INDEXCN)
  1311        MOVE DD-CARR1-UEP-PCT TO CARRIER-UEP-PCT (CLAS-INDEXCN)
  1312        MOVE DD-CARR1-R78-PCT TO CARRIER-R78-PCT (CLAS-INDEXCN)
  1313        MOVE DD-CARR1-PRO-PCT TO CARRIER-PRO-PCT (CLAS-INDEXCN)
  1314        MOVE DD-CARR1-SECPAY-SW
  1315                               TO CARRIER-SEC-PAY (CLAS-INDEXCN)
  1316     END-IF
  1317                                                                  ELCDTERX
  1318     ADD 1  TO  CLAS-INDEXCN.                                     ELCDTERX
  1319     IF CLAS-INDEXCN LESS THAN +26                                ELCDTERX
  1320        MOVE DD-CARR2         TO CARRIER-SUB (CLAS-INDEXCN)
  1321        MOVE DD-CARR2S        TO CARRIER-DOM-ST (CLAS-INDEXCN)
  1322        MOVE DD-CARR2N        TO CARRIER-PIC (CLAS-INDEXCN)
  1323        MOVE DD-CARR2-UEP-PCT TO CARRIER-UEP-PCT (CLAS-INDEXCN)
  1324        MOVE DD-CARR2-R78-PCT TO CARRIER-R78-PCT (CLAS-INDEXCN)
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  32
* ECS152.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  1325        MOVE DD-CARR2-PRO-PCT TO CARRIER-PRO-PCT (CLAS-INDEXCN)
  1326        MOVE DD-CARR2-SECPAY-SW
  1327                              TO CARRIER-SEC-PAY (CLAS-INDEXCN)
  1328     END-IF
  1329                                                                  ELCDTERX
  1330                                                                  ELCDTERX
  1331     GO TO 0005-READ--CARD.                                       ELCDTERX
  1332                                                                  ELCDTERX
  1333 0020-READ--STAT.                                                 ELCDTERX
  1334     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  1335     IF CLAS-INDEX GREATER 3  OR                                  ELCDTERX
  1336        DD-ST (CLAS-INDEX) = SPACE                                ELCDTERX
  1337         GO TO 0005-READ--CARD.                                   ELCDTERX
  1338                                                                  ELCDTERX
  1339     ADD 1                       TO CLAS-INDEXS.                  ELCDTERX
  1340     MOVE DD-ST (CLAS-INDEX)     TO STATE-NAME-FLD (CLAS-INDEXS). ELCDTERX
  1341     GO TO 0020-READ--STAT.                                       ELCDTERX
  1342                                                                  ELCDTERX
  1343 0025-READ--BUSC.                                                 ELCDTERX
  1344     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  1345     IF CLAS-INDEX GREATER 3  OR                                  ELCDTERX
  1346        DD-ST (CLAS-INDEX) = SPACE                                ELCDTERX
  1347         GO TO 0005-READ--CARD.                                   ELCDTERX
  1348                                                                  ELCDTERX
  1349     ADD 1                       TO CLAS-INDEXB.                  ELCDTERX
  1350     MOVE DD-ST (CLAS-INDEX)     TO CLAS-BUSC-FLD (CLAS-INDEXB).  ELCDTERX
  1351     GO TO 0025-READ--BUSC.                                       ELCDTERX
  1352                                                                  ELCDTERX
  1353 0030-READ--MORT.                                                 ELCDTERX
  1354     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  1355     IF CLAS-INDEX GREATER 2  OR                                  ELCDTERX
  1356        DD-MORT (CLAS-INDEX) = SPACE                              ELCDTERX
  1357         GO TO 0005-READ--CARD.                                   ELCDTERX
  1358                                                                  ELCDTERX
  1359     ADD 1                       TO CLAS-INDEXM.                  ELCDTERX
  1360     MOVE DD-MORT (CLAS-INDEX)   TO CLAS-MORT-FLD (CLAS-INDEXM).  ELCDTERX
  1361     GO TO 0030-READ--MORT.                                       ELCDTERX
  1362                                                                  ELCDTERX
  1363 0035-READ--CLXX.                                                 ELCDTERX
  1364     IF DD-IDX NOT = CLAS-CN                                      ELCDTERX
  1365          GO TO 0005-READ--CARD.                                  ELCDTERX
  1366                                                                  ELCDTERX
  1367     IF DD-PS-PIC (CLAS-INDEXEN) = 'X'                            ELCDTERX
  1368         DISPLAY '***********************************************'ELCDTERX
  1369         DISPLAY 'PROGRAM ECS-', PGM-SUB, ' NOT SCHEDULED TO RUN' ELCDTERX
  1370         DISPLAY '***********************************************'ELCDTERX
  1371         GO TO 0055-READ--STOP.                                   ELCDTERX
  1372                                                                  ELCDTERX
  1373     IF DD-PS-PIC (CLAS-INDEXEN) NOT LESS 'A'  AND                ELCDTERX
  1374        DD-PS-PIC (CLAS-INDEXEN) NOT GREATER 'I'                  ELCDTERX
  1375         MOVE '1'                TO DTE-FICH.                     ELCDTERX
  1376                                                                  ELCDTERX
  1377     IF DD-PS-PIC (CLAS-INDEXEN) NOT LESS 'J'  AND                ELCDTERX
  1378        DD-PS-PIC (CLAS-INDEXEN) NOT GREATER 'R'                  ELCDTERX
  1379         MOVE '2'                TO DTE-FICH.                     ELCDTERX
  1380                                                                  ELCDTERX
  1381*    MOVE DD-PS-PIC (CLAS-INDEXEN) TO DTE-PGM-OPT.                ELCDTERX
  1382     GO TO 0005-READ--CARD.                                       ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  33
* ECS152.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  1383                                                                  ELCDTERX
  1384 0040-READ--CLAI.                                                 ELCDTERX
  1385     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  1386     IF CLAS-INDEX GREATER 2  OR                                  ELCDTERX
  1387        DD-TYPE (CLAS-INDEX) = SPACE                              ELCDTERX
  1388         GO TO 0005-READ--CARD.                                   ELCDTERX
  1389                                                                  ELCDTERX
  1390     ADD 1                       TO CLAS-INDEXA.                  ELCDTERX
  1391     MOVE DD-TYPE (CLAS-INDEX) TO CLAS-ALL-TYPES (CLAS-INDEXA).   ELCDTERX
  1392     GO TO 0040-READ--CLAI.                                       ELCDTERX
  1393                                                                  ELCDTERX
  1394 0045-READ--DUMP.                                                 ELCDTERX
  1395     MOVE +999 TO WS-RETURN-CODE                                  ELCDTERX
  1396     MOVE 'MISSING AND/OR INVALID CLAS DATE CARD'                 ELCDTERX
  1397                                 TO  WS-ABEND-MESSAGE             ELCDTERX
  1398     PERFORM ABEND-PGM.                                           ELCDTERX
  1399                                                                  ELCDTERX
  1400 0050-READ--POXX.                                                 ELCDTERX
  1401     IF DD-IDX NOT = CLAS-CO                                      ELCDTERX
  1402         GO TO 0005-READ--CARD.                                   ELCDTERX
  1403                                                                  ELCDTERX
  1404     IF DD-PS-PRC (CLAS-INDEXON) = 'X'                            ELCDTERX
  1405         DISPLAY '***********************************************'ELCDTERX
  1406         DISPLAY 'ECS - ', PGM-SUB, ' IS NOT SCHEDULED TO RUN'    ELCDTERX
  1407         DISPLAY '***********************************************'ELCDTERX
  1408         GO TO 0055-READ--STOP.                                   ELCDTERX
  1409                                                                  ELCDTERX
  1410     MOVE DD-PS-PRT (CLAS-INDEXON) TO DTE-PRT-OPT.                ELCDTERX
  1411     MOVE DD-PS-FMT (CLAS-INDEXON) TO DTE-FMT-OPT.                ELCDTERX
  1412     MOVE DD-PS-PRC (CLAS-INDEXON) TO DTE-PRC-OPT DTE-PGM-OPT.    ELCDTERX
  1413     MOVE DD-PS-TOT (CLAS-INDEXON) TO DTE-TOT-OPT.                ELCDTERX
  1414                                                                  ELCDTERX
  1415     IF DTE-PRT-OPT = 'B'                                         ELCDTERX
  1416         MOVE '2'                  TO DTE-FICH.                   ELCDTERX
  1417     IF DTE-PRT-OPT = 'F'                                         ELCDTERX
  1418         MOVE '1'                  TO DTE-FICH.                   ELCDTERX
  1419                                                                  ELCDTERX
  1420     GO TO 0005-READ--CARD.                                       ELCDTERX
  1421                                                                  ELCDTERX
  1422 0055-READ--STOP.                                                 ELCDTERX
  1423     GOBACK.                                                      ELCDTERX
  1424                                                                  ELCDTERX
  1425 0060-READ--TEST.                                                 ELCDTERX
  1426     IF DATX-COD        = SPACE  OR                               ELCDTERX
  1427        CLAX-ID         = SPACE  OR                               ELCDTERX
  1428        DATE-OPTIONS-ID = SPACE                                   ELCDTERX
  1429         GO TO 0045-READ--DUMP.                                   ELCDTERX
  1430                                                                  ELCDTERX
  1431     MOVE LOW-VALUE TO CLAS-TYPE-MISC.                            ELCDTERX
  1432     GO TO 0079-READ--EXIT.                                       ELCDTERX
  1433                                                                  ELCDTERX
  1434 0065-READ--COLC.                                                 ELCDTERX
  1435     MOVE DATE-DISK              TO CLASIC-SYSTEM-CODES.          ELCDTERX
  1436     GO TO 0005-READ--CARD.                                       ELCDTERX
  1437                                                                  ELCDTERX
  1438 0070-READ--OPCA.                                                 ELCDTERX
  1439                                                                  ELCDTERX
  1440     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  34
* ECS152.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  1441                                                                  ELCDTERX
  1442     IF  CLAS-INDEX GREATER 13                                    ELCDTERX
  1443             OR                                                   ELCDTERX
  1444         DD-CARR-FLDS (CLAS-INDEX) = SPACE                        ELCDTERX
  1445         GO TO 0005-READ--CARD.                                   ELCDTERX
  1446                                                                  ELCDTERX
  1447     ADD 1                       TO INDEXCA.                      ELCDTERX
  1448     MOVE DD-CARR-FLDS (CLAS-INDEX)                               ELCDTERX
  1449                                 TO CARRIER-FLDS (INDEXCA).       ELCDTERX
  1450     GO TO 0070-READ--OPCA.                                       ELCDTERX
  1451                                                                  ELCDTERX
  1452 0072-READ--OPST.                                                 ELCDTERX
  1453                                                                  ELCDTERX
  1454     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  1455                                                                  ELCDTERX
  1456     IF  CLAS-INDEX GREATER 16                                    ELCDTERX
  1457             OR                                                   ELCDTERX
  1458         DD-TLR (CLAS-INDEX) = SPACE                              ELCDTERX
  1459         GO TO 0005-READ--CARD.                                   ELCDTERX
  1460                                                                  ELCDTERX
  1461     ADD 1                       TO INDEXST.                      ELCDTERX
  1462     MOVE DD-STATE-FLDS (CLAS-INDEX)                              ELCDTERX
  1463                                 TO STATE-TLR-FLD (INDEXST).      ELCDTERX
  1464     GO TO 0072-READ--OPST.                                       ELCDTERX
  1465                                                                  ELCDTERX
  1466 0074-READ--OPBS.                                                 ELCDTERX
  1467                                                                  ELCDTERX
  1468     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  1469                                                                  ELCDTERX
  1470     IF  CLAS-INDEX GREATER 32                                    ELCDTERX
  1471             OR                                                   ELCDTERX
  1472         DD-TLR (CLAS-INDEX) = SPACE                              ELCDTERX
  1473         GO TO 0005-READ--CARD.                                   ELCDTERX
  1474                                                                  ELCDTERX
  1475     ADD 1                       TO INDEXBS.                      ELCDTERX
  1476     MOVE DD-TLR (CLAS-INDEX)    TO BUS-TLRM-FLD (INDEXBS).       ELCDTERX
  1477     GO TO 0074-READ--OPBS.                                       ELCDTERX
  1478                                                                  ELCDTERX
  1479 0079-READ--EXIT.                                                 ELCDTERX
  1480*    EXIT.                                                        ELCDTERX
  1481******************************************************************ELCDTERX
  1482     MOVE COMPANY-NAME           TO HD-1-COMP.                    ECS152
  1483     MOVE  WS-CURRENT-DATE       TO HD-2-IPL.                        CL**2
  1484     MOVE '1'                    TO FILE-SW.                      ECS152
  1485     OPEN OUTPUT PRT-FILE.                                        ECS152
  1486                                                                  ECS152
  1487     PERFORM 0620-ZERO-TABLE-4 THRU 0630-Z-T4-EXIT                ECS152
  1488         VARYING Y FROM 1 BY 1 UNTIL Y GREATER 3 AFTER            ECS152
  1489             Z FROM 1 BY 1 UNTIL Z GREATER 10.                    ECS152
  1490                                                                  ECS152
  1491     PERFORM 0640-ZERO-TABLE-5 THRU 0650-Z-T5-EXIT                ECS152
  1492         VARYING Y FROM 1 BY 1 UNTIL Y GREATER 3 AFTER            ECS152
  1493             Z FROM 1 BY 1 UNTIL Z GREATER 9.                     ECS152
  1494                                                                  ECS152
  1495     MOVE +0                     TO G-TOT-AH-PD-THIS.             ECS152
  1496     MOVE +0                     TO G-TOT-AH-PD-LAST.             ECS152
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  35
* ECS152.cbl
  1498 0120-OPEN-FILES.                                                 ECS152
  1499     PERFORM 0540-CLEAR-WORK-TABLES THRU 0550-C-W-EXIT.           ECS152
  1500     IF FILE-1                                                    ECS152
  1501         OPEN INPUT EXTR-IN-B                                     ECS152
  1502         GO TO 0170-READ-EXTRACT                                  ECS152
  1503         ELSE                                                     ECS152
  1504         OPEN INPUT EXTR-IN-C.                                    ECS152
  1505                                                                  ECS152
  1506 0130-SORT-PROCEDURE.                                             ECS152
  1507     SORT SORT-FILE ASCENDING SORT-KEY                            ECS152
  1508         INPUT PROCEDURE 0140-GET-EXTRACT THRU 0150-EXTRACT-END   ECS152
  1509         OUTPUT PROCEDURE 0170-READ-EXTRACT THRU 0980-EOJ-EXIT.   ECS152
  1510                                                                  ECS152
  1511     IF SORT-RETURN NOT = ZEROES                                  ECS152
  1512         MOVE '0101'             TO ABEND-CODE                    ECS152
  1513         GO TO ABEND-PGM.                                         ECS152
  1514                                                                  ECS152
  1515     MOVE ZEROS  TO RETURN-CODE.
  1516     GOBACK.                                                      ECS152
  1517                                                                  ECS152
  1518 0140-GET-EXTRACT  SECTION.                                       ECS152
  1519     READ EXTR-IN-C AT END                                        ECS152
  1520         CLOSE EXTR-IN-C GO TO 0150-EXTRACT-END.                  ECS152
  1521
  1522     MOVE LOW-VALUES             TO EC-REINS-CO
  1523                                    EC-CARRIER
  1524                                    EC-GROUP
  1525
  1526     RELEASE SORT-REC FROM EXTR-RECORD-C.                         ECS152
  1527     GO TO 0140-GET-EXTRACT.                                      ECS152
  1528 0150-EXTRACT-END.                                                   CL**3
  1529      EXIT.                                                          CL**3
  1530                                                                     CL**3
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  36
* ECS152.cbl
  1532 0170-READ-EXTRACT  SECTION.                                      ECS152
  1533     IF FILE-1                                                    ECS152
  1534         READ EXTR-IN-B INTO THE-RECORD AT END                    ECS152
  1535             MOVE 'Y'            TO EOJ-SW                        ECS152
  1536             GO TO 0220-CONTROL-BREAK.                            ECS152
  1537                                                                  ECS152
  1538     IF FILE-2                                                    ECS152
  1539         RETURN SORT-FILE INTO THE-RECORD AT END                  ECS152
  1540             MOVE 'Y'            TO EOJ-SW                        ECS152
  1541             GO TO 0220-CONTROL-BREAK.                            ECS152
  1542                                                                  ECS152
  1543     IF DTE-PGM-OPT NOT = 1                                       ECS152
  1544         IF ER-REC-TYPE = 15                                      ECS152
  1545             GO TO 0170-READ-EXTRACT.                             ECS152
  1546                                                                  ECS152
  1547 0180-SET-CONTROL.                                                ECS152
  1548     IF FIRST-READ = 'Y'                                          ECS152
  1549         MOVE ER-SORT-KEY        TO CONTROL-AREA                  ECS152
  1550         MOVE ER-PERIOD-START    TO CNTRL-START                   ECS152
  1551         MOVE ER-PERIOD-END      TO CNTRL-END                     ECS152
  1552         MOVE 'N'                TO FIRST-READ.                   ECS152
  1553                                                                  ECS152
  1554 0190-CHECK-SEQUENCE.                                             ECS152
  1555     IF ER-SORT-KEY LESS CONTROL-AREA                             ECS152
  1556         DISPLAY 'ECS152 - SEQUENCE ERROR PROGRAM TERMINATED'     ECS152
  1557         MOVE '0610'             TO ABEND-CODE                    ECS152
  1558         GO TO ABEND-PGM.                                         ECS152
  1559                                                                  ECS152
  1560     IF ER-SORT-KEY NOT EQUAL CONTROL-AREA                        ECS152
  1561         GO TO 0220-CONTROL-BREAK.                                ECS152
  1562                                                                  ECS152
  1563 0200-ACCUM-AMOUNTS.                                              ECS152
  1564     PERFORM 0310-ADD-UP-DETAIL THRU 0320-ADD-DETAIL-EXIT         ECS152
  1565         VARYING Y FROM 1 BY 1 UNTIL Y GREATER 3 AFTER            ECS152
  1566             Z FROM 1 BY 1 UNTIL Z GREATER 10.                    ECS152
  1567                                                                  ECS152
  1568     PERFORM 0350-ADD-UP-A-H THRU 0360-ADD-AH-EXIT                ECS152
  1569         VARYING Y FROM 1 BY 1 UNTIL Y GREATER 3 AFTER            ECS152
  1570             Z FROM 1 BY 1 UNTIL Z GREATER 9.                     ECS152
  1571                                                                  ECS152
  1572     ADD ER-AH-PD-THIS TO TOT-AH-PD-THIS.                         ECS152
  1573     ADD ER-AH-PD-LAST TO TOT-AH-PD-LAST.                         ECS152
  1574                                                                  ECS152
  1575     IF CNTRL-REC-TYPE NOT = 20                                   ECS152
  1576         NEXT SENTENCE                                            ECS152
  1577     ELSE                                                         ECS152
  1578         PERFORM 0330-ADD-UP-GRAND-DETAIL THRU 0340-ADD-GRAND-EXITECS152
  1579             VARYING Y FROM 1 BY 1 UNTIL Y GREATER 3 AFTER        ECS152
  1580                 Z FROM 1 BY 1 UNTIL Z GREATER 10                 ECS152
  1581         PERFORM 0370-ADD-UP-GRAND-AH THRU 0380-ADD-GRAND-AH-EXIT ECS152
  1582             VARYING Y FROM 1 BY 1 UNTIL Y GREATER 3 AFTER        ECS152
  1583                 Z FROM 1 BY 1 UNTIL Z GREATER 9                  ECS152
  1584         ADD ER-AH-PD-THIS TO G-TOT-AH-PD-THIS                    ECS152
  1585         ADD ER-AH-PD-LAST TO G-TOT-AH-PD-LAST.                   ECS152
  1586                                                                  ECS152
  1587     GO TO 0170-READ-EXTRACT.                                     ECS152
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  37
* ECS152.cbl
  1589 0220-CONTROL-BREAK.                                              ECS152
  1590     MOVE '*                   ' TO                               ECS152
  1591                                   HD-2-CARRIER                   ECS152
  1592                                   HD-3-COMPANY                   ECS152
  1593                                   HD-4-STATE                     ECS152
  1594                                   HD-5-ACCOUNT.                  ECS152
  1595                                                                  ECS152
  1596     IF EOJ-SW = 'Y' AND PRINT-SW = SPACE                            CL**3
  1597         GO TO 0960-NO-PRINT.                                        CL**3
  1598                                                                  ECS152
  1599     MOVE SPACES                 TO HD-6-MSG  HD-2-REIN.          ECS152
  1600     MOVE CNTRL-STATE            TO STATE-INDEX.                  ECS152
  1601                                                                  ECS152
  1602     IF CNTRL-REC-TYPE = 15                                       ECS152
  1603         MOVE 'ACCOUNT              ' TO HD-1-MSG                 ECS152
  1604         MOVE CNTRL-CARRIER      TO HD-2-CARRIER                  ECS152
  1605         MOVE CNTRL-COMPANY      TO HD-3-COMPANY                  ECS152
  1606         PERFORM 0670-FIND-STATE THRU 0690-FIND-S-EXIT            ECS152
  1607         MOVE CNTRL-ACCOUNT      TO HD-5-ACCOUNT                  ECS152
  1608         GO TO 0240-END-BREAK.                                    ECS152
  1609                                                                  ECS152
  1610     IF CNTRL-REC-TYPE = 16                                       ECS152
  1611         MOVE 'STATE                ' TO HD-1-MSG                 ECS152
  1612         MOVE CNTRL-CARRIER      TO HD-2-CARRIER                  ECS152
  1613         MOVE CNTRL-COMPANY      TO HD-3-COMPANY                  ECS152
  1614         PERFORM 0670-FIND-STATE THRU 0690-FIND-S-EXIT            ECS152
  1615         GO TO 0240-END-BREAK.                                    ECS152
  1616                                                                  ECS152
  1617     IF CNTRL-REC-TYPE = 17                                       ECS152
  1618         MOVE 'COMPANY              ' TO HD-1-MSG                 ECS152
  1619         MOVE CNTRL-CARRIER      TO HD-2-CARRIER                  ECS152
  1620         MOVE CNTRL-COMPANY      TO HD-3-COMPANY                  ECS152
  1621         GO TO 0240-END-BREAK.                                    ECS152
  1622                                                                  ECS152
  1623     IF CNTRL-REC-TYPE = 18                                       ECS152
  1624         MOVE 'CARRIER              ' TO HD-1-MSG                 ECS152
  1625         MOVE CNTRL-CARRIER TO HD-2-CARRIER                       ECS152
  1626         GO TO 0240-END-BREAK.                                    ECS152
  1627                                                                  ECS152
  1628     IF CNTRL-REC-TYPE = 19                                       ECS152
  1629         MOVE 'REINSURANCE COMPANY  ' TO HD-1-MSG                 ECS152
  1630         GO TO 0240-END-BREAK.                                    ECS152
  1631                                                                  ECS152
  1632     IF CNTRL-REC-TYPE = 20                                       ECS152
  1633         MOVE 'STATE OVERALL        ' TO HD-1-MSG                 ECS152
  1634         PERFORM 0670-FIND-STATE THRU 0690-FIND-S-EXIT            ECS152
  1635         GO TO 0240-END-BREAK.                                    ECS152
  1636                                                                  ECS152
  1637     IF CNTRL-REC-TYPE = 21                                       ECS152
  1638         MOVE 'GRAND TOTAL          ' TO HD-1-MSG                 ECS152
  1639         GO TO 0240-END-BREAK.                                    ECS152
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  38
* ECS152.cbl
  1641 0240-END-BREAK.                                                  ECS152
  1642     IF CNTRL-REC-TYPE LESS 20                                    ECS152
  1643         MOVE CNTRL-REIN-CO TO HD-MSG6-REIN  HD-2-REIN-COMP       ECS152
  1644         MOVE HD-MSG3            TO HD-2-REIN-MSG                 ECS152
  1645         MOVE HD-MSG6            TO HD-6-MSG.                     ECS152
  1646                                                                  ECS152
  1647     MOVE CNTRL-START            TO WS-WORK-DATE.                 ECS152
  1648     MOVE WS-DAY                 TO HD-5-DAY.                     ECS152
  1649     MOVE WS-CENT                TO HD-5-CENT.                       CL**8
  1650     MOVE WS-YEAR                TO HD-5-YEAR.                       CL**3
  1651     MOVE MONTH-ALPHA (WS-MONTH) TO HD-5-MONTH.                   ECS152
  1652                                                                  ECS152
  1653     MOVE CNTRL-END              TO WS-WORK-DATE.                 ECS152
  1654     MOVE WS-DAY                 TO HD-6-DAY.                     ECS152
  1655     MOVE WS-CENT                TO HD-6-CENT.                       CL**8
  1656     MOVE WS-YEAR                TO HD-6-YEAR.                       CL**3
  1657     MOVE MONTH-ALPHA (WS-MONTH) TO HD-6-MONTH.                   ECS152
  1658                                                                  ECS152
  1659     MOVE HD-MSG2                TO HD-3-MSG.                     ECS152
  1660                                                                  ECS152
  1661     PERFORM 0400-ACCUMULATE-1-120 THRU 0410-A-1-120-EXIT         ECS152
  1662         VARYING Z FROM 1 BY 1 UNTIL Z GREATER 10.                ECS152
  1663                                                                  ECS152
  1664     PERFORM 0420-ADD-3-AH-LEVELS THRU 0430-ADD-3-EXIT            ECS152
  1665         VARYING Z FROM 1 BY 1 UNTIL Z GREATER 9 AFTER            ECS152
  1666             Y FROM 1 BY 1 UNTIL Y GREATER 3.                     ECS152
  1667                                                                  ECS152
  1668     MOVE +1                     TO Y.                            ECS152
  1669     PERFORM 0810-CHECK-FOR-PRINT THRU 0820-CHECK-PRINT-EXIT      ECS152
  1670         VARYING Z FROM 1 BY 1 UNTIL Z GREATER 5.                 ECS152
  1671     MOVE DO-PRINT               TO R-SW-G (Y).                   ECS152
  1672                                                                  ECS152
  1673     MOVE +2                     TO Y.                            ECS152
  1674     PERFORM 0810-CHECK-FOR-PRINT THRU 0820-CHECK-PRINT-EXIT      ECS152
  1675         VARYING Z FROM 1 BY 1 UNTIL Z GREATER 5.                 ECS152
  1676     MOVE DO-PRINT               TO R-SW-G (Y).                   ECS152
  1677                                                                  ECS152
  1678     MOVE +3                     TO Y.                            ECS152
  1679     PERFORM 0810-CHECK-FOR-PRINT THRU 0820-CHECK-PRINT-EXIT      ECS152
  1680         VARYING Z FROM 1 BY 1 UNTIL Z GREATER 5.                 ECS152
  1681     MOVE DO-PRINT               TO R-SW-G (Y).                   ECS152
  1682                                                                  ECS152
  1683     MOVE +1                     TO Y.                            ECS152
  1684     PERFORM 0810-CHECK-FOR-PRINT THRU 0820-CHECK-PRINT-EXIT      ECS152
  1685         VARYING Z FROM 6 BY 1 UNTIL Z GREATER 10.                ECS152
  1686     MOVE DO-PRINT               TO R-SW-I (Y).                   ECS152
  1687                                                                  ECS152
  1688     MOVE +2                     TO Y.                            ECS152
  1689     PERFORM 0810-CHECK-FOR-PRINT THRU 0820-CHECK-PRINT-EXIT      ECS152
  1690         VARYING Z FROM 6 BY 1 UNTIL Z GREATER 10.                ECS152
  1691     MOVE DO-PRINT               TO R-SW-I (Y).                   ECS152
  1692                                                                  ECS152
  1693     MOVE +3                     TO Y.                            ECS152
  1694     PERFORM 0810-CHECK-FOR-PRINT THRU 0820-CHECK-PRINT-EXIT      ECS152
  1695         VARYING Z FROM 6 BY 1 UNTIL Z GREATER 10.                ECS152
  1696     MOVE DO-PRINT               TO R-SW-I (Y).                   ECS152
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  39
* ECS152.cbl
  1698                                                                  ECS152
  1699 0260-CONTROL-BREAK-PRINT.                                        ECS152
  1700     MOVE HD-MSG4                TO HD-3-TITLE.                   ECS152
  1701     IF R-SW-G (1) = SPACE AND R-SW-G (2) = SPACE AND             ECS152
  1702        R-SW-G (3) = SPACE AND R-SW-I (1) = SPACE AND                CL**3
  1703        R-SW-I (2) = SPACE AND R-SW-I (3) = SPACE                    CL**3
  1704             GO TO 0290-CONTROL-4.                                ECS152
  1705                                                                  ECS152
  1706     IF PRINT-SW = SPACE                                             CL**3
  1707         MOVE 'Y'                TO PRINT-SW.                        CL**3
  1708                                                                  ECS152
  1709     PERFORM 0710-PRINT-HEADINGS THRU 0720-P-H-X.                 ECS152
  1710                                                                  ECS152
  1711     IF R-SW-G (1) = SPACE AND R-SW-G (2) = SPACE AND             ECS152
  1712        R-SW-G (3) = SPACE                                           CL**3
  1713         GO TO 0270-CONTROL-2.                                       CL**3
  1714                                                                  ECS152
  1715     PERFORM 0840-DUMP-PAGE-1 THRU 0860-DUMP-1-EXIT               ECS152
  1716         VARYING Y FROM 1 BY 1 UNTIL Y GREATER 3.                 ECS152
  1717                                                                  ECS152
  1718     IF R-SW-I (1) = SPACE AND R-SW-I (2) = SPACE AND             ECS152
  1719        R-SW-I (3) = SPACE                                           CL**3
  1720         MOVE +3                 TO Y                                CL**3
  1721         PERFORM 0900-DUMP-2-FINAL THRU 0910-DUMP-2-EXIT             CL**3
  1722         GO TO 0280-CONTROL-3.                                       CL**3
  1723                                                                  ECS152
  1724     PERFORM 0710-PRINT-HEADINGS THRU 0720-P-H-X.                 ECS152
  1725                                                                  ECS152
  1726 0270-CONTROL-2.                                                  ECS152
  1727     PERFORM 0880-DUMP-PAGE-2 THRU 0910-DUMP-2-EXIT               ECS152
  1728         VARYING Y FROM 1 BY 1 UNTIL Y GREATER 3.                 ECS152
  1729                                                                  ECS152
  1730 0280-CONTROL-3.                                                  ECS152
  1731     MOVE HD-MSG5                TO HD-3-TITLE.                   ECS152
  1732     PERFORM 0710-PRINT-HEADINGS THRU 0720-P-H-X.                 ECS152
  1733     PERFORM 0930-DUMP-PAGE-3 THRU 0940-DUMP-3-EXIT.              ECS152
  1734                                                                  ECS152
  1735 0290-CONTROL-4.                                                  ECS152
  1736     MOVE 'Y'                    TO FIRST-READ.                   ECS152
  1737                                                                  ECS152
  1738     IF EOJ-SW = 'Y'                                              ECS152
  1739         IF FILE-1                                                ECS152
  1740             MOVE 'N'            TO EOJ-SW                        ECS152
  1741             MOVE ZERO           TO PAGE-CNT                      ECS152
  1742             CLOSE EXTR-IN-B                                      ECS152
  1743             MOVE '2'            TO FILE-SW                       ECS152
  1744             GO TO 0120-OPEN-FILES.                               ECS152
  1745                                                                  ECS152
  1746     IF EOJ-SW = 'Y'                                              ECS152
  1747         IF FILE-2                                                ECS152
  1748             PERFORM 0600-ZERO-TABLE-3 THRU 0610-Z-T3-EXIT        ECS152
  1749                 VARYING Z FROM 1 BY 1 UNTIL Z GREATER 9          ECS152
  1750             MOVE '3'            TO FILE-SW                       ECS152
  1751             MOVE '21'           TO CNTRL-REC-TYPE                ECS152
  1752             MOVE TABLE-4        TO TABLE-1                       ECS152
  1753             MOVE TABLE-5        TO TABLE-2                       ECS152
  1754             MOVE GRAND-TOT-AH-ACCUM                              ECS152
  1755                                 TO TOT-AH-ACCUM                  ECS152
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  40
* ECS152.cbl
  1756             GO TO 0220-CONTROL-BREAK.                            ECS152
  1757                                                                  ECS152
  1758     IF EOJ-SW = 'Y'                                              ECS152
  1759         IF FILE-3                                                ECS152
  1760             GO TO 0970-END-JOB.                                  ECS152
  1761                                                                  ECS152
  1762     PERFORM 0540-CLEAR-WORK-TABLES THRU 0550-C-W-EXIT.           ECS152
  1763     GO TO 0180-SET-CONTROL.                                      ECS152
  1764                                                                  ECS152
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  41
* ECS152.cbl
  1766*                                                                 ECS152
  1767*        PERFORMED PROCEDURES NEXT                                ECS152
  1768*                                                                 ECS152
  1769 0310-ADD-UP-DETAIL.                                              ECS152
  1770     ADD ER-ISSUE-CNT   (Y, Z) TO TBL-ISSUE-CNT (Y, Z).           ECS152
  1771     ADD ER-ISSUE-AMT   (Y, Z) TO TBL-ISSUE-AMT (Y, Z).           ECS152
  1772     ADD ER-ISSUE-PREM  (Y, Z) TO TBL-ISSUE-PREM (Y, Z).          ECS152
  1773     ADD ER-CANCEL-CNT  (Y, Z) TO TBL-CANCEL-CNT (Y, Z).          ECS152
  1774     ADD ER-CANCEL-AMT  (Y, Z) TO TBL-CANCEL-AMT (Y, Z).          ECS152
  1775     ADD ER-CANCEL-PREM (Y, Z) TO TBL-CANCEL-PREM (Y, Z).         ECS152
  1776     ADD ER-CLAIM-CNT   (Y, Z) TO TBL-CLAIM-CNT (Y, Z).           ECS152
  1777     ADD ER-CLAIM-AMT   (Y, Z) TO TBL-CLAIM-AMT (Y, Z).           ECS152
  1778     ADD ER-EARN-PREM   (Y, Z) TO TBL-EARN-PREM (Y, Z).           ECS152
  1779 0320-ADD-DETAIL-EXIT.                                            ECS152
  1780     EXIT.                                                        ECS152
  1781                                                                  ECS152
  1782 0330-ADD-UP-GRAND-DETAIL.                                        ECS152
  1783     ADD ER-ISSUE-CNT   (Y, Z) TO T4-ISSUE-CNT (Y, Z).            ECS152
  1784     ADD ER-ISSUE-AMT   (Y, Z) TO T4-ISSUE-AMT (Y, Z).            ECS152
  1785     ADD ER-ISSUE-PREM  (Y, Z) TO T4-ISSUE-PREM (Y, Z).           ECS152
  1786     ADD ER-CANCEL-CNT  (Y, Z) TO T4-CANCEL-CNT (Y, Z).           ECS152
  1787     ADD ER-CANCEL-AMT  (Y, Z) TO T4-CANCEL-AMT (Y, Z).           ECS152
  1788     ADD ER-CANCEL-PREM (Y, Z) TO T4-CANCEL-PREM (Y, Z).          ECS152
  1789     ADD ER-CLAIM-CNT   (Y, Z) TO T4-CLAIM-CNT (Y, Z).            ECS152
  1790     ADD ER-CLAIM-AMT   (Y, Z) TO T4-CLAIM-AMT (Y, Z).            ECS152
  1791     ADD ER-EARN-PREM   (Y, Z) TO T4-EARN-PREM (Y, Z).            ECS152
  1792 0340-ADD-GRAND-EXIT.                                             ECS152
  1793     EXIT.                                                        ECS152
  1794                                                                  ECS152
  1795 0350-ADD-UP-A-H.                                                 ECS152
  1796     ADD ER-GROUP-CNT (Y, Z) TO TBL-GRP-CNT (Y, Z).               ECS152
  1797     ADD ER-GROUP-AMT (Y, Z) TO TBL-GRP-AMT (Y, Z).               ECS152
  1798     ADD ER-IND-CNT   (Y, Z) TO TBL-IND-CNT (Y, Z).               ECS152
  1799     ADD ER-IND-AMT   (Y, Z) TO TBL-IND-AMT (Y, Z).               ECS152
  1800 0360-ADD-AH-EXIT.                                                ECS152
  1801     EXIT.                                                        ECS152
  1802                                                                  ECS152
  1803 0370-ADD-UP-GRAND-AH.                                            ECS152
  1804     ADD ER-GROUP-CNT (Y, Z) TO T5-GRP-CNT (Y, Z).                ECS152
  1805     ADD ER-GROUP-AMT (Y, Z) TO T5-GRP-AMT (Y, Z).                ECS152
  1806     ADD ER-IND-CNT   (Y, Z) TO T5-IND-CNT (Y, Z).                ECS152
  1807     ADD ER-IND-AMT   (Y, Z) TO T5-IND-AMT (Y, Z).                ECS152
  1808 0380-ADD-GRAND-AH-EXIT.                                          ECS152
  1809     EXIT.                                                        ECS152
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  42
* ECS152.cbl
  1811                                                                     CL**4
  1812 0400-ACCUMULATE-1-120.                                           ECS152
  1813     ADD TBL-ISSUE-CNT   (2, Z)   TO TBL-ISSUE-CNT   (1, Z).      ECS152
  1814     ADD TBL-ISSUE-AMT   (2, Z)   TO TBL-ISSUE-AMT   (1, Z).      ECS152
  1815     ADD TBL-ISSUE-PREM  (2, Z)   TO TBL-ISSUE-PREM  (1, Z).      ECS152
  1816     ADD TBL-CANCEL-CNT  (2, Z)   TO TBL-CANCEL-CNT  (1, Z).      ECS152
  1817     ADD TBL-CANCEL-AMT  (2, Z)   TO TBL-CANCEL-AMT  (1, Z).      ECS152
  1818     ADD TBL-CANCEL-PREM (2, Z)   TO TBL-CANCEL-PREM (1, Z).      ECS152
  1819     ADD TBL-CLAIM-CNT   (2, Z)   TO TBL-CLAIM-CNT   (1, Z).      ECS152
  1820     ADD TBL-CLAIM-AMT   (2, Z)   TO TBL-CLAIM-AMT   (1, Z).      ECS152
  1821     ADD TBL-EARN-PREM   (2, Z)   TO TBL-EARN-PREM   (1, Z).      ECS152
  1822 0410-A-1-120-EXIT.                                               ECS152
  1823     EXIT.                                                        ECS152
  1824                                                                  ECS152
  1825 0420-ADD-3-AH-LEVELS.                                            ECS152
  1826     ADD TBL-GRP-CNT (Y, Z) TO T3-GRP-CNT (Z).                    ECS152
  1827     ADD TBL-GRP-AMT (Y, Z) TO T3-GRP-AMT (Z).                    ECS152
  1828     ADD TBL-IND-CNT (Y, Z) TO T3-IND-CNT (Z).                    ECS152
  1829     ADD TBL-IND-AMT (Y, Z) TO T3-IND-AMT (Z).                    ECS152
  1830 0430-ADD-3-EXIT.                                                 ECS152
  1831     EXIT.                                                        ECS152
  1832                                                                  ECS152
  1833 0440-ADD-SUB-TOTALS.                                             ECS152
  1834     ADD TBL-ISSUE-CNT   (Y, Z) TO G1-ISS-CNT   T1-ISS-CNT.       ECS152
  1835     ADD TBL-ISSUE-AMT   (Y, Z) TO G1-ISS-AMT   T1-ISS-AMT.       ECS152
  1836     ADD TBL-ISSUE-PREM  (Y, Z) TO G1-ISS-PRM   T1-ISS-PRM.       ECS152
  1837     ADD TBL-CANCEL-CNT  (Y, Z) TO G1-CAN-CNT   T1-CAN-CNT.       ECS152
  1838     ADD TBL-CANCEL-AMT  (Y, Z) TO G1-CAN-AMT   T1-CAN-AMT.       ECS152
  1839     ADD TBL-CANCEL-PREM (Y, Z) TO G1-CAN-PRM   T1-CAN-PRM.       ECS152
  1840     ADD TBL-CLAIM-CNT   (Y, Z) TO G1-CLM-CNT   T1-CLM-CNT.       ECS152
  1841     ADD TBL-CLAIM-AMT   (Y, Z) TO G1-CLM-AMT   T1-CLM-AMT.       ECS152
  1842     ADD TBL-EARN-PREM   (Y, Z) TO G1-ERN-PRM   T1-ERN-PRM.       ECS152
  1843 0450-ADD-SUB-EXIT.                                               ECS152
  1844     EXIT.                                                        ECS152
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  43
* ECS152.cbl
  1846                                                                     CL**4
  1847 0470-BUILD-DETAIL-1.                                             ECS152
  1848     MOVE TBL-ISSUE-CNT   (Y, Z) TO D1-ISS-CNT.                   ECS152
  1849     MOVE TBL-ISSUE-AMT   (Y, Z) TO D1-ISS-AMT.                   ECS152
  1850     MOVE TBL-ISSUE-PREM  (Y, Z) TO D1-ISS-PRM.                   ECS152
  1851     MOVE TBL-CANCEL-CNT  (Y, Z) TO D1-CAN-CNT.                   ECS152
  1852     MOVE TBL-CANCEL-AMT  (Y, Z) TO D1-CAN-AMT.                   ECS152
  1853     MOVE TBL-CANCEL-PREM (Y, Z) TO D1-CAN-PRM.                   ECS152
  1854     MOVE TBL-CLAIM-CNT   (Y, Z) TO D1-CLM-CNT.                   ECS152
  1855     MOVE TBL-CLAIM-AMT   (Y, Z) TO D1-CLM-AMT.                   ECS152
  1856     MOVE TBL-EARN-PREM   (Y, Z) TO D1-ERN-AMT.                   ECS152
  1857 0480-BUILD-D-EXIT.                                               ECS152
  1858     EXIT.                                                        ECS152
  1859                                                                  ECS152
  1860 0490-BUILD-DETAIL-2.                                             ECS152
  1861     MOVE T3-GRP-CNT (Z)         TO D2-GRP-CNT.                   ECS152
  1862     MOVE T3-GRP-AMT (Z)         TO D2-GRP-AMT.                   ECS152
  1863     MOVE T3-IND-CNT (Z)         TO D2-IND-CNT.                   ECS152
  1864     MOVE T3-IND-AMT (Z)         TO D2-IND-AMT.                   ECS152
  1865 0500-BUILD-2-EXIT.                                               ECS152
  1866     EXIT.                                                        ECS152
  1867                                                                  ECS152
  1868 0510-BUILD-DETAIL-2A.                                            ECS152
  1869     MOVE TBL-GRP-CNT (Y, Z)     TO D2-GRP-CNT.                   ECS152
  1870     MOVE TBL-GRP-AMT (Y, Z)     TO D2-GRP-AMT.                   ECS152
  1871     MOVE TBL-IND-CNT (Y, Z)     TO D2-IND-CNT.                   ECS152
  1872     MOVE TBL-IND-AMT (Y, Z)     TO D2-IND-AMT.                   ECS152
  1873 0520-BUILD-2A-EXIT.                                              ECS152
  1874     EXIT.                                                        ECS152
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  44
* ECS152.cbl
  1876                                                                     CL**4
  1877 0540-CLEAR-WORK-TABLES.                                          ECS152
  1878     PERFORM 0560-ZERO-TABLE-1 THRU 0570-Z-T1-EXIT                ECS152
  1879         VARYING Y FROM 1 BY 1 UNTIL Y GREATER 3 AFTER            ECS152
  1880             Z FROM 1 BY 1 UNTIL Z GREATER 10.                    ECS152
  1881                                                                  ECS152
  1882     PERFORM 0580-ZERO-TABLE-2 THRU 0590-Z-T2-EXIT                ECS152
  1883         VARYING Y FROM 1 BY 1 UNTIL Y GREATER 3 AFTER            ECS152
  1884             Z FROM 1 BY 1 UNTIL Z GREATER 9.                     ECS152
  1885                                                                  ECS152
  1886     PERFORM 0600-ZERO-TABLE-3 THRU 0610-Z-T3-EXIT                ECS152
  1887         VARYING Z FROM 1 BY 1 UNTIL Z GREATER 9.                 ECS152
  1888                                                                  ECS152
  1889     MOVE +0                     TO TOT-AH-PD-THIS.               ECS152
  1890     MOVE +0                     TO TOT-AH-PD-LAST.               ECS152
  1891 0550-C-W-EXIT.                                                   ECS152
  1892     EXIT.                                                        ECS152
  1893                                                                  ECS152
  1894 0560-ZERO-TABLE-1.                                               ECS152
  1895     MOVE ZERO-FIELDS-1          TO TABLE-1-DTL (Y, Z).           ECS152
  1896 0570-Z-T1-EXIT.                                                  ECS152
  1897     EXIT.                                                        ECS152
  1898                                                                  ECS152
  1899 0580-ZERO-TABLE-2.                                               ECS152
  1900     MOVE ZERO-FIELDS-2          TO TBL-2-DTL (Y, Z).             ECS152
  1901 0590-Z-T2-EXIT.                                                  ECS152
  1902     EXIT.                                                        ECS152
  1903                                                                  ECS152
  1904 0600-ZERO-TABLE-3.                                               ECS152
  1905     MOVE ZERO-FIELDS-2          TO TABLE-3-GRP (Z).              ECS152
  1906 0610-Z-T3-EXIT.                                                  ECS152
  1907     EXIT.                                                        ECS152
  1908                                                                  ECS152
  1909 0620-ZERO-TABLE-4.                                               ECS152
  1910     MOVE ZERO-FIELDS-1          TO TABLE-4-DTL (Y, Z).           ECS152
  1911 0630-Z-T4-EXIT.                                                  ECS152
  1912     EXIT.                                                        ECS152
  1913                                                                  ECS152
  1914 0640-ZERO-TABLE-5.                                               ECS152
  1915     MOVE ZERO-FIELDS-2          TO TBL-5-DTL (Y, Z).             ECS152
  1916 0650-Z-T5-EXIT.                                                  ECS152
  1917     EXIT.                                                        ECS152
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  45
* ECS152.cbl
  1919                                                                     CL**4
  1920 0670-FIND-STATE.                                                 ECS152
  1921     MOVE +1                     TO Y.                            ECS152
  1922 0680-FIND-STATE-NOW.                                             ECS152
  1923     IF Y GREATER +75                                             ECS152
  1924         MOVE 'UNKNOWN             ' TO HD-4-STATE                ECS152
  1925         GO TO 0690-FIND-S-EXIT.                                  ECS152
  1926                                                                  ECS152
  1927     IF STATE-INDEX = STATE-SUB (Y) OR STATE-ABBR (Y)             ECS152
  1928         MOVE STATE-PIC (Y)      TO HD-4-STATE                    ECS152
  1929         GO TO 0690-FIND-S-EXIT.                                  ECS152
  1930                                                                  ECS152
  1931     ADD +1 TO Y.                                                 ECS152
  1932     GO TO 0680-FIND-STATE-NOW.                                   ECS152
  1933 0690-FIND-S-EXIT.                                                ECS152
  1934     EXIT.                                                        ECS152
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  46
* ECS152.cbl
  1936                                                                  ECS152
  1937 0710-PRINT-HEADINGS.                                             ECS152
  1938     ADD 1 TO PAGE-CNT.                                           ECS152
  1939     MOVE PAGE-CNT               TO HD-4-PAGE.                    ECS152
  1940     MOVE HD-1                   TO PRT.                          ECS152
  1941     PERFORM 0730-PRT-RTN THRU 0740-PRT-RTN-X.                    ECS152
  1942     MOVE HD-2                   TO PRT.                          ECS152
  1943     PERFORM 0730-PRT-RTN THRU 0740-PRT-RTN-X.                    ECS152
  1944     MOVE HD-3                   TO PRT.                          ECS152
  1945     PERFORM 0730-PRT-RTN THRU 0740-PRT-RTN-X.                    ECS152
  1946     MOVE HD-4                   TO PRT.                          ECS152
  1947     PERFORM 0730-PRT-RTN THRU 0740-PRT-RTN-X.                    ECS152
  1948     MOVE HD-5                   TO PRT.                          ECS152
  1949     PERFORM 0730-PRT-RTN THRU 0740-PRT-RTN-X.                    ECS152
  1950     MOVE HD-6                   TO PRT.                          ECS152
  1951     PERFORM 0730-PRT-RTN THRU 0740-PRT-RTN-X.                    ECS152
  1952 0720-P-H-X.                                                      ECS152
  1953     EXIT.                                                        ECS152
  1954                                                                  ECS152
  1955 0730-PRT-RTN.                                                    ECS152
  1956     IF DTE-FICH IS NOT EQUAL TO SPACE AND                        ECS152
  1957         FICH-OPEN IS EQUAL TO SPACE                              ECS152
  1958         OPEN OUTPUT FICH                                         ECS152
  1959         MOVE 'X'                TO FICH-OPEN.                    ECS152
  1960                                                                     CL**4
  1961     IF DTE-FICH IS NOT EQUAL TO SPACE                            ECS152
  1962         WRITE FICH-REC FROM PRT.                                 ECS152
  1963                                                                     CL**4
  1964     IF DTE-FICH IS EQUAL TO SPACE OR '2'                         ECS152
  1965         MOVE P-CTL TO LCP-ASA                                    ECS152
  1966         PERFORM LCP-WRITE-POS-PRT                                ECS152
  1967             THRU LCP-WRITE-END-PRT.                              ECS152
  1968 0740-PRT-RTN-X.                                                  ECS152
  1969     EXIT.                                                        ECS152
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  47
* ECS152.cbl
  1971                                                                     CL**4
  1972 0760-MOVE-G1-TO-PRINT.                                           ECS152
  1973     MOVE G1-ISS-CNT             TO D1-ISS-CNT.                   ECS152
  1974     MOVE G1-ISS-AMT             TO D1-ISS-AMT.                   ECS152
  1975     MOVE G1-ISS-PRM             TO D1-ISS-PRM.                   ECS152
  1976     MOVE G1-CAN-CNT             TO D1-CAN-CNT.                   ECS152
  1977     MOVE G1-CAN-AMT             TO D1-CAN-AMT.                   ECS152
  1978     MOVE G1-CAN-PRM             TO D1-CAN-PRM.                   ECS152
  1979     MOVE G1-CLM-CNT             TO D1-CLM-CNT.                   ECS152
  1980     MOVE G1-CLM-AMT             TO D1-CLM-AMT.                   ECS152
  1981     MOVE G1-ERN-PRM             TO D1-ERN-AMT.                   ECS152
  1982 0770-MOVE-G1-EXIT.                                               ECS152
  1983     EXIT.                                                        ECS152
  1984                                                                  ECS152
  1985 0780-MOVE-T1-TO-PRINT.                                           ECS152
  1986     MOVE T1-ISS-CNT             TO D1-ISS-CNT.                   ECS152
  1987     MOVE T1-ISS-AMT             TO D1-ISS-AMT.                   ECS152
  1988     MOVE T1-ISS-PRM             TO D1-ISS-PRM.                   ECS152
  1989     MOVE T1-CAN-CNT             TO D1-CAN-CNT.                   ECS152
  1990     MOVE T1-CAN-AMT             TO D1-CAN-AMT.                   ECS152
  1991     MOVE T1-CAN-PRM             TO D1-CAN-PRM.                   ECS152
  1992     MOVE T1-CLM-CNT             TO D1-CLM-CNT.                   ECS152
  1993     MOVE T1-CLM-AMT             TO D1-CLM-AMT.                   ECS152
  1994     MOVE T1-ERN-PRM             TO D1-ERN-AMT.                   ECS152
  1995 0790-MOVE-T1-EXIT.                                               ECS152
  1996     EXIT.                                                        ECS152
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  48
* ECS152.cbl
  1998                                                                     CL**4
  1999 0810-CHECK-FOR-PRINT.                                            ECS152
  2000     MOVE SPACE                  TO DO-PRINT.                     ECS152
  2001
  2002     MOVE 'Y'                    TO DO-PRINT
  2003     MOVE +11                    TO Z
  2004     GO TO 0820-CHECK-PRINT-EXIT
  2005
  2006     IF TBL-ISSUE-CNT (Y, Z) NOT = +0                             ECS152
  2007         MOVE 'Y'                TO DO-PRINT                      ECS152
  2008         MOVE +11                TO Z                             ECS152
  2009         GO TO 0820-CHECK-PRINT-EXIT.                             ECS152
  2010                                                                  ECS152
  2011     IF TBL-ISSUE-AMT (Y, Z) NOT = +0                             ECS152
  2012         MOVE 'Y'                TO DO-PRINT                      ECS152
  2013         MOVE +11                TO Z                             ECS152
  2014         GO TO 0820-CHECK-PRINT-EXIT.                             ECS152
  2015                                                                  ECS152
  2016     IF TBL-ISSUE-PREM (Y, Z) NOT = +0                            ECS152
  2017         MOVE 'Y'                TO DO-PRINT                      ECS152
  2018         MOVE +11                TO Z                             ECS152
  2019         GO TO 0820-CHECK-PRINT-EXIT.                             ECS152
  2020                                                                  ECS152
  2021     IF TBL-CANCEL-CNT (Y, Z) NOT = +0                            ECS152
  2022         MOVE 'Y'                TO DO-PRINT                      ECS152
  2023         MOVE +11                TO Z                             ECS152
  2024         GO TO 0820-CHECK-PRINT-EXIT.                             ECS152
  2025                                                                  ECS152
  2026     IF TBL-CANCEL-AMT (Y, Z) NOT = +0                            ECS152
  2027         MOVE 'Y'                TO DO-PRINT                      ECS152
  2028         MOVE +11                TO Z                             ECS152
  2029         GO TO 0820-CHECK-PRINT-EXIT.                             ECS152
  2030                                                                  ECS152
  2031     IF TBL-CANCEL-PREM (Y, Z) NOT = +0                           ECS152
  2032         MOVE 'Y'                TO DO-PRINT                      ECS152
  2033         MOVE +11                TO Z                             ECS152
  2034         GO TO 0820-CHECK-PRINT-EXIT.                             ECS152
  2035                                                                  ECS152
  2036     IF TBL-CLAIM-CNT (Y, Z) NOT = +0                             ECS152
  2037         MOVE 'Y'                TO DO-PRINT                      ECS152
  2038         MOVE +11                TO Z                             ECS152
  2039         GO TO 0820-CHECK-PRINT-EXIT.                             ECS152
  2040                                                                  ECS152
  2041     IF TBL-CLAIM-AMT (Y, Z) NOT = +0                             ECS152
  2042         MOVE 'Y'                TO DO-PRINT                      ECS152
  2043         MOVE +11                TO Z                             ECS152
  2044         GO TO 0820-CHECK-PRINT-EXIT.                             ECS152
  2045                                                                  ECS152
  2046     IF TBL-EARN-PREM (Y, Z) NOT = +0                             ECS152
  2047         MOVE 'Y'                TO DO-PRINT                      ECS152
  2048         MOVE +11                TO Z                             ECS152
  2049         GO TO 0820-CHECK-PRINT-EXIT.                             ECS152
  2050                                                                  ECS152
  2051 0820-CHECK-PRINT-EXIT.                                           ECS152
  2052     EXIT.                                                        ECS152
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  49
* ECS152.cbl
  2054                                                                     CL**4
  2055 0840-DUMP-PAGE-1.                                                ECS152
  2056*                                                                 ECS152
  2057*    THIS PRINT STARTS WITH LINE 8 THRU END OF PAGE 1.            ECS152
  2058*                                                                 ECS152
  2059     IF R-SW-G (Y) = SPACE                                        ECS152
  2060         GO TO 0860-DUMP-1-EXIT.                                  ECS152
  2061                                                                  ECS152
  2062     MOVE HD-7                   TO PRT.                          ECS152
  2063     PERFORM 0730-PRT-RTN THRU 0740-PRT-RTN-X.                    ECS152
  2064                                                                     CL**4
  2065     MOVE P1-MESS (Y)            TO HD-9-MSG.                     ECS152
  2066     MOVE HD-9                   TO PRT.                          ECS152
  2067     PERFORM 0730-PRT-RTN THRU 0740-PRT-RTN-X.                    ECS152
  2068                                                                     CL**4
  2069     IF Y GREATER +1                                                 CL**4
  2070         GO TO 0850-CONT-DUMP-1.                                     CL**4
  2071                                                                     CL**4
  2072     MOVE HD-10                  TO PRT.                          ECS152
  2073     PERFORM 0730-PRT-RTN THRU 0740-PRT-RTN-X.                    ECS152
  2074                                                                     CL**4
  2075     MOVE HD-11                  TO PRT.                          ECS152
  2076     PERFORM 0730-PRT-RTN THRU 0740-PRT-RTN-X.                    ECS152
  2077                                                                     CL**4
  2078     MOVE HD-12                  TO PRT.                          ECS152
  2079     PERFORM 0730-PRT-RTN THRU 0740-PRT-RTN-X.                    ECS152
  2080                                                                     CL**4
  2081 0850-CONT-DUMP-1.                                                ECS152
  2082                                                                     CL**4
  2083     MOVE 'LIFE REDUCING  '      TO D1-MSG.                       ECS152
  2084     MOVE +1                     TO Z.                            ECS152
  2085     PERFORM 0470-BUILD-DETAIL-1 THRU 0480-BUILD-D-EXIT.          ECS152
  2086     MOVE DETAIL-1               TO PRT.                          ECS152
  2087     PERFORM 0730-PRT-RTN THRU 0740-PRT-RTN-X.                    ECS152
  2088                                                                     CL**4
  2089     MOVE 'LIFE LEVEL     '      TO D1-MSG.                       ECS152
  2090     MOVE +2                     TO Z.                            ECS152
  2091     PERFORM 0470-BUILD-DETAIL-1 THRU 0480-BUILD-D-EXIT.          ECS152
  2092     MOVE DETAIL-1               TO PRT.                          ECS152
  2093     PERFORM 0730-PRT-RTN THRU 0740-PRT-RTN-X.                    ECS152
  2094                                                                     CL**4
  2095     MOVE 'LIFE OUT BAL   '      TO D1-MSG.                       ECS152
  2096     MOVE +3                     TO Z.                            ECS152
  2097     PERFORM 0470-BUILD-DETAIL-1 THRU 0480-BUILD-D-EXIT.          ECS152
  2098     MOVE DETAIL-1               TO PRT.                          ECS152
  2099     PERFORM 0730-PRT-RTN THRU 0740-PRT-RTN-X.                    ECS152
  2100                                                                     CL**4
  2101     MOVE ZERO-FIELDS-1          TO TOTAL-PRINT-AMOUNTS.          ECS152
  2102     MOVE ZERO-FIELDS-1          TO TOTAL-AMOUNTS.                ECS152
  2103     PERFORM 0440-ADD-SUB-TOTALS THRU 0450-ADD-SUB-EXIT           ECS152
  2104         VARYING Z FROM 1 BY 1 UNTIL Z GREATER 3.                 ECS152
  2105     PERFORM 0760-MOVE-G1-TO-PRINT THRU 0770-MOVE-G1-EXIT.        ECS152
  2106     MOVE '  TOTAL LIFE   '      TO D1-MSG.                       ECS152
  2107     MOVE DETAIL-1               TO PRT.                          ECS152
  2108     PERFORM 0730-PRT-RTN THRU 0740-PRT-RTN-X.                    ECS152
  2109                                                                     CL**4
  2110     MOVE 'A-H RETRO/ELIM '      TO D1-MSG.                       ECS152
  2111     MOVE +4                     TO Z.                            ECS152
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  50
* ECS152.cbl
  2112     PERFORM 0470-BUILD-DETAIL-1 THRU 0480-BUILD-D-EXIT.          ECS152
  2113     MOVE DETAIL-1               TO PRT.                          ECS152
  2114     MOVE '0'                    TO P-CTL.                        ECS152
  2115     PERFORM 0730-PRT-RTN THRU 0740-PRT-RTN-X.                    ECS152
  2116                                                                     CL**4
  2117     MOVE 'A-H OUT BAL    '      TO D1-MSG.                       ECS152
  2118     MOVE +5                     TO Z.                            ECS152
  2119     PERFORM 0470-BUILD-DETAIL-1 THRU 0480-BUILD-D-EXIT.          ECS152
  2120     MOVE DETAIL-1               TO PRT.                          ECS152
  2121     PERFORM 0730-PRT-RTN THRU 0740-PRT-RTN-X.                    ECS152
  2122                                                                     CL**4
  2123     MOVE ZERO-FIELDS-1          TO TOTAL-PRINT-AMOUNTS.          ECS152
  2124     PERFORM 0440-ADD-SUB-TOTALS THRU 0450-ADD-SUB-EXIT           ECS152
  2125             VARYING Z FROM 4 BY 1 UNTIL Z GREATER 5.             ECS152
  2126     PERFORM 0760-MOVE-G1-TO-PRINT THRU 0770-MOVE-G1-EXIT.        ECS152
  2127     MOVE '  TOTAL A-H    '      TO D1-MSG.                       ECS152
  2128     MOVE DETAIL-1               TO PRT.                          ECS152
  2129     PERFORM 0730-PRT-RTN THRU 0740-PRT-RTN-X.                    ECS152
  2130                                                                     CL**4
  2131     PERFORM 0780-MOVE-T1-TO-PRINT THRU 0790-MOVE-T1-EXIT.        ECS152
  2132     MOVE '  TOTAL INS    '      TO D1-MSG.                       ECS152
  2133     MOVE DETAIL-1 TO PRT.                                        ECS152
  2134     MOVE '0'                    TO P-CTL.                        ECS152
  2135     PERFORM 0730-PRT-RTN THRU 0740-PRT-RTN-X.                    ECS152
  2136                                                                     CL**4
  2137 0860-DUMP-1-EXIT.                                                ECS152
  2138     EXIT.                                                        ECS152
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  51
* ECS152.cbl
  2140                                                                  ECS152
  2141 0880-DUMP-PAGE-2.                                                ECS152
  2142*                                                                 ECS152
  2143*    THIS PRINT STARTS WITH LINE 8 OF PAGE 2 THRU END OF PAGE 2.  ECS152
  2144*                                                                 ECS152
  2145     IF R-SW-I (Y) = SPACE                                        ECS152
  2146         GO TO 0900-DUMP-2-FINAL.                                 ECS152
  2147                                                                  ECS152
  2148     MOVE HD-8                   TO PRT.                          ECS152
  2149     PERFORM 0730-PRT-RTN THRU 0740-PRT-RTN-X.                    ECS152
  2150                                                                     CL**4
  2151     MOVE P1-MESS (Y)            TO HD-9-MSG.                     ECS152
  2152     MOVE HD-9                   TO PRT.                          ECS152
  2153     PERFORM 0730-PRT-RTN THRU 0740-PRT-RTN-X.                    ECS152
  2154                                                                     CL**4
  2155     IF Y GREATER +1                                                 CL**4
  2156         GO TO 0890-CONT-DUMP-2.                                     CL**4
  2157                                                                     CL**4
  2158     MOVE HD-10                  TO PRT.                          ECS152
  2159     PERFORM 0730-PRT-RTN THRU 0740-PRT-RTN-X.                    ECS152
  2160                                                                     CL**4
  2161     MOVE HD-11                  TO PRT.                          ECS152
  2162     PERFORM 0730-PRT-RTN THRU 0740-PRT-RTN-X.                    ECS152
  2163                                                                     CL**4
  2164     MOVE HD-12                  TO PRT.                          ECS152
  2165     PERFORM 0730-PRT-RTN THRU 0740-PRT-RTN-X.                    ECS152
  2166                                                                  ECS152
  2167 0890-CONT-DUMP-2.                                                ECS152
  2168     MOVE 'LIFE REDUCING  '      TO D1-MSG.                       ECS152
  2169     MOVE +6                     TO Z.                            ECS152
  2170     PERFORM 0470-BUILD-DETAIL-1 THRU 0480-BUILD-D-EXIT.          ECS152
  2171     MOVE DETAIL-1               TO PRT.                          ECS152
  2172     PERFORM 0730-PRT-RTN THRU 0740-PRT-RTN-X.                    ECS152
  2173                                                                     CL**4
  2174     MOVE 'LIFE LEVEL     '      TO D1-MSG.                       ECS152
  2175     MOVE +7                     TO Z.                            ECS152
  2176     PERFORM 0470-BUILD-DETAIL-1 THRU 0480-BUILD-D-EXIT.          ECS152
  2177     MOVE DETAIL-1               TO PRT.                          ECS152
  2178     PERFORM 0730-PRT-RTN THRU 0740-PRT-RTN-X.                    ECS152
  2179                                                                     CL**4
  2180     MOVE 'LIFE OUT BAL   '      TO D1-MSG.                       ECS152
  2181     MOVE +8                     TO Z.                            ECS152
  2182     PERFORM 0470-BUILD-DETAIL-1 THRU 0480-BUILD-D-EXIT.          ECS152
  2183     MOVE DETAIL-1               TO PRT.                          ECS152
  2184     PERFORM 0730-PRT-RTN THRU 0740-PRT-RTN-X.                    ECS152
  2185                                                                     CL**4
  2186     MOVE ZERO-FIELDS-1          TO TOTAL-PRINT-AMOUNTS.          ECS152
  2187     MOVE ZERO-FIELDS-1          TO TOTAL-AMOUNTS.                ECS152
  2188     PERFORM 0440-ADD-SUB-TOTALS THRU 0450-ADD-SUB-EXIT           ECS152
  2189         VARYING Z FROM 6 BY 1 UNTIL Z GREATER 8.                 ECS152
  2190     PERFORM 0760-MOVE-G1-TO-PRINT THRU 0770-MOVE-G1-EXIT.        ECS152
  2191     MOVE '  TOTAL LIFE   '      TO D1-MSG.                       ECS152
  2192     MOVE DETAIL-1               TO PRT.                          ECS152
  2193     PERFORM 0730-PRT-RTN THRU 0740-PRT-RTN-X.                    ECS152
  2194                                                                     CL**4
  2195     MOVE 'A-H RETRO/ELIM '      TO D1-MSG.                       ECS152
  2196     MOVE +9                     TO Z.                            ECS152
  2197     PERFORM 0470-BUILD-DETAIL-1 THRU 0480-BUILD-D-EXIT.          ECS152
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  52
* ECS152.cbl
  2198     MOVE DETAIL-1               TO PRT.                          ECS152
  2199     MOVE '0'                    TO P-CTL.                        ECS152
  2200     PERFORM 0730-PRT-RTN THRU 0740-PRT-RTN-X.                    ECS152
  2201                                                                     CL**4
  2202     MOVE 'A-H OUT BAL    '      TO D1-MSG.                       ECS152
  2203     MOVE +10                    TO Z.                            ECS152
  2204     PERFORM 0470-BUILD-DETAIL-1 THRU 0480-BUILD-D-EXIT.          ECS152
  2205     MOVE DETAIL-1               TO PRT.                          ECS152
  2206     PERFORM 0730-PRT-RTN THRU 0740-PRT-RTN-X.                    ECS152
  2207                                                                     CL**4
  2208     MOVE ZERO-FIELDS-1          TO TOTAL-PRINT-AMOUNTS.          ECS152
  2209     PERFORM 0440-ADD-SUB-TOTALS THRU 0450-ADD-SUB-EXIT           ECS152
  2210         VARYING Z FROM 9 BY 1 UNTIL Z GREATER 10.                ECS152
  2211     PERFORM 0760-MOVE-G1-TO-PRINT THRU 0770-MOVE-G1-EXIT.        ECS152
  2212     MOVE '  TOTAL A-H    '      TO D1-MSG.                       ECS152
  2213     MOVE DETAIL-1               TO PRT.                          ECS152
  2214     PERFORM 0730-PRT-RTN THRU 0740-PRT-RTN-X.                    ECS152
  2215                                                                     CL**4
  2216     PERFORM 0780-MOVE-T1-TO-PRINT THRU 0790-MOVE-T1-EXIT.        ECS152
  2217     MOVE '  TOTAL INS    '      TO D1-MSG.                       ECS152
  2218     MOVE DETAIL-1               TO PRT.                          ECS152
  2219     MOVE '0'                    TO P-CTL.                        ECS152
  2220     PERFORM 0730-PRT-RTN THRU 0740-PRT-RTN-X.                    ECS152
  2221                                                                  ECS152
  2222 0900-DUMP-2-FINAL.                                               ECS152
  2223                                                                     CL**4
  2224     IF Y LESS +3                                                    CL**4
  2225         GO TO 0910-DUMP-2-EXIT.                                     CL**4
  2226                                                                     CL**4
  2227     MOVE HD-15                  TO PRT.                          ECS152
  2228     PERFORM 0730-PRT-RTN THRU 0740-PRT-RTN-X.                    ECS152
  2229                                                                     CL**4
  2230     MOVE 'INCURRED IN THIS PERIOD -  ' TO D3-MSG.                ECS152
  2231     MOVE TOT-AH-PD-THIS         TO D3-AH-AMT.                    ECS152
  2232     MOVE DETAIL-3               TO PRT.                          ECS152
  2233     MOVE '0'                    TO P-CTL.                        ECS152
  2234     PERFORM 0730-PRT-RTN THRU 0740-PRT-RTN-X.                    ECS152
  2235                                                                     CL**4
  2236     MOVE 'INCURRED IN PRIOR PERIOD - ' TO D3-MSG.                ECS152
  2237     MOVE TOT-AH-PD-LAST         TO D3-AH-AMT.                    ECS152
  2238     MOVE DETAIL-3               TO PRT.                          ECS152
  2239     PERFORM 0730-PRT-RTN THRU 0740-PRT-RTN-X.                    ECS152
  2240                                                                     CL**4
  2241 0910-DUMP-2-EXIT.                                                ECS152
  2242     EXIT.                                                        ECS152
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  53
* ECS152.cbl
  2244                                                                     CL**4
  2245 0930-DUMP-PAGE-3.                                                ECS152
  2246*                                                                 ECS152
  2247*    THIS PRINT,  LIKE THE OTHERS,  STARTS WITH LINE 8.           ECS152
  2248*                                                                 ECS152
  2249     MOVE HD-13                  TO PRT.                          ECS152
  2250     PERFORM 0730-PRT-RTN THRU 0740-PRT-RTN-X.                    ECS152
  2251                                                                     CL**4
  2252     MOVE HD-14                  TO PRT.                          ECS152
  2253     PERFORM 0730-PRT-RTN THRU 0740-PRT-RTN-X.                    ECS152
  2254                                                                     CL**4
  2255     MOVE 'IN FORCE AT END OF PREVIOUS PERIOD' TO D2-MSG.         ECS152
  2256     MOVE +1                     TO Z.                            ECS152
  2257     PERFORM 0490-BUILD-DETAIL-2 THRU 0500-BUILD-2-EXIT.          ECS152
  2258     MOVE DETAIL-2               TO PRT.                          ECS152
  2259     MOVE '0'                    TO P-CTL.                        ECS152
  2260     PERFORM 0730-PRT-RTN THRU 0740-PRT-RTN-X.                    ECS152
  2261                                                                     CL**4
  2262     MOVE 'ISSUED DURING THIS PERIOD         ' TO D2-MSG.         ECS152
  2263     MOVE +2                     TO Z.                            ECS152
  2264     PERFORM 0490-BUILD-DETAIL-2 THRU 0500-BUILD-2-EXIT.          ECS152
  2265     MOVE DETAIL-2               TO PRT.                          ECS152
  2266     PERFORM 0730-PRT-RTN THRU 0740-PRT-RTN-X.                    ECS152
  2267                                                                     CL**4
  2268     MOVE '         SUB-TOTAL IN FORCE       ' TO D2-MSG.         ECS152
  2269     MOVE +3                     TO Z.                            ECS152
  2270     PERFORM 0490-BUILD-DETAIL-2 THRU 0500-BUILD-2-EXIT.          ECS152
  2271     MOVE DETAIL-2               TO PRT.                          ECS152
  2272     MOVE '0'                    TO P-CTL.                        ECS152
  2273     PERFORM 0730-PRT-RTN THRU 0740-PRT-RTN-X.                    ECS152
  2274                                                                     CL**4
  2275     MOVE 'DEATH CLAIMS PAID THIS PERIOD     ' TO D2-MSG.         ECS152
  2276     MOVE +4                     TO Z.                            ECS152
  2277     PERFORM 0490-BUILD-DETAIL-2 THRU 0500-BUILD-2-EXIT.          ECS152
  2278     MOVE DETAIL-2               TO PRT.                          ECS152
  2279     MOVE '0'                    TO P-CTL.                        ECS152
  2280     PERFORM 0730-PRT-RTN THRU 0740-PRT-RTN-X.                    ECS152
  2281                                                                     CL**4
  2282     MOVE 'EXPIRATIONS IN THIS PERIOD        ' TO D2-MSG.         ECS152
  2283     MOVE +5                     TO Z.                            ECS152
  2284     PERFORM 0490-BUILD-DETAIL-2 THRU 0500-BUILD-2-EXIT.          ECS152
  2285     MOVE DETAIL-2               TO PRT.                          ECS152
  2286     PERFORM 0730-PRT-RTN THRU 0740-PRT-RTN-X.                    ECS152
  2287                                                                     CL**4
  2288     MOVE 'CANCELLATIONS IN THIS PERIOD      ' TO D2-MSG.         ECS152
  2289     MOVE +6                     TO Z.                            ECS152
  2290     PERFORM 0490-BUILD-DETAIL-2 THRU 0500-BUILD-2-EXIT.          ECS152
  2291     MOVE DETAIL-2               TO PRT.                          ECS152
  2292     PERFORM 0730-PRT-RTN THRU 0740-PRT-RTN-X.                    ECS152
  2293                                                                     CL**4
  2294     MOVE 'OTHER DECREASES                   ' TO D2-MSG.         ECS152
  2295     MOVE +7                     TO Z.                            ECS152
  2296     PERFORM 0490-BUILD-DETAIL-2 THRU 0500-BUILD-2-EXIT.          ECS152
  2297     MOVE DETAIL-2               TO PRT.                          ECS152
  2298     PERFORM 0730-PRT-RTN THRU 0740-PRT-RTN-X.                    ECS152
  2299                                                                     CL**4
  2300     MOVE '         SUB-TOTAL OF DEDUCTIONS  ' TO D2-MSG.         ECS152
  2301     MOVE +8                     TO Z.                            ECS152
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  54
* ECS152.cbl
  2302     PERFORM 0490-BUILD-DETAIL-2 THRU 0500-BUILD-2-EXIT.          ECS152
  2303     MOVE DETAIL-2               TO PRT.                          ECS152
  2304     MOVE '0'                    TO P-CTL.                        ECS152
  2305     PERFORM 0730-PRT-RTN THRU 0740-PRT-RTN-X.                    ECS152
  2306                                                                     CL**4
  2307     MOVE 'IN FORCE AT END OF CURRENT PERIOD ' TO D2-MSG.         ECS152
  2308     MOVE +9                     TO Z.                            ECS152
  2309     PERFORM 0490-BUILD-DETAIL-2 THRU 0500-BUILD-2-EXIT.          ECS152
  2310     MOVE DETAIL-2               TO PRT.                          ECS152
  2311     MOVE '0'                    TO P-CTL.                        ECS152
  2312     PERFORM 0730-PRT-RTN THRU 0740-PRT-RTN-X.                    ECS152
  2313                                                                     CL**4
  2314     MOVE ZERO TO D2-GRP-CNT  D2-GRP-AMT  D2-IND-CNT  D2-IND-AMT. ECS152
  2315     MOVE ALL '*'                TO D2-MSG.                       ECS152
  2316     MOVE DETAIL-2               TO PRT.                          ECS152
  2317     MOVE '0'                    TO P-CTL.                        ECS152
  2318     PERFORM 0730-PRT-RTN THRU 0740-PRT-RTN-X.                    ECS152
  2319                                                                     CL**4
  2320     MOVE 'IN FORCE AT END OF PREVIOUS PERIOD' TO D2-MSG.         ECS152
  2321     MOVE DETAIL-2               TO PRT.                          ECS152
  2322     MOVE '0'                    TO P-CTL.                        ECS152
  2323     PERFORM 0730-PRT-RTN THRU 0740-PRT-RTN-X.                    ECS152
  2324                                                                     CL**4
  2325     MOVE '    TERMS OF 1 THRU 60 MONTHS     ' TO D2-MSG.         ECS152
  2326     MOVE +1                     TO Y.                            ECS152
  2327     MOVE +1                     TO Z.                            ECS152
  2328     PERFORM 0510-BUILD-DETAIL-2A THRU 0520-BUILD-2A-EXIT.        ECS152
  2329     MOVE DETAIL-2               TO PRT.                          ECS152
  2330     PERFORM 0730-PRT-RTN THRU 0740-PRT-RTN-X.                    ECS152
  2331                                                                     CL**4
  2332     MOVE '    TERMS OF 61 THRU 120 MONTHS   ' TO D2-MSG.         ECS152
  2333     MOVE +2                     TO Y.                            ECS152
  2334     PERFORM 0510-BUILD-DETAIL-2A THRU 0520-BUILD-2A-EXIT.        ECS152
  2335     MOVE DETAIL-2               TO PRT.                          ECS152
  2336     PERFORM 0730-PRT-RTN THRU 0740-PRT-RTN-X.                    ECS152
  2337                                                                     CL**4
  2338     MOVE '    TERMS GREATER THAN 120 MONTHS ' TO D2-MSG.         ECS152
  2339     MOVE +3                     TO Y.                            ECS152
  2340     PERFORM 0510-BUILD-DETAIL-2A THRU 0520-BUILD-2A-EXIT.        ECS152
  2341     MOVE DETAIL-2               TO PRT.                          ECS152
  2342     PERFORM 0730-PRT-RTN THRU 0740-PRT-RTN-X.                    ECS152
  2343                                                                     CL**4
  2344     MOVE ZERO TO D2-GRP-CNT  D2-GRP-AMT  D2-IND-CNT  D2-IND-AMT. ECS152
  2345     MOVE 'IN FORCE AT END OF CURRENT PERIOD ' TO D2-MSG.         ECS152
  2346     MOVE DETAIL-2               TO PRT.                          ECS152
  2347     MOVE '0'                    TO P-CTL.                        ECS152
  2348     PERFORM 0730-PRT-RTN THRU 0740-PRT-RTN-X.                    ECS152
  2349                                                                     CL**4
  2350     MOVE '    TERMS OF 1 THRU 60 MONTHS     ' TO D2-MSG.         ECS152
  2351     MOVE +1                     TO Y.                            ECS152
  2352     MOVE +9                     TO Z.                            ECS152
  2353     PERFORM 0510-BUILD-DETAIL-2A THRU 0520-BUILD-2A-EXIT.        ECS152
  2354     MOVE DETAIL-2               TO PRT.                          ECS152
  2355     PERFORM 0730-PRT-RTN THRU 0740-PRT-RTN-X.                    ECS152
  2356                                                                     CL**4
  2357     MOVE '    TERMS OF 61 THRU 120 MONTHS   ' TO D2-MSG.         ECS152
  2358     MOVE +2                     TO Y.                            ECS152
  2359     PERFORM 0510-BUILD-DETAIL-2A THRU 0520-BUILD-2A-EXIT.        ECS152
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  55
* ECS152.cbl
  2360     MOVE DETAIL-2               TO PRT.                          ECS152
  2361     PERFORM 0730-PRT-RTN THRU 0740-PRT-RTN-X.                    ECS152
  2362                                                                     CL**4
  2363     MOVE '    TERMS GREATER THAN 120 MONTHS ' TO D2-MSG.         ECS152
  2364     MOVE +3                     TO Y.                            ECS152
  2365     PERFORM 0510-BUILD-DETAIL-2A THRU 0520-BUILD-2A-EXIT.        ECS152
  2366     MOVE DETAIL-2               TO PRT.                          ECS152
  2367     PERFORM 0730-PRT-RTN THRU 0740-PRT-RTN-X.                    ECS152
  2368                                                                     CL**4
  2369 0940-DUMP-3-EXIT.                                                ECS152
  2370     EXIT.                                                        ECS152
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  56
* ECS152.cbl
  2372                                                                  ECS152
  2373 0960-NO-PRINT.                                                   ECS152
  2374     MOVE RUN-DATE TO WS-WORK-DATE.                               ECS152
  2375     MOVE WS-DAY                 TO HD-5-DAY.                     ECS152
  2376     MOVE WS-YEAR                TO HD-5-YEAR.                    ECS152
  2377     MOVE MONTH-ALPHA (WS-MONTH) TO HD-5-MONTH.                   ECS152
  2378                                                                  ECS152
  2379     MOVE EP-DT                  TO WS-WORK-DATE.                 ECS152
  2380     MOVE WS-DAY                 TO HD-6-DAY.                     ECS152
  2381     MOVE WS-YEAR                TO HD-6-YEAR.                    ECS152
  2382     MOVE MONTH-ALPHA (WS-MONTH) TO HD-6-MONTH.                   ECS152
  2383                                                                  ECS152
  2384     PERFORM 0710-PRINT-HEADINGS THRU 0720-P-H-X.                 ECS152
  2385     MOVE 'PROGRAM COMPLETED - NO PRINT DATA' TO P-DATA.          ECS152
  2386     PERFORM 0730-PRT-RTN THRU 0740-PRT-RTN-X.                    ECS152
  2387                                                                  ECS152
  2388 0970-END-JOB.                                                    ECS152
  2389     CLOSE  PRT-FILE.                                             ECS152
  2390     IF FICH-OPEN = 'X'                                           ECS152
  2391         CLOSE FICH.                                              ECS152
  2392 0980-EOJ-EXIT.                                                      CL**4
  2393     EXIT.                                                           CL**4
  2394                                                                     CL**4
  2395 ABEND-PGM.
*                                      COPY ELCABEND.                   ECS152
  2396***************************************************************** 04/14/98
  2397*                                                               * ELCABEND
  2398*                            ELCABEND.                          *    LV003
  2399*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
  2400*                            VMOD 2.002                              CL**2
  2401*                                                               * ELCABEND
  2402*                THIS SECTION DISPLAYS THE NECESSARY MESSAGES   * ELCABEND
  2403*            AND THEN ABENDS.                                   * ELCABEND
  2404*                                                               * ELCABEND
  2405*  NO  CID  MODS  IN  COPYBOOK  ELCABEND                        * ELCABEND
  2406*                                                               * ELCABEND
  2407***************************************************************** ELCABEND
  2408*APS-010.                                                         ELCABEND
  2409     DISPLAY WS-ABEND-MESSAGE.                                    ELCABEND
  2410     DISPLAY WS-ABEND-MESSAGE UPON CONSOLE.                       ELCABEND
  2411                                                                  ELCABEND
  2412     IF WS-ABEND-FILE-STATUS NOT = ZERO                           ELCABEND
  2413         DISPLAY 'FILE STATUS = ' WS-ABEND-FILE-STATUS            ELCABEND
  2414         DISPLAY 'FILE STATUS = ' WS-ABEND-FILE-STATUS            ELCABEND
  2415                                 UPON CONSOLE.                    ELCABEND
  2416                                                                  ELCABEND
  2417     IF WS-RETURN-CODE NOT = ZERO                                 ELCABEND
  2418         DISPLAY 'RETURN CODE = '  WS-RETURN-CODE                 ELCABEND
  2419         DISPLAY 'RETURN CODE = '  WS-RETURN-CODE                 ELCABEND
  2420                                 UPON CONSOLE.                    ELCABEND
  2421                                                                  ELCABEND
  2422     DISPLAY 'PROGRAM WILL NOW ABEND **************'              ELCABEND
  2423     DISPLAY 'PROGRAM WILL NOW ABEND **************'              ELCABEND
  2424                                 UPON CONSOLE.                    ELCABEND
  2425                                                                  ELCABEND
  2426     DIVIDE WS-ZERO BY WS-ZERO GIVING WS-ZERO.                    ELCABEND
  2427     CALL 'ABORTME'.
  2428                                                                  ELCABEND
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  57
* ECS152.cbl (/apps/prod/cid1p/copy/ELCABEND)
  2429 APS-EXIT.                                                        ELCABEND
  2430     EXIT.                                                        ELCABEND
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  58
* ECS152.cbl
  2431/                                                                 ECS152
  2432 LCP-WRITE-POS-PRT SECTION.                                       ECS152
  2433     IF LCP-ASA = '+'                                             ECS152
  2434         WRITE PRT AFTER 0 LINE                                   ECS152
  2435     ELSE                                                         ECS152
  2436     IF LCP-ASA = ' '                                             ECS152
  2437         WRITE PRT AFTER ADVANCING 1 LINE                         ECS152
  2438     ELSE                                                         ECS152
  2439     IF LCP-ASA = '0'                                             ECS152
  2440         WRITE PRT AFTER ADVANCING 2 LINE                         ECS152
  2441     ELSE                                                         ECS152
  2442     IF LCP-ASA = '-'                                             ECS152
  2443         WRITE PRT AFTER ADVANCING 3 LINE                         ECS152
  2444     ELSE                                                         ECS152
  2445     IF LCP-ASA = '1'                                             ECS152
  2446         WRITE PRT AFTER ADVANCING PAGE                           ECS152
  2447     ELSE                                                         ECS152
  2448     IF LCP-ASA = '2'                                             ECS152
  2449         WRITE PRT AFTER ADVANCING LCP-CH2                        ECS152
  2450     ELSE                                                         ECS152
  2451     IF LCP-ASA = '3'                                             ECS152
  2452         WRITE PRT AFTER ADVANCING LCP-CH3                        ECS152
  2453     ELSE                                                         ECS152
  2454     IF LCP-ASA = '4'                                             ECS152
  2455         WRITE PRT AFTER ADVANCING LCP-CH4                        ECS152
  2456     ELSE                                                         ECS152
  2457     IF LCP-ASA = '5'                                             ECS152
  2458         WRITE PRT AFTER ADVANCING LCP-CH5                        ECS152
  2459     ELSE                                                         ECS152
  2460     IF LCP-ASA = '6'                                             ECS152
  2461         WRITE PRT AFTER ADVANCING LCP-CH6                        ECS152
  2462     ELSE                                                         ECS152
  2463     IF LCP-ASA = '7'                                             ECS152
  2464         WRITE PRT AFTER ADVANCING LCP-CH7                        ECS152
  2465     ELSE                                                         ECS152
  2466     IF LCP-ASA = '8'                                             ECS152
  2467         WRITE PRT AFTER ADVANCING LCP-CH8                        ECS152
  2468     ELSE                                                         ECS152
  2469     IF LCP-ASA = '9'                                             ECS152
  2470         WRITE PRT AFTER ADVANCING LCP-CH9                        ECS152
  2471     ELSE                                                         ECS152
  2472     IF LCP-ASA = 'A'                                             ECS152
  2473         WRITE PRT AFTER ADVANCING LCP-CH10                       ECS152
  2474     ELSE                                                         ECS152
  2475     IF LCP-ASA = 'B'                                             ECS152
  2476         WRITE PRT AFTER ADVANCING LCP-CH11                       ECS152
  2477     ELSE                                                         ECS152
  2478     IF LCP-ASA = 'C'                                             ECS152
  2479         WRITE PRT AFTER ADVANCING LCP-CH12                       ECS152
  2480     ELSE                                                         ECS152
  2481     IF LCP-ASA = 'V'                                             ECS152
  2482         WRITE PRT AFTER ADVANCING LCP-P01                        ECS152
  2483     ELSE                                                         ECS152
  2484     IF LCP-ASA = 'W'                                             ECS152
  2485         WRITE PRT AFTER ADVANCING LCP-P02                        ECS152
  2486     ELSE                                                         ECS152
  2487     DISPLAY 'ASA CODE ERROR'.                                    ECS152
  2488 LCP-WRITE-END-PRT.                                               ECS152
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  59
* ECS152.cbl
  2489     EXIT.                                                        ECS152
  2490                                                                  ECS152
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:       68116     Code:       13821
