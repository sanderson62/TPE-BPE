* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   1
* PEMBEF1.cbl
* Options: int("PEMBEF1.int") anim csi verbose NOBOUND PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("PEMBEF1.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"ebmlsfile" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" NOCHECKDIV NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"32" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"PEMBEF1.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"PEMBEF1.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR NOSTICKY-LINKAGE
*          NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"2" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2 PROGRAM-ID. PEMBEF1.
     3 AUTHOR.     PABLO.
     4 DATE-COMPILED. 06-Oct-15 17:19.
     6 ENVIRONMENT DIVISION.
     7 INPUT-OUTPUT SECTION.
     8 FILE-CONTROL.
     9
    10     SELECT ZIP-FILE-IN          ASSIGN TO SYS010
    11        ORGANIZATION IS LINE SEQUENTIAL.
    12
    13     SELECT ELBENE           ASSIGN TO ELBENE
    14                             ORGANIZATION IS INDEXED
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   2
* PEMBEF1.cbl
    15                             ACCESS IS DYNAMIC
    16                             RECORD KEY IS BE-CONTROL-PRIMARY
    17                             FILE STATUS IS ELBENE-FILE-STATUS.
    18
    19 DATA DIVISION.
    20 FILE SECTION.
    21
    22 FD  ZIP-FILE-IN
    23     BLOCK CONTAINS 0 RECORDS
    24     RECORDING MODE IS F.
    25
    26 01  ZIP-IN-REC.
    27     05  ZIP-CODE               PIC X(05).
    28     05  ZIP-STATE              PIC XX.
    29     05  FILLER                 PIC X.
    30     05  ZIP-CITY               PIC X(34).
    31     05  FILLER                 PIC X.
    32
    33 FD  ELBENE.
    34
*   35                                 COPY ELCBENE.
    36******************************************************************04/15/98
    37*                                                                *ELCBENE
    38*                            ELCBENE.                            *   LV002
    39*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
    40*                            VMOD=2.006                          *   CL**2
    41*                                                                *ELCBENE
    42*   FILE DESCRIPTION = BENEFICIARY FILE                          *ELCBENE
    43*                                                                *ELCBENE
    44*   FILE TYPE = VSAM,KSDS                                        *ELCBENE
    45*   RECORD SIZE = 500   RECFORM = FIX                            *ELCBENE
    46*                                                                *ELCBENE
    47*   BASE CLUSTER NAME = ELBENE                   RKP=2,LEN=12    *ELCBENE
    48*     ALTERNATE PATH1 = ELBENE2 (ALT BY NAME)    RKP=14,LEN=42   *ELCBENE
    49*                                                                *ELCBENE
    50*   LOG = YES                                                    *ELCBENE
    51*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *ELCBENE
    52*                                                                *ELCBENE
    53*  NO  CID  MODS  TO  COPYBOOK  ELCBENE                          *ELCBENE
    54******************************************************************ELCBENE
    55                                                                  ELCBENE
    56 01  BENEFICIARY-MASTER.                                          ELCBENE
    57     12  BE-RECORD-ID                PIC XX.                      ELCBENE
    58         88  VALID-BE-ID                VALUE 'BE'.               ELCBENE
    59                                                                  ELCBENE
    60     12  BE-CONTROL-PRIMARY.                                      ELCBENE
    61         16  BE-COMPANY-CD           PIC X.                       ELCBENE
    62         16  BE-RECORD-TYPE          PIC X.                       ELCBENE
    63             88  BENEFICIARY-RECORD  VALUE 'B'.                   ELCBENE
    64             88  ADJUSTOR-RECORD     VALUE 'A'.                   ELCBENE
    65         16  BE-BENEFICIARY          PIC X(10).                   ELCBENE
    66     12  BE-CONTROL-BY-NAME.                                      ELCBENE
    67         16  BE-COMPANY-CD-A1        PIC X.                       ELCBENE
    68         16  BE-RECORD-TYPE-A1       PIC X.                       ELCBENE
    69         16  BE-MAIL-TO-NAME-A1      PIC X(30).                   ELCBENE
    70         16  BE-ALTERNATE-PRIME-A1   PIC X(10).                   ELCBENE
    71                                                                  ELCBENE
    72     12  BE-LAST-MAINT-DT            PIC XX.                      ELCBENE
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   3
* PEMBEF1.cbl (/apps/prod/cid1p/copy/ELCBENE)
    73     12  BE-LAST-MAINT-BY            PIC X(4).                    ELCBENE
    74     12  BE-LAST-MAINT-HHMMSS        PIC S9(6)     COMP-3.        ELCBENE
    75                                                                  ELCBENE
    76     12  BE-ADDRESS-DATA.                                         ELCBENE
    77         16  BE-MAIL-TO-NAME         PIC X(30).                   ELCBENE
    78         16  BE-ADDRESS-LINE-1       PIC X(30).                   ELCBENE
    79         16  BE-ADDRESS-LINE-2       PIC X(30).                   ELCBENE
    80         16  BE-ADDRESS-LINE-3       PIC X(30).                   ELCBENE
    81         16  BE-CITY-STATE.
    82             20  BE-CITY             PIC X(28).
    83             20  BE-STATE            PIC XX.
    84         16  BE-ZIP-CODE.                                         ELCBENE
    85             20  BE-ZIP-PRIME.                                    ELCBENE
    86                 24  BE-ZIP-1ST      PIC X.                       ELCBENE
    87                     88  BE-CANADIAN-POST-CODE                    ELCBENE
    88                                         VALUE 'A' THRU 'Z'.      ELCBENE
    89                 24  FILLER          PIC X(4).                    ELCBENE
    90             20  BE-ZIP-PLUS4        PIC X(4).                    ELCBENE
    91         16  BE-CANADIAN-POSTAL-CODE  REDEFINES  BE-ZIP-CODE.     ELCBENE
    92             20  BE-CAN-POSTAL-1     PIC XXX.                     ELCBENE
    93             20  BE-CAN-POSTAL-2     PIC XXX.                     ELCBENE
    94             20  FILLER              PIC XXX.                     ELCBENE
    95         16  BE-PHONE-NO             PIC 9(11)     COMP-3.        ELCBENE
    96         16  BE-GROUP-CHECKS-Y-N     PIC X.                       ELCBENE
    97                                                                  ELCBENE
    98******************************************************************ELCBENE
    99*    THE BE-CARRIER FIELD IS USED BY 'AIG' TO DETERMINE HOW TO   *ELCBENE
   100*    SET THE CARRIER CODE IN THE PENDING CLAIM FILE.             *ELCBENE
   101******************************************************************ELCBENE
   102     12  BE-CARRIER                  PIC X.                       ELCBENE
   103                                                                  ELCBENE
   104     12  BE-ADDRESS-DATA2.                                        ELCBENE
   105         16  BE-MAIL-TO-NAME2        PIC X(30).                   ELCBENE
   106         16  BE-ADDRESS-LINE-12      PIC X(30).                   ELCBENE
   107         16  BE-ADDRESS-LINE-22      PIC X(30).                   ELCBENE
   108         16  BE-ADDRESS-LINE-32      PIC X(30).                   ELCBENE
   109         16  BE-CITY-STATE2.
   110             20  BE-CITY2            PIC X(28).
   111             20  BE-STATE2           PIC XX.
   112         16  BE-ZIP-CODE2.                                        ELCBENE
   113             20  BE-ZIP-PRIME2.                                   ELCBENE
   114                 24  BE-ZIP-1ST2     PIC X.                       ELCBENE
   115                     88  BE-CANADIAN-POST-CODE2                   ELCBENE
   116                                         VALUE 'A' THRU 'Z'.      ELCBENE
   117                 24  FILLER          PIC X(4).                    ELCBENE
   118             20  BE-ZIP-PLUS42       PIC X(4).                    ELCBENE
   119         16  BE-CANADIAN-POSTAL-CODE2 REDEFINES  BE-ZIP-CODE2.    ELCBENE
   120             20  BE-CAN-POSTAL-12    PIC XXX.                     ELCBENE
   121             20  BE-CAN-POSTAL-22    PIC XXX.                     ELCBENE
   122             20  FILLER              PIC XXX.                     ELCBENE
   123         16  BE-PHONE-NO2            PIC 9(11)     COMP-3.        ELCBENE
   124         16  BE-BILLING-STMT-DATA.                                ELCBENE
   125             20  BE-BSR              PIC X.                       ELCBENE
   126                 88  BE-AUTOMATED-BSR      VALUE 'A'.             ELCBENE
   127                 88  BE-NOT-AUTOMATED-BSR  VALUE ' '.             ELCBENE
   128             20  BE-BSR-FROM         PIC X(30).                   ELCBENE
   129             20  BE-BSR-DEPT         PIC X(30).                   ELCBENE
   130             20  BE-BSR-PHONE-NUM    PIC 9(11)     COMP-3.        ELCBENE
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   4
* PEMBEF1.cbl (/apps/prod/cid1p/copy/ELCBENE)
   131             20  BE-BSR-FAX-NUM      PIC 9(11)     COMP-3.        ELCBENE
   132             20  BE-OUTPUT-TYPE      PIC X.                       ELCBENE
   133                 88  BE-FAX-OUTPUT         VALUE 'F'.             ELCBENE
   134                 88  BE-PRINT-OUTPUT       VALUE 'P' ' '.         ELCBENE
   135                                                                  ELCBENE
   136     12  FILLER                      PIC X(28).                   ELCBENE
   137******************************************************************ELCBENE
   138
   139 WORKING-STORAGE SECTION.
   140 77  S1                          PIC S9(3) COMP-3 VALUE +0.
   141 77  WS-STATE-SW                 PIC X  VALUE ' '.
   142     88  VALID-STATE               VALUE 'Y'.
   143 77  WS-DIS-EFF-DT               PIC X(10)  VALUE SPACES.
   144 77  WS-DIS-EXP-DT               PIC X(10)  VALUE SPACES.
   145 77  WS-REWRITE-SW               PIC X      VALUE SPACES.
   146     88  REWRITE-BE                 VALUE 'Y'.
   147 77  WS-ADDR-SW                  PIC X VALUE ' '.
   148     88  INS-ADDR                  VALUE '1'.
   149     88  BENE-ADDR                 VALUE '2'.
   150 77  WS-TABLE-EOF-SW             PIC X  VALUE SPACES.
   151     88  END-OF-TABLE               VALUE 'Y'.
   152 77  WS-INS-FIX                  PIC X  VALUE ' '.
   153     88  INS-FIXED                VALUE 'Y'.
   154 77  WS-BEN-FIX                  PIC X  VALUE ' '.
   155     88  BEN-FIXED                VALUE 'Y'.
   156 01  WS-STATUS-CODES.
   157     05  ELBENE-FILE-STATUS      PIC XX  VALUE SPACES.
   158     05  WS-EOF-SW               PIC X   VALUE SPACES.
   159         88  END-OF-ELBENE               VALUE 'Y'.
   160         88  MORE-ELBENE                 VALUE ' '.
   161
   162*****************************************************************
   163*                                                               *
   164*                     STATE CODE TABLE                          *
   165*                                                               *
   166*  CAUTION:  THIS TABLE MUST BE IN SEQUENCE BY STATE OR THE     *
   167*            SEARCH VERB WILL NOT WORK PROPERLY !               *
   168*                                                               *
   169*****************************************************************
   170
   171 01  STATE-VALUES.
   172     05  PIC X(24)  VALUE 'AAAA                    '.
   173     05  PIC X(24)  VALUE 'AEAE                    '.
   174     05  PIC X(24)  VALUE 'AKAKALASKA              '.
   175     05  PIC X(24)  VALUE 'ALALALABAMA             '.
   176     05  PIC X(24)  VALUE 'APAP                    '.
   177     05  PIC X(24)  VALUE 'ARARARKANSAS            '.
   178     05  PIC X(24)  VALUE 'ASASAMERICAN SAMOA      '.
   179     05  PIC X(24)  VALUE 'AZAZARIZONA             '.
   180     05  PIC X(24)  VALUE 'CACACALIFORNIA          '.
   181     05  PIC X(24)  VALUE 'CDCNCANADA              '.
   182     05  PIC X(24)  VALUE 'CNCNCANADA              '.
   183     05  PIC X(24)  VALUE 'COCOCOLORADO            '.
   184     05  PIC X(24)  VALUE 'CTCTCONNECTICUT         '.
   185     05  PIC X(24)  VALUE 'DCDCDISTRICT OF COLUMBIA'.
   186     05  PIC X(24)  VALUE 'DEDEDELAWARE            '.
   187     05  PIC X(24)  VALUE 'FCOTOTHER ALIEN         '.
   188     05  PIC X(24)  VALUE 'FLFLFLORIDA             '.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   5
* PEMBEF1.cbl
   189     05  PIC X(24)  VALUE 'GAGAGEORGIA             '.
   190     05  PIC X(24)  VALUE 'GUGUGUAM                '.
   191     05  PIC X(24)  VALUE 'HIHIHAWAII              '.
   192     05  PIC X(24)  VALUE 'IAIAIOWA                '.
   193     05  PIC X(24)  VALUE 'IDIDIDAHO               '.
   194     05  PIC X(24)  VALUE 'ILILILLINOIS            '.
   195     05  PIC X(24)  VALUE 'INININDIANA             '.
   196     05  PIC X(24)  VALUE 'KSKSKANSAS              '.
   197     05  PIC X(24)  VALUE 'KYKYKENTUCKY            '.
   198     05  PIC X(24)  VALUE 'LALALOUISIANA           '.
   199     05  PIC X(24)  VALUE 'MAMAMASSACHUSETTS       '.
   200     05  PIC X(24)  VALUE 'MDMDMARYLAND            '.
   201     05  PIC X(24)  VALUE 'MEMEMAINE               '.
   202     05  PIC X(24)  VALUE 'MIMIMICHIGAN            '.
   203     05  PIC X(24)  VALUE 'MNMNMINNESOTA           '.
   204     05  PIC X(24)  VALUE 'MOMOMISSOURI            '.
   205     05  PIC X(24)  VALUE 'MSMSMISSISSIPPI         '.
   206     05  PIC X(24)  VALUE 'MTMTMONTANA             '.
   207     05  PIC X(24)  VALUE 'NCNCNORTH CAROLINA      '.
   208     05  PIC X(24)  VALUE 'NDNDNORTH DAKOTA        '.
   209     05  PIC X(24)  VALUE 'NENENEBRASKA            '.
   210     05  PIC X(24)  VALUE 'NHNHNEW HAMPSHIRE       '.
   211     05  PIC X(24)  VALUE 'NJNJNEW JERSEY          '.
   212     05  PIC X(24)  VALUE 'NMNMNEW MEXICO          '.
   213     05  PIC X(24)  VALUE 'NVNVNEVADA              '.
   214     05  PIC X(24)  VALUE 'NYNYNEW YORK            '.
   215     05  PIC X(24)  VALUE 'OFOTOTHER ALIEN         '.
   216     05  PIC X(24)  VALUE 'OHOHOHIO                '.
   217     05  PIC X(24)  VALUE 'OKOKOKLAHOMA            '.
   218     05  PIC X(24)  VALUE 'OROROREGON              '.
   219     05  PIC X(24)  VALUE 'OTOTOTHER ALIEN         '.
   220     05  PIC X(24)  VALUE 'PAPAPENNSYLVANIA        '.
   221     05  PIC X(24)  VALUE 'PRPRPUERTO RICO         '.
   222     05  PIC X(24)  VALUE 'RIRIRHODE ISLAND        '.
   223     05  PIC X(24)  VALUE 'SCSCSOUTH CAROLINA      '.
   224     05  PIC X(24)  VALUE 'SDSDSOUTH DAKOTA        '.
   225     05  PIC X(24)  VALUE 'TNTNTENNESSEE           '.
   226     05  PIC X(24)  VALUE 'TXTXTEXAS               '.
   227     05  PIC X(24)  VALUE 'UTUTUTAH                '.
   228     05  PIC X(24)  VALUE 'VAVAVIRGINIA            '.
   229     05  PIC X(24)  VALUE 'VIVIUS VIRGIN ISLANDS   '.
   230     05  PIC X(24)  VALUE 'VTVTVERMONT             '.
   231     05  PIC X(24)  VALUE 'WAWAWASHINGTON          '.
   232     05  PIC X(24)  VALUE 'WIWIWISCONSIN           '.
   233     05  PIC X(24)  VALUE 'WVWVWEST VIRGINIA       '.
   234     05  PIC X(24)  VALUE 'WYWYWYOMING             '.
   235
   236 01  FILLER REDEFINES STATE-VALUES.
   237     05  STATE-TABLE
   238             OCCURS 63 TIMES
   239             ASCENDING KEY IS ST-STATE
   240             INDEXED BY ST-INDEX.
   241         10  ST-STATE          PIC XX.
   242         10  ST-ALT-STATE      PIC XX.
   243         10  ST-NAME           PIC X(20).
   244
*  245                                 COPY ELCDATE.
   246******************************************************************06/11/98
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   6
* PEMBEF1.cbl (/apps/prod/cid1p/copy/ELCDATE)
   247*                                                                *ELCDATE
   248*                                                                *ELCDATE
   249*                            ELCDATE.                            *   LV023
   250*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL*16
   251*                            VMOD=2.003                           ELCDATE
   252*                                                                *ELCDATE
   253*                                                                *ELCDATE
   254*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *ELCDATE
   255*                 LENGTH = 200                                   *   CL*19
   256******************************************************************ELCDATE
   257                                                                  ELCDATE
   258 01  DATE-CONVERSION-DATA.                                        ELCDATE
   259     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.    CL*19
   260     12  DC-OPTION-CODE                PIC X.                        CL*15
   261         88  BIN-TO-GREG                VALUE ' '.                ELCDATE
   262         88  ELAPSED-BETWEEN-BIN        VALUE '1'.                ELCDATE
   263         88  EDIT-GREG-TO-BIN           VALUE '2'.                ELCDATE
   264         88  YMD-GREG-TO-BIN            VALUE '3'.                ELCDATE
   265         88  MDY-GREG-TO-BIN            VALUE '4'.                ELCDATE
   266         88  JULIAN-TO-BIN              VALUE '5'.                ELCDATE
   267         88  BIN-PLUS-ELAPSED           VALUE '6'.                ELCDATE
   268         88  FIND-CENTURY               VALUE '7'.                   CL*22
   269         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.                ELCDATE
   270         88  EDIT-GREG-TO-BIN-3         VALUE '9'.                ELCDATE
   271         88  YMD-GREG-TO-BIN-3          VALUE 'A'.                ELCDATE
   272         88  MDY-GREG-TO-BIN-3          VALUE 'B'.                ELCDATE
   273         88  JULIAN-TO-BIN-3            VALUE 'C'.                ELCDATE
   274         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.                ELCDATE
   275         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.                   CL*14
   276         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.                   CL*14
   277         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.                   CL*14
   278         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.         CL*14
   279         88  CHECK-LEAP-YEAR            VALUE 'H'.                   CL*14
   280         88  BIN-3-TO-GREG              VALUE 'I'.                   CL*14
   281         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.                   CL*14
   282         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.                   CL*14
   283         88  CYMD-GREG-TO-BIN           VALUE 'L'.                   CL*14
   284         88  MDCY-GREG-TO-BIN           VALUE 'M'.                   CL*14
   285         88  MDY-GREG-TO-JULIAN         VALUE 'N'.                   CL*14
   286         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.                   CL*14
   287         88  YMD-GREG-TO-JULIAN         VALUE 'P'.                   CL*14
   288         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.                   CL*14
   289         88  THREE-CHARACTER-BIN                                  ELCDATE
   290                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.       CL*14
   291         88  GREGORIAN-TO-BIN                                        CL**2
   292                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.    CL*14
   293         88  BIN-TO-GREGORIAN                                        CL**2
   294                  VALUES ' ' '1' 'I' '8' 'G'.                        CL*14
   295         88  JULIAN-TO-BINARY                                        CL**2
   296                  VALUES '5' 'C' 'E' 'F'.                            CL*14
   297     12  DC-ERROR-CODE                 PIC X.                        CL*15
   298         88  NO-CONVERSION-ERROR        VALUE ' '.                   CL**3
   299         88  DATE-CONVERSION-ERROR                                ELCDATE
   300                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.        CL*14
   301         88  DATE-IS-ZERO               VALUE '1'.                ELCDATE
   302         88  DATE-IS-NON-NUMERIC        VALUE '2'.                ELCDATE
   303         88  DATE-IS-INVALID            VALUE '3'.                ELCDATE
   304         88  DATE1-GREATER-DATE2        VALUE '4'.                ELCDATE
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   7
* PEMBEF1.cbl (/apps/prod/cid1p/copy/ELCDATE)
   305         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.                ELCDATE
   306         88  DATE-INVALID-OPTION        VALUE '9'.                ELCDATE
   307         88  INVALID-CENTURY            VALUE 'A'.                ELCDATE
   308         88  ONLY-CENTURY               VALUE 'B'.                ELCDATE
   309         88  ONLY-LEAP-YEAR             VALUE 'C'.                ELCDATE
   310         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.              CL**3
   311     12  DC-END-OF-MONTH               PIC X.                        CL*15
   312         88  CALCULATE-END-OF-MONTH     VALUE '1'.                ELCDATE
   313     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.         CL*15
   314         88  USE-NORMAL-PROCESS         VALUE ' '.                ELCDATE
   315         88  ADJUST-DOWN-100-YRS        VALUE '1'.                ELCDATE
   316         88  ADJUST-UP-100-YRS          VALUE '2'.                ELCDATE
   317     12  FILLER                        PIC X.                        CL*15
   318     12  DC-CONVERSION-DATES.                                        CL*15
   319         16  DC-BIN-DATE-1             PIC XX.                       CL*15
   320         16  DC-BIN-DATE-2             PIC XX.                       CL*15
   321         16  DC-GREG-DATE-1-EDIT       PIC X(08).                    CL*15
   322         16  DC-GREG-DATE-1-EDIT-R REDEFINES                         CL*15
   323                       DC-GREG-DATE-1-EDIT.                       ELCDATE
   324             20  DC-EDIT1-MONTH        PIC 99.                       CL*15
   325             20  SLASH1-1              PIC X.                        CL*15
   326             20  DC-EDIT1-DAY          PIC 99.                       CL*15
   327             20  SLASH1-2              PIC X.                        CL*15
   328             20  DC-EDIT1-YEAR         PIC 99.                       CL*15
   329         16  DC-GREG-DATE-2-EDIT       PIC X(08).                    CL*15
   330         16  DC-GREG-DATE-2-EDIT-R REDEFINES                         CL*15
   331                     DC-GREG-DATE-2-EDIT.                         ELCDATE
   332             20  DC-EDIT2-MONTH        PIC 99.                       CL*15
   333             20  SLASH2-1              PIC X.                        CL*15
   334             20  DC-EDIT2-DAY          PIC 99.                       CL*15
   335             20  SLASH2-2              PIC X.                        CL*15
   336             20  DC-EDIT2-YEAR         PIC 99.                       CL*15
   337         16  DC-GREG-DATE-1-YMD        PIC 9(06).                    CL*15
   338         16  DC-GREG-DATE-1-YMD-R  REDEFINES                         CL*15
   339                     DC-GREG-DATE-1-YMD.                          ELCDATE
   340             20  DC-YMD-YEAR           PIC 99.                       CL*15
   341             20  DC-YMD-MONTH          PIC 99.                       CL*15
   342             20  DC-YMD-DAY            PIC 99.                       CL*15
   343         16  DC-GREG-DATE-1-MDY        PIC 9(06).                    CL*15
   344         16  DC-GREG-DATE-1-MDY-R REDEFINES                          CL*15
   345                      DC-GREG-DATE-1-MDY.                         ELCDATE
   346             20  DC-MDY-MONTH          PIC 99.                       CL*15
   347             20  DC-MDY-DAY            PIC 99.                       CL*15
   348             20  DC-MDY-YEAR           PIC 99.                       CL*15
   349         16  DC-GREG-DATE-1-ALPHA.                                   CL*15
   350             20  DC-ALPHA-MONTH        PIC X(10).                    CL*15
   351             20  DC-ALPHA-DAY          PIC 99.                       CL*15
   352             20  FILLER                PIC XX.                       CL*15
   353             20  DC-ALPHA-CENTURY.                                   CL*15
   354                 24 DC-ALPHA-CEN-N     PIC 99.                       CL*15
   355             20  DC-ALPHA-YEAR         PIC 99.                       CL*15
   356         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.           CL*15
   357         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.           CL*15
   358         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.           CL*15
   359         16  DC-JULIAN-DATE            PIC 9(05).                    CL*15
   360         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE                CL*20
   361                                       PIC 9(05).                    CL*20
   362         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.                  CL*15
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   8
* PEMBEF1.cbl (/apps/prod/cid1p/copy/ELCDATE)
   363             20  DC-JULIAN-YEAR        PIC 99.                       CL*15
   364             20  DC-JULIAN-DAYS        PIC 999.                      CL*15
   365         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.       CL*15
   366         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.    CL*15
   367         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.    CL*15
   368     12  DATE-CONVERSION-VARIBLES.                                   CL*15
   369         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.            CL*15
   370         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.          CL*15
   371             20  FILLER                PIC 9(3).                     CL*15
   372             20  HOLD-CEN-1-CCYY.                                    CL*15
   373                 24  HOLD-CEN-1-CC     PIC 99.                       CL*17
   374                 24  HOLD-CEN-1-YY     PIC 99.                       CL*17
   375             20  HOLD-CEN-1-MO         PIC 99.                       CL*17
   376             20  HOLD-CEN-1-DA         PIC 99.                       CL*17
   377         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.            CL*15
   378             20  HOLD-CEN-1-R-MO       PIC 99.                       CL*17
   379             20  HOLD-CEN-1-R-DA       PIC 99.                       CL*17
   380             20  HOLD-CEN-1-R-CCYY.                                  CL*15
   381                 24  HOLD-CEN-1-R-CC   PIC 99.                       CL*17
   382                 24  HOLD-CEN-1-R-YY   PIC 99.                       CL*17
   383             20  FILLER                PIC 9(3).                     CL*15
   384         16  HOLD-CENTURY-1-X.                                       CL*15
   385             20  FILLER                PIC X(3)  VALUE SPACES.       CL*15
   386             20  HOLD-CEN-1-X-CCYY.                                  CL*15
   387                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.          CL*17
   388                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.          CL*17
   389             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.          CL*17
   390             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.          CL*17
   391         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.          CL*15
   392             20  HOLD-CEN-1-R-X-MO     PIC XX.                       CL*17
   393             20  HOLD-CEN-1-R-X-DA     PIC XX.                       CL*17
   394             20  HOLD-CEN-1-R-X-CCYY.                                CL*15
   395                 24  HOLD-CEN-1-R-X-CC PIC XX.                       CL*17
   396                 24  HOLD-CEN-1-R-X-YY PIC XX.                       CL*17
   397             20  FILLER                PIC XXX.                      CL*23
   398         16  DC-BIN-DATE-EXPAND-1      PIC XXX.                      CL*15
   399         16  DC-BIN-DATE-EXPAND-2      PIC XXX.                      CL*15
   400         16  DC-JULIAN-DATE-1          PIC 9(07).                    CL*15
   401         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.          CL*15
   402             20  DC-JULIAN-1-CCYY.                                   CL*15
   403                 24  DC-JULIAN-1-CC    PIC 99.                       CL*15
   404                 24  DC-JULIAN-1-YR    PIC 99.                       CL*15
   405             20  DC-JULIAN-DA-1        PIC 999.                      CL*15
   406         16  DC-JULIAN-DATE-2          PIC 9(07).                    CL*15
   407         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.          CL*15
   408             20  DC-JULIAN-2-CCYY.                                   CL*15
   409                 24  DC-JULIAN-2-CC    PIC 99.                       CL*15
   410                 24  DC-JULIAN-2-YR    PIC 99.                       CL*15
   411             20  DC-JULIAN-DA-2        PIC 999.                      CL*15
   412         16  DC-GREG-DATE-A-EDIT.                                    CL*15
   413             20  DC-EDITA-MONTH        PIC 99.                       CL*15
   414             20  SLASHA-1              PIC X VALUE '/'.              CL*15
   415             20  DC-EDITA-DAY          PIC 99.                       CL*15
   416             20  SLASHA-2              PIC X VALUE '/'.              CL*15
   417             20  DC-EDITA-CCYY.                                      CL*15
   418                 24  DC-EDITA-CENT     PIC 99.                       CL*15
   419                 24  DC-EDITA-YEAR     PIC 99.                       CL*15
   420         16  DC-GREG-DATE-B-EDIT.                                    CL*15
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   9
* PEMBEF1.cbl (/apps/prod/cid1p/copy/ELCDATE)
   421             20  DC-EDITB-MONTH        PIC 99.                       CL*15
   422             20  SLASHB-1              PIC X VALUE '/'.              CL*15
   423             20  DC-EDITB-DAY          PIC 99.                       CL*15
   424             20  SLASHB-2              PIC X VALUE '/'.              CL*15
   425             20  DC-EDITB-CCYY.                                      CL*15
   426                 24  DC-EDITB-CENT     PIC 99.                       CL*15
   427                 24  DC-EDITB-YEAR     PIC 99.                       CL*15
   428         16  DC-GREG-DATE-CYMD         PIC 9(08).                    CL*15
   429         16  DC-GREG-DATE-CYMD-R REDEFINES                           CL*15
   430                              DC-GREG-DATE-CYMD.                  ELCDATE
   431             20  DC-CYMD-CEN           PIC 99.                       CL*15
   432             20  DC-CYMD-YEAR          PIC 99.                       CL*15
   433             20  DC-CYMD-MONTH         PIC 99.                       CL*15
   434             20  DC-CYMD-DAY           PIC 99.                       CL*15
   435         16  DC-GREG-DATE-MDCY         PIC 9(08).                    CL*15
   436         16  DC-GREG-DATE-MDCY-R REDEFINES                           CL*15
   437                              DC-GREG-DATE-MDCY.                  ELCDATE
   438             20  DC-MDCY-MONTH         PIC 99.                       CL*15
   439             20  DC-MDCY-DAY           PIC 99.                       CL*15
   440             20  DC-MDCY-CEN           PIC 99.                       CL*15
   441             20  DC-MDCY-YEAR          PIC 99.                       CL*15
   442    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.      ELCDATE
   443        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.        ELCDATE
   444    12  DC-EL310-DATE                  PIC X(21).                    CL*26
   445    12  FILLER                         PIC X(28).                    CL*26
   446
   447
   448 01  Z1                          PIC S9(5) COMP-3 VALUE +0.
   449 01  FILLER.
   450     05  WS-ZIP-TABLE OCCURS 42078.
   451         10  WS-ZIP-CODE         PIC X(5).
   452         10  WS-ZIP-STATE        PIC XX.
   453         10  WS-ZIP-CITY         PIC X(28).
   454
   455
   456
   457
   458 01  WS-HOLD-CITY-STATE          PIC X(30)  VALUE SPACES.
   459 01  WS-WORK-CITY-ST.
   460     05  WS-WORK-CITY            PIC X(28)  VALUE SPACES.
   461     05  WS-WORK-STATE           PIC XX     VALUE SPACES.
   462 01  WS-HOLD-ELBENE              PIC X(374) VALUE LOW-VALUES.
   463 01  WS-WORK-FIELDS.
   464     05  WS-ABEND-FLD            PIC 9         VALUE ZEROS.
   465     05  WS-ZERO-FLD             PIC 9         VALUE ZEROS.
   466     05  WS-ELBENE-RECS-IN       PIC 9(9)      VALUE ZEROS.
   467     05  WS-ELBENE-RECS-FIX      PIC 9(9)      VALUE ZEROS.
   468     05  WS-ELBENE-RECS-DEL      PIC 9(9)      VALUE ZEROS.
   469     05  WS-DISPLAY-CNT          PIC Z,ZZZ,ZZ9 VALUE ZEROS.
   470     05  WS-INVALID-ST-CNT       PIC 9(9)      VALUE ZEROS.
   471
   472 PROCEDURE DIVISION.
   473 0000-MAINLINE.
   474
   475     PERFORM 0100-OPEN-FILES     THRU 0100-EXIT
   476     PERFORM 0200-INITIALIZE     THRU 0200-EXIT
   477     PERFORM 0300-BUILD-TABLE    THRU 0300-EXIT
   478     PERFORM 0500-PROCESS        THRU 0500-EXIT UNTIL
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  10
* PEMBEF1.cbl
   479        END-OF-ELBENE
   480*       OR WS-ELBENE-RECS-FIX > 10000
   481     PERFORM 3000-CLOSE-FILES    THRU 3000-EXIT
   482     PERFORM 4000-FINAL-TOTALS   THRU 4000-EXIT
   483     GOBACK
   484
   485     .
   486 0000-EXIT.
   487     EXIT.
   488
   489 0100-OPEN-FILES.
   490
   491     OPEN I-O   ELBENE
   492*    OPEN INPUT ELBENE
   493
   494     OPEN INPUT ZIP-FILE-IN
   495
   496     IF ELBENE-FILE-STATUS = '00'
   497         CONTINUE
   498     ELSE
   499         DISPLAY '*** ERROR OPENING ELBENE FILE ***'
   500         DISPLAY '*** STATUS CODE IS ' ELBENE-FILE-STATUS
   501         PERFORM 9999-ABEND-RTN
   502     END-IF
   503
   504     .
   505 0100-EXIT.
   506     EXIT.
   507
   508 0200-INITIALIZE.
   509
   510     MOVE SPACES                 TO WS-EOF-SW
   511     MOVE ZEROS                  TO WS-ELBENE-RECS-IN
   512                                    WS-ELBENE-RECS-FIX
   513                                    WS-ELBENE-RECS-DEL
   514
   515     PERFORM 1100-START-ELBENE   THRU 1100-EXIT
   516
   517     PERFORM 1200-READ-ELBENE    THRU 1200-EXIT
   518
   519     .
   520 0200-EXIT.
   521     EXIT.
   522
   523 0300-BUILD-TABLE.
   524
   525     PERFORM VARYING Z1 FROM +1 BY +1 UNTIL
   526        END-OF-TABLE
   527        READ ZIP-FILE-IN AT END
   528           SET END-OF-TABLE      TO TRUE
   529        END-READ
   530        IF NOT END-OF-TABLE
   531           MOVE ZIP-CODE         TO WS-ZIP-CODE  (Z1)
   532           MOVE ZIP-STATE        TO WS-ZIP-STATE (Z1)
   533           MOVE ZIP-CITY         TO WS-ZIP-CITY  (Z1)
   534        END-IF
   535     END-PERFORM
   536
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  11
* PEMBEF1.cbl
   537     SUBTRACT +2                 FROM Z1
   538
   539     DISPLAY ' NUMBER OF ZIP RECORDS ' Z1
   540
   541     .
   542 0300-EXIT.
   543     EXIT.
   544
   545 0500-PROCESS.
   546
   547     IF (BE-CITY-STATE NOT = SPACES)
   548        OR (BE-CITY-STATE2 NOT = SPACES)
   549        PERFORM 1000-PROCESS     THRU 1000-EXIT
   550     END-IF
   551
   552     PERFORM 1200-READ-ELBENE    THRU 1200-EXIT
   553
   554     .
   555 0500-EXIT.
   556     EXIT.
   557
   558 1000-PROCESS.
   559
   560     MOVE ' '                    TO WS-REWRITE-SW
   561     IF BE-CITY-STATE NOT = SPACES
   562        MOVE SPACES              TO WS-WORK-CITY-ST
   563        MOVE BE-CITY-STATE       TO WS-HOLD-CITY-STATE
   564
   565** CHECK FOR GUAM AND CHANGE TO GU **
   566        PERFORM VARYING S1 FROM +27 BY -1 UNTIL
   567           (S1 = +1)
   568           OR (BE-CITY-STATE (S1:4) = 'GUAM')
   569        END-PERFORM
   570        IF BE-CITY-STATE (S1:4) = 'GUAM'
   571           MOVE 'GU  '              TO BE-CITY-STATE (S1:4)
   572           DISPLAY ' FIXED GUAM ' WS-HOLD-CITY-STATE ' '
   573              BE-CITY-STATE
   574           MOVE BE-CITY-STATE       TO WS-HOLD-CITY-STATE
   575        END-IF
   576
   577        PERFORM VARYING S1 FROM +30 BY -1 UNTIL
   578           (BE-CITY-STATE (S1:1) NOT = SPACE AND '.')
   579           OR (S1 = +1)
   580        END-PERFORM
   581        IF S1 > 3
   582           SUBTRACT +1 FROM S1
   583           MOVE BE-CITY-STATE (S1:2)
   584                                    TO WS-WORK-STATE
   585           SUBTRACT +1 FROM S1
   586           PERFORM VARYING S1 FROM S1 BY -1 UNTIL
   587              BE-CITY-STATE (S1:1) NOT = SPACE
   588           END-PERFORM
   589           IF S1 > 2
   590              IF BE-CITY-STATE (S1:1) = ',' OR ';' OR '.'
   591                 MOVE BE-CITY-STATE (1:S1 - 1) TO WS-WORK-CITY
   592              ELSE
   593                 MOVE BE-CITY-STATE (1:S1) TO WS-WORK-CITY
   594              END-IF
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  12
* PEMBEF1.cbl
   595           END-IF
   596           MOVE SPACE            TO WS-STATE-SW
   597           MOVE '1'              TO WS-ADDR-SW
   598           PERFORM 1500-EDIT-STATE  THRU 1500-EXIT
   599           IF VALID-STATE
   600              MOVE WS-WORK-CITY  TO BE-CITY
   601              MOVE WS-WORK-STATE TO BE-STATE
   602              DISPLAY ' 1  OLD ' WS-HOLD-CITY-STATE
   603                 ' NEW ' BE-CITY-STATE
   604              SET REWRITE-BE TO TRUE
   605*          ELSE
   606*             PERFORM 1650-CONVERT-DATES
   607*                                THRU 1650-EXIT
   608*             DISPLAY ' 1 INVALID STATE CODE: ' WS-WORK-STATE
   609*                ' ' WS-HOLD-CITY-STATE ' '
   610*                   BE-CONTROL-PRIMARY (2:11)
   611           END-IF
   612        ELSE
   613           DISPLAY ' 1 WEIRD CITY STATE ' WS-HOLD-CITY-STATE ' '
   614                    BE-CONTROL-PRIMARY (2:11)
   615        END-IF
   616     END-IF
   617
   618     IF BE-CITY-STATE2 NOT = SPACES
   619        MOVE SPACES              TO WS-WORK-CITY-ST
   620        MOVE BE-CITY-STATE2      TO WS-HOLD-CITY-STATE
   621
   622** CHECK FOR GUAM AND CHANGE TO GU **
   623        PERFORM VARYING S1 FROM +27 BY -1 UNTIL
   624           (S1 = +1)
   625           OR (BE-CITY-STATE2 (S1:4) = 'GUAM')
   626        END-PERFORM
   627        IF BE-CITY-STATE2 (S1:4) = 'GUAM'
   628           MOVE 'GU  '              TO BE-CITY-STATE2 (S1:4)
   629           DISPLAY ' FIXED GUAM ' WS-HOLD-CITY-STATE ' '
   630              BE-CITY-STATE2
   631           MOVE BE-CITY-STATE2      TO WS-HOLD-CITY-STATE
   632        END-IF
   633
   634        PERFORM VARYING S1 FROM +30 BY -1 UNTIL
   635           (BE-CITY-STATE2 (S1:1) NOT = SPACE AND '.')
   636           OR (S1 = +1)
   637        END-PERFORM
   638        IF S1 > 3
   639           SUBTRACT +1 FROM S1
   640           MOVE BE-CITY-STATE2 (S1:2)
   641                                    TO WS-WORK-STATE
   642           SUBTRACT +1 FROM S1
   643           PERFORM VARYING S1 FROM S1 BY -1 UNTIL
   644              BE-CITY-STATE2 (S1:1) NOT = SPACE
   645           END-PERFORM
   646           IF S1 > 2
   647              IF BE-CITY-STATE2 (S1:1) = ',' OR ';' OR '.'
   648                 MOVE BE-CITY-STATE2 (1:S1 - 1) TO WS-WORK-CITY
   649              ELSE
   650                 MOVE BE-CITY-STATE2 (1:S1) TO WS-WORK-CITY
   651              END-IF
   652           END-IF
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  13
* PEMBEF1.cbl
   653           MOVE SPACE            TO WS-STATE-SW
   654           MOVE '2'              TO WS-ADDR-SW
   655           PERFORM 1500-EDIT-STATE  THRU 1500-EXIT
   656           IF VALID-STATE
   657              MOVE WS-WORK-CITY  TO BE-CITY2
   658              MOVE WS-WORK-STATE TO BE-STATE2
   659              DISPLAY ' 2  OLD ' WS-HOLD-CITY-STATE
   660                 ' NEW ' BE-CITY-STATE2
   661              SET REWRITE-BE TO TRUE
   662*          ELSE
   663*             PERFORM 1650-CONVERT-DATES
   664*                                THRU 1650-EXIT
   665*             DISPLAY ' 2 INVALID STATE CODE: ' WS-WORK-STATE
   666*                ' ' WS-HOLD-CITY-STATE ' '
   667*                   BE-CONTROL-PRIMARY (2:11)
   668           END-IF
   669        ELSE
   670           DISPLAY ' 2 WEIRD CITY STATE ' WS-HOLD-CITY-STATE ' '
   671                    BE-CONTROL-PRIMARY (2:11)
   672        END-IF
   673     END-IF
   674
   675     IF REWRITE-BE
   676        PERFORM 2100-REWRITE-ELBENE
   677                                    THRU 2100-EXIT
   678     END-IF
   679
   680     .
   681 1000-EXIT.
   682     EXIT.
   683
   684 1100-START-ELBENE.
   685
   686     MOVE LOW-VALUES             TO BE-CONTROL-PRIMARY
   687     MOVE X'04'                  TO BE-COMPANY-CD
   688
   689     START ELBENE KEY IS NOT <
   690                      BE-CONTROL-PRIMARY
   691     IF ELBENE-FILE-STATUS NOT = '00'
   692        DISPLAY ' ELBENE, BAD START '
   693              ELBENE-FILE-STATUS
   694        PERFORM 9999-ABEND-RTN
   695     END-IF
   696
   697     .
   698 1100-EXIT.
   699     EXIT.
   700
   701 1200-READ-ELBENE.
   702
   703     READ ELBENE NEXT RECORD
   704
   705     IF ELBENE-FILE-STATUS = '10' OR '23'
   706        SET END-OF-ELBENE TO TRUE
   707     ELSE
   708        IF ELBENE-FILE-STATUS NOT = '00'
   709           DISPLAY 'ELBENE, BAD READ NEXT '
   710                ELBENE-FILE-STATUS
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  14
* PEMBEF1.cbl
   711           PERFORM 9999-ABEND-RTN
   712        ELSE
   713           ADD 1              TO WS-ELBENE-RECS-IN
   714        END-IF
   715     END-IF
   716
   717     .
   718 1200-EXIT.
   719     EXIT.
   720
   721 1500-EDIT-STATE.
   722
   723     SEARCH ALL STATE-TABLE AT END
   724        ADD 1 TO WS-INVALID-ST-CNT
   725        WHEN ST-STATE (ST-INDEX) = WS-WORK-STATE
   726           SET VALID-STATE TO TRUE
   727     END-SEARCH
   728
   729     IF NOT VALID-STATE
   730        PERFORM 1700-TRY-TO-FIX  THRU 1700-EXIT
   731     END-IF
   732
   733     .
   734 1500-EXIT.
   735     EXIT.
   736
   737 1700-TRY-TO-FIX.
   738
   739     IF WS-ADDR-SW = '1'
   740        IF (BE-ZIP-PRIME NUMERIC)
   741           AND (BE-ZIP-PRIME NOT = ZEROS)
   742           PERFORM VARYING Z1 FROM +1 BY +1 UNTIL
   743              (Z1 > 42078)
   744              OR (BE-ZIP-PRIME = WS-ZIP-CODE (Z1))
   745           END-PERFORM
   746           IF BE-ZIP-PRIME = WS-ZIP-CODE (Z1)
   747              DISPLAY ' 1 - FIXING CITY ST FROM '
   748                 WS-HOLD-CITY-STATE
   749                 ' TO ' WS-ZIP-CITY (Z1) ' ' WS-ZIP-STATE (Z1) ' '
   750                 BE-CONTROL-PRIMARY (2:11)
   751              MOVE WS-ZIP-CITY (Z1) TO BE-CITY
   752              MOVE WS-ZIP-STATE (Z1) TO BE-STATE
   753              SET REWRITE-BE TO TRUE
   754           ELSE
   755              DISPLAY ' 1 - INVALID STATE CODE: ' WS-WORK-STATE
   756              ' ' WS-HOLD-CITY-STATE ' '
   757              BE-CONTROL-PRIMARY (2:11)
   758           END-IF
   759        ELSE
   760           MOVE ' ' TO WS-INS-FIX
   761
   762** CHECK FOR SACRAMENTO            **
   763           PERFORM VARYING S1 FROM +21 BY -1 UNTIL
   764              (S1 = +1)
   765              OR (BE-CITY-STATE (S1:10) = 'SACRAMENTO')
   766           END-PERFORM
   767           IF BE-CITY-STATE (S1:10) = 'SACRAMENTO'
   768              MOVE 'CA'                TO BE-STATE
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  15
* PEMBEF1.cbl
   769              DISPLAY ' INS FIXED SACRAMENTO ' WS-HOLD-CITY-STATE
   770                 ' ' BE-CITY-STATE
   771              MOVE BE-CITY-STATE       TO WS-HOLD-CITY-STATE
   772              SET REWRITE-BE TO TRUE
   773              SET INS-FIXED TO TRUE
   774           END-IF
   775
   776** CHECK FOR CHARLOTTE             **
   777           PERFORM VARYING S1 FROM +22 BY -1 UNTIL
   778              (S1 = +1)
   779              OR (BE-CITY-STATE (S1:9) = 'CHARLOTTE')
   780           END-PERFORM
   781           IF BE-CITY-STATE (S1:9) = 'CHARLOTTE'
   782              MOVE 'NC'                TO BE-STATE
   783              DISPLAY ' 1 FIXED CHARLOTTE  ' WS-HOLD-CITY-STATE
   784                ' ' BE-CITY-STATE
   785              MOVE BE-CITY-STATE       TO WS-HOLD-CITY-STATE
   786              SET REWRITE-BE TO TRUE
   787              SET INS-FIXED TO TRUE
   788           END-IF
   789           IF NOT INS-FIXED
   790              DISPLAY '1 - INVALID ZIP CANT FIX ' WS-WORK-STATE
   791                 ' ' WS-HOLD-CITY-STATE ' '
   792                 BE-CONTROL-PRIMARY (2:11) ' ' BE-ZIP-PRIME
   793           END-IF
   794        END-IF
   795     END-IF
   796
   797
   798     IF WS-ADDR-SW = '2'
   799        IF (BE-ZIP-PRIME2 NUMERIC)
   800           AND (BE-ZIP-PRIME2 NOT = ZEROS)
   801           PERFORM VARYING Z1 FROM +1 BY +1 UNTIL
   802              (Z1 > 42078)
   803              OR (BE-ZIP-PRIME2 = WS-ZIP-CODE (Z1))
   804           END-PERFORM
   805           IF BE-ZIP-PRIME2 = WS-ZIP-CODE (Z1)
   806              DISPLAY ' BEN - FIXING CITY ST FROM '
   807                 WS-HOLD-CITY-STATE
   808                 ' TO ' WS-ZIP-CITY (Z1) ' ' WS-ZIP-STATE (Z1) ' '
   809                 BE-CONTROL-PRIMARY (2:11)
   810              MOVE WS-ZIP-CITY (Z1) TO BE-CITY2
   811              MOVE WS-ZIP-STATE (Z1) TO BE-STATE2
   812              SET REWRITE-BE TO TRUE
   813           ELSE
   814              DISPLAY ' 2 - INVALID STATE CODE: ' WS-WORK-STATE
   815              ' ' WS-HOLD-CITY-STATE ' '
   816              BE-CONTROL-PRIMARY (2:11)
   817           END-IF
   818        ELSE
   819           MOVE ' ' TO WS-BEN-FIX
   820
   821** CHECK FOR SACRAMENTO            **
   822           PERFORM VARYING S1 FROM +21 BY -1 UNTIL
   823              (S1 = +1)
   824              OR (BE-CITY-STATE2 (S1:10) = 'SACRAMENTO')
   825           END-PERFORM
   826           IF BE-CITY-STATE2 (S1:10) = 'SACRAMENTO'
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  16
* PEMBEF1.cbl
   827              MOVE 'CA'                TO BE-STATE2
   828              DISPLAY ' 2 FIXED SACRAMENTO ' WS-HOLD-CITY-STATE
   829                ' ' BE-CITY-STATE2
   830              MOVE BE-CITY-STATE2  TO WS-HOLD-CITY-STATE
   831              SET REWRITE-BE TO TRUE
   832              SET BEN-FIXED TO TRUE
   833           END-IF
   834
   835** CHECK FOR CHARLOTTE             **
   836           PERFORM VARYING S1 FROM +22 BY -1 UNTIL
   837              (S1 = +1)
   838              OR (BE-CITY-STATE2 (S1:9) = 'CHARLOTTE')
   839           END-PERFORM
   840           IF BE-CITY-STATE2 (S1:9) = 'CHARLOTTE'
   841              MOVE 'NC'                TO BE-STATE2
   842              DISPLAY ' 2 FIXED CHARLOTTE  ' WS-HOLD-CITY-STATE
   843              ' ' BE-CITY-STATE2
   844              MOVE BE-CITY-STATE2 TO WS-HOLD-CITY-STATE
   845              SET REWRITE-BE TO TRUE
   846              SET BEN-FIXED TO TRUE
   847           END-IF
   848           IF NOT BEN-FIXED
   849              DISPLAY ' 2 - INVALID ZIP CANT FIX ' WS-WORK-STATE
   850                 ' ' WS-HOLD-CITY-STATE ' '
   851                 BE-CONTROL-PRIMARY (2:11) ' ' BE-ZIP-PRIME2
   852           END-IF
   853        END-IF
   854     END-IF
   855
   856     .
   857 1700-EXIT.
   858     EXIT.
   859
   860 2100-REWRITE-ELBENE.
   861
   862     REWRITE BENEFICIARY-MASTER
   863*    MOVE '00' TO ELBENE-FILE-STATUS
   864
   865     IF ELBENE-FILE-STATUS = '00'
   866         ADD 1                   TO WS-ELBENE-RECS-FIX
   867     ELSE
   868         DISPLAY 'ELBENE, BAD REWRITE '
   869         DISPLAY '*** STATUS CODE IS ' ELBENE-FILE-STATUS
   870         PERFORM 9999-ABEND-RTN
   871     END-IF
   872     .
   873 2100-EXIT.
   874     EXIT.
   875
   876 2200-DELETE-ELBENE.
   877
   878     DELETE  ELBENE
   879
   880     IF ELBENE-FILE-STATUS = '00'
   881         ADD 1                   TO WS-ELBENE-RECS-DEL
   882     ELSE
   883         DISPLAY 'ELBENE, BAD DELETE  '
   884         DISPLAY '*** STATUS CODE IS ' ELBENE-FILE-STATUS
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  17
* PEMBEF1.cbl
   885         PERFORM 9999-ABEND-RTN
   886     END-IF
   887     .
   888 2200-EXIT.
   889     EXIT.
   890
   891
   892 3000-CLOSE-FILES.
   893
   894     CLOSE ELBENE ZIP-FILE-IN
   895
   896     .
   897 3000-EXIT.
   898     EXIT.
   899
   900 4000-FINAL-TOTALS.
   901
   902     DISPLAY '**************************************************'
   903     DISPLAY '***                                            ***'
   904
   905     MOVE WS-ELBENE-RECS-IN      TO WS-DISPLAY-CNT
   906     DISPLAY '***  ELBENE RECORDS   IN         = ' WS-DISPLAY-CNT
   907
   908     MOVE WS-ELBENE-RECS-FIX     TO WS-DISPLAY-CNT
   909     DISPLAY '***  ELBENE RECORDS   FIXED      = ' WS-DISPLAY-CNT
   910
   911     MOVE WS-INVALID-ST-CNT      TO WS-DISPLAY-CNT
   912     DISPLAY '***  INVALID STATES              = ' WS-DISPLAY-CNT
   913
   914     MOVE WS-ELBENE-RECS-DEL     TO WS-DISPLAY-CNT
   915     DISPLAY '***  ELBENE RECORDS   DELETED    = ' WS-DISPLAY-CNT
   916
   917     DISPLAY '***                                            ***'
   918     DISPLAY '**************************************************'
   919
   920     .
   921 4000-EXIT.
   922     EXIT.
   923
   924 8510-DATE-CONVERSION.
   925
   926     CALL 'ELDATCX' USING DATE-CONVERSION-DATA
   927
   928     .
   929 8590-EXIT.
   930     EXIT.
   931
   932 9999-ABEND-RTN.
   933
   934     DISPLAY '*** ELBENE  FILE CONVERSION PROGRAM ABENDING ***'
   935     DISPLAY '************************************************'
   936
   937     MOVE 1                      TO WS-ABEND-FLD
   938     MOVE 0                      TO WS-ZERO-FLD
   939
   940     COMPUTE WS-ABEND-FLD = WS-ABEND-FLD / WS-ZERO-FLD
   941     .
   942 9999-EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  18
* PEMBEF1.cbl
   943     EXIT.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:     1477028     Code:        4104
