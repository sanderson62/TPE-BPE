* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   1
* ELUPRMXA.cbl
* Options: int("ELUPRMXA.int") anim csi verbose NOBOUND PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("ELUPRMXA.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"ebmlsfile" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" NOCHECKDIV NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"32" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"ELUPRMXA.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST
*          "ELUPRMXA.lst" LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0"
*          NOMAPNAME NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT
*          NOMOVELENCHECK NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT
*          NONCHAR NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR NOSTICKY-LINKAGE
*          NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"2" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                 ELUPRMX.
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 10/17/94 15:27:20.
     7*                            VMOD=2.004
     8*
     9*AUTHOR.       LOGIC, INC.
    10*              DALLAS, TEXAS.
    11
    12*DATE-COMPILED.
    13
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   2
* ELUPRMXA.cbl
    14*SECURITY.   *****************************************************
    15*            *                                                   *
    16*            *   THIS PROGRAM IS THE PROPERTY OF LOGIC, INC.     *
    17*            *                                                   *
    18*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
    19*                                                                *
    20*            *   OF LOGIC, INC. IS EXPRESSLY PROHIBITED WITHOUT  *
    21*            *   THE PRIOR WRITTEN PERMISSION OF LOGIC INC.      *
    22*            *                                                   *
    23*            *****************************************************
    24
    25*REMARKS.    *****************************************************
    26*            *                                                   *
    27*            *    THIS 'SUBROUTINE' WILL, DEPENDING UPON THE     *
    28*            *    OPTION SPECIFIED, COMPUTE UNEARNED PREMIUM     *
    29*            *****************************************************
    30
    31
    32******************************************************************
    33*                                                                *
    34*              INPUT FIELDS USED                                 *
    35*                                                                *
    36******************************************************************
    37*  CERT ISSUE DATE  - CP-CERT-EFF-DT                             *
    38*  REFUND DATE      - CP-VALUATION-DT                            *
    39*  ORIGINAL TERM    - CP-ORIGINAL-TERM                           *
    40*  CAPPED TERM      - CP-LOAN-TERM                               *
    41*  REMAINING TERM   - CP-REMAINING-TERM                          *
    42*  STATE CODE       - CP-STATE                                   *
    43*  STATE CODE       - CP-STATE-STD-ABBV                          *
    44*  CLASS CODE       - CP-CLASS-CODE                              *
    45*  DEVIATION CODE   - CP-DEVIATION-CODE                          *
    46*  ORIGINAL BENEFIT - CP-ORIGINAL-BENEFIT                        *
    47*  PROCESS TYPE     - CP-PROCESS-TYPE                            *
    48*  BENEFIT KIND     - CP-BENEFIT-TYPE                            *
    49*  A.P.R.           - CP-LOAN-APR                                *
    50*  METHOD           - CP-EARNING-METHOD                          *
    51*  SPECIAL METHOD   - CP-SPECIAL-CALC-CODE                       *
    52*  PAYMENT FREQUENCY- CP-PAY-FREQUENCY                           *
    53*  COMPANY I.D.     - CP-COMPANY-ID                              *
    54*  BENEFIT CODE     - CP-BENEFIT-CD                              *
    55*  INSURED AGE      - CP-ISSUE-AGE                               *
    56******************************************************************
    57 ENVIRONMENT DIVISION.
    58
    59 DATA DIVISION.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   3
* ELUPRMXA.cbl
    61 WORKING-STORAGE SECTION.
    62 77  FILLER   PIC X(32) VALUE '********************************'.
    63 77  FILLER   PIC X(32) VALUE '**  ELUPRMX WORKING STORAGE   **'.
    64 77  FILLER   PIC X(32) VALUE '*** VMOD=2.004 *****************'.
    65
    66 01  WS-WORK-MISC.
    67     12  WS-CP-METHOD        PIC X.
    68     12  WS-AH-METHOD        PIC X.
    69     12  WS-REMAINING-TERM   PIC S9(4)V9      COMP-3.
    70     12  WS-TEMP-RESULT      PIC S9(7)V9(6)   COMP-3.
    71     12  WS-REMAINING-AMT    PIC S9(7)V9(6)   COMP-3.
    72     12  WS-ORIG-PREM        PIC S9(7)V9(6)   COMP-3.
    73     12  WS-REMAIN-PREM      PIC S9(7)V9(6)   COMP-3.
    74     12  WS-NP-REF-FACTOR    PIC S9(4)V9(11)  COMP-3.
    75     12  WS-SAVE-TERM        PIC S9(3)        COMP-3.
    76     12  UNEARN-PRM          PIC S9(5)V99     COMP-3.
    77     12  FACTOR-1            PIC S9(4)V9(11)  COMP-3.
    78     12  FACTOR-2            PIC S9(4)V9(11)  COMP-3.
    79     12  FACTOR-3            PIC S9(4)V9(11)  COMP-3.
    80     12  FACTOR-4            PIC S9(4)V9(11)  COMP-3.
    81     12  FACTOR-5            PIC S9(7)        COMP-3.
    82     12  FACTOR-6            PIC S9(7)        COMP-3.
    83     12  RATE-FACTOR-1       PIC S9V99        COMP-3.
    84     12  RATE-FACTOR-2       PIC S999         COMP-3.
    85     12  R78-TEMP-1          PIC S9(5)V99     COMP-3.
    86     12  R78-TEMP-2          PIC S9(5)V99     COMP-3.
    87     12  R78-FACTOR          PIC S9(4)V9(11)  COMP-3.
    88     12  R78-UN-PREMIUM      PIC S9(7)V99     COMP-3.
    89     12  R78-UN-PREM-ALT     PIC S9(7)V99     COMP-3.
    90     12  PR-FACTOR           PIC S9(4)V9(11)  COMP-3.
    91     12  PR-UN-PREMIUM       PIC S9(7)V99     COMP-3.
    92     12  PR-UN-PREM-ALT      PIC S9(7)V99     COMP-3.
    93     12  STATE-UN-PREMIUM    PIC S9(7)V99     COMP-3.
    94     12  DOMI-UN-PREMIUM     PIC S9(7)V99     COMP-3.
    95     12  SRL                 PIC S9(4)        COMP  VALUE +00.
    96
    97
    98
    99 01  METHOD-TABLE.
   100     05  M-TABLE.
   101         10  FILLER              PIC XXXX VALUE 'AKPP'.
   102         10  FILLER              PIC XXXX VALUE 'ALRR'.
   103         10  FILLER              PIC XXXX VALUE 'ARRR'.
   104         10  FILLER              PIC XXXX VALUE 'AZPR'.
   105         10  FILLER              PIC XXXX VALUE 'CAPP'.
   106*        10  FILLER              PIC XXXX VALUE 'COPM'.
   107         10  FILLER              PIC XXXX VALUE 'COPR'.
   108         10  FILLER              PIC XXXX VALUE 'CTPP'.
   109         10  FILLER              PIC XXXX VALUE 'DCPP'.
   110         10  FILLER              PIC XXXX VALUE 'DERR'.
   111         10  FILLER              PIC XXXX VALUE 'FLRR'.
   112         10  FILLER              PIC XXXX VALUE 'GAMM'.
   113         10  FILLER              PIC XXXX VALUE 'GURR'.
   114         10  FILLER              PIC XXXX VALUE 'HIRR'.
   115         10  FILLER              PIC XXXX VALUE 'IARR'.
   116         10  FILLER              PIC XXXX VALUE 'IDRR'.
   117         10  FILLER              PIC XXXX VALUE 'ILRR'.
   118         10  FILLER              PIC XXXX VALUE 'INPR'.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   4
* ELUPRMXA.cbl
   119         10  FILLER              PIC XXXX VALUE 'KSPR'.
   120         10  FILLER              PIC XXXX VALUE 'KYPR'.
   121         10  FILLER              PIC XXXX VALUE 'LARR'.
   122         10  FILLER              PIC XXXX VALUE 'MAPP'.
   123         10  FILLER              PIC XXXX VALUE 'MDRR'.
   124         10  FILLER              PIC XXXX VALUE 'MEPP'.
   125         10  FILLER              PIC XXXX VALUE 'MIRR'.
   126         10  FILLER              PIC XXXX VALUE 'MNRR'.
   127         10  FILLER              PIC XXXX VALUE 'MORR'.
   128         10  FILLER              PIC XXXX VALUE 'MSRR'.
   129         10  FILLER              PIC XXXX VALUE 'MTRR'.
   130         10  FILLER              PIC XXXX VALUE 'NCPR'.
   131         10  FILLER              PIC XXXX VALUE 'NDPR'.
   132         10  FILLER              PIC XXXX VALUE 'NERR'.
   133         10  FILLER              PIC XXXX VALUE 'NHPR'.
   134         10  FILLER              PIC XXXX VALUE 'NJRR'.
   135         10  FILLER              PIC XXXX VALUE 'NMMM'.
   136         10  FILLER              PIC XXXX VALUE 'NVRR'.
   137         10  FILLER              PIC XXXX VALUE 'NYPP'.
   138*        10  FILLER              PIC XXXX VALUE 'OHPR'.
   139         10  FILLER              PIC XXXX VALUE 'OHPM'.
   140         10  FILLER              PIC XXXX VALUE 'OKRR'.
   141         10  FILLER              PIC XXXX VALUE 'ORPP'.
   142         10  FILLER              PIC XXXX VALUE 'PAPR'.
   143         10  FILLER              PIC XXXX VALUE 'PR  '.
   144         10  FILLER              PIC XXXX VALUE 'RIPP'.
   145         10  FILLER              PIC XXXX VALUE 'SCRR'.
   146         10  FILLER              PIC XXXX VALUE 'SDRR'.
   147         10  FILLER              PIC XXXX VALUE 'TNRR'.
   148         10  FILLER              PIC XXXX VALUE 'TXPM'.
   149         10  FILLER              PIC XXXX VALUE 'UTPR'.
   150         10  FILLER              PIC XXXX VALUE 'VAPR'.
   151         10  FILLER              PIC XXXX VALUE 'VTPP'.
   152         10  FILLER              PIC XXXX VALUE 'WAPP'.
   153         10  FILLER              PIC XXXX VALUE 'WIPR'.
   154         10  FILLER              PIC XXXX VALUE 'WVRR'.
   155         10  FILLER              PIC XXXX VALUE 'WYPP'.
   156     05  MR-TABLE REDEFINES M-TABLE  OCCURS 53 TIMES
   157                            INDEXED BY TABLE-INDEX.
   158         10  T-STATE             PIC XX.
   159         10  CP-METHOD-CODE      PIC X.
   160         10  AH-METHOD-CODE      PIC X.
   161
   162
   163
   164
   165 01  AH-RES-STATE-TABLE.
   166     12  FILLER              PIC X(16)  VALUE
   167            'AKALAZCANCNDORWY'.
   168     12  FILLER              PIC XX     VALUE HIGH-VALUES.
   169
   170 01  AH-RES-STAT-TAB  REDEFINES AH-RES-STATE-TABLE.
   171     12  AH-RES-STATE-ENT    PIC XX     OCCURS 9 TIMES.
   172
   173 01  TEXAS-REG-WORK-AREAS.
   174     12  TEX-FACT-1          PIC S9(7)V9(2)  COMP-3.
   175     12  TEX-FACT-2          PIC S9(3)       COMP-3.
   176     12  TEX-FACT-3          PIC S9(3)       COMP-3.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   5
* ELUPRMXA.cbl
   177     12  TEX-FACT-4          PIC S9(7)       COMP-3.
   178     12  TEX-FACT-5          PIC S9(3)       COMP-3.
   179     12  TEX-FACT-6          PIC S9(3)       COMP-3.
   180     12  TEX-FACT-7          PIC S9(7)       COMP-3.
   181     12  TEX-FACT-8          PIC S9V9(6)     COMP-3.
   182     12  TEX-FACT-9          PIC S9(4)V9(11) COMP-3.
   183
   184 01  NET-PAY-INTERFACE.
   185     12  N-P-APR             PIC S9(3)V9(4)  COMP-3.
   186     12  N-P-ORIG            PIC S9(3)       COMP-3.
   187     12  N-P-REM             PIC S9(3)       COMP-3.
   188     12  N-P-OPT             PIC X.
   189     12  N-P-CAP             PIC S9(3)       COMP-3.
   190     12  N-P-LOAN            PIC S9(3)       COMP-3.
   191     12  N-P-FACTOR          PIC S9(4)V9(9)  COMP-3.
   192
   193*************************COPY ERCNETWS.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   6
* ELUPRMXA.cbl
*  195                         COPY ELCDATE.
   196******************************************************************06/11/98
   197*                                                                *ELCDATE
   198*                                                                *ELCDATE
   199*                            ELCDATE.                            *   LV023
   200*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL*16
   201*                            VMOD=2.003                           ELCDATE
   202*                                                                *ELCDATE
   203*                                                                *ELCDATE
   204*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *ELCDATE
   205*                 LENGTH = 200                                   *   CL*19
   206******************************************************************ELCDATE
   207                                                                  ELCDATE
   208 01  DATE-CONVERSION-DATA.                                        ELCDATE
   209     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.    CL*19
   210     12  DC-OPTION-CODE                PIC X.                        CL*15
   211         88  BIN-TO-GREG                VALUE ' '.                ELCDATE
   212         88  ELAPSED-BETWEEN-BIN        VALUE '1'.                ELCDATE
   213         88  EDIT-GREG-TO-BIN           VALUE '2'.                ELCDATE
   214         88  YMD-GREG-TO-BIN            VALUE '3'.                ELCDATE
   215         88  MDY-GREG-TO-BIN            VALUE '4'.                ELCDATE
   216         88  JULIAN-TO-BIN              VALUE '5'.                ELCDATE
   217         88  BIN-PLUS-ELAPSED           VALUE '6'.                ELCDATE
   218         88  FIND-CENTURY               VALUE '7'.                   CL*22
   219         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.                ELCDATE
   220         88  EDIT-GREG-TO-BIN-3         VALUE '9'.                ELCDATE
   221         88  YMD-GREG-TO-BIN-3          VALUE 'A'.                ELCDATE
   222         88  MDY-GREG-TO-BIN-3          VALUE 'B'.                ELCDATE
   223         88  JULIAN-TO-BIN-3            VALUE 'C'.                ELCDATE
   224         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.                ELCDATE
   225         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.                   CL*14
   226         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.                   CL*14
   227         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.                   CL*14
   228         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.         CL*14
   229         88  CHECK-LEAP-YEAR            VALUE 'H'.                   CL*14
   230         88  BIN-3-TO-GREG              VALUE 'I'.                   CL*14
   231         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.                   CL*14
   232         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.                   CL*14
   233         88  CYMD-GREG-TO-BIN           VALUE 'L'.                   CL*14
   234         88  MDCY-GREG-TO-BIN           VALUE 'M'.                   CL*14
   235         88  MDY-GREG-TO-JULIAN         VALUE 'N'.                   CL*14
   236         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.                   CL*14
   237         88  YMD-GREG-TO-JULIAN         VALUE 'P'.                   CL*14
   238         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.                   CL*14
   239         88  THREE-CHARACTER-BIN                                  ELCDATE
   240                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.       CL*14
   241         88  GREGORIAN-TO-BIN                                        CL**2
   242                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.    CL*14
   243         88  BIN-TO-GREGORIAN                                        CL**2
   244                  VALUES ' ' '1' 'I' '8' 'G'.                        CL*14
   245         88  JULIAN-TO-BINARY                                        CL**2
   246                  VALUES '5' 'C' 'E' 'F'.                            CL*14
   247     12  DC-ERROR-CODE                 PIC X.                        CL*15
   248         88  NO-CONVERSION-ERROR        VALUE ' '.                   CL**3
   249         88  DATE-CONVERSION-ERROR                                ELCDATE
   250                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.        CL*14
   251         88  DATE-IS-ZERO               VALUE '1'.                ELCDATE
   252         88  DATE-IS-NON-NUMERIC        VALUE '2'.                ELCDATE
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   7
* ELUPRMXA.cbl (/apps/prod/cid1p/copy/ELCDATE)
   253         88  DATE-IS-INVALID            VALUE '3'.                ELCDATE
   254         88  DATE1-GREATER-DATE2        VALUE '4'.                ELCDATE
   255         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.                ELCDATE
   256         88  DATE-INVALID-OPTION        VALUE '9'.                ELCDATE
   257         88  INVALID-CENTURY            VALUE 'A'.                ELCDATE
   258         88  ONLY-CENTURY               VALUE 'B'.                ELCDATE
   259         88  ONLY-LEAP-YEAR             VALUE 'C'.                ELCDATE
   260         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.              CL**3
   261     12  DC-END-OF-MONTH               PIC X.                        CL*15
   262         88  CALCULATE-END-OF-MONTH     VALUE '1'.                ELCDATE
   263     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.         CL*15
   264         88  USE-NORMAL-PROCESS         VALUE ' '.                ELCDATE
   265         88  ADJUST-DOWN-100-YRS        VALUE '1'.                ELCDATE
   266         88  ADJUST-UP-100-YRS          VALUE '2'.                ELCDATE
   267     12  FILLER                        PIC X.                        CL*15
   268     12  DC-CONVERSION-DATES.                                        CL*15
   269         16  DC-BIN-DATE-1             PIC XX.                       CL*15
   270         16  DC-BIN-DATE-2             PIC XX.                       CL*15
   271         16  DC-GREG-DATE-1-EDIT       PIC X(08).                    CL*15
   272         16  DC-GREG-DATE-1-EDIT-R REDEFINES                         CL*15
   273                       DC-GREG-DATE-1-EDIT.                       ELCDATE
   274             20  DC-EDIT1-MONTH        PIC 99.                       CL*15
   275             20  SLASH1-1              PIC X.                        CL*15
   276             20  DC-EDIT1-DAY          PIC 99.                       CL*15
   277             20  SLASH1-2              PIC X.                        CL*15
   278             20  DC-EDIT1-YEAR         PIC 99.                       CL*15
   279         16  DC-GREG-DATE-2-EDIT       PIC X(08).                    CL*15
   280         16  DC-GREG-DATE-2-EDIT-R REDEFINES                         CL*15
   281                     DC-GREG-DATE-2-EDIT.                         ELCDATE
   282             20  DC-EDIT2-MONTH        PIC 99.                       CL*15
   283             20  SLASH2-1              PIC X.                        CL*15
   284             20  DC-EDIT2-DAY          PIC 99.                       CL*15
   285             20  SLASH2-2              PIC X.                        CL*15
   286             20  DC-EDIT2-YEAR         PIC 99.                       CL*15
   287         16  DC-GREG-DATE-1-YMD        PIC 9(06).                    CL*15
   288         16  DC-GREG-DATE-1-YMD-R  REDEFINES                         CL*15
   289                     DC-GREG-DATE-1-YMD.                          ELCDATE
   290             20  DC-YMD-YEAR           PIC 99.                       CL*15
   291             20  DC-YMD-MONTH          PIC 99.                       CL*15
   292             20  DC-YMD-DAY            PIC 99.                       CL*15
   293         16  DC-GREG-DATE-1-MDY        PIC 9(06).                    CL*15
   294         16  DC-GREG-DATE-1-MDY-R REDEFINES                          CL*15
   295                      DC-GREG-DATE-1-MDY.                         ELCDATE
   296             20  DC-MDY-MONTH          PIC 99.                       CL*15
   297             20  DC-MDY-DAY            PIC 99.                       CL*15
   298             20  DC-MDY-YEAR           PIC 99.                       CL*15
   299         16  DC-GREG-DATE-1-ALPHA.                                   CL*15
   300             20  DC-ALPHA-MONTH        PIC X(10).                    CL*15
   301             20  DC-ALPHA-DAY          PIC 99.                       CL*15
   302             20  FILLER                PIC XX.                       CL*15
   303             20  DC-ALPHA-CENTURY.                                   CL*15
   304                 24 DC-ALPHA-CEN-N     PIC 99.                       CL*15
   305             20  DC-ALPHA-YEAR         PIC 99.                       CL*15
   306         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.           CL*15
   307         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.           CL*15
   308         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.           CL*15
   309         16  DC-JULIAN-DATE            PIC 9(05).                    CL*15
   310         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE                CL*20
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   8
* ELUPRMXA.cbl (/apps/prod/cid1p/copy/ELCDATE)
   311                                       PIC 9(05).                    CL*20
   312         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.                  CL*15
   313             20  DC-JULIAN-YEAR        PIC 99.                       CL*15
   314             20  DC-JULIAN-DAYS        PIC 999.                      CL*15
   315         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.       CL*15
   316         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.    CL*15
   317         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.    CL*15
   318     12  DATE-CONVERSION-VARIBLES.                                   CL*15
   319         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.            CL*15
   320         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.          CL*15
   321             20  FILLER                PIC 9(3).                     CL*15
   322             20  HOLD-CEN-1-CCYY.                                    CL*15
   323                 24  HOLD-CEN-1-CC     PIC 99.                       CL*17
   324                 24  HOLD-CEN-1-YY     PIC 99.                       CL*17
   325             20  HOLD-CEN-1-MO         PIC 99.                       CL*17
   326             20  HOLD-CEN-1-DA         PIC 99.                       CL*17
   327         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.            CL*15
   328             20  HOLD-CEN-1-R-MO       PIC 99.                       CL*17
   329             20  HOLD-CEN-1-R-DA       PIC 99.                       CL*17
   330             20  HOLD-CEN-1-R-CCYY.                                  CL*15
   331                 24  HOLD-CEN-1-R-CC   PIC 99.                       CL*17
   332                 24  HOLD-CEN-1-R-YY   PIC 99.                       CL*17
   333             20  FILLER                PIC 9(3).                     CL*15
   334         16  HOLD-CENTURY-1-X.                                       CL*15
   335             20  FILLER                PIC X(3)  VALUE SPACES.       CL*15
   336             20  HOLD-CEN-1-X-CCYY.                                  CL*15
   337                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.          CL*17
   338                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.          CL*17
   339             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.          CL*17
   340             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.          CL*17
   341         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.          CL*15
   342             20  HOLD-CEN-1-R-X-MO     PIC XX.                       CL*17
   343             20  HOLD-CEN-1-R-X-DA     PIC XX.                       CL*17
   344             20  HOLD-CEN-1-R-X-CCYY.                                CL*15
   345                 24  HOLD-CEN-1-R-X-CC PIC XX.                       CL*17
   346                 24  HOLD-CEN-1-R-X-YY PIC XX.                       CL*17
   347             20  FILLER                PIC XXX.                      CL*23
   348         16  DC-BIN-DATE-EXPAND-1      PIC XXX.                      CL*15
   349         16  DC-BIN-DATE-EXPAND-2      PIC XXX.                      CL*15
   350         16  DC-JULIAN-DATE-1          PIC 9(07).                    CL*15
   351         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.          CL*15
   352             20  DC-JULIAN-1-CCYY.                                   CL*15
   353                 24  DC-JULIAN-1-CC    PIC 99.                       CL*15
   354                 24  DC-JULIAN-1-YR    PIC 99.                       CL*15
   355             20  DC-JULIAN-DA-1        PIC 999.                      CL*15
   356         16  DC-JULIAN-DATE-2          PIC 9(07).                    CL*15
   357         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.          CL*15
   358             20  DC-JULIAN-2-CCYY.                                   CL*15
   359                 24  DC-JULIAN-2-CC    PIC 99.                       CL*15
   360                 24  DC-JULIAN-2-YR    PIC 99.                       CL*15
   361             20  DC-JULIAN-DA-2        PIC 999.                      CL*15
   362         16  DC-GREG-DATE-A-EDIT.                                    CL*15
   363             20  DC-EDITA-MONTH        PIC 99.                       CL*15
   364             20  SLASHA-1              PIC X VALUE '/'.              CL*15
   365             20  DC-EDITA-DAY          PIC 99.                       CL*15
   366             20  SLASHA-2              PIC X VALUE '/'.              CL*15
   367             20  DC-EDITA-CCYY.                                      CL*15
   368                 24  DC-EDITA-CENT     PIC 99.                       CL*15
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   9
* ELUPRMXA.cbl (/apps/prod/cid1p/copy/ELCDATE)
   369                 24  DC-EDITA-YEAR     PIC 99.                       CL*15
   370         16  DC-GREG-DATE-B-EDIT.                                    CL*15
   371             20  DC-EDITB-MONTH        PIC 99.                       CL*15
   372             20  SLASHB-1              PIC X VALUE '/'.              CL*15
   373             20  DC-EDITB-DAY          PIC 99.                       CL*15
   374             20  SLASHB-2              PIC X VALUE '/'.              CL*15
   375             20  DC-EDITB-CCYY.                                      CL*15
   376                 24  DC-EDITB-CENT     PIC 99.                       CL*15
   377                 24  DC-EDITB-YEAR     PIC 99.                       CL*15
   378         16  DC-GREG-DATE-CYMD         PIC 9(08).                    CL*15
   379         16  DC-GREG-DATE-CYMD-R REDEFINES                           CL*15
   380                              DC-GREG-DATE-CYMD.                  ELCDATE
   381             20  DC-CYMD-CEN           PIC 99.                       CL*15
   382             20  DC-CYMD-YEAR          PIC 99.                       CL*15
   383             20  DC-CYMD-MONTH         PIC 99.                       CL*15
   384             20  DC-CYMD-DAY           PIC 99.                       CL*15
   385         16  DC-GREG-DATE-MDCY         PIC 9(08).                    CL*15
   386         16  DC-GREG-DATE-MDCY-R REDEFINES                           CL*15
   387                              DC-GREG-DATE-MDCY.                  ELCDATE
   388             20  DC-MDCY-MONTH         PIC 99.                       CL*15
   389             20  DC-MDCY-DAY           PIC 99.                       CL*15
   390             20  DC-MDCY-CEN           PIC 99.                       CL*15
   391             20  DC-MDCY-YEAR          PIC 99.                       CL*15
   392    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.      ELCDATE
   393        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.        ELCDATE
   394    12  DC-EL310-DATE                  PIC X(21).                    CL*26
   395    12  FILLER                         PIC X(28).                    CL*26
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  10
* ELUPRMXA.cbl
   397
   398
   399 LINKAGE SECTION.
*  400                          COPY ELCCALC.
   401******************************************************************04/15/98
   402*                                                                *ELCCALC
   403*                           ELCCALC.                            *    LV003
   404*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
   405*                            VMOD=2.025                          *   CL**3
   406*                                                                *   CL**2
   407*   DESCRIPTION:  DATA TO BE PASSED TO REMAINING TERM ROUTINE    *   CL**2
   408*                 REMAINING AMOUNT ROUTINE, LOSS RESERVE ROUTINE *   CL**2
   409*                 REFUND CALCULATIONS ROUTINE, EARNINGS CALCU -  *   CL**2
   410*                 LATIONS ROUTINE, AND THE RATING ROUTINE.       *   CL**2
   411*                                                                *   CL**2
   412*  PASSED TO ELRTRM                                              *   CL**2
   413*  -----------------                                             *   CL**2
   414*  METHOD CODE (I.E. FULL MONTH, HALF ADJ, ETC)                  *   CL**2
   415*  ORIGINAL TERM                                                 *   CL**2
   416*  BEGINNING DATE                                                *   CL**2
   417*  ENDING DATE                                                   *   CL**2
   418*  COMPANY I.D.                                                  *   CL**2
   419*  ACCOUNT MASTER USER FIELD                                     *   CL**2
   420*  PROCESS SWITCH (CANCEL, CLAIM)                                *   CL**2
   421*  FREE LOOK DAYS                                                *   CL**2
   422*                                                                *   CL**2
   423*  RETURNED FROM ELRTRM                                          *   CL**2
   424*  ---------------------                                         *   CL**2
   425*  REMAINING TERM 1 - USED FOR EARNINGS                          *   CL**2
   426*  REMAINING TERM 2 - USED FOR BENEFIT CALCULATIONS              *   CL**2
   427*  REMAINING TERM 3 - USED FOR CLAIM BENEFITS                    *   CL**2
   428*  ODD DAYS - REMAINING DAYS PAST FULL MONTHS                    *   CL**2
   429*----------------------------------------------------------------*   CL**2
   430*  PASSED TO ELRAMT                                              *   CL**2
   431*  ----------------                                              *   CL**2
   432*  REMAINING TERM 1 OR 2 OR 3 (FROM ELRTRM)                      *   CL**2
   433*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *   CL**2
   434*  ORIGINAL AMOUNT                                               *   CL**2
   435*  ALTERNATE BENEFIT (BALLON)                                    *   CL**2
   436*  A.P.R. - NET PAY ONLY                                         *   CL**2
   437*  METHOD                                                            CL**2
   438*  PAYMENT FREQUENCY - FOR FARM PLAN                             *   CL**2
   439*  COMPANY I.D.                                                  *   CL**2
   440*  BENEFIT TYPE                                                  *   CL**2
   441*                                                                *   CL**2
   442*  RETURNED FROM ELRAMT                                          *   CL**2
   443*  --------------------                                          *   CL**2
   444*  REMAINING AMOUNT 1 - CURRENT                                  *   CL**2
   445*  REMAINING AMOUNT 2 - PREVIOUS MONTH                           *   CL**2
   446*  REMAINING AMOUNT FACTOR                                           CL**2
   447*----------------------------------------------------------------*   CL**2
   448*  PASSED TO ELRESV                                              *   CL**2
   449*  -----------------                                             *   CL**2
   450*  CERTIFICATE EFFECTIVE DATE                                    *   CL**2
   451*  VALUATION DATE                                                *   CL**2
   452*  PAID THRU DATE                                                *   CL**2
   453*  BENEFIT                                                       *   CL**2
   454*  INCURRED DATE                                                 *   CL**2
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  11
* ELUPRMXA.cbl (/apps/prod/cid1p/copy/ELCCALC)
   455*  REPORTED DATE                                                 *   CL**2
   456*  ISSUE AGE                                                     *   CL**2
   457*  TERM                                                          *   CL**2
   458*  CDT PERCENT                                                   *   CL**2
   459*  CDT METHOD (I.E. INTERPOLATED, AVERAGE, ETC)                  *   CL**2
   460* *CLAIM TYPE (LIFE, A/H)                                        *   CL**2
   461* *REMAINING BENEFIT (FROM ELRAMT)                               *   CL**2
   462* *ONLY FIELDS REQUIRED FOR LIFE CLAIMS                          *   CL**2
   463*                                                                *   CL**2
   464*  RETURNED FROM ELRESV                                          *   CL**2
   465*  --------------------                                          *   CL**2
   466*  CDT TABLE USED                                                *   CL**2
   467*  CDT FACTOR USED                                               *   CL**2
   468*  PAY TO CURRENT RESERVE                                        *   CL**2
   469*  I.B.N.R. - A/H ONLY                                           *   CL**2
   470*  FUTURE (ACCRUED) AH ONLY                                      *   CL**2
   471*----------------------------------------------------------------*   CL**2
   472*  PASSED TO ELRATE                                              *   CL**2
   473*  ----------------                                              *   CL**2
   474*  CERT ISSUE DATE                                               *   CL**2
   475*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *   CL**2
   476*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *   CL**2
   477*  CAPPED TERM   (ONLY FOR TRUNCATED LIFE)                       *   CL**2
   478*  STATE CODE (CLIENT DEFINED)                                   *   CL**2
   479*  STATE CODE (STANDARD P.O. ABBRV)                              *   CL**2
   480*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *   CL**2
   481*  DEVIATION CODE                                                *   CL**2
   482*  ISSUE AGE                                                     *   CL**2
   483*  ORIGINAL BENEFIT AMOUNT                                       *   CL**2
   484*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *   CL**2
   485*  PROCESS TYPE (ISSUE OR CANCEL)                                *   CL**2
   486*  BENEFIT KIND (LIFE OR A/H)                                    *   CL**2
   487*  A.P.R.                                                        *   CL**2
   488*  METHOD                                                            CL**2
   489*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *   CL**2
   490*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *   CL**2
   491*  COMPANY I.D. (3 CHARACTER)                                    *   CL**2
   492*  BENEFIT CODE                                                  *   CL**2
   493*  BENEFIT OVERRIDE CODE                                         *   CL**2
   494*  MAXIMUM MONTHLY BENEFIT (FROM ACCT MASTER - CSL ONLY)         *   CL**2
   495*  MAXIMUM TOTAL BENEFIT (FROM ACCT MASTER - CSL ONLY)           *   CL**2
   496*  JOINT INDICATOR (CSL ONLY)                                    *   CL**2
   497*  FIRST PAYMENT DATE (CSL ONLY)                                 *   CL**2
   498*  PERIODIC PAYMENT AMOUNT (IN CP-REMAINING-TERM - CSL ONLY)     *   CL**2
   499*                                                                *   CL**2
   500*  RETURNED FROM ELRATE                                          *   CL**2
   501*  --------------------                                          *   CL**2
   502*  CALCULATED PREMIUM                                            *   CL**2
   503*  PREMIUM RATE                                                  *   CL**2
   504*  MORTALITY CODE                                                *   CL**2
   505*  MAX ATTAINED AGE                                              *   CL**2
   506*  MAX AGE                                                       *   CL**2
   507*  MAX TERM                                                      *   CL**2
   508*  MAX MONTHLY BENEFIT                                           *   CL**2
   509*  MAX TOTAL BENIFIT                                             *   CL**2
   510*  COMPOSITE RATE (OPEN-END ONLY)                                *   CL**2
   511*----------------------------------------------------------------*   CL**2
   512*  PASSED TO ELRFND                                              *   CL**2
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  12
* ELUPRMXA.cbl (/apps/prod/cid1p/copy/ELCCALC)
   513*  ----------------                                              *   CL**2
   514*  CERT ISSUE DATE                                               *   CL**2
   515*  REFUND DATE                                                   *   CL**2
   516*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *   CL**2
   517*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *   CL**2
   518*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *   CL**2
   519*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *   CL**2
   520*  STATE CODE (CLIENT DEFINED)                                   *   CL**2
   521*  STATE CODE (STANDARD P.O. ABBRV)                              *   CL**2
   522*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *   CL**2
   523*  DEVIATION CODE                                                *   CL**2
   524*  ISSUE AGE                                                     *   CL**2
   525*  ORIGINAL BENEFIT AMOUNT                                       *   CL**2
   526*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *   CL**2
   527*  PROCESS TYPE (CANCEL)                                         *   CL**2
   528*  BENEFIT KIND (LIFE OR A/H)                                    *   CL**2
   529*  A.P.R.                                                        *   CL**2
   530*  EARNING METHOD - (CODE FROM BENEFIT, STATE OR ACCOUNT RECORD) *   CL**2
   531*  RATING METHOD -  (CODE FROM BENEFIT)                          *   CL**2
   532*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *   CL**2
   533*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *   CL**2
   534*  COMPANY I.D. (3 CHARACTER)                                    *   CL**2
   535*  BENEFIT CODE                                                  *   CL**2
   536*  BENEFIT OVERRIDE CODE                                         *   CL**2
   537*                                                                *   CL**2
   538*  RETURNED FROM ELRFND                                          *   CL**2
   539*  --------------------                                          *   CL**2
   540*  CALCULATED REFUND                                             *   CL**2
   541*----------------------------------------------------------------*   CL**2
   542*  PASSED TO ELEARN                                              *   CL**2
   543*  ----------------                                              *   CL**2
   544*  CERT ISSUE DATE                                               *   CL**2
   545*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *   CL**2
   546*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *   CL**2
   547*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *   CL**2
   548*  STATE CODE (CLIENT DEFINED)                                   *   CL**2
   549*  STATE CODE (STANDARD P.O. ABBRV)                              *   CL**2
   550*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *   CL**2
   551*  DEVIATION CODE                                                *   CL**2
   552*  ISSUE AGE                                                     *   CL**2
   553*  ORIGINAL BENEFIT AMOUNT                                       *   CL**2
   554*  BENEFIT KIND (LIFE OR A/H)                                    *   CL**2
   555*  A.P.R.                                                        *   CL**2
   556*  METHOD - (EARNING CODE FROM BENEFIT RECORD)                   *   CL**2
   557*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *   CL**2
   558*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *   CL**2
   559*  COMPANY I.D. (3 CHARACTER)                                    *   CL**2
   560*  BENEFIT CODE                                                  *   CL**2
   561*  BENEFIT OVERRIDE CODE                                         *   CL**2
   562*                                                                *   CL**2
   563*  RETURNED FROM ELEARN                                          *   CL**2
   564*  --------------------                                          *   CL**2
   565*  INDICATED  EARNINGS                                           *   CL**2
   566*----------------------------------------------------------------*   CL**2
   567*                 LENGTH = 450                                   *   CL**2
   568*                                                                *   CL**2
   569******************************************************************   CL**2
   570******************************************************************
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  13
* ELUPRMXA.cbl (/apps/prod/cid1p/copy/ELCCALC)
   571*                   C H A N G E   L O G
   572*
   573* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   574*-----------------------------------------------------------------
   575*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   576* EFFECTIVE    NUMBER
   577*-----------------------------------------------------------------
   578* 010303    2001061800003  PEMA  ADD DCC/MONTHLY PROCESSING
   579* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
   580* 101807    2007100100007  PEMA  EXPAND CLM RESERVE FIELDS
   581* 010410    2008021200005  PEMA  ADD FIELDS FOR MN NET PAY BALLOON
   582* 010410    2009050700003  PEMA  ADD FIELDS FOR SPP-DD
   583* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
   584* 041710    2007111300001  AJRA  ADD CLAIM CALC SW FOR SC NP+6
   585* 101110  CR2010012700001  PEMA ADD DDF REFUND/UEP PROCESSING
   586* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
   587* 040615  CR2013072200002  PEMA  ADD EXTRA PERIODS
   588******************************************************************
   589                                                                     CL**2
   590 01  CALCULATION-PASS-AREA.                                          CL**2
   591     12  CP-COMM-LENGTH            PIC S9(4)         VALUE +450      CL**2
   592                                     COMP.                           CL**2
   593                                                                     CL**2
   594     12  CP-RETURN-CODE            PIC X             VALUE ZERO.     CL**2
   595       88  NO-CP-ERROR                             VALUE ZERO.       CL**2
   596       88  CP-ERROR-OCCURED VALUE '1' '2' '3' '4' '5' '6' '7' '8'    CL**2
   597                                  '9' 'A' 'B' 'C' 'D' 'E' 'H'.       CL**2
   598       88  CP-ERROR-IN-AMOUNTS                     VALUE '1'.        CL**2
   599       88  CP-ERROR-IN-DATES                       VALUE '2'.        CL**2
   600       88  CP-ERROR-IN-OPTIONS                     VALUE '3'.        CL**2
   601       88  CP-ERROR-IN-TERMS                       VALUE '4'.        CL**2
   602       88  CP-ERROR-IN-FREQUENCY                   VALUE '5'.        CL**2
   603       88  CP-ERROR-RATE-NOT-FOUND                 VALUE '6'.        CL**2
   604       88  CP-ERROR-RATE-IS-ZERO                   VALUE '7'.        CL**2
   605       88  CP-ERROR-AMT-OUTSIDE-LIMIT              VALUE '8'.        CL**2
   606       88  CP-ERROR-TERM-OUTSIDE-LIMIT             VALUE '9'.        CL**2
   607       88  CP-ERROR-AGE-OUTSIDE-LIMIT              VALUE 'A'.        CL**2
   608       88  CP-ERROR-ATT-OUTSIDE-LIMIT              VALUE 'B'.        CL**2
   609       88  CP-ERROR-TOT-OUTSIDE-LIMIT              VALUE 'C'.        CL**2
   610       88  CP-ERROR-RATE-FILE-NOTOPEN              VALUE 'D'.        CL**2
   611       88  CP-ERROR-ISSUE-AGE-ZERO                 VALUE 'E'.        CL**2
   612       88  CP-ERROR-NO-LIMITS-CRI                  VALUE 'F'.        CL**2
   613       88  CP-ERROR-DIV-BY-ZERO                    VALUE 'G'.        CL**2
   614       88  CP-ERROR-LOAN-TERM                      VALUE 'H'.        CL**2
   615                                                                     CL**2
   616     12  CP-RETURN-CODE-2          PIC X             VALUE ZERO.     CL**2
   617       88  NO-CP-ERROR-2                           VALUE ZERO.       CL**2
   618***********************  INPUT AREAS ****************************    CL**2
   619                                                                     CL**2
   620     12  CP-CALCULATION-AREA.                                        CL**2
   621         16  CP-ACCOUNT-NUMBER     PIC X(10)       VALUE SPACES.     CL**2
   622         16  CP-CERT-EFF-DT        PIC XX.                           CL**2
   623         16  CP-VALUATION-DT       PIC XX.                           CL**2
   624         16  CP-PAID-THRU-DT       PIC XX.                           CL**2
   625         16  CP-BENEFIT-TYPE       PIC X.                            CL**2
   626           88  CP-AH                               VALUE 'A' 'D'     CL**2
   627                                                   'I' 'U'.          CL**2
   628           88  CP-REDUCING-LIFE                    VALUE 'R'.        CL**2
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  14
* ELUPRMXA.cbl (/apps/prod/cid1p/copy/ELCCALC)
   629           88  CP-LEVEL-LIFE                       VALUE 'L' 'P'.    CL**2
   630         16  CP-INCURRED-DT        PIC XX.                           CL**2
   631         16  CP-REPORTED-DT        PIC XX.                           CL**2
   632         16  CP-ACCT-FLD-5         PIC XX            VALUE SPACE.    CL**2
   633         16  CP-COMPANY-ID         PIC XXX           VALUE SPACE.    CL**2
   634         16  CP-ISSUE-AGE          PIC S9(3)         VALUE ZERO      CL**2
   635                                     COMP-3.                         CL**2
   636         16  CP-CDT-PERCENT        PIC S9(3)V99      VALUE ZERO      CL**2
   637                                     COMP-3.                         CL**2
   638         16  CP-CDT-METHOD         PIC X.                            CL**2
   639           88  CP-CDT-ROUND-NEAR                   VALUE '1'.        CL**2
   640           88  CP-CDT-ROUND-HIGH                   VALUE '2'.        CL**2
   641           88  CP-CDT-INTERPOLATED                 VALUE '3'.        CL**2
   642         16  CP-CLAIM-TYPE         PIC X.                            CL**2
   643           88  CP-AH-CLAIM                         VALUE 'A'.        CL**2
   644           88  CP-LIFE-CLAIM                       VALUE 'L'.        CL**2
   645         16  CP-ORIGINAL-TERM      PIC S9(3)         VALUE ZERO      CL**2
   646                                     COMP-3.                         CL**2
   647         16  CP-ORIGINAL-BENEFIT   PIC S9(9)V99      VALUE ZERO      CL**2
   648                                     COMP-3.                         CL**2
   649         16  CP-ORIGINAL-PREMIUM   PIC S9(7)V99      VALUE ZERO      CL**2
   650                                     COMP-3.                         CL**2
   651         16  CP-REMAINING-TERM     PIC S9(3)V99      VALUE ZERO      CL**2
   652                                     COMP-3.                         CL**2
   653         16  CP-REMAINING-BENEFIT  PIC S9(9)V99      VALUE ZERO      CL**2
   654                                     COMP-3.                         CL**2
   655         16  CP-LOAN-APR           PIC S9(3)V9(4)    VALUE ZERO      CL**2
   656                                     COMP-3.                         CL**2
   657         16  CP-PAY-FREQUENCY      PIC S9(3)         VALUE ZERO      CL**2
   658                                     COMP-3.                         CL**2
   659         16  CP-REM-TERM-METHOD    PIC X.                            CL**2
   660           88  CP-EARN-AFTER-15TH                  VALUE '1'.        CL**2
   661           88  CP-EARN-ON-HALF-MONTH               VALUE '2'.        CL**2
   662           88  CP-EARN-ON-1ST-DAY                  VALUE '3'.        CL**2
   663           88  CP-EARN-ON-FULL-MONTH               VALUE '4'.        CL**2
   664           88  CP-EARN-WITH-NO-DAYS                VALUE '5'.        CL**2
   665           88  CP-EARN-AFTER-14TH                  VALUE '6'.        CL**2
   666           88  CP-EARN-AFTER-16TH                  VALUE '7'.        CL**2
   667         16  CP-EARNING-METHOD     PIC X.                            CL**2
   668           88  CP-EARN-BY-R78                      VALUE '1' 'R'.    CL**2
   669           88  CP-EARN-BY-PRORATA                  VALUE '2' 'P'.    CL**2
   670           88  CP-EARN-AS-CALIF                    VALUE '3' 'C'.    CL**2
   671           88  CP-EARN-AS-TEXAS                    VALUE '4' 'T'.    CL**2
   672           88  CP-EARN-AS-FARM-PLAN                VALUE '4' 'T'.    CL**2
   673           88  CP-EARN-AS-NET-PAY                  VALUE '5' 'N'.    CL**2
   674           88  CP-EARN-ANTICIPATION                VALUE '6' 'A'.    CL**2
   675           88  CP-EARN-AS-MEAN                     VALUE '8' 'M'.    CL**2
   676           88  CP-EARN-AS-SUM-OF-DIGITS            VALUE '9'.        CL**2
   677           88  CP-EARN-AS-REG-BALLOON              VALUE 'B'.        CL**2
   678           88  CP-GAP-NON-REFUNDABLE               VALUE 'G'.
   679           88  CP-GAP-ACTUARIAL                    VALUE 'S'.
   680           88  CP-DCC-SPP-DDF                      VALUE 'D' 'I'.
   681           88  CP-DCC-SPP-DDF-IU                   VALUE 'I'.
   682         16  CP-PROCESS-TYPE       PIC X.                            CL**2
   683           88  CP-CLAIM                            VALUE '1'.        CL**2
   684           88  CP-CANCEL                           VALUE '2'.        CL**2
   685           88  CP-ISSUE                            VALUE '3'.        CL**2
   686         16  CP-SPECIAL-CALC-CD    PIC X.                            CL**2
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  15
* ELUPRMXA.cbl (/apps/prod/cid1p/copy/ELCCALC)
   687           88  CP-OUTSTANDING-BAL              VALUE 'O'.            CL**2
   688           88  CP-1-MTH-INTEREST               VALUE ' '.            CL**2
   689           88  CP-0-MTH-INTEREST               VALUE 'A'.            CL**2
   690           88  CP-OB-OFFLINE-RESERVED          VALUE 'B'.            CL**2
   691           88  CP-CRITICAL-PERIOD              VALUE 'C'.            CL**2
   692           88  CP-TERM-IS-DAYS                 VALUE 'D'.            CL**2
   693           88  CP-USE-PREM-AS-ENTERED          VALUE 'E'.            CL**2
   694           88  CP-FARM-PLAN                    VALUE 'F'.            CL**2
   695           88  CP-RATE-AS-STANDARD             VALUE 'G'.            CL**2
   696           88  CP-2-MTH-INTEREST               VALUE 'I'.            CL**2
   697           88  CP-3-MTH-INTEREST               VALUE 'J'.            CL**2
   698           88  CP-4-MTH-INTEREST               VALUE 'K'.            CL**2
   699           88  CP-BALLOON-LAST-PMT             VALUE 'L'.            CL**2
   700           88  CP-MORTGAGE-REC                 VALUE 'M'.            CL**2
   701           88  CP-OUTSTANDING-BALANCE          VALUE 'O'.            CL**2
   702           88  CP-NET-PAY-PRUDENTIAL           VALUE 'P'.            CL**2
   703           88  CP-NET-PAY-SIMPLE               VALUE 'S'.            CL**2
   704           88  CP-TRUNCATED-LIFE               VALUE 'T' 'U' 'V'     CL**2
   705                                                     'W' 'X'.        CL**2
   706           88  CP-TRUNCATE-0-MTH               VALUE 'T'.            CL**2
   707           88  CP-TRUNCATE-1-MTH               VALUE 'U'.            CL**2
   708           88  CP-TRUNCATE-2-MTH               VALUE 'V'.            CL**2
   709           88  CP-TRUNCATE-3-MTH               VALUE 'W'.            CL**2
   710           88  CP-TRUNCATE-4-MTH               VALUE 'X'.            CL**2
   711           88  CP-SUMMARY-REC                  VALUE 'Z'.            CL**2
   712           88  CP-PROPERTY-BENEFIT             VALUE '2'.            CL**2
   713           88  CP-UNEMPLOYMENT-BENEFIT         VALUE '3'.            CL**2
   714           88  CP-AD-D-BENEFIT                 VALUE '4'.            CL**2
   715           88  CP-CSL-METH-1                   VALUE '5'.            CL**2
   716           88  CP-CSL-METH-2                   VALUE '6'.            CL**2
   717           88  CP-CSL-METH-3                   VALUE '7'.            CL**2
   718           88  CP-CSL-METH-4                   VALUE '8'.            CL**2
   719                                                                     CL**2
   720         16  CP-LOAN-TERM          PIC S9(3)       VALUE ZERO        CL**2
   721                                     COMP-3.                         CL**2
   722         16  CP-CLASS-CODE         PIC XX          VALUE ZERO.       CL**2
   723         16  CP-DEVIATION-CODE     PIC XXX         VALUE ZERO.       CL**2
   724         16  CP-STATE              PIC XX          VALUE SPACE.      CL**2
   725         16  CP-STATE-STD-ABBRV    PIC XX          VALUE SPACE.      CL**2
   726         16  CP-BENEFIT-CD         PIC XX          VALUE ZERO.       CL**2
   727           88  CP-CSL-VALID-NP-BENEFIT-CD VALUES '12' '13'           CL**2
   728               '34' '35' '36' '37' '44' '45' '46' '47' '72' '73'.    CL**2
   729         16  CP-R78-OPTION         PIC X.                            CL**2
   730           88  CP-TERM-TIMES-TERM-PLUS-1           VALUE ' '.        CL**2
   731           88  CP-TERM-TIMES-TERM                  VALUE '1'.        CL**2
   732                                                                     CL**2
   733         16  CP-COMPANY-CD         PIC X             VALUE SPACE.    CL**2
   734         16  CP-IBNR-RESERVE-SW    PIC X.                            CL**2
   735         16  CP-CLAIM-STATUS       PIC X.                            CL**2
   736         16  CP-RATE-FILE          PIC X.                            CL**2
   737         16  CP-TERM-OR-EXT-DAYS   PIC S9(05)        VALUE ZERO      CL**2
   738                                     COMP-3.                         CL**2
   739                                                                     CL**2
   740         16  CP-LIFE-OVERRIDE-CODE PIC X.                            CL**2
   741         16  CP-AH-OVERRIDE-CODE   PIC X.                            CL**2
   742                                                                     CL**2
   743         16  CP-RATE-DEV-PCT       PIC S9V9(6)       VALUE ZERO      CL**2
   744                                     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  16
* ELUPRMXA.cbl (/apps/prod/cid1p/copy/ELCCALC)
   745         16  CP-CLP-RATE-UP        REDEFINES CP-RATE-DEV-PCT
   746                                   PIC S9(5)V99 COMP-3.
   747         16  CP-CRITICAL-MONTHS    PIC S9(3)         VALUE ZERO      CL**2
   748                                     COMP-3.                         CL**2
   749         16  CP-ALTERNATE-BENEFIT  PIC S9(9)V99      VALUE ZERO      CL**2
   750                                     COMP-3.                         CL**2
   751         16  CP-ALTERNATE-PREMIUM  PIC S9(7)V99      VALUE ZERO      CL**2
   752                                     COMP-3.
   753         16  CP-DDF-CSO-ADMIN-FEE REDEFINES CP-ALTERNATE-PREMIUM
   754                                  PIC S9(7)V99 COMP-3.
   755                                                                     CL**2
   756         16  CP-PAID-FROM-DATE     PIC X(02).                        CL**2
   757         16  CP-CLAIM-CALC-METHOD  PIC X(01).                        CL**2
   758         16  CP-EXT-DAYS-CALC      PIC X.                            CL**2
   759           88  CP-EXT-NO-CHG                   VALUE ' '.            CL**2
   760           88  CP-EXT-CHG-LF                   VALUE '1'.            CL**2
   761           88  CP-EXT-CHG-AH                   VALUE '2'.            CL**2
   762           88  CP-EXT-CHG-LF-AH                VALUE '3'.            CL**2
   763         16  CP-DOMICILE-STATE     PIC XX.                           CL**2
   764         16  CP-CARRIER            PIC X.                            CL**2
   765         16  CP-REIN-FLAG          PIC X.                            CL**2
   766         16  CP-REM-TRM-CALC-OPTION PIC X.                           CL**2
   767           88  VALID-REM-TRM-CALC-OPTION    VALUE '1'                CL**2
   768                      '2' '3' '4' '5'.                               CL**2
   769           88  CP-CALC-OPTION-DEFAULT       VALUE '4'.               CL**2
   770           88  CP-CONSIDER-EXTENSION        VALUE '3' '4' '5'.       CL**2
   771           88  CP-30-DAY-MONTH              VALUE '1' '3' '5'.       CL**2
   772           88  CP-NO-EXT-30-DAY-MONTH       VALUE '1'.               CL**2
   773           88  CP-NO-EXT-ACTUAL-DAYS        VALUE '2'.               CL**2
   774           88  CP-EXT-30-DAY-MONTH          VALUE '3'.               CL**2
   775           88  CP-EXT-ACTUAL-DAYS           VALUE '4'.               CL**2
   776           88  CP-USE-EXP-AND-1ST-PMT       VALUE '5'.
   777         16  CP-SIG-SWITCH         PIC X.                            CL**2
   778         16  CP-RATING-METHOD      PIC X.                            CL**2
   779           88  CP-RATE-AS-R78                      VALUE '1' 'R'.    CL**2
   780           88  CP-RATE-AS-PRORATA                  VALUE '2' 'P'.    CL**2
   781           88  CP-RATE-AS-CALIF                    VALUE '3' 'C'.    CL**2
   782           88  CP-RATE-AS-TEXAS                    VALUE '4' 'T'.    CL**2
   783           88  CP-RATE-AS-FARM-PLAN                VALUE '4' 'T'.    CL**2
   784           88  CP-RATE-AS-NET-PAY                  VALUE '5' 'N'.    CL**2
   785           88  CP-RATE-AS-ANTICIPATION             VALUE '6' 'A'.    CL**2
   786           88  CP-RATE-AS-MEAN                     VALUE '8' 'M'.    CL**2
   787           88  CP-RATE-AS-REG-BALLOON              VALUE 'B'.        CL**2
   788         16  CP-SALES-TAX          PIC S9V9999     VALUE  ZEROS      CL**2
   789                                     COMP-3.                         CL**2
   790         16  CP-BEN-CATEGORY       PIC X.
   791         16  CP-DCC-LF-RATE        PIC S99V9(5) COMP-3 VALUE +0.
   792         16  CP-DCC-ACT-COMM REDEFINES CP-DCC-LF-RATE
   793                                   PIC S99V9(5) COMP-3.
   794         16  CP-DCC-AH-RATE        PIC S99V9(5) COMP-3 VALUE +0.
   795         16  CP-DCC-PMF-COMM REDEFINES CP-DCC-AH-RATE
   796                                   PIC S99V9(5) COMP-3.
   797         16  CP-DAYS-TO-1ST-PMT    PIC S999     COMP-3 VALUE +0.
   798         16  CP-AH-BALLOON-SW      PIC X  VALUE ' '.
   799         16  CP-EXPIRE-DT          PIC XX.
   800         16  CP-LF-CLAIM-CALC-SW   PIC X  VALUE ' '.
   801         16  CP-DDF-HI-FACT        PIC S9V999   COMP-3 VALUE +0.
   802         16  CP-DDF-LO-FACT        PIC S9V999   COMP-3 VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  17
* ELUPRMXA.cbl (/apps/prod/cid1p/copy/ELCCALC)
   803         16  CP-DDF-CLP            PIC S9(5)V99 COMP-3 VALUE +0.
   804         16  CP-DDF-SPEC-CALC      PIC X.
   805             88  CP-CALC-GROSS-FEE        VALUE 'G'.
   806             88  CP-CALC-CLP              VALUE 'C'.
   807         16  CP-IU-RATE-UP         PIC S9(5)V99   COMP-3 VALUE +0.
   808         16  CP-CANCEL-REASON      PIC X.
   809         16  CP-DDF-ADMIN-FEES     PIC S9(5)V99 COMP-3 VALUE +0.
   810         16  CP-PMT-MODE           PIC X.
   811         16  CP-NO-OF-PMTS         PIC S999 COMP-3 VALUE +0.
   812         16  CP-1ST-YR-ALLOW       PIC S999V99 COMP-3 VALUE +0.
   813         16  CP-DDF-COMM-AND-MFEE  PIC S9(5)V99 COMP-3 VALUE +0.
   814         16  CP-DDF-YR1AF          PIC S9(5)V99 COMP-3 VALUE +0.
   815         16  FILLER                PIC X.
   816                                                                     CL**2
   817***************    OUTPUT FROM ELRESV   ************************     CL**2
   818                                                                     CL**2
   819         16  CP-CDT-TABLE          PIC 9             VALUE ZERO.     CL**2
   820                                                                     CL**2
   821         16  CP-CDT-FACTOR         PIC S9(5)V9(6)    VALUE ZERO      CL**2
   822                                     COMP-3.                         CL**2
   823         16  CP-PTC-RESERVE        PIC S9(7)V99   VALUE ZERO         CL**2
   824                                     COMP-3.                         CL**2
   825         16  CP-IBNR-RESERVE       PIC S9(7)V99   VALUE ZERO         CL**2
   826                                     COMP-3.                         CL**2
   827         16  CP-FUTURE-RESERVE     PIC S9(7)V99   VALUE ZERO         CL**2
   828                                     COMP-3.                         CL**2
   829         16  FILLER                PIC X(09).                        CL**2
   830***************    OUTPUT FROM ELRTRM   *************************    CL**2
   831                                                                     CL**2
   832         16  CP-REMAINING-TERM-1   PIC S9(4)V9    VALUE ZERO         CL**2
   833                                     COMP-3.                         CL**2
   834         16  CP-REMAINING-TERM-2   PIC S9(4)V9    VALUE ZERO         CL**2
   835                                     COMP-3.                         CL**2
   836         16  CP-REMAINING-TERM-3   PIC S9(4)V9    VALUE ZERO         CL**2
   837                                     COMP-3.                         CL**2
   838         16  CP-ODD-DAYS           PIC S9(3)      VALUE ZERO         CL**2
   839                                     COMP-3.                         CL**2
   840         16  FILLER                PIC X(12).                        CL**2
   841                                                                     CL**2
   842***************    OUTPUT FROM ELRAMT   *************************    CL**2
   843                                                                     CL**2
   844         16  CP-REMAINING-AMT      PIC S9(9)V99   VALUE ZERO         CL**2
   845                                     COMP-3.                         CL**2
   846         16  CP-REMAINING-AMT-PRV  PIC S9(9)V99   VALUE ZERO         CL**2
   847                                     COMP-3.                         CL**2
   848         16  FILLER                PIC X(12).                        CL**2
   849                                                                     CL**2
   850***************    OUTPUT FROM ELRATE   *************************    CL**2
   851                                                                     CL**2
   852         16  CP-CALC-PREMIUM       PIC S9(7)V99   VALUE ZERO         CL**2
   853                                     COMP-3.                         CL**2
   854         16  CP-PREMIUM-RATE       PIC S9(2)V9(5) VALUE ZERO         CL**2
   855                                     COMP-3.                         CL**2
   856         16  CP-MORTALITY-CODE     PIC X(4).                         CL**2
   857         16  CP-RATE-EDIT-FLAG     PIC X.                            CL**2
   858             88  CP-RATES-NEED-APR                  VALUE '1'.       CL**2
   859         16  CP-COMPOSITE-RATE     PIC S99V999    VALUE ZERO         CL**2
   860                                     COMP-3.                         CL**2
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  18
* ELUPRMXA.cbl (/apps/prod/cid1p/copy/ELCCALC)
   861         16  CP-POLICY-FEE         PIC S9(3)V99 VALUE +0 COMP-3.     CL**2
   862         16  CP-LF-PREM            PIC S9(7)V99 VALUE +0 COMP-3.
   863         16  CP-LF-BALLOON-PREM REDEFINES CP-LF-PREM
   864                                   PIC S9(7)V99 COMP-3.
   865         16  FILLER                PIC X(07).                        CL**2
   866                                                                     CL**2
   867***************    OUTPUT FROM ELRFND   *************************    CL**2
   868                                                                     CL**2
   869         16  CP-CALC-REFUND        PIC S9(7)V99   VALUE ZERO         CL**2
   870                                     COMP-3.                         CL**2
   871         16  CP-REFUND-TYPE-USED   PIC X.                            CL**2
   872           88  CP-R-AS-R78                         VALUE '1'.        CL**2
   873           88  CP-R-AS-PRORATA                     VALUE '2'.        CL**2
   874           88  CP-R-AS-CALIF                       VALUE '3'.        CL**2
   875           88  CP-R-AS-TEXAS                       VALUE '4'.        CL**2
   876           88  CP-R-AS-FARM-PLAN                   VALUE '4'.        CL**2
   877           88  CP-R-AS-NET-PAY                     VALUE '5'.        CL**2
   878           88  CP-R-AS-ANTICIPATION                VALUE '6'.        CL**2
   879           88  CP-R-AS-MEAN                        VALUE '8'.        CL**2
   880           88  CP-R-AS-SUM-OF-DIGITS               VALUE '9'.        CL**2
   881           88  CP-R-AS-GAP-NON-REFUND              VALUE 'G'.
   882           88  CP-R-AS-GAP-ACTUARIAL               VALUE 'S'.
   883           88  CP-R-AS-SPP-DDF                     VALUE 'D'.
   884           88  CP-R-AS-SPP-DDF-IU                  VALUE 'I'.
   885           88  CP-R-AS-REPOSSESSION                VALUE 'R'.
   886         16  FILLER                PIC X(12).                        CL**2
   887                                                                     CL**2
   888***************    OUTPUT FROM ELEARN   *************************    CL**2
   889                                                                     CL**2
   890         16  CP-R78-U-PRM          PIC S9(7)V99   VALUE ZERO         CL**2
   891                                     COMP-3.                         CL**2
   892         16  CP-R78-U-PRM-ALT      PIC S9(7)V99   VALUE ZERO         CL**2
   893                                     COMP-3.                         CL**2
   894         16  CP-PRORATA-U-PRM      PIC S9(7)V99   VALUE ZERO         CL**2
   895                                     COMP-3.                         CL**2
   896         16  CP-PRORATA-U-PRM-ALT  PIC S9(7)V99   VALUE ZERO         CL**2
   897                                     COMP-3.                         CL**2
   898         16  CP-STATE-U-PRM        PIC S9(7)V99   VALUE ZERO         CL**2
   899                                     COMP-3.                         CL**2
   900         16  CP-DOMICILE-U-PRM     PIC S9(7)V99   VALUE ZERO         CL**2
   901                                     COMP-3.                         CL**2
   902         16  CP-EARNING-TYPE-USED  PIC X.                            CL**2
   903           88  CP-E-AS-SPECIAL                     VALUE 'S'.        CL**2
   904           88  CP-E-AS-R78                         VALUE '1'.        CL**2
   905           88  CP-E-AS-PRORATA                     VALUE '2'.        CL**2
   906           88  CP-E-AS-TEXAS                       VALUE '4'.        CL**2
   907           88  CP-E-AS-FARM-PLAN                   VALUE '4'.        CL**2
   908           88  CP-E-AS-NET-PAY                     VALUE '5'.        CL**2
   909           88  CP-E-AS-ANTICIPATION                VALUE '6'.        CL**2
   910           88  CP-E-AS-MEAN                        VALUE '8'.        CL**2
   911           88  CP-E-AS-SUM-OF-DIGITS               VALUE '9'.        CL**2
   912         16  FILLER                PIC X(12).                        CL**2
   913                                                                     CL**2
   914***************    OUTPUT FROM ELPMNT   *************************    CL**2
   915                                                                     CL**2
   916         16  CP-ACTUAL-DAYS        PIC S9(05)     VALUE ZERO         CL**2
   917                                     COMP-3.                         CL**2
   918         16  CP-CLAIM-PAYMENT      PIC S9(7)V99   VALUE ZERO         CL**2
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  19
* ELUPRMXA.cbl (/apps/prod/cid1p/copy/ELCCALC)
   919                                     COMP-3.                         CL**2
   920         16  FILLER                PIC X(12).                        CL**2
   921                                                                     CL**2
   922***************   MISC WORK AREAS    *****************************   CL**2
   923         16  CP-TOTAL-PAID         PIC S9(7)V99   VALUE ZERO         CL**2
   924                                     COMP-3.                         CL**2
   925         16  CP-R-MAX-ATT-AGE      PIC S9(3)      VALUE ZERO         CL**2
   926                                     COMP-3.                         CL**2
   927         16  CP-R-MAX-AGE          PIC S9(3)      VALUE ZERO         CL**2
   928                                     COMP-3.                         CL**2
   929         16  CP-R-MAX-TERM         PIC S9(5)      VALUE ZERO         CL**2
   930                                     COMP-3.                         CL**2
   931         16  CP-R-MAX-TOT-BEN      PIC S9(7)V99   VALUE ZERO         CL**2
   932                                     COMP-3.                         CL**2
   933         16  CP-R-MAX-MON-BEN      PIC S9(7)V99   VALUE ZERO         CL**2
   934                                     COMP-3.                         CL**2
   935         16  CP-IO-FUNCTION        PIC X          VALUE SPACE.       CL**2
   936             88  OPEN-RATE-FILE                   VALUE 'O'.         CL**2
   937             88  CLOSE-RATE-FILE                  VALUE 'C'.         CL**2
   938             88  IO-ERROR                         VALUE 'E'.         CL**2
   939                                                                     CL**2
   940         16  CP-FIRST-PAY-DATE     PIC XX.                           CL**2
   941                                                                     CL**2
   942         16  CP-JOINT-INDICATOR    PIC X.                            CL**2
   943                                                                     CL**2
   944         16  CP-RESERVE-REMAINING-TERM                               CL**2
   945                                   PIC S9(4)V9    VALUE ZERO         CL**2
   946                                     COMP-3.                         CL**2
   947                                                                     CL**2
   948         16  CP-INSURED-BIRTH-DT   PIC XX.                           CL**2
   949                                                                     CL**2
   950         16  CP-INCURRED-AGE       PIC S9(3)      VALUE ZERO         CL**2
   951                                     COMP-3.                         CL**2
   952                                                                     CL**2
   953         16  CP-MONTHLY-PAYMENT    PIC S9(5)V99   VALUE ZERO         CL**2
   954                                     COMP-3.                         CL**2
   955                                                                     CL**2
   956         16  CP-RATING-BENEFIT-AMT PIC S9(9)V99   VALUE ZERO         CL**2
   957                                     COMP-3.                         CL**2
   958                                                                     CL**2
   959         16  CP-ODD-DAYS-TO-PMT    PIC S9(3)      VALUE ZERO         CL**2
   960                                     COMP-3.                         CL**2
   961                                                                     CL**2
   962         16  CP-MNTHS-TO-FIRST-PMT PIC S9(3)      VALUE ZERO         CL**2
   963                                     COMP-3.                         CL**2
   964                                                                     CL**2
   965         16  CP-REMAMT-FACTOR      PIC S9(4)V9(9) VALUE ZEROS        CL**2
   966                                     COMP-3.                         CL**2
   967                                                                     CL**2
   968         16  CP-FREE-LOOK          PIC S9(3)      VALUE ZERO         CL**2
   969                                     COMP-3.                         CL**2
   970                                                                     CL**2
   971         16  CP-ROA-REFUND         PIC X          VALUE 'N'.         CL**2
   972             88  CP-ROA-PREM-AT-REFUND            VALUE 'Y'.         CL**2
   973                                                                     CL**2
   974         16  CP-NET-BENEFIT-AMT    PIC S9(9)V99   VALUE ZERO         CL**2
   975                                     COMP-3.                         CL**2
   976         16  CP-SCNP-6MO-AMT       PIC S9(9)V99   VALUE ZERO
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  20
* ELUPRMXA.cbl (/apps/prod/cid1p/copy/ELCCALC)
   977                                     COMP-3.
   978         16  CP-MONTH              PIC S999     COMP-3 VALUE +0.
   979         16  cp-extra-periods      pic 9 value zeros.
   980         16  cp-net-only-state     pic x value spaces.
   981         16  FILLER                PIC X(13).                        CL**2
   982******************************************************************   CL**2
   983
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  21
* ELUPRMXA.cbl
   985 PROCEDURE DIVISION  USING CALCULATION-PASS-AREA.
   986
   987 0000-START-UNEARNED-CALC.
*  988                       COPY ELCUPRMPA.
   989****************************************************************
   990*                                                              *
   991*                            ELCUPRMP.                         *
   992*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   993*                            VMOD=2.009                        *
   994*                                                              *
   995****************************************************************.
   996
   997
   998     MOVE ZERO                   TO  CP-RETURN-CODE
   999                                     CP-R78-U-PRM
  1000                                     CP-R78-U-PRM-ALT
  1001                                     CP-PRORATA-U-PRM
  1002                                     CP-PRORATA-U-PRM-ALT
  1003                                     CP-STATE-U-PRM
  1004                                     CP-DOMICILE-U-PRM
  1005                                     PR-UN-PREMIUM
  1006                                     PR-UN-PREM-ALT
  1007                                     STATE-UN-PREMIUM
  1008                                     DOMI-UN-PREMIUM
  1009                                     R78-UN-PREMIUM
  1010                                     R78-UN-PREM-ALT.
  1011
  1012
  1013 0001-GET-EFFECTIVE-DATE.
  1014
  1015     MOVE CP-CERT-EFF-DT     TO DC-BIN-DATE-1.
  1016     MOVE SPACE              TO DC-OPTION-CODE.
  1017     PERFORM 9100-CONVERT-DATE THRU 9100-EXIT.
  1018
  1019     IF DATE-CONVERSION-ERROR
  1020          DISPLAY 'BAD RET  '
  1021         MOVE '2' TO CP-RETURN-CODE
  1022          GO TO 1999-EXIT-CALC-ROUTINE.
  1023
  1024     IF CP-ORIGINAL-TERM EQUAL 0
  1025         MOVE '1'           TO CP-RETURN-CODE
  1026          GO TO 1999-EXIT-CALC-ROUTINE.
  1027
  1028     IF CP-AH
  1029         PERFORM 1500-CALC-UNEARNED-AH THRU
  1030                               1500-CALC-UNEARNED-X
  1031     ELSE
  1032         PERFORM 1000-CALC-UNEARNED-LIFE THRU
  1033                               1000-CALC-UNEARNED-X.
  1034
  1035     GO TO 1999-EXIT-CALC-ROUTINE.
  1036
  1037 0009-EXIT.
  1038     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  22
* ELUPRMXA.cbl (/apps/prod/cid1p/copy/ELCUPRMPA)
  1040******************** UNEARNED LIFE PREMIUM ***********************
  1041 1000-CALC-UNEARNED-LIFE SECTION.
  1042
  1043     IF CP-SPECIAL-CALC-CD EQUAL 'G'
  1044         MOVE 'N' TO CP-EARNING-METHOD.
  1045
  1046     IF CP-TERM-OR-EXT-DAYS NOT NUMERIC
  1047         MOVE +0                TO CP-TERM-OR-EXT-DAYS.
  1048
  1049     IF CP-LOAN-TERM NOT NUMERIC
  1050         MOVE +0                TO CP-LOAN-TERM.
  1051
  1052     IF CP-EARNING-METHOD EQUAL 'T'
  1053         PERFORM 1160-CALC-TEXAS-UN   THRU 1160-EXIT
  1054         GO TO 1000-CALC-UNEARNED-X1.
  1055
  1056     PERFORM 1100-LIFE-PRORATA-UNEARNED THRU 1111-EXIT.
  1057     PERFORM 1120-LIFE-RULE78S-UNEARNED THRU 1120-EXIT.
  1058
  1059     IF CP-COMPANY-ID EQUAL 'NCL'
  1060        IF CP-EARN-AS-REG-BALLOON
  1061           IF CP-SPECIAL-CALC-CD EQUAL 'A'
  1062              PERFORM 1180-CALC-NET-PAY-UN THRU 1180-EXIT
  1063              GO TO 1000-DO-STATE-DOM-REGS.
  1064
  1065     IF (CP-EARNING-METHOD = 'B' OR 'K' OR 'L')
  1066         GO TO 1000-DO-STATE-DOM-REGS.
  1067
  1068     IF CP-COMPANY-ID = 'NCL'
  1069         IF DC-GREG-DATE-CYMD LESS THAN 19910101
  1070             MOVE ZEROS           TO CP-LOAN-APR
  1071             IF CP-EARN-AS-NET-PAY
  1072                 MOVE 'R'         TO CP-EARNING-METHOD.
  1073
  1074     IF CP-BENEFIT-CD     EQUAL 'QD'
  1075       MOVE 'N' TO CP-EARNING-METHOD
  1076       MOVE +15.0 TO N-P-APR
  1077         PERFORM 1180-CALC-NET-PAY-UN THRU 1180-EXIT
  1078         GO TO 1000-DO-STATE-DOM-REGS.
  1079
  1080     IF CP-EARNING-METHOD EQUAL 'N'
  1081         PERFORM 1180-CALC-NET-PAY-UN THRU 1180-EXIT
  1082         GO TO 1000-DO-STATE-DOM-REGS.
  1083
  1084     IF CP-STATE-STD-ABBRV = 'OH'
  1085         IF (CP-ORIGINAL-TERM GREATER THAN +60) AND
  1086            (CP-CLASS-CODE NOT = 'L ')           AND
  1087            (DC-GREG-DATE-CYMD GREATER 19831031) AND
  1088            (CP-LOAN-APR GREATER THAN ZERO)
  1089            PERFORM 1180-CALC-NET-PAY-UN THRU 1180-EXIT.
  1090
  1091     IF CP-STATE-STD-ABBRV = 'MT'
  1092         IF (CP-ORIGINAL-TERM GREATER THAN +61) AND
  1093            (DC-GREG-DATE-CYMD GREATER 19830318) AND
  1094            (CP-LOAN-APR GREATER THAN ZERO)
  1095            PERFORM 1180-CALC-NET-PAY-UN THRU 1180-EXIT.
  1096
  1097     IF CP-STATE-STD-ABBRV = 'UT'
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  23
* ELUPRMXA.cbl (/apps/prod/cid1p/copy/ELCUPRMPA)
  1098         IF (CP-ORIGINAL-TERM GREATER THAN +62) AND
  1099            (DC-GREG-DATE-CYMD GREATER 19810831) AND
  1100            (DC-GREG-DATE-CYMD LESS 19830901) AND
  1101            (CP-LOAN-APR GREATER THAN ZERO)
  1102            PERFORM 1180-CALC-NET-PAY-UN THRU 1180-EXIT.
  1103
  1104     IF CP-STATE-STD-ABBRV  = 'RI'
  1105         IF (CP-ORIGINAL-TERM GREATER THAN +60) AND
  1106            (DC-GREG-DATE-CYMD GREATER 19831231) AND
  1107            (CP-LOAN-APR GREATER THAN ZERO)
  1108             PERFORM 1180-CALC-NET-PAY-UN THRU 1180-EXIT.
  1109
  1110 1000-DO-STATE-DOM-REGS.
  1111
  1112     PERFORM 1200-DO-STATE-REGS    THRU 1200-EXIT.
  1113     PERFORM 1300-DO-DOMICILE      THRU 1300-EXIT.
  1114
  1115 1000-CALC-UNEARNED-X1.
  1116
  1117     MOVE DOMI-UN-PREMIUM         TO CP-DOMICILE-U-PRM.
  1118     MOVE STATE-UN-PREMIUM        TO CP-STATE-U-PRM.
  1119     MOVE PR-UN-PREMIUM           TO CP-PRORATA-U-PRM.
  1120     MOVE PR-UN-PREM-ALT          TO CP-PRORATA-U-PRM-ALT.
  1121     MOVE R78-UN-PREMIUM          TO CP-R78-U-PRM.
  1122     MOVE R78-UN-PREM-ALT         TO CP-R78-U-PRM-ALT.
  1123
  1124 1000-CALC-UNEARNED-X.
  1125*---------------------------------------------------------------
  1126     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  24
* ELUPRMXA.cbl (/apps/prod/cid1p/copy/ELCUPRMPA)
  1128*********************************************
  1129*                                           *
  1130* PERFORMED: LIFE UNEARNED PREMIUM ROUTINES *
  1131*                                           *
  1132*********************************************
  1133
  1134 1100-LIFE-PRORATA-UNEARNED.
  1135
  1136     IF CP-COMPANY-ID EQUAL 'FLI' OR 'FLU' OR 'MIC' OR 'MCC'
  1137         COMPUTE PR-FACTOR ROUNDED =
  1138                   (CP-REMAINING-TERM - .5) / CP-ORIGINAL-TERM
  1139     ELSE
  1140         COMPUTE PR-FACTOR ROUNDED =
  1141                       CP-REMAINING-TERM / CP-ORIGINAL-TERM.
  1142
  1143     COMPUTE PR-UN-PREMIUM ROUNDED =
  1144                     CP-ORIGINAL-PREMIUM * PR-FACTOR.
  1145
  1146
  1147     IF (CP-EARNING-METHOD NOT = 'B' AND 'K' AND 'L')
  1148         GO TO 1111-EXIT.
  1149
  1150     IF CP-SPECIAL-CALC-CD EQUAL 'L'
  1151         GO TO 1110-ALT-LIFE-PRO-UNEARNED.
  1152
  1153     IF CP-COMPANY-ID EQUAL 'FLI' OR 'FLU' OR 'MIC' OR 'MCC'
  1154         COMPUTE PR-FACTOR  ROUNDED =
  1155               (CP-REMAINING-TERM + .5) / (CP-ORIGINAL-TERM + 1)
  1156     ELSE
  1157         COMPUTE PR-FACTOR  ROUNDED =
  1158              (CP-REMAINING-TERM + 1) / (CP-ORIGINAL-TERM + 1).
  1159
  1160 1110-ALT-LIFE-PRO-UNEARNED.
  1161
  1162     COMPUTE PR-UN-PREM-ALT ROUNDED =
  1163                   CP-ALTERNATE-PREMIUM * PR-FACTOR.
  1164
  1165
  1166     COMPUTE PR-UN-PREMIUM = PR-UN-PREMIUM +
  1167                    PR-UN-PREM-ALT.
  1168
  1169
  1170 1111-EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  25
* ELUPRMXA.cbl (/apps/prod/cid1p/copy/ELCUPRMPA)
  1172*---------------------------------------------------------------
  1173 1120-LIFE-RULE78S-UNEARNED.
  1174
  1175     COMPUTE R78-TEMP-1 =
  1176                CP-REMAINING-TERM * (CP-REMAINING-TERM + +1).
  1177
  1178     IF CP-R78-OPTION = '1'
  1179         COMPUTE R78-TEMP-1 =
  1180                  CP-REMAINING-TERM * CP-REMAINING-TERM.
  1181
  1182     IF CP-COMPANY-ID = 'FLI'
  1183         COMPUTE R78-TEMP-1 =
  1184                  CP-REMAINING-TERM * CP-REMAINING-TERM.
  1185
  1186     IF CP-COMPANY-ID = 'MPP'
  1187         COMPUTE R78-TEMP-1 =
  1188                 (CP-ORIGINAL-TERM - CP-REMAINING-TERM)
  1189                 * ((CP-ORIGINAL-TERM - CP-REMAINING-TERM) + +1).
  1190
  1191     COMPUTE R78-TEMP-2 =
  1192                  CP-ORIGINAL-TERM * (CP-ORIGINAL-TERM + +1).
  1193
  1194     COMPUTE R78-FACTOR ROUNDED = R78-TEMP-1 / R78-TEMP-2.
  1195
  1196     COMPUTE R78-UN-PREMIUM ROUNDED =
  1197                     CP-ORIGINAL-PREMIUM * R78-FACTOR.
  1198
  1199
  1200
  1201     IF (CP-EARNING-METHOD NOT = 'B' AND 'K' AND 'L')
  1202         GO TO 1120-EXIT.
  1203
  1204     IF CP-SPECIAL-CALC-CD EQUAL 'L'
  1205         GO TO 1120-ALT-LIFE-R78-UNEARNED.
  1206
  1207     IF CP-R78-OPTION = '1' OR CP-COMPANY-ID = 'FLI'
  1208         COMPUTE R78-TEMP-1 =
  1209                (CP-REMAINING-TERM + 1) *
  1210                 (CP-REMAINING-TERM + 1 )
  1211     ELSE
  1212         COMPUTE R78-TEMP-1 =
  1213              (CP-REMAINING-TERM + 1) *
  1214              (CP-REMAINING-TERM + 2).
  1215
  1216     IF CP-COMPANY-ID = 'MPP'
  1217         COMPUTE R78-TEMP-1 =
  1218            ((CP-ORIGINAL-TERM + 1) - (CP-REMAINING-TERM + 1))
  1219           * ((CP-ORIGINAL-TERM + 1) - (CP-REMAINING-TERM + 1)).
  1220
  1221     COMPUTE R78-TEMP-2 =
  1222           (CP-ORIGINAL-TERM + 1) * (CP-ORIGINAL-TERM + 2).
  1223
  1224     COMPUTE R78-FACTOR ROUNDED =
  1225               R78-TEMP-1 / R78-TEMP-2.
  1226
  1227 1120-ALT-LIFE-R78-UNEARNED.
  1228
  1229     COMPUTE R78-UN-PREM-ALT ROUNDED =
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  26
* ELUPRMXA.cbl (/apps/prod/cid1p/copy/ELCUPRMPA)
  1230             CP-ALTERNATE-PREMIUM * R78-FACTOR.
  1231
  1232
  1233     COMPUTE R78-UN-PREMIUM ROUNDED =
  1234             R78-UN-PREMIUM + R78-UN-PREM-ALT.
  1235
  1236
  1237 1120-EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  27
* ELUPRMXA.cbl (/apps/prod/cid1p/copy/ELCUPRMPA)
  1239*---------------------------------------------------------------
  1240 1160-CALC-TEXAS-UN.
  1241
  1242     IF CP-PAY-FREQUENCY = ZERO
  1243        MOVE '5'                 TO CP-RETURN-CODE
  1244        GO TO 1160-EXIT.
  1245
  1246     COMPUTE TEX-FACT-4 = (CP-ORIGINAL-TERM * CP-ORIGINAL-TERM) +
  1247         (CP-PAY-FREQUENCY * CP-ORIGINAL-TERM).
  1248
  1249     DIVIDE CP-REMAINING-TERM BY CP-PAY-FREQUENCY
  1250         GIVING TEX-FACT-5
  1251             REMAINDER TEX-FACT-6.
  1252
  1253     COMPUTE TEX-FACT-5 = TEX-FACT-5 * CP-PAY-FREQUENCY.
  1254
  1255     COMPUTE TEX-FACT-7 = (TEX-FACT-5 * TEX-FACT-5) +
  1256         (TEX-FACT-5 * CP-PAY-FREQUENCY) +
  1257         (2 * (TEX-FACT-6 * (TEX-FACT-5 + CP-PAY-FREQUENCY))).
  1258
  1259     COMPUTE TEX-FACT-8 ROUNDED = TEX-FACT-7 / TEX-FACT-4.
  1260
  1261     COMPUTE STATE-UN-PREMIUM ROUNDED =
  1262              CP-ORIGINAL-PREMIUM * TEX-FACT-8.
  1263
  1264     MOVE STATE-UN-PREMIUM       TO  PR-UN-PREMIUM
  1265                                     R78-UN-PREMIUM
  1266                                     DOMI-UN-PREMIUM.
  1267
  1268 1160-EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  28
* ELUPRMXA.cbl (/apps/prod/cid1p/copy/ELCUPRMPA)
  1270
  1271*---------------------------------------------------------------
  1272 1180-CALC-NET-PAY-UN.
  1273
  1274     IF CP-LOAN-APR = ZERO
  1275        MOVE '5'            TO  CP-EARNING-METHOD
  1276        MOVE ZEROS          TO  DOMI-UN-PREMIUM
  1277        MOVE ZEROS          TO  STATE-UN-PREMIUM
  1278        GO TO 1180-EXIT.
  1279
  1280     MOVE CP-LOAN-APR       TO N-P-APR.
  1281     MOVE CP-ORIGINAL-TERM  TO N-P-ORIG
  1282                               N-P-CAP.
  1283     MOVE CP-REMAINING-TERM TO N-P-REM.
  1284
  1285     IF CP-TRUNCATED-LIFE
  1286        MOVE CP-LOAN-TERM   TO N-P-ORIG.
  1287
  1288     MOVE 'R'               TO N-P-OPT.
  1289
  1290     CALL 'ECSNETRM'
  1291          USING N-P-APR N-P-ORIG N-P-REM N-P-OPT N-P-CAP
  1292           N-P-FACTOR.
  1293
  1294*****PERFORM 10000-NET-TERM THRU 99999-EXIT.
  1295
  1296     COMPUTE STATE-UN-PREMIUM ROUNDED =
  1297                 N-P-FACTOR * CP-ORIGINAL-PREMIUM.
  1298
  1299     MOVE STATE-UN-PREMIUM      TO  DOMI-UN-PREMIUM.
  1300
  1301     IF CP-EARNING-METHOD EQUAL 'B'
  1302        NEXT SENTENCE
  1303     ELSE
  1304        MOVE '5'                TO  CP-EARNING-METHOD.
  1305
  1306 1180-EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  29
* ELUPRMXA.cbl (/apps/prod/cid1p/copy/ELCUPRMPA)
  1308*---------------------------------------------------------------
  1309 1200-DO-STATE-REGS.
  1310
  1311     IF CP-STATE-STD-ABBRV = 'AL'
  1312         MOVE R78-UN-PREMIUM       TO STATE-UN-PREMIUM
  1313         GO TO 1200-EXIT.
  1314
  1315     IF CP-STATE-STD-ABBRV = 'WY'
  1316         MOVE PR-UN-PREMIUM        TO STATE-UN-PREMIUM
  1317         GO TO 1200-EXIT.
  1318
  1319     IF CP-COMPANY-ID EQUAL 'NCL'
  1320        IF CP-EARN-AS-REG-BALLOON
  1321           IF CP-SPECIAL-CALC-CD EQUAL 'A'
  1322              COMPUTE STATE-UN-PREMIUM EQUAL STATE-UN-PREMIUM +
  1323                                 PR-UN-PREM-ALT
  1324              GO TO 1200-EXIT.
  1325
  1326     IF (CP-EARNING-METHOD = 'B' OR 'K' OR 'L')
  1327         COMPUTE STATE-UN-PREMIUM =
  1328            (R78-UN-PREMIUM  - R78-UN-PREM-ALT) + PR-UN-PREM-ALT
  1329         GO TO 1200-EXIT.
  1330
  1331     IF CP-EARN-AS-NET-PAY
  1332        AND CP-TRUNCATED-LIFE
  1333        AND CP-LOAN-TERM  LESS THAN CP-ORIGINAL-TERM
  1334         GO TO 1200-EXIT.
  1335
  1336     IF CP-EARN-AS-NET-PAY
  1337         IF CP-LOAN-APR NOT = ZEROS
  1338             GO TO 1200-EXIT.
  1339
  1340     IF CP-BENEFIT-TYPE  = 'L' OR 'P'
  1341         MOVE PR-UN-PREMIUM        TO STATE-UN-PREMIUM
  1342     ELSE
  1343         MOVE R78-UN-PREMIUM       TO STATE-UN-PREMIUM.
  1344
  1345 1200-EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  30
* ELUPRMXA.cbl (/apps/prod/cid1p/copy/ELCUPRMPA)
  1347
  1348*---------------------------------------------------------------
  1349 1300-DO-DOMICILE.
  1350
  1351     IF CP-DOMICILE-STATE = '  '  OR  '00'
  1352         GO TO 1300-EXIT.
  1353
  1354     IF CP-DOMICILE-STATE = 'AL'
  1355         MOVE R78-UN-PREMIUM      TO DOMI-UN-PREMIUM
  1356         GO TO 1300-EXIT.
  1357
  1358     IF CP-DOMICILE-STATE = 'WY'
  1359         MOVE PR-UN-PREMIUM       TO DOMI-UN-PREMIUM
  1360         GO TO 1300-EXIT.
  1361
  1362     IF (CP-EARNING-METHOD = 'B' OR 'K' OR 'L')
  1363        MOVE STATE-UN-PREMIUM   TO DOMI-UN-PREMIUM
  1364         GO TO 1300-EXIT.
  1365
  1366     IF CP-EARN-AS-NET-PAY
  1367        AND CP-TRUNCATED-LIFE
  1368        AND CP-LOAN-TERM  LESS THAN CP-ORIGINAL-TERM
  1369         GO TO 1300-EXIT.
  1370
  1371     IF CP-EARN-AS-NET-PAY
  1372         IF CP-LOAN-APR NOT = ZEROS
  1373             GO TO 1300-EXIT.
  1374
  1375     IF CP-BENEFIT-TYPE  = 'L' OR 'P'
  1376         MOVE PR-UN-PREMIUM       TO DOMI-UN-PREMIUM
  1377     ELSE
  1378         MOVE R78-UN-PREMIUM      TO DOMI-UN-PREMIUM.
  1379
  1380 1300-EXIT.
  1381
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  31
* ELUPRMXA.cbl (/apps/prod/cid1p/copy/ELCUPRMPA)
  1383******************** UNEARNED A&H  PREMIUM ***********************
  1384 1500-CALC-UNEARNED-AH SECTION.
  1385
  1386     PERFORM 1510-AH-PRORATA-UNEARNED THRU 1510-EXIT.
  1387
  1388     PERFORM 1550-AH-RULE78S-UNEARNED  THRU 1550-EXIT.
  1389
  1390     IF CP-COMPANY-ID = 'NCL'
  1391         IF DC-GREG-DATE-CYMD LESS THAN 19910101
  1392             MOVE ZEROS           TO CP-LOAN-APR
  1393             IF CP-EARN-AS-NET-PAY
  1394                 MOVE 'R'         TO CP-EARNING-METHOD.
  1395
  1396     IF CP-EARNING-METHOD EQUAL 'N'
  1397         PERFORM 1180-CALC-NET-PAY-UN THRU 1180-EXIT.
  1398
  1399     PERFORM 1600-DO-STATE-AH         THRU 1699-EXIT.
  1400
  1401     PERFORM 1700-DO-DOM-STATE-AH     THRU 1799-EXIT.
  1402
  1403     MOVE DOMI-UN-PREMIUM         TO CP-DOMICILE-U-PRM.
  1404     MOVE STATE-UN-PREMIUM        TO CP-STATE-U-PRM.
  1405     MOVE PR-UN-PREMIUM           TO CP-PRORATA-U-PRM.
  1406     MOVE ZEROS                   TO CP-PRORATA-U-PRM-ALT.
  1407     MOVE R78-UN-PREMIUM          TO CP-R78-U-PRM.
  1408     MOVE ZEROS                   TO CP-R78-U-PRM-ALT.
  1409
  1410
  1411 1500-CALC-UNEARNED-X.
  1412     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  32
* ELUPRMXA.cbl (/apps/prod/cid1p/copy/ELCUPRMPA)
  1414*********************************************
  1415*                                           *
  1416* PERFORMED: A&H  UNEARNED PREMIUM ROUTINES *
  1417*                                           *
  1418*********************************************
  1419
  1420 1510-AH-PRORATA-UNEARNED.
  1421
  1422     IF CP-COMPANY-ID EQUAL 'FLI' OR 'FLU' OR 'MIC' OR 'MCC'
  1423         COMPUTE PR-FACTOR ROUNDED =
  1424                   (CP-REMAINING-TERM - .5) / CP-ORIGINAL-TERM
  1425     ELSE
  1426         COMPUTE PR-FACTOR ROUNDED =
  1427                       CP-REMAINING-TERM / CP-ORIGINAL-TERM.
  1428
  1429     COMPUTE PR-UN-PREMIUM ROUNDED =
  1430                     CP-ORIGINAL-PREMIUM * PR-FACTOR.
  1431
  1432 1510-EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  33
* ELUPRMXA.cbl (/apps/prod/cid1p/copy/ELCUPRMPA)
  1434 1550-AH-RULE78S-UNEARNED.
  1435
  1436     COMPUTE R78-TEMP-1 =
  1437                CP-REMAINING-TERM * (CP-REMAINING-TERM + +1).
  1438
  1439     IF CP-R78-OPTION = '1'
  1440         COMPUTE R78-TEMP-1 =
  1441                  CP-REMAINING-TERM * CP-REMAINING-TERM.
  1442
  1443     IF CP-COMPANY-ID = 'FLI'
  1444         COMPUTE R78-TEMP-1 =
  1445                  CP-REMAINING-TERM * CP-REMAINING-TERM.
  1446
  1447     IF CP-COMPANY-ID = 'MPP'
  1448         COMPUTE R78-TEMP-1 =
  1449                 (CP-ORIGINAL-TERM - CP-REMAINING-TERM)
  1450                 * ((CP-ORIGINAL-TERM - CP-REMAINING-TERM) + +1).
  1451
  1452     COMPUTE R78-TEMP-2 =
  1453                  CP-ORIGINAL-TERM * (CP-ORIGINAL-TERM + +1).
  1454
  1455     COMPUTE R78-FACTOR ROUNDED = R78-TEMP-1 / R78-TEMP-2.
  1456
  1457     COMPUTE R78-UN-PREMIUM ROUNDED =
  1458                     CP-ORIGINAL-PREMIUM * R78-FACTOR.
  1459
  1460
  1461 1550-EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  34
* ELUPRMXA.cbl (/apps/prod/cid1p/copy/ELCUPRMPA)
  1463
  1464 1600-DO-STATE-AH.
  1465
  1466     IF CP-COMPANY-ID = 'CID'
  1467        SET TABLE-INDEX TO +1
  1468
  1469        SEARCH MR-TABLE VARYING TABLE-INDEX
  1470              AT END
  1471         MOVE 'P'                TO WS-CP-METHOD
  1472                                    WS-AH-METHOD
  1473              WHEN
  1474         T-STATE (TABLE-INDEX) = CP-STATE-STD-ABBRV
  1475             MOVE CP-METHOD-CODE (TABLE-INDEX) TO WS-CP-METHOD
  1476             MOVE AH-METHOD-CODE (TABLE-INDEX) TO WS-AH-METHOD
  1477        END-SEARCH
  1478
  1479*       IF CP-CRITICAL-PERIOD
  1480*          IF WS-CP-METHOD = 'P'
  1481*             MOVE PR-UN-PREMIUM TO STATE-UN-PREMIUM
  1482*          ELSE
  1483*             IF WS-CP-METHOD = 'R'
  1484*                MOVE R78-UN-PREMIUM
  1485*                                TO STATE-UN-PREMIUM
  1486*             ELSE
  1487*                GO TO 1680-DO-AHMEAN
  1488*             END-IF
  1489*          END-IF
  1490*       END-IF
  1491
  1492*       IF CP-CRITICAL-PERIOD
  1493*          IF (CP-STATE-STD-ABBRV = 'FL' OR 'MO')
  1494*             AND (DC-GREG-DATE-CYMD > 20030630)
  1495*             MOVE PR-UN-PREMIUM TO STATE-UN-PREMIUM
  1496*          END-IF
  1497*          GO TO 1699-EXIT
  1498*       END-IF
  1499
  1500        IF WS-AH-METHOD = 'P'
  1501           MOVE PR-UN-PREMIUM    TO STATE-UN-PREMIUM
  1502        ELSE
  1503           IF WS-AH-METHOD = 'R'
  1504              MOVE R78-UN-PREMIUM
  1505                                 TO STATE-UN-PREMIUM
  1506           ELSE
  1507              IF WS-AH-METHOD = 'M'
  1508                 GO TO 1680-DO-AHMEAN
  1509              END-IF
  1510           END-IF
  1511        END-IF
  1512
  1513        IF (CP-STATE-STD-ABBRV = 'VA')
  1514           AND (DC-GREG-DATE-CYMD > 20020630)
  1515           GO TO 1680-DO-AHMEAN
  1516        END-IF
  1517
  1518        IF (CP-STATE-STD-ABBRV = 'CO')
  1519           AND (DC-GREG-DATE-CYMD > 19961231)
  1520           GO TO 1680-DO-AHMEAN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  35
* ELUPRMXA.cbl (/apps/prod/cid1p/copy/ELCUPRMPA)
  1521        END-IF
  1522
  1523        GO TO 1699-EXIT
  1524     END-IF
  1525
  1526     IF CP-STATE-STD-ABBRV = 'VA'
  1527        DISPLAY ' I MADE IT HERE WITH VA  ' WS-AH-METHOD
  1528     END-IF
  1529
  1530     IF (CP-COMPANY-ID = 'CSO'  OR  'CID')  AND
  1531         CP-STATE-STD-ABBRV = 'CO'
  1532         IF DC-GREG-DATE-CYMD < 19970101
  1533             MOVE R78-UN-PREMIUM  TO STATE-UN-PREMIUM
  1534             GO TO 1699-EXIT
  1535         ELSE
  1536*            COMPUTE STATE-UN-PREMIUM =
  1537             COMPUTE STATE-UN-PREMIUM ROUNDED =
  1538                 (PR-UN-PREMIUM + R78-UN-PREMIUM ) / +2
  1539             GO TO 1699-EXIT.
  1540
  1541     IF (CP-STATE-STD-ABBRV = 'VA')
  1542        AND (DC-GREG-DATE-CYMD > 20020630)
  1543        GO TO 1680-DO-AHMEAN
  1544     END-IF
  1545
  1546     IF (CP-STATE-STD-ABBRV = 'NM')
  1547        AND (DC-GREG-DATE-CYMD > 19980831)
  1548        GO TO 1680-DO-AHMEAN
  1549     END-IF
  1550
  1551     IF CP-STATE-STD-ABBRV = 'GA'
  1552        GO TO 1680-DO-AHMEAN
  1553     END-IF
  1554
  1555     IF CP-STATE-STD-ABBRV = 'IN'
  1556        IF DC-GREG-DATE-CYMD > 20021231
  1557           MOVE PR-UN-PREMIUM    TO STATE-UN-PREMIUM
  1558        ELSE
  1559           MOVE R78-UN-PREMIUM   TO STATE-UN-PREMIUM
  1560        END-IF
  1561        GO TO 1699-EXIT
  1562     END-IF
  1563
  1564     IF CP-STATE-STD-ABBRV  = 'OH'
  1565         GO TO 1650-DO-OHIO.
  1566
  1567     IF CP-STATE-STD-ABBRV  = 'OK'
  1568         GO TO 1660-DO-OKLAHOMA.
  1569
  1570     IF CP-STATE-STD-ABBRV  = 'TX'
  1571         GO TO 1670-DO-TEXAS.
  1572
  1573     IF CP-COMPANY-ID EQUAL 'CSL'
  1574        IF CP-CARRIER EQUAL '2'
  1575           GO TO 1680-DO-AHMEAN.
  1576
  1577     IF CP-COMPANY-ID EQUAL 'GIC'
  1578       IF (CP-EARNING-METHOD NOT = 'B' AND 'K' AND 'L')
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  36
* ELUPRMXA.cbl (/apps/prod/cid1p/copy/ELCUPRMPA)
  1579         COMPUTE STATE-UN-PREMIUM =
  1580            (PR-UN-PREMIUM * .80) + (R78-UN-PREMIUM  * .20)
  1581         GO TO 1699-EXIT.
  1582
  1583     IF CP-EARN-AS-NET-PAY
  1584         IF CP-LOAN-APR NOT = ZEROS
  1585             GO TO 1699-EXIT.
  1586
  1587 1600-CONTINUE.
  1588
  1589     MOVE R78-UN-PREMIUM           TO STATE-UN-PREMIUM.
  1590     MOVE +0                       TO SRL.
  1591
  1592 1610-TABLE-LOOKUP.
  1593     ADD +1                        TO SRL.
  1594
  1595     IF AH-RES-STATE-ENT (SRL) = HIGH-VALUES
  1596         GO TO 1699-EXIT.
  1597
  1598     IF CP-STATE-STD-ABBRV  = AH-RES-STATE-ENT (SRL)
  1599         MOVE PR-UN-PREMIUM        TO STATE-UN-PREMIUM
  1600         GO TO 1699-EXIT.
  1601
  1602     GO TO 1610-TABLE-LOOKUP.
  1603
  1604 1650-DO-OHIO.
  1605
  1606     IF DC-GREG-DATE-CYMD LESS THAN 19831101
  1607         MOVE PR-UN-PREMIUM        TO STATE-UN-PREMIUM
  1608     ELSE
  1609         COMPUTE STATE-UN-PREMIUM =
  1610             (PR-UN-PREMIUM + R78-UN-PREMIUM ) / +2.
  1611
  1612     GO TO 1699-EXIT.
  1613
  1614 1660-DO-OKLAHOMA.
  1615     IF DC-GREG-DATE-CYMD LESS THAN 19820630
  1616         MOVE R78-UN-PREMIUM        TO STATE-UN-PREMIUM
  1617     ELSE
  1618         COMPUTE STATE-UN-PREMIUM =
  1619             (PR-UN-PREMIUM + R78-UN-PREMIUM ) / +2.
  1620
  1621     GO TO 1699-EXIT.
  1622
  1623 1670-DO-TEXAS.
  1624
  1625     IF CP-COMPANY-ID  = 'ABL' AND CP-CARRIER NOT EQUAL '2'
  1626         COMPUTE STATE-UN-PREMIUM =
  1627             (PR-UN-PREMIUM + R78-UN-PREMIUM ) / +2
  1628         GO TO 1699-EXIT.
  1629
  1630     IF DC-GREG-DATE-CYMD LESS THAN 19830901
  1631         MOVE R78-UN-PREMIUM        TO STATE-UN-PREMIUM
  1632     ELSE
  1633         COMPUTE STATE-UN-PREMIUM =
  1634             (PR-UN-PREMIUM + R78-UN-PREMIUM ) / +2.
  1635
  1636     GO TO 1699-EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  37
* ELUPRMXA.cbl (/apps/prod/cid1p/copy/ELCUPRMPA)
  1637
  1638 1680-DO-AHMEAN.
  1639
  1640     COMPUTE STATE-UN-PREMIUM EQUAL
  1641             (PR-UN-PREMIUM + R78-UN-PREMIUM) / +2.
  1642
  1643 1699-EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  38
* ELUPRMXA.cbl (/apps/prod/cid1p/copy/ELCUPRMPA)
  1645
  1646 1700-DO-DOM-STATE-AH.
  1647
  1648     IF CP-DOMICILE-STATE = '  '  OR  '00'
  1649         GO TO 1799-EXIT.
  1650
  1651     IF (CP-COMPANY-ID = 'CSO'  OR  'CID')  AND
  1652         CP-DOMICILE-STATE = 'CO'
  1653         IF DC-GREG-DATE-CYMD LESS THAN 19970101
  1654             MOVE R78-UN-PREMIUM  TO DOMI-UN-PREMIUM
  1655             GO TO 1799-EXIT
  1656         ELSE
  1657*            COMPUTE DOMI-UN-PREMIUM =
  1658             COMPUTE DOMI-UN-PREMIUM ROUNDED =
  1659                 (PR-UN-PREMIUM + R78-UN-PREMIUM ) / +2
  1660             GO TO 1799-EXIT.
  1661
  1662     IF (CP-STATE-STD-ABBRV = 'VA') AND
  1663        (DC-GREG-DATE-CYMD GREATER THAN 19921231) AND
  1664        (CP-ORIGINAL-TERM LESS THAN 62)
  1665          MOVE 'R'               TO  CP-EARNING-METHOD
  1666          GO TO 1700-CONTINUE.
  1667
  1668     IF CP-DOMICILE-STATE = 'OH'
  1669         GO TO 1750-DO-DOM-OHIO.
  1670
  1671     IF CP-DOMICILE-STATE = 'OK'
  1672         GO TO 1760-DO-DOM-OKLAHOMA.
  1673
  1674     IF CP-DOMICILE-STATE = 'TX'
  1675         GO TO 1770-DO-DOM-TEXAS.
  1676
  1677     IF CP-EARN-AS-NET-PAY
  1678         IF CP-LOAN-APR NOT = ZEROS
  1679             GO TO 1799-EXIT.
  1680
  1681 1700-CONTINUE.
  1682
  1683     MOVE R78-UN-PREMIUM        TO DOMI-UN-PREMIUM.
  1684     MOVE +0                    TO SRL.
  1685
  1686 1710-TABLE-LOOKUP.
  1687     ADD +1                     TO SRL.
  1688
  1689     IF AH-RES-STATE-ENT (SRL) = HIGH-VALUES
  1690         GO TO 1799-EXIT.
  1691
  1692     IF CP-DOMICILE-STATE = AH-RES-STATE-ENT (SRL)
  1693         MOVE PR-UN-PREMIUM      TO DOMI-UN-PREMIUM
  1694         GO TO 1799-EXIT.
  1695
  1696     GO TO 1710-TABLE-LOOKUP.
  1697
  1698 1750-DO-DOM-OHIO.
  1699     IF DC-GREG-DATE-CYMD LESS THAN 19831101
  1700         MOVE PR-UN-PREMIUM      TO DOMI-UN-PREMIUM
  1701     ELSE
  1702         COMPUTE DOMI-UN-PREMIUM =
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  39
* ELUPRMXA.cbl (/apps/prod/cid1p/copy/ELCUPRMPA)
  1703             (PR-UN-PREMIUM + R78-UN-PREMIUM ) / +2.
  1704
  1705     GO TO 1799-EXIT.
  1706
  1707 1760-DO-DOM-OKLAHOMA.
  1708
  1709     IF DC-GREG-DATE-CYMD LESS THAN 19820630
  1710         MOVE R78-UN-PREMIUM    TO DOMI-UN-PREMIUM
  1711     ELSE
  1712         COMPUTE DOMI-UN-PREMIUM =
  1713             (PR-UN-PREMIUM + R78-UN-PREMIUM ) / +2.
  1714
  1715     GO TO 1799-EXIT.
  1716
  1717 1770-DO-DOM-TEXAS.
  1718
  1719     IF DC-GREG-DATE-CYMD LESS THAN 19830901
  1720         MOVE R78-UN-PREMIUM    TO DOMI-UN-PREMIUM
  1721     ELSE
  1722         COMPUTE DOMI-UN-PREMIUM =
  1723             (PR-UN-PREMIUM + R78-UN-PREMIUM ) / +2.
  1724
  1725 1799-EXIT.
  1726
  1727
  1728 1999-EXIT-CALC-ROUTINE.
  1729
  1730     GOBACK.
  1731
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  40
* ELUPRMXA.cbl
  1733 2500-GET-RATE.
  1734     CALL 'ELRATEX' USING CALCULATION-PASS-AREA.
  1735
  1736 2500-EXIT.
  1737     EXIT.
  1738
  1739 9100-CONVERT-DATE.
  1740     CALL 'ELDATCX' USING DATE-CONVERSION-DATA.
  1741
  1742 9100-EXIT.
  1743      EXIT.
  1744
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  41
* ELUPRMXA.cbl
  1746*10000-NET-TERM SECTION.
  1747*                            COPY ERCNETP.
  1748
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:        1320     Code:        4588
