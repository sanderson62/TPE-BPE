* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   1
* FNB205.cbl
* Options: int("FNB205.int") anim csi verbose NOBOUND PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("FNB205.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"ebmlsfile" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" NOCHECKDIV NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"32" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"FNB205.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"FNB205.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR NOSTICKY-LINKAGE
*          NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"2" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2 PROGRAM-ID.    FNB205.
     3
     4*:::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
     5*    DATE    BY  MODIFICATION                                            :
     6* ========== === ========================================================:
     7* 02/15/1999 DAN TO PRODUCTION                                           :
     8* 03/19/2003 DJN CONVERT FROM MAINFRAME TO MICROFOCUS COBOL.             :
     9* 07/28/2006 DJN DO NOT ADVANCE TO NEW PAGE ON FIRST PAGE OF REPORTS.    :
    10* 08/25/2006 AJR REMOVE FROM CLAIMS SYSTEM.                              :
    11*:::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
    12
    13 ENVIRONMENT DIVISION.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   2
* FNB205.cbl
    14 INPUT-OUTPUT SECTION.
    15 FILE-CONTROL.
    16
    17     SELECT REPORT-FILES
    18         ASSIGN TO EXTERNAL SYS010
    19         ORGANIZATION IS LINE SEQUENTIAL
    20         FILE STATUS IS SYS010-STATUS.
    21
    22     SELECT SUMMARY-REPORT
    23         ASSIGN TO EXTERNAL SYS007
    24         ORGANIZATION IS LINE SEQUENTIAL.
    25
    26**** PARM FILE
    27     SELECT PARM-FILE        ASSIGN       TO EXTERNAL IPARM
    28                             ORGANIZATION IS LINE SEQUENTIAL
    29                             FILE STATUS  IS PARM-STATUS.
    30
    31
    32 DATA DIVISION.
    33 FILE SECTION.
    34
    35 FD  REPORT-FILES
    36     LABEL RECORDS ARE STANDARD
    37     RECORDING MODE IS F
    38     RECORD CONTAINS 133 CHARACTERS
    39     BLOCK CONTAINS 0 RECORDS.
    40
    41 01  REPORT-RECORD       PIC X(133).
    42
    43 FD  SUMMARY-REPORT
    44     LABEL RECORDS ARE STANDARD
    45     RECORDING MODE IS F
    46     RECORD CONTAINS 132 CHARACTERS
    47     BLOCK CONTAINS 0 RECORDS.
    48
    49 01  SUMMARY-RECORD      PIC X(132).
    50
    51**** PARM FILE
    52 FD  PARM-FILE
    53     LABEL RECORDS ARE STANDARD
    54     RECORDING MODE IS F
    55     BLOCK CONTAINS 0 RECORDS.
    56 01  PARM.
    57     05  PARM-CYCLE-DATE PIC X(10) VALUE SPACES.
    58
    59
    60 WORKING-STORAGE SECTION.
    61
    62 01 RC                       PIC S9(9)   COMP-5 VALUE 0.
    63 01 LIST-REC                 PIC X(132).
    64
    65 01  FILLER USAGE IS PACKED-DECIMAL.
    66     05  PAGE-COUNT          PIC S9(3)     VALUE +0.
    67     05  LINE-COUNT          PIC S9(3)     VALUE +0.
    68
    69 01  FILLER.
    70     05  SYS010-STATUS       PIC XX     VALUE '00'.
    71         88  EOF                        VALUE '10'.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   3
* FNB205.cbl
    72     05  PARM-STATUS         PIC XX     VALUE SPACES.
    73     05  WS-SYS-DATE         PIC 9(8)   VALUE ZERO.
    74     05  WS-ZERO             PIC X(15)  VALUE '            .00'.
    75     05  WS-TEMP             PIC X(25).
    76     05  SAVE-TABLE OCCURS 300 TIMES INDEXED BY SAVE-INDEX, I, J.
    77         10  SAVE-ACCT  PIC X(10)    VALUE HIGH-VALUES.
    78         10  SAVE-AMT   PIC X(15)    VALUE SPACE.
    79
    80 01  FILLER.
    81     05  WS-CYCLE-DATE       PIC X(10)     VALUE SPACES.
    82
    83 01  WORK-DATE.
    84     05  WRK-YR    PIC 9999.
    85     05  WRK-MO    PIC 99.
    86     05  WRK-DAY   PIC 99.
    87
    88 01  SYSTEM-DATE.
    89     05  SYS-MO    PIC 99.
    90     05  SYS-DAY   PIC 99.
    91     05  SYS-YR    PIC 9999.
    92
    93 01  HEADING-LINE-1.
    94     05  FILLER     PIC X(6)  VALUE 'DATE: '.
    95     05  HDG-DATE1  PIC X(10) VALUE SPACE.
    96     05  FILLER     PIC X(20) VALUE SPACES.
    97     05  FILLER     PIC X(7)  VALUE 'AS OF: '.
    98     05  HDG-DATE2  PIC XX/XX/XXXX  VALUE SPACE.
    99
   100 01  HEADING-LINE-2.
   101     05  PIC X(41)
   102         VALUE 'SUSPENSE ACCOUNT SUMMARY BALANCING REPORT'.
   103 01  HEADING-LINE-3.
   104     05  PIC X(32) VALUE 'DISTRIBUTION: CORPORATE FINANCE '.
   105 01  HEADING-LINE-4.
   106     05  PIC X(36)
   107         VALUE 'ACCOUNT NUMBER               BALANCE'.
   108 01  HEADING-LINE-5.
   109     05  PIC X(36)
   110         VALUE '**************       ***************'.
   111
   112 01  DETAIL-LINE.
   113     05  DET-ACCT  PIC X(10)  VALUE SPACE.
   114     05  FILLER    PIC X(11)  VALUE SPACE.
   115     05  DET-AMT   PIC X(15)  VALUE SPACE.
   116
   117*    EXEC SQL INCLUDE ISTDWORK.INC END-EXEC.
   118
   119 PROCEDURE DIVISION.
   120
   121     PERFORM 000-HOUSEKEEPING
   122
   123     PERFORM UNTIL EOF
   124       READ REPORT-FILES
   125       IF NOT EOF
   126         IF REPORT-RECORD(25:16) = 'FREEDOM ACCOUNT:'
   127           PERFORM 100-SAVE-ACCOUNT
   128         END-IF
   129         IF REPORT-RECORD(04:25) = 'REPORT TRANSACTION TOTAL:'
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   4
* FNB205.cbl
   130           MOVE REPORT-RECORD(30:15) TO SAVE-AMT (SAVE-INDEX)
   131         END-IF
   132       END-IF
   133     END-PERFORM
   134
   135     PERFORM 200-PRINT-SUMMARY
   136
   137     CLOSE  REPORT-FILES
   138            SUMMARY-REPORT.
   139     CALL 'FNBLIST' USING 'C' LIST-REC.
   140     CLOSE  PARM-FILE.
   141
   142*    GOBACK GIVING RC.
   143     STOP RUN GIVING RC.
   144
   145 100-SAVE-ACCOUNT.
   146
   147     SET SAVE-INDEX TO +1
   148     SEARCH SAVE-TABLE
   149       AT END
   150         DISPLAY 'TABLE OVERFLOW IN ROUTINE 100-SAVE-ACCOUNT'
   151                 UPON SYSERR
   152         MOVE    'TABLE OVERFLOW IN ROUTINE 100-SAVE-ACCOUNT'
   153                 TO LIST-REC
   154         CALL 'FNBLIST' USING 'W' LIST-REC
   155         MOVE 16 TO RC
   156         GOBACK GIVING RC
   157       WHEN SAVE-ACCT (SAVE-INDEX) = REPORT-RECORD(42:10)
   158         CONTINUE
   159       WHEN SAVE-ACCT (SAVE-INDEX) = HIGH-VALUES
   160         MOVE REPORT-RECORD(42:10) TO SAVE-ACCT (SAVE-INDEX)
   161     END-SEARCH.
   162
   163 200-PRINT-SUMMARY.
   164
   165     PERFORM 800-SORT-TABLE
   166
   167     PERFORM 210-PRINT-HEADING
   168
   169     PERFORM VARYING SAVE-INDEX FROM 1 BY 1
   170              UNTIL SAVE-ACCT (SAVE-INDEX) = HIGH-VALUE
   171
   172       MOVE SAVE-ACCT (SAVE-INDEX) TO DET-ACCT
   173       IF SAVE-AMT (SAVE-INDEX) = SPACE
   174         MOVE WS-ZERO TO DET-AMT
   175       ELSE
   176         MOVE SAVE-AMT (SAVE-INDEX) TO DET-AMT
   177       END-IF
   178       WRITE SUMMARY-RECORD FROM DETAIL-LINE
   179             AFTER ADVANCING 1 LINE
   180       ADD +1 TO LINE-COUNT
   181       IF LINE-COUNT > +56
   182         PERFORM 210-PRINT-HEADING
   183       END-IF
   184
   185     END-PERFORM.
   186
   187 210-PRINT-HEADING.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   5
* FNB205.cbl
   188
   189     ADD 1 TO PAGE-COUNT
   190
   191     IF PAGE-COUNT = 1
   192       WRITE SUMMARY-RECORD FROM HEADING-LINE-1
   193           AFTER ADVANCING 0 LINES
   194     ELSE
   195       WRITE SUMMARY-RECORD FROM HEADING-LINE-1
   196           AFTER ADVANCING PAGE
   197     END-IF
   198     WRITE SUMMARY-RECORD FROM HEADING-LINE-2
   199           AFTER ADVANCING 1 LINE
   200     WRITE SUMMARY-RECORD FROM HEADING-LINE-3
   201           AFTER ADVANCING 2 LINES
   202     WRITE SUMMARY-RECORD FROM HEADING-LINE-4
   203           AFTER ADVANCING 3 LINES
   204     WRITE SUMMARY-RECORD FROM HEADING-LINE-5
   205           AFTER ADVANCING 1 LINE
   206     MOVE SPACES TO SUMMARY-RECORD
   207     WRITE SUMMARY-RECORD AFTER ADVANCING 1 LINE
   208     MOVE +9 TO LINE-COUNT.
   209
   210 000-HOUSEKEEPING.
   211
   212     CALL 'FNBLIST' USING 'O' LIST-REC
   213*    CALL IGETPARM USING IG-P1
   214*    MOVE IG-P1 TO WS-CYCLE-DATE
   215*
   216*    MOVE WS-CYCLE-DATE TO IV-P2
   217*    MOVE 'MM/DD/YEAR'  TO IV-P3
   218*    INITIALIZE            IV-P4
   219*    CALL IVERDATE USING IV-P1 IV-P2 IV-P3 IV-P4
   220*    IF IV-P1 = 'Y'
   221     OPEN INPUT PARM-FILE.
   222     IF PARM-STATUS NOT = '00'
   223       STRING  'ERROR OPENING PARM FILE, STATUS = '
   224              PARM-STATUS
   225         DELIMITED BY SIZE INTO LIST-REC
   226       CALL 'FNBLIST' USING 'W' LIST-REC
   227       CALL 'FNBLIST' USING 'C' LIST-REC
   228       MOVE 16 TO RC
   229       STOP RUN GIVING RC
   230     END-IF.
   231     READ PARM-FILE.
   232     IF PARM-CYCLE-DATE GREATER THAN SPACES
   233       MOVE PARM-CYCLE-DATE TO WS-CYCLE-DATE
   234       MOVE WS-CYCLE-DATE TO HDG-DATE1
   235     ELSE
   236       MOVE SPACES TO LIST-REC
   237       STRING '*** INVALID DATE CARD: ' WS-CYCLE-DATE
   238         DELIMITED BY SIZE INTO LIST-REC
   239       CALL 'FNBLIST' USING 'W' LIST-REC
   240       CALL 'FNBLIST' USING 'C' LIST-REC
   241       MOVE 16 TO RC
   242*      GOBACK GIVING RC
   243       STOP RUN GIVING RC
   244     END-IF
   245
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   6
* FNB205.cbl
   246     ACCEPT WORK-DATE FROM DATE YYYYMMDD
   247     MOVE WRK-YR  TO SYS-YR
   248     MOVE WRK-MO  TO SYS-MO
   249     MOVE WRK-DAY TO SYS-DAY
   250
   251     MOVE SYSTEM-DATE TO WS-SYS-DATE
   252*    CALL 'SYSDATE' USING WS-SYS-DATE
   253     MOVE WS-SYS-DATE TO HDG-DATE2
   254
   255     OPEN INPUT REPORT-FILES
   256     OPEN OUTPUT SUMMARY-REPORT.
   257
   258 800-SORT-TABLE.
   259*
   260* THIS ROUTINE SORTS THE TABLE INTO ACCOUNT NUMBER ORDER
   261* (I AND J ARE INDEXES FOR THE TABLE)
   262*
   263     PERFORM VARYING I FROM 1 BY 1
   264             UNTIL SAVE-ACCT (I) = HIGH-VALUE
   265       IF SAVE-ACCT (I) > SAVE-ACCT (I + 1)
   266         MOVE SAVE-TABLE (I) TO WS-TEMP
   267         MOVE SAVE-TABLE (I + 1) TO SAVE-TABLE (I)
   268         MOVE WS-TEMP TO SAVE-TABLE (I + 1)
   269         PERFORM VARYING J FROM I BY -1
   270           UNTIL J = 1 OR SAVE-ACCT (J) NOT < SAVE-ACCT(J - 1)
   271           MOVE SAVE-TABLE (J) TO WS-TEMP
   272           MOVE SAVE-TABLE (J - 1) TO SAVE-TABLE (J)
   273           MOVE WS-TEMP TO SAVE-TABLE (J - 1)
   274         END-PERFORM
   275       END-IF
   276     END-PERFORM.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:       10104     Code:        2048
