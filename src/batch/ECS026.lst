* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   1
* ECS026.cbl
* Options: int("ECS026.int") anim csi verbose NOBOUND PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("ECS026.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"ebmlsfile" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" NOCHECKDIV NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"32" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"ECS026.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"ECS026.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR NOSTICKY-LINKAGE
*          NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"2" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                ECS026.
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 05/13/94 09:27:38.
     7*             PROGRAM REVIEWED FOR YEAR 2000 COMPLIANCE
     8*                           VMOD=2.021.
     9
    10*AUTHOR.        LOGIC, INC.
    11*               DALLAS, TEXAS.
    12
    13*DATE-COMPILED.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   2
* ECS026.cbl
    14
    15*SECURITY.   *****************************************************
    16*            *                                                   *
    17*            *   THIS PROGRAM IS THE PROPERTY OF LOGIC, INC.     *
    18*            *                                                   *
    19*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
    20*            *   OF LOGIC, INC. IS EXPRESSLY PROHIBITED WITHOUT  *
    21*            *   THE PRIOR WRITTEN PERMISSION OF LOGIC, INC.     *
    22*            *                                                   *
    23*            *****************************************************
    24
    25
    26******************************************************************
    27*        THIS PROGRAM GENERATES THE EXPERIENCE ANALYSIS          *
    28*        REPORT.                                                 *
    29******************************************************************
    30*                   C H A N G E   L O G
    31*
    32* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    33*-----------------------------------------------------------------
    34*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    35* EFFECTIVE    NUMBER
    36*-----------------------------------------------------------------
    37* 102912  CR2012083000001  PEMA  ADD VALUE ZERO AND CHK FOR NUM
    38******************************************************************
    39 ENVIRONMENT DIVISION.
    40 INPUT-OUTPUT SECTION.
    41 FILE-CONTROL.
    42
    43     SELECT  SORT-WORK       ASSIGN TO SYS001-UT-2314-S-SORTWK1.
    44     SELECT  SORT-WORK-2     ASSIGN TO SYS001-UT-2314-S-SORTWK1.
    45     SELECT  PRINTER         ASSIGN TO SYS008-UR-1403-S-SYS008.
    46
    47     SELECT  ACCT-IN         ASSIGN TO SYS021-FBA1-ERACCTT
    48                             ORGANIZATION    INDEXED
    49                             ACCESS          SEQUENTIAL
    50                             RECORD KEY      AM-CONTROL-PRIMARY
    51                             FILE STATUS     ERACCT-FILE-STATUS.
    52
    53     SELECT  ERRTBL-IN       ASSIGN TO SYS021-FBA1-ERRTBLT
    54                             ORGANIZATION    INDEXED
    55                             ACCESS          DYNAMIC
    56                             RECORD KEY      RE-CONTROL-PRIMARY
    57                             FILE STATUS     ERRTBL-FILE-STATUS.
    58
    59     SELECT  CERT-IN         ASSIGN TO SYS011-UT-2400-S-SYS011.
    60     SELECT  DISK-DATE       ASSIGN TO SYS019-UT-2314-S-SYS019.
    61     SELECT  FICH            ASSIGN TO SYS020-UT-2400-S-SYS020.
    62     SELECT  REIN-WORK       ASSIGN TO SYS030-UT-FBA1-S-SYS030.
    63     SELECT  TEMP-WORK       ASSIGN TO SYS031-UT-FBA1-S-SYS031.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   3
* ECS026.cbl
    65 DATA DIVISION.
    66 FILE SECTION.
    67
    68 SD  SORT-WORK.
    69
    70 01  SORT-REC.
    71     12  SR-CONTROL          PIC X(20).
    72     12  FILLER              PIC X(1121).
    73
    74 01  SORT-REC-B.
    75     12  FILLER              PIC X(20).
    76     12  SR-CONTROL-B        PIC X(10).
    77     12  FILLER              PIC X(1111).
    78
    79 01  SORT-REC-C.
    80     12  FILLER              PIC X.
    81     12  SR-CONTROL-C1       PIC X(7).
    82     12  FILLER              PIC X(22).
    83     12  SR-CONTROL-C2       PIC X(10).
    84     12  FILLER              PIC X(1101).
    85
    86 SD  SORT-WORK-2.
    87
    88 01  SORT-REC-2.
    89     12  SR2-CONTROL         PIC X(4).
    90     12  FILLER              PIC X(120).
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   4
* ECS026.cbl
    92 FD  PRINTER
*   93                             COPY ELCPRTFD.
    94******************************************************************04/15/98
    95*                                                                *ELCPRTFD
    96*                                                                *ELCPRTFD
    97*                            ELCPRTFD.                           *   LV003
    98*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
    99*                            VMOD=2.006                          *ELCPRTFD
   100******************************************************************ELCPRTFD
   101     RECORDING MODE F                                             ELCPRTFD
   102     LABEL RECORDS OMITTED                                        ELCPRTFD
   103     BLOCK CONTAINS 0 RECORDS
   104     RECORD CONTAINS 133 CHARACTERS.                              ELCPRTFD
   105 01  PRT.                                                         ELCPRTFD
   106     12  P-CTL               PIC  X.                                 CL**2
   107     12  P-DATA              PIC  X(132).                         ELCPRTFD
   108******************************************************************ELCPRTFD
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   5
* ECS026.cbl
   110 FD  ACCT-IN.
*  111                             COPY ERCACCT.
   112******************************************************************04/19/98
   113*                                                                *ERCACCT
   114*                                                                *ERCACCT
   115*                            ERCACCT                             *   LV031
   116*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL*31
   117*                            VMOD=2.031                          *ERCACCT
   118*                                                                *ERCACCT
   119*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *ERCACCT
   120*                                                                *ERCACCT
   121*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *ERCACCT
   122*   VSAM ACCOUNT MASTER FILES.                                   *ERCACCT
   123*                                                                *ERCACCT
   124*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *ERCACCT
   125*                                                                *ERCACCT
   126*   FILE TYPE = VSAM,KSDS                                        *ERCACCT
   127*   RECORD SIZE = 2000  RECFORM = FIX                            *ERCACCT
   128*                                                                *ERCACCT
   129*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *ERCACCT
   130*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *ERCACCT
   131*                                                                *ERCACCT
   132*   LOG = NO                                                     *ERCACCT
   133*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *ERCACCT
   134*                                                                *ERCACCT
   135*                                                                *ERCACCT
   136******************************************************************ERCACCT
   137*                   C H A N G E   L O G
   138*
   139* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   140*-----------------------------------------------------------------
   141*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   142* EFFECTIVE    NUMBER
   143*-----------------------------------------------------------------
   144* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
   145* 092705    2005050300006  PEMA  ADD SPP LEASES
   146* 022808    2007083100002  PEMA  ADD FREEZE STATUS
   147* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
   148* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
   149* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
   150* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
   151******************************************************************
   152                                                                  ERCACCT
   153 01  ACCOUNT-MASTER.                                              ERCACCT
   154     12  AM-RECORD-ID                      PIC XX.                ERCACCT
   155         88  VALID-AM-ID                      VALUE 'AM'.         ERCACCT
   156                                                                  ERCACCT
   157     12  AM-CONTROL-PRIMARY.                                      ERCACCT
   158         16  AM-COMPANY-CD                 PIC X.                 ERCACCT
   159         16  AM-MSTR-CNTRL.                                       ERCACCT
   160             20  AM-CONTROL-A.                                    ERCACCT
   161                 24  AM-CARRIER            PIC X.                 ERCACCT
   162                 24  AM-GROUPING.                                 ERCACCT
   163                     28 AM-GROUPING-PREFIX PIC XXX.               ERCACCT
   164                     28 AM-GROUPING-PRIME  PIC XXX.               ERCACCT
   165                 24  AM-STATE              PIC XX.                ERCACCT
   166                 24  AM-ACCOUNT.                                  ERCACCT
   167                     28  AM-ACCOUNT-PREFIX PIC X(4).              ERCACCT
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   6
* ECS026.cbl (/apps/prod/cid1p/copy/ERCACCT)
   168                     28  AM-ACCOUNT-PRIME  PIC X(6).              ERCACCT
   169             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A            ERCACCT
   170                                           PIC X(19).             ERCACCT
   171             20  AM-CNTRL-B.                                      ERCACCT
   172                 24  AM-EXPIRATION-DT      PIC XX.                ERCACCT
   173                 24  FILLER                PIC X(4).              ERCACCT
   174             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.                 ERCACCT
   175                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.     ERCACCT
   176                                                                  ERCACCT
   177     12  AM-CONTROL-BY-VAR-GRP.                                   ERCACCT
   178         16  AM-COMPANY-CD-A1              PIC X.                 ERCACCT
   179         16  AM-VG-CARRIER                 PIC X.                 ERCACCT
   180         16  AM-VG-GROUPING                PIC X(6).              ERCACCT
   181         16  AM-VG-STATE                   PIC XX.                ERCACCT
   182         16  AM-VG-ACCOUNT                 PIC X(10).             ERCACCT
   183         16  AM-VG-DATE.                                          ERCACCT
   184             20  AM-VG-EXPIRATION-DT       PIC XX.                ERCACCT
   185             20  FILLER                    PIC X(4).              ERCACCT
   186         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE                  ERCACCT
   187                                           PIC 9(11)      COMP-3. ERCACCT
   188     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
   189         16  FILLER                        PIC X(10).
   190         16  AM-VG-KEY3.
   191             20  AM-VG3-ACCOUNT            PIC X(10).
   192             20  AM-VG3-EXP-DT             PIC XX.
   193         16  FILLER                        PIC X(4).
   194     12  AM-MAINT-INFORMATION.                                    ERCACCT
   195         16  AM-LAST-MAINT-DT              PIC XX.                ERCACCT
   196         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3. ERCACCT
   197         16  AM-LAST-MAINT-USER            PIC X(4).              ERCACCT
   198         16  FILLER                        PIC XX.                ERCACCT
   199                                                                  ERCACCT
   200     12  AM-EFFECTIVE-DT                   PIC XX.                ERCACCT
   201     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3. ERCACCT
   202                                                                  ERCACCT
   203     12  AM-PREV-DATES  COMP-3.                                   ERCACCT
   204         16  AM-PREV-EXP-DT                PIC 9(11).             ERCACCT
   205         16  AM-PREV-EFF-DT                PIC 9(11).             ERCACCT
   206                                                                  ERCACCT
   207     12  AM-REPORT-CODE-1                  PIC X(10).             ERCACCT
   208     12  AM-REPORT-CODE-2                  PIC X(10).             ERCACCT
   209                                                                  ERCACCT
   210     12  AM-CITY-CODE                      PIC X(4).              ERCACCT
   211     12  AM-COUNTY-PARISH                  PIC X(6).              ERCACCT
   212                                                                  ERCACCT
   213     12  AM-NAME                           PIC X(30).             ERCACCT
   214     12  AM-PERSON                         PIC X(30).             ERCACCT
   215     12  AM-ADDRS                          PIC X(30).             ERCACCT
   216     12  AM-CITY.
   217         16  AM-ADDR-CITY                  PIC X(28).
   218         16  AM-ADDR-STATE                 PIC XX.
   219     12  AM-ZIP.                                                  ERCACCT
   220         16  AM-ZIP-PRIME.                                        ERCACCT
   221             20  AM-ZIP-PRI-1ST            PIC X.                 ERCACCT
   222                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'. ERCACCT
   223             20  FILLER                    PIC X(4).              ERCACCT
   224         16  AM-ZIP-PLUS4                  PIC X(4).              ERCACCT
   225     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.              ERCACCT
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   7
* ECS026.cbl (/apps/prod/cid1p/copy/ERCACCT)
   226         16  AM-CAN-POSTAL-1               PIC XXX.               ERCACCT
   227         16  AM-CAN-POSTAL-2               PIC XXX.               ERCACCT
   228         16  FILLER                        PIC XXX.               ERCACCT
   229     12  AM-TEL-NO.                                               ERCACCT
   230         16  AM-AREA-CODE                  PIC 999.               ERCACCT
   231         16  AM-TEL-PRE                    PIC 999.               ERCACCT
   232         16  AM-TEL-NBR                    PIC 9(4).              ERCACCT
   233     12  AM-TEL-LOC                        PIC X.                 ERCACCT
   234         88  AM-TEL-AT-HOME                   VALUE 'H'.          ERCACCT
   235         88  AM-TEL-AT-BUSINESS               VALUE 'B'.          ERCACCT
   236                                                                  ERCACCT
   237     12  AM-COMM-STRUCTURE.                                       ERCACCT
   238         16  AM-DEFN-1.                                           ERCACCT
   239             20  AM-AGT-COMMS       OCCURS 10 TIMES.              ERCACCT
   240                 24  AM-AGT.                                      ERCACCT
   241                     28  AM-AGT-PREFIX     PIC X(4).              ERCACCT
   242                     28  AM-AGT-PRIME      PIC X(6).              ERCACCT
   243                 24  AM-COM-TYP            PIC X.                 ERCACCT
   244                 24  AM-L-COM              PIC SV9(5)     COMP-3. ERCACCT
   245                 24  AM-J-COM              PIC SV9(5)     COMP-3. ERCACCT
   246                 24  AM-A-COM              PIC SV9(5)     COMP-3. ERCACCT
   247                 24  AM-RECALC-LV-INDIC    PIC X.                 ERCACCT
   248                 24  AM-RETRO-LV-INDIC     PIC X.                 ERCACCT
   249                 24  AM-GL-CODES           PIC X.                 ERCACCT
   250                 24  AM-COMM-CHARGEBACK    PIC 9(02).             ERCACCT
   251                 24  FILLER                PIC X(01).             ERCACCT
   252         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.                   ERCACCT
   253             20  AM-COM-TBLS        OCCURS 10 TIMES.              ERCACCT
   254                 24  FILLER                PIC X(11).             ERCACCT
   255                 24  AM-L-COMA             PIC XXX.               ERCACCT
   256                 24  AM-J-COMA             PIC XXX.               ERCACCT
   257                 24  AM-A-COMA             PIC XXX.               ERCACCT
   258                 24  FILLER                PIC X(6).              ERCACCT
   259                                                                  ERCACCT
   260     12  AM-COMM-CHANGE-STATUS             PIC X.                 ERCACCT
   261         88  AM-COMMISSIONS-CHANGED           VALUE '*'.          ERCACCT
   262                                                                  ERCACCT
   263     12  AM-CSR-CODE                       PIC X(4).              ERCACCT
   264                                                                  ERCACCT
   265     12  AM-BILLING-STATUS                 PIC X.                 ERCACCT
   266         88  AM-ACCOUNT-BILLED                VALUE 'B'.          ERCACCT
   267         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.          ERCACCT
   268     12  AM-AUTO-REFUND-SW                 PIC X.                 ERCACCT
   269         88  AUTO-REFUNDS-USED                VALUE 'Y'.          ERCACCT
   270         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.      ERCACCT
   271     12  AM-GPCD                           PIC 99.                ERCACCT
   272     12  AM-IG                             PIC X.                 ERCACCT
   273         88  AM-HAS-INDIVIDUAL                VALUE '1'.          ERCACCT
   274         88  AM-HAS-GROUP                     VALUE '2'.          ERCACCT
   275     12  AM-STATUS                         PIC X.                 ERCACCT
   276         88  AM-ACCOUNT-ACTIVE                VALUE '0'.          ERCACCT
   277         88  AM-ACCOUNT-INACTIVE              VALUE '1'.          ERCACCT
   278         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.          ERCACCT
   279         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
   280         88  AM-ACCOUNT-FROZEN                VALUE '4'.
   281         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
   282     12  AM-REMIT-TO                       PIC 99.                ERCACCT
   283     12  AM-ID-NO                          PIC X(11).             ERCACCT
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   8
* ECS026.cbl (/apps/prod/cid1p/copy/ERCACCT)
   284                                                                  ERCACCT
   285     12  AM-CAL-TABLE                      PIC XX.                ERCACCT
   286     12  AM-LF-DEVIATION                   PIC XXX.               ERCACCT
   287     12  AM-AH-DEVIATION                   PIC XXX.               ERCACCT
   288     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3. ERCACCT
   289     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3. ERCACCT
   290     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3. ERCACCT
   291     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3. ERCACCT
   292     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3. ERCACCT
   293     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3. ERCACCT
   294                                                                  ERCACCT
   295     12  AM-USER-FIELDS.                                          ERCACCT
   296         16  AM-FLD-1                      PIC XX.                ERCACCT
   297         16  AM-FLD-2                      PIC XX.                ERCACCT
   298         16  AM-FLD-3                      PIC XX.                ERCACCT
   299         16  AM-FLD-4                      PIC XX.                ERCACCT
   300         16  AM-FLD-5                      PIC XX.                ERCACCT
   301                                                                  ERCACCT
   302     12  AM-1ST-PROD-DATE.                                        ERCACCT
   303         16  AM-1ST-PROD-YR                PIC XX.                ERCACCT
   304         16  AM-1ST-PROD-MO                PIC XX.                ERCACCT
   305         16  AM-1ST-PROD-DA                PIC XX.                ERCACCT
   306     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.     ERCACCT
   307     12  AM-CERTS-PURGED-DATE.                                    ERCACCT
   308         16  AM-PUR-YR                     PIC XX.                ERCACCT
   309         16  AM-PUR-MO                     PIC XX.                ERCACCT
   310         16  AM-PUR-DA                     PIC XX.                ERCACCT
   311     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.     ERCACCT
   312     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.     ERCACCT
   313     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.     ERCACCT
   314     12  AM-INACTIVE-DATE.                                        ERCACCT
   315         16  AM-INA-MO                     PIC 99.                ERCACCT
   316         16  AM-INA-DA                     PIC 99.                ERCACCT
   317         16  AM-INA-YR                     PIC 99.                ERCACCT
   318     12  AM-AR-HI-CERT-DATE                PIC XX.                ERCACCT
   319                                                                  ERCACCT
   320     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3. ERCACCT
   321     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3. ERCACCT
   322                                                                  ERCACCT
   323     12  AM-OB-PAYMENT-MODE                PIC X.                 ERCACCT
   324         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.      ERCACCT
   325         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.          ERCACCT
   326         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.          ERCACCT
   327         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.          ERCACCT
   328                                                                  ERCACCT
   329     12  AM-AH-ONLY-INDICATOR              PIC X.                 ERCACCT
   330         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.      ERCACCT
   331         88  AM-NO-AH-ONLY                    VALUE 'N'.          ERCACCT
   332                                                                  ERCACCT
   333     12  AM-EDIT-LOAN-OFC                  PIC X(01).             ERCACCT
   334                                                                  ERCACCT
   335     12  AM-OVER-SHORT.                                           ERCACCT
   336         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3. ERCACCT
   337         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3. ERCACCT
   338                                                                  ERCACCT
   339     12  AM-DCC-PRODUCT-CODE               PIC XXX.
   340     12  AM-DCC-CLP-STATE                  PIC XX.
   341                                                                  ERCACCT
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   9
* ECS026.cbl (/apps/prod/cid1p/copy/ERCACCT)
   342     12  AM-RECALC-COMM                    PIC X.                 ERCACCT
   343     12  AM-RECALC-REIN                    PIC X.                 ERCACCT
   344                                                                  ERCACCT
   345     12  AM-REI-TABLE                      PIC XXX.               ERCACCT
   346     12  AM-REI-ET-LF                      PIC X.                 ERCACCT
   347     12  AM-REI-ET-AH                      PIC X.                 ERCACCT
   348     12  AM-REI-PE-LF                      PIC X.                 ERCACCT
   349     12  AM-REI-PE-AH                      PIC X.                 ERCACCT
   350     12  AM-REI-PRT-ST                     PIC X.                 ERCACCT
   351     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3. ERCACCT
   352     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3. ERCACCT
   353     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3. ERCACCT
   354     12  AM-REI-GROUP-A                    PIC X(6).              ERCACCT
   355     12  AM-REI-MORT                       PIC X(4).              ERCACCT
   356     12  AM-REI-PRT-OW                     PIC X.                 ERCACCT
   357     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3. ERCACCT
   358     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3. ERCACCT
   359     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3. ERCACCT
   360     12  AM-REI-GROUP-B                    PIC X(6).              ERCACCT
   361                                                                  ERCACCT
   362     12  AM-TRUST-TYPE                     PIC X(2).              ERCACCT
   363                                                                  ERCACCT
   364     12  AM-EMPLOYER-STMT-USED             PIC X.                 ERCACCT
   365     12  AM-GROUPED-CHECKS-Y-N             PIC X.                 ERCACCT
   366                                                                  ERCACCT
   367     12  AM-STD-AH-TYPE                    PIC XX.                ERCACCT
   368     12  AM-EARN-METHODS.                                         ERCACCT
   369         16  AM-EARN-METHOD-R              PIC X.                 ERCACCT
   370             88 AM-REF-RL-R78                 VALUE 'R'.          ERCACCT
   371             88 AM-REF-RL-PR                  VALUE 'P'.          ERCACCT
   372             88 AM-REF-RL-MEAN                VALUE 'M'.          ERCACCT
   373             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.          ERCACCT
   374         16  AM-EARN-METHOD-L              PIC X.                 ERCACCT
   375             88 AM-REF-LL-R78                 VALUE 'R'.          ERCACCT
   376             88 AM-REF-LL-PR                  VALUE 'P'.          ERCACCT
   377             88 AM-REF-LL-MEAN                VALUE 'M'.          ERCACCT
   378             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.          ERCACCT
   379         16  AM-EARN-METHOD-A              PIC X.                 ERCACCT
   380             88 AM-REF-AH-R78                 VALUE 'R'.          ERCACCT
   381             88 AM-REF-AH-PR                  VALUE 'P'.          ERCACCT
   382             88 AM-REF-AH-MEAN                VALUE 'M'.          ERCACCT
   383             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.          ERCACCT
   384             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.          ERCACCT
   385             88 AM-REF-AH-NET                 VALUE 'N'.          ERCACCT
   386                                                                  ERCACCT
   387     12  AM-TOL-PREM                       PIC S999V99    COMP-3. ERCACCT
   388     12  AM-TOL-REF                        PIC S999V99    COMP-3. ERCACCT
   389     12  AM-TOL-CLM                        PIC S999V99    COMP-3. ERCACCT
   390                                                                  ERCACCT
   391     12  AM-RET-Y-N                        PIC X.                 ERCACCT
   392     12  AM-RET-P-E                        PIC X.                 ERCACCT
   393     12  AM-LF-RET                         PIC S9V9999    COMP-3. ERCACCT
   394     12  AM-AH-RET                         PIC S9V9999    COMP-3. ERCACCT
   395     12  AM-RET-GRP                        PIC X(6).              ERCACCT
   396     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.                    ERCACCT
   397         16  AM-POOL-PRIME                 PIC XXX.               ERCACCT
   398         16  AM-POOL-SUB                   PIC XXX.               ERCACCT
   399     12  AM-RETRO-EARNINGS.                                       ERCACCT
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  10
* ECS026.cbl (/apps/prod/cid1p/copy/ERCACCT)
   400         16  AM-RET-EARN-R                 PIC X.                 ERCACCT
   401         16  AM-RET-EARN-L                 PIC X.                 ERCACCT
   402         16  AM-RET-EARN-A                 PIC X.                 ERCACCT
   403     12  AM-RET-ST-TAX-USE                 PIC X.                 ERCACCT
   404         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.  ERCACCT
   405         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.      ERCACCT
   406     12  AM-RETRO-BEG-EARNINGS.                                   ERCACCT
   407         16  AM-RET-BEG-EARN-R             PIC X.                 ERCACCT
   408         16  AM-RET-BEG-EARN-L             PIC X.                 ERCACCT
   409         16  AM-RET-BEG-EARN-A             PIC X.                 ERCACCT
   410     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3. ERCACCT
   411     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3. ERCACCT
   412                                                                  ERCACCT
   413     12  AM-USER-SELECT-OPTIONS.                                  ERCACCT
   414         16  AM-USER-SELECT-1              PIC X(10).             ERCACCT
   415         16  AM-USER-SELECT-2              PIC X(10).             ERCACCT
   416         16  AM-USER-SELECT-3              PIC X(10).             ERCACCT
   417         16  AM-USER-SELECT-4              PIC X(10).             ERCACCT
   418         16  AM-USER-SELECT-5              PIC X(10).             ERCACCT
   419                                                                  ERCACCT
   420     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3. ERCACCT
   421                                                                  ERCACCT
   422     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3. ERCACCT
   423                                                                  ERCACCT
   424     12  AM-RPT045A-SWITCH                 PIC X.                 ERCACCT
   425         88  RPT045A-OFF                   VALUE 'N'.             ERCACCT
   426                                                                  ERCACCT
   427     12  AM-INSURANCE-LIMITS.                                     ERCACCT
   428         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3. ERCACCT
   429         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3. ERCACCT
   430                                                                  ERCACCT
   431     12  AM-PROFILE-CHANGE-SWITCH          PIC X.                 ERCACCT
   432         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.          ERCACCT
   433                                                                  ERCACCT
   434     12  AM-DISMBR-COVERAGE-SW             PIC X.                 ERCACCT
   435         88  AM-DISMBR-COVERAGE               VALUE 'Y'.          ERCACCT
   436         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.          ERCACCT
   437                                                                  ERCACCT
   438     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3. ERCACCT
   439                                                                  ERCACCT
   440     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3. ERCACCT
   441     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
   442     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
   443     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
   444     12  AM-DCC-UEF-STATE                  PIC XX.
   445     12  FILLER                            PIC XXX.
   446     12  AM-REPORT-CODE-3                  PIC X(10).
   447*    12  FILLER                            PIC X(22).             ERCACCT
   448                                                                  ERCACCT
   449     12  AM-RESERVE-DATE.                                         ERCACCT
   450         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.    ERCACCT
   451         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.    ERCACCT
   452         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.    ERCACCT
   453                                                                  ERCACCT
   454     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.                ERCACCT
   455     12  AM-NOTIFICATION-TYPES.                                   ERCACCT
   456         16  AM-NOTIF-OF-LETTERS           PIC X.                 ERCACCT
   457         16  AM-NOTIF-OF-PAYMENTS          PIC X.                 ERCACCT
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  11
* ECS026.cbl (/apps/prod/cid1p/copy/ERCACCT)
   458         16  AM-NOTIF-OF-REPORTS           PIC X.                 ERCACCT
   459         16  AM-NOTIF-OF-STATUS            PIC X.                 ERCACCT
   460                                                                  ERCACCT
   461     12  AM-BENEFIT-TABLE-USAGE            PIC X.                 ERCACCT
   462         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.          ERCACCT
   463         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.          ERCACCT
   464         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.          ERCACCT
   465         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.     ERCACCT
   466                                                                  ERCACCT
   467     12  AM-BENEFIT-CONTROLS.                                     ERCACCT
   468         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.            ERCACCT
   469             20  AM-BENEFIT-CODE           PIC XX.                ERCACCT
   470             20  AM-BENEFIT-TYPE           PIC X.                 ERCACCT
   471             20  AM-BENEFIT-REVISION       PIC XXX.               ERCACCT
   472             20  AM-BENEFIT-REM-TERM       PIC X.                 ERCACCT
   473             20  AM-BENEFIT-RETRO-Y-N      PIC X.                 ERCACCT
   474             20  FILLER                    PIC XX.                ERCACCT
   475         16  FILLER                        PIC X(80).             ERCACCT
   476                                                                  ERCACCT
   477     12  AM-TRANSFER-DATA.                                        ERCACCT
   478         16  AM-TRANSFERRED-FROM.                                 ERCACCT
   479             20  AM-TRNFROM-CARRIER        PIC X.                 ERCACCT
   480             20  AM-TRNFROM-GROUPING.                             ERCACCT
   481                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.               ERCACCT
   482                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.               ERCACCT
   483             20  AM-TRNFROM-STATE          PIC XX.                ERCACCT
   484             20  AM-TRNFROM-ACCOUNT.                              ERCACCT
   485                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).             ERCACCT
   486                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).              ERCACCT
   487             20  AM-TRNFROM-DTE            PIC XX.                ERCACCT
   488         16  AM-TRANSFERRED-TO.                                   ERCACCT
   489             20  AM-TRNTO-CARRIER          PIC X.                 ERCACCT
   490             20  AM-TRNTO-GROUPING.                               ERCACCT
   491                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.               ERCACCT
   492                 24  AM-TRNTO-GRP-PRIME    PIC XXX.               ERCACCT
   493             20  AM-TRNTO-STATE            PIC XX.                ERCACCT
   494             20  AM-TRNTO-ACCOUNT.                                ERCACCT
   495                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).              ERCACCT
   496                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).              ERCACCT
   497             20  AM-TRNTO-DTE              PIC XX.                ERCACCT
   498         16  FILLER                        PIC X(10).             ERCACCT
   499                                                                  ERCACCT
   500     12  AM-SAVED-REMIT-TO                 PIC 99.                ERCACCT
   501                                                                  ERCACCT
   502     12  AM-COMM-STRUCTURE-SAVED.                                 ERCACCT
   503         16  AM-DEFN-1-SAVED.                                     ERCACCT
   504             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.           ERCACCT
   505                 24  AM-AGT-SV             PIC X(10).             ERCACCT
   506                 24  AM-COM-TYP-SV         PIC X.                 ERCACCT
   507                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3. ERCACCT
   508                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3. ERCACCT
   509                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3. ERCACCT
   510                 24  AM-RECALC-LV-INDIC-SV PIC X.                 ERCACCT
   511                 24  FILLER                PIC X.                 ERCACCT
   512                 24  AM-GL-CODES-SV        PIC X.                 ERCACCT
   513                 24  AM-COM-CHARGEBACK-SV  PIC 99.                ERCACCT
   514                 24  FILLER                PIC X.                 ERCACCT
   515         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.       ERCACCT
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  12
* ECS026.cbl (/apps/prod/cid1p/copy/ERCACCT)
   516             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.            ERCACCT
   517                 24  FILLER                PIC X(11).             ERCACCT
   518                 24  AM-L-COMA-SV          PIC XXX.               ERCACCT
   519                 24  AM-J-COMA-SV          PIC XXX.               ERCACCT
   520                 24  AM-A-COMA-SV          PIC XXX.               ERCACCT
   521                 24  FILLER                PIC X(6).              ERCACCT
   522                                                                  ERCACCT
   523     12  AM-FLC-NET-PREMIUM-ALLOWANCE.                            ERCACCT
   524         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.                 ERCACCT
   525            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3. ERCACCT
   526            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3. ERCACCT
   527            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3. ERCACCT
   528                                                                  ERCACCT
   529     12  AM-ORIG-DEALER-NO                 PIC X(10).             ERCACCT
   530     12  FILLER                            PIC X(120).            ERCACCT
   531                                                                  ERCACCT
   532     12  AM-ACCOUNT-EXECUTIVE-DATA.                               ERCACCT
   533         16  AM-CONTROL-NAME               PIC X(30).             ERCACCT
   534         16  AM-EXECUTIVE-ONE.                                    ERCACCT
   535             20  AM-EXEC1-NAME             PIC X(15).             ERCACCT
   536             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)       ERCACCT
   537                                                          COMP-3. ERCACCT
   538             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)       ERCACCT
   539                                                          COMP-3. ERCACCT
   540         16  AM-EXECUTIVE-TWO.                                    ERCACCT
   541             20  AM-EXEC2-NAME             PIC X(15).             ERCACCT
   542             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)       ERCACCT
   543                                                          COMP-3. ERCACCT
   544             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)       ERCACCT
   545                                                          COMP-3. ERCACCT
   546                                                                  ERCACCT
   547     12  AM-RETRO-ADDITIONAL-DATA.                                ERCACCT
   548         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3. ERCACCT
   549         16  AM-RETRO-PREM-P-E             PIC X.                 ERCACCT
   550         16  AM-RETRO-CLMS-P-I             PIC X.                 ERCACCT
   551         16  AM-RETRO-RET-BRACKET-LF.                             ERCACCT
   552             20  AM-RETRO-RET-METHOD-LF    PIC X.                 ERCACCT
   553                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.      ERCACCT
   554                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.          ERCACCT
   555             20  AM-RETRO-RET-BASIS-LF     PIC X.                 ERCACCT
   556                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.      ERCACCT
   557                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.          ERCACCT
   558             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.           ERCACCT
   559                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3. ERCACCT
   560                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3. ERCACCT
   561         16  AM-RETRO-RET-BRACKET-AH.                             ERCACCT
   562             20  AM-RETRO-RET-METHOD-AH    PIC X.                 ERCACCT
   563                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.      ERCACCT
   564                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.          ERCACCT
   565                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.          ERCACCT
   566             20  AM-RETRO-RET-BASIS-AH     PIC X.                 ERCACCT
   567                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.      ERCACCT
   568                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.          ERCACCT
   569             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.           ERCACCT
   570                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3. ERCACCT
   571                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3. ERCACCT
   572                                                                  ERCACCT
   573     12  AM-COMMENTS.                                             ERCACCT
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  13
* ECS026.cbl (/apps/prod/cid1p/copy/ERCACCT)
   574         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.ERCACCT
   575                                                                  ERCACCT
   576     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.         ERCACCT
   577         16  AM-FLI-RETRO-SHARE-CODE       PIC X.                 ERCACCT
   578         16  AM-FLI-BILLING-CODE           PIC X.                 ERCACCT
   579         16  AM-FLI-ALT-STATE-CODE         PIC XX.                ERCACCT
   580         16  AM-FLI-UNITED-IDENT           PIC X.                 ERCACCT
   581         16  AM-FLI-INTEREST-LOST-DATA.                           ERCACCT
   582             20  AM-FLI-BANK-NO            PIC X(5).              ERCACCT
   583             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3. ERCACCT
   584             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3. ERCACCT
   585             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3. ERCACCT
   586         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.            ERCACCT
   587             20  AM-FLI-AGT                PIC X(9).              ERCACCT
   588             20  AM-FLI-AGT-COMM-ACC       PIC X.                 ERCACCT
   589             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3. ERCACCT
   590         16  FILLER                        PIC X(102).            ERCACCT
   591                                                                  ERCACCT
   592     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.         ERCACCT
   593         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.          ERCACCT
   594             20  AM-BENEFIT-DMD-CODE         PIC XX.              ERCACCT
   595             20  AM-BENEFIT-DMD-TYPE         PIC X.               ERCACCT
   596             20  AM-BENEFIT-DMD-REVISION     PIC XXX.             ERCACCT
   597             20  AM-BENEFIT-DMD-REM-TERM     PIC X.               ERCACCT
   598             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.               ERCACCT
   599         16  FILLER                          PIC X(10).           ERCACCT
   600******************************************************************ERCACCT
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  14
* ECS026.cbl
   602 FD  ERRTBL-IN.
*  603                             COPY ERCREIN.
   604******************************************************************07/27/93
   605*                                                                *ERCREIN
   606*                            ERCREIN                             *   LV009
   607*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   608*                            VMOD=2.010                          *   CL**9
   609*                                                                *ERCREIN
   610*   ONLINE CREDIT SYSTEM                                         *ERCREIN
   611*                                                                *ERCREIN
   612*   FILE DESCRIPTION = REINSURANCE MASTER FILE                   *ERCREIN
   613*                                                                *ERCREIN
   614*   FILE TYPE = VSAM,KSDS                                        *ERCREIN
   615*   RECORD SIZE = 4000  RECFORM = FIXED                          *ERCREIN
   616*                                                                *ERCREIN
   617*   BASE CLUSTER NAME = ERREIN                   RKP=2,LEN=8     *ERCREIN
   618*       ALTERNATE PATH = NONE                                    *ERCREIN
   619*                                                                *ERCREIN
   620*   LOG = NO                                                     *ERCREIN
   621*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *ERCREIN
   622*                                                                *ERCREIN
   623******************************************************************ERCREIN
   624*                   C H A N G E   L O G
   625*
   626* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   627*-----------------------------------------------------------------
   628*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   629* EFFECTIVE    NUMBER
   630*-----------------------------------------------------------------
   631* 103101    2001100100006  SMVA  ADD STATE EXHIBIT REPORT OPTION F
   632* 032707    2007032100006  PEMA  ADD EXCISE TAX CAPABILITY
   633******************************************************************
   634 01  REINSURANCE-RECORD.                                          ERCREIN
   635     12  RE-RECORD-ID                      PIC XX.                ERCREIN
   636         88  VALID-RE-ID                      VALUE 'RE'.         ERCREIN
   637                                                                  ERCREIN
   638     12  RE-CONTROL-PRIMARY.                                      ERCREIN
   639         16  RE-COMPANY-CD                 PIC X.                 ERCREIN
   640         16  RE-KEY.                                              ERCREIN
   641             20  RE-CODE                   PIC X.                 ERCREIN
   642                 88  RE-TABLE-RECORD          VALUE 'A'.          ERCREIN
   643                 88  RE-COMPANY-RECORD        VALUE 'B'.          ERCREIN
   644             20  RE-TABLE                  PIC XXX.               ERCREIN
   645             20  FILLER                    PIC XXX.               ERCREIN
   646         16  RE-COMPANY-KEY REDEFINES RE-KEY.                     ERCREIN
   647             20  FILLER                    PIC X.                 ERCREIN
   648             20  RE-COMPANY.                                      ERCREIN
   649                 24  RE-COMP-PRIME         PIC XXX.               ERCREIN
   650                 24  RE-COMP-SUB           PIC XXX.               ERCREIN
   651                                                                  ERCREIN
   652     12  RE-MAINT-INFORMATION.                                    ERCREIN
   653         16  RE-LAST-MAINT-DT              PIC XX.                ERCREIN
   654         16  RE-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3. ERCREIN
   655         16  RE-LAST-MAINT-USER            PIC X(4).              ERCREIN
   656         16  FILLER                        PIC X(10).             ERCREIN
   657                                                                  ERCREIN
   658     12  RE-TABLE-DATA.                                           ERCREIN
   659         16  RE-100-COMP                   PIC 99.                ERCREIN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  15
* ECS026.cbl (/apps/prod/cid1p/copy/ERCREIN)
   660                                                                  ERCREIN
   661         16  RE-COMP-INFO    OCCURS 30 TIMES.                     ERCREIN
   662             20  RE-REI-COMP-NO.                                  ERCREIN
   663                 24  RE-REI-COMP           PIC XXX.               ERCREIN
   664                 24  RE-REI-COMP-SUB       PIC XXX.               ERCREIN
   665             20  RE-LF-QC                  PIC X.                 ERCREIN
   666             20  RE-AH-QC                  PIC X.                 ERCREIN
   667             20  RE-LO-DATE                PIC 9(11)     COMP-3.  ERCREIN
   668             20  RE-HI-DATE                PIC 9(11)     COMP-3.  ERCREIN
   669             20  RE-LFAGE-LO               PIC 99.                ERCREIN
   670             20  RE-LFAGE-HI               PIC 99.                ERCREIN
   671             20  RE-AHAGE-LO               PIC 99.                ERCREIN
   672             20  RE-AHAGE-HI               PIC 99.                ERCREIN
   673             20  RE-LFTRM-LO               PIC S999       COMP-3. ERCREIN
   674             20  RE-LFTRM-HI               PIC S999       COMP-3. ERCREIN
   675             20  RE-AHTRM-LO               PIC S999       COMP-3. ERCREIN
   676             20  RE-AHTRM-HI               PIC S999       COMP-3. ERCREIN
   677             20  RE-LF-PCT                 PIC S9V9999    COMP-3. ERCREIN
   678             20  RE-AH-PCT                 PIC S9V9999    COMP-3. ERCREIN
   679             20  RE-LF-LIM-LO              PIC S9(9)V99   COMP-3. ERCREIN
   680             20  RE-LF-LIM-HI              PIC S9(9)V99   COMP-3. ERCREIN
   681             20  RE-LF-LO                  PIC S9(9)V99   COMP-3. ERCREIN
   682             20  RE-LF-HI                  PIC S9(9)V99   COMP-3. ERCREIN
   683             20  RE-AHBEN-LIM-LO           PIC S9(7)V99   COMP-3. ERCREIN
   684             20  RE-AHBEN-LIM-HI           PIC S9(7)V99   COMP-3. ERCREIN
   685             20  RE-AHBEN-LO               PIC S9(7)V99   COMP-3. ERCREIN
   686             20  RE-AHBEN-HI               PIC S9(7)V99   COMP-3. ERCREIN
   687             20  RE-AHMOA-LIM-LO           PIC S9(7)V99   COMP-3. ERCREIN
   688             20  RE-AHMOA-LIM-HI           PIC S9(7)V99   COMP-3. ERCREIN
   689             20  RE-AHMOA-LO               PIC S9(7)V99   COMP-3. ERCREIN
   690             20  RE-AHMOA-HI               PIC S9(7)V99   COMP-3. ERCREIN
   691             20  RE-LF-BEN-CODE            PIC X.                 ERCREIN
   692             20  RE-AH-BEN-CODE            PIC X.                 ERCREIN
   693             20  RE-INTERACTIVE            PIC X.                 ERCREIN
   694             20  RE-REMAINING              PIC X.                 ERCREIN
   695             20  RE-LF-RUNOFF-SW           PIC X.                      000
   696             20  RE-AH-RUNOFF-SW           PIC X.                      000
   697             20  FILLER                    PIC X(19).                  000
   698                                                                  ERCREIN
   699         16  RE-COMP-INFO-END              PIC X(6).              ERCREIN
   700         16  RE-NSP-ST-CD-LF               PIC XX.                ERCREIN
   701         16  RE-NSP-ST-CD-AH               PIC XX.                ERCREIN
   702         16  RE-TABLE-CARRIER-SECURITY     PIC X.                 ERCREIN
   703             88  NO-TABLE-CARRIER-SECURITY    VALUE SPACE.        ERCREIN
   704                                                                  ERCREIN
   705         16  FILLER                        PIC X(27).             ERCREIN
   706                                                                  ERCREIN
   707     12  RE-COMPANY-DATA   REDEFINES   RE-TABLE-DATA.             ERCREIN
   708         16  RE-NAME                       PIC X(30).             ERCREIN
   709         16  RE-LF-PE                      PIC X.                 ERCREIN
   710         16  RE-AH-PE                      PIC X.                 ERCREIN
   711         16  RE-LF-FEE                     PIC S9V9999    COMP-3. ERCREIN
   712         16  RE-AH-FEE                     PIC S9V9999    COMP-3. ERCREIN
   713         16  RE-AH-PR-PCT                  PIC S9V9999    COMP-3. ERCREIN
   714         16  RE-AH-78-PCT                  PIC S9V9999    COMP-3. ERCREIN
   715         16  RE-PRT-ST                     PIC X.                 ERCREIN
   716         16  RE-PRT-OW                     PIC X.                 ERCREIN
   717         16  RE-MORT-CODE                  PIC X(4).              ERCREIN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  16
* ECS026.cbl (/apps/prod/cid1p/copy/ERCREIN)
   718         16  RE-CLAIM-CODE                 PIC X.                 ERCREIN
   719         16  RE-ZERO-LF-FEE                PIC X.                 ERCREIN
   720         16  RE-ZERO-AH-FEE                PIC X.                 ERCREIN
   721         16  RE-CEDE-NAME                  PIC X(30).             ERCREIN
   722         16  RE-LF-COMM                    PIC X.                 ERCREIN
   723         16  RE-AH-COMM                    PIC X.                 ERCREIN
   724         16  RE-LF-TAX                     PIC X.                 ERCREIN
   725         16  RE-AH-TAX                     PIC X.                 ERCREIN
   726         16  RE-CLM-INCURRED-LIM           PIC 9(11)  COMP-3.     ERCREIN
   727         16  RE-LF-IBNR-PCT                PIC SV999      COMP-3. ERCREIN
   728         16  RE-AH-IBNR-PCT                PIC SV999      COMP-3. ERCREIN
   729                                                                  ERCREIN
   730         16  RE-COMP-CARRIER-SECURITY      PIC X.                 ERCREIN
   731             88  NO-COMP-CARRIER-SECURITY     VALUE SPACE.        ERCREIN
   732                                                                  ERCREIN
   733         16  RE-LF-CEDING-FEE-BRACKETS.                           ERCREIN
   734             20  RE-LF-FEE-METHOD          PIC X.                 ERCREIN
   735                 88  RE-LF-FEE-BRACKETED         VALUE '1' '2'.   ERCREIN
   736                 88  RE-LF-FEE-METHOD-1          VALUE '1'.       ERCREIN
   737                 88  RE-LF-FEE-METHOD-2          VALUE '2'.       ERCREIN
   738                 88  RE-LF-FEE-PERCENT           VALUE ' ' 'P'.   ERCREIN
   739             20  RE-LF-FEE-BASIS           PIC X.                 ERCREIN
   740                 88  RE-LF-GROSS-CEDED             VALUE '1'.     ERCREIN
   741                 88  RE-LF-NET-CEDED               VALUE '2'.     ERCREIN
   742                 88  RE-LF-GROSS-WRITTEN           VALUE '3'.     ERCREIN
   743                 88  RE-LF-NET-WRITTEN             VALUE '4'.     ERCREIN
   744                 88  RE-LF-COMBINE-GROSS-CEDED     VALUE '5'.     ERCREIN
   745                 88  RE-LF-COMBINE-NET-CEDED       VALUE '6'.     ERCREIN
   746                 88  RE-LF-COMBINE-GROSS-WRITTEN   VALUE '7'.     ERCREIN
   747                 88  RE-LF-COMBINE-NET-WRITTEN     VALUE '8'.     ERCREIN
   748             20  FILLER                    PIC XXX.               ERCREIN
   749             20  RE-LF-FEE-RANGES  OCCURS 6 TIMES.                ERCREIN
   750                 24  RE-LF-FEE-RANGE-PCT   PIC S9V9999    COMP-3. ERCREIN
   751                 24  RE-LF-FEE-THRU-AMT    PIC S9(7)V99   COMP-3. ERCREIN
   752                                                                  ERCREIN
   753         16  RE-AH-CEDING-FEE-BRACKETS.                           ERCREIN
   754             20  RE-AH-FEE-METHOD          PIC X.                 ERCREIN
   755                 88  RE-AH-FEE-BRACKETED         VALUE '1' '2'.   ERCREIN
   756                 88  RE-AH-FEE-METHOD-1          VALUE '1'.       ERCREIN
   757                 88  RE-AH-FEE-METHOD-2          VALUE '2'.       ERCREIN
   758                 88  RE-AH-FEE-PERCENT           VALUE ' ' 'P'.   ERCREIN
   759             20  RE-AH-FEE-BASIS           PIC X.                 ERCREIN
   760                 88  RE-AH-GROSS-CEDED             VALUE '1'.     ERCREIN
   761                 88  RE-AH-NET-CEDED               VALUE '2'.     ERCREIN
   762                 88  RE-AH-GROSS-WRITTEN           VALUE '3'.     ERCREIN
   763                 88  RE-AH-NET-WRITTEN             VALUE '4'.     ERCREIN
   764                 88  RE-AH-COMBINE-GROSS-CEDED     VALUE '5'.     ERCREIN
   765                 88  RE-AH-COMBINE-NET-CEDED       VALUE '6'.     ERCREIN
   766                 88  RE-AH-COMBINE-GROSS-WRITTEN   VALUE '7'.     ERCREIN
   767                 88  RE-AH-COMBINE-NET-WRITTEN     VALUE '8'.     ERCREIN
   768             20  FILLER                    PIC XXX.               ERCREIN
   769             20  RE-AH-FEE-RANGES  OCCURS 6 TIMES.                ERCREIN
   770                 24  RE-AH-FEE-RANGE-PCT   PIC S9V9999    COMP-3. ERCREIN
   771                 24  RE-AH-FEE-THRU-AMT    PIC S9(7)V99   COMP-3. ERCREIN
   772                                                                  ERCREIN
   773         16  RE-EARNING-START-DT           PIC 9(11)  COMP-3.     ERCREIN
   774                                                                  ERCREIN
   775         16  RE-OLD-CEDING-STMT            PIC X.                    CL**4
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  17
* ECS026.cbl (/apps/prod/cid1p/copy/ERCREIN)
   776                                                                  ERCREIN
   777         16  RE-LF-CLM-PCT                 PIC S9V9999    COMP-3. ERCREIN
   778         16  RE-AH-CLM-PCT                 PIC S9V9999    COMP-3. ERCREIN
   779         16  RE-LF-CLM-MAX                 PIC S9(7)V99   COMP-3. ERCREIN
   780         16  RE-AH-CLM-MAX                 PIC S9(7)V99   COMP-3. ERCREIN
   781         16  RE-LF-PR-PCT                  PIC S9V9999    COMP-3. ERCREIN
   782         16  RE-LF-78-PCT                  PIC S9V9999    COMP-3. ERCREIN
   783         16  RE-REINS-GROUPING-CODE        PIC X(6).              ERCREIN
   784         16  RE-MORT-SW                    PIC X.                 ERCREIN
   785         16  RE-CEDING-TYPE-FLAG           PIC X.                    CL**2
   786             88  RE-NO-CESSION-TYPE                VALUE ' '.        CL**2
   787             88  RE-CEDED                          VALUE 'C'.        CL**2
   788             88  RE-ASSUMED                        VALUE 'A'.        CL**2
   789             88  RE-PHANTOM                        VALUE 'P'.        CL**2
   790                                                                  ERCREIN
   791         16  RE-CEDING-STMT-OPT-A          PIC X.                    CL**3
   792             88  REPORT-A-WANTED    VALUE ' ' 'Y'.                   CL**3
   793         16  RE-CEDING-STMT-OPT-B          PIC X.                    CL**3
   794             88  REPORT-B-WANTED    VALUE ' ' 'Y'.                   CL**3
   795         16  RE-CEDING-STMT-OPT-C          PIC X.                    CL**3
   796             88  REPORT-C-WANTED    VALUE ' ' 'Y'.                   CL**3
   797         16  RE-CEDING-STMT-OPT-D          PIC X.                    CL**3
   798             88  REPORT-D-WANTED    VALUE ' ' 'Y'.                   CL**3
   799         16  RE-CEDING-STMT-OPT-E          PIC X.                    CL**3
   800             88  REPORT-E-WANTED    VALUE ' ' 'Y'.                   CL**3
   801                                                                     CL**3
   802         16  RE-PRT-CRSV                   PIC X.                    CL**5
   803                                                                     CL**5
   804         16  RE-GL-CENTER                  PIC X(4).                 CL**6
   805                                                                     CL**8
   806         16  RE-CUSTODIAL-BAL              PIC S9(7)V99   COMP-3.    CL**8
   807                                                                     CL**8
   808         16  RE-EARNING-STOP-DT            PIC 9(11)  COMP-3.        CL**9
   809                                                                     CL**9
   810         16  RE-EARN-STOP-CODE             PIC X.                    CL**9
   811             88  STOP-LIFE-EARNING  VALUE 'L' 'B'.                   CL**9
   812             88  STOP-AH-EARNING    VALUE 'A' 'B'.                   CL**9
   813
   814         16  RE-STATE-EXHIBIT-OPT-F        PIC X.
   815             88  RPTF-ECS152-WANTED VALUE ' ' 'Y'.
   816                                                                     CL**9
   817         16  RE-EXCISE-TAX                 PIC S9V9999 COMP-3.
   818         16  FILLER                        PIC X(2281).              CL**9
   819                                                                  ERCREIN
   820         16  RE-DESC OCCURS 18 TIMES       PIC X(79).             ERCREIN
   821                                                                  ERCREIN
   822******************************************************************ERCREIN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  18
* ECS026.cbl
   824 FD  CERT-IN
   825     RECORDING MODE F.
*  826                             COPY ECSCRT01.
   827******************************************************************
   828*                                                                *
   829*                            ECSCRT01                            *
   830*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   831*                            VMOD=2.016                          *
   832*                                                                *
   833*   FILE DESCRIPTION = CERTIFICATE RECORD    (OFF-LINE)          *
   834*                                                                *
   835*   FILE TYPE = SEQUENTIAL
   836*   RECORD SIZE = 1056 RECFORM = FIXED                           *
   837*                                                                *
   838*   KEY DATA =                         START=4, LEN=36           *
   839*                                                                *
   840*  NO  CID  MODS  IN  COPYBOOK  ECSCRT01                         *
   841*                                                                *
   842******************************************************************
   843******************************************************************
   844*                   C H A N G E   L O G
   845*
   846* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   847*-----------------------------------------------------------------
   848*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   849* EFFECTIVE    NUMBER
   850*-----------------------------------------------------------------
   851* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
   852* 100703    2003080800002  PEMA  ADD SUPER GAP PROCESSING
   853* 040504    2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
   854* 020305    2005020000000  PEMA  ADD CLP STATE TO CERT RECORD
   855* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
   856* 042408    2007110500003  PEMA  ADD REFUND INTEREST PROCESSING
   857* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
   858* 032612  CR2011110200001  PEMA  AHL CHANGES
   859* 052814  CR2014012300001  PEMA  DCC CREDIT UNION CHANGES
   860* 090314  CR2014081300001  PEMA  LOAD CERTS INVOLVED IN THAO
   861******************************************************************
   862
   863 01  CERTIFICATE-RECORD.
   864     12  CR-RECORD-ID                      PIC XX.
   865         88  VALID-CR-ID                      VALUE 'CR'.
   866
   867     12  CR-COMPANY-CD                     PIC X.
   868
   869     12  CR-FULL-CONTROL.
   870         16  CR-CONTROL-1.
   871             20  CR-ACCT-CONTROL.
   872                 24  CR-CARRIER            PIC X.
   873                 24  CR-GROUPING.
   874                     28  CR-GROUP-PREFIX   PIC XXX.
   875                     28  CR-GROUP-PRIME    PIC XXX.
   876                 24  CR-STATE              PIC XX.
   877                 24  CR-ACCOUNT.
   878                     28  CR-ACCT-PREFIX    PIC X(4).
   879                     28  CR-ACCT-PRIME     PIC X(6).
   880             20  CR-DT                     PIC 9(11)  COMP-3.
   881         16  CR-CERT-NO.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  19
* ECS026.cbl (/apps/prod/cid1p/copy/ECSCRT01)
   882             20  CR-CERT.
   883                 24  CR-CERT-PREFIX        PIC X(3).
   884                 24  CR-CERT-PRIME         PIC X(7).
   885             20  CR-CERT-SFX               PIC X.
   886
   887     12  CR-INSUREDS-PROFILE.
   888         16  CR-NAME.
   889             20  CR-LNAME                  PIC X(15).
   890             20  CR-FNAME.
   891                 24  CR-1ST-INITIAL        PIC X.
   892                 24  FILLER                PIC X(9).
   893             20  CR-INIT                   PIC X.
   894         16  CR-AGE                        PIC 99.
   895         16  CR-SEX                        PIC X.
   896             88  CR-SEX-MALE                  VALUE 'M'.
   897             88  CR-SEX-FEMALE                VALUE 'F'.
   898         16  CR-SOC-SEC                    PIC X(11).
   899         16  CR-JOINT-NAME.
   900             20  CR-JT-LNAME               PIC X(15).
   901             20  CR-JT-FNAME.
   902                 24  CR-JT-1ST-INIT        PIC X.
   903                 24  FILLER                PIC X(9).
   904             20  CR-JT-INIT                PIC X.
   905         16  CR-JOINT-AGE                  PIC 99.
   906
   907         16  cr-ahl-ah-claim-no            pic x(9).
   908         16  cr-ahl-ah-cert-seq            pic x(3).
   909         16  cr-hst-proc-lf                pic x.
   910         16  f                             pic x(7).
   911
   912     12  CR-LF-COVERAGE-DATA.
   913         16  CR-LFTYP                      PIC XX.
   914         16  CR-LF-TERM                    PIC S999       COMP-3.
   915         16  CR-LF-CRIT-PERIOD             PIC S999       COMP-3.
   916         16  CR-LF-TERM-IN-DAYS            PIC S9(5)      COMP-3.
   917         16  CR-LF-DEV-CODE                PIC XXX.
   918         16  CR-LF-DEV-PCT                 PIC S9V9(6)    COMP-3.
   919
   920         16  CR-LFAMT                      PIC S9(9)V99   COMP-3.
   921         16  CR-LFPRM                      PIC S9(7)V99   COMP-3.
   922         16  CR-LFPRM-CALC                 PIC S9(7)V99   COMP-3.
   923         16  CR-LFPRM-RATE                 PIC S99V9(5)   COMP-3.
   924
   925         16  CR-LFAMT-ALT                  PIC S9(9)V99   COMP-3.
   926         16  CR-LFPRM-ALT                  PIC S9(7)V99   COMP-3.
   927         16  CR-LFPRM-CALC-ALT             PIC S9(7)V99   COMP-3.
   928         16  CR-LFPRM-RATE-ALT             PIC S99V9(5)   COMP-3.
   929
   930         16  CR-LFRFND                     PIC S9(7)V99   COMP-3.
   931         16  CR-LFRFND-CALC                PIC S9(7)V99   COMP-3.
   932
   933         16  CR-LF-NSP-PRM                 PIC S9(7)V99   COMP-3.
   934         16  CR-LF-NSP-PRM-RATE            PIC S99V9(5)   COMP-3.
   935
   936         16  CR-LF-REFUND-TYPE             PIC X.
   937         16  CR-LF-POLICY-FEE              PIC S9(3)V99   COMP-3.
   938
   939         16  CR-LF-COMM-CHARGEBACK         PIC X.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  20
* ECS026.cbl (/apps/prod/cid1p/copy/ECSCRT01)
   940             88  CR-NO-LF-CHARGEBACK          VALUE 'N'.
   941
   942         16  CR-LF-REI-RISK-PRM            PIC S9(7)V99   COMP-3.
   943
   944         16  CR-LF-EXPIRE-DATE             PIC 9(11)      COMP-3.
   945         16  CR-LF-ISS-PREM-TAX            PIC S9V9(4)    COMP-3.
   946         16  CR-LF-CNC-PREM-TAX            PIC S9V9(4)    COMP-3.
   947
   948         16  cr-ahl-lf-claim-no            pic x(9).
   949         16  cr-ahl-lf-cert-seq            pic x(3).
   950         16  FILLER                        PIC XX.
   951
   952     12  CR-AH-COVERAGE-DATA.
   953         16  CR-AHTYP                      PIC XX.
   954         16  CR-AH-TERM                    PIC S999       COMP-3.
   955         16  CR-AH-CRIT-PERIOD             PIC S999       COMP-3.
   956         16  CR-AH-DEV-CODE                PIC XXX.
   957         16  CR-AH-DEV-PCT                 PIC S9V9(6)    COMP-3.
   958
   959         16  CR-AHAMT                      PIC S9(7)V99   COMP-3.
   960         16  CR-AHPRM                      PIC S9(7)V99   COMP-3.
   961         16  CR-AHPRM-CALC                 PIC S9(7)V99   COMP-3.
   962         16  CR-AHPRM-RATE                 PIC S99V9(5)   COMP-3.
   963
   964         16  CR-AHRFND                     PIC S9(7)V99   COMP-3.
   965         16  CR-AHRFND-CALC                PIC S9(7)V99   COMP-3.
   966
   967         16  CR-AH-NSP-PRM                 PIC S9(7)V99   COMP-3.
   968         16  CR-AH-NSP-PRM-RATE            PIC S99V9(5)   COMP-3.
   969
   970         16  CR-AH-REFUND-TYPE             PIC X.
   971         16  CR-AH-POLICY-FEE              PIC S9(3)V99   COMP-3.
   972
   973         16  CR-AH-COMM-CHARGEBACK         PIC X.
   974             88  CR-NO-AH-CHARGEBACK          VALUE 'N'.
   975
   976         16  CR-AH-REI-RISK-PRM            PIC S9(7)V99   COMP-3.
   977
   978         16  CR-AH-EXPIRE-DATE             PIC 9(11)      COMP-3.
   979         16  CR-AH-ISS-PREM-TAX            PIC S9V9(4)    COMP-3.
   980         16  CR-AH-CNC-PREM-TAX            PIC S9V9(4)    COMP-3.
   981
   982         16  FILLER                        PIC XX.
   983*        16  FILLER                        PIC X(8).
   984
   985     12  CR-LOAN-DATA.
   986         16  CR-LIVES                      PIC S9(7)      COMP-3.
   987         16  CR-DDF-IU-RATE-UP REDEFINES CR-LIVES
   988                                           PIC S9(5)V99   COMP-3.
   989         16  CR-BILLED                     PIC S9(7)      COMP-3.
   990         16  CR-APR                        PIC S999V9(4)  COMP-3.
   991         16  CR-PMT-FREQ                   PIC 99.
   992         16  CR-LOAN-TERM                  PIC S999       COMP-3.
   993         16  CR-RATING-CLASS               PIC XX.
   994         16  CR-POLICY-FORM-NO             PIC X(12).
   995         16  CR-GRPTYP                     PIC XX.
   996         16  CR-IND-GRP                    PIC X.
   997             88  CR-INDIVIDUAL                VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  21
* ECS026.cbl (/apps/prod/cid1p/copy/ECSCRT01)
   998             88  CR-GROUP                     VALUE '2'.
   999         16  CR-SKIP                       PIC 99.
  1000             88  NO-MONTHS-SKIPPED            VALUE 00.
  1001             88  SKIP-JULY                    VALUE 01.
  1002             88  SKIP-AUGUST                  VALUE 02.
  1003             88  SKIP-SEPTEMBER               VALUE 03.
  1004             88  SKIP-JULY-AUG                VALUE 04.
  1005             88  SKIP-AUG-SEPT                VALUE 05.
  1006             88  SKIP-JULY-AUG-SEPT           VALUE 06.
  1007             88  SKIP-JUNE-JULY-AUG           VALUE 07.
  1008             88  SKIP-JUNE                    VALUE 08.
  1009             88  SKIP-JUNE-JULY               VALUE 09.
  1010             88  SKIP-AUG-SEPT-OCT            VALUE 10.
  1011             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 11.
  1012         16  CR-RESIDENT-STATE             PIC XX.
  1013         16  CR-RATE-CODE.
  1014             20  CR-LF-CLASS-CD            PIC XX.
  1015             20  CR-AH-CLASS-CD            PIC XX.
  1016         16  CR-MORT.
  1017             20  CR-TAB                    PIC X.
  1018             20  CR-INT                    PIC 99.
  1019             20  CR-GRP                    PIC X.
  1020         16  CR-MEMBER-NO                  PIC X(12).
  1021         16  CR-OLD-LOF                    PIC XXX.
  1022*        16  CR-LOAN-OFFICER               PIC XXX.
  1023         16  CR-REIN-TABLE                 PIC XXX.
  1024         16  CR-REIN-SPEC                  PIC X.
  1025         16  CR-LOAN-1ST-PMT-DT.
  1026             20  CR-1ST-PMT-YR             PIC 99.
  1027             20  CR-1ST-PMT-MO             PIC 99.
  1028             20  CR-1ST-PMT-DA             PIC 99.
  1029         16  CR-SUM-CAN-CNT-ITD            PIC S999       COMP-3.
  1030         16  CR-SUM-CAN-CNT-YTD            PIC S999       COMP-3.
  1031         16  CR-PMT-EXTENSION-DAYS         PIC S999       COMP-3.
  1032         16  CR-LAST-ADD-ON-DT             PIC XX.
  1033
  1034         16  CR-UNDERWRITING-CODE          PIC X.
  1035             88  CR-POLICY-UNDERWRITTEN       VALUE 'Y'.
  1036
  1037         16  CR-STATE-TAX                  PIC S9(7)V99   COMP-3.
  1038         16  CR-MUNI-TAX                   PIC S9(7)V99   COMP-3.
  1039         16  CR-CANCEL-STATE-TAX           PIC S9(7)V99   COMP-3.
  1040         16  CR-CANCEL-MUNI-TAX            PIC S9(7)V99   COMP-3.
  1041
  1042     12  CR-STATUS-INFORMATION.
  1043         16  CR-ENTRY-STATUS               PIC X.
  1044             88  CR-NORMAL-ENTRY              VALUE '1'.
  1045             88  CR-POLICY-IS-RESTORE         VALUE '3'.
  1046             88  CR-CONVERSION-ENTRY          VALUE '4'.
  1047             88  CR-POLICY-IS-REISSUE         VALUE '5'.
  1048             88  CR-POLICY-IS-CASH            VALUE 'C'.
  1049             88  CR-POLICY-IS-MONTHLY         VALUE 'M'.
  1050             88  CR-POLICY-IS-REIN-ONLY       VALUE '9'.
  1051             88  CR-POLICY-IS-DECLINED        VALUE 'D'.
  1052             88  CR-POLICY-IS-VOID            VALUE 'V'.
  1053             88  CR-POLICY-IS-PREM-ONLY       VALUE 'P'.
  1054             88  CR-POLICY-IS-ACTIVE          VALUE '1' '3' '4'
  1055                                                'C' '5' '9' 'P'.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  22
* ECS026.cbl (/apps/prod/cid1p/copy/ECSCRT01)
  1056         16  CR-ENTRY-DATE                 PIC 9(11)  COMP-3.
  1057
  1058         16  CR-LF-STATUS-AT-CANCEL        PIC X.
  1059         16  CR-LF-CANC-DT                 PIC 9(11)  COMP-3.
  1060         16  CR-LF-CANCEL-EXIT-DATE        PIC 9(11)  COMP-3.
  1061
  1062         16  CR-LF-STATUS-AT-DEATH         PIC X.
  1063         16  CR-LF-CLAIM-EXIT-DATE         PIC 9(11)  COMP-3.
  1064
  1065         16  CR-LF-CURRENT-STATUS          PIC X.
  1066             88  CR-LF-NORMAL-ENTRY           VALUE '1'.
  1067             88  CR-LF-POLICY-PENDING         VALUE '2'.
  1068             88  CR-LF-POLICY-IS-RESTORE      VALUE '3'.
  1069             88  CR-LF-CONVERSION-ENTRY       VALUE '4'.
  1070             88  CR-LF-POLICY-IS-REISSUE      VALUE '5'.
  1071             88  CR-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  1072             88  CR-LF-LUMP-SUM-DISAB         VALUE '6'.
  1073             88  CR-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  1074             88  CR-LF-CANCEL-APPLIED         VALUE '8'.
  1075             88  CR-LF-IS-REIN-ONLY           VALUE '9'.
  1076             88  CR-LF-IS-DECLINED            VALUE 'D'.
  1077             88  CR-LF-IS-VOID                VALUE 'V'.
  1078             88  CR-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  1079                                                    '4' '5' '9'.
  1080
  1081         16  CR-AH-STATUS-AT-CANCEL        PIC X.
  1082
  1083         16  CR-AH-CANC-DT                 PIC 9(11)  COMP-3.
  1084         16  CR-AH-CANCEL-EXIT-DATE        PIC 9(11)  COMP-3.
  1085
  1086         16  CR-AH-STATUS-AT-SETTLEMENT    PIC X.
  1087         16  CR-AH-SETTLEMENT-EXIT-DATE    PIC 9(11)  COMP-3.
  1088
  1089         16  CR-AH-CURRENT-STATUS          PIC X.
  1090             88  CR-AH-NORMAL-ENTRY           VALUE '1'.
  1091             88  CR-AH-POLICY-PENDING         VALUE '2'.
  1092             88  CR-AH-POLICY-IS-RESTORE      VALUE '3'.
  1093             88  CR-AH-CONVERSION-ENTRY       VALUE '4'.
  1094             88  CR-AH-POLICY-IS-REISSUE      VALUE '5'.
  1095             88  CR-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  1096             88  CR-AH-LUMP-SUM-DISAB         VALUE '6'.
  1097             88  CR-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  1098             88  CR-AH-CANCEL-APPLIED         VALUE '8'.
  1099             88  CR-AH-IS-REIN-ONLY           VALUE '9'.
  1100             88  CR-AH-IS-DECLINED            VALUE 'D'.
  1101             88  CR-AH-IS-VOID                VALUE 'V'.
  1102             88  CR-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  1103                                                    '4' '5' '9'.
  1104         16  CR-LOAN-OFFICER               PIC X(5).
  1105         16  CR-CANCEL-REASON              PIC X.
  1106         16  cr-xycor-lf-cov-code          pic x(4).
  1107         16  cr-xycor-ah-cov-code          pic x(4).
  1108         16  cr-temp-epiq                  pic x(4).
  1109         16  FILLER                        PIC XX.
  1110
  1111     12  CR-DEATH-CLAIM-DATA.
  1112         16  CR-NUM-DTH-CLM                PIC S999       COMP-3.
  1113
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  23
* ECS026.cbl (/apps/prod/cid1p/copy/ECSCRT01)
  1114         16  CR-DTH-DT                     PIC 9(11)      COMP-3.
  1115         16  CR-DTH-RPT-DT.
  1116             20  CR-DTH-RPT-YR             PIC 99.
  1117             20  CR-DTH-RPT-MO             PIC 99.
  1118             20  CR-DTH-RPT-DA             PIC 99.
  1119         16  CR-DTH-PAY-DT                 PIC 9(11)      COMP-3.
  1120
  1121         16  CR-DTHAMT                     PIC S9(9)V99   COMP-3.
  1122         16  CR-DTHAMT-YTD                 PIC S9(9)V99   COMP-3.
  1123         16  CR-DTHAMT-LAST                PIC S9(9)V99   COMP-3.
  1124         16  CR-DTHEXP                     PIC S9(7)V99   COMP-3.
  1125         16  CR-DTHEXP-YTD                 PIC S9(7)V99   COMP-3.
  1126
  1127         16  CR-DTH-AGE                    PIC 99.
  1128         16  CR-DTH-PAY-CD                 PIC X.
  1129         16  CR-DEATH-CAUSE                PIC X(6).
  1130
  1131         16  FILLER                        PIC X(16).
  1132
  1133     12  CR-DISAB-CLAIM-DATA.
  1134         16  CR-NUM-DIS-CLM                PIC S999       COMP-3.
  1135
  1136         16  CR-DIS-DT                     PIC 9(11)      COMP-3.
  1137         16  CR-DIS-RPT-DT.
  1138             20  CR-DIS-RPT-YR             PIC 99.
  1139             20  CR-DIS-RPT-MO             PIC 99.
  1140             20  CR-DIS-RPT-DA             PIC 99.
  1141         16  CR-DIS-PAY-DT                 PIC 9(11)      COMP-3.
  1142         16  CR-DIS-PTO-DT                 PIC 9(11)      COMP-3.
  1143
  1144         16  CR-DISAMT                     PIC S9(9)V99   COMP-3.
  1145         16  CR-DISAMT-YTD                 PIC S9(9)V99   COMP-3.
  1146         16  CR-DISAMT-LAST                PIC S9(9)V99   COMP-3.
  1147         16  CR-DISEXP                     PIC S9(7)V99   COMP-3.
  1148         16  CR-DISEXP-YTD                 PIC S9(7)V99   COMP-3.
  1149
  1150         16  CR-DAYS-DISAB                 PIC 999        COMP-3.
  1151         16  CR-DIS-PAY-CD                 PIC X.
  1152         16  FILLER                        PIC XX.
  1153
  1154         16  CR-DISAB-INCURRED-DETAIL.
  1155             20  CR-DISAB-DETAIL-DATA  OCCURS 5 TIMES.
  1156**ELCCRTVR MUST BE CHANGED IF THE "OCCURS" IS CHANGED.
  1157                 24  CR-DIS-INCUR-DT       PIC 9(11)     COMP-3.
  1158                 24  CR-INCUR-DISAMT       PIC S9(9)V99  COMP-3.
  1159                 24  CR-INCUR-DISEXP       PIC S9(9)V99  COMP-3.
  1160
  1161         16  CR-DISAB-CAUSE                PIC X(6).
  1162         16  FILLER                        PIC X(14).
  1163
  1164     12  CR-REMIT-TO                       PIC 99.
  1165
  1166     12  CR-COMPENSATION-LEVELS.
  1167         16  CR-AGT-LEVELS      OCCURS 10 TIMES.
  1168             20  CR-COM-AGT.
  1169                 24  CR-COM-AGT-PREFIX     PIC X(4).
  1170                 24  CR-COM-AGT-PRIME      PIC X(6).
  1171             20  CR-AGT-TYPE               PIC X.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  24
* ECS026.cbl (/apps/prod/cid1p/copy/ECSCRT01)
  1172             20  CR-LCOM-L                 PIC SV9(5)     COMP-3.
  1173             20  CR-LCOM-AH                PIC SV9(5)     COMP-3.
  1174
  1175     12  CR-BANK-NOCHRGB-MONTHS            PIC 99.
  1176     12  CR-MOB-NET-TOT-FEES               PIC S9(7)V99   COMP-3.
  1177     12  CR-ADDL-CLP                       PIC S9(5)V99   COMP-3.
  1178     12  CR-CLP-STATE                      PIC XX.
  1179     12  CR-POST-CARD-IND                  PIC X.
  1180     12  CR-LF-CLP                         PIC S9(5)V99   COMP-3.
  1181     12  CR-AH-CLP                         PIC S9(5)V99   COMP-3.
  1182     12  CR-DCC-PRODUCT-CODE               PIC XXX.
  1183     12  CR-LF-RFND-CLP                    PIC S9(5)V99   COMP-3.
  1184     12  CR-AH-RFND-CLP                    PIC S9(5)V99   COMP-3.
  1185     12  FILLER                            PIC X(07).
  1186
  1187     12  CR-CSR-CODE                       PIC XXX.
  1188
  1189     12  CR-CLAIM-DEDUCT-WITHHELD          PIC S9(5)V99   COMP-3.
  1190     12  CR-CANCEL-DEDUCT-WITHHELD         PIC S9(5)V99   COMP-3.
  1191
  1192     12  CR-MICROFILM-NUMBERS.
  1193*        16  CR-ISS-MICROFILM-NO           PIC S9(9)      COMP-3.
  1194         16  FILLER                        PIC X(5).
  1195     12  CR-NH-INT-ON-REF                  PIC S9(7)V99   COMP-3.
  1196
  1197     12  CR-USER-CODE                      PIC X.
  1198     12  CR-USER-FUTURE                    PIC X(9).
  1199
  1200     12  CR-BENEFICIARY.
  1201         16  CR-BANK-NO                    PIC X(10).
  1202         16  FILLER                        PIC X(15).
  1203
  1204     12  CR-ENTRY-BATCH                    PIC X(6).
  1205     12  CR-LF-EXIT-BATCH                  PIC X(6).
  1206     12  CR-AH-EXIT-BATCH                  PIC X(6).
  1207
  1208     12  CR-NOTE-SW                        PIC X.
  1209
  1210     12  CR-ORIGIN-INDICATOR               PIC X.
  1211         88  CR-ENTERED-MANUALLY              VALUE '1'.
  1212         88  CR-CREATED-FROM-TAPE-LOAD        VALUE '2'.
  1213
  1214     12  CR-LF-CNC-ENT-DT                  PIC 9(11)  COMP-3.
  1215     12  CR-AH-CNC-ENT-DT                  PIC 9(11)  COMP-3.
  1216     12  FILLER                            PIC X(33).
  1217
  1218******************************************************************
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  25
* ECS026.cbl
  1220 FD  REIN-WORK
  1221     RECORDING MODE F
  1222     BLOCK CONTAINS 0 RECORDS.
  1223
  1224 01  REIN-WORK-REC           PIC X(124).
  1225
  1226 FD  TEMP-WORK
  1227     RECORDING MODE F
  1228     BLOCK CONTAINS 0 RECORDS.
  1229
  1230 01  TEMP-WORK-REC           PIC X(1141).
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  26
* ECS026.cbl
  1232 FD  DISK-DATE
* 1233                             COPY ELCDTEFD.
  1234******************************************************************04/15/98
  1235*                                                                *ELCDTEFD
  1236*                                                                *ELCDTEFD
  1237*                            ELCDTEFD.                           *   LV002
  1238*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  1239*                            VMOD=2.007                          *   CL**2
  1240*                                                                *ELCDTEFD
  1241******************************************************************ELCDTEFD
  1242     BLOCK CONTAINS 0 RECORDS
  1243     RECORDING MODE F.                                            ELCDTEFD
  1244                                                                  ELCDTEFD
  1245 01  DATE-DISK.                                                   ELCDTEFD
  1246     12  DD-ID                       PIC  X(4).                   ELCDTEFD
  1247     12  FILLER                      PIC  X(14).                  ELCDTEFD
  1248     12  DD-CR1                      PIC  9.                      ELCDTEFD
  1249     12  DD-CR1N                     PIC  X(30).                  ELCDTEFD
  1250     12  DD-CR2                      PIC  9.                      ELCDTEFD
  1251     12  DD-CR2N                     PIC  X(30).                  ELCDTEFD
  1252     12  FILLER                      PIC  X(20).                  ELCDTEFD
  1253                                                                  ELCDTEFD
  1254 01  DATE-DISK-R.                                                 ELCDTEFD
  1255     12  FILLER                      PIC  X(4).                   ELCDTEFD
  1256     12  DD-ST           OCCURS 3 TIMES                           ELCDTEFD
  1257                                     PIC  X(32).                  ELCDTEFD
  1258                                                                  ELCDTEFD
  1259 01  DATE-DISK-T.                                                 ELCDTEFD
  1260     12  FILLER                      PIC  X(4).                   ELCDTEFD
  1261     12  DD-TYPE         OCCURS 2 TIMES                           ELCDTEFD
  1262                                     PIC  X(48).                  ELCDTEFD
  1263                                                                  ELCDTEFD
  1264 01  DATE-DISK-M.                                                 ELCDTEFD
  1265     12  FILLER                      PIC  X(4).                   ELCDTEFD
  1266     12  DD-MORT         OCCURS 2 TIMES                           ELCDTEFD
  1267                                     PIC  X(48).                  ELCDTEFD
  1268                                                                  ELCDTEFD
  1269 01  DATE-DISK-P.                                                 ELCDTEFD
  1270     12  DD-IDA                      PIC  XX.                     ELCDTEFD
  1271     12  DD-IDX                      PIC  99.                     ELCDTEFD
  1272     12  DD-DATA                     PIC  X(96).                  ELCDTEFD
  1273     12  FILLER  REDEFINES DD-DATA.                               ELCDTEFD
  1274         16  DD-PS-PIC   OCCURS 50 TIMES                          ELCDTEFD
  1275                                     PIC  X.                      ELCDTEFD
  1276         16  FILLER                  PIC  X(46).                  ELCDTEFD
  1277     12  FILLER  REDEFINES DD-DATA.                               ELCDTEFD
  1278         16  DD-PS-PICO  OCCURS 20 TIMES.                         ELCDTEFD
  1279             20  DD-PS-PRT           PIC  X.                      ELCDTEFD
  1280             20  DD-PS-FMT           PIC  X.                      ELCDTEFD
  1281             20  DD-PS-PRC           PIC  X.                      ELCDTEFD
  1282             20  DD-PS-TOT           PIC  X.                      ELCDTEFD
  1283         16  FILLER                  PIC  X(16).                  ELCDTEFD
  1284                                                                  ELCDTEFD
  1285 01  DATE-DISK-E.                                                 ELCDTEFD
  1286     12  FILLER                      PIC  X(4).                   ELCDTEFD
  1287     12  DD-EDIT         OCCURS 24 TIMES                          ELCDTEFD
  1288                                     PIC  X(4).                   ELCDTEFD
  1289                                                                  ELCDTEFD
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  27
* ECS026.cbl (/apps/prod/cid1p/copy/ELCDTEFD)
  1290 01  DATE-DISK-C.                                                 ELCDTEFD
  1291     12  FILLER                      PIC  X(7).                   ELCDTEFD
  1292     12  DD-CARR1-SECPAY-SW          PIC  X.
  1293     12  DD-CARR1-UEP-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
  1294     12  DD-CARR1-R78-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
  1295     12  DD-CARR1-PRO-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
  1296     12  DD-CARR1                    PIC  X.                      ELCDTEFD
  1297     12  DD-CARR1S                   PIC  XX.                     ELCDTEFD
  1298     12  DD-CARR1N                   PIC  X(30).                  ELCDTEFD
  1299     12  DD-CARR2                    PIC  X.                      ELCDTEFD
  1300     12  DD-CARR2S                   PIC  XX.                     ELCDTEFD
  1301     12  DD-CARR2N                   PIC  X(30).                  ELCDTEFD
  1302     12  DD-CARR2-UEP-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
  1303     12  DD-CARR2-R78-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
  1304     12  DD-CARR2-PRO-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
  1305     12  DD-CARR2-SECPAY-SW          PIC  X.
  1306     12  FILLER                      PIC  X(7).                   ELCDTEFD
  1307                                                                  ELCDTEFD
  1308 01  DATE-DISK-OPT.                                               ELCDTEFD
  1309     12  FILLER                      PIC  X(04).                  ELCDTEFD
  1310     12  DD-TLR-DATA.                                             ELCDTEFD
  1311         16  DD-TLR                  OCCURS 32 TIMES              ELCDTEFD
  1312                                     PIC  X(03).                  ELCDTEFD
  1313     12  DD-STATE-DATA REDEFINES DD-TLR-DATA.                     ELCDTEFD
  1314         16  DD-STATE-FLDS           OCCURS 16 TIMES              ELCDTEFD
  1315                                     PIC  X(06).                  ELCDTEFD
  1316     12  DD-CARR-DATA REDEFINES DD-TLR-DATA.                      ELCDTEFD
  1317         16  DD-CARR-FLDS            OCCURS 13 TIMES              ELCDTEFD
  1318                                     PIC  X(07).                  ELCDTEFD
  1319         16  FILLER                  PIC  X(05).                  ELCDTEFD
  1320     12  DD-MISC-DATA REDEFINES DD-TLR-DATA                       ELCDTEFD
  1321                                     PIC  X(96).                  ELCDTEFD
  1322******************************************************************ELCDTEFD
  1323
  1324 FD  FICH
* 1325                             COPY ELCFCHFD.
  1326******************************************************************04/15/98
  1327*                                                                *ELCFCHFD
  1328*                            ELCFCHFD.                           *   LV003
  1329*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  1330*                            VMOD=2.004                          *   CL**3
  1331*                                                                *ELCFCHFD
  1332******************************************************************ELCFCHFD
  1333     BLOCK CONTAINS 0 RECORDS
  1334     RECORDING MODE F.                                            ELCFCHFD
  1335                                                                  ELCFCHFD
  1336 01  FICH-REC                            PIC   X(133).            ELCFCHFD
  1337******************************************************************ELCFCHFD
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  28
* ECS026.cbl
  1339 WORKING-STORAGE SECTION.
  1340 01  LCP-ABND-CODE                 PIC S999 COMP VALUE +519.
  1341 77  FILLER  PIC X(32) VALUE '********************************'.
  1342 77  FILLER  PIC X(32) VALUE '     ECS026 WORKING STORAGE     '.
  1343 77  FILLER  PIC X(32) VALUE '******** VMOD=2.021 ************'.
  1344
  1345 77  PGM-SUB                 PIC S9(4)  COMP     VALUE +026.
  1346 77  A-SUB1                  PIC S9(4)  COMP     VALUE +0.
  1347 77  A-SUB2                  PIC S9(4)  COMP     VALUE +0.
  1348 77  P-SUB1                  PIC S9(4)  COMP     VALUE +0.
  1349 77  P-SUB2                  PIC S9(4)  COMP     VALUE +0.
  1350 77  SUB5                    PIC S9(4)  COMP     VALUE +0.
  1351 77  S1                      PIC S9(4)  COMP     VALUE +0.
  1352 77  CERT-END-SW             PIC X               VALUE 'N'.
  1353     88  END-OF-CERT                             VALUE 'Y'.
  1354 77  ACCT-END-SW             PIC X               VALUE 'N'.
  1355     88  END-OF-ACCT                             VALUE 'Y'.
  1356 77  EXTR-END-SW             PIC X               VALUE 'N'.
  1357     88  END-OF-EXTR                             VALUE 'Y'.
  1358 77  CERT-NEEDED-SW          PIC X               VALUE 'Y'.
  1359     88  CERT-NEEDED                             VALUE 'Y'.
  1360 77  ACCOUNT-NEEDED-SW       PIC X               VALUE 'Y'.
  1361     88  ACCOUNT-NEEDED                          VALUE 'Y'.
  1362 77  EXTR-NEEDED-SW          PIC X               VALUE 'Y'.
  1363     88  EXTR-NEEDED                             VALUE 'Y'.
  1364 77  CERT-ACCT-MATCH-SW      PIC X               VALUE 'N'.
  1365     88  NO-MATCH                                VALUE 'N'.
  1366 77  ACCOUNT-BREAK-SW        PIC X               VALUE 'N'.
  1367     88  ACCT-BREAK                              VALUE 'Y'.
  1368 77  ACCT-HAS-BIZ-SW         PIC X               VALUE 'N'.
  1369     88  NO-BIZ                                  VALUE 'N'.
  1370 77  FIRST-TIME-SW           PIC X               VALUE 'Y'.
  1371     88  FIRST-TIME                              VALUE 'Y'.
  1372 77  FIRST-READ-SW           PIC X               VALUE 'Y'.
  1373     88  FIRST-READ                              VALUE 'Y'.
  1374 77  WS-ERRTBL-OPEN-SW       PIC X               VALUE 'N'.
  1375     88  WS-ERRTBL-OPEN                          VALUE 'Y'.
  1376 77  X                       PIC X               VALUE SPACE.
  1377 77  ABEND-OPTION            PIC X               VALUE 'Y'.
  1378 77  CARRIER-L               PIC X.
  1379 77  ABEND-CODE              PIC X(4)            VALUE SPACES.
  1380 77  ERACCT-FILE-STATUS      PIC XX              VALUE ZERO.
  1381 77  ERRTBL-FILE-STATUS      PIC XX              VALUE ZERO.
  1382 77  REIN-RT-SW              PIC X               VALUE 'X'.
  1383
  1384 01  WS.
  1385     12  WS-RETURN-CODE          PIC S9(4)       VALUE ZERO.
  1386     12  WS-ZERO                 PIC S9          VALUE ZERO.
  1387     12  WS-ABEND-MESSAGE        PIC X(80)       VALUE SPACES.
  1388     12  WS-ABEND-FILE-STATUS    PIC XX          VALUE ZERO.
  1389
  1390 01  WORK-ABEND-CODE.
  1391     12  WAC-1               PIC X.
  1392     12  WAC-2               PIC X.
  1393     12  WAC-3-4.
  1394         16  WAC-3           PIC X.
  1395         16  WAC-4           PIC X.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  29
* ECS026.cbl
* 1397                             COPY ELCDATE.
  1398******************************************************************06/11/98
  1399*                                                                *ELCDATE
  1400*                                                                *ELCDATE
  1401*                            ELCDATE.                            *   LV023
  1402*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL*16
  1403*                            VMOD=2.003                           ELCDATE
  1404*                                                                *ELCDATE
  1405*                                                                *ELCDATE
  1406*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *ELCDATE
  1407*                 LENGTH = 200                                   *   CL*19
  1408******************************************************************ELCDATE
  1409                                                                  ELCDATE
  1410 01  DATE-CONVERSION-DATA.                                        ELCDATE
  1411     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.    CL*19
  1412     12  DC-OPTION-CODE                PIC X.                        CL*15
  1413         88  BIN-TO-GREG                VALUE ' '.                ELCDATE
  1414         88  ELAPSED-BETWEEN-BIN        VALUE '1'.                ELCDATE
  1415         88  EDIT-GREG-TO-BIN           VALUE '2'.                ELCDATE
  1416         88  YMD-GREG-TO-BIN            VALUE '3'.                ELCDATE
  1417         88  MDY-GREG-TO-BIN            VALUE '4'.                ELCDATE
  1418         88  JULIAN-TO-BIN              VALUE '5'.                ELCDATE
  1419         88  BIN-PLUS-ELAPSED           VALUE '6'.                ELCDATE
  1420         88  FIND-CENTURY               VALUE '7'.                   CL*22
  1421         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.                ELCDATE
  1422         88  EDIT-GREG-TO-BIN-3         VALUE '9'.                ELCDATE
  1423         88  YMD-GREG-TO-BIN-3          VALUE 'A'.                ELCDATE
  1424         88  MDY-GREG-TO-BIN-3          VALUE 'B'.                ELCDATE
  1425         88  JULIAN-TO-BIN-3            VALUE 'C'.                ELCDATE
  1426         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.                ELCDATE
  1427         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.                   CL*14
  1428         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.                   CL*14
  1429         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.                   CL*14
  1430         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.         CL*14
  1431         88  CHECK-LEAP-YEAR            VALUE 'H'.                   CL*14
  1432         88  BIN-3-TO-GREG              VALUE 'I'.                   CL*14
  1433         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.                   CL*14
  1434         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.                   CL*14
  1435         88  CYMD-GREG-TO-BIN           VALUE 'L'.                   CL*14
  1436         88  MDCY-GREG-TO-BIN           VALUE 'M'.                   CL*14
  1437         88  MDY-GREG-TO-JULIAN         VALUE 'N'.                   CL*14
  1438         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.                   CL*14
  1439         88  YMD-GREG-TO-JULIAN         VALUE 'P'.                   CL*14
  1440         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.                   CL*14
  1441         88  THREE-CHARACTER-BIN                                  ELCDATE
  1442                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.       CL*14
  1443         88  GREGORIAN-TO-BIN                                        CL**2
  1444                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.    CL*14
  1445         88  BIN-TO-GREGORIAN                                        CL**2
  1446                  VALUES ' ' '1' 'I' '8' 'G'.                        CL*14
  1447         88  JULIAN-TO-BINARY                                        CL**2
  1448                  VALUES '5' 'C' 'E' 'F'.                            CL*14
  1449     12  DC-ERROR-CODE                 PIC X.                        CL*15
  1450         88  NO-CONVERSION-ERROR        VALUE ' '.                   CL**3
  1451         88  DATE-CONVERSION-ERROR                                ELCDATE
  1452                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.        CL*14
  1453         88  DATE-IS-ZERO               VALUE '1'.                ELCDATE
  1454         88  DATE-IS-NON-NUMERIC        VALUE '2'.                ELCDATE
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  30
* ECS026.cbl (/apps/prod/cid1p/copy/ELCDATE)
  1455         88  DATE-IS-INVALID            VALUE '3'.                ELCDATE
  1456         88  DATE1-GREATER-DATE2        VALUE '4'.                ELCDATE
  1457         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.                ELCDATE
  1458         88  DATE-INVALID-OPTION        VALUE '9'.                ELCDATE
  1459         88  INVALID-CENTURY            VALUE 'A'.                ELCDATE
  1460         88  ONLY-CENTURY               VALUE 'B'.                ELCDATE
  1461         88  ONLY-LEAP-YEAR             VALUE 'C'.                ELCDATE
  1462         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.              CL**3
  1463     12  DC-END-OF-MONTH               PIC X.                        CL*15
  1464         88  CALCULATE-END-OF-MONTH     VALUE '1'.                ELCDATE
  1465     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.         CL*15
  1466         88  USE-NORMAL-PROCESS         VALUE ' '.                ELCDATE
  1467         88  ADJUST-DOWN-100-YRS        VALUE '1'.                ELCDATE
  1468         88  ADJUST-UP-100-YRS          VALUE '2'.                ELCDATE
  1469     12  FILLER                        PIC X.                        CL*15
  1470     12  DC-CONVERSION-DATES.                                        CL*15
  1471         16  DC-BIN-DATE-1             PIC XX.                       CL*15
  1472         16  DC-BIN-DATE-2             PIC XX.                       CL*15
  1473         16  DC-GREG-DATE-1-EDIT       PIC X(08).                    CL*15
  1474         16  DC-GREG-DATE-1-EDIT-R REDEFINES                         CL*15
  1475                       DC-GREG-DATE-1-EDIT.                       ELCDATE
  1476             20  DC-EDIT1-MONTH        PIC 99.                       CL*15
  1477             20  SLASH1-1              PIC X.                        CL*15
  1478             20  DC-EDIT1-DAY          PIC 99.                       CL*15
  1479             20  SLASH1-2              PIC X.                        CL*15
  1480             20  DC-EDIT1-YEAR         PIC 99.                       CL*15
  1481         16  DC-GREG-DATE-2-EDIT       PIC X(08).                    CL*15
  1482         16  DC-GREG-DATE-2-EDIT-R REDEFINES                         CL*15
  1483                     DC-GREG-DATE-2-EDIT.                         ELCDATE
  1484             20  DC-EDIT2-MONTH        PIC 99.                       CL*15
  1485             20  SLASH2-1              PIC X.                        CL*15
  1486             20  DC-EDIT2-DAY          PIC 99.                       CL*15
  1487             20  SLASH2-2              PIC X.                        CL*15
  1488             20  DC-EDIT2-YEAR         PIC 99.                       CL*15
  1489         16  DC-GREG-DATE-1-YMD        PIC 9(06).                    CL*15
  1490         16  DC-GREG-DATE-1-YMD-R  REDEFINES                         CL*15
  1491                     DC-GREG-DATE-1-YMD.                          ELCDATE
  1492             20  DC-YMD-YEAR           PIC 99.                       CL*15
  1493             20  DC-YMD-MONTH          PIC 99.                       CL*15
  1494             20  DC-YMD-DAY            PIC 99.                       CL*15
  1495         16  DC-GREG-DATE-1-MDY        PIC 9(06).                    CL*15
  1496         16  DC-GREG-DATE-1-MDY-R REDEFINES                          CL*15
  1497                      DC-GREG-DATE-1-MDY.                         ELCDATE
  1498             20  DC-MDY-MONTH          PIC 99.                       CL*15
  1499             20  DC-MDY-DAY            PIC 99.                       CL*15
  1500             20  DC-MDY-YEAR           PIC 99.                       CL*15
  1501         16  DC-GREG-DATE-1-ALPHA.                                   CL*15
  1502             20  DC-ALPHA-MONTH        PIC X(10).                    CL*15
  1503             20  DC-ALPHA-DAY          PIC 99.                       CL*15
  1504             20  FILLER                PIC XX.                       CL*15
  1505             20  DC-ALPHA-CENTURY.                                   CL*15
  1506                 24 DC-ALPHA-CEN-N     PIC 99.                       CL*15
  1507             20  DC-ALPHA-YEAR         PIC 99.                       CL*15
  1508         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.           CL*15
  1509         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.           CL*15
  1510         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.           CL*15
  1511         16  DC-JULIAN-DATE            PIC 9(05).                    CL*15
  1512         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE                CL*20
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  31
* ECS026.cbl (/apps/prod/cid1p/copy/ELCDATE)
  1513                                       PIC 9(05).                    CL*20
  1514         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.                  CL*15
  1515             20  DC-JULIAN-YEAR        PIC 99.                       CL*15
  1516             20  DC-JULIAN-DAYS        PIC 999.                      CL*15
  1517         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.       CL*15
  1518         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.    CL*15
  1519         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.    CL*15
  1520     12  DATE-CONVERSION-VARIBLES.                                   CL*15
  1521         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.            CL*15
  1522         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.          CL*15
  1523             20  FILLER                PIC 9(3).                     CL*15
  1524             20  HOLD-CEN-1-CCYY.                                    CL*15
  1525                 24  HOLD-CEN-1-CC     PIC 99.                       CL*17
  1526                 24  HOLD-CEN-1-YY     PIC 99.                       CL*17
  1527             20  HOLD-CEN-1-MO         PIC 99.                       CL*17
  1528             20  HOLD-CEN-1-DA         PIC 99.                       CL*17
  1529         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.            CL*15
  1530             20  HOLD-CEN-1-R-MO       PIC 99.                       CL*17
  1531             20  HOLD-CEN-1-R-DA       PIC 99.                       CL*17
  1532             20  HOLD-CEN-1-R-CCYY.                                  CL*15
  1533                 24  HOLD-CEN-1-R-CC   PIC 99.                       CL*17
  1534                 24  HOLD-CEN-1-R-YY   PIC 99.                       CL*17
  1535             20  FILLER                PIC 9(3).                     CL*15
  1536         16  HOLD-CENTURY-1-X.                                       CL*15
  1537             20  FILLER                PIC X(3)  VALUE SPACES.       CL*15
  1538             20  HOLD-CEN-1-X-CCYY.                                  CL*15
  1539                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.          CL*17
  1540                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.          CL*17
  1541             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.          CL*17
  1542             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.          CL*17
  1543         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.          CL*15
  1544             20  HOLD-CEN-1-R-X-MO     PIC XX.                       CL*17
  1545             20  HOLD-CEN-1-R-X-DA     PIC XX.                       CL*17
  1546             20  HOLD-CEN-1-R-X-CCYY.                                CL*15
  1547                 24  HOLD-CEN-1-R-X-CC PIC XX.                       CL*17
  1548                 24  HOLD-CEN-1-R-X-YY PIC XX.                       CL*17
  1549             20  FILLER                PIC XXX.                      CL*23
  1550         16  DC-BIN-DATE-EXPAND-1      PIC XXX.                      CL*15
  1551         16  DC-BIN-DATE-EXPAND-2      PIC XXX.                      CL*15
  1552         16  DC-JULIAN-DATE-1          PIC 9(07).                    CL*15
  1553         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.          CL*15
  1554             20  DC-JULIAN-1-CCYY.                                   CL*15
  1555                 24  DC-JULIAN-1-CC    PIC 99.                       CL*15
  1556                 24  DC-JULIAN-1-YR    PIC 99.                       CL*15
  1557             20  DC-JULIAN-DA-1        PIC 999.                      CL*15
  1558         16  DC-JULIAN-DATE-2          PIC 9(07).                    CL*15
  1559         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.          CL*15
  1560             20  DC-JULIAN-2-CCYY.                                   CL*15
  1561                 24  DC-JULIAN-2-CC    PIC 99.                       CL*15
  1562                 24  DC-JULIAN-2-YR    PIC 99.                       CL*15
  1563             20  DC-JULIAN-DA-2        PIC 999.                      CL*15
  1564         16  DC-GREG-DATE-A-EDIT.                                    CL*15
  1565             20  DC-EDITA-MONTH        PIC 99.                       CL*15
  1566             20  SLASHA-1              PIC X VALUE '/'.              CL*15
  1567             20  DC-EDITA-DAY          PIC 99.                       CL*15
  1568             20  SLASHA-2              PIC X VALUE '/'.              CL*15
  1569             20  DC-EDITA-CCYY.                                      CL*15
  1570                 24  DC-EDITA-CENT     PIC 99.                       CL*15
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  32
* ECS026.cbl (/apps/prod/cid1p/copy/ELCDATE)
  1571                 24  DC-EDITA-YEAR     PIC 99.                       CL*15
  1572         16  DC-GREG-DATE-B-EDIT.                                    CL*15
  1573             20  DC-EDITB-MONTH        PIC 99.                       CL*15
  1574             20  SLASHB-1              PIC X VALUE '/'.              CL*15
  1575             20  DC-EDITB-DAY          PIC 99.                       CL*15
  1576             20  SLASHB-2              PIC X VALUE '/'.              CL*15
  1577             20  DC-EDITB-CCYY.                                      CL*15
  1578                 24  DC-EDITB-CENT     PIC 99.                       CL*15
  1579                 24  DC-EDITB-YEAR     PIC 99.                       CL*15
  1580         16  DC-GREG-DATE-CYMD         PIC 9(08).                    CL*15
  1581         16  DC-GREG-DATE-CYMD-R REDEFINES                           CL*15
  1582                              DC-GREG-DATE-CYMD.                  ELCDATE
  1583             20  DC-CYMD-CEN           PIC 99.                       CL*15
  1584             20  DC-CYMD-YEAR          PIC 99.                       CL*15
  1585             20  DC-CYMD-MONTH         PIC 99.                       CL*15
  1586             20  DC-CYMD-DAY           PIC 99.                       CL*15
  1587         16  DC-GREG-DATE-MDCY         PIC 9(08).                    CL*15
  1588         16  DC-GREG-DATE-MDCY-R REDEFINES                           CL*15
  1589                              DC-GREG-DATE-MDCY.                  ELCDATE
  1590             20  DC-MDCY-MONTH         PIC 99.                       CL*15
  1591             20  DC-MDCY-DAY           PIC 99.                       CL*15
  1592             20  DC-MDCY-CEN           PIC 99.                       CL*15
  1593             20  DC-MDCY-YEAR          PIC 99.                       CL*15
  1594    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.      ELCDATE
  1595        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.        ELCDATE
  1596    12  DC-EL310-DATE                  PIC X(21).                    CL*26
  1597    12  FILLER                         PIC X(28).                    CL*26
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  33
* ECS026.cbl
* 1599                             COPY ELCCALC.
  1600******************************************************************04/15/98
  1601*                                                                *ELCCALC
  1602*                           ELCCALC.                            *    LV003
  1603*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
  1604*                            VMOD=2.025                          *   CL**3
  1605*                                                                *   CL**2
  1606*   DESCRIPTION:  DATA TO BE PASSED TO REMAINING TERM ROUTINE    *   CL**2
  1607*                 REMAINING AMOUNT ROUTINE, LOSS RESERVE ROUTINE *   CL**2
  1608*                 REFUND CALCULATIONS ROUTINE, EARNINGS CALCU -  *   CL**2
  1609*                 LATIONS ROUTINE, AND THE RATING ROUTINE.       *   CL**2
  1610*                                                                *   CL**2
  1611*  PASSED TO ELRTRM                                              *   CL**2
  1612*  -----------------                                             *   CL**2
  1613*  METHOD CODE (I.E. FULL MONTH, HALF ADJ, ETC)                  *   CL**2
  1614*  ORIGINAL TERM                                                 *   CL**2
  1615*  BEGINNING DATE                                                *   CL**2
  1616*  ENDING DATE                                                   *   CL**2
  1617*  COMPANY I.D.                                                  *   CL**2
  1618*  ACCOUNT MASTER USER FIELD                                     *   CL**2
  1619*  PROCESS SWITCH (CANCEL, CLAIM)                                *   CL**2
  1620*  FREE LOOK DAYS                                                *   CL**2
  1621*                                                                *   CL**2
  1622*  RETURNED FROM ELRTRM                                          *   CL**2
  1623*  ---------------------                                         *   CL**2
  1624*  REMAINING TERM 1 - USED FOR EARNINGS                          *   CL**2
  1625*  REMAINING TERM 2 - USED FOR BENEFIT CALCULATIONS              *   CL**2
  1626*  REMAINING TERM 3 - USED FOR CLAIM BENEFITS                    *   CL**2
  1627*  ODD DAYS - REMAINING DAYS PAST FULL MONTHS                    *   CL**2
  1628*----------------------------------------------------------------*   CL**2
  1629*  PASSED TO ELRAMT                                              *   CL**2
  1630*  ----------------                                              *   CL**2
  1631*  REMAINING TERM 1 OR 2 OR 3 (FROM ELRTRM)                      *   CL**2
  1632*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *   CL**2
  1633*  ORIGINAL AMOUNT                                               *   CL**2
  1634*  ALTERNATE BENEFIT (BALLON)                                    *   CL**2
  1635*  A.P.R. - NET PAY ONLY                                         *   CL**2
  1636*  METHOD                                                            CL**2
  1637*  PAYMENT FREQUENCY - FOR FARM PLAN                             *   CL**2
  1638*  COMPANY I.D.                                                  *   CL**2
  1639*  BENEFIT TYPE                                                  *   CL**2
  1640*                                                                *   CL**2
  1641*  RETURNED FROM ELRAMT                                          *   CL**2
  1642*  --------------------                                          *   CL**2
  1643*  REMAINING AMOUNT 1 - CURRENT                                  *   CL**2
  1644*  REMAINING AMOUNT 2 - PREVIOUS MONTH                           *   CL**2
  1645*  REMAINING AMOUNT FACTOR                                           CL**2
  1646*----------------------------------------------------------------*   CL**2
  1647*  PASSED TO ELRESV                                              *   CL**2
  1648*  -----------------                                             *   CL**2
  1649*  CERTIFICATE EFFECTIVE DATE                                    *   CL**2
  1650*  VALUATION DATE                                                *   CL**2
  1651*  PAID THRU DATE                                                *   CL**2
  1652*  BENEFIT                                                       *   CL**2
  1653*  INCURRED DATE                                                 *   CL**2
  1654*  REPORTED DATE                                                 *   CL**2
  1655*  ISSUE AGE                                                     *   CL**2
  1656*  TERM                                                          *   CL**2
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  34
* ECS026.cbl (/apps/prod/cid1p/copy/ELCCALC)
  1657*  CDT PERCENT                                                   *   CL**2
  1658*  CDT METHOD (I.E. INTERPOLATED, AVERAGE, ETC)                  *   CL**2
  1659* *CLAIM TYPE (LIFE, A/H)                                        *   CL**2
  1660* *REMAINING BENEFIT (FROM ELRAMT)                               *   CL**2
  1661* *ONLY FIELDS REQUIRED FOR LIFE CLAIMS                          *   CL**2
  1662*                                                                *   CL**2
  1663*  RETURNED FROM ELRESV                                          *   CL**2
  1664*  --------------------                                          *   CL**2
  1665*  CDT TABLE USED                                                *   CL**2
  1666*  CDT FACTOR USED                                               *   CL**2
  1667*  PAY TO CURRENT RESERVE                                        *   CL**2
  1668*  I.B.N.R. - A/H ONLY                                           *   CL**2
  1669*  FUTURE (ACCRUED) AH ONLY                                      *   CL**2
  1670*----------------------------------------------------------------*   CL**2
  1671*  PASSED TO ELRATE                                              *   CL**2
  1672*  ----------------                                              *   CL**2
  1673*  CERT ISSUE DATE                                               *   CL**2
  1674*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *   CL**2
  1675*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *   CL**2
  1676*  CAPPED TERM   (ONLY FOR TRUNCATED LIFE)                       *   CL**2
  1677*  STATE CODE (CLIENT DEFINED)                                   *   CL**2
  1678*  STATE CODE (STANDARD P.O. ABBRV)                              *   CL**2
  1679*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *   CL**2
  1680*  DEVIATION CODE                                                *   CL**2
  1681*  ISSUE AGE                                                     *   CL**2
  1682*  ORIGINAL BENEFIT AMOUNT                                       *   CL**2
  1683*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *   CL**2
  1684*  PROCESS TYPE (ISSUE OR CANCEL)                                *   CL**2
  1685*  BENEFIT KIND (LIFE OR A/H)                                    *   CL**2
  1686*  A.P.R.                                                        *   CL**2
  1687*  METHOD                                                            CL**2
  1688*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *   CL**2
  1689*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *   CL**2
  1690*  COMPANY I.D. (3 CHARACTER)                                    *   CL**2
  1691*  BENEFIT CODE                                                  *   CL**2
  1692*  BENEFIT OVERRIDE CODE                                         *   CL**2
  1693*  MAXIMUM MONTHLY BENEFIT (FROM ACCT MASTER - CSL ONLY)         *   CL**2
  1694*  MAXIMUM TOTAL BENEFIT (FROM ACCT MASTER - CSL ONLY)           *   CL**2
  1695*  JOINT INDICATOR (CSL ONLY)                                    *   CL**2
  1696*  FIRST PAYMENT DATE (CSL ONLY)                                 *   CL**2
  1697*  PERIODIC PAYMENT AMOUNT (IN CP-REMAINING-TERM - CSL ONLY)     *   CL**2
  1698*                                                                *   CL**2
  1699*  RETURNED FROM ELRATE                                          *   CL**2
  1700*  --------------------                                          *   CL**2
  1701*  CALCULATED PREMIUM                                            *   CL**2
  1702*  PREMIUM RATE                                                  *   CL**2
  1703*  MORTALITY CODE                                                *   CL**2
  1704*  MAX ATTAINED AGE                                              *   CL**2
  1705*  MAX AGE                                                       *   CL**2
  1706*  MAX TERM                                                      *   CL**2
  1707*  MAX MONTHLY BENEFIT                                           *   CL**2
  1708*  MAX TOTAL BENIFIT                                             *   CL**2
  1709*  COMPOSITE RATE (OPEN-END ONLY)                                *   CL**2
  1710*----------------------------------------------------------------*   CL**2
  1711*  PASSED TO ELRFND                                              *   CL**2
  1712*  ----------------                                              *   CL**2
  1713*  CERT ISSUE DATE                                               *   CL**2
  1714*  REFUND DATE                                                   *   CL**2
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  35
* ECS026.cbl (/apps/prod/cid1p/copy/ELCCALC)
  1715*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *   CL**2
  1716*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *   CL**2
  1717*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *   CL**2
  1718*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *   CL**2
  1719*  STATE CODE (CLIENT DEFINED)                                   *   CL**2
  1720*  STATE CODE (STANDARD P.O. ABBRV)                              *   CL**2
  1721*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *   CL**2
  1722*  DEVIATION CODE                                                *   CL**2
  1723*  ISSUE AGE                                                     *   CL**2
  1724*  ORIGINAL BENEFIT AMOUNT                                       *   CL**2
  1725*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *   CL**2
  1726*  PROCESS TYPE (CANCEL)                                         *   CL**2
  1727*  BENEFIT KIND (LIFE OR A/H)                                    *   CL**2
  1728*  A.P.R.                                                        *   CL**2
  1729*  EARNING METHOD - (CODE FROM BENEFIT, STATE OR ACCOUNT RECORD) *   CL**2
  1730*  RATING METHOD -  (CODE FROM BENEFIT)                          *   CL**2
  1731*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *   CL**2
  1732*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *   CL**2
  1733*  COMPANY I.D. (3 CHARACTER)                                    *   CL**2
  1734*  BENEFIT CODE                                                  *   CL**2
  1735*  BENEFIT OVERRIDE CODE                                         *   CL**2
  1736*                                                                *   CL**2
  1737*  RETURNED FROM ELRFND                                          *   CL**2
  1738*  --------------------                                          *   CL**2
  1739*  CALCULATED REFUND                                             *   CL**2
  1740*----------------------------------------------------------------*   CL**2
  1741*  PASSED TO ELEARN                                              *   CL**2
  1742*  ----------------                                              *   CL**2
  1743*  CERT ISSUE DATE                                               *   CL**2
  1744*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *   CL**2
  1745*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *   CL**2
  1746*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *   CL**2
  1747*  STATE CODE (CLIENT DEFINED)                                   *   CL**2
  1748*  STATE CODE (STANDARD P.O. ABBRV)                              *   CL**2
  1749*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *   CL**2
  1750*  DEVIATION CODE                                                *   CL**2
  1751*  ISSUE AGE                                                     *   CL**2
  1752*  ORIGINAL BENEFIT AMOUNT                                       *   CL**2
  1753*  BENEFIT KIND (LIFE OR A/H)                                    *   CL**2
  1754*  A.P.R.                                                        *   CL**2
  1755*  METHOD - (EARNING CODE FROM BENEFIT RECORD)                   *   CL**2
  1756*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *   CL**2
  1757*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *   CL**2
  1758*  COMPANY I.D. (3 CHARACTER)                                    *   CL**2
  1759*  BENEFIT CODE                                                  *   CL**2
  1760*  BENEFIT OVERRIDE CODE                                         *   CL**2
  1761*                                                                *   CL**2
  1762*  RETURNED FROM ELEARN                                          *   CL**2
  1763*  --------------------                                          *   CL**2
  1764*  INDICATED  EARNINGS                                           *   CL**2
  1765*----------------------------------------------------------------*   CL**2
  1766*                 LENGTH = 450                                   *   CL**2
  1767*                                                                *   CL**2
  1768******************************************************************   CL**2
  1769******************************************************************
  1770*                   C H A N G E   L O G
  1771*
  1772* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  36
* ECS026.cbl (/apps/prod/cid1p/copy/ELCCALC)
  1773*-----------------------------------------------------------------
  1774*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1775* EFFECTIVE    NUMBER
  1776*-----------------------------------------------------------------
  1777* 010303    2001061800003  PEMA  ADD DCC/MONTHLY PROCESSING
  1778* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  1779* 101807    2007100100007  PEMA  EXPAND CLM RESERVE FIELDS
  1780* 010410    2008021200005  PEMA  ADD FIELDS FOR MN NET PAY BALLOON
  1781* 010410    2009050700003  PEMA  ADD FIELDS FOR SPP-DD
  1782* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  1783* 041710    2007111300001  AJRA  ADD CLAIM CALC SW FOR SC NP+6
  1784* 101110  CR2010012700001  PEMA ADD DDF REFUND/UEP PROCESSING
  1785* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  1786* 040615  CR2013072200002  PEMA  ADD EXTRA PERIODS
  1787******************************************************************
  1788                                                                     CL**2
  1789 01  CALCULATION-PASS-AREA.                                          CL**2
  1790     12  CP-COMM-LENGTH            PIC S9(4)         VALUE +450      CL**2
  1791                                     COMP.                           CL**2
  1792                                                                     CL**2
  1793     12  CP-RETURN-CODE            PIC X             VALUE ZERO.     CL**2
  1794       88  NO-CP-ERROR                             VALUE ZERO.       CL**2
  1795       88  CP-ERROR-OCCURED VALUE '1' '2' '3' '4' '5' '6' '7' '8'    CL**2
  1796                                  '9' 'A' 'B' 'C' 'D' 'E' 'H'.       CL**2
  1797       88  CP-ERROR-IN-AMOUNTS                     VALUE '1'.        CL**2
  1798       88  CP-ERROR-IN-DATES                       VALUE '2'.        CL**2
  1799       88  CP-ERROR-IN-OPTIONS                     VALUE '3'.        CL**2
  1800       88  CP-ERROR-IN-TERMS                       VALUE '4'.        CL**2
  1801       88  CP-ERROR-IN-FREQUENCY                   VALUE '5'.        CL**2
  1802       88  CP-ERROR-RATE-NOT-FOUND                 VALUE '6'.        CL**2
  1803       88  CP-ERROR-RATE-IS-ZERO                   VALUE '7'.        CL**2
  1804       88  CP-ERROR-AMT-OUTSIDE-LIMIT              VALUE '8'.        CL**2
  1805       88  CP-ERROR-TERM-OUTSIDE-LIMIT             VALUE '9'.        CL**2
  1806       88  CP-ERROR-AGE-OUTSIDE-LIMIT              VALUE 'A'.        CL**2
  1807       88  CP-ERROR-ATT-OUTSIDE-LIMIT              VALUE 'B'.        CL**2
  1808       88  CP-ERROR-TOT-OUTSIDE-LIMIT              VALUE 'C'.        CL**2
  1809       88  CP-ERROR-RATE-FILE-NOTOPEN              VALUE 'D'.        CL**2
  1810       88  CP-ERROR-ISSUE-AGE-ZERO                 VALUE 'E'.        CL**2
  1811       88  CP-ERROR-NO-LIMITS-CRI                  VALUE 'F'.        CL**2
  1812       88  CP-ERROR-DIV-BY-ZERO                    VALUE 'G'.        CL**2
  1813       88  CP-ERROR-LOAN-TERM                      VALUE 'H'.        CL**2
  1814                                                                     CL**2
  1815     12  CP-RETURN-CODE-2          PIC X             VALUE ZERO.     CL**2
  1816       88  NO-CP-ERROR-2                           VALUE ZERO.       CL**2
  1817***********************  INPUT AREAS ****************************    CL**2
  1818                                                                     CL**2
  1819     12  CP-CALCULATION-AREA.                                        CL**2
  1820         16  CP-ACCOUNT-NUMBER     PIC X(10)       VALUE SPACES.     CL**2
  1821         16  CP-CERT-EFF-DT        PIC XX.                           CL**2
  1822         16  CP-VALUATION-DT       PIC XX.                           CL**2
  1823         16  CP-PAID-THRU-DT       PIC XX.                           CL**2
  1824         16  CP-BENEFIT-TYPE       PIC X.                            CL**2
  1825           88  CP-AH                               VALUE 'A' 'D'     CL**2
  1826                                                   'I' 'U'.          CL**2
  1827           88  CP-REDUCING-LIFE                    VALUE 'R'.        CL**2
  1828           88  CP-LEVEL-LIFE                       VALUE 'L' 'P'.    CL**2
  1829         16  CP-INCURRED-DT        PIC XX.                           CL**2
  1830         16  CP-REPORTED-DT        PIC XX.                           CL**2
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  37
* ECS026.cbl (/apps/prod/cid1p/copy/ELCCALC)
  1831         16  CP-ACCT-FLD-5         PIC XX            VALUE SPACE.    CL**2
  1832         16  CP-COMPANY-ID         PIC XXX           VALUE SPACE.    CL**2
  1833         16  CP-ISSUE-AGE          PIC S9(3)         VALUE ZERO      CL**2
  1834                                     COMP-3.                         CL**2
  1835         16  CP-CDT-PERCENT        PIC S9(3)V99      VALUE ZERO      CL**2
  1836                                     COMP-3.                         CL**2
  1837         16  CP-CDT-METHOD         PIC X.                            CL**2
  1838           88  CP-CDT-ROUND-NEAR                   VALUE '1'.        CL**2
  1839           88  CP-CDT-ROUND-HIGH                   VALUE '2'.        CL**2
  1840           88  CP-CDT-INTERPOLATED                 VALUE '3'.        CL**2
  1841         16  CP-CLAIM-TYPE         PIC X.                            CL**2
  1842           88  CP-AH-CLAIM                         VALUE 'A'.        CL**2
  1843           88  CP-LIFE-CLAIM                       VALUE 'L'.        CL**2
  1844         16  CP-ORIGINAL-TERM      PIC S9(3)         VALUE ZERO      CL**2
  1845                                     COMP-3.                         CL**2
  1846         16  CP-ORIGINAL-BENEFIT   PIC S9(9)V99      VALUE ZERO      CL**2
  1847                                     COMP-3.                         CL**2
  1848         16  CP-ORIGINAL-PREMIUM   PIC S9(7)V99      VALUE ZERO      CL**2
  1849                                     COMP-3.                         CL**2
  1850         16  CP-REMAINING-TERM     PIC S9(3)V99      VALUE ZERO      CL**2
  1851                                     COMP-3.                         CL**2
  1852         16  CP-REMAINING-BENEFIT  PIC S9(9)V99      VALUE ZERO      CL**2
  1853                                     COMP-3.                         CL**2
  1854         16  CP-LOAN-APR           PIC S9(3)V9(4)    VALUE ZERO      CL**2
  1855                                     COMP-3.                         CL**2
  1856         16  CP-PAY-FREQUENCY      PIC S9(3)         VALUE ZERO      CL**2
  1857                                     COMP-3.                         CL**2
  1858         16  CP-REM-TERM-METHOD    PIC X.                            CL**2
  1859           88  CP-EARN-AFTER-15TH                  VALUE '1'.        CL**2
  1860           88  CP-EARN-ON-HALF-MONTH               VALUE '2'.        CL**2
  1861           88  CP-EARN-ON-1ST-DAY                  VALUE '3'.        CL**2
  1862           88  CP-EARN-ON-FULL-MONTH               VALUE '4'.        CL**2
  1863           88  CP-EARN-WITH-NO-DAYS                VALUE '5'.        CL**2
  1864           88  CP-EARN-AFTER-14TH                  VALUE '6'.        CL**2
  1865           88  CP-EARN-AFTER-16TH                  VALUE '7'.        CL**2
  1866         16  CP-EARNING-METHOD     PIC X.                            CL**2
  1867           88  CP-EARN-BY-R78                      VALUE '1' 'R'.    CL**2
  1868           88  CP-EARN-BY-PRORATA                  VALUE '2' 'P'.    CL**2
  1869           88  CP-EARN-AS-CALIF                    VALUE '3' 'C'.    CL**2
  1870           88  CP-EARN-AS-TEXAS                    VALUE '4' 'T'.    CL**2
  1871           88  CP-EARN-AS-FARM-PLAN                VALUE '4' 'T'.    CL**2
  1872           88  CP-EARN-AS-NET-PAY                  VALUE '5' 'N'.    CL**2
  1873           88  CP-EARN-ANTICIPATION                VALUE '6' 'A'.    CL**2
  1874           88  CP-EARN-AS-MEAN                     VALUE '8' 'M'.    CL**2
  1875           88  CP-EARN-AS-SUM-OF-DIGITS            VALUE '9'.        CL**2
  1876           88  CP-EARN-AS-REG-BALLOON              VALUE 'B'.        CL**2
  1877           88  CP-GAP-NON-REFUNDABLE               VALUE 'G'.
  1878           88  CP-GAP-ACTUARIAL                    VALUE 'S'.
  1879           88  CP-DCC-SPP-DDF                      VALUE 'D' 'I'.
  1880           88  CP-DCC-SPP-DDF-IU                   VALUE 'I'.
  1881         16  CP-PROCESS-TYPE       PIC X.                            CL**2
  1882           88  CP-CLAIM                            VALUE '1'.        CL**2
  1883           88  CP-CANCEL                           VALUE '2'.        CL**2
  1884           88  CP-ISSUE                            VALUE '3'.        CL**2
  1885         16  CP-SPECIAL-CALC-CD    PIC X.                            CL**2
  1886           88  CP-OUTSTANDING-BAL              VALUE 'O'.            CL**2
  1887           88  CP-1-MTH-INTEREST               VALUE ' '.            CL**2
  1888           88  CP-0-MTH-INTEREST               VALUE 'A'.            CL**2
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  38
* ECS026.cbl (/apps/prod/cid1p/copy/ELCCALC)
  1889           88  CP-OB-OFFLINE-RESERVED          VALUE 'B'.            CL**2
  1890           88  CP-CRITICAL-PERIOD              VALUE 'C'.            CL**2
  1891           88  CP-TERM-IS-DAYS                 VALUE 'D'.            CL**2
  1892           88  CP-USE-PREM-AS-ENTERED          VALUE 'E'.            CL**2
  1893           88  CP-FARM-PLAN                    VALUE 'F'.            CL**2
  1894           88  CP-RATE-AS-STANDARD             VALUE 'G'.            CL**2
  1895           88  CP-2-MTH-INTEREST               VALUE 'I'.            CL**2
  1896           88  CP-3-MTH-INTEREST               VALUE 'J'.            CL**2
  1897           88  CP-4-MTH-INTEREST               VALUE 'K'.            CL**2
  1898           88  CP-BALLOON-LAST-PMT             VALUE 'L'.            CL**2
  1899           88  CP-MORTGAGE-REC                 VALUE 'M'.            CL**2
  1900           88  CP-OUTSTANDING-BALANCE          VALUE 'O'.            CL**2
  1901           88  CP-NET-PAY-PRUDENTIAL           VALUE 'P'.            CL**2
  1902           88  CP-NET-PAY-SIMPLE               VALUE 'S'.            CL**2
  1903           88  CP-TRUNCATED-LIFE               VALUE 'T' 'U' 'V'     CL**2
  1904                                                     'W' 'X'.        CL**2
  1905           88  CP-TRUNCATE-0-MTH               VALUE 'T'.            CL**2
  1906           88  CP-TRUNCATE-1-MTH               VALUE 'U'.            CL**2
  1907           88  CP-TRUNCATE-2-MTH               VALUE 'V'.            CL**2
  1908           88  CP-TRUNCATE-3-MTH               VALUE 'W'.            CL**2
  1909           88  CP-TRUNCATE-4-MTH               VALUE 'X'.            CL**2
  1910           88  CP-SUMMARY-REC                  VALUE 'Z'.            CL**2
  1911           88  CP-PROPERTY-BENEFIT             VALUE '2'.            CL**2
  1912           88  CP-UNEMPLOYMENT-BENEFIT         VALUE '3'.            CL**2
  1913           88  CP-AD-D-BENEFIT                 VALUE '4'.            CL**2
  1914           88  CP-CSL-METH-1                   VALUE '5'.            CL**2
  1915           88  CP-CSL-METH-2                   VALUE '6'.            CL**2
  1916           88  CP-CSL-METH-3                   VALUE '7'.            CL**2
  1917           88  CP-CSL-METH-4                   VALUE '8'.            CL**2
  1918                                                                     CL**2
  1919         16  CP-LOAN-TERM          PIC S9(3)       VALUE ZERO        CL**2
  1920                                     COMP-3.                         CL**2
  1921         16  CP-CLASS-CODE         PIC XX          VALUE ZERO.       CL**2
  1922         16  CP-DEVIATION-CODE     PIC XXX         VALUE ZERO.       CL**2
  1923         16  CP-STATE              PIC XX          VALUE SPACE.      CL**2
  1924         16  CP-STATE-STD-ABBRV    PIC XX          VALUE SPACE.      CL**2
  1925         16  CP-BENEFIT-CD         PIC XX          VALUE ZERO.       CL**2
  1926           88  CP-CSL-VALID-NP-BENEFIT-CD VALUES '12' '13'           CL**2
  1927               '34' '35' '36' '37' '44' '45' '46' '47' '72' '73'.    CL**2
  1928         16  CP-R78-OPTION         PIC X.                            CL**2
  1929           88  CP-TERM-TIMES-TERM-PLUS-1           VALUE ' '.        CL**2
  1930           88  CP-TERM-TIMES-TERM                  VALUE '1'.        CL**2
  1931                                                                     CL**2
  1932         16  CP-COMPANY-CD         PIC X             VALUE SPACE.    CL**2
  1933         16  CP-IBNR-RESERVE-SW    PIC X.                            CL**2
  1934         16  CP-CLAIM-STATUS       PIC X.                            CL**2
  1935         16  CP-RATE-FILE          PIC X.                            CL**2
  1936         16  CP-TERM-OR-EXT-DAYS   PIC S9(05)        VALUE ZERO      CL**2
  1937                                     COMP-3.                         CL**2
  1938                                                                     CL**2
  1939         16  CP-LIFE-OVERRIDE-CODE PIC X.                            CL**2
  1940         16  CP-AH-OVERRIDE-CODE   PIC X.                            CL**2
  1941                                                                     CL**2
  1942         16  CP-RATE-DEV-PCT       PIC S9V9(6)       VALUE ZERO      CL**2
  1943                                     COMP-3.
  1944         16  CP-CLP-RATE-UP        REDEFINES CP-RATE-DEV-PCT
  1945                                   PIC S9(5)V99 COMP-3.
  1946         16  CP-CRITICAL-MONTHS    PIC S9(3)         VALUE ZERO      CL**2
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  39
* ECS026.cbl (/apps/prod/cid1p/copy/ELCCALC)
  1947                                     COMP-3.                         CL**2
  1948         16  CP-ALTERNATE-BENEFIT  PIC S9(9)V99      VALUE ZERO      CL**2
  1949                                     COMP-3.                         CL**2
  1950         16  CP-ALTERNATE-PREMIUM  PIC S9(7)V99      VALUE ZERO      CL**2
  1951                                     COMP-3.
  1952         16  CP-DDF-CSO-ADMIN-FEE REDEFINES CP-ALTERNATE-PREMIUM
  1953                                  PIC S9(7)V99 COMP-3.
  1954                                                                     CL**2
  1955         16  CP-PAID-FROM-DATE     PIC X(02).                        CL**2
  1956         16  CP-CLAIM-CALC-METHOD  PIC X(01).                        CL**2
  1957         16  CP-EXT-DAYS-CALC      PIC X.                            CL**2
  1958           88  CP-EXT-NO-CHG                   VALUE ' '.            CL**2
  1959           88  CP-EXT-CHG-LF                   VALUE '1'.            CL**2
  1960           88  CP-EXT-CHG-AH                   VALUE '2'.            CL**2
  1961           88  CP-EXT-CHG-LF-AH                VALUE '3'.            CL**2
  1962         16  CP-DOMICILE-STATE     PIC XX.                           CL**2
  1963         16  CP-CARRIER            PIC X.                            CL**2
  1964         16  CP-REIN-FLAG          PIC X.                            CL**2
  1965         16  CP-REM-TRM-CALC-OPTION PIC X.                           CL**2
  1966           88  VALID-REM-TRM-CALC-OPTION    VALUE '1'                CL**2
  1967                      '2' '3' '4' '5'.                               CL**2
  1968           88  CP-CALC-OPTION-DEFAULT       VALUE '4'.               CL**2
  1969           88  CP-CONSIDER-EXTENSION        VALUE '3' '4' '5'.       CL**2
  1970           88  CP-30-DAY-MONTH              VALUE '1' '3' '5'.       CL**2
  1971           88  CP-NO-EXT-30-DAY-MONTH       VALUE '1'.               CL**2
  1972           88  CP-NO-EXT-ACTUAL-DAYS        VALUE '2'.               CL**2
  1973           88  CP-EXT-30-DAY-MONTH          VALUE '3'.               CL**2
  1974           88  CP-EXT-ACTUAL-DAYS           VALUE '4'.               CL**2
  1975           88  CP-USE-EXP-AND-1ST-PMT       VALUE '5'.
  1976         16  CP-SIG-SWITCH         PIC X.                            CL**2
  1977         16  CP-RATING-METHOD      PIC X.                            CL**2
  1978           88  CP-RATE-AS-R78                      VALUE '1' 'R'.    CL**2
  1979           88  CP-RATE-AS-PRORATA                  VALUE '2' 'P'.    CL**2
  1980           88  CP-RATE-AS-CALIF                    VALUE '3' 'C'.    CL**2
  1981           88  CP-RATE-AS-TEXAS                    VALUE '4' 'T'.    CL**2
  1982           88  CP-RATE-AS-FARM-PLAN                VALUE '4' 'T'.    CL**2
  1983           88  CP-RATE-AS-NET-PAY                  VALUE '5' 'N'.    CL**2
  1984           88  CP-RATE-AS-ANTICIPATION             VALUE '6' 'A'.    CL**2
  1985           88  CP-RATE-AS-MEAN                     VALUE '8' 'M'.    CL**2
  1986           88  CP-RATE-AS-REG-BALLOON              VALUE 'B'.        CL**2
  1987         16  CP-SALES-TAX          PIC S9V9999     VALUE  ZEROS      CL**2
  1988                                     COMP-3.                         CL**2
  1989         16  CP-BEN-CATEGORY       PIC X.
  1990         16  CP-DCC-LF-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  1991         16  CP-DCC-ACT-COMM REDEFINES CP-DCC-LF-RATE
  1992                                   PIC S99V9(5) COMP-3.
  1993         16  CP-DCC-AH-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  1994         16  CP-DCC-PMF-COMM REDEFINES CP-DCC-AH-RATE
  1995                                   PIC S99V9(5) COMP-3.
  1996         16  CP-DAYS-TO-1ST-PMT    PIC S999     COMP-3 VALUE +0.
  1997         16  CP-AH-BALLOON-SW      PIC X  VALUE ' '.
  1998         16  CP-EXPIRE-DT          PIC XX.
  1999         16  CP-LF-CLAIM-CALC-SW   PIC X  VALUE ' '.
  2000         16  CP-DDF-HI-FACT        PIC S9V999   COMP-3 VALUE +0.
  2001         16  CP-DDF-LO-FACT        PIC S9V999   COMP-3 VALUE +0.
  2002         16  CP-DDF-CLP            PIC S9(5)V99 COMP-3 VALUE +0.
  2003         16  CP-DDF-SPEC-CALC      PIC X.
  2004             88  CP-CALC-GROSS-FEE        VALUE 'G'.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  40
* ECS026.cbl (/apps/prod/cid1p/copy/ELCCALC)
  2005             88  CP-CALC-CLP              VALUE 'C'.
  2006         16  CP-IU-RATE-UP         PIC S9(5)V99   COMP-3 VALUE +0.
  2007         16  CP-CANCEL-REASON      PIC X.
  2008         16  CP-DDF-ADMIN-FEES     PIC S9(5)V99 COMP-3 VALUE +0.
  2009         16  CP-PMT-MODE           PIC X.
  2010         16  CP-NO-OF-PMTS         PIC S999 COMP-3 VALUE +0.
  2011         16  CP-1ST-YR-ALLOW       PIC S999V99 COMP-3 VALUE +0.
  2012         16  CP-DDF-COMM-AND-MFEE  PIC S9(5)V99 COMP-3 VALUE +0.
  2013         16  CP-DDF-YR1AF          PIC S9(5)V99 COMP-3 VALUE +0.
  2014         16  FILLER                PIC X.
  2015                                                                     CL**2
  2016***************    OUTPUT FROM ELRESV   ************************     CL**2
  2017                                                                     CL**2
  2018         16  CP-CDT-TABLE          PIC 9             VALUE ZERO.     CL**2
  2019                                                                     CL**2
  2020         16  CP-CDT-FACTOR         PIC S9(5)V9(6)    VALUE ZERO      CL**2
  2021                                     COMP-3.                         CL**2
  2022         16  CP-PTC-RESERVE        PIC S9(7)V99   VALUE ZERO         CL**2
  2023                                     COMP-3.                         CL**2
  2024         16  CP-IBNR-RESERVE       PIC S9(7)V99   VALUE ZERO         CL**2
  2025                                     COMP-3.                         CL**2
  2026         16  CP-FUTURE-RESERVE     PIC S9(7)V99   VALUE ZERO         CL**2
  2027                                     COMP-3.                         CL**2
  2028         16  FILLER                PIC X(09).                        CL**2
  2029***************    OUTPUT FROM ELRTRM   *************************    CL**2
  2030                                                                     CL**2
  2031         16  CP-REMAINING-TERM-1   PIC S9(4)V9    VALUE ZERO         CL**2
  2032                                     COMP-3.                         CL**2
  2033         16  CP-REMAINING-TERM-2   PIC S9(4)V9    VALUE ZERO         CL**2
  2034                                     COMP-3.                         CL**2
  2035         16  CP-REMAINING-TERM-3   PIC S9(4)V9    VALUE ZERO         CL**2
  2036                                     COMP-3.                         CL**2
  2037         16  CP-ODD-DAYS           PIC S9(3)      VALUE ZERO         CL**2
  2038                                     COMP-3.                         CL**2
  2039         16  FILLER                PIC X(12).                        CL**2
  2040                                                                     CL**2
  2041***************    OUTPUT FROM ELRAMT   *************************    CL**2
  2042                                                                     CL**2
  2043         16  CP-REMAINING-AMT      PIC S9(9)V99   VALUE ZERO         CL**2
  2044                                     COMP-3.                         CL**2
  2045         16  CP-REMAINING-AMT-PRV  PIC S9(9)V99   VALUE ZERO         CL**2
  2046                                     COMP-3.                         CL**2
  2047         16  FILLER                PIC X(12).                        CL**2
  2048                                                                     CL**2
  2049***************    OUTPUT FROM ELRATE   *************************    CL**2
  2050                                                                     CL**2
  2051         16  CP-CALC-PREMIUM       PIC S9(7)V99   VALUE ZERO         CL**2
  2052                                     COMP-3.                         CL**2
  2053         16  CP-PREMIUM-RATE       PIC S9(2)V9(5) VALUE ZERO         CL**2
  2054                                     COMP-3.                         CL**2
  2055         16  CP-MORTALITY-CODE     PIC X(4).                         CL**2
  2056         16  CP-RATE-EDIT-FLAG     PIC X.                            CL**2
  2057             88  CP-RATES-NEED-APR                  VALUE '1'.       CL**2
  2058         16  CP-COMPOSITE-RATE     PIC S99V999    VALUE ZERO         CL**2
  2059                                     COMP-3.                         CL**2
  2060         16  CP-POLICY-FEE         PIC S9(3)V99 VALUE +0 COMP-3.     CL**2
  2061         16  CP-LF-PREM            PIC S9(7)V99 VALUE +0 COMP-3.
  2062         16  CP-LF-BALLOON-PREM REDEFINES CP-LF-PREM
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  41
* ECS026.cbl (/apps/prod/cid1p/copy/ELCCALC)
  2063                                   PIC S9(7)V99 COMP-3.
  2064         16  FILLER                PIC X(07).                        CL**2
  2065                                                                     CL**2
  2066***************    OUTPUT FROM ELRFND   *************************    CL**2
  2067                                                                     CL**2
  2068         16  CP-CALC-REFUND        PIC S9(7)V99   VALUE ZERO         CL**2
  2069                                     COMP-3.                         CL**2
  2070         16  CP-REFUND-TYPE-USED   PIC X.                            CL**2
  2071           88  CP-R-AS-R78                         VALUE '1'.        CL**2
  2072           88  CP-R-AS-PRORATA                     VALUE '2'.        CL**2
  2073           88  CP-R-AS-CALIF                       VALUE '3'.        CL**2
  2074           88  CP-R-AS-TEXAS                       VALUE '4'.        CL**2
  2075           88  CP-R-AS-FARM-PLAN                   VALUE '4'.        CL**2
  2076           88  CP-R-AS-NET-PAY                     VALUE '5'.        CL**2
  2077           88  CP-R-AS-ANTICIPATION                VALUE '6'.        CL**2
  2078           88  CP-R-AS-MEAN                        VALUE '8'.        CL**2
  2079           88  CP-R-AS-SUM-OF-DIGITS               VALUE '9'.        CL**2
  2080           88  CP-R-AS-GAP-NON-REFUND              VALUE 'G'.
  2081           88  CP-R-AS-GAP-ACTUARIAL               VALUE 'S'.
  2082           88  CP-R-AS-SPP-DDF                     VALUE 'D'.
  2083           88  CP-R-AS-SPP-DDF-IU                  VALUE 'I'.
  2084           88  CP-R-AS-REPOSSESSION                VALUE 'R'.
  2085         16  FILLER                PIC X(12).                        CL**2
  2086                                                                     CL**2
  2087***************    OUTPUT FROM ELEARN   *************************    CL**2
  2088                                                                     CL**2
  2089         16  CP-R78-U-PRM          PIC S9(7)V99   VALUE ZERO         CL**2
  2090                                     COMP-3.                         CL**2
  2091         16  CP-R78-U-PRM-ALT      PIC S9(7)V99   VALUE ZERO         CL**2
  2092                                     COMP-3.                         CL**2
  2093         16  CP-PRORATA-U-PRM      PIC S9(7)V99   VALUE ZERO         CL**2
  2094                                     COMP-3.                         CL**2
  2095         16  CP-PRORATA-U-PRM-ALT  PIC S9(7)V99   VALUE ZERO         CL**2
  2096                                     COMP-3.                         CL**2
  2097         16  CP-STATE-U-PRM        PIC S9(7)V99   VALUE ZERO         CL**2
  2098                                     COMP-3.                         CL**2
  2099         16  CP-DOMICILE-U-PRM     PIC S9(7)V99   VALUE ZERO         CL**2
  2100                                     COMP-3.                         CL**2
  2101         16  CP-EARNING-TYPE-USED  PIC X.                            CL**2
  2102           88  CP-E-AS-SPECIAL                     VALUE 'S'.        CL**2
  2103           88  CP-E-AS-R78                         VALUE '1'.        CL**2
  2104           88  CP-E-AS-PRORATA                     VALUE '2'.        CL**2
  2105           88  CP-E-AS-TEXAS                       VALUE '4'.        CL**2
  2106           88  CP-E-AS-FARM-PLAN                   VALUE '4'.        CL**2
  2107           88  CP-E-AS-NET-PAY                     VALUE '5'.        CL**2
  2108           88  CP-E-AS-ANTICIPATION                VALUE '6'.        CL**2
  2109           88  CP-E-AS-MEAN                        VALUE '8'.        CL**2
  2110           88  CP-E-AS-SUM-OF-DIGITS               VALUE '9'.        CL**2
  2111         16  FILLER                PIC X(12).                        CL**2
  2112                                                                     CL**2
  2113***************    OUTPUT FROM ELPMNT   *************************    CL**2
  2114                                                                     CL**2
  2115         16  CP-ACTUAL-DAYS        PIC S9(05)     VALUE ZERO         CL**2
  2116                                     COMP-3.                         CL**2
  2117         16  CP-CLAIM-PAYMENT      PIC S9(7)V99   VALUE ZERO         CL**2
  2118                                     COMP-3.                         CL**2
  2119         16  FILLER                PIC X(12).                        CL**2
  2120                                                                     CL**2
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  42
* ECS026.cbl (/apps/prod/cid1p/copy/ELCCALC)
  2121***************   MISC WORK AREAS    *****************************   CL**2
  2122         16  CP-TOTAL-PAID         PIC S9(7)V99   VALUE ZERO         CL**2
  2123                                     COMP-3.                         CL**2
  2124         16  CP-R-MAX-ATT-AGE      PIC S9(3)      VALUE ZERO         CL**2
  2125                                     COMP-3.                         CL**2
  2126         16  CP-R-MAX-AGE          PIC S9(3)      VALUE ZERO         CL**2
  2127                                     COMP-3.                         CL**2
  2128         16  CP-R-MAX-TERM         PIC S9(5)      VALUE ZERO         CL**2
  2129                                     COMP-3.                         CL**2
  2130         16  CP-R-MAX-TOT-BEN      PIC S9(7)V99   VALUE ZERO         CL**2
  2131                                     COMP-3.                         CL**2
  2132         16  CP-R-MAX-MON-BEN      PIC S9(7)V99   VALUE ZERO         CL**2
  2133                                     COMP-3.                         CL**2
  2134         16  CP-IO-FUNCTION        PIC X          VALUE SPACE.       CL**2
  2135             88  OPEN-RATE-FILE                   VALUE 'O'.         CL**2
  2136             88  CLOSE-RATE-FILE                  VALUE 'C'.         CL**2
  2137             88  IO-ERROR                         VALUE 'E'.         CL**2
  2138                                                                     CL**2
  2139         16  CP-FIRST-PAY-DATE     PIC XX.                           CL**2
  2140                                                                     CL**2
  2141         16  CP-JOINT-INDICATOR    PIC X.                            CL**2
  2142                                                                     CL**2
  2143         16  CP-RESERVE-REMAINING-TERM                               CL**2
  2144                                   PIC S9(4)V9    VALUE ZERO         CL**2
  2145                                     COMP-3.                         CL**2
  2146                                                                     CL**2
  2147         16  CP-INSURED-BIRTH-DT   PIC XX.                           CL**2
  2148                                                                     CL**2
  2149         16  CP-INCURRED-AGE       PIC S9(3)      VALUE ZERO         CL**2
  2150                                     COMP-3.                         CL**2
  2151                                                                     CL**2
  2152         16  CP-MONTHLY-PAYMENT    PIC S9(5)V99   VALUE ZERO         CL**2
  2153                                     COMP-3.                         CL**2
  2154                                                                     CL**2
  2155         16  CP-RATING-BENEFIT-AMT PIC S9(9)V99   VALUE ZERO         CL**2
  2156                                     COMP-3.                         CL**2
  2157                                                                     CL**2
  2158         16  CP-ODD-DAYS-TO-PMT    PIC S9(3)      VALUE ZERO         CL**2
  2159                                     COMP-3.                         CL**2
  2160                                                                     CL**2
  2161         16  CP-MNTHS-TO-FIRST-PMT PIC S9(3)      VALUE ZERO         CL**2
  2162                                     COMP-3.                         CL**2
  2163                                                                     CL**2
  2164         16  CP-REMAMT-FACTOR      PIC S9(4)V9(9) VALUE ZEROS        CL**2
  2165                                     COMP-3.                         CL**2
  2166                                                                     CL**2
  2167         16  CP-FREE-LOOK          PIC S9(3)      VALUE ZERO         CL**2
  2168                                     COMP-3.                         CL**2
  2169                                                                     CL**2
  2170         16  CP-ROA-REFUND         PIC X          VALUE 'N'.         CL**2
  2171             88  CP-ROA-PREM-AT-REFUND            VALUE 'Y'.         CL**2
  2172                                                                     CL**2
  2173         16  CP-NET-BENEFIT-AMT    PIC S9(9)V99   VALUE ZERO         CL**2
  2174                                     COMP-3.                         CL**2
  2175         16  CP-SCNP-6MO-AMT       PIC S9(9)V99   VALUE ZERO
  2176                                     COMP-3.
  2177         16  CP-MONTH              PIC S999     COMP-3 VALUE +0.
  2178         16  cp-extra-periods      pic 9 value zeros.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  43
* ECS026.cbl (/apps/prod/cid1p/copy/ELCCALC)
  2179         16  cp-net-only-state     pic x value spaces.
  2180         16  FILLER                PIC X(13).                        CL**2
  2181******************************************************************   CL**2
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  44
* ECS026.cbl
* 2183                             COPY ECSRITAB.
  2184******************************************************************04/29/98
  2185*                                                                *ECSRITAB
  2186*                            ECSRITAB                            *   LV015
  2187*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL*15
  2188*                            VMOD=2.015                          *ECSRITAB
  2189*                                                                *ECSRITAB
  2190*  NO  CID  MODS  IN  COPYBOOK  ECSRITAB                         *ECSRITAB
  2191*                                                                *ECSRITAB
  2192******************************************************************ECSRITAB
  2193 01  REIN-WORK-AREAS.                                             ECSRITAB
  2194     12  RW-LFAMT                PIC S9(9)V99  VALUE +0   COMP-3. ECSRITAB
  2195     12  RW-AHWRK                PIC S9(9)V99  VALUE +0   COMP-3. ECSRITAB
  2196     12  RW-LFPRM                PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  2197     12  RW-LFPRMC               PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  2198     12  RW-LFRFND               PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  2199     12  RW-AHPRM                PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  2200     12  RW-AHPRMC               PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  2201     12  RW-AHRFND               PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  2202     12  RW-LFCLMWK              PIC S9(9)V99  VALUE +0   COMP-3. ECSRITAB
  2203     12  RW-AHCLMWK              PIC S9(9)V99  VALUE +0   COMP-3. ECSRITAB
  2204     12  RW-AH-INCURRED-DETAIL.                                   ECSRITAB
  2205         16  RW-AH-INCURRED-DATA OCCURS 5 TIMES.                  ECSRITAB
  2206             20  RW-AH-INCUR-DT  PIC 9(11) COMP-3.                   CL**2
  2207             20  RW-AH-CLM-AMT   PIC S9(9)V99             COMP-3. ECSRITAB
  2208             20  RW-AH-CLM-EXP   PIC S9(9)V99             COMP-3. ECSRITAB
  2209     12  RW-LFCLM                PIC S9(9)V99  VALUE +0   COMP-3. ECSRITAB
  2210     12  RW-AHCLM                PIC S9(9)V99  VALUE +0   COMP-3. ECSRITAB
  2211     12  RW-AH-LIMIT             PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  2212     12  RW-LFIBNR               PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  2213     12  RW-LFPAYCUR             PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  2214     12  RW-LFFUTRSV             PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  2215     12  RW-AHIBNR               PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  2216     12  RW-AHPAYCUR             PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  2217     12  RW-AHFUTRSV             PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  2218     12  RW-LFIBNRWK             PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  2219     12  RW-LFPAYCURWK           PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  2220     12  RW-LFFUTRSVWK           PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  2221     12  RW-AHIBNRWK             PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  2222     12  RW-AHPAYCURWK           PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  2223     12  RW-AHFUTRSVWK           PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  2224     12  RW-AHLIM-LO             PIC S9(9)V99  VALUE +0   COMP-3. ECSRITAB
  2225     12  RW-AHLIM-HI             PIC S9(9)V99  VALUE +0   COMP-3. ECSRITAB
  2226     12  RW-ACCUM-LF             PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  2227     12  RW-ACCUM-AH             PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  2228     12  RW-ACCUM-CLM            PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  2229     12  RW-ACCUM-IBNR           PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  2230     12  RW-ACCUM-PAYCUR         PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  2231     12  RW-ACCUM-FUTRSV         PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  2232                                                                  ECSRITAB
  2233 01  REIN-HOLD-AREAS.                                             ECSRITAB
  2234     12  REIN-LEVELS       OCCURS 30 TIMES.                       ECSRITAB
  2235         16  REIN-COMP               PIC X(6).                    ECSRITAB
  2236         16  REIN-LF-AH-FLGS.                                     ECSRITAB
  2237             20  REIN-LF-FLG         PIC X.                       ECSRITAB
  2238             20  REIN-AH-FLG         PIC X.                       ECSRITAB
  2239         16  REIN-WORK-FLDS.                                      ECSRITAB
  2240             20  REIN-LFAMT          PIC S9(9)V99   COMP-3.       ECSRITAB
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  45
* ECS026.cbl (/apps/prod/cid1p/copy/ECSRITAB)
  2241             20  REIN-LFPRM          PIC S9(7)V99   COMP-3.       ECSRITAB
  2242             20  REIN-AHAMT          PIC S9(7)V99   COMP-3.       ECSRITAB
  2243             20  REIN-AHPRM          PIC S9(7)V99   COMP-3.       ECSRITAB
  2244             20  REIN-LFRFND         PIC S9(7)V99   COMP-3.       ECSRITAB
  2245             20  REIN-AHRFND         PIC S9(7)V99   COMP-3.       ECSRITAB
  2246             20  REIN-LFCLM          PIC S9(9)V99   COMP-3.       ECSRITAB
  2247             20  REIN-AHCLM          PIC S9(9)V99   COMP-3.       ECSRITAB
  2248             20  REIN-LFCLML         PIC S9(9)V99   COMP-3.       ECSRITAB
  2249             20  REIN-AHCLML         PIC S9(9)V99   COMP-3.       ECSRITAB
  2250             20  REIN-DIS-IBNR       PIC S9(7)V99   COMP-3.       ECSRITAB
  2251             20  REIN-DIS-PAYCUR     PIC S9(7)V99   COMP-3.       ECSRITAB
  2252             20  REIN-DIS-FUTRSV     PIC S9(7)V99   COMP-3.       ECSRITAB
  2253             20  REIN-DIS-IBNRL      PIC S9(7)V99   COMP-3.       ECSRITAB
  2254             20  REIN-DIS-PAYCURL    PIC S9(7)V99   COMP-3.       ECSRITAB
  2255             20  REIN-DIS-FUTRSVL    PIC S9(7)V99   COMP-3.       ECSRITAB
  2256             20  REIN-DTH-IBNR       PIC S9(7)V99   COMP-3.       ECSRITAB
  2257             20  REIN-DTH-PAYCUR     PIC S9(7)V99   COMP-3.       ECSRITAB
  2258             20  REIN-DTH-FUTRSV     PIC S9(7)V99   COMP-3.       ECSRITAB
  2259             20  REIN-DTH-IBNRL      PIC S9(7)V99   COMP-3.       ECSRITAB
  2260             20  REIN-DTH-PAYCURL    PIC S9(7)V99   COMP-3.       ECSRITAB
  2261             20  REIN-DTH-FUTRSVL    PIC S9(7)V99   COMP-3.       ECSRITAB
  2262             20  REIN-AH-LIMIT       PIC S9(7)V99   COMP-3.       ECSRITAB
  2263             20  REIN-REM-SW         PIC X.                       ECSRITAB
  2264             20  REIN-REM-AH-100     PIC X.                       ECSRITAB
  2265             20  REIN-EP-STOP-DATE   PIC 9(11)      COMP-3.          CL**4
  2266             20  REIN-LF-RUNOFF-SW   PIC X.                       ECSRITAB
  2267             20  REIN-AH-RUNOFF-SW   PIC X.                       ECSRITAB
  2268     12  REIN-LEVELS-END             PIC X(6).                    ECSRITAB
  2269                                                                  ECSRITAB
  2270     12  RWF-FIELDS.                                              ECSRITAB
  2271         16  RWF-LFAMT               PIC S9(9)V99   COMP-3.       ECSRITAB
  2272         16  RWF-LFPRM               PIC S9(7)V99   COMP-3.       ECSRITAB
  2273         16  RWF-AHAMT               PIC S9(7)V99   COMP-3.       ECSRITAB
  2274         16  RWF-AHPRM               PIC S9(7)V99   COMP-3.       ECSRITAB
  2275         16  RWF-LFRFND              PIC S9(7)V99   COMP-3.       ECSRITAB
  2276         16  RWF-AHRFND              PIC S9(7)V99   COMP-3.       ECSRITAB
  2277         16  RWF-LFCLM               PIC S9(9)V99   COMP-3.       ECSRITAB
  2278         16  RWF-AHCLM               PIC S9(9)V99   COMP-3.       ECSRITAB
  2279         16  RWF-LFCLML              PIC S9(9)V99   COMP-3.       ECSRITAB
  2280         16  RWF-AHCLML              PIC S9(9)V99   COMP-3.       ECSRITAB
  2281         16  RWF-DIS-IBNR            PIC S9(7)V99   COMP-3.       ECSRITAB
  2282         16  RWF-DIS-PAYCUR          PIC S9(7)V99   COMP-3.       ECSRITAB
  2283         16  RWF-DIS-FUTRSV          PIC S9(7)V99   COMP-3.       ECSRITAB
  2284         16  RWF-DIS-IBNRL           PIC S9(7)V99   COMP-3.       ECSRITAB
  2285         16  RWF-DIS-PAYCURL         PIC S9(7)V99   COMP-3.       ECSRITAB
  2286         16  RWF-DIS-FUTRSVL         PIC S9(7)V99   COMP-3.       ECSRITAB
  2287         16  RWF-DTH-IBNR            PIC S9(7)V99   COMP-3.       ECSRITAB
  2288         16  RWF-DTH-PAYCUR          PIC S9(7)V99   COMP-3.       ECSRITAB
  2289         16  RWF-DTH-FUTRSV          PIC S9(7)V99   COMP-3.       ECSRITAB
  2290         16  RWF-DTH-IBNRL           PIC S9(7)V99   COMP-3.       ECSRITAB
  2291         16  RWF-DTH-PAYCURL         PIC S9(7)V99   COMP-3.       ECSRITAB
  2292         16  RWF-DTH-FUTRSVL         PIC S9(7)V99   COMP-3.       ECSRITAB
  2293         16  RWF-AH-LIMIT            PIC S9(7)V99   COMP-3.       ECSRITAB
  2294         16  RWF-REM-SW              PIC X.                       ECSRITAB
  2295         16  RWF-REM-AH-100          PIC X.                       ECSRITAB
  2296         16  RWF-EP-STOP-DATE        PIC 9(11)      COMP-3.          CL**3
  2297         16  RWF-LF-RUNOFF-SW        PIC X.                       ECSRITAB
  2298         16  RWF-AH-RUNOFF-SW        PIC X.                       ECSRITAB
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  46
* ECS026.cbl (/apps/prod/cid1p/copy/ECSRITAB)
  2299                                                                  ECSRITAB
  2300     12  WT-COMP-INFO.                                            ECSRITAB
  2301         16  WT-REI-COMP             PIC X(6).                    ECSRITAB
  2302         16  WT-LF-QC                PIC X.                       ECSRITAB
  2303         16  WT-AH-QC                PIC X.                       ECSRITAB
  2304         16  WT-LO-DATE              PIC 9(11)     COMP-3.           CL**2
  2305         16  WT-HI-DATE              PIC 9(11)     COMP-3.           CL**2
  2306         16  WT-LFAGE-LO             PIC 99.                      ECSRITAB
  2307         16  WT-LFAGE-HI             PIC 99.                      ECSRITAB
  2308         16  WT-AHAGE-LO             PIC 99.                      ECSRITAB
  2309         16  WT-AHAGE-HI             PIC 99.                      ECSRITAB
  2310         16  WT-LFTRM-LO             PIC S999       COMP-3.       ECSRITAB
  2311         16  WT-LFTRM-HI             PIC S999       COMP-3.       ECSRITAB
  2312         16  WT-AHTRM-LO             PIC S999       COMP-3.       ECSRITAB
  2313         16  WT-AHTRM-HI             PIC S999       COMP-3.       ECSRITAB
  2314         16  WT-LF-PCT               PIC S9V9999    COMP-3.       ECSRITAB
  2315         16  WT-AH-PCT               PIC S9V9999    COMP-3.       ECSRITAB
  2316         16  WT-LF-LIM-LO            PIC S9(9)V99   COMP-3.       ECSRITAB
  2317         16  WT-LF-LIM-HI            PIC S9(9)V99   COMP-3.       ECSRITAB
  2318         16  WT-LF-LO                PIC S9(9)V99   COMP-3.       ECSRITAB
  2319         16  WT-LF-HI                PIC S9(9)V99   COMP-3.       ECSRITAB
  2320         16  WT-AHBEN-LIM-LO         PIC S9(7)V99   COMP-3.       ECSRITAB
  2321         16  WT-AHBEN-LIM-HI         PIC S9(7)V99   COMP-3.       ECSRITAB
  2322         16  WT-AHBEN-LO             PIC S9(7)V99   COMP-3.       ECSRITAB
  2323         16  WT-AHBEN-HI             PIC S9(7)V99   COMP-3.       ECSRITAB
  2324         16  WT-AHMOA-LIM-LO         PIC S9(7)V99   COMP-3.       ECSRITAB
  2325         16  WT-AHMOA-LIM-HI         PIC S9(7)V99   COMP-3.       ECSRITAB
  2326         16  WT-AHMOA-LO             PIC S9(7)V99   COMP-3.       ECSRITAB
  2327         16  WT-AHMOA-HI             PIC S9(7)V99   COMP-3.       ECSRITAB
  2328         16  WT-LF-BEN-CODE          PIC X.                       ECSRITAB
  2329         16  WT-AH-BEN-CODE          PIC X.                       ECSRITAB
  2330         16  WT-INTERACTIVE          PIC X.                       ECSRITAB
  2331         16  WT-REMAINING            PIC X.                       ECSRITAB
  2332         16  FILLER                  PIC X(21).                   ECSRITAB
  2333                                                                  ECSRITAB
  2334 01  REIN-MISC-WORK-FIELDS.                                       ECSRITAB
  2335     12  SUB1                    PIC S9(4)       COMP.            ECSRITAB
  2336     12  SUB2                    PIC S9(4)       COMP.            ECSRITAB
  2337     12  CO-SUB                  PIC S9(4)       COMP.            ECSRITAB
  2338     12  INC-SUB                 PIC S999        COMP.            ECSRITAB
  2339     12  MORTALITY-SUB           PIC S999        COMP.            ECSRITAB
  2340     12  REIN-FACTOR             PIC S99V9(7)  COMP-3   VALUE +0. ECSRITAB
  2341     12  REIN-CALCED-LIFE        PIC S9(7)V99  COMP-3   VALUE +0. ECSRITAB
  2342     12  REIN-CALCED-AH          PIC S9(7)V99  COMP-3   VALUE +0. ECSRITAB
  2343     12  REIN-RISK-AMOUNT        PIC S9(11)V99 COMP-3   VALUE +0. ECSRITAB
  2344     12  REIN-MONTH-REDUCE       PIC S9(7)V99  COMP-3   VALUE +0. ECSRITAB
  2345     12  REIN-CEDE-TERM          PIC S999V99   COMP-3   VALUE +0. ECSRITAB
  2346     12  REIN-WORKA              PIC S999      COMP-3   VALUE +0. ECSRITAB
  2347     12  REIN-EARN-LF-TERM       PIC S999      COMP-3   VALUE +0. ECSRITAB
  2348     12  REIN-EARN-AH-TERM       PIC S999      COMP-3   VALUE +0. ECSRITAB
  2349     12  REIN-LCNC-EARN-TERM     PIC S999      COMP-3   VALUE +0. ECSRITAB
  2350     12  REIN-ACNC-EARN-TERM     PIC S999      COMP-3   VALUE +0. ECSRITAB
  2351     12  REIN-LF-CLM-MONTHS      PIC S999      COMP-3   VALUE +0. ECSRITAB
  2352     12  REIN-AH-CLM-MONTHS      PIC S999      COMP-3   VALUE +0. ECSRITAB
  2353     12  REIN-AH-CLM-MTH-1       PIC S999      COMP-3   VALUE +0. ECSRITAB
  2354     12  REIN-AH-CLM-MTH-2       PIC S999      COMP-3   VALUE +0. ECSRITAB
  2355     12  REIN-AH-CLM-MTH-3       PIC S999      COMP-3   VALUE +0. ECSRITAB
  2356     12  REIN-AH-CLM-MTH-4       PIC S999      COMP-3   VALUE +0. ECSRITAB
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  47
* ECS026.cbl (/apps/prod/cid1p/copy/ECSRITAB)
  2357     12  REIN-AH-CLM-MTH-5       PIC S999      COMP-3   VALUE +0. ECSRITAB
  2358     12  REIN-AH-PRIOR-CLMS-PAID PIC S9(11)V99 COMP-3   VALUE +0. ECSRITAB
  2359                                                                  ECSRITAB
  2360     12  REIN-VOID-LF-SW         PIC X    VALUE ' '.              ECSRITAB
  2361         88  VOIDING-LF-CANCEL            VALUE '*'.              ECSRITAB
  2362     12  REIN-VOID-AH-SW         PIC X    VALUE ' '.              ECSRITAB
  2363         88  VOIDING-AH-CANCEL            VALUE '*'.              ECSRITAB
  2364     12  REIN-ADDL-LF-SW         PIC X    VALUE ' '.              ECSRITAB
  2365         88  ADDITIONAL-LF-CANCEL         VALUE '*'.              ECSRITAB
  2366     12  REIN-ADDL-AH-SW         PIC X    VALUE ' '.              ECSRITAB
  2367         88  ADDITIONAL-AH-CANCEL         VALUE '*'.              ECSRITAB
  2368     12  REIN-CANCEL-LF-SW       PIC X    VALUE ' '.              ECSRITAB
  2369         88  FLAT-CANCEL-LF               VALUE '*'.              ECSRITAB
  2370     12  REIN-CANCEL-AH-SW       PIC X    VALUE ' '.              ECSRITAB
  2371         88  FLAT-CANCEL-AH               VALUE '*'.              ECSRITAB
  2372                                                                  ECSRITAB
  2373     12  REIN-BEN-CODE           PIC X.                           ECSRITAB
  2374         88  CEDING-SINGLE-PREM-ONLY      VALUE 'A'.              ECSRITAB
  2375         88  CEDING-OUT-BALANCE-ONLY      VALUE 'B'.              ECSRITAB
  2376         88  CEDING-REDUCING-ONLY         VALUE 'C'  'F'.         ECSRITAB
  2377         88  CEDING-LEVEL-ONLY            VALUE 'D'  'E'.         ECSRITAB
  2378         88  CEDING-GROUP-ONLY            VALUE 'G'.              ECSRITAB
  2379         88  CEDING-GROUP-RED-LIFE-ONLY   VALUE 'H'.              ECSRITAB
  2380         88  CEDING-INDIVIDUAL-ONLY       VALUE 'I'.              ECSRITAB
  2381         88  CEDING-JOINT-ONLY            VALUE 'J'.              ECSRITAB
  2382         88  CEDING-SGL-PREM-REDUCING     VALUE 'K'.              ECSRITAB
  2383         88  CEDING-SGL-PREM-GROUP        VALUE 'L'.              ECSRITAB
  2384         88  CEDING-GROUP-LEVEL-ONLY      VALUE 'M'.              ECSRITAB
  2385         88  CEDING-SGL-PREM-GRP-REDUCING VALUE 'N'.              ECSRITAB
  2386         88  CEDING-SGL-PREM-GROUP-LEVEL  VALUE 'P'.              ECSRITAB
  2387         88  CEDING-GROUP-REDUCING-ONLY   VALUE 'R'.              ECSRITAB
  2388         88  CEDING-SINGLE-POLICIES-ONLY  VALUE 'S'.              ECSRITAB
  2389         88  CEDING-AH-ONLY               VALUE '1'.              ECSRITAB
  2390         88  CEDING-PROPERTY-ONLY         VALUE '2'.              ECSRITAB
  2391         88  CEDING-UNEMPLOYMENT-ONLY     VALUE '3'.              ECSRITAB
  2392         88  CEDING-AD-D-ONLY             VALUE '4'.              ECSRITAB
  2393         88  CEDING-LIFE-ONLY             VALUE '5'.              ECSRITAB
  2394         88  CEDING-DISMEMBERMENT-ONLY    VALUE '6'.              ECSRITAB
  2395         88  CEDING-7-DAY-RETRO           VALUE '7'.              ECSRITAB
  2396         88  CEDING-14-DAY-RETRO          VALUE '8'.              ECSRITAB
  2397     12  REIN-OPEN-SW            PIC X           VALUE SPACE.     ECSRITAB
  2398     12  REIN-SEARCH.                                             ECSRITAB
  2399         16  REIN-SRCH-COMP-CD   PIC X           VALUE SPACE.     ECSRITAB
  2400         16  REIN-SRCH-CODE      PIC X           VALUE SPACE.     ECSRITAB
  2401         16  REIN-SRCH           PIC XXX         VALUE SPACE.     ECSRITAB
  2402         16  FILLER              PIC XXX         VALUE LOW-VALUE. ECSRITAB
  2403     12  SAVE-REIN-SRCH          PIC XXX         VALUE SPACE.     ECSRITAB
  2404     12  REIN-BUS-FLAG           PIC X           VALUE SPACE.     ECSRITAB
  2405     12  RATE-WORK               PIC S9(8)V9(5)  COMP-3.          ECSRITAB
  2406     12  RATE-WORK-L             PIC S9(8)V9(5)  COMP-3.          ECSRITAB
  2407     12  RATE-WORK-A             PIC S9(8)V9(5)  COMP-3.          ECSRITAB
  2408     12  RS-LIFE-BEN             PIC S9(9)V99  COMP-3   VALUE +0. ECSRITAB
  2409     12  RS-LIFE-PREM            PIC S9(7)V99  COMP-3   VALUE +0. ECSRITAB
  2410     12  RS-AH-BEN               PIC S9(9)V99  COMP-3   VALUE +0. ECSRITAB
  2411     12  RS-AH-PREM              PIC S9(7)V99  COMP-3   VALUE +0. ECSRITAB
  2412     12  RS-LP-CALC              PIC S9(7)V99  COMP-3   VALUE +0. ECSRITAB
  2413     12  RS-AP-CALC              PIC S9(7)V99  COMP-3   VALUE +0. ECSRITAB
  2414     12  RS-R-LB                 PIC S9(9)V99  COMP-3   VALUE +0. ECSRITAB
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  48
* ECS026.cbl (/apps/prod/cid1p/copy/ECSRITAB)
  2415     12  RS-R-LP                 PIC S9(7)V99  COMP-3   VALUE +0. ECSRITAB
  2416     12  RS-R-AB                 PIC S9(9)V99  COMP-3   VALUE +0. ECSRITAB
  2417     12  RS-R-AP                 PIC S9(7)V99  COMP-3   VALUE +0. ECSRITAB
  2418     12  RS-R-LPC                PIC S9(7)V99  COMP-3   VALUE +0. ECSRITAB
  2419     12  RS-R-APC                PIC S9(7)V99  COMP-3   VALUE +0. ECSRITAB
  2420     12  BIN-RWF-EP-STOP-DT      PIC XX        VALUE SPACES.      ECSRITAB
  2421     12  BIN-CNT                 PIC 9(3)      VALUE ZEROES.      ECSRITAB
  2422     12  BIN-CR-DIS-DT           PIC XX        VALUE SPACES.      ECSRITAB
  2423     12  BIN-WT-HIGH-DT          PIC XX        VALUE SPACES.      ECSRITAB
  2424     12  BIN-WT-LO-DT            PIC XX        VALUE SPACES.      ECSRITAB
  2425     12  BIN-LF-CANC-DT          PIC XX        VALUE SPACES.      ECSRITAB
  2426     12  BIN-AH-CANC-DT          PIC XX        VALUE SPACES.      ECSRITAB
  2427     12  BIN-CR-DTH-DT           PIC XX        VALUE SPACES.      ECSRITAB
  2428                                                                  ECSRITAB
  2429 01  REIN-CO-HOLD-TABLE.                                          ECSRITAB
  2430* ELCPSEVR MUST BE MODIFIED IF THE "OCCURS" IS CHANGED.           ECSRITAB
  2431     12  REIN-CO-HOLD-ENTRIES  OCCURS 1500 TIMES.                 ECSRITAB
  2432         16  RCT-REIN-CO         PIC X(6).                        ECSRITAB
  2433         16  RCT-CLM-CUTOFF-DT   PIC 9(11)  COMP-3.               ECSRITAB
  2434         16  RCT-EARNING-START-DT PIC 9(11)  COMP-3.              ECSRITAB
  2435         16  RCT-EARNING-STOP-DT PIC 9(11)  COMP-3.               ECSRITAB
  2436         16  RCT-EARN-STOP-CODE  PIC X.                           ECSRITAB
  2437         16  RCT-LF-CLM-PCT      PIC S9V9(4)    COMP-3.           ECSRITAB
  2438         16  RCT-LF-CLM-MAX      PIC S9(9)V99   COMP-3.           ECSRITAB
  2439         16  RCT-AH-CLM-PCT      PIC S9V9(4)    COMP-3.           ECSRITAB
  2440         16  RCT-AH-CLM-MAX      PIC S9(9)V99   COMP-3.           ECSRITAB
  2441                                                                  ECSRITAB
  2442 01  REIN-CO-HOLD-TABLE-2.                                        ECSRITAB
  2443     12  RC2-CO-HOLD-ENTRIES  OCCURS 1500 TIMES.                  ECSRITAB
  2444         16  RC2-REIN-CO.                                         ECSRITAB
  2445             20  RC2-CO-PRIME    PIC XXX.                         ECSRITAB
  2446             20  RC2-CO-SUB      PIC XXX.                         ECSRITAB
  2447         16  RC2-LF-R78-PCT      PIC S9V9(4)    COMP-3.           ECSRITAB
  2448         16  RC2-LF-PRO-PCT      PIC S9V9(4)    COMP-3.           ECSRITAB
  2449         16  RC2-AH-R78-PCT      PIC S9V9(4)    COMP-3.           ECSRITAB
  2450         16  RC2-AH-PRO-PCT      PIC S9V9(4)    COMP-3.           ECSRITAB
  2451         16  RC2-CO-NAME         PIC X(30).                       ECSRITAB
  2452         16  RC2-ECS152-RPT      PIC X.                           ECSRITAB
  2453                                                                  ECSRITAB
  2454 01  REIN-MORT-CD-HOLD-TABLE.                                     ECSRITAB
  2455     12  REIN-MORT-CD-ENTRIES  OCCURS 1500 TIMES.                 ECSRITAB
  2456         16  RCT-MORT-CO         PIC X(6).                        ECSRITAB
  2457         16  RCT-MORT-CODE       PIC X(4).                        ECSRITAB
  2458     12  REIN-INDEX              PIC S9(4)    COMP    VALUE +0.   ECSRITAB
  2459                                                                  ECSRITAB
  2460 01  BIN-RCT-ITEMS-TABLE.                                         ECSRITAB
  2461     12  BIN-RCT-ITEMS OCCURS 1500 TIMES.                         ECSRITAB
  2462         16  BIN-RCT-CLM-CUTOFF-DT    PIC XX.                     ECSRITAB
  2463         16  BIN-RCT-EARNING-START-DT PIC XX.                     ECSRITAB
  2464         16  BIN-RCT-EARNING-STOP-DT  PIC XX.                     ECSRITAB
  2465 01  BIN-RW-ITEMS-TABLE.                                          ECSRITAB
  2466     12  BIN-RW-ITEMS OCCURS 5 TIMES.                             ECSRITAB
  2467         16  BIN-RW-AH-INCUR-DT       PIC XX.                     ECSRITAB
  2468                                                                  ECSRITAB
  2469 01  REIN-CO-TABLE-ENT-CNT       PIC S9(4)    COMP-3  VALUE +1500.ECSRITAB
  2470******************************************************************ECSRITAB
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  49
* ECS026.cbl
  2472 01  MISC-WORK-AREAS.
  2473     12  WORK-ACC-NO         PIC X(10).
  2474     12  LAST-SWR-CONTROL    PIC X(20)          VALUE LOW-VALUES.
  2475     12  LAST-SWR-CONTROL-R REDEFINES LAST-SWR-CONTROL.
  2476         16  LSC-REC-TYPE    PIC X.
  2477         16  LSC-CARR        PIC X.
  2478         16  LSC-GROUP       PIC X(6).
  2479         16  LSC-STATE       PIC XX.
  2480         16  LSC-ACCOUNT     PIC X(10).
  2481*            66  LSC-RPT-CODE  RENAMES  LSC-ACCOUNT.
  2482     12  SAVE-ACCT-NAME      PIC X(30).
  2483     12  SAVE-REIN-NAME      PIC X(30).
  2484     12  LAST-SWR2-CONTROL   PIC X(4)           VALUE LOW-VALUES.
  2485     12  LAST-SWR2-CONTROL-R  REDEFINES LAST-SWR2-CONTROL.
  2486         16  LSC2-REIN-COMP  PIC XXX.
  2487         16  LSC2-CARR       PIC X.
  2488     12  CLM-INCUR-REIN-DATE PIC 9(06)           VALUE ZEROS.
  2489     12  CLM-INCUR-REIN-DATE-R  REDEFINES CLM-INCUR-REIN-DATE.
  2490         16  CIRD-CCYY       PIC 9(04).
  2491         16  CIRD-CCYR  REDEFINES CIRD-CCYY.
  2492             20  CIRD-CC     PIC 99.
  2493             20  CIRD-YR     PIC 99.
  2494         16  CIRD-MO         PIC 99.
  2495     12  INCURRED-DATE.
  2496         16  DTO-CC          PIC 99             VALUE ZEROS.
  2497         16  DTO-YR          PIC 99             VALUE ZEROS.
  2498         16  DTO-MO          PIC 99             VALUE ZEROS.
  2499     12  PROCESS-OPT-FROM-DT PIC 9(06)          VALUE ZEROS.
  2500     12  PROCESS-OPT-FROM-DT-R REDEFINES  PROCESS-OPT-FROM-DT.
  2501         16  POF-CCYY        PIC 9(04).
  2502         16  POF-CCYR REDEFINES POF-CCYY.
  2503             20  POF-CC      PIC 99.
  2504             20  POF-YR      PIC 99.
  2505         16  POF-MO          PIC 99.
  2506     12  PROCESS-OPT-THRU-DT PIC 9(06)          VALUE ZEROS.
  2507     12  PROCESS-OPT-THRU-DT-R REDEFINES  PROCESS-OPT-THRU-DT.
  2508         16  POT-CCYY        PIC 9(04).
  2509         16  POT-CCYR  REDEFINES POT-CCYY.
  2510             20  POT-CC      PIC 99.
  2511             20  POT-YR      PIC 99.
  2512         16  POT-MO          PIC 99.
  2513     12  CERT-ISSUE-DATE     PIC 9(06)          VALUE ZEROS.
  2514     12  CERT-ISSUE-DATE-R REDEFINES CERT-ISSUE-DATE.
  2515         16  CID-CCYY        PIC 9(04).
  2516         16  CID-CCYR  REDEFINES CID-CCYY.
  2517             20  CID-CC      PIC 99.
  2518             20  CID-YR      PIC 99.
  2519         16  CID-MO          PIC 99.
  2520     12  EOM-RUN-DATE        PIC 9(11)          VALUE ZEROS.
  2521     12  EOM-RUN-DATE-R REDEFINES EOM-RUN-DATE.
  2522         16  FILLER          PIC 999.
  2523         16  EOM-CC          PIC 99.
  2524         16  EOM-YR          PIC 99.
  2525         16  EOM-MO          PIC 99.
  2526         16  EOM-DA          PIC 99.
  2527     12  BIN-EOM-DT          PIC XX             VALUE SPACE.
  2528     12  VALUATION-DT        PIC 9(11)          VALUE ZEROS.
  2529     12  VALUATION-DT-R REDEFINES VALUATION-DT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  50
* ECS026.cbl
  2530         16  FILLER          PIC 999.
  2531         16  VAL-CC          PIC 99.
  2532         16  VAL-YR          PIC 99.
  2533         16  VAL-MO          PIC 99.
  2534         16  VAL-DA          PIC 99.
  2535     12  BIN-VALUATION-DT    PIC XX.
  2536     12  WK-BREAK-TYPE       PIC X.
  2537         88  ACCOUNT-BREAK                      VALUE '1'.
  2538         88  STATE-BREAK                        VALUE '2'.
  2539         88  GROUP-BREAK                        VALUE '3'.
  2540         88  CARRIER-BREAK                      VALUE '4'.
  2541     12  WS-CR-BIN-DATE      PIC XX             VALUE SPACES.
  2542     12  CURR-CARR           PIC X              VALUE SPACES.
  2543     12  CURR-ACCT           PIC X(10)          VALUE SPACES.
  2544     12  CURR-STATE          PIC XX             VALUE SPACES.
  2545     12  CURR-GRP            PIC X(6)           VALUE SPACES.
  2546     12  CURR-REPORT-CODE-1  PIC X(10)          VALUE SPACES.
  2547     12  CURR-REPORT-CODE-2  PIC X(10)          VALUE SPACES.
  2548     12  CURR-REIN-COMP      PIC XXX            VALUE SPACES.
  2549     12  WS-PRINT-RPT-B      PIC X              VALUE 'N'.
  2550     12  WS-PRINT-RPT-C      PIC X              VALUE 'N'.
  2551     12  PREV-CARR           PIC X              VALUE SPACES.
  2552     12  PREV-ACCT           PIC X(10)          VALUE SPACES.
  2553     12  PREV-STATE          PIC XX             VALUE SPACES.
  2554     12  PREV-GRP            PIC X(6)           VALUE SPACES.
  2555     12  PREV-REPORT-CODE-1  PIC X(10)          VALUE SPACES.
  2556     12  PREV-REPORT-CODE-2  PIC X(10)          VALUE SPACES.
  2557     12  PREV-REIN-COMP      PIC XXX            VALUE SPACES.
  2558     12  PREV-REINS-TABLE    PIC XXX            VALUE SPACES.
  2559     12  WK-RPT-CODE         PIC X              VALUE SPACES.
  2560     12  WK-DTE-OPT          PIC X              VALUE SPACES.
  2561     12  TEMP-1              PIC S9(5)V99 COMP-3 VALUE +0.
  2562     12  TEMP-2              PIC S9(5)V99 COMP-3 VALUE +0.
  2563     12  TEMP-3              PIC S9(5)V99 COMP-3 VALUE +0.
  2564     12  TEMP-4              PIC S9V9(6)  COMP-3 VALUE +0.
  2565     12  TEMP-5              PIC S9V9(6)  COMP-3 VALUE +0.
  2566     12  TEMP-6              PIC S99V9(6) COMP-3 VALUE +0.
  2567     12  TEMP-7              PIC S9(9)V99 COMP-3 VALUE +0.
  2568     12  TEMP-8              PIC S9(9)V99 COMP-3 VALUE +0.
  2569     12  REM-TRM1            PIC S999V99  COMP-3.
  2570     12  REM-TRM2            PIC S999V99  COMP-3.
  2571     12  REM-TRM3            PIC S999V99  COMP-3.
  2572     12  TEM-TRM1            PIC S999V99  COMP-3.
  2573     12  ORIG-TERM           PIC S999V99  COMP-3.
  2574     12  WS-RE-CNT           PIC S9999    COMP-3 VALUE +0.
  2575     12  STATUTORY-SWITCH    PIC X               VALUE SPACE.
  2576         88 STATUTORY-REQUIREMENT                VALUE '*'.
  2577
  2578 01  MISC-COMP-3-AREAS   COMP-3.
  2579     12  FLA-CLM-REIN-BASE   PIC S9(9)V99         VALUE +0.
  2580     12  ADJ-FLA-REIN-BASE   PIC S9(9)V9(4)       VALUE +0.
  2581     12  ROUND-UP-DOLLARS    PIC S9(9)            VALUE +0.
  2582     12  NET-PREMIUM         PIC S9(9)V99         VALUE +0.
  2583     12  UNEARNED-PREMIUM    PIC S9(5)V99         VALUE +0.
  2584     12  EARNED-PREMIUM      PIC S9(5)V99         VALUE +0.
  2585     12  PER-DAY-BENEFIT     PIC S9(5)V9(5)       VALUE +0.
  2586     12  AH-TOTAL-AMT        PIC S9(7)V99         VALUE +0.
  2587     12  LF-EPR-R78          PIC S9(7)V99         VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  51
* ECS026.cbl
  2588     12  LF-EPR-PRO          PIC S9(7)V99         VALUE +0.
  2589     12  LF-EPR-ST           PIC S9(7)V99         VALUE +0.
  2590     12  AH-EPR-R78          PIC S9(7)V99         VALUE +0.
  2591     12  AH-EPR-PRO          PIC S9(7)V99         VALUE +0.
  2592     12  AH-EPR-ST           PIC S9(7)V99         VALUE +0.
  2593     12  SAVE-LF-EPR-R78     PIC S9(7)V99         VALUE +0.
  2594     12  SAVE-LF-EPR-PRO     PIC S9(7)V99         VALUE +0.
  2595     12  SAVE-AH-EPR-R78     PIC S9(7)V99         VALUE +0.
  2596     12  SAVE-AH-EPR-PRO     PIC S9(7)V99         VALUE +0.
  2597     12  WS-FAC              PIC S9V9999          VALUE +0.
  2598     12  WS-PRO              PIC S9V9999          VALUE +0.
  2599     12  WS-R78              PIC S9V9999          VALUE +0.
  2600     12  LF-R78              PIC S9V9999          VALUE +0.
  2601     12  AH-R78              PIC S9V9999          VALUE +0.
  2602     12  LF-PRO              PIC S9V9999          VALUE +0.
  2603     12  AH-PRO              PIC S9V9999          VALUE +0.
  2604     12  NO-DAYS-THIS-CERT   PIC S9(9)            VALUE +0.
  2605     12  WORK-AREA-FOR-ACCUMULATOR.
  2606         16  WA-FACE-BEN     PIC S9(13)V99        VALUE +0.
  2607         16  WA-ISS-PRM      PIC S9(9)V99         VALUE +0.
  2608         16  WA-CNC-PRM      PIC S9(9)V99         VALUE +0.
  2609         16  WA-EARNED-PRM   PIC S9(9)V99         VALUE +0.
  2610         16  WA-CLAIM-AMT    PIC S9(9)V99         VALUE +0.
  2611         16  WA-CERT-COUNT   PIC S9(7)            VALUE +0.
  2612         16  WA-CLAIM-COUNT  PIC S9(9)            VALUE +0.
  2613         16  WA-NUMBER-DAYS  PIC S9(9)            VALUE +0.
  2614         16  WA-CRT-W-CLM    PIC S9(9)            VALUE +0.
  2615     12  REMAINING-TERM-WORK-AREAS.
  2616         16  LF-REM-TRM      PIC S999V99          VALUE +0.
  2617         16  AH-REM-TRM      PIC S999V99          VALUE +0.
  2618 01  EARNED-PREM-AREAS.
  2619     12  WE-REIN-CO          PIC X(6).
  2620     12  WE-LF-AH            PIC X.
  2621     12  WE-BEN-TYPE         PIC XX.
  2622     12  WE-LFAMT            PIC S9(9)V99    COMP-3.
  2623     12  WE-LFPRM            PIC S9(7)V99    COMP-3.
  2624     12  WE-LFAMT-ALT        PIC S9(9)V99    COMP-3.
  2625     12  WE-LFPRM-ALT        PIC S9(7)V99    COMP-3.
  2626     12  WE-LFRFND           PIC S9(7)V99    COMP-3.
  2627     12  WE-AHAMT            PIC S9(9)V99    COMP-3.
  2628     12  WE-AHPRM            PIC S9(7)V99    COMP-3.
  2629     12  WE-AHRFND           PIC S9(7)V99    COMP-3.
  2630 01  TEXAS-REG-WORK-AREAS   SYNC.
  2631     12  TEX-FACT-1          PIC S9(9)V99    COMP-3.
  2632     12  TEX-FACT-2          PIC S999        COMP-3.
  2633     12  TEX-FACT-3          PIC S999        COMP-3.
  2634     12  TEX-FACT-4          PIC S9(7)       COMP-3.
  2635     12  TEX-FACT-5          PIC S999        COMP-3.
  2636     12  TEX-FACT-6          PIC S999        COMP-3.
  2637     12  TEX-FACT-7          PIC S9(7)       COMP-3.
  2638     12  TEX-FACT-8          PIC S9V9(6)     COMP-3.
  2639     12  TEX-FACT-9          PIC S9(4)V9(11) COMP-3.
  2640
  2641 01  NET-PAY-INTERFACE.
  2642     12  NP-APR              PIC S999V9(4)   COMP-3.
  2643     12  NP-ORIG             PIC S999        COMP-3.
  2644     12  NP-REM              PIC S999        COMP-3.
  2645     12  NP-OPT              PIC X.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  52
* ECS026.cbl
  2646     12  NP-CAP              PIC S999        COMP-3.
  2647     12  NP-FACTOR           PIC S9(4)V9(9)  COMP-3.
  2648     12  NP-WORK1            PIC S9(9)V9(9)  COMP-3.
  2649     12  NP-WORK2            PIC S9(9)V9(9)  COMP-3.
  2650     12  NP-BENEFIT          PIC S9(9)V99    COMP-3.
  2651     12  NP-REMAINING        PIC S9(9)V99    COMP-3.
  2652     12  NP-AHPRM            PIC S9(7)V99    COMP-3.
  2653     12  NP-ACCOUNT          PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  53
* ECS026.cbl
  2655 01  ACCUMULATOR-TABLE   COMP-3.
  2656     12  AT-AMOUNTS-L-D    OCCURS 3 TIMES.
  2657         16  AT-AMOUNTS    OCCURS 7 TIMES.
  2658             20  AT-FACE-BEN     PIC S9(13)V99 value zeros.
  2659             20  AT-ISS-PRM      PIC S9(9)V99  value zeros.
  2660             20  AT-CNC-PRM      PIC S9(9)V99  value zeros.
  2661             20  AT-EARNED-PRM   PIC S9(9)V99  value zeros.
  2662             20  AT-CLAIM-AMT    PIC S9(9)V99  value zeros.
  2663             20  AT-CERT-COUNT   PIC S9(7)     value zeros.
  2664             20  AT-CLAIM-COUNT  PIC S9(9)     value zeros.
  2665             20  AT-NUMBER-DAYS  PIC S9(9)     value zeros.
  2666             20  AT-CRT-W-CLM    PIC S9(9)     value zeros.
  2667
  2668 01  ACCUMULATOR-TABLE-2 COMP-3.
  2669     12  AT2-AMOUNTS-L-D   OCCURS 3 TIMES.
  2670         16  AT2-AMOUNTS   OCCURS 7 TIMES.
  2671             20  AT2-FACE-BEN    PIC S9(13)V99 value zeros.
  2672             20  AT2-ISS-PRM     PIC S9(9)V99  value zeros.
  2673             20  AT2-CNC-PRM     PIC S9(9)V99  value zeros.
  2674             20  AT2-EARNED-PRM  PIC S9(9)V99  value zeros.
  2675             20  AT2-CLAIM-AMT   PIC S9(9)V99  value zeros.
  2676             20  AT2-CERT-COUNT  PIC S9(7)     value zeros.
  2677             20  AT2-CLAIM-COUNT PIC S9(9)     value zeros.
  2678             20  AT2-NUMBER-DAYS PIC S9(9)     value zeros.
  2679             20  AT2-CRT-W-CLM   PIC S9(9)     value zeros.
  2680
  2681 01  ACCUMULATOR-TABLE-3 COMP-3.
  2682     12  AT3-AMOUNTS-L-D   OCCURS 3 TIMES.
  2683         16  AT3-AMOUNTS   OCCURS 7 TIMES.
  2684             20  AT3-FACE-BEN    PIC S9(13)V99 value zeros.
  2685             20  AT3-ISS-PRM     PIC S9(9)V99  value zeros.
  2686             20  AT3-CNC-PRM     PIC S9(9)V99  value zeros.
  2687             20  AT3-EARNED-PRM  PIC S9(9)V99  value zeros.
  2688             20  AT3-CLAIM-AMT   PIC S9(9)V99  value zeros.
  2689             20  AT3-CERT-COUNT  PIC S9(7)     value zeros.
  2690             20  AT3-CLAIM-COUNT PIC S9(9)     value zeros.
  2691             20  AT3-NUMBER-DAYS PIC S9(9)     value zeros.
  2692             20  AT3-CRT-W-CLM   PIC S9(9)     value zeros.
  2693
  2694 01  ACCUMULATOR-TABLE-4 COMP-3.
  2695     12  AT4-AMOUNTS-L-D   OCCURS 3 TIMES.
  2696         16  AT4-AMOUNTS   OCCURS 7 TIMES.
  2697             20  AT4-FACE-BEN    PIC S9(13)V99 value zeros.
  2698             20  AT4-ISS-PRM     PIC S9(9)V99  value zeros.
  2699             20  AT4-CNC-PRM     PIC S9(9)V99  value zeros.
  2700             20  AT4-EARNED-PRM  PIC S9(9)V99  value zeros.
  2701             20  AT4-CLAIM-AMT   PIC S9(9)V99  value zeros.
  2702             20  AT4-CERT-COUNT  PIC S9(7)     value zeros.
  2703             20  AT4-CLAIM-COUNT PIC S9(9)     value zeros.
  2704             20  AT4-NUMBER-DAYS PIC S9(9)     value zeros.
  2705             20  AT4-CRT-W-CLM   PIC S9(9)     value zeros.
  2706
  2707 01  ACCUMULATOR-TABLE-5 COMP-3.
  2708     12  AT5-AMOUNTS-L-D   OCCURS 3 TIMES.
  2709         16  AT5-AMOUNTS   OCCURS 7 TIMES.
  2710             20  AT5-FACE-BEN    PIC S9(13)V99 value zeros.
  2711             20  AT5-ISS-PRM     PIC S9(9)V99  value zeros.
  2712             20  AT5-CNC-PRM     PIC S9(9)V99  value zeros.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  54
* ECS026.cbl
  2713             20  AT5-EARNED-PRM  PIC S9(9)V99  value zeros.
  2714             20  AT5-CLAIM-AMT   PIC S9(9)V99  value zeros.
  2715             20  AT5-CERT-COUNT  PIC S9(7)     value zeros.
  2716             20  AT5-CLAIM-COUNT PIC S9(9)     value zeros.
  2717             20  AT5-NUMBER-DAYS PIC S9(9)     value zeros.
  2718             20  AT5-CRT-W-CLM   PIC S9(9)     value zeros.
  2719
  2720 01  PRINT-TABLE         COMP-3.
  2721     12  PT-AMOUNTS-L-D    OCCURS 4 TIMES.
  2722         16  PT-AMOUNTS    OCCURS 8 TIMES.
  2723             20  PT-FACE-BEN     PIC S9(13)V99  value zeros.
  2724             20  PT-CERT-COUNT   PIC S9(9)      value zeros.
  2725             20  PT-CLAIM-COUNT  PIC S9(9)      value zeros.
  2726             20  PT-NUMBER-DAYS  PIC S9(9)      value zeros.
  2727             20  PT-GROSS-PRM    PIC S9(9)V99   value zeros.
  2728             20  PT-CNC-PRM      PIC S9(9)V99   value zeros.
  2729             20  PT-NET-PRM      PIC S9(9)V99   value zeros.
  2730             20  PT-EARNED-PRM   PIC S9(9)V99   value zeros.
  2731             20  PT-CLAIMS       PIC S9(9)V99   value zeros.
  2732             20  PT-EL-RATIO     PIC S9(5)V9(4) value zeros.
  2733             20  PT-PRCNT-PRM    PIC S9(5)V9(4) value zeros.
  2734             20  PT-PRCNT-CLAIM  PIC S9(5)V9(4) value zeros.
  2735             20  PT-PRCNT-CNC-G  PIC S9(5)V9(4) value zeros.
  2736             20  PT-AVG-LOAN     PIC S9(9)V99   value zeros.
  2737             20  PT-AVG-CLAIM    PIC S9(9)V99   value zeros.
  2738             20  PT-AVG-DAYS     PIC S9(9)      value zeros.
  2739             20  PT-CRT-W-CLM    PIC S9(9)      value zeros.
  2740
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  55
* ECS026.cbl
  2742 01  HEADING-1.
  2743     12  FILLER              PIC X(49)           VALUE SPACES.
  2744     12  FILLER              PIC X(26)           VALUE
  2745             'EXPERIENCE ANALYSIS REPORT'.
  2746     12  FILLER              PIC X(44)           VALUE SPACES.
  2747     12  FILLER              PIC X(6)            VALUE 'ECS026'.
  2748     12  H1-RPT-CODE         PIC X               VALUE SPACES.
  2749
  2750 01  HEADING-2.
  2751     12  FILLER              PIC X(47)           VALUE SPACES.
  2752     12  H2-COMPANY          PIC X(30).
  2753     12  FILLER              PIC X(42)           VALUE SPACES.
  2754     12  H2-CURRENT-DATE     PIC X(8).
  2755
  2756 01  HEADING-3.
  2757     12  FILLER              PIC X(53)           VALUE SPACES.
  2758     12  H3-RUN-DATE         PIC X(18).
  2759
  2760 01  ACCOUNT-HEADING.
  2761     12  FILLER              PIC X(9)            VALUE 'ACCOUNT'.
  2762     12  AH-ACCT-NO          PIC X(10).
  2763     12  FILLER              PIC XX              VALUE SPACES.
  2764     12  AH-ACCT-NAME        PIC X(30).
  2765
  2766 01  FINAL-HEADING.
  2767     12  FILLER              PIC X(12)    VALUE 'FINAL TOTALS'.
  2768
  2769 01  CARRIER-HEADING.
  2770     12  FILLER              PIC X(9)            VALUE 'CARRIER'.
  2771     12  CH-CARR-NO          PIC X.
  2772     12  FILLER              PIC XX              VALUE SPACES.
  2773     12  CH-CARR-NA          PIC X(40).
  2774
  2775 01  STATE-HEADING.
  2776     12  FILLER              PIC X(7)            VALUE 'STATE'.
  2777     12  SH-STATE-NO         PIC XX.
  2778     12  FILLER              PIC XX              VALUE SPACES.
  2779     12  SH-STATE-NAME       PIC X(20).
  2780
  2781 01  GROUP-HEADING.
  2782     12  FILLER              PIC X(7)            VALUE 'GROUP'.
  2783     12  GH-GROUP-NO         PIC X(6).
  2784
  2785 01  REPORT-CODE-1-HEADING.
  2786     12  RC1H-CAPTION        PIC X(12).
  2787     12  RC1H-CODE           PIC X(10).
  2788
  2789 01  REPORT-CODE-2-HEADING.
  2790     12  RC2H-CAPTION        PIC X(12).
  2791     12  RC2H-CODE           PIC X(10).
  2792
  2793 01  REINSURANCE-HEADING.
  2794     12  FILLER              PIC X(12)           VALUE
  2795             'REINS COMP'.
  2796     12  RH-COMP-NO          PIC X(6).
  2797     12  FILLER              PIC XX              VALUE SPACES.
  2798     12  RH-COMP-NAME        PIC X(30).
  2799
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  56
* ECS026.cbl
  2801 01  HEADING-7.
  2802     12  H7-DESC.
  2803         16 H7-DESC1-7       PIC X(7).
  2804         16 H7-DESC8-20      PIC X(13).
  2805     12  FILLER              PIC X(4)            VALUE SPACES.
  2806     12  FILLER              PIC X(8)            VALUE
  2807             '30-UNDER'.
  2808     12  FILLER              PIC X(8)            VALUE SPACES.
  2809     12  FILLER              PIC X(5)            VALUE '31-40'.
  2810     12  FILLER              PIC X(9)            VALUE SPACES.
  2811     12  FILLER              PIC X(5)            VALUE '41-45'.
  2812     12  FILLER              PIC X(9)            VALUE SPACES.
  2813     12  FILLER              PIC X(5)            VALUE '46-50'.
  2814     12  FILLER              PIC X(9)            VALUE SPACES.
  2815     12  FILLER              PIC X(5)            VALUE '51-55'.
  2816     12  FILLER              PIC X(9)            VALUE SPACES.
  2817     12  FILLER              PIC X(5)            VALUE '56-60'.
  2818     12  FILLER              PIC X(9)            VALUE SPACES.
  2819     12  FILLER              PIC X(5)            VALUE '61-UP'.
  2820     12  FILLER              PIC X(9)            VALUE SPACES.
  2821     12  FILLER              PIC X(5)            VALUE 'TOTAL'.
  2822
  2823 01  DETAIL-LINE.
  2824     12  DL-DESC             PIC X(20).
  2825     12  FILLER              PIC X(112).
  2826
  2827 01  DETAIL-LINE-R REDEFINES DETAIL-LINE.
  2828     12  FILLER              PIC X(20).
  2829     12  DL-AMT              PIC ZZ,ZZZ,ZZZ.99-  OCCURS 8 TIMES.
  2830
  2831 01  DETAIL-LINE-RR REDEFINES DETAIL-LINE.
  2832     12  FILLER              PIC X(20).
  2833     12  DL-AMT1             PIC ZZZZZZZZZZZZ9-  OCCURS 8 TIMES.
  2834
  2835 01  DETAIL-LINE-RR REDEFINES DETAIL-LINE.
  2836     12  FILLER              PIC X(20).
  2837     12  DL-AMT2             PIC Z,ZZZ,ZZZ,ZZ9-  OCCURS 8 TIMES.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  57
* ECS026.cbl
  2839 01  SORT-WORK-REC.
  2840     12  SWR-CONTROL.
  2841         16  SWR-REC-TYPE            PIC X.
  2842         16  SWR-CARR                PIC X.
  2843         16  SWR-GROUP               PIC X(6).
  2844         16  SWR-STATE               PIC XX.
  2845         16  SWR-ACCOUNT             PIC X(10).
  2846*            66  SWR-RPT-CODE RENAMES SWR-ACCOUNT.
  2847     12  SWR-REPORT-CODE-1           PIC X(10).
  2848     12  SWR-REPORT-CODE-2           PIC X(10).
  2849     12  SWR-ACCT-NAME               PIC X(30).
  2850     12  SWR-TABLE       COMP-3.
  2851         16  SWR-AMOUNTS-L-D   OCCURS 3 TIMES.
  2852             20  SWR-AMOUNTS   OCCURS 7 TIMES.
  2853                 24  SWR-FACE-BEN    PIC S9(13)V99 value zeros.
  2854                 24  SWR-ISS-PRM     PIC S9(9)V99  value zeros.
  2855                 24  SWR-CNC-PRM     PIC S9(9)V99   value zeros.
  2856                 24  SWR-EARNED-PRM  PIC S9(9)V99  value zeros.
  2857                 24  SWR-CLAIM-AMT   PIC S9(9)V99  value zeros.
  2858                 24  SWR-CERT-COUNT  PIC S9(7)     value zeros.
  2859                 24  SWR-CLAIM-COUNT PIC S9(9)     value zeros.
  2860                 24  SWR-NUMBER-DAYS PIC S9(9)     value zeros.
  2861                 24  SWR-CRT-W-CLM   PIC S9(9)     value zeros.
  2862
  2863 01  SORT-WORK-REC-2.
  2864     12  SWR2-CONTROL.
  2865         16  SWR2-REIN-COMP      PIC XXX.
  2866         16  SWR2-CARR           PIC X.
  2867     12  SWR2-DT                 PIC 9(11)    COMP-3 value zeros.
  2868     12  SWR2-AGE                PIC 99    value zeros.
  2869     12  SWR2-ENTRY-STATUS       PIC X VALUE SPACES.
  2870     12  SWR2-LF-CURRENT-STATUS  PIC X VALUE SPACES.
  2871     12  SWR2-AH-CURRENT-STATUS  PIC X VALUE SPACES.
  2872     12  SWR2-LFTYP              PIC XX VALUE SPACES.
  2873     12  SWR2-LF-TERM            PIC S999     COMP-3 value zeros.
  2874     12  SWR2-LF-REM-TRM         PIC S999     COMP-3 value zeros.
  2875     12  SWR2-LFAMT              PIC S9(9)V99 COMP-3 value zeros.
  2876     12  SWR2-LFPRM              PIC S9(7)V99 COMP-3 value zeros.
  2877     12  SWR2-LFRFND             PIC S9(7)V99 COMP-3 value zeros.
  2878     12  SWR2-AHTYP              PIC XX.
  2879     12  SWR2-AH-TERM            PIC S999     COMP-3 value zeros.
  2880     12  SWR2-AH-REM-TRM         PIC S999     COMP-3 value zeros.
  2881     12  SWR2-AHAMT              PIC S9(9)V99 COMP-3 value zeros.
  2882     12  SWR2-AHPRM              PIC S9(7)V99 COMP-3 value zeros.
  2883     12  SWR2-AHRFND             PIC S9(7)V99 COMP-3 value zeros.
  2884     12  SWR2-NUM-DTH-CLM        PIC S999     COMP-3 value zeros.
  2885     12  SWR2-DTHAMT             PIC S9(9)V99 COMP-3 value zeros.
  2886     12  SWR2-NUM-DIS-CLM        PIC S999     COMP-3 value zeros.
  2887     12  SWR2-DISAMT             PIC S9(9)V99 COMP-3 value zeros.
  2888     12  SWR2-NAME               PIC X(30) VALUE SPACES.
  2889     12  SWR2-REINS-TABLE        PIC XXX   VALUE SPACES.
  2890     12  SWR2-LF-EPR-PR          PIC S9(5)V99 COMP-3 value zeros.
  2891     12  SWR2-LF-EPR-78          PIC S9(5)V99 COMP-3 value zeros.
  2892     12  SWR2-AH-EPR-PR          PIC S9(5)V99 COMP-3 value zeros.
  2893     12  SWR2-AH-EPR-78          PIC S9(5)V99 COMP-3 value zeros.
  2894
* 2895                             COPY ELCDTECX.
  2896******************************************************************06/05/98
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  58
* ECS026.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  2897*                                                                *ELCDTECX
  2898*                            ELCDTECX.                           *   LV005
  2899*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  2900*                            VMOD=2.015                          *ELCDTECX
  2901*                                                                *ELCDTECX
  2902*      WORKING STORAGE COPY CODE FOR APPLICATIONS CALLING        *ELCDTECX
  2903*      THE DATE CARD DISK FILE. ( READ ROUTINE = ELCDTERX,       *ELCDTECX
  2904*      AND DISK FILE FD = ELCDTEFX)                              *ELCDTECX
  2905*                                                                *ELCDTECX
  2906******************************************************************ELCDTECX
  2907******************************************************************
  2908*                   C H A N G E   L O G
  2909*
  2910* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2911*-----------------------------------------------------------------
  2912*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2913* EFFECTIVE    NUMBER
  2914*-----------------------------------------------------------------
  2915* 092602    2002091900008  PEMA  INCREASE NUMBER OF MAXIMUM
  2916*                                  BENEFIT CODES FROM 300 TO 900
  2917* 090803    2003080800002  PEMA  ADD CATEGORY FOR SUPER GAP
  2918* 051304    2003080800002  SMVA  ADD REFUND METHOD
  2919* 071714    2013100100002  PEMA  FIX CRIT PERIOD EDITS
  2920******************************************************************
  2921 01  DATE-CARD.                                                   ELCDTECX
  2922     12  DATX-COD                    PIC  X(4).                   ELCDTECX
  2923     12  RUN-DATE                    PIC  9(11)  COMP-3.          ELCDTECX
  2924     12  ALPH-DATE                   PIC  X(18).                  ELCDTECX
  2925     12  EP-DT                       PIC  9(11)  COMP-3.          ELCDTECX
  2926     12  PEND-ACT-FILE               PIC  XX.                     ELCDTECX
  2927     12  EP-SW                       PIC  X.                      ELCDTECX
  2928         88  NO-EP-EXTRACTS          VALUE SPACE.                 ELCDTECX
  2929     12  TAPE-BATCHES                PIC  X.                      ELCDTECX
  2930         88  TP-PREL-BAL             VALUE '1'.                   ELCDTECX
  2931     12  BIN-RUN-DATE                PIC  XX.                     ELCDTECX
  2932     12  RUN-CENTURY.                                             ELCDTECX
  2933         16 RUN-CENTURY-N            PIC  99.                        CL**4
  2934     12  FILLER                      PIC  X.                         CL**4
  2935     12  CLAS-MORT-OVRD              PIC  X(4).                   ELCDTECX
  2936     12  FILLER                      PIC  XXX.                    ELCDTECX
  2937     12  COMPANY-NAME                PIC  X(30).                  ELCDTECX
  2938                                                                  ELCDTECX
  2939 01  FILLER                          PIC  X(7)                       CL**6
  2940                                          VALUE 'OPTIONS'.        ELCDTECX
  2941 01  DATE-CARD-OPTIONS.                                           ELCDTECX
  2942     12  DATE-OPTIONS-ID             PIC  X(4).                   ELCDTECX
  2943     12  DTE-MIN-PREM                PIC  99V99.                  ELCDTECX
  2944     12  DTE-LANGUAGE-IND            PIC  X.                      ELCDTECX
  2945         88  DTE-LANGUAGE-IS-FR           VALUE 'F'.              ELCDTECX
  2946         88  DTE-LANGUAGE-IS-ENG          VALUE 'E'.              ELCDTECX
  2947     12  DTE-MIN-AGE                 PIC  99.                     ELCDTECX
  2948     12  DTE-DEFAULT-AGE             PIC  99.                     ELCDTECX
  2949     12  FILLER                      PIC  X.                      ELCDTECX
  2950     12  DTE-MAX-TERM                PIC  999.                    ELCDTECX
  2951     12  DTE-COMP-VG                 PIC  X.                      ELCDTECX
  2952     12  DTE-REM-TRM                 PIC  X.                      ELCDTECX
  2953     12  DTE-PRM-CK                  PIC S99V99.                  ELCDTECX
  2954     12  DTE-PRORATA                 PIC  X.                      ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  59
* ECS026.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  2955     12  DTE-CLM-REJ                 PIC  X.                      ELCDTECX
  2956     12  DTE-REF-REJ                 PIC  X.                      ELCDTECX
  2957     12  DTE-COM-TBL-USED            PIC  X.                      ELCDTECX
  2958     12  FILLER                      PIC  X.                      ELCDTECX
  2959     12  DTE-QTR-CO                  PIC  X.                      ELCDTECX
  2960     12  DTE-REF-CK                  PIC S99V99.                  ELCDTECX
  2961     12  DTE-CLM-CK                  PIC S99V99.                  ELCDTECX
  2962     12  DTE-CONV-DT                 PIC 9(11) COMP-3.               CL**2
  2963     12  DTE-DEFAULT-SEX             PIC  X.                      ELCDTECX
  2964     12  DTE-EPL-FORMAT              PIC  X.                      ELCDTECX
  2965     12  FILLER                      PIC  X.                      ELCDTECX
  2966     12  DTE-JT-AGE                  PIC  X.                      ELCDTECX
  2967     12  DTE-KEY-BIRTH               PIC  X.                      ELCDTECX
  2968     12  DTE-REINSURANCE             PIC  X.                      ELCDTECX
  2969     12  DTE-CLAIM-SORT              PIC  X.                      ELCDTECX
  2970     12  DTE-WRT-OFF                 PIC  S99V99.                 ELCDTECX
  2971     12  DTE-R78                     PIC  X.                      ELCDTECX
  2972     12  DTE-DLY-BILL                PIC  X.                      ELCDTECX
  2973     12  DTE-ALT-MORT-CODE           PIC  X(4).                   ELCDTECX
  2974     12  DTE-CLAIM-PAID-THRU-TO      PIC  X.                      ELCDTECX
  2975     12  DTE-COMPENSATION-ACCESS     PIC  X.                      ELCDTECX
  2976     12  DTE-MORTG-ACCESS-CNTL       PIC  X.                      ELCDTECX
  2977     12  DTE-MP-ALT-MORT-CODE        PIC  X(4).                   ELCDTECX
  2978     12  DTE-MORTALITY-AGE-CALC-METHOD                            ELCDTECX
  2979                                     PIC  X.                      ELCDTECX
  2980         88  DTE-USE-TABLE-ASSIGNED-METHOD VALUE '1'              ELCDTECX
  2981                                                 ' '.             ELCDTECX
  2982         88  DTE-USE-ALL-AGE-LAST          VALUE '2'.             ELCDTECX
  2983         88  DTE-USE-ALL-AGE-NEAR          VALUE '3'.             ELCDTECX
  2984     12  DTE-RESERVE-OPTION-SWITCH   PIC  X.                      ELCDTECX
  2985         88  DTE-OPT-RESERVE-METHOD-AUTH       VALUE 'Y'.         ELCDTECX
  2986         88  DTE-OPT-RESERVE-METHOD-UNAUTH     VALUE 'N' ' '.     ELCDTECX
  2987     12  DTE-REM-TRM-CALC-OPTION     PIC  X.                      ELCDTECX
  2988     12  DTE-EXPERIENCE-RETENTION-AGE                             ELCDTECX
  2989                                     PIC  9.                         CL**4
  2990     12  DTE-SYSTEM.                                              ELCDTECX
  2991         16  DTE-SYS-A-CREDIT        PIC  X.                      ELCDTECX
  2992         16  DTE-SYS-B-PEND-CLAIM    PIC  X.                      ELCDTECX
  2993         16  DTE-SYS-C-CONFIRMATIONS PIC  X.                      ELCDTECX
  2994         16  DTE-SYS-D-DEMAND-BILL   PIC  X.                      ELCDTECX
  2995         16  DTE-SYS-E-CLASIC-CLAIMS PIC  X.                      ELCDTECX
  2996         16  DTE-SYS-F-CLASIC-CREDIT PIC  X.                      ELCDTECX
  2997         16  DTE-SYS-G-AR-USED       PIC  X.                      ELCDTECX
  2998         16  DTE-SYS-H               PIC  X.                      ELCDTECX
  2999         16  DTE-SYS-I               PIC  X.                      ELCDTECX
  3000         16  DTE-SYS-J               PIC  X.                      ELCDTECX
  3001         16  DTE-SYS-K               PIC  X.                      ELCDTECX
  3002         16  DTE-SYS-L               PIC  X.                      ELCDTECX
  3003         16  DTE-SYS-M               PIC  X.                      ELCDTECX
  3004         16  DTE-SYS-N               PIC  X.                      ELCDTECX
  3005         16  DTE-SYS-O               PIC  X.                      ELCDTECX
  3006         16  DTE-SYS-P               PIC  X.                      ELCDTECX
  3007         16  DTE-SYS-Q               PIC  X.                      ELCDTECX
  3008         16  DTE-SYS-R               PIC  X.                      ELCDTECX
  3009         16  DTE-SYS-S               PIC  X.                      ELCDTECX
  3010         16  DTE-SYS-T               PIC  X.                      ELCDTECX
  3011         16  DTE-SYS-U               PIC  X.                      ELCDTECX
  3012         16  DTE-SYS-V               PIC  X.                      ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  60
* ECS026.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  3013         16  DTE-SYS-W               PIC  X.                      ELCDTECX
  3014         16  DTE-SYS-X               PIC  X.                      ELCDTECX
  3015         16  DTE-SYS-Y               PIC  X.                      ELCDTECX
  3016         16  DTE-SYS-Z               PIC  X.                      ELCDTECX
  3017     12  FILLER                      REDEFINES DTE-SYSTEM.        ELCDTECX
  3018         16  DTE-SYS-CODE            OCCURS 26 TIMES              ELCDTECX
  3019                                     PIC  X.                      ELCDTECX
  3020     12  DTE-CLIENT                  PIC  XXX.                    ELCDTECX
  3021                                                                  ELCDTECX
  3022 01  CLASIC-SYSTEM-CODES.                                         ELCDTECX
  3023     12  DTE-COLC-ID                 PIC  X(4).                   ELCDTECX
  3024     12  DTE-CLASIC-COMPANY-CD       PIC  X.                      ELCDTECX
  3025     12  DTE-CLASIC-COMPANY-NUMBER   PIC  999.                    ELCDTECX
  3026*    12  DTE-CLASIC-CLAIM-ACCESS     PIC  X.                      ELCDTECX
  3027     12  FILLER                      PIC  X.                      ELCDTECX
  3028     12  CLASIC-REIN-MAINT           PIC  XX.                     ELCDTECX
  3029     12  CLASIC-COMP-MAINT           PIC  XX.                     ELCDTECX
  3030     12  CLASIC-ACCT-MAINT           PIC  XX.                     ELCDTECX
  3031     12  CLASIC-CTBL-MAINT           PIC  XX.                     ELCDTECX
  3032     12  CLASIC-RATE-MAINT           PIC  XX.                     ELCDTECX
  3033     12  CLASIC-CREDIT-EOM-DT        PIC  XX.                     ELCDTECX
  3034     12  CLASIC-CLAIMS-EOM-DT        PIC  XX.                     ELCDTECX
  3035                                                                  ELCDTECX
  3036     12  LIFE-OVERRIDE-L1            PIC  X.                      ELCDTECX
  3037     12  LIFE-OVERRIDE-L2            PIC  XX.                     ELCDTECX
  3038     12  LIFE-OVERRIDE-L6            PIC  X(6).                   ELCDTECX
  3039     12  LIFE-OVERRIDE-L12           PIC  X(12).                  ELCDTECX
  3040                                                                  ELCDTECX
  3041     12  AH-OVERRIDE-L1              PIC  X.                      ELCDTECX
  3042     12  AH-OVERRIDE-L2              PIC  XX.                     ELCDTECX
  3043     12  AH-OVERRIDE-L6              PIC  X(6).                   ELCDTECX
  3044     12  AH-OVERRIDE-L12             PIC  X(12).                  ELCDTECX
  3045                                                                  ELCDTECX
  3046     12  CLAS-REPORT-CD1-CAPTION     PIC  X(10).                  ELCDTECX
  3047     12  CLAS-REPORT-CD2-CAPTION     PIC  X(10).                  ELCDTECX
  3048                                                                  ELCDTECX
  3049     12  CLASIC-MORTG-EOM-DT         PIC  XX.                     ELCDTECX
  3050     12  CLASIC-AR-EOM-DT            PIC  XX.                     ELCDTECX
  3051                                                                  ELCDTECX
  3052     12  FILLER                      PIC  X(11)      VALUE SPACE. ELCDTECX
  3053                                                                  ELCDTECX
  3054 01  DATE-CARD-FACTORS.                                           ELCDTECX
  3055     12  DATE-FACTOR-ID              PIC  X(4).                   ELCDTECX
  3056     12  FAC-1                       PIC S999V9(5).               ELCDTECX
  3057     12  FAC-2                       PIC S999V9(5).               ELCDTECX
  3058     12  FAC-3                       PIC S999V9(5).               ELCDTECX
  3059     12  FAC-4                       PIC S999V9(5).               ELCDTECX
  3060     12  FAC-5                       PIC S999V9(5).               ELCDTECX
  3061     12  FAC-6                       PIC S999V9(5).               ELCDTECX
  3062                                                                  ELCDTECX
  3063 01  FILLER                          PIC  X(12)                   ELCDTECX
  3064                                          VALUE 'COMPANY NAME'.   ELCDTECX
  3065 01  COMPANY-NAME-TABLE.                                          ELCDTECX
  3066     12  C-N-TBL                     OCCURS 6 TIMES.              ELCDTECX
  3067         16  CNT-ID                  PIC  X.                      ELCDTECX
  3068         16  CNT-NAME                PIC  X(30).                  ELCDTECX
  3069                                                                  ELCDTECX
  3070 01  FILLER                          PIC  X(11)                   ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  61
* ECS026.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  3071                                          VALUE 'STATE NAMES'.    ELCDTECX
  3072 01  STATE-NAMES.                                                 ELCDTECX
  3073     12  STATE-NAME-FLD              OCCURS 75 TIMES.             ELCDTECX
  3074         16  STATE-SUB               PIC  XX.                     ELCDTECX
  3075         16  STATE-PIC1.                                          ELCDTECX
  3076             20  STATE-ABBR          PIC  XX.                     ELCDTECX
  3077             20  FILLER              PIC  XXX.                    ELCDTECX
  3078             20  STATE-PIC           PIC  X(20).                  ELCDTECX
  3079             20  STATE-CALL-EARN     PIC  X.                      ELCDTECX
  3080             20  STATE-CALL-BREAK    PIC  X.                      ELCDTECX
  3081             20  STATE-PRIM-FAC-DEV  PIC  XXX.                    ELCDTECX
  3082                                                                  ELCDTECX
  3083 01  FILLER                          PIC  X(13)                   ELCDTECX
  3084                                          VALUE 'CARRIER NAMES'.  ELCDTECX
  3085 01  CARRIER-NAMES.                                               ELCDTECX
  3086     12  CARRIER-NAME-FLD            OCCURS 25 TIMES.             ELCDTECX
  3087         16  CARRIER-SUB             PIC  X.                      ELCDTECX
  3088         16  CARRIER-DOM-ST          PIC  XX.                     ELCDTECX
  3089         16  CARRIER-PIC             PIC  X(30).                  ELCDTECX
  3090         16  CARRIER-UEP-PCT         PIC  S9V9(4) COMP-3.            CL**6
  3091         16  CARRIER-R78-PCT         PIC  S9V9(4) COMP-3.            CL**6
  3092         16  CARRIER-PRO-PCT         PIC  S9V9(4) COMP-3.            CL**6
  3093*        16  FILLER                  PIC  X.                      ELCDTECX
  3094         16  CARRIER-SEC-PAY         PIC  X.
  3095             88  SEC-PAY-CARRIER          VALUE 'Y'.
  3096                                                                  ELCDTECX
  3097 01  FILLER                          PIC  X(9)                       CL**6
  3098                                          VALUE 'INS TYPES'.      ELCDTECX
  3099 01  CLAS-INS-TYPES.                                              ELCDTECX
  3100*    12 CLAS-ALL-TYPES               OCCURS 300 TIMES.            ELCDTECX
  3101     12 CLAS-ALL-TYPES               OCCURS 900 TIMES.            ELCDTECX
  3102         16  CLAS-I-BEN              PIC  XX.                     ELCDTECX
  3103         16  CLAS-I-AB3.                                          ELCDTECX
  3104             20  FILLER              PIC  X.                      ELCDTECX
  3105             20  CLAS-I-AB2.                                      ELCDTECX
  3106                 24  FILLER          PIC  X.                      ELCDTECX
  3107                 24  CLAS-I-AB1      PIC  X.                      ELCDTECX
  3108         16  CLAS-I-AB3-AH REDEFINES CLAS-I-AB3.                  ELCDTECX
  3109             20  CLAS-EXCLUSION      PIC  XX.                        CL**4
  3110             20  FILLER              PIC  X.                         CL**4
  3111         16  CLAS-I-AB10.                                         ELCDTECX
  3112             20  FILLER              PIC  X(9).                   ELCDTECX
  3113             20  CLAS-I-REIN-YN      PIC  X.                      ELCDTECX
  3114         16  CLAS-I-COMMENT          PIC  X(10).                  ELCDTECX
  3115         16  CLAS-I-JOINT            PIC  X.                      ELCDTECX
  3116         16  CLAS-I-RL-AH            PIC  X.                      ELCDTECX
  3117         16  CLAS-I-CALC-TYPE.                                    ELCDTECX
  3118             20  CLAS-I-BAL          PIC  X.                      ELCDTECX
  3119         16  CLAS-I-EP               PIC  X.                      ELCDTECX
  3120         16  CLAS-CO-BEN-I-G-CD      PIC  X.                      ELCDTECX
  3121         16  CLAS-CO-REM-TERM-CALC   PIC  X.                      ELCDTECX
  3122         16  CLAS-I-BEN-CATEGORY     PIC  X.
  3123         16  CLAS-I-REFUND-METHOD    PIC  X.
  3124         16  CLAS-I-MAX-BENEFITS     PIC 99.
  3125         16  FILLER                  PIC  XXX.
  3126                                                                  ELCDTECX
  3127 01  FILLER                          PIC  X(16)                   ELCDTECX
  3128                                     VALUE 'MORTALITY TABLES'.    ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  62
* ECS026.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  3129 01  CLAS-MORTALITY-CODES.                                        ELCDTECX
  3130     12  CLAS-MORT-FLD               OCCURS 99 TIMES              ELCDTECX
  3131                                     INDEXED BY CLAS-MORT-NDX.    ELCDTECX
  3132         16  CLAS-MORT-CODE          PIC  X(4).                      CL**6
  3133         16  CLAS-MORT-J-CODE        PIC  X.                         CL**5
  3134         16  CLAS-MORT-J-FACT        PIC S9V9(4).                    CL**6
  3135         16  CLAS-MORT-DESC.                                      ELCDTECX
  3136             20  CLAS-RESERVE-ADJ    PIC  999.                       CL**6
  3137             20  FILLER              PIC  XX.                        CL**5
  3138             20  CLAS-YEAR           PIC  X(4).                      CL**6
  3139             20  FILLER              PIC  X.                         CL**5
  3140             20  CLAS-TABLE-TYPE     PIC  XXX.                       CL**6
  3141             20  FILLER              PIC  X.                         CL**5
  3142             20  CLAS-AGE-METHOD     PIC  XX.                        CL**5
  3143             20  FILLER              PIC  X.                         CL**5
  3144             20  CLAS-INTEREST       PIC  99.99.                     CL**5
  3145             20  FILLER              PIC  X(5).                      CL**6
  3146                                                                  ELCDTECX
  3147 01  FILLER                          PIC  X(15)                   ELCDTECX
  3148                                     VALUE 'BUSINESS TABLES'.     ELCDTECX
  3149 01  CLAS-BUSINESS-CLASSES.                                       ELCDTECX
  3150     12  CLAS-BUSC-FLD               OCCURS 50 TIMES.             ELCDTECX
  3151         16  CLAS-BUSC-CODE          PIC  99.                     ELCDTECX
  3152         16  CLAS-BUSC-GROUP         PIC  X.                      ELCDTECX
  3153         16  CLAS-BUSC-DESC          PIC  X(19).                  ELCDTECX
  3154         16  CLAS-BUSC-EXCL          PIC  X.                         CL**5
  3155         16  FILLER                  PIC  X(4).                      CL**6
  3156                                                                  ELCDTECX
  3157 01  FILLER                          PIC  X(7)                       CL**6
  3158                                     VALUE 'INDEXES'.             ELCDTECX
  3159 01  CLAS-INDEX-TBL.                                              ELCDTECX
  3160     12  CLAX-ID                     PIC  X(4).                   ELCDTECX
  3161     12  CLAS-STARTC                 PIC S9(4) COMP.              ELCDTECX
  3162     12  CLAS-MAXC                   PIC S9(4) COMP.              ELCDTECX
  3163     12  CLAS-STARTL                 PIC S9(4) COMP.              ELCDTECX
  3164     12  CLAS-MAXL                   PIC S9(4) COMP.              ELCDTECX
  3165     12  CLAS-STARTA                 PIC S9(4) COMP.              ELCDTECX
  3166     12  CLAS-MAXA                   PIC S9(4) COMP.              ELCDTECX
  3167     12  CLAS-STARTM                 PIC S9(4) COMP.              ELCDTECX
  3168     12  CLAS-MAXM                   PIC S9(4) COMP.              ELCDTECX
  3169     12  CLAS-STARTB                 PIC S9(4) COMP.              ELCDTECX
  3170     12  CLAS-MAXB                   PIC S9(4) COMP.              ELCDTECX
  3171     12  CLAS-STARTS                 PIC S9(4) COMP.              ELCDTECX
  3172     12  CLAS-MAXS                   PIC S9(4) COMP.              ELCDTECX
  3173     12  CLAS-STARTE                 PIC S9(4) COMP.              ELCDTECX
  3174     12  CLAS-MAXE                   PIC S9(4) COMP.              ELCDTECX
  3175     12  CLAS-STARTCN                PIC S9(4) COMP.              ELCDTECX
  3176     12  CLAS-MAXCN                  PIC S9(4) COMP.              ELCDTECX
  3177                                                                  ELCDTECX
  3178 01  CLAS-TYPE-MISC.                                              ELCDTECX
  3179     12  CLAS-INDEXC                 PIC S9(4) COMP.              ELCDTECX
  3180     12  CLAS-INDEXL                 PIC S9(4) COMP.              ELCDTECX
  3181     12  CLAS-INDEXA                 PIC S9(4) COMP.              ELCDTECX
  3182     12  CLAS-INDEXM                 PIC S9(4) COMP.              ELCDTECX
  3183     12  CLAS-INDEXB                 PIC S9(4) COMP.              ELCDTECX
  3184     12  CLAS-INDEXS                 PIC S9(4) COMP.              ELCDTECX
  3185     12  CLAS-INDEXE                 PIC S9(4) COMP.              ELCDTECX
  3186     12  CLAS-INDEX                  PIC S9(4) COMP.              ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  63
* ECS026.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  3187     12  CLAS-INDEXEN                PIC S9(4) COMP.              ELCDTECX
  3188     12  CLAS-INDEXCN                PIC S9(4) COMP.              ELCDTECX
  3189     12  CLAS-INDEXON                PIC S9(4) COMP.              ELCDTECX
  3190                                                                  ELCDTECX
  3191 01  FILLER                          PIC  X(13)                   ELCDTECX
  3192                                     VALUE 'MISCELLANEOUS'.       ELCDTECX
  3193 01  CLAS-MISC.                                                   ELCDTECX
  3194     12  DTE-FICH                    PIC  X.                      ELCDTECX
  3195         88  FICH-NO                 VALUE SPACE.                 ELCDTECX
  3196         88  FICH-ONLY               VALUE '1'.                   ELCDTECX
  3197         88  FICH-BOTH               VALUE '2'.                   ELCDTECX
  3198     12  FICH-OPEN                   PIC  X.                      ELCDTECX
  3199     12  REPT-OPEN                   PIC  X.                      ELCDTECX
  3200     12  DTE-PGM-OPT                 PIC  9.                         CL**5
  3201     12  DTE-PRT-OPT                 PIC  X.                      ELCDTECX
  3202     12  DTE-FMT-OPT                 PIC  9.                      ELCDTECX
  3203     12  DTE-PRC-OPT                 PIC  9.                      ELCDTECX
  3204     12  DTE-TOT-OPT                 PIC  9.                      ELCDTECX
  3205     12  CLAS-LOOK                   PIC  XX.                     ELCDTECX
  3206     12  DTE-TOT-LINES               PIC S9(8)      COMP.         ELCDTECX
  3207     12  STATE-L                     PIC  XX.                     ELCDTECX
  3208     12  CLAS-CN                     PIC  99.                     ELCDTECX
  3209     12  CLAS-CO                     PIC  99.                     ELCDTECX
  3210     12  DTE-VSAM-FLAGS                              VALUE ZERO.  ELCDTECX
  3211         16  DTE-F-1                 PIC  X.                      ELCDTECX
  3212         16  DTE-F-2                 PIC  X.                      ELCDTECX
  3213     12  DTE-ABEND-WORK.                                          ELCDTECX
  3214         16  DTE-ABEND-CD-1          PIC  XX         VALUE SPACES.ELCDTECX
  3215         16  DTE-ABEND-CD-2          PIC  XX         VALUE SPACES.ELCDTECX
  3216                                                                  ELCDTECX
  3217 01  FILLER                          PIC  X(12)                   ELCDTECX
  3218                                     VALUE 'WORKING DATE'.        ELCDTECX
  3219 01  WS-DATE-AND-TIME.                                            ELCDTECX
  3220     12  WS-ACCEPT-DATE.                                          ELCDTECX
  3221         16  WS-AD-YY                PIC  99.                     ELCDTECX
  3222         16  WS-AD-MM                PIC  99.                     ELCDTECX
  3223         16  WS-AD-DD                PIC  99.                     ELCDTECX
  3224     12  WS-CURRENT-DATE.                                         ELCDTECX
  3225         16  WS-CD-MM                PIC  99.                     ELCDTECX
  3226         16  FILLER                  PIC  X          VALUE '/'.   ELCDTECX
  3227         16  WS-CD-DD                PIC  99.                     ELCDTECX
  3228         16  FILLER                  PIC  X          VALUE '/'.   ELCDTECX
  3229         16  WS-CD-YY                PIC  99.                     ELCDTECX
  3230     12  WS-TIME-OF-DAY.                                          ELCDTECX
  3231         16  WS-TIME                 PIC  9(6).                   ELCDTECX
  3232         16  WS-HUN-SEC              PIC  99.                     ELCDTECX
  3233                                                                  ELCDTECX
  3234 01  FILLER                          PIC  X(12)                   ELCDTECX
  3235                                     VALUE 'CARRIER CLMS'.        ELCDTECX
  3236 01  CARRIER-OPT-CLAIM-DATA.                                      ELCDTECX
  3237     12  CARRIER-FLDS                OCCURS 25 TIMES.             ELCDTECX
  3238         16  CARRIER-IBNR-SWITCH     PIC  X.                         CL**5
  3239         16  CARRIER-IBNR-PERCENT    PIC S9V9(4) COMP-3.             CL**6
  3240         16  CARRIER-CIDA-DISCOUNT   PIC S9V9(4) COMP-3.             CL**6
  3241                                                                  ELCDTECX
  3242 01  FILLER                          PIC  X(10)                   ELCDTECX
  3243                                     VALUE 'STATE TLRS'.          ELCDTECX
  3244 01  STATE-TARGET-LOSS-RATIOS.                                    ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  64
* ECS026.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  3245     12  STATE-TLR-FLD               OCCURS 75 TIMES.             ELCDTECX
  3246         16  STATE-TARGET-LOSS-RATIO PIC S9V9(4) COMP-3.             CL**6
  3247         16  STATE-CALC-INTEREST     PIC S9V9(4) COMP-3.             CL**6
  3248                                                                  ELCDTECX
  3249 01  FILLER                          PIC  X(13)                   ELCDTECX
  3250                                     VALUE 'BUSINESS TLRS'.       ELCDTECX
  3251 01  BUSINESS-TRGT-LOSS-RATIO-MODS.                               ELCDTECX
  3252     12  BUS-TLRM-FLD                OCCURS 99 TIMES.             ELCDTECX
  3253         16  BUS-TRGT-LOSS-RATIO-MOD PIC S9V9(4) COMP-3.             CL**6
  3254                                                                  ELCDTECX
  3255 01  FILLER                          PIC  X(13)                   ELCDTECX
  3256                                     VALUE 'MISC CLM DATA'.       ELCDTECX
  3257 01  MISC-OPT-CLM-RSV-DATA.                                       ELCDTECX
  3258     12  COMPANY-CALC-INTEREST       PIC S9V9(4) COMP-3.             CL**6
  3259     12  COMPANY-CIDA-DISCOUNT       PIC S9V9(4) COMP-3.             CL**6
  3260     12  COMPANY-CRDB-TABLE-SELECTION                             ELCDTECX
  3261                                     PIC  X.                         CL**5
  3262     12  COMPANY-IBNR-AH-FACTOR      PIC S9V9(4) COMP-3.             CL**6
  3263     12  COMPANY-IBNR-LAG-MONTH      PIC S999    COMP-3.             CL**6
  3264     12  COMPANY-IBNR-LIFE-FACTOR    PIC S9V9(4) COMP-3.             CL**6
  3265     12  COMPANY-OPTION-START-DATE   PIC  XX.                        CL**5
  3266     12  INDEXBS                     PIC S9(4)   COMP.               CL**6
  3267     12  INDEXCA                     PIC S9(4)   COMP.               CL**6
  3268     12  INDEXST                     PIC S9(4)   COMP.               CL**6
  3269     12  FILLER                      PIC  X(75).                  ELCDTECX
  3270******************************************************************ELCDTECX
  3271*01  MISC-CARR-PCT-DATA.                                          00001521
  3272*    12  DD-CARR1-UEP-PCT            PIC S9V9(4) COMP-3.          00001522
  3273*    12  DD-CARR1-R78-PCT            PIC S9V9(4) COMP-3.          00001522
  3274*    12  DD-CARR1-PRO-PCT            PIC S9V9(4) COMP-3.          00001522
  3275*    12  DD-CARR2-UEP-PCT            PIC S9V9(4) COMP-3.          00001522
  3276*    12  DD-CARR2-R78-PCT            PIC S9V9(4) COMP-3.          00001522
  3277*    12  DD-CARR2-PRO-PCT            PIC S9V9(4) COMP-3.          00001522
  3278******************************************************************ELCDTECX
  3279
* 3280                             COPY ELCDTEVR.
  3281***************************************************************** 04/15/98
  3282*                                                                *ELCDTEVR
  3283*                                                                *ELCDTEVR
  3284*                            ELCDTEVR.                           *   LV003
  3285*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
  3286*                            VMOD=2.001                          *   CL**2
  3287*                                                                *ELCDTEVR
  3288*   WORKING STORAGE FOR DATE VARIABLES CREATED                   *ELCDTEVR
  3289*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCDTEVR
  3290*                                                                *ELCDTEVR
  3291******************************************************************ELCDTEVR
  3292 01  WS-DATE-CARD-DATE.                                           ELCDTEVR
  3293     05  WS-RUN-DATE.                                             ELCDTEVR
  3294         10  FILLER                  PIC  9(03).                  ELCDTEVR
  3295         10  RUN-CCYY                PIC  9(04).                  ELCDTEVR
  3296         10  RUN-CCYR  REDEFINES  RUN-CCYY.                       ELCDTEVR
  3297             15  RUN-CC              PIC  99.                     ELCDTEVR
  3298             15  RUN-YR              PIC  99.                     ELCDTEVR
  3299         10  RUN-MO                  PIC  99.                     ELCDTEVR
  3300         10  RUN-DA                  PIC  99.                     ELCDTEVR
  3301     05  WS-RUN-DATE-N REDEFINES                                     CL**2
  3302            WS-RUN-DATE              PIC 9(11).                      CL**2
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  65
* ECS026.cbl (/apps/prod/cid1p/copy/ELCDTEVR)
  3303     05  WS-EP-DT.                                                ELCDTEVR
  3304         10  FILLER                  PIC  9(03).                  ELCDTEVR
  3305         10  EP-CCYY                 PIC  9(04).                  ELCDTEVR
  3306         10  EP-CCYR  REDEFINES  EP-CCYY.                         ELCDTEVR
  3307             15  EP-CC               PIC  99.                     ELCDTEVR
  3308             15  EP-YR               PIC  99.                     ELCDTEVR
  3309         10  EP-MO                   PIC  99.                     ELCDTEVR
  3310         10  EP-DA                   PIC  99.                     ELCDTEVR
  3311     05  WS-EP-DT-N REDEFINES                                        CL**2
  3312            WS-EP-DT                 PIC 9(11).                      CL**2
  3313     05  WS-DTE-CONV-DT.                                             CL**4
  3314         10  FILLER                  PIC  9(03).                     CL**4
  3315         10  DTE-CONV-CCYY           PIC  9(04).                     CL**4
  3316         10  DTE-CONV-CCYR  REDEFINES  DTE-CONV-CCYY.                CL**4
  3317             15  DTE-CONV-CC         PIC  99.                        CL**4
  3318             15  DTE-CONV-YR         PIC  99.                        CL**4
  3319         10  DTE-CONV-MO             PIC  99.                        CL**4
  3320         10  DTE-CONV-DA             PIC  99.                        CL**4
  3321     05  WS-DTE-CONV-DT-N REDEFINES                                  CL**4
  3322            WS-DTE-CONV-DT           PIC  9(11).                     CL**4
  3323 01  WS-BALANCE-FORWARD-DATE.                                     ELCDTEVR
  3324     05  WS-BF-LAST-ACTIVITY-DATE.                                ELCDTEVR
  3325         10  FILLER                            PIC 999.           ELCDTEVR
  3326         10  BF-ACT-CCYY                       PIC 9(04).         ELCDTEVR
  3327         10  BF-ACT-CCYR  REDEFINES  BF-ACT-CCYY.                 ELCDTEVR
  3328             15  BF-ACT-CC                     PIC 99.            ELCDTEVR
  3329             15  BF-ACT-YEAR                   PIC 99.            ELCDTEVR
  3330         10  BF-ACT-MONTH                      PIC 99.            ELCDTEVR
  3331         10  BF-ACT-DAY                        PIC 99.            ELCDTEVR
  3332     05  WS-BF-LAST-ACTIVITY-DATE-N REDEFINES                        CL**2
  3333            WS-BF-LAST-ACTIVITY-DATE           PIC 9(11).            CL**2
  3334     05  WS-BF-CURRENT-LAST-STMT-DT.                              ELCDTEVR
  3335         10  FILLER                            PIC 999.           ELCDTEVR
  3336         10  BF-CURRENT-LAST-STMT-CEN          PIC 99.            ELCDTEVR
  3337         10  BF-CURRENT-LAST-STMT-YEAR         PIC 99.            ELCDTEVR
  3338         10  BF-CURRENT-LAST-STMT-MONTH        PIC 99.            ELCDTEVR
  3339         10  BF-CURRENT-LAST-STMT-DAY          PIC 99.            ELCDTEVR
  3340     05  WS-BF-CURRENT-LAST-STMT-DT-N REDEFINES                      CL**2
  3341            WS-BF-CURRENT-LAST-STMT-DT        PIC 9(11).             CL**2
  3342 01  WS-ADD-CONF-TRANSACTIONS-DTE.                                ELCDTEVR
  3343     05  WS-AC-CERT-EFF-DATE.                                     ELCDTEVR
  3344         10  FILLER                            PIC 999.           ELCDTEVR
  3345         10  AC-CERT-CCYY                      PIC 9(04).         ELCDTEVR
  3346         10  AC-CERT-CCYR  REDEFINES  AC-CERT-CCYY.               ELCDTEVR
  3347             15  AC-CERT-CC                    PIC 99.            ELCDTEVR
  3348             15  AC-CERT-YR                    PIC 99.            ELCDTEVR
  3349         10  AC-CERT-MO                        PIC 99.            ELCDTEVR
  3350         10  AC-CERT-DA                        PIC 99.            ELCDTEVR
  3351     05  WS-AC-CERT-EFF-DATE-N REDEFINES                             CL**2
  3352            WS-AC-CERT-EFF-DATE                PIC 9(11).            CL**2
  3353     05  WS-AC-LIFE-CANCEL-DATE.                                  ELCDTEVR
  3354         10  FILLER                            PIC 999.           ELCDTEVR
  3355         10  AC-LIFE-CANCEL-CCYY               PIC 9(04).         ELCDTEVR
  3356         10  AC-LIFE-CANCEL-CCYR REDEFINES AC-LIFE-CANCEL-CCYY.   ELCDTEVR
  3357             15  AC-LIFE-CANCEL-CC             PIC 99.            ELCDTEVR
  3358             15  AC-LIFE-CANCEL-YR             PIC 99.            ELCDTEVR
  3359         10  AC-LIFE-CANCEL-MO                 PIC 99.            ELCDTEVR
  3360         10  AC-LIFE-CANCEL-DA                 PIC 99.            ELCDTEVR
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  66
* ECS026.cbl (/apps/prod/cid1p/copy/ELCDTEVR)
  3361     05  WS-AC-LIFE-CANCEL-DATE-N REDEFINES                          CL**2
  3362            WS-AC-LIFE-CANCEL-DATE             PIC 9(11).            CL**2
  3363     05  WS-AC-AH-CANCEL-DATE.                                    ELCDTEVR
  3364         10  FILLER                            PIC 999.           ELCDTEVR
  3365         10  AC-AH-CANCEL-CCYY                 PIC 9(04).         ELCDTEVR
  3366         10  AC-AH-CANCEL-CCYR  REDEFINES  AC-AH-CANCEL-CCYY.     ELCDTEVR
  3367             15  AC-AH-CANCEL-CC               PIC 99.            ELCDTEVR
  3368             15  AC-AH-CANCEL-YR               PIC 99.            ELCDTEVR
  3369         10  AC-AH-CANCEL-MO                   PIC 99.            ELCDTEVR
  3370         10  AC-AH-CANCEL-DA                   PIC 99.            ELCDTEVR
  3371     05  WS-AC-AH-CANCEL-DATE-N REDEFINES                            CL**2
  3372            WS-AC-AH-CANCEL-DATE               PIC 9(11).            CL**2
  3373 01  WS-RATE-RECORD.                                              ELCDTEVR
  3374         05  WS-RT-EXPIRY-DATE.                                   ELCDTEVR
  3375             10  FILLER                        PIC 999.           ELCDTEVR
  3376             10  RT-EXP-CCYY                   PIC 9(04).         ELCDTEVR
  3377             10  RT-EXP-CCYR  REDEFINES  RT-EXP-CCYY.             ELCDTEVR
  3378                 15  RT-EXP-CC                 PIC 99.            ELCDTEVR
  3379                 15  RT-EXP-YR                 PIC 99.            ELCDTEVR
  3380             10  RT-EXP-MO                     PIC 99.            ELCDTEVR
  3381             10  RT-EXP-DA                     PIC 99.            ELCDTEVR
  3382         05  WS-RT-EXPIRY-DATE-N REDEFINES                           CL**2
  3383                WS-RT-EXPIRY-DATE              PIC 9(11).            CL**2
  3384
* 3385                             COPY ELCCRTVR.
  3386***************************************************************** 04/24/98
  3387*                                                                *ELCCRTVR
  3388*                                                                *ELCCRTVR
  3389*                            ELCCRTVR                            *   LV003
  3390*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  3391*                            VMOD=2.001                          *ELCCRTVR
  3392*                                                                *ELCCRTVR
  3393*   WORKING STORAGE FOR DATE VARIABLES CREATED                   *ELCCRTVR
  3394*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCCRTVR
  3395*                                                                *ELCCRTVR
  3396******************************************************************ELCCRTVR
  3397                                                                  ELCCRTVR
  3398 01  WS-CERTIFICATE-RECORD-DATE.                                  ELCCRTVR
  3399     05  WS-CR-DT.                                                ELCCRTVR
  3400         10  FILLER                PIC 999.                       ELCCRTVR
  3401         10  CR-CCYY               PIC 9(04).                     ELCCRTVR
  3402         10  CR-CCYR  REDEFINES  CR-CCYY.                         ELCCRTVR
  3403             15  CR-CC             PIC 99.                        ELCCRTVR
  3404             15  CR-YR             PIC 99.                        ELCCRTVR
  3405         10  CR-MO                 PIC 99.                        ELCCRTVR
  3406         10  CR-DA                 PIC 99.                        ELCCRTVR
  3407     05  WS-CR-DT-N REDEFINES                                        CL**2
  3408            WS-CR-DT               PIC 9(11).                        CL**2
  3409     05  WS-CR-LF-EXPIRE-DATE.                                    ELCCRTVR
  3410         10  FILLER                    PIC 999.                   ELCCRTVR
  3411         10  CR-LF-EXPIRE-CCYY         PIC 9(04).                 ELCCRTVR
  3412         10  CR-LF-EXPIRE-CCYR  REDEFINES  CR-LF-EXPIRE-CCYY.     ELCCRTVR
  3413             15  CR-LF-EXPIRE-CC       PIC 99.                    ELCCRTVR
  3414             15  CR-LF-EXPIRE-YR       PIC 99.                    ELCCRTVR
  3415         10  CR-LF-EXPIRE-MO           PIC 99.                    ELCCRTVR
  3416         10  CR-LF-EXPIRE-DA           PIC 99.                    ELCCRTVR
  3417     05  WS-CR-LF-EXPIRE-DATE-N REDEFINES                            CL**2
  3418            WS-CR-LF-EXPIRE-DATE       PIC 9(11).                    CL**2
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  67
* ECS026.cbl (/apps/prod/cid1p/copy/ELCCRTVR)
  3419     05  WS-CR-AH-EXPIRE-DATE.                                    ELCCRTVR
  3420         10  FILLER                    PIC 999.                   ELCCRTVR
  3421         10  CR-AH-EXPIRE-CCYY         PIC 9(04).                 ELCCRTVR
  3422         10  CR-AH-EXPIRE-CCYR   REDEFINES CR-AH-EXPIRE-CCYY.     ELCCRTVR
  3423             15  CR-AH-EXPIRE-CC       PIC 99.                    ELCCRTVR
  3424             15  CR-AH-EXPIRE-YR       PIC 99.                    ELCCRTVR
  3425         10  CR-AH-EXPIRE-MO           PIC 99.                    ELCCRTVR
  3426         10  CR-AH-EXPIRE-DA           PIC 99.                    ELCCRTVR
  3427     05  WS-CR-AH-EXPIRE-DATE-N REDEFINES                            CL**2
  3428            WS-CR-AH-EXPIRE-DATE       PIC 9(11).                    CL**2
  3429     05  WS-CR-ENTRY-DATE.                                        ELCCRTVR
  3430         10  FILLER                    PIC 999.                   ELCCRTVR
  3431         10  CR-ENTRY-CCYY             PIC 9(04).                 ELCCRTVR
  3432         10  CR-ENTRY-CCYR  REDEFINES  CR-ENTRY-CCYY.             ELCCRTVR
  3433             15 CR-ENTRY-CC            PIC 99.                    ELCCRTVR
  3434             15 CR-ENTRY-YR            PIC 99.                    ELCCRTVR
  3435         10  CR-ENTRY-MO               PIC 99.                    ELCCRTVR
  3436         10  CR-ENTRY-DA               PIC 99.                    ELCCRTVR
  3437     05  WS-CR-ENTRY-DATE-N REDEFINES                                CL**2
  3438            WS-CR-ENTRY-DATE           PIC 9(11).                    CL**2
  3439     05  WS-CR-LF-CANC-DT.                                        ELCCRTVR
  3440         10  FILLER                    PIC 999.                   ELCCRTVR
  3441         10  CR-LF-CNC-CCYY            PIC 9(04).                 ELCCRTVR
  3442         10  CR-LF-CNC-CCYR   REDEFINES CR-LF-CNC-CCYY.           ELCCRTVR
  3443             15  CR-LF-CNC-CC          PIC 99.                    ELCCRTVR
  3444             15  CR-LF-CNC-YR          PIC 99.                    ELCCRTVR
  3445         10  CR-LF-CNC-MO              PIC 99.                    ELCCRTVR
  3446         10  CR-LF-CNC-DA              PIC 99.                    ELCCRTVR
  3447     05  WS-CR-LF-CANC-DT-N REDEFINES                                CL**2
  3448            WS-CR-LF-CANC-DT           PIC 9(11).                    CL**2
  3449     05  WS-CR-LF-CANCEL-EXIT-DATE.                               ELCCRTVR
  3450         10  FILLER                    PIC 999.                   ELCCRTVR
  3451         10  CR-LF-CEX-CCYY            PIC 9(04).                 ELCCRTVR
  3452         10  CR-LF-CEX-CCYR  REDEFINES  CR-LF-CEX-CCYY.              CL**3
  3453             15  CR-LF-CEX-CC          PIC 99.                    ELCCRTVR
  3454             15  CR-LF-CEX-YR          PIC 99.                    ELCCRTVR
  3455         10  CR-LF-CEX-MO              PIC 99.                    ELCCRTVR
  3456         10  CR-LF-CEX-DA              PIC 99.                    ELCCRTVR
  3457     05  WS-CR-LF-CANCEL-EXIT-DATE-N REDEFINES                       CL**2
  3458            WS-CR-LF-CANCEL-EXIT-DATE  PIC 9(11).                    CL**2
  3459     05  WS-CR-LF-CLAIM-EXIT-DATE.                                ELCCRTVR
  3460         10  FILLER                    PIC 999.                   ELCCRTVR
  3461         10  CR-LF-DEX-CCYY            PIC 9(04).                 ELCCRTVR
  3462         10  CR-LF-DEX-CCYR  REDEFINES  CR-LF-DEX-CCYY.           ELCCRTVR
  3463             15  CR-LF-DEX-CC          PIC 99.                    ELCCRTVR
  3464             15  CR-LF-DEX-YR          PIC 99.                    ELCCRTVR
  3465         10  CR-LF-DEX-MO              PIC 99.                    ELCCRTVR
  3466         10  CR-LF-DEX-DA              PIC 99.                    ELCCRTVR
  3467     05  WS-CR-LF-CLAIM-EXIT-DATE-N REDEFINES                        CL**2
  3468            WS-CR-LF-CLAIM-EXIT-DATE   PIC 9(11).                    CL**2
  3469     05  WS-CR-AH-CANC-DT.                                        ELCCRTVR
  3470         10  FILLER                    PIC 999.                   ELCCRTVR
  3471         10  CR-AH-CNC-CCYY            PIC 9(04).                 ELCCRTVR
  3472         10  CR-AH-CNC-CCYR  REDEFINES  CR-AH-CNC-CCYY.           ELCCRTVR
  3473             15  CR-AH-CNC-CC          PIC 99.                    ELCCRTVR
  3474             15  CR-AH-CNC-YR          PIC 99.                    ELCCRTVR
  3475         10  CR-AH-CNC-MO              PIC 99.                    ELCCRTVR
  3476         10  CR-AH-CNC-DA              PIC 99.                    ELCCRTVR
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  68
* ECS026.cbl (/apps/prod/cid1p/copy/ELCCRTVR)
  3477     05  WS-CR-AH-CANC-DT-N  REDEFINES                               CL**2
  3478            WS-CR-AH-CANC-DT           PIC 9(11).                    CL**2
  3479     05  WS-CR-AH-CANCEL-EXIT-DATE.                               ELCCRTVR
  3480         10  FILLER                    PIC 999.                   ELCCRTVR
  3481         10  CR-AH-CEX-CCYY            PIC 9(04).                 ELCCRTVR
  3482         10  CR-AH-CEX-CCYR  REDEFINES  CR-AH-CEX-CCYY.           ELCCRTVR
  3483             15  CR-AH-CEX-CC          PIC 99.                    ELCCRTVR
  3484             15  CR-AH-CEX-YR          PIC 99.                    ELCCRTVR
  3485         10  CR-AH-CEX-MO              PIC 99.                    ELCCRTVR
  3486         10  CR-AH-CEX-DA              PIC 99.                    ELCCRTVR
  3487     05  WS-CR-AH-CANCEL-EXIT-DATE-N REDEFINES                       CL**2
  3488            WS-CR-AH-CANCEL-EXIT-DATE  PIC 9(11).                    CL**2
  3489     05  WS-CR-AH-SETTLEMENT-EXIT-DATE.                           ELCCRTVR
  3490         10  FILLER                    PIC 999.                   ELCCRTVR
  3491         10  CR-AH-DEX-CCYY            PIC 9(04).                 ELCCRTVR
  3492         10  CR-AH-DEX-CCYR  REDEFINES  CR-AH-DEX-CCYY.           ELCCRTVR
  3493             15  CR-AH-DEX-CC          PIC 99.                    ELCCRTVR
  3494             15  CR-AH-DEX-YR          PIC 99.                    ELCCRTVR
  3495         10  CR-AH-DEX-MO              PIC 99.                    ELCCRTVR
  3496         10  CR-AH-DEX-DA              PIC 99.                    ELCCRTVR
  3497     05  WS-CR-AH-SETTLEMENT-EXIT-DATEN REDEFINES                    CL**5
  3498          WS-CR-AH-SETTLEMENT-EXIT-DATE   PIC 9(11).                 CL**5
  3499     05  WS-CR-DTH-DT.                                            ELCCRTVR
  3500         10  FILLER                    PIC 999.                   ELCCRTVR
  3501         10  CR-DTH-CCYY               PIC 9(04).                 ELCCRTVR
  3502         10  CR-DTH-CCYR  REDEFINES  CR-DTH-CCYY.                 ELCCRTVR
  3503             15  CR-DTH-CC             PIC 99.                    ELCCRTVR
  3504             15  CR-DTH-YR             PIC 99.                    ELCCRTVR
  3505         10  CR-DTH-MO                 PIC 99.                    ELCCRTVR
  3506         10  CR-DTH-DA                 PIC 99.                    ELCCRTVR
  3507     05  WS-CR-DTH-DT-N REDEFINES                                    CL**2
  3508            WS-CR-DTH-DT               PIC 9(11).                    CL**2
  3509     05  WS-CR-DTH-PAY-DT.                                        ELCCRTVR
  3510         10  FILLER                    PIC 999.                   ELCCRTVR
  3511         10  CR-DTH-PAY-CCYY           PIC 9(04).                 ELCCRTVR
  3512         10  CR-DTH-PAY-CCYR  REDEFINES CR-DTH-PAY-CCYY.          ELCCRTVR
  3513             15  CR-DTH-PAY-CC         PIC 99.                    ELCCRTVR
  3514             15  CR-DTH-PAY-YR         PIC 99.                    ELCCRTVR
  3515         10  CR-DTH-PAY-MO             PIC 99.                    ELCCRTVR
  3516         10  CR-DTH-PAY-DA             PIC 99.                    ELCCRTVR
  3517     05  WS-CR-DTH-PAY-DT-N REDEFINES                                CL**2
  3518            WS-CR-DTH-PAY-DT           PIC 9(11).                    CL**2
  3519     05  WS-CR-DIS-DT.                                            ELCCRTVR
  3520         10  FILLER                    PIC 999.                   ELCCRTVR
  3521         10  CR-DIS-CCYY               PIC 9(04).                 ELCCRTVR
  3522         10  CR-DIS-CCYR  REDEFINES  CR-DIS-CCYY.                 ELCCRTVR
  3523             15  CR-DIS-CC             PIC 99.                    ELCCRTVR
  3524             15  CR-DIS-YR             PIC 99.                    ELCCRTVR
  3525         10  CR-DIS-MO                 PIC 99.                    ELCCRTVR
  3526         10  CR-DIS-DA                 PIC 99.                    ELCCRTVR
  3527     05  WS-CR-DIS-DT-N REDEFINES                                    CL**2
  3528            WS-CR-DIS-DT               PIC 9(11).                    CL**2
  3529     05  WS-CR-DIS-PAY-DT.                                        ELCCRTVR
  3530         10  FILLER                    PIC 999.                   ELCCRTVR
  3531         10  CR-DIS-PAY-CCYY           PIC 9(04).                 ELCCRTVR
  3532         10  CR-DIS-PAY-CCYR  REDEFINES  CR-DIS-PAY-CCYY.         ELCCRTVR
  3533             15  CR-DIS-PAY-CC         PIC 99.                    ELCCRTVR
  3534             15  CR-DIS-PAY-YR         PIC 99.                    ELCCRTVR
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  69
* ECS026.cbl (/apps/prod/cid1p/copy/ELCCRTVR)
  3535         10  CR-DIS-PAY-MO             PIC 99.                    ELCCRTVR
  3536         10  CR-DIS-PAY-DA             PIC 99.                    ELCCRTVR
  3537     05  WS-CR-DIS-PAY-DT-N REDEFINES                                CL**2
  3538            WS-CR-DIS-PAY-DT           PIC 9(11).                    CL**2
  3539     05  WS-CR-DIS-PTO-DT.                                        ELCCRTVR
  3540         10  FILLER                    PIC 999.                   ELCCRTVR
  3541         10  CR-DIS-PTO-CCYY           PIC 9(04).                 ELCCRTVR
  3542         10  CR-DIS-PTO-CCYR  REDEFINES  CR-DIS-PTO-CCYY.         ELCCRTVR
  3543             15  CR-DIS-PTO-CC         PIC 99.                    ELCCRTVR
  3544             15  CR-DIS-PTO-YR         PIC 99.                    ELCCRTVR
  3545         10  CR-DIS-PTO-MO             PIC 99.                    ELCCRTVR
  3546         10  CR-DIS-PTO-DA             PIC 99.                    ELCCRTVR
  3547     05  WS-CR-DIS-PTO-DT-N REDEFINES                                CL**2
  3548            WS-CR-DIS-PTO-DT           PIC 9(11).                    CL**2
  3549     05  COPY-NDX                      PIC 9.                        CL**6
  3550     05  WS-DIS-INCUR-DT OCCURS 5 TIMES.                             CL**6
  3551         10  WS-CR-DIS-INCUR-DT.                                  ELCCRTVR
  3552             15  FILLER                PIC 999.                   ELCCRTVR
  3553             15  CR-DIS-INC-CCYY       PIC 9(04).                 ELCCRTVR
  3554             15  CR-DIS-INC-CCYR  REDEFINES  CR-DIS-INC-CCYY.     ELCCRTVR
  3555                 20  CR-DIS-INC-CC     PIC 99.                    ELCCRTVR
  3556                 20  CR-DIS-INC-YR     PIC 99.                    ELCCRTVR
  3557             15  CR-DIS-INC-MO         PIC 99.                    ELCCRTVR
  3558             15  CR-DIS-INC-DA         PIC 99.                    ELCCRTVR
  3559         10  WS-CR-DIS-INCUR-DT-N REDEFINES                          CL**2
  3560                WS-CR-DIS-INCUR-DT     PIC 9(11).                    CL**2
  3561
* 3562                             COPY ELCPSEVR.
  3563******************************************************************04/16/98
  3564*                                                                *ELCPSEVR
  3565*                                                                *ELCPSEVR
  3566*                            ELCPSEVR                            *   LV003
  3567*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  3568*                            VMOD=2.001                          *ELCPSEVR
  3569*                                                                *ELCPSEVR
  3570*   WORKING STORAGE FOR DATE VARIABLES CREATED                   *ELCPSEVR
  3571*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCPSEVR
  3572*                                                                *ELCPSEVR
  3573******************************************************************ELCPSEVR
  3574                                                                  ELCPSEVR
  3575 01  WS-PD-SUMMARY-DETAIL-EXTR-DT.                                ELCPSEVR
  3576     05  WS-PSC-CID-LOW.                                          ELCPSEVR
  3577         10  FILLER               PIC 999.                        ELCPSEVR
  3578         10  PSC-CID-LOW-CCYY     PIC 9(04).                      ELCPSEVR
  3579         10  PSC-CID-LOW-CCYR  REDEFINES  PSC-CID-LOW-CCYY.       ELCPSEVR
  3580             15  PSC-CID-LOW-CC   PIC 99.                            CL**3
  3581             15  PSC-CID-LOW-YY   PIC 99.                            CL**3
  3582         10  PSC-CID-LOW-MM       PIC 99.                            CL**3
  3583         10  PSC-CID-LOW-DD       PIC 99.                            CL**3
  3584     05  WS-PSC-CID-LOW-N REDEFINES                                  CL**2
  3585            WS-PSC-CID-LOW        PIC 9(11).                         CL**2
  3586     05  WS-PSC-CID-HIGH.                                         ELCPSEVR
  3587         10  FILLER              PIC 999.                         ELCPSEVR
  3588         10  PSC-CID-HIGH-CCYY   PIC 9(04).                       ELCPSEVR
  3589         10  PSC-CID-HIGH-CCYR  REDEFINES  PSC-CID-HIGH-CCYY.     ELCPSEVR
  3590             15  PSC-CID-HIGH-CC PIC 99.                             CL**3
  3591             15  PSC-CID-HIGH-YY PIC 99.                             CL**3
  3592         10  PSC-CID-HIGH-MM     PIC 99.                             CL**3
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  70
* ECS026.cbl (/apps/prod/cid1p/copy/ELCPSEVR)
  3593         10  PSC-CID-HIGH-DD     PIC 99.                             CL**3
  3594     05  WS-PSC-CID-HIGH-N REDEFINES                                 CL**2
  3595            WS-PSC-CID-HIGH          PIC 9(11).                      CL**2
  3596 01  WS-REIN-WORK-AREAS.                                          ELCPSEVR
  3597     05  WS-REIN-CO-HOLD-ENTRIES  OCCURS 1500 TIMES               ELCPSEVR
  3598                 INDEXED BY CPSE-NDX.                             ELCPSEVR
  3599         10  WS-RCT-CLM-CUTOFF-DT.                                ELCPSEVR
  3600             15  FILLER              PIC 999.                     ELCPSEVR
  3601             15  RCT-CUTOFF-CCYY     PIC 9(04).                   ELCPSEVR
  3602             15  RCT-CUTOFF-CCYR  REDEFINES  RCT-CUTOFF-CCYY.     ELCPSEVR
  3603                 20  RCT-CUTOFF-CC   PIC 99.                      ELCPSEVR
  3604                 20  RCT-CUTOFF-YR   PIC 99.                      ELCPSEVR
  3605             15  RCT-CUTOFF-MO       PIC 99.                      ELCPSEVR
  3606             15  RCT-CUTOFF-DA       PIC 99.                      ELCPSEVR
  3607         10  WS-RCT-CLM-CUTOFF-DT-N REDEFINES                        CL**2
  3608                WS-RCT-CLM-CUTOFF-DT PIC 9(11).                      CL**2
  3609         10  WS-RCT-EARNING-START-DT.                             ELCPSEVR
  3610             15  FILLER              PIC 999.                     ELCPSEVR
  3611             15  RCT-START-CCYY      PIC 9(04).                   ELCPSEVR
  3612             15  RCT-START-CCYR  REDEFINES  RCT-START-CCYY.       ELCPSEVR
  3613                 20  RCT-START-CC    PIC 99.                      ELCPSEVR
  3614                 20  RCT-START-YR    PIC 99.                      ELCPSEVR
  3615             15  RCT-START-MO        PIC 99.                      ELCPSEVR
  3616             15  RCT-START-DA        PIC 99.                      ELCPSEVR
  3617         10  WS-RCT-EARNING-START-DT-N REDEFINES                     CL**2
  3618                WS-RCT-EARNING-START-DT  PIC 9(11).                  CL**2
  3619         10  WS-RCT-EARNING-STOP-DT.                              ELCPSEVR
  3620             15  FILLER              PIC 999.                     ELCPSEVR
  3621             15  RCT-STOP-CCYY       PIC 9(04).                   ELCPSEVR
  3622             15  RCT-STOP-CCYR  REDEFINES  RCT-STOP-CCYY.         ELCPSEVR
  3623                 20  RCT-STOP-CC     PIC 99.                      ELCPSEVR
  3624                 20  RCT-STOP-YR     PIC 99.                      ELCPSEVR
  3625             15  RCT-STOP-MO         PIC 99.                      ELCPSEVR
  3626             15  RCT-STOP-DA         PIC 99.                      ELCPSEVR
  3627         10  WS-RCT-EARNING-STOP-DT-N REDEFINES                      CL**2
  3628                WS-RCT-EARNING-STOP-DT   PIC 9(11).                  CL**2
  3629     05  WS-RWF-EP-STOP-DATE.                                     ELCPSEVR
  3630         10  FILLER              PIC 999.                         ELCPSEVR
  3631         10  RWF-EP-STOP-CCYY    PIC 9(04).                       ELCPSEVR
  3632         10  RWF-EP-STOP-CCYR REDEFINES  RWF-EP-STOP-CCYY.        ELCPSEVR
  3633             15  RWF-EP-STOP-CC  PIC 99.                          ELCPSEVR
  3634             15  RWF-EP-STOP-YR  PIC 99.                          ELCPSEVR
  3635         10  RWF-EP-STOP-MO      PIC 99.                          ELCPSEVR
  3636         10  RWF-EP-STOP-DA      PIC 99.                          ELCPSEVR
  3637     05  WS-RWF-EP-STOP-DATE-N REDEFINES                             CL**2
  3638            WS-RWF-EP-STOP-DATE  PIC 9(11).                          CL**2
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  71
* ECS026.cbl
  3640 PROCEDURE DIVISION.
  3641
  3642 0000-READ-DATE-CARD.
* 3643                             COPY ELCDTERX.
  3644******************************************************************04/15/98
  3645*                                                                *ELCDTERX
  3646*                                                                *ELCDTERX
  3647*                            ELCDTERX.                           *   LV002
  3648*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  3649*                            VMOD=2.007                          *ELCDTERX
  3650*                                                                *ELCDTERX
  3651*      LOAD DATE CARD DISK FILE INTO WORKING STORAGE AREA        *ELCDTERX
  3652*      (COPY CODE FOR W/S = ELCDTECX AND COPY CODE FOR FD        *ELCDTERX
  3653*      = ELCDTEFD)                                               *ELCDTERX
  3654*                                                                *ELCDTERX
  3655******************************************************************ELCDTERX
  3656                                                                  ELCDTERX
  3657     ACCEPT WS-ACCEPT-DATE       FROM  DATE.                      ELCDTERX
  3658                                                                  ELCDTERX
  3659     MOVE WS-AD-YY               TO  WS-CD-YY.                    ELCDTERX
  3660     MOVE WS-AD-MM               TO  WS-CD-MM.                    ELCDTERX
  3661     MOVE WS-AD-DD               TO  WS-CD-DD.                    ELCDTERX
  3662                                                                  ELCDTERX
  3663     ACCEPT WS-TIME-OF-DAY       FROM  TIME.                      ELCDTERX
  3664                                                                  ELCDTERX
  3665******************************************************************ELCDTERX
  3666*    NOTE: THE FOLLOWING STATEMENT IS USED TO ELIMINATE COB II    ELCDTERX
  3667*          WARNING MESSAGES.                                      ELCDTERX
  3668******************************************************************ELCDTERX
  3669     IF WS-CD-YY = LOW-VALUES                                     ELCDTERX
  3670         COMPUTE PGM-SUB = PGM-SUB + 1.                           ELCDTERX
  3671                                                                  ELCDTERX
  3672     OPEN INPUT DISK-DATE.                                        ELCDTERX
  3673                                                                  ELCDTERX
  3674     MOVE SPACE TO DATE-CARD         CLAS-BUSINESS-CLASSES        ELCDTERX
  3675                   STATE-NAMES       CLAS-MORTALITY-CODES         ELCDTERX
  3676                   CLAS-INS-TYPES    COMPANY-NAME-TABLE           ELCDTERX
  3677                   DATE-CARD-OPTIONS DATE-CARD-FACTORS            ELCDTERX
  3678                   CLAX-ID           CLAS-MISC                    ELCDTERX
  3679                   CARRIER-NAMES     CLASIC-SYSTEM-CODES          ELCDTERX
  3680                   CARRIER-OPT-CLAIM-DATA                         ELCDTERX
  3681                   STATE-TARGET-LOSS-RATIOS                       ELCDTERX
  3682                   BUSINESS-TRGT-LOSS-RATIO-MODS                  ELCDTERX
  3683                   MISC-OPT-CLM-RSV-DATA.                         ELCDTERX
  3684                                                                  ELCDTERX
  3685     MOVE LOW-VALUES TO CLAS-INDEX-TBL CLAS-TYPE-MISC.            ELCDTERX
  3686                                                                  ELCDTERX
  3687     MOVE ZERO TO CLAS-CN DTE-TOT-LINES CLAS-CO                   ELCDTERX
  3688                  INDEXCA INDEXBS INDEXST.                        ELCDTERX
  3689                                                                  ELCDTERX
  3690     COMPUTE CLAS-CN = PGM-SUB / +50.                             ELCDTERX
  3691     COMPUTE CLAS-CO = PGM-SUB / +20.                             ELCDTERX
  3692     COMPUTE CLAS-INDEXEN = PGM-SUB - (CLAS-CN * +50).            ELCDTERX
  3693     COMPUTE CLAS-INDEXON = PGM-SUB - (CLAS-CO * +20).            ELCDTERX
  3694                                                                  ELCDTERX
  3695     IF CLAS-INDEXEN = ZERO                                       ELCDTERX
  3696         MOVE +50               TO CLAS-INDEXEN                   ELCDTERX
  3697     ELSE                                                         ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  72
* ECS026.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  3698         ADD +1                 TO CLAS-CN.                       ELCDTERX
  3699                                                                  ELCDTERX
  3700     IF CLAS-INDEXON = ZERO                                       ELCDTERX
  3701         MOVE +20               TO CLAS-INDEXON                   ELCDTERX
  3702     ELSE                                                         ELCDTERX
  3703         ADD +1                 TO CLAS-CO.                       ELCDTERX
  3704                                                                  ELCDTERX
  3705 0005-READ--CARD.                                                 ELCDTERX
  3706     READ DISK-DATE                                               ELCDTERX
  3707         AT END CLOSE DISK-DATE                                   ELCDTERX
  3708             GO TO 0060-READ--TEST.                               ELCDTERX
  3709                                                                  ELCDTERX
  3710     MOVE ZERO                   TO CLAS-INDEX.                   ELCDTERX
  3711                                                                  ELCDTERX
  3712     IF DD-ID = 'CLAS' OR 'LIFE' OR 'GLED'                        ELCDTERX
  3713         MOVE DATE-DISK          TO DATE-CARD                     ELCDTERX
  3714         MOVE RUN-DATE           TO WS-RUN-DATE-N                    CL**2
  3715         MOVE EP-DT              TO WS-EP-DT-N                       CL**2
  3716         GO TO 0005-READ--CARD.                                   ELCDTERX
  3717                                                                  ELCDTERX
  3718     IF DD-ID = 'CLAD'                                            ELCDTERX
  3719         MOVE DATE-DISK          TO DATE-CARD-OPTIONS             ELCDTERX
  3720         GO TO 0005-READ--CARD.                                   ELCDTERX
  3721                                                                  ELCDTERX
  3722     IF DD-ID = 'CLAX'                                            ELCDTERX
  3723         MOVE DATE-DISK          TO CLAS-INDEX-TBL                ELCDTERX
  3724         GO TO 0005-READ--CARD.                                   ELCDTERX
  3725                                                                  ELCDTERX
  3726     IF DD-ID = 'CLAF'                                            ELCDTERX
  3727         MOVE DATE-DISK          TO DATE-CARD-FACTORS             ELCDTERX
  3728         GO TO 0005-READ--CARD.                                   ELCDTERX
  3729                                                                  ELCDTERX
  3730     IF DD-ID = 'CLAC'                                            ELCDTERX
  3731         GO TO 0010-READ--CLAC.                                   ELCDTERX
  3732                                                                  ELCDTERX
  3733     IF DD-ID = 'CARR'                                            ELCDTERX
  3734         GO TO 0015-READ--CARR.                                   ELCDTERX
  3735                                                                  ELCDTERX
  3736     IF DD-ID = 'STAT'                                            ELCDTERX
  3737         GO TO 0020-READ--STAT.                                   ELCDTERX
  3738                                                                  ELCDTERX
  3739     IF DD-ID = 'BUSC'                                            ELCDTERX
  3740         GO TO 0025-READ--BUSC.                                   ELCDTERX
  3741                                                                  ELCDTERX
  3742     IF DD-ID = 'MORT'                                            ELCDTERX
  3743         GO TO 0030-READ--MORT.                                   ELCDTERX
  3744                                                                  ELCDTERX
  3745     IF DD-ID = 'CLAI'                                            ELCDTERX
  3746         GO TO 0040-READ--CLAI.                                   ELCDTERX
  3747                                                                  ELCDTERX
  3748     IF DD-ID = 'COLC'                                            ELCDTERX
  3749         GO TO 0065-READ--COLC.                                   ELCDTERX
  3750                                                                  ELCDTERX
  3751     IF DD-IDX NUMERIC AND                                        ELCDTERX
  3752        DD-IDA = 'CL'                                             ELCDTERX
  3753         GO TO 0035-READ--CLXX.                                   ELCDTERX
  3754                                                                  ELCDTERX
  3755     IF DD-IDX NUMERIC AND                                        ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  73
* ECS026.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  3756        DD-IDA = 'PO'                                             ELCDTERX
  3757         GO TO 0050-READ--POXX.                                   ELCDTERX
  3758                                                                  ELCDTERX
  3759     IF DD-ID = 'OPCA'                                            ELCDTERX
  3760         GO TO 0070-READ--OPCA.                                   ELCDTERX
  3761                                                                  ELCDTERX
  3762     IF DD-ID = 'OPST'                                            ELCDTERX
  3763         GO TO 0072-READ--OPST.                                   ELCDTERX
  3764                                                                  ELCDTERX
  3765     IF DD-ID = 'OPBS'                                            ELCDTERX
  3766         GO TO 0074-READ--OPBS.                                   ELCDTERX
  3767                                                                  ELCDTERX
  3768     IF DD-ID = 'OPMS'                                            ELCDTERX
  3769         MOVE DD-MISC-DATA       TO MISC-OPT-CLM-RSV-DATA.        ELCDTERX
  3770                                                                  ELCDTERX
  3771     GO TO 0005-READ--CARD.                                       ELCDTERX
  3772                                                                  ELCDTERX
  3773 0010-READ--CLAC.                                                 ELCDTERX
  3774     ADD 1                       TO CLAS-INDEXC.                  ELCDTERX
  3775     MOVE DD-CR1                 TO CNT-ID (CLAS-INDEXC).         ELCDTERX
  3776     MOVE DD-CR1N                TO CNT-NAME (CLAS-INDEXC).       ELCDTERX
  3777     ADD 1                       TO CLAS-INDEXC.                  ELCDTERX
  3778     MOVE DD-CR2                 TO CNT-ID (CLAS-INDEXC).         ELCDTERX
  3779     MOVE DD-CR2N                TO CNT-NAME (CLAS-INDEXC).       ELCDTERX
  3780     GO TO 0005-READ--CARD.                                       ELCDTERX
  3781                                                                  ELCDTERX
  3782 0015-READ--CARR.                                                 ELCDTERX
  3783     ADD 1  TO  CLAS-INDEXCN.                                     ELCDTERX
  3784     IF CLAS-INDEXCN LESS THAN +26                                ELCDTERX
  3785        MOVE DD-CARR1         TO CARRIER-SUB (CLAS-INDEXCN)
  3786        MOVE DD-CARR1S        TO CARRIER-DOM-ST (CLAS-INDEXCN)
  3787        MOVE DD-CARR1N        TO CARRIER-PIC (CLAS-INDEXCN)
  3788        MOVE DD-CARR1-UEP-PCT TO CARRIER-UEP-PCT (CLAS-INDEXCN)
  3789        MOVE DD-CARR1-R78-PCT TO CARRIER-R78-PCT (CLAS-INDEXCN)
  3790        MOVE DD-CARR1-PRO-PCT TO CARRIER-PRO-PCT (CLAS-INDEXCN)
  3791        MOVE DD-CARR1-SECPAY-SW
  3792                               TO CARRIER-SEC-PAY (CLAS-INDEXCN)
  3793     END-IF
  3794                                                                  ELCDTERX
  3795     ADD 1  TO  CLAS-INDEXCN.                                     ELCDTERX
  3796     IF CLAS-INDEXCN LESS THAN +26                                ELCDTERX
  3797        MOVE DD-CARR2         TO CARRIER-SUB (CLAS-INDEXCN)
  3798        MOVE DD-CARR2S        TO CARRIER-DOM-ST (CLAS-INDEXCN)
  3799        MOVE DD-CARR2N        TO CARRIER-PIC (CLAS-INDEXCN)
  3800        MOVE DD-CARR2-UEP-PCT TO CARRIER-UEP-PCT (CLAS-INDEXCN)
  3801        MOVE DD-CARR2-R78-PCT TO CARRIER-R78-PCT (CLAS-INDEXCN)
  3802        MOVE DD-CARR2-PRO-PCT TO CARRIER-PRO-PCT (CLAS-INDEXCN)
  3803        MOVE DD-CARR2-SECPAY-SW
  3804                              TO CARRIER-SEC-PAY (CLAS-INDEXCN)
  3805     END-IF
  3806                                                                  ELCDTERX
  3807                                                                  ELCDTERX
  3808     GO TO 0005-READ--CARD.                                       ELCDTERX
  3809                                                                  ELCDTERX
  3810 0020-READ--STAT.                                                 ELCDTERX
  3811     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  3812     IF CLAS-INDEX GREATER 3  OR                                  ELCDTERX
  3813        DD-ST (CLAS-INDEX) = SPACE                                ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  74
* ECS026.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  3814         GO TO 0005-READ--CARD.                                   ELCDTERX
  3815                                                                  ELCDTERX
  3816     ADD 1                       TO CLAS-INDEXS.                  ELCDTERX
  3817     MOVE DD-ST (CLAS-INDEX)     TO STATE-NAME-FLD (CLAS-INDEXS). ELCDTERX
  3818     GO TO 0020-READ--STAT.                                       ELCDTERX
  3819                                                                  ELCDTERX
  3820 0025-READ--BUSC.                                                 ELCDTERX
  3821     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  3822     IF CLAS-INDEX GREATER 3  OR                                  ELCDTERX
  3823        DD-ST (CLAS-INDEX) = SPACE                                ELCDTERX
  3824         GO TO 0005-READ--CARD.                                   ELCDTERX
  3825                                                                  ELCDTERX
  3826     ADD 1                       TO CLAS-INDEXB.                  ELCDTERX
  3827     MOVE DD-ST (CLAS-INDEX)     TO CLAS-BUSC-FLD (CLAS-INDEXB).  ELCDTERX
  3828     GO TO 0025-READ--BUSC.                                       ELCDTERX
  3829                                                                  ELCDTERX
  3830 0030-READ--MORT.                                                 ELCDTERX
  3831     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  3832     IF CLAS-INDEX GREATER 2  OR                                  ELCDTERX
  3833        DD-MORT (CLAS-INDEX) = SPACE                              ELCDTERX
  3834         GO TO 0005-READ--CARD.                                   ELCDTERX
  3835                                                                  ELCDTERX
  3836     ADD 1                       TO CLAS-INDEXM.                  ELCDTERX
  3837     MOVE DD-MORT (CLAS-INDEX)   TO CLAS-MORT-FLD (CLAS-INDEXM).  ELCDTERX
  3838     GO TO 0030-READ--MORT.                                       ELCDTERX
  3839                                                                  ELCDTERX
  3840 0035-READ--CLXX.                                                 ELCDTERX
  3841     IF DD-IDX NOT = CLAS-CN                                      ELCDTERX
  3842          GO TO 0005-READ--CARD.                                  ELCDTERX
  3843                                                                  ELCDTERX
  3844     IF DD-PS-PIC (CLAS-INDEXEN) = 'X'                            ELCDTERX
  3845         DISPLAY '***********************************************'ELCDTERX
  3846         DISPLAY 'PROGRAM ECS-', PGM-SUB, ' NOT SCHEDULED TO RUN' ELCDTERX
  3847         DISPLAY '***********************************************'ELCDTERX
  3848         GO TO 0055-READ--STOP.                                   ELCDTERX
  3849                                                                  ELCDTERX
  3850     IF DD-PS-PIC (CLAS-INDEXEN) NOT LESS 'A'  AND                ELCDTERX
  3851        DD-PS-PIC (CLAS-INDEXEN) NOT GREATER 'I'                  ELCDTERX
  3852         MOVE '1'                TO DTE-FICH.                     ELCDTERX
  3853                                                                  ELCDTERX
  3854     IF DD-PS-PIC (CLAS-INDEXEN) NOT LESS 'J'  AND                ELCDTERX
  3855        DD-PS-PIC (CLAS-INDEXEN) NOT GREATER 'R'                  ELCDTERX
  3856         MOVE '2'                TO DTE-FICH.                     ELCDTERX
  3857                                                                  ELCDTERX
  3858*    MOVE DD-PS-PIC (CLAS-INDEXEN) TO DTE-PGM-OPT.                ELCDTERX
  3859     GO TO 0005-READ--CARD.                                       ELCDTERX
  3860                                                                  ELCDTERX
  3861 0040-READ--CLAI.                                                 ELCDTERX
  3862     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  3863     IF CLAS-INDEX GREATER 2  OR                                  ELCDTERX
  3864        DD-TYPE (CLAS-INDEX) = SPACE                              ELCDTERX
  3865         GO TO 0005-READ--CARD.                                   ELCDTERX
  3866                                                                  ELCDTERX
  3867     ADD 1                       TO CLAS-INDEXA.                  ELCDTERX
  3868     MOVE DD-TYPE (CLAS-INDEX) TO CLAS-ALL-TYPES (CLAS-INDEXA).   ELCDTERX
  3869     GO TO 0040-READ--CLAI.                                       ELCDTERX
  3870                                                                  ELCDTERX
  3871 0045-READ--DUMP.                                                 ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  75
* ECS026.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  3872     MOVE +999 TO WS-RETURN-CODE                                  ELCDTERX
  3873     MOVE 'MISSING AND/OR INVALID CLAS DATE CARD'                 ELCDTERX
  3874                                 TO  WS-ABEND-MESSAGE             ELCDTERX
  3875     PERFORM ABEND-PGM.                                           ELCDTERX
  3876                                                                  ELCDTERX
  3877 0050-READ--POXX.                                                 ELCDTERX
  3878     IF DD-IDX NOT = CLAS-CO                                      ELCDTERX
  3879         GO TO 0005-READ--CARD.                                   ELCDTERX
  3880                                                                  ELCDTERX
  3881     IF DD-PS-PRC (CLAS-INDEXON) = 'X'                            ELCDTERX
  3882         DISPLAY '***********************************************'ELCDTERX
  3883         DISPLAY 'ECS - ', PGM-SUB, ' IS NOT SCHEDULED TO RUN'    ELCDTERX
  3884         DISPLAY '***********************************************'ELCDTERX
  3885         GO TO 0055-READ--STOP.                                   ELCDTERX
  3886                                                                  ELCDTERX
  3887     MOVE DD-PS-PRT (CLAS-INDEXON) TO DTE-PRT-OPT.                ELCDTERX
  3888     MOVE DD-PS-FMT (CLAS-INDEXON) TO DTE-FMT-OPT.                ELCDTERX
  3889     MOVE DD-PS-PRC (CLAS-INDEXON) TO DTE-PRC-OPT DTE-PGM-OPT.    ELCDTERX
  3890     MOVE DD-PS-TOT (CLAS-INDEXON) TO DTE-TOT-OPT.                ELCDTERX
  3891                                                                  ELCDTERX
  3892     IF DTE-PRT-OPT = 'B'                                         ELCDTERX
  3893         MOVE '2'                  TO DTE-FICH.                   ELCDTERX
  3894     IF DTE-PRT-OPT = 'F'                                         ELCDTERX
  3895         MOVE '1'                  TO DTE-FICH.                   ELCDTERX
  3896                                                                  ELCDTERX
  3897     GO TO 0005-READ--CARD.                                       ELCDTERX
  3898                                                                  ELCDTERX
  3899 0055-READ--STOP.                                                 ELCDTERX
  3900     GOBACK.                                                      ELCDTERX
  3901                                                                  ELCDTERX
  3902 0060-READ--TEST.                                                 ELCDTERX
  3903     IF DATX-COD        = SPACE  OR                               ELCDTERX
  3904        CLAX-ID         = SPACE  OR                               ELCDTERX
  3905        DATE-OPTIONS-ID = SPACE                                   ELCDTERX
  3906         GO TO 0045-READ--DUMP.                                   ELCDTERX
  3907                                                                  ELCDTERX
  3908     MOVE LOW-VALUE TO CLAS-TYPE-MISC.                            ELCDTERX
  3909     GO TO 0079-READ--EXIT.                                       ELCDTERX
  3910                                                                  ELCDTERX
  3911 0065-READ--COLC.                                                 ELCDTERX
  3912     MOVE DATE-DISK              TO CLASIC-SYSTEM-CODES.          ELCDTERX
  3913     GO TO 0005-READ--CARD.                                       ELCDTERX
  3914                                                                  ELCDTERX
  3915 0070-READ--OPCA.                                                 ELCDTERX
  3916                                                                  ELCDTERX
  3917     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  3918                                                                  ELCDTERX
  3919     IF  CLAS-INDEX GREATER 13                                    ELCDTERX
  3920             OR                                                   ELCDTERX
  3921         DD-CARR-FLDS (CLAS-INDEX) = SPACE                        ELCDTERX
  3922         GO TO 0005-READ--CARD.                                   ELCDTERX
  3923                                                                  ELCDTERX
  3924     ADD 1                       TO INDEXCA.                      ELCDTERX
  3925     MOVE DD-CARR-FLDS (CLAS-INDEX)                               ELCDTERX
  3926                                 TO CARRIER-FLDS (INDEXCA).       ELCDTERX
  3927     GO TO 0070-READ--OPCA.                                       ELCDTERX
  3928                                                                  ELCDTERX
  3929 0072-READ--OPST.                                                 ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  76
* ECS026.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  3930                                                                  ELCDTERX
  3931     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  3932                                                                  ELCDTERX
  3933     IF  CLAS-INDEX GREATER 16                                    ELCDTERX
  3934             OR                                                   ELCDTERX
  3935         DD-TLR (CLAS-INDEX) = SPACE                              ELCDTERX
  3936         GO TO 0005-READ--CARD.                                   ELCDTERX
  3937                                                                  ELCDTERX
  3938     ADD 1                       TO INDEXST.                      ELCDTERX
  3939     MOVE DD-STATE-FLDS (CLAS-INDEX)                              ELCDTERX
  3940                                 TO STATE-TLR-FLD (INDEXST).      ELCDTERX
  3941     GO TO 0072-READ--OPST.                                       ELCDTERX
  3942                                                                  ELCDTERX
  3943 0074-READ--OPBS.                                                 ELCDTERX
  3944                                                                  ELCDTERX
  3945     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  3946                                                                  ELCDTERX
  3947     IF  CLAS-INDEX GREATER 32                                    ELCDTERX
  3948             OR                                                   ELCDTERX
  3949         DD-TLR (CLAS-INDEX) = SPACE                              ELCDTERX
  3950         GO TO 0005-READ--CARD.                                   ELCDTERX
  3951                                                                  ELCDTERX
  3952     ADD 1                       TO INDEXBS.                      ELCDTERX
  3953     MOVE DD-TLR (CLAS-INDEX)    TO BUS-TLRM-FLD (INDEXBS).       ELCDTERX
  3954     GO TO 0074-READ--OPBS.                                       ELCDTERX
  3955                                                                  ELCDTERX
  3956 0079-READ--EXIT.                                                 ELCDTERX
  3957*    EXIT.                                                        ELCDTERX
  3958******************************************************************ELCDTERX
  3959
  3960 0100-MAIN-LINE.
  3961
  3962     OPEN OUTPUT PRINTER.
  3963
  3964     PERFORM 0120-INITIALIZATION  THRU 0199-EXIT.
  3965
  3966     PERFORM 0200-MAIN-PROCESSING THRU 0299-EXIT.
  3967
  3968     CLOSE PRINTER.
  3969
  3970 0110-CLOSE-FICH.
* 3971                             COPY ELCPRTC.
  3972******************************************************************04/15/98
  3973*                                                                *ELCPRTC
  3974*                                                                *ELCPRTC
  3975*                            ELCPRTC.                            *   LV003
  3976*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
  3977*                            VMOD=2.002                          *   CL**2
  3978*       CLOSE FICH FILE IF OPEN                                  *ELCPRTC
  3979*                                                                *ELCPRTC
  3980* NOTE- USE ELCPRTCX IF USING ELCPRT2X (ONLINE REPORT SAVE)      *   CL**2
  3981******************************************************************ELCPRTC
  3982                                                                  ELCPRTC
  3983      IF FICH-OPEN NOT = SPACE                                    ELCPRTC
  3984          CLOSE FICH.                                             ELCPRTC
  3985                                                                  ELCPRTC
  3986******************************************************************ELCPRTC
  3987
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  77
* ECS026.cbl
  3988     GOBACK.
  3989
  3990 0120-INITIALIZATION.
  3991     MOVE WS-CURRENT-DATE        TO H2-CURRENT-DATE.
  3992
  3993     MOVE COMPANY-NAME           TO H2-COMPANY.
  3994     MOVE ALPH-DATE              TO H3-RUN-DATE.
  3995
  3996     MOVE SPACES TO REIN-LEVELS-END.
  3997     PERFORM CLEAR-REIN-HOLD THRU CLEAR-REIN-HOLD-X.
  3998
  3999     MOVE '1'                    TO WK-BREAK-TYPE.
  4000     PERFORM 6500-CLEAR-ACCUMULATOR-TABLE THRU 6599-EXIT.
  4001
  4002     MOVE '2'                    TO WK-BREAK-TYPE.
  4003     PERFORM 6500-CLEAR-ACCUMULATOR-TABLE THRU 6599-EXIT.
  4004
  4005     MOVE '3'                    TO WK-BREAK-TYPE.
  4006     PERFORM 6500-CLEAR-ACCUMULATOR-TABLE THRU 6599-EXIT.
  4007
  4008     MOVE '4'                    TO WK-BREAK-TYPE.
  4009     PERFORM 6500-CLEAR-ACCUMULATOR-TABLE THRU 6599-EXIT.
  4010
  4011     MOVE '5'                    TO WK-BREAK-TYPE.
  4012     PERFORM 6500-CLEAR-ACCUMULATOR-TABLE THRU 6599-EXIT.
  4013
  4014     PERFORM 6700-CLEAR-PRINT-TABLE THRU 6799-EXIT.
  4015
  4016     MOVE  '1'                   TO WK-BREAK-TYPE.
  4017
  4018     IF DTE-PRC-OPT NOT NUMERIC
  4019         MOVE 1 TO DTE-PRC-OPT.
  4020
  4021     IF DTE-TOT-OPT NOT NUMERIC
  4022         MOVE 1 TO DTE-TOT-OPT.
  4023
  4024     MOVE RUN-DATE              TO EOM-RUN-DATE.
  4025     MOVE BIN-RUN-DATE          TO BIN-EOM-DT.
  4026
  4027     MOVE RUN-CCYY              TO POT-CCYY.
  4028     MOVE RUN-MO                TO POT-MO.
  4029
  4030     IF DTE-PRC-OPT = 1 OR 2 OR 3 OR 4
  4031         COMPUTE POF-CCYY = RUN-CCYY - DTE-PRC-OPT
  4032         COMPUTE POF-MO   = RUN-MO + 1
  4033         IF POF-MO GREATER 12
  4034             MOVE 01 TO POF-MO
  4035             ADD 1 TO POF-CCYY.
  4036
  4037     perform varying s1 from 1 by 1 until s1 > 8
  4038        move zeros to dl-amt (s1)
  4039                      dl-amt1 (s1)
  4040                      dl-amt2 (s1)
  4041     end-perform
  4042
  4043     display ' FROM DATE ' process-opt-from-dt
  4044     display ' THRU DATE ' process-opt-thru-dt
  4045
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  78
* ECS026.cbl
  4046     .
  4047 0199-EXIT.
  4048     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  79
* ECS026.cbl
  4050 0200-MAIN-PROCESSING.
  4051     PERFORM  0300-CREATE-EXTRACTS  THRU  0399-EXIT.
  4052
  4053     CLOSE TEMP-WORK.
  4054     SORT SORT-WORK ON ASCENDING SR-CONTROL
  4055                                 USING  TEMP-WORK
  4056                                 GIVING TEMP-WORK.
  4057
  4058     IF SORT-RETURN NOT = ZEROS
  4059         MOVE  '0101'            TO  WS-RETURN-CODE
  4060         MOVE  'SORT ERROR'      TO  WS-ABEND-MESSAGE
  4061         GO TO ABEND-PGM.
  4062
  4063     OPEN INPUT TEMP-WORK.
  4064
  4065     MOVE 'A' TO WK-RPT-CODE.
  4066     PERFORM  3000-PRODUCE-REPORTS  THRU  3099-EXIT.
  4067
  4068     CLOSE TEMP-WORK.
  4069
  4070     IF WS-PRINT-RPT-B = 'Y'
  4071         SORT SORT-WORK ON ASCENDING SR-CONTROL-B
  4072                                     USING  TEMP-WORK
  4073                                     GIVING TEMP-WORK
  4074         IF SORT-RETURN NOT = ZEROS
  4075             MOVE '0101'         TO  WS-RETURN-CODE
  4076             MOVE 'SORT ERROR'   TO  WS-ABEND-MESSAGE
  4077             GO TO ABEND-PGM
  4078          ELSE
  4079             OPEN INPUT TEMP-WORK
  4080             MOVE 'B'            TO WK-RPT-CODE
  4081             MOVE 'Y'            TO FIRST-TIME-SW
  4082             MOVE 'N'            TO EXTR-END-SW
  4083             PERFORM 3000-PRODUCE-REPORTS THRU 3099-EXIT
  4084             CLOSE TEMP-WORK.
  4085
  4086     IF WS-PRINT-RPT-C = 'Y'
  4087         SORT SORT-WORK ON ASCENDING SR-CONTROL-C1
  4088                                     SR-CONTROL-C2
  4089                                     USING  TEMP-WORK
  4090                                     GIVING TEMP-WORK
  4091         IF SORT-RETURN NOT = ZEROS
  4092             MOVE '0101'         TO  WS-RETURN-CODE
  4093             MOVE 'SORT ERROR'   TO  WS-ABEND-MESSAGE
  4094             GO TO ABEND-PGM
  4095           ELSE
  4096             OPEN INPUT TEMP-WORK
  4097             MOVE 'C'            TO WK-RPT-CODE
  4098             MOVE 'Y'            TO FIRST-TIME-SW
  4099             MOVE 'N'            TO EXTR-END-SW
  4100             PERFORM 3000-PRODUCE-REPORTS THRU 3099-EXIT
  4101             CLOSE TEMP-WORK.
  4102
  4103     MOVE 'D'                 TO WK-RPT-CODE.
  4104     MOVE 'Y'                 TO FIRST-TIME-SW.
  4105     MOVE 'N'                 TO EXTR-END-SW.
  4106
  4107     IF DTE-TOT-OPT = 1 OR 4
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  80
* ECS026.cbl
  4108         SORT SORT-WORK-2 ON ASCENDING SR2-CONTROL
  4109                                       USING  REIN-WORK
  4110                                       GIVING REIN-WORK
  4111         IF SORT-RETURN NOT = ZEROS
  4112             MOVE  '0102'            TO  WS-RETURN-CODE
  4113             MOVE  'SORT ERROR'      TO  WS-ABEND-MESSAGE
  4114             GO TO ABEND-PGM
  4115          ELSE
  4116             OPEN INPUT REIN-WORK
  4117             PERFORM 5000-PRODUCE-D-REPORT THRU 5099-EXIT
  4118                                        UNTIL END-OF-EXTR
  4119             CLOSE REIN-WORK
  4120             IF WS-ERRTBL-OPEN
  4121                 CLOSE ERRTBL-IN
  4122                 IF ERRTBL-FILE-STATUS  = '00'
  4123                     NEXT SENTENCE
  4124                 ELSE
  4125                     MOVE 'ERROR OCCURED CLOSE - ERRTBL'
  4126                                      TO  WS-ABEND-MESSAGE
  4127                     MOVE ERRTBL-FILE-STATUS
  4128                                      TO  WS-ABEND-FILE-STATUS
  4129                     GO TO ABEND-PGM.
  4130
  4131 0299-EXIT.
  4132     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  81
* ECS026.cbl
  4134 0300-CREATE-EXTRACTS.
  4135     OPEN INPUT ACCT-IN  CERT-IN
  4136         OUTPUT TEMP-WORK.
  4137
  4138     IF ERACCT-FILE-STATUS  = '00' OR '97'
  4139         NEXT SENTENCE
  4140      ELSE
  4141         MOVE 'ERROR OCCURED OPEN - ERACCTT' TO WS-ABEND-MESSAGE
  4142         MOVE ERACCT-FILE-STATUS         TO WS-ABEND-FILE-STATUS
  4143         GO TO ABEND-PGM.
  4144
  4145     IF DTE-TOT-OPT = 1 OR 4
  4146         OPEN INPUT ERRTBL-IN
  4147              OUTPUT REIN-WORK
  4148         IF ERRTBL-FILE-STATUS  = '35'
  4149             NEXT SENTENCE
  4150         ELSE
  4151             IF ERRTBL-FILE-STATUS  = '00' OR '97'
  4152                 PERFORM REIN-CO-TABLE-BUILD THRU REIN-BUILD-EXIT
  4153                 MOVE 'Y'             TO  WS-ERRTBL-OPEN-SW
  4154             ELSE
  4155                 MOVE 'ERROR OCCURED OPEN - ERRTBL'
  4156                                      TO  WS-ABEND-MESSAGE
  4157                 MOVE ERRTBL-FILE-STATUS
  4158                                      TO  WS-ABEND-FILE-STATUS
  4159                 GO TO ABEND-PGM.
  4160
  4161     PERFORM 0400-PROCESS-CERTS THRU 0499-EXIT
  4162                                UNTIL END-OF-CERT.
  4163
  4164     CLOSE ACCT-IN  CERT-IN.
  4165
  4166     IF ERACCT-FILE-STATUS  = '00'
  4167         NEXT SENTENCE
  4168      ELSE
  4169         MOVE 'ERROR OCCURED CLOSE - ERACCTT'
  4170                                 TO WS-ABEND-MESSAGE
  4171         MOVE ERACCT-FILE-STATUS
  4172                                 TO  WS-ABEND-FILE-STATUS
  4173         GO TO ABEND-PGM.
  4174
  4175     IF DTE-TOT-OPT = 1 OR 4
  4176         CLOSE          REIN-WORK.
  4177
  4178 0399-EXIT.
  4179     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  82
* ECS026.cbl
  4181 0400-PROCESS-CERTS.
  4182     IF CERT-NEEDED
  4183         PERFORM 9000-READ-CERT-IN  THRU  9099-EXIT.
  4184
  4185     IF ACCOUNT-NEEDED
  4186         PERFORM 9200-READ-ACCT-IN  THRU  9299-EXIT.
  4187
  4188     PERFORM  0500-MATCH-CERT-ACCT  THRU  0599-EXIT.
  4189
  4190     IF NO-MATCH
  4191         MOVE  '0302'            TO  WS-RETURN-CODE
  4192         MOVE  'NO ACCOUNT MATCH' TO  WS-ABEND-MESSAGE
  4193         GO TO ABEND-PGM.
  4194
  4195     IF ACCT-BREAK
  4196         PERFORM 1000-CREATE-EXTRACTS         THRU 1099-EXIT
  4197         PERFORM 6500-CLEAR-ACCUMULATOR-TABLE THRU 6599-EXIT
  4198         MOVE  'N'               TO  ACCT-HAS-BIZ-SW
  4199                                     CERT-NEEDED-SW
  4200         MOVE  'Y'               TO  ACCOUNT-NEEDED-SW
  4201         GO TO 0499-EXIT.
  4202
  4203     PERFORM  0700-ACCUMULATE-FROM-CERT  THRU  0799-EXIT.
  4204
  4205     IF (DTE-TOT-OPT = 1 OR 4) AND
  4206        (CR-REIN-TABLE NOT = SPACES AND ZEROS AND LOW-VALUES)
  4207           PERFORM 2000-REINSURE-ROUTINE THRU 2099-EXIT.
  4208
  4209     MOVE  'Y'                   TO  ACCT-HAS-BIZ-SW
  4210                                     CERT-NEEDED-SW.
  4211     MOVE  'N'                   TO  ACCOUNT-NEEDED-SW.
  4212
  4213 0499-EXIT.
  4214     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  83
* ECS026.cbl
  4216 0500-MATCH-CERT-ACCT.
  4217     IF AM-CONTROL-A LESS CR-ACCT-CONTROL
  4218         MOVE  'Y'               TO  ACCOUNT-BREAK-SW
  4219                                     CERT-ACCT-MATCH-SW
  4220         GO TO 0599-EXIT.
  4221
  4222     IF AM-CONTROL-A GREATER CR-ACCT-CONTROL
  4223         MOVE  'N'               TO  CERT-ACCT-MATCH-SW
  4224         GO TO 0599-EXIT.
  4225
  4226     IF CR-DT LESS AM-EFFECT-DT
  4227         MOVE  'N'               TO  CERT-ACCT-MATCH-SW
  4228         GO TO 0599-EXIT.
  4229
  4230     IF CR-DT NOT LESS AM-EXPIRE-DT
  4231         MOVE  'Y'               TO  ACCOUNT-BREAK-SW
  4232                                     CERT-ACCT-MATCH-SW
  4233         GO TO 0599-EXIT.
  4234
  4235     MOVE  'N'                   TO  ACCOUNT-BREAK-SW.
  4236     MOVE  'Y'                   TO  CERT-ACCT-MATCH-SW.
  4237
  4238 0599-EXIT.
  4239     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  84
* ECS026.cbl
  4241 0700-ACCUMULATE-FROM-CERT.
  4242     IF CR-AGE  GREATER  +60
  4243         MOVE  +7                TO  A-SUB2.
  4244
  4245     IF CR-AGE  LESS  +61
  4246         MOVE  +6                TO  A-SUB2.
  4247
  4248     IF CR-AGE  LESS  +56
  4249         MOVE  +5                TO  A-SUB2.
  4250
  4251     IF CR-AGE  LESS  +51
  4252         MOVE  +4                TO  A-SUB2.
  4253
  4254     IF CR-AGE  LESS  +46
  4255         MOVE  +3                TO  A-SUB2.
  4256
  4257     IF CR-AGE  LESS  +41
  4258         MOVE  +2                TO  A-SUB2.
  4259
  4260     IF CR-AGE  LESS  +31
  4261         MOVE  +1                TO  A-SUB2.
  4262
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  85
* ECS026.cbl
  4264 0710-ACCUMULATE-LIFE.
  4265
  4266     IF CR-LFTYP = ZERO
  4267         GO TO 0750-ACCUMULATE-AH.
  4268
  4269     IF DTE-PRC-OPT = 5
  4270         IF CR-LF-POLICY-IS-ACTIVE
  4271              NEXT SENTENCE
  4272            ELSE
  4273              GO TO 0750-ACCUMULATE-AH.
  4274
  4275     MOVE CR-LFTYP               TO CLAS-LOOK.
  4276     PERFORM  0900-FIND-LIFE-TYPE  THRU  0950-EXIT.
  4277
  4278     MOVE CR-LF-TERM             TO ORIG-TERM.
  4279     MOVE RUN-DATE               TO VALUATION-DT.
  4280     PERFORM 8800-REMAINING-TERM-ROUTINE THRU 8899-EXIT.
  4281     MOVE REM-TRM1               TO LF-REM-TRM.
  4282
  4283     IF DTE-PRC-OPT = 5
  4284       IF (CLAS-I-EP (CLAS-INDEXL) = 'B' OR 'K' OR 'L')
  4285         IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'L'
  4286             IF REM-TRM1 NOT GREATER +0
  4287                 MOVE 'E'           TO CR-LF-CURRENT-STATUS
  4288                 GO TO 0750-ACCUMULATE-AH
  4289             ELSE
  4290                 NEXT SENTENCE
  4291         ELSE
  4292             IF (REM-TRM1 + 1) NOT GREATER +0
  4293                 MOVE 'E'           TO CR-LF-CURRENT-STATUS
  4294                 GO TO 0750-ACCUMULATE-AH
  4295             ELSE
  4296                 NEXT SENTENCE
  4297     ELSE
  4298         IF REM-TRM1 NOT GREATER +0  OR
  4299            CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'B'
  4300             MOVE 'E'               TO CR-LF-CURRENT-STATUS
  4301             GO TO 0750-ACCUMULATE-AH.
  4302
  4303     IF CLAS-I-JOINT (CLAS-INDEXL) = 'J'
  4304         MOVE  +2                TO  A-SUB1
  4305     ELSE
  4306         MOVE  +1                TO  A-SUB1.
  4307
  4308     MOVE AT-AMOUNTS (A-SUB1  A-SUB2)
  4309                                 TO  WORK-AREA-FOR-ACCUMULATOR.
  4310
  4311     IF CR-ENTRY-STATUS = '9'
  4312         GO TO 0715-ADD-LIFE-EARN.
  4313
  4314     IF CR-ENTRY-STATUS NOT = '5'
  4315         ADD CR-LFAMT            TO  WA-FACE-BEN
  4316         ADD CR-LFAMT-ALT        TO  WA-FACE-BEN
  4317         ADD CR-LFPRM            TO  WA-ISS-PRM
  4318         ADD CR-LFPRM-ALT        TO  WA-ISS-PRM.
  4319
  4320     ADD CR-LFRFND               TO  WA-CNC-PRM.
  4321     ADD CR-DTHAMT               TO  WA-CLAIM-AMT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  86
* ECS026.cbl
  4322     ADD CR-DTHEXP               TO  WA-CLAIM-AMT.
  4323     ADD +1                      TO  WA-CERT-COUNT.
  4324     ADD CR-NUM-DTH-CLM          TO  WA-CLAIM-COUNT.
  4325
  4326     MOVE  ZERO                  TO  WA-NUMBER-DAYS.
  4327
  4328     IF CR-DTHAMT NOT = ZERO
  4329         ADD  +1                 TO  WA-CRT-W-CLM.
  4330
  4331 0715-ADD-LIFE-EARN.
  4332
  4333     MOVE ZEROS TO EARNED-PREMIUM LF-EPR-R78
  4334                                  LF-EPR-PRO
  4335                                  LF-EPR-ST
  4336                             SAVE-LF-EPR-R78
  4337                             SAVE-LF-EPR-PRO.
  4338
  4339     PERFORM 8200-EP-BUMP-RTN  THRU  8299-EXIT.
  4340     PERFORM 8400-EP-DO-LF     THRU  8499-EXIT.
  4341
  4342     MOVE LF-EPR-R78      TO SAVE-LF-EPR-R78.
  4343     IF CLAS-I-EP (CLAS-INDEXL) = 'B'
  4344         MOVE LF-EPR-ST   TO SAVE-LF-EPR-R78.
  4345
  4346     MOVE LF-EPR-PRO      TO SAVE-LF-EPR-PRO.
  4347
  4348     IF CLAS-I-EP (CLAS-INDEXL) = 'U'
  4349         MOVE 'R' TO CLAS-I-EP (CLAS-INDEXL).
  4350
  4351     IF DTE-CLIENT = 'FIA'
  4352       IF CR-CARRIER = 'A' OR 'B'
  4353         COMPUTE EARNED-PREMIUM = (LF-EPR-PRO + LF-EPR-R78) / +2
  4354         GO TO 0715-CONT.
  4355
  4356     IF CLAS-I-EP (CLAS-INDEXL) = '1'
  4357         COMPUTE EARNED-PREMIUM = (LF-EPR-PRO * +.6667)
  4358                                + (LF-EPR-R78 * +.3333)
  4359         GO TO 0715-CONT.
  4360
  4361     IF CLAS-I-EP (CLAS-INDEXL) = 'M'
  4362         COMPUTE EARNED-PREMIUM = (LF-EPR-PRO + LF-EPR-R78) / +2
  4363         GO TO 0715-CONT.
  4364
  4365     IF CLAS-I-EP (CLAS-INDEXL) = 'P' OR
  4366        AM-STATE   = 'WY'             OR
  4367        DTE-CLIENT = 'SLC'
  4368          MOVE LF-EPR-PRO TO EARNED-PREMIUM
  4369          GO TO 0715-CONT.
  4370
  4371     IF CLAS-I-EP (CLAS-INDEXL) = 'B'
  4372          MOVE LF-EPR-ST  TO EARNED-PREMIUM
  4373          GO TO 0715-CONT.
  4374
  4375     IF CLAS-I-EP (CLAS-INDEXL) = 'R' OR 'T' OR 'N' OR 'A'
  4376         MOVE LF-EPR-R78 TO EARNED-PREMIUM.
  4377
  4378 0715-CONT.
  4379
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  87
* ECS026.cbl
  4380     IF CR-ENTRY-STATUS NOT = '9'
  4381         ADD EARNED-PREMIUM     TO  WA-EARNED-PRM.
  4382
  4383     MOVE WORK-AREA-FOR-ACCUMULATOR
  4384                                TO AT-AMOUNTS (A-SUB1  A-SUB2).
  4385
  4386     MOVE ZEROS TO EARNED-PREMIUM.
  4387
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  88
* ECS026.cbl
  4389 0750-ACCUMULATE-AH.
  4390
  4391     IF CR-AHTYP = ZERO
  4392         GO TO 0799-EXIT.
  4393
  4394     IF DTE-PRC-OPT = 5
  4395         IF CR-AH-POLICY-IS-ACTIVE
  4396              NEXT SENTENCE
  4397            ELSE
  4398              GO TO 0799-EXIT.
  4399
  4400     MOVE CR-AHTYP             TO CLAS-LOOK.
  4401     PERFORM  0960-FIND-AH-TYPE  THRU  0990-EXIT.
  4402
  4403     MOVE CR-AH-TERM           TO ORIG-TERM.
  4404     MOVE RUN-DATE             TO VALUATION-DT.
  4405     PERFORM 8800-REMAINING-TERM-ROUTINE THRU 8899-EXIT.
  4406     MOVE REM-TRM1             TO AH-REM-TRM.
  4407
  4408     IF DTE-PRC-OPT = 5
  4409       IF REM-TRM1 NOT GREATER +0
  4410           MOVE 'E'              TO CR-AH-CURRENT-STATUS
  4411           GO TO 0799-EXIT.
  4412
  4413     MOVE +3                     TO  A-SUB1.
  4414     MOVE AT-AMOUNTS (A-SUB1  A-SUB2)
  4415                                 TO  WORK-AREA-FOR-ACCUMULATOR.
  4416
  4417     IF CR-ENTRY-STATUS = '9'
  4418         GO TO 0755-ADD-AH-EARN.
  4419
  4420     IF CR-ENTRY-STATUS NOT = '5'
  4421         COMPUTE AH-TOTAL-AMT = CR-AHAMT * CR-AH-TERM
  4422         ADD AH-TOTAL-AMT        TO  WA-FACE-BEN
  4423         ADD CR-AHPRM            TO  WA-ISS-PRM.
  4424
  4425     ADD CR-AHRFND               TO  WA-CNC-PRM.
  4426     ADD CR-DISAMT               TO  WA-CLAIM-AMT.
  4427     ADD CR-DISEXP               TO  WA-CLAIM-AMT.
  4428     ADD +1                      TO  WA-CERT-COUNT.
  4429     ADD CR-NUM-DIS-CLM          TO  WA-CLAIM-COUNT.
  4430
  4431     IF CR-DISAMT NOT  = ZEROS AND
  4432        CR-AHAMT  NOT  = ZEROS
  4433         COMPUTE PER-DAY-BENEFIT ROUNDED = CR-AHAMT / 30
  4434         COMPUTE NO-DAYS-THIS-CERT ROUNDED = CR-DISAMT
  4435                                             /  PER-DAY-BENEFIT
  4436         ADD +1                 TO  WA-CRT-W-CLM
  4437         ADD NO-DAYS-THIS-CERT  TO  WA-NUMBER-DAYS.
  4438
  4439 0755-ADD-AH-EARN.
  4440
  4441     MOVE ZEROS TO EARNED-PREMIUM AH-EPR-R78
  4442                                  AH-EPR-PRO
  4443                                  AH-EPR-ST
  4444                             SAVE-AH-EPR-R78
  4445                             SAVE-AH-EPR-PRO.
  4446
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  89
* ECS026.cbl
  4447     PERFORM 8200-EP-BUMP-RTN THRU 8299-EXIT.
  4448     PERFORM 8600-EP-DO-AH    THRU 8699-EXIT.
  4449
  4450     MOVE AH-EPR-R78  TO SAVE-AH-EPR-R78.
  4451     MOVE AH-EPR-PRO  TO SAVE-AH-EPR-PRO.
  4452
  4453     IF (DTE-CLIENT = 'FIA' AND CR-CARRIER = 'A' OR 'B')  OR
  4454        (DTE-CLIENT = 'MLI')
  4455             COMPUTE EARNED-PREMIUM =
  4456                 (AH-EPR-PRO + AH-EPR-R78) / +2
  4457             GO TO 0755-CONT.
  4458
  4459     IF DTE-CLIENT = 'GIC'
  4460         IF CLAS-I-BAL (CLAS-INDEXA) NOT = 'B'
  4461             COMPUTE EARNED-PREMIUM =
  4462                  (AH-EPR-PRO * +.80) + (AH-EPR-R78 * +.20)
  4463             GO TO 0755-CONT.
  4464
  4465     IF CLAS-I-EP (CLAS-INDEXA) = '1' OR
  4466       (DTE-CLIENT = 'ITY' AND CR-CARRIER = '5' OR '7')
  4467          COMPUTE EARNED-PREMIUM =
  4468               (AH-EPR-PRO * +.6667) + (AH-EPR-R78 * +.3333)
  4469          GO TO 0755-CONT.
  4470
  4471     IF CLAS-I-EP (CLAS-INDEXA) = 'M'
  4472         COMPUTE EARNED-PREMIUM =
  4473             (AH-EPR-PRO + AH-EPR-R78) / +2
  4474         GO TO 0755-CONT.
  4475
  4476     IF CLAS-I-EP (CLAS-INDEXA) = 'P'  OR
  4477        AM-STATE   = 'WY'     OR
  4478        DTE-CLIENT = 'SLC'    OR
  4479       (DTE-CLIENT = 'ITY' AND CR-CARRIER = '2')
  4480          MOVE AH-EPR-PRO TO EARNED-PREMIUM
  4481          GO TO 0755-CONT.
  4482
  4483     IF CLAS-I-EP (CLAS-INDEXA) = 'R'  OR  'A'
  4484          IF (DTE-CLIENT = 'POS' AND CR-CARRIER = '2')  OR
  4485             (DTE-CLIENT = 'FIM')
  4486              COMPUTE EARNED-PREMIUM =
  4487                  (AH-EPR-PRO + AH-EPR-R78) / +2
  4488            ELSE
  4489              MOVE AH-EPR-R78 TO EARNED-PREMIUM.
  4490
  4491 0755-CONT.
  4492
  4493     IF CR-ENTRY-STATUS NOT = '9'
  4494         ADD EARNED-PREMIUM     TO  WA-EARNED-PRM.
  4495
  4496     MOVE WORK-AREA-FOR-ACCUMULATOR
  4497                          TO AT-AMOUNTS (A-SUB1  A-SUB2).
  4498
  4499     MOVE ZEROS TO EARNED-PREMIUM.
  4500
  4501 0799-EXIT.
  4502     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  90
* ECS026.cbl
  4504 0800-DATE-CONVERT-ROUTINE.
  4505     CALL 'ELDATCX' USING DATE-CONVERSION-DATA.
  4506
  4507 0899-EXIT.
  4508     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  91
* ECS026.cbl
  4510 0900-FIND-LIFE-TYPE.
  4511     IF CLAS-I-BEN (CLAS-INDEXL)  = CLAS-LOOK
  4512         GO TO 0950-EXIT.
  4513
  4514     MOVE  CLAS-STARTL           TO  CLAS-INDEXL.
  4515
  4516 0910-FIND-LIFE-LOOP.
  4517     IF CLAS-INDEXL  GREATER CLAS-MAXL
  4518         GO TO 0940-FIND-LIFE-ABEND.
  4519
  4520     IF CLAS-I-BEN (CLAS-INDEXL) = CLAS-LOOK
  4521         GO TO 0950-EXIT.
  4522
  4523     ADD +1                     TO  CLAS-INDEXL.
  4524
  4525     GO TO 0910-FIND-LIFE-LOOP.
  4526
  4527 0940-FIND-LIFE-ABEND.
  4528     MOVE '0401'                 TO  WS-RETURN-CODE.
  4529     MOVE 'INVALID BENEFIT TYPE' TO  WS-ABEND-MESSAGE.
  4530
  4531     GO TO ABEND-PGM.
  4532
  4533 0950-EXIT.
  4534     EXIT.
  4535
  4536 0960-FIND-AH-TYPE.
  4537     IF CLAS-I-BEN (CLAS-INDEXA)  = CLAS-LOOK
  4538         GO TO 0990-EXIT.
  4539
  4540     MOVE  CLAS-STARTA           TO  CLAS-INDEXA.
  4541
  4542 0970-FIND-AH-LOOP.
  4543     IF CLAS-INDEXA  GREATER CLAS-MAXA
  4544         GO TO 0980-FIND-AH-ABEND.
  4545
  4546     IF CLAS-I-BEN (CLAS-INDEXA) = CLAS-LOOK
  4547         GO TO 0990-EXIT.
  4548
  4549     ADD +1                     TO  CLAS-INDEXA.
  4550
  4551     GO TO 0970-FIND-AH-LOOP.
  4552
  4553 0980-FIND-AH-ABEND.
  4554     MOVE '0401'                 TO  WS-RETURN-CODE.
  4555     MOVE 'INVALID BENEFIT TYPE' TO  WS-ABEND-MESSAGE.
  4556
  4557     GO TO ABEND-PGM.
  4558
  4559 0990-EXIT.
  4560     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  92
* ECS026.cbl
  4562 1000-CREATE-EXTRACTS.
  4563     IF NO-BIZ
  4564         GO TO 1099-EXIT.
  4565
  4566     MOVE SPACES                 TO  SORT-WORK-REC.
  4567     MOVE 'A'                    TO  SWR-REC-TYPE.
  4568     MOVE AM-CARRIER             TO  SWR-CARR.
  4569     MOVE AM-GROUPING            TO  SWR-GROUP.
  4570     MOVE AM-STATE               TO  SWR-STATE.
  4571     MOVE AM-ACCOUNT             TO  SWR-ACCOUNT.
  4572     MOVE AM-NAME                TO  SWR-ACCT-NAME.
  4573     MOVE AM-REPORT-CODE-1       TO  SWR-REPORT-CODE-1.
  4574     MOVE AM-REPORT-CODE-2       TO  SWR-REPORT-CODE-2.
  4575     MOVE ACCUMULATOR-TABLE      TO  SWR-TABLE.
  4576
  4577     IF DTE-TOT-OPT = 3 OR 4
  4578         MOVE SPACES TO SWR-ACCOUNT  SWR-ACCT-NAME.
  4579
  4580     IF AM-REPORT-CODE-1 NOT = SPACES
  4581         MOVE 'Y' TO WS-PRINT-RPT-B.
  4582
  4583     IF AM-REPORT-CODE-2 NOT = SPACES
  4584         MOVE 'Y' TO WS-PRINT-RPT-C.
  4585
  4586     WRITE TEMP-WORK-REC FROM SORT-WORK-REC.
  4587
  4588 1099-EXIT.
  4589     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  93
* ECS026.cbl
  4591 2000-REINSURE-ROUTINE.
  4592
  4593     IF DTE-PRC-OPT = 5
  4594         IF NOT CR-LF-POLICY-IS-ACTIVE
  4595             MOVE ZEROS          TO CR-LFTYP.
  4596     IF DTE-PRC-OPT = 5
  4597         IF NOT CR-AH-POLICY-IS-ACTIVE
  4598             MOVE ZEROS          TO CR-AHTYP.
  4599
  4600     IF CR-LFTYP = ZEROS  AND
  4601        CR-AHTYP = ZEROS
  4602         GO TO 2099-EXIT.
  4603
  4604     MOVE SPACES                 TO  REIN-LEVELS-END.
  4605
  4606     PERFORM CLEAR-REIN-HOLD THRU CLEAR-REIN-HOLD-X.
  4607
  4608     MOVE DTE-CLASIC-COMPANY-CD  TO  REIN-SRCH-COMP-CD.
  4609     MOVE 'A'                    TO  REIN-SRCH-CODE.
  4610     MOVE CR-REIN-TABLE          TO  REIN-SRCH SWR2-REINS-TABLE.
  4611
  4612     IF REIN-SRCH NOT = SAVE-REIN-SRCH
  4613         MOVE REIN-SRCH          TO  SAVE-REIN-SRCH
  4614         MOVE REIN-SEARCH        TO  RE-CONTROL-PRIMARY
  4615         READ ERRTBL-IN
  4616             IF ERRTBL-FILE-STATUS = '23'
  4617                 DISPLAY 'INVALID REINSURANCE TABLE CODE - '
  4618                           REIN-SRCH ' ' CR-FULL-CONTROL
  4619                 MOVE ERRTBL-FILE-STATUS TO WS-ABEND-FILE-STATUS
  4620                 GO TO ABEND-PGM
  4621             ELSE
  4622                 IF ERRTBL-FILE-STATUS NOT = '00'
  4623                     MOVE 'ERROR OCCURED READ - ERRTBL'
  4624                                         TO WS-ABEND-MESSAGE
  4625                     MOVE ERRTBL-FILE-STATUS
  4626                                         TO WS-ABEND-FILE-STATUS
  4627                     GO TO ABEND-PGM.
  4628
  4629
  4630     IF RE-REMAINING (1) NOT = 'I'
  4631         GO TO 2010-REINSURE-ROUTINE-GET-CALC.
  4632
  4633     MOVE SPACE                        TO REIN-CANCEL-LF-SW
  4634                                          REIN-CANCEL-AH-SW.
  4635     MOVE ZEROS                        TO REIN-EARN-LF-TERM
  4636                                          REIN-LCNC-EARN-TERM
  4637                                          REIN-LF-CLM-MONTHS
  4638                                          REIN-EARN-AH-TERM
  4639                                          REIN-ACNC-EARN-TERM
  4640                                          REIN-AH-PRIOR-CLMS-PAID
  4641                                          REIN-AH-CLM-MONTHS
  4642                                          REIN-AH-CLM-MTH-1
  4643                                          REIN-AH-CLM-MTH-2
  4644                                          REIN-AH-CLM-MTH-3
  4645                                          REIN-AH-CLM-MTH-4
  4646                                          REIN-AH-CLM-MTH-5.
  4647
  4648     MOVE CR-DT                        TO DC-GREG-DATE-CYMD.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  94
* ECS026.cbl
  4649     MOVE 'L'                          TO DC-OPTION-CODE.
  4650     PERFORM 0800-DATE-CONVERT-ROUTINE THRU 0899-EXIT.
  4651     MOVE DC-BIN-DATE-1                TO WS-CR-BIN-DATE.
  4652
  4653     IF CR-LFTYP = ZEROS  OR  SPACES
  4654         GO TO 2003-CONTINUE.
  4655
  4656     MOVE EOM-RUN-DATE                 TO VALUATION-DT.
  4657     MOVE BIN-EOM-DT                   TO BIN-VALUATION-DT.
  4658
  4659     IF CR-LF-CANCEL-EXIT-DATE NOT = ZEROS
  4660       IF CR-LF-CANCEL-EXIT-DATE  LESS THAN VALUATION-DT
  4661           MOVE CR-LF-CANCEL-EXIT-DATE TO VALUATION-DT.
  4662
  4663     IF CR-LF-CLAIM-EXIT-DATE NOT = ZEROS
  4664       IF CR-LF-CLAIM-EXIT-DATE  LESS THAN VALUATION-DT
  4665           MOVE CR-LF-CLAIM-EXIT-DATE  TO VALUATION-DT.
  4666
  4667     MOVE VALUATION-DT                 TO DC-GREG-DATE-CYMD.
  4668     PERFORM 2009-CALC-ELAPSED-MONTHS THRU 2009-CALC-EXIT.
  4669     IF DC-ELAPSED-MONTHS GREATER THAN CR-LF-TERM
  4670         MOVE CR-LF-TERM               TO REIN-EARN-LF-TERM
  4671     ELSE
  4672         MOVE DC-ELAPSED-MONTHS        TO REIN-EARN-LF-TERM.
  4673
  4674     IF CR-LF-CANC-DT NOT = ZEROS
  4675         MOVE CR-LF-CANC-DT            TO DC-GREG-DATE-CYMD
  4676         PERFORM 2009-CALC-ELAPSED-MONTHS THRU 2009-CALC-EXIT
  4677         MOVE DC-ELAPSED-MONTHS        TO REIN-LCNC-EARN-TERM
  4678         IF CR-DT = CR-LF-CANC-DT
  4679             MOVE '*'                  TO REIN-CANCEL-LF-SW.
  4680
  4681     IF CR-DTH-DT NOT = ZEROS
  4682         MOVE CR-DTH-DT                TO DC-GREG-DATE-CYMD
  4683         PERFORM 2009-CALC-ELAPSED-MONTHS THRU 2009-CALC-EXIT
  4684         MOVE DC-ELAPSED-MONTHS        TO REIN-LF-CLM-MONTHS.
  4685
  4686
  4687 2003-CONTINUE.
  4688
  4689     IF CR-AHTYP = ZEROS  OR  SPACES
  4690        GO TO 2010-REINSURE-ROUTINE-GET-CALC.
  4691
  4692     MOVE EOM-RUN-DATE                 TO VALUATION-DT.
  4693     MOVE BIN-EOM-DT                   TO BIN-VALUATION-DT.
  4694
  4695     IF CR-AH-CANCEL-EXIT-DATE NOT = ZEROS
  4696       IF CR-AH-CANCEL-EXIT-DATE  LESS THAN VALUATION-DT
  4697           MOVE CR-AH-CANCEL-EXIT-DATE TO VALUATION-DT.
  4698
  4699     IF CR-AH-SETTLEMENT-EXIT-DATE NOT = ZEROS
  4700       IF CR-AH-SETTLEMENT-EXIT-DATE  LESS THAN VALUATION-DT
  4701           MOVE CR-AH-SETTLEMENT-EXIT-DATE TO VALUATION-DT.
  4702
  4703     MOVE VALUATION-DT                 TO DC-GREG-DATE-CYMD.
  4704     PERFORM 2009-CALC-ELAPSED-MONTHS THRU 2009-CALC-EXIT.
  4705     IF DC-ELAPSED-MONTHS GREATER THAN CR-AH-TERM
  4706         MOVE CR-AH-TERM               TO REIN-EARN-AH-TERM
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  95
* ECS026.cbl
  4707     ELSE
  4708         MOVE DC-ELAPSED-MONTHS        TO REIN-EARN-AH-TERM.
  4709
  4710     IF CR-AH-CANC-DT NOT = ZEROS
  4711         MOVE CR-AH-CANC-DT            TO DC-GREG-DATE-CYMD
  4712         PERFORM 2009-CALC-ELAPSED-MONTHS THRU 2009-CALC-EXIT
  4713         MOVE DC-ELAPSED-MONTHS        TO REIN-ACNC-EARN-TERM
  4714         IF CR-DT = CR-AH-CANC-DT
  4715             MOVE '*'                  TO REIN-CANCEL-AH-SW.
  4716
  4717     IF CR-DIS-INCUR-DT (1) NOT = ZEROS
  4718         MOVE CR-DIS-INCUR-DT(1)       TO DC-GREG-DATE-CYMD
  4719         PERFORM 2009-CALC-ELAPSED-MONTHS THRU 2009-CALC-EXIT
  4720         MOVE DC-ELAPSED-MONTHS        TO REIN-AH-CLM-MTH-1.
  4721
  4722     IF CR-DIS-INCUR-DT (2) NOT = ZEROS
  4723         MOVE CR-DIS-INCUR-DT (2)      TO DC-GREG-DATE-CYMD
  4724         PERFORM 2009-CALC-ELAPSED-MONTHS THRU 2009-CALC-EXIT
  4725         MOVE DC-ELAPSED-MONTHS        TO REIN-AH-CLM-MTH-2.
  4726
  4727     IF CR-DIS-INCUR-DT (3) NOT = ZEROS
  4728         MOVE CR-DIS-INCUR-DT (3)      TO DC-GREG-DATE-CYMD
  4729         PERFORM 2009-CALC-ELAPSED-MONTHS THRU 2009-CALC-EXIT
  4730         MOVE DC-ELAPSED-MONTHS        TO REIN-AH-CLM-MTH-3.
  4731
  4732     IF CR-DIS-INCUR-DT (4) NOT = ZEROS
  4733         MOVE CR-DIS-INCUR-DT (4)      TO DC-GREG-DATE-CYMD
  4734         PERFORM 2009-CALC-ELAPSED-MONTHS THRU 2009-CALC-EXIT
  4735         MOVE DC-ELAPSED-MONTHS        TO REIN-AH-CLM-MTH-4.
  4736
  4737     IF CR-DIS-INCUR-DT (5) NOT = ZEROS
  4738         MOVE CR-DIS-INCUR-DT (5)      TO DC-GREG-DATE-CYMD
  4739         PERFORM 2009-CALC-ELAPSED-MONTHS THRU 2009-CALC-EXIT
  4740         MOVE DC-ELAPSED-MONTHS        TO REIN-AH-CLM-MTH-5.
  4741
  4742
  4743     GO TO 2010-REINSURE-ROUTINE-GET-CALC.
  4744
  4745
  4746 2009-CALC-ELAPSED-MONTHS.
  4747
  4748     MOVE 'L'                          TO DC-OPTION-CODE.
  4749     PERFORM 0800-DATE-CONVERT-ROUTINE THRU 0899-EXIT.
  4750     MOVE DC-BIN-DATE-1                TO DC-BIN-DATE-2.
  4751     MOVE WS-CR-BIN-DATE               TO DC-BIN-DATE-1.
  4752     MOVE '1'                          TO DC-OPTION-CODE.
  4753     MOVE ' '                          TO DC-CENTURY-ADJUSTMENT.
  4754     MOVE ZEROS                        TO DC-ELAPSED-MONTHS
  4755                                          DC-ODD-DAYS-OVER
  4756                                          DC-ELAPSED-DAYS.
  4757     PERFORM 0800-DATE-CONVERT-ROUTINE THRU 0899-EXIT.
  4758
  4759 2009-CALC-EXIT.
  4760     EXIT.
  4761
  4762
  4763 2010-REINSURE-ROUTINE-GET-CALC.
* 4764                             COPY ECSRTPFM.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  96
* ECS026.cbl (/apps/prod/cid1p/copy/ECSRTPFM)
  4765******************************************************************07/10/97
  4766*                                                                *ECSRTPFM
  4767*                            ECSRTPFM                            *   LV001
  4768*                            VMOD=2.002                          *ECSRTPFM
  4769*                                                                *ECSRTPFM
  4770******************************************************************ECSRTPFM
  4771                                                                  ECSRTPFM
  4772     IF    CR-LFAMT  NUMERIC                                      00000072
  4773           NEXT SENTENCE                                          00000073
  4774        ELSE                                                      00000074
  4775           MOVE ZEROS TO CR-LFAMT.                                00000075
  4776                                                                  00000076
  4777     IF    CR-LFAMT-ALT  NUMERIC                                  00000077
  4778           NEXT SENTENCE                                          00000078
  4779        ELSE                                                      00000079
  4780           MOVE ZEROS TO CR-LFAMT-ALT.                            00000080
  4781                                                                  00000081
  4782                                                                  00000082
  4783     IF    CR-LFPRM  NUMERIC                                      00000083
  4784           NEXT SENTENCE                                          00000084
  4785        ELSE                                                      00000085
  4786           MOVE ZEROS TO CR-LFPRM.                                00000086
  4787                                                                  00000087
  4788     IF    CR-LFPRM-ALT  NUMERIC                                  00000088
  4789           NEXT SENTENCE                                          00000089
  4790        ELSE                                                      00000090
  4791           MOVE ZEROS TO CR-LFPRM-ALT.                            00000091
  4792                                                                  00000092
  4793                                                                  00000093
  4794     IF    CR-LFPRM-CALC  NUMERIC                                 00000094
  4795           NEXT SENTENCE                                          00000095
  4796        ELSE                                                      00000096
  4797           MOVE ZEROS TO CR-LFPRM-CALC.                           00000097
  4798                                                                  00000098
  4799     IF    CR-LFPRM-CALC-ALT  NUMERIC                             00000099
  4800           NEXT SENTENCE                                          00000100
  4801        ELSE                                                      00000101
  4802           MOVE ZEROS TO CR-LFPRM-CALC-ALT.                       00000102
  4803                                                                  00000103
  4804     IF    CR-LF-NSP-PRM  NUMERIC                                 00000104
  4805           NEXT SENTENCE                                          00000105
  4806        ELSE                                                      00000106
  4807           MOVE ZEROS TO CR-LF-NSP-PRM.                           00000107
  4808                                                                  00000108
  4809     COMPUTE RS-R-LB = CR-LFAMT + CR-LFAMT-ALT.                   ECSRTPFM
  4810     COMPUTE RS-R-LP = CR-LFPRM + CR-LFPRM-ALT.                   ECSRTPFM
  4811     IF RE-NSP-ST-CD-LF = ZEROS  OR  SPACES                       ECSRTPFM
  4812         COMPUTE RS-R-LPC = CR-LFPRM-CALC + CR-LFPRM-CALC-ALT     ECSRTPFM
  4813     ELSE                                                         ECSRTPFM
  4814         MOVE CR-LF-NSP-PRM         TO RS-R-LPC.                  ECSRTPFM
  4815     MOVE RS-R-LPC                  TO REIN-CALCED-LIFE.          ECSRTPFM
  4816                                                                  ECSRTPFM
  4817     MOVE CR-AHAMT                  TO RS-R-AB.                   ECSRTPFM
  4818     MOVE CR-AHPRM                  TO RS-R-AP.                   ECSRTPFM
  4819     IF RE-NSP-ST-CD-AH = ZEROS  OR  SPACES                       ECSRTPFM
  4820         MOVE CR-AHPRM-CALC         TO RS-R-APC                   ECSRTPFM
  4821     ELSE                                                         ECSRTPFM
  4822         MOVE CR-AH-NSP-PRM         TO RS-R-APC.                  ECSRTPFM
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  97
* ECS026.cbl (/apps/prod/cid1p/copy/ECSRTPFM)
  4823     MOVE RS-R-APC                  TO REIN-CALCED-AH.            ECSRTPFM
  4824                                                                  ECSRTPFM
  4825     PERFORM REINSURE-CALC THRU REINSURE-CALC-X                   ECSRTPFM
  4826         VARYING SUB1 FROM +1 BY +1                               ECSRTPFM
  4827             UNTIL RE-REI-COMP-NO (SUB1) = SPACES.                ECSRTPFM
  4828                                                                  ECSRTPFM
  4829
  4830 2020-REINSURE-ROUTINE-SKIP-1.
  4831     MOVE +1 TO SUB1.
  4832
  4833 2030-REINSURE-ROUTINE-BLD-WORK.
  4834     IF REIN-COMP (SUB1) = SPACES
  4835         GO TO 2099-EXIT.
  4836
  4837     IF REIN-REM-SW (SUB1) = 'Z'
  4838         ADD +1 TO SUB1
  4839         GO TO 2030-REINSURE-ROUTINE-BLD-WORK.
  4840
  4841     IF REIN-LF-AH-FLGS (SUB1) = SPACES
  4842         ADD +1 TO SUB1
  4843         GO TO 2030-REINSURE-ROUTINE-BLD-WORK.
  4844
  4845     IF CR-LFRFND = ZEROS  AND
  4846        CR-AHRFND = ZEROS
  4847         NEXT SENTENCE
  4848     ELSE
  4849         PERFORM REINSURE-CALC-CANCEL THRU REINSURE-CALC-CANCEL-X.
  4850
  4851     MOVE CR-DTHAMT TO RW-LFCLMWK.
  4852     ADD  CR-DTHEXP TO RW-LFCLMWK.
  4853     MOVE CR-DISAMT TO RW-AHCLMWK.
  4854     ADD  CR-DISEXP TO RW-AHCLMWK.
  4855
  4856     IF RW-LFCLMWK = ZEROS  AND
  4857        RW-AHCLMWK = ZEROS
  4858         NEXT SENTENCE
  4859     ELSE
  4860         PERFORM REINSURE-CALC-CLAIM  THRU REINSURE-CALC-CLAIM-X.
  4861
  4862     MOVE REIN-COMP (SUB1)       TO  SWR2-REIN-COMP.
  4863     MOVE REIN-WORK-FLDS (SUB1)  TO  RWF-FIELDS.
  4864     MOVE CR-CARRIER             TO  SWR2-CARR.
  4865     MOVE CR-DT                  TO  SWR2-DT.
  4866     MOVE CR-AGE                 TO  SWR2-AGE.
  4867     MOVE CR-ENTRY-STATUS        TO  SWR2-ENTRY-STATUS.
  4868     MOVE CR-LF-CURRENT-STATUS   TO  SWR2-LF-CURRENT-STATUS.
  4869     MOVE CR-AH-CURRENT-STATUS   TO  SWR2-AH-CURRENT-STATUS.
  4870
  4871     IF CR-ENTRY-STATUS = '5'
  4872         MOVE ZEROS              TO RWF-LFAMT    RWF-AHAMT
  4873                                    RWF-LFPRM    RWF-AHPRM.
  4874
  4875     MOVE ZEROS    TO SWR2-LFTYP SWR2-LF-TERM SWR2-LF-REM-TRM
  4876                      SWR2-LFAMT SWR2-LFPRM   SWR2-LFRFND
  4877                      SWR2-NUM-DTH-CLM        SWR2-DTHAMT
  4878                      SWR2-LF-EPR-78          SWR2-LF-EPR-PR
  4879                      SWR2-AHTYP SWR2-AH-TERM SWR2-AH-REM-TRM
  4880                      SWR2-AHAMT SWR2-AHPRM   SWR2-AHRFND
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  98
* ECS026.cbl
  4881                      SWR2-NUM-DIS-CLM        SWR2-DISAMT
  4882                      SWR2-AH-EPR-78          SWR2-AH-EPR-PR.
  4883
  4884     IF REIN-LF-FLG (SUB1) = 'X'  AND
  4885        CR-LFTYP NOT = ZERO
  4886         MOVE CR-LFTYP           TO  SWR2-LFTYP
  4887         MOVE CR-LF-TERM         TO  SWR2-LF-TERM
  4888         MOVE LF-REM-TRM         TO  SWR2-LF-REM-TRM
  4889         MOVE RWF-LFAMT          TO  SWR2-LFAMT
  4890         MOVE RWF-LFPRM          TO  SWR2-LFPRM
  4891         MOVE RWF-LFRFND         TO  SWR2-LFRFND
  4892         MOVE CR-NUM-DTH-CLM     TO  SWR2-NUM-DTH-CLM
  4893         MOVE RWF-LFCLM          TO  SWR2-DTHAMT
  4894         IF REIN-REM-SW (SUB1) = 'I'
  4895             COMPUTE SWR2-LF-EPR-78 = RWF-LFPRM - RWF-LFRFND
  4896             MOVE SWR2-LF-EPR-78 TO  SWR2-LF-EPR-PR
  4897         ELSE
  4898             IF CR-LFPRM NOT = ZEROS
  4899                 COMPUTE SWR2-LF-EPR-78 =
  4900                        (RWF-LFPRM * SAVE-LF-EPR-R78) / CR-LFPRM
  4901                 COMPUTE SWR2-LF-EPR-PR =
  4902                        (RWF-LFPRM * SAVE-LF-EPR-PRO) / CR-LFPRM.
  4903
  4904     IF REIN-AH-FLG (SUB1) = 'X'  AND
  4905        CR-AHTYP NOT = ZERO
  4906         MOVE CR-AHTYP           TO  SWR2-AHTYP
  4907         MOVE CR-AH-TERM         TO  SWR2-AH-TERM
  4908         MOVE AH-REM-TRM         TO  SWR2-AH-REM-TRM
  4909         MOVE RWF-AHAMT          TO  SWR2-AHAMT
  4910         MOVE RWF-AHPRM          TO  SWR2-AHPRM
  4911         MOVE RWF-AHRFND         TO  SWR2-AHRFND
  4912         MOVE CR-NUM-DIS-CLM     TO  SWR2-NUM-DIS-CLM
  4913         MOVE RWF-AHCLM          TO  SWR2-DISAMT
  4914         IF REIN-REM-SW (SUB1) = 'I'
  4915             COMPUTE SWR2-AH-EPR-78 = RWF-AHPRM - RWF-AHRFND
  4916             MOVE SWR2-AH-EPR-78 TO  SWR2-AH-EPR-PR
  4917         ELSE
  4918             IF CR-AHPRM NOT = ZEROS
  4919                 COMPUTE SWR2-AH-EPR-78 =
  4920                        (RWF-AHPRM * SAVE-AH-EPR-R78) / CR-AHPRM
  4921                 COMPUTE SWR2-AH-EPR-PR =
  4922                        (RWF-AHPRM * SAVE-AH-EPR-PRO) / CR-AHPRM.
  4923
  4924
  4925     if swr2-lfamt not numeric
  4926        move zeros to swr2-lfamt
  4927     end-if
  4928     if swr2-lfprm not numeric
  4929        move zeros to swr2-lfprm
  4930     end-if
  4931     if swr2-lfrfnd not numeric
  4932        move zeros to swr2-lfrfnd
  4933     end-if
  4934     if swr2-dthamt not numeric
  4935        move zeros to swr2-dthamt
  4936     end-if
  4937
  4938     if swr2-ahamt not numeric
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  99
* ECS026.cbl
  4939        move zeros to swr2-ahamt
  4940     end-if
  4941     if swr2-ahprm not numeric
  4942        move zeros to swr2-ahprm
  4943     end-if
  4944     if swr2-ahrfnd not numeric
  4945        move zeros to swr2-ahrfnd
  4946     end-if
  4947     if swr2-disamt not numeric
  4948        move zeros to swr2-disamt
  4949     end-if
  4950
  4951     WRITE REIN-WORK-REC  FROM  SORT-WORK-REC-2.
  4952
  4953     ADD +1 TO SUB1.
  4954
  4955     GO TO 2030-REINSURE-ROUTINE-BLD-WORK.
  4956
  4957 2099-EXIT.
  4958     EXIT.
  4959
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 100
* ECS026.cbl
  4961 2900-REINSURANCE-ROUTINES.
* 4962                             COPY ECSRIRTN.
  4963******************************************************************04/30/98
  4964*                                                                *ECSRIRTN
  4965*                            ECSRIRTN                            *   LV012
  4966*                            VMOD=2.025.                         *ECSRIRTN
  4967*                                                                *ECSRIRTN
  4968******************************************************************ECSRIRTN
  4969******************************************************************
  4970*                   C H A N G E   L O G
  4971*
  4972* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4973*-----------------------------------------------------------------
  4974*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4975* EFFECTIVE    NUMBER
  4976*-----------------------------------------------------------------
  4977* 062703                   PEMA  ADD DCC CLIENT ID TO
  4978*                                SPECIAL CEDED CLAIM CALC
  4979* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  4980* 052114  CR2014051900001  PEMA  ADD ROUNDING TO PREM TAX CALC
  4981                                                                  ECSRIRTN
  4982 REINSURE-CALC.                                                   ECSRIRTN
  4983                                                                  ECSRIRTN
  4984     MOVE RE-REI-COMP-NO (SUB1) TO REIN-COMP (SUB1).              ECSRIRTN
  4985     MOVE REIN-WORK-FLDS (SUB1) TO RWF-FIELDS.                    ECSRIRTN
  4986     MOVE RE-COMP-INFO (SUB1)   TO WT-COMP-INFO.                  ECSRIRTN
  4987     MOVE WT-REMAINING          TO RWF-REM-SW                     ECSRIRTN
  4988                                   REIN-REM-SW (SUB1).            ECSRIRTN
  4989                                                                  ECSRIRTN
  4990     MOVE ZEROS                 TO RWF-EP-STOP-DATE               ECSRIRTN
  4991                                   WS-RWF-EP-STOP-DATE-N             CL*12
  4992                                   REIN-EP-STOP-DATE (SUB1).      ECSRIRTN
  4993                                                                  ECSRIRTN
  4994     MOVE 'Y'                   TO RWF-LF-RUNOFF-SW               ECSRIRTN
  4995                                   REIN-LF-RUNOFF-SW (SUB1)       ECSRIRTN
  4996                                   RWF-AH-RUNOFF-SW               ECSRIRTN
  4997                                   REIN-AH-RUNOFF-SW (SUB1).      ECSRIRTN
  4998                                                                  ECSRIRTN
  4999     PERFORM REIN-FIND-CO-LOOP THRU FIND-REI-CO-EXIT              ECSRIRTN
  5000        VARYING CO-SUB FROM 1 BY 1 UNTIL                          ECSRIRTN
  5001          (RCT-REIN-CO (CO-SUB) = REIN-COMP (SUB1))  OR           ECSRIRTN
  5002          (CO-SUB GREATER REIN-CO-TABLE-ENT-CNT)     OR           ECSRIRTN
  5003          (RCT-REIN-CO (CO-SUB) = SPACES).                        ECSRIRTN
  5004                                                                  ECSRIRTN
  5005     IF (CO-SUB GREATER REIN-CO-TABLE-ENT-CNT)  OR                ECSRIRTN
  5006        (RCT-REIN-CO (CO-SUB) = SPACES)                           ECSRIRTN
  5007         GO TO CALC-CONTINUED.                                    ECSRIRTN
  5008                                                                  ECSRIRTN
  5009     MOVE RCT-EARNING-STOP-DT (CO-SUB) TO RWF-EP-STOP-DATE        ECSRIRTN
  5010                                          WS-RWF-EP-STOP-DATE-N      CL*12
  5011                                          REIN-EP-STOP-DATE (SUB1)ECSRIRTN
  5012                                                                  ECSRIRTN
  5013     IF RWF-EP-STOP-DATE = ZEROS                                  ECSRIRTN
  5014         GO TO CALC-CONTINUED.                                    ECSRIRTN
  5015                                                                  ECSRIRTN
  5016     IF RCT-EARN-STOP-CODE (CO-SUB) = 'L'  OR  'B'                ECSRIRTN
  5017         MOVE 'N'               TO RWF-LF-RUNOFF-SW               ECSRIRTN
  5018                                   REIN-LF-RUNOFF-SW (SUB1).      ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 101
* ECS026.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
  5019                                                                  ECSRIRTN
  5020     IF RCT-EARN-STOP-CODE (CO-SUB) = 'A'  OR  'B'                ECSRIRTN
  5021         MOVE 'N'               TO RWF-AH-RUNOFF-SW               ECSRIRTN
  5022                                   REIN-AH-RUNOFF-SW (SUB1).      ECSRIRTN
  5023                                                                  ECSRIRTN
  5024 CALC-CONTINUED.                                                  ECSRIRTN
  5025                                                                  ECSRIRTN
  5026     COMPUTE RS-LIFE-BEN  = CR-LFAMT + CR-LFAMT-ALT.              ECSRIRTN
  5027     COMPUTE RS-LIFE-PREM = CR-LFPRM + CR-LFPRM-ALT.              ECSRIRTN
  5028                                                                  ECSRIRTN
  5029     IF RE-NSP-ST-CD-LF = ZEROS  OR  SPACES                       ECSRIRTN
  5030         COMPUTE RS-LP-CALC = CR-LFPRM-CALC + CR-LFPRM-CALC-ALT   ECSRIRTN
  5031     ELSE                                                         ECSRIRTN
  5032         MOVE CR-LF-NSP-PRM         TO RS-LP-CALC.                ECSRIRTN
  5033     MOVE RS-LP-CALC                TO REIN-CALCED-LIFE.          ECSRIRTN
  5034                                                                  ECSRIRTN
  5035     MOVE CR-AHAMT                  TO RS-AH-BEN.                 ECSRIRTN
  5036     MOVE CR-AHPRM                  TO RS-AH-PREM.                ECSRIRTN
  5037     IF RE-NSP-ST-CD-AH = ZEROS  OR  SPACES                       ECSRIRTN
  5038         MOVE CR-AHPRM-CALC         TO RS-AP-CALC                 ECSRIRTN
  5039     ELSE                                                         ECSRIRTN
  5040         MOVE CR-AH-NSP-PRM         TO RS-AP-CALC.                ECSRIRTN
  5041     MOVE RS-AP-CALC                TO REIN-CALCED-AH.            ECSRIRTN
  5042                                                                  ECSRIRTN
  5043     IF WT-REMAINING = 'Y' OR 'Z' OR 'L' OR 'R'                   ECSRIRTN
  5044         MOVE RS-R-LB               TO RS-LIFE-BEN                ECSRIRTN
  5045         MOVE RS-R-LP               TO RS-LIFE-PREM               ECSRIRTN
  5046         MOVE RS-R-LPC              TO RS-LP-CALC                 ECSRIRTN
  5047         MOVE RS-R-AB               TO RS-AH-BEN                  ECSRIRTN
  5048         MOVE RS-R-AP               TO RS-AH-PREM                 ECSRIRTN
  5049         MOVE RS-R-APC              TO RS-AP-CALC.                ECSRIRTN
  5050                                                                  ECSRIRTN
  5051     IF SUB1 = RE-100-COMP                                        ECSRIRTN
  5052         GO TO REINSURE-CALC-REMAINDER.                           ECSRIRTN
  5053                                                                  ECSRIRTN
  5054     IF CR-DT LESS WT-LO-DATE                                        CL**2
  5055         GO TO REINSURE-CALC-X.                                   ECSRIRTN
  5056                                                                  ECSRIRTN
  5057     IF CR-DT NOT LESS WT-HI-DATE                                    CL**2
  5058         GO TO REINSURE-CALC-X.                                   ECSRIRTN
  5059                                                                  ECSRIRTN
  5060     PERFORM REINSURE-CK-LIFE      THRU REINSURE-CK-LIFE-X.       ECSRIRTN
  5061     PERFORM REINSURE-CK-AH        THRU REINSURE-CK-AH-X.         ECSRIRTN
  5062                                                                  ECSRIRTN
  5063     IF WT-INTERACTIVE = 'E'                                      ECSRIRTN
  5064         PERFORM REIN-CHECK-INTERACT-E THRU REIN-INTERACT-CHECK-X.ECSRIRTN
  5065                                                                  ECSRIRTN
  5066     IF WT-INTERACTIVE = 'X'                                      ECSRIRTN
  5067       IF  (REIN-LF-FLG (SUB1) = 'X' AND REIN-AH-FLG (SUB1) = 'X')ECSRIRTN
  5068        OR (REIN-LF-FLG (SUB1) = 'X' AND REIN-AH-FLG (SUB1) = ' ')ECSRIRTN
  5069        OR (REIN-LF-FLG (SUB1) = ' ' AND REIN-AH-FLG (SUB1) = 'X')ECSRIRTN
  5070           NEXT SENTENCE                                          ECSRIRTN
  5071       ELSE                                                       ECSRIRTN
  5072           MOVE 'Y' TO REIN-LF-FLG (SUB1)                         ECSRIRTN
  5073                       REIN-AH-FLG (SUB1).                        ECSRIRTN
  5074                                                                  ECSRIRTN
  5075     IF WT-INTERACTIVE = 'Y'                                      ECSRIRTN
  5076         IF REIN-LF-FLG (SUB1) = 'X' AND                          ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 102
* ECS026.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
  5077            REIN-AH-FLG (SUB1) = 'Y'                              ECSRIRTN
  5078             MOVE 'X' TO REIN-AH-FLG (SUB1).                      ECSRIRTN
  5079                                                                  ECSRIRTN
  5080     IF WT-INTERACTIVE = 'Y'                                      ECSRIRTN
  5081         IF REIN-AH-FLG (SUB1) = 'X' AND                          ECSRIRTN
  5082            REIN-LF-FLG (SUB1) = 'Y'                              ECSRIRTN
  5083             MOVE 'X' TO REIN-LF-FLG (SUB1).                      ECSRIRTN
  5084                                                                  ECSRIRTN
  5085     IF WT-INTERACTIVE = 'Z'                                      ECSRIRTN
  5086         IF REIN-LF-FLG (SUB1) = 'X'                              ECSRIRTN
  5087             IF REIN-AH-FLG (SUB1) = 'Y'                          ECSRIRTN
  5088                 MOVE 'X' TO REIN-AH-FLG (SUB1)                   ECSRIRTN
  5089             ELSE                                                 ECSRIRTN
  5090                 NEXT SENTENCE                                    ECSRIRTN
  5091         ELSE                                                     ECSRIRTN
  5092             MOVE 'Y' TO REIN-LF-FLG (SUB1)                       ECSRIRTN
  5093                         REIN-AH-FLG (SUB1).                      ECSRIRTN
  5094                                                                  ECSRIRTN
  5095     IF WT-INTERACTIVE = 'W'                                      ECSRIRTN
  5096         IF REIN-AH-FLG (SUB1) = 'X'                              ECSRIRTN
  5097             IF REIN-LF-FLG (SUB1) = 'Y'                          ECSRIRTN
  5098                 MOVE 'X' TO REIN-LF-FLG (SUB1)                   ECSRIRTN
  5099             ELSE                                                 ECSRIRTN
  5100                 NEXT SENTENCE                                    ECSRIRTN
  5101         ELSE                                                     ECSRIRTN
  5102             MOVE 'Y' TO REIN-LF-FLG (SUB1)                       ECSRIRTN
  5103                         REIN-AH-FLG (SUB1).                      ECSRIRTN
  5104                                                                  ECSRIRTN
  5105     IF REIN-LF-FLG (SUB1) = 'X'                                  ECSRIRTN
  5106         PERFORM REIN-CALC-LIFE THRU REIN-CALC-LIFE-X.            ECSRIRTN
  5107                                                                  ECSRIRTN
  5108     IF REIN-LF-FLG (SUB1) = 'E'                                  ECSRIRTN
  5109         PERFORM REIN-LF-SKIP-LIMIT THRU REIN-CALC-LIFE-X         ECSRIRTN
  5110         MOVE 'X' TO REIN-LF-FLG (SUB1).                          ECSRIRTN
  5111                                                                  ECSRIRTN
  5112     IF REIN-AH-FLG (SUB1) = 'X'                                  ECSRIRTN
  5113         PERFORM REIN-CALC-AH THRU REIN-CALC-AH-X.                ECSRIRTN
  5114                                                                  ECSRIRTN
  5115     IF REIN-AH-FLG (SUB1) = 'E'                                  ECSRIRTN
  5116         PERFORM REIN-AH-SKIP-LIMIT THRU REIN-CALC-AH-X           ECSRIRTN
  5117         MOVE 'X'                TO  REIN-AH-FLG (SUB1).          ECSRIRTN
  5118                                                                  ECSRIRTN
  5119     IF REIN-LF-FLG (SUB1) NOT = 'X'                              ECSRIRTN
  5120         MOVE SPACE TO REIN-LF-FLG (SUB1).                        ECSRIRTN
  5121                                                                  ECSRIRTN
  5122     IF REIN-AH-FLG (SUB1) NOT = 'X'                              ECSRIRTN
  5123         MOVE SPACE TO REIN-AH-FLG (SUB1).                        ECSRIRTN
  5124                                                                  ECSRIRTN
  5125     GO TO REINSURE-CALC-X.                                       ECSRIRTN
  5126                                                                  ECSRIRTN
  5127 REINSURE-CK-LIFE.                                                ECSRIRTN
  5128                                                                  ECSRIRTN
  5129     IF CR-LFTYP = ZERO                                           ECSRIRTN
  5130         GO TO REINSURE-CK-LIFE-X.                                ECSRIRTN
  5131                                                                  ECSRIRTN
  5132     IF WT-LF-PCT = ZERO                                          ECSRIRTN
  5133         GO TO REINSURE-CK-LIFE-X.                                ECSRIRTN
  5134                                                                  ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 103
* ECS026.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
  5135     IF DTE-CLIENT = 'CSO' OR 'CSI'                               ECSRIRTN
  5136         IF CLAS-I-REIN-YN (CLAS-INDEXL) = 'N'                    ECSRIRTN
  5137             GO TO REINSURE-CK-LIFE-X.                            ECSRIRTN
  5138                                                                  ECSRIRTN
  5139     MOVE WT-LF-BEN-CODE                TO REIN-BEN-CODE.         ECSRIRTN
  5140                                                                  ECSRIRTN
  5141     IF CEDING-PROPERTY-ONLY                                      ECSRIRTN
  5142         IF CLAS-I-CALC-TYPE (CLAS-INDEXL) NOT = '2'              ECSRIRTN
  5143             GO TO REINSURE-CK-LIFE-X                             ECSRIRTN
  5144         ELSE                                                     ECSRIRTN
  5145             NEXT SENTENCE                                        ECSRIRTN
  5146     ELSE                                                         ECSRIRTN
  5147         IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = '2'                  ECSRIRTN
  5148             GO TO REINSURE-CK-LIFE-X.                            ECSRIRTN
  5149                                                                  ECSRIRTN
  5150     IF CEDING-AD-D-ONLY                                          ECSRIRTN
  5151         IF CLAS-I-CALC-TYPE (CLAS-INDEXL) NOT = '4'              ECSRIRTN
  5152             GO TO REINSURE-CK-LIFE-X                             ECSRIRTN
  5153         ELSE                                                     ECSRIRTN
  5154             NEXT SENTENCE                                        ECSRIRTN
  5155     ELSE                                                         ECSRIRTN
  5156         IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = '4'                  ECSRIRTN
  5157             GO TO REINSURE-CK-LIFE-X.                            ECSRIRTN
  5158                                                                  ECSRIRTN
  5159     IF CEDING-SINGLE-PREM-ONLY                                   ECSRIRTN
  5160         IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'B'                  ECSRIRTN
  5161             GO TO REINSURE-CK-LIFE-X.                            ECSRIRTN
  5162                                                                  ECSRIRTN
  5163     IF CEDING-OUT-BALANCE-ONLY                                   ECSRIRTN
  5164         IF CLAS-I-CALC-TYPE (CLAS-INDEXL) NOT = 'B'              ECSRIRTN
  5165            GO TO REINSURE-CK-LIFE-X.                             ECSRIRTN
  5166                                                                  ECSRIRTN
  5167     IF CEDING-REDUCING-ONLY                                      ECSRIRTN
  5168         IF CLAS-I-RL-AH (CLAS-INDEXL) = 'L' OR 'P'               ECSRIRTN
  5169             GO TO REINSURE-CK-LIFE-X.                            ECSRIRTN
  5170                                                                  ECSRIRTN
  5171     IF CEDING-LEVEL-ONLY                                         ECSRIRTN
  5172         IF CLAS-I-RL-AH (CLAS-INDEXL) = 'R'                      ECSRIRTN
  5173            GO TO REINSURE-CK-LIFE-X.                             ECSRIRTN
  5174                                                                  ECSRIRTN
  5175     IF CEDING-GROUP-ONLY                                         ECSRIRTN
  5176         IF CR-IND-GRP NOT = '2'                                  ECSRIRTN
  5177             GO TO REINSURE-CK-LIFE-X.                            ECSRIRTN
  5178                                                                  ECSRIRTN
  5179     IF CEDING-GROUP-RED-LIFE-ONLY                                ECSRIRTN
  5180         IF (CR-IND-GRP = '1')  OR                                ECSRIRTN
  5181            (CLAS-I-RL-AH (CLAS-INDEXL) = 'L' OR 'P') OR          ECSRIRTN
  5182            (CR-AHTYP NOT = ZERO)                                 ECSRIRTN
  5183             GO TO REINSURE-CK-LIFE-X.                            ECSRIRTN
  5184                                                                  ECSRIRTN
  5185     IF CEDING-GROUP-REDUCING-ONLY                                ECSRIRTN
  5186         IF (CR-IND-GRP = '1')  OR                                ECSRIRTN
  5187            (CLAS-I-RL-AH (CLAS-INDEXL) = 'L' OR 'P')             ECSRIRTN
  5188             GO TO REINSURE-CK-LIFE-X.                            ECSRIRTN
  5189                                                                  ECSRIRTN
  5190     IF CEDING-INDIVIDUAL-ONLY                                    ECSRIRTN
  5191         IF CR-IND-GRP NOT = '1'                                  ECSRIRTN
  5192             GO TO REINSURE-CK-LIFE-X.                            ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 104
* ECS026.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
  5193                                                                  ECSRIRTN
  5194     IF CEDING-JOINT-ONLY                                         ECSRIRTN
  5195         IF CLAS-I-JOINT (CLAS-INDEXL) NOT = 'J'                  ECSRIRTN
  5196             GO TO REINSURE-CK-LIFE-X.                            ECSRIRTN
  5197                                                                  ECSRIRTN
  5198     IF CEDING-SGL-PREM-REDUCING                                  ECSRIRTN
  5199        IF (CLAS-I-RL-AH (CLAS-INDEXL) = 'L' OR 'P')  OR          ECSRIRTN
  5200           CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'B'                   ECSRIRTN
  5201            GO TO REINSURE-CK-LIFE-X.                             ECSRIRTN
  5202                                                                  ECSRIRTN
  5203     IF CEDING-SGL-PREM-GROUP                                     ECSRIRTN
  5204         IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'B'  OR              ECSRIRTN
  5205            CR-IND-GRP = '1'                                      ECSRIRTN
  5206             GO TO REINSURE-CK-LIFE-X.                            ECSRIRTN
  5207                                                                  ECSRIRTN
  5208     IF CEDING-GROUP-LEVEL-ONLY                                   ECSRIRTN
  5209         IF CLAS-I-RL-AH (CLAS-INDEXL) = 'R'  OR                  ECSRIRTN
  5210            CR-IND-GRP = '1'                                      ECSRIRTN
  5211             GO TO REINSURE-CK-LIFE-X.                            ECSRIRTN
  5212                                                                  ECSRIRTN
  5213     IF CEDING-SGL-PREM-GRP-REDUCING                              ECSRIRTN
  5214         IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'B'  OR              ECSRIRTN
  5215            (CLAS-I-RL-AH (CLAS-INDEXL) = 'L' OR 'P')  OR         ECSRIRTN
  5216            CR-IND-GRP = '1'                                      ECSRIRTN
  5217             GO TO REINSURE-CK-LIFE-X.                            ECSRIRTN
  5218                                                                  ECSRIRTN
  5219     IF CEDING-SGL-PREM-GROUP-LEVEL                               ECSRIRTN
  5220         IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'B'  OR              ECSRIRTN
  5221            CLAS-I-RL-AH (CLAS-INDEXL) = 'R'  OR                  ECSRIRTN
  5222            CR-IND-GRP = '1'                                      ECSRIRTN
  5223             GO TO REINSURE-CK-LIFE-X.                            ECSRIRTN
  5224                                                                  ECSRIRTN
  5225     IF CEDING-SINGLE-POLICIES-ONLY                               ECSRIRTN
  5226         IF CLAS-I-JOINT (CLAS-INDEXL) = 'J'                      ECSRIRTN
  5227            GO TO REINSURE-CK-LIFE-X.                             ECSRIRTN
  5228                                                                  ECSRIRTN
  5229     IF DTE-CLIENT EQUAL 'NCL'                                    ECSRIRTN
  5230        MOVE 'Y'                 TO REIN-LF-FLG (SUB1).           ECSRIRTN
  5231                                                                  ECSRIRTN
  5232     IF CR-AGE LESS WT-LFAGE-LO                                   ECSRIRTN
  5233         GO TO REINSURE-CK-LIFE-X.                                ECSRIRTN
  5234                                                                  ECSRIRTN
  5235     IF CR-AGE GREATER WT-LFAGE-HI                                ECSRIRTN
  5236         GO TO REINSURE-CK-LIFE-X.                                ECSRIRTN
  5237                                                                  ECSRIRTN
  5238     IF CR-LF-TERM  NUMERIC                                       00002331
  5239        NEXT SENTENCE                                             00002332
  5240     ELSE                                                         00002333
  5241        MOVE ZEROS               TO CR-LF-TERM                    00002334
  5242     END-IF
  5243                                                                  00002335
  5244     IF CR-LF-TERM LESS WT-LFTRM-LO                               ECSRIRTN
  5245         GO TO REINSURE-CK-LIFE-X.                                ECSRIRTN
  5246                                                                  ECSRIRTN
  5247     IF CR-LF-TERM GREATER WT-LFTRM-HI                            ECSRIRTN
  5248         GO TO REINSURE-CK-LIFE-X.                                ECSRIRTN
  5249                                                                  ECSRIRTN
  5250     MOVE 'Y' TO REIN-LF-FLG (SUB1).                              ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 105
* ECS026.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
  5251                                                                  ECSRIRTN
  5252     IF RS-LIFE-BEN NOT GREATER WT-LF-LIM-LO                      ECSRIRTN
  5253         GO TO REINSURE-CK-LIFE-X.                                ECSRIRTN
  5254                                                                  ECSRIRTN
  5255     IF RS-LIFE-BEN GREATER WT-LF-LIM-HI                          ECSRIRTN
  5256         GO TO REINSURE-CK-LIFE-X.                                ECSRIRTN
  5257                                                                  ECSRIRTN
  5258     MOVE 'X' TO REIN-LF-FLG (SUB1).                              ECSRIRTN
  5259                                                                  ECSRIRTN
  5260 REINSURE-CK-LIFE-X.                                              ECSRIRTN
  5261     EXIT.                                                        ECSRIRTN
  5262                                                                  ECSRIRTN
  5263 REINSURE-CK-AH.                                                  ECSRIRTN
  5264                                                                  ECSRIRTN
  5265     IF CR-AHTYP = ZERO                                           ECSRIRTN
  5266         GO TO REINSURE-CK-AH-X.                                  ECSRIRTN
  5267                                                                  ECSRIRTN
  5268     IF WT-AH-PCT = ZERO                                          ECSRIRTN
  5269         GO TO REINSURE-CK-AH-X.                                  ECSRIRTN
  5270                                                                  ECSRIRTN
  5271     IF DTE-CLIENT = 'CSO' OR 'CSI'                               ECSRIRTN
  5272         IF CLAS-I-REIN-YN (CLAS-INDEXA) = 'N'                    ECSRIRTN
  5273             GO TO REINSURE-CK-AH-X.                              ECSRIRTN
  5274                                                                  ECSRIRTN
  5275     MOVE WT-AH-BEN-CODE                TO REIN-BEN-CODE.         ECSRIRTN
  5276                                                                  ECSRIRTN
  5277     IF CEDING-UNEMPLOYMENT-ONLY                                  ECSRIRTN
  5278         IF CLAS-I-CALC-TYPE (CLAS-INDEXA) NOT = '3'              ECSRIRTN
  5279             GO TO REINSURE-CK-AH-X                               ECSRIRTN
  5280         ELSE                                                     ECSRIRTN
  5281             NEXT SENTENCE                                        ECSRIRTN
  5282     ELSE                                                         ECSRIRTN
  5283         IF CLAS-I-CALC-TYPE (CLAS-INDEXA) = '3'                  ECSRIRTN
  5284             GO TO REINSURE-CK-AH-X.                              ECSRIRTN
  5285                                                                  ECSRIRTN
  5286     IF CEDING-SINGLE-PREM-ONLY                                   ECSRIRTN
  5287         IF CLAS-I-CALC-TYPE (CLAS-INDEXA) = 'B'                  ECSRIRTN
  5288             GO TO REINSURE-CK-AH-X.                              ECSRIRTN
  5289                                                                  ECSRIRTN
  5290     IF CEDING-JOINT-ONLY                                         ECSRIRTN
  5291         IF CLAS-I-JOINT (CLAS-INDEXA) NOT = 'J'                  ECSRIRTN
  5292             GO TO REINSURE-CK-AH-X.                              ECSRIRTN
  5293                                                                  ECSRIRTN
  5294     IF CEDING-OUT-BALANCE-ONLY                                   ECSRIRTN
  5295         IF CLAS-I-CALC-TYPE (CLAS-INDEXA) NOT = 'B'              ECSRIRTN
  5296             GO TO REINSURE-CK-AH-X.                              ECSRIRTN
  5297                                                                  ECSRIRTN
  5298     IF CEDING-GROUP-ONLY                                         ECSRIRTN
  5299         IF CR-IND-GRP NOT = '2'                                  ECSRIRTN
  5300             GO TO REINSURE-CK-AH-X.                              ECSRIRTN
  5301                                                                  ECSRIRTN
  5302     IF CEDING-SGL-PREM-GROUP                                     ECSRIRTN
  5303         IF CLAS-I-CALC-TYPE (CLAS-INDEXA) = 'B'  OR              ECSRIRTN
  5304            CR-IND-GRP = '1'                                      ECSRIRTN
  5305             GO TO REINSURE-CK-AH-X.                              ECSRIRTN
  5306                                                                  ECSRIRTN
  5307     IF CEDING-INDIVIDUAL-ONLY                                    ECSRIRTN
  5308         IF CR-IND-GRP NOT = '1'                                  ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 106
* ECS026.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
  5309             GO TO REINSURE-CK-AH-X.                              ECSRIRTN
  5310                                                                  ECSRIRTN
  5311     IF CEDING-SINGLE-POLICIES-ONLY                               ECSRIRTN
  5312         IF CLAS-I-JOINT (CLAS-INDEXA) = 'J'                      ECSRIRTN
  5313            GO TO REINSURE-CK-AH-X.                               ECSRIRTN
  5314                                                                  ECSRIRTN
  5315     IF CEDING-7-DAY-RETRO                                        ECSRIRTN
  5316         IF CLAS-I-AB3 (CLAS-INDEXA) NOT = (' 7R'  AND  '07R')    ECSRIRTN
  5317            GO TO REINSURE-CK-AH-X.                               ECSRIRTN
  5318                                                                  ECSRIRTN
  5319     IF CEDING-14-DAY-RETRO                                       ECSRIRTN
  5320         IF CLAS-I-AB3 (CLAS-INDEXA) NOT = '14R'                  ECSRIRTN
  5321             GO TO REINSURE-CK-AH-X.                              ECSRIRTN
  5322                                                                  ECSRIRTN
  5323     IF DTE-CLIENT EQUAL 'NCL'                                    ECSRIRTN
  5324        MOVE 'Y'                 TO REIN-AH-FLG (SUB1).           ECSRIRTN
  5325                                                                  ECSRIRTN
  5326     IF CR-AGE LESS WT-AHAGE-LO                                   ECSRIRTN
  5327         GO TO REINSURE-CK-AH-X.                                  ECSRIRTN
  5328                                                                  ECSRIRTN
  5329     IF CR-AGE GREATER WT-AHAGE-HI                                ECSRIRTN
  5330         GO TO REINSURE-CK-AH-X.                                  ECSRIRTN
  5331                                                                  ECSRIRTN
  5332     IF CR-AH-TERM  NUMERIC                                       00002331
  5333        NEXT SENTENCE                                             00002332
  5334     ELSE                                                         00002333
  5335        MOVE ZEROS               TO CR-AH-TERM                    00002334
  5336     END-IF
  5337                                                                  00002335
  5338     IF CR-AH-TERM LESS WT-AHTRM-LO                               ECSRIRTN
  5339         GO TO REINSURE-CK-AH-X.                                  ECSRIRTN
  5340                                                                  ECSRIRTN
  5341     IF CR-AH-TERM GREATER WT-AHTRM-HI                            ECSRIRTN
  5342         GO TO REINSURE-CK-AH-X.                                  ECSRIRTN
  5343                                                                  ECSRIRTN
  5344     MOVE 'Y' TO REIN-AH-FLG (SUB1).                              ECSRIRTN
  5345                                                                  ECSRIRTN
  5346     IF WT-AHBEN-LIM-LO = ZERO                                    ECSRIRTN
  5347         AND WT-AHBEN-LIM-HI = ZERO                               ECSRIRTN
  5348             MOVE +9999999.99 TO WT-AHBEN-LIM-LO                  ECSRIRTN
  5349                                 WT-AHBEN-LIM-HI.                 ECSRIRTN
  5350                                                                  ECSRIRTN
  5351     IF WT-AHMOA-LIM-LO = ZERO                                    ECSRIRTN
  5352         AND WT-AHMOA-LIM-HI = ZERO                               ECSRIRTN
  5353             MOVE +9999999.99 TO WT-AHMOA-LIM-LO                  ECSRIRTN
  5354                                 WT-AHMOA-LIM-HI.                 ECSRIRTN
  5355                                                                  ECSRIRTN
  5356     COMPUTE RW-AHLIM-LO = CR-AH-TERM * WT-AHMOA-LIM-LO.          ECSRIRTN
  5357     COMPUTE RW-AHLIM-HI = CR-AH-TERM * WT-AHMOA-LIM-HI.          ECSRIRTN
  5358                                                                  ECSRIRTN
  5359     IF RW-AHLIM-LO GREATER WT-AHBEN-LIM-LO                       ECSRIRTN
  5360         MOVE WT-AHBEN-LIM-LO TO RW-AHLIM-LO.                     ECSRIRTN
  5361                                                                  ECSRIRTN
  5362     IF RW-AHLIM-HI GREATER WT-AHBEN-LIM-HI                       ECSRIRTN
  5363         MOVE WT-AHBEN-LIM-HI TO RW-AHLIM-HI.                     ECSRIRTN
  5364                                                                  ECSRIRTN
  5365     MOVE RW-AHLIM-LO TO RWF-AH-LIMIT.                            ECSRIRTN
  5366                                                                  ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 107
* ECS026.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
  5367     COMPUTE RW-AHWRK = RS-AH-BEN * CR-AH-TERM.                   ECSRIRTN
  5368                                                                  ECSRIRTN
  5369     IF RW-AHWRK NOT GREATER RW-AHLIM-LO                          ECSRIRTN
  5370         GO TO REINSURE-CK-AH-X.                                  ECSRIRTN
  5371                                                                  ECSRIRTN
  5372     IF RW-AHWRK GREATER RW-AHLIM-HI                              ECSRIRTN
  5373         GO TO REINSURE-CK-AH-X.                                  ECSRIRTN
  5374                                                                  ECSRIRTN
  5375     MOVE 'X' TO REIN-AH-FLG (SUB1).                              ECSRIRTN
  5376                                                                  ECSRIRTN
  5377 REINSURE-CK-AH-X.                                                ECSRIRTN
  5378     EXIT.                                                        ECSRIRTN
  5379                                                                  ECSRIRTN
  5380 REIN-CHECK-INTERACT-E.                                           ECSRIRTN
  5381                                                                  ECSRIRTN
  5382     IF RS-LIFE-BEN = ZERO  OR                                    ECSRIRTN
  5383        RS-AH-BEN = ZERO                                          ECSRIRTN
  5384         GO TO REIN-INTERACT-CHECK-X.                             ECSRIRTN
  5385                                                                  ECSRIRTN
  5386     IF REIN-LF-FLG (SUB1) NOT = 'X'  AND                         ECSRIRTN
  5387        REIN-AH-FLG (SUB1) NOT = 'X'                              ECSRIRTN
  5388         GO TO REIN-INTERACT-CHECK-X.                             ECSRIRTN
  5389                                                                  ECSRIRTN
  5390     MOVE 'X'                    TO REIN-LF-FLG (SUB1)            ECSRIRTN
  5391                                    REIN-AH-FLG (SUB1).           ECSRIRTN
  5392                                                                  ECSRIRTN
  5393     IF WT-AHBEN-LO = ZERO                                        ECSRIRTN
  5394         AND WT-AHBEN-HI = ZERO                                   ECSRIRTN
  5395             MOVE +9999999.99    TO  WT-AHBEN-LO                  ECSRIRTN
  5396                                     WT-AHBEN-HI.                 ECSRIRTN
  5397     IF WT-AHMOA-LO = ZERO                                        ECSRIRTN
  5398         AND WT-AHMOA-HI = ZERO                                   ECSRIRTN
  5399             MOVE +9999999.99    TO  WT-AHMOA-LO                  ECSRIRTN
  5400                                     WT-AHMOA-HI.                 ECSRIRTN
  5401                                                                  ECSRIRTN
  5402     COMPUTE RW-AHLIM-LO = CR-AH-TERM * WT-AHMOA-LO.              ECSRIRTN
  5403     COMPUTE RW-AHLIM-HI = CR-AH-TERM * WT-AHMOA-HI.              ECSRIRTN
  5404                                                                  ECSRIRTN
  5405     IF RW-AHLIM-LO GREATER WT-AHBEN-LO                           ECSRIRTN
  5406         MOVE WT-AHBEN-LO        TO  RW-AHLIM-LO.                 ECSRIRTN
  5407                                                                  ECSRIRTN
  5408     IF RW-AHLIM-HI GREATER WT-AHBEN-HI                           ECSRIRTN
  5409         MOVE WT-AHBEN-HI        TO  RW-AHLIM-HI.                 ECSRIRTN
  5410                                                                  ECSRIRTN
  5411     COMPUTE RW-AHWRK = RS-AH-BEN * CR-AH-TERM.                   ECSRIRTN
  5412                                                                  ECSRIRTN
  5413     IF RW-AHWRK GREATER RW-AHLIM-HI                              ECSRIRTN
  5414         MOVE RW-AHLIM-HI        TO  RW-AHWRK.                    ECSRIRTN
  5415                                                                  ECSRIRTN
  5416     IF RW-AHWRK GREATER RW-AHLIM-LO                              ECSRIRTN
  5417         COMPUTE RATE-WORK-A ROUNDED = (RW-AHWRK - RW-AHLIM-LO)   ECSRIRTN
  5418                                       / RW-AHWRK                 ECSRIRTN
  5419       ELSE                                                       ECSRIRTN
  5420         MOVE ZERO               TO RATE-WORK-A.                  ECSRIRTN
  5421                                                                  ECSRIRTN
  5422     IF RS-LIFE-BEN GREATER WT-LF-LO                              ECSRIRTN
  5423         COMPUTE RATE-WORK-L ROUNDED = (RS-LIFE-BEN - WT-LF-LO)   ECSRIRTN
  5424                                       / RS-LIFE-BEN              ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 108
* ECS026.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
  5425       ELSE                                                       ECSRIRTN
  5426         MOVE ZERO               TO RATE-WORK-L.                  ECSRIRTN
  5427                                                                  ECSRIRTN
  5428     IF (RS-LIFE-BEN GREATER WT-LF-LO) AND                        ECSRIRTN
  5429        (RW-AHWRK NOT GREATER RW-AHLIM-LO)                        ECSRIRTN
  5430          MOVE 'E'               TO REIN-AH-FLG (SUB1)            ECSRIRTN
  5431          COMPUTE RWF-AHAMT ROUNDED = (RW-AHWRK * RATE-WORK-L)    ECSRIRTN
  5432                                      / CR-AH-TERM.               ECSRIRTN
  5433                                                                  ECSRIRTN
  5434     IF (RW-AHWRK GREATER RW-AHLIM-LO) AND                        ECSRIRTN
  5435        (RS-LIFE-BEN NOT GREATER WT-LF-LO)                        ECSRIRTN
  5436          MOVE 'E'               TO REIN-LF-FLG (SUB1)            ECSRIRTN
  5437          IF (RW-AHWRK - RW-AHLIM-LO) NOT GREATER RS-LIFE-BEN     ECSRIRTN
  5438               COMPUTE RWF-LFAMT = RW-AHWRK - RW-AHLIM-LO         ECSRIRTN
  5439            ELSE                                                  ECSRIRTN
  5440                MOVE RS-LIFE-BEN TO RWF-LFAMT.                    ECSRIRTN
  5441                                                                  ECSRIRTN
  5442     IF (RW-AHWRK GREATER RW-AHLIM-LO) AND                        ECSRIRTN
  5443        (RS-LIFE-BEN GREATER WT-LF-LO)                            ECSRIRTN
  5444        IF RATE-WORK-L GREATER RATE-WORK-A                        ECSRIRTN
  5445          MOVE 'E'               TO REIN-AH-FLG (SUB1)            ECSRIRTN
  5446          COMPUTE RWF-AHAMT ROUNDED = (RW-AHWRK * RATE-WORK-L)    ECSRIRTN
  5447                                      / CR-AH-TERM                ECSRIRTN
  5448         ELSE                                                     ECSRIRTN
  5449          MOVE 'E'               TO REIN-LF-FLG (SUB1)            ECSRIRTN
  5450          IF (RW-AHWRK - RW-AHLIM-LO) NOT GREATER RS-LIFE-BEN     ECSRIRTN
  5451               COMPUTE RWF-LFAMT = RW-AHWRK - RW-AHLIM-LO         ECSRIRTN
  5452            ELSE                                                  ECSRIRTN
  5453                MOVE RS-LIFE-BEN TO RWF-LFAMT.                    ECSRIRTN
  5454                                                                  ECSRIRTN
  5455 REIN-INTERACT-CHECK-X.                                           ECSRIRTN
  5456     EXIT.                                                        ECSRIRTN
  5457                                                                  ECSRIRTN
  5458                                                                  ECSRIRTN
  5459 REIN-CALC-LIFE.                                                  ECSRIRTN
  5460                                                                  ECSRIRTN
  5461     IF RS-LIFE-BEN NOT GREATER WT-LF-HI                          ECSRIRTN
  5462         MOVE RS-LIFE-BEN TO RWF-LFAMT                            ECSRIRTN
  5463     ELSE                                                         ECSRIRTN
  5464         MOVE WT-LF-HI TO RWF-LFAMT.                              ECSRIRTN
  5465                                                                  ECSRIRTN
  5466     IF RS-LIFE-BEN LESS WT-LF-LO                                 ECSRIRTN
  5467         MOVE +0 TO RWF-LFAMT                                     ECSRIRTN
  5468     ELSE                                                         ECSRIRTN
  5469         IF WT-REMAINING NOT = 'L'                                ECSRIRTN
  5470           IF RS-LIFE-BEN LESS THAN ZERO                          ECSRIRTN
  5471               COMPUTE RWF-LFAMT ROUNDED = WT-LF-PCT * RS-LIFE-BENECSRIRTN
  5472           ELSE                                                   ECSRIRTN
  5473               COMPUTE RWF-LFAMT ROUNDED = WT-LF-PCT *            ECSRIRTN
  5474                                          (RWF-LFAMT - WT-LF-LO). ECSRIRTN
  5475                                                                  ECSRIRTN
  5476 REIN-LF-SKIP-LIMIT.                                              ECSRIRTN
  5477                                                                  ECSRIRTN
  5478     MOVE +0 TO RW-LFPRM  RW-LFPRMC.                              ECSRIRTN
  5479                                                                  ECSRIRTN
  5480     IF WT-REMAINING = 'I'                                        ECSRIRTN
  5481         GO TO REIN-CALC-LF-RISK-PREM.                            ECSRIRTN
  5482                                                                  ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 109
* ECS026.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
  5483     IF WT-REMAINING = 'L'                                        ECSRIRTN
  5484         COMPUTE RWF-LFPRM ROUNDED = RS-LIFE-PREM * WT-LF-PCT     ECSRIRTN
  5485         GO TO REIN-CALC-LIFE-X.                                  ECSRIRTN
  5486                                                                  ECSRIRTN
  5487     IF RS-LIFE-BEN NOT = ZERO                                    ECSRIRTN
  5488         COMPUTE RW-LFPRM ROUNDED = (RS-LIFE-PREM *               ECSRIRTN
  5489                   RWF-LFAMT) / RS-LIFE-BEN                       ECSRIRTN
  5490         COMPUTE RW-LFPRMC ROUNDED = (RS-LP-CALC *                ECSRIRTN
  5491                   RWF-LFAMT) / RS-LIFE-BEN                       ECSRIRTN
  5492     ELSE                                                         ECSRIRTN
  5493         IF WT-LF-LIM-LO = ZERO                                   ECSRIRTN
  5494             COMPUTE RW-LFPRM ROUNDED = RS-LIFE-PREM * WT-LF-PCT  ECSRIRTN
  5495             COMPUTE RW-LFPRMC ROUNDED = RS-LP-CALC * WT-LF-PCT.  ECSRIRTN
  5496                                                                  ECSRIRTN
  5497     IF ((WT-LF-QC = '1' OR '3') OR                                  CL**8
  5498         (WT-LF-QC = '2' AND                                         CL**8
  5499          PGM-SUB = +50  AND                                         CL**8
  5500          DTE-CLIENT = 'LAP'))                                       CL**8
  5501          MOVE RW-LFPRM TO RWF-LFPRM                                 CL**8
  5502     ELSE                                                         ECSRIRTN
  5503         MOVE RW-LFPRMC TO RWF-LFPRM.                             ECSRIRTN
  5504                                                                  ECSRIRTN
  5505     IF WT-REMAINING = 'Y' OR 'Z' OR 'X' OR 'N'                   ECSRIRTN
  5506         COMPUTE RS-R-LB = RS-R-LB - RWF-LFAMT                    ECSRIRTN
  5507         COMPUTE RS-R-LP = RS-R-LP - RW-LFPRM                     ECSRIRTN
  5508         COMPUTE RS-R-LPC = RS-R-LPC - RW-LFPRMC.                 ECSRIRTN
  5509                                                                  ECSRIRTN
  5510     GO TO REIN-CALC-LIFE-X.                                      ECSRIRTN
  5511                                                                  ECSRIRTN
  5512 REIN-CALC-LF-RISK-PREM.                                          ECSRIRTN
  5513                                                                  ECSRIRTN
  5514     IF RWF-LFAMT NOT GREATER THAN +0                             ECSRIRTN
  5515         MOVE ZEROS                 TO RWF-LFPRM                  ECSRIRTN
  5516         GO TO REIN-CALC-LIFE-X.                                  ECSRIRTN
  5517                                                                  ECSRIRTN
  5518     MOVE RWF-LFAMT                 TO REIN-RISK-AMOUNT.          ECSRIRTN
  5519     COMPUTE REIN-MONTH-REDUCE = RS-LIFE-BEN / CR-LF-TERM.        ECSRIRTN
  5520     MOVE +0                        TO REIN-WORKA                 ECSRIRTN
  5521                                       RW-LFPRM.                  ECSRIRTN
  5522                                                                  ECSRIRTN
  5523 REIN-LF-RISK-PREM-LOOP.                                          ECSRIRTN
  5524                                                                  ECSRIRTN
  5525     COMPUTE RW-LFPRM = RW-LFPRM +                                ECSRIRTN
  5526                ((REIN-RISK-AMOUNT / +1000) * CR-LF-NSP-PRM-RATE).ECSRIRTN
  5527                                                                  ECSRIRTN
  5528     IF CLAS-I-RL-AH (CLAS-INDEXL) NOT = 'L'                      ECSRIRTN
  5529        SUBTRACT REIN-MONTH-REDUCE FROM REIN-RISK-AMOUNT.         ECSRIRTN
  5530                                                                  ECSRIRTN
  5531     IF REIN-WORKA = REIN-EARN-LF-TERM  OR                        ECSRIRTN
  5532        REIN-RISK-AMOUNT LESS THAN +0                             ECSRIRTN
  5533         MOVE RW-LFPRM              TO RWF-LFPRM                  ECSRIRTN
  5534     ELSE                                                         ECSRIRTN
  5535         ADD +1 TO REIN-WORKA                                     ECSRIRTN
  5536         GO TO REIN-LF-RISK-PREM-LOOP.                            ECSRIRTN
  5537                                                                  ECSRIRTN
  5538                                                                  ECSRIRTN
  5539 REIN-CALC-LIFE-X.                                                ECSRIRTN
  5540     EXIT.                                                        ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 110
* ECS026.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
  5541                                                                  ECSRIRTN
  5542 REIN-CALC-AH.                                                    ECSRIRTN
  5543                                                                  ECSRIRTN
  5544     IF WT-AHBEN-LO = ZERO                                        ECSRIRTN
  5545         AND WT-AHBEN-HI = ZERO                                   ECSRIRTN
  5546             MOVE +9999999.99 TO WT-AHBEN-LO                      ECSRIRTN
  5547                                 WT-AHBEN-HI.                     ECSRIRTN
  5548                                                                  ECSRIRTN
  5549     IF WT-AHMOA-LO = ZERO                                        ECSRIRTN
  5550         AND WT-AHMOA-HI = ZERO                                   ECSRIRTN
  5551             MOVE +9999999.99 TO WT-AHMOA-LO                      ECSRIRTN
  5552                                 WT-AHMOA-HI.                     ECSRIRTN
  5553                                                                  ECSRIRTN
  5554     COMPUTE RW-AHLIM-LO = CR-AH-TERM * WT-AHMOA-LO.              ECSRIRTN
  5555     COMPUTE RW-AHLIM-HI = CR-AH-TERM * WT-AHMOA-HI.              ECSRIRTN
  5556                                                                  ECSRIRTN
  5557     IF RW-AHLIM-LO GREATER WT-AHBEN-LO                           ECSRIRTN
  5558         MOVE WT-AHBEN-LO TO RW-AHLIM-LO.                         ECSRIRTN
  5559                                                                  ECSRIRTN
  5560     IF RW-AHLIM-HI GREATER WT-AHBEN-HI                           ECSRIRTN
  5561         MOVE WT-AHBEN-HI TO RW-AHLIM-HI.                         ECSRIRTN
  5562                                                                  ECSRIRTN
  5563     IF RW-AHWRK GREATER RW-AHLIM-HI                              ECSRIRTN
  5564         MOVE RW-AHLIM-HI TO RW-AHWRK.                            ECSRIRTN
  5565                                                                  ECSRIRTN
  5566     IF RW-AHWRK LESS RW-AHLIM-LO                                 ECSRIRTN
  5567         MOVE +0 TO RWF-AHAMT                                     ECSRIRTN
  5568     ELSE                                                         ECSRIRTN
  5569         IF WT-REMAINING = 'L'                                    ECSRIRTN
  5570             COMPUTE RWF-AHAMT ROUNDED = RW-AHWRK / CR-AH-TERM    ECSRIRTN
  5571         ELSE                                                     ECSRIRTN
  5572             COMPUTE RWF-AHAMT ROUNDED =                          ECSRIRTN
  5573             ((RW-AHWRK - RW-AHLIM-LO) / CR-AH-TERM) * WT-AH-PCT. ECSRIRTN
  5574                                                                  ECSRIRTN
  5575 REIN-AH-SKIP-LIMIT.                                              ECSRIRTN
  5576                                                                  ECSRIRTN
  5577     IF WT-REMAINING = 'I'                                        ECSRIRTN
  5578         GO TO REIN-CALC-AH-RISK-PREM.                            ECSRIRTN
  5579                                                                  ECSRIRTN
  5580     IF WT-REMAINING = 'L'                                        ECSRIRTN
  5581         COMPUTE RWF-AHPRM ROUNDED = RS-AH-PREM * WT-AH-PCT       ECSRIRTN
  5582         GO TO REIN-CALC-AH-X.                                    ECSRIRTN
  5583                                                                  ECSRIRTN
  5584     IF RS-AH-BEN NOT = ZERO                                      ECSRIRTN
  5585         COMPUTE RW-AHPRM ROUNDED = (RS-AH-PREM *                 ECSRIRTN
  5586                   RWF-AHAMT) / RS-AH-BEN                         ECSRIRTN
  5587         COMPUTE RW-AHPRMC ROUNDED = (RS-AP-CALC *                ECSRIRTN
  5588                   RWF-AHAMT) / RS-AH-BEN                         ECSRIRTN
  5589     ELSE                                                         ECSRIRTN
  5590         IF RW-AHLIM-LO = ZERO                                    ECSRIRTN
  5591             COMPUTE RW-AHPRM ROUNDED = RS-AH-PREM * WT-AH-PCT    ECSRIRTN
  5592             COMPUTE RW-AHPRMC ROUNDED = RS-AP-CALC * WT-AH-PCT.  ECSRIRTN
  5593                                                                  ECSRIRTN
  5594     IF ((WT-AH-QC = '1' OR '3') OR                                  CL**8
  5595         (WT-AH-QC = '2' AND                                         CL**8
  5596          PGM-SUB = +50  AND                                         CL**8
  5597          DTE-CLIENT = 'LAP'))                                       CL**8
  5598         MOVE RW-AHPRM TO RWF-AHPRM                               ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 111
* ECS026.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
  5599     ELSE                                                         ECSRIRTN
  5600         MOVE RW-AHPRMC TO RWF-AHPRM.                             ECSRIRTN
  5601                                                                  ECSRIRTN
  5602     IF RE-NSP-ST-CD-AH = SPACES OR ZERO                          ECSRIRTN
  5603         IF (WT-REMAINING = 'Y' OR 'Z') AND (WT-AH-QC = '1')      ECSRIRTN
  5604            AND (RWF-AHAMT = RS-R-AB) AND (RWF-AHAMT NOT = +0)    ECSRIRTN
  5605                MOVE 'Y' TO RWF-REM-AH-100.                       ECSRIRTN
  5606                                                                  ECSRIRTN
  5607     IF WT-REMAINING = 'Y' OR 'Z' OR 'X' OR 'N'                   ECSRIRTN
  5608         COMPUTE RS-R-AB = RS-R-AB - RWF-AHAMT                    ECSRIRTN
  5609         COMPUTE RS-R-AP = RS-R-AP - RW-AHPRM                     ECSRIRTN
  5610         COMPUTE RS-R-APC = RS-R-APC - RW-AHPRMC.                 ECSRIRTN
  5611                                                                  ECSRIRTN
  5612     GO TO REIN-CALC-AH-X.                                        ECSRIRTN
  5613                                                                  ECSRIRTN
  5614 REIN-CALC-AH-RISK-PREM.                                          ECSRIRTN
  5615                                                                  ECSRIRTN
  5616     IF RWF-AHAMT NOT GREATER THAN +0                             ECSRIRTN
  5617         MOVE ZEROS                 TO RWF-AHPRM                  ECSRIRTN
  5618         GO TO REIN-CALC-AH-X.                                    ECSRIRTN
  5619                                                                  ECSRIRTN
  5620     COMPUTE REIN-RISK-AMOUNT = RWF-AHAMT * CR-AH-TERM.           ECSRIRTN
  5621     MOVE RS-AH-BEN              TO REIN-MONTH-REDUCE.            ECSRIRTN
  5622     MOVE +0                     TO REIN-WORKA                    ECSRIRTN
  5623                                    RW-AHPRM.                     ECSRIRTN
  5624                                                                  ECSRIRTN
  5625 REIN-AH-RISK-PREM-LOOP.                                          ECSRIRTN
  5626                                                                  ECSRIRTN
  5627     COMPUTE RW-AHPRM = RW-AHPRM +                                ECSRIRTN
  5628                ((REIN-RISK-AMOUNT / +1000) * CR-AH-NSP-PRM-RATE).ECSRIRTN
  5629                                                                  ECSRIRTN
  5630     SUBTRACT REIN-MONTH-REDUCE FROM REIN-RISK-AMOUNT.            ECSRIRTN
  5631                                                                  ECSRIRTN
  5632     IF REIN-WORKA = REIN-EARN-AH-TERM  OR                        ECSRIRTN
  5633        REIN-RISK-AMOUNT LESS THAN +0                             ECSRIRTN
  5634         MOVE RW-AHPRM          TO RWF-AHPRM                      ECSRIRTN
  5635     ELSE                                                         ECSRIRTN
  5636         ADD +1 TO REIN-WORKA                                     ECSRIRTN
  5637         GO TO REIN-AH-RISK-PREM-LOOP.                            ECSRIRTN
  5638                                                                  ECSRIRTN
  5639                                                                  ECSRIRTN
  5640 REIN-CALC-AH-X.                                                  ECSRIRTN
  5641     EXIT.                                                        ECSRIRTN
  5642                                                                  ECSRIRTN
  5643 REINSURE-CALC-REMAINDER.                                         ECSRIRTN
  5644                                                                  ECSRIRTN
  5645     COMPUTE RWF-LFAMT = CR-LFAMT + CR-LFAMT-ALT.                 ECSRIRTN
  5646     COMPUTE RWF-LFPRM = CR-LFPRM + CR-LFPRM-ALT.                 ECSRIRTN
  5647     MOVE CR-AHAMT TO RWF-AHAMT.                                  ECSRIRTN
  5648     MOVE CR-AHPRM TO RWF-AHPRM.                                  ECSRIRTN
  5649                                                                  ECSRIRTN
  5650     PERFORM REINSURE-SUBTRACT THRU REINSURE-SUBTRACT-X           ECSRIRTN
  5651         VARYING SUB2 FROM +1 BY +1 UNTIL SUB2 = SUB1.            ECSRIRTN
  5652                                                                  ECSRIRTN
  5653     IF RWF-LFAMT NOT = ZEROS OR                                  ECSRIRTN
  5654        RWF-LFPRM NOT = ZEROS                                     ECSRIRTN
  5655           MOVE 'X' TO REIN-LF-FLG (SUB1).                        ECSRIRTN
  5656                                                                  ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 112
* ECS026.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
  5657     IF RWF-AHAMT NOT = ZEROS OR                                  ECSRIRTN
  5658        RWF-AHPRM NOT = ZEROS                                     ECSRIRTN
  5659           MOVE 'X' TO REIN-AH-FLG (SUB1).                        ECSRIRTN
  5660                                                                  ECSRIRTN
  5661 REINSURE-CALC-X.                                                 ECSRIRTN
  5662                                                                  ECSRIRTN
  5663     IF REIN-LF-AH-FLGS (SUB1) NOT = SPACES                       ECSRIRTN
  5664         MOVE 'X' TO REIN-BUS-FLAG.                               ECSRIRTN
  5665                                                                  ECSRIRTN
  5666     MOVE RWF-FIELDS TO REIN-WORK-FLDS (SUB1).                    ECSRIRTN
  5667                                                                  ECSRIRTN
  5668 REINSURE-SUBTRACT.                                               ECSRIRTN
  5669                                                                  ECSRIRTN
  5670     SUBTRACT REIN-LFAMT (SUB2) FROM RWF-LFAMT.                   ECSRIRTN
  5671     SUBTRACT REIN-LFPRM (SUB2) FROM RWF-LFPRM.                   ECSRIRTN
  5672     SUBTRACT REIN-AHAMT (SUB2) FROM RWF-AHAMT.                   ECSRIRTN
  5673     SUBTRACT REIN-AHPRM (SUB2) FROM RWF-AHPRM.                   ECSRIRTN
  5674                                                                  ECSRIRTN
  5675 REINSURE-SUBTRACT-X.                                             ECSRIRTN
  5676     EXIT.                                                        ECSRIRTN
  5677                                                                  ECSRIRTN
  5678 REINSURE-CALC-CANCEL.                                            ECSRIRTN
  5679                                                                  ECSRIRTN
  5680     MOVE REIN-WORK-FLDS (SUB1) TO RWF-FIELDS.                    ECSRIRTN
  5681     MOVE RE-COMP-INFO (SUB1) TO WT-COMP-INFO.                    ECSRIRTN
  5682                                                                  ECSRIRTN
  5683     IF SUB1 = RE-100-COMP                                        ECSRIRTN
  5684         GO TO REINSURE-REMAINDER-CANCEL.                         ECSRIRTN
  5685                                                                  ECSRIRTN
  5686     IF REIN-LF-FLG (SUB1) NOT = 'X'                              ECSRIRTN
  5687         GO TO REINSURE-CALC-CANCEL-AH.                           ECSRIRTN
  5688                                                                  ECSRIRTN
  5689     IF RWF-LF-RUNOFF-SW = 'N'                                    ECSRIRTN
  5690         IF CR-LF-CANC-DT NOT LESS THAN RWF-EP-STOP-DATE             CL**3
  5691             GO TO REINSURE-CALC-CANCEL-AH.                       ECSRIRTN
  5692                                                                  ECSRIRTN
  5693     IF WT-REMAINING = 'I'                                        ECSRIRTN
  5694         GO TO REINSURE-CALC-LF-RISK-CANCEL.                      ECSRIRTN
  5695                                                                  ECSRIRTN
  5696     IF WT-REMAINING = 'L'                                        ECSRIRTN
  5697         COMPUTE RWF-LFRFND ROUNDED = CR-LFRFND * WT-LF-PCT       ECSRIRTN
  5698         GO TO REINSURE-CALC-CANCEL-AH.                           ECSRIRTN
  5699                                                                  ECSRIRTN
  5700     IF CR-LFPRM = ZERO                                           ECSRIRTN
  5701        MOVE ZERO                TO REIN-FACTOR
  5702     ELSE                                                         ECSRIRTN
  5703        IF DTE-CLIENT = 'GIC'  AND
  5704           CLAS-I-BAL (CLAS-INDEXL) = 'B'
  5705           MOVE +1.0             TO REIN-FACTOR
  5706        ELSE
  5707           IF DTE-CLIENT = 'DCC'
  5708              COMPUTE REIN-FACTOR = CR-LFRFND /
  5709                 (CR-LFPRM + CR-LFPRM-ALT)
  5710           ELSE
  5711              COMPUTE REIN-FACTOR ROUNDED =  CR-LFRFND-CALC /
  5712                 (CR-LFPRM + CR-LFPRM-ALT)
  5713            END-IF
  5714         END-IF
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 113
* ECS026.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
  5715     END-IF
  5716                                                                  ECSRIRTN
  5717     IF CR-LFAMT NOT = ZERO                                       ECSRIRTN
  5718         IF DTE-CLIENT = 'GTL'  OR  'UAL'  OR  'NCL'  OR  'CVL'   ECSRIRTN
  5719             IF WT-LF-QC = ('1' OR '4')                           ECSRIRTN
  5720                 COMPUTE RWF-LFRFND ROUNDED =  ((CR-LFRFND *      ECSRIRTN
  5721                         RWF-LFAMT) / (CR-LFAMT + CR-LFAMT-ALT))  ECSRIRTN
  5722             ELSE                                                 ECSRIRTN
  5723                 COMPUTE RWF-LFRFND =                             ECSRIRTN
  5724                            REIN-FACTOR * REIN-CALCED-LIFE        ECSRIRTN
  5725                 COMPUTE RWF-LFRFND ROUNDED =  ((RWF-LFRFND *     ECSRIRTN
  5726                         RWF-LFAMT) / (CR-LFAMT + CR-LFAMT-ALT))  ECSRIRTN
  5727         ELSE                                                     ECSRIRTN
  5728             IF WT-LF-QC = ('1' OR '4')                           ECSRIRTN
  5729                 compute rein-factor rounded =
  5730                    RWF-LFAMT / (CR-LFAMT + CR-LFAMT-ALT)
  5731                 COMPUTE RWF-LFRFND ROUNDED =  CR-LFRFND *
  5732                    rein-factor
  5733             ELSE                                                 ECSRIRTN
  5734*                COMPUTE RWF-LFRFND = REIN-FACTOR
  5735*                   * REIN-CALCED-LIFE *
  5736*                   (RWF-LFAMT / (CR-LFAMT + CR-LFAMT-ALT)).
  5737                 COMPUTE RWF-LFRFND =                             ECSRIRTN
  5738                            REIN-FACTOR * REIN-CALCED-LIFE        ECSRIRTN
  5739                 COMPUTE RWF-LFRFND ROUNDED =  (RWF-LFRFND *
  5740                        RWF-LFAMT) / (CR-LFAMT + CR-LFAMT-ALT).
  5741                                                                  ECSRIRTN
  5742     IF CR-LFAMT = ZERO                                           ECSRIRTN
  5743         IF WT-LF-LIM-LO = ZERO                                   ECSRIRTN
  5744             IF WT-LF-QC = ('1' OR '4')                           ECSRIRTN
  5745                 COMPUTE RWF-LFRFND ROUNDED =                     ECSRIRTN
  5746                       CR-LFRFND * WT-LF-PCT                      ECSRIRTN
  5747             ELSE                                                 ECSRIRTN
  5748                 COMPUTE RWF-LFRFND =                             ECSRIRTN
  5749                            REIN-FACTOR * REIN-CALCED-LIFE        ECSRIRTN
  5750                 COMPUTE RWF-LFRFND ROUNDED =                     ECSRIRTN
  5751                       RWF-LFRFND * WT-LF-PCT.                    ECSRIRTN
  5752                                                                  ECSRIRTN
  5753     GO TO REINSURE-CALC-CANCEL-AH.                               ECSRIRTN
  5754                                                                  ECSRIRTN
  5755                                                                  ECSRIRTN
  5756 REINSURE-CALC-LF-RISK-CANCEL.                                    ECSRIRTN
  5757                                                                  ECSRIRTN
  5758     IF RWF-LFAMT NOT GREATER THAN +0  OR                         ECSRIRTN
  5759       (CR-LF-CANC-DT = ZEROS)                                       CL*10
  5760         MOVE ZERO                    TO RWF-LFRFND               ECSRIRTN
  5761         GO TO REINSURE-CALC-CANCEL-AH.                           ECSRIRTN
  5762                                                                  ECSRIRTN
  5763     IF REIN-RT-SW NOT = 'X'                                      ECSRIRTN
  5764       IF VOIDING-LF-CANCEL                                       ECSRIRTN
  5765           COMPUTE RWF-LFRFND = RWF-LFRFND * (-1)                 ECSRIRTN
  5766           GO TO REINSURE-CALC-CANCEL-AH                          ECSRIRTN
  5767       ELSE                                                       ECSRIRTN
  5768           IF ADDITIONAL-LF-CANCEL                                ECSRIRTN
  5769               GO TO REINSURE-CALC-CANCEL-AH.                     ECSRIRTN
  5770                                                                  ECSRIRTN
  5771     IF FLAT-CANCEL-LF                                            ECSRIRTN
  5772         MOVE RWF-LFPRM               TO RWF-LFRFND               ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 114
* ECS026.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
  5773         GO TO REINSURE-CALC-CANCEL-AH.                           ECSRIRTN
  5774                                                                  ECSRIRTN
  5775     IF REIN-EARN-LF-TERM = REIN-LCNC-EARN-TERM                   ECSRIRTN
  5776         MOVE ZERO                    TO RWF-LFRFND               ECSRIRTN
  5777         GO TO REINSURE-CALC-CANCEL-AH.                           ECSRIRTN
  5778                                                                  ECSRIRTN
  5779     MOVE RWF-LFAMT                   TO REIN-RISK-AMOUNT.        ECSRIRTN
  5780     COMPUTE REIN-MONTH-REDUCE = RS-LIFE-BEN / CR-LF-TERM.        ECSRIRTN
  5781     MOVE +0                          TO REIN-WORKA               ECSRIRTN
  5782                                         RW-LFRFND.               ECSRIRTN
  5783                                                                  ECSRIRTN
  5784 REINSURE-LF-RISK-CANCEL-LOOP.                                    ECSRIRTN
  5785                                                                  ECSRIRTN
  5786     COMPUTE RW-LFRFND = RW-LFRFND +                              ECSRIRTN
  5787                ((REIN-RISK-AMOUNT / +1000) * CR-LF-NSP-PRM-RATE).ECSRIRTN
  5788                                                                  ECSRIRTN
  5789     IF CLAS-I-RL-AH (CLAS-INDEXL) NOT = 'L'                      ECSRIRTN
  5790        SUBTRACT REIN-MONTH-REDUCE FROM REIN-RISK-AMOUNT.         ECSRIRTN
  5791                                                                  ECSRIRTN
  5792     IF REIN-WORKA = REIN-LCNC-EARN-TERM  OR                      ECSRIRTN
  5793        REIN-RISK-AMOUNT LESS THAN +0                             ECSRIRTN
  5794         COMPUTE RWF-LFRFND = RWF-LFPRM - RW-LFRFND               ECSRIRTN
  5795     ELSE                                                         ECSRIRTN
  5796         ADD +1 TO REIN-WORKA                                     ECSRIRTN
  5797         GO TO REINSURE-LF-RISK-CANCEL-LOOP.                      ECSRIRTN
  5798                                                                  ECSRIRTN
  5799                                                                  ECSRIRTN
  5800 REINSURE-CALC-CANCEL-AH.                                         ECSRIRTN
  5801                                                                  ECSRIRTN
  5802     IF REIN-AH-FLG (SUB1) NOT = 'X'                              ECSRIRTN
  5803         GO TO REINSURE-CALC-CANCEL-SKIP.                         ECSRIRTN
  5804                                                                  ECSRIRTN
  5805     IF RWF-AH-RUNOFF-SW = 'N'                                    ECSRIRTN
  5806         IF CR-AH-CANC-DT NOT LESS THAN RWF-EP-STOP-DATE             CL**4
  5807             GO TO REINSURE-CALC-CANCEL-SKIP.                     ECSRIRTN
  5808                                                                  ECSRIRTN
  5809     IF RWF-REM-AH-100 = 'Y'                                      ECSRIRTN
  5810         MOVE CR-AHRFND TO RWF-AHRFND                             ECSRIRTN
  5811         PERFORM REINSURE-SUB-REM-CANCEL THRU                     ECSRIRTN
  5812             REINSURE-SUB-REM-CANCEL-X                            ECSRIRTN
  5813                 VARYING SUB2 FROM +1 BY +1 UNTIL SUB2 = SUB1     ECSRIRTN
  5814         GO TO REINSURE-CALC-CANCEL-SKIP.                         ECSRIRTN
  5815                                                                  ECSRIRTN
  5816     IF WT-REMAINING = 'I'                                        ECSRIRTN
  5817         GO TO REINSURE-CALC-AH-RISK-CANCEL.                      ECSRIRTN
  5818                                                                  ECSRIRTN
  5819     IF WT-REMAINING = 'L'                                        ECSRIRTN
  5820         COMPUTE RWF-AHRFND ROUNDED = CR-AHRFND * WT-AH-PCT       ECSRIRTN
  5821         GO TO REINSURE-CALC-CANCEL-SKIP.                         ECSRIRTN
  5822                                                                  ECSRIRTN
  5823     IF CR-AHPRM = ZERO                                           ECSRIRTN
  5824        MOVE ZERO                TO REIN-FACTOR
  5825     ELSE
  5826        IF DTE-CLIENT = 'GIC'  AND
  5827           CLAS-I-BAL (CLAS-INDEXA) = 'B'
  5828            MOVE +1.0            TO REIN-FACTOR
  5829        ELSE
  5830           IF DTE-CLIENT = 'DCC'
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 115
* ECS026.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
  5831              COMPUTE REIN-FACTOR =
  5832                 CR-AHRFND / CR-AHPRM
  5833           ELSE
  5834              COMPUTE REIN-FACTOR ROUNDED =
  5835                                CR-AHRFND-CALC / CR-AHPRM
  5836           END-IF
  5837        END-IF
  5838     END-IF
  5839
  5840     IF CR-AHAMT NOT = ZERO
  5841        IF (DTE-CLIENT = 'DCC')
  5842           AND (CLAS-I-REFUND-METHOD (CLAS-INDEXA) = 'D')
  5843           MOVE CR-AH-RFND-CLP   TO RWF-AHRFND
  5844        ELSE
  5845           IF WT-AH-QC = ('1' OR '4')
  5846              compute rein-factor rounded = rwf-ahamt / cr-ahamt
  5847              compute rwf-ahrfnd rounded =
  5848                 cr-ahrfnd * rein-factor
  5849           ELSE
  5850              COMPUTE RWF-AHRFND = REIN-FACTOR * REIN-CALCED-AH
  5851              COMPUTE RWF-AHRFND ROUNDED = (RWF-AHRFND *
  5852                       RWF-AHAMT) / CR-AHAMT
  5853           END-IF
  5854        END-IF
  5855     ELSE
  5856        IF RWF-AH-LIMIT = ZERO
  5857           IF WT-AH-QC = ('1' OR '4')
  5858              COMPUTE RWF-AHRFND ROUNDED =
  5859                       CR-AHRFND * WT-AH-PCT
  5860           ELSE
  5861              COMPUTE RWF-AHRFND =
  5862                            REIN-FACTOR * REIN-CALCED-AH
  5863              COMPUTE RWF-AHRFND ROUNDED =
  5864                       RWF-AHRFND * WT-AH-PCT
  5865           END-IF
  5866        END-IF
  5867     END-IF
  5868
  5869     GO TO REINSURE-CALC-CANCEL-SKIP.                             ECSRIRTN
  5870                                                                  ECSRIRTN
  5871                                                                  ECSRIRTN
  5872 REINSURE-CALC-AH-RISK-CANCEL.                                    ECSRIRTN
  5873                                                                  ECSRIRTN
  5874     IF RWF-AHAMT NOT GREATER THAN +0  OR                         ECSRIRTN
  5875       (CR-AH-CANC-DT = ZEROS)                                       CL*10
  5876         MOVE ZERO                    TO RWF-AHRFND               ECSRIRTN
  5877         GO TO REINSURE-CALC-CANCEL-SKIP.                         ECSRIRTN
  5878                                                                  ECSRIRTN
  5879     IF REIN-RT-SW NOT = 'X'                                      ECSRIRTN
  5880       IF VOIDING-AH-CANCEL                                       ECSRIRTN
  5881           COMPUTE RWF-AHRFND = RWF-AHRFND * (-1)                 ECSRIRTN
  5882           GO TO REINSURE-CALC-CANCEL-SKIP                        ECSRIRTN
  5883       ELSE                                                       ECSRIRTN
  5884           IF ADDITIONAL-AH-CANCEL                                ECSRIRTN
  5885               GO TO REINSURE-CALC-CANCEL-SKIP.                   ECSRIRTN
  5886                                                                  ECSRIRTN
  5887     IF FLAT-CANCEL-AH                                            ECSRIRTN
  5888         MOVE RWF-AHPRM               TO RWF-AHRFND               ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 116
* ECS026.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
  5889         GO TO REINSURE-CALC-CANCEL-SKIP.                         ECSRIRTN
  5890                                                                  ECSRIRTN
  5891     IF REIN-EARN-AH-TERM = REIN-ACNC-EARN-TERM                   ECSRIRTN
  5892         MOVE ZERO                    TO RWF-AHRFND               ECSRIRTN
  5893         GO TO REINSURE-CALC-CANCEL-SKIP.                         ECSRIRTN
  5894                                                                  ECSRIRTN
  5895     MOVE RS-AH-BEN              TO REIN-MONTH-REDUCE.            ECSRIRTN
  5896     COMPUTE REIN-RISK-AMOUNT = RWF-AHAMT * CR-AH-TERM.           ECSRIRTN
  5897     MOVE +0                     TO REIN-WORKA                    ECSRIRTN
  5898                                    RW-AHRFND.                    ECSRIRTN
  5899                                                                  ECSRIRTN
  5900 REINSURE-AH-RISK-CANCEL-LOOP.                                    ECSRIRTN
  5901                                                                  ECSRIRTN
  5902     COMPUTE RW-AHRFND = RW-AHRFND +                              ECSRIRTN
  5903                ((REIN-RISK-AMOUNT / +1000) * CR-AH-NSP-PRM-RATE).ECSRIRTN
  5904                                                                  ECSRIRTN
  5905     SUBTRACT REIN-MONTH-REDUCE FROM REIN-RISK-AMOUNT.            ECSRIRTN
  5906                                                                  ECSRIRTN
  5907     IF REIN-WORKA = REIN-ACNC-EARN-TERM  OR                      ECSRIRTN
  5908        REIN-RISK-AMOUNT LESS THAN +0                             ECSRIRTN
  5909         COMPUTE RWF-AHRFND = RWF-AHPRM - RW-AHRFND               ECSRIRTN
  5910     ELSE                                                         ECSRIRTN
  5911         ADD +1 TO REIN-WORKA                                     ECSRIRTN
  5912         GO TO REINSURE-AH-RISK-CANCEL-LOOP.                      ECSRIRTN
  5913                                                                  ECSRIRTN
  5914                                                                  ECSRIRTN
  5915 REINSURE-CALC-CANCEL-SKIP.                                       ECSRIRTN
  5916                                                                  ECSRIRTN
  5917     IF RWF-LFRFND NOT = ZEROS                                    ECSRIRTN
  5918         MOVE 'X' TO REIN-LF-FLG (SUB1).                          ECSRIRTN
  5919                                                                  ECSRIRTN
  5920     IF RWF-AHRFND NOT = ZEROS                                    ECSRIRTN
  5921         MOVE 'X' TO REIN-AH-FLG (SUB1).                          ECSRIRTN
  5922                                                                  ECSRIRTN
  5923     GO TO REINSURE-CALC-CANCEL-X.                                ECSRIRTN
  5924                                                                  ECSRIRTN
  5925 REINSURE-REMAINDER-CANCEL.                                       ECSRIRTN
  5926                                                                  ECSRIRTN
  5927     MOVE CR-LFRFND TO RWF-LFRFND.                                ECSRIRTN
  5928     MOVE CR-AHRFND TO RWF-AHRFND.                                ECSRIRTN
  5929                                                                  ECSRIRTN
  5930     PERFORM REINSURE-SUBTRACT-CANCEL THRU                        ECSRIRTN
  5931         REINSURE-SUBTRACT-CANCEL-X                               ECSRIRTN
  5932             VARYING SUB2 FROM +1 BY +1 UNTIL SUB2 = SUB1.        ECSRIRTN
  5933                                                                  ECSRIRTN
  5934     IF RWF-LFRFND NOT = ZEROS                                    ECSRIRTN
  5935         MOVE 'X' TO REIN-LF-FLG (SUB1).                          ECSRIRTN
  5936                                                                  ECSRIRTN
  5937     IF RWF-AHRFND NOT = ZEROS                                    ECSRIRTN
  5938         MOVE 'X' TO REIN-AH-FLG (SUB1).                          ECSRIRTN
  5939                                                                  ECSRIRTN
  5940 REINSURE-CALC-CANCEL-X.                                          ECSRIRTN
  5941                                                                  ECSRIRTN
  5942     IF REIN-LF-AH-FLGS (SUB1) NOT = SPACES                       ECSRIRTN
  5943         MOVE 'X' TO REIN-BUS-FLAG.                               ECSRIRTN
  5944                                                                  ECSRIRTN
  5945     MOVE RWF-FIELDS TO REIN-WORK-FLDS (SUB1).                    ECSRIRTN
  5946                                                                  ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 117
* ECS026.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
  5947 REINSURE-SUBTRACT-CANCEL.                                        ECSRIRTN
  5948                                                                  ECSRIRTN
  5949     SUBTRACT REIN-LFRFND (SUB2) FROM RWF-LFRFND.                 ECSRIRTN
  5950     SUBTRACT REIN-AHRFND (SUB2) FROM RWF-AHRFND.                 ECSRIRTN
  5951                                                                  ECSRIRTN
  5952 REINSURE-SUBTRACT-CANCEL-X.                                      ECSRIRTN
  5953     EXIT.                                                        ECSRIRTN
  5954                                                                  ECSRIRTN
  5955 REINSURE-SUB-REM-CANCEL.                                         ECSRIRTN
  5956                                                                  ECSRIRTN
  5957     IF REIN-REM-SW (SUB2) = 'Y' OR 'Z' OR 'X' OR 'N'             ECSRIRTN
  5958         SUBTRACT REIN-AHRFND (SUB2) FROM RWF-AHRFND.             ECSRIRTN
  5959                                                                  ECSRIRTN
  5960 REINSURE-SUB-REM-CANCEL-X.                                       ECSRIRTN
  5961     EXIT.                                                        ECSRIRTN
  5962                                                                  ECSRIRTN
  5963 REINSURE-CALC-CLAIM.                                             ECSRIRTN
  5964                                                                  ECSRIRTN
  5965     MOVE REIN-WORK-FLDS (SUB1) TO RWF-FIELDS.                    ECSRIRTN
  5966     MOVE RE-COMP-INFO (SUB1) TO WT-COMP-INFO.                    ECSRIRTN
  5967                                                                  ECSRIRTN
  5968     IF SUB1 = RE-100-COMP                                        ECSRIRTN
  5969         GO TO REINSURE-REMAINDER-CLAIM.                          ECSRIRTN
  5970                                                                  ECSRIRTN
  5971     PERFORM REIN-FIND-CO-LOOP THRU FIND-REI-CO-EXIT              ECSRIRTN
  5972        VARYING CO-SUB FROM 1 BY 1 UNTIL                          ECSRIRTN
  5973          (RCT-REIN-CO (CO-SUB) = REIN-COMP (SUB1))  OR           ECSRIRTN
  5974          (CO-SUB GREATER REIN-CO-TABLE-ENT-CNT)     OR           ECSRIRTN
  5975          (RCT-REIN-CO (CO-SUB) = SPACES).                        ECSRIRTN
  5976                                                                  ECSRIRTN
  5977     IF (CO-SUB GREATER REIN-CO-TABLE-ENT-CNT)  OR                ECSRIRTN
  5978        (RCT-REIN-CO (CO-SUB) = SPACES)                           ECSRIRTN
  5979          MOVE ZERO TO CO-SUB.                                    ECSRIRTN
  5980                                                                  ECSRIRTN
  5981     MOVE ZEROS                TO RWF-LFCLML                      ECSRIRTN
  5982                                  RWF-AHCLML.                     ECSRIRTN
  5983                                                                  ECSRIRTN
  5984     IF REIN-LF-FLG (SUB1) NOT = 'X'                              ECSRIRTN
  5985         GO TO REINSURE-CALC-CLAIM-AH.                            ECSRIRTN
  5986                                                                  ECSRIRTN
  5987     IF RW-LFCLMWK = ZEROS                                        ECSRIRTN
  5988         GO TO REINSURE-CALC-CLAIM-AH.                            ECSRIRTN
  5989                                                                  ECSRIRTN
  5990     IF CO-SUB NOT = ZERO                                         ECSRIRTN
  5991         IF RCT-CLM-CUTOFF-DT (CO-SUB) NOT = ZERO                 ECSRIRTN
  5992             IF CR-DTH-DT LESS RCT-CLM-CUTOFF-DT (CO-SUB)         ECSRIRTN
  5993                 GO TO REINSURE-CALC-CLAIM-AH.                    ECSRIRTN
  5994                                                                  ECSRIRTN
  5995     IF RWF-LF-RUNOFF-SW = 'N'                                    ECSRIRTN
  5996         IF CR-DTH-DT NOT LESS THAN RWF-EP-STOP-DATE                 CL**6
  5997                 GO TO REINSURE-CALC-CLAIM-AH.                    ECSRIRTN
  5998                                                                  ECSRIRTN
  5999     IF WT-REMAINING = 'I'                                        ECSRIRTN
  6000         GO TO REINSURE-CALC-LF-RISK-CLAIM.                       ECSRIRTN
  6001                                                                  ECSRIRTN
  6002     IF WT-REMAINING = 'L'                                        ECSRIRTN
  6003         IF REIN-RT-SW = 'X'                                      ECSRIRTN
  6004             IF RW-LFCLMWK GREATER WT-LF-HI                       ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 118
* ECS026.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
  6005                 MOVE WT-LF-HI TO RWF-LFCLM                       ECSRIRTN
  6006             ELSE                                                 ECSRIRTN
  6007                 MOVE RW-LFCLMWK TO RWF-LFCLM                     ECSRIRTN
  6008         ELSE                                                     ECSRIRTN
  6009             IF (RW-LFCLMWK + RWF-LFCLM) GREATER WT-LF-HI         ECSRIRTN
  6010                 COMPUTE RWF-LFCLML = WT-LF-HI - RWF-LFCLM        ECSRIRTN
  6011                 MOVE WT-LF-HI TO RWF-LFCLM                       ECSRIRTN
  6012             ELSE                                                 ECSRIRTN
  6013                 MOVE RW-LFCLMWK TO RWF-LFCLML                    ECSRIRTN
  6014                 ADD RWF-LFCLML TO RWF-LFCLM.                     ECSRIRTN
  6015                                                                  ECSRIRTN
  6016     IF WT-REMAINING = 'L'                                        ECSRIRTN
  6017         GO TO REINSURE-CALC-CLAIM-AH.                            ECSRIRTN
  6018                                                                  ECSRIRTN
  6019     IF CR-LFAMT NOT = ZERO                                       ECSRIRTN
  6020         IF DTE-CLIENT = 'GTL'  OR  'UAL'  OR  'NCL'  OR  'CVL'   ECSRIRTN
  6021            OR 'DCC'
  6022             COMPUTE RWF-LFCLML ROUNDED =  ((RW-LFCLMWK *         ECSRIRTN
  6023                         RWF-LFAMT) / (CR-LFAMT + CR-LFAMT-ALT))  ECSRIRTN
  6024         ELSE                                                     ECSRIRTN
  6025             COMPUTE RWF-LFCLML ROUNDED =  RW-LFCLMWK *           ECSRIRTN
  6026                        (RWF-LFAMT / (CR-LFAMT + CR-LFAMT-ALT)).  ECSRIRTN
  6027                                                                  ECSRIRTN
  6028     IF CR-LFAMT = ZERO                                           ECSRIRTN
  6029         IF WT-LF-LIM-LO = ZERO                                   ECSRIRTN
  6030             COMPUTE RWF-LFCLML ROUNDED =                         ECSRIRTN
  6031                       RW-LFCLMWK * WT-LF-PCT.                    ECSRIRTN
  6032                                                                  ECSRIRTN
  6033     IF CO-SUB NOT = ZERO                                         ECSRIRTN
  6034         IF RCT-LF-CLM-PCT (CO-SUB) NOT = ZERO                    ECSRIRTN
  6035             COMPUTE RWF-LFCLML ROUNDED =                         ECSRIRTN
  6036                          RW-LFCLMWK * RCT-LF-CLM-PCT (CO-SUB).   ECSRIRTN
  6037                                                                  ECSRIRTN
  6038     IF CO-SUB NOT = ZERO                                         ECSRIRTN
  6039         IF RCT-LF-CLM-MAX (CO-SUB) NOT = ZERO                    ECSRIRTN
  6040             IF REIN-RT-SW = 'X'                                  ECSRIRTN
  6041               IF RWF-LFCLML GREATER RCT-LF-CLM-MAX (CO-SUB)      ECSRIRTN
  6042                     MOVE RCT-LF-CLM-MAX (CO-SUB) TO RWF-LFCLM    ECSRIRTN
  6043                      GO TO REINSURE-CALC-CLAIM-AH                ECSRIRTN
  6044                  ELSE                                            ECSRIRTN
  6045                     MOVE RWF-LFCLML TO RWF-LFCLM                 ECSRIRTN
  6046                      GO TO REINSURE-CALC-CLAIM-AH                ECSRIRTN
  6047              ELSE                                                ECSRIRTN
  6048                 IF (RWF-LFCLML + RWF-LFCLM) GREATER              ECSRIRTN
  6049                                           RCT-LF-CLM-MAX (CO-SUB)ECSRIRTN
  6050                     COMPUTE RWF-LFCLML =                         ECSRIRTN
  6051                               RCT-LF-CLM-MAX (CO-SUB) - RWF-LFCLMECSRIRTN
  6052                     MOVE RCT-LF-CLM-MAX (CO-SUB) TO RWF-LFCLM    ECSRIRTN
  6053                      GO TO REINSURE-CALC-CLAIM-AH.               ECSRIRTN
  6054                                                                  ECSRIRTN
  6055     ADD RWF-LFCLML TO RWF-LFCLM.                                 ECSRIRTN
  6056                                                                  ECSRIRTN
  6057     GO TO REINSURE-CALC-CLAIM-AH.                                ECSRIRTN
  6058                                                                  ECSRIRTN
  6059                                                                  ECSRIRTN
  6060 REINSURE-CALC-LF-RISK-CLAIM.                                     ECSRIRTN
  6061                                                                  ECSRIRTN
  6062     IF RWF-LFAMT NOT GREATER THAN +0                             ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 119
* ECS026.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
  6063         GO TO REINSURE-CALC-CLAIM-AH.                            ECSRIRTN
  6064                                                                  ECSRIRTN
  6065     IF CLAS-I-RL-AH (CLAS-INDEXL) = 'L'                          ECSRIRTN
  6066         MOVE RWF-LFAMT                   TO REIN-RISK-AMOUNT     ECSRIRTN
  6067     ELSE                                                         ECSRIRTN
  6068         COMPUTE REIN-RISK-AMOUNT = RWF-LFAMT -                   ECSRIRTN
  6069                ((RS-LIFE-BEN / CR-LF-TERM) * REIN-LF-CLM-MONTHS).ECSRIRTN
  6070                                                                  ECSRIRTN
  6071     IF REIN-RISK-AMOUNT NOT GREATER THAN +0                      ECSRIRTN
  6072         GO TO REINSURE-CALC-CLAIM-AH.                            ECSRIRTN
  6073                                                                  ECSRIRTN
  6074     IF REIN-RT-SW = 'X'                                          ECSRIRTN
  6075         IF RW-LFCLMWK GREATER THAN REIN-RISK-AMOUNT              ECSRIRTN
  6076             MOVE REIN-RISK-AMOUNT        TO RWF-LFCLM            ECSRIRTN
  6077         ELSE                                                     ECSRIRTN
  6078             MOVE RW-LFCLMWK              TO RWF-LFCLM            ECSRIRTN
  6079     ELSE                                                         ECSRIRTN
  6080         IF (RW-LFCLMWK + RWF-LFCLM) GREATER THAN REIN-RISK-AMOUNTECSRIRTN
  6081             COMPUTE RWF-LFCLML = REIN-RISK-AMOUNT - RWF-LFCLM    ECSRIRTN
  6082             MOVE REIN-RISK-AMOUNT        TO RWF-LFCLM            ECSRIRTN
  6083         ELSE                                                     ECSRIRTN
  6084             MOVE RW-LFCLMWK              TO RWF-LFCLML           ECSRIRTN
  6085             ADD RW-LFCLMWK TO RWF-LFCLM.                         ECSRIRTN
  6086                                                                  ECSRIRTN
  6087                                                                  ECSRIRTN
  6088 REINSURE-CALC-CLAIM-AH.                                          ECSRIRTN
  6089                                                                  ECSRIRTN
  6090     IF REIN-AH-FLG (SUB1) NOT = 'X'                              ECSRIRTN
  6091         GO TO REINSURE-CALC-CLAIM-X.                             ECSRIRTN
  6092                                                                  ECSRIRTN
  6093     IF RW-AHCLMWK = ZEROS                                        ECSRIRTN
  6094         GO TO REINSURE-CALC-CLAIM-SKIP.                          ECSRIRTN
  6095                                                                  ECSRIRTN
  6096     IF REIN-RT-SW NOT = 'X'                                      ECSRIRTN
  6097         GO TO REINSURE-CALC-AH-DETAIL.                           ECSRIRTN
  6098                                                                  ECSRIRTN
  6099     MOVE CR-DISAB-INCURRED-DETAIL    TO RW-AH-INCURRED-DETAIL.   ECSRIRTN
  6100     MOVE ZEROS                       TO RW-AHCLMWK.              ECSRIRTN
  6101                                                                  ECSRIRTN
  6102     PERFORM CHECK-MULTIPLE-DISABILITIES THRU CHECK-DISABS-EXIT   ECSRIRTN
  6103             VARYING                                              ECSRIRTN
  6104         INC-SUB FROM +1 BY +1                                    ECSRIRTN
  6105             UNTIL                                                ECSRIRTN
  6106         INC-SUB GREATER THAN +5.                                 ECSRIRTN
  6107                                                                  ECSRIRTN
  6108     IF RW-AHCLMWK = ZEROS                                        ECSRIRTN
  6109         GO TO REINSURE-CALC-CLAIM-SKIP                           ECSRIRTN
  6110     ELSE                                                         ECSRIRTN
  6111         GO TO REINSURE-CALC-AH-CONTINUED.                        ECSRIRTN
  6112                                                                  ECSRIRTN
  6113 CHECK-MULTIPLE-DISABILITIES.                                     ECSRIRTN
  6114                                                                  ECSRIRTN
  6115     IF RW-AH-INCUR-DT (INC-SUB) = ZEROS                          ECSRIRTN
  6116         GO TO CHECK-DISABS-EXIT.                                 ECSRIRTN
  6117                                                                  ECSRIRTN
  6118     IF CO-SUB NOT = ZERO                                         ECSRIRTN
  6119       IF RCT-CLM-CUTOFF-DT (CO-SUB) NOT = ZERO                   ECSRIRTN
  6120           IF RW-AH-INCUR-DT (INC-SUB) LESS THAN                  ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 120
* ECS026.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
  6121                       RCT-CLM-CUTOFF-DT (CO-SUB)                    CL**5
  6122               MOVE ZEROS             TO RW-AH-CLM-AMT (INC-SUB)  ECSRIRTN
  6123                                         RW-AH-CLM-EXP (INC-SUB)  ECSRIRTN
  6124               GO TO CHECK-DISABS-EXIT.                           ECSRIRTN
  6125                                                                  ECSRIRTN
  6126     IF RWF-AH-RUNOFF-SW = 'N'                                    ECSRIRTN
  6127       IF RW-AH-INCUR-DT (INC-SUB) NOT LESS THAN RWF-EP-STOP-DATE ECSRIRTN
  6128           MOVE ZEROS                 TO RW-AH-CLM-AMT (INC-SUB)  ECSRIRTN
  6129                                         RW-AH-CLM-EXP (INC-SUB)  ECSRIRTN
  6130           GO TO CHECK-DISABS-EXIT.                               ECSRIRTN
  6131                                                                  ECSRIRTN
  6132     IF WT-REMAINING NOT = 'I'                                    ECSRIRTN
  6133         COMPUTE RW-AHCLMWK = RW-AHCLMWK                          ECSRIRTN
  6134                             + RW-AH-CLM-AMT (INC-SUB)            ECSRIRTN
  6135                             + RW-AH-CLM-EXP (INC-SUB)            ECSRIRTN
  6136         GO TO CHECK-DISABS-EXIT.                                 ECSRIRTN
  6137                                                                  ECSRIRTN
  6138     IF RWF-AHAMT NOT GREATER THAN +0                             ECSRIRTN
  6139         GO TO CHECK-DISABS-EXIT.                                 ECSRIRTN
  6140                                                                  ECSRIRTN
  6141     IF INC-SUB = +1                                              ECSRIRTN
  6142         MOVE REIN-AH-CLM-MTH-1       TO REIN-AH-CLM-MONTHS.      ECSRIRTN
  6143     IF INC-SUB = +2                                              ECSRIRTN
  6144         MOVE REIN-AH-CLM-MTH-2       TO REIN-AH-CLM-MONTHS.      ECSRIRTN
  6145     IF INC-SUB = +3                                              ECSRIRTN
  6146         MOVE REIN-AH-CLM-MTH-3       TO REIN-AH-CLM-MONTHS.      ECSRIRTN
  6147     IF INC-SUB = +4                                              ECSRIRTN
  6148         MOVE REIN-AH-CLM-MTH-4       TO REIN-AH-CLM-MONTHS.      ECSRIRTN
  6149     IF INC-SUB = +5                                              ECSRIRTN
  6150         MOVE REIN-AH-CLM-MTH-5       TO REIN-AH-CLM-MONTHS.      ECSRIRTN
  6151                                                                  ECSRIRTN
  6152     COMPUTE REIN-RISK-AMOUNT = (RWF-AHAMT * CR-AH-TERM) -        ECSRIRTN
  6153                                (RS-AH-BEN * REIN-AH-CLM-MONTHS). ECSRIRTN
  6154                                                                  ECSRIRTN
  6155     IF REIN-RISK-AMOUNT NOT GREATER THAN +0                      ECSRIRTN
  6156         GO TO CHECK-DISABS-EXIT.                                 ECSRIRTN
  6157                                                                  ECSRIRTN
  6158     IF (RW-AH-CLM-AMT (INC-SUB) + RW-AH-CLM-EXP (INC-SUB))       ECSRIRTN
  6159              GREATER THAN REIN-RISK-AMOUNT                       ECSRIRTN
  6160         COMPUTE RW-AHCLMWK = RW-AHCLMWK + REIN-RISK-AMOUNT       ECSRIRTN
  6161     ELSE                                                         ECSRIRTN
  6162         COMPUTE RW-AHCLMWK = RW-AHCLMWK                          ECSRIRTN
  6163                             + RW-AH-CLM-AMT (INC-SUB)            ECSRIRTN
  6164                             + RW-AH-CLM-EXP (INC-SUB).           ECSRIRTN
  6165                                                                  ECSRIRTN
  6166 CHECK-DISABS-EXIT.                                               ECSRIRTN
  6167      EXIT.                                                       ECSRIRTN
  6168                                                                  ECSRIRTN
  6169 REINSURE-CALC-AH-DETAIL.                                         ECSRIRTN
  6170                                                                  ECSRIRTN
  6171     IF RW-AHCLMWK = ZEROS                                        ECSRIRTN
  6172         GO TO REINSURE-CALC-CLAIM-SKIP.                          ECSRIRTN
  6173                                                                  ECSRIRTN
  6174     IF CO-SUB NOT = ZERO                                         ECSRIRTN
  6175         IF RCT-CLM-CUTOFF-DT (CO-SUB) NOT = ZERO                 ECSRIRTN
  6176             IF CR-DIS-DT LESS RCT-CLM-CUTOFF-DT (CO-SUB)            CL*11
  6177                 GO TO REINSURE-CALC-CLAIM-SKIP.                  ECSRIRTN
  6178                                                                  ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 121
* ECS026.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
  6179     IF RWF-AH-RUNOFF-SW = 'N'                                    ECSRIRTN
  6180         IF CR-DIS-DT NOT LESS THAN RWF-EP-STOP-DATE                 CL**6
  6181             GO TO REINSURE-CALC-CLAIM-SKIP.                      ECSRIRTN
  6182                                                                  ECSRIRTN
  6183 REINSURE-CALC-AH-CONTINUED.                                      ECSRIRTN
  6184                                                                  ECSRIRTN
  6185     IF RWF-REM-AH-100 = 'Y'                                      ECSRIRTN
  6186         MOVE RW-AHCLMWK TO RWF-AHCLML                            ECSRIRTN
  6187         PERFORM REINSURE-SUB-REM-CLAIM THRU                      ECSRIRTN
  6188             REINSURE-SUB-REM-CLAIM-X                             ECSRIRTN
  6189                 VARYING SUB2 FROM +1 BY +1 UNTIL SUB2 = SUB1     ECSRIRTN
  6190         ADD RWF-AHCLML TO RWF-AHCLM                              ECSRIRTN
  6191         GO TO REINSURE-CALC-CLAIM-SKIP.                          ECSRIRTN
  6192                                                                  ECSRIRTN
  6193     IF WT-REMAINING = 'I'                                        ECSRIRTN
  6194         GO TO REINSURE-CALC-AH-RISK-CLAIM.                       ECSRIRTN
  6195                                                                  ECSRIRTN
  6196     IF WT-REMAINING = 'L'                                        ECSRIRTN
  6197         IF REIN-RT-SW = 'X'                                      ECSRIRTN
  6198             IF RW-AHCLMWK GREATER WT-AHBEN-HI                    ECSRIRTN
  6199                 MOVE WT-AHBEN-HI TO RWF-AHCLM                    ECSRIRTN
  6200             ELSE                                                 ECSRIRTN
  6201                 MOVE RW-AHCLMWK TO RWF-AHCLM                     ECSRIRTN
  6202         ELSE                                                     ECSRIRTN
  6203             IF (RW-AHCLMWK + RWF-AHCLM) GREATER WT-AHBEN-HI      ECSRIRTN
  6204                 COMPUTE RWF-AHCLML = WT-AHBEN-HI - RWF-AHCLM     ECSRIRTN
  6205                 MOVE WT-AHBEN-HI TO RWF-AHCLM                    ECSRIRTN
  6206             ELSE                                                 ECSRIRTN
  6207                 MOVE RW-AHCLMWK TO RWF-AHCLML                    ECSRIRTN
  6208                 ADD RWF-AHCLML TO RWF-AHCLM.                     ECSRIRTN
  6209                                                                  ECSRIRTN
  6210     IF WT-REMAINING = 'L'                                        ECSRIRTN
  6211         GO TO REINSURE-CALC-CLAIM-SKIP.                          ECSRIRTN
  6212                                                                  ECSRIRTN
  6213     IF CR-AHAMT NOT = ZERO                                       ECSRIRTN
  6214         COMPUTE RWF-AHCLML ROUNDED = (RW-AHCLMWK *               ECSRIRTN
  6215                            RWF-AHAMT) / CR-AHAMT                 ECSRIRTN
  6216     ELSE                                                         ECSRIRTN
  6217         IF RWF-AH-LIMIT = ZERO                                   ECSRIRTN
  6218             COMPUTE RWF-AHCLML ROUNDED =                         ECSRIRTN
  6219                       RW-AHCLMWK * WT-AH-PCT.                    ECSRIRTN
  6220                                                                  ECSRIRTN
  6221     IF CO-SUB NOT = ZERO                                         ECSRIRTN
  6222         IF RCT-AH-CLM-PCT (CO-SUB) NOT = ZERO                    ECSRIRTN
  6223             COMPUTE RWF-AHCLML ROUNDED =                         ECSRIRTN
  6224                           RW-AHCLMWK * RCT-AH-CLM-PCT (CO-SUB).  ECSRIRTN
  6225                                                                  ECSRIRTN
  6226     IF CO-SUB NOT = ZERO                                         ECSRIRTN
  6227         IF RCT-AH-CLM-MAX (CO-SUB) NOT = ZERO                    ECSRIRTN
  6228             IF REIN-RT-SW = 'X'                                  ECSRIRTN
  6229               IF RWF-AHCLML GREATER RCT-AH-CLM-MAX (CO-SUB)      ECSRIRTN
  6230                     MOVE RCT-AH-CLM-MAX (CO-SUB) TO RWF-AHCLM    ECSRIRTN
  6231                      GO TO REINSURE-CALC-CLAIM-SKIP              ECSRIRTN
  6232                  ELSE                                            ECSRIRTN
  6233                     MOVE RWF-AHCLML TO RWF-AHCLM                 ECSRIRTN
  6234                      GO TO REINSURE-CALC-CLAIM-SKIP              ECSRIRTN
  6235              ELSE                                                ECSRIRTN
  6236                 IF (RWF-AHCLML + RWF-AHCLM) GREATER              ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 122
* ECS026.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
  6237                                           RCT-AH-CLM-MAX (CO-SUB)ECSRIRTN
  6238                     COMPUTE RWF-AHCLML =                         ECSRIRTN
  6239                               RCT-AH-CLM-MAX (CO-SUB) - RWF-AHCLMECSRIRTN
  6240                     MOVE RCT-AH-CLM-MAX (CO-SUB) TO RWF-AHCLM    ECSRIRTN
  6241                      GO TO REINSURE-CALC-CLAIM-SKIP.             ECSRIRTN
  6242                                                                  ECSRIRTN
  6243                                                                  ECSRIRTN
  6244     IF DTE-CLIENT = 'FLA'                                        ECSRIRTN
  6245        IF REIN-COMP (SUB1) = ('200000' OR '210000' OR            ECSRIRTN
  6246                               '220000' OR '230000')              ECSRIRTN
  6247           PERFORM FLA-SPEC-REIN-CLMS THRU                        ECSRIRTN
  6248               E-FLA-SPEC-REIN-CLMS.                              ECSRIRTN
  6249                                                                  ECSRIRTN
  6250     ADD RWF-AHCLML TO RWF-AHCLM.                                 ECSRIRTN
  6251                                                                  ECSRIRTN
  6252     GO TO REINSURE-CALC-CLAIM-SKIP.                              ECSRIRTN
  6253                                                                  ECSRIRTN
  6254                                                                  ECSRIRTN
  6255 REINSURE-CALC-AH-RISK-CLAIM.                                     ECSRIRTN
  6256                                                                  ECSRIRTN
  6257     IF RWF-AHAMT NOT GREATER THAN +0                             ECSRIRTN
  6258         GO TO REINSURE-CALC-CLAIM-SKIP.                          ECSRIRTN
  6259                                                                  ECSRIRTN
  6260     IF REIN-RT-SW = 'X'                                          ECSRIRTN
  6261         MOVE RW-AHCLMWK              TO RWF-AHCLM                ECSRIRTN
  6262         GO TO REINSURE-CALC-CLAIM-SKIP.                          ECSRIRTN
  6263                                                                  ECSRIRTN
  6264     COMPUTE REIN-RISK-AMOUNT = (RWF-AHAMT * CR-AH-TERM) -        ECSRIRTN
  6265                                (RS-AH-BEN * REIN-AH-CLM-MONTHS). ECSRIRTN
  6266                                                                  ECSRIRTN
  6267     IF REIN-RISK-AMOUNT NOT GREATER THAN +0                      ECSRIRTN
  6268         GO TO REINSURE-CALC-CLAIM-SKIP.                          ECSRIRTN
  6269                                                                  ECSRIRTN
  6270     IF REIN-AH-PRIOR-CLMS-PAID GREATER THAN REIN-RISK-AMOUNT     ECSRIRTN
  6271         GO TO REINSURE-CALC-CLAIM-SKIP.                          ECSRIRTN
  6272                                                                  ECSRIRTN
  6273     IF (RW-AHCLMWK + REIN-AH-PRIOR-CLMS-PAID)                    ECSRIRTN
  6274                                GREATER THAN REIN-RISK-AMOUNT     ECSRIRTN
  6275         COMPUTE RWF-AHCLML = REIN-RISK-AMOUNT                    ECSRIRTN
  6276                             - REIN-AH-PRIOR-CLMS-PAID            ECSRIRTN
  6277         MOVE REIN-RISK-AMOUNT        TO RWF-AHCLM                ECSRIRTN
  6278     ELSE                                                         ECSRIRTN
  6279         MOVE RW-AHCLMWK              TO RWF-AHCLML               ECSRIRTN
  6280         ADD RW-AHCLMWK TO RWF-AHCLM.                             ECSRIRTN
  6281                                                                  ECSRIRTN
  6282                                                                  ECSRIRTN
  6283 REINSURE-CALC-CLAIM-SKIP.                                        ECSRIRTN
  6284                                                                  ECSRIRTN
  6285     IF RWF-LFCLM NOT = ZEROS                                     ECSRIRTN
  6286         MOVE 'X' TO REIN-LF-FLG (SUB1).                          ECSRIRTN
  6287                                                                  ECSRIRTN
  6288     IF RWF-AHCLM NOT = ZEROS                                     ECSRIRTN
  6289         MOVE 'X' TO REIN-AH-FLG (SUB1).                          ECSRIRTN
  6290                                                                  ECSRIRTN
  6291     GO TO REINSURE-CALC-CLAIM-X.                                 ECSRIRTN
  6292                                                                  ECSRIRTN
  6293 REINSURE-REMAINDER-CLAIM.                                        ECSRIRTN
  6294                                                                  ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 123
* ECS026.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
  6295     MOVE RW-LFCLMWK TO RWF-LFCLML.                               ECSRIRTN
  6296     MOVE RW-AHCLMWK TO RWF-AHCLML.                               ECSRIRTN
  6297                                                                  ECSRIRTN
  6298     PERFORM REINSURE-SUBTRACT-CLAIM THRU                         ECSRIRTN
  6299         REINSURE-SUBTRACT-CLAIM-X                                ECSRIRTN
  6300             VARYING SUB2 FROM +1 BY +1 UNTIL SUB2 = SUB1.        ECSRIRTN
  6301                                                                  ECSRIRTN
  6302     ADD RWF-LFCLML TO RWF-LFCLM.                                 ECSRIRTN
  6303     ADD RWF-AHCLML TO RWF-AHCLM.                                 ECSRIRTN
  6304                                                                  ECSRIRTN
  6305     IF RWF-LFCLM NOT = ZEROS                                     ECSRIRTN
  6306         MOVE 'X' TO REIN-LF-FLG (SUB1).                          ECSRIRTN
  6307                                                                  ECSRIRTN
  6308     IF RWF-AHCLM NOT = ZEROS                                     ECSRIRTN
  6309         MOVE 'X' TO REIN-AH-FLG (SUB1).                          ECSRIRTN
  6310                                                                  ECSRIRTN
  6311 REINSURE-CALC-CLAIM-X.                                           ECSRIRTN
  6312                                                                  ECSRIRTN
  6313     IF REIN-LF-AH-FLGS (SUB1) NOT = SPACES                       ECSRIRTN
  6314         MOVE 'X' TO REIN-BUS-FLAG.                               ECSRIRTN
  6315                                                                  ECSRIRTN
  6316     MOVE RWF-FIELDS TO REIN-WORK-FLDS (SUB1).                    ECSRIRTN
  6317                                                                  ECSRIRTN
  6318 REINSURE-SUBTRACT-CLAIM.                                         ECSRIRTN
  6319                                                                  ECSRIRTN
  6320     SUBTRACT REIN-LFCLML (SUB2) FROM RWF-LFCLML.                 ECSRIRTN
  6321     SUBTRACT REIN-AHCLML (SUB2) FROM RWF-AHCLML.                 ECSRIRTN
  6322                                                                  ECSRIRTN
  6323 REINSURE-SUBTRACT-CLAIM-X.                                       ECSRIRTN
  6324     EXIT.                                                        ECSRIRTN
  6325                                                                  ECSRIRTN
  6326 REINSURE-SUB-REM-CLAIM.                                          ECSRIRTN
  6327                                                                  ECSRIRTN
  6328     IF REIN-REM-SW (SUB2) = 'Y' OR 'Z' OR 'X' OR 'N'             ECSRIRTN
  6329         SUBTRACT REIN-AHCLML (SUB2) FROM RWF-AHCLML.             ECSRIRTN
  6330                                                                  ECSRIRTN
  6331 REINSURE-SUB-REM-CLAIM-X.                                        ECSRIRTN
  6332     EXIT.                                                        ECSRIRTN
  6333                                                                  ECSRIRTN
  6334                                                                  ECSRIRTN
  6335 CLEAR-REIN-HOLD.                                                 ECSRIRTN
  6336                                                                  ECSRIRTN
  6337     MOVE SPACES TO REIN-COMP (1).                                ECSRIRTN
  6338     MOVE SPACES TO REIN-LF-AH-FLGS (1).                          ECSRIRTN
  6339     MOVE SPACES TO REIN-REM-SW (1).                              ECSRIRTN
  6340     MOVE SPACES TO REIN-REM-AH-100 (1).                          ECSRIRTN
  6341                                                                  ECSRIRTN
  6342     MOVE +0 TO REIN-LFAMT (1)  REIN-LFPRM (1)  REIN-AHAMT (1)    ECSRIRTN
  6343         REIN-AHPRM (1)  REIN-LFRFND (1)  REIN-AHRFND (1)         ECSRIRTN
  6344         REIN-LFCLM (1)  REIN-AHCLM (1)  REIN-LFCLML (1)          ECSRIRTN
  6345         REIN-AHCLML (1)  REIN-DIS-IBNR (1)  REIN-DIS-PAYCUR (1)  ECSRIRTN
  6346         REIN-DIS-FUTRSV (1)  REIN-DTH-IBNR (1)                   ECSRIRTN
  6347         REIN-DTH-PAYCUR (1)  REIN-DTH-FUTRSV (1)                 ECSRIRTN
  6348         REIN-DIS-IBNRL (1)  REIN-DIS-PAYCURL (1)                 ECSRIRTN
  6349         REIN-DIS-FUTRSVL (1)  REIN-DTH-IBNRL (1)                 ECSRIRTN
  6350         REIN-DTH-PAYCURL (1)  REIN-DTH-FUTRSVL (1)               ECSRIRTN
  6351         REIN-AH-LIMIT (1).                                       ECSRIRTN
  6352                                                                  ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 124
* ECS026.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
  6353     PERFORM CLEAR-REIN-HOLD-ALL VARYING SUB1 FROM 2 BY 1         ECSRIRTN
  6354         UNTIL REIN-COMP (SUB1) = SPACES.                         ECSRIRTN
  6355                                                                  ECSRIRTN
  6356     GO TO CLEAR-REIN-HOLD-X.                                     ECSRIRTN
  6357                                                                  ECSRIRTN
  6358 CLEAR-REIN-HOLD-ALL.                                             ECSRIRTN
  6359                                                                  ECSRIRTN
  6360     MOVE REIN-LEVELS (1) TO REIN-LEVELS (SUB1).                  ECSRIRTN
  6361                                                                  ECSRIRTN
  6362 CLEAR-REIN-HOLD-X.                                               ECSRIRTN
  6363     EXIT.                                                        ECSRIRTN
  6364                                                                  ECSRIRTN
  6365 FLA-SPEC-REIN-CLMS.                                              ECSRIRTN
  6366                                                                  ECSRIRTN
  6367     MOVE +250.00 TO FLA-CLM-REIN-BASE  ADJ-FLA-REIN-BASE.        ECSRIRTN
  6368                                                                  ECSRIRTN
  6369     IF REIN-COMP (SUB1) = '230000'                               ECSRIRTN
  6370         MOVE +100.00 TO FLA-CLM-REIN-BASE  ADJ-FLA-REIN-BASE.    ECSRIRTN
  6371                                                                  ECSRIRTN
  6372     IF CR-AHAMT NOT = ZERO                                       ECSRIRTN
  6373         COMPUTE ADJ-FLA-REIN-BASE ROUNDED =                      ECSRIRTN
  6374             (RW-AHCLMWK / CR-AHAMT) * FLA-CLM-REIN-BASE.         ECSRIRTN
  6375                                                                  ECSRIRTN
  6376     IF REIN-RT-SW = 'X'                                          ECSRIRTN
  6377         MOVE CR-DIS-CC TO CIRD-CC                                ECSRIRTN
  6378         MOVE CR-DIS-YR TO CIRD-YR                                ECSRIRTN
  6379         MOVE CR-DIS-MO TO CIRD-MO                                ECSRIRTN
  6380     ELSE                                                         ECSRIRTN
  6381         MOVE DTO-CC    TO CIRD-CC                                ECSRIRTN
  6382         MOVE DTO-YR    TO CIRD-YR                                ECSRIRTN
  6383         MOVE DTO-MO    TO CIRD-MO.                               ECSRIRTN
  6384                                                                  ECSRIRTN
  6385     MOVE ZEROS TO RWF-AHCLML.                                    ECSRIRTN
  6386                                                                  ECSRIRTN
  6387     IF CLM-INCUR-REIN-DATE LESS '197809'  AND                    ECSRIRTN
  6388        CR-AHAMT GREATER FLA-CLM-REIN-BASE                        ECSRIRTN
  6389         COMPUTE RWF-AHCLML = RW-AHCLMWK - ADJ-FLA-REIN-BASE.     ECSRIRTN
  6390                                                                  ECSRIRTN
  6391     IF CLM-INCUR-REIN-DATE GREATER '197806'                      ECSRIRTN
  6392         COMPUTE RWF-AHCLML = RWF-AHCLML + (RW-AHCLMWK * +.9).    ECSRIRTN
  6393                                                                  ECSRIRTN
  6394 E-FLA-SPEC-REIN-CLMS.                                            ECSRIRTN
  6395     EXIT.                                                        ECSRIRTN
  6396                                                                  ECSRIRTN
  6397 REIN-FIND-CO-LOOP.                                               ECSRIRTN
  6398                                                                  ECSRIRTN
  6399     CONTINUE.                                                    ECSRIRTN
  6400*  DUMMY PARAGRAPH - NO CODE NEEDED.                              ECSRIRTN
  6401 FIND-REI-CO-EXIT.                                                ECSRIRTN
  6402     EXIT.                                                        ECSRIRTN
  6403                                                                  ECSRIRTN
  6404 REIN-CO-TABLE-BUILD.                                             ECSRIRTN
  6405                                                                  ECSRIRTN
  6406     PERFORM ZERO-RCT-ENTRIES THRU ZERO-RCT-EXIT                  ECSRIRTN
  6407         VARYING CO-SUB FROM 1 BY 1                               ECSRIRTN
  6408                   UNTIL CO-SUB GREATER REIN-CO-TABLE-ENT-CNT.    ECSRIRTN
  6409                                                                  ECSRIRTN
  6410     PERFORM ZERO-RC2-ENTRIES THRU ZERO-RC2-EXIT                  ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 125
* ECS026.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
  6411         VARYING CO-SUB FROM 1 BY 1                               ECSRIRTN
  6412                   UNTIL CO-SUB GREATER REIN-CO-TABLE-ENT-CNT.    ECSRIRTN
  6413                                                                  ECSRIRTN
  6414     MOVE LOW-VALUES          TO RE-CONTROL-PRIMARY.              ECSRIRTN
  6415                                                                  ECSRIRTN
  6416     START ERRTBL-IN                                              ECSRIRTN
  6417           KEY IS GREATER THAN RE-CONTROL-PRIMARY                 ECSRIRTN
  6418             INVALID KEY                                          ECSRIRTN
  6419               GO TO REIN-BUILD-EXIT.                             ECSRIRTN
  6420                                                                  ECSRIRTN
  6421     MOVE 0 TO CO-SUB.                                            ECSRIRTN
  6422     MOVE 0 TO SUB1.                                              ECSRIRTN
  6423 REIN-CO-BUILD-LOOP.                                              ECSRIRTN
  6424                                                                  ECSRIRTN
  6425     READ ERRTBL-IN  NEXT RECORD.                                 ECSRIRTN
  6426                                                                  ECSRIRTN
  6427     IF ERRTBL-FILE-STATUS = '10'                                 ECSRIRTN
  6428        GO TO REIN-BUILD-EXIT.                                    ECSRIRTN
  6429                                                                  ECSRIRTN
  6430     IF ERRTBL-FILE-STATUS NOT = ZERO                             ECSRIRTN
  6431        MOVE ERRTBL-FILE-STATUS TO WS-ABEND-FILE-STATUS           ECSRIRTN
  6432        MOVE 'READ ERROR ON FILE - ERRTBL'                        ECSRIRTN
  6433                                  TO WS-ABEND-MESSAGE             ECSRIRTN
  6434        GO TO ABEND-PGM.                                          ECSRIRTN
  6435                                                                  ECSRIRTN
  6436     IF RE-CODE NOT = 'B'                                         ECSRIRTN
  6437        GO TO REIN-CO-BUILD-LOOP.                                 ECSRIRTN
  6438                                                                  ECSRIRTN
  6439     IF RE-CLM-INCURRED-LIM NOT NUMERIC                           ECSRIRTN
  6440        MOVE ZERO TO RE-CLM-INCURRED-LIM.                         ECSRIRTN
  6441                                                                  ECSRIRTN
  6442     IF RE-EARNING-START-DT NOT NUMERIC                           ECSRIRTN
  6443        MOVE ZERO TO RE-EARNING-START-DT.                         ECSRIRTN
  6444                                                                  ECSRIRTN
  6445     IF RE-EARNING-STOP-DT NOT NUMERIC                            ECSRIRTN
  6446        MOVE ZERO TO RE-EARNING-STOP-DT.                          ECSRIRTN
  6447                                                                  ECSRIRTN
  6448     PERFORM VARYING CPSE-NDX FROM 1 BY 1 UNTIL CPSE-NDX > 1500   ECSRIRTN
  6449        MOVE RCT-CLM-CUTOFF-DT (CPSE-NDX)                         ECSRIRTN
*1118-E***************************************                         (   0)**
**    Index-name belongs to different table - unexpected behaviour may occur
  6450                        TO  WS-RCT-CLM-CUTOFF-DT-N (CPSE-NDX)        CL*12
  6451        MOVE RCT-EARNING-START-DT (CPSE-NDX)                      ECSRIRTN
*1118-E******************************************                      ( 125)**
**    Index-name belongs to different table - unexpected behaviour may occur
  6452                        TO  WS-RCT-EARNING-START-DT-N (CPSE-NDX)     CL*12
  6453        MOVE RCT-EARNING-STOP-DT (CPSE-NDX)                       ECSRIRTN
*1118-E*****************************************                       ( 125)**
**    Index-name belongs to different table - unexpected behaviour may occur
  6454                        TO  WS-RCT-EARNING-STOP-DT-N (CPSE-NDX)      CL*12
  6455     END-PERFORM.                                                 ECSRIRTN
  6456     MOVE RWF-EP-STOP-DATE       TO  WS-RWF-EP-STOP-DATE-N.          CL*12
  6457                                                                  ECSRIRTN
  6458     IF RE-LF-CLM-PCT NOT NUMERIC                                 ECSRIRTN
  6459        MOVE ZERO TO RE-LF-CLM-PCT.                               ECSRIRTN
  6460                                                                  ECSRIRTN
  6461     IF RE-AH-CLM-PCT NOT NUMERIC                                 ECSRIRTN
  6462        MOVE ZERO TO RE-AH-CLM-PCT.                               ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 126
* ECS026.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
  6463                                                                  ECSRIRTN
  6464     IF RE-LF-CLM-MAX NOT NUMERIC                                 ECSRIRTN
  6465        MOVE ZERO TO RE-LF-CLM-MAX.                               ECSRIRTN
  6466                                                                  ECSRIRTN
  6467     IF RE-AH-CLM-MAX NOT NUMERIC                                 ECSRIRTN
  6468        MOVE ZERO TO RE-AH-CLM-MAX.                               ECSRIRTN
  6469                                                                  ECSRIRTN
  6470     IF (RE-AH-CLM-MAX = ZERO) AND                                ECSRIRTN
  6471        (RE-LF-CLM-MAX = ZERO) AND                                ECSRIRTN
  6472        (RE-AH-CLM-PCT = ZERO) AND                                ECSRIRTN
  6473        (RE-LF-CLM-PCT = ZERO) AND                                ECSRIRTN
  6474        (RE-CLM-INCURRED-LIM = ZERO) AND                          ECSRIRTN
  6475        (RE-EARNING-START-DT = ZERO) AND                          ECSRIRTN
  6476        (RE-EARNING-STOP-DT = ZERO)                               ECSRIRTN
  6477          GO TO REIN-CO-BUILD-EPR.                                ECSRIRTN
  6478                                                                  ECSRIRTN
  6479     ADD +1 TO CO-SUB.                                            ECSRIRTN
  6480                                                                  ECSRIRTN
  6481     IF CO-SUB GREATER REIN-CO-TABLE-ENT-CNT                      ECSRIRTN
  6482        MOVE 0202 TO WS-RETURN-CODE                               ECSRIRTN
  6483        DISPLAY 'REINSURANCE COMPANY SAVE TABLE EXCEEDED'         ECSRIRTN
  6484        DISPLAY 'ERROR DETECTED IN ECSRIRTN, SEE ECSRITAB'        ECSRIRTN
  6485        MOVE 'REINSURANCE COMPANY SAVE TABLE EXCEEDED'            ECSRIRTN
  6486                                  TO WS-ABEND-MESSAGE             ECSRIRTN
  6487        GO TO ABEND-PGM.                                          ECSRIRTN
  6488                                                                  ECSRIRTN
  6489     MOVE RE-COMPANY           TO RCT-REIN-CO (CO-SUB).              CL**7
  6490                                                                  ECSRIRTN
  6491     MOVE RE-CLM-INCURRED-LIM  TO RCT-CLM-CUTOFF-DT (CO-SUB)      ECSRIRTN
  6492                               WS-RCT-CLM-CUTOFF-DT-N (CO-SUB).      CL*12
  6493     MOVE RE-EARNING-START-DT  TO RCT-EARNING-START-DT (CO-SUB)   ECSRIRTN
  6494                               WS-RCT-EARNING-START-DT-N (CO-SUB).   CL*12
  6495     MOVE RE-EARNING-STOP-DT   TO RCT-EARNING-STOP-DT (CO-SUB)    ECSRIRTN
  6496                               WS-RCT-EARNING-STOP-DT-N (CO-SUB).    CL*12
  6497                                                                  ECSRIRTN
  6498     IF RE-EARN-STOP-CODE = 'A'  OR  'L'                          ECSRIRTN
  6499         MOVE RE-EARN-STOP-CODE  TO RCT-EARN-STOP-CODE (CO-SUB)   ECSRIRTN
  6500     ELSE                                                         ECSRIRTN
  6501         MOVE 'B'                TO RCT-EARN-STOP-CODE (CO-SUB).  ECSRIRTN
  6502                                                                  ECSRIRTN
  6503     MOVE RE-LF-CLM-PCT  TO RCT-LF-CLM-PCT (CO-SUB).              ECSRIRTN
  6504     MOVE RE-AH-CLM-PCT  TO RCT-AH-CLM-PCT (CO-SUB).              ECSRIRTN
  6505     MOVE RE-LF-CLM-MAX  TO RCT-LF-CLM-MAX (CO-SUB).              ECSRIRTN
  6506     MOVE RE-AH-CLM-MAX  TO RCT-AH-CLM-MAX (CO-SUB).              ECSRIRTN
  6507                                                                  ECSRIRTN
  6508 REIN-CO-BUILD-EPR.                                               ECSRIRTN
  6509                                                                  ECSRIRTN
  6510     IF RE-AH-PR-PCT  NOT NUMERIC                                 ECSRIRTN
  6511        MOVE ZERO TO RE-AH-PR-PCT.                                ECSRIRTN
  6512                                                                  ECSRIRTN
  6513     IF RE-AH-78-PCT  NOT NUMERIC                                 ECSRIRTN
  6514        MOVE ZERO TO RE-AH-78-PCT.                                ECSRIRTN
  6515                                                                  ECSRIRTN
  6516     IF RE-LF-PR-PCT  NOT NUMERIC                                 ECSRIRTN
  6517        MOVE ZERO TO RE-LF-PR-PCT.                                ECSRIRTN
  6518                                                                  ECSRIRTN
  6519     IF RE-LF-78-PCT  NOT NUMERIC                                 ECSRIRTN
  6520        MOVE ZERO TO RE-LF-78-PCT.                                ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 127
* ECS026.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
  6521                                                                  ECSRIRTN
  6522     ADD +1 TO SUB1.                                              ECSRIRTN
  6523                                                                  ECSRIRTN
  6524     IF SUB1 GREATER REIN-CO-TABLE-ENT-CNT                        ECSRIRTN
  6525        MOVE 0201 TO WS-RETURN-CODE                               ECSRIRTN
  6526        MOVE 'REINSURANCE COMPANY SAVE TABLE EXCEEDED'            ECSRIRTN
  6527                                  TO WS-ABEND-MESSAGE             ECSRIRTN
  6528        GO TO ABEND-PGM.                                          ECSRIRTN
  6529                                                                  ECSRIRTN
  6530     MOVE RE-COMPANY     TO RC2-REIN-CO    (SUB1).                ECSRIRTN
  6531     MOVE RE-AH-PR-PCT   TO RC2-AH-PRO-PCT (SUB1).                ECSRIRTN
  6532     MOVE RE-AH-78-PCT   TO RC2-AH-R78-PCT (SUB1).                ECSRIRTN
  6533     MOVE RE-LF-PR-PCT   TO RC2-LF-PRO-PCT (SUB1).                ECSRIRTN
  6534     MOVE RE-LF-78-PCT   TO RC2-LF-R78-PCT (SUB1).                ECSRIRTN
  6535     MOVE RE-NAME        TO RC2-CO-NAME    (SUB1).                ECSRIRTN
  6536     if re-state-exhibit-opt-f = 'Y'
  6537        move 'Y'         to rc2-ecs152-rpt (sub1)
  6538     else
  6539        move 'N'         to rc2-ecs152-rpt (sub1)
  6540     end-if
  6541                                                                  ECSRIRTN
  6542     GO TO REIN-CO-BUILD-LOOP.                                    ECSRIRTN
  6543                                                                  ECSRIRTN
  6544 REIN-BUILD-EXIT.                                                 ECSRIRTN
  6545     EXIT.                                                        ECSRIRTN
  6546                                                                  ECSRIRTN
  6547 ZERO-RCT-ENTRIES.                                                ECSRIRTN
  6548                                                                  ECSRIRTN
  6549     MOVE SPACES TO REIN-CO-HOLD-ENTRIES (CO-SUB).                ECSRIRTN
  6550                                                                  ECSRIRTN
  6551     MOVE ZERO   TO RCT-CLM-CUTOFF-DT (CO-SUB)                    ECSRIRTN
  6552                    WS-RCT-CLM-CUTOFF-DT-N (CO-SUB)                  CL*12
  6553                    RCT-EARNING-START-DT (CO-SUB)                 ECSRIRTN
  6554                    WS-RCT-EARNING-START-DT-N (CO-SUB)               CL*12
  6555                    RCT-EARNING-STOP-DT (CO-SUB)                  ECSRIRTN
  6556                    WS-RCT-EARNING-STOP-DT-N (CO-SUB)                CL*12
  6557                    RCT-LF-CLM-PCT    (CO-SUB)                    ECSRIRTN
  6558                    RCT-AH-CLM-PCT    (CO-SUB)                    ECSRIRTN
  6559                    RCT-LF-CLM-MAX    (CO-SUB)                    ECSRIRTN
  6560                    RCT-AH-CLM-MAX    (CO-SUB).                   ECSRIRTN
  6561                                                                  ECSRIRTN
  6562 ZERO-RCT-EXIT.                                                   ECSRIRTN
  6563     EXIT.                                                        ECSRIRTN
  6564                                                                  ECSRIRTN
  6565 ZERO-RC2-ENTRIES.                                                ECSRIRTN
  6566                                                                  ECSRIRTN
  6567     MOVE SPACES TO RC2-CO-NAME (CO-SUB)                          ECSRIRTN
  6568                    RC2-REIN-CO (CO-SUB).                         ECSRIRTN
  6569     move spaces      to rc2-ecs152-rpt (co-sub)
  6570                                                                  ECSRIRTN
  6571     MOVE ZERO   TO RC2-LF-R78-PCT    (CO-SUB)                    ECSRIRTN
  6572                    RC2-LF-PRO-PCT    (CO-SUB)                    ECSRIRTN
  6573                    RC2-AH-R78-PCT    (CO-SUB)                    ECSRIRTN
  6574                    RC2-AH-PRO-PCT    (CO-SUB).                   ECSRIRTN
  6575                                                                  ECSRIRTN
  6576 ZERO-RC2-EXIT.                                                   ECSRIRTN
  6577     EXIT.                                                        ECSRIRTN
  6578******************************************************************ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 128
* ECS026.cbl
  6579
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 129
* ECS026.cbl
  6581 3000-PRODUCE-REPORTS.
  6582     PERFORM 3200-PROCESS-EXTRACTS THRU 3299-EXIT
  6583                                   UNTIL END-OF-EXTR.
  6584
  6585 3099-EXIT.
  6586     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 130
* ECS026.cbl
  6588 3200-PROCESS-EXTRACTS.
  6589     IF EXTR-NEEDED
  6590         PERFORM 9300-READ-SORTED-FILE THRU 9399-EXIT.
  6591
  6592     IF WK-RPT-CODE = 'B' AND SWR-REPORT-CODE-1 = SPACES
  6593         GO TO 3299-EXIT.
  6594
  6595     IF WK-RPT-CODE = 'C' AND SWR-REPORT-CODE-2 = SPACES
  6596         GO TO 3299-EXIT.
  6597
  6598     IF WK-RPT-CODE = 'A'
  6599         MOVE  SWR-CARR          TO  CURR-CARR
  6600         MOVE  SWR-GROUP         TO  CURR-GRP
  6601         MOVE  SWR-STATE         TO  CURR-STATE
  6602         MOVE  SWR-ACCOUNT       TO  CURR-ACCT
  6603     ELSE
  6604     IF WK-RPT-CODE = 'B'
  6605         MOVE  SWR-REPORT-CODE-1 TO CURR-REPORT-CODE-1
  6606     ELSE
  6607     IF WK-RPT-CODE = 'C'
  6608         MOVE  SWR-CARR          TO  CURR-CARR
  6609         MOVE  SWR-GROUP         TO  CURR-GRP
  6610         MOVE  SWR-REPORT-CODE-2 TO  CURR-REPORT-CODE-2.
  6611
  6612     IF FIRST-TIME
  6613         MOVE  'N'               TO  FIRST-TIME-SW
  6614         MOVE  SWR-ACCT-NAME     TO  SAVE-ACCT-NAME
  6615         MOVE  SWR-CARR          TO  PREV-CARR CURR-CARR
  6616         MOVE  SWR-GROUP         TO  PREV-GRP CURR-GRP
  6617         MOVE  SWR-STATE         TO  PREV-STATE CURR-STATE
  6618         MOVE  SWR-ACCOUNT       TO  PREV-ACCT CURR-ACCT
  6619         MOVE  SWR-REPORT-CODE-1 TO  PREV-REPORT-CODE-1
  6620                                     CURR-REPORT-CODE-1
  6621         MOVE  SWR-REPORT-CODE-2 TO  PREV-REPORT-CODE-2
  6622                                     CURR-REPORT-CODE-2.
  6623
  6624     IF WK-RPT-CODE NOT = 'A'
  6625         GO TO 3220-CHECK-REPORT-B.
  6626
  6627     IF SWR-CONTROL = HIGH-VALUES
  6628         PERFORM 3400-ACCT-BREAK  THRU  3499-EXIT
  6629         PERFORM 3500-ST-BREAK    THRU  3599-EXIT
  6630         PERFORM 3600-GROUP-BREAK THRU  3699-EXIT
  6631         PERFORM 3700-CARR-BREAK  THRU  3749-EXIT
  6632         PERFORM 3750-FINAL-BREAK THRU  3799-EXIT
  6633         GO TO 3250-BUILD-CONTROL.
  6634
  6635     IF PREV-CARR NOT = CURR-CARR
  6636         PERFORM 3400-ACCT-BREAK  THRU  3499-EXIT
  6637         PERFORM 3500-ST-BREAK    THRU  3599-EXIT
  6638         PERFORM 3600-GROUP-BREAK THRU  3699-EXIT
  6639         PERFORM 3700-CARR-BREAK  THRU  3749-EXIT
  6640         GO TO 3250-BUILD-CONTROL.
  6641
  6642     IF PREV-GRP NOT = CURR-GRP
  6643         PERFORM 3400-ACCT-BREAK  THRU  3499-EXIT
  6644         PERFORM 3500-ST-BREAK    THRU  3599-EXIT
  6645         PERFORM 3600-GROUP-BREAK THRU  3699-EXIT
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 131
* ECS026.cbl
  6646         GO TO 3250-BUILD-CONTROL.
  6647
  6648     IF PREV-STATE NOT = CURR-STATE
  6649         PERFORM 3400-ACCT-BREAK  THRU  3499-EXIT
  6650         PERFORM 3500-ST-BREAK    THRU  3599-EXIT
  6651         GO TO 3250-BUILD-CONTROL.
  6652
  6653     IF DTE-TOT-OPT = 1 OR 2
  6654       IF PREV-ACCT NOT = CURR-ACCT
  6655           PERFORM 3400-ACCT-BREAK  THRU  3499-EXIT.
  6656
  6657 3220-CHECK-REPORT-B.
  6658     IF WK-RPT-CODE = 'B'
  6659         IF PREV-REPORT-CODE-1 NOT = CURR-REPORT-CODE-1
  6660             PERFORM 3300-REPORT-BREAK THRU 3399-EXIT.
  6661
  6662     IF WK-RPT-CODE = 'C'
  6663         IF PREV-REPORT-CODE-2 NOT = CURR-REPORT-CODE-2 OR
  6664            PREV-CARR          NOT = CURR-CARR          OR
  6665            PREV-GRP           NOT = CURR-GRP
  6666             PERFORM 3300-REPORT-BREAK THRU 3399-EXIT.
  6667
  6668 3250-BUILD-CONTROL.
  6669     IF SWR-CONTROL = HIGH-VALUES
  6670         GO TO 3299-EXIT.
  6671
  6672     PERFORM  3800-ACCUMULATE-FOR-CONTROL  THRU  3899-EXIT.
  6673
  6674     MOVE  'Y'                   TO EXTR-NEEDED-SW.
  6675     MOVE CURR-CARR              TO PREV-CARR.
  6676     MOVE CURR-STATE             TO PREV-STATE.
  6677     MOVE CURR-GRP               TO PREV-GRP.
  6678     MOVE CURR-ACCT              TO PREV-ACCT.
  6679     MOVE SWR-ACCT-NAME          TO SAVE-ACCT-NAME.
  6680     MOVE CURR-REPORT-CODE-1     TO PREV-REPORT-CODE-1.
  6681     MOVE CURR-REPORT-CODE-2     TO PREV-REPORT-CODE-2.
  6682
  6683 3299-EXIT.
  6684     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 132
* ECS026.cbl
  6686 3300-REPORT-BREAK.
  6687     MOVE '1' TO WK-BREAK-TYPE.
  6688
  6689     IF WK-RPT-CODE = 'D'
  6690         PERFORM 3900-ACCUMULATE-FOR-BREAK THRU 3999-EXIT.
  6691
  6692     PERFORM 4000-CREATE-PRINT-TABLE      THRU 4099-EXIT.
  6693     PERFORM 4500-PRINT-A-PAGE            THRU 4599-EXIT.
  6694     PERFORM 6500-CLEAR-ACCUMULATOR-TABLE THRU 6599-EXIT.
  6695     PERFORM 6700-CLEAR-PRINT-TABLE       THRU 6799-EXIT.
  6696
  6697 3399-EXIT.
  6698      EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 133
* ECS026.cbl
  6700 3400-ACCT-BREAK.
  6701     MOVE '1' TO WK-BREAK-TYPE.
  6702     PERFORM 3900-ACCUMULATE-FOR-BREAK THRU 3999-EXIT.
  6703
  6704     IF DTE-TOT-OPT = 1 OR 2
  6705         PERFORM 4000-CREATE-PRINT-TABLE THRU 4099-EXIT
  6706         PERFORM 4500-PRINT-A-PAGE       THRU 4599-EXIT.
  6707
  6708     PERFORM 6500-CLEAR-ACCUMULATOR-TABLE THRU 6599-EXIT.
  6709     PERFORM 6700-CLEAR-PRINT-TABLE       THRU 6799-EXIT.
  6710
  6711 3499-EXIT.
  6712      EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 134
* ECS026.cbl
  6714 3500-ST-BREAK.
  6715     MOVE '2' TO WK-BREAK-TYPE.
  6716     PERFORM 3900-ACCUMULATE-FOR-BREAK    THRU 3999-EXIT.
  6717     PERFORM 4000-CREATE-PRINT-TABLE      THRU 4099-EXIT.
  6718     PERFORM 4500-PRINT-A-PAGE            THRU 4599-EXIT.
  6719     PERFORM 6500-CLEAR-ACCUMULATOR-TABLE THRU 6599-EXIT.
  6720     PERFORM 6700-CLEAR-PRINT-TABLE       THRU 6799-EXIT.
  6721
  6722 3599-EXIT.
  6723      EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 135
* ECS026.cbl
  6725 3600-GROUP-BREAK.
  6726     MOVE '3' TO WK-BREAK-TYPE.
  6727     PERFORM 3900-ACCUMULATE-FOR-BREAK    THRU 3999-EXIT.
  6728     PERFORM 4000-CREATE-PRINT-TABLE      THRU 4099-EXIT.
  6729     PERFORM 4500-PRINT-A-PAGE            THRU 4599-EXIT.
  6730     PERFORM 6500-CLEAR-ACCUMULATOR-TABLE THRU 6599-EXIT.
  6731     PERFORM 6700-CLEAR-PRINT-TABLE       THRU 6799-EXIT.
  6732
  6733 3699-EXIT.
  6734      EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 136
* ECS026.cbl
  6736 3700-CARR-BREAK.
  6737     MOVE '4' TO WK-BREAK-TYPE.
  6738     PERFORM 3900-ACCUMULATE-FOR-BREAK    THRU 3999-EXIT.
  6739     PERFORM 4000-CREATE-PRINT-TABLE      THRU 4099-EXIT.
  6740     PERFORM 4500-PRINT-A-PAGE            THRU 4599-EXIT.
  6741     PERFORM 6500-CLEAR-ACCUMULATOR-TABLE THRU 6599-EXIT.
  6742     PERFORM 6700-CLEAR-PRINT-TABLE       THRU 6799-EXIT.
  6743
  6744 3749-EXIT.
  6745      EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 137
* ECS026.cbl
  6747 3750-FINAL-BREAK.
  6748     MOVE '5' TO WK-BREAK-TYPE.
  6749     PERFORM 4000-CREATE-PRINT-TABLE      THRU 4099-EXIT.
  6750     PERFORM 4500-PRINT-A-PAGE            THRU 4599-EXIT.
  6751     PERFORM 6500-CLEAR-ACCUMULATOR-TABLE THRU 6599-EXIT.
  6752     PERFORM 6700-CLEAR-PRINT-TABLE       THRU 6799-EXIT.
  6753
  6754 3799-EXIT.
  6755      EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 138
* ECS026.cbl
  6757 3800-ACCUMULATE-FOR-CONTROL.
  6758     PERFORM  3830-ACCUM-LOOP  THRU  3839-EXIT
  6759         VARYING  A-SUB1  FROM  1  BY  1
  6760           UNTIL  A-SUB1  GREATER  3
  6761         AFTER  A-SUB2  FROM  1  BY  1
  6762         UNTIL  A-SUB2  GREATER  7.
  6763
  6764     GO TO 3899-EXIT.
  6765
  6766 3830-ACCUM-LOOP.
  6767     MOVE  AT-AMOUNTS (A-SUB1  A-SUB2)
  6768                                 TO  WORK-AREA-FOR-ACCUMULATOR.
  6769
  6770     ADD SWR-FACE-BEN    (A-SUB1  A-SUB2)  TO WA-FACE-BEN.
  6771     ADD SWR-ISS-PRM     (A-SUB1  A-SUB2)  TO WA-ISS-PRM.
  6772     ADD SWR-CNC-PRM     (A-SUB1  A-SUB2)  TO WA-CNC-PRM.
  6773     ADD SWR-EARNED-PRM  (A-SUB1  A-SUB2)  TO WA-EARNED-PRM.
  6774     ADD SWR-CLAIM-AMT   (A-SUB1  A-SUB2)  TO WA-CLAIM-AMT.
  6775     ADD SWR-CERT-COUNT  (A-SUB1  A-SUB2)  TO WA-CERT-COUNT.
  6776     ADD SWR-CLAIM-COUNT (A-SUB1  A-SUB2)  TO WA-CLAIM-COUNT.
  6777     ADD SWR-NUMBER-DAYS (A-SUB1  A-SUB2)  TO WA-NUMBER-DAYS.
  6778     ADD SWR-CRT-W-CLM   (A-SUB1  A-SUB2)  TO WA-CRT-W-CLM.
  6779
  6780     MOVE  WORK-AREA-FOR-ACCUMULATOR
  6781                                 TO  AT-AMOUNTS (A-SUB1  A-SUB2).
  6782
  6783 3839-EXIT.
  6784     EXIT.
  6785
  6786 3899-EXIT.
  6787     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 139
* ECS026.cbl
  6789 3900-ACCUMULATE-FOR-BREAK.
  6790     PERFORM  3930-ACCUM-LOOP  THRU  3939-EXIT
  6791         VARYING  A-SUB1  FROM  1  BY  1
  6792           UNTIL  A-SUB1  GREATER  3
  6793         AFTER  A-SUB2  FROM  1  BY  1
  6794          UNTIL A-SUB2  GREATER  7.
  6795
  6796     GO TO 3999-EXIT.
  6797
  6798 3930-ACCUM-LOOP.
  6799     IF ACCOUNT-BREAK
  6800         ADD AT-FACE-BEN (A-SUB1 A-SUB2)
  6801                               TO  AT2-FACE-BEN (A-SUB1 A-SUB2)
  6802         ADD AT-ISS-PRM (A-SUB1 A-SUB2)
  6803                               TO  AT2-ISS-PRM (A-SUB1 A-SUB2)
  6804         ADD AT-CNC-PRM (A-SUB1 A-SUB2)
  6805                               TO  AT2-CNC-PRM (A-SUB1 A-SUB2)
  6806         ADD AT-EARNED-PRM (A-SUB1 A-SUB2)
  6807                               TO  AT2-EARNED-PRM (A-SUB1 A-SUB2)
  6808         ADD AT-CLAIM-AMT (A-SUB1 A-SUB2)
  6809                               TO  AT2-CLAIM-AMT (A-SUB1 A-SUB2)
  6810         ADD AT-CERT-COUNT (A-SUB1 A-SUB2)
  6811                               TO  AT2-CERT-COUNT (A-SUB1 A-SUB2)
  6812         ADD AT-CLAIM-COUNT (A-SUB1 A-SUB2)
  6813                               TO  AT2-CLAIM-COUNT (A-SUB1 A-SUB2)
  6814         ADD AT-NUMBER-DAYS (A-SUB1 A-SUB2)
  6815                               TO  AT2-NUMBER-DAYS (A-SUB1 A-SUB2)
  6816         ADD AT-CRT-W-CLM (A-SUB1 A-SUB2)
  6817                               TO  AT2-CRT-W-CLM (A-SUB1 A-SUB2)
  6818     ELSE
  6819     IF STATE-BREAK
  6820         ADD AT2-FACE-BEN (A-SUB1 A-SUB2)
  6821                               TO  AT3-FACE-BEN (A-SUB1 A-SUB2)
  6822         ADD AT2-ISS-PRM (A-SUB1 A-SUB2)
  6823                               TO  AT3-ISS-PRM (A-SUB1 A-SUB2)
  6824         ADD AT2-CNC-PRM (A-SUB1 A-SUB2)
  6825                               TO  AT3-CNC-PRM (A-SUB1 A-SUB2)
  6826         ADD AT2-EARNED-PRM (A-SUB1 A-SUB2)
  6827                               TO  AT3-EARNED-PRM (A-SUB1 A-SUB2)
  6828         ADD AT2-CLAIM-AMT (A-SUB1 A-SUB2)
  6829                               TO  AT3-CLAIM-AMT (A-SUB1 A-SUB2)
  6830         ADD AT2-CERT-COUNT (A-SUB1 A-SUB2)
  6831                               TO  AT3-CERT-COUNT (A-SUB1 A-SUB2)
  6832         ADD AT2-CLAIM-COUNT (A-SUB1 A-SUB2)
  6833                               TO  AT3-CLAIM-COUNT (A-SUB1 A-SUB2)
  6834         ADD AT2-NUMBER-DAYS (A-SUB1 A-SUB2)
  6835                               TO  AT3-NUMBER-DAYS (A-SUB1 A-SUB2)
  6836         ADD AT2-CRT-W-CLM (A-SUB1 A-SUB2)
  6837                               TO  AT3-CRT-W-CLM (A-SUB1 A-SUB2)
  6838     ELSE
  6839     IF GROUP-BREAK
  6840         ADD AT3-FACE-BEN (A-SUB1 A-SUB2)
  6841                               TO  AT4-FACE-BEN (A-SUB1 A-SUB2)
  6842         ADD AT3-ISS-PRM (A-SUB1 A-SUB2)
  6843                               TO  AT4-ISS-PRM (A-SUB1 A-SUB2)
  6844         ADD AT3-CNC-PRM (A-SUB1 A-SUB2)
  6845                               TO  AT4-CNC-PRM (A-SUB1 A-SUB2)
  6846         ADD AT3-EARNED-PRM (A-SUB1 A-SUB2)
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 140
* ECS026.cbl
  6847                               TO  AT4-EARNED-PRM (A-SUB1 A-SUB2)
  6848         ADD AT3-CLAIM-AMT (A-SUB1 A-SUB2)
  6849                               TO  AT4-CLAIM-AMT (A-SUB1 A-SUB2)
  6850         ADD AT3-CERT-COUNT (A-SUB1 A-SUB2)
  6851                               TO  AT4-CERT-COUNT (A-SUB1 A-SUB2)
  6852         ADD AT3-CLAIM-COUNT (A-SUB1 A-SUB2)
  6853                               TO  AT4-CLAIM-COUNT (A-SUB1 A-SUB2)
  6854         ADD AT3-NUMBER-DAYS (A-SUB1 A-SUB2)
  6855                               TO  AT4-NUMBER-DAYS (A-SUB1 A-SUB2)
  6856         ADD AT3-CRT-W-CLM (A-SUB1 A-SUB2)
  6857                               TO  AT4-CRT-W-CLM (A-SUB1 A-SUB2)
  6858     ELSE
  6859     IF CARRIER-BREAK
  6860         ADD AT4-FACE-BEN (A-SUB1 A-SUB2)
  6861                               TO  AT5-FACE-BEN (A-SUB1 A-SUB2)
  6862         ADD AT4-ISS-PRM (A-SUB1 A-SUB2)
  6863                               TO  AT5-ISS-PRM (A-SUB1 A-SUB2)
  6864         ADD AT4-CNC-PRM (A-SUB1 A-SUB2)
  6865                               TO  AT5-CNC-PRM (A-SUB1 A-SUB2)
  6866         ADD AT4-EARNED-PRM (A-SUB1 A-SUB2)
  6867                               TO  AT5-EARNED-PRM (A-SUB1 A-SUB2)
  6868         ADD AT4-CLAIM-AMT (A-SUB1 A-SUB2)
  6869                               TO  AT5-CLAIM-AMT (A-SUB1 A-SUB2)
  6870         ADD AT4-CERT-COUNT (A-SUB1 A-SUB2)
  6871                               TO  AT5-CERT-COUNT (A-SUB1 A-SUB2)
  6872         ADD AT4-CLAIM-COUNT (A-SUB1 A-SUB2)
  6873                               TO  AT5-CLAIM-COUNT (A-SUB1 A-SUB2)
  6874         ADD AT4-NUMBER-DAYS (A-SUB1 A-SUB2)
  6875                               TO  AT5-NUMBER-DAYS (A-SUB1 A-SUB2)
  6876         ADD AT4-CRT-W-CLM (A-SUB1 A-SUB2)
  6877                               TO  AT5-CRT-W-CLM (A-SUB1 A-SUB2).
  6878
  6879 3939-EXIT.
  6880     EXIT.
  6881
  6882 3999-EXIT.
  6883     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 141
* ECS026.cbl
  6885 4000-CREATE-PRINT-TABLE.
  6886     PERFORM  4020-CALC-PRINT-TOTALS  THRU  4029-EXIT
  6887         VARYING  A-SUB1  FROM  1  BY  1
  6888           UNTIL  A-SUB1  GREATER  3
  6889         AFTER  A-SUB2  FROM  1  BY  1
  6890          UNTIL A-SUB2  GREATER  7.
  6891
  6892     PERFORM  4050-CALC-PRINT-PRCNTS  THRU  4059-EXIT
  6893         VARYING  P-SUB1  FROM  1  BY  1
  6894           UNTIL  P-SUB1  GREATER  4
  6895         AFTER  P-SUB2  FROM  1  BY  1
  6896          UNTIL P-SUB2  GREATER  8.
  6897
  6898     PERFORM  4080-CALC-PRINT-AVERAGES  THRU  4089-EXIT
  6899         VARYING  P-SUB1  FROM  1  BY  1
  6900           UNTIL  P-SUB1  GREATER  3
  6901         AFTER  P-SUB2  FROM  1  BY  1
  6902          UNTIL P-SUB2  GREATER  8.
  6903
  6904     GO TO 4099-EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 142
* ECS026.cbl
  6906 4020-CALC-PRINT-TOTALS.
  6907     MOVE  A-SUB1                TO  P-SUB1.
  6908     MOVE  A-SUB2                TO  P-SUB2.
  6909
  6910     IF ACCOUNT-BREAK
  6911         MOVE AT-AMOUNTS (A-SUB1 A-SUB2)
  6912                                 TO  WORK-AREA-FOR-ACCUMULATOR
  6913     ELSE
  6914     IF STATE-BREAK
  6915         MOVE AT2-AMOUNTS (A-SUB1 A-SUB2)
  6916                                 TO  WORK-AREA-FOR-ACCUMULATOR
  6917     ELSE
  6918     IF GROUP-BREAK
  6919         MOVE AT3-AMOUNTS (A-SUB1 A-SUB2)
  6920                                 TO  WORK-AREA-FOR-ACCUMULATOR
  6921     ELSE
  6922     IF CARRIER-BREAK
  6923         MOVE AT4-AMOUNTS (A-SUB1 A-SUB2)
  6924                                 TO  WORK-AREA-FOR-ACCUMULATOR
  6925     ELSE
  6926         MOVE AT5-AMOUNTS (A-SUB1 A-SUB2)
  6927                                 TO  WORK-AREA-FOR-ACCUMULATOR.
  6928
  6929     ADD  WA-ISS-PRM         TO  PT-GROSS-PRM (P-SUB1  P-SUB2)
  6930                                 PT-GROSS-PRM (P-SUB1  8)
  6931                                 PT-GROSS-PRM (4  P-SUB2)
  6932                                 PT-GROSS-PRM (4  8).
  6933
  6934     ADD  WA-CNC-PRM         TO  PT-CNC-PRM (P-SUB1  P-SUB2)
  6935                                 PT-CNC-PRM (P-SUB1  8)
  6936                                 PT-CNC-PRM (4  P-SUB2)
  6937                                 PT-CNC-PRM (4  8).
  6938
  6939     ADD  WA-EARNED-PRM      TO  PT-EARNED-PRM (P-SUB1  P-SUB2)
  6940                                 PT-EARNED-PRM (P-SUB1  8)
  6941                                 PT-EARNED-PRM (4  P-SUB2)
  6942                                 PT-EARNED-PRM (4  8).
  6943
  6944     ADD  WA-CLAIM-AMT       TO  PT-CLAIMS (P-SUB1  P-SUB2)
  6945                                 PT-CLAIMS (P-SUB1  8)
  6946                                 PT-CLAIMS (4  P-SUB2)
  6947                                 PT-CLAIMS (4  8).
  6948
  6949     COMPUTE  NET-PREMIUM  = WA-ISS-PRM - WA-CNC-PRM.
  6950
  6951     ADD  NET-PREMIUM        TO  PT-NET-PRM (P-SUB1  P-SUB2)
  6952                                 PT-NET-PRM (P-SUB1  8)
  6953                                 PT-NET-PRM (4  P-SUB2)
  6954                                 PT-NET-PRM (4  8).
  6955
  6956     ADD  WA-FACE-BEN        TO  PT-FACE-BEN (P-SUB1  P-SUB2)
  6957                                 PT-FACE-BEN (P-SUB1  8).
  6958
  6959     ADD  WA-CERT-COUNT      TO  PT-CERT-COUNT (P-SUB1  P-SUB2)
  6960                                 PT-CERT-COUNT (P-SUB1  8).
  6961
  6962     ADD  WA-CLAIM-COUNT     TO  PT-CLAIM-COUNT (P-SUB1  P-SUB2)
  6963                                 PT-CLAIM-COUNT (P-SUB1  8).
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 143
* ECS026.cbl
  6964
  6965     ADD  WA-NUMBER-DAYS     TO  PT-NUMBER-DAYS (P-SUB1  P-SUB2)
  6966                                 PT-NUMBER-DAYS (P-SUB1  8).
  6967
  6968     ADD  WA-CRT-W-CLM       TO  PT-CRT-W-CLM (P-SUB1  P-SUB2)
  6969                                 PT-CRT-W-CLM (P-SUB1  8).
  6970
  6971 4029-EXIT.
  6972     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 144
* ECS026.cbl
  6974 4050-CALC-PRINT-PRCNTS.
  6975     IF  PT-EARNED-PRM (P-SUB1  P-SUB2)  = +0
  6976         MOVE  +0.0          TO  PT-EL-RATIO (P-SUB1  P-SUB2)
  6977     ELSE
  6978         COMPUTE  PT-EL-RATIO (P-SUB1  P-SUB2)  ROUNDED  =
  6979                                PT-CLAIMS (P-SUB1  P-SUB2)  /
  6980                                PT-EARNED-PRM (P-SUB1  P-SUB2).
  6981
  6982     IF  PT-GROSS-PRM (P-SUB1  8)  = +0
  6983         MOVE  +0            TO  PT-PRCNT-PRM (P-SUB1  P-SUB2)
  6984     ELSE
  6985         COMPUTE  PT-PRCNT-PRM (P-SUB1  P-SUB2)  ROUNDED  =
  6986                               PT-GROSS-PRM (P-SUB1  P-SUB2)  /
  6987                               PT-GROSS-PRM (P-SUB1  8).
  6988
  6989     IF  PT-CLAIMS (P-SUB1  8)  = +0
  6990         MOVE  +0            TO  PT-PRCNT-CLAIM (P-SUB1  P-SUB2)
  6991     ELSE
  6992         COMPUTE  PT-PRCNT-CLAIM (P-SUB1  P-SUB2)  ROUNDED  =
  6993                               PT-CLAIMS (P-SUB1  P-SUB2)  /
  6994                               PT-CLAIMS (P-SUB1  8).
  6995
  6996     IF  PT-GROSS-PRM (P-SUB1  P-SUB2)  = +0
  6997         MOVE  +0            TO  PT-PRCNT-CNC-G (P-SUB1  P-SUB2)
  6998     ELSE
  6999         COMPUTE  PT-PRCNT-CNC-G (P-SUB1  P-SUB2)  ROUNDED  =
  7000                               PT-CNC-PRM   (P-SUB1  P-SUB2)  /
  7001                               PT-GROSS-PRM (P-SUB1  P-SUB2).
  7002
  7003 4059-EXIT.
  7004     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 145
* ECS026.cbl
  7006 4080-CALC-PRINT-AVERAGES.
  7007     IF  PT-CERT-COUNT (P-SUB1  P-SUB2)  = +0
  7008         MOVE  +0            TO  PT-AVG-LOAN (P-SUB1  P-SUB2)
  7009     ELSE
  7010         COMPUTE  PT-AVG-LOAN (P-SUB1  P-SUB2)  ROUNDED  =
  7011                              PT-FACE-BEN (P-SUB1  P-SUB2)  /
  7012                              PT-CERT-COUNT (P-SUB1  P-SUB2).
  7013
  7014     IF  PT-CLAIM-COUNT (P-SUB1  P-SUB2)  = +0
  7015         MOVE  +0            TO  PT-AVG-CLAIM (P-SUB1  P-SUB2)
  7016     ELSE
  7017         COMPUTE  PT-AVG-CLAIM (P-SUB1  P-SUB2)  ROUNDED  =
  7018                              PT-CLAIMS (P-SUB1  P-SUB2)  /
  7019                              PT-CLAIM-COUNT (P-SUB1  P-SUB2).
  7020
  7021     IF  PT-CRT-W-CLM (P-SUB1  P-SUB2)  = +0
  7022         MOVE  +0            TO  PT-AVG-DAYS (P-SUB1  P-SUB2)
  7023     ELSE
  7024         COMPUTE  PT-AVG-DAYS (P-SUB1  P-SUB2)  ROUNDED  =
  7025                              PT-NUMBER-DAYS (P-SUB1  P-SUB2)  /
  7026                              PT-CRT-W-CLM (P-SUB1  P-SUB2).
  7027
  7028 4089-EXIT.
  7029     EXIT.
  7030
  7031 4099-EXIT.
  7032     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 146
* ECS026.cbl
  7034 4500-PRINT-A-PAGE.
  7035     PERFORM  7000-HEADING-ROUTINE  THRU  7099-EXIT.
  7036
  7037     PERFORM  4510-PRINT-REPORT-SECTIONS  THRU  4514-EXIT
  7038         VARYING  P-SUB1  FROM  1  BY  1
  7039           UNTIL  P-SUB1  GREATER  4.
  7040
  7041     GO TO 4599-EXIT.
  7042
  7043 4510-PRINT-REPORT-SECTIONS.
  7044     IF P-SUB1 = 1
  7045         MOVE  'SINGLE'          TO  H7-DESC1-7
  7046         MOVE LIFE-OVERRIDE-L12  TO  H7-DESC8-20.
  7047
  7048     IF P-SUB1 = 2
  7049         MOVE  'JOINT'           TO  H7-DESC1-7
  7050         MOVE LIFE-OVERRIDE-L12  TO  H7-DESC8-20.
  7051
  7052     IF P-SUB1 = 3
  7053         MOVE  AH-OVERRIDE-L12   TO  H7-DESC.
  7054
  7055     IF P-SUB1 = 4
  7056         MOVE  'COMBINED TOTALS'  TO  H7-DESC.
  7057
  7058     MOVE  '0'                   TO  X.
  7059     MOVE  HEADING-7             TO  P-DATA.
  7060     PERFORM  7700-PRINT-RTN  THRU  7799-EXIT.
  7061
  7062     MOVE  'GROSS PREMIUM'       TO  DL-DESC.
  7063
  7064     PERFORM  4515-LOAD-GROSS-PRM  THRU  4519-EXIT
  7065         VARYING  P-SUB2  FROM  1  BY  1
  7066           UNTIL  P-SUB2  GREATER 8.
  7067
  7068     MOVE  DETAIL-LINE           TO  P-DATA.
  7069     PERFORM  7700-PRINT-RTN  THRU  7799-EXIT.
  7070
  7071     MOVE  ' '                   TO  X.
  7072     MOVE  'REFUNDS'             TO  DL-DESC.
  7073
  7074     PERFORM  4520-LOAD-CNC-PRM  THRU  4524-EXIT
  7075         VARYING  P-SUB2  FROM  1  BY  1
  7076           UNTIL  P-SUB2  GREATER  8.
  7077
  7078     MOVE  DETAIL-LINE           TO  P-DATA.
  7079     PERFORM  7700-PRINT-RTN  THRU  7799-EXIT.
  7080
  7081     MOVE  'NET PREMIUM'         TO  DL-DESC.
  7082
  7083     PERFORM  4525-LOAD-NET-PRM  THRU  4529-EXIT
  7084         VARYING  P-SUB2  FROM  1  BY  1
  7085           UNTIL  P-SUB2  GREATER 8.
  7086
  7087     MOVE  DETAIL-LINE           TO  P-DATA.
  7088     PERFORM  7700-PRINT-RTN  THRU  7799-EXIT.
  7089
  7090     MOVE  'EARNED PREMIUM'      TO  DL-DESC.
  7091
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 147
* ECS026.cbl
  7092     PERFORM  4530-LOAD-EARNED-PRM  THRU  4534-EXIT
  7093         VARYING  P-SUB2  FROM  1  BY  1
  7094           UNTIL  P-SUB2  GREATER 8.
  7095
  7096     MOVE  DETAIL-LINE           TO  P-DATA.
  7097     PERFORM  7700-PRINT-RTN  THRU  7799-EXIT.
  7098
  7099     MOVE  'CLAIMS PAID'         TO  DL-DESC.
  7100
  7101     PERFORM  4535-LOAD-CLAIMS  THRU  4539-EXIT
  7102         VARYING  P-SUB2  FROM  1  BY  1
  7103           UNTIL  P-SUB2  GREATER 8.
  7104
  7105     MOVE  DETAIL-LINE           TO  P-DATA.
  7106     PERFORM  7700-PRINT-RTN  THRU  7799-EXIT.
  7107
  7108     MOVE  'EARN/LOSS RATIO'     TO  DL-DESC.
  7109
  7110     PERFORM  4540-LOAD-EL-RATIO  THRU  4544-EXIT
  7111         VARYING  P-SUB2  FROM  1  BY  1
  7112           UNTIL  P-SUB2  GREATER 8.
  7113
  7114     MOVE  DETAIL-LINE           TO  P-DATA.
  7115     PERFORM  7700-PRINT-RTN  THRU  7799-EXIT.
  7116
  7117     MOVE  '% PREMIUM BY AGE'    TO  DL-DESC.
  7118
  7119     PERFORM  4545-LOAD-PRCNT-PRM  THRU  4549-EXIT
  7120         VARYING  P-SUB2  FROM  1  BY  1
  7121           UNTIL  P-SUB2  GREATER 8.
  7122
  7123     MOVE  DETAIL-LINE           TO  P-DATA.
  7124     PERFORM  7700-PRINT-RTN  THRU  7799-EXIT.
  7125
  7126     MOVE  '% CLAIMS BY AGE'     TO  DL-DESC.
  7127
  7128     PERFORM  4550-LOAD-PRCNT-CLAIM  THRU  4554-EXIT
  7129         VARYING  P-SUB2  FROM  1  BY  1
  7130           UNTIL  P-SUB2  GREATER 8.
  7131
  7132     MOVE  DETAIL-LINE           TO  P-DATA.
  7133     PERFORM  7700-PRINT-RTN  THRU  7799-EXIT.
  7134
  7135     MOVE  '% REFUNDS TO GROSS'  TO  DL-DESC.
  7136
  7137     PERFORM  4555-LOAD-PRCNT-CNC-G  THRU  4559-EXIT
  7138         VARYING  P-SUB2  FROM  1  BY  1
  7139           UNTIL  P-SUB2  GREATER 8.
  7140
  7141     MOVE  DETAIL-LINE           TO  P-DATA.
  7142     PERFORM  7700-PRINT-RTN  THRU  7799-EXIT.
  7143
  7144     IF P-SUB1 = 4
  7145         GO TO 4514-EXIT.
  7146
  7147     IF P-SUB1 = 1
  7148         MOVE  'AVG INITIAL EXPOSURE'  TO  DL-DESC
  7149         PERFORM  4560-LOAD-AVG-LOAN  THRU  4564-EXIT
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 148
* ECS026.cbl
  7150             VARYING  P-SUB2  FROM  1  BY  1
  7151               UNTIL  P-SUB2  GREATER 8
  7152         MOVE  DETAIL-LINE             TO  P-DATA
  7153         PERFORM  7700-PRINT-RTN  THRU  7799-EXIT.
  7154
  7155     IF P-SUB1 = 1 OR 2
  7156         MOVE  'AVG. CLAIM PAID'  TO  DL-DESC
  7157         PERFORM  4565-LOAD-AVG-CLAIM  THRU  4569-EXIT
  7158             VARYING  P-SUB2  FROM  1  BY  1
  7159               UNTIL  P-SUB2  GREATER 8
  7160         MOVE  DETAIL-LINE        TO  P-DATA
  7161         PERFORM  7700-PRINT-RTN  THRU  7799-EXIT.
  7162
  7163     IF P-SUB1 = 3
  7164         MOVE  'AVG. DAYS INDEMNITY'  TO  DL-DESC
  7165         PERFORM  4570-LOAD-AVG-DAYS  THRU  4574-EXIT
  7166             VARYING  P-SUB2  FROM  1  BY  1
  7167               UNTIL  P-SUB2  GREATER 8
  7168         MOVE  DETAIL-LINE            TO  P-DATA
  7169         PERFORM  7700-PRINT-RTN  THRU  7799-EXIT.
  7170
  7171 4514-EXIT.
  7172     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 149
* ECS026.cbl
  7174 4515-LOAD-GROSS-PRM.
  7175     COMPUTE  ROUND-UP-DOLLARS  ROUNDED  =
  7176              PT-GROSS-PRM (P-SUB1  P-SUB2)  *  1.
  7177
  7178     MOVE  ROUND-UP-DOLLARS      TO  DL-AMT2 (P-SUB2).
  7179
  7180 4519-EXIT.
  7181     EXIT.
  7182
  7183 4520-LOAD-CNC-PRM.
  7184     COMPUTE  PT-CNC-PRM (P-SUB1 P-SUB2)  =
  7185              PT-CNC-PRM (P-SUB1 P-SUB2)  *  -1.
  7186
  7187     COMPUTE  ROUND-UP-DOLLARS  ROUNDED  =
  7188              PT-CNC-PRM (P-SUB1  P-SUB2)  *  1.
  7189
  7190     MOVE  ROUND-UP-DOLLARS      TO  DL-AMT2 (P-SUB2).
  7191
  7192 4524-EXIT.
  7193     EXIT.
  7194
  7195 4525-LOAD-NET-PRM.
  7196     COMPUTE  ROUND-UP-DOLLARS  ROUNDED  =
  7197              PT-NET-PRM (P-SUB1  P-SUB2)  *  1.
  7198
  7199     MOVE  ROUND-UP-DOLLARS      TO  DL-AMT2 (P-SUB2).
  7200
  7201 4529-EXIT.
  7202     EXIT.
  7203
  7204 4530-LOAD-EARNED-PRM.
  7205     COMPUTE  ROUND-UP-DOLLARS  ROUNDED  =
  7206              PT-EARNED-PRM (P-SUB1  P-SUB2)  *  1.
  7207
  7208     MOVE  ROUND-UP-DOLLARS      TO  DL-AMT2 (P-SUB2).
  7209
  7210 4534-EXIT.
  7211     EXIT.
  7212
  7213 4535-LOAD-CLAIMS.
  7214     COMPUTE  ROUND-UP-DOLLARS  ROUNDED  =
  7215              PT-CLAIMS (P-SUB1  P-SUB2)  *  1.
  7216
  7217     MOVE  ROUND-UP-DOLLARS      TO  DL-AMT2 (P-SUB2).
  7218
  7219 4539-EXIT.
  7220     EXIT.
  7221
  7222 4540-LOAD-EL-RATIO.
  7223     COMPUTE  PT-EL-RATIO (P-SUB1  P-SUB2)  =
  7224              PT-EL-RATIO (P-SUB1  P-SUB2)  *  100.
  7225
  7226     MOVE  PT-EL-RATIO (P-SUB1  P-SUB2)
  7227                                 TO  DL-AMT (P-SUB2).
  7228
  7229 4544-EXIT.
  7230     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 150
* ECS026.cbl
  7232 4545-LOAD-PRCNT-PRM.
  7233     COMPUTE  PT-PRCNT-PRM (P-SUB1  P-SUB2)  =
  7234              PT-PRCNT-PRM (P-SUB1  P-SUB2)  *  100.
  7235
  7236     MOVE  PT-PRCNT-PRM (P-SUB1  P-SUB2)
  7237                                 TO  DL-AMT (P-SUB2).
  7238
  7239 4549-EXIT.
  7240     EXIT.
  7241
  7242 4550-LOAD-PRCNT-CLAIM.
  7243     COMPUTE  PT-PRCNT-CLAIM (P-SUB1  P-SUB2)  =
  7244              PT-PRCNT-CLAIM (P-SUB1  P-SUB2)  *  100.
  7245
  7246     MOVE  PT-PRCNT-CLAIM (P-SUB1  P-SUB2)
  7247                                 TO  DL-AMT (P-SUB2).
  7248
  7249 4554-EXIT.
  7250     EXIT.
  7251
  7252 4555-LOAD-PRCNT-CNC-G.
  7253     COMPUTE  PT-PRCNT-CNC-G (P-SUB1  P-SUB2)  =
  7254              PT-PRCNT-CNC-G (P-SUB1  P-SUB2)  *  100.
  7255
  7256     MOVE  PT-PRCNT-CNC-G (P-SUB1  P-SUB2)
  7257                                 TO  DL-AMT (P-SUB2).
  7258
  7259 4559-EXIT.
  7260     EXIT.
  7261
  7262 4560-LOAD-AVG-LOAN.
  7263     COMPUTE  ROUND-UP-DOLLARS ROUNDED  =
  7264              PT-AVG-LOAN (P-SUB1  P-SUB2)  *  1.
  7265
  7266     MOVE  ROUND-UP-DOLLARS      TO  DL-AMT2 (P-SUB2).
  7267
  7268 4564-EXIT.
  7269     EXIT.
  7270
  7271 4565-LOAD-AVG-CLAIM.
  7272     COMPUTE  ROUND-UP-DOLLARS  ROUNDED  =
  7273              PT-AVG-CLAIM (P-SUB1  P-SUB2)  *  1.
  7274
  7275     MOVE  ROUND-UP-DOLLARS      TO  DL-AMT2 (P-SUB2).
  7276
  7277 4569-EXIT.
  7278     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 151
* ECS026.cbl
  7280 4570-LOAD-AVG-DAYS.
  7281     MOVE  PT-AVG-DAYS (P-SUB1  P-SUB2)
  7282                                 TO  DL-AMT1 (P-SUB2).
  7283
  7284 4574-EXIT.
  7285     EXIT.
  7286
  7287 4599-EXIT.
  7288     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 152
* ECS026.cbl
  7290 5000-PRODUCE-D-REPORT.
  7291     PERFORM 9400-READ-REIN-FILE THRU 9499-EXIT.
  7292
  7293     MOVE SWR2-REIN-COMP  TO CURR-REIN-COMP.
  7294     MOVE SWR2-CARR       TO CURR-CARR.
  7295
  7296     IF FIRST-TIME
  7297         MOVE CURR-REIN-COMP   TO PREV-REIN-COMP
  7298         MOVE CURR-CARR        TO PREV-CARR
  7299         MOVE SWR2-REINS-TABLE TO PREV-REINS-TABLE
  7300         MOVE 'N'              TO FIRST-TIME-SW.
  7301
  7302     IF PREV-REIN-COMP NOT = CURR-REIN-COMP
  7303         PERFORM 5300-GET-REINS-NAME THRU 5399-EXIT
  7304         PERFORM 3300-REPORT-BREAK   THRU 3399-EXIT
  7305         PERFORM 3500-ST-BREAK       THRU 3599-EXIT
  7306     ELSE
  7307     IF PREV-CARR NOT = CURR-CARR
  7308         PERFORM 5300-GET-REINS-NAME THRU 5399-EXIT
  7309         PERFORM 3300-REPORT-BREAK   THRU 3399-EXIT.
  7310
  7311     IF END-OF-EXTR
  7312         GO TO 5099-EXIT.
  7313
  7314     PERFORM 5100-ACCUMULATE-FROM-REIN THRU 5199-EXIT.
  7315
  7316     MOVE CURR-REIN-COMP   TO PREV-REIN-COMP.
  7317     MOVE CURR-CARR        TO PREV-CARR.
  7318     MOVE SWR2-REINS-TABLE TO PREV-REINS-TABLE.
  7319
  7320 5099-EXIT.
  7321      EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 153
* ECS026.cbl
  7323
  7324 5100-ACCUMULATE-FROM-REIN.
  7325     IF SWR2-AGE GREATER +60
  7326         MOVE  +7                TO  A-SUB2.
  7327
  7328     IF SWR2-AGE LESS +61
  7329         MOVE  +6                TO  A-SUB2.
  7330
  7331     IF SWR2-AGE LESS +56
  7332         MOVE  +5                TO  A-SUB2.
  7333
  7334     IF SWR2-AGE LESS +51
  7335         MOVE  +4                TO  A-SUB2.
  7336
  7337     IF SWR2-AGE LESS +46
  7338         MOVE  +3                TO  A-SUB2.
  7339
  7340     IF SWR2-AGE LESS +41
  7341         MOVE  +2                TO  A-SUB2.
  7342
  7343     IF SWR2-AGE LESS +31
  7344         MOVE  +1                TO  A-SUB2.
  7345
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 154
* ECS026.cbl
  7347 5110-ACCUMULATE-LIFE.
  7348     IF SWR2-LFTYP = ZERO
  7349         GO TO 5150-ACCUMULATE-AH.
  7350
  7351     IF DTE-PRC-OPT = 5
  7352         IF SWR2-LF-CURRENT-STATUS = '1' OR '2' OR '3' OR
  7353                                     '4' OR '5' OR '9'
  7354         NEXT SENTENCE
  7355        ELSE
  7356         GO TO 5150-ACCUMULATE-AH.
  7357
  7358     MOVE  SWR2-LFTYP            TO  CLAS-LOOK.
  7359
  7360     PERFORM  0900-FIND-LIFE-TYPE  THRU  0950-EXIT.
  7361
  7362     IF CLAS-I-JOINT (CLAS-INDEXL) = 'J'
  7363         MOVE  +2                TO  A-SUB1
  7364     ELSE
  7365         MOVE  +1                TO  A-SUB1.
  7366
  7367     MOVE  AT-AMOUNTS (A-SUB1  A-SUB2)
  7368                                 TO  WORK-AREA-FOR-ACCUMULATOR.
  7369
  7370     IF SWR2-ENTRY-STATUS = '5'
  7371         MOVE  +0                TO  SWR2-LFAMT
  7372                                     SWR2-LFPRM.
  7373
  7374     ADD  SWR2-LFAMT             TO  WA-FACE-BEN.
  7375     ADD  SWR2-LFPRM             TO  WA-ISS-PRM.
  7376     ADD  SWR2-LFRFND            TO  WA-CNC-PRM.
  7377     ADD  SWR2-DTHAMT            TO  WA-CLAIM-AMT.
  7378     ADD  +1                     TO  WA-CERT-COUNT.
  7379     ADD  SWR2-NUM-DTH-CLM       TO  WA-CLAIM-COUNT.
  7380
  7381     MOVE  ZERO                  TO  WA-NUMBER-DAYS.
  7382
  7383     IF SWR2-DTHAMT NOT = ZERO
  7384         ADD  +1                 TO  WA-CRT-W-CLM.
  7385
  7386 5115-ADD-LIFE-EARN.
  7387     MOVE ZEROS           TO  EARNED-PREMIUM.
  7388     MOVE SWR2-LF-EPR-78  TO  LF-EPR-R78.
  7389     MOVE SWR2-LF-EPR-PR  TO  LF-EPR-PRO.
  7390
  7391     IF DTE-CLIENT = 'FIM'
  7392         PERFORM 5500-CHECK-PCT  THRU  5599-EXIT.
  7393
  7394     IF DTE-CLIENT = 'FFL'
  7395         MOVE +.005 TO FAC-1.
  7396
  7397     IF DTE-CLIENT = 'FIM'
  7398         MOVE +.015 TO FAC-1.
  7399
  7400     MOVE FAC-1 TO WS-FAC.
  7401
  7402     IF DTE-CLIENT = 'FIM'
  7403         MOVE FAC-3          TO WS-FAC
  7404         MOVE LF-PRO         TO WS-PRO
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 155
* ECS026.cbl
  7405         MOVE LF-R78         TO WS-R78.
  7406
  7407     IF DTE-CLIENT = 'FIM'
  7408         IF WS-PRO = ZERO  AND  WS-R78 = ZERO
  7409             IF CLAS-I-EP  (CLAS-INDEXL) = 'P'  OR
  7410                STATE-ABBR (CLAS-INDEXS) = 'WY'
  7411                 MOVE +1.00      TO WS-PRO
  7412             ELSE
  7413                 MOVE +1.00      TO WS-R78.
  7414
  7415     IF CLAS-I-EP (CLAS-INDEXL) = 'U'
  7416         MOVE 'R' TO CLAS-I-EP (CLAS-INDEXL).
  7417
  7418     IF DTE-CLIENT = 'FIA'  AND
  7419        SWR2-CARR = 'A' OR 'B'
  7420         COMPUTE EARNED-PREMIUM = (LF-EPR-PRO + LF-EPR-R78) / +2
  7421         GO TO 5115-CONT.
  7422
  7423     IF DTE-CLIENT = 'FIM'
  7424         COMPUTE EARNED-PREMIUM =
  7425              (LF-EPR-PRO * WS-PRO) + (LF-EPR-R78 * WS-R78)
  7426         GO TO 5115-CONT.
  7427
  7428     IF DTE-CLIENT = 'GIC'
  7429         COMPUTE EARNED-PREMIUM =
  7430                  (LF-EPR-PRO * +.80) + (LF-EPR-R78 * +.20)
  7431         GO TO 5115-CONT.
  7432
  7433     IF CLAS-I-EP (CLAS-INDEXL) = '1'
  7434         COMPUTE EARNED-PREMIUM =
  7435                 (LF-EPR-PRO * +.6667) + (LF-EPR-R78 * +.3333)
  7436         GO TO 5115-CONT.
  7437
  7438     IF CLAS-I-EP (CLAS-INDEXL) = 'M'
  7439         COMPUTE EARNED-PREMIUM =
  7440                 (LF-EPR-PRO + LF-EPR-R78) / +2
  7441         GO TO 5115-CONT.
  7442
  7443     IF CLAS-I-EP  (CLAS-INDEXL) = 'P'   OR
  7444        STATE-ABBR (CLAS-INDEXS) = 'WY'  OR
  7445        DTE-CLIENT = 'SLC'
  7446          MOVE LF-EPR-PRO TO EARNED-PREMIUM
  7447          GO TO 5115-CONT.
  7448
  7449     IF CLAS-I-EP (CLAS-INDEXL) = 'R' OR 'T' OR 'N' OR 'A' OR 'B'
  7450         MOVE LF-EPR-R78 TO EARNED-PREMIUM.
  7451
  7452 5115-CONT.
  7453     ADD EARNED-PREMIUM          TO WA-EARNED-PRM.
  7454
  7455     MOVE WORK-AREA-FOR-ACCUMULATOR
  7456                                 TO AT-AMOUNTS (A-SUB1  A-SUB2).
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 156
* ECS026.cbl
  7458 5150-ACCUMULATE-AH.
  7459     IF SWR2-AHTYP = ZERO
  7460         GO TO 5199-EXIT.
  7461
  7462     IF DTE-PRC-OPT = 5
  7463         IF SWR2-AH-CURRENT-STATUS = '1' OR '2' OR '3' OR
  7464                                     '4' OR '5' OR '9'
  7465           NEXT SENTENCE
  7466         ELSE
  7467           GO TO 5199-EXIT.
  7468
  7469     MOVE  +3                    TO  A-SUB1.
  7470     MOVE  AT-AMOUNTS (A-SUB1  A-SUB2)
  7471                                 TO  WORK-AREA-FOR-ACCUMULATOR.
  7472
  7473     IF SWR2-ENTRY-STATUS = '5'
  7474         MOVE +0                 TO  SWR2-AHAMT
  7475                                     SWR2-AHPRM.
  7476
  7477     COMPUTE AH-TOTAL-AMT = SWR2-AHAMT * SWR2-AH-TERM.
  7478
  7479     ADD  AH-TOTAL-AMT           TO  WA-FACE-BEN.
  7480     ADD  SWR2-AHPRM             TO  WA-ISS-PRM.
  7481     ADD  SWR2-AHRFND            TO  WA-CNC-PRM.
  7482     ADD  SWR2-DISAMT            TO  WA-CLAIM-AMT.
  7483     ADD  +1                     TO  WA-CERT-COUNT.
  7484     ADD  SWR2-NUM-DIS-CLM       TO  WA-CLAIM-COUNT.
  7485
  7486     IF SWR2-DISAMT NOT = ZEROS AND
  7487        SWR2-AHAMT  NOT = ZEROS
  7488         COMPUTE PER-DAY-BENEFIT   ROUNDED = SWR2-AHAMT / 30
  7489         COMPUTE NO-DAYS-THIS-CERT ROUNDED = SWR2-DISAMT
  7490                                             / PER-DAY-BENEFIT
  7491         ADD  +1                 TO  WA-CRT-W-CLM
  7492         ADD  NO-DAYS-THIS-CERT  TO  WA-NUMBER-DAYS.
  7493
  7494 5155-ADD-AH-EARN.
  7495     MOVE ZEROS           TO  EARNED-PREMIUM.
  7496     MOVE SWR2-AH-EPR-78  TO  AH-EPR-R78.
  7497     MOVE SWR2-AH-EPR-PR  TO  AH-EPR-PRO.
  7498
  7499     IF DTE-CLIENT = 'FIM'
  7500         PERFORM 5500-CHECK-PCT  THRU  5599-EXIT.
  7501
  7502     IF DTE-CLIENT = 'FFL'
  7503         MOVE ZEROS TO FAC-2.
  7504
  7505     IF DTE-CLIENT = 'FIM'
  7506         MOVE +.025 TO FAC-2.
  7507
  7508     MOVE FAC-2 TO WS-FAC.
  7509
  7510     IF DTE-CLIENT = 'FIM'
  7511         MOVE FAC-4          TO WS-FAC
  7512         MOVE AH-PRO         TO WS-PRO
  7513         MOVE AH-R78         TO WS-R78.
  7514
  7515     IF DTE-CLIENT = 'FIM'
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 157
* ECS026.cbl
  7516         IF WS-PRO = ZERO  AND  WS-R78 = ZERO
  7517            IF CLAS-I-EP  (CLAS-INDEXA) = 'P'  OR
  7518               STATE-ABBR (CLAS-INDEXS) = 'WY'
  7519                 MOVE +1.00      TO WS-PRO
  7520             ELSE
  7521                 MOVE +1.00      TO WS-R78.
  7522
  7523     IF DTE-CLIENT = 'FIA'  AND
  7524        SWR2-CARR = 'A' OR 'B'
  7525          COMPUTE EARNED-PREMIUM = (AH-EPR-PRO + AH-EPR-R78) / +2
  7526          GO TO 5155-CONT.
  7527
  7528     IF DTE-CLIENT = 'FIM'
  7529         COMPUTE EARNED-PREMIUM =
  7530              (AH-EPR-PRO * WS-PRO) + (AH-EPR-R78 * WS-R78)
  7531         GO TO 5155-CONT.
  7532
  7533     IF DTE-CLIENT = 'GIC'
  7534         IF CLAS-I-BAL (CLAS-INDEXA) NOT = 'B'
  7535             COMPUTE EARNED-PREMIUM =
  7536                  (AH-EPR-PRO * +.80) + (AH-EPR-R78 * +.20)
  7537             GO TO 5155-CONT.
  7538
  7539     IF CLAS-I-EP (CLAS-INDEXA) = '1'  OR
  7540        (DTE-CLIENT = 'ITY' AND (SWR2-CARR = '5' OR '7'))
  7541             COMPUTE EARNED-PREMIUM =
  7542            (AH-EPR-PRO * +.6667) + (AH-EPR-R78 * +.3333)
  7543             GO TO 5155-CONT.
  7544
  7545     IF CLAS-I-EP  (CLAS-INDEXA) = 'M'
  7546          COMPUTE EARNED-PREMIUM =
  7547                  (AH-EPR-PRO + AH-EPR-R78) / +2
  7548          GO TO 5155-CONT.
  7549
  7550     IF CLAS-I-EP  (CLAS-INDEXA) = 'P'   OR
  7551        STATE-ABBR (CLAS-INDEXS) = 'WY'  OR
  7552        DTE-CLIENT = 'SLC'               OR
  7553       (DTE-CLIENT = 'ITY' AND SWR2-CARR = '2')
  7554          MOVE AH-EPR-PRO TO EARNED-PREMIUM
  7555          GO TO 5155-CONT.
  7556
  7557     IF CLAS-I-EP (CLAS-INDEXA) = 'R'  OR  'A'
  7558        IF (DTE-CLIENT = 'POS' AND SWR2-CARR = '2')   OR
  7559           (DTE-CLIENT = 'FIM')
  7560              COMPUTE EARNED-PREMIUM =
  7561                  ((AH-EPR-PRO + AH-EPR-R78) / +2)
  7562          ELSE
  7563             MOVE AH-EPR-R78 TO EARNED-PREMIUM.
  7564
  7565 5155-CONT.
  7566     ADD  EARNED-PREMIUM         TO  WA-EARNED-PRM.
  7567
  7568     MOVE  WORK-AREA-FOR-ACCUMULATOR
  7569                             TO  AT-AMOUNTS (A-SUB1  A-SUB2).
  7570
  7571 5199-EXIT.
  7572     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 158
* ECS026.cbl
  7574
  7575 5300-GET-REINS-NAME.
  7576      MOVE 0 TO CO-SUB.
  7577
  7578 5300-GET-NAME-LOOP.
  7579      ADD +1 TO CO-SUB.
  7580      IF PREV-REIN-COMP = RC2-CO-PRIME (CO-SUB)
  7581          MOVE RC2-CO-NAME (CO-SUB) TO SAVE-REIN-NAME
  7582          GO TO 5399-EXIT
  7583      ELSE
  7584      IF RC2-CO-PRIME (CO-SUB) = SPACES
  7585          MOVE SPACES TO SAVE-REIN-NAME
  7586          GO TO 5399-EXIT
  7587      ELSE
  7588          GO TO 5300-GET-NAME-LOOP.
  7589
  7590 5399-EXIT.
  7591     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 159
* ECS026.cbl
  7593 5500-CHECK-PCT.
  7594     IF FIRST-READ
  7595         MOVE ZEROS            TO CO-SUB
  7596                                  LF-PRO LF-R78 AH-PRO AH-R78
  7597         MOVE 'N'              TO FIRST-READ-SW
  7598         GO TO 5500-LOOP.
  7599
  7600     IF SWR2-REIN-COMP = PREV-REIN-COMP
  7601         GO TO 5599-EXIT.
  7602
  7603 5500-LOOP.
  7604      ADD +1 TO CO-SUB.
  7605      IF SWR2-REIN-COMP = RC2-CO-PRIME (CO-SUB)
  7606          MOVE RC2-LF-R78-PCT (CO-SUB) TO LF-R78
  7607          MOVE RC2-LF-PRO-PCT (CO-SUB) TO LF-PRO
  7608          MOVE RC2-AH-R78-PCT (CO-SUB) TO AH-R78
  7609          MOVE RC2-AH-PRO-PCT (CO-SUB) TO AH-PRO
  7610          GO TO 5599-EXIT
  7611      ELSE
  7612      IF RC2-CO-PRIME (CO-SUB) = SPACES
  7613          GO TO 5599-EXIT
  7614      ELSE
  7615          GO TO 5500-LOOP.
  7616
  7617 5599-EXIT.
  7618     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 160
* ECS026.cbl
  7620 6500-CLEAR-ACCUMULATOR-TABLE.
  7621     PERFORM  6530-CLEAR-LOOP  THRU  6539-EXIT
  7622         VARYING  A-SUB2  FROM  1  BY  1
  7623           UNTIL  A-SUB2  GREATER  7.
  7624
  7625     IF ACCOUNT-BREAK
  7626         MOVE AT-AMOUNTS-L-D (1) TO  AT-AMOUNTS-L-D (2)
  7627                                     AT-AMOUNTS-L-D (3)
  7628     ELSE
  7629     IF STATE-BREAK
  7630         MOVE AT2-AMOUNTS-L-D (1) TO  AT2-AMOUNTS-L-D (2)
  7631                                      AT2-AMOUNTS-L-D (3)
  7632     ELSE
  7633     IF GROUP-BREAK
  7634         MOVE AT3-AMOUNTS-L-D (1) TO  AT3-AMOUNTS-L-D (2)
  7635                                      AT3-AMOUNTS-L-D (3)
  7636     ELSE
  7637     IF CARRIER-BREAK
  7638         MOVE AT4-AMOUNTS-L-D (1) TO  AT4-AMOUNTS-L-D (2)
  7639                                      AT4-AMOUNTS-L-D (3)
  7640     ELSE
  7641         MOVE AT5-AMOUNTS-L-D (1) TO  AT5-AMOUNTS-L-D (2)
  7642                                      AT5-AMOUNTS-L-D (3).
  7643
  7644     GO TO 6599-EXIT.
  7645
  7646 6530-CLEAR-LOOP.
  7647     IF ACCOUNT-BREAK
  7648         MOVE +0                 TO  AT-FACE-BEN    (1 A-SUB2)
  7649                                     AT-ISS-PRM     (1 A-SUB2)
  7650                                     AT-CNC-PRM     (1 A-SUB2)
  7651                                     AT-EARNED-PRM  (1 A-SUB2)
  7652                                     AT-CLAIM-AMT   (1 A-SUB2)
  7653                                     AT-CERT-COUNT  (1 A-SUB2)
  7654                                     AT-CLAIM-COUNT (1 A-SUB2)
  7655                                     AT-NUMBER-DAYS (1 A-SUB2)
  7656                                     AT-CRT-W-CLM   (1 A-SUB2)
  7657     ELSE
  7658     IF STATE-BREAK
  7659         MOVE +0                 TO  AT2-FACE-BEN    (1 A-SUB2)
  7660                                     AT2-ISS-PRM     (1 A-SUB2)
  7661                                     AT2-CNC-PRM     (1 A-SUB2)
  7662                                     AT2-EARNED-PRM  (1 A-SUB2)
  7663                                     AT2-CLAIM-AMT   (1 A-SUB2)
  7664                                     AT2-CERT-COUNT  (1 A-SUB2)
  7665                                     AT2-CLAIM-COUNT (1 A-SUB2)
  7666                                     AT2-NUMBER-DAYS (1 A-SUB2)
  7667                                     AT2-CRT-W-CLM   (1 A-SUB2)
  7668     ELSE
  7669     IF GROUP-BREAK
  7670         MOVE +0                 TO  AT3-FACE-BEN    (1 A-SUB2)
  7671                                     AT3-ISS-PRM     (1 A-SUB2)
  7672                                     AT3-CNC-PRM     (1 A-SUB2)
  7673                                     AT3-EARNED-PRM  (1 A-SUB2)
  7674                                     AT3-CLAIM-AMT   (1 A-SUB2)
  7675                                     AT3-CERT-COUNT  (1 A-SUB2)
  7676                                     AT3-CLAIM-COUNT (1 A-SUB2)
  7677                                     AT3-NUMBER-DAYS (1 A-SUB2)
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 161
* ECS026.cbl
  7678                                     AT3-CRT-W-CLM   (1 A-SUB2)
  7679     ELSE
  7680     IF CARRIER-BREAK
  7681         MOVE +0                 TO  AT4-FACE-BEN    (1 A-SUB2)
  7682                                     AT4-ISS-PRM     (1 A-SUB2)
  7683                                     AT4-CNC-PRM     (1 A-SUB2)
  7684                                     AT4-EARNED-PRM  (1 A-SUB2)
  7685                                     AT4-CLAIM-AMT   (1 A-SUB2)
  7686                                     AT4-CERT-COUNT  (1 A-SUB2)
  7687                                     AT4-CLAIM-COUNT (1 A-SUB2)
  7688                                     AT4-NUMBER-DAYS (1 A-SUB2)
  7689                                     AT4-CRT-W-CLM   (1 A-SUB2)
  7690     ELSE
  7691         MOVE +0                 TO  AT5-FACE-BEN    (1 A-SUB2)
  7692                                     AT5-ISS-PRM     (1 A-SUB2)
  7693                                     AT5-CNC-PRM     (1 A-SUB2)
  7694                                     AT5-EARNED-PRM  (1 A-SUB2)
  7695                                     AT5-CLAIM-AMT   (1 A-SUB2)
  7696                                     AT5-CERT-COUNT  (1 A-SUB2)
  7697                                     AT5-CLAIM-COUNT (1 A-SUB2)
  7698                                     AT5-NUMBER-DAYS (1 A-SUB2)
  7699                                     AT5-CRT-W-CLM   (1 A-SUB2).
  7700
  7701 6539-EXIT.
  7702     EXIT.
  7703
  7704 6599-EXIT.
  7705     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 162
* ECS026.cbl
  7707 6700-CLEAR-PRINT-TABLE.
  7708     PERFORM  6730-CLEAR-LOOP  THRU  6739-EXIT
  7709         VARYING  P-SUB2  FROM  1  BY  1
  7710           UNTIL  P-SUB2  GREATER  8.
  7711
  7712     MOVE  PT-AMOUNTS-L-D (1)    TO  PT-AMOUNTS-L-D (2).
  7713     MOVE  PT-AMOUNTS-L-D (1)    TO  PT-AMOUNTS-L-D (3).
  7714     MOVE  PT-AMOUNTS-L-D (1)    TO  PT-AMOUNTS-L-D (4).
  7715
  7716     GO TO 6799-EXIT.
  7717
  7718 6730-CLEAR-LOOP.
  7719     MOVE  +0                    TO  PT-FACE-BEN    (1 P-SUB2)
  7720                                     PT-CERT-COUNT  (1 P-SUB2)
  7721                                     PT-CLAIM-COUNT (1 P-SUB2)
  7722                                     PT-NUMBER-DAYS (1 P-SUB2)
  7723                                     PT-GROSS-PRM   (1 P-SUB2)
  7724                                     PT-CNC-PRM     (1 P-SUB2)
  7725                                     PT-NET-PRM     (1 P-SUB2)
  7726                                     PT-EARNED-PRM  (1 P-SUB2)
  7727                                     PT-CLAIMS      (1 P-SUB2)
  7728                                     PT-EL-RATIO    (1 P-SUB2)
  7729                                     PT-PRCNT-PRM   (1 P-SUB2)
  7730                                     PT-PRCNT-CLAIM (1 P-SUB2)
  7731                                     PT-PRCNT-CNC-G (1 P-SUB2)
  7732                                     PT-AVG-LOAN    (1 P-SUB2)
  7733                                     PT-AVG-CLAIM   (1 P-SUB2)
  7734                                     PT-AVG-DAYS    (1 P-SUB2)
  7735                                     PT-CRT-W-CLM   (1 P-SUB2).
  7736
  7737 6739-EXIT.
  7738     EXIT.
  7739
  7740 6799-EXIT.
  7741     EXIT.
  7742
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 163
* ECS026.cbl
  7744 7000-HEADING-ROUTINE.
  7745     MOVE  WK-RPT-CODE           TO  H1-RPT-CODE.
  7746     MOVE  '1'                   TO  X.
  7747     MOVE  HEADING-1             TO  P-DATA.
  7748     PERFORM  7700-PRINT-RTN  THRU  7799-EXIT.
  7749
  7750     MOVE  ' '                   TO  X.
  7751     MOVE  HEADING-2             TO  P-DATA.
  7752     PERFORM  7700-PRINT-RTN  THRU  7799-EXIT.
  7753
  7754     MOVE  HEADING-3             TO  P-DATA.
  7755     PERFORM  7700-PRINT-RTN  THRU  7799-EXIT.
  7756
  7757     MOVE  SPACES                TO  P-DATA.
  7758     PERFORM  7700-PRINT-RTN  THRU  7799-EXIT.
  7759
  7760     IF WK-RPT-CODE NOT = 'A'
  7761         GO TO 7020-CHECK-REPORT-B.
  7762
  7763     IF WK-BREAK-TYPE = '5'
  7764         MOVE FINAL-HEADING  TO P-DATA
  7765         PERFORM 7700-PRINT-RTN THRU 7799-EXIT
  7766         MOVE SPACES       TO P-DATA
  7767         PERFORM 7700-PRINT-RTN THRU 7799-EXIT 3 TIMES
  7768         GO TO 7099-EXIT.
  7769
  7770     MOVE PREV-CARR        TO CH-CARR-NO
  7771                              CARRIER-L.
  7772     PERFORM 7800-LOAD-CARRIER-NAME THRU 7899-EXIT.
  7773
  7774     MOVE CARRIER-HEADING  TO P-DATA.
  7775     PERFORM 7700-PRINT-RTN THRU 7799-EXIT.
  7776
  7777     IF WK-BREAK-TYPE = '4'
  7778         MOVE SPACES TO P-DATA
  7779         PERFORM 7700-PRINT-RTN THRU 7799-EXIT 3 TIMES
  7780     ELSE
  7781     IF WK-BREAK-TYPE = '3'
  7782         MOVE PREV-GRP      TO GH-GROUP-NO
  7783         MOVE GROUP-HEADING TO P-DATA
  7784         PERFORM 7700-PRINT-RTN THRU 7799-EXIT
  7785         MOVE SPACES        TO P-DATA
  7786         PERFORM 7700-PRINT-RTN THRU 7799-EXIT 2 TIMES
  7787     ELSE
  7788     IF WK-BREAK-TYPE = '2'
  7789         MOVE PREV-GRP      TO GH-GROUP-NO
  7790         MOVE GROUP-HEADING TO P-DATA
  7791         PERFORM 7700-PRINT-RTN THRU 7799-EXIT
  7792         MOVE PREV-STATE    TO SH-STATE-NO  STATE-L
  7793         PERFORM 7900-LOAD-STATE-NAME THRU 7999-EXIT
  7794         MOVE STATE-HEADING TO P-DATA
  7795         PERFORM 7700-PRINT-RTN THRU 7799-EXIT
  7796         MOVE SPACES        TO P-DATA
  7797         PERFORM 7700-PRINT-RTN THRU 7799-EXIT
  7798     ELSE
  7799         MOVE PREV-GRP        TO GH-GROUP-NO
  7800         MOVE GROUP-HEADING   TO P-DATA
  7801         PERFORM 7700-PRINT-RTN THRU 7799-EXIT
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 164
* ECS026.cbl
  7802         MOVE PREV-STATE      TO SH-STATE-NO  STATE-L
  7803         PERFORM 7900-LOAD-STATE-NAME THRU 7999-EXIT
  7804         MOVE STATE-HEADING   TO P-DATA
  7805         PERFORM 7700-PRINT-RTN THRU 7799-EXIT
  7806         MOVE PREV-ACCT       TO AH-ACCT-NO
  7807         MOVE SAVE-ACCT-NAME  TO AH-ACCT-NAME
  7808         MOVE ACCOUNT-HEADING TO P-DATA
  7809         PERFORM 7700-PRINT-RTN THRU 7799-EXIT.
  7810
  7811 7020-CHECK-REPORT-B.
  7812     IF WK-RPT-CODE  = 'B'
  7813         MOVE  CLAS-REPORT-CD1-CAPTION TO RC1H-CAPTION
  7814         MOVE  PREV-REPORT-CODE-1      TO RC1H-CODE
  7815         MOVE  REPORT-CODE-1-HEADING   TO  P-DATA
  7816         PERFORM  7700-PRINT-RTN  THRU  7799-EXIT
  7817         MOVE  SPACES                  TO  P-DATA
  7818         PERFORM  7700-PRINT-RTN  THRU  7799-EXIT 3 TIMES.
  7819
  7820     IF WK-RPT-CODE   = 'C'
  7821         MOVE  PREV-CARR         TO  CH-CARR-NO  CARRIER-L
  7822         PERFORM  7800-LOAD-CARRIER-NAME  THRU  7899-EXIT
  7823         MOVE  CARRIER-HEADING   TO  P-DATA
  7824         PERFORM  7700-PRINT-RTN  THRU  7799-EXIT
  7825         MOVE PREV-GRP           TO GH-GROUP-NO
  7826         MOVE GROUP-HEADING      TO P-DATA
  7827         PERFORM 7700-PRINT-RTN THRU 7799-EXIT
  7828         MOVE  CLAS-REPORT-CD2-CAPTION TO RC2H-CAPTION
  7829         MOVE  PREV-REPORT-CODE-2      TO RC2H-CODE
  7830         MOVE  REPORT-CODE-2-HEADING   TO  P-DATA
  7831         PERFORM  7700-PRINT-RTN  THRU  7799-EXIT
  7832         MOVE  SPACES            TO  P-DATA
  7833         PERFORM  7700-PRINT-RTN  THRU  7799-EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 165
* ECS026.cbl
  7835     IF WK-RPT-CODE   = 'D'
  7836         MOVE PREV-REIN-COMP      TO RH-COMP-NO
  7837         MOVE SAVE-REIN-NAME      TO RH-COMP-NAME
  7838         MOVE REINSURANCE-HEADING TO P-DATA
  7839         PERFORM  7700-PRINT-RTN  THRU  7799-EXIT
  7840       IF WK-BREAK-TYPE = '1'
  7841         MOVE  PREV-CARR         TO  CH-CARR-NO  CARRIER-L
  7842         PERFORM  7800-LOAD-CARRIER-NAME  THRU  7899-EXIT
  7843         MOVE  CARRIER-HEADING   TO  P-DATA
  7844         PERFORM  7700-PRINT-RTN  THRU  7799-EXIT
  7845         MOVE SPACES             TO P-DATA
  7846         PERFORM  7700-PRINT-RTN  THRU  7799-EXIT 2 TIMES
  7847         IF WK-BREAK-TYPE = '2'
  7848           MOVE SPACES             TO P-DATA
  7849           PERFORM  7700-PRINT-RTN  THRU  7799-EXIT 3 TIMES.
  7850
  7851 7099-EXIT.
  7852     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 166
* ECS026.cbl
  7854 7700-PRINT-RTN.
* 7855                             COPY ELCPRT2.
  7856******************************************************************04/15/98
  7857*                                                                *ELCPRT2
  7858*                                                                *ELCPRT2
  7859*                            ELCPRT2                             *   LV005
  7860*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**5
  7861*                            VMOD=2.002                          *   CL**5
  7862*                                                                *   CL**4
  7863******************************************************************   CL**4
  7864                                                                     CL**4
  7865     IF DTE-FICH NOT = SPACE AND                                     CL**4
  7866        FICH-OPEN    = SPACE                                         CL**4
  7867         MOVE 'X'                TO  FICH-OPEN                       CL**4
  7868         OPEN OUTPUT FICH.                                           CL**4
  7869                                                                     CL**4
  7870     IF DTE-FICH NOT = SPACE                                         CL**4
  7871         MOVE X                  TO  P-CTL                           CL**4
  7872         WRITE FICH-REC FROM PRT.                                    CL**4
  7873                                                                     CL**4
  7874     IF DTE-FICH = SPACE OR '2'                                      CL**4
  7875       MOVE X                    TO  P-CTL                           CL**4
  7876       IF P-CTL = ' '                                                CL**4
  7877         WRITE PRT AFTER ADVANCING 1 LINE                            CL**4
  7878       ELSE                                                          CL**4
  7879         IF P-CTL = '0'                                              CL**4
  7880           WRITE PRT AFTER ADVANCING 2 LINES                         CL**4
  7881         ELSE                                                        CL**4
  7882           IF P-CTL = '-'                                            CL**4
  7883             WRITE PRT AFTER ADVANCING 3 LINES                       CL**4
  7884           ELSE                                                      CL**4
  7885             WRITE PRT AFTER ADVANCING PAGE.                         CL**4
  7886                                                                     CL**4
  7887******************************************************************   CL**4
  7888
  7889 7799-EXIT.
  7890     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 167
* ECS026.cbl
  7892 7800-LOAD-CARRIER-NAME.
  7893     MOVE  ALL  '$'              TO  CH-CARR-NA.
  7894
  7895     IF CARRIER-SUB (1)  = SPACE
  7896         GO TO 7899-EXIT.
  7897
  7898     MOVE  +0                    TO  S1.
  7899
  7900 7810-LOAD-CARRIER-LOOP.
  7901     ADD  +1                     TO  S1.
  7902
  7903     IF S1 GREATER  CLAS-MAXCN
  7904         GO TO 7899-EXIT.
  7905
  7906     IF CARRIER-L  = CARRIER-SUB (S1)
  7907         MOVE  CARRIER-PIC (S1)  TO  CH-CARR-NA
  7908         GO TO 7899-EXIT.
  7909
  7910     GO TO 7810-LOAD-CARRIER-LOOP.
  7911
  7912 7899-EXIT.
  7913     EXIT.
  7914
  7915 7900-LOAD-STATE-NAME.
  7916     MOVE  ALL  '$'              TO  SH-STATE-NAME.
  7917     MOVE  ZERO                  TO  CLAS-INDEXS.
  7918
  7919 7920-LOAD-STATE-LOOP.
  7920     ADD  1                      TO  CLAS-INDEXS.
  7921
  7922     IF CLAS-INDEXS  GREATER  CLAS-MAXS
  7923         GO TO 7999-EXIT.
  7924
  7925     IF STATE-L  NOT = STATE-SUB (CLAS-INDEXS)
  7926         GO TO 7920-LOAD-STATE-LOOP.
  7927
  7928     MOVE  STATE-PIC (CLAS-INDEXS)  TO  SH-STATE-NAME.
  7929
  7930 7999-EXIT.
  7931     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 168
* ECS026.cbl
  7933 8000-RELEASE-SORT-WORK.
  7934     MOVE  SORT-WORK-REC         TO  SORT-REC.
  7935
  7936     RELEASE  SORT-REC.
  7937
  7938 8099-EXIT.
  7939     EXIT.
  7940
  7941******************************************************************
  7942***    E A R N E D   P R E M I U M   C A L C U L A T I O N S   ***
  7943******************************************************************
  7944
  7945 8200-EP-BUMP-RTN.
  7946     MOVE CR-LFAMT       TO WE-LFAMT.
  7947     MOVE CR-LFPRM       TO WE-LFPRM.
  7948
  7949     IF CR-LFTYP NOT = ZEROS
  7950         IF (CLAS-I-EP (CLAS-INDEXL) = 'B' OR 'K' OR 'L')
  7951             MOVE CR-LFAMT-ALT        TO WE-LFAMT-ALT
  7952             MOVE CR-LFPRM-ALT        TO WE-LFPRM-ALT
  7953         ELSE
  7954             MOVE ZEROS               TO WE-LFAMT-ALT
  7955                                         WE-LFPRM-ALT.
  7956
  7957     MOVE CR-LFRFND      TO WE-LFRFND.
  7958
  7959     MOVE CR-AHPRM       TO WE-AHPRM.
  7960     MOVE CR-AHAMT       TO WE-AHAMT.
  7961     MOVE CR-AHRFND      TO WE-AHRFND.
  7962
  7963     IF CR-POLICY-IS-RESTORE  OR
  7964        CR-POLICY-IS-REISSUE
  7965         MOVE ZEROS      TO WE-LFAMT  WE-LFAMT-ALT
  7966                            WE-LFPRM  WE-LFPRM-ALT
  7967                            WE-AHAMT  WE-AHPRM.
  7968
  7969 8299-EXIT.
  7970     EXIT.
  7971
  7972 8350-EP-LF-REINSURE.
  7973     MOVE SWR2-LFPRM     TO WE-LFPRM.
  7974     MOVE SWR2-LFAMT     TO WE-LFAMT.
  7975     MOVE +0             TO WE-LFAMT-ALT
  7976                            WE-LFPRM-ALT.
  7977     MOVE SWR2-LFRFND    TO WE-LFRFND.
  7978
  7979     IF SWR2-LF-CURRENT-STATUS = '3' OR '5'
  7980         MOVE ZEROS      TO WE-LFPRM
  7981                            WE-AHPRM.
  7982
  7983 8359-EXIT.
  7984     EXIT.
  7985
  7986 8360-EP-AH-REINSURE.
  7987     MOVE SWR2-AHPRM     TO WE-AHPRM.
  7988     MOVE SWR2-AHAMT     TO WE-AHAMT
  7989     MOVE SWR2-AHRFND    TO WE-AHRFND.
  7990
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 169
* ECS026.cbl
  7991     IF SWR2-AH-CURRENT-STATUS = '3' OR '5'
  7992         MOVE ZEROS      TO WE-LFPRM
  7993                            WE-AHPRM.
  7994
  7995 8369-EXIT.
  7996     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 170
* ECS026.cbl
  7998******************************************************************
  7999***  C A L C U L A T E   L I F E   E A R N E D   P R E M I U M ***
  8000******************************************************************
  8001
  8002 8400-EP-DO-LF.
  8003     MOVE +0                         TO   LF-EPR-R78
  8004                                          LF-EPR-PRO
  8005                                          LF-EPR-ST.
  8006
  8007     MOVE LIFE-OVERRIDE-L1       TO WE-LF-AH.
  8008
  8009     IF CR-LF-STATUS-AT-DEATH NOT = ' '
  8010         COMPUTE LF-EPR-R78 = WE-LFPRM + WE-LFPRM-ALT
  8011         MOVE LF-EPR-R78 TO LF-EPR-PRO LF-EPR-ST.
  8012
  8013     IF CR-LF-STATUS-AT-CANCEL = ' ' AND
  8014         CLAS-I-CALC-TYPE (CLAS-INDEXL) NOT = 'Z'
  8015             GO TO 8430-EP-DO-LF-EP.
  8016
  8017     IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'Z'
  8018         GO TO 8430-EP-DO-LF-EP.
  8019
  8020     COMPUTE LF-EPR-R78 = (WE-LFPRM + WE-LFPRM-ALT) - WE-LFRFND.
  8021     MOVE LF-EPR-R78 TO LF-EPR-PRO LF-EPR-ST.
  8022
  8023     GO TO 8499-EXIT.
  8024
  8025 8430-EP-DO-LF-EP.
  8026     MOVE SPACE                  TO STATUTORY-SWITCH.
  8027
  8028     IF CR-LF-STATUS-AT-DEATH NOT = ' '  AND
  8029        CLAS-I-CALC-TYPE (CLAS-INDEXL) NOT = 'Z'
  8030         GO TO 8499-EXIT.
  8031
  8032     IF REM-TRM1 GREATER CR-LF-TERM
  8033         MOVE +0 TO LF-EPR-R78 LF-EPR-PRO LF-EPR-ST
  8034         GO TO 8499-EXIT.
  8035
  8036     IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'Z'
  8037         GO TO 8480-EP-DO-LF-EP-SUM.
  8038
  8039     IF (CLAS-I-EP (CLAS-INDEXL) = 'B' OR 'K' OR 'L')
  8040         IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'L'
  8041             IF REM-TRM1 NOT GREATER +0
  8042                 COMPUTE LF-EPR-R78 = WE-LFPRM + WE-LFPRM-ALT
  8043                 MOVE LF-EPR-R78 TO LF-EPR-PRO LF-EPR-ST
  8044                 GO TO 8499-EXIT
  8045             ELSE
  8046                 NEXT SENTENCE
  8047         ELSE
  8048             IF (REM-TRM1 + 1) NOT GREATER +0
  8049                 COMPUTE LF-EPR-R78 = WE-LFPRM + WE-LFPRM-ALT
  8050                 MOVE LF-EPR-R78 TO LF-EPR-PRO LF-EPR-ST
  8051                 GO TO 8499-EXIT
  8052             ELSE
  8053                 NEXT SENTENCE
  8054     ELSE
  8055         IF REM-TRM1 NOT GREATER +0  OR
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 171
* ECS026.cbl
  8056            CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'B'
  8057             MOVE WE-LFPRM TO LF-EPR-R78 LF-EPR-PRO LF-EPR-ST
  8058             GO TO 8499-EXIT.
  8059
  8060     IF CLAS-I-EP (CLAS-INDEXL) = 'T'
  8061         GO TO 8440-EP-DO-LF-EP-TEX.
  8062
  8063     IF CLAS-I-EP (CLAS-INDEXL) = 'N'
  8064         GO TO 8450-EP-DO-LF-EP-NP.
  8065
  8066*    IF STATE-ABBR (CLAS-INDEXS) = 'OH'
  8067     IF (STATE-ABBR (CLAS-INDEXS) = 'OH') AND
  8068        (CR-RATING-CLASS NOT = 'L ')
  8069         IF CR-APR     GREATER ZERO   AND
  8070            CR-LF-TERM GREATER 060    AND
  8071            CR-DT      GREATER 19831031
  8072             MOVE '*'             TO STATUTORY-SWITCH
  8073             GO TO 8450-EP-DO-LF-EP-NP.
  8074
  8075     IF STATE-ABBR (CLAS-INDEXS) = 'MT'
  8076         IF CR-APR     GREATER ZERO  AND
  8077            CR-LF-TERM GREATER 061   AND
  8078            CR-DT      GREATER 19830318
  8079             MOVE '*'             TO STATUTORY-SWITCH
  8080             GO TO 8450-EP-DO-LF-EP-NP.
  8081
  8082     IF STATE-ABBR (CLAS-INDEXS) = 'UT'
  8083         IF CR-APR     GREATER ZERO     AND
  8084            CR-LF-TERM GREATER 062      AND
  8085            CR-DT      GREATER 19810831 AND
  8086            CR-DT      LESS    19830901
  8087             MOVE '*'             TO STATUTORY-SWITCH
  8088             GO TO 8450-EP-DO-LF-EP-NP.
  8089
  8090     IF STATE-ABBR (CLAS-INDEXS) = 'RI'
  8091         IF CR-APR     GREATER ZERO  AND
  8092            CR-LF-TERM GREATER 060   AND
  8093            CR-DT      GREATER 19831231
  8094             MOVE '*'             TO STATUTORY-SWITCH
  8095             GO TO 8450-EP-DO-LF-EP-NP.
  8096
  8097     GO TO 8460-EP-DO-LF-EP-R78.
  8098
  8099 8440-EP-DO-LF-EP-TEX.
  8100     COMPUTE TEX-FACT-4 = (CR-LF-TERM  * CR-LF-TERM)
  8101                        + (CR-PMT-FREQ * CR-LF-TERM).
  8102
  8103     DIVIDE REM-TRM1 BY CR-PMT-FREQ
  8104         GIVING TEX-FACT-5   REMAINDER TEX-FACT-6.
  8105
  8106     COMPUTE TEX-FACT-5 = TEX-FACT-5 * CR-PMT-FREQ.
  8107
  8108     COMPUTE TEX-FACT-7 = (TEX-FACT-5 * TEX-FACT-5) +
  8109                          (TEX-FACT-5 * CR-PMT-FREQ) +
  8110                          (2 * (TEX-FACT-6 *
  8111                          (TEX-FACT-5 + CR-PMT-FREQ))).
  8112
  8113     COMPUTE TEX-FACT-8 ROUNDED = TEX-FACT-7 / TEX-FACT-4.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 172
* ECS026.cbl
  8114
  8115     COMPUTE LF-EPR-R78 ROUNDED =
  8116                    WE-LFPRM - (WE-LFPRM * TEX-FACT-8).
  8117
  8118     GO TO 8460-EP-DO-LF-EP-R78.
  8119
  8120 8450-EP-DO-LF-EP-NP.
  8121     IF WE-LFPRM = ZERO
  8122         GO TO 8460-EP-DO-LF-EP-R78.
  8123
  8124     MOVE CR-APR                 TO NP-APR.
  8125     MOVE CR-LF-TERM             TO NP-ORIG  NP-CAP.
  8126     MOVE REM-TRM1               TO NP-REM.
  8127
  8128     MOVE CLAS-I-CALC-TYPE (CLAS-INDEXL) TO NP-OPT.
  8129
  8130     IF NP-OPT = 'T' OR 'U' OR 'V'
  8131         MOVE CR-LOAN-TERM       TO NP-ORIG.
  8132
  8133     MOVE 'R'                    TO NP-OPT.
  8134
  8135     CALL 'ECSNETRM'
  8136         USING NP-APR NP-ORIG NP-REM NP-OPT NP-CAP NP-FACTOR.
  8137
  8138     COMPUTE LF-EPR-R78 ROUNDED =
  8139                     WE-LFPRM - (NP-FACTOR * WE-LFPRM).
  8140
  8141     IF STATUTORY-REQUIREMENT
  8142         MOVE LF-EPR-R78             TO LF-EPR-ST.
  8143
  8144 8460-EP-DO-LF-EP-R78.
  8145     COMPUTE TEMP-1 = CR-LF-TERM * (CR-LF-TERM + 1).
  8146     COMPUTE TEMP-2 = REM-TRM1   * (REM-TRM1 + 1).
  8147
  8148     IF DTE-R78 = '1'
  8149         COMPUTE TEMP-2 = REM-TRM1 * REM-TRM1.
  8150
  8151     COMPUTE TEMP-4 ROUNDED = TEMP-2 / TEMP-1.
  8152
  8153     IF REM-TRM1 GREATER +0
  8154         COMPUTE TEMP-7 ROUNDED =
  8155             WE-LFPRM - (WE-LFPRM * TEMP-4)
  8156     ELSE
  8157         MOVE WE-LFPRM                TO TEMP-7.
  8158
  8159     IF (CLAS-I-EP (CLAS-INDEXL) NOT = 'B' AND 'K' AND 'L')
  8160         MOVE ZEROS                  TO TEMP-8
  8161         GO TO 8465-END-LF-EP-R78.
  8162
  8163     MOVE TEMP-7                     TO LF-EPR-ST.
  8164
  8165     IF CLAS-I-CALC-TYPE (CLAS-INDEXL) NOT = 'L'
  8166         COMPUTE TEMP-1 = (CR-LF-TERM + 1) * (CR-LF-TERM + 2)
  8167         COMPUTE TEMP-2 = (REM-TRM1 + 1) * (REM-TRM1 + 2)
  8168         IF DTE-R78 = '1'
  8169             COMPUTE TEMP-2 = (REM-TRM1 + 1) * (REM-TRM1 + 1).
  8170
  8171     COMPUTE TEMP-4 ROUNDED = TEMP-2 / TEMP-1.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 173
* ECS026.cbl
  8172
  8173     COMPUTE TEMP-8 ROUNDED =
  8174               WE-LFPRM-ALT - (WE-LFPRM-ALT * TEMP-4).
  8175
  8176 8465-END-LF-EP-R78.
  8177     IF LF-EPR-R78 = ZEROS
  8178         COMPUTE LF-EPR-R78 = TEMP-7 + TEMP-8.
  8179
  8180 8470-EP-DO-LF-EP-PRO.
  8181     IF DTE-CLIENT = 'MIC' OR 'MCC'
  8182         COMPUTE TEMP-5 ROUNDED = (REM-TRM1 - .5) / CR-LF-TERM
  8183     ELSE
  8184         COMPUTE TEMP-5 ROUNDED = REM-TRM1 / CR-LF-TERM.
  8185
  8186     IF REM-TRM1 GREATER +0
  8187         COMPUTE TEMP-7 ROUNDED = WE-LFPRM - (WE-LFPRM * TEMP-5)
  8188     ELSE
  8189         MOVE WE-LFPRM                  TO TEMP-7.
  8190
  8191     IF (CLAS-I-EP (CLAS-INDEXL) NOT = 'B' AND 'K' AND 'L')
  8192         MOVE ZEROS                     TO TEMP-8
  8193         GO TO 8475-END-LF-EP-PRO.
  8194
  8195     IF CLAS-I-CALC-TYPE (CLAS-INDEXL) NOT = 'L'
  8196         IF DTE-CLIENT = 'MIC' OR 'MCC'
  8197             COMPUTE TEMP-5 ROUNDED =
  8198                           (REM-TRM1 + .5) / (CR-LF-TERM + 1)
  8199         ELSE
  8200             COMPUTE TEMP-5 ROUNDED =
  8201                           (REM-TRM1 + 1) / (CR-LF-TERM + 1).
  8202
  8203     COMPUTE TEMP-8 ROUNDED =
  8204                   WE-LFPRM-ALT - (WE-LFPRM-ALT * TEMP-5).
  8205
  8206     COMPUTE LF-EPR-ST = LF-EPR-ST + TEMP-8.
  8207
  8208 8475-END-LF-EP-PRO.
  8209     COMPUTE LF-EPR-PRO = TEMP-7 + TEMP-8.
  8210
  8211     GO TO 8485-EP-DO-LF-STATUTORY.
  8212
  8213 8480-EP-DO-LF-EP-SUM.
  8214     IF REM-TRM1 NOT GREATER +0
  8215         COMPUTE LF-EPR-R78 =
  8216                         (WE-LFPRM + WE-LFPRM-ALT) - WE-LFRFND
  8217         MOVE LF-EPR-R78 TO LF-EPR-PRO LF-EPR-ST
  8218         GO TO 8499-EXIT.
  8219
  8220     IF WE-LFPRM + WE-LFPRM-ALT EQUAL ZEROS
  8221        MOVE +.01 TO WE-LFPRM.
  8222
  8223     COMPUTE TEMP-7 ROUNDED = WE-LFPRM - (WE-LFRFND *
  8224                   (WE-LFPRM / (WE-LFPRM + WE-LFPRM-ALT))).
  8225
  8226     IF TEMP-7 NOT GREATER ZERO
  8227         IF (CLAS-I-EP (CLAS-INDEXL) NOT = 'B' AND 'K' AND 'L')
  8228             MOVE ZEROS   TO LF-EPR-R78 LF-EPR-PRO LF-EPR-ST
  8229             GO TO 8499-EXIT
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 174
* ECS026.cbl
  8230         ELSE
  8231             MOVE ZEROS             TO TEMP-7.
  8232
  8233     COMPUTE TEMP-1 = CR-LF-TERM * (CR-LF-TERM + 1).
  8234     COMPUTE TEMP-2 = REM-TRM1 * (REM-TRM1 + 1).
  8235     IF DTE-R78 = '1'
  8236         COMPUTE TEMP-2 = REM-TRM1 * REM-TRM1.
  8237
  8238     COMPUTE TEMP-4 ROUNDED = TEMP-2 / TEMP-1.
  8239     COMPUTE TEMP-5 ROUNDED = REM-TRM1 / CR-LF-TERM.
  8240
  8241     COMPUTE LF-EPR-R78 ROUNDED = TEMP-7 - (TEMP-7 * TEMP-4).
  8242
  8243     COMPUTE LF-EPR-PRO ROUNDED = TEMP-7 - (TEMP-7 * TEMP-5).
  8244
  8245     IF (CLAS-I-EP (CLAS-INDEXL) NOT = 'B' AND 'K' AND 'L')
  8246         GO TO 8485-EP-DO-LF-STATUTORY.
  8247
  8248     MOVE LF-EPR-R78               TO LF-EPR-ST.
  8249
  8250     COMPUTE TEMP-8 ROUNDED = WE-LFPRM-ALT - (WE-LFRFND *
  8251                   (WE-LFPRM-ALT / (WE-LFPRM + WE-LFPRM-ALT))).
  8252
  8253     IF TEMP-8 NOT GREATER ZERO
  8254         GO TO 8485-EP-DO-LF-STATUTORY.
  8255
  8256     COMPUTE LF-EPR-R78 ROUNDED = LF-EPR-R78 +
  8257                              (TEMP-8 - (TEMP-8 * TEMP-4)).
  8258
  8259     COMPUTE LF-EPR-PRO ROUNDED = LF-EPR-PRO +
  8260                              (TEMP-8 - (TEMP-8 * TEMP-5)).
  8261
  8262     COMPUTE LF-EPR-ST ROUNDED = LF-EPR-ST +
  8263                              (TEMP-8 - (TEMP-8 * TEMP-5)).
  8264
  8265 8485-EP-DO-LF-STATUTORY.
  8266     IF LF-EPR-ST NOT = ZEROS
  8267         GO TO 8499-EXIT.
  8268
  8269     IF CLAS-I-RL-AH (CLAS-INDEXL) = 'R'
  8270         MOVE LF-EPR-R78             TO LF-EPR-ST
  8271     ELSE
  8272         MOVE LF-EPR-PRO             TO LF-EPR-ST.
  8273
  8274     IF STATE-ABBR (CLAS-INDEXS) = 'AL'
  8275         MOVE LF-EPR-R78             TO LF-EPR-ST.
  8276
  8277     IF STATE-ABBR (CLAS-INDEXS) = 'WY'
  8278         MOVE LF-EPR-PRO             TO LF-EPR-ST.
  8279
  8280 8499-EXIT.
  8281     EXIT.
  8282
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 175
* ECS026.cbl
  8284******************************************************************
  8285***   C A L C U L A T E   A & H   E A R N E D   P R E M I U M  ***
  8286******************************************************************
  8287
  8288 8600-EP-DO-AH.
  8289     MOVE +0                         TO   AH-EPR-R78
  8290                                          AH-EPR-PRO
  8291                                          AH-EPR-ST.
  8292
  8293     MOVE AH-OVERRIDE-L1       TO WE-LF-AH.
  8294     MOVE CR-AHTYP             TO WE-BEN-TYPE.
  8295
  8296     IF CR-AH-STATUS-AT-SETTLEMENT NOT = ' '
  8297         MOVE WE-AHPRM TO AH-EPR-R78 AH-EPR-PRO AH-EPR-ST.
  8298
  8299     IF CR-AH-STATUS-AT-CANCEL = ' '
  8300         GO TO 8630-EP-DO-AH-EP.
  8301
  8302     COMPUTE AH-EPR-R78 = WE-AHPRM - WE-AHRFND.
  8303     MOVE AH-EPR-R78 TO AH-EPR-PRO AH-EPR-ST.
  8304
  8305     GO TO 8699-EXIT.
  8306
  8307 8630-EP-DO-AH-EP.
  8308     IF CR-AH-STATUS-AT-SETTLEMENT NOT = ' ' AND
  8309        CLAS-I-CALC-TYPE (CLAS-INDEXA) NOT = 'Z'
  8310         GO TO 8699-EXIT.
  8311
  8312     IF REM-TRM1 GREATER CR-AH-TERM
  8313         MOVE +0 TO AH-EPR-R78 AH-EPR-PRO AH-EPR-ST
  8314         GO TO 8699-EXIT.
  8315
  8316     IF CLAS-I-CALC-TYPE (CLAS-INDEXA) = 'Z'
  8317         COMPUTE WE-AHPRM = WE-AHPRM - WE-AHRFND.
  8318
  8319     IF REM-TRM1 NOT GREATER +0
  8320         MOVE WE-AHPRM TO AH-EPR-R78 AH-EPR-PRO AH-EPR-ST
  8321         GO TO 8699-EXIT.
  8322
  8323     IF CLAS-I-CALC-TYPE (CLAS-INDEXA) = 'B'
  8324         MOVE WE-AHPRM TO AH-EPR-R78 AH-EPR-PRO AH-EPR-ST
  8325         GO TO 8699-EXIT.
  8326
  8327     COMPUTE TEMP-1 = CR-AH-TERM * (CR-AH-TERM + 1).
  8328     COMPUTE TEMP-2 = REM-TRM1 * (REM-TRM1 + 1).
  8329     IF DTE-R78 = '1'
  8330         COMPUTE TEMP-2 = REM-TRM1 * REM-TRM1.
  8331     COMPUTE TEMP-4 ROUNDED = TEMP-2 / TEMP-1.
  8332
  8333     IF DTE-CLIENT = 'MIC' OR 'MCC'
  8334         COMPUTE TEMP-5 ROUNDED = (REM-TRM1 - .5) / CR-AH-TERM
  8335     ELSE
  8336         COMPUTE TEMP-5 ROUNDED = REM-TRM1 / CR-AH-TERM.
  8337
  8338     COMPUTE AH-EPR-R78 ROUNDED = WE-AHPRM * TEMP-4.
  8339     COMPUTE AH-EPR-R78 = WE-AHPRM - AH-EPR-R78.
  8340
  8341     COMPUTE AH-EPR-PRO ROUNDED = WE-AHPRM * TEMP-5.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 176
* ECS026.cbl
  8342     COMPUTE AH-EPR-PRO = WE-AHPRM - AH-EPR-PRO.
  8343
  8344 8640-EP-DO-AH-STATUTORY.
  8345     MOVE AH-EPR-R78                 TO AH-EPR-ST.
  8346
  8347 8645-EP-AH-STAT-LOOP.
  8348     IF (STATE-ABBR (CLAS-INDEXS) = 'OH'  AND
  8349         CR-DT GREATER 19831031)  OR
  8350        (STATE-ABBR (CLAS-INDEXS) = 'OK'  AND
  8351         CR-DT GREATER 19820629)  OR
  8352        (STATE-ABBR (CLAS-INDEXS) = 'TX'  AND
  8353         CR-DT GREATER 19830831)
  8354           COMPUTE AH-EPR-ST = (AH-EPR-R78 + AH-EPR-PRO) / 2.
  8355
  8356     IF DTE-CLIENT = 'CSO'  OR  'CID'
  8357        IF STATE-ABBR (CLAS-INDEXS) = 'CO'
  8358          IF CR-DT LESS THAN 19970101
  8359              MOVE AH-EPR-R78        TO AH-EPR-ST
  8360          ELSE
  8361              COMPUTE AH-EPR-ST = (AH-EPR-R78 + AH-EPR-PRO) / 2.
  8362
  8363 8699-EXIT.
  8364     EXIT.
  8365
  8366 8800-REMAINING-TERM-ROUTINE.
  8367     MOVE CR-DT                      TO DC-GREG-DATE-CYMD.
  8368     MOVE 'L'                        TO DC-OPTION-CODE.
  8369     PERFORM 0800-DATE-CONVERT-ROUTINE THRU 0899-EXIT.
  8370     MOVE DC-BIN-DATE-1              TO CP-CERT-EFF-DT.
  8371
  8372     IF CR-LOAN-1ST-PMT-DT NOT NUMERIC
  8373         MOVE ZEROS                  TO CR-LOAN-1ST-PMT-DT.
  8374
  8375     IF CR-LOAN-1ST-PMT-DT NOT = ZEROS
  8376         MOVE CR-LOAN-1ST-PMT-DT     TO DC-GREG-DATE-1-YMD
  8377         MOVE ZEROS                  TO DC-ELAPSED-MONTHS
  8378                                        DC-ELAPSED-DAYS
  8379         MOVE '3'                    TO DC-OPTION-CODE
  8380         PERFORM 0800-DATE-CONVERT-ROUTINE THRU 0899-EXIT
  8381         IF NO-CONVERSION-ERROR
  8382             MOVE DC-BIN-DATE-1      TO CP-FIRST-PAY-DATE
  8383         ELSE
  8384             MOVE ZEROS              TO CR-LOAN-1ST-PMT-DT.
  8385
  8386     IF CR-LOAN-1ST-PMT-DT = ZEROS
  8387         MOVE CP-CERT-EFF-DT         TO DC-BIN-DATE-1
  8388         MOVE +1                     TO DC-ELAPSED-MONTHS
  8389         MOVE ZEROS                  TO DC-ELAPSED-DAYS
  8390         MOVE '6'                    TO DC-OPTION-CODE
  8391         PERFORM 0800-DATE-CONVERT-ROUTINE THRU 0899-EXIT
  8392         MOVE DC-BIN-DATE-1          TO CP-FIRST-PAY-DATE
  8393         MOVE DC-GREG-DATE-1-YMD     TO CR-LOAN-1ST-PMT-DT.
  8394
  8395     MOVE VALUATION-DT               TO DC-GREG-DATE-CYMD.
  8396     MOVE 'L'                        TO DC-OPTION-CODE.
  8397     PERFORM 0800-DATE-CONVERT-ROUTINE THRU 0899-EXIT.
  8398     MOVE DC-BIN-DATE-1              TO CP-VALUATION-DT.
  8399
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 177
* ECS026.cbl
  8400     MOVE SPACES                     TO CP-ACCT-FLD-5.
  8401     MOVE DTE-CLIENT                 TO CP-COMPANY-ID.
  8402     MOVE ORIG-TERM                  TO CP-ORIGINAL-TERM.
  8403     MOVE DTE-REM-TRM                TO CP-REM-TERM-METHOD.
  8404     MOVE DTE-REM-TRM-CALC-OPTION    TO CP-REM-TRM-CALC-OPTION.
  8405     MOVE '3'                        TO CP-PROCESS-TYPE.
  8406     MOVE DTE-CLASIC-COMPANY-CD      TO CP-COMPANY-CD.
  8407
  8408     IF DTE-CLIENT = 'FIM'
  8409         MOVE '5'                    TO CP-REM-TERM-METHOD.
  8410
  8411     IF DTE-CLIENT NOT = 'FLI' AND 'FLU'
  8412         GO TO 8850-GET-REMAINING-TERM.
  8413
  8414     IF WE-LF-AH = AH-OVERRIDE-L1
  8415         MOVE '2'                    TO CP-REM-TERM-METHOD
  8416         GO TO 8850-GET-REMAINING-TERM.
  8417
  8418     IF CR-LFTYP = '01' OR '03'
  8419         MOVE '4'                    TO CP-REM-TERM-METHOD.
  8420
  8421     IF CR-LFTYP = '02' OR '04'
  8422         MOVE '2'                    TO CP-REM-TERM-METHOD.
  8423
  8424 8850-GET-REMAINING-TERM.
  8425     CALL 'ELRTRMX' USING CALCULATION-PASS-AREA.
  8426
  8427     MOVE CP-REMAINING-TERM-1        TO REM-TRM1.
  8428     MOVE CP-REMAINING-TERM-2        TO REM-TRM2.
  8429     MOVE CP-REMAINING-TERM-3        TO REM-TRM3.
  8430     MOVE CP-ODD-DAYS                TO TEM-TRM1.
  8431
  8432 8899-EXIT.
  8433     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 178
* ECS026.cbl
  8435 9000-READ-CERT-IN.
  8436
  8437     READ CERT-IN  AT END
  8438         MOVE  'Y'               TO  CERT-END-SW
  8439         MOVE  HIGH-VALUES       TO  CERTIFICATE-RECORD
  8440         GO TO 9099-EXIT.
  8441
  8442     IF CR-POLICY-IS-DECLINED OR
  8443        CR-POLICY-IS-VOID
  8444             GO TO 9000-READ-CERT-IN.
  8445
* 8446     COPY ELCCRTM1.
  8447******************************************************************04/15/98
  8448*                                                                *ELCCRTM1
  8449*                                                                *ELCCRTM1
  8450*                            ELCCRTM1                            *   LV003
  8451*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
  8452*                            VMOD=2.001                          *ELCCRTM1
  8453*                                                                *ELCCRTM1
  8454*   COPY FILE VARIABLES TO WORKING STORAGE                       *ELCCRTM1
  8455*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCCRTM1
  8456*                                                                *ELCCRTM1
  8457******************************************************************ELCCRTM1
  8458     MOVE CR-DT                   TO  WS-CR-DT-N.                    CL**2
  8459     MOVE CR-LF-EXPIRE-DATE       TO  WS-CR-LF-EXPIRE-DATE-N.        CL**2
  8460     MOVE CR-AH-EXPIRE-DATE       TO  WS-CR-AH-EXPIRE-DATE-N.        CL**2
  8461     MOVE CR-ENTRY-DATE           TO  WS-CR-ENTRY-DATE-N.            CL**2
  8462     MOVE CR-LF-CANC-DT           TO  WS-CR-LF-CANC-DT-N.            CL**2
  8463     MOVE CR-LF-CANCEL-EXIT-DATE  TO  WS-CR-LF-CANCEL-EXIT-DATE-N.   CL**2
  8464     MOVE CR-LF-CLAIM-EXIT-DATE   TO  WS-CR-LF-CLAIM-EXIT-DATE-N.    CL**2
  8465     MOVE CR-AH-CANC-DT           TO  WS-CR-AH-CANC-DT-N.            CL**2
  8466     MOVE CR-AH-CANCEL-EXIT-DATE  TO                                 CL**2
  8467                                  WS-CR-AH-CANCEL-EXIT-DATE-N.       CL**2
  8468     MOVE CR-AH-SETTLEMENT-EXIT-DATE TO                           ELCCRTM1
  8469                                 WS-CR-AH-SETTLEMENT-EXIT-DATEN.     CL**2
  8470     MOVE CR-DTH-DT               TO  WS-CR-DTH-DT-N.                CL**2
  8471     MOVE CR-DTH-PAY-DT           TO  WS-CR-DTH-PAY-DT-N.            CL**2
  8472     MOVE CR-DIS-DT               TO  WS-CR-DIS-DT-N.                CL**2
  8473     MOVE CR-DIS-PAY-DT           TO  WS-CR-DIS-PAY-DT-N.            CL**2
  8474     MOVE CR-DIS-PTO-DT           TO  WS-CR-DIS-PTO-DT-N.            CL**2
  8475     PERFORM  VARYING COPY-NDX FROM 1 BY 1 UNTIL COPY-NDX > 5     ELCCRTM1
  8476           MOVE CR-DIS-INCUR-DT (COPY-NDX)   TO                   ELCCRTM1
  8477                                WS-CR-DIS-INCUR-DT-N (COPY-NDX)      CL**2
  8478     END-PERFORM.                                                 ELCCRTM1
  8479                                                                  ELCCRTM1
  8480
  8481     MOVE CR-CCYY TO CID-CCYY.
  8482     MOVE CR-MO   TO CID-MO.
  8483
  8484     IF DTE-PRC-OPT = 1 OR 2 OR 3 OR 4
  8485         IF CERT-ISSUE-DATE LESS PROCESS-OPT-FROM-DT OR
  8486                         GREATER PROCESS-OPT-THRU-DT
  8487             GO TO 9000-READ-CERT-IN.
  8488
  8489     if cr-lftyp = spaces
  8490        move zeros to cr-lftyp
  8491     end-if
  8492     if cr-ahtyp = spaces
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 179
* ECS026.cbl
  8493        move zeros to cr-ahtyp
  8494     end-if
  8495
  8496     if cr-lfrfnd not numeric
  8497        move zeros               to cr-lfrfnd
  8498     end-if
  8499     if cr-lfrfnd-calc not numeric
  8500        move zeros               to cr-lfrfnd-calc
  8501     end-if
  8502     if cr-dthamt not numeric
  8503        move zeros               to cr-dthamt
  8504     end-if
  8505     if cr-dthamt-ytd not numeric
  8506        move zeros               to cr-dthamt-ytd
  8507     end-if
  8508     if cr-dthamt-last not numeric
  8509        move zeros               to cr-dthamt-last
  8510     end-if
  8511     if cr-dthexp not numeric
  8512        move zeros               to cr-dthexp
  8513     end-if
  8514     if cr-dthexp-ytd not numeric
  8515        move zeros               to cr-dthexp-ytd
  8516     end-if
  8517
  8518     if cr-ahrfnd not numeric
  8519        move zeros               to cr-ahrfnd
  8520     end-if
  8521     if cr-ahrfnd-calc not numeric
  8522        move zeros               to cr-ahrfnd-calc
  8523     end-if
  8524     if cr-disamt not numeric
  8525        move zeros               to cr-disamt
  8526     end-if
  8527     if cr-disamt-ytd not numeric
  8528        move zeros               to cr-disamt-ytd
  8529     end-if
  8530     if cr-disamt-last not numeric
  8531        move zeros               to cr-disamt-last
  8532     end-if
  8533     if cr-disexp not numeric
  8534        move zeros               to cr-disexp
  8535     end-if
  8536
  8537     .
  8538 9099-EXIT.
  8539     EXIT.
  8540
  8541 9200-READ-ACCT-IN.
  8542     READ ACCT-IN.
  8543
  8544     IF ERACCT-FILE-STATUS = '10'
  8545         MOVE  'Y'               TO  ACCT-END-SW
  8546         MOVE  HIGH-VALUES       TO  ACCOUNT-MASTER
  8547         GO TO 9299-EXIT.
  8548
  8549     IF ERACCT-FILE-STATUS NOT = ZERO
  8550         MOVE 'ERROR OCCURED READ - ERACCTT'  TO  WS-ABEND-MESSAGE
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 180
* ECS026.cbl
  8551         MOVE ERACCT-FILE-STATUS  TO  WS-ABEND-FILE-STATUS
  8552         GO TO ABEND-PGM.
  8553
  8554 9299-EXIT.
  8555     EXIT.
  8556
  8557 9300-READ-SORTED-FILE.
  8558     READ TEMP-WORK INTO SORT-WORK-REC   AT END
  8559         MOVE  'Y'               TO  EXTR-END-SW
  8560         MOVE  HIGH-VALUES       TO  SORT-WORK-REC.
  8561
  8562 9399-EXIT.
  8563     EXIT.
  8564
  8565 9400-READ-REIN-FILE.
  8566     READ REIN-WORK INTO SORT-WORK-REC-2  AT END
  8567         MOVE  'Y'               TO  EXTR-END-SW
  8568         MOVE  HIGH-VALUES       TO  SORT-WORK-REC-2.
  8569
  8570 9499-EXIT.
  8571     EXIT.
  8572
  8573 ABEND-PGM SECTION.
* 8574                                 COPY ELCABEND.
  8575***************************************************************** 04/14/98
  8576*                                                               * ELCABEND
  8577*                            ELCABEND.                          *    LV003
  8578*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
  8579*                            VMOD 2.002                              CL**2
  8580*                                                               * ELCABEND
  8581*                THIS SECTION DISPLAYS THE NECESSARY MESSAGES   * ELCABEND
  8582*            AND THEN ABENDS.                                   * ELCABEND
  8583*                                                               * ELCABEND
  8584*  NO  CID  MODS  IN  COPYBOOK  ELCABEND                        * ELCABEND
  8585*                                                               * ELCABEND
  8586***************************************************************** ELCABEND
  8587*APS-010.                                                         ELCABEND
  8588     DISPLAY WS-ABEND-MESSAGE.                                    ELCABEND
  8589     DISPLAY WS-ABEND-MESSAGE UPON CONSOLE.                       ELCABEND
  8590                                                                  ELCABEND
  8591     IF WS-ABEND-FILE-STATUS NOT = ZERO                           ELCABEND
  8592         DISPLAY 'FILE STATUS = ' WS-ABEND-FILE-STATUS            ELCABEND
  8593         DISPLAY 'FILE STATUS = ' WS-ABEND-FILE-STATUS            ELCABEND
  8594                                 UPON CONSOLE.                    ELCABEND
  8595                                                                  ELCABEND
  8596     IF WS-RETURN-CODE NOT = ZERO                                 ELCABEND
  8597         DISPLAY 'RETURN CODE = '  WS-RETURN-CODE                 ELCABEND
  8598         DISPLAY 'RETURN CODE = '  WS-RETURN-CODE                 ELCABEND
  8599                                 UPON CONSOLE.                    ELCABEND
  8600                                                                  ELCABEND
  8601     DISPLAY 'PROGRAM WILL NOW ABEND **************'              ELCABEND
  8602     DISPLAY 'PROGRAM WILL NOW ABEND **************'              ELCABEND
  8603                                 UPON CONSOLE.                    ELCABEND
  8604                                                                  ELCABEND
  8605     DIVIDE WS-ZERO BY WS-ZERO GIVING WS-ZERO.                    ELCABEND
  8606     CALL 'ABORTME'.
  8607                                                                  ELCABEND
  8608 APS-EXIT.                                                        ELCABEND
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 181
* ECS026.cbl
  8609     EXIT.                                                        ELCABEND
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Last message on page:  125
* Total Messages:     3
* Unrecoverable :     0                    Severe  :     0
* Errors        :     3                    Warnings:     0
* Informational :     0                    Flags   :     0
* Data:      288716     Code:       44148
