* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   1
* EL539.cbl
* Options: int("EL539.int") anim csi verbose NOBOUND PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("EL539.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"ebmlsfile" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" NOCHECKDIV NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"32" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL539.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL539.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR NOSTICKY-LINKAGE
*          NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"2" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                 EL539 .
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 02/12/96 16:38:04.
     7*            PROGRAM REVIEWED FOR YEAR 2000 COMPLIANCE
     8*                            VMOD=2.015.
     9
    10*AUTHOR.        LOGIC, INC.
    11*               DALLAS, TEXAS.
    12
    13*DATE-COMPILED.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   2
* EL539.cbl
    14
    15*SECURITY.   *****************************************************
    16*            *                                                   *
    17*            *   THIS PROGRAM IS THE PROPERTY OF LOGIC, INC.     *
    18*            *                                                   *
    19*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
    20*            *   OF LOGIC, INC. IS EXPRESSLY PROHIBITED WITHOUT  *
    21*            *   THE PRIOR WRITTEN PERMISSION OF LOGIC INC.      *
    22*            *                                                   *
    23*            *****************************************************
    24
    25*REMARKS.
    26*        GENERATES, SORTS AND PRINTS PENETRATION REPORT.
    27******************************************************************
    28*                   C H A N G E   L O G
    29*
    30* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    31*-----------------------------------------------------------------
    32*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    33* EFFECTIVE    NUMBER
    34*-----------------------------------------------------------------
    35* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
    36* 022804                   SMVA  HANDLE FILE STATUS 23 ON ERLOFC
    37* 052104   2004050500004   PEMA  USE CURRENT ACCT DT RANGE
    38* 092905 CR2005080300007   PEMA  ADD DISCLAIMER TO ACCOUNT SUMMARY
    39* 110105   2005071200004   PEMA  INCREASE SIZE OF LOAN OFFICER
    40* 011606 IR2006120700003   PEMA  CORRECT PAGE BREAK FOR DISCLAIMER
    41* 051906                   PEMA  FIX LOW-VALUES IN LOAD OFFICER
    42* 010809 CR2008111300002   PEMA  CHANGE WORDING
    43* 051810 CR2010042900001   PEMA  SPEARATE CITY AND STATE
    44* 092310 CR2010011200002   PEMA  CHG TO USE CURRENT ACCT DT RANGE
    45* 121010 CR2010101900001   PEMA  ADD MESSAGE FOR UNASSIGNED
    46******************************************************************
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   3
* EL539.cbl
    48 ENVIRONMENT DIVISION.
    49 CONFIGURATION SECTION.
    50 INPUT-OUTPUT SECTION.
    51 FILE-CONTROL.
    52
    53     SELECT SORT-WORK    ASSIGN SYS001-UT-FBA1-S-SORTWK1.
    54
    55     SELECT PRINT-FILE   ASSIGN SYS008-UR-1403-S-SYS008.
    56
    57     SELECT EXTRACT-INTERFACE-FILE
    58                         ASSIGN SYS010-UT-2400-S-SYS010.
    59
    60     SELECT DISK-DATE    ASSIGN SYS019-UT-FBA1-SYS019.
    61
    62     SELECT FICH         ASSIGN SYS020-UT-2400-S-SYS020.
    63
    64     SELECT ELREPT       ASSIGN SYS021-FBA1-ELREPT
    65                         ORGANIZATION IS INDEXED
    66                         ACCESS IS DYNAMIC
    67                         RECORD KEY IS RF-CONTROL-PRIMARY
    68                         FILE STATUS IS DTE-VSAM-FLAGS.
    69
    70     SELECT ERACCT       ASSIGN SYS022-FBA1-ERACCT
    71                         ORGANIZATION IS INDEXED
    72                         ACCESS IS DYNAMIC
    73                         RECORD KEY IS AM-CONTROL-PRIMARY
    74                         FILE STATUS IS AM-FILE-STATUS.
    75
    76     SELECT ERLOFC       ASSIGN SYS023-FBA1-ERLOFC
    77                         ORGANIZATION IS INDEXED
    78                         ACCESS IS DYNAMIC
    79                         RECORD KEY IS LO-CONTROL-PRIMARY
    80                         FILE STATUS IS LO-STATUS.
    81
    82     SELECT ERPNDB       ASSIGN SYS024-FBA1-ERPNDB2
    83                         ORGANIZATION IS INDEXED
    84                         ACCESS IS DYNAMIC
    85                         RECORD KEY IS PB-CONTROL-BY-ACCT
    86                         FILE STATUS IS PB-STATUS.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   4
* EL539.cbl
    88 DATA DIVISION.
    89 FILE SECTION.
    90
    91 SD  SORT-WORK.
    92
    93 01  SORT-RECORD.
    94     12  SORT-CTL.
    95         16  SC-ACCT-INFO.
    96             20  SC-CO       PIC  X(01).
    97             20  SC-CARR     PIC  X(01).
    98             20  SC-GRP      PIC  X(06).
    99             20  SC-ST       PIC  X(02).
   100             20  SC-ACCT     PIC  X(10).
   101         16  SC-LNOFF        PIC  X(05).
   102         16  SC-EFFDT        PIC  X(06).
   103         16  SC-CERT         PIC  X(11).
   104     12  SORT-DTA            PIC  X(82).
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   5
* EL539.cbl
   106 FD  PRINT-FILE
*  107                         COPY ELCPRTFD.
   108******************************************************************04/15/98
   109*                                                                *ELCPRTFD
   110*                                                                *ELCPRTFD
   111*                            ELCPRTFD.                           *   LV003
   112*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
   113*                            VMOD=2.006                          *ELCPRTFD
   114******************************************************************ELCPRTFD
   115     RECORDING MODE F                                             ELCPRTFD
   116     LABEL RECORDS OMITTED                                        ELCPRTFD
   117     BLOCK CONTAINS 0 RECORDS
   118     RECORD CONTAINS 133 CHARACTERS.                              ELCPRTFD
   119 01  PRT.                                                         ELCPRTFD
   120     12  P-CTL               PIC  X.                                 CL**2
   121     12  P-DATA              PIC  X(132).                         ELCPRTFD
   122******************************************************************ELCPRTFD
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   6
* EL539.cbl
   124 FD  EXTRACT-INTERFACE-FILE
*  125                         COPY ERCEXTFD.
   126******************************************************************04/29/98
   127*                                                                *ERCEXTFD
   128*                                                                *ERCEXTFD
   129*                            ERCEXTFD.                           *   LV002
   130*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
   131*                            VMOD=2.002                          *   CL**2
   132*                                                                *ERCEXTFD
   133******************************************************************ERCEXTFD
   134                                                                  ERCEXTFD
   135     RECORDING MODE F                                             ERCEXTFD
   136     LABEL RECORDS STANDARD                                       ERCEXTFD
   137     BLOCK CONTAINS 0 RECORDS
   138     RECORD CONTAINS 629 CHARACTERS.                              ERCEXTFD
   139
   140 01  EXTRACT-INTERFACE-FILE-RECORD   PIC  X(629).
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   7
* EL539.cbl
   142 FD  DISK-DATE
*  143                         COPY ELCDTEFD.
   144******************************************************************04/15/98
   145*                                                                *ELCDTEFD
   146*                                                                *ELCDTEFD
   147*                            ELCDTEFD.                           *   LV002
   148*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
   149*                            VMOD=2.007                          *   CL**2
   150*                                                                *ELCDTEFD
   151******************************************************************ELCDTEFD
   152     BLOCK CONTAINS 0 RECORDS
   153     RECORDING MODE F.                                            ELCDTEFD
   154                                                                  ELCDTEFD
   155 01  DATE-DISK.                                                   ELCDTEFD
   156     12  DD-ID                       PIC  X(4).                   ELCDTEFD
   157     12  FILLER                      PIC  X(14).                  ELCDTEFD
   158     12  DD-CR1                      PIC  9.                      ELCDTEFD
   159     12  DD-CR1N                     PIC  X(30).                  ELCDTEFD
   160     12  DD-CR2                      PIC  9.                      ELCDTEFD
   161     12  DD-CR2N                     PIC  X(30).                  ELCDTEFD
   162     12  FILLER                      PIC  X(20).                  ELCDTEFD
   163                                                                  ELCDTEFD
   164 01  DATE-DISK-R.                                                 ELCDTEFD
   165     12  FILLER                      PIC  X(4).                   ELCDTEFD
   166     12  DD-ST           OCCURS 3 TIMES                           ELCDTEFD
   167                                     PIC  X(32).                  ELCDTEFD
   168                                                                  ELCDTEFD
   169 01  DATE-DISK-T.                                                 ELCDTEFD
   170     12  FILLER                      PIC  X(4).                   ELCDTEFD
   171     12  DD-TYPE         OCCURS 2 TIMES                           ELCDTEFD
   172                                     PIC  X(48).                  ELCDTEFD
   173                                                                  ELCDTEFD
   174 01  DATE-DISK-M.                                                 ELCDTEFD
   175     12  FILLER                      PIC  X(4).                   ELCDTEFD
   176     12  DD-MORT         OCCURS 2 TIMES                           ELCDTEFD
   177                                     PIC  X(48).                  ELCDTEFD
   178                                                                  ELCDTEFD
   179 01  DATE-DISK-P.                                                 ELCDTEFD
   180     12  DD-IDA                      PIC  XX.                     ELCDTEFD
   181     12  DD-IDX                      PIC  99.                     ELCDTEFD
   182     12  DD-DATA                     PIC  X(96).                  ELCDTEFD
   183     12  FILLER  REDEFINES DD-DATA.                               ELCDTEFD
   184         16  DD-PS-PIC   OCCURS 50 TIMES                          ELCDTEFD
   185                                     PIC  X.                      ELCDTEFD
   186         16  FILLER                  PIC  X(46).                  ELCDTEFD
   187     12  FILLER  REDEFINES DD-DATA.                               ELCDTEFD
   188         16  DD-PS-PICO  OCCURS 20 TIMES.                         ELCDTEFD
   189             20  DD-PS-PRT           PIC  X.                      ELCDTEFD
   190             20  DD-PS-FMT           PIC  X.                      ELCDTEFD
   191             20  DD-PS-PRC           PIC  X.                      ELCDTEFD
   192             20  DD-PS-TOT           PIC  X.                      ELCDTEFD
   193         16  FILLER                  PIC  X(16).                  ELCDTEFD
   194                                                                  ELCDTEFD
   195 01  DATE-DISK-E.                                                 ELCDTEFD
   196     12  FILLER                      PIC  X(4).                   ELCDTEFD
   197     12  DD-EDIT         OCCURS 24 TIMES                          ELCDTEFD
   198                                     PIC  X(4).                   ELCDTEFD
   199                                                                  ELCDTEFD
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   8
* EL539.cbl (/apps/prod/cid1p/copy/ELCDTEFD)
   200 01  DATE-DISK-C.                                                 ELCDTEFD
   201     12  FILLER                      PIC  X(7).                   ELCDTEFD
   202     12  DD-CARR1-SECPAY-SW          PIC  X.
   203     12  DD-CARR1-UEP-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   204     12  DD-CARR1-R78-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   205     12  DD-CARR1-PRO-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   206     12  DD-CARR1                    PIC  X.                      ELCDTEFD
   207     12  DD-CARR1S                   PIC  XX.                     ELCDTEFD
   208     12  DD-CARR1N                   PIC  X(30).                  ELCDTEFD
   209     12  DD-CARR2                    PIC  X.                      ELCDTEFD
   210     12  DD-CARR2S                   PIC  XX.                     ELCDTEFD
   211     12  DD-CARR2N                   PIC  X(30).                  ELCDTEFD
   212     12  DD-CARR2-UEP-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   213     12  DD-CARR2-R78-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   214     12  DD-CARR2-PRO-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   215     12  DD-CARR2-SECPAY-SW          PIC  X.
   216     12  FILLER                      PIC  X(7).                   ELCDTEFD
   217                                                                  ELCDTEFD
   218 01  DATE-DISK-OPT.                                               ELCDTEFD
   219     12  FILLER                      PIC  X(04).                  ELCDTEFD
   220     12  DD-TLR-DATA.                                             ELCDTEFD
   221         16  DD-TLR                  OCCURS 32 TIMES              ELCDTEFD
   222                                     PIC  X(03).                  ELCDTEFD
   223     12  DD-STATE-DATA REDEFINES DD-TLR-DATA.                     ELCDTEFD
   224         16  DD-STATE-FLDS           OCCURS 16 TIMES              ELCDTEFD
   225                                     PIC  X(06).                  ELCDTEFD
   226     12  DD-CARR-DATA REDEFINES DD-TLR-DATA.                      ELCDTEFD
   227         16  DD-CARR-FLDS            OCCURS 13 TIMES              ELCDTEFD
   228                                     PIC  X(07).                  ELCDTEFD
   229         16  FILLER                  PIC  X(05).                  ELCDTEFD
   230     12  DD-MISC-DATA REDEFINES DD-TLR-DATA                       ELCDTEFD
   231                                     PIC  X(96).                  ELCDTEFD
   232******************************************************************ELCDTEFD
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   9
* EL539.cbl
   234 FD  FICH
*  235                         COPY ELCFCHFD.
   236******************************************************************04/15/98
   237*                                                                *ELCFCHFD
   238*                            ELCFCHFD.                           *   LV003
   239*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
   240*                            VMOD=2.004                          *   CL**3
   241*                                                                *ELCFCHFD
   242******************************************************************ELCFCHFD
   243     BLOCK CONTAINS 0 RECORDS
   244     RECORDING MODE F.                                            ELCFCHFD
   245                                                                  ELCFCHFD
   246 01  FICH-REC                            PIC   X(133).            ELCFCHFD
   247******************************************************************ELCFCHFD
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  10
* EL539.cbl
   249 FD  ELREPT
*  250                         COPY ELCRPTFD.
   251******************************************************************04/16/98
   252*                                                                *ELCRPTFD
   253*                            ELCRPTFD.                           *   LV002
   254*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
   255*                            VMOD=2.001                          *ELCRPTFD
   256*                                                                *ELCRPTFD
   257* NOTE- USE ELCREPT AS COPY FOR 01 LEVEL                         *ELCRPTFD
   258*                                                                *ELCRPTFD
   259******************************************************************ELCRPTFD
   260      LABEL RECORDS ARE STANDARD.                                 ELCRPTFD
   261******************************************************************ELCRPTFD
   262
*  263     COPY ELCREPT.
   264******************************************************************04/15/98
   265*                                                                *ELCREPT
   266*                                                                *ELCREPT
   267*                            ELCREPT.                            *   LV002
   268*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
   269*                            VMOD=2.002                          *   CL**2
   270*                                                                *ELCREPT
   271*   FILE DESCRIPTION = REPORT STORAGE                            *ELCREPT
   272*                                                                *ELCREPT
   273*   FILE TYPE = VSAM,KSDS                                        *ELCREPT
   274*   RECORD SIZE = 146   RECFORM = FIX                            *ELCREPT
   275*                                                                *ELCREPT
   276*   BASE CLUSTER NAME = ELREPT                 RKP=2,LEN=11      *ELCREPT
   277*       ALTERNATE PATH  = NOT USED                               *ELCREPT
   278*                                                                *ELCREPT
   279*   LOG = NO                                                     *ELCREPT
   280*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *ELCREPT
   281******************************************************************ELCREPT
   282 01  REPORT-SAVE-FILE.                                            ELCREPT
   283     12  RF-RECORD-ID                PIC XX.                      ELCREPT
   284         88  VALID-RF-ID                VALUE 'RF'.               ELCREPT
   285                                                                  ELCREPT
   286     12  RF-CONTROL-PRIMARY.                                      ELCREPT
   287         16  RF-COMPANY-CD           PIC X.                       ELCREPT
   288         16  RF-RECORD-TYPE          PIC X.                       ELCREPT
   289             88  REPORT-DETAIL-RECORD   VALUE '1'.                ELCREPT
   290             88  REPORT-TRAILER-RECORD  VALUE '2'.                ELCREPT
   291         16  RF-REPORT-ID.                                        ELCREPT
   292             20  RF-SYSTEM-CODE      PIC XX.                      ELCREPT
   293                 88  CLAS-IC-ONLINE     VALUE 'EL'.               ELCREPT
   294                 88  CLAS-SCS-BATCH     VALUE 'EC'.               ELCREPT
   295             20  RF-PROGRAM-SEQUENCE PIC 999.                     ELCREPT
   296         16  RF-LINE-NUMBER          PIC S9(8)       COMP.        ELCREPT
   297     12  RF-REPORT-LINE-133.                                      ELCREPT
   298         16  RF-CTL-CHAR-133         PIC X.                       ELCREPT
   299         16  RF-DATA-133             PIC X(132).                  ELCREPT
   300         16  RF-DATA-FIRST  REDEFINES RF-DATA-133.                ELCREPT
   301             20  RF-DATA-2-81        PIC X(80).                   ELCREPT
   302             20  FILLER              PIC X(52).                   ELCREPT
   303         16  RF-DATA-LAST   REDEFINES RF-DATA-133.                ELCREPT
   304             20  FILLER              PIC X(53).                   ELCREPT
   305             20  RF-DATA-55-133      PIC X(79).                   ELCREPT
   306     12  RF-TRAILER-RECORD  REDEFINES RF-REPORT-LINE-133.         ELCREPT
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  11
* EL539.cbl (/apps/prod/cid1p/copy/ELCREPT)
   307         16  FILLER                  PIC X.                       ELCREPT
   308         16  RF-CURRENT-DATE         PIC X(8).                    ELCREPT
   309         16  RF-PRINT-HH-MM-SS       PIC X(6).                    ELCREPT
   310         16  FILLER                  PIC X(115).                  ELCREPT
   311         16  RF-COMPANY-ID           PIC XXX.                     ELCREPT
   312******************************************************************ELCREPT
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  12
* EL539.cbl
   314 FD  ERACCT.
   315
*  316     COPY ERCACCT.
   317******************************************************************04/19/98
   318*                                                                *ERCACCT
   319*                                                                *ERCACCT
   320*                            ERCACCT                             *   LV031
   321*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL*31
   322*                            VMOD=2.031                          *ERCACCT
   323*                                                                *ERCACCT
   324*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *ERCACCT
   325*                                                                *ERCACCT
   326*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *ERCACCT
   327*   VSAM ACCOUNT MASTER FILES.                                   *ERCACCT
   328*                                                                *ERCACCT
   329*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *ERCACCT
   330*                                                                *ERCACCT
   331*   FILE TYPE = VSAM,KSDS                                        *ERCACCT
   332*   RECORD SIZE = 2000  RECFORM = FIX                            *ERCACCT
   333*                                                                *ERCACCT
   334*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *ERCACCT
   335*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *ERCACCT
   336*                                                                *ERCACCT
   337*   LOG = NO                                                     *ERCACCT
   338*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *ERCACCT
   339*                                                                *ERCACCT
   340*                                                                *ERCACCT
   341******************************************************************ERCACCT
   342*                   C H A N G E   L O G
   343*
   344* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   345*-----------------------------------------------------------------
   346*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   347* EFFECTIVE    NUMBER
   348*-----------------------------------------------------------------
   349* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
   350* 092705    2005050300006  PEMA  ADD SPP LEASES
   351* 022808    2007083100002  PEMA  ADD FREEZE STATUS
   352* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
   353* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
   354* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
   355* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
   356******************************************************************
   357                                                                  ERCACCT
   358 01  ACCOUNT-MASTER.                                              ERCACCT
   359     12  AM-RECORD-ID                      PIC XX.                ERCACCT
   360         88  VALID-AM-ID                      VALUE 'AM'.         ERCACCT
   361                                                                  ERCACCT
   362     12  AM-CONTROL-PRIMARY.                                      ERCACCT
   363         16  AM-COMPANY-CD                 PIC X.                 ERCACCT
   364         16  AM-MSTR-CNTRL.                                       ERCACCT
   365             20  AM-CONTROL-A.                                    ERCACCT
   366                 24  AM-CARRIER            PIC X.                 ERCACCT
   367                 24  AM-GROUPING.                                 ERCACCT
   368                     28 AM-GROUPING-PREFIX PIC XXX.               ERCACCT
   369                     28 AM-GROUPING-PRIME  PIC XXX.               ERCACCT
   370                 24  AM-STATE              PIC XX.                ERCACCT
   371                 24  AM-ACCOUNT.                                  ERCACCT
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  13
* EL539.cbl (/apps/prod/cid1p/copy/ERCACCT)
   372                     28  AM-ACCOUNT-PREFIX PIC X(4).              ERCACCT
   373                     28  AM-ACCOUNT-PRIME  PIC X(6).              ERCACCT
   374             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A            ERCACCT
   375                                           PIC X(19).             ERCACCT
   376             20  AM-CNTRL-B.                                      ERCACCT
   377                 24  AM-EXPIRATION-DT      PIC XX.                ERCACCT
   378                 24  FILLER                PIC X(4).              ERCACCT
   379             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.                 ERCACCT
   380                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.     ERCACCT
   381                                                                  ERCACCT
   382     12  AM-CONTROL-BY-VAR-GRP.                                   ERCACCT
   383         16  AM-COMPANY-CD-A1              PIC X.                 ERCACCT
   384         16  AM-VG-CARRIER                 PIC X.                 ERCACCT
   385         16  AM-VG-GROUPING                PIC X(6).              ERCACCT
   386         16  AM-VG-STATE                   PIC XX.                ERCACCT
   387         16  AM-VG-ACCOUNT                 PIC X(10).             ERCACCT
   388         16  AM-VG-DATE.                                          ERCACCT
   389             20  AM-VG-EXPIRATION-DT       PIC XX.                ERCACCT
   390             20  FILLER                    PIC X(4).              ERCACCT
   391         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE                  ERCACCT
   392                                           PIC 9(11)      COMP-3. ERCACCT
   393     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
   394         16  FILLER                        PIC X(10).
   395         16  AM-VG-KEY3.
   396             20  AM-VG3-ACCOUNT            PIC X(10).
   397             20  AM-VG3-EXP-DT             PIC XX.
   398         16  FILLER                        PIC X(4).
   399     12  AM-MAINT-INFORMATION.                                    ERCACCT
   400         16  AM-LAST-MAINT-DT              PIC XX.                ERCACCT
   401         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3. ERCACCT
   402         16  AM-LAST-MAINT-USER            PIC X(4).              ERCACCT
   403         16  FILLER                        PIC XX.                ERCACCT
   404                                                                  ERCACCT
   405     12  AM-EFFECTIVE-DT                   PIC XX.                ERCACCT
   406     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3. ERCACCT
   407                                                                  ERCACCT
   408     12  AM-PREV-DATES  COMP-3.                                   ERCACCT
   409         16  AM-PREV-EXP-DT                PIC 9(11).             ERCACCT
   410         16  AM-PREV-EFF-DT                PIC 9(11).             ERCACCT
   411                                                                  ERCACCT
   412     12  AM-REPORT-CODE-1                  PIC X(10).             ERCACCT
   413     12  AM-REPORT-CODE-2                  PIC X(10).             ERCACCT
   414                                                                  ERCACCT
   415     12  AM-CITY-CODE                      PIC X(4).              ERCACCT
   416     12  AM-COUNTY-PARISH                  PIC X(6).              ERCACCT
   417                                                                  ERCACCT
   418     12  AM-NAME                           PIC X(30).             ERCACCT
   419     12  AM-PERSON                         PIC X(30).             ERCACCT
   420     12  AM-ADDRS                          PIC X(30).             ERCACCT
   421     12  AM-CITY.
   422         16  AM-ADDR-CITY                  PIC X(28).
   423         16  AM-ADDR-STATE                 PIC XX.
   424     12  AM-ZIP.                                                  ERCACCT
   425         16  AM-ZIP-PRIME.                                        ERCACCT
   426             20  AM-ZIP-PRI-1ST            PIC X.                 ERCACCT
   427                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'. ERCACCT
   428             20  FILLER                    PIC X(4).              ERCACCT
   429         16  AM-ZIP-PLUS4                  PIC X(4).              ERCACCT
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  14
* EL539.cbl (/apps/prod/cid1p/copy/ERCACCT)
   430     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.              ERCACCT
   431         16  AM-CAN-POSTAL-1               PIC XXX.               ERCACCT
   432         16  AM-CAN-POSTAL-2               PIC XXX.               ERCACCT
   433         16  FILLER                        PIC XXX.               ERCACCT
   434     12  AM-TEL-NO.                                               ERCACCT
   435         16  AM-AREA-CODE                  PIC 999.               ERCACCT
   436         16  AM-TEL-PRE                    PIC 999.               ERCACCT
   437         16  AM-TEL-NBR                    PIC 9(4).              ERCACCT
   438     12  AM-TEL-LOC                        PIC X.                 ERCACCT
   439         88  AM-TEL-AT-HOME                   VALUE 'H'.          ERCACCT
   440         88  AM-TEL-AT-BUSINESS               VALUE 'B'.          ERCACCT
   441                                                                  ERCACCT
   442     12  AM-COMM-STRUCTURE.                                       ERCACCT
   443         16  AM-DEFN-1.                                           ERCACCT
   444             20  AM-AGT-COMMS       OCCURS 10 TIMES.              ERCACCT
   445                 24  AM-AGT.                                      ERCACCT
   446                     28  AM-AGT-PREFIX     PIC X(4).              ERCACCT
   447                     28  AM-AGT-PRIME      PIC X(6).              ERCACCT
   448                 24  AM-COM-TYP            PIC X.                 ERCACCT
   449                 24  AM-L-COM              PIC SV9(5)     COMP-3. ERCACCT
   450                 24  AM-J-COM              PIC SV9(5)     COMP-3. ERCACCT
   451                 24  AM-A-COM              PIC SV9(5)     COMP-3. ERCACCT
   452                 24  AM-RECALC-LV-INDIC    PIC X.                 ERCACCT
   453                 24  AM-RETRO-LV-INDIC     PIC X.                 ERCACCT
   454                 24  AM-GL-CODES           PIC X.                 ERCACCT
   455                 24  AM-COMM-CHARGEBACK    PIC 9(02).             ERCACCT
   456                 24  FILLER                PIC X(01).             ERCACCT
   457         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.                   ERCACCT
   458             20  AM-COM-TBLS        OCCURS 10 TIMES.              ERCACCT
   459                 24  FILLER                PIC X(11).             ERCACCT
   460                 24  AM-L-COMA             PIC XXX.               ERCACCT
   461                 24  AM-J-COMA             PIC XXX.               ERCACCT
   462                 24  AM-A-COMA             PIC XXX.               ERCACCT
   463                 24  FILLER                PIC X(6).              ERCACCT
   464                                                                  ERCACCT
   465     12  AM-COMM-CHANGE-STATUS             PIC X.                 ERCACCT
   466         88  AM-COMMISSIONS-CHANGED           VALUE '*'.          ERCACCT
   467                                                                  ERCACCT
   468     12  AM-CSR-CODE                       PIC X(4).              ERCACCT
   469                                                                  ERCACCT
   470     12  AM-BILLING-STATUS                 PIC X.                 ERCACCT
   471         88  AM-ACCOUNT-BILLED                VALUE 'B'.          ERCACCT
   472         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.          ERCACCT
   473     12  AM-AUTO-REFUND-SW                 PIC X.                 ERCACCT
   474         88  AUTO-REFUNDS-USED                VALUE 'Y'.          ERCACCT
   475         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.      ERCACCT
   476     12  AM-GPCD                           PIC 99.                ERCACCT
   477     12  AM-IG                             PIC X.                 ERCACCT
   478         88  AM-HAS-INDIVIDUAL                VALUE '1'.          ERCACCT
   479         88  AM-HAS-GROUP                     VALUE '2'.          ERCACCT
   480     12  AM-STATUS                         PIC X.                 ERCACCT
   481         88  AM-ACCOUNT-ACTIVE                VALUE '0'.          ERCACCT
   482         88  AM-ACCOUNT-INACTIVE              VALUE '1'.          ERCACCT
   483         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.          ERCACCT
   484         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
   485         88  AM-ACCOUNT-FROZEN                VALUE '4'.
   486         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
   487     12  AM-REMIT-TO                       PIC 99.                ERCACCT
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  15
* EL539.cbl (/apps/prod/cid1p/copy/ERCACCT)
   488     12  AM-ID-NO                          PIC X(11).             ERCACCT
   489                                                                  ERCACCT
   490     12  AM-CAL-TABLE                      PIC XX.                ERCACCT
   491     12  AM-LF-DEVIATION                   PIC XXX.               ERCACCT
   492     12  AM-AH-DEVIATION                   PIC XXX.               ERCACCT
   493     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3. ERCACCT
   494     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3. ERCACCT
   495     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3. ERCACCT
   496     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3. ERCACCT
   497     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3. ERCACCT
   498     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3. ERCACCT
   499                                                                  ERCACCT
   500     12  AM-USER-FIELDS.                                          ERCACCT
   501         16  AM-FLD-1                      PIC XX.                ERCACCT
   502         16  AM-FLD-2                      PIC XX.                ERCACCT
   503         16  AM-FLD-3                      PIC XX.                ERCACCT
   504         16  AM-FLD-4                      PIC XX.                ERCACCT
   505         16  AM-FLD-5                      PIC XX.                ERCACCT
   506                                                                  ERCACCT
   507     12  AM-1ST-PROD-DATE.                                        ERCACCT
   508         16  AM-1ST-PROD-YR                PIC XX.                ERCACCT
   509         16  AM-1ST-PROD-MO                PIC XX.                ERCACCT
   510         16  AM-1ST-PROD-DA                PIC XX.                ERCACCT
   511     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.     ERCACCT
   512     12  AM-CERTS-PURGED-DATE.                                    ERCACCT
   513         16  AM-PUR-YR                     PIC XX.                ERCACCT
   514         16  AM-PUR-MO                     PIC XX.                ERCACCT
   515         16  AM-PUR-DA                     PIC XX.                ERCACCT
   516     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.     ERCACCT
   517     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.     ERCACCT
   518     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.     ERCACCT
   519     12  AM-INACTIVE-DATE.                                        ERCACCT
   520         16  AM-INA-MO                     PIC 99.                ERCACCT
   521         16  AM-INA-DA                     PIC 99.                ERCACCT
   522         16  AM-INA-YR                     PIC 99.                ERCACCT
   523     12  AM-AR-HI-CERT-DATE                PIC XX.                ERCACCT
   524                                                                  ERCACCT
   525     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3. ERCACCT
   526     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3. ERCACCT
   527                                                                  ERCACCT
   528     12  AM-OB-PAYMENT-MODE                PIC X.                 ERCACCT
   529         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.      ERCACCT
   530         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.          ERCACCT
   531         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.          ERCACCT
   532         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.          ERCACCT
   533                                                                  ERCACCT
   534     12  AM-AH-ONLY-INDICATOR              PIC X.                 ERCACCT
   535         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.      ERCACCT
   536         88  AM-NO-AH-ONLY                    VALUE 'N'.          ERCACCT
   537                                                                  ERCACCT
   538     12  AM-EDIT-LOAN-OFC                  PIC X(01).             ERCACCT
   539                                                                  ERCACCT
   540     12  AM-OVER-SHORT.                                           ERCACCT
   541         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3. ERCACCT
   542         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3. ERCACCT
   543                                                                  ERCACCT
   544     12  AM-DCC-PRODUCT-CODE               PIC XXX.
   545     12  AM-DCC-CLP-STATE                  PIC XX.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  16
* EL539.cbl (/apps/prod/cid1p/copy/ERCACCT)
   546                                                                  ERCACCT
   547     12  AM-RECALC-COMM                    PIC X.                 ERCACCT
   548     12  AM-RECALC-REIN                    PIC X.                 ERCACCT
   549                                                                  ERCACCT
   550     12  AM-REI-TABLE                      PIC XXX.               ERCACCT
   551     12  AM-REI-ET-LF                      PIC X.                 ERCACCT
   552     12  AM-REI-ET-AH                      PIC X.                 ERCACCT
   553     12  AM-REI-PE-LF                      PIC X.                 ERCACCT
   554     12  AM-REI-PE-AH                      PIC X.                 ERCACCT
   555     12  AM-REI-PRT-ST                     PIC X.                 ERCACCT
   556     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3. ERCACCT
   557     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3. ERCACCT
   558     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3. ERCACCT
   559     12  AM-REI-GROUP-A                    PIC X(6).              ERCACCT
   560     12  AM-REI-MORT                       PIC X(4).              ERCACCT
   561     12  AM-REI-PRT-OW                     PIC X.                 ERCACCT
   562     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3. ERCACCT
   563     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3. ERCACCT
   564     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3. ERCACCT
   565     12  AM-REI-GROUP-B                    PIC X(6).              ERCACCT
   566                                                                  ERCACCT
   567     12  AM-TRUST-TYPE                     PIC X(2).              ERCACCT
   568                                                                  ERCACCT
   569     12  AM-EMPLOYER-STMT-USED             PIC X.                 ERCACCT
   570     12  AM-GROUPED-CHECKS-Y-N             PIC X.                 ERCACCT
   571                                                                  ERCACCT
   572     12  AM-STD-AH-TYPE                    PIC XX.                ERCACCT
   573     12  AM-EARN-METHODS.                                         ERCACCT
   574         16  AM-EARN-METHOD-R              PIC X.                 ERCACCT
   575             88 AM-REF-RL-R78                 VALUE 'R'.          ERCACCT
   576             88 AM-REF-RL-PR                  VALUE 'P'.          ERCACCT
   577             88 AM-REF-RL-MEAN                VALUE 'M'.          ERCACCT
   578             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.          ERCACCT
   579         16  AM-EARN-METHOD-L              PIC X.                 ERCACCT
   580             88 AM-REF-LL-R78                 VALUE 'R'.          ERCACCT
   581             88 AM-REF-LL-PR                  VALUE 'P'.          ERCACCT
   582             88 AM-REF-LL-MEAN                VALUE 'M'.          ERCACCT
   583             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.          ERCACCT
   584         16  AM-EARN-METHOD-A              PIC X.                 ERCACCT
   585             88 AM-REF-AH-R78                 VALUE 'R'.          ERCACCT
   586             88 AM-REF-AH-PR                  VALUE 'P'.          ERCACCT
   587             88 AM-REF-AH-MEAN                VALUE 'M'.          ERCACCT
   588             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.          ERCACCT
   589             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.          ERCACCT
   590             88 AM-REF-AH-NET                 VALUE 'N'.          ERCACCT
   591                                                                  ERCACCT
   592     12  AM-TOL-PREM                       PIC S999V99    COMP-3. ERCACCT
   593     12  AM-TOL-REF                        PIC S999V99    COMP-3. ERCACCT
   594     12  AM-TOL-CLM                        PIC S999V99    COMP-3. ERCACCT
   595                                                                  ERCACCT
   596     12  AM-RET-Y-N                        PIC X.                 ERCACCT
   597     12  AM-RET-P-E                        PIC X.                 ERCACCT
   598     12  AM-LF-RET                         PIC S9V9999    COMP-3. ERCACCT
   599     12  AM-AH-RET                         PIC S9V9999    COMP-3. ERCACCT
   600     12  AM-RET-GRP                        PIC X(6).              ERCACCT
   601     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.                    ERCACCT
   602         16  AM-POOL-PRIME                 PIC XXX.               ERCACCT
   603         16  AM-POOL-SUB                   PIC XXX.               ERCACCT
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  17
* EL539.cbl (/apps/prod/cid1p/copy/ERCACCT)
   604     12  AM-RETRO-EARNINGS.                                       ERCACCT
   605         16  AM-RET-EARN-R                 PIC X.                 ERCACCT
   606         16  AM-RET-EARN-L                 PIC X.                 ERCACCT
   607         16  AM-RET-EARN-A                 PIC X.                 ERCACCT
   608     12  AM-RET-ST-TAX-USE                 PIC X.                 ERCACCT
   609         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.  ERCACCT
   610         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.      ERCACCT
   611     12  AM-RETRO-BEG-EARNINGS.                                   ERCACCT
   612         16  AM-RET-BEG-EARN-R             PIC X.                 ERCACCT
   613         16  AM-RET-BEG-EARN-L             PIC X.                 ERCACCT
   614         16  AM-RET-BEG-EARN-A             PIC X.                 ERCACCT
   615     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3. ERCACCT
   616     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3. ERCACCT
   617                                                                  ERCACCT
   618     12  AM-USER-SELECT-OPTIONS.                                  ERCACCT
   619         16  AM-USER-SELECT-1              PIC X(10).             ERCACCT
   620         16  AM-USER-SELECT-2              PIC X(10).             ERCACCT
   621         16  AM-USER-SELECT-3              PIC X(10).             ERCACCT
   622         16  AM-USER-SELECT-4              PIC X(10).             ERCACCT
   623         16  AM-USER-SELECT-5              PIC X(10).             ERCACCT
   624                                                                  ERCACCT
   625     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3. ERCACCT
   626                                                                  ERCACCT
   627     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3. ERCACCT
   628                                                                  ERCACCT
   629     12  AM-RPT045A-SWITCH                 PIC X.                 ERCACCT
   630         88  RPT045A-OFF                   VALUE 'N'.             ERCACCT
   631                                                                  ERCACCT
   632     12  AM-INSURANCE-LIMITS.                                     ERCACCT
   633         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3. ERCACCT
   634         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3. ERCACCT
   635                                                                  ERCACCT
   636     12  AM-PROFILE-CHANGE-SWITCH          PIC X.                 ERCACCT
   637         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.          ERCACCT
   638                                                                  ERCACCT
   639     12  AM-DISMBR-COVERAGE-SW             PIC X.                 ERCACCT
   640         88  AM-DISMBR-COVERAGE               VALUE 'Y'.          ERCACCT
   641         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.          ERCACCT
   642                                                                  ERCACCT
   643     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3. ERCACCT
   644                                                                  ERCACCT
   645     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3. ERCACCT
   646     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
   647     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
   648     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
   649     12  AM-DCC-UEF-STATE                  PIC XX.
   650     12  FILLER                            PIC XXX.
   651     12  AM-REPORT-CODE-3                  PIC X(10).
   652*    12  FILLER                            PIC X(22).             ERCACCT
   653                                                                  ERCACCT
   654     12  AM-RESERVE-DATE.                                         ERCACCT
   655         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.    ERCACCT
   656         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.    ERCACCT
   657         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.    ERCACCT
   658                                                                  ERCACCT
   659     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.                ERCACCT
   660     12  AM-NOTIFICATION-TYPES.                                   ERCACCT
   661         16  AM-NOTIF-OF-LETTERS           PIC X.                 ERCACCT
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  18
* EL539.cbl (/apps/prod/cid1p/copy/ERCACCT)
   662         16  AM-NOTIF-OF-PAYMENTS          PIC X.                 ERCACCT
   663         16  AM-NOTIF-OF-REPORTS           PIC X.                 ERCACCT
   664         16  AM-NOTIF-OF-STATUS            PIC X.                 ERCACCT
   665                                                                  ERCACCT
   666     12  AM-BENEFIT-TABLE-USAGE            PIC X.                 ERCACCT
   667         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.          ERCACCT
   668         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.          ERCACCT
   669         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.          ERCACCT
   670         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.     ERCACCT
   671                                                                  ERCACCT
   672     12  AM-BENEFIT-CONTROLS.                                     ERCACCT
   673         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.            ERCACCT
   674             20  AM-BENEFIT-CODE           PIC XX.                ERCACCT
   675             20  AM-BENEFIT-TYPE           PIC X.                 ERCACCT
   676             20  AM-BENEFIT-REVISION       PIC XXX.               ERCACCT
   677             20  AM-BENEFIT-REM-TERM       PIC X.                 ERCACCT
   678             20  AM-BENEFIT-RETRO-Y-N      PIC X.                 ERCACCT
   679             20  FILLER                    PIC XX.                ERCACCT
   680         16  FILLER                        PIC X(80).             ERCACCT
   681                                                                  ERCACCT
   682     12  AM-TRANSFER-DATA.                                        ERCACCT
   683         16  AM-TRANSFERRED-FROM.                                 ERCACCT
   684             20  AM-TRNFROM-CARRIER        PIC X.                 ERCACCT
   685             20  AM-TRNFROM-GROUPING.                             ERCACCT
   686                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.               ERCACCT
   687                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.               ERCACCT
   688             20  AM-TRNFROM-STATE          PIC XX.                ERCACCT
   689             20  AM-TRNFROM-ACCOUNT.                              ERCACCT
   690                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).             ERCACCT
   691                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).              ERCACCT
   692             20  AM-TRNFROM-DTE            PIC XX.                ERCACCT
   693         16  AM-TRANSFERRED-TO.                                   ERCACCT
   694             20  AM-TRNTO-CARRIER          PIC X.                 ERCACCT
   695             20  AM-TRNTO-GROUPING.                               ERCACCT
   696                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.               ERCACCT
   697                 24  AM-TRNTO-GRP-PRIME    PIC XXX.               ERCACCT
   698             20  AM-TRNTO-STATE            PIC XX.                ERCACCT
   699             20  AM-TRNTO-ACCOUNT.                                ERCACCT
   700                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).              ERCACCT
   701                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).              ERCACCT
   702             20  AM-TRNTO-DTE              PIC XX.                ERCACCT
   703         16  FILLER                        PIC X(10).             ERCACCT
   704                                                                  ERCACCT
   705     12  AM-SAVED-REMIT-TO                 PIC 99.                ERCACCT
   706                                                                  ERCACCT
   707     12  AM-COMM-STRUCTURE-SAVED.                                 ERCACCT
   708         16  AM-DEFN-1-SAVED.                                     ERCACCT
   709             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.           ERCACCT
   710                 24  AM-AGT-SV             PIC X(10).             ERCACCT
   711                 24  AM-COM-TYP-SV         PIC X.                 ERCACCT
   712                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3. ERCACCT
   713                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3. ERCACCT
   714                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3. ERCACCT
   715                 24  AM-RECALC-LV-INDIC-SV PIC X.                 ERCACCT
   716                 24  FILLER                PIC X.                 ERCACCT
   717                 24  AM-GL-CODES-SV        PIC X.                 ERCACCT
   718                 24  AM-COM-CHARGEBACK-SV  PIC 99.                ERCACCT
   719                 24  FILLER                PIC X.                 ERCACCT
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  19
* EL539.cbl (/apps/prod/cid1p/copy/ERCACCT)
   720         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.       ERCACCT
   721             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.            ERCACCT
   722                 24  FILLER                PIC X(11).             ERCACCT
   723                 24  AM-L-COMA-SV          PIC XXX.               ERCACCT
   724                 24  AM-J-COMA-SV          PIC XXX.               ERCACCT
   725                 24  AM-A-COMA-SV          PIC XXX.               ERCACCT
   726                 24  FILLER                PIC X(6).              ERCACCT
   727                                                                  ERCACCT
   728     12  AM-FLC-NET-PREMIUM-ALLOWANCE.                            ERCACCT
   729         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.                 ERCACCT
   730            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3. ERCACCT
   731            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3. ERCACCT
   732            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3. ERCACCT
   733                                                                  ERCACCT
   734     12  AM-ORIG-DEALER-NO                 PIC X(10).             ERCACCT
   735     12  FILLER                            PIC X(120).            ERCACCT
   736                                                                  ERCACCT
   737     12  AM-ACCOUNT-EXECUTIVE-DATA.                               ERCACCT
   738         16  AM-CONTROL-NAME               PIC X(30).             ERCACCT
   739         16  AM-EXECUTIVE-ONE.                                    ERCACCT
   740             20  AM-EXEC1-NAME             PIC X(15).             ERCACCT
   741             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)       ERCACCT
   742                                                          COMP-3. ERCACCT
   743             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)       ERCACCT
   744                                                          COMP-3. ERCACCT
   745         16  AM-EXECUTIVE-TWO.                                    ERCACCT
   746             20  AM-EXEC2-NAME             PIC X(15).             ERCACCT
   747             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)       ERCACCT
   748                                                          COMP-3. ERCACCT
   749             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)       ERCACCT
   750                                                          COMP-3. ERCACCT
   751                                                                  ERCACCT
   752     12  AM-RETRO-ADDITIONAL-DATA.                                ERCACCT
   753         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3. ERCACCT
   754         16  AM-RETRO-PREM-P-E             PIC X.                 ERCACCT
   755         16  AM-RETRO-CLMS-P-I             PIC X.                 ERCACCT
   756         16  AM-RETRO-RET-BRACKET-LF.                             ERCACCT
   757             20  AM-RETRO-RET-METHOD-LF    PIC X.                 ERCACCT
   758                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.      ERCACCT
   759                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.          ERCACCT
   760             20  AM-RETRO-RET-BASIS-LF     PIC X.                 ERCACCT
   761                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.      ERCACCT
   762                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.          ERCACCT
   763             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.           ERCACCT
   764                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3. ERCACCT
   765                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3. ERCACCT
   766         16  AM-RETRO-RET-BRACKET-AH.                             ERCACCT
   767             20  AM-RETRO-RET-METHOD-AH    PIC X.                 ERCACCT
   768                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.      ERCACCT
   769                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.          ERCACCT
   770                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.          ERCACCT
   771             20  AM-RETRO-RET-BASIS-AH     PIC X.                 ERCACCT
   772                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.      ERCACCT
   773                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.          ERCACCT
   774             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.           ERCACCT
   775                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3. ERCACCT
   776                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3. ERCACCT
   777                                                                  ERCACCT
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  20
* EL539.cbl (/apps/prod/cid1p/copy/ERCACCT)
   778     12  AM-COMMENTS.                                             ERCACCT
   779         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.ERCACCT
   780                                                                  ERCACCT
   781     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.         ERCACCT
   782         16  AM-FLI-RETRO-SHARE-CODE       PIC X.                 ERCACCT
   783         16  AM-FLI-BILLING-CODE           PIC X.                 ERCACCT
   784         16  AM-FLI-ALT-STATE-CODE         PIC XX.                ERCACCT
   785         16  AM-FLI-UNITED-IDENT           PIC X.                 ERCACCT
   786         16  AM-FLI-INTEREST-LOST-DATA.                           ERCACCT
   787             20  AM-FLI-BANK-NO            PIC X(5).              ERCACCT
   788             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3. ERCACCT
   789             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3. ERCACCT
   790             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3. ERCACCT
   791         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.            ERCACCT
   792             20  AM-FLI-AGT                PIC X(9).              ERCACCT
   793             20  AM-FLI-AGT-COMM-ACC       PIC X.                 ERCACCT
   794             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3. ERCACCT
   795         16  FILLER                        PIC X(102).            ERCACCT
   796                                                                  ERCACCT
   797     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.         ERCACCT
   798         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.          ERCACCT
   799             20  AM-BENEFIT-DMD-CODE         PIC XX.              ERCACCT
   800             20  AM-BENEFIT-DMD-TYPE         PIC X.               ERCACCT
   801             20  AM-BENEFIT-DMD-REVISION     PIC XXX.             ERCACCT
   802             20  AM-BENEFIT-DMD-REM-TERM     PIC X.               ERCACCT
   803             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.               ERCACCT
   804         16  FILLER                          PIC X(10).           ERCACCT
   805******************************************************************ERCACCT
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  21
* EL539.cbl
   807 FD  ERLOFC.
   808
*  809     COPY ERCLOFC.
   810******************************************************************12/04/92
   811*                                                                *ERCLOFC
   812*                                                                *ERCLOFC
   813*                            ERCLOFC                             *   LV002
   814*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   815*                            VMOD=2.003                          *   CL**2
   816*                                                                *ERCLOFC
   817*   FILE DESCRIPTION = LOAN OFFICER CONTROLS                     *ERCLOFC
   818*                                                                *ERCLOFC
   819*   FILE TYPE = VSAM,KSDS                                        *ERCLOFC
   820*   RECORD SIZE = 670   RECFORM = FIX                            *ERCLOFC
   821*                                                                *ERCLOFC
   822*   BASE CLUSTER NAME = ERLOFC                   RKP=2,LEN=25    *ERCLOFC
   823*                                                                *ERCLOFC
   824*   LOG = YES                                                    *ERCLOFC
   825*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *ERCLOFC
   826*                                                                *ERCLOFC
   827******************************************************************ERCLOFC
   828                                                                  ERCLOFC
   829 01  LOAN-OFFICER-MASTER.                                         ERCLOFC
   830     12  LO-RECORD-ID                PIC XX.                      ERCLOFC
   831         88  VALID-LO-ID                VALUE 'LO'.               ERCLOFC
   832                                                                  ERCLOFC
   833     12  LO-CONTROL-PRIMARY.                                      ERCLOFC
   834         16  LO-COMPANY-CD           PIC X.                       ERCLOFC
   835         16  LO-CARRIER              PIC X.                       ERCLOFC
   836         16  LO-GROUPING.                                         ERCLOFC
   837             20  LO-GROUPING-PREFIX  PIC XXX.                     ERCLOFC
   838             20  LO-GROUPING-PRIME   PIC XXX.                     ERCLOFC
   839         16  LO-STATE                PIC XX.                      ERCLOFC
   840         16  LO-ACCOUNT.                                          ERCLOFC
   841             20  LO-ACCOUNT-PREFIX   PIC X(4).                    ERCLOFC
   842             20  LO-ACCOUNT-PRIME    PIC X(6).                    ERCLOFC
   843         16  LO-OFFICER-CODE         PIC X(5).
   844                                                                  ERCLOFC
   845     12  LO-OFFICER-NAME             PIC X(30).                   ERCLOFC
   846                                                                  ERCLOFC
   847     12  LO-LAST-MAINT-DT            PIC XX.                      ERCLOFC
   848     12  LO-LAST-USER                PIC X(4).                    ERCLOFC
   849     12  LO-LAST-MAINT-HHMMSS        PIC S9(6) COMP-3.            ERCLOFC
   850                                                                  ERCLOFC
   851     12  LO-COMP-CONTROL             PIC X.                       ERCLOFC
   852             88  LO-SHOW-COMP           VALUE 'Y'.                ERCLOFC
   853             88  LO-SUPPRESS-COMP       VALUE 'N'.                ERCLOFC
   854     12  LO-DETAIL-CONTROL           PIC X.                       ERCLOFC
   855             88  LO-PRINT-DETAIL        VALUE 'D'.                ERCLOFC
   856             88  LO-PRINT-SUMMARY       VALUE 'S'.                ERCLOFC
   857                                                                  ERCLOFC
   858     12  LO-SV-CARRIER               PIC X.                       ERCLOFC
   859     12  LO-SV-GROUPING              PIC X(6).                    ERCLOFC
   860     12  LO-SV-STATE                 PIC XX.                      ERCLOFC
   861                                                                  ERCLOFC
   862     12  LO-PROCESS-MO-YR            PIC 9(7)  COMP-3.               CL**2
   863     12  LO-TOTAL-COMMISSION         PIC S9(9)V99 COMP-3.            CL**2
   864                                                                  ERCLOFC
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  22
* EL539.cbl (/apps/prod/cid1p/copy/ERCLOFC)
   865     12  LO-OFFICER-INFO.                                         ERCLOFC
   866         16  FILLER OCCURS 12 TIMES.                              ERCLOFC
   867             20  LO-LOAN-COUNT       PIC S9(5) COMP-3.            ERCLOFC
   868             20  LO-LOAN-VOLUME      PIC S9(9) COMP-3.            ERCLOFC
   869             20  LO-LF-COUNT         PIC S9(5) COMP-3.            ERCLOFC
   870             20  LO-LF-PREM          PIC S9(7) COMP-3.            ERCLOFC
   871             20  LO-LF-BENEFIT       PIC S9(9) COMP-3.            ERCLOFC
   872             20  LO-AH-COUNT         PIC S9(5) COMP-3.            ERCLOFC
   873             20  LO-AH-PREM          PIC S9(7) COMP-3.            ERCLOFC
   874             20  LO-AH-BENEFIT       PIC S9(9) COMP-3.            ERCLOFC
   875     12  FILLER                      PIC X(198).
   876******************************************************************ERCLOFC
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  23
* EL539.cbl
   878 FD  ERPNDB.
   879
   880 01  PB-RECORD.
   881     12  FILLER              PIC  X(13).
   882     12  PB-CONTROL-BY-ACCT.
   883         16  PB-COMP-CD      PIC  X(01).
   884         16  FILLER          PIC  X(35).
   885     12  FILLER              PIC  X(536).
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  24
* EL539.cbl
   887 WORKING-STORAGE SECTION.
   888 77  LCP-ASA                       PIC X.
   889 77  FILLER  PIC  X(32) VALUE '********************************'.
   890 77  FILLER  PIC  X(32) VALUE '*    EL539 WORKING-STORAGE     *'.
   891 77  FILLER  PIC  X(32) VALUE '***********VMOD=2.015 **********'.
   892
   893 77  PGM-SUB                 PIC S9(03)  COMP    VALUE +539.
   894 77  WK1                     PIC S999    COMP-3  VALUE +0.
   895 77  WK2                     PIC S999    COMP-3  VALUE +0.
   896 77  WS-RETURN-CODE          PIC S9(04)  COMP    VALUE +0.
   897 77  TBLX                    PIC S9(04)  COMP.
   898 77  AX                      PIC S9(04)  COMP.
   899 77  WS-ZERO                 PIC S9(01)  COMP-3  VALUE +0.
   900 77  LNCT                    PIC S9(02)  COMP-3  VALUE +80.
   901 77  PGCT                    PIC S9(05)  COMP-3  VALUE +0.
   902 77  X                       PIC  X(01).
   903 77  LO-OPT1                 PIC  X(01).
   904 77  LO-OPT2                 PIC  X(01).
   905 77  SKIP-THIS-ACCT          PIC  X(01)          VALUE 'N'.
   906 77  SKIP-THIS-LOAN-OFCR     PIC  X(01)          VALUE 'N'.
   907 77  HAVE-DATA               PIC  X(01)          VALUE 'N'.
   908 77  LO-UPD                  PIC  X(01).
   909 77  HAVE-HIGH-VALUE         PIC  X(01)          VALUE 'N'.
   910 77  PRNTG-SUMM              PIC  X(01)          VALUE 'N'.
   911 77  PRNTG-DTL               PIC  X(01)          VALUE 'N'.
   912 77  ANY-COMP                PIC  X(01).
   913 77  WS-ABEND-FILE-STATUS    PIC  X(02)          VALUE ZERO.
   914 77  OLC-REPORT-NAME         PIC  X(06)          VALUE 'EL539'.
   915 77  SAVE-ACCOUNT            PIC  X(10).
   916 77  LST-ACCT                PIC  X(20)          VALUE LOW-VALUE.
   917 77  KEY-20                  PIC  X(20)          VALUE LOW-VALUES.
   918 77  KEY-EFF-DT              PIC  XX             VALUE LOW-VALUES.
   919 77  LST-OFFCR               PIC  X(25)          VALUE LOW-VALUE.
   920 77  KEY-23                  PIC  X(25).
   921 77  HLD-CTL                 PIC  X(25)          VALUE LOW-VALUE.
   922 77  WS-ABEND-MESSAGE        PIC  X(80)          VALUE SPACES.
   923 77  WS-WORK-AMT             PIC S9(9)V99 COMP-3 VALUE +0.
   924 77  WS-FIX-CNT              PIC 9(05) VALUE ZEROS.
   925 77  WS-PRINT-UNASSIGN       PIC X   VALUE ' '.
   926     88  PRINT-UNASSIGN-LINE       VALUE 'Y'.
   927
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  25
* EL539.cbl
   929 01  WS-HOLD-ERACCT          PIC X(2000) VALUE SPACES.
   930 01  MISC-WS.
   931     12  WS-BANK             PIC  X(10) VALUE SPACES.
   932     12  PB-STATUS.
   933         16  PB-STAT-1       PIC  X(01).
   934         16  PB-STAT-2       PIC  X(01).
   935     12  AM-FILE-STATUS.
   936         16  AM-STAT-1       PIC  X(01).
   937         16  AM-STAT-2       PIC  X(01).
   938     12  LO-STATUS.
   939         16  LO-STAT-1       PIC  X(01).
   940         16  LO-STAT-2       PIC  X(01).
   941     12  CTLKEY.
   942         16  CPGCTL.
   943             20  CTLCO       PIC  X(01).
   944             20  CTLCARR     PIC  X(01).
   945             20  CTLGRP      PIC  X(06).
   946             20  CTLST       PIC  X(02).
   947             20  CTLACCT     PIC  X(10).
   948         16  FILLER.
   949             20  CTLOFCR     PIC  X(05).
   950     12  PRVKEY.
   951         16  PPGCTL          PIC  X(20)      VALUE LOW-VALUES.
   952         16  PLO             PIC  X(05)      VALUE LOW-VALUES.
   953     12  BUILD-LO-KEY.
   954         16  BLK-COMPANY     PIC  X(01).
   955         16  BLK-CARRIER     PIC  X(01).
   956         16  BLK-GROUPING    PIC  X(06).
   957         16  BLK-STATE       PIC  X(02).
   958         16  BLK-ACCT        PIC  X(10).
   959     12  TOT-COMM            PIC S9(11)V99  COMP-3.
   960     12  HOLD-PROCESS-MO-YR.
   961         16  HOLD-PROCESS-CC PIC  XX.
   962         16  HOLD-PROCESS-YR PIC  XX.
   963         16  HOLD-PROCESS-MO PIC  XX.
   964     12  WS-PEND-YRMODA      PIC 9(11).
   965     12  WS-PEND-YRMODA-R REDEFINES WS-PEND-YRMODA.
   966         16  FILLER          PIC  9(03).
   967         16  PEND-CC         PIC  9(02).
   968         16  PEND-YR         PIC  9(02).
   969         16  PEND-MO         PIC  9(02).
   970         16  PEND-DA         PIC  9(02).
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  26
* EL539.cbl
   972 01  CONAMREC.
   973     12  CONA-LOVAL          PIC  X(20).
   974     12  CONA-NAME           PIC  X(30).
   975     12  CONA-ANDT           PIC  X(18).
   976
   977 01  ACCT-REC.
   978     12  ACCT-INFO.
   979         16  ACCT-CO         PIC  X(01).
   980         16  ACCT-CARR       PIC  X(01).
   981         16  ACCT-GRP        PIC  X(06).
   982         16  ACCT-ST         PIC  X(02).
   983         16  ACCT-NUM        PIC  X(10).
   984     12  ACCT-LOVAL          PIC  X(05).
   985     12  ACCT-NAME           PIC  X(30).
   986     12  ACCT-PERSON         PIC  X(20).
   987     12  ACCT-ADDR1          PIC  X(20).
   988     12  ACCT-CTY-ST         PIC  X(20).
   989     12  ACCT-ZIP.
   990         16  ACCT-ZIP-PRIME  PIC  X(05).
   991         16  ACCT-ZIP-PLUS4  PIC  X(04).
   992     12  ACCT-CANADIAN-POSTAL-CODE REDEFINES ACCT-ZIP.
   993         16  ACCT-CAN-POSTAL-CODE-1.
   994             20  FILLER      PIC  X(01).
   995                 88 ACCT-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
   996             20  FILLER      PIC  X(02).
   997         16  ACCT-CAN-POSTAL-CODE-2
   998                             PIC  X(03).
   999         16  ACCT-CAN-FILLER PIC  X(03).
  1000
  1001 01  LN-REC.
  1002     12  LN-CO               PIC  X(01).
  1003     12  LN-CARR             PIC  X(01).
  1004     12  LN-GRP              PIC  X(06).
  1005     12  LN-ST               PIC  X(02).
  1006     12  LN-ACCT             PIC  X(10).
  1007     12  LN-OFFCODE          PIC  X(05).
  1008     12  LN-LOVAL            PIC  X(06).
  1009     12  LN-OFFCR            PIC  X(30).
  1010     12  LN-OPT1             PIC  X(01).
  1011     12  LN-OPT2             PIC  X(01).
  1012
  1013 01  PEND-REC.
  1014     12  PEND-CO             PIC  X(01).
  1015     12  PEND-CARR           PIC  X(01).
  1016     12  PEND-GRP            PIC  X(06).
  1017     12  PEND-ST             PIC  X(02).
  1018     12  PEND-ACCT           PIC  X(10).
  1019     12  PEND-OFFICER        PIC  X(05).
  1020     12  PEND-YRMODA         PIC  9(11)  COMP-3.
  1021     12  PEND-CERT-PRIME     PIC  X(10).
  1022     12  PEND-CERT-SFX       PIC  X(01).
  1023     12  PEND-NAME           PIC  X(15).
  1024     12  PEND-INIT           PIC  X(02).
  1025     12  PEND-AGE            PIC  9(02).
  1026     12  PEND-LF-TYP         PIC  X(03).
  1027     12  PEND-LF-PRM         PIC S9(07)V99   COMP-3.
  1028     12  PEND-LF-COM         PIC S9(07)V99   COMP-3.
  1029     12  PEND-LF-AMT         PIC S9(09)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  27
* EL539.cbl
  1030     12  PEND-AH-TYP         PIC  X(03).
  1031     12  PEND-AH-PRM         PIC S9(07)V99   COMP-3.
  1032     12  PEND-AH-AMT         PIC S9(09)V99   COMP-3.
  1033     12  PEND-AH-COM         PIC S9(07)V99   COMP-3.
  1034     12  PEND-LF-TERM        PIC S9(03)      COMP-3.
  1035     12  PEND-AH-TERM        PIC S9(03)      COMP-3.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  28
* EL539.cbl
  1037 01  HD-1.
  1038     12  FILLER              PIC  X(46)          VALUE SPACES.
  1039     12  FILLER              PIC  X(31)          VALUE
  1040             'LOAN PRODUCTION AND PENETRATION'.
  1041     12  FILLER              PIC  X(42)          VALUE SPACES.
  1042     12  FILLER              PIC  X(06)          VALUE 'EL539'.
  1043
  1044 01  HD-2.
  1045     12  FILLER              PIC  X(48)          VALUE SPACES.
  1046     12  HD2-CO              PIC  X(30).
  1047     12  FILLER              PIC  X(41)          VALUE SPACES.
  1048     12  HD2-RUN             PIC  X(08).
  1049
  1050 01  HD-3.
  1051     12  FILLER              PIC  X(54)          VALUE SPACES.
  1052     12  HD3-DATE            PIC  X(18).
  1053     12  FILLER              PIC  X(47)          VALUE SPACES.
  1054     12  FILLER              PIC  X(05)          VALUE 'PAGE '.
  1055     12  HD3-PG              PIC ZZZ,ZZ9.
  1056
  1057 01  HD-4.
  1058     12  FILLER              PIC  X(24)          VALUE
  1059             'CARR  GROUP ST  ACCOUNT'.
  1060
  1061 01  HD-5.
  1062     12  FILLER              PIC  X(02)          VALUE SPACE.
  1063     12  H5-CARR             PIC  X(01).
  1064     12  FILLER              PIC  X(02)          VALUE SPACE.
  1065     12  H5-GRP              PIC  X(06).
  1066     12  FILLER              PIC  X(01)          VALUE SPACE.
  1067     12  H5-ST               PIC  X(02).
  1068     12  FILLER              PIC  X(01)          VALUE SPACE.
  1069     12  H5-ACCT             PIC  X(10).
  1070
  1071 01  HD-6.
  1072     12  H6-NA               PIC  X(30).
  1073     12  FILLER              PIC  X(27)          VALUE SPACES.
  1074     12  H6-DS               PIC  X(19).
  1075
  1076 01  HD-7.
  1077     12  H7-NA               PIC  X(30).
  1078     12  FILLER              PIC  X(27)          VALUE SPACES.
  1079     12  FILLER              PIC  X(19)          VALUE
  1080             '-------------------'.
  1081
  1082 01  HD-8.
  1083     12  H8-NA               PIC  X(30).
  1084
  1085 01  HD-9.
  1086     12  H9-NA               PIC  X(30).
  1087     12  H9-ZIP.
  1088         16  H9-ZIP-PRIME    PIC  X(05).
  1089         16  H9-DASH         PIC  X(01).
  1090         16  H9-ZIP-PLUS4    PIC  X(04).
  1091     12  H9-CANADIAN-POSTAL-CODE REDEFINES H9-ZIP.
  1092         16  H9-CAN-POSTAL-CODE-1
  1093                             PIC  X(03).
  1094         16  H9-DASH-CAN     PIC  X(01).
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  29
* EL539.cbl
  1095         16  H9-CAN-POSTAL-CODE-2
  1096                             PIC  X(03).
  1097         16  H9-CAN-FILLER   PIC  X(03).
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  30
* EL539.cbl
  1099 01  HD-10.
  1100     12  H10-LOF             PIC  X(05).
  1101     12  H10-DSH             PIC  X(01).
  1102     12  H10-LONAME          PIC  X(20).
  1103
  1104 01  HD-11.
  1105     12  FILLER              PIC  X(44)          VALUE
  1106             'CERTIFICATE  EFFECTIVE     INSURED          '.
  1107     12  FILLER              PIC  X(15)          VALUE
  1108             '-------------  '.
  1109     12  H11-LF              PIC  X(06).
  1110     12  FILLER              PIC  X(33)          VALUE
  1111             '  --------------  -------------  '.
  1112     12  H11-AH              PIC  X(06).
  1113     12  FILLER              PIC  X(17)          VALUE
  1114             '  -------------- '.
  1115
  1116 01  HD-12.
  1117     12  FILLER              PIC  X(44)          VALUE
  1118             'NUMBER          DATE        NAME       AGE T'.
  1119     12  FILLER              PIC  X(44)          VALUE
  1120             'ERM TYPE   PREM/REFUND       LIFE BEN  TERM '.
  1121     12  FILLER              PIC  X(34)          VALUE
  1122             'TYPE  PREM/REFUND        A&H BEN  '.
  1123     12  HD9-VAR             PIC  X(10).
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  31
* EL539.cbl
  1125 01  DT-1.
  1126     12  D1-CERT-PRIME       PIC  X(10).
  1127     12  FILLER              PIC  X(01).
  1128     12  D1-CERT-SFX         PIC  X(01).
  1129     12  FILLER              PIC  X(01).
  1130     12  D1-EFF.
  1131         16  D1-EFMO         PIC  9(02).
  1132         16  D1-SL1          PIC  X(01).
  1133         16  D1-EFDA         PIC  9(02).
  1134         16  D1-SL2          PIC  X(01).
  1135         16  D1-EFYR         PIC  9(02).
  1136     12  FILLER              PIC  X(01).
  1137     12  D1-NAME             PIC  X(14).
  1138     12  FILLER              PIC  X(01).
  1139     12  D1-INIT             PIC  X(01).
  1140     12  FILLER              PIC  X(01).
  1141     12  D1-AGE              PIC  9(02).
  1142     12  FILLER              PIC  X(02).
  1143     12  D1-LF-TERM          PIC ZZ9-            BLANK WHEN ZERO.
  1144     12  FILLER              PIC  X(01).
  1145     12  D1-LTYP             PIC  X(03).
  1146     12  FILLER              PIC  X(01).
  1147     12  D1-LPRM             PIC ZZ,ZZZ,ZZZ.99-  BLANK WHEN ZERO.
  1148     12  FILLER              PIC  X(01).
  1149     12  D1-LBEN             PIC ZZZ,ZZZ,ZZZ.99- BLANK WHEN ZERO.
  1150     12  FILLER              PIC  X(01).
  1151     12  D1-AH-TERM          PIC ZZ9-            BLANK WHEN ZERO.
  1152     12  FILLER              PIC  X(01).
  1153     12  D1-HTYP             PIC  X(03).
  1154     12  FILLER              PIC  X(01).
  1155     12  D1-HPRM             PIC Z,ZZZ,ZZZ.99-   BLANK WHEN ZERO.
  1156*    12  FILLER              PIC  X(01).
  1157     12  D1-HBEN             PIC ZZZ,ZZZ,ZZZ.99- BLANK WHEN ZERO.
  1158     12  D1-COMM             PIC ZZZZ,ZZZ.99-    BLANK WHEN ZERO.
  1159
  1160 01  SUM-HD1.
  1161     12  FILLER              PIC  X(44)          VALUE
  1162             '                        ----- LOANS ----- --'.
  1163     12  FILLER              PIC  X(18)          VALUE
  1164             '----------------- '.
  1165     12  SUM-HD1-LF          PIC  X(06).
  1166     12  FILLER              PIC  X(37)          VALUE
  1167             ' ----------------- ------------------'.
  1168     12  SUM-HD1-AH          PIC  X(06).
  1169     12  FILLER              PIC  X(21)          VALUE
  1170             '  ------------------ '.
  1171
  1172 01  SUM-HD2.
  1173     12  FILLER              PIC X(44)           VALUE
  1174             'CODE  NAME              COUNT     AMOUNT  CO'.
  1175     12  FILLER              PIC X(44)           VALUE
  1176             'UNT   PCT       BENEFIT   PCT     PREM/REF C'.
  1177     12  FILLER              PIC X(44)           VALUE
  1178             'OUNT   PCT       BENEFIT   PCT     PREM/REF '.
  1179
  1180 01  UNASSIGN-LINE-1.
  1181     12  FILLER                  PIC X(6)       VALUE SPACES.
  1182     12  FILLER                  PIC X(125)     VALUE
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  32
* EL539.cbl
  1183       'The unassigned or XXX - Loan officer code missing on this
  1184-      'report reflect certificates without valid codes or the cod
  1185-      'e has not'.
  1186
  1187 01  UNASSIGN-LINE-2.
  1188     12  FILLER                  PIC XX         VALUE SPACES.
  1189     12  FILLER                  PIC X(125)     VALUE
  1190       'been provided to CSO.  To correct this for future reports
  1191-      'contact your CSO Customer Service Representative at 1-800-
  1192-      '826-6587.'.
  1193
  1194 01  MESS-LINE-1.
  1195     12  FILLER                  PIC X(6)       VALUE SPACES.
  1196     12  FILLER                  PIC X(109)     VALUE
  1197       'To ensure accuracy of the report, the loan officers code m
  1198-      'ust be placed in the upper left hand corner of each'.
  1199
  1200 01  MESS-LINE-2.
  1201     12  FILLER                  PIC XX         VALUE SPACES.
  1202     12  FILLER                  PIC X(29)      VALUE
  1203       'certificate submitted to CSO.'.
  1204
  1205 01  DISC-LINE-1.
  1206     12  FILLER                  PIC X(6)       VALUE SPACES.
  1207     12  FILLER                  PIC X(126)     VALUE
  1208       'Just a reminder, if you are using the reports to pay compe
  1209-      'nsation to those people listed, they must be licensed '.
  1210
  1211 01  DISC-LINE-2.
  1212     12  FILLER                  PIC XX         VALUE SPACES.
  1213     12  FILLER                  PIC X(130)     VALUE
  1214       'and appointed with CSO if applicable in your state. To det
  1215-      'ermine who is licensed and appointed with CSO, please '.
  1216
  1217 01  DISC-LINE-3.
  1218     12  FILLER                  PIC XX         VALUE SPACES.
  1219     12  FILLER                  PIC X(130)     VALUE
  1220       'contact our Licensing Department at 1-800-826-6587.'.
  1221
  1222 01  SUM-DT.
  1223     12  SD-CODE             PIC  X(05).
  1224     12  SD-DASH             PIC  X(01).
  1225     12  SD-NAME             PIC  X(20).
  1226     12  SD-LNCT             PIC ZZZZZ-.
  1227     12  SD-LNAMT            PIC ZZZ,ZZZ,ZZZ-.
  1228     12  SD-LICT             PIC ZZZZZ-.
  1229     12  SD-LCCT             PIC ZZZ.Z-.
  1230     12  SD-LBEN             PIC ZZ,ZZZ,ZZZ.ZZ-.
  1231     12  SD-BPCT             PIC ZZZ.Z-.
  1232     12  SD-LPRM             PIC ZZZZ,ZZZ.ZZ-.
  1233     12  SD-DICT             PIC ZZZZZ-.
  1234     12  SD-DCPC             PIC ZZZ.Z-.
  1235     12  SD-DBEN             PIC ZZ,ZZZ,ZZZ.ZZ-.
  1236     12  SD-DBPC             PIC ZZZ.Z-.
  1237     12  SD-DPRM             PIC ZZZZ,ZZZ.ZZ-.
  1238
  1239 01  FILLER                  PIC  X(16)          VALUE
  1240         'TABLE BEGIN HERE'.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  33
* EL539.cbl
  1241 01  TBL.
  1242     12  TBL-CTL.
  1243         16  TBL-CO          PIC  X(01).
  1244         16  TBL-CARR        PIC  X(01).
  1245         16  TBL-GRP         PIC  X(06).
  1246         16  TBL-ST          PIC  X(02).
  1247         16  TBL-ACCT        PIC  X(10).
  1248     12  TBL-NAME            PIC  X(20).
  1249     12  TBL-MAIL1           PIC  X(20).
  1250     12  TBL-MAIL2           PIC  X(20).
  1251     12  TBL-MAIL3           PIC  X(20).
  1252     12  TBL-ZIP.
  1253         16  TBL-ZIP-PRIME   PIC  9(05).
  1254         16  TBL-ZIP-PLUS4   PIC  9(04).
  1255     12  TBL-CANADIAN-POSTAL-CODE REDEFINES TBL-ZIP.
  1256         16  TBL-CAN-POSTAL-CODE-1
  1257                             PIC  X(03).
  1258         16  TBL-CAN-POSTAL-CODE-2
  1259                             PIC  X(03).
  1260         16  TBL-CAN-FILLER PIC   X(03).
  1261     12  TBL-ENT         OCCURS  201  TIMES.
  1262         16  TBL-CODE        PIC  X(05).
  1263         16  TBL-LO-NAME     PIC  X(30).
  1264         16  TBL-LICT        PIC S9(05)      COMP-3.
  1265         16  TBL-LBEN        PIC S9(09)V99   COMP-3.
  1266         16  TBL-LPRM        PIC S9(07)V99   COMP-3.
  1267         16  TBL-LCCT        PIC S9(05)      COMP-3.
  1268         16  TBL-LREF        PIC S9(07)V99   COMP-3.
  1269         16  TBL-LCOM        PIC S9(07)V99   COMP-3.
  1270         16  TBL-LOCT        PIC S9(5)       COMP-3.
  1271         16  TBL-LVOL        PIC S9(9)V99    COMP-3.
  1272         16  TBL-DICT        PIC S9(05)      COMP-3.
  1273         16  TBL-DBEN        PIC S9(09)V99   COMP-3.
  1274         16  TBL-DPRM        PIC S9(07)V99   COMP-3.
  1275         16  TBL-DCCT        PIC S9(05)      COMP-3.
  1276         16  TBL-DREF        PIC S9(07)V99   COMP-3.
  1277         16  TBL-DCOM        PIC S9(07)V99   COMP-3.
  1278     12  FIN-ENT.
  1279         16  FIN-LICT        PIC S9(07)     VALUE +0 COMP-3.
  1280         16  FIN-LBEN        PIC S9(11)V99  VALUE +0 COMP-3.
  1281         16  FIN-LPRM        PIC S9(09)V99  VALUE +0 COMP-3.
  1282         16  FIN-LCCT        PIC S9(07)     VALUE +0 COMP-3.
  1283         16  FIN-LREF        PIC S9(09)V99  VALUE +0 COMP-3.
  1284         16  FIN-LCOM        PIC S9(09)V99  VALUE +0 COMP-3.
  1285         16  FIN-LOCT        PIC S9(7)      VALUE +0 COMP-3.
  1286         16  FIN-LVOL        PIC S9(11)V99  VALUE +0 COMP-3.
  1287         16  FIN-DICT        PIC S9(07)     VALUE +0 COMP-3.
  1288         16  FIN-DBEN        PIC S9(11)V99  VALUE +0 COMP-3.
  1289         16  FIN-DPRM        PIC S9(09)V99  VALUE +0 COMP-3.
  1290         16  FIN-DCCT        PIC S9(07)     VALUE +0 COMP-3.
  1291         16  FIN-DREF        PIC S9(09)V99  VALUE +0 COMP-3.
  1292         16  FIN-DCOM        PIC S9(09)V99  VALUE +0 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  34
* EL539.cbl
* 1294     COPY ERCEXTR.
  1295******************************************************************04/29/98
  1296*                                                                *ERCEXTR
  1297*                                                                *ERCEXTR
  1298*                            ERCEXTR                             *   LV002
  1299*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  1300*                            VMOD=2.003                          *   CL**2
  1301*                                                                *ERCEXTR
  1302*   FILE DESCRIPTION = ONLINE TO BATCH FILE INTERFACE AND REPORT *ERCEXTR
  1303*                      EXTRACT FOR OFFLINE REPORTING.            *ERCEXTR
  1304*                                                                *ERCEXTR
  1305*     THIS FILE IS CREATED DURING NIGHT-TIME PROCESSING (EL520). *ERCEXTR
  1306*  IT CONTAINS SEVERAL DIFFERENT SORT KEYS AND DATA FORMATS IN   *ERCEXTR
  1307*  ORDER TO SATISFY VARYING INPUT REQUIREMENTS.                  *ERCEXTR
  1308*                                                                *ERCEXTR
  1309* EXTRACT RECORD   SORT                                    POSI  *ERCEXTR
  1310*  CODE    TYPE    CODE  PROGRAM USING                     CODE  *ERCEXTR
  1311* ------ --------  ----  --------------------------------  ----  *ERCEXTR
  1312*   A       A       A     EL520  PENDING BUSINESS EXTRACT    1   *ERCEXTR
  1313*           B       A     EL520  PENDING CLAIMS   EXTRACT    1   *ERCEXTR
  1314*           C       A     EL520  CERT CHANGES     EXTRACT    1   *ERCEXTR
  1315*           D       B     EL520  PMTS/ADJUSTMENTS EXTRACT    1   *ERCEXTR
  1316*           E       D     EL520  RETRO/EPEC ADJ   EXTRACT    1   *ERCEXTR
  1317*           F       C     EL520  REQUEST FILE     EXTRACT    1   *ERCEXTR
  1318*   B       A       E     EL528  CRPNDB O/B RPT   EXTRACT    2    ERCEXTR
  1319*           B       E     EL529  CRPNDB ERRORS    EXTRACT    2    ERCEXTR
  1320*                                                                *ERCEXTR
  1321* -------------------------------------------------------------- *ERCEXTR
  1322*                                                                *ERCEXTR
  1323*   FILE TYPE = SEQUENTIAL                                       *ERCEXTR
  1324*   RECORD SIZE = 629   RECFORM = FIX                            *ERCEXTR
  1325*                                                                *ERCEXTR
  1326*   FILENAME = EREXTR                                            *ERCEXTR
  1327*                                                                *ERCEXTR
  1328******************************************************************ERCEXTR
  1329                                                                  ERCEXTR
  1330 01  EXTRACT-INTERFACE-RECORD.                                    ERCEXTR
  1331     12  EX-RECORD-ID                        PIC XX.              ERCEXTR
  1332         88  VALID-IN-ID                           VALUE 'EX'.    ERCEXTR
  1333                                                                  ERCEXTR
  1334     12  EX-SORT-KEY-AREAS.                                       ERCEXTR
  1335         16  EX-POSITIONING-CODE             PIC X.               ERCEXTR
  1336             88  FRONT-OF-FILE                     VALUE '0'.     ERCEXTR
  1337             88  BACK-OF-FILE                      VALUE '9'.     ERCEXTR
  1338         16  EX-EXTRACT-CODE                 PIC X.               ERCEXTR
  1339         16  EX-COMPANY-CD                   PIC X.               ERCEXTR
  1340         16  EX-COMPANY-ID                   PIC XXX.             ERCEXTR
  1341         16  EX-RECORD-TYPE                  PIC X.               ERCEXTR
  1342                                                                  ERCEXTR
  1343         16  EX-VARIABLE-ASCENDING-KEYS      PIC X(35).           ERCEXTR
  1344                                                                  ERCEXTR
  1345         16  EX-SORT-KEY-A  REDEFINES EX-VARIABLE-ASCENDING-KEYS. ERCEXTR
  1346             20  EX-SA-CARRIER               PIC X.               ERCEXTR
  1347             20  EX-SA-GROUPING              PIC X(6).            ERCEXTR
  1348             20  EX-SA-STATE                 PIC XX.              ERCEXTR
  1349             20  EX-SA-ACCOUNT               PIC X(10).           ERCEXTR
  1350             20  EX-SA-CERT-EFF-DT           PIC XX.              ERCEXTR
  1351             20  EX-SA-CERT-NO.                                   ERCEXTR
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  35
* EL539.cbl (/apps/prod/cid1p/copy/ERCEXTR)
  1352                 24  EX-SA-CERT-PRIME        PIC X(10).           ERCEXTR
  1353                 24  EX-SA-CERT-SFX          PIC X.               ERCEXTR
  1354             20  EX-SA-RECORD-TYPE           PIC X.               ERCEXTR
  1355             20  FILLER                      PIC XX.              ERCEXTR
  1356                                                                  ERCEXTR
  1357         16  EX-SORT-KEY-B  REDEFINES EX-VARIABLE-ASCENDING-KEYS. ERCEXTR
  1358             20  EX-SB-CARRIER               PIC X.               ERCEXTR
  1359             20  EX-SB-GROUPING              PIC X(6).            ERCEXTR
  1360             20  EX-SB-FIN-RESP              PIC X(10).           ERCEXTR
  1361             20  EX-SB-ACCOUNT               PIC X(10).           ERCEXTR
  1362             20  EX-SB-FILE-SEQ-NO           PIC S9(8) COMP.      ERCEXTR
  1363             20  EX-SB-RECORD-TYPE           PIC X.               ERCEXTR
  1364             20  FILLER                      PIC X(3).            ERCEXTR
  1365                                                                  ERCEXTR
  1366         16  EX-SORT-KEY-C  REDEFINES EX-VARIABLE-ASCENDING-KEYS. ERCEXTR
  1367             20  EX-SC-CONTROL-NO            PIC S9(8) COMP.      ERCEXTR
  1368             20  EX-SC-SEQUENCE-NO           PIC S9(4) COMP.      ERCEXTR
  1369             20  FILLER                      PIC X(29).           ERCEXTR
  1370                                                                  ERCEXTR
  1371         16  EX-SORT-KEY-D  REDEFINES EX-VARIABLE-ASCENDING-KEYS. ERCEXTR
  1372             20  EX-SD-CARRIER               PIC X.               ERCEXTR
  1373             20  EX-SD-GROUPING              PIC X(6).            ERCEXTR
  1374             20  EX-SD-STATE                 PIC X(2).            ERCEXTR
  1375             20  EX-SD-ACCOUNT               PIC X(10).           ERCEXTR
  1376             20  EX-SD-FILE-SEQ-NO           PIC S9(8) COMP.      ERCEXTR
  1377             20  EX-SD-RECORD-TYPE           PIC X.               ERCEXTR
  1378             20  FILLER                      PIC X(11).           ERCEXTR
  1379                                                                  ERCEXTR
  1380         16  EX-SORT-KEY-E  REDEFINES EX-VARIABLE-ASCENDING-KEYS. ERCEXTR
  1381             20  EX-SE-CARRIER               PIC X.               ERCEXTR
  1382             20  EX-SE-GROUPING              PIC X(6).            ERCEXTR
  1383             20  EX-SE-STATE                 PIC XX.              ERCEXTR
  1384             20  EX-SE-ACCOUNT               PIC X(10).           ERCEXTR
  1385             20  EX-SE-BATCH-NO              PIC X(6).            ERCEXTR
  1386             20  EX-SE-RECORD-TYPE           PIC X.               ERCEXTR
  1387             20  FILLER                      PIC X(9).            ERCEXTR
  1388                                                                  ERCEXTR
  1389         16  EX-SORT-KEY-F  REDEFINES EX-VARIABLE-ASCENDING-KEYS. ERCEXTR
  1390             20  EX-SF-ENTRY-BATCH           PIC X(6).            ERCEXTR
  1391             20  FILLER                      PIC X(29).           ERCEXTR
  1392                                                                  ERCEXTR
  1393******************************************************************ERCEXTR
  1394                                                                  ERCEXTR
  1395     12  EX-DATA-AREAS                       PIC X(585).          ERCEXTR
  1396                                                                  ERCEXTR
  1397******************************************************************ERCEXTR
  1398                                                                  ERCEXTR
  1399     12  EX-EXTRACT-B-RECORD-B REDEFINES EX-DATA-AREAS.           ERCEXTR
  1400         16  EX-BB-ISS-TOTAL-CNT             PIC S9(5).           ERCEXTR
  1401         16  EX-BB-ISS-AVAIL-CNT             PIC S9(5).           ERCEXTR
  1402         16  EX-BB-ISS-FATAL-CNT             PIC S9(5).           ERCEXTR
  1403         16  EX-BB-ISS-FORCE-CNT             PIC S9(5).           ERCEXTR
  1404         16  EX-BB-ISS-HOLD-CNT              PIC S9(5).           ERCEXTR
  1405         16  EX-BB-ISS-GOOD-PREM             PIC S9(9)V99.        ERCEXTR
  1406         16  EX-BB-ISS-BAD-PREM              PIC S9(9)V99.        ERCEXTR
  1407         16  EX-BB-CAN-TOTAL-CNT             PIC S9(5).           ERCEXTR
  1408         16  EX-BB-CAN-AVAIL-CNT             PIC S9(5).           ERCEXTR
  1409         16  EX-BB-CAN-FATAL-CNT             PIC S9(5).           ERCEXTR
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  36
* EL539.cbl (/apps/prod/cid1p/copy/ERCEXTR)
  1410         16  EX-BB-CAN-FORCE-CNT             PIC S9(5).           ERCEXTR
  1411         16  EX-BB-CAN-HOLD-CNT              PIC S9(5).           ERCEXTR
  1412         16  EX-BB-CAN-GOOD-PREM             PIC S9(9)V99.        ERCEXTR
  1413         16  EX-BB-CAN-BAD-PREM              PIC S9(9)V99.        ERCEXTR
  1414         16  FILLER                          PIC X(491).          ERCEXTR
  1415                                                                  ERCEXTR
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  37
* EL539.cbl
* 1417     COPY ERCPNDB.
  1418******************************************************************
  1419*                                                                *
  1420*                                                                *
  1421*                            ERCPNDB.                            *
  1422*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1423*                            VMOD=2.025                          *
  1424*                                                                *
  1425*   FILE DESCRIPTION = PENDING NEW BUSINESS (ISSUES AND CANCELS) *
  1426*                                                                *
  1427******************************************************************
  1428*   NOTE: IF THIS FORMAT IS CHANGED, THE SORT RECORD IN THE      *
  1429*         EL861 A/R SYSTEM MAY NEED TO BE CHANGED.               *
  1430******************************************************************
  1431*                                                                *
  1432*                                                                *
  1433*   FILE TYPE = VSAM,KSDS                                        *
  1434*   RECORD SIZE = 585  RECFORM = FIXED                           *
  1435*                                                                *
  1436*   BASE CLUSTER = ERPNDB                         RKP=2,LEN=11   *
  1437*       ALTERNATE PATH1 = ERPNDB2  (BY CAR GRP STATE ACCOUNT     *
  1438*                                  EFF-DT CERT CHG-SEQ REC-TYPE) *
  1439*                                                 RKP=13,LEN=36  *
  1440*       ALTERNATE PATH2 = ERPNDB3  (BY CO, ORIGINAL BATCH, SEQ.  *
  1441*                                      AND CHG-SEQ.)             *
  1442*                                                RKP=49,LEN=11   *
  1443*       ALTERNATE PATH3 = ERPNDB4  (BY CO, CSR-ID, BATCH, SEQ.   *
  1444*                                      AND CHG-SEQ.)             *
  1445*                                                RKP=60,LEN=15   *
  1446*                                                                *
  1447*   LOG = NO                                                     *
  1448*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1449******************************************************************
  1450******************************************************************
  1451*                   C H A N G E   L O G
  1452*
  1453* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1454*-----------------------------------------------------------------
  1455*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1456* EFFECTIVE    NUMBER
  1457*-----------------------------------------------------------------
  1458* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  1459* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  1460* 011904                   PEMA  ADD TOTAL FEE PROCESSING
  1461* 040504    2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  1462* 020305    2005020000000  PEMA  ADD CLP STATE TO PNDB RECORD
  1463* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  1464* 032306                   PEMA  ADD BOW LOAN NUMBER
  1465* 081606    2006080800002  PEMA  ADD VIN, ISSUES ONLY
  1466* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
  1467* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  1468* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  1469* 032109    2009021700002  PEMA  ADD CRED BENE TO PNDB REC
  1470* 072209  CR2008101500003  AJRA  ADD BORROWER FIRST NAME TO ENDORSEMENT
  1471* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  1472* 071211  CR2010012700001  PEMA  ADD SPP DEALER DIRECT
  1473* 073114  CR2014012300001  PEMA  ADD CU CARRIER 7 PROCESSING
  1474******************************************************************
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  38
* EL539.cbl (/apps/prod/cid1p/copy/ERCPNDB)
  1475
  1476 01  PENDING-BUSINESS.
  1477     12  PB-RECORD-ID                     PIC XX.
  1478         88  VALID-PB-ID                        VALUE 'PB'.
  1479
  1480     12  PB-CONTROL-PRIMARY.
  1481         16  PB-COMPANY-CD                PIC X.
  1482         16  PB-ENTRY-BATCH               PIC X(6).
  1483         16  PB-BATCH-SEQ-NO              PIC S9(4)     COMP.
  1484         16  PB-BATCH-CHG-SEQ-NO          PIC S9(4)     COMP.
  1485
  1486     12  PB-CONTROL-BY-ACCOUNT.
  1487         16  PB-COMPANY-CD-A1             PIC X.
  1488         16  PB-CARRIER                   PIC X.
  1489         16  PB-GROUPING.
  1490             20  PB-GROUPING-PREFIX       PIC XXX.
  1491             20  PB-GROUPING-PRIME        PIC XXX.
  1492         16  PB-STATE                     PIC XX.
  1493         16  PB-ACCOUNT.
  1494             20  PB-ACCOUNT-PREFIX        PIC X(4).
  1495             20  PB-ACCOUNT-PRIME         PIC X(6).
  1496         16  PB-CERT-EFF-DT               PIC XX.
  1497         16  PB-CERT-NO.
  1498             20  PB-CERT-PRIME            PIC X(10).
  1499             20  PB-CERT-SFX              PIC X.
  1500         16  PB-ALT-CHG-SEQ-NO            PIC S9(4)     COMP.
  1501
  1502         16  PB-RECORD-TYPE               PIC X.
  1503             88  PB-MAILING-DATA                VALUE '0'.
  1504             88  PB-ISSUE                       VALUE '1'.
  1505             88  PB-CANCELLATION                VALUE '2'.
  1506             88  PB-BATCH-TRAILER               VALUE '9'.
  1507
  1508     12  PB-CONTROL-BY-ORIG-BATCH.
  1509         16  PB-ORIGINAL-COMPANY-CD       PIC X.
  1510         16  PB-ORIGINAL-ENTRY-BATCH      PIC X(6).
  1511         16  PB-ORIGINAL-SEQ-NO           PIC S9(4)     COMP.
  1512         16  PB-ORIGINAL-CHG-SEQ-NO       PIC S9(4)     COMP.
  1513
  1514     12  PB-CONTROL-BY-CSR.
  1515         16  PB-CSR-COMPANY-CD            PIC X.
  1516         16  PB-CSR-ID                    PIC X(4).
  1517         16  PB-CSR-ENTRY-BATCH           PIC X(6).
  1518         16  PB-CSR-BATCH-SEQ-NO          PIC S9(4)     COMP.
  1519         16  PB-CSR-BATCH-CHG-SEQ-NO      PIC S9(4)     COMP.
  1520******************************************************************
  1521*    MAILING DATA IS PROCESSED IN ONLY PRGS. EL512 & EL513       *
  1522******************************************************************
  1523
  1524     12  PB-LAST-MAINT-DT                 PIC XX.
  1525     12  PB-LAST-MAINT-BY                 PIC X(4).
  1526     12  PB-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.
  1527
  1528     12  PB-RECORD-BODY                   PIC X(375).
  1529
  1530     12  PB-ISSUE-RECORD   REDEFINES PB-RECORD-BODY.
  1531         16  PB-CERT-ORIGIN               PIC X.
  1532             88  CLASIC-CREATED-CERT         VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  39
* EL539.cbl (/apps/prod/cid1p/copy/ERCPNDB)
  1533         16  PB-I-NAME.
  1534             20  PB-I-INSURED-LAST-NAME   PIC X(15).
  1535             20  PB-I-INSURED-FIRST-NAME.
  1536                 24  PB-I-INSURED-1ST-INIT PIC X.
  1537                 24  FILLER                PIC X(9).
  1538             20  PB-I-INSURED-MIDDLE-INIT PIC X.
  1539         16  PB-I-AGE                     PIC S99   COMP-3.
  1540         16  PB-I-JOINT-AGE               PIC S99   COMP-3.
  1541         16  PB-I-BIRTHDAY                PIC XX.
  1542         16  PB-I-INSURED-SEX             PIC X.
  1543             88  PB-SEX-MALE     VALUE 'M'.
  1544             88  PB-SEX-FEMALE   VALUE 'F'.
  1545
  1546         16  PB-I-LF-TERM                 PIC S999   COMP-3.
  1547         16  PB-I-AH-TERM                 PIC S999   COMP-3.
  1548         16  PB-I-LOAN-TERM               PIC S999   COMP-3.
  1549         16  PB-I-PAY-FREQUENCY           PIC S99    COMP-3.
  1550         16  PB-I-SKIP-CODE               PIC X.
  1551             88  PB-NO-MONTHS-SKIPPED      VALUE ' ' '0'.
  1552             88  PB-SKIP-JULY              VALUE '1'.
  1553             88  PB-SKIP-AUGUST            VALUE '2'.
  1554             88  PB-SKIP-SEPTEMBER         VALUE '3'.
  1555             88  PB-SKIP-JULY-AUG          VALUE '4'.
  1556             88  PB-SKIP-AUG-SEPT          VALUE '5'.
  1557             88  PB-SKIP-JULY-AUG-SEPT     VALUE '6'.
  1558             88  PB-SKIP-JUNE-JULY-AUG     VALUE '7'.
  1559             88  PB-SKIP-JUNE              VALUE '8'.
  1560             88  PB-SKIP-JUNE-JULY         VALUE '9'.
  1561             88  PB-SKIP-AUG-SEPT-OCT      VALUE 'A'.
  1562             88  PB-SKIP-BI-WKLY-3RD-PMT   VALUE 'X'.
  1563         16  PB-I-TERM-TYPE               PIC X.
  1564             88  PB-PAID-MONTHLY           VALUE ' ' 'M'.
  1565             88  PB-PAID-WEEKLY            VALUE 'W'.
  1566             88  PB-PAID-SEMI-MONTHLY      VALUE 'S'.
  1567             88  PB-PAID-BI-WEEKLY         VALUE 'B'.
  1568             88  PB-PAID-13-YEARLY         VALUE 'T'.
  1569         16  PB-I-NO-OF-PAYMENTS          PIC S999   COMP-3.
  1570         16  PB-I-POLICY-FORM-NO          PIC X(12).
  1571         16  PB-I-DATA-ENTRY-SW           PIC X.
  1572             88  PB-EFF-DT-PROCESSING      VALUE '1' ' '.
  1573             88  PB-EXT-DAYS-PROCESSING    VALUE '2'.
  1574             88  PB-EXPIRE-DT-PROCESSING   VALUE '3'.
  1575             88  PB-1ST-PMT-DT-PROCESSING  VALUE '4'.
  1576         16  PB-I-PAYMENT-AMOUNT          PIC S9(7)V99  COMP-3.
  1577         16  PB-I-DCC-OVER-CHG-AMT        PIC S9(5)V99  COMP-3.
  1578*        16  PB-I-MICROFILM-NO            PIC S9(9)      COMP-3.
  1579         16  PB-I-AH-CLP                  PIC S9(5)V99 COMP-3.
  1580         16  FILLER                       PIC X.
  1581
  1582         16  PB-I-LIFE-BENEFIT-CD         PIC XX.
  1583             88  PB-VALID-LIFE               VALUE '01' THRU '89'.
  1584             88  PB-INVALID-LIFE             VALUE '  ' '00'
  1585                                                   '90' THRU '99'.
  1586         16  PB-I-LF-BENEFIT-CD   REDEFINES PB-I-LIFE-BENEFIT-CD
  1587                                          PIC XX.
  1588         16  PB-I-LF-BENEFIT-AMT          PIC S9(9)V99   COMP-3.
  1589         16  PB-I-AMOUNT-FINANCED REDEFINES
  1590                  PB-I-LF-BENEFIT-AMT     PIC S9(9)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  40
* EL539.cbl (/apps/prod/cid1p/copy/ERCPNDB)
  1591         16  PB-I-LF-ALT-BENEFIT-AMT      PIC S9(9)V99   COMP-3.
  1592         16  PB-I-UNPAID-CASH-PRICE REDEFINES
  1593                  PB-I-LF-ALT-BENEFIT-AMT PIC S9(9)V99   COMP-3.
  1594         16  PB-I-LF-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  1595         16  PB-I-LF-ALT-PREMIUM-AMT      PIC S9(7)V99   COMP-3.
  1596         16  PB-I-CLP-AMOUNT REDEFINES
  1597                  PB-I-LF-ALT-PREMIUM-AMT PIC S9(7)V99   COMP-3.
  1598         16  PB-I-LF-CALC-FLAG            PIC X.
  1599             88 PB-COMP-LF-PREM               VALUE '?'.
  1600         16  PB-I-LF-PREM-CALC            PIC S9(7)V99   COMP-3.
  1601         16  PB-I-LF-ALT-PREM-CALC        PIC S9(7)V99   COMP-3.
  1602         16  PB-I-LF-RATE                 PIC S99V9(5)   COMP-3.
  1603         16  PB-I-LF-ALT-RATE             PIC S99V9(5)   COMP-3.
  1604         16  PB-I-LF-POLICY-FEE           PIC S9(3)V99   COMP-3.
  1605         16  PB-I-LF-REI-RATE             PIC S99V9(5)   COMP-3.
  1606         16  PB-I-LF-ALT-REI-RATE         PIC S99V9(5)   COMP-3.
  1607         16  PB-I-LF-ABBR                 PIC XXX.
  1608         16  PB-I-LF-INPUT-CD             PIC XX.
  1609
  1610         16  PB-I-AH-BENEFIT-CD           PIC XX.
  1611             88  PB-VALID-AH                 VALUE '01' THRU '89'.
  1612             88  PB-INVALID-AH               VALUE '  ' '00'
  1613                                                   '90' THRU '99'.
  1614         16  PB-I-AH-BENEFIT-AMT          PIC S9(7)V99   COMP-3.
  1615         16  PB-I-AH-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  1616         16  PB-I-AH-CALC-FLAG            PIC X.
  1617             88 PB-COMP-AH-PREM                  VALUE '?'.
  1618         16  PB-I-AH-PREM-CALC            PIC S9(7)V99   COMP-3.
  1619         16  PB-I-AH-RATE                 PIC S99V9(5)   COMP-3.
  1620         16  PB-I-AH-POLICY-FEE           PIC S9(3)V99   COMP-3.
  1621         16  PB-I-AH-REI-RATE             PIC S99V9(5)   COMP-3.
  1622         16  PB-I-AH-RATE-TRM             PIC S999       COMP-3.
  1623         16  PB-I-AH-ABBR                 PIC XXX.
  1624         16  PB-I-AH-INPUT-CD             PIC XXX.
  1625
  1626         16  PB-I-SPECIAL-REIN-CODE       PIC X.
  1627         16  PB-I-REIN-TABLE              PIC XXX.
  1628         16  PB-I-BUSINESS-TYPE           PIC 99.
  1629         16  PB-I-INDV-GRP-CD             PIC X.
  1630         16  PB-I-MORT-CODE.
  1631             20  PB-I-TABLE               PIC X.
  1632             20  PB-I-INTEREST            PIC XX.
  1633             20  PB-I-MORT-TYP            PIC X.
  1634         16  PB-I-LF-CRIT-PER             PIC S9(3)      COMP-3.
  1635         16  PB-I-AH-CRIT-PER             PIC S9(3)      COMP-3.
  1636         16  PB-I-LF-CLP                  PIC S9(5)V99   COMP-3.
  1637         16  PB-I-INDV-GRP-OVRD           PIC X.
  1638         16  PB-I-RATE-CLASS-OVRD         PIC XX.
  1639         16  PB-I-SIG-SW                  PIC X.
  1640             88  PB-POLICY-SIGNED             VALUE 'Y'.
  1641         16  PB-I-RATE-CLASS              PIC XX.
  1642         16  PB-I-RATE-DEVIATION-LF       PIC XXX.
  1643         16  PB-I-RATE-DEVIATION-AH       PIC XXX.
  1644         16  PB-I-RATE-DEV-PCT-LF         PIC S9V9(6)    COMP-3.
  1645         16  PB-I-RATE-DEV-PCT-AH         PIC S9V9(6)    COMP-3.
  1646         16  PB-I-LIFE-COMMISSION         PIC SV9(5)     COMP-3.
  1647         16  PB-I-JOINT-COMMISSION        PIC SV9(5)     COMP-3.
  1648         16  PB-I-AH-COMMISSION           PIC SV9(5)     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  41
* EL539.cbl (/apps/prod/cid1p/copy/ERCPNDB)
  1649         16  PB-I-BENEFIT-TYPE            PIC XXX.
  1650         16  PB-I-OB-FLAG                 PIC X.
  1651             88  PB-I-OB                      VALUE 'B'.
  1652             88  PB-I-SUMMARY                 VALUE 'Z'.
  1653         16  PB-I-ENTRY-STATUS            PIC X.
  1654             88  PB-I-POLICY-IS-ACTIVE        VALUE '1' '3' '4'
  1655                                              'M' '5' '9' '2'.
  1656             88  PB-I-NORMAL-ENTRY            VALUE '1'.
  1657             88  PB-I-POLICY-PENDING          VALUE '2'.
  1658             88  PB-I-CONVERSION-ENTRY        VALUE '4'.
  1659             88  PB-I-POLICY-IS-REISSUE       VALUE '5'.
  1660             88  PB-I-POLICY-IS-CASH          VALUE 'C'.
  1661             88  PB-I-POLICY-IS-MONTHLY       VALUE 'M'.
  1662             88  PB-I-REIN-ONLY               VALUE '9'.
  1663             88  PB-I-POLICY-IS-DECLINED      VALUE 'D'.
  1664             88  PB-I-POLICY-IS-VOIDED        VALUE 'V'.
  1665             88  PB-I-PREM-ACCTNG-ONLY        VALUE 'P'.
  1666             88  PB-I-UNDERWRITE-POLICY       VALUE 'U'.
  1667         16  PB-I-INT-CODE                PIC X.
  1668             88  PB-ADD-ON-INTEREST           VALUE 'A'.
  1669             88  PB-SIMPLE-INTEREST           VALUE 'S'.
  1670         16  PB-I-LOAN-APR                PIC 9(3)V9(4)   COMP-3.
  1671         16  PB-I-SOC-SEC-NO              PIC X(11).
  1672         16  PB-I-MEMBER-NO               PIC X(12).
  1673         16  PB-I-CURR-SEQ                PIC S9(4)       COMP.
  1674*        16  PB-I-LOAN-OFFICER            PIC XXX.
  1675         16  PB-I-OLD-LOF                 PIC XXX.
  1676         16  PB-I-LF-EXPIRE-DT            PIC XX.
  1677         16  PB-I-AH-EXPIRE-DT            PIC XX.
  1678         16  PB-I-EXTENTION-DAYS          PIC S999        COMP-3.
  1679         16  PB-I-TERM-IN-DAYS            PIC S9(5)       COMP-3.
  1680         16  PB-I-LIFE-INDICATOR          PIC X.
  1681             88  PB-I-JOINT-COVERAGE         VALUE 'J'.
  1682         16  PB-I-LIVES                   PIC S9(7)       COMP-3.
  1683         16  PB-I-DDF-IU-RATE-UP REDEFINES PB-I-LIVES
  1684                                          PIC S9(5)V99    COMP-3.
  1685         16  PB-I-MAIL-ADDRS-SW           PIC X.
  1686             88 PB-I-MAIL-ADDRS-NOT-PRESENT  VALUE ' '.
  1687             88 PB-I-MAIL-ADDRS-PRESENT      VALUE '1'.
  1688         16  PB-I-1ST-PMT-DT              PIC XX.
  1689         16  PB-I-JOINT-INSURED.
  1690             20 PB-I-JOINT-LAST-NAME      PIC X(15).
  1691             20 PB-I-JOINT-FIRST-NAME.
  1692                24  PB-I-JOINT-FIRST-INIT PIC X.
  1693                24  FILLER                PIC X(9).
  1694             20 PB-I-JOINT-MIDDLE-INIT    PIC X.
  1695*        16  PB-I-BENEFICIARY-NAME        PIC X(25).
  1696         16  PB-I-BENEFICIARY-NAME.
  1697             20  PB-I-BANK-NUMBER         PIC X(10).
  1698             20  FILLER                   PIC X(15).
  1699         16  PB-I-LAST-ADD-ON-DT          PIC XX.
  1700         16  PB-I-REFERENCE               PIC X(12).
  1701         16  FILLER REDEFINES PB-I-REFERENCE.
  1702             20  PB-I-TOT-FEES            PIC S9(7)V99 COMP-3.
  1703             20  PB-I-TOT-FEES-CALC       PIC S9(7)V99 COMP-3.
  1704             20  PB-I-CLP-STATE           PIC XX.
  1705         16  PB-I-UNDERWRITING-STATUS     PIC X.
  1706             88  PB-I-POLICY-ACCEPTED         VALUE 'A' 'N'.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  42
* EL539.cbl (/apps/prod/cid1p/copy/ERCPNDB)
  1707             88  PB-I-POLICY-DECLINED         VALUE 'D'.
  1708             88  PB-I-NEEDS-UNDERWRITING      VALUE 'U'.
  1709         16  PB-I-STATE-TAX               PIC S9(7)V99 COMP-3.
  1710         16  PB-I-MUNI-TAX                PIC S9(7)V99 COMP-3.
  1711         16  PB-I-RESIDENT-STATE          PIC XX.
  1712         16  PB-I-RATE-CODE               PIC X(4).
  1713         16  PB-I-NUM-BILLED              PIC S9(7)    COMP-3.
  1714         16  PB-I-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  1715         16  PB-I-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  1716         16  PB-I-BANK-FEE                PIC S999V99  COMP-3.
  1717         16  PB-I-BANK-NOCHRGB            PIC 99.
  1718         16  PB-I-ADDL-CLP                PIC S9(5)V99 COMP-3.
  1719         16  PB-I-JOINT-BIRTHDAY          PIC XX.
  1720
  1721     12  PB-CANCEL-RECORD   REDEFINES PB-RECORD-BODY.
  1722         16  PB-C-LF-CANCEL-VOID-SW       PIC X.
  1723             88  PB-C-LF-CANCEL-VOIDED        VALUE '1'.
  1724         16  PB-C-CANCEL-ORIGIN           PIC X.
  1725             88  PB-C-CLAIM-CREATED-CANCEL   VALUE '1'.
  1726         16  PB-C-LF-CANCEL-DT            PIC XX.
  1727         16  PB-C-LF-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  1728         16  PB-C-LF-CALC-REQ             PIC X.
  1729             88 PB-COMP-LF-CANCEL            VALUE '?'.
  1730         16  PB-C-LF-REF-CALC             PIC S9(7)V99    COMP-3.
  1731         16  PB-C-LF-REM-TERM             PIC S9(3)       COMP-3.
  1732         16  PB-C-AH-CANCEL-VOID-SW       PIC X.
  1733             88  PB-C-AH-CANCEL-VOIDED        VALUE '1'.
  1734         16  PB-C-AH-CANCEL-DT            PIC XX.
  1735         16  PB-C-AH-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  1736         16  PB-C-AH-CALC-REQ             PIC X.
  1737             88 PB-COMP-AH-CANCEL            VALUE '?'.
  1738         16  PB-C-AH-REF-CALC             PIC S9(7)V99    COMP-3.
  1739         16  PB-C-AH-REM-TERM             PIC S9(3)       COMP-3.
  1740         16  PB-C-LAST-NAME               PIC X(15).
  1741         16  PB-C-REFUND-SW               PIC X.
  1742             88  PB-C-REFUND-CREATED          VALUE 'Y'.
  1743             88  PB-C-REFUND-REQUESTED        VALUE 'R'.
  1744         16  PB-C-LIVES                   PIC S9(3)       COMP-3.
  1745         16  PB-C-PAYEE-CODE              PIC X(6).
  1746         16  PB-C-LF-REFUND-OVERRIDE      PIC X.
  1747         16  PB-C-AH-REFUND-OVERRIDE      PIC X.
  1748         16  PB-C-LF-COMM-CHARGEBACK      PIC X.
  1749         16  PB-C-AH-COMM-CHARGEBACK      PIC X.
  1750         16  PB-C-REFERENCE               PIC X(12).
  1751         16  PB-C-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  1752         16  PB-C-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  1753         16  PB-C-POST-CARD-IND           PIC X.
  1754         16  PB-C-CANCEL-REASON           PIC X.
  1755         16  PB-C-REF-INTERFACE-SW        PIC X.
  1756         16  PB-C-LF-RFND-CLP             PIC S9(5)V99 COMP-3.
  1757         16  PB-C-AH-RFND-CLP             PIC S9(5)V99 COMP-3.
  1758         16  FILLER                       PIC X(01).
  1759*        16  FILLER                       PIC X(18).
  1760         16  PB-C-POLICY-FORM-NO          PIC X(12).
  1761*        16  PB-C-MICROFILM-NO            PIC S9(9)      COMP-3.
  1762         16  PB-C-NH-INT-ON-REFS          PIC S9(7)V99   COMP-3.
  1763         16  PB-CANCELED-CERT-DATA.
  1764             20  PB-CI-INSURED-NAME.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  43
* EL539.cbl (/apps/prod/cid1p/copy/ERCPNDB)
  1765                 24  PB-CI-LAST-NAME      PIC X(15).
  1766                 24  PB-CI-INITIALS       PIC XX.
  1767             20  PB-CI-INSURED-AGE        PIC S99         COMP-3.
  1768             20  PB-CI-INSURED-SEX        PIC X.
  1769             20  PB-CI-LF-TERM            PIC S999        COMP-3.
  1770             20  PB-CI-LF-BENEFIT-CD      PIC XX.
  1771             20  PB-CI-LF-BENEFIT-AMT     PIC S9(9)V99    COMP-3.
  1772             20  PB-CI-LF-ALT-BENEFIT-AMT PIC S9(9)V99    COMP-3.
  1773             20  PB-CI-LF-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  1774             20  PB-CI-LF-ALT-PREMIUM-AMT PIC S9(7)V99    COMP-3.
  1775             20  PB-CI-AH-TERM            PIC S999        COMP-3.
  1776             20  PB-CI-AH-BENEFIT-CD      PIC XX.
  1777             20  PB-CI-AH-BENEFIT-AMT     PIC S9(7)V99    COMP-3.
  1778             20  PB-CI-AH-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  1779             20  PB-CI-RATE-CLASS         PIC XX.
  1780             20  PB-CI-RATE-DEV-LF        PIC XXX.
  1781             20  PB-CI-RATE-DEV-AH        PIC XXX.
  1782             20  PB-CI-RATE-DEV-PCT-LF    PIC S9V9(6)     COMP-3.
  1783             20  PB-CI-RATE-DEV-PCT-AH    PIC S9V9(6)     COMP-3.
  1784             20  PB-CI-LIFE-COMMISSION    PIC SV9(5)      COMP-3.
  1785             20  PB-CI-AH-COMMISSION      PIC SV9(5)      COMP-3.
  1786             20  PB-CI-LF-ABBR            PIC X(3).
  1787             20  PB-CI-AH-ABBR            PIC X(3).
  1788             20  PB-CI-OB-FLAG            PIC X.
  1789                 88  PB-CI-OB                VALUE 'B'.
  1790             20  PB-CI-LF-POLICY-STATUS   PIC X.
  1791                 88  PB-CI-LF-POLICY-IS-ACTIVE       VALUE '1' '3'
  1792                                           'M' '4' '5' '9' '2'.
  1793                 88  PB-CI-LF-NORMAL-ENTRY           VALUE '1'.
  1794                 88  PB-CI-LF-POLICY-PENDING         VALUE '2'.
  1795                 88  PB-CI-LF-POLICY-IS-RESTORE      VALUE '3'.
  1796                 88  PB-CI-LF-CONVERSION-ENTRY       VALUE '4'.
  1797                 88  PB-CI-LF-POLICY-IS-REISSUE      VALUE '5'.
  1798                 88  PB-CI-LF-POLICY-IS-CASH         VALUE 'C'.
  1799                 88  PB-CI-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  1800                 88  PB-CI-LF-LUMP-SUM-DISAB         VALUE '6'.
  1801                 88  PB-CI-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  1802                 88  PB-CI-LF-CANCEL-APPLIED         VALUE '8'.
  1803                 88  PB-CI-LF-REIN-ONLY              VALUE '9'.
  1804                 88  PB-CI-LF-POLICY-IS-DECLINED     VALUE 'D'.
  1805                 88  PB-CI-LF-POLICY-IS-VOID         VALUE 'V'.
  1806             20  PB-CI-AH-POLICY-STATUS   PIC X.
  1807                 88  PB-CI-AH-POLICY-IS-ACTIVE       VALUE '1' '3'
  1808                                           'M' '4' '5' '9' '2'.
  1809                 88  PB-CI-AH-NORMAL-ENTRY           VALUE '1'.
  1810                 88  PB-CI-AH-POLICY-PENDING         VALUE '2'.
  1811                 88  PB-CI-AH-POLICY-IS-RESTORE      VALUE '3'.
  1812                 88  PB-CI-AH-CONVERSION-ENTRY       VALUE '4'.
  1813                 88  PB-CI-AH-POLICY-IS-REISSUE      VALUE '5'.
  1814                 88  PB-CI-AH-POLICY-IS-CASH         VALUE 'C'.
  1815                 88  PB-CI-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  1816                 88  PB-CI-AH-LUMP-SUM-DISAB         VALUE '6'.
  1817                 88  PB-CI-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  1818                 88  PB-CI-AH-CANCEL-APPLIED         VALUE '8'.
  1819                 88  PB-CI-AH-REIN-ONLY              VALUE '9'.
  1820                 88  PB-CI-AH-POLICY-IS-DECLINED     VALUE 'D'.
  1821                 88  PB-CI-AH-POLICY-IS-VOID         VALUE 'V'.
  1822             20  PB-CI-PAY-FREQUENCY      PIC 99.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  44
* EL539.cbl (/apps/prod/cid1p/copy/ERCPNDB)
  1823             20  PB-CI-LOAN-APR           PIC 9(3)V9(4)   COMP-3.
  1824             20  PB-CI-SOC-SEC-NO         PIC X(11).
  1825             20  PB-CI-MEMBER-NO          PIC X(12).
  1826             20  PB-CI-INT-CODE           PIC X.
  1827                 88  PB-CI-ADD-ON                  VALUE 'A'.
  1828                 88  PB-CI-SIMPLE                  VALUE 'S'.
  1829             20  PB-CI-LOAN-TERM          PIC S999        COMP-3.
  1830             20  PB-CI-LOAN-1ST-PMT-DT    PIC X(2).
  1831             20  PB-CI-COMP-EXCP-SW       PIC X.
  1832                 88  PB-CI-NO-COMP-EXCP            VALUE ' '.
  1833                 88  PB-CI-CERT-HAS-ERCOMM-ENTRY   VALUE '1'.
  1834             20  PB-CI-ENTRY-STATUS       PIC X.
  1835             20  PB-CI-CURR-SEQ           PIC S9(4)       COMP.
  1836             20  PB-CI-AH-PAID-THRU-DT    PIC XX.
  1837             20  PB-CI-AH-SETTLEMENT-DT   PIC XX.
  1838             20  PB-CI-DEATH-DT           PIC XX.
  1839             20  PB-CI-LF-PRIOR-CANCEL-DT PIC XX.
  1840             20  PB-CI-AH-PRIOR-CANCEL-DT PIC XX.
  1841             20  PB-CI-AH-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  1842             20  PB-CI-LF-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  1843             20  PB-CI-CREDIT-INTERFACE-SW-1 PIC X.
  1844             20  PB-CI-CREDIT-INTERFACE-SW-2 PIC X.
  1845             20  PB-CI-ENTRY-DT              PIC XX.
  1846             20  PB-CI-ENTRY-BATCH           PIC X(6).
  1847             20  PB-CI-LF-EXPIRE-DT          PIC XX.
  1848             20  PB-CI-AH-EXPIRE-DT          PIC XX.
  1849             20  PB-CI-EXTENTION-DAYS        PIC S999     COMP-3.
  1850             20  PB-CI-TERM-IN-DAYS          PIC S9(5)    COMP-3.
  1851             20  PB-CI-OLD-LOF               PIC XXX.
  1852*            20  PB-CI-LOAN-OFFICER          PIC XXX.
  1853             20  PB-CI-LIVES                 PIC S9(3)    COMP-3.
  1854             20  PB-CI-LF-CRIT-PER           PIC S9(3)    COMP-3.
  1855             20  PB-CI-AH-CRIT-PER           PIC S9(3)    COMP-3.
  1856             20  PB-CI-INDV-GRP-CD           PIC X.
  1857             20  PB-CI-BENEFICIARY-NAME.
  1858                 24  PB-CI-BANK-NUMBER       PIC X(10).
  1859                 24  FILLER                  PIC X(15).
  1860             20  PB-CI-NOTE-SW               PIC X.
  1861             20  PB-CI-CANCEL-FEE            PIC S9(3)V99 COMP-3.
  1862             20  PB-CI-MUNI-TAX              PIC S9(7)V99 COMP-3.
  1863             20  PB-CI-STATE-TAX             PIC S9(7)V99 COMP-3.
  1864             20  PB-CI-ADDL-CLP              PIC S9(5)V99 COMP-3.
  1865             20  PB-CI-LOAN-OFFICER          PIC X(5).
  1866             20  PB-CI-BOW-LOAN-NUMBER       PIC X(14).
  1867             20  PB-CI-FIRST-NAME            PIC X(10).
  1868             20  PB-CI-DDF-IU-RATE-UP        PIC S9(5)V99 COMP-3.
  1869
  1870         16  FILLER                       PIC X(13).
  1871*032306  16  FILLER                       PIC X(27).
  1872*        16  FILLER                       PIC X(46).
  1873
  1874     12  PB-MAIL-RECORD    REDEFINES PB-RECORD-BODY.
  1875         16  FILLER                       PIC X(10).
  1876         16  PB-M-INSURED-LAST-NAME       PIC X(15).
  1877         16  PB-M-INSURED-FIRST-NAME      PIC X(10).
  1878         16  PB-M-INSURED-MID-INIT        PIC X.
  1879         16  PB-M-INSURED-AGE             PIC 99.
  1880         16  PB-M-INSURED-BIRTHDAY        PIC XX.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  45
* EL539.cbl (/apps/prod/cid1p/copy/ERCPNDB)
  1881         16  PB-M-INSURED-SEX             PIC X.
  1882         16  PB-M-INSURED-SOC-SEC-NO      PIC X(11).
  1883         16  PB-M-INSURED-ADDRESS-1       PIC X(30).
  1884         16  PB-M-INSURED-ADDRESS-2       PIC X(30).
  1885         16  PB-M-INSURED-CITY-STATE.
  1886             20  PB-M-INSURED-CITY        PIC X(28).
  1887             20  PB-M-INSURED-STATE       PIC XX.
  1888         16  PB-M-INSURED-ZIP-CODE.
  1889             20  PB-M-INSURED-ZIP-PRIME.
  1890                 24  PB-M-INSURED-ZIP-1   PIC X.
  1891                     88  PB-M-CANADIAN-POST-CODE
  1892                                             VALUE 'A' THRU 'Z'.
  1893                 24  FILLER               PIC X(4).
  1894             20  PB-M-INSURED-ZIP-PLUS4   PIC X(4).
  1895         16  PB-M-INSURED-CANADIAN-ZIP  REDEFINES
  1896                                        PB-M-INSURED-ZIP-CODE.
  1897             20  PM-M-INS-CAN-POST1       PIC XXX.
  1898             20  PM-M-INS-CAN-POST2       PIC XXX.
  1899             20  FILLER                   PIC XXX.
  1900         16  PB-M-INSURED-PHONE-NO        PIC 9(10).
  1901         16  PB-M-JOINT-BIRTHDAY          PIC XX.
  1902         16  PB-M-CRED-BENE-NAME          PIC X(30).
  1903         16  PB-M-CRED-BENE-ADDR1         PIC X(30).
  1904         16  PB-M-CRED-BENE-ADDR2         PIC X(30).
  1905         16  PB-M-CRED-BENE-CITYST.
  1906             20  PB-M-CRED-BENE-CITY      PIC X(28).
  1907             20  PB-M-CRED-BENE-STATE     PIC XX.
  1908
  1909         16  FILLER                       PIC X(92).
  1910
  1911     12  PB-BATCH-RECORD   REDEFINES PB-RECORD-BODY.
  1912         16  FILLER                       PIC X(10).
  1913         16  PB-B-LF-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  1914         16  PB-B-LF-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  1915         16  PB-B-LF-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  1916         16  PB-B-LF-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  1917         16  PB-B-LF-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  1918         16  PB-B-LF-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  1919         16  PB-B-AH-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  1920         16  PB-B-AH-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  1921         16  PB-B-AH-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  1922         16  PB-B-AH-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  1923         16  PB-B-AH-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  1924         16  PB-B-AH-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  1925         16  PB-B-ISSUE-CNT-REMITTED      PIC S9(5)    COMP-3.
  1926         16  PB-B-ISSUE-CNT-ENTERED       PIC S9(5)    COMP-3.
  1927         16  PB-B-CANCEL-CNT-REMITTED     PIC S9(5)    COMP-3.
  1928         16  PB-B-CANCEL-CNT-ENTERED      PIC S9(5)    COMP-3.
  1929         16  PB-B-HIGHEST-SEQ-NO          PIC S9(4)    COMP.
  1930         16  PB-ACCOUNT-NAME              PIC X(30).
  1931         16  PB-PREM-REF-RPT-FLAG         PIC X.
  1932         16  PB-REFERENCE                 PIC X(12).
  1933         16  PB-B-RECEIVED-DT             PIC XX.
  1934         16  FILLER                       PIC X(234).
  1935
  1936     12  PB-RECORD-STATUS.
  1937         16  PB-CREDIT-SELECT-DT          PIC XX.
  1938         16  PB-CREDIT-ACCEPT-DT          PIC XX.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  46
* EL539.cbl (/apps/prod/cid1p/copy/ERCPNDB)
  1939         16  PB-BILLED-DT                 PIC XX.
  1940         16  PB-BILLING-STATUS            PIC X.
  1941             88  PB-ENTRY-REVERSED            VALUE 'R'.
  1942             88  PB-EL860-INTERNAL-ERROR      VALUE 'E'.
  1943             88  PB-EL860-INTERNAL-PROCESS    VALUE 'P'.
  1944         16  PB-RECORD-BILL               PIC X.
  1945             88  PB-RECORD-ON-HOLD            VALUE 'H'.
  1946             88  PB-RECORD-RETURNED           VALUE 'R'.
  1947             88  PB-RECORD-ENDORSED           VALUE 'E'.
  1948             88  PB-OVERRIDE-LIFE             VALUE 'L'.
  1949             88  PB-OVERRIDE-AH               VALUE 'A'.
  1950             88  PB-OVERRIDE-BOTH             VALUE 'B'.
  1951         16  PB-BATCH-ENTRY               PIC X.
  1952             88  PB-POLICY-IS-DECLINED        VALUE 'D'.
  1953             88  PB-REIN-ONLY-CERT            VALUE 'R'.
  1954             88  PB-REISSUED-CERT             VALUE 'E'.
  1955             88  PB-CASH-CERT                 VALUE 'C'.
  1956             88  PB-MONTHLY-CERT              VALUE 'M'.
  1957             88  PB-PREM-ACCTNG-ONLY          VALUE 'P'.
  1958             88  PB-NEEDS-UNDERWRITING        VALUE 'U'.
  1959             88  PB-POLICY-IS-VOIDED          VALUE 'V'.
  1960         16  PB-FORCE-CODE                PIC X.
  1961             88  PB-FORCE-OFF                 VALUE ' ' '0'.
  1962             88  PB-ISSUE-FORCE               VALUE 'A' 'O'.
  1963             88  PB-CANCEL-FORCE              VALUE '8'.
  1964             88  PB-ALL-ISSUE-FORCED          VALUE 'A' 'O'.
  1965             88  PB-ALL-CANCEL-FORCED         VALUE '8'.
  1966             88  PB-ALL-CANCEL-FORCED-NO-FEE  VALUE '9'.
  1967             88  PB-CANCEL-DATE-FORCED        VALUE 'D'.
  1968             88  PB-CANCEL-DATE-FORCED-NO-FEE VALUE 'E'.
  1969             88  PB-ISSUE-DATE-FORCED         VALUE 'D'.
  1970             88  PB-OVERCHARGE-FORCE          VALUE 'O'.
  1971         16  PB-FATAL-FLAG                PIC X.
  1972             88  PB-FATAL-ERRORS              VALUE 'X'.
  1973         16  PB-FORCE-ER-CD               PIC X.
  1974             88  PB-FORCE-ERRORS              VALUE 'F'.
  1975             88  PB-UNFORCED-ERRORS           VALUE 'X'.
  1976         16  PB-WARN-ER-CD                PIC X.
  1977             88  PB-WARNING-ERRORS            VALUE 'W'.
  1978         16  FILLER                       PIC X.
  1979         16  PB-OUT-BAL-CD                PIC X.
  1980             88  PB-OUT-OF-BAL                VALUE 'O'.
  1981         16  PB-LIFE-OVERRIDE-L1          PIC X.
  1982         16  PB-AH-OVERRIDE-L1            PIC X.
  1983         16  PB-INPUT-DT                  PIC XX.
  1984         16  PB-INPUT-BY                  PIC X(4).
  1985         16  PB-CHG-COUNT                 PIC 9(3)        COMP-3.
  1986         16  PB-CALC-TOLERANCE            PIC 9(3)V99     COMP-3.
  1987         16  PB-TOLERANCE-REJECT-SW       PIC X.
  1988         16  PB-LF-EARNING-METHOD         PIC X.
  1989         16  PB-AH-EARNING-METHOD         PIC X.
  1990         16  PB-LF-TERM-CALC-METHOD       PIC X.
  1991         16  PB-AH-TERM-CALC-METHOD       PIC X.
  1992         16  PB-REIN-CD                   PIC XXX.
  1993         16  PB-LF-REFUND-TYPE            PIC X.
  1994         16  PB-AH-REFUND-TYPE            PIC X.
  1995         16  PB-ACCT-EFF-DT               PIC XX.
  1996         16  PB-ACCT-EXP-DT               PIC XX.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  47
* EL539.cbl (/apps/prod/cid1p/copy/ERCPNDB)
  1997         16  PB-COMPANY-ID                PIC X(3).
  1998         16  PB-LF-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  1999         16  PB-AH-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  2000         16  PB-SV-CARRIER                PIC X.
  2001         16  PB-SV-GROUPING               PIC X(6).
  2002         16  PB-SV-STATE                  PIC XX.
  2003         16  PB-CONFIRMATION-REPT-DT      PIC XX.
  2004         16  PB-GA-BILLING-INFO.
  2005             20  PB-GA-BILL-DT OCCURS 5 TIMES
  2006                                          PIC XX.
  2007         16  PB-SV-REMIT-TO  REDEFINES
  2008             PB-GA-BILLING-INFO           PIC X(10).
  2009         16  PB-NO-OF-ERRORS              PIC S9(3) COMP-3.
  2010         16  PB-I-LOAN-OFFICER            PIC X(5).
  2011         16  PB-I-VIN                     PIC X(17).
  2012
  2013         16  FILLER                       PIC X(04).
  2014         16  IMNET-BYPASS-SW              PIC X.
  2015
  2016******************************************************************
  2017*                COMMON EDIT ERRORS                              *
  2018******************************************************************
  2019
  2020     12  PB-COMMON-ERRORS.
  2021         16  PB-COMMON-ERROR    OCCURS 10 TIMES
  2022                                           PIC S9(4)     COMP.
  2023
  2024******************************************************************
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  48
* EL539.cbl
* 2026     COPY ELCDATE.
  2027******************************************************************06/11/98
  2028*                                                                *ELCDATE
  2029*                                                                *ELCDATE
  2030*                            ELCDATE.                            *   LV023
  2031*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL*16
  2032*                            VMOD=2.003                           ELCDATE
  2033*                                                                *ELCDATE
  2034*                                                                *ELCDATE
  2035*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *ELCDATE
  2036*                 LENGTH = 200                                   *   CL*19
  2037******************************************************************ELCDATE
  2038                                                                  ELCDATE
  2039 01  DATE-CONVERSION-DATA.                                        ELCDATE
  2040     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.    CL*19
  2041     12  DC-OPTION-CODE                PIC X.                        CL*15
  2042         88  BIN-TO-GREG                VALUE ' '.                ELCDATE
  2043         88  ELAPSED-BETWEEN-BIN        VALUE '1'.                ELCDATE
  2044         88  EDIT-GREG-TO-BIN           VALUE '2'.                ELCDATE
  2045         88  YMD-GREG-TO-BIN            VALUE '3'.                ELCDATE
  2046         88  MDY-GREG-TO-BIN            VALUE '4'.                ELCDATE
  2047         88  JULIAN-TO-BIN              VALUE '5'.                ELCDATE
  2048         88  BIN-PLUS-ELAPSED           VALUE '6'.                ELCDATE
  2049         88  FIND-CENTURY               VALUE '7'.                   CL*22
  2050         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.                ELCDATE
  2051         88  EDIT-GREG-TO-BIN-3         VALUE '9'.                ELCDATE
  2052         88  YMD-GREG-TO-BIN-3          VALUE 'A'.                ELCDATE
  2053         88  MDY-GREG-TO-BIN-3          VALUE 'B'.                ELCDATE
  2054         88  JULIAN-TO-BIN-3            VALUE 'C'.                ELCDATE
  2055         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.                ELCDATE
  2056         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.                   CL*14
  2057         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.                   CL*14
  2058         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.                   CL*14
  2059         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.         CL*14
  2060         88  CHECK-LEAP-YEAR            VALUE 'H'.                   CL*14
  2061         88  BIN-3-TO-GREG              VALUE 'I'.                   CL*14
  2062         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.                   CL*14
  2063         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.                   CL*14
  2064         88  CYMD-GREG-TO-BIN           VALUE 'L'.                   CL*14
  2065         88  MDCY-GREG-TO-BIN           VALUE 'M'.                   CL*14
  2066         88  MDY-GREG-TO-JULIAN         VALUE 'N'.                   CL*14
  2067         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.                   CL*14
  2068         88  YMD-GREG-TO-JULIAN         VALUE 'P'.                   CL*14
  2069         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.                   CL*14
  2070         88  THREE-CHARACTER-BIN                                  ELCDATE
  2071                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.       CL*14
  2072         88  GREGORIAN-TO-BIN                                        CL**2
  2073                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.    CL*14
  2074         88  BIN-TO-GREGORIAN                                        CL**2
  2075                  VALUES ' ' '1' 'I' '8' 'G'.                        CL*14
  2076         88  JULIAN-TO-BINARY                                        CL**2
  2077                  VALUES '5' 'C' 'E' 'F'.                            CL*14
  2078     12  DC-ERROR-CODE                 PIC X.                        CL*15
  2079         88  NO-CONVERSION-ERROR        VALUE ' '.                   CL**3
  2080         88  DATE-CONVERSION-ERROR                                ELCDATE
  2081                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.        CL*14
  2082         88  DATE-IS-ZERO               VALUE '1'.                ELCDATE
  2083         88  DATE-IS-NON-NUMERIC        VALUE '2'.                ELCDATE
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  49
* EL539.cbl (/apps/prod/cid1p/copy/ELCDATE)
  2084         88  DATE-IS-INVALID            VALUE '3'.                ELCDATE
  2085         88  DATE1-GREATER-DATE2        VALUE '4'.                ELCDATE
  2086         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.                ELCDATE
  2087         88  DATE-INVALID-OPTION        VALUE '9'.                ELCDATE
  2088         88  INVALID-CENTURY            VALUE 'A'.                ELCDATE
  2089         88  ONLY-CENTURY               VALUE 'B'.                ELCDATE
  2090         88  ONLY-LEAP-YEAR             VALUE 'C'.                ELCDATE
  2091         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.              CL**3
  2092     12  DC-END-OF-MONTH               PIC X.                        CL*15
  2093         88  CALCULATE-END-OF-MONTH     VALUE '1'.                ELCDATE
  2094     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.         CL*15
  2095         88  USE-NORMAL-PROCESS         VALUE ' '.                ELCDATE
  2096         88  ADJUST-DOWN-100-YRS        VALUE '1'.                ELCDATE
  2097         88  ADJUST-UP-100-YRS          VALUE '2'.                ELCDATE
  2098     12  FILLER                        PIC X.                        CL*15
  2099     12  DC-CONVERSION-DATES.                                        CL*15
  2100         16  DC-BIN-DATE-1             PIC XX.                       CL*15
  2101         16  DC-BIN-DATE-2             PIC XX.                       CL*15
  2102         16  DC-GREG-DATE-1-EDIT       PIC X(08).                    CL*15
  2103         16  DC-GREG-DATE-1-EDIT-R REDEFINES                         CL*15
  2104                       DC-GREG-DATE-1-EDIT.                       ELCDATE
  2105             20  DC-EDIT1-MONTH        PIC 99.                       CL*15
  2106             20  SLASH1-1              PIC X.                        CL*15
  2107             20  DC-EDIT1-DAY          PIC 99.                       CL*15
  2108             20  SLASH1-2              PIC X.                        CL*15
  2109             20  DC-EDIT1-YEAR         PIC 99.                       CL*15
  2110         16  DC-GREG-DATE-2-EDIT       PIC X(08).                    CL*15
  2111         16  DC-GREG-DATE-2-EDIT-R REDEFINES                         CL*15
  2112                     DC-GREG-DATE-2-EDIT.                         ELCDATE
  2113             20  DC-EDIT2-MONTH        PIC 99.                       CL*15
  2114             20  SLASH2-1              PIC X.                        CL*15
  2115             20  DC-EDIT2-DAY          PIC 99.                       CL*15
  2116             20  SLASH2-2              PIC X.                        CL*15
  2117             20  DC-EDIT2-YEAR         PIC 99.                       CL*15
  2118         16  DC-GREG-DATE-1-YMD        PIC 9(06).                    CL*15
  2119         16  DC-GREG-DATE-1-YMD-R  REDEFINES                         CL*15
  2120                     DC-GREG-DATE-1-YMD.                          ELCDATE
  2121             20  DC-YMD-YEAR           PIC 99.                       CL*15
  2122             20  DC-YMD-MONTH          PIC 99.                       CL*15
  2123             20  DC-YMD-DAY            PIC 99.                       CL*15
  2124         16  DC-GREG-DATE-1-MDY        PIC 9(06).                    CL*15
  2125         16  DC-GREG-DATE-1-MDY-R REDEFINES                          CL*15
  2126                      DC-GREG-DATE-1-MDY.                         ELCDATE
  2127             20  DC-MDY-MONTH          PIC 99.                       CL*15
  2128             20  DC-MDY-DAY            PIC 99.                       CL*15
  2129             20  DC-MDY-YEAR           PIC 99.                       CL*15
  2130         16  DC-GREG-DATE-1-ALPHA.                                   CL*15
  2131             20  DC-ALPHA-MONTH        PIC X(10).                    CL*15
  2132             20  DC-ALPHA-DAY          PIC 99.                       CL*15
  2133             20  FILLER                PIC XX.                       CL*15
  2134             20  DC-ALPHA-CENTURY.                                   CL*15
  2135                 24 DC-ALPHA-CEN-N     PIC 99.                       CL*15
  2136             20  DC-ALPHA-YEAR         PIC 99.                       CL*15
  2137         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.           CL*15
  2138         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.           CL*15
  2139         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.           CL*15
  2140         16  DC-JULIAN-DATE            PIC 9(05).                    CL*15
  2141         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE                CL*20
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  50
* EL539.cbl (/apps/prod/cid1p/copy/ELCDATE)
  2142                                       PIC 9(05).                    CL*20
  2143         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.                  CL*15
  2144             20  DC-JULIAN-YEAR        PIC 99.                       CL*15
  2145             20  DC-JULIAN-DAYS        PIC 999.                      CL*15
  2146         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.       CL*15
  2147         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.    CL*15
  2148         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.    CL*15
  2149     12  DATE-CONVERSION-VARIBLES.                                   CL*15
  2150         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.            CL*15
  2151         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.          CL*15
  2152             20  FILLER                PIC 9(3).                     CL*15
  2153             20  HOLD-CEN-1-CCYY.                                    CL*15
  2154                 24  HOLD-CEN-1-CC     PIC 99.                       CL*17
  2155                 24  HOLD-CEN-1-YY     PIC 99.                       CL*17
  2156             20  HOLD-CEN-1-MO         PIC 99.                       CL*17
  2157             20  HOLD-CEN-1-DA         PIC 99.                       CL*17
  2158         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.            CL*15
  2159             20  HOLD-CEN-1-R-MO       PIC 99.                       CL*17
  2160             20  HOLD-CEN-1-R-DA       PIC 99.                       CL*17
  2161             20  HOLD-CEN-1-R-CCYY.                                  CL*15
  2162                 24  HOLD-CEN-1-R-CC   PIC 99.                       CL*17
  2163                 24  HOLD-CEN-1-R-YY   PIC 99.                       CL*17
  2164             20  FILLER                PIC 9(3).                     CL*15
  2165         16  HOLD-CENTURY-1-X.                                       CL*15
  2166             20  FILLER                PIC X(3)  VALUE SPACES.       CL*15
  2167             20  HOLD-CEN-1-X-CCYY.                                  CL*15
  2168                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.          CL*17
  2169                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.          CL*17
  2170             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.          CL*17
  2171             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.          CL*17
  2172         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.          CL*15
  2173             20  HOLD-CEN-1-R-X-MO     PIC XX.                       CL*17
  2174             20  HOLD-CEN-1-R-X-DA     PIC XX.                       CL*17
  2175             20  HOLD-CEN-1-R-X-CCYY.                                CL*15
  2176                 24  HOLD-CEN-1-R-X-CC PIC XX.                       CL*17
  2177                 24  HOLD-CEN-1-R-X-YY PIC XX.                       CL*17
  2178             20  FILLER                PIC XXX.                      CL*23
  2179         16  DC-BIN-DATE-EXPAND-1      PIC XXX.                      CL*15
  2180         16  DC-BIN-DATE-EXPAND-2      PIC XXX.                      CL*15
  2181         16  DC-JULIAN-DATE-1          PIC 9(07).                    CL*15
  2182         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.          CL*15
  2183             20  DC-JULIAN-1-CCYY.                                   CL*15
  2184                 24  DC-JULIAN-1-CC    PIC 99.                       CL*15
  2185                 24  DC-JULIAN-1-YR    PIC 99.                       CL*15
  2186             20  DC-JULIAN-DA-1        PIC 999.                      CL*15
  2187         16  DC-JULIAN-DATE-2          PIC 9(07).                    CL*15
  2188         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.          CL*15
  2189             20  DC-JULIAN-2-CCYY.                                   CL*15
  2190                 24  DC-JULIAN-2-CC    PIC 99.                       CL*15
  2191                 24  DC-JULIAN-2-YR    PIC 99.                       CL*15
  2192             20  DC-JULIAN-DA-2        PIC 999.                      CL*15
  2193         16  DC-GREG-DATE-A-EDIT.                                    CL*15
  2194             20  DC-EDITA-MONTH        PIC 99.                       CL*15
  2195             20  SLASHA-1              PIC X VALUE '/'.              CL*15
  2196             20  DC-EDITA-DAY          PIC 99.                       CL*15
  2197             20  SLASHA-2              PIC X VALUE '/'.              CL*15
  2198             20  DC-EDITA-CCYY.                                      CL*15
  2199                 24  DC-EDITA-CENT     PIC 99.                       CL*15
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  51
* EL539.cbl (/apps/prod/cid1p/copy/ELCDATE)
  2200                 24  DC-EDITA-YEAR     PIC 99.                       CL*15
  2201         16  DC-GREG-DATE-B-EDIT.                                    CL*15
  2202             20  DC-EDITB-MONTH        PIC 99.                       CL*15
  2203             20  SLASHB-1              PIC X VALUE '/'.              CL*15
  2204             20  DC-EDITB-DAY          PIC 99.                       CL*15
  2205             20  SLASHB-2              PIC X VALUE '/'.              CL*15
  2206             20  DC-EDITB-CCYY.                                      CL*15
  2207                 24  DC-EDITB-CENT     PIC 99.                       CL*15
  2208                 24  DC-EDITB-YEAR     PIC 99.                       CL*15
  2209         16  DC-GREG-DATE-CYMD         PIC 9(08).                    CL*15
  2210         16  DC-GREG-DATE-CYMD-R REDEFINES                           CL*15
  2211                              DC-GREG-DATE-CYMD.                  ELCDATE
  2212             20  DC-CYMD-CEN           PIC 99.                       CL*15
  2213             20  DC-CYMD-YEAR          PIC 99.                       CL*15
  2214             20  DC-CYMD-MONTH         PIC 99.                       CL*15
  2215             20  DC-CYMD-DAY           PIC 99.                       CL*15
  2216         16  DC-GREG-DATE-MDCY         PIC 9(08).                    CL*15
  2217         16  DC-GREG-DATE-MDCY-R REDEFINES                           CL*15
  2218                              DC-GREG-DATE-MDCY.                  ELCDATE
  2219             20  DC-MDCY-MONTH         PIC 99.                       CL*15
  2220             20  DC-MDCY-DAY           PIC 99.                       CL*15
  2221             20  DC-MDCY-CEN           PIC 99.                       CL*15
  2222             20  DC-MDCY-YEAR          PIC 99.                       CL*15
  2223    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.      ELCDATE
  2224        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.        ELCDATE
  2225    12  DC-EL310-DATE                  PIC X(21).                    CL*26
  2226    12  FILLER                         PIC X(28).                    CL*26
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  52
* EL539.cbl
* 2228     COPY ELCDTECX.
  2229******************************************************************06/05/98
  2230*                                                                *ELCDTECX
  2231*                            ELCDTECX.                           *   LV005
  2232*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  2233*                            VMOD=2.015                          *ELCDTECX
  2234*                                                                *ELCDTECX
  2235*      WORKING STORAGE COPY CODE FOR APPLICATIONS CALLING        *ELCDTECX
  2236*      THE DATE CARD DISK FILE. ( READ ROUTINE = ELCDTERX,       *ELCDTECX
  2237*      AND DISK FILE FD = ELCDTEFX)                              *ELCDTECX
  2238*                                                                *ELCDTECX
  2239******************************************************************ELCDTECX
  2240******************************************************************
  2241*                   C H A N G E   L O G
  2242*
  2243* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2244*-----------------------------------------------------------------
  2245*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2246* EFFECTIVE    NUMBER
  2247*-----------------------------------------------------------------
  2248* 092602    2002091900008  PEMA  INCREASE NUMBER OF MAXIMUM
  2249*                                  BENEFIT CODES FROM 300 TO 900
  2250* 090803    2003080800002  PEMA  ADD CATEGORY FOR SUPER GAP
  2251* 051304    2003080800002  SMVA  ADD REFUND METHOD
  2252* 071714    2013100100002  PEMA  FIX CRIT PERIOD EDITS
  2253******************************************************************
  2254 01  DATE-CARD.                                                   ELCDTECX
  2255     12  DATX-COD                    PIC  X(4).                   ELCDTECX
  2256     12  RUN-DATE                    PIC  9(11)  COMP-3.          ELCDTECX
  2257     12  ALPH-DATE                   PIC  X(18).                  ELCDTECX
  2258     12  EP-DT                       PIC  9(11)  COMP-3.          ELCDTECX
  2259     12  PEND-ACT-FILE               PIC  XX.                     ELCDTECX
  2260     12  EP-SW                       PIC  X.                      ELCDTECX
  2261         88  NO-EP-EXTRACTS          VALUE SPACE.                 ELCDTECX
  2262     12  TAPE-BATCHES                PIC  X.                      ELCDTECX
  2263         88  TP-PREL-BAL             VALUE '1'.                   ELCDTECX
  2264     12  BIN-RUN-DATE                PIC  XX.                     ELCDTECX
  2265     12  RUN-CENTURY.                                             ELCDTECX
  2266         16 RUN-CENTURY-N            PIC  99.                        CL**4
  2267     12  FILLER                      PIC  X.                         CL**4
  2268     12  CLAS-MORT-OVRD              PIC  X(4).                   ELCDTECX
  2269     12  FILLER                      PIC  XXX.                    ELCDTECX
  2270     12  COMPANY-NAME                PIC  X(30).                  ELCDTECX
  2271                                                                  ELCDTECX
  2272 01  FILLER                          PIC  X(7)                       CL**6
  2273                                          VALUE 'OPTIONS'.        ELCDTECX
  2274 01  DATE-CARD-OPTIONS.                                           ELCDTECX
  2275     12  DATE-OPTIONS-ID             PIC  X(4).                   ELCDTECX
  2276     12  DTE-MIN-PREM                PIC  99V99.                  ELCDTECX
  2277     12  DTE-LANGUAGE-IND            PIC  X.                      ELCDTECX
  2278         88  DTE-LANGUAGE-IS-FR           VALUE 'F'.              ELCDTECX
  2279         88  DTE-LANGUAGE-IS-ENG          VALUE 'E'.              ELCDTECX
  2280     12  DTE-MIN-AGE                 PIC  99.                     ELCDTECX
  2281     12  DTE-DEFAULT-AGE             PIC  99.                     ELCDTECX
  2282     12  FILLER                      PIC  X.                      ELCDTECX
  2283     12  DTE-MAX-TERM                PIC  999.                    ELCDTECX
  2284     12  DTE-COMP-VG                 PIC  X.                      ELCDTECX
  2285     12  DTE-REM-TRM                 PIC  X.                      ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  53
* EL539.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  2286     12  DTE-PRM-CK                  PIC S99V99.                  ELCDTECX
  2287     12  DTE-PRORATA                 PIC  X.                      ELCDTECX
  2288     12  DTE-CLM-REJ                 PIC  X.                      ELCDTECX
  2289     12  DTE-REF-REJ                 PIC  X.                      ELCDTECX
  2290     12  DTE-COM-TBL-USED            PIC  X.                      ELCDTECX
  2291     12  FILLER                      PIC  X.                      ELCDTECX
  2292     12  DTE-QTR-CO                  PIC  X.                      ELCDTECX
  2293     12  DTE-REF-CK                  PIC S99V99.                  ELCDTECX
  2294     12  DTE-CLM-CK                  PIC S99V99.                  ELCDTECX
  2295     12  DTE-CONV-DT                 PIC 9(11) COMP-3.               CL**2
  2296     12  DTE-DEFAULT-SEX             PIC  X.                      ELCDTECX
  2297     12  DTE-EPL-FORMAT              PIC  X.                      ELCDTECX
  2298     12  FILLER                      PIC  X.                      ELCDTECX
  2299     12  DTE-JT-AGE                  PIC  X.                      ELCDTECX
  2300     12  DTE-KEY-BIRTH               PIC  X.                      ELCDTECX
  2301     12  DTE-REINSURANCE             PIC  X.                      ELCDTECX
  2302     12  DTE-CLAIM-SORT              PIC  X.                      ELCDTECX
  2303     12  DTE-WRT-OFF                 PIC  S99V99.                 ELCDTECX
  2304     12  DTE-R78                     PIC  X.                      ELCDTECX
  2305     12  DTE-DLY-BILL                PIC  X.                      ELCDTECX
  2306     12  DTE-ALT-MORT-CODE           PIC  X(4).                   ELCDTECX
  2307     12  DTE-CLAIM-PAID-THRU-TO      PIC  X.                      ELCDTECX
  2308     12  DTE-COMPENSATION-ACCESS     PIC  X.                      ELCDTECX
  2309     12  DTE-MORTG-ACCESS-CNTL       PIC  X.                      ELCDTECX
  2310     12  DTE-MP-ALT-MORT-CODE        PIC  X(4).                   ELCDTECX
  2311     12  DTE-MORTALITY-AGE-CALC-METHOD                            ELCDTECX
  2312                                     PIC  X.                      ELCDTECX
  2313         88  DTE-USE-TABLE-ASSIGNED-METHOD VALUE '1'              ELCDTECX
  2314                                                 ' '.             ELCDTECX
  2315         88  DTE-USE-ALL-AGE-LAST          VALUE '2'.             ELCDTECX
  2316         88  DTE-USE-ALL-AGE-NEAR          VALUE '3'.             ELCDTECX
  2317     12  DTE-RESERVE-OPTION-SWITCH   PIC  X.                      ELCDTECX
  2318         88  DTE-OPT-RESERVE-METHOD-AUTH       VALUE 'Y'.         ELCDTECX
  2319         88  DTE-OPT-RESERVE-METHOD-UNAUTH     VALUE 'N' ' '.     ELCDTECX
  2320     12  DTE-REM-TRM-CALC-OPTION     PIC  X.                      ELCDTECX
  2321     12  DTE-EXPERIENCE-RETENTION-AGE                             ELCDTECX
  2322                                     PIC  9.                         CL**4
  2323     12  DTE-SYSTEM.                                              ELCDTECX
  2324         16  DTE-SYS-A-CREDIT        PIC  X.                      ELCDTECX
  2325         16  DTE-SYS-B-PEND-CLAIM    PIC  X.                      ELCDTECX
  2326         16  DTE-SYS-C-CONFIRMATIONS PIC  X.                      ELCDTECX
  2327         16  DTE-SYS-D-DEMAND-BILL   PIC  X.                      ELCDTECX
  2328         16  DTE-SYS-E-CLASIC-CLAIMS PIC  X.                      ELCDTECX
  2329         16  DTE-SYS-F-CLASIC-CREDIT PIC  X.                      ELCDTECX
  2330         16  DTE-SYS-G-AR-USED       PIC  X.                      ELCDTECX
  2331         16  DTE-SYS-H               PIC  X.                      ELCDTECX
  2332         16  DTE-SYS-I               PIC  X.                      ELCDTECX
  2333         16  DTE-SYS-J               PIC  X.                      ELCDTECX
  2334         16  DTE-SYS-K               PIC  X.                      ELCDTECX
  2335         16  DTE-SYS-L               PIC  X.                      ELCDTECX
  2336         16  DTE-SYS-M               PIC  X.                      ELCDTECX
  2337         16  DTE-SYS-N               PIC  X.                      ELCDTECX
  2338         16  DTE-SYS-O               PIC  X.                      ELCDTECX
  2339         16  DTE-SYS-P               PIC  X.                      ELCDTECX
  2340         16  DTE-SYS-Q               PIC  X.                      ELCDTECX
  2341         16  DTE-SYS-R               PIC  X.                      ELCDTECX
  2342         16  DTE-SYS-S               PIC  X.                      ELCDTECX
  2343         16  DTE-SYS-T               PIC  X.                      ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  54
* EL539.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  2344         16  DTE-SYS-U               PIC  X.                      ELCDTECX
  2345         16  DTE-SYS-V               PIC  X.                      ELCDTECX
  2346         16  DTE-SYS-W               PIC  X.                      ELCDTECX
  2347         16  DTE-SYS-X               PIC  X.                      ELCDTECX
  2348         16  DTE-SYS-Y               PIC  X.                      ELCDTECX
  2349         16  DTE-SYS-Z               PIC  X.                      ELCDTECX
  2350     12  FILLER                      REDEFINES DTE-SYSTEM.        ELCDTECX
  2351         16  DTE-SYS-CODE            OCCURS 26 TIMES              ELCDTECX
  2352                                     PIC  X.                      ELCDTECX
  2353     12  DTE-CLIENT                  PIC  XXX.                    ELCDTECX
  2354                                                                  ELCDTECX
  2355 01  CLASIC-SYSTEM-CODES.                                         ELCDTECX
  2356     12  DTE-COLC-ID                 PIC  X(4).                   ELCDTECX
  2357     12  DTE-CLASIC-COMPANY-CD       PIC  X.                      ELCDTECX
  2358     12  DTE-CLASIC-COMPANY-NUMBER   PIC  999.                    ELCDTECX
  2359*    12  DTE-CLASIC-CLAIM-ACCESS     PIC  X.                      ELCDTECX
  2360     12  FILLER                      PIC  X.                      ELCDTECX
  2361     12  CLASIC-REIN-MAINT           PIC  XX.                     ELCDTECX
  2362     12  CLASIC-COMP-MAINT           PIC  XX.                     ELCDTECX
  2363     12  CLASIC-ACCT-MAINT           PIC  XX.                     ELCDTECX
  2364     12  CLASIC-CTBL-MAINT           PIC  XX.                     ELCDTECX
  2365     12  CLASIC-RATE-MAINT           PIC  XX.                     ELCDTECX
  2366     12  CLASIC-CREDIT-EOM-DT        PIC  XX.                     ELCDTECX
  2367     12  CLASIC-CLAIMS-EOM-DT        PIC  XX.                     ELCDTECX
  2368                                                                  ELCDTECX
  2369     12  LIFE-OVERRIDE-L1            PIC  X.                      ELCDTECX
  2370     12  LIFE-OVERRIDE-L2            PIC  XX.                     ELCDTECX
  2371     12  LIFE-OVERRIDE-L6            PIC  X(6).                   ELCDTECX
  2372     12  LIFE-OVERRIDE-L12           PIC  X(12).                  ELCDTECX
  2373                                                                  ELCDTECX
  2374     12  AH-OVERRIDE-L1              PIC  X.                      ELCDTECX
  2375     12  AH-OVERRIDE-L2              PIC  XX.                     ELCDTECX
  2376     12  AH-OVERRIDE-L6              PIC  X(6).                   ELCDTECX
  2377     12  AH-OVERRIDE-L12             PIC  X(12).                  ELCDTECX
  2378                                                                  ELCDTECX
  2379     12  CLAS-REPORT-CD1-CAPTION     PIC  X(10).                  ELCDTECX
  2380     12  CLAS-REPORT-CD2-CAPTION     PIC  X(10).                  ELCDTECX
  2381                                                                  ELCDTECX
  2382     12  CLASIC-MORTG-EOM-DT         PIC  XX.                     ELCDTECX
  2383     12  CLASIC-AR-EOM-DT            PIC  XX.                     ELCDTECX
  2384                                                                  ELCDTECX
  2385     12  FILLER                      PIC  X(11)      VALUE SPACE. ELCDTECX
  2386                                                                  ELCDTECX
  2387 01  DATE-CARD-FACTORS.                                           ELCDTECX
  2388     12  DATE-FACTOR-ID              PIC  X(4).                   ELCDTECX
  2389     12  FAC-1                       PIC S999V9(5).               ELCDTECX
  2390     12  FAC-2                       PIC S999V9(5).               ELCDTECX
  2391     12  FAC-3                       PIC S999V9(5).               ELCDTECX
  2392     12  FAC-4                       PIC S999V9(5).               ELCDTECX
  2393     12  FAC-5                       PIC S999V9(5).               ELCDTECX
  2394     12  FAC-6                       PIC S999V9(5).               ELCDTECX
  2395                                                                  ELCDTECX
  2396 01  FILLER                          PIC  X(12)                   ELCDTECX
  2397                                          VALUE 'COMPANY NAME'.   ELCDTECX
  2398 01  COMPANY-NAME-TABLE.                                          ELCDTECX
  2399     12  C-N-TBL                     OCCURS 6 TIMES.              ELCDTECX
  2400         16  CNT-ID                  PIC  X.                      ELCDTECX
  2401         16  CNT-NAME                PIC  X(30).                  ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  55
* EL539.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  2402                                                                  ELCDTECX
  2403 01  FILLER                          PIC  X(11)                   ELCDTECX
  2404                                          VALUE 'STATE NAMES'.    ELCDTECX
  2405 01  STATE-NAMES.                                                 ELCDTECX
  2406     12  STATE-NAME-FLD              OCCURS 75 TIMES.             ELCDTECX
  2407         16  STATE-SUB               PIC  XX.                     ELCDTECX
  2408         16  STATE-PIC1.                                          ELCDTECX
  2409             20  STATE-ABBR          PIC  XX.                     ELCDTECX
  2410             20  FILLER              PIC  XXX.                    ELCDTECX
  2411             20  STATE-PIC           PIC  X(20).                  ELCDTECX
  2412             20  STATE-CALL-EARN     PIC  X.                      ELCDTECX
  2413             20  STATE-CALL-BREAK    PIC  X.                      ELCDTECX
  2414             20  STATE-PRIM-FAC-DEV  PIC  XXX.                    ELCDTECX
  2415                                                                  ELCDTECX
  2416 01  FILLER                          PIC  X(13)                   ELCDTECX
  2417                                          VALUE 'CARRIER NAMES'.  ELCDTECX
  2418 01  CARRIER-NAMES.                                               ELCDTECX
  2419     12  CARRIER-NAME-FLD            OCCURS 25 TIMES.             ELCDTECX
  2420         16  CARRIER-SUB             PIC  X.                      ELCDTECX
  2421         16  CARRIER-DOM-ST          PIC  XX.                     ELCDTECX
  2422         16  CARRIER-PIC             PIC  X(30).                  ELCDTECX
  2423         16  CARRIER-UEP-PCT         PIC  S9V9(4) COMP-3.            CL**6
  2424         16  CARRIER-R78-PCT         PIC  S9V9(4) COMP-3.            CL**6
  2425         16  CARRIER-PRO-PCT         PIC  S9V9(4) COMP-3.            CL**6
  2426*        16  FILLER                  PIC  X.                      ELCDTECX
  2427         16  CARRIER-SEC-PAY         PIC  X.
  2428             88  SEC-PAY-CARRIER          VALUE 'Y'.
  2429                                                                  ELCDTECX
  2430 01  FILLER                          PIC  X(9)                       CL**6
  2431                                          VALUE 'INS TYPES'.      ELCDTECX
  2432 01  CLAS-INS-TYPES.                                              ELCDTECX
  2433*    12 CLAS-ALL-TYPES               OCCURS 300 TIMES.            ELCDTECX
  2434     12 CLAS-ALL-TYPES               OCCURS 900 TIMES.            ELCDTECX
  2435         16  CLAS-I-BEN              PIC  XX.                     ELCDTECX
  2436         16  CLAS-I-AB3.                                          ELCDTECX
  2437             20  FILLER              PIC  X.                      ELCDTECX
  2438             20  CLAS-I-AB2.                                      ELCDTECX
  2439                 24  FILLER          PIC  X.                      ELCDTECX
  2440                 24  CLAS-I-AB1      PIC  X.                      ELCDTECX
  2441         16  CLAS-I-AB3-AH REDEFINES CLAS-I-AB3.                  ELCDTECX
  2442             20  CLAS-EXCLUSION      PIC  XX.                        CL**4
  2443             20  FILLER              PIC  X.                         CL**4
  2444         16  CLAS-I-AB10.                                         ELCDTECX
  2445             20  FILLER              PIC  X(9).                   ELCDTECX
  2446             20  CLAS-I-REIN-YN      PIC  X.                      ELCDTECX
  2447         16  CLAS-I-COMMENT          PIC  X(10).                  ELCDTECX
  2448         16  CLAS-I-JOINT            PIC  X.                      ELCDTECX
  2449         16  CLAS-I-RL-AH            PIC  X.                      ELCDTECX
  2450         16  CLAS-I-CALC-TYPE.                                    ELCDTECX
  2451             20  CLAS-I-BAL          PIC  X.                      ELCDTECX
  2452         16  CLAS-I-EP               PIC  X.                      ELCDTECX
  2453         16  CLAS-CO-BEN-I-G-CD      PIC  X.                      ELCDTECX
  2454         16  CLAS-CO-REM-TERM-CALC   PIC  X.                      ELCDTECX
  2455         16  CLAS-I-BEN-CATEGORY     PIC  X.
  2456         16  CLAS-I-REFUND-METHOD    PIC  X.
  2457         16  CLAS-I-MAX-BENEFITS     PIC 99.
  2458         16  FILLER                  PIC  XXX.
  2459                                                                  ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  56
* EL539.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  2460 01  FILLER                          PIC  X(16)                   ELCDTECX
  2461                                     VALUE 'MORTALITY TABLES'.    ELCDTECX
  2462 01  CLAS-MORTALITY-CODES.                                        ELCDTECX
  2463     12  CLAS-MORT-FLD               OCCURS 99 TIMES              ELCDTECX
  2464                                     INDEXED BY CLAS-MORT-NDX.    ELCDTECX
  2465         16  CLAS-MORT-CODE          PIC  X(4).                      CL**6
  2466         16  CLAS-MORT-J-CODE        PIC  X.                         CL**5
  2467         16  CLAS-MORT-J-FACT        PIC S9V9(4).                    CL**6
  2468         16  CLAS-MORT-DESC.                                      ELCDTECX
  2469             20  CLAS-RESERVE-ADJ    PIC  999.                       CL**6
  2470             20  FILLER              PIC  XX.                        CL**5
  2471             20  CLAS-YEAR           PIC  X(4).                      CL**6
  2472             20  FILLER              PIC  X.                         CL**5
  2473             20  CLAS-TABLE-TYPE     PIC  XXX.                       CL**6
  2474             20  FILLER              PIC  X.                         CL**5
  2475             20  CLAS-AGE-METHOD     PIC  XX.                        CL**5
  2476             20  FILLER              PIC  X.                         CL**5
  2477             20  CLAS-INTEREST       PIC  99.99.                     CL**5
  2478             20  FILLER              PIC  X(5).                      CL**6
  2479                                                                  ELCDTECX
  2480 01  FILLER                          PIC  X(15)                   ELCDTECX
  2481                                     VALUE 'BUSINESS TABLES'.     ELCDTECX
  2482 01  CLAS-BUSINESS-CLASSES.                                       ELCDTECX
  2483     12  CLAS-BUSC-FLD               OCCURS 50 TIMES.             ELCDTECX
  2484         16  CLAS-BUSC-CODE          PIC  99.                     ELCDTECX
  2485         16  CLAS-BUSC-GROUP         PIC  X.                      ELCDTECX
  2486         16  CLAS-BUSC-DESC          PIC  X(19).                  ELCDTECX
  2487         16  CLAS-BUSC-EXCL          PIC  X.                         CL**5
  2488         16  FILLER                  PIC  X(4).                      CL**6
  2489                                                                  ELCDTECX
  2490 01  FILLER                          PIC  X(7)                       CL**6
  2491                                     VALUE 'INDEXES'.             ELCDTECX
  2492 01  CLAS-INDEX-TBL.                                              ELCDTECX
  2493     12  CLAX-ID                     PIC  X(4).                   ELCDTECX
  2494     12  CLAS-STARTC                 PIC S9(4) COMP.              ELCDTECX
  2495     12  CLAS-MAXC                   PIC S9(4) COMP.              ELCDTECX
  2496     12  CLAS-STARTL                 PIC S9(4) COMP.              ELCDTECX
  2497     12  CLAS-MAXL                   PIC S9(4) COMP.              ELCDTECX
  2498     12  CLAS-STARTA                 PIC S9(4) COMP.              ELCDTECX
  2499     12  CLAS-MAXA                   PIC S9(4) COMP.              ELCDTECX
  2500     12  CLAS-STARTM                 PIC S9(4) COMP.              ELCDTECX
  2501     12  CLAS-MAXM                   PIC S9(4) COMP.              ELCDTECX
  2502     12  CLAS-STARTB                 PIC S9(4) COMP.              ELCDTECX
  2503     12  CLAS-MAXB                   PIC S9(4) COMP.              ELCDTECX
  2504     12  CLAS-STARTS                 PIC S9(4) COMP.              ELCDTECX
  2505     12  CLAS-MAXS                   PIC S9(4) COMP.              ELCDTECX
  2506     12  CLAS-STARTE                 PIC S9(4) COMP.              ELCDTECX
  2507     12  CLAS-MAXE                   PIC S9(4) COMP.              ELCDTECX
  2508     12  CLAS-STARTCN                PIC S9(4) COMP.              ELCDTECX
  2509     12  CLAS-MAXCN                  PIC S9(4) COMP.              ELCDTECX
  2510                                                                  ELCDTECX
  2511 01  CLAS-TYPE-MISC.                                              ELCDTECX
  2512     12  CLAS-INDEXC                 PIC S9(4) COMP.              ELCDTECX
  2513     12  CLAS-INDEXL                 PIC S9(4) COMP.              ELCDTECX
  2514     12  CLAS-INDEXA                 PIC S9(4) COMP.              ELCDTECX
  2515     12  CLAS-INDEXM                 PIC S9(4) COMP.              ELCDTECX
  2516     12  CLAS-INDEXB                 PIC S9(4) COMP.              ELCDTECX
  2517     12  CLAS-INDEXS                 PIC S9(4) COMP.              ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  57
* EL539.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  2518     12  CLAS-INDEXE                 PIC S9(4) COMP.              ELCDTECX
  2519     12  CLAS-INDEX                  PIC S9(4) COMP.              ELCDTECX
  2520     12  CLAS-INDEXEN                PIC S9(4) COMP.              ELCDTECX
  2521     12  CLAS-INDEXCN                PIC S9(4) COMP.              ELCDTECX
  2522     12  CLAS-INDEXON                PIC S9(4) COMP.              ELCDTECX
  2523                                                                  ELCDTECX
  2524 01  FILLER                          PIC  X(13)                   ELCDTECX
  2525                                     VALUE 'MISCELLANEOUS'.       ELCDTECX
  2526 01  CLAS-MISC.                                                   ELCDTECX
  2527     12  DTE-FICH                    PIC  X.                      ELCDTECX
  2528         88  FICH-NO                 VALUE SPACE.                 ELCDTECX
  2529         88  FICH-ONLY               VALUE '1'.                   ELCDTECX
  2530         88  FICH-BOTH               VALUE '2'.                   ELCDTECX
  2531     12  FICH-OPEN                   PIC  X.                      ELCDTECX
  2532     12  REPT-OPEN                   PIC  X.                      ELCDTECX
  2533     12  DTE-PGM-OPT                 PIC  9.                         CL**5
  2534     12  DTE-PRT-OPT                 PIC  X.                      ELCDTECX
  2535     12  DTE-FMT-OPT                 PIC  9.                      ELCDTECX
  2536     12  DTE-PRC-OPT                 PIC  9.                      ELCDTECX
  2537     12  DTE-TOT-OPT                 PIC  9.                      ELCDTECX
  2538     12  CLAS-LOOK                   PIC  XX.                     ELCDTECX
  2539     12  DTE-TOT-LINES               PIC S9(8)      COMP.         ELCDTECX
  2540     12  STATE-L                     PIC  XX.                     ELCDTECX
  2541     12  CLAS-CN                     PIC  99.                     ELCDTECX
  2542     12  CLAS-CO                     PIC  99.                     ELCDTECX
  2543     12  DTE-VSAM-FLAGS                              VALUE ZERO.  ELCDTECX
  2544         16  DTE-F-1                 PIC  X.                      ELCDTECX
  2545         16  DTE-F-2                 PIC  X.                      ELCDTECX
  2546     12  DTE-ABEND-WORK.                                          ELCDTECX
  2547         16  DTE-ABEND-CD-1          PIC  XX         VALUE SPACES.ELCDTECX
  2548         16  DTE-ABEND-CD-2          PIC  XX         VALUE SPACES.ELCDTECX
  2549                                                                  ELCDTECX
  2550 01  FILLER                          PIC  X(12)                   ELCDTECX
  2551                                     VALUE 'WORKING DATE'.        ELCDTECX
  2552 01  WS-DATE-AND-TIME.                                            ELCDTECX
  2553     12  WS-ACCEPT-DATE.                                          ELCDTECX
  2554         16  WS-AD-YY                PIC  99.                     ELCDTECX
  2555         16  WS-AD-MM                PIC  99.                     ELCDTECX
  2556         16  WS-AD-DD                PIC  99.                     ELCDTECX
  2557     12  WS-CURRENT-DATE.                                         ELCDTECX
  2558         16  WS-CD-MM                PIC  99.                     ELCDTECX
  2559         16  FILLER                  PIC  X          VALUE '/'.   ELCDTECX
  2560         16  WS-CD-DD                PIC  99.                     ELCDTECX
  2561         16  FILLER                  PIC  X          VALUE '/'.   ELCDTECX
  2562         16  WS-CD-YY                PIC  99.                     ELCDTECX
  2563     12  WS-TIME-OF-DAY.                                          ELCDTECX
  2564         16  WS-TIME                 PIC  9(6).                   ELCDTECX
  2565         16  WS-HUN-SEC              PIC  99.                     ELCDTECX
  2566                                                                  ELCDTECX
  2567 01  FILLER                          PIC  X(12)                   ELCDTECX
  2568                                     VALUE 'CARRIER CLMS'.        ELCDTECX
  2569 01  CARRIER-OPT-CLAIM-DATA.                                      ELCDTECX
  2570     12  CARRIER-FLDS                OCCURS 25 TIMES.             ELCDTECX
  2571         16  CARRIER-IBNR-SWITCH     PIC  X.                         CL**5
  2572         16  CARRIER-IBNR-PERCENT    PIC S9V9(4) COMP-3.             CL**6
  2573         16  CARRIER-CIDA-DISCOUNT   PIC S9V9(4) COMP-3.             CL**6
  2574                                                                  ELCDTECX
  2575 01  FILLER                          PIC  X(10)                   ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  58
* EL539.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  2576                                     VALUE 'STATE TLRS'.          ELCDTECX
  2577 01  STATE-TARGET-LOSS-RATIOS.                                    ELCDTECX
  2578     12  STATE-TLR-FLD               OCCURS 75 TIMES.             ELCDTECX
  2579         16  STATE-TARGET-LOSS-RATIO PIC S9V9(4) COMP-3.             CL**6
  2580         16  STATE-CALC-INTEREST     PIC S9V9(4) COMP-3.             CL**6
  2581                                                                  ELCDTECX
  2582 01  FILLER                          PIC  X(13)                   ELCDTECX
  2583                                     VALUE 'BUSINESS TLRS'.       ELCDTECX
  2584 01  BUSINESS-TRGT-LOSS-RATIO-MODS.                               ELCDTECX
  2585     12  BUS-TLRM-FLD                OCCURS 99 TIMES.             ELCDTECX
  2586         16  BUS-TRGT-LOSS-RATIO-MOD PIC S9V9(4) COMP-3.             CL**6
  2587                                                                  ELCDTECX
  2588 01  FILLER                          PIC  X(13)                   ELCDTECX
  2589                                     VALUE 'MISC CLM DATA'.       ELCDTECX
  2590 01  MISC-OPT-CLM-RSV-DATA.                                       ELCDTECX
  2591     12  COMPANY-CALC-INTEREST       PIC S9V9(4) COMP-3.             CL**6
  2592     12  COMPANY-CIDA-DISCOUNT       PIC S9V9(4) COMP-3.             CL**6
  2593     12  COMPANY-CRDB-TABLE-SELECTION                             ELCDTECX
  2594                                     PIC  X.                         CL**5
  2595     12  COMPANY-IBNR-AH-FACTOR      PIC S9V9(4) COMP-3.             CL**6
  2596     12  COMPANY-IBNR-LAG-MONTH      PIC S999    COMP-3.             CL**6
  2597     12  COMPANY-IBNR-LIFE-FACTOR    PIC S9V9(4) COMP-3.             CL**6
  2598     12  COMPANY-OPTION-START-DATE   PIC  XX.                        CL**5
  2599     12  INDEXBS                     PIC S9(4)   COMP.               CL**6
  2600     12  INDEXCA                     PIC S9(4)   COMP.               CL**6
  2601     12  INDEXST                     PIC S9(4)   COMP.               CL**6
  2602     12  FILLER                      PIC  X(75).                  ELCDTECX
  2603******************************************************************ELCDTECX
  2604*01  MISC-CARR-PCT-DATA.                                          00001521
  2605*    12  DD-CARR1-UEP-PCT            PIC S9V9(4) COMP-3.          00001522
  2606*    12  DD-CARR1-R78-PCT            PIC S9V9(4) COMP-3.          00001522
  2607*    12  DD-CARR1-PRO-PCT            PIC S9V9(4) COMP-3.          00001522
  2608*    12  DD-CARR2-UEP-PCT            PIC S9V9(4) COMP-3.          00001522
  2609*    12  DD-CARR2-R78-PCT            PIC S9V9(4) COMP-3.          00001522
  2610*    12  DD-CARR2-PRO-PCT            PIC S9V9(4) COMP-3.          00001522
  2611******************************************************************ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  59
* EL539.cbl
* 2613     COPY ELCDTEVR.
  2614***************************************************************** 04/15/98
  2615*                                                                *ELCDTEVR
  2616*                                                                *ELCDTEVR
  2617*                            ELCDTEVR.                           *   LV003
  2618*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
  2619*                            VMOD=2.001                          *   CL**2
  2620*                                                                *ELCDTEVR
  2621*   WORKING STORAGE FOR DATE VARIABLES CREATED                   *ELCDTEVR
  2622*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCDTEVR
  2623*                                                                *ELCDTEVR
  2624******************************************************************ELCDTEVR
  2625 01  WS-DATE-CARD-DATE.                                           ELCDTEVR
  2626     05  WS-RUN-DATE.                                             ELCDTEVR
  2627         10  FILLER                  PIC  9(03).                  ELCDTEVR
  2628         10  RUN-CCYY                PIC  9(04).                  ELCDTEVR
  2629         10  RUN-CCYR  REDEFINES  RUN-CCYY.                       ELCDTEVR
  2630             15  RUN-CC              PIC  99.                     ELCDTEVR
  2631             15  RUN-YR              PIC  99.                     ELCDTEVR
  2632         10  RUN-MO                  PIC  99.                     ELCDTEVR
  2633         10  RUN-DA                  PIC  99.                     ELCDTEVR
  2634     05  WS-RUN-DATE-N REDEFINES                                     CL**2
  2635            WS-RUN-DATE              PIC 9(11).                      CL**2
  2636     05  WS-EP-DT.                                                ELCDTEVR
  2637         10  FILLER                  PIC  9(03).                  ELCDTEVR
  2638         10  EP-CCYY                 PIC  9(04).                  ELCDTEVR
  2639         10  EP-CCYR  REDEFINES  EP-CCYY.                         ELCDTEVR
  2640             15  EP-CC               PIC  99.                     ELCDTEVR
  2641             15  EP-YR               PIC  99.                     ELCDTEVR
  2642         10  EP-MO                   PIC  99.                     ELCDTEVR
  2643         10  EP-DA                   PIC  99.                     ELCDTEVR
  2644     05  WS-EP-DT-N REDEFINES                                        CL**2
  2645            WS-EP-DT                 PIC 9(11).                      CL**2
  2646     05  WS-DTE-CONV-DT.                                             CL**4
  2647         10  FILLER                  PIC  9(03).                     CL**4
  2648         10  DTE-CONV-CCYY           PIC  9(04).                     CL**4
  2649         10  DTE-CONV-CCYR  REDEFINES  DTE-CONV-CCYY.                CL**4
  2650             15  DTE-CONV-CC         PIC  99.                        CL**4
  2651             15  DTE-CONV-YR         PIC  99.                        CL**4
  2652         10  DTE-CONV-MO             PIC  99.                        CL**4
  2653         10  DTE-CONV-DA             PIC  99.                        CL**4
  2654     05  WS-DTE-CONV-DT-N REDEFINES                                  CL**4
  2655            WS-DTE-CONV-DT           PIC  9(11).                     CL**4
  2656 01  WS-BALANCE-FORWARD-DATE.                                     ELCDTEVR
  2657     05  WS-BF-LAST-ACTIVITY-DATE.                                ELCDTEVR
  2658         10  FILLER                            PIC 999.           ELCDTEVR
  2659         10  BF-ACT-CCYY                       PIC 9(04).         ELCDTEVR
  2660         10  BF-ACT-CCYR  REDEFINES  BF-ACT-CCYY.                 ELCDTEVR
  2661             15  BF-ACT-CC                     PIC 99.            ELCDTEVR
  2662             15  BF-ACT-YEAR                   PIC 99.            ELCDTEVR
  2663         10  BF-ACT-MONTH                      PIC 99.            ELCDTEVR
  2664         10  BF-ACT-DAY                        PIC 99.            ELCDTEVR
  2665     05  WS-BF-LAST-ACTIVITY-DATE-N REDEFINES                        CL**2
  2666            WS-BF-LAST-ACTIVITY-DATE           PIC 9(11).            CL**2
  2667     05  WS-BF-CURRENT-LAST-STMT-DT.                              ELCDTEVR
  2668         10  FILLER                            PIC 999.           ELCDTEVR
  2669         10  BF-CURRENT-LAST-STMT-CEN          PIC 99.            ELCDTEVR
  2670         10  BF-CURRENT-LAST-STMT-YEAR         PIC 99.            ELCDTEVR
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  60
* EL539.cbl (/apps/prod/cid1p/copy/ELCDTEVR)
  2671         10  BF-CURRENT-LAST-STMT-MONTH        PIC 99.            ELCDTEVR
  2672         10  BF-CURRENT-LAST-STMT-DAY          PIC 99.            ELCDTEVR
  2673     05  WS-BF-CURRENT-LAST-STMT-DT-N REDEFINES                      CL**2
  2674            WS-BF-CURRENT-LAST-STMT-DT        PIC 9(11).             CL**2
  2675 01  WS-ADD-CONF-TRANSACTIONS-DTE.                                ELCDTEVR
  2676     05  WS-AC-CERT-EFF-DATE.                                     ELCDTEVR
  2677         10  FILLER                            PIC 999.           ELCDTEVR
  2678         10  AC-CERT-CCYY                      PIC 9(04).         ELCDTEVR
  2679         10  AC-CERT-CCYR  REDEFINES  AC-CERT-CCYY.               ELCDTEVR
  2680             15  AC-CERT-CC                    PIC 99.            ELCDTEVR
  2681             15  AC-CERT-YR                    PIC 99.            ELCDTEVR
  2682         10  AC-CERT-MO                        PIC 99.            ELCDTEVR
  2683         10  AC-CERT-DA                        PIC 99.            ELCDTEVR
  2684     05  WS-AC-CERT-EFF-DATE-N REDEFINES                             CL**2
  2685            WS-AC-CERT-EFF-DATE                PIC 9(11).            CL**2
  2686     05  WS-AC-LIFE-CANCEL-DATE.                                  ELCDTEVR
  2687         10  FILLER                            PIC 999.           ELCDTEVR
  2688         10  AC-LIFE-CANCEL-CCYY               PIC 9(04).         ELCDTEVR
  2689         10  AC-LIFE-CANCEL-CCYR REDEFINES AC-LIFE-CANCEL-CCYY.   ELCDTEVR
  2690             15  AC-LIFE-CANCEL-CC             PIC 99.            ELCDTEVR
  2691             15  AC-LIFE-CANCEL-YR             PIC 99.            ELCDTEVR
  2692         10  AC-LIFE-CANCEL-MO                 PIC 99.            ELCDTEVR
  2693         10  AC-LIFE-CANCEL-DA                 PIC 99.            ELCDTEVR
  2694     05  WS-AC-LIFE-CANCEL-DATE-N REDEFINES                          CL**2
  2695            WS-AC-LIFE-CANCEL-DATE             PIC 9(11).            CL**2
  2696     05  WS-AC-AH-CANCEL-DATE.                                    ELCDTEVR
  2697         10  FILLER                            PIC 999.           ELCDTEVR
  2698         10  AC-AH-CANCEL-CCYY                 PIC 9(04).         ELCDTEVR
  2699         10  AC-AH-CANCEL-CCYR  REDEFINES  AC-AH-CANCEL-CCYY.     ELCDTEVR
  2700             15  AC-AH-CANCEL-CC               PIC 99.            ELCDTEVR
  2701             15  AC-AH-CANCEL-YR               PIC 99.            ELCDTEVR
  2702         10  AC-AH-CANCEL-MO                   PIC 99.            ELCDTEVR
  2703         10  AC-AH-CANCEL-DA                   PIC 99.            ELCDTEVR
  2704     05  WS-AC-AH-CANCEL-DATE-N REDEFINES                            CL**2
  2705            WS-AC-AH-CANCEL-DATE               PIC 9(11).            CL**2
  2706 01  WS-RATE-RECORD.                                              ELCDTEVR
  2707         05  WS-RT-EXPIRY-DATE.                                   ELCDTEVR
  2708             10  FILLER                        PIC 999.           ELCDTEVR
  2709             10  RT-EXP-CCYY                   PIC 9(04).         ELCDTEVR
  2710             10  RT-EXP-CCYR  REDEFINES  RT-EXP-CCYY.             ELCDTEVR
  2711                 15  RT-EXP-CC                 PIC 99.            ELCDTEVR
  2712                 15  RT-EXP-YR                 PIC 99.            ELCDTEVR
  2713             10  RT-EXP-MO                     PIC 99.            ELCDTEVR
  2714             10  RT-EXP-DA                     PIC 99.            ELCDTEVR
  2715         05  WS-RT-EXPIRY-DATE-N REDEFINES                           CL**2
  2716                WS-RT-EXPIRY-DATE              PIC 9(11).            CL**2
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  61
* EL539.cbl
  2718 PROCEDURE DIVISION.
  2719
  2720 0000-GET-DATE.
  2721
  2722     ACCEPT      WS-BANK
* 2723                             COPY ELCDTERX.
  2724******************************************************************04/15/98
  2725*                                                                *ELCDTERX
  2726*                                                                *ELCDTERX
  2727*                            ELCDTERX.                           *   LV002
  2728*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  2729*                            VMOD=2.007                          *ELCDTERX
  2730*                                                                *ELCDTERX
  2731*      LOAD DATE CARD DISK FILE INTO WORKING STORAGE AREA        *ELCDTERX
  2732*      (COPY CODE FOR W/S = ELCDTECX AND COPY CODE FOR FD        *ELCDTERX
  2733*      = ELCDTEFD)                                               *ELCDTERX
  2734*                                                                *ELCDTERX
  2735******************************************************************ELCDTERX
  2736                                                                  ELCDTERX
  2737     ACCEPT WS-ACCEPT-DATE       FROM  DATE.                      ELCDTERX
  2738                                                                  ELCDTERX
  2739     MOVE WS-AD-YY               TO  WS-CD-YY.                    ELCDTERX
  2740     MOVE WS-AD-MM               TO  WS-CD-MM.                    ELCDTERX
  2741     MOVE WS-AD-DD               TO  WS-CD-DD.                    ELCDTERX
  2742                                                                  ELCDTERX
  2743     ACCEPT WS-TIME-OF-DAY       FROM  TIME.                      ELCDTERX
  2744                                                                  ELCDTERX
  2745******************************************************************ELCDTERX
  2746*    NOTE: THE FOLLOWING STATEMENT IS USED TO ELIMINATE COB II    ELCDTERX
  2747*          WARNING MESSAGES.                                      ELCDTERX
  2748******************************************************************ELCDTERX
  2749     IF WS-CD-YY = LOW-VALUES                                     ELCDTERX
  2750         COMPUTE PGM-SUB = PGM-SUB + 1.                           ELCDTERX
  2751                                                                  ELCDTERX
  2752     OPEN INPUT DISK-DATE.                                        ELCDTERX
  2753                                                                  ELCDTERX
  2754     MOVE SPACE TO DATE-CARD         CLAS-BUSINESS-CLASSES        ELCDTERX
  2755                   STATE-NAMES       CLAS-MORTALITY-CODES         ELCDTERX
  2756                   CLAS-INS-TYPES    COMPANY-NAME-TABLE           ELCDTERX
  2757                   DATE-CARD-OPTIONS DATE-CARD-FACTORS            ELCDTERX
  2758                   CLAX-ID           CLAS-MISC                    ELCDTERX
  2759                   CARRIER-NAMES     CLASIC-SYSTEM-CODES          ELCDTERX
  2760                   CARRIER-OPT-CLAIM-DATA                         ELCDTERX
  2761                   STATE-TARGET-LOSS-RATIOS                       ELCDTERX
  2762                   BUSINESS-TRGT-LOSS-RATIO-MODS                  ELCDTERX
  2763                   MISC-OPT-CLM-RSV-DATA.                         ELCDTERX
  2764                                                                  ELCDTERX
  2765     MOVE LOW-VALUES TO CLAS-INDEX-TBL CLAS-TYPE-MISC.            ELCDTERX
  2766                                                                  ELCDTERX
  2767     MOVE ZERO TO CLAS-CN DTE-TOT-LINES CLAS-CO                   ELCDTERX
  2768                  INDEXCA INDEXBS INDEXST.                        ELCDTERX
  2769                                                                  ELCDTERX
  2770     COMPUTE CLAS-CN = PGM-SUB / +50.                             ELCDTERX
  2771     COMPUTE CLAS-CO = PGM-SUB / +20.                             ELCDTERX
  2772     COMPUTE CLAS-INDEXEN = PGM-SUB - (CLAS-CN * +50).            ELCDTERX
  2773     COMPUTE CLAS-INDEXON = PGM-SUB - (CLAS-CO * +20).            ELCDTERX
  2774                                                                  ELCDTERX
  2775     IF CLAS-INDEXEN = ZERO                                       ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  62
* EL539.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  2776         MOVE +50               TO CLAS-INDEXEN                   ELCDTERX
  2777     ELSE                                                         ELCDTERX
  2778         ADD +1                 TO CLAS-CN.                       ELCDTERX
  2779                                                                  ELCDTERX
  2780     IF CLAS-INDEXON = ZERO                                       ELCDTERX
  2781         MOVE +20               TO CLAS-INDEXON                   ELCDTERX
  2782     ELSE                                                         ELCDTERX
  2783         ADD +1                 TO CLAS-CO.                       ELCDTERX
  2784                                                                  ELCDTERX
  2785 0005-READ--CARD.                                                 ELCDTERX
  2786     READ DISK-DATE                                               ELCDTERX
  2787         AT END CLOSE DISK-DATE                                   ELCDTERX
  2788             GO TO 0060-READ--TEST.                               ELCDTERX
  2789                                                                  ELCDTERX
  2790     MOVE ZERO                   TO CLAS-INDEX.                   ELCDTERX
  2791                                                                  ELCDTERX
  2792     IF DD-ID = 'CLAS' OR 'LIFE' OR 'GLED'                        ELCDTERX
  2793         MOVE DATE-DISK          TO DATE-CARD                     ELCDTERX
  2794         MOVE RUN-DATE           TO WS-RUN-DATE-N                    CL**2
  2795         MOVE EP-DT              TO WS-EP-DT-N                       CL**2
  2796         GO TO 0005-READ--CARD.                                   ELCDTERX
  2797                                                                  ELCDTERX
  2798     IF DD-ID = 'CLAD'                                            ELCDTERX
  2799         MOVE DATE-DISK          TO DATE-CARD-OPTIONS             ELCDTERX
  2800         GO TO 0005-READ--CARD.                                   ELCDTERX
  2801                                                                  ELCDTERX
  2802     IF DD-ID = 'CLAX'                                            ELCDTERX
  2803         MOVE DATE-DISK          TO CLAS-INDEX-TBL                ELCDTERX
  2804         GO TO 0005-READ--CARD.                                   ELCDTERX
  2805                                                                  ELCDTERX
  2806     IF DD-ID = 'CLAF'                                            ELCDTERX
  2807         MOVE DATE-DISK          TO DATE-CARD-FACTORS             ELCDTERX
  2808         GO TO 0005-READ--CARD.                                   ELCDTERX
  2809                                                                  ELCDTERX
  2810     IF DD-ID = 'CLAC'                                            ELCDTERX
  2811         GO TO 0010-READ--CLAC.                                   ELCDTERX
  2812                                                                  ELCDTERX
  2813     IF DD-ID = 'CARR'                                            ELCDTERX
  2814         GO TO 0015-READ--CARR.                                   ELCDTERX
  2815                                                                  ELCDTERX
  2816     IF DD-ID = 'STAT'                                            ELCDTERX
  2817         GO TO 0020-READ--STAT.                                   ELCDTERX
  2818                                                                  ELCDTERX
  2819     IF DD-ID = 'BUSC'                                            ELCDTERX
  2820         GO TO 0025-READ--BUSC.                                   ELCDTERX
  2821                                                                  ELCDTERX
  2822     IF DD-ID = 'MORT'                                            ELCDTERX
  2823         GO TO 0030-READ--MORT.                                   ELCDTERX
  2824                                                                  ELCDTERX
  2825     IF DD-ID = 'CLAI'                                            ELCDTERX
  2826         GO TO 0040-READ--CLAI.                                   ELCDTERX
  2827                                                                  ELCDTERX
  2828     IF DD-ID = 'COLC'                                            ELCDTERX
  2829         GO TO 0065-READ--COLC.                                   ELCDTERX
  2830                                                                  ELCDTERX
  2831     IF DD-IDX NUMERIC AND                                        ELCDTERX
  2832        DD-IDA = 'CL'                                             ELCDTERX
  2833         GO TO 0035-READ--CLXX.                                   ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  63
* EL539.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  2834                                                                  ELCDTERX
  2835     IF DD-IDX NUMERIC AND                                        ELCDTERX
  2836        DD-IDA = 'PO'                                             ELCDTERX
  2837         GO TO 0050-READ--POXX.                                   ELCDTERX
  2838                                                                  ELCDTERX
  2839     IF DD-ID = 'OPCA'                                            ELCDTERX
  2840         GO TO 0070-READ--OPCA.                                   ELCDTERX
  2841                                                                  ELCDTERX
  2842     IF DD-ID = 'OPST'                                            ELCDTERX
  2843         GO TO 0072-READ--OPST.                                   ELCDTERX
  2844                                                                  ELCDTERX
  2845     IF DD-ID = 'OPBS'                                            ELCDTERX
  2846         GO TO 0074-READ--OPBS.                                   ELCDTERX
  2847                                                                  ELCDTERX
  2848     IF DD-ID = 'OPMS'                                            ELCDTERX
  2849         MOVE DD-MISC-DATA       TO MISC-OPT-CLM-RSV-DATA.        ELCDTERX
  2850                                                                  ELCDTERX
  2851     GO TO 0005-READ--CARD.                                       ELCDTERX
  2852                                                                  ELCDTERX
  2853 0010-READ--CLAC.                                                 ELCDTERX
  2854     ADD 1                       TO CLAS-INDEXC.                  ELCDTERX
  2855     MOVE DD-CR1                 TO CNT-ID (CLAS-INDEXC).         ELCDTERX
  2856     MOVE DD-CR1N                TO CNT-NAME (CLAS-INDEXC).       ELCDTERX
  2857     ADD 1                       TO CLAS-INDEXC.                  ELCDTERX
  2858     MOVE DD-CR2                 TO CNT-ID (CLAS-INDEXC).         ELCDTERX
  2859     MOVE DD-CR2N                TO CNT-NAME (CLAS-INDEXC).       ELCDTERX
  2860     GO TO 0005-READ--CARD.                                       ELCDTERX
  2861                                                                  ELCDTERX
  2862 0015-READ--CARR.                                                 ELCDTERX
  2863     ADD 1  TO  CLAS-INDEXCN.                                     ELCDTERX
  2864     IF CLAS-INDEXCN LESS THAN +26                                ELCDTERX
  2865        MOVE DD-CARR1         TO CARRIER-SUB (CLAS-INDEXCN)
  2866        MOVE DD-CARR1S        TO CARRIER-DOM-ST (CLAS-INDEXCN)
  2867        MOVE DD-CARR1N        TO CARRIER-PIC (CLAS-INDEXCN)
  2868        MOVE DD-CARR1-UEP-PCT TO CARRIER-UEP-PCT (CLAS-INDEXCN)
  2869        MOVE DD-CARR1-R78-PCT TO CARRIER-R78-PCT (CLAS-INDEXCN)
  2870        MOVE DD-CARR1-PRO-PCT TO CARRIER-PRO-PCT (CLAS-INDEXCN)
  2871        MOVE DD-CARR1-SECPAY-SW
  2872                               TO CARRIER-SEC-PAY (CLAS-INDEXCN)
  2873     END-IF
  2874                                                                  ELCDTERX
  2875     ADD 1  TO  CLAS-INDEXCN.                                     ELCDTERX
  2876     IF CLAS-INDEXCN LESS THAN +26                                ELCDTERX
  2877        MOVE DD-CARR2         TO CARRIER-SUB (CLAS-INDEXCN)
  2878        MOVE DD-CARR2S        TO CARRIER-DOM-ST (CLAS-INDEXCN)
  2879        MOVE DD-CARR2N        TO CARRIER-PIC (CLAS-INDEXCN)
  2880        MOVE DD-CARR2-UEP-PCT TO CARRIER-UEP-PCT (CLAS-INDEXCN)
  2881        MOVE DD-CARR2-R78-PCT TO CARRIER-R78-PCT (CLAS-INDEXCN)
  2882        MOVE DD-CARR2-PRO-PCT TO CARRIER-PRO-PCT (CLAS-INDEXCN)
  2883        MOVE DD-CARR2-SECPAY-SW
  2884                              TO CARRIER-SEC-PAY (CLAS-INDEXCN)
  2885     END-IF
  2886                                                                  ELCDTERX
  2887                                                                  ELCDTERX
  2888     GO TO 0005-READ--CARD.                                       ELCDTERX
  2889                                                                  ELCDTERX
  2890 0020-READ--STAT.                                                 ELCDTERX
  2891     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  64
* EL539.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  2892     IF CLAS-INDEX GREATER 3  OR                                  ELCDTERX
  2893        DD-ST (CLAS-INDEX) = SPACE                                ELCDTERX
  2894         GO TO 0005-READ--CARD.                                   ELCDTERX
  2895                                                                  ELCDTERX
  2896     ADD 1                       TO CLAS-INDEXS.                  ELCDTERX
  2897     MOVE DD-ST (CLAS-INDEX)     TO STATE-NAME-FLD (CLAS-INDEXS). ELCDTERX
  2898     GO TO 0020-READ--STAT.                                       ELCDTERX
  2899                                                                  ELCDTERX
  2900 0025-READ--BUSC.                                                 ELCDTERX
  2901     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  2902     IF CLAS-INDEX GREATER 3  OR                                  ELCDTERX
  2903        DD-ST (CLAS-INDEX) = SPACE                                ELCDTERX
  2904         GO TO 0005-READ--CARD.                                   ELCDTERX
  2905                                                                  ELCDTERX
  2906     ADD 1                       TO CLAS-INDEXB.                  ELCDTERX
  2907     MOVE DD-ST (CLAS-INDEX)     TO CLAS-BUSC-FLD (CLAS-INDEXB).  ELCDTERX
  2908     GO TO 0025-READ--BUSC.                                       ELCDTERX
  2909                                                                  ELCDTERX
  2910 0030-READ--MORT.                                                 ELCDTERX
  2911     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  2912     IF CLAS-INDEX GREATER 2  OR                                  ELCDTERX
  2913        DD-MORT (CLAS-INDEX) = SPACE                              ELCDTERX
  2914         GO TO 0005-READ--CARD.                                   ELCDTERX
  2915                                                                  ELCDTERX
  2916     ADD 1                       TO CLAS-INDEXM.                  ELCDTERX
  2917     MOVE DD-MORT (CLAS-INDEX)   TO CLAS-MORT-FLD (CLAS-INDEXM).  ELCDTERX
  2918     GO TO 0030-READ--MORT.                                       ELCDTERX
  2919                                                                  ELCDTERX
  2920 0035-READ--CLXX.                                                 ELCDTERX
  2921     IF DD-IDX NOT = CLAS-CN                                      ELCDTERX
  2922          GO TO 0005-READ--CARD.                                  ELCDTERX
  2923                                                                  ELCDTERX
  2924     IF DD-PS-PIC (CLAS-INDEXEN) = 'X'                            ELCDTERX
  2925         DISPLAY '***********************************************'ELCDTERX
  2926         DISPLAY 'PROGRAM ECS-', PGM-SUB, ' NOT SCHEDULED TO RUN' ELCDTERX
  2927         DISPLAY '***********************************************'ELCDTERX
  2928         GO TO 0055-READ--STOP.                                   ELCDTERX
  2929                                                                  ELCDTERX
  2930     IF DD-PS-PIC (CLAS-INDEXEN) NOT LESS 'A'  AND                ELCDTERX
  2931        DD-PS-PIC (CLAS-INDEXEN) NOT GREATER 'I'                  ELCDTERX
  2932         MOVE '1'                TO DTE-FICH.                     ELCDTERX
  2933                                                                  ELCDTERX
  2934     IF DD-PS-PIC (CLAS-INDEXEN) NOT LESS 'J'  AND                ELCDTERX
  2935        DD-PS-PIC (CLAS-INDEXEN) NOT GREATER 'R'                  ELCDTERX
  2936         MOVE '2'                TO DTE-FICH.                     ELCDTERX
  2937                                                                  ELCDTERX
  2938*    MOVE DD-PS-PIC (CLAS-INDEXEN) TO DTE-PGM-OPT.                ELCDTERX
  2939     GO TO 0005-READ--CARD.                                       ELCDTERX
  2940                                                                  ELCDTERX
  2941 0040-READ--CLAI.                                                 ELCDTERX
  2942     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  2943     IF CLAS-INDEX GREATER 2  OR                                  ELCDTERX
  2944        DD-TYPE (CLAS-INDEX) = SPACE                              ELCDTERX
  2945         GO TO 0005-READ--CARD.                                   ELCDTERX
  2946                                                                  ELCDTERX
  2947     ADD 1                       TO CLAS-INDEXA.                  ELCDTERX
  2948     MOVE DD-TYPE (CLAS-INDEX) TO CLAS-ALL-TYPES (CLAS-INDEXA).   ELCDTERX
  2949     GO TO 0040-READ--CLAI.                                       ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  65
* EL539.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  2950                                                                  ELCDTERX
  2951 0045-READ--DUMP.                                                 ELCDTERX
  2952     MOVE +999 TO WS-RETURN-CODE                                  ELCDTERX
  2953     MOVE 'MISSING AND/OR INVALID CLAS DATE CARD'                 ELCDTERX
  2954                                 TO  WS-ABEND-MESSAGE             ELCDTERX
  2955     PERFORM ABEND-PGM.                                           ELCDTERX
  2956                                                                  ELCDTERX
  2957 0050-READ--POXX.                                                 ELCDTERX
  2958     IF DD-IDX NOT = CLAS-CO                                      ELCDTERX
  2959         GO TO 0005-READ--CARD.                                   ELCDTERX
  2960                                                                  ELCDTERX
  2961     IF DD-PS-PRC (CLAS-INDEXON) = 'X'                            ELCDTERX
  2962         DISPLAY '***********************************************'ELCDTERX
  2963         DISPLAY 'ECS - ', PGM-SUB, ' IS NOT SCHEDULED TO RUN'    ELCDTERX
  2964         DISPLAY '***********************************************'ELCDTERX
  2965         GO TO 0055-READ--STOP.                                   ELCDTERX
  2966                                                                  ELCDTERX
  2967     MOVE DD-PS-PRT (CLAS-INDEXON) TO DTE-PRT-OPT.                ELCDTERX
  2968     MOVE DD-PS-FMT (CLAS-INDEXON) TO DTE-FMT-OPT.                ELCDTERX
  2969     MOVE DD-PS-PRC (CLAS-INDEXON) TO DTE-PRC-OPT DTE-PGM-OPT.    ELCDTERX
  2970     MOVE DD-PS-TOT (CLAS-INDEXON) TO DTE-TOT-OPT.                ELCDTERX
  2971                                                                  ELCDTERX
  2972     IF DTE-PRT-OPT = 'B'                                         ELCDTERX
  2973         MOVE '2'                  TO DTE-FICH.                   ELCDTERX
  2974     IF DTE-PRT-OPT = 'F'                                         ELCDTERX
  2975         MOVE '1'                  TO DTE-FICH.                   ELCDTERX
  2976                                                                  ELCDTERX
  2977     GO TO 0005-READ--CARD.                                       ELCDTERX
  2978                                                                  ELCDTERX
  2979 0055-READ--STOP.                                                 ELCDTERX
  2980     GOBACK.                                                      ELCDTERX
  2981                                                                  ELCDTERX
  2982 0060-READ--TEST.                                                 ELCDTERX
  2983     IF DATX-COD        = SPACE  OR                               ELCDTERX
  2984        CLAX-ID         = SPACE  OR                               ELCDTERX
  2985        DATE-OPTIONS-ID = SPACE                                   ELCDTERX
  2986         GO TO 0045-READ--DUMP.                                   ELCDTERX
  2987                                                                  ELCDTERX
  2988     MOVE LOW-VALUE TO CLAS-TYPE-MISC.                            ELCDTERX
  2989     GO TO 0079-READ--EXIT.                                       ELCDTERX
  2990                                                                  ELCDTERX
  2991 0065-READ--COLC.                                                 ELCDTERX
  2992     MOVE DATE-DISK              TO CLASIC-SYSTEM-CODES.          ELCDTERX
  2993     GO TO 0005-READ--CARD.                                       ELCDTERX
  2994                                                                  ELCDTERX
  2995 0070-READ--OPCA.                                                 ELCDTERX
  2996                                                                  ELCDTERX
  2997     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  2998                                                                  ELCDTERX
  2999     IF  CLAS-INDEX GREATER 13                                    ELCDTERX
  3000             OR                                                   ELCDTERX
  3001         DD-CARR-FLDS (CLAS-INDEX) = SPACE                        ELCDTERX
  3002         GO TO 0005-READ--CARD.                                   ELCDTERX
  3003                                                                  ELCDTERX
  3004     ADD 1                       TO INDEXCA.                      ELCDTERX
  3005     MOVE DD-CARR-FLDS (CLAS-INDEX)                               ELCDTERX
  3006                                 TO CARRIER-FLDS (INDEXCA).       ELCDTERX
  3007     GO TO 0070-READ--OPCA.                                       ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  66
* EL539.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  3008                                                                  ELCDTERX
  3009 0072-READ--OPST.                                                 ELCDTERX
  3010                                                                  ELCDTERX
  3011     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  3012                                                                  ELCDTERX
  3013     IF  CLAS-INDEX GREATER 16                                    ELCDTERX
  3014             OR                                                   ELCDTERX
  3015         DD-TLR (CLAS-INDEX) = SPACE                              ELCDTERX
  3016         GO TO 0005-READ--CARD.                                   ELCDTERX
  3017                                                                  ELCDTERX
  3018     ADD 1                       TO INDEXST.                      ELCDTERX
  3019     MOVE DD-STATE-FLDS (CLAS-INDEX)                              ELCDTERX
  3020                                 TO STATE-TLR-FLD (INDEXST).      ELCDTERX
  3021     GO TO 0072-READ--OPST.                                       ELCDTERX
  3022                                                                  ELCDTERX
  3023 0074-READ--OPBS.                                                 ELCDTERX
  3024                                                                  ELCDTERX
  3025     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  3026                                                                  ELCDTERX
  3027     IF  CLAS-INDEX GREATER 32                                    ELCDTERX
  3028             OR                                                   ELCDTERX
  3029         DD-TLR (CLAS-INDEX) = SPACE                              ELCDTERX
  3030         GO TO 0005-READ--CARD.                                   ELCDTERX
  3031                                                                  ELCDTERX
  3032     ADD 1                       TO INDEXBS.                      ELCDTERX
  3033     MOVE DD-TLR (CLAS-INDEX)    TO BUS-TLRM-FLD (INDEXBS).       ELCDTERX
  3034     GO TO 0074-READ--OPBS.                                       ELCDTERX
  3035                                                                  ELCDTERX
  3036 0079-READ--EXIT.                                                 ELCDTERX
  3037*    EXIT.                                                        ELCDTERX
  3038******************************************************************ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  67
* EL539.cbl
  3040 0100-PUT-CO.
  3041     MOVE LIFE-OVERRIDE-L6       TO  H11-LF
  3042                                     SUM-HD1-LF.
  3043     MOVE AH-OVERRIDE-L6         TO  H11-AH
  3044                                     SUM-HD1-AH.
  3045     MOVE LOW-VALUES             TO  CONA-LOVAL.
  3046     MOVE COMPANY-NAME           TO  CONA-NAME.
  3047     MOVE ALPH-DATE              TO  CONA-ANDT.
  3048
  3049     IF DTE-PGM-OPT  IS NOT EQUAL TO  2
  3050         OPEN INPUT ERPNDB
  3051     ELSE
  3052         OPEN INPUT EXTRACT-INTERFACE-FILE.
  3053
  3054     OPEN INPUT ERACCT
  3055          I-O   ERLOFC.
  3056
  3057     IF DTE-PGM-OPT  IS NOT EQUAL TO  2
  3058         IF PB-STATUS  IS EQUAL TO  '00'  OR  '97'
  3059             NEXT SENTENCE
  3060         ELSE
  3061             MOVE PB-STATUS      TO  WS-ABEND-FILE-STATUS
  3062             MOVE 'ERROR ON OPEN - ERPNDB'
  3063                                 TO  WS-ABEND-MESSAGE
  3064             GO TO ABEND-PGM.
  3065
  3066     IF AM-FILE-STATUS  IS EQUAL TO  '00'  OR  '97'
  3067         NEXT SENTENCE
  3068     ELSE
  3069         MOVE AM-FILE-STATUS     TO  WS-ABEND-FILE-STATUS
  3070         MOVE 'ERROR ON OPEN - ERACCT'
  3071                                 TO  WS-ABEND-MESSAGE
  3072         GO TO ABEND-PGM.
  3073
  3074     IF LO-STATUS  IS EQUAL TO  '00'  OR  '97'
  3075         NEXT SENTENCE
  3076     ELSE
  3077         MOVE LO-STATUS          TO  WS-ABEND-FILE-STATUS
  3078         MOVE 'ERROR ON OPEN - ERLOFC'
  3079                                 TO  WS-ABEND-MESSAGE
  3080         GO TO ABEND-PGM.
  3081
  3082     IF DTE-PRT-OPT  IS EQUAL TO  'P'  OR  'B'  OR  'T'
  3083         OPEN OUTPUT PRINT-FILE.
  3084
  3085 0200-SORT-RECS SECTION.
  3086     SORT SORT-WORK  ON ASCENDING KEY  SORT-CTL
  3087         INPUT PROCEDURE 0300-INPUT-SECT  THRU  1099-EXIT
  3088         OUTPUT PROCEDURE 1100-PUT-REPORTS  THRU  1199-EXIT.
  3089
  3090     IF SORT-RETURN  IS NOT EQUAL TO  ZEROS
  3091         MOVE '0101'             TO  WS-RETURN-CODE
  3092         MOVE 'BAD SORT RETURN CODE '
  3093                                 TO  WS-ABEND-MESSAGE
  3094         GO TO ABEND-PGM.
  3095
  3096*    DISPLAY '  FIX COUNTS  ' WS-FIX-CNT
  3097
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  68
* EL539.cbl
  3098     GO TO 9000-EOJ.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  69
* EL539.cbl
  3100 0300-INPUT-SECT SECTION.
  3101     MOVE CONAMREC               TO  SORT-RECORD.
  3102
  3103 0310-RELEASE.
  3104*    MOVE SPACES                 TO  SC-ST
  3105
  3106     RELEASE SORT-RECORD.
  3107
  3108 0319-EXIT.
  3109     EXIT.
  3110
  3111 0400-READ-INPUT.
  3112     IF DTE-PGM-OPT  IS EQUAL TO  2
  3113         GO TO 0410-ISSUES-CANCELS.
  3114
  3115     MOVE LOW-VALUE              TO  PB-CONTROL-BY-ACCOUNT.
  3116     MOVE DTE-CLASIC-COMPANY-CD  TO  PB-COMP-CD.
  3117
  3118     MOVE PB-CONTROL-BY-ACCOUNT  TO  PB-CONTROL-BY-ACCT.
  3119
  3120     START ERPNDB  KEY  GREATER  THAN  PB-CONTROL-BY-ACCT.
  3121
  3122     IF PB-STATUS  IS EQUAL TO  '23'
  3123         GO TO 0800-END-INPUT.
  3124
  3125     IF PB-STAT-1  IS NOT EQUAL TO  '0'
  3126         MOVE PB-STATUS          TO  WS-ABEND-FILE-STATUS
  3127         MOVE 'ERROR OCCURRED START - ERPNDB'
  3128                                 TO  WS-ABEND-MESSAGE
  3129         GO TO ABEND-PGM.
  3130
  3131     GO TO 0420-ISSUES-CANCELS.
  3132
  3133 0410-ISSUES-CANCELS.
  3134     READ EXTRACT-INTERFACE-FILE  INTO  EXTRACT-INTERFACE-RECORD
  3135         AT END
  3136             GO TO 0800-END-INPUT.
  3137
  3138     IF EX-EXTRACT-CODE  IS GREATER THAN  'A'
  3139         GO TO 0800-END-INPUT.
  3140
  3141     IF EX-RECORD-TYPE  IS GREATER THAN  'E'
  3142         GO TO 0800-END-INPUT.
  3143
  3144     IF EX-COMPANY-CD  IS LESS THAN  DTE-CLASIC-COMPANY-CD
  3145         GO TO 0410-ISSUES-CANCELS.
  3146
  3147     IF EX-COMPANY-CD  IS GREATER THAN  DTE-CLASIC-COMPANY-CD
  3148         GO TO 0800-END-INPUT.
  3149
  3150     IF EX-RECORD-TYPE  IS NOT EQUAL TO  'A'
  3151         GO TO 0410-ISSUES-CANCELS.
  3152
  3153     MOVE EX-DATA-AREAS          TO  PENDING-BUSINESS.
  3154
  3155     GO TO 0430-PICKUP.
  3156
  3157 0420-ISSUES-CANCELS.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  70
* EL539.cbl
  3158     IF DTE-PGM-OPT  IS EQUAL TO  2
  3159         GO TO 0410-ISSUES-CANCELS.
  3160
  3161     READ ERPNDB  NEXT RECORD  INTO  PENDING-BUSINESS.
  3162
  3163     IF PB-STAT-1  IS EQUAL TO  '1'
  3164         GO TO 0800-END-INPUT.
  3165
  3166     IF PB-STAT-1  IS NOT EQUAL TO  '0'
  3167         MOVE PB-STATUS          TO  WS-ABEND-FILE-STATUS
  3168         MOVE 'ERROR OCCURRED READ - ERPNDB'
  3169                                 TO  WS-ABEND-MESSAGE
  3170         GO TO ABEND-PGM.
  3171
  3172 0430-PICKUP.
  3173     IF PB-COMPANY-CD  IS NOT EQUAL TO  DTE-CLASIC-COMPANY-CD
  3174         GO TO 0800-END-INPUT.
  3175
  3176     IF PB-ISSUE
  3177       AND CLASIC-CREATED-CERT
  3178         GO TO 0420-ISSUES-CANCELS.
  3179
  3180     IF PB-ISSUE
  3181       OR PB-CANCELLATION
  3182         NEXT SENTENCE
  3183     ELSE
  3184         GO TO 0420-ISSUES-CANCELS.
  3185
  3186     IF PB-REIN-ONLY-CERT
  3187       OR PB-REISSUED-CERT
  3188       OR PB-MONTHLY-CERT
  3189       OR PB-PREM-ACCTNG-ONLY
  3190       OR PB-POLICY-IS-DECLINED
  3191       OR PB-POLICY-IS-VOIDED
  3192         GO TO 0420-ISSUES-CANCELS.
  3193
  3194     IF PB-UNFORCED-ERRORS
  3195       OR PB-FATAL-ERRORS
  3196       OR PB-RECORD-ON-HOLD
  3197       OR PB-RECORD-RETURNED
  3198         GO TO 0420-ISSUES-CANCELS.
  3199
  3200*    IF DTE-CLIENT  IS EQUAL TO  'MON' OR 'CID'
  3201*        IF PB-ISSUE
  3202*          AND (PB-I-LOAN-OFFICER  IS EQUAL TO  SPACES
  3203*          OR PB-I-LOAN-OFFICER  IS EQUAL TO  LOW-VALUES)
  3204*            GO TO 0420-ISSUES-CANCELS.
  3205*
  3206*    IF DTE-CLIENT  IS EQUAL TO  'MON' OR 'CID'
  3207*        IF PB-CANCELLATION
  3208*          AND (PB-CI-LOAN-OFFICER  IS EQUAL TO  SPACES
  3209*          OR PB-CI-LOAN-OFFICER  IS EQUAL TO  LOW-VALUES)
  3210*            GO TO 0420-ISSUES-CANCELS.
  3211
  3212     IF DTE-CLIENT = 'UCL'
  3213         IF (PB-SV-CARRIER = '6') OR
  3214            (PB-SV-CARRIER = '2' AND PB-ACCOUNT = '0000000651')
  3215             NEXT SENTENCE
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  71
* EL539.cbl
  3216           ELSE
  3217             GO TO 0420-ISSUES-CANCELS.
  3218
  3219*    IF DTE-CLIENT = 'CID'
  3220*       IF PB-ISSUE
  3221*          IF PB-ACCOUNT = '0000677100'
  3222*             IF PB-CERT-NO = '0010455406 '
  3223*                MOVE '001' TO PB-CI-LOAN-OFFICER
  3224*                ADD 1 TO WS-FIX-CNT
  3225*             END-IF
  3226*          END-IF
  3227*       END-IF
  3228*    END-IF
  3229*
  3230     MOVE PB-CONTROL-BY-ACCOUNT  TO  PEND-REC.
  3231
  3232     IF DTE-COMP-VG  IS EQUAL TO  ' '
  3233         MOVE PB-SV-CARRIER      TO  PEND-CARR
  3234         MOVE PB-SV-GROUPING     TO  PEND-GRP.
  3235
  3236     IF DTE-COMP-VG  IS EQUAL TO  '2'
  3237         MOVE PB-SV-GROUPING     TO  PEND-GRP.
  3238
  3239     IF DTE-COMP-VG  IS EQUAL TO  '3'
  3240         MOVE PB-SV-CARRIER      TO  PEND-CARR
  3241         MOVE PB-SV-GROUPING     TO  PEND-GRP
  3242         MOVE PB-SV-STATE        TO  PEND-ST.
  3243
  3244     IF DTE-COMP-VG  IS EQUAL TO  '4'
  3245         MOVE PB-SV-GROUPING     TO  PEND-GRP
  3246         MOVE PB-SV-STATE        TO  PEND-ST.
  3247
  3248*  ok, right here we went to a new acct so go get the
  3249*  name and address of the newest date range of the
  3250*  acct that is in key-20. key-20 contains the key
  3251*  of the previous pending/acct record
  3252
  3253     IF (PB-CONTROL-BY-ACCOUNT (1:20) NOT =
  3254        AM-CONTROL-PRIMARY (1:20))
  3255        AND (KEY-20 NOT = LOW-VALUES)
  3256        PERFORM 0700-GET-AM-NAME THRU 0700-EXIT
  3257        MOVE LOW-VALUES          TO KEY-20
  3258     END-IF
  3259
  3260*  ok, right here we are checking to see if we are
  3261*  in the correct acct dt range, if not get there.
  3262
  3263     IF (PB-CONTROL-BY-ACCOUNT (1:20) =
  3264        AM-CONTROL-PRIMARY (1:20))
  3265        AND (PB-CERT-EFF-DT >= AM-EFFECTIVE-DT)
  3266        AND (PB-CERT-EFF-DT < AM-EXPIRATION-DT)
  3267        CONTINUE
  3268     ELSE
  3269        PERFORM 0710-MATCH-TO-ACCT
  3270                                 THRU 0710-EXIT
  3271     END-IF
  3272
  3273* THIS MEANS THAT THERE IS NO ERACCT RECORD FOR THE PEND REC
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  72
* EL539.cbl
  3274* WHICH IS COMMON FOR PENDING BUSINESS
  3275
  3276     IF SKIP-THIS-ACCT  = 'Y'
  3277        GO TO 0420-ISSUES-CANCELS
  3278     END-IF
  3279
  3280     IF (AM-EDIT-LOAN-OFC NOT = 'Y')
  3281                  OR
  3282        ((WS-BANK NOT = SPACES) AND
  3283         (WS-BANK NOT = AM-USER-SELECT-1))
  3284         GO TO 0420-ISSUES-CANCELS
  3285     END-IF
  3286
  3287* AT THIS POINT WE KNOW THIS PEND REC WILL BE ON THE
  3288* EL539 REPORT SO WE WILL POPULATE THE KEY-20
  3289
  3290     MOVE PEND-REC               TO KEY-20
  3291     MOVE PB-CERT-EFF-DT         TO KEY-EFF-DT
  3292
  3293     MOVE PB-CERT-EFF-DT         TO  DC-BIN-DATE-1.
  3294     MOVE SPACE                  TO  DC-OPTION-CODE.
  3295
  3296     PERFORM 0500-DATE-RTN  THRU  0599-EXIT.
  3297
  3298     MOVE DC-GREG-DATE-CYMD      TO  PEND-YRMODA.
  3299     MOVE PB-CERT-PRIME          TO  PEND-CERT-PRIME.
  3300     MOVE PB-CERT-SFX            TO  PEND-CERT-SFX.
  3301
  3302     IF NOT PB-ISSUE
  3303         GO TO 0440-CHK-CANCEL.
  3304
  3305     IF PB-I-LOAN-OFFICER = SPACES
  3306         MOVE '99999'            TO PB-I-LOAN-OFFICER
  3307     END-IF
  3308
  3309     IF PB-I-LOAN-OFFICER (5:1) = LOW-VALUES
  3310        MOVE SPACES TO PB-I-LOAN-OFFICER (5:1)
  3311     END-IF
  3312     IF PB-I-LOAN-OFFICER (4:1) = LOW-VALUES
  3313        MOVE SPACES TO PB-I-LOAN-OFFICER (4:1)
  3314     END-IF
  3315     MOVE PB-I-LOAN-OFFICER      TO PEND-OFFICER.
  3316     MOVE PEND-REC               TO  KEY-23.
  3317
  3318     IF KEY-23  IS NOT EQUAL TO  LST-OFFCR
  3319         PERFORM 0600-GET-LOAN-OFFICER  THRU  0699-EXIT.
  3320
  3321     IF SKIP-THIS-LOAN-OFCR EQUAL 'Y'
  3322         GO TO 0420-ISSUES-CANCELS.
  3323
  3324     MOVE PB-I-INSURED-LAST-NAME TO  PEND-NAME.
  3325     MOVE PB-I-INSURED-1ST-INIT  TO  PEND-INIT.
  3326     MOVE PB-I-AGE               TO  PEND-AGE.
  3327     MOVE PB-I-LF-ABBR           TO  PEND-LF-TYP.
  3328     MOVE PB-I-LF-PREMIUM-AMT    TO  PEND-LF-PRM.
  3329
  3330     IF PB-I-LF-ALT-PREMIUM-AMT  IS GREATER THAN  ZEROS
  3331         COMPUTE PEND-LF-PRM = PEND-LF-PRM
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  73
* EL539.cbl
  3332                             + PB-I-LF-ALT-PREMIUM-AMT.
  3333
  3334     MOVE PB-I-LF-BENEFIT-AMT    TO  PEND-LF-AMT.
  3335
  3336     IF PB-I-LF-ALT-BENEFIT-AMT  IS GREATER THAN  ZEROS
  3337         COMPUTE PEND-LF-AMT = PEND-LF-AMT
  3338                             + PB-I-LF-ALT-BENEFIT-AMT.
  3339
  3340     MOVE PB-I-AH-ABBR           TO  PEND-AH-TYP.
  3341     MOVE PB-I-AH-PREMIUM-AMT    TO  PEND-AH-PRM.
  3342
  3343     IF DTE-CLIENT = 'UCL'
  3344         NEXT SENTENCE
  3345      ELSE
  3346         GO TO 0435-CONTINUE.
  3347
  3348     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
  3349         COMPUTE PEND-LF-PRM = PB-I-LF-PREM-CALC
  3350                             + PB-I-LF-ALT-PREM-CALC.
  3351
  3352     IF PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH
  3353         MOVE PB-I-AH-PREM-CALC  TO PEND-AH-PRM.
  3354
  3355 0435-CONTINUE.
  3356*    MULTIPLY PB-I-AH-BENEFIT-AMT  BY  PB-I-AH-TERM
  3357*        GIVING  PEND-AH-AMT.
  3358     MOVE PB-I-AH-BENEFIT-AMT    TO  PEND-AH-AMT
  3359
  3360     MOVE PB-I-LF-TERM           TO  PEND-LF-TERM.
  3361     MOVE PB-I-AH-TERM           TO  PEND-AH-TERM.
  3362
  3363     COMPUTE PEND-LF-COM ROUNDED =
  3364         PEND-LF-PRM * PB-I-LIFE-COMMISSION.
  3365     COMPUTE PEND-AH-COM ROUNDED =
  3366         PEND-AH-PRM * PB-I-AH-COMMISSION.
  3367
  3368     MOVE PEND-REC               TO  SORT-RECORD.
  3369
  3370     PERFORM 0310-RELEASE  THRU  0319-EXIT.
  3371
  3372     GO TO 0420-ISSUES-CANCELS.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  74
* EL539.cbl
  3374 0440-CHK-CANCEL.
  3375     IF NOT PB-CANCELLATION
  3376         GO TO 0420-ISSUES-CANCELS.
  3377
  3378     IF PB-CI-LOAN-OFFICER = SPACES
  3379         MOVE '99999'            TO PB-CI-LOAN-OFFICER
  3380     END-IF
  3381
  3382     IF PB-CI-LOAN-OFFICER (5:1) = LOW-VALUES
  3383        MOVE SPACES TO PB-CI-LOAN-OFFICER (5:1)
  3384     END-IF
  3385     IF PB-CI-LOAN-OFFICER (4:1) = LOW-VALUES
  3386        MOVE SPACES TO PB-CI-LOAN-OFFICER (4:1)
  3387     END-IF
  3388     MOVE PB-CI-LOAN-OFFICER     TO PEND-OFFICER.
  3389     MOVE PEND-REC               TO  KEY-23.
  3390
  3391     IF KEY-23  IS NOT EQUAL TO  LST-OFFCR
  3392         PERFORM 0600-GET-LOAN-OFFICER  THRU  0699-EXIT.
  3393
  3394     IF SKIP-THIS-LOAN-OFCR EQUAL 'Y'
  3395         GO TO 0420-ISSUES-CANCELS.
  3396
  3397     MOVE PB-CI-LAST-NAME        TO  PEND-NAME.
  3398     MOVE PB-CI-INITIALS         TO  PEND-INIT.
  3399     MOVE PB-CI-INSURED-AGE      TO  PEND-AGE.
  3400     MOVE PB-CI-LF-ABBR          TO  PEND-LF-TYP.
  3401     MOVE PB-CI-AH-ABBR          TO  PEND-AH-TYP.
  3402     MOVE PB-CI-LF-TERM          TO  PEND-LF-TERM.
  3403     MOVE PB-CI-AH-TERM          TO  PEND-AH-TERM.
  3404
  3405     MULTIPLY PB-C-LF-CANCEL-AMT  BY  -1  GIVING  PEND-LF-PRM.
  3406     MULTIPLY PB-C-AH-CANCEL-AMT  BY  -1  GIVING  PEND-AH-PRM.
  3407
  3408     IF DTE-CLIENT = 'UCL'
  3409         NEXT SENTENCE
  3410      ELSE
  3411         GO TO 0535-CONTINUE.
  3412
  3413     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
  3414         MULTIPLY PB-C-LF-REF-CALC BY -1 GIVING PEND-LF-PRM.
  3415
  3416     IF PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH
  3417         MULTIPLY PB-C-AH-REF-CALC BY -1 GIVING PEND-AH-PRM.
  3418
  3419 0535-CONTINUE.
  3420     MOVE ZERO                   TO  PEND-LF-AMT  PEND-AH-AMT.
  3421
  3422     COMPUTE PEND-LF-COM ROUNDED = PB-CI-LIFE-COMMISSION
  3423                                 * PEND-LF-PRM.
  3424     COMPUTE PEND-AH-COM ROUNDED = PB-CI-AH-COMMISSION
  3425                                 * PEND-AH-PRM.
  3426
  3427     MOVE PEND-REC               TO  SORT-RECORD.
  3428
  3429     PERFORM 0310-RELEASE  THRU  0319-EXIT.
  3430
  3431     GO TO 0420-ISSUES-CANCELS.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  75
* EL539.cbl
  3433 0500-DATE-RTN.
  3434     CALL 'ELDATCX'  USING  DATE-CONVERSION-DATA.
  3435
  3436     IF DC-ERROR-CODE  IS NOT EQUAL TO  SPACE
  3437         MOVE ZERO               TO  DC-CONVERSION-DATES.
  3438
  3439 0599-EXIT.
  3440     EXIT.
  3441
  3442 0600-GET-LOAN-OFFICER.
  3443     MOVE PEND-REC               TO  LST-OFFCR.
  3444     MOVE SPACES                 TO  LO-CONTROL-PRIMARY.
  3445     MOVE PB-COMPANY-CD-A1       TO  LO-COMPANY-CD.
  3446     MOVE PB-CARRIER             TO  LO-CARRIER.
  3447     MOVE PB-GROUPING            TO  LO-GROUPING.
  3448     MOVE PB-STATE               TO  LO-STATE.
  3449     MOVE PB-ACCOUNT             TO  LO-ACCOUNT.
  3450     MOVE PEND-OFFICER           TO  LO-OFFICER-CODE.
  3451
  3452     READ ERLOFC.
  3453
  3454     IF LO-STAT-1  IS EQUAL TO  '1'
  3455         GO TO 0620-INV-LO.
  3456
  3457     IF LO-STATUS  IS EQUAL TO  '23'
  3458         GO TO 0620-INV-LO.
  3459
  3460     IF LO-COMPANY-CD  IS NOT EQUAL TO  PB-COMPANY-CD-A1
  3461         GO TO 0620-INV-LO.
  3462
  3463     IF LO-STATUS  IS NOT EQUAL TO  ZERO
  3464         MOVE LO-STATUS          TO  WS-ABEND-FILE-STATUS
  3465         MOVE 'ERROR OCCURRED READ - EROFCR'
  3466                                 TO  WS-ABEND-MESSAGE
  3467         GO TO ABEND-PGM.
  3468
  3469     IF LO-CONTROL-PRIMARY  IS GREATER THAN  KEY-23
  3470         GO TO 0620-INV-LO.
  3471
  3472     MOVE LO-OFFICER-NAME        TO  LN-OFFCR.
  3473     MOVE LO-OPT1                TO  LN-OPT1.
  3474     MOVE LO-OPT2                TO  LN-OPT2.
  3475     MOVE LO-CONTROL-PRIMARY     TO  LST-OFFCR.
  3476
  3477 0610-PUT-LO.
  3478     MOVE LO-COMPANY-CD          TO  LN-CO.
  3479     MOVE PEND-CARR              TO  LN-CARR.
  3480     MOVE PEND-GRP               TO  LN-GRP.
  3481     MOVE PEND-ST                TO  LN-ST.
  3482     MOVE LO-ACCOUNT             TO  LN-ACCT.
  3483     MOVE LO-OFFICER-CODE        TO  LN-OFFCODE.
  3484     MOVE LOW-VALUES             TO  LN-LOVAL.
  3485     MOVE LO-OFFICER-NAME        TO  LN-OFFCR.
  3486     MOVE LO-COMP-CONTROL        TO  LN-OPT1.
  3487     MOVE LO-DETAIL-CONTROL      TO  LN-OPT2.
  3488     MOVE LN-REC                 TO  SORT-RECORD.
  3489
  3490     PERFORM 0310-RELEASE  THRU  0319-EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  76
* EL539.cbl
  3491
  3492     MOVE 'N'                    TO  SKIP-THIS-LOAN-OFCR.
  3493
  3494     GO TO 0699-EXIT.
  3495
  3496 0620-INV-LO.
  3497     MOVE HIGH-VALUES            TO  PEND-OFFICER  LST-OFFCR.
  3498
  3499     IF DTE-FMT-OPT EQUAL '2'
  3500         MOVE 'Y'                TO  SKIP-THIS-LOAN-OFCR
  3501         GO TO 0699-EXIT.
  3502
  3503     IF HAVE-HIGH-VALUE  IS EQUAL TO  'Y'
  3504         GO TO 0699-EXIT.
  3505
  3506     MOVE PEND-CO                TO  LN-CO.
  3507     MOVE PEND-CARR              TO  LN-CARR.
  3508     MOVE PEND-GRP               TO  LN-GRP.
  3509     MOVE PEND-ST                TO  LN-ST.
  3510     MOVE PB-ACCOUNT             TO  LN-ACCT.
  3511     MOVE HIGH-VALUES            TO  LN-OFFCODE.
  3512     MOVE LOW-VALUE              TO  LN-LOVAL.
  3513     MOVE 'UNASSIGNED'           TO  LN-OFFCR.
  3514     MOVE 'Y'                    TO  LN-OPT1.
  3515     MOVE 'D'                    TO  LN-OPT2.
  3516     MOVE 'Y'                    TO  HAVE-HIGH-VALUE.
  3517     MOVE LN-REC                 TO  SORT-RECORD.
  3518     MOVE LN-REC                 TO  LST-OFFCR.
  3519
  3520     PERFORM 0310-RELEASE  THRU  0319-EXIT.
  3521
  3522 0699-EXIT.
  3523     EXIT.
  3524
  3525 0700-GET-AM-NAME.
  3526
  3527     IF AM-EXPIRATION-DT NOT = HIGH-VALUES
  3528        PERFORM UNTIL
  3529          (AM-FILE-STATUS   NOT = '00')
  3530          OR (AM-COMPANY-CD NOT = KEY-20 (1:1))
  3531          OR (AM-ACCOUNT    NOT = KEY-20 (11:10))
  3532          MOVE ACCOUNT-MASTER      TO WS-HOLD-ERACCT
  3533          READ ERACCT  NEXT RECORD
  3534        END-PERFORM
  3535        MOVE WS-HOLD-ERACCT      TO ACCOUNT-MASTER
  3536     END-IF
  3537
  3538     MOVE AM-NAME                TO ACCT-NAME
  3539     MOVE AM-PERSON              TO ACCT-PERSON
  3540     MOVE AM-ADDRS               TO ACCT-ADDR1
  3541     MOVE SPACES                 TO ACCT-CTY-ST
  3542     STRING AM-ADDR-CITY ' ' AM-ADDR-STATE
  3543        DELIMITED BY '  ' INTO ACCT-CTY-ST
  3544     END-STRING
  3545
  3546     IF AM-CANADIAN-POST-CODE
  3547        MOVE AM-CAN-POSTAL-1     TO ACCT-CAN-POSTAL-CODE-1
  3548        MOVE AM-CAN-POSTAL-2     TO ACCT-CAN-POSTAL-CODE-2
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  77
* EL539.cbl
  3549        MOVE SPACES              TO ACCT-CAN-FILLER
  3550     ELSE
  3551        MOVE AM-ZIP-PRIME        TO ACCT-ZIP-PRIME
  3552        IF AM-ZIP-PLUS4 = SPACES OR ZEROS
  3553           MOVE SPACES           TO ACCT-ZIP-PLUS4
  3554        ELSE
  3555           MOVE AM-ZIP-PLUS4     TO ACCT-ZIP-PLUS4
  3556        END-IF
  3557     END-IF
  3558
  3559     MOVE AM-COMPANY-CD          TO ACCT-CO
  3560     MOVE AM-CARRIER             TO ACCT-CARR
  3561     MOVE AM-GROUPING            TO ACCT-GRP
  3562     MOVE AM-STATE               TO ACCT-ST
  3563     MOVE AM-ACCOUNT             TO ACCT-NUM
  3564     MOVE LOW-VALUES             TO ACCT-LOVAL
  3565     MOVE ACCT-REC               TO SORT-RECORD
  3566
  3567     PERFORM 0310-RELEASE  THRU  0319-EXIT.
  3568
  3569     MOVE 'N'                    TO  HAVE-HIGH-VALUE
  3570
  3571     .
  3572 0700-EXIT.
  3573     EXIT.
  3574
  3575 0710-MATCH-TO-ACCT.
  3576
  3577* THE REASON WE DO A START EVERY TIME IS BECAUSE IT IS VERY
  3578* LIKELY THAT THERE IS A ERPNDB RECORD WITH NO MATCHING
  3579* ERACCT RECORD.  WEIRD, I KNOW BUT IT HAPPENS ALL THE TIME
  3580
  3581     MOVE SPACE                  TO AM-CONTROL-PRIMARY
  3582     MOVE 'N'                    TO HAVE-HIGH-VALUE
  3583                                    SKIP-THIS-ACCT
  3584     MOVE LOW-VALUES             TO LST-OFFCR  HLD-CTL
  3585     MOVE PEND-CO                TO AM-COMPANY-CD
  3586     MOVE PEND-CARR              TO AM-CARRIER
  3587     MOVE PEND-GRP               TO AM-GROUPING
  3588     MOVE PEND-ST                TO AM-STATE
  3589     MOVE PB-ACCOUNT             TO AM-ACCOUNT
  3590     MOVE PB-CERT-EFF-DT         TO AM-EXPIRATION-DT
  3591
  3592     START ERACCT KEY > AM-CONTROL-PRIMARY
  3593
  3594     IF AM-FILE-STATUS = '23' OR '22'
  3595        MOVE 'Y'                 TO SKIP-THIS-ACCT
  3596        GO TO 0710-EXIT
  3597     END-IF
  3598
  3599     IF AM-STAT-1 NOT = '0'
  3600        MOVE AM-FILE-STATUS      TO WS-ABEND-FILE-STATUS
  3601        MOVE 'ERROR OCCURRED START - ERACCT'
  3602                                 TO WS-ABEND-MESSAGE
  3603        GO TO ABEND-PGM
  3604     END-IF
  3605
  3606     READ ERACCT  NEXT RECORD
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  78
* EL539.cbl
  3607
  3608     IF AM-FILE-STATUS = '23' OR '22' OR '10'
  3609        MOVE 'Y'                 TO SKIP-THIS-ACCT
  3610        GO TO 0710-EXIT
  3611     END-IF
  3612
  3613     IF (PB-CONTROL-BY-ACCOUNT (1:20) =
  3614        AM-CONTROL-PRIMARY (1:20))
  3615        AND (PB-CERT-EFF-DT >= AM-EFFECTIVE-DT)
  3616        AND (PB-CERT-EFF-DT < AM-EXPIRATION-DT)
  3617        CONTINUE
  3618     ELSE
  3619        MOVE 'Y'                 TO SKIP-THIS-ACCT
  3620     END-IF
  3621
  3622     .
  3623 0710-EXIT.
  3624     EXIT.
  3625
  3626 0800-END-INPUT.
  3627
  3628     IF KEY-20 NOT = LOW-VALUES
  3629        PERFORM 0700-GET-AM-NAME THRU 0700-EXIT
  3630     END-IF
  3631
  3632* since we don't maintain production info for our
  3633* loan officers, lets just go to the exit
  3634
  3635     GO TO 1099-EXIT
  3636
  3637     .
  3638 0810-GET-LOAN-OFFICERS.
  3639     MOVE SPACES                 TO  SAVE-ACCOUNT
  3640                                     LO-CONTROL-PRIMARY.
  3641     MOVE DTE-CLASIC-COMPANY-CD  TO  LO-COMPANY-CD.
  3642
  3643     START ERLOFC  KEY  NOT LESS THAN  LO-CONTROL-PRIMARY.
  3644
  3645     EVALUATE TRUE
  3646     WHEN LO-STATUS = '00'
  3647         CONTINUE
  3648
  3649     WHEN LO-STATUS = '23'
  3650         GO TO 1099-EXIT
  3651
  3652     WHEN OTHER
  3653         MOVE LO-STATUS          TO  WS-ABEND-FILE-STATUS
  3654         MOVE 'ERROR OCCURRED START - EROFCR'
  3655                                 TO  WS-ABEND-MESSAGE
  3656         GO TO ABEND-PGM
  3657     END-EVALUATE.
  3658
  3659 0820-GET-NEXT-OFFICER.
  3660     READ ERLOFC  NEXT RECORD.
  3661
  3662     IF DTE-FMT-OPT EQUAL '2'
  3663         GO TO 1099-EXIT.
  3664
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  79
* EL539.cbl
  3665     IF LO-STATUS  IS EQUAL TO  '23'  OR  '10'
  3666         GO TO 1099-EXIT.
  3667
  3668     IF LO-STATUS  IS NOT EQUAL TO  ZERO
  3669         MOVE LO-STATUS          TO  WS-ABEND-FILE-STATUS
  3670         MOVE 'ERROR OCCURRED READ - EROFCR'
  3671                                 TO  WS-ABEND-MESSAGE
  3672         GO TO ABEND-PGM.
  3673
  3674     IF LO-COMPANY-CD  IS NOT EQUAL TO  DTE-CLASIC-COMPANY-CD
  3675         GO TO 1099-EXIT.
  3676
  3677     IF LO-LOAN-COUNT (RUN-MO) IS GREATER THAN  ZERO
  3678       OR LO-LOAN-VOLUME (RUN-MO) IS GREATER THAN  ZERO
  3679         NEXT SENTENCE
  3680     ELSE
  3681         GO TO 0820-GET-NEXT-OFFICER.
  3682
  3683     MOVE LO-COMPANY-CD          TO  LN-CO.
  3684     MOVE LO-CARRIER             TO  LN-CARR.
  3685     MOVE LO-GROUPING            TO  LN-GRP.
  3686     MOVE LO-STATE               TO  LN-ST.
  3687     MOVE LO-ACCOUNT             TO  LN-ACCT.
  3688
  3689     IF DTE-COMP-VG  IS EQUAL TO  ' '
  3690         MOVE LO-SV-CARRIER      TO  LN-CARR
  3691         MOVE LO-SV-GROUPING     TO  LN-GRP.
  3692
  3693     IF DTE-COMP-VG  IS EQUAL TO  '2'
  3694         MOVE LO-SV-GROUPING     TO  LN-GRP.
  3695
  3696     IF DTE-COMP-VG  IS EQUAL TO  '3'
  3697         MOVE LO-SV-CARRIER      TO  LN-CARR
  3698         MOVE LO-SV-GROUPING     TO  LN-GRP
  3699         MOVE LO-SV-STATE        TO  LN-ST.
  3700
  3701     IF DTE-COMP-VG  IS EQUAL TO  '4'
  3702         MOVE LO-SV-GROUPING     TO  LN-GRP
  3703         MOVE LO-SV-STATE        TO  LN-ST.
  3704
  3705     MOVE LO-OFFICER-CODE        TO  LN-OFFCODE.
  3706     MOVE LOW-VALUES             TO  LN-LOVAL.
  3707     MOVE LO-OFFICER-NAME        TO  LN-OFFCR.
  3708     MOVE LO-COMP-CONTROL        TO  LN-OPT1.
  3709     MOVE LO-DETAIL-CONTROL      TO  LN-OPT2.
  3710
  3711     IF LO-ACCOUNT  IS EQUAL TO  SAVE-ACCOUNT
  3712         GO TO 0830-RELEASE-LOAN-OFFICER.
  3713
  3714     MOVE LO-ACCOUNT             TO  SAVE-ACCOUNT.
  3715
  3716     PERFORM 0900-GET-ACCOUNT  THRU  0999-EXIT.
  3717
  3718 0830-RELEASE-LOAN-OFFICER.
  3719     IF SKIP-THIS-ACCT  IS EQUAL TO  'Y'
  3720         GO TO 0820-GET-NEXT-OFFICER.
  3721
  3722     MOVE LN-REC                 TO  SORT-RECORD.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  80
* EL539.cbl
  3723
  3724     PERFORM 0310-RELEASE  THRU  0319-EXIT.
  3725
  3726     GO TO 0820-GET-NEXT-OFFICER.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  81
* EL539.cbl
  3728 0900-GET-ACCOUNT.
  3729     MOVE LN-CO                  TO  AM-COMPANY-CD.
  3730     MOVE LN-CARR                TO  AM-CARRIER.
  3731     MOVE LN-GRP                 TO  AM-GROUPING.
  3732     MOVE LN-ST                  TO  AM-STATE.
  3733     MOVE LN-ACCT                TO  AM-ACCOUNT.
  3734     MOVE BIN-RUN-DATE           TO  AM-EXPIRATION-DT
  3735
  3736
  3737     START ERACCT  KEY  NOT LESS THAN  AM-CONTROL-PRIMARY.
  3738
  3739     IF AM-FILE-STATUS  IS EQUAL TO  '23'
  3740         GO TO 0920-INVALID-ACCOUNT.
  3741
  3742     IF AM-STAT-1  IS NOT EQUAL TO  '0'
  3743         MOVE AM-FILE-STATUS     TO  WS-ABEND-FILE-STATUS
  3744         MOVE 'ERROR OCCURRED START - ERACCT'
  3745                                 TO  WS-ABEND-MESSAGE
  3746         GO TO ABEND-PGM.
  3747
  3748 0910-NEXT-ACCT.
  3749     READ ERACCT  NEXT RECORD.
  3750
  3751     IF AM-STAT-1  IS EQUAL TO  '1'
  3752         GO TO 0920-INVALID-ACCOUNT.
  3753
  3754     IF AM-STAT-1  IS NOT EQUAL TO  '0'
  3755         MOVE AM-FILE-STATUS     TO  WS-ABEND-FILE-STATUS
  3756         MOVE 'ERROR OCCURRED READ - ERACCT'
  3757                                 TO  WS-ABEND-MESSAGE
  3758         GO TO ABEND-PGM.
  3759
  3760     IF AM-COMPANY-CD  IS NOT EQUAL TO  DTE-CLASIC-COMPANY-CD
  3761         GO TO 0920-INVALID-ACCOUNT.
  3762
  3763     IF AM-ACCOUNT  IS EQUAL TO  SAVE-ACCOUNT
  3764         GO TO 0930-VALID-ACCOUNT.
  3765
  3766 0920-INVALID-ACCOUNT.
  3767     MOVE 'Y'                    TO  SKIP-THIS-ACCT.
  3768
  3769     GO TO 0999-EXIT.
  3770
  3771 0930-VALID-ACCOUNT.
  3772
  3773*    IF AM-EXPIRATION-DT NOT = HIGH-VALUES
  3774*       PERFORM UNTIL
  3775*         (AM-FILE-STATUS   NOT = '00')
  3776*         OR (AM-COMPANY-CD NOT = DTE-CLASIC-COMPANY-CD)
  3777*         OR (AM-ACCOUNT    NOT = LN-ACCT)
  3778*         MOVE ACCOUNT-MASTER      TO WS-HOLD-ERACCT
  3779*         READ ERACCT  NEXT RECORD
  3780*       END-PERFORM
  3781*       MOVE WS-HOLD-ERACCT      TO ACCOUNT-MASTER
  3782*    END-IF
  3783
  3784     MOVE AM-COMPANY-CD          TO  ACCT-CO.
  3785     MOVE AM-CARRIER             TO  ACCT-CARR.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  82
* EL539.cbl
  3786     MOVE AM-GROUPING            TO  ACCT-GRP.
  3787     MOVE AM-STATE               TO  ACCT-ST.
  3788     MOVE AM-ACCOUNT             TO  ACCT-NUM.
  3789     MOVE LOW-VALUES             TO  ACCT-LOVAL.
  3790     MOVE AM-NAME                TO  ACCT-NAME.
  3791     MOVE AM-PERSON              TO  ACCT-PERSON.
  3792     MOVE AM-ADDRS               TO  ACCT-ADDR1.
  3793     MOVE SPACES                 TO  ACCT-CTY-ST.
  3794     STRING AM-ADDR-CITY ' ' AM-ADDR-STATE
  3795        DELIMITED BY '  ' INTO ACCT-CTY-ST
  3796     END-STRING
  3797
  3798     IF  AM-CANADIAN-POST-CODE
  3799         MOVE AM-CAN-POSTAL-1    TO ACCT-CAN-POSTAL-CODE-1
  3800         MOVE AM-CAN-POSTAL-2    TO ACCT-CAN-POSTAL-CODE-2
  3801         MOVE SPACES             TO ACCT-CAN-FILLER
  3802
  3803     ELSE
  3804         MOVE AM-ZIP-PRIME       TO ACCT-ZIP-PRIME
  3805
  3806         IF  AM-ZIP-PLUS4 = SPACES OR ZEROS
  3807             MOVE SPACES         TO ACCT-ZIP-PLUS4
  3808
  3809         ELSE
  3810             MOVE AM-ZIP-PLUS4   TO ACCT-ZIP-PLUS4.
  3811
  3812     MOVE ACCT-REC               TO  SORT-RECORD.
  3813
  3814     IF AM-EDIT-LOAN-OFC EQUAL 'N'
  3815         MOVE 'Y'                TO  SKIP-THIS-ACCT
  3816         GO TO 0999-EXIT
  3817     ELSE
  3818         MOVE 'N'                TO  SKIP-THIS-ACCT.
  3819
  3820     PERFORM 0310-RELEASE  THRU  0319-EXIT.
  3821
  3822 0999-EXIT.
  3823     EXIT.
  3824
  3825 1099-EXIT.
  3826     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  83
* EL539.cbl
  3828 1100-PUT-REPORTS SECTION.
  3829     MOVE LOW-VALUES             TO  CONAMREC  ACCT-REC
  3830                                     LN-REC    PEND-REC.
  3831
  3832     RETURN SORT-WORK
  3833         AT END
  3834             GO TO 1150-EOF.
  3835
  3836     MOVE SORT-RECORD            TO  CONAMREC.
  3837     MOVE CONA-NAME              TO  HD2-CO.
  3838     MOVE CONA-ANDT              TO  HD3-DATE.
  3839     MOVE WS-CURRENT-DATE        TO  HD2-RUN.
  3840
  3841     PERFORM 1400-INITIALIZE-TABLE  THRU  1499-EXIT
  3842         VARYING  TBLX  FROM  1  BY  1
  3843             UNTIL  TBLX  IS EQUAL TO  202.
  3844
  3845     MOVE LOW-VALUES             TO  LN-OFFCODE.
  3846
  3847 1110-PRINT-LOOP.
  3848     RETURN SORT-WORK
  3849         AT END
  3850             GO TO 1150-EOF.
  3851
  3852     MOVE SC-CO                  TO  CTLCO.
  3853     MOVE SC-CARR                TO  CTLCARR.
  3854     MOVE SC-GRP                 TO  CTLGRP.
  3855     MOVE SC-ST                  TO  CTLST.
  3856     MOVE SC-ACCT                TO  CTLACCT.
  3857     MOVE SC-LNOFF               TO  CTLOFCR.
  3858
  3859     IF PRVKEY  IS EQUAL TO  LOW-VALUE
  3860         MOVE CTLKEY             TO  PRVKEY.
  3861
  3862     IF CPGCTL  IS NOT EQUAL TO  PPGCTL
  3863         PERFORM 2000-MINORS.
  3864
  3865     IF SC-LNOFF  IS EQUAL TO  LOW-VALUE
  3866         GO TO 1130-SET-ACCOUNT.
  3867
  3868     IF SC-EFFDT  IS EQUAL TO  LOW-VALUE
  3869        GO TO 1140-SET-LOAN-OFFICER.
  3870
  3871     MOVE 'Y'                    TO  HAVE-DATA.
  3872     MOVE SORT-RECORD            TO  PEND-REC.
  3873
  3874     IF LN-OPT2  IS EQUAL TO  'S'
  3875         GO TO 1120-ADD-ONLY.
  3876
  3877*    IF LNCT  IS GREATER THAN  45
  3878     IF LNCT  IS GREATER THAN  43
  3879         PERFORM 1700-PAGE-HEADING  THRU  1799-EXIT.
  3880
  3881     MOVE 'Y'                    TO  PRNTG-DTL.
  3882     MOVE SPACE                  TO  DT-1.
  3883     MOVE PEND-CERT-PRIME        TO  D1-CERT-PRIME.
  3884     MOVE PEND-CERT-SFX          TO  D1-CERT-SFX.
  3885     MOVE PEND-YRMODA            TO  WS-PEND-YRMODA.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  84
* EL539.cbl
  3886     MOVE PEND-MO                TO  D1-EFMO.
  3887     MOVE PEND-DA                TO  D1-EFDA.
  3888     MOVE PEND-YR                TO  D1-EFYR.
  3889     MOVE '/'                    TO  D1-SL1  D1-SL2.
  3890     MOVE PEND-NAME              TO  D1-NAME.
  3891     MOVE PEND-INIT              TO  D1-INIT.
  3892     MOVE PEND-AGE               TO  D1-AGE.
  3893     MOVE PEND-LF-TERM           TO  D1-LF-TERM.
  3894     MOVE PEND-AH-TERM           TO  D1-AH-TERM.
  3895     MOVE PEND-LF-TYP            TO  D1-LTYP.
  3896     MOVE PEND-LF-PRM            TO  D1-LPRM.
  3897     MOVE PEND-LF-AMT            TO  D1-LBEN.
  3898     MOVE PEND-AH-TYP            TO  D1-HTYP.
  3899     MOVE PEND-AH-PRM            TO  D1-HPRM.
  3900     MOVE PEND-AH-AMT            TO  D1-HBEN.
  3901
  3902     IF LN-OPT1  IS EQUAL TO  'Y'
  3903         ADD PEND-LF-COM  PEND-AH-COM  GIVING  D1-COMM.
  3904
  3905     IF LNCT  IS EQUAL TO  3
  3906         MOVE ZERO               TO  P-CTL
  3907     ELSE
  3908         MOVE SPACE              TO  P-CTL.
  3909
  3910     MOVE DT-1                   TO  P-DATA.
  3911
  3912     PERFORM 1600-PRINT-LINE  THRU  1699-EXIT.
  3913
  3914     ADD 1                       TO  LNCT.
  3915
  3916 1120-ADD-ONLY.
  3917     ADD PEND-LF-AMT             TO  TBL-LBEN (TBLX)
  3918                                     FIN-LBEN
  3919     ADD PEND-AH-AMT             TO  TBL-DBEN (TBLX)
  3920                                     FIN-DBEN
  3921     ADD PEND-LF-COM             TO  TBL-LCOM (TBLX)
  3922                                     FIN-LCOM
  3923     ADD PEND-AH-COM             TO  TBL-DCOM (TBLX)
  3924                                     FIN-DCOM
  3925
  3926     IF PEND-LF-PRM  IS GREATER THAN  ZERO
  3927         ADD 1                   TO  TBL-LICT (TBLX)
  3928                                     FIN-LICT
  3929         ADD PEND-LF-PRM         TO  TBL-LPRM (TBLX)
  3930                                     FIN-LPRM
  3931     ELSE
  3932         IF PEND-LF-PRM  IS LESS THAN  ZERO
  3933             ADD 1               TO  TBL-LCCT (TBLX)
  3934                                     FIN-LCCT
  3935             ADD PEND-LF-PRM     TO  TBL-LREF (TBLX)
  3936                                     FIN-LREF.
  3937
  3938     IF PEND-AH-PRM  IS GREATER THAN  ZERO
  3939         ADD 1                   TO  TBL-DICT (TBLX)
  3940                                     FIN-DICT
  3941         ADD PEND-AH-PRM         TO  TBL-DPRM (TBLX)
  3942                                     FIN-DPRM
  3943     ELSE
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  85
* EL539.cbl
  3944         IF PEND-AH-PRM  IS LESS THAN  ZERO
  3945             ADD 1               TO  TBL-DCCT (TBLX)
  3946                                     FIN-DCCT
  3947             ADD PEND-AH-PRM     TO  TBL-DREF (TBLX)
  3948                                     FIN-DREF.
  3949
  3950     GO TO 1110-PRINT-LOOP.
  3951
  3952 1130-SET-ACCOUNT.
  3953     IF SC-ACCT-INFO  IS EQUAL TO  ACCT-INFO
  3954         GO TO 1110-PRINT-LOOP.
  3955
  3956     IF PRNTG-DTL  IS EQUAL TO  'Y'
  3957         PERFORM 1300-DETAIL-TOTALS  THRU  1399-EXIT.
  3958
  3959     MOVE SORT-RECORD            TO  ACCT-REC.
  3960     MOVE ACCT-CARR              TO  H5-CARR.
  3961     MOVE ACCT-GRP               TO  H5-GRP.
  3962     MOVE ACCT-ST                TO  H5-ST.
  3963     MOVE ACCT-NUM               TO  H5-ACCT.
  3964     MOVE ACCT-NAME              TO  H6-NA.
  3965     MOVE ACCT-PERSON            TO  H7-NA.
  3966     MOVE ACCT-ADDR1             TO  H8-NA.
  3967     MOVE ACCT-CTY-ST            TO  H9-NA.
  3968
  3969     IF  ACCT-CANADIAN-POST-CODE
  3970         MOVE ACCT-CAN-POSTAL-CODE-1
  3971                                 TO H9-CAN-POSTAL-CODE-1
  3972         MOVE ACCT-CAN-POSTAL-CODE-2
  3973                                 TO H9-CAN-POSTAL-CODE-2
  3974         MOVE SPACES             TO H9-DASH-CAN
  3975                                    H9-CAN-FILLER
  3976
  3977     ELSE
  3978         MOVE ACCT-ZIP-PRIME     TO H9-ZIP-PRIME
  3979         MOVE SPACES             TO H9-DASH
  3980
  3981         IF  ACCT-ZIP-PLUS4 = SPACES OR ZEROS
  3982             MOVE SPACES         TO H9-ZIP-PLUS4
  3983
  3984         ELSE
  3985             MOVE ACCT-ZIP-PLUS4 TO H9-ZIP-PLUS4.
  3986
  3987     MOVE 'N'                    TO  HAVE-DATA.
  3988     MOVE LOW-VALUES             TO  LN-OFFCODE.
  3989     MOVE ZERO                   TO  TBLX.
  3990     MOVE 80                     TO  LNCT.
  3991     MOVE ACCT-CO                TO  TBL-CO.
  3992     MOVE ACCT-CARR              TO  TBL-CARR.
  3993     MOVE ACCT-GRP               TO  TBL-GRP.
  3994     MOVE ACCT-ST                TO  TBL-ST.
  3995     MOVE ACCT-NUM               TO  TBL-ACCT.
  3996     MOVE ACCT-NAME              TO  TBL-NAME.
  3997     MOVE ACCT-PERSON            TO  TBL-MAIL1.
  3998     MOVE ACCT-ADDR1             TO  TBL-MAIL2.
  3999     MOVE ACCT-CTY-ST            TO  TBL-MAIL3.
  4000     MOVE ACCT-ZIP               TO  TBL-ZIP.
  4001
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  86
* EL539.cbl
  4002     GO TO 1110-PRINT-LOOP.
  4003
  4004 1140-SET-LOAN-OFFICER.
  4005     IF SC-LNOFF  IS EQUAL TO  LN-OFFCODE
  4006         GO TO 1110-PRINT-LOOP.
  4007
  4008     IF PRNTG-DTL  IS EQUAL TO  'Y'
  4009         PERFORM 1300-DETAIL-TOTALS  THRU  1399-EXIT.
  4010
  4011     MOVE SORT-RECORD            TO  LN-REC.
  4012
  4013     IF LN-OFFCODE  IS EQUAL TO  HIGH-VALUES
  4014         MOVE SPACE              TO  H10-LOF
  4015     ELSE
  4016         MOVE LN-OFFCODE         TO  H10-LOF.
  4017
  4018     MOVE '-'                    TO  H10-DSH.
  4019     MOVE LN-OFFCR               TO  H10-LONAME.
  4020
  4021     IF (LN-OFFCR = 'UNASSIGNED')
  4022        OR (LN-OFFCODE (1:3) = 'XXX')
  4023        SET PRINT-UNASSIGN-LINE  TO TRUE
  4024     END-IF
  4025
  4026     ADD 1                       TO  TBLX.
  4027
  4028     IF TBLX  IS GREATER THAN  200
  4029         DISPLAY ' TOO MANY ENTRIES FOR TABLE ' SORT-CTL ' ' TBLX
  4030         MOVE 1                  TO  TBLX
  4031         GO TO ABEND-PGM.
  4032
  4033     MOVE LN-OFFCODE             TO  TBL-CODE (TBLX).
  4034     MOVE LN-OFFCR               TO  TBL-LO-NAME (TBLX).
  4035     MOVE 80                     TO  LNCT.
  4036
  4037     GO TO 1110-PRINT-LOOP.
  4038
  4039 1150-EOF.
  4040     PERFORM 2000-MINORS.
  4041
  4042     PERFORM 3000-FINAL-TOTALS   THRU 3000-EXIT
  4043
  4044     IF DTE-PGM-OPT  IS EQUAL TO  2
  4045         CLOSE EXTRACT-INTERFACE-FILE
  4046     ELSE
  4047         CLOSE ERPNDB.
  4048
  4049     CLOSE ERLOFC  ERACCT.
  4050
  4051     IF DTE-PRT-OPT  IS EQUAL TO  'P'  OR  'B'  OR  'T'
  4052         CLOSE PRINT-FILE.
  4053
  4054 1199-EXIT.
  4055     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  87
* EL539.cbl
  4057 1200-END-SORT-SECTION.
  4058
  4059 1300-DETAIL-TOTALS.
  4060
  4061*    IF LNCT  IS GREATER THAN  34
  4062     IF LNCT  IS GREATER THAN  39
  4063        PERFORM 1700-PAGE-HEADING
  4064                                 THRU  1799-EXIT
  4065     END-IF
  4066
  4067     MOVE 'N'                    TO  PRNTG-DTL.
  4068     MOVE SPACE                  TO  DT-1.
  4069     MOVE 'TOTALS'               TO  D1-EFF.
  4070     MOVE TBL-LBEN (TBLX)        TO  D1-LBEN.
  4071     MOVE TBL-DBEN (TBLX)        TO  D1-HBEN.
  4072
  4073     ADD TBL-LPRM (TBLX)  TBL-LREF (TBLX)  GIVING  D1-LPRM.
  4074     ADD TBL-DPRM (TBLX)  TBL-DREF (TBLX)  GIVING  D1-HPRM.
  4075
  4076     IF LN-OPT1  IS EQUAL TO  'Y'
  4077         ADD TBL-LCOM (TBLX)  TBL-DCOM (TBLX)  GIVING  D1-COMM.
  4078
  4079     MOVE DT-1                   TO  P-DATA.
  4080     MOVE ZERO                   TO  P-CTL.
  4081
  4082     PERFORM 1600-PRINT-LINE  THRU  1699-EXIT.
  4083
  4084     MOVE '     TOTAL ISSUED PREMIUM ' TO DT-1
  4085     COMPUTE WS-WORK-AMT =
  4086        TBL-LPRM (TBLX) + TBL-DPRM (TBLX)
  4087     MOVE WS-WORK-AMT           TO D1-LBEN
  4088     MOVE DT-1                  TO P-DATA
  4089     MOVE '0'                   TO P-CTL
  4090     PERFORM 1600-PRINT-LINE THRU 1699-EXIT
  4091
  4092     MOVE '     TOTAL CANCELLED PREMIUM ' TO DT-1
  4093     COMPUTE WS-WORK-AMT =
  4094        TBL-LREF (TBLX) + TBL-DREF (TBLX)
  4095     MOVE WS-WORK-AMT           TO D1-LBEN
  4096     MOVE DT-1                  TO P-DATA
  4097     MOVE '0'                   TO P-CTL
  4098     PERFORM 1600-PRINT-LINE THRU 1699-EXIT
  4099
  4100     MOVE '     NET PREMIUM FOR LOAN OFFICER ' TO DT-1
  4101     COMPUTE WS-WORK-AMT =
  4102        TBL-LPRM (TBLX) + TBL-DPRM (TBLX) +
  4103        TBL-LREF (TBLX) + TBL-DREF (TBLX)
  4104     MOVE WS-WORK-AMT           TO D1-LBEN
  4105     MOVE DT-1                  TO P-DATA
  4106     MOVE '0'                   TO P-CTL
  4107     PERFORM 1600-PRINT-LINE THRU 1699-EXIT
  4108
  4109     .
  4110 1399-EXIT.
  4111     EXIT.
  4112
  4113 1400-INITIALIZE-TABLE.
  4114     MOVE LOW-VALUE              TO  TBL-CODE (TBLX).
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  88
* EL539.cbl
  4115     MOVE SPACES                 TO  TBL-LO-NAME (TBLX)
  4116     MOVE ZEROS                  TO  TBL-LICT (TBLX)
  4117                                     TBL-LBEN (TBLX)
  4118                                     TBL-LPRM (TBLX)
  4119                                     TBL-LCCT (TBLX)
  4120                                     TBL-LREF (TBLX)
  4121                                     TBL-LCOM (TBLX)
  4122                                     TBL-LOCT (TBLX)
  4123                                     TBL-LVOL (TBLX)
  4124                                     TBL-DICT (TBLX)
  4125                                     TBL-DBEN (TBLX)
  4126                                     TBL-DPRM (TBLX)
  4127                                     TBL-DCCT (TBLX)
  4128                                     TBL-DREF (TBLX)
  4129                                     TBL-DCOM (TBLX).
  4130
  4131 1499-EXIT.
  4132     EXIT.
  4133
  4134 1500-RE-INITIALIZE.
  4135     ADD TBL-LICT (TBLX)         TO  TBL-LICT (201).
  4136     ADD TBL-LBEN (TBLX)         TO  TBL-LBEN (201).
  4137     ADD TBL-LPRM (TBLX)         TO  TBL-LPRM (201).
  4138     ADD TBL-LCCT (TBLX)         TO  TBL-LCCT (201).
  4139     ADD TBL-LREF (TBLX)         TO  TBL-LREF (201).
  4140     ADD TBL-LCOM (TBLX)         TO  TBL-LCOM (201).
  4141     ADD TBL-DICT (TBLX)         TO  TBL-DICT (201).
  4142     ADD TBL-DBEN (TBLX)         TO  TBL-DBEN (201).
  4143     ADD TBL-DPRM (TBLX)         TO  TBL-DPRM (201).
  4144     ADD TBL-DCCT (TBLX)         TO  TBL-DCCT (201).
  4145     ADD TBL-DREF (TBLX)         TO  TBL-DREF (201).
  4146     ADD TBL-DCOM (TBLX)         TO  TBL-DCOM (201).
  4147
  4148 1599-EXIT.
  4149     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  89
* EL539.cbl
  4151 1600-PRINT-LINE SECTION.
  4152     MOVE P-CTL                  TO  X.
  4153
* 4154     COPY ELCPRT2X.
  4155******************************************************************04/15/98
  4156*                                                                *ELCPRT2X
  4157*                                                                *ELCPRT2X
  4158*                            ELCPRT2X.                           *   LV002
  4159*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  4160*                            VMOD=2.002                          *   CL**2
  4161*                                                                *ELCPRT2X
  4162*  OUTPUT METHOD BASED ON DATE CARD PRINT OPTION -               *ELCPRT2X
  4163*                                                                *ELCPRT2X
  4164*    USE COPY CODE ELCPRTFD FOR PRINT FD (PRNTR)                 *ELCPRT2X
  4165*                  ELCFCHFD FOR FICHE FD (FICH)                  *ELCPRT2X
  4166*                  ELCRPTFD FOR ONLINE REPORT FILE FD (ELREPT)   *ELCPRT2X
  4167*                  ELCREPT FOR ONLINE SAVE FILE (01)             *ELCPRT2X
  4168*                  ELCPRTCX TO CLOSE FICH AND REPORT FILES       *ELCPRT2X
  4169*                                                                *ELCPRT2X
  4170*    * NOTE * IF OUTPUT NOT ELIGIBLE FOR ONLINE RETRIEVAL - USE  *ELCPRT2X
  4171*             ELCPRT2 ROUTINE AND ASSOCIATED FD.                 *ELCPRT2X
  4172******************************************************************ELCPRT2X
  4173                                                                  ELCPRT2X
  4174     IF DTE-FICH NOT = SPACE AND                                  ELCPRT2X
  4175         FICH-OPEN   = SPACE                                      ELCPRT2X
  4176         MOVE 'X'                TO  FICH-OPEN                    ELCPRT2X
  4177         OPEN OUTPUT FICH.                                        ELCPRT2X
  4178                                                                  ELCPRT2X
  4179     IF DTE-PRT-OPT = 'S' OR 'T'                                  ELCPRT2X
  4180         IF (REPT-OPEN = SPACE) AND (DTE-ABEND-CD-1 = SPACE)      ELCPRT2X
  4181             OPEN I-O ELREPT                                      ELCPRT2X
  4182             IF DTE-F-1 NOT = ZERO AND                            ELCPRT2X
  4183                DTE-VSAM-FLAGS NOT = '97' AND '9%'                ELCPRT2X
  4184                 MOVE DTE-VSAM-FLAGS  TO  WS-ABEND-FILE-STATUS    ELCPRT2X
  4185                 MOVE 'ERROR OCCURED OPEN - ELREPT'               ELCPRT2X
  4186                                 TO  WS-ABEND-MESSAGE             ELCPRT2X
  4187                 GO TO ABEND-PGM                                  ELCPRT2X
  4188             ELSE                                                 ELCPRT2X
  4189                 MOVE '1'                   TO REPT-OPEN          ELCPRT2X
  4190                 MOVE DTE-CLASIC-COMPANY-CD TO RF-COMPANY-CD      ELCPRT2X
  4191                 MOVE '1'                   TO RF-RECORD-TYPE     ELCPRT2X
  4192                 MOVE OLC-REPORT-NAME       TO RF-REPORT-ID       ELCPRT2X
  4193                 MOVE ZERO                  TO RF-LINE-NUMBER     ELCPRT2X
  4194                 START ELREPT  KEY NOT LESS RF-CONTROL-PRIMARY    ELCPRT2X
  4195                 PERFORM DTE-REPORT-DELETE THRU DTE-DELETE-EXIT   ELCPRT2X
  4196                 MOVE DTE-CLASIC-COMPANY-CD TO RF-COMPANY-CD      ELCPRT2X
  4197                 MOVE '2'                   TO RF-RECORD-TYPE     ELCPRT2X
  4198                 MOVE OLC-REPORT-NAME       TO RF-REPORT-ID       ELCPRT2X
  4199                 MOVE ZERO                  TO RF-LINE-NUMBER     ELCPRT2X
  4200                 START ELREPT  KEY NOT LESS RF-CONTROL-PRIMARY    ELCPRT2X
  4201                 PERFORM DTE-REPORT-DELETE THRU DTE-DELETE-EXIT   ELCPRT2X
  4202                 MOVE DTE-CLASIC-COMPANY-CD TO RF-COMPANY-CD      ELCPRT2X
  4203                 MOVE '1'                   TO RF-RECORD-TYPE     ELCPRT2X
  4204                 MOVE OLC-REPORT-NAME       TO RF-REPORT-ID       ELCPRT2X
  4205                 MOVE SPACES                TO RF-REPORT-LINE-133.ELCPRT2X
  4206                                                                  ELCPRT2X
  4207     IF DTE-ABEND-CD-1 = '81' AND                                 ELCPRT2X
  4208        DTE-PRT-OPT    = 'S'                                      ELCPRT2X
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  90
* EL539.cbl (/apps/prod/cid1p/copy/ELCPRT2X)
  4209         MOVE +0302                  TO  WS-RETURN-CODE           ELCPRT2X
  4210         GO TO ABEND-PGM.                                         ELCPRT2X
  4211                                                                  ELCPRT2X
  4212     IF DTE-PRT-OPT = 'S' OR 'T'                                  ELCPRT2X
  4213         MOVE X                      TO  RF-CTL-CHAR-133          ELCPRT2X
  4214         MOVE P-DATA                 TO  RF-DATA-133              ELCPRT2X
  4215             IF DTE-ABEND-CD-1 = SPACES                           ELCPRT2X
  4216                 ADD +1              TO  DTE-TOT-LINES            ELCPRT2X
  4217                 MOVE DTE-TOT-LINES  TO  RF-LINE-NUMBER           ELCPRT2X
  4218                 WRITE REPORT-SAVE-FILE                           ELCPRT2X
  4219                     INVALID KEY                                  ELCPRT2X
  4220                         MOVE '88'   TO  DTE-ABEND-CD-1           ELCPRT2X
  4221                         CLOSE ELREPT                             ELCPRT2X
  4222                         MOVE SPACE  TO  REPT-OPEN.               ELCPRT2X
  4223                                                                  ELCPRT2X
  4224     IF DTE-FICH NOT = SPACE                                      ELCPRT2X
  4225         MOVE X                      TO  P-CTL                    ELCPRT2X
  4226         WRITE FICH-REC FROM PRT.                                 ELCPRT2X
  4227                                                                  ELCPRT2X
  4228     IF DTE-PRT-OPT = 'P' OR 'B' OR 'T'                           ELCPRT2X
  4229       MOVE X                        TO  P-CTL                    ELCPRT2X
  4230       IF P-CTL = ' '                                             ELCPRT2X
  4231         WRITE PRT AFTER ADVANCING 1 LINE                         ELCPRT2X
  4232       ELSE                                                       ELCPRT2X
  4233         IF P-CTL = '0'                                           ELCPRT2X
  4234           WRITE PRT AFTER ADVANCING 2 LINES                      ELCPRT2X
  4235         ELSE                                                     ELCPRT2X
  4236           IF P-CTL = '-'                                         ELCPRT2X
  4237             WRITE PRT AFTER ADVANCING 3 LINES                    ELCPRT2X
  4238           ELSE                                                   ELCPRT2X
  4239             WRITE PRT AFTER ADVANCING PAGE.                      ELCPRT2X
  4240                                                                  ELCPRT2X
  4241     GO TO DTE-PRINT-EXIT.                                        ELCPRT2X
  4242                                                                  ELCPRT2X
  4243 DTE-REPORT-DELETE.                                               ELCPRT2X
  4244     IF DTE-F-1 NOT = ZERO                                        ELCPRT2X
  4245         MOVE ZERO                   TO  DTE-VSAM-FLAGS           ELCPRT2X
  4246         GO TO DTE-DELETE-EXIT.                                   ELCPRT2X
  4247                                                                  ELCPRT2X
  4248     READ ELREPT   NEXT RECORD                                    ELCPRT2X
  4249           AT END   GO TO DTE-DELETE-EXIT.                        ELCPRT2X
  4250                                                                  ELCPRT2X
  4251     IF DTE-CLASIC-COMPANY-CD = RF-COMPANY-CD  AND                ELCPRT2X
  4252        OLC-REPORT-NAME       = RF-REPORT-ID                      ELCPRT2X
  4253         DELETE ELREPT RECORD                                     ELCPRT2X
  4254         GO TO DTE-REPORT-DELETE.                                 ELCPRT2X
  4255                                                                  ELCPRT2X
  4256 DTE-DELETE-EXIT.                                                 ELCPRT2X
  4257     EXIT.                                                        ELCPRT2X
  4258                                                                  ELCPRT2X
  4259 DTE-PRINT-EXIT.                                                  ELCPRT2X
  4260     EXIT.                                                        ELCPRT2X
  4261******************************************************************ELCPRT2X
  4262
  4263 1699-EXIT.
  4264     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  91
* EL539.cbl
  4266 1700-PAGE-HEADING SECTION.
  4267     ADD 1                       TO  PGCT.
  4268
  4269     MOVE ZERO                   TO  LNCT.
  4270     MOVE PGCT                   TO  HD3-PG.
  4271     MOVE '1'                    TO  P-CTL.
  4272     MOVE HD-1                   TO  P-DATA.
  4273
  4274     PERFORM 1600-PRINT-LINE  THRU  1699-EXIT.
  4275
  4276     MOVE SPACE                  TO  P-CTL.
  4277     MOVE HD-2                   TO  P-DATA.
  4278
  4279     PERFORM 1600-PRINT-LINE  THRU  1699-EXIT.
  4280
  4281     MOVE SPACE                  TO  P-CTL.
  4282     MOVE HD-3                   TO  P-DATA.
  4283
  4284     PERFORM 1600-PRINT-LINE  THRU  1699-EXIT.
  4285
  4286     MOVE ZERO                   TO  P-CTL.
  4287     MOVE HD-4                   TO  P-DATA.
  4288
  4289     PERFORM 1600-PRINT-LINE  THRU  1699-EXIT.
  4290
  4291     MOVE HD-5                   TO  P-DATA.
  4292     MOVE ZERO                   TO  P-CTL.
  4293
  4294     PERFORM 1600-PRINT-LINE  THRU  1699-EXIT.
  4295
  4296     IF PRNTG-SUMM  IS EQUAL TO  'Y'
  4297        MOVE 'PRODUCTION SUMMARY '
  4298                                 TO  H6-DS
  4299     ELSE
  4300        IF PRNTG-SUMM  IS EQUAL TO  'F'
  4301           MOVE '    FINAL TOTALS   '
  4302                                 TO  H6-DS
  4303        ELSE
  4304           MOVE 'PRODUCTION DETAIL  '
  4305                                 TO  H6-DS
  4306        END-IF
  4307     END-IF
  4308
  4309     MOVE HD-6                   TO  P-DATA.
  4310     MOVE ZERO                   TO  P-CTL.
  4311
  4312     PERFORM 1600-PRINT-LINE  THRU  1699-EXIT.
  4313
  4314
  4315     MOVE HD-7                   TO  P-DATA.
  4316     MOVE SPACE                  TO  P-CTL.
  4317
  4318     PERFORM 1600-PRINT-LINE  THRU  1699-EXIT.
  4319
  4320     MOVE HD-8                   TO  P-DATA.
  4321     MOVE SPACE                  TO  P-CTL.
  4322
  4323     PERFORM 1600-PRINT-LINE  THRU  1699-EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  92
* EL539.cbl
  4324
  4325     MOVE HD-9                   TO  P-DATA.
  4326     MOVE ' '                    TO  P-CTL.
  4327
  4328     PERFORM 1600-PRINT-LINE  THRU  1699-EXIT.
  4329
  4330     ADD +12                     TO LNCT
  4331
  4332     IF PRNTG-SUMM  IS EQUAL TO  'Y'
  4333         GO TO 1710-BY-SUM1AND2.
  4334
  4335     MOVE ZERO                   TO  P-CTL.
  4336     MOVE HD-10                  TO  P-DATA.
  4337
  4338     PERFORM 1600-PRINT-LINE  THRU  1699-EXIT.
  4339
  4340     IF LN-OPT1  IS EQUAL TO  'Y'
  4341         MOVE 'COMMISSION'       TO  HD9-VAR
  4342     ELSE
  4343         MOVE SPACE              TO  HD9-VAR.
  4344
  4345     MOVE ZERO                   TO  P-CTL.
  4346     MOVE HD-11                  TO  P-DATA.
  4347
  4348     PERFORM 1600-PRINT-LINE  THRU  1699-EXIT.
  4349
  4350     MOVE HD-12                  TO  P-DATA.
  4351     MOVE SPACE                  TO  P-CTL.
  4352
  4353     PERFORM 1600-PRINT-LINE  THRU  1699-EXIT.
  4354
  4355     ADD 5                       TO  LNCT.
  4356
  4357     GO TO 1799-EXIT.
  4358
  4359 1710-BY-SUM1AND2.
  4360     MOVE SUM-HD1                TO  P-DATA.
  4361     MOVE ZERO                   TO  P-CTL.
  4362
  4363     PERFORM 1600-PRINT-LINE  THRU  1699-EXIT.
  4364
  4365     MOVE SUM-HD2                TO  P-DATA.
  4366     MOVE SPACE                  TO  P-CTL.
  4367
  4368     PERFORM 1600-PRINT-LINE  THRU  1699-EXIT.
  4369
  4370     ADD 3                       TO  LNCT.
  4371
  4372 1799-EXIT.
  4373     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  93
* EL539.cbl
  4375 2000-MINORS SECTION.
  4376     IF PRNTG-DTL  IS EQUAL TO  'Y'
  4377         PERFORM 1300-DETAIL-TOTALS  THRU  1399-EXIT.
  4378
  4379     IF HAVE-DATA  IS EQUAL TO  'N'
  4380         MOVE CTLKEY             TO  PRVKEY
  4381         GO TO 2199-MINORS-EX.
  4382
  4383     MOVE 80                     TO  LNCT.
  4384     MOVE 'Y'                    TO  PRNTG-SUMM.
  4385     MOVE 'N'                    TO  ANY-COMP.
  4386
  4387     PERFORM 2100-MINOR-LOOP  THRU  2180-NON-UPD-LO
  4388         VARYING  AX  FROM  1  BY  1
  4389             UNTIL  AX  IS GREATER THAN  TBLX.
  4390
  4391     PERFORM 1500-RE-INITIALIZE  THRU  1599-EXIT
  4392         VARYING  TBLX  FROM  1  BY  1
  4393             UNTIL  TBLX  IS EQUAL TO  AX.
  4394
  4395     PERFORM 1400-INITIALIZE-TABLE  THRU  1499-EXIT
  4396         VARYING  TBLX  FROM  1  BY  1
  4397         UNTIL  TBLX  IS EQUAL TO  AX.
  4398
  4399     MOVE CTLKEY                 TO  PRVKEY.
  4400     MOVE 201                    TO  AX.
  4401     MOVE HIGH-VALUE             TO  TBL-CODE (201).
  4402
  4403     PERFORM 2100-MINOR-LOOP  THRU  2180-NON-UPD-LO.
  4404
  4405     IF LNCT > 50
  4406        PERFORM 1700-PAGE-HEADING
  4407                                 THRU 1799-EXIT
  4408     END-IF
  4409
  4410     MOVE '     TOTAL ISSUED PREMIUM ' TO SUM-DT
  4411     COMPUTE WS-WORK-AMT =
  4412        TBL-LPRM (AX) + TBL-DPRM (AX)
  4413     MOVE WS-WORK-AMT           TO SD-LBEN
  4414     MOVE SUM-DT                TO P-DATA
  4415     MOVE '0'                   TO P-CTL
  4416     PERFORM 1600-PRINT-LINE THRU 1699-EXIT
  4417
  4418     MOVE '     TOTAL CANCELLED PREMIUM ' TO SUM-DT
  4419     COMPUTE WS-WORK-AMT =
  4420        TBL-LREF (AX) + TBL-DREF (AX)
  4421     MOVE WS-WORK-AMT           TO SD-LBEN
  4422     MOVE SUM-DT                TO P-DATA
  4423     MOVE '0'                   TO P-CTL
  4424     PERFORM 1600-PRINT-LINE THRU 1699-EXIT
  4425
  4426     MOVE '     NET PREMIUM FOR ACCOUNT      ' TO SUM-DT
  4427     COMPUTE WS-WORK-AMT =
  4428        TBL-LPRM (AX) + TBL-DPRM (AX) +
  4429        TBL-LREF (AX) + TBL-DREF (AX)
  4430     MOVE WS-WORK-AMT           TO SD-LBEN
  4431     MOVE SUM-DT                TO P-DATA
  4432     MOVE '0'                   TO P-CTL
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  94
* EL539.cbl
  4433     PERFORM 1600-PRINT-LINE THRU 1699-EXIT
  4434
  4435     IF PRINT-UNASSIGN-LINE
  4436        MOVE UNASSIGN-LINE-1     TO P-DATA
  4437        MOVE '0'                 TO P-CTL
  4438        PERFORM 1600-PRINT-LINE  THRU 1699-EXIT
  4439
  4440        MOVE UNASSIGN-LINE-2     TO P-DATA
  4441        MOVE ' '                 TO P-CTL
  4442        PERFORM 1600-PRINT-LINE  THRU 1699-EXIT
  4443        MOVE SPACES              TO WS-PRINT-UNASSIGN
  4444     END-IF
  4445
  4446     MOVE MESS-LINE-1            TO P-DATA
  4447     MOVE '0'                    TO P-CTL
  4448     PERFORM 1600-PRINT-LINE     THRU 1699-EXIT
  4449
  4450     MOVE MESS-LINE-2            TO P-DATA
  4451     MOVE ' '                    TO P-CTL
  4452     PERFORM 1600-PRINT-LINE     THRU 1699-EXIT
  4453
  4454     MOVE DISC-LINE-1            TO P-DATA
  4455     MOVE '0'                    TO P-CTL
  4456     PERFORM 1600-PRINT-LINE     THRU 1699-EXIT
  4457
  4458     MOVE DISC-LINE-2            TO P-DATA
  4459     MOVE ' '                    TO P-CTL
  4460     PERFORM 1600-PRINT-LINE     THRU 1699-EXIT
  4461
  4462     MOVE DISC-LINE-3            TO P-DATA
  4463     MOVE ' '                    TO P-CTL
  4464     PERFORM 1600-PRINT-LINE     THRU 1699-EXIT
  4465
  4466
  4467     MOVE 201                    TO  TBLX.
  4468
  4469     PERFORM 1400-INITIALIZE-TABLE  THRU  1499-EXIT.
  4470
  4471     MOVE 'N'                    TO  PRNTG-SUMM.
  4472
  4473     DIVIDE PGCT BY +2
  4474          GIVING WK1
  4475          REMAINDER WK2
  4476     MOVE +0                     TO PGCT
  4477
  4478     IF WK2  NOT = +0
  4479        MOVE SPACES              TO PRT
  4480        MOVE '1'                 TO P-CTL
  4481        PERFORM 1600-PRINT-LINE  THRU 1699-EXIT
  4482     END-IF
  4483
  4484     GO TO 2199-MINORS-EX.
  4485
  4486 2100-MINOR-LOOP.
  4487     MOVE TBL-CTL                TO  BUILD-LO-KEY.
  4488
  4489     IF DTE-COMP-VG  IS EQUAL TO  1
  4490         GO TO 2105-LO-KEY-OK.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  95
* EL539.cbl
  4491
  4492     IF DTE-COMP-VG  IS EQUAL TO  3
  4493         MOVE SPACES             TO  BLK-CARRIER
  4494                                     BLK-GROUPING
  4495                                     BLK-STATE
  4496         GO TO 2105-LO-KEY-OK.
  4497
  4498     IF DTE-COMP-VG  IS EQUAL TO  2
  4499         MOVE SPACES             TO  BLK-GROUPING
  4500         GO TO 2105-LO-KEY-OK.
  4501
  4502     IF DTE-COMP-VG  IS EQUAL TO  4
  4503         MOVE SPACES             TO  BLK-GROUPING
  4504                                     BLK-STATE
  4505         GO TO 2105-LO-KEY-OK.
  4506
  4507     IF DTE-COMP-VG  IS EQUAL TO  ' '
  4508         MOVE SPACES             TO  BLK-CARRIER
  4509                                     BLK-GROUPING
  4510         GO TO 2105-LO-KEY-OK.
  4511
  4512 2105-LO-KEY-OK.
  4513     MOVE BUILD-LO-KEY           TO  LO-CONTROL-PRIMARY.
  4514*    MOVE 'Y'                    TO  LO-UPD.
  4515     MOVE 'N'                    TO  LO-UPD.
  4516
  4517     IF TBL-CODE (AX)  IS EQUAL TO  HIGH-VALUE
  4518         MOVE 'N'                TO  LO-UPD
  4519         GO TO 2110-BY-GETLO.
  4520
  4521     MOVE TBL-CODE (AX)          TO  LO-OFFICER-CODE.
  4522
  4523     READ ERLOFC  INVALID KEY
  4524         MOVE 'N'                TO  LO-UPD.
  4525
  4526 2110-BY-GETLO.
  4527*    IF LNCT  IS GREATER THAN  40
  4528     IF LNCT  IS GREATER THAN  36
  4529         PERFORM 1700-PAGE-HEADING  THRU  1799-EXIT.
  4530
  4531     MOVE SPACE                  TO  SUM-DT.
  4532     MOVE TBL-CODE (AX)          TO  SD-CODE.
  4533
  4534     IF SD-CODE = LOW-VALUES OR HIGH-VALUES
  4535        MOVE SPACES              TO SD-CODE
  4536     END-IF
  4537
  4538     MOVE '-'                    TO  SD-DASH.
  4539     MOVE TBL-LO-NAME (AX)       TO  SD-NAME.
  4540
  4541*    IF LO-UPD  IS EQUAL TO  'N'
  4542*        MOVE 'UNASSIGNED'       TO  SD-NAME
  4543*    ELSE
  4544*        MOVE LO-OFFICER-NAME    TO  SD-NAME.
  4545
  4546
  4547     IF AX = 201
  4548         MOVE 'TOTALS'           TO  SUM-DT
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  96
* EL539.cbl
  4549*        MOVE 'TOTALS'           TO  SD-NAME
  4550         IF DTE-CLIENT = 'UCL'
  4551             NEXT SENTENCE
  4552           ELSE
  4553             GO TO 2110-CONTINUE
  4554       ELSE
  4555         GO TO 2110-CONTINUE.
  4556
  4557     MOVE TBL-LOCT (AX)          TO  SD-LNCT.
  4558     MOVE TBL-LVOL (AX)          TO  SD-LNAMT.
  4559     COMPUTE SD-BPCT ROUNDED = TBL-LBEN (AX) * 100
  4560                             / TBL-LVOL (AX)
  4561         ON SIZE ERROR
  4562             MOVE ZERO           TO  SD-BPCT.
  4563
  4564     COMPUTE SD-LCCT ROUNDED = TBL-LICT (AX) * 100
  4565                             / TBL-LOCT (AX)
  4566         ON SIZE ERROR
  4567             MOVE ZERO           TO  SD-LCCT.
  4568
  4569     COMPUTE SD-DBPC ROUNDED = TBL-DBEN (AX) * 100
  4570                             / TBL-LVOL (AX)
  4571         ON SIZE ERROR
  4572             MOVE ZERO           TO  SD-BPCT.
  4573
  4574     COMPUTE SD-DCPC ROUNDED = TBL-DICT (AX) * 100
  4575                             / TBL-LOCT (AX)
  4576         ON SIZE ERROR
  4577             MOVE ZERO           TO  SD-DCPC.
  4578
  4579 2110-CONTINUE.
  4580     IF LO-UPD  IS EQUAL TO  'N'
  4581         NEXT SENTENCE
  4582     ELSE
  4583         MOVE LO-LOAN-COUNT (RUN-MO)
  4584                                 TO  SD-LNCT
  4585         MOVE LO-LOAN-VOLUME (RUN-MO)
  4586                                 TO  SD-LNAMT.
  4587
  4588     MOVE TBL-LICT (AX)          TO  SD-LICT.
  4589     MOVE TBL-LBEN (AX)          TO  SD-LBEN.
  4590     MOVE TBL-LPRM (AX)          TO  SD-LPRM.
  4591     MOVE TBL-DICT (AX)          TO  SD-DICT.
  4592     MOVE TBL-DBEN (AX)          TO  SD-DBEN.
  4593     MOVE TBL-DPRM (AX)          TO  SD-DPRM.
  4594
  4595     IF LO-UPD  IS EQUAL TO  'N'
  4596         GO TO 2130-BYCOMP.
  4597
  4598     COMPUTE SD-LCCT ROUNDED = TBL-LICT (AX) * 100
  4599                             / LO-LOAN-COUNT (RUN-MO)
  4600         ON SIZE ERROR
  4601             MOVE ZERO           TO  SD-LCCT.
  4602
  4603     COMPUTE SD-BPCT ROUNDED = TBL-LBEN (AX) * 100
  4604                             / LO-LOAN-VOLUME (RUN-MO)
  4605         ON SIZE ERROR
  4606             MOVE ZERO           TO  SD-BPCT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  97
* EL539.cbl
  4607
  4608     COMPUTE SD-DCPC ROUNDED = TBL-DICT (AX) * 100
  4609                             / LO-LOAN-COUNT (RUN-MO)
  4610         ON SIZE ERROR
  4611             MOVE ZERO           TO  SD-DCPC.
  4612
  4613     COMPUTE SD-DBPC ROUNDED = TBL-DBEN (AX) * 100
  4614                             / LO-LOAN-VOLUME (RUN-MO)
  4615         ON SIZE ERROR
  4616             MOVE ZERO           TO  SD-BPCT.
  4617
  4618 2130-BYCOMP.
  4619     MOVE SUM-DT                 TO  P-DATA.
  4620     MOVE '0'                    TO  P-CTL.
  4621
  4622     PERFORM 1600-PRINT-LINE  THRU  1699-EXIT.
  4623
  4624     ADD 2                       TO  LNCT.
  4625
  4626     IF TBL-LCCT (AX)  IS EQUAL TO  ZERO
  4627       AND TBL-LREF (AX) IS EQUAL TO  ZERO
  4628       AND TBL-DCCT (AX) IS EQUAL TO  ZERO
  4629       AND TBL-DREF (AX) IS EQUAL TO  ZERO
  4630         GO TO 2150-BY-REFUNDS.
  4631
  4632     MOVE SPACE                  TO  SUM-DT.
  4633     MOVE 'CANCELLATIONS'        TO  SD-NAME.
  4634     MOVE TBL-LCCT (AX)          TO  SD-LICT.
  4635     MOVE TBL-LREF (AX)          TO  SD-LPRM.
  4636     MOVE TBL-DCCT (AX)          TO  SD-DICT.
  4637     MOVE TBL-DREF (AX)          TO  SD-DPRM.
  4638     MOVE SUM-DT                 TO  P-DATA.
  4639     MOVE SPACE                  TO  P-CTL.
  4640
  4641     PERFORM 1600-PRINT-LINE  THRU  1699-EXIT.
  4642
  4643     ADD 1                       TO  LNCT.
  4644
  4645 2150-BY-REFUNDS.
  4646     IF AX  IS EQUAL TO  201
  4647       AND ANY-COMP  IS EQUAL TO  'Y'
  4648         NEXT SENTENCE
  4649     ELSE
  4650         IF LO-UPD  IS EQUAL TO  'Y'
  4651           AND LO-SUPPRESS-COMP
  4652             GO TO 2170-BY-COMP.
  4653
  4654     IF AX  IS EQUAL TO  201
  4655       AND ANY-COMP  IS EQUAL TO  'N'
  4656         GO TO 2170-BY-COMP.
  4657
  4658     MOVE SPACE                  TO  SUM-DT.
  4659     MOVE 'COMPENSATION'         TO  SD-NAME.
  4660     MOVE TBL-LCOM (AX)          TO  SD-LPRM.
  4661     MOVE TBL-DCOM (AX)          TO  SD-DPRM.
  4662     MOVE SUM-DT                 TO  P-DATA.
  4663     MOVE SPACE                  TO  P-CTL.
  4664
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  98
* EL539.cbl
  4665     PERFORM 1600-PRINT-LINE  THRU  1699-EXIT.
  4666
  4667     ADD 1                       TO  LNCT.
  4668
  4669     MOVE 'Y'                    TO  ANY-COMP.
  4670
  4671 2170-BY-COMP.
  4672     IF LO-UPD  IS EQUAL TO  'N'
  4673       OR TBL-CODE (AX)  IS EQUAL TO  HIGH-VALUE
  4674         GO TO 2180-NON-UPD-LO.
  4675
  4676     MOVE TBL-LICT (AX)          TO  LO-LF-COUNT (RUN-MO).
  4677
  4678     ADD .5  TBL-LPRM (AX)  GIVING  LO-LF-PREM (RUN-MO).
  4679     ADD .5  TBL-LBEN (AX)  GIVING  LO-LF-BENEFIT (RUN-MO).
  4680
  4681     MOVE TBL-DICT (AX)          TO  LO-AH-COUNT (RUN-MO).
  4682
  4683     ADD .5  TBL-DPRM (AX)  GIVING  LO-AH-PREM (RUN-MO).
  4684     ADD .5  TBL-DBEN (AX)  GIVING  LO-AH-BENEFIT (RUN-MO).
  4685
  4686     IF DTE-CLIENT = 'UCL'
  4687         ADD TBL-LCOM (AX) TBL-DCOM (AX)  GIVING TOT-COMM
  4688         MOVE EP-MO              TO  HOLD-PROCESS-MO
  4689         MOVE EP-YR              TO  HOLD-PROCESS-YR
  4690         MOVE EP-CC              TO  HOLD-PROCESS-CC
  4691         MOVE TOT-COMM           TO  LO-TOTAL-COMMISSION
  4692         MOVE HOLD-PROCESS-MO-YR TO  LO-PROCESS-MO-YR.
  4693
  4694     REWRITE LOAN-OFFICER-MASTER.
  4695
  4696 2180-NON-UPD-LO.
  4697     EXIT.
  4698
  4699 2199-MINORS-EX.
  4700     EXIT.
  4701 3000-FINAL-TOTALS SECTION.
  4702
  4703     MOVE SPACES                 TO HD-5
  4704                                    HD-7
  4705                                    HD-8
  4706                                    HD-9
  4707                                    HD-10
  4708                                    H6-NA
  4709
  4710     MOVE 'F'                    TO  PRNTG-SUMM
  4711     PERFORM 1700-PAGE-HEADING   THRU  1799-EXIT
  4712
  4713     MOVE 'N'                    TO  PRNTG-DTL
  4714     MOVE SPACE                  TO  DT-1
  4715     MOVE 'GRAND '               TO  D1-EFF
  4716     MOVE FIN-LBEN               TO  D1-LBEN
  4717     MOVE FIN-DBEN               TO  D1-HBEN
  4718
  4719     ADD FIN-LPRM  FIN-LREF   GIVING  D1-LPRM
  4720     ADD FIN-DPRM  FIN-DREF   GIVING  D1-HPRM
  4721
  4722     IF LN-OPT1  IS EQUAL TO  'Y'
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  99
* EL539.cbl
  4723        ADD FIN-LCOM  FIN-DCOM  GIVING  D1-COMM
  4724     END-IF
  4725
  4726     MOVE DT-1                   TO  P-DATA
  4727     MOVE ZERO                   TO  P-CTL
  4728
  4729     PERFORM 1600-PRINT-LINE     THRU  1699-EXIT
  4730
  4731     MOVE ' GRAND TOT ISSUED PREMIUM ' TO DT-1
  4732     COMPUTE WS-WORK-AMT =
  4733        FIN-LPRM  + FIN-DPRM
  4734     MOVE WS-WORK-AMT            TO D1-LBEN
  4735     MOVE DT-1                   TO P-DATA
  4736     MOVE '0'                    TO P-CTL
  4737     PERFORM 1600-PRINT-LINE     THRU 1699-EXIT
  4738
  4739     MOVE ' GRAND TOT CANCELLED PREMIUM ' TO DT-1
  4740     COMPUTE WS-WORK-AMT =
  4741        FIN-LREF  + FIN-DREF
  4742     MOVE WS-WORK-AMT            TO D1-LBEN
  4743     MOVE DT-1                   TO P-DATA
  4744     MOVE '0'                    TO P-CTL
  4745     PERFORM 1600-PRINT-LINE     THRU 1699-EXIT
  4746
  4747     MOVE ' GRAND TOT NET PREMIUM          ' TO DT-1
  4748     COMPUTE WS-WORK-AMT =
  4749        FIN-LPRM  + FIN-DPRM  +
  4750        FIN-LREF  + FIN-DREF
  4751     MOVE WS-WORK-AMT            TO D1-LBEN
  4752     MOVE DT-1                   TO P-DATA
  4753     MOVE '0'                    TO P-CTL
  4754     PERFORM 1600-PRINT-LINE THRU 1699-EXIT
  4755
  4756     .
  4757 3000-EXIT.
  4758     EXIT.
  4759
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 100
* EL539.cbl
  4761 ABEND-PGM SECTION.
* 4762     COPY ELCABEND.
  4763***************************************************************** 04/14/98
  4764*                                                               * ELCABEND
  4765*                            ELCABEND.                          *    LV003
  4766*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
  4767*                            VMOD 2.002                              CL**2
  4768*                                                               * ELCABEND
  4769*                THIS SECTION DISPLAYS THE NECESSARY MESSAGES   * ELCABEND
  4770*            AND THEN ABENDS.                                   * ELCABEND
  4771*                                                               * ELCABEND
  4772*  NO  CID  MODS  IN  COPYBOOK  ELCABEND                        * ELCABEND
  4773*                                                               * ELCABEND
  4774***************************************************************** ELCABEND
  4775*APS-010.                                                         ELCABEND
  4776     DISPLAY WS-ABEND-MESSAGE.                                    ELCABEND
  4777     DISPLAY WS-ABEND-MESSAGE UPON CONSOLE.                       ELCABEND
  4778                                                                  ELCABEND
  4779     IF WS-ABEND-FILE-STATUS NOT = ZERO                           ELCABEND
  4780         DISPLAY 'FILE STATUS = ' WS-ABEND-FILE-STATUS            ELCABEND
  4781         DISPLAY 'FILE STATUS = ' WS-ABEND-FILE-STATUS            ELCABEND
  4782                                 UPON CONSOLE.                    ELCABEND
  4783                                                                  ELCABEND
  4784     IF WS-RETURN-CODE NOT = ZERO                                 ELCABEND
  4785         DISPLAY 'RETURN CODE = '  WS-RETURN-CODE                 ELCABEND
  4786         DISPLAY 'RETURN CODE = '  WS-RETURN-CODE                 ELCABEND
  4787                                 UPON CONSOLE.                    ELCABEND
  4788                                                                  ELCABEND
  4789     DISPLAY 'PROGRAM WILL NOW ABEND **************'              ELCABEND
  4790     DISPLAY 'PROGRAM WILL NOW ABEND **************'              ELCABEND
  4791                                 UPON CONSOLE.                    ELCABEND
  4792                                                                  ELCABEND
  4793     DIVIDE WS-ZERO BY WS-ZERO GIVING WS-ZERO.                    ELCABEND
  4794     CALL 'ABORTME'.
  4795                                                                  ELCABEND
  4796 APS-EXIT.                                                        ELCABEND
  4797     EXIT.                                                        ELCABEND
  4798
  4799 9000-EOJ SECTION.
* 4800     COPY ELCPRTCX.
  4801******************************************************************04/15/98
  4802*                                                                *ELCPRTCX
  4803*                                                                *ELCPRTCX
  4804*                            ELCPRTCX.                           *   LV003
  4805*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
  4806*                            VMOD=2.003                          *   CL**3
  4807*       CLOSE FICH FILE AND/OR REPORT FILE IF OPEN               *ELCPRTCX
  4808*                                                                *ELCPRTCX
  4809* NOTE- USE ELCPRTCX IF USING ELCPRT2X (ONLINE REPORT SAVE)      *   CL**2
  4810******************************************************************ELCPRTCX
  4811                                                                  ELCPRTCX
  4812      IF FICH-OPEN NOT = SPACE                                    ELCPRTCX
  4813          CLOSE FICH.                                             ELCPRTCX
  4814                                                                  ELCPRTCX
  4815      IF REPT-OPEN NOT = SPACE                                    ELCPRTCX
  4816          MOVE '2'              TO RF-RECORD-TYPE                 ELCPRTCX
  4817          ADD +1 TO DTE-TOT-LINES                                 ELCPRTCX
  4818          MOVE DTE-TOT-LINES    TO RF-LINE-NUMBER                 ELCPRTCX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 101
* EL539.cbl (/apps/prod/cid1p/copy/ELCPRTCX)
  4819          MOVE SPACES           TO RF-TRAILER-RECORD              ELCPRTCX
  4820          MOVE WS-TIME          TO RF-PRINT-HH-MM-SS              ELCPRTCX
  4821          MOVE WS-CURRENT-DATE  TO RF-CURRENT-DATE                ELCPRTCX
  4822          WRITE REPORT-SAVE-FILE                                  ELCPRTCX
  4823          IF DTE-VSAM-FLAGS NOT = ZEROS                           ELCPRTCX
  4824              DISPLAY 'ERROR DURING WRITE OF TYPE 2 REPORT REC'   ELCPRTCX
  4825              DISPLAY 'VSAM RETURN CODE = ' DTE-VSAM-FLAGS        ELCPRTCX
  4826              DISPLAY 'ERROR DURING WRITE OF TYPE 2 REPORT REC'   ELCPRTCX
  4827                  UPON CONSOLE                                    ELCPRTCX
  4828              DISPLAY 'VSAM RETURN CODE = ' DTE-VSAM-FLAGS        ELCPRTCX
  4829                  UPON CONSOLE                                    ELCPRTCX
  4830            ELSE                                                  ELCPRTCX
  4831              DISPLAY '***************************************'   ELCPRTCX
  4832              DISPLAY '***************************************'   ELCPRTCX
  4833              DISPLAY '**               ' OLC-REPORT-NAME         ELCPRTCX
  4834              DISPLAY '**  REPORT HAS BEEN SAVED IN THE     **'   ELCPRTCX
  4835              DISPLAY '**  CLAS-IC ONLINE REPORT FILE       **'   ELCPRTCX
  4836              DISPLAY '**                                   **'   ELCPRTCX
  4837              DISPLAY '***************************************'   ELCPRTCX
  4838              DISPLAY '***************************************'   ELCPRTCX
  4839              CLOSE ELREPT.                                       ELCPRTCX
  4840                                                                  ELCPRTCX
  4841      IF DTE-ABEND-CD-1 = '81'                                    ELCPRTCX
  4842          DISPLAY '***************************************'       ELCPRTCX
  4843          DISPLAY '***************************************'       ELCPRTCX
  4844          DISPLAY '**               ' OLC-REPORT-NAME             ELCPRTCX
  4845          DISPLAY '**  UNABLE TO OPEN ONLINE FILE -     **'       ELCPRTCX
  4846          DISPLAY '**  REPORT PRINTED BUT NOT SAVED     **'       ELCPRTCX
  4847          DISPLAY '**                                   **'       ELCPRTCX
  4848          DISPLAY '***************************************'       ELCPRTCX
  4849          DISPLAY '***************************************'       ELCPRTCX
  4850          DISPLAY 'VSAM RETURN CODE WAS - ', DTE-VSAM-FLAGS.      ELCPRTCX
  4851                                                                  ELCPRTCX
  4852      IF DTE-ABEND-CD-1 = '88'                                    ELCPRTCX
  4853          DISPLAY '***************************************'       ELCPRTCX
  4854          DISPLAY '***************************************'       ELCPRTCX
  4855          DISPLAY '**               ' OLC-REPORT-NAME             ELCPRTCX
  4856          DISPLAY '**  REPORT FILE IS FULL-  REPORT WAS **'       ELCPRTCX
  4857          DISPLAY '**  PRINTED AND PARTIALLY SAVED      **'       ELCPRTCX
  4858          DISPLAY '**                                   **'       ELCPRTCX
  4859          DISPLAY '***************************************'       ELCPRTCX
  4860          DISPLAY '***************************************'       ELCPRTCX
  4861          DISPLAY 'VSAM RETURN CODE WAS - ', DTE-VSAM-FLAGS.      ELCPRTCX
  4862                                                                  ELCPRTCX
  4863                                                                  ELCPRTCX
  4864******************************************************************ELCPRTCX
  4865
  4866     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:       80524     Code:       17772
