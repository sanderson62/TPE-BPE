* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   1
* FNB199.cbl
* Options: int("FNB199.int") anim csi verbose NOBOUND PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("FNB199.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"ebmlsfile" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" NOCHECKDIV NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"32" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"FNB199.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"FNB199.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR NOSTICKY-LINKAGE
*          NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"2" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2 PROGRAM-ID.    FNB199.
     3*:::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
     4*  DESCRIPTION:                                                          :
     5*      THIS PROGRAM GENERATES A REPORT FOR                               :
     6*                                                                        :
     7*      THE RECORDS ARE SORTED BY SUSPENSE CODE WITHIN ACCOUNT.           :
     8*                                                                        :
     9*:::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
    10*    DATE    BY  MODIFICATION                                            :
    11* ========== === ========================================================:
    12* 01/06/1999 VXO CREATION DATE                                           :
    13* 03/19/1999 DAN CR1999030800006 FIXED PAGING PROBLEM                    :
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   2
* FNB199.cbl
    14* 03/19/1999 DAN CR1999030800008 CHG WORKSITE TO UNDERWRITING            :
    15* 10/22/1999 DAN IR1999101300003 2719000300 RPT TO AGY BEN               :
    16* 02/24/2003 DJN CONVERT FROM MAINFRAME TO MICROFOCUS COBOL.             :
    17* 11/06/2003 DJN CR2003110500005 INACTIVATE SEVERAL ACCOUNTS.            :
    18*                NO MORE REPORT FOR UNDERWRITING.                        :
    19* 08/25/2006 AJR REMOVE FROM CLAIMS SYSTEM.                              :
    20*:::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
    21 ENVIRONMENT DIVISION.
    22 INPUT-OUTPUT SECTION.
    23 FILE-CONTROL.
    24* INPUT FILES
    25     SELECT GL-SUSPENSE-TRANS-FILE
    26         ASSIGN TO EXTERNAL SYS010
    27         ORGANIZATION IS LINE SEQUENTIAL
    28         STATUS IS SYS010-STATUS.
    29
    30* OUTPUTS BY DEPARTMENT
    31     SELECT FNB199-GLS-POS
    32         ASSIGN TO EXTERNAL SYS007
    33         ORGANIZATION IS LINE SEQUENTIAL.
    34     SELECT FNB199-GLS-AGY-BENEFITS
    35         ASSIGN TO EXTERNAL SYS008
    36         ORGANIZATION IS LINE SEQUENTIAL.
    37     SELECT FNB199-GLS-CORP-FINANCE
    38         ASSIGN TO EXTERNAL SYS011
    39         ORGANIZATION IS LINE SEQUENTIAL.
    40     SELECT FNB199-GLS-AGY-ACCT
    41         ASSIGN TO EXTERNAL SYS012
    42         ORGANIZATION IS LINE SEQUENTIAL.
    43     SELECT FNB199-GLS-CID
    44         ASSIGN TO EXTERNAL SYS013
    45         ORGANIZATION IS LINE SEQUENTIAL.
    46
    47**** PARM FILE
    48     SELECT PARM-FILE        ASSIGN       TO EXTERNAL IPARM
    49                             ORGANIZATION IS LINE SEQUENTIAL
    50                             FILE STATUS  IS PARM-STATUS.
    51
    52
    53 DATA DIVISION.
    54 FILE SECTION.
    55
    56 FD  GL-SUSPENSE-TRANS-FILE
    57     LABEL RECORDS ARE STANDARD
    58     RECORDING MODE IS F
    59     RECORD CONTAINS 120 CHARACTERS
    60     BLOCK CONTAINS 0 RECORDS.
    61 01  GL-SUSPENSE-TRANS-RECORD.
    62
    63     05  GLS-KEY.
    64         10  GLS-SUSPENSE-CODE     PIC X(15).
    65         10  GLS-ACCOUNT-NO.
    66             15  GLS-MAJ-ACCT      PIC X(10).
    67             15  GLS-DIV           PIC X(2).
    68             15  GLS-CENTER        PIC X(4).
    69             15  GLS-PRODUCT       PIC X(6).
    70             15  GLS-STATE         PIC X(2).
    71         10  GLS-TRANS-DATE        PIC X(8).
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   3
* FNB199.cbl
    72         10  GLS-TRANS-TIME        PIC X(8).
    73     05  GLS-TRANS-AMOUNT          PIC S9(12)V99
    74                                       SIGN TRAILING SEPARATE.
    75     05  GLS-DESCRIPTION           PIC X(30).
    76     05  GLS-REFERENCE             PIC X(10).
    77     05  GLS-SOURCE                PIC X(6).
    78     05  FILLER                    PIC X(4).
    79
    80 FD  FNB199-GLS-POS
    81     LABEL RECORDS ARE OMITTED
    82     RECORDING MODE IS F
    83     RECORD CONTAINS 132 CHARACTERS
    84     BLOCK CONTAINS 0 RECORDS.
    85 01  GLS-POS-RPT               PIC X(132).
    86
    87 FD  FNB199-GLS-AGY-BENEFITS
    88     LABEL RECORDS ARE OMITTED
    89     RECORDING MODE IS F
    90     RECORD CONTAINS 132 CHARACTERS
    91     BLOCK CONTAINS 0 RECORDS.
    92 01  GLS-AGY-BENE-RPT          PIC X(132).
    93
    94 FD  FNB199-GLS-CORP-FINANCE
    95     LABEL RECORDS ARE OMITTED
    96     RECORDING MODE IS F
    97     RECORD CONTAINS 132 CHARACTERS
    98     BLOCK CONTAINS 0 RECORDS.
    99 01  GLS-CORP-FIN-RPT          PIC X(132).
   100
   101 FD  FNB199-GLS-AGY-ACCT
   102     LABEL RECORDS ARE OMITTED
   103     RECORDING MODE IS F
   104     RECORD CONTAINS 132 CHARACTERS
   105     BLOCK CONTAINS 0 RECORDS.
   106 01  GLS-AGY-ACCT-RPT          PIC X(132).
   107
   108 FD  FNB199-GLS-CID
   109     LABEL RECORDS ARE OMITTED
   110     RECORDING MODE IS F
   111     RECORD CONTAINS 132 CHARACTERS
   112     BLOCK CONTAINS 0 RECORDS.
   113 01  GLS-CID-RPT               PIC X(132).
   114
   115**** PARM FILE
   116 FD  PARM-FILE
   117     LABEL RECORDS ARE STANDARD
   118     RECORDING MODE IS F
   119     BLOCK CONTAINS 0 RECORDS.
   120 01  PARM.
   121     05  PARM-CYCLE-DATE PIC X(10) VALUE SPACES.
   122
   123
   124 WORKING-STORAGE SECTION.
   125
   126 01 RC                       PIC S9(9)   COMP-5 VALUE 0.
   127 01 LIST-REC                 PIC X(132).
   128
   129 01  FILLER.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   4
* FNB199.cbl
   130     05  SYS010-STATUS      PIC XX         VALUE ZERO.
   131         88  EOF                           VALUE '10'.
   132     05  WS-PREV-ACCOUNT    PIC X(24)      VALUE SPACE.
   133     05  PARM-STATUS        PIC XX         VALUE SPACES.
   134
   135 01  FILLER.
   136     05  LINE-COUNT         PIC S9(3)      VALUE ZERO.
   137     05  PAGE-COUNT         PIC S9(5)      VALUE ZERO.
   138     05  OUTPUT-COUNT       PIC S9(9)      VALUE ZERO.
   139     05  ERROR-COUNT        PIC S9(9)      VALUE ZERO.
   140     05  INPUT-COUNT        PIC S9(9)      VALUE ZERO.
   141
   142 01  WS-CTRL-SUSP-CODE      PIC X(15)      VALUE SPACES.
   143 01  WS-CTRL-MAJ-ACCT       PIC X(10)      VALUE SPACES.
   144 01  WS-PREVIOUS-ACCT       PIC X(10)      VALUE SPACES.
   145 01  MAJ-ACCT-CTRL-BREAK    PIC X          VALUE 'N'.
   146 01  SUSP-CD-CTRL-BREAK     PIC X          VALUE 'N'.
   147
   148 01  WS-ACCUM-AMT           PIC S9(12)V99  VALUE ZEROES.
   149 01  WS-ACCUM-TOTAL-AMT     PIC S9(12)V99  VALUE ZEROES.
   150 01  WS-TOTAL-AMT           PIC S9(12)V99  VALUE ZEROES.
   151
   152 01  FILLER.
   153     05  WS-CYCLE-DATE       PIC X(10).
   154
   155 01  WS-CURRENT-DATE.
   156     05  WS-CURR-MM         PIC 99         VALUE ZEROES.
   157     05  WS-CURR-DD         PIC 99         VALUE ZEROES.
   158     05  WS-CURR-CC         PIC 99         VALUE ZEROES.
   159     05  WS-CURR-YY         PIC 99         VALUE ZEROES.
   160
   161 01  WK-TRANS-DATE.
   162     05  WK-CC              PIC 99.
   163     05  WK-YY              PIC 99.
   164     05  WK-MM              PIC 99.
   165     05  WK-DD              PIC 99.
   166
   167 01  WORK-DATE.
   168     05  WRK-YR    PIC 9999.
   169     05  WRK-MO    PIC 99.
   170     05  WRK-DAY   PIC 99.
   171
   172 01  SYSTEM-DATE.
   173     05  SYS-MO    PIC 99.
   174     05  SYS-DAY   PIC 99.
   175     05  SYS-YR    PIC 9999.
   176
   177 01  PRINT-SUSPENSE-CODE    PIC X          VALUE ZERO.
   178     88  PRINT-SUSP-CODE                   VALUE '1'.
   179     88  DO-NOT-PRINT-CODE                 VALUE '2'.
   180
   181 01  ACTIVE-ACCOUNT-INICATORS.
   182     05  GLS-2719000300-IND     PIC X      VALUE 'N'.
   183     05  GLS-2719000301-IND     PIC X      VALUE 'N'.
   184     05  GLS-2719000302-IND     PIC X      VALUE 'N'.
   185     05  GLS-2719000307-IND     PIC X      VALUE 'N'.
   186     05  GLS-2719000311-IND     PIC X      VALUE 'N'.
   187     05  GLS-2719000322-IND     PIC X      VALUE 'N'.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   5
* FNB199.cbl
   188     05  GLS-1825011300-IND     PIC X      VALUE 'N'.
   189
   190 01  HDR-VALUES.
   191     05  PIC X(10) VALUE '2719000300'.
   192     05  PIC X(38) VALUE 'CLEARING ACCOUNT - DAILY CYCLE        '.
   193     05  PIC X(10) VALUE '2719000301'.
   194     05  PIC X(38) VALUE 'CLEARING ACCOUNT - DEATH              '.
   195     05  PIC X(10) VALUE '2719000302'.
   196     05  PIC X(38) VALUE 'CLEARING ACCOUNT - LOANS              '.
   197     05  PIC X(10) VALUE '2719000307'.
   198     05  PIC X(38) VALUE 'CLEARING ACCOUNT - SURRENDERS         '.
   199     05  PIC X(10) VALUE '2719000311'.
   200     05  PIC X(38) VALUE 'CWA SUSPENSE                          '.
   201     05  PIC X(10) VALUE '2719000322'.
   202     05  PIC X(38) VALUE 'UNAPPLIED CASH                        '.
   203
   204 01  REDEFINES HDR-VALUES.
   205     05  ACCT-DESCR-TABLE OCCURS 6 TIMES INDEXED BY AT-INDEX.
   206         10  AT-ACCT      PIC X(10).
   207         10  AT-DESCR     PIC X(38).
   208
   209*****************************************************************
   210*  REPORT HEADER DEFINITION                                     *
   211*****************************************************************
   212 01  HDR-1.
   213     05  FILLER           PIC X(06)   VALUE 'DATE: '.
   214     05  WS-RPT-DATE.
   215         10  WS-RPT-MM    PIC X(02)   VALUE SPACES.
   216         10  FILLER       PIC X(01)   VALUE '/'.
   217         10  WS-RPT-DD    PIC X(02)   VALUE SPACES.
   218         10  FILLER       PIC X(01)   VALUE '/'.
   219         10  WS-RPT-CC    PIC X(02)   VALUE SPACES.
   220         10  WS-RPT-YY    PIC X(02)   VALUE SPACES.
   221     05  FILLER           PIC X(20)   VALUE SPACES.
   222     05  FILLER           PIC X(07)   VALUE 'AS OF: '.
   223     05  WS-CYC-DATE      PIC X(10)   VALUE SPACES.
   224     05  FILLER           PIC X(69)   VALUE SPACES.
   225     05  FILLER           PIC X(05)   VALUE 'PAGE '.
   226     05  WS-PAGE-NO       PIC ZZZZ9   VALUE ZEROES.
   227
   228 01  HDR-2.
   229     05  HDR-2-VALUE      PIC X(38)   VALUE SPACES.
   230     05  FILLER           PIC X(95)   VALUE SPACES.
   231
   232 01  HDR-3.
   233     05  FILLER           PIC X(13)   VALUE 'MSA ACCOUNT: '.
   234     05  WS-MSA-ACCT      PIC X(07)   VALUE SPACES.
   235     05  FILLER           PIC X(04)   VALUE SPACES.
   236     05  FILLER           PIC X(17)   VALUE 'FREEDOM ACCOUNT: '.
   237     05  WS-FREEDOM-ACCT  PIC X(13)   VALUE SPACES.
   238     05  FILLER           PIC X(78)   VALUE SPACES.
   239*
   240 01  HDR-4.
   241     05  FILLER           PIC X(14)  VALUE 'DISTRIBUTION: '.
   242     05  WS-DISTRIBUTION  PIC X(21)  VALUE
   243                                     '                     '.
   244     05  FILLER           PIC X(97)  VALUE SPACES.
   245
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   6
* FNB199.cbl
   246 01  DETAIL-HDR1.
   247     05  FILLER           PIC X(10)  VALUE '   MAJOR  '.
   248     05  FILLER           PIC X(03)  VALUE SPACES.
   249     05  FILLER           PIC X(08)  VALUE ' TRANS  '.
   250     05  FILLER           PIC X(03)  VALUE SPACES.
   251     05  FILLER           PIC X(15)  VALUE '  TRANSACTION  '.
   252     05  FILLER           PIC X(03)  VALUE SPACES.
   253     05  FILLER           PIC X(30)  VALUE SPACES.
   254     05  FILLER           PIC X(04)  VALUE SPACES.
   255     05  FILLER           PIC X(06)  VALUE 'SOURCE'.
   256     05  FILLER           PIC X(04)  VALUE SPACES.
   257     05  FILLER           PIC X(15)  VALUE '    SUSPENSE   '.
   258     05  FILLER           PIC X(03)  VALUE SPACES.
   259     05  FILLER           PIC X(11)  VALUE 'TRANSACTION'.
   260     05  FILLER           PIC X(02)  VALUE SPACES.
   261     05  FILLER           PIC X(15)  VALUE ' SUSPENSE CODE '.
   262
   263 01  DETAIL-HDR1B.
   264     05  FILLER           PIC X(10)  VALUE '  ACCOUNT '.
   265     05  FILLER           PIC X(03)  VALUE SPACES.
   266     05  FILLER           PIC X(08)  VALUE '  DATE  '.
   267     05  FILLER           PIC X(03)  VALUE SPACES.
   268     05  FILLER           PIC X(15)  VALUE '     AMOUNT    '.
   269     05  FILLER           PIC X(03)  VALUE SPACES.
   270     05  FILLER           PIC X(30)  VALUE
   271                          'TRANSACTION DESCRIPTION       '.
   272     05  FILLER           PIC X(04)  VALUE SPACES.
   273     05  FILLER           PIC X(06)  VALUE ' CODE '.
   274     05  FILLER           PIC X(04)  VALUE SPACES.
   275     05  FILLER           PIC X(15)  VALUE '      CODE     '.
   276     05  FILLER           PIC X(03)  VALUE SPACES.
   277     05  FILLER           PIC X(11)  VALUE ' REFERENCE '.
   278     05  FILLER           PIC X(02)  VALUE SPACES.
   279     05  FILLER           PIC X(15)  VALUE '  TOTAL AMOUNT '.
   280 01  DETAIL-HDR2.
   281
   282     05  FILLER           PIC X(10)  VALUE ALL '*'.
   283     05  FILLER           PIC X(03)  VALUE SPACES.
   284     05  FILLER           PIC X(08)  VALUE ALL '*'.
   285     05  FILLER           PIC X(03)  VALUE SPACES.
   286     05  FILLER           PIC X(15)  VALUE ALL '*'.
   287     05  FILLER           PIC X(03)  VALUE SPACES.
   288     05  FILLER           PIC X(30)  VALUE ALL '*'.
   289     05  FILLER           PIC X(04)  VALUE SPACES.
   290     05  FILLER           PIC X(06)  VALUE ALL '*'.
   291     05  FILLER           PIC X(04)  VALUE SPACES.
   292     05  FILLER           PIC X(15)  VALUE ALL '*'.
   293     05  FILLER           PIC X(03)  VALUE SPACES.
   294     05  FILLER           PIC X(11)  VALUE ALL '*'.
   295     05  FILLER           PIC X(02)  VALUE SPACES.
   296     05  FILLER           PIC X(15)  VALUE ALL '*'.
   297
   298 01  DETAIL-HDR3.
   299     05  FILLER           PIC X(132) VALUE ALL '-'.
   300
   301 01  DETAIL-HDR4.
   302     05  FILLER           PIC X(40) VALUE ALL SPACES.
   303     05  FILLER           PIC X(53) VALUE
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   7
* FNB199.cbl
   304     '*** NO RECORDS TO PROCESS FOR THIS ACCOUNT NUMBER ***'.
   305     05  FILLER           PIC X(39) VALUE ALL SPACES.
   306
   307 01  BLANK-LINE.
   308     05  FILLER           PIC X(132) VALUE SPACES.
   309
   310 01  DETAIL-1.
   311     05  WS-MAJOR-ACCT    PIC X(10)                VALUE SPACES.
   312     05  FILLER           PIC X(03)                VALUE SPACES.
   313     05  WS-TRANS-DATE.
   314         10  WS-TRANS-MM  PIC X(02)                VALUE SPACES.
   315         10  FILLER       PIC X(01)                VALUE '/'.
   316         10  WS-TRANS-DD  PIC X(02)                VALUE SPACES.
   317         10  FILLER       PIC X(01)                VALUE '/'.
   318         10  WS-TRANS-YY  PIC X(02)                VALUE SPACES.
   319     05  FILLER           PIC X(03)                VALUE SPACES.
   320     05  WS-TRANS-AMOUNT  PIC ----,---,--9.99      VALUE ZEROES.
   321     05  FILLER           PIC X(03)                VALUE SPACES.
   322     05  WS-TRANS-DESC    PIC X(30)                VALUE SPACES.
   323     05  FILLER           PIC X(04)                VALUE SPACES.
   324     05  WS-SOURCE-CODE   PIC X(06)                VALUE SPACES.
   325     05  FILLER           PIC X(04)                VALUE SPACES.
   326     05  WS-SUSP-CODE     PIC X(15)                VALUE SPACES.
   327     05  FILLER           PIC X(03)                VALUE SPACES.
   328     05  WS-REFERENCE     PIC X(11)                VALUE SPACES.
   329     05  FILLER           PIC X(18)                VALUE SPACES.
   330
   331 01  TOTAL-1.
   332     05  FILLER           PIC X(117)               VALUE SPACES.
   333     05  WS-SUSP-TOTAL    PIC ----,---,--9.99      VALUE ZEROES.
   334
   335 01  TOTAL-2.
   336     05  FILLER           PIC X(03)                VALUE SPACES.
   337     05  FILLER           PIC X(26)                VALUE
   338                                  'REPORT TRANSACTION TOTAL: '.
   339     05  WS-TRANS-TOTAL   PIC ----,---,--9.99      VALUE ZEROES.
   340     05  FILLER           PIC X(88)                VALUE SPACES.
   341
   342*    EXEC SQL INCLUDE ISTDWORK.INC END-EXEC.
   343
   344 PROCEDURE DIVISION.
   345
   346     PERFORM 0000-START
   347
   348     PERFORM 1000-GENERATE-REPORT UNTIL EOF
   349
   350     PERFORM 7000-PROCESS-ACCT-CTRL-BREAK
   351
   352     PERFORM 9000-PROCESS-BLANK-REPORTS
   353
   354     PERFORM 9999-END
   355
   356*    GOBACK GIVING RC.
   357     STOP RUN GIVING RC.
   358
   359***---------------------------------------------------------***
   360***--  PROCESS 0000-START:                                --***
   361***--  1.  OPEN INPUT AND OUTPUT FILE.                    --***
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   8
* FNB199.cbl
   362***--  2.  CHECK OPEN STATUS ON INPUT FILE.               --***
   363***--  3.  INITIALIZE COUNTS.                             --***
   364***---------------------------------------------------------***
   365 0000-START.
   366
   367     CALL 'FNBLIST' USING 'O' LIST-REC
   368     OPEN   INPUT  GL-SUSPENSE-TRANS-FILE
   369
   370     IF SYS010-STATUS NOT = '00'
   371       DISPLAY 'SYS010 OPEN ERROR ' SYS010-STATUS UPON SYSERR
   372       MOVE SPACES TO LIST-REC
   373       STRING  'SYS010 OPEN ERROR ' SYS010-STATUS
   374         DELIMITED BY SIZE INTO LIST-REC
   375       CALL 'FNBLIST' USING 'W' LIST-REC
   376       CALL 'FNBLIST' USING 'C' LIST-REC
   377       MOVE 16 TO RC
   378*      GOBACK GIVING RC
   379       STOP RUN GIVING RC
   380     END-IF
   381
   382     OPEN   OUTPUT FNB199-GLS-POS
   383            OUTPUT FNB199-GLS-AGY-BENEFITS
   384            OUTPUT FNB199-GLS-CORP-FINANCE
   385            OUTPUT FNB199-GLS-AGY-ACCT
   386            OUTPUT FNB199-GLS-CID.
   387
   388     MOVE  ZEROES   TO  INPUT-COUNT
   389     MOVE  ZEROES   TO  OUTPUT-COUNT
   390     MOVE  ZEROES   TO  LINE-COUNT
   391     MOVE  ZEROES   TO  PAGE-COUNT
   392     MOVE  ZEROES   TO  ERROR-COUNT
   393
   394     ACCEPT WORK-DATE FROM DATE YYYYMMDD
   395     MOVE WRK-YR  TO SYS-YR
   396     MOVE WRK-MO  TO SYS-MO
   397     MOVE WRK-DAY TO SYS-DAY
   398
   399     MOVE SYSTEM-DATE TO WS-CURRENT-DATE
   400*    CALL 'SYSDATE' USING WS-CURRENT-DATE
   401     MOVE  WS-CURR-MM   TO  WS-RPT-MM
   402     MOVE  WS-CURR-DD   TO  WS-RPT-DD
   403     MOVE  WS-CURR-CC   TO  WS-RPT-CC
   404     MOVE  WS-CURR-YY   TO  WS-RPT-YY
   405
   406*    CALL IGETPARM USING IG-P1
   407*    MOVE IG-P1 TO WS-CYCLE-DATE
   408*
   409*    MOVE WS-CYCLE-DATE TO IV-P2
   410*    MOVE 'MM/DD/YEAR'  TO IV-P3
   411*    INITIALIZE            IV-P4
   412*    CALL IVERDATE USING IV-P1 IV-P2 IV-P3 IV-P4
   413*    IF IV-P1 = 'Y'
   414     OPEN INPUT PARM-FILE.
   415     IF PARM-STATUS NOT = '00'
   416       STRING  'ERROR OPENING PARM FILE, STATUS = '
   417              PARM-STATUS
   418         DELIMITED BY SIZE INTO LIST-REC
   419       CALL 'FNBLIST' USING 'W' LIST-REC
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   9
* FNB199.cbl
   420       CALL 'FNBLIST' USING 'C' LIST-REC
   421       MOVE 16 TO RC
   422       STOP RUN GIVING RC
   423     END-IF.
   424     READ PARM-FILE.
   425     IF PARM-CYCLE-DATE GREATER THAN SPACES
   426       MOVE PARM-CYCLE-DATE TO WS-CYCLE-DATE
   427       MOVE WS-CYCLE-DATE TO WS-CYC-DATE
   428     ELSE
   429       MOVE SPACES TO LIST-REC
   430       STRING '*** INVALID DATE CARD: ' WS-CYCLE-DATE
   431         DELIMITED BY SIZE INTO LIST-REC
   432       CALL 'FNBLIST' USING 'W' LIST-REC
   433       CALL 'FNBLIST' USING 'C' LIST-REC
   434       MOVE 16 TO RC
   435*      GOBACK GIVING RC
   436       STOP RUN GIVING RC
   437     END-IF.
   438
   439***---------------------------------------------------------***
   440***--  PROCESS 1000-GENERATE-REPORT:                      --***
   441***--  1. READ INPUT FILE AND ACCUMULATE INPUT COUNT.     --***
   442***--  2. ONLY PROCESS RECORDS W/SPECIFIED ACCOUNT #.     --***
   443***--  3. PERFORM CONTROL CHECK ROUTINE FOR MAJ ACCT NO.  --***
   444***--  4. PERFORM CONTROL CHECK ROUTINE FOR SUSPENSE CD.  --***
   445***--  5. PERFORM ROUTINE TO PROCESS VALID RECORDS.       --***
   446***--  6. PERFORM ROUTINE TO WRITE VALID OUTPUT RECORDS.  --***
   447***---------------------------------------------------------***
   448 1000-GENERATE-REPORT.
   449
   450     READ GL-SUSPENSE-TRANS-FILE
   451       AT END EXIT PARAGRAPH
   452     END-READ
   453
   454     ADD  +1   TO  INPUT-COUNT
   455
   456     IF GLS-ACCOUNT-NO = '271900030000000000000000' OR
   457                         '271900030100000000000000' OR
   458                         '271900030200000000000000' OR
   459                         '271900030700000000000000' OR
   460                         '271900031100000000000000' OR
   461                         '271900032200000000000000' OR
   462                         '182501130002000000000000'
   463       CONTINUE
   464     ELSE
   465       ADD  +1   TO  ERROR-COUNT
   466       EXIT PARAGRAPH
   467     END-IF
   468
   469     PERFORM 5000-MAJ-ACCT-BREAK-CHECK
   470
   471     IF MAJ-ACCT-CTRL-BREAK = 'Y'
   472       PERFORM 7000-PROCESS-ACCT-CTRL-BREAK
   473       PERFORM 8000-PRINT-HEADERS
   474       PERFORM 5500-SUSP-CODE-BREAK-CHECK
   475       PERFORM 3000-PROCESS-DETAIL-LINE
   476       PERFORM 4000-WRITE-DETAIL-LINE
   477       MOVE WS-CTRL-MAJ-ACCT TO WS-PREVIOUS-ACCT
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  10
* FNB199.cbl
   478       EXIT PARAGRAPH
   479     END-IF
   480
   481     PERFORM 5500-SUSP-CODE-BREAK-CHECK
   482
   483     IF SUSP-CD-CTRL-BREAK = 'Y'
   484       PERFORM 7500-PROCESS-SUSP-CTRL-BREAK
   485     END-IF
   486
   487     PERFORM 3000-PROCESS-DETAIL-LINE
   488
   489     PERFORM 4000-WRITE-DETAIL-LINE.
   490
   491***---------------------------------------------------------***
   492***--  PROCESS 3000-PROCESS-DETAIL-LINE:                  --***
   493***--  1.  PERFORM ROUTINE TO FORMAT THE TRANSACTION      --***
   494***--      DATE AS MM/DD/YY.                              --***
   495***--  2.  MOVE INPUT DATA TO OUTPUT FIELDS.              --***
   496***--  3.  SUSPENSE CODE SHOULD ONLY BE PRINTED ON FIRST  --***
   497***--      LINE FOR OF THAT GROUPING.                     --***
   498***--  4.  ACCUMULATE TOTAL FOR EACH GROUP OF SUSPENSE    --***
   499***--      CODES AND A TOTAL OF TRANSACTION AMOUNTS FOR   --***
   500***--      EACH ACCOUNT NUMBER.                           --***
   501***---------------------------------------------------------***
   502 3000-PROCESS-DETAIL-LINE.
   503
   504     PERFORM 6000-FORMAT-TRANS-DATE
   505
   506     MOVE GLS-MAJ-ACCT     TO WS-MAJOR-ACCT
   507     MOVE GLS-TRANS-AMOUNT TO WS-TRANS-AMOUNT
   508     MOVE GLS-DESCRIPTION  TO WS-TRANS-DESC
   509     MOVE GLS-REFERENCE    TO WS-REFERENCE
   510     MOVE GLS-SOURCE       TO WS-SOURCE-CODE
   511
   512     ADD  GLS-TRANS-AMOUNT TO WS-ACCUM-AMT
   513     ADD  GLS-TRANS-AMOUNT TO WS-ACCUM-TOTAL-AMT
   514
   515     IF PRINT-SUSP-CODE
   516       MOVE GLS-SUSPENSE-CODE TO WS-SUSP-CODE
   517     ELSE
   518       MOVE SPACES            TO WS-SUSP-CODE
   519     END-IF.
   520
   521***---------------------------------------------------------***
   522***--  PROCESS 4000-WRITE-DETAIL-LINE.                    --***
   523***--  1.  DETERMINE IF HEADERS SHOULD BE PRINTED.        --***
   524***--  2.  WRITE OUTPUT RECORDS.                          --***
   525***--  3.  ACCUMULATE LINE AND OUTPUT COUNTS.             --***
   526***---------------------------------------------------------***
   527 4000-WRITE-DETAIL-LINE.
   528
   529     IF LINE-COUNT > +55
   530       PERFORM 8000-PRINT-HEADERS
   531     END-IF
   532
   533     EVALUATE GLS-MAJ-ACCT
   534*      REPORT TO CORP FINANCE/CID
   535       WHEN '1825011300'
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  11
* FNB199.cbl
   536         MOVE 'Y' TO GLS-1825011300-IND
   537         WRITE GLS-CID-RPT FROM DETAIL-1 AFTER ADVANCING 1 LINE
   538         WRITE GLS-CORP-FIN-RPT FROM DETAIL-1
   539         AFTER ADVANCING 1 LINE
   540*      REPORT TO POS
   541       WHEN '2719000300'
   542         MOVE 'Y' TO GLS-2719000300-IND
   543         WRITE GLS-AGY-BENE-RPT FROM DETAIL-1
   544         AFTER ADVANCING 1 LINE
   545         MOVE SPACES TO WS-REFERENCE
   546         WRITE GLS-POS-RPT  FROM DETAIL-1 AFTER ADVANCING 1 LINE
   547*      REPORT TO POS/AGY BENEFITS
   548       WHEN '2719000301'
   549         MOVE 'Y' TO GLS-2719000301-IND
   550         WRITE GLS-AGY-BENE-RPT FROM DETAIL-1
   551         AFTER ADVANCING 1 LINE
   552         MOVE SPACES TO WS-REFERENCE
   553         WRITE GLS-POS-RPT FROM DETAIL-1 AFTER ADVANCING 1 LINE
   554*      REPORT TO POS
   555       WHEN '2719000302'
   556         MOVE 'Y' TO GLS-2719000302-IND
   557         MOVE SPACES TO WS-REFERENCE
   558         WRITE GLS-POS-RPT FROM DETAIL-1 AFTER ADVANCING 1 LINE
   559*      REPORT TO POS
   560       WHEN '2719000307'
   561         MOVE 'Y' TO GLS-2719000307-IND
   562         MOVE SPACES TO WS-REFERENCE
   563         WRITE GLS-POS-RPT FROM DETAIL-1 AFTER ADVANCING 1 LINE
   564*      REPORT TO AGENCY ACCOUNTING
   565       WHEN '2719000311'
   566         MOVE 'Y' TO GLS-2719000311-IND
   567         WRITE GLS-AGY-ACCT-RPT FROM DETAIL-1
   568         AFTER ADVANCING 1 LINE
   569*      REPORT TO POS
   570       WHEN '2719000322'
   571         MOVE 'Y' TO GLS-2719000322-IND
   572         MOVE SPACES TO WS-REFERENCE
   573         WRITE GLS-POS-RPT FROM DETAIL-1 AFTER ADVANCING 1 LINE
   574     END-EVALUATE
   575
   576     ADD   +1   TO  OUTPUT-COUNT
   577     ADD   +1   TO  LINE-COUNT.
   578
   579***---------------------------------------------------------***
   580***--  PROCESS 5000-MAJ-ACCT-BREAK-CHECK.                 --***
   581***--  1.  CHECK FOR FIRST RECORD PROCESSING.             --***
   582***--  2.  CHECK FOR BREAK IN THE CENTER NUMBERS TO       --***
   583***--      DETERMINE A CONTROL BREAK, AND SET INDICATOR.  --***
   584***---------------------------------------------------------***
   585 5000-MAJ-ACCT-BREAK-CHECK.
   586
   587     IF OUTPUT-COUNT IS EQUAL TO ZERO
   588       MOVE  GLS-MAJ-ACCT      TO  WS-CTRL-MAJ-ACCT
   589       MOVE  WS-CTRL-MAJ-ACCT  TO  WS-PREVIOUS-ACCT
   590       MOVE  ZERO  TO  PAGE-COUNT
   591       MOVE 'N' TO  MAJ-ACCT-CTRL-BREAK
   592       PERFORM 8000-PRINT-HEADERS
   593       EXIT PARAGRAPH
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  12
* FNB199.cbl
   594     END-IF
   595
   596     IF  GLS-MAJ-ACCT   =  WS-CTRL-MAJ-ACCT
   597       MOVE  'N'  TO  MAJ-ACCT-CTRL-BREAK
   598     ELSE
   599       MOVE  ZERO    TO  PAGE-COUNT
   600       MOVE  'Y'     TO  MAJ-ACCT-CTRL-BREAK
   601     END-IF
   602
   603     MOVE  GLS-MAJ-ACCT      TO  WS-CTRL-MAJ-ACCT.
   604
   605***---------------------------------------------------------***
   606***--  PROCESS 5500-SUSP-CODE-BREAK-CHECK.                --***
   607***--  1.  CHECK FOR FIRST RECORD PROCESSING.             --***
   608***--  2.  SET PRINT SUSPENSE CODE INDICATOR.             --***
   609***--  3.  CHECK FOR BREAK IN THE CENTER NUMBERS TO       --***
   610***--      DETERMINE A CONTROL BREAK, AND SET INDICATOR.  --***
   611***---------------------------------------------------------***
   612 5500-SUSP-CODE-BREAK-CHECK.
   613
   614     IF  OUTPUT-COUNT IS EQUAL TO ZERO
   615       MOVE  GLS-SUSPENSE-CODE  TO  WS-CTRL-SUSP-CODE
   616       MOVE 'N' TO  SUSP-CD-CTRL-BREAK
   617       MOVE  '1'  TO  PRINT-SUSPENSE-CODE
   618       EXIT PARAGRAPH
   619     END-IF
   620
   621     IF GLS-SUSPENSE-CODE = WS-CTRL-SUSP-CODE
   622       MOVE 'N' TO SUSP-CD-CTRL-BREAK
   623       MOVE '2' TO PRINT-SUSPENSE-CODE
   624     ELSE
   625       MOVE '1' TO PRINT-SUSPENSE-CODE
   626       MOVE 'Y' TO SUSP-CD-CTRL-BREAK
   627     END-IF
   628
   629     MOVE GLS-SUSPENSE-CODE TO WS-CTRL-SUSP-CODE.
   630
   631***---------------------------------------------------------***
   632***--  PROCESS 6000-FORMAT-TRANS-DATE.                    --***
   633***--  1.  MOVE INPUT DATE TO OUTPUT FIELDS.              --***
   634***---------------------------------------------------------***
   635 6000-FORMAT-TRANS-DATE.
   636
   637     MOVE GLS-TRANS-DATE TO WK-TRANS-DATE
   638     MOVE WK-MM          TO WS-TRANS-MM
   639     MOVE WK-DD          TO WS-TRANS-DD
   640     MOVE WK-YY          TO WS-TRANS-YY.
   641
   642***---------------------------------------------------------***
   643***--  PROCESS 7000-PROCESS-ACCT-CTRL-BREAK.              --***
   644***--  1. MOVE ACCUMULATED AMOUNTS TO THE SUSPENSE AND    --***
   645***--     TRANSACTION TOTAL OUTPUT FIELDS.                --***
   646***--  2. PRINT LAST LINE OF THE SUSPENSE TOTAL AMOUNT    --***
   647***--     FOR THE PREVIOUS ACCOUNT NUMBER.                --***
   648***--  3. PRINT LAST LINE OF THE TRANSACTION TOTAL AMOUNT --***
   649***--     FOR THE PREVIOUS ACCOUNT NUMBER.                --***
   650***--  4. ZERO OUT LINE COUNT & ACCUMULATED AMOUNT FIELDS.--***
   651***---------------------------------------------------------***
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  13
* FNB199.cbl
   652 7000-PROCESS-ACCT-CTRL-BREAK.
   653
   654     MOVE WS-ACCUM-AMT        TO  WS-SUSP-TOTAL
   655     MOVE WS-ACCUM-TOTAL-AMT  TO  WS-TRANS-TOTAL
   656
   657     EVALUATE WS-PREVIOUS-ACCT
   658*      REPORT TO CORP FINANCE/CID
   659       WHEN '1825011300'
   660         WRITE GLS-CID-RPT FROM TOTAL-1     AFTER ADVANCING 1 LINE
   661         WRITE GLS-CID-RPT FROM DETAIL-HDR3 AFTER ADVANCING 1 LINE
   662         WRITE GLS-CID-RPT FROM TOTAL-2     AFTER ADVANCING 1 LINE
   663         WRITE GLS-CORP-FIN-RPT FROM TOTAL-1
   664               AFTER ADVANCING 1 LINE
   665         WRITE GLS-CORP-FIN-RPT FROM DETAIL-HDR3
   666               AFTER ADVANCING 1 LINE
   667         WRITE GLS-CORP-FIN-RPT FROM TOTAL-2
   668               AFTER ADVANCING 1 LINE
   669*      REPORT TO POS/AGY BENEFITS
   670       WHEN '2719000300'
   671         WRITE GLS-POS-RPT FROM TOTAL-1     AFTER ADVANCING 1 LINE
   672         WRITE GLS-POS-RPT FROM DETAIL-HDR3 AFTER ADVANCING 1 LINE
   673         WRITE GLS-POS-RPT FROM TOTAL-2     AFTER ADVANCING 1 LINE
   674         WRITE GLS-AGY-BENE-RPT FROM TOTAL-1
   675               AFTER ADVANCING 1 LINE
   676         WRITE GLS-AGY-BENE-RPT FROM DETAIL-HDR3
   677               AFTER ADVANCING 1 LINE
   678         WRITE GLS-AGY-BENE-RPT FROM TOTAL-2
   679               AFTER ADVANCING 1 LINE
   680*      REPORT TO POS/AGY BENEFITS
   681       WHEN '2719000301'
   682         WRITE GLS-POS-RPT FROM TOTAL-1     AFTER ADVANCING 1 LINE
   683         WRITE GLS-POS-RPT FROM DETAIL-HDR3 AFTER ADVANCING 1 LINE
   684         WRITE GLS-POS-RPT FROM TOTAL-2     AFTER ADVANCING 1 LINE
   685         WRITE GLS-AGY-BENE-RPT FROM TOTAL-1
   686               AFTER ADVANCING 1 LINE
   687         WRITE GLS-AGY-BENE-RPT FROM DETAIL-HDR3
   688               AFTER ADVANCING 1 LINE
   689         WRITE GLS-AGY-BENE-RPT FROM TOTAL-2
   690               AFTER ADVANCING 1 LINE
   691*      REPORT TO POS
   692       WHEN '2719000302'
   693         WRITE GLS-POS-RPT FROM TOTAL-1     AFTER ADVANCING 1 LINE
   694         WRITE GLS-POS-RPT FROM DETAIL-HDR3 AFTER ADVANCING 1 LINE
   695         WRITE GLS-POS-RPT FROM TOTAL-2     AFTER ADVANCING 1 LINE
   696*      REPORT TO POS
   697       WHEN '2719000307'
   698         WRITE GLS-POS-RPT FROM TOTAL-1     AFTER ADVANCING 1 LINE
   699         WRITE GLS-POS-RPT FROM DETAIL-HDR3 AFTER ADVANCING 1 LINE
   700         WRITE GLS-POS-RPT FROM TOTAL-2     AFTER ADVANCING 1 LINE
   701*      REPORT TO AGENCY ACCOUNTING
   702       WHEN '2719000311'
   703         WRITE GLS-AGY-ACCT-RPT FROM TOTAL-1
   704               AFTER ADVANCING 1 LINE
   705         WRITE GLS-AGY-ACCT-RPT FROM DETAIL-HDR3
   706               AFTER ADVANCING 1 LINE
   707         WRITE GLS-AGY-ACCT-RPT FROM TOTAL-2
   708               AFTER ADVANCING 1 LINE
   709*      REPORT TO POS
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  14
* FNB199.cbl
   710       WHEN '2719000322'
   711         WRITE GLS-POS-RPT FROM TOTAL-1     AFTER ADVANCING 1 LINE
   712         WRITE GLS-POS-RPT FROM DETAIL-HDR3 AFTER ADVANCING 1 LINE
   713         WRITE GLS-POS-RPT FROM TOTAL-2     AFTER ADVANCING 1 LINE
   714     END-EVALUATE.
   715
   716     MOVE ZEROES TO LINE-COUNT
   717     MOVE ZEROES TO WS-ACCUM-AMT
   718     MOVE ZEROES TO WS-ACCUM-TOTAL-AMT.
   719
   720***---------------------------------------------------------***
   721***--  PROCESS 7500-PROCESS-SUSP-CTRL-BREAK.              --***
   722***--  1. RESET SUSPENSE CODE CONTROL BREAK INDICATOR.    --***
   723***--  2. MOVE SUSPENSE CODE ACCUMULATED AMT TO OUTPUT.   --***
   724***--  2. PRINT SUSPENSE CODE TOTAL LINE.                 --***
   725***---------------------------------------------------------***
   726 7500-PROCESS-SUSP-CTRL-BREAK.
   727
   728     MOVE  'N'           TO  SUSP-CD-CTRL-BREAK
   729     MOVE  WS-ACCUM-AMT  TO  WS-SUSP-TOTAL
   730
   731     EVALUATE GLS-MAJ-ACCT
   732*      REPORT TO CORP FINANCE/CID
   733       WHEN '1825011300'
   734         WRITE GLS-CID-RPT FROM TOTAL-1     AFTER ADVANCING 1 LINE
   735         WRITE GLS-CID-RPT FROM DETAIL-HDR3 AFTER ADVANCING 1 LINE
   736         WRITE GLS-CORP-FIN-RPT FROM TOTAL-1
   737               AFTER ADVANCING 1 LINE
   738         WRITE GLS-CORP-FIN-RPT FROM DETAIL-HDR3
   739               AFTER ADVANCING 1 LINE
   740*      REPORT TO POS/AGY BENEFITS
   741       WHEN '2719000300'
   742         WRITE GLS-POS-RPT FROM TOTAL-1     AFTER ADVANCING 1 LINE
   743         WRITE GLS-POS-RPT FROM DETAIL-HDR3 AFTER ADVANCING 1 LINE
   744         WRITE GLS-AGY-BENE-RPT FROM TOTAL-1
   745               AFTER ADVANCING 1 LINE
   746         WRITE GLS-AGY-BENE-RPT FROM DETAIL-HDR3
   747               AFTER ADVANCING 1 LINE
   748*      REPORT TO POS/AGY BENEFITS
   749       WHEN '2719000301'
   750         WRITE GLS-POS-RPT FROM TOTAL-1     AFTER ADVANCING 1 LINE
   751         WRITE GLS-POS-RPT FROM DETAIL-HDR3 AFTER ADVANCING 1 LINE
   752         WRITE GLS-AGY-BENE-RPT FROM TOTAL-1
   753               AFTER ADVANCING 1 LINE
   754         WRITE GLS-AGY-BENE-RPT FROM DETAIL-HDR3
   755               AFTER ADVANCING 1 LINE
   756*      REPORT TO POS
   757       WHEN '2719000302'
   758         WRITE GLS-POS-RPT FROM TOTAL-1     AFTER ADVANCING 1 LINE
   759         WRITE GLS-POS-RPT FROM DETAIL-HDR3 AFTER ADVANCING 1 LINE
   760*      REPORT TO POS
   761       WHEN '2719000307'
   762         WRITE GLS-POS-RPT FROM TOTAL-1     AFTER ADVANCING 1 LINE
   763         WRITE GLS-POS-RPT FROM DETAIL-HDR3 AFTER ADVANCING 1 LINE
   764*      REPORT TO AGENCY ACCOUNTING
   765       WHEN '2719000311'
   766         WRITE GLS-AGY-ACCT-RPT FROM TOTAL-1
   767               AFTER ADVANCING 1 LINE
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  15
* FNB199.cbl
   768         WRITE GLS-AGY-ACCT-RPT FROM DETAIL-HDR3
   769               AFTER ADVANCING 1 LINE
   770*      REPORT TO POS
   771       WHEN '2719000322'
   772         WRITE GLS-POS-RPT FROM TOTAL-1     AFTER ADVANCING 1 LINE
   773         WRITE GLS-POS-RPT FROM DETAIL-HDR3 AFTER ADVANCING 1 LINE
   774     END-EVALUATE
   775
   776     ADD +2                  TO  LINE-COUNT
   777
   778     MOVE ZEROES  TO WS-SUSP-TOTAL
   779                     WS-ACCUM-AMT.
   780
   781***---------------------------------------------------------***
   782***--  PROCESS 8000-PRINT-HEADERS.                        --***
   783***--  1. RESET LINE COUNT TO ZERO.                       --***
   784***--  2. ADD 1 TO PAGE COUNT AND MOVE TO OUTPUT FIELD.   --***
   785***--  3. PERFORM ROUTINE TO DETERMINE OUTPUT FILE.       --***
   786***---------------------------------------------------------***
   787 8000-PRINT-HEADERS.
   788
   789     MOVE ZEROES     TO LINE-COUNT
   790     ADD  +1         TO PAGE-COUNT
   791     MOVE PAGE-COUNT TO WS-PAGE-NO
   792
   793     PERFORM 8400-EVALUATE-ACCOUNT
   794
   795     ADD +10 TO LINE-COUNT.
   796
   797***---------------------------------------------------------***
   798***--  PROCESS 8400-EVALUATE-ACCOUNT.                     --***
   799***--  1.  EVALUATE USED TO DETERMINE ACCOUNT NUMBER      --***
   800***--      BEING PROCESSED.  MOVE APPROPRIATE HEADER      --***
   801***--      INFO TO THE OUTPUT HEADER FIELDS.              --***
   802***--  2.  WRITE HEADERS.                                 --***
   803***---------------------------------------------------------***
   804 8400-EVALUATE-ACCOUNT.
   805
   806     SET AT-INDEX TO +1
   807     SEARCH ACCT-DESCR-TABLE
   808       AT END
   809         MOVE 'CID SPECIAL CLEARING ACCOUNT' TO HDR-2-VALUE
   810       WHEN AT-ACCT (AT-INDEX) = GLS-MAJ-ACCT
   811         MOVE AT-DESCR (AT-INDEX) TO HDR-2-VALUE
   812     END-SEARCH
   813
   814     EVALUATE GLS-MAJ-ACCT
   815       WHEN '1825011300'
   816           MOVE '1209000'               TO WS-MSA-ACCT
   817           MOVE '1825011300-02'         TO WS-FREEDOM-ACCT
   818           MOVE 'CID                  ' TO WS-DISTRIBUTION
   819           WRITE GLS-CID-RPT FROM HDR-1 AFTER ADVANCING PAGE
   820           WRITE GLS-CID-RPT FROM HDR-2 AFTER ADVANCING 1 LINE
   821           WRITE GLS-CID-RPT FROM HDR-3 AFTER ADVANCING 1 LINE
   822           WRITE GLS-CID-RPT FROM BLANK-LINE
   823                AFTER ADVANCING 1 LINE
   824           WRITE GLS-CID-RPT FROM HDR-4
   825                AFTER  ADVANCING 1 LINE
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  16
* FNB199.cbl
   826           WRITE  GLS-CID-RPT  FROM  BLANK-LINE
   827                AFTER  ADVANCING 2 LINES
   828           WRITE  GLS-CID-RPT  FROM  DETAIL-HDR1
   829                AFTER  ADVANCING 1 LINE
   830           WRITE  GLS-CID-RPT  FROM  DETAIL-HDR1B
   831                AFTER  ADVANCING 1 LINE
   832           WRITE  GLS-CID-RPT  FROM  DETAIL-HDR2
   833                AFTER  ADVANCING 1 LINE
   834           MOVE 'CORPORATE FINANCE    '  TO  WS-DISTRIBUTION
   835           WRITE  GLS-CORP-FIN-RPT  FROM  HDR-1
   836                AFTER  ADVANCING PAGE
   837           WRITE  GLS-CORP-FIN-RPT  FROM  HDR-2
   838                AFTER  ADVANCING 1 LINE
   839           WRITE  GLS-CORP-FIN-RPT  FROM  HDR-3
   840                AFTER  ADVANCING 1 LINE
   841           WRITE  GLS-CORP-FIN-RPT  FROM  BLANK-LINE
   842                AFTER  ADVANCING 1 LINE
   843           WRITE  GLS-CORP-FIN-RPT  FROM  HDR-4
   844                AFTER  ADVANCING 1 LINE
   845           WRITE  GLS-CORP-FIN-RPT  FROM  BLANK-LINE
   846                AFTER  ADVANCING 2 LINES
   847           WRITE  GLS-CORP-FIN-RPT  FROM  DETAIL-HDR1
   848                AFTER  ADVANCING 1 LINE
   849           WRITE  GLS-CORP-FIN-RPT  FROM  DETAIL-HDR1B
   850                AFTER  ADVANCING 1 LINE
   851           WRITE  GLS-CORP-FIN-RPT  FROM  DETAIL-HDR2
   852                AFTER  ADVANCING 1 LINE
   853       WHEN '2719000300'
   854           MOVE '2200015'                TO  WS-MSA-ACCT
   855           MOVE '2719000300   '          TO  WS-FREEDOM-ACCT
   856           MOVE 'POS DEPARTMENT       '  TO  WS-DISTRIBUTION
   857           WRITE  GLS-POS-RPT  FROM  HDR-1
   858                AFTER  ADVANCING PAGE
   859           WRITE  GLS-POS-RPT  FROM  HDR-2
   860                AFTER  ADVANCING 1 LINE
   861           WRITE  GLS-POS-RPT  FROM  HDR-3
   862                AFTER  ADVANCING 1 LINE
   863           WRITE  GLS-POS-RPT  FROM  BLANK-LINE
   864                AFTER  ADVANCING 1 LINE
   865           WRITE  GLS-POS-RPT  FROM  HDR-4
   866                AFTER  ADVANCING 1 LINE
   867           WRITE  GLS-POS-RPT  FROM  BLANK-LINE
   868                AFTER  ADVANCING 2 LINES
   869           WRITE  GLS-POS-RPT  FROM  DETAIL-HDR1
   870                AFTER  ADVANCING 1 LINE
   871           WRITE  GLS-POS-RPT  FROM  DETAIL-HDR1B
   872                AFTER  ADVANCING 1 LINE
   873           WRITE  GLS-POS-RPT  FROM  DETAIL-HDR2
   874                AFTER  ADVANCING 1 LINE
   875           MOVE 'AGENCY BENEFITS      '  TO  WS-DISTRIBUTION
   876           WRITE  GLS-AGY-BENE-RPT  FROM  HDR-1
   877                AFTER  ADVANCING PAGE
   878           WRITE  GLS-AGY-BENE-RPT  FROM  HDR-2
   879                AFTER  ADVANCING 1 LINE
   880           WRITE  GLS-AGY-BENE-RPT  FROM  HDR-3
   881                AFTER  ADVANCING 1 LINE
   882           WRITE  GLS-AGY-BENE-RPT  FROM  BLANK-LINE
   883                AFTER  ADVANCING 1 LINE
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  17
* FNB199.cbl
   884           WRITE  GLS-AGY-BENE-RPT  FROM  HDR-4
   885                AFTER  ADVANCING 1 LINE
   886           WRITE  GLS-AGY-BENE-RPT  FROM  BLANK-LINE
   887                AFTER  ADVANCING 2 LINES
   888           WRITE  GLS-AGY-BENE-RPT  FROM  DETAIL-HDR1
   889                AFTER  ADVANCING 1 LINE
   890           WRITE  GLS-AGY-BENE-RPT  FROM  DETAIL-HDR1B
   891                AFTER  ADVANCING 1 LINE
   892           WRITE  GLS-AGY-BENE-RPT  FROM  DETAIL-HDR2
   893                AFTER  ADVANCING 1 LINE
   894       WHEN '2719000301'
   895           MOVE '2200018'                TO  WS-MSA-ACCT
   896           MOVE '2719000301   '          TO  WS-FREEDOM-ACCT
   897           MOVE 'POS DEPARTMENT       '  TO  WS-DISTRIBUTION
   898           WRITE  GLS-POS-RPT  FROM  HDR-1
   899                AFTER  ADVANCING PAGE
   900           WRITE  GLS-POS-RPT  FROM  HDR-2
   901                AFTER  ADVANCING 1 LINE
   902           WRITE  GLS-POS-RPT  FROM  HDR-3
   903                AFTER  ADVANCING 1 LINE
   904           WRITE  GLS-POS-RPT  FROM  BLANK-LINE
   905                AFTER  ADVANCING 1 LINE
   906           WRITE  GLS-POS-RPT  FROM  HDR-4
   907                AFTER  ADVANCING 1 LINE
   908           WRITE  GLS-POS-RPT  FROM  BLANK-LINE
   909                AFTER  ADVANCING 2 LINES
   910           WRITE  GLS-POS-RPT  FROM  DETAIL-HDR1
   911                AFTER  ADVANCING 1 LINE
   912           WRITE  GLS-POS-RPT  FROM  DETAIL-HDR1B
   913                AFTER  ADVANCING 1 LINE
   914           WRITE  GLS-POS-RPT  FROM  DETAIL-HDR2
   915                AFTER  ADVANCING 1 LINE
   916           MOVE 'AGENCY BENEFITS      '  TO  WS-DISTRIBUTION
   917           WRITE  GLS-AGY-BENE-RPT  FROM  HDR-1
   918                AFTER  ADVANCING PAGE
   919           WRITE  GLS-AGY-BENE-RPT  FROM  HDR-2
   920                AFTER  ADVANCING 1 LINE
   921           WRITE  GLS-AGY-BENE-RPT  FROM  HDR-3
   922                AFTER  ADVANCING 1 LINE
   923           WRITE  GLS-AGY-BENE-RPT  FROM  BLANK-LINE
   924                AFTER  ADVANCING 1 LINE
   925           WRITE  GLS-AGY-BENE-RPT  FROM  HDR-4
   926                AFTER  ADVANCING 1 LINE
   927           WRITE  GLS-AGY-BENE-RPT  FROM  BLANK-LINE
   928                AFTER  ADVANCING 2 LINES
   929           WRITE  GLS-AGY-BENE-RPT  FROM  DETAIL-HDR1
   930                AFTER  ADVANCING 1 LINE
   931           WRITE  GLS-AGY-BENE-RPT  FROM  DETAIL-HDR1B
   932                AFTER  ADVANCING 1 LINE
   933           WRITE  GLS-AGY-BENE-RPT  FROM  DETAIL-HDR2
   934                AFTER  ADVANCING 1 LINE
   935       WHEN '2719000302'
   936           MOVE '2200016'                TO  WS-MSA-ACCT
   937           MOVE '2719000302'             TO  WS-FREEDOM-ACCT
   938           MOVE 'POS DEPARTMENT       '  TO  WS-DISTRIBUTION
   939           WRITE  GLS-POS-RPT  FROM  HDR-1
   940                AFTER  ADVANCING PAGE
   941           WRITE  GLS-POS-RPT  FROM  HDR-2
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  18
* FNB199.cbl
   942                AFTER  ADVANCING 1 LINE
   943           WRITE  GLS-POS-RPT  FROM  HDR-3
   944                AFTER  ADVANCING 1 LINE
   945           WRITE  GLS-POS-RPT  FROM  BLANK-LINE
   946                AFTER  ADVANCING 1 LINE
   947           WRITE  GLS-POS-RPT  FROM  HDR-4
   948                AFTER  ADVANCING 1 LINE
   949           WRITE  GLS-POS-RPT  FROM  BLANK-LINE
   950                AFTER  ADVANCING 2 LINES
   951           WRITE  GLS-POS-RPT  FROM  DETAIL-HDR1
   952                AFTER  ADVANCING 1 LINE
   953           WRITE  GLS-POS-RPT  FROM  DETAIL-HDR1B
   954                AFTER  ADVANCING 1 LINE
   955           WRITE  GLS-POS-RPT  FROM  DETAIL-HDR2
   956                AFTER  ADVANCING 1 LINE
   957       WHEN '2719000307'
   958           MOVE '2200017'                TO  WS-MSA-ACCT
   959           MOVE '2719000307   '          TO  WS-FREEDOM-ACCT
   960           MOVE 'POS DEPARTMENT       '  TO  WS-DISTRIBUTION
   961           WRITE  GLS-POS-RPT  FROM  HDR-1
   962                AFTER  ADVANCING PAGE
   963           WRITE  GLS-POS-RPT  FROM  HDR-2
   964                AFTER  ADVANCING 1 LINE
   965           WRITE  GLS-POS-RPT  FROM  HDR-3
   966                AFTER  ADVANCING 1 LINE
   967           WRITE  GLS-POS-RPT  FROM  BLANK-LINE
   968                AFTER  ADVANCING 1 LINE
   969           WRITE  GLS-POS-RPT  FROM  HDR-4
   970                AFTER  ADVANCING 1 LINE
   971           WRITE  GLS-POS-RPT  FROM  BLANK-LINE
   972                AFTER  ADVANCING 2 LINES
   973           WRITE  GLS-POS-RPT  FROM  DETAIL-HDR1
   974                AFTER  ADVANCING 1 LINE
   975           WRITE  GLS-POS-RPT  FROM  DETAIL-HDR1B
   976                AFTER  ADVANCING 1 LINE
   977           WRITE  GLS-POS-RPT  FROM  DETAIL-HDR2
   978                AFTER  ADVANCING 1 LINE
   979       WHEN '2719000311'
   980           MOVE '2200001'                TO  WS-MSA-ACCT
   981           MOVE '2719000311   '          TO  WS-FREEDOM-ACCT
   982           MOVE 'AGENCY ACCOUNTING    '  TO  WS-DISTRIBUTION
   983           WRITE  GLS-AGY-ACCT-RPT    FROM  HDR-1
   984                AFTER  ADVANCING PAGE
   985           WRITE  GLS-AGY-ACCT-RPT    FROM  HDR-2
   986                AFTER  ADVANCING 1 LINE
   987           WRITE  GLS-AGY-ACCT-RPT    FROM  HDR-3
   988                AFTER  ADVANCING 1 LINE
   989           WRITE  GLS-AGY-ACCT-RPT    FROM  BLANK-LINE
   990                AFTER  ADVANCING 1 LINE
   991           WRITE  GLS-AGY-ACCT-RPT    FROM  HDR-4
   992                AFTER  ADVANCING 1 LINE
   993           WRITE  GLS-AGY-ACCT-RPT    FROM  BLANK-LINE
   994                AFTER  ADVANCING 2 LINES
   995           WRITE  GLS-AGY-ACCT-RPT    FROM  DETAIL-HDR1
   996                AFTER  ADVANCING 1 LINE
   997           WRITE  GLS-AGY-ACCT-RPT    FROM  DETAIL-HDR1B
   998                AFTER  ADVANCING 1 LINE
   999           WRITE  GLS-AGY-ACCT-RPT    FROM  DETAIL-HDR2
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  19
* FNB199.cbl
  1000                AFTER  ADVANCING 1 LINE
  1001       WHEN '2719000322'
  1002           MOVE '2200010'                TO  WS-MSA-ACCT
  1003           MOVE '2719000322   '          TO  WS-FREEDOM-ACCT
  1004           MOVE 'POS DEPARTMENT       '  TO  WS-DISTRIBUTION
  1005           WRITE  GLS-POS-RPT  FROM  HDR-1
  1006                AFTER  ADVANCING PAGE
  1007           WRITE  GLS-POS-RPT  FROM  HDR-2
  1008                AFTER  ADVANCING 1 LINE
  1009           WRITE  GLS-POS-RPT  FROM  HDR-3
  1010                AFTER  ADVANCING 1 LINE
  1011           WRITE  GLS-POS-RPT  FROM  BLANK-LINE
  1012                AFTER  ADVANCING 1 LINE
  1013           WRITE  GLS-POS-RPT  FROM  HDR-4
  1014                AFTER  ADVANCING 1 LINE
  1015           WRITE  GLS-POS-RPT  FROM  BLANK-LINE
  1016                AFTER  ADVANCING 2 LINES
  1017           WRITE  GLS-POS-RPT  FROM  DETAIL-HDR1
  1018                AFTER  ADVANCING 1 LINE
  1019           WRITE  GLS-POS-RPT  FROM  DETAIL-HDR1B
  1020                AFTER  ADVANCING 1 LINE
  1021           WRITE  GLS-POS-RPT  FROM  DETAIL-HDR2
  1022                AFTER  ADVANCING 1 LINE
  1023     END-EVALUATE.
  1024
  1025***---------------------------------------------------------***
  1026***--  PROCESS 9000-PROCESS-BLANK-REPORTS                 --***
  1027***--  1. CLOSE FILES.                                    --***
  1028***--  2. DISPLAY VARIOUS RECORD COUNTS.                  --***
  1029***---------------------------------------------------------***
  1030 9000-PROCESS-BLANK-REPORTS.
  1031
  1032     MOVE 1 TO WS-PAGE-NO
  1033     IF GLS-2719000300-IND   =   'N'
  1034        MOVE '2200015'                TO  WS-MSA-ACCT
  1035        MOVE '2719000300   '          TO  WS-FREEDOM-ACCT
  1036        MOVE 'POS DEPARTMENT       '  TO  WS-DISTRIBUTION
  1037        WRITE GLS-POS-RPT  FROM  HDR-1
  1038               AFTER  ADVANCING PAGE
  1039        WRITE GLS-POS-RPT  FROM  HDR-2
  1040               AFTER  ADVANCING 1 LINE
  1041        WRITE GLS-POS-RPT  FROM  HDR-3
  1042               AFTER  ADVANCING 1 LINE
  1043        WRITE GLS-POS-RPT  FROM  BLANK-LINE
  1044               AFTER  ADVANCING 1 LINE
  1045        WRITE GLS-POS-RPT  FROM  HDR-4
  1046               AFTER  ADVANCING 1 LINE
  1047        WRITE GLS-POS-RPT  FROM  BLANK-LINE
  1048               AFTER  ADVANCING 2 LINES
  1049        WRITE GLS-POS-RPT  FROM  DETAIL-HDR1
  1050               AFTER  ADVANCING 1 LINE
  1051        WRITE GLS-POS-RPT  FROM  DETAIL-HDR1B
  1052               AFTER  ADVANCING 1 LINE
  1053        WRITE GLS-POS-RPT  FROM  DETAIL-HDR2
  1054               AFTER  ADVANCING 1 LINE
  1055        WRITE GLS-POS-RPT  FROM  DETAIL-HDR4
  1056               AFTER  ADVANCING 5 LINES
  1057     END-IF.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  20
* FNB199.cbl
  1058     MOVE 'AGENCY BENEFITS      '  TO  WS-DISTRIBUTION
  1059     WRITE GLS-AGY-BENE-RPT FROM HDR-1 AFTER ADVANCING PAGE
  1060     WRITE GLS-AGY-BENE-RPT FROM HDR-2 AFTER ADVANCING 1 LINE
  1061     WRITE GLS-AGY-BENE-RPT FROM HDR-3 AFTER ADVANCING 1 LINE
  1062     WRITE GLS-AGY-BENE-RPT FROM BLANK-LINE AFTER ADVANCING 1 LINE
  1063     WRITE GLS-AGY-BENE-RPT FROM HDR-4      AFTER ADVANCING 1 LINE
  1064     WRITE GLS-AGY-BENE-RPT FROM BLANK-LINE
  1065           AFTER ADVANCING 2 LINES
  1066     WRITE GLS-AGY-BENE-RPT  FROM  DETAIL-HDR1
  1067           AFTER  ADVANCING 1 LINE
  1068     WRITE GLS-AGY-BENE-RPT  FROM  DETAIL-HDR1B
  1069           AFTER  ADVANCING 1 LINE
  1070     WRITE GLS-AGY-BENE-RPT  FROM  DETAIL-HDR2
  1071           AFTER  ADVANCING 1 LINE
  1072     WRITE GLS-AGY-BENE-RPT  FROM  DETAIL-HDR4
  1073           AFTER  ADVANCING 5 LINES.
  1074     IF GLS-2719000301-IND   =   'N'
  1075        MOVE '2200018'                TO  WS-MSA-ACCT
  1076        MOVE '2719000301   '          TO  WS-FREEDOM-ACCT
  1077        MOVE 'POS DEPARTMENT       '  TO  WS-DISTRIBUTION
  1078        WRITE GLS-POS-RPT  FROM  HDR-1
  1079               AFTER  ADVANCING PAGE
  1080        WRITE GLS-POS-RPT  FROM  HDR-2
  1081               AFTER  ADVANCING 1 LINE
  1082        WRITE GLS-POS-RPT  FROM  HDR-3
  1083               AFTER  ADVANCING 1 LINE
  1084        WRITE GLS-POS-RPT  FROM  BLANK-LINE
  1085               AFTER  ADVANCING 1 LINE
  1086        WRITE GLS-POS-RPT  FROM  HDR-4
  1087               AFTER  ADVANCING 1 LINE
  1088        WRITE GLS-POS-RPT  FROM  BLANK-LINE
  1089               AFTER  ADVANCING 2 LINES
  1090        WRITE GLS-POS-RPT  FROM  DETAIL-HDR1
  1091               AFTER  ADVANCING 1 LINE
  1092        WRITE GLS-POS-RPT  FROM  DETAIL-HDR1B
  1093               AFTER  ADVANCING 1 LINE
  1094        WRITE GLS-POS-RPT  FROM  DETAIL-HDR2
  1095               AFTER  ADVANCING 1 LINE
  1096        WRITE GLS-POS-RPT  FROM  DETAIL-HDR4
  1097               AFTER  ADVANCING 5 LINES
  1098        MOVE 'AGENCY BENEFITS      '  TO  WS-DISTRIBUTION
  1099        WRITE GLS-AGY-BENE-RPT  FROM  HDR-1
  1100               AFTER  ADVANCING PAGE
  1101        WRITE GLS-AGY-BENE-RPT  FROM  HDR-2
  1102               AFTER  ADVANCING 1 LINE
  1103        WRITE GLS-AGY-BENE-RPT  FROM  HDR-3
  1104               AFTER  ADVANCING 1 LINE
  1105        WRITE GLS-AGY-BENE-RPT  FROM  BLANK-LINE
  1106               AFTER  ADVANCING 1 LINE
  1107        WRITE GLS-AGY-BENE-RPT  FROM  HDR-4
  1108               AFTER  ADVANCING 1 LINE
  1109        WRITE GLS-AGY-BENE-RPT  FROM  BLANK-LINE
  1110               AFTER  ADVANCING 2 LINES
  1111        WRITE GLS-AGY-BENE-RPT  FROM  DETAIL-HDR1
  1112               AFTER  ADVANCING 1 LINE
  1113        WRITE GLS-AGY-BENE-RPT  FROM  DETAIL-HDR1B
  1114               AFTER  ADVANCING 1 LINE
  1115        WRITE GLS-AGY-BENE-RPT  FROM  DETAIL-HDR2
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  21
* FNB199.cbl
  1116               AFTER  ADVANCING 1 LINE
  1117        WRITE GLS-AGY-BENE-RPT  FROM  DETAIL-HDR4
  1118               AFTER  ADVANCING 5 LINES.
  1119     IF GLS-2719000302-IND   =   'N'
  1120        MOVE '2200016'                TO  WS-MSA-ACCT
  1121        MOVE '2719000302   '          TO  WS-FREEDOM-ACCT
  1122        MOVE 'POS DEPARTMENT       '  TO  WS-DISTRIBUTION
  1123        WRITE GLS-POS-RPT  FROM  HDR-1
  1124               AFTER  ADVANCING PAGE
  1125        WRITE GLS-POS-RPT  FROM  HDR-2
  1126               AFTER  ADVANCING 1 LINE
  1127        WRITE GLS-POS-RPT  FROM  HDR-3
  1128               AFTER  ADVANCING 1 LINE
  1129        WRITE GLS-POS-RPT  FROM  BLANK-LINE
  1130               AFTER  ADVANCING 1 LINE
  1131        WRITE GLS-POS-RPT  FROM  HDR-4
  1132               AFTER  ADVANCING 1 LINE
  1133        WRITE GLS-POS-RPT  FROM  BLANK-LINE
  1134               AFTER  ADVANCING 2 LINES
  1135        WRITE GLS-POS-RPT  FROM  DETAIL-HDR1
  1136               AFTER  ADVANCING 1 LINE
  1137        WRITE GLS-POS-RPT  FROM  DETAIL-HDR1B
  1138               AFTER  ADVANCING 1 LINE
  1139        WRITE GLS-POS-RPT  FROM  DETAIL-HDR2
  1140               AFTER  ADVANCING 1 LINE
  1141        WRITE GLS-POS-RPT  FROM  DETAIL-HDR4
  1142               AFTER  ADVANCING 5 LINES.
  1143     IF  GLS-2719000307-IND   =   'N'
  1144         MOVE '2200017'                TO  WS-MSA-ACCT
  1145         MOVE '2719000307   '          TO  WS-FREEDOM-ACCT
  1146         MOVE 'POS DEPARTMENT       '  TO  WS-DISTRIBUTION
  1147         WRITE GLS-POS-RPT  FROM  HDR-1
  1148                AFTER  ADVANCING PAGE
  1149         WRITE GLS-POS-RPT  FROM  HDR-2
  1150                AFTER  ADVANCING 1 LINE
  1151         WRITE GLS-POS-RPT  FROM  HDR-3
  1152                AFTER  ADVANCING 1 LINE
  1153         WRITE GLS-POS-RPT  FROM  BLANK-LINE
  1154                AFTER  ADVANCING 1 LINE
  1155         WRITE GLS-POS-RPT  FROM  HDR-4
  1156                AFTER  ADVANCING 1 LINE
  1157         WRITE GLS-POS-RPT  FROM  BLANK-LINE
  1158                AFTER  ADVANCING 2 LINES
  1159         WRITE GLS-POS-RPT  FROM  DETAIL-HDR1
  1160                AFTER  ADVANCING 1 LINE
  1161         WRITE GLS-POS-RPT  FROM  DETAIL-HDR1B
  1162                AFTER  ADVANCING 1 LINE
  1163         WRITE GLS-POS-RPT  FROM  DETAIL-HDR2
  1164                AFTER  ADVANCING 1 LINE
  1165         WRITE GLS-POS-RPT  FROM  DETAIL-HDR4
  1166                AFTER  ADVANCING 5 LINES.
  1167     IF  GLS-2719000311-IND   =   'N'
  1168         MOVE '2200001'                TO  WS-MSA-ACCT
  1169         MOVE '2719000311   '          TO  WS-FREEDOM-ACCT
  1170         MOVE 'AGENCY ACCOUNTING    '  TO  WS-DISTRIBUTION
  1171         WRITE GLS-AGY-ACCT-RPT  FROM  HDR-1
  1172                AFTER  ADVANCING PAGE
  1173         WRITE GLS-AGY-ACCT-RPT  FROM  HDR-2
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  22
* FNB199.cbl
  1174                AFTER  ADVANCING 1 LINE
  1175         WRITE GLS-AGY-ACCT-RPT  FROM  HDR-3
  1176                AFTER  ADVANCING 1 LINE
  1177         WRITE GLS-AGY-ACCT-RPT  FROM  BLANK-LINE
  1178                AFTER  ADVANCING 1 LINE
  1179         WRITE GLS-AGY-ACCT-RPT  FROM  HDR-4
  1180                AFTER  ADVANCING 1 LINE
  1181         WRITE GLS-AGY-ACCT-RPT  FROM  BLANK-LINE
  1182                AFTER  ADVANCING 2 LINES
  1183         WRITE GLS-AGY-ACCT-RPT  FROM  DETAIL-HDR1
  1184                AFTER  ADVANCING 1 LINE
  1185         WRITE GLS-AGY-ACCT-RPT  FROM  DETAIL-HDR1B
  1186                AFTER  ADVANCING 1 LINE
  1187         WRITE GLS-AGY-ACCT-RPT  FROM  DETAIL-HDR2
  1188                AFTER  ADVANCING 1 LINE
  1189         WRITE GLS-AGY-ACCT-RPT  FROM  DETAIL-HDR4
  1190                AFTER  ADVANCING 5 LINES.
  1191     IF  GLS-2719000322-IND   =   'N'
  1192         MOVE '2200010'                TO  WS-MSA-ACCT
  1193         MOVE '2719000322   '          TO  WS-FREEDOM-ACCT
  1194         MOVE 'POS DEPARTMENT       '  TO  WS-DISTRIBUTION
  1195         WRITE GLS-POS-RPT  FROM  HDR-1
  1196                AFTER  ADVANCING PAGE
  1197         WRITE GLS-POS-RPT  FROM  HDR-2
  1198                AFTER  ADVANCING 1 LINE
  1199         WRITE GLS-POS-RPT  FROM  HDR-3
  1200                AFTER  ADVANCING 1 LINE
  1201         WRITE GLS-POS-RPT  FROM  BLANK-LINE
  1202                AFTER  ADVANCING 1 LINE
  1203         WRITE GLS-POS-RPT  FROM  HDR-4
  1204                AFTER  ADVANCING 1 LINE
  1205         WRITE GLS-POS-RPT  FROM  BLANK-LINE
  1206                AFTER  ADVANCING 2 LINES
  1207         WRITE GLS-POS-RPT  FROM  DETAIL-HDR1
  1208                AFTER  ADVANCING 1 LINE
  1209         WRITE GLS-POS-RPT  FROM  DETAIL-HDR1B
  1210                AFTER  ADVANCING 1 LINE
  1211         WRITE GLS-POS-RPT  FROM  DETAIL-HDR2
  1212                AFTER  ADVANCING 1 LINE
  1213         WRITE GLS-POS-RPT  FROM  DETAIL-HDR4
  1214                AFTER  ADVANCING 5 LINES.
  1215     IF  GLS-1825011300-IND   =   'N'
  1216         MOVE '1209000'                TO  WS-MSA-ACCT
  1217         MOVE '1825011300-02'          TO  WS-FREEDOM-ACCT
  1218         MOVE 'CID DEPARTMENT       '  TO  WS-DISTRIBUTION
  1219         WRITE  GLS-CID-RPT  FROM  HDR-1
  1220                 AFTER  ADVANCING PAGE
  1221         WRITE  GLS-CID-RPT  FROM  HDR-2
  1222                 AFTER  ADVANCING 1 LINE
  1223         WRITE  GLS-CID-RPT  FROM  HDR-3
  1224                 AFTER  ADVANCING 1 LINE
  1225         WRITE  GLS-CID-RPT  FROM  BLANK-LINE
  1226                 AFTER  ADVANCING 1 LINE
  1227         WRITE  GLS-CID-RPT  FROM  HDR-4
  1228                 AFTER  ADVANCING 1 LINE
  1229         WRITE  GLS-CID-RPT  FROM  BLANK-LINE
  1230                 AFTER  ADVANCING 2 LINES
  1231         WRITE  GLS-CID-RPT  FROM  DETAIL-HDR1
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  23
* FNB199.cbl
  1232                 AFTER  ADVANCING 1 LINE
  1233         WRITE  GLS-CID-RPT  FROM  DETAIL-HDR1B
  1234                 AFTER  ADVANCING 1 LINE
  1235         WRITE  GLS-CID-RPT  FROM  DETAIL-HDR2
  1236                 AFTER  ADVANCING 1 LINE
  1237         WRITE  GLS-CID-RPT  FROM  DETAIL-HDR4
  1238                 AFTER  ADVANCING 5 LINES
  1239         MOVE 'CORPORATE FINANCE    '  TO  WS-DISTRIBUTION
  1240         WRITE  GLS-CORP-FIN-RPT   FROM  HDR-1
  1241                 AFTER  ADVANCING PAGE
  1242         WRITE  GLS-CORP-FIN-RPT   FROM  HDR-2
  1243                 AFTER  ADVANCING 1 LINE
  1244         WRITE  GLS-CORP-FIN-RPT   FROM  HDR-3
  1245                 AFTER  ADVANCING 1 LINE
  1246         WRITE  GLS-CORP-FIN-RPT   FROM  BLANK-LINE
  1247                 AFTER  ADVANCING 1 LINE
  1248         WRITE  GLS-CORP-FIN-RPT   FROM  HDR-4
  1249                 AFTER  ADVANCING 1 LINE
  1250         WRITE  GLS-CORP-FIN-RPT   FROM  BLANK-LINE
  1251                 AFTER  ADVANCING 2 LINES
  1252         WRITE  GLS-CORP-FIN-RPT   FROM  DETAIL-HDR1
  1253                 AFTER  ADVANCING 1 LINE
  1254         WRITE  GLS-CORP-FIN-RPT   FROM  DETAIL-HDR1B
  1255                 AFTER  ADVANCING 1 LINE
  1256         WRITE  GLS-CORP-FIN-RPT   FROM  DETAIL-HDR2
  1257                 AFTER  ADVANCING 1 LINE
  1258         WRITE  GLS-CORP-FIN-RPT   FROM  DETAIL-HDR4
  1259                 AFTER  ADVANCING 1 LINE.
  1260
  1261***---------------------------------------------------------***
  1262***--  PROCESS 9999-END.                                  --***
  1263***--  1. CLOSE FILES.                                    --***
  1264***--  2. DISPLAY VARIOUS RECORD COUNTS.                  --***
  1265***---------------------------------------------------------***
  1266 9999-END.
  1267
  1268*    DISPLAY '***  GLS-2719000300-IND = ' GLS-2719000300-IND.
  1269*    DISPLAY '***  GLS-2719000301-IND = ' GLS-2719000301-IND.
  1270*    DISPLAY '***  GLS-2719000302-IND = ' GLS-2719000302-IND.
  1271*    DISPLAY '***  GLS-2719000307-IND = ' GLS-2719000307-IND.
  1272*    DISPLAY '***  GLS-2719000311-IND = ' GLS-2719000311-IND.
  1273*    DISPLAY '***  GLS-2719000322-IND = ' GLS-2719000322-IND.
  1274*    DISPLAY '***  GLS-1825011300-IND = ' GLS-1825011300-IND.
  1275
  1276     DISPLAY '*=====================================*' UPON SYSERR
  1277     DISPLAY '* FNB199 - CID SPECIAL CLEARING ACCT =*' UPON SYSERR
  1278     DISPLAY '*=====================================*' UPON SYSERR
  1279     DISPLAY '      INPUT RECORDS READ: ' INPUT-COUNT  UPON SYSERR
  1280     DISPLAY 'RECORDS W/INVALID ACCT #: ' ERROR-COUNT  UPON SYSERR
  1281     DISPLAY '  OUTPUT RECORDS WRITTEN: ' OUTPUT-COUNT UPON SYSERR
  1282     DISPLAY '*=====================================*' UPON SYSERR
  1283
  1284     MOVE    '*=====================================*' TO LIST-REC
  1285     CALL 'FNBLIST' USING 'W' LIST-REC
  1286     MOVE    '* FNB199 - CID SPECIAL CLEARING ACCT =*' TO LIST-REC
  1287     CALL 'FNBLIST' USING 'W' LIST-REC
  1288     MOVE    '*=====================================*' TO LIST-REC
  1289     CALL 'FNBLIST' USING 'W' LIST-REC
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  24
* FNB199.cbl
  1290     MOVE SPACES TO LIST-REC
  1291     STRING  '      INPUT RECORDS READ: ' INPUT-COUNT
  1292       DELIMITED BY SIZE INTO LIST-REC
  1293     CALL 'FNBLIST' USING 'W' LIST-REC
  1294     MOVE SPACES TO LIST-REC
  1295     STRING  'RECORDS W/INVALID ACCT #: ' ERROR-COUNT
  1296       DELIMITED BY SIZE INTO LIST-REC
  1297     CALL 'FNBLIST' USING 'W' LIST-REC
  1298     MOVE SPACES TO LIST-REC
  1299     STRING  '  OUTPUT RECORDS WRITTEN: ' OUTPUT-COUNT
  1300       DELIMITED BY SIZE INTO LIST-REC
  1301     CALL 'FNBLIST' USING 'W' LIST-REC
  1302     MOVE    '*=====================================*' TO LIST-REC
  1303     CALL 'FNBLIST' USING 'W' LIST-REC
  1304
  1305     CLOSE GL-SUSPENSE-TRANS-FILE
  1306           FNB199-GLS-POS
  1307           FNB199-GLS-AGY-BENEFITS
  1308           FNB199-GLS-CORP-FINANCE
  1309           FNB199-GLS-AGY-ACCT
  1310           FNB199-GLS-CID.
  1311     CLOSE PARM-FILE.
  1312     CALL 'FNBLIST' USING 'C' LIST-REC.
  1313
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:        6704     Code:       19876
