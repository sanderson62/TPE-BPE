* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   1
* PEMPMF1.cbl
* Options: int("PEMPMF1.int") anim csi verbose NOBOUND PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("PEMPMF1.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"ebmlsfile" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" NOCHECKDIV NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"32" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"PEMPMF1.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"PEMPMF1.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR NOSTICKY-LINKAGE
*          NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"2" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2 PROGRAM-ID. PEMPMF1.
     3 AUTHOR.     PABLO.
     4 DATE-COMPILED. 06-Oct-15 17:19.
     6 ENVIRONMENT DIVISION.
     7 INPUT-OUTPUT SECTION.
     8 FILE-CONTROL.
     9     SELECT ERPNDM           ASSIGN TO ERPNDM
    10                             ORGANIZATION IS INDEXED
    11                             ACCESS IS DYNAMIC
    12                             RECORD KEY IS PM-CONTROL-PRIMARY
    13                             FILE STATUS IS ERPNDM-FILE-STATUS.
    14
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   2
* PEMPMF1.cbl
    15 DATA DIVISION.
    16 FILE SECTION.
    17
    18 FD  ERPNDM.
    19
*   20                                 COPY ERCPNDM.
    21******************************************************************
    22*                                                                *
    23*                                                                *
    24*                            ERCPNDM                             *
    25*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
    26*                            VMOD=2.003                          *
    27*                                                                *
    28*   FILE DESCRIPTION = PENDING MAILING DATA                      *
    29*                                                                *
    30*   FILE TYPE = VSAM,KSDS                                        *
    31*   RECORD SIZE = 374   RECFORM = FIX                            *
    32*                                                                *
    33*   BASE CLUSTER NAME = ERPNDM                 RKP=2,LEN=11      *
    34*   ALTERNATE PATH    = NOT USED                                 *
    35*                                                                *
    36*   LOG = YES                                                    *
    37*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
    38******************************************************************
    39*                   C H A N G E   L O G
    40*
    41* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    42*-----------------------------------------------------------------
    43*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    44* EFFECTIVE    NUMBER
    45*-----------------------------------------------------------------
    46* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
    47* 071108  CR2008040800002  PEMA  ADD CRED BENE INFORMATION
    48* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
    49******************************************************************
    50
    51 01  PENDING-MAILING-DATA.
    52     12  PM-RECORD-ID                      PIC XX.
    53         88  VALID-MA-ID                       VALUE 'PM'.
    54
    55     12  PM-CONTROL-PRIMARY.
    56         16  PM-COMPANY-CD                 PIC X.
    57         16  PM-ENTRY-BATCH                PIC X(6).
    58         16  PM-BATCH-SEQ-NO               PIC S9(4)     COMP.
    59         16  PM-BATCH-CHG-SEQ-NO           PIC S9(4)     COMP.
    60
    61     12  FILLER                            PIC X(14).
    62
    63     12  PM-ACCESS-CONTROL.
    64         16  PM-SOURCE-SYSTEM              PIC XX.
    65             88  PM-FROM-CREDIT                VALUE 'CR'.
    66             88  PM-FROM-VSI                   VALUE 'VS'.
    67             88  PM-FROM-WARRANTY              VALUE 'WA'.
    68             88  PM-FROM-OTHER                 VALUE 'OT'.
    69         16  PM-RECORD-ADD-DT              PIC XX.
    70         16  PM-RECORD-ADDED-BY            PIC XXXX.
    71         16  PM-LAST-MAINT-DT              PIC XX.
    72         16  PM-LAST-MAINT-BY              PIC XXXX.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   3
* PEMPMF1.cbl (/apps/prod/cid1p/copy/ERCPNDM)
    73         16  PM-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
    74
    75     12  PM-PROFILE-INFO.
    76         16  PM-QUALIFY-CODE-1             PIC XX.
    77         16  PM-QUALIFY-CODE-2             PIC XX.
    78         16  PM-QUALIFY-CODE-3             PIC XX.
    79         16  PM-QUALIFY-CODE-4             PIC XX.
    80         16  PM-QUALIFY-CODE-5             PIC XX.
    81
    82         16  PM-INSURED-LAST-NAME          PIC X(15).
    83         16  PM-INSURED-FIRST-NAME         PIC X(10).
    84         16  PM-INSURED-MIDDLE-INIT        PIC X.
    85         16  PM-INSURED-ISSUE-AGE          PIC 99.
    86         16  PM-INSURED-BIRTH-DT           PIC XX.
    87         16  PM-INSURED-SEX                PIC X.
    88             88  PM-SEX-MALE                   VALUE 'M'.
    89             88  PM-SEX-FEMALE                 VALUE 'F'.
    90         16  PM-INSURED-SOC-SEC-NO         PIC X(11).
    91
    92         16  PM-ADDRESS-CORRECTED          PIC X.
    93         16  PM-JOINT-BIRTH-DT             PIC XX.
    94*        16  FILLER                        PIC X(12).
    95
    96         16  PM-ADDRESS-LINE-1             PIC X(30).
    97         16  PM-ADDRESS-LINE-2             PIC X(30).
    98         16  PM-CITY-STATE.
    99             20  PM-CITY                   PIC X(28).
   100             20  PM-STATE                  PIC XX.
   101         16  PM-ZIP.
   102             20  PM-ZIP-CODE.
   103                 24  PM-ZIP-1              PIC X.
   104                     88  PM-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
   105                 24  FILLER                PIC X(4).
   106             20  PM-ZIP-PLUS4              PIC X(4).
   107         16  PM-CANADIAN-ZIP  REDEFINES  PM-ZIP.
   108             20  PM-CAN-POST1              PIC XXX.
   109             20  PM-CAN-POST2              PIC XXX.
   110             20  FILLER                    PIC XXX.
   111
   112         16  PM-PHONE-NO                   PIC 9(11)       COMP-3.
   113
   114         16  FILLER                        PIC X(03).
   115
   116     12  PM-CRED-BENE-INFO.
   117         16  PM-CRED-BENE-NAME             PIC X(25).
   118         16  PM-CRED-BENE-ADDR             PIC X(30).
   119         16  PM-CRED-BENE-ADDR2            PIC X(30).
   120         16  PM-CRED-BENE-CTYST.
   121             20  PM-CRED-BENE-CITY         PIC X(28).
   122             20  PM-CRED-BENE-STATE        PIC XX.
   123         16  PM-CRED-BENE-ZIP.
   124             20  PM-CB-ZIP-CODE.
   125                 24  PM-CB-ZIP-1           PIC X.
   126                     88  PM-CB-CANADIAN-POST-CODE
   127                                  VALUE 'A' THRU 'Z'.
   128                 24  FILLER                PIC X(4).
   129             20  PM-CB-ZIP-PLUS4           PIC X(4).
   130         16  PM-CB-CANADIAN-ZIP  REDEFINES  PM-CRED-BENE-ZIP.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   4
* PEMPMF1.cbl (/apps/prod/cid1p/copy/ERCPNDM)
   131             20  PM-CB-CAN-POST1           PIC XXX.
   132             20  PM-CB-CAN-POST2           PIC XXX.
   133             20  FILLER                    PIC XXX.
   134     12  PM-POST-CARD-MAIL-DATA.
   135         16  PM-MAIL-DATA OCCURS 7.
   136             20  PM-MAIL-TYPE              PIC X.
   137                 88  PM-12MO-MAILING           VALUE '1'.
   138                 88  PM-EXP-MAILING            VALUE '2'.
   139             20  PM-MAIL-STATUS            PIC X.
   140                 88  PM-MAIL-ST-MAILED         VALUE '1'.
   141                 88  PM-MAIL-ST-RETURNED       VALUE '2'.
   142                 88  PM-MAIL-ST-NOT-MAILED     VALUE '3'.
   143             20  PM-MAIL-DATE              PIC XX.
   144     12  FILLER                            PIC XX.
   145     12  FILLER                            PIC X(12).
   146*    12  FILLER                            PIC X(30).
   147
   148******************************************************************
   149
   150 WORKING-STORAGE SECTION.
   151 77  S1                          PIC S9(3) COMP-3 VALUE +0.
   152 77  WS-STATE-SW                 PIC X  VALUE ' '.
   153     88  VALID-STATE               VALUE 'Y'.
   154 77  WS-DIS-EFF-DT               PIC X(10)  VALUE SPACES.
   155 77  WS-DIS-EXP-DT               PIC X(10)  VALUE SPACES.
   156 77  WS-REWRITE-SW               PIC X      VALUE SPACES.
   157     88  REWRITE-PM                 VALUE 'Y'.
   158 01  WS-STATUS-CODES.
   159     05  ERPNDM-FILE-STATUS      PIC XX  VALUE SPACES.
   160     05  WS-EOF-SW               PIC X   VALUE SPACES.
   161         88  END-OF-ERPNDM               VALUE 'Y'.
   162         88  MORE-ERPNDM                 VALUE ' '.
   163
   164*****************************************************************
   165*                                                               *
   166*                     STATE CODE TABLE                          *
   167*                                                               *
   168*  CAUTION:  THIS TABLE MUST BE IN SEQUENCE BY STATE OR THE     *
   169*            SEARCH VERB WILL NOT WORK PROPERLY !               *
   170*                                                               *
   171*****************************************************************
   172
   173 01  STATE-VALUES.
   174     05  PIC X(24)  VALUE 'AAAA                    '.
   175     05  PIC X(24)  VALUE 'AEAE                    '.
   176     05  PIC X(24)  VALUE 'AKAKALASKA              '.
   177     05  PIC X(24)  VALUE 'ALALALABAMA             '.
   178     05  PIC X(24)  VALUE 'APAP                    '.
   179     05  PIC X(24)  VALUE 'ARARARKANSAS            '.
   180     05  PIC X(24)  VALUE 'ASASAMERICAN SAMOA      '.
   181     05  PIC X(24)  VALUE 'AZAZARIZONA             '.
   182     05  PIC X(24)  VALUE 'CACACALIFORNIA          '.
   183     05  PIC X(24)  VALUE 'CDCNCANADA              '.
   184     05  PIC X(24)  VALUE 'CNCNCANADA              '.
   185     05  PIC X(24)  VALUE 'COCOCOLORADO            '.
   186     05  PIC X(24)  VALUE 'CTCTCONNECTICUT         '.
   187     05  PIC X(24)  VALUE 'DCDCDISTRICT OF COLUMBIA'.
   188     05  PIC X(24)  VALUE 'DEDEDELAWARE            '.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   5
* PEMPMF1.cbl
   189     05  PIC X(24)  VALUE 'FCOTOTHER ALIEN         '.
   190     05  PIC X(24)  VALUE 'FLFLFLORIDA             '.
   191     05  PIC X(24)  VALUE 'GAGAGEORGIA             '.
   192     05  PIC X(24)  VALUE 'GUGUGUAM                '.
   193     05  PIC X(24)  VALUE 'HIHIHAWAII              '.
   194     05  PIC X(24)  VALUE 'IAIAIOWA                '.
   195     05  PIC X(24)  VALUE 'IDIDIDAHO               '.
   196     05  PIC X(24)  VALUE 'ILILILLINOIS            '.
   197     05  PIC X(24)  VALUE 'INININDIANA             '.
   198     05  PIC X(24)  VALUE 'KSKSKANSAS              '.
   199     05  PIC X(24)  VALUE 'KYKYKENTUCKY            '.
   200     05  PIC X(24)  VALUE 'LALALOUISIANA           '.
   201     05  PIC X(24)  VALUE 'MAMAMASSACHUSETTS       '.
   202     05  PIC X(24)  VALUE 'MDMDMARYLAND            '.
   203     05  PIC X(24)  VALUE 'MEMEMAINE               '.
   204     05  PIC X(24)  VALUE 'MIMIMICHIGAN            '.
   205     05  PIC X(24)  VALUE 'MNMNMINNESOTA           '.
   206     05  PIC X(24)  VALUE 'MOMOMISSOURI            '.
   207     05  PIC X(24)  VALUE 'MSMSMISSISSIPPI         '.
   208     05  PIC X(24)  VALUE 'MTMTMONTANA             '.
   209     05  PIC X(24)  VALUE 'NCNCNORTH CAROLINA      '.
   210     05  PIC X(24)  VALUE 'NDNDNORTH DAKOTA        '.
   211     05  PIC X(24)  VALUE 'NENENEBRASKA            '.
   212     05  PIC X(24)  VALUE 'NHNHNEW HAMPSHIRE       '.
   213     05  PIC X(24)  VALUE 'NJNJNEW JERSEY          '.
   214     05  PIC X(24)  VALUE 'NMNMNEW MEXICO          '.
   215     05  PIC X(24)  VALUE 'NVNVNEVADA              '.
   216     05  PIC X(24)  VALUE 'NYNYNEW YORK            '.
   217     05  PIC X(24)  VALUE 'OFOTOTHER ALIEN         '.
   218     05  PIC X(24)  VALUE 'OHOHOHIO                '.
   219     05  PIC X(24)  VALUE 'OKOKOKLAHOMA            '.
   220     05  PIC X(24)  VALUE 'OROROREGON              '.
   221     05  PIC X(24)  VALUE 'OTOTOTHER ALIEN         '.
   222     05  PIC X(24)  VALUE 'PAPAPENNSYLVANIA        '.
   223     05  PIC X(24)  VALUE 'PRPRPUERTO RICO         '.
   224     05  PIC X(24)  VALUE 'RIRIRHODE ISLAND        '.
   225     05  PIC X(24)  VALUE 'SCSCSOUTH CAROLINA      '.
   226     05  PIC X(24)  VALUE 'SDSDSOUTH DAKOTA        '.
   227     05  PIC X(24)  VALUE 'TNTNTENNESSEE           '.
   228     05  PIC X(24)  VALUE 'TXTXTEXAS               '.
   229     05  PIC X(24)  VALUE 'UTUTUTAH                '.
   230     05  PIC X(24)  VALUE 'VAVAVIRGINIA            '.
   231     05  PIC X(24)  VALUE 'VIVIUS VIRGIN ISLANDS   '.
   232     05  PIC X(24)  VALUE 'VTVTVERMONT             '.
   233     05  PIC X(24)  VALUE 'WAWAWASHINGTON          '.
   234     05  PIC X(24)  VALUE 'WIWIWISCONSIN           '.
   235     05  PIC X(24)  VALUE 'WVWVWEST VIRGINIA       '.
   236     05  PIC X(24)  VALUE 'WYWYWYOMING             '.
   237
   238 01  FILLER REDEFINES STATE-VALUES.
   239     05  STATE-TABLE
   240             OCCURS 63 TIMES
   241             ASCENDING KEY IS ST-STATE
   242             INDEXED BY ST-INDEX.
   243         10  ST-STATE          PIC XX.
   244         10  ST-ALT-STATE      PIC XX.
   245         10  ST-NAME           PIC X(20).
   246
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   6
* PEMPMF1.cbl
   247
*  248                                 COPY ELCDATE.
   249******************************************************************06/11/98
   250*                                                                *ELCDATE
   251*                                                                *ELCDATE
   252*                            ELCDATE.                            *   LV023
   253*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL*16
   254*                            VMOD=2.003                           ELCDATE
   255*                                                                *ELCDATE
   256*                                                                *ELCDATE
   257*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *ELCDATE
   258*                 LENGTH = 200                                   *   CL*19
   259******************************************************************ELCDATE
   260                                                                  ELCDATE
   261 01  DATE-CONVERSION-DATA.                                        ELCDATE
   262     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.    CL*19
   263     12  DC-OPTION-CODE                PIC X.                        CL*15
   264         88  BIN-TO-GREG                VALUE ' '.                ELCDATE
   265         88  ELAPSED-BETWEEN-BIN        VALUE '1'.                ELCDATE
   266         88  EDIT-GREG-TO-BIN           VALUE '2'.                ELCDATE
   267         88  YMD-GREG-TO-BIN            VALUE '3'.                ELCDATE
   268         88  MDY-GREG-TO-BIN            VALUE '4'.                ELCDATE
   269         88  JULIAN-TO-BIN              VALUE '5'.                ELCDATE
   270         88  BIN-PLUS-ELAPSED           VALUE '6'.                ELCDATE
   271         88  FIND-CENTURY               VALUE '7'.                   CL*22
   272         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.                ELCDATE
   273         88  EDIT-GREG-TO-BIN-3         VALUE '9'.                ELCDATE
   274         88  YMD-GREG-TO-BIN-3          VALUE 'A'.                ELCDATE
   275         88  MDY-GREG-TO-BIN-3          VALUE 'B'.                ELCDATE
   276         88  JULIAN-TO-BIN-3            VALUE 'C'.                ELCDATE
   277         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.                ELCDATE
   278         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.                   CL*14
   279         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.                   CL*14
   280         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.                   CL*14
   281         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.         CL*14
   282         88  CHECK-LEAP-YEAR            VALUE 'H'.                   CL*14
   283         88  BIN-3-TO-GREG              VALUE 'I'.                   CL*14
   284         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.                   CL*14
   285         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.                   CL*14
   286         88  CYMD-GREG-TO-BIN           VALUE 'L'.                   CL*14
   287         88  MDCY-GREG-TO-BIN           VALUE 'M'.                   CL*14
   288         88  MDY-GREG-TO-JULIAN         VALUE 'N'.                   CL*14
   289         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.                   CL*14
   290         88  YMD-GREG-TO-JULIAN         VALUE 'P'.                   CL*14
   291         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.                   CL*14
   292         88  THREE-CHARACTER-BIN                                  ELCDATE
   293                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.       CL*14
   294         88  GREGORIAN-TO-BIN                                        CL**2
   295                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.    CL*14
   296         88  BIN-TO-GREGORIAN                                        CL**2
   297                  VALUES ' ' '1' 'I' '8' 'G'.                        CL*14
   298         88  JULIAN-TO-BINARY                                        CL**2
   299                  VALUES '5' 'C' 'E' 'F'.                            CL*14
   300     12  DC-ERROR-CODE                 PIC X.                        CL*15
   301         88  NO-CONVERSION-ERROR        VALUE ' '.                   CL**3
   302         88  DATE-CONVERSION-ERROR                                ELCDATE
   303                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.        CL*14
   304         88  DATE-IS-ZERO               VALUE '1'.                ELCDATE
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   7
* PEMPMF1.cbl (/apps/prod/cid1p/copy/ELCDATE)
   305         88  DATE-IS-NON-NUMERIC        VALUE '2'.                ELCDATE
   306         88  DATE-IS-INVALID            VALUE '3'.                ELCDATE
   307         88  DATE1-GREATER-DATE2        VALUE '4'.                ELCDATE
   308         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.                ELCDATE
   309         88  DATE-INVALID-OPTION        VALUE '9'.                ELCDATE
   310         88  INVALID-CENTURY            VALUE 'A'.                ELCDATE
   311         88  ONLY-CENTURY               VALUE 'B'.                ELCDATE
   312         88  ONLY-LEAP-YEAR             VALUE 'C'.                ELCDATE
   313         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.              CL**3
   314     12  DC-END-OF-MONTH               PIC X.                        CL*15
   315         88  CALCULATE-END-OF-MONTH     VALUE '1'.                ELCDATE
   316     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.         CL*15
   317         88  USE-NORMAL-PROCESS         VALUE ' '.                ELCDATE
   318         88  ADJUST-DOWN-100-YRS        VALUE '1'.                ELCDATE
   319         88  ADJUST-UP-100-YRS          VALUE '2'.                ELCDATE
   320     12  FILLER                        PIC X.                        CL*15
   321     12  DC-CONVERSION-DATES.                                        CL*15
   322         16  DC-BIN-DATE-1             PIC XX.                       CL*15
   323         16  DC-BIN-DATE-2             PIC XX.                       CL*15
   324         16  DC-GREG-DATE-1-EDIT       PIC X(08).                    CL*15
   325         16  DC-GREG-DATE-1-EDIT-R REDEFINES                         CL*15
   326                       DC-GREG-DATE-1-EDIT.                       ELCDATE
   327             20  DC-EDIT1-MONTH        PIC 99.                       CL*15
   328             20  SLASH1-1              PIC X.                        CL*15
   329             20  DC-EDIT1-DAY          PIC 99.                       CL*15
   330             20  SLASH1-2              PIC X.                        CL*15
   331             20  DC-EDIT1-YEAR         PIC 99.                       CL*15
   332         16  DC-GREG-DATE-2-EDIT       PIC X(08).                    CL*15
   333         16  DC-GREG-DATE-2-EDIT-R REDEFINES                         CL*15
   334                     DC-GREG-DATE-2-EDIT.                         ELCDATE
   335             20  DC-EDIT2-MONTH        PIC 99.                       CL*15
   336             20  SLASH2-1              PIC X.                        CL*15
   337             20  DC-EDIT2-DAY          PIC 99.                       CL*15
   338             20  SLASH2-2              PIC X.                        CL*15
   339             20  DC-EDIT2-YEAR         PIC 99.                       CL*15
   340         16  DC-GREG-DATE-1-YMD        PIC 9(06).                    CL*15
   341         16  DC-GREG-DATE-1-YMD-R  REDEFINES                         CL*15
   342                     DC-GREG-DATE-1-YMD.                          ELCDATE
   343             20  DC-YMD-YEAR           PIC 99.                       CL*15
   344             20  DC-YMD-MONTH          PIC 99.                       CL*15
   345             20  DC-YMD-DAY            PIC 99.                       CL*15
   346         16  DC-GREG-DATE-1-MDY        PIC 9(06).                    CL*15
   347         16  DC-GREG-DATE-1-MDY-R REDEFINES                          CL*15
   348                      DC-GREG-DATE-1-MDY.                         ELCDATE
   349             20  DC-MDY-MONTH          PIC 99.                       CL*15
   350             20  DC-MDY-DAY            PIC 99.                       CL*15
   351             20  DC-MDY-YEAR           PIC 99.                       CL*15
   352         16  DC-GREG-DATE-1-ALPHA.                                   CL*15
   353             20  DC-ALPHA-MONTH        PIC X(10).                    CL*15
   354             20  DC-ALPHA-DAY          PIC 99.                       CL*15
   355             20  FILLER                PIC XX.                       CL*15
   356             20  DC-ALPHA-CENTURY.                                   CL*15
   357                 24 DC-ALPHA-CEN-N     PIC 99.                       CL*15
   358             20  DC-ALPHA-YEAR         PIC 99.                       CL*15
   359         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.           CL*15
   360         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.           CL*15
   361         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.           CL*15
   362         16  DC-JULIAN-DATE            PIC 9(05).                    CL*15
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   8
* PEMPMF1.cbl (/apps/prod/cid1p/copy/ELCDATE)
   363         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE                CL*20
   364                                       PIC 9(05).                    CL*20
   365         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.                  CL*15
   366             20  DC-JULIAN-YEAR        PIC 99.                       CL*15
   367             20  DC-JULIAN-DAYS        PIC 999.                      CL*15
   368         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.       CL*15
   369         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.    CL*15
   370         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.    CL*15
   371     12  DATE-CONVERSION-VARIBLES.                                   CL*15
   372         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.            CL*15
   373         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.          CL*15
   374             20  FILLER                PIC 9(3).                     CL*15
   375             20  HOLD-CEN-1-CCYY.                                    CL*15
   376                 24  HOLD-CEN-1-CC     PIC 99.                       CL*17
   377                 24  HOLD-CEN-1-YY     PIC 99.                       CL*17
   378             20  HOLD-CEN-1-MO         PIC 99.                       CL*17
   379             20  HOLD-CEN-1-DA         PIC 99.                       CL*17
   380         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.            CL*15
   381             20  HOLD-CEN-1-R-MO       PIC 99.                       CL*17
   382             20  HOLD-CEN-1-R-DA       PIC 99.                       CL*17
   383             20  HOLD-CEN-1-R-CCYY.                                  CL*15
   384                 24  HOLD-CEN-1-R-CC   PIC 99.                       CL*17
   385                 24  HOLD-CEN-1-R-YY   PIC 99.                       CL*17
   386             20  FILLER                PIC 9(3).                     CL*15
   387         16  HOLD-CENTURY-1-X.                                       CL*15
   388             20  FILLER                PIC X(3)  VALUE SPACES.       CL*15
   389             20  HOLD-CEN-1-X-CCYY.                                  CL*15
   390                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.          CL*17
   391                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.          CL*17
   392             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.          CL*17
   393             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.          CL*17
   394         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.          CL*15
   395             20  HOLD-CEN-1-R-X-MO     PIC XX.                       CL*17
   396             20  HOLD-CEN-1-R-X-DA     PIC XX.                       CL*17
   397             20  HOLD-CEN-1-R-X-CCYY.                                CL*15
   398                 24  HOLD-CEN-1-R-X-CC PIC XX.                       CL*17
   399                 24  HOLD-CEN-1-R-X-YY PIC XX.                       CL*17
   400             20  FILLER                PIC XXX.                      CL*23
   401         16  DC-BIN-DATE-EXPAND-1      PIC XXX.                      CL*15
   402         16  DC-BIN-DATE-EXPAND-2      PIC XXX.                      CL*15
   403         16  DC-JULIAN-DATE-1          PIC 9(07).                    CL*15
   404         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.          CL*15
   405             20  DC-JULIAN-1-CCYY.                                   CL*15
   406                 24  DC-JULIAN-1-CC    PIC 99.                       CL*15
   407                 24  DC-JULIAN-1-YR    PIC 99.                       CL*15
   408             20  DC-JULIAN-DA-1        PIC 999.                      CL*15
   409         16  DC-JULIAN-DATE-2          PIC 9(07).                    CL*15
   410         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.          CL*15
   411             20  DC-JULIAN-2-CCYY.                                   CL*15
   412                 24  DC-JULIAN-2-CC    PIC 99.                       CL*15
   413                 24  DC-JULIAN-2-YR    PIC 99.                       CL*15
   414             20  DC-JULIAN-DA-2        PIC 999.                      CL*15
   415         16  DC-GREG-DATE-A-EDIT.                                    CL*15
   416             20  DC-EDITA-MONTH        PIC 99.                       CL*15
   417             20  SLASHA-1              PIC X VALUE '/'.              CL*15
   418             20  DC-EDITA-DAY          PIC 99.                       CL*15
   419             20  SLASHA-2              PIC X VALUE '/'.              CL*15
   420             20  DC-EDITA-CCYY.                                      CL*15
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   9
* PEMPMF1.cbl (/apps/prod/cid1p/copy/ELCDATE)
   421                 24  DC-EDITA-CENT     PIC 99.                       CL*15
   422                 24  DC-EDITA-YEAR     PIC 99.                       CL*15
   423         16  DC-GREG-DATE-B-EDIT.                                    CL*15
   424             20  DC-EDITB-MONTH        PIC 99.                       CL*15
   425             20  SLASHB-1              PIC X VALUE '/'.              CL*15
   426             20  DC-EDITB-DAY          PIC 99.                       CL*15
   427             20  SLASHB-2              PIC X VALUE '/'.              CL*15
   428             20  DC-EDITB-CCYY.                                      CL*15
   429                 24  DC-EDITB-CENT     PIC 99.                       CL*15
   430                 24  DC-EDITB-YEAR     PIC 99.                       CL*15
   431         16  DC-GREG-DATE-CYMD         PIC 9(08).                    CL*15
   432         16  DC-GREG-DATE-CYMD-R REDEFINES                           CL*15
   433                              DC-GREG-DATE-CYMD.                  ELCDATE
   434             20  DC-CYMD-CEN           PIC 99.                       CL*15
   435             20  DC-CYMD-YEAR          PIC 99.                       CL*15
   436             20  DC-CYMD-MONTH         PIC 99.                       CL*15
   437             20  DC-CYMD-DAY           PIC 99.                       CL*15
   438         16  DC-GREG-DATE-MDCY         PIC 9(08).                    CL*15
   439         16  DC-GREG-DATE-MDCY-R REDEFINES                           CL*15
   440                              DC-GREG-DATE-MDCY.                  ELCDATE
   441             20  DC-MDCY-MONTH         PIC 99.                       CL*15
   442             20  DC-MDCY-DAY           PIC 99.                       CL*15
   443             20  DC-MDCY-CEN           PIC 99.                       CL*15
   444             20  DC-MDCY-YEAR          PIC 99.                       CL*15
   445    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.      ELCDATE
   446        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.        ELCDATE
   447    12  DC-EL310-DATE                  PIC X(21).                    CL*26
   448    12  FILLER                         PIC X(28).                    CL*26
   449
   450 01  WS-HOLD-CITY-STATE          PIC X(30)  VALUE SPACES.
   451 01  WS-WORK-CITY-ST.
   452     05  WS-WORK-CITY            PIC X(28)  VALUE SPACES.
   453     05  WS-WORK-STATE           PIC XX     VALUE SPACES.
   454 01  WS-HOLD-ERPNDM              PIC X(374) VALUE LOW-VALUES.
   455 01  WS-WORK-FIELDS.
   456     05  WS-ABEND-FLD            PIC 9         VALUE ZEROS.
   457     05  WS-ZERO-FLD             PIC 9         VALUE ZEROS.
   458     05  WS-ERPNDM-RECS-IN       PIC 9(9)      VALUE ZEROS.
   459     05  WS-ERPNDM-RECS-FIX      PIC 9(9)      VALUE ZEROS.
   460     05  WS-ERPNDM-RECS-DEL      PIC 9(9)      VALUE ZEROS.
   461     05  WS-DISPLAY-CNT          PIC Z,ZZZ,ZZ9 VALUE ZEROS.
   462     05  WS-INVALID-ST-CNT       PIC 9(9)      VALUE ZEROS.
   463
   464 PROCEDURE DIVISION.
   465 0000-MAINLINE.
   466
   467     PERFORM 0100-OPEN-FILES     THRU 0100-EXIT
   468     PERFORM 0200-INITIALIZE     THRU 0200-EXIT
   469     PERFORM 0500-PROCESS        THRU 0500-EXIT UNTIL
   470        END-OF-ERPNDM
   471*       OR WS-ERPNDM-RECS-FIX > 500
   472     PERFORM 3000-CLOSE-FILES    THRU 3000-EXIT
   473     PERFORM 4000-FINAL-TOTALS   THRU 4000-EXIT
   474     GOBACK
   475
   476     .
   477 0000-EXIT.
   478     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  10
* PEMPMF1.cbl
   479
   480 0100-OPEN-FILES.
   481
   482     OPEN I-O   ERPNDM
   483*    OPEN INPUT ERPNDM
   484
   485     IF ERPNDM-FILE-STATUS = '00'
   486         CONTINUE
   487     ELSE
   488         DISPLAY '*** ERROR OPENING ERPNDM FILE ***'
   489         DISPLAY '*** STATUS CODE IS ' ERPNDM-FILE-STATUS
   490         PERFORM 9999-ABEND-RTN
   491     END-IF
   492
   493     .
   494 0100-EXIT.
   495     EXIT.
   496
   497 0200-INITIALIZE.
   498
   499     MOVE SPACES                 TO WS-EOF-SW
   500     MOVE ZEROS                  TO WS-ERPNDM-RECS-IN
   501                                    WS-ERPNDM-RECS-FIX
   502                                    WS-ERPNDM-RECS-DEL
   503
   504     PERFORM 1100-START-ERPNDM   THRU 1100-EXIT
   505
   506     PERFORM 1200-READ-ERPNDM    THRU 1200-EXIT
   507
   508     .
   509 0200-EXIT.
   510     EXIT.
   511
   512 0500-PROCESS.
   513
   514     IF (PM-CITY-STATE NOT = SPACES)
   515        OR (PM-CRED-BENE-CTYST NOT = SPACES)
   516        PERFORM 1000-PROCESS     THRU 1000-EXIT
   517     END-IF
   518
   519     PERFORM 1200-READ-ERPNDM    THRU 1200-EXIT
   520
   521     .
   522 0500-EXIT.
   523     EXIT.
   524
   525 1000-PROCESS.
   526
   527     MOVE ' '                    TO WS-REWRITE-SW
   528     IF PM-CITY-STATE NOT = SPACES
   529        MOVE SPACES              TO WS-WORK-CITY-ST
   530        MOVE PM-CITY-STATE       TO WS-HOLD-CITY-STATE
   531
   532** CHECK FOR GUAM AND CHANGE TO GU **
   533        PERFORM VARYING S1 FROM +27 BY -1 UNTIL
   534           (S1 = +1)
   535           OR (PM-CITY-STATE (S1:4) = 'GUAM')
   536        END-PERFORM
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  11
* PEMPMF1.cbl
   537        IF PM-CITY-STATE (S1:4) = 'GUAM'
   538           MOVE 'GU  '              TO PM-CITY-STATE (S1:4)
   539           DISPLAY ' FIXED GUAM ' WS-HOLD-CITY-STATE ' '
   540              PM-CITY-STATE
   541           MOVE PM-CITY-STATE       TO WS-HOLD-CITY-STATE
   542        END-IF
   543
   544        PERFORM VARYING S1 FROM +30 BY -1 UNTIL
   545           (PM-CITY-STATE (S1:1) NOT = SPACE AND '.')
   546           OR (S1 = +1)
   547        END-PERFORM
   548        IF S1 > 3
   549           SUBTRACT +1 FROM S1
   550           MOVE PM-CITY-STATE (S1:2)
   551                                    TO WS-WORK-STATE
   552           SUBTRACT +1 FROM S1
   553           PERFORM VARYING S1 FROM S1 BY -1 UNTIL
   554              PM-CITY-STATE (S1:1) NOT = SPACE
   555           END-PERFORM
   556           IF S1 > 2
   557              IF PM-CITY-STATE (S1:1) = ',' OR ';' OR '.'
   558                 MOVE PM-CITY-STATE (1:S1 - 1) TO WS-WORK-CITY
   559              ELSE
   560                 MOVE PM-CITY-STATE (1:S1) TO WS-WORK-CITY
   561              END-IF
   562           END-IF
   563           MOVE SPACE               TO WS-STATE-SW
   564           PERFORM 1500-EDIT-STATE  THRU 1500-EXIT
   565           IF VALID-STATE
   566              MOVE WS-WORK-CITY  TO PM-CITY
   567              MOVE WS-WORK-STATE TO PM-STATE
   568              DISPLAY ' PM OLD ' WS-HOLD-CITY-STATE
   569                 ' NEW ' PM-CITY-STATE
   570              SET REWRITE-PM TO TRUE
   571           ELSE
   572              DISPLAY 'INVALID STATE CODE: ' WS-WORK-STATE
   573                 ' ' WS-HOLD-CITY-STATE ' ' PM-ENTRY-BATCH ' '
   574                 PM-BATCH-SEQ-NO
   575           END-IF
   576        ELSE
   577           DISPLAY ' WEIRD CITY STATE ' PM-ENTRY-BATCH
   578              ' ' PM-BATCH-SEQ-NO
   579              ' ' PM-CITY-STATE
   580        END-IF
   581     END-IF
   582
   583
   584     IF PM-CRED-BENE-CTYST NOT = SPACES
   585        MOVE SPACES              TO WS-WORK-CITY-ST
   586        MOVE PM-CRED-BENE-CTYST  TO WS-HOLD-CITY-STATE
   587
   588** CHECK FOR GUAM AND CHANGE TO GU **
   589        PERFORM VARYING S1 FROM +27 BY -1 UNTIL
   590           (S1 = +1)
   591           OR (PM-CRED-BENE-CTYST (S1:4) = 'GUAM')
   592        END-PERFORM
   593        IF PM-CRED-BENE-CTYST (S1:4) = 'GUAM'
   594           MOVE 'GU  '           TO PM-CRED-BENE-CTYST (S1:4)
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  12
* PEMPMF1.cbl
   595           DISPLAY ' FIXED GUAM ' WS-HOLD-CITY-STATE ' '
   596              PM-CRED-BENE-CTYST
   597           MOVE PM-CRED-BENE-CTYST  TO WS-HOLD-CITY-STATE
   598        END-IF
   599
   600        PERFORM VARYING S1 FROM +30 BY -1 UNTIL
   601           (PM-CRED-BENE-CTYST (S1:1) NOT = SPACE AND '.')
   602           OR (S1 = +1)
   603        END-PERFORM
   604        IF S1 > 3
   605           SUBTRACT +1 FROM S1
   606           MOVE PM-CRED-BENE-CTYST (S1:2)
   607                                    TO WS-WORK-STATE
   608           SUBTRACT +1 FROM S1
   609           PERFORM VARYING S1 FROM S1 BY -1 UNTIL
   610              PM-CRED-BENE-CTYST (S1:1) NOT = SPACE
   611           END-PERFORM
   612           IF S1 > 2
   613              IF PM-CRED-BENE-CTYST (S1:1) = ',' OR ';' OR '.'
   614                 MOVE PM-CRED-BENE-CTYST (1:S1 - 1)
   615                                 TO WS-WORK-CITY
   616              ELSE
   617                 MOVE PM-CRED-BENE-CTYST (1:S1)
   618                                 TO WS-WORK-CITY
   619              END-IF
   620           END-IF
   621           MOVE SPACE               TO WS-STATE-SW
   622           PERFORM 1500-EDIT-STATE  THRU 1500-EXIT
   623           IF VALID-STATE
   624              MOVE WS-WORK-CITY  TO PM-CRED-BENE-CITY
   625              MOVE WS-WORK-STATE TO PM-CRED-BENE-STATE
   626              DISPLAY ' CB OLD ' WS-HOLD-CITY-STATE
   627                 ' NEW ' PM-CRED-BENE-CTYST
   628              SET REWRITE-PM TO TRUE
   629           ELSE
   630              DISPLAY 'INVALID STATE CODE: ' WS-WORK-STATE
   631                 ' ' WS-HOLD-CITY-STATE ' ' PM-ENTRY-BATCH ' '
   632                 PM-BATCH-SEQ-NO
   633           END-IF
   634        ELSE
   635           DISPLAY ' WEIRD CITY STATE ' PM-ENTRY-BATCH
   636              ' ' PM-BATCH-SEQ-NO
   637              ' ' PM-CRED-BENE-CTYST
   638        END-IF
   639     END-IF
   640
   641     IF REWRITE-PM
   642        PERFORM 2100-REWRITE-ERPNDM
   643                                    THRU 2100-EXIT
   644     END-IF
   645
   646     .
   647 1000-EXIT.
   648     EXIT.
   649
   650 1100-START-ERPNDM.
   651
   652     MOVE LOW-VALUES             TO PM-CONTROL-PRIMARY
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  13
* PEMPMF1.cbl
   653     MOVE X'04'                  TO PM-COMPANY-CD
   654
   655     START ERPNDM KEY IS NOT <
   656                      PM-CONTROL-PRIMARY
   657     IF ERPNDM-FILE-STATUS NOT = '00'
   658        DISPLAY ' ERPNDM, BAD START '
   659              ERPNDM-FILE-STATUS
   660        PERFORM 9999-ABEND-RTN
   661     END-IF
   662
   663     .
   664
   665 1100-EXIT.
   666     EXIT.
   667
   668 1200-READ-ERPNDM.
   669
   670     READ ERPNDM NEXT RECORD
   671
   672     IF ERPNDM-FILE-STATUS = '10' OR '23'
   673        SET END-OF-ERPNDM TO TRUE
   674     ELSE
   675        IF ERPNDM-FILE-STATUS NOT = '00'
   676           DISPLAY 'ERPNDM, BAD READ NEXT '
   677                ERPNDM-FILE-STATUS
   678           PERFORM 9999-ABEND-RTN
   679        ELSE
   680           ADD 1              TO WS-ERPNDM-RECS-IN
   681        END-IF
   682     END-IF
   683
   684     .
   685 1200-EXIT.
   686     EXIT.
   687
   688 1500-EDIT-STATE.
   689
   690     SEARCH ALL STATE-TABLE AT END
   691        ADD 1 TO WS-INVALID-ST-CNT
   692        WHEN ST-STATE (ST-INDEX) = WS-WORK-STATE
   693           SET VALID-STATE TO TRUE
   694     END-SEARCH
   695
   696     .
   697 1500-EXIT.
   698     EXIT.
   699
   700 2100-REWRITE-ERPNDM.
   701
   702     REWRITE PENDING-MAILING-DATA
   703*    MOVE '00' TO ERPNDM-FILE-STATUS
   704
   705     IF ERPNDM-FILE-STATUS = '00'
   706         ADD 1                   TO WS-ERPNDM-RECS-FIX
   707     ELSE
   708         DISPLAY 'ERPNDM, BAD REWRITE '
   709         DISPLAY '*** STATUS CODE IS ' ERPNDM-FILE-STATUS
   710         PERFORM 9999-ABEND-RTN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  14
* PEMPMF1.cbl
   711     END-IF
   712     .
   713 2100-EXIT.
   714     EXIT.
   715
   716 2200-DELETE-ERPNDM.
   717
   718     DELETE  ERPNDM
   719
   720     IF ERPNDM-FILE-STATUS = '00'
   721         ADD 1                   TO WS-ERPNDM-RECS-DEL
   722     ELSE
   723         DISPLAY 'ERPNDM, BAD DELETE  '
   724         DISPLAY '*** STATUS CODE IS ' ERPNDM-FILE-STATUS
   725         PERFORM 9999-ABEND-RTN
   726     END-IF
   727     .
   728 2200-EXIT.
   729     EXIT.
   730
   731
   732 3000-CLOSE-FILES.
   733
   734     CLOSE ERPNDM
   735
   736     .
   737 3000-EXIT.
   738     EXIT.
   739
   740 4000-FINAL-TOTALS.
   741
   742     DISPLAY '**************************************************'
   743     DISPLAY '***                                            ***'
   744
   745     MOVE WS-ERPNDM-RECS-IN      TO WS-DISPLAY-CNT
   746     DISPLAY '***  ERPNDM RECORDS   IN         = ' WS-DISPLAY-CNT
   747
   748     MOVE WS-ERPNDM-RECS-FIX     TO WS-DISPLAY-CNT
   749     DISPLAY '***  ERPNDM RECORDS   FIXED      = ' WS-DISPLAY-CNT
   750
   751     MOVE WS-INVALID-ST-CNT      TO WS-DISPLAY-CNT
   752     DISPLAY '***  INVALID STATES              = ' WS-DISPLAY-CNT
   753
   754     MOVE WS-ERPNDM-RECS-DEL     TO WS-DISPLAY-CNT
   755     DISPLAY '***  ERPNDM RECORDS   DELETED    = ' WS-DISPLAY-CNT
   756
   757     DISPLAY '***                                            ***'
   758     DISPLAY '**************************************************'
   759
   760     .
   761 4000-EXIT.
   762     EXIT.
   763
   764 8510-DATE-CONVERSION.
   765
   766     CALL 'ELDATCX' USING DATE-CONVERSION-DATA
   767
   768     .
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  15
* PEMPMF1.cbl
   769 8590-EXIT.
   770     EXIT.
   771
   772 9999-ABEND-RTN.
   773
   774     DISPLAY '*** ERPNDM  FILE CONVERSION PROGRAM ABENDING ***'
   775     DISPLAY '************************************************'
   776
   777     MOVE 1                      TO WS-ABEND-FLD
   778     MOVE 0                      TO WS-ZERO-FLD
   779
   780     COMPUTE WS-ABEND-FLD = WS-ABEND-FLD / WS-ZERO-FLD
   781     .
   782 9999-EXIT.
   783     EXIT.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:        3676     Code:        2723
