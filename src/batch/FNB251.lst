* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   1
* FNB251.cbl
* Options: int("FNB251.int") anim csi verbose NOBOUND PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("FNB251.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"ebmlsfile" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" NOCHECKDIV NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"32" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"FNB251.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"FNB251.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR NOSTICKY-LINKAGE
*          NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"2" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2 PROGRAM-ID.    FNB251.
     3 AUTHOR.        DOUG NELSON.
     4 DATE-WRITTEN.  FEBRUARY 24, 2003.
     5
     6*****************************************************************
     7*                         H I S T O R Y                         *
     8*****************************************************************
     9* NAME    DATE    DESCRIPTION                                   *
    10* ---- ---------- ----------------------------------------------*
    11* DJNA 02/24/2003 REFORMAT GLS FILE                             *
    12* AJR  08/25/2006 REMOVE FROM CLAIMS SYSTEM                     *
    13*****************************************************************
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   2
* FNB251.cbl
    14
    15 ENVIRONMENT DIVISION.
    16 INPUT-OUTPUT SECTION.
    17 FILE-CONTROL.
    18
    19     SELECT INFILE
    20         ASSIGN TO EXTERNAL SYS010
    21         FILE STATUS IS SYS010-STATUS
    22         ORGANIZATION IS LINE SEQUENTIAL.
    23
    24     SELECT OUTFILE
    25         ASSIGN TO EXTERNAL SYS011
    26         FILE STATUS IS SYS011-STATUS
    27         ORGANIZATION IS LINE SEQUENTIAL.
    28
    29 DATA DIVISION.
    30 FILE SECTION.
    31
    32 FD  INFILE
    33     LABEL RECORDS ARE STANDARD
    34     RECORDING MODE IS F
    35     RECORD CONTAINS 135 CHARACTERS
    36     BLOCK CONTAINS 0 RECORDS.
    37 01  IN-RECORD         PIC X(135).
    38
    39 FD  OUTFILE
    40     LABEL RECORDS ARE STANDARD
    41     RECORDING MODE IS F
    42     RECORD CONTAINS 120 CHARACTERS
    43     BLOCK CONTAINS 0 RECORDS.
    44 01  OUT-RECORD        PIC X(120).
    45
    46 WORKING-STORAGE SECTION.
    47
    48 01 RC                       PIC S9(9)   COMP-5 VALUE 0.
    49 01 LIST-REC                 PIC X(132).
    50
    51 01  FILLER.
    52     05  SYS010-STATUS       PIC XX     VALUE '00'.
    53         88  EOF-SYS010                 VALUE '10'.
    54     05  SYS011-STATUS       PIC XX     VALUE '00'.
    55         88  EOF-SYS011                 VALUE '10'.
    56
    57 01  FILLER.
    58     05  OUTPUT-COUNT       PIC S9(8)      VALUE ZERO.
    59     05  INPUT-COUNT        PIC S9(8)      VALUE ZERO.
    60
    61 PROCEDURE DIVISION.
    62
    63     CALL 'FNBLIST' USING 'O' LIST-REC
    64     OPEN INPUT INFILE
    65     IF SYS010-STATUS NOT = '00'
    66       DISPLAY '*** OPEN ERROR ' SYS010-STATUS ' ON SYS010'
    67               UPON SYSERR
    68       MOVE SPACES TO LIST-REC
    69       STRING  '*** OPEN ERROR ' SYS010-STATUS ' ON SYS010'
    70         DELIMITED BY SIZE INTO LIST-REC
    71       CALL 'FNBLIST' USING 'W' LIST-REC
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   3
* FNB251.cbl
    72       CALL 'FNBLIST' USING 'C' LIST-REC
    73       MOVE 16 TO RC
    74*      GOBACK GIVING RC
    75       STOP RUN GIVING RC
    76     END-IF
    77
    78     OPEN OUTPUT OUTFILE
    79
    80     PERFORM UNTIL EOF-SYS010
    81       READ INFILE
    82         AT END EXIT PERFORM
    83       END-READ
    84       ADD +1 TO INPUT-COUNT
    85       MOVE IN-RECORD(01:55) TO OUT-RECORD(01:55)
    86       MOVE IN-RECORD(71:65) TO OUT-RECORD(56:65)
    87       WRITE OUT-RECORD
    88       ADD +1 TO OUTPUT-COUNT
    89     END-PERFORM
    90
    91     CLOSE INFILE OUTFILE
    92
    93     DISPLAY '    INPUT RECORDS READ: ' INPUT-COUNT  UPON SYSERR
    94     DISPLAY 'OUTPUT RECORDS WRITTEN: ' OUTPUT-COUNT UPON SYSERR
    95
    96     MOVE SPACES TO LIST-REC
    97     STRING  '    INPUT RECORDS READ: ' INPUT-COUNT
    98       DELIMITED BY SIZE INTO LIST-REC
    99     CALL 'FNBLIST' USING 'W' LIST-REC
   100     MOVE SPACES TO LIST-REC
   101     STRING  'OUTPUT RECORDS WRITTEN: ' OUTPUT-COUNT
   102       DELIMITED BY SIZE INTO LIST-REC
   103     CALL 'FNBLIST' USING 'W' LIST-REC
   104     CALL 'FNBLIST' USING 'C' LIST-REC
   105
   106*    GOBACK GIVING RC.
   107     STOP RUN GIVING RC.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:        1820     Code:         820
