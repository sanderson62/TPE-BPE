* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   1
* ECS010Z.cbl
* Options: int("ECS010Z.int") anim csi verbose NOBOUND PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("ECS010Z.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"ebmlsfile" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" NOCHECKDIV NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"32" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"ECS010Z.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"ECS010Z.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR NOSTICKY-LINKAGE
*          NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"2" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                 ECS010.
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 04/27/94 07:51:58.
     7*              PROGRAM REVIEWED FOR YEAR 2000 COMPLIANCE
     8*                            VMOD=2.082.
     9
    10*AUTHOR.        LOGIC, INC.
    11*               DALLAS, TEXAS.
    12
    13*DATE-COMPILED.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   2
* ECS010Z.cbl
    14
    15*SECURITY.   *****************************************************
    16*            *                                                   *
    17*            *   THIS PROGRAM IS THE PROPERTY OF LOGIC, INC.     *
    18*            *                                                   *
    19*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
    20*            *   OF LOGIC, INC. IS EXPRESSLY PROHIBITED WITHOUT  *
    21*            *   THE PRIOR WRITTEN PERMISSION OF LOGIC INC.      *
    22*            *                                                   *
    23*            *****************************************************
    24
    25*REMARKS.
    26*        THIS PROGRAM ACCEPTS VALIDATED TRANSACTIONS FROM EL522
    27*        AND APPLIES THEM TO THE CERTIFICATE MASTER FILE.
    28*        EXTRACTS ARE PRODUCED FOR PRODUCTION  EARNED PREMIUM &
    29*        LOSS, REINSURANCE, COMMISSIONS, CLAIMS REGISTER, ETC.
    30******************************************************************
    31*                   C H A N G E   L O G
    32*
    33* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    34*-----------------------------------------------------------------
    35*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    36* EFFECTIVE    NUMBER
    37*-----------------------------------------------------------------
    38* 061802                   PEMA  ADD PROCESS FOR PEOPLES
    39* 062602    2002061900011  SMVA  CHANGE SYS009 SYSOUT TO FILE WITH
    40*                              ORGANIZATION AS LINE SEQUENTIAL
    41* 070102                   SMVA  CLEAN UP COMPILE ERRORS
    42* 080702    2002061800008  PEMA  ADD PROCESS FOR SUNFLOWER
    43* 092602    2002091900008  PEMA  INCREASE NUMBER OF MAXIMUM
    44*                                  BENEFIT CODES FROM 450 TO 900
    45* 111402    2001061800003  PEMA  ADD DCC PROCESSING
    46* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
    47* 052703                   PEMA  MODIFY CEDE BALLOON PREM TO NSP
    48******************************************************************
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   3
* ECS010Z.cbl
    50 ENVIRONMENT DIVISION.
    51 CONFIGURATION SECTION.
    52 SPECIAL-NAMES.
    53     C02 IS LCP-CH2
    54     C03 IS LCP-CH3
    55     C04 IS LCP-CH4
    56     C05 IS LCP-CH5
    57     C06 IS LCP-CH6
    58     C07 IS LCP-CH7
    59     C08 IS LCP-CH8
    60     C09 IS LCP-CH9
    61     C10 IS LCP-CH10
    62     C11 IS LCP-CH11
    63     C12 IS LCP-CH12
    64     S01 IS LCP-P01
    65     S02 IS LCP-P02.
    66
    67 INPUT-OUTPUT SECTION.
    68 FILE-CONTROL.
    69
    70     SELECT PENDING-EXTRACT  ASSIGN TO SYS005.
    71
    72     SELECT CERT-MASTER-IN   ASSIGN TO SYS010.
    73
    74     SELECT ERACCTT-IN       ASSIGN TO ERACCTT
    75                             ACCESS IS SEQUENTIAL
    76                             ORGANIZATION IS INDEXED
    77                             FILE STATUS IS ERACCTT-FILE-STATUS
    78                             RECORD KEY IS AM-CONTROL-PRIMARY.
    79
    80     SELECT ERRTBL-IN        ASSIGN TO ERRTBLT
    81                             ACCESS IS DYNAMIC
    82                             ORGANIZATION IS INDEXED
    83                             FILE STATUS IS ERRTBL-FILE-STATUS
    84                             RECORD KEY IS RE-CONTROL-PRIMARY.
    85
    86     SELECT ERCTBL           ASSIGN TO ERCTBLT
    87                             ACCESS IS DYNAMIC
    88                             ORGANIZATION IS INDEXED
    89                             FILE STATUS IS ERCTBL-FILE-STATUS
    90                             RECORD KEY IS CT-CONTROL-PRIMARY.
    91
    92     SELECT ERMEBL-INOUT     ASSIGN TO ERMEBL
    93                             ORGANIZATION INDEXED
    94                             ACCESS DYNAMIC
    95                             RECORD KEY ME-CONTROL-PRIMARY
    96                             FILE STATUS ERMEBL-FILE-STATUS.
    97
    98     SELECT ERRESC-IN        ASSIGN TO ERRESC
    99                             ORGANIZATION IS INDEXED
   100                             ACCESS IS DYNAMIC
   101                             RECORD KEY IS ERRESC-RECORD-KEY
   102                             FILE STATUS IS ERRESC-FILE-STATUS.
   103
   104     SELECT CERT-MASTER-OUT  ASSIGN TO SYS011.
   105
   106     SELECT DETAIL-EXTR      ASSIGN TO SYS017.
   107
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   4
* ECS010Z.cbl
   108     SELECT SUMMARY-EXTR     ASSIGN TO SYS018.
   109
   110     SELECT DISPLAY-PRT      ASSIGN TO SYS022.
   111
   112     SELECT DISK-DATE        ASSIGN TO SYS019.
   113
   114     SELECT PRINT-COPY       ASSIGN TO SYS008.
   115
   116     SELECT MISMATCH-REPORT  ASSIGN TO SYS009.
   117
   118     SELECT FICH             ASSIGN TO SYS020.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   5
* ECS010Z.cbl
   120 DATA DIVISION.
   121 FILE SECTION.
   122
   123 FD  PENDING-EXTRACT
   124     BLOCK CONTAINS 0 RECORDS
   125     RECORDING MODE F.
   126
*  127                             COPY ERCEXTD.
   128******************************************************************04/29/98
   129*                                                                *ERCEXTD
   130*                                                                *ERCEXTD
   131*                            ERCEXTD                             *   LV002
   132*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
   133*                            VMOD=2.002                          *   CL**2
   134*                                                                *ERCEXTD
   135*   FILE DESCRIPTION = ONLINE TO BATCH FILE INTERFACE AND REPORT *ERCEXTD
   136*                      EXTRACT FOR OFFLINE REPORTING.            *ERCEXTD
   137*                                                                *ERCEXTD
   138*     THIS FILE IS CREATED FROM ERCEXTR EXTRACT INTERFACE        *ERCEXTD
   139*  FOR THE FOLLOWING RECORD TYPES. THE MAIN BODY OF EACH RECORD  *ERCEXTD
   140*  CONTAINS A STRAIGHT COPY OF THE EX-DATA-AREA IN EXCEXTR.      *ERCEXTD
   141*                                                                *ERCEXTD
   142*         RECORD                                                 *ERCEXTD
   143*          TYPE          PROGRAM USING                           *ERCEXTD
   144*        --------        --------------------------------        *ERCEXTD
   145*           A             EL522  PENDING BUSINESS EXTRACT        *ERCEXTD
   146*           B             EL522  PENDING CLAIMS   EXTRACT        *ERCEXTD
   147*           C             EL522  CERT CHANGES     EXTRACT        *ERCEXTD
   148*                                                                *ERCEXTD
   149* -------------------------------------------------------------- *ERCEXTD
   150*                                                                *ERCEXTD
   151*   FILE TYPE = SEQUENTIAL                                       *ERCEXTD
   152*   RECORD SIZE = 588   RECFORM = FIX                            *ERCEXTD
   153*                                                                *ERCEXTD
   154*   FILENAME = EREXTD                                            *ERCEXTD
   155*                                                                *ERCEXTD
   156******************************************************************ERCEXTD
   157                                                                  ERCEXTD
   158 01  EXTRACT-DATA-RECORD.                                         ERCEXTD
   159     12  ED-RECORD-ID                        PIC XX.              ERCEXTD
   160         88  VALID-IN-ID                           VALUE 'ED'.    ERCEXTD
   161                                                                  ERCEXTD
   162     12  ED-RECORD-TYPE                      PIC X.               ERCEXTD
   163         88  ED-PENDING-BUSINESS                   VALUE 'A'.     ERCEXTD
   164         88  ED-PENDING-CLAIMS                     VALUE 'B'.     ERCEXTD
   165         88  ED-CERT-CHANGES                       VALUE 'C'.     ERCEXTD
   166                                                                  ERCEXTD
   167     12  ED-DATA-AREAS                       PIC X(585).          ERCEXTD
   168                                                                  ERCEXTD
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   6
* ECS010Z.cbl
   170 FD  CERT-MASTER-IN
*  171                             COPY ECSCRIFD.
   172******************************************************************07/10/97
   173*                                                                *ECSCRIFD
   174*                            ECSCRIFD                            *   LV001
   175*                            VMOD 2.005                          *ECSCRIFD
   176*                                                                *ECSCRIFD
   177*  NO CID MODS FOR COPYBOOK ECSCRIFD                             *ECSCRIFD
   178*                                                                *ECSCRIFD
   179******************************************************************ECSCRIFD
   180     BLOCK CONTAINS 0 RECORDS
   181     RECORDING MODE F.                                            ECSCRIFD
   182                                                                  ECSCRIFD
   183 01  CERT-IN-RECORD.                                              ECSCRIFD
   184                                                                  ECSCRIFD
   185     12  FILLER                            PIC XXX.               ECSCRIFD
   186     12  CIR-CONTROL                       PIC X(36).             ECSCRIFD
   187     12  FILLER                            PIC X(66).             ECSCRIFD
   188     12  CIR-JOINT-AGE                     PIC 99.                ECSCRIFD
   189     12  FILLER                            PIC X(20).             ECSCRIFD
   190     12  CIR-LFTYP                         PIC XX.                ECSCRIFD
   191     12  FILLER                            PIC X(14).             ECSCRIFD
   192     12  CIR-LFAMT                         PIC S9(9)V99   COMP-3. ECSCRIFD
   193     12  FILLER                            PIC X(39).             ECSCRIFD
   194     12  CIR-LFRFND-CALC                   PIC S9(7)V99   COMP-3. ECSCRIFD
   195     12  FILLER                            PIC X(45).             ECSCRIFD
   196     12  CIR-AHTYP                         PIC XX.                ECSCRIFD
   197     12  FILLER                            PIC X(35).             ECSCRIFD
   198     12  CIR-AHRFND-CALC                   PIC S9(7)V99   COMP-3. ECSCRIFD
   199     12  FILLER                            PIC X(41).             ECSCRIFD
   200     12  CIR-APR                           PIC S999V9(4)  COMP-3. ECSCRIFD
   201     12  FILLER                            PIC X(48).             ECSCRIFD
   202     12  CIR-REIN-TABLE                    PIC XXX.               ECSCRIFD
   203     12  FILLER                            PIC X(9).              ECSCRIFD
   204     12  CIR-SUM-CAN-CNT-YTD               PIC S999       COMP-3. ECSCRIFD
   205     12  FILLER                            PIC X(120).            ECSCRIFD
   206     12  CIR-DTHAMT-YTD                    PIC S9(9)V99   COMP-3. ECSCRIFD
   207     12  FILLER                            PIC X(73).             ECSCRIFD
   208     12  CIR-DISAMT-YTD                    PIC S9(9)V99   COMP-3. ECSCRIFD
   209     12  FILLER                            PIC X(464).            ECSCRIFD
   210                                                                  ECSCRIFD
   211******************************************************************ECSCRIFD
   212
   213 01  CI-RECORD.
   214     12  FILLER          PIC  X(03).
   215     12  CI-ACCOUNT-CONTROL.
   216         16  CI-CARRIER      PIC  X(01).
   217         16  CI-GROUPING     PIC  X(06).
   218         16  CI-STATE        PIC  X(02).
   219         16  CI-ACCOUNT      PIC  X(10).
   220     12  FILLER          PIC  X(06).
   221     12  CI-CERT-NO.
   222         16  CI-CERT     PIC X(10).
   223         16  CI-CERT-SFX PIC X.
   224     12  FILLER          PIC  X(1017).
   225
   226******************************************************
   227*   THIS FILE DEFINITION WAS ADDED TO ACCOMMODATE THE EXECUTION
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   7
* ECS010Z.cbl
   228*   OF A "MID MONTH" BILLING REPORT (EL562) FOR
   229*   COMMERCIAL FEDERAL BANK
   230******************************************************
   231 01  CF-RECORD.
   232     12  FILLER          PIC X(759).
   233     12  CF-THIRD-AGENT  PIC X(10).
   234     12  FILLER          PIC X(7).
   235     12  CF-FOURTH-AGENT PIC X(10).
   236     12  FILLER          PIC X(270).
   237
   238******************************************************
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   8
* ECS010Z.cbl
   240 FD  ERACCTT-IN.
   241
*  242                             COPY ERCACCT.
   243******************************************************************04/19/98
   244*                                                                *ERCACCT
   245*                                                                *ERCACCT
   246*                            ERCACCT                             *   LV031
   247*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL*31
   248*                            VMOD=2.031                          *ERCACCT
   249*                                                                *ERCACCT
   250*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *ERCACCT
   251*                                                                *ERCACCT
   252*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *ERCACCT
   253*   VSAM ACCOUNT MASTER FILES.                                   *ERCACCT
   254*                                                                *ERCACCT
   255*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *ERCACCT
   256*                                                                *ERCACCT
   257*   FILE TYPE = VSAM,KSDS                                        *ERCACCT
   258*   RECORD SIZE = 2000  RECFORM = FIX                            *ERCACCT
   259*                                                                *ERCACCT
   260*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *ERCACCT
   261*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *ERCACCT
   262*                                                                *ERCACCT
   263*   LOG = NO                                                     *ERCACCT
   264*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *ERCACCT
   265*                                                                *ERCACCT
   266*                                                                *ERCACCT
   267******************************************************************ERCACCT
   268*                   C H A N G E   L O G
   269*
   270* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   271*-----------------------------------------------------------------
   272*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   273* EFFECTIVE    NUMBER
   274*-----------------------------------------------------------------
   275* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
   276* 092705    2005050300006  PEMA  ADD SPP LEASES
   277* 022808    2007083100002  PEMA  ADD FREEZE STATUS
   278* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
   279* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
   280* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
   281* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
   282******************************************************************
   283                                                                  ERCACCT
   284 01  ACCOUNT-MASTER.                                              ERCACCT
   285     12  AM-RECORD-ID                      PIC XX.                ERCACCT
   286         88  VALID-AM-ID                      VALUE 'AM'.         ERCACCT
   287                                                                  ERCACCT
   288     12  AM-CONTROL-PRIMARY.                                      ERCACCT
   289         16  AM-COMPANY-CD                 PIC X.                 ERCACCT
   290         16  AM-MSTR-CNTRL.                                       ERCACCT
   291             20  AM-CONTROL-A.                                    ERCACCT
   292                 24  AM-CARRIER            PIC X.                 ERCACCT
   293                 24  AM-GROUPING.                                 ERCACCT
   294                     28 AM-GROUPING-PREFIX PIC XXX.               ERCACCT
   295                     28 AM-GROUPING-PRIME  PIC XXX.               ERCACCT
   296                 24  AM-STATE              PIC XX.                ERCACCT
   297                 24  AM-ACCOUNT.                                  ERCACCT
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   9
* ECS010Z.cbl (/apps/prod/cid1p/copy/ERCACCT)
   298                     28  AM-ACCOUNT-PREFIX PIC X(4).              ERCACCT
   299                     28  AM-ACCOUNT-PRIME  PIC X(6).              ERCACCT
   300             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A            ERCACCT
   301                                           PIC X(19).             ERCACCT
   302             20  AM-CNTRL-B.                                      ERCACCT
   303                 24  AM-EXPIRATION-DT      PIC XX.                ERCACCT
   304                 24  FILLER                PIC X(4).              ERCACCT
   305             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.                 ERCACCT
   306                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.     ERCACCT
   307                                                                  ERCACCT
   308     12  AM-CONTROL-BY-VAR-GRP.                                   ERCACCT
   309         16  AM-COMPANY-CD-A1              PIC X.                 ERCACCT
   310         16  AM-VG-CARRIER                 PIC X.                 ERCACCT
   311         16  AM-VG-GROUPING                PIC X(6).              ERCACCT
   312         16  AM-VG-STATE                   PIC XX.                ERCACCT
   313         16  AM-VG-ACCOUNT                 PIC X(10).             ERCACCT
   314         16  AM-VG-DATE.                                          ERCACCT
   315             20  AM-VG-EXPIRATION-DT       PIC XX.                ERCACCT
   316             20  FILLER                    PIC X(4).              ERCACCT
   317         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE                  ERCACCT
   318                                           PIC 9(11)      COMP-3. ERCACCT
   319     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
   320         16  FILLER                        PIC X(10).
   321         16  AM-VG-KEY3.
   322             20  AM-VG3-ACCOUNT            PIC X(10).
   323             20  AM-VG3-EXP-DT             PIC XX.
   324         16  FILLER                        PIC X(4).
   325     12  AM-MAINT-INFORMATION.                                    ERCACCT
   326         16  AM-LAST-MAINT-DT              PIC XX.                ERCACCT
   327         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3. ERCACCT
   328         16  AM-LAST-MAINT-USER            PIC X(4).              ERCACCT
   329         16  FILLER                        PIC XX.                ERCACCT
   330                                                                  ERCACCT
   331     12  AM-EFFECTIVE-DT                   PIC XX.                ERCACCT
   332     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3. ERCACCT
   333                                                                  ERCACCT
   334     12  AM-PREV-DATES  COMP-3.                                   ERCACCT
   335         16  AM-PREV-EXP-DT                PIC 9(11).             ERCACCT
   336         16  AM-PREV-EFF-DT                PIC 9(11).             ERCACCT
   337                                                                  ERCACCT
   338     12  AM-REPORT-CODE-1                  PIC X(10).             ERCACCT
   339     12  AM-REPORT-CODE-2                  PIC X(10).             ERCACCT
   340                                                                  ERCACCT
   341     12  AM-CITY-CODE                      PIC X(4).              ERCACCT
   342     12  AM-COUNTY-PARISH                  PIC X(6).              ERCACCT
   343                                                                  ERCACCT
   344     12  AM-NAME                           PIC X(30).             ERCACCT
   345     12  AM-PERSON                         PIC X(30).             ERCACCT
   346     12  AM-ADDRS                          PIC X(30).             ERCACCT
   347     12  AM-CITY.
   348         16  AM-ADDR-CITY                  PIC X(28).
   349         16  AM-ADDR-STATE                 PIC XX.
   350     12  AM-ZIP.                                                  ERCACCT
   351         16  AM-ZIP-PRIME.                                        ERCACCT
   352             20  AM-ZIP-PRI-1ST            PIC X.                 ERCACCT
   353                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'. ERCACCT
   354             20  FILLER                    PIC X(4).              ERCACCT
   355         16  AM-ZIP-PLUS4                  PIC X(4).              ERCACCT
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  10
* ECS010Z.cbl (/apps/prod/cid1p/copy/ERCACCT)
   356     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.              ERCACCT
   357         16  AM-CAN-POSTAL-1               PIC XXX.               ERCACCT
   358         16  AM-CAN-POSTAL-2               PIC XXX.               ERCACCT
   359         16  FILLER                        PIC XXX.               ERCACCT
   360     12  AM-TEL-NO.                                               ERCACCT
   361         16  AM-AREA-CODE                  PIC 999.               ERCACCT
   362         16  AM-TEL-PRE                    PIC 999.               ERCACCT
   363         16  AM-TEL-NBR                    PIC 9(4).              ERCACCT
   364     12  AM-TEL-LOC                        PIC X.                 ERCACCT
   365         88  AM-TEL-AT-HOME                   VALUE 'H'.          ERCACCT
   366         88  AM-TEL-AT-BUSINESS               VALUE 'B'.          ERCACCT
   367                                                                  ERCACCT
   368     12  AM-COMM-STRUCTURE.                                       ERCACCT
   369         16  AM-DEFN-1.                                           ERCACCT
   370             20  AM-AGT-COMMS       OCCURS 10 TIMES.              ERCACCT
   371                 24  AM-AGT.                                      ERCACCT
   372                     28  AM-AGT-PREFIX     PIC X(4).              ERCACCT
   373                     28  AM-AGT-PRIME      PIC X(6).              ERCACCT
   374                 24  AM-COM-TYP            PIC X.                 ERCACCT
   375                 24  AM-L-COM              PIC SV9(5)     COMP-3. ERCACCT
   376                 24  AM-J-COM              PIC SV9(5)     COMP-3. ERCACCT
   377                 24  AM-A-COM              PIC SV9(5)     COMP-3. ERCACCT
   378                 24  AM-RECALC-LV-INDIC    PIC X.                 ERCACCT
   379                 24  AM-RETRO-LV-INDIC     PIC X.                 ERCACCT
   380                 24  AM-GL-CODES           PIC X.                 ERCACCT
   381                 24  AM-COMM-CHARGEBACK    PIC 9(02).             ERCACCT
   382                 24  FILLER                PIC X(01).             ERCACCT
   383         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.                   ERCACCT
   384             20  AM-COM-TBLS        OCCURS 10 TIMES.              ERCACCT
   385                 24  FILLER                PIC X(11).             ERCACCT
   386                 24  AM-L-COMA             PIC XXX.               ERCACCT
   387                 24  AM-J-COMA             PIC XXX.               ERCACCT
   388                 24  AM-A-COMA             PIC XXX.               ERCACCT
   389                 24  FILLER                PIC X(6).              ERCACCT
   390                                                                  ERCACCT
   391     12  AM-COMM-CHANGE-STATUS             PIC X.                 ERCACCT
   392         88  AM-COMMISSIONS-CHANGED           VALUE '*'.          ERCACCT
   393                                                                  ERCACCT
   394     12  AM-CSR-CODE                       PIC X(4).              ERCACCT
   395                                                                  ERCACCT
   396     12  AM-BILLING-STATUS                 PIC X.                 ERCACCT
   397         88  AM-ACCOUNT-BILLED                VALUE 'B'.          ERCACCT
   398         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.          ERCACCT
   399     12  AM-AUTO-REFUND-SW                 PIC X.                 ERCACCT
   400         88  AUTO-REFUNDS-USED                VALUE 'Y'.          ERCACCT
   401         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.      ERCACCT
   402     12  AM-GPCD                           PIC 99.                ERCACCT
   403     12  AM-IG                             PIC X.                 ERCACCT
   404         88  AM-HAS-INDIVIDUAL                VALUE '1'.          ERCACCT
   405         88  AM-HAS-GROUP                     VALUE '2'.          ERCACCT
   406     12  AM-STATUS                         PIC X.                 ERCACCT
   407         88  AM-ACCOUNT-ACTIVE                VALUE '0'.          ERCACCT
   408         88  AM-ACCOUNT-INACTIVE              VALUE '1'.          ERCACCT
   409         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.          ERCACCT
   410         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
   411         88  AM-ACCOUNT-FROZEN                VALUE '4'.
   412         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
   413     12  AM-REMIT-TO                       PIC 99.                ERCACCT
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  11
* ECS010Z.cbl (/apps/prod/cid1p/copy/ERCACCT)
   414     12  AM-ID-NO                          PIC X(11).             ERCACCT
   415                                                                  ERCACCT
   416     12  AM-CAL-TABLE                      PIC XX.                ERCACCT
   417     12  AM-LF-DEVIATION                   PIC XXX.               ERCACCT
   418     12  AM-AH-DEVIATION                   PIC XXX.               ERCACCT
   419     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3. ERCACCT
   420     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3. ERCACCT
   421     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3. ERCACCT
   422     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3. ERCACCT
   423     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3. ERCACCT
   424     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3. ERCACCT
   425                                                                  ERCACCT
   426     12  AM-USER-FIELDS.                                          ERCACCT
   427         16  AM-FLD-1                      PIC XX.                ERCACCT
   428         16  AM-FLD-2                      PIC XX.                ERCACCT
   429         16  AM-FLD-3                      PIC XX.                ERCACCT
   430         16  AM-FLD-4                      PIC XX.                ERCACCT
   431         16  AM-FLD-5                      PIC XX.                ERCACCT
   432                                                                  ERCACCT
   433     12  AM-1ST-PROD-DATE.                                        ERCACCT
   434         16  AM-1ST-PROD-YR                PIC XX.                ERCACCT
   435         16  AM-1ST-PROD-MO                PIC XX.                ERCACCT
   436         16  AM-1ST-PROD-DA                PIC XX.                ERCACCT
   437     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.     ERCACCT
   438     12  AM-CERTS-PURGED-DATE.                                    ERCACCT
   439         16  AM-PUR-YR                     PIC XX.                ERCACCT
   440         16  AM-PUR-MO                     PIC XX.                ERCACCT
   441         16  AM-PUR-DA                     PIC XX.                ERCACCT
   442     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.     ERCACCT
   443     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.     ERCACCT
   444     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.     ERCACCT
   445     12  AM-INACTIVE-DATE.                                        ERCACCT
   446         16  AM-INA-MO                     PIC 99.                ERCACCT
   447         16  AM-INA-DA                     PIC 99.                ERCACCT
   448         16  AM-INA-YR                     PIC 99.                ERCACCT
   449     12  AM-AR-HI-CERT-DATE                PIC XX.                ERCACCT
   450                                                                  ERCACCT
   451     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3. ERCACCT
   452     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3. ERCACCT
   453                                                                  ERCACCT
   454     12  AM-OB-PAYMENT-MODE                PIC X.                 ERCACCT
   455         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.      ERCACCT
   456         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.          ERCACCT
   457         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.          ERCACCT
   458         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.          ERCACCT
   459                                                                  ERCACCT
   460     12  AM-AH-ONLY-INDICATOR              PIC X.                 ERCACCT
   461         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.      ERCACCT
   462         88  AM-NO-AH-ONLY                    VALUE 'N'.          ERCACCT
   463                                                                  ERCACCT
   464     12  AM-EDIT-LOAN-OFC                  PIC X(01).             ERCACCT
   465                                                                  ERCACCT
   466     12  AM-OVER-SHORT.                                           ERCACCT
   467         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3. ERCACCT
   468         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3. ERCACCT
   469                                                                  ERCACCT
   470     12  AM-DCC-PRODUCT-CODE               PIC XXX.
   471     12  AM-DCC-CLP-STATE                  PIC XX.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  12
* ECS010Z.cbl (/apps/prod/cid1p/copy/ERCACCT)
   472                                                                  ERCACCT
   473     12  AM-RECALC-COMM                    PIC X.                 ERCACCT
   474     12  AM-RECALC-REIN                    PIC X.                 ERCACCT
   475                                                                  ERCACCT
   476     12  AM-REI-TABLE                      PIC XXX.               ERCACCT
   477     12  AM-REI-ET-LF                      PIC X.                 ERCACCT
   478     12  AM-REI-ET-AH                      PIC X.                 ERCACCT
   479     12  AM-REI-PE-LF                      PIC X.                 ERCACCT
   480     12  AM-REI-PE-AH                      PIC X.                 ERCACCT
   481     12  AM-REI-PRT-ST                     PIC X.                 ERCACCT
   482     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3. ERCACCT
   483     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3. ERCACCT
   484     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3. ERCACCT
   485     12  AM-REI-GROUP-A                    PIC X(6).              ERCACCT
   486     12  AM-REI-MORT                       PIC X(4).              ERCACCT
   487     12  AM-REI-PRT-OW                     PIC X.                 ERCACCT
   488     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3. ERCACCT
   489     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3. ERCACCT
   490     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3. ERCACCT
   491     12  AM-REI-GROUP-B                    PIC X(6).              ERCACCT
   492                                                                  ERCACCT
   493     12  AM-TRUST-TYPE                     PIC X(2).              ERCACCT
   494                                                                  ERCACCT
   495     12  AM-EMPLOYER-STMT-USED             PIC X.                 ERCACCT
   496     12  AM-GROUPED-CHECKS-Y-N             PIC X.                 ERCACCT
   497                                                                  ERCACCT
   498     12  AM-STD-AH-TYPE                    PIC XX.                ERCACCT
   499     12  AM-EARN-METHODS.                                         ERCACCT
   500         16  AM-EARN-METHOD-R              PIC X.                 ERCACCT
   501             88 AM-REF-RL-R78                 VALUE 'R'.          ERCACCT
   502             88 AM-REF-RL-PR                  VALUE 'P'.          ERCACCT
   503             88 AM-REF-RL-MEAN                VALUE 'M'.          ERCACCT
   504             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.          ERCACCT
   505         16  AM-EARN-METHOD-L              PIC X.                 ERCACCT
   506             88 AM-REF-LL-R78                 VALUE 'R'.          ERCACCT
   507             88 AM-REF-LL-PR                  VALUE 'P'.          ERCACCT
   508             88 AM-REF-LL-MEAN                VALUE 'M'.          ERCACCT
   509             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.          ERCACCT
   510         16  AM-EARN-METHOD-A              PIC X.                 ERCACCT
   511             88 AM-REF-AH-R78                 VALUE 'R'.          ERCACCT
   512             88 AM-REF-AH-PR                  VALUE 'P'.          ERCACCT
   513             88 AM-REF-AH-MEAN                VALUE 'M'.          ERCACCT
   514             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.          ERCACCT
   515             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.          ERCACCT
   516             88 AM-REF-AH-NET                 VALUE 'N'.          ERCACCT
   517                                                                  ERCACCT
   518     12  AM-TOL-PREM                       PIC S999V99    COMP-3. ERCACCT
   519     12  AM-TOL-REF                        PIC S999V99    COMP-3. ERCACCT
   520     12  AM-TOL-CLM                        PIC S999V99    COMP-3. ERCACCT
   521                                                                  ERCACCT
   522     12  AM-RET-Y-N                        PIC X.                 ERCACCT
   523     12  AM-RET-P-E                        PIC X.                 ERCACCT
   524     12  AM-LF-RET                         PIC S9V9999    COMP-3. ERCACCT
   525     12  AM-AH-RET                         PIC S9V9999    COMP-3. ERCACCT
   526     12  AM-RET-GRP                        PIC X(6).              ERCACCT
   527     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.                    ERCACCT
   528         16  AM-POOL-PRIME                 PIC XXX.               ERCACCT
   529         16  AM-POOL-SUB                   PIC XXX.               ERCACCT
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  13
* ECS010Z.cbl (/apps/prod/cid1p/copy/ERCACCT)
   530     12  AM-RETRO-EARNINGS.                                       ERCACCT
   531         16  AM-RET-EARN-R                 PIC X.                 ERCACCT
   532         16  AM-RET-EARN-L                 PIC X.                 ERCACCT
   533         16  AM-RET-EARN-A                 PIC X.                 ERCACCT
   534     12  AM-RET-ST-TAX-USE                 PIC X.                 ERCACCT
   535         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.  ERCACCT
   536         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.      ERCACCT
   537     12  AM-RETRO-BEG-EARNINGS.                                   ERCACCT
   538         16  AM-RET-BEG-EARN-R             PIC X.                 ERCACCT
   539         16  AM-RET-BEG-EARN-L             PIC X.                 ERCACCT
   540         16  AM-RET-BEG-EARN-A             PIC X.                 ERCACCT
   541     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3. ERCACCT
   542     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3. ERCACCT
   543                                                                  ERCACCT
   544     12  AM-USER-SELECT-OPTIONS.                                  ERCACCT
   545         16  AM-USER-SELECT-1              PIC X(10).             ERCACCT
   546         16  AM-USER-SELECT-2              PIC X(10).             ERCACCT
   547         16  AM-USER-SELECT-3              PIC X(10).             ERCACCT
   548         16  AM-USER-SELECT-4              PIC X(10).             ERCACCT
   549         16  AM-USER-SELECT-5              PIC X(10).             ERCACCT
   550                                                                  ERCACCT
   551     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3. ERCACCT
   552                                                                  ERCACCT
   553     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3. ERCACCT
   554                                                                  ERCACCT
   555     12  AM-RPT045A-SWITCH                 PIC X.                 ERCACCT
   556         88  RPT045A-OFF                   VALUE 'N'.             ERCACCT
   557                                                                  ERCACCT
   558     12  AM-INSURANCE-LIMITS.                                     ERCACCT
   559         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3. ERCACCT
   560         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3. ERCACCT
   561                                                                  ERCACCT
   562     12  AM-PROFILE-CHANGE-SWITCH          PIC X.                 ERCACCT
   563         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.          ERCACCT
   564                                                                  ERCACCT
   565     12  AM-DISMBR-COVERAGE-SW             PIC X.                 ERCACCT
   566         88  AM-DISMBR-COVERAGE               VALUE 'Y'.          ERCACCT
   567         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.          ERCACCT
   568                                                                  ERCACCT
   569     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3. ERCACCT
   570                                                                  ERCACCT
   571     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3. ERCACCT
   572     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
   573     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
   574     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
   575     12  AM-DCC-UEF-STATE                  PIC XX.
   576     12  FILLER                            PIC XXX.
   577     12  AM-REPORT-CODE-3                  PIC X(10).
   578*    12  FILLER                            PIC X(22).             ERCACCT
   579                                                                  ERCACCT
   580     12  AM-RESERVE-DATE.                                         ERCACCT
   581         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.    ERCACCT
   582         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.    ERCACCT
   583         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.    ERCACCT
   584                                                                  ERCACCT
   585     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.                ERCACCT
   586     12  AM-NOTIFICATION-TYPES.                                   ERCACCT
   587         16  AM-NOTIF-OF-LETTERS           PIC X.                 ERCACCT
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  14
* ECS010Z.cbl (/apps/prod/cid1p/copy/ERCACCT)
   588         16  AM-NOTIF-OF-PAYMENTS          PIC X.                 ERCACCT
   589         16  AM-NOTIF-OF-REPORTS           PIC X.                 ERCACCT
   590         16  AM-NOTIF-OF-STATUS            PIC X.                 ERCACCT
   591                                                                  ERCACCT
   592     12  AM-BENEFIT-TABLE-USAGE            PIC X.                 ERCACCT
   593         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.          ERCACCT
   594         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.          ERCACCT
   595         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.          ERCACCT
   596         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.     ERCACCT
   597                                                                  ERCACCT
   598     12  AM-BENEFIT-CONTROLS.                                     ERCACCT
   599         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.            ERCACCT
   600             20  AM-BENEFIT-CODE           PIC XX.                ERCACCT
   601             20  AM-BENEFIT-TYPE           PIC X.                 ERCACCT
   602             20  AM-BENEFIT-REVISION       PIC XXX.               ERCACCT
   603             20  AM-BENEFIT-REM-TERM       PIC X.                 ERCACCT
   604             20  AM-BENEFIT-RETRO-Y-N      PIC X.                 ERCACCT
   605             20  FILLER                    PIC XX.                ERCACCT
   606         16  FILLER                        PIC X(80).             ERCACCT
   607                                                                  ERCACCT
   608     12  AM-TRANSFER-DATA.                                        ERCACCT
   609         16  AM-TRANSFERRED-FROM.                                 ERCACCT
   610             20  AM-TRNFROM-CARRIER        PIC X.                 ERCACCT
   611             20  AM-TRNFROM-GROUPING.                             ERCACCT
   612                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.               ERCACCT
   613                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.               ERCACCT
   614             20  AM-TRNFROM-STATE          PIC XX.                ERCACCT
   615             20  AM-TRNFROM-ACCOUNT.                              ERCACCT
   616                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).             ERCACCT
   617                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).              ERCACCT
   618             20  AM-TRNFROM-DTE            PIC XX.                ERCACCT
   619         16  AM-TRANSFERRED-TO.                                   ERCACCT
   620             20  AM-TRNTO-CARRIER          PIC X.                 ERCACCT
   621             20  AM-TRNTO-GROUPING.                               ERCACCT
   622                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.               ERCACCT
   623                 24  AM-TRNTO-GRP-PRIME    PIC XXX.               ERCACCT
   624             20  AM-TRNTO-STATE            PIC XX.                ERCACCT
   625             20  AM-TRNTO-ACCOUNT.                                ERCACCT
   626                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).              ERCACCT
   627                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).              ERCACCT
   628             20  AM-TRNTO-DTE              PIC XX.                ERCACCT
   629         16  FILLER                        PIC X(10).             ERCACCT
   630                                                                  ERCACCT
   631     12  AM-SAVED-REMIT-TO                 PIC 99.                ERCACCT
   632                                                                  ERCACCT
   633     12  AM-COMM-STRUCTURE-SAVED.                                 ERCACCT
   634         16  AM-DEFN-1-SAVED.                                     ERCACCT
   635             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.           ERCACCT
   636                 24  AM-AGT-SV             PIC X(10).             ERCACCT
   637                 24  AM-COM-TYP-SV         PIC X.                 ERCACCT
   638                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3. ERCACCT
   639                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3. ERCACCT
   640                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3. ERCACCT
   641                 24  AM-RECALC-LV-INDIC-SV PIC X.                 ERCACCT
   642                 24  FILLER                PIC X.                 ERCACCT
   643                 24  AM-GL-CODES-SV        PIC X.                 ERCACCT
   644                 24  AM-COM-CHARGEBACK-SV  PIC 99.                ERCACCT
   645                 24  FILLER                PIC X.                 ERCACCT
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  15
* ECS010Z.cbl (/apps/prod/cid1p/copy/ERCACCT)
   646         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.       ERCACCT
   647             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.            ERCACCT
   648                 24  FILLER                PIC X(11).             ERCACCT
   649                 24  AM-L-COMA-SV          PIC XXX.               ERCACCT
   650                 24  AM-J-COMA-SV          PIC XXX.               ERCACCT
   651                 24  AM-A-COMA-SV          PIC XXX.               ERCACCT
   652                 24  FILLER                PIC X(6).              ERCACCT
   653                                                                  ERCACCT
   654     12  AM-FLC-NET-PREMIUM-ALLOWANCE.                            ERCACCT
   655         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.                 ERCACCT
   656            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3. ERCACCT
   657            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3. ERCACCT
   658            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3. ERCACCT
   659                                                                  ERCACCT
   660     12  AM-ORIG-DEALER-NO                 PIC X(10).             ERCACCT
   661     12  FILLER                            PIC X(120).            ERCACCT
   662                                                                  ERCACCT
   663     12  AM-ACCOUNT-EXECUTIVE-DATA.                               ERCACCT
   664         16  AM-CONTROL-NAME               PIC X(30).             ERCACCT
   665         16  AM-EXECUTIVE-ONE.                                    ERCACCT
   666             20  AM-EXEC1-NAME             PIC X(15).             ERCACCT
   667             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)       ERCACCT
   668                                                          COMP-3. ERCACCT
   669             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)       ERCACCT
   670                                                          COMP-3. ERCACCT
   671         16  AM-EXECUTIVE-TWO.                                    ERCACCT
   672             20  AM-EXEC2-NAME             PIC X(15).             ERCACCT
   673             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)       ERCACCT
   674                                                          COMP-3. ERCACCT
   675             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)       ERCACCT
   676                                                          COMP-3. ERCACCT
   677                                                                  ERCACCT
   678     12  AM-RETRO-ADDITIONAL-DATA.                                ERCACCT
   679         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3. ERCACCT
   680         16  AM-RETRO-PREM-P-E             PIC X.                 ERCACCT
   681         16  AM-RETRO-CLMS-P-I             PIC X.                 ERCACCT
   682         16  AM-RETRO-RET-BRACKET-LF.                             ERCACCT
   683             20  AM-RETRO-RET-METHOD-LF    PIC X.                 ERCACCT
   684                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.      ERCACCT
   685                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.          ERCACCT
   686             20  AM-RETRO-RET-BASIS-LF     PIC X.                 ERCACCT
   687                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.      ERCACCT
   688                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.          ERCACCT
   689             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.           ERCACCT
   690                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3. ERCACCT
   691                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3. ERCACCT
   692         16  AM-RETRO-RET-BRACKET-AH.                             ERCACCT
   693             20  AM-RETRO-RET-METHOD-AH    PIC X.                 ERCACCT
   694                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.      ERCACCT
   695                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.          ERCACCT
   696                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.          ERCACCT
   697             20  AM-RETRO-RET-BASIS-AH     PIC X.                 ERCACCT
   698                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.      ERCACCT
   699                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.          ERCACCT
   700             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.           ERCACCT
   701                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3. ERCACCT
   702                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3. ERCACCT
   703                                                                  ERCACCT
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  16
* ECS010Z.cbl (/apps/prod/cid1p/copy/ERCACCT)
   704     12  AM-COMMENTS.                                             ERCACCT
   705         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.ERCACCT
   706                                                                  ERCACCT
   707     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.         ERCACCT
   708         16  AM-FLI-RETRO-SHARE-CODE       PIC X.                 ERCACCT
   709         16  AM-FLI-BILLING-CODE           PIC X.                 ERCACCT
   710         16  AM-FLI-ALT-STATE-CODE         PIC XX.                ERCACCT
   711         16  AM-FLI-UNITED-IDENT           PIC X.                 ERCACCT
   712         16  AM-FLI-INTEREST-LOST-DATA.                           ERCACCT
   713             20  AM-FLI-BANK-NO            PIC X(5).              ERCACCT
   714             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3. ERCACCT
   715             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3. ERCACCT
   716             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3. ERCACCT
   717         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.            ERCACCT
   718             20  AM-FLI-AGT                PIC X(9).              ERCACCT
   719             20  AM-FLI-AGT-COMM-ACC       PIC X.                 ERCACCT
   720             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3. ERCACCT
   721         16  FILLER                        PIC X(102).            ERCACCT
   722                                                                  ERCACCT
   723     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.         ERCACCT
   724         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.          ERCACCT
   725             20  AM-BENEFIT-DMD-CODE         PIC XX.              ERCACCT
   726             20  AM-BENEFIT-DMD-TYPE         PIC X.               ERCACCT
   727             20  AM-BENEFIT-DMD-REVISION     PIC XXX.             ERCACCT
   728             20  AM-BENEFIT-DMD-REM-TERM     PIC X.               ERCACCT
   729             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.               ERCACCT
   730         16  FILLER                          PIC X(10).           ERCACCT
   731******************************************************************ERCACCT
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  17
* ECS010Z.cbl
   733 FD  ERRTBL-IN.
   734
*  735                             COPY ERCREIN.
   736******************************************************************07/27/93
   737*                                                                *ERCREIN
   738*                            ERCREIN                             *   LV009
   739*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   740*                            VMOD=2.010                          *   CL**9
   741*                                                                *ERCREIN
   742*   ONLINE CREDIT SYSTEM                                         *ERCREIN
   743*                                                                *ERCREIN
   744*   FILE DESCRIPTION = REINSURANCE MASTER FILE                   *ERCREIN
   745*                                                                *ERCREIN
   746*   FILE TYPE = VSAM,KSDS                                        *ERCREIN
   747*   RECORD SIZE = 4000  RECFORM = FIXED                          *ERCREIN
   748*                                                                *ERCREIN
   749*   BASE CLUSTER NAME = ERREIN                   RKP=2,LEN=8     *ERCREIN
   750*       ALTERNATE PATH = NONE                                    *ERCREIN
   751*                                                                *ERCREIN
   752*   LOG = NO                                                     *ERCREIN
   753*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *ERCREIN
   754*                                                                *ERCREIN
   755******************************************************************ERCREIN
   756*                   C H A N G E   L O G
   757*
   758* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   759*-----------------------------------------------------------------
   760*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   761* EFFECTIVE    NUMBER
   762*-----------------------------------------------------------------
   763* 103101    2001100100006  SMVA  ADD STATE EXHIBIT REPORT OPTION F
   764* 032707    2007032100006  PEMA  ADD EXCISE TAX CAPABILITY
   765******************************************************************
   766 01  REINSURANCE-RECORD.                                          ERCREIN
   767     12  RE-RECORD-ID                      PIC XX.                ERCREIN
   768         88  VALID-RE-ID                      VALUE 'RE'.         ERCREIN
   769                                                                  ERCREIN
   770     12  RE-CONTROL-PRIMARY.                                      ERCREIN
   771         16  RE-COMPANY-CD                 PIC X.                 ERCREIN
   772         16  RE-KEY.                                              ERCREIN
   773             20  RE-CODE                   PIC X.                 ERCREIN
   774                 88  RE-TABLE-RECORD          VALUE 'A'.          ERCREIN
   775                 88  RE-COMPANY-RECORD        VALUE 'B'.          ERCREIN
   776             20  RE-TABLE                  PIC XXX.               ERCREIN
   777             20  FILLER                    PIC XXX.               ERCREIN
   778         16  RE-COMPANY-KEY REDEFINES RE-KEY.                     ERCREIN
   779             20  FILLER                    PIC X.                 ERCREIN
   780             20  RE-COMPANY.                                      ERCREIN
   781                 24  RE-COMP-PRIME         PIC XXX.               ERCREIN
   782                 24  RE-COMP-SUB           PIC XXX.               ERCREIN
   783                                                                  ERCREIN
   784     12  RE-MAINT-INFORMATION.                                    ERCREIN
   785         16  RE-LAST-MAINT-DT              PIC XX.                ERCREIN
   786         16  RE-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3. ERCREIN
   787         16  RE-LAST-MAINT-USER            PIC X(4).              ERCREIN
   788         16  FILLER                        PIC X(10).             ERCREIN
   789                                                                  ERCREIN
   790     12  RE-TABLE-DATA.                                           ERCREIN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  18
* ECS010Z.cbl (/apps/prod/cid1p/copy/ERCREIN)
   791         16  RE-100-COMP                   PIC 99.                ERCREIN
   792                                                                  ERCREIN
   793         16  RE-COMP-INFO    OCCURS 30 TIMES.                     ERCREIN
   794             20  RE-REI-COMP-NO.                                  ERCREIN
   795                 24  RE-REI-COMP           PIC XXX.               ERCREIN
   796                 24  RE-REI-COMP-SUB       PIC XXX.               ERCREIN
   797             20  RE-LF-QC                  PIC X.                 ERCREIN
   798             20  RE-AH-QC                  PIC X.                 ERCREIN
   799             20  RE-LO-DATE                PIC 9(11)     COMP-3.  ERCREIN
   800             20  RE-HI-DATE                PIC 9(11)     COMP-3.  ERCREIN
   801             20  RE-LFAGE-LO               PIC 99.                ERCREIN
   802             20  RE-LFAGE-HI               PIC 99.                ERCREIN
   803             20  RE-AHAGE-LO               PIC 99.                ERCREIN
   804             20  RE-AHAGE-HI               PIC 99.                ERCREIN
   805             20  RE-LFTRM-LO               PIC S999       COMP-3. ERCREIN
   806             20  RE-LFTRM-HI               PIC S999       COMP-3. ERCREIN
   807             20  RE-AHTRM-LO               PIC S999       COMP-3. ERCREIN
   808             20  RE-AHTRM-HI               PIC S999       COMP-3. ERCREIN
   809             20  RE-LF-PCT                 PIC S9V9999    COMP-3. ERCREIN
   810             20  RE-AH-PCT                 PIC S9V9999    COMP-3. ERCREIN
   811             20  RE-LF-LIM-LO              PIC S9(9)V99   COMP-3. ERCREIN
   812             20  RE-LF-LIM-HI              PIC S9(9)V99   COMP-3. ERCREIN
   813             20  RE-LF-LO                  PIC S9(9)V99   COMP-3. ERCREIN
   814             20  RE-LF-HI                  PIC S9(9)V99   COMP-3. ERCREIN
   815             20  RE-AHBEN-LIM-LO           PIC S9(7)V99   COMP-3. ERCREIN
   816             20  RE-AHBEN-LIM-HI           PIC S9(7)V99   COMP-3. ERCREIN
   817             20  RE-AHBEN-LO               PIC S9(7)V99   COMP-3. ERCREIN
   818             20  RE-AHBEN-HI               PIC S9(7)V99   COMP-3. ERCREIN
   819             20  RE-AHMOA-LIM-LO           PIC S9(7)V99   COMP-3. ERCREIN
   820             20  RE-AHMOA-LIM-HI           PIC S9(7)V99   COMP-3. ERCREIN
   821             20  RE-AHMOA-LO               PIC S9(7)V99   COMP-3. ERCREIN
   822             20  RE-AHMOA-HI               PIC S9(7)V99   COMP-3. ERCREIN
   823             20  RE-LF-BEN-CODE            PIC X.                 ERCREIN
   824             20  RE-AH-BEN-CODE            PIC X.                 ERCREIN
   825             20  RE-INTERACTIVE            PIC X.                 ERCREIN
   826             20  RE-REMAINING              PIC X.                 ERCREIN
   827             20  RE-LF-RUNOFF-SW           PIC X.                      000
   828             20  RE-AH-RUNOFF-SW           PIC X.                      000
   829             20  FILLER                    PIC X(19).                  000
   830                                                                  ERCREIN
   831         16  RE-COMP-INFO-END              PIC X(6).              ERCREIN
   832         16  RE-NSP-ST-CD-LF               PIC XX.                ERCREIN
   833         16  RE-NSP-ST-CD-AH               PIC XX.                ERCREIN
   834         16  RE-TABLE-CARRIER-SECURITY     PIC X.                 ERCREIN
   835             88  NO-TABLE-CARRIER-SECURITY    VALUE SPACE.        ERCREIN
   836                                                                  ERCREIN
   837         16  FILLER                        PIC X(27).             ERCREIN
   838                                                                  ERCREIN
   839     12  RE-COMPANY-DATA   REDEFINES   RE-TABLE-DATA.             ERCREIN
   840         16  RE-NAME                       PIC X(30).             ERCREIN
   841         16  RE-LF-PE                      PIC X.                 ERCREIN
   842         16  RE-AH-PE                      PIC X.                 ERCREIN
   843         16  RE-LF-FEE                     PIC S9V9999    COMP-3. ERCREIN
   844         16  RE-AH-FEE                     PIC S9V9999    COMP-3. ERCREIN
   845         16  RE-AH-PR-PCT                  PIC S9V9999    COMP-3. ERCREIN
   846         16  RE-AH-78-PCT                  PIC S9V9999    COMP-3. ERCREIN
   847         16  RE-PRT-ST                     PIC X.                 ERCREIN
   848         16  RE-PRT-OW                     PIC X.                 ERCREIN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  19
* ECS010Z.cbl (/apps/prod/cid1p/copy/ERCREIN)
   849         16  RE-MORT-CODE                  PIC X(4).              ERCREIN
   850         16  RE-CLAIM-CODE                 PIC X.                 ERCREIN
   851         16  RE-ZERO-LF-FEE                PIC X.                 ERCREIN
   852         16  RE-ZERO-AH-FEE                PIC X.                 ERCREIN
   853         16  RE-CEDE-NAME                  PIC X(30).             ERCREIN
   854         16  RE-LF-COMM                    PIC X.                 ERCREIN
   855         16  RE-AH-COMM                    PIC X.                 ERCREIN
   856         16  RE-LF-TAX                     PIC X.                 ERCREIN
   857         16  RE-AH-TAX                     PIC X.                 ERCREIN
   858         16  RE-CLM-INCURRED-LIM           PIC 9(11)  COMP-3.     ERCREIN
   859         16  RE-LF-IBNR-PCT                PIC SV999      COMP-3. ERCREIN
   860         16  RE-AH-IBNR-PCT                PIC SV999      COMP-3. ERCREIN
   861                                                                  ERCREIN
   862         16  RE-COMP-CARRIER-SECURITY      PIC X.                 ERCREIN
   863             88  NO-COMP-CARRIER-SECURITY     VALUE SPACE.        ERCREIN
   864                                                                  ERCREIN
   865         16  RE-LF-CEDING-FEE-BRACKETS.                           ERCREIN
   866             20  RE-LF-FEE-METHOD          PIC X.                 ERCREIN
   867                 88  RE-LF-FEE-BRACKETED         VALUE '1' '2'.   ERCREIN
   868                 88  RE-LF-FEE-METHOD-1          VALUE '1'.       ERCREIN
   869                 88  RE-LF-FEE-METHOD-2          VALUE '2'.       ERCREIN
   870                 88  RE-LF-FEE-PERCENT           VALUE ' ' 'P'.   ERCREIN
   871             20  RE-LF-FEE-BASIS           PIC X.                 ERCREIN
   872                 88  RE-LF-GROSS-CEDED             VALUE '1'.     ERCREIN
   873                 88  RE-LF-NET-CEDED               VALUE '2'.     ERCREIN
   874                 88  RE-LF-GROSS-WRITTEN           VALUE '3'.     ERCREIN
   875                 88  RE-LF-NET-WRITTEN             VALUE '4'.     ERCREIN
   876                 88  RE-LF-COMBINE-GROSS-CEDED     VALUE '5'.     ERCREIN
   877                 88  RE-LF-COMBINE-NET-CEDED       VALUE '6'.     ERCREIN
   878                 88  RE-LF-COMBINE-GROSS-WRITTEN   VALUE '7'.     ERCREIN
   879                 88  RE-LF-COMBINE-NET-WRITTEN     VALUE '8'.     ERCREIN
   880             20  FILLER                    PIC XXX.               ERCREIN
   881             20  RE-LF-FEE-RANGES  OCCURS 6 TIMES.                ERCREIN
   882                 24  RE-LF-FEE-RANGE-PCT   PIC S9V9999    COMP-3. ERCREIN
   883                 24  RE-LF-FEE-THRU-AMT    PIC S9(7)V99   COMP-3. ERCREIN
   884                                                                  ERCREIN
   885         16  RE-AH-CEDING-FEE-BRACKETS.                           ERCREIN
   886             20  RE-AH-FEE-METHOD          PIC X.                 ERCREIN
   887                 88  RE-AH-FEE-BRACKETED         VALUE '1' '2'.   ERCREIN
   888                 88  RE-AH-FEE-METHOD-1          VALUE '1'.       ERCREIN
   889                 88  RE-AH-FEE-METHOD-2          VALUE '2'.       ERCREIN
   890                 88  RE-AH-FEE-PERCENT           VALUE ' ' 'P'.   ERCREIN
   891             20  RE-AH-FEE-BASIS           PIC X.                 ERCREIN
   892                 88  RE-AH-GROSS-CEDED             VALUE '1'.     ERCREIN
   893                 88  RE-AH-NET-CEDED               VALUE '2'.     ERCREIN
   894                 88  RE-AH-GROSS-WRITTEN           VALUE '3'.     ERCREIN
   895                 88  RE-AH-NET-WRITTEN             VALUE '4'.     ERCREIN
   896                 88  RE-AH-COMBINE-GROSS-CEDED     VALUE '5'.     ERCREIN
   897                 88  RE-AH-COMBINE-NET-CEDED       VALUE '6'.     ERCREIN
   898                 88  RE-AH-COMBINE-GROSS-WRITTEN   VALUE '7'.     ERCREIN
   899                 88  RE-AH-COMBINE-NET-WRITTEN     VALUE '8'.     ERCREIN
   900             20  FILLER                    PIC XXX.               ERCREIN
   901             20  RE-AH-FEE-RANGES  OCCURS 6 TIMES.                ERCREIN
   902                 24  RE-AH-FEE-RANGE-PCT   PIC S9V9999    COMP-3. ERCREIN
   903                 24  RE-AH-FEE-THRU-AMT    PIC S9(7)V99   COMP-3. ERCREIN
   904                                                                  ERCREIN
   905         16  RE-EARNING-START-DT           PIC 9(11)  COMP-3.     ERCREIN
   906                                                                  ERCREIN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  20
* ECS010Z.cbl (/apps/prod/cid1p/copy/ERCREIN)
   907         16  RE-OLD-CEDING-STMT            PIC X.                    CL**4
   908                                                                  ERCREIN
   909         16  RE-LF-CLM-PCT                 PIC S9V9999    COMP-3. ERCREIN
   910         16  RE-AH-CLM-PCT                 PIC S9V9999    COMP-3. ERCREIN
   911         16  RE-LF-CLM-MAX                 PIC S9(7)V99   COMP-3. ERCREIN
   912         16  RE-AH-CLM-MAX                 PIC S9(7)V99   COMP-3. ERCREIN
   913         16  RE-LF-PR-PCT                  PIC S9V9999    COMP-3. ERCREIN
   914         16  RE-LF-78-PCT                  PIC S9V9999    COMP-3. ERCREIN
   915         16  RE-REINS-GROUPING-CODE        PIC X(6).              ERCREIN
   916         16  RE-MORT-SW                    PIC X.                 ERCREIN
   917         16  RE-CEDING-TYPE-FLAG           PIC X.                    CL**2
   918             88  RE-NO-CESSION-TYPE                VALUE ' '.        CL**2
   919             88  RE-CEDED                          VALUE 'C'.        CL**2
   920             88  RE-ASSUMED                        VALUE 'A'.        CL**2
   921             88  RE-PHANTOM                        VALUE 'P'.        CL**2
   922                                                                  ERCREIN
   923         16  RE-CEDING-STMT-OPT-A          PIC X.                    CL**3
   924             88  REPORT-A-WANTED    VALUE ' ' 'Y'.                   CL**3
   925         16  RE-CEDING-STMT-OPT-B          PIC X.                    CL**3
   926             88  REPORT-B-WANTED    VALUE ' ' 'Y'.                   CL**3
   927         16  RE-CEDING-STMT-OPT-C          PIC X.                    CL**3
   928             88  REPORT-C-WANTED    VALUE ' ' 'Y'.                   CL**3
   929         16  RE-CEDING-STMT-OPT-D          PIC X.                    CL**3
   930             88  REPORT-D-WANTED    VALUE ' ' 'Y'.                   CL**3
   931         16  RE-CEDING-STMT-OPT-E          PIC X.                    CL**3
   932             88  REPORT-E-WANTED    VALUE ' ' 'Y'.                   CL**3
   933                                                                     CL**3
   934         16  RE-PRT-CRSV                   PIC X.                    CL**5
   935                                                                     CL**5
   936         16  RE-GL-CENTER                  PIC X(4).                 CL**6
   937                                                                     CL**8
   938         16  RE-CUSTODIAL-BAL              PIC S9(7)V99   COMP-3.    CL**8
   939                                                                     CL**8
   940         16  RE-EARNING-STOP-DT            PIC 9(11)  COMP-3.        CL**9
   941                                                                     CL**9
   942         16  RE-EARN-STOP-CODE             PIC X.                    CL**9
   943             88  STOP-LIFE-EARNING  VALUE 'L' 'B'.                   CL**9
   944             88  STOP-AH-EARNING    VALUE 'A' 'B'.                   CL**9
   945
   946         16  RE-STATE-EXHIBIT-OPT-F        PIC X.
   947             88  RPTF-ECS152-WANTED VALUE ' ' 'Y'.
   948                                                                     CL**9
   949         16  RE-EXCISE-TAX                 PIC S9V9999 COMP-3.
   950         16  FILLER                        PIC X(2281).              CL**9
   951                                                                  ERCREIN
   952         16  RE-DESC OCCURS 18 TIMES       PIC X(79).             ERCREIN
   953                                                                  ERCREIN
   954******************************************************************ERCREIN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  21
* ECS010Z.cbl
   956 FD  ERCTBL.
   957
*  958                             COPY ERCCTBL.
   959******************************************************************04/29/98
   960*                                                                *ERCCTBL
   961*                                                                *ERCCTBL
   962*                            ERCCTBL                             *   LV002
   963*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
   964*                            VMOD=2.003                              CL**2
   965*                                                                *ERCCTBL
   966*   ONLINE CREDIT SYSTEM                                         *ERCCTBL
   967*                                                                *ERCCTBL
   968*   FILE DESCRIPTION = COMPENSATION TABLE                        *ERCCTBL
   969*                                                                *ERCCTBL
   970*   FILE TYPE = VSAM,KSDS                                        *ERCCTBL
   971*   RECORD SIZE = 200   RECFORM = FIXED                          *ERCCTBL
   972*                                                                *ERCCTBL
   973*   BASE CLUSTER NAME = ERCTBL                   RKP=2,LEN=7     *ERCCTBL
   974*       ALTERNATE PATH = NONE                                    *ERCCTBL
   975*                                                                *ERCCTBL
   976*   LOG = NO                                                     *ERCCTBL
   977*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *ERCCTBL
   978*                                                                *ERCCTBL
   979*                                                                *ERCCTBL
   980******************************************************************ERCCTBL
   981                                                                  ERCCTBL
   982 01  COMM-TABLE-RECORD.                                           ERCCTBL
   983     12  CT-RECORD-ID                      PIC XX.                ERCCTBL
   984         88  VALID-CT-ID                      VALUE 'CT'.         ERCCTBL
   985                                                                  ERCCTBL
   986     12  CT-CONTROL-PRIMARY.                                      ERCCTBL
   987         16  CT-COMPANY-CD                 PIC X.                 ERCCTBL
   988         16  CT-TABLE                      PIC XXX.               ERCCTBL
   989         16  CT-CNTRL-2.                                          ERCCTBL
   990             20  CT-BEN-TYPE               PIC X.                 ERCCTBL
   991             20  CT-BEN-CODE               PIC XX.                ERCCTBL
   992                                                                  ERCCTBL
   993     12  CT-MAINT-INFORMATION.                                    ERCCTBL
   994         16  CT-LAST-MAINT-DT              PIC XX.                ERCCTBL
   995         16  CT-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3. ERCCTBL
   996         16  CT-LAST-MAINT-USER            PIC X(4).              ERCCTBL
   997         16  FILLER                        PIC X(31).             ERCCTBL
   998                                                                  ERCCTBL
   999     12  CT-LIMITS.                                               ERCCTBL
  1000         16  CT-TBF OCCURS 3 TIMES         PIC S9(7)V99   COMP-3. ERCCTBL
  1001                                                                  ERCCTBL
  1002         16  CT-AGE OCCURS 3 TIMES         PIC S99        COMP-3. ERCCTBL
  1003                                                                  ERCCTBL
  1004         16  CT-TRM OCCURS 3 TIMES         PIC S999       COMP-3. ERCCTBL
  1005                                                                  ERCCTBL
  1006     12  CT-RATES.                                                ERCCTBL
  1007         16  CT-RTX          OCCURS 27 TIMES.                     ERCCTBL
  1008             20  CT-RT                     PIC SV9(5)     COMP-3. ERCCTBL
  1009             20  CT-RT-R   REDEFINES                              ERCCTBL
  1010                 CT-RT                     PIC XXX.               ERCCTBL
  1011                                                                  ERCCTBL
  1012     12  FILLER                            PIC  X(42).            ERCCTBL
  1013                                                                  ERCCTBL
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  22
* ECS010Z.cbl
  1014******************************************************************ERCCTBL
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  23
* ECS010Z.cbl
  1016 FD  ERMEBL-INOUT.
  1017
* 1018                             COPY ERCMEBL.
  1019******************************************************************
  1020*
  1021*
  1022*                            ERCMEBL                             *
  1023*                                                                *
  1024*    FILE DESCRIPTION = REPOSITORY FOR MONTH-END BALANCES FROM   *
  1025*                       SEVERAL PROGRAMS (IDENTIFIED IN BYTES    *
  1026*                       4-6 OF THE FIELD NAMES) AND BY EL541     *
  1027*                       FOR REPORTING DISCREPANCIES AND RUN TIME.*
  1028*                                                                *
  1029*    FILE TYPE = VSAM, KSDS                                      *
  1030*    RECORD SIZE = 765       RECFORM = FIXED                     *
  1031*                                                                *
  1032*    BASE CLUSTER = ERMEBL         KEY SIZE  =  5                *
  1033*    ALTERNATE PATHS = NONE        STARTING IN  3                *
  1034*                                                                *
  1035******************************************************************
  1036
  1037******************************************************************
  1038*                   C H A N G E   L O G
  1039*
  1040* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1041*-----------------------------------------------------------------
  1042*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1043* EFFECTIVE    NUMBER
  1044*-----------------------------------------------------------------
  1045* 070714  CR2013060600001  PEMA  AUTOMATE EOM BALANCING
  1046******************************************************************
  1047 01  MONTH-END-BALANCES.
  1048     12  ME-RECORD-ID            PIC  XX.
  1049     12  ME-CONTROL-PRIMARY.
  1050         16  ME-COMPANY          PIC  XXX.
  1051         16  ME-MOYR             PIC  9999       COMP.
  1052     12  ME-010-PREM-L           PIC S9(9)V99    COMP-3.
  1053     12  ME-010-PREM-AH          PIC S9(9)V99    COMP-3.
  1054     12  ME-010-REF-L            PIC S9(9)V99    COMP-3.
  1055     12  ME-010-REF-AH           PIC S9(9)V99    COMP-3.
  1056     12  ME-010-NET-L            PIC S9(9)V99    COMP-3.
  1057     12  ME-010-NET-AH           PIC S9(9)V99    COMP-3.
  1058     12  ME-010-COMM-L           PIC S9(9)V99    COMP-3.
  1059     12  ME-010-COMM-AH          PIC S9(9)V99    COMP-3.
  1060     12  ME-010-PMT-L            PIC S9(9)V99    COMP-3.
  1061     12  ME-010-PMT-AH           PIC S9(9)V99    COMP-3.
  1062     12  ME-010-CERT-IN          PIC S9(7)       COMP-3.
  1063     12  ME-010-CERT-OUT         PIC S9(7)       COMP-3.
  1064     12  ME-010-DUP-ISS          PIC S9(7)       COMP-3.
  1065     12  ME-010-RUN-DT           PIC  9(6)       COMP-3.
  1066*    12  ME-010-START            PIC  9(6)       COMP-3.
  1067*    12  ME-010-END              PIC  9(6)       COMP-3.
  1068     12  ME-010-RUN-CT           PIC S9(3)       COMP-3.
  1069     12  ME-018-COMM-Y           PIC S9(9)V99    COMP-3.
  1070     12  ME-018-COMM-1           PIC S9(9)V99    COMP-3.
  1071     12  ME-018-OW-Y             PIC S9(9)V99    COMP-3.
  1072     12  ME-018-OW-1             PIC S9(9)V99    COMP-3.
  1073     12  ME-018-RUN-DT           PIC  9(6)       COMP-3.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  24
* ECS010Z.cbl (/apps/prod/cid1p/copy/ERCMEBL)
  1074*    12  ME-018-START            PIC  9(6)       COMP-3.
  1075*    12  ME-018-END              PIC  9(6)       COMP-3.
  1076     12  ME-018-RUN-CT           PIC S9(3)       COMP-3.
  1077     12  ME-019-PREM-L           PIC S9(9)V99    COMP-3.
  1078     12  ME-019-PREM-AH          PIC S9(9)V99    COMP-3.
  1079     12  ME-019-REF-L            PIC S9(9)V99    COMP-3.
  1080     12  ME-019-REF-AH           PIC S9(9)V99    COMP-3.
  1081     12  ME-019-COMM-L           PIC S9(9)V99    COMP-3.
  1082     12  ME-019-COMM-AH          PIC S9(9)V99    COMP-3.
  1083     12  ME-019-OR-L             PIC S9(9)V99    COMP-3.
  1084     12  ME-019-OR-AH            PIC S9(9)V99    COMP-3.
  1085     12  ME-019-RUN-DT           PIC  9(6)       COMP-3.
  1086*    12  ME-019-START            PIC  9(6)       COMP-3.
  1087*    12  ME-019-END              PIC  9(6)       COMP-3.
  1088     12  ME-019-RUN-CT           PIC S9(3)       COMP-3.
  1089     12  ME-030-CLMS-L           PIC S9(9)V99    COMP-3.
  1090     12  ME-030-CLMS-AH          PIC S9(9)V99    COMP-3.
  1091     12  ME-030-RUN-DT           PIC  9(6)       COMP-3.
  1092*    12  ME-030-START            PIC  9(6)       COMP-3.
  1093*    12  ME-030-END              PIC  9(6)       COMP-3.
  1094     12  ME-030-RUN-CT           PIC S9(3)       COMP-3.
  1095     12  ME-032-RESV-L           PIC S9(9)V99    COMP-3.
  1096     12  ME-032-RESV-AH          PIC S9(9)V99    COMP-3.
  1097     12  ME-032-RUN-DT           PIC  9(6)       COMP-3.
  1098*    12  ME-032-START            PIC  9(6)       COMP-3.
  1099*    12  ME-032-END              PIC  9(6)       COMP-3.
  1100     12  ME-032-RUN-CT           PIC S9(3)       COMP-3.
  1101     12  ME-035-NET-L            PIC S9(9)V99    COMP-3.
  1102     12  ME-035-NET-AH           PIC S9(9)V99    COMP-3.
  1103     12  ME-035-RUN-DT           PIC S9(6)       COMP-3.
  1104*    12  ME-035-START            PIC S9(6)       COMP-3.
  1105*    12  ME-035-END              PIC S9(6)       COMP-3.
  1106     12  ME-035-RUN-CT           PIC S9(3)       COMP-3.
  1107     12  ME-038-RECS-IN          PIC S9(7)       COMP-3.
  1108     12  ME-038-RECS-OUT         PIC S9(7)       COMP-3.
  1109     12  ME-038-RUN-DT           PIC  9(6)       COMP-3.
  1110*    12  ME-038-START            PIC  9(6)       COMP-3.
  1111*    12  ME-038-END              PIC  9(6)       COMP-3.
  1112     12  ME-038-RUN-CT           PIC S9(3)       COMP-3.
  1113     12  ME-041-RETROS           PIC S9(9)V99    COMP-3.
  1114     12  ME-041-RUN-DT           PIC  9(6)       COMP-3.
  1115*    12  ME-041-START            PIC  9(6)       COMP-3.
  1116*    12  ME-041-END              PIC  9(6)       COMP-3.
  1117     12  ME-041-RUN-CT           PIC S9(3)       COMP-3.
  1118     12  ME-050-CERT-IN          PIC S9(7)       COMP-3.
  1119     12  ME-050-CERT-OUT         PIC S9(7)       COMP-3.
  1120*    12  ME-050-START            PIC  9(6)       COMP-3.
  1121     12  ME-050-RUN-DT           PIC  9(6)       COMP-3.
  1122*    12  ME-050-END              PIC  9(6)       COMP-3.
  1123     12  ME-050-RUN-CT           PIC S9(3)       COMP-3.
  1124     12  ME-061-PREM             PIC S9(9)V99    COMP-3.
  1125     12  ME-061-COMM             PIC S9(9)V99    COMP-3.
  1126     12  ME-061-OR               PIC S9(9)V99    COMP-3.
  1127     12  ME-061-PY-ADJ           PIC S9(9)V99    COMP-3.
  1128     12  ME-061-COMM-RCALC       PIC S9(9)V99    COMP-3.
  1129     12  ME-061-OR-RCALC         PIC S9(9)V99    COMP-3.
  1130     12  ME-061-PREM-RCALC       PIC S9(9)V99    COMP-3.
  1131     12  ME-061-RUN-DT           PIC  9(6)       COMP-3.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  25
* ECS010Z.cbl (/apps/prod/cid1p/copy/ERCMEBL)
  1132*    12  ME-061-START            PIC  9(6)       COMP-3.
  1133*    12  ME-061-END              PIC  9(6)       COMP-3.
  1134     12  ME-061-RUN-CT           PIC S9(3)       COMP-3.
  1135     12  ME-080-MORT-ERRS        PIC  9(7)       COMP-3.
  1136     12  ME-080-RUN-DT           PIC  9(6)       COMP-3.
  1137*    12  ME-080-START            PIC  9(6)       COMP-3.
  1138*    12  ME-080-END              PIC  9(6)       COMP-3.
  1139     12  ME-080-RUN-CT           PIC S9(3)       COMP-3.
  1140     12  ME-315-RESV-L           PIC S9(9)V99    COMP-3.
  1141     12  ME-315-RESV-AH          PIC S9(9)V99    COMP-3.
  1142     12  ME-315-RUN-DT           PIC  9(6)       COMP-3.
  1143*    12  ME-315-START            PIC  9(6)       COMP-3.
  1144*    12  ME-315-END              PIC  9(6)       COMP-3.
  1145     12  ME-315-RUN-CT           PIC S9(3)       COMP-3.
  1146     12  ME-331-FLAG             PIC  9.
  1147     12  ME-331-RUN-DT           PIC  9(6)       COMP-3.
  1148*    12  ME-331-START            PIC  9(6)       COMP-3.
  1149*    12  ME-331-END              PIC  9(6)       COMP-3.
  1150     12  ME-331-RUN-CT           PIC S9(3)       COMP-3.
  1151     12  ME-341-NOT-FOUND        PIC S9(7)       COMP-3.
  1152     12  ME-341-RUN-DT           PIC  9(6)       COMP-3.
  1153*    12  ME-341-START            PIC  9(6)       COMP-3.
  1154*    12  ME-341-END              PIC  9(6)       COMP-3.
  1155     12  ME-341-RUN-CT           PIC S9(3)       COMP-3.
  1156     12  ME-501-FLAG             PIC  9.
  1157     12  ME-501-RUN-DT           PIC  9(6)       COMP-3.
  1158     12  ME-501-START            PIC  9(6)       COMP-3.
  1159     12  ME-501-END              PIC  9(6)       COMP-3.
  1160     12  ME-501-RUN-CT           PIC S9(3)       COMP-3.
  1161     12  ME-509-FLAG             PIC  9.
  1162     12  ME-509-RUN-DT           PIC  9(6)       COMP-3.
  1163     12  ME-509-START            PIC  9(6)       COMP-3.
  1164     12  ME-509-END              PIC  9(6)       COMP-3.
  1165     12  ME-509-RUN-CT           PIC S9(3)       COMP-3.
  1166     12  ME-522-PY-ADJ           PIC S9(9)V99    COMP-3.
  1167     12  ME-522-RETROS           PIC S9(9)V99    COMP-3.
  1168     12  ME-522-PROC-CLM-L       PIC S9(9)V99    COMP-3.
  1169     12  ME-522-PROC-CLM-AH      PIC S9(9)V99    COMP-3.
  1170     12  ME-522-ALL-CLM-L        PIC S9(9)V99    COMP-3.
  1171     12  ME-522-ALL-CLM-AH       PIC S9(9)V99    COMP-3.
  1172     12  ME-522-PROC-RSV-L       PIC S9(9)V99    COMP-3.
  1173     12  ME-522-PROC-RSV-AH      PIC S9(9)V99    COMP-3.
  1174     12  ME-522-ALL-RSV-L        PIC S9(9)V99    COMP-3.
  1175     12  ME-522-ALL-RSV-AH       PIC S9(9)V99    COMP-3.
  1176     12  ME-522-PREM-L           PIC S9(9)V99    COMP-3.
  1177     12  ME-522-PREM-AH          PIC S9(9)V99    COMP-3.
  1178     12  ME-522-REF-L            PIC S9(9)V99    COMP-3.
  1179     12  ME-522-REF-AH           PIC S9(9)V99    COMP-3.
  1180     12  ME-522-RUN-DT           PIC  9(6)       COMP-3.
  1181     12  ME-522-START            PIC  9(6)       COMP-3.
  1182     12  ME-522-END              PIC  9(6)       COMP-3.
  1183     12  ME-522-RUN-CT           PIC S9(3)       COMP-3.
  1184     12  ME-524-CLMS-L           PIC S9(9)V99    COMP-3.
  1185     12  ME-524-CLMS-AH          PIC S9(9)V99    COMP-3.
  1186     12  ME-524-RESV-L           PIC S9(9)V99    COMP-3.
  1187     12  ME-524-RESV-AH          PIC S9(9)V99    COMP-3.
  1188     12  ME-524-RUN-DT           PIC  9(6)       COMP-3.
  1189     12  ME-524-START            PIC  9(6)       COMP-3.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  26
* ECS010Z.cbl (/apps/prod/cid1p/copy/ERCMEBL)
  1190     12  ME-524-END              PIC  9(6)       COMP-3.
  1191     12  ME-524-RUN-CT           PIC S9(3)       COMP-3.
  1192     12  ME-525-FLAG             PIC  9.
  1193     12  ME-525-RUN-DT           PIC  9(6)       COMP-3.
  1194     12  ME-525-START            PIC  9(6)       COMP-3.
  1195     12  ME-525-END              PIC  9(6)       COMP-3.
  1196     12  ME-525-RUN-CT           PIC S9(3)       COMP-3.
  1197     12  ME-048-RECS-IN          PIC S9(7)       COMP-3.
  1198     12  ME-048-RECS-OUT         PIC S9(7)       COMP-3.
  1199     12  ME-048-RUN-DT           PIC  9(6)       COMP-3.
  1200     12  ME-048-START            PIC  9(6)       COMP-3.
  1201     12  ME-048-END              PIC  9(6)       COMP-3.
  1202     12  ME-048-RUN-CT           PIC S9(3)       COMP-3.
  1203     12  ME-041-REIN-ADJ         PIC S9(9)V99    COMP-3.
  1204
  1205     12  ME-019-CLMS-L           PIC S9(9)V99    COMP-3.
  1206     12  ME-019-CLMS-AH          PIC S9(9)V99    COMP-3.
  1207     12  ME-035-COMM-TOT         PIC S9(9)V99    COMP-3.
  1208     12  ME-035-CLMS-L           PIC S9(9)V99    COMP-3.
  1209     12  ME-035-CLMS-AH          PIC S9(9)V99    COMP-3.
  1210     12  ME-041-RECS-IN          PIC S9(9)       COMP-3.
  1211     12  ME-041-RECS-OUT         PIC S9(9)       COMP-3.
  1212     12  ME-050-ACT-L            PIC S9(7)       COMP-3.
  1213     12  ME-050-ACT-AH           PIC S9(7)       COMP-3.
  1214     12  ME-061-CLMS             PIC S9(9)V99    COMP-3.
  1215     12  ME-341-CLMS-L           PIC S9(9)V99    COMP-3.
  1216     12  ME-341-CLMS-AH          PIC S9(9)V99    COMP-3.
  1217     12  ME-515-CLMS-WRAP        PIC S9(7)V99    COMP-3.
  1218     12  ME-515-RESV-WRAP        PIC S9(7)V99    COMP-3.
  1219     12  ME-317-CLMS-TOT         PIC S9(9)V99    comp-3.
  1220     12  ME-325-CLMS-TOT         PIC S9(9)V99    comp-3.
  1221     12  ME-020-PREM-TOT         PIC S9(11)V99   COMP-3.
  1222     12  ME-020-CLMS-TOT         PIC S9(9)V99    COMP-3.
  1223     12  ME-020-RESV-TOT         PIC S9(9)V99    COMP-3.
  1224     12  ME-063-OW               PIC S9(9)V99    COMP-3.
  1225     12  ME-082-ACT-L            PIC S9(7)       COMP-3.
  1226     12  ME-082-ACT-AH           PIC S9(7)       COMP-3.
  1227     12  ME-016-RECS-IN          PIC S9(9)       COMP-3.
  1228     12  ME-016-RECS-OUT         PIC S9(9)       COMP-3.
  1229     12  ME-562-PREM-TOT         PIC S9(9)V99    COMP-3.
  1230     12  ME-562-COMM-TOT         PIC S9(9)V99    COMP-3.
  1231     12  ME-524-CLMS-TOT-CM      PIC S9(9)V99    comp-3.
  1232     12  ME-523-PREM-TOT         PIC S9(9)V99    COMP-3.
  1233     12  ME-064-BEG-BAL          PIC S9(9)V99    COMP-3.
  1234     12  ME-064-END-BAL          PIC S9(9)V99    COMP-3.
  1235     12  ME-010-MM-PREM-TOT      PIC S9(9)V99    COMP-3.
  1236     12  ME-010-MM-TOT-CLMS      PIC S9(9)V99    COMP-3.
  1237     12  ME-010-MM-TOT-RESV      PIC S9(9)V99    COMP-3.
  1238     12  ME-080-MORT-RESV        PIC S9(9)V99    COMP-3.
  1239
  1240     12  FILLER                  PIC  X(09).
  1241*    12  FILLER                  PIC  X(88).
  1242******************************************************************
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  27
* ECS010Z.cbl
  1244 FD  CERT-MASTER-OUT
* 1245                             COPY ECSCROFD.
  1246******************************************************************07/10/97
  1247*                                                                *ECSCROFD
  1248*                            ECSCROFD                            *   LV001
  1249*                            VMOD=2.002                          *ECSCROFD
  1250*                                                                *ECSCROFD
  1251*  NO CID MODS IN COPYBOOK ECSCROFD.                             *ECSCROFD
  1252*                                                                *ECSCROFD
  1253******************************************************************ECSCROFD
  1254     RECORDING MODE F                                             ECSCROFD
  1255     LABEL RECORDS STANDARD                                       ECSCROFD
  1256     BLOCK CONTAINS 0 RECORDS
  1257     RECORD CONTAINS 1056 CHARACTERS.                             ECSCROFD
  1258 01  CERT-OUT-RECORD.                                             ECSCROFD
  1259     12  FILLER                            PIC  XXX.              ECSCROFD
  1260     12  COR-CONTROL                       PIC  X(36).            ECSCROFD
  1261     12  FILLER                            PIC  X(1017).          ECSCROFD
  1262                                                                  ECSCROFD
  1263******************************************************************ECSCROFD
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  28
* ECS010Z.cbl
  1265 FD  DETAIL-EXTR
  1266     BLOCK CONTAINS 0 RECORDS
  1267     RECORDING MODE F.
  1268
* 1269                             COPY ECSEXT01.
  1270******************************************************************04/29/98
  1271*                                                                *ECSEXT01
  1272*                            ECSEXT01                            *   LV015
  1273*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL*15
  1274*                            VMOD=2.015                          *ECSEXT01
  1275*                                                                *ECSEXT01
  1276*   FILE DESCRIPTION =  DETAIL EXTRACTS                          *ECSEXT01
  1277*                       (PREMIUM, COMM., CLAIMS, AND RESERVES)   *ECSEXT01
  1278*                                                                *ECSEXT01
  1279*   FILE TYPE = SEQUENTIAL                                       *ECSEXT01
  1280*   RECORD SIZE = 510  RECFORM = FIXED                           *ECSEXT01
  1281*                                                                *ECSEXT01
  1282*   KEY DATA =                                   START=5, LEN=36 *ECSEXT01
  1283*                                                                *ECSEXT01
  1284******************************************************************ECSEXT01
  1285******************************************************************
  1286*                   C H A N G E   L O G
  1287*
  1288* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1289*-----------------------------------------------------------------
  1290*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1291* EFFECTIVE    NUMBER
  1292*-----------------------------------------------------------------
  1293* 040504    2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  1294* 042110  CR2010010400006  PEMA  ADD FIELDS FOR EMERALD 032
  1295* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  1296* 071211  CR2010012700001  PEMA  ADD SPP DEALER DIRECT
  1297* 112911  CR2011083000003  PEMA  ADD SPPDDF TRUNCATED
  1298* 032612  CR2011110200001  PEMA  AHL CHANGES
  1299******************************************************************
  1300                                                                  ECSEXT01
  1301 01  DETAIL-EXTRACT.                                              ECSEXT01
  1302     02 DETAIL-FILE.                                              ECSEXT01
  1303     12  DE-RECORD-ID                      PIC XX.                ECSEXT01
  1304         88  VALID-DE-ID                      VALUE 'DE'.         ECSEXT01
  1305                                                                  ECSEXT01
  1306     12  DE-COMPANY-CD                     PIC X.                 ECSEXT01
  1307                                                                  ECSEXT01
  1308     12  DE-REIN                           PIC X.                 ECSEXT01
  1309                                                                  ECSEXT01
  1310     12  DE-CONTROL.                                              ECSEXT01
  1311         16  DE-CNTRL1.                                           ECSEXT01
  1312             20  DE-CARRIER                PIC X.                 ECSEXT01
  1313             20  DE-GROUPING.                                     ECSEXT01
  1314                 24  DE-GROUP-PREFIX       PIC XXX.               ECSEXT01
  1315                 24  DE-GROUP-PRIME        PIC XXX.               ECSEXT01
  1316             20  DE-STATE                  PIC XX.                ECSEXT01
  1317             20  DE-ACCOUNT.                                      ECSEXT01
  1318                 24  DE-ACCT-PREFIX        PIC X(4).              ECSEXT01
  1319                 24  DE-ACCT-PRIME         PIC X(6).              ECSEXT01
  1320         16  DE-CNTRL2.                                           ECSEXT01
  1321             20  DE-EFF                    PIC 9(11)  COMP-3.     ECSEXT01
  1322             20  DE-CERT.                                         ECSEXT01
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  29
* ECS010Z.cbl (/apps/prod/cid1p/copy/ECSEXT01)
  1323                 24 DE-CERT-NO.                                   ECSEXT01
  1324                     28  DE-CRT-PREFIX     PIC XXX.               ECSEXT01
  1325                     28  DE-CRT-PRIME      PIC X(7).              ECSEXT01
  1326                 24  DE-CRT-SUF            PIC X.                 ECSEXT01
  1327                                                                  ECSEXT01
  1328     12  DE-TRANS                          PIC X.                 ECSEXT01
  1329         88  DE-ISSUE                         VALUE 'I'.          ECSEXT01
  1330         88  DE-RC-ISSUE                      VALUE '8'.          ECSEXT01
  1331         88  DE-CANCEL                        VALUE 'C'.          ECSEXT01
  1332         88  DE-RC-CANCEL                     VALUE '7'.          ECSEXT01
  1333         88  DE-CLAIM                         VALUE 'X'.          ECSEXT01
  1334         88  DE-RESTORE                       VALUE 'R'.          ECSEXT01
  1335         88  DE-RESERVE                       VALUE 'Y'.          ECSEXT01
  1336         88  DE-RR-RC-ISS                     VALUE 'J'.          ECSEXT01
  1337         88  DE-RR-RC-CNC                     VALUE 'K'.          ECSEXT01
  1338         88  DE-RR-RC-CLM                     VALUE 'L'.          ECSEXT01
  1339                                                                  ECSEXT01
  1340     12  DE-REPORT-CODE-1                  PIC X(10).             ECSEXT01
  1341     12  DE-REPORT-CODE-2                  PIC X(10).             ECSEXT01
  1342                                                                  ECSEXT01
  1343     12  DE-NAME.                                                 ECSEXT01
  1344         16  DE-LNAME                      PIC X(15).             ECSEXT01
  1345         16  DE-FNAME.                                            ECSEXT01
  1346             20  DE-1ST-INIT-FNAME         PIC X.                 ECSEXT01
  1347             20  FILLER                    PIC X(9).              ECSEXT01
  1348         16  DE-INIT                       PIC X.                 ECSEXT01
  1349     12  DE-AGE                            PIC 99.                ECSEXT01
  1350     12  DE-SEX                            PIC X.                 ECSEXT01
  1351     12  DE-SOC-SEC-NO                     PIC X(11).             ECSEXT01
  1352                                                                  ECSEXT01
  1353     12  DE-LF-TYPE                        PIC XX.                ECSEXT01
  1354     12  DE-LF-TERM                        PIC 999        COMP-3. ECSEXT01
  1355     12  DE-LF-BEN                         PIC S9(9)V99   COMP-3. ECSEXT01
  1356     12  DE-LF-CNBEN                       PIC S9(9)V99   COMP-3. ECSEXT01
  1357     12  DE-LF-PRM                         PIC S9(7)V99   COMP-3. ECSEXT01
  1358     12  DE-LF-BEN-ALT                     PIC S9(9)V99   COMP-3. ECSEXT01
  1359     12  DE-LF-CNBEN-ALT                   PIC S9(9)V99   COMP-3. ECSEXT01
  1360     12  DE-LF-PRM-ALT                     PIC S9(7)V99   COMP-3. ECSEXT01
  1361     12  DE-LF-RFND                        PIC S9(7)V99   COMP-3. ECSEXT01
  1362                                                                  ECSEXT01
  1363     12  DE-LF-STAT-CDE                    PIC X.                 ECSEXT01
  1364     12  DE-LF-PREV-STAT                   PIC X.                 ECSEXT01
  1365     12  DE-LF-CANC-DTE                    PIC 9(11)      COMP-3. ECSEXT01
  1366     12  DE-LF-CANC-EXIT-DT                PIC 9(11)      COMP-3. ECSEXT01
  1367                                                                  ECSEXT01
  1368     12  DE-AH-TYPE                        PIC XX.                ECSEXT01
  1369     12  DE-AH-TERM                        PIC 999        COMP-3. ECSEXT01
  1370     12  DE-AH-BEN                         PIC S9(7)V99   COMP-3. ECSEXT01
  1371     12  DE-AH-PRM                         PIC S9(7)V99   COMP-3. ECSEXT01
  1372     12  DE-AH-RFND                        PIC S9(7)V99   COMP-3. ECSEXT01
  1373                                                                  ECSEXT01
  1374     12  DE-AH-STAT-CDE                    PIC X.                 ECSEXT01
  1375     12  DE-AH-PREV-STAT                   PIC X.                 ECSEXT01
  1376     12  DE-AH-CANC-DTE                    PIC 9(11)  COMP-3.     ECSEXT01
  1377     12  DE-AH-CANC-EXIT-DT                PIC 9(11)  COMP-3.     ECSEXT01
  1378                                                                  ECSEXT01
  1379     12  DE-LIVES                          PIC S9(7)      COMP-3. ECSEXT01
  1380     12  DE-ADDL-CLP REDEFINES DE-LIVES
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  30
* ECS010Z.cbl (/apps/prod/cid1p/copy/ECSEXT01)
  1381                                           PIC S9(5)V99   COMP-3.
  1382     12  DE-NUM-BILLED                     PIC S9(7)      COMP-3. ECSEXT01
  1383     12  FILLER REDEFINES DE-NUM-BILLED.
  1384         16  DE-CLP-STATE                  PIC XX.
  1385         16  DE-DCC-DDF-REM-TRM3           PIC S999       COMP-3.
  1386     12  DE-CANCEL-CNT-ITD                 PIC S999       COMP-3. ECSEXT01
  1387     12  DE-CANCEL-CNT-YTD                 PIC S999       COMP-3. ECSEXT01
  1388                                                                  ECSEXT01
  1389     12  DE-APR                            PIC S999V9(4)  COMP-3. ECSEXT01
  1390     12  DE-PMT-FREQ                       PIC 99.                ECSEXT01
  1391     12  DE-ACC-GPCD                       PIC XX.                ECSEXT01
  1392     12  DE-IG                             PIC X.                 ECSEXT01
  1393     12  DE-REMIT-TO                       PIC XX.                ECSEXT01
  1394*    12  DE-MEMBER-NO                      PIC X(12).             ECSEXT01
  1395     12  DE-MEMBER-NO.                                            ECSEXT01
  1396         16  DE-MASTER-POLICY              PIC X(06).             ECSEXT01
  1397         16  DE-ZIP                        PIC 9(05)    COMP-3.   ECSEXT01
  1398         16  FILLER                        PIC X(03).             ECSEXT01
  1399     12  DE-LN-OFFICER                     PIC XXX.               ECSEXT01
  1400                                                                  ECSEXT01
  1401     12  DE-AUTO-GEND-IND                  PIC X.                 ECSEXT01
  1402         88  DE-AUTO-GEND-REINS            VALUE 'R'.             ECSEXT01
  1403                                                                  ECSEXT01
  1404     12  DE-ENTRY-STATUS                   PIC X.                 ECSEXT01
  1405     12  DE-ENTRY-DTE                      PIC 9(11)      COMP-3. ECSEXT01
  1406                                                                  ECSEXT01
  1407     12  DE-REI-AREA.                                             ECSEXT01
  1408         16  DE-REI-COMP.                                         ECSEXT01
  1409             20  DE-REINCO                 PIC XXX.               ECSEXT01
  1410             20  DE-REINCO-SUB             PIC XXX.               ECSEXT01
  1411         16  DE-REI-LFAMT                  PIC S9(9)V99   COMP-3. ECSEXT01
  1412         16  DE-REI-LFPRM                  PIC S9(7)V99   COMP-3. ECSEXT01
  1413         16  DE-REI-LFRFND                 PIC S9(7)V99   COMP-3. ECSEXT01
  1414         16  DE-REI-AHAMT                  PIC S9(7)V99   COMP-3. ECSEXT01
  1415         16  DE-REI-AHPRM                  PIC S9(7)V99   COMP-3. ECSEXT01
  1416         16  DE-REI-AHRFND                 PIC S9(7)V99   COMP-3. ECSEXT01
  1417         16  DE-REI-CNAMT                  PIC S9(9)V99   COMP-3. ECSEXT01
  1418                                                                  ECSEXT01
  1419     12  DE-MOB-NET-TOT-FEES               PIC S9(7)V99   COMP-3.
  1420     12  FILLER REDEFINES DE-MOB-NET-TOT-FEES.
  1421         16  DE-IU-RATE-UP                 PIC S9(5)V99 COMP-3.
  1422         16  F                             PIC X.
  1423*    12  FILLER                            PIC X(5).              ECSEXT01
  1424                                                                  ECSEXT01
  1425     12  DE-BILLED-AREA.                                          ECSEXT01
  1426         16  DE-GL-INTERFACE-CODES.                               ECSEXT01
  1427             20  DE-GL-CODES               PIC X  OCCURS 10 TIMES.ECSEXT01
  1428                                                                  ECSEXT01
  1429         16  DE-BILL-SW                    PIC X.                 ECSEXT01
  1430             88  DE-RECORD-ON-HOLD            VALUE 'H'.          ECSEXT01
  1431             88  DE-RECORD-RETURNED           VALUE 'R'.          ECSEXT01
  1432             88  DE-RECORD-ENDORSED           VALUE 'E'.          ECSEXT01
  1433             88  DE-OVERRIDE-LIFE             VALUE 'L'.          ECSEXT01
  1434             88  DE-OVERRIDE-AH               VALUE 'A'.          ECSEXT01
  1435             88  DE-OVERRIDE-BOTH             VALUE 'B'.          ECSEXT01
  1436                                                                  ECSEXT01
  1437         16  DE-REFUND-SW                  PIC X.                 ECSEXT01
  1438             88  DE-REFUND-CREATED            VALUE 'Y'.          ECSEXT01
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  31
* ECS010Z.cbl (/apps/prod/cid1p/copy/ECSEXT01)
  1439                                                                  ECSEXT01
  1440         16  DE-BILLED-LFPRM               PIC S9(7)V99   COMP-3. ECSEXT01
  1441         16  DE-BILLED-LFRFND              PIC S9(7)V99   COMP-3. ECSEXT01
  1442         16  DE-BILLED-AHPRM               PIC S9(7)V99   COMP-3. ECSEXT01
  1443         16  DE-BILLED-AHRFND              PIC S9(7)V99   COMP-3. ECSEXT01
  1444                                                                  ECSEXT01
  1445         16  DE-GA-BILL-STATUS             PIC X  OCCURS 5 TIMES. ECSEXT01
  1446*            88  DE-NO-PRE-BILL-GA            VALUE ' '.          ECSEXT01
  1447*            88  DE-BILLED-GA                 VALUE 'B'.          ECSEXT01
  1448                                                                  ECSEXT01
  1449     12  DE-BILL-STATUS                    PIC X.                 ECSEXT01
  1450         88  DE-NO-PRE-BILL                   VALUE ' '.          ECSEXT01
  1451         88  DE-BILLED                        VALUE 'B'.          ECSEXT01
  1452         88  DE-REVERSE                       VALUE 'R'.          ECSEXT01
  1453                                                                  ECSEXT01
  1454     12  DE-REVERSE-REASONS.                                      ECSEXT01
  1455         16  DE-REVERSE-REASON-1           PIC X.                 ECSEXT01
  1456         16  DE-REVERSE-REASON-2           PIC X.                 ECSEXT01
  1457     12  DE-CANCEL-REASON                  PIC X.
  1458                                                                  ECSEXT01
  1459     12  DE-RECALC-CODE                    PIC X.                 ECSEXT01
  1460     12  DE-RECALC-TYPE                    PIC X.                 ECSEXT01
  1461                                                                  ECSEXT01
  1462     12  DE-CHARGEBACK-CODES.                                     ECSEXT01
  1463         16  DE-LF-COMM-CHARGEBACK         PIC X.                 ECSEXT01
  1464             88  DE-NO-LF-CHARGEBACK          VALUE 'N'.          ECSEXT01
  1465         16  DE-AH-COMM-CHARGEBACK         PIC X.                 ECSEXT01
  1466             88  DE-NO-AH-CHARGEBACK          VALUE 'N'.          ECSEXT01
  1467                                                                  ECSEXT01
  1468     12  DE-UNDERWRITING-CODE              PIC X.                 ECSEXT01
  1469         88  DE-POLICY-UNDERWRITTEN           VALUE 'Y'.          ECSEXT01
  1470                                                                  ECSEXT01
  1471     12  DE-NCL-POOL-CODE                  PIC XXX.               ECSEXT01
  1472     12  FILLER REDEFINES DE-NCL-POOL-CODE.
  1473         16  DE-LOAN-TERM                  PIC S999 COMP-3.
  1474         16  FILLER                        PIC X.
  1475                                                                  ECSEXT01
  1476****************************************************************  ECSEXT01
  1477**** CLAIM EXTRACT AND RESERVE EXTRACT IS REDEFINED AT THIS POINT ECSEXT01
  1478****************************************************************  ECSEXT01
  1479     12  DE-COMM-LEVELS.                                          ECSEXT01
  1480         16  DE-AGT-LEVELS     OCCURS  10  TIMES.                 ECSEXT01
  1481             20  DE-AGT.                                          ECSEXT01
  1482                 24  DE-AGT-PREFIX         PIC X(4).              ECSEXT01
  1483                 24  DE-AGT-PRIME          PIC X(6).              ECSEXT01
  1484             20  DE-AGT-TYPE               PIC X.                 ECSEXT01
  1485             20  DE-L-PC                   PIC SV9(5)     COMP-3. ECSEXT01
  1486             20  DE-A-PC                   PIC SV9(5)     COMP-3. ECSEXT01
  1487                                                                  ECSEXT01
  1488     12  DE-PROC-DT                        PIC 9(11)      COMP-3. ECSEXT01
  1489****************************************************************  ECSEXT01
  1490*******                 CLAIM EXTRACT                      *****  ECSEXT01
  1491****************************************************************  ECSEXT01
  1492     02 DE-CLAIM-EXTRACT     REDEFINES     DETAIL-FILE.           ECSEXT01
  1493     12  FILLER                            PIC X(334).            ECSEXT01
  1494     12  DE-TYPE                           PIC X.                 ECSEXT01
  1495         88  DE-DTH                           VALUE '1'.          ECSEXT01
  1496         88  DE-AH                            VALUE '2'.          ECSEXT01
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  32
* ECS010Z.cbl (/apps/prod/cid1p/copy/ECSEXT01)
  1497         88  DE-OB-DTH                        VALUE '3'.          ECSEXT01
  1498         88  DE-OB-AH                         VALUE '4'.          ECSEXT01
  1499         88  DE-DEATH                         VALUES '1' '3'.     ECSEXT01
  1500         88  DE-DISABILITY                    VALUES '2' '4'.     ECSEXT01
  1501                                                                  ECSEXT01
  1502     12  DE-CLAIM-AMT                      PIC S9(9)V99   COMP-3. ECSEXT01
  1503     12  DE-REI-CLAIM-AMT                  PIC S9(9)V99   COMP-3. ECSEXT01
  1504                                                                  ECSEXT01
  1505     12  DE-INCUR                          PIC 9(11)      COMP-3. ECSEXT01
  1506     12  DE-REPORTED.                                             ECSEXT01
  1507         16  DE-RPT-YR                     PIC 99.                ECSEXT01
  1508         16  DE-RPT-MO                     PIC 99.                ECSEXT01
  1509         16  DE-RPT-DA                     PIC 99.                ECSEXT01
  1510     12  DE-PAY                            PIC 9(11)      COMP-3. ECSEXT01
  1511     12  DE-PAID-TO                        PIC 9(11)      COMP-3. ECSEXT01
  1512                                                                  ECSEXT01
  1513     12  DE-CNUM                           PIC X(7).              ECSEXT01
  1514     12  DE-CHECK                          PIC X(7).              ECSEXT01
  1515     12  DE-PMT-TRAILER-SEQ                PIC S9(4)       COMP.  ECSEXT01
  1516     12  DE-DAYS-DISAB                     PIC 999.               ECSEXT01
  1517     12  DE-CLM-AGE                        PIC 99.                ECSEXT01
  1518     12  DE-PAY-CODE                       PIC X.                 ECSEXT01
  1519         88  DE-PARTIAL-PAYMENT               VALUE 'P'.          ECSEXT01
  1520         88  DE-FINAL-PAYMENT                 VALUE 'F'.          ECSEXT01
  1521         88  DE-LUMP-SUM-PAYMENT              VALUE 'S'.          ECSEXT01
  1522         88  DE-ADDITIONAL-PAYMENT            VALUE 'X'.          ECSEXT01
  1523         88  DE-CHARGEABLE-EXPENSE            VALUE 'E'.          ECSEXT01
  1524         88  DE-NON-CHARGEABLE-EXPENSE        VALUE 'E'.          ECSEXT01
  1525         88  DE-VOIDED-PAYMENT                VALUE 'V'.          ECSEXT01
  1526                                                                  ECSEXT01
  1527     12  DE-CLM-ERR                        PIC XX.                ECSEXT01
  1528                                                                  ECSEXT01
  1529     12  DE-ACC-NAME                       PIC X(30).             ECSEXT01
  1530     12  DE-ACC-EXP-DTE                    PIC 9(11)  COMP-3.     ECSEXT01
  1531     12  DE-ACC-EFF-DTE                    PIC 9(11)  COMP-3.     ECSEXT01
  1532     12  FILLER                            PIC XX.                ECSEXT01
  1533     12  DE-LOAN-OFFICER                   PIC XXX.               ECSEXT01
  1534                                                                  ECSEXT01
  1535     12  DE-LOAN-TYPE                      PIC X(02).             ECSEXT01
  1536     12  DE-BENEFICIARY                    PIC X(10).
  1537     12  filler redefines de-beneficiary.
  1538         16  de-birth-date                 pic 9(11)  comp-3.
  1539         16  f                             pic x(4).
  1540     12  DE-LOAN-CLASS                     PIC X(02).             ECSEXT01
  1541     12  DE-LOSS-CODE                      PIC X(06).             ECSEXT01
  1542     12  DE-ASSOCIATES                     PIC X(01).             ECSEXT01
  1543     12  DE-LEGAL-STATE                    PIC X(02).             ECSEXT01
  1544     12  DE-CLM-CAUSE                      PIC X(6).              ECSEXT01
  1545     12  DE-CLM-CLASS                      PIC XX.
  1546     12  DE-CLM-DEV                        PIC XXX.
  1547     12  DE-XYCOR-CLAIM-NO                 PIC X(9).
  1548     12  de-xycor-cert-seq                 pic x(3).
  1549     12  DE-XYCOR-CHECK-NO                 PIC X(8).
  1550     12  DE-XYCOR-ACTION-CD                PIC XXX.
  1551     12  DE-XYCOR-STATUS                   PIC X.
  1552     12  FILLER                            PIC X(4).              ECSEXT01
  1553                                                                  ECSEXT01
  1554     12  DE-CLM-PROC-DT                    PIC 9(11)  COMP-3.        CL**2
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  33
* ECS010Z.cbl (/apps/prod/cid1p/copy/ECSEXT01)
  1555                                                                  ECSEXT01
  1556****************************************************************  ECSEXT01
  1557*******               RESERVE EXTRACT                      *****  ECSEXT01
  1558****************************************************************  ECSEXT01
  1559     02 DE-RESERVE-EXTRACT     REDEFINES     DETAIL-FILE.         ECSEXT01
  1560     12  FILLER                            PIC X(334).            ECSEXT01
  1561                                                                  ECSEXT01
  1562     12  DE-RESERVE-TYPE                   PIC X.                 ECSEXT01
  1563         88  DE-LIFE-RSV                      VALUE '1' '3'.      ECSEXT01
  1564         88  DE-AH-RSV                        VALUE '2' '4'.      ECSEXT01
  1565                                                                  ECSEXT01
  1566     12  DE-IBNR                           PIC S9(7)V99   COMP-3. ECSEXT01
  1567     12  DE-PAYCUR                         PIC S9(7)V99   COMP-3. ECSEXT01
  1568     12  DE-FUTRSV                         PIC S9(7)V99   COMP-3. ECSEXT01
  1569                                                                  ECSEXT01
  1570     12  DE-CLMNO                          PIC X(7).              ECSEXT01
  1571                                                                  ECSEXT01
  1572     12  DE-RSV-INCUR                      PIC 9(11)      COMP-3. ECSEXT01
  1573     12  DE-RSV-REPORTED.                                         ECSEXT01
  1574         16  DE-RSV-RPT-YR                 PIC 99.                ECSEXT01
  1575         16  DE-RSV-RPT-MO                 PIC 99.                ECSEXT01
  1576         16  DE-RSV-RPT-DA                 PIC 99.                ECSEXT01
  1577     12  DE-RSV-PAYTO                      PIC 9(11)      COMP-3. ECSEXT01
  1578                                                                  ECSEXT01
  1579     12  DE-REI-IBNR                       PIC S9(7)V99   COMP-3. ECSEXT01
  1580     12  DE-REI-PAYCUR                     PIC S9(7)V99   COMP-3. ECSEXT01
  1581     12  DE-REI-FUTRSV                     PIC S9(7)V99   COMP-3. ECSEXT01
  1582                                                                  ECSEXT01
  1583     12  DE-RSV-ACC-NAME                   PIC X(30).             ECSEXT01
  1584     12  DE-ACC-EXP-DTE-RSV                PIC 9(11)      COMP-3. ECSEXT01
  1585     12  DE-ACC-EFF-DTE-RSV                PIC 9(11)      COMP-3. ECSEXT01
  1586                                                                  ECSEXT01
  1587     12  DE-MANUAL-RSV-SWITCH              PIC X.                 ECSEXT01
  1588                                                                  ECSEXT01
  1589     12  DE-RATE-CLASS                     PIC XX.
  1590     12  DE-DEV-CODE                       PIC XXX.
  1591     12  DE-RSV-REM-TERM                   PIC S999       COMP-3.
  1592     12  DE-RSV-REM-BENEFIT                PIC S9(9)V99   COMP-3.
  1593     12  FILLER                            PIC X(58).             ECSEXT01
  1594                                                                  ECSEXT01
  1595     12  DE-RSV-PROC-DT                    PIC 9(11)  COMP-3.        CL**2
  1596******************************************************************ECSEXT01
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  34
* ECS010Z.cbl
  1598 FD  SUMMARY-EXTR
  1599     BLOCK CONTAINS 0 RECORDS
  1600     RECORDING MODE F.
  1601
* 1602                             COPY ECSEPC01.
  1603******************************************************************
  1604*                                                                *
  1605*                            ECSEPC01                            *
  1606*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1607*                            VMOD=2.008                          *
  1608*                                                                *
  1609*   FILE DESCRIPTION =  EARNED PREM / EARNED COMM  (E.P.E.C.)    *
  1610*                                                                *
  1611*   FILE TYPE = SEQUENTIAL                                       *
  1612*   RECORD SIZE = 325  RECFORM = FIXED                           *
  1613*                                                                *
  1614*   KEY DATA =                                  START=5, LEN=31  *
  1615*                                                                *
  1616*  NO  CID  MODS  IN  COPYBOOK  ECSEPC01                         *
  1617*                                                                *
  1618******************************************************************
  1619
  1620 01  EP-RECORD.
  1621     02 EP-FILE.
  1622     12  EP-RECORD-ID                      PIC XX.
  1623         88  VALID-EP-ID                      VALUE 'EP'.
  1624
  1625     12  EP-COMPANY-CD                     PIC X.
  1626
  1627     12  EP-REIN                           PIC X.
  1628         88  EP-REIN-EXTRACT                  VALUE 'R'.
  1629
  1630     12  EP-CONTROL.
  1631         16  EP-CNTRL-1.
  1632             20  EP-COMPANY.
  1633                 24  EP-CARRIER            PIC X.
  1634                 24  EP-GROUPING.
  1635                     28  EP-GROUP-PREFIX   PIC XXX.
  1636                     28  EP-GROUP-PRIME    PIC XXX.
  1637             20  EP-STATE                  PIC XX.
  1638             20  EP-ACCOUNT.
  1639                 24  EP-ACCT-PREFIX        PIC X(4).
  1640                 24  EP-ACCT-PRIME         PIC X(6).
  1641         16  EP-CNTRL-2.
  1642             20  EP-DATES.
  1643                 24  EP-EXP-DTE            PIC 9(11)   COMP-3.
  1644                 24  EP-EFF-DTE            PIC 9(11)   COMP-3.
  1645
  1646     12  EP-REI-CO.
  1647         16  EP-REINCO                     PIC XXX.
  1648         16  EP-REINCO-SUB                 PIC XXX.
  1649
  1650     12  EP-RCD-TYPE                       PIC X.
  1651         88  EP-BEN-TYPE-LIFE                 VALUE 'L'.
  1652         88  EP-BEN-TYPE-AH                   VALUE 'A'.
  1653         88  EP-BEN-TYPE-PROPERTY             VALUE 'P'.
  1654         88  EP-BEN-TYPE-UNEMPLOYMENT         VALUE 'U'.
  1655         88  EP-BEN-TYPE-DISMEMBURMENT        VALUE 'D'.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  35
* ECS010Z.cbl (/apps/prod/cid1p/copy/ECSEPC01)
  1656         88  EP-BEN-TYPE-AD-D                 VALUE 'E'.
  1657     12  EP-BEN-CODE                       PIC XX.
  1658     12  FILLER                            PIC X.
  1659
  1660     12  EP-ISS-CNT                        PIC S9(7)      COMP-3.
  1661     12  EP-ISS-BEN                        PIC S9(11)V99  COMP-3.
  1662     12  EP-ISS-BEN-GROSS                  PIC S9(11)V99  COMP-3.
  1663
  1664     12  EP-CNC-CNT                        PIC S9(7)      COMP-3.
  1665     12  EP-CNC-BEN                        PIC S9(11)V99  COMP-3.
  1666     12  EP-CNC-BEN-GROSS                  PIC S9(11)V99  COMP-3.
  1667
  1668     12  EP-ISS-PRM                        PIC S9(9)V99   COMP-3.
  1669     12  EP-ISS-PRM-GROSS                  PIC S9(9)V99   COMP-3.
  1670     12  EP-CNC-PRM                        PIC S9(9)V99   COMP-3.
  1671     12  EP-CNC-PRM-GROSS                  PIC S9(9)V99   COMP-3.
  1672
  1673     12  EP-PRM-78                         PIC S9(9)V99   COMP-3.
  1674     12  EP-PRM-PR                         PIC S9(9)V99   COMP-3.
  1675     12  EP-PRM-ST                         PIC S9(9)V99   COMP-3.
  1676
  1677     12  EP-CLM-AMT                        PIC S9(9)V99   COMP-3.
  1678     12  EP-CLM-CNT                        PIC S9(7)      COMP-3.
  1679     12  EP-CLM-CRT                        PIC S9(7)      COMP-3.
  1680
  1681     12  EP-CLM-DU                         PIC S9(7)V99   COMP-3.
  1682     12  EP-CLM-PV                         PIC S9(7)V99   COMP-3.
  1683     12  EP-CLM-IBNR                       PIC S9(7)V99   COMP-3.
  1684     12  EP-LOSS-RESV                      PIC S9(7)V99   COMP-3.
  1685     12  EP-CLAIM-ADJ                      PIC S9(7)V99   COMP-3.
  1686
  1687     12  EP-RETRO-EXPENSES                 PIC S9(7)V99   COMP-3.
  1688     12  EP-RETRO-PAYMENTS                 PIC S9(7)V99   COMP-3.
  1689     12  EP-RETRO-OTH-COMM                 PIC S9(7)V99   COMP-3.
  1690
  1691     12  EP-MORT-RESV                      PIC S9(11)V9(6) COMP-3.
  1692     12  EP-IN-FORCE                       PIC S9(11)V99   COMP-3.
  1693     12  EP-ADJUST                         PIC S9(7)V99    COMP-3.
  1694
  1695     12  EP-SPECIFIC-OPT-RSV-FIELDS.
  1696         16  EP-LIFE-YEARS                 PIC S9(9)      COMP-3.
  1697         16  EP-NEW-DATA-IND               PIC X(01).
  1698             88  EP-NEW-DATA                   VALUE 'Y'.
  1699         16  EP-CLM-EXP                    PIC S9(9)V99   COMP-3.
  1700         16  FILLER                        PIC X(19).
  1701
  1702     12  EP-PRM-78-ADJ                     PIC S9(9)V99   COMP-3.
  1703     12  EP-PRM-PR-ADJ                     PIC S9(9)V99   COMP-3.
  1704     12  EP-PRM-ST-ADJ                     PIC S9(9)V99   COMP-3.
  1705
  1706     12  FILLER                            PIC XXX.
  1707
  1708     12  EP-UNDERWRITING-CODE              PIC X.
  1709         88  EP-UNDERWRITTEN-DATA             VALUE 'Y'.
  1710
  1711     12  EP-PRM-TAX                        PIC S9(7)V99   COMP-3.
  1712
  1713     12  FILLER                            PIC X(29).
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  36
* ECS010Z.cbl (/apps/prod/cid1p/copy/ECSEPC01)
  1714*    12  FILLER                            PIC X(34).
  1715
  1716     12  EP-AVG-AGE                        PIC S9(3)      COMP-3.
  1717     12  EP-AVG-ORIG-TERM                  PIC S9(3)      COMP-3.
  1718     12  EP-WEIGHTED-AGE                   PIC S9(3)      COMP-3.
  1719     12  EP-WEIGHTED-ORIG-TERM             PIC S9(3)      COMP-3.
  1720     12  EP-AVG-REM-TERM                   PIC S9(3)      COMP-3.
  1721     12  EP-INFORCE-CNT                    PIC S9(9)      COMP-3.
  1722
  1723     12  EP-HI-COV-DT                      PIC 9(11)      COMP-3.
  1724
  1725     12  EP-HI-CERT                        PIC 9(11)      COMP-3.
  1726     12  EP-LO-CERT                        PIC 9(11)      COMP-3.
  1727
  1728     12  EP-PURGE                          PIC X.
  1729         88  EP-DATA-FROM-PURGED-CERTS        VALUE 'P'.
  1730
  1731     12  EP-RUN-DTE                        PIC 9(11)      COMP-3.
  1732
  1733     02 EC-RECORD     REDEFINES     EP-FILE.
  1734     12  EC-RECORD-ID                      PIC XX.
  1735         88  VALID-EC-ID                      VALUE 'EC'.
  1736
  1737     12  EC-COMPANY-CD                     PIC X.
  1738
  1739     12  EC-REIN                           PIC X.
  1740         88  EC-REIN-EXTRACT                  VALUE 'R'.
  1741
  1742     12  EC-CONTROL.
  1743         16  EC-CARRIER                    PIC X.
  1744         16  EC-GROUPING.
  1745             20  EC-GROUP-PREFIX           PIC XXX.
  1746             20  EC-GROUP-PRIME            PIC XXX.
  1747         16  EC-STATE                      PIC XX.
  1748         16  EC-ACCOUNT.
  1749             20  EC-ACCT-PREFIX            PIC X(4).
  1750             20  EC-ACCT-PRIME             PIC X(6).
  1751         16  EC-DATES.
  1752             20  EC-EXP-DTE                PIC 9(11)    COMP-3.
  1753             20  EC-EFF-DTE                PIC 9(11)    COMP-3.
  1754
  1755     12  EC-REI-CO.
  1756         16  EC-REINCO                     PIC XXX.
  1757         16  EC-REINCO-SUB                 PIC XXX.
  1758
  1759     12  EC-RCD-TYPE                       PIC X.
  1760         88  EC-BEN-TYPE-LIFE                 VALUE 'L'.
  1761         88  EC-BEN-TYPE-AH                   VALUE 'A'.
  1762         88  EC-BEN-TYPE-PROPERTY             VALUE 'P'.
  1763         88  EC-BEN-TYPE-UNEMPLOYMENT         VALUE 'U'.
  1764         88  EC-BEN-TYPE-DISMEMBURMENT        VALUE 'D'.
  1765     12  EC-BEN-CODE                       PIC XX.
  1766     12  EC-SEQ-NBR                        PIC X.
  1767         88  EC-COMP-LEVELS-1-5               VALUE '1'.
  1768         88  EC-COMP-LEVELS-6-10              VALUE '2'.
  1769
  1770     12  EC-AGENTS-DATA.
  1771         16  EC-AGENTS-LEVEL     OCCURS   5   TIMES.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  37
* ECS010Z.cbl (/apps/prod/cid1p/copy/ECSEPC01)
  1772             20  EC-AGT-NO.
  1773                 24  EC-AGT-PREFIX         PIC X(4).
  1774                 24  EC-AGT-PRIME          PIC X(6).
  1775             20  EC-AGT-TYPE               PIC X.
  1776             20  EC-ISS-COMM               PIC S9(9)V99   COMP-3.
  1777             20  EC-CNC-COMM               PIC S9(9)V99   COMP-3.
  1778             20  EC-COMM-78                PIC S9(9)V99   COMP-3.
  1779             20  EC-COMM-PR                PIC S9(9)V99   COMP-3.
  1780             20  EC-COMM-ST                PIC S9(9)V99   COMP-3.
  1781
  1782     12  EC-UNDERWRITING-CODE              PIC X.
  1783         88  EC-UNDERWRITTEN-DATA             VALUE 'Y'.
  1784
  1785     12  EC-AGENTS-DATA-II.
  1786         16  EC-AGENTS-LEVEL-II  OCCURS   5   TIMES.
  1787             20  EC-COMM-78-ADJ            PIC S9(9)V99   COMP-3.
  1788             20  EC-COMM-PR-ADJ            PIC S9(9)V99   COMP-3.
  1789
  1790     12  FILLER                            PIC X(7).
  1791
  1792     12  EC-PURGE                          PIC X.
  1793         88  EC-DATA-FROM-PURGED-CERTS        VALUE 'P'.
  1794
  1795     12  EC-RUN-DTE                        PIC 9(11)     COMP-3.
  1796
  1797******************************************************************
  1798
  1799 FD  ERRESC-IN.
* 1800                             COPY ERCRESC.
  1801******************************************************************04/29/98
  1802*                                                                *ERCRESC
  1803*                            ERCRESC                             *   LV002
  1804*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  1805*                            VMOD=2.003                          *   CL**2
  1806*                                                                *ERCRESC
  1807*   FILE DESCRIPTION = ACCOUNT RESIDENT STATE COMMISSION         *ERCRESC
  1808*                                                                *ERCRESC
  1809*   FILE TYPE = VSAM,KSDS                                        *ERCRESC
  1810*   RECORD SIZE = 103 RECFORM = FIXED                            *ERCRESC
  1811*                                                                *ERCRESC
  1812*   BASE CLUSTER NAME = ERRESC                    RKP=00,LEN=37  *ERCRESC
  1813*       ALTERNATE PATH1 = NONE                                   *ERCRESC
  1814*                                                                *ERCRESC
  1815*   LOG = NO                                                     *ERCRESC
  1816*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *ERCRESC
  1817*                                                                *ERCRESC
  1818******************************************************************ERCRESC
  1819                                                                  ERCRESC
  1820 01  ACCOUNT-RESIDENT-ST-COMMISSION.                              ERCRESC
  1821                                                                  ERCRESC
  1822     10  ERRESC-RECORD-KEY.                                       ERCRESC
  1823         15  RESC-COMPANY-CD           PIC   X.                   ERCRESC
  1824         15  RESC-CARRIER              PIC   X.                   ERCRESC
  1825         15  RESC-GROUP                PIC   X(6).                ERCRESC
  1826         15  RESC-STATE                PIC   XX.                  ERCRESC
  1827         15  RESC-ACCOUNT              PIC   X(10).               ERCRESC
  1828         15  RESC-AGENT                PIC   X(10).               ERCRESC
  1829         15  RESC-RESIDENT-STATE       PIC   XX.                  ERCRESC
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  38
* ECS010Z.cbl (/apps/prod/cid1p/copy/ERCRESC)
  1830         15  RESC-EXPIRE-DATE          PIC  9(8) COMP-3.          ERCRESC
  1831*                                           YYYYMMDD              ERCRESC
  1832     10  RESC-EFFECTIVE-DATE           PIC  9(8) COMP-3.          ERCRESC
  1833                                                                  ERCRESC
  1834     10  RESC-COMM-RECORD-DATA.                                   ERCRESC
  1835         15  RESC-COMMISSIONS OCCURS 12 TIMES.                    ERCRESC
  1836             20 RESC-COVERAGE-CAT      PIC    X.                  ERCRESC
  1837             20 RESC-COMMISSION-PER    PIC SV9(5) COMP-3.         ERCRESC
  1838             20 RESC-COMMISSION-TAB REDEFINES                     ERCRESC
  1839                RESC-COMMISSION-PER    PIC  XXX.                  ERCRESC
  1840                                                                  ERCRESC
  1841     10  RESC-MAINT-BY                 PIC X(4).                  ERCRESC
  1842     10  RESC-LST-MAINT-TIME           PIC 9(7)   COMP-3.         ERCRESC
  1843     10  RESC-LST-MAINT-DATE           PIC 9(8)   COMP-3.         ERCRESC
  1844*                                          YYYYMMDD               ERCRESC
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  39
* ECS010Z.cbl
  1846 FD  DISK-DATE
* 1847                             COPY ELCDTEFD.
  1848******************************************************************04/15/98
  1849*                                                                *ELCDTEFD
  1850*                                                                *ELCDTEFD
  1851*                            ELCDTEFD.                           *   LV002
  1852*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  1853*                            VMOD=2.007                          *   CL**2
  1854*                                                                *ELCDTEFD
  1855******************************************************************ELCDTEFD
  1856     BLOCK CONTAINS 0 RECORDS
  1857     RECORDING MODE F.                                            ELCDTEFD
  1858                                                                  ELCDTEFD
  1859 01  DATE-DISK.                                                   ELCDTEFD
  1860     12  DD-ID                       PIC  X(4).                   ELCDTEFD
  1861     12  FILLER                      PIC  X(14).                  ELCDTEFD
  1862     12  DD-CR1                      PIC  9.                      ELCDTEFD
  1863     12  DD-CR1N                     PIC  X(30).                  ELCDTEFD
  1864     12  DD-CR2                      PIC  9.                      ELCDTEFD
  1865     12  DD-CR2N                     PIC  X(30).                  ELCDTEFD
  1866     12  FILLER                      PIC  X(20).                  ELCDTEFD
  1867                                                                  ELCDTEFD
  1868 01  DATE-DISK-R.                                                 ELCDTEFD
  1869     12  FILLER                      PIC  X(4).                   ELCDTEFD
  1870     12  DD-ST           OCCURS 3 TIMES                           ELCDTEFD
  1871                                     PIC  X(32).                  ELCDTEFD
  1872                                                                  ELCDTEFD
  1873 01  DATE-DISK-T.                                                 ELCDTEFD
  1874     12  FILLER                      PIC  X(4).                   ELCDTEFD
  1875     12  DD-TYPE         OCCURS 2 TIMES                           ELCDTEFD
  1876                                     PIC  X(48).                  ELCDTEFD
  1877                                                                  ELCDTEFD
  1878 01  DATE-DISK-M.                                                 ELCDTEFD
  1879     12  FILLER                      PIC  X(4).                   ELCDTEFD
  1880     12  DD-MORT         OCCURS 2 TIMES                           ELCDTEFD
  1881                                     PIC  X(48).                  ELCDTEFD
  1882                                                                  ELCDTEFD
  1883 01  DATE-DISK-P.                                                 ELCDTEFD
  1884     12  DD-IDA                      PIC  XX.                     ELCDTEFD
  1885     12  DD-IDX                      PIC  99.                     ELCDTEFD
  1886     12  DD-DATA                     PIC  X(96).                  ELCDTEFD
  1887     12  FILLER  REDEFINES DD-DATA.                               ELCDTEFD
  1888         16  DD-PS-PIC   OCCURS 50 TIMES                          ELCDTEFD
  1889                                     PIC  X.                      ELCDTEFD
  1890         16  FILLER                  PIC  X(46).                  ELCDTEFD
  1891     12  FILLER  REDEFINES DD-DATA.                               ELCDTEFD
  1892         16  DD-PS-PICO  OCCURS 20 TIMES.                         ELCDTEFD
  1893             20  DD-PS-PRT           PIC  X.                      ELCDTEFD
  1894             20  DD-PS-FMT           PIC  X.                      ELCDTEFD
  1895             20  DD-PS-PRC           PIC  X.                      ELCDTEFD
  1896             20  DD-PS-TOT           PIC  X.                      ELCDTEFD
  1897         16  FILLER                  PIC  X(16).                  ELCDTEFD
  1898                                                                  ELCDTEFD
  1899 01  DATE-DISK-E.                                                 ELCDTEFD
  1900     12  FILLER                      PIC  X(4).                   ELCDTEFD
  1901     12  DD-EDIT         OCCURS 24 TIMES                          ELCDTEFD
  1902                                     PIC  X(4).                   ELCDTEFD
  1903                                                                  ELCDTEFD
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  40
* ECS010Z.cbl (/apps/prod/cid1p/copy/ELCDTEFD)
  1904 01  DATE-DISK-C.                                                 ELCDTEFD
  1905     12  FILLER                      PIC  X(7).                   ELCDTEFD
  1906     12  DD-CARR1-SECPAY-SW          PIC  X.
  1907     12  DD-CARR1-UEP-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
  1908     12  DD-CARR1-R78-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
  1909     12  DD-CARR1-PRO-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
  1910     12  DD-CARR1                    PIC  X.                      ELCDTEFD
  1911     12  DD-CARR1S                   PIC  XX.                     ELCDTEFD
  1912     12  DD-CARR1N                   PIC  X(30).                  ELCDTEFD
  1913     12  DD-CARR2                    PIC  X.                      ELCDTEFD
  1914     12  DD-CARR2S                   PIC  XX.                     ELCDTEFD
  1915     12  DD-CARR2N                   PIC  X(30).                  ELCDTEFD
  1916     12  DD-CARR2-UEP-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
  1917     12  DD-CARR2-R78-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
  1918     12  DD-CARR2-PRO-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
  1919     12  DD-CARR2-SECPAY-SW          PIC  X.
  1920     12  FILLER                      PIC  X(7).                   ELCDTEFD
  1921                                                                  ELCDTEFD
  1922 01  DATE-DISK-OPT.                                               ELCDTEFD
  1923     12  FILLER                      PIC  X(04).                  ELCDTEFD
  1924     12  DD-TLR-DATA.                                             ELCDTEFD
  1925         16  DD-TLR                  OCCURS 32 TIMES              ELCDTEFD
  1926                                     PIC  X(03).                  ELCDTEFD
  1927     12  DD-STATE-DATA REDEFINES DD-TLR-DATA.                     ELCDTEFD
  1928         16  DD-STATE-FLDS           OCCURS 16 TIMES              ELCDTEFD
  1929                                     PIC  X(06).                  ELCDTEFD
  1930     12  DD-CARR-DATA REDEFINES DD-TLR-DATA.                      ELCDTEFD
  1931         16  DD-CARR-FLDS            OCCURS 13 TIMES              ELCDTEFD
  1932                                     PIC  X(07).                  ELCDTEFD
  1933         16  FILLER                  PIC  X(05).                  ELCDTEFD
  1934     12  DD-MISC-DATA REDEFINES DD-TLR-DATA                       ELCDTEFD
  1935                                     PIC  X(96).                  ELCDTEFD
  1936******************************************************************ELCDTEFD
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  41
* ECS010Z.cbl
  1938 FD  PRINT-COPY
* 1939                             COPY ELCPRTFD.
  1940******************************************************************04/15/98
  1941*                                                                *ELCPRTFD
  1942*                                                                *ELCPRTFD
  1943*                            ELCPRTFD.                           *   LV003
  1944*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
  1945*                            VMOD=2.006                          *ELCPRTFD
  1946******************************************************************ELCPRTFD
  1947     RECORDING MODE F                                             ELCPRTFD
  1948     LABEL RECORDS OMITTED                                        ELCPRTFD
  1949     BLOCK CONTAINS 0 RECORDS
  1950     RECORD CONTAINS 133 CHARACTERS.                              ELCPRTFD
  1951 01  PRT.                                                         ELCPRTFD
  1952     12  P-CTL               PIC  X.                                 CL**2
  1953     12  P-DATA              PIC  X(132).                         ELCPRTFD
  1954******************************************************************ELCPRTFD
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  42
* ECS010Z.cbl
  1956 FD  MISMATCH-REPORT
  1957     RECORDING MODE F.
  1958
  1959 01  MISMATCH-RPT.
  1960     12  MR-CTL              PIC X.
  1961     12  MR-DATA             PIC X(132).
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  43
* ECS010Z.cbl
  1963 FD  FICH
* 1964                             COPY ELCFCHFD.
  1965******************************************************************04/15/98
  1966*                                                                *ELCFCHFD
  1967*                            ELCFCHFD.                           *   LV003
  1968*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  1969*                            VMOD=2.004                          *   CL**3
  1970*                                                                *ELCFCHFD
  1971******************************************************************ELCFCHFD
  1972     BLOCK CONTAINS 0 RECORDS
  1973     RECORDING MODE F.                                            ELCFCHFD
  1974                                                                  ELCFCHFD
  1975 01  FICH-REC                            PIC   X(133).            ELCFCHFD
  1976******************************************************************ELCFCHFD
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  44
* ECS010Z.cbl
  1978 FD  DISPLAY-PRT
  1979     RECORDING MODE IS F
  1980     LABEL RECORDS ARE STANDARD
  1981     BLOCK CONTAINS 0 RECORDS
  1982     RECORD CONTAINS 133 CHARACTERS.
  1983
  1984 01  DISPLAY-REC.
  1985     05  DISPLAY-CC           PIC X.
  1986     05  DISPLAY-INFO         PIC X(132).
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  45
* ECS010Z.cbl
  1988 WORKING-STORAGE SECTION.
  1989 77  LCP-ASA                       PIC X.
  1990 77  FILLER  PIC X(32)  VALUE '********************************'.
  1991 77  FILLER  PIC X(32)  VALUE '*     ECS010 WORKING-STORAGE    '.
  1992 77  FILLER  PIC X(32)  VALUE '******** VMOD=2.082 ************'.
  1993
  1994 77  ERROR-COUNT             PIC 9(7)            VALUE ZEROS.
  1995 77  DIS-LINE-CNT            PIC 99              VALUE ZEROS.
  1996 77  PGM-SUB                 PIC S999    COMP    VALUE +010.
  1997 77  FIRST-ACCOUNT           PIC S9      COMP-3  VALUE +1.
  1998 77  FIRST-CERT              PIC S9      COMP-3  VALUE +1.
  1999 77  TR-CNT                  PIC S9(5)   COMP-3  VALUE +0.
  2000 77  CMIN-CNT                PIC S9(7)   COMP-3  VALUE +0.
  2001 77  CMOT-CNT                PIC S9(7)   COMP-3  VALUE +0.
  2002 77  DE-CNT                  PIC S9(7)   COMP-3  VALUE +0.
  2003 77  EP-CNT                  PIC S9(7)   COMP-3  VALUE +0.
  2004 77  LN-CNT                  PIC S999    COMP-3  VALUE +61.
  2005 77  PG-CNT                  PIC S9(5)   COMP-3  VALUE +0.
  2006 77  DUP-CNT                 PIC S9(5)   COMP-3  VALUE +0.
  2007 77  DISABILITY-TBL-MAX      PIC S9              VALUE +5.
  2008 77  DUP-MAX                 PIC S9(5)   COMP-3  VALUE +500.
  2009 77  RANGE-CNT               PIC S999    COMP-3  VALUE +0.
  2010 77  ERACCTT-READS           PIC S9(7)   COMP-3  VALUE +0.
  2011 77  ERRTBL-READS            PIC S9(7)   COMP-3  VALUE +0.
  2012 77  ERCTBL-READS            PIC S9(7)   COMP-3  VALUE +0.
  2013 77  FLA-CLM-REIN-BASE       PIC S9(9)V99 COMP-3.
  2014 77  WK-RATE                 PIC S99V9(5) COMP-3 VALUE +0.
  2015 77  COMM-CK-AMT             PIC S9(9)V99 COMP-3 VALUE +0.
  2016 77  ADJ-FLA-REIN-BASE       PIC S9(9)V9(4) COMP-3.
  2017 77  ISS-WK                  PIC S9(9)V99 COMP-3 VALUE +0.
  2018 77  CNC-WK                  PIC S9(9)V99 COMP-3 VALUE +0.
  2019 77  COMM-WK                 PIC S9(9)V99 COMP-3 VALUE +0.
  2020 77  X                       PIC X.
  2021 77  DD-FLG                  PIC X               VALUE SPACE.
  2022 77  AGT-SW                  PIC X               VALUE SPACE.
  2023 77  RC-COMM-FLG             PIC X               VALUE SPACE.
  2024 77  RECALC-TYPE             PIC X               VALUE SPACE.
  2025 77  LIFE-REFUND             PIC S9(7)V99        COMP-3.
  2026 77  LIFE-REFUND-CALC        PIC S9(7)V99        COMP-3.
  2027 77  A-H-REFUND              PIC S9(7)V99        COMP-3.
  2028 77  A-H-REFUND-CALC         PIC S9(7)V99        COMP-3.
  2029 77  YTD-CANCEL-CNT          PIC S9(3)           COMP-3.
  2030 77  MISMATCH-COUNT          PIC S9(5)           VALUE +0.
  2031 77  MISMATCH-LINE-COUNT     PIC S9(5)           VALUE +99.
  2032 77  MISMATCH-PAGE-NUMBER    PIC S9(5)           VALUE +0.
  2033 77  SV-HI-CERT              PIC 9(11)           VALUE ZEROS.
  2034 77  SV-LO-CERT              PIC 9(11)           VALUE ZEROS.
  2035 77  LST-TRD-CERT            PIC X(11)           VALUE SPACES.
  2036 77  SV-TRD-CERT             PIC X(11).
  2037 77  LST-TRD-ISDT            PIC X(10)           VALUE SPACES.
  2038 77  SV-TRD-ISDT             PIC X(10).
  2039 77  SAVE-EXTRACT            PIC X(510)          VALUE SPACES.
  2040*77  W-TLR                   PIC S9(01)V9(04) COMP-3 VALUE +.40.
  2041*77  W-AH-FACTOR             PIC S9(01)V9(04) COMP-3 VALUE +.50.
  2042 77  W-EPEC-EP               PIC S9(11)V9(02) COMP-3 VALUE +0.
  2043 77  W-EPEC-EP-IN            PIC S9(11)V9(02) COMP-3 VALUE +0.
  2044 77  W-EPEC-EP-1             PIC S9(11)V9(02) COMP-3 VALUE +0.
  2045 77  W-EPEC-EP-2             PIC S9(11)V9(02) COMP-3 VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  46
* ECS010Z.cbl
  2046 77  W-P-EP                  PIC S9(11)V9(02) COMP-3 VALUE +0.
  2047 77  W-M-EP                  PIC S9(11)V9(02) COMP-3 VALUE +0.
  2048 77  W-R-EP                  PIC S9(11)V9(02) COMP-3 VALUE +0.
  2049 77  W-WY-EP                 PIC S9(11)V9(02) COMP-3 VALUE +0.
  2050 77  W-VA-EP                 PIC S9(11)V9(02) COMP-3 VALUE +0.
  2051 77  W-1-EP                  PIC S9(11)V9(02) COMP-3 VALUE +0.
  2052 77  W-OTHERS-COUNT          PIC S9(11)       COMP-3 VALUE +0.
  2053 77  W-AH-CLAIM-EP           PIC S9(11)V9(02) COMP-3 VALUE +0.
  2054 77  W-AH-CLAIM-CTR          PIC S9(11)       COMP-3 VALUE +0.
  2055 77  W-EP-LESS-THAN-0        PIC S9(11)       COMP-3 VALUE +0.
  2056 77  W-CLAIMS-MADE-PAID-IN   PIC S9(11)V9(02) COMP-3 VALUE +0.
  2057 77  W-CLAIMS-MADE-PAID      PIC S9(11)V9(02) COMP-3 VALUE +0.
  2058 77  W-AH-IBNR               PIC S9(11)V9(02) COMP-3 VALUE +0.
  2059 77  W-AH-IBNR-1             PIC S9(11)V9(02) COMP-3 VALUE +0.
  2060 77  W-AH-IBNR-1-CNT         PIC S9(11)       COMP-3 VALUE +0.
  2061 77  W-AH-IBNR-2             PIC S9(11)V9(02) COMP-3 VALUE +0.
  2062 77  W-AH-IBNR-2-CNT         PIC S9(11)       COMP-3 VALUE +0.
  2063 77  W-LIFE-IBNR             PIC S9(11)V9(02) COMP-3 VALUE +0.
  2064 77  W-LIFE-IBNR-IN          PIC S9(11)V9(02) COMP-3 VALUE +0.
  2065 77  W-LIFE-REMAINING-AMT    PIC S9(11)V9(02) COMP-3 VALUE +0.
  2066 77  W-RTRM-0-CLMAMT         PIC S9(11)V9(02) COMP-3 VALUE +0.
  2067 77  W-CLM-EXCEPT-CNT        PIC S9(11)       COMP-3 VALUE +0.
  2068 77  W-CLM-EXCEPT-AMT        PIC S9(11)V9(02) COMP-3 VALUE +0.
  2069 77  W-RTRM-0-CNT            PIC S9(11)       COMP-3 VALUE +0.
  2070 77  W-RTRM-EP-1             PIC S9(11)V9(02) COMP-3 VALUE +0.
  2071 77  W-RTRM-EP-2             PIC S9(11)V9(02) COMP-3 VALUE +0.
  2072 77  W-RTRM-EP               PIC S9(11)V9(02) COMP-3 VALUE +0.
  2073 77  W-01-REMAMT             PIC S9(11)V9(02) COMP-3 VALUE +0.
  2074 77  W-01-DATA-USED          PIC S9(11)       COMP-3 VALUE +0.
  2075 77  W-02-REMAMT             PIC S9(11)V9(02) COMP-3 VALUE +0.
  2076 77  W-02-DATA-USED          PIC S9(11)       COMP-3 VALUE +0.
  2077 77  W-03-REMAMT             PIC S9(11)V9(02) COMP-3 VALUE +0.
  2078 77  W-03-DATA-USED          PIC S9(11)       COMP-3 VALUE +0.
  2079 77  W-04-REMAMT             PIC S9(11)V9(02) COMP-3 VALUE +0.
  2080 77  W-04-DATA-USED          PIC S9(11)       COMP-3 VALUE +0.
  2081 77  W-05-REMAMT             PIC S9(11)V9(02) COMP-3 VALUE +0.
  2082 77  W-05-DATA-USED          PIC S9(11)       COMP-3 VALUE +0.
  2083 77  W-06-REMAMT             PIC S9(11)V9(02) COMP-3 VALUE +0.
  2084 77  W-06-DATA-USED          PIC S9(11)       COMP-3 VALUE +0.
  2085 77  W-30-REMAMT             PIC S9(11)V9(02) COMP-3 VALUE +0.
  2086 77  W-30-DATA-USED          PIC S9(11)       COMP-3 VALUE +0.
  2087 77  W-31-REMAMT             PIC S9(11)V9(02) COMP-3 VALUE +0.
  2088 77  W-31-DATA-USED          PIC S9(11)       COMP-3 VALUE +0.
  2089 77  W-XX-REMAMT             PIC S9(11)V9(02) COMP-3 VALUE +0.
  2090 77  WS-TOT-PRM-AMT          PIC S9(11)V9(02) COMP-3 VALUE +0.
  2091 77  W-XX-DATA-USED          PIC S9(11)       COMP-3 VALUE +0.
  2092 77  W-MM-LF-PRM             PIC S9(7)V99     COMP-3 VALUE +0.
  2093 77  W-MM-AH-PRM             PIC S9(7)V99     COMP-3 VALUE +0.
  2094 77  W-MM-LF-RFD             PIC S9(7)V99     COMP-3 VALUE +0.
  2095 77  W-MM-AH-RFD             PIC S9(7)V99     COMP-3 VALUE +0.
  2096 77  W-MM-LF-CLM             PIC S9(7)V99     COMP-3 VALUE +0.
  2097 77  W-MM-AH-CLM             PIC S9(7)V99     COMP-3 VALUE +0.
  2098 77  WS-CEDE-FACT            PIC S9V9(4)      COMP-3 VALUE +0.
  2099 77  WS-SAVE-CARR            PIC X                   VALUE ' '.
  2100 77  WS-LOOP-MAX             PIC S99          COMP-3 VALUE +10.
  2101 77  WS-CR-PMT-FREQ          PIC 99           VALUE ZEROS.
  2102 77  WS-WE-LFPRM             PIC S9(7)V99    COMP-3 VALUE +0.
  2103
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  47
* ECS010Z.cbl
  2104 01  MONTH-END-DATA.
  2105     12  ME-START-DATE.
  2106         16  ME-START-MO         PIC 99.
  2107         16  FILLER              PIC X.
  2108         16  ME-START-DA         PIC 99.
  2109         16  FILLER              PIC X.
  2110         16  ME-START-YR         PIC 99.
  2111     12  ME-CNDS-DATE            PIC 9(6).
  2112     12  ME-CNDS-DATE-R REDEFINES ME-CNDS-DATE.
  2113         16  ME-CNDS-MO          PIC 99.
  2114         16  ME-CNDS-DA          PIC 99.
  2115         16  ME-CNDS-YR          PIC 99.
  2116     12  ME-START-TIME           PIC 9(6).
  2117     12  ME-UPDATE-FLAG          PIC X VALUE 'Y'.
  2118         88  ME-DO-UPDATE        VALUE 'Y'.
  2119         88  ME-NO-UPDATE        VALUE 'N'.
  2120     12  MONTH-END-MOYR          PIC S9(5) COMP-3.
  2121
  2122 01  PENDING-MATCH-CONTROL.
  2123     12  PENDING-ACCOUNT-CONTROL.
  2124         16  PEND-MATCH-CARRIER    PIC X.
  2125         16  PEND-MATCH-GROUPING   PIC X(6).
  2126         16  PEND-MATCH-STATE      PIC XX.
  2127         16  PEND-MATCH-ACCOUNT    PIC X(10).
  2128     12  PEND-MATCH-EFF-DTE        PIC 9(11) COMP-3.
  2129     12  PEND-MATCH-CERT-NO.
  2130         16  PEND-MATCH-CERT       PIC X(10).
  2131         16  PEND-MATCH-CERT-SFX   PIC X.
  2132 01  PENDING-RECORD-TYPE           PIC X.
  2133     88  ISSUE-TRANSACTION            VALUE '1'.
  2134     88  CANCEL-TRANSACTION           VALUE '2'.
  2135     88  CLAIM-TRANSACTION            VALUE '3'.
  2136     88  RESERVE-TRANSACTION          VALUE '4'.
  2137     88  UPDATE-TRANSACTION           VALUE '5'.
  2138
  2139 01  CLM-INCUR-REIN-DATE.
  2140     12  CIRD-CCYY.
  2141         16  CIRD-CC         PIC 99.
  2142         16  CIRD-YR         PIC 99.
  2143     12  CIRD-MO             PIC 99.
  2144
  2145 01  HIGH-CERT               PIC 9(11)           VALUE ZEROS.
  2146
  2147 01  LOW-CERT                PIC 9(11)           VALUE ZEROS.
  2148
  2149 01  REIN-BILLING-TABLE.
  2150     12  REIN-CO-ENTRIES OCCURS 50 TIMES.
  2151         16  RB-COMPANY      PIC X(6).
  2152         16  RB-COUNT        PIC S9(5)   COMP-3.
  2153
  2154 01  B-SUB                   PIC S9(4)   COMP.
  2155
  2156 01  BINARY-COUNTERS     COMP      SYNC.
  2157     12  IA                  PIC S999            VALUE +0.
  2158     12  IB                  PIC S999            VALUE +0.
  2159     12  SUB                 PIC S999            VALUE +0.
  2160     12  SUBM                PIC S999            VALUE +0.
  2161     12  SUB3                PIC S999            VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  48
* ECS010Z.cbl
  2162     12  SUB4                PIC S999            VALUE +0.
  2163     12  SUB5                PIC S999            VALUE +0.
  2164     12  SUB6                PIC S999            VALUE +0.
  2165     12  SUB7                PIC S999            VALUE +0.
  2166     12  SUB8                PIC S999            VALUE +0.
  2167     12  SUB9                PIC S999            VALUE +0.
  2168     12  SUB10               PIC S999            VALUE +0.
  2169     12  SUB11               PIC S999            VALUE +0.
  2170     12  SUB12               PIC S999            VALUE +0.
  2171     12  SUB13               PIC S999            VALUE +0.
  2172     12  SUB14               PIC S999            VALUE +0.
  2173     12  SUB15               PIC S999            VALUE +0.
  2174     12  SUB16               PIC S999            VALUE +0.
  2175     12  LEVELS-BUILT        PIC S999            VALUE +0.
  2176 01  WS-SEQ-NBR              PIC 9               VALUE ZERO.
  2177
  2178 01  WS.
  2179     12  WS-RETURN-CODE        PIC S9(4)   COMP   VALUE +0.
  2180     12  WS-ABEND-MESSAGE      PIC X(80)          VALUE SPACES.
  2181     12  WS-ABEND-FILE-STATUS  PIC XX             VALUE ZEROS.
  2182     12  WS-ZERO               PIC S9      COMP-3 VALUE +0.
  2183
  2184     12  WS-ABEND-CODE         PIC 9(4).
  2185     12  ABEND-CODE  REDEFINES  WS-ABEND-CODE.
  2186         16  ABEND-CODE-1    PIC XX.
  2187         16  ABEND-CODE-2.
  2188             20  AC2-ONE     PIC X.
  2189             20  AC2-TWO     PIC X.
  2190
  2191     12  CTBL-SEARCH.
  2192         16  CTBL-COMP-CD    PIC X.
  2193         16  CTBL-TABLE-CD   PIC XXX.
  2194         16  CTBL-BEN-TYPE   PIC X.
  2195         16  CTBL-BEN-CODE   PIC XX.
  2196     12  LAST-CTBL           PIC X(7)            VALUE SPACES.
  2197     12  COMM-OPEN-SW        PIC X               VALUE SPACES.
  2198     12  WS-COMM-TERM        PIC S999            COMP-3.
  2199     12  CTBL-ERROR-SWITCH   PIC X               VALUE SPACE.
  2200         88  CTBL-ERROR         VALUE '*'.
  2201
  2202     12  REIN-SPEC.
  2203         16  REIN-SPEC-A     PIC X.
  2204         16  REIN-SPEC-B     PIC X.
  2205         16  REIN-SPEC-C     PIC X.
  2206
  2207     12  WS-CHECK-NUMBER.
  2208         16  WS-CHECK-NO     PIC X(4).
  2209         16  FILLER          PIC XXX.
  2210
  2211     12  AH-EARN-METHOD      PIC X               VALUE SPACES.
  2212         88  AH-EARN-ANTICIPATION                VALUE 'A' 'C'.
  2213         88  AH-EARN-NET                         VALUE 'N'.
  2214
  2215 01  ERACCTT-FILE-STATUS     PIC XX VALUE ZEROS.
  2216 01  ERCTBL-FILE-STATUS      PIC XX VALUE ZEROS.
  2217 01  ERMEBL-FILE-STATUS      PIC XX VALUE ZEROS.
  2218 01  ERRTBL-FILE-STATUS      PIC XX VALUE ZEROS.
  2219 01  ERRESC-FILE-STATUS      PIC XX VALUE ZEROS.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  49
* ECS010Z.cbl
  2220
  2221 01  MONTHS-DIFF-LF          PIC S9(05) VALUE +0.
  2222 01  MONTHS-DIFF-AH          PIC S9(05) VALUE +0.
  2223 01  WS-CR-BIN-DATE          PIC XX VALUE LOW-VALUES.
  2224 01  WS-BIN-CANCEL-DATE      PIC XX VALUE LOW-VALUES.
  2225
  2226 01  WS-LEVELS-CHARGEBACK-SWITCHES.
  2227     12  WS-LF-CHARGEBACK-LEVELS.
  2228         16  WS-LF-CHARGEBACK-SW   PIC X(01) OCCURS 10 TIMES.
  2229     12  WS-AH-CHARGEBACK-LEVELS.
  2230         16  WS-AH-CHARGEBACK-SW   PIC X(01) OCCURS 10 TIMES.
  2231*****************************************************************
  2232*        WORKING STORAGE AREA FOR CLIENT-DMD               START*
  2233*****************************************************************
  2234*RESIDENT STATE TAXES MASTER(ERRESC)
  2235*
  2236 01  WORK-AREAS.
  2237     12  WS-ERRESC-KEY.
  2238         16 WS-ERRESC-SEARCH-KEY.
  2239             20  WS-ERRESC-COMPANY-CD PIC  X.
  2240             20  WS-ERRESC-CARRIER    PIC  X.
  2241             20  WS-ERRESC-GROUP      PIC X(6).
  2242             20  WS-ERRESC-STATE      PIC XX.
  2243             20  WS-ERRESC-ACCOUNT    PIC X(10).
  2244         16 WS-ERRESC-RESIDUAL-KEY.
  2245             20  WS-ERRESC-AGENT      PIC X(10).
  2246             20  WS-ERRESC-RES-STATE  PIC XX.
  2247             20  WS-ERRESC-EXPIRE-DT  PIC 9(8) COMP-3.
  2248*                                          YYYYMMDD
  2249     12  WS-YYYYMMDD-DT               PIC 9(8).
  2250     12  WS-COMMISSION                PIC SV9(5) COMP-3.
  2251     12  WS-SUB                       PIC    99  COMP-3.
  2252     12  WS-SUB1                      PIC    99  COMP-3.
  2253*****************************************************************
  2254*        WORKING STORAGE AREA FOR CLIENT-DMD                 END*
  2255*****************************************************************
  2256
  2257 01  COMM-WORK-AREAS.
  2258     12  FILLER              PIC  X(17)
  2259         VALUE 'COMMON WORK AREAS'.
  2260     12  ACCT-COMM-LF        PIC SV9(5)  COMP-3.
  2261     12  ACCT-COMM-AH        PIC SV9(5)  COMP-3.
  2262     12  W-AH-ACTIVE         PIC S9(13)  COMP-3 VALUE ZEROS.
  2263     12  W-AH-CALC-B         PIC S9(13)  COMP-3 VALUE ZEROS.
  2264     12  W-AH-CLAIMS         PIC S9(13)  COMP-3 VALUE ZEROS.
  2265     12  W-AH-DATA-USED      PIC S9(13)  COMP-3 VALUE ZEROS.
  2266     12  W-AH-INACTIVE       PIC S9(13)  COMP-3 VALUE ZEROS.
  2267     12  W-AH-ISSUES         PIC S9(13)  COMP-3 VALUE ZEROS.
  2268     12  W-AH-REIN           PIC S9(13)  COMP-3 VALUE ZEROS.
  2269     12  W-AH-REISSUE        PIC S9(13)  COMP-3 VALUE ZEROS.
  2270     12  W-AH-REMTERM-0      PIC S9(13)  COMP-3 VALUE ZEROS.
  2271     12  W-AH-RESERVES       PIC S9(13)  COMP-3 VALUE ZEROS.
  2272     12  W-AH-RESV           PIC S9(13)  COMP-3 VALUE ZEROS.
  2273     12  W-AHTYP-99          PIC S9(13)  COMP-3 VALUE ZEROS.
  2274     12  W-BAL-REMTRM        PIC S9(05)V99  COMP-3.
  2275     12  W-CERT-COUNT        PIC S9(08)  COMP.
  2276     12  W-COUNT             PIC S9(08)  COMP   VALUE +0.
  2277     12  W-CLMAMT            PIC S9(07)V9(02)   VALUE ZEROS.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  50
* ECS010Z.cbl
  2278     12  W-90-DAY-MAX        PIC S9(07)V9(02)   VALUE ZEROS.
  2279
  2280     12  W-EARNED-PREMIUM    PIC S9(07)V9(02)
  2281                                         COMP-3 VALUE ZEROS.
  2282     12  W-EARNED-PREMIUM-1  PIC S9(07)V9(02)
  2283                                         COMP-3 VALUE ZEROS.
  2284     12  W-EARNED-PREMIUM-2  PIC S9(07)V9(02)
  2285                                         COMP-3 VALUE ZEROS.
  2286     12  W-EDIT-FIELD        PIC ----------9.
  2287     12  W-EDIT-FIELD2       PIC ----------9.99.
  2288     12  W-EDIT-7            PIC Z(06)9.
  2289     12  W-FACTOR            PIC S9(09)V9(08)
  2290                                         COMP-3 VALUE ZEROS.
  2291     12  W-IBNR-1            PIC S9(07)V9(02)
  2292                                         COMP-3 VALUE ZEROS.
  2293     12  W-IBNR-2            PIC S9(07)V9(02)
  2294                                         COMP-3 VALUE ZEROS.
  2295     12  W-ISS-BEN           PIC S9(11)V9(02)
  2296                                         COMP-3 VALUE ZEROS.
  2297     12  W-ISS-BEN-GROSS     PIC S9(11)V9(02)
  2298                                         COMP-3 VALUE ZEROS.
  2299     12  W-LF-ACTIVE         PIC S9(13)  COMP-3 VALUE ZEROS.
  2300     12  W-LF-BALLOON        PIC S9(13)  COMP-3 VALUE ZEROS.
  2301     12  W-LF-CLAIMS         PIC S9(13)  COMP-3 VALUE ZEROS.
  2302     12  W-LF-CALC-B         PIC S9(13)  COMP-3 VALUE ZEROS.
  2303     12  W-LF-DATA-USED      PIC S9(13)  COMP-3 VALUE ZEROS.
  2304     12  W-LF-INACTIVE       PIC S9(13)  COMP-3 VALUE ZEROS.
  2305     12  W-LF-ISSUES         PIC S9(13)  COMP-3 VALUE ZEROS.
  2306     12  W-LF-REMAMT-0       PIC S9(13)  COMP-3 VALUE ZEROS.
  2307     12  W-LF-REMTERM-0      PIC S9(13)  COMP-3 VALUE ZEROS.
  2308     12  W-LF-REIN           PIC S9(13)  COMP-3 VALUE ZEROS.
  2309     12  W-LF-REISSUE        PIC S9(13)  COMP-3 VALUE ZEROS.
  2310     12  W-LF-RESERVES       PIC S9(13)  COMP-3 VALUE ZEROS.
  2311     12  W-LF-RESV           PIC S9(13)  COMP-3 VALUE ZEROS.
  2312     12  W-LFTYP-99          PIC S9(13)  COMP-3 VALUE ZEROS.
  2313     12  W-LIFE-YEARS        PIC S9(09)  COMP-3 VALUE ZEROS.
  2314     12  W-LIFE-YEARS-INT    PIC S9(09)V9(06)
  2315                                         COMP-3 VALUE ZEROS.
  2316     12  W-NDX               PIC S9(03)  COMP-3 VALUE ZEROS.
  2317     12  W-ORGTRM-0-AH       PIC S9(13)  COMP-3 VALUE ZEROS.
  2318     12  W-ORGTRM-0-LF       PIC S9(13)  COMP-3 VALUE ZEROS.
  2319     12  W-RET-CODE-AH       PIC S9(13)  COMP-3 VALUE ZEROS.
  2320     12  W-RET-CODE-LF       PIC S9(13)  COMP-3 VALUE ZEROS.
  2321     12  W-PENDING-CLMS      PIC S9(13)  COMP-3 VALUE ZEROS.
  2322     12  W-POL-ISSUES        PIC S9(13)  COMP-3 VALUE ZEROS.
  2323     12  W-POLICY-ACTIVE-CTR PIC S9(13)  COMP-3 VALUE ZEROS.
  2324     12  W-POLICY-INACTIVE-CTR
  2325                             PIC S9(13)  COMP-3 VALUE ZEROS.
  2326     12  W-POLICY-REISSUE-CTR
  2327                             PIC S9(13)  COMP-3 VALUE ZEROS.
  2328     12  W-POLICY-REIN-CTR   PIC S9(13)  COMP-3 VALUE ZEROS.
  2329     12  W-POLICY-INACTIVE   PIC S9(13)  COMP-3 VALUE ZEROS.
  2330     12  W-TARGET-LOSS-RATIO PIC S9(01)V9(04)
  2331                                         COMP-3 VALUE ZEROS.
  2332     12  W-VAL-SOURCE        PIC S9(03)  COMP-3 VALUE ZEROS.
  2333     12  W-WK-IBNR           PIC S9(07)V9(02)
  2334                                         COMP-3 VALUE ZEROS.
  2335
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  51
* ECS010Z.cbl
  2336     12  W-CLAIM-TYPE        PIC  X(01).
  2337         88  W-A-H                              VALUE 'A'.
  2338         88  W-LIFE                             VALUE 'L'.
  2339     12  W-CUTOFF-DATE       PIC  9(08).
  2340     12  W-DIS-DT            PIC  XX.
  2341     12  W-DIS-PTO-DT        PIC  XX.
  2342     12  WK-LEVEL.
  2343         16  WK-AGT          PIC X(10).
  2344         16  WK-A-TYPE       PIC X.
  2345         16  WK-L-RT         PIC SV9(5)  COMP-3.
  2346         16  WK-J-RT         PIC SV9(5)  COMP-3.
  2347         16  WK-A-RT         PIC SV9(5)  COMP-3.
  2348         16  FILLER          PIC X(6).
  2349     12  WK-LEVEL-R REDEFINES WK-LEVEL.
  2350         16  FILLER          PIC X(11).
  2351         16  WK-L-RTX        PIC X(3).
  2352         16  WK-J-RTX        PIC X(3).
  2353         16  WK-A-RTX        PIC X(3).
  2354         16  FILLER          PIC X(6).
  2355     12  WK-NEW-RATES.
  2356         16  WK-N-R      OCCURS 10.
  2357             20  WK-N-AGT    PIC X(10).
  2358             20  WK-N-TYPE   PIC X.
  2359             20  WK-L-RT1    PIC SV9(5)  COMP-3.
  2360             20  WK-A-RT1    PIC SV9(5)  COMP-3.
  2361     12  W-LIFE-YEARS-ZERO.
  2362         16  FILLER          PIC  X(06)         VALUE ZEROS.
  2363         16  FILLER          PIC  X(01)         VALUE SPACES.
  2364         16  FILLER          PIC  X(02)         VALUE ZEROS.
  2365         16  FILLER          PIC  X(01)         VALUE SPACES.
  2366         16  FILLER          PIC  X(01)         VALUE SPACES.
  2367         16  FILLER          PIC  X(01)         VALUE SPACES.
  2368         16  FILLER          PIC S9(09)  COMP-3 VALUE ZEROS.
  2369         16  FILLER          PIC S9(09)  COMP-3 VALUE ZEROS.
  2370         16  FILLER          PIC S9(09)  COMP-3 VALUE ZEROS.
  2371         16  FILLER          PIC S9(09)  COMP-3 VALUE ZEROS.
  2372         16  FILLER          PIC S9(09)  COMP-3 VALUE ZEROS.
  2373         16  FILLER          PIC S9(09)  COMP-3 VALUE ZEROS.
  2374         16  FILLER          PIC S9(09)  COMP-3 VALUE ZEROS.
  2375         16  FILLER          PIC S9(09)  COMP-3 VALUE ZEROS.
  2376         16  FILLER          PIC S9(09)  COMP-3 VALUE ZEROS.
  2377         16  FILLER          PIC S9(09)  COMP-3 VALUE ZEROS.
  2378         16  FILLER          PIC S9(09)  COMP-3 VALUE ZEROS.
  2379         16  FILLER          PIC S9(09)  COMP-3 VALUE ZEROS.
  2380         16  FILLER          PIC S9(09)  COMP-3 VALUE ZEROS.
  2381         16  FILLER          PIC S9(09)V9(02) COMP-3
  2382                                                VALUE ZEROS.
  2383         16  FILLER          PIC S9(09)V9(02) COMP-3
  2384                                                VALUE ZEROS.
  2385         16  FILLER          PIC S9(09)V9(02) COMP-3
  2386                                                VALUE ZEROS.
  2387         16  FILLER          PIC S9(09)V9(02) COMP-3
  2388                                                VALUE ZEROS.
  2389         16  FILLER          PIC S9(11)V9(02) COMP-3
  2390                                                VALUE ZEROS.
  2391
  2392     12  W-REIN-PROCESS-IND  PIC  X(01)         VALUE SPACES.
  2393         88 W-REIN-IN-PROCESS                   VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  52
* ECS010Z.cbl
  2394     12  W-REIN-PROCESS-SW   PIC  X(01)         VALUE SPACES.
  2395         88  W-REIN-PROCESS                     VALUE 'Y'.
  2396         88  W-NOT-REIN-PROCESS                 VALUE SPACES.
  2397     12  W-SELECTION-SW      PIC  X(01)         VALUE SPACES.
  2398         88  W-SELECTION-ON                     VALUE 'Y'.
  2399         88  W-SELECTION-OFF                    VALUE SPACES.
  2400     12  W-RTRM-0-SW         PIC  X(01)         VALUE SPACES.
  2401         88  W-RTRM-0                           VALUE 'Y'.
  2402         88  W-RTRM-NOT-0                       VALUE SPACES.
  2403     12  W-SUB-KEY           PIC  X(03)         VALUE SPACES.
  2404     12  W-TABLE-USED-SW     PIC  X(01)         VALUE SPACES.
  2405         88  W-TABLE-USED                       VALUE 'Y'.
  2406         88  W-TABLE-NOT-USED                   VALUE SPACES.
  2407     12  W-UNDERWRITING-SW   PIC  X             VALUE SPACES.
  2408         88  W-UNDERWRITTEN-DATA                VALUE '*'.
  2409
  2410     12  W-VAL-ERRORS.
  2411         16  FILLER          PIC  X(40)
  2412             VALUE 'PENDING CANC PROCESS - CR-LF-CANC-DT - '.
  2413         16  FILLER          PIC  X(40)
  2414             VALUE 'EPEC PROCESS - LIFE - RUN DATE - '.
  2415         16  FILLER          PIC  X(40)
  2416             VALUE 'EPEC CANCEL - LIFE - CR-LF-CANC-DT - '.
  2417         16  FILLER          PIC  X(40)
  2418             VALUE 'EPEC CANCEL LIFE SUM - CR-LF-CANC-DT - '.
  2419         16  FILLER          PIC  X(40)
  2420             VALUE 'EOM RUN DATE - EPEC - COMM - '.
  2421         16  FILLER          PIC  X(40)
  2422             VALUE 'RUN DATE EPEC - A&H - '.
  2423         16  FILLER          PIC  X(40)
  2424             VALUE 'CUTOFF DTE (OPT-MTHD) - '.
  2425         16  FILLER          PIC  X(40)
  2426             VALUE 'EOM RUN DATE - A&H EARNED PREMIUM - '.
  2427         16  FILLER          PIC  X(40)
  2428             VALUE 'EARNINGS START DATE - REIN CO RCD - '.
  2429     12  FILLER REDEFINES W-VAL-ERRORS.
  2430         16  W-VAL-ERROR OCCURS 9 TIMES
  2431                             PIC  X(40).
  2432
  2433     12  W-WORK-DATE         PIC  X(02).
  2434     12  SAVE-WK-NEW-RATES.
  2435         16  FILLER          PIC X(170).
  2436
  2437***   The following data area is for NCL only
  2438*    12  W-WORK-OB-DATA OCCURS 300.
  2439*    12  W-WORK-OB-DATA OCCURS 220.
  2440     12  W-WORK-OB-DATA OCCURS 900.
  2441         16  WS-OB-REIN-CO       PIC X(06).
  2442         16  WS-OB-LF-AH         PIC X.
  2443         16  WS-OB-BENEFIT-CODE  PIC XX.
  2444         16  WS-OB-EARNED OCCURS 3.
  2445             20  WS-EPR-R78   PIC S9(09)V99 COMP-3.
  2446
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  53
* ECS010Z.cbl
  2448 01  EPEC-WORK-AREAS.
  2449     12  WE-REIN-CO          PIC X(6).
  2450     12  WE-LF-AH            PIC X.
  2451     12  WE-BEN-TYPE         PIC XX.
  2452     12  WE-LFAMT            PIC S9(9)V99    COMP-3.
  2453     12  WE-LFPRM            PIC S9(7)V99    COMP-3.
  2454     12  WE-LFAMT-ALT        PIC S9(9)V99    COMP-3.
  2455     12  WE-LFPRM-ALT        PIC S9(7)V99    COMP-3.
  2456     12  WE-LFRFND           PIC S9(7)V99    COMP-3.
  2457     12  WE-DTHAMT           PIC S9(9)V99    COMP-3.
  2458     12  WE-DTHEXP           PIC S9(9)V99    COMP-3.
  2459     12  WE-NUM-DTH-CLM      PIC S999        COMP-3.
  2460     12  WE-DTH-IBNR         PIC S9(7)V99    COMP-3.
  2461     12  WE-DTH-PAYCUR       PIC S9(7)V99    COMP-3.
  2462     12  WE-DTH-FUTRSV       PIC S9(7)V99    COMP-3.
  2463     12  WE-AHAMT            PIC S9(9)V99    COMP-3.
  2464     12  WE-AHPRM            PIC S9(7)V99    COMP-3.
  2465     12  WE-AHRFND           PIC S9(7)V99    COMP-3.
  2466     12  WE-DSPY-AMT         PIC S9(9)V99    COMP-3.
  2467     12  WE-DSPY-EXP         PIC S9(9)V99    COMP-3.
  2468     12  WE-NUM-DIS-CLM      PIC S999        COMP-3.
  2469     12  WE-DIS-IBNR         PIC S9(7)V99    COMP-3.
  2470     12  WE-DIS-PAYCUR       PIC S9(7)V99    COMP-3.
  2471     12  WE-DIS-FUTRSV       PIC S9(7)V99    COMP-3.
  2472     12  ISS-BEN             PIC S9(9)V99    COMP-3.
  2473     12  CNC-BEN             PIC S9(9)V99    COMP-3.
  2474     12  ISS-PRM             PIC S9(7)V99    COMP-3.
  2475     12  ISS-PRMTAX          PIC S9(7)V99    COMP-3.
  2476     12  CNC-PRM             PIC S9(7)V99    COMP-3.
  2477     12  GROSS-ISS-BEN-LF    PIC S9(9)V99    COMP-3.
  2478     12  GROSS-CNC-BEN-LF    PIC S9(9)V99    COMP-3.
  2479     12  GROSS-ISS-PRM-LF    PIC S9(7)V99    COMP-3.
  2480     12  GROSS-CNC-PRM-LF    PIC S9(7)V99    COMP-3.
  2481     12  GROSS-ISS-BEN-AH    PIC S9(7)V99    COMP-3.
  2482     12  GROSS-CNC-BEN-AH    PIC S9(7)V99    COMP-3.
  2483     12  GROSS-ISS-PRM-AH    PIC S9(7)V99    COMP-3.
  2484     12  GROSS-CNC-PRM-AH    PIC S9(7)V99    COMP-3.
  2485     12  EARNED-BY-CANCEL    PIC S9(7)V99    COMP-3.
  2486     12  EPR-R78             PIC S9(7)V99    COMP-3.
  2487     12  EPR-PRO             PIC S9(7)V99    COMP-3.
  2488     12  EPR-ST              PIC S9(7)V99    COMP-3.
  2489     12  W-OPT-R78           PIC S9(7)V99    COMP-3.
  2490     12  W-OPT-PRO           PIC S9(7)V99    COMP-3.
  2491     12  W-OPT-ST            PIC S9(7)V99    COMP-3.
  2492     12  WX-ACTIVE-COUNT     PIC S9          COMP-3.
  2493     12  WX-CANC-DT          PIC 9(11)       COMP-3.
  2494     12  WX-CLM-AMT          PIC S9(9)V99    COMP-3.
  2495     12  WX-CLM-EXP          PIC S9(9)V99    COMP-3.
  2496     12  WX-CLM-CNT          PIC S9(7)       COMP-3.
  2497     12  WX-CLM-CRT          PIC S9(7)       COMP-3.
  2498     12  WX-CNC-CNT          PIC S9(7)       COMP-3.
  2499     12  WX-CLAIM-EXIT-DATE  PIC  9(11)      COMP-3.
  2500     12  WX-SETTLEMENT-EXIT-DATE
  2501                             PIC  9(11)      COMP-3.
  2502     12  WX-STATUS-AT-CANCEL PIC  X(1).
  2503     12  WX-STATUS-AT-DEATH  PIC  X(1).
  2504     12  WX-STATUS-AT-SETTLEMENT
  2505                             PIC  X(1).
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  54
* ECS010Z.cbl
  2506     12  WX-EOM-RUN-DATE     PIC  9(11)      COMP-3.
  2507
  2508 01  EPEC-WORK.
  2509     12  EW-REIN-CO          PIC X(6).
  2510     12  EW-SUB-KEY.
  2511         16  EW-LF-AH        PIC X.
  2512         16  EW-BEN-TYPE     PIC XX.
  2513     12  EW-ISS-BEN          PIC S9(11)V99   COMP-3.
  2514     12  EW-ISS-BEN-GROSS    PIC S9(11)V99   COMP-3.
  2515     12  EW-CNC-BEN          PIC S9(11)V99   COMP-3.
  2516     12  EW-CNC-BEN-GROSS    PIC S9(11)V99   COMP-3.
  2517     12  EW-ISS-PRM          PIC S9(9)V99    COMP-3.
  2518     12  EW-ISS-PRM-GROSS    PIC S9(9)V99    COMP-3.
  2519     12  EW-CNC-PRM          PIC S9(9)V99    COMP-3.
  2520     12  EW-CNC-PRM-GROSS    PIC S9(9)V99    COMP-3.
  2521     12  EW-EPR-R78          PIC S9(9)V99    COMP-3.
  2522     12  EW-EPR-R78-ADJ      PIC S9(9)V99    COMP-3.
  2523     12  EW-EPR-PRO          PIC S9(9)V99    COMP-3.
  2524     12  EW-EPR-PRO-ADJ      PIC S9(9)V99    COMP-3.
  2525     12  EW-EPR-ST           PIC S9(9)V99    COMP-3.
  2526     12  EW-EPR-ST-ADJ       PIC S9(9)V99    COMP-3.
  2527     12  EW-CLM-AMT          PIC S9(9)V99    COMP-3.
  2528     12  EW-CLM-IBNR         PIC S9(7)V99    COMP-3.
  2529     12  EW-CLM-PAYCUR       PIC S9(7)V99    COMP-3.
  2530     12  EW-CLM-FUTRSV       PIC S9(7)V99    COMP-3.
  2531     12  EW-CLM-CNT          PIC S9(7)       COMP-3.
  2532     12  EW-CLM-CRT          PIC S9(7)       COMP-3.
  2533     12  EW-ISS-CNT          PIC S9(7)       COMP-3.
  2534     12  EW-CNC-CNT          PIC S9(7)       COMP-3.
  2535     12  EW-ISS-PRM-TAX      PIC S9(7)V99    COMP-3.
  2536     12  EW-AGENTS       OCCURS 10.
  2537         16  EW-AGT-NO       PIC X(10).
  2538         16  EW-AGT-TYPE     PIC X.
  2539         16  EW-ISS-COM      PIC S9(9)V99    COMP-3.
  2540         16  EW-CNC-COM      PIC S9(9)V99    COMP-3.
  2541         16  EW-ECR-R78      PIC S9(9)V99    COMP-3.
  2542         16  EW-ECR-R78-ADJ  PIC S9(9)V99    COMP-3.
  2543         16  EW-ECR-PRO      PIC S9(9)V99    COMP-3.
  2544         16  EW-ECR-PRO-ADJ  PIC S9(9)V99    COMP-3.
  2545         16  EW-ECR-ST       PIC S9(9)V99    COMP-3.
  2546     12  EW-COV-DTE          PIC 9(11)       COMP-3.
  2547     12  EW-INFORCE-CNT      PIC S9(9)       COMP-3.
  2548     12  EW-ORIG-TERM        PIC S9(9)       COMP-3.
  2549     12  EW-REM-TERM         PIC S9(9)       COMP-3.
  2550     12  EW-AGE              PIC S9(9)       COMP-3.
  2551     12  EW-AGE-BEN          PIC S9(11)      COMP-3.
  2552     12  EW-TERM-BEN         PIC S9(11)      COMP-3.
  2553     12  EW-LEVEL-USED       PIC X.
  2554
  2555 01  EPEC-TOTALS.
  2556     12  EPEC-LEVELS     OCCURS 900.
  2557*    12  EPEC-LEVELS     OCCURS 220.
  2558*    12  EPEC-LEVELS     OCCURS 300.
  2559         16  EPEC-REIN-CO          PIC X(6).
  2560         16  EPEC-SUB-KEY.
  2561             24  EPEC-LF-AH        PIC X.
  2562             24  EPEC-BEN-TYPE     PIC XX.
  2563*        16  FILLER                PIC X(694).
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  55
* ECS010Z.cbl
  2564         16  FILLER                PIC X(699).
  2565     12  EPEC-LEVELS-END           PIC X(6).
  2566
  2567 01  EPEC-UNDERWRITTEN-TOTALS.
  2568     12  EPEC-LEVELS-II  OCCURS 900.
  2569*    12  EPEC-LEVELS-II  OCCURS 220.
  2570*    12  EPEC-LEVELS-II  OCCURS 300.
  2571         16  EPEC-REIN-CO-II       PIC X(6).
  2572         16  EPEC-SUB-KEY-II.
  2573             24  EPEC-LF-AH-II     PIC X.
  2574             24  EPEC-BEN-TYPE-II  PIC XX.
  2575*        16  FILLER                PIC X(694).
  2576         16  FILLER                PIC X(699).
  2577     12  EPEC-LEVELS-END-II        PIC X(6).
  2578
  2579
  2580 01  FILLER                      PIC  X(11)
  2581                                 VALUE 'OPT RSV TBL'.
  2582*
  2583* THE 'PIC' VALUE OF THE NEXT 2 DATA NAMES IS 300 OCCURANCES
  2584*  TIMES THE SIZE OF THE DATA NAME THAT OCCURS.
  2585*  EX: EPEC-OPT-GRP  (300) TIMES THE TOTAL SIZE OF FIELDS IN
  2586*      EPEC-OPT-GRP  (108)
  2587*
  2588*      300 X 108 = 32400.
  2589*
  2590 01  EPEC-OPT-DATA-TABLE.
  2591*    12  FILLER                  PIC X(32400).
  2592*    12  FILLER                  PIC X(23760).
  2593     12  FILLER                  PIC X(97200).
  2594
  2595 01  FILLER                      PIC  X(16)
  2596                                 VALUE 'OPT RSV TBL UNDW'.
  2597 01  EPEC-UNDW-OPT-DATA-TABLE.
  2598*    12  FILLER                  PIC X(32400).
  2599*    12  FILLER                  PIC X(23760).
  2600     12  FILLER                  PIC X(97200).
  2601
  2602 01  FILLER                      PIC  X(16)
  2603                                 VALUE 'OPT RSV TBL WORK'.
  2604 01  EPEC-OPT-WORK-TABLE.
  2605*    12  EPEC-OPT-GRP        OCCURS 300.
  2606*    12  EPEC-OPT-GRP        OCCURS 220.
  2607     12  EPEC-OPT-GRP        OCCURS 900.
  2608         16  EPEC-REIN-CO-OPT
  2609                             PIC  X(06).
  2610         16  EPEC-SUB-KEY-OPT.
  2611             24  EPEC-LF-AH-OPT
  2612                             PIC  X(01).
  2613             24  EPEC-BEN-TYPE-OPT
  2614                             PIC  X(02).
  2615         16  EPEC-OPT-DATA.
  2616             20  EPEC-REIN-ONLY-IND
  2617                             PIC  X(01).
  2618                 88  EPEC-REIN-ONLY-DATA   VALUE 'R'.
  2619             20  EPEC-LINE-NOT-USED-IND
  2620                             PIC  X(01).
  2621                 88  EPEC-LINE-NOT-USED    VALUE 'N'.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  56
* ECS010Z.cbl
  2622             20  EPEC-LIFE-CTR-USED-IND
  2623                             PIC  X(01).
  2624                 88  EPEC-LIFE-CTR-USED    VALUE 'Y'.
  2625                 88  EPEC-LIFE-CTR-NOT-USED
  2626                                           VALUE ' '.
  2627             20  EPEC-LIFE-CTR   OCCURS 13 TIMES
  2628                             PIC S9(09)       COMP-3.
  2629             20  EPEC-EARNED-PREMIUM-AH
  2630                             PIC S9(09)V9(02) COMP-3.
  2631             20  EPEC-CLAIMS-MADE-PAID
  2632                             PIC S9(09)V9(02) COMP-3.
  2633             20  EPEC-CLM-EXP
  2634                             PIC S9(09)V9(02) COMP-3.
  2635             20  EPEC-LIFE-IBNR
  2636                             PIC S9(09)V9(02) COMP-3.
  2637             20  EPEC-REIN-ISS-BEN
  2638                             PIC S9(11)V9(02) COMP-3.
  2639
  2640 01  FILLER                  PIC X(09)
  2641                                 VALUE 'EOM TABLE'.
  2642
  2643 01  EOM-DATE-TABLE.
  2644     12  EOM-DATE            OCCURS 13
  2645                             PIC 9(08).
  2646
  2647 01  EPEC-SUBS.
  2648     12  EPEC-SUB-LEVELS OCCURS 31.
  2649         16  EPEC-SUB-REIN   PIC X(6).
  2650         16  EPEC-SUB-LF     PIC S999  COMP  OCCURS 900.
  2651         16  EPEC-SUB-AH     PIC S999  COMP  OCCURS 900.
  2652     12  EPEC-SUBS-END       PIC X(6).
  2653
  2654 01  SAVE-REIN-WORK.
  2655     12  REIN-SUB-1          PIC S9(4)   COMP    VALUE +0.
  2656     12  REIN-SUB-2          PIC S9(4)   COMP    VALUE +0.
  2657     12  REIN-MAX            PIC S9(4)   COMP    VALUE +32.
  2658     12  REIN-LOW-TIME       PIC 9(6)            VALUE 999999.
  2659     12  REIN-LOW-SUB        PIC S9(4)   COMP    VALUE +1.
  2660
  2661 01  SAVE-REIN-TABLE.
  2662     12  SAVE-REIN-ENTRY     OCCURS 32 TIMES.
  2663         16  SR-TIME         PIC 9(6).
  2664         16  SR-ENTRY.
  2665             20  FILLER      PIC XX.
  2666             20  SR-CONTROL  PIC X(8).
  2667             20  FILLER      PIC X(3990).
  2668
  2669
* 2670                             COPY ECSRITAB.
  2671******************************************************************04/29/98
  2672*                                                                *ECSRITAB
  2673*                            ECSRITAB                            *   LV015
  2674*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL*15
  2675*                            VMOD=2.015                          *ECSRITAB
  2676*                                                                *ECSRITAB
  2677*  NO  CID  MODS  IN  COPYBOOK  ECSRITAB                         *ECSRITAB
  2678*                                                                *ECSRITAB
  2679******************************************************************ECSRITAB
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  57
* ECS010Z.cbl (/apps/prod/cid1p/copy/ECSRITAB)
  2680 01  REIN-WORK-AREAS.                                             ECSRITAB
  2681     12  RW-LFAMT                PIC S9(9)V99  VALUE +0   COMP-3. ECSRITAB
  2682     12  RW-AHWRK                PIC S9(9)V99  VALUE +0   COMP-3. ECSRITAB
  2683     12  RW-LFPRM                PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  2684     12  RW-LFPRMC               PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  2685     12  RW-LFRFND               PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  2686     12  RW-AHPRM                PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  2687     12  RW-AHPRMC               PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  2688     12  RW-AHRFND               PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  2689     12  RW-LFCLMWK              PIC S9(9)V99  VALUE +0   COMP-3. ECSRITAB
  2690     12  RW-AHCLMWK              PIC S9(9)V99  VALUE +0   COMP-3. ECSRITAB
  2691     12  RW-AH-INCURRED-DETAIL.                                   ECSRITAB
  2692         16  RW-AH-INCURRED-DATA OCCURS 5 TIMES.                  ECSRITAB
  2693             20  RW-AH-INCUR-DT  PIC 9(11) COMP-3.                   CL**2
  2694             20  RW-AH-CLM-AMT   PIC S9(9)V99             COMP-3. ECSRITAB
  2695             20  RW-AH-CLM-EXP   PIC S9(9)V99             COMP-3. ECSRITAB
  2696     12  RW-LFCLM                PIC S9(9)V99  VALUE +0   COMP-3. ECSRITAB
  2697     12  RW-AHCLM                PIC S9(9)V99  VALUE +0   COMP-3. ECSRITAB
  2698     12  RW-AH-LIMIT             PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  2699     12  RW-LFIBNR               PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  2700     12  RW-LFPAYCUR             PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  2701     12  RW-LFFUTRSV             PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  2702     12  RW-AHIBNR               PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  2703     12  RW-AHPAYCUR             PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  2704     12  RW-AHFUTRSV             PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  2705     12  RW-LFIBNRWK             PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  2706     12  RW-LFPAYCURWK           PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  2707     12  RW-LFFUTRSVWK           PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  2708     12  RW-AHIBNRWK             PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  2709     12  RW-AHPAYCURWK           PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  2710     12  RW-AHFUTRSVWK           PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  2711     12  RW-AHLIM-LO             PIC S9(9)V99  VALUE +0   COMP-3. ECSRITAB
  2712     12  RW-AHLIM-HI             PIC S9(9)V99  VALUE +0   COMP-3. ECSRITAB
  2713     12  RW-ACCUM-LF             PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  2714     12  RW-ACCUM-AH             PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  2715     12  RW-ACCUM-CLM            PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  2716     12  RW-ACCUM-IBNR           PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  2717     12  RW-ACCUM-PAYCUR         PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  2718     12  RW-ACCUM-FUTRSV         PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  2719                                                                  ECSRITAB
  2720 01  REIN-HOLD-AREAS.                                             ECSRITAB
  2721     12  REIN-LEVELS       OCCURS 30 TIMES.                       ECSRITAB
  2722         16  REIN-COMP               PIC X(6).                    ECSRITAB
  2723         16  REIN-LF-AH-FLGS.                                     ECSRITAB
  2724             20  REIN-LF-FLG         PIC X.                       ECSRITAB
  2725             20  REIN-AH-FLG         PIC X.                       ECSRITAB
  2726         16  REIN-WORK-FLDS.                                      ECSRITAB
  2727             20  REIN-LFAMT          PIC S9(9)V99   COMP-3.       ECSRITAB
  2728             20  REIN-LFPRM          PIC S9(7)V99   COMP-3.       ECSRITAB
  2729             20  REIN-AHAMT          PIC S9(7)V99   COMP-3.       ECSRITAB
  2730             20  REIN-AHPRM          PIC S9(7)V99   COMP-3.       ECSRITAB
  2731             20  REIN-LFRFND         PIC S9(7)V99   COMP-3.       ECSRITAB
  2732             20  REIN-AHRFND         PIC S9(7)V99   COMP-3.       ECSRITAB
  2733             20  REIN-LFCLM          PIC S9(9)V99   COMP-3.       ECSRITAB
  2734             20  REIN-AHCLM          PIC S9(9)V99   COMP-3.       ECSRITAB
  2735             20  REIN-LFCLML         PIC S9(9)V99   COMP-3.       ECSRITAB
  2736             20  REIN-AHCLML         PIC S9(9)V99   COMP-3.       ECSRITAB
  2737             20  REIN-DIS-IBNR       PIC S9(7)V99   COMP-3.       ECSRITAB
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  58
* ECS010Z.cbl (/apps/prod/cid1p/copy/ECSRITAB)
  2738             20  REIN-DIS-PAYCUR     PIC S9(7)V99   COMP-3.       ECSRITAB
  2739             20  REIN-DIS-FUTRSV     PIC S9(7)V99   COMP-3.       ECSRITAB
  2740             20  REIN-DIS-IBNRL      PIC S9(7)V99   COMP-3.       ECSRITAB
  2741             20  REIN-DIS-PAYCURL    PIC S9(7)V99   COMP-3.       ECSRITAB
  2742             20  REIN-DIS-FUTRSVL    PIC S9(7)V99   COMP-3.       ECSRITAB
  2743             20  REIN-DTH-IBNR       PIC S9(7)V99   COMP-3.       ECSRITAB
  2744             20  REIN-DTH-PAYCUR     PIC S9(7)V99   COMP-3.       ECSRITAB
  2745             20  REIN-DTH-FUTRSV     PIC S9(7)V99   COMP-3.       ECSRITAB
  2746             20  REIN-DTH-IBNRL      PIC S9(7)V99   COMP-3.       ECSRITAB
  2747             20  REIN-DTH-PAYCURL    PIC S9(7)V99   COMP-3.       ECSRITAB
  2748             20  REIN-DTH-FUTRSVL    PIC S9(7)V99   COMP-3.       ECSRITAB
  2749             20  REIN-AH-LIMIT       PIC S9(7)V99   COMP-3.       ECSRITAB
  2750             20  REIN-REM-SW         PIC X.                       ECSRITAB
  2751             20  REIN-REM-AH-100     PIC X.                       ECSRITAB
  2752             20  REIN-EP-STOP-DATE   PIC 9(11)      COMP-3.          CL**4
  2753             20  REIN-LF-RUNOFF-SW   PIC X.                       ECSRITAB
  2754             20  REIN-AH-RUNOFF-SW   PIC X.                       ECSRITAB
  2755     12  REIN-LEVELS-END             PIC X(6).                    ECSRITAB
  2756                                                                  ECSRITAB
  2757     12  RWF-FIELDS.                                              ECSRITAB
  2758         16  RWF-LFAMT               PIC S9(9)V99   COMP-3.       ECSRITAB
  2759         16  RWF-LFPRM               PIC S9(7)V99   COMP-3.       ECSRITAB
  2760         16  RWF-AHAMT               PIC S9(7)V99   COMP-3.       ECSRITAB
  2761         16  RWF-AHPRM               PIC S9(7)V99   COMP-3.       ECSRITAB
  2762         16  RWF-LFRFND              PIC S9(7)V99   COMP-3.       ECSRITAB
  2763         16  RWF-AHRFND              PIC S9(7)V99   COMP-3.       ECSRITAB
  2764         16  RWF-LFCLM               PIC S9(9)V99   COMP-3.       ECSRITAB
  2765         16  RWF-AHCLM               PIC S9(9)V99   COMP-3.       ECSRITAB
  2766         16  RWF-LFCLML              PIC S9(9)V99   COMP-3.       ECSRITAB
  2767         16  RWF-AHCLML              PIC S9(9)V99   COMP-3.       ECSRITAB
  2768         16  RWF-DIS-IBNR            PIC S9(7)V99   COMP-3.       ECSRITAB
  2769         16  RWF-DIS-PAYCUR          PIC S9(7)V99   COMP-3.       ECSRITAB
  2770         16  RWF-DIS-FUTRSV          PIC S9(7)V99   COMP-3.       ECSRITAB
  2771         16  RWF-DIS-IBNRL           PIC S9(7)V99   COMP-3.       ECSRITAB
  2772         16  RWF-DIS-PAYCURL         PIC S9(7)V99   COMP-3.       ECSRITAB
  2773         16  RWF-DIS-FUTRSVL         PIC S9(7)V99   COMP-3.       ECSRITAB
  2774         16  RWF-DTH-IBNR            PIC S9(7)V99   COMP-3.       ECSRITAB
  2775         16  RWF-DTH-PAYCUR          PIC S9(7)V99   COMP-3.       ECSRITAB
  2776         16  RWF-DTH-FUTRSV          PIC S9(7)V99   COMP-3.       ECSRITAB
  2777         16  RWF-DTH-IBNRL           PIC S9(7)V99   COMP-3.       ECSRITAB
  2778         16  RWF-DTH-PAYCURL         PIC S9(7)V99   COMP-3.       ECSRITAB
  2779         16  RWF-DTH-FUTRSVL         PIC S9(7)V99   COMP-3.       ECSRITAB
  2780         16  RWF-AH-LIMIT            PIC S9(7)V99   COMP-3.       ECSRITAB
  2781         16  RWF-REM-SW              PIC X.                       ECSRITAB
  2782         16  RWF-REM-AH-100          PIC X.                       ECSRITAB
  2783         16  RWF-EP-STOP-DATE        PIC 9(11)      COMP-3.          CL**3
  2784         16  RWF-LF-RUNOFF-SW        PIC X.                       ECSRITAB
  2785         16  RWF-AH-RUNOFF-SW        PIC X.                       ECSRITAB
  2786                                                                  ECSRITAB
  2787     12  WT-COMP-INFO.                                            ECSRITAB
  2788         16  WT-REI-COMP             PIC X(6).                    ECSRITAB
  2789         16  WT-LF-QC                PIC X.                       ECSRITAB
  2790         16  WT-AH-QC                PIC X.                       ECSRITAB
  2791         16  WT-LO-DATE              PIC 9(11)     COMP-3.           CL**2
  2792         16  WT-HI-DATE              PIC 9(11)     COMP-3.           CL**2
  2793         16  WT-LFAGE-LO             PIC 99.                      ECSRITAB
  2794         16  WT-LFAGE-HI             PIC 99.                      ECSRITAB
  2795         16  WT-AHAGE-LO             PIC 99.                      ECSRITAB
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  59
* ECS010Z.cbl (/apps/prod/cid1p/copy/ECSRITAB)
  2796         16  WT-AHAGE-HI             PIC 99.                      ECSRITAB
  2797         16  WT-LFTRM-LO             PIC S999       COMP-3.       ECSRITAB
  2798         16  WT-LFTRM-HI             PIC S999       COMP-3.       ECSRITAB
  2799         16  WT-AHTRM-LO             PIC S999       COMP-3.       ECSRITAB
  2800         16  WT-AHTRM-HI             PIC S999       COMP-3.       ECSRITAB
  2801         16  WT-LF-PCT               PIC S9V9999    COMP-3.       ECSRITAB
  2802         16  WT-AH-PCT               PIC S9V9999    COMP-3.       ECSRITAB
  2803         16  WT-LF-LIM-LO            PIC S9(9)V99   COMP-3.       ECSRITAB
  2804         16  WT-LF-LIM-HI            PIC S9(9)V99   COMP-3.       ECSRITAB
  2805         16  WT-LF-LO                PIC S9(9)V99   COMP-3.       ECSRITAB
  2806         16  WT-LF-HI                PIC S9(9)V99   COMP-3.       ECSRITAB
  2807         16  WT-AHBEN-LIM-LO         PIC S9(7)V99   COMP-3.       ECSRITAB
  2808         16  WT-AHBEN-LIM-HI         PIC S9(7)V99   COMP-3.       ECSRITAB
  2809         16  WT-AHBEN-LO             PIC S9(7)V99   COMP-3.       ECSRITAB
  2810         16  WT-AHBEN-HI             PIC S9(7)V99   COMP-3.       ECSRITAB
  2811         16  WT-AHMOA-LIM-LO         PIC S9(7)V99   COMP-3.       ECSRITAB
  2812         16  WT-AHMOA-LIM-HI         PIC S9(7)V99   COMP-3.       ECSRITAB
  2813         16  WT-AHMOA-LO             PIC S9(7)V99   COMP-3.       ECSRITAB
  2814         16  WT-AHMOA-HI             PIC S9(7)V99   COMP-3.       ECSRITAB
  2815         16  WT-LF-BEN-CODE          PIC X.                       ECSRITAB
  2816         16  WT-AH-BEN-CODE          PIC X.                       ECSRITAB
  2817         16  WT-INTERACTIVE          PIC X.                       ECSRITAB
  2818         16  WT-REMAINING            PIC X.                       ECSRITAB
  2819         16  FILLER                  PIC X(21).                   ECSRITAB
  2820                                                                  ECSRITAB
  2821 01  REIN-MISC-WORK-FIELDS.                                       ECSRITAB
  2822     12  SUB1                    PIC S9(4)       COMP.            ECSRITAB
  2823     12  SUB2                    PIC S9(4)       COMP.            ECSRITAB
  2824     12  CO-SUB                  PIC S9(4)       COMP.            ECSRITAB
  2825     12  INC-SUB                 PIC S999        COMP.            ECSRITAB
  2826     12  MORTALITY-SUB           PIC S999        COMP.            ECSRITAB
  2827     12  REIN-FACTOR             PIC S99V9(7)  COMP-3   VALUE +0. ECSRITAB
  2828     12  REIN-CALCED-LIFE        PIC S9(7)V99  COMP-3   VALUE +0. ECSRITAB
  2829     12  REIN-CALCED-AH          PIC S9(7)V99  COMP-3   VALUE +0. ECSRITAB
  2830     12  REIN-RISK-AMOUNT        PIC S9(11)V99 COMP-3   VALUE +0. ECSRITAB
  2831     12  REIN-MONTH-REDUCE       PIC S9(7)V99  COMP-3   VALUE +0. ECSRITAB
  2832     12  REIN-CEDE-TERM          PIC S999V99   COMP-3   VALUE +0. ECSRITAB
  2833     12  REIN-WORKA              PIC S999      COMP-3   VALUE +0. ECSRITAB
  2834     12  REIN-EARN-LF-TERM       PIC S999      COMP-3   VALUE +0. ECSRITAB
  2835     12  REIN-EARN-AH-TERM       PIC S999      COMP-3   VALUE +0. ECSRITAB
  2836     12  REIN-LCNC-EARN-TERM     PIC S999      COMP-3   VALUE +0. ECSRITAB
  2837     12  REIN-ACNC-EARN-TERM     PIC S999      COMP-3   VALUE +0. ECSRITAB
  2838     12  REIN-LF-CLM-MONTHS      PIC S999      COMP-3   VALUE +0. ECSRITAB
  2839     12  REIN-AH-CLM-MONTHS      PIC S999      COMP-3   VALUE +0. ECSRITAB
  2840     12  REIN-AH-CLM-MTH-1       PIC S999      COMP-3   VALUE +0. ECSRITAB
  2841     12  REIN-AH-CLM-MTH-2       PIC S999      COMP-3   VALUE +0. ECSRITAB
  2842     12  REIN-AH-CLM-MTH-3       PIC S999      COMP-3   VALUE +0. ECSRITAB
  2843     12  REIN-AH-CLM-MTH-4       PIC S999      COMP-3   VALUE +0. ECSRITAB
  2844     12  REIN-AH-CLM-MTH-5       PIC S999      COMP-3   VALUE +0. ECSRITAB
  2845     12  REIN-AH-PRIOR-CLMS-PAID PIC S9(11)V99 COMP-3   VALUE +0. ECSRITAB
  2846                                                                  ECSRITAB
  2847     12  REIN-VOID-LF-SW         PIC X    VALUE ' '.              ECSRITAB
  2848         88  VOIDING-LF-CANCEL            VALUE '*'.              ECSRITAB
  2849     12  REIN-VOID-AH-SW         PIC X    VALUE ' '.              ECSRITAB
  2850         88  VOIDING-AH-CANCEL            VALUE '*'.              ECSRITAB
  2851     12  REIN-ADDL-LF-SW         PIC X    VALUE ' '.              ECSRITAB
  2852         88  ADDITIONAL-LF-CANCEL         VALUE '*'.              ECSRITAB
  2853     12  REIN-ADDL-AH-SW         PIC X    VALUE ' '.              ECSRITAB
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  60
* ECS010Z.cbl (/apps/prod/cid1p/copy/ECSRITAB)
  2854         88  ADDITIONAL-AH-CANCEL         VALUE '*'.              ECSRITAB
  2855     12  REIN-CANCEL-LF-SW       PIC X    VALUE ' '.              ECSRITAB
  2856         88  FLAT-CANCEL-LF               VALUE '*'.              ECSRITAB
  2857     12  REIN-CANCEL-AH-SW       PIC X    VALUE ' '.              ECSRITAB
  2858         88  FLAT-CANCEL-AH               VALUE '*'.              ECSRITAB
  2859                                                                  ECSRITAB
  2860     12  REIN-BEN-CODE           PIC X.                           ECSRITAB
  2861         88  CEDING-SINGLE-PREM-ONLY      VALUE 'A'.              ECSRITAB
  2862         88  CEDING-OUT-BALANCE-ONLY      VALUE 'B'.              ECSRITAB
  2863         88  CEDING-REDUCING-ONLY         VALUE 'C'  'F'.         ECSRITAB
  2864         88  CEDING-LEVEL-ONLY            VALUE 'D'  'E'.         ECSRITAB
  2865         88  CEDING-GROUP-ONLY            VALUE 'G'.              ECSRITAB
  2866         88  CEDING-GROUP-RED-LIFE-ONLY   VALUE 'H'.              ECSRITAB
  2867         88  CEDING-INDIVIDUAL-ONLY       VALUE 'I'.              ECSRITAB
  2868         88  CEDING-JOINT-ONLY            VALUE 'J'.              ECSRITAB
  2869         88  CEDING-SGL-PREM-REDUCING     VALUE 'K'.              ECSRITAB
  2870         88  CEDING-SGL-PREM-GROUP        VALUE 'L'.              ECSRITAB
  2871         88  CEDING-GROUP-LEVEL-ONLY      VALUE 'M'.              ECSRITAB
  2872         88  CEDING-SGL-PREM-GRP-REDUCING VALUE 'N'.              ECSRITAB
  2873         88  CEDING-SGL-PREM-GROUP-LEVEL  VALUE 'P'.              ECSRITAB
  2874         88  CEDING-GROUP-REDUCING-ONLY   VALUE 'R'.              ECSRITAB
  2875         88  CEDING-SINGLE-POLICIES-ONLY  VALUE 'S'.              ECSRITAB
  2876         88  CEDING-AH-ONLY               VALUE '1'.              ECSRITAB
  2877         88  CEDING-PROPERTY-ONLY         VALUE '2'.              ECSRITAB
  2878         88  CEDING-UNEMPLOYMENT-ONLY     VALUE '3'.              ECSRITAB
  2879         88  CEDING-AD-D-ONLY             VALUE '4'.              ECSRITAB
  2880         88  CEDING-LIFE-ONLY             VALUE '5'.              ECSRITAB
  2881         88  CEDING-DISMEMBERMENT-ONLY    VALUE '6'.              ECSRITAB
  2882         88  CEDING-7-DAY-RETRO           VALUE '7'.              ECSRITAB
  2883         88  CEDING-14-DAY-RETRO          VALUE '8'.              ECSRITAB
  2884     12  REIN-OPEN-SW            PIC X           VALUE SPACE.     ECSRITAB
  2885     12  REIN-SEARCH.                                             ECSRITAB
  2886         16  REIN-SRCH-COMP-CD   PIC X           VALUE SPACE.     ECSRITAB
  2887         16  REIN-SRCH-CODE      PIC X           VALUE SPACE.     ECSRITAB
  2888         16  REIN-SRCH           PIC XXX         VALUE SPACE.     ECSRITAB
  2889         16  FILLER              PIC XXX         VALUE LOW-VALUE. ECSRITAB
  2890     12  SAVE-REIN-SRCH          PIC XXX         VALUE SPACE.     ECSRITAB
  2891     12  REIN-BUS-FLAG           PIC X           VALUE SPACE.     ECSRITAB
  2892     12  RATE-WORK               PIC S9(8)V9(5)  COMP-3.          ECSRITAB
  2893     12  RATE-WORK-L             PIC S9(8)V9(5)  COMP-3.          ECSRITAB
  2894     12  RATE-WORK-A             PIC S9(8)V9(5)  COMP-3.          ECSRITAB
  2895     12  RS-LIFE-BEN             PIC S9(9)V99  COMP-3   VALUE +0. ECSRITAB
  2896     12  RS-LIFE-PREM            PIC S9(7)V99  COMP-3   VALUE +0. ECSRITAB
  2897     12  RS-AH-BEN               PIC S9(9)V99  COMP-3   VALUE +0. ECSRITAB
  2898     12  RS-AH-PREM              PIC S9(7)V99  COMP-3   VALUE +0. ECSRITAB
  2899     12  RS-LP-CALC              PIC S9(7)V99  COMP-3   VALUE +0. ECSRITAB
  2900     12  RS-AP-CALC              PIC S9(7)V99  COMP-3   VALUE +0. ECSRITAB
  2901     12  RS-R-LB                 PIC S9(9)V99  COMP-3   VALUE +0. ECSRITAB
  2902     12  RS-R-LP                 PIC S9(7)V99  COMP-3   VALUE +0. ECSRITAB
  2903     12  RS-R-AB                 PIC S9(9)V99  COMP-3   VALUE +0. ECSRITAB
  2904     12  RS-R-AP                 PIC S9(7)V99  COMP-3   VALUE +0. ECSRITAB
  2905     12  RS-R-LPC                PIC S9(7)V99  COMP-3   VALUE +0. ECSRITAB
  2906     12  RS-R-APC                PIC S9(7)V99  COMP-3   VALUE +0. ECSRITAB
  2907     12  BIN-RWF-EP-STOP-DT      PIC XX        VALUE SPACES.      ECSRITAB
  2908     12  BIN-CNT                 PIC 9(3)      VALUE ZEROES.      ECSRITAB
  2909     12  BIN-CR-DIS-DT           PIC XX        VALUE SPACES.      ECSRITAB
  2910     12  BIN-WT-HIGH-DT          PIC XX        VALUE SPACES.      ECSRITAB
  2911     12  BIN-WT-LO-DT            PIC XX        VALUE SPACES.      ECSRITAB
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  61
* ECS010Z.cbl (/apps/prod/cid1p/copy/ECSRITAB)
  2912     12  BIN-LF-CANC-DT          PIC XX        VALUE SPACES.      ECSRITAB
  2913     12  BIN-AH-CANC-DT          PIC XX        VALUE SPACES.      ECSRITAB
  2914     12  BIN-CR-DTH-DT           PIC XX        VALUE SPACES.      ECSRITAB
  2915                                                                  ECSRITAB
  2916 01  REIN-CO-HOLD-TABLE.                                          ECSRITAB
  2917* ELCPSEVR MUST BE MODIFIED IF THE "OCCURS" IS CHANGED.           ECSRITAB
  2918     12  REIN-CO-HOLD-ENTRIES  OCCURS 1500 TIMES.                 ECSRITAB
  2919         16  RCT-REIN-CO         PIC X(6).                        ECSRITAB
  2920         16  RCT-CLM-CUTOFF-DT   PIC 9(11)  COMP-3.               ECSRITAB
  2921         16  RCT-EARNING-START-DT PIC 9(11)  COMP-3.              ECSRITAB
  2922         16  RCT-EARNING-STOP-DT PIC 9(11)  COMP-3.               ECSRITAB
  2923         16  RCT-EARN-STOP-CODE  PIC X.                           ECSRITAB
  2924         16  RCT-LF-CLM-PCT      PIC S9V9(4)    COMP-3.           ECSRITAB
  2925         16  RCT-LF-CLM-MAX      PIC S9(9)V99   COMP-3.           ECSRITAB
  2926         16  RCT-AH-CLM-PCT      PIC S9V9(4)    COMP-3.           ECSRITAB
  2927         16  RCT-AH-CLM-MAX      PIC S9(9)V99   COMP-3.           ECSRITAB
  2928                                                                  ECSRITAB
  2929 01  REIN-CO-HOLD-TABLE-2.                                        ECSRITAB
  2930     12  RC2-CO-HOLD-ENTRIES  OCCURS 1500 TIMES.                  ECSRITAB
  2931         16  RC2-REIN-CO.                                         ECSRITAB
  2932             20  RC2-CO-PRIME    PIC XXX.                         ECSRITAB
  2933             20  RC2-CO-SUB      PIC XXX.                         ECSRITAB
  2934         16  RC2-LF-R78-PCT      PIC S9V9(4)    COMP-3.           ECSRITAB
  2935         16  RC2-LF-PRO-PCT      PIC S9V9(4)    COMP-3.           ECSRITAB
  2936         16  RC2-AH-R78-PCT      PIC S9V9(4)    COMP-3.           ECSRITAB
  2937         16  RC2-AH-PRO-PCT      PIC S9V9(4)    COMP-3.           ECSRITAB
  2938         16  RC2-CO-NAME         PIC X(30).                       ECSRITAB
  2939         16  RC2-ECS152-RPT      PIC X.                           ECSRITAB
  2940                                                                  ECSRITAB
  2941 01  REIN-MORT-CD-HOLD-TABLE.                                     ECSRITAB
  2942     12  REIN-MORT-CD-ENTRIES  OCCURS 1500 TIMES.                 ECSRITAB
  2943         16  RCT-MORT-CO         PIC X(6).                        ECSRITAB
  2944         16  RCT-MORT-CODE       PIC X(4).                        ECSRITAB
  2945     12  REIN-INDEX              PIC S9(4)    COMP    VALUE +0.   ECSRITAB
  2946                                                                  ECSRITAB
  2947 01  BIN-RCT-ITEMS-TABLE.                                         ECSRITAB
  2948     12  BIN-RCT-ITEMS OCCURS 1500 TIMES.                         ECSRITAB
  2949         16  BIN-RCT-CLM-CUTOFF-DT    PIC XX.                     ECSRITAB
  2950         16  BIN-RCT-EARNING-START-DT PIC XX.                     ECSRITAB
  2951         16  BIN-RCT-EARNING-STOP-DT  PIC XX.                     ECSRITAB
  2952 01  BIN-RW-ITEMS-TABLE.                                          ECSRITAB
  2953     12  BIN-RW-ITEMS OCCURS 5 TIMES.                             ECSRITAB
  2954         16  BIN-RW-AH-INCUR-DT       PIC XX.                     ECSRITAB
  2955                                                                  ECSRITAB
  2956 01  REIN-CO-TABLE-ENT-CNT       PIC S9(4)    COMP-3  VALUE +1500.ECSRITAB
  2957******************************************************************ECSRITAB
  2958
* 2959                             COPY ELCPSEVR.
  2960******************************************************************04/16/98
  2961*                                                                *ELCPSEVR
  2962*                                                                *ELCPSEVR
  2963*                            ELCPSEVR                            *   LV003
  2964*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  2965*                            VMOD=2.001                          *ELCPSEVR
  2966*                                                                *ELCPSEVR
  2967*   WORKING STORAGE FOR DATE VARIABLES CREATED                   *ELCPSEVR
  2968*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCPSEVR
  2969*                                                                *ELCPSEVR
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  62
* ECS010Z.cbl (/apps/prod/cid1p/copy/ELCPSEVR)
  2970******************************************************************ELCPSEVR
  2971                                                                  ELCPSEVR
  2972 01  WS-PD-SUMMARY-DETAIL-EXTR-DT.                                ELCPSEVR
  2973     05  WS-PSC-CID-LOW.                                          ELCPSEVR
  2974         10  FILLER               PIC 999.                        ELCPSEVR
  2975         10  PSC-CID-LOW-CCYY     PIC 9(04).                      ELCPSEVR
  2976         10  PSC-CID-LOW-CCYR  REDEFINES  PSC-CID-LOW-CCYY.       ELCPSEVR
  2977             15  PSC-CID-LOW-CC   PIC 99.                            CL**3
  2978             15  PSC-CID-LOW-YY   PIC 99.                            CL**3
  2979         10  PSC-CID-LOW-MM       PIC 99.                            CL**3
  2980         10  PSC-CID-LOW-DD       PIC 99.                            CL**3
  2981     05  WS-PSC-CID-LOW-N REDEFINES                                  CL**2
  2982            WS-PSC-CID-LOW        PIC 9(11).                         CL**2
  2983     05  WS-PSC-CID-HIGH.                                         ELCPSEVR
  2984         10  FILLER              PIC 999.                         ELCPSEVR
  2985         10  PSC-CID-HIGH-CCYY   PIC 9(04).                       ELCPSEVR
  2986         10  PSC-CID-HIGH-CCYR  REDEFINES  PSC-CID-HIGH-CCYY.     ELCPSEVR
  2987             15  PSC-CID-HIGH-CC PIC 99.                             CL**3
  2988             15  PSC-CID-HIGH-YY PIC 99.                             CL**3
  2989         10  PSC-CID-HIGH-MM     PIC 99.                             CL**3
  2990         10  PSC-CID-HIGH-DD     PIC 99.                             CL**3
  2991     05  WS-PSC-CID-HIGH-N REDEFINES                                 CL**2
  2992            WS-PSC-CID-HIGH          PIC 9(11).                      CL**2
  2993 01  WS-REIN-WORK-AREAS.                                          ELCPSEVR
  2994     05  WS-REIN-CO-HOLD-ENTRIES  OCCURS 1500 TIMES               ELCPSEVR
  2995                 INDEXED BY CPSE-NDX.                             ELCPSEVR
  2996         10  WS-RCT-CLM-CUTOFF-DT.                                ELCPSEVR
  2997             15  FILLER              PIC 999.                     ELCPSEVR
  2998             15  RCT-CUTOFF-CCYY     PIC 9(04).                   ELCPSEVR
  2999             15  RCT-CUTOFF-CCYR  REDEFINES  RCT-CUTOFF-CCYY.     ELCPSEVR
  3000                 20  RCT-CUTOFF-CC   PIC 99.                      ELCPSEVR
  3001                 20  RCT-CUTOFF-YR   PIC 99.                      ELCPSEVR
  3002             15  RCT-CUTOFF-MO       PIC 99.                      ELCPSEVR
  3003             15  RCT-CUTOFF-DA       PIC 99.                      ELCPSEVR
  3004         10  WS-RCT-CLM-CUTOFF-DT-N REDEFINES                        CL**2
  3005                WS-RCT-CLM-CUTOFF-DT PIC 9(11).                      CL**2
  3006         10  WS-RCT-EARNING-START-DT.                             ELCPSEVR
  3007             15  FILLER              PIC 999.                     ELCPSEVR
  3008             15  RCT-START-CCYY      PIC 9(04).                   ELCPSEVR
  3009             15  RCT-START-CCYR  REDEFINES  RCT-START-CCYY.       ELCPSEVR
  3010                 20  RCT-START-CC    PIC 99.                      ELCPSEVR
  3011                 20  RCT-START-YR    PIC 99.                      ELCPSEVR
  3012             15  RCT-START-MO        PIC 99.                      ELCPSEVR
  3013             15  RCT-START-DA        PIC 99.                      ELCPSEVR
  3014         10  WS-RCT-EARNING-START-DT-N REDEFINES                     CL**2
  3015                WS-RCT-EARNING-START-DT  PIC 9(11).                  CL**2
  3016         10  WS-RCT-EARNING-STOP-DT.                              ELCPSEVR
  3017             15  FILLER              PIC 999.                     ELCPSEVR
  3018             15  RCT-STOP-CCYY       PIC 9(04).                   ELCPSEVR
  3019             15  RCT-STOP-CCYR  REDEFINES  RCT-STOP-CCYY.         ELCPSEVR
  3020                 20  RCT-STOP-CC     PIC 99.                      ELCPSEVR
  3021                 20  RCT-STOP-YR     PIC 99.                      ELCPSEVR
  3022             15  RCT-STOP-MO         PIC 99.                      ELCPSEVR
  3023             15  RCT-STOP-DA         PIC 99.                      ELCPSEVR
  3024         10  WS-RCT-EARNING-STOP-DT-N REDEFINES                      CL**2
  3025                WS-RCT-EARNING-STOP-DT   PIC 9(11).                  CL**2
  3026     05  WS-RWF-EP-STOP-DATE.                                     ELCPSEVR
  3027         10  FILLER              PIC 999.                         ELCPSEVR
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  63
* ECS010Z.cbl (/apps/prod/cid1p/copy/ELCPSEVR)
  3028         10  RWF-EP-STOP-CCYY    PIC 9(04).                       ELCPSEVR
  3029         10  RWF-EP-STOP-CCYR REDEFINES  RWF-EP-STOP-CCYY.        ELCPSEVR
  3030             15  RWF-EP-STOP-CC  PIC 99.                          ELCPSEVR
  3031             15  RWF-EP-STOP-YR  PIC 99.                          ELCPSEVR
  3032         10  RWF-EP-STOP-MO      PIC 99.                          ELCPSEVR
  3033         10  RWF-EP-STOP-DA      PIC 99.                          ELCPSEVR
  3034     05  WS-RWF-EP-STOP-DATE-N REDEFINES                             CL**2
  3035            WS-RWF-EP-STOP-DATE  PIC 9(11).                          CL**2
  3036
* 3037                             COPY ELCEPCVR.
  3038******************************************************************05/15/98
  3039*                                                                *ELCEPCVR
  3040*                                                                *ELCEPCVR
  3041*                            ELCEPCVR                            *   LV003
  3042*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  3043*                            VMOD=2.001                          *ELCEPCVR
  3044*                                                                *ELCEPCVR
  3045*   WORKING STORAGE FOR DATE VARIABLES CREATED                   *ELCEPCVR
  3046*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCEPCVR
  3047*                                                                *ELCEPCVR
  3048******************************************************************ELCEPCVR
  3049 01  WS-EP-RECORD-DATE.                                           ELCEPCVR
  3050     05  WS-EP-EXP-DTE.                                           ELCEPCVR
  3051         10  FILLER            PIC 999.                           ELCEPCVR
  3052         10  EP-EXP-CCYY       PIC 9(04).                         ELCEPCVR
  3053         10  EP-EXP-CCYR  REDEFINES  EP-EXP-CCYY.                 ELCEPCVR
  3054             15  EP-EXP-CC     PIC 99.                            ELCEPCVR
  3055             15  EP-EXP-YR     PIC 99.                            ELCEPCVR
  3056         10  EP-EXP-MO         PIC 99.                            ELCEPCVR
  3057         10  EP-EXP-DA         PIC 99.                            ELCEPCVR
  3058     05  WS-EP-EXP-DTE-N REDEFINES                                   CL**3
  3059            WS-EP-EXP-DTE      PIC 9(11).                            CL**3
  3060     05  WS-EC-EXP-DTE REDEFINES WS-EP-EXP-DTE.                      CL**5
  3061         10  FILLER            PIC 999.                              CL**5
  3062         10  EC-EXP-CCYY       PIC 9(04).                            CL**5
  3063         10  EC-EXP-CCYR  REDEFINES  EC-EXP-CCYY.                    CL**5
  3064             15  EC-EXP-CC     PIC 99.                               CL**5
  3065             15  EC-EXP-YR     PIC 99.                               CL**5
  3066         10  EC-EXP-MO         PIC 99.                               CL**5
  3067         10  EC-EXP-DA         PIC 99.                               CL**5
  3068     05  WS-EC-EXP-DTE-N REDEFINES                                   CL**5
  3069            WS-EC-EXP-DTE      PIC 9(11).                            CL**5
  3070     05  WS-EP-EFF-DTE.                                           ELCEPCVR
  3071         10  FILLER            PIC 999.                           ELCEPCVR
  3072         10  EP-EFF-CCYY       PIC 9(04).                         ELCEPCVR
  3073         10  EP-EFF-CCYR  REDEFINES  EP-EFF-CCYY.                 ELCEPCVR
  3074             15  EP-EFF-CC     PIC 99.                            ELCEPCVR
  3075             15  EP-EFF-YR     PIC 99.                            ELCEPCVR
  3076         10  EP-EFF-MO         PIC 99.                            ELCEPCVR
  3077         10  EP-EFF-DA         PIC 99.                            ELCEPCVR
  3078     05  WS-EP-EFF-DTE-N REDEFINES                                   CL**3
  3079            WS-EP-EFF-DTE      PIC 9(11).                            CL**3
  3080     05  WS-EC-EFF-DTE REDEFINES WS-EP-EFF-DTE.                      CL**5
  3081         10  FILLER            PIC 999.                              CL**5
  3082         10  EC-EFF-CCYY       PIC 9(04).                            CL**5
  3083         10  EC-EFF-CCYR  REDEFINES  EC-EFF-CCYY.                    CL**5
  3084             15  EC-EFF-CC     PIC 99.                               CL**5
  3085             15  EC-EFF-YR     PIC 99.                               CL**5
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  64
* ECS010Z.cbl (/apps/prod/cid1p/copy/ELCEPCVR)
  3086         10  EC-EFF-MO         PIC 99.                               CL**5
  3087         10  EC-EFF-DA         PIC 99.                               CL**5
  3088     05  WS-EC-EFF-DTE-N REDEFINES                                   CL**5
  3089            WS-EC-EFF-DTE      PIC 9(11).                            CL**5
  3090     05  WS-EP-HI-COV-DT.                                         ELCEPCVR
  3091         10  FILLER            PIC 999.                           ELCEPCVR
  3092         10  EP-COV-CCYY       PIC 9(04).                         ELCEPCVR
  3093         10  EP-COV-CCYR  REDEFINES  EP-COV-CCYY.                 ELCEPCVR
  3094             15  EP-COV-CC     PIC 99.                            ELCEPCVR
  3095             15  EP-COV-YR     PIC 99.                            ELCEPCVR
  3096         10  EP-COV-MO         PIC 99.                            ELCEPCVR
  3097         10  EP-COV-DA         PIC 99.                            ELCEPCVR
  3098     05  WS-EP-HI-COV-DT-N REDEFINES                                 CL**3
  3099            WS-EP-HI-COV-DT    PIC 9(11).                            CL**3
  3100     05  WS-EP-HI-CERT.                                           ELCEPCVR
  3101         10  FILLER            PIC 999.                           ELCEPCVR
  3102         10  EP-HI-CCYY        PIC 9(04).                         ELCEPCVR
  3103         10  EP-HI-CCYR  REDEFINES  EP-HI-CCYY.                   ELCEPCVR
  3104             15  EP-HI-CC      PIC 99.                            ELCEPCVR
  3105             15  EP-HI-YR      PIC 99.                            ELCEPCVR
  3106         10  EP-HI-MO          PIC 99.                            ELCEPCVR
  3107         10  EP-HI-DA          PIC 99.                            ELCEPCVR
  3108     05  WS-EP-HI-CERT-N REDEFINES                                   CL**3
  3109            WS-EP-HI-CERT      PIC 9(11).                            CL**3
  3110     05  WS-EP-LO-CERT.                                           ELCEPCVR
  3111         10  FILLER            PIC 999.                           ELCEPCVR
  3112         10  EP-LO-CCYY        PIC 9(04).                         ELCEPCVR
  3113         10  EP-LO-CCYR  REDEFINES   EP-LO-CCYY.                  ELCEPCVR
  3114             15  EP-LO-CC      PIC 99.                            ELCEPCVR
  3115             15  EP-LO-YR      PIC 99.                            ELCEPCVR
  3116         10  EP-LO-MO          PIC 99.                            ELCEPCVR
  3117         10  EP-LO-DA          PIC 99.                            ELCEPCVR
  3118     05  WS-EP-LO-CERT-N REDEFINES                                   CL**3
  3119            WS-EP-LO-CERT      PIC 9(11).                            CL**3
  3120     05  WS-EP-RUN-DTE.                                           ELCEPCVR
  3121         10  FILLER            PIC 999.                           ELCEPCVR
  3122         10  EP-RUN-CCYY       PIC 9(04).                         ELCEPCVR
  3123         10  EP-RUN-CCYR  REDEFINES  EP-RUN-CCYY.                 ELCEPCVR
  3124             15  EP-RUN-CC     PIC 99.                            ELCEPCVR
  3125             15  EP-RUN-YR     PIC 99.                            ELCEPCVR
  3126         10  EP-RUN-MO         PIC 99.                            ELCEPCVR
  3127         10  EP-RUN-DA         PIC 99.                            ELCEPCVR
  3128     05  WS-EP-RUN-DTE-N REDEFINES                                   CL**3
  3129            WS-EP-RUN-DTE      PIC 9(11).                            CL**3
  3130     05  WS-EC-RUN-DTE REDEFINES WS-EP-RUN-DTE.                      CL**5
  3131         10  FILLER            PIC 999.                           ELCEPCVR
  3132         10  EC-RUN-CCYY       PIC 9(04).                         ELCEPCVR
  3133         10  EC-RUN-CCYR  REDEFINES  EC-RUN-CCYY.                 ELCEPCVR
  3134             15  EC-RUN-CC     PIC 99.                            ELCEPCVR
  3135             15  EC-RUN-YR     PIC 99.                            ELCEPCVR
  3136         10  EC-RUN-MO         PIC 99.                            ELCEPCVR
  3137         10  EC-RUN-DA         PIC 99.                            ELCEPCVR
  3138     05  WS-EC-RUN-DTE-N REDEFINES                                   CL**3
  3139            WS-EC-RUN-DTE      PIC 9(11).                            CL**3
  3140
* 3141                             COPY ELCREINV.
  3142******************************************************************04/18/98
  3143*                                                                *ELCREINV
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  65
* ECS010Z.cbl (/apps/prod/cid1p/copy/ELCREINV)
  3144*                                                                *ELCREINV
  3145*                            ELCREINV                            *   LV003
  3146*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  3147*                            VMOD=2.001                          *ELCREINV
  3148*                                                                *ELCREINV
  3149*   WORKING STORAGE FOR DATE VARIABLES CREATED                   *ELCREINV
  3150*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCREINV
  3151*                                                                *ELCREINV
  3152******************************************************************ELCREINV
  3153                                                                  ELCREINV
  3154 01  WS-REINSURANCE-RECORD-DATE.                                  ELCREINV
  3155     05  WS-RE-LO-DATE.                                              CL**3
  3156         10 FILLER                     PIC 999.                      CL**3
  3157         10 RE-LO-CCYY                 PIC 9(04).                    CL**3
  3158         10 RE-LO-CCYR  REDEFINES  RE-LO-CCYY.                       CL**3
  3159            15 RE-LO-CC                PIC 99.                       CL**3
  3160            15 RE-LO-YR                PIC 99.                       CL**3
  3161         10 RE-LO-MO                   PIC 99.                       CL**3
  3162         10 RE-LO-DA                   PIC 99.                       CL**3
  3163     05  WS-RE-LO-DATE-N REDEFINES                                   CL**3
  3164            WS-RE-LO-DATE              PIC 9(11).                    CL**3
  3165     05  WS-RE-HI-DATE.                                              CL**3
  3166         10 FILLER                     PIC 999.                      CL**3
  3167         10 RE-HI-CCYY                 PIC 9(04).                    CL**3
  3168         10 RE-HI-CCYR  REDEFINES  RE-HI-CCYY.                       CL**3
  3169            15 RE-HI-CC                PIC 99.                       CL**3
  3170            15 RE-HI-YR                PIC 99.                       CL**3
  3171         10 RE-HI-MO                   PIC 99.                       CL**3
  3172         10 RE-HI-DA                   PIC 99.                       CL**3
  3173     05  WS-RE-HI-DATE-N REDEFINES                                   CL**3
  3174            WS-RE-HI-DATE              PIC 9(11).                    CL**3
  3175     05  WS-RE-CLM-INCURRED-LIM.                                  ELCREINV
  3176         10 FILLER                     PIC 999.                   ELCREINV
  3177         10 RE-CLM-CCYY                PIC 9(04).                 ELCREINV
  3178         10 RE-CLM-CCYR  REDEFINES  RE-CLM-CCYY.                  ELCREINV
  3179            15 RE-CLM-CC               PIC 99.                    ELCREINV
  3180            15 RE-CLM-YR               PIC 99.                    ELCREINV
  3181         10 RE-CLM-MO                  PIC 99.                    ELCREINV
  3182         10 RE-CLM-DA                  PIC 99.                    ELCREINV
  3183     05  WS-RE-CLM-INCURRED-LIM-N REDEFINES                          CL**2
  3184            WS-RE-CLM-INCURRED-LIM     PIC 9(11).                    CL**2
  3185     05  WS-RE-EARNING-START-DT.                                  ELCREINV
  3186         10  FILLER                    PIC 999.                   ELCREINV
  3187         10  RE-EARN-CCYY              PIC 9(04).                 ELCREINV
  3188         10  RE-EARN-CCYR  REDEFINES  RE-EARN-CCYY.               ELCREINV
  3189             15  RE-EARN-CC            PIC 99.                    ELCREINV
  3190             15  RE-EARN-YR            PIC 99.                    ELCREINV
  3191         10  RE-EARN-MO                PIC 99.                    ELCREINV
  3192         10  RE-EARN-DA                PIC 99.                    ELCREINV
  3193     05  WS-RE-EARNING-START-DT-N REDEFINES                          CL**2
  3194            WS-RE-EARNING-START-DT     PIC 9(11).                    CL**2
  3195     05  WS-RE-EARNING-STOP-DT.                                   ELCREINV
  3196         10  FILLER                    PIC 999.                   ELCREINV
  3197         10  RE-EARN-STOP-CCYY         PIC 9(04).                 ELCREINV
  3198         10  RE-EARN-STOP-CCYR  REDEFINES  RE-EARN-STOP-CCYY.     ELCREINV
  3199             15  RE-EARN-STOP-CC       PIC 99.                    ELCREINV
  3200             15  RE-EARN-STOP-YR       PIC 99.                    ELCREINV
  3201         10  RE-EARN-STOP-MO           PIC 99.                    ELCREINV
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  66
* ECS010Z.cbl (/apps/prod/cid1p/copy/ELCREINV)
  3202         10  RE-EARN-STOP-DA           PIC 99.                    ELCREINV
  3203     05  WS-RE-EARNING-STOP-DT-N REDEFINES                           CL**2
  3204            WS-RE-EARNING-STOP-DT      PIC 9(11).                    CL**2
  3205
  3206 01  RC-REIN-HOLD-AREAS.
  3207     12  RC-REIN-LEVELS  OCCURS 30.
  3208         16  RC-REIN-COMP    PIC X(6).
  3209         16  RC-OLD-ISS      PIC X.
  3210         16  RC-NEW-ISS      PIC X.
  3211         16  RC-OLD-CNC      PIC X.
  3212         16  RC-NEW-CNC      PIC X.
  3213         16  RC-OLD-LF-CLM   PIC X.
  3214         16  RC-OLD-AH-CLM   PIC X.
  3215         16  RC-NEW-LF-CLM   PIC X.
  3216         16  RC-NEW-AH-CLM   PIC X.
  3217         16  RC-REIN-LFAMT   PIC S9(9)V99    COMP-3.
  3218         16  RC-REIN-LFPRM   PIC S9(7)V99    COMP-3.
  3219         16  RC-REIN-AHAMT   PIC S9(7)V99    COMP-3.
  3220         16  RC-REIN-AHPRM   PIC S9(7)V99    COMP-3.
  3221         16  RC-REIN-LFRFND  PIC S9(7)V99    COMP-3.
  3222         16  RC-REIN-AHRFND  PIC S9(7)V99    COMP-3.
  3223         16  RC-REIN-LFCLM   PIC S9(9)V99    COMP-3.
  3224         16  RC-REIN-AHCLM   PIC S9(9)V99    COMP-3.
  3225         16  RC-REIN-REM-SW  PIC X.
  3226     12  RC-REIN-LEVELS-END  PIC X(6).
  3227
  3228 01  TOTAL-PAGES-COUNTERS    COMP-3.
  3229     12  TPC-COUNTERS    OCCURS 6.
  3230         16  TPL-ISS-PRM     PIC S9(9)V99.
  3231         16  TPA-ISS-PRM     PIC S9(9)V99.
  3232         16  TPL-CNC-PRM     PIC S9(9)V99.
  3233         16  TPA-CNC-PRM     PIC S9(9)V99.
  3234         16  TPL-ACCT-COM    PIC S9(9)V99.
  3235         16  TPA-ACCT-COM    PIC S9(9)V99.
  3236         16  TPL-CLAIMS      PIC S9(9)V99.
  3237         16  TPA-CLAIMS      PIC S9(9)V99.
  3238
  3239 01  HLD-DTS SYNC.
  3240     12  EOM-RUN-DATE        PIC 9(08).
  3241     12  EOM-RUN-DATE-R REDEFINES EOM-RUN-DATE.
  3242         16  EOM-CCYY.
  3243             20  EOM-CC      PIC 99.
  3244             20  EOM-YR      PIC 99.
  3245         16  EOM-MO          PIC 99.
  3246         16  EOM-DA          PIC 99.
  3247
  3248****   1ST OCCURRENCE IS MONTHEND DATE MINUS ONE MONTH
  3249****   2ND OCCURRENCE IS MONTHEND DATE MINUS TWO MONTHS
  3250     12  OB-RUN-DATES OCCURS 2.
  3251         16  OB-CCYY         PIC 9(4).
  3252         16  OB-MO           PIC 99.
  3253         16  OB-DA           PIC 99.
  3254
  3255     12  OB-DATE-1-SWITCH    PIC X           VALUE SPACE.
  3256         88  OB-DATE-1-USED     VALUE '*'.
  3257     12  OB-DATE-2-SWITCH    PIC X           VALUE SPACE.
  3258         88  OB-DATE-2-USED     VALUE '*'.
  3259     12  OB-DATE-3-SWITCH    PIC X           VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  67
* ECS010Z.cbl
  3260         88  OB-DATE-3-USED     VALUE '*'.
  3261     12  EARNING-START-DATE  PIC 9(08).
  3262     12  EARNING-START-DATE-R REDEFINES  EARNING-START-DATE.
  3263         16  E-ERN-START-CC  PIC 99.
  3264         16  E-ERN-START-YR  PIC 99.
  3265         16  E-ERN-START-MO  PIC 99.
  3266         16  E-ERN-START-DA  PIC 99.
  3267     12  EARNING-STOP-DATE   PIC 9(08).
  3268     12  EARNING-STOP-DATE-R REDEFINES  EARNING-STOP-DATE.
  3269         16  E-ERN-STOP-CC   PIC 99.
  3270         16  E-ERN-STOP-YR   PIC 99.
  3271         16  E-ERN-STOP-MO   PIC 99.
  3272         16  E-ERN-STOP-DA   PIC 99.
  3273     12  STOP-LF-DATE        PIC 9(08).
  3274     12  STOP-LF-DATE-R REDEFINES STOP-LF-DATE.
  3275         16  STOP-LF-CC      PIC 99.
  3276         16  STOP-LF-YR      PIC 99.
  3277         16  STOP-LF-MO      PIC 99.
  3278         16  STOP-LF-DA      PIC 99.
  3279     12  STOP-AH-DATE        PIC 9(08).
  3280     12  STOP-AH-DATE-R REDEFINES STOP-AH-DATE.
  3281         16  STOP-AH-CC      PIC 99.
  3282         16  STOP-AH-YR      PIC 99.
  3283         16  STOP-AH-MO      PIC 99.
  3284         16  STOP-AH-DA      PIC 99.
  3285     12  BIN-VALUATION-DT    PIC XX.
  3286     12  BIN-EOM-RUN-DATE    PIC XX.
  3287     12  LAST-YRS-DATE       PIC 9(08).
  3288     12  LAST-YRS-DATE-R  REDEFINES  LAST-YRS-DATE.
  3289         16  LYD-CCYY        PIC 9(04).
  3290         16  LYD-CCYR REDEFINES LYD-CCYY.
  3291             20  LYD-CC      PIC 99.
  3292             20  LYD-YR      PIC 99.
  3293         16  LYD-MO          PIC 99.
  3294         16  LYD-DA          PIC 99.
  3295     12  VALUATION-DT        PIC 9(08)  VALUE 0.
  3296     12  VALUATION-DT-R REDEFINES VALUATION-DT.
  3297         16  VAL-CC          PIC 99.
  3298         16  VAL-YR          PIC 99.
  3299         16  VAL-MO          PIC 99.
  3300         16  VAL-DA          PIC 99.
  3301     12  INCURRED-DATE       PIC 9(08).
  3302     12  INCURRED-DATE-R REDEFINES INCURRED-DATE.
  3303         16  DTO-CC          PIC 99.
  3304         16  DTO-YR          PIC 99.
  3305         16  DTO-MO          PIC 99.
  3306         16  DTO-DA          PIC 99.
  3307     12  REPORTED-DATE.
  3308         16  RPT-YR          PIC 99.
  3309         16  RPT-MO          PIC 99.
  3310         16  RPT-DA          PIC 99.
  3311     12  PAYMENT-DATE        PIC 9(08).
  3312     12  PAYMENT-DATE-R REDEFINES PAYMENT-DATE.
  3313         16  PAY-CC          PIC 99.
  3314         16  PAY-YR          PIC 99.
  3315         16  PAY-MO          PIC 99.
  3316         16  PAY-DA          PIC 99.
  3317     12  PAY-TO-DATE         PIC 9(8).
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  68
* ECS010Z.cbl
  3318     12  PAY-TO-DATE-R  REDEFINES PAY-TO-DATE.
  3319         16  PAYTO-CC        PIC 99.
  3320         16  PAYTO-YR        PIC 99.
  3321         16  PAYTO-MO        PIC 99.
  3322         16  PAYTO-DA        PIC 99.
  3323
  3324 01  AH-RES-STATE-TABLE.
  3325     12  FILLER              PIC X(42)       VALUE
  3326             'AKALAZCADEGAIDILKSKYLAMDMIMTNVOHORSCSDWIWY'.
  3327     12  FILLER              PIC XX          VALUE HIGH-VALUES.
  3328
  3329 01  AH-RES-STATE-TAB REDEFINES AH-RES-STATE-TABLE.
  3330     12  AH-RES-STATE-ENT    PIC XX      OCCURS 22 TIMES.
  3331
  3332 01  BILLING-COUNTERS    COMP-3.
  3333     12  BC-NET-WRIT         PIC S9(7)V99        VALUE +0.
  3334     12  BC-NET-WRIT-SP      PIC S9(7)V99        VALUE +0.
  3335     12  BC-NET-WRIT-OB      PIC S9(7)V99        VALUE +0.
  3336     12  BC-G-ISS            PIC S9(5)           VALUE +0.
  3337     12  BC-G-CNC            PIC S9(5)           VALUE +0.
  3338     12  BC-G-CLM            PIC S9(5)           VALUE +0.
  3339     12  BC-G-CRS            PIC S9(5)           VALUE +0.
  3340     12  BC-G-CTN            PIC S9(5)           VALUE +0.
  3341     12  BC-R-ISS            PIC S9(5)           VALUE +0.
  3342     12  BC-R-CNC            PIC S9(5)           VALUE +0.
  3343     12  BC-R-CLM            PIC S9(5)           VALUE +0.
  3344     12  BC-R-CRS            PIC S9(5)           VALUE +0.
  3345     12  BC-R-CTN            PIC S9(5)           VALUE +0.
  3346     12  BC-COMM             PIC S9(5)           VALUE +0.
  3347     12  BC-NEW-ACCTS        PIC S9(5)           VALUE +0.
  3348     12  BC-ACCTS            PIC S9(5)           VALUE +0.
  3349     12  BC-ACT-ACCTS        PIC S9(5)           VALUE +0.
  3350     12  BC-G-CERTS          PIC S9(7)           VALUE +0.
  3351     12  BC-G-A-CERTS        PIC S9(7)           VALUE +0.
  3352     12  BC-R-CERTS          PIC S9(7)           VALUE +0.
  3353     12  BC-R-A-CERTS        PIC S9(7)           VALUE +0.
  3354     12  BC-ER-ACCTS         PIC S9(5)           VALUE +0.
  3355     12  BC-CS-ACCTS         PIC S9(5)           VALUE +0.
  3356     12  ACTIVE-COUNT        PIC S9              VALUE +0.
  3357
  3358 01  FLAGS SYNC.
  3359     12  BILLED-SWITCH           PIC X           VALUE 'N'.
  3360         88  CHECK-BILLED                        VALUE 'Y'.
  3361     12  TRANS-EOF-FLAG          PIC X           VALUE SPACE.
  3362         88  EOF-ON-TRANS                        VALUE '*'.
  3363     12  CERT-EOF-FLAG           PIC X           VALUE SPACE.
  3364         88  EOF-ON-CERT                         VALUE '*'.
  3365     12  PROCESSING-FLAG         PIC X           VALUE SPACE.
  3366         88  PROCESSING-COMPLETED                VALUE '*'.
  3367     12  DEATH-VOID-FLAG         PIC X           VALUE SPACE.
  3368         88  DEATH-CLAIM-VOIDED                  VALUE '*'.
  3369     12  CERT-CHANGE-FLAG        PIC X           VALUE SPACE.
  3370         88  PRINTING-CERT-CHANGES               VALUE '*'.
  3371     12  STATUTORY-SWITCH        PIC X           VALUE SPACE.
  3372         88  STATUTORY-REQUIREMENT               VALUE '*'.
  3373     12  STATUTORY-SWITCH-AH     PIC X           VALUE SPACE.
  3374         88  STATUTORY-REQUIREMENT-AH            VALUE '*'.
  3375     12  LIFE-EARNED-SWITCH      PIC X           VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  69
* ECS010Z.cbl
  3376         88  LIFE-FULLY-EARNED                   VALUE '*'.
  3377     12  A-H-EARNED-SWITCH       PIC X           VALUE SPACE.
  3378         88  A-H-FULLY-EARNED                    VALUE '*'.
  3379     12  CNCL-FLG            PIC X               VALUE SPACE.
  3380     12  TRANSACTION-FLAG    PIC X               VALUE SPACE.
  3381         88  NO-TRANSACTION-WAS-PROCESSED    VALUE SPACE.
  3382         88  TRANSACTION-WAS-PROCESSED       VALUE '*'.
  3383     12  RISK-REIN-FLAG      PIC X               VALUE SPACE.
  3384         88  REIN-IS-RISK-PREMIUM            VALUE '*'.
  3385     12  RISK-PREM-FLAG      PIC X               VALUE SPACE.
  3386         88  UPDATING-RISK-PREMIUMS          VALUE '*'.
  3387     12  EP-FLG              PIC X               VALUE SPACE.
  3388     12  END-FLG             PIC X               VALUE SPACE.
  3389     12  PRIOR-MATCH-CNTRL   PIC X(36)           VALUE LOW-VALUE.
  3390     12  PRIOR-CERT-IN-CNTRL PIC X(36)           VALUE LOW-VALUE.
  3391     12  ACCT-FLG            PIC X               VALUE SPACE.
  3392     12  STATE-FLG           PIC X               VALUE SPACE.
  3393     12  COMP-FLG            PIC X               VALUE SPACE.
  3394     12  CARR-FLG            PIC X               VALUE SPACE.
  3395     12  FINAL-FLG           PIC X               VALUE SPACE.
  3396     12  LOW-CTL             PIC X(19)           VALUE SPACES.
  3397     12  REIN-FLG            PIC X               VALUE SPACE.
  3398     12  REIN-EP-FLG         PIC X               VALUE SPACE.
  3399     12  REIN-RT-SW          PIC X               VALUE SPACE.
  3400
  3401 01  TEXAS-REG-WORK-AREAS   SYNC.
  3402     12  TEX-FACT-1          PIC S9(9)V99    COMP-3.
  3403     12  TEX-FACT-2          PIC S999        COMP-3.
  3404     12  TEX-FACT-3          PIC S999        COMP-3.
  3405     12  TEX-FACT-4          PIC S9(7)       COMP-3.
  3406     12  TEX-FACT-5          PIC S999        COMP-3.
  3407     12  TEX-FACT-6          PIC S999        COMP-3.
  3408     12  TEX-FACT-7          PIC S9(7)       COMP-3.
  3409     12  TEX-FACT-8          PIC S9V9(6)     COMP-3.
  3410     12  TEX-FACT-9          PIC S9(4)V9(11) COMP-3.
  3411
  3412 01  NET-PAY-INTERFACE.
  3413     12  NP-APR              PIC S999V9(4)   COMP-3.
  3414     12  NP-ORIG             PIC S999        COMP-3.
  3415     12  NP-REM              PIC S999        COMP-3.
  3416     12  NP-OPT              PIC X.
  3417     12  NP-CAP              PIC S999        COMP-3.
  3418     12  NP-FACTOR           PIC S9(4)V9(9)  COMP-3.
  3419     12  NP-WORK1            PIC S9(9)V9(9)  COMP-3.
  3420     12  NP-WORK2            PIC S9(9)V9(9)  COMP-3.
  3421     12  NP-BENEFIT          PIC S9(9)V99    COMP-3.
  3422     12  NP-REMAINING        PIC S9(9)V99    COMP-3.
  3423     12  NP-AHPRM            PIC S9(7)V99    COMP-3.
  3424     12  NP-ACCOUNT          PIC X(10).
  3425
  3426 01  HOLDERS SYNC.
  3427     12  DIS-IBNR            PIC S9(7)V99 COMP-3 VALUE +0.
  3428     12  DIS-PAYCUR          PIC S9(7)V99 COMP-3 VALUE +0.
  3429     12  DIS-FUTRSV          PIC S9(7)V99 COMP-3 VALUE +0.
  3430     12  DTH-IBNR            PIC S9(7)V99 COMP-3 VALUE +0.
  3431     12  DTH-PAYCUR          PIC S9(7)V99 COMP-3 VALUE +0.
  3432     12  DTH-FUTRSV          PIC S9(7)V99 COMP-3 VALUE +0.
  3433     12  EXCESS-RESERVE      PIC S9(7)V99 COMP-3 VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  70
* ECS010Z.cbl
  3434     12  H-LFCM              PIC S9(9)V99 COMP-3 VALUE +0.
  3435     12  H-AHCM              PIC S9(9)V99 COMP-3 VALUE +0.
  3436     12  TEMP-1              PIC S9(5)V99 COMP-3 VALUE +0.
  3437     12  TEMP-2              PIC S9(5)V99 COMP-3 VALUE +0.
  3438     12  TEMP-3              PIC S9(5)V99 COMP-3 VALUE +0.
  3439     12  TEMP-4              PIC S9V9(6)  COMP-3 VALUE +0.
  3440     12  TEMP-5              PIC S9V9(6)  COMP-3 VALUE +0.
  3441     12  TEMP-6              PIC S99V9(6) COMP-3 VALUE +0.
  3442     12  TEMP-7              PIC S9(9)V99 COMP-3 VALUE +0.
  3443     12  TEMP-8              PIC S9(9)V99 COMP-3 VALUE +0.
  3444     12  REM-TRM1            PIC S999V99  COMP-3.
  3445     12  REM-TRM2            PIC S999V99  COMP-3.
  3446     12  REM-TRM3            PIC S999V99  COMP-3.
  3447     12  TEM-TRM1            PIC S999V99  COMP-3.
  3448     12  MAX-REM-TERM        PIC S999V99  COMP-3.
  3449     12  ORIG-TERM           PIC S999V99  COMP-3.
  3450     12  HLD-CONTROL.
  3451         16  HLD-CARRIER     PIC X               VALUE SPACES.
  3452         16  HLD-GROUPING    PIC X(6)            VALUE SPACES.
  3453         16  HLD-STATE       PIC XX              VALUE SPACES.
  3454         16  HLD-ACCT        PIC X(10)           VALUE SPACES.
  3455     12  LN-MX               PIC S999     COMP-3 VALUE +56.
  3456
  3457 01  DISPLAY-HD-1.
  3458     05  FILLER      PIC X       VALUE SPACES.
  3459     05  FILLER      PIC X(50)   VALUE SPACES.
  3460     05  FILLER      PIC X(23)   VALUE 'PROCESSING ERROR REPOR'.
  3461     05  FILLER      PIC X(51)   VALUE SPACES.
  3462     05  FILLER      PIC X(8)    VALUE 'ECS010 '.
  3463
  3464 01  DISPLAY-HD-2.
  3465     05  FILLER                 PIC X       VALUE SPACE.
  3466     05  FILLER                 PIC X(57)   VALUE SPACES.
  3467     05  DIS-DATE               PIC X(8).
  3468     05  FILLER                 PIC X(66)   VALUE SPACES.
  3469
  3470 01  DISPLAY-LINE.
  3471     05  DL-FULL.
  3472         10  FILLER           PIC X       VALUE SPACE.
  3473         10  DIS-LINE-REASON  PIC X(32)   VALUE SPACES.
  3474         10  DIS-LINE-REC     PIC X(100)  VALUE SPACES.
  3475
  3476 01  PRT-HDNGS SYNC.
  3477     12  TR-HD-1.
  3478         16  FILLER      PIC X       VALUE '1'.
  3479         16  FILLER      PIC X(53)   VALUE SPACES.
  3480         16  FILLER      PIC X(18)   VALUE 'TRANSACTION REPORT'.
  3481         16  FILLER      PIC X(48)   VALUE SPACES.
  3482         16  FILLER      PIC X(8)    VALUE 'ECS010 '.
  3483     12  TR-HD-2.
  3484         16  FILLER      PIC X       VALUE SPACE.
  3485         16  FILLER      PIC X(47)   VALUE SPACES.
  3486         16  TRHDNM      PIC X(30).
  3487         16  FILLER      PIC X(42)   VALUE SPACES.
  3488         16  TR-RN-DT    PIC X(8).
  3489     12  TR-HD-3.
  3490         16  FILLER      PIC X       VALUE SPACE.
  3491         16  FILLER      PIC X(53)   VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  71
* ECS010Z.cbl
  3492         16  TR-MODAYR   PIC X(18).
  3493         16  FILLER      PIC X       VALUE SPACE.
  3494         16  TR-YRASK    PIC X       VALUE SPACE.
  3495         16  FILLER      PIC X(46)   VALUE SPACES.
  3496         16  FILLER      PIC X(5)    VALUE 'PAGE '.
  3497         16  TR-PG       PIC ZZ,ZZ9.
  3498     12  TR-HD-4.
  3499         16  FILLER      PIC X       VALUE SPACE.
  3500         16  TR-AGCY     PIC X(30).
  3501     12  TR-HD-5.
  3502         16  FILLER      PIC X       VALUE SPACE.
  3503         16  TR-CARR     PIC X.
  3504         16  FILLER      PIC X       VALUE '-'.
  3505         16  TR-GROUP    PIC X(6).
  3506         16  FILLER      PIC X       VALUE '-'.
  3507         16  TR-ST-NO    PIC X(2).
  3508         16  FILLER      PIC X       VALUE '-'.
  3509         16  TR-AG-NO    PIC X(10).
  3510         16  FILLER      PIC X(23)   VALUE SPACES.
  3511         16  TR5-RP-TYP.
  3512             20  FILLER  PIC X(20)   VALUE
  3513                     '* * * * TRANSACTION '.
  3514             20  FILLER  PIC X(15)   VALUE 'LISTING * * * *'.
  3515     12  TR-HD-6.
  3516         16  FILLER      PIC X       VALUE SPACE.
  3517         16  TR-CE-MO    PIC XX.
  3518         16  FILLER      PIC X       VALUE '-'.
  3519         16  TR-CE-DA    PIC XX.
  3520         16  FILLER      PIC X       VALUE '-'.
  3521         16  TR-CE-YR    PIC XX.
  3522         16  FILLER      PIC X(6)    VALUE '  TO  '.
  3523         16  TR-CX.
  3524             20  TR-CX-MO PIC XX.
  3525             20  HSHR1    PIC X.
  3526             20  TR-CX-DA PIC XX.
  3527             20  HSHR2    PIC X.
  3528             20  TR-CX-YR PIC XX.
  3529     12  TR-HD-7.
  3530         16  FILLER  PIC X      VALUE '0'.
  3531         16  FILLER  PIC X(24)  VALUE SPACES.
  3532         16  FILLER  PIC X(19)  VALUE '*----------------- '.
  3533         16  TR-7-LF PIC X(6).
  3534         16  FILLER  PIC X(9)   VALUE ' COVERAGE'.
  3535         16  FILLER  PIC X(19)  VALUE ' -----------------*'.
  3536         16  FILLER  PIC X(20)  VALUE '  *---------------- '.
  3537         16  TR-7-AH PIC X(6).
  3538         16  FILLER  PIC X(10)  VALUE ' COVERAGE '.
  3539         16  FILLER  PIC X(19)  VALUE ' -----------------*'.
  3540     12  TR-HD-8.
  3541         16  FILLER  PIC X      VALUE SPACE.
  3542         16  FILLER  PIC X(24)  VALUE '   CERT      ISSUE      '.
  3543         16  FILLER  PIC X(24)  VALUE '        PREMIUM    COMMI'.
  3544         16  FILLER  PIC X(24)  VALUE 'SSION   ACTION          '.
  3545         16  FILLER  PIC X(24)  VALUE '                PREMIUM '.
  3546         16  FILLER  PIC X(22)  VALUE '   COMMISSION   ACTION'.
  3547     12  TR-HD-9.
  3548         16  FILLER  PIC X      VALUE SPACE.
  3549         16  FILLER  PIC X(24)  VALUE '  NUMBER      DATE  AGE '.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  72
* ECS010Z.cbl
  3550         16  FILLER  PIC X(24)  VALUE 'TYP TRM  / REFUND    /  '.
  3551         16  FILLER  PIC X(24)  VALUE 'CLAIM    DATE     ACTION'.
  3552         16  FILLER  PIC X(24)  VALUE '  ST    TYP TRM  / REFUN'.
  3553         16  FILLER  PIC X(24)  VALUE 'D    /  CLAIM    DATE   '.
  3554         16  FILLER  PIC X(12)  VALUE '  ACTION  ST'.
  3555     12  TR-TTL-HD.
  3556         16  FILLER      PIC X       VALUE '0'.
  3557         16  TTL-PT-CNT  PIC ZZZZ,ZZZ,ZZZ,ZZ9.
  3558         16  FILLER      PIC XX      VALUE SPACES.
  3559         16  TTL-HD-DS   PIC X(60)   VALUE
  3560             'ECS010 CONTROL TOTALS'.
  3561
  3562 01  TR-DTL.
  3563     12  FILLER                  PIC X           VALUE SPACE.
  3564     12  TR-DTL1.
  3565         16  TRD-CERT            PIC X(11).
  3566         16  TRD-ISDT.
  3567             20  FILLER          PIC X           VALUE SPACE.
  3568             20  TRD-ISMO        PIC XX.
  3569             20  TRD-IS-S1       PIC X           VALUE '/'.
  3570             20  TRD-ISDA        PIC XX.
  3571             20  TRD-IS-S2       PIC X           VALUE '/'.
  3572             20  TRD-ISYR        PIC XX.
  3573             20  FILLER          PIC X           VALUE SPACE.
  3574         16  TRD-AGE             PIC XX.
  3575     12  TR-DTL2.
  3576         16  FILLER              PIC X           VALUE SPACE.
  3577         16  TRD-LFTYP           PIC XXX.
  3578         16  FILLER              PIC X           VALUE SPACE.
  3579         16  TRD-LFTRM           PIC ZZ9.
  3580         16  TRD-LFPRM-RFND      PIC ZZZZ,ZZZ.99  BLANK WHEN ZERO.
  3581         16  TRD-LFCOM-CLM       PIC ZZZZ,ZZZ.99- BLANK WHEN ZERO.
  3582         16  TRD-LFACTDT.
  3583             20  FILLER          PIC X           VALUE SPACE.
  3584             20  TRD-LFACTMO     PIC XX.
  3585             20  TRD-LF-S1       PIC X           VALUE '/'.
  3586             20  TRD-LFACTDA     PIC XX.
  3587             20  TRD-LF-S2       PIC X           VALUE '/'.
  3588             20  TRD-LFACTYR     PIC XX.
  3589             20  FILLER          PIC X           VALUE SPACE.
  3590         16  TRD-LF-ACTION       PIC X(10)       VALUE SPACE.
  3591         16  FILLER              PIC X           VALUE SPACE.
  3592         16  TRD-LF-STATUS       PIC X.
  3593         16  FILLER              PIC X(4)        VALUE SPACE.
  3594         16  TRD-AHTYP           PIC XXX.
  3595         16  FILLER              PIC X           VALUE SPACE.
  3596         16  TRD-AHTRM           PIC ZZ9.
  3597         16  TRD-AHPRM-RFND      PIC ZZZZ,ZZZ.99  BLANK WHEN ZERO.
  3598         16  TRD-AHCOM-CLM       PIC ZZZZ,ZZZ.99- BLANK WHEN ZERO.
  3599         16  TRD-AHACTDT.
  3600             20  FILLER          PIC X           VALUE SPACE.
  3601             20  TRD-AHACTMO     PIC XX.
  3602             20  TRD-AH-S1       PIC X           VALUE '/'.
  3603             20  TRD-AHACTDA     PIC XX.
  3604             20  TRD-AH-S2       PIC X           VALUE '/'.
  3605             20  TRD-AHACTYR     PIC XX.
  3606             20  FILLER          PIC X           VALUE SPACE.
  3607         16  TRD-AH-ACTION       PIC X(10)       VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  73
* ECS010Z.cbl
  3608         16  FILLER              PIC X           VALUE SPACE.
  3609         16  TRD-AH-STATUS       PIC X.
  3610     12  TR-DTL3 REDEFINES TR-DTL2.
  3611         16  FILLER              PIC X(20).
  3612         16  TRD-IBNR            PIC ZZZ,ZZZ.99-.
  3613         16  FILLER              PIC X.
  3614         16  TRD-IBNRX           PIC X(4).
  3615         16  FILLER              PIC X(2).
  3616         16  TRD-PAYCUR          PIC ZZZ,ZZZ.99-.
  3617         16  TRD-PAYCUR-SPACE REDEFINES TRD-PAYCUR
  3618                                 PIC X(11).
  3619         16  FILLER              PIC X.
  3620         16  TRD-PAYCURX         PIC X(8).
  3621         16  FILLER              PIC X(2).
  3622         16  TRD-FUTRSV-DATA.
  3623             20  TRD-FUTRSV      PIC ZZZ,ZZZ.99-.
  3624             20  TRD-FUTRSV-SPACE REDEFINES TRD-FUTRSV
  3625                                 PIC X(11).
  3626             20  FILLER          PIC X.
  3627             20  TRD-FUTRSVX     PIC X(6).
  3628         16  TRD-BENEFIT-DATA REDEFINES TRD-FUTRSV-DATA.
  3629             20  TRD-BENEFIT-X   PIC X(10).
  3630             20  TRD-BENEFIT-CODE
  3631                                 PIC X(02).
  3632             20  FILLER          PIC X(06).
  3633         16  FILLER              PIC X(4).
  3634         16  TRD-RSV-DESC        PIC X(6).
  3635         16  TRD-RSV-ACTION      PIC X(21).
  3636
  3637 01  DET-PR-UREC.
  3638     12  FILLER              PIC X(7)     VALUE ' AGE - '.
  3639     12  DET-AGE             PIC 99         BLANK WHEN ZERO.
  3640     12  FILLER              PIC X(11)    VALUE ' JT. AGE - '.
  3641     12  DET-JT-AGE          PIC 99         BLANK WHEN ZERO.
  3642     12  FILLER              PIC X(7)     VALUE ' SEX - '.
  3643     12  DET-SEX             PIC X.
  3644     12  FILLER              PIC X(9)     VALUE '   APR - '.
  3645     12  DET-PR-APR          PIC Z9.999     BLANK WHEN ZERO.
  3646     12  FILLER              PIC X(9)     VALUE '  MEM# - '.
  3647     12  DET-PR-MEM          PIC X(12).
  3648     12  FILLER              PIC X(9)     VALUE '   SS# - '.
  3649     12  DET-PR-SS           PIC X(11).
  3650     12  FILLER              PIC XXX      VALUE SPACES.
  3651     12  DET-1-ACTION        PIC X(20)    VALUE ' MAINTENANCE'.
  3652
  3653 01  DET-PR-UREC-2.
  3654     12  FILLER              PIC X        VALUE SPACE.
  3655     12  DET-LF-DESC         PIC XX.
  3656     12  FILLER              PIC X(10)    VALUE ' TERM CHG '.
  3657     12  DET-O-LF-TERM       PIC 999        BLANK WHEN ZERO.
  3658     12  FILLER              PIC X(4)     VALUE ' TO '.
  3659     12  DET-N-LF-TERM       PIC 999        BLANK WHEN ZERO.
  3660     12  FILLER              PIC X        VALUE SPACE.
  3661     12  DET-AH-DESC         PIC XX.
  3662     12  FILLER              PIC X(10)    VALUE ' TERM CHG '.
  3663     12  DET-O-AH-TERM       PIC 999        BLANK WHEN ZERO.
  3664     12  FILLER              PIC X(4)     VALUE ' TO '.
  3665     12  DET-N-AH-TERM       PIC 999        BLANK WHEN ZERO.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  74
* ECS010Z.cbl
  3666     12  FILLER              PIC X(12)    VALUE ' OLD LIVES -'.
  3667     12  DET-O-LIVES         PIC ZZZZ999    BLANK WHEN ZERO.
  3668     12  FILLER              PIC X(12)    VALUE ' NEW LIVES -'.
  3669     12  DET-N-LIVES         PIC ZZZZ999    BLANK WHEN ZERO.
  3670     12  FILLER              PIC X(5)     VALUE SPACES.
  3671     12  DET-2-ACTION        PIC X(20)    VALUE ' MAINTENANCE'.
  3672
  3673 01  DET-PR-UREC-3.
  3674     12  FILLER              PIC X(7)     VALUE ' I/G - '.
  3675     12  DET-IND-GRP         PIC X.
  3676     12  FILLER              PIC X(13)    VALUE '  PMT FREQ - '.
  3677     12  DET-PMT-FREQ        PIC 99         BLANK WHEN ZERO.
  3678     12  FILLER              PIC X(14)    VALUE '  POL FORM# - '.
  3679     12  DET-POL-FORM        PIC X(12).
  3680     12  FILLER              PIC X(14)    VALUE '  LOAN OFF# - '.
  3681     12  DET-LOAN-OFFICER    PIC XXX.
  3682     12  FILLER              PIC X(14)    VALUE '  USER CODE - '.
  3683     12  DET-USER-CODE       PIC X.
  3684     12  FILLER              PIC X(8)     VALUE SPACES.
  3685     12  DET-3-ACTION        PIC X(20)    VALUE ' MAINTENANCE'.
  3686
  3687 01  DET-PR-UREC-4.
  3688     12  FILLER              PIC X(18) VALUE ' CLM DEDUCT AMT - '.
  3689     12  DET-CLM-DEDUCT      PIC 99999.99   BLANK WHEN ZERO.
  3690     12  FILLER              PIC X(18) VALUE ' CAN DEDUCT AMT - '.
  3691     12  DET-CAN-DEDUCT      PIC 99999.99   BLANK WHEN ZERO.
  3692     12  FILLER              PIC X(37)    VALUE SPACES.
  3693     12  DET-3-ACTION        PIC X(20)    VALUE ' MAINTENANCE'.
  3694
  3695 01  DET-PR-UREC-5.
  3696     12  FILLER              PIC X(13) VALUE ' LF BEN CD - '.
  3697     12  DET-LF-BEN-CD       PIC XX.
  3698     12  FILLER              PIC X(11) VALUE ' LF PREM - '.
  3699     12  DET-LF-PREM         PIC ZZZZZZZ.99   BLANK WHEN ZERO.
  3700     12  FILLER              PIC X(11) VALUE ' LF BENE - '.
  3701     12  DET-LF-BEN          PIC ZZZZZZZZZ.99   BLANK WHEN ZERO.
  3702     12  FILLER              PIC X(30)    VALUE SPACES.
  3703     12  DET-3-ACTION        PIC X(20)    VALUE ' MAINTENANCE'.
  3704
  3705 01  DET-PR-UREC-6.
  3706     12  FILLER              PIC X(13) VALUE ' AH BEN CD - '.
  3707     12  DET-AH-BEN-CD       PIC XX.
  3708     12  FILLER              PIC X(11) VALUE ' AH PREM - '.
  3709     12  DET-AH-PREM         PIC ZZZZZZZ.99   BLANK WHEN ZERO.
  3710     12  FILLER              PIC X(11) VALUE ' AH BENE - '.
  3711     12  DET-AH-BEN          PIC ZZZZZZZZZ.99   BLANK WHEN ZERO.
  3712     12  FILLER              PIC X(30)    VALUE SPACES.
  3713     12  DET-3-ACTION        PIC X(20)    VALUE ' MAINTENANCE'.
  3714
  3715 01  WS-CHANGE-REC-SW        PIC X  VALUE 'N'.
  3716     88  WS-CHANGE-REC              VALUE 'Y'.
  3717
  3718 01  TOTAL-PAGE-HD1.
  3719     12  FILLER              PIC X               VALUE SPACE.
  3720     12  TPH1-TYPE           PIC X(8).
  3721     12  TPH1-DESC.
  3722         16  TPH1-ST-CODE    PIC XX.
  3723         16  FILLER          PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  75
* ECS010Z.cbl
  3724         16  TPH1-ST-DESC    PIC X(20).
  3725
  3726 01  TOTAL-PAGE-HD2.
  3727     12  FILLER              PIC X           VALUE SPACE.
  3728     12  TPH2-DESC           PIC X(20)       VALUE SPACES.
  3729     12  FILLER              PIC X(7)        VALUE 'WRITTEN'.
  3730     12  FILLER              PIC X(9)        VALUE SPACES.
  3731     12  FILLER              PIC X(9)        VALUE 'CANCELLED'.
  3732     12  FILLER              PIC X(11)       VALUE SPACES.
  3733     12  FILLER              PIC X(3)        VALUE 'NET'.
  3734     12  FILLER              PIC X(11)       VALUE SPACES.
  3735     12  FILLER              PIC X(7)        VALUE 'ACCOUNT'.
  3736     12  FILLER              PIC X(10)       VALUE SPACES.
  3737     12  FILLER              PIC X(10)       VALUE 'NET PREM -'.
  3738
  3739 01  TOTAL-PAGE-HD3.
  3740     12  FILLER              PIC X           VALUE SPACE.
  3741     12  TPH3-DESC           PIC X(20)       VALUE SPACES.
  3742     12  FILLER              PIC X(7)        VALUE 'PREMIUM'.
  3743     12  FILLER              PIC X(10)       VALUE SPACES.
  3744     12  FILLER              PIC X(7)        VALUE 'PREMIUM'.
  3745     12  FILLER              PIC X(10)       VALUE SPACES.
  3746     12  FILLER              PIC X(7)        VALUE 'PREMIUM'.
  3747     12  FILLER              PIC X(7)        VALUE SPACES.
  3748     12  FILLER              PIC X(10)       VALUE 'COMMISSION'.
  3749     12  FILLER              PIC X(08)       VALUE SPACES.
  3750     12  FILLER              PIC X(09)       VALUE 'ACCT COMP'.
  3751     12  FILLER              PIC X(11)       VALUE SPACES.
  3752     12  FILLER              PIC X(6)        VALUE 'CLAIMS'.
  3753
  3754 01  TOTAL-PAGE-DETAIL.
  3755     12  FILLER              PIC X(5).
  3756     12  TPD-DESC            PIC X(6).
  3757     12  FILLER              PIC X(3).
  3758     12  TPD-ISS-PRM         PIC ZZZ,ZZZ,ZZZ.99-.
  3759     12  FILLER              PIC X(2).
  3760     12  TPD-CNC-PRM         PIC ZZZ,ZZZ,ZZZ.99-.
  3761     12  FILLER              PIC X(2).
  3762     12  TPD-NET-PRM         PIC ZZZ,ZZZ,ZZZ.99-.
  3763     12  FILLER              PIC X(2).
  3764     12  TPD-ACCT-COM        PIC ZZZ,ZZZ,ZZZ.99-.
  3765     12  FILLER              PIC X(2).
  3766     12  TPD-PREM-COMP       PIC ZZZ,ZZZ,ZZZ.99-.
  3767     12  FILLER              PIC X(2).
  3768     12  TPD-CLAIMS          PIC ZZZ,ZZZ,ZZZ.99-.
  3769     12  FILLER              PIC X(4).
  3770     12  TPD-LO-CERT         PIC X(6).
  3771     12  FILLER              PIC X(2).
  3772     12  TPD-HI-CERT         PIC X(6).
  3773*    12  FILLER              PIC X.
  3774*    12  TPD-LO-CERT         PIC X(8).
  3775*    12  FILLER              PIC X.
  3776*    12  TPD-HI-CERT         PIC X(8).
  3777
  3778 01  DUPE-CERT-TABLE.
  3779     12  DUPE-ENTRIES  OCCURS 1000 TIMES.
  3780         16  DUPE-ENTRY      PIC X(36).
  3781         16  DUPE-STATUS     PIC X(01).
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  76
* ECS010Z.cbl
  3782         16  DUPE-LF-PRM     PIC S9(7)V99    COMP-3.
  3783         16  DUPE-AH-PRM     PIC S9(7)V99    COMP-3.
  3784
  3785 01  MISMATCH-HEADING-1.
  3786     12  FILLER              PIC X           VALUE '1'.
  3787     12  FILLER              PIC X(45)       VALUE SPACES.
  3788     12  FILLER              PIC X(42)       VALUE
  3789             'MISMATCHED TRANS AND DUPLICATE CERT REPORT'.
  3790     12  FILLER              PIC X(35)       VALUE SPACES.
  3791     12  FILLER              PIC X(10)       VALUE 'ECS010    '.
  3792
  3793 01  MISMATCH-HEADING-2.
  3794     12  FILLER              PIC X           VALUE '0'.
  3795     12  FILLER              PIC X(44)       VALUE
  3796             ' C  GRP ST  ACCT    EFF DTE  CERT      REC T'.
  3797     12  FILLER              PIC X(44)       VALUE
  3798             'YPE      CERT IN CONTROL                    '.
  3799     12  FILLER              PIC X(44)       VALUE
  3800             '        CERT OUT CONTROL           STATUS   '.
  3801
  3802 01  MISMATCH-DETAIL.
  3803     12  FILLER              PIC X           VALUE '0'.
  3804     12  FILLER              PIC X           VALUE SPACES.
  3805     12  DTL-MATCH-CONTROL   PIC X(36).
  3806     12  FILLER              PIC X(3)        VALUE SPACES.
  3807     12  DTL-REC-TYPE        PIC X.
  3808     12  FILLER              PIC X(2)        VALUE SPACES.
  3809     12  DTL-REC-TYPE-DESC   PIC X(3).
  3810     12  FILLER              PIC X(3)        VALUE SPACES.
  3811     12  DTL-CERT-IN-CONTROL
  3812                             PIC X(36).
  3813     12  FILLER              PIC X           VALUE SPACES.
  3814     12  DTL-CERT-OUT-CONTROL
  3815                             PIC X(36).
  3816     12  FILLER              PIC X           VALUE SPACES.
  3817     12  DTL-STATUS          PIC X(7)        VALUE 'DROPPED'.
  3818     12  FILLER              PIC X(2)        VALUE SPACES.
  3819
  3820 01  MISMATCH-DETAIL-2.
  3821     12  FILLER              PIC X           VALUE ' '.
  3822     12  FILLER              PIC X           VALUE SPACES.
  3823     12  MD2-LF-PREM-DESC    PIC X(16)       VALUE
  3824             ' LIFE PREMIUM = '.
  3825     12  MD2-LF-PREM         PIC Z,ZZZ,ZZZ.99-.
  3826     12  FILLER              PIC X           VALUE SPACES.
  3827     12  MD2-LF-ALT-PREM-DESC PIC X(16)       VALUE
  3828             'LIFE ALT PREM = '.
  3829     12  MD2-LF-ALT-PREM     PIC Z,ZZZ,ZZZ.99-.
  3830     12  FILLER              PIC XX          VALUE SPACES.
  3831     12  MD2-AH-PREM-DESC    PIC X(18)       VALUE
  3832             'A/H PREMIUM = '.
  3833     12  MD2-AH-PREM         PIC Z,ZZZ,ZZZ.99-.
  3834     12  FILLER              PIC X(39)       VALUE SPACES.
  3835
  3836 01  MISMATCH-DETAIL-3.
  3837     12  FILLER              PIC X           VALUE ' '.
  3838     12  FILLER              PIC X           VALUE SPACES.
  3839     12  FILLER              PIC X(16)       VALUE
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  77
* ECS010Z.cbl
  3840             ' LIFE  REFUND = '.
  3841     12  MD3-LF-REFUND       PIC Z,ZZZ,ZZZ.99-.
  3842     12  FILLER              PIC X           VALUE SPACES.
  3843     12  FILLER              PIC X(16)       VALUE
  3844             'A & H  REFUND = '.
  3845     12  MD3-AH-REFUND       PIC Z,ZZZ,ZZZ.99-.
  3846     12  FILLER              PIC X(72)       VALUE SPACES.
  3847
  3848 01  MISMATCH-DETAIL-4.
  3849     12  FILLER              PIC X           VALUE ' '.
  3850     12  FILLER              PIC X           VALUE SPACES.
  3851     12  FILLER              PIC X(16)       VALUE
  3852             ' LIFE  CLAIM  = '.
  3853     12  MD4-LF-CLAIM        PIC Z,ZZZ,ZZZ.99-.
  3854     12  FILLER              PIC X           VALUE SPACES.
  3855     12  FILLER              PIC X(16)       VALUE
  3856             'A & H  CLAIM  = '.
  3857     12  MD4-AH-CLAIM        PIC Z,ZZZ,ZZZ.99-.
  3858     12  FILLER              PIC X(72)       VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  78
* ECS010Z.cbl
  3860*
  3861*
  3862* LEAVE THE ABOVE 2 LINES IN TO PREVENT LOSING THE LINE ABOVE
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  79
* ECS010Z.cbl
  3864 01  PB-STARTS-HERE              PIC X(48)
  3865       VALUE '*****  PENDING BUSINESS RECORD STARTS HERE  ****'.
  3866
* 3867                             COPY ERCPNDB.
  3868******************************************************************
  3869*                                                                *
  3870*                                                                *
  3871*                            ERCPNDB.                            *
  3872*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3873*                            VMOD=2.025                          *
  3874*                                                                *
  3875*   FILE DESCRIPTION = PENDING NEW BUSINESS (ISSUES AND CANCELS) *
  3876*                                                                *
  3877******************************************************************
  3878*   NOTE: IF THIS FORMAT IS CHANGED, THE SORT RECORD IN THE      *
  3879*         EL861 A/R SYSTEM MAY NEED TO BE CHANGED.               *
  3880******************************************************************
  3881*                                                                *
  3882*                                                                *
  3883*   FILE TYPE = VSAM,KSDS                                        *
  3884*   RECORD SIZE = 585  RECFORM = FIXED                           *
  3885*                                                                *
  3886*   BASE CLUSTER = ERPNDB                         RKP=2,LEN=11   *
  3887*       ALTERNATE PATH1 = ERPNDB2  (BY CAR GRP STATE ACCOUNT     *
  3888*                                  EFF-DT CERT CHG-SEQ REC-TYPE) *
  3889*                                                 RKP=13,LEN=36  *
  3890*       ALTERNATE PATH2 = ERPNDB3  (BY CO, ORIGINAL BATCH, SEQ.  *
  3891*                                      AND CHG-SEQ.)             *
  3892*                                                RKP=49,LEN=11   *
  3893*       ALTERNATE PATH3 = ERPNDB4  (BY CO, CSR-ID, BATCH, SEQ.   *
  3894*                                      AND CHG-SEQ.)             *
  3895*                                                RKP=60,LEN=15   *
  3896*                                                                *
  3897*   LOG = NO                                                     *
  3898*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3899******************************************************************
  3900******************************************************************
  3901*                   C H A N G E   L O G
  3902*
  3903* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3904*-----------------------------------------------------------------
  3905*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3906* EFFECTIVE    NUMBER
  3907*-----------------------------------------------------------------
  3908* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  3909* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  3910* 011904                   PEMA  ADD TOTAL FEE PROCESSING
  3911* 040504    2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  3912* 020305    2005020000000  PEMA  ADD CLP STATE TO PNDB RECORD
  3913* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  3914* 032306                   PEMA  ADD BOW LOAN NUMBER
  3915* 081606    2006080800002  PEMA  ADD VIN, ISSUES ONLY
  3916* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
  3917* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  3918* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  3919* 032109    2009021700002  PEMA  ADD CRED BENE TO PNDB REC
  3920* 072209  CR2008101500003  AJRA  ADD BORROWER FIRST NAME TO ENDORSEMENT
  3921* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  80
* ECS010Z.cbl (/apps/prod/cid1p/copy/ERCPNDB)
  3922* 071211  CR2010012700001  PEMA  ADD SPP DEALER DIRECT
  3923* 073114  CR2014012300001  PEMA  ADD CU CARRIER 7 PROCESSING
  3924******************************************************************
  3925
  3926 01  PENDING-BUSINESS.
  3927     12  PB-RECORD-ID                     PIC XX.
  3928         88  VALID-PB-ID                        VALUE 'PB'.
  3929
  3930     12  PB-CONTROL-PRIMARY.
  3931         16  PB-COMPANY-CD                PIC X.
  3932         16  PB-ENTRY-BATCH               PIC X(6).
  3933         16  PB-BATCH-SEQ-NO              PIC S9(4)     COMP.
  3934         16  PB-BATCH-CHG-SEQ-NO          PIC S9(4)     COMP.
  3935
  3936     12  PB-CONTROL-BY-ACCOUNT.
  3937         16  PB-COMPANY-CD-A1             PIC X.
  3938         16  PB-CARRIER                   PIC X.
  3939         16  PB-GROUPING.
  3940             20  PB-GROUPING-PREFIX       PIC XXX.
  3941             20  PB-GROUPING-PRIME        PIC XXX.
  3942         16  PB-STATE                     PIC XX.
  3943         16  PB-ACCOUNT.
  3944             20  PB-ACCOUNT-PREFIX        PIC X(4).
  3945             20  PB-ACCOUNT-PRIME         PIC X(6).
  3946         16  PB-CERT-EFF-DT               PIC XX.
  3947         16  PB-CERT-NO.
  3948             20  PB-CERT-PRIME            PIC X(10).
  3949             20  PB-CERT-SFX              PIC X.
  3950         16  PB-ALT-CHG-SEQ-NO            PIC S9(4)     COMP.
  3951
  3952         16  PB-RECORD-TYPE               PIC X.
  3953             88  PB-MAILING-DATA                VALUE '0'.
  3954             88  PB-ISSUE                       VALUE '1'.
  3955             88  PB-CANCELLATION                VALUE '2'.
  3956             88  PB-BATCH-TRAILER               VALUE '9'.
  3957
  3958     12  PB-CONTROL-BY-ORIG-BATCH.
  3959         16  PB-ORIGINAL-COMPANY-CD       PIC X.
  3960         16  PB-ORIGINAL-ENTRY-BATCH      PIC X(6).
  3961         16  PB-ORIGINAL-SEQ-NO           PIC S9(4)     COMP.
  3962         16  PB-ORIGINAL-CHG-SEQ-NO       PIC S9(4)     COMP.
  3963
  3964     12  PB-CONTROL-BY-CSR.
  3965         16  PB-CSR-COMPANY-CD            PIC X.
  3966         16  PB-CSR-ID                    PIC X(4).
  3967         16  PB-CSR-ENTRY-BATCH           PIC X(6).
  3968         16  PB-CSR-BATCH-SEQ-NO          PIC S9(4)     COMP.
  3969         16  PB-CSR-BATCH-CHG-SEQ-NO      PIC S9(4)     COMP.
  3970******************************************************************
  3971*    MAILING DATA IS PROCESSED IN ONLY PRGS. EL512 & EL513       *
  3972******************************************************************
  3973
  3974     12  PB-LAST-MAINT-DT                 PIC XX.
  3975     12  PB-LAST-MAINT-BY                 PIC X(4).
  3976     12  PB-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.
  3977
  3978     12  PB-RECORD-BODY                   PIC X(375).
  3979
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  81
* ECS010Z.cbl (/apps/prod/cid1p/copy/ERCPNDB)
  3980     12  PB-ISSUE-RECORD   REDEFINES PB-RECORD-BODY.
  3981         16  PB-CERT-ORIGIN               PIC X.
  3982             88  CLASIC-CREATED-CERT         VALUE '1'.
  3983         16  PB-I-NAME.
  3984             20  PB-I-INSURED-LAST-NAME   PIC X(15).
  3985             20  PB-I-INSURED-FIRST-NAME.
  3986                 24  PB-I-INSURED-1ST-INIT PIC X.
  3987                 24  FILLER                PIC X(9).
  3988             20  PB-I-INSURED-MIDDLE-INIT PIC X.
  3989         16  PB-I-AGE                     PIC S99   COMP-3.
  3990         16  PB-I-JOINT-AGE               PIC S99   COMP-3.
  3991         16  PB-I-BIRTHDAY                PIC XX.
  3992         16  PB-I-INSURED-SEX             PIC X.
  3993             88  PB-SEX-MALE     VALUE 'M'.
  3994             88  PB-SEX-FEMALE   VALUE 'F'.
  3995
  3996         16  PB-I-LF-TERM                 PIC S999   COMP-3.
  3997         16  PB-I-AH-TERM                 PIC S999   COMP-3.
  3998         16  PB-I-LOAN-TERM               PIC S999   COMP-3.
  3999         16  PB-I-PAY-FREQUENCY           PIC S99    COMP-3.
  4000         16  PB-I-SKIP-CODE               PIC X.
  4001             88  PB-NO-MONTHS-SKIPPED      VALUE ' ' '0'.
  4002             88  PB-SKIP-JULY              VALUE '1'.
  4003             88  PB-SKIP-AUGUST            VALUE '2'.
  4004             88  PB-SKIP-SEPTEMBER         VALUE '3'.
  4005             88  PB-SKIP-JULY-AUG          VALUE '4'.
  4006             88  PB-SKIP-AUG-SEPT          VALUE '5'.
  4007             88  PB-SKIP-JULY-AUG-SEPT     VALUE '6'.
  4008             88  PB-SKIP-JUNE-JULY-AUG     VALUE '7'.
  4009             88  PB-SKIP-JUNE              VALUE '8'.
  4010             88  PB-SKIP-JUNE-JULY         VALUE '9'.
  4011             88  PB-SKIP-AUG-SEPT-OCT      VALUE 'A'.
  4012             88  PB-SKIP-BI-WKLY-3RD-PMT   VALUE 'X'.
  4013         16  PB-I-TERM-TYPE               PIC X.
  4014             88  PB-PAID-MONTHLY           VALUE ' ' 'M'.
  4015             88  PB-PAID-WEEKLY            VALUE 'W'.
  4016             88  PB-PAID-SEMI-MONTHLY      VALUE 'S'.
  4017             88  PB-PAID-BI-WEEKLY         VALUE 'B'.
  4018             88  PB-PAID-13-YEARLY         VALUE 'T'.
  4019         16  PB-I-NO-OF-PAYMENTS          PIC S999   COMP-3.
  4020         16  PB-I-POLICY-FORM-NO          PIC X(12).
  4021         16  PB-I-DATA-ENTRY-SW           PIC X.
  4022             88  PB-EFF-DT-PROCESSING      VALUE '1' ' '.
  4023             88  PB-EXT-DAYS-PROCESSING    VALUE '2'.
  4024             88  PB-EXPIRE-DT-PROCESSING   VALUE '3'.
  4025             88  PB-1ST-PMT-DT-PROCESSING  VALUE '4'.
  4026         16  PB-I-PAYMENT-AMOUNT          PIC S9(7)V99  COMP-3.
  4027         16  PB-I-DCC-OVER-CHG-AMT        PIC S9(5)V99  COMP-3.
  4028*        16  PB-I-MICROFILM-NO            PIC S9(9)      COMP-3.
  4029         16  PB-I-AH-CLP                  PIC S9(5)V99 COMP-3.
  4030         16  FILLER                       PIC X.
  4031
  4032         16  PB-I-LIFE-BENEFIT-CD         PIC XX.
  4033             88  PB-VALID-LIFE               VALUE '01' THRU '89'.
  4034             88  PB-INVALID-LIFE             VALUE '  ' '00'
  4035                                                   '90' THRU '99'.
  4036         16  PB-I-LF-BENEFIT-CD   REDEFINES PB-I-LIFE-BENEFIT-CD
  4037                                          PIC XX.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  82
* ECS010Z.cbl (/apps/prod/cid1p/copy/ERCPNDB)
  4038         16  PB-I-LF-BENEFIT-AMT          PIC S9(9)V99   COMP-3.
  4039         16  PB-I-AMOUNT-FINANCED REDEFINES
  4040                  PB-I-LF-BENEFIT-AMT     PIC S9(9)V99   COMP-3.
  4041         16  PB-I-LF-ALT-BENEFIT-AMT      PIC S9(9)V99   COMP-3.
  4042         16  PB-I-UNPAID-CASH-PRICE REDEFINES
  4043                  PB-I-LF-ALT-BENEFIT-AMT PIC S9(9)V99   COMP-3.
  4044         16  PB-I-LF-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  4045         16  PB-I-LF-ALT-PREMIUM-AMT      PIC S9(7)V99   COMP-3.
  4046         16  PB-I-CLP-AMOUNT REDEFINES
  4047                  PB-I-LF-ALT-PREMIUM-AMT PIC S9(7)V99   COMP-3.
  4048         16  PB-I-LF-CALC-FLAG            PIC X.
  4049             88 PB-COMP-LF-PREM               VALUE '?'.
  4050         16  PB-I-LF-PREM-CALC            PIC S9(7)V99   COMP-3.
  4051         16  PB-I-LF-ALT-PREM-CALC        PIC S9(7)V99   COMP-3.
  4052         16  PB-I-LF-RATE                 PIC S99V9(5)   COMP-3.
  4053         16  PB-I-LF-ALT-RATE             PIC S99V9(5)   COMP-3.
  4054         16  PB-I-LF-POLICY-FEE           PIC S9(3)V99   COMP-3.
  4055         16  PB-I-LF-REI-RATE             PIC S99V9(5)   COMP-3.
  4056         16  PB-I-LF-ALT-REI-RATE         PIC S99V9(5)   COMP-3.
  4057         16  PB-I-LF-ABBR                 PIC XXX.
  4058         16  PB-I-LF-INPUT-CD             PIC XX.
  4059
  4060         16  PB-I-AH-BENEFIT-CD           PIC XX.
  4061             88  PB-VALID-AH                 VALUE '01' THRU '89'.
  4062             88  PB-INVALID-AH               VALUE '  ' '00'
  4063                                                   '90' THRU '99'.
  4064         16  PB-I-AH-BENEFIT-AMT          PIC S9(7)V99   COMP-3.
  4065         16  PB-I-AH-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  4066         16  PB-I-AH-CALC-FLAG            PIC X.
  4067             88 PB-COMP-AH-PREM                  VALUE '?'.
  4068         16  PB-I-AH-PREM-CALC            PIC S9(7)V99   COMP-3.
  4069         16  PB-I-AH-RATE                 PIC S99V9(5)   COMP-3.
  4070         16  PB-I-AH-POLICY-FEE           PIC S9(3)V99   COMP-3.
  4071         16  PB-I-AH-REI-RATE             PIC S99V9(5)   COMP-3.
  4072         16  PB-I-AH-RATE-TRM             PIC S999       COMP-3.
  4073         16  PB-I-AH-ABBR                 PIC XXX.
  4074         16  PB-I-AH-INPUT-CD             PIC XXX.
  4075
  4076         16  PB-I-SPECIAL-REIN-CODE       PIC X.
  4077         16  PB-I-REIN-TABLE              PIC XXX.
  4078         16  PB-I-BUSINESS-TYPE           PIC 99.
  4079         16  PB-I-INDV-GRP-CD             PIC X.
  4080         16  PB-I-MORT-CODE.
  4081             20  PB-I-TABLE               PIC X.
  4082             20  PB-I-INTEREST            PIC XX.
  4083             20  PB-I-MORT-TYP            PIC X.
  4084         16  PB-I-LF-CRIT-PER             PIC S9(3)      COMP-3.
  4085         16  PB-I-AH-CRIT-PER             PIC S9(3)      COMP-3.
  4086         16  PB-I-LF-CLP                  PIC S9(5)V99   COMP-3.
  4087         16  PB-I-INDV-GRP-OVRD           PIC X.
  4088         16  PB-I-RATE-CLASS-OVRD         PIC XX.
  4089         16  PB-I-SIG-SW                  PIC X.
  4090             88  PB-POLICY-SIGNED             VALUE 'Y'.
  4091         16  PB-I-RATE-CLASS              PIC XX.
  4092         16  PB-I-RATE-DEVIATION-LF       PIC XXX.
  4093         16  PB-I-RATE-DEVIATION-AH       PIC XXX.
  4094         16  PB-I-RATE-DEV-PCT-LF         PIC S9V9(6)    COMP-3.
  4095         16  PB-I-RATE-DEV-PCT-AH         PIC S9V9(6)    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  83
* ECS010Z.cbl (/apps/prod/cid1p/copy/ERCPNDB)
  4096         16  PB-I-LIFE-COMMISSION         PIC SV9(5)     COMP-3.
  4097         16  PB-I-JOINT-COMMISSION        PIC SV9(5)     COMP-3.
  4098         16  PB-I-AH-COMMISSION           PIC SV9(5)     COMP-3.
  4099         16  PB-I-BENEFIT-TYPE            PIC XXX.
  4100         16  PB-I-OB-FLAG                 PIC X.
  4101             88  PB-I-OB                      VALUE 'B'.
  4102             88  PB-I-SUMMARY                 VALUE 'Z'.
  4103         16  PB-I-ENTRY-STATUS            PIC X.
  4104             88  PB-I-POLICY-IS-ACTIVE        VALUE '1' '3' '4'
  4105                                              'M' '5' '9' '2'.
  4106             88  PB-I-NORMAL-ENTRY            VALUE '1'.
  4107             88  PB-I-POLICY-PENDING          VALUE '2'.
  4108             88  PB-I-CONVERSION-ENTRY        VALUE '4'.
  4109             88  PB-I-POLICY-IS-REISSUE       VALUE '5'.
  4110             88  PB-I-POLICY-IS-CASH          VALUE 'C'.
  4111             88  PB-I-POLICY-IS-MONTHLY       VALUE 'M'.
  4112             88  PB-I-REIN-ONLY               VALUE '9'.
  4113             88  PB-I-POLICY-IS-DECLINED      VALUE 'D'.
  4114             88  PB-I-POLICY-IS-VOIDED        VALUE 'V'.
  4115             88  PB-I-PREM-ACCTNG-ONLY        VALUE 'P'.
  4116             88  PB-I-UNDERWRITE-POLICY       VALUE 'U'.
  4117         16  PB-I-INT-CODE                PIC X.
  4118             88  PB-ADD-ON-INTEREST           VALUE 'A'.
  4119             88  PB-SIMPLE-INTEREST           VALUE 'S'.
  4120         16  PB-I-LOAN-APR                PIC 9(3)V9(4)   COMP-3.
  4121         16  PB-I-SOC-SEC-NO              PIC X(11).
  4122         16  PB-I-MEMBER-NO               PIC X(12).
  4123         16  PB-I-CURR-SEQ                PIC S9(4)       COMP.
  4124*        16  PB-I-LOAN-OFFICER            PIC XXX.
  4125         16  PB-I-OLD-LOF                 PIC XXX.
  4126         16  PB-I-LF-EXPIRE-DT            PIC XX.
  4127         16  PB-I-AH-EXPIRE-DT            PIC XX.
  4128         16  PB-I-EXTENTION-DAYS          PIC S999        COMP-3.
  4129         16  PB-I-TERM-IN-DAYS            PIC S9(5)       COMP-3.
  4130         16  PB-I-LIFE-INDICATOR          PIC X.
  4131             88  PB-I-JOINT-COVERAGE         VALUE 'J'.
  4132         16  PB-I-LIVES                   PIC S9(7)       COMP-3.
  4133         16  PB-I-DDF-IU-RATE-UP REDEFINES PB-I-LIVES
  4134                                          PIC S9(5)V99    COMP-3.
  4135         16  PB-I-MAIL-ADDRS-SW           PIC X.
  4136             88 PB-I-MAIL-ADDRS-NOT-PRESENT  VALUE ' '.
  4137             88 PB-I-MAIL-ADDRS-PRESENT      VALUE '1'.
  4138         16  PB-I-1ST-PMT-DT              PIC XX.
  4139         16  PB-I-JOINT-INSURED.
  4140             20 PB-I-JOINT-LAST-NAME      PIC X(15).
  4141             20 PB-I-JOINT-FIRST-NAME.
  4142                24  PB-I-JOINT-FIRST-INIT PIC X.
  4143                24  FILLER                PIC X(9).
  4144             20 PB-I-JOINT-MIDDLE-INIT    PIC X.
  4145*        16  PB-I-BENEFICIARY-NAME        PIC X(25).
  4146         16  PB-I-BENEFICIARY-NAME.
  4147             20  PB-I-BANK-NUMBER         PIC X(10).
  4148             20  FILLER                   PIC X(15).
  4149         16  PB-I-LAST-ADD-ON-DT          PIC XX.
  4150         16  PB-I-REFERENCE               PIC X(12).
  4151         16  FILLER REDEFINES PB-I-REFERENCE.
  4152             20  PB-I-TOT-FEES            PIC S9(7)V99 COMP-3.
  4153             20  PB-I-TOT-FEES-CALC       PIC S9(7)V99 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  84
* ECS010Z.cbl (/apps/prod/cid1p/copy/ERCPNDB)
  4154             20  PB-I-CLP-STATE           PIC XX.
  4155         16  PB-I-UNDERWRITING-STATUS     PIC X.
  4156             88  PB-I-POLICY-ACCEPTED         VALUE 'A' 'N'.
  4157             88  PB-I-POLICY-DECLINED         VALUE 'D'.
  4158             88  PB-I-NEEDS-UNDERWRITING      VALUE 'U'.
  4159         16  PB-I-STATE-TAX               PIC S9(7)V99 COMP-3.
  4160         16  PB-I-MUNI-TAX                PIC S9(7)V99 COMP-3.
  4161         16  PB-I-RESIDENT-STATE          PIC XX.
  4162         16  PB-I-RATE-CODE               PIC X(4).
  4163         16  PB-I-NUM-BILLED              PIC S9(7)    COMP-3.
  4164         16  PB-I-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  4165         16  PB-I-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  4166         16  PB-I-BANK-FEE                PIC S999V99  COMP-3.
  4167         16  PB-I-BANK-NOCHRGB            PIC 99.
  4168         16  PB-I-ADDL-CLP                PIC S9(5)V99 COMP-3.
  4169         16  PB-I-JOINT-BIRTHDAY          PIC XX.
  4170
  4171     12  PB-CANCEL-RECORD   REDEFINES PB-RECORD-BODY.
  4172         16  PB-C-LF-CANCEL-VOID-SW       PIC X.
  4173             88  PB-C-LF-CANCEL-VOIDED        VALUE '1'.
  4174         16  PB-C-CANCEL-ORIGIN           PIC X.
  4175             88  PB-C-CLAIM-CREATED-CANCEL   VALUE '1'.
  4176         16  PB-C-LF-CANCEL-DT            PIC XX.
  4177         16  PB-C-LF-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  4178         16  PB-C-LF-CALC-REQ             PIC X.
  4179             88 PB-COMP-LF-CANCEL            VALUE '?'.
  4180         16  PB-C-LF-REF-CALC             PIC S9(7)V99    COMP-3.
  4181         16  PB-C-LF-REM-TERM             PIC S9(3)       COMP-3.
  4182         16  PB-C-AH-CANCEL-VOID-SW       PIC X.
  4183             88  PB-C-AH-CANCEL-VOIDED        VALUE '1'.
  4184         16  PB-C-AH-CANCEL-DT            PIC XX.
  4185         16  PB-C-AH-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  4186         16  PB-C-AH-CALC-REQ             PIC X.
  4187             88 PB-COMP-AH-CANCEL            VALUE '?'.
  4188         16  PB-C-AH-REF-CALC             PIC S9(7)V99    COMP-3.
  4189         16  PB-C-AH-REM-TERM             PIC S9(3)       COMP-3.
  4190         16  PB-C-LAST-NAME               PIC X(15).
  4191         16  PB-C-REFUND-SW               PIC X.
  4192             88  PB-C-REFUND-CREATED          VALUE 'Y'.
  4193             88  PB-C-REFUND-REQUESTED        VALUE 'R'.
  4194         16  PB-C-LIVES                   PIC S9(3)       COMP-3.
  4195         16  PB-C-PAYEE-CODE              PIC X(6).
  4196         16  PB-C-LF-REFUND-OVERRIDE      PIC X.
  4197         16  PB-C-AH-REFUND-OVERRIDE      PIC X.
  4198         16  PB-C-LF-COMM-CHARGEBACK      PIC X.
  4199         16  PB-C-AH-COMM-CHARGEBACK      PIC X.
  4200         16  PB-C-REFERENCE               PIC X(12).
  4201         16  PB-C-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  4202         16  PB-C-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  4203         16  PB-C-POST-CARD-IND           PIC X.
  4204         16  PB-C-CANCEL-REASON           PIC X.
  4205         16  PB-C-REF-INTERFACE-SW        PIC X.
  4206         16  PB-C-LF-RFND-CLP             PIC S9(5)V99 COMP-3.
  4207         16  PB-C-AH-RFND-CLP             PIC S9(5)V99 COMP-3.
  4208         16  FILLER                       PIC X(01).
  4209*        16  FILLER                       PIC X(18).
  4210         16  PB-C-POLICY-FORM-NO          PIC X(12).
  4211*        16  PB-C-MICROFILM-NO            PIC S9(9)      COMP-3.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  85
* ECS010Z.cbl (/apps/prod/cid1p/copy/ERCPNDB)
  4212         16  PB-C-NH-INT-ON-REFS          PIC S9(7)V99   COMP-3.
  4213         16  PB-CANCELED-CERT-DATA.
  4214             20  PB-CI-INSURED-NAME.
  4215                 24  PB-CI-LAST-NAME      PIC X(15).
  4216                 24  PB-CI-INITIALS       PIC XX.
  4217             20  PB-CI-INSURED-AGE        PIC S99         COMP-3.
  4218             20  PB-CI-INSURED-SEX        PIC X.
  4219             20  PB-CI-LF-TERM            PIC S999        COMP-3.
  4220             20  PB-CI-LF-BENEFIT-CD      PIC XX.
  4221             20  PB-CI-LF-BENEFIT-AMT     PIC S9(9)V99    COMP-3.
  4222             20  PB-CI-LF-ALT-BENEFIT-AMT PIC S9(9)V99    COMP-3.
  4223             20  PB-CI-LF-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  4224             20  PB-CI-LF-ALT-PREMIUM-AMT PIC S9(7)V99    COMP-3.
  4225             20  PB-CI-AH-TERM            PIC S999        COMP-3.
  4226             20  PB-CI-AH-BENEFIT-CD      PIC XX.
  4227             20  PB-CI-AH-BENEFIT-AMT     PIC S9(7)V99    COMP-3.
  4228             20  PB-CI-AH-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  4229             20  PB-CI-RATE-CLASS         PIC XX.
  4230             20  PB-CI-RATE-DEV-LF        PIC XXX.
  4231             20  PB-CI-RATE-DEV-AH        PIC XXX.
  4232             20  PB-CI-RATE-DEV-PCT-LF    PIC S9V9(6)     COMP-3.
  4233             20  PB-CI-RATE-DEV-PCT-AH    PIC S9V9(6)     COMP-3.
  4234             20  PB-CI-LIFE-COMMISSION    PIC SV9(5)      COMP-3.
  4235             20  PB-CI-AH-COMMISSION      PIC SV9(5)      COMP-3.
  4236             20  PB-CI-LF-ABBR            PIC X(3).
  4237             20  PB-CI-AH-ABBR            PIC X(3).
  4238             20  PB-CI-OB-FLAG            PIC X.
  4239                 88  PB-CI-OB                VALUE 'B'.
  4240             20  PB-CI-LF-POLICY-STATUS   PIC X.
  4241                 88  PB-CI-LF-POLICY-IS-ACTIVE       VALUE '1' '3'
  4242                                           'M' '4' '5' '9' '2'.
  4243                 88  PB-CI-LF-NORMAL-ENTRY           VALUE '1'.
  4244                 88  PB-CI-LF-POLICY-PENDING         VALUE '2'.
  4245                 88  PB-CI-LF-POLICY-IS-RESTORE      VALUE '3'.
  4246                 88  PB-CI-LF-CONVERSION-ENTRY       VALUE '4'.
  4247                 88  PB-CI-LF-POLICY-IS-REISSUE      VALUE '5'.
  4248                 88  PB-CI-LF-POLICY-IS-CASH         VALUE 'C'.
  4249                 88  PB-CI-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  4250                 88  PB-CI-LF-LUMP-SUM-DISAB         VALUE '6'.
  4251                 88  PB-CI-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  4252                 88  PB-CI-LF-CANCEL-APPLIED         VALUE '8'.
  4253                 88  PB-CI-LF-REIN-ONLY              VALUE '9'.
  4254                 88  PB-CI-LF-POLICY-IS-DECLINED     VALUE 'D'.
  4255                 88  PB-CI-LF-POLICY-IS-VOID         VALUE 'V'.
  4256             20  PB-CI-AH-POLICY-STATUS   PIC X.
  4257                 88  PB-CI-AH-POLICY-IS-ACTIVE       VALUE '1' '3'
  4258                                           'M' '4' '5' '9' '2'.
  4259                 88  PB-CI-AH-NORMAL-ENTRY           VALUE '1'.
  4260                 88  PB-CI-AH-POLICY-PENDING         VALUE '2'.
  4261                 88  PB-CI-AH-POLICY-IS-RESTORE      VALUE '3'.
  4262                 88  PB-CI-AH-CONVERSION-ENTRY       VALUE '4'.
  4263                 88  PB-CI-AH-POLICY-IS-REISSUE      VALUE '5'.
  4264                 88  PB-CI-AH-POLICY-IS-CASH         VALUE 'C'.
  4265                 88  PB-CI-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  4266                 88  PB-CI-AH-LUMP-SUM-DISAB         VALUE '6'.
  4267                 88  PB-CI-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  4268                 88  PB-CI-AH-CANCEL-APPLIED         VALUE '8'.
  4269                 88  PB-CI-AH-REIN-ONLY              VALUE '9'.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  86
* ECS010Z.cbl (/apps/prod/cid1p/copy/ERCPNDB)
  4270                 88  PB-CI-AH-POLICY-IS-DECLINED     VALUE 'D'.
  4271                 88  PB-CI-AH-POLICY-IS-VOID         VALUE 'V'.
  4272             20  PB-CI-PAY-FREQUENCY      PIC 99.
  4273             20  PB-CI-LOAN-APR           PIC 9(3)V9(4)   COMP-3.
  4274             20  PB-CI-SOC-SEC-NO         PIC X(11).
  4275             20  PB-CI-MEMBER-NO          PIC X(12).
  4276             20  PB-CI-INT-CODE           PIC X.
  4277                 88  PB-CI-ADD-ON                  VALUE 'A'.
  4278                 88  PB-CI-SIMPLE                  VALUE 'S'.
  4279             20  PB-CI-LOAN-TERM          PIC S999        COMP-3.
  4280             20  PB-CI-LOAN-1ST-PMT-DT    PIC X(2).
  4281             20  PB-CI-COMP-EXCP-SW       PIC X.
  4282                 88  PB-CI-NO-COMP-EXCP            VALUE ' '.
  4283                 88  PB-CI-CERT-HAS-ERCOMM-ENTRY   VALUE '1'.
  4284             20  PB-CI-ENTRY-STATUS       PIC X.
  4285             20  PB-CI-CURR-SEQ           PIC S9(4)       COMP.
  4286             20  PB-CI-AH-PAID-THRU-DT    PIC XX.
  4287             20  PB-CI-AH-SETTLEMENT-DT   PIC XX.
  4288             20  PB-CI-DEATH-DT           PIC XX.
  4289             20  PB-CI-LF-PRIOR-CANCEL-DT PIC XX.
  4290             20  PB-CI-AH-PRIOR-CANCEL-DT PIC XX.
  4291             20  PB-CI-AH-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  4292             20  PB-CI-LF-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  4293             20  PB-CI-CREDIT-INTERFACE-SW-1 PIC X.
  4294             20  PB-CI-CREDIT-INTERFACE-SW-2 PIC X.
  4295             20  PB-CI-ENTRY-DT              PIC XX.
  4296             20  PB-CI-ENTRY-BATCH           PIC X(6).
  4297             20  PB-CI-LF-EXPIRE-DT          PIC XX.
  4298             20  PB-CI-AH-EXPIRE-DT          PIC XX.
  4299             20  PB-CI-EXTENTION-DAYS        PIC S999     COMP-3.
  4300             20  PB-CI-TERM-IN-DAYS          PIC S9(5)    COMP-3.
  4301             20  PB-CI-OLD-LOF               PIC XXX.
  4302*            20  PB-CI-LOAN-OFFICER          PIC XXX.
  4303             20  PB-CI-LIVES                 PIC S9(3)    COMP-3.
  4304             20  PB-CI-LF-CRIT-PER           PIC S9(3)    COMP-3.
  4305             20  PB-CI-AH-CRIT-PER           PIC S9(3)    COMP-3.
  4306             20  PB-CI-INDV-GRP-CD           PIC X.
  4307             20  PB-CI-BENEFICIARY-NAME.
  4308                 24  PB-CI-BANK-NUMBER       PIC X(10).
  4309                 24  FILLER                  PIC X(15).
  4310             20  PB-CI-NOTE-SW               PIC X.
  4311             20  PB-CI-CANCEL-FEE            PIC S9(3)V99 COMP-3.
  4312             20  PB-CI-MUNI-TAX              PIC S9(7)V99 COMP-3.
  4313             20  PB-CI-STATE-TAX             PIC S9(7)V99 COMP-3.
  4314             20  PB-CI-ADDL-CLP              PIC S9(5)V99 COMP-3.
  4315             20  PB-CI-LOAN-OFFICER          PIC X(5).
  4316             20  PB-CI-BOW-LOAN-NUMBER       PIC X(14).
  4317             20  PB-CI-FIRST-NAME            PIC X(10).
  4318             20  PB-CI-DDF-IU-RATE-UP        PIC S9(5)V99 COMP-3.
  4319
  4320         16  FILLER                       PIC X(13).
  4321*032306  16  FILLER                       PIC X(27).
  4322*        16  FILLER                       PIC X(46).
  4323
  4324     12  PB-MAIL-RECORD    REDEFINES PB-RECORD-BODY.
  4325         16  FILLER                       PIC X(10).
  4326         16  PB-M-INSURED-LAST-NAME       PIC X(15).
  4327         16  PB-M-INSURED-FIRST-NAME      PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  87
* ECS010Z.cbl (/apps/prod/cid1p/copy/ERCPNDB)
  4328         16  PB-M-INSURED-MID-INIT        PIC X.
  4329         16  PB-M-INSURED-AGE             PIC 99.
  4330         16  PB-M-INSURED-BIRTHDAY        PIC XX.
  4331         16  PB-M-INSURED-SEX             PIC X.
  4332         16  PB-M-INSURED-SOC-SEC-NO      PIC X(11).
  4333         16  PB-M-INSURED-ADDRESS-1       PIC X(30).
  4334         16  PB-M-INSURED-ADDRESS-2       PIC X(30).
  4335         16  PB-M-INSURED-CITY-STATE.
  4336             20  PB-M-INSURED-CITY        PIC X(28).
  4337             20  PB-M-INSURED-STATE       PIC XX.
  4338         16  PB-M-INSURED-ZIP-CODE.
  4339             20  PB-M-INSURED-ZIP-PRIME.
  4340                 24  PB-M-INSURED-ZIP-1   PIC X.
  4341                     88  PB-M-CANADIAN-POST-CODE
  4342                                             VALUE 'A' THRU 'Z'.
  4343                 24  FILLER               PIC X(4).
  4344             20  PB-M-INSURED-ZIP-PLUS4   PIC X(4).
  4345         16  PB-M-INSURED-CANADIAN-ZIP  REDEFINES
  4346                                        PB-M-INSURED-ZIP-CODE.
  4347             20  PM-M-INS-CAN-POST1       PIC XXX.
  4348             20  PM-M-INS-CAN-POST2       PIC XXX.
  4349             20  FILLER                   PIC XXX.
  4350         16  PB-M-INSURED-PHONE-NO        PIC 9(10).
  4351         16  PB-M-JOINT-BIRTHDAY          PIC XX.
  4352         16  PB-M-CRED-BENE-NAME          PIC X(30).
  4353         16  PB-M-CRED-BENE-ADDR1         PIC X(30).
  4354         16  PB-M-CRED-BENE-ADDR2         PIC X(30).
  4355         16  PB-M-CRED-BENE-CITYST.
  4356             20  PB-M-CRED-BENE-CITY      PIC X(28).
  4357             20  PB-M-CRED-BENE-STATE     PIC XX.
  4358
  4359         16  FILLER                       PIC X(92).
  4360
  4361     12  PB-BATCH-RECORD   REDEFINES PB-RECORD-BODY.
  4362         16  FILLER                       PIC X(10).
  4363         16  PB-B-LF-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4364         16  PB-B-LF-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4365         16  PB-B-LF-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4366         16  PB-B-LF-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4367         16  PB-B-LF-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4368         16  PB-B-LF-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4369         16  PB-B-AH-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4370         16  PB-B-AH-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4371         16  PB-B-AH-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4372         16  PB-B-AH-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4373         16  PB-B-AH-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4374         16  PB-B-AH-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4375         16  PB-B-ISSUE-CNT-REMITTED      PIC S9(5)    COMP-3.
  4376         16  PB-B-ISSUE-CNT-ENTERED       PIC S9(5)    COMP-3.
  4377         16  PB-B-CANCEL-CNT-REMITTED     PIC S9(5)    COMP-3.
  4378         16  PB-B-CANCEL-CNT-ENTERED      PIC S9(5)    COMP-3.
  4379         16  PB-B-HIGHEST-SEQ-NO          PIC S9(4)    COMP.
  4380         16  PB-ACCOUNT-NAME              PIC X(30).
  4381         16  PB-PREM-REF-RPT-FLAG         PIC X.
  4382         16  PB-REFERENCE                 PIC X(12).
  4383         16  PB-B-RECEIVED-DT             PIC XX.
  4384         16  FILLER                       PIC X(234).
  4385
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  88
* ECS010Z.cbl (/apps/prod/cid1p/copy/ERCPNDB)
  4386     12  PB-RECORD-STATUS.
  4387         16  PB-CREDIT-SELECT-DT          PIC XX.
  4388         16  PB-CREDIT-ACCEPT-DT          PIC XX.
  4389         16  PB-BILLED-DT                 PIC XX.
  4390         16  PB-BILLING-STATUS            PIC X.
  4391             88  PB-ENTRY-REVERSED            VALUE 'R'.
  4392             88  PB-EL860-INTERNAL-ERROR      VALUE 'E'.
  4393             88  PB-EL860-INTERNAL-PROCESS    VALUE 'P'.
  4394         16  PB-RECORD-BILL               PIC X.
  4395             88  PB-RECORD-ON-HOLD            VALUE 'H'.
  4396             88  PB-RECORD-RETURNED           VALUE 'R'.
  4397             88  PB-RECORD-ENDORSED           VALUE 'E'.
  4398             88  PB-OVERRIDE-LIFE             VALUE 'L'.
  4399             88  PB-OVERRIDE-AH               VALUE 'A'.
  4400             88  PB-OVERRIDE-BOTH             VALUE 'B'.
  4401         16  PB-BATCH-ENTRY               PIC X.
  4402             88  PB-POLICY-IS-DECLINED        VALUE 'D'.
  4403             88  PB-REIN-ONLY-CERT            VALUE 'R'.
  4404             88  PB-REISSUED-CERT             VALUE 'E'.
  4405             88  PB-CASH-CERT                 VALUE 'C'.
  4406             88  PB-MONTHLY-CERT              VALUE 'M'.
  4407             88  PB-PREM-ACCTNG-ONLY          VALUE 'P'.
  4408             88  PB-NEEDS-UNDERWRITING        VALUE 'U'.
  4409             88  PB-POLICY-IS-VOIDED          VALUE 'V'.
  4410         16  PB-FORCE-CODE                PIC X.
  4411             88  PB-FORCE-OFF                 VALUE ' ' '0'.
  4412             88  PB-ISSUE-FORCE               VALUE 'A' 'O'.
  4413             88  PB-CANCEL-FORCE              VALUE '8'.
  4414             88  PB-ALL-ISSUE-FORCED          VALUE 'A' 'O'.
  4415             88  PB-ALL-CANCEL-FORCED         VALUE '8'.
  4416             88  PB-ALL-CANCEL-FORCED-NO-FEE  VALUE '9'.
  4417             88  PB-CANCEL-DATE-FORCED        VALUE 'D'.
  4418             88  PB-CANCEL-DATE-FORCED-NO-FEE VALUE 'E'.
  4419             88  PB-ISSUE-DATE-FORCED         VALUE 'D'.
  4420             88  PB-OVERCHARGE-FORCE          VALUE 'O'.
  4421         16  PB-FATAL-FLAG                PIC X.
  4422             88  PB-FATAL-ERRORS              VALUE 'X'.
  4423         16  PB-FORCE-ER-CD               PIC X.
  4424             88  PB-FORCE-ERRORS              VALUE 'F'.
  4425             88  PB-UNFORCED-ERRORS           VALUE 'X'.
  4426         16  PB-WARN-ER-CD                PIC X.
  4427             88  PB-WARNING-ERRORS            VALUE 'W'.
  4428         16  FILLER                       PIC X.
  4429         16  PB-OUT-BAL-CD                PIC X.
  4430             88  PB-OUT-OF-BAL                VALUE 'O'.
  4431         16  PB-LIFE-OVERRIDE-L1          PIC X.
  4432         16  PB-AH-OVERRIDE-L1            PIC X.
  4433         16  PB-INPUT-DT                  PIC XX.
  4434         16  PB-INPUT-BY                  PIC X(4).
  4435         16  PB-CHG-COUNT                 PIC 9(3)        COMP-3.
  4436         16  PB-CALC-TOLERANCE            PIC 9(3)V99     COMP-3.
  4437         16  PB-TOLERANCE-REJECT-SW       PIC X.
  4438         16  PB-LF-EARNING-METHOD         PIC X.
  4439         16  PB-AH-EARNING-METHOD         PIC X.
  4440         16  PB-LF-TERM-CALC-METHOD       PIC X.
  4441         16  PB-AH-TERM-CALC-METHOD       PIC X.
  4442         16  PB-REIN-CD                   PIC XXX.
  4443         16  PB-LF-REFUND-TYPE            PIC X.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  89
* ECS010Z.cbl (/apps/prod/cid1p/copy/ERCPNDB)
  4444         16  PB-AH-REFUND-TYPE            PIC X.
  4445         16  PB-ACCT-EFF-DT               PIC XX.
  4446         16  PB-ACCT-EXP-DT               PIC XX.
  4447         16  PB-COMPANY-ID                PIC X(3).
  4448         16  PB-LF-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  4449         16  PB-AH-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  4450         16  PB-SV-CARRIER                PIC X.
  4451         16  PB-SV-GROUPING               PIC X(6).
  4452         16  PB-SV-STATE                  PIC XX.
  4453         16  PB-CONFIRMATION-REPT-DT      PIC XX.
  4454         16  PB-GA-BILLING-INFO.
  4455             20  PB-GA-BILL-DT OCCURS 5 TIMES
  4456                                          PIC XX.
  4457         16  PB-SV-REMIT-TO  REDEFINES
  4458             PB-GA-BILLING-INFO           PIC X(10).
  4459         16  PB-NO-OF-ERRORS              PIC S9(3) COMP-3.
  4460         16  PB-I-LOAN-OFFICER            PIC X(5).
  4461         16  PB-I-VIN                     PIC X(17).
  4462
  4463         16  FILLER                       PIC X(04).
  4464         16  IMNET-BYPASS-SW              PIC X.
  4465
  4466******************************************************************
  4467*                COMMON EDIT ERRORS                              *
  4468******************************************************************
  4469
  4470     12  PB-COMMON-ERRORS.
  4471         16  PB-COMMON-ERROR    OCCURS 10 TIMES
  4472                                           PIC S9(4)     COMP.
  4473
  4474******************************************************************
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  90
* ECS010Z.cbl
  4476 01  PC-STARTS-HERE              PIC X(48)
  4477       VALUE '*****   PENDING CLAIMS RECORD STARTS HERE   ****'.
  4478
* 4479                             COPY ERCPNDC.
  4480******************************************************************04/29/98
  4481*                                                                *ERCPNDC
  4482*                                                                *ERCPNDC
  4483*                            ERCPNDC                             *   LV003
  4484*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
  4485*                            VMOD=2.004                          *   CL**2
  4486*                                                                *ERCPNDC
  4487*   FILE DESCRIPTION = PENDING CLAIM TRANSACTIONS                *ERCPNDC
  4488*                      PAYMENTS, RESERVES, EXPENSES              *ERCPNDC
  4489*                                                                *ERCPNDC
  4490*   FILE TYPE = VSAM,KSDS                                        *ERCPNDC
  4491*   RECORD SIZE = 500  RECFORM = FIXED                           *ERCPNDC
  4492*                                                                *ERCPNDC
  4493*   BASE CLUSTER = ERPNDC                         RKP=2,LEN=50   *ERCPNDC
  4494*       ALTERNATE PATHS = NONE                                   *ERCPNDC
  4495*                                                                *ERCPNDC
  4496*   LOG = YES                                                    *ERCPNDC
  4497*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *ERCPNDC
  4498******************************************************************ERCPNDC
  4499                                                                  ERCPNDC
  4500 01  PENDING-CLAIMS.                                              ERCPNDC
  4501     12  PC-RECORD-ID                     PIC XX.                 ERCPNDC
  4502         88  VALID-PC-ID                      VALUE 'PC'.         ERCPNDC
  4503                                                                  ERCPNDC
  4504     12  PC-CONTROL-PRIMARY.                                      ERCPNDC
  4505         16  PC-COMPANY-CD                PIC X.                  ERCPNDC
  4506         16  PC-CARRIER                   PIC X.                  ERCPNDC
  4507         16  PC-GROUPING.                                         ERCPNDC
  4508             20  PC-GROUPING-PREFIX       PIC XXX.                ERCPNDC
  4509             20  PC-GROUPING-PRIME        PIC XXX.                ERCPNDC
  4510         16  PC-STATE                     PIC XX.                 ERCPNDC
  4511         16  PC-ACCOUNT.                                          ERCPNDC
  4512             20  PC-ACCOUNT-PREFIX        PIC X(4).               ERCPNDC
  4513             20  PC-ACCOUNT-PRIME         PIC X(6).               ERCPNDC
  4514         16  PC-CERT-EFF-DT               PIC XX.                 ERCPNDC
  4515         16  PC-CERT-NO.                                          ERCPNDC
  4516             20  PC-CERT-PRIME            PIC X(10).              ERCPNDC
  4517             20  PC-CERT-SFX              PIC X.                  ERCPNDC
  4518         16  PC-CLAIM-NO                  PIC X(7).               ERCPNDC
  4519         16  PC-CHECK-NO                  PIC X(7).               ERCPNDC
  4520                                                                  ERCPNDC
  4521         16  PC-RECORD-TYPE               PIC X.                  ERCPNDC
  4522             88  PC-CLAIMS                    VALUE '1'.          ERCPNDC
  4523             88  PC-RESERVES                  VALUE '2'.          ERCPNDC
  4524         16  PC-RECORD-SEQUENCE           PIC S9(4)     COMP.     ERCPNDC
  4525                                                                  ERCPNDC
  4526     12  PC-LAST-MAINT-DT                 PIC XX.                 ERCPNDC
  4527     12  PC-LAST-MAINT-BY                 PIC X(4).               ERCPNDC
  4528     12  PC-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.   ERCPNDC
  4529                                                                  ERCPNDC
  4530     12  PC-CLAIM-RECORD.                                         ERCPNDC
  4531         16  PC-CLAIM-TYPE                PIC X.                  ERCPNDC
  4532             88  PC-LF-CLAIM                  VALUE '1'.          ERCPNDC
  4533             88  PC-AH-CLAIM                  VALUE '2'.          ERCPNDC
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  91
* ECS010Z.cbl (/apps/prod/cid1p/copy/ERCPNDC)
  4534             88  PC-OB-LF-CLAIM               VALUE '3'.          ERCPNDC
  4535             88  PC-OB-AH-CLAIM               VALUE '4'.          ERCPNDC
  4536         16  PC-PAYMENT-DT                PIC XX.                 ERCPNDC
  4537         16  PC-PAID-THRU-DT              PIC XX.                 ERCPNDC
  4538         16  PC-REPORTED-DT               PIC XX.                 ERCPNDC
  4539         16  PC-INCURRED-DT               PIC XX.                 ERCPNDC
  4540         16  PC-NO-OF-DAYS-PAID           PIC S9(3)     COMP-3.   ERCPNDC
  4541         16  PC-CLAIM-PAYMENT             PIC S9(7)V99  COMP-3.   ERCPNDC
  4542         16  PC-AGE-AT-CLAIM              PIC 99.                 ERCPNDC
  4543         16  FILLER                       PIC XX.                 ERCPNDC
  4544         16  PC-PAYMENT-TYPE              PIC X.                  ERCPNDC
  4545             88  PC-PARTIAL-PAYMENT           VALUE '1'.          ERCPNDC
  4546             88  PC-FINAL-PAYMENT             VALUE '2'.          ERCPNDC
  4547             88  PC-LUMP-SUM-PAYMENT          VALUE '3'.          ERCPNDC
  4548             88  PC-ADDITIONAL-PAYMENT        VALUE '4'.          ERCPNDC
  4549             88  PC-CHARGEBLE-EXPENSE         VALUE '5'.          ERCPNDC
  4550             88  PC-NON-CHARGEBLE-EXPENSE     VALUE '6'.          ERCPNDC
  4551             88  PC-VOIDED-PAYMENT            VALUE '9'.          ERCPNDC
  4552                                                                  ERCPNDC
  4553         16  PC-FUTURE-RESERVE-AMT        PIC S9(7)V99  COMP-3.   ERCPNDC
  4554         16  PC-IBNR-RESERVE-AMT          PIC S9(7)V99  COMP-3.   ERCPNDC
  4555         16  PC-PTC-RESERVE-AMT           PIC S9(7)V99  COMP-3.   ERCPNDC
  4556         16  PC-MANUAL-RESERVE-AMT        PIC S9(7)V99  COMP-3.   ERCPNDC
  4557                                                                  ERCPNDC
  4558         16  PC-SV-CARRIER                PIC X.                  ERCPNDC
  4559         16  PC-SV-GROUPING               PIC X(6).               ERCPNDC
  4560         16  PC-SV-STATE                  PIC XX.                 ERCPNDC
  4561                                                                  ERCPNDC
  4562         16  PC-VOID-SW                   PIC X.                  ERCPNDC
  4563             88  PC-PUT-CERT-INFORCE          VALUE '1'.          ERCPNDC
  4564                                                                  ERCPNDC
  4565         16  PC-CAUSE-CODE                PIC X(6).               ERCPNDC
  4566         16  FILLER                       PIC X(48).              ERCPNDC
  4567                                                                  ERCPNDC
  4568         16  PC-CLAIMED-CERT-DATA.                                ERCPNDC
  4569             20  PC-CC-INSURED-NAME.                              ERCPNDC
  4570                 24  PC-CC-LAST-NAME      PIC X(15).              ERCPNDC
  4571                 24  PC-CC-INITIALS       PIC XX.                 ERCPNDC
  4572             20  PC-CC-INSURED-AGE        PIC S99.                ERCPNDC
  4573             20  PC-CC-INSURED-SEX        PIC X.                  ERCPNDC
  4574             20  PC-CC-ORIG-TERM          PIC S999        COMP-3. ERCPNDC
  4575             20  PC-CC-LF-BENEFIT-CD      PIC XX.                 ERCPNDC
  4576             20  PC-CC-LIFE-BENEFIT-AMT   PIC S9(9)V99    COMP-3. ERCPNDC
  4577             20  PC-CC-ALT-LF-BENEFIT-AMT PIC S9(9)V99    COMP-3. ERCPNDC
  4578             20  PC-CC-LIFE-PREMIUM       PIC S9(7)V99    COMP-3. ERCPNDC
  4579             20  PC-CC-AH-BENEFIT-CD      PIC XX.                 ERCPNDC
  4580             20  PC-CC-AH-BENEFIT-AMT     PIC S9(7)V99    COMP-3. ERCPNDC
  4581             20  PC-CC-AH-PREMIUM-AMT     PIC S9(7)V99    COMP-3. ERCPNDC
  4582             20  PC-CC-RATE-CLASS         PIC XX.                 ERCPNDC
  4583             20  PC-CC-RATE-DEV           PIC XXX.                ERCPNDC
  4584             20  PC-CC-OB-FLAG            PIC X.                  ERCPNDC
  4585                 88  PC-CC-OB                VALUE 'B'.           ERCPNDC
  4586             20  PC-CC-AH-POLICY-STATUS   PIC X.                  ERCPNDC
  4587                 88  PC-CCA-POLICY-IS-ACTIVE        VALUE '1' '3' ERCPNDC
  4588                                               '4' '5' '9' '2'.   ERCPNDC
  4589                 88  PC-CCA-NORMAL-ENTRY            VALUE '1'.    ERCPNDC
  4590                 88  PC-CCA-POLICY-PENDING          VALUE '2'.    ERCPNDC
  4591                 88  PC-CCA-POLICY-IS-RESTORE       VALUE '3'.    ERCPNDC
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  92
* ECS010Z.cbl (/apps/prod/cid1p/copy/ERCPNDC)
  4592                 88  PC-CCA-CONVERSION-ENTRY        VALUE '4'.    ERCPNDC
  4593                 88  PC-CCA-POLICY-IS-REISSUE       VALUE '5'.    ERCPNDC
  4594                 88  PC-CCA-LUMP-SUM-DISAB          VALUE '6'.    ERCPNDC
  4595                 88  PC-CCA-DEATH-CLAIM-APPLIED     VALUE '7'.    ERCPNDC
  4596                 88  PC-CCA-CANCEL-APPLIED          VALUE '8'.    ERCPNDC
  4597                 88  PC-CCA-REIN-ONLY               VALUE '9'.    ERCPNDC
  4598             20  PC-CC-LF-POLICY-STATUS   PIC X.                  ERCPNDC
  4599                 88  PC-CCL-POLICY-IS-ACTIVE        VALUE '1' '3' ERCPNDC
  4600                                               '4' '5' '9' '2'.   ERCPNDC
  4601                 88  PC-CCL-NORMAL-ENTRY            VALUE '1'.    ERCPNDC
  4602                 88  PC-CCL-POLICY-PENDING          VALUE '2'.    ERCPNDC
  4603                 88  PC-CCL-POLICY-IS-RESTORE       VALUE '3'.    ERCPNDC
  4604                 88  PC-CCL-CONVERSION-ENTRY        VALUE '4'.    ERCPNDC
  4605                 88  PC-CCL-POLICY-IS-REISSUE       VALUE '5'.    ERCPNDC
  4606                 88  PC-CCL-LUMP-SUM-DISAB          VALUE '6'.    ERCPNDC
  4607                 88  PC-CCL-DEATH-CLAIM-APPLIED     VALUE '7'.    ERCPNDC
  4608                 88  PC-CCL-CANCEL-APPLIED          VALUE '8'.    ERCPNDC
  4609                 88  PC-CCL-REIN-ONLY               VALUE '9'.    ERCPNDC
  4610             20  PC-CC-PAY-FREQUENCY      PIC 99.                 ERCPNDC
  4611             20  PC-CC-LOAN-APR           PIC 9(3)V9(4)   COMP-3. ERCPNDC
  4612             20  PC-CC-SOC-SEC-NO         PIC X(11).              ERCPNDC
  4613             20  PC-CC-MEMBER-NO          PIC X(12).              ERCPNDC
  4614             20  PC-CC-INT-CODE           PIC X.                  ERCPNDC
  4615                 88  PC-CC-ADD-ON                  VALUE 'A'.     ERCPNDC
  4616                 88  PC-CC-SIMPLE                  VALUE 'S'.     ERCPNDC
  4617             20  PC-CC-CAPPED-TERM        PIC 999.                ERCPNDC
  4618             20  PC-CC-PRIOR-LUMP-PMT     PIC S9(7)V99  COMP-3.   ERCPNDC
  4619             20  PC-CC-PRIOR-DEATH-AMT    PIC S9(9)V99  COMP-3.   ERCPNDC
  4620             20  PC-CC-CANCEL-DT          PIC XX.                 ERCPNDC
  4621             20  PC-CC-DEATH-DT           PIC XX.                 ERCPNDC
  4622             20  PC-CC-SETTLEMENT-DT      PIC XX.                 ERCPNDC
  4623             20  PC-CC-PRIOR-STATUS       PIC X.                  ERCPNDC
  4624             20  PC-CC-CERT-ENTRY-STATUS  PIC X.                  ERCPNDC
  4625         16  PC-TRLR-SEQ-NO               PIC S9(4)     COMP.     ERCPNDC
  4626         16  PC-CC-CLP-STATE              PIC XX.
  4627         16  FILLER                       PIC X(14).              ERCPNDC
  4628         16  PC-REMAINING-BENEFIT         PIC S9(9)V99  COMP-3.   ERCPNDC
  4629         16  PC-REMAINING-TERM            PIC S9(3)     COMP-3.   ERCPNDC
  4630         16  FILLER                       PIC X(34).              ERCPNDC
  4631                                                                  ERCPNDC
  4632     12  PC-RECORD-STATUS.                                        ERCPNDC
  4633         16  PC-CREDIT-SELECT-DT          PIC XX.                 ERCPNDC
  4634         16  PC-CREDIT-ACCEPT-DT          PIC XX.                 ERCPNDC
  4635         16  FILLER                       PIC XX.                 ERCPNDC
  4636         16  PC-FATAL-FLAG                PIC X.                  ERCPNDC
  4637             88  PC-FATAL-ERRORS             VALUE 'X'.           ERCPNDC
  4638         16  PC-FORCE-CODE                PIC X.                  ERCPNDC
  4639             88  PC-FORCE-OFF                VALUE ' ' '0'.       ERCPNDC
  4640             88  PC-CLAIM-FORCE              VALUE '6' '7'        ERCPNDC
  4641                                                     '8'.         ERCPNDC
  4642         16  PC-FORCE-ER-CD               PIC X.                  ERCPNDC
  4643             88  PC-FORCE-ERRORS             VALUE 'F'.           ERCPNDC
  4644             88  PC-UNFORCED-ERRORS          VALUE 'X'.           ERCPNDC
  4645         16  PC-WARN-ER-CD                PIC X.                  ERCPNDC
  4646             88  PC-WARNING-ERRORS           VALUE 'W'.           ERCPNDC
  4647         16  PC-LF-OVERRIDE-L1            PIC X.                  ERCPNDC
  4648         16  PC-AH-OVERRIDE-L1            PIC X.                  ERCPNDC
  4649         16  FILLER                       PIC X(17).              ERCPNDC
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  93
* ECS010Z.cbl (/apps/prod/cid1p/copy/ERCPNDC)
  4650         16  PC-CERT-UPDATE-SW            PIC X.                  ERCPNDC
  4651             88  PC-CERT-DATA-CAPTURED       VALUE '1'.           ERCPNDC
  4652         16  PC-COMPANY-ID                PIC XXX.                ERCPNDC
  4653         16  PC-INPUT-DT                  PIC XX.                 ERCPNDC
  4654                                                                  ERCPNDC
  4655     12  PC-ERROR-FLAGS.                                          ERCPNDC
  4656         16  PC-STANDARD-ERRORS.                                  ERCPNDC
  4657             20  PC-STD-ERROR-FLAGS   OCCURS 25 TIMES PIC X.      ERCPNDC
  4658         16  PC-TRANSACTION-ERRORS.                               ERCPNDC
  4659             20  PC-TRN-ERROR-FLAGS   OCCURS 75 TIMES PIC X.      ERCPNDC
  4660                                                                  ERCPNDC
  4661     12  PC-ERR-FLAGS-R REDEFINES  PC-ERROR-FLAGS.                ERCPNDC
  4662         16  PC-ERR-FLAG              OCCURS 100 TIMES PIC X.     ERCPNDC
  4663                                                                  ERCPNDC
  4664     12  FILLER                           PIC X(25).              ERCPNDC
  4665                                                                  ERCPNDC
  4666******************************************************************ERCPNDC
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  94
* ECS010Z.cbl
  4668 01  CC-STARTS-HERE              PIC X(48)
  4669       VALUE '***** CERTIFICATE CHANGE RECORD STARTS HERE ****'.
  4670
* 4671                             COPY ERCCRTC.
  4672******************************************************************04/29/98
  4673*                                                                *ERCCRTC
  4674*                                                                *ERCCRTC
  4675*                            ERCCRTC                             *   LV003
  4676*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  4677*                            VMOD=2.005                          *   CL**3
  4678*                                                                *ERCCRTC
  4679*   FILE DESCRIPTION = PENDING CHANGES TO CERTIFICATE RECORD     *ERCCRTC
  4680*                      (MAINTENANCE ONLY - SEE ERCPNDB FOR NEW   *ERCCRTC
  4681*                       ISSUES AND CANCELS)                      *ERCCRTC
  4682*   FILE TYPE = VSAM,KSDS                                        *ERCCRTC
  4683*   RECORD SIZE = 300  RECFORM = FIXED                           *ERCCRTC
  4684*                                                                *ERCCRTC
  4685*   BASE CLUSTER = ERCRTC                         RKP=2,LEN=37   *ERCCRTC
  4686*       ALTERNATE PATHS = NONE                                   *ERCCRTC
  4687*                                                                *ERCCRTC
  4688*   LOG = YES                                                    *ERCCRTC
  4689*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *ERCCRTC
  4690******************************************************************ERCCRTC
  4691*                   C H A N G E   L O G
  4692*
  4693* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4694*-----------------------------------------------------------------
  4695*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4696* EFFECTIVE    NUMBER
  4697*-----------------------------------------------------------------
  4698* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  4699******************************************************************
  4700 01  PENDING-MAINT-TO-CERT-FILE.                                  ERCCRTC
  4701     12  CC-RECORD-ID                     PIC XX.                 ERCCRTC
  4702         88  VALID-CC-ID                        VALUE 'CC'.       ERCCRTC
  4703                                                                  ERCCRTC
  4704     12  CC-CONTROL-PRIMARY.                                      ERCCRTC
  4705         16  CC-COMPANY-CD                PIC X.                  ERCCRTC
  4706         16  CC-CARRIER                   PIC X.                  ERCCRTC
  4707         16  CC-GROUPING                  PIC X(6).               ERCCRTC
  4708         16  CC-STATE                     PIC XX.                 ERCCRTC
  4709         16  CC-ACCOUNT                   PIC X(10).              ERCCRTC
  4710         16  CC-CERT-EFF-DT               PIC XX.                 ERCCRTC
  4711         16  CC-CERT-NO.                                          ERCCRTC
  4712             20  CC-CERT-PRIME            PIC X(10).              ERCCRTC
  4713             20  CC-CERT-SFX              PIC X.                  ERCCRTC
  4714                                                                  ERCCRTC
  4715         16  CC-FILE-SEQ-NO               PIC S9(8)     COMP.     ERCCRTC
  4716                                                                  ERCCRTC
  4717     12  CC-LAST-MAINT-DT                 PIC XX.                 ERCCRTC
  4718     12  CC-LAST-MAINT-BY                 PIC X(4).               ERCCRTC
  4719     12  CC-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.   ERCCRTC
  4720                                                                  ERCCRTC
  4721     12  CC-RECORD-BODY                   PIC X(191).             ERCCRTC
  4722                                                                  ERCCRTC
  4723     12  CC-CHANGES-RECORD   REDEFINES CC-RECORD-BODY.            ERCCRTC
  4724         16  FILLER                       PIC X(10).              ERCCRTC
  4725         16  CC-NAME.                                             ERCCRTC
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  95
* ECS010Z.cbl (/apps/prod/cid1p/copy/ERCCRTC)
  4726             20  CC-INSURED-LAST-NAME     PIC X(15).              ERCCRTC
  4727             20  CC-INSURED-FIRST-NAME.                           ERCCRTC
  4728                 24  CC-INSURED-1ST-INIT  PIC X.                  ERCCRTC
  4729                 24  FILLER               PIC X(9).               ERCCRTC
  4730             20  CC-INSURED-INITIAL2      PIC XX.                 ERCCRTC
  4731         16  CC-AGE                       PIC S99.                ERCCRTC
  4732         16  CC-INSURED-JOINT-AGE         PIC S99.                ERCCRTC
  4733         16  CC-BIRTHDAY                  PIC XX.                 ERCCRTC
  4734         16  CC-INSURED-SEX               PIC X.                  ERCCRTC
  4735             88  CC-SEX-MALE                 VALUE 'M'.           ERCCRTC
  4736             88  CC-SEX-FEMALE               VALUE 'F'.           ERCCRTC
  4737         16  CC-JOINT-INSURED-NAME.                               ERCCRTC
  4738             20  CC-JT-LAST-NAME          PIC X(15).              ERCCRTC
  4739             20  CC-JT-FIRST-NAME.                                ERCCRTC
  4740                 24  CC-JT-1ST-INIT       PIC X.                  ERCCRTC
  4741                 24  FILLER               PIC X(9).               ERCCRTC
  4742             20  CC-JT-INITIAL            PIC X.                  ERCCRTC
  4743         16  CC-LOAN-APR                  PIC 9(3)V9(4).          ERCCRTC
  4744         16  CC-PAY-FREQUENCY             PIC S99.                ERCCRTC
  4745         16  CC-BENEFICIARY               PIC X(25).              ERCCRTC
  4746         16  CC-POLICY-FORM-NO            PIC X(12).              ERCCRTC
  4747         16  CC-PREMIUM-TYPE              PIC X.                  ERCCRTC
  4748         16  CC-IND-GRP-TYPE              PIC X.                  ERCCRTC
  4749         16  CC-LOAN-NUMBER               PIC X(8).               ERCCRTC
  4750         16  CC-LOAN-BALANCE              PIC S9(7)V99  COMP-3.   ERCCRTC
  4751         16  CC-OLD-LOF                   PIC XXX.
  4752*        16  CC-LOAN-OFFICER              PIC XXX.                ERCCRTC
  4753         16  CC-USER-FIELD                PIC X.                  ERCCRTC
  4754         16  CC-SOC-SEC-NO                PIC X(11).              ERCCRTC
  4755         16  CC-MEMBER-NO                 PIC X(12).              ERCCRTC
  4756         16  CC-LF-ORIG-TERM              PIC S9(3).              ERCCRTC
  4757         16  CC-AH-ORIG-TERM              PIC S9(3).              ERCCRTC
  4758         16  FILLER                       PIC X(3).               ERCCRTC
  4759         16  CC-CLAIM-DEDUCT-WITHHELD     PIC S9(5)V99  COMP-3.   ERCCRTC
  4760         16  CC-CANCEL-DEDUCT-WITHHELD    PIC S9(5)V99  COMP-3.   ERCCRTC
  4761         16  CC-LIVES                     PIC S9(7)     COMP-3.   ERCCRTC
  4762         16  CC-BILLED                    PIC S9(7)     COMP-3.   ERCCRTC
  4763         16  CC-LOAN-OFFICER              PIC X(5).
  4764         16  FILLER                       PIC XXX.                ERCCRTC
  4765     12  CC-RECORD-STATUS.                                        ERCCRTC
  4766         16  CC-CREDIT-SELECT-DT          PIC XX.                 ERCCRTC
  4767         16  CC-CREDIT-ACCEPT-DT          PIC XX.                 ERCCRTC
  4768     12  CC-ADDITIONAL-LF-DATA.                                   ERCCRTC
  4769         16  CC-LF-BENEFIT-CD             PIC XX.                 ERCCRTC
  4770         16  CC-LF-PREMIUM-AMT            PIC S9(7)V99  COMP-3.   ERCCRTC
  4771         16  CC-LF-BENEFIT-AMT            PIC S9(9)V99  COMP-3.   ERCCRTC
  4772         16  CC-LF-EXPIRY-DT              PIC XX.                 ERCCRTC
  4773     12  CC-INPUT-DT                      PIC XX.                 ERCCRTC
  4774     12  CC-ERROR-FLAGS.                                          ERCCRTC
  4775         16  CC-STANDARD-ERRORS.                                  ERCCRTC
  4776             20  FILLER                   PIC X    OCCURS 10.     ERCCRTC
  4777         16  CC-TRANSACTION-ERRORS.                               ERCCRTC
  4778             20  FILLER                   PIC X    OCCURS 10.     ERCCRTC
  4779     12  CC-ADDITIONAL-AH-DATA.                                   ERCCRTC
  4780         16  CC-AH-BENEFIT-CD             PIC XX.                 ERCCRTC
  4781         16  CC-AH-PREMIUM-AMT            PIC S9(7)V99  COMP-3.   ERCCRTC
  4782         16  CC-AH-BENEFIT-AMT            PIC S9(7)V99  COMP-3.   ERCCRTC
  4783         16  CC-AH-EXPIRY-DT              PIC XX.                 ERCCRTC
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  96
* ECS010Z.cbl (/apps/prod/cid1p/copy/ERCCRTC)
  4784                                                                  ERCCRTC
  4785     12  FILLER                           PIC X(05).              ERCCRTC
  4786******************************************************************ERCCRTC
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  97
* ECS010Z.cbl
  4788 01  CR-STARTS-HERE              PIC X(48)
  4789       VALUE '***** CERTIFICATE MASTER RECORD STARTS HERE ****'.
  4790
* 4791                             COPY ECSCRT01.
  4792******************************************************************
  4793*                                                                *
  4794*                            ECSCRT01                            *
  4795*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4796*                            VMOD=2.016                          *
  4797*                                                                *
  4798*   FILE DESCRIPTION = CERTIFICATE RECORD    (OFF-LINE)          *
  4799*                                                                *
  4800*   FILE TYPE = SEQUENTIAL
  4801*   RECORD SIZE = 1056 RECFORM = FIXED                           *
  4802*                                                                *
  4803*   KEY DATA =                         START=4, LEN=36           *
  4804*                                                                *
  4805*  NO  CID  MODS  IN  COPYBOOK  ECSCRT01                         *
  4806*                                                                *
  4807******************************************************************
  4808******************************************************************
  4809*                   C H A N G E   L O G
  4810*
  4811* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4812*-----------------------------------------------------------------
  4813*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4814* EFFECTIVE    NUMBER
  4815*-----------------------------------------------------------------
  4816* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  4817* 100703    2003080800002  PEMA  ADD SUPER GAP PROCESSING
  4818* 040504    2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  4819* 020305    2005020000000  PEMA  ADD CLP STATE TO CERT RECORD
  4820* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  4821* 042408    2007110500003  PEMA  ADD REFUND INTEREST PROCESSING
  4822* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  4823* 032612  CR2011110200001  PEMA  AHL CHANGES
  4824* 052814  CR2014012300001  PEMA  DCC CREDIT UNION CHANGES
  4825* 090314  CR2014081300001  PEMA  LOAD CERTS INVOLVED IN THAO
  4826******************************************************************
  4827
  4828 01  CERTIFICATE-RECORD.
  4829     12  CR-RECORD-ID                      PIC XX.
  4830         88  VALID-CR-ID                      VALUE 'CR'.
  4831
  4832     12  CR-COMPANY-CD                     PIC X.
  4833
  4834     12  CR-FULL-CONTROL.
  4835         16  CR-CONTROL-1.
  4836             20  CR-ACCT-CONTROL.
  4837                 24  CR-CARRIER            PIC X.
  4838                 24  CR-GROUPING.
  4839                     28  CR-GROUP-PREFIX   PIC XXX.
  4840                     28  CR-GROUP-PRIME    PIC XXX.
  4841                 24  CR-STATE              PIC XX.
  4842                 24  CR-ACCOUNT.
  4843                     28  CR-ACCT-PREFIX    PIC X(4).
  4844                     28  CR-ACCT-PRIME     PIC X(6).
  4845             20  CR-DT                     PIC 9(11)  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  98
* ECS010Z.cbl (/apps/prod/cid1p/copy/ECSCRT01)
  4846         16  CR-CERT-NO.
  4847             20  CR-CERT.
  4848                 24  CR-CERT-PREFIX        PIC X(3).
  4849                 24  CR-CERT-PRIME         PIC X(7).
  4850             20  CR-CERT-SFX               PIC X.
  4851
  4852     12  CR-INSUREDS-PROFILE.
  4853         16  CR-NAME.
  4854             20  CR-LNAME                  PIC X(15).
  4855             20  CR-FNAME.
  4856                 24  CR-1ST-INITIAL        PIC X.
  4857                 24  FILLER                PIC X(9).
  4858             20  CR-INIT                   PIC X.
  4859         16  CR-AGE                        PIC 99.
  4860         16  CR-SEX                        PIC X.
  4861             88  CR-SEX-MALE                  VALUE 'M'.
  4862             88  CR-SEX-FEMALE                VALUE 'F'.
  4863         16  CR-SOC-SEC                    PIC X(11).
  4864         16  CR-JOINT-NAME.
  4865             20  CR-JT-LNAME               PIC X(15).
  4866             20  CR-JT-FNAME.
  4867                 24  CR-JT-1ST-INIT        PIC X.
  4868                 24  FILLER                PIC X(9).
  4869             20  CR-JT-INIT                PIC X.
  4870         16  CR-JOINT-AGE                  PIC 99.
  4871
  4872         16  cr-ahl-ah-claim-no            pic x(9).
  4873         16  cr-ahl-ah-cert-seq            pic x(3).
  4874         16  cr-hst-proc-lf                pic x.
  4875         16  f                             pic x(7).
  4876
  4877     12  CR-LF-COVERAGE-DATA.
  4878         16  CR-LFTYP                      PIC XX.
  4879         16  CR-LF-TERM                    PIC S999       COMP-3.
  4880         16  CR-LF-CRIT-PERIOD             PIC S999       COMP-3.
  4881         16  CR-LF-TERM-IN-DAYS            PIC S9(5)      COMP-3.
  4882         16  CR-LF-DEV-CODE                PIC XXX.
  4883         16  CR-LF-DEV-PCT                 PIC S9V9(6)    COMP-3.
  4884
  4885         16  CR-LFAMT                      PIC S9(9)V99   COMP-3.
  4886         16  CR-LFPRM                      PIC S9(7)V99   COMP-3.
  4887         16  CR-LFPRM-CALC                 PIC S9(7)V99   COMP-3.
  4888         16  CR-LFPRM-RATE                 PIC S99V9(5)   COMP-3.
  4889
  4890         16  CR-LFAMT-ALT                  PIC S9(9)V99   COMP-3.
  4891         16  CR-LFPRM-ALT                  PIC S9(7)V99   COMP-3.
  4892         16  CR-LFPRM-CALC-ALT             PIC S9(7)V99   COMP-3.
  4893         16  CR-LFPRM-RATE-ALT             PIC S99V9(5)   COMP-3.
  4894
  4895         16  CR-LFRFND                     PIC S9(7)V99   COMP-3.
  4896         16  CR-LFRFND-CALC                PIC S9(7)V99   COMP-3.
  4897
  4898         16  CR-LF-NSP-PRM                 PIC S9(7)V99   COMP-3.
  4899         16  CR-LF-NSP-PRM-RATE            PIC S99V9(5)   COMP-3.
  4900
  4901         16  CR-LF-REFUND-TYPE             PIC X.
  4902         16  CR-LF-POLICY-FEE              PIC S9(3)V99   COMP-3.
  4903
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  99
* ECS010Z.cbl (/apps/prod/cid1p/copy/ECSCRT01)
  4904         16  CR-LF-COMM-CHARGEBACK         PIC X.
  4905             88  CR-NO-LF-CHARGEBACK          VALUE 'N'.
  4906
  4907         16  CR-LF-REI-RISK-PRM            PIC S9(7)V99   COMP-3.
  4908
  4909         16  CR-LF-EXPIRE-DATE             PIC 9(11)      COMP-3.
  4910         16  CR-LF-ISS-PREM-TAX            PIC S9V9(4)    COMP-3.
  4911         16  CR-LF-CNC-PREM-TAX            PIC S9V9(4)    COMP-3.
  4912
  4913         16  cr-ahl-lf-claim-no            pic x(9).
  4914         16  cr-ahl-lf-cert-seq            pic x(3).
  4915         16  FILLER                        PIC XX.
  4916
  4917     12  CR-AH-COVERAGE-DATA.
  4918         16  CR-AHTYP                      PIC XX.
  4919         16  CR-AH-TERM                    PIC S999       COMP-3.
  4920         16  CR-AH-CRIT-PERIOD             PIC S999       COMP-3.
  4921         16  CR-AH-DEV-CODE                PIC XXX.
  4922         16  CR-AH-DEV-PCT                 PIC S9V9(6)    COMP-3.
  4923
  4924         16  CR-AHAMT                      PIC S9(7)V99   COMP-3.
  4925         16  CR-AHPRM                      PIC S9(7)V99   COMP-3.
  4926         16  CR-AHPRM-CALC                 PIC S9(7)V99   COMP-3.
  4927         16  CR-AHPRM-RATE                 PIC S99V9(5)   COMP-3.
  4928
  4929         16  CR-AHRFND                     PIC S9(7)V99   COMP-3.
  4930         16  CR-AHRFND-CALC                PIC S9(7)V99   COMP-3.
  4931
  4932         16  CR-AH-NSP-PRM                 PIC S9(7)V99   COMP-3.
  4933         16  CR-AH-NSP-PRM-RATE            PIC S99V9(5)   COMP-3.
  4934
  4935         16  CR-AH-REFUND-TYPE             PIC X.
  4936         16  CR-AH-POLICY-FEE              PIC S9(3)V99   COMP-3.
  4937
  4938         16  CR-AH-COMM-CHARGEBACK         PIC X.
  4939             88  CR-NO-AH-CHARGEBACK          VALUE 'N'.
  4940
  4941         16  CR-AH-REI-RISK-PRM            PIC S9(7)V99   COMP-3.
  4942
  4943         16  CR-AH-EXPIRE-DATE             PIC 9(11)      COMP-3.
  4944         16  CR-AH-ISS-PREM-TAX            PIC S9V9(4)    COMP-3.
  4945         16  CR-AH-CNC-PREM-TAX            PIC S9V9(4)    COMP-3.
  4946
  4947         16  FILLER                        PIC XX.
  4948*        16  FILLER                        PIC X(8).
  4949
  4950     12  CR-LOAN-DATA.
  4951         16  CR-LIVES                      PIC S9(7)      COMP-3.
  4952         16  CR-DDF-IU-RATE-UP REDEFINES CR-LIVES
  4953                                           PIC S9(5)V99   COMP-3.
  4954         16  CR-BILLED                     PIC S9(7)      COMP-3.
  4955         16  CR-APR                        PIC S999V9(4)  COMP-3.
  4956         16  CR-PMT-FREQ                   PIC 99.
  4957         16  CR-LOAN-TERM                  PIC S999       COMP-3.
  4958         16  CR-RATING-CLASS               PIC XX.
  4959         16  CR-POLICY-FORM-NO             PIC X(12).
  4960         16  CR-GRPTYP                     PIC XX.
  4961         16  CR-IND-GRP                    PIC X.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 100
* ECS010Z.cbl (/apps/prod/cid1p/copy/ECSCRT01)
  4962             88  CR-INDIVIDUAL                VALUE '1'.
  4963             88  CR-GROUP                     VALUE '2'.
  4964         16  CR-SKIP                       PIC 99.
  4965             88  NO-MONTHS-SKIPPED            VALUE 00.
  4966             88  SKIP-JULY                    VALUE 01.
  4967             88  SKIP-AUGUST                  VALUE 02.
  4968             88  SKIP-SEPTEMBER               VALUE 03.
  4969             88  SKIP-JULY-AUG                VALUE 04.
  4970             88  SKIP-AUG-SEPT                VALUE 05.
  4971             88  SKIP-JULY-AUG-SEPT           VALUE 06.
  4972             88  SKIP-JUNE-JULY-AUG           VALUE 07.
  4973             88  SKIP-JUNE                    VALUE 08.
  4974             88  SKIP-JUNE-JULY               VALUE 09.
  4975             88  SKIP-AUG-SEPT-OCT            VALUE 10.
  4976             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 11.
  4977         16  CR-RESIDENT-STATE             PIC XX.
  4978         16  CR-RATE-CODE.
  4979             20  CR-LF-CLASS-CD            PIC XX.
  4980             20  CR-AH-CLASS-CD            PIC XX.
  4981         16  CR-MORT.
  4982             20  CR-TAB                    PIC X.
  4983             20  CR-INT                    PIC 99.
  4984             20  CR-GRP                    PIC X.
  4985         16  CR-MEMBER-NO                  PIC X(12).
  4986         16  CR-OLD-LOF                    PIC XXX.
  4987*        16  CR-LOAN-OFFICER               PIC XXX.
  4988         16  CR-REIN-TABLE                 PIC XXX.
  4989         16  CR-REIN-SPEC                  PIC X.
  4990         16  CR-LOAN-1ST-PMT-DT.
  4991             20  CR-1ST-PMT-YR             PIC 99.
  4992             20  CR-1ST-PMT-MO             PIC 99.
  4993             20  CR-1ST-PMT-DA             PIC 99.
  4994         16  CR-SUM-CAN-CNT-ITD            PIC S999       COMP-3.
  4995         16  CR-SUM-CAN-CNT-YTD            PIC S999       COMP-3.
  4996         16  CR-PMT-EXTENSION-DAYS         PIC S999       COMP-3.
  4997         16  CR-LAST-ADD-ON-DT             PIC XX.
  4998
  4999         16  CR-UNDERWRITING-CODE          PIC X.
  5000             88  CR-POLICY-UNDERWRITTEN       VALUE 'Y'.
  5001
  5002         16  CR-STATE-TAX                  PIC S9(7)V99   COMP-3.
  5003         16  CR-MUNI-TAX                   PIC S9(7)V99   COMP-3.
  5004         16  CR-CANCEL-STATE-TAX           PIC S9(7)V99   COMP-3.
  5005         16  CR-CANCEL-MUNI-TAX            PIC S9(7)V99   COMP-3.
  5006
  5007     12  CR-STATUS-INFORMATION.
  5008         16  CR-ENTRY-STATUS               PIC X.
  5009             88  CR-NORMAL-ENTRY              VALUE '1'.
  5010             88  CR-POLICY-IS-RESTORE         VALUE '3'.
  5011             88  CR-CONVERSION-ENTRY          VALUE '4'.
  5012             88  CR-POLICY-IS-REISSUE         VALUE '5'.
  5013             88  CR-POLICY-IS-CASH            VALUE 'C'.
  5014             88  CR-POLICY-IS-MONTHLY         VALUE 'M'.
  5015             88  CR-POLICY-IS-REIN-ONLY       VALUE '9'.
  5016             88  CR-POLICY-IS-DECLINED        VALUE 'D'.
  5017             88  CR-POLICY-IS-VOID            VALUE 'V'.
  5018             88  CR-POLICY-IS-PREM-ONLY       VALUE 'P'.
  5019             88  CR-POLICY-IS-ACTIVE          VALUE '1' '3' '4'
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 101
* ECS010Z.cbl (/apps/prod/cid1p/copy/ECSCRT01)
  5020                                                'C' '5' '9' 'P'.
  5021         16  CR-ENTRY-DATE                 PIC 9(11)  COMP-3.
  5022
  5023         16  CR-LF-STATUS-AT-CANCEL        PIC X.
  5024         16  CR-LF-CANC-DT                 PIC 9(11)  COMP-3.
  5025         16  CR-LF-CANCEL-EXIT-DATE        PIC 9(11)  COMP-3.
  5026
  5027         16  CR-LF-STATUS-AT-DEATH         PIC X.
  5028         16  CR-LF-CLAIM-EXIT-DATE         PIC 9(11)  COMP-3.
  5029
  5030         16  CR-LF-CURRENT-STATUS          PIC X.
  5031             88  CR-LF-NORMAL-ENTRY           VALUE '1'.
  5032             88  CR-LF-POLICY-PENDING         VALUE '2'.
  5033             88  CR-LF-POLICY-IS-RESTORE      VALUE '3'.
  5034             88  CR-LF-CONVERSION-ENTRY       VALUE '4'.
  5035             88  CR-LF-POLICY-IS-REISSUE      VALUE '5'.
  5036             88  CR-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  5037             88  CR-LF-LUMP-SUM-DISAB         VALUE '6'.
  5038             88  CR-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  5039             88  CR-LF-CANCEL-APPLIED         VALUE '8'.
  5040             88  CR-LF-IS-REIN-ONLY           VALUE '9'.
  5041             88  CR-LF-IS-DECLINED            VALUE 'D'.
  5042             88  CR-LF-IS-VOID                VALUE 'V'.
  5043             88  CR-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  5044                                                    '4' '5' '9'.
  5045
  5046         16  CR-AH-STATUS-AT-CANCEL        PIC X.
  5047
  5048         16  CR-AH-CANC-DT                 PIC 9(11)  COMP-3.
  5049         16  CR-AH-CANCEL-EXIT-DATE        PIC 9(11)  COMP-3.
  5050
  5051         16  CR-AH-STATUS-AT-SETTLEMENT    PIC X.
  5052         16  CR-AH-SETTLEMENT-EXIT-DATE    PIC 9(11)  COMP-3.
  5053
  5054         16  CR-AH-CURRENT-STATUS          PIC X.
  5055             88  CR-AH-NORMAL-ENTRY           VALUE '1'.
  5056             88  CR-AH-POLICY-PENDING         VALUE '2'.
  5057             88  CR-AH-POLICY-IS-RESTORE      VALUE '3'.
  5058             88  CR-AH-CONVERSION-ENTRY       VALUE '4'.
  5059             88  CR-AH-POLICY-IS-REISSUE      VALUE '5'.
  5060             88  CR-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  5061             88  CR-AH-LUMP-SUM-DISAB         VALUE '6'.
  5062             88  CR-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  5063             88  CR-AH-CANCEL-APPLIED         VALUE '8'.
  5064             88  CR-AH-IS-REIN-ONLY           VALUE '9'.
  5065             88  CR-AH-IS-DECLINED            VALUE 'D'.
  5066             88  CR-AH-IS-VOID                VALUE 'V'.
  5067             88  CR-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  5068                                                    '4' '5' '9'.
  5069         16  CR-LOAN-OFFICER               PIC X(5).
  5070         16  CR-CANCEL-REASON              PIC X.
  5071         16  cr-xycor-lf-cov-code          pic x(4).
  5072         16  cr-xycor-ah-cov-code          pic x(4).
  5073         16  cr-temp-epiq                  pic x(4).
  5074         16  FILLER                        PIC XX.
  5075
  5076     12  CR-DEATH-CLAIM-DATA.
  5077         16  CR-NUM-DTH-CLM                PIC S999       COMP-3.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 102
* ECS010Z.cbl (/apps/prod/cid1p/copy/ECSCRT01)
  5078
  5079         16  CR-DTH-DT                     PIC 9(11)      COMP-3.
  5080         16  CR-DTH-RPT-DT.
  5081             20  CR-DTH-RPT-YR             PIC 99.
  5082             20  CR-DTH-RPT-MO             PIC 99.
  5083             20  CR-DTH-RPT-DA             PIC 99.
  5084         16  CR-DTH-PAY-DT                 PIC 9(11)      COMP-3.
  5085
  5086         16  CR-DTHAMT                     PIC S9(9)V99   COMP-3.
  5087         16  CR-DTHAMT-YTD                 PIC S9(9)V99   COMP-3.
  5088         16  CR-DTHAMT-LAST                PIC S9(9)V99   COMP-3.
  5089         16  CR-DTHEXP                     PIC S9(7)V99   COMP-3.
  5090         16  CR-DTHEXP-YTD                 PIC S9(7)V99   COMP-3.
  5091
  5092         16  CR-DTH-AGE                    PIC 99.
  5093         16  CR-DTH-PAY-CD                 PIC X.
  5094         16  CR-DEATH-CAUSE                PIC X(6).
  5095
  5096         16  FILLER                        PIC X(16).
  5097
  5098     12  CR-DISAB-CLAIM-DATA.
  5099         16  CR-NUM-DIS-CLM                PIC S999       COMP-3.
  5100
  5101         16  CR-DIS-DT                     PIC 9(11)      COMP-3.
  5102         16  CR-DIS-RPT-DT.
  5103             20  CR-DIS-RPT-YR             PIC 99.
  5104             20  CR-DIS-RPT-MO             PIC 99.
  5105             20  CR-DIS-RPT-DA             PIC 99.
  5106         16  CR-DIS-PAY-DT                 PIC 9(11)      COMP-3.
  5107         16  CR-DIS-PTO-DT                 PIC 9(11)      COMP-3.
  5108
  5109         16  CR-DISAMT                     PIC S9(9)V99   COMP-3.
  5110         16  CR-DISAMT-YTD                 PIC S9(9)V99   COMP-3.
  5111         16  CR-DISAMT-LAST                PIC S9(9)V99   COMP-3.
  5112         16  CR-DISEXP                     PIC S9(7)V99   COMP-3.
  5113         16  CR-DISEXP-YTD                 PIC S9(7)V99   COMP-3.
  5114
  5115         16  CR-DAYS-DISAB                 PIC 999        COMP-3.
  5116         16  CR-DIS-PAY-CD                 PIC X.
  5117         16  FILLER                        PIC XX.
  5118
  5119         16  CR-DISAB-INCURRED-DETAIL.
  5120             20  CR-DISAB-DETAIL-DATA  OCCURS 5 TIMES.
  5121**ELCCRTVR MUST BE CHANGED IF THE "OCCURS" IS CHANGED.
  5122                 24  CR-DIS-INCUR-DT       PIC 9(11)     COMP-3.
  5123                 24  CR-INCUR-DISAMT       PIC S9(9)V99  COMP-3.
  5124                 24  CR-INCUR-DISEXP       PIC S9(9)V99  COMP-3.
  5125
  5126         16  CR-DISAB-CAUSE                PIC X(6).
  5127         16  FILLER                        PIC X(14).
  5128
  5129     12  CR-REMIT-TO                       PIC 99.
  5130
  5131     12  CR-COMPENSATION-LEVELS.
  5132         16  CR-AGT-LEVELS      OCCURS 10 TIMES.
  5133             20  CR-COM-AGT.
  5134                 24  CR-COM-AGT-PREFIX     PIC X(4).
  5135                 24  CR-COM-AGT-PRIME      PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 103
* ECS010Z.cbl (/apps/prod/cid1p/copy/ECSCRT01)
  5136             20  CR-AGT-TYPE               PIC X.
  5137             20  CR-LCOM-L                 PIC SV9(5)     COMP-3.
  5138             20  CR-LCOM-AH                PIC SV9(5)     COMP-3.
  5139
  5140     12  CR-BANK-NOCHRGB-MONTHS            PIC 99.
  5141     12  CR-MOB-NET-TOT-FEES               PIC S9(7)V99   COMP-3.
  5142     12  CR-ADDL-CLP                       PIC S9(5)V99   COMP-3.
  5143     12  CR-CLP-STATE                      PIC XX.
  5144     12  CR-POST-CARD-IND                  PIC X.
  5145     12  CR-LF-CLP                         PIC S9(5)V99   COMP-3.
  5146     12  CR-AH-CLP                         PIC S9(5)V99   COMP-3.
  5147     12  CR-DCC-PRODUCT-CODE               PIC XXX.
  5148     12  CR-LF-RFND-CLP                    PIC S9(5)V99   COMP-3.
  5149     12  CR-AH-RFND-CLP                    PIC S9(5)V99   COMP-3.
  5150     12  FILLER                            PIC X(07).
  5151
  5152     12  CR-CSR-CODE                       PIC XXX.
  5153
  5154     12  CR-CLAIM-DEDUCT-WITHHELD          PIC S9(5)V99   COMP-3.
  5155     12  CR-CANCEL-DEDUCT-WITHHELD         PIC S9(5)V99   COMP-3.
  5156
  5157     12  CR-MICROFILM-NUMBERS.
  5158*        16  CR-ISS-MICROFILM-NO           PIC S9(9)      COMP-3.
  5159         16  FILLER                        PIC X(5).
  5160     12  CR-NH-INT-ON-REF                  PIC S9(7)V99   COMP-3.
  5161
  5162     12  CR-USER-CODE                      PIC X.
  5163     12  CR-USER-FUTURE                    PIC X(9).
  5164
  5165     12  CR-BENEFICIARY.
  5166         16  CR-BANK-NO                    PIC X(10).
  5167         16  FILLER                        PIC X(15).
  5168
  5169     12  CR-ENTRY-BATCH                    PIC X(6).
  5170     12  CR-LF-EXIT-BATCH                  PIC X(6).
  5171     12  CR-AH-EXIT-BATCH                  PIC X(6).
  5172
  5173     12  CR-NOTE-SW                        PIC X.
  5174
  5175     12  CR-ORIGIN-INDICATOR               PIC X.
  5176         88  CR-ENTERED-MANUALLY              VALUE '1'.
  5177         88  CR-CREATED-FROM-TAPE-LOAD        VALUE '2'.
  5178
  5179     12  CR-LF-CNC-ENT-DT                  PIC 9(11)  COMP-3.
  5180     12  CR-AH-CNC-ENT-DT                  PIC 9(11)  COMP-3.
  5181     12  FILLER                            PIC X(33).
  5182
  5183******************************************************************
* 5184                             COPY ELCCRTVR.
  5185***************************************************************** 04/24/98
  5186*                                                                *ELCCRTVR
  5187*                                                                *ELCCRTVR
  5188*                            ELCCRTVR                            *   LV003
  5189*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  5190*                            VMOD=2.001                          *ELCCRTVR
  5191*                                                                *ELCCRTVR
  5192*   WORKING STORAGE FOR DATE VARIABLES CREATED                   *ELCCRTVR
  5193*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCCRTVR
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 104
* ECS010Z.cbl (/apps/prod/cid1p/copy/ELCCRTVR)
  5194*                                                                *ELCCRTVR
  5195******************************************************************ELCCRTVR
  5196                                                                  ELCCRTVR
  5197 01  WS-CERTIFICATE-RECORD-DATE.                                  ELCCRTVR
  5198     05  WS-CR-DT.                                                ELCCRTVR
  5199         10  FILLER                PIC 999.                       ELCCRTVR
  5200         10  CR-CCYY               PIC 9(04).                     ELCCRTVR
  5201         10  CR-CCYR  REDEFINES  CR-CCYY.                         ELCCRTVR
  5202             15  CR-CC             PIC 99.                        ELCCRTVR
  5203             15  CR-YR             PIC 99.                        ELCCRTVR
  5204         10  CR-MO                 PIC 99.                        ELCCRTVR
  5205         10  CR-DA                 PIC 99.                        ELCCRTVR
  5206     05  WS-CR-DT-N REDEFINES                                        CL**2
  5207            WS-CR-DT               PIC 9(11).                        CL**2
  5208     05  WS-CR-LF-EXPIRE-DATE.                                    ELCCRTVR
  5209         10  FILLER                    PIC 999.                   ELCCRTVR
  5210         10  CR-LF-EXPIRE-CCYY         PIC 9(04).                 ELCCRTVR
  5211         10  CR-LF-EXPIRE-CCYR  REDEFINES  CR-LF-EXPIRE-CCYY.     ELCCRTVR
  5212             15  CR-LF-EXPIRE-CC       PIC 99.                    ELCCRTVR
  5213             15  CR-LF-EXPIRE-YR       PIC 99.                    ELCCRTVR
  5214         10  CR-LF-EXPIRE-MO           PIC 99.                    ELCCRTVR
  5215         10  CR-LF-EXPIRE-DA           PIC 99.                    ELCCRTVR
  5216     05  WS-CR-LF-EXPIRE-DATE-N REDEFINES                            CL**2
  5217            WS-CR-LF-EXPIRE-DATE       PIC 9(11).                    CL**2
  5218     05  WS-CR-AH-EXPIRE-DATE.                                    ELCCRTVR
  5219         10  FILLER                    PIC 999.                   ELCCRTVR
  5220         10  CR-AH-EXPIRE-CCYY         PIC 9(04).                 ELCCRTVR
  5221         10  CR-AH-EXPIRE-CCYR   REDEFINES CR-AH-EXPIRE-CCYY.     ELCCRTVR
  5222             15  CR-AH-EXPIRE-CC       PIC 99.                    ELCCRTVR
  5223             15  CR-AH-EXPIRE-YR       PIC 99.                    ELCCRTVR
  5224         10  CR-AH-EXPIRE-MO           PIC 99.                    ELCCRTVR
  5225         10  CR-AH-EXPIRE-DA           PIC 99.                    ELCCRTVR
  5226     05  WS-CR-AH-EXPIRE-DATE-N REDEFINES                            CL**2
  5227            WS-CR-AH-EXPIRE-DATE       PIC 9(11).                    CL**2
  5228     05  WS-CR-ENTRY-DATE.                                        ELCCRTVR
  5229         10  FILLER                    PIC 999.                   ELCCRTVR
  5230         10  CR-ENTRY-CCYY             PIC 9(04).                 ELCCRTVR
  5231         10  CR-ENTRY-CCYR  REDEFINES  CR-ENTRY-CCYY.             ELCCRTVR
  5232             15 CR-ENTRY-CC            PIC 99.                    ELCCRTVR
  5233             15 CR-ENTRY-YR            PIC 99.                    ELCCRTVR
  5234         10  CR-ENTRY-MO               PIC 99.                    ELCCRTVR
  5235         10  CR-ENTRY-DA               PIC 99.                    ELCCRTVR
  5236     05  WS-CR-ENTRY-DATE-N REDEFINES                                CL**2
  5237            WS-CR-ENTRY-DATE           PIC 9(11).                    CL**2
  5238     05  WS-CR-LF-CANC-DT.                                        ELCCRTVR
  5239         10  FILLER                    PIC 999.                   ELCCRTVR
  5240         10  CR-LF-CNC-CCYY            PIC 9(04).                 ELCCRTVR
  5241         10  CR-LF-CNC-CCYR   REDEFINES CR-LF-CNC-CCYY.           ELCCRTVR
  5242             15  CR-LF-CNC-CC          PIC 99.                    ELCCRTVR
  5243             15  CR-LF-CNC-YR          PIC 99.                    ELCCRTVR
  5244         10  CR-LF-CNC-MO              PIC 99.                    ELCCRTVR
  5245         10  CR-LF-CNC-DA              PIC 99.                    ELCCRTVR
  5246     05  WS-CR-LF-CANC-DT-N REDEFINES                                CL**2
  5247            WS-CR-LF-CANC-DT           PIC 9(11).                    CL**2
  5248     05  WS-CR-LF-CANCEL-EXIT-DATE.                               ELCCRTVR
  5249         10  FILLER                    PIC 999.                   ELCCRTVR
  5250         10  CR-LF-CEX-CCYY            PIC 9(04).                 ELCCRTVR
  5251         10  CR-LF-CEX-CCYR  REDEFINES  CR-LF-CEX-CCYY.              CL**3
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 105
* ECS010Z.cbl (/apps/prod/cid1p/copy/ELCCRTVR)
  5252             15  CR-LF-CEX-CC          PIC 99.                    ELCCRTVR
  5253             15  CR-LF-CEX-YR          PIC 99.                    ELCCRTVR
  5254         10  CR-LF-CEX-MO              PIC 99.                    ELCCRTVR
  5255         10  CR-LF-CEX-DA              PIC 99.                    ELCCRTVR
  5256     05  WS-CR-LF-CANCEL-EXIT-DATE-N REDEFINES                       CL**2
  5257            WS-CR-LF-CANCEL-EXIT-DATE  PIC 9(11).                    CL**2
  5258     05  WS-CR-LF-CLAIM-EXIT-DATE.                                ELCCRTVR
  5259         10  FILLER                    PIC 999.                   ELCCRTVR
  5260         10  CR-LF-DEX-CCYY            PIC 9(04).                 ELCCRTVR
  5261         10  CR-LF-DEX-CCYR  REDEFINES  CR-LF-DEX-CCYY.           ELCCRTVR
  5262             15  CR-LF-DEX-CC          PIC 99.                    ELCCRTVR
  5263             15  CR-LF-DEX-YR          PIC 99.                    ELCCRTVR
  5264         10  CR-LF-DEX-MO              PIC 99.                    ELCCRTVR
  5265         10  CR-LF-DEX-DA              PIC 99.                    ELCCRTVR
  5266     05  WS-CR-LF-CLAIM-EXIT-DATE-N REDEFINES                        CL**2
  5267            WS-CR-LF-CLAIM-EXIT-DATE   PIC 9(11).                    CL**2
  5268     05  WS-CR-AH-CANC-DT.                                        ELCCRTVR
  5269         10  FILLER                    PIC 999.                   ELCCRTVR
  5270         10  CR-AH-CNC-CCYY            PIC 9(04).                 ELCCRTVR
  5271         10  CR-AH-CNC-CCYR  REDEFINES  CR-AH-CNC-CCYY.           ELCCRTVR
  5272             15  CR-AH-CNC-CC          PIC 99.                    ELCCRTVR
  5273             15  CR-AH-CNC-YR          PIC 99.                    ELCCRTVR
  5274         10  CR-AH-CNC-MO              PIC 99.                    ELCCRTVR
  5275         10  CR-AH-CNC-DA              PIC 99.                    ELCCRTVR
  5276     05  WS-CR-AH-CANC-DT-N  REDEFINES                               CL**2
  5277            WS-CR-AH-CANC-DT           PIC 9(11).                    CL**2
  5278     05  WS-CR-AH-CANCEL-EXIT-DATE.                               ELCCRTVR
  5279         10  FILLER                    PIC 999.                   ELCCRTVR
  5280         10  CR-AH-CEX-CCYY            PIC 9(04).                 ELCCRTVR
  5281         10  CR-AH-CEX-CCYR  REDEFINES  CR-AH-CEX-CCYY.           ELCCRTVR
  5282             15  CR-AH-CEX-CC          PIC 99.                    ELCCRTVR
  5283             15  CR-AH-CEX-YR          PIC 99.                    ELCCRTVR
  5284         10  CR-AH-CEX-MO              PIC 99.                    ELCCRTVR
  5285         10  CR-AH-CEX-DA              PIC 99.                    ELCCRTVR
  5286     05  WS-CR-AH-CANCEL-EXIT-DATE-N REDEFINES                       CL**2
  5287            WS-CR-AH-CANCEL-EXIT-DATE  PIC 9(11).                    CL**2
  5288     05  WS-CR-AH-SETTLEMENT-EXIT-DATE.                           ELCCRTVR
  5289         10  FILLER                    PIC 999.                   ELCCRTVR
  5290         10  CR-AH-DEX-CCYY            PIC 9(04).                 ELCCRTVR
  5291         10  CR-AH-DEX-CCYR  REDEFINES  CR-AH-DEX-CCYY.           ELCCRTVR
  5292             15  CR-AH-DEX-CC          PIC 99.                    ELCCRTVR
  5293             15  CR-AH-DEX-YR          PIC 99.                    ELCCRTVR
  5294         10  CR-AH-DEX-MO              PIC 99.                    ELCCRTVR
  5295         10  CR-AH-DEX-DA              PIC 99.                    ELCCRTVR
  5296     05  WS-CR-AH-SETTLEMENT-EXIT-DATEN REDEFINES                    CL**5
  5297          WS-CR-AH-SETTLEMENT-EXIT-DATE   PIC 9(11).                 CL**5
  5298     05  WS-CR-DTH-DT.                                            ELCCRTVR
  5299         10  FILLER                    PIC 999.                   ELCCRTVR
  5300         10  CR-DTH-CCYY               PIC 9(04).                 ELCCRTVR
  5301         10  CR-DTH-CCYR  REDEFINES  CR-DTH-CCYY.                 ELCCRTVR
  5302             15  CR-DTH-CC             PIC 99.                    ELCCRTVR
  5303             15  CR-DTH-YR             PIC 99.                    ELCCRTVR
  5304         10  CR-DTH-MO                 PIC 99.                    ELCCRTVR
  5305         10  CR-DTH-DA                 PIC 99.                    ELCCRTVR
  5306     05  WS-CR-DTH-DT-N REDEFINES                                    CL**2
  5307            WS-CR-DTH-DT               PIC 9(11).                    CL**2
  5308     05  WS-CR-DTH-PAY-DT.                                        ELCCRTVR
  5309         10  FILLER                    PIC 999.                   ELCCRTVR
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 106
* ECS010Z.cbl (/apps/prod/cid1p/copy/ELCCRTVR)
  5310         10  CR-DTH-PAY-CCYY           PIC 9(04).                 ELCCRTVR
  5311         10  CR-DTH-PAY-CCYR  REDEFINES CR-DTH-PAY-CCYY.          ELCCRTVR
  5312             15  CR-DTH-PAY-CC         PIC 99.                    ELCCRTVR
  5313             15  CR-DTH-PAY-YR         PIC 99.                    ELCCRTVR
  5314         10  CR-DTH-PAY-MO             PIC 99.                    ELCCRTVR
  5315         10  CR-DTH-PAY-DA             PIC 99.                    ELCCRTVR
  5316     05  WS-CR-DTH-PAY-DT-N REDEFINES                                CL**2
  5317            WS-CR-DTH-PAY-DT           PIC 9(11).                    CL**2
  5318     05  WS-CR-DIS-DT.                                            ELCCRTVR
  5319         10  FILLER                    PIC 999.                   ELCCRTVR
  5320         10  CR-DIS-CCYY               PIC 9(04).                 ELCCRTVR
  5321         10  CR-DIS-CCYR  REDEFINES  CR-DIS-CCYY.                 ELCCRTVR
  5322             15  CR-DIS-CC             PIC 99.                    ELCCRTVR
  5323             15  CR-DIS-YR             PIC 99.                    ELCCRTVR
  5324         10  CR-DIS-MO                 PIC 99.                    ELCCRTVR
  5325         10  CR-DIS-DA                 PIC 99.                    ELCCRTVR
  5326     05  WS-CR-DIS-DT-N REDEFINES                                    CL**2
  5327            WS-CR-DIS-DT               PIC 9(11).                    CL**2
  5328     05  WS-CR-DIS-PAY-DT.                                        ELCCRTVR
  5329         10  FILLER                    PIC 999.                   ELCCRTVR
  5330         10  CR-DIS-PAY-CCYY           PIC 9(04).                 ELCCRTVR
  5331         10  CR-DIS-PAY-CCYR  REDEFINES  CR-DIS-PAY-CCYY.         ELCCRTVR
  5332             15  CR-DIS-PAY-CC         PIC 99.                    ELCCRTVR
  5333             15  CR-DIS-PAY-YR         PIC 99.                    ELCCRTVR
  5334         10  CR-DIS-PAY-MO             PIC 99.                    ELCCRTVR
  5335         10  CR-DIS-PAY-DA             PIC 99.                    ELCCRTVR
  5336     05  WS-CR-DIS-PAY-DT-N REDEFINES                                CL**2
  5337            WS-CR-DIS-PAY-DT           PIC 9(11).                    CL**2
  5338     05  WS-CR-DIS-PTO-DT.                                        ELCCRTVR
  5339         10  FILLER                    PIC 999.                   ELCCRTVR
  5340         10  CR-DIS-PTO-CCYY           PIC 9(04).                 ELCCRTVR
  5341         10  CR-DIS-PTO-CCYR  REDEFINES  CR-DIS-PTO-CCYY.         ELCCRTVR
  5342             15  CR-DIS-PTO-CC         PIC 99.                    ELCCRTVR
  5343             15  CR-DIS-PTO-YR         PIC 99.                    ELCCRTVR
  5344         10  CR-DIS-PTO-MO             PIC 99.                    ELCCRTVR
  5345         10  CR-DIS-PTO-DA             PIC 99.                    ELCCRTVR
  5346     05  WS-CR-DIS-PTO-DT-N REDEFINES                                CL**2
  5347            WS-CR-DIS-PTO-DT           PIC 9(11).                    CL**2
  5348     05  COPY-NDX                      PIC 9.                        CL**6
  5349     05  WS-DIS-INCUR-DT OCCURS 5 TIMES.                             CL**6
  5350         10  WS-CR-DIS-INCUR-DT.                                  ELCCRTVR
  5351             15  FILLER                PIC 999.                   ELCCRTVR
  5352             15  CR-DIS-INC-CCYY       PIC 9(04).                 ELCCRTVR
  5353             15  CR-DIS-INC-CCYR  REDEFINES  CR-DIS-INC-CCYY.     ELCCRTVR
  5354                 20  CR-DIS-INC-CC     PIC 99.                    ELCCRTVR
  5355                 20  CR-DIS-INC-YR     PIC 99.                    ELCCRTVR
  5356             15  CR-DIS-INC-MO         PIC 99.                    ELCCRTVR
  5357             15  CR-DIS-INC-DA         PIC 99.                    ELCCRTVR
  5358         10  WS-CR-DIS-INCUR-DT-N REDEFINES                          CL**2
  5359                WS-CR-DIS-INCUR-DT     PIC 9(11).                    CL**2
  5360
  5361 01  INITIALIZED-CERTIFICATE     PIC X(1056).
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 107
* ECS010Z.cbl
* 5363                             COPY ELCDATE.
  5364******************************************************************06/11/98
  5365*                                                                *ELCDATE
  5366*                                                                *ELCDATE
  5367*                            ELCDATE.                            *   LV023
  5368*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL*16
  5369*                            VMOD=2.003                           ELCDATE
  5370*                                                                *ELCDATE
  5371*                                                                *ELCDATE
  5372*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *ELCDATE
  5373*                 LENGTH = 200                                   *   CL*19
  5374******************************************************************ELCDATE
  5375                                                                  ELCDATE
  5376 01  DATE-CONVERSION-DATA.                                        ELCDATE
  5377     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.    CL*19
  5378     12  DC-OPTION-CODE                PIC X.                        CL*15
  5379         88  BIN-TO-GREG                VALUE ' '.                ELCDATE
  5380         88  ELAPSED-BETWEEN-BIN        VALUE '1'.                ELCDATE
  5381         88  EDIT-GREG-TO-BIN           VALUE '2'.                ELCDATE
  5382         88  YMD-GREG-TO-BIN            VALUE '3'.                ELCDATE
  5383         88  MDY-GREG-TO-BIN            VALUE '4'.                ELCDATE
  5384         88  JULIAN-TO-BIN              VALUE '5'.                ELCDATE
  5385         88  BIN-PLUS-ELAPSED           VALUE '6'.                ELCDATE
  5386         88  FIND-CENTURY               VALUE '7'.                   CL*22
  5387         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.                ELCDATE
  5388         88  EDIT-GREG-TO-BIN-3         VALUE '9'.                ELCDATE
  5389         88  YMD-GREG-TO-BIN-3          VALUE 'A'.                ELCDATE
  5390         88  MDY-GREG-TO-BIN-3          VALUE 'B'.                ELCDATE
  5391         88  JULIAN-TO-BIN-3            VALUE 'C'.                ELCDATE
  5392         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.                ELCDATE
  5393         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.                   CL*14
  5394         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.                   CL*14
  5395         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.                   CL*14
  5396         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.         CL*14
  5397         88  CHECK-LEAP-YEAR            VALUE 'H'.                   CL*14
  5398         88  BIN-3-TO-GREG              VALUE 'I'.                   CL*14
  5399         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.                   CL*14
  5400         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.                   CL*14
  5401         88  CYMD-GREG-TO-BIN           VALUE 'L'.                   CL*14
  5402         88  MDCY-GREG-TO-BIN           VALUE 'M'.                   CL*14
  5403         88  MDY-GREG-TO-JULIAN         VALUE 'N'.                   CL*14
  5404         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.                   CL*14
  5405         88  YMD-GREG-TO-JULIAN         VALUE 'P'.                   CL*14
  5406         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.                   CL*14
  5407         88  THREE-CHARACTER-BIN                                  ELCDATE
  5408                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.       CL*14
  5409         88  GREGORIAN-TO-BIN                                        CL**2
  5410                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.    CL*14
  5411         88  BIN-TO-GREGORIAN                                        CL**2
  5412                  VALUES ' ' '1' 'I' '8' 'G'.                        CL*14
  5413         88  JULIAN-TO-BINARY                                        CL**2
  5414                  VALUES '5' 'C' 'E' 'F'.                            CL*14
  5415     12  DC-ERROR-CODE                 PIC X.                        CL*15
  5416         88  NO-CONVERSION-ERROR        VALUE ' '.                   CL**3
  5417         88  DATE-CONVERSION-ERROR                                ELCDATE
  5418                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.        CL*14
  5419         88  DATE-IS-ZERO               VALUE '1'.                ELCDATE
  5420         88  DATE-IS-NON-NUMERIC        VALUE '2'.                ELCDATE
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 108
* ECS010Z.cbl (/apps/prod/cid1p/copy/ELCDATE)
  5421         88  DATE-IS-INVALID            VALUE '3'.                ELCDATE
  5422         88  DATE1-GREATER-DATE2        VALUE '4'.                ELCDATE
  5423         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.                ELCDATE
  5424         88  DATE-INVALID-OPTION        VALUE '9'.                ELCDATE
  5425         88  INVALID-CENTURY            VALUE 'A'.                ELCDATE
  5426         88  ONLY-CENTURY               VALUE 'B'.                ELCDATE
  5427         88  ONLY-LEAP-YEAR             VALUE 'C'.                ELCDATE
  5428         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.              CL**3
  5429     12  DC-END-OF-MONTH               PIC X.                        CL*15
  5430         88  CALCULATE-END-OF-MONTH     VALUE '1'.                ELCDATE
  5431     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.         CL*15
  5432         88  USE-NORMAL-PROCESS         VALUE ' '.                ELCDATE
  5433         88  ADJUST-DOWN-100-YRS        VALUE '1'.                ELCDATE
  5434         88  ADJUST-UP-100-YRS          VALUE '2'.                ELCDATE
  5435     12  FILLER                        PIC X.                        CL*15
  5436     12  DC-CONVERSION-DATES.                                        CL*15
  5437         16  DC-BIN-DATE-1             PIC XX.                       CL*15
  5438         16  DC-BIN-DATE-2             PIC XX.                       CL*15
  5439         16  DC-GREG-DATE-1-EDIT       PIC X(08).                    CL*15
  5440         16  DC-GREG-DATE-1-EDIT-R REDEFINES                         CL*15
  5441                       DC-GREG-DATE-1-EDIT.                       ELCDATE
  5442             20  DC-EDIT1-MONTH        PIC 99.                       CL*15
  5443             20  SLASH1-1              PIC X.                        CL*15
  5444             20  DC-EDIT1-DAY          PIC 99.                       CL*15
  5445             20  SLASH1-2              PIC X.                        CL*15
  5446             20  DC-EDIT1-YEAR         PIC 99.                       CL*15
  5447         16  DC-GREG-DATE-2-EDIT       PIC X(08).                    CL*15
  5448         16  DC-GREG-DATE-2-EDIT-R REDEFINES                         CL*15
  5449                     DC-GREG-DATE-2-EDIT.                         ELCDATE
  5450             20  DC-EDIT2-MONTH        PIC 99.                       CL*15
  5451             20  SLASH2-1              PIC X.                        CL*15
  5452             20  DC-EDIT2-DAY          PIC 99.                       CL*15
  5453             20  SLASH2-2              PIC X.                        CL*15
  5454             20  DC-EDIT2-YEAR         PIC 99.                       CL*15
  5455         16  DC-GREG-DATE-1-YMD        PIC 9(06).                    CL*15
  5456         16  DC-GREG-DATE-1-YMD-R  REDEFINES                         CL*15
  5457                     DC-GREG-DATE-1-YMD.                          ELCDATE
  5458             20  DC-YMD-YEAR           PIC 99.                       CL*15
  5459             20  DC-YMD-MONTH          PIC 99.                       CL*15
  5460             20  DC-YMD-DAY            PIC 99.                       CL*15
  5461         16  DC-GREG-DATE-1-MDY        PIC 9(06).                    CL*15
  5462         16  DC-GREG-DATE-1-MDY-R REDEFINES                          CL*15
  5463                      DC-GREG-DATE-1-MDY.                         ELCDATE
  5464             20  DC-MDY-MONTH          PIC 99.                       CL*15
  5465             20  DC-MDY-DAY            PIC 99.                       CL*15
  5466             20  DC-MDY-YEAR           PIC 99.                       CL*15
  5467         16  DC-GREG-DATE-1-ALPHA.                                   CL*15
  5468             20  DC-ALPHA-MONTH        PIC X(10).                    CL*15
  5469             20  DC-ALPHA-DAY          PIC 99.                       CL*15
  5470             20  FILLER                PIC XX.                       CL*15
  5471             20  DC-ALPHA-CENTURY.                                   CL*15
  5472                 24 DC-ALPHA-CEN-N     PIC 99.                       CL*15
  5473             20  DC-ALPHA-YEAR         PIC 99.                       CL*15
  5474         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.           CL*15
  5475         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.           CL*15
  5476         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.           CL*15
  5477         16  DC-JULIAN-DATE            PIC 9(05).                    CL*15
  5478         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE                CL*20
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 109
* ECS010Z.cbl (/apps/prod/cid1p/copy/ELCDATE)
  5479                                       PIC 9(05).                    CL*20
  5480         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.                  CL*15
  5481             20  DC-JULIAN-YEAR        PIC 99.                       CL*15
  5482             20  DC-JULIAN-DAYS        PIC 999.                      CL*15
  5483         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.       CL*15
  5484         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.    CL*15
  5485         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.    CL*15
  5486     12  DATE-CONVERSION-VARIBLES.                                   CL*15
  5487         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.            CL*15
  5488         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.          CL*15
  5489             20  FILLER                PIC 9(3).                     CL*15
  5490             20  HOLD-CEN-1-CCYY.                                    CL*15
  5491                 24  HOLD-CEN-1-CC     PIC 99.                       CL*17
  5492                 24  HOLD-CEN-1-YY     PIC 99.                       CL*17
  5493             20  HOLD-CEN-1-MO         PIC 99.                       CL*17
  5494             20  HOLD-CEN-1-DA         PIC 99.                       CL*17
  5495         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.            CL*15
  5496             20  HOLD-CEN-1-R-MO       PIC 99.                       CL*17
  5497             20  HOLD-CEN-1-R-DA       PIC 99.                       CL*17
  5498             20  HOLD-CEN-1-R-CCYY.                                  CL*15
  5499                 24  HOLD-CEN-1-R-CC   PIC 99.                       CL*17
  5500                 24  HOLD-CEN-1-R-YY   PIC 99.                       CL*17
  5501             20  FILLER                PIC 9(3).                     CL*15
  5502         16  HOLD-CENTURY-1-X.                                       CL*15
  5503             20  FILLER                PIC X(3)  VALUE SPACES.       CL*15
  5504             20  HOLD-CEN-1-X-CCYY.                                  CL*15
  5505                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.          CL*17
  5506                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.          CL*17
  5507             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.          CL*17
  5508             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.          CL*17
  5509         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.          CL*15
  5510             20  HOLD-CEN-1-R-X-MO     PIC XX.                       CL*17
  5511             20  HOLD-CEN-1-R-X-DA     PIC XX.                       CL*17
  5512             20  HOLD-CEN-1-R-X-CCYY.                                CL*15
  5513                 24  HOLD-CEN-1-R-X-CC PIC XX.                       CL*17
  5514                 24  HOLD-CEN-1-R-X-YY PIC XX.                       CL*17
  5515             20  FILLER                PIC XXX.                      CL*23
  5516         16  DC-BIN-DATE-EXPAND-1      PIC XXX.                      CL*15
  5517         16  DC-BIN-DATE-EXPAND-2      PIC XXX.                      CL*15
  5518         16  DC-JULIAN-DATE-1          PIC 9(07).                    CL*15
  5519         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.          CL*15
  5520             20  DC-JULIAN-1-CCYY.                                   CL*15
  5521                 24  DC-JULIAN-1-CC    PIC 99.                       CL*15
  5522                 24  DC-JULIAN-1-YR    PIC 99.                       CL*15
  5523             20  DC-JULIAN-DA-1        PIC 999.                      CL*15
  5524         16  DC-JULIAN-DATE-2          PIC 9(07).                    CL*15
  5525         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.          CL*15
  5526             20  DC-JULIAN-2-CCYY.                                   CL*15
  5527                 24  DC-JULIAN-2-CC    PIC 99.                       CL*15
  5528                 24  DC-JULIAN-2-YR    PIC 99.                       CL*15
  5529             20  DC-JULIAN-DA-2        PIC 999.                      CL*15
  5530         16  DC-GREG-DATE-A-EDIT.                                    CL*15
  5531             20  DC-EDITA-MONTH        PIC 99.                       CL*15
  5532             20  SLASHA-1              PIC X VALUE '/'.              CL*15
  5533             20  DC-EDITA-DAY          PIC 99.                       CL*15
  5534             20  SLASHA-2              PIC X VALUE '/'.              CL*15
  5535             20  DC-EDITA-CCYY.                                      CL*15
  5536                 24  DC-EDITA-CENT     PIC 99.                       CL*15
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 110
* ECS010Z.cbl (/apps/prod/cid1p/copy/ELCDATE)
  5537                 24  DC-EDITA-YEAR     PIC 99.                       CL*15
  5538         16  DC-GREG-DATE-B-EDIT.                                    CL*15
  5539             20  DC-EDITB-MONTH        PIC 99.                       CL*15
  5540             20  SLASHB-1              PIC X VALUE '/'.              CL*15
  5541             20  DC-EDITB-DAY          PIC 99.                       CL*15
  5542             20  SLASHB-2              PIC X VALUE '/'.              CL*15
  5543             20  DC-EDITB-CCYY.                                      CL*15
  5544                 24  DC-EDITB-CENT     PIC 99.                       CL*15
  5545                 24  DC-EDITB-YEAR     PIC 99.                       CL*15
  5546         16  DC-GREG-DATE-CYMD         PIC 9(08).                    CL*15
  5547         16  DC-GREG-DATE-CYMD-R REDEFINES                           CL*15
  5548                              DC-GREG-DATE-CYMD.                  ELCDATE
  5549             20  DC-CYMD-CEN           PIC 99.                       CL*15
  5550             20  DC-CYMD-YEAR          PIC 99.                       CL*15
  5551             20  DC-CYMD-MONTH         PIC 99.                       CL*15
  5552             20  DC-CYMD-DAY           PIC 99.                       CL*15
  5553         16  DC-GREG-DATE-MDCY         PIC 9(08).                    CL*15
  5554         16  DC-GREG-DATE-MDCY-R REDEFINES                           CL*15
  5555                              DC-GREG-DATE-MDCY.                  ELCDATE
  5556             20  DC-MDCY-MONTH         PIC 99.                       CL*15
  5557             20  DC-MDCY-DAY           PIC 99.                       CL*15
  5558             20  DC-MDCY-CEN           PIC 99.                       CL*15
  5559             20  DC-MDCY-YEAR          PIC 99.                       CL*15
  5560    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.      ELCDATE
  5561        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.        ELCDATE
  5562    12  DC-EL310-DATE                  PIC X(21).                    CL*26
  5563    12  FILLER                         PIC X(28).                    CL*26
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 111
* ECS010Z.cbl
  5565 01  CPA-STARTS-HERE             PIC X(48)
  5566       VALUE '***** CALCULATION PASS AREA STARTS HERE ********'.
* 5567                             COPY ELCCALC.
  5568******************************************************************04/15/98
  5569*                                                                *ELCCALC
  5570*                           ELCCALC.                            *    LV003
  5571*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
  5572*                            VMOD=2.025                          *   CL**3
  5573*                                                                *   CL**2
  5574*   DESCRIPTION:  DATA TO BE PASSED TO REMAINING TERM ROUTINE    *   CL**2
  5575*                 REMAINING AMOUNT ROUTINE, LOSS RESERVE ROUTINE *   CL**2
  5576*                 REFUND CALCULATIONS ROUTINE, EARNINGS CALCU -  *   CL**2
  5577*                 LATIONS ROUTINE, AND THE RATING ROUTINE.       *   CL**2
  5578*                                                                *   CL**2
  5579*  PASSED TO ELRTRM                                              *   CL**2
  5580*  -----------------                                             *   CL**2
  5581*  METHOD CODE (I.E. FULL MONTH, HALF ADJ, ETC)                  *   CL**2
  5582*  ORIGINAL TERM                                                 *   CL**2
  5583*  BEGINNING DATE                                                *   CL**2
  5584*  ENDING DATE                                                   *   CL**2
  5585*  COMPANY I.D.                                                  *   CL**2
  5586*  ACCOUNT MASTER USER FIELD                                     *   CL**2
  5587*  PROCESS SWITCH (CANCEL, CLAIM)                                *   CL**2
  5588*  FREE LOOK DAYS                                                *   CL**2
  5589*                                                                *   CL**2
  5590*  RETURNED FROM ELRTRM                                          *   CL**2
  5591*  ---------------------                                         *   CL**2
  5592*  REMAINING TERM 1 - USED FOR EARNINGS                          *   CL**2
  5593*  REMAINING TERM 2 - USED FOR BENEFIT CALCULATIONS              *   CL**2
  5594*  REMAINING TERM 3 - USED FOR CLAIM BENEFITS                    *   CL**2
  5595*  ODD DAYS - REMAINING DAYS PAST FULL MONTHS                    *   CL**2
  5596*----------------------------------------------------------------*   CL**2
  5597*  PASSED TO ELRAMT                                              *   CL**2
  5598*  ----------------                                              *   CL**2
  5599*  REMAINING TERM 1 OR 2 OR 3 (FROM ELRTRM)                      *   CL**2
  5600*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *   CL**2
  5601*  ORIGINAL AMOUNT                                               *   CL**2
  5602*  ALTERNATE BENEFIT (BALLON)                                    *   CL**2
  5603*  A.P.R. - NET PAY ONLY                                         *   CL**2
  5604*  METHOD                                                            CL**2
  5605*  PAYMENT FREQUENCY - FOR FARM PLAN                             *   CL**2
  5606*  COMPANY I.D.                                                  *   CL**2
  5607*  BENEFIT TYPE                                                  *   CL**2
  5608*                                                                *   CL**2
  5609*  RETURNED FROM ELRAMT                                          *   CL**2
  5610*  --------------------                                          *   CL**2
  5611*  REMAINING AMOUNT 1 - CURRENT                                  *   CL**2
  5612*  REMAINING AMOUNT 2 - PREVIOUS MONTH                           *   CL**2
  5613*  REMAINING AMOUNT FACTOR                                           CL**2
  5614*----------------------------------------------------------------*   CL**2
  5615*  PASSED TO ELRESV                                              *   CL**2
  5616*  -----------------                                             *   CL**2
  5617*  CERTIFICATE EFFECTIVE DATE                                    *   CL**2
  5618*  VALUATION DATE                                                *   CL**2
  5619*  PAID THRU DATE                                                *   CL**2
  5620*  BENEFIT                                                       *   CL**2
  5621*  INCURRED DATE                                                 *   CL**2
  5622*  REPORTED DATE                                                 *   CL**2
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 112
* ECS010Z.cbl (/apps/prod/cid1p/copy/ELCCALC)
  5623*  ISSUE AGE                                                     *   CL**2
  5624*  TERM                                                          *   CL**2
  5625*  CDT PERCENT                                                   *   CL**2
  5626*  CDT METHOD (I.E. INTERPOLATED, AVERAGE, ETC)                  *   CL**2
  5627* *CLAIM TYPE (LIFE, A/H)                                        *   CL**2
  5628* *REMAINING BENEFIT (FROM ELRAMT)                               *   CL**2
  5629* *ONLY FIELDS REQUIRED FOR LIFE CLAIMS                          *   CL**2
  5630*                                                                *   CL**2
  5631*  RETURNED FROM ELRESV                                          *   CL**2
  5632*  --------------------                                          *   CL**2
  5633*  CDT TABLE USED                                                *   CL**2
  5634*  CDT FACTOR USED                                               *   CL**2
  5635*  PAY TO CURRENT RESERVE                                        *   CL**2
  5636*  I.B.N.R. - A/H ONLY                                           *   CL**2
  5637*  FUTURE (ACCRUED) AH ONLY                                      *   CL**2
  5638*----------------------------------------------------------------*   CL**2
  5639*  PASSED TO ELRATE                                              *   CL**2
  5640*  ----------------                                              *   CL**2
  5641*  CERT ISSUE DATE                                               *   CL**2
  5642*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *   CL**2
  5643*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *   CL**2
  5644*  CAPPED TERM   (ONLY FOR TRUNCATED LIFE)                       *   CL**2
  5645*  STATE CODE (CLIENT DEFINED)                                   *   CL**2
  5646*  STATE CODE (STANDARD P.O. ABBRV)                              *   CL**2
  5647*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *   CL**2
  5648*  DEVIATION CODE                                                *   CL**2
  5649*  ISSUE AGE                                                     *   CL**2
  5650*  ORIGINAL BENEFIT AMOUNT                                       *   CL**2
  5651*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *   CL**2
  5652*  PROCESS TYPE (ISSUE OR CANCEL)                                *   CL**2
  5653*  BENEFIT KIND (LIFE OR A/H)                                    *   CL**2
  5654*  A.P.R.                                                        *   CL**2
  5655*  METHOD                                                            CL**2
  5656*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *   CL**2
  5657*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *   CL**2
  5658*  COMPANY I.D. (3 CHARACTER)                                    *   CL**2
  5659*  BENEFIT CODE                                                  *   CL**2
  5660*  BENEFIT OVERRIDE CODE                                         *   CL**2
  5661*  MAXIMUM MONTHLY BENEFIT (FROM ACCT MASTER - CSL ONLY)         *   CL**2
  5662*  MAXIMUM TOTAL BENEFIT (FROM ACCT MASTER - CSL ONLY)           *   CL**2
  5663*  JOINT INDICATOR (CSL ONLY)                                    *   CL**2
  5664*  FIRST PAYMENT DATE (CSL ONLY)                                 *   CL**2
  5665*  PERIODIC PAYMENT AMOUNT (IN CP-REMAINING-TERM - CSL ONLY)     *   CL**2
  5666*                                                                *   CL**2
  5667*  RETURNED FROM ELRATE                                          *   CL**2
  5668*  --------------------                                          *   CL**2
  5669*  CALCULATED PREMIUM                                            *   CL**2
  5670*  PREMIUM RATE                                                  *   CL**2
  5671*  MORTALITY CODE                                                *   CL**2
  5672*  MAX ATTAINED AGE                                              *   CL**2
  5673*  MAX AGE                                                       *   CL**2
  5674*  MAX TERM                                                      *   CL**2
  5675*  MAX MONTHLY BENEFIT                                           *   CL**2
  5676*  MAX TOTAL BENIFIT                                             *   CL**2
  5677*  COMPOSITE RATE (OPEN-END ONLY)                                *   CL**2
  5678*----------------------------------------------------------------*   CL**2
  5679*  PASSED TO ELRFND                                              *   CL**2
  5680*  ----------------                                              *   CL**2
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 113
* ECS010Z.cbl (/apps/prod/cid1p/copy/ELCCALC)
  5681*  CERT ISSUE DATE                                               *   CL**2
  5682*  REFUND DATE                                                   *   CL**2
  5683*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *   CL**2
  5684*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *   CL**2
  5685*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *   CL**2
  5686*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *   CL**2
  5687*  STATE CODE (CLIENT DEFINED)                                   *   CL**2
  5688*  STATE CODE (STANDARD P.O. ABBRV)                              *   CL**2
  5689*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *   CL**2
  5690*  DEVIATION CODE                                                *   CL**2
  5691*  ISSUE AGE                                                     *   CL**2
  5692*  ORIGINAL BENEFIT AMOUNT                                       *   CL**2
  5693*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *   CL**2
  5694*  PROCESS TYPE (CANCEL)                                         *   CL**2
  5695*  BENEFIT KIND (LIFE OR A/H)                                    *   CL**2
  5696*  A.P.R.                                                        *   CL**2
  5697*  EARNING METHOD - (CODE FROM BENEFIT, STATE OR ACCOUNT RECORD) *   CL**2
  5698*  RATING METHOD -  (CODE FROM BENEFIT)                          *   CL**2
  5699*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *   CL**2
  5700*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *   CL**2
  5701*  COMPANY I.D. (3 CHARACTER)                                    *   CL**2
  5702*  BENEFIT CODE                                                  *   CL**2
  5703*  BENEFIT OVERRIDE CODE                                         *   CL**2
  5704*                                                                *   CL**2
  5705*  RETURNED FROM ELRFND                                          *   CL**2
  5706*  --------------------                                          *   CL**2
  5707*  CALCULATED REFUND                                             *   CL**2
  5708*----------------------------------------------------------------*   CL**2
  5709*  PASSED TO ELEARN                                              *   CL**2
  5710*  ----------------                                              *   CL**2
  5711*  CERT ISSUE DATE                                               *   CL**2
  5712*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *   CL**2
  5713*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *   CL**2
  5714*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *   CL**2
  5715*  STATE CODE (CLIENT DEFINED)                                   *   CL**2
  5716*  STATE CODE (STANDARD P.O. ABBRV)                              *   CL**2
  5717*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *   CL**2
  5718*  DEVIATION CODE                                                *   CL**2
  5719*  ISSUE AGE                                                     *   CL**2
  5720*  ORIGINAL BENEFIT AMOUNT                                       *   CL**2
  5721*  BENEFIT KIND (LIFE OR A/H)                                    *   CL**2
  5722*  A.P.R.                                                        *   CL**2
  5723*  METHOD - (EARNING CODE FROM BENEFIT RECORD)                   *   CL**2
  5724*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *   CL**2
  5725*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *   CL**2
  5726*  COMPANY I.D. (3 CHARACTER)                                    *   CL**2
  5727*  BENEFIT CODE                                                  *   CL**2
  5728*  BENEFIT OVERRIDE CODE                                         *   CL**2
  5729*                                                                *   CL**2
  5730*  RETURNED FROM ELEARN                                          *   CL**2
  5731*  --------------------                                          *   CL**2
  5732*  INDICATED  EARNINGS                                           *   CL**2
  5733*----------------------------------------------------------------*   CL**2
  5734*                 LENGTH = 450                                   *   CL**2
  5735*                                                                *   CL**2
  5736******************************************************************   CL**2
  5737******************************************************************
  5738*                   C H A N G E   L O G
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 114
* ECS010Z.cbl (/apps/prod/cid1p/copy/ELCCALC)
  5739*
  5740* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5741*-----------------------------------------------------------------
  5742*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5743* EFFECTIVE    NUMBER
  5744*-----------------------------------------------------------------
  5745* 010303    2001061800003  PEMA  ADD DCC/MONTHLY PROCESSING
  5746* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  5747* 101807    2007100100007  PEMA  EXPAND CLM RESERVE FIELDS
  5748* 010410    2008021200005  PEMA  ADD FIELDS FOR MN NET PAY BALLOON
  5749* 010410    2009050700003  PEMA  ADD FIELDS FOR SPP-DD
  5750* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  5751* 041710    2007111300001  AJRA  ADD CLAIM CALC SW FOR SC NP+6
  5752* 101110  CR2010012700001  PEMA ADD DDF REFUND/UEP PROCESSING
  5753* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  5754* 040615  CR2013072200002  PEMA  ADD EXTRA PERIODS
  5755******************************************************************
  5756                                                                     CL**2
  5757 01  CALCULATION-PASS-AREA.                                          CL**2
  5758     12  CP-COMM-LENGTH            PIC S9(4)         VALUE +450      CL**2
  5759                                     COMP.                           CL**2
  5760                                                                     CL**2
  5761     12  CP-RETURN-CODE            PIC X             VALUE ZERO.     CL**2
  5762       88  NO-CP-ERROR                             VALUE ZERO.       CL**2
  5763       88  CP-ERROR-OCCURED VALUE '1' '2' '3' '4' '5' '6' '7' '8'    CL**2
  5764                                  '9' 'A' 'B' 'C' 'D' 'E' 'H'.       CL**2
  5765       88  CP-ERROR-IN-AMOUNTS                     VALUE '1'.        CL**2
  5766       88  CP-ERROR-IN-DATES                       VALUE '2'.        CL**2
  5767       88  CP-ERROR-IN-OPTIONS                     VALUE '3'.        CL**2
  5768       88  CP-ERROR-IN-TERMS                       VALUE '4'.        CL**2
  5769       88  CP-ERROR-IN-FREQUENCY                   VALUE '5'.        CL**2
  5770       88  CP-ERROR-RATE-NOT-FOUND                 VALUE '6'.        CL**2
  5771       88  CP-ERROR-RATE-IS-ZERO                   VALUE '7'.        CL**2
  5772       88  CP-ERROR-AMT-OUTSIDE-LIMIT              VALUE '8'.        CL**2
  5773       88  CP-ERROR-TERM-OUTSIDE-LIMIT             VALUE '9'.        CL**2
  5774       88  CP-ERROR-AGE-OUTSIDE-LIMIT              VALUE 'A'.        CL**2
  5775       88  CP-ERROR-ATT-OUTSIDE-LIMIT              VALUE 'B'.        CL**2
  5776       88  CP-ERROR-TOT-OUTSIDE-LIMIT              VALUE 'C'.        CL**2
  5777       88  CP-ERROR-RATE-FILE-NOTOPEN              VALUE 'D'.        CL**2
  5778       88  CP-ERROR-ISSUE-AGE-ZERO                 VALUE 'E'.        CL**2
  5779       88  CP-ERROR-NO-LIMITS-CRI                  VALUE 'F'.        CL**2
  5780       88  CP-ERROR-DIV-BY-ZERO                    VALUE 'G'.        CL**2
  5781       88  CP-ERROR-LOAN-TERM                      VALUE 'H'.        CL**2
  5782                                                                     CL**2
  5783     12  CP-RETURN-CODE-2          PIC X             VALUE ZERO.     CL**2
  5784       88  NO-CP-ERROR-2                           VALUE ZERO.       CL**2
  5785***********************  INPUT AREAS ****************************    CL**2
  5786                                                                     CL**2
  5787     12  CP-CALCULATION-AREA.                                        CL**2
  5788         16  CP-ACCOUNT-NUMBER     PIC X(10)       VALUE SPACES.     CL**2
  5789         16  CP-CERT-EFF-DT        PIC XX.                           CL**2
  5790         16  CP-VALUATION-DT       PIC XX.                           CL**2
  5791         16  CP-PAID-THRU-DT       PIC XX.                           CL**2
  5792         16  CP-BENEFIT-TYPE       PIC X.                            CL**2
  5793           88  CP-AH                               VALUE 'A' 'D'     CL**2
  5794                                                   'I' 'U'.          CL**2
  5795           88  CP-REDUCING-LIFE                    VALUE 'R'.        CL**2
  5796           88  CP-LEVEL-LIFE                       VALUE 'L' 'P'.    CL**2
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 115
* ECS010Z.cbl (/apps/prod/cid1p/copy/ELCCALC)
  5797         16  CP-INCURRED-DT        PIC XX.                           CL**2
  5798         16  CP-REPORTED-DT        PIC XX.                           CL**2
  5799         16  CP-ACCT-FLD-5         PIC XX            VALUE SPACE.    CL**2
  5800         16  CP-COMPANY-ID         PIC XXX           VALUE SPACE.    CL**2
  5801         16  CP-ISSUE-AGE          PIC S9(3)         VALUE ZERO      CL**2
  5802                                     COMP-3.                         CL**2
  5803         16  CP-CDT-PERCENT        PIC S9(3)V99      VALUE ZERO      CL**2
  5804                                     COMP-3.                         CL**2
  5805         16  CP-CDT-METHOD         PIC X.                            CL**2
  5806           88  CP-CDT-ROUND-NEAR                   VALUE '1'.        CL**2
  5807           88  CP-CDT-ROUND-HIGH                   VALUE '2'.        CL**2
  5808           88  CP-CDT-INTERPOLATED                 VALUE '3'.        CL**2
  5809         16  CP-CLAIM-TYPE         PIC X.                            CL**2
  5810           88  CP-AH-CLAIM                         VALUE 'A'.        CL**2
  5811           88  CP-LIFE-CLAIM                       VALUE 'L'.        CL**2
  5812         16  CP-ORIGINAL-TERM      PIC S9(3)         VALUE ZERO      CL**2
  5813                                     COMP-3.                         CL**2
  5814         16  CP-ORIGINAL-BENEFIT   PIC S9(9)V99      VALUE ZERO      CL**2
  5815                                     COMP-3.                         CL**2
  5816         16  CP-ORIGINAL-PREMIUM   PIC S9(7)V99      VALUE ZERO      CL**2
  5817                                     COMP-3.                         CL**2
  5818         16  CP-REMAINING-TERM     PIC S9(3)V99      VALUE ZERO      CL**2
  5819                                     COMP-3.                         CL**2
  5820         16  CP-REMAINING-BENEFIT  PIC S9(9)V99      VALUE ZERO      CL**2
  5821                                     COMP-3.                         CL**2
  5822         16  CP-LOAN-APR           PIC S9(3)V9(4)    VALUE ZERO      CL**2
  5823                                     COMP-3.                         CL**2
  5824         16  CP-PAY-FREQUENCY      PIC S9(3)         VALUE ZERO      CL**2
  5825                                     COMP-3.                         CL**2
  5826         16  CP-REM-TERM-METHOD    PIC X.                            CL**2
  5827           88  CP-EARN-AFTER-15TH                  VALUE '1'.        CL**2
  5828           88  CP-EARN-ON-HALF-MONTH               VALUE '2'.        CL**2
  5829           88  CP-EARN-ON-1ST-DAY                  VALUE '3'.        CL**2
  5830           88  CP-EARN-ON-FULL-MONTH               VALUE '4'.        CL**2
  5831           88  CP-EARN-WITH-NO-DAYS                VALUE '5'.        CL**2
  5832           88  CP-EARN-AFTER-14TH                  VALUE '6'.        CL**2
  5833           88  CP-EARN-AFTER-16TH                  VALUE '7'.        CL**2
  5834         16  CP-EARNING-METHOD     PIC X.                            CL**2
  5835           88  CP-EARN-BY-R78                      VALUE '1' 'R'.    CL**2
  5836           88  CP-EARN-BY-PRORATA                  VALUE '2' 'P'.    CL**2
  5837           88  CP-EARN-AS-CALIF                    VALUE '3' 'C'.    CL**2
  5838           88  CP-EARN-AS-TEXAS                    VALUE '4' 'T'.    CL**2
  5839           88  CP-EARN-AS-FARM-PLAN                VALUE '4' 'T'.    CL**2
  5840           88  CP-EARN-AS-NET-PAY                  VALUE '5' 'N'.    CL**2
  5841           88  CP-EARN-ANTICIPATION                VALUE '6' 'A'.    CL**2
  5842           88  CP-EARN-AS-MEAN                     VALUE '8' 'M'.    CL**2
  5843           88  CP-EARN-AS-SUM-OF-DIGITS            VALUE '9'.        CL**2
  5844           88  CP-EARN-AS-REG-BALLOON              VALUE 'B'.        CL**2
  5845           88  CP-GAP-NON-REFUNDABLE               VALUE 'G'.
  5846           88  CP-GAP-ACTUARIAL                    VALUE 'S'.
  5847           88  CP-DCC-SPP-DDF                      VALUE 'D' 'I'.
  5848           88  CP-DCC-SPP-DDF-IU                   VALUE 'I'.
  5849         16  CP-PROCESS-TYPE       PIC X.                            CL**2
  5850           88  CP-CLAIM                            VALUE '1'.        CL**2
  5851           88  CP-CANCEL                           VALUE '2'.        CL**2
  5852           88  CP-ISSUE                            VALUE '3'.        CL**2
  5853         16  CP-SPECIAL-CALC-CD    PIC X.                            CL**2
  5854           88  CP-OUTSTANDING-BAL              VALUE 'O'.            CL**2
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 116
* ECS010Z.cbl (/apps/prod/cid1p/copy/ELCCALC)
  5855           88  CP-1-MTH-INTEREST               VALUE ' '.            CL**2
  5856           88  CP-0-MTH-INTEREST               VALUE 'A'.            CL**2
  5857           88  CP-OB-OFFLINE-RESERVED          VALUE 'B'.            CL**2
  5858           88  CP-CRITICAL-PERIOD              VALUE 'C'.            CL**2
  5859           88  CP-TERM-IS-DAYS                 VALUE 'D'.            CL**2
  5860           88  CP-USE-PREM-AS-ENTERED          VALUE 'E'.            CL**2
  5861           88  CP-FARM-PLAN                    VALUE 'F'.            CL**2
  5862           88  CP-RATE-AS-STANDARD             VALUE 'G'.            CL**2
  5863           88  CP-2-MTH-INTEREST               VALUE 'I'.            CL**2
  5864           88  CP-3-MTH-INTEREST               VALUE 'J'.            CL**2
  5865           88  CP-4-MTH-INTEREST               VALUE 'K'.            CL**2
  5866           88  CP-BALLOON-LAST-PMT             VALUE 'L'.            CL**2
  5867           88  CP-MORTGAGE-REC                 VALUE 'M'.            CL**2
  5868           88  CP-OUTSTANDING-BALANCE          VALUE 'O'.            CL**2
  5869           88  CP-NET-PAY-PRUDENTIAL           VALUE 'P'.            CL**2
  5870           88  CP-NET-PAY-SIMPLE               VALUE 'S'.            CL**2
  5871           88  CP-TRUNCATED-LIFE               VALUE 'T' 'U' 'V'     CL**2
  5872                                                     'W' 'X'.        CL**2
  5873           88  CP-TRUNCATE-0-MTH               VALUE 'T'.            CL**2
  5874           88  CP-TRUNCATE-1-MTH               VALUE 'U'.            CL**2
  5875           88  CP-TRUNCATE-2-MTH               VALUE 'V'.            CL**2
  5876           88  CP-TRUNCATE-3-MTH               VALUE 'W'.            CL**2
  5877           88  CP-TRUNCATE-4-MTH               VALUE 'X'.            CL**2
  5878           88  CP-SUMMARY-REC                  VALUE 'Z'.            CL**2
  5879           88  CP-PROPERTY-BENEFIT             VALUE '2'.            CL**2
  5880           88  CP-UNEMPLOYMENT-BENEFIT         VALUE '3'.            CL**2
  5881           88  CP-AD-D-BENEFIT                 VALUE '4'.            CL**2
  5882           88  CP-CSL-METH-1                   VALUE '5'.            CL**2
  5883           88  CP-CSL-METH-2                   VALUE '6'.            CL**2
  5884           88  CP-CSL-METH-3                   VALUE '7'.            CL**2
  5885           88  CP-CSL-METH-4                   VALUE '8'.            CL**2
  5886                                                                     CL**2
  5887         16  CP-LOAN-TERM          PIC S9(3)       VALUE ZERO        CL**2
  5888                                     COMP-3.                         CL**2
  5889         16  CP-CLASS-CODE         PIC XX          VALUE ZERO.       CL**2
  5890         16  CP-DEVIATION-CODE     PIC XXX         VALUE ZERO.       CL**2
  5891         16  CP-STATE              PIC XX          VALUE SPACE.      CL**2
  5892         16  CP-STATE-STD-ABBRV    PIC XX          VALUE SPACE.      CL**2
  5893         16  CP-BENEFIT-CD         PIC XX          VALUE ZERO.       CL**2
  5894           88  CP-CSL-VALID-NP-BENEFIT-CD VALUES '12' '13'           CL**2
  5895               '34' '35' '36' '37' '44' '45' '46' '47' '72' '73'.    CL**2
  5896         16  CP-R78-OPTION         PIC X.                            CL**2
  5897           88  CP-TERM-TIMES-TERM-PLUS-1           VALUE ' '.        CL**2
  5898           88  CP-TERM-TIMES-TERM                  VALUE '1'.        CL**2
  5899                                                                     CL**2
  5900         16  CP-COMPANY-CD         PIC X             VALUE SPACE.    CL**2
  5901         16  CP-IBNR-RESERVE-SW    PIC X.                            CL**2
  5902         16  CP-CLAIM-STATUS       PIC X.                            CL**2
  5903         16  CP-RATE-FILE          PIC X.                            CL**2
  5904         16  CP-TERM-OR-EXT-DAYS   PIC S9(05)        VALUE ZERO      CL**2
  5905                                     COMP-3.                         CL**2
  5906                                                                     CL**2
  5907         16  CP-LIFE-OVERRIDE-CODE PIC X.                            CL**2
  5908         16  CP-AH-OVERRIDE-CODE   PIC X.                            CL**2
  5909                                                                     CL**2
  5910         16  CP-RATE-DEV-PCT       PIC S9V9(6)       VALUE ZERO      CL**2
  5911                                     COMP-3.
  5912         16  CP-CLP-RATE-UP        REDEFINES CP-RATE-DEV-PCT
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 117
* ECS010Z.cbl (/apps/prod/cid1p/copy/ELCCALC)
  5913                                   PIC S9(5)V99 COMP-3.
  5914         16  CP-CRITICAL-MONTHS    PIC S9(3)         VALUE ZERO      CL**2
  5915                                     COMP-3.                         CL**2
  5916         16  CP-ALTERNATE-BENEFIT  PIC S9(9)V99      VALUE ZERO      CL**2
  5917                                     COMP-3.                         CL**2
  5918         16  CP-ALTERNATE-PREMIUM  PIC S9(7)V99      VALUE ZERO      CL**2
  5919                                     COMP-3.
  5920         16  CP-DDF-CSO-ADMIN-FEE REDEFINES CP-ALTERNATE-PREMIUM
  5921                                  PIC S9(7)V99 COMP-3.
  5922                                                                     CL**2
  5923         16  CP-PAID-FROM-DATE     PIC X(02).                        CL**2
  5924         16  CP-CLAIM-CALC-METHOD  PIC X(01).                        CL**2
  5925         16  CP-EXT-DAYS-CALC      PIC X.                            CL**2
  5926           88  CP-EXT-NO-CHG                   VALUE ' '.            CL**2
  5927           88  CP-EXT-CHG-LF                   VALUE '1'.            CL**2
  5928           88  CP-EXT-CHG-AH                   VALUE '2'.            CL**2
  5929           88  CP-EXT-CHG-LF-AH                VALUE '3'.            CL**2
  5930         16  CP-DOMICILE-STATE     PIC XX.                           CL**2
  5931         16  CP-CARRIER            PIC X.                            CL**2
  5932         16  CP-REIN-FLAG          PIC X.                            CL**2
  5933         16  CP-REM-TRM-CALC-OPTION PIC X.                           CL**2
  5934           88  VALID-REM-TRM-CALC-OPTION    VALUE '1'                CL**2
  5935                      '2' '3' '4' '5'.                               CL**2
  5936           88  CP-CALC-OPTION-DEFAULT       VALUE '4'.               CL**2
  5937           88  CP-CONSIDER-EXTENSION        VALUE '3' '4' '5'.       CL**2
  5938           88  CP-30-DAY-MONTH              VALUE '1' '3' '5'.       CL**2
  5939           88  CP-NO-EXT-30-DAY-MONTH       VALUE '1'.               CL**2
  5940           88  CP-NO-EXT-ACTUAL-DAYS        VALUE '2'.               CL**2
  5941           88  CP-EXT-30-DAY-MONTH          VALUE '3'.               CL**2
  5942           88  CP-EXT-ACTUAL-DAYS           VALUE '4'.               CL**2
  5943           88  CP-USE-EXP-AND-1ST-PMT       VALUE '5'.
  5944         16  CP-SIG-SWITCH         PIC X.                            CL**2
  5945         16  CP-RATING-METHOD      PIC X.                            CL**2
  5946           88  CP-RATE-AS-R78                      VALUE '1' 'R'.    CL**2
  5947           88  CP-RATE-AS-PRORATA                  VALUE '2' 'P'.    CL**2
  5948           88  CP-RATE-AS-CALIF                    VALUE '3' 'C'.    CL**2
  5949           88  CP-RATE-AS-TEXAS                    VALUE '4' 'T'.    CL**2
  5950           88  CP-RATE-AS-FARM-PLAN                VALUE '4' 'T'.    CL**2
  5951           88  CP-RATE-AS-NET-PAY                  VALUE '5' 'N'.    CL**2
  5952           88  CP-RATE-AS-ANTICIPATION             VALUE '6' 'A'.    CL**2
  5953           88  CP-RATE-AS-MEAN                     VALUE '8' 'M'.    CL**2
  5954           88  CP-RATE-AS-REG-BALLOON              VALUE 'B'.        CL**2
  5955         16  CP-SALES-TAX          PIC S9V9999     VALUE  ZEROS      CL**2
  5956                                     COMP-3.                         CL**2
  5957         16  CP-BEN-CATEGORY       PIC X.
  5958         16  CP-DCC-LF-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  5959         16  CP-DCC-ACT-COMM REDEFINES CP-DCC-LF-RATE
  5960                                   PIC S99V9(5) COMP-3.
  5961         16  CP-DCC-AH-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  5962         16  CP-DCC-PMF-COMM REDEFINES CP-DCC-AH-RATE
  5963                                   PIC S99V9(5) COMP-3.
  5964         16  CP-DAYS-TO-1ST-PMT    PIC S999     COMP-3 VALUE +0.
  5965         16  CP-AH-BALLOON-SW      PIC X  VALUE ' '.
  5966         16  CP-EXPIRE-DT          PIC XX.
  5967         16  CP-LF-CLAIM-CALC-SW   PIC X  VALUE ' '.
  5968         16  CP-DDF-HI-FACT        PIC S9V999   COMP-3 VALUE +0.
  5969         16  CP-DDF-LO-FACT        PIC S9V999   COMP-3 VALUE +0.
  5970         16  CP-DDF-CLP            PIC S9(5)V99 COMP-3 VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 118
* ECS010Z.cbl (/apps/prod/cid1p/copy/ELCCALC)
  5971         16  CP-DDF-SPEC-CALC      PIC X.
  5972             88  CP-CALC-GROSS-FEE        VALUE 'G'.
  5973             88  CP-CALC-CLP              VALUE 'C'.
  5974         16  CP-IU-RATE-UP         PIC S9(5)V99   COMP-3 VALUE +0.
  5975         16  CP-CANCEL-REASON      PIC X.
  5976         16  CP-DDF-ADMIN-FEES     PIC S9(5)V99 COMP-3 VALUE +0.
  5977         16  CP-PMT-MODE           PIC X.
  5978         16  CP-NO-OF-PMTS         PIC S999 COMP-3 VALUE +0.
  5979         16  CP-1ST-YR-ALLOW       PIC S999V99 COMP-3 VALUE +0.
  5980         16  CP-DDF-COMM-AND-MFEE  PIC S9(5)V99 COMP-3 VALUE +0.
  5981         16  CP-DDF-YR1AF          PIC S9(5)V99 COMP-3 VALUE +0.
  5982         16  FILLER                PIC X.
  5983                                                                     CL**2
  5984***************    OUTPUT FROM ELRESV   ************************     CL**2
  5985                                                                     CL**2
  5986         16  CP-CDT-TABLE          PIC 9             VALUE ZERO.     CL**2
  5987                                                                     CL**2
  5988         16  CP-CDT-FACTOR         PIC S9(5)V9(6)    VALUE ZERO      CL**2
  5989                                     COMP-3.                         CL**2
  5990         16  CP-PTC-RESERVE        PIC S9(7)V99   VALUE ZERO         CL**2
  5991                                     COMP-3.                         CL**2
  5992         16  CP-IBNR-RESERVE       PIC S9(7)V99   VALUE ZERO         CL**2
  5993                                     COMP-3.                         CL**2
  5994         16  CP-FUTURE-RESERVE     PIC S9(7)V99   VALUE ZERO         CL**2
  5995                                     COMP-3.                         CL**2
  5996         16  FILLER                PIC X(09).                        CL**2
  5997***************    OUTPUT FROM ELRTRM   *************************    CL**2
  5998                                                                     CL**2
  5999         16  CP-REMAINING-TERM-1   PIC S9(4)V9    VALUE ZERO         CL**2
  6000                                     COMP-3.                         CL**2
  6001         16  CP-REMAINING-TERM-2   PIC S9(4)V9    VALUE ZERO         CL**2
  6002                                     COMP-3.                         CL**2
  6003         16  CP-REMAINING-TERM-3   PIC S9(4)V9    VALUE ZERO         CL**2
  6004                                     COMP-3.                         CL**2
  6005         16  CP-ODD-DAYS           PIC S9(3)      VALUE ZERO         CL**2
  6006                                     COMP-3.                         CL**2
  6007         16  FILLER                PIC X(12).                        CL**2
  6008                                                                     CL**2
  6009***************    OUTPUT FROM ELRAMT   *************************    CL**2
  6010                                                                     CL**2
  6011         16  CP-REMAINING-AMT      PIC S9(9)V99   VALUE ZERO         CL**2
  6012                                     COMP-3.                         CL**2
  6013         16  CP-REMAINING-AMT-PRV  PIC S9(9)V99   VALUE ZERO         CL**2
  6014                                     COMP-3.                         CL**2
  6015         16  FILLER                PIC X(12).                        CL**2
  6016                                                                     CL**2
  6017***************    OUTPUT FROM ELRATE   *************************    CL**2
  6018                                                                     CL**2
  6019         16  CP-CALC-PREMIUM       PIC S9(7)V99   VALUE ZERO         CL**2
  6020                                     COMP-3.                         CL**2
  6021         16  CP-PREMIUM-RATE       PIC S9(2)V9(5) VALUE ZERO         CL**2
  6022                                     COMP-3.                         CL**2
  6023         16  CP-MORTALITY-CODE     PIC X(4).                         CL**2
  6024         16  CP-RATE-EDIT-FLAG     PIC X.                            CL**2
  6025             88  CP-RATES-NEED-APR                  VALUE '1'.       CL**2
  6026         16  CP-COMPOSITE-RATE     PIC S99V999    VALUE ZERO         CL**2
  6027                                     COMP-3.                         CL**2
  6028         16  CP-POLICY-FEE         PIC S9(3)V99 VALUE +0 COMP-3.     CL**2
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 119
* ECS010Z.cbl (/apps/prod/cid1p/copy/ELCCALC)
  6029         16  CP-LF-PREM            PIC S9(7)V99 VALUE +0 COMP-3.
  6030         16  CP-LF-BALLOON-PREM REDEFINES CP-LF-PREM
  6031                                   PIC S9(7)V99 COMP-3.
  6032         16  FILLER                PIC X(07).                        CL**2
  6033                                                                     CL**2
  6034***************    OUTPUT FROM ELRFND   *************************    CL**2
  6035                                                                     CL**2
  6036         16  CP-CALC-REFUND        PIC S9(7)V99   VALUE ZERO         CL**2
  6037                                     COMP-3.                         CL**2
  6038         16  CP-REFUND-TYPE-USED   PIC X.                            CL**2
  6039           88  CP-R-AS-R78                         VALUE '1'.        CL**2
  6040           88  CP-R-AS-PRORATA                     VALUE '2'.        CL**2
  6041           88  CP-R-AS-CALIF                       VALUE '3'.        CL**2
  6042           88  CP-R-AS-TEXAS                       VALUE '4'.        CL**2
  6043           88  CP-R-AS-FARM-PLAN                   VALUE '4'.        CL**2
  6044           88  CP-R-AS-NET-PAY                     VALUE '5'.        CL**2
  6045           88  CP-R-AS-ANTICIPATION                VALUE '6'.        CL**2
  6046           88  CP-R-AS-MEAN                        VALUE '8'.        CL**2
  6047           88  CP-R-AS-SUM-OF-DIGITS               VALUE '9'.        CL**2
  6048           88  CP-R-AS-GAP-NON-REFUND              VALUE 'G'.
  6049           88  CP-R-AS-GAP-ACTUARIAL               VALUE 'S'.
  6050           88  CP-R-AS-SPP-DDF                     VALUE 'D'.
  6051           88  CP-R-AS-SPP-DDF-IU                  VALUE 'I'.
  6052           88  CP-R-AS-REPOSSESSION                VALUE 'R'.
  6053         16  FILLER                PIC X(12).                        CL**2
  6054                                                                     CL**2
  6055***************    OUTPUT FROM ELEARN   *************************    CL**2
  6056                                                                     CL**2
  6057         16  CP-R78-U-PRM          PIC S9(7)V99   VALUE ZERO         CL**2
  6058                                     COMP-3.                         CL**2
  6059         16  CP-R78-U-PRM-ALT      PIC S9(7)V99   VALUE ZERO         CL**2
  6060                                     COMP-3.                         CL**2
  6061         16  CP-PRORATA-U-PRM      PIC S9(7)V99   VALUE ZERO         CL**2
  6062                                     COMP-3.                         CL**2
  6063         16  CP-PRORATA-U-PRM-ALT  PIC S9(7)V99   VALUE ZERO         CL**2
  6064                                     COMP-3.                         CL**2
  6065         16  CP-STATE-U-PRM        PIC S9(7)V99   VALUE ZERO         CL**2
  6066                                     COMP-3.                         CL**2
  6067         16  CP-DOMICILE-U-PRM     PIC S9(7)V99   VALUE ZERO         CL**2
  6068                                     COMP-3.                         CL**2
  6069         16  CP-EARNING-TYPE-USED  PIC X.                            CL**2
  6070           88  CP-E-AS-SPECIAL                     VALUE 'S'.        CL**2
  6071           88  CP-E-AS-R78                         VALUE '1'.        CL**2
  6072           88  CP-E-AS-PRORATA                     VALUE '2'.        CL**2
  6073           88  CP-E-AS-TEXAS                       VALUE '4'.        CL**2
  6074           88  CP-E-AS-FARM-PLAN                   VALUE '4'.        CL**2
  6075           88  CP-E-AS-NET-PAY                     VALUE '5'.        CL**2
  6076           88  CP-E-AS-ANTICIPATION                VALUE '6'.        CL**2
  6077           88  CP-E-AS-MEAN                        VALUE '8'.        CL**2
  6078           88  CP-E-AS-SUM-OF-DIGITS               VALUE '9'.        CL**2
  6079         16  FILLER                PIC X(12).                        CL**2
  6080                                                                     CL**2
  6081***************    OUTPUT FROM ELPMNT   *************************    CL**2
  6082                                                                     CL**2
  6083         16  CP-ACTUAL-DAYS        PIC S9(05)     VALUE ZERO         CL**2
  6084                                     COMP-3.                         CL**2
  6085         16  CP-CLAIM-PAYMENT      PIC S9(7)V99   VALUE ZERO         CL**2
  6086                                     COMP-3.                         CL**2
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 120
* ECS010Z.cbl (/apps/prod/cid1p/copy/ELCCALC)
  6087         16  FILLER                PIC X(12).                        CL**2
  6088                                                                     CL**2
  6089***************   MISC WORK AREAS    *****************************   CL**2
  6090         16  CP-TOTAL-PAID         PIC S9(7)V99   VALUE ZERO         CL**2
  6091                                     COMP-3.                         CL**2
  6092         16  CP-R-MAX-ATT-AGE      PIC S9(3)      VALUE ZERO         CL**2
  6093                                     COMP-3.                         CL**2
  6094         16  CP-R-MAX-AGE          PIC S9(3)      VALUE ZERO         CL**2
  6095                                     COMP-3.                         CL**2
  6096         16  CP-R-MAX-TERM         PIC S9(5)      VALUE ZERO         CL**2
  6097                                     COMP-3.                         CL**2
  6098         16  CP-R-MAX-TOT-BEN      PIC S9(7)V99   VALUE ZERO         CL**2
  6099                                     COMP-3.                         CL**2
  6100         16  CP-R-MAX-MON-BEN      PIC S9(7)V99   VALUE ZERO         CL**2
  6101                                     COMP-3.                         CL**2
  6102         16  CP-IO-FUNCTION        PIC X          VALUE SPACE.       CL**2
  6103             88  OPEN-RATE-FILE                   VALUE 'O'.         CL**2
  6104             88  CLOSE-RATE-FILE                  VALUE 'C'.         CL**2
  6105             88  IO-ERROR                         VALUE 'E'.         CL**2
  6106                                                                     CL**2
  6107         16  CP-FIRST-PAY-DATE     PIC XX.                           CL**2
  6108                                                                     CL**2
  6109         16  CP-JOINT-INDICATOR    PIC X.                            CL**2
  6110                                                                     CL**2
  6111         16  CP-RESERVE-REMAINING-TERM                               CL**2
  6112                                   PIC S9(4)V9    VALUE ZERO         CL**2
  6113                                     COMP-3.                         CL**2
  6114                                                                     CL**2
  6115         16  CP-INSURED-BIRTH-DT   PIC XX.                           CL**2
  6116                                                                     CL**2
  6117         16  CP-INCURRED-AGE       PIC S9(3)      VALUE ZERO         CL**2
  6118                                     COMP-3.                         CL**2
  6119                                                                     CL**2
  6120         16  CP-MONTHLY-PAYMENT    PIC S9(5)V99   VALUE ZERO         CL**2
  6121                                     COMP-3.                         CL**2
  6122                                                                     CL**2
  6123         16  CP-RATING-BENEFIT-AMT PIC S9(9)V99   VALUE ZERO         CL**2
  6124                                     COMP-3.                         CL**2
  6125                                                                     CL**2
  6126         16  CP-ODD-DAYS-TO-PMT    PIC S9(3)      VALUE ZERO         CL**2
  6127                                     COMP-3.                         CL**2
  6128                                                                     CL**2
  6129         16  CP-MNTHS-TO-FIRST-PMT PIC S9(3)      VALUE ZERO         CL**2
  6130                                     COMP-3.                         CL**2
  6131                                                                     CL**2
  6132         16  CP-REMAMT-FACTOR      PIC S9(4)V9(9) VALUE ZEROS        CL**2
  6133                                     COMP-3.                         CL**2
  6134                                                                     CL**2
  6135         16  CP-FREE-LOOK          PIC S9(3)      VALUE ZERO         CL**2
  6136                                     COMP-3.                         CL**2
  6137                                                                     CL**2
  6138         16  CP-ROA-REFUND         PIC X          VALUE 'N'.         CL**2
  6139             88  CP-ROA-PREM-AT-REFUND            VALUE 'Y'.         CL**2
  6140                                                                     CL**2
  6141         16  CP-NET-BENEFIT-AMT    PIC S9(9)V99   VALUE ZERO         CL**2
  6142                                     COMP-3.                         CL**2
  6143         16  CP-SCNP-6MO-AMT       PIC S9(9)V99   VALUE ZERO
  6144                                     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 121
* ECS010Z.cbl (/apps/prod/cid1p/copy/ELCCALC)
  6145         16  CP-MONTH              PIC S999     COMP-3 VALUE +0.
  6146         16  cp-extra-periods      pic 9 value zeros.
  6147         16  cp-net-only-state     pic x value spaces.
  6148         16  FILLER                PIC X(13).                        CL**2
  6149******************************************************************   CL**2
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 122
* ECS010Z.cbl
* 6151                             COPY ELCDTECX.
  6152******************************************************************06/05/98
  6153*                                                                *ELCDTECX
  6154*                            ELCDTECX.                           *   LV005
  6155*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  6156*                            VMOD=2.015                          *ELCDTECX
  6157*                                                                *ELCDTECX
  6158*      WORKING STORAGE COPY CODE FOR APPLICATIONS CALLING        *ELCDTECX
  6159*      THE DATE CARD DISK FILE. ( READ ROUTINE = ELCDTERX,       *ELCDTECX
  6160*      AND DISK FILE FD = ELCDTEFX)                              *ELCDTECX
  6161*                                                                *ELCDTECX
  6162******************************************************************ELCDTECX
  6163******************************************************************
  6164*                   C H A N G E   L O G
  6165*
  6166* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6167*-----------------------------------------------------------------
  6168*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6169* EFFECTIVE    NUMBER
  6170*-----------------------------------------------------------------
  6171* 092602    2002091900008  PEMA  INCREASE NUMBER OF MAXIMUM
  6172*                                  BENEFIT CODES FROM 300 TO 900
  6173* 090803    2003080800002  PEMA  ADD CATEGORY FOR SUPER GAP
  6174* 051304    2003080800002  SMVA  ADD REFUND METHOD
  6175* 071714    2013100100002  PEMA  FIX CRIT PERIOD EDITS
  6176******************************************************************
  6177 01  DATE-CARD.                                                   ELCDTECX
  6178     12  DATX-COD                    PIC  X(4).                   ELCDTECX
  6179     12  RUN-DATE                    PIC  9(11)  COMP-3.          ELCDTECX
  6180     12  ALPH-DATE                   PIC  X(18).                  ELCDTECX
  6181     12  EP-DT                       PIC  9(11)  COMP-3.          ELCDTECX
  6182     12  PEND-ACT-FILE               PIC  XX.                     ELCDTECX
  6183     12  EP-SW                       PIC  X.                      ELCDTECX
  6184         88  NO-EP-EXTRACTS          VALUE SPACE.                 ELCDTECX
  6185     12  TAPE-BATCHES                PIC  X.                      ELCDTECX
  6186         88  TP-PREL-BAL             VALUE '1'.                   ELCDTECX
  6187     12  BIN-RUN-DATE                PIC  XX.                     ELCDTECX
  6188     12  RUN-CENTURY.                                             ELCDTECX
  6189         16 RUN-CENTURY-N            PIC  99.                        CL**4
  6190     12  FILLER                      PIC  X.                         CL**4
  6191     12  CLAS-MORT-OVRD              PIC  X(4).                   ELCDTECX
  6192     12  FILLER                      PIC  XXX.                    ELCDTECX
  6193     12  COMPANY-NAME                PIC  X(30).                  ELCDTECX
  6194                                                                  ELCDTECX
  6195 01  FILLER                          PIC  X(7)                       CL**6
  6196                                          VALUE 'OPTIONS'.        ELCDTECX
  6197 01  DATE-CARD-OPTIONS.                                           ELCDTECX
  6198     12  DATE-OPTIONS-ID             PIC  X(4).                   ELCDTECX
  6199     12  DTE-MIN-PREM                PIC  99V99.                  ELCDTECX
  6200     12  DTE-LANGUAGE-IND            PIC  X.                      ELCDTECX
  6201         88  DTE-LANGUAGE-IS-FR           VALUE 'F'.              ELCDTECX
  6202         88  DTE-LANGUAGE-IS-ENG          VALUE 'E'.              ELCDTECX
  6203     12  DTE-MIN-AGE                 PIC  99.                     ELCDTECX
  6204     12  DTE-DEFAULT-AGE             PIC  99.                     ELCDTECX
  6205     12  FILLER                      PIC  X.                      ELCDTECX
  6206     12  DTE-MAX-TERM                PIC  999.                    ELCDTECX
  6207     12  DTE-COMP-VG                 PIC  X.                      ELCDTECX
  6208     12  DTE-REM-TRM                 PIC  X.                      ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 123
* ECS010Z.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  6209     12  DTE-PRM-CK                  PIC S99V99.                  ELCDTECX
  6210     12  DTE-PRORATA                 PIC  X.                      ELCDTECX
  6211     12  DTE-CLM-REJ                 PIC  X.                      ELCDTECX
  6212     12  DTE-REF-REJ                 PIC  X.                      ELCDTECX
  6213     12  DTE-COM-TBL-USED            PIC  X.                      ELCDTECX
  6214     12  FILLER                      PIC  X.                      ELCDTECX
  6215     12  DTE-QTR-CO                  PIC  X.                      ELCDTECX
  6216     12  DTE-REF-CK                  PIC S99V99.                  ELCDTECX
  6217     12  DTE-CLM-CK                  PIC S99V99.                  ELCDTECX
  6218     12  DTE-CONV-DT                 PIC 9(11) COMP-3.               CL**2
  6219     12  DTE-DEFAULT-SEX             PIC  X.                      ELCDTECX
  6220     12  DTE-EPL-FORMAT              PIC  X.                      ELCDTECX
  6221     12  FILLER                      PIC  X.                      ELCDTECX
  6222     12  DTE-JT-AGE                  PIC  X.                      ELCDTECX
  6223     12  DTE-KEY-BIRTH               PIC  X.                      ELCDTECX
  6224     12  DTE-REINSURANCE             PIC  X.                      ELCDTECX
  6225     12  DTE-CLAIM-SORT              PIC  X.                      ELCDTECX
  6226     12  DTE-WRT-OFF                 PIC  S99V99.                 ELCDTECX
  6227     12  DTE-R78                     PIC  X.                      ELCDTECX
  6228     12  DTE-DLY-BILL                PIC  X.                      ELCDTECX
  6229     12  DTE-ALT-MORT-CODE           PIC  X(4).                   ELCDTECX
  6230     12  DTE-CLAIM-PAID-THRU-TO      PIC  X.                      ELCDTECX
  6231     12  DTE-COMPENSATION-ACCESS     PIC  X.                      ELCDTECX
  6232     12  DTE-MORTG-ACCESS-CNTL       PIC  X.                      ELCDTECX
  6233     12  DTE-MP-ALT-MORT-CODE        PIC  X(4).                   ELCDTECX
  6234     12  DTE-MORTALITY-AGE-CALC-METHOD                            ELCDTECX
  6235                                     PIC  X.                      ELCDTECX
  6236         88  DTE-USE-TABLE-ASSIGNED-METHOD VALUE '1'              ELCDTECX
  6237                                                 ' '.             ELCDTECX
  6238         88  DTE-USE-ALL-AGE-LAST          VALUE '2'.             ELCDTECX
  6239         88  DTE-USE-ALL-AGE-NEAR          VALUE '3'.             ELCDTECX
  6240     12  DTE-RESERVE-OPTION-SWITCH   PIC  X.                      ELCDTECX
  6241         88  DTE-OPT-RESERVE-METHOD-AUTH       VALUE 'Y'.         ELCDTECX
  6242         88  DTE-OPT-RESERVE-METHOD-UNAUTH     VALUE 'N' ' '.     ELCDTECX
  6243     12  DTE-REM-TRM-CALC-OPTION     PIC  X.                      ELCDTECX
  6244     12  DTE-EXPERIENCE-RETENTION-AGE                             ELCDTECX
  6245                                     PIC  9.                         CL**4
  6246     12  DTE-SYSTEM.                                              ELCDTECX
  6247         16  DTE-SYS-A-CREDIT        PIC  X.                      ELCDTECX
  6248         16  DTE-SYS-B-PEND-CLAIM    PIC  X.                      ELCDTECX
  6249         16  DTE-SYS-C-CONFIRMATIONS PIC  X.                      ELCDTECX
  6250         16  DTE-SYS-D-DEMAND-BILL   PIC  X.                      ELCDTECX
  6251         16  DTE-SYS-E-CLASIC-CLAIMS PIC  X.                      ELCDTECX
  6252         16  DTE-SYS-F-CLASIC-CREDIT PIC  X.                      ELCDTECX
  6253         16  DTE-SYS-G-AR-USED       PIC  X.                      ELCDTECX
  6254         16  DTE-SYS-H               PIC  X.                      ELCDTECX
  6255         16  DTE-SYS-I               PIC  X.                      ELCDTECX
  6256         16  DTE-SYS-J               PIC  X.                      ELCDTECX
  6257         16  DTE-SYS-K               PIC  X.                      ELCDTECX
  6258         16  DTE-SYS-L               PIC  X.                      ELCDTECX
  6259         16  DTE-SYS-M               PIC  X.                      ELCDTECX
  6260         16  DTE-SYS-N               PIC  X.                      ELCDTECX
  6261         16  DTE-SYS-O               PIC  X.                      ELCDTECX
  6262         16  DTE-SYS-P               PIC  X.                      ELCDTECX
  6263         16  DTE-SYS-Q               PIC  X.                      ELCDTECX
  6264         16  DTE-SYS-R               PIC  X.                      ELCDTECX
  6265         16  DTE-SYS-S               PIC  X.                      ELCDTECX
  6266         16  DTE-SYS-T               PIC  X.                      ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 124
* ECS010Z.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  6267         16  DTE-SYS-U               PIC  X.                      ELCDTECX
  6268         16  DTE-SYS-V               PIC  X.                      ELCDTECX
  6269         16  DTE-SYS-W               PIC  X.                      ELCDTECX
  6270         16  DTE-SYS-X               PIC  X.                      ELCDTECX
  6271         16  DTE-SYS-Y               PIC  X.                      ELCDTECX
  6272         16  DTE-SYS-Z               PIC  X.                      ELCDTECX
  6273     12  FILLER                      REDEFINES DTE-SYSTEM.        ELCDTECX
  6274         16  DTE-SYS-CODE            OCCURS 26 TIMES              ELCDTECX
  6275                                     PIC  X.                      ELCDTECX
  6276     12  DTE-CLIENT                  PIC  XXX.                    ELCDTECX
  6277                                                                  ELCDTECX
  6278 01  CLASIC-SYSTEM-CODES.                                         ELCDTECX
  6279     12  DTE-COLC-ID                 PIC  X(4).                   ELCDTECX
  6280     12  DTE-CLASIC-COMPANY-CD       PIC  X.                      ELCDTECX
  6281     12  DTE-CLASIC-COMPANY-NUMBER   PIC  999.                    ELCDTECX
  6282*    12  DTE-CLASIC-CLAIM-ACCESS     PIC  X.                      ELCDTECX
  6283     12  FILLER                      PIC  X.                      ELCDTECX
  6284     12  CLASIC-REIN-MAINT           PIC  XX.                     ELCDTECX
  6285     12  CLASIC-COMP-MAINT           PIC  XX.                     ELCDTECX
  6286     12  CLASIC-ACCT-MAINT           PIC  XX.                     ELCDTECX
  6287     12  CLASIC-CTBL-MAINT           PIC  XX.                     ELCDTECX
  6288     12  CLASIC-RATE-MAINT           PIC  XX.                     ELCDTECX
  6289     12  CLASIC-CREDIT-EOM-DT        PIC  XX.                     ELCDTECX
  6290     12  CLASIC-CLAIMS-EOM-DT        PIC  XX.                     ELCDTECX
  6291                                                                  ELCDTECX
  6292     12  LIFE-OVERRIDE-L1            PIC  X.                      ELCDTECX
  6293     12  LIFE-OVERRIDE-L2            PIC  XX.                     ELCDTECX
  6294     12  LIFE-OVERRIDE-L6            PIC  X(6).                   ELCDTECX
  6295     12  LIFE-OVERRIDE-L12           PIC  X(12).                  ELCDTECX
  6296                                                                  ELCDTECX
  6297     12  AH-OVERRIDE-L1              PIC  X.                      ELCDTECX
  6298     12  AH-OVERRIDE-L2              PIC  XX.                     ELCDTECX
  6299     12  AH-OVERRIDE-L6              PIC  X(6).                   ELCDTECX
  6300     12  AH-OVERRIDE-L12             PIC  X(12).                  ELCDTECX
  6301                                                                  ELCDTECX
  6302     12  CLAS-REPORT-CD1-CAPTION     PIC  X(10).                  ELCDTECX
  6303     12  CLAS-REPORT-CD2-CAPTION     PIC  X(10).                  ELCDTECX
  6304                                                                  ELCDTECX
  6305     12  CLASIC-MORTG-EOM-DT         PIC  XX.                     ELCDTECX
  6306     12  CLASIC-AR-EOM-DT            PIC  XX.                     ELCDTECX
  6307                                                                  ELCDTECX
  6308     12  FILLER                      PIC  X(11)      VALUE SPACE. ELCDTECX
  6309                                                                  ELCDTECX
  6310 01  DATE-CARD-FACTORS.                                           ELCDTECX
  6311     12  DATE-FACTOR-ID              PIC  X(4).                   ELCDTECX
  6312     12  FAC-1                       PIC S999V9(5).               ELCDTECX
  6313     12  FAC-2                       PIC S999V9(5).               ELCDTECX
  6314     12  FAC-3                       PIC S999V9(5).               ELCDTECX
  6315     12  FAC-4                       PIC S999V9(5).               ELCDTECX
  6316     12  FAC-5                       PIC S999V9(5).               ELCDTECX
  6317     12  FAC-6                       PIC S999V9(5).               ELCDTECX
  6318                                                                  ELCDTECX
  6319 01  FILLER                          PIC  X(12)                   ELCDTECX
  6320                                          VALUE 'COMPANY NAME'.   ELCDTECX
  6321 01  COMPANY-NAME-TABLE.                                          ELCDTECX
  6322     12  C-N-TBL                     OCCURS 6 TIMES.              ELCDTECX
  6323         16  CNT-ID                  PIC  X.                      ELCDTECX
  6324         16  CNT-NAME                PIC  X(30).                  ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 125
* ECS010Z.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  6325                                                                  ELCDTECX
  6326 01  FILLER                          PIC  X(11)                   ELCDTECX
  6327                                          VALUE 'STATE NAMES'.    ELCDTECX
  6328 01  STATE-NAMES.                                                 ELCDTECX
  6329     12  STATE-NAME-FLD              OCCURS 75 TIMES.             ELCDTECX
  6330         16  STATE-SUB               PIC  XX.                     ELCDTECX
  6331         16  STATE-PIC1.                                          ELCDTECX
  6332             20  STATE-ABBR          PIC  XX.                     ELCDTECX
  6333             20  FILLER              PIC  XXX.                    ELCDTECX
  6334             20  STATE-PIC           PIC  X(20).                  ELCDTECX
  6335             20  STATE-CALL-EARN     PIC  X.                      ELCDTECX
  6336             20  STATE-CALL-BREAK    PIC  X.                      ELCDTECX
  6337             20  STATE-PRIM-FAC-DEV  PIC  XXX.                    ELCDTECX
  6338                                                                  ELCDTECX
  6339 01  FILLER                          PIC  X(13)                   ELCDTECX
  6340                                          VALUE 'CARRIER NAMES'.  ELCDTECX
  6341 01  CARRIER-NAMES.                                               ELCDTECX
  6342     12  CARRIER-NAME-FLD            OCCURS 25 TIMES.             ELCDTECX
  6343         16  CARRIER-SUB             PIC  X.                      ELCDTECX
  6344         16  CARRIER-DOM-ST          PIC  XX.                     ELCDTECX
  6345         16  CARRIER-PIC             PIC  X(30).                  ELCDTECX
  6346         16  CARRIER-UEP-PCT         PIC  S9V9(4) COMP-3.            CL**6
  6347         16  CARRIER-R78-PCT         PIC  S9V9(4) COMP-3.            CL**6
  6348         16  CARRIER-PRO-PCT         PIC  S9V9(4) COMP-3.            CL**6
  6349*        16  FILLER                  PIC  X.                      ELCDTECX
  6350         16  CARRIER-SEC-PAY         PIC  X.
  6351             88  SEC-PAY-CARRIER          VALUE 'Y'.
  6352                                                                  ELCDTECX
  6353 01  FILLER                          PIC  X(9)                       CL**6
  6354                                          VALUE 'INS TYPES'.      ELCDTECX
  6355 01  CLAS-INS-TYPES.                                              ELCDTECX
  6356*    12 CLAS-ALL-TYPES               OCCURS 300 TIMES.            ELCDTECX
  6357     12 CLAS-ALL-TYPES               OCCURS 900 TIMES.            ELCDTECX
  6358         16  CLAS-I-BEN              PIC  XX.                     ELCDTECX
  6359         16  CLAS-I-AB3.                                          ELCDTECX
  6360             20  FILLER              PIC  X.                      ELCDTECX
  6361             20  CLAS-I-AB2.                                      ELCDTECX
  6362                 24  FILLER          PIC  X.                      ELCDTECX
  6363                 24  CLAS-I-AB1      PIC  X.                      ELCDTECX
  6364         16  CLAS-I-AB3-AH REDEFINES CLAS-I-AB3.                  ELCDTECX
  6365             20  CLAS-EXCLUSION      PIC  XX.                        CL**4
  6366             20  FILLER              PIC  X.                         CL**4
  6367         16  CLAS-I-AB10.                                         ELCDTECX
  6368             20  FILLER              PIC  X(9).                   ELCDTECX
  6369             20  CLAS-I-REIN-YN      PIC  X.                      ELCDTECX
  6370         16  CLAS-I-COMMENT          PIC  X(10).                  ELCDTECX
  6371         16  CLAS-I-JOINT            PIC  X.                      ELCDTECX
  6372         16  CLAS-I-RL-AH            PIC  X.                      ELCDTECX
  6373         16  CLAS-I-CALC-TYPE.                                    ELCDTECX
  6374             20  CLAS-I-BAL          PIC  X.                      ELCDTECX
  6375         16  CLAS-I-EP               PIC  X.                      ELCDTECX
  6376         16  CLAS-CO-BEN-I-G-CD      PIC  X.                      ELCDTECX
  6377         16  CLAS-CO-REM-TERM-CALC   PIC  X.                      ELCDTECX
  6378         16  CLAS-I-BEN-CATEGORY     PIC  X.
  6379         16  CLAS-I-REFUND-METHOD    PIC  X.
  6380         16  CLAS-I-MAX-BENEFITS     PIC 99.
  6381         16  FILLER                  PIC  XXX.
  6382                                                                  ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 126
* ECS010Z.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  6383 01  FILLER                          PIC  X(16)                   ELCDTECX
  6384                                     VALUE 'MORTALITY TABLES'.    ELCDTECX
  6385 01  CLAS-MORTALITY-CODES.                                        ELCDTECX
  6386     12  CLAS-MORT-FLD               OCCURS 99 TIMES              ELCDTECX
  6387                                     INDEXED BY CLAS-MORT-NDX.    ELCDTECX
  6388         16  CLAS-MORT-CODE          PIC  X(4).                      CL**6
  6389         16  CLAS-MORT-J-CODE        PIC  X.                         CL**5
  6390         16  CLAS-MORT-J-FACT        PIC S9V9(4).                    CL**6
  6391         16  CLAS-MORT-DESC.                                      ELCDTECX
  6392             20  CLAS-RESERVE-ADJ    PIC  999.                       CL**6
  6393             20  FILLER              PIC  XX.                        CL**5
  6394             20  CLAS-YEAR           PIC  X(4).                      CL**6
  6395             20  FILLER              PIC  X.                         CL**5
  6396             20  CLAS-TABLE-TYPE     PIC  XXX.                       CL**6
  6397             20  FILLER              PIC  X.                         CL**5
  6398             20  CLAS-AGE-METHOD     PIC  XX.                        CL**5
  6399             20  FILLER              PIC  X.                         CL**5
  6400             20  CLAS-INTEREST       PIC  99.99.                     CL**5
  6401             20  FILLER              PIC  X(5).                      CL**6
  6402                                                                  ELCDTECX
  6403 01  FILLER                          PIC  X(15)                   ELCDTECX
  6404                                     VALUE 'BUSINESS TABLES'.     ELCDTECX
  6405 01  CLAS-BUSINESS-CLASSES.                                       ELCDTECX
  6406     12  CLAS-BUSC-FLD               OCCURS 50 TIMES.             ELCDTECX
  6407         16  CLAS-BUSC-CODE          PIC  99.                     ELCDTECX
  6408         16  CLAS-BUSC-GROUP         PIC  X.                      ELCDTECX
  6409         16  CLAS-BUSC-DESC          PIC  X(19).                  ELCDTECX
  6410         16  CLAS-BUSC-EXCL          PIC  X.                         CL**5
  6411         16  FILLER                  PIC  X(4).                      CL**6
  6412                                                                  ELCDTECX
  6413 01  FILLER                          PIC  X(7)                       CL**6
  6414                                     VALUE 'INDEXES'.             ELCDTECX
  6415 01  CLAS-INDEX-TBL.                                              ELCDTECX
  6416     12  CLAX-ID                     PIC  X(4).                   ELCDTECX
  6417     12  CLAS-STARTC                 PIC S9(4) COMP.              ELCDTECX
  6418     12  CLAS-MAXC                   PIC S9(4) COMP.              ELCDTECX
  6419     12  CLAS-STARTL                 PIC S9(4) COMP.              ELCDTECX
  6420     12  CLAS-MAXL                   PIC S9(4) COMP.              ELCDTECX
  6421     12  CLAS-STARTA                 PIC S9(4) COMP.              ELCDTECX
  6422     12  CLAS-MAXA                   PIC S9(4) COMP.              ELCDTECX
  6423     12  CLAS-STARTM                 PIC S9(4) COMP.              ELCDTECX
  6424     12  CLAS-MAXM                   PIC S9(4) COMP.              ELCDTECX
  6425     12  CLAS-STARTB                 PIC S9(4) COMP.              ELCDTECX
  6426     12  CLAS-MAXB                   PIC S9(4) COMP.              ELCDTECX
  6427     12  CLAS-STARTS                 PIC S9(4) COMP.              ELCDTECX
  6428     12  CLAS-MAXS                   PIC S9(4) COMP.              ELCDTECX
  6429     12  CLAS-STARTE                 PIC S9(4) COMP.              ELCDTECX
  6430     12  CLAS-MAXE                   PIC S9(4) COMP.              ELCDTECX
  6431     12  CLAS-STARTCN                PIC S9(4) COMP.              ELCDTECX
  6432     12  CLAS-MAXCN                  PIC S9(4) COMP.              ELCDTECX
  6433                                                                  ELCDTECX
  6434 01  CLAS-TYPE-MISC.                                              ELCDTECX
  6435     12  CLAS-INDEXC                 PIC S9(4) COMP.              ELCDTECX
  6436     12  CLAS-INDEXL                 PIC S9(4) COMP.              ELCDTECX
  6437     12  CLAS-INDEXA                 PIC S9(4) COMP.              ELCDTECX
  6438     12  CLAS-INDEXM                 PIC S9(4) COMP.              ELCDTECX
  6439     12  CLAS-INDEXB                 PIC S9(4) COMP.              ELCDTECX
  6440     12  CLAS-INDEXS                 PIC S9(4) COMP.              ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 127
* ECS010Z.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  6441     12  CLAS-INDEXE                 PIC S9(4) COMP.              ELCDTECX
  6442     12  CLAS-INDEX                  PIC S9(4) COMP.              ELCDTECX
  6443     12  CLAS-INDEXEN                PIC S9(4) COMP.              ELCDTECX
  6444     12  CLAS-INDEXCN                PIC S9(4) COMP.              ELCDTECX
  6445     12  CLAS-INDEXON                PIC S9(4) COMP.              ELCDTECX
  6446                                                                  ELCDTECX
  6447 01  FILLER                          PIC  X(13)                   ELCDTECX
  6448                                     VALUE 'MISCELLANEOUS'.       ELCDTECX
  6449 01  CLAS-MISC.                                                   ELCDTECX
  6450     12  DTE-FICH                    PIC  X.                      ELCDTECX
  6451         88  FICH-NO                 VALUE SPACE.                 ELCDTECX
  6452         88  FICH-ONLY               VALUE '1'.                   ELCDTECX
  6453         88  FICH-BOTH               VALUE '2'.                   ELCDTECX
  6454     12  FICH-OPEN                   PIC  X.                      ELCDTECX
  6455     12  REPT-OPEN                   PIC  X.                      ELCDTECX
  6456     12  DTE-PGM-OPT                 PIC  9.                         CL**5
  6457     12  DTE-PRT-OPT                 PIC  X.                      ELCDTECX
  6458     12  DTE-FMT-OPT                 PIC  9.                      ELCDTECX
  6459     12  DTE-PRC-OPT                 PIC  9.                      ELCDTECX
  6460     12  DTE-TOT-OPT                 PIC  9.                      ELCDTECX
  6461     12  CLAS-LOOK                   PIC  XX.                     ELCDTECX
  6462     12  DTE-TOT-LINES               PIC S9(8)      COMP.         ELCDTECX
  6463     12  STATE-L                     PIC  XX.                     ELCDTECX
  6464     12  CLAS-CN                     PIC  99.                     ELCDTECX
  6465     12  CLAS-CO                     PIC  99.                     ELCDTECX
  6466     12  DTE-VSAM-FLAGS                              VALUE ZERO.  ELCDTECX
  6467         16  DTE-F-1                 PIC  X.                      ELCDTECX
  6468         16  DTE-F-2                 PIC  X.                      ELCDTECX
  6469     12  DTE-ABEND-WORK.                                          ELCDTECX
  6470         16  DTE-ABEND-CD-1          PIC  XX         VALUE SPACES.ELCDTECX
  6471         16  DTE-ABEND-CD-2          PIC  XX         VALUE SPACES.ELCDTECX
  6472                                                                  ELCDTECX
  6473 01  FILLER                          PIC  X(12)                   ELCDTECX
  6474                                     VALUE 'WORKING DATE'.        ELCDTECX
  6475 01  WS-DATE-AND-TIME.                                            ELCDTECX
  6476     12  WS-ACCEPT-DATE.                                          ELCDTECX
  6477         16  WS-AD-YY                PIC  99.                     ELCDTECX
  6478         16  WS-AD-MM                PIC  99.                     ELCDTECX
  6479         16  WS-AD-DD                PIC  99.                     ELCDTECX
  6480     12  WS-CURRENT-DATE.                                         ELCDTECX
  6481         16  WS-CD-MM                PIC  99.                     ELCDTECX
  6482         16  FILLER                  PIC  X          VALUE '/'.   ELCDTECX
  6483         16  WS-CD-DD                PIC  99.                     ELCDTECX
  6484         16  FILLER                  PIC  X          VALUE '/'.   ELCDTECX
  6485         16  WS-CD-YY                PIC  99.                     ELCDTECX
  6486     12  WS-TIME-OF-DAY.                                          ELCDTECX
  6487         16  WS-TIME                 PIC  9(6).                   ELCDTECX
  6488         16  WS-HUN-SEC              PIC  99.                     ELCDTECX
  6489                                                                  ELCDTECX
  6490 01  FILLER                          PIC  X(12)                   ELCDTECX
  6491                                     VALUE 'CARRIER CLMS'.        ELCDTECX
  6492 01  CARRIER-OPT-CLAIM-DATA.                                      ELCDTECX
  6493     12  CARRIER-FLDS                OCCURS 25 TIMES.             ELCDTECX
  6494         16  CARRIER-IBNR-SWITCH     PIC  X.                         CL**5
  6495         16  CARRIER-IBNR-PERCENT    PIC S9V9(4) COMP-3.             CL**6
  6496         16  CARRIER-CIDA-DISCOUNT   PIC S9V9(4) COMP-3.             CL**6
  6497                                                                  ELCDTECX
  6498 01  FILLER                          PIC  X(10)                   ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 128
* ECS010Z.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  6499                                     VALUE 'STATE TLRS'.          ELCDTECX
  6500 01  STATE-TARGET-LOSS-RATIOS.                                    ELCDTECX
  6501     12  STATE-TLR-FLD               OCCURS 75 TIMES.             ELCDTECX
  6502         16  STATE-TARGET-LOSS-RATIO PIC S9V9(4) COMP-3.             CL**6
  6503         16  STATE-CALC-INTEREST     PIC S9V9(4) COMP-3.             CL**6
  6504                                                                  ELCDTECX
  6505 01  FILLER                          PIC  X(13)                   ELCDTECX
  6506                                     VALUE 'BUSINESS TLRS'.       ELCDTECX
  6507 01  BUSINESS-TRGT-LOSS-RATIO-MODS.                               ELCDTECX
  6508     12  BUS-TLRM-FLD                OCCURS 99 TIMES.             ELCDTECX
  6509         16  BUS-TRGT-LOSS-RATIO-MOD PIC S9V9(4) COMP-3.             CL**6
  6510                                                                  ELCDTECX
  6511 01  FILLER                          PIC  X(13)                   ELCDTECX
  6512                                     VALUE 'MISC CLM DATA'.       ELCDTECX
  6513 01  MISC-OPT-CLM-RSV-DATA.                                       ELCDTECX
  6514     12  COMPANY-CALC-INTEREST       PIC S9V9(4) COMP-3.             CL**6
  6515     12  COMPANY-CIDA-DISCOUNT       PIC S9V9(4) COMP-3.             CL**6
  6516     12  COMPANY-CRDB-TABLE-SELECTION                             ELCDTECX
  6517                                     PIC  X.                         CL**5
  6518     12  COMPANY-IBNR-AH-FACTOR      PIC S9V9(4) COMP-3.             CL**6
  6519     12  COMPANY-IBNR-LAG-MONTH      PIC S999    COMP-3.             CL**6
  6520     12  COMPANY-IBNR-LIFE-FACTOR    PIC S9V9(4) COMP-3.             CL**6
  6521     12  COMPANY-OPTION-START-DATE   PIC  XX.                        CL**5
  6522     12  INDEXBS                     PIC S9(4)   COMP.               CL**6
  6523     12  INDEXCA                     PIC S9(4)   COMP.               CL**6
  6524     12  INDEXST                     PIC S9(4)   COMP.               CL**6
  6525     12  FILLER                      PIC  X(75).                  ELCDTECX
  6526******************************************************************ELCDTECX
  6527*01  MISC-CARR-PCT-DATA.                                          00001521
  6528*    12  DD-CARR1-UEP-PCT            PIC S9V9(4) COMP-3.          00001522
  6529*    12  DD-CARR1-R78-PCT            PIC S9V9(4) COMP-3.          00001522
  6530*    12  DD-CARR1-PRO-PCT            PIC S9V9(4) COMP-3.          00001522
  6531*    12  DD-CARR2-UEP-PCT            PIC S9V9(4) COMP-3.          00001522
  6532*    12  DD-CARR2-R78-PCT            PIC S9V9(4) COMP-3.          00001522
  6533*    12  DD-CARR2-PRO-PCT            PIC S9V9(4) COMP-3.          00001522
  6534******************************************************************ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 129
* ECS010Z.cbl
* 6536                             COPY ELCDTEVR.
  6537***************************************************************** 04/15/98
  6538*                                                                *ELCDTEVR
  6539*                                                                *ELCDTEVR
  6540*                            ELCDTEVR.                           *   LV003
  6541*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
  6542*                            VMOD=2.001                          *   CL**2
  6543*                                                                *ELCDTEVR
  6544*   WORKING STORAGE FOR DATE VARIABLES CREATED                   *ELCDTEVR
  6545*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCDTEVR
  6546*                                                                *ELCDTEVR
  6547******************************************************************ELCDTEVR
  6548 01  WS-DATE-CARD-DATE.                                           ELCDTEVR
  6549     05  WS-RUN-DATE.                                             ELCDTEVR
  6550         10  FILLER                  PIC  9(03).                  ELCDTEVR
  6551         10  RUN-CCYY                PIC  9(04).                  ELCDTEVR
  6552         10  RUN-CCYR  REDEFINES  RUN-CCYY.                       ELCDTEVR
  6553             15  RUN-CC              PIC  99.                     ELCDTEVR
  6554             15  RUN-YR              PIC  99.                     ELCDTEVR
  6555         10  RUN-MO                  PIC  99.                     ELCDTEVR
  6556         10  RUN-DA                  PIC  99.                     ELCDTEVR
  6557     05  WS-RUN-DATE-N REDEFINES                                     CL**2
  6558            WS-RUN-DATE              PIC 9(11).                      CL**2
  6559     05  WS-EP-DT.                                                ELCDTEVR
  6560         10  FILLER                  PIC  9(03).                  ELCDTEVR
  6561         10  EP-CCYY                 PIC  9(04).                  ELCDTEVR
  6562         10  EP-CCYR  REDEFINES  EP-CCYY.                         ELCDTEVR
  6563             15  EP-CC               PIC  99.                     ELCDTEVR
  6564             15  EP-YR               PIC  99.                     ELCDTEVR
  6565         10  EP-MO                   PIC  99.                     ELCDTEVR
  6566         10  EP-DA                   PIC  99.                     ELCDTEVR
  6567     05  WS-EP-DT-N REDEFINES                                        CL**2
  6568            WS-EP-DT                 PIC 9(11).                      CL**2
  6569     05  WS-DTE-CONV-DT.                                             CL**4
  6570         10  FILLER                  PIC  9(03).                     CL**4
  6571         10  DTE-CONV-CCYY           PIC  9(04).                     CL**4
  6572         10  DTE-CONV-CCYR  REDEFINES  DTE-CONV-CCYY.                CL**4
  6573             15  DTE-CONV-CC         PIC  99.                        CL**4
  6574             15  DTE-CONV-YR         PIC  99.                        CL**4
  6575         10  DTE-CONV-MO             PIC  99.                        CL**4
  6576         10  DTE-CONV-DA             PIC  99.                        CL**4
  6577     05  WS-DTE-CONV-DT-N REDEFINES                                  CL**4
  6578            WS-DTE-CONV-DT           PIC  9(11).                     CL**4
  6579 01  WS-BALANCE-FORWARD-DATE.                                     ELCDTEVR
  6580     05  WS-BF-LAST-ACTIVITY-DATE.                                ELCDTEVR
  6581         10  FILLER                            PIC 999.           ELCDTEVR
  6582         10  BF-ACT-CCYY                       PIC 9(04).         ELCDTEVR
  6583         10  BF-ACT-CCYR  REDEFINES  BF-ACT-CCYY.                 ELCDTEVR
  6584             15  BF-ACT-CC                     PIC 99.            ELCDTEVR
  6585             15  BF-ACT-YEAR                   PIC 99.            ELCDTEVR
  6586         10  BF-ACT-MONTH                      PIC 99.            ELCDTEVR
  6587         10  BF-ACT-DAY                        PIC 99.            ELCDTEVR
  6588     05  WS-BF-LAST-ACTIVITY-DATE-N REDEFINES                        CL**2
  6589            WS-BF-LAST-ACTIVITY-DATE           PIC 9(11).            CL**2
  6590     05  WS-BF-CURRENT-LAST-STMT-DT.                              ELCDTEVR
  6591         10  FILLER                            PIC 999.           ELCDTEVR
  6592         10  BF-CURRENT-LAST-STMT-CEN          PIC 99.            ELCDTEVR
  6593         10  BF-CURRENT-LAST-STMT-YEAR         PIC 99.            ELCDTEVR
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 130
* ECS010Z.cbl (/apps/prod/cid1p/copy/ELCDTEVR)
  6594         10  BF-CURRENT-LAST-STMT-MONTH        PIC 99.            ELCDTEVR
  6595         10  BF-CURRENT-LAST-STMT-DAY          PIC 99.            ELCDTEVR
  6596     05  WS-BF-CURRENT-LAST-STMT-DT-N REDEFINES                      CL**2
  6597            WS-BF-CURRENT-LAST-STMT-DT        PIC 9(11).             CL**2
  6598 01  WS-ADD-CONF-TRANSACTIONS-DTE.                                ELCDTEVR
  6599     05  WS-AC-CERT-EFF-DATE.                                     ELCDTEVR
  6600         10  FILLER                            PIC 999.           ELCDTEVR
  6601         10  AC-CERT-CCYY                      PIC 9(04).         ELCDTEVR
  6602         10  AC-CERT-CCYR  REDEFINES  AC-CERT-CCYY.               ELCDTEVR
  6603             15  AC-CERT-CC                    PIC 99.            ELCDTEVR
  6604             15  AC-CERT-YR                    PIC 99.            ELCDTEVR
  6605         10  AC-CERT-MO                        PIC 99.            ELCDTEVR
  6606         10  AC-CERT-DA                        PIC 99.            ELCDTEVR
  6607     05  WS-AC-CERT-EFF-DATE-N REDEFINES                             CL**2
  6608            WS-AC-CERT-EFF-DATE                PIC 9(11).            CL**2
  6609     05  WS-AC-LIFE-CANCEL-DATE.                                  ELCDTEVR
  6610         10  FILLER                            PIC 999.           ELCDTEVR
  6611         10  AC-LIFE-CANCEL-CCYY               PIC 9(04).         ELCDTEVR
  6612         10  AC-LIFE-CANCEL-CCYR REDEFINES AC-LIFE-CANCEL-CCYY.   ELCDTEVR
  6613             15  AC-LIFE-CANCEL-CC             PIC 99.            ELCDTEVR
  6614             15  AC-LIFE-CANCEL-YR             PIC 99.            ELCDTEVR
  6615         10  AC-LIFE-CANCEL-MO                 PIC 99.            ELCDTEVR
  6616         10  AC-LIFE-CANCEL-DA                 PIC 99.            ELCDTEVR
  6617     05  WS-AC-LIFE-CANCEL-DATE-N REDEFINES                          CL**2
  6618            WS-AC-LIFE-CANCEL-DATE             PIC 9(11).            CL**2
  6619     05  WS-AC-AH-CANCEL-DATE.                                    ELCDTEVR
  6620         10  FILLER                            PIC 999.           ELCDTEVR
  6621         10  AC-AH-CANCEL-CCYY                 PIC 9(04).         ELCDTEVR
  6622         10  AC-AH-CANCEL-CCYR  REDEFINES  AC-AH-CANCEL-CCYY.     ELCDTEVR
  6623             15  AC-AH-CANCEL-CC               PIC 99.            ELCDTEVR
  6624             15  AC-AH-CANCEL-YR               PIC 99.            ELCDTEVR
  6625         10  AC-AH-CANCEL-MO                   PIC 99.            ELCDTEVR
  6626         10  AC-AH-CANCEL-DA                   PIC 99.            ELCDTEVR
  6627     05  WS-AC-AH-CANCEL-DATE-N REDEFINES                            CL**2
  6628            WS-AC-AH-CANCEL-DATE               PIC 9(11).            CL**2
  6629 01  WS-RATE-RECORD.                                              ELCDTEVR
  6630         05  WS-RT-EXPIRY-DATE.                                   ELCDTEVR
  6631             10  FILLER                        PIC 999.           ELCDTEVR
  6632             10  RT-EXP-CCYY                   PIC 9(04).         ELCDTEVR
  6633             10  RT-EXP-CCYR  REDEFINES  RT-EXP-CCYY.             ELCDTEVR
  6634                 15  RT-EXP-CC                 PIC 99.            ELCDTEVR
  6635                 15  RT-EXP-YR                 PIC 99.            ELCDTEVR
  6636             10  RT-EXP-MO                     PIC 99.            ELCDTEVR
  6637             10  RT-EXP-DA                     PIC 99.            ELCDTEVR
  6638         05  WS-RT-EXPIRY-DATE-N REDEFINES                           CL**2
  6639                WS-RT-EXPIRY-DATE              PIC 9(11).            CL**2
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 131
* ECS010Z.cbl
* 6641                             COPY ELCACCTV.
  6642******************************************************************04/14/98
  6643*                                                                *ELCACCTV
  6644*                            ELCACCTV                            *   LV002
  6645*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  6646*                            VMOD=2.001                          *ELCACCTV
  6647*                                                                *ELCACCTV
  6648*   WORKING STORAGE FOR DATE VARIABLES CREATED                   *ELCACCTV
  6649*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCACCTV
  6650*                                                                *ELCACCTV
  6651*  NO  CID  MODS  IN  COPYBOOK  ELCACCTV                         *ELCACCTV
  6652*                                                                *ELCACCTV
  6653******************************************************************ELCACCTV
  6654                                                                  ELCACCTV
  6655 01  WS-ACCOUNT-MASTER-DATE.                                      ELCACCTV
  6656                                                                  ELCACCTV
  6657     05  WS-AM-EXPIRE-DT.                                         ELCACCTV
  6658         10  FILLER            PIC 999.                           ELCACCTV
  6659         10  AM-EXP-CCYY       PIC 9(04).                         ELCACCTV
  6660         10  AM-EXP-CCYR  REDEFINES  AM-EXP-CCYY.                 ELCACCTV
  6661             15  AM-EXP-CC     PIC 99.                            ELCACCTV
  6662             15  AM-EXP-YR     PIC 99.                            ELCACCTV
  6663         10  AM-EXP-MO         PIC 99.                               CL**5
  6664         10  AM-EXP-DA         PIC 99.                               CL**5
  6665     05  WS-AM-EXPIRE-DT-N REDEFINES                                 CL**3
  6666            WS-AM-EXPIRE-DT    PIC 9(11).                            CL**4
  6667     05  WS-AM-VG-EXP-DATE.                                       ELCACCTV
  6668         10  FILLER                    PIC 999.                   ELCACCTV
  6669         10  AM-VG-EXP-CCYY            PIC 9(04).                 ELCACCTV
  6670         10  AM-VG-EXP-CCYR  REDEFINES  AM-VG-EXP-CCYY.           ELCACCTV
  6671             15  AM-VG-EXP-CC          PIC 99.                    ELCACCTV
  6672             15  AM-VG-EXP-YR          PIC 99.                    ELCACCTV
  6673         10  AM-VG-EXP-MO              PIC 99.                    ELCACCTV
  6674         10  AM-VG-EXP-DA              PIC 99.                    ELCACCTV
  6675     05  WS-AM-VG-EXP-DATE-N REDEFINES                               CL**3
  6676            WS-AM-VG-EXP-DATE          PIC 9(11).                    CL**4
  6677     05  WS-AM-EFFECT-DT.                                         ELCACCTV
  6678         10  FILLER                    PIC 999.                   ELCACCTV
  6679         10  AM-EFF-CCYY               PIC 9(04).                 ELCACCTV
  6680         10  AM-EFF-CCYR  REDEFINES  AM-EFF-CCYY.                 ELCACCTV
  6681             15  AM-EFF-CC             PIC 99.                    ELCACCTV
  6682             15  AM-EFF-YR             PIC 99.                    ELCACCTV
  6683         10  AM-EFF-MO                 PIC 99.                    ELCACCTV
  6684         10  AM-EFF-DA                 PIC 99.                    ELCACCTV
  6685     05  WS-AM-EFFECT-DT-N REDEFINES                                 CL**3
  6686            WS-AM-EFFECT-DT            PIC 9(11).                    CL**4
  6687     05  WS-AM-PREV-EXP-DT.                                       ELCACCTV
  6688         10 FILLER                     PIC 999.                   ELCACCTV
  6689         10 AM-PREV-EXP-DT-CCYY        PIC 9(04).                 ELCACCTV
  6690         10 AM-PREV-EXP-DT-CCYR  REDEFINES  AM-PREV-EXP-DT-CCYY.  ELCACCTV
  6691            15 AM-PREV-EXP-DT-CC       PIC 99.                    ELCACCTV
  6692            15 AM-PREV-EXP-DT-YR       PIC 99.                    ELCACCTV
  6693         10 AM-PREV-EXP-MO             PIC 99.                    ELCACCTV
  6694         10 AM-PREV-EXP-DA             PIC 99.                    ELCACCTV
  6695     05  WS-AM-PREV-EXP-DT-N REDEFINES                               CL**3
  6696            WS-AM-PREV-EXP-DT          PIC 9(11).                    CL**3
  6697     05  WS-AM-PREV-EFF-DT.                                       ELCACCTV
  6698         10 FILLER                     PIC 999.                   ELCACCTV
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 132
* ECS010Z.cbl (/apps/prod/cid1p/copy/ELCACCTV)
  6699         10 AM-PREV-EFF-CCYY           PIC 9(04).                 ELCACCTV
  6700         10 AM-PREV-EFF-CCYR  REDEFINES  AM-PREV-EFF-CCYY.        ELCACCTV
  6701            15 AM-PREV-EFF-CC          PIC 99.                    ELCACCTV
  6702            15 AM-PREV-EFF-YR          PIC 99.                    ELCACCTV
  6703         10 AM-PREV-EFF-MO             PIC 99.                    ELCACCTV
  6704         10 AM-PREV-EFF-DA             PIC 99.                    ELCACCTV
  6705     05  WS-AM-PREV-EFF-DT-N REDEFINES                               CL**3
  6706            WS-AM-PREV-EFF-DT          PIC 9(11).                    CL**3
  6707     05  WS-AM-ANNIVERSARY-DATE.                                  ELCACCTV
  6708         10  FILLER                    PIC 999.                   ELCACCTV
  6709         10  AM-AN-CCYY                PIC 9(04).                 ELCACCTV
  6710         10  AM-AN-CCYR  REDEFINES  AM-AN-CCYY.                   ELCACCTV
  6711             15  AM-AN-CC              PIC 99.                    ELCACCTV
  6712             15  AM-AN-YR              PIC 99.                    ELCACCTV
  6713         10  AM-AN-MO                  PIC 99.                    ELCACCTV
  6714         10  AM-AN-DA                  PIC 99.                    ELCACCTV
  6715     05  WS-AM-ANNIVERSARY-DATE-N REDEFINES                          CL**3
  6716            WS-AM-ANNIVERSARY-DATE     PIC 9(11).                    CL**4
  6717     05  WS-AM-HI-CERT-DATE.                                      ELCACCTV
  6718         10  FILLER                    PIC 999.                   ELCACCTV
  6719         10  AM-HI-CCYY                PIC 9(04).                 ELCACCTV
  6720         10  AM-HI-CCYR  REDEFINES  AM-HI-CCYY.                   ELCACCTV
  6721             15  AM-HI-CC              PIC 99.                    ELCACCTV
  6722             15  AM-HI-YR              PIC 99.                    ELCACCTV
  6723         10  AM-HI-MO                  PIC 99.                    ELCACCTV
  6724         10  AM-HI-DA                  PIC 99.                    ELCACCTV
  6725     05  WS-AM-HI-CERT-DATE-N REDEFINES                              CL**3
  6726            WS-AM-HI-CERT-DATE         PIC 9(11).                    CL**3
  6727     05  WS-AM-LO-CERT-DATE.                                      ELCACCTV
  6728         10  FILLER                    PIC 999.                   ELCACCTV
  6729         10  AM-LO-CCYY                PIC 9(04).                 ELCACCTV
  6730         10  AM-LO-CCYR  REDEFINES  AM-LO-CCYY.                   ELCACCTV
  6731             15  AM-LO-CC              PIC 99.                    ELCACCTV
  6732             15  AM-LO-YR              PIC 99.                    ELCACCTV
  6733         10  AM-LO-MO                  PIC 99.                    ELCACCTV
  6734         10  AM-LO-DA                  PIC 99.                    ELCACCTV
  6735     05  WS-AM-LO-CERT-DATE-N REDEFINES                              CL**3
  6736            WS-AM-LO-CERT-DATE         PIC 9(11).                    CL**3
  6737     05  WS-AM-ENTRY-DATE.                                        ELCACCTV
  6738         10  FILLER                    PIC 999.                   ELCACCTV
  6739         10  AM-ENT-CCYY               PIC 9(04).                 ELCACCTV
  6740         10  AM-ENT-CCYR  REDEFINES  AM-ENT-CCYY.                 ELCACCTV
  6741             15  AM-ENT-CC             PIC 99.                    ELCACCTV
  6742             15  AM-ENT-YR             PIC 99.                    ELCACCTV
  6743         10  AM-ENT-MO                 PIC 99.                    ELCACCTV
  6744         10  AM-ENT-DA                 PIC 99.                    ELCACCTV
  6745     05  WS-AM-ENTRY-DATE-N REDEFINES                                CL**3
  6746            WS-AM-ENTRY-DATE           PIC 9(11).                    CL**3
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 133
* ECS010Z.cbl
* 6748                             COPY ELCEXTVR.
  6749******************************************************************04/15/98
  6750*                                                                *ELCEXTVR
  6751*                                                                *ELCEXTVR
  6752*                             ELCEXTVR                           *   LV002
  6753*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  6754*                            VMOD=2.001                          *ELCEXTVR
  6755*                                                                *ELCEXTVR
  6756*   WORKING STORAGE FOR DATE VARIABLES CREATED                   *ELCEXTVR
  6757*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCEXTVR
  6758*                                                                *ELCEXTVR
  6759******************************************************************ELCEXTVR
  6760 01  WS-CALL-EXTRACT-DATE.                                        ELCEXTVR
  6761     05  WS-EX-EFF-DATE.                                          ELCEXTVR
  6762         10  FILLER              PIC 999.                         ELCEXTVR
  6763         10  EX-EFF-DATE-CCYY    PIC 9(04).                       ELCEXTVR
  6764         10  EX-EFF-DATE-CCYR  REDEFINES  EX-EFF-DATE-CCYY.       ELCEXTVR
  6765             15  EX-EFF-DATE-CC  PIC 99.                          ELCEXTVR
  6766             15  EX-EFF-DATE-YR  PIC 99.                          ELCEXTVR
  6767         10  EX-EFF-DATE-MO      PIC 99.                          ELCEXTVR
  6768         10  EX-EFF-DATE-DA      PIC 99.                          ELCEXTVR
  6769     05  WS-EX-EFF-DATE-N REDEFINES                                  CL**2
  6770            WS-EX-EFF-DATE       PIC 9(11).                          CL**2
  6771 01  WS-DETAIL-EXTRACT-DATE.                                      ELCEXTVR
  6772     05  WS-DE-EFF.                                               ELCEXTVR
  6773         10  FILLER              PIC 999.                         ELCEXTVR
  6774         10  DE-EF-CCYY          PIC 9(04).                       ELCEXTVR
  6775         10  DE-EF-CCYR  REDEFINES  DE-EF-CCYY.                   ELCEXTVR
  6776             15  DE-EF-CC        PIC 99.                          ELCEXTVR
  6777             15  DE-EF-YR        PIC 99.                          ELCEXTVR
  6778         10  DE-EF-MO            PIC 99.                          ELCEXTVR
  6779         10  DE-EF-DA            PIC 99.                          ELCEXTVR
  6780     05  WS-DE-EFF-N REDEFINES                                       CL**2
  6781            WS-DE-EFF            PIC 9(11).                          CL**2
  6782     05  WS-DE-LF-CANC-DTE.                                       ELCEXTVR
  6783         10  FILLER              PIC 999.                         ELCEXTVR
  6784         10  DE-LF-CANC-CCYY     PIC 9(04).                       ELCEXTVR
  6785         10  DE-LF-CANC-CCYR  REDEFINES  DE-LF-CANC-CCYY.         ELCEXTVR
  6786             15  DE-LF-CANC-CC   PIC 99.                          ELCEXTVR
  6787             15  DE-LF-CANC-YR   PIC 99.                          ELCEXTVR
  6788         10  DE-LF-CANC-MO       PIC 99.                          ELCEXTVR
  6789         10  DE-LF-CANC-DA       PIC 99.                          ELCEXTVR
  6790     05  WS-DE-LF-CANC-DTE-N REDEFINES                               CL**2
  6791            WS-DE-LF-CANC-DTE       PIC 9(11).                       CL**2
  6792     05  WS-DE-LF-CANC-EXIT-DT.                                   ELCEXTVR
  6793         10  FILLER                 PIC 999.                      ELCEXTVR
  6794         10  DE-LF-CANC-EXIT-CCYY   PIC 9(04).                    ELCEXTVR
  6795         10  DE-LF-CANC-EXIT-CCYR REDEFINES DE-LF-CANC-EXIT-CCYY. ELCEXTVR
  6796             15  DE-LF-CANC-EXIT-CC PIC 99.                       ELCEXTVR
  6797             15  DE-LF-CANC-EXIT-YR PIC 99.                       ELCEXTVR
  6798         10  DE-LF-CANC-EXIT-MO     PIC 99.                       ELCEXTVR
  6799         10  DE-LF-CANC-EXIT-DA     PIC 99.                       ELCEXTVR
  6800     05  WS-DE-LF-CANC-EXIT-DT-N REDEFINES                           CL**3
  6801            WS-DE-LF-CANC-EXIT-DT   PIC 9(11).                       CL**2
  6802     05  WS-DE-AH-CANC-DTE.                                       ELCEXTVR
  6803         10  FILLER                 PIC 999.                      ELCEXTVR
  6804         10  DE-AH-CANC-CCYY        PIC 9(04).                    ELCEXTVR
  6805         10  DE-AH-CANC-CCYR  REDEFINES  DE-AH-CANC-CCYY.         ELCEXTVR
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 134
* ECS010Z.cbl (/apps/prod/cid1p/copy/ELCEXTVR)
  6806             15  DE-AH-CANC-CC      PIC 99.                       ELCEXTVR
  6807             15  DE-AH-CANC-YR      PIC 99.                       ELCEXTVR
  6808         10  DE-AH-CANC-MO          PIC 99.                       ELCEXTVR
  6809         10  DE-AH-CANC-DA          PIC 99.                       ELCEXTVR
  6810     05  WS-DE-AH-CANC-DTE-N REDEFINES                               CL**4
  6811            WS-DE-AH-CANC-DTE       PIC 9(11).                       CL**2
  6812     05  WS-DE-AH-CANC-EXIT-DT.                                   ELCEXTVR
  6813         10  FILLER                 PIC 999.                      ELCEXTVR
  6814         10  DE-AH-CANC-EXIT-CCYY   PIC 9(04).                    ELCEXTVR
  6815         10  DE-AH-CANC-EXIT-CCYR REDEFINES DE-AH-CANC-EXIT-CCYY. ELCEXTVR
  6816             15  DE-AH-CANC-EXIT-CC PIC 99.                       ELCEXTVR
  6817             15  DE-AH-CANC-EXIT-YR PIC 99.                       ELCEXTVR
  6818         10  DE-AH-CANC-EXIT-MO     PIC 99.                       ELCEXTVR
  6819         10  DE-AH-CANC-EXIT-DA     PIC 99.                       ELCEXTVR
  6820     05  WS-DE-AH-CANC-EXIT-DT-N REDEFINES                           CL**2
  6821            WS-DE-AH-CANC-EXIT-DT   PIC 9(11).                       CL**2
  6822     05  WS-DE-ENTRY-DTE.                                         ELCEXTVR
  6823         10  FILLER                 PIC 999.                      ELCEXTVR
  6824         10  DE-ENTRY-CCYY          PIC 9(04).                    ELCEXTVR
  6825         10  DE-ENTRY-CCYR  REDEFINES  DE-ENTRY-CCYY.             ELCEXTVR
  6826             15  DE-ENTRY-CC        PIC 99.                       ELCEXTVR
  6827             15  DE-ENTRY-YR        PIC 99.                       ELCEXTVR
  6828         10  DE-ENTRY-MO            PIC 99.                       ELCEXTVR
  6829         10  DE-ENTRY-DA            PIC 99.                       ELCEXTVR
  6830     05  WS-DE-ENTRY-DTE-N REDEFINES                                 CL**2
  6831            WS-DE-ENTRY-DTE         PIC 9(11).                       CL**2
  6832     05  WS-DE-PROC-DT.                                           ELCEXTVR
  6833         10  FILLER                 PIC 999.                      ELCEXTVR
  6834         10  DE-PD-CCYY             PIC 9(04).                    ELCEXTVR
  6835         10  DE-PD-CCYR  REDEFINES  DE-PD-CCYY.                   ELCEXTVR
  6836             15  DE-PD-CC           PIC 99.                       ELCEXTVR
  6837             15  DE-PD-YR           PIC 99.                       ELCEXTVR
  6838         10  DE-PD-MO               PIC 99.                       ELCEXTVR
  6839         10  DE-PD-DA               PIC 99.                       ELCEXTVR
  6840     05  WS-DE-PROC-DT-N REDEFINES                                   CL**2
  6841            WS-DE-PROC-DT           PIC 9(11).                       CL**2
  6842     05  WS-DE-CLM-PROC-DT REDEFINES WS-DE-PROC-DT.                  CL**5
  6843         10  FILLER                 PIC 999.                         CL**5
  6844         10  DE-CP-CCYY             PIC 9(04).                       CL**5
  6845         10  DE-CP-CCYR  REDEFINES  DE-CP-CCYY.                      CL**6
  6846             15  DE-CP-CC           PIC 99.                          CL**5
  6847             15  DE-CP-YR           PIC 99.                          CL**5
  6848         10  DE-CP-MO               PIC 99.                          CL**5
  6849         10  DE-CP-DA               PIC 99.                          CL**5
  6850     05  WS-DE-CLM-PROC-DT-N REDEFINES                               CL**5
  6851            WS-DE-CLM-PROC-DT              PIC 9(11).                CL**5
  6852     05  WS-DE-RSV-PROC-DT REDEFINES WS-DE-PROC-DT.                  CL**5
  6853         10  FILLER                 PIC 999.                         CL**5
  6854         10  DE-RP-CCYY             PIC 9(04).                       CL**5
  6855         10  DE-RP-CCYR  REDEFINES  DE-RP-CCYY.                      CL**6
  6856             15  DE-RP-CC           PIC 99.                          CL**5
  6857             15  DE-RP-YR           PIC 99.                          CL**5
  6858         10  DE-RP-MO                      PIC 99.                   CL**5
  6859         10  DE-RP-DA                      PIC 99.                   CL**5
  6860     05  WS-DE-RSV-PROC-DT-N REDEFINES                               CL**5
  6861            WS-DE-RSV-PROC-DT              PIC 9(11).                CL**5
  6862     05  WS-DE-INCUR.                                             ELCEXTVR
  6863         10  FILLER                 PIC 999.                      ELCEXTVR
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 135
* ECS010Z.cbl (/apps/prod/cid1p/copy/ELCEXTVR)
  6864         10  DE-INCUR-CCYY          PIC 9(04).                    ELCEXTVR
  6865         10  DE-INCUR-CCYR  REDEFINES  DE-INCUR-CCYY.             ELCEXTVR
  6866             15  DE-INCUR-CC        PIC 99.                       ELCEXTVR
  6867             15  DE-INCUR-YR        PIC 99.                       ELCEXTVR
  6868         10  DE-INCUR-MO            PIC 99.                       ELCEXTVR
  6869         10  DE-INCUR-DA            PIC 99.                       ELCEXTVR
  6870     05  WS-DE-INCUR-N REDEFINES                                     CL**2
  6871            WS-DE-INCUR             PIC 9(11).                       CL**2
  6872     05  WS-DE-PAY.                                               ELCEXTVR
  6873         10  FILLER                 PIC 999.                      ELCEXTVR
  6874         10  DE-PAY-CCYY            PIC 9(04).                    ELCEXTVR
  6875         10  DE-PAY-CCYR  REDEFINES  DE-PAY-CCYY.                 ELCEXTVR
  6876             15  DE-PAY-CC          PIC 99.                       ELCEXTVR
  6877             15  DE-PAY-YR          PIC 99.                       ELCEXTVR
  6878         10  DE-PAY-MO              PIC 99.                       ELCEXTVR
  6879         10  DE-PAY-DA              PIC 99.                       ELCEXTVR
  6880     05  WS-DE-PAY-N REDEFINES                                       CL**2
  6881            WS-DE-PAY               PIC 9(11).                       CL**2
  6882     05  WS-DE-PAID-TO.                                           ELCEXTVR
  6883         10  FILLER                 PIC 999.                      ELCEXTVR
  6884         10  DE-PTO-CCYY            PIC 9(04).                    ELCEXTVR
  6885         10  DE-PTO-CCYR  REDEFINES  DE-PTO-CCYY.                 ELCEXTVR
  6886             15  DE-PTO-CC          PIC 99.                       ELCEXTVR
  6887             15  DE-PTO-YR          PIC 99.                       ELCEXTVR
  6888         10  DE-PTO-MO              PIC 99.                       ELCEXTVR
  6889         10  DE-PTO-DA              PIC 99.                       ELCEXTVR
  6890     05  WS-DE-PAID-TO-N REDEFINES                                   CL**2
  6891            WS-DE-PAID-TO           PIC 9(11).                       CL**2
  6892     05  WS-DE-ACC-EXP-DTE.                                       ELCEXTVR
  6893         10 FILLER                  PIC 999.                      ELCEXTVR
  6894         10 DE-ACC-EXP-CCYY         PIC 9(04).                    ELCEXTVR
  6895         10 DE-ACC-EXP-CCYR  REDEFINES  DE-ACC-EXP-CCYY.          ELCEXTVR
  6896            15 DE-ACC-EXP-CC        PIC 99.                       ELCEXTVR
  6897            15 DE-ACC-EXP-YR        PIC 99.                       ELCEXTVR
  6898         10 DE-ACC-EXP-MO           PIC 99.                       ELCEXTVR
  6899         10 DE-ACC-EXP-DA           PIC 99.                       ELCEXTVR
  6900     05  WS-DE-ACC-EXP-DTE-N REDEFINES                               CL**2
  6901            WS-DE-ACC-EXP-DTE       PIC 9(11).                       CL**2
  6902     05  WS-DE-ACC-EFF-DTE.                                       ELCEXTVR
  6903         10 FILLER                  PIC 999.                      ELCEXTVR
  6904         10 DE-ACC-EFF-CCYY         PIC 9(04).                    ELCEXTVR
  6905         10 DE-ACC-EFF-CCYR  REDEFINES  DE-ACC-EFF-CCYY.          ELCEXTVR
  6906            15 DE-ACC-EFF-CC        PIC 99.                       ELCEXTVR
  6907            15 DE-ACC-EFF-YR        PIC 99.                       ELCEXTVR
  6908         10 DE-ACC-EFF-MO           PIC 99.                       ELCEXTVR
  6909         10 DE-ACC-EFF-DA           PIC 99.                       ELCEXTVR
  6910     05  WS-DE-ACC-EFF-DTE-N REDEFINES                               CL**2
  6911            WS-DE-ACC-EFF-DTE       PIC 9(11).                       CL**2
  6912     05  WS-DE-RSV-INCUR.                                         ELCEXTVR
  6913         10  FILLER                 PIC 999.                      ELCEXTVR
  6914         10  DE-RSV-INCUR-CCYY      PIC 9(04).                    ELCEXTVR
  6915         10  DE-RSV-INCUR-CCYR  REDEFINES  DE-RSV-INCUR-CCYY.     ELCEXTVR
  6916             15  DE-RSV-INCUR-CC    PIC 99.                       ELCEXTVR
  6917             15  DE-RSV-INCUR-YR    PIC 99.                       ELCEXTVR
  6918         10  DE-RSV-INCUR-MO        PIC 99.                       ELCEXTVR
  6919         10  DE-RSV-INCUR-DA        PIC 99.                       ELCEXTVR
  6920     05  WS-DE-RSV-INCUR-N REDEFINES                                 CL**2
  6921            WS-DE-RSV-INCUR         PIC 9(11).                       CL**2
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 136
* ECS010Z.cbl (/apps/prod/cid1p/copy/ELCEXTVR)
  6922     05  WS-DE-RSV-PAYTO.                                         ELCEXTVR
  6923         10  FILLER                 PIC 999.                      ELCEXTVR
  6924         10  DE-RSV-PAYTO-CCYY      PIC 9(04).                    ELCEXTVR
  6925         10  DE-RSV-PAYTO-CCYR  REDEFINES  DE-RSV-PAYTO-CCYY.     ELCEXTVR
  6926             15  DE-RSV-PAYTO-CC    PIC 99.                       ELCEXTVR
  6927             15  DE-RSV-PAYTO-YR    PIC 99.                       ELCEXTVR
  6928         10  DE-RSV-PAYTO-MO        PIC 99.                       ELCEXTVR
  6929         10  DE-RSV-PAYTO-DA        PIC 99.                       ELCEXTVR
  6930     05  WS-DE-RSV-PAYTO-N REDEFINES                                 CL**2
  6931            WS-DE-RSV-PAYTO         PIC 9(11).                       CL**2
  6932     05  WS-DE-ACC-EXP-DTE-RSV.                                   ELCEXTVR
  6933         10  FILLER                        PIC 999.               ELCEXTVR
  6934         10  DE-ACC-EXP-DTE-RSV-CCYY       PIC 9(04).             ELCEXTVR
  6935         10  DE-ACC-EXP-DTE-RSV-CCYR REDEFINES                    ELCEXTVR
  6936                             DE-ACC-EXP-DTE-RSV-CCYY.             ELCEXTVR
  6937             15  DE-ACC-EXP-DTE-RSV-CC     PIC 99.                ELCEXTVR
  6938             15  DE-ACC-EXP-DTE-RSV-YR     PIC 99.                ELCEXTVR
  6939         10  DE-ACC-EXP-DTE-RSV-MO         PIC 99.                ELCEXTVR
  6940         10  DE-ACC-EXP-DTE-RSV-DA         PIC 99.                ELCEXTVR
  6941     05  WS-DE-ACC-EXP-DTE-RSV-N REDEFINES                           CL**2
  6942            WS-DE-ACC-EXP-DTE-RSV          PIC 9(11).                CL**2
  6943     05  WS-DE-ACC-EFF-DTE-RSV.                                   ELCEXTVR
  6944         10  FILLER                        PIC 999.               ELCEXTVR
  6945         10  DE-ACC-EFF-DTE-RSV-CCYY       PIC 9(04).             ELCEXTVR
  6946         10  DE-ACC-EFF-DTE-RSV-CCYR  REDEFINES                   ELCEXTVR
  6947                                DE-ACC-EFF-DTE-RSV-CCYY.          ELCEXTVR
  6948             15  DE-ACC-EFF-DTE-RSV-CC     PIC 99.                ELCEXTVR
  6949             15  DE-ACC-EFF-DTE-RSV-YR     PIC 99.                ELCEXTVR
  6950         10  DE-ACC-EFF-DTE-RSV-MO         PIC 99.                ELCEXTVR
  6951         10  DE-ACC-EFF-DTE-RSV-DA         PIC 99.                ELCEXTVR
  6952     05  WS-DE-ACC-EFF-DTE-RSV-N REDEFINES                           CL**2
  6953            WS-DE-ACC-EFF-DTE-RSV          PIC 9(11).                CL**2
  6954                                                                     CL**5
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 137
* ECS010Z.cbl
  6956 PROCEDURE DIVISION.
  6957
  6958 0000-START.
  6959
  6960******************************************************************
  6961***        D A T E   C A R D   L O A D   R O U T I N E         ***
  6962******************************************************************
  6963
  6964*0003-LOAD-DATE-CARD.
* 6965                             COPY ELCDTERX.
  6966******************************************************************04/15/98
  6967*                                                                *ELCDTERX
  6968*                                                                *ELCDTERX
  6969*                            ELCDTERX.                           *   LV002
  6970*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  6971*                            VMOD=2.007                          *ELCDTERX
  6972*                                                                *ELCDTERX
  6973*      LOAD DATE CARD DISK FILE INTO WORKING STORAGE AREA        *ELCDTERX
  6974*      (COPY CODE FOR W/S = ELCDTECX AND COPY CODE FOR FD        *ELCDTERX
  6975*      = ELCDTEFD)                                               *ELCDTERX
  6976*                                                                *ELCDTERX
  6977******************************************************************ELCDTERX
  6978                                                                  ELCDTERX
  6979     ACCEPT WS-ACCEPT-DATE       FROM  DATE.                      ELCDTERX
  6980                                                                  ELCDTERX
  6981     MOVE WS-AD-YY               TO  WS-CD-YY.                    ELCDTERX
  6982     MOVE WS-AD-MM               TO  WS-CD-MM.                    ELCDTERX
  6983     MOVE WS-AD-DD               TO  WS-CD-DD.                    ELCDTERX
  6984                                                                  ELCDTERX
  6985     ACCEPT WS-TIME-OF-DAY       FROM  TIME.                      ELCDTERX
  6986                                                                  ELCDTERX
  6987******************************************************************ELCDTERX
  6988*    NOTE: THE FOLLOWING STATEMENT IS USED TO ELIMINATE COB II    ELCDTERX
  6989*          WARNING MESSAGES.                                      ELCDTERX
  6990******************************************************************ELCDTERX
  6991     IF WS-CD-YY = LOW-VALUES                                     ELCDTERX
  6992         COMPUTE PGM-SUB = PGM-SUB + 1.                           ELCDTERX
  6993                                                                  ELCDTERX
  6994     OPEN INPUT DISK-DATE.                                        ELCDTERX
  6995                                                                  ELCDTERX
  6996     MOVE SPACE TO DATE-CARD         CLAS-BUSINESS-CLASSES        ELCDTERX
  6997                   STATE-NAMES       CLAS-MORTALITY-CODES         ELCDTERX
  6998                   CLAS-INS-TYPES    COMPANY-NAME-TABLE           ELCDTERX
  6999                   DATE-CARD-OPTIONS DATE-CARD-FACTORS            ELCDTERX
  7000                   CLAX-ID           CLAS-MISC                    ELCDTERX
  7001                   CARRIER-NAMES     CLASIC-SYSTEM-CODES          ELCDTERX
  7002                   CARRIER-OPT-CLAIM-DATA                         ELCDTERX
  7003                   STATE-TARGET-LOSS-RATIOS                       ELCDTERX
  7004                   BUSINESS-TRGT-LOSS-RATIO-MODS                  ELCDTERX
  7005                   MISC-OPT-CLM-RSV-DATA.                         ELCDTERX
  7006                                                                  ELCDTERX
  7007     MOVE LOW-VALUES TO CLAS-INDEX-TBL CLAS-TYPE-MISC.            ELCDTERX
  7008                                                                  ELCDTERX
  7009     MOVE ZERO TO CLAS-CN DTE-TOT-LINES CLAS-CO                   ELCDTERX
  7010                  INDEXCA INDEXBS INDEXST.                        ELCDTERX
  7011                                                                  ELCDTERX
  7012     COMPUTE CLAS-CN = PGM-SUB / +50.                             ELCDTERX
  7013     COMPUTE CLAS-CO = PGM-SUB / +20.                             ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 138
* ECS010Z.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  7014     COMPUTE CLAS-INDEXEN = PGM-SUB - (CLAS-CN * +50).            ELCDTERX
  7015     COMPUTE CLAS-INDEXON = PGM-SUB - (CLAS-CO * +20).            ELCDTERX
  7016                                                                  ELCDTERX
  7017     IF CLAS-INDEXEN = ZERO                                       ELCDTERX
  7018         MOVE +50               TO CLAS-INDEXEN                   ELCDTERX
  7019     ELSE                                                         ELCDTERX
  7020         ADD +1                 TO CLAS-CN.                       ELCDTERX
  7021                                                                  ELCDTERX
  7022     IF CLAS-INDEXON = ZERO                                       ELCDTERX
  7023         MOVE +20               TO CLAS-INDEXON                   ELCDTERX
  7024     ELSE                                                         ELCDTERX
  7025         ADD +1                 TO CLAS-CO.                       ELCDTERX
  7026                                                                  ELCDTERX
  7027 0005-READ--CARD.                                                 ELCDTERX
  7028     READ DISK-DATE                                               ELCDTERX
  7029         AT END CLOSE DISK-DATE                                   ELCDTERX
  7030             GO TO 0060-READ--TEST.                               ELCDTERX
  7031                                                                  ELCDTERX
  7032     MOVE ZERO                   TO CLAS-INDEX.                   ELCDTERX
  7033                                                                  ELCDTERX
  7034     IF DD-ID = 'CLAS' OR 'LIFE' OR 'GLED'                        ELCDTERX
  7035         MOVE DATE-DISK          TO DATE-CARD                     ELCDTERX
  7036         MOVE RUN-DATE           TO WS-RUN-DATE-N                    CL**2
  7037         MOVE EP-DT              TO WS-EP-DT-N                       CL**2
  7038         GO TO 0005-READ--CARD.                                   ELCDTERX
  7039                                                                  ELCDTERX
  7040     IF DD-ID = 'CLAD'                                            ELCDTERX
  7041         MOVE DATE-DISK          TO DATE-CARD-OPTIONS             ELCDTERX
  7042         GO TO 0005-READ--CARD.                                   ELCDTERX
  7043                                                                  ELCDTERX
  7044     IF DD-ID = 'CLAX'                                            ELCDTERX
  7045         MOVE DATE-DISK          TO CLAS-INDEX-TBL                ELCDTERX
  7046         GO TO 0005-READ--CARD.                                   ELCDTERX
  7047                                                                  ELCDTERX
  7048     IF DD-ID = 'CLAF'                                            ELCDTERX
  7049         MOVE DATE-DISK          TO DATE-CARD-FACTORS             ELCDTERX
  7050         GO TO 0005-READ--CARD.                                   ELCDTERX
  7051                                                                  ELCDTERX
  7052     IF DD-ID = 'CLAC'                                            ELCDTERX
  7053         GO TO 0010-READ--CLAC.                                   ELCDTERX
  7054                                                                  ELCDTERX
  7055     IF DD-ID = 'CARR'                                            ELCDTERX
  7056         GO TO 0015-READ--CARR.                                   ELCDTERX
  7057                                                                  ELCDTERX
  7058     IF DD-ID = 'STAT'                                            ELCDTERX
  7059         GO TO 0020-READ--STAT.                                   ELCDTERX
  7060                                                                  ELCDTERX
  7061     IF DD-ID = 'BUSC'                                            ELCDTERX
  7062         GO TO 0025-READ--BUSC.                                   ELCDTERX
  7063                                                                  ELCDTERX
  7064     IF DD-ID = 'MORT'                                            ELCDTERX
  7065         GO TO 0030-READ--MORT.                                   ELCDTERX
  7066                                                                  ELCDTERX
  7067     IF DD-ID = 'CLAI'                                            ELCDTERX
  7068         GO TO 0040-READ--CLAI.                                   ELCDTERX
  7069                                                                  ELCDTERX
  7070     IF DD-ID = 'COLC'                                            ELCDTERX
  7071         GO TO 0065-READ--COLC.                                   ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 139
* ECS010Z.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  7072                                                                  ELCDTERX
  7073     IF DD-IDX NUMERIC AND                                        ELCDTERX
  7074        DD-IDA = 'CL'                                             ELCDTERX
  7075         GO TO 0035-READ--CLXX.                                   ELCDTERX
  7076                                                                  ELCDTERX
  7077     IF DD-IDX NUMERIC AND                                        ELCDTERX
  7078        DD-IDA = 'PO'                                             ELCDTERX
  7079         GO TO 0050-READ--POXX.                                   ELCDTERX
  7080                                                                  ELCDTERX
  7081     IF DD-ID = 'OPCA'                                            ELCDTERX
  7082         GO TO 0070-READ--OPCA.                                   ELCDTERX
  7083                                                                  ELCDTERX
  7084     IF DD-ID = 'OPST'                                            ELCDTERX
  7085         GO TO 0072-READ--OPST.                                   ELCDTERX
  7086                                                                  ELCDTERX
  7087     IF DD-ID = 'OPBS'                                            ELCDTERX
  7088         GO TO 0074-READ--OPBS.                                   ELCDTERX
  7089                                                                  ELCDTERX
  7090     IF DD-ID = 'OPMS'                                            ELCDTERX
  7091         MOVE DD-MISC-DATA       TO MISC-OPT-CLM-RSV-DATA.        ELCDTERX
  7092                                                                  ELCDTERX
  7093     GO TO 0005-READ--CARD.                                       ELCDTERX
  7094                                                                  ELCDTERX
  7095 0010-READ--CLAC.                                                 ELCDTERX
  7096     ADD 1                       TO CLAS-INDEXC.                  ELCDTERX
  7097     MOVE DD-CR1                 TO CNT-ID (CLAS-INDEXC).         ELCDTERX
  7098     MOVE DD-CR1N                TO CNT-NAME (CLAS-INDEXC).       ELCDTERX
  7099     ADD 1                       TO CLAS-INDEXC.                  ELCDTERX
  7100     MOVE DD-CR2                 TO CNT-ID (CLAS-INDEXC).         ELCDTERX
  7101     MOVE DD-CR2N                TO CNT-NAME (CLAS-INDEXC).       ELCDTERX
  7102     GO TO 0005-READ--CARD.                                       ELCDTERX
  7103                                                                  ELCDTERX
  7104 0015-READ--CARR.                                                 ELCDTERX
  7105     ADD 1  TO  CLAS-INDEXCN.                                     ELCDTERX
  7106     IF CLAS-INDEXCN LESS THAN +26                                ELCDTERX
  7107        MOVE DD-CARR1         TO CARRIER-SUB (CLAS-INDEXCN)
  7108        MOVE DD-CARR1S        TO CARRIER-DOM-ST (CLAS-INDEXCN)
  7109        MOVE DD-CARR1N        TO CARRIER-PIC (CLAS-INDEXCN)
  7110        MOVE DD-CARR1-UEP-PCT TO CARRIER-UEP-PCT (CLAS-INDEXCN)
  7111        MOVE DD-CARR1-R78-PCT TO CARRIER-R78-PCT (CLAS-INDEXCN)
  7112        MOVE DD-CARR1-PRO-PCT TO CARRIER-PRO-PCT (CLAS-INDEXCN)
  7113        MOVE DD-CARR1-SECPAY-SW
  7114                               TO CARRIER-SEC-PAY (CLAS-INDEXCN)
  7115     END-IF
  7116                                                                  ELCDTERX
  7117     ADD 1  TO  CLAS-INDEXCN.                                     ELCDTERX
  7118     IF CLAS-INDEXCN LESS THAN +26                                ELCDTERX
  7119        MOVE DD-CARR2         TO CARRIER-SUB (CLAS-INDEXCN)
  7120        MOVE DD-CARR2S        TO CARRIER-DOM-ST (CLAS-INDEXCN)
  7121        MOVE DD-CARR2N        TO CARRIER-PIC (CLAS-INDEXCN)
  7122        MOVE DD-CARR2-UEP-PCT TO CARRIER-UEP-PCT (CLAS-INDEXCN)
  7123        MOVE DD-CARR2-R78-PCT TO CARRIER-R78-PCT (CLAS-INDEXCN)
  7124        MOVE DD-CARR2-PRO-PCT TO CARRIER-PRO-PCT (CLAS-INDEXCN)
  7125        MOVE DD-CARR2-SECPAY-SW
  7126                              TO CARRIER-SEC-PAY (CLAS-INDEXCN)
  7127     END-IF
  7128                                                                  ELCDTERX
  7129                                                                  ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 140
* ECS010Z.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  7130     GO TO 0005-READ--CARD.                                       ELCDTERX
  7131                                                                  ELCDTERX
  7132 0020-READ--STAT.                                                 ELCDTERX
  7133     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  7134     IF CLAS-INDEX GREATER 3  OR                                  ELCDTERX
  7135        DD-ST (CLAS-INDEX) = SPACE                                ELCDTERX
  7136         GO TO 0005-READ--CARD.                                   ELCDTERX
  7137                                                                  ELCDTERX
  7138     ADD 1                       TO CLAS-INDEXS.                  ELCDTERX
  7139     MOVE DD-ST (CLAS-INDEX)     TO STATE-NAME-FLD (CLAS-INDEXS). ELCDTERX
  7140     GO TO 0020-READ--STAT.                                       ELCDTERX
  7141                                                                  ELCDTERX
  7142 0025-READ--BUSC.                                                 ELCDTERX
  7143     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  7144     IF CLAS-INDEX GREATER 3  OR                                  ELCDTERX
  7145        DD-ST (CLAS-INDEX) = SPACE                                ELCDTERX
  7146         GO TO 0005-READ--CARD.                                   ELCDTERX
  7147                                                                  ELCDTERX
  7148     ADD 1                       TO CLAS-INDEXB.                  ELCDTERX
  7149     MOVE DD-ST (CLAS-INDEX)     TO CLAS-BUSC-FLD (CLAS-INDEXB).  ELCDTERX
  7150     GO TO 0025-READ--BUSC.                                       ELCDTERX
  7151                                                                  ELCDTERX
  7152 0030-READ--MORT.                                                 ELCDTERX
  7153     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  7154     IF CLAS-INDEX GREATER 2  OR                                  ELCDTERX
  7155        DD-MORT (CLAS-INDEX) = SPACE                              ELCDTERX
  7156         GO TO 0005-READ--CARD.                                   ELCDTERX
  7157                                                                  ELCDTERX
  7158     ADD 1                       TO CLAS-INDEXM.                  ELCDTERX
  7159     MOVE DD-MORT (CLAS-INDEX)   TO CLAS-MORT-FLD (CLAS-INDEXM).  ELCDTERX
  7160     GO TO 0030-READ--MORT.                                       ELCDTERX
  7161                                                                  ELCDTERX
  7162 0035-READ--CLXX.                                                 ELCDTERX
  7163     IF DD-IDX NOT = CLAS-CN                                      ELCDTERX
  7164          GO TO 0005-READ--CARD.                                  ELCDTERX
  7165                                                                  ELCDTERX
  7166     IF DD-PS-PIC (CLAS-INDEXEN) = 'X'                            ELCDTERX
  7167         DISPLAY '***********************************************'ELCDTERX
  7168         DISPLAY 'PROGRAM ECS-', PGM-SUB, ' NOT SCHEDULED TO RUN' ELCDTERX
  7169         DISPLAY '***********************************************'ELCDTERX
  7170         GO TO 0055-READ--STOP.                                   ELCDTERX
  7171                                                                  ELCDTERX
  7172     IF DD-PS-PIC (CLAS-INDEXEN) NOT LESS 'A'  AND                ELCDTERX
  7173        DD-PS-PIC (CLAS-INDEXEN) NOT GREATER 'I'                  ELCDTERX
  7174         MOVE '1'                TO DTE-FICH.                     ELCDTERX
  7175                                                                  ELCDTERX
  7176     IF DD-PS-PIC (CLAS-INDEXEN) NOT LESS 'J'  AND                ELCDTERX
  7177        DD-PS-PIC (CLAS-INDEXEN) NOT GREATER 'R'                  ELCDTERX
  7178         MOVE '2'                TO DTE-FICH.                     ELCDTERX
  7179                                                                  ELCDTERX
  7180*    MOVE DD-PS-PIC (CLAS-INDEXEN) TO DTE-PGM-OPT.                ELCDTERX
  7181     GO TO 0005-READ--CARD.                                       ELCDTERX
  7182                                                                  ELCDTERX
  7183 0040-READ--CLAI.                                                 ELCDTERX
  7184     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  7185     IF CLAS-INDEX GREATER 2  OR                                  ELCDTERX
  7186        DD-TYPE (CLAS-INDEX) = SPACE                              ELCDTERX
  7187         GO TO 0005-READ--CARD.                                   ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 141
* ECS010Z.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  7188                                                                  ELCDTERX
  7189     ADD 1                       TO CLAS-INDEXA.                  ELCDTERX
  7190     MOVE DD-TYPE (CLAS-INDEX) TO CLAS-ALL-TYPES (CLAS-INDEXA).   ELCDTERX
  7191     GO TO 0040-READ--CLAI.                                       ELCDTERX
  7192                                                                  ELCDTERX
  7193 0045-READ--DUMP.                                                 ELCDTERX
  7194     MOVE +999 TO WS-RETURN-CODE                                  ELCDTERX
  7195     MOVE 'MISSING AND/OR INVALID CLAS DATE CARD'                 ELCDTERX
  7196                                 TO  WS-ABEND-MESSAGE             ELCDTERX
  7197     PERFORM ABEND-PGM.                                           ELCDTERX
  7198                                                                  ELCDTERX
  7199 0050-READ--POXX.                                                 ELCDTERX
  7200     IF DD-IDX NOT = CLAS-CO                                      ELCDTERX
  7201         GO TO 0005-READ--CARD.                                   ELCDTERX
  7202                                                                  ELCDTERX
  7203     IF DD-PS-PRC (CLAS-INDEXON) = 'X'                            ELCDTERX
  7204         DISPLAY '***********************************************'ELCDTERX
  7205         DISPLAY 'ECS - ', PGM-SUB, ' IS NOT SCHEDULED TO RUN'    ELCDTERX
  7206         DISPLAY '***********************************************'ELCDTERX
  7207         GO TO 0055-READ--STOP.                                   ELCDTERX
  7208                                                                  ELCDTERX
  7209     MOVE DD-PS-PRT (CLAS-INDEXON) TO DTE-PRT-OPT.                ELCDTERX
  7210     MOVE DD-PS-FMT (CLAS-INDEXON) TO DTE-FMT-OPT.                ELCDTERX
  7211     MOVE DD-PS-PRC (CLAS-INDEXON) TO DTE-PRC-OPT DTE-PGM-OPT.    ELCDTERX
  7212     MOVE DD-PS-TOT (CLAS-INDEXON) TO DTE-TOT-OPT.                ELCDTERX
  7213                                                                  ELCDTERX
  7214     IF DTE-PRT-OPT = 'B'                                         ELCDTERX
  7215         MOVE '2'                  TO DTE-FICH.                   ELCDTERX
  7216     IF DTE-PRT-OPT = 'F'                                         ELCDTERX
  7217         MOVE '1'                  TO DTE-FICH.                   ELCDTERX
  7218                                                                  ELCDTERX
  7219     GO TO 0005-READ--CARD.                                       ELCDTERX
  7220                                                                  ELCDTERX
  7221 0055-READ--STOP.                                                 ELCDTERX
  7222     GOBACK.                                                      ELCDTERX
  7223                                                                  ELCDTERX
  7224 0060-READ--TEST.                                                 ELCDTERX
  7225     IF DATX-COD        = SPACE  OR                               ELCDTERX
  7226        CLAX-ID         = SPACE  OR                               ELCDTERX
  7227        DATE-OPTIONS-ID = SPACE                                   ELCDTERX
  7228         GO TO 0045-READ--DUMP.                                   ELCDTERX
  7229                                                                  ELCDTERX
  7230     MOVE LOW-VALUE TO CLAS-TYPE-MISC.                            ELCDTERX
  7231     GO TO 0079-READ--EXIT.                                       ELCDTERX
  7232                                                                  ELCDTERX
  7233 0065-READ--COLC.                                                 ELCDTERX
  7234     MOVE DATE-DISK              TO CLASIC-SYSTEM-CODES.          ELCDTERX
  7235     GO TO 0005-READ--CARD.                                       ELCDTERX
  7236                                                                  ELCDTERX
  7237 0070-READ--OPCA.                                                 ELCDTERX
  7238                                                                  ELCDTERX
  7239     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  7240                                                                  ELCDTERX
  7241     IF  CLAS-INDEX GREATER 13                                    ELCDTERX
  7242             OR                                                   ELCDTERX
  7243         DD-CARR-FLDS (CLAS-INDEX) = SPACE                        ELCDTERX
  7244         GO TO 0005-READ--CARD.                                   ELCDTERX
  7245                                                                  ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 142
* ECS010Z.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  7246     ADD 1                       TO INDEXCA.                      ELCDTERX
  7247     MOVE DD-CARR-FLDS (CLAS-INDEX)                               ELCDTERX
  7248                                 TO CARRIER-FLDS (INDEXCA).       ELCDTERX
  7249     GO TO 0070-READ--OPCA.                                       ELCDTERX
  7250                                                                  ELCDTERX
  7251 0072-READ--OPST.                                                 ELCDTERX
  7252                                                                  ELCDTERX
  7253     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  7254                                                                  ELCDTERX
  7255     IF  CLAS-INDEX GREATER 16                                    ELCDTERX
  7256             OR                                                   ELCDTERX
  7257         DD-TLR (CLAS-INDEX) = SPACE                              ELCDTERX
  7258         GO TO 0005-READ--CARD.                                   ELCDTERX
  7259                                                                  ELCDTERX
  7260     ADD 1                       TO INDEXST.                      ELCDTERX
  7261     MOVE DD-STATE-FLDS (CLAS-INDEX)                              ELCDTERX
  7262                                 TO STATE-TLR-FLD (INDEXST).      ELCDTERX
  7263     GO TO 0072-READ--OPST.                                       ELCDTERX
  7264                                                                  ELCDTERX
  7265 0074-READ--OPBS.                                                 ELCDTERX
  7266                                                                  ELCDTERX
  7267     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  7268                                                                  ELCDTERX
  7269     IF  CLAS-INDEX GREATER 32                                    ELCDTERX
  7270             OR                                                   ELCDTERX
  7271         DD-TLR (CLAS-INDEX) = SPACE                              ELCDTERX
  7272         GO TO 0005-READ--CARD.                                   ELCDTERX
  7273                                                                  ELCDTERX
  7274     ADD 1                       TO INDEXBS.                      ELCDTERX
  7275     MOVE DD-TLR (CLAS-INDEX)    TO BUS-TLRM-FLD (INDEXBS).       ELCDTERX
  7276     GO TO 0074-READ--OPBS.                                       ELCDTERX
  7277                                                                  ELCDTERX
  7278 0079-READ--EXIT.                                                 ELCDTERX
  7279*    EXIT.                                                        ELCDTERX
  7280******************************************************************ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 143
* ECS010Z.cbl
  7282******************************************************************
  7283***           O P E N   F I L E S   R O U T I N E              ***
  7284******************************************************************
  7285
  7286     DISPLAY ' '.
  7287     DISPLAY '****** THE FOLLOWING MESSAGES WERE CREATED BY '
  7288         'ECS010 ******'
  7289     DISPLAY ' '.
  7290
  7291 0080-OPEN-FILES.
  7292*    IF DTE-PGM-OPT = '1'
  7293*       open output detail-extr
  7294*    end-if
  7295     OPEN INPUT  PENDING-EXTRACT
  7296                 CERT-MASTER-IN
  7297                 ERACCTT-IN
  7298
  7299          I-O    ERMEBL-INOUT
  7300
  7301          OUTPUT SUMMARY-EXTR
  7302                 DISPLAY-PRT
  7303                 MISMATCH-REPORT
  7304                 PRINT-COPY.
  7305
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 144
* ECS010Z.cbl
  7307*START*************CUSTOM CODE FOR CLIENT "DMD"*************
  7308     IF DTE-CLIENT NOT = 'DMD'
  7309         NEXT SENTENCE
  7310     ELSE
  7311         OPEN INPUT ERRESC-IN
  7312            IF ERRESC-FILE-STATUS   = '00' OR '97'
  7313                NEXT SENTENCE
  7314            ELSE
  7315                MOVE ERRESC-FILE-STATUS TO WS-ABEND-FILE-STATUS
  7316                MOVE 'ERROR OPENING ERRESC FILE'
  7317                                        TO WS-ABEND-MESSAGE
  7318                GO TO ABEND-PGM.
  7319*END***************CUSTOM CODE FOR CLIENT "DMD"*************
  7320
  7321     IF ERACCTT-FILE-STATUS  = '00'  OR  '97'
  7322         NEXT SENTENCE
  7323       ELSE
  7324         MOVE '11'                    TO ABEND-CODE-1
  7325         MOVE ERACCTT-FILE-STATUS     TO ABEND-CODE-2
  7326         MOVE WS-ABEND-CODE           TO WS-RETURN-CODE
  7327         GO TO ABEND-PGM.
  7328
  7329     IF ERMEBL-FILE-STATUS  = '00'  OR  '97'
  7330         NEXT SENTENCE
  7331       ELSE
  7332         MOVE 'N'                     TO ME-UPDATE-FLAG.
  7333
  7334     IF DTE-PGM-OPT = '1' OR '2'
  7335         OPEN OUTPUT  CERT-MASTER-OUT
  7336                      DETAIL-EXTR
  7337     ELSE
  7338         MOVE HIGH-VALUES             TO PENDING-MATCH-CONTROL
  7339         MOVE '*'                     TO TRANS-EOF-FLAG.
  7340
  7341     MOVE 'R'                         TO CP-RATE-FILE.
  7342     MOVE 'O'                         TO CP-IO-FUNCTION.
  7343     PERFORM 8100-GET-RATE THRU 8199-GET-RATE-X.
  7344     IF IO-ERROR
  7345         MOVE 'ERROR OCCURED OPENING - ELRATE'
  7346                                      TO WS-ABEND-MESSAGE
  7347         MOVE 0302                    TO WS-RETURN-CODE
  7348         GO TO ABEND-PGM.
  7349
  7350******************************************************************
  7351***       I N I T I A L I Z A T I O N   R O U T I N E          ***
  7352******************************************************************
  7353
  7354 0090-INITIALIZATION-ROUTINE.
  7355
  7356     ACCEPT WS-TIME-OF-DAY   FROM TIME.
  7357     MOVE WS-TIME                     TO ME-START-TIME.
  7358     MOVE WS-CURRENT-DATE             TO ME-START-DATE
  7359                                         TR-RN-DT.
  7360     MOVE ME-START-MO                 TO ME-CNDS-MO.
  7361     MOVE ME-START-DA                 TO ME-CNDS-DA.
  7362     MOVE ME-START-YR                 TO ME-CNDS-YR.
  7363     COMPUTE MONTH-END-MOYR = (RUN-CCYY * 12) + RUN-MO.
  7364     MOVE COMPANY-NAME                TO TRHDNM.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 145
* ECS010Z.cbl
  7365     MOVE ALPH-DATE                   TO TR-MODAYR.
  7366     MOVE RUN-DATE                    TO EOM-RUN-DATE.
  7367     MOVE BIN-RUN-DATE                TO BIN-EOM-RUN-DATE.
  7368
  7369     MOVE EOM-RUN-DATE                TO  LAST-YRS-DATE.
  7370     COMPUTE LYD-CCYY = LYD-CCYY - 1.
  7371     COMPUTE LYD-MO = LYD-MO - 1.
  7372     IF LYD-MO = ZERO
  7373         MOVE 12                      TO LYD-MO
  7374         COMPUTE LYD-CCYY = LYD-CCYY - 1.
  7375
  7376     MOVE BIN-EOM-RUN-DATE       TO BIN-VALUATION-DT.
  7377
  7378     IF  NOT DTE-OPT-RESERVE-METHOD-AUTH
  7379         GO TO 0090-CONTINUE.
  7380
  7381     MOVE BIN-VALUATION-DT       TO DC-BIN-DATE-1.
  7382     MOVE -12                    TO DC-ELAPSED-MONTHS.
  7383     MOVE ZEROS                  TO DC-ELAPSED-DAYS.
  7384     MOVE '6'                    TO DC-OPTION-CODE.
  7385     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
  7386
  7387     IF  DC-ERROR-CODE NOT EQUAL SPACES
  7388         MOVE '**** WORK DATE CALC ERROR ****'
  7389                                 TO WS-ABEND-MESSAGE
  7390         MOVE '90'               TO ABEND-CODE-1
  7391         MOVE '0'                TO AC2-ONE
  7392         MOVE DC-ERROR-CODE      TO AC2-TWO
  7393         MOVE WS-ABEND-CODE      TO WS-RETURN-CODE
  7394         GO TO ABEND-PGM.
  7395
  7396     MOVE DC-BIN-DATE-2          TO  W-WORK-DATE.
  7397
  7398     MOVE DC-GREG-DATE-CYMD      TO  EOM-DATE (01).
  7399     MOVE EOM-RUN-DATE           TO  EOM-DATE (13).
  7400
  7401     PERFORM 0095-GET-EOM-DATES THRU 0095-EXIT
  7402             VARYING
  7403         SUBM FROM +2 BY +1
  7404             UNTIL
  7405         SUBM GREATER THAN +12.
  7406
  7407     DISPLAY 'END OF MONTH TABLE VALUES USED BY ECS010 - '.
  7408
  7409     PERFORM 0096-DISPLAY-EOM-DATES THRU 0096-EXIT
  7410             VARYING
  7411         SUBM FROM +1 BY +1
  7412             UNTIL
  7413         SUBM GREATER THAN +13.
  7414
  7415     MOVE BIN-VALUATION-DT       TO DC-BIN-DATE-1.
  7416*    MOVE -90                    TO DC-ELAPSED-DAYS.
  7417     MOVE ZEROS                  TO DC-ELAPSED-DAYS
  7418                                    DC-ELAPSED-MONTHS.
  7419     SUBTRACT COMPANY-IBNR-LAG-MONTH FROM DC-ELAPSED-MONTHS.
  7420     MOVE 1                      TO DC-END-OF-MONTH.
  7421     MOVE '6'                    TO DC-OPTION-CODE.
  7422     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 146
* ECS010Z.cbl
  7423
  7424     IF  DC-ERROR-CODE NOT EQUAL SPACES
  7425         MOVE '**** CUT OFF DATE ERROR ****'
  7426                                 TO WS-ABEND-MESSAGE
  7427         MOVE '90'               TO ABEND-CODE-1
  7428         MOVE '0'                TO AC2-ONE
  7429         MOVE DC-ERROR-CODE      TO AC2-TWO
  7430         MOVE WS-ABEND-CODE      TO WS-RETURN-CODE
  7431         GO TO ABEND-PGM.
  7432
  7433     MOVE DC-GREG-DATE-CYMD      TO W-CUTOFF-DATE.
  7434     DISPLAY ' CUT OFF DATE - '  W-CUTOFF-DATE.
  7435
  7436 0090-CONTINUE.
  7437
  7438     MOVE BIN-VALUATION-DT       TO DC-BIN-DATE-1.
  7439     MOVE -1                     TO DC-ELAPSED-MONTHS.
  7440     MOVE +0                     TO DC-ELAPSED-DAYS.
  7441     MOVE '6'                    TO DC-OPTION-CODE.
  7442     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
  7443
  7444     IF NO-CONVERSION-ERROR
  7445        MOVE DC-GREG-DATE-CYMD   TO OB-RUN-DATES (1).
  7446
  7447     MOVE DC-BIN-DATE-2          TO DC-BIN-DATE-1.
  7448     MOVE -1                     TO DC-ELAPSED-MONTHS.
  7449     MOVE +0                     TO DC-ELAPSED-DAYS.
  7450     MOVE '6'                    TO DC-OPTION-CODE.
  7451     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
  7452
  7453     IF NO-CONVERSION-ERROR
  7454        MOVE DC-GREG-DATE-CYMD   TO OB-RUN-DATES (2).
  7455
  7456     MOVE +0                     TO DC-ELAPSED-MONTHS
  7457                                    DC-ELAPSED-DAYS.
  7458
  7459     MOVE SPACES                 TO CERTIFICATE-RECORD.
  7460     MOVE 'CR'                   TO CR-RECORD-ID.
  7461     MOVE ZEROS                  TO
  7462               CR-AGE                  CR-JOINT-AGE
  7463               CR-LFTYP                CR-AHTYP
  7464               CR-LF-TERM              CR-AH-TERM
  7465               CR-LF-CRIT-PERIOD       CR-AH-CRIT-PERIOD
  7466               CR-LF-TERM-IN-DAYS
  7467               CR-LF-DEV-PCT           CR-AH-DEV-PCT
  7468               CR-LFAMT                CR-AHAMT
  7469               CR-LFPRM                CR-AHPRM
  7470               CR-LF-POLICY-FEE        CR-AH-POLICY-FEE
  7471               CR-LFPRM-CALC           CR-AHPRM-CALC
  7472               CR-LFPRM-RATE           CR-AHPRM-RATE
  7473               CR-LFAMT-ALT
  7474               CR-LFPRM-ALT            CR-ISS-MICROFILM-NO
*  12-S*********************************************************       (   0)**
**    Operand CR-ISS-MICROFILM-NO is not declared
  7475               CR-LFPRM-CALC-ALT       CR-CAN-MICROFILM-NO
  7476               CR-LFPRM-RATE-ALT
  7477               CR-LFRFND               CR-AHRFND
  7478               CR-LFRFND-CALC          CR-AHRFND-CALC
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 147
* ECS010Z.cbl
  7479               CR-LF-NSP-PRM           CR-AH-NSP-PRM
  7480               CR-LF-NSP-PRM-RATE      CR-AH-NSP-PRM-RATE
  7481               CR-LF-REI-RISK-PRM      CR-AH-REI-RISK-PRM
  7482               CR-LF-EXPIRE-DATE       CR-AH-EXPIRE-DATE
  7483               CR-LIVES                CR-APR
  7484               CR-BILLED
  7485               CR-LF-ISS-PREM-TAX      CR-AH-ISS-PREM-TAX
  7486               CR-LF-CNC-PREM-TAX      CR-AH-CNC-PREM-TAX
  7487               CR-PMT-FREQ             CR-LOAN-TERM
  7488               CR-SKIP                 CR-LOAN-1ST-PMT-DT
  7489               CR-SUM-CAN-CNT-ITD      CR-SUM-CAN-CNT-YTD
  7490               CR-PMT-EXTENSION-DAYS   CR-ENTRY-DATE
  7491               CR-LF-CANC-DT           CR-AH-CANC-DT
  7492               CR-LF-CANCEL-EXIT-DATE  CR-AH-CANCEL-EXIT-DATE
  7493               CR-LF-CLAIM-EXIT-DATE   CR-AH-SETTLEMENT-EXIT-DATE
  7494               CR-NUM-DTH-CLM          CR-NUM-DIS-CLM
  7495               CR-DTH-DT               CR-DIS-DT
  7496               CR-DTH-RPT-DT           CR-DIS-RPT-DT
  7497               CR-DTH-PAY-DT           CR-DIS-PAY-DT
  7498                                       CR-DIS-PTO-DT
  7499               CR-DTHAMT               CR-DISAMT
  7500               CR-DTHAMT-YTD           CR-DISAMT-YTD
  7501               CR-DTHAMT-LAST          CR-DISAMT-LAST
  7502               CR-DTHEXP               CR-DISEXP
  7503               CR-DTHEXP-YTD           CR-DISEXP-YTD
  7504               CR-DTH-AGE              CR-DAYS-DISAB
  7505               CR-DIS-INCUR-DT (1)     CR-CLAIM-DEDUCT-WITHHELD
  7506               CR-INCUR-DISAMT (1)     CR-CANCEL-DEDUCT-WITHHELD
  7507               CR-INCUR-DISEXP (1)     CR-REMIT-TO
  7508               CR-CANCEL-STATE-TAX     CR-CANCEL-MUNI-TAX.
  7509
  7510     MOVE CR-DISAB-DETAIL-DATA (1)  TO CR-DISAB-DETAIL-DATA (2)
  7511                                       CR-DISAB-DETAIL-DATA (3)
  7512                                       CR-DISAB-DETAIL-DATA (4)
  7513                                       CR-DISAB-DETAIL-DATA (5).
  7514
  7515     MOVE CERTIFICATE-RECORD     TO INITIALIZED-CERTIFICATE.
  7516
  7517     MOVE LOW-VALUES   TO ACCOUNT-MASTER   CERTIFICATE-RECORD.
  7518
  7519     MOVE HIGH-VALUES  TO REIN-HOLD-AREAS  RC-REIN-HOLD-AREAS
  7520                          EPEC-TOTALS      EPEC-SUBS
  7521                          EPEC-UNDERWRITTEN-TOTALS.
  7522
  7523     MOVE ZEROS        TO EPEC-LEVELS-END  EPEC-SUBS-END
  7524                          EPEC-LEVELS-END-II.
  7525     MOVE SPACES       TO REIN-LEVELS-END  RC-REIN-LEVELS-END
  7526                          DUPE-CERT-TABLE.
  7527
  7528     PERFORM CLEAR-REIN-HOLD        THRU CLEAR-REIN-HOLD-X.
  7529     PERFORM 4550-CLEAR-EPEC-TOTALS THRU 4589-CLEAR-EPEC-TOTALS-X.
  7530     PERFORM 5900-CLEAR-TOTAL-PAGES THRU 5999-CLEAR-TOTAL-PAGES-X
  7531                VARYING SUB6 FROM 1 BY 1 UNTIL SUB6 GREATER 6.
  7532     PERFORM 7900-CLEAR-BILLING-TABLE THRU 7999-CLEAR-BILLING-X
  7533                VARYING B-SUB FROM 1 BY 1 UNTIL B-SUB GREATER 50.
  7534
  7535     IF RUN-DATE NOT = EP-DT
  7536         MOVE '*'                     TO TR-YRASK.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 148
* ECS010Z.cbl
  7537     MOVE LIFE-OVERRIDE-L6            TO TR-7-LF.
  7538     MOVE LIFE-OVERRIDE-L2            TO DET-LF-DESC.
  7539     MOVE AH-OVERRIDE-L6              TO TR-7-AH.
  7540     MOVE AH-OVERRIDE-L2              TO DET-AH-DESC.
  7541
  7542     IF DTE-CLIENT = 'FIA' OR 'TAO' OR 'PEK'
  7543         MOVE +1000                   TO DUP-MAX.
  7544
  7545     MOVE DTE-CLIENT                  TO ME-COMPANY.
  7546     MOVE MONTH-END-MOYR              TO ME-MOYR.
  7547     IF ME-DO-UPDATE
  7548         READ ERMEBL-INOUT INVALID KEY
  7549                       CLOSE ERMEBL-INOUT
  7550                       MOVE 'N'       TO ME-UPDATE-FLAG.
  7551
  7552     GO TO 0150-READ-ACCOUNT-MASTER.
  7553
  7554 0090-EXIT.
  7555     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 149
* ECS010Z.cbl
  7557 0095-GET-EOM-DATES.
  7558
  7559     MOVE W-WORK-DATE            TO DC-BIN-DATE-1.
  7560     MOVE '6'                    TO DC-OPTION-CODE.
  7561     MOVE 1                      TO DC-ELAPSED-MONTHS
  7562                                    DC-END-OF-MONTH.
  7563     MOVE ZEROS                  TO DC-ELAPSED-DAYS.
  7564     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
  7565
  7566     IF  DC-ERROR-CODE NOT EQUAL SPACES
  7567         MOVE '**** EOM PLUS 1 DATE CALC ERROR ****'
  7568                                 TO WS-ABEND-MESSAGE
  7569         MOVE '90'               TO ABEND-CODE-1
  7570         MOVE '0'                TO AC2-ONE
  7571         MOVE DC-ERROR-CODE      TO AC2-TWO
  7572         MOVE WS-ABEND-CODE      TO WS-RETURN-CODE
  7573         GO TO ABEND-PGM.
  7574
  7575     MOVE DC-BIN-DATE-2          TO  W-WORK-DATE
  7576                                     DC-BIN-DATE-1.
  7577     MOVE SPACES                 TO  DC-BIN-DATE-2.
  7578     MOVE ' '                    TO  DC-OPTION-CODE.
  7579     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
  7580
  7581     IF  DC-ERROR-CODE NOT EQUAL SPACES
  7582         MOVE '**** YMD EOM DATE CALC ERROR ****'
  7583                                 TO WS-ABEND-MESSAGE
  7584         MOVE '90'               TO ABEND-CODE-1
  7585         MOVE '0'                TO AC2-ONE
  7586         MOVE DC-ERROR-CODE      TO AC2-TWO
  7587         MOVE WS-ABEND-CODE      TO WS-RETURN-CODE
  7588         GO TO ABEND-PGM.
  7589
  7590     MOVE DC-GREG-DATE-CYMD      TO  EOM-DATE (SUBM).
  7591
  7592 0095-EXIT.
  7593     EXIT.
  7594
  7595 0096-DISPLAY-EOM-DATES.
  7596
  7597     DISPLAY SUBM '. ' EOM-DATE (SUBM).
  7598
  7599 0096-EXIT.
  7600     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 150
* ECS010Z.cbl
  7602******************************************************************
  7603***    R E A D   A C C O U N T   M A S T E R   R O U T I N E   ***
  7604******************************************************************
  7605
  7606 0100-ACCT-MASTER-READ-ROUTINE.
  7607
  7608     IF EP-FLG = '1'
  7609         ADD +1 TO BC-ACT-ACCTS
  7610         IF  DTE-OPT-RESERVE-METHOD-AUTH
  7611             PERFORM 4700-CALC-OPT-IBNR THRU 4700-EXIT
  7612             PERFORM 4500-BUILD-EPEC-EXTRACT
  7613                                  THRU 4599-BUILD-EPEC-EXTRACT-X
  7614         ELSE
  7615             PERFORM 4500-BUILD-EPEC-EXTRACT
  7616                                  THRU 4599-BUILD-EPEC-EXTRACT-X.
  7617
  7618     IF TRANSACTION-WAS-PROCESSED
  7619         MOVE '1'                     TO ACCT-FLG
  7620                                         STATE-FLG
  7621                                         COMP-FLG
  7622                                         CARR-FLG
  7623                                         FINAL-FLG.
  7624
  7625 0150-READ-ACCOUNT-MASTER.
  7626
  7627     READ ERACCTT-IN AT END
  7628         GO TO 9930-EOJ-3.
  7629
  7630     ADD +1                            TO ERACCTT-READS.
  7631
* 7632     COPY ELCACCTI.
  7633******************************************************************04/14/98
  7634*                                                                *ELCACCTI
  7635*                            ELCACCTI                            *   LV003
  7636*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
  7637*                            VMOD=2.001                          *ELCACCTI
  7638*                                                                *ELCACCTI
  7639*   COPY FILE VARIABLES TO WORKING STORAGE                       *ELCACCTI
  7640*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCACCTI
  7641*                                                                *ELCACCTI
  7642*  NO  CID  MODS  IN  COPYBOOK  ELCACCTI                         *ELCACCTI
  7643*                                                                *ELCACCTI
  7644******************************************************************ELCACCTI
  7645     MOVE AM-EXPIRE-DT           TO  WS-AM-EXPIRE-DT-N.              CL**2
  7646     MOVE AM-VG-EXP-DATE         TO  WS-AM-VG-EXP-DATE-N.            CL**2
  7647     MOVE AM-EFFECT-DT           TO  WS-AM-EFFECT-DT-N.              CL**2
  7648     MOVE AM-PREV-EXP-DT         TO  WS-AM-PREV-EXP-DT-N.            CL**2
  7649     MOVE AM-PREV-EFF-DT         TO  WS-AM-PREV-EFF-DT-N             CL**2
  7650     MOVE AM-ANNIVERSARY-DATE    TO  WS-AM-ANNIVERSARY-DATE-N.       CL**2
  7651     MOVE AM-HI-CERT-DATE        TO  WS-AM-HI-CERT-DATE-N.           CL**2
  7652     MOVE AM-LO-CERT-DATE        TO  WS-AM-LO-CERT-DATE-N.           CL**2
  7653     MOVE AM-ENTRY-DATE          TO  WS-AM-ENTRY-DATE-N.             CL**2
  7654
  7655     IF FIRST-ACCOUNT EQUAL +1
  7656        MOVE +0                  TO FIRST-ACCOUNT
  7657        GO TO 0190-PROCESS-NEW-ACCOUNT.
  7658
  7659     IF AM-CARRIER NOT = HLD-CARRIER
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 151
* ECS010Z.cbl
  7660         PERFORM 5400-CARR-BREAK THRU 5499-CARR-BREAK-X
  7661     ELSE
  7662     IF AM-GROUPING NOT = HLD-GROUPING
  7663         PERFORM 5300-COMP-BREAK THRU 5399-COMP-BREAK-X
  7664     ELSE
  7665     IF AM-STATE NOT = HLD-STATE
  7666         PERFORM 5200-STATE-BREAK THRU 5299-STATE-BREAK-X
  7667     ELSE
  7668     IF AM-ACCOUNT NOT = HLD-ACCT
  7669         PERFORM 5100-ACCOUNT-BREAK THRU 5199-ACCOUNT-BREAK-X
  7670     ELSE
  7671     PERFORM 5000-DATE-RANGE-BREAK THRU 5099-DATE-RANGE-BREAK-X.
  7672
  7673     IF (AM-CARRIER NOT = HLD-CARRIER) OR
  7674        (AM-GROUPING NOT = HLD-GROUPING)
  7675         PERFORM 7000-CLIENT-BILLING-ROUTINE THRU 7099-BILL-X.
  7676
  7677 0190-PROCESS-NEW-ACCOUNT.
  7678
  7679     IF AM-CARRIER NOT = HLD-CARRIER
  7680         PERFORM 0199A-CARRIER-TABLE-LOOKUP THRU 0199A-LOOKUP-XIT.
  7681
  7682     MOVE AM-CONTROL-A          TO HLD-CONTROL.
  7683     MOVE AM-CARRIER            TO TR-CARR.
  7684     MOVE AM-GROUPING           TO TR-GROUP.
  7685     MOVE AM-ACCOUNT            TO TR-AG-NO.
  7686     MOVE AM-NAME               TO TR-AGCY.
  7687     MOVE AM-EFF-MO             TO TR-CE-MO.
  7688     MOVE AM-EFF-DA             TO TR-CE-DA.
  7689     MOVE AM-EFF-YR             TO TR-CE-YR.
  7690     MOVE AM-STATE              TO TR-ST-NO.
  7691     IF AM-EXPIRE-DT =  99999999999
  7692         MOVE 'CURRENT '        TO TR-CX
  7693     ELSE
  7694         MOVE AM-EXP-MO         TO TR-CX-MO
  7695         MOVE AM-EXP-DA         TO TR-CX-DA
  7696         MOVE AM-EXP-YR         TO TR-CX-YR
  7697         MOVE '-'               TO HSHR1  HSHR2.
  7698
  7699     ADD +1 TO BC-ACCTS.
  7700
  7701     IF AM-RECORD-ID = '**'
  7702         ADD +1 TO BC-NEW-ACCTS.
  7703     IF AM-RET-Y-N = 'Y' OR 'I' OR 'G' OR 'L' OR 'D'
  7704         ADD +1 TO BC-ER-ACCTS.
  7705
  7706     MOVE ZEROS                 TO SV-LO-CERT
  7707                                   SV-HI-CERT.
  7708     MOVE SPACE                 TO TRANSACTION-FLAG
  7709                                   LST-TRD-CERT
  7710                                   LST-TRD-ISDT
  7711                                   OB-DATE-1-SWITCH
  7712                                   OB-DATE-2-SWITCH
  7713                                   OB-DATE-3-SWITCH.
  7714     MOVE +81                   TO LN-CNT.
  7715
  7716 0199-READ-ACCOUNT-X.
  7717     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 152
* ECS010Z.cbl
  7718
  7719 0199A-CARRIER-TABLE-LOOKUP.
  7720
  7721     PERFORM 0199B-SEARCH-CARRIER-TABLE
  7722            VARYING CLAS-INDEXCN FROM 1 BY 1
  7723         UNTIL AM-CARRIER = CARRIER-SUB (CLAS-INDEXCN)  OR
  7724               CLAS-INDEXCN GREATER CLAS-MAXCN.
  7725
  7726     IF CLAS-INDEXCN GREATER CLAS-MAXCN
  7727         DISPLAY 'CARRIER NOT IN CARRIER NAME TABLE: ' AM-CARRIER
  7728         MOVE '** CARRIER NOT IN CARRIER NAME TABLE **'
  7729                                 TO WS-ABEND-MESSAGE
  7730         MOVE 4004               TO WS-ABEND-CODE
  7731         MOVE WS-ABEND-CODE      TO WS-RETURN-CODE
  7732         GO TO ABEND-PGM.
  7733
  7734 0199A-LOOKUP-XIT.
  7735     EXIT.
  7736 0199B-SEARCH-CARRIER-TABLE.
  7737     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 153
* ECS010Z.cbl
  7739******************************************************************
  7740***       R E A D   C E R T   M A S T E R   R O U T I N E      ***
  7741******************************************************************
  7742
  7743 0200-CERT-MASTER-READ-ROUTINE.
  7744
  7745     IF EOF-ON-CERT
  7746         GO TO 0299-READ-CERT-X.
  7747
  7748     IF FIRST-CERT EQUAL +1
  7749        MOVE +0                  TO FIRST-CERT
  7750        GO TO 0250-READ-CERT-MASTER.
  7751
  7752     MOVE CERT-IN-RECORD             TO CERTIFICATE-RECORD.
  7753
  7754     PERFORM CERT-DATE-LOAD.
  7755
  7756     IF CR-IND-GRP = 'I'  OR  '1'
  7757         MOVE '1'                    TO CR-IND-GRP
  7758     ELSE
  7759         MOVE '2'                    TO CR-IND-GRP.
  7760
  7761     IF CR-LF-REI-RISK-PRM NOT NUMERIC
  7762         MOVE ZEROS                TO CR-LF-REI-RISK-PRM.
  7763     IF CR-AH-REI-RISK-PRM NOT NUMERIC
  7764         MOVE ZEROS                TO CR-AH-REI-RISK-PRM.
  7765
  7766************ TEMP CODE TO INITIALIZE RISK PREM FIELDS ************
  7767     IF DTE-CLIENT NOT = 'NSL'
  7768         MOVE ZEROS                TO CR-LF-REI-RISK-PRM
  7769                                      CR-AH-REI-RISK-PRM.
  7770******************************************************************
  7771
  7772     IF CR-CLAIM-DEDUCT-WITHHELD NOT NUMERIC
  7773         MOVE ZEROS                TO CR-CLAIM-DEDUCT-WITHHELD.
  7774     IF CR-CANCEL-DEDUCT-WITHHELD NOT NUMERIC
  7775         MOVE ZEROS                TO CR-CANCEL-DEDUCT-WITHHELD.
  7776
  7777     MOVE CR-STATE                   TO STATE-L.
  7778     PERFORM 8200-STATE-CODE-LOOKUP THRU 8299-STATE-LOOKUP-X.
  7779
  7780     IF CR-LFTYP NOT = ZERO
  7781         MOVE CR-LFTYP               TO CLAS-LOOK
  7782         PERFORM 8300-LIFE-TYPE-LOOKUP THRU 8399-LIFE-LOOKUP-X.
  7783
  7784     IF CR-AHTYP NOT = ZERO
  7785         MOVE CR-AHTYP               TO CLAS-LOOK
  7786         PERFORM 8400-A-H-TYPE-LOOKUP THRU 8499-A-H-LOOKUP-X.
  7787
  7788     IF RUN-MO NOT = 01
  7789         GO TO 0250-READ-CERT-MASTER.
  7790
  7791     MOVE ZERO                 TO CR-DTHAMT-YTD  CR-DISAMT-YTD
  7792                                  CR-DTHEXP-YTD  CR-DISEXP-YTD.
  7793
  7794     IF ((CR-LFTYP NOT = ZERO)  AND
  7795         (CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'Z'))  OR
  7796        ((CR-AHTYP NOT = ZERO)  AND
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 154
* ECS010Z.cbl
  7797         (CLAS-I-CALC-TYPE (CLAS-INDEXA) = 'Z'))
  7798           MOVE ZERO           TO CR-SUM-CAN-CNT-YTD.
  7799
  7800 0250-READ-CERT-MASTER.
  7801
  7802     READ CERT-MASTER-IN
  7803               AT END GO TO 9920-EOJ-2.
  7804
  7805     ADD +1 TO CMIN-CNT.
  7806
  7807     IF CIR-CONTROL LESS THAN PRIOR-CERT-IN-CNTRL
  7808         DISPLAY 'SEQUENCE ERROR ON CERT MASTER'
  7809         DISPLAY 'FIRST  - '  PRIOR-CERT-IN-CNTRL
  7810         DISPLAY 'SECOND - '  CIR-CONTROL
  7811         MOVE 0612                    TO WS-ABEND-CODE
  7812         MOVE WS-ABEND-CODE           TO WS-RETURN-CODE
  7813         GO TO ABEND-PGM.
  7814
  7815     IF CIR-CONTROL = PRIOR-CERT-IN-CNTRL
  7816         DISPLAY 'DUPLICATE CERT ON FILE'  PRIOR-CERT-IN-CNTRL
  7817         IF DTE-CLIENT EQUAL 'SEN'
  7818            GO TO 0250-READ-CERT-MASTER
  7819         ELSE
  7820            MOVE 'DUPLICATE CERT ON FILE'
  7821                                      TO WS-ABEND-MESSAGE
  7822            MOVE 0302                 TO WS-ABEND-CODE
  7823            MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
  7824            GO TO ABEND-PGM.
  7825
  7826******************************************************
  7827*   THIS LOGIC WAS ADDED TO ACCOMMODATE THE EXECUTION
  7828*   OF A "MID MONTH" BILLING REPORT (EL562) FOR
  7829*   COMMERCIAL FEDERAL BANK AND PEOPLES TRUST
  7830******************************************************
  7831     IF DTE-CLIENT = 'CID'
  7832        IF COMPANY-NAME = '      COMMERCIAL FEDERAL'
  7833           IF (CF-THIRD-AGENT  = '0000713100') OR
  7834              (CF-FOURTH-AGENT = '0000713100')
  7835              CONTINUE
  7836           ELSE
  7837              GO TO 0250-READ-CERT-MASTER
  7838           END-IF
  7839        ELSE
  7840           IF COMPANY-NAME = '        PEOPLES TRUST'
  7841              IF CI-ACCOUNT = '0000845800'
  7842                 CONTINUE
  7843              ELSE
  7844                 GO TO 0250-READ-CERT-MASTER
  7845              END-IF
  7846           ELSE
  7847              IF COMPANY-NAME = '        SUNFLOWER BANK'
  7848                 IF (CF-THIRD-AGENT  = '0000681700') OR
  7849                    (CF-FOURTH-AGENT = '0000681700')
  7850                    CONTINUE
  7851                 ELSE
  7852                    GO TO 0250-READ-CERT-MASTER
  7853                 END-IF
  7854              END-IF
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 155
* ECS010Z.cbl
  7855           END-IF
  7856        END-IF
  7857     END-IF
  7858
  7859******************************************************
  7860     MOVE CIR-CONTROL                 TO PRIOR-CERT-IN-CNTRL.
  7861
  7862 0299-READ-CERT-X.
  7863     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 156
* ECS010Z.cbl
  7865******************************************************************
  7866***     R E A D   P E N D I N G   F I L E   R O U T I N E      ***
  7867******************************************************************
  7868
  7869 0300-READ-PENDING-TRANSACTIONS.
  7870
  7871     READ PENDING-EXTRACT
  7872                   AT END GO TO 9910-EOJ-1.
  7873
  7874     MOVE SPACE                    TO PENDING-RECORD-TYPE.
  7875
  7876     IF NOT ED-PENDING-BUSINESS  AND
  7877        NOT ED-PENDING-CLAIMS  AND
  7878        NOT ED-CERT-CHANGES
  7879           DISPLAY 'INVALID EXTRACT TYPE INTO ECS010 - TYPE = '
  7880                                               ED-RECORD-TYPE
  7881           MOVE 0301                        TO WS-ABEND-CODE
  7882           MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
  7883           GO TO ABEND-PGM.
  7884
  7885     PERFORM 0310-SET-UP-MATCHING-KEY THRU 0310-EXIT.
  7886
  7887     IF DTE-CLIENT = 'NCL'
  7888         IF PEND-MATCH-EFF-DTE LESS THAN 19400101
  7889             DISPLAY 'TRANS DROPPED: ' PENDING-MATCH-CONTROL
  7890                     '  TRANS TYPE: ' PENDING-RECORD-TYPE
  7891             GO TO 0300-READ-PENDING-TRANSACTIONS.
  7892
  7893     IF PENDING-MATCH-CONTROL  LESS THAN  PRIOR-MATCH-CNTRL
  7894         DISPLAY 'SEQUENCE ERROR ON TRANSACTION FILE'
  7895         DISPLAY ' PRIOR SEQ.   = '  PRIOR-MATCH-CNTRL
  7896         DISPLAY ' CURRENT SEQ. = '  PENDING-MATCH-CONTROL
  7897         MOVE 0603                    TO WS-ABEND-CODE
  7898         MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
  7899         GO TO ABEND-PGM.
  7900
  7901     ADD +1 TO TR-CNT.
  7902
  7903     IF ISSUE-TRANSACTION   OR
  7904        CANCEL-TRANSACTION  OR
  7905        CLAIM-TRANSACTION   OR
  7906        RESERVE-TRANSACTION OR
  7907        UPDATE-TRANSACTION
  7908         MOVE PENDING-MATCH-CONTROL   TO PRIOR-MATCH-CNTRL
  7909         GO TO 0330-MATCH-PENDING-TO-CERT.
  7910
  7911     DISPLAY 'INVALID TRANSACTION INTO ECS010 '.
  7912
  7913     DISPLAY 'INVALID TRANSACTION INTO ECS010 '.
  7914     DISPLAY '  MATCH CONTROL: ' PENDING-MATCH-CONTROL ' TYPE: ('
  7915             PENDING-RECORD-TYPE ')'.
  7916
  7917     MOVE 0301                   TO WS-ABEND-CODE.
  7918     MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
  7919     GO TO ABEND-PGM.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 157
* ECS010Z.cbl
  7921 0310-SET-UP-MATCHING-KEY.
  7922
  7923     IF ED-PENDING-BUSINESS
  7924         MOVE ED-DATA-AREAS      TO PENDING-BUSINESS
  7925         MOVE PB-CARRIER         TO PEND-MATCH-CARRIER
  7926         MOVE PB-GROUPING        TO PEND-MATCH-GROUPING
  7927         MOVE PB-STATE           TO PEND-MATCH-STATE
  7928         MOVE PB-ACCOUNT         TO PEND-MATCH-ACCOUNT
  7929         MOVE PB-CERT-EFF-DT     TO DC-BIN-DATE-1
  7930         MOVE PB-CERT-NO         TO PEND-MATCH-CERT-NO
  7931         MOVE PB-RECORD-TYPE     TO PENDING-RECORD-TYPE.
  7932
  7933     IF ED-PENDING-CLAIMS
  7934         ADD +1                  TO W-PENDING-CLMS
  7935         MOVE ED-DATA-AREAS      TO PENDING-CLAIMS
  7936         MOVE PC-CARRIER         TO PEND-MATCH-CARRIER
  7937         MOVE PC-GROUPING        TO PEND-MATCH-GROUPING
  7938         MOVE PC-STATE           TO PEND-MATCH-STATE
  7939         MOVE PC-ACCOUNT         TO PEND-MATCH-ACCOUNT
  7940         MOVE PC-CERT-EFF-DT     TO DC-BIN-DATE-1
  7941         MOVE PC-CERT-NO         TO PEND-MATCH-CERT-NO
  7942         IF PC-CLAIMS
  7943             MOVE '3'            TO PENDING-RECORD-TYPE
  7944         ELSE
  7945             IF PC-RESERVES
  7946                 MOVE '4'        TO PENDING-RECORD-TYPE.
  7947
  7948     IF ED-CERT-CHANGES
  7949         MOVE ED-DATA-AREAS      TO PENDING-MAINT-TO-CERT-FILE
  7950         MOVE CC-CARRIER         TO PEND-MATCH-CARRIER
  7951         MOVE CC-GROUPING        TO PEND-MATCH-GROUPING
  7952         MOVE CC-STATE           TO PEND-MATCH-STATE
  7953         MOVE CC-ACCOUNT         TO PEND-MATCH-ACCOUNT
  7954         MOVE CC-CERT-EFF-DT     TO DC-BIN-DATE-1
  7955         MOVE CC-CERT-NO         TO PEND-MATCH-CERT-NO
  7956         MOVE '5'                TO PENDING-RECORD-TYPE.
  7957
  7958     MOVE ' '                    TO DC-OPTION-CODE.
  7959     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
  7960     MOVE DC-GREG-DATE-CYMD      TO PEND-MATCH-EFF-DTE.
  7961
  7962 0310-EXIT.
  7963     EXIT.
  7964
  7965******************************************************************
  7966***    M A T C H   P E N D I N G   F I L E   T O   C E R T     ***
  7967******************************************************************
  7968
  7969 0330-MATCH-PENDING-TO-CERT.
  7970
  7971     IF PENDING-MATCH-CONTROL  LESS THAN  CR-FULL-CONTROL
  7972         GO TO 0390-CERT-MISMATCH-ERROR.
  7973
  7974     IF PENDING-MATCH-CONTROL  EQUAL   CR-FULL-CONTROL
  7975       IF CLAIM-TRANSACTION
  7976         IF NOT PC-CHARGEBLE-EXPENSE  AND
  7977            NOT PC-NON-CHARGEBLE-EXPENSE
  7978             IF ((PC-CLAIM-TYPE = '1' OR '3') AND CR-LFTYP = '00')
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 158
* ECS010Z.cbl
  7979                                      OR
  7980                ((PC-CLAIM-TYPE = '2' OR '4') AND CR-AHTYP = '00')
  7981                  GO TO 0390-CERT-MISMATCH-ERROR.
  7982
  7983     IF PENDING-MATCH-CONTROL  EQUAL   CR-FULL-CONTROL
  7984       IF RESERVE-TRANSACTION
  7985         IF ((PC-CLAIM-TYPE = '1' OR '3') AND CR-LFTYP = '00')
  7986                                  OR
  7987            ((PC-CLAIM-TYPE = '2' OR '4') AND CR-AHTYP = '00')
  7988              GO TO 0390-CERT-MISMATCH-ERROR.
  7989
  7990     IF PENDING-MATCH-CONTROL  EQUAL   CR-FULL-CONTROL
  7991         IF ISSUE-TRANSACTION
  7992             GO TO 0380-DUPLICATE-CERT-ERROR
  7993         ELSE
  7994             GO TO 0350-MATCH-PENDING-TO-ACCOUNT.
  7995
  7996     IF PENDING-MATCH-CONTROL  NOT LESS THAN  CIR-CONTROL
  7997         PERFORM 0400-WRITE-CERT-RECORD THRU 0499-WRITE-CERT-X
  7998         PERFORM 0200-CERT-MASTER-READ-ROUTINE THRU
  7999                                               0299-READ-CERT-X
  8000         GO TO 0330-MATCH-PENDING-TO-CERT.
  8001
  8002     IF ISSUE-TRANSACTION
  8003         PERFORM 0400-WRITE-CERT-RECORD THRU 0499-WRITE-CERT-X
  8004     ELSE
  8005         GO TO 0390-CERT-MISMATCH-ERROR.
  8006
  8007 0350-MATCH-PENDING-TO-ACCOUNT.
  8008
  8009     IF PENDING-ACCOUNT-CONTROL LESS THAN AM-CONTROL-A
  8010       ADD +1  TO ERROR-COUNT
  8011         MOVE    '*** MISMATCH BETWEEN PENDING TRAN AND ACCOUNT'
  8012           TO  DL-FULL
  8013             PERFORM 8600-DISPLAY-PRT  THRU  8600-DISPLAY-EXIT
  8014         MOVE    ' PENDING CONTROL = '
  8015           TO  DIS-LINE-REASON
  8016         MOVE  PENDING-MATCH-CONTROL
  8017           TO  DIS-LINE-REC
  8018             PERFORM 8600-DISPLAY-PRT  THRU  8600-DISPLAY-EXIT
  8019         MOVE    ' KEY OF PENDING REC BYPASSED - '
  8020           TO  DIS-LINE-REASON
  8021         MOVE  PENDING-MATCH-CONTROL
  8022           TO  DIS-LINE-REC
  8023             PERFORM 8600-DISPLAY-PRT  THRU  8600-DISPLAY-EXIT
  8024         MOVE  SPACES
  8025           TO  DISPLAY-LINE
  8026             PERFORM 8600-DISPLAY-PRT  THRU  8600-DISPLAY-EXIT
  8028         DISPLAY '*** MISMATCH BETWEEN PENDING TRAN AND ACCOUNT'
  8029         DISPLAY '    PENDING CONTROL = ' PENDING-MATCH-CONTROL
  8030         DISPLAY 'PENDING REC BYPASSED - ' PENDING-MATCH-CONTROL
  8031         DISPLAY 'TRAN TYPE =   '  PENDING-RECORD-TYPE
  8032         DISPLAY '  TYPE  1=ISS   2=CAN   3=CLM   4=RSV   5=CHG'
  8033         DISPLAY '    ACCOUNT CONTROL = '
  8034         AM-MSTR-CNTRL AM-EFFECT-DT
  8035         IF DTE-CLIENT = 'UAL'  OR  'NCL' OR 'CID'
  8036            DISPLAY 'TRANS BYPASSED.... CLIENT = ' DTE-CLIENT
  8037            GO TO 0300-READ-PENDING-TRANSACTIONS
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 159
* ECS010Z.cbl
  8038         ELSE
  8039            MOVE 'MISMATCH BETWEEN PENDING TRAN AND ACCOUNT'
  8040                                      TO WS-ABEND-MESSAGE
  8041            MOVE 0302 TO WS-ABEND-CODE
  8042            MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
  8043            GO TO ABEND-PGM.
  8044
  8045     IF PENDING-ACCOUNT-CONTROL GREATER AM-CONTROL-A
  8046         PERFORM 0100-ACCT-MASTER-READ-ROUTINE THRU
  8047                                              0199-READ-ACCOUNT-X
  8048         GO TO 0350-MATCH-PENDING-TO-ACCOUNT.
  8049
  8050     IF PEND-MATCH-EFF-DTE NOT LESS THAN AM-EFFECT-DT  AND
  8051        PEND-MATCH-EFF-DTE LESS THAN AM-EXPIRE-DT
  8052         GO TO 0500-APPLY-PENDING-BUSINESS.
  8053
  8054     PERFORM 0100-ACCT-MASTER-READ-ROUTINE THRU
  8055                                       0199-READ-ACCOUNT-X.
  8056     GO TO 0350-MATCH-PENDING-TO-ACCOUNT.
  8057
  8058
  8059 0370-ACCOUNT-MISMATCH-ERROR.
  8060
  8061     DISPLAY 'MISMATCH ACCOUNT ERROR'
  8062     DISPLAY '    ACCOUNT CONTROL = ' AM-MSTR-CNTRL AM-EFFECT-DT.
  8063     MOVE 'MISMATCH ACCOUNT ERROR'
  8064                               TO WS-ABEND-MESSAGE.
  8065     MOVE 0302 TO WS-ABEND-CODE.
  8066         DISPLAY '******************************'
  8067         DISPLAY '***** ERROR LOCATION 009 *****'
  8068         DISPLAY '******************************'
  8069     MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
  8070     GO TO ABEND-PGM.
  8071
  8072
  8073 0380-DUPLICATE-CERT-ERROR.
  8074
  8075     IF PB-I-OB  OR  PB-I-SUMMARY
  8076         GO TO 0300-READ-PENDING-TRANSACTIONS.
  8077
  8078     ADD +1 TO DUP-CNT.
  8079
  8080     IF DUP-CNT NOT GREATER THAN DUP-MAX
  8081         MOVE CR-FULL-CONTROL           TO DUPE-ENTRY (DUP-CNT)
  8082         COMPUTE DUPE-LF-PRM (DUP-CNT) = PB-I-LF-PREMIUM-AMT +
  8083                                         PB-I-LF-ALT-PREMIUM-AMT
  8084         MOVE  PB-I-AH-PREMIUM-AMT      TO  DUPE-AH-PRM (DUP-CNT)
  8085         MOVE  PB-I-ENTRY-STATUS        TO  DUPE-STATUS (DUP-CNT)
  8086         GO TO 0300-READ-PENDING-TRANSACTIONS.
  8087
  8088     DISPLAY 'MORE THAN ' DUP-MAX ' DUPLICATE ISSUES PROCESSED'.
  8089     GO TO 0300-READ-PENDING-TRANSACTIONS.
  8090
  8091*    MOVE 0301 TO WS-ABEND-CODE.
  8092*    MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
  8093*    GO TO ABEND-PGM.
  8094
  8095
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 160
* ECS010Z.cbl
  8096 0390-CERT-MISMATCH-ERROR.
  8097
  8098     IF ISSUE-TRANSACTION  OR
  8099        CANCEL-TRANSACTION  OR
  8100        CLAIM-TRANSACTION
  8101         ADD +1                  TO  MISMATCH-COUNT.
  8102
  8103     IF DTE-CLIENT  =  'CID'  OR  'CSO'
  8104       ADD  +1  TO  ERROR-COUNT
  8105         MOVE    '*** MISMATCH BETWEEN CERT AND TRANS'
  8106           TO  DL-FULL
  8107             PERFORM 8600-DISPLAY-PRT  THRU  8600-DISPLAY-EXIT
  8108         MOVE    ' TRANS CONTROL = '
  8109           TO  DIS-LINE-REASON
  8110         MOVE  PENDING-MATCH-CONTROL
  8111           TO  DIS-LINE-REC
  8112             PERFORM 8600-DISPLAY-PRT  THRU  8600-DISPLAY-EXIT
  8113         MOVE    ' TRANS TYPE    = '
  8114           TO  DIS-LINE-REASON
  8115         MOVE  PENDING-RECORD-TYPE
  8116           TO  DIS-LINE-REC
  8117             PERFORM 8600-DISPLAY-PRT  THRU  8600-DISPLAY-EXIT
  8118         MOVE '  TYPE: 1=ISS   2=CAN   3=CLM   4=RSV   5=CHG'
  8119           TO  DL-FULL
  8120             PERFORM 8600-DISPLAY-PRT  THRU  8600-DISPLAY-EXIT
  8121         MOVE    ' CERT IN CTL   = '
  8122           TO  DIS-LINE-REASON
  8123         MOVE  CIR-CONTROL
  8124           TO  DIS-LINE-REC
  8125             PERFORM 8600-DISPLAY-PRT  THRU  8600-DISPLAY-EXIT
  8126         MOVE    ' BYPASSED TRANS  = '
  8127           TO  DIS-LINE-REASON
  8128         MOVE  PENDING-MATCH-CONTROL
  8129           TO  DIS-LINE-REC
  8130             PERFORM 8600-DISPLAY-PRT  THRU  8600-DISPLAY-EXIT
  8131         MOVE  SPACES
  8132           TO  DISPLAY-LINE
  8133             PERFORM 8600-DISPLAY-PRT  THRU  8600-DISPLAY-EXIT
  8134         DISPLAY 'BYPASSED TRANS = ' PENDING-MATCH-CONTROL.
  8135
  8136     MOVE PENDING-MATCH-CONTROL  TO  DTL-MATCH-CONTROL.
  8137     MOVE PENDING-RECORD-TYPE    TO  DTL-REC-TYPE.
  8138
  8139     IF ISSUE-TRANSACTION
  8140         MOVE 'ISS'              TO  DTL-REC-TYPE-DESC
  8141     ELSE
  8142         IF CANCEL-TRANSACTION
  8143             MOVE 'CAN'          TO  DTL-REC-TYPE-DESC
  8144         ELSE
  8145             IF CLAIM-TRANSACTION
  8146                 MOVE 'CLM'      TO  DTL-REC-TYPE-DESC
  8147             ELSE
  8148                 IF RESERVE-TRANSACTION
  8149                     MOVE 'RES'  TO  DTL-REC-TYPE-DESC
  8150                 ELSE
  8151                     IF UPDATE-TRANSACTION
  8152                         MOVE 'CHG'
  8153                                 TO  DTL-REC-TYPE-DESC.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 161
* ECS010Z.cbl
  8154
  8155     MOVE CIR-CONTROL            TO  DTL-CERT-IN-CONTROL.
  8156     MOVE CR-FULL-CONTROL        TO  DTL-CERT-OUT-CONTROL.
  8157     MOVE 'DROPPED'              TO  DTL-STATUS.
  8158
  8159     IF ISSUE-TRANSACTION
  8160         MOVE PB-I-LF-PREMIUM-AMT
  8161                                 TO  MD2-LF-PREM
  8162         MOVE PB-I-LF-ALT-PREMIUM-AMT
  8163                                 TO  MD2-LF-ALT-PREM
  8164         MOVE PB-I-AH-PREMIUM-AMT
  8165                                 TO  MD2-AH-PREM
  8166         ADD PB-I-LF-PREMIUM-AMT TO W-MM-LF-PRM
  8167         ADD PB-I-LF-ALT-PREMIUM-AMT TO W-MM-LF-PRM
  8168         ADD PB-I-AH-PREMIUM-AMT TO W-MM-AH-PRM
  8169     ELSE
  8170         IF CANCEL-TRANSACTION
  8171             MOVE PB-C-LF-CANCEL-AMT
  8172                                 TO  MD3-LF-REFUND
  8173             MOVE PB-C-AH-CANCEL-AMT
  8174                                 TO  MD3-AH-REFUND
  8175             ADD PB-C-LF-CANCEL-AMT TO W-MM-LF-RFD
  8176             ADD PB-C-AH-CANCEL-AMT TO W-MM-AH-RFD
  8177         ELSE
  8178             IF CLAIM-TRANSACTION
  8179                 IF PC-LF-CLAIM  OR  PC-OB-LF-CLAIM
  8180                     MOVE PC-CLAIM-PAYMENT  TO MD4-LF-CLAIM
  8181                     MOVE ZEROS             TO MD4-AH-CLAIM
  8182                     ADD PC-CLAIM-PAYMENT TO W-MM-LF-CLM
  8183                 ELSE
  8184                     MOVE ZEROS             TO MD4-LF-CLAIM
  8185                     MOVE PC-CLAIM-PAYMENT  TO MD4-AH-CLAIM
  8186                     ADD PC-CLAIM-PAYMENT TO W-MM-AH-CLM.
  8187
  8188     IF  MISMATCH-LINE-COUNT GREATER THAN +56
  8189         ADD +1                  TO  MISMATCH-PAGE-NUMBER
  8190         MOVE MISMATCH-PAGE-NUMBER
  8191                                 TO  TR-PG
  8192         MOVE MISMATCH-HEADING-1 TO  MISMATCH-RPT
  8193         MOVE MR-CTL             TO  X
  8194         MOVE X TO LCP-ASA
  8195         PERFORM LCP-WRITE-POS-MISMATCH-RPT
  8196             THRU LCP-WRITE-END-MISMATCH-RPT
  8197         MOVE TR-HD-2            TO  MISMATCH-RPT
  8198         MOVE MR-CTL             TO  X
  8199         MOVE X TO LCP-ASA
  8200         PERFORM LCP-WRITE-POS-MISMATCH-RPT
  8201             THRU LCP-WRITE-END-MISMATCH-RPT
  8202         MOVE TR-HD-3            TO  MISMATCH-RPT
  8203         MOVE MR-CTL             TO  X
  8204         MOVE X TO LCP-ASA
  8205         PERFORM LCP-WRITE-POS-MISMATCH-RPT
  8206             THRU LCP-WRITE-END-MISMATCH-RPT
  8207         MOVE MISMATCH-HEADING-2 TO  MISMATCH-RPT
  8208         MOVE MR-CTL             TO  X
  8209         MOVE X TO LCP-ASA
  8210         PERFORM LCP-WRITE-POS-MISMATCH-RPT
  8211             THRU LCP-WRITE-END-MISMATCH-RPT
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 162
* ECS010Z.cbl
  8212         MOVE +6                 TO  MISMATCH-LINE-COUNT.
  8213
  8214     MOVE MISMATCH-DETAIL        TO  MISMATCH-RPT.
  8215     MOVE MR-CTL                 TO  X.
  8216     ADD +2                      TO  MISMATCH-LINE-COUNT.
  8217
  8218     MOVE X TO LCP-ASA
  8219     PERFORM LCP-WRITE-POS-MISMATCH-RPT
  8220         THRU LCP-WRITE-END-MISMATCH-RPT.
  8221
  8222     IF ISSUE-TRANSACTION
  8223         MOVE MISMATCH-DETAIL-2  TO  MISMATCH-RPT
  8224         MOVE MR-CTL             TO  X
  8225         ADD +1                  TO  MISMATCH-LINE-COUNT
  8226         MOVE X TO LCP-ASA
  8227         PERFORM LCP-WRITE-POS-MISMATCH-RPT
  8228             THRU LCP-WRITE-END-MISMATCH-RPT.
  8229
  8230     IF CANCEL-TRANSACTION
  8231         MOVE MISMATCH-DETAIL-3  TO  MISMATCH-RPT
  8232         MOVE MR-CTL             TO  X
  8233         ADD +1                  TO  MISMATCH-LINE-COUNT
  8234         MOVE X TO LCP-ASA
  8235         PERFORM LCP-WRITE-POS-MISMATCH-RPT
  8236             THRU LCP-WRITE-END-MISMATCH-RPT.
  8237
  8238     IF CLAIM-TRANSACTION
  8239         MOVE MISMATCH-DETAIL-4  TO  MISMATCH-RPT
  8240         MOVE MR-CTL             TO  X
  8241         ADD +1                  TO  MISMATCH-LINE-COUNT
  8242         MOVE X TO LCP-ASA
  8243         PERFORM LCP-WRITE-POS-MISMATCH-RPT
  8244             THRU LCP-WRITE-END-MISMATCH-RPT.
  8245
  8246     MOVE SPACES                 TO  MISMATCH-RPT.
  8247
  8248     GO TO 0300-READ-PENDING-TRANSACTIONS.
  8249
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 163
* ECS010Z.cbl
  8251******************************************************************
  8252***       W R I T E   C E R T I F I C A T E   R E C O R D      ***
  8253******************************************************************
  8254
  8255 0400-WRITE-CERT-RECORD.
  8256
  8257     IF CERTIFICATE-RECORD = LOW-VALUES
  8258         GO TO 0499-WRITE-CERT-X.
  8259
  8260     IF CR-ACCT-CONTROL LESS THAN AM-CONTROL-A
  8261         DISPLAY '*** MISMATCH BETWEEN CERT MASTER AND ACCOUNT'
  8262         DISPLAY '    CERT. CONTROL = ' CR-FULL-CONTROL
  8263         ADD  +1  TO  ERROR-COUNT
  8264         MOVE    '*** CERT ACCT LESS THAN TRANS ACCT'
  8265           TO  DL-FULL
  8266             PERFORM 8600-DISPLAY-PRT  THRU  8600-DISPLAY-EXIT
  8267         MOVE    ' CERT. CONTROL = '
  8268           TO  DIS-LINE-REASON
  8269         MOVE  CR-FULL-CONTROL
  8270           TO  DIS-LINE-REC
  8271             PERFORM 8600-DISPLAY-PRT  THRU  8600-DISPLAY-EXIT
  8272         MOVE  SPACES
  8273           TO  DISPLAY-LINE
  8274             PERFORM 8600-DISPLAY-PRT  THRU  8600-DISPLAY-EXIT
  8275            WRITE CERT-OUT-RECORD FROM CERTIFICATE-RECORD
  8276            ADD +1 TO CMOT-CNT
  8277            PERFORM 0200-CERT-MASTER-READ-ROUTINE
  8278               GO TO 0400-WRITE-CERT-RECORD.
  8279
  8280*          GO TO 0370-ACCOUNT-MISMATCH-ERROR.
  8281
  8282     IF CR-ACCT-CONTROL GREATER THAN AM-CONTROL-A
  8283         PERFORM 0100-ACCT-MASTER-READ-ROUTINE THRU
  8284                                              0199-READ-ACCOUNT-X
  8285         GO TO 0400-WRITE-CERT-RECORD.
  8286
  8287     IF CR-DT LESS THAN AM-EFFECT-DT  OR
  8288        CR-DT NOT LESS THAN AM-EXPIRE-DT
  8289         PERFORM 0100-ACCT-MASTER-READ-ROUTINE THRU
  8290                                              0199-READ-ACCOUNT-X
  8291         GO TO 0400-WRITE-CERT-RECORD.
  8292
  8293     PERFORM 3000-REINSURE-ROUTINE THRU 3099-REINSURE-ROUTINE-X.
  8294
  8295     IF CR-LFTYP = ZEROS  AND
  8296        CR-DTHEXP NOT = ZEROS
  8297         ADD +1                     TO W-LFTYP-99
  8298         MOVE '99'                  TO CR-LFTYP  CLAS-LOOK
  8299         PERFORM 8300-LIFE-TYPE-LOOKUP THRU 8399-LIFE-LOOKUP-X.
  8300
  8301     IF CR-AHTYP = ZEROS  AND
  8302        CR-DISEXP NOT = ZEROS
  8303         ADD +1                     TO W-AHTYP-99
  8304         MOVE '99'                  TO CR-AHTYP  CLAS-LOOK
  8305         PERFORM 8400-A-H-TYPE-LOOKUP THRU 8499-A-H-LOOKUP-X.
  8306
  8307     PERFORM 4000-EP-BUMP-RTN THRU 4099-EP-BUMP-RTN-X.
  8308
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 164
* ECS010Z.cbl
  8309     IF CR-LFTYP = '99'
  8310         MOVE '00'                  TO CR-LFTYP.
  8311     IF CR-AHTYP = '99'
  8312         MOVE '00'                  TO CR-AHTYP.
  8313
  8314     IF CR-ISS-MICROFILM-NO NOT NUMERIC
*  12-S**************************                                      ( 146)**
**    Operand CR-ISS-MICROFILM-NO is not declared
  8315         MOVE ZEROS                 TO CR-ISS-MICROFILM-NO.
*  12-S*********************************************************       ( 164)**
**    Operand CR-ISS-MICROFILM-NO is not declared
  8316
  8317     IF CR-CAN-MICROFILM-NO NOT NUMERIC
*  12-S**************************                                      ( 164)**
**    Operand CR-CAN-MICROFILM-NO is not declared
  8318         MOVE ZEROS                 TO CR-CAN-MICROFILM-NO.
*  12-S*********************************************************       ( 164)**
**    Operand CR-CAN-MICROFILM-NO is not declared
  8319
  8320     IF  CR-POLICY-IS-ACTIVE
  8321         ADD +1                  TO W-POLICY-ACTIVE-CTR
  8322         IF  CR-POLICY-IS-REISSUE
  8323             OR CR-POLICY-IS-MONTHLY
  8324             ADD +1              TO W-POLICY-REISSUE-CTR
  8325         ELSE
  8326             IF  CR-POLICY-IS-REIN-ONLY
  8327                 ADD +1          TO W-POLICY-REIN-CTR
  8328             ELSE
  8329                 NEXT SENTENCE
  8330     ELSE
  8331         ADD +1                  TO W-POLICY-INACTIVE-CTR.
  8332
  8333     IF CR-ENTRY-STATUS = '1' OR '3' OR '4' OR 'P'
  8334        PERFORM 2100-BUILD-ISSUE-EXTRACT
  8335                                 THRU 2199-BLD-ISSUE-X
  8336*                                THRU 2259-END-CANCEL-BUILD
  8337        PERFORM 3100-REINSURE-ISSUE THRU 3199-REINSURE-ISSUE-X
  8338        IF (CR-LFRFND > ZEROS)
  8339           OR (CR-AHRFND > ZEROS)
  8340           PERFORM 2200-BUILD-CANCEL-EXTRACT
  8341                                 THRU 2259-END-CANCEL-BUILD
  8342           PERFORM 3200-REINSURE-CANCEL
  8343                                 THRU 3299-REINSURE-CANCEL-X
  8344        END-IF
  8345     END-IF
  8346
  8347
  8348
  8349     IF DTE-PGM-OPT = '1'
  8350       IF REIN-IS-RISK-PREMIUM  AND
  8351          CR-ENTRY-DATE NOT = EOM-RUN-DATE
  8352         IF NOT CR-POLICY-IS-REISSUE  AND
  8353            NOT CR-POLICY-IS-DECLINED  AND
  8354            NOT CR-POLICY-IS-VOID
  8355            AND NOT CR-POLICY-IS-MONTHLY
  8356             MOVE '*'            TO RISK-PREM-FLAG
  8357             PERFORM 3100-REINSURE-ISSUE THRU
  8358                     3199-REINSURE-ISSUE-X.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 165
* ECS010Z.cbl
  8359
* 8360     COPY ELCCRTM2.
  8361******************************************************************04/16/98
  8362*                                                                *ELCCRTM2
  8363*                                                                *ELCCRTM2
  8364*                            ELCCRTM2                            *   LV004
  8365*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
  8366*                            VMOD=2.001                          *ELCCRTM2
  8367*                                                                *ELCCRTM2
  8368*   COPY WORKING STORAGE TO FILE VARIABLES                       *ELCCRTM2
  8369*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCCRTM2
  8370*                                                                *ELCCRTM2
  8371******************************************************************ELCCRTM2
  8372     MOVE WS-CR-DT-N                 TO  CR-DT.                      CL**2
  8373     MOVE WS-CR-LF-EXPIRE-DATE-N     TO  CR-LF-EXPIRE-DATE.          CL**2
  8374     MOVE WS-CR-AH-EXPIRE-DATE-N     TO  CR-AH-EXPIRE-DATE.          CL**2
  8375     MOVE WS-CR-ENTRY-DATE-N         TO  CR-ENTRY-DATE.              CL**2
  8376     MOVE WS-CR-LF-CANC-DT-N         TO  CR-LF-CANC-DT.              CL**2
  8377     MOVE WS-CR-LF-CANCEL-EXIT-DATE-N TO                             CL**2
  8378                                     CR-LF-CANCEL-EXIT-DATE.         CL**2
  8379     MOVE WS-CR-LF-CLAIM-EXIT-DATE-N TO  CR-LF-CLAIM-EXIT-DATE.      CL**2
  8380     MOVE WS-CR-AH-CANC-DT-N         TO  CR-AH-CANC-DT.              CL**2
  8381     MOVE WS-CR-AH-CANCEL-EXIT-DATE-N TO CR-AH-CANCEL-EXIT-DATE.     CL**2
  8382     MOVE WS-CR-AH-SETTLEMENT-EXIT-DATEN TO                          CL**2
  8383                                  CR-AH-SETTLEMENT-EXIT-DATE.     ELCCRTM2
  8384     MOVE WS-CR-DTH-DT-N             TO  CR-DTH-DT.                  CL**2
  8385     MOVE WS-CR-DTH-PAY-DT-N         TO  CR-DTH-PAY-DT.              CL**2
  8386     MOVE WS-CR-DIS-DT-N             TO  CR-DIS-DT.                  CL**2
  8387     MOVE WS-CR-DIS-PAY-DT-N         TO  CR-DIS-PAY-DT.              CL**2
  8388     MOVE WS-CR-DIS-PTO-DT-N         TO  CR-DIS-PTO-DT.              CL**2
  8389                                                                     CL**4
  8390     PERFORM  VARYING COPY-NDX FROM 1 BY 1                           CL**4
  8391                UNTIL COPY-NDX > 5                                   CL**4
  8392           MOVE WS-CR-DIS-INCUR-DT-N (COPY-NDX)   TO                 CL**2
  8393                                  CR-DIS-INCUR-DT (COPY-NDX)      ELCCRTM2
  8394     END-PERFORM.                                                 ELCCRTM2
  8395                                                                  ELCCRTM2
  8396
  8397     IF DTE-PGM-OPT = '1'
  8398         WRITE CERT-OUT-RECORD FROM CERTIFICATE-RECORD
  8399         ADD +1 TO CMOT-CNT.
  8400
  8401     MOVE SPACE                  TO REIN-FLG
  8402                                    RISK-REIN-FLAG
  8403                                    RISK-PREM-FLAG
  8404                                    RC-COMM-FLG.
  8405
  8406 0499-WRITE-CERT-X.
  8407     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 166
* ECS010Z.cbl
  8409******************************************************************
  8410***     A P P L Y   P E N D I N G   T R A N S A C T I O N S    ***
  8411******************************************************************
  8412
  8413 0500-APPLY-PENDING-BUSINESS.
  8414
  8415     IF CANCEL-TRANSACTION
  8416         GO TO 0600-PROCESS-CANCELLATIONS.
  8417
  8418     IF CLAIM-TRANSACTION
  8419         GO TO 0700-PROCESS-CLAIMS.
  8420
  8421     IF RESERVE-TRANSACTION
  8422         GO TO 0800-PROCESS-RESERVES.
  8423
  8424     IF UPDATE-TRANSACTION
  8425         GO TO 0900-PROCESS-CERT-CHANGES.
  8426
  8427******************************************************************
  8428***     P R O C E S S   I S S U E   T R A N S A C T I O N S    ***
  8429******************************************************************
  8430
  8431 0505-PROCESS-ISSUES.
  8432
  8433     MOVE INITIALIZED-CERTIFICATE TO CERTIFICATE-RECORD.
  8434     PERFORM CERT-DATE-LOAD.
  8435
  8436     ADD +1                      TO  W-POL-ISSUES.
  8437
  8438     MOVE PB-COMPANY-CD          TO  CR-COMPANY-CD.
  8439     MOVE PB-CARRIER             TO  CR-CARRIER.
  8440     MOVE PB-GROUPING            TO  CR-GROUPING.
  8441     MOVE PB-STATE               TO  CR-STATE.
  8442     MOVE PB-ACCOUNT             TO  CR-ACCOUNT.
  8443     MOVE PB-CERT-EFF-DT         TO  DC-BIN-DATE-1.
  8444     MOVE ' '                    TO  DC-OPTION-CODE.
  8445     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
  8446     MOVE DC-GREG-DATE-CYMD      TO  CR-DT
  8447                                     WS-CR-DT-N.
  8448     MOVE PB-CERT-NO             TO  CR-CERT-NO.
  8449
  8450     MOVE PB-I-NAME              TO  CR-NAME.
  8451     MOVE PB-I-AGE               TO  CR-AGE.
  8452     MOVE PB-I-INSURED-SEX       TO  CR-SEX.
  8453     MOVE PB-I-SOC-SEC-NO        TO  CR-SOC-SEC.
  8454
  8455     IF PB-I-JOINT-COVERAGE
  8456         MOVE PB-I-JOINT-INSURED TO  CR-JOINT-NAME
  8457         MOVE PB-I-JOINT-AGE     TO  CR-JOINT-AGE
  8458     ELSE
  8459        IF (DTE-CLIENT EQUAL 'BOA')  AND
  8460           (PB-I-JOINT-INSURED NOT EQUAL SPACES)
  8461             MOVE PB-I-JOINT-INSURED TO  CR-JOINT-NAME.
  8462
  8463     IF PB-I-SUMMARY  OR
  8464        DTE-CLIENT = 'DMD'
  8465         MOVE PB-I-LIVES         TO  CR-LIVES.
  8466
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 167
* ECS010Z.cbl
  8467     IF PB-I-NUM-BILLED NOT NUMERIC
  8468        MOVE ZEROS               TO PB-I-NUM-BILLED.
  8469
  8470     IF PB-I-STATE-TAX NOT NUMERIC
  8471        MOVE ZEROS               TO PB-I-STATE-TAX.
  8472
  8473     IF PB-I-MUNI-TAX NOT NUMERIC
  8474        MOVE ZEROS               TO PB-I-MUNI-TAX.
  8475
  8476     MOVE PB-I-NUM-BILLED        TO  CR-BILLED.
  8477     MOVE PB-I-STATE-TAX         TO  CR-STATE-TAX.
  8478     MOVE PB-I-RESIDENT-STATE    TO  CR-RESIDENT-STATE.
  8479     MOVE PB-I-RATE-CODE         TO  CR-RATE-CODE.
  8480     MOVE PB-I-MUNI-TAX          TO  CR-MUNI-TAX.
  8481     MOVE PB-I-LOAN-APR          TO  CR-APR.
  8482     MOVE PB-I-PAY-FREQUENCY     TO  CR-PMT-FREQ.
  8483     MOVE PB-I-LOAN-TERM         TO  CR-LOAN-TERM.
  8484
  8485     IF PB-I-RATE-CLASS-OVRD = SPACES
  8486         MOVE PB-I-RATE-CLASS    TO  CR-RATING-CLASS
  8487     ELSE
  8488         MOVE PB-I-RATE-CLASS-OVRD TO CR-RATING-CLASS.
  8489
  8490     MOVE PB-I-POLICY-FORM-NO    TO  CR-POLICY-FORM-NO.
  8491     MOVE PB-I-BUSINESS-TYPE     TO  CR-GRPTYP.
  8492
  8493     IF PB-I-INDV-GRP-OVRD = SPACES
  8494         MOVE PB-I-INDV-GRP-CD   TO  CR-IND-GRP
  8495     ELSE
  8496         MOVE PB-I-INDV-GRP-OVRD TO  CR-IND-GRP.
  8497
  8498     IF CR-IND-GRP = 'I'  OR  '1'
  8499         MOVE '1'                TO  CR-IND-GRP
  8500     ELSE
  8501         MOVE '2'                TO  CR-IND-GRP.
  8502
  8503     IF PB-I-SKIP-CODE = '1'
  8504         MOVE 01                 TO  CR-SKIP.
  8505     IF PB-I-SKIP-CODE = '2'
  8506         MOVE 02                 TO  CR-SKIP.
  8507     IF PB-I-SKIP-CODE = '3'
  8508         MOVE 03                 TO  CR-SKIP.
  8509     IF PB-I-SKIP-CODE = '4'
  8510         MOVE 04                 TO  CR-SKIP.
  8511     IF PB-I-SKIP-CODE = '5'
  8512         MOVE 05                 TO  CR-SKIP.
  8513     IF PB-I-SKIP-CODE = '6'
  8514         MOVE 06                 TO  CR-SKIP.
  8515     IF PB-I-SKIP-CODE = '7'
  8516         MOVE 07                 TO  CR-SKIP.
  8517     IF PB-I-SKIP-CODE = '8'
  8518         MOVE 08                 TO  CR-SKIP.
  8519     IF PB-I-SKIP-CODE = '9'
  8520         MOVE 09                 TO  CR-SKIP.
  8521     IF PB-I-SKIP-CODE = 'A'
  8522         MOVE 10                 TO  CR-SKIP.
  8523     IF PB-I-SKIP-CODE = 'X'
  8524         MOVE 11                 TO  CR-SKIP.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 168
* ECS010Z.cbl
  8525
  8526     MOVE PB-I-MORT-CODE         TO  CR-MORT.
  8527     MOVE PB-I-MEMBER-NO         TO  CR-MEMBER-NO.
  8528     MOVE PB-I-LOAN-OFFICER      TO  CR-LOAN-OFFICER.
  8529
  8530     IF PB-I-SPECIAL-REIN-CODE NOT = SPACE
  8531         MOVE PB-I-SPECIAL-REIN-CODE TO CR-REIN-SPEC
  8532                                        REIN-SPEC-A
  8533                                        REIN-SPEC-B
  8534                                        REIN-SPEC-C
  8535         MOVE REIN-SPEC          TO CR-REIN-TABLE
  8536     ELSE
  8537         MOVE AM-REI-TABLE       TO CR-REIN-TABLE.
  8538
  8539     MOVE PB-I-1ST-PMT-DT        TO  DC-BIN-DATE-1.
  8540     MOVE ' '                    TO  DC-OPTION-CODE.
  8541     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
  8542     MOVE DC-GREG-DATE-1-YMD     TO  CR-LOAN-1ST-PMT-DT.
  8543
  8544     MOVE PB-I-EXTENTION-DAYS    TO  CR-PMT-EXTENSION-DAYS.
  8545
  8546     IF PB-I-LAST-ADD-ON-DT  =  ZEROS  OR  SPACES
  8547         MOVE LOW-VALUES          TO CR-LAST-ADD-ON-DT
  8548     ELSE
  8549         MOVE PB-I-LAST-ADD-ON-DT TO CR-LAST-ADD-ON-DT.
  8550
  8551     IF PB-I-UNDERWRITING-STATUS = 'A'  OR  'D'
  8552         MOVE 'Y'                TO  CR-UNDERWRITING-CODE.
  8553
  8554     IF PB-BATCH-ENTRY = SPACE  OR
  8555        (PB-I-ENTRY-STATUS = '2'  OR  'U')
  8556         MOVE '1'                TO  CR-ENTRY-STATUS
  8557     ELSE
  8558         MOVE PB-I-ENTRY-STATUS  TO  CR-ENTRY-STATUS.
  8559
  8560     IF PB-POLICY-IS-DECLINED
  8561         MOVE 'D'                TO  CR-ENTRY-STATUS.
  8562
  8563     IF PB-POLICY-IS-VOIDED
  8564         MOVE 'V'                TO  CR-ENTRY-STATUS.
  8565
  8566***  IF DTE-CLIENT NOT = 'CRI'
  8567***      IF PB-I-PREM-ACCTNG-ONLY
  8568***          MOVE '1'            TO  CR-ENTRY-STATUS.
  8569
  8570     MOVE EOM-RUN-DATE           TO  CR-ENTRY-DATE
  8571                                     WS-CR-ENTRY-DATE-N.
  8572
  8573     IF PB-I-MICROFILM-NO NUMERIC
*  12-S************************                                        ( 164)**
**    Operand PB-I-MICROFILM-NO is not declared
  8574         MOVE PB-I-MICROFILM-NO  TO CR-ISS-MICROFILM-NO.
*  12-S******************************                                  ( 168)**
**    Operand PB-I-MICROFILM-NO is not declared
  8575
  8576     IF DTE-CLIENT = 'TIH' OR 'FLA' OR 'TII' OR
  8577                     'TMS' OR 'NCL' OR 'HER'
  8578         MOVE PB-I-SIG-SW        TO  CR-USER-CODE.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 169
* ECS010Z.cbl
  8579
  8580*************************************************
  8581***  ADDED IN 06/93 WHEN CERTIFICATE-RECORD   ***
  8582***  WAS CONVERTED TO 1056 BYTES.             ***
  8583*************************************************
  8584     MOVE PB-ENTRY-BATCH         TO  CR-ENTRY-BATCH.
  8585     MOVE PB-I-BENEFICIARY-NAME  TO  CR-BENEFICIARY.
  8586
  8587     MOVE PB-LAST-MAINT-BY       TO  CR-CSR-CODE.
  8588
  8589     MOVE CR-STATE               TO STATE-L.
  8590
  8591     PERFORM 8200-STATE-CODE-LOOKUP THRU 8299-STATE-LOOKUP-X.
  8592
  8593     PERFORM 8600-SETUP-DETAIL-LINE THRU 8689-SETUP-DETAIL-X.
  8594
  8595***************************************************
  8596***  WHEN AN ISSUE WAS PROCESSED THAT HAD       ***
  8597***  INVALID BENEFIT CODES LOCATED IN BOTH      ***
  8598***  BENEFITS,  THE 'ACTION' ON THE DETAIL LIST ***
  8599***  LINE WAS BYPASSED - ONLY THE CERTIFICATE,  ***
  8600***  THE EFFECTIVE DATE AND THE AGE PRINTED.    ***
  8601***************************************************
  8602     IF (PB-INVALID-LIFE AND PB-INVALID-AH)
  8603         IF CR-LF-POLICY-IS-RESTORE
  8604             MOVE 'RESTORED  '          TO TRD-LF-ACTION
  8605             GO TO 0530-PROCESS-ISSUE-CONTINUED
  8606         ELSE
  8607         IF CR-LF-POLICY-IS-REISSUE
  8608             MOVE 'RE-ISSUED '          TO TRD-LF-ACTION
  8609             GO TO 0530-PROCESS-ISSUE-CONTINUED
  8610         ELSE
  8611         IF CR-LF-IS-REIN-ONLY
  8612             MOVE 'REIN. ONLY'          TO TRD-LF-ACTION
  8613             GO TO 0530-PROCESS-ISSUE-CONTINUED
  8614         ELSE
  8615         IF CR-LF-IS-DECLINED
  8616             MOVE 'DECLINED  '          TO TRD-LF-ACTION
  8617             GO TO 0530-PROCESS-ISSUE-CONTINUED
  8618         ELSE
  8619         IF CR-LF-IS-VOID
  8620             MOVE 'VOIDED    '          TO TRD-LF-ACTION
  8621             GO TO 0530-PROCESS-ISSUE-CONTINUED
  8622         ELSE
  8623         IF CR-LF-POLICY-IS-MONTHLY
  8624            MOVE 'MONTHLY'       TO TRD-LF-ACTION
  8625            GO TO 0530-PROCESS-ISSUE-CONTINUED.
  8626
  8627
  8628 0510-PROCESS-LIFE-ISSUE.
  8629
  8630     IF PB-INVALID-LIFE
  8631         GO TO 0520-PROCESS-A-H-ISSUE.
  8632
  8633     MOVE PB-I-LF-BENEFIT-CD     TO  CLAS-LOOK.
  8634     PERFORM 8300-LIFE-TYPE-LOOKUP THRU 8399-LIFE-LOOKUP-X.
  8635     MOVE CLAS-LOOK              TO  PB-I-LF-BENEFIT-CD.
  8636
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 170
* ECS010Z.cbl
  8637     MOVE PB-I-LF-BENEFIT-CD     TO  CR-LFTYP.
  8638     MOVE PB-I-LF-TERM           TO  CR-LF-TERM.
  8639     MOVE PB-I-LF-CRIT-PER       TO  CR-LF-CRIT-PERIOD.
  8640     MOVE PB-I-TERM-IN-DAYS      TO  CR-LF-TERM-IN-DAYS.
  8641     MOVE PB-I-RATE-DEVIATION-LF TO  CR-LF-DEV-CODE.
  8642     MOVE PB-I-RATE-DEV-PCT-LF   TO  CR-LF-DEV-PCT.
  8643
  8644     MOVE PB-I-LF-BENEFIT-AMT    TO  CR-LFAMT.
  8645     MOVE PB-I-LF-PREMIUM-AMT    TO  CR-LFPRM.
  8646     IF PB-I-LF-POLICY-FEE  NUMERIC
  8647         MOVE PB-I-LF-POLICY-FEE TO  CR-LF-POLICY-FEE.
  8648     MOVE PB-I-LF-PREM-CALC      TO  CR-LFPRM-CALC.
  8649     MOVE PB-I-LF-RATE           TO  CR-LFPRM-RATE.
  8650
  8651     IF PB-I-LF-PREM-TAX NUMERIC
  8652        MOVE PB-I-LF-PREM-TAX    TO CR-LF-ISS-PREM-TAX
  8653     END-IF
  8654
  8655
  8656     IF PB-I-LF-REI-RATE NOT = ZEROS
  8657        IF DTE-CLIENT = 'DCC'
  8658           CONTINUE
  8659*          PERFORM 0795-DCC-NSP-LF  THRU 0795-EXIT
  8660        ELSE
  8661           MOVE PB-I-LF-REI-RATE TO CR-LF-NSP-PRM-RATE
  8662           COMPUTE CR-LF-NSP-PRM ROUNDED =
  8663                          (CR-LFAMT / 100) * PB-I-LF-REI-RATE
  8664        END-IF
  8665     END-IF
  8666
  8667     IF CLAS-I-EP (CLAS-INDEXL) = 'B'
  8668         MOVE PB-I-LF-ALT-BENEFIT-AMT TO CR-LFAMT-ALT
  8669         MOVE PB-I-LF-ALT-PREMIUM-AMT TO CR-LFPRM-ALT
  8670         MOVE PB-I-LF-ALT-PREM-CALC   TO CR-LFPRM-CALC-ALT
  8671         MOVE PB-I-LF-ALT-RATE        TO CR-LFPRM-RATE-ALT
  8672         IF PB-I-LF-ALT-REI-RATE NOT = ZEROS
  8673             COMPUTE CR-LF-NSP-PRM ROUNDED =  CR-LF-NSP-PRM +
  8674                 ((CR-LFAMT-ALT / 100) * PB-I-LF-ALT-REI-RATE).
  8675
  8676     MOVE PB-I-LF-EXPIRE-DT      TO  DC-BIN-DATE-1.
  8677     MOVE ' '                    TO  DC-OPTION-CODE.
  8678     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
  8679     MOVE DC-GREG-DATE-CYMD      TO  CR-LF-EXPIRE-DATE
  8680                                     WS-CR-LF-EXPIRE-DATE-N.
  8681
  8682     IF CR-ENTRY-STATUS = 'P'
  8683         MOVE '1'                TO  CR-LF-CURRENT-STATUS
  8684     ELSE
  8685         MOVE CR-ENTRY-STATUS    TO  CR-LF-CURRENT-STATUS.
  8686
  8687     MOVE CLAS-I-AB3 (CLAS-INDEXL)  TO TRD-LFTYP.
  8688     MOVE CR-LF-TERM                TO TRD-LFTRM.
  8689     COMPUTE TRD-LFPRM-RFND = CR-LFPRM + CR-LFPRM-ALT.
  8690     MOVE 'ISSUE     '              TO TRD-LF-ACTION.
  8691     MOVE CR-LF-CURRENT-STATUS      TO TRD-LF-STATUS.
  8692
  8693     IF CR-LF-POLICY-IS-RESTORE
  8694         MOVE 'RESTORED  '          TO TRD-LF-ACTION.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 171
* ECS010Z.cbl
  8695     IF CR-LF-POLICY-IS-REISSUE
  8696         MOVE 'RE-ISSUED '          TO TRD-LF-ACTION.
  8697     IF CR-LF-IS-REIN-ONLY
  8698         MOVE 'REIN. ONLY'          TO TRD-LF-ACTION.
  8699
  8700     IF CR-LF-IS-DECLINED
  8701         MOVE 'DECLINED  '          TO TRD-LF-ACTION.
  8702
  8703     IF CR-LF-IS-VOID
  8704         MOVE 'VOIDED    '          TO TRD-LF-ACTION.
  8705     IF CR-LF-POLICY-IS-MONTHLY
  8706         MOVE 'MONTHLY   '          TO TRD-LF-ACTION.
  8707
  8708     ADD +1                      TO  W-LF-ISSUES.
  8709
  8710 0520-PROCESS-A-H-ISSUE.
  8711
  8712     IF PB-INVALID-AH
  8713         GO TO 0530-PROCESS-ISSUE-CONTINUED.
  8714
  8715     MOVE PB-I-AH-BENEFIT-CD     TO CLAS-LOOK.
  8716     PERFORM 8400-A-H-TYPE-LOOKUP THRU 8499-A-H-LOOKUP-X.
  8717     MOVE CLAS-LOOK              TO  PB-I-AH-BENEFIT-CD.
  8718
  8719     MOVE PB-I-AH-BENEFIT-CD     TO  CR-AHTYP.
  8720     MOVE PB-I-AH-TERM           TO  CR-AH-TERM.
  8721     MOVE PB-I-AH-CRIT-PER       TO  CR-AH-CRIT-PERIOD.
  8722     MOVE PB-I-RATE-DEVIATION-AH TO  CR-AH-DEV-CODE.
  8723     MOVE PB-I-RATE-DEV-PCT-AH   TO  CR-AH-DEV-PCT.
  8724
  8725     MOVE PB-I-AH-BENEFIT-AMT    TO  CR-AHAMT.
  8726     MOVE PB-I-AH-PREMIUM-AMT    TO  CR-AHPRM.
  8727     IF PB-I-AH-POLICY-FEE  NUMERIC
  8728         MOVE PB-I-AH-POLICY-FEE TO  CR-AH-POLICY-FEE.
  8729     MOVE PB-I-AH-PREM-CALC      TO  CR-AHPRM-CALC.
  8730     MOVE PB-I-AH-RATE           TO  CR-AHPRM-RATE.
  8731
  8732     IF PB-I-AH-PREM-TAX NUMERIC
  8733        MOVE PB-I-AH-PREM-TAX    TO CR-AH-ISS-PREM-TAX
  8734     END-IF
  8735
  8736     IF PB-I-AH-REI-RATE NOT = ZEROS
  8737        IF DTE-CLIENT = 'DCC'
  8738           CONTINUE
  8739        ELSE
  8740           MOVE PB-I-AH-REI-RATE   TO  CR-AH-NSP-PRM-RATE
  8741           COMPUTE CR-AH-NSP-PRM ROUNDED =
  8742             ((CR-AHAMT * CR-AH-TERM) / 100) * PB-I-AH-REI-RATE
  8743        END-IF
  8744     END-IF
  8745
  8746     MOVE PB-I-AH-EXPIRE-DT      TO  DC-BIN-DATE-1.
  8747     MOVE ' '                    TO  DC-OPTION-CODE.
  8748     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
  8749     MOVE DC-GREG-DATE-CYMD      TO  CR-AH-EXPIRE-DATE
  8750                                     WS-CR-AH-EXPIRE-DATE-N.
  8751
  8752     IF CR-ENTRY-STATUS = 'P'
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 172
* ECS010Z.cbl
  8753         MOVE '1'                TO  CR-AH-CURRENT-STATUS
  8754     ELSE
  8755         MOVE CR-ENTRY-STATUS    TO  CR-AH-CURRENT-STATUS.
  8756
  8757     MOVE CLAS-I-AB3 (CLAS-INDEXA)  TO TRD-AHTYP.
  8758     MOVE CR-AH-TERM                TO TRD-AHTRM.
  8759     MOVE CR-AHPRM                  TO TRD-AHPRM-RFND.
  8760     MOVE 'ISSUE     '              TO TRD-AH-ACTION.
  8761     MOVE CR-AH-CURRENT-STATUS      TO TRD-AH-STATUS.
  8762
  8763     IF CR-AH-POLICY-IS-RESTORE
  8764         MOVE 'RESTORED  '          TO TRD-AH-ACTION.
  8765     IF CR-AH-POLICY-IS-REISSUE
  8766         MOVE 'RE-ISSUED '          TO TRD-AH-ACTION.
  8767     IF CR-AH-IS-REIN-ONLY
  8768         MOVE 'REIN. ONLY'          TO TRD-AH-ACTION.
  8769
  8770     IF CR-AH-IS-DECLINED
  8771         MOVE 'DECLINED  '          TO TRD-AH-ACTION.
  8772
  8773     IF CR-AH-IS-VOID
  8774         MOVE 'VOIDED    '          TO TRD-AH-ACTION.
  8775     IF CR-AH-POLICY-IS-MONTHLY
  8776         MOVE 'MONTHLY   '          TO TRD-AH-ACTION.
  8777
  8778     ADD +1                      TO  W-AH-ISSUES.
  8779
  8780 0530-PROCESS-ISSUE-CONTINUED.
  8781
  8782     PERFORM 1000-SET-COMMISSION-STRUCTURE THRU 1499-SET-COMM-X.
  8783     MOVE WK-NEW-RATES           TO CR-COMPENSATION-LEVELS.
  8784     MOVE  SPACES                TO WS-LEVELS-CHARGEBACK-SWITCHES.
  8785     PERFORM 1500-GET-ACCT-LEVEL-LF-COMM THRU 1519-ACCT-LF-COMM-X.
  8786
  8787     IF DTE-CLIENT = 'DCC'
  8788        IF CR-LF-DEV-PCT NOT = +0 AND +1
  8789           COMPUTE CR-LF-NSP-PRM ROUNDED =
  8790              (CR-LFPRM + CR-LFPRM-ALT) -
  8791              ((CR-LFPRM + CR-LFPRM-ALT) * CR-LCOM-L (1))
  8792*             ((CR-LFPRM + CR-LFPRM-ALT) * WK-L-RT1 (1))
  8793        END-IF
  8794     END-IF
  8795
  8796     IF DTE-CLIENT = 'DCC'
  8797        IF CR-AH-DEV-PCT NOT = +0 AND +1
  8798           COMPUTE CR-AH-NSP-PRM ROUNDED =
  8799           CR-AHPRM -
  8800           (CR-AHPRM * CR-LCOM-AH (1))
  8801*          (CR-AHPRM * WK-A-RT1 (1))
  8802        END-IF
  8803     END-IF
  8804
  8805     IF CR-ENTRY-STATUS = 'P'
  8806         MOVE '1'                   TO CR-ENTRY-STATUS.
  8807
  8808     IF CR-POLICY-IS-REISSUE  OR
  8809        CR-POLICY-IS-REIN-ONLY OR
  8810        CR-POLICY-IS-DECLINED OR
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 173
* ECS010Z.cbl
  8811        CR-POLICY-IS-VOID
  8812        OR CR-POLICY-IS-MONTHLY
  8813         GO TO 0590-END-ISSUE-PROCESSING.
  8814
  8815     ADD CR-LFPRM TO TPL-ISS-PRM (1).
  8816     ADD CR-LFPRM-ALT TO TPL-ISS-PRM (1).
  8817     ADD CR-AHPRM TO TPA-ISS-PRM (1).
  8818
  8819     IF NOT PB-INVALID-LIFE
  8820         COMPUTE H-LFCM ROUNDED =
  8821                    (CR-LFPRM + CR-LFPRM-ALT) * ACCT-COMM-LF
  8822         MOVE H-LFCM                   TO TRD-LFCOM-CLM
  8823         ADD H-LFCM                    TO TPL-ACCT-COM (1).
  8824
  8825     IF NOT PB-INVALID-AH
  8826         COMPUTE H-AHCM ROUNDED = CR-AHPRM * ACCT-COMM-AH
  8827         MOVE H-AHCM                   TO TRD-AHCOM-CLM
  8828         ADD H-AHCM                    TO TPA-ACCT-COM (1).
  8829
  8830     ADD +1 TO BC-G-ISS.
  8831     ADD +1 TO BC-COMM.
  8832     ADD CR-LFPRM TO BC-NET-WRIT.
  8833     ADD CR-LFPRM-ALT TO BC-NET-WRIT.
  8834     ADD CR-AHPRM TO BC-NET-WRIT.
  8835
  8836     IF  CLAS-I-BAL (CLAS-INDEXL) = 'B'
  8837         ADD CR-LFPRM            TO BC-NET-WRIT-OB
  8838         ADD CR-LFPRM-ALT        TO BC-NET-WRIT-OB
  8839     ELSE
  8840         ADD CR-LFPRM            TO BC-NET-WRIT-SP
  8841         ADD CR-LFPRM-ALT        TO BC-NET-WRIT-SP.
  8842
  8843     IF  CLAS-I-BAL (CLAS-INDEXA) = 'B'
  8844         ADD CR-AHPRM            TO BC-NET-WRIT-OB
  8845     ELSE
  8846         ADD CR-AHPRM            TO BC-NET-WRIT-SP.
  8847
  8848 0590-END-ISSUE-PROCESSING.
  8849
  8850     PERFORM 8690-PRINT-DETAIL-LINE THRU 8699-PRT-DETAIL-X.
  8851
  8852     PERFORM 3000-REINSURE-ROUTINE THRU 3099-REINSURE-ROUTINE-X.
  8853
  8854     IF NOT CR-POLICY-IS-REIN-ONLY  AND
  8855        NOT CR-POLICY-IS-DECLINED  AND
  8856        NOT CR-POLICY-IS-VOID
  8857         MOVE 'Y' TO BILLED-SWITCH
  8858         PERFORM 2100-BUILD-ISSUE-EXTRACT THRU 2199-BLD-ISSUE-X.
  8859
  8860     IF NOT CR-POLICY-IS-REISSUE  AND
  8861        NOT CR-POLICY-IS-DECLINED  AND
  8862        NOT CR-POLICY-IS-VOID
  8863        AND NOT CR-POLICY-IS-MONTHLY
  8864         PERFORM 3100-REINSURE-ISSUE THRU 3199-REINSURE-ISSUE-X.
  8865
  8866     MOVE '*'                   TO TRANSACTION-FLAG.
  8867     GO TO 0300-READ-PENDING-TRANSACTIONS.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 174
* ECS010Z.cbl
  8869******************************************************************
  8870***    P R O C E S S   C A N C E L   T R A N S A C T I O N S   ***
  8871******************************************************************
  8872
  8873 0600-PROCESS-CANCELLATIONS.
  8874
  8875     PERFORM 3000-REINSURE-ROUTINE THRU 3099-REINSURE-ROUTINE-X.
  8876
  8877     IF AM-RECALC-COMM = ('Y' OR '1')
  8878         PERFORM 1600-RECALC-COMM-EXTR
  8879             THRU 1899-RECALC-COMM-EXTR-X.
  8880
  8881     MOVE CR-LFRFND               TO LIFE-REFUND.
  8882     MOVE CR-LFRFND-CALC          TO LIFE-REFUND-CALC.
  8883     MOVE CR-AHRFND               TO A-H-REFUND.
  8884     MOVE CR-AHRFND-CALC          TO A-H-REFUND-CALC.
  8885     MOVE CR-SUM-CAN-CNT-YTD      TO YTD-CANCEL-CNT.
  8886
  8887     MOVE PB-C-LF-CANCEL-AMT      TO CR-LFRFND.
  8888     IF CR-LFRFND-CALC = ZEROS
  8889         MOVE PB-C-LF-REF-CALC    TO CR-LFRFND-CALC
  8890                                     LIFE-REFUND-CALC
  8891     ELSE
  8892         MOVE PB-C-LF-CANCEL-AMT  TO CR-LFRFND-CALC.
  8893
  8894     MOVE PB-C-AH-CANCEL-AMT      TO CR-AHRFND.
  8895     IF CR-AHRFND-CALC = ZEROS
  8896         MOVE PB-C-AH-REF-CALC    TO CR-AHRFND-CALC
  8897                                     A-H-REFUND-CALC
  8898     ELSE
  8899         MOVE PB-C-AH-CANCEL-AMT  TO CR-AHRFND-CALC.
  8900
  8901     MOVE CR-DT                 TO  DC-GREG-DATE-CYMD.
  8902     MOVE 'L'                   TO  DC-OPTION-CODE.
  8903     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
  8904     MOVE DC-BIN-DATE-1         TO  WS-CR-BIN-DATE.
  8905
  8906     IF PB-C-MICROFILM-NO NUMERIC  AND
*  12-S************************                                        ( 168)**
**    Operand PB-C-MICROFILM-NO is not declared
  8907        PB-C-MICROFILM-NO NOT = ZEROS
  8908         MOVE PB-C-MICROFILM-NO  TO CR-CAN-MICROFILM-NO.
*  12-S******************************                                  ( 174)**
**    Operand PB-C-MICROFILM-NO is not declared
  8909
  8910     IF PB-CI-STATE-TAX NOT NUMERIC
  8911        MOVE ZEROS               TO PB-CI-STATE-TAX.
  8912
  8913     IF PB-CI-MUNI-TAX NOT NUMERIC
  8914        MOVE ZEROS               TO PB-CI-MUNI-TAX.
  8915
  8916     IF CR-CANCEL-STATE-TAX NUMERIC
  8917         ADD PB-CI-STATE-TAX  TO CR-CANCEL-STATE-TAX
  8918       ELSE
  8919         MOVE PB-CI-STATE-TAX TO CR-CANCEL-STATE-TAX.
  8920
  8921     IF CR-CANCEL-MUNI-TAX NUMERIC
  8922         ADD PB-CI-MUNI-TAX   TO CR-CANCEL-MUNI-TAX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 175
* ECS010Z.cbl
  8923       ELSE
  8924         MOVE PB-CI-MUNI-TAX  TO CR-CANCEL-MUNI-TAX.
  8925
  8926     MOVE ZEROS                  TO MONTHS-DIFF-LF
  8927                                    MONTHS-DIFF-AH.
  8928
  8929     PERFORM 8600-SETUP-DETAIL-LINE THRU 8689-SETUP-DETAIL-X.
  8930
  8931 0630-PROCESS-LIFE-CANCEL.
  8932
  8933     IF CR-LFTYP = ZERO  OR
  8934        PB-C-LF-CANCEL-DT = LOW-VALUES  OR  SPACES
  8935         MOVE ZEROS               TO H-LFCM
  8936         GO TO 0650-PROCESS-A-H-CANCEL.
  8937
  8938     IF PB-C-LF-PREM-TAX NUMERIC
  8939        MOVE PB-C-LF-PREM-TAX    TO CR-LF-CNC-PREM-TAX
  8940     END-IF
  8941     MOVE PB-C-LF-CANCEL-DT       TO  DC-BIN-DATE-1.
  8942     MOVE ' '                     TO  DC-OPTION-CODE.
  8943     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
  8944     MOVE DC-GREG-DATE-CYMD       TO  CR-LF-CANC-DT
  8945                                      WS-CR-LF-CANC-DT-N.
  8946
  8947     MOVE WS-CR-BIN-DATE          TO  DC-BIN-DATE-1.
  8948     MOVE PB-C-LF-CANCEL-DT       TO  DC-BIN-DATE-2.
  8949     MOVE '1'                     TO  DC-OPTION-CODE.
  8950     MOVE ' '                     TO  DC-CENTURY-ADJUSTMENT.
  8951     MOVE ZEROS                   TO  DC-ELAPSED-MONTHS
  8952                                      DC-ODD-DAYS-OVER
  8953                                      DC-ELAPSED-DAYS.
  8954     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
  8955     MOVE DC-ELAPSED-MONTHS       TO  MONTHS-DIFF-LF.
  8956
  8957     IF DC-ODD-DAYS-OVER   GREATER THAN  ZERO
  8958         ADD  +1                  TO  MONTHS-DIFF-LF.
  8959
  8960     MOVE  'YYYYYYYYYY'           TO  WS-LF-CHARGEBACK-LEVELS.
  8961
  8962     MOVE  ZEROS                  TO  SUB.
  8963
  8964 0635-LIFE-CHARGEBACK-LOOP.
  8965
  8966     ADD    +1                    TO  SUB.
  8967
  8968     IF  SUB  GREATER THAN  +10
  8969         GO TO  0640-CONTINUE-LIFE-CANCEL.
  8970
  8971     IF  AM-COMM-CHARGEBACK (SUB)  NOT  NUMERIC  OR
  8972         AM-COMM-CHARGEBACK (SUB)  =  ZEROS
  8973         GO TO  0635-LIFE-CHARGEBACK-LOOP.
  8974
  8975     IF  AM-COMM-CHARGEBACK (SUB)  EQUAL    '99'
  8976         MOVE  'N'    TO  WS-LF-CHARGEBACK-SW (SUB).
  8977
  8978     IF  MONTHS-DIFF-LF GREATER THAN AM-COMM-CHARGEBACK (SUB)
  8979         MOVE  'N'        TO  WS-LF-CHARGEBACK-SW (SUB).
  8980
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 176
* ECS010Z.cbl
  8981     GO TO  0635-LIFE-CHARGEBACK-LOOP.
  8982
  8983
  8984 0640-CONTINUE-LIFE-CANCEL.
  8985
  8986     IF DC-ODD-DAYS-OVER GREATER THAN ZEROS
  8987        SUBTRACT +1 FROM MONTHS-DIFF-LF.
  8988
  8989     PERFORM 1500-GET-ACCT-LEVEL-LF-COMM THRU 1519-ACCT-LF-COMM-X.
  8990
  8991     IF DTE-CLIENT = 'GIC'
  8992         IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'B'
  8993             MOVE CR-LFPRM-CALC   TO CR-LFRFND-CALC
  8994                                     LIFE-REFUND-CALC.
  8995
  8996     IF DTE-CLIENT = 'TMS'
  8997         MOVE PB-LF-REFUND-TYPE   TO  CR-LF-REFUND-TYPE.
  8998
  8999     IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'Z'
  9000         MOVE PB-C-LIVES               TO CR-SUM-CAN-CNT-YTD
  9001     ELSE
  9002         IF CR-LF-CANCEL-EXIT-DATE = ZEROS
  9003             MOVE CR-LF-CURRENT-STATUS TO CR-LF-STATUS-AT-CANCEL
  9004             MOVE '8'                  TO CR-LF-CURRENT-STATUS
  9005             MOVE PB-C-LF-COMM-CHARGEBACK TO CR-LF-COMM-CHARGEBACK
  9006             MOVE EOM-RUN-DATE      TO CR-LF-CANCEL-EXIT-DATE
  9007                                       WS-CR-LF-CANCEL-EXIT-DATE-N
  9008         ELSE
  9009             IF CR-LF-CURRENT-STATUS = '6'
  9010                 MOVE '8'              TO CR-LF-CURRENT-STATUS
  9011                 MOVE PB-C-LF-COMM-CHARGEBACK
  9012                                       TO CR-LF-COMM-CHARGEBACK
  9013                 MOVE EOM-RUN-DATE TO CR-LF-CANCEL-EXIT-DATE
  9014                                      WS-CR-LF-CANCEL-EXIT-DATE-N.
  9015
  9016*************************************************
  9017***  ADDED IN 06/93 WHEN CERTIFICATE-RECORD   ***
  9018***  WAS CONVERTED TO 1056 BYTES.             ***
  9019*************************************************
  9020     MOVE PB-ENTRY-BATCH               TO CR-LF-EXIT-BATCH.
  9021
  9022     MOVE CLAS-I-AB3 (CLAS-INDEXL)     TO TRD-LFTYP.
  9023     MOVE CR-LF-TERM                   TO TRD-LFTRM.
  9024     MOVE CR-LFRFND                    TO TRD-LFPRM-RFND.
  9025
  9026     COMPUTE H-LFCM ROUNDED =
  9027                              (CR-LFRFND * ACCT-COMM-LF) * (-1).
  9028     MOVE H-LFCM                       TO TRD-LFCOM-CLM.
  9029
  9030     MOVE CR-LF-CNC-MO                 TO TRD-LFACTMO.
  9031     MOVE CR-LF-CNC-DA                 TO TRD-LFACTDA.
  9032     MOVE CR-LF-CNC-YR                 TO TRD-LFACTYR.
  9033     MOVE '/'                          TO TRD-LF-S1  TRD-LF-S2.
  9034
  9035     MOVE 'CANCEL    '                 TO TRD-LF-ACTION.
  9036     MOVE CR-LF-CURRENT-STATUS         TO TRD-LF-STATUS.
  9037
  9038 0650-PROCESS-A-H-CANCEL.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 177
* ECS010Z.cbl
  9039
  9040     IF CR-AHTYP = ZERO  OR
  9041        PB-C-AH-CANCEL-DT = LOW-VALUES  OR  SPACES
  9042         MOVE ZEROS               TO H-AHCM
  9043         GO TO 0660-PROCESS-CANCEL-CONTINUE.
  9044
  9045     MOVE CR-DT                 TO  DC-GREG-DATE-CYMD.
  9046     MOVE 'L'                   TO  DC-OPTION-CODE.
  9047     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
  9048     MOVE DC-BIN-DATE-1         TO  WS-CR-BIN-DATE.
  9049
  9050     MOVE PB-C-AH-CANCEL-DT       TO  DC-BIN-DATE-1.
  9051     MOVE ' '                     TO  DC-OPTION-CODE.
  9052     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
  9053     MOVE DC-GREG-DATE-CYMD       TO  CR-AH-CANC-DT
  9054                                      WS-CR-AH-CANC-DT-N.
  9055
  9056     IF PB-C-AH-PREM-TAX NUMERIC
  9057        MOVE PB-C-AH-PREM-TAX    TO CR-AH-CNC-PREM-TAX
  9058     END-IF
  9059     MOVE WS-CR-BIN-DATE          TO  DC-BIN-DATE-1.
  9060     MOVE PB-C-AH-CANCEL-DT       TO  DC-BIN-DATE-2.
  9061     MOVE '1'                     TO  DC-OPTION-CODE.
  9062     MOVE ' '                     TO  DC-CENTURY-ADJUSTMENT.
  9063     MOVE ZEROS                   TO  DC-ELAPSED-MONTHS
  9064                                      DC-ODD-DAYS-OVER
  9065                                      DC-ELAPSED-DAYS.
  9066     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
  9067     MOVE DC-ELAPSED-MONTHS       TO  MONTHS-DIFF-AH.
  9068
  9069     IF  DC-ODD-DAYS-OVER   GREATER THAN   ZERO
  9070          ADD  +1                 TO  MONTHS-DIFF-AH.
  9071
  9072     MOVE  'YYYYYYYYYY'           TO  WS-AH-CHARGEBACK-LEVELS.
  9073
  9074     MOVE  ZEROS                  TO  SUB.
  9075
  9076 0653-A-H-CHARGEBACK-LOOP.
  9077
  9078     ADD    +1                    TO  SUB.
  9079
  9080     IF  SUB  GREATER THAN  +10
  9081         GO TO  0655-CONTINUE-A-H-CANCEL.
  9082
  9083     IF  AM-COMM-CHARGEBACK (SUB)  NOT  NUMERIC  OR
  9084         AM-COMM-CHARGEBACK (SUB)  =  ZEROS
  9085         GO TO  0653-A-H-CHARGEBACK-LOOP.
  9086
  9087     IF  AM-COMM-CHARGEBACK (SUB)  EQUAL    '99'
  9088         MOVE  'N'    TO  WS-AH-CHARGEBACK-SW (SUB).
  9089
  9090     IF  MONTHS-DIFF-AH GREATER THAN AM-COMM-CHARGEBACK (SUB)
  9091         MOVE  'N'        TO  WS-AH-CHARGEBACK-SW (SUB).
  9092
  9093     GO TO  0653-A-H-CHARGEBACK-LOOP.
  9094
  9095
  9096 0655-CONTINUE-A-H-CANCEL.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 178
* ECS010Z.cbl
  9097
  9098     IF DC-ODD-DAYS-OVER GREATER THAN ZEROS
  9099        SUBTRACT +1 FROM MONTHS-DIFF-AH.
  9100
  9101     PERFORM 1550-GET-ACCT-LEVEL-AH-COMM THRU 1599-ACCT-AH-COMM-X.
  9102
  9103     IF DTE-CLIENT = 'GIC'
  9104         IF CLAS-I-CALC-TYPE (CLAS-INDEXA) = 'B'
  9105             MOVE CR-AHPRM-CALC   TO CR-AHRFND-CALC
  9106                                     A-H-REFUND-CALC.
  9107
  9108     IF DTE-CLIENT = 'TMS'
  9109         MOVE PB-AH-REFUND-TYPE   TO  CR-AH-REFUND-TYPE.
  9110
  9111     IF CLAS-I-CALC-TYPE (CLAS-INDEXA) = 'Z'
  9112         MOVE PB-C-LIVES               TO CR-SUM-CAN-CNT-YTD
  9113     ELSE
  9114         IF CR-AH-CANCEL-EXIT-DATE = ZEROS
  9115             MOVE CR-AH-CURRENT-STATUS TO CR-AH-STATUS-AT-CANCEL
  9116             MOVE '8'                  TO CR-AH-CURRENT-STATUS
  9117             MOVE PB-C-AH-COMM-CHARGEBACK TO CR-AH-COMM-CHARGEBACK
  9118             MOVE EOM-RUN-DATE    TO CR-AH-CANCEL-EXIT-DATE
  9119                                     WS-CR-AH-CANCEL-EXIT-DATE-N
  9120         ELSE
  9121             IF CR-AH-CURRENT-STATUS = '7'
  9122                 MOVE '8'              TO CR-AH-CURRENT-STATUS
  9123                 MOVE PB-C-AH-COMM-CHARGEBACK
  9124                                       TO CR-AH-COMM-CHARGEBACK
  9125                 MOVE EOM-RUN-DATE TO CR-AH-CANCEL-EXIT-DATE
  9126                                      WS-CR-AH-CANCEL-EXIT-DATE-N.
  9127
  9128*************************************************
  9129***  ADDED IN 06/93 WHEN CERTIFICATE-RECORD   ***
  9130***  WAS CONVERTED TO 1056 BYTES.             ***
  9131*************************************************
  9132     MOVE PB-ENTRY-BATCH               TO CR-AH-EXIT-BATCH.
  9133
  9134     MOVE CLAS-I-AB3 (CLAS-INDEXA)     TO TRD-AHTYP.
  9135     MOVE CR-AH-TERM                   TO TRD-AHTRM.
  9136     MOVE CR-AHRFND                    TO TRD-AHPRM-RFND.
  9137
  9138     COMPUTE H-AHCM ROUNDED = (CR-AHRFND * ACCT-COMM-AH) * (-1).
  9139
  9140     MOVE H-AHCM                       TO TRD-AHCOM-CLM.
  9141
  9142     MOVE CR-AH-CNC-MO                 TO TRD-AHACTMO.
  9143     MOVE CR-AH-CNC-DA                 TO TRD-AHACTDA.
  9144     MOVE CR-AH-CNC-YR                 TO TRD-AHACTYR
  9145     MOVE '/'                          TO TRD-AH-S1  TRD-AH-S2.
  9146
  9147     MOVE 'CANCEL    '                 TO TRD-AH-ACTION.
  9148     MOVE CR-AH-CURRENT-STATUS         TO TRD-AH-STATUS.
  9149
  9150 0660-PROCESS-CANCEL-CONTINUE.
  9151
  9152     PERFORM 8690-PRINT-DETAIL-LINE THRU 8699-PRT-DETAIL-X.
  9153
  9154     IF CR-POLICY-IS-REIN-ONLY
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 179
* ECS010Z.cbl
  9155        GO TO 0660-CONT.
  9156
  9157     MOVE 'Y'                    TO BILLED-SWITCH.
  9158     PERFORM 2200-BUILD-CANCEL-EXTRACT THRU 2299-BLD-CANCEL-X.
  9159
  9160*    IF CR-POLICY-IS-MONTHLY
  9161*       GO TO 0660-CONT.
  9162
  9163     ADD +1                      TO BC-G-CNC.
  9164     ADD +1                      TO BC-COMM.
  9165     SUBTRACT CR-LFRFND FROM BC-NET-WRIT.
  9166     SUBTRACT CR-AHRFND FROM BC-NET-WRIT.
  9167     ADD CR-LFRFND               TO TPL-CNC-PRM (1).
  9168     ADD H-LFCM                  TO TPL-ACCT-COM (1).
  9169     ADD CR-AHRFND               TO TPA-CNC-PRM (1).
  9170     ADD H-AHCM                  TO TPA-ACCT-COM (1).
  9171
  9172     IF  CLAS-I-BAL (CLAS-INDEXL) = 'B'
  9173         SUBTRACT CR-LFRFND FROM BC-NET-WRIT-OB
  9174     ELSE
  9175         SUBTRACT CR-LFRFND FROM BC-NET-WRIT-SP.
  9176
  9177     IF  CLAS-I-BAL (CLAS-INDEXA) = 'B'
  9178         SUBTRACT CR-AHRFND FROM BC-NET-WRIT-OB
  9179     ELSE
  9180         SUBTRACT CR-AHRFND FROM BC-NET-WRIT-SP.
  9181
  9182
  9183 0660-CONT.
  9184
  9185     MOVE MONTHS-DIFF-LF            TO REIN-LCNC-EARN-TERM.
  9186     MOVE MONTHS-DIFF-AH            TO REIN-ACNC-EARN-TERM.
  9187
  9188     IF CR-LFRFND NEGATIVE
  9189       IF CR-LFRFND + LIFE-REFUND = ZEROS
  9190           MOVE '*'                 TO REIN-VOID-LF-SW.
  9191     IF CR-AHRFND NEGATIVE
  9192       IF CR-AHRFND + A-H-REFUND = ZEROS
  9193           MOVE '*'                 TO REIN-VOID-AH-SW.
  9194
  9195     IF CR-LFRFND NOT = ZEROS
  9196       IF CR-LF-CANCEL-EXIT-DATE NOT = EOM-RUN-DATE
  9197           MOVE '*'                 TO REIN-ADDL-LF-SW.
  9198     IF CR-AHRFND NOT = ZEROS
  9199       IF CR-AH-CANCEL-EXIT-DATE NOT = EOM-RUN-DATE
  9200           MOVE '*'                 TO REIN-ADDL-AH-SW.
  9201
  9202     IF CR-DT = CR-LF-CANC-DT
  9203       MOVE '*'                     TO REIN-CANCEL-LF-SW.
  9204     IF CR-DT = CR-AH-CANC-DT
  9205       MOVE '*'                     TO REIN-CANCEL-AH-SW.
  9206
  9207     PERFORM 3200-REINSURE-CANCEL THRU 3299-REINSURE-CANCEL-X.
  9208
  9209     MOVE SPACES                    TO REIN-VOID-LF-SW
  9210                                       REIN-VOID-AH-SW
  9211                                       REIN-ADDL-LF-SW
  9212                                       REIN-ADDL-AH-SW.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 180
* ECS010Z.cbl
  9213
  9214     COMPUTE CR-LFRFND = LIFE-REFUND + PB-C-LF-CANCEL-AMT.
  9215     MOVE LIFE-REFUND-CALC          TO CR-LFRFND-CALC.
  9216
  9217     COMPUTE CR-AHRFND = A-H-REFUND  + PB-C-AH-CANCEL-AMT.
  9218     MOVE A-H-REFUND-CALC           TO CR-AHRFND-CALC.
  9219
  9220     IF (CR-LFTYP NOT = ZERO  AND
  9221        CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'Z')  OR
  9222        (CR-AHTYP NOT = ZERO  AND
  9223        CLAS-I-CALC-TYPE (CLAS-INDEXA) = 'Z')
  9224         ADD PB-C-LIVES                TO CR-SUM-CAN-CNT-ITD
  9225         COMPUTE CR-SUM-CAN-CNT-YTD = YTD-CANCEL-CNT + PB-C-LIVES.
  9226
  9227 0670-LIFE-CANCEL-VOID.
  9228
  9229     IF CR-LFTYP NOT = ZERO  AND
  9230        CR-LFRFND = ZERO  AND
  9231        PB-C-LF-CANCEL-AMT NEGATIVE
  9232         NEXT SENTENCE
  9233     ELSE
  9234         GO TO 0680-A-H-CANCEL-VOID.
  9235
  9236     MOVE ZEROS                        TO CR-LF-CANCEL-EXIT-DATE
  9237                                       WS-CR-LF-CANCEL-EXIT-DATE-N
  9238                                          CR-LF-CANC-DT
  9239                                          WS-CR-LF-CANC-DT-N
  9240                                          CR-LFRFND-CALC.
  9241
  9242     MOVE SPACES                       TO CR-LF-COMM-CHARGEBACK.
  9243
  9244     IF CR-LF-CANCEL-APPLIED
  9245         MOVE CR-LF-STATUS-AT-CANCEL   TO CR-LF-CURRENT-STATUS
  9246         MOVE ' '                      TO CR-LF-STATUS-AT-CANCEL
  9247     ELSE
  9248         MOVE CR-LF-STATUS-AT-CANCEL   TO CR-LF-STATUS-AT-DEATH
  9249         MOVE ' '                      TO CR-LF-STATUS-AT-CANCEL.
  9250
  9251     PERFORM 8600-SETUP-DETAIL-LINE THRU 8689-SETUP-DETAIL-X.
  9252
  9253     MOVE 'VOID CANCL'                 TO TRD-LF-ACTION.
  9254     MOVE CR-LF-CURRENT-STATUS         TO TRD-LF-STATUS.
  9255
  9256     PERFORM 8690-PRINT-DETAIL-LINE THRU 8699-PRT-DETAIL-X.
  9257
  9258 0680-A-H-CANCEL-VOID.
  9259
  9260     IF CR-AHTYP NOT = ZERO  AND
  9261        CR-AHRFND = ZERO  AND
  9262        PB-C-AH-CANCEL-AMT NEGATIVE
  9263         NEXT SENTENCE
  9264     ELSE
  9265         GO TO 0690-END-CANCEL-PROCESSING.
  9266
  9267     MOVE ZEROS                      TO CR-AH-CANCEL-EXIT-DATE
  9268                                     WS-CR-AH-CANCEL-EXIT-DATE-N
  9269                                        CR-AH-CANC-DT
  9270                                        WS-CR-AH-CANC-DT-N
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 181
* ECS010Z.cbl
  9271                                        CR-AHRFND-CALC.
  9272
  9273     MOVE SPACES                        TO CR-AH-COMM-CHARGEBACK.
  9274
  9275     IF CR-AH-CANCEL-APPLIED
  9276         MOVE CR-AH-STATUS-AT-CANCEL    TO CR-AH-CURRENT-STATUS
  9277         MOVE ' '                       TO CR-AH-STATUS-AT-CANCEL
  9278     ELSE
  9279         MOVE CR-AH-STATUS-AT-CANCEL
  9280                                    TO CR-AH-STATUS-AT-SETTLEMENT
  9281         MOVE ' '                       TO CR-AH-STATUS-AT-CANCEL.
  9282
  9283     PERFORM 8600-SETUP-DETAIL-LINE THRU 8689-SETUP-DETAIL-X.
  9284
  9285     MOVE 'VOID CANCL'                  TO TRD-AH-ACTION.
  9286     MOVE CR-AH-CURRENT-STATUS          TO TRD-AH-STATUS.
  9287
  9288     PERFORM 8690-PRINT-DETAIL-LINE THRU 8699-PRT-DETAIL-X.
  9289
  9290 0690-END-CANCEL-PROCESSING.
  9291
  9292     IF CR-LF-CANC-DT = ZEROS  AND
  9293        CR-AH-CANC-DT = ZEROS
  9294         MOVE ZEROS             TO CR-CAN-MICROFILM-NO.
*  12-S*****************************************************           ( 174)**
**    Operand CR-CAN-MICROFILM-NO is not declared
  9295
  9296     IF LIFE-REFUND = ZERO  AND  A-H-REFUND = ZERO
  9297         NEXT SENTENCE
  9298     ELSE
  9299         MOVE 'X'               TO REIN-RT-SW
  9300         PERFORM 3200-REINSURE-CANCEL THRU 3299-REINSURE-CANCEL-X
  9301         MOVE ' '               TO REIN-RT-SW.
  9302
  9303     MOVE '*'                   TO TRANSACTION-FLAG.
  9304     GO TO 0300-READ-PENDING-TRANSACTIONS.
  9305
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 182
* ECS010Z.cbl
  9307******************************************************************
  9308***    P R O C E S S   C L A I M S   T R A N S A C T I O N S   ***
  9309******************************************************************
  9310
  9311 0700-PROCESS-CLAIMS.
  9312
  9313     IF NOT PC-LF-CLAIM  AND  NOT  PC-OB-LF-CLAIM  AND
  9314        NOT PC-AH-CLAIM  AND  NOT  PC-OB-AH-CLAIM
  9315         DISPLAY 'INVALID CLAIM TYPE TO ECS010 '
  9316             PENDING-MATCH-CONTROL
  9317         MOVE 0301 TO WS-ABEND-CODE
  9318         DISPLAY '******************************'
  9319         DISPLAY '***** ERROR LOCATION 011 *****'
  9320         DISPLAY '******************************'
  9321         MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
  9322         GO TO ABEND-PGM.
  9323
  9324     PERFORM 3000-REINSURE-ROUTINE THRU 3099-REINSURE-ROUTINE-X.
  9325
  9326     ADD +1                       TO  W-LF-CLAIMS.
  9327
  9328     MOVE PC-INCURRED-DT          TO  DC-BIN-DATE-1.
  9329     MOVE ' '                     TO  DC-OPTION-CODE.
  9330     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
  9331     MOVE DC-GREG-DATE-CYMD       TO  INCURRED-DATE.
  9332
  9333     MOVE PC-REPORTED-DT          TO  DC-BIN-DATE-1.
  9334     MOVE ' '                     TO  DC-OPTION-CODE.
  9335     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
  9336     MOVE DC-GREG-DATE-1-YMD      TO  REPORTED-DATE.
  9337
  9338     MOVE PC-PAYMENT-DT           TO  DC-BIN-DATE-1.
  9339     MOVE ' '                     TO  DC-OPTION-CODE.
  9340     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
  9341     MOVE DC-GREG-DATE-CYMD       TO  PAYMENT-DATE.
  9342
  9343     MOVE PC-PAID-THRU-DT         TO  DC-BIN-DATE-1.
  9344     MOVE ' '                     TO  DC-OPTION-CODE.
  9345     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
  9346     MOVE DC-GREG-DATE-CYMD       TO  PAY-TO-DATE.
  9347
  9348     PERFORM 8600-SETUP-DETAIL-LINE THRU 8689-SETUP-DETAIL-X.
  9349
  9350     IF DTE-CLIENT = 'LAP'  OR  'RMC'
  9351       MOVE PC-CHECK-NO            TO WS-CHECK-NUMBER
  9352       IF WS-CHECK-NO = 'DEDU'  OR  ' DED'  OR  '0DED'
  9353         IF CR-CLAIM-DEDUCT-WITHHELD = +99999.99
  9354             MOVE PC-CLAIM-PAYMENT TO CR-CLAIM-DEDUCT-WITHHELD
  9355         ELSE
  9356             ADD PC-CLAIM-PAYMENT  TO CR-CLAIM-DEDUCT-WITHHELD.
  9357
  9358     IF PC-AH-CLAIM  OR  PC-OB-AH-CLAIM
  9359         GO TO 0750-PROCESS-DISABILITY-CLAIM.
  9360
  9361******************************************************************
  9362***           P R O C E S S   D E A T H   C L A I M            ***
  9363******************************************************************
  9364
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 183
* ECS010Z.cbl
  9365     IF REIN-IS-RISK-PREMIUM
  9366       IF CR-DTH-DT = ZEROS
  9367           MOVE INCURRED-DATE      TO DC-GREG-DATE-CYMD
  9368           PERFORM 3025-CALC-ELAPSED-MONTHS THRU 3026-CALC-EXIT
  9369           MOVE DC-ELAPSED-MONTHS  TO REIN-LF-CLM-MONTHS.
  9370
  9371     MOVE INCURRED-DATE            TO CR-DTH-DT
  9372                                      WS-CR-DTH-DT-N.
  9373
  9374     IF PC-CHARGEBLE-EXPENSE  OR
  9375        PC-NON-CHARGEBLE-EXPENSE
  9376         IF CR-LFTYP = '00'
  9377             MOVE '99'             TO CR-LFTYP  CLAS-LOOK
  9378             PERFORM 8300-LIFE-TYPE-LOOKUP THRU
  9379                     8399-LIFE-LOOKUP-X.
  9380
  9381     IF PC-CHARGEBLE-EXPENSE  OR
  9382        PC-NON-CHARGEBLE-EXPENSE
  9383         ADD PC-CLAIM-PAYMENT      TO CR-DTHEXP
  9384         ADD PC-CLAIM-PAYMENT      TO CR-DTHEXP-YTD
  9385         ADD PC-CLAIM-PAYMENT      TO TPL-CLAIMS (1)
  9386         MOVE PC-CLAIM-PAYMENT     TO TRD-LFCOM-CLM
  9387         MOVE 'CLAIM EXP '         TO TRD-LF-ACTION
  9388         GO TO 0780-END-CLAIMS-PROCESSING.
  9389
  9390     ADD +1                       TO  CR-NUM-DTH-CLM.
  9391     MOVE REPORTED-DATE           TO  CR-DTH-RPT-DT.
  9392     MOVE PAYMENT-DATE            TO  CR-DTH-PAY-DT
  9393                                      WS-CR-DTH-PAY-DT-N.
  9394
  9395     ADD PC-CLAIM-PAYMENT         TO  CR-DTHAMT.
  9396     ADD PC-CLAIM-PAYMENT         TO  CR-DTHAMT-YTD.
  9397     MOVE PC-CLAIM-PAYMENT        TO  CR-DTHAMT-LAST.
  9398     MOVE PC-AGE-AT-CLAIM         TO  CR-DTH-AGE.
  9399     IF CR-DTH-PAY-CD NOT = 'F'
  9400         MOVE PC-PAYMENT-TYPE     TO  CR-DTH-PAY-CD.
  9401     INSPECT CR-DTH-PAY-CD
  9402         CONVERTING '12349' TO 'PFSXV'.
  9403     MOVE PC-CAUSE-CODE           TO  CR-DEATH-CAUSE.
  9404
  9405     IF (LIFE-OVERRIDE-L1 EQUAL 'P'  OR
  9406         CLAS-I-RL-AH (CLAS-INDEXL) EQUAL 'P')
  9407       AND
  9408       (CR-DTHAMT LESS THAN (CR-LFAMT + CR-LFAMT-ALT)
  9409       OR
  9410        DTE-CLIENT = 'ACC' OR 'FDL')
  9411        NEXT SENTENCE
  9412     ELSE
  9413     IF (CLAS-I-CALC-TYPE (CLAS-INDEXL) NOT = 'Z')
  9414         IF CR-LF-CLAIM-EXIT-DATE = ZEROS
  9415             MOVE CR-LF-CURRENT-STATUS TO CR-LF-STATUS-AT-DEATH
  9416             MOVE '7'            TO CR-LF-CURRENT-STATUS
  9417             MOVE EOM-RUN-DATE   TO CR-LF-CLAIM-EXIT-DATE
  9418                                    WS-CR-LF-CLAIM-EXIT-DATE-N.
  9419
  9420     MOVE CLAS-I-AB3 (CLAS-INDEXL)     TO TRD-LFTYP.
  9421     MOVE CR-LF-TERM                   TO TRD-LFTRM.
  9422     MOVE PC-CLAIM-PAYMENT        TO  TRD-LFCOM-CLM.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 184
* ECS010Z.cbl
  9423     IF CLAS-I-RL-AH (CLAS-INDEXL) = 'P'
  9424         MOVE 'PROPERTY  '       TO TRD-LF-ACTION
  9425     ELSE
  9426         MOVE 'CLAIM PYMT'       TO TRD-LF-ACTION.
  9427     MOVE CR-LF-CURRENT-STATUS   TO TRD-LF-STATUS.
  9428
  9429     IF NOT CR-POLICY-IS-REIN-ONLY
  9430         ADD PC-CLAIM-PAYMENT    TO TPL-CLAIMS (1).
  9431
  9432 0720-CANCEL-AH-COVERAGE.
  9433
  9434     IF CR-AHTYP = ZEROS  OR
  9435        NOT CR-AH-POLICY-IS-ACTIVE
  9436         GO TO 0740-DEATH-CLAIM-VOID.
  9437
  9438     MOVE CR-AH-CURRENT-STATUS          TO CR-AH-STATUS-AT-CANCEL.
  9439     MOVE '7'                           TO CR-AH-CURRENT-STATUS.
  9440     MOVE CR-DTH-DT                     TO CR-AH-CANC-DT
  9441                                           WS-CR-AH-CANC-DT-N.
  9442     MOVE EOM-RUN-DATE               TO CR-AH-CANCEL-EXIT-DATE
  9443                                     WS-CR-AH-CANCEL-EXIT-DATE-N.
  9444
  9445     MOVE CLAS-I-AB3 (CLAS-INDEXA)      TO TRD-AHTYP.
  9446     MOVE CR-AH-TERM                    TO TRD-AHTRM.
  9447     MOVE CR-DTH-MO                     TO TRD-AHACTMO.
  9448     MOVE CR-DTH-DA                     TO TRD-AHACTDA.
  9449     MOVE CR-DTH-YR                     TO TRD-AHACTYR.
  9450     MOVE '/'                           TO TRD-AH-S1  TRD-AH-S2.
  9451     MOVE 'CLAIM CANC'                  TO TRD-AH-ACTION.
  9452     MOVE CR-AH-CURRENT-STATUS          TO TRD-AH-STATUS.
  9453
  9454 0740-DEATH-CLAIM-VOID.
  9455
  9456     IF CR-DTHAMT = ZERO  AND
  9457        PC-CLAIM-PAYMENT NEGATIVE
  9458         NEXT SENTENCE
  9459     ELSE
  9460         GO TO 0780-END-CLAIMS-PROCESSING.
  9461
  9462     MOVE '*'                           TO DEATH-VOID-FLAG.
  9463
  9464     MOVE ZEROS                         TO CR-LF-CLAIM-EXIT-DATE
  9465                                        WS-CR-LF-CLAIM-EXIT-DATE-N
  9466                                           CR-NUM-DTH-CLM
  9467                                           CR-DTH-RPT-DT
  9468                                           CR-DTH-PAY-DT
  9469                                           WS-CR-DTH-PAY-DT-N
  9470*                                          CR-DTHAMT-YTD
  9471*                                          CR-DTHAMT-LAST
  9472                                           CR-DTH-AGE.
  9473     MOVE ' '                           TO CR-DTH-PAY-CD.
  9474
  9475     IF CR-LF-DEATH-CLAIM-APPLIED
  9476         MOVE CR-LF-STATUS-AT-DEATH     TO CR-LF-CURRENT-STATUS
  9477         MOVE ' '                       TO CR-LF-STATUS-AT-DEATH
  9478     ELSE
  9479         MOVE CR-LF-STATUS-AT-DEATH     TO CR-LF-STATUS-AT-CANCEL
  9480         MOVE ' '                       TO CR-LF-STATUS-AT-DEATH.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 185
* ECS010Z.cbl
  9481
  9482     MOVE 'VOID CLAIM'                  TO TRD-LF-ACTION.
  9483     MOVE CR-LF-CURRENT-STATUS          TO TRD-LF-STATUS.
  9484
  9485     IF CR-AH-DEATH-CLAIM-APPLIED
  9486         MOVE CR-AH-STATUS-AT-CANCEL    TO CR-AH-CURRENT-STATUS
  9487         MOVE ' '                       TO CR-AH-STATUS-AT-CANCEL
  9488         MOVE ZEROS                     TO CR-AH-CANC-DT
  9489                                           WS-CR-AH-CANC-DT-N
  9490                                           CR-AH-CANCEL-EXIT-DATE
  9491                                       WS-CR-AH-CANCEL-EXIT-DATE-N
  9492         MOVE CLAS-I-AB3 (CLAS-INDEXA)  TO TRD-AHTYP
  9493         MOVE CR-AH-TERM                TO TRD-AHTRM
  9494         MOVE 'VOID CANCL'              TO TRD-AH-ACTION
  9495         MOVE CR-AH-CURRENT-STATUS      TO TRD-AH-STATUS.
  9496
  9497     GO TO 0780-END-CLAIMS-PROCESSING.
  9498
  9499******************************************************************
  9500***       P R O C E S S   D I S A B I L I T Y   C L A I M      ***
  9501******************************************************************
  9502
  9503 0750-PROCESS-DISABILITY-CLAIM.
  9504
  9505     ADD +1                       TO W-AH-CLAIMS.
  9506
  9507     MOVE INCURRED-DATE           TO CR-DIS-DT
  9508                                     WS-CR-DIS-DT-N.
  9509
  9510     PERFORM 0790-TABLE-DISAB-PERIODS THRU 0791-TABLE-AH-EXIT.
  9511
  9512     IF REIN-AH-CLM-MONTHS = +1
  9513         MOVE REIN-AH-CLM-MTH-1        TO REIN-AH-CLM-MONTHS
  9514     ELSE
  9515       IF REIN-AH-CLM-MONTHS = +2
  9516           MOVE REIN-AH-CLM-MTH-2      TO REIN-AH-CLM-MONTHS
  9517       ELSE
  9518         IF REIN-AH-CLM-MONTHS = +3
  9519             MOVE REIN-AH-CLM-MTH-3    TO REIN-AH-CLM-MONTHS
  9520         ELSE
  9521           IF REIN-AH-CLM-MONTHS = +4
  9522               MOVE REIN-AH-CLM-MTH-4  TO REIN-AH-CLM-MONTHS
  9523           ELSE
  9524               MOVE REIN-AH-CLM-MTH-5  TO REIN-AH-CLM-MONTHS.
  9525
  9526     IF PC-CHARGEBLE-EXPENSE  OR
  9527        PC-NON-CHARGEBLE-EXPENSE
  9528         IF CR-AHTYP = '00'
  9529             MOVE '99'             TO CR-AHTYP  CLAS-LOOK
  9530             PERFORM 8400-A-H-TYPE-LOOKUP THRU
  9531                     8499-A-H-LOOKUP-X.
  9532
  9533     IF PC-CHARGEBLE-EXPENSE  OR
  9534        PC-NON-CHARGEBLE-EXPENSE
  9535         ADD PC-CLAIM-PAYMENT      TO CR-DISEXP
  9536         ADD PC-CLAIM-PAYMENT      TO CR-DISEXP-YTD
  9537         ADD PC-CLAIM-PAYMENT      TO TPA-CLAIMS (1)
  9538         MOVE PC-CLAIM-PAYMENT     TO TRD-AHCOM-CLM
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 186
* ECS010Z.cbl
  9539         MOVE 'CLAIM EXP '         TO TRD-AH-ACTION
  9540         GO TO 0780-END-CLAIMS-PROCESSING.
  9541
  9542     ADD +1                       TO CR-NUM-DIS-CLM.
  9543
  9544     MOVE REPORTED-DATE           TO  CR-DIS-RPT-DT.
  9545     MOVE PAYMENT-DATE            TO  CR-DIS-PAY-DT
  9546                                      WS-CR-DIS-PAY-DT-N.
  9547     MOVE PAY-TO-DATE             TO  CR-DIS-PTO-DT
  9548                                      WS-CR-DIS-PTO-DT-N.
  9549
  9550     ADD  PC-CLAIM-PAYMENT         TO CR-DISAMT.
  9551     ADD  PC-CLAIM-PAYMENT         TO CR-DISAMT-YTD.
  9552     MOVE PC-CLAIM-PAYMENT         TO CR-DISAMT-LAST.
  9553
  9554     MOVE PC-NO-OF-DAYS-PAID       TO CR-DAYS-DISAB.
  9555     IF CR-DIS-PAY-CD NOT = 'S'
  9556         MOVE PC-PAYMENT-TYPE      TO CR-DIS-PAY-CD.
  9557     INSPECT CR-DIS-PAY-CD
  9558         CONVERTING '12349' TO 'PFSXV'.
  9559     MOVE PC-CAUSE-CODE            TO CR-DISAB-CAUSE.
  9560
  9561     IF PC-LUMP-SUM-PAYMENT
  9562         IF CR-AH-SETTLEMENT-EXIT-DATE = ZEROS
  9563           MOVE CR-AH-CURRENT-STATUS TO CR-AH-STATUS-AT-SETTLEMENT
  9564           MOVE '6'                  TO CR-AH-CURRENT-STATUS
  9565           MOVE EOM-RUN-DATE    TO CR-AH-SETTLEMENT-EXIT-DATE
  9566                                   WS-CR-AH-SETTLEMENT-EXIT-DATEN.
  9567
  9568     MOVE CLAS-I-AB3 (CLAS-INDEXA) TO TRD-AHTYP.
  9569     MOVE CR-AH-TERM               TO TRD-AHTRM.
  9570     MOVE PC-CLAIM-PAYMENT         TO TRD-AHCOM-CLM.
  9571     MOVE 'CLAIM PYMT'             TO TRD-AH-ACTION.
  9572     MOVE CR-AH-CURRENT-STATUS     TO TRD-AH-STATUS.
  9573
  9574     IF NOT CR-POLICY-IS-REIN-ONLY
  9575         ADD PC-CLAIM-PAYMENT      TO TPA-CLAIMS (1).
  9576
  9577     IF NOT PC-LUMP-SUM-PAYMENT
  9578         GO TO 0780-END-CLAIMS-PROCESSING.
  9579
  9580 0770-CANCEL-LF-COVERAGE.
  9581
  9582     IF CR-LFTYP = ZEROS  OR
  9583        NOT CR-LF-POLICY-IS-ACTIVE
  9584         GO TO 0780-END-CLAIMS-PROCESSING.
  9585
  9586     MOVE CR-LF-CURRENT-STATUS          TO CR-LF-STATUS-AT-CANCEL.
  9587     MOVE '6'                           TO CR-LF-CURRENT-STATUS.
  9588     MOVE CR-DIS-PAY-DT                 TO CR-LF-CANC-DT
  9589                                           WS-CR-LF-CANC-DT-N.
  9590     MOVE EOM-RUN-DATE               TO CR-LF-CANCEL-EXIT-DATE
  9591                                     WS-CR-LF-CANCEL-EXIT-DATE-N.
  9592
  9593     MOVE CLAS-I-AB3 (CLAS-INDEXL)      TO TRD-LFTYP.
  9594     MOVE CR-LF-TERM                    TO TRD-LFTRM.
  9595     MOVE CR-DIS-PAY-MO                 TO TRD-LFACTMO.
  9596     MOVE CR-DIS-PAY-DA                 TO TRD-LFACTDA.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 187
* ECS010Z.cbl
  9597     MOVE CR-DIS-PAY-YR                 TO TRD-LFACTYR.
  9598     MOVE '/'                           TO TRD-LF-S1  TRD-LF-S2.
  9599     MOVE 'CLAIM CANC'                  TO TRD-LF-ACTION.
  9600     MOVE CR-LF-CURRENT-STATUS          TO TRD-LF-STATUS.
  9601
  9602 0780-END-CLAIMS-PROCESSING.
  9603
  9604     IF PC-LF-CLAIM  OR  PC-OB-LF-CLAIM
  9605         MOVE DTO-MO               TO TRD-LFACTMO
  9606         MOVE DTO-DA               TO TRD-LFACTDA
  9607         MOVE DTO-YR               TO TRD-LFACTYR
  9608         MOVE '/'                  TO TRD-LF-S1  TRD-LF-S2
  9609     ELSE
  9610         MOVE PAY-MO               TO TRD-AHACTMO
  9611         MOVE PAY-DA               TO TRD-AHACTDA
  9612         MOVE PAY-YR               TO TRD-AHACTYR
  9613         MOVE '/'                  TO TRD-AH-S1  TRD-AH-S2.
  9614
  9615     PERFORM 8690-PRINT-DETAIL-LINE THRU 8699-PRT-DETAIL-X.
  9616
  9617     IF NOT CR-POLICY-IS-REIN-ONLY
  9618         PERFORM 2300-BUILD-CLAIM-EXTRACT THRU 2399-BLD-CLAIM-X
  9619         ADD +1                    TO BC-G-CLM.
  9620
  9621     PERFORM 3300-REINSURE-CLAIM THRU 3399-REINSURE-CLAIM-X.
  9622
  9623     IF DEATH-CLAIM-VOIDED
  9624         MOVE ZEROS                TO CR-DTH-DT
  9625                                      WS-CR-DTH-DT-N.
  9626     MOVE SPACE                    TO DEATH-VOID-FLAG.
  9627
  9628     MOVE '*'                      TO TRANSACTION-FLAG.
  9629     GO TO 0300-READ-PENDING-TRANSACTIONS.
  9630
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 188
* ECS010Z.cbl
  9632 0790-TABLE-DISAB-PERIODS.
  9633
  9634     MOVE +1                       TO SUB14.
  9635     PERFORM 0794-REVIEW-TABLE     THRU 0794-REVIEW-TABLE-EXIT.
  9636
  9637     MOVE +1                       TO SUB14.
  9638
  9639**************************************************************
  9640**                                                          **
  9641**   THIS ROUTINE SEARCHES THROUGH THE DISAB-DETAIL-DATA    **
  9642**  AND MATCHES INCURRED DATE.  IT THEN ADDS THE AMOUNT OF  **
  9643**  THE CLAIM TO THAT OCCURRENCE.  IF THE INCURRED DATE     **
  9644**  DOES NOT MATCH ANY PREVIOUS INCURRED DATE,  IT WILL     **
  9645**  INITIALIZE THE NEXT OCCURRENCE.  (OLDEST TO MOST RECENT)**
  9646**                                                          **
  9647**    IF ALL 5 OCCURRENCES ARE FILLED,  THE TWO OLDEST      **
  9648**  AMOUNTS ARE COMBINED LEAVING THE LAST OCCURRENCE OPEN   **
  9649**  FOR THE MOST RECENT CLAIM INFORMATION.                  **
  9650**                                                          **
  9651**************************************************************
  9652
  9653 0791-TABLE-AH-AMOUNT.
  9654
  9655     IF SUB14 GREATER THAN DISABILITY-TBL-MAX
  9656         PERFORM 0792-MOVE-TABLE  THRU 0792-MOVE-TABLE-EXIT.
  9657
  9658     IF CR-DIS-INCUR-DT (SUB14)  EQUAL ZEROS
  9659         MOVE INCURRED-DATE        TO CR-DIS-INCUR-DT (SUB14)
  9660                                      WS-CR-DIS-INCUR-DT-N (SUB14)
  9661         IF REIN-IS-RISK-PREMIUM
  9662             MOVE INCURRED-DATE     TO DC-GREG-DATE-CYMD
  9663             PERFORM 3025-CALC-ELAPSED-MONTHS THRU 3026-CALC-EXIT
  9664             IF SUB14 = +1
  9665               MOVE DC-ELAPSED-MONTHS TO REIN-AH-CLM-MTH-1
  9666             ELSE
  9667             IF SUB14 = +2
  9668               MOVE DC-ELAPSED-MONTHS TO REIN-AH-CLM-MTH-2
  9669             ELSE
  9670             IF SUB14 = +3
  9671               MOVE DC-ELAPSED-MONTHS TO REIN-AH-CLM-MTH-3
  9672             ELSE
  9673             IF SUB14 = +4
  9674               MOVE DC-ELAPSED-MONTHS TO REIN-AH-CLM-MTH-4
  9675             ELSE
  9676               MOVE DC-ELAPSED-MONTHS TO REIN-AH-CLM-MTH-5.
  9677
  9678
  9679     IF INCURRED-DATE EQUAL CR-DIS-INCUR-DT (SUB14)
  9680         MOVE SUB14                TO REIN-AH-CLM-MONTHS
  9681         COMPUTE REIN-AH-PRIOR-CLMS-PAID = CR-INCUR-DISAMT (SUB14)
  9682                                        +  CR-INCUR-DISEXP (SUB14)
  9683         IF PC-CHARGEBLE-EXPENSE  OR
  9684            PC-NON-CHARGEBLE-EXPENSE
  9685             ADD PC-CLAIM-PAYMENT  TO CR-INCUR-DISEXP (SUB14)
  9686             GO TO 0791-TABLE-AH-EXIT
  9687         ELSE
  9688             ADD  PC-CLAIM-PAYMENT TO CR-INCUR-DISAMT (SUB14)
  9689             GO TO 0791-TABLE-AH-EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 189
* ECS010Z.cbl
  9690
  9691     ADD +1                       TO SUB14.
  9692
  9693     GO TO 0791-TABLE-AH-AMOUNT.
  9694
  9695 0791-TABLE-AH-EXIT.
  9696     EXIT.
  9697
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 190
* ECS010Z.cbl
  9699**************************************************************
  9700**                                                          **
  9701** THIS ROUTINE IS PERFORMED WHEN THERE HAVE BEEN MORE THAN **
  9702** 5 DISABILITY PERIODS ATTACHED TO THE SAME CERTIFICATE.   **
  9703**                                                          **
  9704** THE SECOND OCCURRENCE IS ADDED TO THE 1ST OCCURRENCE     **
  9705** COMBINING THE TWO OLDEST OCCURRENCES INTO ONE BUCKET     **
  9706** THE NEWEST CLAIM INFORMATION IS MOVED INTO THE LAST      **
  9707** OCCURRENCE.                                              **
  9708**************************************************************
  9709 0792-MOVE-TABLE.
  9710
  9711     MOVE CR-DIS-INCUR-DT (2)  TO CR-DIS-INCUR-DT (1)
  9712                                  WS-CR-DIS-INCUR-DT-N (1).
  9713     ADD  CR-INCUR-DISAMT (2)  TO CR-INCUR-DISAMT (1).
  9714     ADD  CR-INCUR-DISEXP (2)  TO CR-INCUR-DISEXP (1).
  9715
  9716     MOVE +2                   TO SUB14.
  9717     MOVE +3                   TO SUB15.
  9718     PERFORM 0794A-BUMP-TBL    THRU 0794A-BUMP-TBL-EXIT.
  9719
  9720     MOVE DISABILITY-TBL-MAX   TO SUB14.
  9721
  9722     MOVE INCURRED-DATE        TO CR-DIS-INCUR-DT (SUB14)
  9723                                  WS-CR-DIS-INCUR-DT-N (SUB14).
  9724
  9725 0792-MOVE-TABLE-EXIT.
  9726     EXIT.
  9727
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 191
* ECS010Z.cbl
  9729**************************************************************
  9730**                                                          **
  9731**  A REVIEW OF ALL OCCURRENCES IS PERFORMED TO ELIMINATE   **
  9732** ANY WITH NO PAYMENTS OR EXPENSES ATTACHED. THESE CAN     **
  9733** OCCUR WHEN DISABILITY PAYMENTS HAVE BEEN VOIDED, BECAUSE **
  9734** CLAIM ATTACHED TO WRONG CERTIFICATE, OR WRONG CLAIM TYPE **
  9735** PAID, OR A CHANGE IN THE INCURRED DATE OF A CLAIM.       **
  9736**************************************************************
  9737
  9738 0794-REVIEW-TABLE.
  9739
  9740     IF SUB14 GREATER THAN DISABILITY-TBL-MAX
  9741         GO TO 0794-REVIEW-TABLE-EXIT.
  9742
  9743     IF CR-DIS-INCUR-DT (SUB14) EQUAL ZEROS
  9744         GO TO 0794-REVIEW-TABLE-EXIT.
  9745
  9746     IF CR-INCUR-DISAMT (SUB14) EQUAL ZEROS  AND
  9747        CR-INCUR-DISEXP (SUB14) EQUAL ZEROS
  9748         DISPLAY CR-ACCOUNT ' ' CR-CERT-NO ' ' SUB14
  9749         MOVE ZEROS            TO CR-DIS-INCUR-DT (SUB14)
  9750                                  WS-CR-DIS-INCUR-DT-N (SUB14)
  9751         MOVE SUB14            TO SUB15
  9752         ADD +1                TO SUB15
  9753         PERFORM 0794A-BUMP-TBL   THRU 0794A-BUMP-TBL-EXIT
  9754         MOVE +1               TO SUB14
  9755         GO TO 0794-REVIEW-TABLE.
  9756
  9757     ADD +1                    TO SUB14.
  9758
  9759     GO TO 0794-REVIEW-TABLE.
  9760
  9761 0794-REVIEW-TABLE-EXIT.
  9762     EXIT.
  9763
  9764 0794A-BUMP-TBL.
  9765
  9766     IF SUB15 GREATER THAN DISABILITY-TBL-MAX
  9767         GO TO 0794A-BUMP-TBL-EXIT.
  9768
  9769     MOVE CR-DISAB-DETAIL-DATA (SUB15)  TO
  9770                             CR-DISAB-DETAIL-DATA (SUB14).
  9771
  9772     MOVE ZEROS                TO CR-DIS-INCUR-DT (SUB15)
  9773                                  WS-CR-DIS-INCUR-DT-N (SUB15)
  9774                                  CR-INCUR-DISAMT (SUB15)
  9775                                  CR-INCUR-DISEXP (SUB15).
  9776
  9777     ADD +1                    TO SUB14
  9778                                  SUB15.
  9779     GO TO 0794A-BUMP-TBL.
  9780
  9781 0794A-BUMP-TBL-EXIT.
  9782     EXIT.
  9783
  9784 0795-DCC-NSP-LF.
  9785
  9786     MOVE CR-DT                      TO DC-GREG-DATE-CYMD.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 192
* ECS010Z.cbl
  9787     MOVE 'L'                        TO DC-OPTION-CODE.
  9788     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
  9789     MOVE DC-BIN-DATE-1              TO CP-CERT-EFF-DT.
  9790     MOVE SPACES                     TO CP-ACCT-FLD-5.
  9791     MOVE DTE-CLIENT                 TO CP-COMPANY-ID.
  9792     MOVE CR-AGE                     TO CP-ISSUE-AGE.
  9793     MOVE CR-APR                     TO CP-LOAN-APR.
  9794     MOVE CR-PMT-FREQ                TO CP-PAY-FREQUENCY.
  9795     MOVE CR-LOAN-TERM               TO CP-LOAN-TERM.
  9796     MOVE ZEROS                      TO CP-DEVIATION-CODE.
  9797     MOVE CR-RATING-CLASS            TO CP-CLASS-CODE.
  9798
  9799     MOVE '3'                        TO CP-PROCESS-TYPE.
  9800     MOVE DTE-CLASIC-COMPANY-CD      TO CP-COMPANY-CD.
  9801     MOVE CR-PMT-EXTENSION-DAYS      TO CP-TERM-OR-EXT-DAYS.
  9802
  9803     IF CR-LFTYP = ZERO
  9804         GO TO 0795-EXIT
  9805     END-IF
  9806
  9807     IF (CLAS-I-BAL (CLAS-INDEXL) = 'B')
  9808         GO TO 0795-EXIT
  9809     END-IF
  9810     MOVE CR-LFPRM                   TO CP-ORIGINAL-PREMIUM
  9811     MOVE CLAS-I-RL-AH (CLAS-INDEXL) TO CP-BENEFIT-TYPE.
  9812     MOVE CR-LF-TERM                 TO CP-ORIGINAL-TERM.
  9813     MOVE CR-LFAMT                   TO CP-ORIGINAL-BENEFIT
  9814                                        CP-RATING-BENEFIT-AMT.
  9815     MOVE CLAS-I-EP (CLAS-INDEXL)    TO CP-EARNING-METHOD.
  9816     MOVE CLAS-I-BAL (CLAS-INDEXL)   TO CP-SPECIAL-CALC-CD.
  9817     MOVE CR-LFTYP                   TO CP-BENEFIT-CD.
  9818     MOVE LIFE-OVERRIDE-L1           TO CP-LIFE-OVERRIDE-CODE.
  9819     MOVE ZEROS                      TO CP-RATE-DEV-PCT.
  9820     MOVE CR-STATE                   TO CP-STATE.
  9821     MOVE STATE-ABBR (CLAS-INDEXS)   TO CP-STATE-STD-ABBRV.
  9822
  9823     IF CP-STATE-STD-ABBRV = 'OR'
  9824         COMPUTE CP-RATING-BENEFIT-AMT = CR-LFAMT + CR-LFAMT-ALT.
  9825
  9826     PERFORM 8100-GET-RATE THRU 8199-GET-RATE-X.
  9827
  9828     IF CP-ERROR-RATE-NOT-FOUND  OR
  9829        CP-ERROR-RATE-IS-ZERO
  9830         MOVE 'LIFE NET SINGLE PREMIUM RATE NOT FOUND'
  9831                                     TO WS-ABEND-MESSAGE
  9832         MOVE 0302                   TO WS-ABEND-CODE
  9833         DISPLAY '******************************'
  9834         DISPLAY '***** ERROR LOCATION 018 *****'
  9835         DISPLAY '******************************'
  9836         MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
  9837         GO TO ABEND-PGM.
  9838
  9839     MOVE CP-CALC-PREMIUM          TO CR-LF-NSP-PRM.
  9840
  9841*    COMPUTE CR-LF-NSP-PRM ROUNDED =
  9842*                      (CR-LFAMT / 100) * CP-PREMIUM-RATE.
  9843
  9844     COMPUTE CR-LF-NSP-PRM ROUNDED =  CR-LF-NSP-PRM +
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 193
* ECS010Z.cbl
  9845                   ((CR-LFAMT-ALT / 100) * CP-PREMIUM-RATE).
  9846
  9847     MOVE CP-PREMIUM-RATE            TO CR-LF-NSP-PRM-RATE.
  9848
  9849 0795-exit.
  9850     exit.
  9851
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 194
* ECS010Z.cbl
  9853******************************************************************
  9854***   P R O C E S S   R E S E R V E   T R A N S A C T I O N S  ***
  9855******************************************************************
  9856
  9857 0800-PROCESS-RESERVES.
  9858
  9859     IF PC-AH-CLAIM  OR  PC-OB-AH-CLAIM
  9860       IF CARRIER-UEP-PCT (CLAS-INDEXCN) NOT = ZEROS
  9861           MOVE ZEROS             TO  PC-IBNR-RESERVE-AMT.
  9862
  9863     PERFORM 3000-REINSURE-ROUTINE THRU 3099-REINSURE-ROUTINE-X.
  9864
  9865     MOVE PC-INCURRED-DT          TO  DC-BIN-DATE-1.
  9866     MOVE ' '                     TO  DC-OPTION-CODE.
  9867     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
  9868     MOVE DC-GREG-DATE-CYMD       TO  INCURRED-DATE.
  9869
  9870     MOVE PC-REPORTED-DT          TO  DC-BIN-DATE-1.
  9871     MOVE ' '                     TO  DC-OPTION-CODE.
  9872     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
  9873     MOVE DC-GREG-DATE-1-YMD      TO  REPORTED-DATE.
  9874
  9875     MOVE PC-PAID-THRU-DT         TO  DC-BIN-DATE-1.
  9876     MOVE ' '                     TO  DC-OPTION-CODE.
  9877     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
  9878     MOVE DC-GREG-DATE-CYMD       TO  PAY-TO-DATE.
  9879
  9880     PERFORM 8600-SETUP-DETAIL-LINE THRU 8689-SETUP-DETAIL-X.
  9881
  9882     IF PC-LF-CLAIM  OR  PC-OB-LF-CLAIM
  9883         ADD +1                     TO W-LF-RESERVES
  9884         ADD PC-IBNR-RESERVE-AMT    TO DTH-IBNR
  9885         ADD PC-PTC-RESERVE-AMT     TO DTH-PAYCUR
  9886         ADD PC-FUTURE-RESERVE-AMT  TO DTH-FUTRSV
  9887         ADD PC-MANUAL-RESERVE-AMT  TO DTH-FUTRSV
  9888         MOVE INCURRED-DATE         TO CR-DTH-DT
  9889                                       WS-CR-DTH-DT-N
  9890         MOVE LIFE-OVERRIDE-L6      TO TRD-RSV-DESC
  9891
  9892     ELSE
  9893         ADD +1                     TO W-AH-RESERVES
  9894         ADD PC-IBNR-RESERVE-AMT    TO DIS-IBNR
  9895         ADD PC-PTC-RESERVE-AMT     TO DIS-PAYCUR
  9896         ADD PC-FUTURE-RESERVE-AMT  TO DIS-FUTRSV
  9897         ADD PC-MANUAL-RESERVE-AMT  TO DIS-FUTRSV
  9898         MOVE INCURRED-DATE         TO CR-DIS-DT
  9899                                       WS-CR-DIS-DT-N
  9900         MOVE AH-OVERRIDE-L6        TO TRD-RSV-DESC.
  9901
  9902     MOVE PC-IBNR-RESERVE-AMT       TO TRD-IBNR.
  9903     MOVE 'IBNR'                    TO TRD-IBNRX.
  9904     MOVE PC-PTC-RESERVE-AMT        TO TRD-PAYCUR.
  9905     MOVE 'PAY CURR'                TO TRD-PAYCURX.
  9906     COMPUTE TRD-FUTRSV EQUAL
  9907            (PC-FUTURE-RESERVE-AMT + PC-MANUAL-RESERVE-AMT).
  9908     MOVE 'FUTURE'                  TO TRD-FUTRSVX.
  9909     MOVE ' CLAIM RESERVES      '   TO TRD-RSV-ACTION.
  9910
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 195
* ECS010Z.cbl
  9911 0820-END-RESERVE-PROCESSING.
  9912
  9913     PERFORM 8690-PRINT-DETAIL-LINE THRU 8699-PRT-DETAIL-X.
  9914
  9915     IF NOT CR-POLICY-IS-REIN-ONLY
  9916         PERFORM 2400-BUILD-RESERVE-EXTRACT THRU
  9917                                            2499-BLD-RESERVE-X
  9918         ADD +1 TO BC-G-CRS.
  9919
  9920     PERFORM 3400-REINSURE-RESERVE THRU 3499-REINSURE-RESERVE-X.
  9921
  9922     MOVE '*'                    TO TRANSACTION-FLAG.
  9923     GO TO 0300-READ-PENDING-TRANSACTIONS.
  9924
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 196
* ECS010Z.cbl
  9926******************************************************************
  9927***    P R O C E S S   C H A N G E   T R A N S A C T I O N S   ***
  9928******************************************************************
  9929
  9930 0900-PROCESS-CERT-CHANGES.
  9931
  9932     PERFORM 8600-SETUP-DETAIL-LINE THRU 8689-SETUP-DETAIL-X.
  9933
  9934     IF CC-AGE NOT NUMERIC  OR
  9935        CC-AGE = CR-AGE
  9936         MOVE ZEROS TO CC-AGE.
  9937
  9938     IF CC-INSURED-JOINT-AGE NOT NUMERIC  OR
  9939        CC-INSURED-JOINT-AGE = CR-JOINT-AGE
  9940         MOVE ZEROS TO CC-INSURED-JOINT-AGE.
  9941
  9942     IF CC-INSURED-SEX NOT = 'M'  AND
  9943        CC-INSURED-SEX NOT = 'F'
  9944         MOVE SPACES TO CC-INSURED-SEX.
  9945
  9946     IF CC-LOAN-APR NOT NUMERIC  OR
  9947        CC-LOAN-APR = CR-APR
  9948         MOVE ZEROS TO CC-LOAN-APR.
  9949
  9950     IF CC-PAY-FREQUENCY NOT NUMERIC  OR
  9951        CC-PAY-FREQUENCY = CR-PMT-FREQ
  9952         MOVE ZEROS TO CC-PAY-FREQUENCY.
  9953
  9954     IF CC-IND-GRP-TYPE NOT = '1'  AND
  9955        CC-IND-GRP-TYPE NOT = '2'
  9956         MOVE SPACES TO CC-IND-GRP-TYPE.
  9957
  9958     IF CC-CLAIM-DEDUCT-WITHHELD NOT NUMERIC  OR
  9959        CC-CLAIM-DEDUCT-WITHHELD = CR-CLAIM-DEDUCT-WITHHELD
  9960         MOVE ZEROS TO CC-CLAIM-DEDUCT-WITHHELD.
  9961
  9962     IF CC-CANCEL-DEDUCT-WITHHELD NOT NUMERIC  OR
  9963        CC-CANCEL-DEDUCT-WITHHELD = CR-CANCEL-DEDUCT-WITHHELD
  9964         MOVE ZEROS TO CC-CANCEL-DEDUCT-WITHHELD.
  9965
  9966     IF CC-LF-ORIG-TERM NOT NUMERIC  OR
  9967        CC-LF-ORIG-TERM = CR-LF-TERM  OR
  9968        CR-LFTYP = ZEROS
  9969         MOVE ZEROS TO CC-LF-ORIG-TERM.
  9970
  9971     IF CC-AH-ORIG-TERM NOT NUMERIC  OR
  9972        CC-AH-ORIG-TERM = CR-AH-TERM  OR
  9973        CR-AHTYP = ZEROS
  9974         MOVE ZEROS TO CC-AH-ORIG-TERM.
  9975
  9976     IF CR-BILLED NOT NUMERIC
  9977         MOVE ZEROS TO CR-BILLED.
  9978
  9979     IF CR-LIVES NOT NUMERIC
  9980         MOVE ZEROS TO CR-LIVES.
  9981
  9982     IF CC-LIVES NOT NUMERIC  OR
  9983        CC-LIVES = CR-LIVES
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 197
* ECS010Z.cbl
  9984         MOVE ZEROS TO CC-LIVES.
  9985
  9986     IF CC-BILLED NOT NUMERIC  OR
  9987        CC-BILLED = CR-BILLED
  9988         MOVE ZEROS TO CC-BILLED.
  9989
  9990     IF CC-INSURED-LAST-NAME NOT = SPACES
  9991         MOVE CC-INSURED-LAST-NAME   TO CR-LNAME.
  9992     IF CC-INSURED-FIRST-NAME NOT = SPACES
  9993         MOVE CC-INSURED-FIRST-NAME  TO CR-FNAME.
  9994     IF CC-INSURED-INITIAL2 NOT = SPACES
  9995         MOVE CC-INSURED-INITIAL2    TO CR-INIT.
  9996     IF CC-JT-LAST-NAME NOT = SPACES
  9997         MOVE CC-JT-LAST-NAME        TO CR-JT-LNAME.
  9998     IF CC-JT-FIRST-NAME NOT = SPACES
  9999         MOVE CC-JT-FIRST-NAME       TO CR-JT-FNAME.
 10000     IF CC-JT-INITIAL NOT = SPACES
 10001         MOVE CC-JT-INITIAL          TO CR-JT-INIT.
 10002
 10003     IF CC-AGE NOT = ZEROS
 10004         MOVE CC-AGE                 TO CR-AGE
 10005                                        DET-AGE
 10006     ELSE
 10007         MOVE ZEROS                  TO DET-AGE.
 10008
 10009     IF CC-INSURED-JOINT-AGE NOT = ZEROS
 10010         MOVE CC-INSURED-JOINT-AGE   TO CR-JOINT-AGE
 10011                                        DET-JT-AGE
 10012     ELSE
 10013         MOVE ZEROS                  TO DET-JT-AGE.
 10014
 10015     IF CC-INSURED-SEX NOT = SPACES
 10016         MOVE CC-INSURED-SEX         TO CR-SEX
 10017                                        DET-SEX
 10018     ELSE
 10019         MOVE SPACE                  TO DET-SEX.
 10020
 10021     IF CC-MEMBER-NO NOT = SPACES
 10022         MOVE CC-MEMBER-NO           TO CR-MEMBER-NO
 10023                                        DET-PR-MEM
 10024     ELSE
 10025         MOVE SPACES                 TO DET-PR-MEM.
 10026
 10027     IF CC-SOC-SEC-NO NOT = SPACES
 10028         MOVE CC-SOC-SEC-NO          TO CR-SOC-SEC
 10029                                        DET-PR-SS
 10030     ELSE
 10031         MOVE SPACES                 TO DET-PR-SS.
 10032
 10033     IF CC-LOAN-APR NOT = ZEROS
 10034         MOVE CC-LOAN-APR            TO CR-APR
 10035                                        DET-PR-APR
 10036     ELSE
 10037         MOVE ZEROS                  TO DET-PR-APR.
 10038
 10039     IF CC-AGE NOT = ZERO  OR
 10040        CC-INSURED-JOINT-AGE NOT = ZERO  OR
 10041        CC-INSURED-SEX NOT = SPACE  OR
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 198
* ECS010Z.cbl
 10042        CC-MEMBER-NO NOT = SPACES  OR
 10043        CC-SOC-SEC-NO NOT = SPACES  OR
 10044        CC-LOAN-APR NOT = ZERO
 10045         MOVE DET-PR-UREC            TO TR-DTL2
 10046         MOVE 'Y'                    TO WS-CHANGE-REC-SW
 10047         PERFORM 8690-PRINT-DETAIL-LINE THRU 8699-PRT-DETAIL-X.
 10048
 10049     IF CC-LF-ORIG-TERM NOT = ZEROS
 10050         MOVE CR-LF-TERM             TO DET-O-LF-TERM
 10051         MOVE CC-LF-ORIG-TERM        TO CR-LF-TERM
 10052                                        DET-N-LF-TERM
 10053     ELSE
 10054         MOVE ZEROS                  TO DET-O-LF-TERM
 10055                                        DET-N-LF-TERM.
 10056
 10057     IF CC-AH-ORIG-TERM NOT = ZEROS
 10058         MOVE CR-AH-TERM             TO DET-O-AH-TERM
 10059         MOVE CC-AH-ORIG-TERM        TO CR-AH-TERM
 10060                                        DET-N-AH-TERM
 10061     ELSE
 10062         MOVE ZEROS                  TO DET-O-AH-TERM
 10063                                        DET-N-AH-TERM.
 10064
 10065     IF CC-LIVES NOT = ZEROS
 10066         MOVE CR-LIVES               TO DET-O-LIVES
 10067         MOVE CC-LIVES               TO CR-LIVES
 10068                                        DET-N-LIVES
 10069     ELSE
 10070         MOVE ZEROS                  TO DET-O-LIVES
 10071                                        DET-N-LIVES.
 10072
 10073     IF CC-BILLED NOT  = ZEROES
 10074         MOVE CC-BILLED              TO CR-BILLED.
 10075
 10076     IF CC-LF-ORIG-TERM NOT = ZERO  OR
 10077        CC-AH-ORIG-TERM NOT = ZERO  OR
 10078        CC-LIVES NOT = ZERO
 10079         MOVE DET-PR-UREC-2          TO TR-DTL2
 10080         MOVE 'Y'                    TO WS-CHANGE-REC-SW
 10081         PERFORM 8690-PRINT-DETAIL-LINE THRU 8699-PRT-DETAIL-X.
 10082
 10083     IF CC-IND-GRP-TYPE NOT = SPACES
 10084         MOVE CC-IND-GRP-TYPE        TO CR-IND-GRP
 10085                                        DET-IND-GRP
 10086     ELSE
 10087         MOVE SPACE                  TO DET-IND-GRP.
 10088
 10089     IF CC-PAY-FREQUENCY NOT = ZEROS
 10090         MOVE CC-PAY-FREQUENCY       TO CR-PMT-FREQ
 10091                                        DET-PMT-FREQ
 10092     ELSE
 10093         MOVE ZEROS                  TO DET-PMT-FREQ.
 10094
 10095     IF CC-POLICY-FORM-NO NOT = SPACES
 10096         MOVE CC-POLICY-FORM-NO      TO CR-POLICY-FORM-NO
 10097                                        DET-POL-FORM
 10098     ELSE
 10099         MOVE SPACES                 TO DET-POL-FORM.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 199
* ECS010Z.cbl
 10100
 10101     IF CC-LOAN-OFFICER NOT = SPACES
 10102         MOVE CC-LOAN-OFFICER        TO CR-LOAN-OFFICER
 10103                                        DET-LOAN-OFFICER
 10104     ELSE
 10105         MOVE SPACES                 TO DET-LOAN-OFFICER.
 10106
 10107     IF CC-USER-FIELD NOT = SPACES
 10108         MOVE CC-USER-FIELD          TO CR-USER-CODE
 10109                                        DET-USER-CODE
 10110     ELSE
 10111         MOVE SPACE                  TO DET-USER-CODE.
 10112
 10113     IF CC-IND-GRP-TYPE NOT = SPACE  OR
 10114        CC-PAY-FREQUENCY NOT = ZEROS  OR
 10115        CC-POLICY-FORM-NO NOT = SPACES  OR
 10116        CC-LOAN-OFFICER NOT = SPACES  OR
 10117        CC-USER-FIELD NOT = SPACES
 10118         MOVE DET-PR-UREC-3          TO TR-DTL2
 10119         MOVE 'Y'                    TO WS-CHANGE-REC-SW
 10120         PERFORM 8690-PRINT-DETAIL-LINE THRU 8699-PRT-DETAIL-X.
 10121
 10122     IF CC-CLAIM-DEDUCT-WITHHELD NOT = ZEROS
 10123         MOVE CC-CLAIM-DEDUCT-WITHHELD
 10124                                     TO CR-CLAIM-DEDUCT-WITHHELD
 10125                                        DET-CLM-DEDUCT
 10126     ELSE
 10127         MOVE ZEROS                  TO DET-CLM-DEDUCT.
 10128
 10129     IF CC-CANCEL-DEDUCT-WITHHELD NOT = ZEROS
 10130         MOVE CC-CANCEL-DEDUCT-WITHHELD
 10131                                     TO CR-CANCEL-DEDUCT-WITHHELD
 10132                                        DET-CAN-DEDUCT
 10133     ELSE
 10134         MOVE ZEROS                  TO DET-CAN-DEDUCT.
 10135
 10136     IF CC-CLAIM-DEDUCT-WITHHELD NOT = ZEROS  OR
 10137        CC-CANCEL-DEDUCT-WITHHELD NOT = ZEROS
 10138         MOVE DET-PR-UREC-4          TO TR-DTL2
 10139         MOVE 'Y'                    TO WS-CHANGE-REC-SW
 10140         PERFORM 8690-PRINT-DETAIL-LINE THRU 8699-PRT-DETAIL-X.
 10141
 10142     IF CC-LF-PREMIUM-AMT NOT NUMERIC
 10143         MOVE ZEROS              TO  CC-LF-PREMIUM-AMT.
 10144
 10145     IF CC-LF-BENEFIT-AMT NOT NUMERIC
 10146         MOVE ZEROS              TO  CC-LF-BENEFIT-AMT.
 10147
 10148     IF CC-AH-PREMIUM-AMT NOT NUMERIC
 10149         MOVE ZEROS              TO  CC-AH-PREMIUM-AMT.
 10150
 10151     IF CC-AH-BENEFIT-AMT NOT NUMERIC
 10152         MOVE ZEROS              TO  CC-AH-BENEFIT-AMT.
 10153
 10154     IF CC-LF-BENEFIT-CD NOT = SPACES
 10155         MOVE CC-LF-BENEFIT-CD   TO  CR-LFTYP
 10156                                     DET-LF-BEN-CD
 10157     ELSE
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 200
* ECS010Z.cbl
 10158         MOVE SPACES             TO DET-LF-BEN-CD.
 10159
 10160     IF CC-LF-PREMIUM-AMT NOT = ZEROS
 10161         MOVE CC-LF-PREMIUM-AMT  TO  CR-LFPRM
 10162                                     DET-LF-PREM
 10163     ELSE
 10164         MOVE ZEROS              TO DET-LF-PREM.
 10165
 10166     IF CC-LF-BENEFIT-AMT NOT = ZEROS
 10167         MOVE CC-LF-BENEFIT-AMT  TO  CR-LFAMT
 10168                                     DET-LF-BEN
 10169     ELSE
 10170         MOVE ZEROS              TO DET-LF-BEN.
 10171
 10172     IF (CC-LF-BENEFIT-CD NOT = SPACES)  OR
 10173        (CC-LF-PREMIUM-AMT NOT = ZEROS)  OR
 10174        (CC-LF-BENEFIT-AMT NOT = ZEROS)
 10175         MOVE DET-PR-UREC-5          TO TR-DTL2
 10176         MOVE 'Y'                    TO WS-CHANGE-REC-SW
 10177         PERFORM 8690-PRINT-DETAIL-LINE THRU 8699-PRT-DETAIL-X.
 10178
 10179     IF CC-AH-BENEFIT-CD NOT = SPACES
 10180         MOVE CC-AH-BENEFIT-CD   TO  CR-AHTYP
 10181                                     DET-AH-BEN-CD
 10182     ELSE
 10183         MOVE SPACES             TO DET-AH-BEN-CD.
 10184
 10185     IF CC-AH-PREMIUM-AMT NOT = ZEROS
 10186         MOVE CC-AH-PREMIUM-AMT  TO  CR-AHPRM
 10187                                     DET-AH-PREM
 10188     ELSE
 10189         MOVE ZEROS              TO DET-AH-PREM.
 10190
 10191     IF CC-AH-BENEFIT-AMT NOT = ZEROS
 10192         MOVE CC-AH-BENEFIT-AMT  TO  CR-AHAMT
 10193                                     DET-AH-BEN
 10194     ELSE
 10195         MOVE ZEROS              TO DET-AH-BEN.
 10196
 10197     IF CC-AH-BENEFIT-CD NOT = SPACES OR
 10198        CC-AH-PREMIUM-AMT NOT = ZEROS OR
 10199        CC-AH-BENEFIT-AMT NOT = ZEROS
 10200         MOVE DET-PR-UREC-6          TO TR-DTL2
 10201         MOVE 'Y'                    TO WS-CHANGE-REC-SW
 10202         PERFORM 8690-PRINT-DETAIL-LINE THRU 8699-PRT-DETAIL-X.
 10203
 10204 0990-END-CHANGE-PROCESSING.
 10205
 10206     IF CR-LNAME = ALL '*'
 10207         MOVE SPACES                 TO CR-LNAME.
 10208     IF CR-FNAME = ALL '*'
 10209         MOVE SPACES                 TO CR-FNAME.
 10210     IF CR-INIT = '*'
 10211         MOVE SPACES                 TO CR-INIT.
 10212     IF CR-SOC-SEC = ALL '*'
 10213         MOVE SPACES                 TO CR-SOC-SEC.
 10214     IF CR-JT-LNAME = ALL '*'
 10215         MOVE SPACES                 TO CR-JT-LNAME.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 201
* ECS010Z.cbl
 10216     IF CR-JT-FNAME = ALL '*'
 10217         MOVE SPACES                 TO CR-JT-FNAME.
 10218     IF CR-JT-INIT = '*'
 10219         MOVE SPACES                 TO CR-JT-INIT.
 10220     IF CR-POLICY-FORM-NO = ALL '*'
 10221         MOVE SPACES                 TO CR-POLICY-FORM-NO.
 10222     IF CR-MEMBER-NO = ALL '*'
 10223         MOVE SPACES                 TO CR-MEMBER-NO.
 10224     IF CR-LOAN-OFFICER = ALL '*'
 10225         MOVE SPACES                 TO CR-LOAN-OFFICER.
 10226     IF CR-USER-CODE = ALL '*'
 10227         MOVE SPACES                 TO CR-USER-CODE.
 10228
 10229     ADD +1 TO BC-G-CTN.
 10230     GO TO 0300-READ-PENDING-TRANSACTIONS.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 202
* ECS010Z.cbl
 10232******************************************************************
 10233***      S E T   C O M M I S S I O N   S T R U C T U R E       ***
 10234******************************************************************
 10235
 10236 1000-SET-COMMISSION-STRUCTURE.
 10237
 10238     MOVE +1                     TO IA
 10239                                    IB.
 10240
 10241 1100-GET-COMMISSION-LEVEL.
 10242
 10243     MOVE AM-AGT-COMMS (IA)      TO WK-LEVEL.
 10244
 10245     IF WK-AGT = '0000000000' OR SPACES
 10246         MOVE +0                 TO WK-L-RT
 10247                                    WK-J-RT
 10248                                    WK-A-RT
 10249         GO TO 1200-SET-COMMISSION-LEVEL.
 10250
 10251 1110-LIFE-COMMISSION.
 10252
 10253     IF CR-LFTYP = ZERO  OR
 10254       (CR-ENTRY-STATUS = 'P' OR 'D' OR 'V')
 10255         MOVE +0 TO WK-L-RT
 10256                    WK-J-RT
 10257         GO TO 1130-A-H-COMMISSION.
 10258
 10259     IF CLAS-I-JOINT (CLAS-INDEXL) = 'J'
 10260         GO TO 1120-JOINT-LIFE-COMMISSION.
 10261
 10262     IF WK-L-RT NUMERIC
 10263        AND (WK-L-RTX (3:1) NOT = 'L' AND 'M')
 10264         MOVE WK-L-RT                TO WS-COMMISSION
 10265         PERFORM 6650-GET-RES-STATE-COMM  THRU 6700-COMM-EXIT
 10266         MOVE WS-COMMISSION          TO WK-L-RT
 10267         GO TO 1130-A-H-COMMISSION.
 10268
 10269     MOVE LIFE-OVERRIDE-L1           TO CTBL-BEN-TYPE.
 10270     MOVE CR-LFTYP                   TO CTBL-BEN-CODE.
 10271     MOVE ZEROS                      TO WS-SUB1.
 10272     PERFORM 6650-GET-RES-STATE-COMM  THRU 6700-COMM-EXIT
 10273
 10274     IF WS-SUB1 = ZEROS
 10275         MOVE WK-L-RTX               TO CTBL-TABLE-CD
 10276     ELSE
 10277         MOVE WK-RATE                TO WK-L-RT
 10278         GO TO 1130-A-H-COMMISSION.
 10279
 10280     PERFORM 1300-READ-ERCTBL-FILE THRU 1399-READ-ERCTBL-X.
 10281
 10282     MOVE CR-LFAMT                   TO COMM-CK-AMT.
 10283     MOVE CR-LF-TERM                 TO WS-COMM-TERM.
 10284     PERFORM 1400-GET-COMM-PERCENT THRU 1489-GET-PERCENT-X.
 10285     MOVE WK-RATE                    TO WK-L-RT.
 10286
 10287     GO TO 1130-A-H-COMMISSION.
 10288
 10289 1120-JOINT-LIFE-COMMISSION.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 203
* ECS010Z.cbl
 10290
 10291     IF WK-J-RT NUMERIC
 10292        AND (WK-J-RTX (3:1) NOT = 'L' AND 'M')
 10293         MOVE WK-J-RT                TO WS-COMMISSION
 10294         PERFORM 6650-GET-RES-STATE-COMM  THRU 6700-COMM-EXIT
 10295         MOVE WS-COMMISSION          TO WK-J-RT
 10296         GO TO 1130-A-H-COMMISSION.
 10297
 10298     MOVE LIFE-OVERRIDE-L1           TO CTBL-BEN-TYPE.
 10299     MOVE CR-LFTYP                   TO CTBL-BEN-CODE.
 10300     MOVE ZEROS                      TO WS-SUB1.
 10301     PERFORM 6650-GET-RES-STATE-COMM  THRU 6700-COMM-EXIT
 10302
 10303     IF WS-SUB1 = ZEROS
 10304         MOVE WK-J-RTX               TO CTBL-TABLE-CD
 10305     ELSE
 10306         MOVE WK-RATE                TO WK-J-RT
 10307         GO TO 1130-A-H-COMMISSION.
 10308
 10309     PERFORM 1300-READ-ERCTBL-FILE THRU 1399-READ-ERCTBL-X.
 10310
 10311     MOVE CR-LFAMT                   TO COMM-CK-AMT.
 10312     MOVE CR-LF-TERM                 TO WS-COMM-TERM.
 10313     PERFORM 1400-GET-COMM-PERCENT THRU 1489-GET-PERCENT-X.
 10314     MOVE WK-RATE                    TO WK-J-RT.
 10315
 10316 1130-A-H-COMMISSION.
 10317
 10318     IF CR-AHTYP = ZERO  OR
 10319       (CR-ENTRY-STATUS = 'P' OR 'D' OR 'V')
 10320         MOVE +0 TO WK-A-RT
 10321         GO TO 1200-SET-COMMISSION-LEVEL.
 10322
 10323     IF WK-A-RT NUMERIC
 10324        AND (WK-A-RTX (3:1) NOT = 'L' AND 'M')
 10325         MOVE WK-A-RT                TO WS-COMMISSION
 10326         PERFORM 6650-GET-RES-STATE-COMM  THRU 6700-COMM-EXIT
 10327         MOVE WS-COMMISSION          TO WK-A-RT
 10328         GO TO 1200-SET-COMMISSION-LEVEL.
 10329
 10330     MOVE AH-OVERRIDE-L1             TO CTBL-BEN-TYPE.
 10331     MOVE CR-AHTYP                   TO CTBL-BEN-CODE.
 10332     MOVE ZEROS                      TO WS-SUB1.
 10333     PERFORM 6650-GET-RES-STATE-COMM  THRU 6700-COMM-EXIT
 10334
 10335     IF WS-SUB1 = ZEROS
 10336         MOVE WK-A-RTX               TO CTBL-TABLE-CD
 10337     ELSE
 10338         MOVE WK-RATE                TO WK-A-RT
 10339         GO TO 1200-SET-COMMISSION-LEVEL.
 10340
 10341     PERFORM 1300-READ-ERCTBL-FILE THRU 1399-READ-ERCTBL-X.
 10342
 10343     COMPUTE COMM-CK-AMT = CR-AHAMT * CR-AH-TERM.
 10344     MOVE CR-AH-TERM                 TO WS-COMM-TERM.
 10345     PERFORM 1400-GET-COMM-PERCENT THRU 1489-GET-PERCENT-X.
 10346     MOVE WK-RATE                    TO WK-A-RT.
 10347
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 204
* ECS010Z.cbl
 10348 1200-SET-COMMISSION-LEVEL.
 10349
 10350     MOVE WK-AGT                      TO WK-N-AGT  (IA).
 10351     IF WK-AGT = '0000000000' OR SPACES
 10352         MOVE SPACE                   TO WK-N-TYPE (IA)
 10353     ELSE
 10354         MOVE WK-A-TYPE               TO WK-N-TYPE (IA).
 10355
 10356     IF CR-LFTYP = ZERO
 10357         MOVE +0                      TO WK-L-RT1  (IA)
 10358     ELSE
 10359         IF CLAS-I-JOINT (CLAS-INDEXL) = 'J'
 10360             MOVE WK-J-RT             TO WK-L-RT1 (IA)
 10361         ELSE
 10362             MOVE WK-L-RT             TO WK-L-RT1 (IA).
 10363
 10364     MOVE WK-A-RT                     TO WK-A-RT1 (IA).
 10365
 10366     IF RC-COMM-FLG = 'X'
 10367        IF AM-RECALC-LV-INDIC (IA) = 'N'
 10368            MOVE CR-COM-AGT  (IA)         TO WK-N-AGT  (IA)
 10369            MOVE CR-AGT-TYPE (IA)         TO WK-N-TYPE (IA)
 10370            MOVE CR-LCOM-L   (IA)         TO WK-L-RT1  (IA)
 10371            MOVE CR-LCOM-AH  (IA)         TO WK-A-RT1  (IA).
 10372
 10373     IF IA LESS THAN +10
 10374         ADD +1 TO IA
 10375         GO TO 1100-GET-COMMISSION-LEVEL.
 10376
 10377     GO TO 1499-SET-COMM-X.
 10378
 10379 1300-READ-ERCTBL-FILE.
 10380
 10381     IF CTBL-SEARCH = LAST-CTBL
 10382         GO TO 1399-READ-ERCTBL-X.
 10383
 10384     MOVE SPACE                          TO CTBL-ERROR-SWITCH.
 10385
 10386     IF COMM-OPEN-SW = ' '
 10387         MOVE 'X'                        TO COMM-OPEN-SW
 10388         MOVE DTE-CLASIC-COMPANY-CD      TO CTBL-COMP-CD
 10389         OPEN INPUT ERCTBL
 10390         IF ERCTBL-FILE-STATUS = '00'  OR  '97'
 10391             NEXT SENTENCE
 10392            ELSE
 10393             MOVE '41'                   TO ABEND-CODE-1
 10394             MOVE ERCTBL-FILE-STATUS     TO ABEND-CODE-2
 10395             DISPLAY '******************************'
 10396             DISPLAY '***** ERROR LOCATION 012 *****'
 10397             DISPLAY '******************************'
 10398             DISPLAY '******************************'
 10399             MOVE WS-ABEND-CODE          TO WS-RETURN-CODE
 10400             GO TO ABEND-PGM.
 10401
 10402     MOVE CTBL-SEARCH                    TO CT-CONTROL-PRIMARY
 10403                                            LAST-CTBL.
 10404     READ ERCTBL.
 10405
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 205
* ECS010Z.cbl
 10406     IF ERCTBL-FILE-STATUS = '23'
 10407         DISPLAY 'INVALID COMM TABLE CODE FOR: ' CR-FULL-CONTROL
 10408                 ' ENTERED: ' CR-ENTRY-STATUS '-' CR-ENTRY-DATE
 10409                 ' CTBL: ' CTBL-SEARCH
 10410         MOVE '*'                TO CTBL-ERROR-SWITCH
 10411         MOVE '44'               TO ABEND-CODE-1
 10412         MOVE ERCTBL-FILE-STATUS TO ABEND-CODE-2
 10413         DISPLAY 'CT-CONTROL-PRIMARY = ' CT-CONTROL-PRIMARY
 10414         DISPLAY '******************************'
 10415         DISPLAY '***** ERROR LOCATION 013 *****'
 10416         DISPLAY '******************************'
 10417         MOVE WS-ABEND-CODE      TO WS-RETURN-CODE
 10418*        IF DTE-CLIENT NOT = 'NCL'
 10419         IF DTE-CLIENT NOT = 'NCL' AND 'CID' AND 'CSO'
 10420             GO TO ABEND-PGM
 10421         ELSE
 10422             NEXT SENTENCE
 10423     ELSE
 10424         IF ERCTBL-FILE-STATUS NOT = '00'
 10425             MOVE 'READ ERROR ON ERCTBL' TO WS-ABEND-MESSAGE
 10426             MOVE '44'               TO ABEND-CODE-1
 10427             MOVE ERCTBL-FILE-STATUS TO ABEND-CODE-2
 10428             DISPLAY '******************************'
 10429             DISPLAY '***** ERROR LOCATION 014 *****'
 10430             DISPLAY '******************************'
 10431             MOVE WS-ABEND-CODE      TO WS-RETURN-CODE
 10432             GO TO ABEND-PGM.
 10433
 10434     ADD +1                            TO ERCTBL-READS.
 10435
 10436 1399-READ-ERCTBL-X.
 10437     EXIT.
 10438
 10439 1400-GET-COMM-PERCENT.
 10440
 10441     IF CTBL-ERROR
 10442         MOVE ZEROS                      TO WK-RATE
 10443         GO TO 1489-GET-PERCENT-X.
 10444
 10445     MOVE +1 TO IB.
 10446     IF (COMM-CK-AMT GREATER CT-TBF (1)) AND
 10447        (CT-TBF (1) NOT EQUAL +9999999.99)
 10448         ADD +9 TO IB
 10449         IF (COMM-CK-AMT GREATER CT-TBF (2)) AND
 10450            (CT-TBF (2) NOT EQUAL +9999999.99)
 10451             ADD +9 TO IB.
 10452
 10453     IF CR-AGE GREATER CT-AGE (1)
 10454         ADD +3 TO IB
 10455         IF CR-AGE GREATER CT-AGE (2)
 10456             ADD +3 TO IB.
 10457
 10458     IF WS-COMM-TERM GREATER CT-TRM (1)
 10459         ADD +1 TO IB
 10460         IF WS-COMM-TERM GREATER CT-TRM (2)
 10461             ADD +1 TO IB.
 10462
 10463     IF CT-RT (IB) NOT NUMERIC
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 206
* ECS010Z.cbl
 10464         MOVE LAST-CTBL     TO CT-CONTROL-PRIMARY
 10465         MOVE CT-RT-R (IB)  TO CTBL-TABLE-CD
 10466         GO TO 1300-READ-ERCTBL-FILE.
 10467
 10468     MOVE CT-RT (IB) TO WK-RATE.
 10469
 10470 1489-GET-PERCENT-X.
 10471     EXIT.
 10472
 10473 1499-SET-COMM-X.
 10474     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 207
* ECS010Z.cbl
 10476******************************************************************
 10477***  C O M P U T E   A C C T   L E V E L   C O M M I S S I O N ***
 10478******************************************************************
 10479
 10480 1500-GET-ACCT-LEVEL-LF-COMM.
 10481
 10482     MOVE ZEROS                      TO ACCT-COMM-LF
 10483                                        ACCT-COMM-AH.
 10484
 10485     MOVE +1                         TO IA.
 10486
 10487 1510-ACCT-LEVEL-LOOP.
 10488
 10489     IF CR-AGT-TYPE (IA) = 'C'  OR  'D' OR 'F' OR 'S'
 10490         IF WS-LEVELS-CHARGEBACK-SWITCHES = SPACES
 10491             ADD CR-LCOM-L (IA)  TO ACCT-COMM-LF
 10492             ADD CR-LCOM-AH (IA) TO ACCT-COMM-AH
 10493         ELSE
 10494             IF WS-LF-CHARGEBACK-SW (IA)  =  'Y'
 10495                 ADD CR-LCOM-L (IA)  TO ACCT-COMM-LF.
 10496
 10497     IF IA LESS THAN +10
 10498         ADD +1 TO IA
 10499         GO TO 1510-ACCT-LEVEL-LOOP.
 10500
 10501 1519-ACCT-LF-COMM-X.
 10502     EXIT.
 10503
 10504
 10505 1550-GET-ACCT-LEVEL-AH-COMM.
 10506
 10507     MOVE ZEROS                      TO ACCT-COMM-AH.
 10508
 10509     MOVE +1                         TO IA.
 10510
 10511 1555-ACCT-LEVEL-LOOP.
 10512
 10513     IF CR-AGT-TYPE (IA) = 'C'  OR  'D' OR 'F' OR 'S'
 10514         IF WS-AH-CHARGEBACK-SW (IA)  =  'Y'
 10515             ADD CR-LCOM-AH (IA)  TO ACCT-COMM-AH.
 10516
 10517     IF IA LESS THAN +10
 10518         ADD +1 TO IA
 10519         GO TO 1555-ACCT-LEVEL-LOOP.
 10520
 10521 1599-ACCT-AH-COMM-X.
 10522     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 208
* ECS010Z.cbl
 10524******************************************************************
 10525***      C O M M I S S I O N   R E C A L C   R O U T I N E     ***
 10526******************************************************************
 10527
 10528 1600-RECALC-COMM-EXTR.
 10529
 10530     IF RC-COMM-FLG = 'X'  OR
 10531        (DTE-PGM-OPT = '2'  OR  '3')  OR
 10532        CR-POLICY-IS-DECLINED  OR
 10533        CR-POLICY-IS-VOID
 10534         GO TO 1899-RECALC-COMM-EXTR-X.
 10535
 10536     MOVE 'X'                           TO RC-COMM-FLG.
 10537
 10538     IF CR-ENTRY-DATE = EOM-RUN-DATE
 10539         GO TO 1899-RECALC-COMM-EXTR-X.
 10540
 10541     PERFORM 1000-SET-COMMISSION-STRUCTURE THRU 1499-SET-COMM-X.
 10542
 10543     IF CR-COMPENSATION-LEVELS = WK-NEW-RATES
 10544         GO TO 1899-RECALC-COMM-EXTR-X.
 10545
 10546     MOVE WK-NEW-RATES                  TO SAVE-WK-NEW-RATES.
 10547
 10548     PERFORM 1610-CK-DUPLICATE-ENTRIES
 10549         THRU 1619-CK-DUPLICATE-ENTRIES-XIT
 10550             VARYING SUB11 FROM 1 BY 1 UNTIL SUB11 GREATER 10.
 10551
 10552     IF CR-COMPENSATION-LEVELS = WK-NEW-RATES
 10553         MOVE SAVE-WK-NEW-RATES         TO CR-COMPENSATION-LEVELS
 10554                                           WK-NEW-RATES
 10555         GO TO 1899-RECALC-COMM-EXTR-X.
 10556
 10557     MOVE +1                            TO SUB8.
 10558     GO TO 1700-REVERSE-OLD-COMM-LOOP.
 10559
 10560 1610-CK-DUPLICATE-ENTRIES.
 10561     PERFORM 1620-CK-DUPL-ENTR-NEW
 10562         THRU 1629-CK-DUPL-ENTR-NEW-XIT
 10563             VARYING SUB12 FROM 1 BY 1 UNTIL SUB12 GREATER 10.
 10564
 10565 1619-CK-DUPLICATE-ENTRIES-XIT.
 10566     EXIT.
 10567
 10568 1620-CK-DUPL-ENTR-NEW.
 10569     IF CR-AGT-LEVELS (SUB11) = WK-N-R (SUB12)
 10570         MOVE SPACES                    TO CR-COM-AGT (SUB11)
 10571         MOVE SPACE                     TO CR-AGT-TYPE (SUB11)
 10572         MOVE +0                        TO CR-LCOM-L (SUB11)
 10573                                           CR-LCOM-AH (SUB11)
 10574         MOVE CR-AGT-LEVELS (SUB11)     TO WK-N-R (SUB12)
 10575         MOVE 11                        TO SUB12.
 10576
 10577 1629-CK-DUPL-ENTR-NEW-XIT.
 10578     EXIT.
 10579
 10580 1700-REVERSE-OLD-COMM-LOOP.
 10581     COMPUTE CR-LCOM-L (SUB8) = CR-LCOM-L (SUB8) * -1.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 209
* ECS010Z.cbl
 10582     COMPUTE CR-LCOM-AH (SUB8) = CR-LCOM-AH (SUB8) * -1.
 10583
 10584     IF SUB8 LESS THAN +10
 10585         ADD +1 TO SUB8
 10586         GO TO 1700-REVERSE-OLD-COMM-LOOP.
 10587
 10588     MOVE 'O' TO RECALC-TYPE.
 10589
 10590     PERFORM 1710-DO-R-C-EXTRACTS THRU 1719-DO-R-C-EXTRACTS-X.
 10591
 10592     GO TO 1800-MOVE-NEW-COMM-RATES.
 10593
 10594 1710-DO-R-C-EXTRACTS.
 10595
 10596     PERFORM 2000-INITIALIZE-DETAIL-EXTRACT THRU 2099-INIT-DTL-X.
 10597
 10598     PERFORM 1720-CHECK-COMM-LEVELS
 10599         THRU 1729-CHECK-COMM-LEVELS-EXIT
 10600             VARYING SUB13 FROM +1 BY +1
 10601                 UNTIL SUB13 GREATER THAN 10.
 10602
 10603     MOVE '8'                           TO DE-TRANS.
 10604     MOVE RECALC-TYPE                   TO DE-RECALC-TYPE.
 10605*****PERFORM EXTRACT-DATE-RELOAD.
 10606     MOVE DETAIL-EXTRACT                TO SAVE-EXTRACT.
 10607     PERFORM 2500-WRITE-DETAIL-EXTRACTS THRU 2599-WRT-DETAIL-X.
 10608     MOVE SAVE-EXTRACT                  TO DETAIL-EXTRACT.
 10609     PERFORM EXTRACT-DATE-LOAD.
 10610     MOVE 'R'                           TO DE-REIN.
 10611     MOVE DETAIL-EXTRACT                TO SAVE-EXTRACT.
 10612     MOVE +1                            TO SUB1.
 10613     PERFORM 3110-REINSURE-ISSUE-LOOP
 10614         THRU 3119-REINSURE-ISSUE-LOOP-END.
 10615
 10616     IF CR-LF-CANCEL-APPLIED  OR  CR-AH-CANCEL-APPLIED
 10617         PERFORM 2200-BUILD-CANCEL-EXTRACT THRU
 10618                                       2259-END-CANCEL-BUILD
 10619         PERFORM 1720-CHECK-COMM-LEVELS
 10620             THRU 1729-CHECK-COMM-LEVELS-EXIT
 10621                 VARYING SUB13 FROM +1 BY +1
 10622                     UNTIL SUB13 GREATER THAN 10
 10623         MOVE '7'                       TO DE-TRANS
 10624         MOVE RECALC-TYPE               TO DE-RECALC-TYPE
 10625*********PERFORM EXTRACT-DATE-RELOAD
 10626         MOVE DETAIL-EXTRACT            TO SAVE-EXTRACT
 10627         PERFORM 2500-WRITE-DETAIL-EXTRACTS THRU 2599-WRT-DETAIL-X
 10628         MOVE SAVE-EXTRACT              TO DETAIL-EXTRACT
 10629         PERFORM EXTRACT-DATE-LOAD
 10630         MOVE 'R'                       TO DE-REIN
 10631         MOVE DETAIL-EXTRACT            TO SAVE-EXTRACT
 10632         MOVE +1                        TO SUB1
 10633         PERFORM 3210-REINSURE-CANCEL-LOOP
 10634             THRU 3219-REINSURE-CANCEL-LOOP-END.
 10635
 10636 1719-DO-R-C-EXTRACTS-X.
 10637     EXIT.
 10638
 10639 1720-CHECK-COMM-LEVELS.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 210
* ECS010Z.cbl
 10640
 10641     IF  DE-AGT (SUB13)       =  SPACES  AND
 10642         DE-AGT-TYPE (SUB13)  =  SPACES  AND
 10643         DE-L-PC (SUB13)      =  ZEROS   AND
 10644         DE-A-PC (SUB13)      =  ZEROS
 10645         MOVE '0000000000'        TO  DE-AGT (SUB13).
 10646
 10647 1729-CHECK-COMM-LEVELS-EXIT.
 10648     EXIT.
 10649
 10650 1800-MOVE-NEW-COMM-RATES.
 10651     MOVE WK-NEW-RATES                  TO CR-COMPENSATION-LEVELS.
 10652     MOVE 'N'                           TO RECALC-TYPE.
 10653     PERFORM 1710-DO-R-C-EXTRACTS THRU 1719-DO-R-C-EXTRACTS-X.
 10654     MOVE SAVE-WK-NEW-RATES             TO WK-NEW-RATES
 10655                                           CR-COMPENSATION-LEVELS.
 10656     IF DTE-CLIENT = 'DCC'
 10657        IF CR-LF-NSP-PRM NOT = ZEROS
 10658           COMPUTE CR-LF-NSP-PRM ROUNDED =
 10659              (CR-LFPRM + CR-LFPRM-ALT) -
 10660              ((CR-LFPRM + CR-LFPRM-ALT) * CR-LCOM-L (1))
 10661        END-IF
 10662        IF CR-AH-NSP-PRM NOT = ZEROS
 10663           COMPUTE CR-AH-NSP-PRM ROUNDED =
 10664           CR-AHPRM -
 10665           (CR-AHPRM * CR-LCOM-AH (1))
 10666        END-IF
 10667     END-IF
 10668     .
 10669
 10670 1899-RECALC-COMM-EXTR-X.
 10671     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 211
* ECS010Z.cbl
 10673******************************************************************
 10674***      I N I T I A L I Z E   D E T A I L   E X T R A C T     ***
 10675******************************************************************
 10676
 10677 2000-INITIALIZE-DETAIL-EXTRACT.
 10678
 10679     MOVE SPACES                   TO DETAIL-EXTRACT.
 10680
 10681     MOVE 'DE'                     TO DE-RECORD-ID.
 10682     MOVE CR-COMPANY-CD            TO DE-COMPANY-CD.
 10683     MOVE CR-FULL-CONTROL          TO DE-CONTROL.
 10684
 10685     MOVE AM-REPORT-CODE-1         TO DE-REPORT-CODE-1.
 10686     MOVE AM-REPORT-CODE-2         TO DE-REPORT-CODE-2.
 10687
 10688     MOVE CR-NAME                  TO DE-NAME.
 10689     MOVE CR-AGE                   TO DE-AGE.
 10690     MOVE CR-SEX                   TO DE-SEX.
 10691     MOVE CR-SOC-SEC               TO DE-SOC-SEC-NO.
 10692
 10693     MOVE CR-LFTYP                 TO DE-LF-TYPE.
 10694     MOVE CR-LF-TERM               TO DE-LF-TERM.
 10695     MOVE CR-LFAMT                 TO DE-LF-BEN.
 10696     MOVE ZEROS                    TO DE-LF-CNBEN.
 10697     MOVE CR-LFPRM                 TO DE-LF-PRM.
 10698     MOVE CR-LFAMT-ALT             TO DE-LF-BEN-ALT.
 10699     MOVE ZEROS                    TO DE-LF-CNBEN-ALT.
 10700     MOVE CR-LFPRM-ALT             TO DE-LF-PRM-ALT.
 10701     MOVE ZEROS                    TO DE-LF-RFND.
 10702
 10703     MOVE CR-LF-CURRENT-STATUS     TO DE-LF-STAT-CDE.
 10704     MOVE ZEROS                    TO DE-LF-CANC-DTE
 10705                                      DE-LF-CANC-EXIT-DT.
 10706
 10707     MOVE CR-AHTYP                 TO DE-AH-TYPE.
 10708     MOVE CR-AH-TERM               TO DE-AH-TERM.
 10709     MOVE CR-AHAMT                 TO DE-AH-BEN.
 10710     MOVE CR-AHPRM                 TO DE-AH-PRM.
 10711     MOVE ZEROS                    TO DE-AH-RFND.
 10712
 10713     MOVE CR-AH-CURRENT-STATUS     TO DE-AH-STAT-CDE.
 10714     MOVE ZEROS                    TO DE-AH-CANC-DTE
 10715                                      DE-AH-CANC-EXIT-DT.
 10716
 10717     IF (CR-LFTYP NOT = ZERO   AND
 10718         CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'Z')  OR
 10719        (CR-AHTYP NOT = ZERO  AND
 10720         CLAS-I-CALC-TYPE (CLAS-INDEXA) = 'Z')
 10721           MOVE CR-LIVES           TO DE-LIVES
 10722           MOVE ZERO               TO DE-CANCEL-CNT-ITD
 10723                                      DE-CANCEL-CNT-YTD.
 10724
 10725     MOVE CR-MEMBER-NO             TO DE-MEMBER-NO.
 10726     IF AM-ZIP-PRIME NUMERIC
 10727        MOVE AM-ZIP-PRIME          TO DE-ZIP
 10728      ELSE
 10729        MOVE ZEROS                 TO DE-ZIP.
 10730     MOVE CR-LOAN-OFFICER          TO DE-LN-OFFICER.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 212
* ECS010Z.cbl
 10731
 10732     MOVE CR-APR                   TO DE-APR.
 10733     MOVE CR-PMT-FREQ              TO DE-PMT-FREQ.
 10734     MOVE CR-GRPTYP                TO DE-ACC-GPCD.
 10735     MOVE CR-IND-GRP               TO DE-IG.
 10736     MOVE AM-REMIT-TO              TO DE-REMIT-TO.
 10737     MOVE CR-MEMBER-NO             TO DE-MEMBER-NO.
 10738
 10739     MOVE CR-ENTRY-STATUS          TO DE-ENTRY-STATUS.
 10740     MOVE CR-ENTRY-DATE            TO DE-ENTRY-DTE.
 10741
 10742     MOVE CR-UNDERWRITING-CODE     TO DE-UNDERWRITING-CODE.
 10743     MOVE AM-POOL-PRIME            TO DE-NCL-POOL-CODE.
 10744
 10745     MOVE ZEROS                    TO DE-REI-LFAMT  DE-REI-LFPRM
 10746                                      DE-REI-AHAMT  DE-REI-AHPRM
 10747                                      DE-REI-LFRFND DE-REI-AHRFND
 10748                                      DE-REI-CNAMT.
 10749
 10750     MOVE +1                       TO SUB1.
 10751
 10752     PERFORM EXTRACT-DATE-LOAD.
 10753
 10754     MOVE ZEROS                    TO WS-DE-PROC-DT-N
 10755                                      WS-DE-INCUR-N
 10756                                      WS-DE-PAY-N
 10757                                      WS-DE-PAID-TO-N
 10758                                      WS-DE-ACC-EXP-DTE-N
 10759                                      WS-DE-ACC-EFF-DTE-N
 10760                                      WS-DE-RSV-INCUR-N
 10761                                      WS-DE-RSV-PAYTO-N
 10762                                      WS-DE-ACC-EXP-DTE-RSV-N
 10763                                      WS-DE-ACC-EFF-DTE-RSV-N.
 10764
 10765 2090-GL-CODE-LOOP.
 10766
 10767     MOVE AM-GL-CODES (SUB1)       TO DE-GL-CODES (SUB1).
 10768
 10769     IF SUB1 LESS THAN +10
 10770         ADD +1 TO SUB1
 10771         GO TO 2090-GL-CODE-LOOP.
 10772
 10773     MOVE AM-RECALC-COMM           TO DE-RECALC-CODE.
 10774
 10775     MOVE CR-COMPENSATION-LEVELS   TO DE-COMM-LEVELS.
 10776
 10777 2099-INIT-DTL-X.
 10778     EXIT.
 10779
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 213
* ECS010Z.cbl
 10781******************************************************************
 10782***            B U I L D   I S S U E   E X T R A C T           ***
 10783******************************************************************
 10784
 10785 2100-BUILD-ISSUE-EXTRACT.
 10786
 10787     PERFORM 2000-INITIALIZE-DETAIL-EXTRACT THRU 2099-INIT-DTL-X.
 10788
 10789     MOVE 'I'                      TO DE-TRANS.
 10790
 10791     IF CHECK-BILLED
 10792         MOVE 'N' TO BILLED-SWITCH
 10793     ELSE
 10794         GO TO 2190-WRITE-ISSUE-EXTRACT.
 10795
 10796     MOVE +1                        TO SUB1.
 10797 2150-GA-BILL-LOOP.
 10798
 10799     IF PB-GA-BILL-DT (SUB1) NOT = LOW-VALUES  AND  SPACES
 10800         MOVE 'B'                   TO DE-GA-BILL-STATUS (SUB1).
 10801
 10802     IF SUB1 LESS THAN +5
 10803         ADD +1 TO SUB1
 10804         GO TO 2150-GA-BILL-LOOP.
 10805
 10806     MOVE PB-RECORD-BILL            TO DE-BILL-SW.
 10807     MOVE ZEROS                     TO DE-BILLED-LFPRM
 10808                                       DE-BILLED-LFRFND
 10809                                       DE-BILLED-AHPRM
 10810                                       DE-BILLED-AHRFND.
 10811
 10812     IF PB-BILLED-DT = LOW-VALUES  OR  SPACES
 10813         IF PB-LF-BILLED-AMTS = ZERO  AND
 10814            PB-AH-BILLED-AMTS = ZERO
 10815             MOVE ' '                    TO DE-BILL-STATUS
 10816         ELSE
 10817             IF PB-LF-BILLED-AMTS = PB-I-LF-PREMIUM-AMT  AND
 10818                PB-AH-BILLED-AMTS = PB-I-AH-PREMIUM-AMT
 10819                 MOVE 'B'                TO DE-BILL-STATUS
 10820             ELSE
 10821                 MOVE 'R'                TO DE-BILL-STATUS
 10822                 MOVE PB-LF-BILLED-AMTS  TO DE-BILLED-LFPRM
 10823                 MOVE PB-AH-BILLED-AMTS  TO DE-BILLED-AHPRM
 10824     ELSE
 10825         MOVE 'B'                        TO DE-BILL-STATUS.
 10826
 10827 2190-WRITE-ISSUE-EXTRACT.
 10828
 10829     PERFORM 2500-WRITE-DETAIL-EXTRACTS THRU 2599-WRT-DETAIL-X.
 10830
 10831 2199-BLD-ISSUE-X.
 10832     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 214
* ECS010Z.cbl
 10834******************************************************************
 10835***           B U I L D   C A N C E L   E X T R A C T          ***
 10836******************************************************************
 10837
 10838 2200-BUILD-CANCEL-EXTRACT.
 10839
 10840     PERFORM 2000-INITIALIZE-DETAIL-EXTRACT THRU 2099-INIT-DTL-X.
 10841
 10842     MOVE 'C'                           TO DE-TRANS.
 10843
 10844     IF CR-LFTYP = ZERO
 10845         GO TO 2250-CONTINUE-CANCEL-BUILD.
 10846
 10847     IF CLAS-I-CALC-TYPE (CLAS-INDEXL) NOT = 'Z'
 10848         IF (CR-LF-STATUS-AT-CANCEL = ' ' OR '7')  AND
 10849             CR-LFRFND = +0
 10850              MOVE +0                   TO TEMP-5
 10851              GO TO 2250-CONTINUE-CANCEL-BUILD.
 10852
 10853     IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'Z'
 10854          IF CR-LFRFND = +0
 10855              GO TO 2250-CONTINUE-CANCEL-BUILD.
 10856
 10857     MOVE +1 TO TEMP-5.
 10858     MOVE CR-LF-TERM             TO ORIG-TERM.
 10859     MOVE CR-LF-CANC-DT          TO VALUATION-DT.
 10860     MOVE LIFE-OVERRIDE-L1       TO WE-LF-AH.
 10861     MOVE '1'                    TO W-VAL-SOURCE.
 10862     PERFORM 8500-REMAINING-TERM-ROUTINE THRU 8599-REM-TERM-X.
 10863
 10864     IF CLAS-I-RL-AH (CLAS-INDEXL) = 'L' OR 'P'
 10865         MOVE CR-LFAMT TO DE-LF-CNBEN
 10866         GO TO 2250-CONTINUE-CANCEL-BUILD.
 10867
 10868     IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'Z'
 10869         GO TO 2220-BLD-DE-CANCEL-SUM.
 10870
 10871     IF REM-TRM3 = CR-LF-TERM
 10872         MOVE CR-LFAMT TO DE-LF-CNBEN
 10873         GO TO 2250-CONTINUE-CANCEL-BUILD.
 10874
 10875     IF CLAS-I-EP (CLAS-INDEXL) = 'T'
 10876         GO TO 2210-BLD-DE-CANCEL-TEX.
 10877
 10878     IF DTE-CLIENT = 'NCL'
 10879         IF CR-DT LESS THAN 19910101
 10880             GO TO 2205-BLD-DE-CANCEL-BEN.
 10881
 10882     IF CLAS-I-EP (CLAS-INDEXL) = 'N'
 10883         GO TO 2230-BLD-DE-CANCEL-NP.
 10884
 10885     IF DTE-CLIENT = 'FUL'
 10886         GO TO 2240-BLD-DE-CANCEL-FUL.
 10887
 10888*    IF STATE-ABBR (CLAS-INDEXS) = 'OH'
 10889     IF (STATE-ABBR (CLAS-INDEXS) = 'OH') AND
 10890        (CR-RATING-CLASS NOT = 'L ')
 10891         IF (CR-APR GREATER THAN ZERO)  AND
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 215
* ECS010Z.cbl
 10892            (CR-LF-TERM GREATER THAN 060)  AND
 10893            (CR-DT GREATER THAN 19831031)
 10894              GO TO 2230-BLD-DE-CANCEL-NP.
 10895
 10896     IF STATE-ABBR (CLAS-INDEXS) = 'MT'
 10897         IF (CR-APR GREATER THAN ZERO)  AND
 10898            (CR-LF-TERM GREATER THAN 061)  AND
 10899            (CR-DT GREATER THAN 19830318)
 10900              GO TO 2230-BLD-DE-CANCEL-NP.
 10901
 10902     IF STATE-ABBR (CLAS-INDEXS) = 'UT'
 10903         IF (CR-APR GREATER THAN ZERO)  AND
 10904            (CR-LF-TERM GREATER THAN 062)  AND
 10905            (CR-DT GREATER THAN 19810831)  AND
 10906            (CR-DT LESS THAN 19830901)
 10907              GO TO 2230-BLD-DE-CANCEL-NP.
 10908
 10909     IF STATE-ABBR (CLAS-INDEXS) = 'RI'
 10910         IF (CR-APR GREATER THAN ZERO)  AND
 10911            (CR-LF-TERM GREATER THAN 060)  AND
 10912            (CR-DT GREATER THAN 19831231)
 10913              GO TO 2230-BLD-DE-CANCEL-NP.
 10914
 10915 2205-BLD-DE-CANCEL-BEN.
 10916
 10917     IF CR-LF-TERM EQUAL +0
 10918         MOVE +0          TO TEMP-5
 10919     ELSE
 10920         COMPUTE TEMP-5 = REM-TRM3 / CR-LF-TERM.
 10921
 10922     COMPUTE DE-LF-CNBEN = CR-LFAMT * TEMP-5.
 10923
 10924     GO TO 2250-CONTINUE-CANCEL-BUILD.
 10925
 10926 2210-BLD-DE-CANCEL-TEX.
 10927
 10928     DIVIDE CR-LFAMT BY CR-LF-TERM
 10929         GIVING TEX-FACT-1.
 10930     DIVIDE REM-TRM3 BY CR-PMT-FREQ
 10931         GIVING TEX-FACT-2
 10932             REMAINDER TEX-FACT-3.
 10933     IF TEX-FACT-3 NOT = ZERO
 10934         ADD +1 TO TEX-FACT-2.
 10935     COMPUTE DE-LF-CNBEN =
 10936         (TEX-FACT-1 * (TEX-FACT-2 * CR-PMT-FREQ)).
 10937
 10938     IF CR-LFAMT EQUAL +0
 10939         MOVE +0                  TO TEMP-5
 10940     ELSE
 10941         COMPUTE TEMP-5 = DE-LF-CNBEN / CR-LFAMT.
 10942
 10943     GO TO 2250-CONTINUE-CANCEL-BUILD.
 10944
 10945 2220-BLD-DE-CANCEL-SUM.
 10946
 10947     MOVE CR-SUM-CAN-CNT-YTD      TO DE-CANCEL-CNT-YTD.
 10948     MOVE CR-SUM-CAN-CNT-ITD      TO DE-CANCEL-CNT-ITD.
 10949
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 216
* ECS010Z.cbl
 10950     IF CR-LFRFND NOT LESS CR-LFPRM
 10951         MOVE CR-LFAMT           TO DE-LF-CNBEN
 10952          GO TO 2250-CONTINUE-CANCEL-BUILD.
 10953
 10954     COMPUTE TEMP-6 ROUNDED = CR-LFRFND / CR-LFPRM.
 10955     COMPUTE TEMP-7 ROUNDED = TEMP-6 * CR-LFAMT.
 10956     IF CLAS-I-RL-AH (CLAS-INDEXL) = 'L' OR 'P'
 10957         MOVE TEMP-7             TO DE-LF-CNBEN
 10958       ELSE
 10959         COMPUTE TEMP-5 = REM-TRM3 / CR-LF-TERM
 10960         COMPUTE DE-LF-CNBEN = TEMP-7 * TEMP-5.
 10961
 10962     IF CR-LFAMT EQUAL +0
 10963         MOVE +0                  TO TEMP-5
 10964     ELSE
 10965         COMPUTE TEMP-5 ROUNDED =  DE-LF-CNBEN / CR-LFAMT.
 10966
 10967     IF CLAS-I-EP (CLAS-INDEXL) NOT = 'N'
 10968         GO TO 2250-CONTINUE-CANCEL-BUILD.
 10969
 10970 2230-BLD-DE-CANCEL-NP.
 10971
 10972     MOVE CR-DT                      TO  DC-GREG-DATE-CYMD.
 10973     MOVE 'L'                        TO  DC-OPTION-CODE.
 10974     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 10975     MOVE DC-BIN-DATE-1              TO  CP-CERT-EFF-DT.
 10976
 10977     IF CR-LOAN-1ST-PMT-DT NOT = ZEROS
 10978       MOVE CR-LOAN-1ST-PMT-DT       TO  DC-GREG-DATE-1-YMD
 10979       MOVE '3'                      TO  DC-OPTION-CODE
 10980       PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X
 10981       MOVE DC-BIN-DATE-1            TO  CP-FIRST-PAY-DATE
 10982     ELSE
 10983       MOVE CP-CERT-EFF-DT           TO  DC-BIN-DATE-1
 10984       MOVE '6'                      TO  DC-OPTION-CODE
 10985       MOVE +1                       TO  DC-ELAPSED-MONTHS
 10986       MOVE +0                       TO  DC-ELAPSED-DAYS
 10987       PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X
 10988       MOVE DC-BIN-DATE-2            TO  CP-FIRST-PAY-DATE.
 10989
 10990     MOVE CR-RATING-CLASS            TO  CP-CLASS-CODE
 10991     MOVE CR-LFAMT                   TO  CP-ORIGINAL-BENEFIT.
 10992     MOVE CR-APR                     TO  CP-LOAN-APR.
 10993     MOVE CR-LF-TERM                 TO  CP-ORIGINAL-TERM.
 10994     MOVE CR-LOAN-TERM               TO  CP-LOAN-TERM.
 10995     MOVE REM-TRM3                   TO  CP-REMAINING-TERM.
 10996     MOVE CLAS-I-CALC-TYPE (CLAS-INDEXL) TO  CP-SPECIAL-CALC-CD.
 10997     MOVE CLAS-I-RL-AH     (CLAS-INDEXL) TO  CP-BENEFIT-TYPE.
 10998     MOVE CLAS-I-EP        (CLAS-INDEXL) TO  CP-EARNING-METHOD.
 10999
 11000     CALL 'ELRAMTX' USING CALCULATION-PASS-AREA.
 11001
 11002     IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'Z'
 11003         COMPUTE DE-LF-CNBEN =
 11004                 CP-REMAMT-FACTOR * (TEMP-7 / +1000)
 11005      ELSE
 11006          COMPUTE DE-LF-CNBEN =
 11007                  CP-REMAMT-FACTOR * (CR-LFAMT / +1000).
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 217
* ECS010Z.cbl
 11008
 11009     IF CR-LFAMT EQUAL +0
 11010         MOVE +0                  TO TEMP-5
 11011     ELSE
 11012         COMPUTE TEMP-5 = DE-LF-CNBEN / CR-LFAMT.
 11013
 11014     GO TO 2250-CONTINUE-CANCEL-BUILD.
 11015
 11016 2240-BLD-DE-CANCEL-FUL.
 11017
 11018     MOVE CR-APR                  TO NP-APR.
 11019     MOVE CR-LF-TERM              TO NP-ORIG.
 11020     MOVE REM-TRM3                TO NP-REM.
 11021     MOVE '2'                     TO NP-OPT.
 11022     MOVE CR-AHPRM                TO NP-AHPRM.
 11023     MOVE CR-ACCOUNT              TO NP-ACCOUNT.
 11024     MOVE CR-LFAMT                TO NP-BENEFIT.
 11025
 11026*    CALL 'FULNETRM'
 11027*        USING NP-APR NP-ORIG NP-REM NP-OPT NP-BENEFIT NP-AHPRM
 11028*              NP-ACCOUNT NP-REMAINING.
 11029
 11030     MOVE NP-REMAINING            TO DE-LF-CNBEN.
 11031
 11032     IF CR-LFAMT EQUAL +0
 11033         MOVE +0                  TO TEMP-5
 11034     ELSE
 11035         COMPUTE TEMP-5 = DE-LF-CNBEN / CR-LFAMT.
 11036
 11037 2250-CONTINUE-CANCEL-BUILD.
 11038
 11039     MOVE CR-LFRFND                   TO DE-LF-RFND.
 11040     MOVE CR-LF-STATUS-AT-CANCEL      TO DE-LF-PREV-STAT.
 11041     MOVE CR-LF-CANC-DT               TO DE-LF-CANC-DTE
 11042                                         WS-DE-LF-CANC-DTE-N.
 11043     MOVE CR-LF-CANCEL-EXIT-DATE      TO DE-LF-CANC-EXIT-DT
 11044                                         WS-DE-LF-CANC-EXIT-DT-N.
 11045     MOVE CR-LF-COMM-CHARGEBACK       TO DE-LF-COMM-CHARGEBACK.
 11046
 11047     MOVE CR-AHRFND                   TO DE-AH-RFND.
 11048     MOVE CR-AH-STATUS-AT-CANCEL      TO DE-AH-PREV-STAT.
 11049     MOVE CR-AH-CANC-DT               TO DE-AH-CANC-DTE
 11050                                         WS-DE-AH-CANC-DTE-N.
 11051     MOVE CR-AH-CANCEL-EXIT-DATE      TO DE-AH-CANC-EXIT-DT
 11052                                         WS-DE-AH-CANC-EXIT-DT-N.
 11053     MOVE CR-AH-COMM-CHARGEBACK       TO DE-AH-COMM-CHARGEBACK.
 11054
 11055     IF PB-LAST-MAINT-BY = 'E570'
 11056         MOVE 'R'                     TO DE-AUTO-GEND-IND.
 11057
 11058     IF CHECK-BILLED
 11059         MOVE 'N' TO BILLED-SWITCH
 11060     ELSE
 11061         GO TO 2259-END-CANCEL-BUILD.
 11062
 11063     MOVE +1                        TO SUB1.
 11064 2255-GA-BILL-LOOP.
 11065
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 218
* ECS010Z.cbl
 11066     IF PB-GA-BILL-DT (SUB1) NOT = LOW-VALUES  AND  SPACES
 11067         MOVE 'B'                   TO DE-GA-BILL-STATUS (SUB1).
 11068
 11069     IF SUB1 LESS THAN +5
 11070         ADD +1 TO SUB1
 11071         GO TO 2255-GA-BILL-LOOP.
 11072
 11073     MOVE PB-RECORD-BILL            TO DE-BILL-SW.
 11074     MOVE PB-C-REFUND-SW            TO DE-REFUND-SW.
 11075     MOVE ZEROS                     TO DE-BILLED-LFPRM
 11076                                       DE-BILLED-LFRFND
 11077                                       DE-BILLED-AHPRM
 11078                                       DE-BILLED-AHRFND.
 11079
 11080     IF PB-BILLED-DT = LOW-VALUES  OR  SPACES
 11081         IF PB-LF-BILLED-AMTS = ZERO  AND
 11082            PB-AH-BILLED-AMTS = ZERO
 11083             MOVE ' '                    TO DE-BILL-STATUS
 11084         ELSE
 11085             IF PB-LF-BILLED-AMTS = PB-C-LF-CANCEL-AMT  AND
 11086                PB-AH-BILLED-AMTS = PB-C-AH-CANCEL-AMT
 11087                 MOVE 'B'                TO DE-BILL-STATUS
 11088             ELSE
 11089                 MOVE 'R'                TO DE-BILL-STATUS
 11090                 MOVE PB-LF-BILLED-AMTS  TO DE-BILLED-LFRFND
 11091                 MOVE PB-AH-BILLED-AMTS  TO DE-BILLED-AHRFND
 11092     ELSE
 11093         MOVE 'B'                        TO DE-BILL-STATUS.
 11094
 11095 2259-END-CANCEL-BUILD.
 11096     EXIT.
 11097
 11098 2290-WRITE-CANCEL-EXTRACT.
 11099
 11100     PERFORM 2500-WRITE-DETAIL-EXTRACTS THRU 2599-WRT-DETAIL-X.
 11101
 11102 2299-BLD-CANCEL-X.
 11103     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 219
* ECS010Z.cbl
 11105******************************************************************
 11106***            B U I L D   C L A I M   E X T R A C T           ***
 11107******************************************************************
 11108
 11109 2300-BUILD-CLAIM-EXTRACT.
 11110
 11111     PERFORM 2000-INITIALIZE-DETAIL-EXTRACT THRU 2099-INIT-DTL-X.
 11112
 11113     MOVE 'X'                       TO DE-TRANS.
 11114
 11115     MOVE PC-CLAIM-TYPE             TO DE-TYPE.
 11116
 11117     MOVE PC-CLAIM-PAYMENT          TO DE-CLAIM-AMT.
 11118     MOVE ZEROS                     TO DE-REI-CLAIM-AMT.
 11119
 11120     MOVE INCURRED-DATE             TO DE-INCUR
 11121                                       WS-DE-INCUR-N.
 11122     MOVE REPORTED-DATE             TO DE-REPORTED.
 11123     MOVE PAYMENT-DATE              TO DE-PAY
 11124                                       WS-DE-PAY-N.
 11125     MOVE PAY-TO-DATE               TO DE-PAID-TO
 11126                                       WS-DE-PAID-TO-N.
 11127
 11128     MOVE PC-CLAIM-NO               TO DE-CNUM.
 11129     MOVE PC-CHECK-NO               TO DE-CHECK.
 11130     MOVE PC-TRLR-SEQ-NO            TO DE-PMT-TRAILER-SEQ.
 11131     MOVE PC-NO-OF-DAYS-PAID        TO DE-DAYS-DISAB.
 11132     MOVE PC-AGE-AT-CLAIM           TO DE-CLM-AGE.
 11133     MOVE PC-PAYMENT-TYPE           TO DE-PAY-CODE.
 11134     INSPECT DE-PAY-CODE
 11135         CONVERTING '1234569' TO 'PFSXEEV'.
 11136
 11137     MOVE AM-NAME                   TO DE-ACC-NAME.
 11138     MOVE AM-EXPIRE-DT              TO DE-ACC-EXP-DTE
 11139                                       WS-DE-ACC-EXP-DTE-N.
 11140     MOVE AM-EFFECT-DT              TO DE-ACC-EFF-DTE
 11141                                       WS-DE-ACC-EFF-DTE-N.
 11142     MOVE PC-CAUSE-CODE             TO DE-CLM-CAUSE.
 11143     MOVE CR-LOAN-OFFICER           TO DE-LOAN-OFFICER.
 11144
 11145     IF DE-DTH  OR  DE-OB-DTH
 11146         MOVE CR-LF-STATUS-AT-DEATH TO DE-LF-PREV-STAT
 11147     ELSE
 11148         IF CR-AH-LUMP-SUM-DISAB
 11149             MOVE CR-AH-STATUS-AT-SETTLEMENT
 11150                                    TO DE-AH-PREV-STAT.
 11151
 11152     IF PC-LAST-MAINT-BY EQUAL 'E570'
 11153         MOVE 'R'                     TO DE-AUTO-GEND-IND.
 11154
 11155 2390-WRITE-CLAIM-EXTRACT.
 11156
 11157     PERFORM 2500-WRITE-DETAIL-EXTRACTS THRU 2599-WRT-DETAIL-X.
 11158
 11159 2399-BLD-CLAIM-X.
 11160     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 220
* ECS010Z.cbl
 11162******************************************************************
 11163***          B U I L D   R E S E R V E   E X T R A C T         ***
 11164******************************************************************
 11165
 11166 2400-BUILD-RESERVE-EXTRACT.
 11167
 11168     PERFORM 2000-INITIALIZE-DETAIL-EXTRACT THRU 2099-INIT-DTL-X.
 11169
 11170     MOVE 'Y'                         TO DE-TRANS.
 11171     MOVE PC-CLAIM-TYPE               TO DE-RESERVE-TYPE.
 11172
 11173     MOVE PC-IBNR-RESERVE-AMT         TO DE-IBNR.
 11174     MOVE PC-PTC-RESERVE-AMT          TO DE-PAYCUR.
 11175     MOVE PC-FUTURE-RESERVE-AMT       TO DE-FUTRSV.
 11176     ADD  PC-MANUAL-RESERVE-AMT       TO DE-FUTRSV.
 11177
 11178     IF DTE-CLIENT  =  'NCL'
 11179        IF PC-MANUAL-RESERVE-AMT  GREATER THAN   ZEROS
 11180            MOVE 'Y'                  TO DE-MANUAL-RSV-SWITCH.
 11181
 11182     MOVE PC-CLAIM-NO                 TO DE-CLMNO.
 11183
 11184     MOVE AM-EXPIRE-DT                TO DE-ACC-EXP-DTE-RSV
 11185                                         WS-DE-ACC-EXP-DTE-RSV-N.
 11186
 11187     MOVE AM-EFFECT-DT                TO DE-ACC-EFF-DTE-RSV
 11188                                         WS-DE-ACC-EFF-DTE-RSV-N.
 11189
 11190     MOVE INCURRED-DATE               TO DE-RSV-INCUR
 11191                                         WS-DE-RSV-INCUR-N.
 11192     MOVE REPORTED-DATE               TO DE-RSV-REPORTED.
 11193     MOVE PAY-TO-DATE                 TO DE-RSV-PAYTO
 11194                                         WS-DE-RSV-PAYTO-N.
 11195
 11196     MOVE ZEROS                       TO DE-REI-IBNR
 11197                                         DE-REI-PAYCUR
 11198                                         DE-REI-FUTRSV.
 11199
 11200     MOVE AM-NAME                     TO DE-RSV-ACC-NAME.
 11201
 11202     IF PC-LAST-MAINT-BY EQUAL 'E570'
 11203         MOVE 'R'                     TO DE-AUTO-GEND-IND.
 11204
 11205 2490-WRITE-RESERVE-EXTRACT.
 11206
 11207     PERFORM 2500-WRITE-DETAIL-EXTRACTS THRU 2599-WRT-DETAIL-X.
 11208
 11209 2499-BLD-RESERVE-X.
 11210     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 221
* ECS010Z.cbl
 11212******************************************************************
 11213***          W R I T E   D E T A I L   E X T R A C T S         ***
 11214******************************************************************
 11215
 11216 2500-WRITE-DETAIL-EXTRACTS.
 11217
 11218
 11219     MOVE  ZEROS            TO  SUB.
 11220
 11221     IF  NOT  DE-CANCEL  AND   NOT  DE-RC-CANCEL
 11222         GO TO 2520-WRITE-CONTINUE.
 11223
 11224 2510-ZERO-CHARGEBACK-LOOP.
 11225
 11226     ADD  +1                TO  SUB.
 11227
 11228     IF  SUB    GREATER  THAN     +10
 11229         GO TO  2520-WRITE-CONTINUE.
 11230
 11231     IF  WS-LF-CHARGEBACK-SW (SUB)  = 'N'
 11232         MOVE  ZEROS            TO  DE-L-PC (SUB).
 11233
 11234     IF  WS-AH-CHARGEBACK-SW (SUB)  = 'N'
 11235         MOVE  ZEROS            TO  DE-A-PC (SUB).
 11236
 11237     GO TO 2510-ZERO-CHARGEBACK-LOOP.
 11238
 11239 2520-WRITE-CONTINUE.
 11240
 11241     IF DTE-CLIENT NOT = 'HER'
 11242         GO TO 2590-WRITE-EXTRACTS.
 11243
 11244     IF DE-REINCO NOT = 'LNL'
 11245         GO TO 2590-WRITE-EXTRACTS.
 11246
 11247     IF DE-CLAIM  OR  DE-RESERVE  OR  DE-RR-RC-CLM
 11248         GO TO 2590-WRITE-EXTRACTS.
 11249
 11250     IF DE-AGT-TYPE (1)  = 'D'   MOVE 'C'    TO DE-AGT-TYPE (1).
 11251     IF DE-AGT-TYPE (2)  = 'P'   MOVE 'O'    TO DE-AGT-TYPE (2).
 11252     IF DE-AGT-TYPE (3)  = 'P'   MOVE 'O'    TO DE-AGT-TYPE (3).
 11253     IF DE-AGT-TYPE (4)  = 'P'   MOVE 'O'    TO DE-AGT-TYPE (4).
 11254     IF DE-AGT-TYPE (5)  = 'P'   MOVE 'O'    TO DE-AGT-TYPE (5).
 11255     IF DE-AGT-TYPE (6)  = 'P'   MOVE 'O'    TO DE-AGT-TYPE (6).
 11256     IF DE-AGT-TYPE (7)  = 'P'   MOVE 'O'    TO DE-AGT-TYPE (7).
 11257     IF DE-AGT-TYPE (8)  = 'P'   MOVE 'O'    TO DE-AGT-TYPE (8).
 11258     IF DE-AGT-TYPE (9)  = 'P'   MOVE 'O'    TO DE-AGT-TYPE (9).
 11259     IF DE-AGT-TYPE (10) = 'P'   MOVE 'O'    TO DE-AGT-TYPE (10).
 11260
 11261     IF DE-AGT-TYPE (1)  = 'S'   MOVE 'F'    TO DE-AGT-TYPE (1).
 11262     IF DE-AGT-TYPE (2)  = 'B'   MOVE 'G'    TO DE-AGT-TYPE (2).
 11263     IF DE-AGT-TYPE (3)  = 'B'   MOVE 'G'    TO DE-AGT-TYPE (3).
 11264     IF DE-AGT-TYPE (4)  = 'B'   MOVE 'G'    TO DE-AGT-TYPE (4).
 11265     IF DE-AGT-TYPE (5)  = 'B'   MOVE 'G'    TO DE-AGT-TYPE (5).
 11266     IF DE-AGT-TYPE (6)  = 'B'   MOVE 'G'    TO DE-AGT-TYPE (6).
 11267     IF DE-AGT-TYPE (7)  = 'B'   MOVE 'G'    TO DE-AGT-TYPE (7).
 11268     IF DE-AGT-TYPE (8)  = 'B'   MOVE 'G'    TO DE-AGT-TYPE (8).
 11269     IF DE-AGT-TYPE (9)  = 'B'   MOVE 'G'    TO DE-AGT-TYPE (9).
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 222
* ECS010Z.cbl
 11270     IF DE-AGT-TYPE (10) = 'B'   MOVE 'G'    TO DE-AGT-TYPE (10).
 11271
 11272
 11273 2590-WRITE-EXTRACTS.
 11274
 11275     MOVE EOM-RUN-DATE            TO DE-PROC-DT
 11276                                     WS-DE-PROC-DT-N.
 11277
 11278     IF DTE-PGM-OPT = '1' OR '2'
 11279         ADD +1                   TO DE-CNT
 11280*********PERFORM EXTRACT-DATE-RELOAD
 11281         WRITE DETAIL-EXTRACT.
 11282
 11283
 11284 2599-WRT-DETAIL-X.
 11285     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 223
* ECS010Z.cbl
 11287******************************************************************
 11288***         R E I N S U R A N C E   P R O C E S S I N G        ***
 11289******************************************************************
 11290
 11291 3000-REINSURE-ROUTINE.
 11292
 11293     IF (CR-POLICY-IS-DECLINED) OR
 11294        (CR-POLICY-IS-VOID)
 11295        GO TO 3099-REINSURE-ROUTINE-X.
 11296
 11297     IF REIN-FLG = 'X'
 11298         GO TO 3099-REINSURE-ROUTINE-X.
 11299
 11300     MOVE 'X' TO REIN-FLG.
 11301
 11302     PERFORM CLEAR-REIN-HOLD THRU CLEAR-REIN-HOLD-X.
 11303
 11304     IF CR-REIN-TABLE = SPACES OR ZEROS
 11305         GO TO 3030-RE-CALCULATE-REINSURANCE.
 11306
 11307******************************************************************
 11308***    R E A D   R E I N S U R A N C E   T A B L E   F I L E   ***
 11309******************************************************************
 11310
 11311 3010-RR-READ-REIN.
 11312
 11313     IF REIN-OPEN-SW = ' '
 11314         MOVE 'X'                       TO REIN-OPEN-SW
 11315         MOVE DTE-CLASIC-COMPANY-CD     TO REIN-SRCH-COMP-CD
 11316         MOVE 'A'                       TO REIN-SRCH-CODE
 11317         OPEN INPUT ERRTBL-IN
 11318         IF ERRTBL-FILE-STATUS = '00'  OR  '97'
 11319             PERFORM REIN-CO-TABLE-BUILD THRU REIN-BUILD-EXIT
 11320          ELSE
 11321             MOVE '21'                  TO ABEND-CODE-1
 11322             MOVE ERRTBL-FILE-STATUS    TO ABEND-CODE-2
 11323             DISPLAY '******************************'
 11324             DISPLAY '***** ERROR LOCATION 015 *****'
 11325             DISPLAY '******************************'
 11326             MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
 11327             GO TO ABEND-PGM.
 11328
 11329     IF CR-REIN-TABLE = REIN-SRCH
 11330         GO TO 3019-RR-READ-REIN-X.
 11331
 11332     MOVE +0                            TO REIN-SUB-1.
 11333     MOVE 999999                        TO REIN-LOW-TIME.
 11334     MOVE CR-REIN-TABLE                 TO REIN-SRCH.
 11335
 11336 3011-RR-CHECK-REIN-SAVE-TABLE.
 11337
 11338     ADD +1                             TO REIN-SUB-1.
 11339     IF REIN-SUB-1 GREATER THAN REIN-MAX  OR
 11340        REIN-SUB-1 GREATER THAN REIN-SUB-2
 11341         GO TO 3015-RR-READ-ERRTBL.
 11342
 11343     IF REIN-SEARCH = SR-CONTROL (REIN-SUB-1)
 11344         MOVE SR-ENTRY (REIN-SUB-1)     TO REINSURANCE-RECORD
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 224
* ECS010Z.cbl
 11345         ACCEPT WS-TIME-OF-DAY   FROM TIME
 11346         MOVE WS-TIME                   TO SR-TIME (REIN-SUB-1)
 11347         GO TO 3019-RR-READ-REIN-X.
 11348
 11349     IF SR-TIME (REIN-SUB-1) LESS THAN REIN-LOW-TIME
 11350         MOVE SR-TIME (REIN-SUB-1)      TO REIN-LOW-TIME
 11351         MOVE REIN-SUB-1                TO REIN-LOW-SUB.
 11352
 11353     GO TO 3011-RR-CHECK-REIN-SAVE-TABLE.
 11354
 11355 3015-RR-READ-ERRTBL.
 11356
 11357     MOVE REIN-SEARCH                   TO RE-CONTROL-PRIMARY.
 11358
 11359     READ ERRTBL-IN.
 11360
 11361     IF ERRTBL-FILE-STATUS  = '23'
 11362         DISPLAY 'INVALID REINSURANCE TABLE CODE - ' REIN-SRCH
 11363                                           ' ' CR-FULL-CONTROL
 11364         MOVE '24'                      TO ABEND-CODE-1
 11365         MOVE ERRTBL-FILE-STATUS        TO ABEND-CODE-2
 11366         DISPLAY '******************************'
 11367         DISPLAY '***** ERROR LOCATION 016 *****'
 11368         DISPLAY '******************************'
 11369         MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
 11370         GO TO ABEND-PGM.
 11371
 11372     IF ERRTBL-FILE-STATUS  = '00'  OR  '97'
 11373         NEXT SENTENCE
 11374       ELSE
 11375         MOVE '24'                      TO ABEND-CODE-1
 11376         MOVE ERRTBL-FILE-STATUS        TO ABEND-CODE-2
 11377         DISPLAY '******************************'
 11378         DISPLAY '***** ERROR LOCATION 017 *****'
 11379         DISPLAY '******************************'
 11380         MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
 11381         GO TO ABEND-PGM.
 11382
 11383     ADD +1                            TO ERRTBL-READS.
 11384
 11385     IF REIN-SUB-1 GREATER THAN REIN-MAX
 11386         MOVE REINSURANCE-RECORD       TO SR-ENTRY (REIN-LOW-SUB)
 11387         ACCEPT WS-TIME-OF-DAY   FROM TIME
 11388         MOVE WS-TIME                  TO SR-TIME (REIN-LOW-SUB)
 11389     ELSE
 11390         MOVE REINSURANCE-RECORD       TO SR-ENTRY (REIN-SUB-1)
 11391         ACCEPT WS-TIME-OF-DAY   FROM TIME
 11392         MOVE WS-TIME                  TO SR-TIME (REIN-SUB-1)
 11393         MOVE REIN-SUB-1               TO REIN-SUB-2.
 11394
 11395 3019-RR-READ-REIN-X.
 11396     EXIT.
 11397
 11398 3020-CALCULATE-REINSURANCE.
 11399
 11400*    IF DTE-CLIENT = '???'  AND
 11401*       (CR-REIN-TABLE = 'SE1')
 11402*        PERFORM 3640-NSP-REIN-RATING-ROUTINE THRU 3669-NSP-REIN-X
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 225
* ECS010Z.cbl
 11403*        IF CR-STATE NOT = STATE-L
 11404*            MOVE CR-STATE             TO STATE-L
 11405*            PERFORM 8200-STATE-CODE-LOOKUP
 11406*                         THRU 8299-STATE-LOOKUP-X.
 11407
 11408
 11409*    IF DTE-CLIENT = 'DCC'
 11410*       IF CR-LF-NSP-PRM NOT = ZEROS
 11411*          COMPUTE CR-LF-NSP-PRM ROUNDED =
 11412*             (CR-LFPRM + CR-LFPRM-ALT) -
 11413*             ((CR-LFPRM + CR-LFPRM-ALT) * CR-LCOM-L (1))
 11414*       END-IF
 11415*       IF CR-AH-NSP-PRM NOT = ZEROS
 11416*          COMPUTE CR-AH-NSP-PRM ROUNDED =
 11417*          CR-AHPRM -
 11418*          (CR-AHPRM * CR-LCOM-AH (1))
 11419*       END-IF
 11420*    END-IF
 11421
 11422
 11423     IF RE-REMAINING (1) = 'I'
 11424         MOVE '*'                      TO RISK-REIN-FLAG
 11425     ELSE
 11426         GO TO 3029-CONTINUE-REIN-CALC.
 11427
 11428     MOVE SPACE                        TO REIN-CANCEL-LF-SW
 11429                                          REIN-CANCEL-AH-SW.
 11430     MOVE ZEROS                        TO REIN-EARN-LF-TERM
 11431                                          REIN-LCNC-EARN-TERM
 11432                                          REIN-LF-CLM-MONTHS
 11433                                          REIN-EARN-AH-TERM
 11434                                          REIN-ACNC-EARN-TERM
 11435                                          REIN-AH-PRIOR-CLMS-PAID
 11436                                          REIN-AH-CLM-MONTHS
 11437                                          REIN-AH-CLM-MTH-1
 11438                                          REIN-AH-CLM-MTH-2
 11439                                          REIN-AH-CLM-MTH-3
 11440                                          REIN-AH-CLM-MTH-4
 11441                                          REIN-AH-CLM-MTH-5.
 11442
 11443     MOVE CR-DT                        TO DC-GREG-DATE-CYMD.
 11444     MOVE 'L'                          TO DC-OPTION-CODE.
 11445     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 11446     MOVE DC-BIN-DATE-1                TO WS-CR-BIN-DATE.
 11447
 11448     IF CR-LFTYP = ZEROS  OR  SPACES
 11449         GO TO 3023-CONTINUE.
 11450
 11451     MOVE EOM-RUN-DATE                 TO VALUATION-DT.
 11452
 11453     IF CR-LF-CANCEL-EXIT-DATE NOT = ZEROS
 11454       IF CR-LF-CANCEL-EXIT-DATE LESS THAN VALUATION-DT
 11455           MOVE CR-LF-CANCEL-EXIT-DATE TO VALUATION-DT.
 11456
 11457     IF CR-LF-CLAIM-EXIT-DATE NOT = ZEROS
 11458       IF CR-LF-CLAIM-EXIT-DATE LESS THAN VALUATION-DT
 11459           MOVE CR-LF-CLAIM-EXIT-DATE  TO VALUATION-DT.
 11460
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 226
* ECS010Z.cbl
 11461     MOVE VALUATION-DT                 TO DC-GREG-DATE-CYMD.
 11462     PERFORM 3025-CALC-ELAPSED-MONTHS THRU 3026-CALC-EXIT.
 11463
 11464     IF DC-ELAPSED-MONTHS GREATER THAN CR-LF-TERM
 11465         MOVE CR-LF-TERM               TO MONTHS-DIFF-LF
 11466     ELSE
 11467         MOVE DC-ELAPSED-MONTHS        TO MONTHS-DIFF-LF.
 11468
 11469     IF CR-LF-CANC-DT NOT = ZEROS
 11470         MOVE CR-LF-CANC-DT            TO DC-GREG-DATE-CYMD
 11471         PERFORM 3025-CALC-ELAPSED-MONTHS THRU 3026-CALC-EXIT
 11472         MOVE DC-ELAPSED-MONTHS        TO REIN-LCNC-EARN-TERM
 11473         IF CR-DT = CR-LF-CANC-DT
 11474             MOVE '*'                  TO REIN-CANCEL-LF-SW.
 11475
 11476     IF CR-DTH-DT NOT = ZEROS
 11477         MOVE CR-DTH-DT                TO DC-GREG-DATE-CYMD
 11478         PERFORM 3025-CALC-ELAPSED-MONTHS THRU 3026-CALC-EXIT
 11479         MOVE DC-ELAPSED-MONTHS        TO REIN-LF-CLM-MONTHS.
 11480
 11481     MOVE MONTHS-DIFF-LF               TO REIN-EARN-LF-TERM.
 11482
 11483
 11484 3023-CONTINUE.
 11485
 11486     IF CR-AHTYP = ZEROS  OR  SPACES
 11487        GO TO 3029-CONTINUE-REIN-CALC.
 11488
 11489     MOVE EOM-RUN-DATE                 TO VALUATION-DT.
 11490
 11491     IF CR-AH-CANCEL-EXIT-DATE NOT = ZEROS
 11492       IF CR-AH-CANCEL-EXIT-DATE LESS THAN VALUATION-DT
 11493           MOVE CR-AH-CANCEL-EXIT-DATE TO VALUATION-DT.
 11494
 11495     IF CR-AH-SETTLEMENT-EXIT-DATE NOT = ZEROS
 11496       IF CR-AH-SETTLEMENT-EXIT-DATE LESS THAN VALUATION-DT
 11497           MOVE CR-AH-SETTLEMENT-EXIT-DATE TO VALUATION-DT.
 11498
 11499     MOVE VALUATION-DT                 TO DC-GREG-DATE-CYMD.
 11500     PERFORM 3025-CALC-ELAPSED-MONTHS THRU 3026-CALC-EXIT.
 11501
 11502     IF DC-ELAPSED-MONTHS GREATER THAN CR-AH-TERM
 11503         MOVE CR-AH-TERM               TO MONTHS-DIFF-AH
 11504     ELSE
 11505         MOVE DC-ELAPSED-MONTHS        TO MONTHS-DIFF-AH.
 11506
 11507     IF CR-AH-CANC-DT NOT = ZEROS
 11508         MOVE CR-AH-CANC-DT           TO DC-GREG-DATE-CYMD
 11509         PERFORM 3025-CALC-ELAPSED-MONTHS THRU 3026-CALC-EXIT
 11510         MOVE DC-ELAPSED-MONTHS        TO REIN-ACNC-EARN-TERM
 11511         IF CR-DT = CR-AH-CANC-DT
 11512             MOVE '*'                  TO REIN-CANCEL-AH-SW.
 11513
 11514     IF CR-DIS-INCUR-DT (1) NOT = ZEROS
 11515         MOVE CR-DIS-INCUR-DT (1)    TO DC-GREG-DATE-CYMD
 11516         PERFORM 3025-CALC-ELAPSED-MONTHS THRU 3026-CALC-EXIT
 11517         MOVE DC-ELAPSED-MONTHS        TO REIN-AH-CLM-MTH-1.
 11518
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 227
* ECS010Z.cbl
 11519     IF CR-DIS-INCUR-DT (2) NOT = ZEROS
 11520         MOVE CR-DIS-INCUR-DT (2)    TO DC-GREG-DATE-CYMD
 11521         PERFORM 3025-CALC-ELAPSED-MONTHS THRU 3026-CALC-EXIT
 11522         MOVE DC-ELAPSED-MONTHS        TO REIN-AH-CLM-MTH-2.
 11523
 11524     IF CR-DIS-INCUR-DT (3) NOT = ZEROS
 11525         MOVE CR-DIS-INCUR-DT (3)      TO DC-GREG-DATE-CYMD
 11526         PERFORM 3025-CALC-ELAPSED-MONTHS THRU 3026-CALC-EXIT
 11527         MOVE DC-ELAPSED-MONTHS        TO REIN-AH-CLM-MTH-3.
 11528
 11529     IF CR-DIS-INCUR-DT (4) NOT = ZEROS
 11530         MOVE CR-DIS-INCUR-DT (4)    TO DC-GREG-DATE-CYMD
 11531         PERFORM 3025-CALC-ELAPSED-MONTHS THRU 3026-CALC-EXIT
 11532         MOVE DC-ELAPSED-MONTHS        TO REIN-AH-CLM-MTH-4.
 11533
 11534     IF CR-DIS-INCUR-DT (5) NOT = ZEROS
 11535         MOVE CR-DIS-INCUR-DT (5)    TO DC-GREG-DATE-CYMD
 11536         PERFORM 3025-CALC-ELAPSED-MONTHS THRU 3026-CALC-EXIT
 11537         MOVE DC-ELAPSED-MONTHS        TO REIN-AH-CLM-MTH-5.
 11538
 11539     MOVE MONTHS-DIFF-AH               TO REIN-EARN-AH-TERM.
 11540
 11541
 11542     GO TO 3029-CONTINUE-REIN-CALC.
 11543
 11544
 11545 3025-CALC-ELAPSED-MONTHS.
 11546
 11547     MOVE 'L'                          TO DC-OPTION-CODE.
 11548     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 11549     MOVE DC-BIN-DATE-1                TO DC-BIN-DATE-2.
 11550     MOVE WS-CR-BIN-DATE               TO DC-BIN-DATE-1.
 11551     MOVE '1'                          TO DC-OPTION-CODE.
 11552     MOVE ' '                          TO DC-CENTURY-ADJUSTMENT.
 11553     MOVE ZEROS                        TO DC-ELAPSED-MONTHS
 11554                                          DC-ODD-DAYS-OVER
 11555                                          DC-ELAPSED-DAYS.
 11556     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 11557
 11558 3026-CALC-EXIT.
 11559     EXIT.
 11560
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 228
* ECS010Z.cbl
 11562 3029-CONTINUE-REIN-CALC.
 11563
*11564                             COPY ECSRTPFM.
 11565******************************************************************07/10/97
 11566*                                                                *ECSRTPFM
 11567*                            ECSRTPFM                            *   LV001
 11568*                            VMOD=2.002                          *ECSRTPFM
 11569*                                                                *ECSRTPFM
 11570******************************************************************ECSRTPFM
 11571                                                                  ECSRTPFM
 11572     IF    CR-LFAMT  NUMERIC                                      00000072
 11573           NEXT SENTENCE                                          00000073
 11574        ELSE                                                      00000074
 11575           MOVE ZEROS TO CR-LFAMT.                                00000075
 11576                                                                  00000076
 11577     IF    CR-LFAMT-ALT  NUMERIC                                  00000077
 11578           NEXT SENTENCE                                          00000078
 11579        ELSE                                                      00000079
 11580           MOVE ZEROS TO CR-LFAMT-ALT.                            00000080
 11581                                                                  00000081
 11582                                                                  00000082
 11583     IF    CR-LFPRM  NUMERIC                                      00000083
 11584           NEXT SENTENCE                                          00000084
 11585        ELSE                                                      00000085
 11586           MOVE ZEROS TO CR-LFPRM.                                00000086
 11587                                                                  00000087
 11588     IF    CR-LFPRM-ALT  NUMERIC                                  00000088
 11589           NEXT SENTENCE                                          00000089
 11590        ELSE                                                      00000090
 11591           MOVE ZEROS TO CR-LFPRM-ALT.                            00000091
 11592                                                                  00000092
 11593                                                                  00000093
 11594     IF    CR-LFPRM-CALC  NUMERIC                                 00000094
 11595           NEXT SENTENCE                                          00000095
 11596        ELSE                                                      00000096
 11597           MOVE ZEROS TO CR-LFPRM-CALC.                           00000097
 11598                                                                  00000098
 11599     IF    CR-LFPRM-CALC-ALT  NUMERIC                             00000099
 11600           NEXT SENTENCE                                          00000100
 11601        ELSE                                                      00000101
 11602           MOVE ZEROS TO CR-LFPRM-CALC-ALT.                       00000102
 11603                                                                  00000103
 11604     IF    CR-LF-NSP-PRM  NUMERIC                                 00000104
 11605           NEXT SENTENCE                                          00000105
 11606        ELSE                                                      00000106
 11607           MOVE ZEROS TO CR-LF-NSP-PRM.                           00000107
 11608                                                                  00000108
 11609     COMPUTE RS-R-LB = CR-LFAMT + CR-LFAMT-ALT.                   ECSRTPFM
 11610     COMPUTE RS-R-LP = CR-LFPRM + CR-LFPRM-ALT.                   ECSRTPFM
 11611     IF RE-NSP-ST-CD-LF = ZEROS  OR  SPACES                       ECSRTPFM
 11612         COMPUTE RS-R-LPC = CR-LFPRM-CALC + CR-LFPRM-CALC-ALT     ECSRTPFM
 11613     ELSE                                                         ECSRTPFM
 11614         MOVE CR-LF-NSP-PRM         TO RS-R-LPC.                  ECSRTPFM
 11615     MOVE RS-R-LPC                  TO REIN-CALCED-LIFE.          ECSRTPFM
 11616                                                                  ECSRTPFM
 11617     MOVE CR-AHAMT                  TO RS-R-AB.                   ECSRTPFM
 11618     MOVE CR-AHPRM                  TO RS-R-AP.                   ECSRTPFM
 11619     IF RE-NSP-ST-CD-AH = ZEROS  OR  SPACES                       ECSRTPFM
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 229
* ECS010Z.cbl (/apps/prod/cid1p/copy/ECSRTPFM)
 11620         MOVE CR-AHPRM-CALC         TO RS-R-APC                   ECSRTPFM
 11621     ELSE                                                         ECSRTPFM
 11622         MOVE CR-AH-NSP-PRM         TO RS-R-APC.                  ECSRTPFM
 11623     MOVE RS-R-APC                  TO REIN-CALCED-AH.            ECSRTPFM
 11624                                                                  ECSRTPFM
 11625     PERFORM REINSURE-CALC THRU REINSURE-CALC-X                   ECSRTPFM
 11626         VARYING SUB1 FROM +1 BY +1                               ECSRTPFM
 11627             UNTIL RE-REI-COMP-NO (SUB1) = SPACES.                ECSRTPFM
 11628                                                                  ECSRTPFM
 11629
 11630     MOVE 'X'                  TO REIN-RT-SW.
 11631     PERFORM 3200-REINSURE-CANCEL THRU 3299-REINSURE-CANCEL-X.
 11632     PERFORM 3300-REINSURE-CLAIM THRU 3399-REINSURE-CLAIM-X.
 11633     MOVE ' '                  TO REIN-RT-SW.
 11634
 11635 3030-RE-CALCULATE-REINSURANCE.
 11636
 11637     IF AM-RECALC-REIN = 'Y'
 11638         IF CR-REIN-TABLE NOT = AM-REI-TABLE  AND
 11639            CR-REIN-SPEC = SPACE  AND
 11640            CR-ENTRY-DATE NOT = EOM-RUN-DATE
 11641             PERFORM 3600-RC-REINSURANCE
 11642                 THRU 3799-RC-REINSURANCE-X.
 11643
 11644     PERFORM 3040-REIN-REC-CNT THRU 3049-RRC-XIT
 11645         VARYING SUB1 FROM 1 BY 1
 11646             UNTIL REIN-COMP (SUB1) = SPACES.
 11647
 11648     GO TO 3099-REINSURE-ROUTINE-X.
 11649
 11650 3040-REIN-REC-CNT.
 11651
 11652     IF REIN-LF-AH-FLGS (SUB1) = SPACES
 11653         GO TO 3049-RRC-XIT.
 11654
 11655     PERFORM 3050-REIN-COMP-ADD THRU 3059-RCA-XIT
 11656         VARYING B-SUB FROM 1 BY 1
 11657             UNTIL B-SUB GREATER THAN 50.
 11658
 11659 3049-RRC-XIT.
 11660     EXIT.
 11661
 11662 3050-REIN-COMP-ADD.
 11663
 11664     IF RB-COMPANY (B-SUB) = SPACES
 11665         MOVE REIN-COMP (SUB1) TO RB-COMPANY (B-SUB).
 11666     IF RB-COMPANY (B-SUB) = REIN-COMP (SUB1)
 11667         MOVE 1   TO RB-COUNT (B-SUB)
 11668         MOVE +50 TO B-SUB.
 11669
 11670 3059-RCA-XIT.
 11671     EXIT.
 11672
 11673 3099-REINSURE-ROUTINE-X.
 11674     EXIT.
 11675
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 230
* ECS010Z.cbl
 11677******************************************************************
 11678***                R E I N S U R E   I S S U E S               ***
 11679******************************************************************
 11680
 11681 3100-REINSURE-ISSUE.
 11682
 11683     IF  REIN-COMP (1) = SPACES
 11684         GO TO 3199-REINSURE-ISSUE-X.
 11685
 11686     PERFORM 2000-INITIALIZE-DETAIL-EXTRACT THRU 2099-INIT-DTL-X.
 11687     MOVE ZEROS    TO RW-ACCUM-LF  RW-ACCUM-AH.
 11688     MOVE 'I'      TO DE-TRANS.
 11689     MOVE 'R'      TO DE-REIN.
 11690*****PERFORM EXTRACT-DATE-RELOAD.
 11691     MOVE DETAIL-EXTRACT TO SAVE-EXTRACT.
 11692     MOVE +1       TO SUB1.
 11693
 11694 3110-REINSURE-ISSUE-LOOP.
 11695
 11696     IF REIN-COMP (SUB1) = SPACES
 11697         GO TO 3119-REINSURE-ISSUE-LOOP-END.
 11698
 11699     IF UPDATING-RISK-PREMIUMS
 11700       IF REIN-REM-SW (SUB1) NOT = 'I'
 11701         ADD +1 TO SUB1
 11702         GO TO 3110-REINSURE-ISSUE-LOOP.
 11703
 11704     IF REIN-REM-SW (SUB1) = 'Z'
 11705         ADD +1 TO SUB1
 11706         GO TO 3110-REINSURE-ISSUE-LOOP.
 11707
 11708     MOVE REIN-COMP (SUB1)      TO DE-REI-COMP.
 11709     MOVE REIN-WORK-FLDS (SUB1) TO RWF-FIELDS.
 11710     MOVE RWF-LFAMT             TO DE-REI-LFAMT.
 11711     MOVE RWF-LFPRM             TO DE-REI-LFPRM.
 11712     MOVE RWF-AHAMT             TO DE-REI-AHAMT.
 11713     MOVE RWF-AHPRM             TO DE-REI-AHPRM.
 11714
 11715     IF REIN-REM-SW (SUB1) NOT = 'I'
 11716         GO TO 3115-CONTINUE-ISSUE-LOOP.
 11717
 11718     IF RWF-LFPRM = ZEROS  AND
 11719        RWF-AHPRM = ZEROS
 11720         GO TO 3115-CONTINUE-ISSUE-LOOP.
 11721
 11722     IF RWF-LFPRM NOT = ZEROS
 11723         COMPUTE DE-REI-LFPRM = RWF-LFPRM - CR-LF-REI-RISK-PRM
 11724         MOVE RWF-LFPRM         TO CR-LF-REI-RISK-PRM.
 11725
 11726     IF RWF-AHPRM NOT = ZEROS
 11727         COMPUTE DE-REI-AHPRM = RWF-AHPRM - CR-AH-REI-RISK-PRM
 11728         MOVE RWF-AHPRM         TO CR-AH-REI-RISK-PRM.
 11729
 11730 3115-CONTINUE-ISSUE-LOOP.
 11731
 11732     ADD DE-REI-LFPRM           TO RW-ACCUM-LF.
 11733     ADD DE-REI-AHPRM           TO RW-ACCUM-AH.
 11734
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 231
* ECS010Z.cbl
 11735     IF DE-REI-LFAMT NOT = ZERO
 11736        OR DE-REI-LFPRM NOT = ZERO
 11737        OR DE-REI-AHAMT NOT = ZERO
 11738        OR DE-REI-AHPRM NOT = ZERO
 11739         PERFORM 2500-WRITE-DETAIL-EXTRACTS THRU
 11740                 2599-WRT-DETAIL-X
 11741         ADD +1 TO BC-R-ISS.
 11742
 11743     ADD +1 TO SUB1.
 11744     MOVE SAVE-EXTRACT TO DETAIL-EXTRACT.
 11745     PERFORM EXTRACT-DATE-LOAD.
 11746
 11747     GO TO 3110-REINSURE-ISSUE-LOOP.
 11748
 11749 3119-REINSURE-ISSUE-LOOP-END.
 11750     EXIT.
 11751
 11752 3190-REINSURE-ISSUE-PRINT.
 11753
 11754     PERFORM 8600-SETUP-DETAIL-LINE THRU 8689-SETUP-DETAIL-X.
 11755     IF RW-ACCUM-LF NOT = ZERO
 11756         MOVE CLAS-I-AB3 (CLAS-INDEXL) TO TRD-LFTYP
 11757         MOVE CR-LF-TERM               TO TRD-LFTRM
 11758         MOVE RW-ACCUM-LF         TO TRD-LFPRM-RFND
 11759         MOVE 'REIN CEDED'        TO TRD-LF-ACTION.
 11760     IF RW-ACCUM-AH NOT = ZERO
 11761         MOVE CLAS-I-AB3 (CLAS-INDEXA) TO TRD-AHTYP
 11762         MOVE CR-AH-TERM               TO TRD-AHTRM
 11763         MOVE RW-ACCUM-AH         TO TRD-AHPRM-RFND
 11764         MOVE 'REIN CEDED'        TO TRD-AH-ACTION.
 11765     IF RW-ACCUM-LF NOT = ZERO  OR  RW-ACCUM-AH NOT = ZERO
 11766         PERFORM 8690-PRINT-DETAIL-LINE THRU 8699-PRT-DETAIL-X.
 11767
 11768 3199-REINSURE-ISSUE-X.
 11769     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 232
* ECS010Z.cbl
 11771******************************************************************
 11772***               R E I N S U R E   C A N C E L S              ***
 11773******************************************************************
 11774
 11775 3200-REINSURE-CANCEL.
 11776
 11777     IF REIN-COMP (1) = SPACES
 11778         GO TO 3299-REINSURE-CANCEL-X.
 11779
 11780     IF CR-LFRFND = ZERO
 11781        AND CR-AHRFND = ZERO
 11782         GO TO 3299-REINSURE-CANCEL-X.
 11783
 11784     PERFORM REINSURE-CALC-CANCEL THRU REINSURE-CALC-CANCEL-X
 11785             VARYING SUB1 FROM +1 BY +1 UNTIL
 11786                       REIN-COMP (SUB1) = SPACES.
 11787
 11788     IF REIN-RT-SW = 'X'
 11789         GO TO 3299-REINSURE-CANCEL-X.
 11790
 11791     PERFORM 2200-BUILD-CANCEL-EXTRACT THRU 2259-END-CANCEL-BUILD.
 11792     MOVE ZEROS    TO RW-ACCUM-LF  RW-ACCUM-AH.
 11793     MOVE 'R'      TO DE-REIN.
 11794*****PERFORM EXTRACT-DATE-RELOAD.
 11795     MOVE DETAIL-EXTRACT TO SAVE-EXTRACT.
 11796     MOVE +1       TO SUB1.
 11797
 11798 3210-REINSURE-CANCEL-LOOP.
 11799
 11800     IF REIN-COMP (SUB1) = SPACES
 11801         GO TO 3219-REINSURE-CANCEL-LOOP-END.
 11802
 11803     IF REIN-REM-SW (SUB1) = 'Z'
 11804         ADD +1        TO SUB1
 11805         MOVE SAVE-EXTRACT TO DETAIL-EXTRACT
 11806         PERFORM EXTRACT-DATE-LOAD
 11807         GO TO 3210-REINSURE-CANCEL-LOOP.
 11808
 11809     MOVE REIN-COMP (SUB1)      TO DE-REI-COMP.
 11810     MOVE REIN-WORK-FLDS (SUB1) TO RWF-FIELDS.
 11811
 11812     MOVE RWF-LFRFND            TO DE-REI-LFRFND.
 11813     MOVE RWF-AHRFND            TO DE-REI-AHRFND.
 11814     MOVE RWF-LFAMT             TO DE-REI-LFAMT.
 11815     MOVE RWF-LFPRM             TO DE-REI-LFPRM.
 11816     MOVE RWF-AHAMT             TO DE-REI-AHAMT.
 11817     MOVE RWF-AHPRM             TO DE-REI-AHPRM.
 11818     ADD RWF-LFRFND             TO RW-ACCUM-LF.
 11819     ADD RWF-AHRFND             TO RW-ACCUM-AH.
 11820     COMPUTE DE-REI-CNAMT = RWF-LFAMT * TEMP-5.
 11821
 11822     IF REIN-REM-SW (SUB1) NOT = 'I'
 11823         GO TO 3215-CONTINUE-CANCEL-LOOP.
 11824
 11825     IF CR-LF-CANCEL-EXIT-DATE = EOM-RUN-DATE  OR
 11826        VOIDING-LF-CANCEL
 11827         NEXT SENTENCE
 11828     ELSE
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 233
* ECS010Z.cbl
 11829         MOVE ZEROS             TO DE-REI-LFRFND.
 11830
 11831     IF CR-AH-CANCEL-EXIT-DATE = EOM-RUN-DATE  OR
 11832        VOIDING-AH-CANCEL
 11833         NEXT SENTENCE
 11834     ELSE
 11835         MOVE ZEROS             TO DE-REI-AHRFND.
 11836
 11837 3215-CONTINUE-CANCEL-LOOP.
 11838
 11839     IF RWF-LF-RUNOFF-SW = 'N'
 11840         IF DE-LF-CANC-DTE NOT LESS THAN RWF-EP-STOP-DATE
 11841             MOVE ZEROS         TO DE-LF-TYPE
 11842                                   DE-REI-LFAMT
 11843                                   DE-REI-LFPRM
 11844                                   DE-REI-LFRFND
 11845                                   DE-REI-CNAMT.
 11846
 11847     IF RWF-AH-RUNOFF-SW = 'N'
 11848         IF DE-AH-CANC-DTE NOT LESS THAN RWF-EP-STOP-DATE
 11849             MOVE ZEROS         TO DE-AH-TYPE
 11850                                   DE-REI-AHAMT
 11851                                   DE-REI-AHPRM
 11852                                   DE-REI-AHRFND.
 11853
 11854     IF DE-REI-LFAMT NOT = ZERO
 11855        OR DE-REI-LFPRM NOT = ZERO
 11856        OR DE-REI-AHAMT NOT = ZERO
 11857        OR DE-REI-AHPRM NOT = ZERO
 11858        OR DE-REI-LFRFND NOT = ZERO
 11859        OR DE-REI-AHRFND NOT = ZERO
 11860        OR DE-REI-CNAMT NOT = ZERO
 11861         PERFORM 2500-WRITE-DETAIL-EXTRACTS THRU
 11862                                            2599-WRT-DETAIL-X
 11863         ADD +1 TO BC-R-CNC.
 11864
 11865     ADD +1 TO SUB1.
 11866     MOVE SAVE-EXTRACT TO DETAIL-EXTRACT.
 11867     PERFORM EXTRACT-DATE-LOAD.
 11868     GO TO 3210-REINSURE-CANCEL-LOOP.
 11869
 11870 3219-REINSURE-CANCEL-LOOP-END.
 11871     EXIT.
 11872
 11873 3290-REINSURE-CANCEL-PRINT.
 11874
 11875     PERFORM 8600-SETUP-DETAIL-LINE THRU 8689-SETUP-DETAIL-X.
 11876     IF RW-ACCUM-LF NOT = ZERO
 11877         MOVE CLAS-I-AB3 (CLAS-INDEXL) TO TRD-LFTYP
 11878         MOVE CR-LF-TERM               TO TRD-LFTRM
 11879         MOVE RW-ACCUM-LF         TO TRD-LFPRM-RFND
 11880         MOVE 'REIN CANCL'        TO TRD-LF-ACTION.
 11881     IF RW-ACCUM-AH NOT = ZERO
 11882         MOVE CLAS-I-AB3 (CLAS-INDEXA) TO TRD-AHTYP
 11883         MOVE CR-AH-TERM               TO TRD-AHTRM
 11884         MOVE RW-ACCUM-AH         TO TRD-AHPRM-RFND
 11885         MOVE 'REIN CANCL'        TO TRD-AH-ACTION.
 11886     IF RW-ACCUM-LF NOT = ZERO  OR  RW-ACCUM-AH NOT = ZERO
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 234
* ECS010Z.cbl
 11887         PERFORM 8690-PRINT-DETAIL-LINE THRU 8699-PRT-DETAIL-X.
 11888
 11889 3299-REINSURE-CANCEL-X.
 11890     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 235
* ECS010Z.cbl
 11892******************************************************************
 11893***                R E I N S U R E   C L A I M S               ***
 11894******************************************************************
 11895
 11896 3300-REINSURE-CLAIM.
 11897
 11898*    IF DTE-CLIENT = '???'
 11899*       IF (REIN-RT-SW NOT = 'X')  AND
 11900*          (PC-PAYMENT-TYPE = '5' OR '6')
 11901*        GO TO 3399-REINSURE-CLAIM-X.
 11902
 11903     IF REIN-COMP (1) = SPACES
 11904         GO TO 3399-REINSURE-CLAIM-X.
 11905
 11906     IF REIN-RT-SW = 'X'
 11907         MOVE CR-DTHAMT   TO RW-LFCLMWK
 11908         ADD  CR-DTHEXP   TO RW-LFCLMWK
 11909         MOVE CR-DISAMT   TO RW-AHCLMWK
 11910         ADD  CR-DISEXP   TO RW-AHCLMWK
 11911     ELSE
 11912         IF PC-CLAIM-TYPE  = 1 OR 3
 11913             MOVE PC-CLAIM-PAYMENT    TO RW-LFCLMWK
 11914             MOVE +0                  TO RW-AHCLMWK
 11915         ELSE
 11916             MOVE PC-CLAIM-PAYMENT    TO RW-AHCLMWK
 11917             MOVE +0                  TO RW-LFCLMWK.
 11918
 11919     MOVE +0                          TO RW-LFCLM
 11920                                         RW-AHCLM.
 11921     IF RW-LFCLMWK = ZERO
 11922        AND RW-AHCLMWK = ZERO
 11923         GO TO 3399-REINSURE-CLAIM-X.
 11924
 11925     PERFORM REINSURE-CALC-CLAIM THRU REINSURE-CALC-CLAIM-X
 11926         VARYING SUB1 FROM +1 BY +1
 11927             UNTIL REIN-COMP (SUB1) = SPACES.
 11928
 11929     IF REIN-RT-SW = 'X'
 11930         GO TO 3399-REINSURE-CLAIM-X.
 11931
 11932     PERFORM 2300-BUILD-CLAIM-EXTRACT.
 11933     MOVE ZEROS                TO RW-ACCUM-CLM.
 11934     MOVE 'R'                  TO DE-REIN.
 11935*****PERFORM EXTRACT-DATE-RELOAD.
 11936     MOVE DETAIL-EXTRACT       TO SAVE-EXTRACT.
 11937     MOVE +1                   TO SUB1.
 11938
 11939 3310-REINSURE-CLAIM-LOOP.
 11940
 11941     IF REIN-COMP (SUB1) = SPACES
 11942         GO TO 3390-REINSURE-CLAIM-PRINT.
 11943
 11944     IF REIN-REM-SW (SUB1) = 'Z'
 11945         ADD +1        TO SUB1
 11946         MOVE SAVE-EXTRACT TO DETAIL-EXTRACT
 11947         PERFORM EXTRACT-DATE-LOAD
 11948         GO TO 3310-REINSURE-CLAIM-LOOP.
 11949
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 236
* ECS010Z.cbl
 11950     MOVE REIN-COMP (SUB1)      TO DE-REI-COMP.
 11951     MOVE REIN-WORK-FLDS (SUB1) TO RWF-FIELDS.
 11952
 11953     IF PC-CLAIM-TYPE  = 1 OR 3
 11954         IF RWF-LF-RUNOFF-SW = 'N'
 11955           IF CR-DTH-DT NOT LESS THAN RWF-EP-STOP-DATE
 11956               GO TO 3330-REINSURE-CLAIM-LOOP-ADD.
 11957
 11958     IF PC-CLAIM-TYPE  = 2 OR 4
 11959         IF RWF-AH-RUNOFF-SW = 'N'
 11960           IF CR-DIS-DT NOT LESS THAN RWF-EP-STOP-DATE
 11961               GO TO 3330-REINSURE-CLAIM-LOOP-ADD.
 11962
 11963     MOVE RWF-LFAMT             TO DE-REI-LFAMT.
 11964     MOVE RWF-LFPRM             TO DE-REI-LFPRM.
 11965     MOVE RWF-AHAMT             TO DE-REI-AHAMT.
 11966     MOVE RWF-AHPRM             TO DE-REI-AHPRM.
 11967
 11968     IF PC-CLAIM-TYPE  = 1 OR 3
 11969         MOVE RWF-LFCLML TO DE-REI-CLAIM-AMT
 11970         ADD RWF-LFCLML  TO RW-ACCUM-CLM
 11971     ELSE
 11972         MOVE RWF-AHCLML TO DE-REI-CLAIM-AMT
 11973         ADD RWF-AHCLML  TO RW-ACCUM-CLM.
 11974
 11975     IF PC-CLAIM-TYPE = 1 OR 3
 11976         IF +0 = DE-REI-LFPRM AND DE-REI-LFAMT
 11977            AND DE-REI-CLAIM-AMT
 11978             GO TO 3330-REINSURE-CLAIM-LOOP-ADD
 11979         ELSE
 11980             GO TO 3320-REINSURE-CLAIM-LOOP-GO
 11981     ELSE
 11982         IF +0 = DE-REI-AHPRM AND DE-REI-AHAMT
 11983            AND DE-REI-CLAIM-AMT
 11984             GO TO 3330-REINSURE-CLAIM-LOOP-ADD
 11985         ELSE
 11986             GO TO 3320-REINSURE-CLAIM-LOOP-GO.
 11987
 11988 3320-REINSURE-CLAIM-LOOP-GO.
 11989
 11990     PERFORM 2500-WRITE-DETAIL-EXTRACTS THRU 2599-WRT-DETAIL-X.
 11991     ADD +1                     TO BC-R-CLM.
 11992
 11993 3330-REINSURE-CLAIM-LOOP-ADD.
 11994
 11995     ADD +1                     TO SUB1.
 11996     MOVE SAVE-EXTRACT          TO DETAIL-EXTRACT.
 11997     PERFORM EXTRACT-DATE-LOAD.
 11998     GO TO 3310-REINSURE-CLAIM-LOOP.
 11999
 12000 3390-REINSURE-CLAIM-PRINT.
 12001
 12002     PERFORM 8600-SETUP-DETAIL-LINE THRU 8689-SETUP-DETAIL-X.
 12003     IF PC-CLAIM-TYPE = '1'  OR  '3'
 12004         MOVE CLAS-I-AB3 (CLAS-INDEXL) TO TRD-LFTYP
 12005         MOVE CR-LF-TERM               TO TRD-LFTRM
 12006         MOVE RW-ACCUM-CLM     TO TRD-LFCOM-CLM
 12007         MOVE 'REIN CLAIM'     TO TRD-LF-ACTION
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 237
* ECS010Z.cbl
 12008     ELSE
 12009         MOVE CLAS-I-AB3 (CLAS-INDEXA) TO TRD-AHTYP
 12010         MOVE CR-AH-TERM               TO TRD-AHTRM
 12011         MOVE RW-ACCUM-CLM     TO TRD-AHCOM-CLM
 12012         MOVE CR-DIS-MO        TO TRD-AHACTMO
 12013         MOVE CR-DIS-DA        TO TRD-AHACTDA
 12014         MOVE CR-DIS-YR        TO TRD-AHACTYR
 12015         MOVE '/'              TO TRD-AH-S1  TRD-AH-S2
 12016         MOVE 'REIN CLAIM'     TO TRD-AH-ACTION.
 12017     PERFORM 8690-PRINT-DETAIL-LINE THRU 8699-PRT-DETAIL-X.
 12018
 12019 3399-REINSURE-CLAIM-X.
 12020     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 238
* ECS010Z.cbl
 12022******************************************************************
 12023***              R E I N S U R E   R E S E R V E S             ***
 12024******************************************************************
 12025
 12026 3400-REINSURE-RESERVE.
 12027
 12028     IF REIN-COMP (1) = SPACES
 12029         GO TO 3499-REINSURE-RESERVE-X.
 12030
 12031     IF PC-CLAIM-TYPE = '1' OR '3'
 12032         MOVE PC-IBNR-RESERVE-AMT    TO RW-LFIBNRWK
 12033         MOVE PC-PTC-RESERVE-AMT     TO RW-LFPAYCURWK
 12034         MOVE PC-FUTURE-RESERVE-AMT  TO RW-LFFUTRSVWK
 12035         ADD  PC-MANUAL-RESERVE-AMT  TO RW-LFFUTRSVWK
 12036         MOVE +0 TO RW-AHIBNRWK  RW-AHPAYCURWK  RW-AHFUTRSVWK
 12037     ELSE
 12038         MOVE PC-IBNR-RESERVE-AMT    TO RW-AHIBNRWK
 12039         MOVE PC-PTC-RESERVE-AMT     TO RW-AHPAYCURWK
 12040         MOVE PC-FUTURE-RESERVE-AMT  TO RW-AHFUTRSVWK
 12041         ADD  PC-MANUAL-RESERVE-AMT  TO RW-AHFUTRSVWK
 12042         MOVE +0 TO RW-LFIBNRWK  RW-LFPAYCURWK  RW-LFFUTRSVWK.
 12043
 12044     MOVE +0 TO RW-LFIBNR  RW-LFPAYCUR  RW-LFFUTRSV
 12045                RW-AHIBNR  RW-AHPAYCUR  RW-AHFUTRSV.
 12046     IF +0 = RW-LFIBNRWK AND RW-LFPAYCURWK AND RW-LFFUTRSVWK
 12047         AND RW-AHIBNRWK AND RW-AHPAYCURWK AND RW-AHFUTRSVWK
 12048          GO TO 3499-REINSURE-RESERVE-X.
 12049
 12050     IF DTE-CLIENT NOT = 'MIC'
 12051         GO TO 3405-REINSURE-RESERVE-CONT.
 12052
 12053     IF PC-CLAIM-TYPE = '1'  OR  '3'
 12054         GO TO 3405-REINSURE-RESERVE-CONT.
 12055
 12056     MOVE PC-CERT-EFF-DT             TO CP-CERT-EFF-DT.
 12057     MOVE BIN-VALUATION-DT           TO CP-VALUATION-DT.
 12058     MOVE PC-PAID-THRU-DT            TO CP-PAID-THRU-DT.
 12059     MOVE 'A'                        TO CP-BENEFIT-TYPE
 12060                                        CP-CLAIM-TYPE.
 12061     MOVE PC-INCURRED-DT             TO CP-INCURRED-DT.
 12062     MOVE PC-REPORTED-DT             TO CP-REPORTED-DT.
 12063     MOVE DTE-CLIENT                 TO CP-COMPANY-ID.
 12064     MOVE CR-AGE                     TO CP-ISSUE-AGE.
 12065     MOVE ZEROS                      TO CP-CDT-PERCENT.
 12066     MOVE '3'                        TO CP-CDT-METHOD.
 12067     MOVE CR-AH-TERM                 TO CP-ORIGINAL-TERM.
 12068     MOVE CR-AHAMT                   TO CP-ORIGINAL-BENEFIT
 12069                                        CP-RATING-BENEFIT-AMT.
 12070     MOVE PC-REMAINING-TERM          TO CP-REMAINING-TERM.
 12071     MOVE 'O'                        TO CP-CLAIM-STATUS.
 12072
 12073 3405-REINSURE-RESERVE-CONT.
 12074
 12075     PERFORM 3500-REINSURE-CALC-RESERVE
 12076         THRU 3599-REINSURE-CALC-RESERVE-X
 12077             VARYING SUB1 FROM +1 BY +1
 12078                 UNTIL REIN-COMP (SUB1) = SPACES.
 12079
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 239
* ECS010Z.cbl
 12080     PERFORM 2400-BUILD-RESERVE-EXTRACT.
 12081     MOVE +0 TO RW-ACCUM-IBNR  RW-ACCUM-PAYCUR  RW-ACCUM-FUTRSV.
 12082     MOVE 'R'            TO DE-REIN.
 12083*****PERFORM EXTRACT-DATE-RELOAD.
 12084     MOVE DETAIL-EXTRACT TO SAVE-EXTRACT.
 12085     MOVE +1             TO SUB1.
 12086
 12087 3410-REINSURE-RESERVE-LOOP.
 12088
 12089     IF REIN-COMP (SUB1) = SPACES
 12090         GO TO 3490-REINSURE-RESERVE-PRINT.
 12091
 12092     IF REIN-REM-SW (SUB1) = 'Z'
 12093         ADD +1 TO SUB1
 12094         GO TO 3410-REINSURE-RESERVE-LOOP.
 12095
 12096     MOVE REIN-COMP (SUB1)      TO DE-REI-COMP.
 12097     MOVE REIN-WORK-FLDS (SUB1) TO RWF-FIELDS.
 12098
 12099     IF PC-CLAIM-TYPE  = 1 OR 3
 12100         IF RWF-LF-RUNOFF-SW = 'N'
 12101           IF CR-DTH-DT NOT LESS THAN RWF-EP-STOP-DATE
 12102               GO TO 3415-REINSURE-RESERVE-LOOP-ADD.
 12103
 12104     IF PC-CLAIM-TYPE  = 2 OR 4
 12105         IF RWF-AH-RUNOFF-SW = 'N'
 12106           IF CR-DIS-DT NOT LESS THAN RWF-EP-STOP-DATE
 12107               GO TO 3415-REINSURE-RESERVE-LOOP-ADD.
 12108
 12109     MOVE RWF-LFAMT             TO DE-REI-LFAMT.
 12110     MOVE RWF-LFPRM             TO DE-REI-LFPRM.
 12111     MOVE RWF-AHAMT             TO DE-REI-AHAMT.
 12112     MOVE RWF-AHPRM             TO DE-REI-AHPRM.
 12113
 12114     IF PC-CLAIM-TYPE = 1 OR 3
 12115         MOVE RWF-DTH-IBNRL   TO DE-REI-IBNR
 12116         MOVE RWF-DTH-PAYCURL TO DE-REI-PAYCUR
 12117         MOVE RWF-DTH-FUTRSVL TO DE-REI-FUTRSV
 12118     ELSE
 12119         MOVE RWF-DIS-IBNRL   TO DE-REI-IBNR
 12120         MOVE RWF-DIS-PAYCURL TO DE-REI-PAYCUR
 12121         MOVE RWF-DIS-FUTRSVL TO DE-REI-FUTRSV.
 12122
 12123     ADD DE-REI-IBNR            TO RW-ACCUM-IBNR.
 12124     ADD DE-REI-PAYCUR          TO RW-ACCUM-PAYCUR.
 12125     ADD DE-REI-FUTRSV          TO RW-ACCUM-FUTRSV.
 12126
 12127     IF +0 NOT = DE-REI-LFAMT OR DE-REI-LFPRM OR DE-REI-AHAMT
 12128        OR DE-REI-AHPRM OR DE-REI-IBNR OR DE-REI-PAYCUR
 12129        OR DE-REI-FUTRSV
 12130         PERFORM 2500-WRITE-DETAIL-EXTRACTS THRU
 12131                                            2599-WRT-DETAIL-X
 12132         ADD +1 TO BC-R-CRS.
 12133
 12134 3415-REINSURE-RESERVE-LOOP-ADD.
 12135
 12136     ADD +1 TO SUB1.
 12137     MOVE SAVE-EXTRACT TO DETAIL-EXTRACT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 240
* ECS010Z.cbl
 12138     PERFORM EXTRACT-DATE-LOAD.
 12139     GO TO 3410-REINSURE-RESERVE-LOOP.
 12140
 12141 3490-REINSURE-RESERVE-PRINT.
 12142
 12143     IF RW-ACCUM-IBNR   = ZERO  AND
 12144        RW-ACCUM-PAYCUR = ZERO  AND
 12145        RW-ACCUM-FUTRSV = ZERO
 12146         GO TO 3499-REINSURE-RESERVE-X.
 12147
 12148     PERFORM 8600-SETUP-DETAIL-LINE THRU 8689-SETUP-DETAIL-X.
 12149     MOVE RW-ACCUM-IBNR             TO TRD-IBNR.
 12150     MOVE 'IBNR'                    TO TRD-IBNRX.
 12151     MOVE RW-ACCUM-PAYCUR           TO TRD-PAYCUR.
 12152     MOVE 'PAY CURR'                TO TRD-PAYCURX.
 12153     MOVE RW-ACCUM-FUTRSV           TO TRD-FUTRSV.
 12154     MOVE 'FUTURE'                  TO TRD-FUTRSVX.
 12155
 12156     IF PC-CLAIM-TYPE = 1
 12157         MOVE LIFE-OVERRIDE-L6      TO TRD-RSV-DESC
 12158     ELSE
 12159         MOVE AH-OVERRIDE-L6        TO TRD-RSV-DESC.
 12160     MOVE ' REIN. CLAIM RESERVES'   TO TRD-RSV-ACTION.
 12161
 12162     PERFORM 8690-PRINT-DETAIL-LINE THRU 8699-PRT-DETAIL-X.
 12163
 12164 3499-REINSURE-RESERVE-X.
 12165     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 241
* ECS010Z.cbl
 12167******************************************************************
 12168***        C A L C U L A T E   R E I N   R E S E R V E S       ***
 12169******************************************************************
 12170
 12171 3500-REINSURE-CALC-RESERVE.
 12172
 12173     MOVE REIN-WORK-FLDS (SUB1) TO RWF-FIELDS.
 12174     MOVE +0 TO RWF-DTH-IBNRL RWF-DTH-PAYCURL  RWF-DTH-FUTRSVL
 12175                RWF-DIS-IBNRL  RWF-DIS-PAYCURL  RWF-DIS-FUTRSVL.
 12176
 12177     PERFORM REIN-FIND-CO-LOOP THRU FIND-REI-CO-EXIT
 12178        VARYING CO-SUB FROM 1 BY 1 UNTIL
 12179          (RCT-REIN-CO (CO-SUB) = REIN-COMP (SUB1))
 12180       OR (CO-SUB GREATER REIN-CO-TABLE-ENT-CNT).
 12181
 12182     IF CO-SUB GREATER REIN-CO-TABLE-ENT-CNT
 12183        MOVE ZERO TO CO-SUB.
 12184
 12185     IF CO-SUB NOT = ZERO
 12186        IF RCT-CLM-CUTOFF-DT (CO-SUB) NOT = ZERO
 12187           IF PC-CLAIM-TYPE = '1' OR '3'
 12188             IF CR-DTH-DT LESS THAN RCT-CLM-CUTOFF-DT (CO-SUB)
 12189                 GO TO 3540-CONT-REIN-CALC-RESERVE.
 12190
 12191     IF PC-CLAIM-TYPE  = 1 OR 3
 12192         IF RWF-LF-RUNOFF-SW = 'N'
 12193           IF CR-DTH-DT NOT LESS THAN RWF-EP-STOP-DATE
 12194               GO TO 3540-CONT-REIN-CALC-RESERVE.
 12195
 12196     IF CO-SUB NOT = ZERO
 12197        IF RCT-CLM-CUTOFF-DT (CO-SUB) NOT = ZERO
 12198           IF PC-CLAIM-TYPE = '2' OR '4'
 12199             IF CR-DIS-DT LESS THAN RCT-CLM-CUTOFF-DT (CO-SUB)
 12200                 GO TO 3540-CONT-REIN-CALC-RESERVE.
 12201
 12202     IF PC-CLAIM-TYPE  = 2 OR 4
 12203         IF RWF-AH-RUNOFF-SW = 'N'
 12204           IF CR-DIS-DT NOT LESS THAN RWF-EP-STOP-DATE
 12205               GO TO 3540-CONT-REIN-CALC-RESERVE.
 12206
 12207     IF DTE-CLIENT NOT = 'MIC'
 12208         GO TO 3505-REIN-CALC-RESERVE-CONT.
 12209
 12210     IF PC-CLAIM-TYPE = '1'  OR  '3'
 12211         GO TO 3505-REIN-CALC-RESERVE-CONT.
 12212
 12213     MOVE PC-FUTURE-RESERVE-AMT        TO RW-AHFUTRSVWK.
 12214
 12215     IF CR-AHTYP = ZERO  OR
 12216        CO-SUB = ZERO
 12217         GO TO 3505-REIN-CALC-RESERVE-CONT
 12218     ELSE
 12219         IF RCT-AH-CLM-MAX (CO-SUB) = ZERO
 12220             GO TO 3505-REIN-CALC-RESERVE-CONT.
 12221
 12222     COMPUTE MAX-REM-TERM ROUNDED =
 12223                         RCT-AH-CLM-MAX (CO-SUB) / CR-AHAMT.
 12224
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 242
* ECS010Z.cbl
 12225     IF MAX-REM-TERM NOT LESS THAN CP-REMAINING-TERM
 12226         GO TO 3505-REIN-CALC-RESERVE-CONT.
 12227
 12228     COMPUTE CP-ORIGINAL-TERM =
 12229                 CR-AH-TERM - CP-REMAINING-TERM + MAX-REM-TERM.
 12230
 12231     CALL 'ELRESVX' USING CALCULATION-PASS-AREA.
 12232
 12233     IF  CP-RETURN-CODE = ZERO
 12234         MOVE CP-FUTURE-RESERVE    TO RW-AHFUTRSVWK.
 12235
 12236 3505-REIN-CALC-RESERVE-CONT.
 12237
 12238     IF SUB1 = RE-100-COMP
 12239         GO TO 3520-REIN-REMAINDER-RSRV.
 12240
 12241     IF CR-LFAMT NOT = ZERO  AND
 12242        RWF-LFAMT NOT = ZERO
 12243         IF DTE-CLIENT NOT = 'MIC'
 12244             COMPUTE RWF-DTH-IBNRL = (RW-LFIBNRWK *
 12245                         RWF-LFAMT) / (CR-LFAMT + CR-LFAMT-ALT)
 12246             COMPUTE RWF-DTH-PAYCURL = (RW-LFPAYCURWK *
 12247                         RWF-LFAMT) / (CR-LFAMT + CR-LFAMT-ALT)
 12248             COMPUTE RWF-DTH-FUTRSVL = (RW-LFFUTRSVWK *
 12249                         RWF-LFAMT) / (CR-LFAMT + CR-LFAMT-ALT)
 12250         ELSE
 12251             MOVE RW-LFIBNRWK         TO RWF-DTH-IBNRL
 12252             MOVE RW-LFPAYCURWK       TO RWF-DTH-PAYCURL
 12253             MOVE RW-LFFUTRSVWK       TO RWF-DTH-FUTRSVL.
 12254
 12255     IF CR-AHAMT NOT = ZERO  AND
 12256        RWF-AHAMT NOT = ZERO
 12257         IF DTE-CLIENT NOT = 'MIC'
 12258             COMPUTE RWF-DIS-IBNRL = (RW-AHIBNRWK *
 12259                         RWF-AHAMT) / CR-AHAMT
 12260             COMPUTE RWF-DIS-PAYCURL = (RW-AHPAYCURWK *
 12261                         RWF-AHAMT) / CR-AHAMT
 12262             COMPUTE RWF-DIS-FUTRSVL = (RW-AHFUTRSVWK *
 12263                         RWF-AHAMT) / CR-AHAMT
 12264         ELSE
 12265             MOVE RW-AHIBNRWK         TO RWF-DIS-IBNRL
 12266             MOVE RW-AHPAYCURWK       TO RWF-DIS-PAYCURL
 12267             MOVE RW-AHFUTRSVWK       TO RWF-DIS-FUTRSVL.
 12268
 12269 3510-REINSURE-CALC-RESERVE-ADD.
 12270
 12271     ADD RWF-DTH-IBNRL   TO RWF-DTH-IBNR.
 12272     ADD RWF-DTH-PAYCURL TO RWF-DTH-PAYCUR.
 12273     ADD RWF-DTH-FUTRSVL TO RWF-DTH-FUTRSV.
 12274     ADD RWF-DIS-IBNRL   TO RWF-DIS-IBNR.
 12275     ADD RWF-DIS-PAYCURL TO RWF-DIS-PAYCUR.
 12276     ADD RWF-DIS-FUTRSVL TO RWF-DIS-FUTRSV.
 12277
 12278     IF DTE-CLIENT NOT = 'MIC'  AND  'MCC'
 12279         GO TO 3519-REINSURE-CALC-RESERVE-END.
 12280
 12281     IF CO-SUB = ZERO
 12282         GO TO 3519-REINSURE-CALC-RESERVE-END.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 243
* ECS010Z.cbl
 12283
 12284 3513-REIN-CHK-LF-RSRV-LIMIT.
 12285     IF RCT-LF-CLM-MAX (CO-SUB) = ZERO
 12286         GO TO 3515-REIN-CHK-AH-RSRV-LIMIT.
 12287
 12288     IF RWF-DTH-IBNR GREATER THAN RCT-LF-CLM-MAX (CO-SUB)
 12289         MOVE RCT-LF-CLM-MAX (CO-SUB) TO RWF-DTH-IBNR.
 12290
 12291     COMPUTE EXCESS-RESERVE = RCT-LF-CLM-MAX (CO-SUB) -
 12292                                      (RWF-LFCLM +
 12293                                       RWF-DTH-PAYCUR +
 12294                                       RWF-DTH-FUTRSV).
 12295
 12296     IF EXCESS-RESERVE NOT LESS THAN ZERO
 12297         GO TO 3515-REIN-CHK-AH-RSRV-LIMIT.
 12298
 12299     ADD EXCESS-RESERVE TO RWF-DTH-PAYCURL.
 12300
 12301     IF RWF-DTH-PAYCURL LESS THAN ZERO
 12302         ADD RWF-DTH-PAYCURL TO RWF-DTH-FUTRSVL
 12303         MOVE ZEROS TO RWF-DTH-PAYCURL.
 12304     IF RWF-DTH-FUTRSVL LESS THAN ZERO
 12305         MOVE ZEROS TO RWF-DTH-FUTRSVL.
 12306
 12307     ADD EXCESS-RESERVE TO RWF-DTH-PAYCUR.
 12308
 12309     IF RWF-DTH-PAYCUR LESS THAN ZERO
 12310         ADD RWF-DTH-PAYCUR TO RWF-DTH-FUTRSV
 12311         MOVE ZEROS TO RWF-DTH-PAYCUR.
 12312     IF RWF-DTH-FUTRSV LESS THAN ZERO
 12313         MOVE ZEROS TO RWF-DTH-FUTRSV.
 12314
 12315 3515-REIN-CHK-AH-RSRV-LIMIT.
 12316     IF RCT-AH-CLM-MAX (CO-SUB) = ZERO
 12317         GO TO 3519-REINSURE-CALC-RESERVE-END.
 12318
 12319     IF RWF-DIS-IBNR GREATER THAN RCT-AH-CLM-MAX (CO-SUB)
 12320         MOVE RCT-AH-CLM-MAX (CO-SUB) TO RWF-DIS-IBNR.
 12321
 12322     COMPUTE EXCESS-RESERVE = RCT-AH-CLM-MAX (CO-SUB) -
 12323                                      (RWF-AHCLM +
 12324                                       RWF-DIS-PAYCUR +
 12325                                       RWF-DIS-FUTRSV).
 12326
 12327     IF EXCESS-RESERVE NOT LESS THAN ZERO
 12328         GO TO 3519-REINSURE-CALC-RESERVE-END.
 12329
 12330     ADD EXCESS-RESERVE TO RWF-DIS-PAYCURL.
 12331
 12332     IF RWF-DIS-PAYCURL LESS THAN ZERO
 12333         ADD RWF-DIS-PAYCURL TO RWF-DIS-FUTRSVL
 12334         MOVE ZEROS TO RWF-DIS-PAYCURL.
 12335     IF RWF-DIS-FUTRSVL LESS THAN ZERO
 12336         MOVE ZEROS TO RWF-DIS-FUTRSVL.
 12337
 12338     ADD EXCESS-RESERVE TO RWF-DIS-PAYCUR.
 12339
 12340     IF RWF-DIS-PAYCUR LESS THAN ZERO
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 244
* ECS010Z.cbl
 12341         ADD RWF-DIS-PAYCUR TO RWF-DIS-FUTRSV
 12342         MOVE ZEROS TO RWF-DIS-PAYCUR.
 12343     IF RWF-DIS-FUTRSV LESS THAN ZERO
 12344         MOVE ZEROS TO RWF-DIS-FUTRSV.
 12345
 12346 3519-REINSURE-CALC-RESERVE-END.
 12347
 12348     IF +0 NOT = RWF-DTH-IBNR OR RWF-DTH-PAYCUR
 12349        OR RWF-DTH-FUTRSV
 12350         MOVE 'X' TO REIN-LF-FLG (SUB1).
 12351
 12352     IF +0 NOT = RWF-DIS-IBNR OR RWF-DIS-PAYCUR
 12353        OR RWF-DIS-FUTRSV
 12354         MOVE 'X' TO REIN-AH-FLG (SUB1).
 12355
 12356     GO TO 3540-CONT-REIN-CALC-RESERVE.
 12357
 12358 3520-REIN-REMAINDER-RSRV.
 12359
 12360     MOVE RW-LFIBNRWK   TO RWF-DTH-IBNRL.
 12361     MOVE RW-LFPAYCURWK TO RWF-DTH-PAYCURL.
 12362     MOVE RW-LFFUTRSVWK TO RWF-DTH-FUTRSVL.
 12363     MOVE RW-AHIBNRWK   TO RWF-DIS-IBNRL.
 12364     MOVE RW-AHPAYCURWK TO RWF-DIS-PAYCURL.
 12365     MOVE RW-AHFUTRSVWK TO RWF-DIS-FUTRSVL.
 12366
 12367     PERFORM 3530-REIN-SUB-RSRV
 12368         THRU 3539-REIN-SUB-RSRV-X
 12369             VARYING SUB2 FROM +1 BY +1 UNTIL SUB2 = SUB1.
 12370
 12371     GO TO 3510-REINSURE-CALC-RESERVE-ADD.
 12372
 12373 3530-REIN-SUB-RSRV.
 12374
 12375     SUBTRACT REIN-DTH-IBNRL (SUB2)   FROM RWF-DTH-IBNRL.
 12376     SUBTRACT REIN-DTH-PAYCURL (SUB2) FROM RWF-DTH-PAYCURL.
 12377     SUBTRACT REIN-DTH-FUTRSVL (SUB2) FROM RWF-DTH-FUTRSVL.
 12378     SUBTRACT REIN-DIS-IBNRL (SUB2)   FROM RWF-DIS-IBNRL.
 12379     SUBTRACT REIN-DIS-PAYCURL (SUB2) FROM RWF-DIS-PAYCURL.
 12380     SUBTRACT REIN-DIS-FUTRSVL (SUB2) FROM RWF-DIS-FUTRSVL.
 12381
 12382 3539-REIN-SUB-RSRV-X.
 12383     EXIT.
 12384
 12385 3540-CONT-REIN-CALC-RESERVE.
 12386
 12387     IF REIN-LF-AH-FLGS (SUB1) NOT = SPACES
 12388         MOVE 'X' TO REIN-BUS-FLAG.
 12389     MOVE RWF-FIELDS TO REIN-WORK-FLDS (SUB1).
 12390
 12391 3599-REINSURE-CALC-RESERVE-X.
 12392     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 245
* ECS010Z.cbl
 12394******************************************************************
 12395***       R E I N S U R A N C E   C A L C U L A T I O N S      ***
 12396******************************************************************
 12397
 12398*REINSURANCE-CALCULATIONS.
*12399                             COPY ECSRIRTN.
 12400******************************************************************04/30/98
 12401*                                                                *ECSRIRTN
 12402*                            ECSRIRTN                            *   LV012
 12403*                            VMOD=2.025.                         *ECSRIRTN
 12404*                                                                *ECSRIRTN
 12405******************************************************************ECSRIRTN
 12406******************************************************************
 12407*                   C H A N G E   L O G
 12408*
 12409* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
 12410*-----------------------------------------------------------------
 12411*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
 12412* EFFECTIVE    NUMBER
 12413*-----------------------------------------------------------------
 12414* 062703                   PEMA  ADD DCC CLIENT ID TO
 12415*                                SPECIAL CEDED CLAIM CALC
 12416* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
 12417* 052114  CR2014051900001  PEMA  ADD ROUNDING TO PREM TAX CALC
 12418                                                                  ECSRIRTN
 12419 REINSURE-CALC.                                                   ECSRIRTN
 12420                                                                  ECSRIRTN
 12421     MOVE RE-REI-COMP-NO (SUB1) TO REIN-COMP (SUB1).              ECSRIRTN
 12422     MOVE REIN-WORK-FLDS (SUB1) TO RWF-FIELDS.                    ECSRIRTN
 12423     MOVE RE-COMP-INFO (SUB1)   TO WT-COMP-INFO.                  ECSRIRTN
 12424     MOVE WT-REMAINING          TO RWF-REM-SW                     ECSRIRTN
 12425                                   REIN-REM-SW (SUB1).            ECSRIRTN
 12426                                                                  ECSRIRTN
 12427     MOVE ZEROS                 TO RWF-EP-STOP-DATE               ECSRIRTN
 12428                                   WS-RWF-EP-STOP-DATE-N             CL*12
 12429                                   REIN-EP-STOP-DATE (SUB1).      ECSRIRTN
 12430                                                                  ECSRIRTN
 12431     MOVE 'Y'                   TO RWF-LF-RUNOFF-SW               ECSRIRTN
 12432                                   REIN-LF-RUNOFF-SW (SUB1)       ECSRIRTN
 12433                                   RWF-AH-RUNOFF-SW               ECSRIRTN
 12434                                   REIN-AH-RUNOFF-SW (SUB1).      ECSRIRTN
 12435                                                                  ECSRIRTN
 12436     PERFORM REIN-FIND-CO-LOOP THRU FIND-REI-CO-EXIT              ECSRIRTN
 12437        VARYING CO-SUB FROM 1 BY 1 UNTIL                          ECSRIRTN
 12438          (RCT-REIN-CO (CO-SUB) = REIN-COMP (SUB1))  OR           ECSRIRTN
 12439          (CO-SUB GREATER REIN-CO-TABLE-ENT-CNT)     OR           ECSRIRTN
 12440          (RCT-REIN-CO (CO-SUB) = SPACES).                        ECSRIRTN
 12441                                                                  ECSRIRTN
 12442     IF (CO-SUB GREATER REIN-CO-TABLE-ENT-CNT)  OR                ECSRIRTN
 12443        (RCT-REIN-CO (CO-SUB) = SPACES)                           ECSRIRTN
 12444         GO TO CALC-CONTINUED.                                    ECSRIRTN
 12445                                                                  ECSRIRTN
 12446     MOVE RCT-EARNING-STOP-DT (CO-SUB) TO RWF-EP-STOP-DATE        ECSRIRTN
 12447                                          WS-RWF-EP-STOP-DATE-N      CL*12
 12448                                          REIN-EP-STOP-DATE (SUB1)ECSRIRTN
 12449                                                                  ECSRIRTN
 12450     IF RWF-EP-STOP-DATE = ZEROS                                  ECSRIRTN
 12451         GO TO CALC-CONTINUED.                                    ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 246
* ECS010Z.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 12452                                                                  ECSRIRTN
 12453     IF RCT-EARN-STOP-CODE (CO-SUB) = 'L'  OR  'B'                ECSRIRTN
 12454         MOVE 'N'               TO RWF-LF-RUNOFF-SW               ECSRIRTN
 12455                                   REIN-LF-RUNOFF-SW (SUB1).      ECSRIRTN
 12456                                                                  ECSRIRTN
 12457     IF RCT-EARN-STOP-CODE (CO-SUB) = 'A'  OR  'B'                ECSRIRTN
 12458         MOVE 'N'               TO RWF-AH-RUNOFF-SW               ECSRIRTN
 12459                                   REIN-AH-RUNOFF-SW (SUB1).      ECSRIRTN
 12460                                                                  ECSRIRTN
 12461 CALC-CONTINUED.                                                  ECSRIRTN
 12462                                                                  ECSRIRTN
 12463     COMPUTE RS-LIFE-BEN  = CR-LFAMT + CR-LFAMT-ALT.              ECSRIRTN
 12464     COMPUTE RS-LIFE-PREM = CR-LFPRM + CR-LFPRM-ALT.              ECSRIRTN
 12465                                                                  ECSRIRTN
 12466     IF RE-NSP-ST-CD-LF = ZEROS  OR  SPACES                       ECSRIRTN
 12467         COMPUTE RS-LP-CALC = CR-LFPRM-CALC + CR-LFPRM-CALC-ALT   ECSRIRTN
 12468     ELSE                                                         ECSRIRTN
 12469         MOVE CR-LF-NSP-PRM         TO RS-LP-CALC.                ECSRIRTN
 12470     MOVE RS-LP-CALC                TO REIN-CALCED-LIFE.          ECSRIRTN
 12471                                                                  ECSRIRTN
 12472     MOVE CR-AHAMT                  TO RS-AH-BEN.                 ECSRIRTN
 12473     MOVE CR-AHPRM                  TO RS-AH-PREM.                ECSRIRTN
 12474     IF RE-NSP-ST-CD-AH = ZEROS  OR  SPACES                       ECSRIRTN
 12475         MOVE CR-AHPRM-CALC         TO RS-AP-CALC                 ECSRIRTN
 12476     ELSE                                                         ECSRIRTN
 12477         MOVE CR-AH-NSP-PRM         TO RS-AP-CALC.                ECSRIRTN
 12478     MOVE RS-AP-CALC                TO REIN-CALCED-AH.            ECSRIRTN
 12479                                                                  ECSRIRTN
 12480     IF WT-REMAINING = 'Y' OR 'Z' OR 'L' OR 'R'                   ECSRIRTN
 12481         MOVE RS-R-LB               TO RS-LIFE-BEN                ECSRIRTN
 12482         MOVE RS-R-LP               TO RS-LIFE-PREM               ECSRIRTN
 12483         MOVE RS-R-LPC              TO RS-LP-CALC                 ECSRIRTN
 12484         MOVE RS-R-AB               TO RS-AH-BEN                  ECSRIRTN
 12485         MOVE RS-R-AP               TO RS-AH-PREM                 ECSRIRTN
 12486         MOVE RS-R-APC              TO RS-AP-CALC.                ECSRIRTN
 12487                                                                  ECSRIRTN
 12488     IF SUB1 = RE-100-COMP                                        ECSRIRTN
 12489         GO TO REINSURE-CALC-REMAINDER.                           ECSRIRTN
 12490                                                                  ECSRIRTN
 12491     IF CR-DT LESS WT-LO-DATE                                        CL**2
 12492         GO TO REINSURE-CALC-X.                                   ECSRIRTN
 12493                                                                  ECSRIRTN
 12494     IF CR-DT NOT LESS WT-HI-DATE                                    CL**2
 12495         GO TO REINSURE-CALC-X.                                   ECSRIRTN
 12496                                                                  ECSRIRTN
 12497     PERFORM REINSURE-CK-LIFE      THRU REINSURE-CK-LIFE-X.       ECSRIRTN
 12498     PERFORM REINSURE-CK-AH        THRU REINSURE-CK-AH-X.         ECSRIRTN
 12499                                                                  ECSRIRTN
 12500     IF WT-INTERACTIVE = 'E'                                      ECSRIRTN
 12501         PERFORM REIN-CHECK-INTERACT-E THRU REIN-INTERACT-CHECK-X.ECSRIRTN
 12502                                                                  ECSRIRTN
 12503     IF WT-INTERACTIVE = 'X'                                      ECSRIRTN
 12504       IF  (REIN-LF-FLG (SUB1) = 'X' AND REIN-AH-FLG (SUB1) = 'X')ECSRIRTN
 12505        OR (REIN-LF-FLG (SUB1) = 'X' AND REIN-AH-FLG (SUB1) = ' ')ECSRIRTN
 12506        OR (REIN-LF-FLG (SUB1) = ' ' AND REIN-AH-FLG (SUB1) = 'X')ECSRIRTN
 12507           NEXT SENTENCE                                          ECSRIRTN
 12508       ELSE                                                       ECSRIRTN
 12509           MOVE 'Y' TO REIN-LF-FLG (SUB1)                         ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 247
* ECS010Z.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 12510                       REIN-AH-FLG (SUB1).                        ECSRIRTN
 12511                                                                  ECSRIRTN
 12512     IF WT-INTERACTIVE = 'Y'                                      ECSRIRTN
 12513         IF REIN-LF-FLG (SUB1) = 'X' AND                          ECSRIRTN
 12514            REIN-AH-FLG (SUB1) = 'Y'                              ECSRIRTN
 12515             MOVE 'X' TO REIN-AH-FLG (SUB1).                      ECSRIRTN
 12516                                                                  ECSRIRTN
 12517     IF WT-INTERACTIVE = 'Y'                                      ECSRIRTN
 12518         IF REIN-AH-FLG (SUB1) = 'X' AND                          ECSRIRTN
 12519            REIN-LF-FLG (SUB1) = 'Y'                              ECSRIRTN
 12520             MOVE 'X' TO REIN-LF-FLG (SUB1).                      ECSRIRTN
 12521                                                                  ECSRIRTN
 12522     IF WT-INTERACTIVE = 'Z'                                      ECSRIRTN
 12523         IF REIN-LF-FLG (SUB1) = 'X'                              ECSRIRTN
 12524             IF REIN-AH-FLG (SUB1) = 'Y'                          ECSRIRTN
 12525                 MOVE 'X' TO REIN-AH-FLG (SUB1)                   ECSRIRTN
 12526             ELSE                                                 ECSRIRTN
 12527                 NEXT SENTENCE                                    ECSRIRTN
 12528         ELSE                                                     ECSRIRTN
 12529             MOVE 'Y' TO REIN-LF-FLG (SUB1)                       ECSRIRTN
 12530                         REIN-AH-FLG (SUB1).                      ECSRIRTN
 12531                                                                  ECSRIRTN
 12532     IF WT-INTERACTIVE = 'W'                                      ECSRIRTN
 12533         IF REIN-AH-FLG (SUB1) = 'X'                              ECSRIRTN
 12534             IF REIN-LF-FLG (SUB1) = 'Y'                          ECSRIRTN
 12535                 MOVE 'X' TO REIN-LF-FLG (SUB1)                   ECSRIRTN
 12536             ELSE                                                 ECSRIRTN
 12537                 NEXT SENTENCE                                    ECSRIRTN
 12538         ELSE                                                     ECSRIRTN
 12539             MOVE 'Y' TO REIN-LF-FLG (SUB1)                       ECSRIRTN
 12540                         REIN-AH-FLG (SUB1).                      ECSRIRTN
 12541                                                                  ECSRIRTN
 12542     IF REIN-LF-FLG (SUB1) = 'X'                                  ECSRIRTN
 12543         PERFORM REIN-CALC-LIFE THRU REIN-CALC-LIFE-X.            ECSRIRTN
 12544                                                                  ECSRIRTN
 12545     IF REIN-LF-FLG (SUB1) = 'E'                                  ECSRIRTN
 12546         PERFORM REIN-LF-SKIP-LIMIT THRU REIN-CALC-LIFE-X         ECSRIRTN
 12547         MOVE 'X' TO REIN-LF-FLG (SUB1).                          ECSRIRTN
 12548                                                                  ECSRIRTN
 12549     IF REIN-AH-FLG (SUB1) = 'X'                                  ECSRIRTN
 12550         PERFORM REIN-CALC-AH THRU REIN-CALC-AH-X.                ECSRIRTN
 12551                                                                  ECSRIRTN
 12552     IF REIN-AH-FLG (SUB1) = 'E'                                  ECSRIRTN
 12553         PERFORM REIN-AH-SKIP-LIMIT THRU REIN-CALC-AH-X           ECSRIRTN
 12554         MOVE 'X'                TO  REIN-AH-FLG (SUB1).          ECSRIRTN
 12555                                                                  ECSRIRTN
 12556     IF REIN-LF-FLG (SUB1) NOT = 'X'                              ECSRIRTN
 12557         MOVE SPACE TO REIN-LF-FLG (SUB1).                        ECSRIRTN
 12558                                                                  ECSRIRTN
 12559     IF REIN-AH-FLG (SUB1) NOT = 'X'                              ECSRIRTN
 12560         MOVE SPACE TO REIN-AH-FLG (SUB1).                        ECSRIRTN
 12561                                                                  ECSRIRTN
 12562     GO TO REINSURE-CALC-X.                                       ECSRIRTN
 12563                                                                  ECSRIRTN
 12564 REINSURE-CK-LIFE.                                                ECSRIRTN
 12565                                                                  ECSRIRTN
 12566     IF CR-LFTYP = ZERO                                           ECSRIRTN
 12567         GO TO REINSURE-CK-LIFE-X.                                ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 248
* ECS010Z.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 12568                                                                  ECSRIRTN
 12569     IF WT-LF-PCT = ZERO                                          ECSRIRTN
 12570         GO TO REINSURE-CK-LIFE-X.                                ECSRIRTN
 12571                                                                  ECSRIRTN
 12572     IF DTE-CLIENT = 'CSO' OR 'CSI'                               ECSRIRTN
 12573         IF CLAS-I-REIN-YN (CLAS-INDEXL) = 'N'                    ECSRIRTN
 12574             GO TO REINSURE-CK-LIFE-X.                            ECSRIRTN
 12575                                                                  ECSRIRTN
 12576     MOVE WT-LF-BEN-CODE                TO REIN-BEN-CODE.         ECSRIRTN
 12577                                                                  ECSRIRTN
 12578     IF CEDING-PROPERTY-ONLY                                      ECSRIRTN
 12579         IF CLAS-I-CALC-TYPE (CLAS-INDEXL) NOT = '2'              ECSRIRTN
 12580             GO TO REINSURE-CK-LIFE-X                             ECSRIRTN
 12581         ELSE                                                     ECSRIRTN
 12582             NEXT SENTENCE                                        ECSRIRTN
 12583     ELSE                                                         ECSRIRTN
 12584         IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = '2'                  ECSRIRTN
 12585             GO TO REINSURE-CK-LIFE-X.                            ECSRIRTN
 12586                                                                  ECSRIRTN
 12587     IF CEDING-AD-D-ONLY                                          ECSRIRTN
 12588         IF CLAS-I-CALC-TYPE (CLAS-INDEXL) NOT = '4'              ECSRIRTN
 12589             GO TO REINSURE-CK-LIFE-X                             ECSRIRTN
 12590         ELSE                                                     ECSRIRTN
 12591             NEXT SENTENCE                                        ECSRIRTN
 12592     ELSE                                                         ECSRIRTN
 12593         IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = '4'                  ECSRIRTN
 12594             GO TO REINSURE-CK-LIFE-X.                            ECSRIRTN
 12595                                                                  ECSRIRTN
 12596     IF CEDING-SINGLE-PREM-ONLY                                   ECSRIRTN
 12597         IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'B'                  ECSRIRTN
 12598             GO TO REINSURE-CK-LIFE-X.                            ECSRIRTN
 12599                                                                  ECSRIRTN
 12600     IF CEDING-OUT-BALANCE-ONLY                                   ECSRIRTN
 12601         IF CLAS-I-CALC-TYPE (CLAS-INDEXL) NOT = 'B'              ECSRIRTN
 12602            GO TO REINSURE-CK-LIFE-X.                             ECSRIRTN
 12603                                                                  ECSRIRTN
 12604     IF CEDING-REDUCING-ONLY                                      ECSRIRTN
 12605         IF CLAS-I-RL-AH (CLAS-INDEXL) = 'L' OR 'P'               ECSRIRTN
 12606             GO TO REINSURE-CK-LIFE-X.                            ECSRIRTN
 12607                                                                  ECSRIRTN
 12608     IF CEDING-LEVEL-ONLY                                         ECSRIRTN
 12609         IF CLAS-I-RL-AH (CLAS-INDEXL) = 'R'                      ECSRIRTN
 12610            GO TO REINSURE-CK-LIFE-X.                             ECSRIRTN
 12611                                                                  ECSRIRTN
 12612     IF CEDING-GROUP-ONLY                                         ECSRIRTN
 12613         IF CR-IND-GRP NOT = '2'                                  ECSRIRTN
 12614             GO TO REINSURE-CK-LIFE-X.                            ECSRIRTN
 12615                                                                  ECSRIRTN
 12616     IF CEDING-GROUP-RED-LIFE-ONLY                                ECSRIRTN
 12617         IF (CR-IND-GRP = '1')  OR                                ECSRIRTN
 12618            (CLAS-I-RL-AH (CLAS-INDEXL) = 'L' OR 'P') OR          ECSRIRTN
 12619            (CR-AHTYP NOT = ZERO)                                 ECSRIRTN
 12620             GO TO REINSURE-CK-LIFE-X.                            ECSRIRTN
 12621                                                                  ECSRIRTN
 12622     IF CEDING-GROUP-REDUCING-ONLY                                ECSRIRTN
 12623         IF (CR-IND-GRP = '1')  OR                                ECSRIRTN
 12624            (CLAS-I-RL-AH (CLAS-INDEXL) = 'L' OR 'P')             ECSRIRTN
 12625             GO TO REINSURE-CK-LIFE-X.                            ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 249
* ECS010Z.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 12626                                                                  ECSRIRTN
 12627     IF CEDING-INDIVIDUAL-ONLY                                    ECSRIRTN
 12628         IF CR-IND-GRP NOT = '1'                                  ECSRIRTN
 12629             GO TO REINSURE-CK-LIFE-X.                            ECSRIRTN
 12630                                                                  ECSRIRTN
 12631     IF CEDING-JOINT-ONLY                                         ECSRIRTN
 12632         IF CLAS-I-JOINT (CLAS-INDEXL) NOT = 'J'                  ECSRIRTN
 12633             GO TO REINSURE-CK-LIFE-X.                            ECSRIRTN
 12634                                                                  ECSRIRTN
 12635     IF CEDING-SGL-PREM-REDUCING                                  ECSRIRTN
 12636        IF (CLAS-I-RL-AH (CLAS-INDEXL) = 'L' OR 'P')  OR          ECSRIRTN
 12637           CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'B'                   ECSRIRTN
 12638            GO TO REINSURE-CK-LIFE-X.                             ECSRIRTN
 12639                                                                  ECSRIRTN
 12640     IF CEDING-SGL-PREM-GROUP                                     ECSRIRTN
 12641         IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'B'  OR              ECSRIRTN
 12642            CR-IND-GRP = '1'                                      ECSRIRTN
 12643             GO TO REINSURE-CK-LIFE-X.                            ECSRIRTN
 12644                                                                  ECSRIRTN
 12645     IF CEDING-GROUP-LEVEL-ONLY                                   ECSRIRTN
 12646         IF CLAS-I-RL-AH (CLAS-INDEXL) = 'R'  OR                  ECSRIRTN
 12647            CR-IND-GRP = '1'                                      ECSRIRTN
 12648             GO TO REINSURE-CK-LIFE-X.                            ECSRIRTN
 12649                                                                  ECSRIRTN
 12650     IF CEDING-SGL-PREM-GRP-REDUCING                              ECSRIRTN
 12651         IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'B'  OR              ECSRIRTN
 12652            (CLAS-I-RL-AH (CLAS-INDEXL) = 'L' OR 'P')  OR         ECSRIRTN
 12653            CR-IND-GRP = '1'                                      ECSRIRTN
 12654             GO TO REINSURE-CK-LIFE-X.                            ECSRIRTN
 12655                                                                  ECSRIRTN
 12656     IF CEDING-SGL-PREM-GROUP-LEVEL                               ECSRIRTN
 12657         IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'B'  OR              ECSRIRTN
 12658            CLAS-I-RL-AH (CLAS-INDEXL) = 'R'  OR                  ECSRIRTN
 12659            CR-IND-GRP = '1'                                      ECSRIRTN
 12660             GO TO REINSURE-CK-LIFE-X.                            ECSRIRTN
 12661                                                                  ECSRIRTN
 12662     IF CEDING-SINGLE-POLICIES-ONLY                               ECSRIRTN
 12663         IF CLAS-I-JOINT (CLAS-INDEXL) = 'J'                      ECSRIRTN
 12664            GO TO REINSURE-CK-LIFE-X.                             ECSRIRTN
 12665                                                                  ECSRIRTN
 12666     IF DTE-CLIENT EQUAL 'NCL'                                    ECSRIRTN
 12667        MOVE 'Y'                 TO REIN-LF-FLG (SUB1).           ECSRIRTN
 12668                                                                  ECSRIRTN
 12669     IF CR-AGE LESS WT-LFAGE-LO                                   ECSRIRTN
 12670         GO TO REINSURE-CK-LIFE-X.                                ECSRIRTN
 12671                                                                  ECSRIRTN
 12672     IF CR-AGE GREATER WT-LFAGE-HI                                ECSRIRTN
 12673         GO TO REINSURE-CK-LIFE-X.                                ECSRIRTN
 12674                                                                  ECSRIRTN
 12675     IF CR-LF-TERM  NUMERIC                                       00002331
 12676        NEXT SENTENCE                                             00002332
 12677     ELSE                                                         00002333
 12678        MOVE ZEROS               TO CR-LF-TERM                    00002334
 12679     END-IF
 12680                                                                  00002335
 12681     IF CR-LF-TERM LESS WT-LFTRM-LO                               ECSRIRTN
 12682         GO TO REINSURE-CK-LIFE-X.                                ECSRIRTN
 12683                                                                  ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 250
* ECS010Z.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 12684     IF CR-LF-TERM GREATER WT-LFTRM-HI                            ECSRIRTN
 12685         GO TO REINSURE-CK-LIFE-X.                                ECSRIRTN
 12686                                                                  ECSRIRTN
 12687     MOVE 'Y' TO REIN-LF-FLG (SUB1).                              ECSRIRTN
 12688                                                                  ECSRIRTN
 12689     IF RS-LIFE-BEN NOT GREATER WT-LF-LIM-LO                      ECSRIRTN
 12690         GO TO REINSURE-CK-LIFE-X.                                ECSRIRTN
 12691                                                                  ECSRIRTN
 12692     IF RS-LIFE-BEN GREATER WT-LF-LIM-HI                          ECSRIRTN
 12693         GO TO REINSURE-CK-LIFE-X.                                ECSRIRTN
 12694                                                                  ECSRIRTN
 12695     MOVE 'X' TO REIN-LF-FLG (SUB1).                              ECSRIRTN
 12696                                                                  ECSRIRTN
 12697 REINSURE-CK-LIFE-X.                                              ECSRIRTN
 12698     EXIT.                                                        ECSRIRTN
 12699                                                                  ECSRIRTN
 12700 REINSURE-CK-AH.                                                  ECSRIRTN
 12701                                                                  ECSRIRTN
 12702     IF CR-AHTYP = ZERO                                           ECSRIRTN
 12703         GO TO REINSURE-CK-AH-X.                                  ECSRIRTN
 12704                                                                  ECSRIRTN
 12705     IF WT-AH-PCT = ZERO                                          ECSRIRTN
 12706         GO TO REINSURE-CK-AH-X.                                  ECSRIRTN
 12707                                                                  ECSRIRTN
 12708     IF DTE-CLIENT = 'CSO' OR 'CSI'                               ECSRIRTN
 12709         IF CLAS-I-REIN-YN (CLAS-INDEXA) = 'N'                    ECSRIRTN
 12710             GO TO REINSURE-CK-AH-X.                              ECSRIRTN
 12711                                                                  ECSRIRTN
 12712     MOVE WT-AH-BEN-CODE                TO REIN-BEN-CODE.         ECSRIRTN
 12713                                                                  ECSRIRTN
 12714     IF CEDING-UNEMPLOYMENT-ONLY                                  ECSRIRTN
 12715         IF CLAS-I-CALC-TYPE (CLAS-INDEXA) NOT = '3'              ECSRIRTN
 12716             GO TO REINSURE-CK-AH-X                               ECSRIRTN
 12717         ELSE                                                     ECSRIRTN
 12718             NEXT SENTENCE                                        ECSRIRTN
 12719     ELSE                                                         ECSRIRTN
 12720         IF CLAS-I-CALC-TYPE (CLAS-INDEXA) = '3'                  ECSRIRTN
 12721             GO TO REINSURE-CK-AH-X.                              ECSRIRTN
 12722                                                                  ECSRIRTN
 12723     IF CEDING-SINGLE-PREM-ONLY                                   ECSRIRTN
 12724         IF CLAS-I-CALC-TYPE (CLAS-INDEXA) = 'B'                  ECSRIRTN
 12725             GO TO REINSURE-CK-AH-X.                              ECSRIRTN
 12726                                                                  ECSRIRTN
 12727     IF CEDING-JOINT-ONLY                                         ECSRIRTN
 12728         IF CLAS-I-JOINT (CLAS-INDEXA) NOT = 'J'                  ECSRIRTN
 12729             GO TO REINSURE-CK-AH-X.                              ECSRIRTN
 12730                                                                  ECSRIRTN
 12731     IF CEDING-OUT-BALANCE-ONLY                                   ECSRIRTN
 12732         IF CLAS-I-CALC-TYPE (CLAS-INDEXA) NOT = 'B'              ECSRIRTN
 12733             GO TO REINSURE-CK-AH-X.                              ECSRIRTN
 12734                                                                  ECSRIRTN
 12735     IF CEDING-GROUP-ONLY                                         ECSRIRTN
 12736         IF CR-IND-GRP NOT = '2'                                  ECSRIRTN
 12737             GO TO REINSURE-CK-AH-X.                              ECSRIRTN
 12738                                                                  ECSRIRTN
 12739     IF CEDING-SGL-PREM-GROUP                                     ECSRIRTN
 12740         IF CLAS-I-CALC-TYPE (CLAS-INDEXA) = 'B'  OR              ECSRIRTN
 12741            CR-IND-GRP = '1'                                      ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 251
* ECS010Z.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 12742             GO TO REINSURE-CK-AH-X.                              ECSRIRTN
 12743                                                                  ECSRIRTN
 12744     IF CEDING-INDIVIDUAL-ONLY                                    ECSRIRTN
 12745         IF CR-IND-GRP NOT = '1'                                  ECSRIRTN
 12746             GO TO REINSURE-CK-AH-X.                              ECSRIRTN
 12747                                                                  ECSRIRTN
 12748     IF CEDING-SINGLE-POLICIES-ONLY                               ECSRIRTN
 12749         IF CLAS-I-JOINT (CLAS-INDEXA) = 'J'                      ECSRIRTN
 12750            GO TO REINSURE-CK-AH-X.                               ECSRIRTN
 12751                                                                  ECSRIRTN
 12752     IF CEDING-7-DAY-RETRO                                        ECSRIRTN
 12753         IF CLAS-I-AB3 (CLAS-INDEXA) NOT = (' 7R'  AND  '07R')    ECSRIRTN
 12754            GO TO REINSURE-CK-AH-X.                               ECSRIRTN
 12755                                                                  ECSRIRTN
 12756     IF CEDING-14-DAY-RETRO                                       ECSRIRTN
 12757         IF CLAS-I-AB3 (CLAS-INDEXA) NOT = '14R'                  ECSRIRTN
 12758             GO TO REINSURE-CK-AH-X.                              ECSRIRTN
 12759                                                                  ECSRIRTN
 12760     IF DTE-CLIENT EQUAL 'NCL'                                    ECSRIRTN
 12761        MOVE 'Y'                 TO REIN-AH-FLG (SUB1).           ECSRIRTN
 12762                                                                  ECSRIRTN
 12763     IF CR-AGE LESS WT-AHAGE-LO                                   ECSRIRTN
 12764         GO TO REINSURE-CK-AH-X.                                  ECSRIRTN
 12765                                                                  ECSRIRTN
 12766     IF CR-AGE GREATER WT-AHAGE-HI                                ECSRIRTN
 12767         GO TO REINSURE-CK-AH-X.                                  ECSRIRTN
 12768                                                                  ECSRIRTN
 12769     IF CR-AH-TERM  NUMERIC                                       00002331
 12770        NEXT SENTENCE                                             00002332
 12771     ELSE                                                         00002333
 12772        MOVE ZEROS               TO CR-AH-TERM                    00002334
 12773     END-IF
 12774                                                                  00002335
 12775     IF CR-AH-TERM LESS WT-AHTRM-LO                               ECSRIRTN
 12776         GO TO REINSURE-CK-AH-X.                                  ECSRIRTN
 12777                                                                  ECSRIRTN
 12778     IF CR-AH-TERM GREATER WT-AHTRM-HI                            ECSRIRTN
 12779         GO TO REINSURE-CK-AH-X.                                  ECSRIRTN
 12780                                                                  ECSRIRTN
 12781     MOVE 'Y' TO REIN-AH-FLG (SUB1).                              ECSRIRTN
 12782                                                                  ECSRIRTN
 12783     IF WT-AHBEN-LIM-LO = ZERO                                    ECSRIRTN
 12784         AND WT-AHBEN-LIM-HI = ZERO                               ECSRIRTN
 12785             MOVE +9999999.99 TO WT-AHBEN-LIM-LO                  ECSRIRTN
 12786                                 WT-AHBEN-LIM-HI.                 ECSRIRTN
 12787                                                                  ECSRIRTN
 12788     IF WT-AHMOA-LIM-LO = ZERO                                    ECSRIRTN
 12789         AND WT-AHMOA-LIM-HI = ZERO                               ECSRIRTN
 12790             MOVE +9999999.99 TO WT-AHMOA-LIM-LO                  ECSRIRTN
 12791                                 WT-AHMOA-LIM-HI.                 ECSRIRTN
 12792                                                                  ECSRIRTN
 12793     COMPUTE RW-AHLIM-LO = CR-AH-TERM * WT-AHMOA-LIM-LO.          ECSRIRTN
 12794     COMPUTE RW-AHLIM-HI = CR-AH-TERM * WT-AHMOA-LIM-HI.          ECSRIRTN
 12795                                                                  ECSRIRTN
 12796     IF RW-AHLIM-LO GREATER WT-AHBEN-LIM-LO                       ECSRIRTN
 12797         MOVE WT-AHBEN-LIM-LO TO RW-AHLIM-LO.                     ECSRIRTN
 12798                                                                  ECSRIRTN
 12799     IF RW-AHLIM-HI GREATER WT-AHBEN-LIM-HI                       ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 252
* ECS010Z.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 12800         MOVE WT-AHBEN-LIM-HI TO RW-AHLIM-HI.                     ECSRIRTN
 12801                                                                  ECSRIRTN
 12802     MOVE RW-AHLIM-LO TO RWF-AH-LIMIT.                            ECSRIRTN
 12803                                                                  ECSRIRTN
 12804     COMPUTE RW-AHWRK = RS-AH-BEN * CR-AH-TERM.                   ECSRIRTN
 12805                                                                  ECSRIRTN
 12806     IF RW-AHWRK NOT GREATER RW-AHLIM-LO                          ECSRIRTN
 12807         GO TO REINSURE-CK-AH-X.                                  ECSRIRTN
 12808                                                                  ECSRIRTN
 12809     IF RW-AHWRK GREATER RW-AHLIM-HI                              ECSRIRTN
 12810         GO TO REINSURE-CK-AH-X.                                  ECSRIRTN
 12811                                                                  ECSRIRTN
 12812     MOVE 'X' TO REIN-AH-FLG (SUB1).                              ECSRIRTN
 12813                                                                  ECSRIRTN
 12814 REINSURE-CK-AH-X.                                                ECSRIRTN
 12815     EXIT.                                                        ECSRIRTN
 12816                                                                  ECSRIRTN
 12817 REIN-CHECK-INTERACT-E.                                           ECSRIRTN
 12818                                                                  ECSRIRTN
 12819     IF RS-LIFE-BEN = ZERO  OR                                    ECSRIRTN
 12820        RS-AH-BEN = ZERO                                          ECSRIRTN
 12821         GO TO REIN-INTERACT-CHECK-X.                             ECSRIRTN
 12822                                                                  ECSRIRTN
 12823     IF REIN-LF-FLG (SUB1) NOT = 'X'  AND                         ECSRIRTN
 12824        REIN-AH-FLG (SUB1) NOT = 'X'                              ECSRIRTN
 12825         GO TO REIN-INTERACT-CHECK-X.                             ECSRIRTN
 12826                                                                  ECSRIRTN
 12827     MOVE 'X'                    TO REIN-LF-FLG (SUB1)            ECSRIRTN
 12828                                    REIN-AH-FLG (SUB1).           ECSRIRTN
 12829                                                                  ECSRIRTN
 12830     IF WT-AHBEN-LO = ZERO                                        ECSRIRTN
 12831         AND WT-AHBEN-HI = ZERO                                   ECSRIRTN
 12832             MOVE +9999999.99    TO  WT-AHBEN-LO                  ECSRIRTN
 12833                                     WT-AHBEN-HI.                 ECSRIRTN
 12834     IF WT-AHMOA-LO = ZERO                                        ECSRIRTN
 12835         AND WT-AHMOA-HI = ZERO                                   ECSRIRTN
 12836             MOVE +9999999.99    TO  WT-AHMOA-LO                  ECSRIRTN
 12837                                     WT-AHMOA-HI.                 ECSRIRTN
 12838                                                                  ECSRIRTN
 12839     COMPUTE RW-AHLIM-LO = CR-AH-TERM * WT-AHMOA-LO.              ECSRIRTN
 12840     COMPUTE RW-AHLIM-HI = CR-AH-TERM * WT-AHMOA-HI.              ECSRIRTN
 12841                                                                  ECSRIRTN
 12842     IF RW-AHLIM-LO GREATER WT-AHBEN-LO                           ECSRIRTN
 12843         MOVE WT-AHBEN-LO        TO  RW-AHLIM-LO.                 ECSRIRTN
 12844                                                                  ECSRIRTN
 12845     IF RW-AHLIM-HI GREATER WT-AHBEN-HI                           ECSRIRTN
 12846         MOVE WT-AHBEN-HI        TO  RW-AHLIM-HI.                 ECSRIRTN
 12847                                                                  ECSRIRTN
 12848     COMPUTE RW-AHWRK = RS-AH-BEN * CR-AH-TERM.                   ECSRIRTN
 12849                                                                  ECSRIRTN
 12850     IF RW-AHWRK GREATER RW-AHLIM-HI                              ECSRIRTN
 12851         MOVE RW-AHLIM-HI        TO  RW-AHWRK.                    ECSRIRTN
 12852                                                                  ECSRIRTN
 12853     IF RW-AHWRK GREATER RW-AHLIM-LO                              ECSRIRTN
 12854         COMPUTE RATE-WORK-A ROUNDED = (RW-AHWRK - RW-AHLIM-LO)   ECSRIRTN
 12855                                       / RW-AHWRK                 ECSRIRTN
 12856       ELSE                                                       ECSRIRTN
 12857         MOVE ZERO               TO RATE-WORK-A.                  ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 253
* ECS010Z.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 12858                                                                  ECSRIRTN
 12859     IF RS-LIFE-BEN GREATER WT-LF-LO                              ECSRIRTN
 12860         COMPUTE RATE-WORK-L ROUNDED = (RS-LIFE-BEN - WT-LF-LO)   ECSRIRTN
 12861                                       / RS-LIFE-BEN              ECSRIRTN
 12862       ELSE                                                       ECSRIRTN
 12863         MOVE ZERO               TO RATE-WORK-L.                  ECSRIRTN
 12864                                                                  ECSRIRTN
 12865     IF (RS-LIFE-BEN GREATER WT-LF-LO) AND                        ECSRIRTN
 12866        (RW-AHWRK NOT GREATER RW-AHLIM-LO)                        ECSRIRTN
 12867          MOVE 'E'               TO REIN-AH-FLG (SUB1)            ECSRIRTN
 12868          COMPUTE RWF-AHAMT ROUNDED = (RW-AHWRK * RATE-WORK-L)    ECSRIRTN
 12869                                      / CR-AH-TERM.               ECSRIRTN
 12870                                                                  ECSRIRTN
 12871     IF (RW-AHWRK GREATER RW-AHLIM-LO) AND                        ECSRIRTN
 12872        (RS-LIFE-BEN NOT GREATER WT-LF-LO)                        ECSRIRTN
 12873          MOVE 'E'               TO REIN-LF-FLG (SUB1)            ECSRIRTN
 12874          IF (RW-AHWRK - RW-AHLIM-LO) NOT GREATER RS-LIFE-BEN     ECSRIRTN
 12875               COMPUTE RWF-LFAMT = RW-AHWRK - RW-AHLIM-LO         ECSRIRTN
 12876            ELSE                                                  ECSRIRTN
 12877                MOVE RS-LIFE-BEN TO RWF-LFAMT.                    ECSRIRTN
 12878                                                                  ECSRIRTN
 12879     IF (RW-AHWRK GREATER RW-AHLIM-LO) AND                        ECSRIRTN
 12880        (RS-LIFE-BEN GREATER WT-LF-LO)                            ECSRIRTN
 12881        IF RATE-WORK-L GREATER RATE-WORK-A                        ECSRIRTN
 12882          MOVE 'E'               TO REIN-AH-FLG (SUB1)            ECSRIRTN
 12883          COMPUTE RWF-AHAMT ROUNDED = (RW-AHWRK * RATE-WORK-L)    ECSRIRTN
 12884                                      / CR-AH-TERM                ECSRIRTN
 12885         ELSE                                                     ECSRIRTN
 12886          MOVE 'E'               TO REIN-LF-FLG (SUB1)            ECSRIRTN
 12887          IF (RW-AHWRK - RW-AHLIM-LO) NOT GREATER RS-LIFE-BEN     ECSRIRTN
 12888               COMPUTE RWF-LFAMT = RW-AHWRK - RW-AHLIM-LO         ECSRIRTN
 12889            ELSE                                                  ECSRIRTN
 12890                MOVE RS-LIFE-BEN TO RWF-LFAMT.                    ECSRIRTN
 12891                                                                  ECSRIRTN
 12892 REIN-INTERACT-CHECK-X.                                           ECSRIRTN
 12893     EXIT.                                                        ECSRIRTN
 12894                                                                  ECSRIRTN
 12895                                                                  ECSRIRTN
 12896 REIN-CALC-LIFE.                                                  ECSRIRTN
 12897                                                                  ECSRIRTN
 12898     IF RS-LIFE-BEN NOT GREATER WT-LF-HI                          ECSRIRTN
 12899         MOVE RS-LIFE-BEN TO RWF-LFAMT                            ECSRIRTN
 12900     ELSE                                                         ECSRIRTN
 12901         MOVE WT-LF-HI TO RWF-LFAMT.                              ECSRIRTN
 12902                                                                  ECSRIRTN
 12903     IF RS-LIFE-BEN LESS WT-LF-LO                                 ECSRIRTN
 12904         MOVE +0 TO RWF-LFAMT                                     ECSRIRTN
 12905     ELSE                                                         ECSRIRTN
 12906         IF WT-REMAINING NOT = 'L'                                ECSRIRTN
 12907           IF RS-LIFE-BEN LESS THAN ZERO                          ECSRIRTN
 12908               COMPUTE RWF-LFAMT ROUNDED = WT-LF-PCT * RS-LIFE-BENECSRIRTN
 12909           ELSE                                                   ECSRIRTN
 12910               COMPUTE RWF-LFAMT ROUNDED = WT-LF-PCT *            ECSRIRTN
 12911                                          (RWF-LFAMT - WT-LF-LO). ECSRIRTN
 12912                                                                  ECSRIRTN
 12913 REIN-LF-SKIP-LIMIT.                                              ECSRIRTN
 12914                                                                  ECSRIRTN
 12915     MOVE +0 TO RW-LFPRM  RW-LFPRMC.                              ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 254
* ECS010Z.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 12916                                                                  ECSRIRTN
 12917     IF WT-REMAINING = 'I'                                        ECSRIRTN
 12918         GO TO REIN-CALC-LF-RISK-PREM.                            ECSRIRTN
 12919                                                                  ECSRIRTN
 12920     IF WT-REMAINING = 'L'                                        ECSRIRTN
 12921         COMPUTE RWF-LFPRM ROUNDED = RS-LIFE-PREM * WT-LF-PCT     ECSRIRTN
 12922         GO TO REIN-CALC-LIFE-X.                                  ECSRIRTN
 12923                                                                  ECSRIRTN
 12924     IF RS-LIFE-BEN NOT = ZERO                                    ECSRIRTN
 12925         COMPUTE RW-LFPRM ROUNDED = (RS-LIFE-PREM *               ECSRIRTN
 12926                   RWF-LFAMT) / RS-LIFE-BEN                       ECSRIRTN
 12927         COMPUTE RW-LFPRMC ROUNDED = (RS-LP-CALC *                ECSRIRTN
 12928                   RWF-LFAMT) / RS-LIFE-BEN                       ECSRIRTN
 12929     ELSE                                                         ECSRIRTN
 12930         IF WT-LF-LIM-LO = ZERO                                   ECSRIRTN
 12931             COMPUTE RW-LFPRM ROUNDED = RS-LIFE-PREM * WT-LF-PCT  ECSRIRTN
 12932             COMPUTE RW-LFPRMC ROUNDED = RS-LP-CALC * WT-LF-PCT.  ECSRIRTN
 12933                                                                  ECSRIRTN
 12934     IF ((WT-LF-QC = '1' OR '3') OR                                  CL**8
 12935         (WT-LF-QC = '2' AND                                         CL**8
 12936          PGM-SUB = +50  AND                                         CL**8
 12937          DTE-CLIENT = 'LAP'))                                       CL**8
 12938          MOVE RW-LFPRM TO RWF-LFPRM                                 CL**8
 12939     ELSE                                                         ECSRIRTN
 12940         MOVE RW-LFPRMC TO RWF-LFPRM.                             ECSRIRTN
 12941                                                                  ECSRIRTN
 12942     IF WT-REMAINING = 'Y' OR 'Z' OR 'X' OR 'N'                   ECSRIRTN
 12943         COMPUTE RS-R-LB = RS-R-LB - RWF-LFAMT                    ECSRIRTN
 12944         COMPUTE RS-R-LP = RS-R-LP - RW-LFPRM                     ECSRIRTN
 12945         COMPUTE RS-R-LPC = RS-R-LPC - RW-LFPRMC.                 ECSRIRTN
 12946                                                                  ECSRIRTN
 12947     GO TO REIN-CALC-LIFE-X.                                      ECSRIRTN
 12948                                                                  ECSRIRTN
 12949 REIN-CALC-LF-RISK-PREM.                                          ECSRIRTN
 12950                                                                  ECSRIRTN
 12951     IF RWF-LFAMT NOT GREATER THAN +0                             ECSRIRTN
 12952         MOVE ZEROS                 TO RWF-LFPRM                  ECSRIRTN
 12953         GO TO REIN-CALC-LIFE-X.                                  ECSRIRTN
 12954                                                                  ECSRIRTN
 12955     MOVE RWF-LFAMT                 TO REIN-RISK-AMOUNT.          ECSRIRTN
 12956     COMPUTE REIN-MONTH-REDUCE = RS-LIFE-BEN / CR-LF-TERM.        ECSRIRTN
 12957     MOVE +0                        TO REIN-WORKA                 ECSRIRTN
 12958                                       RW-LFPRM.                  ECSRIRTN
 12959                                                                  ECSRIRTN
 12960 REIN-LF-RISK-PREM-LOOP.                                          ECSRIRTN
 12961                                                                  ECSRIRTN
 12962     COMPUTE RW-LFPRM = RW-LFPRM +                                ECSRIRTN
 12963                ((REIN-RISK-AMOUNT / +1000) * CR-LF-NSP-PRM-RATE).ECSRIRTN
 12964                                                                  ECSRIRTN
 12965     IF CLAS-I-RL-AH (CLAS-INDEXL) NOT = 'L'                      ECSRIRTN
 12966        SUBTRACT REIN-MONTH-REDUCE FROM REIN-RISK-AMOUNT.         ECSRIRTN
 12967                                                                  ECSRIRTN
 12968     IF REIN-WORKA = REIN-EARN-LF-TERM  OR                        ECSRIRTN
 12969        REIN-RISK-AMOUNT LESS THAN +0                             ECSRIRTN
 12970         MOVE RW-LFPRM              TO RWF-LFPRM                  ECSRIRTN
 12971     ELSE                                                         ECSRIRTN
 12972         ADD +1 TO REIN-WORKA                                     ECSRIRTN
 12973         GO TO REIN-LF-RISK-PREM-LOOP.                            ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 255
* ECS010Z.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 12974                                                                  ECSRIRTN
 12975                                                                  ECSRIRTN
 12976 REIN-CALC-LIFE-X.                                                ECSRIRTN
 12977     EXIT.                                                        ECSRIRTN
 12978                                                                  ECSRIRTN
 12979 REIN-CALC-AH.                                                    ECSRIRTN
 12980                                                                  ECSRIRTN
 12981     IF WT-AHBEN-LO = ZERO                                        ECSRIRTN
 12982         AND WT-AHBEN-HI = ZERO                                   ECSRIRTN
 12983             MOVE +9999999.99 TO WT-AHBEN-LO                      ECSRIRTN
 12984                                 WT-AHBEN-HI.                     ECSRIRTN
 12985                                                                  ECSRIRTN
 12986     IF WT-AHMOA-LO = ZERO                                        ECSRIRTN
 12987         AND WT-AHMOA-HI = ZERO                                   ECSRIRTN
 12988             MOVE +9999999.99 TO WT-AHMOA-LO                      ECSRIRTN
 12989                                 WT-AHMOA-HI.                     ECSRIRTN
 12990                                                                  ECSRIRTN
 12991     COMPUTE RW-AHLIM-LO = CR-AH-TERM * WT-AHMOA-LO.              ECSRIRTN
 12992     COMPUTE RW-AHLIM-HI = CR-AH-TERM * WT-AHMOA-HI.              ECSRIRTN
 12993                                                                  ECSRIRTN
 12994     IF RW-AHLIM-LO GREATER WT-AHBEN-LO                           ECSRIRTN
 12995         MOVE WT-AHBEN-LO TO RW-AHLIM-LO.                         ECSRIRTN
 12996                                                                  ECSRIRTN
 12997     IF RW-AHLIM-HI GREATER WT-AHBEN-HI                           ECSRIRTN
 12998         MOVE WT-AHBEN-HI TO RW-AHLIM-HI.                         ECSRIRTN
 12999                                                                  ECSRIRTN
 13000     IF RW-AHWRK GREATER RW-AHLIM-HI                              ECSRIRTN
 13001         MOVE RW-AHLIM-HI TO RW-AHWRK.                            ECSRIRTN
 13002                                                                  ECSRIRTN
 13003     IF RW-AHWRK LESS RW-AHLIM-LO                                 ECSRIRTN
 13004         MOVE +0 TO RWF-AHAMT                                     ECSRIRTN
 13005     ELSE                                                         ECSRIRTN
 13006         IF WT-REMAINING = 'L'                                    ECSRIRTN
 13007             COMPUTE RWF-AHAMT ROUNDED = RW-AHWRK / CR-AH-TERM    ECSRIRTN
 13008         ELSE                                                     ECSRIRTN
 13009             COMPUTE RWF-AHAMT ROUNDED =                          ECSRIRTN
 13010             ((RW-AHWRK - RW-AHLIM-LO) / CR-AH-TERM) * WT-AH-PCT. ECSRIRTN
 13011                                                                  ECSRIRTN
 13012 REIN-AH-SKIP-LIMIT.                                              ECSRIRTN
 13013                                                                  ECSRIRTN
 13014     IF WT-REMAINING = 'I'                                        ECSRIRTN
 13015         GO TO REIN-CALC-AH-RISK-PREM.                            ECSRIRTN
 13016                                                                  ECSRIRTN
 13017     IF WT-REMAINING = 'L'                                        ECSRIRTN
 13018         COMPUTE RWF-AHPRM ROUNDED = RS-AH-PREM * WT-AH-PCT       ECSRIRTN
 13019         GO TO REIN-CALC-AH-X.                                    ECSRIRTN
 13020                                                                  ECSRIRTN
 13021     IF RS-AH-BEN NOT = ZERO                                      ECSRIRTN
 13022         COMPUTE RW-AHPRM ROUNDED = (RS-AH-PREM *                 ECSRIRTN
 13023                   RWF-AHAMT) / RS-AH-BEN                         ECSRIRTN
 13024         COMPUTE RW-AHPRMC ROUNDED = (RS-AP-CALC *                ECSRIRTN
 13025                   RWF-AHAMT) / RS-AH-BEN                         ECSRIRTN
 13026     ELSE                                                         ECSRIRTN
 13027         IF RW-AHLIM-LO = ZERO                                    ECSRIRTN
 13028             COMPUTE RW-AHPRM ROUNDED = RS-AH-PREM * WT-AH-PCT    ECSRIRTN
 13029             COMPUTE RW-AHPRMC ROUNDED = RS-AP-CALC * WT-AH-PCT.  ECSRIRTN
 13030                                                                  ECSRIRTN
 13031     IF ((WT-AH-QC = '1' OR '3') OR                                  CL**8
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 256
* ECS010Z.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 13032         (WT-AH-QC = '2' AND                                         CL**8
 13033          PGM-SUB = +50  AND                                         CL**8
 13034          DTE-CLIENT = 'LAP'))                                       CL**8
 13035         MOVE RW-AHPRM TO RWF-AHPRM                               ECSRIRTN
 13036     ELSE                                                         ECSRIRTN
 13037         MOVE RW-AHPRMC TO RWF-AHPRM.                             ECSRIRTN
 13038                                                                  ECSRIRTN
 13039     IF RE-NSP-ST-CD-AH = SPACES OR ZERO                          ECSRIRTN
 13040         IF (WT-REMAINING = 'Y' OR 'Z') AND (WT-AH-QC = '1')      ECSRIRTN
 13041            AND (RWF-AHAMT = RS-R-AB) AND (RWF-AHAMT NOT = +0)    ECSRIRTN
 13042                MOVE 'Y' TO RWF-REM-AH-100.                       ECSRIRTN
 13043                                                                  ECSRIRTN
 13044     IF WT-REMAINING = 'Y' OR 'Z' OR 'X' OR 'N'                   ECSRIRTN
 13045         COMPUTE RS-R-AB = RS-R-AB - RWF-AHAMT                    ECSRIRTN
 13046         COMPUTE RS-R-AP = RS-R-AP - RW-AHPRM                     ECSRIRTN
 13047         COMPUTE RS-R-APC = RS-R-APC - RW-AHPRMC.                 ECSRIRTN
 13048                                                                  ECSRIRTN
 13049     GO TO REIN-CALC-AH-X.                                        ECSRIRTN
 13050                                                                  ECSRIRTN
 13051 REIN-CALC-AH-RISK-PREM.                                          ECSRIRTN
 13052                                                                  ECSRIRTN
 13053     IF RWF-AHAMT NOT GREATER THAN +0                             ECSRIRTN
 13054         MOVE ZEROS                 TO RWF-AHPRM                  ECSRIRTN
 13055         GO TO REIN-CALC-AH-X.                                    ECSRIRTN
 13056                                                                  ECSRIRTN
 13057     COMPUTE REIN-RISK-AMOUNT = RWF-AHAMT * CR-AH-TERM.           ECSRIRTN
 13058     MOVE RS-AH-BEN              TO REIN-MONTH-REDUCE.            ECSRIRTN
 13059     MOVE +0                     TO REIN-WORKA                    ECSRIRTN
 13060                                    RW-AHPRM.                     ECSRIRTN
 13061                                                                  ECSRIRTN
 13062 REIN-AH-RISK-PREM-LOOP.                                          ECSRIRTN
 13063                                                                  ECSRIRTN
 13064     COMPUTE RW-AHPRM = RW-AHPRM +                                ECSRIRTN
 13065                ((REIN-RISK-AMOUNT / +1000) * CR-AH-NSP-PRM-RATE).ECSRIRTN
 13066                                                                  ECSRIRTN
 13067     SUBTRACT REIN-MONTH-REDUCE FROM REIN-RISK-AMOUNT.            ECSRIRTN
 13068                                                                  ECSRIRTN
 13069     IF REIN-WORKA = REIN-EARN-AH-TERM  OR                        ECSRIRTN
 13070        REIN-RISK-AMOUNT LESS THAN +0                             ECSRIRTN
 13071         MOVE RW-AHPRM          TO RWF-AHPRM                      ECSRIRTN
 13072     ELSE                                                         ECSRIRTN
 13073         ADD +1 TO REIN-WORKA                                     ECSRIRTN
 13074         GO TO REIN-AH-RISK-PREM-LOOP.                            ECSRIRTN
 13075                                                                  ECSRIRTN
 13076                                                                  ECSRIRTN
 13077 REIN-CALC-AH-X.                                                  ECSRIRTN
 13078     EXIT.                                                        ECSRIRTN
 13079                                                                  ECSRIRTN
 13080 REINSURE-CALC-REMAINDER.                                         ECSRIRTN
 13081                                                                  ECSRIRTN
 13082     COMPUTE RWF-LFAMT = CR-LFAMT + CR-LFAMT-ALT.                 ECSRIRTN
 13083     COMPUTE RWF-LFPRM = CR-LFPRM + CR-LFPRM-ALT.                 ECSRIRTN
 13084     MOVE CR-AHAMT TO RWF-AHAMT.                                  ECSRIRTN
 13085     MOVE CR-AHPRM TO RWF-AHPRM.                                  ECSRIRTN
 13086                                                                  ECSRIRTN
 13087     PERFORM REINSURE-SUBTRACT THRU REINSURE-SUBTRACT-X           ECSRIRTN
 13088         VARYING SUB2 FROM +1 BY +1 UNTIL SUB2 = SUB1.            ECSRIRTN
 13089                                                                  ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 257
* ECS010Z.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 13090     IF RWF-LFAMT NOT = ZEROS OR                                  ECSRIRTN
 13091        RWF-LFPRM NOT = ZEROS                                     ECSRIRTN
 13092           MOVE 'X' TO REIN-LF-FLG (SUB1).                        ECSRIRTN
 13093                                                                  ECSRIRTN
 13094     IF RWF-AHAMT NOT = ZEROS OR                                  ECSRIRTN
 13095        RWF-AHPRM NOT = ZEROS                                     ECSRIRTN
 13096           MOVE 'X' TO REIN-AH-FLG (SUB1).                        ECSRIRTN
 13097                                                                  ECSRIRTN
 13098 REINSURE-CALC-X.                                                 ECSRIRTN
 13099                                                                  ECSRIRTN
 13100     IF REIN-LF-AH-FLGS (SUB1) NOT = SPACES                       ECSRIRTN
 13101         MOVE 'X' TO REIN-BUS-FLAG.                               ECSRIRTN
 13102                                                                  ECSRIRTN
 13103     MOVE RWF-FIELDS TO REIN-WORK-FLDS (SUB1).                    ECSRIRTN
 13104                                                                  ECSRIRTN
 13105 REINSURE-SUBTRACT.                                               ECSRIRTN
 13106                                                                  ECSRIRTN
 13107     SUBTRACT REIN-LFAMT (SUB2) FROM RWF-LFAMT.                   ECSRIRTN
 13108     SUBTRACT REIN-LFPRM (SUB2) FROM RWF-LFPRM.                   ECSRIRTN
 13109     SUBTRACT REIN-AHAMT (SUB2) FROM RWF-AHAMT.                   ECSRIRTN
 13110     SUBTRACT REIN-AHPRM (SUB2) FROM RWF-AHPRM.                   ECSRIRTN
 13111                                                                  ECSRIRTN
 13112 REINSURE-SUBTRACT-X.                                             ECSRIRTN
 13113     EXIT.                                                        ECSRIRTN
 13114                                                                  ECSRIRTN
 13115 REINSURE-CALC-CANCEL.                                            ECSRIRTN
 13116                                                                  ECSRIRTN
 13117     MOVE REIN-WORK-FLDS (SUB1) TO RWF-FIELDS.                    ECSRIRTN
 13118     MOVE RE-COMP-INFO (SUB1) TO WT-COMP-INFO.                    ECSRIRTN
 13119                                                                  ECSRIRTN
 13120     IF SUB1 = RE-100-COMP                                        ECSRIRTN
 13121         GO TO REINSURE-REMAINDER-CANCEL.                         ECSRIRTN
 13122                                                                  ECSRIRTN
 13123     IF REIN-LF-FLG (SUB1) NOT = 'X'                              ECSRIRTN
 13124         GO TO REINSURE-CALC-CANCEL-AH.                           ECSRIRTN
 13125                                                                  ECSRIRTN
 13126     IF RWF-LF-RUNOFF-SW = 'N'                                    ECSRIRTN
 13127         IF CR-LF-CANC-DT NOT LESS THAN RWF-EP-STOP-DATE             CL**3
 13128             GO TO REINSURE-CALC-CANCEL-AH.                       ECSRIRTN
 13129                                                                  ECSRIRTN
 13130     IF WT-REMAINING = 'I'                                        ECSRIRTN
 13131         GO TO REINSURE-CALC-LF-RISK-CANCEL.                      ECSRIRTN
 13132                                                                  ECSRIRTN
 13133     IF WT-REMAINING = 'L'                                        ECSRIRTN
 13134         COMPUTE RWF-LFRFND ROUNDED = CR-LFRFND * WT-LF-PCT       ECSRIRTN
 13135         GO TO REINSURE-CALC-CANCEL-AH.                           ECSRIRTN
 13136                                                                  ECSRIRTN
 13137     IF CR-LFPRM = ZERO                                           ECSRIRTN
 13138        MOVE ZERO                TO REIN-FACTOR
 13139     ELSE                                                         ECSRIRTN
 13140        IF DTE-CLIENT = 'GIC'  AND
 13141           CLAS-I-BAL (CLAS-INDEXL) = 'B'
 13142           MOVE +1.0             TO REIN-FACTOR
 13143        ELSE
 13144           IF DTE-CLIENT = 'DCC'
 13145              COMPUTE REIN-FACTOR = CR-LFRFND /
 13146                 (CR-LFPRM + CR-LFPRM-ALT)
 13147           ELSE
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 258
* ECS010Z.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 13148              COMPUTE REIN-FACTOR ROUNDED =  CR-LFRFND-CALC /
 13149                 (CR-LFPRM + CR-LFPRM-ALT)
 13150            END-IF
 13151         END-IF
 13152     END-IF
 13153                                                                  ECSRIRTN
 13154     IF CR-LFAMT NOT = ZERO                                       ECSRIRTN
 13155         IF DTE-CLIENT = 'GTL'  OR  'UAL'  OR  'NCL'  OR  'CVL'   ECSRIRTN
 13156             IF WT-LF-QC = ('1' OR '4')                           ECSRIRTN
 13157                 COMPUTE RWF-LFRFND ROUNDED =  ((CR-LFRFND *      ECSRIRTN
 13158                         RWF-LFAMT) / (CR-LFAMT + CR-LFAMT-ALT))  ECSRIRTN
 13159             ELSE                                                 ECSRIRTN
 13160                 COMPUTE RWF-LFRFND =                             ECSRIRTN
 13161                            REIN-FACTOR * REIN-CALCED-LIFE        ECSRIRTN
 13162                 COMPUTE RWF-LFRFND ROUNDED =  ((RWF-LFRFND *     ECSRIRTN
 13163                         RWF-LFAMT) / (CR-LFAMT + CR-LFAMT-ALT))  ECSRIRTN
 13164         ELSE                                                     ECSRIRTN
 13165             IF WT-LF-QC = ('1' OR '4')                           ECSRIRTN
 13166                 compute rein-factor rounded =
 13167                    RWF-LFAMT / (CR-LFAMT + CR-LFAMT-ALT)
 13168                 COMPUTE RWF-LFRFND ROUNDED =  CR-LFRFND *
 13169                    rein-factor
 13170             ELSE                                                 ECSRIRTN
 13171*                COMPUTE RWF-LFRFND = REIN-FACTOR
 13172*                   * REIN-CALCED-LIFE *
 13173*                   (RWF-LFAMT / (CR-LFAMT + CR-LFAMT-ALT)).
 13174                 COMPUTE RWF-LFRFND =                             ECSRIRTN
 13175                            REIN-FACTOR * REIN-CALCED-LIFE        ECSRIRTN
 13176                 COMPUTE RWF-LFRFND ROUNDED =  (RWF-LFRFND *
 13177                        RWF-LFAMT) / (CR-LFAMT + CR-LFAMT-ALT).
 13178                                                                  ECSRIRTN
 13179     IF CR-LFAMT = ZERO                                           ECSRIRTN
 13180         IF WT-LF-LIM-LO = ZERO                                   ECSRIRTN
 13181             IF WT-LF-QC = ('1' OR '4')                           ECSRIRTN
 13182                 COMPUTE RWF-LFRFND ROUNDED =                     ECSRIRTN
 13183                       CR-LFRFND * WT-LF-PCT                      ECSRIRTN
 13184             ELSE                                                 ECSRIRTN
 13185                 COMPUTE RWF-LFRFND =                             ECSRIRTN
 13186                            REIN-FACTOR * REIN-CALCED-LIFE        ECSRIRTN
 13187                 COMPUTE RWF-LFRFND ROUNDED =                     ECSRIRTN
 13188                       RWF-LFRFND * WT-LF-PCT.                    ECSRIRTN
 13189                                                                  ECSRIRTN
 13190     GO TO REINSURE-CALC-CANCEL-AH.                               ECSRIRTN
 13191                                                                  ECSRIRTN
 13192                                                                  ECSRIRTN
 13193 REINSURE-CALC-LF-RISK-CANCEL.                                    ECSRIRTN
 13194                                                                  ECSRIRTN
 13195     IF RWF-LFAMT NOT GREATER THAN +0  OR                         ECSRIRTN
 13196       (CR-LF-CANC-DT = ZEROS)                                       CL*10
 13197         MOVE ZERO                    TO RWF-LFRFND               ECSRIRTN
 13198         GO TO REINSURE-CALC-CANCEL-AH.                           ECSRIRTN
 13199                                                                  ECSRIRTN
 13200     IF REIN-RT-SW NOT = 'X'                                      ECSRIRTN
 13201       IF VOIDING-LF-CANCEL                                       ECSRIRTN
 13202           COMPUTE RWF-LFRFND = RWF-LFRFND * (-1)                 ECSRIRTN
 13203           GO TO REINSURE-CALC-CANCEL-AH                          ECSRIRTN
 13204       ELSE                                                       ECSRIRTN
 13205           IF ADDITIONAL-LF-CANCEL                                ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 259
* ECS010Z.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 13206               GO TO REINSURE-CALC-CANCEL-AH.                     ECSRIRTN
 13207                                                                  ECSRIRTN
 13208     IF FLAT-CANCEL-LF                                            ECSRIRTN
 13209         MOVE RWF-LFPRM               TO RWF-LFRFND               ECSRIRTN
 13210         GO TO REINSURE-CALC-CANCEL-AH.                           ECSRIRTN
 13211                                                                  ECSRIRTN
 13212     IF REIN-EARN-LF-TERM = REIN-LCNC-EARN-TERM                   ECSRIRTN
 13213         MOVE ZERO                    TO RWF-LFRFND               ECSRIRTN
 13214         GO TO REINSURE-CALC-CANCEL-AH.                           ECSRIRTN
 13215                                                                  ECSRIRTN
 13216     MOVE RWF-LFAMT                   TO REIN-RISK-AMOUNT.        ECSRIRTN
 13217     COMPUTE REIN-MONTH-REDUCE = RS-LIFE-BEN / CR-LF-TERM.        ECSRIRTN
 13218     MOVE +0                          TO REIN-WORKA               ECSRIRTN
 13219                                         RW-LFRFND.               ECSRIRTN
 13220                                                                  ECSRIRTN
 13221 REINSURE-LF-RISK-CANCEL-LOOP.                                    ECSRIRTN
 13222                                                                  ECSRIRTN
 13223     COMPUTE RW-LFRFND = RW-LFRFND +                              ECSRIRTN
 13224                ((REIN-RISK-AMOUNT / +1000) * CR-LF-NSP-PRM-RATE).ECSRIRTN
 13225                                                                  ECSRIRTN
 13226     IF CLAS-I-RL-AH (CLAS-INDEXL) NOT = 'L'                      ECSRIRTN
 13227        SUBTRACT REIN-MONTH-REDUCE FROM REIN-RISK-AMOUNT.         ECSRIRTN
 13228                                                                  ECSRIRTN
 13229     IF REIN-WORKA = REIN-LCNC-EARN-TERM  OR                      ECSRIRTN
 13230        REIN-RISK-AMOUNT LESS THAN +0                             ECSRIRTN
 13231         COMPUTE RWF-LFRFND = RWF-LFPRM - RW-LFRFND               ECSRIRTN
 13232     ELSE                                                         ECSRIRTN
 13233         ADD +1 TO REIN-WORKA                                     ECSRIRTN
 13234         GO TO REINSURE-LF-RISK-CANCEL-LOOP.                      ECSRIRTN
 13235                                                                  ECSRIRTN
 13236                                                                  ECSRIRTN
 13237 REINSURE-CALC-CANCEL-AH.                                         ECSRIRTN
 13238                                                                  ECSRIRTN
 13239     IF REIN-AH-FLG (SUB1) NOT = 'X'                              ECSRIRTN
 13240         GO TO REINSURE-CALC-CANCEL-SKIP.                         ECSRIRTN
 13241                                                                  ECSRIRTN
 13242     IF RWF-AH-RUNOFF-SW = 'N'                                    ECSRIRTN
 13243         IF CR-AH-CANC-DT NOT LESS THAN RWF-EP-STOP-DATE             CL**4
 13244             GO TO REINSURE-CALC-CANCEL-SKIP.                     ECSRIRTN
 13245                                                                  ECSRIRTN
 13246     IF RWF-REM-AH-100 = 'Y'                                      ECSRIRTN
 13247         MOVE CR-AHRFND TO RWF-AHRFND                             ECSRIRTN
 13248         PERFORM REINSURE-SUB-REM-CANCEL THRU                     ECSRIRTN
 13249             REINSURE-SUB-REM-CANCEL-X                            ECSRIRTN
 13250                 VARYING SUB2 FROM +1 BY +1 UNTIL SUB2 = SUB1     ECSRIRTN
 13251         GO TO REINSURE-CALC-CANCEL-SKIP.                         ECSRIRTN
 13252                                                                  ECSRIRTN
 13253     IF WT-REMAINING = 'I'                                        ECSRIRTN
 13254         GO TO REINSURE-CALC-AH-RISK-CANCEL.                      ECSRIRTN
 13255                                                                  ECSRIRTN
 13256     IF WT-REMAINING = 'L'                                        ECSRIRTN
 13257         COMPUTE RWF-AHRFND ROUNDED = CR-AHRFND * WT-AH-PCT       ECSRIRTN
 13258         GO TO REINSURE-CALC-CANCEL-SKIP.                         ECSRIRTN
 13259                                                                  ECSRIRTN
 13260     IF CR-AHPRM = ZERO                                           ECSRIRTN
 13261        MOVE ZERO                TO REIN-FACTOR
 13262     ELSE
 13263        IF DTE-CLIENT = 'GIC'  AND
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 260
* ECS010Z.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 13264           CLAS-I-BAL (CLAS-INDEXA) = 'B'
 13265            MOVE +1.0            TO REIN-FACTOR
 13266        ELSE
 13267           IF DTE-CLIENT = 'DCC'
 13268              COMPUTE REIN-FACTOR =
 13269                 CR-AHRFND / CR-AHPRM
 13270           ELSE
 13271              COMPUTE REIN-FACTOR ROUNDED =
 13272                                CR-AHRFND-CALC / CR-AHPRM
 13273           END-IF
 13274        END-IF
 13275     END-IF
 13276
 13277     IF CR-AHAMT NOT = ZERO
 13278        IF (DTE-CLIENT = 'DCC')
 13279           AND (CLAS-I-REFUND-METHOD (CLAS-INDEXA) = 'D')
 13280           MOVE CR-AH-RFND-CLP   TO RWF-AHRFND
 13281        ELSE
 13282           IF WT-AH-QC = ('1' OR '4')
 13283              compute rein-factor rounded = rwf-ahamt / cr-ahamt
 13284              compute rwf-ahrfnd rounded =
 13285                 cr-ahrfnd * rein-factor
 13286           ELSE
 13287              COMPUTE RWF-AHRFND = REIN-FACTOR * REIN-CALCED-AH
 13288              COMPUTE RWF-AHRFND ROUNDED = (RWF-AHRFND *
 13289                       RWF-AHAMT) / CR-AHAMT
 13290           END-IF
 13291        END-IF
 13292     ELSE
 13293        IF RWF-AH-LIMIT = ZERO
 13294           IF WT-AH-QC = ('1' OR '4')
 13295              COMPUTE RWF-AHRFND ROUNDED =
 13296                       CR-AHRFND * WT-AH-PCT
 13297           ELSE
 13298              COMPUTE RWF-AHRFND =
 13299                            REIN-FACTOR * REIN-CALCED-AH
 13300              COMPUTE RWF-AHRFND ROUNDED =
 13301                       RWF-AHRFND * WT-AH-PCT
 13302           END-IF
 13303        END-IF
 13304     END-IF
 13305
 13306     GO TO REINSURE-CALC-CANCEL-SKIP.                             ECSRIRTN
 13307                                                                  ECSRIRTN
 13308                                                                  ECSRIRTN
 13309 REINSURE-CALC-AH-RISK-CANCEL.                                    ECSRIRTN
 13310                                                                  ECSRIRTN
 13311     IF RWF-AHAMT NOT GREATER THAN +0  OR                         ECSRIRTN
 13312       (CR-AH-CANC-DT = ZEROS)                                       CL*10
 13313         MOVE ZERO                    TO RWF-AHRFND               ECSRIRTN
 13314         GO TO REINSURE-CALC-CANCEL-SKIP.                         ECSRIRTN
 13315                                                                  ECSRIRTN
 13316     IF REIN-RT-SW NOT = 'X'                                      ECSRIRTN
 13317       IF VOIDING-AH-CANCEL                                       ECSRIRTN
 13318           COMPUTE RWF-AHRFND = RWF-AHRFND * (-1)                 ECSRIRTN
 13319           GO TO REINSURE-CALC-CANCEL-SKIP                        ECSRIRTN
 13320       ELSE                                                       ECSRIRTN
 13321           IF ADDITIONAL-AH-CANCEL                                ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 261
* ECS010Z.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 13322               GO TO REINSURE-CALC-CANCEL-SKIP.                   ECSRIRTN
 13323                                                                  ECSRIRTN
 13324     IF FLAT-CANCEL-AH                                            ECSRIRTN
 13325         MOVE RWF-AHPRM               TO RWF-AHRFND               ECSRIRTN
 13326         GO TO REINSURE-CALC-CANCEL-SKIP.                         ECSRIRTN
 13327                                                                  ECSRIRTN
 13328     IF REIN-EARN-AH-TERM = REIN-ACNC-EARN-TERM                   ECSRIRTN
 13329         MOVE ZERO                    TO RWF-AHRFND               ECSRIRTN
 13330         GO TO REINSURE-CALC-CANCEL-SKIP.                         ECSRIRTN
 13331                                                                  ECSRIRTN
 13332     MOVE RS-AH-BEN              TO REIN-MONTH-REDUCE.            ECSRIRTN
 13333     COMPUTE REIN-RISK-AMOUNT = RWF-AHAMT * CR-AH-TERM.           ECSRIRTN
 13334     MOVE +0                     TO REIN-WORKA                    ECSRIRTN
 13335                                    RW-AHRFND.                    ECSRIRTN
 13336                                                                  ECSRIRTN
 13337 REINSURE-AH-RISK-CANCEL-LOOP.                                    ECSRIRTN
 13338                                                                  ECSRIRTN
 13339     COMPUTE RW-AHRFND = RW-AHRFND +                              ECSRIRTN
 13340                ((REIN-RISK-AMOUNT / +1000) * CR-AH-NSP-PRM-RATE).ECSRIRTN
 13341                                                                  ECSRIRTN
 13342     SUBTRACT REIN-MONTH-REDUCE FROM REIN-RISK-AMOUNT.            ECSRIRTN
 13343                                                                  ECSRIRTN
 13344     IF REIN-WORKA = REIN-ACNC-EARN-TERM  OR                      ECSRIRTN
 13345        REIN-RISK-AMOUNT LESS THAN +0                             ECSRIRTN
 13346         COMPUTE RWF-AHRFND = RWF-AHPRM - RW-AHRFND               ECSRIRTN
 13347     ELSE                                                         ECSRIRTN
 13348         ADD +1 TO REIN-WORKA                                     ECSRIRTN
 13349         GO TO REINSURE-AH-RISK-CANCEL-LOOP.                      ECSRIRTN
 13350                                                                  ECSRIRTN
 13351                                                                  ECSRIRTN
 13352 REINSURE-CALC-CANCEL-SKIP.                                       ECSRIRTN
 13353                                                                  ECSRIRTN
 13354     IF RWF-LFRFND NOT = ZEROS                                    ECSRIRTN
 13355         MOVE 'X' TO REIN-LF-FLG (SUB1).                          ECSRIRTN
 13356                                                                  ECSRIRTN
 13357     IF RWF-AHRFND NOT = ZEROS                                    ECSRIRTN
 13358         MOVE 'X' TO REIN-AH-FLG (SUB1).                          ECSRIRTN
 13359                                                                  ECSRIRTN
 13360     GO TO REINSURE-CALC-CANCEL-X.                                ECSRIRTN
 13361                                                                  ECSRIRTN
 13362 REINSURE-REMAINDER-CANCEL.                                       ECSRIRTN
 13363                                                                  ECSRIRTN
 13364     MOVE CR-LFRFND TO RWF-LFRFND.                                ECSRIRTN
 13365     MOVE CR-AHRFND TO RWF-AHRFND.                                ECSRIRTN
 13366                                                                  ECSRIRTN
 13367     PERFORM REINSURE-SUBTRACT-CANCEL THRU                        ECSRIRTN
 13368         REINSURE-SUBTRACT-CANCEL-X                               ECSRIRTN
 13369             VARYING SUB2 FROM +1 BY +1 UNTIL SUB2 = SUB1.        ECSRIRTN
 13370                                                                  ECSRIRTN
 13371     IF RWF-LFRFND NOT = ZEROS                                    ECSRIRTN
 13372         MOVE 'X' TO REIN-LF-FLG (SUB1).                          ECSRIRTN
 13373                                                                  ECSRIRTN
 13374     IF RWF-AHRFND NOT = ZEROS                                    ECSRIRTN
 13375         MOVE 'X' TO REIN-AH-FLG (SUB1).                          ECSRIRTN
 13376                                                                  ECSRIRTN
 13377 REINSURE-CALC-CANCEL-X.                                          ECSRIRTN
 13378                                                                  ECSRIRTN
 13379     IF REIN-LF-AH-FLGS (SUB1) NOT = SPACES                       ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 262
* ECS010Z.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 13380         MOVE 'X' TO REIN-BUS-FLAG.                               ECSRIRTN
 13381                                                                  ECSRIRTN
 13382     MOVE RWF-FIELDS TO REIN-WORK-FLDS (SUB1).                    ECSRIRTN
 13383                                                                  ECSRIRTN
 13384 REINSURE-SUBTRACT-CANCEL.                                        ECSRIRTN
 13385                                                                  ECSRIRTN
 13386     SUBTRACT REIN-LFRFND (SUB2) FROM RWF-LFRFND.                 ECSRIRTN
 13387     SUBTRACT REIN-AHRFND (SUB2) FROM RWF-AHRFND.                 ECSRIRTN
 13388                                                                  ECSRIRTN
 13389 REINSURE-SUBTRACT-CANCEL-X.                                      ECSRIRTN
 13390     EXIT.                                                        ECSRIRTN
 13391                                                                  ECSRIRTN
 13392 REINSURE-SUB-REM-CANCEL.                                         ECSRIRTN
 13393                                                                  ECSRIRTN
 13394     IF REIN-REM-SW (SUB2) = 'Y' OR 'Z' OR 'X' OR 'N'             ECSRIRTN
 13395         SUBTRACT REIN-AHRFND (SUB2) FROM RWF-AHRFND.             ECSRIRTN
 13396                                                                  ECSRIRTN
 13397 REINSURE-SUB-REM-CANCEL-X.                                       ECSRIRTN
 13398     EXIT.                                                        ECSRIRTN
 13399                                                                  ECSRIRTN
 13400 REINSURE-CALC-CLAIM.                                             ECSRIRTN
 13401                                                                  ECSRIRTN
 13402     MOVE REIN-WORK-FLDS (SUB1) TO RWF-FIELDS.                    ECSRIRTN
 13403     MOVE RE-COMP-INFO (SUB1) TO WT-COMP-INFO.                    ECSRIRTN
 13404                                                                  ECSRIRTN
 13405     IF SUB1 = RE-100-COMP                                        ECSRIRTN
 13406         GO TO REINSURE-REMAINDER-CLAIM.                          ECSRIRTN
 13407                                                                  ECSRIRTN
 13408     PERFORM REIN-FIND-CO-LOOP THRU FIND-REI-CO-EXIT              ECSRIRTN
 13409        VARYING CO-SUB FROM 1 BY 1 UNTIL                          ECSRIRTN
 13410          (RCT-REIN-CO (CO-SUB) = REIN-COMP (SUB1))  OR           ECSRIRTN
 13411          (CO-SUB GREATER REIN-CO-TABLE-ENT-CNT)     OR           ECSRIRTN
 13412          (RCT-REIN-CO (CO-SUB) = SPACES).                        ECSRIRTN
 13413                                                                  ECSRIRTN
 13414     IF (CO-SUB GREATER REIN-CO-TABLE-ENT-CNT)  OR                ECSRIRTN
 13415        (RCT-REIN-CO (CO-SUB) = SPACES)                           ECSRIRTN
 13416          MOVE ZERO TO CO-SUB.                                    ECSRIRTN
 13417                                                                  ECSRIRTN
 13418     MOVE ZEROS                TO RWF-LFCLML                      ECSRIRTN
 13419                                  RWF-AHCLML.                     ECSRIRTN
 13420                                                                  ECSRIRTN
 13421     IF REIN-LF-FLG (SUB1) NOT = 'X'                              ECSRIRTN
 13422         GO TO REINSURE-CALC-CLAIM-AH.                            ECSRIRTN
 13423                                                                  ECSRIRTN
 13424     IF RW-LFCLMWK = ZEROS                                        ECSRIRTN
 13425         GO TO REINSURE-CALC-CLAIM-AH.                            ECSRIRTN
 13426                                                                  ECSRIRTN
 13427     IF CO-SUB NOT = ZERO                                         ECSRIRTN
 13428         IF RCT-CLM-CUTOFF-DT (CO-SUB) NOT = ZERO                 ECSRIRTN
 13429             IF CR-DTH-DT LESS RCT-CLM-CUTOFF-DT (CO-SUB)         ECSRIRTN
 13430                 GO TO REINSURE-CALC-CLAIM-AH.                    ECSRIRTN
 13431                                                                  ECSRIRTN
 13432     IF RWF-LF-RUNOFF-SW = 'N'                                    ECSRIRTN
 13433         IF CR-DTH-DT NOT LESS THAN RWF-EP-STOP-DATE                 CL**6
 13434                 GO TO REINSURE-CALC-CLAIM-AH.                    ECSRIRTN
 13435                                                                  ECSRIRTN
 13436     IF WT-REMAINING = 'I'                                        ECSRIRTN
 13437         GO TO REINSURE-CALC-LF-RISK-CLAIM.                       ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 263
* ECS010Z.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 13438                                                                  ECSRIRTN
 13439     IF WT-REMAINING = 'L'                                        ECSRIRTN
 13440         IF REIN-RT-SW = 'X'                                      ECSRIRTN
 13441             IF RW-LFCLMWK GREATER WT-LF-HI                       ECSRIRTN
 13442                 MOVE WT-LF-HI TO RWF-LFCLM                       ECSRIRTN
 13443             ELSE                                                 ECSRIRTN
 13444                 MOVE RW-LFCLMWK TO RWF-LFCLM                     ECSRIRTN
 13445         ELSE                                                     ECSRIRTN
 13446             IF (RW-LFCLMWK + RWF-LFCLM) GREATER WT-LF-HI         ECSRIRTN
 13447                 COMPUTE RWF-LFCLML = WT-LF-HI - RWF-LFCLM        ECSRIRTN
 13448                 MOVE WT-LF-HI TO RWF-LFCLM                       ECSRIRTN
 13449             ELSE                                                 ECSRIRTN
 13450                 MOVE RW-LFCLMWK TO RWF-LFCLML                    ECSRIRTN
 13451                 ADD RWF-LFCLML TO RWF-LFCLM.                     ECSRIRTN
 13452                                                                  ECSRIRTN
 13453     IF WT-REMAINING = 'L'                                        ECSRIRTN
 13454         GO TO REINSURE-CALC-CLAIM-AH.                            ECSRIRTN
 13455                                                                  ECSRIRTN
 13456     IF CR-LFAMT NOT = ZERO                                       ECSRIRTN
 13457         IF DTE-CLIENT = 'GTL'  OR  'UAL'  OR  'NCL'  OR  'CVL'   ECSRIRTN
 13458            OR 'DCC'
 13459             COMPUTE RWF-LFCLML ROUNDED =  ((RW-LFCLMWK *         ECSRIRTN
 13460                         RWF-LFAMT) / (CR-LFAMT + CR-LFAMT-ALT))  ECSRIRTN
 13461         ELSE                                                     ECSRIRTN
 13462             COMPUTE RWF-LFCLML ROUNDED =  RW-LFCLMWK *           ECSRIRTN
 13463                        (RWF-LFAMT / (CR-LFAMT + CR-LFAMT-ALT)).  ECSRIRTN
 13464                                                                  ECSRIRTN
 13465     IF CR-LFAMT = ZERO                                           ECSRIRTN
 13466         IF WT-LF-LIM-LO = ZERO                                   ECSRIRTN
 13467             COMPUTE RWF-LFCLML ROUNDED =                         ECSRIRTN
 13468                       RW-LFCLMWK * WT-LF-PCT.                    ECSRIRTN
 13469                                                                  ECSRIRTN
 13470     IF CO-SUB NOT = ZERO                                         ECSRIRTN
 13471         IF RCT-LF-CLM-PCT (CO-SUB) NOT = ZERO                    ECSRIRTN
 13472             COMPUTE RWF-LFCLML ROUNDED =                         ECSRIRTN
 13473                          RW-LFCLMWK * RCT-LF-CLM-PCT (CO-SUB).   ECSRIRTN
 13474                                                                  ECSRIRTN
 13475     IF CO-SUB NOT = ZERO                                         ECSRIRTN
 13476         IF RCT-LF-CLM-MAX (CO-SUB) NOT = ZERO                    ECSRIRTN
 13477             IF REIN-RT-SW = 'X'                                  ECSRIRTN
 13478               IF RWF-LFCLML GREATER RCT-LF-CLM-MAX (CO-SUB)      ECSRIRTN
 13479                     MOVE RCT-LF-CLM-MAX (CO-SUB) TO RWF-LFCLM    ECSRIRTN
 13480                      GO TO REINSURE-CALC-CLAIM-AH                ECSRIRTN
 13481                  ELSE                                            ECSRIRTN
 13482                     MOVE RWF-LFCLML TO RWF-LFCLM                 ECSRIRTN
 13483                      GO TO REINSURE-CALC-CLAIM-AH                ECSRIRTN
 13484              ELSE                                                ECSRIRTN
 13485                 IF (RWF-LFCLML + RWF-LFCLM) GREATER              ECSRIRTN
 13486                                           RCT-LF-CLM-MAX (CO-SUB)ECSRIRTN
 13487                     COMPUTE RWF-LFCLML =                         ECSRIRTN
 13488                               RCT-LF-CLM-MAX (CO-SUB) - RWF-LFCLMECSRIRTN
 13489                     MOVE RCT-LF-CLM-MAX (CO-SUB) TO RWF-LFCLM    ECSRIRTN
 13490                      GO TO REINSURE-CALC-CLAIM-AH.               ECSRIRTN
 13491                                                                  ECSRIRTN
 13492     ADD RWF-LFCLML TO RWF-LFCLM.                                 ECSRIRTN
 13493                                                                  ECSRIRTN
 13494     GO TO REINSURE-CALC-CLAIM-AH.                                ECSRIRTN
 13495                                                                  ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 264
* ECS010Z.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 13496                                                                  ECSRIRTN
 13497 REINSURE-CALC-LF-RISK-CLAIM.                                     ECSRIRTN
 13498                                                                  ECSRIRTN
 13499     IF RWF-LFAMT NOT GREATER THAN +0                             ECSRIRTN
 13500         GO TO REINSURE-CALC-CLAIM-AH.                            ECSRIRTN
 13501                                                                  ECSRIRTN
 13502     IF CLAS-I-RL-AH (CLAS-INDEXL) = 'L'                          ECSRIRTN
 13503         MOVE RWF-LFAMT                   TO REIN-RISK-AMOUNT     ECSRIRTN
 13504     ELSE                                                         ECSRIRTN
 13505         COMPUTE REIN-RISK-AMOUNT = RWF-LFAMT -                   ECSRIRTN
 13506                ((RS-LIFE-BEN / CR-LF-TERM) * REIN-LF-CLM-MONTHS).ECSRIRTN
 13507                                                                  ECSRIRTN
 13508     IF REIN-RISK-AMOUNT NOT GREATER THAN +0                      ECSRIRTN
 13509         GO TO REINSURE-CALC-CLAIM-AH.                            ECSRIRTN
 13510                                                                  ECSRIRTN
 13511     IF REIN-RT-SW = 'X'                                          ECSRIRTN
 13512         IF RW-LFCLMWK GREATER THAN REIN-RISK-AMOUNT              ECSRIRTN
 13513             MOVE REIN-RISK-AMOUNT        TO RWF-LFCLM            ECSRIRTN
 13514         ELSE                                                     ECSRIRTN
 13515             MOVE RW-LFCLMWK              TO RWF-LFCLM            ECSRIRTN
 13516     ELSE                                                         ECSRIRTN
 13517         IF (RW-LFCLMWK + RWF-LFCLM) GREATER THAN REIN-RISK-AMOUNTECSRIRTN
 13518             COMPUTE RWF-LFCLML = REIN-RISK-AMOUNT - RWF-LFCLM    ECSRIRTN
 13519             MOVE REIN-RISK-AMOUNT        TO RWF-LFCLM            ECSRIRTN
 13520         ELSE                                                     ECSRIRTN
 13521             MOVE RW-LFCLMWK              TO RWF-LFCLML           ECSRIRTN
 13522             ADD RW-LFCLMWK TO RWF-LFCLM.                         ECSRIRTN
 13523                                                                  ECSRIRTN
 13524                                                                  ECSRIRTN
 13525 REINSURE-CALC-CLAIM-AH.                                          ECSRIRTN
 13526                                                                  ECSRIRTN
 13527     IF REIN-AH-FLG (SUB1) NOT = 'X'                              ECSRIRTN
 13528         GO TO REINSURE-CALC-CLAIM-X.                             ECSRIRTN
 13529                                                                  ECSRIRTN
 13530     IF RW-AHCLMWK = ZEROS                                        ECSRIRTN
 13531         GO TO REINSURE-CALC-CLAIM-SKIP.                          ECSRIRTN
 13532                                                                  ECSRIRTN
 13533     IF REIN-RT-SW NOT = 'X'                                      ECSRIRTN
 13534         GO TO REINSURE-CALC-AH-DETAIL.                           ECSRIRTN
 13535                                                                  ECSRIRTN
 13536     MOVE CR-DISAB-INCURRED-DETAIL    TO RW-AH-INCURRED-DETAIL.   ECSRIRTN
 13537     MOVE ZEROS                       TO RW-AHCLMWK.              ECSRIRTN
 13538                                                                  ECSRIRTN
 13539     PERFORM CHECK-MULTIPLE-DISABILITIES THRU CHECK-DISABS-EXIT   ECSRIRTN
 13540             VARYING                                              ECSRIRTN
 13541         INC-SUB FROM +1 BY +1                                    ECSRIRTN
 13542             UNTIL                                                ECSRIRTN
 13543         INC-SUB GREATER THAN +5.                                 ECSRIRTN
 13544                                                                  ECSRIRTN
 13545     IF RW-AHCLMWK = ZEROS                                        ECSRIRTN
 13546         GO TO REINSURE-CALC-CLAIM-SKIP                           ECSRIRTN
 13547     ELSE                                                         ECSRIRTN
 13548         GO TO REINSURE-CALC-AH-CONTINUED.                        ECSRIRTN
 13549                                                                  ECSRIRTN
 13550 CHECK-MULTIPLE-DISABILITIES.                                     ECSRIRTN
 13551                                                                  ECSRIRTN
 13552     IF RW-AH-INCUR-DT (INC-SUB) = ZEROS                          ECSRIRTN
 13553         GO TO CHECK-DISABS-EXIT.                                 ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 265
* ECS010Z.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 13554                                                                  ECSRIRTN
 13555     IF CO-SUB NOT = ZERO                                         ECSRIRTN
 13556       IF RCT-CLM-CUTOFF-DT (CO-SUB) NOT = ZERO                   ECSRIRTN
 13557           IF RW-AH-INCUR-DT (INC-SUB) LESS THAN                  ECSRIRTN
 13558                       RCT-CLM-CUTOFF-DT (CO-SUB)                    CL**5
 13559               MOVE ZEROS             TO RW-AH-CLM-AMT (INC-SUB)  ECSRIRTN
 13560                                         RW-AH-CLM-EXP (INC-SUB)  ECSRIRTN
 13561               GO TO CHECK-DISABS-EXIT.                           ECSRIRTN
 13562                                                                  ECSRIRTN
 13563     IF RWF-AH-RUNOFF-SW = 'N'                                    ECSRIRTN
 13564       IF RW-AH-INCUR-DT (INC-SUB) NOT LESS THAN RWF-EP-STOP-DATE ECSRIRTN
 13565           MOVE ZEROS                 TO RW-AH-CLM-AMT (INC-SUB)  ECSRIRTN
 13566                                         RW-AH-CLM-EXP (INC-SUB)  ECSRIRTN
 13567           GO TO CHECK-DISABS-EXIT.                               ECSRIRTN
 13568                                                                  ECSRIRTN
 13569     IF WT-REMAINING NOT = 'I'                                    ECSRIRTN
 13570         COMPUTE RW-AHCLMWK = RW-AHCLMWK                          ECSRIRTN
 13571                             + RW-AH-CLM-AMT (INC-SUB)            ECSRIRTN
 13572                             + RW-AH-CLM-EXP (INC-SUB)            ECSRIRTN
 13573         GO TO CHECK-DISABS-EXIT.                                 ECSRIRTN
 13574                                                                  ECSRIRTN
 13575     IF RWF-AHAMT NOT GREATER THAN +0                             ECSRIRTN
 13576         GO TO CHECK-DISABS-EXIT.                                 ECSRIRTN
 13577                                                                  ECSRIRTN
 13578     IF INC-SUB = +1                                              ECSRIRTN
 13579         MOVE REIN-AH-CLM-MTH-1       TO REIN-AH-CLM-MONTHS.      ECSRIRTN
 13580     IF INC-SUB = +2                                              ECSRIRTN
 13581         MOVE REIN-AH-CLM-MTH-2       TO REIN-AH-CLM-MONTHS.      ECSRIRTN
 13582     IF INC-SUB = +3                                              ECSRIRTN
 13583         MOVE REIN-AH-CLM-MTH-3       TO REIN-AH-CLM-MONTHS.      ECSRIRTN
 13584     IF INC-SUB = +4                                              ECSRIRTN
 13585         MOVE REIN-AH-CLM-MTH-4       TO REIN-AH-CLM-MONTHS.      ECSRIRTN
 13586     IF INC-SUB = +5                                              ECSRIRTN
 13587         MOVE REIN-AH-CLM-MTH-5       TO REIN-AH-CLM-MONTHS.      ECSRIRTN
 13588                                                                  ECSRIRTN
 13589     COMPUTE REIN-RISK-AMOUNT = (RWF-AHAMT * CR-AH-TERM) -        ECSRIRTN
 13590                                (RS-AH-BEN * REIN-AH-CLM-MONTHS). ECSRIRTN
 13591                                                                  ECSRIRTN
 13592     IF REIN-RISK-AMOUNT NOT GREATER THAN +0                      ECSRIRTN
 13593         GO TO CHECK-DISABS-EXIT.                                 ECSRIRTN
 13594                                                                  ECSRIRTN
 13595     IF (RW-AH-CLM-AMT (INC-SUB) + RW-AH-CLM-EXP (INC-SUB))       ECSRIRTN
 13596              GREATER THAN REIN-RISK-AMOUNT                       ECSRIRTN
 13597         COMPUTE RW-AHCLMWK = RW-AHCLMWK + REIN-RISK-AMOUNT       ECSRIRTN
 13598     ELSE                                                         ECSRIRTN
 13599         COMPUTE RW-AHCLMWK = RW-AHCLMWK                          ECSRIRTN
 13600                             + RW-AH-CLM-AMT (INC-SUB)            ECSRIRTN
 13601                             + RW-AH-CLM-EXP (INC-SUB).           ECSRIRTN
 13602                                                                  ECSRIRTN
 13603 CHECK-DISABS-EXIT.                                               ECSRIRTN
 13604      EXIT.                                                       ECSRIRTN
 13605                                                                  ECSRIRTN
 13606 REINSURE-CALC-AH-DETAIL.                                         ECSRIRTN
 13607                                                                  ECSRIRTN
 13608     IF RW-AHCLMWK = ZEROS                                        ECSRIRTN
 13609         GO TO REINSURE-CALC-CLAIM-SKIP.                          ECSRIRTN
 13610                                                                  ECSRIRTN
 13611     IF CO-SUB NOT = ZERO                                         ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 266
* ECS010Z.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 13612         IF RCT-CLM-CUTOFF-DT (CO-SUB) NOT = ZERO                 ECSRIRTN
 13613             IF CR-DIS-DT LESS RCT-CLM-CUTOFF-DT (CO-SUB)            CL*11
 13614                 GO TO REINSURE-CALC-CLAIM-SKIP.                  ECSRIRTN
 13615                                                                  ECSRIRTN
 13616     IF RWF-AH-RUNOFF-SW = 'N'                                    ECSRIRTN
 13617         IF CR-DIS-DT NOT LESS THAN RWF-EP-STOP-DATE                 CL**6
 13618             GO TO REINSURE-CALC-CLAIM-SKIP.                      ECSRIRTN
 13619                                                                  ECSRIRTN
 13620 REINSURE-CALC-AH-CONTINUED.                                      ECSRIRTN
 13621                                                                  ECSRIRTN
 13622     IF RWF-REM-AH-100 = 'Y'                                      ECSRIRTN
 13623         MOVE RW-AHCLMWK TO RWF-AHCLML                            ECSRIRTN
 13624         PERFORM REINSURE-SUB-REM-CLAIM THRU                      ECSRIRTN
 13625             REINSURE-SUB-REM-CLAIM-X                             ECSRIRTN
 13626                 VARYING SUB2 FROM +1 BY +1 UNTIL SUB2 = SUB1     ECSRIRTN
 13627         ADD RWF-AHCLML TO RWF-AHCLM                              ECSRIRTN
 13628         GO TO REINSURE-CALC-CLAIM-SKIP.                          ECSRIRTN
 13629                                                                  ECSRIRTN
 13630     IF WT-REMAINING = 'I'                                        ECSRIRTN
 13631         GO TO REINSURE-CALC-AH-RISK-CLAIM.                       ECSRIRTN
 13632                                                                  ECSRIRTN
 13633     IF WT-REMAINING = 'L'                                        ECSRIRTN
 13634         IF REIN-RT-SW = 'X'                                      ECSRIRTN
 13635             IF RW-AHCLMWK GREATER WT-AHBEN-HI                    ECSRIRTN
 13636                 MOVE WT-AHBEN-HI TO RWF-AHCLM                    ECSRIRTN
 13637             ELSE                                                 ECSRIRTN
 13638                 MOVE RW-AHCLMWK TO RWF-AHCLM                     ECSRIRTN
 13639         ELSE                                                     ECSRIRTN
 13640             IF (RW-AHCLMWK + RWF-AHCLM) GREATER WT-AHBEN-HI      ECSRIRTN
 13641                 COMPUTE RWF-AHCLML = WT-AHBEN-HI - RWF-AHCLM     ECSRIRTN
 13642                 MOVE WT-AHBEN-HI TO RWF-AHCLM                    ECSRIRTN
 13643             ELSE                                                 ECSRIRTN
 13644                 MOVE RW-AHCLMWK TO RWF-AHCLML                    ECSRIRTN
 13645                 ADD RWF-AHCLML TO RWF-AHCLM.                     ECSRIRTN
 13646                                                                  ECSRIRTN
 13647     IF WT-REMAINING = 'L'                                        ECSRIRTN
 13648         GO TO REINSURE-CALC-CLAIM-SKIP.                          ECSRIRTN
 13649                                                                  ECSRIRTN
 13650     IF CR-AHAMT NOT = ZERO                                       ECSRIRTN
 13651         COMPUTE RWF-AHCLML ROUNDED = (RW-AHCLMWK *               ECSRIRTN
 13652                            RWF-AHAMT) / CR-AHAMT                 ECSRIRTN
 13653     ELSE                                                         ECSRIRTN
 13654         IF RWF-AH-LIMIT = ZERO                                   ECSRIRTN
 13655             COMPUTE RWF-AHCLML ROUNDED =                         ECSRIRTN
 13656                       RW-AHCLMWK * WT-AH-PCT.                    ECSRIRTN
 13657                                                                  ECSRIRTN
 13658     IF CO-SUB NOT = ZERO                                         ECSRIRTN
 13659         IF RCT-AH-CLM-PCT (CO-SUB) NOT = ZERO                    ECSRIRTN
 13660             COMPUTE RWF-AHCLML ROUNDED =                         ECSRIRTN
 13661                           RW-AHCLMWK * RCT-AH-CLM-PCT (CO-SUB).  ECSRIRTN
 13662                                                                  ECSRIRTN
 13663     IF CO-SUB NOT = ZERO                                         ECSRIRTN
 13664         IF RCT-AH-CLM-MAX (CO-SUB) NOT = ZERO                    ECSRIRTN
 13665             IF REIN-RT-SW = 'X'                                  ECSRIRTN
 13666               IF RWF-AHCLML GREATER RCT-AH-CLM-MAX (CO-SUB)      ECSRIRTN
 13667                     MOVE RCT-AH-CLM-MAX (CO-SUB) TO RWF-AHCLM    ECSRIRTN
 13668                      GO TO REINSURE-CALC-CLAIM-SKIP              ECSRIRTN
 13669                  ELSE                                            ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 267
* ECS010Z.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 13670                     MOVE RWF-AHCLML TO RWF-AHCLM                 ECSRIRTN
 13671                      GO TO REINSURE-CALC-CLAIM-SKIP              ECSRIRTN
 13672              ELSE                                                ECSRIRTN
 13673                 IF (RWF-AHCLML + RWF-AHCLM) GREATER              ECSRIRTN
 13674                                           RCT-AH-CLM-MAX (CO-SUB)ECSRIRTN
 13675                     COMPUTE RWF-AHCLML =                         ECSRIRTN
 13676                               RCT-AH-CLM-MAX (CO-SUB) - RWF-AHCLMECSRIRTN
 13677                     MOVE RCT-AH-CLM-MAX (CO-SUB) TO RWF-AHCLM    ECSRIRTN
 13678                      GO TO REINSURE-CALC-CLAIM-SKIP.             ECSRIRTN
 13679                                                                  ECSRIRTN
 13680                                                                  ECSRIRTN
 13681     IF DTE-CLIENT = 'FLA'                                        ECSRIRTN
 13682        IF REIN-COMP (SUB1) = ('200000' OR '210000' OR            ECSRIRTN
 13683                               '220000' OR '230000')              ECSRIRTN
 13684           PERFORM FLA-SPEC-REIN-CLMS THRU                        ECSRIRTN
 13685               E-FLA-SPEC-REIN-CLMS.                              ECSRIRTN
 13686                                                                  ECSRIRTN
 13687     ADD RWF-AHCLML TO RWF-AHCLM.                                 ECSRIRTN
 13688                                                                  ECSRIRTN
 13689     GO TO REINSURE-CALC-CLAIM-SKIP.                              ECSRIRTN
 13690                                                                  ECSRIRTN
 13691                                                                  ECSRIRTN
 13692 REINSURE-CALC-AH-RISK-CLAIM.                                     ECSRIRTN
 13693                                                                  ECSRIRTN
 13694     IF RWF-AHAMT NOT GREATER THAN +0                             ECSRIRTN
 13695         GO TO REINSURE-CALC-CLAIM-SKIP.                          ECSRIRTN
 13696                                                                  ECSRIRTN
 13697     IF REIN-RT-SW = 'X'                                          ECSRIRTN
 13698         MOVE RW-AHCLMWK              TO RWF-AHCLM                ECSRIRTN
 13699         GO TO REINSURE-CALC-CLAIM-SKIP.                          ECSRIRTN
 13700                                                                  ECSRIRTN
 13701     COMPUTE REIN-RISK-AMOUNT = (RWF-AHAMT * CR-AH-TERM) -        ECSRIRTN
 13702                                (RS-AH-BEN * REIN-AH-CLM-MONTHS). ECSRIRTN
 13703                                                                  ECSRIRTN
 13704     IF REIN-RISK-AMOUNT NOT GREATER THAN +0                      ECSRIRTN
 13705         GO TO REINSURE-CALC-CLAIM-SKIP.                          ECSRIRTN
 13706                                                                  ECSRIRTN
 13707     IF REIN-AH-PRIOR-CLMS-PAID GREATER THAN REIN-RISK-AMOUNT     ECSRIRTN
 13708         GO TO REINSURE-CALC-CLAIM-SKIP.                          ECSRIRTN
 13709                                                                  ECSRIRTN
 13710     IF (RW-AHCLMWK + REIN-AH-PRIOR-CLMS-PAID)                    ECSRIRTN
 13711                                GREATER THAN REIN-RISK-AMOUNT     ECSRIRTN
 13712         COMPUTE RWF-AHCLML = REIN-RISK-AMOUNT                    ECSRIRTN
 13713                             - REIN-AH-PRIOR-CLMS-PAID            ECSRIRTN
 13714         MOVE REIN-RISK-AMOUNT        TO RWF-AHCLM                ECSRIRTN
 13715     ELSE                                                         ECSRIRTN
 13716         MOVE RW-AHCLMWK              TO RWF-AHCLML               ECSRIRTN
 13717         ADD RW-AHCLMWK TO RWF-AHCLM.                             ECSRIRTN
 13718                                                                  ECSRIRTN
 13719                                                                  ECSRIRTN
 13720 REINSURE-CALC-CLAIM-SKIP.                                        ECSRIRTN
 13721                                                                  ECSRIRTN
 13722     IF RWF-LFCLM NOT = ZEROS                                     ECSRIRTN
 13723         MOVE 'X' TO REIN-LF-FLG (SUB1).                          ECSRIRTN
 13724                                                                  ECSRIRTN
 13725     IF RWF-AHCLM NOT = ZEROS                                     ECSRIRTN
 13726         MOVE 'X' TO REIN-AH-FLG (SUB1).                          ECSRIRTN
 13727                                                                  ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 268
* ECS010Z.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 13728     GO TO REINSURE-CALC-CLAIM-X.                                 ECSRIRTN
 13729                                                                  ECSRIRTN
 13730 REINSURE-REMAINDER-CLAIM.                                        ECSRIRTN
 13731                                                                  ECSRIRTN
 13732     MOVE RW-LFCLMWK TO RWF-LFCLML.                               ECSRIRTN
 13733     MOVE RW-AHCLMWK TO RWF-AHCLML.                               ECSRIRTN
 13734                                                                  ECSRIRTN
 13735     PERFORM REINSURE-SUBTRACT-CLAIM THRU                         ECSRIRTN
 13736         REINSURE-SUBTRACT-CLAIM-X                                ECSRIRTN
 13737             VARYING SUB2 FROM +1 BY +1 UNTIL SUB2 = SUB1.        ECSRIRTN
 13738                                                                  ECSRIRTN
 13739     ADD RWF-LFCLML TO RWF-LFCLM.                                 ECSRIRTN
 13740     ADD RWF-AHCLML TO RWF-AHCLM.                                 ECSRIRTN
 13741                                                                  ECSRIRTN
 13742     IF RWF-LFCLM NOT = ZEROS                                     ECSRIRTN
 13743         MOVE 'X' TO REIN-LF-FLG (SUB1).                          ECSRIRTN
 13744                                                                  ECSRIRTN
 13745     IF RWF-AHCLM NOT = ZEROS                                     ECSRIRTN
 13746         MOVE 'X' TO REIN-AH-FLG (SUB1).                          ECSRIRTN
 13747                                                                  ECSRIRTN
 13748 REINSURE-CALC-CLAIM-X.                                           ECSRIRTN
 13749                                                                  ECSRIRTN
 13750     IF REIN-LF-AH-FLGS (SUB1) NOT = SPACES                       ECSRIRTN
 13751         MOVE 'X' TO REIN-BUS-FLAG.                               ECSRIRTN
 13752                                                                  ECSRIRTN
 13753     MOVE RWF-FIELDS TO REIN-WORK-FLDS (SUB1).                    ECSRIRTN
 13754                                                                  ECSRIRTN
 13755 REINSURE-SUBTRACT-CLAIM.                                         ECSRIRTN
 13756                                                                  ECSRIRTN
 13757     SUBTRACT REIN-LFCLML (SUB2) FROM RWF-LFCLML.                 ECSRIRTN
 13758     SUBTRACT REIN-AHCLML (SUB2) FROM RWF-AHCLML.                 ECSRIRTN
 13759                                                                  ECSRIRTN
 13760 REINSURE-SUBTRACT-CLAIM-X.                                       ECSRIRTN
 13761     EXIT.                                                        ECSRIRTN
 13762                                                                  ECSRIRTN
 13763 REINSURE-SUB-REM-CLAIM.                                          ECSRIRTN
 13764                                                                  ECSRIRTN
 13765     IF REIN-REM-SW (SUB2) = 'Y' OR 'Z' OR 'X' OR 'N'             ECSRIRTN
 13766         SUBTRACT REIN-AHCLML (SUB2) FROM RWF-AHCLML.             ECSRIRTN
 13767                                                                  ECSRIRTN
 13768 REINSURE-SUB-REM-CLAIM-X.                                        ECSRIRTN
 13769     EXIT.                                                        ECSRIRTN
 13770                                                                  ECSRIRTN
 13771                                                                  ECSRIRTN
 13772 CLEAR-REIN-HOLD.                                                 ECSRIRTN
 13773                                                                  ECSRIRTN
 13774     MOVE SPACES TO REIN-COMP (1).                                ECSRIRTN
 13775     MOVE SPACES TO REIN-LF-AH-FLGS (1).                          ECSRIRTN
 13776     MOVE SPACES TO REIN-REM-SW (1).                              ECSRIRTN
 13777     MOVE SPACES TO REIN-REM-AH-100 (1).                          ECSRIRTN
 13778                                                                  ECSRIRTN
 13779     MOVE +0 TO REIN-LFAMT (1)  REIN-LFPRM (1)  REIN-AHAMT (1)    ECSRIRTN
 13780         REIN-AHPRM (1)  REIN-LFRFND (1)  REIN-AHRFND (1)         ECSRIRTN
 13781         REIN-LFCLM (1)  REIN-AHCLM (1)  REIN-LFCLML (1)          ECSRIRTN
 13782         REIN-AHCLML (1)  REIN-DIS-IBNR (1)  REIN-DIS-PAYCUR (1)  ECSRIRTN
 13783         REIN-DIS-FUTRSV (1)  REIN-DTH-IBNR (1)                   ECSRIRTN
 13784         REIN-DTH-PAYCUR (1)  REIN-DTH-FUTRSV (1)                 ECSRIRTN
 13785         REIN-DIS-IBNRL (1)  REIN-DIS-PAYCURL (1)                 ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 269
* ECS010Z.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 13786         REIN-DIS-FUTRSVL (1)  REIN-DTH-IBNRL (1)                 ECSRIRTN
 13787         REIN-DTH-PAYCURL (1)  REIN-DTH-FUTRSVL (1)               ECSRIRTN
 13788         REIN-AH-LIMIT (1).                                       ECSRIRTN
 13789                                                                  ECSRIRTN
 13790     PERFORM CLEAR-REIN-HOLD-ALL VARYING SUB1 FROM 2 BY 1         ECSRIRTN
 13791         UNTIL REIN-COMP (SUB1) = SPACES.                         ECSRIRTN
 13792                                                                  ECSRIRTN
 13793     GO TO CLEAR-REIN-HOLD-X.                                     ECSRIRTN
 13794                                                                  ECSRIRTN
 13795 CLEAR-REIN-HOLD-ALL.                                             ECSRIRTN
 13796                                                                  ECSRIRTN
 13797     MOVE REIN-LEVELS (1) TO REIN-LEVELS (SUB1).                  ECSRIRTN
 13798                                                                  ECSRIRTN
 13799 CLEAR-REIN-HOLD-X.                                               ECSRIRTN
 13800     EXIT.                                                        ECSRIRTN
 13801                                                                  ECSRIRTN
 13802 FLA-SPEC-REIN-CLMS.                                              ECSRIRTN
 13803                                                                  ECSRIRTN
 13804     MOVE +250.00 TO FLA-CLM-REIN-BASE  ADJ-FLA-REIN-BASE.        ECSRIRTN
 13805                                                                  ECSRIRTN
 13806     IF REIN-COMP (SUB1) = '230000'                               ECSRIRTN
 13807         MOVE +100.00 TO FLA-CLM-REIN-BASE  ADJ-FLA-REIN-BASE.    ECSRIRTN
 13808                                                                  ECSRIRTN
 13809     IF CR-AHAMT NOT = ZERO                                       ECSRIRTN
 13810         COMPUTE ADJ-FLA-REIN-BASE ROUNDED =                      ECSRIRTN
 13811             (RW-AHCLMWK / CR-AHAMT) * FLA-CLM-REIN-BASE.         ECSRIRTN
 13812                                                                  ECSRIRTN
 13813     IF REIN-RT-SW = 'X'                                          ECSRIRTN
 13814         MOVE CR-DIS-CC TO CIRD-CC                                ECSRIRTN
 13815         MOVE CR-DIS-YR TO CIRD-YR                                ECSRIRTN
 13816         MOVE CR-DIS-MO TO CIRD-MO                                ECSRIRTN
 13817     ELSE                                                         ECSRIRTN
 13818         MOVE DTO-CC    TO CIRD-CC                                ECSRIRTN
 13819         MOVE DTO-YR    TO CIRD-YR                                ECSRIRTN
 13820         MOVE DTO-MO    TO CIRD-MO.                               ECSRIRTN
 13821                                                                  ECSRIRTN
 13822     MOVE ZEROS TO RWF-AHCLML.                                    ECSRIRTN
 13823                                                                  ECSRIRTN
 13824     IF CLM-INCUR-REIN-DATE LESS '197809'  AND                    ECSRIRTN
 13825        CR-AHAMT GREATER FLA-CLM-REIN-BASE                        ECSRIRTN
 13826         COMPUTE RWF-AHCLML = RW-AHCLMWK - ADJ-FLA-REIN-BASE.     ECSRIRTN
 13827                                                                  ECSRIRTN
 13828     IF CLM-INCUR-REIN-DATE GREATER '197806'                      ECSRIRTN
 13829         COMPUTE RWF-AHCLML = RWF-AHCLML + (RW-AHCLMWK * +.9).    ECSRIRTN
 13830                                                                  ECSRIRTN
 13831 E-FLA-SPEC-REIN-CLMS.                                            ECSRIRTN
 13832     EXIT.                                                        ECSRIRTN
 13833                                                                  ECSRIRTN
 13834 REIN-FIND-CO-LOOP.                                               ECSRIRTN
 13835                                                                  ECSRIRTN
 13836     CONTINUE.                                                    ECSRIRTN
 13837*  DUMMY PARAGRAPH - NO CODE NEEDED.                              ECSRIRTN
 13838 FIND-REI-CO-EXIT.                                                ECSRIRTN
 13839     EXIT.                                                        ECSRIRTN
 13840                                                                  ECSRIRTN
 13841 REIN-CO-TABLE-BUILD.                                             ECSRIRTN
 13842                                                                  ECSRIRTN
 13843     PERFORM ZERO-RCT-ENTRIES THRU ZERO-RCT-EXIT                  ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 270
* ECS010Z.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 13844         VARYING CO-SUB FROM 1 BY 1                               ECSRIRTN
 13845                   UNTIL CO-SUB GREATER REIN-CO-TABLE-ENT-CNT.    ECSRIRTN
 13846                                                                  ECSRIRTN
 13847     PERFORM ZERO-RC2-ENTRIES THRU ZERO-RC2-EXIT                  ECSRIRTN
 13848         VARYING CO-SUB FROM 1 BY 1                               ECSRIRTN
 13849                   UNTIL CO-SUB GREATER REIN-CO-TABLE-ENT-CNT.    ECSRIRTN
 13850                                                                  ECSRIRTN
 13851     MOVE LOW-VALUES          TO RE-CONTROL-PRIMARY.              ECSRIRTN
 13852                                                                  ECSRIRTN
 13853     START ERRTBL-IN                                              ECSRIRTN
 13854           KEY IS GREATER THAN RE-CONTROL-PRIMARY                 ECSRIRTN
 13855             INVALID KEY                                          ECSRIRTN
 13856               GO TO REIN-BUILD-EXIT.                             ECSRIRTN
 13857                                                                  ECSRIRTN
 13858     MOVE 0 TO CO-SUB.                                            ECSRIRTN
 13859     MOVE 0 TO SUB1.                                              ECSRIRTN
 13860 REIN-CO-BUILD-LOOP.                                              ECSRIRTN
 13861                                                                  ECSRIRTN
 13862     READ ERRTBL-IN  NEXT RECORD.                                 ECSRIRTN
 13863                                                                  ECSRIRTN
 13864     IF ERRTBL-FILE-STATUS = '10'                                 ECSRIRTN
 13865        GO TO REIN-BUILD-EXIT.                                    ECSRIRTN
 13866                                                                  ECSRIRTN
 13867     IF ERRTBL-FILE-STATUS NOT = ZERO                             ECSRIRTN
 13868        MOVE ERRTBL-FILE-STATUS TO WS-ABEND-FILE-STATUS           ECSRIRTN
 13869        MOVE 'READ ERROR ON FILE - ERRTBL'                        ECSRIRTN
 13870                                  TO WS-ABEND-MESSAGE             ECSRIRTN
 13871        GO TO ABEND-PGM.                                          ECSRIRTN
 13872                                                                  ECSRIRTN
 13873     IF RE-CODE NOT = 'B'                                         ECSRIRTN
 13874        GO TO REIN-CO-BUILD-LOOP.                                 ECSRIRTN
 13875                                                                  ECSRIRTN
 13876     IF RE-CLM-INCURRED-LIM NOT NUMERIC                           ECSRIRTN
 13877        MOVE ZERO TO RE-CLM-INCURRED-LIM.                         ECSRIRTN
 13878                                                                  ECSRIRTN
 13879     IF RE-EARNING-START-DT NOT NUMERIC                           ECSRIRTN
 13880        MOVE ZERO TO RE-EARNING-START-DT.                         ECSRIRTN
 13881                                                                  ECSRIRTN
 13882     IF RE-EARNING-STOP-DT NOT NUMERIC                            ECSRIRTN
 13883        MOVE ZERO TO RE-EARNING-STOP-DT.                          ECSRIRTN
 13884                                                                  ECSRIRTN
 13885     PERFORM VARYING CPSE-NDX FROM 1 BY 1 UNTIL CPSE-NDX > 1500   ECSRIRTN
 13886        MOVE RCT-CLM-CUTOFF-DT (CPSE-NDX)                         ECSRIRTN
*1118-E***************************************                         ( 181)**
**    Index-name belongs to different table - unexpected behaviour may occur
 13887                        TO  WS-RCT-CLM-CUTOFF-DT-N (CPSE-NDX)        CL*12
 13888        MOVE RCT-EARNING-START-DT (CPSE-NDX)                      ECSRIRTN
*1118-E******************************************                      ( 270)**
**    Index-name belongs to different table - unexpected behaviour may occur
 13889                        TO  WS-RCT-EARNING-START-DT-N (CPSE-NDX)     CL*12
 13890        MOVE RCT-EARNING-STOP-DT (CPSE-NDX)                       ECSRIRTN
*1118-E*****************************************                       ( 270)**
**    Index-name belongs to different table - unexpected behaviour may occur
 13891                        TO  WS-RCT-EARNING-STOP-DT-N (CPSE-NDX)      CL*12
 13892     END-PERFORM.                                                 ECSRIRTN
 13893     MOVE RWF-EP-STOP-DATE       TO  WS-RWF-EP-STOP-DATE-N.          CL*12
 13894                                                                  ECSRIRTN
 13895     IF RE-LF-CLM-PCT NOT NUMERIC                                 ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 271
* ECS010Z.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 13896        MOVE ZERO TO RE-LF-CLM-PCT.                               ECSRIRTN
 13897                                                                  ECSRIRTN
 13898     IF RE-AH-CLM-PCT NOT NUMERIC                                 ECSRIRTN
 13899        MOVE ZERO TO RE-AH-CLM-PCT.                               ECSRIRTN
 13900                                                                  ECSRIRTN
 13901     IF RE-LF-CLM-MAX NOT NUMERIC                                 ECSRIRTN
 13902        MOVE ZERO TO RE-LF-CLM-MAX.                               ECSRIRTN
 13903                                                                  ECSRIRTN
 13904     IF RE-AH-CLM-MAX NOT NUMERIC                                 ECSRIRTN
 13905        MOVE ZERO TO RE-AH-CLM-MAX.                               ECSRIRTN
 13906                                                                  ECSRIRTN
 13907     IF (RE-AH-CLM-MAX = ZERO) AND                                ECSRIRTN
 13908        (RE-LF-CLM-MAX = ZERO) AND                                ECSRIRTN
 13909        (RE-AH-CLM-PCT = ZERO) AND                                ECSRIRTN
 13910        (RE-LF-CLM-PCT = ZERO) AND                                ECSRIRTN
 13911        (RE-CLM-INCURRED-LIM = ZERO) AND                          ECSRIRTN
 13912        (RE-EARNING-START-DT = ZERO) AND                          ECSRIRTN
 13913        (RE-EARNING-STOP-DT = ZERO)                               ECSRIRTN
 13914          GO TO REIN-CO-BUILD-EPR.                                ECSRIRTN
 13915                                                                  ECSRIRTN
 13916     ADD +1 TO CO-SUB.                                            ECSRIRTN
 13917                                                                  ECSRIRTN
 13918     IF CO-SUB GREATER REIN-CO-TABLE-ENT-CNT                      ECSRIRTN
 13919        MOVE 0202 TO WS-RETURN-CODE                               ECSRIRTN
 13920        DISPLAY 'REINSURANCE COMPANY SAVE TABLE EXCEEDED'         ECSRIRTN
 13921        DISPLAY 'ERROR DETECTED IN ECSRIRTN, SEE ECSRITAB'        ECSRIRTN
 13922        MOVE 'REINSURANCE COMPANY SAVE TABLE EXCEEDED'            ECSRIRTN
 13923                                  TO WS-ABEND-MESSAGE             ECSRIRTN
 13924        GO TO ABEND-PGM.                                          ECSRIRTN
 13925                                                                  ECSRIRTN
 13926     MOVE RE-COMPANY           TO RCT-REIN-CO (CO-SUB).              CL**7
 13927                                                                  ECSRIRTN
 13928     MOVE RE-CLM-INCURRED-LIM  TO RCT-CLM-CUTOFF-DT (CO-SUB)      ECSRIRTN
 13929                               WS-RCT-CLM-CUTOFF-DT-N (CO-SUB).      CL*12
 13930     MOVE RE-EARNING-START-DT  TO RCT-EARNING-START-DT (CO-SUB)   ECSRIRTN
 13931                               WS-RCT-EARNING-START-DT-N (CO-SUB).   CL*12
 13932     MOVE RE-EARNING-STOP-DT   TO RCT-EARNING-STOP-DT (CO-SUB)    ECSRIRTN
 13933                               WS-RCT-EARNING-STOP-DT-N (CO-SUB).    CL*12
 13934                                                                  ECSRIRTN
 13935     IF RE-EARN-STOP-CODE = 'A'  OR  'L'                          ECSRIRTN
 13936         MOVE RE-EARN-STOP-CODE  TO RCT-EARN-STOP-CODE (CO-SUB)   ECSRIRTN
 13937     ELSE                                                         ECSRIRTN
 13938         MOVE 'B'                TO RCT-EARN-STOP-CODE (CO-SUB).  ECSRIRTN
 13939                                                                  ECSRIRTN
 13940     MOVE RE-LF-CLM-PCT  TO RCT-LF-CLM-PCT (CO-SUB).              ECSRIRTN
 13941     MOVE RE-AH-CLM-PCT  TO RCT-AH-CLM-PCT (CO-SUB).              ECSRIRTN
 13942     MOVE RE-LF-CLM-MAX  TO RCT-LF-CLM-MAX (CO-SUB).              ECSRIRTN
 13943     MOVE RE-AH-CLM-MAX  TO RCT-AH-CLM-MAX (CO-SUB).              ECSRIRTN
 13944                                                                  ECSRIRTN
 13945 REIN-CO-BUILD-EPR.                                               ECSRIRTN
 13946                                                                  ECSRIRTN
 13947     IF RE-AH-PR-PCT  NOT NUMERIC                                 ECSRIRTN
 13948        MOVE ZERO TO RE-AH-PR-PCT.                                ECSRIRTN
 13949                                                                  ECSRIRTN
 13950     IF RE-AH-78-PCT  NOT NUMERIC                                 ECSRIRTN
 13951        MOVE ZERO TO RE-AH-78-PCT.                                ECSRIRTN
 13952                                                                  ECSRIRTN
 13953     IF RE-LF-PR-PCT  NOT NUMERIC                                 ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 272
* ECS010Z.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 13954        MOVE ZERO TO RE-LF-PR-PCT.                                ECSRIRTN
 13955                                                                  ECSRIRTN
 13956     IF RE-LF-78-PCT  NOT NUMERIC                                 ECSRIRTN
 13957        MOVE ZERO TO RE-LF-78-PCT.                                ECSRIRTN
 13958                                                                  ECSRIRTN
 13959     ADD +1 TO SUB1.                                              ECSRIRTN
 13960                                                                  ECSRIRTN
 13961     IF SUB1 GREATER REIN-CO-TABLE-ENT-CNT                        ECSRIRTN
 13962        MOVE 0201 TO WS-RETURN-CODE                               ECSRIRTN
 13963        MOVE 'REINSURANCE COMPANY SAVE TABLE EXCEEDED'            ECSRIRTN
 13964                                  TO WS-ABEND-MESSAGE             ECSRIRTN
 13965        GO TO ABEND-PGM.                                          ECSRIRTN
 13966                                                                  ECSRIRTN
 13967     MOVE RE-COMPANY     TO RC2-REIN-CO    (SUB1).                ECSRIRTN
 13968     MOVE RE-AH-PR-PCT   TO RC2-AH-PRO-PCT (SUB1).                ECSRIRTN
 13969     MOVE RE-AH-78-PCT   TO RC2-AH-R78-PCT (SUB1).                ECSRIRTN
 13970     MOVE RE-LF-PR-PCT   TO RC2-LF-PRO-PCT (SUB1).                ECSRIRTN
 13971     MOVE RE-LF-78-PCT   TO RC2-LF-R78-PCT (SUB1).                ECSRIRTN
 13972     MOVE RE-NAME        TO RC2-CO-NAME    (SUB1).                ECSRIRTN
 13973     if re-state-exhibit-opt-f = 'Y'
 13974        move 'Y'         to rc2-ecs152-rpt (sub1)
 13975     else
 13976        move 'N'         to rc2-ecs152-rpt (sub1)
 13977     end-if
 13978                                                                  ECSRIRTN
 13979     GO TO REIN-CO-BUILD-LOOP.                                    ECSRIRTN
 13980                                                                  ECSRIRTN
 13981 REIN-BUILD-EXIT.                                                 ECSRIRTN
 13982     EXIT.                                                        ECSRIRTN
 13983                                                                  ECSRIRTN
 13984 ZERO-RCT-ENTRIES.                                                ECSRIRTN
 13985                                                                  ECSRIRTN
 13986     MOVE SPACES TO REIN-CO-HOLD-ENTRIES (CO-SUB).                ECSRIRTN
 13987                                                                  ECSRIRTN
 13988     MOVE ZERO   TO RCT-CLM-CUTOFF-DT (CO-SUB)                    ECSRIRTN
 13989                    WS-RCT-CLM-CUTOFF-DT-N (CO-SUB)                  CL*12
 13990                    RCT-EARNING-START-DT (CO-SUB)                 ECSRIRTN
 13991                    WS-RCT-EARNING-START-DT-N (CO-SUB)               CL*12
 13992                    RCT-EARNING-STOP-DT (CO-SUB)                  ECSRIRTN
 13993                    WS-RCT-EARNING-STOP-DT-N (CO-SUB)                CL*12
 13994                    RCT-LF-CLM-PCT    (CO-SUB)                    ECSRIRTN
 13995                    RCT-AH-CLM-PCT    (CO-SUB)                    ECSRIRTN
 13996                    RCT-LF-CLM-MAX    (CO-SUB)                    ECSRIRTN
 13997                    RCT-AH-CLM-MAX    (CO-SUB).                   ECSRIRTN
 13998                                                                  ECSRIRTN
 13999 ZERO-RCT-EXIT.                                                   ECSRIRTN
 14000     EXIT.                                                        ECSRIRTN
 14001                                                                  ECSRIRTN
 14002 ZERO-RC2-ENTRIES.                                                ECSRIRTN
 14003                                                                  ECSRIRTN
 14004     MOVE SPACES TO RC2-CO-NAME (CO-SUB)                          ECSRIRTN
 14005                    RC2-REIN-CO (CO-SUB).                         ECSRIRTN
 14006     move spaces      to rc2-ecs152-rpt (co-sub)
 14007                                                                  ECSRIRTN
 14008     MOVE ZERO   TO RC2-LF-R78-PCT    (CO-SUB)                    ECSRIRTN
 14009                    RC2-LF-PRO-PCT    (CO-SUB)                    ECSRIRTN
 14010                    RC2-AH-R78-PCT    (CO-SUB)                    ECSRIRTN
 14011                    RC2-AH-PRO-PCT    (CO-SUB).                   ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 273
* ECS010Z.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 14012                                                                  ECSRIRTN
 14013 ZERO-RC2-EXIT.                                                   ECSRIRTN
 14014     EXIT.                                                        ECSRIRTN
 14015******************************************************************ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 274
* ECS010Z.cbl
 14017******************************************************************
 14018***   R E C A L C U L A T I O N   O F   R E I N S U R A N C E  ***
 14019******************************************************************
 14020
 14021 3600-RC-REINSURANCE.
 14022
 14023     IF DTE-PGM-OPT NOT = '1'
 14024         GO TO 3799-RC-REINSURANCE-X.
 14025
 14026     IF DTE-CLIENT = 'WSL'
 14027         IF CR-REIN-TABLE = '00A'
 14028             GO TO 3799-RC-REINSURANCE-X.
 14029
 14030     IF CR-REIN-TABLE = SPACES OR ZEROS
 14031         PERFORM CLEAR-REIN-HOLD THRU CLEAR-REIN-HOLD-X.
 14032
 14033 3610-CLEAR-RC-REIN.
 14034
 14035     MOVE SPACES TO RC-REIN-LEVELS (1).
 14036     MOVE ZEROS  TO RC-REIN-LFAMT (1)
 14037                    RC-REIN-LFPRM (1)
 14038                    RC-REIN-AHAMT (1)
 14039                    RC-REIN-AHPRM (1)
 14040                    RC-REIN-LFRFND (1)
 14041                    RC-REIN-AHRFND (1)
 14042                    RC-REIN-LFCLM (1)
 14043                    RC-REIN-AHCLM (1).
 14044
 14045     PERFORM 3620-CLEAR-RC-LEVELS VARYING SUB1 FROM +2 BY +1
 14046         UNTIL RC-REIN-COMP (SUB1) = SPACES.
 14047
 14048     MOVE +1 TO SUB1.
 14049     MOVE +0 TO SUB2.
 14050
 14051     GO TO 3630-RC-REIN-LOOP-1.
 14052
 14053 3620-CLEAR-RC-LEVELS.
 14054
 14055     MOVE RC-REIN-LEVELS (1) TO RC-REIN-LEVELS (SUB1).
 14056
 14057
 14058 3630-RC-REIN-LOOP-1.
 14059
 14060     IF REIN-LF-AH-FLGS (SUB1) NOT = SPACES
 14061         ADD +1 TO SUB2
 14062         MOVE REIN-COMP (SUB1)   TO RC-REIN-COMP (SUB2)
 14063         MOVE REIN-LFAMT (SUB1)  TO RC-REIN-LFAMT (SUB2)
 14064         MOVE REIN-LFPRM (SUB1)  TO RC-REIN-LFPRM (SUB2)
 14065         MOVE REIN-AHAMT (SUB1)  TO RC-REIN-AHAMT (SUB2)
 14066         MOVE REIN-AHPRM (SUB1)  TO RC-REIN-AHPRM (SUB2)
 14067         MOVE REIN-LFRFND (SUB1) TO RC-REIN-LFRFND (SUB2)
 14068         MOVE REIN-AHRFND (SUB1) TO RC-REIN-AHRFND (SUB2)
 14069         MOVE REIN-LFCLM (SUB1)  TO RC-REIN-LFCLM (SUB2)
 14070         MOVE REIN-AHCLM (SUB1)  TO RC-REIN-AHCLM (SUB2)
 14071         MOVE REIN-REM-SW (SUB1) TO RC-REIN-REM-SW (SUB2).
 14072
 14073     ADD +1 TO SUB1.
 14074     IF REIN-COMP (SUB1) NOT = SPACES
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 275
* ECS010Z.cbl
 14075         GO TO 3630-RC-REIN-LOOP-1.
 14076
 14077     PERFORM CLEAR-REIN-HOLD THRU CLEAR-REIN-HOLD-X.
 14078
 14079     MOVE AM-REI-TABLE TO CR-REIN-TABLE.
 14080     IF CR-REIN-TABLE = SPACES OR ZEROS
 14081         MOVE +1                     TO SUB1
 14082         GO TO 3710-RC-REIN-LOOP-2.
 14083
 14084     PERFORM 3010-RR-READ-REIN THRU 3019-RR-READ-REIN-X.
 14085
 14086 3640-NSP-REIN-RATING-ROUTINE.
 14087
 14088     MOVE CR-DT                      TO DC-GREG-DATE-CYMD.
 14089     MOVE 'L'                        TO DC-OPTION-CODE.
 14090     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 14091     MOVE DC-BIN-DATE-1              TO CP-CERT-EFF-DT.
 14092     MOVE SPACES                     TO CP-ACCT-FLD-5.
 14093     MOVE DTE-CLIENT                 TO CP-COMPANY-ID.
 14094     MOVE CR-AGE                     TO CP-ISSUE-AGE.
 14095     MOVE CR-APR                     TO CP-LOAN-APR.
 14096     MOVE CR-PMT-FREQ                TO CP-PAY-FREQUENCY.
 14097     MOVE CR-LOAN-TERM               TO CP-LOAN-TERM.
 14098     MOVE ZEROS                      TO CP-DEVIATION-CODE.
 14099     MOVE ZEROS                      TO CP-CLASS-CODE.
 14100
 14101     IF DTE-CLIENT = 'TIC'
 14102        IF CR-REIN-TABLE = '01T' OR '02T' OR '03T'
 14103            MOVE ZERO                TO CP-CLASS-CODE
 14104        ELSE
 14105            MOVE CR-RATING-CLASS     TO CP-CLASS-CODE.
 14106
 14107     MOVE '3'                        TO CP-PROCESS-TYPE.
 14108     MOVE DTE-CLASIC-COMPANY-CD      TO CP-COMPANY-CD.
 14109     MOVE CR-PMT-EXTENSION-DAYS      TO CP-TERM-OR-EXT-DAYS.
 14110
 14111 3650-NSP-REIN-LIFE.
 14112
 14113     IF CR-LFTYP = ZERO
 14114         GO TO 3660-NSP-REIN-AH.
 14115     IF (RE-NSP-ST-CD-LF = ZEROS OR SPACES)
 14116        OR DTE-CLIENT = 'DCC'
 14117         GO TO 3660-NSP-REIN-AH.
 14118     IF DTE-CLIENT NOT = 'LBL'
 14119         IF (CLAS-I-BAL (CLAS-INDEXL) = 'B')
 14120             GO TO 3660-NSP-REIN-AH.
 14121
 14122     IF RE-NSP-ST-CD-LF NOT = STATE-L
 14123         MOVE RE-NSP-ST-CD-LF        TO STATE-L
 14124         PERFORM 8200-STATE-CODE-LOOKUP THRU 8299-STATE-LOOKUP-X.
 14125
 14126     MOVE CLAS-I-RL-AH (CLAS-INDEXL) TO CP-BENEFIT-TYPE.
 14127     MOVE CR-LF-TERM                 TO CP-ORIGINAL-TERM.
 14128     MOVE CR-LFAMT                   TO CP-ORIGINAL-BENEFIT
 14129                                        CP-RATING-BENEFIT-AMT.
 14130     MOVE CLAS-I-EP (CLAS-INDEXL)    TO CP-EARNING-METHOD.
 14131     MOVE CLAS-I-BAL (CLAS-INDEXL)   TO CP-SPECIAL-CALC-CD.
 14132     MOVE CR-LFTYP                   TO CP-BENEFIT-CD.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 276
* ECS010Z.cbl
 14133     MOVE LIFE-OVERRIDE-L1           TO CP-LIFE-OVERRIDE-CODE.
 14134     MOVE AM-LF-DEVIATION-PCT        TO CP-RATE-DEV-PCT.
 14135     MOVE RE-NSP-ST-CD-LF            TO CP-STATE.
 14136     MOVE STATE-ABBR (CLAS-INDEXS)   TO CP-STATE-STD-ABBRV.
 14137
 14138     IF CP-STATE-STD-ABBRV = 'OR'
 14139         COMPUTE CP-RATING-BENEFIT-AMT = CR-LFAMT + CR-LFAMT-ALT.
 14140
 14141     PERFORM 8100-GET-RATE THRU 8199-GET-RATE-X.
 14142
 14143     IF CP-ERROR-RATE-NOT-FOUND  OR
 14144        CP-ERROR-RATE-IS-ZERO
 14145         MOVE 'LIFE NET SINGLE PREMIUM RATE NOT FOUND'
 14146                                     TO WS-ABEND-MESSAGE
 14147         MOVE 0302                   TO WS-ABEND-CODE
 14148         DISPLAY '******************************'
 14149         DISPLAY '***** ERROR LOCATION 018 *****'
 14150         DISPLAY '******************************'
 14151         MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
 14152         GO TO ABEND-PGM.
 14153
 14154     MOVE CP-CALC-PREMIUM          TO CR-LF-NSP-PRM.
 14155
 14156*    COMPUTE CR-LF-NSP-PRM ROUNDED =
 14157*                      (CR-LFAMT / 100) * CP-PREMIUM-RATE.
 14158
 14159     COMPUTE CR-LF-NSP-PRM ROUNDED =  CR-LF-NSP-PRM +
 14160                   ((CR-LFAMT-ALT / 100) * CP-PREMIUM-RATE).
 14161
 14162     MOVE CP-PREMIUM-RATE            TO CR-LF-NSP-PRM-RATE.
 14163
 14164 3660-NSP-REIN-AH.
 14165
 14166     IF CR-AHTYP = ZERO
 14167         GO TO 3669-NSP-REIN-X.
 14168     IF (RE-NSP-ST-CD-AH = ZEROS OR SPACES)
 14169        OR DTE-CLIENT = 'DCC'
 14170         GO TO 3669-NSP-REIN-X.
 14171     IF DTE-CLIENT NOT = 'LBL'
 14172         IF (CLAS-I-BAL (CLAS-INDEXA) = 'B')
 14173             GO TO 3669-NSP-REIN-X.
 14174
 14175     IF RE-NSP-ST-CD-AH NOT = STATE-L
 14176         MOVE RE-NSP-ST-CD-AH        TO STATE-L
 14177         PERFORM 8200-STATE-CODE-LOOKUP THRU 8299-STATE-LOOKUP-X.
 14178
 14179     MOVE CLAS-I-RL-AH (CLAS-INDEXA) TO CP-BENEFIT-TYPE.
 14180     MOVE CR-AH-TERM                 TO CP-ORIGINAL-TERM.
 14181     MOVE CR-AHAMT                   TO CP-ORIGINAL-BENEFIT
 14182                                        CP-RATING-BENEFIT-AMT.
 14183     MOVE CLAS-I-EP (CLAS-INDEXA)    TO CP-EARNING-METHOD.
 14184     MOVE CLAS-I-BAL (CLAS-INDEXA)   TO CP-SPECIAL-CALC-CD.
 14185     MOVE CR-AHTYP                   TO CP-BENEFIT-CD.
 14186     MOVE AH-OVERRIDE-L1             TO CP-AH-OVERRIDE-CODE.
 14187     MOVE AM-AH-DEVIATION-PCT        TO CP-RATE-DEV-PCT.
 14188     MOVE RE-NSP-ST-CD-AH            TO CP-STATE.
 14189     MOVE STATE-ABBR (CLAS-INDEXS)   TO CP-STATE-STD-ABBRV.
 14190
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 277
* ECS010Z.cbl
 14191     IF CP-STATE-STD-ABBRV = 'OR'
 14192         COMPUTE CP-RATING-BENEFIT-AMT = CR-AHAMT * CR-AH-TERM.
 14193
 14194     PERFORM 8100-GET-RATE THRU 8199-GET-RATE-X.
 14195
 14196     IF CP-ERROR-RATE-NOT-FOUND  OR
 14197        CP-ERROR-RATE-IS-ZERO
 14198         MOVE 'A&H NET SINGLE PREMIUM RATE NOT FOUND'
 14199                                     TO WS-ABEND-MESSAGE
 14200         MOVE 0302                   TO WS-ABEND-CODE
 14201         DISPLAY '******************************'
 14202         DISPLAY '***** ERROR LOCATION 019 *****'
 14203         DISPLAY '******************************'
 14204         MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
 14205         GO TO ABEND-PGM.
 14206
 14207     COMPUTE CR-AH-NSP-PRM ROUNDED =
 14208             ((CR-AHAMT * CR-AH-TERM) / 100) * CP-PREMIUM-RATE.
 14209
 14210     MOVE CP-PREMIUM-RATE            TO CR-AH-NSP-PRM-RATE.
 14211
 14212 3669-NSP-REIN-X.
 14213     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 278
* ECS010Z.cbl
 14215******************************************************************
 14216***        R E C A L C U L A T E   R E I N S U R A N C E       ***
 14217******************************************************************
 14218
 14219 3700-RC-REIN-PERF-CALC.
 14220
*14221                             COPY ECSRTPFM.
 14222******************************************************************07/10/97
 14223*                                                                *ECSRTPFM
 14224*                            ECSRTPFM                            *   LV001
 14225*                            VMOD=2.002                          *ECSRTPFM
 14226*                                                                *ECSRTPFM
 14227******************************************************************ECSRTPFM
 14228                                                                  ECSRTPFM
 14229     IF    CR-LFAMT  NUMERIC                                      00000072
 14230           NEXT SENTENCE                                          00000073
 14231        ELSE                                                      00000074
 14232           MOVE ZEROS TO CR-LFAMT.                                00000075
 14233                                                                  00000076
 14234     IF    CR-LFAMT-ALT  NUMERIC                                  00000077
 14235           NEXT SENTENCE                                          00000078
 14236        ELSE                                                      00000079
 14237           MOVE ZEROS TO CR-LFAMT-ALT.                            00000080
 14238                                                                  00000081
 14239                                                                  00000082
 14240     IF    CR-LFPRM  NUMERIC                                      00000083
 14241           NEXT SENTENCE                                          00000084
 14242        ELSE                                                      00000085
 14243           MOVE ZEROS TO CR-LFPRM.                                00000086
 14244                                                                  00000087
 14245     IF    CR-LFPRM-ALT  NUMERIC                                  00000088
 14246           NEXT SENTENCE                                          00000089
 14247        ELSE                                                      00000090
 14248           MOVE ZEROS TO CR-LFPRM-ALT.                            00000091
 14249                                                                  00000092
 14250                                                                  00000093
 14251     IF    CR-LFPRM-CALC  NUMERIC                                 00000094
 14252           NEXT SENTENCE                                          00000095
 14253        ELSE                                                      00000096
 14254           MOVE ZEROS TO CR-LFPRM-CALC.                           00000097
 14255                                                                  00000098
 14256     IF    CR-LFPRM-CALC-ALT  NUMERIC                             00000099
 14257           NEXT SENTENCE                                          00000100
 14258        ELSE                                                      00000101
 14259           MOVE ZEROS TO CR-LFPRM-CALC-ALT.                       00000102
 14260                                                                  00000103
 14261     IF    CR-LF-NSP-PRM  NUMERIC                                 00000104
 14262           NEXT SENTENCE                                          00000105
 14263        ELSE                                                      00000106
 14264           MOVE ZEROS TO CR-LF-NSP-PRM.                           00000107
 14265                                                                  00000108
 14266     COMPUTE RS-R-LB = CR-LFAMT + CR-LFAMT-ALT.                   ECSRTPFM
 14267     COMPUTE RS-R-LP = CR-LFPRM + CR-LFPRM-ALT.                   ECSRTPFM
 14268     IF RE-NSP-ST-CD-LF = ZEROS  OR  SPACES                       ECSRTPFM
 14269         COMPUTE RS-R-LPC = CR-LFPRM-CALC + CR-LFPRM-CALC-ALT     ECSRTPFM
 14270     ELSE                                                         ECSRTPFM
 14271         MOVE CR-LF-NSP-PRM         TO RS-R-LPC.                  ECSRTPFM
 14272     MOVE RS-R-LPC                  TO REIN-CALCED-LIFE.          ECSRTPFM
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 279
* ECS010Z.cbl (/apps/prod/cid1p/copy/ECSRTPFM)
 14273                                                                  ECSRTPFM
 14274     MOVE CR-AHAMT                  TO RS-R-AB.                   ECSRTPFM
 14275     MOVE CR-AHPRM                  TO RS-R-AP.                   ECSRTPFM
 14276     IF RE-NSP-ST-CD-AH = ZEROS  OR  SPACES                       ECSRTPFM
 14277         MOVE CR-AHPRM-CALC         TO RS-R-APC                   ECSRTPFM
 14278     ELSE                                                         ECSRTPFM
 14279         MOVE CR-AH-NSP-PRM         TO RS-R-APC.                  ECSRTPFM
 14280     MOVE RS-R-APC                  TO REIN-CALCED-AH.            ECSRTPFM
 14281                                                                  ECSRTPFM
 14282     PERFORM REINSURE-CALC THRU REINSURE-CALC-X                   ECSRTPFM
 14283         VARYING SUB1 FROM +1 BY +1                               ECSRTPFM
 14284             UNTIL RE-REI-COMP-NO (SUB1) = SPACES.                ECSRTPFM
 14285                                                                  ECSRTPFM
 14286
 14287     IF CR-STATE NOT = STATE-L
 14288         MOVE CR-STATE               TO STATE-L
 14289         PERFORM 8200-STATE-CODE-LOOKUP THRU 8299-STATE-LOOKUP-X.
 14290
 14291     MOVE 'X'                     TO REIN-RT-SW.
 14292     PERFORM 3200-REINSURE-CANCEL THRU 3299-REINSURE-CANCEL-X.
 14293     PERFORM 3300-REINSURE-CLAIM THRU 3399-REINSURE-CLAIM-X.
 14294     MOVE ' '                     TO REIN-RT-SW.
 14295
 14296 3710-RC-REIN-LOOP-2.
 14297
 14298     IF REIN-COMP (SUB1) = SPACES
 14299         GO TO 3730-RC-REIN-EXTRACTS.
 14300
 14301     IF REIN-LF-AH-FLGS (SUB1) = SPACES
 14302        ADD +1 TO SUB1
 14303         GO TO 3710-RC-REIN-LOOP-2.
 14304
 14305     MOVE +1 TO SUB2.
 14306
 14307 3720-RC-REIN-LOOP-3.
 14308
 14309     IF RC-REIN-COMP (SUB2) = SPACES
 14310         ADD +1 TO SUB1
 14311         GO TO 3710-RC-REIN-LOOP-2.
 14312
 14313     IF REIN-COMP (SUB1) NOT = RC-REIN-COMP (SUB2)
 14314         ADD +1 TO SUB2
 14315         GO TO 3720-RC-REIN-LOOP-3.
 14316
 14317     IF REIN-LFAMT (SUB1) = RC-REIN-LFAMT (SUB2)
 14318        AND REIN-LFPRM (SUB1) = RC-REIN-LFPRM (SUB2)
 14319        AND REIN-AHAMT (SUB1) = RC-REIN-AHAMT (SUB2)
 14320        AND REIN-AHPRM (SUB1) = RC-REIN-AHPRM (SUB2)
 14321         MOVE 'X' TO RC-OLD-ISS (SUB2)
 14322         MOVE 'X' TO RC-NEW-ISS (SUB1).
 14323
 14324     IF REIN-LFRFND (SUB1) = RC-REIN-LFRFND (SUB2)
 14325        AND REIN-AHRFND (SUB1) = RC-REIN-AHRFND (SUB2)
 14326         MOVE 'X' TO RC-OLD-CNC (SUB2)
 14327         MOVE 'X' TO RC-NEW-CNC (SUB1).
 14328
 14329     IF REIN-LFCLM (SUB1) = RC-REIN-LFCLM (SUB2)
 14330         MOVE 'X' TO RC-OLD-LF-CLM (SUB2)
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 280
* ECS010Z.cbl
 14331         MOVE 'X' TO RC-NEW-LF-CLM (SUB1).
 14332
 14333     IF REIN-AHCLM (SUB1) = RC-REIN-AHCLM (SUB2)
 14334         MOVE 'X' TO RC-OLD-AH-CLM (SUB2)
 14335         MOVE 'X' TO RC-NEW-AH-CLM (SUB1).
 14336
 14337     ADD +1 TO SUB2.
 14338     GO TO 3720-RC-REIN-LOOP-3.
 14339
 14340 3730-RC-REIN-EXTRACTS.
 14341
 14342     PERFORM 2000-INITIALIZE-DETAIL-EXTRACT THRU 2099-INIT-DTL-X.
 14343     MOVE 'R' TO DE-REIN.
 14344     MOVE 'J' TO DE-TRANS.
 14345*****PERFORM EXTRACT-DATE-RELOAD.
 14346     MOVE DETAIL-EXTRACT TO SAVE-EXTRACT.
 14347     MOVE +1 TO SUB1.
 14348
 14349 3740-RC-REIN-OLD-ISSUE.
 14350
 14351     IF RC-REIN-COMP (SUB1) = SPACES
 14352         MOVE +1 TO SUB1
 14353         GO TO 3745-RC-REIN-NEW-ISSUE.
 14354
 14355     IF RC-REIN-REM-SW (SUB1) = 'Z'
 14356         ADD +1 TO SUB1
 14357         GO TO 3740-RC-REIN-OLD-ISSUE.
 14358
 14359     IF RC-OLD-ISS (SUB1) = 'X'
 14360         ADD +1 TO SUB1
 14361         GO TO 3740-RC-REIN-OLD-ISSUE.
 14362
 14363     IF RC-REIN-LFAMT (SUB1) = ZERO
 14364        AND RC-REIN-LFPRM (SUB1) = ZERO
 14365        AND RC-REIN-AHAMT (SUB1) = ZERO
 14366        AND RC-REIN-AHPRM (SUB1) = ZERO
 14367         ADD +1 TO SUB1
 14368         GO TO 3740-RC-REIN-OLD-ISSUE.
 14369
 14370     MOVE SAVE-EXTRACT TO DETAIL-EXTRACT.
 14371     PERFORM EXTRACT-DATE-LOAD.
 14372     MOVE RC-REIN-COMP (SUB1) TO DE-REI-COMP.
 14373     MULTIPLY RC-REIN-LFAMT (SUB1) BY -1 GIVING DE-REI-LFAMT.
 14374     MULTIPLY RC-REIN-LFPRM (SUB1) BY -1 GIVING DE-REI-LFPRM.
 14375     MULTIPLY RC-REIN-AHAMT (SUB1) BY -1 GIVING DE-REI-AHAMT.
 14376     MULTIPLY RC-REIN-AHPRM (SUB1) BY -1 GIVING DE-REI-AHPRM.
 14377     PERFORM 2500-WRITE-DETAIL-EXTRACTS THRU 2599-WRT-DETAIL-X.
 14378
 14379     ADD +1 TO BC-R-ISS.
 14380     ADD +1 TO SUB1.
 14381     GO TO 3740-RC-REIN-OLD-ISSUE.
 14382
 14383 3745-RC-REIN-NEW-ISSUE.
 14384
 14385     IF REIN-COMP (SUB1) = SPACES
 14386         PERFORM 2200-BUILD-CANCEL-EXTRACT THRU
 14387                                         2259-END-CANCEL-BUILD
 14388         MOVE 'R'      TO DE-REIN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 281
* ECS010Z.cbl
 14389         MOVE 'K'      TO DE-TRANS
 14390*********PERFORM EXTRACT-DATE-RELOAD
 14391         MOVE DETAIL-EXTRACT TO SAVE-EXTRACT
 14392         MOVE +1       TO SUB1
 14393         GO TO 3750-RC-REIN-OLD-CANCEL.
 14394
 14395     IF REIN-REM-SW (SUB1) = 'Z'
 14396         ADD +1 TO SUB1
 14397         GO TO 3745-RC-REIN-NEW-ISSUE.
 14398
 14399     IF RC-NEW-ISS (SUB1) = 'X'
 14400         ADD +1 TO SUB1
 14401         GO TO 3745-RC-REIN-NEW-ISSUE.
 14402
 14403     IF REIN-LFAMT (SUB1) = ZERO
 14404        AND REIN-LFPRM (SUB1) = ZERO
 14405        AND REIN-AHAMT (SUB1) = ZERO
 14406        AND REIN-AHPRM (SUB1) = ZERO
 14407         ADD +1 TO SUB1
 14408         GO TO 3745-RC-REIN-NEW-ISSUE.
 14409
 14410     MOVE SAVE-EXTRACT      TO DETAIL-EXTRACT.
 14411     PERFORM EXTRACT-DATE-LOAD.
 14412     MOVE REIN-COMP (SUB1)  TO DE-REI-COMP.
 14413     MOVE REIN-LFAMT (SUB1) TO DE-REI-LFAMT.
 14414     MOVE REIN-LFPRM (SUB1) TO DE-REI-LFPRM.
 14415     MOVE REIN-AHAMT (SUB1) TO DE-REI-AHAMT.
 14416     MOVE REIN-AHPRM (SUB1) TO DE-REI-AHPRM.
 14417     PERFORM 2500-WRITE-DETAIL-EXTRACTS THRU 2599-WRT-DETAIL-X.
 14418
 14419     ADD +1 TO BC-R-ISS.
 14420     ADD +1 TO SUB1.
 14421     GO TO 3745-RC-REIN-NEW-ISSUE.
 14422
 14423 3750-RC-REIN-OLD-CANCEL.
 14424
 14425     IF RC-REIN-COMP (SUB1) = SPACES
 14426         MOVE +1 TO SUB1
 14427         GO TO 3755-RC-REIN-NEW-CANCEL.
 14428
 14429     IF RC-REIN-REM-SW (SUB1) = 'Z'
 14430         ADD +1 TO SUB1
 14431         GO TO 3750-RC-REIN-OLD-CANCEL.
 14432
 14433     IF RC-OLD-CNC (SUB1) = 'X'
 14434         ADD +1 TO SUB1
 14435         GO TO 3750-RC-REIN-OLD-CANCEL.
 14436
 14437     IF RC-REIN-LFRFND (SUB1) = ZERO
 14438        AND RC-REIN-AHRFND (SUB1) = ZERO
 14439         ADD +1 TO SUB1
 14440         GO TO 3750-RC-REIN-OLD-CANCEL.
 14441
 14442     MOVE SAVE-EXTRACT        TO DETAIL-EXTRACT.
 14443     PERFORM EXTRACT-DATE-LOAD.
 14444     MOVE RC-REIN-COMP (SUB1) TO DE-REI-COMP.
 14445     MULTIPLY RC-REIN-LFRFND (SUB1) BY -1 GIVING DE-REI-LFRFND.
 14446     MULTIPLY RC-REIN-AHRFND (SUB1) BY -1 GIVING DE-REI-AHRFND.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 282
* ECS010Z.cbl
 14447     PERFORM 2500-WRITE-DETAIL-EXTRACTS THRU 2599-WRT-DETAIL-X.
 14448
 14449     ADD +1 TO BC-R-CNC.
 14450     ADD +1 TO SUB1.
 14451     GO TO 3750-RC-REIN-OLD-CANCEL.
 14452
 14453 3755-RC-REIN-NEW-CANCEL.
 14454
 14455     IF REIN-COMP (SUB1) = SPACES
 14456         PERFORM 2000-INITIALIZE-DETAIL-EXTRACT
 14457         MOVE 'R' TO DE-REIN
 14458         MOVE 'L' TO DE-TRANS
 14459*********PERFORM EXTRACT-DATE-RELOAD
 14460         MOVE DETAIL-EXTRACT TO SAVE-EXTRACT
 14461         MOVE +1 TO SUB1
 14462         GO TO 3760-RC-REIN-OLD-CLAIM.
 14463
 14464     IF REIN-REM-SW (SUB1) = 'Z'
 14465         ADD +1 TO SUB1
 14466         GO TO 3755-RC-REIN-NEW-CANCEL.
 14467
 14468     IF RC-NEW-CNC (SUB1) = 'X'
 14469         ADD +1 TO SUB1
 14470         GO TO 3755-RC-REIN-NEW-CANCEL.
 14471
 14472     IF REIN-LFRFND (SUB1) = ZERO
 14473        AND REIN-AHRFND (SUB1) = ZERO
 14474         ADD +1 TO SUB1
 14475         GO TO 3755-RC-REIN-NEW-CANCEL.
 14476
 14477     MOVE SAVE-EXTRACT       TO DETAIL-EXTRACT.
 14478     PERFORM EXTRACT-DATE-LOAD.
 14479     MOVE REIN-COMP (SUB1)   TO DE-REI-COMP.
 14480     MOVE REIN-LFRFND (SUB1) TO DE-REI-LFRFND.
 14481     MOVE REIN-AHRFND (SUB1) TO DE-REI-AHRFND.
 14482     PERFORM 2500-WRITE-DETAIL-EXTRACTS THRU 2599-WRT-DETAIL-X.
 14483
 14484     ADD +1 TO BC-R-CNC.
 14485     ADD +1 TO SUB1.
 14486     GO TO 3755-RC-REIN-NEW-CANCEL.
 14487
 14488 3760-RC-REIN-OLD-CLAIM.
 14489
 14490     IF RC-REIN-COMP (SUB1) = SPACES
 14491         MOVE +1 TO SUB1
 14492         GO TO 3780-RC-REIN-NEW-CLAIM.
 14493
 14494     IF RC-REIN-REM-SW (SUB1) = 'Z'
 14495         ADD +1 TO SUB1
 14496         GO TO 3760-RC-REIN-OLD-CLAIM.
 14497
 14498     IF RC-OLD-LF-CLM (SUB1) = 'X'
 14499         GO TO 3770-RC-REIN-OLD-AH-CLM.
 14500
 14501     IF RC-REIN-LFCLM (SUB1) = ZERO
 14502         GO TO 3770-RC-REIN-OLD-AH-CLM.
 14503
 14504     MOVE SAVE-EXTRACT         TO DETAIL-EXTRACT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 283
* ECS010Z.cbl
 14505     PERFORM EXTRACT-DATE-LOAD.
 14506     MOVE RC-REIN-COMP (SUB1)  TO DE-REI-COMP.
 14507     MOVE RC-REIN-LFAMT (SUB1) TO DE-REI-LFAMT.
 14508     MOVE RC-REIN-LFPRM (SUB1) TO DE-REI-LFPRM.
 14509     MOVE RC-REIN-AHAMT (SUB1) TO DE-REI-AHAMT.
 14510     MOVE RC-REIN-AHPRM (SUB1) TO DE-REI-AHPRM.
 14511     MULTIPLY RC-REIN-LFCLM (SUB1) BY -1 GIVING DE-REI-CLAIM-AMT.
 14512     MOVE CR-DTHAMT     TO DE-CLAIM-AMT.
 14513     ADD  CR-DTHEXP     TO DE-CLAIM-AMT.
 14514     MOVE CR-DTH-PAY-DT TO DE-PAY
 14515                           WS-DE-PAY-N.
 14516
 14517     IF CLAS-I-BAL (CLAS-INDEXL) = 'B'
 14518         MOVE '3' TO DE-TYPE
 14519     ELSE
 14520         MOVE '1' TO DE-TYPE.
 14521
 14522     PERFORM 2500-WRITE-DETAIL-EXTRACTS THRU 2599-WRT-DETAIL-X.
 14523
 14524     ADD +1 TO BC-R-CLM.
 14525
 14526 3770-RC-REIN-OLD-AH-CLM.
 14527
 14528     IF RC-OLD-AH-CLM (SUB1) = 'X'
 14529         ADD +1 TO SUB1
 14530         GO TO 3760-RC-REIN-OLD-CLAIM.
 14531
 14532     IF RC-REIN-AHCLM (SUB1) = ZERO
 14533         ADD +1 TO SUB1
 14534         GO TO 3760-RC-REIN-OLD-CLAIM.
 14535
 14536     MOVE SAVE-EXTRACT         TO DETAIL-EXTRACT.
 14537     PERFORM EXTRACT-DATE-LOAD.
 14538     MOVE RC-REIN-COMP (SUB1)  TO DE-REI-COMP.
 14539     MOVE RC-REIN-LFAMT (SUB1) TO DE-REI-LFAMT.
 14540     MOVE RC-REIN-LFPRM (SUB1) TO DE-REI-LFPRM.
 14541     MOVE RC-REIN-AHAMT (SUB1) TO DE-REI-AHAMT.
 14542     MOVE RC-REIN-AHPRM (SUB1) TO DE-REI-AHPRM.
 14543     MULTIPLY RC-REIN-AHCLM (SUB1) BY -1 GIVING DE-REI-CLAIM-AMT.
 14544     MOVE CR-DISAMT     TO DE-CLAIM-AMT.
 14545     ADD  CR-DISEXP     TO DE-CLAIM-AMT.
 14546     MOVE CR-DIS-PAY-DT TO DE-PAY
 14547                           WS-DE-PAY-N.
 14548
 14549     IF CLAS-I-BAL (CLAS-INDEXA) = 'B'
 14550         MOVE '4' TO DE-TYPE
 14551     ELSE
 14552         MOVE '2' TO DE-TYPE.
 14553
 14554     PERFORM 2500-WRITE-DETAIL-EXTRACTS THRU 2599-WRT-DETAIL-X.
 14555
 14556     ADD +1 TO BC-R-CLM.
 14557     ADD +1 TO SUB1.
 14558
 14559     GO TO 3760-RC-REIN-OLD-CLAIM.
 14560
 14561 3780-RC-REIN-NEW-CLAIM.
 14562
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 284
* ECS010Z.cbl
 14563     IF REIN-COMP (SUB1) = SPACES
 14564         GO TO 3799-RC-REINSURANCE-X.
 14565
 14566     IF REIN-REM-SW (SUB1) = 'Z'
 14567         ADD +1 TO SUB1
 14568         GO TO 3780-RC-REIN-NEW-CLAIM.
 14569
 14570     IF RC-NEW-LF-CLM (SUB1) = 'X'
 14571         GO TO 3790-RC-REIN-NEW-AH-CLM.
 14572
 14573     IF REIN-LFCLM (SUB1) = ZERO
 14574         GO TO 3790-RC-REIN-NEW-AH-CLM.
 14575
 14576     MOVE SAVE-EXTRACT      TO DETAIL-EXTRACT.
 14577     PERFORM EXTRACT-DATE-LOAD.
 14578     MOVE REIN-COMP (SUB1)  TO DE-REI-COMP.
 14579     MOVE REIN-LFAMT (SUB1) TO DE-REI-LFAMT.
 14580     MOVE REIN-LFPRM (SUB1) TO DE-REI-LFPRM.
 14581     MOVE REIN-AHAMT (SUB1) TO DE-REI-AHAMT.
 14582     MOVE REIN-AHPRM (SUB1) TO DE-REI-AHPRM.
 14583     MOVE REIN-LFCLM (SUB1) TO DE-REI-CLAIM-AMT.
 14584     MOVE CR-DTHAMT         TO DE-CLAIM-AMT.
 14585     ADD  CR-DTHEXP         TO DE-CLAIM-AMT.
 14586     MOVE CR-DTH-PAY-DT     TO DE-PAY
 14587                               WS-DE-PAY-N.
 14588
 14589     IF CLAS-I-BAL (CLAS-INDEXL) = 'B'
 14590         MOVE '3' TO DE-TYPE
 14591     ELSE
 14592         MOVE '1' TO DE-TYPE.
 14593
 14594     PERFORM 2500-WRITE-DETAIL-EXTRACTS THRU 2599-WRT-DETAIL-X.
 14595
 14596     ADD +1 TO BC-R-CLM.
 14597
 14598 3790-RC-REIN-NEW-AH-CLM.
 14599
 14600     IF RC-NEW-AH-CLM (SUB1) = 'X'
 14601         ADD +1 TO SUB1
 14602         GO TO 3780-RC-REIN-NEW-CLAIM.
 14603
 14604     IF REIN-AHCLM (SUB1) = ZERO
 14605         ADD +1 TO SUB1
 14606         GO TO 3780-RC-REIN-NEW-CLAIM.
 14607
 14608     MOVE SAVE-EXTRACT      TO DETAIL-EXTRACT.
 14609     PERFORM EXTRACT-DATE-LOAD.
 14610     MOVE REIN-COMP (SUB1)  TO DE-REI-COMP.
 14611     MOVE REIN-LFAMT (SUB1) TO DE-REI-LFAMT.
 14612     MOVE REIN-LFPRM (SUB1) TO DE-REI-LFPRM.
 14613     MOVE REIN-AHAMT (SUB1) TO DE-REI-AHAMT.
 14614     MOVE REIN-AHPRM (SUB1) TO DE-REI-AHPRM.
 14615     MOVE REIN-AHCLM (SUB1) TO DE-REI-CLAIM-AMT.
 14616     MOVE CR-DISAMT         TO DE-CLAIM-AMT.
 14617     ADD  CR-DISEXP         TO DE-CLAIM-AMT.
 14618     MOVE CR-DIS-PAY-DT     TO DE-PAY
 14619                               WS-DE-PAY-N.
 14620
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 285
* ECS010Z.cbl
 14621     IF CLAS-I-BAL (CLAS-INDEXA) = 'B'
 14622         MOVE '4' TO DE-TYPE
 14623     ELSE
 14624         MOVE '2' TO DE-TYPE.
 14625
 14626     PERFORM 2500-WRITE-DETAIL-EXTRACTS THRU 2599-WRT-DETAIL-X.
 14627
 14628     ADD +1 TO BC-R-CLM.
 14629     ADD +1 TO SUB1.
 14630
 14631     GO TO 3780-RC-REIN-NEW-CLAIM.
 14632
 14633 3799-RC-REINSURANCE-X.
 14634     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 286
* ECS010Z.cbl
 14636******************************************************************
 14637***    E A R N E D   P R E M I U M   C A L C U L A T I O N S   ***
 14638******************************************************************
 14639
 14640 4000-EP-BUMP-RTN.
 14641
 14642     IF AM-RECALC-COMM = ('Y' OR '1')
 14643         PERFORM 1600-RECALC-COMM-EXTR
 14644             THRU 1899-RECALC-COMM-EXTR-X.
 14645
 14646     MOVE '1'    TO EP-FLG.
 14647     ADD +1      TO BC-G-CERTS.
 14648
 14649     MOVE CR-DT               TO HIGH-CERT.
 14650     IF CR-ACCT-CONTROL NOT = LOW-CTL
 14651         MOVE CR-DT           TO LOW-CERT
 14652         MOVE CR-ACCT-CONTROL TO LOW-CTL.
 14653
 14654     IF CR-POLICY-IS-REIN-ONLY
 14655         MOVE +0           TO GROSS-ISS-BEN-LF   GROSS-ISS-BEN-AH
 14656                              GROSS-CNC-BEN-LF   GROSS-CNC-BEN-AH
 14657                              GROSS-ISS-PRM-LF   GROSS-ISS-PRM-AH
 14658                              GROSS-CNC-PRM-LF   GROSS-CNC-PRM-AH
 14659                              DTH-IBNR           DIS-IBNR
 14660                              DTH-PAYCUR         DIS-PAYCUR
 14661                              DTH-FUTRSV         DIS-FUTRSV
 14662         GO TO 4050-EP-DO-REINSURE.
 14663
 14664     MOVE CR-LFAMT       TO WE-LFAMT.
 14665     MOVE CR-LFPRM       TO WE-LFPRM.
 14666     IF CR-LFTYP NOT = ZEROS
 14667         IF CLAS-I-EP (CLAS-INDEXL) = 'B'
 14668             MOVE CR-LFAMT-ALT        TO WE-LFAMT-ALT
 14669             MOVE CR-LFPRM-ALT        TO WE-LFPRM-ALT
 14670         ELSE
 14671             MOVE ZEROS               TO WE-LFAMT-ALT
 14672                                         WE-LFPRM-ALT.
 14673
 14674     MOVE SPACES         TO REIN-EP-FLG
 14675                            WE-REIN-CO.
 14676     MOVE CR-LFRFND      TO WE-LFRFND.
 14677     MOVE CR-DTHAMT      TO WE-DTHAMT.
 14678     ADD  CR-DTHEXP      TO WE-DTHAMT.
 14679     MOVE CR-DTHEXP      TO WE-DTHEXP.
 14680     MOVE CR-NUM-DTH-CLM TO WE-NUM-DTH-CLM.
 14681     MOVE DTH-IBNR       TO WE-DTH-IBNR.
 14682     MOVE DTH-PAYCUR     TO WE-DTH-PAYCUR.
 14683     MOVE DTH-FUTRSV     TO WE-DTH-FUTRSV.
 14684
 14685     MOVE CR-AHPRM       TO WE-AHPRM.
 14686     MOVE CR-AHAMT       TO WE-AHAMT.
 14687     MOVE CR-AHRFND      TO WE-AHRFND.
 14688     MOVE CR-DISAMT      TO WE-DSPY-AMT.
 14689     ADD  CR-DISEXP      TO WE-DSPY-AMT.
 14690     MOVE CR-DISEXP      TO WE-DSPY-EXP.
 14691     MOVE CR-NUM-DIS-CLM TO WE-NUM-DIS-CLM.
 14692     MOVE DIS-IBNR       TO WE-DIS-IBNR.
 14693     MOVE DIS-PAYCUR     TO WE-DIS-PAYCUR.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 287
* ECS010Z.cbl
 14694     MOVE DIS-FUTRSV     TO WE-DIS-FUTRSV.
 14695
 14696     IF CR-POLICY-IS-RESTORE  OR
 14697        CR-POLICY-IS-REISSUE
 14698        OR CR-POLICY-IS-MONTHLY
 14699         MOVE ZEROS      TO WE-LFPRM
 14700                            WE-LFPRM-ALT
 14701                            WE-AHPRM.
 14702
 14703     MOVE +0               TO GROSS-ISS-BEN-LF   GROSS-ISS-BEN-AH
 14704                              GROSS-CNC-BEN-LF   GROSS-CNC-BEN-AH
 14705                              GROSS-ISS-PRM-LF   GROSS-ISS-PRM-AH
 14706                              GROSS-CNC-PRM-LF   GROSS-CNC-PRM-AH
 14707                              DTH-IBNR           DIS-IBNR
 14708                              DTH-PAYCUR         DIS-PAYCUR
 14709                              DTH-FUTRSV         DIS-FUTRSV.
 14710
 14711     PERFORM 4100-EP-DO-LF THRU 4299-EPBX.
 14712
 14713     IF CR-POLICY-IS-DECLINED  OR
 14714        CR-POLICY-IS-VOID
 14715         GO TO 4099-EP-BUMP-RTN-X.
 14716
 14717 4050-EP-DO-REINSURE.
 14718
 14719     MOVE 'R' TO REIN-EP-FLG.
 14720     MOVE +1  TO SUB5.
 14721
 14722 4090-EP-DO-REINSURE-LOOP.
 14723
 14724     IF REIN-COMP (SUB5) = SPACES
 14725         MOVE SPACE TO REIN-EP-FLG
 14726         GO TO 4099-EP-BUMP-RTN-X.
 14727
 14728     IF REIN-REM-SW (SUB5) = 'Z'  OR
 14729        REIN-LF-AH-FLGS (SUB5) = SPACES
 14730         ADD +1 TO SUB5
 14731         GO TO 4090-EP-DO-REINSURE-LOOP.
 14732
 14733     PERFORM REIN-FIND-CO-LOOP THRU FIND-REI-CO-EXIT
 14734        VARYING CO-SUB FROM 1 BY 1 UNTIL
 14735          (RCT-REIN-CO (CO-SUB) = REIN-COMP (SUB5))  OR
 14736          (CO-SUB GREATER REIN-CO-TABLE-ENT-CNT)     OR
 14737          (RCT-REIN-CO (CO-SUB) = SPACES).
 14738
 14739     IF (CO-SUB GREATER REIN-CO-TABLE-ENT-CNT)  OR
 14740        (RCT-REIN-CO (CO-SUB) = SPACES)
 14741        MOVE ZERO TO CO-SUB.
 14742
 14743     ADD +1 TO BC-R-CERTS.
 14744     MOVE REIN-COMP (SUB5)      TO WE-REIN-CO.
 14745     MOVE REIN-WORK-FLDS (SUB5) TO RWF-FIELDS.
 14746     MOVE RE-COMP-INFO (SUB5)   TO WT-COMP-INFO
 14747
 14748     IF DTE-CLIENT = 'DCC'
 14749        COMPUTE WS-CEDE-FACT =
 14750           RWF-LFAMT / (CR-LFAMT + CR-LFAMT-ALT)
 14751        IF AM-RECALC-COMM = ('Y' OR '1')
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 288
* ECS010Z.cbl
 14752           COMPUTE RWF-LFPRM = CR-LF-NSP-PRM * WS-CEDE-FACT
 14753*          COMPUTE RWF-LFRFND ROUNDED = CR-LF-NSP-PRM
 14754*          / (CR-LFPRM + CR-LFPRM-ALT) * CR-LFRFND
 14755           COMPUTE RWF-LFRFND ROUNDED = (CR-LFRFND
 14756           / (CR-LFPRM + CR-LFPRM-ALT)) * CR-LF-NSP-PRM
 14757        END-IF
 14758     END-IF
 14759
 14760     MOVE RWF-LFPRM      TO WE-LFPRM.
 14761     MOVE RWF-LFAMT      TO WE-LFAMT.
 14762     MOVE RWF-LFRFND     TO WE-LFRFND.
 14763     MOVE RWF-LFCLM      TO WE-DTHAMT.
 14764     MOVE RWF-DTH-IBNR   TO WE-DTH-IBNR.
 14765     MOVE RWF-DTH-PAYCUR TO WE-DTH-PAYCUR.
 14766     MOVE RWF-DTH-FUTRSV TO WE-DTH-FUTRSV.
 14767     MOVE +0             TO WE-LFAMT-ALT
 14768                            WE-LFPRM-ALT
 14769                            WE-DTHEXP
 14770                            WE-NUM-DTH-CLM.
 14771
 14772     IF (DTE-CLIENT EQUAL 'NSL') AND
 14773        (CR-REIN-TABLE EQUAL 'NAR')
 14774        CONTINUE
 14775     ELSE
 14776      IF CLAS-I-EP (CLAS-INDEXL) EQUAL 'B'
 14777       IF (CR-LFAMT + CR-LFAMT-ALT) GREATER THAN +0
 14778        COMPUTE WS-CEDE-FACT ROUNDED EQUAL
 14779            RWF-LFAMT / (CR-LFAMT + CR-LFAMT-ALT)
 14780        COMPUTE WE-LFAMT ROUNDED EQUAL
 14781                           CR-LFAMT * WS-CEDE-FACT
 14782        COMPUTE WE-LFAMT-ALT ROUNDED EQUAL
 14783                           CR-LFAMT-ALT * WS-CEDE-FACT
 14784        IF (DTE-CLIENT = 'CID')
 14785           AND (CR-LF-NSP-PRM > +0)
 14786           AND (CR-ENTRY-DATE > 20030430)
 14787           AND (WT-LF-QC NOT = '1' AND '3')
 14788           COMPUTE WE-LFPRM = CR-LF-NSP-PRM * WS-CEDE-FACT
 14789           MOVE +0            TO WE-LFPRM-ALT
 14790        ELSE
 14791           COMPUTE WE-LFPRM ROUNDED EQUAL
 14792                           CR-LFPRM * WS-CEDE-FACT
 14793           COMPUTE WE-LFPRM-ALT ROUNDED EQUAL
 14794                           CR-LFPRM-ALT * WS-CEDE-FACT
 14795        END-IF
 14796        IF (DTE-CLIENT = 'CID')
 14797           AND (CR-LF-NSP-PRM > +0)
 14798           AND (CR-LFRFND-CALC > +0)
 14799           AND (CR-LF-CANCEL-EXIT-DATE > 20030430)
 14800           AND (WT-LF-QC NOT = '1' AND '4')
 14801           COMPUTE WS-WE-LFPRM = CR-LF-NSP-PRM * WS-CEDE-FACT
 14802           COMPUTE WE-LFRFND = (CR-LFRFND-CALC / (CR-LFPRM
 14803              + CR-LFPRM-ALT)) * (WS-WE-LFPRM)
 14804        END-IF
 14805       ELSE
 14806         MOVE +0 TO WS-CEDE-FACT
 14807       END-IF
 14808      END-IF
 14809     END-IF
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 289
* ECS010Z.cbl
 14810
 14811     IF DTE-CLIENT = 'DCC'
 14812        IF AM-RECALC-COMM = ('Y' OR '1')
 14813           COMPUTE WS-CEDE-FACT =
 14814               RWF-AHAMT / CR-AHAMT
 14815           COMPUTE RWF-AHPRM = CR-AH-NSP-PRM * WS-CEDE-FACT
 14816           COMPUTE RWF-AHRFND ROUNDED = CR-AH-NSP-PRM
 14817           / CR-AHPRM * CR-AHRFND
 14818        END-IF
 14819     END-IF
 14820
 14821     MOVE RWF-AHPRM      TO WE-AHPRM.
 14822
 14823     MOVE RWF-AHAMT      TO WE-AHAMT
 14824     MOVE RWF-AHRFND     TO WE-AHRFND.
 14825     MOVE RWF-AHCLM      TO WE-DSPY-AMT.
 14826     MOVE +0             TO WE-DSPY-EXP
 14827                            WE-NUM-DIS-CLM.
 14828     MOVE RWF-DIS-IBNR   TO WE-DIS-IBNR.
 14829     MOVE RWF-DIS-PAYCUR TO WE-DIS-PAYCUR.
 14830     MOVE RWF-DIS-FUTRSV TO WE-DIS-FUTRSV.
 14831
 14832     IF  RWF-LF-RUNOFF-SW = 'N'
 14833             OR
 14834         RWF-AH-RUNOFF-SW = 'N'
 14835         PERFORM 8000R-CONVERT-STOP-DATE THRU 8099R-STOP-DATE-X.
 14836
 14837     IF  RWF-LF-RUNOFF-SW = 'N'
 14838         MOVE EARNING-STOP-DATE    TO STOP-LF-DATE
 14839     ELSE
 14840         MOVE 99999999             TO STOP-LF-DATE.
 14841
 14842     IF  RWF-AH-RUNOFF-SW = 'N'
 14843         MOVE EARNING-STOP-DATE    TO STOP-AH-DATE
 14844     ELSE
 14845         MOVE 99999999             TO STOP-AH-DATE.
 14846
 14847     IF CR-POLICY-IS-RESTORE  OR
 14848        CR-POLICY-IS-REISSUE
 14849        OR CR-POLICY-IS-MONTHLY
 14850         MOVE ZEROS      TO WE-LFPRM
 14851                            WE-LFPRM-ALT
 14852                            WE-AHPRM.
 14853
 14854     PERFORM 4100-EP-DO-LF THRU 4299-EPBX.
 14855
 14856     IF CO-SUB NOT = ZERO
 14857       IF RCT-EARNING-START-DT (CO-SUB) NOT = ZERO
 14858         IF CR-DT LESS THAN RCT-EARNING-START-DT (CO-SUB)
 14859             PERFORM S-4100-EP-DO-LF THRU S-4299-EPBX.
 14860
 14861     ADD +1 TO SUB5.
 14862     GO TO 4090-EP-DO-REINSURE-LOOP.
 14863
 14864 4099-EP-BUMP-RTN-X.
 14865     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 290
* ECS010Z.cbl
 14867******************************************************************
 14868***  C A L C U L A T E   L I F E   E A R N E D   P R E M I U M ***
 14869******************************************************************
 14870
 14871 4100-EP-DO-LF.
 14872
 14873     MOVE +0                         TO ISS-BEN  EPR-R78
 14874                                        CNC-BEN  EPR-PRO
 14875                                        ISS-PRM  EPR-ST
 14876                                        ISS-PRMTAX
 14877                                        CNC-PRM  ACTIVE-COUNT.
 14878     MOVE SPACE                      TO LIFE-EARNED-SWITCH.
 14879
 14880     IF CR-LFTYP = ZERO
 14881         GO TO 4200-EP-DO-AH.
 14882
 14883     IF REIN-EP-FLG = 'R'
 14884         IF REIN-LF-FLG (SUB5) = SPACE
 14885             GO TO 4200-EP-DO-AH.
 14886
 14887     IF CR-APR NOT NUMERIC
 14888         MOVE ZERO TO CR-APR.
 14889
 14890     MOVE LIFE-OVERRIDE-L1       TO WE-LF-AH.
 14891     MOVE CR-LFTYP               TO WE-BEN-TYPE.
 14892     PERFORM 4400-EP-FIND-TAB-ENT THRU 4499-EP-FIND-TAB-ENT-X.
 14893
 14894     IF CR-POLICY-IS-DECLINED  OR
 14895        CR-POLICY-IS-VOID
 14896         GO TO 4191-CONTINUE.
 14897
 14898     MOVE CR-LF-TERM             TO ORIG-TERM.
 14899     MOVE CLAS-INDEXL            TO W-NDX.
 14900
 14901     IF CR-DT GREATER EW-COV-DTE
 14902         MOVE CR-DT              TO EW-COV-DTE.
 14903
 14904     IF (NOT CR-POLICY-IS-RESTORE) AND
 14905        (NOT CR-POLICY-IS-REISSUE)
 14906        AND (NOT CR-POLICY-IS-MONTHLY)
 14907         COMPUTE ISS-BEN = WE-LFAMT + WE-LFAMT-ALT
 14908         IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'Z'
 14909             ADD CR-LIVES TO EW-ISS-CNT
 14910             COMPUTE EW-ORIG-TERM = EW-ORIG-TERM +
 14911                                    (ORIG-TERM * CR-LIVES)
 14912             COMPUTE EW-AGE = EW-AGE + (CR-AGE * CR-LIVES)
 14913             COMPUTE EW-AGE-BEN = EW-AGE-BEN + (CR-AGE * ISS-BEN)
 14914             COMPUTE EW-TERM-BEN = EW-TERM-BEN +
 14915                                   (ORIG-TERM * ISS-BEN)
 14916         ELSE
 14917             ADD +1 TO EW-ISS-CNT
 14918             COMPUTE EW-ORIG-TERM = EW-ORIG-TERM + ORIG-TERM
 14919             COMPUTE EW-AGE = EW-AGE + CR-AGE
 14920             COMPUTE EW-AGE-BEN = EW-AGE-BEN + (CR-AGE * ISS-BEN)
 14921             COMPUTE EW-TERM-BEN = EW-TERM-BEN +
 14922                                   (ORIG-TERM * ISS-BEN).
 14923
 14924     MOVE RUN-DATE        TO VALUATION-DT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 291
* ECS010Z.cbl
 14925     MOVE '2'             TO W-VAL-SOURCE.
 14926
 14927     IF REIN-EP-FLG = 'R'
 14928         IF REIN-LF-RUNOFF-SW (SUB5) = 'N' AND
 14929            EARNING-STOP-DATE LESS THAN VALUATION-DT
 14930             MOVE EARNING-STOP-DATE TO VALUATION-DT
 14931             MOVE '10'              TO W-VAL-SOURCE.
 14932
 14933     PERFORM 8500-REMAINING-TERM-ROUTINE THRU 8599-REM-TERM-X.
 14934
 14935     IF (CR-LF-CURRENT-STATUS = '1' OR '4') AND
 14936        (REM-TRM3 GREATER ZERO)
 14937        IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'Z'
 14938            COMPUTE EW-INFORCE-CNT = EW-INFORCE-CNT +
 14939                                  (CR-LIVES - CR-SUM-CAN-CNT-ITD)
 14940            COMPUTE EW-REM-TERM = EW-REM-TERM +
 14941                     (REM-TRM3 * (CR-LIVES - CR-SUM-CAN-CNT-ITD))
 14942          ELSE
 14943            COMPUTE EW-INFORCE-CNT = EW-INFORCE-CNT + 1
 14944            COMPUTE EW-REM-TERM = EW-REM-TERM + REM-TRM3.
 14945
 14946     COMPUTE ISS-PRM = WE-LFPRM + WE-LFPRM-ALT.
 14947
 14948     IF DTE-CLIENT = 'GIC'
 14949         IF REIN-EP-FLG NOT = 'R'  AND
 14950            CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'B'  AND
 14951            (CR-ENTRY-STATUS NOT = '5' AND '3' AND 'M')
 14952            MOVE CR-LFPRM-CALC TO ISS-PRM.
 14953
 14954     IF  DTE-OPT-RESERVE-METHOD-UNAUTH
 14955         GO TO 4105-EP-DO-LF-REIN-CHK.
 14956
 14957     IF  CR-DT NOT GREATER THAN EOM-DATE (13)
 14958             AND
 14959         CR-LF-EXPIRE-DATE GREATER THAN EOM-DATE (1)
 14960             AND
 14961         (CR-LF-CANC-DT GREATER THAN EOM-DATE (1)
 14962                 OR
 14963             CR-LF-CANC-DT EQUAL ZEROS)
 14964             AND
 14965         (CR-LF-CLAIM-EXIT-DATE GREATER THAN EOM-DATE (1)
 14966                 OR
 14967             CR-LF-CLAIM-EXIT-DATE EQUAL ZEROS)
 14968         MOVE 'Y'               TO  EPEC-LIFE-CTR-USED-IND (SUB3)
 14969         PERFORM 4194-SLOT-INTO-EFFECTED-MONTHS THRU 4194-EXIT
 14970                 VARYING
 14971             SUBM FROM +1 BY +1
 14972                 UNTIL
 14973             SUBM GREATER THAN +13.
 14974
 14975     MOVE EW-SUB-KEY             TO EPEC-SUB-KEY-OPT (SUB3).
 14976     MOVE EW-REIN-CO             TO EPEC-REIN-CO-OPT (SUB3).
 14977
 14978 4105-EP-DO-LF-REIN-CHK.
 14979
 14980     IF REIN-EP-FLG = 'R'  AND
 14981        REIN-LF-RUNOFF-SW (SUB5) = 'N'
 14982         NEXT SENTENCE
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 292
* ECS010Z.cbl
 14983     ELSE
 14984         GO TO 4110-EP-DO-LF-CLM.
 14985
 14986     IF CR-LF-STATUS-AT-CANCEL NOT = ' '
 14987         IF CR-LF-CANC-DT GREATER THAN EARNING-STOP-DATE
 14988             GO TO 4130-EP-DO-LF-EP.
 14989
 14990     IF CR-LF-STATUS-AT-DEATH NOT = ' '
 14991         IF CR-DTH-DT GREATER THAN EARNING-STOP-DATE
 14992             GO TO 4130-EP-DO-LF-EP.
 14993
 14994 4110-EP-DO-LF-CLM.
 14995
 14996     IF  EPEC-CLM-EXP (SUB3)  NUMERIC
 14997         NEXT  SENTENCE
 14998       ELSE
 14999         MOVE ZEROS TO EPEC-CLM-EXP (SUB3).
 15000
 15001     ADD WE-DTHAMT      TO EW-CLM-AMT.
 15002     ADD WE-DTHEXP      TO EPEC-CLM-EXP (SUB3).
 15003
 15004     IF CR-LF-STATUS-AT-DEATH = ' '
 15005         IF CLAS-I-CALC-TYPE (CLAS-INDEXL) NOT = 'B'
 15006             GO TO 4115-EP-DO-LF-CLM-EPR.
 15007
 15008     ADD WE-NUM-DTH-CLM TO EW-CLM-CNT.
 15009     ADD +1             TO EW-CLM-CRT.
 15010
 15011 4115-EP-DO-LF-CLM-EPR.
 15012
 15013     IF CR-LF-STATUS-AT-DEATH NOT = ' '
 15014         COMPUTE EPR-R78 = WE-LFPRM + WE-LFPRM-ALT
 15015         MOVE EPR-R78 TO EPR-PRO  EPR-ST
 15016     END-IF
 15017     .
 15018 4120-EP-DO-LF-CNCL.
 15019
 15020     IF CR-LF-STATUS-AT-CANCEL = ' '  AND
 15021        CLAS-I-CALC-TYPE (CLAS-INDEXL) NOT = 'Z'
 15022         IF CR-LF-STATUS-AT-DEATH NOT = ' '
 15023             GO TO 4190-EP-DO-LF-COMM
 15024         ELSE
 15025             GO TO 4130-EP-DO-LF-EP.
 15026
 15027     IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'Z'
 15028         ADD CR-SUM-CAN-CNT-ITD TO EW-CNC-CNT
 15029         GO TO 4124-EP-DO-LF-CNCL-SUM.
 15030
 15031     ADD +1                       TO EW-CNC-CNT.
 15032
 15033     MOVE WE-LFRFND               TO CNC-PRM.
 15034
 15035     IF DTE-CLIENT = 'GIC'
 15036         IF REIN-EP-FLG NOT = 'R'  AND
 15037            CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'B'
 15038             MOVE CR-LFRFND-CALC TO CNC-PRM.
 15039
 15040     MOVE CR-DT                 TO  DC-GREG-DATE-CYMD.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 293
* ECS010Z.cbl
 15041     MOVE 'L'                   TO  DC-OPTION-CODE.
 15042     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 15043     MOVE DC-BIN-DATE-1         TO  WS-CR-BIN-DATE.
 15044
 15045     MOVE CR-LF-CANC-DT         TO  DC-GREG-DATE-CYMD.
 15046     MOVE 'L'                   TO  DC-OPTION-CODE.
 15047     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 15048     MOVE DC-BIN-DATE-1         TO  WS-BIN-CANCEL-DATE.
 15049
 15050     MOVE WS-CR-BIN-DATE          TO  DC-BIN-DATE-1.
 15051     MOVE WS-BIN-CANCEL-DATE      TO  DC-BIN-DATE-2.
 15052     MOVE '1'                     TO  DC-OPTION-CODE.
 15053     MOVE ZEROS                   TO  MONTHS-DIFF-LF.
 15054     MOVE ' '                     TO  DC-CENTURY-ADJUSTMENT.
 15055     MOVE ZEROS                   TO  DC-ELAPSED-MONTHS
 15056                                      DC-ODD-DAYS-OVER
 15057                                      DC-ELAPSED-DAYS.
 15058     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 15059     MOVE DC-ELAPSED-MONTHS       TO  MONTHS-DIFF-LF.
 15060
 15061     IF DC-ODD-DAYS-OVER   GREATER THAN  ZERO
 15062         ADD  +1                  TO  MONTHS-DIFF-LF.
 15063
 15064     MOVE  'YYYYYYYYYY'           TO  WS-LF-CHARGEBACK-LEVELS.
 15065
 15066     IF DTE-CLIENT = 'ACE'
 15067         GO TO 4120-CONTINUE-LIFE-CANCEL.
 15068
 15069     MOVE  ZEROS                  TO  SUB.
 15070
 15071 4120-LIFE-CHARGEBACK-LOOP.
 15072
 15073     ADD    +1                    TO  SUB.
 15074
 15075     IF  SUB  GREATER THAN  +10
 15076         GO TO  4120-CONTINUE-LIFE-CANCEL.
 15077
 15078     IF  AM-COMM-CHARGEBACK (SUB)  NOT  NUMERIC  OR
 15079         AM-COMM-CHARGEBACK (SUB)  =  ZEROS
 15080         GO TO  4120-LIFE-CHARGEBACK-LOOP.
 15081
 15082     IF  AM-COMM-CHARGEBACK (SUB)  EQUAL    '99'
 15083         MOVE  'N'    TO  WS-LF-CHARGEBACK-SW (SUB).
 15084
 15085     IF  MONTHS-DIFF-LF GREATER THAN AM-COMM-CHARGEBACK (SUB)
 15086         MOVE  'N'        TO  WS-LF-CHARGEBACK-SW (SUB).
 15087
 15088     GO TO  4120-LIFE-CHARGEBACK-LOOP.
 15089
 15090
 15091 4120-CONTINUE-LIFE-CANCEL.
 15092
 15093     COMPUTE EPR-R78 = (WE-LFPRM + WE-LFPRM-ALT) - WE-LFRFND.
 15094     MOVE EPR-R78 TO EPR-PRO  EPR-ST.
 15095
 15096     IF WE-LFRFND = +0 AND WE-DTHAMT NOT = +0
 15097         GO TO 4190-EP-DO-LF-COMM.
 15098
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 294
* ECS010Z.cbl
 15099     IF CLAS-I-RL-AH (CLAS-INDEXL) = 'L' OR 'P'
 15100         COMPUTE CNC-BEN = WE-LFAMT + WE-LFAMT-ALT
 15101         GO TO 4190-EP-DO-LF-COMM.
 15102
 15103     MOVE CR-LF-CANC-DT TO VALUATION-DT.
 15104     MOVE '3'           TO W-VAL-SOURCE.
 15105     PERFORM 8500-REMAINING-TERM-ROUTINE THRU 8599-REM-TERM-X.
 15106
 15107     IF REM-TRM3 = CR-LF-TERM
 15108         COMPUTE CNC-BEN = WE-LFAMT + WE-LFAMT-ALT
 15109         GO TO 4190-EP-DO-LF-COMM.
 15110
 15111     IF CLAS-I-EP (CLAS-INDEXL) = 'T'
 15112         GO TO 4122-EP-DO-LF-CNCL-TEX.
 15113
 15114     IF DTE-CLIENT = 'NCL'
 15115         IF CR-DT LESS THAN 19910101
 15116             GO TO 4121-EP-DO-LF-CNC-BEN.
 15117
 15118     IF CLAS-I-EP (CLAS-INDEXL) = 'N'
 15119         GO TO 4126-EP-DO-LF-CNCL-NP.
 15120
 15121     IF DTE-CLIENT = 'FUL'
 15122         GO TO 4128-EP-DO-LF-CNCL-FUL.
 15123
 15124*    IF STATE-ABBR (CLAS-INDEXS) = 'OH'
 15125     IF (STATE-ABBR (CLAS-INDEXS) = 'OH') AND
 15126        (CR-RATING-CLASS NOT = 'L ')
 15127         IF (CR-APR GREATER THAN ZERO)  AND
 15128            (CR-LF-TERM GREATER THAN 060)  AND
 15129            (CR-DT GREATER THAN 19831031)
 15130              GO TO 4126-EP-DO-LF-CNCL-NP.
 15131
 15132     IF STATE-ABBR (CLAS-INDEXS) = 'MT'
 15133         IF (CR-APR GREATER THAN ZERO)  AND
 15134            (CR-LF-TERM GREATER THAN 061)  AND
 15135            (CR-DT GREATER THAN 19830318)
 15136              GO TO 4126-EP-DO-LF-CNCL-NP.
 15137
 15138     IF STATE-ABBR (CLAS-INDEXS) = 'UT'
 15139         IF (CR-APR GREATER THAN ZERO)  AND
 15140            (CR-LF-TERM GREATER THAN 062)  AND
 15141            (CR-DT GREATER THAN 19810831)  AND
 15142            (CR-DT LESS THAN 19830901)
 15143              GO TO 4126-EP-DO-LF-CNCL-NP.
 15144
 15145     IF STATE-ABBR (CLAS-INDEXS) = 'RI'
 15146         IF (CR-APR GREATER THAN ZERO)  AND
 15147            (CR-LF-TERM GREATER THAN 060)  AND
 15148            (CR-DT GREATER THAN 19831231)
 15149              GO TO 4126-EP-DO-LF-CNCL-NP.
 15150
 15151 4121-EP-DO-LF-CNC-BEN.
 15152
 15153     COMPUTE TEMP-4 ROUNDED EQUAL REM-TRM3 / CR-LF-TERM.
 15154
 15155     COMPUTE TEMP-3 ROUNDED EQUAL
 15156         (WE-LFAMT + WE-LFAMT-ALT) * TEMP-4.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 295
* ECS010Z.cbl
 15157
 15158     MOVE TEMP-3                 TO CNC-BEN.
 15159
 15160     GO TO 4190-EP-DO-LF-COMM.
 15161
 15162 4122-EP-DO-LF-CNCL-TEX.
 15163
 15164     DIVIDE WE-LFAMT BY CR-LF-TERM
 15165         GIVING TEX-FACT-1.
 15166     DIVIDE REM-TRM3 BY CR-PMT-FREQ
 15167         GIVING TEX-FACT-2
 15168             REMAINDER TEX-FACT-3.
 15169     IF TEX-FACT-3 NOT = ZERO
 15170         ADD +1 TO TEX-FACT-2.
 15171
 15172     COMPUTE CNC-BEN = (TEX-FACT-1 * (TEX-FACT-2 * CR-PMT-FREQ)).
 15173
 15174     GO TO 4190-EP-DO-LF-COMM.
 15175
 15176 4124-EP-DO-LF-CNCL-SUM.
 15177
 15178     IF WE-LFRFND = ZERO
 15179         GO TO 4130-EP-DO-LF-EP.
 15180
 15181     MOVE WE-LFRFND TO CNC-PRM.
 15182
 15183     MOVE  'YYYYYYYYYY'           TO  WS-LF-CHARGEBACK-LEVELS.
 15184
 15185     IF WE-LFRFND NOT LESS WE-LFPRM
 15186         MOVE WE-LFAMT TO CNC-BEN
 15187          GO TO 4130-EP-DO-LF-EP.
 15188
 15189
 15190     COMPUTE TEMP-7 ROUNDED = WE-LFAMT * (WE-LFRFND / WE-LFPRM).
 15191
 15192     IF CLAS-I-RL-AH (CLAS-INDEXL) = 'L' OR 'P'
 15193         MOVE TEMP-7 TO CNC-BEN
 15194          GO TO 4130-EP-DO-LF-EP.
 15195
 15196     MOVE CR-LF-CANC-DT TO VALUATION-DT.
 15197     MOVE '4'           TO W-VAL-SOURCE.
 15198     PERFORM 8500-REMAINING-TERM-ROUTINE THRU 8599-REM-TERM-X.
 15199
 15200     IF CLAS-I-EP (CLAS-INDEXL) NOT = 'N'
 15201         COMPUTE CNC-BEN = TEMP-7 * (REM-TRM3 / CR-LF-TERM)
 15202         GO TO 4130-EP-DO-LF-EP.
 15203
 15204 4126-EP-DO-LF-CNCL-NP.
 15205
 15206     IF WE-LFAMT = ZERO
 15207        GO TO 4190-EP-DO-LF-COMM.
 15208
 15209     MOVE CR-DT                      TO  DC-GREG-DATE-CYMD.
 15210     MOVE 'L'                        TO  DC-OPTION-CODE.
 15211     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 15212     MOVE DC-BIN-DATE-1              TO  CP-CERT-EFF-DT.
 15213
 15214     IF CR-LOAN-1ST-PMT-DT NOT = ZEROS
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 296
* ECS010Z.cbl
 15215       MOVE CR-LOAN-1ST-PMT-DT       TO  DC-GREG-DATE-1-YMD
 15216       MOVE '3'                      TO  DC-OPTION-CODE
 15217       PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X
 15218       MOVE DC-BIN-DATE-1            TO  CP-FIRST-PAY-DATE
 15219     ELSE
 15220       MOVE CP-CERT-EFF-DT           TO  DC-BIN-DATE-1
 15221       MOVE '6'                      TO  DC-OPTION-CODE
 15222       MOVE +1                       TO  DC-ELAPSED-MONTHS
 15223       MOVE +0                       TO  DC-ELAPSED-DAYS
 15224       PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X
 15225       MOVE DC-BIN-DATE-2            TO  CP-FIRST-PAY-DATE.
 15226
 15227     MOVE CR-LFAMT                   TO  CP-ORIGINAL-BENEFIT.
 15228     MOVE CR-APR                     TO  CP-LOAN-APR.
 15229     MOVE CR-LF-TERM                 TO  CP-ORIGINAL-TERM.
 15230     MOVE CR-LOAN-TERM               TO  CP-LOAN-TERM.
 15231     MOVE REM-TRM3                   TO  CP-REMAINING-TERM.
 15232     MOVE CLAS-I-CALC-TYPE (CLAS-INDEXL) TO  CP-SPECIAL-CALC-CD.
 15233     MOVE CLAS-I-RL-AH     (CLAS-INDEXL) TO  CP-BENEFIT-TYPE.
 15234     MOVE CLAS-I-EP        (CLAS-INDEXL) TO  CP-EARNING-METHOD.
 15235
 15236     CALL 'ELRAMTX' USING CALCULATION-PASS-AREA.
 15237
 15238     IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'Z'
 15239       COMPUTE CNC-BEN = (CP-REMAMT-FACTOR * (TEMP-7 / +1000))
 15240       GO TO 4130-EP-DO-LF-EP
 15241     ELSE
 15242       COMPUTE CNC-BEN = (CP-REMAMT-FACTOR * (WE-LFAMT / +1000)).
 15243
 15244     GO TO 4190-EP-DO-LF-COMM.
 15245
 15246 4128-EP-DO-LF-CNCL-FUL.
 15247
 15248     IF WE-LFAMT = ZERO
 15249        GO TO 4190-EP-DO-LF-COMM.
 15250
 15251     MOVE CR-APR              TO NP-APR.
 15252     MOVE CR-LF-TERM          TO NP-ORIG.
 15253     MOVE REM-TRM3            TO NP-REM.
 15254     MOVE '2'                 TO NP-OPT.
 15255     MOVE CR-AHPRM            TO NP-AHPRM.
 15256     MOVE CR-ACCOUNT          TO NP-ACCOUNT.
 15257     MOVE CR-LFAMT            TO NP-BENEFIT.
 15258
 15259*    CALL 'FULNETRM'
 15260*        USING NP-APR NP-ORIG NP-REM NP-OPT NP-BENEFIT NP-AHPRM
 15261*              NP-ACCOUNT NP-REMAINING.
 15262
 15263     MOVE NP-REMAINING TO CNC-BEN.
 15264
 15265     GO TO 4190-EP-DO-LF-COMM.
 15266
 15267 4130-EP-DO-LF-EP.
 15268
 15269     MOVE SPACE                  TO STATUTORY-SWITCH.
 15270
 15271     MOVE EOM-RUN-DATE TO VALUATION-DT.
 15272     MOVE '5'           TO W-VAL-SOURCE.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 297
* ECS010Z.cbl
 15273
 15274     IF REIN-EP-FLG = 'R'
 15275       IF REIN-REM-SW (SUB5) = 'I'
 15276           COMPUTE EPR-R78 = WE-LFPRM + WE-LFPRM-ALT
 15277           MOVE EPR-R78             TO EPR-PRO  EPR-ST
 15278           GO TO 4190-EP-DO-LF-COMM.
 15279
 15280     IF REIN-EP-FLG = 'R'
 15281         IF REIN-LF-RUNOFF-SW (SUB5) = 'N'  AND
 15282            EARNING-STOP-DATE LESS THAN VALUATION-DT
 15283             MOVE '*'               TO LIFE-EARNED-SWITCH
 15284             MOVE EARNING-STOP-DATE TO VALUATION-DT
 15285             MOVE '10'              TO W-VAL-SOURCE.
 15286
 15287     PERFORM 8500-REMAINING-TERM-ROUTINE THRU 8599-REM-TERM-X.
 15288
 15289     IF REM-TRM2 GREATER CR-LF-TERM
 15290         MOVE +0 TO EPR-R78  EPR-PRO  EPR-ST
 15291         GO TO 4190-EP-DO-LF-COMM.
 15292
 15293     IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'Z'
 15294         GO TO 4180-EP-DO-LF-EP-SUM.
 15295
 15296     IF CLAS-I-EP (CLAS-INDEXL) = 'B'
 15297         IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'L'
 15298             IF REM-TRM2 NOT GREATER THAN +0
 15299                 COMPUTE EPR-R78 = WE-LFPRM + WE-LFPRM-ALT
 15300                 MOVE EPR-R78 TO EPR-PRO  EPR-ST
 15301                 GO TO 4190-EP-DO-LF-COMM
 15302             ELSE
 15303                 NEXT SENTENCE
 15304         ELSE
 15305             IF W-BAL-REMTRM NOT GREATER +0
 15306                 COMPUTE EPR-R78 = WE-LFPRM + WE-LFPRM-ALT
 15307                 MOVE EPR-R78 TO EPR-PRO  EPR-ST
 15308                 GO TO 4190-EP-DO-LF-COMM
 15309             ELSE
 15310                 NEXT SENTENCE
 15311     ELSE
 15312        IF DTE-CLIENT = 'NCL'  AND
 15313           CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'B'
 15314            MOVE WE-LFPRM TO EPR-R78  EPR-PRO  EPR-ST
 15315        ELSE
 15316         IF REM-TRM2 NOT GREATER +0  OR
 15317            CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'B'
 15318             MOVE WE-LFPRM TO EPR-R78  EPR-PRO  EPR-ST
 15319             GO TO 4190-EP-DO-LF-COMM.
 15320
 15321     MOVE +1 TO ACTIVE-COUNT.
 15322
 15323     IF CLAS-I-EP (CLAS-INDEXL) = 'T'
 15324         GO TO 4140-EP-DO-LF-EP-TEX.
 15325
 15326     IF CLAS-I-EP (CLAS-INDEXL) = 'N'
 15327         GO TO 4150-EP-DO-LF-EP-NP.
 15328
 15329*    IF STATE-ABBR (CLAS-INDEXS) = 'OH'
 15330     IF (STATE-ABBR (CLAS-INDEXS) = 'OH') AND
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 298
* ECS010Z.cbl
 15331        (CR-RATING-CLASS NOT = 'L ')
 15332         IF (CR-APR GREATER THAN ZERO)  AND
 15333            (CR-LF-TERM GREATER THAN 060)  AND
 15334            (CR-DT GREATER THAN 19831031)
 15335             MOVE '*'             TO STATUTORY-SWITCH
 15336              GO TO 4150-EP-DO-LF-EP-NP.
 15337
 15338     IF STATE-ABBR (CLAS-INDEXS) = 'MT'
 15339         IF (CR-APR GREATER THAN ZERO)  AND
 15340            (CR-LF-TERM GREATER THAN 061)  AND
 15341            (CR-DT GREATER THAN 19830318)
 15342             MOVE '*'             TO STATUTORY-SWITCH
 15343              GO TO 4150-EP-DO-LF-EP-NP.
 15344
 15345     IF STATE-ABBR (CLAS-INDEXS) = 'UT'
 15346         IF (CR-APR GREATER THAN ZERO)  AND
 15347            (CR-LF-TERM GREATER THAN 062)  AND
 15348            (CR-DT GREATER THAN 19810831)  AND
 15349            (CR-DT LESS THAN 19830901)
 15350             MOVE '*'             TO STATUTORY-SWITCH
 15351              GO TO 4150-EP-DO-LF-EP-NP.
 15352
 15353     IF STATE-ABBR (CLAS-INDEXS) = 'RI'
 15354         IF (CR-APR GREATER THAN ZERO)  AND
 15355            (CR-LF-TERM GREATER THAN 060)  AND
 15356            (CR-DT GREATER THAN 19831231)
 15357             MOVE '*'             TO STATUTORY-SWITCH
 15358              GO TO 4150-EP-DO-LF-EP-NP.
 15359
 15360     GO TO 4160-EP-DO-LF-EP-R78.
 15361
 15362 4140-EP-DO-LF-EP-TEX.
 15363
 15364     IF CR-PMT-FREQ = 0
 15365       DISPLAY '*************************************'
 15366       DISPLAY '***** CR-PMT-FREQ EQUAL TO ZERO *****'
 15367       DISPLAY '*************************************'
 15368       DISPLAY '***** CR-FULL-CONTROL -->' CR-FULL-CONTROL
 15369       DISPLAY '*************************************'
 15370       COMPUTE TEX-FACT-4 =
 15371          (CR-LF-TERM * CR-LF-TERM) +
 15372                               (WS-CR-PMT-FREQ * CR-LF-TERM)
 15373     ELSE
 15374        COMPUTE TEX-FACT-4 =
 15375         (CR-LF-TERM * CR-LF-TERM) + (CR-PMT-FREQ * CR-LF-TERM).
 15376
 15377     IF CR-PMT-FREQ = 0
 15378       DIVIDE REM-TRM1 BY WS-CR-PMT-FREQ
 15379           GIVING TEX-FACT-5
 15380               REMAINDER TEX-FACT-6
 15381     ELSE
 15382        DIVIDE REM-TRM1 BY CR-PMT-FREQ
 15383            GIVING TEX-FACT-5
 15384                REMAINDER TEX-FACT-6.
 15385
 15386     IF CR-PMT-FREQ > 0
 15387        MOVE CR-PMT-FREQ TO WS-CR-PMT-FREQ.
 15388
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 299
* ECS010Z.cbl
 15389     COMPUTE TEX-FACT-5 = TEX-FACT-5 * CR-PMT-FREQ.
 15390     COMPUTE TEX-FACT-7 = (TEX-FACT-5 * TEX-FACT-5) +
 15391         (TEX-FACT-5 * CR-PMT-FREQ) +
 15392         (2 * (TEX-FACT-6 * (TEX-FACT-5 + CR-PMT-FREQ))).
 15393     COMPUTE TEX-FACT-8 ROUNDED = TEX-FACT-7 / TEX-FACT-4.
 15394
 15395     COMPUTE EPR-R78 ROUNDED = WE-LFPRM - (WE-LFPRM * TEX-FACT-8).
 15396
 15397     GO TO 4170-EP-DO-LF-EP-PRO.
 15398
 15399 4150-EP-DO-LF-EP-NP.
 15400
 15401     IF WE-LFPRM = ZERO
 15402         GO TO 4160-EP-DO-LF-EP-R78.
 15403
 15404     IF DTE-CLIENT = 'CRI'
 15405       IF STATE-ABBR (CLAS-INDEXS) = ('AB' OR 'BC' OR 'MB' OR
 15406             'NS' OR 'ON' OR 'NB' OR 'NF' OR 'QB' OR 'SK' OR 'PE')
 15407           GO TO 4160-EP-DO-LF-EP-R78.
 15408
 15409     IF DTE-CLIENT = 'NCL'
 15410       IF CR-DT LESS THAN 19910101
 15411           GO TO 4160-EP-DO-LF-EP-R78.
 15412
 15413     IF REM-TRM1 = CR-LF-TERM
 15414         MOVE +0 TO EPR-R78  EPR-PRO  EPR-ST
 15415         GO TO 4190-EP-DO-LF-COMM.
 15416
 15417     MOVE CR-APR TO NP-APR.
 15418     MOVE CR-LF-TERM TO NP-ORIG  NP-CAP.
 15419     MOVE REM-TRM1 TO NP-REM.
 15420     MOVE CLAS-I-CALC-TYPE (CLAS-INDEXL) TO NP-OPT.
 15421     IF NP-OPT = 'T' OR 'U' OR 'V' OR 'W' OR 'X'
 15422         MOVE CR-LOAN-TERM TO NP-ORIG.
 15423     MOVE 'R' TO NP-OPT.
 15424     CALL 'ECSNETRM'
 15425         USING NP-APR NP-ORIG NP-REM NP-OPT NP-CAP NP-FACTOR.
 15426
 15427     COMPUTE EPR-R78 ROUNDED = WE-LFPRM - (NP-FACTOR * WE-LFPRM).
 15428
 15429     IF STATUTORY-REQUIREMENT
 15430         MOVE EPR-R78                TO EPR-ST.
 15431
 15432 4160-EP-DO-LF-EP-R78.
 15433
 15434     IF (CLAS-I-CALC-TYPE (CLAS-INDEXL) EQUAL 'B') AND
 15435        (DTE-CLIENT EQUAL 'NCL')
 15436        IF (CR-CCYY EQUAL EOM-CCYY) AND
 15437           (CR-MO EQUAL EOM-MO)
 15438           MOVE '*'            TO OB-DATE-1-SWITCH
 15439           MOVE EW-REIN-CO     TO WS-OB-REIN-CO (SUB3)
 15440           MOVE LIFE-OVERRIDE-L1 TO WS-OB-LF-AH (SUB3)
 15441           MOVE CR-LFTYP       TO WS-OB-BENEFIT-CODE (SUB3)
 15442           COMPUTE WS-EPR-R78 (SUB3 1) =
 15443                   WS-EPR-R78 (SUB3 1) + (WE-LFPRM * .5)
 15444           GO TO 4190-EP-DO-LF-COMM
 15445        ELSE
 15446        IF (CR-CCYY EQUAL OB-CCYY (1)) AND
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 300
* ECS010Z.cbl
 15447           (CR-MO EQUAL OB-MO (1))
 15448           MOVE '*'            TO OB-DATE-2-SWITCH
 15449           MOVE EW-REIN-CO     TO WS-OB-REIN-CO (SUB3)
 15450           MOVE LIFE-OVERRIDE-L1 TO WS-OB-LF-AH (SUB3)
 15451           MOVE CR-LFTYP       TO WS-OB-BENEFIT-CODE (SUB3)
 15452           COMPUTE WS-EPR-R78 (SUB3 2) =
 15453                   WS-EPR-R78 (SUB3 2) + (WE-LFPRM * .5)
 15454           GO TO 4190-EP-DO-LF-COMM
 15455        ELSE
 15456        IF (CR-CCYY EQUAL OB-CCYY (2)) AND
 15457           (CR-MO EQUAL OB-MO (2))
 15458           MOVE '*'            TO OB-DATE-3-SWITCH
 15459           MOVE EW-REIN-CO     TO WS-OB-REIN-CO (SUB3)
 15460           MOVE LIFE-OVERRIDE-L1 TO WS-OB-LF-AH (SUB3)
 15461           MOVE CR-LFTYP       TO WS-OB-BENEFIT-CODE (SUB3)
 15462           COMPUTE WS-EPR-R78 (SUB3 3) =
 15463                   WS-EPR-R78 (SUB3 3) + (WE-LFPRM * .5)
 15464           GO TO 4190-EP-DO-LF-COMM
 15465        ELSE
 15466           GO TO 4190-EP-DO-LF-COMM.
 15467
 15468     COMPUTE TEMP-1 = CR-LF-TERM * (CR-LF-TERM + 1).
 15469
 15470     IF DTE-R78 = '1'
 15471         COMPUTE TEMP-2 = REM-TRM1 * REM-TRM1
 15472     ELSE
 15473         COMPUTE TEMP-2 = REM-TRM1 * (REM-TRM1 + 1).
 15474
 15475     COMPUTE TEMP-4 ROUNDED EQUAL TEMP-2 / TEMP-1.
 15476
 15477     IF REM-TRM1 GREATER THAN +0
 15478         COMPUTE TEMP-7 ROUNDED EQUAL
 15479             WE-LFPRM - (WE-LFPRM * TEMP-4)
 15480     ELSE
 15481         MOVE WE-LFPRM                TO TEMP-7.
 15482
 15483     IF CLAS-I-EP (CLAS-INDEXL) NOT = 'B'
 15484         MOVE ZEROS                  TO TEMP-8
 15485         GO TO 4165-END-LF-EP-R78.
 15486
 15487     IF EPR-ST = ZEROS
 15488         MOVE TEMP-7                 TO EPR-ST.
 15489
 15490     IF CLAS-I-CALC-TYPE (CLAS-INDEXL) NOT = 'L'
 15491         COMPUTE TEMP-1 = (CR-LF-TERM + 1) * (CR-LF-TERM + 2)
 15492         COMPUTE TEMP-2 = (REM-TRM1 + 1) * (REM-TRM1 + 2)
 15493         IF DTE-R78 = '1'
 15494             COMPUTE TEMP-2 = (REM-TRM1 + 1) * (REM-TRM1 + 1).
 15495
 15496     COMPUTE TEMP-4 ROUNDED EQUAL TEMP-2 / TEMP-1.
 15497
 15498     COMPUTE TEMP-8 ROUNDED =
 15499               WE-LFPRM-ALT - (WE-LFPRM-ALT * TEMP-4).
 15500
 15501 4165-END-LF-EP-R78.
 15502
 15503     IF EPR-R78 = ZEROS
 15504         COMPUTE EPR-R78 = TEMP-7 + TEMP-8
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 301
* ECS010Z.cbl
 15505     ELSE
 15506         COMPUTE EPR-R78 = EPR-R78 + TEMP-8.
 15507
 15508 4170-EP-DO-LF-EP-PRO.
 15509
 15510     IF DTE-CLIENT = 'MIC' OR 'MCC'
 15511         COMPUTE TEMP-5 ROUNDED = (REM-TRM1 - .5) / CR-LF-TERM
 15512     ELSE
 15513         COMPUTE TEMP-5 ROUNDED = REM-TRM1 / CR-LF-TERM.
 15514
 15515     IF REM-TRM1 GREATER THAN +0
 15516         COMPUTE TEMP-7 ROUNDED = WE-LFPRM - (WE-LFPRM * TEMP-5)
 15517     ELSE
 15518         MOVE WE-LFPRM                  TO TEMP-7.
 15519
 15520     IF CLAS-I-EP (CLAS-INDEXL) NOT = 'B'
 15521         MOVE ZEROS                     TO TEMP-8
 15522         GO TO 4175-END-LF-EP-PRO.
 15523
 15524     IF CLAS-I-CALC-TYPE (CLAS-INDEXL) NOT = 'L'
 15525         IF DTE-CLIENT = 'MIC' OR 'MCC'
 15526             COMPUTE TEMP-5 ROUNDED =
 15527                           (REM-TRM1 + .5) / (CR-LF-TERM + 1)
 15528         ELSE
 15529             COMPUTE TEMP-5 ROUNDED =
 15530                           (REM-TRM1 + 1) / (CR-LF-TERM + 1).
 15531
 15532     COMPUTE TEMP-8 ROUNDED =
 15533                   WE-LFPRM-ALT - (WE-LFPRM-ALT * TEMP-5).
 15534
 15535     COMPUTE EPR-ST = EPR-ST + TEMP-8.
 15536
 15537 4175-END-LF-EP-PRO.
 15538
 15539     COMPUTE EPR-PRO = TEMP-7 + TEMP-8.
 15540
 15541     GO TO 4185-EP-DO-LF-STATUTORY.
 15542
 15543 4180-EP-DO-LF-EP-SUM.
 15544
 15545     IF REM-TRM1 NOT GREATER +0
 15546         COMPUTE EPR-R78 = (WE-LFPRM + WE-LFPRM-ALT) - WE-LFRFND
 15547         MOVE EPR-R78 TO EPR-PRO  EPR-ST
 15548         GO TO 4190-EP-DO-LF-COMM.
 15549
 15550     COMPUTE ACTIVE-COUNT = CR-LIVES - CR-SUM-CAN-CNT-ITD.
 15551
 15552     IF WE-LFPRM = ZERO  AND  WE-LFPRM-ALT = ZERO
 15553         MOVE ZEROS                 TO TEMP-7
 15554     ELSE
 15555         COMPUTE TEMP-7 ROUNDED = WE-LFPRM - (WE-LFRFND *
 15556                       (WE-LFPRM / (WE-LFPRM + WE-LFPRM-ALT))).
 15557
 15558     IF TEMP-7 NOT GREATER ZERO
 15559         IF CLAS-I-EP (CLAS-INDEXL) NOT = 'B'
 15560             MOVE ZEROS             TO EPR-R78  EPR-PRO  EPR-ST
 15561             GO TO 4190-EP-DO-LF-COMM
 15562         ELSE
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 302
* ECS010Z.cbl
 15563             MOVE ZEROS             TO TEMP-7.
 15564
 15565     COMPUTE TEMP-1 = CR-LF-TERM * (CR-LF-TERM + 1).
 15566     COMPUTE TEMP-2 = REM-TRM1 * (REM-TRM1 + 1).
 15567     IF DTE-R78 = '1'
 15568         COMPUTE TEMP-2 = REM-TRM1 * REM-TRM1.
 15569
 15570     COMPUTE TEMP-4 ROUNDED = TEMP-2 / TEMP-1.
 15571     COMPUTE TEMP-5 ROUNDED = REM-TRM1 / CR-LF-TERM.
 15572
 15573     COMPUTE EPR-R78 ROUNDED = TEMP-7 - (TEMP-7 * TEMP-4).
 15574
 15575     COMPUTE EPR-PRO ROUNDED = TEMP-7 - (TEMP-7 * TEMP-5).
 15576
 15577     IF CLAS-I-EP (CLAS-INDEXL) NOT = 'B'
 15578         GO TO 4185-EP-DO-LF-STATUTORY.
 15579
 15580     MOVE EPR-R78                  TO EPR-ST.
 15581
 15582     IF WE-LFPRM = ZERO  AND  WE-LFPRM-ALT = ZERO
 15583         MOVE ZEROS                 TO TEMP-8
 15584     ELSE
 15585         COMPUTE TEMP-8 ROUNDED = WE-LFPRM-ALT - (WE-LFRFND *
 15586                     (WE-LFPRM-ALT / (WE-LFPRM + WE-LFPRM-ALT))).
 15587
 15588     IF TEMP-8 NOT GREATER ZERO
 15589         GO TO 4185-EP-DO-LF-STATUTORY.
 15590
 15591     COMPUTE EPR-R78 ROUNDED = EPR-R78 +
 15592                              (TEMP-8 - (TEMP-8 * TEMP-4)).
 15593
 15594     COMPUTE EPR-PRO ROUNDED = EPR-PRO +
 15595                              (TEMP-8 - (TEMP-8 * TEMP-5)).
 15596
 15597     COMPUTE EPR-ST ROUNDED = EPR-ST +
 15598                             (TEMP-8 - (TEMP-8 * TEMP-5)).
 15599
 15600 4185-EP-DO-LF-STATUTORY.
 15601
 15602     IF STATE-ABBR (CLAS-INDEXS) = 'AL'
 15603         MOVE EPR-R78                TO EPR-ST.
 15604     IF STATE-ABBR (CLAS-INDEXS) = 'WY'
 15605         MOVE EPR-PRO                TO EPR-ST.
 15606
 15607     IF EPR-ST NOT = ZEROS
 15608         GO TO 4190-EP-DO-LF-COMM.
 15609
 15610     IF CLAS-I-RL-AH (CLAS-INDEXL) = 'R'
 15611         MOVE EPR-R78                TO EPR-ST
 15612     ELSE
 15613         MOVE EPR-PRO                TO EPR-ST.
 15614
 15615 4190-EP-DO-LF-COMM.
 15616
 15617     MOVE +0 TO SUB1.
 15618     PERFORM 4300-EP-COMM-LOOP THRU 4399-EP-COMM-LOOP-X
 15619         10 TIMES.
 15620
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 303
* ECS010Z.cbl
 15621     IF REIN-EP-FLG NOT = 'R'  OR
 15622        CR-POLICY-IS-REIN-ONLY
 15623         MOVE ISS-BEN TO GROSS-ISS-BEN-LF
 15624         MOVE CNC-BEN TO GROSS-CNC-BEN-LF
 15625         MOVE ISS-PRM TO GROSS-ISS-PRM-LF
 15626         MOVE CNC-PRM TO GROSS-CNC-PRM-LF.
 15627
 15628     ADD ISS-BEN TO EW-ISS-BEN.
 15629     ADD GROSS-ISS-BEN-LF TO EW-ISS-BEN-GROSS.
 15630     ADD CNC-BEN TO EW-CNC-BEN.
 15631     ADD GROSS-CNC-BEN-LF TO EW-CNC-BEN-GROSS.
 15632     ADD ISS-PRM TO EW-ISS-PRM.
 15633     ADD GROSS-ISS-PRM-LF TO EW-ISS-PRM-GROSS.
 15634     ADD CNC-PRM TO EW-CNC-PRM.
 15635     ADD GROSS-CNC-PRM-LF TO EW-CNC-PRM-GROSS.
 15636
 15637     COMPUTE EW-EPR-R78 = EW-EPR-R78 + EPR-R78.
 15638     COMPUTE EW-EPR-PRO = EW-EPR-PRO + EPR-PRO.
 15639     COMPUTE EW-EPR-ST  = EW-EPR-ST  + EPR-ST.
 15640
 15641     IF CR-LF-ISS-PREM-TAX NOT NUMERIC
 15642        MOVE +0                  TO CR-LF-ISS-PREM-TAX
 15643     END-IF
 15644     IF CR-LF-CNC-PREM-TAX NOT NUMERIC
 15645        MOVE +0                  TO CR-LF-CNC-PREM-TAX
 15646     END-IF
 15647
 15648     COMPUTE ISS-PRMTAX =
 15649        (ISS-PRM * CR-LF-ISS-PREM-TAX) -
 15650        (CNC-PRM * CR-LF-CNC-PREM-TAX)
 15651
 15652     COMPUTE EW-ISS-PRM-TAX = EW-ISS-PRM-TAX + ISS-PRMTAX
 15653
 15654     IF LIFE-FULLY-EARNED
 15655         COMPUTE EW-EPR-R78-ADJ = EW-EPR-R78-ADJ +
 15656                                            (ISS-PRM - EPR-R78)
 15657         COMPUTE EW-EPR-PRO-ADJ = EW-EPR-PRO-ADJ +
 15658                                            (ISS-PRM - EPR-PRO)
 15659         COMPUTE EW-EPR-ST-ADJ  = EW-EPR-ST-ADJ +
 15660                                            (ISS-PRM - EPR-ST).
 15661
 15662     IF  DTE-OPT-RESERVE-METHOD-AUTH
 15663         IF  REIN-EP-FLG NOT = 'R'
 15664                 OR
 15665             CR-POLICY-IS-REIN-ONLY
 15666             MOVE 'L'      TO W-CLAIM-TYPE
 15667             MOVE EPR-R78  TO W-OPT-R78
 15668             MOVE EPR-PRO  TO W-OPT-PRO
 15669             MOVE EPR-ST   TO W-OPT-ST
 15670             PERFORM 4600-GET-OPT-IBNR THRU 4600-EXIT
 15671             MOVE ZEROS    TO EW-CLM-IBNR
 15672         ELSE
 15673             IF  STOP-LF-DATE LESS THAN EOM-RUN-DATE
 15674                 MOVE 'N'        TO EPEC-LINE-NOT-USED-IND (SUB3)
 15675                 MOVE ZEROS      TO EW-CLM-IBNR
 15676             ELSE
 15677                 MOVE ZEROS      TO EW-CLM-IBNR
 15678     ELSE
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 304
* ECS010Z.cbl
 15679         IF  DTE-CLIENT NOT EQUAL 'ITG'
 15680             ADD WE-DTH-IBNR
 15681                       TO EW-CLM-IBNR
 15682         ELSE
 15683             IF  CLAS-I-BAL (CLAS-INDEXL) = 'B'
 15684                     AND
 15685                 CR-DT GREATER THAN LAST-YRS-DATE
 15686                 COMPUTE  EW-CLM-IBNR
 15687                     = EW-CLM-IBNR + (WE-LFAMT * .0000500).
 15688
 15689     ADD WE-DTH-PAYCUR TO EW-CLM-PAYCUR.
 15690     ADD WE-DTH-FUTRSV TO EW-CLM-FUTRSV.
 15691
 15692 4191-CONTINUE.
 15693
 15694     MOVE 'Y'          TO EW-LEVEL-USED.
 15695
 15696     IF CR-POLICY-UNDERWRITTEN
 15697         MOVE EPEC-WORK       TO EPEC-LEVELS-II (SUB3)
 15698         MOVE EPEC-OPT-WORK-TABLE
 15699                              TO EPEC-UNDW-OPT-DATA-TABLE
 15700     ELSE
 15701         MOVE EPEC-WORK       TO EPEC-LEVELS (SUB3)
 15702         MOVE EPEC-OPT-WORK-TABLE
 15703                              TO EPEC-OPT-DATA-TABLE.
 15704
 15705     GO TO 4200-EP-DO-AH.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 305
* ECS010Z.cbl
 15707 4194-SLOT-INTO-EFFECTED-MONTHS.
 15708
 15709     IF  CR-DT NOT GREATER THAN EOM-DATE (SUBM)
 15710             AND
 15711         CR-LF-EXPIRE-DATE GREATER THAN EOM-DATE (SUBM)
 15712             AND
 15713         (CR-LF-CANC-DT GREATER THAN EOM-DATE (SUBM)
 15714                 OR
 15715          CR-LF-CANC-DT EQUAL ZEROS)
 15716             AND
 15717         (CR-LF-CLAIM-EXIT-DATE GREATER THAN EOM-DATE (SUBM)
 15718                 OR
 15719          CR-LF-CLAIM-EXIT-DATE EQUAL ZEROS)
 15720         MOVE 'Y'                 TO W-TABLE-USED-SW
 15721         IF  CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'Z'
 15722             COMPUTE EPEC-LIFE-CTR (SUB3 SUBM) ROUNDED
 15723                 = EPEC-LIFE-CTR (SUB3 SUBM)
 15724                 + CR-LIVES
 15725         ELSE
 15726             COMPUTE EPEC-LIFE-CTR (SUB3 SUBM)
 15727                 = EPEC-LIFE-CTR (SUB3 SUBM) + 1.
 15728
 15729 4194-EXIT.
 15730     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 306
* ECS010Z.cbl
 15732******************************************************************
 15733***   C A L C U L A T E   A & H   E A R N E D   P R E M I U M  ***
 15734******************************************************************
 15735
 15736 4200-EP-DO-AH.
 15737
 15738     MOVE +0                         TO ISS-BEN  EPR-R78
 15739                                        CNC-BEN  EPR-PRO
 15740                                        ISS-PRM  EPR-ST
 15741                                        CNC-PRM
 15742                                        WX-CLM-AMT
 15743                                        WX-CLM-EXP
 15744                                        WX-CLM-CNT
 15745                                        WX-CLM-CRT
 15746                                        WX-ACTIVE-COUNT
 15747                                        ISS-PRMTAX
 15748                                        WX-CNC-CNT.
 15749     MOVE SPACE                      TO A-H-EARNED-SWITCH.
 15750
 15751     IF CR-AHTYP = ZERO
 15752         GO TO 4295-EP-DO-COUNT.
 15753
 15754     IF REIN-EP-FLG = 'R'
 15755         IF REIN-AH-FLG (SUB5) = SPACE
 15756             GO TO 4295-EP-DO-COUNT.
 15757
 15758     MOVE AH-OVERRIDE-L1       TO WE-LF-AH.
 15759     MOVE CR-AHTYP             TO WE-BEN-TYPE.
 15760     PERFORM 4400-EP-FIND-TAB-ENT THRU 4499-EP-FIND-TAB-ENT-X.
 15761
 15762     IF CR-POLICY-IS-DECLINED  OR
 15763        CR-POLICY-IS-VOID
 15764         GO TO 4290-CONTINUE.
 15765
 15766     MOVE CR-AH-TERM           TO ORIG-TERM.
 15767
 15768     IF CR-DT GREATER EW-COV-DTE
 15769         MOVE CR-DT            TO EW-COV-DTE.
 15770
 15771     IF NOT CR-POLICY-IS-RESTORE  AND
 15772        NOT CR-POLICY-IS-REISSUE
 15773        AND NOT CR-POLICY-IS-MONTHLY
 15774         MOVE WE-AHAMT         TO ISS-BEN
 15775         COMPUTE EW-ORIG-TERM = EW-ORIG-TERM + ORIG-TERM
 15776         COMPUTE EW-AGE = EW-AGE + CR-AGE
 15777         COMPUTE EW-AGE-BEN = EW-AGE-BEN + (CR-AGE * ISS-BEN)
 15778         COMPUTE EW-TERM-BEN = EW-TERM-BEN +
 15779                                   (ORIG-TERM * ISS-BEN).
 15780
 15781     MOVE CLAS-INDEXA     TO W-NDX.
 15782     MOVE RUN-DATE        TO VALUATION-DT
 15783     MOVE '6'             TO W-VAL-SOURCE.
 15784
 15785     IF REIN-EP-FLG = 'R'
 15786         IF REIN-AH-RUNOFF-SW (SUB5) = 'N'  AND
 15787            EARNING-STOP-DATE LESS THAN VALUATION-DT
 15788             MOVE EARNING-STOP-DATE TO VALUATION-DT
 15789             MOVE '10'              TO W-VAL-SOURCE.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 307
* ECS010Z.cbl
 15790
 15791     PERFORM 8500-REMAINING-TERM-ROUTINE THRU 8599-REM-TERM-X.
 15792
 15793     IF (CR-AH-CURRENT-STATUS = '1' OR '4') AND
 15794        (REM-TRM3 GREATER ZERO)
 15795        IF CLAS-I-CALC-TYPE (CLAS-INDEXA) = 'Z'
 15796            COMPUTE EW-INFORCE-CNT = EW-INFORCE-CNT +
 15797                                  (CR-LIVES - CR-SUM-CAN-CNT-ITD)
 15798            COMPUTE EW-REM-TERM = EW-REM-TERM +
 15799                     (REM-TRM3 * (CR-LIVES - CR-SUM-CAN-CNT-ITD))
 15800          ELSE
 15801            COMPUTE EW-INFORCE-CNT = EW-INFORCE-CNT + 1
 15802            COMPUTE EW-REM-TERM = EW-REM-TERM + REM-TRM3.
 15803
 15804     IF  DTE-OPT-RESERVE-METHOD-UNAUTH
 15805         GO TO 4210-BY-OPT-LOGIC.
 15806
 15807     IF  CR-DT NOT GREATER THAN EOM-DATE (13)
 15808             AND
 15809         CR-AH-EXPIRE-DATE GREATER THAN EOM-DATE (1)
 15810             AND
 15811         (CR-AH-CANC-DT GREATER THAN EOM-DATE (1)
 15812                 OR
 15813          CR-AH-CANC-DT EQUAL ZEROS)
 15814         MOVE 'Y'                TO EPEC-LIFE-CTR-USED-IND (SUB3)
 15815         PERFORM 4296-SLOT-INTO-EFFECTED-MONTHS THRU 4296-EXIT
 15816                 VARYING
 15817             SUBM FROM +1 BY +1
 15818                 UNTIL
 15819             SUBM GREATER THAN +13.
 15820
 15821     MOVE EW-SUB-KEY             TO EPEC-SUB-KEY-OPT (SUB3).
 15822     MOVE EW-REIN-CO             TO EPEC-REIN-CO-OPT (SUB3).
 15823
 15824 4210-BY-OPT-LOGIC.
 15825
 15826     IF CLAS-I-CALC-TYPE (CLAS-INDEXA) = 'Z'
 15827         ADD CR-LIVES TO EW-ISS-CNT
 15828         MOVE WE-AHPRM TO ISS-PRM
 15829         COMPUTE EW-ORIG-TERM = EW-ORIG-TERM +
 15830                                (ORIG-TERM * CR-LIVES)
 15831         COMPUTE EW-AGE = EW-AGE + (CR-AGE * CR-LIVES)
 15832         COMPUTE EW-AGE-BEN = EW-AGE-BEN + (CR-AGE * ISS-BEN)
 15833         COMPUTE EW-TERM-BEN = EW-TERM-BEN +
 15834                                   (ORIG-TERM * ISS-BEN)
 15835         PERFORM 4825-EP-DO-AH-CNCL-SUM THRU 4899-EXIT
 15836         GO TO 4225-CONTINUE.
 15837
 15838     IF (NOT CR-POLICY-IS-RESTORE) AND
 15839        (NOT CR-POLICY-IS-REISSUE)
 15840        AND (NOT CR-POLICY-IS-MONTHLY)
 15841        ADD +1 TO EW-ISS-CNT.
 15842
 15843     PERFORM 4800-CALC-EARNED-PREMIUM-AH THRU 4899-EXIT.
 15844
 15845 4225-CONTINUE.
 15846
 15847     IF  EPEC-CLM-EXP (SUB3)  NUMERIC
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 308
* ECS010Z.cbl
 15848         NEXT  SENTENCE
 15849       ELSE
 15850         MOVE ZEROS TO EPEC-CLM-EXP (SUB3).
 15851
 15852     ADD WX-CLM-AMT              TO EW-CLM-AMT.
 15853     ADD WX-CLM-EXP              TO EPEC-CLM-EXP (SUB3).
 15854     ADD WX-CLM-CNT              TO EW-CLM-CNT.
 15855     ADD WX-CLM-CRT              TO EW-CLM-CRT.
 15856     ADD WX-ACTIVE-COUNT         TO ACTIVE-COUNT.
 15857     ADD WX-CNC-CNT              TO EW-CNC-CNT.
 15858
 15859     MOVE +0           TO SUB1.
 15860     PERFORM 4300-EP-COMM-LOOP THRU 4399-EP-COMM-LOOP-X
 15861         10 TIMES.
 15862
 15863     IF REIN-EP-FLG NOT = 'R'  OR
 15864        CR-POLICY-IS-REIN-ONLY
 15865         MOVE ISS-BEN TO GROSS-ISS-BEN-AH
 15866         MOVE CNC-BEN TO GROSS-CNC-BEN-AH
 15867         MOVE ISS-PRM TO GROSS-ISS-PRM-AH
 15868         MOVE CNC-PRM TO GROSS-CNC-PRM-AH.
 15869
 15870     ADD ISS-BEN TO EW-ISS-BEN.
 15871     ADD GROSS-ISS-BEN-AH TO EW-ISS-BEN-GROSS.
 15872     ADD CNC-BEN TO EW-CNC-BEN.
 15873     ADD GROSS-CNC-BEN-AH TO EW-CNC-BEN-GROSS.
 15874     ADD ISS-PRM TO EW-ISS-PRM.
 15875     ADD GROSS-ISS-PRM-AH TO EW-ISS-PRM-GROSS.
 15876     ADD CNC-PRM TO EW-CNC-PRM.
 15877     ADD GROSS-CNC-PRM-AH TO EW-CNC-PRM-GROSS.
 15878
 15879     COMPUTE EW-EPR-R78 = EW-EPR-R78 + EPR-R78.
 15880     COMPUTE EW-EPR-PRO = EW-EPR-PRO + EPR-PRO.
 15881     COMPUTE EW-EPR-ST  = EW-EPR-ST  + EPR-ST.
 15882
 15883     IF CR-AH-ISS-PREM-TAX NOT NUMERIC
 15884        MOVE ZEROS               TO CR-AH-ISS-PREM-TAX
 15885     END-IF
 15886     IF CR-AH-CNC-PREM-TAX NOT NUMERIC
 15887        MOVE ZEROS               TO CR-AH-CNC-PREM-TAX
 15888     END-IF
 15889     COMPUTE ISS-PRMTAX =
 15890        (ISS-PRM * CR-AH-ISS-PREM-TAX) -
 15891        (CNC-PRM * CR-AH-CNC-PREM-TAX)
 15892     COMPUTE EW-ISS-PRM-TAX = EW-ISS-PRM-TAX + ISS-PRMTAX
 15893
 15894     IF A-H-FULLY-EARNED
 15895         COMPUTE EW-EPR-R78-ADJ = EW-EPR-R78-ADJ +
 15896                                            (ISS-PRM - EPR-R78)
 15897         COMPUTE EW-EPR-PRO-ADJ = EW-EPR-PRO-ADJ +
 15898                                            (ISS-PRM - EPR-PRO)
 15899         COMPUTE EW-EPR-ST-ADJ  = EW-EPR-ST-ADJ +
 15900                                            (ISS-PRM - EPR-ST).
 15901
 15902     IF  DTE-OPT-RESERVE-METHOD-AUTH
 15903         IF  REIN-EP-FLG NOT = 'R'
 15904                 OR
 15905             CR-POLICY-IS-REIN-ONLY
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 309
* ECS010Z.cbl
 15906             MOVE 'A'      TO W-CLAIM-TYPE
 15907             MOVE EPR-R78  TO W-OPT-R78
 15908             MOVE EPR-PRO  TO W-OPT-PRO
 15909             MOVE EPR-ST   TO W-OPT-ST
 15910             PERFORM 4600-GET-OPT-IBNR THRU 4600-EXIT
 15911             MOVE ZEROS    TO EW-CLM-IBNR
 15912         ELSE
 15913             IF  STOP-AH-DATE LESS THAN EOM-RUN-DATE
 15914                 MOVE 'N'   TO EPEC-LINE-NOT-USED-IND (SUB3)
 15915                 MOVE ZEROS TO EW-CLM-IBNR
 15916             ELSE
 15917                 MOVE ZEROS TO EW-CLM-IBNR
 15918     ELSE
 15919         IF  DTE-CLIENT NOT EQUAL 'ITG'
 15920             ADD WE-DIS-IBNR     TO EW-CLM-IBNR
 15921         ELSE
 15922             IF  CLAS-I-BAL (CLAS-INDEXA) NOT EQUAL 'B'
 15923                 IF  CR-AH-POLICY-IS-ACTIVE
 15924                     COMPUTE  EW-CLM-IBNR  =  EW-CLM-IBNR
 15925                              + ((WE-AHPRM - EPR-PRO) * .0730000)
 15926                 ELSE
 15927                     NEXT SENTENCE
 15928             ELSE
 15929                 IF  CR-DT GREATER THAN LAST-YRS-DATE
 15930                     COMPUTE  EW-CLM-IBNR
 15931                         = EW-CLM-IBNR + (WE-AHPRM * .0600000).
 15932
 15933     ADD WE-DIS-PAYCUR TO EW-CLM-PAYCUR.
 15934     ADD WE-DIS-FUTRSV TO EW-CLM-FUTRSV.
 15935
 15936 4290-CONTINUE.
 15937
 15938     MOVE 'Y'          TO EW-LEVEL-USED.
 15939
 15940     IF CR-POLICY-UNDERWRITTEN
 15941         MOVE EPEC-WORK       TO EPEC-LEVELS-II (SUB3)
 15942         MOVE EPEC-OPT-WORK-TABLE
 15943                              TO EPEC-UNDW-OPT-DATA-TABLE
 15944     ELSE
 15945         MOVE EPEC-WORK       TO EPEC-LEVELS (SUB3)
 15946         MOVE EPEC-OPT-WORK-TABLE
 15947                              TO EPEC-OPT-DATA-TABLE.
 15948
 15949
 15950 4295-EP-DO-COUNT.
 15951
 15952     IF REIN-EP-FLG = 'R'
 15953         ADD ACTIVE-COUNT TO BC-R-A-CERTS
 15954     ELSE
 15955         ADD ACTIVE-COUNT TO BC-G-A-CERTS.
 15956
 15957     GO TO 4299-EPBX.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 310
* ECS010Z.cbl
 15959 4296-SLOT-INTO-EFFECTED-MONTHS.
 15960
 15961     IF  CR-DT NOT GREATER THAN EOM-DATE (SUBM)
 15962             AND
 15963         CR-AH-EXPIRE-DATE GREATER THAN EOM-DATE (SUBM)
 15964             AND
 15965         (CR-AH-CANC-DT GREATER THAN EOM-DATE (SUBM)
 15966                 OR
 15967          CR-AH-CANC-DT EQUAL ZEROS)
 15968         MOVE 'Y'                 TO W-TABLE-USED-SW
 15969         IF  CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'Z'
 15970             COMPUTE EPEC-LIFE-CTR (SUB3 SUBM) ROUNDED
 15971                 = EPEC-LIFE-CTR (SUB3 SUBM)
 15972                 + CR-LIVES
 15973         ELSE
 15974             COMPUTE EPEC-LIFE-CTR (SUB3 SUBM)
 15975                 = EPEC-LIFE-CTR (SUB3 SUBM) + 1.
 15976
 15977 4296-EXIT.
 15978     EXIT.
 15979
 15980 4299-EPBX.
 15981     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 311
* ECS010Z.cbl
 15983******************************************************************
 15984***    C A L C U L A T E   E A R N E D   C O M M I S S I O N   ***
 15985******************************************************************
 15986
 15987 4300-EP-COMM-LOOP.
 15988     IF DTE-CLIENT = 'DMD'
 15989         GO TO 4399-EP-COMM-LOOP-X.
 15990
 15991     ADD +1                         TO SUB1.
 15992     MOVE ZEROS                     TO SUB16.
 15993
 15994     IF CR-COM-AGT (SUB1) = SPACES OR ZEROS
 15995         GO TO 4399-EP-COMM-LOOP-X.
 15996
 15997 4300-AGENT-LOOP.
 15998
 15999     ADD +1                         TO SUB16.
 16000
 16001     IF SUB16 GREATER THAN WS-LOOP-MAX
 16002         DISPLAY 'ERROR OCCURRED - MAXIMUM AGENT LEVELS EXCEEDED'
 16003         DISPLAY 'CONTROL= ' CR-FULL-CONTROL
 16004         MOVE 'ERR0R OCCURRED - MAXIMUM AGENT LEVELS EXCEEDED'
 16005                                     TO WS-ABEND-MESSAGE
 16006         MOVE DC-ERROR-CODE          TO WS-ABEND-FILE-STATUS
 16007         MOVE 4001                   TO WS-ABEND-CODE
 16008         GO TO ABEND-PGM.
 16009
 16010     IF EW-AGT-NO (SUB16) = SPACES
 16011         MOVE CR-COM-AGT  (SUB1)     TO EW-AGT-NO   (SUB16)
 16012         MOVE CR-AGT-TYPE (SUB1)     TO EW-AGT-TYPE (SUB16)
 16013     ELSE
 16014         IF (CR-COM-AGT (SUB1)  = EW-AGT-NO   (SUB16)) AND
 16015            (CR-AGT-TYPE (SUB1) = EW-AGT-TYPE (SUB16))
 16016             NEXT SENTENCE
 16017         ELSE
 16018             GO TO 4300-AGENT-LOOP.
 16019
 16020     IF EW-LF-AH = AH-OVERRIDE-L1
 16021         GO TO 4350-EP-COMM-LOOP-A.
 16022
 16023     IF (DTE-CLIENT = 'DCC')
 16024        AND (REIN-EP-FLG = 'R')
 16025        AND (CR-AGT-TYPE (SUB1) = 'P' OR 'T')
 16026        AND (WE-LFPRM NOT = ZEROS)
 16027        COMPUTE WS-CEDE-FACT = RWF-LFAMT /
 16028            (CR-LFAMT + CR-LFAMT-ALT)
 16029*       COMPUTE ISS-WK ROUNDED = ((WE-LFPRM + WE-LFPRM-ALT)
 16030        COMPUTE ISS-WK ROUNDED = ((CR-LFPRM + CR-LFPRM-ALT)
 16031           * WS-CEDE-FACT) * CR-LCOM-L (SUB1)
 16032     ELSE
 16033        COMPUTE ISS-WK  ROUNDED = ISS-PRM * CR-LCOM-L (SUB1)
 16034     END-IF
 16035
 16036     COMPUTE EW-ISS-COM (SUB16) = EW-ISS-COM (SUB16) + ISS-WK.
 16037
 16038     MOVE ZEROS                  TO CNC-WK
 16039     IF DTE-CLIENT EQUAL 'XXX'
 16040         IF NOT CR-NO-LF-CHARGEBACK
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 312
* ECS010Z.cbl
 16041            COMPUTE CNC-WK  ROUNDED = CNC-PRM * CR-LCOM-L (SUB1)
 16042            COMPUTE EW-CNC-COM (SUB16) = EW-CNC-COM (SUB16)
 16043                                + CNC-WK
 16044            GO TO 4300-CONTINUE-LOOP.
 16045
 16046     IF (WS-LEVELS-CHARGEBACK-SWITCHES = SPACES) OR
 16047         (WS-LF-CHARGEBACK-SW (SUB1) EQUAL 'Y')
 16048           COMPUTE CNC-WK  ROUNDED = CNC-PRM * CR-LCOM-L (SUB1)
 16049           COMPUTE EW-CNC-COM (SUB16) =
 16050                                  EW-CNC-COM (SUB16) + CNC-WK
 16051           GO TO 4300-CONTINUE-LOOP.
 16052
 16053 4300-CONTINUE-LOOP.
 16054
 16055     IF ((ISS-PRM - CNC-PRM) = ZEROS)
 16056               OR
 16057        ((ISS-WK - CNC-WK) = ZEROS)
 16058        MOVE ZEROS              TO COMM-WK
 16059     ELSE
 16060        COMPUTE COMM-WK ROUNDED = EPR-R78 /
 16061        (ISS-PRM - CNC-PRM) * (ISS-WK - CNC-WK)
 16062     END-IF
 16063
 16064     COMPUTE EW-ECR-R78 (SUB16) = EW-ECR-R78 (SUB16) + COMM-WK.
 16065
 16066     IF ((ISS-PRM - CNC-PRM) = ZEROS)
 16067               OR
 16068        ((ISS-WK - CNC-WK) = ZEROS)
 16069        MOVE ZEROS              TO COMM-WK
 16070     ELSE
 16071        COMPUTE COMM-WK ROUNDED = EPR-PRO /
 16072        (ISS-PRM - CNC-PRM) * (ISS-WK - CNC-WK)
 16073     END-IF
 16074     COMPUTE EW-ECR-PRO (SUB16) = EW-ECR-PRO (SUB16) + COMM-WK.
 16075
 16076     IF ((ISS-PRM - CNC-PRM) = ZEROS)
 16077               OR
 16078        ((ISS-WK - CNC-WK) = ZEROS)
 16079        MOVE ZEROS              TO COMM-WK
 16080     ELSE
 16081        COMPUTE COMM-WK ROUNDED = EPR-ST /
 16082        (ISS-PRM - CNC-PRM) * (ISS-WK - CNC-WK)
 16083     END-IF
 16084
 16085     COMPUTE EW-ECR-ST (SUB16) = EW-ECR-ST (SUB16) + COMM-WK.
 16086
 16087     IF LIFE-FULLY-EARNED
 16088         COMPUTE COMM-WK ROUNDED = (ISS-PRM - EPR-R78) *
 16089                                                CR-LCOM-L (SUB1)
 16090         COMPUTE EW-ECR-R78-ADJ (SUB16) =
 16091                               EW-ECR-R78-ADJ (SUB16) + COMM-WK
 16092         COMPUTE COMM-WK ROUNDED = (ISS-PRM - EPR-PRO) *
 16093                                                CR-LCOM-L (SUB1)
 16094         COMPUTE EW-ECR-PRO-ADJ (SUB16) =
 16095                               EW-ECR-PRO-ADJ (SUB16) + COMM-WK.
 16096
 16097     GO TO 4399-EP-COMM-LOOP-X.
 16098
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 313
* ECS010Z.cbl
 16099 4350-EP-COMM-LOOP-A.
 16100
 16101     IF (DTE-CLIENT = 'DCC')
 16102        AND (REIN-EP-FLG = 'R')
 16103        AND (CR-AGT-TYPE (SUB1) = 'P' OR 'T')
 16104        AND (WE-AHPRM NOT = ZEROS)
 16105        COMPUTE WS-CEDE-FACT = RWF-AHAMT / CR-AHAMT
 16106        COMPUTE ISS-WK ROUNDED = (CR-AHPRM * WS-CEDE-FACT)
 16107*       COMPUTE ISS-WK ROUNDED = (WE-AHPRM * WS-CEDE-FACT)
 16108           * CR-LCOM-AH (SUB1)
 16109     ELSE
 16110        COMPUTE ISS-WK  ROUNDED = ISS-PRM * CR-LCOM-AH (SUB1)
 16111     END-IF
 16112
 16113     COMPUTE EW-ISS-COM (SUB16) =
 16114             EW-ISS-COM (SUB16) + ISS-WK.
 16115
 16116     MOVE ZEROS                  TO CNC-WK
 16117     IF DTE-CLIENT EQUAL 'XXX'
 16118         IF NOT CR-NO-LF-CHARGEBACK
 16119           COMPUTE CNC-WK  ROUNDED = CNC-PRM * CR-LCOM-AH (SUB1)
 16120           COMPUTE EW-CNC-COM (SUB16) =
 16121                   EW-CNC-COM (SUB16) + CNC-WK
 16122           GO TO 4300-CONTINUE-LOOP-AH.
 16123
 16124     IF (WS-LEVELS-CHARGEBACK-SWITCHES = SPACES) OR
 16125         (WS-AH-CHARGEBACK-SW (SUB1) EQUAL 'Y')
 16126           COMPUTE CNC-WK  ROUNDED = CNC-PRM * CR-LCOM-AH (SUB1)
 16127           COMPUTE EW-CNC-COM (SUB16) =
 16128                   EW-CNC-COM (SUB16) + CNC-WK
 16129           GO TO 4300-CONTINUE-LOOP-AH.
 16130
 16131 4300-CONTINUE-LOOP-AH.
 16132
 16133     IF ((ISS-PRM - CNC-PRM) = ZEROS)
 16134                OR
 16135        ((ISS-WK - CNC-WK) = ZEROS)
 16136        MOVE ZEROS          TO COMM-WK
 16137     ELSE
 16138        COMPUTE COMM-WK ROUNDED = EPR-R78 /
 16139        (ISS-PRM - CNC-PRM) * (ISS-WK - CNC-WK)
 16140     END-IF
 16141
 16142     COMPUTE EW-ECR-R78 (SUB16) = EW-ECR-R78 (SUB16) + COMM-WK.
 16143
 16144     IF ((ISS-PRM - CNC-PRM) = ZEROS)
 16145                OR
 16146        ((ISS-WK - CNC-WK) = ZEROS)
 16147        MOVE ZEROS          TO COMM-WK
 16148     ELSE
 16149        COMPUTE COMM-WK ROUNDED = EPR-PRO /
 16150        (ISS-PRM - CNC-PRM) * (ISS-WK - CNC-WK)
 16151     END-IF
 16152
 16153     COMPUTE EW-ECR-PRO (SUB16) = EW-ECR-PRO (SUB16) + COMM-WK.
 16154
 16155     IF ((ISS-PRM - CNC-PRM) = ZEROS)
 16156                OR
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 314
* ECS010Z.cbl
 16157        ((ISS-WK - CNC-WK) = ZEROS)
 16158        MOVE ZEROS          TO COMM-WK
 16159     ELSE
 16160        COMPUTE COMM-WK ROUNDED = EPR-ST  /
 16161        (ISS-PRM - CNC-PRM) * (ISS-WK - CNC-WK)
 16162     END-IF
 16163
 16164     COMPUTE EW-ECR-ST (SUB16) = EW-ECR-ST (SUB16) + COMM-WK.
 16165
 16166     IF A-H-FULLY-EARNED
 16167         COMPUTE COMM-WK ROUNDED = (ISS-PRM - EPR-R78) *
 16168                                                CR-LCOM-AH (SUB1)
 16169         COMPUTE EW-ECR-R78-ADJ (SUB16) =
 16170                               EW-ECR-R78-ADJ (SUB16) + COMM-WK
 16171         COMPUTE COMM-WK ROUNDED = (ISS-PRM - EPR-PRO) *
 16172                                                CR-LCOM-AH (SUB1)
 16173         COMPUTE EW-ECR-PRO-ADJ (SUB16) =
 16174                               EW-ECR-PRO-ADJ (SUB16) + COMM-WK.
 16175
 16176 4399-EP-COMM-LOOP-X.
 16177     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 315
* ECS010Z.cbl
 16179******************************************************************
 16180******************************************************************
 16181******************************************************************
 16182******************************************************************
 16183******************************************************************
 16184******************************************************************
 16185******************************************************************
 16186******************************************************************
 16187******************************************************************
 16188******************************************************************
 16189***  C A L C U L A T E   L I F E   S T A R T I N G  E A R N E D***
 16190******************************************************************
 16191
 16192 S-4100-EP-DO-LF.
 16193
 16194     MOVE +0                         TO EPR-R78  EARNED-BY-CANCEL
 16195                                        EPR-PRO
 16196                                        EPR-ST.
 16197
 16198     MOVE RCT-EARNING-START-DT (CO-SUB) TO DC-GREG-DATE-CYMD.
 16199     MOVE 'L'                    TO DC-OPTION-CODE.
 16200     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 16201
 16202     MOVE +0                     TO DC-ELAPSED-MONTHS.
 16203     MOVE -1                     TO DC-ELAPSED-DAYS.
 16204     MOVE '6'                    TO DC-OPTION-CODE.
 16205     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 16206
 16207     MOVE +0                     TO DC-ELAPSED-MONTHS
 16208                                    DC-ELAPSED-DAYS.
 16209
 16210     MOVE DC-BIN-DATE-2          TO DC-BIN-DATE-1.
 16211     MOVE ' '                    TO DC-OPTION-CODE.
 16212     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 16213
 16214     IF NO-CONVERSION-ERROR
 16215        MOVE DC-GREG-DATE-CYMD   TO EARNING-START-DATE
 16216     ELSE
 16217         DISPLAY 'ERROR OCCURED CONVERTING EARNING START DATE '
 16218                 'FOR REIN. CO. ' RCT-REIN-CO (CO-SUB)
 16219                 '  START DATE:' RCT-EARNING-START-DT (CO-SUB)
 16220         MOVE 'ERROR OCCURED CONVERTING EARNING START DATE '
 16221                                     TO WS-ABEND-MESSAGE
 16222         MOVE DC-ERROR-CODE          TO WS-ABEND-FILE-STATUS
 16223         MOVE 4001                   TO WS-ABEND-CODE
 16224         GO TO ABEND-PGM.
 16225
 16226     IF CR-LFTYP = ZERO
 16227         GO TO S-4200-EP-DO-AH.
 16228
 16229     IF REIN-LF-FLG (SUB5) = SPACE
 16230         GO TO S-4200-EP-DO-AH.
 16231
 16232     MOVE LIFE-OVERRIDE-L1       TO WE-LF-AH.
 16233     MOVE CR-LFTYP               TO WE-BEN-TYPE.
 16234     PERFORM 4400-EP-FIND-TAB-ENT THRU 4499-EP-FIND-TAB-ENT-X.
 16235
 16236     MOVE CR-LF-TERM             TO ORIG-TERM.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 316
* ECS010Z.cbl
 16237     MOVE CLAS-INDEXL            TO W-NDX.
 16238
 16239 S-4120-EP-DO-LF-CNCL.
 16240
 16241     IF CR-LF-STATUS-AT-CANCEL = ' '  AND
 16242        CLAS-I-CALC-TYPE (CLAS-INDEXL) NOT = 'Z'
 16243         GO TO S-4130-EP-DO-LF-EP.
 16244
 16245     COMPUTE EARNED-BY-CANCEL =
 16246                       (WE-LFPRM + WE-LFPRM-ALT) - WE-LFRFND.
 16247
 16248 S-4130-EP-DO-LF-EP.
 16249
 16250     MOVE SPACE                  TO STATUTORY-SWITCH.
 16251
 16252     MOVE EARNING-START-DATE     TO VALUATION-DT.
 16253     MOVE '9'                    TO W-VAL-SOURCE.
 16254     PERFORM 8500-REMAINING-TERM-ROUTINE THRU 8599-REM-TERM-X.
 16255
 16256     IF REM-TRM2 GREATER CR-LF-TERM
 16257         MOVE +0 TO EPR-R78  EPR-PRO  EPR-ST
 16258         GO TO S-4190-EP-DO-LF-COMM.
 16259
 16260     IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'Z'
 16261         GO TO S-4180-EP-DO-LF-EP-SUM.
 16262
 16263     IF CLAS-I-EP (CLAS-INDEXL) = 'B'
 16264         IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'L'
 16265             IF REM-TRM2 NOT GREATER THAN +0
 16266                 COMPUTE EPR-R78 = WE-LFPRM + WE-LFPRM-ALT
 16267                 MOVE EPR-R78 TO EPR-PRO  EPR-ST
 16268                 GO TO S-4190-EP-DO-LF-COMM
 16269             ELSE
 16270                 NEXT SENTENCE
 16271         ELSE
 16272             IF W-BAL-REMTRM NOT GREATER +0
 16273                 COMPUTE EPR-R78 = WE-LFPRM + WE-LFPRM-ALT
 16274                 MOVE EPR-R78 TO EPR-PRO  EPR-ST
 16275                 GO TO S-4190-EP-DO-LF-COMM
 16276             ELSE
 16277                 NEXT SENTENCE
 16278     ELSE
 16279        IF (DTE-CLIENT EQUAL 'NCL') AND
 16280           (CLAS-I-CALC-TYPE (CLAS-INDEXL) EQUAL 'B')
 16281             MOVE WE-LFPRM TO EPR-R78  EPR-PRO  EPR-ST
 16282        ELSE
 16283         IF REM-TRM2 NOT GREATER +0  OR
 16284            CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'B'
 16285             MOVE WE-LFPRM TO EPR-R78  EPR-PRO  EPR-ST
 16286             GO TO S-4190-EP-DO-LF-COMM.
 16287
 16288     IF CLAS-I-EP (CLAS-INDEXL) = 'T'
 16289         GO TO S-4140-EP-DO-LF-EP-TEX.
 16290
 16291     IF CLAS-I-EP (CLAS-INDEXL) = 'N'
 16292         GO TO S-4150-EP-DO-LF-EP-NP.
 16293
 16294*    IF STATE-ABBR (CLAS-INDEXS) = 'OH'
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 317
* ECS010Z.cbl
 16295     IF (STATE-ABBR (CLAS-INDEXS) = 'OH') AND
 16296        (CR-RATING-CLASS NOT = 'L ')
 16297         IF (CR-APR GREATER THAN ZERO)  AND
 16298            (CR-LF-TERM GREATER THAN 060)  AND
 16299            (CR-DT GREATER THAN 19831031)
 16300             MOVE '*'             TO STATUTORY-SWITCH
 16301              GO TO S-4150-EP-DO-LF-EP-NP.
 16302
 16303     IF STATE-ABBR (CLAS-INDEXS) = 'MT'
 16304         IF (CR-APR GREATER THAN ZERO)  AND
 16305            (CR-LF-TERM GREATER THAN 061)  AND
 16306            (CR-DT GREATER THAN 19830318)
 16307             MOVE '*'             TO STATUTORY-SWITCH
 16308              GO TO S-4150-EP-DO-LF-EP-NP.
 16309
 16310     IF STATE-ABBR (CLAS-INDEXS) = 'UT'
 16311         IF (CR-APR GREATER THAN ZERO)  AND
 16312            (CR-LF-TERM GREATER THAN 062)  AND
 16313            (CR-DT GREATER THAN 19810831)  AND
 16314            (CR-DT LESS THAN 19830901)
 16315             MOVE '*'             TO STATUTORY-SWITCH
 16316              GO TO S-4150-EP-DO-LF-EP-NP.
 16317
 16318     IF STATE-ABBR (CLAS-INDEXS) = 'RI'
 16319         IF (CR-APR GREATER THAN ZERO)  AND
 16320            (CR-LF-TERM GREATER THAN 060)  AND
 16321            (CR-DT GREATER THAN 19831231)
 16322             MOVE '*'             TO STATUTORY-SWITCH
 16323              GO TO S-4150-EP-DO-LF-EP-NP.
 16324
 16325     GO TO S-4160-EP-DO-LF-EP-R78.
 16326
 16327 S-4140-EP-DO-LF-EP-TEX.
 16328
 16329     COMPUTE TEX-FACT-4 =
 16330         (CR-LF-TERM * CR-LF-TERM) + (CR-PMT-FREQ * CR-LF-TERM).
 16331     DIVIDE REM-TRM1 BY CR-PMT-FREQ
 16332         GIVING TEX-FACT-5
 16333             REMAINDER TEX-FACT-6.
 16334     COMPUTE TEX-FACT-5 = TEX-FACT-5 * CR-PMT-FREQ.
 16335     COMPUTE TEX-FACT-7 = (TEX-FACT-5 * TEX-FACT-5) +
 16336         (TEX-FACT-5 * CR-PMT-FREQ) +
 16337         (2 * (TEX-FACT-6 * (TEX-FACT-5 + CR-PMT-FREQ))).
 16338     COMPUTE TEX-FACT-8 ROUNDED = TEX-FACT-7 / TEX-FACT-4.
 16339
 16340     COMPUTE EPR-R78 ROUNDED = WE-LFPRM - (WE-LFPRM * TEX-FACT-8).
 16341
 16342     GO TO S-4170-EP-DO-LF-EP-PRO.
 16343
 16344 S-4150-EP-DO-LF-EP-NP.
 16345
 16346     IF WE-LFPRM = ZERO
 16347         GO TO S-4160-EP-DO-LF-EP-R78.
 16348
 16349     IF DTE-CLIENT = 'CRI'
 16350       IF STATE-ABBR (CLAS-INDEXS) = ('AB' OR 'BC' OR 'MB' OR
 16351             'NS' OR 'ON' OR 'NB' OR 'NF' OR 'QB' OR 'SK' OR 'PE')
 16352           GO TO S-4160-EP-DO-LF-EP-R78.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 318
* ECS010Z.cbl
 16353
 16354     IF DTE-CLIENT = 'NCL'
 16355       IF CR-DT LESS THAN 19910101
 16356           GO TO S-4160-EP-DO-LF-EP-R78.
 16357
 16358     IF REM-TRM1 = CR-LF-TERM
 16359         MOVE +0 TO EPR-R78  EPR-PRO  EPR-ST
 16360         GO TO S-4190-EP-DO-LF-COMM.
 16361
 16362     MOVE CR-APR TO NP-APR.
 16363     MOVE CR-LF-TERM TO NP-ORIG  NP-CAP.
 16364     MOVE REM-TRM1 TO NP-REM.
 16365     MOVE CLAS-I-CALC-TYPE (CLAS-INDEXL) TO NP-OPT.
 16366     IF NP-OPT = 'T' OR 'U' OR 'V' OR 'W' OR 'X'
 16367         MOVE CR-LOAN-TERM TO NP-ORIG.
 16368     MOVE 'R' TO NP-OPT.
 16369     CALL 'ECSNETRM'
 16370         USING NP-APR NP-ORIG NP-REM NP-OPT NP-CAP NP-FACTOR.
 16371
 16372     COMPUTE EPR-R78 ROUNDED = WE-LFPRM - (NP-FACTOR * WE-LFPRM).
 16373
 16374     IF STATUTORY-REQUIREMENT
 16375         MOVE EPR-R78                TO EPR-ST.
 16376
 16377 S-4160-EP-DO-LF-EP-R78.
 16378
 16379     IF (CLAS-I-CALC-TYPE (CLAS-INDEXL) EQUAL 'B') AND
 16380        (DTE-CLIENT EQUAL 'NCL')
 16381        IF (CR-CCYY EQUAL EOM-CCYY) AND
 16382           (CR-MO EQUAL EOM-MO)
 16383           MOVE '*'            TO OB-DATE-1-SWITCH
 16384           MOVE EW-REIN-CO     TO WS-OB-REIN-CO (SUB3)
 16385           MOVE LIFE-OVERRIDE-L1 TO WS-OB-LF-AH (SUB3)
 16386           MOVE CR-LFTYP       TO WS-OB-BENEFIT-CODE (SUB3)
 16387           COMPUTE WS-EPR-R78 (SUB3 1) =
 16388                   WS-EPR-R78 (SUB3 1) - (WE-LFPRM * .5)
 16389           GO TO S-4190-EP-DO-LF-COMM
 16390        ELSE
 16391        IF (CR-CCYY EQUAL OB-CCYY (1)) AND
 16392           (CR-MO EQUAL OB-MO (1))
 16393           MOVE '*'            TO OB-DATE-2-SWITCH
 16394           MOVE EW-REIN-CO     TO WS-OB-REIN-CO (SUB3)
 16395           MOVE LIFE-OVERRIDE-L1 TO WS-OB-LF-AH (SUB3)
 16396           MOVE CR-LFTYP       TO WS-OB-BENEFIT-CODE (SUB3)
 16397           COMPUTE WS-EPR-R78 (SUB3 2) =
 16398                   WS-EPR-R78 (SUB3 2) - (WE-LFPRM * .5)
 16399           GO TO S-4190-EP-DO-LF-COMM
 16400        ELSE
 16401        IF (CR-CCYY EQUAL OB-CCYY (2)) AND
 16402           (CR-MO EQUAL OB-MO (2))
 16403           MOVE '*'            TO OB-DATE-3-SWITCH
 16404           MOVE EW-REIN-CO     TO WS-OB-REIN-CO (SUB3)
 16405           MOVE LIFE-OVERRIDE-L1 TO WS-OB-LF-AH (SUB3)
 16406           MOVE CR-LFTYP       TO WS-OB-BENEFIT-CODE (SUB3)
 16407           COMPUTE WS-EPR-R78 (SUB3 3) =
 16408                   WS-EPR-R78 (SUB3 3) - (WE-LFPRM * .5)
 16409           GO TO S-4190-EP-DO-LF-COMM
 16410        ELSE
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 319
* ECS010Z.cbl
 16411           GO TO S-4190-EP-DO-LF-COMM.
 16412
 16413     COMPUTE TEMP-1 = CR-LF-TERM * (CR-LF-TERM + 1).
 16414
 16415     IF DTE-R78 = '1'
 16416         COMPUTE TEMP-2 = REM-TRM1 * REM-TRM1
 16417     ELSE
 16418         COMPUTE TEMP-2 = REM-TRM1 * (REM-TRM1 + 1).
 16419
 16420     COMPUTE TEMP-4 ROUNDED EQUAL TEMP-2 / TEMP-1.
 16421
 16422     IF REM-TRM1 GREATER THAN +0
 16423         COMPUTE TEMP-7 ROUNDED EQUAL
 16424             WE-LFPRM - (WE-LFPRM * TEMP-4)
 16425     ELSE
 16426         MOVE WE-LFPRM                TO TEMP-7.
 16427
 16428     IF CLAS-I-EP (CLAS-INDEXL) NOT = 'B'
 16429         MOVE ZEROS                  TO TEMP-8
 16430         GO TO S-4165-END-LF-EP-R78.
 16431
 16432     IF EPR-ST NOT = ZEROS
 16433         MOVE TEMP-7                 TO EPR-ST.
 16434
 16435     IF CLAS-I-CALC-TYPE (CLAS-INDEXL) NOT = 'L'
 16436         COMPUTE TEMP-1 = (CR-LF-TERM + 1) * (CR-LF-TERM + 2)
 16437         COMPUTE TEMP-2 = (REM-TRM1 + 1) * (REM-TRM1 + 2)
 16438         IF DTE-R78 = '1'
 16439             COMPUTE TEMP-2 = (REM-TRM1 + 1) * (REM-TRM1 + 1).
 16440
 16441     COMPUTE TEMP-4 ROUNDED EQUAL TEMP-2 / TEMP-1.
 16442
 16443     COMPUTE TEMP-8 ROUNDED =
 16444               WE-LFPRM-ALT - (WE-LFPRM-ALT * TEMP-4).
 16445
 16446 S-4165-END-LF-EP-R78.
 16447
 16448     IF EPR-R78 = ZEROS
 16449         COMPUTE EPR-R78 = TEMP-7 + TEMP-8
 16450     ELSE
 16451         COMPUTE EPR-R78 = EPR-R78 + TEMP-8.
 16452
 16453 S-4170-EP-DO-LF-EP-PRO.
 16454
 16455     IF DTE-CLIENT = 'MIC' OR 'MCC'
 16456         COMPUTE TEMP-5 ROUNDED = (REM-TRM1 - .5) / CR-LF-TERM
 16457     ELSE
 16458         COMPUTE TEMP-5 ROUNDED = REM-TRM1 / CR-LF-TERM.
 16459
 16460     IF REM-TRM1 GREATER THAN +0
 16461         COMPUTE TEMP-7 ROUNDED = WE-LFPRM - (WE-LFPRM * TEMP-5)
 16462     ELSE
 16463         MOVE WE-LFPRM                  TO TEMP-7.
 16464
 16465     IF CLAS-I-EP (CLAS-INDEXL) NOT = 'B'
 16466         MOVE ZEROS                     TO TEMP-8
 16467         GO TO S-4175-END-LF-EP-PRO.
 16468
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 320
* ECS010Z.cbl
 16469     IF CLAS-I-CALC-TYPE (CLAS-INDEXL) NOT = 'L'
 16470         IF DTE-CLIENT = 'MIC' OR 'MCC'
 16471             COMPUTE TEMP-5 ROUNDED =
 16472                           (REM-TRM1 + .5) / (CR-LF-TERM + 1)
 16473         ELSE
 16474             COMPUTE TEMP-5 ROUNDED =
 16475                           (REM-TRM1 + 1) / (CR-LF-TERM + 1).
 16476
 16477     COMPUTE TEMP-8 ROUNDED =
 16478                   WE-LFPRM-ALT - (WE-LFPRM-ALT * TEMP-5).
 16479
 16480     COMPUTE EPR-ST = EPR-ST + TEMP-8.
 16481
 16482 S-4175-END-LF-EP-PRO.
 16483
 16484     COMPUTE EPR-PRO = TEMP-7 + TEMP-8.
 16485
 16486     GO TO S-4185-EP-DO-LF-STATUTORY.
 16487
 16488 S-4180-EP-DO-LF-EP-SUM.
 16489
 16490     IF REM-TRM1 NOT GREATER +0
 16491         COMPUTE EPR-R78 = (WE-LFPRM + WE-LFPRM-ALT) - WE-LFRFND
 16492         MOVE EPR-R78 TO EPR-PRO  EPR-ST
 16493         GO TO S-4190-EP-DO-LF-COMM.
 16494
 16495     IF WE-LFPRM = ZERO  AND  WE-LFPRM-ALT = ZERO
 16496         MOVE ZEROS                 TO TEMP-7
 16497     ELSE
 16498         COMPUTE TEMP-7 ROUNDED = WE-LFPRM - (WE-LFRFND *
 16499                       (WE-LFPRM / (WE-LFPRM + WE-LFPRM-ALT))).
 16500
 16501     IF TEMP-7 NOT GREATER ZERO
 16502         IF CLAS-I-EP (CLAS-INDEXL) NOT = 'B'
 16503             MOVE ZEROS             TO EPR-R78  EPR-PRO  EPR-ST
 16504             GO TO S-4190-EP-DO-LF-COMM
 16505         ELSE
 16506             MOVE ZEROS             TO TEMP-7.
 16507
 16508     COMPUTE TEMP-1 = CR-LF-TERM * (CR-LF-TERM + 1).
 16509     COMPUTE TEMP-2 = REM-TRM1 * (REM-TRM1 + 1).
 16510     IF DTE-R78 = '1'
 16511         COMPUTE TEMP-2 = REM-TRM1 * REM-TRM1.
 16512
 16513     COMPUTE TEMP-4 ROUNDED = TEMP-2 / TEMP-1.
 16514     COMPUTE TEMP-5 ROUNDED = REM-TRM1 / CR-LF-TERM.
 16515
 16516     COMPUTE EPR-R78 ROUNDED = TEMP-7 - (TEMP-7 * TEMP-4).
 16517
 16518     COMPUTE EPR-PRO ROUNDED = TEMP-7 - (TEMP-7 * TEMP-5).
 16519
 16520     IF CLAS-I-EP (CLAS-INDEXL) NOT = 'B'
 16521         GO TO S-4185-EP-DO-LF-STATUTORY.
 16522
 16523     MOVE EPR-R78                  TO EPR-ST.
 16524
 16525     IF WE-LFPRM = ZERO  AND  WE-LFPRM-ALT = ZERO
 16526         MOVE ZEROS                 TO TEMP-8
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 321
* ECS010Z.cbl
 16527     ELSE
 16528         COMPUTE TEMP-8 ROUNDED = WE-LFPRM-ALT - (WE-LFRFND *
 16529                     (WE-LFPRM-ALT / (WE-LFPRM + WE-LFPRM-ALT))).
 16530
 16531     IF TEMP-8 NOT GREATER ZERO
 16532         GO TO S-4185-EP-DO-LF-STATUTORY.
 16533
 16534     COMPUTE EPR-R78 ROUNDED = EPR-R78 +
 16535                              (TEMP-8 - (TEMP-8 * TEMP-4)).
 16536
 16537     COMPUTE EPR-PRO ROUNDED = EPR-PRO +
 16538                              (TEMP-8 - (TEMP-8 * TEMP-5)).
 16539
 16540     COMPUTE EPR-ST ROUNDED = EPR-ST +
 16541                             (TEMP-8 - (TEMP-8 * TEMP-5)).
 16542
 16543 S-4185-EP-DO-LF-STATUTORY.
 16544
 16545     IF STATE-ABBR (CLAS-INDEXS) = 'AL'
 16546         MOVE EPR-R78                TO EPR-ST.
 16547
 16548     IF STATE-ABBR (CLAS-INDEXS) = 'WY'
 16549         MOVE EPR-PRO                TO EPR-ST.
 16550
 16551     IF EPR-ST NOT = ZEROS
 16552         GO TO S-4190-EP-DO-LF-COMM.
 16553
 16554     IF CLAS-I-RL-AH (CLAS-INDEXL) = 'R'
 16555         MOVE EPR-R78                TO EPR-ST
 16556     ELSE
 16557         MOVE EPR-PRO                TO EPR-ST.
 16558
 16559 S-4190-EP-DO-LF-COMM.
 16560
 16561     IF EARNED-BY-CANCEL = ZEROS
 16562         GO TO S-4195-LF-COMM-CONTINUE.
 16563
 16564     IF EPR-R78 GREATER THAN EARNED-BY-CANCEL
 16565         MOVE EARNED-BY-CANCEL     TO EPR-R78.
 16566
 16567     IF EPR-PRO GREATER THAN EARNED-BY-CANCEL
 16568         MOVE EARNED-BY-CANCEL     TO EPR-PRO.
 16569
 16570     IF EPR-ST  GREATER THAN EARNED-BY-CANCEL
 16571         MOVE EARNED-BY-CANCEL     TO EPR-ST.
 16572
 16573 S-4195-LF-COMM-CONTINUE.
 16574
 16575     MOVE +0 TO SUB1.
 16576     PERFORM S-4300-EP-COMM-LOOP THRU S-4399-EP-COMM-LOOP-X
 16577         10 TIMES.
 16578
 16579     COMPUTE EW-EPR-R78 = EW-EPR-R78 - EPR-R78.
 16580     COMPUTE EW-EPR-PRO = EW-EPR-PRO - EPR-PRO.
 16581     COMPUTE EW-EPR-ST  = EW-EPR-ST  - EPR-ST.
 16582
 16583     COMPUTE EW-EPR-R78-ADJ = EW-EPR-R78-ADJ + EPR-R78.
 16584     COMPUTE EW-EPR-PRO-ADJ = EW-EPR-PRO-ADJ + EPR-PRO.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 322
* ECS010Z.cbl
 16585     COMPUTE EW-EPR-ST-ADJ  = EW-EPR-ST-ADJ  + EPR-ST.
 16586
 16587     MOVE 'Y'          TO EW-LEVEL-USED.
 16588
 16589     IF CR-POLICY-UNDERWRITTEN
 16590         MOVE EPEC-WORK       TO EPEC-LEVELS-II (SUB3)
 16591
 16592     ELSE
 16593         MOVE EPEC-WORK       TO EPEC-LEVELS (SUB3).
 16594
 16595     GO TO S-4200-EP-DO-AH.
 16596
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 323
* ECS010Z.cbl
 16598******************************************************************
 16599***  C A L C U L A T E   A & H   S T A R T   E A R N E D       ***
 16600******************************************************************
 16601
 16602 S-4200-EP-DO-AH.
 16603
 16604     MOVE +0                         TO EPR-R78  EARNED-BY-CANCEL
 16605                                        EPR-PRO
 16606                                        EPR-ST.
 16607
 16608     IF CR-AHTYP = ZERO
 16609         GO TO S-4299-EPBX.
 16610
 16611     IF REIN-AH-FLG (SUB5) = SPACE
 16612         GO TO S-4299-EPBX.
 16613
 16614     MOVE AH-OVERRIDE-L1       TO WE-LF-AH.
 16615     MOVE CR-AHTYP             TO WE-BEN-TYPE.
 16616     PERFORM 4400-EP-FIND-TAB-ENT THRU 4499-EP-FIND-TAB-ENT-X.
 16617
 16618     MOVE CR-AH-TERM           TO ORIG-TERM.
 16619     MOVE CLAS-INDEXA          TO W-NDX.
 16620
 16621     MOVE EARNING-START-DATE     TO VALUATION-DT.
 16622     MOVE '9'                    TO W-VAL-SOURCE.
 16623     PERFORM 8500-REMAINING-TERM-ROUTINE THRU 8599-REM-TERM-X.
 16624
 16625 S-4220-EP-DO-AH-CNCL.
 16626
 16627     IF CR-AH-STATUS-AT-CANCEL NOT = ' '
 16628         COMPUTE EARNED-BY-CANCEL = WE-AHPRM - WE-AHRFND.
 16629
 16630 S-4230-EP-DO-AH-EP.
 16631
 16632     IF REM-TRM2 GREATER CR-AH-TERM
 16633         MOVE +0 TO EPR-R78  EPR-PRO  EPR-ST
 16634         GO TO S-4290-EP-DO-AH-COMM.
 16635
 16636     IF CLAS-I-CALC-TYPE (CLAS-INDEXA) = 'Z'
 16637         COMPUTE WE-AHPRM = WE-AHPRM - WE-AHRFND.
 16638
 16639 S-4235-CHECK-OB-AH-NCL.
 16640
 16641     IF (DTE-CLIENT EQUAL 'NCL') AND
 16642        (CLAS-I-CALC-TYPE (CLAS-INDEXA) EQUAL 'B')
 16643           MOVE WE-AHPRM         TO EPR-R78
 16644                                    EPR-PRO
 16645                                    EPR-ST
 16646        IF (CR-CCYY EQUAL EOM-CCYY) AND
 16647           (CR-MO EQUAL EOM-MO)
 16648           MOVE '*'            TO OB-DATE-1-SWITCH
 16649           MOVE EW-REIN-CO     TO WS-OB-REIN-CO (SUB3)
 16650           MOVE AH-OVERRIDE-L1 TO WS-OB-LF-AH (SUB3)
 16651           MOVE CR-AHTYP       TO WS-OB-BENEFIT-CODE (SUB3)
 16652           COMPUTE WS-EPR-R78 (SUB3 1) =
 16653                   WS-EPR-R78 (SUB3 1) - (WE-AHPRM * .5)
 16654            GO TO S-4290-EP-DO-AH-COMM
 16655        ELSE
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 324
* ECS010Z.cbl
 16656        IF (CR-CCYY EQUAL OB-CCYY (1)) AND
 16657           (CR-MO EQUAL OB-MO (1))
 16658           MOVE '*'            TO OB-DATE-2-SWITCH
 16659           MOVE EW-REIN-CO     TO WS-OB-REIN-CO (SUB3)
 16660           MOVE AH-OVERRIDE-L1 TO WS-OB-LF-AH (SUB3)
 16661           MOVE CR-AHTYP       TO WS-OB-BENEFIT-CODE (SUB3)
 16662           COMPUTE WS-EPR-R78 (SUB3 2) =
 16663                   WS-EPR-R78 (SUB3 2) - (WE-AHPRM * .5)
 16664            GO TO S-4290-EP-DO-AH-COMM
 16665        ELSE
 16666        IF (CR-CCYY EQUAL OB-CCYY (2)) AND
 16667           (CR-MO EQUAL OB-MO (2))
 16668           MOVE '*'            TO OB-DATE-3-SWITCH
 16669           MOVE EW-REIN-CO     TO WS-OB-REIN-CO (SUB3)
 16670           MOVE AH-OVERRIDE-L1 TO WS-OB-LF-AH (SUB3)
 16671           MOVE CR-AHTYP       TO WS-OB-BENEFIT-CODE (SUB3)
 16672           COMPUTE WS-EPR-R78 (SUB3 3) =
 16673                   WS-EPR-R78 (SUB3 3) - (WE-AHPRM * .5)
 16674            GO TO S-4290-EP-DO-AH-COMM
 16675        ELSE
 16676            GO TO S-4290-EP-DO-AH-COMM.
 16677
 16678     IF REM-TRM2 NOT GREATER +0
 16679         MOVE WE-AHPRM TO EPR-R78  EPR-PRO  EPR-ST
 16680         GO TO S-4290-EP-DO-AH-COMM.
 16681
 16682     IF CLAS-I-CALC-TYPE (CLAS-INDEXA) = 'B'
 16683         MOVE WE-AHPRM TO EPR-R78  EPR-PRO  EPR-ST
 16684         GO TO S-4290-EP-DO-AH-COMM.
 16685
 16686     COMPUTE TEMP-1 = CR-AH-TERM * (CR-AH-TERM + 1).
 16687     COMPUTE TEMP-2 = REM-TRM1 * (REM-TRM1 + 1).
 16688     IF DTE-R78 = '1'
 16689         COMPUTE TEMP-2 = REM-TRM1 * REM-TRM1.
 16690     COMPUTE TEMP-4 ROUNDED = TEMP-2 / TEMP-1.
 16691
 16692     IF DTE-CLIENT = 'MIC' OR 'MCC'
 16693         COMPUTE TEMP-5 ROUNDED = (REM-TRM1 - .5) / CR-AH-TERM
 16694     ELSE
 16695         COMPUTE TEMP-5 ROUNDED = REM-TRM1 / CR-AH-TERM.
 16696
 16697     COMPUTE EPR-R78 ROUNDED = WE-AHPRM * TEMP-4.
 16698     COMPUTE EPR-R78 = WE-AHPRM - EPR-R78.
 16699
 16700     COMPUTE EPR-PRO ROUNDED = WE-AHPRM * TEMP-5.
 16701     COMPUTE EPR-PRO = WE-AHPRM - EPR-PRO.
 16702
 16703     MOVE  CLAS-I-EP (CLAS-INDEXA) TO AH-EARN-METHOD.
 16704
 16705*    IF AM-EARN-METHOD-A NOT EQUAL SPACES AND ZEROS
 16706*        MOVE AM-EARN-METHOD-A TO AH-EARN-METHOD.
 16707
 16708     MOVE SPACES TO STATUTORY-SWITCH-AH.
 16709
 16710     IF (STATE-ABBR (CLAS-INDEXS) = 'VA') AND
 16711        (CR-DT GREATER THAN  19921231)
 16712         IF CR-AH-TERM GREATER THAN  +61
 16713             MOVE 'A' TO AH-EARN-METHOD
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 325
* ECS010Z.cbl
 16714             MOVE '*' TO STATUTORY-SWITCH-AH
 16715             GO TO S-4245-EP-DO-AH-EP-AN
 16716         ELSE
 16717             GO TO S-4250-EP-DO-AH-STATUTORY.
 16718
 16719     IF AH-EARN-METHOD EQUAL 'N'
 16720         GO TO S-4240-EP-DO-AH-EP-NP.
 16721
 16722     IF AH-EARN-METHOD EQUAL 'A' OR 'C'
 16723         MOVE 'A' TO AH-EARN-METHOD
 16724         GO TO S-4245-EP-DO-AH-EP-AN.
 16725
 16726     GO TO S-4250-EP-DO-AH-STATUTORY.
 16727
 16728 S-4240-EP-DO-AH-EP-NP.
 16729
 16730     IF WE-AHPRM = ZERO
 16731         GO TO S-4250-EP-DO-AH-STATUTORY.
 16732
 16733     IF CR-APR GREATER THAN +0
 16734         NEXT SENTENCE
 16735     ELSE
 16736         GO TO S-4250-EP-DO-AH-STATUTORY.
 16737
 16738     IF DTE-CLIENT = 'NCL'
 16739       IF CR-DT LESS THAN 19910101
 16740           GO TO S-4250-EP-DO-AH-STATUTORY.
 16741
 16742     IF REM-TRM1 = CR-AH-TERM
 16743         MOVE +0 TO EPR-R78  EPR-PRO  EPR-ST
 16744         GO TO S-4290-EP-DO-AH-COMM.
 16745
 16746     MOVE CR-APR TO NP-APR.
 16747     MOVE CR-AH-TERM TO NP-ORIG  NP-CAP.
 16748     MOVE REM-TRM1 TO NP-REM.
 16749     MOVE CLAS-I-CALC-TYPE (CLAS-INDEXA) TO NP-OPT.
 16750     IF NP-OPT = 'T' OR 'U' OR 'V' OR 'W' OR 'X'
 16751         MOVE CR-LOAN-TERM TO NP-ORIG.
 16752     MOVE 'R' TO NP-OPT.
 16753     CALL 'ECSNETRM'
 16754         USING NP-APR NP-ORIG NP-REM NP-OPT NP-CAP NP-FACTOR.
 16755
 16756     COMPUTE EPR-R78 ROUNDED = WE-AHPRM - (NP-FACTOR * WE-AHPRM).
 16757
 16758     GO TO S-4250-EP-DO-AH-STATUTORY.
 16759
 16760 S-4245-EP-DO-AH-EP-AN.
 16761     MOVE CR-DT                      TO DC-GREG-DATE-CYMD.
 16762     MOVE 'L'                        TO DC-OPTION-CODE.
 16763     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 16764     MOVE DC-BIN-DATE-1              TO CP-CERT-EFF-DT.
 16765     MOVE CLAS-I-RL-AH (CLAS-INDEXA) TO CP-BENEFIT-TYPE.
 16766     MOVE SPACES                     TO CP-ACCT-FLD-5.
 16767     MOVE DTE-CLIENT                 TO CP-COMPANY-ID.
 16768     MOVE STATE-SUB (CLAS-INDEXS)    TO CP-STATE.
 16769     MOVE STATE-ABBR (CLAS-INDEXS)   TO CP-STATE-STD-ABBRV.
 16770     MOVE CR-AGE                     TO CP-ISSUE-AGE.
 16771     MOVE REM-TRM1                   TO CP-ORIGINAL-TERM.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 326
* ECS010Z.cbl
 16772     MOVE CR-AHAMT                   TO CP-ORIGINAL-BENEFIT
 16773                                        CP-RATING-BENEFIT-AMT.
 16774     IF CP-STATE-STD-ABBRV = 'OR'
 16775         COMPUTE CP-RATING-BENEFIT-AMT =
 16776                                  CR-AHAMT * REM-TRM1.
 16777     MOVE CR-APR                     TO CP-LOAN-APR.
 16778     MOVE CR-PMT-FREQ                TO CP-PAY-FREQUENCY.
 16779     MOVE AH-EARN-METHOD             TO CP-EARNING-METHOD.
 16780     MOVE '3'                        TO CP-PROCESS-TYPE.
 16781     MOVE CLAS-I-BAL (CLAS-INDEXA)   TO CP-SPECIAL-CALC-CD.
 16782     MOVE CR-LOAN-TERM               TO CP-LOAN-TERM.
 16783
 16784     IF CR-RATING-CLASS NOT = SPACE AND ZERO
 16785         MOVE CR-RATING-CLASS        TO CP-CLASS-CODE
 16786     ELSE
 16787         MOVE AM-CAL-TABLE           TO CP-CLASS-CODE.
 16788
 16789     MOVE AM-AH-DEVIATION            TO CP-DEVIATION-CODE.
 16790     MOVE CR-AHTYP                   TO CP-BENEFIT-CD.
 16791     MOVE DTE-CLASIC-COMPANY-CD      TO CP-COMPANY-CD.
 16792     MOVE CR-PMT-EXTENSION-DAYS      TO CP-TERM-OR-EXT-DAYS.
 16793     MOVE AH-OVERRIDE-L1             TO CP-AH-OVERRIDE-CODE.
 16794     MOVE AM-AH-DEVIATION-PCT        TO CP-RATE-DEV-PCT.
 16795
 16796     PERFORM 8100-GET-RATE THRU 8199-GET-RATE-X.
 16797
 16798     IF CP-ERROR-RATE-NOT-FOUND  OR
 16799        CP-ERROR-RATE-IS-ZERO  OR
 16800        CP-ERROR-IN-DATES
 16801         GO TO S-4250-EP-DO-AH-STATUTORY.
 16802
 16803     COMPUTE EPR-R78 ROUNDED =
 16804             ((REM-TRM1 * WE-AHAMT) / +100) *
 16805               CP-PREMIUM-RATE.
 16806
 16807     COMPUTE EPR-R78 = WE-AHPRM - EPR-R78.
 16808
 16809     IF STATUTORY-REQUIREMENT-AH
 16810         MOVE EPR-R78                TO EPR-ST
 16811         GO TO S-4290-EP-DO-AH-COMM.
 16812
 16813 S-4250-EP-DO-AH-STATUTORY.
 16814     MOVE EPR-R78                    TO EPR-ST.
 16815
 16816     MOVE +0                         TO SUB1.
 16817
 16818 S-4255-EP-AH-STAT-LOOP.
 16819     ADD +1 TO SUB1.
 16820
 16821     IF STATE-ABBR (CLAS-INDEXS) = AH-RES-STATE-ENT (SUB1)
 16822         MOVE EPR-PRO                TO EPR-ST
 16823     ELSE
 16824         IF AH-RES-STATE-ENT (SUB1) NOT = HIGH-VALUES
 16825             GO TO S-4255-EP-AH-STAT-LOOP.
 16826
 16827     IF (STATE-ABBR (CLAS-INDEXS) = 'OH'  AND
 16828         CR-DT GREATER THAN 19831031)
 16829                    OR
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 327
* ECS010Z.cbl
 16830        (STATE-ABBR (CLAS-INDEXS) = 'OK'  AND
 16831         CR-DT GREATER THAN 19820629)
 16832                    OR
 16833        (STATE-ABBR (CLAS-INDEXS) = 'TX'  AND
 16834         CR-DT GREATER THAN 19830831)
 16835             COMPUTE EPR-ST = (EPR-R78 + EPR-PRO) / 2.
 16836
 16837     IF DTE-CLIENT = 'CSO'  OR  'CID'
 16838       IF STATE-ABBR (CLAS-INDEXS) = 'CO'
 16839         IF CR-DT LESS THAN 19970101
 16840             MOVE EPR-R78            TO EPR-ST
 16841         ELSE
 16842             COMPUTE EPR-ST = (EPR-R78 + EPR-PRO) / 2.
 16843
 16844 S-4290-EP-DO-AH-COMM.
 16845
 16846     IF EARNED-BY-CANCEL = ZEROS
 16847         GO TO S-4295-AH-COMM-CONTINUE.
 16848
 16849     IF EPR-R78 GREATER THAN EARNED-BY-CANCEL
 16850         MOVE EARNED-BY-CANCEL     TO EPR-R78.
 16851
 16852     IF EPR-PRO GREATER THAN EARNED-BY-CANCEL
 16853         MOVE EARNED-BY-CANCEL     TO EPR-PRO.
 16854
 16855     IF EPR-ST  GREATER THAN EARNED-BY-CANCEL
 16856         MOVE EARNED-BY-CANCEL     TO EPR-ST.
 16857
 16858 S-4295-AH-COMM-CONTINUE.
 16859
 16860     MOVE +0           TO SUB1.
 16861     PERFORM S-4300-EP-COMM-LOOP THRU S-4399-EP-COMM-LOOP-X
 16862         10 TIMES.
 16863
 16864     COMPUTE EW-EPR-R78 = EW-EPR-R78 - EPR-R78.
 16865     COMPUTE EW-EPR-PRO = EW-EPR-PRO - EPR-PRO.
 16866     COMPUTE EW-EPR-ST  = EW-EPR-ST  - EPR-ST.
 16867
 16868     COMPUTE EW-EPR-R78-ADJ = EW-EPR-R78-ADJ + EPR-R78.
 16869     COMPUTE EW-EPR-PRO-ADJ = EW-EPR-PRO-ADJ + EPR-PRO.
 16870     COMPUTE EW-EPR-ST-ADJ  = EW-EPR-ST-ADJ  + EPR-ST.
 16871
 16872     MOVE 'Y'          TO EW-LEVEL-USED.
 16873
 16874     IF CR-POLICY-UNDERWRITTEN
 16875         MOVE EPEC-WORK       TO EPEC-LEVELS-II (SUB3)
 16876     ELSE
 16877         MOVE EPEC-WORK       TO EPEC-LEVELS (SUB3).
 16878
 16879
 16880 S-4299-EPBX.
 16881     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 328
* ECS010Z.cbl
 16883******************************************************************
 16884***    C A L C U L A T E   S T A R T   E A R N E D   C O M M   ***
 16885******************************************************************
 16886
 16887 S-4300-EP-COMM-LOOP.
 16888
 16889     ADD +1 TO SUB1.
 16890     IF CR-COM-AGT (SUB1) = SPACES OR ZEROS
 16891         GO TO S-4399-EP-COMM-LOOP-X.
 16892
 16893     IF EW-LF-AH = AH-OVERRIDE-L1
 16894         GO TO S-4350-EP-COMM-LOOP-A.
 16895
 16896     COMPUTE COMM-WK ROUNDED = EPR-R78 * CR-LCOM-L (SUB1).
 16897     COMPUTE EW-ECR-R78 (SUB1) = EW-ECR-R78 (SUB1) - COMM-WK.
 16898     COMPUTE EW-ECR-R78-ADJ (SUB1) =
 16899                                 EW-ECR-R78-ADJ (SUB1) + COMM-WK.
 16900
 16901     COMPUTE COMM-WK ROUNDED = EPR-PRO * CR-LCOM-L (SUB1).
 16902     COMPUTE EW-ECR-PRO (SUB1) = EW-ECR-PRO (SUB1) - COMM-WK.
 16903     COMPUTE EW-ECR-PRO-ADJ (SUB1) =
 16904                                 EW-ECR-PRO-ADJ (SUB1) + COMM-WK.
 16905
 16906     COMPUTE COMM-WK ROUNDED = EPR-ST * CR-LCOM-L (SUB1).
 16907     COMPUTE EW-ECR-ST (SUB1) = EW-ECR-ST (SUB1) - COMM-WK.
 16908
 16909     GO TO S-4399-EP-COMM-LOOP-X.
 16910
 16911 S-4350-EP-COMM-LOOP-A.
 16912
 16913     COMPUTE COMM-WK ROUNDED = EPR-R78 * CR-LCOM-AH (SUB1).
 16914     COMPUTE EW-ECR-R78 (SUB1) = EW-ECR-R78 (SUB1) - COMM-WK.
 16915     COMPUTE EW-ECR-R78-ADJ (SUB1) =
 16916                                 EW-ECR-R78-ADJ (SUB1) + COMM-WK.
 16917
 16918     COMPUTE COMM-WK ROUNDED = EPR-PRO * CR-LCOM-AH (SUB1).
 16919     COMPUTE EW-ECR-PRO (SUB1) = EW-ECR-PRO (SUB1) - COMM-WK.
 16920     COMPUTE EW-ECR-PRO-ADJ (SUB1) =
 16921                                 EW-ECR-PRO-ADJ (SUB1) + COMM-WK.
 16922
 16923     COMPUTE COMM-WK ROUNDED = EPR-ST * CR-LCOM-AH (SUB1).
 16924     COMPUTE EW-ECR-ST (SUB1) = EW-ECR-ST (SUB1) - COMM-WK.
 16925
 16926 S-4399-EP-COMM-LOOP-X.
 16927     EXIT.
 16928
 16929******************************************************************
 16930******************************************************************
 16931******************************************************************
 16932******************************************************************
 16933******************************************************************
 16934******************************************************************
 16935******************************************************************
 16936******************************************************************
 16937******************************************************************
 16938******************************************************************
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 329
* ECS010Z.cbl
 16940******************************************************************
 16941***     F I N D   R E I N S U R A N C E   T A B L E   S U B    ***
 16942******************************************************************
 16943
 16944 4400-EP-FIND-TAB-ENT.
 16945
 16946     IF WE-REIN-CO = EPEC-SUB-REIN (SUB9)
 16947         GO TO 4490-EP-FIND-TAB-SUB.
 16948     MOVE +1 TO SUB9.
 16949
 16950 4450-EP-FIND-TAB-LOOP.
 16951
 16952     IF WE-REIN-CO = EPEC-SUB-REIN (SUB9)
 16953         GO TO 4490-EP-FIND-TAB-SUB.
 16954     IF EPEC-SUB-REIN (SUB9) = ZEROS
 16955         MOVE WE-REIN-CO TO EPEC-SUB-REIN (SUB9)
 16956         GO TO 4490-EP-FIND-TAB-SUB.
 16957
 16958     ADD +1 TO SUB9.
 16959     IF SUB9 GREATER THAN +31
 16960         DISPLAY 'EPEC SUBSCRIPT TABLE FULL ' AM-MSTR-CNTRL
 16961         MOVE 0201 TO WS-ABEND-CODE
 16962         DISPLAY '******************************'
 16963         DISPLAY '***** ERROR LOCATION 020 *****'
 16964         DISPLAY '******************************'
 16965         MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
 16966         GO TO ABEND-PGM.
 16967
 16968     GO TO 4450-EP-FIND-TAB-LOOP.
 16969
 16970 4490-EP-FIND-TAB-SUB.
 16971
 16972     IF WE-LF-AH = LIFE-OVERRIDE-L1
 16973         IF EPEC-SUB-LF (SUB9 CLAS-INDEXL) = ZERO
 16974             ADD +1 TO SUB10
 16975             MOVE SUB10 TO SUB3
 16976             MOVE SUB10 TO EPEC-SUB-LF (SUB9 CLAS-INDEXL)
 16977         ELSE
 16978             MOVE EPEC-SUB-LF (SUB9 CLAS-INDEXL) TO SUB3.
 16979
 16980     IF WE-LF-AH = AH-OVERRIDE-L1
 16981         IF EPEC-SUB-AH (SUB9 CLAS-INDEXA) = ZERO
 16982             ADD +1 TO SUB10
 16983             MOVE SUB10 TO SUB3
 16984             MOVE SUB10 TO EPEC-SUB-AH (SUB9 CLAS-INDEXA)
 16985         ELSE
 16986             MOVE EPEC-SUB-AH (SUB9 CLAS-INDEXA) TO SUB3.
 16987
 16988*    IF SUB3 GREATER THAN +220
 16989*    IF SUB3 GREATER THAN +300
 16990     IF SUB3 GREATER THAN +900
 16991         DISPLAY 'SUB3 VALUE IS - ' SUB3
 16992         DISPLAY 'EPEC WORK TABLE FULL ' AM-MSTR-CNTRL
 16993         MOVE 0202 TO WS-ABEND-CODE
 16994         DISPLAY '******************************'
 16995         DISPLAY '***** ERROR LOCATION 021 *****'
 16996         DISPLAY '******************************'
 16997         MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 330
* ECS010Z.cbl
 16998         GO TO ABEND-PGM.
 16999
 17000     IF CR-POLICY-UNDERWRITTEN
 17001         MOVE EPEC-LEVELS-II (SUB3)  TO EPEC-WORK
 17002         MOVE EPEC-UNDW-OPT-DATA-TABLE
 17003                                     TO EPEC-OPT-WORK-TABLE
 17004     ELSE
 17005         MOVE EPEC-LEVELS (SUB3)     TO EPEC-WORK
 17006         MOVE EPEC-OPT-DATA-TABLE    TO EPEC-OPT-WORK-TABLE.
 17007
 17008     MOVE WE-REIN-CO         TO EW-REIN-CO
 17009                                EPEC-REIN-CO (SUB3)
 17010                                EPEC-REIN-CO-II (SUB3).
 17011     MOVE WE-LF-AH           TO EW-LF-AH
 17012                                EPEC-LF-AH (SUB3)
 17013                                EPEC-LF-AH-II (SUB3).
 17014     MOVE WE-BEN-TYPE        TO EW-BEN-TYPE
 17015                                EPEC-BEN-TYPE (SUB3)
 17016                                EPEC-BEN-TYPE-II (SUB3).
 17017
 17018 4499-EP-FIND-TAB-ENT-X.
 17019     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 331
* ECS010Z.cbl
 17021******************************************************************
 17022***         B U I L D   S U M M A R Y   E X T R A C T S        ***
 17023******************************************************************
 17024
 17025 4500-BUILD-EPEC-EXTRACT.
 17026
 17027     PERFORM 4510-BUILD-EPEC-EXT THRU 4519-BUILD-EPEC-EXT-X
 17028         VARYING SUB2 FROM +1 BY +1
 17029             UNTIL EPEC-REIN-CO (SUB2) = ZEROS.
 17030
 17031     PERFORM 4550-CLEAR-EPEC-TOTALS THRU 4589-CLEAR-EPEC-TOTALS-X.
 17032
 17033     GO TO 4599-BUILD-EPEC-EXTRACT-X.
 17034
 17035
 17036 4510-BUILD-EPEC-EXT.
 17037
 17038     MOVE EPEC-LEVELS (SUB2)            TO EPEC-WORK.
 17039     MOVE EPEC-OPT-DATA-TABLE           TO EPEC-OPT-WORK-TABLE.
 17040     IF EW-LEVEL-USED = 'Y'
 17041         MOVE SPACE                     TO W-UNDERWRITING-SW
 17042         PERFORM 4511-BUILD-EPEC-RECORD THRU
 17043                 4518-BUILD-EPEC-RCD-X.
 17044
 17045     MOVE EPEC-LEVELS-II (SUB2)         TO EPEC-WORK.
 17046     MOVE EPEC-UNDW-OPT-DATA-TABLE      TO EPEC-OPT-WORK-TABLE.
 17047     IF EW-LEVEL-USED = 'Y'
 17048         MOVE '*'                       TO W-UNDERWRITING-SW
 17049         PERFORM 4511-BUILD-EPEC-RECORD THRU
 17050                 4518-BUILD-EPEC-RCD-X.
 17051
 17052     GO TO 4519-BUILD-EPEC-EXT-X.
 17053
 17054 4511-BUILD-EPEC-RECORD.
 17055
 17056     MOVE SPACES                        TO EP-RECORD.
 17057     MOVE 'EP'                          TO EP-RECORD-ID.
 17058     MOVE DTE-CLASIC-COMPANY-CD         TO EP-COMPANY-CD.
 17059     MOVE AM-MSTR-CNTRL                 TO EP-CONTROL.
 17060     MOVE AM-EXPIRE-DT                  TO WS-EP-EXP-DTE-N.
 17061     MOVE AM-EFFECT-DT                  TO EP-EFF-DTE
 17062                                           WS-EP-EFF-DTE-N.
 17063     MOVE EW-REIN-CO                    TO EP-REI-CO.
 17064     IF EP-REI-CO NOT = SPACES
 17065         MOVE 'R'                       TO EP-REIN.
 17066     MOVE EW-LF-AH                      TO EP-RCD-TYPE.
 17067     MOVE EW-BEN-TYPE                   TO EP-BEN-CODE.
 17068
 17069     MOVE EW-ISS-CNT                    TO EP-ISS-CNT.
 17070     MOVE EW-ISS-BEN                    TO EP-ISS-BEN.
 17071     MOVE EW-ISS-BEN-GROSS              TO EP-ISS-BEN-GROSS.
 17072
 17073     MOVE EW-CNC-CNT                    TO EP-CNC-CNT.
 17074     MOVE EW-CNC-BEN                    TO EP-CNC-BEN.
 17075     MOVE EW-CNC-BEN-GROSS              TO EP-CNC-BEN-GROSS.
 17076
 17077     MOVE EW-ISS-PRM                    TO EP-ISS-PRM.
 17078     MOVE EW-ISS-PRM-GROSS              TO EP-ISS-PRM-GROSS.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 332
* ECS010Z.cbl
 17079     MOVE EW-CNC-PRM                    TO EP-CNC-PRM.
 17080     MOVE EW-CNC-PRM-GROSS              TO EP-CNC-PRM-GROSS.
 17081
 17082     IF DTE-CLIENT NOT = 'NCL'
 17083         GO TO 4512-BUILD-EPEC-CONTINUE.
 17084
 17085     IF W-UNDERWRITTEN-DATA
 17086         GO TO 4512-BUILD-EPEC-CONTINUE.
 17087
 17088     IF AM-EXPIRE-DT NOT GREATER THAN EOM-RUN-DATE
 17089         GO TO 4512-BUILD-EPEC-CONTINUE.
 17090
 17091     IF WS-OB-REIN-CO (SUB2) = EW-REIN-CO  AND
 17092        WS-OB-LF-AH (SUB2) = EW-LF-AH  AND
 17093        WS-OB-BENEFIT-CODE (SUB2) = EW-BEN-TYPE
 17094         NEXT SENTENCE
 17095     ELSE
 17096         GO TO 4512-BUILD-EPEC-CONTINUE.
 17097
 17098     IF OB-DATE-1-USED  OR
 17099        OB-DATE-2-USED  OR
 17100        OB-DATE-3-USED
 17101         NEXT SENTENCE
 17102     ELSE
 17103         GO TO 4512-BUILD-EPEC-CONTINUE.
 17104
 17105     IF OB-DATE-1-USED
 17106         IF WS-EPR-R78 (SUB2 1) NOT EQUAL +0
 17107             COMPUTE EW-EPR-R78 = EW-ISS-PRM - EW-CNC-PRM -
 17108                           EW-EPR-R78-ADJ - WS-EPR-R78 (SUB2 1)
 17109             MOVE EW-EPR-R78    TO EW-EPR-PRO
 17110                                   EW-EPR-ST
 17111             GO TO 4512-BUILD-EPEC-CONTINUE
 17112         ELSE
 17113             GO TO 4512-BUILD-EPEC-CONTINUE.
 17114
 17115     IF OB-DATE-2-USED
 17116         IF WS-EPR-R78 (SUB2 2) NOT EQUAL +0
 17117             COMPUTE EW-EPR-R78 = EW-ISS-PRM - EW-CNC-PRM -
 17118                           EW-EPR-R78-ADJ - WS-EPR-R78 (SUB2 2)
 17119             MOVE EW-EPR-R78    TO EW-EPR-PRO
 17120                                   EW-EPR-ST
 17121             GO TO 4512-BUILD-EPEC-CONTINUE
 17122         ELSE
 17123             GO TO 4512-BUILD-EPEC-CONTINUE.
 17124
 17125     IF OB-DATE-3-USED
 17126         IF WS-EPR-R78 (SUB2 3) NOT EQUAL +0
 17127             COMPUTE EW-EPR-R78 = EW-ISS-PRM - EW-CNC-PRM -
 17128                           EW-EPR-R78-ADJ - WS-EPR-R78 (SUB2 3)
 17129             MOVE EW-EPR-R78    TO EW-EPR-PRO
 17130                                   EW-EPR-ST
 17131             GO TO 4512-BUILD-EPEC-CONTINUE
 17132         ELSE
 17133             GO TO 4512-BUILD-EPEC-CONTINUE.
 17134
 17135 4512-BUILD-EPEC-CONTINUE.
 17136
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 333
* ECS010Z.cbl
 17137     MOVE EW-EPR-R78                    TO EP-PRM-78.
 17138     MOVE EW-EPR-PRO                    TO EP-PRM-PR.
 17139     MOVE EW-EPR-ST                     TO EP-PRM-ST.
 17140
 17141     MOVE EW-EPR-R78-ADJ                TO EP-PRM-78-ADJ.
 17142     MOVE EW-EPR-PRO-ADJ                TO EP-PRM-PR-ADJ.
 17143     MOVE EW-EPR-ST-ADJ                 TO EP-PRM-ST-ADJ.
 17144
 17145     MOVE EW-ISS-PRM-TAX                TO EP-PRM-TAX
 17146
 17147     MOVE EW-CLM-AMT                    TO EP-CLM-AMT.
 17148     MOVE EW-CLM-CNT                    TO EP-CLM-CNT.
 17149     MOVE EW-CLM-CRT                    TO EP-CLM-CRT.
 17150
 17151     MOVE EW-CLM-PAYCUR                 TO EP-CLM-DU.
 17152     MOVE ZEROS                         TO EP-CLM-PV.
 17153
 17154     IF EP-RCD-TYPE = 'A' OR 'U'
 17155         IF CARRIER-UEP-PCT (CLAS-INDEXCN) NOT = ZEROS
 17156             PERFORM 4599A-CALC-IBNR THRU 4599A-CALC-EXIT.
 17157
 17158     MOVE EW-CLM-IBNR                   TO EP-CLM-IBNR.
 17159
 17160     MOVE EW-CLM-FUTRSV                 TO EP-LOSS-RESV.
 17161     MOVE ZEROS                         TO EP-CLAIM-ADJ.
 17162
 17163     MOVE EW-INFORCE-CNT                TO EP-INFORCE-CNT.
 17164
 17165     IF EW-ISS-CNT = ZERO
 17166         MOVE ZERO                      TO EP-AVG-ORIG-TERM
 17167                                           EP-AVG-AGE
 17168       ELSE
 17169         COMPUTE EP-AVG-ORIG-TERM ROUNDED =
 17170                                EW-ORIG-TERM / EW-ISS-CNT
 17171         COMPUTE EP-AVG-AGE ROUNDED = EW-AGE / EW-ISS-CNT.
 17172
 17173     IF EW-INFORCE-CNT = ZERO
 17174         MOVE ZERO                      TO EP-AVG-REM-TERM
 17175       ELSE
 17176         COMPUTE EP-AVG-REM-TERM ROUNDED =
 17177                             EW-REM-TERM / EW-INFORCE-CNT.
 17178
 17179     IF EW-ISS-BEN = ZERO
 17180         MOVE ZERO                      TO EP-WEIGHTED-ORIG-TERM
 17181                                           EP-WEIGHTED-AGE
 17182       ELSE
 17183         COMPUTE EP-WEIGHTED-ORIG-TERM ROUNDED =
 17184                                  EW-TERM-BEN / EW-ISS-BEN
 17185         COMPUTE EP-WEIGHTED-AGE ROUNDED =
 17186                                   EW-AGE-BEN / EW-ISS-BEN.
 17187
 17188     MOVE ZEROS                         TO
 17189         EP-RETRO-EXPENSES  EP-RETRO-PAYMENTS  EP-RETRO-OTH-COMM
 17190         EP-MORT-RESV       EP-IN-FORCE        EP-ADJUST.
 17191
 17192     MOVE EW-COV-DTE                    TO EP-HI-COV-DT
 17193                                           WS-EP-HI-COV-DT-N.
 17194     MOVE HIGH-CERT                     TO EP-HI-CERT
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 334
* ECS010Z.cbl
 17195                                           WS-EP-HI-CERT-N.
 17196     MOVE LOW-CERT                      TO EP-LO-CERT
 17197                                           WS-EP-LO-CERT-N.
 17198     IF DTE-PGM-OPT = '3'
 17199         MOVE 'P'                       TO EP-PURGE.
 17200
 17201     IF  DTE-OPT-RESERVE-METHOD-UNAUTH
 17202         GO TO 4514-CONTINUE.
 17203
 17204     MOVE EPEC-CLM-EXP (SUB2)    TO EP-CLM-EXP.
 17205
 17206     IF  EPEC-LIFE-CTR-NOT-USED (SUB2)
 17207         MOVE +1                 TO EP-LIFE-YEARS
 17208     ELSE
 17209         MOVE ZEROS              TO W-LIFE-YEARS
 17210         PERFORM 4515-DETERMINE-LIFE-YEARS THRU 4515-EXIT
 17211                 VARYING
 17212             SUBM FROM +1 BY +1
 17213                 UNTIL
 17214             SUBM GREATER THAN +13
 17215         COMPUTE W-LIFE-YEARS-INT ROUNDED
 17216             = W-LIFE-YEARS / 12
 17217             - (EPEC-LIFE-CTR (SUB2 1)
 17218             + EPEC-LIFE-CTR (SUB2 13)) / 24
 17219         COMPUTE EP-LIFE-YEARS ROUNDED = W-LIFE-YEARS-INT
 17220         IF  EP-LIFE-YEARS LESS THAN +1
 17221             MOVE +1             TO EP-LIFE-YEARS.
 17222
 17223 4514-CONTINUE.
 17224
 17225     PERFORM 4900-WRITE-SUMMARY-EXTRACTS THRU 4999-WRT-SUMMARY-X.
 17226
 17227     MOVE SPACES                        TO EC-RECORD.
 17228     MOVE '1'                           TO WS-SEQ-NBR.
 17229     MOVE +0                            TO SUB3.
 17230     MOVE +0                            TO SUB4.
 17231     PERFORM 4520-BUILD-EPEC-LOAD-COMM
 17232         THRU 4539-BUILD-EPEC-LOAD-COMM-X
 17233         UNTIL SUB4  GREATER THAN WS-LOOP-MAX.
 17234
 17235     GO TO 4518-BUILD-EPEC-RCD-X.
 17236
 17237 4515-DETERMINE-LIFE-YEARS.
 17238
 17239     ADD EPEC-LIFE-CTR (SUB2 SUBM)      TO W-LIFE-YEARS.
 17240
 17241 4515-EXIT.
 17242     EXIT.
 17243
 17244 4518-BUILD-EPEC-RCD-X.
 17245     EXIT.
 17246
 17247 4519-BUILD-EPEC-EXT-X.
 17248     EXIT.
 17249
 17250 4520-BUILD-EPEC-LOAD-COMM.
 17251
 17252     PERFORM 4545-BUILD-BASE  THRU  4545-BUILD-BASE-X.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 335
* ECS010Z.cbl
 17253
 17254     ADD +1 TO SUB3  SUB4.
 17255     MOVE ZEROS                  TO LEVELS-BUILT.
 17256
 17257 4530-BUILD-EPEC-LOAD-COMM-LOOP.
 17258
 17259     IF SUB4 GREATER THAN WS-LOOP-MAX
 17260         IF AGT-SW = 'X'
 17261             PERFORM 4900-WRITE-SUMMARY-EXTRACTS
 17262                 THRU 4999-WRT-SUMMARY-X
 17263             MOVE ' '            TO AGT-SW
 17264             MOVE WS-LOOP-MAX    TO  SUB4
 17265             GO TO 4539-BUILD-EPEC-LOAD-COMM-X
 17266         ELSE
 17267             GO TO 4539-BUILD-EPEC-LOAD-COMM-X.
 17268
 17269     IF LEVELS-BUILT EQUAL +5
 17270         IF AGT-SW = 'X'
 17271             PERFORM 4900-WRITE-SUMMARY-EXTRACTS
 17272                 THRU 4999-WRT-SUMMARY-X
 17273             MOVE ' '            TO AGT-SW
 17274             MOVE ZEROS          TO LEVELS-BUILT
 17275             ADD 1 TO WS-SEQ-NBR
 17276             PERFORM 4545-BUILD-BASE  THRU  4545-BUILD-BASE-X
 17277             PERFORM 4540-BUILD-EPEC-CLEAR  THRU
 17278                     4540-BUILD-CLEAR-X
 17279                 VARYING SUB3 FROM +1 BY +1
 17280                 UNTIL SUB3 GREATER THAN +5
 17281             MOVE +1             TO SUB3
 17282             GO TO 4531-BUILD-EPEC-LOAD-COMM
 17283         ELSE
 17284             MOVE +1             TO SUB3
 17285             MOVE ZEROS          TO LEVELS-BUILT
 17286             GO TO 4531-BUILD-EPEC-LOAD-COMM.
 17287
 17288     IF SUB4 GREATER THAN WS-LOOP-MAX
 17289         IF AGT-SW = 'X'
 17290             PERFORM 4900-WRITE-SUMMARY-EXTRACTS
 17291                 THRU 4999-WRT-SUMMARY-X
 17292             MOVE ' '                   TO AGT-SW
 17293             GO TO 4539-BUILD-EPEC-LOAD-COMM-X
 17294         ELSE
 17295             GO TO 4539-BUILD-EPEC-LOAD-COMM-X.
 17296
 17297 4531-BUILD-EPEC-LOAD-COMM.
 17298
 17299     IF (EW-AGT-NO (SUB4) = SPACES)
 17300                  OR
 17301        ((EW-ISS-COM (SUB4) = ZEROS) AND
 17302         (EW-CNC-COM (SUB4) = ZEROS) AND
 17303         (EW-ECR-R78 (SUB4) = ZEROS) AND
 17304         (EW-ECR-R78-ADJ (SUB4) = ZEROS) AND
 17305         (EW-ECR-PRO (SUB4) = ZEROS) AND
 17306         (EW-ECR-PRO-ADJ (SUB4) = ZEROS) AND
 17307         (EW-ECR-ST (SUB4) = ZEROS))
 17308         PERFORM 4540-BUILD-EPEC-CLEAR
 17309             THRU 4540-BUILD-CLEAR-X
 17310         ADD +1 TO SUB4
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 336
* ECS010Z.cbl
 17311         GO TO 4530-BUILD-EPEC-LOAD-COMM-LOOP.
 17312
 17313     MOVE 'X'                           TO AGT-SW.
 17314     MOVE EW-AGT-NO (SUB4)              TO EC-AGT-NO (SUB3).
 17315     MOVE EW-AGT-TYPE (SUB4)            TO EC-AGT-TYPE (SUB3).
 17316     MOVE EW-ISS-COM (SUB4)             TO EC-ISS-COMM (SUB3).
 17317     MOVE EW-CNC-COM (SUB4)             TO EC-CNC-COMM (SUB3).
 17318     MOVE EW-ECR-R78 (SUB4)             TO EC-COMM-78 (SUB3).
 17319     MOVE EW-ECR-PRO (SUB4)             TO EC-COMM-PR (SUB3).
 17320     MOVE EW-ECR-ST (SUB4)              TO EC-COMM-ST (SUB3).
 17321     MOVE EW-ECR-R78-ADJ (SUB4)         TO EC-COMM-78-ADJ (SUB3).
 17322     MOVE EW-ECR-PRO-ADJ (SUB4)         TO EC-COMM-PR-ADJ (SUB3).
 17323
 17324     ADD +1 TO SUB3 SUB4 LEVELS-BUILT.
 17325
 17326     GO TO 4530-BUILD-EPEC-LOAD-COMM-LOOP.
 17327
 17328 4539-BUILD-EPEC-LOAD-COMM-X.
 17329     EXIT.
 17330
 17331 4540-BUILD-EPEC-CLEAR.
 17332
 17333     MOVE ZEROS                         TO EC-AGT-NO (SUB3).
 17334     MOVE SPACE                         TO EC-AGT-TYPE (SUB3).
 17335     MOVE ZEROS                         TO EC-ISS-COMM (SUB3)
 17336                                           EC-CNC-COMM (SUB3)
 17337                                           EC-COMM-78 (SUB3)
 17338                                           EC-COMM-PR (SUB3)
 17339                                           EC-COMM-ST (SUB3)
 17340                                           EC-COMM-78-ADJ (SUB3)
 17341                                           EC-COMM-PR-ADJ (SUB3).
 17342
 17343 4540-BUILD-CLEAR-X.
 17344     EXIT.
 17345
 17346 4545-BUILD-BASE.
 17347
 17348     MOVE 'EC'                   TO EC-RECORD-ID.
 17349     MOVE DTE-CLASIC-COMPANY-CD  TO EP-COMPANY-CD.
 17350     MOVE AM-MSTR-CNTRL          TO EC-CONTROL.
 17351     MOVE AM-EXPIRE-DT           TO WS-EC-EXP-DTE-N.
 17352     MOVE AM-EFFECT-DT           TO EC-EFF-DTE
 17353                                    WS-EC-EFF-DTE.
 17354     MOVE EW-REIN-CO             TO EC-REI-CO.
 17355     IF EC-REI-CO NOT = SPACES
 17356         MOVE 'R'                TO EC-REIN.
 17357     MOVE EW-LF-AH               TO EC-RCD-TYPE.
 17358     MOVE EW-BEN-TYPE            TO EC-BEN-CODE.
 17359     IF DTE-PGM-OPT = '3'
 17360         MOVE 'P'                TO EC-PURGE.
 17361     MOVE WS-SEQ-NBR             TO EC-SEQ-NBR.
 17362
 17363 4545-BUILD-BASE-X.
 17364     EXIT.
 17365
 17366******************************************************************
 17367***        CLEAR EARNED PREMIUM  AND  REINSURANCE TOTALS       ***
 17368******************************************************************
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 337
* ECS010Z.cbl
 17369
 17370 4550-CLEAR-EPEC-TOTALS.
 17371
 17372     MOVE LOW-CERT             TO SV-LO-CERT.
 17373     MOVE HIGH-CERT            TO SV-HI-CERT.
 17374     MOVE SPACES               TO LOW-CTL.
 17375     MOVE ZEROS                TO LOW-CERT  HIGH-CERT.
 17376
 17377     MOVE +1                   TO SUB9.
 17378     MOVE +0                   TO SUB10.
 17379     MOVE ZERO                 TO EW-REIN-CO
 17380                                  EW-BEN-TYPE.
 17381     MOVE SPACE                TO EP-FLG
 17382                                  EW-LF-AH
 17383                                  EW-LEVEL-USED
 17384                                  W-TABLE-USED-SW.
 17385
 17386     MOVE +0                   TO EW-ISS-BEN     EW-ISS-BEN-GROSS
 17387                                  EW-CNC-BEN     EW-CNC-BEN-GROSS
 17388                                  EW-ISS-PRM     EW-ISS-PRM-GROSS
 17389                                  EW-CNC-PRM     EW-CNC-PRM-GROSS
 17390                                  EW-EPR-R78     EW-EPR-R78-ADJ
 17391                                  EW-EPR-PRO     EW-EPR-PRO-ADJ
 17392                                  EW-EPR-ST      EW-EPR-ST-ADJ
 17393                                  EW-CLM-AMT     EW-COV-DTE
 17394                                  EW-CLM-IBNR    EW-CLM-PAYCUR
 17395                                  EW-CLM-FUTRSV  EW-CLM-CNT
 17396                                  EW-CLM-CRT     EW-ISS-CNT
 17397                                  EW-CNC-CNT     EW-AGE
 17398                                  EW-ORIG-TERM   EW-INFORCE-CNT
 17399                                  EW-AGE-BEN     EW-TERM-BEN
 17400                                  EW-ISS-PRM-TAX
 17401                                  EW-REM-TERM.
 17402
 17403     MOVE +1 TO SUB1.
 17404     PERFORM 4555-CLEAR-EPEC-COMM WS-LOOP-MAX TIMES.
 17405     PERFORM 4560-CLEAR-EPEC-ALL VARYING SUB1 FROM +1 BY +1
 17406         UNTIL EPEC-REIN-CO (SUB1) = ZEROS.
 17407     MOVE EPEC-OPT-WORK-TABLE    TO EPEC-OPT-DATA-TABLE
 17408                                    EPEC-UNDW-OPT-DATA-TABLE.
 17409     PERFORM 4570-CLEAR-EPEC-SUB-A VARYING SUB1 FROM +1 BY +1
 17410         UNTIL EPEC-SUB-REIN (SUB1) = ZEROS.
 17411
 17412     PERFORM 4590-INIT-OB THRU 4590-EXIT
 17413         VARYING SUB3 FROM +1 BY +1
 17414*        UNTIL SUB3 GREATER THAN +300.
 17415*        UNTIL SUB3 GREATER THAN +220.
 17416         UNTIL SUB3 GREATER THAN +900.
 17417
 17418     GO TO 4589-CLEAR-EPEC-TOTALS-X.
 17419
 17420 4555-CLEAR-EPEC-COMM.
 17421
 17422     MOVE +0 TO EW-ISS-COM (SUB1)  EW-CNC-COM (SUB1)
 17423                EW-ECR-R78 (SUB1)  EW-ECR-R78-ADJ (SUB1)
 17424                EW-ECR-PRO (SUB1)  EW-ECR-PRO-ADJ (SUB1)
 17425                EW-ECR-ST  (SUB1).
 17426     MOVE SPACES                 TO EW-AGT-NO (SUB1)
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 338
* ECS010Z.cbl
 17427                                    EW-AGT-TYPE (SUB1).
 17428
 17429     ADD +1 TO SUB1.
 17430
 17431 4560-CLEAR-EPEC-ALL.
 17432
 17433     MOVE EPEC-WORK              TO EPEC-LEVELS (SUB1)
 17434                                    EPEC-LEVELS-II (SUB1).
 17435     MOVE W-LIFE-YEARS-ZERO      TO EPEC-OPT-GRP (SUB1).
 17436
 17437 4570-CLEAR-EPEC-SUB-A.
 17438
 17439     MOVE ZEROS TO EPEC-SUB-REIN (SUB1).
 17440     PERFORM 4580-CLEAR-EPEC-SUB-B VARYING SUB2 FROM +1 BY +1
 17441*        UNTIL SUB2 GREATER +300.
 17442         UNTIL SUB2 GREATER +900.
 17443
 17444 4580-CLEAR-EPEC-SUB-B.
 17445
 17446     MOVE ZEROS TO EPEC-SUB-LF (SUB1 SUB2).
 17447     MOVE ZEROS TO EPEC-SUB-AH (SUB1 SUB2).
 17448
 17449 4589-CLEAR-EPEC-TOTALS-X.
 17450     EXIT.
 17451
 17452 4590-INIT-OB.
 17453
 17454     MOVE +0 TO WS-EPR-R78 (SUB3 1).
 17455     MOVE +0 TO WS-EPR-R78 (SUB3 2).
 17456     MOVE +0 TO WS-EPR-R78 (SUB3 3).
 17457
 17458 4590-EXIT.
 17459     EXIT.
 17460
 17461 4599-BUILD-EPEC-EXTRACT-X.
 17462     EXIT.
 17463
 17464*********************************************************
 17465*  THIS ROUTINE IS USED TO CALCULATE THE A&H IBNR       *
 17466*  RESERVES USING A PERCENTAGE OF THE UNEARNED PREMIUM. *
 17467*  THESE PERCENTAGES ARE ENTERED THROUGH SCREEN EL105A  *
 17468*  (CARRIER CONTROLS) AND PASSED THROUGHOUT THE SYSTEM  *
 17469*  IN THE DATE CARD.                                    *
 17470*  'CARRIER-UEP-PCT' IS THE ACTUAL PERCENT PER CARRIER. *
 17471*********************************************************
 17472
 17473 4599A-CALC-IBNR.
 17474
 17475     COMPUTE EW-CLM-IBNR =  ((EP-ISS-PRM - EP-CNC-PRM) -
 17476        (((EP-PRM-78 + EP-PRM-78-ADJ)
 17477                              * CARRIER-R78-PCT (CLAS-INDEXCN)) +
 17478         ((EP-PRM-PR + EP-PRM-PR-ADJ)
 17479                              * CARRIER-PRO-PCT (CLAS-INDEXCN))))
 17480                         * CARRIER-UEP-PCT (CLAS-INDEXCN).
 17481
 17482     IF EW-CLM-IBNR NOT GREATER THAN ZEROS
 17483         MOVE ZEROS                 TO EW-CLM-IBNR
 17484         GO TO 4599A-CALC-EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 339
* ECS010Z.cbl
 17485
 17486     IF EP-REIN = 'R'
 17487         MOVE 'Y'                   TO W-REIN-PROCESS-IND.
 17488
 17489     PERFORM 4740-CREATE-DETAIL-EXTR THRU 4740-EXIT.
 17490
 17491 4599A-CALC-EXIT.
 17492      EXIT.
 17493 4599B-SEARCH.
 17494      EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 340
* ECS010Z.cbl
 17496******************************************************************
 17497***         CALCULATE OPTIONAL METHOD I B N R                  ***
 17498******************************************************************
 17499
 17500 4600-GET-OPT-IBNR.
 17501
 17502     IF  CR-POLICY-IS-ACTIVE
 17503         IF  CR-POLICY-IS-REISSUE
 17504             OR CR-POLICY-IS-MONTHLY
 17505             IF  W-LIFE
 17506                 GO TO 4600-EXIT
 17507             ELSE
 17508                 NEXT SENTENCE
 17509         ELSE
 17510             NEXT SENTENCE
 17511     ELSE
 17512         IF  W-LIFE
 17513             GO TO 4600-EXIT.
 17514
 17515     IF  W-LIFE
 17516         PERFORM 4620-DETERMINE-LIFE-IBNR THRU 4620-EXIT
 17517     ELSE
 17518         PERFORM 4640-GET-A-H-EARNED-PREMIUM THRU 4640-EXIT.
 17519
 17520 4600-EXIT.
 17521     EXIT.
 17522
 17523 4620-DETERMINE-LIFE-IBNR.
 17524
 17525     IF  CR-LF-POLICY-IS-ACTIVE
 17526         ADD +1                  TO W-LF-ACTIVE
 17527         IF  CR-LF-POLICY-IS-REISSUE
 17528             OR CR-LF-POLICY-IS-MONTHLY
 17529             MOVE ZEROS          TO W-WK-IBNR
 17530             ADD +1              TO W-LF-REISSUE
 17531             GO TO 4620-EXIT
 17532         ELSE
 17533             NEXT SENTENCE
 17534     ELSE
 17535         ADD +1                  TO W-LF-INACTIVE
 17536         MOVE ZEROS              TO W-WK-IBNR
 17537         GO TO 4620-EXIT.
 17538
 17539     IF  CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'B'
 17540         MOVE ZEROS              TO W-WK-IBNR
 17541         ADD +1                  TO W-LF-CALC-B
 17542         GO TO 4620-EXIT.
 17543
 17544     IF  (CLAS-I-EP (CLAS-INDEXL) = 'B'
 17545                 AND
 17546             CLAS-I-CALC-TYPE (CLAS-INDEXL) NOT = 'L'
 17547                 AND
 17548             W-BAL-REMTRM NOT GREATER THAN ZERO)
 17549             OR
 17550         (CLAS-I-EP (CLAS-INDEXL) = 'B'
 17551                 AND
 17552             CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'L'
 17553                 AND
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 341
* ECS010Z.cbl
 17554             REM-TRM2 NOT GREATER THAN ZERO)
 17555         MOVE ZEROS              TO W-WK-IBNR
 17556         ADD +1                  TO W-LF-BALLOON
 17557         GO TO 4620-EXIT
 17558     ELSE
 17559         IF  (CLAS-I-EP (CLAS-INDEXL) NOT = 'B'
 17560                 AND
 17561             REM-TRM2 NOT GREATER THAN ZERO)
 17562             ADD +1              TO W-LF-REMTERM-0
 17563             MOVE ZEROS          TO W-WK-IBNR
 17564             GO TO 4620-EXIT.
 17565
 17566     PERFORM 4680-CALC-REMAINING-AMT-LF THRU 4680-EXIT.
 17567
 17568     IF  CP-REMAINING-AMT NOT GREATER THAN ZEROS
 17569         ADD +1                  TO W-LF-REMAMT-0
 17570         MOVE ZEROS              TO W-WK-IBNR
 17571         GO TO 4620-EXIT.
 17572
 17573     IF  AM-LIFE-IBNR-PCT NUMERIC
 17574             AND
 17575         AM-LIFE-IBNR-PCT GREATER THAN ZEROS
 17576         COMPUTE W-WK-IBNR ROUNDED
 17577             = CP-REMAINING-AMT
 17578             / 1000
 17579             * AM-LIFE-IBNR-PCT
 17580     ELSE
 17581         COMPUTE W-WK-IBNR ROUNDED
 17582             = CP-REMAINING-AMT
 17583             / 1000
 17584             * COMPANY-IBNR-LIFE-FACTOR.
 17585
 17586     IF  CR-LF-IS-REIN-ONLY
 17587         ADD +1                  TO W-LF-REIN
 17588     ELSE
 17589         ADD +1                  TO W-LF-DATA-USED
 17590         ADD W-WK-IBNR           TO W-LIFE-IBNR-IN
 17591         ADD CP-REMAINING-AMT    TO W-LIFE-REMAINING-AMT
 17592         IF  CR-LFTYP = '01'
 17593             ADD CP-REMAINING-AMT
 17594                                 TO W-01-REMAMT
 17595             ADD +1              TO W-01-DATA-USED
 17596         ELSE
 17597         IF  CR-LFTYP = '02'
 17598             ADD CP-REMAINING-AMT
 17599                                 TO W-02-REMAMT
 17600             ADD +1              TO W-02-DATA-USED
 17601         ELSE
 17602         IF  CR-LFTYP = '03'
 17603             ADD CP-REMAINING-AMT
 17604                                 TO W-03-REMAMT
 17605             ADD +1              TO W-03-DATA-USED
 17606         ELSE
 17607         IF  CR-LFTYP = '04'
 17608             ADD CP-REMAINING-AMT
 17609                                 TO W-04-REMAMT
 17610             ADD +1              TO W-04-DATA-USED
 17611         ELSE
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 342
* ECS010Z.cbl
 17612         IF  CR-LFTYP = '05'
 17613             ADD CP-REMAINING-AMT
 17614                                 TO W-05-REMAMT
 17615             ADD +1              TO W-05-DATA-USED
 17616         ELSE
 17617         IF  CR-LFTYP = '06'
 17618             ADD CP-REMAINING-AMT
 17619                                 TO W-06-REMAMT
 17620             ADD +1              TO W-06-DATA-USED
 17621         ELSE
 17622         IF  CR-LFTYP = '30'
 17623             ADD CP-REMAINING-AMT
 17624                                 TO W-30-REMAMT
 17625             ADD +1              TO W-30-DATA-USED
 17626         ELSE
 17627         IF  CR-LFTYP = '31'
 17628             ADD CP-REMAINING-AMT
 17629                                 TO W-31-REMAMT
 17630             ADD +1              TO W-31-DATA-USED
 17631         ELSE
 17632             ADD CP-REMAINING-AMT
 17633                                 TO W-XX-REMAMT
 17634             ADD +1              TO W-XX-DATA-USED.
 17635
 17636     IF  CR-POLICY-IS-REIN-ONLY
 17637             OR
 17638         CR-LF-IS-REIN-ONLY
 17639         ADD ISS-BEN             TO EPEC-REIN-ISS-BEN (SUB3)
 17640         MOVE 'R'                TO EPEC-REIN-ONLY-IND (SUB3)
 17641         ADD W-WK-IBNR           TO EPEC-LIFE-IBNR (SUB3)
 17642     ELSE
 17643         ADD W-WK-IBNR           TO EPEC-LIFE-IBNR (SUB3).
 17644
 17645 4620-EXIT.
 17646     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 343
* ECS010Z.cbl
 17648 4640-GET-A-H-EARNED-PREMIUM.
 17649
 17650     IF  CR-AH-POLICY-IS-ACTIVE
 17651         ADD +1                  TO W-AH-ACTIVE
 17652         IF  CR-AH-POLICY-IS-REISSUE
 17653             OR CR-AH-POLICY-IS-MONTHLY
 17654             ADD +1              TO W-AH-REISSUE
 17655         ELSE
 17656             NEXT SENTENCE
 17657     ELSE
 17658         ADD +1                  TO W-AH-INACTIVE.
 17659
 17660     IF  CLAS-I-CALC-TYPE (CLAS-INDEXA) = 'B'
 17661         ADD +1                  TO W-AH-CALC-B
 17662         GO TO 4640-EXIT.
 17663
 17664     IF  REM-TRM2 NOT GREATER THAN ZEROS
 17665         MOVE 'Y'                TO W-RTRM-0-SW
 17666     ELSE
 17667         MOVE SPACES             TO W-RTRM-0-SW.
 17668
 17669     PERFORM 4660-DETERMINE-EARNED-PREMIUM THRU 4660-EXIT.
 17670
 17671****** NOTE:  THERE IS AN ASSUMPTION THAT STATISTICALLY ONLY ONE
 17672******        ACTUALLY CLAIM PER 90 DAY PERIOD AND THAT THE CLAIM
 17673******        ITD FIELD (CR-DISAMT) CONTAINS ONLY THE AMOUNT OF
 17674******        THAT CLAIM.
 17675
 17676     PERFORM 4650-DETERMINE-CLM-AMT-AH THRU 4650-EXIT.
 17677
 17678     IF  CR-POLICY-IS-REIN-ONLY
 17679              OR
 17680         CR-AH-IS-REIN-ONLY
 17681         ADD +1                  TO W-AH-REIN
 17682         ADD ISS-BEN             TO EPEC-REIN-ISS-BEN (SUB3)
 17683         MOVE 'R'                TO EPEC-REIN-ONLY-IND (SUB3)
 17684         ADD W-CLMAMT            TO EPEC-CLAIMS-MADE-PAID (SUB3)
 17685         ADD W-EARNED-PREMIUM    TO EPEC-EARNED-PREMIUM-AH (SUB3)
 17686         GO TO 4640-EXIT.
 17687
 17688     ADD W-EARNED-PREMIUM        TO EPEC-EARNED-PREMIUM-AH (SUB3)
 17689                                    W-EPEC-EP-IN.
 17690     ADD W-CLMAMT                TO EPEC-CLAIMS-MADE-PAID (SUB3)
 17691                                    W-CLAIMS-MADE-PAID-IN.
 17692     ADD +1                      TO W-AH-DATA-USED.
 17693     ADD W-EARNED-PREMIUM-1      TO W-EPEC-EP-1.
 17694     ADD W-EARNED-PREMIUM-2      TO W-EPEC-EP-2.
 17695
 17696     IF  W-CLMAMT GREATER THAN ZEROS
 17697         ADD +1                  TO W-AH-CLAIM-CTR
 17698         ADD W-EARNED-PREMIUM    TO W-AH-CLAIM-EP.
 17699
 17700     IF  W-RTRM-0
 17701             AND
 17702         NOT CR-POLICY-IS-REIN-ONLY
 17703             AND
 17704         NOT CR-AH-IS-REIN-ONLY
 17705         ADD W-CLMAMT            TO W-RTRM-0-CLMAMT
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 344
* ECS010Z.cbl
 17706         ADD W-EARNED-PREMIUM-1  TO W-RTRM-EP-1
 17707         ADD W-EARNED-PREMIUM-2  TO W-RTRM-EP-2
 17708         ADD W-EARNED-PREMIUM    TO W-RTRM-EP
 17709         ADD +1                  TO W-AH-REMTERM-0.
 17710
 17711 4640-EXIT.
 17712     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 345
* ECS010Z.cbl
 17714 4650-DETERMINE-CLM-AMT-AH.
 17715
 17716     MOVE ZEROS                  TO W-CLMAMT.
 17717
 17718     IF  CR-DIS-DT NOT GREATER THAN ZEROS
 17719             OR
 17720         CR-DIS-DT NOT GREATER THAN W-CUTOFF-DATE
 17721         GO TO 4650-EXIT.
 17722
 17723     IF  CR-DIS-PTO-DT GREATER THAN ZEROS
 17724             AND
 17725         CR-DIS-PTO-DT GREATER THAN CR-DIS-DT
 17726         MOVE CR-DIS-DT              TO DC-GREG-DATE-CYMD
 17727         MOVE 'L'                    TO DC-OPTION-CODE
 17728         PERFORM 8000-DATE-CONVERT-ROUTINE
 17729             THRU 8099-DATE-CONVERT-X
 17730         MOVE DC-BIN-DATE-1          TO W-DIS-DT
 17731         MOVE CR-DIS-PTO-DT          TO DC-GREG-DATE-CYMD
 17732         MOVE 'L'                    TO DC-OPTION-CODE
 17733         PERFORM 8000-DATE-CONVERT-ROUTINE
 17734             THRU 8099-DATE-CONVERT-X
 17735         MOVE DC-BIN-DATE-1          TO W-DIS-PTO-DT
 17736         IF  DATE-CONVERSION-ERROR
 17737             DISPLAY 'CERT DATES ERROR' CR-FULL-CONTROL
 17738             MOVE 'CERT DATES ERROR' TO WS-ABEND-MESSAGE
 17739             MOVE DC-ERROR-CODE      TO WS-ABEND-FILE-STATUS
 17740             MOVE 0303               TO WS-ABEND-CODE
 17741             MOVE WS-ABEND-CODE      TO WS-RETURN-CODE
 17742             GO TO ABEND-PGM
 17743         ELSE
 17744             MOVE W-DIS-DT           TO DC-BIN-DATE-1
 17745             MOVE W-DIS-PTO-DT       TO DC-BIN-DATE-2
 17746             MOVE '1'                TO DC-OPTION-CODE
 17747             MOVE ZEROS              TO DC-ELAPSED-MONTHS
 17748                                        DC-ELAPSED-DAYS
 17749             PERFORM 8000-DATE-CONVERT-ROUTINE
 17750                 THRU 8099-DATE-CONVERT-X
 17751             IF  DATE-CONVERSION-ERROR
 17752                 DISPLAY 'DIS TO PTO DATE ERROR '
 17753                     CR-FULL-CONTROL
 17754                 MOVE 'DIS TO PTO DATE ERROR '
 17755                                     TO WS-ABEND-MESSAGE
 17756                 MOVE DC-ERROR-CODE  TO WS-ABEND-FILE-STATUS
 17757                 MOVE 0303           TO WS-ABEND-CODE
 17758                 MOVE WS-ABEND-CODE  TO WS-RETURN-CODE
 17759                 GO TO ABEND-PGM
 17760             ELSE
 17761                 COMPUTE W-CLMAMT ROUNDED
 17762                     = CR-AHAMT
 17763                     * (DC-ELAPSED-DAYS / 30)
 17764                 GO TO 4650-EXIT.
 17765
 17766     IF  CR-DIS-PAY-DT NOT GREATER THAN ZEROS
 17767             OR
 17768         CR-DIS-PAY-DT LESS THAN CR-DIS-DT
 17769         GO TO 4650-EXIT.
 17770
 17771     COMPUTE W-90-DAY-MAX ROUNDED
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 346
* ECS010Z.cbl
 17772         = CR-AHAMT * 3.
 17773
 17774     IF  CR-DISAMT NOT GREATER THAN W-90-DAY-MAX
 17775         MOVE CR-DISAMT          TO W-CLMAMT
 17776     ELSE
 17777         MOVE W-90-DAY-MAX       TO W-CLMAMT.
 17778
 17779     IF  NOT CR-POLICY-IS-REIN-ONLY
 17780              AND
 17781         NOT CR-AH-IS-REIN-ONLY
 17782         ADD +1          TO W-CLM-EXCEPT-CNT
 17783         ADD W-CLMAMT    TO W-CLM-EXCEPT-AMT.
 17784
 17785 4650-EXIT.
 17786     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 347
* ECS010Z.cbl
 17788 4660-DETERMINE-EARNED-PREMIUM.
 17789
 17790     MOVE ZEROS                  TO W-EARNED-PREMIUM.
 17791
 17792     PERFORM 4670-CALC-EP THRU 4670-EXIT.
 17793
 17794     MOVE W-EARNED-PREMIUM       TO W-EARNED-PREMIUM-1.
 17795
 17796     IF  CR-ENTRY-DATE NOT GREATER THAN W-CUTOFF-DATE
 17797         MOVE ZEROS              TO W-EARNED-PREMIUM
 17798         MOVE W-CUTOFF-DATE      TO VALUATION-DT
 17799         MOVE '7'                TO W-VAL-SOURCE
 17800         PERFORM 8500-REMAINING-TERM-ROUTINE
 17801             THRU 8599-REM-TERM-X
 17802         PERFORM 4666-SAVE-AHCR-DATA THRU 4666-EXIT
 17803         PERFORM 4800-CALC-EARNED-PREMIUM-AH THRU 4899-EXIT
 17804         PERFORM 4668-RESTORE-AHCR-DATA THRU 4668-EXIT
 17805         MOVE EPR-R78            TO W-OPT-R78
 17806         MOVE EPR-PRO            TO W-OPT-PRO
 17807         MOVE EPR-ST             TO W-OPT-ST
 17808         PERFORM 4670-CALC-EP THRU 4670-EXIT
 17809         MOVE W-EARNED-PREMIUM   TO W-EARNED-PREMIUM-2
 17810     ELSE
 17811         MOVE ZEROS              TO W-EARNED-PREMIUM-2.
 17812
 17813     COMPUTE W-EARNED-PREMIUM ROUNDED
 17814         = W-EARNED-PREMIUM-1 - W-EARNED-PREMIUM-2.
 17815
 17816     IF  W-EARNED-PREMIUM LESS THAN ZERO
 17817         ADD +1                  TO W-EP-LESS-THAN-0
 17818         MOVE ZERO               TO W-EARNED-PREMIUM.
 17819
 17820 4660-EXIT.
 17821     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 348
* ECS010Z.cbl
 17823 4666-SAVE-AHCR-DATA.
 17824
 17825     MOVE SPACES                 TO WX-STATUS-AT-CANCEL
 17826                                    WX-STATUS-AT-SETTLEMENT.
 17827
 17828     MOVE ZEROS                  TO WX-CANC-DT
 17829                                    WX-EOM-RUN-DATE
 17830                                    WX-SETTLEMENT-EXIT-DATE.
 17831
 17832     IF  CR-AH-CANC-DT GREATER THAN W-CUTOFF-DATE
 17833         MOVE CR-AH-CANC-DT      TO WX-CANC-DT
 17834         MOVE CR-AH-STATUS-AT-CANCEL
 17835                                 TO WX-STATUS-AT-CANCEL
 17836         MOVE ZEROS              TO CR-AH-CANC-DT
 17837                                    WS-CR-AH-CANC-DT-N
 17838         MOVE SPACES             TO CR-AH-STATUS-AT-CANCEL.
 17839
 17840     IF  CR-AH-SETTLEMENT-EXIT-DATE GREATER THAN W-CUTOFF-DATE
 17841         MOVE CR-AH-SETTLEMENT-EXIT-DATE
 17842                                 TO WX-SETTLEMENT-EXIT-DATE
 17843         MOVE CR-AH-STATUS-AT-SETTLEMENT
 17844                                 TO WX-STATUS-AT-SETTLEMENT
 17845         MOVE ZEROS              TO CR-AH-SETTLEMENT-EXIT-DATE
 17846                                 WS-CR-AH-SETTLEMENT-EXIT-DATEN
 17847         MOVE SPACES             TO CR-AH-STATUS-AT-SETTLEMENT.
 17848
 17849     MOVE EOM-RUN-DATE           TO WX-EOM-RUN-DATE.
 17850     MOVE W-CUTOFF-DATE          TO EOM-RUN-DATE.
 17851
 17852 4666-EXIT.
 17853     EXIT.
 17854
 17855 4668-RESTORE-AHCR-DATA.
 17856
 17857     IF  WX-CANC-DT GREATER THAN W-CUTOFF-DATE
 17858         MOVE WX-CANC-DT         TO CR-AH-CANC-DT
 17859                                    WS-CR-AH-CANC-DT-N
 17860         MOVE WX-STATUS-AT-CANCEL
 17861                                 TO CR-AH-STATUS-AT-CANCEL.
 17862
 17863     IF  WX-SETTLEMENT-EXIT-DATE GREATER THAN W-CUTOFF-DATE
 17864         MOVE WX-SETTLEMENT-EXIT-DATE
 17865                                 TO CR-AH-SETTLEMENT-EXIT-DATE
 17866                                 WS-CR-AH-SETTLEMENT-EXIT-DATEN
 17867         MOVE WX-STATUS-AT-SETTLEMENT
 17868                                 TO CR-AH-STATUS-AT-SETTLEMENT.
 17869
 17870     MOVE WX-EOM-RUN-DATE        TO EOM-RUN-DATE.
 17871
 17872 4668-EXIT.
 17873     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 349
* ECS010Z.cbl
 17875 4670-CALC-EP.
 17876
 17877     IF  STATE-ABBR (CLAS-INDEXS) = 'WY'
 17878         MOVE W-OPT-PRO          TO W-EARNED-PREMIUM
 17879         ADD W-EARNED-PREMIUM    TO W-WY-EP
 17880         GO TO 4670-EXIT.
 17881
 17882     IF  STATE-ABBR (CLAS-INDEXS) = 'VA'
 17883         MOVE W-OPT-ST           TO W-EARNED-PREMIUM
 17884         ADD W-EARNED-PREMIUM    TO W-VA-EP
 17885         GO TO 4670-EXIT.
 17886
 17887***** NOTE THIS ASSUMES THAT ONLY A&H COVERAGES ARE PROCESSED HERE
 17888
 17889     IF  CLAS-I-EP (CLAS-INDEXA) = 'M'
 17890         COMPUTE W-EARNED-PREMIUM
 17891             = (W-OPT-PRO + W-OPT-R78) / +2
 17892         ADD W-EARNED-PREMIUM    TO W-M-EP
 17893     ELSE
 17894         IF  CLAS-I-EP (CLAS-INDEXA) = 'R'
 17895             MOVE W-OPT-R78      TO W-EARNED-PREMIUM
 17896             ADD W-EARNED-PREMIUM
 17897                                 TO W-R-EP
 17898         ELSE
 17899             IF  CLAS-I-EP (CLAS-INDEXA) = 'P'
 17900                 MOVE W-OPT-PRO  TO W-EARNED-PREMIUM
 17901                 ADD W-EARNED-PREMIUM
 17902                                 TO W-P-EP
 17903             ELSE
 17904                 IF  CLAS-I-EP (CLAS-INDEXA) = '1'
 17905                     COMPUTE W-EARNED-PREMIUM ROUNDED
 17906                         = (W-OPT-PRO * +.6667)
 17907                         + (W-OPT-R78 * +.3333)
 17908                     ADD W-EARNED-PREMIUM
 17909                                 TO W-1-EP
 17910                 ELSE
 17911                     ADD +1      TO W-OTHERS-COUNT
 17912                     MOVE ZEROS  TO W-EARNED-PREMIUM.
 17913
 17914 4670-EXIT.
 17915     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 350
* ECS010Z.cbl
 17917 4680-CALC-REMAINING-AMT-LF.
 17918
 17919     MOVE LOW-VALUES             TO CP-INSURED-BIRTH-DT.
 17920     MOVE CR-AGE                 TO CP-ISSUE-AGE.
 17921     MOVE CR-APR                 TO CP-LOAN-APR.
 17922     MOVE CR-LOAN-TERM           TO CP-LOAN-TERM.
 17923
 17924     IF  CR-PMT-FREQ NOT GREATER THAN ZERO
 17925         MOVE +1                 TO CR-PMT-FREQ.
 17926
 17927     MOVE CR-PMT-FREQ            TO CP-PAY-FREQUENCY.
 17928
 17929     MOVE REM-TRM2               TO CP-REMAINING-TERM.
 17930     MOVE CR-LFAMT               TO CP-ORIGINAL-BENEFIT
 17931                                    CP-RATING-BENEFIT-AMT.
 17932     IF CP-STATE-STD-ABBRV = 'OR'
 17933         COMPUTE CP-RATING-BENEFIT-AMT = CR-LFAMT + CR-LFAMT-ALT.
 17934     MOVE CR-LFAMT-ALT           TO CP-ALTERNATE-BENEFIT.
 17935     MOVE CR-LFPRM               TO CP-ORIGINAL-PREMIUM.
 17936     MOVE ZEROS                  TO CP-REMAINING-AMT
 17937                                    CP-REMAINING-AMT-PRV
 17938                                    CP-RETURN-CODE
 17939                                    CP-RETURN-CODE-2.
 17940
 17941
 17942     CALL 'ELRAMTX' USING CALCULATION-PASS-AREA
 17943
 17944     IF  CP-RETURN-CODE NOT = ZERO
 17945         MOVE 'ERROR OCCURED REMAINING AMT CALCULATIONS'
 17946                             TO WS-ABEND-MESSAGE
 17947         MOVE CP-RETURN-CODE TO WS-ABEND-FILE-STATUS
 17948         MOVE 2001           TO WS-ABEND-CODE
 17949         GO TO ABEND-PGM.
 17950
 17951 4680-EXIT.
 17952     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 351
* ECS010Z.cbl
 17954******************************************************************
 17955***  BUILDS ACCOUNT LEVEL IBNR (DIRECT AND REIN)               ***
 17956******************************************************************
 17957
 17958 4700-CALC-OPT-IBNR.
 17959
 17960     MOVE EPEC-OPT-DATA-TABLE    TO EPEC-OPT-WORK-TABLE.
 17961     MOVE SPACE                  TO W-UNDERWRITING-SW.
 17962
 17963     PERFORM 4710-PROCESS-THRU-EPEC-TABLE THRU 4710-EXIT
 17964             VARYING
 17965         SUB2 FROM +1 BY +1
 17966             UNTIL
 17967*        SUB2 GREATER THAN 300.
 17968*        SUB2 GREATER THAN 220.
 17969         SUB2 GREATER THAN 900.
 17970
 17971     MOVE EPEC-UNDW-OPT-DATA-TABLE
 17972                                 TO EPEC-OPT-WORK-TABLE.
 17973     MOVE '*'                    TO W-UNDERWRITING-SW.
 17974
 17975     PERFORM 4710-PROCESS-THRU-EPEC-TABLE THRU 4710-EXIT
 17976             VARYING
 17977         SUB2 FROM +1 BY +1
 17978             UNTIL
 17979*        SUB2 GREATER THAN 300.
 17980*        SUB2 GREATER THAN 220.
 17981         SUB2 GREATER THAN 900.
 17982
 17983 4700-EXIT.
 17984     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 352
* ECS010Z.cbl
 17986 4710-PROCESS-THRU-EPEC-TABLE.
 17987
 17988     IF  EPEC-REIN-CO-OPT (SUB2) = ZEROS
 17989         GO TO 4710-EXIT.
 17990
 17991     IF  W-UNDERWRITTEN-DATA
 17992         MOVE EPEC-LEVELS-II (SUB2)  TO EPEC-WORK
 17993     ELSE
 17994         MOVE EPEC-LEVELS (SUB2)     TO EPEC-WORK.
 17995
 17996     IF EW-LEVEL-USED NOT = 'Y'
 17997         GO TO 4710-EXIT.
 17998
 17999     IF  EW-REIN-CO GREATER THAN SPACES
 18000         MOVE 'Y'                TO W-REIN-PROCESS-SW
 18001         IF  EPEC-REIN-ONLY-DATA (SUB2)
 18002             PERFORM 4760-PROCESS-REIN-ONLY THRU 4760-EXIT
 18003             IF  W-WK-IBNR GREATER THAN ZEROS
 18004                 PERFORM 4770-CREATE-REIN-DETAIL THRU 4770-EXIT
 18005                 GO TO 4710-EXIT
 18006             ELSE
 18007                 GO TO 4710-EXIT
 18008         ELSE
 18009             IF  EW-CLM-IBNR GREATER THAN ZEROS
 18010                 PERFORM 4770-CREATE-REIN-DETAIL THRU 4770-EXIT
 18011                 GO TO 4710-EXIT
 18012             ELSE
 18013                 GO TO 4710-EXIT.
 18014
 18015     MOVE SPACES                 TO W-REIN-PROCESS-SW.
 18016
 18017     IF  EW-LF-AH EQUAL 'L'
 18018         IF  EPEC-LIFE-IBNR (SUB2) EQUAL ZEROS
 18019             GO TO 4710-EXIT
 18020         ELSE
 18021             PERFORM 4720-PROCESS-LIFE THRU 4720-EXIT
 18022             ADD W-WK-IBNR       TO W-LIFE-IBNR
 18023     ELSE
 18024         IF  EPEC-EARNED-PREMIUM-AH (SUB2)
 18025                 GREATER THAN ZEROS
 18026             PERFORM 4730-PROCESS-A-H THRU 4730-EXIT
 18027             ADD W-WK-IBNR       TO W-AH-IBNR
 18028         ELSE
 18029             GO TO 4710-EXIT.
 18030
 18031     MOVE W-WK-IBNR              TO EW-CLM-IBNR.
 18032     MOVE EW-ISS-BEN             TO W-ISS-BEN.
 18033     MOVE EW-ISS-BEN-GROSS       TO W-ISS-BEN-GROSS.
 18034
 18035     IF  W-UNDERWRITTEN-DATA
 18036         MOVE EPEC-WORK          TO EPEC-LEVELS-II (SUB2)
 18037     ELSE
 18038         MOVE EPEC-WORK          TO EPEC-LEVELS (SUB2).
 18039
 18040
 18041     PERFORM 4740-CREATE-DETAIL-EXTR THRU 4740-EXIT.
 18042     PERFORM 4750-UPDATE-REIN THRU 4750-EXIT.
 18043
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 353
* ECS010Z.cbl
 18044 4710-EXIT.
 18045     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 354
* ECS010Z.cbl
 18047 4720-PROCESS-LIFE.
 18048
 18049     MOVE EPEC-LIFE-IBNR (SUB2)  TO W-WK-IBNR.
 18050
 18051 4720-EXIT.
 18052     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 355
* ECS010Z.cbl
 18054 4730-PROCESS-A-H.
 18055
 18056     IF  AM-TARGET-LOSS-RATIO NUMERIC
 18057             AND
 18058         AM-TARGET-LOSS-RATIO NOT EQUAL ZERO
 18059         MOVE AM-TARGET-LOSS-RATIO
 18060                                 TO W-TARGET-LOSS-RATIO
 18061     ELSE
 18062         IF  CLAS-INDEXS NOT GREATER THAN CLAS-MAXS
 18063             MOVE STATE-TARGET-LOSS-RATIO (CLAS-INDEXS)
 18064                                 TO W-TARGET-LOSS-RATIO
 18065             PERFORM 4735-GET-BUSINESS-ADJUSTMENT THRU 4735-EXIT.
 18066
 18067     IF  W-NOT-REIN-PROCESS
 18068         ADD EPEC-EARNED-PREMIUM-AH (SUB2) TO W-EPEC-EP
 18069         ADD EPEC-CLAIMS-MADE-PAID (SUB2)  TO W-CLAIMS-MADE-PAID.
 18070
 18071     COMPUTE W-IBNR-1 ROUNDED
 18072         = EPEC-EARNED-PREMIUM-AH (SUB2)
 18073         * COMPANY-IBNR-AH-FACTOR
 18074         * W-TARGET-LOSS-RATIO.
 18075
 18076     COMPUTE W-IBNR-2 ROUNDED
 18077         = (EPEC-EARNED-PREMIUM-AH (SUB2)
 18078         * W-TARGET-LOSS-RATIO)
 18079         - EPEC-CLAIMS-MADE-PAID (SUB2).
 18080
 18081     IF  W-IBNR-1 GREATER THAN W-IBNR-2
 18082         MOVE W-IBNR-1           TO W-WK-IBNR
 18083         IF  W-NOT-REIN-PROCESS
 18084             ADD +1              TO W-AH-IBNR-1-CNT
 18085             ADD W-IBNR-1        TO W-AH-IBNR-1
 18086         ELSE
 18087             NEXT SENTENCE
 18088     ELSE
 18089         MOVE W-IBNR-2           TO W-WK-IBNR
 18090         IF  W-NOT-REIN-PROCESS
 18091             ADD +1              TO W-AH-IBNR-2-CNT
 18092             ADD W-IBNR-2        TO W-AH-IBNR-2.
 18093
 18094 4730-EXIT.
 18095     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 356
* ECS010Z.cbl
 18097 4735-GET-BUSINESS-ADJUSTMENT.
 18098
 18099     IF  CR-GRPTYP NOT NUMERIC
 18100         MOVE '99'               TO INDEXBS
 18101     ELSE
 18102         MOVE CR-GRPTYP          TO INDEXBS.
 18103
 18104     IF  BUS-TRGT-LOSS-RATIO-MOD (INDEXBS) NUMERIC
 18105             AND
 18106         BUS-TRGT-LOSS-RATIO-MOD (INDEXBS)
 18107             NOT EQUAL ZEROS
 18108             AND
 18109         BUS-TRGT-LOSS-RATIO-MOD (INDEXBS)
 18110             NOT EQUAL +1.0000
 18111         MOVE INDEXBS           TO W-EDIT-7
 18112         COMPUTE W-TARGET-LOSS-RATIO ROUNDED
 18113             = W-TARGET-LOSS-RATIO
 18114             * BUS-TRGT-LOSS-RATIO-MOD (INDEXBS).
 18115
 18116 4735-EXIT.
 18117     EXIT.
 18118
 18119 4740-CREATE-DETAIL-EXTR.
 18120
 18121     IF DTE-PGM-OPT NOT = '1'
 18122         GO TO 4740-EXIT.
 18123
 18124     IF  EW-CLM-IBNR NOT GREATER THAN ZEROS
 18125         GO TO 4740-EXIT.
 18126
 18127     MOVE EOM-RUN-DATE           TO INCURRED-DATE.
 18128     MOVE ZEROS                  TO REPORTED-DATE
 18129                                    PAY-TO-DATE.
 18130
 18131     MOVE SPACES                 TO TR-DTL2.
 18132     MOVE 'ACTBENIBNR'           TO TRD-CERT.
 18133
 18134     MOVE EOM-YR                 TO TRD-ISYR.
 18135     MOVE EOM-MO                 TO TRD-ISMO.
 18136     MOVE EOM-DA                 TO TRD-ISDA.
 18137     MOVE ZERO                   TO TRD-AGE.
 18138
 18139     IF  EW-LF-AH EQUAL 'L'
 18140         MOVE LIFE-OVERRIDE-L6   TO TRD-RSV-DESC
 18141     ELSE
 18142         MOVE AH-OVERRIDE-L6     TO TRD-RSV-DESC.
 18143
 18144     MOVE SPACES                 TO TRD-PAYCURX
 18145                                    TRD-PAYCUR-SPACE
 18146                                    TRD-FUTRSV-SPACE
 18147                                    TRD-FUTRSVX.
 18148
 18149     MOVE EW-CLM-IBNR            TO TRD-IBNR.
 18150     MOVE 'IBNR'                 TO TRD-IBNRX.
 18151     MOVE EW-BEN-TYPE            TO TRD-BENEFIT-CODE.
 18152     MOVE 'BENEFIT - '           TO TRD-BENEFIT-X.
 18153
 18154     IF  W-UNDERWRITTEN-DATA
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 357
* ECS010Z.cbl
 18155         IF  W-REIN-IN-PROCESS
 18156             MOVE ' ACCT/BEN REIN RSV UW'
 18157                                 TO TRD-RSV-ACTION
 18158         ELSE
 18159             MOVE ' ACCT/BEN RESERVES UW'
 18160                                 TO TRD-RSV-ACTION
 18161     ELSE
 18162         IF  W-REIN-IN-PROCESS
 18163             MOVE ' ACCT/BEN REIN RSV'
 18164                                 TO TRD-RSV-ACTION
 18165         ELSE
 18166             MOVE ' ACCT/BEN RESERVES'
 18167                                 TO TRD-RSV-ACTION.
 18168
 18169     PERFORM 8690-PRINT-DETAIL-LINE THRU 8699-PRT-DETAIL-X.
 18170
 18171     MOVE SPACES                 TO DETAIL-EXTRACT.
 18172
 18173     IF  W-REIN-IN-PROCESS
 18174         MOVE EW-REIN-CO         TO DE-REI-COMP
 18175         MOVE 'R'                TO DE-REIN
 18176         MOVE EW-CLM-IBNR        TO DE-REI-IBNR
 18177         MOVE ZEROS              TO DE-IBNR
 18178     ELSE
 18179         MOVE EW-CLM-IBNR        TO DE-IBNR
 18180         MOVE ZEROS              TO DE-REI-IBNR.
 18181
 18182     MOVE 'DE'                   TO DE-RECORD-ID.
 18183     MOVE 'Y'                    TO DE-TRANS.
 18184     MOVE 'IBNRRSV'              TO DE-CLMNO.
 18185     MOVE '1'                    TO DE-ENTRY-STATUS.
 18186     MOVE 'ACTBENIBNR'           TO DE-CERT.
 18187
 18188     MOVE EOM-RUN-DATE           TO DE-EFF
 18189                                    WS-DE-EFF-N
 18190                                    DE-ENTRY-DTE
 18191                                    WS-DE-ENTRY-DTE-N.
 18192     MOVE INCURRED-DATE          TO DE-RSV-INCUR
 18193                                    WS-DE-RSV-INCUR-N.
 18194
 18195     MOVE AM-COMPANY-CD          TO DE-COMPANY-CD.
 18196     MOVE AM-MSTR-CNTRL          TO DE-CNTRL1.
 18197     MOVE AM-EXPIRE-DT           TO DE-ACC-EXP-DTE-RSV
 18198                                    WS-DE-ACC-EXP-DTE-RSV-N.
 18199     MOVE AM-EFFECT-DT           TO DE-ACC-EFF-DTE-RSV
 18200                                    WS-DE-ACC-EFF-DTE-RSV-N.
 18201
 18202     MOVE AM-NAME                TO DE-RSV-ACC-NAME.
 18203     MOVE AM-RECALC-COMM         TO DE-RECALC-CODE.
 18204     MOVE AM-REMIT-TO            TO DE-REMIT-TO.
 18205     MOVE AM-REPORT-CODE-1       TO DE-REPORT-CODE-1.
 18206     MOVE AM-REPORT-CODE-2       TO DE-REPORT-CODE-2.
 18207     MOVE AM-POOL-PRIME          TO DE-NCL-POOL-CODE.
 18208     MOVE AM-IG                  TO DE-IG.
 18209
 18210     IF W-UNDERWRITTEN-DATA
 18211         MOVE 'Y'                TO DE-UNDERWRITING-CODE
 18212     ELSE
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 358
* ECS010Z.cbl
 18213         MOVE 'N'                TO DE-UNDERWRITING-CODE.
 18214
 18215     IF  EW-LF-AH EQUAL 'L'
 18216         MOVE EW-BEN-TYPE        TO DE-LF-TYPE
 18217         MOVE '1'                TO DE-RESERVE-TYPE
 18218         MOVE ZEROS              TO DE-AH-TYPE
 18219     ELSE
 18220         MOVE EW-BEN-TYPE        TO DE-AH-TYPE
 18221         MOVE '2'                TO DE-RESERVE-TYPE
 18222         MOVE ZEROS              TO DE-LF-TYPE.
 18223
 18224     MOVE SPACES                 TO DE-NAME
 18225                                    DE-ACC-GPCD
 18226                                    DE-AH-STAT-CDE
 18227                                    DE-LF-STAT-CDE
 18228                                    DE-MEMBER-NO
 18229                                    DE-NAME
 18230                                    DE-SEX.
 18231     MOVE ZEROS                  TO DE-AGE
 18232                                    DE-AH-BEN
 18233                                    DE-AH-CANC-DTE
 18234                                    WS-DE-AH-CANC-DTE-N
 18235                                    DE-AH-CANC-EXIT-DT
 18236                                    WS-DE-AH-CANC-EXIT-DT-N
 18237                                    DE-AH-PRM
 18238                                    DE-AH-RFND
 18239                                    DE-AH-TERM
 18240                                    DE-APR
 18241                                    DE-CANCEL-CNT-ITD
 18242                                    DE-CANCEL-CNT-YTD
 18243                                    DE-FUTRSV
 18244                                    DE-LF-BEN
 18245                                    DE-LF-BEN-ALT
 18246                                    DE-LF-CANC-DTE
 18247                                    WS-DE-LF-CANC-DTE-N
 18248                                    DE-LF-CANC-EXIT-DT
 18249                                    WS-DE-LF-CANC-EXIT-DT-N
 18250                                    DE-LF-CNBEN
 18251                                    DE-LF-CNBEN-ALT
 18252                                    DE-LF-PRM
 18253                                    DE-LF-PRM-ALT
 18254                                    DE-LF-RFND
 18255                                    DE-LF-TERM
 18256                                    DE-LIVES
 18257                                    DE-PAYCUR
 18258                                    DE-PMT-FREQ
 18259                                    DE-REI-AHAMT
 18260                                    DE-REI-AHPRM
 18261                                    DE-REI-AHRFND
 18262                                    DE-REI-CNAMT
 18263                                    DE-REI-FUTRSV
 18264                                    DE-REI-LFAMT
 18265                                    DE-REI-LFPRM
 18266                                    DE-REI-LFRFND
 18267                                    DE-REI-PAYCUR
 18268                                    DE-RSV-REPORTED
 18269                                    DE-RSV-PAYTO
 18270                                    WS-DE-RSV-PAYTO-N
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 359
* ECS010Z.cbl
 18271                                    DE-SOC-SEC-NO.
 18272
 18273     MOVE SPACES                 TO W-REIN-PROCESS-IND.
 18274
 18275     PERFORM 2500-WRITE-DETAIL-EXTRACTS
 18276         THRU 2599-WRT-DETAIL-X.
 18277     ADD +1                      TO BC-G-CRS.
 18278
 18279 4740-EXIT.
 18280     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 360
* ECS010Z.cbl
 18282 4750-UPDATE-REIN.
 18283
 18284     COMPUTE SUB3 = SUB2 + 1.
 18285
 18286     IF  W-UNDERWRITTEN-DATA
 18287         MOVE EPEC-SUB-KEY-II (SUB2)
 18288                                 TO W-SUB-KEY
 18289     ELSE
 18290         MOVE EPEC-SUB-KEY (SUB2)
 18291                                 TO W-SUB-KEY.
 18292
 18293     PERFORM 4755-MATCH-REIN-EPEC THRU 4755-EXIT
 18294             VARYING
 18295         SUB3 FROM SUB3 BY +1
 18296             UNTIL
 18297         SUB3 GREATER THAN +900
 18298*        SUB3 GREATER THAN +220
 18299*        SUB3 GREATER THAN +300
 18300             OR
 18301         EPEC-LF-AH-OPT (SUB3) EQUAL SPACES.
 18302
 18303 4750-EXIT.
 18304     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 361
* ECS010Z.cbl
 18306 4755-MATCH-REIN-EPEC.
 18307
 18308     IF  W-UNDERWRITTEN-DATA
 18309         MOVE EPEC-LEVELS-II (SUB3)
 18310                                 TO EPEC-WORK
 18311     ELSE
 18312         MOVE EPEC-LEVELS (SUB3) TO EPEC-WORK.
 18313
 18314     IF  EPEC-LINE-NOT-USED (SUB3)
 18315         GO TO 4755-EXIT.
 18316
 18317     IF  EW-SUB-KEY NOT EQUAL W-SUB-KEY
 18318             OR
 18319         EW-REIN-CO EQUAL SPACES
 18320         GO TO 4755-EXIT.
 18321
 18322     IF  W-ISS-BEN GREATER THAN ZEROS
 18323         IF  EPEC-REIN-ONLY-DATA (SUB3)
 18324             COMPUTE W-FACTOR ROUNDED
 18325                 = (EW-ISS-BEN
 18326                 - EPEC-REIN-ISS-BEN (SUB3))
 18327                 / W-ISS-BEN
 18328         ELSE
 18329             COMPUTE W-FACTOR ROUNDED
 18330                 = EW-ISS-BEN
 18331                 / W-ISS-BEN.
 18332
 18333     COMPUTE EW-CLM-IBNR ROUNDED
 18334         = EW-CLM-IBNR
 18335         + (W-WK-IBNR * W-FACTOR).
 18336
 18337     IF  W-UNDERWRITTEN-DATA
 18338         MOVE EPEC-WORK          TO EPEC-LEVELS-II (SUB3)
 18339     ELSE
 18340         MOVE EPEC-WORK          TO EPEC-LEVELS (SUB3).
 18341
 18342 4755-EXIT.
 18343     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 362
* ECS010Z.cbl
 18345 4760-PROCESS-REIN-ONLY.
 18346
 18347     MOVE ZEROS                  TO W-WK-IBNR.
 18348
 18349     IF  EPEC-LINE-NOT-USED (SUB2)
 18350         GO TO 4760-EXIT.
 18351
 18352     IF  EW-LF-AH EQUAL 'L'
 18353         IF  EPEC-LIFE-IBNR (SUB2) EQUAL ZEROS
 18354             GO TO 4760-EXIT
 18355         ELSE
 18356             PERFORM 4720-PROCESS-LIFE THRU 4720-EXIT
 18357             ADD W-WK-IBNR       TO EW-CLM-IBNR
 18358     ELSE
 18359         IF  EPEC-EARNED-PREMIUM-AH (SUB2) EQUAL ZEROS
 18360             GO TO 4760-EXIT
 18361         ELSE
 18362             PERFORM 4730-PROCESS-A-H THRU 4730-EXIT
 18363             ADD W-WK-IBNR       TO EW-CLM-IBNR.
 18364
 18365 4760-EXIT.
 18366     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 363
* ECS010Z.cbl
 18368 4770-CREATE-REIN-DETAIL.
 18369
 18370     MOVE 'Y'                    TO W-REIN-PROCESS-IND.
 18371     PERFORM 4740-CREATE-DETAIL-EXTR THRU 4740-EXIT.
 18372
 18373 4770-EXIT.
 18374     EXIT.
 18375
 18376 4799-EXIT.
 18377     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 364
* ECS010Z.cbl
 18379 4800-CALC-EARNED-PREMIUM-AH.
 18380
 18381     MOVE +0                         TO CNC-BEN  EPR-R78
 18382                                        ISS-PRM  EPR-PRO
 18383                                        CNC-PRM  EPR-ST
 18384                                        WX-CLM-AMT
 18385                                        WX-CLM-EXP
 18386                                        WX-CLM-CNT
 18387                                        WX-CLM-CRT
 18388                                        WX-CNC-CNT
 18389                                        ISS-PRMTAX
 18390                                        WX-ACTIVE-COUNT.
 18391     MOVE SPACE                      TO A-H-EARNED-SWITCH.
 18392
 18393     MOVE WE-AHPRM TO ISS-PRM.
 18394
 18395     IF DTE-CLIENT = 'GIC'
 18396         IF REIN-EP-FLG NOT = 'R'  AND
 18397            CLAS-I-CALC-TYPE (CLAS-INDEXA) = 'B'  AND
 18398            (CR-ENTRY-STATUS NOT = '5' AND '3' AND 'M')
 18399            MOVE CR-AHPRM-CALC TO ISS-PRM.
 18400
 18401     IF REIN-EP-FLG = 'R'  AND
 18402        REIN-AH-RUNOFF-SW (SUB5) = 'N'
 18403         NEXT SENTENCE
 18404     ELSE
 18405         GO TO 4810-EP-DO-AH-CLM.
 18406
 18407     IF CR-DIS-DT NOT GREATER THAN EARNING-STOP-DATE
 18408         IF WE-DSPY-AMT NOT = +0
 18409             ADD WE-DSPY-AMT    TO WX-CLM-AMT
 18410             ADD WE-DSPY-EXP    TO WX-CLM-EXP
 18411             ADD CR-NUM-DIS-CLM TO WX-CLM-CNT
 18412             ADD +1             TO WX-CLM-CNT.
 18413
 18414     IF CR-AH-STATUS-AT-SETTLEMENT NOT = ' '
 18415         IF CR-DIS-DT GREATER THAN EARNING-STOP-DATE
 18416             GO TO 4830-EP-DO-AH-EP.
 18417
 18418     IF CR-AH-STATUS-AT-CANCEL NOT = ' '
 18419         IF CR-AH-CANC-DT GREATER THAN EARNING-STOP-DATE
 18420             GO TO 4830-EP-DO-AH-EP.
 18421
 18422     GO TO 4815-EP-DO-AH-CLM-EPR.
 18423
 18424 4810-EP-DO-AH-CLM.
 18425
 18426     IF WE-DSPY-AMT NOT = +0
 18427         ADD WE-DSPY-AMT    TO WX-CLM-AMT
 18428         ADD WE-DSPY-EXP    TO WX-CLM-EXP
 18429         ADD CR-NUM-DIS-CLM TO WX-CLM-CNT
 18430         ADD +1             TO WX-CLM-CNT.
 18431
 18432 4815-EP-DO-AH-CLM-EPR.
 18433
 18434     IF CR-AH-STATUS-AT-SETTLEMENT NOT = ' '
 18435         MOVE WE-AHPRM TO EPR-R78  EPR-PRO  EPR-ST.
 18436
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 365
* ECS010Z.cbl
 18437 4820-EP-DO-AH-CNCL.
 18438
 18439     IF CR-AH-STATUS-AT-CANCEL = ' '
 18440         IF CR-AH-STATUS-AT-SETTLEMENT NOT = ' '  AND
 18441            CLAS-I-CALC-TYPE (CLAS-INDEXA) NOT = 'Z'
 18442             GO TO 4899-EXIT
 18443         ELSE
 18444             GO TO 4830-EP-DO-AH-EP.
 18445
 18446     ADD +1         TO WX-CNC-CNT.
 18447
 18448     MOVE WE-AHRFND TO CNC-PRM.
 18449
 18450     MOVE CR-DT                 TO  DC-GREG-DATE-CYMD.
 18451     MOVE 'L'                   TO  DC-OPTION-CODE.
 18452     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 18453     MOVE DC-BIN-DATE-1         TO  WS-CR-BIN-DATE.
 18454
 18455     MOVE CR-AH-CANC-DT         TO DC-GREG-DATE-CYMD.
 18456     MOVE 'L'                   TO  DC-OPTION-CODE.
 18457     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 18458     MOVE DC-BIN-DATE-1         TO  WS-BIN-CANCEL-DATE.
 18459
 18460     MOVE WS-CR-BIN-DATE          TO  DC-BIN-DATE-1.
 18461     MOVE WS-BIN-CANCEL-DATE      TO  DC-BIN-DATE-2.
 18462     MOVE '1'                     TO  DC-OPTION-CODE.
 18463     MOVE ZEROS                   TO  MONTHS-DIFF-AH.
 18464     MOVE ZEROS                   TO  DC-ELAPSED-MONTHS
 18465                                      DC-ODD-DAYS-OVER
 18466                                      DC-ELAPSED-DAYS.
 18467     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 18468     MOVE DC-ELAPSED-MONTHS       TO  MONTHS-DIFF-AH.
 18469
 18470     IF DC-ODD-DAYS-OVER   GREATER THAN  ZERO
 18471         ADD  +1                  TO  MONTHS-DIFF-AH.
 18472
 18473     MOVE  'YYYYYYYYYY'           TO  WS-AH-CHARGEBACK-LEVELS.
 18474
 18475     IF DTE-CLIENT = 'ACE'
 18476         GO TO 4820-CONTINUE-AH-CANCEL.
 18477
 18478     MOVE  ZEROS                  TO  SUB.
 18479
 18480 4820-AH-CHARGEBACK-LOOP.
 18481
 18482     ADD    +1                    TO  SUB.
 18483
 18484     IF  SUB  GREATER THAN  +10
 18485         GO TO  4820-CONTINUE-AH-CANCEL.
 18486
 18487     IF  AM-COMM-CHARGEBACK (SUB)  NOT  NUMERIC  OR
 18488         AM-COMM-CHARGEBACK (SUB)  =  ZEROS
 18489         GO TO  4820-AH-CHARGEBACK-LOOP.
 18490
 18491     IF  AM-COMM-CHARGEBACK (SUB)  EQUAL    '99'
 18492         MOVE  'N'    TO  WS-AH-CHARGEBACK-SW (SUB).
 18493
 18494     IF  MONTHS-DIFF-AH GREATER THAN AM-COMM-CHARGEBACK (SUB)
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 366
* ECS010Z.cbl
 18495         MOVE  'N'        TO  WS-AH-CHARGEBACK-SW (SUB).
 18496
 18497     GO TO  4820-AH-CHARGEBACK-LOOP.
 18498
 18499
 18500 4820-CONTINUE-AH-CANCEL.
 18501
 18502     IF DTE-CLIENT = 'GIC'
 18503         IF REIN-EP-FLG NOT = 'R'  AND
 18504            CLAS-I-CALC-TYPE (CLAS-INDEXA) = 'B'
 18505            MOVE CR-AHRFND-CALC TO CNC-PRM.
 18506
 18507     COMPUTE EPR-R78 = WE-AHPRM - WE-AHRFND.
 18508     MOVE EPR-R78 TO EPR-PRO  EPR-ST.
 18509
 18510     IF CR-AH-LUMP-SUM-DISAB
 18511         GO TO 4899-EXIT.
 18512
 18513     MOVE WE-AHAMT TO CNC-BEN.
 18514
 18515     GO TO 4899-EXIT.
 18516
 18517 4825-EP-DO-AH-CNCL-SUM.
 18518
 18519     IF WE-DSPY-AMT NOT = +0
 18520         ADD WE-DSPY-AMT    TO WX-CLM-AMT
 18521         ADD WE-DSPY-EXP    TO WX-CLM-EXP
 18522         ADD CR-NUM-DIS-CLM TO WX-CLM-CNT
 18523         ADD +1             TO WX-CLM-CNT.
 18524
 18525     IF WE-AHRFND = ZERO
 18526        GO TO 4830-EP-DO-AH-EP.
 18527
 18528     MOVE WE-AHRFND TO CNC-PRM.
 18529
 18530     ADD CR-SUM-CAN-CNT-ITD TO WX-CNC-CNT.
 18531
 18532     MOVE  'YYYYYYYYYY'           TO  WS-AH-CHARGEBACK-LEVELS.
 18533
 18534     IF WE-AHRFND NOT LESS WE-AHPRM
 18535         MOVE WE-AHAMT TO CNC-BEN
 18536          GO TO 4830-EP-DO-AH-EP.
 18537
 18538     COMPUTE TEMP-6 ROUNDED = WE-AHRFND / WE-AHPRM.
 18539     COMPUTE TEMP-7 ROUNDED = TEMP-6 * WE-AHAMT.
 18540     MOVE TEMP-7 TO CNC-BEN.
 18541
 18542 4830-EP-DO-AH-EP.
 18543
 18544     MOVE EOM-RUN-DATE TO VALUATION-DT.
 18545     MOVE '8'           TO W-VAL-SOURCE.
 18546
 18547     IF REIN-EP-FLG = 'R'
 18548       IF REIN-REM-SW (SUB5) = 'I'
 18549           MOVE WE-AHPRM            TO EPR-R78  EPR-PRO  EPR-ST
 18550           GO TO 4899-EXIT.
 18551
 18552     IF REIN-EP-FLG = 'R'
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 367
* ECS010Z.cbl
 18553         IF REIN-AH-RUNOFF-SW (SUB5) = 'N'  AND
 18554            EARNING-STOP-DATE LESS THAN VALUATION-DT
 18555             MOVE '*'               TO A-H-EARNED-SWITCH
 18556             MOVE EARNING-STOP-DATE TO VALUATION-DT
 18557             MOVE '10'              TO W-VAL-SOURCE.
 18558
 18559     PERFORM 8500-REMAINING-TERM-ROUTINE THRU 8599-REM-TERM-X.
 18560
 18561     IF REM-TRM2 GREATER CR-AH-TERM
 18562         MOVE +0 TO EPR-R78  EPR-PRO  EPR-ST
 18563         GO TO 4899-EXIT.
 18564
 18565     IF CLAS-I-CALC-TYPE (CLAS-INDEXA) = 'Z'
 18566         COMPUTE WE-AHPRM = WE-AHPRM - WE-AHRFND.
 18567*
 18568 4835-CHECK-OB-AH-NCL.
 18569
 18570     IF (DTE-CLIENT EQUAL 'NCL') AND
 18571        (CLAS-I-CALC-TYPE (CLAS-INDEXA) EQUAL 'B')
 18572           MOVE WE-AHPRM         TO EPR-R78
 18573                                    EPR-PRO
 18574                                    EPR-ST
 18575        IF (CR-CCYY EQUAL EOM-CCYY) AND
 18576           (CR-MO EQUAL EOM-MO)
 18577           MOVE '*'            TO OB-DATE-1-SWITCH
 18578           MOVE EW-REIN-CO     TO WS-OB-REIN-CO (SUB3)
 18579           MOVE AH-OVERRIDE-L1 TO WS-OB-LF-AH (SUB3)
 18580           MOVE CR-AHTYP       TO WS-OB-BENEFIT-CODE (SUB3)
 18581           COMPUTE WS-EPR-R78 (SUB3 1) =
 18582                   WS-EPR-R78 (SUB3 1) + (WE-AHPRM * .5)
 18583           GO TO 4899-EXIT
 18584        ELSE
 18585        IF (CR-CCYY EQUAL OB-CCYY (1)) AND
 18586           (CR-MO EQUAL OB-MO (1))
 18587           MOVE '*'            TO OB-DATE-2-SWITCH
 18588           MOVE EW-REIN-CO     TO WS-OB-REIN-CO (SUB3)
 18589           MOVE AH-OVERRIDE-L1 TO WS-OB-LF-AH (SUB3)
 18590           MOVE CR-AHTYP       TO WS-OB-BENEFIT-CODE (SUB3)
 18591           COMPUTE WS-EPR-R78 (SUB3 2) =
 18592                   WS-EPR-R78 (SUB3 2) + (WE-AHPRM * .5)
 18593           GO TO 4899-EXIT
 18594        ELSE
 18595        IF (CR-CCYY EQUAL OB-CCYY (2)) AND
 18596           (CR-MO EQUAL OB-MO (2))
 18597           MOVE '*'            TO OB-DATE-3-SWITCH
 18598           MOVE EW-REIN-CO     TO WS-OB-REIN-CO (SUB3)
 18599           MOVE AH-OVERRIDE-L1 TO WS-OB-LF-AH (SUB3)
 18600           MOVE CR-AHTYP       TO WS-OB-BENEFIT-CODE (SUB3)
 18601           COMPUTE WS-EPR-R78 (SUB3 3) =
 18602                   WS-EPR-R78 (SUB3 3) + (WE-AHPRM * .5)
 18603           GO TO 4899-EXIT
 18604        ELSE
 18605           GO TO 4899-EXIT.
 18606
 18607     IF REM-TRM2 NOT GREATER +0
 18608         MOVE WE-AHPRM TO EPR-R78  EPR-PRO  EPR-ST
 18609         GO TO 4899-EXIT.
 18610
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 368
* ECS010Z.cbl
 18611     IF CLAS-I-CALC-TYPE (CLAS-INDEXA) = 'B'
 18612         MOVE WE-AHPRM TO EPR-R78  EPR-PRO  EPR-ST
 18613         GO TO 4899-EXIT.
 18614
 18615     IF CLAS-I-CALC-TYPE (CLAS-INDEXA) NOT = 'Z'
 18616         MOVE +1 TO WX-ACTIVE-COUNT
 18617     ELSE
 18618         COMPUTE WX-ACTIVE-COUNT = CR-LIVES - CR-SUM-CAN-CNT-ITD.
 18619
 18620     COMPUTE TEMP-1 = CR-AH-TERM * (CR-AH-TERM + 1).
 18621     COMPUTE TEMP-2 = REM-TRM1 * (REM-TRM1 + 1).
 18622     IF DTE-R78 = '1'
 18623         COMPUTE TEMP-2 = REM-TRM1 * REM-TRM1.
 18624     COMPUTE TEMP-4 ROUNDED = TEMP-2 / TEMP-1.
 18625
 18626     IF DTE-CLIENT = 'MIC' OR 'MCC'
 18627         COMPUTE TEMP-5 ROUNDED = (REM-TRM1 - .5) / CR-AH-TERM
 18628     ELSE
 18629         COMPUTE TEMP-5 ROUNDED = REM-TRM1 / CR-AH-TERM.
 18630
 18631     COMPUTE EPR-R78 ROUNDED = WE-AHPRM * TEMP-4.
 18632     COMPUTE EPR-R78 = WE-AHPRM - EPR-R78.
 18633
 18634     COMPUTE EPR-PRO ROUNDED = WE-AHPRM * TEMP-5.
 18635     COMPUTE EPR-PRO = WE-AHPRM - EPR-PRO.
 18636
 18637     MOVE CLAS-I-EP (CLAS-INDEXA) TO AH-EARN-METHOD.
 18638
 18639*    IF AM-EARN-METHOD-A NOT EQUAL SPACES AND ZEROS
 18640*        MOVE AM-EARN-METHOD-A TO AH-EARN-METHOD.
 18641
 18642     MOVE SPACES TO STATUTORY-SWITCH-AH.
 18643
 18644     IF (STATE-ABBR (CLAS-INDEXS) = 'VA') AND
 18645        (CR-DT GREATER THAN  19921231)
 18646         IF CR-AH-TERM GREATER THAN  +61
 18647             MOVE 'A' TO AH-EARN-METHOD
 18648             MOVE '*' TO STATUTORY-SWITCH-AH
 18649             GO TO 4845-EP-DO-AH-EP-AN
 18650         ELSE
 18651             GO TO 4860-EP-DO-AH-STATUTORY.
 18652
 18653     IF AH-EARN-METHOD EQUAL 'N'
 18654         GO TO 4840-EP-DO-AH-EP-NP.
 18655
 18656     IF AH-EARN-METHOD EQUAL 'A' OR 'C'
 18657         MOVE 'A' TO AH-EARN-METHOD
 18658         GO TO 4845-EP-DO-AH-EP-AN.
 18659
 18660     GO TO 4860-EP-DO-AH-STATUTORY.
 18661
 18662 4840-EP-DO-AH-EP-NP.
 18663
 18664     IF WE-AHPRM = ZERO
 18665         GO TO 4860-EP-DO-AH-STATUTORY.
 18666
 18667     IF CR-APR GREATER THAN +0
 18668         NEXT SENTENCE
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 369
* ECS010Z.cbl
 18669     ELSE
 18670         GO TO 4860-EP-DO-AH-STATUTORY.
 18671
 18672     IF DTE-CLIENT = 'NCL'
 18673       IF CR-DT LESS THAN 19910101
 18674           GO TO 4860-EP-DO-AH-STATUTORY.
 18675
 18676     IF REM-TRM1 = CR-AH-TERM
 18677         MOVE +0 TO EPR-R78  EPR-PRO  EPR-ST
 18678         GO TO 4899-EXIT.
 18679
 18680     MOVE CR-APR TO NP-APR.
 18681     MOVE CR-AH-TERM TO NP-ORIG  NP-CAP.
 18682     MOVE REM-TRM1 TO NP-REM.
 18683     MOVE CLAS-I-CALC-TYPE (CLAS-INDEXA) TO NP-OPT.
 18684     IF NP-OPT = 'T' OR 'U' OR 'V' OR 'W' OR 'X'
 18685         MOVE CR-LOAN-TERM TO NP-ORIG.
 18686     MOVE 'R' TO NP-OPT.
 18687     CALL 'ECSNETRM'
 18688         USING NP-APR NP-ORIG NP-REM NP-OPT NP-CAP NP-FACTOR.
 18689
 18690     COMPUTE EPR-R78 ROUNDED = WE-AHPRM - (NP-FACTOR * WE-AHPRM).
 18691
 18692     GO TO 4860-EP-DO-AH-STATUTORY.
 18693
 18694 4845-EP-DO-AH-EP-AN.
 18695     MOVE CR-DT                      TO DC-GREG-DATE-CYMD.
 18696     MOVE 'L'                        TO DC-OPTION-CODE.
 18697     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 18698     MOVE DC-BIN-DATE-1              TO CP-CERT-EFF-DT.
 18699     MOVE CLAS-I-RL-AH (CLAS-INDEXA) TO CP-BENEFIT-TYPE.
 18700     MOVE SPACES                     TO CP-ACCT-FLD-5.
 18701     MOVE DTE-CLIENT                 TO CP-COMPANY-ID.
 18702     MOVE STATE-SUB (CLAS-INDEXS)    TO CP-STATE.
 18703     MOVE STATE-ABBR (CLAS-INDEXS)   TO CP-STATE-STD-ABBRV.
 18704     MOVE CR-AGE                     TO CP-ISSUE-AGE.
 18705     MOVE REM-TRM1                   TO CP-ORIGINAL-TERM.
 18706     MOVE CR-AHAMT                   TO CP-ORIGINAL-BENEFIT
 18707                                        CP-RATING-BENEFIT-AMT.
 18708     IF CP-STATE-STD-ABBRV = 'OR'
 18709         COMPUTE CP-RATING-BENEFIT-AMT =
 18710                                  CR-AHAMT * REM-TRM1.
 18711     MOVE CR-APR                     TO CP-LOAN-APR.
 18712     MOVE CR-PMT-FREQ                TO CP-PAY-FREQUENCY.
 18713     MOVE AH-EARN-METHOD             TO CP-EARNING-METHOD.
 18714     MOVE '3'                        TO CP-PROCESS-TYPE.
 18715     MOVE CLAS-I-BAL (CLAS-INDEXA)   TO CP-SPECIAL-CALC-CD.
 18716     MOVE CR-LOAN-TERM               TO CP-LOAN-TERM.
 18717     IF CR-RATING-CLASS NOT = SPACE AND ZERO
 18718         MOVE CR-RATING-CLASS        TO CP-CLASS-CODE
 18719     ELSE
 18720         MOVE AM-CAL-TABLE           TO CP-CLASS-CODE.
 18721     MOVE AM-AH-DEVIATION            TO CP-DEVIATION-CODE.
 18722     MOVE CR-AHTYP                   TO CP-BENEFIT-CD.
 18723     MOVE DTE-CLASIC-COMPANY-CD      TO CP-COMPANY-CD.
 18724     MOVE CR-PMT-EXTENSION-DAYS      TO CP-TERM-OR-EXT-DAYS.
 18725     MOVE AH-OVERRIDE-L1             TO CP-AH-OVERRIDE-CODE.
 18726     MOVE AM-AH-DEVIATION-PCT        TO CP-RATE-DEV-PCT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 370
* ECS010Z.cbl
 18727
 18728     PERFORM 8100-GET-RATE THRU 8199-GET-RATE-X.
 18729
 18730     IF CP-ERROR-RATE-NOT-FOUND  OR
 18731        CP-ERROR-RATE-IS-ZERO  OR
 18732        CP-ERROR-IN-DATES
 18733         GO TO 4860-EP-DO-AH-STATUTORY.
 18734
 18735     COMPUTE EPR-R78 ROUNDED =
 18736             ((REM-TRM1 * WE-AHAMT) / +100) *
 18737               CP-PREMIUM-RATE.
 18738
 18739     COMPUTE EPR-R78 = WE-AHPRM - EPR-R78.
 18740
 18741     IF STATUTORY-REQUIREMENT-AH
 18742         MOVE EPR-R78                TO EPR-ST
 18743         GO TO 4899-EXIT.
 18744
 18745 4860-EP-DO-AH-STATUTORY.
 18746     MOVE EPR-R78                    TO EPR-ST.
 18747
 18748     MOVE +0                         TO SUB1.
 18749
 18750 4865-EP-AH-STAT-LOOP.
 18751     ADD +1 TO SUB1.
 18752
 18753     IF STATE-ABBR (CLAS-INDEXS) = AH-RES-STATE-ENT (SUB1)
 18754         MOVE EPR-PRO                TO EPR-ST
 18755     ELSE
 18756         IF AH-RES-STATE-ENT (SUB1) NOT = HIGH-VALUES
 18757             GO TO 4865-EP-AH-STAT-LOOP.
 18758
 18759     IF (STATE-ABBR (CLAS-INDEXS) = 'OH'  AND
 18760         CR-DT GREATER THAN 19831031)  OR
 18761
 18762        (STATE-ABBR (CLAS-INDEXS) = 'OK'  AND
 18763         CR-DT GREATER THAN 19820629)  OR
 18764
 18765        (STATE-ABBR (CLAS-INDEXS) = 'TX'  AND
 18766         CR-DT GREATER THAN 19830831)
 18767
 18768         COMPUTE EPR-ST = (EPR-R78 + EPR-PRO) / 2.
 18769
 18770     IF DTE-CLIENT = 'CSO'  OR  'CID'
 18771       IF STATE-ABBR (CLAS-INDEXS) = 'CO'
 18772         IF CR-DT LESS THAN 19970101
 18773             MOVE EPR-R78            TO EPR-ST
 18774         ELSE
 18775             COMPUTE EPR-ST = (EPR-R78 + EPR-PRO) / 2.
 18776
 18777     IF DTE-CLIENT = 'DCC'
 18778        IF CLAS-I-BAL (CLAS-INDEXA) = 'C'
 18779           MOVE EPR-PRO          TO EPR-ST
 18780        ELSE
 18781           COMPUTE EPR-ST = (EPR-R78 + EPR-PRO) / 2
 18782        END-IF
 18783     END-IF
 18784     .
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 371
* ECS010Z.cbl
 18785 4899-EXIT.
 18786     EXIT.
 18787******************************************************************
 18788***         W R I T E   S U M M A R Y   E X T R A C T S        ***
 18789******************************************************************
 18790
 18791 4900-WRITE-SUMMARY-EXTRACTS.
 18792
 18793     IF DTE-CLIENT = 'HER'
 18794         IF EP-RECORD-ID = 'EC'  AND
 18795            EP-REINCO = 'LNL'
 18796             GO TO 4999-WRT-SUMMARY-X.
 18797
 18798     MOVE EOM-RUN-DATE            TO EP-RUN-DTE
 18799                                     WS-EP-RUN-DTE-N.
 18800
 18801     IF W-UNDERWRITTEN-DATA
 18802         MOVE 'Y'                 TO EP-UNDERWRITING-CODE
 18803     ELSE
 18804         MOVE 'N'                 TO EP-UNDERWRITING-CODE.
 18805
 18806     IF  DTE-OPT-RESERVE-METHOD-AUTH
 18807         IF VALID-EP-ID
 18808             MOVE 'Y'             TO EP-NEW-DATA-IND.
 18809
 18810     WRITE EP-RECORD.
 18811
 18812     ADD +1                       TO EP-CNT.
 18813
 18814 4999-WRT-SUMMARY-X.
 18815     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 372
* ECS010Z.cbl
 18817******************************************************************
 18818***       T O T A L   P A G E   S E T U P   R O U T I N E      ***
 18819******************************************************************
 18820
 18821 5000-DATE-RANGE-BREAK.
 18822
 18823     IF NO-TRANSACTION-WAS-PROCESSED
 18824         GO TO 5099-DATE-RANGE-BREAK-X.
 18825
 18826     ADD +1  TO RANGE-CNT.
 18827     MOVE +1 TO SUB6.
 18828     MOVE +2 TO SUB7.
 18829     PERFORM 5800-ADD-PAGES-LEVELS THRU 5899-ADD-PAGES-LEVELS-X.
 18830     IF LN-CNT GREATER +50
 18831         PERFORM 8700-PRINT-REPORT-HEADINGS THRU
 18832                 8750-PRT-RANGE-HEADING.
 18833
 18834     MOVE SPACES                     TO PRT.
 18835     PERFORM 8800-PRINT-ROUTINE.
 18836     MOVE 'DATE RANGE'               TO TPH2-DESC.
 18837     MOVE '  TOTALS'                 TO TPH3-DESC.
 18838     PERFORM 6100-ACCT-TOTAL-HEADINGS THRU 6199-PAGE-HEADINGS-X.
 18839     PERFORM 6500-PRINT-TOTAL-PAGE THRU 6599-TOTAL-PAGE-PRINT-X.
 18840     PERFORM 5900-CLEAR-TOTAL-PAGES
 18841         THRU 5999-CLEAR-TOTAL-PAGES-X
 18842             VARYING SUB6 FROM 1 BY 1 UNTIL SUB6 GREATER 1.
 18843
 18844 5099-DATE-RANGE-BREAK-X.
 18845     EXIT.
 18846
 18847 5100-ACCOUNT-BREAK.
 18848
 18849     IF RANGE-CNT NOT = +0
 18850         PERFORM 5000-DATE-RANGE-BREAK
 18851             THRU 5099-DATE-RANGE-BREAK-X
 18852     ELSE
 18853         MOVE +1 TO SUB6
 18854         MOVE +2 TO SUB7
 18855         PERFORM 5800-ADD-PAGES-LEVELS
 18856             THRU 5899-ADD-PAGES-LEVELS-X
 18857         PERFORM 5900-CLEAR-TOTAL-PAGES
 18858             THRU 5999-CLEAR-TOTAL-PAGES-X
 18859                 VARYING SUB6 FROM 1 BY 1 UNTIL SUB6 GREATER 1.
 18860
 18861     MOVE +0 TO RANGE-CNT.
 18862     PERFORM 7500-ADD-UP-REIN-CO THRU 7599-ADD-UP-REIN-X
 18863         VARYING B-SUB FROM 1 BY 1
 18864             UNTIL B-SUB GREATER THAN 50  OR
 18865                   RB-COMPANY (B-SUB) = SPACES.
 18866     PERFORM 7900-CLEAR-BILLING-TABLE THRU 7999-CLEAR-BILLING-X
 18867         VARYING B-SUB FROM 1 BY 1
 18868             UNTIL B-SUB GREATER THAN 50.
 18869
 18870     IF ACCT-FLG = SPACE
 18871         GO TO 5199-ACCOUNT-BREAK-X.
 18872
 18873     MOVE SPACE TO ACCT-FLG.
 18874     MOVE +2 TO SUB6.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 373
* ECS010Z.cbl
 18875     MOVE +3 TO SUB7.
 18876     PERFORM 5800-ADD-PAGES-LEVELS THRU 5899-ADD-PAGES-LEVELS-X.
 18877     IF LN-CNT GREATER +50
 18878         PERFORM 8700-PRINT-REPORT-HEADINGS THRU
 18879                 8725-PRT-ACCT-HEADING.
 18880
 18881     MOVE SPACES                     TO PRT.
 18882     PERFORM 8800-PRINT-ROUTINE.
 18883     MOVE 'ACCOUNT'                  TO TPH2-DESC.
 18884     MOVE ' TOTALS'                  TO TPH3-DESC.
 18885     PERFORM 6100-ACCT-TOTAL-HEADINGS THRU 6199-PAGE-HEADINGS-X.
 18886     PERFORM 6500-PRINT-TOTAL-PAGE THRU 6599-TOTAL-PAGE-PRINT-X.
 18887     PERFORM 5900-CLEAR-TOTAL-PAGES
 18888         THRU 5999-CLEAR-TOTAL-PAGES-X
 18889             VARYING SUB6 FROM 2 BY 1 UNTIL SUB6 GREATER 2.
 18890
 18891 5199-ACCOUNT-BREAK-X.
 18892     EXIT.
 18893
 18894 5200-STATE-BREAK.
 18895
 18896     PERFORM 5100-ACCOUNT-BREAK THRU 5199-ACCOUNT-BREAK-X.
 18897     MOVE ZEROS TO SV-LO-CERT  SV-HI-CERT.
 18898     MOVE +3 TO SUB6.
 18899     MOVE +4 TO SUB7.
 18900     PERFORM 5800-ADD-PAGES-LEVELS THRU 5899-ADD-PAGES-LEVELS-X.
 18901
 18902     IF STATE-FLG = SPACE
 18903         GO TO 5299-STATE-BREAK-X.
 18904
 18905     MOVE SPACE         TO STATE-FLG.
 18906     PERFORM 8700-PRINT-REPORT-HEADINGS.
 18907     MOVE 'STATE'       TO TPH1-TYPE.
 18908     MOVE HLD-STATE     TO STATE-L.
 18909
 18910     PERFORM 8200-STATE-CODE-LOOKUP THRU 8299-STATE-LOOKUP-X.
 18911
 18912     IF HLD-STATE NOT = STATE-SUB (CLAS-INDEXS)
 18913         MOVE SPACES          TO TPH1-DESC
 18914         MOVE HLD-STATE       TO TPH1-ST-CODE
 18915         MOVE 'UNKNOWN STATE' TO TPH1-ST-DESC
 18916     ELSE
 18917         MOVE SPACES TO TPH1-DESC
 18918         MOVE STATE-SUB (CLAS-INDEXS) TO TPH1-ST-CODE
 18919         MOVE STATE-PIC (CLAS-INDEXS) TO TPH1-ST-DESC.
 18920
 18921     MOVE 'STATE'  TO TPH2-DESC.
 18922     MOVE 'TOTALS' TO TPH3-DESC.
 18923     PERFORM 6000-TOTAL-PAGE-HEADINGS THRU 6199-PAGE-HEADINGS-X.
 18924     PERFORM 6500-PRINT-TOTAL-PAGE THRU 6599-TOTAL-PAGE-PRINT-X.
 18925     PERFORM 5900-CLEAR-TOTAL-PAGES
 18926         THRU 5999-CLEAR-TOTAL-PAGES-X
 18927             VARYING SUB6 FROM 3 BY 1 UNTIL SUB6 GREATER 3.
 18928
 18929 5299-STATE-BREAK-X.
 18930     EXIT.
 18931
 18932 5300-COMP-BREAK.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 374
* ECS010Z.cbl
 18933
 18934     PERFORM 5200-STATE-BREAK THRU 5299-STATE-BREAK-X.
 18935     MOVE +4 TO SUB6.
 18936     MOVE +5 TO SUB7.
 18937     PERFORM 5800-ADD-PAGES-LEVELS THRU 5899-ADD-PAGES-LEVELS-X.
 18938
 18939     IF COMP-FLG = SPACE
 18940         GO TO 5399-COMP-BREAK-X.
 18941
 18942     MOVE ' ' TO COMP-FLG.
 18943     PERFORM 8700-PRINT-REPORT-HEADINGS.
 18944     MOVE 'COMPANY'                   TO TPH1-TYPE.
 18945     MOVE HLD-GROUPING                TO TPH1-DESC.
 18946     MOVE 'COMPANY'                   TO TPH2-DESC.
 18947     MOVE ' TOTALS'                   TO TPH3-DESC.
 18948     PERFORM 6000-TOTAL-PAGE-HEADINGS THRU 6199-PAGE-HEADINGS-X.
 18949     PERFORM 6500-PRINT-TOTAL-PAGE THRU 6599-TOTAL-PAGE-PRINT-X.
 18950     PERFORM 5900-CLEAR-TOTAL-PAGES
 18951         THRU 5999-CLEAR-TOTAL-PAGES-X
 18952             VARYING SUB6 FROM 4 BY 1 UNTIL SUB6 GREATER 4.
 18953
 18954 5399-COMP-BREAK-X.
 18955     EXIT.
 18956
 18957 5400-CARR-BREAK.
 18958
 18959     PERFORM 5300-COMP-BREAK THRU 5399-COMP-BREAK-X.
 18960     MOVE +5 TO SUB6.
 18961     MOVE +6 TO SUB7.
 18962     PERFORM 5800-ADD-PAGES-LEVELS THRU 5899-ADD-PAGES-LEVELS-X.
 18963
 18964     IF CARR-FLG = SPACE
 18965         GO TO 5499-CARR-BREAK-X.
 18966
 18967     MOVE ' ' TO CARR-FLG.
 18968     PERFORM 8700-PRINT-REPORT-HEADINGS.
 18969     MOVE 'CARRIER'               TO TPH1-TYPE.
 18970     MOVE HLD-CARRIER             TO TPH1-DESC.
 18971     MOVE 'CARRIER'               TO TPH2-DESC.
 18972     MOVE ' TOTALS'               TO TPH3-DESC.
 18973     PERFORM 6000-TOTAL-PAGE-HEADINGS THRU 6199-PAGE-HEADINGS-X.
 18974     PERFORM 6500-PRINT-TOTAL-PAGE THRU 6599-TOTAL-PAGE-PRINT-X.
 18975     PERFORM 5900-CLEAR-TOTAL-PAGES
 18976         THRU 5999-CLEAR-TOTAL-PAGES-X
 18977             VARYING SUB6 FROM 5 BY 1 UNTIL SUB6 GREATER 5.
 18978
 18979 5499-CARR-BREAK-X.
 18980     EXIT.
 18981
 18982 5500-FINAL-BREAK.
 18983
 18984     PERFORM 5400-CARR-BREAK THRU 5499-CARR-BREAK-X.
 18985
 18986     IF FINAL-FLG = SPACE
 18987         GO TO 5599-FINAL-BREAK-X.
 18988
 18989     IF DTE-FICH = '1'
 18990         MOVE '2'  TO  DTE-FICH.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 375
* ECS010Z.cbl
 18991     MOVE +6 TO SUB6.
 18992     PERFORM 8700-PRINT-REPORT-HEADINGS.
 18993     MOVE SPACES   TO TPH1-TYPE.
 18994     MOVE SPACES   TO TPH1-DESC.
 18995     MOVE 'FINAL'  TO TPH2-DESC.
 18996     MOVE 'TOTALS' TO TPH3-DESC.
 18997     PERFORM 6000-TOTAL-PAGE-HEADINGS THRU 6199-PAGE-HEADINGS-X.
 18998     PERFORM 6500-PRINT-TOTAL-PAGE THRU 6599-TOTAL-PAGE-PRINT-X.
 18999
 19000 5599-FINAL-BREAK-X.
 19001     EXIT.
 19002
 19003 5800-ADD-PAGES-LEVELS.
 19004
 19005     ADD TPL-ISS-PRM (SUB6)  TO TPL-ISS-PRM (SUB7).
 19006     ADD TPA-ISS-PRM (SUB6)  TO TPA-ISS-PRM (SUB7).
 19007     ADD TPL-CNC-PRM (SUB6)  TO TPL-CNC-PRM (SUB7).
 19008     ADD TPA-CNC-PRM (SUB6)  TO TPA-CNC-PRM (SUB7).
 19009     ADD TPL-ACCT-COM (SUB6) TO TPL-ACCT-COM (SUB7).
 19010     ADD TPA-ACCT-COM (SUB6) TO TPA-ACCT-COM (SUB7).
 19011     ADD TPL-CLAIMS (SUB6)   TO TPL-CLAIMS (SUB7).
 19012     ADD TPA-CLAIMS (SUB6)   TO TPA-CLAIMS (SUB7).
 19013
 19014 5899-ADD-PAGES-LEVELS-X.
 19015     EXIT.
 19016
 19017 5900-CLEAR-TOTAL-PAGES.
 19018
 19019     MOVE +0 TO TPL-ISS-PRM (SUB6)  TPA-ISS-PRM (SUB6)
 19020             TPL-CNC-PRM (SUB6)     TPA-CNC-PRM (SUB6)
 19021             TPL-ACCT-COM (SUB6)    TPA-ACCT-COM (SUB6)
 19022             TPL-CLAIMS (SUB6)      TPA-CLAIMS (SUB6).
 19023
 19024 5999-CLEAR-TOTAL-PAGES-X.
 19025     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 376
* ECS010Z.cbl
 19027******************************************************************
 19028***       T O T A L   P A G E   P R I N T   R O U T I N E      ***
 19029******************************************************************
 19030
 19031 6000-TOTAL-PAGE-HEADINGS.
 19032
 19033     MOVE TOTAL-PAGE-HD1 TO PRT.
 19034     PERFORM 8800-PRINT-ROUTINE.
 19035
 19036 6100-ACCT-TOTAL-HEADINGS.
 19037
 19038     MOVE TOTAL-PAGE-HD2 TO PRT.
 19039     MOVE '0' TO P-CTL.
 19040     PERFORM 8800-PRINT-ROUTINE.
 19041     MOVE TOTAL-PAGE-HD3 TO PRT.
 19042     MOVE ' ' TO P-CTL.
 19043     PERFORM 8800-PRINT-ROUTINE.
 19044     PERFORM 8800-PRINT-ROUTINE.
 19045     MOVE +81 TO LN-CNT.
 19046
 19047 6199-PAGE-HEADINGS-X.
 19048     EXIT.
 19049
 19050 6500-PRINT-TOTAL-PAGE.
 19051
 19052     MOVE SPACES             TO TOTAL-PAGE-DETAIL.
 19053     MOVE LIFE-OVERRIDE-L6   TO TPD-DESC.
 19054     MOVE TPL-ISS-PRM (SUB6) TO TPD-ISS-PRM.
 19055
 19056     IF SUB6 = 6 AND ME-DO-UPDATE
 19057         MOVE TPL-ISS-PRM (6) TO ME-010-PREM-L.
 19058
 19059     MOVE TPL-CNC-PRM (SUB6) TO TPD-CNC-PRM.
 19060
 19061     IF SUB6 = 6 AND ME-DO-UPDATE
 19062         MOVE TPL-CNC-PRM (6) TO ME-010-REF-L.
 19063
 19064     COMPUTE TPD-NET-PRM =
 19065         TPL-ISS-PRM (SUB6) - TPL-CNC-PRM (SUB6).
 19066
 19067     IF SUB6 = 6 AND ME-DO-UPDATE
 19068         SUBTRACT TPL-CNC-PRM (6) FROM TPL-ISS-PRM (6)
 19069         GIVING ME-010-NET-L.
 19070
 19071     MOVE TPL-ACCT-COM (SUB6) TO TPD-ACCT-COM.
 19072
 19073     IF SUB6 = 6 AND ME-DO-UPDATE
 19074         MOVE TPL-ACCT-COM (6) TO ME-010-COMM-L.
 19075
 19076     COMPUTE TPD-PREM-COMP =
 19077         TPL-ISS-PRM (SUB6) - TPL-CNC-PRM (SUB6)
 19078                            - TPL-ACCT-COM (SUB6).
 19079     MOVE TPL-CLAIMS (SUB6)   TO TPD-CLAIMS.
 19080
 19081     IF SUB6 = 6 AND ME-DO-UPDATE
 19082         MOVE TPL-CLAIMS (6) TO ME-010-PMT-L.
 19083
 19084     MOVE TOTAL-PAGE-DETAIL   TO PRT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 377
* ECS010Z.cbl
 19085     PERFORM 8800-PRINT-ROUTINE.
 19086     MOVE SPACES             TO TOTAL-PAGE-DETAIL.
 19087     MOVE AH-OVERRIDE-L6     TO TPD-DESC.
 19088     MOVE TPA-ISS-PRM (SUB6) TO TPD-ISS-PRM.
 19089     MOVE TPA-CNC-PRM (SUB6) TO TPD-CNC-PRM.
 19090
 19091     IF SUB6 = 6 AND ME-DO-UPDATE
 19092         MOVE TPA-ISS-PRM (6) TO ME-010-PREM-AH
 19093         MOVE TPA-CNC-PRM (6) TO ME-010-REF-AH.
 19094
 19095     COMPUTE TPD-NET-PRM =
 19096         TPA-ISS-PRM (SUB6) - TPA-CNC-PRM (SUB6).
 19097
 19098     IF SUB6 = 6 AND ME-DO-UPDATE
 19099         SUBTRACT TPA-CNC-PRM (6) FROM TPA-ISS-PRM (6)
 19100         GIVING ME-010-NET-AH.
 19101
 19102     MOVE TPA-ACCT-COM (SUB6) TO TPD-ACCT-COM.
 19103
 19104     IF SUB6 = 6 AND ME-DO-UPDATE
 19105         MOVE TPA-ACCT-COM (6) TO ME-010-COMM-AH.
 19106
 19107     COMPUTE TPD-PREM-COMP =
 19108         TPA-ISS-PRM (SUB6) - TPA-CNC-PRM (SUB6)
 19109                            - TPA-ACCT-COM (SUB6).
 19110     MOVE TPA-CLAIMS (SUB6)   TO TPD-CLAIMS.
 19111
 19112     IF SUB6 = 6 AND ME-DO-UPDATE
 19113         MOVE TPA-CLAIMS (6) TO ME-010-PMT-AH.
 19114
 19115     MOVE TOTAL-PAGE-DETAIL   TO PRT.
 19116     PERFORM 8800-PRINT-ROUTINE.
 19117
 19118     MOVE 'TOTAL' TO TPD-DESC.
 19119
 19120     COMPUTE TPD-ISS-PRM =
 19121         TPL-ISS-PRM (SUB6) + TPA-ISS-PRM (SUB6).
 19122
 19123     COMPUTE TPD-CNC-PRM =
 19124         TPL-CNC-PRM (SUB6) + TPA-CNC-PRM (SUB6).
 19125
 19126     COMPUTE TPD-NET-PRM =
 19127         TPL-ISS-PRM (SUB6) + TPA-ISS-PRM (SUB6)
 19128         - TPL-CNC-PRM (SUB6) - TPA-CNC-PRM (SUB6).
 19129
 19130     COMPUTE TPD-ACCT-COM =
 19131         TPL-ACCT-COM (SUB6) + TPA-ACCT-COM (SUB6).
 19132
 19133     COMPUTE TPD-PREM-COMP =
 19134         TPL-ISS-PRM (SUB6) + TPA-ISS-PRM (SUB6)
 19135         - TPL-CNC-PRM (SUB6) - TPA-CNC-PRM (SUB6)
 19136         - TPL-ACCT-COM (SUB6) - TPA-ACCT-COM (SUB6).
 19137
 19138     COMPUTE TPD-CLAIMS =
 19139         TPL-CLAIMS (SUB6) + TPA-CLAIMS (SUB6).
 19140
 19141     IF SV-LO-CERT = ZEROS  AND  SV-HI-CERT = ZEROS
 19142         NEXT SENTENCE
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 378
* ECS010Z.cbl
 19143     ELSE
 19144         MOVE SV-LO-CERT (6:6) TO TPD-LO-CERT
 19145         MOVE SV-HI-CERT (6:6) TO TPD-HI-CERT
 19146         MOVE ZEROS TO SV-LO-CERT  SV-HI-CERT.
 19147*        MOVE SV-LO-CERT (4:8)    TO TPD-LO-CERT
 19148*        MOVE SV-HI-CERT (4:8)    TO TPD-HI-CERT
 19149*        MOVE ZEROS               TO SV-LO-CERT
 19150*                                    SV-HI-CERT.
 19151
 19152     MOVE TOTAL-PAGE-DETAIL       TO PRT.
 19153     MOVE '0'                     TO P-CTL.
 19154     PERFORM 8800-PRINT-ROUTINE.
 19155     PERFORM 8800-PRINT-ROUTINE.
 19156
 19157 6599-TOTAL-PAGE-PRINT-X.
 19158     EXIT.
 19159*
 19160*
 19161*
 19162**START***********************************************************
 19163*      CUSTOM CODING FOR CLIENT "DMD"            PROJECT# 6475
 19164*            PARAGRAPHS  XXXX THRU 6700-COMM-EXIT
 19165******************************************************************
 19166*
 19167 6650-GET-RES-STATE-COMM.
 19168*6650-BROWSE-FORWARD.
 19169
 19170     IF DTE-CLIENT NOT = 'DMD'
 19171         GO TO 6700-COMM-EXIT.
 19172
 19173     MOVE CR-COMPANY-CD       TO WS-ERRESC-COMPANY-CD.
 19174     MOVE CR-CARRIER          TO WS-ERRESC-CARRIER.
 19175     MOVE CR-GROUPING         TO WS-ERRESC-GROUP.
 19176     MOVE CR-STATE            TO WS-ERRESC-STATE.
 19177     MOVE CR-ACCOUNT          TO WS-ERRESC-ACCOUNT.
 19178     MOVE WK-AGT              TO WS-ERRESC-AGENT.
 19179     MOVE CR-CERT-NO (1:2)    TO WS-ERRESC-RES-STATE.
 19180     MOVE CR-DT               TO WS-YYYYMMDD-DT.
 19181
 19182     MOVE WS-YYYYMMDD-DT      TO WS-ERRESC-EXPIRE-DT.
 19183
 19184*POSITION FILE AT STARTING KEY RECORD(COMPANY, CARRIER, GROUP, STA
 19185*ACCOUNT,AGENT, RESIDENT STATE) AND RESC-EXPIRE-DATE SET BY THE
 19186*VALUE OF PB-CERT-EFF-DT
 19187*
 19188     MOVE WS-ERRESC-KEY        TO ERRESC-RECORD-KEY.
 19189
 19190     START ERRESC-IN KEY NOT LESS THAN ERRESC-RECORD-KEY.
 19191
 19192     IF ERRESC-FILE-STATUS NOT EQUAL '00'
 19193         GO TO 6700-COMM-EXIT.
 19194
 19195*GET RECORD WHERE POSITIONED
 19196
 19197 6650-READ-ERRESC-NEXT.
 19198     READ ERRESC-IN NEXT RECORD.
 19199
 19200     IF ERRESC-FILE-STATUS NOT EQUAL '00'
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 379
* ECS010Z.cbl
 19201         GO TO 6700-COMM-EXIT.
 19202
 19203*GOT GOOD RECORD ??    FIRST 32 POSITIONS MUST MATCH  !!!!!!
 19204
 19205     IF ERRESC-RECORD-KEY (1:32) EQUAL TO WS-ERRESC-KEY (1:32)
 19206        NEXT SENTENCE
 19207     ELSE
 19208         GO TO 6700-COMM-EXIT.
 19209
 19210     IF WS-YYYYMMDD-DT < RESC-EXPIRE-DATE
 19211         NEXT SENTENCE
 19212     ELSE
 19213         GO TO 6650-READ-ERRESC-NEXT.
 19214
 19215*  CR-DT  = WS-YYYYMMDD-DT
 19216*CHECK TO SEE IF CERTIFICATE EFFECTIVE DATE IS WITHIN ACCOUNT
 19217*RESIDENT STATE COMMISSION RECORD'S EFFECTIVE TIME PERIOD???
 19218
 19219     IF WS-YYYYMMDD-DT IS LESS THAN RESC-EFFECTIVE-DATE
 19220         GO TO 6700-COMM-EXIT.
 19221
 19222* SEARCH FOR MATCHING CATEGORY CODE ENTRY
 19223
 19224     MOVE ZEROS               TO WS-SUB WS-SUB1.
 19225
 19226     PERFORM 6680-SEARCH-CATEGORY THRU 6680-EXIT.
 19227
 19228     IF WS-SUB1 IS GREATER THAN ZERO
 19229         IF RESC-COMMISSION-PER (WS-SUB) NOT NUMERIC
 19230             PERFORM 6680-SET-TABLE-CODE
 19231         ELSE
 19232             PERFORM 6680-SET-COMMISSION.
 19233
 19234     GO TO 6700-COMM-EXIT.
 19235
 19236 6680-SET-TABLE-CODE.
 19237     IF RESC-COMMISSION-TAB (WS-SUB) EQUAL SPACES
 19238        MOVE ZEROS             TO WS-SUB1
 19239     ELSE
 19240* DEFAULT TO AH-COVERAGE TO READ COMMISSION TABLE(CTBL)
 19241* TO COMPUTE AH COMMISSION.
 19242        MOVE CR-AHTYP          TO CTBL-BEN-CODE
 19243        MOVE CR-AH-TERM        TO WS-COMM-TERM
 19244        MOVE AH-OVERRIDE-L1    TO CTBL-BEN-TYPE
 19245        MOVE RESC-COMMISSION-TAB (WS-SUB)
 19246                               TO CTBL-TABLE-CD
 19247        PERFORM 6680-READ-CTBL-TABLE
 19248        IF ERCTBL-FILE-STATUS NOT EQUAL '00'
 19249           MOVE ZEROS          TO WS-SUB1.
 19250
 19251 6680-READ-CTBL-TABLE.
 19252*
 19253* WHEN CR-AHTYP = ZEROS READ COMMISSION TABLE(CTBL)
 19254* TO COMPUTE LIFE COMMISSION
 19255
 19256     IF CR-AHTYP = ZERO
 19257        MOVE LIFE-OVERRIDE-L1  TO CTBL-BEN-TYPE
 19258        MOVE CR-LFTYP          TO CTBL-BEN-CODE
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 380
* ECS010Z.cbl
 19259        MOVE CR-LF-TERM        TO WS-COMM-TERM.
 19260
 19261     PERFORM 1300-READ-ERCTBL-FILE THRU 1399-READ-ERCTBL-X.
 19262
 19263     IF ERCTBL-FILE-STATUS EQUAL '00'
 19264* COMPUTE A-H COMMISSION WHEN CR-AHTYP IS NOT ZEROS
 19265        IF CR-AHTYP NOT = ZERO
 19266             COMPUTE COMM-CK-AMT = CR-AHAMT * CR-AH-TERM
 19267             MOVE CR-AH-TERM        TO WS-COMM-TERM
 19268             PERFORM 1400-GET-COMM-PERCENT THRU 1489-GET-PERCENT-X
 19269             MOVE WK-RATE           TO WS-COMMISSION
 19270                                       PB-I-AH-COMMISSION
 19271        ELSE
 19272* COMPUTE LIFE COMMISSION WHEN CR-AHTYP IS ZEROS
 19273             MOVE CR-LFAMT    TO COMM-CK-AMT
 19274             MOVE CR-LF-TERM  TO WS-COMM-TERM
 19275             PERFORM 1400-GET-COMM-PERCENT THRU 1489-GET-PERCENT-X
 19276             MOVE WK-RATE     TO WS-COMMISSION
 19277                                 PB-I-LIFE-COMMISSION.
 19278
 19279 6680-SET-COMMISSION.
 19280     IF RESC-COMMISSION-PER (WS-SUB) EQUAL ZEROS
 19281           MOVE ZEROS         TO WS-SUB1
 19282       ELSE
 19283           MOVE RESC-COMMISSION-PER (WS-SUB)
 19284                              TO WS-COMMISSION WK-RATE
 19285           IF CR-AHTYP NOT = ZERO
 19286                MOVE WS-COMMISSION TO PB-I-AH-COMMISSION
 19287           ELSE
 19288                MOVE WS-COMMISSION TO PB-I-LIFE-COMMISSION.
 19289
 19290 6680-SEARCH-CATEGORY.
 19291     ADD +1 TO WS-SUB.
 19292
 19293     IF WS-SUB IS GREATER THAN +12
 19294         GO TO 6680-EXIT.
 19295
 19296     IF CR-CERT-NO (4:1) = RESC-COVERAGE-CAT (WS-SUB)
 19297          MOVE WS-SUB         TO WS-SUB1
 19298          GO TO 6680-EXIT.
 19299
 19300     GO TO 6680-SEARCH-CATEGORY.
 19301
 19302 6680-EXIT.
 19303     EXIT.
 19304
 19305 6700-COMM-EXIT.
 19306     EXIT.
 19307*
 19308*END***************CUSTOM CODE FOR CLIENT "DMD"*************
 19309
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 381
* ECS010Z.cbl
 19311******************************************************************
 19312***         C L I E N T   B I L L I N G   R O U T I N E        ***
 19313******************************************************************
 19314
 19315 7000-CLIENT-BILLING-ROUTINE.
 19316*
 19317*
 19318* LEAVE THE ABOVE 2 LINES IN TO PREVENT LOSING THE LINE ABOVE
 19319
 19320     MOVE +0 TO BC-NET-WRIT BC-NET-WRIT-OB BC-NET-WRIT-SP
 19321                BC-G-ISS      BC-G-CNC   BC-G-CLM
 19322                BC-G-CRS      BC-G-CTN   BC-R-ISS      BC-R-CNC
 19323                BC-R-CLM      BC-R-CRS   BC-R-CTN      BC-COMM
 19324                BC-NEW-ACCTS  BC-ACCTS   BC-ACT-ACCTS
 19325                BC-G-CERTS    BC-G-A-CERTS  BC-R-CERTS
 19326                BC-R-A-CERTS  BC-ER-ACCTS   BC-CS-ACCTS.
 19327
 19328 7099-BILL-X.
 19329     EXIT.
 19330
 19331
 19332 7500-ADD-UP-REIN-CO.
 19333
 19334     IF RB-COMPANY (B-SUB) NOT = SPACES
 19335         ADD RB-COUNT (B-SUB) TO BC-CS-ACCTS.
 19336
 19337 7599-ADD-UP-REIN-X.
 19338     EXIT.
 19339
 19340 7900-CLEAR-BILLING-TABLE.
 19341
 19342     MOVE SPACES TO RB-COMPANY (B-SUB).
 19343     MOVE 0      TO RB-COUNT (B-SUB).
 19344
 19345 7999-CLEAR-BILLING-X.
 19346     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 382
* ECS010Z.cbl
 19348******************************************************************
 19349***         M I S C E L L A N E O U S   R O U T I N E S        ***
 19350******************************************************************
 19351
 19352 8000-DATE-CONVERT-ROUTINE.
 19353
 19354     CALL 'ELDATCX' USING DATE-CONVERSION-DATA.
 19355
 19356 8099-DATE-CONVERT-X.
 19357     EXIT.
 19358
 19359 8000R-CONVERT-STOP-DATE.
 19360
 19361     MOVE RWF-EP-STOP-DATE        TO DC-GREG-DATE-CYMD.
 19362     MOVE 'L'                     TO DC-OPTION-CODE.
 19363     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 19364     MOVE +0                      TO DC-ELAPSED-MONTHS.
 19365     MOVE -1                      TO DC-ELAPSED-DAYS.
 19366     MOVE '6'                     TO DC-OPTION-CODE.
 19367     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 19368     MOVE +0                      TO DC-ELAPSED-MONTHS
 19369                                     DC-ELAPSED-DAYS.
 19370     MOVE DC-BIN-DATE-2           TO DC-BIN-DATE-1.
 19371     MOVE ' '                     TO DC-OPTION-CODE.
 19372     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 19373
 19374     IF NO-CONVERSION-ERROR
 19375         MOVE DC-GREG-DATE-CYMD   TO EARNING-STOP-DATE
 19376     ELSE
 19377         DISPLAY 'ERROR OCCURED CONVERTING EARNING STOP '
 19378                 'DATE IN REIN TABLE: ' CR-REIN-TABLE
 19379                 '  STOP DATE: ' RWF-EP-STOP-DATE
 19380         MOVE 'ERROR OCCURED CONVERTING EARNING STOP DATE '
 19381                                  TO WS-ABEND-MESSAGE
 19382         MOVE DC-ERROR-CODE       TO WS-ABEND-FILE-STATUS
 19383         MOVE 4002                TO WS-ABEND-CODE
 19384         GO TO ABEND-PGM.
 19385
 19386 8099R-STOP-DATE-X.
 19387     EXIT.
 19388
 19389
 19390 8100-GET-RATE.
 19391
 19392     CALL 'ELRATEX' USING CALCULATION-PASS-AREA.
 19393
 19394 8199-GET-RATE-X.
 19395     EXIT.
 19396
 19397
 19398 8200-STATE-CODE-LOOKUP.
 19399
 19400     IF CLAS-INDEXS NOT GREATER CLAS-MAXS  AND
 19401        CLAS-INDEXS NOT = ZERO
 19402         IF STATE-L = STATE-SUB (CLAS-INDEXS)
 19403             GO TO 8299-STATE-LOOKUP-X.
 19404
 19405     MOVE CLAS-STARTS TO CLAS-INDEXS.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 383
* ECS010Z.cbl
 19406
 19407 8250-STATE-LOOKUP-LOOP.
 19408
 19409     IF CLAS-INDEXS GREATER CLAS-MAXS  OR  CLAS-INDEXS = ZERO
 19410         MOVE 0302 TO WS-ABEND-CODE
 19411         DISPLAY 'STATE CODE ' STATE-L ' NOT IN STATE TABLE'
 19412         DISPLAY '******************************'
 19413         DISPLAY '***** ERROR LOCATION 022 *****'
 19414         DISPLAY '******************************'
 19415         MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
 19416         GO TO ABEND-PGM.
 19417
 19418     IF STATE-L NOT = STATE-SUB (CLAS-INDEXS)
 19419         ADD +1 TO CLAS-INDEXS
 19420         GO TO 8250-STATE-LOOKUP-LOOP.
 19421
 19422 8299-STATE-LOOKUP-X.
 19423     EXIT.
 19424
 19425
 19426 8300-LIFE-TYPE-LOOKUP.
 19427
 19428     IF CLAS-INDEXL NOT GREATER CLAS-MAXL  AND
 19429        CLAS-INDEXL NOT = ZERO
 19430         IF CLAS-LOOK = CLAS-I-BEN (CLAS-INDEXL)
 19431             GO TO 8399-LIFE-LOOKUP-X.
 19432
 19433     MOVE CLAS-STARTL TO CLAS-INDEXL.
 19434
 19435 8350-LIFE-LOOKUP-LOOP.
 19436
 19437     IF CLAS-INDEXL GREATER CLAS-MAXL  OR  CLAS-INDEXL = ZERO
 19438         MOVE 0401 TO WS-ABEND-CODE
 19439         DISPLAY 'LIFE TYPE ' CLAS-LOOK ' NOT IN TYPE TABLE'
 19440         DISPLAY '    PENDING CONTROL = ' PENDING-MATCH-CONTROL
 19441         DISPLAY '       CERT CONTROL = ' CR-FULL-CONTROL
 19442         DISPLAY '******************************'
 19443         DISPLAY '***** ERROR LOCATION 023 *****'
 19444         DISPLAY '******************************'
 19445         MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
 19446         IF DTE-CLIENT = 'NCL'
 19447                      OR 'CID'
 19448             MOVE CLAS-STARTL      TO CLAS-INDEXL
 19449             MOVE '05'             TO CLAS-LOOK
 19450             GO TO 8350-LIFE-LOOKUP-LOOP
 19451         ELSE
 19452             GO TO ABEND-PGM.
 19453
 19454     IF CLAS-LOOK NOT = CLAS-I-BEN (CLAS-INDEXL)
 19455         ADD +1 TO CLAS-INDEXL
 19456         GO TO 8350-LIFE-LOOKUP-LOOP.
 19457
 19458     IF CLAS-I-EP (CLAS-INDEXL) = 'U'
 19459         MOVE 'R'                    TO CLAS-I-EP (CLAS-INDEXL).
 19460
 19461 8399-LIFE-LOOKUP-X.
 19462     EXIT.
 19463
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 384
* ECS010Z.cbl
 19464
 19465 8400-A-H-TYPE-LOOKUP.
 19466
 19467     IF CLAS-INDEXA NOT GREATER CLAS-MAXA  AND
 19468        CLAS-INDEXA NOT = ZERO
 19469         IF CLAS-LOOK = CLAS-I-BEN (CLAS-INDEXA)
 19470             GO TO 8499-A-H-LOOKUP-X.
 19471
 19472     MOVE CLAS-STARTA TO CLAS-INDEXA.
 19473
 19474 8450-A-H-LOOKUP-LOOP.
 19475
 19476     IF CLAS-INDEXA GREATER CLAS-MAXA  OR  CLAS-INDEXA = ZERO
 19477         MOVE 0402 TO WS-ABEND-CODE
 19478         DISPLAY 'A&H TYPE ' CLAS-LOOK ' NOT IN TYPE TABLE'
 19479         DISPLAY '    PENDING CONTROL = ' PENDING-MATCH-CONTROL
 19480         DISPLAY '       CERT CONTROL = ' CR-FULL-CONTROL
 19481         DISPLAY '******************************'
 19482         DISPLAY '***** ERROR LOCATION 024 *****'
 19483         DISPLAY '******************************'
 19484         MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
 19485         IF DTE-CLIENT = 'NCL'
 19486             MOVE CLAS-STARTA      TO CLAS-INDEXA
 19487             MOVE '05'             TO CLAS-LOOK
 19488             GO TO 8450-A-H-LOOKUP-LOOP
 19489         ELSE
 19490             GO TO ABEND-PGM.
 19491
 19492     IF CLAS-LOOK NOT = CLAS-I-BEN (CLAS-INDEXA)
 19493         ADD +1 TO CLAS-INDEXA
 19494         GO TO 8450-A-H-LOOKUP-LOOP.
 19495
 19496 8499-A-H-LOOKUP-X.
 19497     EXIT.
 19498
 19499 8500-REMAINING-TERM-ROUTINE.
 19500
 19501     MOVE ZEROS                      TO CP-REMAINING-TERM
 19502                                        CP-REMAINING-TERM-1
 19503                                        CP-REMAINING-TERM-2
 19504                                        CP-REMAINING-TERM-3
 19505                                        CP-RETURN-CODE
 19506                                        CP-RETURN-CODE-2
 19507                                        REM-TRM1
 19508                                        REM-TRM2
 19509                                        REM-TRM3
 19510                                        TEM-TRM1.
 19511     MOVE SPACES                     TO CP-REM-TERM-METHOD.
 19512
 19513     MOVE CR-DT                      TO DC-GREG-DATE-CYMD.
 19514     MOVE 'L'                        TO DC-OPTION-CODE.
 19515     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 19516
 19517     IF  NO-CONVERSION-ERROR
 19518         MOVE DC-BIN-DATE-1          TO CP-CERT-EFF-DT
 19519     ELSE
 19520         MOVE 'ERROR OCCURED CONVERTING CR-DT'
 19521                                     TO WS-ABEND-MESSAGE
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 385
* ECS010Z.cbl
 19522         MOVE DC-ERROR-CODE          TO WS-ABEND-FILE-STATUS
 19523         MOVE 3001                   TO WS-ABEND-CODE
 19524         GO TO ABEND-PGM.
 19525
 19526     MOVE LOW-VALUES                 TO CP-FIRST-PAY-DATE
 19527
 19528     IF  CR-LOAN-1ST-PMT-DT NOT NUMERIC
 19529         MOVE ZEROS                  TO CR-LOAN-1ST-PMT-DT.
 19530
 19531     IF  CR-LOAN-1ST-PMT-DT NOT = ZEROS
 19532         MOVE CR-LOAN-1ST-PMT-DT     TO DC-GREG-DATE-1-YMD
 19533         MOVE ZEROS                  TO DC-ELAPSED-MONTHS
 19534                                        DC-ELAPSED-DAYS
 19535         MOVE '3'                    TO DC-OPTION-CODE
 19536         PERFORM 8000-DATE-CONVERT-ROUTINE THRU
 19537                 8099-DATE-CONVERT-X
 19538         IF  NO-CONVERSION-ERROR
 19539             MOVE DC-BIN-DATE-1      TO CP-FIRST-PAY-DATE
 19540         ELSE
 19541             MOVE ZEROS              TO CR-LOAN-1ST-PMT-DT.
 19542
 19543     IF  CP-FIRST-PAY-DATE LESS THAN CP-CERT-EFF-DT
 19544         MOVE ZEROS                  TO CR-LOAN-1ST-PMT-DT.
 19545
 19546     IF  CR-LOAN-1ST-PMT-DT = ZEROS
 19547         MOVE CP-CERT-EFF-DT         TO DC-BIN-DATE-1
 19548         MOVE +1                     TO DC-ELAPSED-MONTHS
 19549         MOVE ZEROS                  TO DC-ELAPSED-DAYS
 19550         MOVE '6'                    TO DC-OPTION-CODE
 19551         PERFORM 8000-DATE-CONVERT-ROUTINE THRU
 19552                 8099-DATE-CONVERT-X
 19553         IF  NO-CONVERSION-ERROR
 19554             MOVE DC-BIN-DATE-2      TO CP-FIRST-PAY-DATE
 19555             MOVE DC-GREG-DATE-1-YMD TO CR-LOAN-1ST-PMT-DT
 19556         ELSE
 19557             MOVE 'ERROR OCCURED DETERMINING 1ST PAY DATE '
 19558                                     TO WS-ABEND-MESSAGE
 19559             MOVE DC-ERROR-CODE      TO WS-ABEND-FILE-STATUS
 19560             MOVE 3002               TO WS-ABEND-CODE
 19561             GO TO ABEND-PGM.
 19562
 19563     MOVE VALUATION-DT               TO DC-GREG-DATE-CYMD.
 19564     MOVE 'L'                        TO DC-OPTION-CODE.
 19565     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 19566
 19567     IF  NO-CONVERSION-ERROR
 19568         MOVE DC-BIN-DATE-1          TO CP-VALUATION-DT
 19569     ELSE
 19570         DISPLAY 'ERROR CONVERTING VALUATION DATE, SOURCE - '
 19571             W-VAL-ERROR (W-VAL-SOURCE)
 19572         DISPLAY '   KEY - ' CR-FULL-CONTROL
 19573             ' VALUATION DT - ' VALUATION-DT ' ERROR - '
 19574             DC-ERROR-CODE
 19575         DISPLAY '   STATUS: ' CR-ENTRY-STATUS ' LF: ' CR-LFTYP
 19576         ' ' CR-LF-CURRENT-STATUS '-' CR-LF-STATUS-AT-CANCEL '-'
 19577             CR-LF-STATUS-AT-DEATH ' AH: ' CR-AHTYP ' '
 19578             CR-AH-CURRENT-STATUS '-' CR-AH-STATUS-AT-CANCEL '-'
 19579             CR-AH-STATUS-AT-SETTLEMENT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 386
* ECS010Z.cbl
 19580*        MOVE 'ERROR OCCURED CONVERTING VALUATION DATE'
 19581*                                    TO WS-ABEND-MESSAGE
 19582*        MOVE DC-ERROR-CODE          TO WS-ABEND-FILE-STATUS
 19583*        MOVE 3003                   TO WS-ABEND-CODE
 19584*        GO TO ABEND-PGM.
 19585
 19586     MOVE STATE-SUB (CLAS-INDEXS)    TO CP-STATE.
 19587     MOVE STATE-ABBR (CLAS-INDEXS)   TO CP-STATE-STD-ABBRV.
 19588     MOVE '3'                        TO CP-PROCESS-TYPE.
 19589     MOVE DTE-CLASIC-COMPANY-CD      TO CP-COMPANY-CD.
 19590     MOVE DTE-CLIENT                 TO CP-COMPANY-ID.
 19591     MOVE SPACES                     TO CP-ACCT-FLD-5.
 19592
 19593*    MOVE CLAS-CO-REM-TERM-CALC (W-NDX)
 19594*                                    TO CP-REM-TERM-METHOD.
 19595
 19596     IF  DTE-CLIENT = 'FIM'
 19597         MOVE '5'                    TO CP-REM-TERM-METHOD.
 19598
 19599     IF DTE-CLIENT = 'FLI' OR 'FLU'
 19600         IF WE-LF-AH = AH-OVERRIDE-L1
 19601             MOVE '2'                TO CP-REM-TERM-METHOD
 19602         ELSE
 19603             IF CR-LFTYP = '01' OR '03'
 19604                 MOVE '4'            TO CP-REM-TERM-METHOD
 19605             ELSE
 19606                 IF CR-LFTYP = '02' OR '04'
 19607                     MOVE '2'        TO CP-REM-TERM-METHOD.
 19608
 19609     IF  DTE-CLIENT = 'CSL'
 19610         IF  CR-CARRIER = '2'
 19611             IF  CR-LFTYP = '07' OR  '08'
 19612                 MOVE '4'            TO CP-REM-TERM-METHOD.
 19613
 19614     IF  DTE-CLIENT = 'POS'
 19615         IF  CR-CARRIER = '1'
 19616             MOVE '1'                TO CP-REM-TERM-METHOD
 19617         ELSE
 19618             MOVE '2'                TO CP-REM-TERM-METHOD.
 19619
 19620     IF  CP-REM-TERM-METHOD = SPACES OR LOW-VALUES
 19621         MOVE DTE-REM-TRM            TO CP-REM-TERM-METHOD.
 19622
 19623     IF  WE-LF-AH EQUAL AH-OVERRIDE-L1
 19624         GO TO 8540-CALC-REM-TERM-AH.
 19625
 19626 8520-CALC-REM-TERM-LIFE.
 19627
 19628     MOVE CLAS-I-EP (CLAS-INDEXL)    TO CP-EARNING-METHOD.
 19629     MOVE CLAS-I-RL-AH (CLAS-INDEXL) TO CP-BENEFIT-TYPE.
 19630     MOVE CLAS-I-BAL (CLAS-INDEXL)   TO CP-SPECIAL-CALC-CD.
 19631*    MOVE ORIG-TERM                  TO CP-ORIGINAL-TERM.
 19632     MOVE CR-LF-TERM                 TO CP-ORIGINAL-TERM
 19633                                        CP-LOAN-TERM.
 19634
 19635     IF  CLAS-I-EP (CLAS-INDEXL) EQUAL 'B'
 19636             AND
 19637         CLAS-I-CALC-TYPE (CLAS-INDEXL) NOT EQUAL 'L'
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 387
* ECS010Z.cbl
 19638         ADD +1                      TO CP-ORIGINAL-TERM
 19639                                        CP-LOAN-TERM.
 19640
 19641     IF  CP-TERM-IS-DAYS
 19642         MOVE CR-LF-TERM-IN-DAYS     TO CP-TERM-OR-EXT-DAYS
 19643     ELSE
 19644         MOVE ZEROS                  TO CP-TERM-OR-EXT-DAYS.
 19645
 19646     MOVE DTE-REM-TRM-CALC-OPTION    TO CP-REM-TRM-CALC-OPTION.
 19647
 19648     IF  CP-ORIGINAL-TERM NOT GREATER THAN ZEROS
 19649         ADD +1                      TO W-ORGTRM-0-LF
 19650         DISPLAY 'LF TRM NOT GREATER THAN +0 - '
 19651             CR-FULL-CONTROL
 19652         GO TO 8599-REM-TERM-X.
 19653
 19654     CALL 'ELRTRMX' USING CALCULATION-PASS-AREA.
 19655
 19656     IF  CP-RETURN-CODE NOT EQUAL ZEROS
 19657         ADD +1                      TO W-RET-CODE-LF
 19658         GO TO 8599-REM-TERM-X.
 19659*
 19660*        MOVE 'ERROR OCCURED REMAINING TERM CALCULATION - LF'
 19661*                                    TO WS-ABEND-MESSAGE
 19662*        MOVE CP-RETURN-CODE         TO WS-ABEND-FILE-STATUS
 19663*        MOVE 2002                   TO WS-ABEND-CODE
 19664*        GO TO ABEND-PGM.
 19665
 19666     IF  CLAS-I-EP (CLAS-INDEXL) EQUAL 'B'
 19667             AND
 19668         CLAS-I-CALC-TYPE (CLAS-INDEXL) NOT EQUAL 'L'
 19669         MOVE CP-REMAINING-TERM-2    TO W-BAL-REMTRM
 19670         COMPUTE CP-REMAINING-TERM-1 = CP-REMAINING-TERM-1 - 1
 19671         COMPUTE CP-REMAINING-TERM-2 = CP-REMAINING-TERM-2 - 1.
 19672
 19673     IF  CP-REMAINING-TERM-1 NEGATIVE
 19674         MOVE ZEROS                  TO CP-REMAINING-TERM-1.
 19675
 19676     IF  CP-REMAINING-TERM-2 NEGATIVE
 19677         MOVE ZEROS                  TO CP-REMAINING-TERM-2.
 19678
 19679     IF DTE-CLIENT = 'NCL'
 19680         MOVE CP-REMAINING-TERM-1    TO CP-REMAINING-TERM-2
 19681                                        CP-REMAINING-TERM-3.
 19682
 19683     MOVE CP-REMAINING-TERM-1        TO REM-TRM1.
 19684     MOVE CP-REMAINING-TERM-2        TO REM-TRM2.
 19685     MOVE CP-REMAINING-TERM-3        TO REM-TRM3.
 19686     MOVE CP-ODD-DAYS                TO TEM-TRM1.
 19687
 19688     GO TO 8599-REM-TERM-X.
 19689
 19690 8520-EXIT.
 19691     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 388
* ECS010Z.cbl
 19693 8540-CALC-REM-TERM-AH.
 19694
 19695     MOVE CLAS-I-EP (CLAS-INDEXA)    TO CP-EARNING-METHOD.
 19696     MOVE CLAS-I-RL-AH (CLAS-INDEXA) TO CP-BENEFIT-TYPE.
 19697     MOVE CLAS-I-BAL (CLAS-INDEXA)   TO CP-SPECIAL-CALC-CD.
 19698     MOVE CR-AH-TERM                 TO CP-ORIGINAL-TERM
 19699                                        CP-LOAN-TERM.
 19700     MOVE ZEROS                      TO CP-TERM-OR-EXT-DAYS.
 19701
 19702     MOVE DTE-REM-TRM-CALC-OPTION    TO CP-REM-TRM-CALC-OPTION.
 19703
 19704     IF  CP-ORIGINAL-TERM NOT GREATER THAN ZEROS
 19705         DISPLAY 'AH TRM NOT GREATER THAN +0 - '
 19706             CR-FULL-CONTROL
 19707         ADD +1                      TO W-ORGTRM-0-AH
 19708         GO TO 8599-REM-TERM-X.
 19709
 19710     CALL 'ELRTRMX' USING CALCULATION-PASS-AREA.
 19711
 19712     IF  CP-RETURN-CODE NOT EQUAL ZEROS
 19713         ADD +1                      TO W-RET-CODE-AH
 19714         GO TO 8599-REM-TERM-X.
 19715*
 19716*        MOVE 'ERROR OCCURED REMAINING TERM CALCULATION - AH'
 19717*                                    TO WS-ABEND-MESSAGE
 19718*        MOVE CP-RETURN-CODE         TO WS-ABEND-FILE-STATUS
 19719*        MOVE 2001                   TO WS-ABEND-CODE
 19720*        GO TO ABEND-PGM.
 19721
 19722     IF DTE-CLIENT = 'NCL'
 19723         MOVE CP-REMAINING-TERM-1    TO CP-REMAINING-TERM-2
 19724                                        CP-REMAINING-TERM-3.
 19725
 19726     MOVE CP-REMAINING-TERM-1        TO REM-TRM1.
 19727     MOVE CP-REMAINING-TERM-2        TO REM-TRM2.
 19728     MOVE CP-REMAINING-TERM-3        TO REM-TRM3.
 19729     MOVE CP-ODD-DAYS                TO TEM-TRM1.
 19730
 19731 8599-REM-TERM-X.
 19732     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 389
* ECS010Z.cbl
 19734
 19735******************************************************************
 19736***     " D I S P L A Y "  P R I N T   R O U T I N E           ***
 19737******************************************************************
 19738
 19739 8600-DISPLAY-PRT.
 19740
 19741     IF  DIS-LINE-CNT GREATER THAN 59
 19742         PERFORM 8600-DISPLAY-HD THRU
 19743             8600-HD-EXIT.
 19744
 19745     ADD  1  TO DIS-LINE-CNT.
 19746     WRITE DISPLAY-REC FROM DISPLAY-LINE.
 19747     MOVE  SPACES TO DISPLAY-REC
 19748                     DISPLAY-LINE.
 19749
 19750 8600-DISPLAY-EXIT.
 19751     EXIT.
 19752
 19753
 19754 8600-DISPLAY-HD.
 19755
 19756     MOVE '1'  TO  DISPLAY-CC.
 19757     MOVE ZEROS TO DIS-LINE-CNT.
 19758     WRITE DISPLAY-REC FROM DISPLAY-HD-1.
 19759     ADD +1 TO DIS-LINE-CNT.
 19760     MOVE ' '  TO  DISPLAY-CC.
 19761     MOVE SPACES TO DISPLAY-REC.
 19762     WRITE DISPLAY-REC.
 19763     ADD +1 TO DIS-LINE-CNT.
 19764     MOVE WS-CURRENT-DATE  TO  DIS-DATE.
 19765     WRITE DISPLAY-REC FROM DISPLAY-HD-2.
 19766     ADD +1 TO DIS-LINE-CNT.
 19767     MOVE SPACES TO DISPLAY-REC.
 19768     ADD +1 TO DIS-LINE-CNT.
 19769     WRITE DISPLAY-REC.
 19770
 19771 8600-HD-EXIT.
 19772     EXIT.
 19773
 19774******************************************************************
 19775***      T R A N S A C T I O N   P R I N T   R O U T I N E     ***
 19776******************************************************************
 19777
 19778 8600-SETUP-DETAIL-LINE.
 19779
 19780     MOVE SPACES                TO TR-DTL2.
 19781
 19782     MOVE CR-CERT-NO            TO TRD-CERT.
 19783     MOVE CR-YR                 TO TRD-ISYR.
 19784     MOVE CR-MO                 TO TRD-ISMO.
 19785     MOVE CR-DA                 TO TRD-ISDA.
 19786     MOVE CR-AGE                TO TRD-AGE.
 19787
 19788 8689-SETUP-DETAIL-X.
 19789     EXIT.
 19790
 19791 8690-PRINT-DETAIL-LINE.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 390
* ECS010Z.cbl
 19792
 19793     IF LN-CNT GREATER THAN LN-MX
 19794         PERFORM 8700-PRINT-REPORT-HEADINGS THRU
 19795                 8799-PRT-HEADINGS-X.
 19796     MOVE TRD-CERT TO SV-TRD-CERT.
 19797     MOVE TRD-ISDT TO SV-TRD-ISDT.
 19798
 19799     IF TRD-CERT = LST-TRD-CERT  AND  TRD-ISDT = LST-TRD-ISDT
 19800         MOVE SPACES TO TRD-CERT  TRD-ISDT  TRD-AGE.
 19801
 19802     MOVE SV-TRD-CERT TO LST-TRD-CERT.
 19803     MOVE SV-TRD-ISDT TO LST-TRD-ISDT.
 19804     MOVE TR-DTL TO PRT.
 19805
 19806     IF NOT WS-CHANGE-REC
 19807         MOVE '/'                TO TRD-IS-S1  TRD-IS-S2
 19808     ELSE
 19809         MOVE 'N'                TO  WS-CHANGE-REC-SW.
 19810
 19811     PERFORM 8800-PRINT-ROUTINE.
 19812
 19813 8699-PRT-DETAIL-X.
 19814     EXIT.
 19815
 19816 8700-PRINT-REPORT-HEADINGS.
 19817     ADD +1 TO PG-CNT.
 19818     MOVE PG-CNT TO TR-PG.
 19819     MOVE +0 TO LN-CNT.
 19820     MOVE TR-HD-1 TO PRT.
 19821     PERFORM 8800-PRINT-ROUTINE.
 19822     MOVE TR-HD-2 TO PRT.
 19823     PERFORM 8800-PRINT-ROUTINE.
 19824     MOVE TR-HD-3 TO PRT.
 19825     PERFORM 8800-PRINT-ROUTINE.
 19826     ADD +1 TO LN-CNT.
 19827
 19828 8725-PRT-ACCT-HEADING.
 19829     MOVE TR-HD-4 TO PRT.
 19830     PERFORM 8800-PRINT-ROUTINE.
 19831     MOVE TR-HD-5 TO PRT.
 19832     PERFORM 8800-PRINT-ROUTINE.
 19833
 19834 8750-PRT-RANGE-HEADING.
 19835     MOVE TR-HD-6 TO PRT.
 19836     PERFORM 8800-PRINT-ROUTINE.
 19837
 19838 8775-PRT-COLUMN-HEADINGS.
 19839     MOVE TR-HD-7 TO PRT.
 19840     PERFORM 8800-PRINT-ROUTINE.
 19841     MOVE TR-HD-8 TO PRT.
 19842     PERFORM 8800-PRINT-ROUTINE.
 19843     MOVE TR-HD-9 TO PRT.
 19844     PERFORM 8800-PRINT-ROUTINE.
 19845     PERFORM 8800-PRINT-ROUTINE.
 19846
 19847 8799-PRT-HEADINGS-X.
 19848     EXIT.
 19849
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 391
* ECS010Z.cbl
 19850 8800-PRINT-ROUTINE.
 19851     MOVE P-CTL TO X.
 19852     PERFORM 8900-PRINT-A-LINE THRU 8999-PRT-LINE-X.
 19853     ADD +1 TO LN-CNT.
 19854     MOVE SPACES TO PRT.
 19855
 19856 8900-PRINT-A-LINE.
*19857                             COPY ELCPRT2.
 19858******************************************************************04/15/98
 19859*                                                                *ELCPRT2
 19860*                                                                *ELCPRT2
 19861*                            ELCPRT2                             *   LV005
 19862*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**5
 19863*                            VMOD=2.002                          *   CL**5
 19864*                                                                *   CL**4
 19865******************************************************************   CL**4
 19866                                                                     CL**4
 19867     IF DTE-FICH NOT = SPACE AND                                     CL**4
 19868        FICH-OPEN    = SPACE                                         CL**4
 19869         MOVE 'X'                TO  FICH-OPEN                       CL**4
 19870         OPEN OUTPUT FICH.                                           CL**4
 19871                                                                     CL**4
 19872     IF DTE-FICH NOT = SPACE                                         CL**4
 19873         MOVE X                  TO  P-CTL                           CL**4
 19874         WRITE FICH-REC FROM PRT.                                    CL**4
 19875                                                                     CL**4
 19876     IF DTE-FICH = SPACE OR '2'                                      CL**4
 19877       MOVE X                    TO  P-CTL                           CL**4
 19878       IF P-CTL = ' '                                                CL**4
 19879         WRITE PRT AFTER ADVANCING 1 LINE                            CL**4
 19880       ELSE                                                          CL**4
 19881         IF P-CTL = '0'                                              CL**4
 19882           WRITE PRT AFTER ADVANCING 2 LINES                         CL**4
 19883         ELSE                                                        CL**4
 19884           IF P-CTL = '-'                                            CL**4
 19885             WRITE PRT AFTER ADVANCING 3 LINES                       CL**4
 19886           ELSE                                                      CL**4
 19887             WRITE PRT AFTER ADVANCING PAGE.                         CL**4
 19888                                                                     CL**4
 19889******************************************************************   CL**4
 19890
 19891 8999-PRT-LINE-X.
 19892     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 392
* ECS010Z.cbl
 19894******************************************************************
 19895***          E N D   O F   J O B   P R O C E S S I N G         ***
 19896******************************************************************
 19897
 19898 9910-EOJ-1.
 19899     IF TR-CNT = ZERO
 19900         IF (DTE-PGM-OPT = '2' OR '3') OR
 19901            (DTE-CLIENT = 'LGX' OR 'FNA' OR 'HER' OR 'NCL' OR
 19902                          'ITY' OR 'DAC' OR 'FLC')
 19903             NEXT SENTENCE
 19904         ELSE
 19905             MOVE 'NO INPUT TRANSACTIONS' TO WS-ABEND-MESSAGE
 19906             MOVE 0703                    TO WS-ABEND-CODE
 19907             DISPLAY '******************************'
 19908             DISPLAY '***** ERROR LOCATION 025 *****'
 19909             DISPLAY '******************************'
 19910             MOVE WS-ABEND-CODE           TO WS-RETURN-CODE
 19911             GO TO ABEND-PGM.
 19912
 19913     MOVE '*'         TO TRANS-EOF-FLAG.
 19914     MOVE HIGH-VALUES TO PENDING-MATCH-CONTROL.
 19915
 19916     IF EOF-ON-CERT
 19917         PERFORM 0400-WRITE-CERT-RECORD THRU 0499-WRITE-CERT-X
 19918         GO TO 9940-EOJ-FIN.
 19919
 19920     GO TO 0330-MATCH-PENDING-TO-CERT.
 19921
 19922 9920-EOJ-2.
 19923     MOVE '*'         TO CERT-EOF-FLAG.
 19924     MOVE HIGH-VALUES TO CIR-CONTROL.
 19925
 19926     IF EOF-ON-TRANS
 19927         PERFORM 0400-WRITE-CERT-RECORD THRU 0499-WRITE-CERT-X
 19928         MOVE HIGH-VALUES TO CERTIFICATE-RECORD
 19929         GO TO 9940-EOJ-FIN.
 19930
 19931     GO TO 0299-READ-CERT-X.
 19932
 19933 9930-EOJ-3.
 19934     IF PROCESSING-COMPLETED
 19935         GO TO 9950-EOJ-FIN-GO.
 19936
 19937     DISPLAY 'MISSING ACCOUNT MASTER - '  CR-ACCT-CONTROL.
 19938     MOVE 'MISSING ACCOUNT MASTER'
 19939                               TO WS-ABEND-MESSAGE.
 19940     MOVE 0302                 TO WS-ABEND-CODE.
 19941     DISPLAY '******************************'
 19942     DISPLAY '***** ERROR LOCATION 026 *****'
 19943     DISPLAY '******************************'
 19944     MOVE WS-ABEND-CODE        TO WS-RETURN-CODE.
 19945     GO TO ABEND-PGM.
 19946
 19947 9940-EOJ-FIN.
 19948     MOVE '*'        TO PROCESSING-FLAG.
 19949     MOVE LOW-VALUES TO CERTIFICATE-RECORD.
 19950
 19951     PERFORM 0100-ACCT-MASTER-READ-ROUTINE THRU
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 393
* ECS010Z.cbl
 19952             0199-READ-ACCOUNT-X.
 19953     GO TO 9940-EOJ-FIN.
 19954
 19955 9950-EOJ-FIN-GO.
 19956     PERFORM 5500-FINAL-BREAK THRU 5599-FINAL-BREAK-X.
 19957     MOVE HIGH-VALUES TO ACCOUNT-MASTER.
 19958*
 19959*
 19960* LEAVE THE ABOVE 2 LINE IN TO PREVENT LOSING THE LINE ABOVE
 19961     PERFORM 7000-CLIENT-BILLING-ROUTINE THRU 7099-BILL-X.
 19962
 19963 9960-NO-TOTS.
 19964
 19965     MOVE +15                    TO LN-CNT.
 19966     MOVE CMIN-CNT               TO TTL-PT-CNT.
 19967     IF ME-DO-UPDATE
 19968         MOVE CMIN-CNT           TO ME-010-CERT-IN.
 19969
 19970     MOVE 'INPUT CERTIFICATE MASTER RECORDS' TO TTL-HD-DS.
 19971     MOVE TR-TTL-HD              TO PRT.
 19972     PERFORM 8800-PRINT-ROUTINE.
 19973     ADD +1 TO LN-CNT.
 19974     MOVE TR-CNT                TO TTL-PT-CNT.
 19975     MOVE 'TRANSACTION RECORDS' TO TTL-HD-DS.
 19976     MOVE TR-TTL-HD             TO PRT.
 19977     PERFORM 8800-PRINT-ROUTINE.
 19978     ADD +1 TO LN-CNT.
 19979
 19980     IF DUP-CNT = ZERO
 19981         GO TO 9969-CHECK-MISMATCHED-TOTS.
 19982
 19983     MOVE DUP-CNT                 TO TTL-PT-CNT.
 19984
 19985     IF ME-DO-UPDATE
 19986         MOVE DUP-CNT            TO ME-010-DUP-ISS.
 19987
 19988     MOVE 'DUPE ISSUES DROPPED  ' TO TTL-HD-DS.
 19989     MOVE TR-TTL-HD               TO PRT.
 19990     PERFORM 8800-PRINT-ROUTINE.
 19991     PERFORM 8800-PRINT-ROUTINE.
 19992     ADD +1 TO LN-CNT.
 19993
 19994     MOVE '1'                           TO  DTL-REC-TYPE.
 19995     MOVE 'ISS'                         TO  DTL-REC-TYPE-DESC.
 19996     MOVE SPACES                        TO  DTL-CERT-IN-CONTROL.
 19997     MOVE 'DUPLICATE CERTIFICATE RECORD WILL BE'
 19998                                        TO  DTL-CERT-OUT-CONTROL.
 19999     MOVE SPACES                        TO  MISMATCH-DETAIL-2.
 20000     MOVE ' LIFE PREMIUM = '            TO  MD2-LF-PREM-DESC.
 20001     MOVE ' A&H  PREMIUM = '            TO  MD2-LF-ALT-PREM-DESC.
 20002
 20003     MOVE +1 TO SUB3.
 20004 9965-PRT-DUPES.
 20005
 20006     IF  MISMATCH-LINE-COUNT GREATER THAN +56
 20007         ADD +1                  TO  MISMATCH-PAGE-NUMBER
 20008         MOVE MISMATCH-PAGE-NUMBER
 20009                                 TO  TR-PG
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 394
* ECS010Z.cbl
 20010         MOVE MISMATCH-HEADING-1 TO  MISMATCH-RPT
 20011         MOVE MR-CTL             TO  X
 20012         MOVE X TO LCP-ASA
 20013         PERFORM LCP-WRITE-POS-MISMATCH-RPT
 20014             THRU LCP-WRITE-END-MISMATCH-RPT
 20015         MOVE TR-HD-2            TO  MISMATCH-RPT
 20016         MOVE MR-CTL             TO  X
 20017         MOVE X TO LCP-ASA
 20018         PERFORM LCP-WRITE-POS-MISMATCH-RPT
 20019             THRU LCP-WRITE-END-MISMATCH-RPT
 20020         MOVE TR-HD-3            TO  MISMATCH-RPT
 20021         MOVE MR-CTL             TO  X
 20022         MOVE X TO LCP-ASA
 20023         PERFORM LCP-WRITE-POS-MISMATCH-RPT
 20024             THRU LCP-WRITE-END-MISMATCH-RPT
 20025         MOVE MISMATCH-HEADING-2 TO  MISMATCH-RPT
 20026         MOVE MR-CTL             TO  X
 20027         MOVE X TO LCP-ASA
 20028         PERFORM LCP-WRITE-POS-MISMATCH-RPT
 20029             THRU LCP-WRITE-END-MISMATCH-RPT
 20030         MOVE +6                 TO  MISMATCH-LINE-COUNT.
 20031
 20032     MOVE DUPE-ENTRY (SUB3)             TO  DTL-MATCH-CONTROL.
 20033
 20034     MOVE MISMATCH-DETAIL               TO  MISMATCH-RPT.
 20035     MOVE MR-CTL                        TO  X.
 20036     ADD +2                             TO  MISMATCH-LINE-COUNT.
 20037
 20038     MOVE X TO LCP-ASA
 20039     PERFORM LCP-WRITE-POS-MISMATCH-RPT
 20040         THRU LCP-WRITE-END-MISMATCH-RPT.
 20041
 20042     MOVE  DUPE-LF-PRM (SUB3)           TO  MD2-LF-PREM.
 20043     MOVE  DUPE-AH-PRM (SUB3)           TO  MD2-LF-ALT-PREM.
 20044
 20045     ADD  DUPE-LF-PRM (SUB3)            TO  W-MM-LF-PRM.
 20046     ADD  DUPE-AH-PRM (SUB3)            TO  W-MM-AH-PRM.
 20047
 20048     MOVE DUPE-STATUS (SUB3)            TO  MD2-AH-PREM-DESC.
 20049     IF  DUPE-STATUS (SUB3)  =  '2'
 20050         MOVE  'POLICY IS PENDING '     TO  MD2-AH-PREM-DESC.
 20051     IF  DUPE-STATUS (SUB3)  =  '5'
 20052         MOVE  'POLICY IS REISSUE '     TO  MD2-AH-PREM-DESC.
 20053     IF  DUPE-STATUS (SUB3)  =  'M'
 20054         MOVE  'POLICY IS MONTHLY '     TO  MD2-AH-PREM-DESC.
 20055     IF  DUPE-STATUS (SUB3)  =  '9'
 20056         MOVE  'POLICY REIN ONLY  '     TO  MD2-AH-PREM-DESC.
 20057     IF  DUPE-STATUS (SUB3)  =  'D'
 20058         MOVE  'POLICY IS DECLINED'     TO  MD2-AH-PREM-DESC.
 20059     IF  DUPE-STATUS (SUB3)  =  'V'
 20060         MOVE  'POLICY IS VOIDED  '     TO  MD2-AH-PREM-DESC.
 20061     IF  DUPE-STATUS (SUB3)  =  'P'
 20062         MOVE  'POLICY PREM ACCTNG'     TO  MD2-AH-PREM-DESC.
 20063
 20064     MOVE MISMATCH-DETAIL-2             TO  MISMATCH-RPT.
 20065     MOVE MR-CTL                        TO  X.
 20066     ADD +1                             TO  MISMATCH-LINE-COUNT.
 20067
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 395
* ECS010Z.cbl
 20068     MOVE X TO LCP-ASA
 20069     PERFORM LCP-WRITE-POS-MISMATCH-RPT
 20070         THRU LCP-WRITE-END-MISMATCH-RPT.
 20071
 20072     IF SUB3 LESS THAN DUP-CNT
 20073         ADD +1 TO SUB3
 20074         GO TO 9965-PRT-DUPES.
 20075
 20076 9969-CHECK-MISMATCHED-TOTS.
 20077
 20078     IF W-MM-LF-PRM = ZEROS  AND
 20079        W-MM-AH-PRM = ZEROS  AND
 20080        W-MM-LF-RFD = ZEROS  AND
 20081        W-MM-AH-RFD = ZEROS  AND
 20082        W-MM-LF-CLM = ZEROS  AND
 20083        W-MM-AH-CLM = ZEROS
 20084         GO TO 9970-FIN-TOTS.
 20085
 20086     MOVE SPACES                        TO  MISMATCH-RPT.
 20087     MOVE '0'                           TO  MR-CTL  X.
 20088     MOVE X TO LCP-ASA
 20089     PERFORM LCP-WRITE-POS-MISMATCH-RPT
 20090         THRU LCP-WRITE-END-MISMATCH-RPT.
 20091
 20092     MOVE 'TOT LF PREMS  = '            TO  MD2-LF-PREM-DESC.
 20093     MOVE 'TOT AH PREMS  = '            TO  MD2-LF-ALT-PREM-DESC.
 20094     MOVE ' TOTAL PREMIUMS = '          TO  MD2-AH-PREM-DESC.
 20095
 20096     MOVE W-MM-LF-PRM                   TO MD2-LF-PREM.
 20097     MOVE W-MM-AH-PRM                   TO MD2-LF-ALT-PREM.
 20098     COMPUTE MD2-AH-PREM = W-MM-LF-PRM + W-MM-AH-PRM.
 20099
 20100     MOVE MISMATCH-DETAIL-2             TO  MISMATCH-RPT.
 20101     MOVE '0'                           TO  MR-CTL  X.
 20102     MOVE X TO LCP-ASA
 20103     PERFORM LCP-WRITE-POS-MISMATCH-RPT
 20104         THRU LCP-WRITE-END-MISMATCH-RPT.
 20105
 20106     MOVE 'TOT LF RFNDS  = '            TO  MD2-LF-PREM-DESC.
 20107     MOVE 'TOT AH RFNDS  = '            TO  MD2-LF-ALT-PREM-DESC.
 20108     MOVE ' TOTAL REFUNDS  = '          TO  MD2-AH-PREM-DESC.
 20109
 20110     MOVE W-MM-LF-RFD                   TO MD2-LF-PREM.
 20111     MOVE W-MM-AH-RFD                   TO MD2-LF-ALT-PREM.
 20112     COMPUTE MD2-AH-PREM = W-MM-LF-RFD + W-MM-AH-RFD.
 20113
 20114     MOVE MISMATCH-DETAIL-2             TO  MISMATCH-RPT.
 20115     MOVE '0'                           TO  MR-CTL  X.
 20116     MOVE X TO LCP-ASA
 20117     PERFORM LCP-WRITE-POS-MISMATCH-RPT
 20118         THRU LCP-WRITE-END-MISMATCH-RPT.
 20119
 20120     MOVE 'TOT LF CLAIMS = '            TO  MD2-LF-PREM-DESC.
 20121     MOVE 'TOT AH CLAIMS = '            TO  MD2-LF-ALT-PREM-DESC.
 20122     MOVE ' TOTAL CLAIMS   = '          TO  MD2-AH-PREM-DESC.
 20123
 20124     MOVE W-MM-LF-CLM                   TO MD2-LF-PREM.
 20125     MOVE W-MM-AH-CLM                   TO MD2-LF-ALT-PREM.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 396
* ECS010Z.cbl
 20126     COMPUTE MD2-AH-PREM = W-MM-LF-CLM + W-MM-AH-CLM.
 20127
 20128     MOVE MISMATCH-DETAIL-2             TO  MISMATCH-RPT.
 20129     MOVE '0'                           TO  MR-CTL  X.
 20130     MOVE X TO LCP-ASA
 20131     PERFORM LCP-WRITE-POS-MISMATCH-RPT
 20132         THRU LCP-WRITE-END-MISMATCH-RPT.
 20133
 20134 9970-FIN-TOTS.
 20135
 20136     MOVE CMOT-CNT                TO TTL-PT-CNT.
 20137
 20138     IF ME-DO-UPDATE
 20139         MOVE CMOT-CNT           TO ME-010-CERT-OUT.
 20140
 20141     MOVE 'OUTPUT CERTIFICATE MASTER RECORDS' TO TTL-HD-DS.
 20142     MOVE TR-TTL-HD               TO PRT.
 20143     PERFORM 8800-PRINT-ROUTINE.
 20144
 20145     MOVE DE-CNT                  TO TTL-PT-CNT.
 20146     MOVE 'DETAIL EXTRACT RECORDS' TO TTL-HD-DS.
 20147     MOVE TR-TTL-HD               TO PRT.
 20148     PERFORM 8800-PRINT-ROUTINE.
 20149
 20150     MOVE EP-CNT                  TO TTL-PT-CNT.
 20151     MOVE 'SUMMARY EXTRACTS RECORDS' TO TTL-HD-DS.
 20152     MOVE TR-TTL-HD               TO PRT.
 20153     PERFORM 8800-PRINT-ROUTINE.
 20154     PERFORM 8800-PRINT-ROUTINE.
 20155
 20156     MOVE ERACCTT-READS           TO TTL-PT-CNT.
 20157     MOVE 'VSAM ACCOUNT MASTER FILE READS' TO TTL-HD-DS.
 20158     MOVE TR-TTL-HD               TO PRT.
 20159     PERFORM 8800-PRINT-ROUTINE.
 20160
 20161     MOVE ERRTBL-READS            TO TTL-PT-CNT.
 20162     MOVE 'VSAM REINSURANCE TABLE FILE READS' TO TTL-HD-DS.
 20163     MOVE TR-TTL-HD               TO PRT.
 20164     PERFORM 8800-PRINT-ROUTINE.
 20165
 20166     MOVE ERCTBL-READS            TO TTL-PT-CNT.
 20167     MOVE 'VSAM COMMISSION TABLE FILE READS' TO TTL-HD-DS.
 20168     MOVE TR-TTL-HD               TO PRT.
 20169     PERFORM 8800-PRINT-ROUTINE.
 20170
 20171     IF  DTE-OPT-RESERVE-METHOD-UNAUTH
 20172         GO TO 9990-FINAL-CLOSE.
 20173
 20174**** MOST OF THE LINES WRITTEN BELOW ARE USED TO VERIFY
 20175**** REPORT TOTALS, ETC, THAT CANNOT BE VERIFIED ANY OTHER
 20176**** WAY.  MOST OF THESE FIELDS WILL BE DELETED WHEN ALL
 20177**** PILOT COMPANIES HAVE BEEN SUCCESSFULLY PROCESSED.
 20178
 20179     MOVE W-POLICY-ACTIVE-CTR     TO TTL-PT-CNT.
 20180     MOVE 'ACTIVE POLICIES'       TO TTL-HD-DS.
 20181     MOVE TR-TTL-HD               TO PRT.
 20182     PERFORM 8800-PRINT-ROUTINE.
 20183
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 397
* ECS010Z.cbl
 20184     MOVE W-POLICY-INACTIVE-CTR   TO TTL-PT-CNT.
 20185     MOVE 'INACTIVE POLICIES'     TO TTL-HD-DS.
 20186     MOVE TR-TTL-HD               TO PRT.
 20187     PERFORM 8800-PRINT-ROUTINE.
 20188
 20189     MOVE W-POLICY-REISSUE-CTR    TO TTL-PT-CNT.
 20190     MOVE 'REISSUE POLICIES'      TO TTL-HD-DS.
 20191     MOVE TR-TTL-HD               TO PRT.
 20192     PERFORM 8800-PRINT-ROUTINE.
 20193
 20194     MOVE W-POLICY-REIN-CTR       TO TTL-PT-CNT.
 20195     MOVE 'REINSURANCE ONLY POLICIES' TO TTL-HD-DS.
 20196     MOVE TR-TTL-HD               TO PRT.
 20197     PERFORM 8800-PRINT-ROUTINE.
 20198
 20199     MOVE W-POL-ISSUES            TO TTL-PT-CNT.
 20200     MOVE 'ISSUE TRANSACTIONS'    TO TTL-HD-DS.
 20201     MOVE TR-TTL-HD               TO PRT.
 20202     PERFORM 8800-PRINT-ROUTINE.
 20203
 20204     MOVE W-AH-ISSUES             TO TTL-PT-CNT.
 20205     MOVE 'AH ISSUE TRANSACTIONS' TO TTL-HD-DS.
 20206     MOVE TR-TTL-HD               TO PRT.
 20207     PERFORM 8800-PRINT-ROUTINE.
 20208
 20209     MOVE W-LF-ISSUES             TO TTL-PT-CNT.
 20210     MOVE 'LF ISSUE TRANSACTIONS' TO TTL-HD-DS.
 20211     MOVE TR-TTL-HD               TO PRT.
 20212     PERFORM 8800-PRINT-ROUTINE.
 20213
 20214     MOVE W-PENDING-CLMS          TO TTL-PT-CNT.
 20215     MOVE 'CLAIM TRANSACTIONS'    TO TTL-HD-DS.
 20216     MOVE TR-TTL-HD               TO PRT.
 20217     PERFORM 8800-PRINT-ROUTINE.
 20218
 20219     MOVE W-AH-CLAIMS             TO TTL-PT-CNT.
 20220     MOVE 'AH CLAIMS TRANSACTIONS' TO TTL-HD-DS.
 20221     MOVE TR-TTL-HD               TO PRT.
 20222     PERFORM 8800-PRINT-ROUTINE.
 20223
 20224     MOVE W-LF-CLAIMS             TO TTL-PT-CNT.
 20225     MOVE 'LF CLAIMS TRANSACTIONS' TO TTL-HD-DS.
 20226     MOVE TR-TTL-HD               TO PRT.
 20227     PERFORM 8800-PRINT-ROUTINE.
 20228
 20229     MOVE W-AH-RESERVES           TO TTL-PT-CNT.
 20230     MOVE 'AH RESERVES TRANSACTIONS' TO TTL-HD-DS.
 20231     MOVE TR-TTL-HD               TO PRT.
 20232     PERFORM 8800-PRINT-ROUTINE.
 20233
 20234     MOVE W-LF-RESERVES           TO TTL-PT-CNT.
 20235     MOVE 'LF RESERVES TRANSACTIONS' TO TTL-HD-DS.
 20236     MOVE TR-TTL-HD               TO PRT.
 20237     PERFORM 8800-PRINT-ROUTINE.
 20238
 20239     MOVE W-AH-ACTIVE             TO TTL-PT-CNT.
 20240     MOVE 'AH RECORDS ACTIVE '    TO TTL-HD-DS.
 20241     MOVE TR-TTL-HD               TO PRT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 398
* ECS010Z.cbl
 20242     PERFORM 8800-PRINT-ROUTINE.
 20243
 20244     MOVE W-AH-INACTIVE           TO TTL-PT-CNT.
 20245     MOVE 'AH RECORDS INACTIVE'   TO TTL-HD-DS.
 20246     MOVE TR-TTL-HD               TO PRT.
 20247     PERFORM 8800-PRINT-ROUTINE.
 20248
 20249     MOVE W-AH-REISSUE            TO TTL-PT-CNT.
 20250     MOVE 'AH REISSUE REJECTS'    TO TTL-HD-DS.
 20251     MOVE TR-TTL-HD               TO PRT.
 20252     PERFORM 8800-PRINT-ROUTINE.
 20253
 20254     MOVE W-AH-REIN               TO TTL-PT-CNT.
 20255     MOVE 'AH REIN ONLY      '    TO TTL-HD-DS.
 20256     MOVE TR-TTL-HD               TO PRT.
 20257     PERFORM 8800-PRINT-ROUTINE.
 20258
 20259     MOVE W-AH-CALC-B             TO TTL-PT-CNT.
 20260     MOVE 'AH CALC B REJECTS'     TO TTL-HD-DS.
 20261     MOVE TR-TTL-HD               TO PRT.
 20262     PERFORM 8800-PRINT-ROUTINE.
 20263
 20264     MOVE W-AHTYP-99              TO TTL-PT-CNT.
 20265     MOVE 'AH TYPE CHANGED TO 99' TO TTL-HD-DS.
 20266     MOVE TR-TTL-HD               TO PRT.
 20267     PERFORM 8800-PRINT-ROUTINE.
 20268
 20269     MOVE W-ORGTRM-0-AH           TO TTL-PT-CNT.
 20270     MOVE 'AH ORIGINAL TERM = 0 ' TO TTL-HD-DS.
 20271     MOVE TR-TTL-HD               TO PRT.
 20272     PERFORM 8800-PRINT-ROUTINE.
 20273
 20274     MOVE W-RET-CODE-AH           TO TTL-PT-CNT.
 20275     MOVE 'AH RET CODE TERM = 0 ' TO TTL-HD-DS.
 20276     MOVE TR-TTL-HD               TO PRT.
 20277     PERFORM 8800-PRINT-ROUTINE.
 20278
 20279     MOVE W-AH-REMTERM-0          TO TTL-PT-CNT.
 20280     MOVE 'AH REMAINING TERM = 0' TO TTL-HD-DS.
 20281     MOVE TR-TTL-HD               TO PRT.
 20282     PERFORM 8800-PRINT-ROUTINE.
 20283
 20284     MOVE W-AH-DATA-USED          TO TTL-PT-CNT.
 20285     MOVE 'AH RECORDS ACCEPTED DURING PROCESSING' TO TTL-HD-DS.
 20286     MOVE TR-TTL-HD               TO PRT.
 20287     PERFORM 8800-PRINT-ROUTINE.
 20288
 20289     MOVE W-LF-ACTIVE             TO TTL-PT-CNT.
 20290     MOVE 'LF RECORDS ACTIVE '    TO TTL-HD-DS.
 20291     MOVE TR-TTL-HD               TO PRT.
 20292     PERFORM 8800-PRINT-ROUTINE.
 20293
 20294     MOVE W-LF-INACTIVE           TO TTL-PT-CNT.
 20295     MOVE 'LF RECORDS INACTIVE'   TO TTL-HD-DS.
 20296     MOVE TR-TTL-HD               TO PRT.
 20297     PERFORM 8800-PRINT-ROUTINE.
 20298
 20299     MOVE W-LF-BALLOON            TO TTL-PT-CNT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 399
* ECS010Z.cbl
 20300     MOVE 'LF BALLOON REJECTS'    TO TTL-HD-DS.
 20301     MOVE TR-TTL-HD               TO PRT.
 20302     PERFORM 8800-PRINT-ROUTINE.
 20303
 20304     MOVE W-LF-REISSUE            TO TTL-PT-CNT.
 20305     MOVE 'LF REISSUE REJECTS'    TO TTL-HD-DS.
 20306     MOVE TR-TTL-HD               TO PRT.
 20307     PERFORM 8800-PRINT-ROUTINE.
 20308
 20309     MOVE W-LF-REIN               TO TTL-PT-CNT.
 20310     MOVE 'LF REIN ONLY      '    TO TTL-HD-DS.
 20311     MOVE TR-TTL-HD               TO PRT.
 20312     PERFORM 8800-PRINT-ROUTINE.
 20313
 20314     MOVE W-LF-CALC-B             TO TTL-PT-CNT.
 20315     MOVE 'LF CALC B REJECTS'     TO TTL-HD-DS.
 20316     MOVE TR-TTL-HD               TO PRT.
 20317     PERFORM 8800-PRINT-ROUTINE.
 20318
 20319     MOVE W-ORGTRM-0-LF           TO TTL-PT-CNT.
 20320     MOVE 'LF ORIGINAL TERM = 0 ' TO TTL-HD-DS.
 20321     MOVE TR-TTL-HD               TO PRT.
 20322     PERFORM 8800-PRINT-ROUTINE.
 20323
 20324     MOVE W-RET-CODE-LF           TO TTL-PT-CNT.
 20325     MOVE 'LF RET CODE TERM = 0 ' TO TTL-HD-DS.
 20326     MOVE TR-TTL-HD               TO PRT.
 20327     PERFORM 8800-PRINT-ROUTINE.
 20328
 20329     MOVE W-LF-REMTERM-0          TO TTL-PT-CNT.
 20330     MOVE 'LF REMTERM = 0 REJECTS' TO TTL-HD-DS.
 20331     MOVE TR-TTL-HD               TO PRT.
 20332     PERFORM 8800-PRINT-ROUTINE.
 20333
 20334     MOVE W-LF-REMAMT-0           TO TTL-PT-CNT.
 20335     MOVE 'LF REMAMT = 0 REJECTS' TO TTL-HD-DS.
 20336     MOVE TR-TTL-HD               TO PRT.
 20337     PERFORM 8800-PRINT-ROUTINE.
 20338
 20339     MOVE W-LFTYP-99              TO TTL-PT-CNT.
 20340     MOVE 'LF TYPE CHANGED TO 99' TO TTL-HD-DS.
 20341     MOVE TR-TTL-HD               TO PRT.
 20342     PERFORM 8800-PRINT-ROUTINE.
 20343
 20344     MOVE W-LF-DATA-USED          TO TTL-PT-CNT.
 20345     MOVE 'LF RECORDS ACCEPTED DURING PROCESSING' TO TTL-HD-DS.
 20346     MOVE TR-TTL-HD               TO PRT.
 20347     PERFORM 8800-PRINT-ROUTINE.
 20348
 20349     MOVE W-EPEC-EP-IN            TO TTL-PT-CNT.
 20350     MOVE 'AH EARNED PREMIUM LAST 90 DAYS - DET ' TO TTL-HD-DS.
 20351     MOVE TR-TTL-HD               TO PRT.
 20352     PERFORM 8800-PRINT-ROUTINE.
 20353
 20354     MOVE W-EPEC-EP               TO TTL-PT-CNT.
 20355     MOVE 'AH EARNED PREMIUM LAST 90 DAYS       ' TO TTL-HD-DS.
 20356     MOVE TR-TTL-HD               TO PRT.
 20357     PERFORM 8800-PRINT-ROUTINE.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 400
* ECS010Z.cbl
 20358
 20359     MOVE W-EPEC-EP-2             TO TTL-PT-CNT.
 20360     MOVE 'AH EARNED PREMIUM 90 DAYS AGO        ' TO TTL-HD-DS.
 20361     MOVE TR-TTL-HD               TO PRT.
 20362     PERFORM 8800-PRINT-ROUTINE.
 20363
 20364     MOVE W-EP-LESS-THAN-0        TO TTL-PT-CNT.
 20365     MOVE 'AH RECORDS WITH 90 DAY EP < +0       ' TO TTL-HD-DS.
 20366     MOVE TR-TTL-HD               TO PRT.
 20367     PERFORM 8800-PRINT-ROUTINE.
 20368
 20369     MOVE W-EPEC-EP-1             TO TTL-PT-CNT.
 20370     MOVE 'AH EARNED PREMIUM TODAY              ' TO TTL-HD-DS.
 20371     MOVE TR-TTL-HD               TO PRT.
 20372     PERFORM 8800-PRINT-ROUTINE.
 20373
 20374     MOVE W-AH-CLAIM-CTR          TO TTL-PT-CNT.
 20375     MOVE 'AH COVERAGES WITH QUALIFIED CLAIMS'
 20376                                  TO TTL-HD-DS.
 20377     MOVE TR-TTL-HD               TO PRT.
 20378     PERFORM 8800-PRINT-ROUTINE.
 20379
 20380     MOVE W-AH-CLAIM-EP           TO TTL-PT-CNT.
 20381     MOVE 'AH EARNED PREM WITH QUALIFIED CLAIMS'
 20382                                  TO TTL-HD-DS.
 20383     MOVE TR-TTL-HD               TO PRT.
 20384     PERFORM 8800-PRINT-ROUTINE.
 20385
 20386     MOVE W-CLAIMS-MADE-PAID-IN   TO TTL-PT-CNT.
 20387     MOVE 'AH CLAIMS MADE AND PAID LAST 90 DAYS- DET'
 20388                                  TO TTL-HD-DS.
 20389     MOVE TR-TTL-HD               TO PRT.
 20390     PERFORM 8800-PRINT-ROUTINE.
 20391
 20392     MOVE W-CLAIMS-MADE-PAID      TO TTL-PT-CNT.
 20393     MOVE 'AH CLAIMS MADE AND PAID LAST 90 DAYS'
 20394                                  TO TTL-HD-DS.
 20395     MOVE TR-TTL-HD               TO PRT.
 20396     PERFORM 8800-PRINT-ROUTINE.
 20397
 20398     MOVE W-CLM-EXCEPT-CNT        TO TTL-PT-CNT.
 20399     MOVE 'AH CLAIMS CALCD. USING ITD AMOUNT'
 20400                                  TO TTL-HD-DS.
 20401     MOVE TR-TTL-HD               TO PRT.
 20402     PERFORM 8800-PRINT-ROUTINE.
 20403
 20404     MOVE W-CLM-EXCEPT-AMT        TO TTL-PT-CNT.
 20405     MOVE 'AH CLAIMS AMT USING ITD AMOUNT'
 20406                                  TO TTL-HD-DS.
 20407     MOVE TR-TTL-HD               TO PRT.
 20408     PERFORM 8800-PRINT-ROUTINE.
 20409
 20410     MOVE W-AH-IBNR-1             TO TTL-PT-CNT.
 20411     MOVE 'A&H IBNR-1'            TO TTL-HD-DS.
 20412     MOVE TR-TTL-HD               TO PRT.
 20413     PERFORM 8800-PRINT-ROUTINE.
 20414
 20415     MOVE W-AH-IBNR-2             TO TTL-PT-CNT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 401
* ECS010Z.cbl
 20416     MOVE 'A&H IBNR-2'            TO TTL-HD-DS.
 20417     MOVE TR-TTL-HD               TO PRT.
 20418     PERFORM 8800-PRINT-ROUTINE.
 20419
 20420     MOVE W-LIFE-IBNR-IN          TO TTL-PT-CNT.
 20421     MOVE 'LIFE IBNR - DETAIL'    TO TTL-HD-DS.
 20422     MOVE TR-TTL-HD               TO PRT.
 20423     PERFORM 8800-PRINT-ROUTINE.
 20424
 20425     MOVE W-LIFE-IBNR             TO TTL-PT-CNT.
 20426     MOVE 'LIFE IBNR'             TO TTL-HD-DS.
 20427     MOVE TR-TTL-HD               TO PRT.
 20428     PERFORM 8800-PRINT-ROUTINE.
 20429
 20430     MOVE W-LIFE-REMAINING-AMT    TO TTL-PT-CNT.
 20431     MOVE 'LIFE REMAINING-AMT '   TO TTL-HD-DS.
 20432     MOVE TR-TTL-HD               TO PRT.
 20433     PERFORM 8800-PRINT-ROUTINE.
 20434
 20435     MOVE W-01-REMAMT             TO TTL-PT-CNT.
 20436     MOVE '01 REMAINING-AMT '     TO TTL-HD-DS.
 20437     MOVE TR-TTL-HD               TO PRT.
 20438     PERFORM 8800-PRINT-ROUTINE.
 20439
 20440     MOVE W-01-DATA-USED          TO TTL-PT-CNT.
 20441     MOVE '01 CERT COUNT    '     TO TTL-HD-DS.
 20442     MOVE TR-TTL-HD               TO PRT.
 20443     PERFORM 8800-PRINT-ROUTINE.
 20444
 20445     MOVE W-02-REMAMT             TO TTL-PT-CNT.
 20446     MOVE '02 REMAINING-AMT '     TO TTL-HD-DS.
 20447     MOVE TR-TTL-HD               TO PRT.
 20448     PERFORM 8800-PRINT-ROUTINE.
 20449
 20450     MOVE W-02-DATA-USED          TO TTL-PT-CNT.
 20451     MOVE '02 CERT COUNT    '     TO TTL-HD-DS.
 20452     MOVE TR-TTL-HD               TO PRT.
 20453     PERFORM 8800-PRINT-ROUTINE.
 20454
 20455     MOVE W-03-REMAMT             TO TTL-PT-CNT.
 20456     MOVE '03 REMAINING-AMT '     TO TTL-HD-DS.
 20457     MOVE TR-TTL-HD               TO PRT.
 20458     PERFORM 8800-PRINT-ROUTINE.
 20459
 20460     MOVE W-03-DATA-USED          TO TTL-PT-CNT.
 20461     MOVE '03 CERT COUNT    '     TO TTL-HD-DS.
 20462     MOVE TR-TTL-HD               TO PRT.
 20463     PERFORM 8800-PRINT-ROUTINE.
 20464
 20465     MOVE W-04-REMAMT             TO TTL-PT-CNT.
 20466     MOVE '04 REMAINING-AMT '     TO TTL-HD-DS.
 20467     MOVE TR-TTL-HD               TO PRT.
 20468     PERFORM 8800-PRINT-ROUTINE.
 20469
 20470     MOVE W-04-DATA-USED          TO TTL-PT-CNT.
 20471     MOVE '04 CERT COUNT    '     TO TTL-HD-DS.
 20472     MOVE TR-TTL-HD               TO PRT.
 20473     PERFORM 8800-PRINT-ROUTINE.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 402
* ECS010Z.cbl
 20474
 20475     MOVE W-05-REMAMT             TO TTL-PT-CNT.
 20476     MOVE '05 REMAINING-AMT '     TO TTL-HD-DS.
 20477     MOVE TR-TTL-HD               TO PRT.
 20478     PERFORM 8800-PRINT-ROUTINE.
 20479
 20480     MOVE W-05-DATA-USED          TO TTL-PT-CNT.
 20481     MOVE '05 CERT COUNT    '     TO TTL-HD-DS.
 20482     MOVE TR-TTL-HD               TO PRT.
 20483     PERFORM 8800-PRINT-ROUTINE.
 20484
 20485     MOVE W-06-REMAMT             TO TTL-PT-CNT.
 20486     MOVE '06 REMAINING-AMT '     TO TTL-HD-DS.
 20487     MOVE TR-TTL-HD               TO PRT.
 20488     PERFORM 8800-PRINT-ROUTINE.
 20489
 20490     MOVE W-06-DATA-USED          TO TTL-PT-CNT.
 20491     MOVE '06 CERT COUNT    '     TO TTL-HD-DS.
 20492     MOVE TR-TTL-HD               TO PRT.
 20493     PERFORM 8800-PRINT-ROUTINE.
 20494
 20495     MOVE W-30-REMAMT             TO TTL-PT-CNT.
 20496     MOVE '30 REMAINING-AMT '     TO TTL-HD-DS.
 20497     MOVE TR-TTL-HD               TO PRT.
 20498     PERFORM 8800-PRINT-ROUTINE.
 20499
 20500     MOVE W-30-DATA-USED          TO TTL-PT-CNT.
 20501     MOVE '30 CERT COUNT    '     TO TTL-HD-DS.
 20502     MOVE TR-TTL-HD               TO PRT.
 20503     PERFORM 8800-PRINT-ROUTINE.
 20504
 20505     MOVE W-31-REMAMT             TO TTL-PT-CNT.
 20506     MOVE '31 REMAINING-AMT '     TO TTL-HD-DS.
 20507     MOVE TR-TTL-HD               TO PRT.
 20508     PERFORM 8800-PRINT-ROUTINE.
 20509
 20510     MOVE W-31-DATA-USED          TO TTL-PT-CNT.
 20511     MOVE '31 CERT COUNT    '     TO TTL-HD-DS.
 20512     MOVE TR-TTL-HD               TO PRT.
 20513     PERFORM 8800-PRINT-ROUTINE.
 20514
 20515     MOVE W-XX-REMAMT             TO TTL-PT-CNT.
 20516     MOVE 'XX REMAINING-AMT '     TO TTL-HD-DS.
 20517     MOVE TR-TTL-HD               TO PRT.
 20518     PERFORM 8800-PRINT-ROUTINE.
 20519
 20520     MOVE W-XX-DATA-USED          TO TTL-PT-CNT.
 20521     MOVE 'XX CERT COUNT    '     TO TTL-HD-DS.
 20522     MOVE TR-TTL-HD               TO PRT.
 20523     PERFORM 8800-PRINT-ROUTINE.
 20524
 20525     MOVE W-1-EP                  TO TTL-PT-CNT.
 20526     MOVE 'TYPE 1 EP        '     TO TTL-HD-DS.
 20527     MOVE TR-TTL-HD               TO PRT.
 20528     PERFORM 8800-PRINT-ROUTINE.
 20529
 20530     MOVE W-P-EP                  TO TTL-PT-CNT.
 20531     MOVE 'TYPE P EP        '     TO TTL-HD-DS.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 403
* ECS010Z.cbl
 20532     MOVE TR-TTL-HD               TO PRT.
 20533     PERFORM 8800-PRINT-ROUTINE.
 20534
 20535     MOVE W-M-EP                  TO TTL-PT-CNT.
 20536     MOVE 'TYPE M EP        '     TO TTL-HD-DS.
 20537     MOVE TR-TTL-HD               TO PRT.
 20538     PERFORM 8800-PRINT-ROUTINE.
 20539
 20540     MOVE W-R-EP                  TO TTL-PT-CNT.
 20541     MOVE 'TYPE R EP        '     TO TTL-HD-DS.
 20542     MOVE TR-TTL-HD               TO PRT.
 20543     PERFORM 8800-PRINT-ROUTINE.
 20544
 20545     MOVE W-WY-EP                 TO TTL-PT-CNT.
 20546     MOVE 'EP FOR STATE WY  '     TO TTL-HD-DS.
 20547     MOVE TR-TTL-HD               TO PRT.
 20548     PERFORM 8800-PRINT-ROUTINE.
 20549
 20550     MOVE W-VA-EP                 TO TTL-PT-CNT.
 20551     MOVE 'EP FOR STATE VA  '     TO TTL-HD-DS.
 20552     MOVE TR-TTL-HD               TO PRT.
 20553     PERFORM 8800-PRINT-ROUTINE.
 20554
 20555     MOVE W-OTHERS-COUNT          TO TTL-PT-CNT.
 20556     MOVE 'AH COUNT OF OTHERS'    TO TTL-HD-DS.
 20557     MOVE TR-TTL-HD               TO PRT.
 20558     PERFORM 8800-PRINT-ROUTINE.
 20559
 20560     MOVE W-RTRM-0-CLMAMT         TO TTL-PT-CNT.
 20561     MOVE 'CLM AMT OF THOSE CERTS WITH RTRM=0'    TO TTL-HD-DS.
 20562     MOVE TR-TTL-HD               TO PRT.
 20563     PERFORM 8800-PRINT-ROUTINE.
 20564
 20565     MOVE W-RTRM-EP-1             TO TTL-PT-CNT.
 20566     MOVE 'EP1 OF THOSE CERTS WITH RTRM=0'    TO TTL-HD-DS.
 20567     MOVE TR-TTL-HD               TO PRT.
 20568     PERFORM 8800-PRINT-ROUTINE.
 20569
 20570     MOVE W-RTRM-EP-2             TO TTL-PT-CNT.
 20571     MOVE 'EP2 OF THOSE CERTS WITH RTRM=0'    TO TTL-HD-DS.
 20572     MOVE TR-TTL-HD               TO PRT.
 20573     PERFORM 8800-PRINT-ROUTINE.
 20574
 20575     MOVE W-RTRM-EP               TO TTL-PT-CNT.
 20576     MOVE 'EP OF THOSE CERTS WITH RTRM=0'    TO TTL-HD-DS.
 20577     MOVE TR-TTL-HD               TO PRT.
 20578     PERFORM 8800-PRINT-ROUTINE.
 20579
 20580     MOVE W-AH-IBNR-1             TO TTL-PT-CNT.
 20581     MOVE 'IBNR1 FROM EQUATION 1' TO TTL-HD-DS.
 20582     MOVE TR-TTL-HD               TO PRT.
 20583     PERFORM 8800-PRINT-ROUTINE.
 20584
 20585     MOVE W-AH-IBNR-1-CNT         TO TTL-PT-CNT.
 20586     MOVE 'REC CNT FROM EQUATION 1' TO TTL-HD-DS.
 20587     MOVE TR-TTL-HD               TO PRT.
 20588     PERFORM 8800-PRINT-ROUTINE.
 20589
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 404
* ECS010Z.cbl
 20590     MOVE W-AH-IBNR-2             TO TTL-PT-CNT.
 20591     MOVE 'IBNR2 FROM EQUATION 2' TO TTL-HD-DS.
 20592     MOVE TR-TTL-HD               TO PRT.
 20593     PERFORM 8800-PRINT-ROUTINE.
 20594
 20595     MOVE W-AH-IBNR-2-CNT         TO TTL-PT-CNT.
 20596     MOVE 'REC CNT FROM EQUATION 2' TO TTL-HD-DS.
 20597     MOVE TR-TTL-HD               TO PRT.
 20598     PERFORM 8800-PRINT-ROUTINE.
 20599
 20600 9990-FINAL-CLOSE.
*20601                             COPY ELCPRTC.
 20602******************************************************************04/15/98
 20603*                                                                *ELCPRTC
 20604*                                                                *ELCPRTC
 20605*                            ELCPRTC.                            *   LV003
 20606*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
 20607*                            VMOD=2.002                          *   CL**2
 20608*       CLOSE FICH FILE IF OPEN                                  *ELCPRTC
 20609*                                                                *ELCPRTC
 20610* NOTE- USE ELCPRTCX IF USING ELCPRT2X (ONLINE REPORT SAVE)      *   CL**2
 20611******************************************************************ELCPRTC
 20612                                                                  ELCPRTC
 20613      IF FICH-OPEN NOT = SPACE                                    ELCPRTC
 20614          CLOSE FICH.                                             ELCPRTC
 20615                                                                  ELCPRTC
 20616******************************************************************ELCPRTC
 20617
 20618     IF DTE-CLIENT = 'DMD'
 20619         CLOSE ERRESC-IN.
 20620
 20621     PERFORM 8600-DISPLAY-HD   THRU  8600-HD-EXIT.
 20622
 20623     DISPLAY ' '.
 20624     DISPLAY '* * * * * * * * * * * * * * * * * *'.
 20625     DISPLAY ' DISPLAY ERROR COUNT = '  ERROR-COUNT.
 20626     DISPLAY '* * * * * * * * * * * * * * * * * *'.
 20627     DISPLAY ' '.
 20628
 20629     MOVE    ' DISPLAY ERROR COUNT = '
 20630       TO  DIS-LINE-REASON.
 20631     MOVE  ERROR-COUNT
 20632       TO  DIS-LINE-REC.
 20633         PERFORM 8600-DISPLAY-PRT  THRU  8600-DISPLAY-EXIT.
 20634
 20635     CLOSE ERACCTT-IN  CERT-MASTER-IN  PRINT-COPY  MISMATCH-REPORT
 20636           DISPLAY-PRT
 20637           PENDING-EXTRACT  SUMMARY-EXTR.
 20638
 20639     IF DTE-PGM-OPT = '1' OR '2'
 20640         CLOSE CERT-MASTER-OUT
 20641               DETAIL-EXTR.
 20642
 20643     IF ERACCTT-FILE-STATUS NOT = '00'
 20644         MOVE '12'                TO ABEND-CODE-1
 20645         MOVE ERACCTT-FILE-STATUS TO ABEND-CODE-2
 20646         DISPLAY '******************************'
 20647         DISPLAY '***** ERROR LOCATION 027 *****'
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 405
* ECS010Z.cbl
 20648         DISPLAY '******************************'
 20649         MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
 20650           GO TO ABEND-PGM.
 20651
 20652     IF COMM-OPEN-SW = 'X'
 20653         CLOSE ERCTBL
 20654         IF ERCTBL-FILE-STATUS NOT = '00'
 20655             MOVE '42'               TO ABEND-CODE-1
 20656             MOVE ERCTBL-FILE-STATUS TO ABEND-CODE-2
 20657             DISPLAY '******************************'
 20658             DISPLAY '***** ERROR LOCATION 028 *****'
 20659             DISPLAY '******************************'
 20660             MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
 20661             GO TO ABEND-PGM.
 20662
 20663     IF REIN-OPEN-SW = 'X'
 20664         CLOSE ERRTBL-IN
 20665         IF ERRTBL-FILE-STATUS NOT = '00'
 20666             MOVE '22'               TO ABEND-CODE-1
 20667             MOVE ERRTBL-FILE-STATUS TO ABEND-CODE-2
 20668             DISPLAY '******************************'
 20669             DISPLAY '***** ERROR LOCATION 029 *****'
 20670             DISPLAY '******************************'
 20671             MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
 20672             GO TO ABEND-PGM.
 20673
 20674     MOVE 'C'                         TO CP-IO-FUNCTION.
 20675     PERFORM 8100-GET-RATE THRU 8199-GET-RATE-X.
 20676     IF IO-ERROR
 20677         MOVE 'ERROR OCCURED CLOSING - ELRATE'
 20678                                      TO WS-ABEND-MESSAGE
 20679         MOVE 0302                    TO WS-RETURN-CODE
 20680         DISPLAY '******************************'
 20681         DISPLAY '***** ERROR LOCATION 030 *****'
 20682         DISPLAY '******************************'
 20683         MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
 20684         GO TO ABEND-PGM.
 20685
 20686     IF ME-DO-UPDATE
 20687           MOVE ME-START-TIME        TO ME-010-START
*  12-S***************************************************             ( 270)**
**    Operand ME-010-START is not declared
 20688           MOVE ME-CNDS-DATE         TO ME-010-RUN-DT
 20689           ACCEPT WS-TIME-OF-DAY   FROM TIME
 20690           MOVE WS-TIME              TO ME-010-END
*  12-S*************************************************               ( 405)**
**    Operand ME-010-END is not declared
 20691           ADD 1 TO ME-010-RUN-CT
 20692           REWRITE MONTH-END-BALANCES
 20693           DISPLAY 'MONTH-END BALANCES POSTED'
 20694           CLOSE ERMEBL-INOUT
 20695     ELSE
 20696         DISPLAY 'MONTH-END BALANCES NOT POSTED'.
 20697
 20698     GO TO 9999-END-THE-JOB.
 20699
 20700 CERT-DATE-LOAD.
*20701     COPY ELCCRTM1.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 406
* ECS010Z.cbl (/apps/prod/cid1p/copy/ELCCRTM1)
 20702******************************************************************04/15/98
 20703*                                                                *ELCCRTM1
 20704*                                                                *ELCCRTM1
 20705*                            ELCCRTM1                            *   LV003
 20706*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
 20707*                            VMOD=2.001                          *ELCCRTM1
 20708*                                                                *ELCCRTM1
 20709*   COPY FILE VARIABLES TO WORKING STORAGE                       *ELCCRTM1
 20710*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCCRTM1
 20711*                                                                *ELCCRTM1
 20712******************************************************************ELCCRTM1
 20713     MOVE CR-DT                   TO  WS-CR-DT-N.                    CL**2
 20714     MOVE CR-LF-EXPIRE-DATE       TO  WS-CR-LF-EXPIRE-DATE-N.        CL**2
 20715     MOVE CR-AH-EXPIRE-DATE       TO  WS-CR-AH-EXPIRE-DATE-N.        CL**2
 20716     MOVE CR-ENTRY-DATE           TO  WS-CR-ENTRY-DATE-N.            CL**2
 20717     MOVE CR-LF-CANC-DT           TO  WS-CR-LF-CANC-DT-N.            CL**2
 20718     MOVE CR-LF-CANCEL-EXIT-DATE  TO  WS-CR-LF-CANCEL-EXIT-DATE-N.   CL**2
 20719     MOVE CR-LF-CLAIM-EXIT-DATE   TO  WS-CR-LF-CLAIM-EXIT-DATE-N.    CL**2
 20720     MOVE CR-AH-CANC-DT           TO  WS-CR-AH-CANC-DT-N.            CL**2
 20721     MOVE CR-AH-CANCEL-EXIT-DATE  TO                                 CL**2
 20722                                  WS-CR-AH-CANCEL-EXIT-DATE-N.       CL**2
 20723     MOVE CR-AH-SETTLEMENT-EXIT-DATE TO                           ELCCRTM1
 20724                                 WS-CR-AH-SETTLEMENT-EXIT-DATEN.     CL**2
 20725     MOVE CR-DTH-DT               TO  WS-CR-DTH-DT-N.                CL**2
 20726     MOVE CR-DTH-PAY-DT           TO  WS-CR-DTH-PAY-DT-N.            CL**2
 20727     MOVE CR-DIS-DT               TO  WS-CR-DIS-DT-N.                CL**2
 20728     MOVE CR-DIS-PAY-DT           TO  WS-CR-DIS-PAY-DT-N.            CL**2
 20729     MOVE CR-DIS-PTO-DT           TO  WS-CR-DIS-PTO-DT-N.            CL**2
 20730     PERFORM  VARYING COPY-NDX FROM 1 BY 1 UNTIL COPY-NDX > 5     ELCCRTM1
 20731           MOVE CR-DIS-INCUR-DT (COPY-NDX)   TO                   ELCCRTM1
 20732                                WS-CR-DIS-INCUR-DT-N (COPY-NDX)      CL**2
 20733     END-PERFORM.                                                 ELCCRTM1
 20734                                                                  ELCCRTM1
 20735
 20736 EXTRACT-DATE-LOAD.
*20737     COPY ELCEXTM1.
 20738******************************************************************04/15/98
 20739*                                                                *ELCEXTM1
 20740*                                                                *ELCEXTM1
 20741*                            ELCEXTM1                            *   LV010
 20742*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL*10
 20743*                            VMOD=2.001                          *ELCEXTM1
 20744*                                                                *ELCEXTM1
 20745*   COPY FILE VARIABLES TO WORKING STORAGE                       *ELCEXTM1
 20746*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCEXTM1
 20747*                                                                *ELCEXTM1
 20748******************************************************************ELCEXTM1
 20749                                                                  ELCEXTM1
 20750     MOVE DE-EFF                     TO  WS-DE-EFF-N.                CL**9
 20751     MOVE DE-LF-CANC-DTE             TO  WS-DE-LF-CANC-DTE-N.        CL**9
 20752     MOVE DE-LF-CANC-EXIT-DT         TO  WS-DE-LF-CANC-EXIT-DT-N.    CL**9
 20753     MOVE DE-AH-CANC-DTE             TO  WS-DE-AH-CANC-DTE-N.        CL**9
 20754     MOVE DE-AH-CANC-EXIT-DT         TO  WS-DE-AH-CANC-EXIT-DT-N.    CL**9
 20755     MOVE DE-ENTRY-DTE               TO  WS-DE-ENTRY-DTE-N.          CL**9
 20756                                                                     CL**9
 20757     EVALUATE TRUE                                                   CL**5
 20758        WHEN DE-ISSUE      OR                                        CL**8
 20759             DE-RC-ISSUE   OR                                        CL**8
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 407
* ECS010Z.cbl (/apps/prod/cid1p/copy/ELCEXTM1)
 20760             DE-RR-RC-ISS  OR                                        CL**8
 20761             DE-CANCEL     OR                                        CL**8
 20762             DE-RC-CANCEL  OR                                        CL**8
 20763             DE-RR-RC-CNC                                            CL**8
 20764           MOVE DE-PROC-DT           TO  WS-DE-PROC-DT-N             CL**9
 20765                                                                     CL**9
 20766        WHEN DE-CLAIM      OR                                        CL**8
 20767             DE-RR-RC-CLM                                            CL**6
 20768           MOVE DE-INCUR             TO  WS-DE-INCUR-N               CL**9
 20769           MOVE DE-PAY               TO  WS-DE-PAY-N                 CL**9
 20770           MOVE DE-PAID-TO           TO  WS-DE-PAID-TO-N             CL**9
 20771           MOVE DE-ACC-EXP-DTE       TO  WS-DE-ACC-EXP-DTE-N         CL**9
 20772           MOVE DE-ACC-EFF-DTE       TO  WS-DE-ACC-EFF-DTE-N         CL**9
 20773           MOVE DE-CLM-PROC-DT       TO  WS-DE-CLM-PROC-DT-N         CL**9
 20774                                                                     CL**9
 20775        WHEN DE-RESERVE                                              CL**9
 20776           MOVE DE-RSV-INCUR         TO  WS-DE-RSV-INCUR-N           CL**9
 20777           MOVE DE-RSV-PAYTO         TO  WS-DE-RSV-PAYTO-N           CL**9
 20778           MOVE DE-ACC-EXP-DTE-RSV                                   CL**5
 20779                                     TO  WS-DE-ACC-EXP-DTE-RSV-N     CL**9
 20780           MOVE DE-ACC-EFF-DTE-RSV                                   CL**9
 20781                                     TO  WS-DE-ACC-EFF-DTE-RSV-N     CL**9
 20782           MOVE DE-RSV-PROC-DT       TO  WS-DE-RSV-PROC-DT-N         CL**9
 20783     END-EVALUATE.                                                   CL**9
 20784                                                                     CL**9
 20785
 20786 EXTRACT-DATE-RELOAD.
*20787     COPY ELCEXTM2.
 20788******************************************************************04/15/98
 20789*                                                                *ELCEXTM2
 20790*                                                                *ELCEXTM2
 20791*                            ELCEXTM2                            *   LV011
 20792*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL*11
 20793*                            VMOD=2.001                          *ELCEXTM2
 20794*                                                                *ELCEXTM2
 20795*   COPY WORKING STORAGE TO  FILE VARIABLES                      *ELCEXTM2
 20796*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCEXTM2
 20797*                                                                *   CL**9
 20798******************************************************************ELCEXTM2
 20799                                                                  ELCEXTM2
 20800     MOVE WS-DE-EFF-N                TO  DE-EFF.                     CL*10
 20801     MOVE WS-DE-LF-CANC-DTE-N        TO  DE-LF-CANC-DTE.             CL*10
 20802     MOVE WS-DE-LF-CANC-EXIT-DT-N    TO  DE-LF-CANC-EXIT-DT.         CL*10
 20803     MOVE WS-DE-AH-CANC-DTE-N        TO  DE-AH-CANC-DTE.             CL*10
 20804     MOVE WS-DE-AH-CANC-EXIT-DT-N    TO  DE-AH-CANC-EXIT-DT.         CL*10
 20805     MOVE WS-DE-ENTRY-DTE-N          TO  DE-ENTRY-DTE.               CL*10
 20806                                                                     CL*10
 20807     EVALUATE TRUE                                                   CL*10
 20808        WHEN DE-ISSUE      OR                                        CL*10
 20809             DE-RC-ISSUE   OR                                        CL*10
 20810             DE-RR-RC-ISS  OR                                        CL*10
 20811             DE-CANCEL     OR                                        CL*10
 20812             DE-RC-CANCEL  OR                                        CL*10
 20813             DE-RR-RC-CNC                                            CL*10
 20814           MOVE WS-DE-PROC-DT-N      TO  DE-PROC-DT                  CL*10
 20815                                                                     CL*10
 20816        WHEN DE-CLAIM      OR                                        CL*10
 20817             DE-RR-RC-CLM                                            CL**7
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 408
* ECS010Z.cbl (/apps/prod/cid1p/copy/ELCEXTM2)
 20818           MOVE WS-DE-INCUR-N        TO  DE-INCUR                    CL*10
 20819           MOVE WS-DE-PAY-N          TO  DE-PAY                      CL*10
 20820           MOVE WS-DE-PAID-TO-N      TO  DE-PAID-TO                  CL*10
 20821           MOVE WS-DE-ACC-EXP-DTE-N  TO  DE-ACC-EXP-DTE              CL*10
 20822           MOVE WS-DE-ACC-EFF-DTE-N  TO  DE-ACC-EFF-DTE              CL*10
 20823           MOVE WS-DE-CLM-PROC-DT-N  TO  DE-CLM-PROC-DT              CL*10
 20824                                                                     CL*10
 20825        WHEN DE-RESERVE                                              CL**7
 20826            MOVE WS-DE-RSV-INCUR-N   TO  DE-RSV-INCUR                CL*10
 20827            MOVE WS-DE-RSV-PAYTO-N   TO  DE-RSV-PAYTO                CL*10
 20828            MOVE WS-DE-ACC-EXP-DTE-RSV-N                             CL*10
 20829                                     TO  DE-ACC-EXP-DTE-RSV          CL*10
 20830            MOVE WS-DE-ACC-EFF-DTE-RSV-N                             CL**4
 20831                                     TO  DE-ACC-EFF-DTE-RSV          CL*10
 20832            MOVE WS-DE-RSV-PROC-DT-N TO  DE-RSV-PROC-DT              CL*10
 20833     END-EVALUATE.                                                   CL**5
 20834                                                                  ELCEXTM2
 20835
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 409
* ECS010Z.cbl
 20837 ABEND-PGM.
 20838     DISPLAY '******************************'
 20839     DISPLAY '***** ABEND PGM **************'
 20840     DISPLAY '******************************'
*20841                             COPY ELCABEND.
 20842***************************************************************** 04/14/98
 20843*                                                               * ELCABEND
 20844*                            ELCABEND.                          *    LV003
 20845*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
 20846*                            VMOD 2.002                              CL**2
 20847*                                                               * ELCABEND
 20848*                THIS SECTION DISPLAYS THE NECESSARY MESSAGES   * ELCABEND
 20849*            AND THEN ABENDS.                                   * ELCABEND
 20850*                                                               * ELCABEND
 20851*  NO  CID  MODS  IN  COPYBOOK  ELCABEND                        * ELCABEND
 20852*                                                               * ELCABEND
 20853***************************************************************** ELCABEND
 20854*APS-010.                                                         ELCABEND
 20855     DISPLAY WS-ABEND-MESSAGE.                                    ELCABEND
 20856     DISPLAY WS-ABEND-MESSAGE UPON CONSOLE.                       ELCABEND
 20857                                                                  ELCABEND
 20858     IF WS-ABEND-FILE-STATUS NOT = ZERO                           ELCABEND
 20859         DISPLAY 'FILE STATUS = ' WS-ABEND-FILE-STATUS            ELCABEND
 20860         DISPLAY 'FILE STATUS = ' WS-ABEND-FILE-STATUS            ELCABEND
 20861                                 UPON CONSOLE.                    ELCABEND
 20862                                                                  ELCABEND
 20863     IF WS-RETURN-CODE NOT = ZERO                                 ELCABEND
 20864         DISPLAY 'RETURN CODE = '  WS-RETURN-CODE                 ELCABEND
 20865         DISPLAY 'RETURN CODE = '  WS-RETURN-CODE                 ELCABEND
 20866                                 UPON CONSOLE.                    ELCABEND
 20867                                                                  ELCABEND
 20868     DISPLAY 'PROGRAM WILL NOW ABEND **************'              ELCABEND
 20869     DISPLAY 'PROGRAM WILL NOW ABEND **************'              ELCABEND
 20870                                 UPON CONSOLE.                    ELCABEND
 20871                                                                  ELCABEND
 20872     DIVIDE WS-ZERO BY WS-ZERO GIVING WS-ZERO.                    ELCABEND
 20873     CALL 'ABORTME'.
 20874                                                                  ELCABEND
 20875 APS-EXIT.                                                        ELCABEND
 20876     EXIT.                                                        ELCABEND
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 410
* ECS010Z.cbl
 20878 9999-END-THE-JOB.
 20879
 20880     DISPLAY ' '.
 20881     DISPLAY '****** THE END OF MESSAGES CREATED BY '
 20882         'ECS010 ******'
 20883     DISPLAY ' '.
 20884     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 411
* ECS010Z.cbl
 20885/
 20886 LCP-WRITE-POS-MISMATCH-RPT SECTION.
 20887     IF LCP-ASA = '+'
 20888         WRITE MISMATCH-RPT AFTER 0 LINE
 20889     ELSE
 20890     IF LCP-ASA = ' '
 20891         WRITE MISMATCH-RPT AFTER ADVANCING 1 LINE
 20892     ELSE
 20893     IF LCP-ASA = '0'
 20894         WRITE MISMATCH-RPT AFTER ADVANCING 2 LINE
 20895     ELSE
 20896     IF LCP-ASA = '-'
 20897         WRITE MISMATCH-RPT AFTER ADVANCING 3 LINE
 20898     ELSE
 20899     IF LCP-ASA = '1'
 20900         WRITE MISMATCH-RPT AFTER ADVANCING PAGE
 20901     ELSE
 20902     IF LCP-ASA = '2'
 20903         WRITE MISMATCH-RPT AFTER ADVANCING LCP-CH2
 20904     ELSE
 20905     IF LCP-ASA = '3'
 20906         WRITE MISMATCH-RPT AFTER ADVANCING LCP-CH3
 20907     ELSE
 20908     IF LCP-ASA = '4'
 20909         WRITE MISMATCH-RPT AFTER ADVANCING LCP-CH4
 20910     ELSE
 20911     IF LCP-ASA = '5'
 20912         WRITE MISMATCH-RPT AFTER ADVANCING LCP-CH5
 20913     ELSE
 20914     IF LCP-ASA = '6'
 20915         WRITE MISMATCH-RPT AFTER ADVANCING LCP-CH6
 20916     ELSE
 20917     IF LCP-ASA = '7'
 20918         WRITE MISMATCH-RPT AFTER ADVANCING LCP-CH7
 20919     ELSE
 20920     IF LCP-ASA = '8'
 20921         WRITE MISMATCH-RPT AFTER ADVANCING LCP-CH8
 20922     ELSE
 20923     IF LCP-ASA = '9'
 20924         WRITE MISMATCH-RPT AFTER ADVANCING LCP-CH9
 20925     ELSE
 20926     IF LCP-ASA = 'A'
 20927         WRITE MISMATCH-RPT AFTER ADVANCING LCP-CH10
 20928     ELSE
 20929     IF LCP-ASA = 'B'
 20930         WRITE MISMATCH-RPT AFTER ADVANCING LCP-CH11
 20931     ELSE
 20932     IF LCP-ASA = 'C'
 20933         WRITE MISMATCH-RPT AFTER ADVANCING LCP-CH12
 20934     ELSE
 20935     IF LCP-ASA = 'V'
 20936         WRITE MISMATCH-RPT AFTER ADVANCING LCP-P01
 20937     ELSE
 20938     IF LCP-ASA = 'W'
 20939         WRITE MISMATCH-RPT AFTER ADVANCING LCP-P02
 20940     ELSE
 20941     DISPLAY 'ASA CODE ERROR'.
 20942 LCP-WRITE-END-MISMATCH-RPT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 412
* ECS010Z.cbl
 20943     EXIT.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Last message on page:  405
* Total Messages:    15
* Unrecoverable :     0                    Severe  :    12
* Errors        :     3                    Warnings:     0
* Informational :     0                    Flags   :     0
* Data:     2172589     Code:           0
