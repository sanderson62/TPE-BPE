* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   1
* ECRTFIX.cbl
* Options: int("ECRTFIX.int") anim csi verbose NOBOUND PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("ECRTFIX.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"ebmlsfile" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" NOCHECKDIV NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"32" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"ECRTFIX.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"ECRTFIX.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR NOSTICKY-LINKAGE
*          NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"2" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.                                         00000010
     2                                                                  00000020
     3 PROGRAM-ID.                 ECRTFIX.                             00000030
     4*                            VMOD=2.001.                          00000031
     5                                                                  00000050
     6 AUTHOR.        LOGIC, INC.                                       00000060
     7                DALLAS, TEXAS.                                    00000070
     8                                                                  00000080
     9 DATE-COMPILED.                                                   00000090

    11 SECURITY.   *****************************************************00000110
    12             *                                                   *00000120
    13             *   THIS PROGRAM IS THE PROPERTY OF LOGIC, INC.     *00000130
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   2
* ECRTFIX.cbl
    14             *                                                   *00000140
    15             *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *00000150
    16             *   OF LOGIC, INC. IS EXPRESSLY PROHIBITED WITHOUT  *00000160
    17             *   THE PRIOR WRITTEN PERMISSION OF LOGIC, INC.     *00000170
    18             *                                                   *00000180
    19             *****************************************************00000190
    20                                                                  00000200
    21 REMARKS.                                                         00000210
    22         ALL PURPOSE CERT FIX PROGRAM                             00000220
    23                                                                  00000230
    24 ENVIRONMENT DIVISION.                                            00000240
    25 INPUT-OUTPUT SECTION.                                            00000250
    26 FILE-CONTROL.                                                    00000260
    27                                                                  00000270
    28     SELECT  SORT-FILE     ASSIGN TO 6 SYS001-UT-2314-S-SORTWK1.  00000280
    29     SELECT  CERT-IN       ASSIGN TO SYS010-UT-2400-S-SYS010.     00000290
    30     SELECT  CERT-OT       ASSIGN TO SYS011-UT-2400-S-SYS011.     00000300
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   3
* ECRTFIX.cbl
    32 DATA DIVISION.                                                   00000320
    33 FILE SECTION.                                                    00000330
    34                                                                  00000340
    35 SD  SORT-FILE                                                    00000350
    36     RECORDING MODE IS F                                          00000360
    37     RECORD CONTAINS 700 CHARACTERS.                              00000361
    38                                                                  00000362
    39 01  SORT-REC.                                                    00000363
    40     12  FILLER              PIC  X(3).                           00000364
    41     12  SORT-KEY            PIC  X(36).                          00000365
    42     12  FILLER              PIC  X(661).                         00000366
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   4
* ECRTFIX.cbl
    44 FD  CERT-IN                                                      00000368
    45     RECORDING MODE IS F                                          00000369
    46     LABEL RECORDS ARE STANDARD                                   00000370
    47     BLOCK CONTAINS 0 RECORDS                                     00000371
    48     RECORD CONTAINS 700 CHARACTERS.                              00000372
    49                                                                  00000373
    50 01  CERT-IN-REC             PIC  X(700).                         00000374
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   5
* ECRTFIX.cbl
    52 FD  CERT-OT                                                      00000376
    53     RECORDING MODE IS F                                          00000377
    54     LABEL RECORDS ARE STANDARD                                   00000378
    55     BLOCK CONTAINS 0 RECORDS                                     00000379
    56     RECORD CONTAINS 700 CHARACTERS.                              00000380
    57                                                                  00000381
    58 01  CERT-OT-REC            PIC  X(700).                          00000382
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   6
* ECRTFIX.cbl
    60 WORKING-STORAGE SECTION.                                         00000384
    61 77  FILLER  PIC  X(32) VALUE '********************************'. 00000385
    62 77  FILLER  PIC  X(32) VALUE '   ECRTFIX   WORKING-STORAGE    '. 00000386
    63 77  FILLER  PIC  X(32) VALUE '*****VMOD=2.001*****************'. 00000387
    64                                                                  00000388
    65 77  CERT-IN-CTR             PIC  9(7)           VALUE ZERO.      00000389
    66 77  CERT-FX-CTR             PIC  9(7)           VALUE ZERO.      00000390
    67 77  CERT-OT-CTR             PIC  9(7)           VALUE ZERO.      00000391
    68                                                                  00000392
    69 01  WS.                                                          00000393
    70     12  WS-RETURN-CODE          PIC S9(4)       VALUE ZERO.      00000394
    71     12  WS-ZERO                 PIC S9          VALUE ZERO.      00000395
    72     12  WS-ABEND-MESSAGE        PIC  X(80)      VALUE SPACES.    00000396
    73     12  WS-ABEND-FILE-STATUS    PIC  XX         VALUE ZERO.      00000397
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   7
* ECRTFIX.cbl
*   75                             COPY ECSCRT01.                       00000399
    76******************************************************************
    77*                                                                *
    78*                            ECSCRT01                            *
    79*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
    80*                            VMOD=2.016                          *
    81*                                                                *
    82*   FILE DESCRIPTION = CERTIFICATE RECORD    (OFF-LINE)          *
    83*                                                                *
    84*   FILE TYPE = SEQUENTIAL
    85*   RECORD SIZE = 1056 RECFORM = FIXED                           *
    86*                                                                *
    87*   KEY DATA =                         START=4, LEN=36           *
    88*                                                                *
    89*  NO  CID  MODS  IN  COPYBOOK  ECSCRT01                         *
    90*                                                                *
    91******************************************************************
    92******************************************************************
    93*                   C H A N G E   L O G
    94*
    95* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    96*-----------------------------------------------------------------
    97*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    98* EFFECTIVE    NUMBER
    99*-----------------------------------------------------------------
   100* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
   101* 100703    2003080800002  PEMA  ADD SUPER GAP PROCESSING
   102* 040504    2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
   103* 020305    2005020000000  PEMA  ADD CLP STATE TO CERT RECORD
   104* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
   105* 042408    2007110500003  PEMA  ADD REFUND INTEREST PROCESSING
   106* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
   107* 032612  CR2011110200001  PEMA  AHL CHANGES
   108* 052814  CR2014012300001  PEMA  DCC CREDIT UNION CHANGES
   109* 090314  CR2014081300001  PEMA  LOAD CERTS INVOLVED IN THAO
   110******************************************************************
   111
   112 01  CERTIFICATE-RECORD.
   113     12  CR-RECORD-ID                      PIC XX.
   114         88  VALID-CR-ID                      VALUE 'CR'.
   115
   116     12  CR-COMPANY-CD                     PIC X.
   117
   118     12  CR-FULL-CONTROL.
   119         16  CR-CONTROL-1.
   120             20  CR-ACCT-CONTROL.
   121                 24  CR-CARRIER            PIC X.
   122                 24  CR-GROUPING.
   123                     28  CR-GROUP-PREFIX   PIC XXX.
   124                     28  CR-GROUP-PRIME    PIC XXX.
   125                 24  CR-STATE              PIC XX.
   126                 24  CR-ACCOUNT.
   127                     28  CR-ACCT-PREFIX    PIC X(4).
   128                     28  CR-ACCT-PRIME     PIC X(6).
   129             20  CR-DT                     PIC 9(11)  COMP-3.
   130         16  CR-CERT-NO.
   131             20  CR-CERT.
   132                 24  CR-CERT-PREFIX        PIC X(3).
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   8
* ECRTFIX.cbl (/apps/prod/cid1p/copy/ECSCRT01)
   133                 24  CR-CERT-PRIME         PIC X(7).
   134             20  CR-CERT-SFX               PIC X.
   135
   136     12  CR-INSUREDS-PROFILE.
   137         16  CR-NAME.
   138             20  CR-LNAME                  PIC X(15).
   139             20  CR-FNAME.
   140                 24  CR-1ST-INITIAL        PIC X.
   141                 24  FILLER                PIC X(9).
   142             20  CR-INIT                   PIC X.
   143         16  CR-AGE                        PIC 99.
   144         16  CR-SEX                        PIC X.
   145             88  CR-SEX-MALE                  VALUE 'M'.
   146             88  CR-SEX-FEMALE                VALUE 'F'.
   147         16  CR-SOC-SEC                    PIC X(11).
   148         16  CR-JOINT-NAME.
   149             20  CR-JT-LNAME               PIC X(15).
   150             20  CR-JT-FNAME.
   151                 24  CR-JT-1ST-INIT        PIC X.
   152                 24  FILLER                PIC X(9).
   153             20  CR-JT-INIT                PIC X.
   154         16  CR-JOINT-AGE                  PIC 99.
   155
   156         16  cr-ahl-ah-claim-no            pic x(9).
   157         16  cr-ahl-ah-cert-seq            pic x(3).
   158         16  cr-hst-proc-lf                pic x.
   159         16  f                             pic x(7).
   160
   161     12  CR-LF-COVERAGE-DATA.
   162         16  CR-LFTYP                      PIC XX.
   163         16  CR-LF-TERM                    PIC S999       COMP-3.
   164         16  CR-LF-CRIT-PERIOD             PIC S999       COMP-3.
   165         16  CR-LF-TERM-IN-DAYS            PIC S9(5)      COMP-3.
   166         16  CR-LF-DEV-CODE                PIC XXX.
   167         16  CR-LF-DEV-PCT                 PIC S9V9(6)    COMP-3.
   168
   169         16  CR-LFAMT                      PIC S9(9)V99   COMP-3.
   170         16  CR-LFPRM                      PIC S9(7)V99   COMP-3.
   171         16  CR-LFPRM-CALC                 PIC S9(7)V99   COMP-3.
   172         16  CR-LFPRM-RATE                 PIC S99V9(5)   COMP-3.
   173
   174         16  CR-LFAMT-ALT                  PIC S9(9)V99   COMP-3.
   175         16  CR-LFPRM-ALT                  PIC S9(7)V99   COMP-3.
   176         16  CR-LFPRM-CALC-ALT             PIC S9(7)V99   COMP-3.
   177         16  CR-LFPRM-RATE-ALT             PIC S99V9(5)   COMP-3.
   178
   179         16  CR-LFRFND                     PIC S9(7)V99   COMP-3.
   180         16  CR-LFRFND-CALC                PIC S9(7)V99   COMP-3.
   181
   182         16  CR-LF-NSP-PRM                 PIC S9(7)V99   COMP-3.
   183         16  CR-LF-NSP-PRM-RATE            PIC S99V9(5)   COMP-3.
   184
   185         16  CR-LF-REFUND-TYPE             PIC X.
   186         16  CR-LF-POLICY-FEE              PIC S9(3)V99   COMP-3.
   187
   188         16  CR-LF-COMM-CHARGEBACK         PIC X.
   189             88  CR-NO-LF-CHARGEBACK          VALUE 'N'.
   190
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   9
* ECRTFIX.cbl (/apps/prod/cid1p/copy/ECSCRT01)
   191         16  CR-LF-REI-RISK-PRM            PIC S9(7)V99   COMP-3.
   192
   193         16  CR-LF-EXPIRE-DATE             PIC 9(11)      COMP-3.
   194         16  CR-LF-ISS-PREM-TAX            PIC S9V9(4)    COMP-3.
   195         16  CR-LF-CNC-PREM-TAX            PIC S9V9(4)    COMP-3.
   196
   197         16  cr-ahl-lf-claim-no            pic x(9).
   198         16  cr-ahl-lf-cert-seq            pic x(3).
   199         16  FILLER                        PIC XX.
   200
   201     12  CR-AH-COVERAGE-DATA.
   202         16  CR-AHTYP                      PIC XX.
   203         16  CR-AH-TERM                    PIC S999       COMP-3.
   204         16  CR-AH-CRIT-PERIOD             PIC S999       COMP-3.
   205         16  CR-AH-DEV-CODE                PIC XXX.
   206         16  CR-AH-DEV-PCT                 PIC S9V9(6)    COMP-3.
   207
   208         16  CR-AHAMT                      PIC S9(7)V99   COMP-3.
   209         16  CR-AHPRM                      PIC S9(7)V99   COMP-3.
   210         16  CR-AHPRM-CALC                 PIC S9(7)V99   COMP-3.
   211         16  CR-AHPRM-RATE                 PIC S99V9(5)   COMP-3.
   212
   213         16  CR-AHRFND                     PIC S9(7)V99   COMP-3.
   214         16  CR-AHRFND-CALC                PIC S9(7)V99   COMP-3.
   215
   216         16  CR-AH-NSP-PRM                 PIC S9(7)V99   COMP-3.
   217         16  CR-AH-NSP-PRM-RATE            PIC S99V9(5)   COMP-3.
   218
   219         16  CR-AH-REFUND-TYPE             PIC X.
   220         16  CR-AH-POLICY-FEE              PIC S9(3)V99   COMP-3.
   221
   222         16  CR-AH-COMM-CHARGEBACK         PIC X.
   223             88  CR-NO-AH-CHARGEBACK          VALUE 'N'.
   224
   225         16  CR-AH-REI-RISK-PRM            PIC S9(7)V99   COMP-3.
   226
   227         16  CR-AH-EXPIRE-DATE             PIC 9(11)      COMP-3.
   228         16  CR-AH-ISS-PREM-TAX            PIC S9V9(4)    COMP-3.
   229         16  CR-AH-CNC-PREM-TAX            PIC S9V9(4)    COMP-3.
   230
   231         16  FILLER                        PIC XX.
   232*        16  FILLER                        PIC X(8).
   233
   234     12  CR-LOAN-DATA.
   235         16  CR-LIVES                      PIC S9(7)      COMP-3.
   236         16  CR-DDF-IU-RATE-UP REDEFINES CR-LIVES
   237                                           PIC S9(5)V99   COMP-3.
   238         16  CR-BILLED                     PIC S9(7)      COMP-3.
   239         16  CR-APR                        PIC S999V9(4)  COMP-3.
   240         16  CR-PMT-FREQ                   PIC 99.
   241         16  CR-LOAN-TERM                  PIC S999       COMP-3.
   242         16  CR-RATING-CLASS               PIC XX.
   243         16  CR-POLICY-FORM-NO             PIC X(12).
   244         16  CR-GRPTYP                     PIC XX.
   245         16  CR-IND-GRP                    PIC X.
   246             88  CR-INDIVIDUAL                VALUE '1'.
   247             88  CR-GROUP                     VALUE '2'.
   248         16  CR-SKIP                       PIC 99.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  10
* ECRTFIX.cbl (/apps/prod/cid1p/copy/ECSCRT01)
   249             88  NO-MONTHS-SKIPPED            VALUE 00.
   250             88  SKIP-JULY                    VALUE 01.
   251             88  SKIP-AUGUST                  VALUE 02.
   252             88  SKIP-SEPTEMBER               VALUE 03.
   253             88  SKIP-JULY-AUG                VALUE 04.
   254             88  SKIP-AUG-SEPT                VALUE 05.
   255             88  SKIP-JULY-AUG-SEPT           VALUE 06.
   256             88  SKIP-JUNE-JULY-AUG           VALUE 07.
   257             88  SKIP-JUNE                    VALUE 08.
   258             88  SKIP-JUNE-JULY               VALUE 09.
   259             88  SKIP-AUG-SEPT-OCT            VALUE 10.
   260             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 11.
   261         16  CR-RESIDENT-STATE             PIC XX.
   262         16  CR-RATE-CODE.
   263             20  CR-LF-CLASS-CD            PIC XX.
   264             20  CR-AH-CLASS-CD            PIC XX.
   265         16  CR-MORT.
   266             20  CR-TAB                    PIC X.
   267             20  CR-INT                    PIC 99.
   268             20  CR-GRP                    PIC X.
   269         16  CR-MEMBER-NO                  PIC X(12).
   270         16  CR-OLD-LOF                    PIC XXX.
   271*        16  CR-LOAN-OFFICER               PIC XXX.
   272         16  CR-REIN-TABLE                 PIC XXX.
   273         16  CR-REIN-SPEC                  PIC X.
   274         16  CR-LOAN-1ST-PMT-DT.
   275             20  CR-1ST-PMT-YR             PIC 99.
   276             20  CR-1ST-PMT-MO             PIC 99.
   277             20  CR-1ST-PMT-DA             PIC 99.
   278         16  CR-SUM-CAN-CNT-ITD            PIC S999       COMP-3.
   279         16  CR-SUM-CAN-CNT-YTD            PIC S999       COMP-3.
   280         16  CR-PMT-EXTENSION-DAYS         PIC S999       COMP-3.
   281         16  CR-LAST-ADD-ON-DT             PIC XX.
   282
   283         16  CR-UNDERWRITING-CODE          PIC X.
   284             88  CR-POLICY-UNDERWRITTEN       VALUE 'Y'.
   285
   286         16  CR-STATE-TAX                  PIC S9(7)V99   COMP-3.
   287         16  CR-MUNI-TAX                   PIC S9(7)V99   COMP-3.
   288         16  CR-CANCEL-STATE-TAX           PIC S9(7)V99   COMP-3.
   289         16  CR-CANCEL-MUNI-TAX            PIC S9(7)V99   COMP-3.
   290
   291     12  CR-STATUS-INFORMATION.
   292         16  CR-ENTRY-STATUS               PIC X.
   293             88  CR-NORMAL-ENTRY              VALUE '1'.
   294             88  CR-POLICY-IS-RESTORE         VALUE '3'.
   295             88  CR-CONVERSION-ENTRY          VALUE '4'.
   296             88  CR-POLICY-IS-REISSUE         VALUE '5'.
   297             88  CR-POLICY-IS-CASH            VALUE 'C'.
   298             88  CR-POLICY-IS-MONTHLY         VALUE 'M'.
   299             88  CR-POLICY-IS-REIN-ONLY       VALUE '9'.
   300             88  CR-POLICY-IS-DECLINED        VALUE 'D'.
   301             88  CR-POLICY-IS-VOID            VALUE 'V'.
   302             88  CR-POLICY-IS-PREM-ONLY       VALUE 'P'.
   303             88  CR-POLICY-IS-ACTIVE          VALUE '1' '3' '4'
   304                                                'C' '5' '9' 'P'.
   305         16  CR-ENTRY-DATE                 PIC 9(11)  COMP-3.
   306
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  11
* ECRTFIX.cbl (/apps/prod/cid1p/copy/ECSCRT01)
   307         16  CR-LF-STATUS-AT-CANCEL        PIC X.
   308         16  CR-LF-CANC-DT                 PIC 9(11)  COMP-3.
   309         16  CR-LF-CANCEL-EXIT-DATE        PIC 9(11)  COMP-3.
   310
   311         16  CR-LF-STATUS-AT-DEATH         PIC X.
   312         16  CR-LF-CLAIM-EXIT-DATE         PIC 9(11)  COMP-3.
   313
   314         16  CR-LF-CURRENT-STATUS          PIC X.
   315             88  CR-LF-NORMAL-ENTRY           VALUE '1'.
   316             88  CR-LF-POLICY-PENDING         VALUE '2'.
   317             88  CR-LF-POLICY-IS-RESTORE      VALUE '3'.
   318             88  CR-LF-CONVERSION-ENTRY       VALUE '4'.
   319             88  CR-LF-POLICY-IS-REISSUE      VALUE '5'.
   320             88  CR-LF-POLICY-IS-MONTHLY      VALUE 'M'.
   321             88  CR-LF-LUMP-SUM-DISAB         VALUE '6'.
   322             88  CR-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
   323             88  CR-LF-CANCEL-APPLIED         VALUE '8'.
   324             88  CR-LF-IS-REIN-ONLY           VALUE '9'.
   325             88  CR-LF-IS-DECLINED            VALUE 'D'.
   326             88  CR-LF-IS-VOID                VALUE 'V'.
   327             88  CR-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
   328                                                    '4' '5' '9'.
   329
   330         16  CR-AH-STATUS-AT-CANCEL        PIC X.
   331
   332         16  CR-AH-CANC-DT                 PIC 9(11)  COMP-3.
   333         16  CR-AH-CANCEL-EXIT-DATE        PIC 9(11)  COMP-3.
   334
   335         16  CR-AH-STATUS-AT-SETTLEMENT    PIC X.
   336         16  CR-AH-SETTLEMENT-EXIT-DATE    PIC 9(11)  COMP-3.
   337
   338         16  CR-AH-CURRENT-STATUS          PIC X.
   339             88  CR-AH-NORMAL-ENTRY           VALUE '1'.
   340             88  CR-AH-POLICY-PENDING         VALUE '2'.
   341             88  CR-AH-POLICY-IS-RESTORE      VALUE '3'.
   342             88  CR-AH-CONVERSION-ENTRY       VALUE '4'.
   343             88  CR-AH-POLICY-IS-REISSUE      VALUE '5'.
   344             88  CR-AH-POLICY-IS-MONTHLY      VALUE 'M'.
   345             88  CR-AH-LUMP-SUM-DISAB         VALUE '6'.
   346             88  CR-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
   347             88  CR-AH-CANCEL-APPLIED         VALUE '8'.
   348             88  CR-AH-IS-REIN-ONLY           VALUE '9'.
   349             88  CR-AH-IS-DECLINED            VALUE 'D'.
   350             88  CR-AH-IS-VOID                VALUE 'V'.
   351             88  CR-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
   352                                                    '4' '5' '9'.
   353         16  CR-LOAN-OFFICER               PIC X(5).
   354         16  CR-CANCEL-REASON              PIC X.
   355         16  cr-xycor-lf-cov-code          pic x(4).
   356         16  cr-xycor-ah-cov-code          pic x(4).
   357         16  cr-temp-epiq                  pic x(4).
   358         16  FILLER                        PIC XX.
   359
   360     12  CR-DEATH-CLAIM-DATA.
   361         16  CR-NUM-DTH-CLM                PIC S999       COMP-3.
   362
   363         16  CR-DTH-DT                     PIC 9(11)      COMP-3.
   364         16  CR-DTH-RPT-DT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  12
* ECRTFIX.cbl (/apps/prod/cid1p/copy/ECSCRT01)
   365             20  CR-DTH-RPT-YR             PIC 99.
   366             20  CR-DTH-RPT-MO             PIC 99.
   367             20  CR-DTH-RPT-DA             PIC 99.
   368         16  CR-DTH-PAY-DT                 PIC 9(11)      COMP-3.
   369
   370         16  CR-DTHAMT                     PIC S9(9)V99   COMP-3.
   371         16  CR-DTHAMT-YTD                 PIC S9(9)V99   COMP-3.
   372         16  CR-DTHAMT-LAST                PIC S9(9)V99   COMP-3.
   373         16  CR-DTHEXP                     PIC S9(7)V99   COMP-3.
   374         16  CR-DTHEXP-YTD                 PIC S9(7)V99   COMP-3.
   375
   376         16  CR-DTH-AGE                    PIC 99.
   377         16  CR-DTH-PAY-CD                 PIC X.
   378         16  CR-DEATH-CAUSE                PIC X(6).
   379
   380         16  FILLER                        PIC X(16).
   381
   382     12  CR-DISAB-CLAIM-DATA.
   383         16  CR-NUM-DIS-CLM                PIC S999       COMP-3.
   384
   385         16  CR-DIS-DT                     PIC 9(11)      COMP-3.
   386         16  CR-DIS-RPT-DT.
   387             20  CR-DIS-RPT-YR             PIC 99.
   388             20  CR-DIS-RPT-MO             PIC 99.
   389             20  CR-DIS-RPT-DA             PIC 99.
   390         16  CR-DIS-PAY-DT                 PIC 9(11)      COMP-3.
   391         16  CR-DIS-PTO-DT                 PIC 9(11)      COMP-3.
   392
   393         16  CR-DISAMT                     PIC S9(9)V99   COMP-3.
   394         16  CR-DISAMT-YTD                 PIC S9(9)V99   COMP-3.
   395         16  CR-DISAMT-LAST                PIC S9(9)V99   COMP-3.
   396         16  CR-DISEXP                     PIC S9(7)V99   COMP-3.
   397         16  CR-DISEXP-YTD                 PIC S9(7)V99   COMP-3.
   398
   399         16  CR-DAYS-DISAB                 PIC 999        COMP-3.
   400         16  CR-DIS-PAY-CD                 PIC X.
   401         16  FILLER                        PIC XX.
   402
   403         16  CR-DISAB-INCURRED-DETAIL.
   404             20  CR-DISAB-DETAIL-DATA  OCCURS 5 TIMES.
   405**ELCCRTVR MUST BE CHANGED IF THE "OCCURS" IS CHANGED.
   406                 24  CR-DIS-INCUR-DT       PIC 9(11)     COMP-3.
   407                 24  CR-INCUR-DISAMT       PIC S9(9)V99  COMP-3.
   408                 24  CR-INCUR-DISEXP       PIC S9(9)V99  COMP-3.
   409
   410         16  CR-DISAB-CAUSE                PIC X(6).
   411         16  FILLER                        PIC X(14).
   412
   413     12  CR-REMIT-TO                       PIC 99.
   414
   415     12  CR-COMPENSATION-LEVELS.
   416         16  CR-AGT-LEVELS      OCCURS 10 TIMES.
   417             20  CR-COM-AGT.
   418                 24  CR-COM-AGT-PREFIX     PIC X(4).
   419                 24  CR-COM-AGT-PRIME      PIC X(6).
   420             20  CR-AGT-TYPE               PIC X.
   421             20  CR-LCOM-L                 PIC SV9(5)     COMP-3.
   422             20  CR-LCOM-AH                PIC SV9(5)     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  13
* ECRTFIX.cbl (/apps/prod/cid1p/copy/ECSCRT01)
   423
   424     12  CR-BANK-NOCHRGB-MONTHS            PIC 99.
   425     12  CR-MOB-NET-TOT-FEES               PIC S9(7)V99   COMP-3.
   426     12  CR-ADDL-CLP                       PIC S9(5)V99   COMP-3.
   427     12  CR-CLP-STATE                      PIC XX.
   428     12  CR-POST-CARD-IND                  PIC X.
   429     12  CR-LF-CLP                         PIC S9(5)V99   COMP-3.
   430     12  CR-AH-CLP                         PIC S9(5)V99   COMP-3.
   431     12  CR-DCC-PRODUCT-CODE               PIC XXX.
   432     12  CR-LF-RFND-CLP                    PIC S9(5)V99   COMP-3.
   433     12  CR-AH-RFND-CLP                    PIC S9(5)V99   COMP-3.
   434     12  FILLER                            PIC X(07).
   435
   436     12  CR-CSR-CODE                       PIC XXX.
   437
   438     12  CR-CLAIM-DEDUCT-WITHHELD          PIC S9(5)V99   COMP-3.
   439     12  CR-CANCEL-DEDUCT-WITHHELD         PIC S9(5)V99   COMP-3.
   440
   441     12  CR-MICROFILM-NUMBERS.
   442*        16  CR-ISS-MICROFILM-NO           PIC S9(9)      COMP-3.
   443         16  FILLER                        PIC X(5).
   444     12  CR-NH-INT-ON-REF                  PIC S9(7)V99   COMP-3.
   445
   446     12  CR-USER-CODE                      PIC X.
   447     12  CR-USER-FUTURE                    PIC X(9).
   448
   449     12  CR-BENEFICIARY.
   450         16  CR-BANK-NO                    PIC X(10).
   451         16  FILLER                        PIC X(15).
   452
   453     12  CR-ENTRY-BATCH                    PIC X(6).
   454     12  CR-LF-EXIT-BATCH                  PIC X(6).
   455     12  CR-AH-EXIT-BATCH                  PIC X(6).
   456
   457     12  CR-NOTE-SW                        PIC X.
   458
   459     12  CR-ORIGIN-INDICATOR               PIC X.
   460         88  CR-ENTERED-MANUALLY              VALUE '1'.
   461         88  CR-CREATED-FROM-TAPE-LOAD        VALUE '2'.
   462
   463     12  CR-LF-CNC-ENT-DT                  PIC 9(11)  COMP-3.
   464     12  CR-AH-CNC-ENT-DT                  PIC 9(11)  COMP-3.
   465     12  FILLER                            PIC X(33).
   466
   467******************************************************************
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  14
* ECRTFIX.cbl
   469 PROCEDURE DIVISION.                                              00000401
   470                                                                  00000402
   471 0000-INITIALIZE SECTION.                                         00000403
   472     OPEN INPUT  CERT-IN.                                         00000404
   473                                                                  00000810
   474 0100-SORT-ROUTINE.                                               00000811
   475     SORT SORT-FILE  ON ASCENDING KEY  SORT-KEY                   00000812
   476         INPUT PROCEDURE 0200-INPUT-ROUTINE  THRU  3999-EXIT      00000813
   477         OUTPUT PROCEDURE 4000-RETURN-CERT  THRU  5999-EXIT.      00000814
   478                                                                  00000815
   479     IF SORT-RETURN  IS NOT EQUAL TO  ZEROS                       00000816
   480         MOVE '0101'             TO  WS-RETURN-CODE               00000817
   481         MOVE 'BAD SORT RETURN CODE'                              00000818
   482                                 TO  WS-ABEND-MESSAGE             00000819
   483         GO TO 9999-ABORT.                                        00000820
   484                                                                  00000821
   485     GO TO 9000-END-OF-JOB.                                       00000822
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  15
* ECRTFIX.cbl
   487 0200-INPUT-ROUTINE SECTION.                                      00000824
   488                                                                  00000825
   489 0205-READ-CERT.                                                  00000826
   490     READ CERT-IN  INTO  CERTIFICATE-RECORD  AT END               00000827
   491         CLOSE  CERT-IN                                           00000828
   492         GO TO 3999-EXIT.                                         00000829
   493                                                                  00000830
   494     ADD 1                       TO  CERT-IN-CTR.                 00000831
   495                                                                  00000832
   496*** ALL CODE NEEDED FOR FIXING CERT MASTER GOES BETWEEN HERE      00000833
   497*** AND 3000-RELEASE-CERT PARAGRAPH                               00000834
   498                                                                  00001060
   499     IF CR-FULL-CONTROL = '1000001PA00000014508511150000545182 '  00001061
   500         ADD 1                   TO  CERT-FX-CTR                  00001062
   501         MOVE '1'                TO  CR-LF-STATUS-AT-CANCEL       00001063
   502         MOVE '8'                TO  CR-LF-CURRENT-STATUS         00001064
   503         MOVE CR-LFPRM           TO  CR-LFRFND                    00001065
   504         ADD CR-LFPRM-ALT        TO  CR-LFRFND                    00001066
   505         MOVE CR-LFPRM-CALC      TO  CR-LFRFND-CALC               00001067
   506         ADD CR-LFPRM-CALC-ALT   TO  CR-LFRFND-CALC.              00001068
   507                                                                  00001069
   508     PERFORM 3000-RELEASE-CERT  THRU  3099-EXIT.                  00001070
   509                                                                  00001071
   510     GO TO 0205-READ-CERT.                                        00001072
   511                                                                  00001073
   512 3000-RELEASE-CERT.                                               00001074
   513     RELEASE SORT-REC  FROM  CERTIFICATE-RECORD.                  00001075
   514                                                                  00001220
   515 3099-EXIT.                                                       00001221
   516     EXIT.                                                        00001222
   517                                                                  00001250
   518 3999-EXIT.                                                       00001251
   519     EXIT.                                                        00001270
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  16
* ECRTFIX.cbl
   521 4000-RETURN-CERT SECTION.                                        00001272
   522     OPEN OUTPUT  CERT-OT.                                        00001273
   523                                                                  00001274
   524 4005-RETURN-REC.                                                 00001275
   525     RETURN SORT-FILE  INTO  CERTIFICATE-RECORD  AT END           00001276
   526         GO TO 5999-EXIT.                                         00001277
   527                                                                  00001278
   528 5000-WRITE-CERT.                                                 00001279
   529     WRITE CERT-OT-REC  FROM  CERTIFICATE-RECORD.                 00001280
   530                                                                  00001380
   531     ADD 1                       TO  CERT-OT-CTR.                 00001381
   532                                                                  00001382
   533     GO TO 4005-RETURN-REC.                                       00001383
   534                                                                  00001384
   535 5999-EXIT.                                                       00001385
   536     EXIT.                                                        00001386
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  17
* ECRTFIX.cbl
   538 6000-OUT-SORT SECTION.                                           00001388
   539                                                                  00001389
   540 9000-END-OF-JOB.                                                 00001390
   541     DISPLAY CERT-IN-CTR ' = CERT MASTER RECORDS READ'.           00001391
   542     DISPLAY CERT-FX-CTR ' = CERT MASTER RECORDS FIXED'.          00001392
   543     DISPLAY CERT-OT-CTR ' = CERT MASTER RECORDS WRITTEN'.        00001393
   544                                                                  00001394
   545     CLOSE CERT-OT.                                               00001395
   546                                                                  00001396
   547     GOBACK.                                                      00001397
   548                                                                  00001398
   549 9999-ABORT.                                                      00001399
   550                                                                  00001400
   551 ABEND-PGM  SECTION.                                              00001401
*  552                             COPY ELCABEND.                       00001402
   553***************************************************************** 04/14/98
   554*                                                               * ELCABEND
   555*                            ELCABEND.                          *    LV003
   556*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
   557*                            VMOD 2.002                              CL**2
   558*                                                               * ELCABEND
   559*                THIS SECTION DISPLAYS THE NECESSARY MESSAGES   * ELCABEND
   560*            AND THEN ABENDS.                                   * ELCABEND
   561*                                                               * ELCABEND
   562*  NO  CID  MODS  IN  COPYBOOK  ELCABEND                        * ELCABEND
   563*                                                               * ELCABEND
   564***************************************************************** ELCABEND
   565*APS-010.                                                         ELCABEND
   566     DISPLAY WS-ABEND-MESSAGE.                                    ELCABEND
   567     DISPLAY WS-ABEND-MESSAGE UPON CONSOLE.                       ELCABEND
   568                                                                  ELCABEND
   569     IF WS-ABEND-FILE-STATUS NOT = ZERO                           ELCABEND
   570         DISPLAY 'FILE STATUS = ' WS-ABEND-FILE-STATUS            ELCABEND
   571         DISPLAY 'FILE STATUS = ' WS-ABEND-FILE-STATUS            ELCABEND
   572                                 UPON CONSOLE.                    ELCABEND
   573                                                                  ELCABEND
   574     IF WS-RETURN-CODE NOT = ZERO                                 ELCABEND
   575         DISPLAY 'RETURN CODE = '  WS-RETURN-CODE                 ELCABEND
   576         DISPLAY 'RETURN CODE = '  WS-RETURN-CODE                 ELCABEND
   577                                 UPON CONSOLE.                    ELCABEND
   578                                                                  ELCABEND
   579     DISPLAY 'PROGRAM WILL NOW ABEND **************'              ELCABEND
   580     DISPLAY 'PROGRAM WILL NOW ABEND **************'              ELCABEND
   581                                 UPON CONSOLE.                    ELCABEND
   582                                                                  ELCABEND
   583     DIVIDE WS-ZERO BY WS-ZERO GIVING WS-ZERO.                    ELCABEND
   584     CALL 'ABORTME'.
   585                                                                  ELCABEND
   586 APS-EXIT.                                                        ELCABEND
   587     EXIT.                                                        ELCABEND
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:        5256     Code:        1560
