* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   1
* PEMLACR2.cbl
* Options: int("PEMLACR2.int") anim csi verbose NOBOUND PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("PEMLACR2.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"ebmlsfile" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" NOCHECKDIV NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"32" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"PEMLACR2.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST
*          "PEMLACR2.lst" LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0"
*          NOMAPNAME NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT
*          NOMOVELENCHECK NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT
*          NONCHAR NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR NOSTICKY-LINKAGE
*          NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"2" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2 PROGRAM-ID.    PEMLACR2.
     3*AUTHOR.        PABLO.
     4*               COLLEYVILE TEXAS.
     5 ENVIRONMENT DIVISION.
     6 INPUT-OUTPUT SECTION.
     7 FILE-CONTROL.
     8
     9     SELECT REPORT-EXT           ASSIGN TO SYS011
    10            ORGANIZATION IS LINE SEQUENTIAL.
    11
    12     SELECT ERARCH               ASSIGN TO ERARCH2
    13            ACCESS IS DYNAMIC
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   2
* PEMLACR2.cbl
    14            ORGANIZATION IS INDEXED
    15            FILE STATUS IS ERARCH-FILE-STATUS
    16            RECORD KEY IS LA-CONTROL-BY-CERT-RESP.
    17
    18 DATA DIVISION.
    19 FILE SECTION.
    20
    21 FD  REPORT-EXT
    22     BLOCK CONTAINS 0 RECORDS
    23     RECORDING MODE IS F.
    24
    25 01  REPORT-RECORD               PIC X(110).
    26
    27 FD  ERARCH.
*   28                                 COPY ERCARCH.
    29******************************************************************04/19/98
    30*                                                                *ERCARCH
    31*                            ERCARCH.                            *   LV002
    32*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
    33*                            VMOD=2.002                          *   CL**2
    34*                                                                *ERCARCH
    35*   FILE DESCRIPTION = LETTERS SENT TO ARCHIVE FILE              *ERCARCH
    36*                                                                *ERCARCH
    37*   FILE TYPE = VSAM,KSDS                                        *ERCARCH
    38*   RECORD SIZE = 250  RECFORM = FIXED                           *ERCARCH
    39*                                                                *ERCARCH
    40*   BASE CLUSTER = ERARCH                        RKP=2,LEN=5     *ERCARCH
    41*     ALTERNATE PATH1 = ERARCH2 (CERT/RESP)      RKP=07,LEN=35   *ERCARCH
    42*     ALTERNATE PATH2 = ERARCH3 (FORM NUMBER)    RKP=44,LEN=28   *ERCARCH
    43*     ALTERNATE PATH3 = ERARCH4 (PROCCESSOR ID)  RKP=73,LEN=28   *ERCARCH
    44*     ALTERNATE PATH4 = ERARCH5 (ACCOUNT KEY)    RKP=100,LEN=24  *ERCARCH
    45*     ALTERNATE PATH5 = ERARCH6 (BTCH/CHK KEY)   RKP=124,LEN=11  *ERCARCH
    46*                                                                *ERCARCH
    47*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *ERCARCH
    48******************************************************************ERCARCH
    49*                   C H A N G E   L O G
    50*
    51* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    52*-----------------------------------------------------------------
    53*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    54* EFFECTIVE    NUMBER
    55*-----------------------------------------------------------------
    56* 031011  CR2007070900001  PEMA  ADD FOLLOW-UP LETTER PROCESSING
    57* 070711  CR2011022800001  AJRA  NAPERSOFT CHANGES
    58* 110612    2012101700002  AJRA  ADD NEW FIELDS
    59******************************************************************
    60 01  LETTER-ARCHIVE.                                              ERCARCH
    61     12  LA-RECORD-ID                PIC  X(02).                  ERCARCH
    62         88  LA-VALID-ID                VALUE 'LA'.               ERCARCH
    63                                                                  ERCARCH
    64     12  LA-CONTROL-PRIMARY.                                      ERCARCH
    65         16  LA-COMPANY-CD           PIC  X(01).                  ERCARCH
    66         16  LA-ARCHIVE-NO           PIC S9(08)    COMP.          ERCARCH
    67                                                                  ERCARCH
    68     12  LA-CONTROL-BY-CERT-RESP.                                 ERCARCH
    69         16  LA-COMPANY-CD-A2        PIC  X(01).                  ERCARCH
    70         16  LA-CERT-NO-A2.                                       ERCARCH
    71             20  LA-CERT-PRIME-A2    PIC  X(10).                  ERCARCH
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   3
* PEMLACR2.cbl (/apps/prod/cid1p/copy/ERCARCH)
    72             20  LA-CERT-SUFFIX-A2   PIC  X(01).                  ERCARCH
    73         16  LA-RSP-PERSON-A2 REDEFINES LA-CERT-NO-A2.            ERCARCH
    74             20  LA-RESP-PERSON-A2   PIC  X(10).                  ERCARCH
    75             20  LA-TYPE-A2          PIC  X(01).                  ERCARCH
    76         16  LA-CARRIER-A2           PIC  X(01).                  ERCARCH
    77         16  LA-GROUPING-A2          PIC  X(06).                  ERCARCH
    78         16  LA-STATE-A2             PIC  X(02).                  ERCARCH
    79         16  LA-ACCOUNT-A2           PIC  X(10).                  ERCARCH
    80         16  LA-EFFECT-DATE-A2       PIC  X(02).                  ERCARCH
    81         16  LA-ARCHIVE-NO-A2        PIC S9(08)    COMP.          ERCARCH
    82                                                                  ERCARCH
    83     12  LA-CONTROL-BY-FORM.                                      ERCARCH
    84         16  LA-COMPANY-CD-A3        PIC  X(01).                  ERCARCH
    85         16  LA-FORM-A3              PIC  X(04).                  ERCARCH
    86         16  LA-CARRIER-A3           PIC  X(01).                  ERCARCH
    87         16  LA-GROUPING-A3          PIC  X(06).                  ERCARCH
    88         16  LA-STATE-A3             PIC  X(02).                  ERCARCH
    89         16  LA-ACCOUNT-A3           PIC  X(10).                  ERCARCH
    90         16  LA-ARCHIVE-NO-A3        PIC S9(08)    COMP.          ERCARCH
    91                                                                  ERCARCH
    92     12  LA-CONTROL-BY-PROCESSOR.                                 ERCARCH
    93         16  LA-COMPANY-CD-A4        PIC  X(01).                  ERCARCH
    94         16  LA-PROCESSOR-CD         PIC  X(04).                  ERCARCH
    95         16  LA-CARRIER-A4           PIC  X(01).                  ERCARCH
    96         16  LA-GROUPING-A4          PIC  X(06).                  ERCARCH
    97         16  LA-STATE-A4             PIC  X(02).                  ERCARCH
    98         16  LA-ACCOUNT-A4           PIC  X(10).                  ERCARCH
    99         16  LA-ARCHIVE-NO-A4        PIC S9(08)    COMP.          ERCARCH
   100                                                                  ERCARCH
   101     12  LA-CONTROL-BY-KEY-FIELDS.                                ERCARCH
   102         16  LA-COMPANY-CD-A5        PIC  X(01).                  ERCARCH
   103         16  LA-CARRIER-A5           PIC  X(01).                  ERCARCH
   104         16  LA-GROUPING-A5          PIC  X(06).                  ERCARCH
   105         16  LA-STATE-A5             PIC  X(02).                  ERCARCH
   106         16  LA-ACCOUNT-A5           PIC  X(10).                  ERCARCH
   107         16  LA-ARCHIVE-NO-A5        PIC S9(08)    COMP.          ERCARCH
   108                                                                  ERCARCH
   109     12  LA-CONTROL-BY-GROUP-CODE.                                ERCARCH
   110         16  LA-COMPANY-CD-A6        PIC  X(01).                  ERCARCH
   111         16  LA-ENTRY-A6.                                         ERCARCH
   112             20  LA-FILLER           PIC  X(02).                  ERCARCH
   113             20  LA-QUE-CONTROL-A6   PIC S9(08)    COMP.          ERCARCH
   114         16  LA-ARCHIVE-NO-A6        PIC S9(08)    COMP.          ERCARCH
   115                                                                  ERCARCH
   116     12  FILLER                      PIC  X(09).                  ERCARCH
   117                                                                  ERCARCH
   118     12  LA-HEADER-RECORD.                                        ERCARCH
   119         16  LA-NUMBER-LABEL-LINES   PIC S9(04)    COMP.          ERCARCH
   120         16  LA-CREATION-DATE        PIC  X(02).                  ERCARCH
   121         16  LA-FOLLOW-UP-DATE       PIC  X(02).                  ERCARCH
   122         16  LA-FINAL-ACT-DATE       REDEFINES
   123               LA-FOLLOW-UP-DATE     PIC  X(02).
   124         16  LA-INITIAL-PRINT-DATE   PIC  X(02).                  ERCARCH
   125         16  LA-NO-OF-COPIES         PIC S9(01).                  ERCARCH
   126         16  LA-NO-OF-TEXT-RECORDS   PIC S9(04)    COMP.          ERCARCH
   127         16  LA-REPLY-DATE           PIC  X(02).                  ERCARCH
   128         16  LA-RESEND-DATES.                                     ERCARCH
   129             20  LA-RESEND-DATE      PIC  X(02).                  ERCARCH
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   4
* PEMLACR2.cbl (/apps/prod/cid1p/copy/ERCARCH)
   130             20  LA-SENT-DATE        PIC  X(02).                  ERCARCH
   131             20  FILLER              PIC  X(08).
   132         16  LA-SOURCE-INFORMATION.                               ERCARCH
   133             20  LA-DATA-SOURCE      PIC  X(01).                  ERCARCH
   134             20  LA-ADDR-SOURCE      PIC  X(01).                  ERCARCH
   135         16  LA-STATUS               PIC  X(01).                  ERCARCH
   136             88  LA-STATUS-ACTIVE         VALUE 'A'.              ERCARCH
   137             88  LA-STATUS-COMPLETED      VALUE 'C'.              ERCARCH
   138             88  LA-STATUS-ON-HOLD        VALUE 'H'.              ERCARCH
   139             88  LA-STATUS-TO-BE-PURGED   VALUE 'X'.              ERCARCH
   140             88  LA-STATUS-PURGED         VALUE 'P'.              ERCARCH
   141             88  LA-STATUS-VOIDED         VALUE 'V'.              ERCARCH
   142         16  LA-LAST-RESENT-PRINT-DATE                            ERCARCH
   143                                     PIC  X(02).                  ERCARCH
   144         16  LA-PRINT-RESTRICTION    PIC  X(01).                  ERCARCH
   145             88  LA-PRINT-ONLY-WHEN-CNTL-GIVEN                    ERCARCH
   146                                          VALUE 'C'.              ERCARCH
   147             88  LA-PRINT-ONLY-WHEN-FORM-GIVEN                    ERCARCH
   148                                          VALUE 'F'.              ERCARCH
   149             88  LA-PRINT-ONLY-WHEN-PROC-GIVEN                    ERCARCH
   150                                          VALUE 'P'.              ERCARCH
   151         16  LA-PURGED-DATE          PIC  X(02).                  ERCARCH
   152         16  LA-VOIDED-DATE          PIC  X(02).
   153         16  LA-RESEND-LETR          PIC  X(4).
   154         16  FILLER                  PIC  X(08).
   155*        16  LA-RESEND-LETR-2        PIC  X(4).
   156*        16  LA-RESEND-LETR-3        PIC  X(4).
   157*        16  FILLER                  PIC  X(59).
   158         16  LA-ARCHIVE-STATUS       PIC  X.
   159             88  LA-TEMP                VALUE 'T'.
   160             88  LA-QWS                 VALUE 'Q'.
   161             88  LA-BATCH               VALUE 'B'.
   162         16  LA-FINAL-ACT-IND        PIC  X(1).
   163         16  LA-VA-DISCLOSURE-IND    PIC  X(1).
   164         16  LA-ENDT-ARCH-NO         PIC S9(8) COMP.
   165         16  LA-ENDT-ARCH-NO-X REDEFINES LA-ENDT-ARCH-NO
   166                                     PIC X(4).
   167         16  FILLER                  PIC  X(42).
   168*        16  FILLER                  PIC  X(71).                  ERCARCH
   169         16  LA-LAST-MAINT-DATE      PIC  X(2).
   170         16  LA-LAST-MAINT-TIME      PIC S9(6) COMP-3.
   171         16  LA-LAST-MAINT-TIMEX  REDEFINES LA-LAST-MAINT-TIME
   172                                     PIC  X(4).
   173         16  LA-LAST-UPDATED-BY      PIC  X(4).
   174                                                                  ERCARCH
   175******************************************************************ERCARCH
   176
   177 WORKING-STORAGE SECTION.
   178 77  FILLER  PIC X(32) VALUE '********************************'.
   179 77  FILLER  PIC X(32) VALUE '   PEMLACR2  WORKING STORAGE    '.
   180 77  FILLER  PIC X(32) VALUE '*********VMOD=2.001*************'.
   181 77  ERARCH-FILE-STATUS          PIC XX  VALUE LOW-VALUES.
   182 77  WS-NOV-PRINT                PIC 9(7) VALUE ZEROS.
   183 77  WS-NOV-REPRINT              PIC 9(7) VALUE ZEROS.
   184 77  WS-DEC-PRINT                PIC 9(7) VALUE ZEROS.
   185 77  WS-DEC-REPRINT              PIC 9(7) VALUE ZEROS.
   186 77  WS-JAN-PRINT                PIC 9(7) VALUE ZEROS.
   187 77  WS-JAN-REPRINT              PIC 9(7) VALUE ZEROS.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   5
* PEMLACR2.cbl
   188 77  WS-PREV-CERT                PIC X(11) VALUE SPACES.
   189
   190 01  WS-HEAD-LINE.
   191     05  FILLER                  PIC X(99) VALUE
   192        ' CAR  ACT NO      CERT NO    NC     RE DT   PROC  CR DT
   193-       ' PRT DT   RES PRT  LETR ARCH NO  DUP  LETR'.
   194
   195 01  WS-DETAIL-LINE.
   196     05  FILLER                  PIC XX   VALUE SPACES.
   197     05  D1-CARRIER              PIC XXX.
   198     05  D1-ACCT-NO              PIC X(11).
   199     05  D1-CERT-NO              PIC X(12).
   200     05  D1-NOC                  PIC ZZ9.
   201     05  FILLER                  PIC XXXX.
   202     05  D1-RESENT1-DATE         PIC X(9).
   203     05  D1-PROCESSOR-CD         PIC X(5).
   204     05  D1-CREATION-DT          PIC X(9).
   205     05  D1-INITIAL-PRINT-DATE   PIC X(9).
   206     05  D1-RESEND-PRINT-DATE    PIC X(9).
   207     05  D1-FORM-NO              PIC XXXXX.
   208     05  D1-ARCH-NO              PIC 9(7).
   209     05  D1-ARCH-CNT             PIC ZZ99.
   210     05  F                       PIC XX.
   211     05  D1-RFORM-NO             PIC X(4).
   212
   213 01  WS-FORM-INFO.
   214     05  WS-CARRIER              PIC X.
   215     05  WS-CLAIM-NO             PIC X(7).
   216     05  WS-CERT-NO              PIC X(11).
   217     05  WS-NO-OF-COPIES         PIC S9.
   218     05  WS-RESEND-DATE          PIC XX.
   219     05  WS-PROCESSOR-CD         PIC X(4).
   220     05  WS-CREATION-DT          PIC XX.
   221     05  WS-INITIAL-PRINT-DATE   PIC XX.
   222     05  WS-RESEND-PRINT-DATE    PIC XX.
   223     05  WS-CORR-TRLR-SEQ        PIC S9(4)    COMP.
   224     05  WS-1ST-RESEND-PRINT-DT  PIC XX.
   225
   226 01  SV-FORM-INFO.
   227     05  SV-CARRIER              PIC X.
   228     05  SV-CLAIM-NO             PIC X(7).
   229     05  SV-CERT-NO              PIC X(11).
   230     05  SV-NO-OF-COPIES         PIC S9.
   231     05  SV-RESEND-DATE          PIC XX.
   232     05  SV-PROCESSOR-CD         PIC X(4).
   233     05  SV-CREATION-DT          PIC XX.
   234     05  SV-INITIAL-PRINT-DATE   PIC XX.
   235     05  SV-RESEND-PRINT-DATE    PIC XX.
   236     05  SV-CORR-TRLR-SEQ        PIC S9(4)    COMP.
   237     05  SV-1ST-RESEND-PRINT-DT  PIC XX.
   238
   239 01  MISC.
   240     12  WS-SPACES               PIC X(5)  VALUE SPACES.
   241     12  QSAM-IN-CNT             PIC 9(11) VALUE ZEROS.
   242     12  WS-ARCH-CNT             PIC S9(5) COMP-3 VALUE +0.
   243     12  REC-1-CNT               PIC 9(9) VALUE ZEROS.
   244     12  REC-2-CNT               PIC 9(9) VALUE ZEROS.
   245     12  REC-3-CNT               PIC 9(9) VALUE ZEROS.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   6
* PEMLACR2.cbl
   246     12  REC-4-CNT               PIC 9(9) VALUE ZEROS.
   247     12  REC-O-CNT               PIC 9(9) VALUE ZEROS.
   248     12  WS-DISPLAY-ARCH-CNT     PIC ZZ,Z99 VALUE ZEROS.
   249     12  WS-DISPLAY-ARCH-NO      PIC 9(7) VALUE ZEROS.
   250     12  WS-SAVE-ARCH-NO         PIC S9(8) COMP VALUE +0.
   251     12  WS-ERARCH-SW            PIC X VALUE ' '.
   252         88  END-OF-ERARCH             VALUE 'Y'.
   253
   254     12  WS-RETURN-CODE      PIC X(4)            VALUE ZEROS.     EL545
   255     12  ABEND-OPTION        PIC X               VALUE 'Y'.       EL545
   256     12  WS-ABEND-MESSAGE    PIC X(80)           VALUE SPACES.    EL545
   257     12  WS-ABEND-FILE-STATUS PIC XX             VALUE SPACES.    EL545
   258     12  WS-ZERO             PIC S9              VALUE ZERO.      EL545
   259     12  PGM-SUB             PIC S999    COMP-3  VALUE +545.      EL545
   260
*  261                                 COPY ELCDATE.
   262******************************************************************06/11/98
   263*                                                                *ELCDATE
   264*                                                                *ELCDATE
   265*                            ELCDATE.                            *   LV023
   266*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL*16
   267*                            VMOD=2.003                           ELCDATE
   268*                                                                *ELCDATE
   269*                                                                *ELCDATE
   270*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *ELCDATE
   271*                 LENGTH = 200                                   *   CL*19
   272******************************************************************ELCDATE
   273                                                                  ELCDATE
   274 01  DATE-CONVERSION-DATA.                                        ELCDATE
   275     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.    CL*19
   276     12  DC-OPTION-CODE                PIC X.                        CL*15
   277         88  BIN-TO-GREG                VALUE ' '.                ELCDATE
   278         88  ELAPSED-BETWEEN-BIN        VALUE '1'.                ELCDATE
   279         88  EDIT-GREG-TO-BIN           VALUE '2'.                ELCDATE
   280         88  YMD-GREG-TO-BIN            VALUE '3'.                ELCDATE
   281         88  MDY-GREG-TO-BIN            VALUE '4'.                ELCDATE
   282         88  JULIAN-TO-BIN              VALUE '5'.                ELCDATE
   283         88  BIN-PLUS-ELAPSED           VALUE '6'.                ELCDATE
   284         88  FIND-CENTURY               VALUE '7'.                   CL*22
   285         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.                ELCDATE
   286         88  EDIT-GREG-TO-BIN-3         VALUE '9'.                ELCDATE
   287         88  YMD-GREG-TO-BIN-3          VALUE 'A'.                ELCDATE
   288         88  MDY-GREG-TO-BIN-3          VALUE 'B'.                ELCDATE
   289         88  JULIAN-TO-BIN-3            VALUE 'C'.                ELCDATE
   290         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.                ELCDATE
   291         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.                   CL*14
   292         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.                   CL*14
   293         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.                   CL*14
   294         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.         CL*14
   295         88  CHECK-LEAP-YEAR            VALUE 'H'.                   CL*14
   296         88  BIN-3-TO-GREG              VALUE 'I'.                   CL*14
   297         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.                   CL*14
   298         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.                   CL*14
   299         88  CYMD-GREG-TO-BIN           VALUE 'L'.                   CL*14
   300         88  MDCY-GREG-TO-BIN           VALUE 'M'.                   CL*14
   301         88  MDY-GREG-TO-JULIAN         VALUE 'N'.                   CL*14
   302         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.                   CL*14
   303         88  YMD-GREG-TO-JULIAN         VALUE 'P'.                   CL*14
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   7
* PEMLACR2.cbl (/apps/prod/cid1p/copy/ELCDATE)
   304         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.                   CL*14
   305         88  THREE-CHARACTER-BIN                                  ELCDATE
   306                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.       CL*14
   307         88  GREGORIAN-TO-BIN                                        CL**2
   308                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.    CL*14
   309         88  BIN-TO-GREGORIAN                                        CL**2
   310                  VALUES ' ' '1' 'I' '8' 'G'.                        CL*14
   311         88  JULIAN-TO-BINARY                                        CL**2
   312                  VALUES '5' 'C' 'E' 'F'.                            CL*14
   313     12  DC-ERROR-CODE                 PIC X.                        CL*15
   314         88  NO-CONVERSION-ERROR        VALUE ' '.                   CL**3
   315         88  DATE-CONVERSION-ERROR                                ELCDATE
   316                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.        CL*14
   317         88  DATE-IS-ZERO               VALUE '1'.                ELCDATE
   318         88  DATE-IS-NON-NUMERIC        VALUE '2'.                ELCDATE
   319         88  DATE-IS-INVALID            VALUE '3'.                ELCDATE
   320         88  DATE1-GREATER-DATE2        VALUE '4'.                ELCDATE
   321         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.                ELCDATE
   322         88  DATE-INVALID-OPTION        VALUE '9'.                ELCDATE
   323         88  INVALID-CENTURY            VALUE 'A'.                ELCDATE
   324         88  ONLY-CENTURY               VALUE 'B'.                ELCDATE
   325         88  ONLY-LEAP-YEAR             VALUE 'C'.                ELCDATE
   326         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.              CL**3
   327     12  DC-END-OF-MONTH               PIC X.                        CL*15
   328         88  CALCULATE-END-OF-MONTH     VALUE '1'.                ELCDATE
   329     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.         CL*15
   330         88  USE-NORMAL-PROCESS         VALUE ' '.                ELCDATE
   331         88  ADJUST-DOWN-100-YRS        VALUE '1'.                ELCDATE
   332         88  ADJUST-UP-100-YRS          VALUE '2'.                ELCDATE
   333     12  FILLER                        PIC X.                        CL*15
   334     12  DC-CONVERSION-DATES.                                        CL*15
   335         16  DC-BIN-DATE-1             PIC XX.                       CL*15
   336         16  DC-BIN-DATE-2             PIC XX.                       CL*15
   337         16  DC-GREG-DATE-1-EDIT       PIC X(08).                    CL*15
   338         16  DC-GREG-DATE-1-EDIT-R REDEFINES                         CL*15
   339                       DC-GREG-DATE-1-EDIT.                       ELCDATE
   340             20  DC-EDIT1-MONTH        PIC 99.                       CL*15
   341             20  SLASH1-1              PIC X.                        CL*15
   342             20  DC-EDIT1-DAY          PIC 99.                       CL*15
   343             20  SLASH1-2              PIC X.                        CL*15
   344             20  DC-EDIT1-YEAR         PIC 99.                       CL*15
   345         16  DC-GREG-DATE-2-EDIT       PIC X(08).                    CL*15
   346         16  DC-GREG-DATE-2-EDIT-R REDEFINES                         CL*15
   347                     DC-GREG-DATE-2-EDIT.                         ELCDATE
   348             20  DC-EDIT2-MONTH        PIC 99.                       CL*15
   349             20  SLASH2-1              PIC X.                        CL*15
   350             20  DC-EDIT2-DAY          PIC 99.                       CL*15
   351             20  SLASH2-2              PIC X.                        CL*15
   352             20  DC-EDIT2-YEAR         PIC 99.                       CL*15
   353         16  DC-GREG-DATE-1-YMD        PIC 9(06).                    CL*15
   354         16  DC-GREG-DATE-1-YMD-R  REDEFINES                         CL*15
   355                     DC-GREG-DATE-1-YMD.                          ELCDATE
   356             20  DC-YMD-YEAR           PIC 99.                       CL*15
   357             20  DC-YMD-MONTH          PIC 99.                       CL*15
   358             20  DC-YMD-DAY            PIC 99.                       CL*15
   359         16  DC-GREG-DATE-1-MDY        PIC 9(06).                    CL*15
   360         16  DC-GREG-DATE-1-MDY-R REDEFINES                          CL*15
   361                      DC-GREG-DATE-1-MDY.                         ELCDATE
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   8
* PEMLACR2.cbl (/apps/prod/cid1p/copy/ELCDATE)
   362             20  DC-MDY-MONTH          PIC 99.                       CL*15
   363             20  DC-MDY-DAY            PIC 99.                       CL*15
   364             20  DC-MDY-YEAR           PIC 99.                       CL*15
   365         16  DC-GREG-DATE-1-ALPHA.                                   CL*15
   366             20  DC-ALPHA-MONTH        PIC X(10).                    CL*15
   367             20  DC-ALPHA-DAY          PIC 99.                       CL*15
   368             20  FILLER                PIC XX.                       CL*15
   369             20  DC-ALPHA-CENTURY.                                   CL*15
   370                 24 DC-ALPHA-CEN-N     PIC 99.                       CL*15
   371             20  DC-ALPHA-YEAR         PIC 99.                       CL*15
   372         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.           CL*15
   373         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.           CL*15
   374         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.           CL*15
   375         16  DC-JULIAN-DATE            PIC 9(05).                    CL*15
   376         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE                CL*20
   377                                       PIC 9(05).                    CL*20
   378         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.                  CL*15
   379             20  DC-JULIAN-YEAR        PIC 99.                       CL*15
   380             20  DC-JULIAN-DAYS        PIC 999.                      CL*15
   381         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.       CL*15
   382         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.    CL*15
   383         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.    CL*15
   384     12  DATE-CONVERSION-VARIBLES.                                   CL*15
   385         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.            CL*15
   386         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.          CL*15
   387             20  FILLER                PIC 9(3).                     CL*15
   388             20  HOLD-CEN-1-CCYY.                                    CL*15
   389                 24  HOLD-CEN-1-CC     PIC 99.                       CL*17
   390                 24  HOLD-CEN-1-YY     PIC 99.                       CL*17
   391             20  HOLD-CEN-1-MO         PIC 99.                       CL*17
   392             20  HOLD-CEN-1-DA         PIC 99.                       CL*17
   393         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.            CL*15
   394             20  HOLD-CEN-1-R-MO       PIC 99.                       CL*17
   395             20  HOLD-CEN-1-R-DA       PIC 99.                       CL*17
   396             20  HOLD-CEN-1-R-CCYY.                                  CL*15
   397                 24  HOLD-CEN-1-R-CC   PIC 99.                       CL*17
   398                 24  HOLD-CEN-1-R-YY   PIC 99.                       CL*17
   399             20  FILLER                PIC 9(3).                     CL*15
   400         16  HOLD-CENTURY-1-X.                                       CL*15
   401             20  FILLER                PIC X(3)  VALUE SPACES.       CL*15
   402             20  HOLD-CEN-1-X-CCYY.                                  CL*15
   403                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.          CL*17
   404                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.          CL*17
   405             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.          CL*17
   406             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.          CL*17
   407         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.          CL*15
   408             20  HOLD-CEN-1-R-X-MO     PIC XX.                       CL*17
   409             20  HOLD-CEN-1-R-X-DA     PIC XX.                       CL*17
   410             20  HOLD-CEN-1-R-X-CCYY.                                CL*15
   411                 24  HOLD-CEN-1-R-X-CC PIC XX.                       CL*17
   412                 24  HOLD-CEN-1-R-X-YY PIC XX.                       CL*17
   413             20  FILLER                PIC XXX.                      CL*23
   414         16  DC-BIN-DATE-EXPAND-1      PIC XXX.                      CL*15
   415         16  DC-BIN-DATE-EXPAND-2      PIC XXX.                      CL*15
   416         16  DC-JULIAN-DATE-1          PIC 9(07).                    CL*15
   417         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.          CL*15
   418             20  DC-JULIAN-1-CCYY.                                   CL*15
   419                 24  DC-JULIAN-1-CC    PIC 99.                       CL*15
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   9
* PEMLACR2.cbl (/apps/prod/cid1p/copy/ELCDATE)
   420                 24  DC-JULIAN-1-YR    PIC 99.                       CL*15
   421             20  DC-JULIAN-DA-1        PIC 999.                      CL*15
   422         16  DC-JULIAN-DATE-2          PIC 9(07).                    CL*15
   423         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.          CL*15
   424             20  DC-JULIAN-2-CCYY.                                   CL*15
   425                 24  DC-JULIAN-2-CC    PIC 99.                       CL*15
   426                 24  DC-JULIAN-2-YR    PIC 99.                       CL*15
   427             20  DC-JULIAN-DA-2        PIC 999.                      CL*15
   428         16  DC-GREG-DATE-A-EDIT.                                    CL*15
   429             20  DC-EDITA-MONTH        PIC 99.                       CL*15
   430             20  SLASHA-1              PIC X VALUE '/'.              CL*15
   431             20  DC-EDITA-DAY          PIC 99.                       CL*15
   432             20  SLASHA-2              PIC X VALUE '/'.              CL*15
   433             20  DC-EDITA-CCYY.                                      CL*15
   434                 24  DC-EDITA-CENT     PIC 99.                       CL*15
   435                 24  DC-EDITA-YEAR     PIC 99.                       CL*15
   436         16  DC-GREG-DATE-B-EDIT.                                    CL*15
   437             20  DC-EDITB-MONTH        PIC 99.                       CL*15
   438             20  SLASHB-1              PIC X VALUE '/'.              CL*15
   439             20  DC-EDITB-DAY          PIC 99.                       CL*15
   440             20  SLASHB-2              PIC X VALUE '/'.              CL*15
   441             20  DC-EDITB-CCYY.                                      CL*15
   442                 24  DC-EDITB-CENT     PIC 99.                       CL*15
   443                 24  DC-EDITB-YEAR     PIC 99.                       CL*15
   444         16  DC-GREG-DATE-CYMD         PIC 9(08).                    CL*15
   445         16  DC-GREG-DATE-CYMD-R REDEFINES                           CL*15
   446                              DC-GREG-DATE-CYMD.                  ELCDATE
   447             20  DC-CYMD-CEN           PIC 99.                       CL*15
   448             20  DC-CYMD-YEAR          PIC 99.                       CL*15
   449             20  DC-CYMD-MONTH         PIC 99.                       CL*15
   450             20  DC-CYMD-DAY           PIC 99.                       CL*15
   451         16  DC-GREG-DATE-MDCY         PIC 9(08).                    CL*15
   452         16  DC-GREG-DATE-MDCY-R REDEFINES                           CL*15
   453                              DC-GREG-DATE-MDCY.                  ELCDATE
   454             20  DC-MDCY-MONTH         PIC 99.                       CL*15
   455             20  DC-MDCY-DAY           PIC 99.                       CL*15
   456             20  DC-MDCY-CEN           PIC 99.                       CL*15
   457             20  DC-MDCY-YEAR          PIC 99.                       CL*15
   458    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.      ELCDATE
   459        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.        ELCDATE
   460    12  DC-EL310-DATE                  PIC X(21).                    CL*26
   461    12  FILLER                         PIC X(28).                    CL*26
   462
   463 PROCEDURE DIVISION.
   464
   465 0000-BEGIN-PROGRAM.
   466
   467     PERFORM 0010-OPEN-FILES     THRU 0010-EXIT
   468     PERFORM 0020-INIT           THRU 0020-EXIT
   469
   470     PERFORM 0140-PROCESS        THRU 0140-EXIT UNTIL
   471        (END-OF-ERARCH)
   472*       OR (REC-3-CNT > 1000000)
   473
   474     PERFORM 0200-CLOSE-FILES    THRU 0200-EXIT
   475
   476     DISPLAY ' TOTAL RECORDS READ   ' QSAM-IN-CNT
   477     DISPLAY ' HEADER RECORDS   1   ' REC-1-CNT
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  10
* PEMLACR2.cbl
   478     DISPLAY ' ADDRESS RECORDS  2   ' REC-2-CNT
   479     DISPLAY ' TEXT RECORDS     3   ' REC-3-CNT
   480     DISPLAY ' FORM CNTRL HDR   4   ' REC-4-CNT
   481     DISPLAY ' ULAR             ?   ' REC-O-CNT
   482
   483     DISPLAY SPACES
   484     DISPLAY ' NOV 08 PRINT         ' WS-NOV-PRINT
   485     DISPLAY ' NOV 08 REPRINTS      ' WS-NOV-REPRINT
   486     DISPLAY ' DEC 08 PRINT         ' WS-DEC-PRINT
   487     DISPLAY ' DEC 08 REPRINTS      ' WS-DEC-REPRINT
   488     DISPLAY ' JAN 09 PRINT         ' WS-JAN-PRINT
   489     DISPLAY ' JAN 09 REPRINTS      ' WS-JAN-REPRINT
   490
   491     GOBACK
   492
   493     .
   494 0010-OPEN-FILES.
   495
   496     OPEN  INPUT ERARCH
   497          OUTPUT REPORT-EXT
   498
   499     IF ERARCH-FILE-STATUS NOT = '00' AND '97'
   500        DISPLAY ' BAD OPEN ERARCH ' ERARCH-FILE-STATUS
   501        PERFORM ABEND-PGM
   502     END-IF
   503
   504     .
   505 0010-EXIT.
   506     EXIT.
   507
   508 0020-INIT.
   509
   510     MOVE ZEROS                  TO QSAM-IN-CNT
   511
   512     WRITE REPORT-RECORD         FROM WS-HEAD-LINE
   513
   514     WRITE REPORT-RECORD         FROM WS-SPACES
   515     WRITE REPORT-RECORD         FROM WS-SPACES
   516     MOVE LOW-VALUES TO LA-CONTROL-BY-CERT-RESP
   517     START ERARCH KEY > LA-CONTROL-BY-CERT-RESP
   518
   519     IF ERARCH-FILE-STATUS NOT = '00'
   520        DISPLAY ' BAD START ERARCH ' ERARCH-FILE-STATUS
   521        PERFORM ABEND-PGM
   522     END-IF
   523
   524     PERFORM 0146-READ-ERARCH    THRU 0146-EXIT
   525
   526     .
   527 0020-EXIT.
   528     EXIT.
   529
   530 0140-PROCESS.
   531
   532     IF (LA-STATUS = 'A')
   533        AND (LA-PURGED-DATE = LOW-VALUES OR SPACES)
   534        AND (LA-VOIDED-DATE = LOW-VALUES OR SPACES)
   535        AND (LA-REPLY-DATE  = LOW-VALUES OR SPACES)
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  11
* PEMLACR2.cbl
   536        CONTINUE
   537     ELSE
   538        GO TO 0140-CONTINUE
   539     END-IF
   540
   541     DISPLAY ' MADE IT PAST FIRST SELECTION '
   542
   543     IF (LA-INITIAL-PRINT-DATE = LOW-VALUES OR SPACES)
   544                   OR
   545        ((LA-SENT-DATE = SPACES OR LOW-VALUES)
   546         AND (LA-RESEND-DATE NOT = SPACES AND LOW-VALUES))
   547         CONTINUE
   548     ELSE
   549        GO TO 0140-CONTINUE
   550     END-IF
   551
   552     PERFORM 0150-PRINT-REPORT
   553                              THRU 0150-EXIT
   554
   555     .
   556 0140-CONTINUE.
   557
   558     PERFORM 0146-READ-ERARCH    THRU 0146-EXIT
   559
   560     .
   561 0140-EXIT.
   562     EXIT.
   563
   564 0146-READ-ERARCH.
   565
   566     READ ERARCH NEXT RECORD
   567
   568     IF (ERARCH-FILE-STATUS = '10')
   569        OR (LA-COMPANY-CD-A2 > X'04')
   570        SET END-OF-ERARCH        TO TRUE
   571     ELSE
   572        IF ERARCH-FILE-STATUS NOT = '00'
   573           DISPLAY ' BAD READ NEXT ERARCH ' ERARCH-FILE-STATUS
   574           PERFORM ABEND-PGM
   575        END-IF
   576     END-IF
   577
   578     IF NOT END-OF-ERARCH
   579        ADD 1                    TO QSAM-IN-CNT
   580     END-IF
   581
   582     .
   583 0146-EXIT.
   584     EXIT.
   585
   586 0150-PRINT-REPORT.
   587
   588     IF WS-PREV-CERT = LA-CERT-NO-A2
   589        MOVE 55                  TO D1-ARCH-CNT
   590     ELSE
   591        MOVE ZEROS               TO D1-ARCH-CNT
   592     END-IF
   593     MOVE LA-CERT-NO-A2          TO WS-PREV-CERT
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  12
* PEMLACR2.cbl
   594     MOVE LA-CARRIER-A2          TO D1-CARRIER
   595     MOVE LA-ACCOUNT-A2          TO D1-ACCT-NO
   596     MOVE LA-CERT-NO-A2          TO D1-CERT-NO
   597     MOVE LA-ARCHIVE-NO          TO D1-ARCH-NO
   598
   599     MOVE LA-NO-OF-COPIES        TO D1-NOC
   600     MOVE LA-PROCESSOR-CD        TO D1-PROCESSOR-CD
   601     MOVE LA-FORM-A3             TO D1-FORM-NO
   602     MOVE LA-RESEND-LETR         TO D1-RFORM-NO
   603
   604     IF LA-RESEND-DATE NOT = LOW-VALUES
   605        MOVE LA-RESEND-DATE      TO DC-BIN-DATE-1
   606        PERFORM 8500-DATE-CONVERSION
   607                                 THRU 8590-EXIT
   608        IF NO-CONVERSION-ERROR
   609           MOVE DC-GREG-DATE-1-EDIT
   610                                 TO D1-RESENT1-DATE
   611        ELSE
   612           MOVE '00/00/00'       TO D1-RESENT1-DATE
   613        END-IF
   614     END-IF
   615
   616     IF LA-CREATION-DATE NOT = LOW-VALUES
   617        MOVE LA-CREATION-DATE    TO DC-BIN-DATE-1
   618        PERFORM 8500-DATE-CONVERSION
   619                                 THRU 8590-EXIT
   620        IF NO-CONVERSION-ERROR
   621           MOVE DC-GREG-DATE-1-EDIT
   622                                 TO D1-CREATION-DT
   623        ELSE
   624           MOVE '00/00/00'       TO D1-CREATION-DT
   625        END-IF
   626     END-IF
   627
   628     IF LA-INITIAL-PRINT-DATE NOT = LOW-VALUES
   629        MOVE LA-INITIAL-PRINT-DATE
   630                                 TO DC-BIN-DATE-1
   631        PERFORM 8500-DATE-CONVERSION
   632                                 THRU 8590-EXIT
   633        IF NO-CONVERSION-ERROR
   634           MOVE DC-GREG-DATE-1-EDIT
   635                                 TO D1-INITIAL-PRINT-DATE
   636        ELSE
   637           MOVE '00/00/00'       TO D1-INITIAL-PRINT-DATE
   638        END-IF
   639     END-IF
   640
   641     IF LA-RESEND-DATE NOT = LOW-VALUES
   642        MOVE LA-RESEND-DATE        TO DC-BIN-DATE-1
   643        PERFORM 8500-DATE-CONVERSION
   644                                 THRU 8590-EXIT
   645        IF NO-CONVERSION-ERROR
   646           MOVE DC-GREG-DATE-1-EDIT
   647                                 TO D1-RESEND-PRINT-DATE
   648        ELSE
   649           MOVE '00/00/00'       TO D1-RESEND-PRINT-DATE
   650        END-IF
   651     END-IF
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  13
* PEMLACR2.cbl
   652
   653     WRITE REPORT-RECORD         FROM WS-DETAIL-LINE
   654     WRITE REPORT-RECORD         FROM WS-SPACES
   655
   656     MOVE ZEROS                  TO WS-ARCH-CNT
   657
   658     .
   659 0150-EXIT.
   660     EXIT.
   661
   662 0200-CLOSE-FILES.
   663
   664     CLOSE ERARCH
   665           REPORT-EXT
   666
   667     .
   668 0200-EXIT.
   669     EXIT.
   670
   671 8500-DATE-CONVERSION.
*                            COPY ELCDCS.
   672****************************************************************  04/15/98
   673*                                                              *  ELCDCS
   674*                                                              *  ELCDCS
   675*                            ELCDCS.                           *     LV003
   676*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
   677*                            VMOD=2.002                        *     CL**3
   678*                                                              *  ELCDCS
   679*           THIS SECTION CALLS THE DATE CONVERSION SUBROUTINE. *  ELCDCS
   680****************************************************************. ELCDCS
   681                                                                  ELCDCS
   682 8510-DATE-CONVERSION.                                            ELCDCS
   683     CALL 'ELDATCX' USING DATE-CONVERSION-DATA.                   ELCDCS
   684                                                                  ELCDCS
   685 8590-EXIT.                                                       ELCDCS
   686     EXIT.                                                        ELCDCS
   687                                                                  ELCDCS
   688
   689 ABEND-PGM SECTION.
*  690                          COPY ELCABEND.
   691***************************************************************** 04/14/98
   692*                                                               * ELCABEND
   693*                            ELCABEND.                          *    LV003
   694*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
   695*                            VMOD 2.002                              CL**2
   696*                                                               * ELCABEND
   697*                THIS SECTION DISPLAYS THE NECESSARY MESSAGES   * ELCABEND
   698*            AND THEN ABENDS.                                   * ELCABEND
   699*                                                               * ELCABEND
   700*  NO  CID  MODS  IN  COPYBOOK  ELCABEND                        * ELCABEND
   701*                                                               * ELCABEND
   702***************************************************************** ELCABEND
   703*APS-010.                                                         ELCABEND
   704     DISPLAY WS-ABEND-MESSAGE.                                    ELCABEND
   705     DISPLAY WS-ABEND-MESSAGE UPON CONSOLE.                       ELCABEND
   706                                                                  ELCABEND
   707     IF WS-ABEND-FILE-STATUS NOT = ZERO                           ELCABEND
   708         DISPLAY 'FILE STATUS = ' WS-ABEND-FILE-STATUS            ELCABEND
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  14
* PEMLACR2.cbl (/apps/prod/cid1p/copy/ELCABEND)
   709         DISPLAY 'FILE STATUS = ' WS-ABEND-FILE-STATUS            ELCABEND
   710                                 UPON CONSOLE.                    ELCABEND
   711                                                                  ELCABEND
   712     IF WS-RETURN-CODE NOT = ZERO                                 ELCABEND
   713         DISPLAY 'RETURN CODE = '  WS-RETURN-CODE                 ELCABEND
   714         DISPLAY 'RETURN CODE = '  WS-RETURN-CODE                 ELCABEND
   715                                 UPON CONSOLE.                    ELCABEND
   716                                                                  ELCABEND
   717     DISPLAY 'PROGRAM WILL NOW ABEND **************'              ELCABEND
   718     DISPLAY 'PROGRAM WILL NOW ABEND **************'              ELCABEND
   719                                 UPON CONSOLE.                    ELCABEND
   720                                                                  ELCABEND
   721     DIVIDE WS-ZERO BY WS-ZERO GIVING WS-ZERO.                    ELCABEND
   722     CALL 'ABORTME'.
   723                                                                  ELCABEND
   724 APS-EXIT.                                                        ELCABEND
   725     EXIT.                                                        ELCABEND
   726
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:        2628     Code:        2010
