* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   1
* ECS0561.cbl
* Options: int("ECS0561.int") anim csi verbose NOBOUND PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("ECS0561.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"ebmlsfile" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" NOCHECKDIV NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"32" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"ECS0561.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"ECS0561.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR NOSTICKY-LINKAGE
*          NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"2" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2 PROGRAM-ID.    ECS0561.
     3 AUTHOR.        CENTRAL STATES HEALTH AND LIFE.
     4 DATE-COMPILED. 06-Oct-15 17:18.
     6*REMARKS.
     7******************************************************************
     8*                   C H A N G E   L O G
     9*
    10* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    11*-----------------------------------------------------------------
    12*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    13* EFFECTIVE    NUMBER
    14*-----------------------------------------------------------------
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   2
* ECS0561.cbl
    15* 080309  2009010500003    PEMA  CHECK FOR NON 0 B4 DIVIDE
    16******************************************************************
    18 ENVIRONMENT DIVISION.
    19 INPUT-OUTPUT SECTION.
    20 FILE-CONTROL.
    21
    22     SELECT DISK-DATE            ASSIGN TO SYS019.
    23     SELECT PRINTX               ASSIGN TO SYS008.
    24     SELECT FICH                 ASSIGN TO SYS020.
    25     SELECT ERDUEP               ASSIGN TO ERDUEP
    26            ACCESS IS DYNAMIC
    27            ORGANIZATION IS INDEXED
    28            FILE STATUS IS ERDUEP-FILE-STATUS
    29            RECORD KEY IS DP-CONTROL-PRIMARY.
    30
    31     SELECT FREEDOM-EXTRACT      ASSIGN TO SYS012
    32        ORGANIZATION IS LINE SEQUENTIAL.
    33
    34 DATA DIVISION.
    35 FILE SECTION.
    36
    37
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   3
* ECS0561.cbl
    39 FD  DISK-DATE
*   40                                 COPY ELCDTEFD.
    41******************************************************************04/15/98
    42*                                                                *ELCDTEFD
    43*                                                                *ELCDTEFD
    44*                            ELCDTEFD.                           *   LV002
    45*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
    46*                            VMOD=2.007                          *   CL**2
    47*                                                                *ELCDTEFD
    48******************************************************************ELCDTEFD
    49     BLOCK CONTAINS 0 RECORDS
    50     RECORDING MODE F.                                            ELCDTEFD
    51                                                                  ELCDTEFD
    52 01  DATE-DISK.                                                   ELCDTEFD
    53     12  DD-ID                       PIC  X(4).                   ELCDTEFD
    54     12  FILLER                      PIC  X(14).                  ELCDTEFD
    55     12  DD-CR1                      PIC  9.                      ELCDTEFD
    56     12  DD-CR1N                     PIC  X(30).                  ELCDTEFD
    57     12  DD-CR2                      PIC  9.                      ELCDTEFD
    58     12  DD-CR2N                     PIC  X(30).                  ELCDTEFD
    59     12  FILLER                      PIC  X(20).                  ELCDTEFD
    60                                                                  ELCDTEFD
    61 01  DATE-DISK-R.                                                 ELCDTEFD
    62     12  FILLER                      PIC  X(4).                   ELCDTEFD
    63     12  DD-ST           OCCURS 3 TIMES                           ELCDTEFD
    64                                     PIC  X(32).                  ELCDTEFD
    65                                                                  ELCDTEFD
    66 01  DATE-DISK-T.                                                 ELCDTEFD
    67     12  FILLER                      PIC  X(4).                   ELCDTEFD
    68     12  DD-TYPE         OCCURS 2 TIMES                           ELCDTEFD
    69                                     PIC  X(48).                  ELCDTEFD
    70                                                                  ELCDTEFD
    71 01  DATE-DISK-M.                                                 ELCDTEFD
    72     12  FILLER                      PIC  X(4).                   ELCDTEFD
    73     12  DD-MORT         OCCURS 2 TIMES                           ELCDTEFD
    74                                     PIC  X(48).                  ELCDTEFD
    75                                                                  ELCDTEFD
    76 01  DATE-DISK-P.                                                 ELCDTEFD
    77     12  DD-IDA                      PIC  XX.                     ELCDTEFD
    78     12  DD-IDX                      PIC  99.                     ELCDTEFD
    79     12  DD-DATA                     PIC  X(96).                  ELCDTEFD
    80     12  FILLER  REDEFINES DD-DATA.                               ELCDTEFD
    81         16  DD-PS-PIC   OCCURS 50 TIMES                          ELCDTEFD
    82                                     PIC  X.                      ELCDTEFD
    83         16  FILLER                  PIC  X(46).                  ELCDTEFD
    84     12  FILLER  REDEFINES DD-DATA.                               ELCDTEFD
    85         16  DD-PS-PICO  OCCURS 20 TIMES.                         ELCDTEFD
    86             20  DD-PS-PRT           PIC  X.                      ELCDTEFD
    87             20  DD-PS-FMT           PIC  X.                      ELCDTEFD
    88             20  DD-PS-PRC           PIC  X.                      ELCDTEFD
    89             20  DD-PS-TOT           PIC  X.                      ELCDTEFD
    90         16  FILLER                  PIC  X(16).                  ELCDTEFD
    91                                                                  ELCDTEFD
    92 01  DATE-DISK-E.                                                 ELCDTEFD
    93     12  FILLER                      PIC  X(4).                   ELCDTEFD
    94     12  DD-EDIT         OCCURS 24 TIMES                          ELCDTEFD
    95                                     PIC  X(4).                   ELCDTEFD
    96                                                                  ELCDTEFD
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   4
* ECS0561.cbl (/apps/prod/cid1p/copy/ELCDTEFD)
    97 01  DATE-DISK-C.                                                 ELCDTEFD
    98     12  FILLER                      PIC  X(7).                   ELCDTEFD
    99     12  DD-CARR1-SECPAY-SW          PIC  X.
   100     12  DD-CARR1-UEP-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   101     12  DD-CARR1-R78-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   102     12  DD-CARR1-PRO-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   103     12  DD-CARR1                    PIC  X.                      ELCDTEFD
   104     12  DD-CARR1S                   PIC  XX.                     ELCDTEFD
   105     12  DD-CARR1N                   PIC  X(30).                  ELCDTEFD
   106     12  DD-CARR2                    PIC  X.                      ELCDTEFD
   107     12  DD-CARR2S                   PIC  XX.                     ELCDTEFD
   108     12  DD-CARR2N                   PIC  X(30).                  ELCDTEFD
   109     12  DD-CARR2-UEP-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   110     12  DD-CARR2-R78-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   111     12  DD-CARR2-PRO-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   112     12  DD-CARR2-SECPAY-SW          PIC  X.
   113     12  FILLER                      PIC  X(7).                   ELCDTEFD
   114                                                                  ELCDTEFD
   115 01  DATE-DISK-OPT.                                               ELCDTEFD
   116     12  FILLER                      PIC  X(04).                  ELCDTEFD
   117     12  DD-TLR-DATA.                                             ELCDTEFD
   118         16  DD-TLR                  OCCURS 32 TIMES              ELCDTEFD
   119                                     PIC  X(03).                  ELCDTEFD
   120     12  DD-STATE-DATA REDEFINES DD-TLR-DATA.                     ELCDTEFD
   121         16  DD-STATE-FLDS           OCCURS 16 TIMES              ELCDTEFD
   122                                     PIC  X(06).                  ELCDTEFD
   123     12  DD-CARR-DATA REDEFINES DD-TLR-DATA.                      ELCDTEFD
   124         16  DD-CARR-FLDS            OCCURS 13 TIMES              ELCDTEFD
   125                                     PIC  X(07).                  ELCDTEFD
   126         16  FILLER                  PIC  X(05).                  ELCDTEFD
   127     12  DD-MISC-DATA REDEFINES DD-TLR-DATA                       ELCDTEFD
   128                                     PIC  X(96).                  ELCDTEFD
   129******************************************************************ELCDTEFD
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   5
* ECS0561.cbl
   131 FD  PRINTX
*  132                                 COPY ELCPRTFD.
   133******************************************************************04/15/98
   134*                                                                *ELCPRTFD
   135*                                                                *ELCPRTFD
   136*                            ELCPRTFD.                           *   LV003
   137*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
   138*                            VMOD=2.006                          *ELCPRTFD
   139******************************************************************ELCPRTFD
   140     RECORDING MODE F                                             ELCPRTFD
   141     LABEL RECORDS OMITTED                                        ELCPRTFD
   142     BLOCK CONTAINS 0 RECORDS
   143     RECORD CONTAINS 133 CHARACTERS.                              ELCPRTFD
   144 01  PRT.                                                         ELCPRTFD
   145     12  P-CTL               PIC  X.                                 CL**2
   146     12  P-DATA              PIC  X(132).                         ELCPRTFD
   147******************************************************************ELCPRTFD
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   6
* ECS0561.cbl
   149 FD  FICH
*  150                                 COPY ELCFCHFD.
   151******************************************************************04/15/98
   152*                                                                *ELCFCHFD
   153*                            ELCFCHFD.                           *   LV003
   154*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
   155*                            VMOD=2.004                          *   CL**3
   156*                                                                *ELCFCHFD
   157******************************************************************ELCFCHFD
   158     BLOCK CONTAINS 0 RECORDS
   159     RECORDING MODE F.                                            ELCFCHFD
   160                                                                  ELCFCHFD
   161 01  FICH-REC                            PIC   X(133).            ELCFCHFD
   162******************************************************************ELCFCHFD
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   7
* ECS0561.cbl
   164 FD  ERDUEP.
*  165                                 COPY ERCDUEP.
   166******************************************************************
   167*                                                                *
   168*                                                                *
   169*                            ERCDUEP                             *
   170*                            VMOD=2.001                          *
   171*                                                                *
   172*   ONLINE CREDIT SYSTEM                                         *
   173*                                                                *
   174*   FILE DESCRIPTION = DUE PREMIUM MASTER                        *
   175*                                                                *
   176*   FILE TYPE = VSAM,KSDS                                        *
   177*   RECORD SIZE = 512   RECFORM = FIXED                          *
   178*                                                                *
   179*   BASE CLUSTER NAME = ERDUEP                   RKP=2,LEN=26    *
   180*       ALTERNATE PATH = NONE                                    *
   181*                                                                *
   182*   LOG = NO                                                     *
   183*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
   184*                                                                *
   185******************************************************************
   186
   187 01  DUE-PREMIUM-RECORD.
   188     12  DP-RECORD-ID                          PIC XX.
   189         88  VALID-DP-ID                          VALUE 'DP'.
   190
   191     12  DP-CONTROL-PRIMARY.
   192         16  DP-COMPANY-CD                     PIC X.
   193         16  DP-CONTROL.
   194             20  DP-ACCOUNT-CONTROL.
   195                 24  DP-CARRIER                PIC X.
   196                 24  DP-GROUPING               PIC X(6).
   197                 24  DP-STATE                  PIC XX.
   198                 24  DP-ACCOUNT                PIC X(10).
   199             20  DP-KEY-FILLER                 PIC X(6).
   200
   201     12  DP-MAINT-INFORMATION.
   202         16  DP-LAST-MONTH-END-DT              PIC XX.
   203         16  DP-LAST-MAINT-DT                  PIC XX.
   204         16  DP-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
   205         16  DP-LAST-MAINT-USER                PIC X(4).
   206         16  FILLER                            PIC X(10).
   207
   208     12  DP-FUTURE-SPACE                       PIC X(5).
   209         88  DP-FUTURE-NOT-USED                   VALUE '     '.
   210
   211     12  DP-LAST-EOM-STMT-DT                   PIC XX.
   212
   213     12  DP-LAST-ACTIVITY-DATE.
   214         16  DP-ACT-YEAR                       PIC 99.
   215         16  DP-ACT-MONTH                      PIC 99.
   216         16  DP-ACT-DAY                        PIC 99.
   217
   218     12  DP-MO-END-TOTALS.
   219         16  DP-MONTHLY-TOTALS.
   220             20  DP-BAL-FWD                PIC S9(7)V99   COMP-3.
   221             20  DP-EXP-PREM               PIC S9(7)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   8
* ECS0561.cbl (/apps/prod/cid1p/copy/ERCDUEP)
   222             20  DP-REC-PREM               PIC S9(7)V99   COMP-3.
   223             20  DP-ADJUSTMENTS            PIC S9(7)V99   COMP-3.
   224             20  DP-BASE-COMM              PIC S9(7)V99   COMP-3.
   225             20  DP-GA-COMM                PIC S9(7)V99   COMP-3.
   226             20  DP-END-BAL                PIC S9(7)V99   COMP-3.
   227
   228         16  DP-AGING-TOTALS.
   229             20  DP-CUR                    PIC S9(7)V99   COMP-3.
   230             20  DP-OV30                   PIC S9(7)V99   COMP-3.
   231             20  DP-OV60                   PIC S9(7)V99   COMP-3.
   232             20  DP-OV90                   PIC S9(7)V99   COMP-3.
   233
   234     12  FILLER                                PIC X(394).
   235
   236******************************************************************
   237
   238 FD  FREEDOM-EXTRACT
   239     LABEL RECORDS ARE STANDARD
   240     RECORDING MODE IS F
   241     BLOCK CONTAINS 0 RECORDS.
   242 01  FREEDOM-RECORD      PIC X(250).
   243
   244 WORKING-STORAGE SECTION.
   245 77  FILLER  PIC X(32) VALUE '********************************'.
   246 77  FILLER  PIC X(32) VALUE '      ECS0561 WORKING STORAGE   '.
   247 77  FILLER  PIC X(32) VALUE '********************************'.
   248
   249 77  WS-EOF-SW                   PIC X  VALUE SPACES.
   250     88  END-OF-ERDUEP              VALUE 'Y'.
   251     88  MORE-ERDUEP                VALUE 'N'.
   252 77  WS-A                       PIC S9(03) COMP-3 VALUE +0.
   253 77  IYR                         PIC S9(03) COMP-3 VALUE +0.
   254 77  VYR                         PIC S9(03) COMP-3 VALUE +0.
   255 77  PAGE-CTR                    PIC S9(07) VALUE +0  COMP-3.
   256 77  LINE-CTR                    PIC S9(03) VALUE +99 COMP-3.
   257 77  SPACE-NP                    PIC X      VALUE '1'.
   258 77  SPACE-1                     PIC X      VALUE ' '.
   259 77  SPACE-2                     PIC X      VALUE '0'.
   260 77  SPACE-3                     PIC X      VALUE '-'.
   261 77  X                           PIC X      VALUE ' '.
   262 77  LNCTR                       PIC S999   VALUE +60 COMP-3.
   263 77  PGCTR                       PIC S9(5)  VALUE +0 COMP-3.
   264 77  ERDUEP-IN-CNT               PIC 9(11)   VALUE ZEROS.
   265 77  WS-BASE-PCT                 PIC S9V9(5) COMP-3 VALUE +0.
   266 77  WS-OW-PCT                   PIC S9V9(5) COMP-3 VALUE +0.
   267 77  WS-DUE-COMM                 PIC S9(9)V99 COMP-3 VALUE +0.
   268
   269 01  HD1.
   270     12  FILLER              PIC  X(44)      VALUE SPACES.
   271     12  FILLER              PIC  X(44)      VALUE
   272             '        DUE PREMIUM AND COMMISSION         '.
   273     12  FILLER              PIC  X(31)      VALUE SPACES.
   274     12  FILLER              PIC  X(08)      VALUE 'ECS0561'.
   275
   276 01  HD2.
   277     12  FILLER              PIC  X(51)      VALUE SPACES.
   278     12  HD-CO               PIC  X(30).
   279     12  FILLER              PIC  X(38)      VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   9
* ECS0561.cbl
   280     12  HD-RUN-DT           PIC  X(08)      VALUE SPACES.
   281
   282 01  HD3.
   283     12  FILLER              PIC  X(57)      VALUE SPACES.
   284     12  HD-DT               PIC  X(18).
   285     12  FILLER              PIC  X(44)      VALUE SPACES.
   286     12  FILLER              PIC  X(05)      VALUE 'PAGE '.
   287     12  HD-PG               PIC ZZ,ZZ9.
   288
   289 01  HD4.
   290     12  FILLER              PIC  X(45)      VALUE
   291             '-- ACCOUNT TOTALS  --       BEGINNING   EXPEC'.
   292     12  FILLER              PIC  X(46)      VALUE
   293             'TED   RECEIVED                ENDING          '.
   294     12  FILLER              PIC  X(41)      VALUE
   295             '                    DUE      NO OF       '.
   296
   297 01  HD5.
   298     12  FILLER              PIC  X(45)      VALUE
   299             '--CAR GROUP  ST  ACCOUNT---  BALANCE    PREMI'.
   300     12  FILLER              PIC  X(46)      VALUE
   301             'UMS   PREMIUMS  ADJUSTMENTS   BALANCE      < 9'.
   302     12  FILLER              PIC  X(41)      VALUE
   303             '0        > 90   COMMISSION   MONTHS      '.
   304 01  DETAIL-LINE.
   305     05  FILLER                  PIC X(4).
   306     05  DTL1-CAR                PIC X.
   307     05  FILLER                  PIC X.
   308     05  DTL1-GRP                PIC X(6).
   309     05  FILLER                  PIC X.
   310     05  DTL1-ST                 PIC XX.
   311     05  FILLER                  PIC X.
   312     05  DTL1-ACCT               PIC X(10).
   313     05  FILLER                  PIC X.
   314     05  DTL1-BEG-BAL            PIC ZZZ,ZZ9.99-.
   315     05  FILLER                  PIC X.
   316     05  DTL1-EXP-PREM           PIC ZZZ,ZZ9.99.
   317     05  FILLER                  PIC X.
   318     05  DTL1-REC-PREM           PIC ZZZ,ZZ9.99.
   319     05  FILLER                  PIC X.
   320     05  DTL1-ADJS               PIC ZZZ,ZZ9.99-.
   321     05  FILLER                  PIC X.
   322     05  DTL1-END-BAL            PIC ZZZ,ZZ9.99-.
   323     05  FILLER                  PIC X.
   324     05  DTL1-DUE-LT90           PIC ZZZ,ZZ9.99-.
   325     05  FILLER                  PIC X.
   326     05  DTL1-DUE-GT90           PIC ZZZ,ZZ9.99-.
   327     05  FILLER                  PIC X.
   328     05  DTL1-COMM               PIC ZZZ,ZZ9.99-.
   329     05  FILLER                  PIC X(4).
   330     05  DTL1-NO-MOS             PIC ZZ9.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  10
* ECS0561.cbl
   332 01  WS-DUE-PREM-TABLE.
   333     05  WS-RECORD.
   334         10  WS-CAR              PIC X.
   335         10  WS-GROUP            PIC X(6).
   336         10  WS-STATE            PIC XX.
   337         10  WS-ACCOUNT          PIC X(10).
   338         10  WS-EFF-DATE         PIC X(10).
   339         10  WS-CERT-NO          PIC X(11).
   340         10  WS-LF-BEN-CODE      PIC XX.
   341         10  WS-AH-BEN-CODE      PIC XX.
   342         10  WS-LF-TERM          PIC ZZ9.
   343         10  WS-AH-TERM          PIC ZZ9.
   344         10  WS-LF-EXP-DATE      PIC X(10).
   345         10  WS-AH-EXP-DATE      PIC X(10).
   346         10  WS-EXP-PREM         PIC S9(9)V99 COMP-3 VALUE +0.
   347         10  WS-REC-PREM         PIC S9(9)V99 COMP-3 VALUE +0.
   348         10  WS-BASE-COMM        PIC S9(7)V99 COMP-3 VALUE +0.
   349         10  WS-GA-COMM          PIC S9(7)V99 COMP-3 VALUE +0.
   350         10  WS-MISC1            PIC S9(7)V99 COMP-3 VALUE +0.
   351         10  WS-MISC2            PIC S9(7)V99 COMP-3 VALUE +0.
   352         10  WS-MISC3            PIC S9(7)V99 COMP-3 VALUE +0.
   353         10  WS-MISC4            PIC S9(7)V99 COMP-3 VALUE +0.
   354         10  WS-MISC5            PIC S9(7)V99 COMP-3 VALUE +0.
   355
   356 01  WS-MISC.
   357     05  ERDUEP-FILE-STATUS      PIC XX.
   358     05  WS-HOLD-PRT             PIC X(133).
   359     05  WS-DUEP-CONTROL         PIC X(19)    VALUE LOW-VALUES.
   360     05  WS-HOLD-CONTROL.
   361         10  WS-HOLD-CAR         PIC X.
   362         10  WS-HOLD-GRP         PIC X(6).
   363         10  WS-HOLD-ST          PIC XX.
   364         10  WS-HOLD-ACCT        PIC X(10).
   365     05  INTERMED                PIC S9(9)V9(6)  COMP-3.
   366     05  WS-REM-AMT              PIC S9(11)V99 COMP-3 VALUE +0.
   367     05  WS-DISPLAY-DATE         PIC ZZZ9(8).
   368     05  WS-DISPLAY-TERM         PIC Z99.
   369     05  WS-DISPLAY-RTERM        PIC Z99.99.
   370     05  WS-DISPLAY-AMT          PIC ZZZZZZZ.99.
   371     05  WS-DISPLAY-RAMT         PIC ZZZZZZZ.99.
   372     05  WS-DISPLAY-PRM          PIC ZZZZZZZ.99.
   373     05  WS-DISPLAY-UEP          PIC ZZZZZZZ.99.
   374     05  WS-BIN-CR-DT            PIC XX  VALUE LOW-VALUES.
   375     05  WS-BIN-LF-END-DATE      PIC XX  VALUE LOW-VALUES.
   376     05  WS-BIN-AH-END-DATE      PIC XX  VALUE LOW-VALUES.
   377     05  WS-END-YEAR             PIC 9(11)  VALUE ZEROS.
   378     05  FILLER REDEFINES WS-END-YEAR.
   379         10  WS-CCYY             PIC 9(7).
   380         10  WS-MMDD             PIC 9(4).
   381 01  WS-DEBUG-AREA.
   382     12  WS-DEBUG-SW             PIC X(01) VALUE ' '.
   383         88  DEBUG-IS-ON                VALUES '1' '2' '3' '4'.
   384         88  DEBUG-LF-INFORCE-CNT       VALUE '1'.
   385         88  DEBUG-AH-INFORCE-CNT       VALUE '2'.
   386         88  DEBUG-LF-STATUTORY         VALUE '3'.
   387         88  DEBUG-AH-STATUTORY         VALUE '4'.
   388
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  11
* ECS0561.cbl
   390
   391
   392 01  WS-ABEND-AREA.
   393     05  WS-ABEND-FILE-STATUS    PIC X(02).
   394     05  WS-ABEND-MESSAGE        PIC X(80) VALUE SPACES.
   395     05  WS-RETURN-CODE          PIC S9(04)  COMP VALUE +0.
   396     05  WS-ZERO                 PIC S9(01) VALUE +0 COMP-3.
   397
   398 01  WORK-ABEND-CODE.
   399     12  WAC-1                   PIC X.
   400     12  WAC-2                   PIC X.
   401     12  WAC-3-4.
   402         16  WAC-3               PIC X.
   403         16  WAC-4               PIC X.
   404
   405 01  WS-EXTRACT-RECORD.
*  406                                 COPY FNC022.
   407     05  FX-COMMON-SECTION.                                       00010001
   408         10  FX-SYSTEM             PIC X(10).                     00020001
   409         10  FX-SOURCE-CODE        PIC X(6).                      00030001
   410         10  FX-DIVISION           PIC X(2).                      00040001
   411         10  FX-TRAN-TYPE          PIC X(2).                      00050001
   412         10  FX-SUB-TYPE           PIC X(2).                      00060001
   413         10  FX-CLM-RES            PIC X(2).                      00070001
   414         10  FX-ANN-STMT           PIC X(3).                      00080001
   415         10  FX-PLAN-CODE          PIC X(6).                      00090001
   416         10  FX-FORM               PIC X(3).                      00091001
   417         10  FX-JOURNAL-DATE       PIC X(8).                      00092001
   418         10  FX-POSTING-DATE       PIC X(8).                      00093001
   419         10  FX-POLICY-NO          PIC X(10).                     00094001
   420         10  FX-CITY               PIC X(30).                     00095002
   421         10  FX-STATE              PIC X(2).                      00095102
   422         10  FX-ZIP-CODE           PIC X(9).                      00096001
   423         10  FX-LOC-CODE           PIC X.                         00096102
   424         10  FX-FY-REN             PIC X.                         00097001
   425         10  FX-AGENT-01           PIC X(9).                      00098001
   426         10  FX-AGENT-50           PIC X(9).                      00099001
   427         10  FX-COST-CENTER        PIC X(4).                      00100001
   428         10  FX-TAXABLE            PIC X.                         00110004
   429         10  FX-DISTR              PIC X(2).                      00120001
   430         10  FX-SOURCE-ACCT        PIC X(10).                     00130001
   431         10  FX-DESCRIPTION        PIC X(30).                     00140001
   432         10  FX-REFERENCE          PIC X(10).                     00150001
   433         10  FX-SUSPENSE           PIC X(15).                     00151002
   434         10  FX-AMOUNT             PIC S9(10)V99                  00160001
   435                                   SIGN IS TRAILING SEPARATE.     00170001
   436                                                                  00180001
   437     05  FX-CLAIM-SECTION.                                        00190001
   438         10  FX-CLAIM-NO           PIC X(10).                     00200001
   439         10  FX-CLAIM-TYPE         PIC X.                         00210001
   440         10  FX-DRAFT-NO           PIC X(10).                     00220001
   441         10  FX-DRAFT-STATUS       PIC X.                         00230001
   442         10  FX-TAX-ID             PIC X(10).                     00240001
   443         10  FILLER                PIC X(10).                     00250003
   444                                                                  00290001
   445
   446
   447 01  DATE-AREAS.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  12
* ECS0561.cbl
   448     05  WS-TEST-RUN-DATE        PIC 9(11).
   449     05  WS-WORK-DATE            PIC 9(11).
   450     05  FILLER REDEFINES WS-WORK-DATE.
   451         10  FILLER              PIC XXX.
   452         10  WS-WORK-CCYY        PIC 9(4).
   453         10  WS-WORK-MMDD        PIC 9(4).
   454     05  WS-ISSUE-DATE           PIC 9(11).
   455     05  FILLER REDEFINES WS-ISSUE-DATE.
   456         10  FILLER              PIC XXX.
   457         10  WS-ISSUE-CCYY       PIC 9(4).
   458         10  WS-ISSUE-MMDD       PIC 9(4).
   459     05  WS-EXPIRE-DATE          PIC 9(11).
   460     05  FILLER REDEFINES WS-EXPIRE-DATE.
   461         10  FILLER              PIC XXX.
   462         10  WS-EXPIRE-CCYY      PIC 9(4).
   463         10  WS-EXPIRE-MMDD      PIC 9(4).
   464     05  WS-ENTRY-DATE           PIC 9(11).
   465     05  FILLER REDEFINES WS-ENTRY-DATE.
   466         10  FILLER              PIC XXX.
   467         10  WS-ENTRY-CCYY       PIC 9(4).
   468         10  WS-ENTRY-MMDD       PIC 9(4).
   469     05  WS-CANCEL-DATE          PIC 9(11).
   470     05  FILLER REDEFINES WS-CANCEL-DATE.
   471         10  FILLER              PIC XXX.
   472         10  WS-CANCEL-CCYY      PIC 9(4).
   473         10  WS-CANCEL-MMDD      PIC 9(4).
   474     05  WS-CLAIM-DATE           PIC 9(11).
   475     05  FILLER REDEFINES WS-CLAIM-DATE.
   476         10  FILLER              PIC XXX.
   477         10  WS-CLAIM-CCYY       PIC 9(4).
   478         10  WS-CLAIM-MMDD       PIC 9(4).
   479     05  WS-POSTING-DATE         PIC X(8).
   480     05  WS-HI-ISSUE-CCYY        PIC 9(4) VALUE ZEROS.
   481     05  WS-LO-ISSUE-CCYY        PIC 9(4) VALUE ZEROS.
   482     05  WS-HI-VALUATION-CCYY    PIC 9(4) VALUE ZEROS.
   483     05  WS-LO-VALUATION-CCYY    PIC 9(4) VALUE ZEROS.
   484     05  WS-BIN-VAL-DATES OCCURS 50
   485                                 PIC XX.
   486
   487 01  WS-MISC-AREA.
   488     12  WS-FREEDOM-TABLE.
   489         16  FILLER OCCURS       55.
   490             20  WS-FREE-STATE   PIC XX.
   491             20  WS-FREE-PREM    PIC S9(9)V99 COMP-3 VALUE +0.
   492             20  WS-FREE-COMM    PIC S9(9)V99 COMP-3 VALUE +0.
   493     12  WS-DP-EXP-PREM          PIC S9(9)V99 COMP-3 VALUE +0.
   494     12  WS-DP-REC-PREM          PIC S9(9)V99 COMP-3 VALUE +0.
   495     12  WS-DP-GA-COMM           PIC S9(9)V99 COMP-3 VALUE +0.
   496     12  WS-DP-BASE-COMM         PIC S9(9)V99 COMP-3 VALUE +0.
   497*   1ST OCCURANCE           ACCOUNT TOTALS
   498*   2ND                     STATE
   499*   3RD                     GROUP
   500*   4TH                     CARRIER
   501*   5TH                     FINAL
   502     12  WS-TOTAL-TABLE OCCURS 5.
   503         16  WS-TOT-BAL-FWD      PIC S9(9)V99 COMP-3 VALUE +0.
   504         16  WS-TOT-EXP-PREM     PIC S9(9)V99 COMP-3 VALUE +0.
   505         16  WS-TOT-REC-PREM     PIC S9(9)V99 COMP-3 VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  13
* ECS0561.cbl
   506         16  WS-TOT-GA-COMM      PIC S9(9)V99 COMP-3 VALUE +0.
   507         16  WS-TOT-BASE-COMM    PIC S9(9)V99 COMP-3 VALUE +0.
   508         16  WS-TOT-ADJS         PIC S9(9)V99 COMP-3 VALUE +0.
   509         16  WS-TOT-END-BAL      PIC S9(9)V99 COMP-3 VALUE +0.
   510         16  WS-TOT-DUE-COMM     PIC S9(9)V99 COMP-3 VALUE +0.
   511     12  WS-DISPLAY-FLD          PIC 9(9).9(5).
   512     12  WS-LF-PRM               PIC S9(7)V99 COMP-3  VALUE +0.
   513     12  WS-AH-PRM               PIC S9(7)V99 COMP-3  VALUE +0.
   514
   515
   516 01  ABEND-FIELDS.
   517     12  PGM-SUB                 PIC S999 COMP  VALUE +064.
   518     12  FIRST-TIME-SW           PIC X  VALUE 'Y'.
   519         88  FIRST-TIME                 VALUE 'Y'.
   520
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  14
* ECS0561.cbl
*  522                                 COPY ELCDATE.
   523******************************************************************06/11/98
   524*                                                                *ELCDATE
   525*                                                                *ELCDATE
   526*                            ELCDATE.                            *   LV023
   527*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL*16
   528*                            VMOD=2.003                           ELCDATE
   529*                                                                *ELCDATE
   530*                                                                *ELCDATE
   531*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *ELCDATE
   532*                 LENGTH = 200                                   *   CL*19
   533******************************************************************ELCDATE
   534                                                                  ELCDATE
   535 01  DATE-CONVERSION-DATA.                                        ELCDATE
   536     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.    CL*19
   537     12  DC-OPTION-CODE                PIC X.                        CL*15
   538         88  BIN-TO-GREG                VALUE ' '.                ELCDATE
   539         88  ELAPSED-BETWEEN-BIN        VALUE '1'.                ELCDATE
   540         88  EDIT-GREG-TO-BIN           VALUE '2'.                ELCDATE
   541         88  YMD-GREG-TO-BIN            VALUE '3'.                ELCDATE
   542         88  MDY-GREG-TO-BIN            VALUE '4'.                ELCDATE
   543         88  JULIAN-TO-BIN              VALUE '5'.                ELCDATE
   544         88  BIN-PLUS-ELAPSED           VALUE '6'.                ELCDATE
   545         88  FIND-CENTURY               VALUE '7'.                   CL*22
   546         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.                ELCDATE
   547         88  EDIT-GREG-TO-BIN-3         VALUE '9'.                ELCDATE
   548         88  YMD-GREG-TO-BIN-3          VALUE 'A'.                ELCDATE
   549         88  MDY-GREG-TO-BIN-3          VALUE 'B'.                ELCDATE
   550         88  JULIAN-TO-BIN-3            VALUE 'C'.                ELCDATE
   551         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.                ELCDATE
   552         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.                   CL*14
   553         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.                   CL*14
   554         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.                   CL*14
   555         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.         CL*14
   556         88  CHECK-LEAP-YEAR            VALUE 'H'.                   CL*14
   557         88  BIN-3-TO-GREG              VALUE 'I'.                   CL*14
   558         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.                   CL*14
   559         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.                   CL*14
   560         88  CYMD-GREG-TO-BIN           VALUE 'L'.                   CL*14
   561         88  MDCY-GREG-TO-BIN           VALUE 'M'.                   CL*14
   562         88  MDY-GREG-TO-JULIAN         VALUE 'N'.                   CL*14
   563         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.                   CL*14
   564         88  YMD-GREG-TO-JULIAN         VALUE 'P'.                   CL*14
   565         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.                   CL*14
   566         88  THREE-CHARACTER-BIN                                  ELCDATE
   567                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.       CL*14
   568         88  GREGORIAN-TO-BIN                                        CL**2
   569                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.    CL*14
   570         88  BIN-TO-GREGORIAN                                        CL**2
   571                  VALUES ' ' '1' 'I' '8' 'G'.                        CL*14
   572         88  JULIAN-TO-BINARY                                        CL**2
   573                  VALUES '5' 'C' 'E' 'F'.                            CL*14
   574     12  DC-ERROR-CODE                 PIC X.                        CL*15
   575         88  NO-CONVERSION-ERROR        VALUE ' '.                   CL**3
   576         88  DATE-CONVERSION-ERROR                                ELCDATE
   577                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.        CL*14
   578         88  DATE-IS-ZERO               VALUE '1'.                ELCDATE
   579         88  DATE-IS-NON-NUMERIC        VALUE '2'.                ELCDATE
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  15
* ECS0561.cbl (/apps/prod/cid1p/copy/ELCDATE)
   580         88  DATE-IS-INVALID            VALUE '3'.                ELCDATE
   581         88  DATE1-GREATER-DATE2        VALUE '4'.                ELCDATE
   582         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.                ELCDATE
   583         88  DATE-INVALID-OPTION        VALUE '9'.                ELCDATE
   584         88  INVALID-CENTURY            VALUE 'A'.                ELCDATE
   585         88  ONLY-CENTURY               VALUE 'B'.                ELCDATE
   586         88  ONLY-LEAP-YEAR             VALUE 'C'.                ELCDATE
   587         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.              CL**3
   588     12  DC-END-OF-MONTH               PIC X.                        CL*15
   589         88  CALCULATE-END-OF-MONTH     VALUE '1'.                ELCDATE
   590     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.         CL*15
   591         88  USE-NORMAL-PROCESS         VALUE ' '.                ELCDATE
   592         88  ADJUST-DOWN-100-YRS        VALUE '1'.                ELCDATE
   593         88  ADJUST-UP-100-YRS          VALUE '2'.                ELCDATE
   594     12  FILLER                        PIC X.                        CL*15
   595     12  DC-CONVERSION-DATES.                                        CL*15
   596         16  DC-BIN-DATE-1             PIC XX.                       CL*15
   597         16  DC-BIN-DATE-2             PIC XX.                       CL*15
   598         16  DC-GREG-DATE-1-EDIT       PIC X(08).                    CL*15
   599         16  DC-GREG-DATE-1-EDIT-R REDEFINES                         CL*15
   600                       DC-GREG-DATE-1-EDIT.                       ELCDATE
   601             20  DC-EDIT1-MONTH        PIC 99.                       CL*15
   602             20  SLASH1-1              PIC X.                        CL*15
   603             20  DC-EDIT1-DAY          PIC 99.                       CL*15
   604             20  SLASH1-2              PIC X.                        CL*15
   605             20  DC-EDIT1-YEAR         PIC 99.                       CL*15
   606         16  DC-GREG-DATE-2-EDIT       PIC X(08).                    CL*15
   607         16  DC-GREG-DATE-2-EDIT-R REDEFINES                         CL*15
   608                     DC-GREG-DATE-2-EDIT.                         ELCDATE
   609             20  DC-EDIT2-MONTH        PIC 99.                       CL*15
   610             20  SLASH2-1              PIC X.                        CL*15
   611             20  DC-EDIT2-DAY          PIC 99.                       CL*15
   612             20  SLASH2-2              PIC X.                        CL*15
   613             20  DC-EDIT2-YEAR         PIC 99.                       CL*15
   614         16  DC-GREG-DATE-1-YMD        PIC 9(06).                    CL*15
   615         16  DC-GREG-DATE-1-YMD-R  REDEFINES                         CL*15
   616                     DC-GREG-DATE-1-YMD.                          ELCDATE
   617             20  DC-YMD-YEAR           PIC 99.                       CL*15
   618             20  DC-YMD-MONTH          PIC 99.                       CL*15
   619             20  DC-YMD-DAY            PIC 99.                       CL*15
   620         16  DC-GREG-DATE-1-MDY        PIC 9(06).                    CL*15
   621         16  DC-GREG-DATE-1-MDY-R REDEFINES                          CL*15
   622                      DC-GREG-DATE-1-MDY.                         ELCDATE
   623             20  DC-MDY-MONTH          PIC 99.                       CL*15
   624             20  DC-MDY-DAY            PIC 99.                       CL*15
   625             20  DC-MDY-YEAR           PIC 99.                       CL*15
   626         16  DC-GREG-DATE-1-ALPHA.                                   CL*15
   627             20  DC-ALPHA-MONTH        PIC X(10).                    CL*15
   628             20  DC-ALPHA-DAY          PIC 99.                       CL*15
   629             20  FILLER                PIC XX.                       CL*15
   630             20  DC-ALPHA-CENTURY.                                   CL*15
   631                 24 DC-ALPHA-CEN-N     PIC 99.                       CL*15
   632             20  DC-ALPHA-YEAR         PIC 99.                       CL*15
   633         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.           CL*15
   634         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.           CL*15
   635         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.           CL*15
   636         16  DC-JULIAN-DATE            PIC 9(05).                    CL*15
   637         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE                CL*20
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  16
* ECS0561.cbl (/apps/prod/cid1p/copy/ELCDATE)
   638                                       PIC 9(05).                    CL*20
   639         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.                  CL*15
   640             20  DC-JULIAN-YEAR        PIC 99.                       CL*15
   641             20  DC-JULIAN-DAYS        PIC 999.                      CL*15
   642         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.       CL*15
   643         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.    CL*15
   644         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.    CL*15
   645     12  DATE-CONVERSION-VARIBLES.                                   CL*15
   646         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.            CL*15
   647         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.          CL*15
   648             20  FILLER                PIC 9(3).                     CL*15
   649             20  HOLD-CEN-1-CCYY.                                    CL*15
   650                 24  HOLD-CEN-1-CC     PIC 99.                       CL*17
   651                 24  HOLD-CEN-1-YY     PIC 99.                       CL*17
   652             20  HOLD-CEN-1-MO         PIC 99.                       CL*17
   653             20  HOLD-CEN-1-DA         PIC 99.                       CL*17
   654         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.            CL*15
   655             20  HOLD-CEN-1-R-MO       PIC 99.                       CL*17
   656             20  HOLD-CEN-1-R-DA       PIC 99.                       CL*17
   657             20  HOLD-CEN-1-R-CCYY.                                  CL*15
   658                 24  HOLD-CEN-1-R-CC   PIC 99.                       CL*17
   659                 24  HOLD-CEN-1-R-YY   PIC 99.                       CL*17
   660             20  FILLER                PIC 9(3).                     CL*15
   661         16  HOLD-CENTURY-1-X.                                       CL*15
   662             20  FILLER                PIC X(3)  VALUE SPACES.       CL*15
   663             20  HOLD-CEN-1-X-CCYY.                                  CL*15
   664                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.          CL*17
   665                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.          CL*17
   666             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.          CL*17
   667             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.          CL*17
   668         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.          CL*15
   669             20  HOLD-CEN-1-R-X-MO     PIC XX.                       CL*17
   670             20  HOLD-CEN-1-R-X-DA     PIC XX.                       CL*17
   671             20  HOLD-CEN-1-R-X-CCYY.                                CL*15
   672                 24  HOLD-CEN-1-R-X-CC PIC XX.                       CL*17
   673                 24  HOLD-CEN-1-R-X-YY PIC XX.                       CL*17
   674             20  FILLER                PIC XXX.                      CL*23
   675         16  DC-BIN-DATE-EXPAND-1      PIC XXX.                      CL*15
   676         16  DC-BIN-DATE-EXPAND-2      PIC XXX.                      CL*15
   677         16  DC-JULIAN-DATE-1          PIC 9(07).                    CL*15
   678         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.          CL*15
   679             20  DC-JULIAN-1-CCYY.                                   CL*15
   680                 24  DC-JULIAN-1-CC    PIC 99.                       CL*15
   681                 24  DC-JULIAN-1-YR    PIC 99.                       CL*15
   682             20  DC-JULIAN-DA-1        PIC 999.                      CL*15
   683         16  DC-JULIAN-DATE-2          PIC 9(07).                    CL*15
   684         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.          CL*15
   685             20  DC-JULIAN-2-CCYY.                                   CL*15
   686                 24  DC-JULIAN-2-CC    PIC 99.                       CL*15
   687                 24  DC-JULIAN-2-YR    PIC 99.                       CL*15
   688             20  DC-JULIAN-DA-2        PIC 999.                      CL*15
   689         16  DC-GREG-DATE-A-EDIT.                                    CL*15
   690             20  DC-EDITA-MONTH        PIC 99.                       CL*15
   691             20  SLASHA-1              PIC X VALUE '/'.              CL*15
   692             20  DC-EDITA-DAY          PIC 99.                       CL*15
   693             20  SLASHA-2              PIC X VALUE '/'.              CL*15
   694             20  DC-EDITA-CCYY.                                      CL*15
   695                 24  DC-EDITA-CENT     PIC 99.                       CL*15
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  17
* ECS0561.cbl (/apps/prod/cid1p/copy/ELCDATE)
   696                 24  DC-EDITA-YEAR     PIC 99.                       CL*15
   697         16  DC-GREG-DATE-B-EDIT.                                    CL*15
   698             20  DC-EDITB-MONTH        PIC 99.                       CL*15
   699             20  SLASHB-1              PIC X VALUE '/'.              CL*15
   700             20  DC-EDITB-DAY          PIC 99.                       CL*15
   701             20  SLASHB-2              PIC X VALUE '/'.              CL*15
   702             20  DC-EDITB-CCYY.                                      CL*15
   703                 24  DC-EDITB-CENT     PIC 99.                       CL*15
   704                 24  DC-EDITB-YEAR     PIC 99.                       CL*15
   705         16  DC-GREG-DATE-CYMD         PIC 9(08).                    CL*15
   706         16  DC-GREG-DATE-CYMD-R REDEFINES                           CL*15
   707                              DC-GREG-DATE-CYMD.                  ELCDATE
   708             20  DC-CYMD-CEN           PIC 99.                       CL*15
   709             20  DC-CYMD-YEAR          PIC 99.                       CL*15
   710             20  DC-CYMD-MONTH         PIC 99.                       CL*15
   711             20  DC-CYMD-DAY           PIC 99.                       CL*15
   712         16  DC-GREG-DATE-MDCY         PIC 9(08).                    CL*15
   713         16  DC-GREG-DATE-MDCY-R REDEFINES                           CL*15
   714                              DC-GREG-DATE-MDCY.                  ELCDATE
   715             20  DC-MDCY-MONTH         PIC 99.                       CL*15
   716             20  DC-MDCY-DAY           PIC 99.                       CL*15
   717             20  DC-MDCY-CEN           PIC 99.                       CL*15
   718             20  DC-MDCY-YEAR          PIC 99.                       CL*15
   719    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.      ELCDATE
   720        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.        ELCDATE
   721    12  DC-EL310-DATE                  PIC X(21).                    CL*26
   722    12  FILLER                         PIC X(28).                    CL*26
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  18
* ECS0561.cbl
   723/
*  724                                 COPY ELCDTECX.
   725******************************************************************06/05/98
   726*                                                                *ELCDTECX
   727*                            ELCDTECX.                           *   LV005
   728*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
   729*                            VMOD=2.015                          *ELCDTECX
   730*                                                                *ELCDTECX
   731*      WORKING STORAGE COPY CODE FOR APPLICATIONS CALLING        *ELCDTECX
   732*      THE DATE CARD DISK FILE. ( READ ROUTINE = ELCDTERX,       *ELCDTECX
   733*      AND DISK FILE FD = ELCDTEFX)                              *ELCDTECX
   734*                                                                *ELCDTECX
   735******************************************************************ELCDTECX
   736******************************************************************
   737*                   C H A N G E   L O G
   738*
   739* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   740*-----------------------------------------------------------------
   741*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   742* EFFECTIVE    NUMBER
   743*-----------------------------------------------------------------
   744* 092602    2002091900008  PEMA  INCREASE NUMBER OF MAXIMUM
   745*                                  BENEFIT CODES FROM 300 TO 900
   746* 090803    2003080800002  PEMA  ADD CATEGORY FOR SUPER GAP
   747* 051304    2003080800002  SMVA  ADD REFUND METHOD
   748* 071714    2013100100002  PEMA  FIX CRIT PERIOD EDITS
   749******************************************************************
   750 01  DATE-CARD.                                                   ELCDTECX
   751     12  DATX-COD                    PIC  X(4).                   ELCDTECX
   752     12  RUN-DATE                    PIC  9(11)  COMP-3.          ELCDTECX
   753     12  ALPH-DATE                   PIC  X(18).                  ELCDTECX
   754     12  EP-DT                       PIC  9(11)  COMP-3.          ELCDTECX
   755     12  PEND-ACT-FILE               PIC  XX.                     ELCDTECX
   756     12  EP-SW                       PIC  X.                      ELCDTECX
   757         88  NO-EP-EXTRACTS          VALUE SPACE.                 ELCDTECX
   758     12  TAPE-BATCHES                PIC  X.                      ELCDTECX
   759         88  TP-PREL-BAL             VALUE '1'.                   ELCDTECX
   760     12  BIN-RUN-DATE                PIC  XX.                     ELCDTECX
   761     12  RUN-CENTURY.                                             ELCDTECX
   762         16 RUN-CENTURY-N            PIC  99.                        CL**4
   763     12  FILLER                      PIC  X.                         CL**4
   764     12  CLAS-MORT-OVRD              PIC  X(4).                   ELCDTECX
   765     12  FILLER                      PIC  XXX.                    ELCDTECX
   766     12  COMPANY-NAME                PIC  X(30).                  ELCDTECX
   767                                                                  ELCDTECX
   768 01  FILLER                          PIC  X(7)                       CL**6
   769                                          VALUE 'OPTIONS'.        ELCDTECX
   770 01  DATE-CARD-OPTIONS.                                           ELCDTECX
   771     12  DATE-OPTIONS-ID             PIC  X(4).                   ELCDTECX
   772     12  DTE-MIN-PREM                PIC  99V99.                  ELCDTECX
   773     12  DTE-LANGUAGE-IND            PIC  X.                      ELCDTECX
   774         88  DTE-LANGUAGE-IS-FR           VALUE 'F'.              ELCDTECX
   775         88  DTE-LANGUAGE-IS-ENG          VALUE 'E'.              ELCDTECX
   776     12  DTE-MIN-AGE                 PIC  99.                     ELCDTECX
   777     12  DTE-DEFAULT-AGE             PIC  99.                     ELCDTECX
   778     12  FILLER                      PIC  X.                      ELCDTECX
   779     12  DTE-MAX-TERM                PIC  999.                    ELCDTECX
   780     12  DTE-COMP-VG                 PIC  X.                      ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  19
* ECS0561.cbl (/apps/prod/cid1p/copy/ELCDTECX)
   781     12  DTE-REM-TRM                 PIC  X.                      ELCDTECX
   782     12  DTE-PRM-CK                  PIC S99V99.                  ELCDTECX
   783     12  DTE-PRORATA                 PIC  X.                      ELCDTECX
   784     12  DTE-CLM-REJ                 PIC  X.                      ELCDTECX
   785     12  DTE-REF-REJ                 PIC  X.                      ELCDTECX
   786     12  DTE-COM-TBL-USED            PIC  X.                      ELCDTECX
   787     12  FILLER                      PIC  X.                      ELCDTECX
   788     12  DTE-QTR-CO                  PIC  X.                      ELCDTECX
   789     12  DTE-REF-CK                  PIC S99V99.                  ELCDTECX
   790     12  DTE-CLM-CK                  PIC S99V99.                  ELCDTECX
   791     12  DTE-CONV-DT                 PIC 9(11) COMP-3.               CL**2
   792     12  DTE-DEFAULT-SEX             PIC  X.                      ELCDTECX
   793     12  DTE-EPL-FORMAT              PIC  X.                      ELCDTECX
   794     12  FILLER                      PIC  X.                      ELCDTECX
   795     12  DTE-JT-AGE                  PIC  X.                      ELCDTECX
   796     12  DTE-KEY-BIRTH               PIC  X.                      ELCDTECX
   797     12  DTE-REINSURANCE             PIC  X.                      ELCDTECX
   798     12  DTE-CLAIM-SORT              PIC  X.                      ELCDTECX
   799     12  DTE-WRT-OFF                 PIC  S99V99.                 ELCDTECX
   800     12  DTE-R78                     PIC  X.                      ELCDTECX
   801     12  DTE-DLY-BILL                PIC  X.                      ELCDTECX
   802     12  DTE-ALT-MORT-CODE           PIC  X(4).                   ELCDTECX
   803     12  DTE-CLAIM-PAID-THRU-TO      PIC  X.                      ELCDTECX
   804     12  DTE-COMPENSATION-ACCESS     PIC  X.                      ELCDTECX
   805     12  DTE-MORTG-ACCESS-CNTL       PIC  X.                      ELCDTECX
   806     12  DTE-MP-ALT-MORT-CODE        PIC  X(4).                   ELCDTECX
   807     12  DTE-MORTALITY-AGE-CALC-METHOD                            ELCDTECX
   808                                     PIC  X.                      ELCDTECX
   809         88  DTE-USE-TABLE-ASSIGNED-METHOD VALUE '1'              ELCDTECX
   810                                                 ' '.             ELCDTECX
   811         88  DTE-USE-ALL-AGE-LAST          VALUE '2'.             ELCDTECX
   812         88  DTE-USE-ALL-AGE-NEAR          VALUE '3'.             ELCDTECX
   813     12  DTE-RESERVE-OPTION-SWITCH   PIC  X.                      ELCDTECX
   814         88  DTE-OPT-RESERVE-METHOD-AUTH       VALUE 'Y'.         ELCDTECX
   815         88  DTE-OPT-RESERVE-METHOD-UNAUTH     VALUE 'N' ' '.     ELCDTECX
   816     12  DTE-REM-TRM-CALC-OPTION     PIC  X.                      ELCDTECX
   817     12  DTE-EXPERIENCE-RETENTION-AGE                             ELCDTECX
   818                                     PIC  9.                         CL**4
   819     12  DTE-SYSTEM.                                              ELCDTECX
   820         16  DTE-SYS-A-CREDIT        PIC  X.                      ELCDTECX
   821         16  DTE-SYS-B-PEND-CLAIM    PIC  X.                      ELCDTECX
   822         16  DTE-SYS-C-CONFIRMATIONS PIC  X.                      ELCDTECX
   823         16  DTE-SYS-D-DEMAND-BILL   PIC  X.                      ELCDTECX
   824         16  DTE-SYS-E-CLASIC-CLAIMS PIC  X.                      ELCDTECX
   825         16  DTE-SYS-F-CLASIC-CREDIT PIC  X.                      ELCDTECX
   826         16  DTE-SYS-G-AR-USED       PIC  X.                      ELCDTECX
   827         16  DTE-SYS-H               PIC  X.                      ELCDTECX
   828         16  DTE-SYS-I               PIC  X.                      ELCDTECX
   829         16  DTE-SYS-J               PIC  X.                      ELCDTECX
   830         16  DTE-SYS-K               PIC  X.                      ELCDTECX
   831         16  DTE-SYS-L               PIC  X.                      ELCDTECX
   832         16  DTE-SYS-M               PIC  X.                      ELCDTECX
   833         16  DTE-SYS-N               PIC  X.                      ELCDTECX
   834         16  DTE-SYS-O               PIC  X.                      ELCDTECX
   835         16  DTE-SYS-P               PIC  X.                      ELCDTECX
   836         16  DTE-SYS-Q               PIC  X.                      ELCDTECX
   837         16  DTE-SYS-R               PIC  X.                      ELCDTECX
   838         16  DTE-SYS-S               PIC  X.                      ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  20
* ECS0561.cbl (/apps/prod/cid1p/copy/ELCDTECX)
   839         16  DTE-SYS-T               PIC  X.                      ELCDTECX
   840         16  DTE-SYS-U               PIC  X.                      ELCDTECX
   841         16  DTE-SYS-V               PIC  X.                      ELCDTECX
   842         16  DTE-SYS-W               PIC  X.                      ELCDTECX
   843         16  DTE-SYS-X               PIC  X.                      ELCDTECX
   844         16  DTE-SYS-Y               PIC  X.                      ELCDTECX
   845         16  DTE-SYS-Z               PIC  X.                      ELCDTECX
   846     12  FILLER                      REDEFINES DTE-SYSTEM.        ELCDTECX
   847         16  DTE-SYS-CODE            OCCURS 26 TIMES              ELCDTECX
   848                                     PIC  X.                      ELCDTECX
   849     12  DTE-CLIENT                  PIC  XXX.                    ELCDTECX
   850                                                                  ELCDTECX
   851 01  CLASIC-SYSTEM-CODES.                                         ELCDTECX
   852     12  DTE-COLC-ID                 PIC  X(4).                   ELCDTECX
   853     12  DTE-CLASIC-COMPANY-CD       PIC  X.                      ELCDTECX
   854     12  DTE-CLASIC-COMPANY-NUMBER   PIC  999.                    ELCDTECX
   855*    12  DTE-CLASIC-CLAIM-ACCESS     PIC  X.                      ELCDTECX
   856     12  FILLER                      PIC  X.                      ELCDTECX
   857     12  CLASIC-REIN-MAINT           PIC  XX.                     ELCDTECX
   858     12  CLASIC-COMP-MAINT           PIC  XX.                     ELCDTECX
   859     12  CLASIC-ACCT-MAINT           PIC  XX.                     ELCDTECX
   860     12  CLASIC-CTBL-MAINT           PIC  XX.                     ELCDTECX
   861     12  CLASIC-RATE-MAINT           PIC  XX.                     ELCDTECX
   862     12  CLASIC-CREDIT-EOM-DT        PIC  XX.                     ELCDTECX
   863     12  CLASIC-CLAIMS-EOM-DT        PIC  XX.                     ELCDTECX
   864                                                                  ELCDTECX
   865     12  LIFE-OVERRIDE-L1            PIC  X.                      ELCDTECX
   866     12  LIFE-OVERRIDE-L2            PIC  XX.                     ELCDTECX
   867     12  LIFE-OVERRIDE-L6            PIC  X(6).                   ELCDTECX
   868     12  LIFE-OVERRIDE-L12           PIC  X(12).                  ELCDTECX
   869                                                                  ELCDTECX
   870     12  AH-OVERRIDE-L1              PIC  X.                      ELCDTECX
   871     12  AH-OVERRIDE-L2              PIC  XX.                     ELCDTECX
   872     12  AH-OVERRIDE-L6              PIC  X(6).                   ELCDTECX
   873     12  AH-OVERRIDE-L12             PIC  X(12).                  ELCDTECX
   874                                                                  ELCDTECX
   875     12  CLAS-REPORT-CD1-CAPTION     PIC  X(10).                  ELCDTECX
   876     12  CLAS-REPORT-CD2-CAPTION     PIC  X(10).                  ELCDTECX
   877                                                                  ELCDTECX
   878     12  CLASIC-MORTG-EOM-DT         PIC  XX.                     ELCDTECX
   879     12  CLASIC-AR-EOM-DT            PIC  XX.                     ELCDTECX
   880                                                                  ELCDTECX
   881     12  FILLER                      PIC  X(11)      VALUE SPACE. ELCDTECX
   882                                                                  ELCDTECX
   883 01  DATE-CARD-FACTORS.                                           ELCDTECX
   884     12  DATE-FACTOR-ID              PIC  X(4).                   ELCDTECX
   885     12  FAC-1                       PIC S999V9(5).               ELCDTECX
   886     12  FAC-2                       PIC S999V9(5).               ELCDTECX
   887     12  FAC-3                       PIC S999V9(5).               ELCDTECX
   888     12  FAC-4                       PIC S999V9(5).               ELCDTECX
   889     12  FAC-5                       PIC S999V9(5).               ELCDTECX
   890     12  FAC-6                       PIC S999V9(5).               ELCDTECX
   891                                                                  ELCDTECX
   892 01  FILLER                          PIC  X(12)                   ELCDTECX
   893                                          VALUE 'COMPANY NAME'.   ELCDTECX
   894 01  COMPANY-NAME-TABLE.                                          ELCDTECX
   895     12  C-N-TBL                     OCCURS 6 TIMES.              ELCDTECX
   896         16  CNT-ID                  PIC  X.                      ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  21
* ECS0561.cbl (/apps/prod/cid1p/copy/ELCDTECX)
   897         16  CNT-NAME                PIC  X(30).                  ELCDTECX
   898                                                                  ELCDTECX
   899 01  FILLER                          PIC  X(11)                   ELCDTECX
   900                                          VALUE 'STATE NAMES'.    ELCDTECX
   901 01  STATE-NAMES.                                                 ELCDTECX
   902     12  STATE-NAME-FLD              OCCURS 75 TIMES.             ELCDTECX
   903         16  STATE-SUB               PIC  XX.                     ELCDTECX
   904         16  STATE-PIC1.                                          ELCDTECX
   905             20  STATE-ABBR          PIC  XX.                     ELCDTECX
   906             20  FILLER              PIC  XXX.                    ELCDTECX
   907             20  STATE-PIC           PIC  X(20).                  ELCDTECX
   908             20  STATE-CALL-EARN     PIC  X.                      ELCDTECX
   909             20  STATE-CALL-BREAK    PIC  X.                      ELCDTECX
   910             20  STATE-PRIM-FAC-DEV  PIC  XXX.                    ELCDTECX
   911                                                                  ELCDTECX
   912 01  FILLER                          PIC  X(13)                   ELCDTECX
   913                                          VALUE 'CARRIER NAMES'.  ELCDTECX
   914 01  CARRIER-NAMES.                                               ELCDTECX
   915     12  CARRIER-NAME-FLD            OCCURS 25 TIMES.             ELCDTECX
   916         16  CARRIER-SUB             PIC  X.                      ELCDTECX
   917         16  CARRIER-DOM-ST          PIC  XX.                     ELCDTECX
   918         16  CARRIER-PIC             PIC  X(30).                  ELCDTECX
   919         16  CARRIER-UEP-PCT         PIC  S9V9(4) COMP-3.            CL**6
   920         16  CARRIER-R78-PCT         PIC  S9V9(4) COMP-3.            CL**6
   921         16  CARRIER-PRO-PCT         PIC  S9V9(4) COMP-3.            CL**6
   922*        16  FILLER                  PIC  X.                      ELCDTECX
   923         16  CARRIER-SEC-PAY         PIC  X.
   924             88  SEC-PAY-CARRIER          VALUE 'Y'.
   925                                                                  ELCDTECX
   926 01  FILLER                          PIC  X(9)                       CL**6
   927                                          VALUE 'INS TYPES'.      ELCDTECX
   928 01  CLAS-INS-TYPES.                                              ELCDTECX
   929*    12 CLAS-ALL-TYPES               OCCURS 300 TIMES.            ELCDTECX
   930     12 CLAS-ALL-TYPES               OCCURS 900 TIMES.            ELCDTECX
   931         16  CLAS-I-BEN              PIC  XX.                     ELCDTECX
   932         16  CLAS-I-AB3.                                          ELCDTECX
   933             20  FILLER              PIC  X.                      ELCDTECX
   934             20  CLAS-I-AB2.                                      ELCDTECX
   935                 24  FILLER          PIC  X.                      ELCDTECX
   936                 24  CLAS-I-AB1      PIC  X.                      ELCDTECX
   937         16  CLAS-I-AB3-AH REDEFINES CLAS-I-AB3.                  ELCDTECX
   938             20  CLAS-EXCLUSION      PIC  XX.                        CL**4
   939             20  FILLER              PIC  X.                         CL**4
   940         16  CLAS-I-AB10.                                         ELCDTECX
   941             20  FILLER              PIC  X(9).                   ELCDTECX
   942             20  CLAS-I-REIN-YN      PIC  X.                      ELCDTECX
   943         16  CLAS-I-COMMENT          PIC  X(10).                  ELCDTECX
   944         16  CLAS-I-JOINT            PIC  X.                      ELCDTECX
   945         16  CLAS-I-RL-AH            PIC  X.                      ELCDTECX
   946         16  CLAS-I-CALC-TYPE.                                    ELCDTECX
   947             20  CLAS-I-BAL          PIC  X.                      ELCDTECX
   948         16  CLAS-I-EP               PIC  X.                      ELCDTECX
   949         16  CLAS-CO-BEN-I-G-CD      PIC  X.                      ELCDTECX
   950         16  CLAS-CO-REM-TERM-CALC   PIC  X.                      ELCDTECX
   951         16  CLAS-I-BEN-CATEGORY     PIC  X.
   952         16  CLAS-I-REFUND-METHOD    PIC  X.
   953         16  CLAS-I-MAX-BENEFITS     PIC 99.
   954         16  FILLER                  PIC  XXX.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  22
* ECS0561.cbl (/apps/prod/cid1p/copy/ELCDTECX)
   955                                                                  ELCDTECX
   956 01  FILLER                          PIC  X(16)                   ELCDTECX
   957                                     VALUE 'MORTALITY TABLES'.    ELCDTECX
   958 01  CLAS-MORTALITY-CODES.                                        ELCDTECX
   959     12  CLAS-MORT-FLD               OCCURS 99 TIMES              ELCDTECX
   960                                     INDEXED BY CLAS-MORT-NDX.    ELCDTECX
   961         16  CLAS-MORT-CODE          PIC  X(4).                      CL**6
   962         16  CLAS-MORT-J-CODE        PIC  X.                         CL**5
   963         16  CLAS-MORT-J-FACT        PIC S9V9(4).                    CL**6
   964         16  CLAS-MORT-DESC.                                      ELCDTECX
   965             20  CLAS-RESERVE-ADJ    PIC  999.                       CL**6
   966             20  FILLER              PIC  XX.                        CL**5
   967             20  CLAS-YEAR           PIC  X(4).                      CL**6
   968             20  FILLER              PIC  X.                         CL**5
   969             20  CLAS-TABLE-TYPE     PIC  XXX.                       CL**6
   970             20  FILLER              PIC  X.                         CL**5
   971             20  CLAS-AGE-METHOD     PIC  XX.                        CL**5
   972             20  FILLER              PIC  X.                         CL**5
   973             20  CLAS-INTEREST       PIC  99.99.                     CL**5
   974             20  FILLER              PIC  X(5).                      CL**6
   975                                                                  ELCDTECX
   976 01  FILLER                          PIC  X(15)                   ELCDTECX
   977                                     VALUE 'BUSINESS TABLES'.     ELCDTECX
   978 01  CLAS-BUSINESS-CLASSES.                                       ELCDTECX
   979     12  CLAS-BUSC-FLD               OCCURS 50 TIMES.             ELCDTECX
   980         16  CLAS-BUSC-CODE          PIC  99.                     ELCDTECX
   981         16  CLAS-BUSC-GROUP         PIC  X.                      ELCDTECX
   982         16  CLAS-BUSC-DESC          PIC  X(19).                  ELCDTECX
   983         16  CLAS-BUSC-EXCL          PIC  X.                         CL**5
   984         16  FILLER                  PIC  X(4).                      CL**6
   985                                                                  ELCDTECX
   986 01  FILLER                          PIC  X(7)                       CL**6
   987                                     VALUE 'INDEXES'.             ELCDTECX
   988 01  CLAS-INDEX-TBL.                                              ELCDTECX
   989     12  CLAX-ID                     PIC  X(4).                   ELCDTECX
   990     12  CLAS-STARTC                 PIC S9(4) COMP.              ELCDTECX
   991     12  CLAS-MAXC                   PIC S9(4) COMP.              ELCDTECX
   992     12  CLAS-STARTL                 PIC S9(4) COMP.              ELCDTECX
   993     12  CLAS-MAXL                   PIC S9(4) COMP.              ELCDTECX
   994     12  CLAS-STARTA                 PIC S9(4) COMP.              ELCDTECX
   995     12  CLAS-MAXA                   PIC S9(4) COMP.              ELCDTECX
   996     12  CLAS-STARTM                 PIC S9(4) COMP.              ELCDTECX
   997     12  CLAS-MAXM                   PIC S9(4) COMP.              ELCDTECX
   998     12  CLAS-STARTB                 PIC S9(4) COMP.              ELCDTECX
   999     12  CLAS-MAXB                   PIC S9(4) COMP.              ELCDTECX
  1000     12  CLAS-STARTS                 PIC S9(4) COMP.              ELCDTECX
  1001     12  CLAS-MAXS                   PIC S9(4) COMP.              ELCDTECX
  1002     12  CLAS-STARTE                 PIC S9(4) COMP.              ELCDTECX
  1003     12  CLAS-MAXE                   PIC S9(4) COMP.              ELCDTECX
  1004     12  CLAS-STARTCN                PIC S9(4) COMP.              ELCDTECX
  1005     12  CLAS-MAXCN                  PIC S9(4) COMP.              ELCDTECX
  1006                                                                  ELCDTECX
  1007 01  CLAS-TYPE-MISC.                                              ELCDTECX
  1008     12  CLAS-INDEXC                 PIC S9(4) COMP.              ELCDTECX
  1009     12  CLAS-INDEXL                 PIC S9(4) COMP.              ELCDTECX
  1010     12  CLAS-INDEXA                 PIC S9(4) COMP.              ELCDTECX
  1011     12  CLAS-INDEXM                 PIC S9(4) COMP.              ELCDTECX
  1012     12  CLAS-INDEXB                 PIC S9(4) COMP.              ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  23
* ECS0561.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  1013     12  CLAS-INDEXS                 PIC S9(4) COMP.              ELCDTECX
  1014     12  CLAS-INDEXE                 PIC S9(4) COMP.              ELCDTECX
  1015     12  CLAS-INDEX                  PIC S9(4) COMP.              ELCDTECX
  1016     12  CLAS-INDEXEN                PIC S9(4) COMP.              ELCDTECX
  1017     12  CLAS-INDEXCN                PIC S9(4) COMP.              ELCDTECX
  1018     12  CLAS-INDEXON                PIC S9(4) COMP.              ELCDTECX
  1019                                                                  ELCDTECX
  1020 01  FILLER                          PIC  X(13)                   ELCDTECX
  1021                                     VALUE 'MISCELLANEOUS'.       ELCDTECX
  1022 01  CLAS-MISC.                                                   ELCDTECX
  1023     12  DTE-FICH                    PIC  X.                      ELCDTECX
  1024         88  FICH-NO                 VALUE SPACE.                 ELCDTECX
  1025         88  FICH-ONLY               VALUE '1'.                   ELCDTECX
  1026         88  FICH-BOTH               VALUE '2'.                   ELCDTECX
  1027     12  FICH-OPEN                   PIC  X.                      ELCDTECX
  1028     12  REPT-OPEN                   PIC  X.                      ELCDTECX
  1029     12  DTE-PGM-OPT                 PIC  9.                         CL**5
  1030     12  DTE-PRT-OPT                 PIC  X.                      ELCDTECX
  1031     12  DTE-FMT-OPT                 PIC  9.                      ELCDTECX
  1032     12  DTE-PRC-OPT                 PIC  9.                      ELCDTECX
  1033     12  DTE-TOT-OPT                 PIC  9.                      ELCDTECX
  1034     12  CLAS-LOOK                   PIC  XX.                     ELCDTECX
  1035     12  DTE-TOT-LINES               PIC S9(8)      COMP.         ELCDTECX
  1036     12  STATE-L                     PIC  XX.                     ELCDTECX
  1037     12  CLAS-CN                     PIC  99.                     ELCDTECX
  1038     12  CLAS-CO                     PIC  99.                     ELCDTECX
  1039     12  DTE-VSAM-FLAGS                              VALUE ZERO.  ELCDTECX
  1040         16  DTE-F-1                 PIC  X.                      ELCDTECX
  1041         16  DTE-F-2                 PIC  X.                      ELCDTECX
  1042     12  DTE-ABEND-WORK.                                          ELCDTECX
  1043         16  DTE-ABEND-CD-1          PIC  XX         VALUE SPACES.ELCDTECX
  1044         16  DTE-ABEND-CD-2          PIC  XX         VALUE SPACES.ELCDTECX
  1045                                                                  ELCDTECX
  1046 01  FILLER                          PIC  X(12)                   ELCDTECX
  1047                                     VALUE 'WORKING DATE'.        ELCDTECX
  1048 01  WS-DATE-AND-TIME.                                            ELCDTECX
  1049     12  WS-ACCEPT-DATE.                                          ELCDTECX
  1050         16  WS-AD-YY                PIC  99.                     ELCDTECX
  1051         16  WS-AD-MM                PIC  99.                     ELCDTECX
  1052         16  WS-AD-DD                PIC  99.                     ELCDTECX
  1053     12  WS-CURRENT-DATE.                                         ELCDTECX
  1054         16  WS-CD-MM                PIC  99.                     ELCDTECX
  1055         16  FILLER                  PIC  X          VALUE '/'.   ELCDTECX
  1056         16  WS-CD-DD                PIC  99.                     ELCDTECX
  1057         16  FILLER                  PIC  X          VALUE '/'.   ELCDTECX
  1058         16  WS-CD-YY                PIC  99.                     ELCDTECX
  1059     12  WS-TIME-OF-DAY.                                          ELCDTECX
  1060         16  WS-TIME                 PIC  9(6).                   ELCDTECX
  1061         16  WS-HUN-SEC              PIC  99.                     ELCDTECX
  1062                                                                  ELCDTECX
  1063 01  FILLER                          PIC  X(12)                   ELCDTECX
  1064                                     VALUE 'CARRIER CLMS'.        ELCDTECX
  1065 01  CARRIER-OPT-CLAIM-DATA.                                      ELCDTECX
  1066     12  CARRIER-FLDS                OCCURS 25 TIMES.             ELCDTECX
  1067         16  CARRIER-IBNR-SWITCH     PIC  X.                         CL**5
  1068         16  CARRIER-IBNR-PERCENT    PIC S9V9(4) COMP-3.             CL**6
  1069         16  CARRIER-CIDA-DISCOUNT   PIC S9V9(4) COMP-3.             CL**6
  1070                                                                  ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  24
* ECS0561.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  1071 01  FILLER                          PIC  X(10)                   ELCDTECX
  1072                                     VALUE 'STATE TLRS'.          ELCDTECX
  1073 01  STATE-TARGET-LOSS-RATIOS.                                    ELCDTECX
  1074     12  STATE-TLR-FLD               OCCURS 75 TIMES.             ELCDTECX
  1075         16  STATE-TARGET-LOSS-RATIO PIC S9V9(4) COMP-3.             CL**6
  1076         16  STATE-CALC-INTEREST     PIC S9V9(4) COMP-3.             CL**6
  1077                                                                  ELCDTECX
  1078 01  FILLER                          PIC  X(13)                   ELCDTECX
  1079                                     VALUE 'BUSINESS TLRS'.       ELCDTECX
  1080 01  BUSINESS-TRGT-LOSS-RATIO-MODS.                               ELCDTECX
  1081     12  BUS-TLRM-FLD                OCCURS 99 TIMES.             ELCDTECX
  1082         16  BUS-TRGT-LOSS-RATIO-MOD PIC S9V9(4) COMP-3.             CL**6
  1083                                                                  ELCDTECX
  1084 01  FILLER                          PIC  X(13)                   ELCDTECX
  1085                                     VALUE 'MISC CLM DATA'.       ELCDTECX
  1086 01  MISC-OPT-CLM-RSV-DATA.                                       ELCDTECX
  1087     12  COMPANY-CALC-INTEREST       PIC S9V9(4) COMP-3.             CL**6
  1088     12  COMPANY-CIDA-DISCOUNT       PIC S9V9(4) COMP-3.             CL**6
  1089     12  COMPANY-CRDB-TABLE-SELECTION                             ELCDTECX
  1090                                     PIC  X.                         CL**5
  1091     12  COMPANY-IBNR-AH-FACTOR      PIC S9V9(4) COMP-3.             CL**6
  1092     12  COMPANY-IBNR-LAG-MONTH      PIC S999    COMP-3.             CL**6
  1093     12  COMPANY-IBNR-LIFE-FACTOR    PIC S9V9(4) COMP-3.             CL**6
  1094     12  COMPANY-OPTION-START-DATE   PIC  XX.                        CL**5
  1095     12  INDEXBS                     PIC S9(4)   COMP.               CL**6
  1096     12  INDEXCA                     PIC S9(4)   COMP.               CL**6
  1097     12  INDEXST                     PIC S9(4)   COMP.               CL**6
  1098     12  FILLER                      PIC  X(75).                  ELCDTECX
  1099******************************************************************ELCDTECX
  1100*01  MISC-CARR-PCT-DATA.                                          00001521
  1101*    12  DD-CARR1-UEP-PCT            PIC S9V9(4) COMP-3.          00001522
  1102*    12  DD-CARR1-R78-PCT            PIC S9V9(4) COMP-3.          00001522
  1103*    12  DD-CARR1-PRO-PCT            PIC S9V9(4) COMP-3.          00001522
  1104*    12  DD-CARR2-UEP-PCT            PIC S9V9(4) COMP-3.          00001522
  1105*    12  DD-CARR2-R78-PCT            PIC S9V9(4) COMP-3.          00001522
  1106*    12  DD-CARR2-PRO-PCT            PIC S9V9(4) COMP-3.          00001522
  1107******************************************************************ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  25
* ECS0561.cbl
  1108/
* 1109                                 COPY ELCDTEVR.
  1110***************************************************************** 04/15/98
  1111*                                                                *ELCDTEVR
  1112*                                                                *ELCDTEVR
  1113*                            ELCDTEVR.                           *   LV003
  1114*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
  1115*                            VMOD=2.001                          *   CL**2
  1116*                                                                *ELCDTEVR
  1117*   WORKING STORAGE FOR DATE VARIABLES CREATED                   *ELCDTEVR
  1118*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCDTEVR
  1119*                                                                *ELCDTEVR
  1120******************************************************************ELCDTEVR
  1121 01  WS-DATE-CARD-DATE.                                           ELCDTEVR
  1122     05  WS-RUN-DATE.                                             ELCDTEVR
  1123         10  FILLER                  PIC  9(03).                  ELCDTEVR
  1124         10  RUN-CCYY                PIC  9(04).                  ELCDTEVR
  1125         10  RUN-CCYR  REDEFINES  RUN-CCYY.                       ELCDTEVR
  1126             15  RUN-CC              PIC  99.                     ELCDTEVR
  1127             15  RUN-YR              PIC  99.                     ELCDTEVR
  1128         10  RUN-MO                  PIC  99.                     ELCDTEVR
  1129         10  RUN-DA                  PIC  99.                     ELCDTEVR
  1130     05  WS-RUN-DATE-N REDEFINES                                     CL**2
  1131            WS-RUN-DATE              PIC 9(11).                      CL**2
  1132     05  WS-EP-DT.                                                ELCDTEVR
  1133         10  FILLER                  PIC  9(03).                  ELCDTEVR
  1134         10  EP-CCYY                 PIC  9(04).                  ELCDTEVR
  1135         10  EP-CCYR  REDEFINES  EP-CCYY.                         ELCDTEVR
  1136             15  EP-CC               PIC  99.                     ELCDTEVR
  1137             15  EP-YR               PIC  99.                     ELCDTEVR
  1138         10  EP-MO                   PIC  99.                     ELCDTEVR
  1139         10  EP-DA                   PIC  99.                     ELCDTEVR
  1140     05  WS-EP-DT-N REDEFINES                                        CL**2
  1141            WS-EP-DT                 PIC 9(11).                      CL**2
  1142     05  WS-DTE-CONV-DT.                                             CL**4
  1143         10  FILLER                  PIC  9(03).                     CL**4
  1144         10  DTE-CONV-CCYY           PIC  9(04).                     CL**4
  1145         10  DTE-CONV-CCYR  REDEFINES  DTE-CONV-CCYY.                CL**4
  1146             15  DTE-CONV-CC         PIC  99.                        CL**4
  1147             15  DTE-CONV-YR         PIC  99.                        CL**4
  1148         10  DTE-CONV-MO             PIC  99.                        CL**4
  1149         10  DTE-CONV-DA             PIC  99.                        CL**4
  1150     05  WS-DTE-CONV-DT-N REDEFINES                                  CL**4
  1151            WS-DTE-CONV-DT           PIC  9(11).                     CL**4
  1152 01  WS-BALANCE-FORWARD-DATE.                                     ELCDTEVR
  1153     05  WS-BF-LAST-ACTIVITY-DATE.                                ELCDTEVR
  1154         10  FILLER                            PIC 999.           ELCDTEVR
  1155         10  BF-ACT-CCYY                       PIC 9(04).         ELCDTEVR
  1156         10  BF-ACT-CCYR  REDEFINES  BF-ACT-CCYY.                 ELCDTEVR
  1157             15  BF-ACT-CC                     PIC 99.            ELCDTEVR
  1158             15  BF-ACT-YEAR                   PIC 99.            ELCDTEVR
  1159         10  BF-ACT-MONTH                      PIC 99.            ELCDTEVR
  1160         10  BF-ACT-DAY                        PIC 99.            ELCDTEVR
  1161     05  WS-BF-LAST-ACTIVITY-DATE-N REDEFINES                        CL**2
  1162            WS-BF-LAST-ACTIVITY-DATE           PIC 9(11).            CL**2
  1163     05  WS-BF-CURRENT-LAST-STMT-DT.                              ELCDTEVR
  1164         10  FILLER                            PIC 999.           ELCDTEVR
  1165         10  BF-CURRENT-LAST-STMT-CEN          PIC 99.            ELCDTEVR
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  26
* ECS0561.cbl (/apps/prod/cid1p/copy/ELCDTEVR)
  1166         10  BF-CURRENT-LAST-STMT-YEAR         PIC 99.            ELCDTEVR
  1167         10  BF-CURRENT-LAST-STMT-MONTH        PIC 99.            ELCDTEVR
  1168         10  BF-CURRENT-LAST-STMT-DAY          PIC 99.            ELCDTEVR
  1169     05  WS-BF-CURRENT-LAST-STMT-DT-N REDEFINES                      CL**2
  1170            WS-BF-CURRENT-LAST-STMT-DT        PIC 9(11).             CL**2
  1171 01  WS-ADD-CONF-TRANSACTIONS-DTE.                                ELCDTEVR
  1172     05  WS-AC-CERT-EFF-DATE.                                     ELCDTEVR
  1173         10  FILLER                            PIC 999.           ELCDTEVR
  1174         10  AC-CERT-CCYY                      PIC 9(04).         ELCDTEVR
  1175         10  AC-CERT-CCYR  REDEFINES  AC-CERT-CCYY.               ELCDTEVR
  1176             15  AC-CERT-CC                    PIC 99.            ELCDTEVR
  1177             15  AC-CERT-YR                    PIC 99.            ELCDTEVR
  1178         10  AC-CERT-MO                        PIC 99.            ELCDTEVR
  1179         10  AC-CERT-DA                        PIC 99.            ELCDTEVR
  1180     05  WS-AC-CERT-EFF-DATE-N REDEFINES                             CL**2
  1181            WS-AC-CERT-EFF-DATE                PIC 9(11).            CL**2
  1182     05  WS-AC-LIFE-CANCEL-DATE.                                  ELCDTEVR
  1183         10  FILLER                            PIC 999.           ELCDTEVR
  1184         10  AC-LIFE-CANCEL-CCYY               PIC 9(04).         ELCDTEVR
  1185         10  AC-LIFE-CANCEL-CCYR REDEFINES AC-LIFE-CANCEL-CCYY.   ELCDTEVR
  1186             15  AC-LIFE-CANCEL-CC             PIC 99.            ELCDTEVR
  1187             15  AC-LIFE-CANCEL-YR             PIC 99.            ELCDTEVR
  1188         10  AC-LIFE-CANCEL-MO                 PIC 99.            ELCDTEVR
  1189         10  AC-LIFE-CANCEL-DA                 PIC 99.            ELCDTEVR
  1190     05  WS-AC-LIFE-CANCEL-DATE-N REDEFINES                          CL**2
  1191            WS-AC-LIFE-CANCEL-DATE             PIC 9(11).            CL**2
  1192     05  WS-AC-AH-CANCEL-DATE.                                    ELCDTEVR
  1193         10  FILLER                            PIC 999.           ELCDTEVR
  1194         10  AC-AH-CANCEL-CCYY                 PIC 9(04).         ELCDTEVR
  1195         10  AC-AH-CANCEL-CCYR  REDEFINES  AC-AH-CANCEL-CCYY.     ELCDTEVR
  1196             15  AC-AH-CANCEL-CC               PIC 99.            ELCDTEVR
  1197             15  AC-AH-CANCEL-YR               PIC 99.            ELCDTEVR
  1198         10  AC-AH-CANCEL-MO                   PIC 99.            ELCDTEVR
  1199         10  AC-AH-CANCEL-DA                   PIC 99.            ELCDTEVR
  1200     05  WS-AC-AH-CANCEL-DATE-N REDEFINES                            CL**2
  1201            WS-AC-AH-CANCEL-DATE               PIC 9(11).            CL**2
  1202 01  WS-RATE-RECORD.                                              ELCDTEVR
  1203         05  WS-RT-EXPIRY-DATE.                                   ELCDTEVR
  1204             10  FILLER                        PIC 999.           ELCDTEVR
  1205             10  RT-EXP-CCYY                   PIC 9(04).         ELCDTEVR
  1206             10  RT-EXP-CCYR  REDEFINES  RT-EXP-CCYY.             ELCDTEVR
  1207                 15  RT-EXP-CC                 PIC 99.            ELCDTEVR
  1208                 15  RT-EXP-YR                 PIC 99.            ELCDTEVR
  1209             10  RT-EXP-MO                     PIC 99.            ELCDTEVR
  1210             10  RT-EXP-DA                     PIC 99.            ELCDTEVR
  1211         05  WS-RT-EXPIRY-DATE-N REDEFINES                           CL**2
  1212                WS-RT-EXPIRY-DATE              PIC 9(11).            CL**2
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  27
* ECS0561.cbl
  1213/
  1214 PROCEDURE DIVISION.
  1215
  1216 0001-DT-CRD-READ SECTION.
* 1217                                 COPY ELCDTERX.
  1218******************************************************************04/15/98
  1219*                                                                *ELCDTERX
  1220*                                                                *ELCDTERX
  1221*                            ELCDTERX.                           *   LV002
  1222*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  1223*                            VMOD=2.007                          *ELCDTERX
  1224*                                                                *ELCDTERX
  1225*      LOAD DATE CARD DISK FILE INTO WORKING STORAGE AREA        *ELCDTERX
  1226*      (COPY CODE FOR W/S = ELCDTECX AND COPY CODE FOR FD        *ELCDTERX
  1227*      = ELCDTEFD)                                               *ELCDTERX
  1228*                                                                *ELCDTERX
  1229******************************************************************ELCDTERX
  1230                                                                  ELCDTERX
  1231     ACCEPT WS-ACCEPT-DATE       FROM  DATE.                      ELCDTERX
  1232                                                                  ELCDTERX
  1233     MOVE WS-AD-YY               TO  WS-CD-YY.                    ELCDTERX
  1234     MOVE WS-AD-MM               TO  WS-CD-MM.                    ELCDTERX
  1235     MOVE WS-AD-DD               TO  WS-CD-DD.                    ELCDTERX
  1236                                                                  ELCDTERX
  1237     ACCEPT WS-TIME-OF-DAY       FROM  TIME.                      ELCDTERX
  1238                                                                  ELCDTERX
  1239******************************************************************ELCDTERX
  1240*    NOTE: THE FOLLOWING STATEMENT IS USED TO ELIMINATE COB II    ELCDTERX
  1241*          WARNING MESSAGES.                                      ELCDTERX
  1242******************************************************************ELCDTERX
  1243     IF WS-CD-YY = LOW-VALUES                                     ELCDTERX
  1244         COMPUTE PGM-SUB = PGM-SUB + 1.                           ELCDTERX
  1245                                                                  ELCDTERX
  1246     OPEN INPUT DISK-DATE.                                        ELCDTERX
  1247                                                                  ELCDTERX
  1248     MOVE SPACE TO DATE-CARD         CLAS-BUSINESS-CLASSES        ELCDTERX
  1249                   STATE-NAMES       CLAS-MORTALITY-CODES         ELCDTERX
  1250                   CLAS-INS-TYPES    COMPANY-NAME-TABLE           ELCDTERX
  1251                   DATE-CARD-OPTIONS DATE-CARD-FACTORS            ELCDTERX
  1252                   CLAX-ID           CLAS-MISC                    ELCDTERX
  1253                   CARRIER-NAMES     CLASIC-SYSTEM-CODES          ELCDTERX
  1254                   CARRIER-OPT-CLAIM-DATA                         ELCDTERX
  1255                   STATE-TARGET-LOSS-RATIOS                       ELCDTERX
  1256                   BUSINESS-TRGT-LOSS-RATIO-MODS                  ELCDTERX
  1257                   MISC-OPT-CLM-RSV-DATA.                         ELCDTERX
  1258                                                                  ELCDTERX
  1259     MOVE LOW-VALUES TO CLAS-INDEX-TBL CLAS-TYPE-MISC.            ELCDTERX
  1260                                                                  ELCDTERX
  1261     MOVE ZERO TO CLAS-CN DTE-TOT-LINES CLAS-CO                   ELCDTERX
  1262                  INDEXCA INDEXBS INDEXST.                        ELCDTERX
  1263                                                                  ELCDTERX
  1264     COMPUTE CLAS-CN = PGM-SUB / +50.                             ELCDTERX
  1265     COMPUTE CLAS-CO = PGM-SUB / +20.                             ELCDTERX
  1266     COMPUTE CLAS-INDEXEN = PGM-SUB - (CLAS-CN * +50).            ELCDTERX
  1267     COMPUTE CLAS-INDEXON = PGM-SUB - (CLAS-CO * +20).            ELCDTERX
  1268                                                                  ELCDTERX
  1269     IF CLAS-INDEXEN = ZERO                                       ELCDTERX
  1270         MOVE +50               TO CLAS-INDEXEN                   ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  28
* ECS0561.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  1271     ELSE                                                         ELCDTERX
  1272         ADD +1                 TO CLAS-CN.                       ELCDTERX
  1273                                                                  ELCDTERX
  1274     IF CLAS-INDEXON = ZERO                                       ELCDTERX
  1275         MOVE +20               TO CLAS-INDEXON                   ELCDTERX
  1276     ELSE                                                         ELCDTERX
  1277         ADD +1                 TO CLAS-CO.                       ELCDTERX
  1278                                                                  ELCDTERX
  1279 0005-READ--CARD.                                                 ELCDTERX
  1280     READ DISK-DATE                                               ELCDTERX
  1281         AT END CLOSE DISK-DATE                                   ELCDTERX
  1282             GO TO 0060-READ--TEST.                               ELCDTERX
  1283                                                                  ELCDTERX
  1284     MOVE ZERO                   TO CLAS-INDEX.                   ELCDTERX
  1285                                                                  ELCDTERX
  1286     IF DD-ID = 'CLAS' OR 'LIFE' OR 'GLED'                        ELCDTERX
  1287         MOVE DATE-DISK          TO DATE-CARD                     ELCDTERX
  1288         MOVE RUN-DATE           TO WS-RUN-DATE-N                    CL**2
  1289         MOVE EP-DT              TO WS-EP-DT-N                       CL**2
  1290         GO TO 0005-READ--CARD.                                   ELCDTERX
  1291                                                                  ELCDTERX
  1292     IF DD-ID = 'CLAD'                                            ELCDTERX
  1293         MOVE DATE-DISK          TO DATE-CARD-OPTIONS             ELCDTERX
  1294         GO TO 0005-READ--CARD.                                   ELCDTERX
  1295                                                                  ELCDTERX
  1296     IF DD-ID = 'CLAX'                                            ELCDTERX
  1297         MOVE DATE-DISK          TO CLAS-INDEX-TBL                ELCDTERX
  1298         GO TO 0005-READ--CARD.                                   ELCDTERX
  1299                                                                  ELCDTERX
  1300     IF DD-ID = 'CLAF'                                            ELCDTERX
  1301         MOVE DATE-DISK          TO DATE-CARD-FACTORS             ELCDTERX
  1302         GO TO 0005-READ--CARD.                                   ELCDTERX
  1303                                                                  ELCDTERX
  1304     IF DD-ID = 'CLAC'                                            ELCDTERX
  1305         GO TO 0010-READ--CLAC.                                   ELCDTERX
  1306                                                                  ELCDTERX
  1307     IF DD-ID = 'CARR'                                            ELCDTERX
  1308         GO TO 0015-READ--CARR.                                   ELCDTERX
  1309                                                                  ELCDTERX
  1310     IF DD-ID = 'STAT'                                            ELCDTERX
  1311         GO TO 0020-READ--STAT.                                   ELCDTERX
  1312                                                                  ELCDTERX
  1313     IF DD-ID = 'BUSC'                                            ELCDTERX
  1314         GO TO 0025-READ--BUSC.                                   ELCDTERX
  1315                                                                  ELCDTERX
  1316     IF DD-ID = 'MORT'                                            ELCDTERX
  1317         GO TO 0030-READ--MORT.                                   ELCDTERX
  1318                                                                  ELCDTERX
  1319     IF DD-ID = 'CLAI'                                            ELCDTERX
  1320         GO TO 0040-READ--CLAI.                                   ELCDTERX
  1321                                                                  ELCDTERX
  1322     IF DD-ID = 'COLC'                                            ELCDTERX
  1323         GO TO 0065-READ--COLC.                                   ELCDTERX
  1324                                                                  ELCDTERX
  1325     IF DD-IDX NUMERIC AND                                        ELCDTERX
  1326        DD-IDA = 'CL'                                             ELCDTERX
  1327         GO TO 0035-READ--CLXX.                                   ELCDTERX
  1328                                                                  ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  29
* ECS0561.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  1329     IF DD-IDX NUMERIC AND                                        ELCDTERX
  1330        DD-IDA = 'PO'                                             ELCDTERX
  1331         GO TO 0050-READ--POXX.                                   ELCDTERX
  1332                                                                  ELCDTERX
  1333     IF DD-ID = 'OPCA'                                            ELCDTERX
  1334         GO TO 0070-READ--OPCA.                                   ELCDTERX
  1335                                                                  ELCDTERX
  1336     IF DD-ID = 'OPST'                                            ELCDTERX
  1337         GO TO 0072-READ--OPST.                                   ELCDTERX
  1338                                                                  ELCDTERX
  1339     IF DD-ID = 'OPBS'                                            ELCDTERX
  1340         GO TO 0074-READ--OPBS.                                   ELCDTERX
  1341                                                                  ELCDTERX
  1342     IF DD-ID = 'OPMS'                                            ELCDTERX
  1343         MOVE DD-MISC-DATA       TO MISC-OPT-CLM-RSV-DATA.        ELCDTERX
  1344                                                                  ELCDTERX
  1345     GO TO 0005-READ--CARD.                                       ELCDTERX
  1346                                                                  ELCDTERX
  1347 0010-READ--CLAC.                                                 ELCDTERX
  1348     ADD 1                       TO CLAS-INDEXC.                  ELCDTERX
  1349     MOVE DD-CR1                 TO CNT-ID (CLAS-INDEXC).         ELCDTERX
  1350     MOVE DD-CR1N                TO CNT-NAME (CLAS-INDEXC).       ELCDTERX
  1351     ADD 1                       TO CLAS-INDEXC.                  ELCDTERX
  1352     MOVE DD-CR2                 TO CNT-ID (CLAS-INDEXC).         ELCDTERX
  1353     MOVE DD-CR2N                TO CNT-NAME (CLAS-INDEXC).       ELCDTERX
  1354     GO TO 0005-READ--CARD.                                       ELCDTERX
  1355                                                                  ELCDTERX
  1356 0015-READ--CARR.                                                 ELCDTERX
  1357     ADD 1  TO  CLAS-INDEXCN.                                     ELCDTERX
  1358     IF CLAS-INDEXCN LESS THAN +26                                ELCDTERX
  1359        MOVE DD-CARR1         TO CARRIER-SUB (CLAS-INDEXCN)
  1360        MOVE DD-CARR1S        TO CARRIER-DOM-ST (CLAS-INDEXCN)
  1361        MOVE DD-CARR1N        TO CARRIER-PIC (CLAS-INDEXCN)
  1362        MOVE DD-CARR1-UEP-PCT TO CARRIER-UEP-PCT (CLAS-INDEXCN)
  1363        MOVE DD-CARR1-R78-PCT TO CARRIER-R78-PCT (CLAS-INDEXCN)
  1364        MOVE DD-CARR1-PRO-PCT TO CARRIER-PRO-PCT (CLAS-INDEXCN)
  1365        MOVE DD-CARR1-SECPAY-SW
  1366                               TO CARRIER-SEC-PAY (CLAS-INDEXCN)
  1367     END-IF
  1368                                                                  ELCDTERX
  1369     ADD 1  TO  CLAS-INDEXCN.                                     ELCDTERX
  1370     IF CLAS-INDEXCN LESS THAN +26                                ELCDTERX
  1371        MOVE DD-CARR2         TO CARRIER-SUB (CLAS-INDEXCN)
  1372        MOVE DD-CARR2S        TO CARRIER-DOM-ST (CLAS-INDEXCN)
  1373        MOVE DD-CARR2N        TO CARRIER-PIC (CLAS-INDEXCN)
  1374        MOVE DD-CARR2-UEP-PCT TO CARRIER-UEP-PCT (CLAS-INDEXCN)
  1375        MOVE DD-CARR2-R78-PCT TO CARRIER-R78-PCT (CLAS-INDEXCN)
  1376        MOVE DD-CARR2-PRO-PCT TO CARRIER-PRO-PCT (CLAS-INDEXCN)
  1377        MOVE DD-CARR2-SECPAY-SW
  1378                              TO CARRIER-SEC-PAY (CLAS-INDEXCN)
  1379     END-IF
  1380                                                                  ELCDTERX
  1381                                                                  ELCDTERX
  1382     GO TO 0005-READ--CARD.                                       ELCDTERX
  1383                                                                  ELCDTERX
  1384 0020-READ--STAT.                                                 ELCDTERX
  1385     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  1386     IF CLAS-INDEX GREATER 3  OR                                  ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  30
* ECS0561.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  1387        DD-ST (CLAS-INDEX) = SPACE                                ELCDTERX
  1388         GO TO 0005-READ--CARD.                                   ELCDTERX
  1389                                                                  ELCDTERX
  1390     ADD 1                       TO CLAS-INDEXS.                  ELCDTERX
  1391     MOVE DD-ST (CLAS-INDEX)     TO STATE-NAME-FLD (CLAS-INDEXS). ELCDTERX
  1392     GO TO 0020-READ--STAT.                                       ELCDTERX
  1393                                                                  ELCDTERX
  1394 0025-READ--BUSC.                                                 ELCDTERX
  1395     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  1396     IF CLAS-INDEX GREATER 3  OR                                  ELCDTERX
  1397        DD-ST (CLAS-INDEX) = SPACE                                ELCDTERX
  1398         GO TO 0005-READ--CARD.                                   ELCDTERX
  1399                                                                  ELCDTERX
  1400     ADD 1                       TO CLAS-INDEXB.                  ELCDTERX
  1401     MOVE DD-ST (CLAS-INDEX)     TO CLAS-BUSC-FLD (CLAS-INDEXB).  ELCDTERX
  1402     GO TO 0025-READ--BUSC.                                       ELCDTERX
  1403                                                                  ELCDTERX
  1404 0030-READ--MORT.                                                 ELCDTERX
  1405     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  1406     IF CLAS-INDEX GREATER 2  OR                                  ELCDTERX
  1407        DD-MORT (CLAS-INDEX) = SPACE                              ELCDTERX
  1408         GO TO 0005-READ--CARD.                                   ELCDTERX
  1409                                                                  ELCDTERX
  1410     ADD 1                       TO CLAS-INDEXM.                  ELCDTERX
  1411     MOVE DD-MORT (CLAS-INDEX)   TO CLAS-MORT-FLD (CLAS-INDEXM).  ELCDTERX
  1412     GO TO 0030-READ--MORT.                                       ELCDTERX
  1413                                                                  ELCDTERX
  1414 0035-READ--CLXX.                                                 ELCDTERX
  1415     IF DD-IDX NOT = CLAS-CN                                      ELCDTERX
  1416          GO TO 0005-READ--CARD.                                  ELCDTERX
  1417                                                                  ELCDTERX
  1418     IF DD-PS-PIC (CLAS-INDEXEN) = 'X'                            ELCDTERX
  1419         DISPLAY '***********************************************'ELCDTERX
  1420         DISPLAY 'PROGRAM ECS-', PGM-SUB, ' NOT SCHEDULED TO RUN' ELCDTERX
  1421         DISPLAY '***********************************************'ELCDTERX
  1422         GO TO 0055-READ--STOP.                                   ELCDTERX
  1423                                                                  ELCDTERX
  1424     IF DD-PS-PIC (CLAS-INDEXEN) NOT LESS 'A'  AND                ELCDTERX
  1425        DD-PS-PIC (CLAS-INDEXEN) NOT GREATER 'I'                  ELCDTERX
  1426         MOVE '1'                TO DTE-FICH.                     ELCDTERX
  1427                                                                  ELCDTERX
  1428     IF DD-PS-PIC (CLAS-INDEXEN) NOT LESS 'J'  AND                ELCDTERX
  1429        DD-PS-PIC (CLAS-INDEXEN) NOT GREATER 'R'                  ELCDTERX
  1430         MOVE '2'                TO DTE-FICH.                     ELCDTERX
  1431                                                                  ELCDTERX
  1432*    MOVE DD-PS-PIC (CLAS-INDEXEN) TO DTE-PGM-OPT.                ELCDTERX
  1433     GO TO 0005-READ--CARD.                                       ELCDTERX
  1434                                                                  ELCDTERX
  1435 0040-READ--CLAI.                                                 ELCDTERX
  1436     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  1437     IF CLAS-INDEX GREATER 2  OR                                  ELCDTERX
  1438        DD-TYPE (CLAS-INDEX) = SPACE                              ELCDTERX
  1439         GO TO 0005-READ--CARD.                                   ELCDTERX
  1440                                                                  ELCDTERX
  1441     ADD 1                       TO CLAS-INDEXA.                  ELCDTERX
  1442     MOVE DD-TYPE (CLAS-INDEX) TO CLAS-ALL-TYPES (CLAS-INDEXA).   ELCDTERX
  1443     GO TO 0040-READ--CLAI.                                       ELCDTERX
  1444                                                                  ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  31
* ECS0561.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  1445 0045-READ--DUMP.                                                 ELCDTERX
  1446     MOVE +999 TO WS-RETURN-CODE                                  ELCDTERX
  1447     MOVE 'MISSING AND/OR INVALID CLAS DATE CARD'                 ELCDTERX
  1448                                 TO  WS-ABEND-MESSAGE             ELCDTERX
  1449     PERFORM ABEND-PGM.                                           ELCDTERX
  1450                                                                  ELCDTERX
  1451 0050-READ--POXX.                                                 ELCDTERX
  1452     IF DD-IDX NOT = CLAS-CO                                      ELCDTERX
  1453         GO TO 0005-READ--CARD.                                   ELCDTERX
  1454                                                                  ELCDTERX
  1455     IF DD-PS-PRC (CLAS-INDEXON) = 'X'                            ELCDTERX
  1456         DISPLAY '***********************************************'ELCDTERX
  1457         DISPLAY 'ECS - ', PGM-SUB, ' IS NOT SCHEDULED TO RUN'    ELCDTERX
  1458         DISPLAY '***********************************************'ELCDTERX
  1459         GO TO 0055-READ--STOP.                                   ELCDTERX
  1460                                                                  ELCDTERX
  1461     MOVE DD-PS-PRT (CLAS-INDEXON) TO DTE-PRT-OPT.                ELCDTERX
  1462     MOVE DD-PS-FMT (CLAS-INDEXON) TO DTE-FMT-OPT.                ELCDTERX
  1463     MOVE DD-PS-PRC (CLAS-INDEXON) TO DTE-PRC-OPT DTE-PGM-OPT.    ELCDTERX
  1464     MOVE DD-PS-TOT (CLAS-INDEXON) TO DTE-TOT-OPT.                ELCDTERX
  1465                                                                  ELCDTERX
  1466     IF DTE-PRT-OPT = 'B'                                         ELCDTERX
  1467         MOVE '2'                  TO DTE-FICH.                   ELCDTERX
  1468     IF DTE-PRT-OPT = 'F'                                         ELCDTERX
  1469         MOVE '1'                  TO DTE-FICH.                   ELCDTERX
  1470                                                                  ELCDTERX
  1471     GO TO 0005-READ--CARD.                                       ELCDTERX
  1472                                                                  ELCDTERX
  1473 0055-READ--STOP.                                                 ELCDTERX
  1474     GOBACK.                                                      ELCDTERX
  1475                                                                  ELCDTERX
  1476 0060-READ--TEST.                                                 ELCDTERX
  1477     IF DATX-COD        = SPACE  OR                               ELCDTERX
  1478        CLAX-ID         = SPACE  OR                               ELCDTERX
  1479        DATE-OPTIONS-ID = SPACE                                   ELCDTERX
  1480         GO TO 0045-READ--DUMP.                                   ELCDTERX
  1481                                                                  ELCDTERX
  1482     MOVE LOW-VALUE TO CLAS-TYPE-MISC.                            ELCDTERX
  1483     GO TO 0079-READ--EXIT.                                       ELCDTERX
  1484                                                                  ELCDTERX
  1485 0065-READ--COLC.                                                 ELCDTERX
  1486     MOVE DATE-DISK              TO CLASIC-SYSTEM-CODES.          ELCDTERX
  1487     GO TO 0005-READ--CARD.                                       ELCDTERX
  1488                                                                  ELCDTERX
  1489 0070-READ--OPCA.                                                 ELCDTERX
  1490                                                                  ELCDTERX
  1491     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  1492                                                                  ELCDTERX
  1493     IF  CLAS-INDEX GREATER 13                                    ELCDTERX
  1494             OR                                                   ELCDTERX
  1495         DD-CARR-FLDS (CLAS-INDEX) = SPACE                        ELCDTERX
  1496         GO TO 0005-READ--CARD.                                   ELCDTERX
  1497                                                                  ELCDTERX
  1498     ADD 1                       TO INDEXCA.                      ELCDTERX
  1499     MOVE DD-CARR-FLDS (CLAS-INDEX)                               ELCDTERX
  1500                                 TO CARRIER-FLDS (INDEXCA).       ELCDTERX
  1501     GO TO 0070-READ--OPCA.                                       ELCDTERX
  1502                                                                  ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  32
* ECS0561.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  1503 0072-READ--OPST.                                                 ELCDTERX
  1504                                                                  ELCDTERX
  1505     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  1506                                                                  ELCDTERX
  1507     IF  CLAS-INDEX GREATER 16                                    ELCDTERX
  1508             OR                                                   ELCDTERX
  1509         DD-TLR (CLAS-INDEX) = SPACE                              ELCDTERX
  1510         GO TO 0005-READ--CARD.                                   ELCDTERX
  1511                                                                  ELCDTERX
  1512     ADD 1                       TO INDEXST.                      ELCDTERX
  1513     MOVE DD-STATE-FLDS (CLAS-INDEX)                              ELCDTERX
  1514                                 TO STATE-TLR-FLD (INDEXST).      ELCDTERX
  1515     GO TO 0072-READ--OPST.                                       ELCDTERX
  1516                                                                  ELCDTERX
  1517 0074-READ--OPBS.                                                 ELCDTERX
  1518                                                                  ELCDTERX
  1519     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  1520                                                                  ELCDTERX
  1521     IF  CLAS-INDEX GREATER 32                                    ELCDTERX
  1522             OR                                                   ELCDTERX
  1523         DD-TLR (CLAS-INDEX) = SPACE                              ELCDTERX
  1524         GO TO 0005-READ--CARD.                                   ELCDTERX
  1525                                                                  ELCDTERX
  1526     ADD 1                       TO INDEXBS.                      ELCDTERX
  1527     MOVE DD-TLR (CLAS-INDEX)    TO BUS-TLRM-FLD (INDEXBS).       ELCDTERX
  1528     GO TO 0074-READ--OPBS.                                       ELCDTERX
  1529                                                                  ELCDTERX
  1530 0079-READ--EXIT.                                                 ELCDTERX
  1531*    EXIT.                                                        ELCDTERX
  1532******************************************************************ELCDTERX
  1533
  1534     MOVE COMPANY-NAME           TO  HD-CO
  1535*    MOVE SPACES                 TO  SAVE-COMPANY-NAME
  1536     MOVE ALPH-DATE              TO  HD-DT
  1537     MOVE WS-CURRENT-DATE        TO  HD-RUN-DT
  1538*    MOVE SPACE-NP               TO  P-REC
  1539
  1540     MOVE RUN-DATE               TO WS-TEST-RUN-DATE
  1541
  1542     PERFORM 0010-INITIALIZE     THRU 0010-EXIT
  1543
  1544     PERFORM 0020-OPEN-FILES     THRU 0020-EXIT
  1545
  1546     PERFORM 0050-PROCESS-FILE   THRU 0050-EXIT
  1547
  1548     PERFORM 0030-CLOSE-FILES    THRU 0030-EXIT
  1549
  1550
  1551     GOBACK
  1552     .
  1553
  1554 0010-INITIALIZE.
  1555
  1556
  1557     MOVE +0                     TO WS-EXP-PREM
  1558                                    WS-REC-PREM
  1559                                    WS-GA-COMM
  1560                                    WS-BASE-COMM
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  33
* ECS0561.cbl
  1561
  1562     PERFORM VARYING WS-A FROM +1 BY +1 UNTIL
  1563        (WS-A > +5)
  1564        MOVE +0                  TO WS-TOT-EXP-PREM (WS-A)
  1565                                    WS-TOT-REC-PREM (WS-A)
  1566                                    WS-TOT-BASE-COMM (WS-A)
  1567                                    WS-TOT-GA-COMM  (WS-A)
  1568                                    WS-TOT-BAL-FWD  (WS-A)
  1569                                    WS-TOT-ADJS     (WS-A)
  1570                                    WS-TOT-END-BAL  (WS-A)
  1571                                    WS-TOT-DUE-COMM (WS-A)
  1572     END-PERFORM
  1573
  1574     PERFORM VARYING WS-A FROM +1 BY +1 UNTIL
  1575        (WS-A > +55)
  1576        MOVE LOW-VALUES          TO WS-FREE-STATE (WS-A)
  1577        MOVE +0                  TO WS-FREE-PREM (WS-A)
  1578                                    WS-FREE-COMM (WS-A)
  1579     END-PERFORM
  1580
  1581     MOVE RUN-DATE               TO WS-WORK-DATE
  1582     MOVE WS-WORK-MMDD           TO WS-POSTING-DATE (1:4)
  1583     MOVE WS-WORK-CCYY           TO WS-POSTING-DATE (5:4)
  1584
  1585     .
  1586
  1587 0010-EXIT.
  1588     EXIT.
  1589
  1590 0020-OPEN-FILES.
  1591
  1592     OPEN INPUT ERDUEP
  1593         OUTPUT PRINTX FREEDOM-EXTRACT
  1594
  1595     IF ERDUEP-FILE-STATUS = '00' OR '97'
  1596        CONTINUE
  1597     ELSE
  1598        DISPLAY ' ERROR ON ERDUEP OPEN  '
  1599           ERDUEP-FILE-STATUS
  1600        MOVE ' ERROR ON ERDUEP OPEN  '
  1601                                 TO WS-ABEND-MESSAGE
  1602        MOVE ERDUEP-FILE-STATUS  TO WS-ABEND-FILE-STATUS
  1603        PERFORM ABEND-PGM
  1604     END-IF
  1605
  1606
  1607     .
  1608
  1609 0020-EXIT.
  1610     EXIT.
  1611
  1612 0030-CLOSE-FILES.
  1613
  1614     DISPLAY ' MADE IT TO CLOSE FILES '
  1615
  1616     CLOSE PRINTX
  1617           ERDUEP FREEDOM-EXTRACT
  1618
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  34
* ECS0561.cbl
  1619     IF ERDUEP-FILE-STATUS = '00' OR '97'
  1620        CONTINUE
  1621     ELSE
  1622        DISPLAY ' ERROR ON ERDUEP CLOSE '
  1623           ERDUEP-FILE-STATUS
  1624        MOVE ' ERROR ON ERDUEP OPEN  '
  1625                                 TO WS-ABEND-MESSAGE
  1626        MOVE ERDUEP-FILE-STATUS  TO WS-ABEND-FILE-STATUS
  1627        PERFORM ABEND-PGM
  1628     END-IF
  1629
  1630
  1631     .
  1632
  1633 0030-EXIT.
  1634     EXIT.
  1635
  1636 0040-START-ERDUEP.
  1637
  1638     MOVE LOW-VALUES             TO DP-CONTROL-PRIMARY
  1639     MOVE DTE-CLASIC-COMPANY-CD  TO DP-COMPANY-CD
  1640     START ERDUEP KEY IS NOT < DP-CONTROL-PRIMARY
  1641
  1642     IF ERDUEP-FILE-STATUS = '10' OR '23'
  1643        SET END-OF-ERDUEP        TO TRUE
  1644     ELSE
  1645        IF ERDUEP-FILE-STATUS NOT = '00'
  1646           MOVE ' ERROR ON ERDUEP  START     '
  1647                                 TO WS-ABEND-MESSAGE
  1648           MOVE ERDUEP-FILE-STATUS
  1649                                 TO WS-ABEND-FILE-STATUS
  1650           DISPLAY WS-ABEND-MESSAGE '  ' WS-ABEND-FILE-STATUS
  1651           PERFORM ABEND-PGM
  1652        END-IF
  1653     END-IF
  1654
  1655     .
  1656
  1657 0040-EXIT.
  1658     EXIT.
  1659
  1660 0050-PROCESS-FILE.
  1661
  1662     PERFORM 0040-START-ERDUEP   THRU 0040-EXIT
  1663     PERFORM 0060-READ-ERDUEP    THRU 0060-EXIT
  1664     MOVE DP-ACCOUNT-CONTROL     TO WS-HOLD-CONTROL
  1665     PERFORM 0080-PROCESS-ERDUEP THRU 0080-EXIT UNTIL
  1666           END-OF-ERDUEP
  1667     DISPLAY ' END OF 0080 PROCESS '
  1668     PERFORM 0300-ACCT-BREAK     THRU 0300-EXIT
  1669     PERFORM 0310-ST-BREAK       THRU 0310-EXIT
  1670     PERFORM 0320-GRP-BREAK      THRU 0320-EXIT
  1671     PERFORM 0330-CAR-BREAK      THRU 0330-EXIT
  1672     PERFORM 0340-FIN-BREAK      THRU 0340-EXIT
  1673     PERFORM 0350-CREATE-FREEDOM THRU 0350-EXIT
  1674
  1675     .
  1676 0050-EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  35
* ECS0561.cbl
  1677     EXIT.
  1678
  1679 0060-READ-ERDUEP.
  1680
  1681     READ ERDUEP NEXT RECORD
  1682
  1683     IF ERDUEP-FILE-STATUS = '10' OR '23'
  1684        SET END-OF-ERDUEP        TO TRUE
  1685     ELSE
  1686        IF ERDUEP-FILE-STATUS NOT = '00'
  1687           MOVE ' ERROR ON ERDUEP READ NEXT  '
  1688                                 TO WS-ABEND-MESSAGE
  1689           MOVE ERDUEP-FILE-STATUS
  1690                                 TO WS-ABEND-FILE-STATUS
  1691           DISPLAY WS-ABEND-MESSAGE '  ' WS-ABEND-FILE-STATUS
  1692           PERFORM ABEND-PGM
  1693        ELSE
  1694           ADD +1                TO ERDUEP-IN-CNT
  1695        END-IF
  1696     END-IF
  1697
  1698     .
  1699 0060-EXIT.
  1700     EXIT.
  1701
  1702 0080-PROCESS-ERDUEP.
  1703
  1704     IF DP-ACCOUNT-CONTROL NOT = WS-HOLD-CONTROL
  1705        PERFORM 0250-BREAK-RTN   THRU 0250-EXIT
  1706     END-IF
  1707
  1708     COMPUTE WS-TOT-BAL-FWD (1) = WS-TOT-BAL-FWD (1)
  1709        + DP-BAL-FWD
  1710
  1711     COMPUTE WS-TOT-EXP-PREM (1) = WS-TOT-EXP-PREM (1)
  1712        + DP-EXP-PREM
  1713
  1714     COMPUTE WS-TOT-REC-PREM (1) = WS-TOT-REC-PREM (1)
  1715        + DP-REC-PREM
  1716
  1717     COMPUTE WS-TOT-GA-COMM (1) = WS-TOT-GA-COMM (1)
  1718        + DP-GA-COMM
  1719
  1720     COMPUTE WS-TOT-BASE-COMM (1) = WS-TOT-BASE-COMM (1)
  1721        + DP-BASE-COMM
  1722
  1723     COMPUTE WS-TOT-ADJS (1)    = WS-TOT-ADJS (1)
  1724        + DP-ADJUSTMENTS
  1725
  1726     IF DP-END-BAL NOT NUMERIC
  1727        MOVE ZERO TO DP-END-BAL
  1728     END-IF
  1729     COMPUTE WS-TOT-END-BAL (1) = WS-TOT-END-BAL (1)
  1730        + DP-END-BAL
  1731
  1732     IF (DP-EXP-PREM + DP-BASE-COMM) NOT = ZEROS
  1733        COMPUTE WS-BASE-PCT = DP-BASE-COMM
  1734           / (DP-EXP-PREM + DP-BASE-COMM)
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  36
* ECS0561.cbl
  1735        COMPUTE WS-OW-PCT   = DP-GA-COMM
  1736           / (DP-EXP-PREM + DP-BASE-COMM)
  1737        COMPUTE WS-DUE-COMM = (DP-END-BAL
  1738           / (1 - WS-BASE-PCT)) * WS-OW-PCT
  1739        COMPUTE WS-TOT-DUE-COMM (1) = WS-TOT-DUE-COMM (1)
  1740           + WS-DUE-COMM
  1741     END-IF
  1742
  1743     MOVE DP-ACCOUNT-CONTROL     TO WS-HOLD-CONTROL
  1744
  1745     PERFORM 0060-READ-ERDUEP    THRU 0060-EXIT
  1746
  1747     .
  1748
  1749 0080-EXIT.
  1750     EXIT.
  1751
  1752
  1753
  1754 0250-BREAK-RTN.
  1755
  1756     IF WS-HOLD-CAR NOT = DP-CARRIER
  1757        PERFORM 0300-ACCT-BREAK  THRU 0300-EXIT
  1758        PERFORM 0310-ST-BREAK    THRU 0310-EXIT
  1759        PERFORM 0320-GRP-BREAK   THRU 0320-EXIT
  1760        PERFORM 0330-CAR-BREAK   THRU 0330-EXIT
  1761     ELSE
  1762        IF WS-HOLD-GRP NOT = DP-GROUPING
  1763           PERFORM 0300-ACCT-BREAK
  1764                                 THRU 0300-EXIT
  1765           PERFORM 0310-ST-BREAK THRU 0310-EXIT
  1766           PERFORM 0320-GRP-BREAK
  1767                                 THRU 0320-EXIT
  1768        ELSE
  1769           IF WS-HOLD-ST NOT = DP-STATE
  1770              PERFORM 0300-ACCT-BREAK
  1771                                 THRU 0300-EXIT
  1772              PERFORM 0310-ST-BREAK
  1773                                 THRU 0310-EXIT
  1774           ELSE
  1775              IF WS-HOLD-ACCT NOT = DP-ACCOUNT
  1776                 PERFORM 0300-ACCT-BREAK
  1777                                 THRU 0300-EXIT
  1778              END-IF
  1779           END-IF
  1780        END-IF
  1781     END-IF
  1782     .
  1783 0250-EXIT.
  1784     EXIT.
  1785
  1786 0300-ACCT-BREAK.
  1787
  1788     IF (WS-TOT-EXP-PREM (1) = ZEROS)
  1789        AND (WS-TOT-REC-PREM (1) = ZEROS)
  1790        AND (WS-TOT-GA-COMM (1)  = ZEROS)
  1791        AND (WS-TOT-END-BAL (1)  = ZEROS)
  1792        AND (WS-TOT-BAL-FWD (1)  = ZEROS)
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  37
* ECS0561.cbl
  1793        AND (WS-TOT-ADJS (1)     = ZEROS)
  1794        DISPLAY ' ALL ZEROS '
  1795        CONTINUE
  1796     ELSE
  1797        MOVE SPACES              TO DETAIL-LINE
  1798        MOVE WS-HOLD-CAR         TO DTL1-CAR
  1799        MOVE WS-HOLD-GRP         TO DTL1-GRP
  1800        MOVE WS-HOLD-ST          TO DTL1-ST
  1801        MOVE WS-HOLD-ACCT        TO DTL1-ACCT
  1802        MOVE WS-TOT-BAL-FWD (1)  TO DTL1-BEG-BAL
  1803        MOVE WS-TOT-EXP-PREM (1) TO DTL1-EXP-PREM
  1804        MOVE WS-TOT-REC-PREM (1) TO DTL1-REC-PREM
  1805        MOVE WS-TOT-ADJS (1)     TO DTL1-ADJS
  1806        MOVE WS-TOT-END-BAL (1)  TO DTL1-END-BAL
  1807        MOVE WS-TOT-DUE-COMM (1) TO DTL1-COMM
  1808        MOVE DETAIL-LINE         TO P-DATA
  1809        MOVE SPACE-2             TO P-CTL
  1810        PERFORM 8800-PRT-RTN     THRU 8800-EXIT
  1811
  1812        COMPUTE WS-TOT-BAL-FWD  (2) = WS-TOT-BAL-FWD  (2)
  1813           + WS-TOT-BAL-FWD  (1)
  1814        COMPUTE WS-TOT-EXP-PREM (2) = WS-TOT-EXP-PREM (2)
  1815           + WS-TOT-EXP-PREM (1)
  1816        COMPUTE WS-TOT-REC-PREM (2) = WS-TOT-REC-PREM (2)
  1817           + WS-TOT-REC-PREM (1)
  1818        COMPUTE WS-TOT-BASE-COMM  (2) = WS-TOT-BASE-COMM  (2)
  1819           + WS-TOT-BASE-COMM  (1)
  1820        COMPUTE WS-TOT-GA-COMM  (2) = WS-TOT-GA-COMM  (2)
  1821           + WS-TOT-GA-COMM  (1)
  1822        COMPUTE WS-TOT-ADJS     (2) = WS-TOT-ADJS     (2)
  1823           + WS-TOT-ADJS     (1)
  1824        COMPUTE WS-TOT-END-BAL  (2) = WS-TOT-END-BAL  (2)
  1825           + WS-TOT-END-BAL  (1)
  1826        COMPUTE WS-TOT-DUE-COMM (2) = WS-TOT-DUE-COMM (2)
  1827           + WS-TOT-DUE-COMM (1)
  1828     END-IF
  1829
  1830     MOVE +0                     TO WS-TOT-EXP-PREM (1)
  1831                                    WS-TOT-REC-PREM (1)
  1832                                    WS-TOT-BASE-COMM (1)
  1833                                    WS-TOT-GA-COMM  (1)
  1834                                    WS-TOT-BAL-FWD  (1)
  1835                                    WS-TOT-ADJS     (1)
  1836                                    WS-TOT-END-BAL  (1)
  1837                                    WS-TOT-DUE-COMM (1)
  1838     .
  1839 0300-EXIT.
  1840     EXIT.
  1841
  1842 0310-ST-BREAK.
  1843
  1844     IF (WS-TOT-EXP-PREM (2) = ZEROS)
  1845        AND (WS-TOT-REC-PREM (2) = ZEROS)
  1846        AND (WS-TOT-GA-COMM (2)  = ZEROS)
  1847        AND (WS-TOT-END-BAL (2)  = ZEROS)
  1848        AND (WS-TOT-BAL-FWD (2)  = ZEROS)
  1849        AND (WS-TOT-ADJS (2)     = ZEROS)
  1850        CONTINUE
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  38
* ECS0561.cbl
  1851     ELSE
  1852        MOVE SPACES              TO DETAIL-LINE
  1853        MOVE WS-HOLD-CAR         TO DTL1-CAR
  1854        MOVE WS-HOLD-GRP         TO DTL1-GRP
  1855        MOVE WS-HOLD-ST          TO DTL1-ST
  1856        MOVE SPACES              TO DTL1-ACCT
  1857        MOVE WS-TOT-BAL-FWD (2)  TO DTL1-BEG-BAL
  1858        MOVE WS-TOT-EXP-PREM (2) TO DTL1-EXP-PREM
  1859        MOVE WS-TOT-REC-PREM (2) TO DTL1-REC-PREM
  1860        MOVE WS-TOT-ADJS (2)     TO DTL1-ADJS
  1861        MOVE WS-TOT-END-BAL (2)  TO DTL1-END-BAL
  1862        MOVE WS-TOT-DUE-COMM (2) TO DTL1-COMM
  1863        MOVE DETAIL-LINE         TO P-DATA
  1864        MOVE SPACE-2             TO P-CTL
  1865        PERFORM VARYING WS-A FROM +1 BY +1 UNTIL
  1866           (WS-FREE-STATE (WS-A) = LOW-VALUES)
  1867           OR (WS-FREE-STATE (WS-A) = WS-HOLD-ST)
  1868           OR (WS-A > +55)
  1869        END-PERFORM
  1870        IF WS-A NOT > +55
  1871           MOVE WS-HOLD-ST       TO WS-FREE-STATE (WS-A)
  1872           COMPUTE WS-FREE-PREM (WS-A) = WS-FREE-PREM (WS-A)
  1873              + WS-TOT-END-BAL (2)
  1874           COMPUTE WS-FREE-COMM (WS-A) = WS-FREE-COMM (WS-A)
  1875              + WS-TOT-DUE-COMM (2)
  1876        ELSE
  1877           DISPLAY ' FREEDOM TABLE EXCEEDED '
  1878           PERFORM ABEND-PGM
  1879        END-IF
  1880        PERFORM 8800-PRT-RTN     THRU 8800-EXIT
  1881
  1882        COMPUTE WS-TOT-BAL-FWD (3)  = WS-TOT-BAL-FWD (3)
  1883           + WS-TOT-BAL-FWD (2)
  1884        COMPUTE WS-TOT-EXP-PREM (3) = WS-TOT-EXP-PREM (3)
  1885           + WS-TOT-EXP-PREM (2)
  1886        COMPUTE WS-TOT-REC-PREM (3) = WS-TOT-REC-PREM (3)
  1887           + WS-TOT-REC-PREM (2)
  1888        COMPUTE WS-TOT-BASE-COMM  (3) = WS-TOT-BASE-COMM  (3)
  1889           + WS-TOT-BASE-COMM  (2)
  1890        COMPUTE WS-TOT-GA-COMM (3) = WS-TOT-GA-COMM (3)
  1891           + WS-TOT-GA-COMM (2)
  1892        COMPUTE WS-TOT-ADJS (3)     = WS-TOT-ADJS (3)
  1893           + WS-TOT-ADJS (2)
  1894        COMPUTE WS-TOT-END-BAL (3)  = WS-TOT-END-BAL (3)
  1895           + WS-TOT-END-BAL (2)
  1896        COMPUTE WS-TOT-DUE-COMM (3) = WS-TOT-DUE-COMM (3)
  1897           + WS-TOT-DUE-COMM (2)
  1898     END-IF
  1899
  1900     MOVE +0                     TO WS-TOT-EXP-PREM (2)
  1901                                    WS-TOT-REC-PREM (2)
  1902                                    WS-TOT-BASE-COMM (2)
  1903                                    WS-TOT-GA-COMM  (2)
  1904                                    WS-TOT-BAL-FWD  (2)
  1905                                    WS-TOT-ADJS     (2)
  1906                                    WS-TOT-END-BAL  (2)
  1907                                    WS-TOT-DUE-COMM (2)
  1908
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  39
* ECS0561.cbl
  1909     .
  1910 0310-EXIT.
  1911     EXIT.
  1912
  1913 0320-GRP-BREAK.
  1914
  1915     IF (WS-TOT-EXP-PREM (3) = ZEROS)
  1916        AND (WS-TOT-REC-PREM (3) = ZEROS)
  1917        AND (WS-TOT-GA-COMM (3)  = ZEROS)
  1918        AND (WS-TOT-END-BAL (3)  = ZEROS)
  1919        AND (WS-TOT-BAL-FWD (3)  = ZEROS)
  1920        AND (WS-TOT-ADJS (3)     = ZEROS)
  1921        CONTINUE
  1922     ELSE
  1923        MOVE SPACES              TO DETAIL-LINE
  1924        MOVE WS-HOLD-CAR         TO DTL1-CAR
  1925        MOVE WS-HOLD-GRP         TO DTL1-GRP
  1926        MOVE SPACES              TO DTL1-ST
  1927        MOVE SPACES              TO DTL1-ACCT
  1928        MOVE WS-TOT-BAL-FWD (3)  TO DTL1-BEG-BAL
  1929        MOVE WS-TOT-EXP-PREM (3) TO DTL1-EXP-PREM
  1930        MOVE WS-TOT-REC-PREM (3) TO DTL1-REC-PREM
  1931        MOVE WS-TOT-ADJS (3)     TO DTL1-ADJS
  1932        MOVE WS-TOT-END-BAL (3)  TO DTL1-END-BAL
  1933        MOVE WS-TOT-DUE-COMM (3) TO DTL1-COMM
  1934        MOVE DETAIL-LINE         TO P-DATA
  1935        MOVE SPACE-2             TO P-CTL
  1936        PERFORM 8800-PRT-RTN     THRU 8800-EXIT
  1937
  1938        COMPUTE WS-TOT-BAL-FWD (4)  = WS-TOT-BAL-FWD (4)
  1939           + WS-TOT-BAL-FWD (3)
  1940        COMPUTE WS-TOT-EXP-PREM (4) = WS-TOT-EXP-PREM (4)
  1941           + WS-TOT-EXP-PREM (3)
  1942        COMPUTE WS-TOT-REC-PREM (4) = WS-TOT-REC-PREM (4)
  1943           + WS-TOT-REC-PREM (3)
  1944        COMPUTE WS-TOT-BASE-COMM  (4) = WS-TOT-BASE-COMM  (4)
  1945           + WS-TOT-BASE-COMM  (3)
  1946        COMPUTE WS-TOT-GA-COMM (4) = WS-TOT-GA-COMM (4)
  1947           + WS-TOT-GA-COMM (3)
  1948        COMPUTE WS-TOT-ADJS (4)     = WS-TOT-ADJS (4)
  1949           + WS-TOT-ADJS (3)
  1950        COMPUTE WS-TOT-END-BAL (4)  = WS-TOT-END-BAL (4)
  1951           + WS-TOT-END-BAL (3)
  1952        COMPUTE WS-TOT-DUE-COMM (4) = WS-TOT-DUE-COMM (4)
  1953           + WS-TOT-DUE-COMM (3)
  1954     END-IF
  1955
  1956     MOVE +0                     TO WS-TOT-EXP-PREM (3)
  1957                                    WS-TOT-REC-PREM (3)
  1958                                    WS-TOT-BASE-COMM (3)
  1959                                    WS-TOT-GA-COMM  (3)
  1960                                    WS-TOT-BAL-FWD  (3)
  1961                                    WS-TOT-ADJS     (3)
  1962                                    WS-TOT-END-BAL  (3)
  1963                                    WS-TOT-DUE-COMM (3)
  1964
  1965     .
  1966 0320-EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  40
* ECS0561.cbl
  1967     EXIT.
  1968
  1969 0330-CAR-BREAK.
  1970
  1971     IF (WS-TOT-EXP-PREM (4) = ZEROS)
  1972        AND (WS-TOT-REC-PREM (4) = ZEROS)
  1973        AND (WS-TOT-GA-COMM (4)  = ZEROS)
  1974        AND (WS-TOT-END-BAL (4)  = ZEROS)
  1975        AND (WS-TOT-BAL-FWD (4)  = ZEROS)
  1976        AND (WS-TOT-ADJS (4)     = ZEROS)
  1977        CONTINUE
  1978     ELSE
  1979        MOVE SPACES              TO DETAIL-LINE
  1980        MOVE WS-HOLD-CAR         TO DTL1-CAR
  1981        MOVE SPACES              TO DTL1-GRP
  1982        MOVE SPACES              TO DTL1-ST
  1983        MOVE SPACES              TO DTL1-ACCT
  1984        MOVE WS-TOT-BAL-FWD (4)  TO DTL1-BEG-BAL
  1985        MOVE WS-TOT-EXP-PREM (4) TO DTL1-EXP-PREM
  1986        MOVE WS-TOT-REC-PREM (4) TO DTL1-REC-PREM
  1987        MOVE WS-TOT-ADJS (4)     TO DTL1-ADJS
  1988        MOVE WS-TOT-END-BAL (4)  TO DTL1-END-BAL
  1989        MOVE WS-TOT-DUE-COMM (4) TO DTL1-COMM
  1990        MOVE DETAIL-LINE         TO P-DATA
  1991        MOVE SPACE-2             TO P-CTL
  1992        PERFORM 8800-PRT-RTN     THRU 8800-EXIT
  1993
  1994        COMPUTE WS-TOT-BAL-FWD (5)  = WS-TOT-BAL-FWD (5)
  1995           + WS-TOT-BAL-FWD (4)
  1996        COMPUTE WS-TOT-EXP-PREM (5) = WS-TOT-EXP-PREM (5)
  1997           + WS-TOT-EXP-PREM (4)
  1998        COMPUTE WS-TOT-REC-PREM (5) = WS-TOT-REC-PREM (5)
  1999           + WS-TOT-REC-PREM (4)
  2000        COMPUTE WS-TOT-BASE-COMM  (5) = WS-TOT-BASE-COMM  (5)
  2001           + WS-TOT-BASE-COMM  (4)
  2002        COMPUTE WS-TOT-GA-COMM (5) = WS-TOT-GA-COMM (5)
  2003           + WS-TOT-GA-COMM (4)
  2004        COMPUTE WS-TOT-ADJS (5)     = WS-TOT-ADJS (5)
  2005           + WS-TOT-ADJS (4)
  2006        COMPUTE WS-TOT-END-BAL (5)  = WS-TOT-END-BAL (5)
  2007           + WS-TOT-END-BAL (4)
  2008        COMPUTE WS-TOT-DUE-COMM (5) = WS-TOT-DUE-COMM (5)
  2009           + WS-TOT-DUE-COMM (4)
  2010     END-IF
  2011
  2012     MOVE +0                     TO WS-TOT-EXP-PREM (4)
  2013                                    WS-TOT-REC-PREM (4)
  2014                                    WS-TOT-BASE-COMM (4)
  2015                                    WS-TOT-GA-COMM  (4)
  2016                                    WS-TOT-BAL-FWD  (4)
  2017                                    WS-TOT-ADJS     (4)
  2018                                    WS-TOT-END-BAL  (4)
  2019                                    WS-TOT-DUE-COMM (4)
  2020
  2021     .
  2022 0330-EXIT.
  2023     EXIT.
  2024
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  41
* ECS0561.cbl
  2025 0340-FIN-BREAK.
  2026
  2027     DISPLAY ' MADE IT TO 0340  FIN BREAK '
  2028
  2029     IF (WS-TOT-EXP-PREM (5) = ZEROS)
  2030        AND (WS-TOT-REC-PREM (5) = ZEROS)
  2031        AND (WS-TOT-GA-COMM (5)  = ZEROS)
  2032        AND (WS-TOT-END-BAL (5)  = ZEROS)
  2033        AND (WS-TOT-BAL-FWD (5)  = ZEROS)
  2034        AND (WS-TOT-ADJS (5)     = ZEROS)
  2035        CONTINUE
  2036     ELSE
  2037        MOVE SPACES              TO DETAIL-LINE
  2038        MOVE SPACES              TO DTL1-CAR
  2039        MOVE SPACES              TO DTL1-GRP
  2040        MOVE SPACES              TO DTL1-ST
  2041        MOVE SPACES              TO DTL1-ACCT
  2042        MOVE WS-TOT-BAL-FWD (5)  TO DTL1-BEG-BAL
  2043        MOVE WS-TOT-EXP-PREM (5) TO DTL1-EXP-PREM
  2044        MOVE WS-TOT-REC-PREM (5) TO DTL1-REC-PREM
  2045        MOVE WS-TOT-ADJS (5)     TO DTL1-ADJS
  2046        MOVE WS-TOT-END-BAL (5)  TO DTL1-END-BAL
  2047        MOVE WS-TOT-DUE-COMM (5) TO DTL1-COMM
  2048        MOVE DETAIL-LINE         TO P-DATA
  2049        MOVE SPACE-2             TO P-CTL
  2050        PERFORM 8800-PRT-RTN     THRU 8800-EXIT
  2051
  2052     END-IF
  2053
  2054     .
  2055 0340-EXIT.
  2056     EXIT.
  2057
  2058 0350-CREATE-FREEDOM.
  2059
  2060     MOVE SPACES                 TO WS-EXTRACT-RECORD
  2061     MOVE 'LPACDUEPC'            TO FX-SYSTEM
  2062     MOVE 'LOGIC '               TO FX-SOURCE-CODE
  2063     MOVE '11'                   TO FX-DIVISION
  2064     MOVE '15'                   TO FX-SUB-TYPE
  2065
  2066     MOVE 'Y'                    TO FX-LOC-CODE
  2067
  2068     MOVE WS-POSTING-DATE        TO FX-POSTING-DATE
  2069
  2070     IF DTE-CLIENT = 'CID'
  2071        MOVE 'S'                 TO FX-FY-REN
  2072     ELSE
  2073        MOVE ' '                 TO FX-FY-REN
  2074     END-IF
  2075
  2076     MOVE ZEROS                  TO FX-AMOUNT
  2077
  2078     PERFORM VARYING WS-A FROM +1 BY +1 UNTIL
  2079        (WS-A > +55)
  2080        OR (WS-FREE-STATE (WS-A) = LOW-VALUES)
  2081        MOVE WS-FREE-STATE (WS-A)
  2082                                 TO FX-STATE
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  42
* ECS0561.cbl
  2083        MOVE 'DUE PREMIUM '      TO FX-DESCRIPTION
  2084        MOVE WS-FREE-PREM (WS-A) TO FX-AMOUNT
  2085        MOVE '30'                TO FX-TRAN-TYPE
  2086        WRITE FREEDOM-RECORD     FROM WS-EXTRACT-RECORD
  2087        MOVE 'DUE COMMISSION'    TO FX-DESCRIPTION
  2088        MOVE WS-FREE-COMM (WS-A) TO FX-AMOUNT
  2089        MOVE '50'                TO FX-TRAN-TYPE
  2090        WRITE FREEDOM-RECORD     FROM WS-EXTRACT-RECORD
  2091     END-PERFORM
  2092
  2093     .
  2094 0350-EXIT.
  2095     EXIT.
  2096
  2097 2900-DISPLAY-AMTS.
  2098
  2099*    IF (CR-DT > 19921231) AND
  2100*       (CR-DT < 19940101) AND
  2101*    IF (WS-BIN-VAL-DATES (VYR) = X'95FF')
  2102*       MOVE CR-DT TO WS-DISPLAY-DATE
  2103*       MOVE CR-LF-TERM TO WS-DISPLAY-TERM
  2104*       MOVE LF-REM-TRM2 TO WS-DISPLAY-RTERM
  2105*       MOVE CR-LFPRM TO WS-DISPLAY-PRM
  2106*       IF CLAS-I-EP (CLAS-INDEXL) EQUAL 'B' OR 'K' OR 'L'
  2107*          ADD CR-LFAMT CR-LFAMT-ALT GIVING WS-DISPLAY-AMT
  2108*       ELSE
  2109*          MOVE CR-LFAMT     TO WS-DISPLAY-AMT
  2110*       END-IF
  2111*       MOVE WS-REM-AMT   TO WS-DISPLAY-RAMT
  2112*       DISPLAY '  ' CR-CERT-NO '  ' WS-DISPLAY-DATE '   '
  2113*        WS-DISPLAY-TERM '  ' WS-DISPLAY-RTERM '   '
  2114*        WS-DISPLAY-AMT '   ' WS-DISPLAY-RAMT
  2115*    END-IF
  2116
  2117     .
  2118 2999-CALC-REM-AMT-X.
  2119     EXIT.
  2120
  2121 8600-HD-RTN.
  2122     MOVE +0                     TO LNCTR
  2123     MOVE HD1                    TO  P-DATA
  2124     MOVE SPACE-NP               TO  P-CTL
  2125
  2126     PERFORM 8800-PRT-RTN  THRU  8800-EXIT
  2127
  2128     ADD +1                      TO  PGCTR
  2129
  2130     MOVE PGCTR                  TO  HD-PG
  2131     MOVE HD2                    TO  P-DATA
  2132     MOVE SPACE-1                TO  P-CTL
  2133
  2134     PERFORM 8800-PRT-RTN  THRU  8800-EXIT
  2135
  2136     MOVE HD3                    TO  P-DATA
  2137     MOVE SPACE-1                TO  P-CTL
  2138
  2139     PERFORM 8800-PRT-RTN  THRU  8800-EXIT
  2140
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  43
* ECS0561.cbl
  2141     MOVE SPACE-2                TO  P-CTL
  2142     MOVE HD4                    TO  P-DATA
  2143
  2144     PERFORM 8800-PRT-RTN  THRU  8800-EXIT
  2145
  2146     MOVE HD5                    TO  P-DATA
  2147     MOVE SPACE-1                TO  P-CTL
  2148     PERFORM 8800-PRT-RTN  THRU  8800-EXIT
  2149
  2150     MOVE SPACES                 TO  P-DATA
  2151     MOVE SPACE-1                TO  P-CTL
  2152     PERFORM 8800-PRT-RTN  THRU  8800-EXIT
  2153
  2154     MOVE +10                    TO  LNCTR
  2155*    MOVE SPACE-2                TO  P-CTL
  2156
  2157     .
  2158 8699-EXIT.
  2159     EXIT.
  2160
  2161 8800-PRT-RTN.
  2162
  2163     IF LNCTR > +56
  2164        MOVE PRT                 TO WS-HOLD-PRT
  2165        PERFORM 8600-HD-RTN      THRU 8699-EXIT
  2166        MOVE WS-HOLD-PRT         TO PRT
  2167     END-IF
  2168
  2169     MOVE P-CTL                  TO X
  2170     IF P-CTL = SPACE-1
  2171        ADD +1                   TO LNCTR
  2172     ELSE
  2173        IF P-CTL = SPACE-2
  2174           ADD +2                TO LNCTR
  2175        ELSE
  2176           IF P-CTL = SPACE-3
  2177              ADD +3             TO LNCTR
  2178           END-IF
  2179        END-IF
  2180     END-IF
  2181
  2182     .
  2183 8850-COPY-PRT-RTN.
* 2184                                 COPY ELCPRT2.
  2185******************************************************************04/15/98
  2186*                                                                *ELCPRT2
  2187*                                                                *ELCPRT2
  2188*                            ELCPRT2                             *   LV005
  2189*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**5
  2190*                            VMOD=2.002                          *   CL**5
  2191*                                                                *   CL**4
  2192******************************************************************   CL**4
  2193                                                                     CL**4
  2194     IF DTE-FICH NOT = SPACE AND                                     CL**4
  2195        FICH-OPEN    = SPACE                                         CL**4
  2196         MOVE 'X'                TO  FICH-OPEN                       CL**4
  2197         OPEN OUTPUT FICH.                                           CL**4
  2198                                                                     CL**4
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  44
* ECS0561.cbl (/apps/prod/cid1p/copy/ELCPRT2)
  2199     IF DTE-FICH NOT = SPACE                                         CL**4
  2200         MOVE X                  TO  P-CTL                           CL**4
  2201         WRITE FICH-REC FROM PRT.                                    CL**4
  2202                                                                     CL**4
  2203     IF DTE-FICH = SPACE OR '2'                                      CL**4
  2204       MOVE X                    TO  P-CTL                           CL**4
  2205       IF P-CTL = ' '                                                CL**4
  2206         WRITE PRT AFTER ADVANCING 1 LINE                            CL**4
  2207       ELSE                                                          CL**4
  2208         IF P-CTL = '0'                                              CL**4
  2209           WRITE PRT AFTER ADVANCING 2 LINES                         CL**4
  2210         ELSE                                                        CL**4
  2211           IF P-CTL = '-'                                            CL**4
  2212             WRITE PRT AFTER ADVANCING 3 LINES                       CL**4
  2213           ELSE                                                      CL**4
  2214             WRITE PRT AFTER ADVANCING PAGE.                         CL**4
  2215                                                                     CL**4
  2216******************************************************************   CL**4
  2217
  2218 8800-EXIT.
  2219     EXIT.
  2220
  2221 8510-DATE-CONVERSION.
  2222
  2223     CALL 'ELDATCX' USING DATE-CONVERSION-DATA
  2224
  2225     .
  2226
  2227 8590-EXIT.
  2228     EXIT.
  2229
  2230
  2231
  2232
  2233 ABEND-PGM.
* 2234                                 COPY ELCABEND.
  2235***************************************************************** 04/14/98
  2236*                                                               * ELCABEND
  2237*                            ELCABEND.                          *    LV003
  2238*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
  2239*                            VMOD 2.002                              CL**2
  2240*                                                               * ELCABEND
  2241*                THIS SECTION DISPLAYS THE NECESSARY MESSAGES   * ELCABEND
  2242*            AND THEN ABENDS.                                   * ELCABEND
  2243*                                                               * ELCABEND
  2244*  NO  CID  MODS  IN  COPYBOOK  ELCABEND                        * ELCABEND
  2245*                                                               * ELCABEND
  2246***************************************************************** ELCABEND
  2247*APS-010.                                                         ELCABEND
  2248     DISPLAY WS-ABEND-MESSAGE.                                    ELCABEND
  2249     DISPLAY WS-ABEND-MESSAGE UPON CONSOLE.                       ELCABEND
  2250                                                                  ELCABEND
  2251     IF WS-ABEND-FILE-STATUS NOT = ZERO                           ELCABEND
  2252         DISPLAY 'FILE STATUS = ' WS-ABEND-FILE-STATUS            ELCABEND
  2253         DISPLAY 'FILE STATUS = ' WS-ABEND-FILE-STATUS            ELCABEND
  2254                                 UPON CONSOLE.                    ELCABEND
  2255                                                                  ELCABEND
  2256     IF WS-RETURN-CODE NOT = ZERO                                 ELCABEND
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  45
* ECS0561.cbl (/apps/prod/cid1p/copy/ELCABEND)
  2257         DISPLAY 'RETURN CODE = '  WS-RETURN-CODE                 ELCABEND
  2258         DISPLAY 'RETURN CODE = '  WS-RETURN-CODE                 ELCABEND
  2259                                 UPON CONSOLE.                    ELCABEND
  2260                                                                  ELCABEND
  2261     DISPLAY 'PROGRAM WILL NOW ABEND **************'              ELCABEND
  2262     DISPLAY 'PROGRAM WILL NOW ABEND **************'              ELCABEND
  2263                                 UPON CONSOLE.                    ELCABEND
  2264                                                                  ELCABEND
  2265     DIVIDE WS-ZERO BY WS-ZERO GIVING WS-ZERO.                    ELCABEND
  2266     CALL 'ABORTME'.
  2267                                                                  ELCABEND
  2268 APS-EXIT.                                                        ELCABEND
  2269     EXIT.                                                        ELCABEND
  2270
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:       51816     Code:        8283
