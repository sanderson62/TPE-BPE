* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   1
* ECS090.cbl
* Options: int("ECS090.int") anim csi verbose NOBOUND PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("ECS090.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"ebmlsfile" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" NOCHECKDIV NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"32" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"ECS090.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"ECS090.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR NOSTICKY-LINKAGE
*          NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"2" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.                                         03/19/98
     2                                                                  ECS090
     3 PROGRAM-ID.                 ECS090.                                 LV003
     4*              PROGRAM REVIEWED FOR YEAR 2000 COMPLIANCE          ECS090
     5*                            VMOD=2.010.                             CL**2
     6*                                                                 ECS090
     7*AUTHOR.        LOGIC, INC.                                       ECS090
     8*               DALLAS, TEXAS.                                    ECS090
     9                                                                  ECS090
    10*DATE-COMPILED.                                                   ECS090
    11                                                                  ECS090
    12*SECURITY.   *****************************************************ECS090
    13*            *                                                   *ECS090
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   2
* ECS090.cbl
    14*            *   THIS PROGRAM IS THE PROPERTY OF LOGIC, INC.     *ECS090
    15*            *                                                   *ECS090
    16*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *ECS090
    17*            *   OF LOGIC, INC. IS EXPRESSLY PROHIBITED WITHOUT  *ECS090
    18*            *   THE PRIOR WRITTEN PERMISSION OF LOGIC, INC.     *ECS090
    19*            *                                                   *ECS090
    20*            *****************************************************ECS090
    21                                                                  ECS090
    22*REMARKS.                                                         ECS090
    23*        THIS PROGRAM CREATES A BACKUP TAPE FILE WITH MULTI-      ECS090
    24*        FILES AFTER ECS010 HAS RUN. THE FILES ARE  DATE FILE,    ECS090
    25*        ACCOUNT MASTER, EXTRACT FILE, EPEC FILE, REINSURANCE     ECS090
    26*        TABLES, COMPENSATION TABLES, EPEC EXTRACTS, AND          ECS090
    27*        COMPENSATION MASTER.                                     ECS090
    28*                                                                 ECS090
    29*        IN THE CASE OF CLASIC-CREDIT CLIENTS, THE EXTRACT FILE   ECS090
    30*        FROM EL521 IS BACKED UP INSTEAD OF THE PENDING FILE.     ECS090
    31                                                                  ECS090
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   3
* ECS090.cbl
    33 ENVIRONMENT DIVISION.                                            ECS090
    34 INPUT-OUTPUT SECTION.                                            ECS090
    35 FILE-CONTROL.                                                    ECS090
    36                                                                  ECS090
    37     SELECT DISK-DATE        ASSIGN TO SYS019-UT-FBA1-S-SYS019.   ECS090
    38     SELECT ERACCTT          ASSIGN TO SYS010-FBA1-ERACCTT        ECS090
    39                             ACCESS IS SEQUENTIAL                 ECS090
    40                             ORGANIZATION IS INDEXED              ECS090
    41                             FILE STATUS IS ERACCTT-FILE-STATUS   ECS090
    42                             RECORD KEY IS AM-CONTROL-PRIMARY.    ECS090
    43     SELECT EPECEXTR         ASSIGN TO SYS018-UT-2400-S-SYS018.   ECS090
    44     SELECT DETEXTR          ASSIGN TO SYS012-UT-2400-S-SYS012.   ECS090
    45     SELECT REIN-FILE        ASSIGN TO SYS014-FBA1-REFILE         ECS090
    46                             ACCESS IS SEQUENTIAL                 ECS090
    47                             ORGANIZATION IS INDEXED              ECS090
    48                             FILE STATUS IS REIN-FILE-STATUS      ECS090
    49                             RECORD KEY IS REIN-KEY.              ECS090
    50     SELECT CTBL-FILE        ASSIGN TO SYS016-FBA1-CTFILE         ECS090
    51                             ACCESS IS SEQUENTIAL                 ECS090
    52                             ORGANIZATION IS INDEXED              ECS090
    53                             FILE STATUS IS COMM-FILE-STATUS      ECS090
    54                             RECORD KEY IS COMM-KEY.              ECS090
    55     SELECT CRED-FILE        ASSIGN TO SYS011-UT-2400-S-SYS011.   ECS090
    56     SELECT COMP-FILE        ASSIGN TO SYS015-UT-2400-S-SYS015.   ECS090
    57                                                                  ECS090
    58     SELECT PRNT-FILE        ASSIGN TO SYS008-UR-1403-S-SYS008.   ECS090
    59     SELECT BKUP-DATE        ASSIGN TO SYS013-UT-2400-S-SYS013.   ECS090
    60     SELECT BKUP-ACCT        ASSIGN TO SYS013-UT-2400-S-SYS013.   ECS090
    61     SELECT BKUP-EXTR        ASSIGN TO SYS013-UT-2400-S-SYS013.   ECS090
    62     SELECT BKUP-EPEC        ASSIGN TO SYS013-UT-2400-S-SYS013.   ECS090
    63     SELECT BKUP-REIN        ASSIGN TO SYS013-UT-2400-S-SYS013.   ECS090
    64     SELECT BKUP-CTBL        ASSIGN TO SYS013-UT-2400-S-SYS013.   ECS090
    65     SELECT BKUP-CRED        ASSIGN TO SYS013-UT-2400-S-SYS013.   ECS090
    66     SELECT BKUP-COMP        ASSIGN TO SYS013-UT-2400-S-SYS013.   ECS090
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   4
* ECS090.cbl
    68 DATA DIVISION.                                                   ECS090
    69 FILE SECTION.                                                    ECS090
    70                                                                  ECS090
    71 FD  PRNT-FILE                                                    ECS090
    72     RECORDING MODE F                                             ECS090
    73     LABEL RECORDS OMITTED                                        ECS090
    74     RECORD CONTAINS 133 CHARACTERS.                              ECS090
    75 01  PRT-REC.                                                     ECS090
    76     12  PRT-LINE.                                                ECS090
    77         16  PRT-C           PIC X.                               ECS090
    78         16  PRT-RST         PIC X(132).                          ECS090
    79                                                                  ECS090
    80 FD  DISK-DATE                                                    ECS090
*   81                             COPY ELCDTEFD.                       ECS090
    82******************************************************************04/15/98
    83*                                                                *ELCDTEFD
    84*                                                                *ELCDTEFD
    85*                            ELCDTEFD.                           *   LV002
    86*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
    87*                            VMOD=2.007                          *   CL**2
    88*                                                                *ELCDTEFD
    89******************************************************************ELCDTEFD
    90     BLOCK CONTAINS 0 RECORDS
    91     RECORDING MODE F.                                            ELCDTEFD
    92                                                                  ELCDTEFD
    93 01  DATE-DISK.                                                   ELCDTEFD
    94     12  DD-ID                       PIC  X(4).                   ELCDTEFD
    95     12  FILLER                      PIC  X(14).                  ELCDTEFD
    96     12  DD-CR1                      PIC  9.                      ELCDTEFD
    97     12  DD-CR1N                     PIC  X(30).                  ELCDTEFD
    98     12  DD-CR2                      PIC  9.                      ELCDTEFD
    99     12  DD-CR2N                     PIC  X(30).                  ELCDTEFD
   100     12  FILLER                      PIC  X(20).                  ELCDTEFD
   101                                                                  ELCDTEFD
   102 01  DATE-DISK-R.                                                 ELCDTEFD
   103     12  FILLER                      PIC  X(4).                   ELCDTEFD
   104     12  DD-ST           OCCURS 3 TIMES                           ELCDTEFD
   105                                     PIC  X(32).                  ELCDTEFD
   106                                                                  ELCDTEFD
   107 01  DATE-DISK-T.                                                 ELCDTEFD
   108     12  FILLER                      PIC  X(4).                   ELCDTEFD
   109     12  DD-TYPE         OCCURS 2 TIMES                           ELCDTEFD
   110                                     PIC  X(48).                  ELCDTEFD
   111                                                                  ELCDTEFD
   112 01  DATE-DISK-M.                                                 ELCDTEFD
   113     12  FILLER                      PIC  X(4).                   ELCDTEFD
   114     12  DD-MORT         OCCURS 2 TIMES                           ELCDTEFD
   115                                     PIC  X(48).                  ELCDTEFD
   116                                                                  ELCDTEFD
   117 01  DATE-DISK-P.                                                 ELCDTEFD
   118     12  DD-IDA                      PIC  XX.                     ELCDTEFD
   119     12  DD-IDX                      PIC  99.                     ELCDTEFD
   120     12  DD-DATA                     PIC  X(96).                  ELCDTEFD
   121     12  FILLER  REDEFINES DD-DATA.                               ELCDTEFD
   122         16  DD-PS-PIC   OCCURS 50 TIMES                          ELCDTEFD
   123                                     PIC  X.                      ELCDTEFD
   124         16  FILLER                  PIC  X(46).                  ELCDTEFD
   125     12  FILLER  REDEFINES DD-DATA.                               ELCDTEFD
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   5
* ECS090.cbl (/apps/prod/cid1p/copy/ELCDTEFD)
   126         16  DD-PS-PICO  OCCURS 20 TIMES.                         ELCDTEFD
   127             20  DD-PS-PRT           PIC  X.                      ELCDTEFD
   128             20  DD-PS-FMT           PIC  X.                      ELCDTEFD
   129             20  DD-PS-PRC           PIC  X.                      ELCDTEFD
   130             20  DD-PS-TOT           PIC  X.                      ELCDTEFD
   131         16  FILLER                  PIC  X(16).                  ELCDTEFD
   132                                                                  ELCDTEFD
   133 01  DATE-DISK-E.                                                 ELCDTEFD
   134     12  FILLER                      PIC  X(4).                   ELCDTEFD
   135     12  DD-EDIT         OCCURS 24 TIMES                          ELCDTEFD
   136                                     PIC  X(4).                   ELCDTEFD
   137                                                                  ELCDTEFD
   138 01  DATE-DISK-C.                                                 ELCDTEFD
   139     12  FILLER                      PIC  X(7).                   ELCDTEFD
   140     12  DD-CARR1-SECPAY-SW          PIC  X.
   141     12  DD-CARR1-UEP-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   142     12  DD-CARR1-R78-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   143     12  DD-CARR1-PRO-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   144     12  DD-CARR1                    PIC  X.                      ELCDTEFD
   145     12  DD-CARR1S                   PIC  XX.                     ELCDTEFD
   146     12  DD-CARR1N                   PIC  X(30).                  ELCDTEFD
   147     12  DD-CARR2                    PIC  X.                      ELCDTEFD
   148     12  DD-CARR2S                   PIC  XX.                     ELCDTEFD
   149     12  DD-CARR2N                   PIC  X(30).                  ELCDTEFD
   150     12  DD-CARR2-UEP-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   151     12  DD-CARR2-R78-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   152     12  DD-CARR2-PRO-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   153     12  DD-CARR2-SECPAY-SW          PIC  X.
   154     12  FILLER                      PIC  X(7).                   ELCDTEFD
   155                                                                  ELCDTEFD
   156 01  DATE-DISK-OPT.                                               ELCDTEFD
   157     12  FILLER                      PIC  X(04).                  ELCDTEFD
   158     12  DD-TLR-DATA.                                             ELCDTEFD
   159         16  DD-TLR                  OCCURS 32 TIMES              ELCDTEFD
   160                                     PIC  X(03).                  ELCDTEFD
   161     12  DD-STATE-DATA REDEFINES DD-TLR-DATA.                     ELCDTEFD
   162         16  DD-STATE-FLDS           OCCURS 16 TIMES              ELCDTEFD
   163                                     PIC  X(06).                  ELCDTEFD
   164     12  DD-CARR-DATA REDEFINES DD-TLR-DATA.                      ELCDTEFD
   165         16  DD-CARR-FLDS            OCCURS 13 TIMES              ELCDTEFD
   166                                     PIC  X(07).                  ELCDTEFD
   167         16  FILLER                  PIC  X(05).                  ELCDTEFD
   168     12  DD-MISC-DATA REDEFINES DD-TLR-DATA                       ELCDTEFD
   169                                     PIC  X(96).                  ELCDTEFD
   170******************************************************************ELCDTEFD
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   6
* ECS090.cbl
   172 FD  BKUP-DATE                                                    ECS090
   173     RECORDING MODE F                                             ECS090
   174     LABEL RECORDS STANDARD                                       ECS090
   175     BLOCK CONTAINS 0 RECORDS
   176     RECORD CONTAINS 100 CHARACTERS.                              ECS090
   177 01  BK-DATE.                                                     ECS090
   178     12  FILLER              PIC X(100).                          ECS090
   179                                                                  ECS090
   180 FD  ERACCTT                                                      ECS090
   181     LABEL RECORDS ARE STANDARD                                   ECS090
   182     BLOCK CONTAINS 0 RECORDS
   183     RECORD CONTAINS 2000 CHARACTERS.                             ECS090
   184 01  ACCT-REC.                                                    ECS090
   185     12  FILLER              PIC XX.                              ECS090
   186     12  AM-CONTROL-PRIMARY  PIC X(26).                           ECS090
   187     12  FILLER              PIC X(1972).                         ECS090
   188                                                                  ECS090
   189 FD  BKUP-ACCT                                                    ECS090
   190     RECORDING MODE  F                                            ECS090
   191     LABEL RECORDS STANDARD                                       ECS090
   192     BLOCK CONTAINS 0 RECORDS
   193     RECORD CONTAINS 2000 CHARACTERS.                             ECS090
   194 01  BK-ACCT.                                                     ECS090
   195     12  FILLER              PIC X(2000).                         ECS090
   196                                                                  ECS090
   197 FD  EPECEXTR
*                                   COPY ECSEPCFD.                      ECS090
   198******************************************************************07/10/97
   199*                                                                *ECSEPCFD
   200*                            ECSEPCFD                            *   LV001
   201*                            VMOD=2.002                          *ECSEPCFD
   202*                                                                *ECSEPCFD
   203*  NO  CID  MODS  IN  COPYBOOK  ECSEPCFD                         *ECSEPCFD
   204*                                                                *ECSEPCFD
   205******************************************************************ECSEPCFD
   206     RECORDING MODE F                                             ECSEPCFD
   207     LABEL RECORDS STANDARD                                       ECSEPCFD
   208     BLOCK CONTAINS 0 RECORDS
   209     RECORD CONTAINS 325 CHARACTERS.                              ECSEPCFD
   210******************************************************************ECSEPCFD
   211                                                                  ECS090
   212 01  EXTR-REC.                                                    ECS090
   213     12  FILLER              PIC X(325).                          ECS090
   214                                                                  ECS090
   215 FD  BKUP-EXTR                                                    ECS090
   216     RECORDING MODE F                                             ECS090
   217     LABEL RECORDS STANDARD                                       ECS090
   218     BLOCK CONTAINS 0 RECORDS
   219     RECORD CONTAINS 325 CHARACTERS.                              ECS090
   220 01  BK-EXTR.                                                     ECS090
   221     12  FILLER              PIC X(325).                          ECS090
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   7
* ECS090.cbl
   223 FD  DETEXTR                                                      ECS090
*  224                                 COPY ECSEXTFD.                   ECS090
   225******************************************************************07/10/97
   226*                                                                *ECSEXTFD
   227*                            ECSEXTFD                            *   LV001
   228*                            VMOD=2.001                          *ECSEXTFD
   229*                                                                *ECSEXTFD
   230*  NO  CID  MODS  IN  COPYBOOK  ECSEXTFD                         *ECSEXTFD
   231*                                                                *ECSEXTFD
   232******************************************************************ECSEXTFD
   233     RECORDING MODE F                                             ECSEXTFD
   234     LABEL RECORDS STANDARD                                       ECSEXTFD
   235     BLOCK CONTAINS 0 RECORDS
   236     RECORD CONTAINS 510 CHARACTERS.                              ECSEXTFD
   237******************************************************************ECSEXTFD
   238 01  DETAIL-EPEC.                                                 ECS090
   239     12  FILLER              PIC X(510).                          ECS090
   240                                                                  ECS090
   241 FD  BKUP-EPEC                                                    ECS090
*  242                                 COPY ECSEXTFD.                   ECS090
   243******************************************************************07/10/97
   244*                                                                *ECSEXTFD
   245*                            ECSEXTFD                            *   LV001
   246*                            VMOD=2.001                          *ECSEXTFD
   247*                                                                *ECSEXTFD
   248*  NO  CID  MODS  IN  COPYBOOK  ECSEXTFD                         *ECSEXTFD
   249*                                                                *ECSEXTFD
   250******************************************************************ECSEXTFD
   251     RECORDING MODE F                                             ECSEXTFD
   252     LABEL RECORDS STANDARD                                       ECSEXTFD
   253     BLOCK CONTAINS 0 RECORDS
   254     RECORD CONTAINS 510 CHARACTERS.                              ECSEXTFD
   255******************************************************************ECSEXTFD
   256                                                                  ECS090
   257 01  BK-EPEC.                                                     ECS090
   258     12  FILLER              PIC X(510).                          ECS090
   259                                                                  ECS090
   260 FD  REIN-FILE                                                    ECS090
   261     LABEL RECORDS STANDARD                                       ECS090
   262     RECORD CONTAINS 4000 CHARACTERS.                             ECS090
   263 01  REIN-REC.                                                    ECS090
   264     12  FILLER              PIC X(2).                            ECS090
   265     12  REIN-KEY            PIC X(8).                            ECS090
   266     12  FILLER              PIC X(3990).                         ECS090
   267                                                                  ECS090
   268 FD  BKUP-REIN                                                    ECS090
   269     RECORDING MODE F                                             ECS090
   270     LABEL RECORDS STANDARD                                       ECS090
   271     BLOCK CONTAINS 0 RECORDS
   272     RECORD CONTAINS 4000 CHARACTERS.                             ECS090
   273 01  BK-REIN.                                                     ECS090
   274     12  FILLER              PIC X(4000).                         ECS090
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   8
* ECS090.cbl
   276 FD  CTBL-FILE                                                    ECS090
   277     LABEL RECORDS STANDARD                                       ECS090
   278     RECORD CONTAINS 200 CHARACTERS.                              ECS090
   279 01  CTBL-REC.                                                    ECS090
   280     12  FILLER              PIC XX.                              ECS090
   281     12  COMM-KEY            PIC X(7).                            ECS090
   282     12  FILLER              PIC X(191).                          ECS090
   283                                                                  ECS090
   284 FD  BKUP-CTBL                                                    ECS090
   285     RECORDING MODE F                                             ECS090
   286     LABEL RECORDS STANDARD                                       ECS090
   287     BLOCK CONTAINS 0 RECORDS
   288     RECORD CONTAINS 200 CHARACTERS.                              ECS090
   289 01  BK-CTBL.                                                     ECS090
   290     12  FILLER              PIC X(200).                          ECS090
   291                                                                  ECS090
   292 FD  CRED-FILE                                                    ECS090
   293     RECORDING MODE F                                             ECS090
   294     LABEL RECORDS STANDARD                                       ECS090
   295     BLOCK CONTAINS 0 RECORDS
   296     RECORD CONTAINS 629 CHARACTERS.                              ECS090
   297 01  CRED-REC                PIC X(629).                          ECS090
   298                                                                  ECS090
   299 FD  BKUP-CRED                                                    ECS090
   300     RECORDING MODE F                                             ECS090
   301     LABEL RECORDS STANDARD                                       ECS090
   302     BLOCK CONTAINS 0 RECORDS
   303     RECORD CONTAINS 629 CHARACTERS.                              ECS090
   304 01  BK-CRED                 PIC X(629).                          ECS090
   305                                                                  ECS090
   306 FD  COMP-FILE                                                    ECS090
*  307                                 COPY ECSCOIFD.                   ECS090
   308******************************************************************07/10/97
   309*                                                                *ECSCOIFD
   310*                            ECSCOIFD                            *   LV001
   311*                            VMOD=2.005                          *ECSCOIFD
   312*                                                                *ECSCOIFD
   313* NO CID  MODS IN  COPYBOOK  ECSCOIFD.                           *ECSCOIFD
   314*                                                                *ECSCOIFD
   315******************************************************************ECSCOIFD
   316     BLOCK CONTAINS 0 RECORDS
   317     RECORDING MODE F.                                            ECSCOIFD
   318                                                                  ECSCOIFD
   319 01  COMP-IN-RECORD.                                              ECSCOIFD
   320     12  COI-ID                            PIC XX.                ECSCOIFD
   321                                                                  ECSCOIFD
   322     12  COI-CONTROL.                                             ECSCOIFD
   323         16  COI-COMPANY-CD                PIC X.                 ECSCOIFD
   324         16  COI-CTL-1.                                           ECSCOIFD
   325             20  COI-CARR-GROUP.                                  ECSCOIFD
   326                 24  COI-CARRIER           PIC X.                 ECSCOIFD
   327                 24  COI-GROUPING.                                ECSCOIFD
   328                     28  COI-GRP-PREFIX    PIC XXX.               ECSCOIFD
   329                     28  COI-GRP-PRIME     PIC XXX.               ECSCOIFD
   330             20  COI-RESP-NO.                                     ECSCOIFD
   331                 24  COI-RESP-PREFIX       PIC X(4).              ECSCOIFD
   332                 24  COI-RESP-PRIME        PIC X(6).              ECSCOIFD
   333         16  COI-CTL-2.                                           ECSCOIFD
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   9
* ECS090.cbl (/apps/prod/cid1p/copy/ECSCOIFD)
   334             20  COI-ACCOUNT.                                     ECSCOIFD
   335                 24  COI-ACCT-PREFIX       PIC X(4).              ECSCOIFD
   336                 24  COI-ACCT-PRIME        PIC X(6).              ECSCOIFD
   337         16  COI-TYPE                      PIC X.                 ECSCOIFD
   338             88  COI-COMPANY-RECORD           VALUE 'C'.          ECSCOIFD
   339             88  COI-GENERAL-AGENT-RECORD     VALUE 'G'.          ECSCOIFD
   340             88  COI-ACCOUNT-RECORD           VALUE 'A'.          ECSCOIFD
   341                                                                  ECSCOIFD
   342     12  FILLER                            PIC X(20).             ECSCOIFD
   343                                                                  ECSCOIFD
   344     12  COI-BALANCE-CONTROL               PIC X.                 ECSCOIFD
   345         88  COI-CARRY-BALANCE                VALUE 'Y'.          ECSCOIFD
   346         88  COI-NO-BALANCE                   VALUE 'N'.          ECSCOIFD
   347                                                                  ECSCOIFD
   348     12  COI-INTERNAL-CONTROL-1            PIC X.                 ECSCOIFD
   349         88  COI-AUTO-GENERATED-THIS-RUN      VALUE 'X'.          ECSCOIFD
   350         88  COI-AUTO-GENERATED               VALUE 'Y'.          ECSCOIFD
   351         88  COI-NOT-AUTO-GENERATED           VALUE 'N'.          ECSCOIFD
   352                                                                  ECSCOIFD
   353     12  COI-INTERNAL-CONTROL-2            PIC X.                 ECSCOIFD
   354         88  COI-STATEMENT-THIS-RUN           VALUE 'Y'.          ECSCOIFD
   355         88  COI-NO-STATEMENT-THIS-RUN        VALUE 'N'.          ECSCOIFD
   356                                                                  ECSCOIFD
   357     12  COI-FUTURE-SPACE                  PIC X(5).              ECSCOIFD
   358         88  COI-FUTURE-NOT-USED              VALUE '     '.      ECSCOIFD
   359                                                                  ECSCOIFD
   360     12  COI-DATA                          PIC X(641).            ECSCOIFD
   361                                                                  ECSCOIFD
   362******************************************************************ECSCOIFD
   363 01  COMP-MSTR-REC.                                               ECS090
   364     12  FILLER              PIC X(700).                          ECS090
   365                                                                  ECS090
   366 FD  BKUP-COMP                                                    ECS090
   367     RECORDING MODE F                                             ECS090
   368     LABEL RECORDS STANDARD                                       ECS090
   369     BLOCK CONTAINS 0 RECORDS
   370     RECORD CONTAINS 700 CHARACTERS.                              ECS090
   371 01  BK-COMP                 PIC X(700).                          ECS090
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  10
* ECS090.cbl
   373 WORKING-STORAGE SECTION.                                         ECS090
   374 77  FILLER  PIC X(32) VALUE '********************************'.  ECS090
   375 77  FILLER  PIC X(32) VALUE '     ECS090 WORKING-STORAGE     '.  ECS090
   376 77  FILLER  PIC X(32) VALUE '*****V/M=2.010 *****************'.     CL**2
   377                                                                  ECS090
   378 77  LN-CTR                  PIC S999  COMP-3    VALUE +066.      ECS090
   379 77  DATE-CTR                PIC S9(9) COMP-3    VALUE +0.        ECS090
   380 77  ACCT-CTR                PIC S9(9) COMP-3    VALUE +0.        ECS090
   381 77  EXTR-CTR                PIC S9(9) COMP-3    VALUE +0.        ECS090
   382 77  EPEC-CTR                PIC S9(9) COMP-3    VALUE +0.        ECS090
   383 77  CRED-CTR                PIC S9(9) COMP-3    VALUE +0.        ECS090
   384 77  REIN-CTR                PIC S9(9) COMP-3    VALUE +0.        ECS090
   385 77  CTBL-CTR                PIC S9(9) COMP-3    VALUE +0.        ECS090
   386 77  COMP-CTR                PIC S9(9) COMP-3    VALUE +0.        ECS090
   387 77  CCSW                    PIC 9               VALUE 0.         ECS090
   388                                                                  ECS090
   389 01  MISC-WORK.                                                   ECS090
   390     12  WS-ABEND-FILE-STATUS   PIC XX              VALUE ZEROS.  ECS090
   391     12  WS-ABEND-MESSAGE       PIC X(80)           VALUE SPACES. ECS090
   392     12  WS-RETURN-CODE         PIC S9(4)  COMP.                  ECS090
   393     12  WS-ZERO                PIC S9     VALUE ZERO COMP-3.     ECS090
   394     12  PGM-SUB                PIC S999 COMP       VALUE +090.   ECS090
   395     12  FIRST-TIME-SW          PIC X               VALUE 'Y'.    ECS090
   396         88  FIRST-TIME                          VALUE 'Y'.       ECS090
   397                                                                  ECS090
   398 01  FILE-STATUS.                                                 ECS090
   399     12  REIN-FILE-STATUS       PIC XX     VALUE ZERO.            ECS090
   400     12  COMM-FILE-STATUS       PIC XX     VALUE ZERO.            ECS090
   401     12  ERACCTT-FILE-STATUS    PIC XX     VALUE ZERO.            ECS090
   402                                                                  ECS090
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  11
* ECS090.cbl
   404 01  HEADINGS.                                                    ECS090
   405     12  HEAD-1.                                                  ECS090
   406         16  FILLER          PIC X(48)           VALUE SPACES.    ECS090
   407         16  FILLER          PIC X(28)           VALUE            ECS090
   408                'SYSTEM BACKUP CONTROL TOTALS'.                   ECS090
   409         16  FILLER          PIC X(48)           VALUE SPACES.    ECS090
   410         16  FILLER          PIC X(8)            VALUE 'ECS-090'. ECS090
   411     12  HEAD-2.                                                  ECS090
   412         16  FILLER          PIC X(47)           VALUE SPACES.    ECS090
   413         16  HD-CLIENT       PIC X(30).                           ECS090
   414         16  FILLER          PIC X(47)           VALUE SPACES.    ECS090
   415         16  HD-IPL          PIC X(8)            VALUE SPACES.    ECS090
   416     12  HEAD-3.                                                  ECS090
   417         16  FILLER          PIC X(52)           VALUE SPACES.    ECS090
   418         16  HD-DATE         PIC X(18).                           ECS090
   419         16  FILLER          PIC X(42)           VALUE SPACES.    ECS090
   420         16  FILLER          PIC X(11)           VALUE            ECS090
   421                 'PAGE      1'.                                   ECS090
   422     12  HEAD-4.                                                  ECS090
   423         16  FILLER          PIC X(32)           VALUE            ECS090
   424                 '     FILE NAME                  '.              ECS090
   425         16  FILLER          PIC X(14)           VALUE            ECS090
   426                 '  RECORD COUNT'.                                ECS090
   427                                                                  ECS090
   428 01  P-REC.                                                       ECS090
   429     12  P-CCSW              PIC X.                               ECS090
   430     12  P-LINE.                                                  ECS090
   431         16  P-DESC          PIC X(32).                           ECS090
   432         16  P-CTR           PIC Z,ZZZ,ZZZ,ZZZ-.                  ECS090
   433         16  FILLER          PIC X(6).                            ECS090
   434         16  P-MSG           PIC X(40).                           ECS090
   435         16  FILLER          PIC X(40).                           ECS090
   436                                                                  ECS090
*  437                             COPY ELCDTECX.                       ECS090
   438******************************************************************06/05/98
   439*                                                                *ELCDTECX
   440*                            ELCDTECX.                           *   LV005
   441*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
   442*                            VMOD=2.015                          *ELCDTECX
   443*                                                                *ELCDTECX
   444*      WORKING STORAGE COPY CODE FOR APPLICATIONS CALLING        *ELCDTECX
   445*      THE DATE CARD DISK FILE. ( READ ROUTINE = ELCDTERX,       *ELCDTECX
   446*      AND DISK FILE FD = ELCDTEFX)                              *ELCDTECX
   447*                                                                *ELCDTECX
   448******************************************************************ELCDTECX
   449******************************************************************
   450*                   C H A N G E   L O G
   451*
   452* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   453*-----------------------------------------------------------------
   454*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   455* EFFECTIVE    NUMBER
   456*-----------------------------------------------------------------
   457* 092602    2002091900008  PEMA  INCREASE NUMBER OF MAXIMUM
   458*                                  BENEFIT CODES FROM 300 TO 900
   459* 090803    2003080800002  PEMA  ADD CATEGORY FOR SUPER GAP
   460* 051304    2003080800002  SMVA  ADD REFUND METHOD
   461* 071714    2013100100002  PEMA  FIX CRIT PERIOD EDITS
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  12
* ECS090.cbl (/apps/prod/cid1p/copy/ELCDTECX)
   462******************************************************************
   463 01  DATE-CARD.                                                   ELCDTECX
   464     12  DATX-COD                    PIC  X(4).                   ELCDTECX
   465     12  RUN-DATE                    PIC  9(11)  COMP-3.          ELCDTECX
   466     12  ALPH-DATE                   PIC  X(18).                  ELCDTECX
   467     12  EP-DT                       PIC  9(11)  COMP-3.          ELCDTECX
   468     12  PEND-ACT-FILE               PIC  XX.                     ELCDTECX
   469     12  EP-SW                       PIC  X.                      ELCDTECX
   470         88  NO-EP-EXTRACTS          VALUE SPACE.                 ELCDTECX
   471     12  TAPE-BATCHES                PIC  X.                      ELCDTECX
   472         88  TP-PREL-BAL             VALUE '1'.                   ELCDTECX
   473     12  BIN-RUN-DATE                PIC  XX.                     ELCDTECX
   474     12  RUN-CENTURY.                                             ELCDTECX
   475         16 RUN-CENTURY-N            PIC  99.                        CL**4
   476     12  FILLER                      PIC  X.                         CL**4
   477     12  CLAS-MORT-OVRD              PIC  X(4).                   ELCDTECX
   478     12  FILLER                      PIC  XXX.                    ELCDTECX
   479     12  COMPANY-NAME                PIC  X(30).                  ELCDTECX
   480                                                                  ELCDTECX
   481 01  FILLER                          PIC  X(7)                       CL**6
   482                                          VALUE 'OPTIONS'.        ELCDTECX
   483 01  DATE-CARD-OPTIONS.                                           ELCDTECX
   484     12  DATE-OPTIONS-ID             PIC  X(4).                   ELCDTECX
   485     12  DTE-MIN-PREM                PIC  99V99.                  ELCDTECX
   486     12  DTE-LANGUAGE-IND            PIC  X.                      ELCDTECX
   487         88  DTE-LANGUAGE-IS-FR           VALUE 'F'.              ELCDTECX
   488         88  DTE-LANGUAGE-IS-ENG          VALUE 'E'.              ELCDTECX
   489     12  DTE-MIN-AGE                 PIC  99.                     ELCDTECX
   490     12  DTE-DEFAULT-AGE             PIC  99.                     ELCDTECX
   491     12  FILLER                      PIC  X.                      ELCDTECX
   492     12  DTE-MAX-TERM                PIC  999.                    ELCDTECX
   493     12  DTE-COMP-VG                 PIC  X.                      ELCDTECX
   494     12  DTE-REM-TRM                 PIC  X.                      ELCDTECX
   495     12  DTE-PRM-CK                  PIC S99V99.                  ELCDTECX
   496     12  DTE-PRORATA                 PIC  X.                      ELCDTECX
   497     12  DTE-CLM-REJ                 PIC  X.                      ELCDTECX
   498     12  DTE-REF-REJ                 PIC  X.                      ELCDTECX
   499     12  DTE-COM-TBL-USED            PIC  X.                      ELCDTECX
   500     12  FILLER                      PIC  X.                      ELCDTECX
   501     12  DTE-QTR-CO                  PIC  X.                      ELCDTECX
   502     12  DTE-REF-CK                  PIC S99V99.                  ELCDTECX
   503     12  DTE-CLM-CK                  PIC S99V99.                  ELCDTECX
   504     12  DTE-CONV-DT                 PIC 9(11) COMP-3.               CL**2
   505     12  DTE-DEFAULT-SEX             PIC  X.                      ELCDTECX
   506     12  DTE-EPL-FORMAT              PIC  X.                      ELCDTECX
   507     12  FILLER                      PIC  X.                      ELCDTECX
   508     12  DTE-JT-AGE                  PIC  X.                      ELCDTECX
   509     12  DTE-KEY-BIRTH               PIC  X.                      ELCDTECX
   510     12  DTE-REINSURANCE             PIC  X.                      ELCDTECX
   511     12  DTE-CLAIM-SORT              PIC  X.                      ELCDTECX
   512     12  DTE-WRT-OFF                 PIC  S99V99.                 ELCDTECX
   513     12  DTE-R78                     PIC  X.                      ELCDTECX
   514     12  DTE-DLY-BILL                PIC  X.                      ELCDTECX
   515     12  DTE-ALT-MORT-CODE           PIC  X(4).                   ELCDTECX
   516     12  DTE-CLAIM-PAID-THRU-TO      PIC  X.                      ELCDTECX
   517     12  DTE-COMPENSATION-ACCESS     PIC  X.                      ELCDTECX
   518     12  DTE-MORTG-ACCESS-CNTL       PIC  X.                      ELCDTECX
   519     12  DTE-MP-ALT-MORT-CODE        PIC  X(4).                   ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  13
* ECS090.cbl (/apps/prod/cid1p/copy/ELCDTECX)
   520     12  DTE-MORTALITY-AGE-CALC-METHOD                            ELCDTECX
   521                                     PIC  X.                      ELCDTECX
   522         88  DTE-USE-TABLE-ASSIGNED-METHOD VALUE '1'              ELCDTECX
   523                                                 ' '.             ELCDTECX
   524         88  DTE-USE-ALL-AGE-LAST          VALUE '2'.             ELCDTECX
   525         88  DTE-USE-ALL-AGE-NEAR          VALUE '3'.             ELCDTECX
   526     12  DTE-RESERVE-OPTION-SWITCH   PIC  X.                      ELCDTECX
   527         88  DTE-OPT-RESERVE-METHOD-AUTH       VALUE 'Y'.         ELCDTECX
   528         88  DTE-OPT-RESERVE-METHOD-UNAUTH     VALUE 'N' ' '.     ELCDTECX
   529     12  DTE-REM-TRM-CALC-OPTION     PIC  X.                      ELCDTECX
   530     12  DTE-EXPERIENCE-RETENTION-AGE                             ELCDTECX
   531                                     PIC  9.                         CL**4
   532     12  DTE-SYSTEM.                                              ELCDTECX
   533         16  DTE-SYS-A-CREDIT        PIC  X.                      ELCDTECX
   534         16  DTE-SYS-B-PEND-CLAIM    PIC  X.                      ELCDTECX
   535         16  DTE-SYS-C-CONFIRMATIONS PIC  X.                      ELCDTECX
   536         16  DTE-SYS-D-DEMAND-BILL   PIC  X.                      ELCDTECX
   537         16  DTE-SYS-E-CLASIC-CLAIMS PIC  X.                      ELCDTECX
   538         16  DTE-SYS-F-CLASIC-CREDIT PIC  X.                      ELCDTECX
   539         16  DTE-SYS-G-AR-USED       PIC  X.                      ELCDTECX
   540         16  DTE-SYS-H               PIC  X.                      ELCDTECX
   541         16  DTE-SYS-I               PIC  X.                      ELCDTECX
   542         16  DTE-SYS-J               PIC  X.                      ELCDTECX
   543         16  DTE-SYS-K               PIC  X.                      ELCDTECX
   544         16  DTE-SYS-L               PIC  X.                      ELCDTECX
   545         16  DTE-SYS-M               PIC  X.                      ELCDTECX
   546         16  DTE-SYS-N               PIC  X.                      ELCDTECX
   547         16  DTE-SYS-O               PIC  X.                      ELCDTECX
   548         16  DTE-SYS-P               PIC  X.                      ELCDTECX
   549         16  DTE-SYS-Q               PIC  X.                      ELCDTECX
   550         16  DTE-SYS-R               PIC  X.                      ELCDTECX
   551         16  DTE-SYS-S               PIC  X.                      ELCDTECX
   552         16  DTE-SYS-T               PIC  X.                      ELCDTECX
   553         16  DTE-SYS-U               PIC  X.                      ELCDTECX
   554         16  DTE-SYS-V               PIC  X.                      ELCDTECX
   555         16  DTE-SYS-W               PIC  X.                      ELCDTECX
   556         16  DTE-SYS-X               PIC  X.                      ELCDTECX
   557         16  DTE-SYS-Y               PIC  X.                      ELCDTECX
   558         16  DTE-SYS-Z               PIC  X.                      ELCDTECX
   559     12  FILLER                      REDEFINES DTE-SYSTEM.        ELCDTECX
   560         16  DTE-SYS-CODE            OCCURS 26 TIMES              ELCDTECX
   561                                     PIC  X.                      ELCDTECX
   562     12  DTE-CLIENT                  PIC  XXX.                    ELCDTECX
   563                                                                  ELCDTECX
   564 01  CLASIC-SYSTEM-CODES.                                         ELCDTECX
   565     12  DTE-COLC-ID                 PIC  X(4).                   ELCDTECX
   566     12  DTE-CLASIC-COMPANY-CD       PIC  X.                      ELCDTECX
   567     12  DTE-CLASIC-COMPANY-NUMBER   PIC  999.                    ELCDTECX
   568*    12  DTE-CLASIC-CLAIM-ACCESS     PIC  X.                      ELCDTECX
   569     12  FILLER                      PIC  X.                      ELCDTECX
   570     12  CLASIC-REIN-MAINT           PIC  XX.                     ELCDTECX
   571     12  CLASIC-COMP-MAINT           PIC  XX.                     ELCDTECX
   572     12  CLASIC-ACCT-MAINT           PIC  XX.                     ELCDTECX
   573     12  CLASIC-CTBL-MAINT           PIC  XX.                     ELCDTECX
   574     12  CLASIC-RATE-MAINT           PIC  XX.                     ELCDTECX
   575     12  CLASIC-CREDIT-EOM-DT        PIC  XX.                     ELCDTECX
   576     12  CLASIC-CLAIMS-EOM-DT        PIC  XX.                     ELCDTECX
   577                                                                  ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  14
* ECS090.cbl (/apps/prod/cid1p/copy/ELCDTECX)
   578     12  LIFE-OVERRIDE-L1            PIC  X.                      ELCDTECX
   579     12  LIFE-OVERRIDE-L2            PIC  XX.                     ELCDTECX
   580     12  LIFE-OVERRIDE-L6            PIC  X(6).                   ELCDTECX
   581     12  LIFE-OVERRIDE-L12           PIC  X(12).                  ELCDTECX
   582                                                                  ELCDTECX
   583     12  AH-OVERRIDE-L1              PIC  X.                      ELCDTECX
   584     12  AH-OVERRIDE-L2              PIC  XX.                     ELCDTECX
   585     12  AH-OVERRIDE-L6              PIC  X(6).                   ELCDTECX
   586     12  AH-OVERRIDE-L12             PIC  X(12).                  ELCDTECX
   587                                                                  ELCDTECX
   588     12  CLAS-REPORT-CD1-CAPTION     PIC  X(10).                  ELCDTECX
   589     12  CLAS-REPORT-CD2-CAPTION     PIC  X(10).                  ELCDTECX
   590                                                                  ELCDTECX
   591     12  CLASIC-MORTG-EOM-DT         PIC  XX.                     ELCDTECX
   592     12  CLASIC-AR-EOM-DT            PIC  XX.                     ELCDTECX
   593                                                                  ELCDTECX
   594     12  FILLER                      PIC  X(11)      VALUE SPACE. ELCDTECX
   595                                                                  ELCDTECX
   596 01  DATE-CARD-FACTORS.                                           ELCDTECX
   597     12  DATE-FACTOR-ID              PIC  X(4).                   ELCDTECX
   598     12  FAC-1                       PIC S999V9(5).               ELCDTECX
   599     12  FAC-2                       PIC S999V9(5).               ELCDTECX
   600     12  FAC-3                       PIC S999V9(5).               ELCDTECX
   601     12  FAC-4                       PIC S999V9(5).               ELCDTECX
   602     12  FAC-5                       PIC S999V9(5).               ELCDTECX
   603     12  FAC-6                       PIC S999V9(5).               ELCDTECX
   604                                                                  ELCDTECX
   605 01  FILLER                          PIC  X(12)                   ELCDTECX
   606                                          VALUE 'COMPANY NAME'.   ELCDTECX
   607 01  COMPANY-NAME-TABLE.                                          ELCDTECX
   608     12  C-N-TBL                     OCCURS 6 TIMES.              ELCDTECX
   609         16  CNT-ID                  PIC  X.                      ELCDTECX
   610         16  CNT-NAME                PIC  X(30).                  ELCDTECX
   611                                                                  ELCDTECX
   612 01  FILLER                          PIC  X(11)                   ELCDTECX
   613                                          VALUE 'STATE NAMES'.    ELCDTECX
   614 01  STATE-NAMES.                                                 ELCDTECX
   615     12  STATE-NAME-FLD              OCCURS 75 TIMES.             ELCDTECX
   616         16  STATE-SUB               PIC  XX.                     ELCDTECX
   617         16  STATE-PIC1.                                          ELCDTECX
   618             20  STATE-ABBR          PIC  XX.                     ELCDTECX
   619             20  FILLER              PIC  XXX.                    ELCDTECX
   620             20  STATE-PIC           PIC  X(20).                  ELCDTECX
   621             20  STATE-CALL-EARN     PIC  X.                      ELCDTECX
   622             20  STATE-CALL-BREAK    PIC  X.                      ELCDTECX
   623             20  STATE-PRIM-FAC-DEV  PIC  XXX.                    ELCDTECX
   624                                                                  ELCDTECX
   625 01  FILLER                          PIC  X(13)                   ELCDTECX
   626                                          VALUE 'CARRIER NAMES'.  ELCDTECX
   627 01  CARRIER-NAMES.                                               ELCDTECX
   628     12  CARRIER-NAME-FLD            OCCURS 25 TIMES.             ELCDTECX
   629         16  CARRIER-SUB             PIC  X.                      ELCDTECX
   630         16  CARRIER-DOM-ST          PIC  XX.                     ELCDTECX
   631         16  CARRIER-PIC             PIC  X(30).                  ELCDTECX
   632         16  CARRIER-UEP-PCT         PIC  S9V9(4) COMP-3.            CL**6
   633         16  CARRIER-R78-PCT         PIC  S9V9(4) COMP-3.            CL**6
   634         16  CARRIER-PRO-PCT         PIC  S9V9(4) COMP-3.            CL**6
   635*        16  FILLER                  PIC  X.                      ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  15
* ECS090.cbl (/apps/prod/cid1p/copy/ELCDTECX)
   636         16  CARRIER-SEC-PAY         PIC  X.
   637             88  SEC-PAY-CARRIER          VALUE 'Y'.
   638                                                                  ELCDTECX
   639 01  FILLER                          PIC  X(9)                       CL**6
   640                                          VALUE 'INS TYPES'.      ELCDTECX
   641 01  CLAS-INS-TYPES.                                              ELCDTECX
   642*    12 CLAS-ALL-TYPES               OCCURS 300 TIMES.            ELCDTECX
   643     12 CLAS-ALL-TYPES               OCCURS 900 TIMES.            ELCDTECX
   644         16  CLAS-I-BEN              PIC  XX.                     ELCDTECX
   645         16  CLAS-I-AB3.                                          ELCDTECX
   646             20  FILLER              PIC  X.                      ELCDTECX
   647             20  CLAS-I-AB2.                                      ELCDTECX
   648                 24  FILLER          PIC  X.                      ELCDTECX
   649                 24  CLAS-I-AB1      PIC  X.                      ELCDTECX
   650         16  CLAS-I-AB3-AH REDEFINES CLAS-I-AB3.                  ELCDTECX
   651             20  CLAS-EXCLUSION      PIC  XX.                        CL**4
   652             20  FILLER              PIC  X.                         CL**4
   653         16  CLAS-I-AB10.                                         ELCDTECX
   654             20  FILLER              PIC  X(9).                   ELCDTECX
   655             20  CLAS-I-REIN-YN      PIC  X.                      ELCDTECX
   656         16  CLAS-I-COMMENT          PIC  X(10).                  ELCDTECX
   657         16  CLAS-I-JOINT            PIC  X.                      ELCDTECX
   658         16  CLAS-I-RL-AH            PIC  X.                      ELCDTECX
   659         16  CLAS-I-CALC-TYPE.                                    ELCDTECX
   660             20  CLAS-I-BAL          PIC  X.                      ELCDTECX
   661         16  CLAS-I-EP               PIC  X.                      ELCDTECX
   662         16  CLAS-CO-BEN-I-G-CD      PIC  X.                      ELCDTECX
   663         16  CLAS-CO-REM-TERM-CALC   PIC  X.                      ELCDTECX
   664         16  CLAS-I-BEN-CATEGORY     PIC  X.
   665         16  CLAS-I-REFUND-METHOD    PIC  X.
   666         16  CLAS-I-MAX-BENEFITS     PIC 99.
   667         16  FILLER                  PIC  XXX.
   668                                                                  ELCDTECX
   669 01  FILLER                          PIC  X(16)                   ELCDTECX
   670                                     VALUE 'MORTALITY TABLES'.    ELCDTECX
   671 01  CLAS-MORTALITY-CODES.                                        ELCDTECX
   672     12  CLAS-MORT-FLD               OCCURS 99 TIMES              ELCDTECX
   673                                     INDEXED BY CLAS-MORT-NDX.    ELCDTECX
   674         16  CLAS-MORT-CODE          PIC  X(4).                      CL**6
   675         16  CLAS-MORT-J-CODE        PIC  X.                         CL**5
   676         16  CLAS-MORT-J-FACT        PIC S9V9(4).                    CL**6
   677         16  CLAS-MORT-DESC.                                      ELCDTECX
   678             20  CLAS-RESERVE-ADJ    PIC  999.                       CL**6
   679             20  FILLER              PIC  XX.                        CL**5
   680             20  CLAS-YEAR           PIC  X(4).                      CL**6
   681             20  FILLER              PIC  X.                         CL**5
   682             20  CLAS-TABLE-TYPE     PIC  XXX.                       CL**6
   683             20  FILLER              PIC  X.                         CL**5
   684             20  CLAS-AGE-METHOD     PIC  XX.                        CL**5
   685             20  FILLER              PIC  X.                         CL**5
   686             20  CLAS-INTEREST       PIC  99.99.                     CL**5
   687             20  FILLER              PIC  X(5).                      CL**6
   688                                                                  ELCDTECX
   689 01  FILLER                          PIC  X(15)                   ELCDTECX
   690                                     VALUE 'BUSINESS TABLES'.     ELCDTECX
   691 01  CLAS-BUSINESS-CLASSES.                                       ELCDTECX
   692     12  CLAS-BUSC-FLD               OCCURS 50 TIMES.             ELCDTECX
   693         16  CLAS-BUSC-CODE          PIC  99.                     ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  16
* ECS090.cbl (/apps/prod/cid1p/copy/ELCDTECX)
   694         16  CLAS-BUSC-GROUP         PIC  X.                      ELCDTECX
   695         16  CLAS-BUSC-DESC          PIC  X(19).                  ELCDTECX
   696         16  CLAS-BUSC-EXCL          PIC  X.                         CL**5
   697         16  FILLER                  PIC  X(4).                      CL**6
   698                                                                  ELCDTECX
   699 01  FILLER                          PIC  X(7)                       CL**6
   700                                     VALUE 'INDEXES'.             ELCDTECX
   701 01  CLAS-INDEX-TBL.                                              ELCDTECX
   702     12  CLAX-ID                     PIC  X(4).                   ELCDTECX
   703     12  CLAS-STARTC                 PIC S9(4) COMP.              ELCDTECX
   704     12  CLAS-MAXC                   PIC S9(4) COMP.              ELCDTECX
   705     12  CLAS-STARTL                 PIC S9(4) COMP.              ELCDTECX
   706     12  CLAS-MAXL                   PIC S9(4) COMP.              ELCDTECX
   707     12  CLAS-STARTA                 PIC S9(4) COMP.              ELCDTECX
   708     12  CLAS-MAXA                   PIC S9(4) COMP.              ELCDTECX
   709     12  CLAS-STARTM                 PIC S9(4) COMP.              ELCDTECX
   710     12  CLAS-MAXM                   PIC S9(4) COMP.              ELCDTECX
   711     12  CLAS-STARTB                 PIC S9(4) COMP.              ELCDTECX
   712     12  CLAS-MAXB                   PIC S9(4) COMP.              ELCDTECX
   713     12  CLAS-STARTS                 PIC S9(4) COMP.              ELCDTECX
   714     12  CLAS-MAXS                   PIC S9(4) COMP.              ELCDTECX
   715     12  CLAS-STARTE                 PIC S9(4) COMP.              ELCDTECX
   716     12  CLAS-MAXE                   PIC S9(4) COMP.              ELCDTECX
   717     12  CLAS-STARTCN                PIC S9(4) COMP.              ELCDTECX
   718     12  CLAS-MAXCN                  PIC S9(4) COMP.              ELCDTECX
   719                                                                  ELCDTECX
   720 01  CLAS-TYPE-MISC.                                              ELCDTECX
   721     12  CLAS-INDEXC                 PIC S9(4) COMP.              ELCDTECX
   722     12  CLAS-INDEXL                 PIC S9(4) COMP.              ELCDTECX
   723     12  CLAS-INDEXA                 PIC S9(4) COMP.              ELCDTECX
   724     12  CLAS-INDEXM                 PIC S9(4) COMP.              ELCDTECX
   725     12  CLAS-INDEXB                 PIC S9(4) COMP.              ELCDTECX
   726     12  CLAS-INDEXS                 PIC S9(4) COMP.              ELCDTECX
   727     12  CLAS-INDEXE                 PIC S9(4) COMP.              ELCDTECX
   728     12  CLAS-INDEX                  PIC S9(4) COMP.              ELCDTECX
   729     12  CLAS-INDEXEN                PIC S9(4) COMP.              ELCDTECX
   730     12  CLAS-INDEXCN                PIC S9(4) COMP.              ELCDTECX
   731     12  CLAS-INDEXON                PIC S9(4) COMP.              ELCDTECX
   732                                                                  ELCDTECX
   733 01  FILLER                          PIC  X(13)                   ELCDTECX
   734                                     VALUE 'MISCELLANEOUS'.       ELCDTECX
   735 01  CLAS-MISC.                                                   ELCDTECX
   736     12  DTE-FICH                    PIC  X.                      ELCDTECX
   737         88  FICH-NO                 VALUE SPACE.                 ELCDTECX
   738         88  FICH-ONLY               VALUE '1'.                   ELCDTECX
   739         88  FICH-BOTH               VALUE '2'.                   ELCDTECX
   740     12  FICH-OPEN                   PIC  X.                      ELCDTECX
   741     12  REPT-OPEN                   PIC  X.                      ELCDTECX
   742     12  DTE-PGM-OPT                 PIC  9.                         CL**5
   743     12  DTE-PRT-OPT                 PIC  X.                      ELCDTECX
   744     12  DTE-FMT-OPT                 PIC  9.                      ELCDTECX
   745     12  DTE-PRC-OPT                 PIC  9.                      ELCDTECX
   746     12  DTE-TOT-OPT                 PIC  9.                      ELCDTECX
   747     12  CLAS-LOOK                   PIC  XX.                     ELCDTECX
   748     12  DTE-TOT-LINES               PIC S9(8)      COMP.         ELCDTECX
   749     12  STATE-L                     PIC  XX.                     ELCDTECX
   750     12  CLAS-CN                     PIC  99.                     ELCDTECX
   751     12  CLAS-CO                     PIC  99.                     ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  17
* ECS090.cbl (/apps/prod/cid1p/copy/ELCDTECX)
   752     12  DTE-VSAM-FLAGS                              VALUE ZERO.  ELCDTECX
   753         16  DTE-F-1                 PIC  X.                      ELCDTECX
   754         16  DTE-F-2                 PIC  X.                      ELCDTECX
   755     12  DTE-ABEND-WORK.                                          ELCDTECX
   756         16  DTE-ABEND-CD-1          PIC  XX         VALUE SPACES.ELCDTECX
   757         16  DTE-ABEND-CD-2          PIC  XX         VALUE SPACES.ELCDTECX
   758                                                                  ELCDTECX
   759 01  FILLER                          PIC  X(12)                   ELCDTECX
   760                                     VALUE 'WORKING DATE'.        ELCDTECX
   761 01  WS-DATE-AND-TIME.                                            ELCDTECX
   762     12  WS-ACCEPT-DATE.                                          ELCDTECX
   763         16  WS-AD-YY                PIC  99.                     ELCDTECX
   764         16  WS-AD-MM                PIC  99.                     ELCDTECX
   765         16  WS-AD-DD                PIC  99.                     ELCDTECX
   766     12  WS-CURRENT-DATE.                                         ELCDTECX
   767         16  WS-CD-MM                PIC  99.                     ELCDTECX
   768         16  FILLER                  PIC  X          VALUE '/'.   ELCDTECX
   769         16  WS-CD-DD                PIC  99.                     ELCDTECX
   770         16  FILLER                  PIC  X          VALUE '/'.   ELCDTECX
   771         16  WS-CD-YY                PIC  99.                     ELCDTECX
   772     12  WS-TIME-OF-DAY.                                          ELCDTECX
   773         16  WS-TIME                 PIC  9(6).                   ELCDTECX
   774         16  WS-HUN-SEC              PIC  99.                     ELCDTECX
   775                                                                  ELCDTECX
   776 01  FILLER                          PIC  X(12)                   ELCDTECX
   777                                     VALUE 'CARRIER CLMS'.        ELCDTECX
   778 01  CARRIER-OPT-CLAIM-DATA.                                      ELCDTECX
   779     12  CARRIER-FLDS                OCCURS 25 TIMES.             ELCDTECX
   780         16  CARRIER-IBNR-SWITCH     PIC  X.                         CL**5
   781         16  CARRIER-IBNR-PERCENT    PIC S9V9(4) COMP-3.             CL**6
   782         16  CARRIER-CIDA-DISCOUNT   PIC S9V9(4) COMP-3.             CL**6
   783                                                                  ELCDTECX
   784 01  FILLER                          PIC  X(10)                   ELCDTECX
   785                                     VALUE 'STATE TLRS'.          ELCDTECX
   786 01  STATE-TARGET-LOSS-RATIOS.                                    ELCDTECX
   787     12  STATE-TLR-FLD               OCCURS 75 TIMES.             ELCDTECX
   788         16  STATE-TARGET-LOSS-RATIO PIC S9V9(4) COMP-3.             CL**6
   789         16  STATE-CALC-INTEREST     PIC S9V9(4) COMP-3.             CL**6
   790                                                                  ELCDTECX
   791 01  FILLER                          PIC  X(13)                   ELCDTECX
   792                                     VALUE 'BUSINESS TLRS'.       ELCDTECX
   793 01  BUSINESS-TRGT-LOSS-RATIO-MODS.                               ELCDTECX
   794     12  BUS-TLRM-FLD                OCCURS 99 TIMES.             ELCDTECX
   795         16  BUS-TRGT-LOSS-RATIO-MOD PIC S9V9(4) COMP-3.             CL**6
   796                                                                  ELCDTECX
   797 01  FILLER                          PIC  X(13)                   ELCDTECX
   798                                     VALUE 'MISC CLM DATA'.       ELCDTECX
   799 01  MISC-OPT-CLM-RSV-DATA.                                       ELCDTECX
   800     12  COMPANY-CALC-INTEREST       PIC S9V9(4) COMP-3.             CL**6
   801     12  COMPANY-CIDA-DISCOUNT       PIC S9V9(4) COMP-3.             CL**6
   802     12  COMPANY-CRDB-TABLE-SELECTION                             ELCDTECX
   803                                     PIC  X.                         CL**5
   804     12  COMPANY-IBNR-AH-FACTOR      PIC S9V9(4) COMP-3.             CL**6
   805     12  COMPANY-IBNR-LAG-MONTH      PIC S999    COMP-3.             CL**6
   806     12  COMPANY-IBNR-LIFE-FACTOR    PIC S9V9(4) COMP-3.             CL**6
   807     12  COMPANY-OPTION-START-DATE   PIC  XX.                        CL**5
   808     12  INDEXBS                     PIC S9(4)   COMP.               CL**6
   809     12  INDEXCA                     PIC S9(4)   COMP.               CL**6
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  18
* ECS090.cbl (/apps/prod/cid1p/copy/ELCDTECX)
   810     12  INDEXST                     PIC S9(4)   COMP.               CL**6
   811     12  FILLER                      PIC  X(75).                  ELCDTECX
   812******************************************************************ELCDTECX
   813*01  MISC-CARR-PCT-DATA.                                          00001521
   814*    12  DD-CARR1-UEP-PCT            PIC S9V9(4) COMP-3.          00001522
   815*    12  DD-CARR1-R78-PCT            PIC S9V9(4) COMP-3.          00001522
   816*    12  DD-CARR1-PRO-PCT            PIC S9V9(4) COMP-3.          00001522
   817*    12  DD-CARR2-UEP-PCT            PIC S9V9(4) COMP-3.          00001522
   818*    12  DD-CARR2-R78-PCT            PIC S9V9(4) COMP-3.          00001522
   819*    12  DD-CARR2-PRO-PCT            PIC S9V9(4) COMP-3.          00001522
   820******************************************************************ELCDTECX
   821                                                                  ECS090
*  822                             COPY ELCDTEVR.                       ECS090
   823***************************************************************** 04/15/98
   824*                                                                *ELCDTEVR
   825*                                                                *ELCDTEVR
   826*                            ELCDTEVR.                           *   LV003
   827*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
   828*                            VMOD=2.001                          *   CL**2
   829*                                                                *ELCDTEVR
   830*   WORKING STORAGE FOR DATE VARIABLES CREATED                   *ELCDTEVR
   831*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCDTEVR
   832*                                                                *ELCDTEVR
   833******************************************************************ELCDTEVR
   834 01  WS-DATE-CARD-DATE.                                           ELCDTEVR
   835     05  WS-RUN-DATE.                                             ELCDTEVR
   836         10  FILLER                  PIC  9(03).                  ELCDTEVR
   837         10  RUN-CCYY                PIC  9(04).                  ELCDTEVR
   838         10  RUN-CCYR  REDEFINES  RUN-CCYY.                       ELCDTEVR
   839             15  RUN-CC              PIC  99.                     ELCDTEVR
   840             15  RUN-YR              PIC  99.                     ELCDTEVR
   841         10  RUN-MO                  PIC  99.                     ELCDTEVR
   842         10  RUN-DA                  PIC  99.                     ELCDTEVR
   843     05  WS-RUN-DATE-N REDEFINES                                     CL**2
   844            WS-RUN-DATE              PIC 9(11).                      CL**2
   845     05  WS-EP-DT.                                                ELCDTEVR
   846         10  FILLER                  PIC  9(03).                  ELCDTEVR
   847         10  EP-CCYY                 PIC  9(04).                  ELCDTEVR
   848         10  EP-CCYR  REDEFINES  EP-CCYY.                         ELCDTEVR
   849             15  EP-CC               PIC  99.                     ELCDTEVR
   850             15  EP-YR               PIC  99.                     ELCDTEVR
   851         10  EP-MO                   PIC  99.                     ELCDTEVR
   852         10  EP-DA                   PIC  99.                     ELCDTEVR
   853     05  WS-EP-DT-N REDEFINES                                        CL**2
   854            WS-EP-DT                 PIC 9(11).                      CL**2
   855     05  WS-DTE-CONV-DT.                                             CL**4
   856         10  FILLER                  PIC  9(03).                     CL**4
   857         10  DTE-CONV-CCYY           PIC  9(04).                     CL**4
   858         10  DTE-CONV-CCYR  REDEFINES  DTE-CONV-CCYY.                CL**4
   859             15  DTE-CONV-CC         PIC  99.                        CL**4
   860             15  DTE-CONV-YR         PIC  99.                        CL**4
   861         10  DTE-CONV-MO             PIC  99.                        CL**4
   862         10  DTE-CONV-DA             PIC  99.                        CL**4
   863     05  WS-DTE-CONV-DT-N REDEFINES                                  CL**4
   864            WS-DTE-CONV-DT           PIC  9(11).                     CL**4
   865 01  WS-BALANCE-FORWARD-DATE.                                     ELCDTEVR
   866     05  WS-BF-LAST-ACTIVITY-DATE.                                ELCDTEVR
   867         10  FILLER                            PIC 999.           ELCDTEVR
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  19
* ECS090.cbl (/apps/prod/cid1p/copy/ELCDTEVR)
   868         10  BF-ACT-CCYY                       PIC 9(04).         ELCDTEVR
   869         10  BF-ACT-CCYR  REDEFINES  BF-ACT-CCYY.                 ELCDTEVR
   870             15  BF-ACT-CC                     PIC 99.            ELCDTEVR
   871             15  BF-ACT-YEAR                   PIC 99.            ELCDTEVR
   872         10  BF-ACT-MONTH                      PIC 99.            ELCDTEVR
   873         10  BF-ACT-DAY                        PIC 99.            ELCDTEVR
   874     05  WS-BF-LAST-ACTIVITY-DATE-N REDEFINES                        CL**2
   875            WS-BF-LAST-ACTIVITY-DATE           PIC 9(11).            CL**2
   876     05  WS-BF-CURRENT-LAST-STMT-DT.                              ELCDTEVR
   877         10  FILLER                            PIC 999.           ELCDTEVR
   878         10  BF-CURRENT-LAST-STMT-CEN          PIC 99.            ELCDTEVR
   879         10  BF-CURRENT-LAST-STMT-YEAR         PIC 99.            ELCDTEVR
   880         10  BF-CURRENT-LAST-STMT-MONTH        PIC 99.            ELCDTEVR
   881         10  BF-CURRENT-LAST-STMT-DAY          PIC 99.            ELCDTEVR
   882     05  WS-BF-CURRENT-LAST-STMT-DT-N REDEFINES                      CL**2
   883            WS-BF-CURRENT-LAST-STMT-DT        PIC 9(11).             CL**2
   884 01  WS-ADD-CONF-TRANSACTIONS-DTE.                                ELCDTEVR
   885     05  WS-AC-CERT-EFF-DATE.                                     ELCDTEVR
   886         10  FILLER                            PIC 999.           ELCDTEVR
   887         10  AC-CERT-CCYY                      PIC 9(04).         ELCDTEVR
   888         10  AC-CERT-CCYR  REDEFINES  AC-CERT-CCYY.               ELCDTEVR
   889             15  AC-CERT-CC                    PIC 99.            ELCDTEVR
   890             15  AC-CERT-YR                    PIC 99.            ELCDTEVR
   891         10  AC-CERT-MO                        PIC 99.            ELCDTEVR
   892         10  AC-CERT-DA                        PIC 99.            ELCDTEVR
   893     05  WS-AC-CERT-EFF-DATE-N REDEFINES                             CL**2
   894            WS-AC-CERT-EFF-DATE                PIC 9(11).            CL**2
   895     05  WS-AC-LIFE-CANCEL-DATE.                                  ELCDTEVR
   896         10  FILLER                            PIC 999.           ELCDTEVR
   897         10  AC-LIFE-CANCEL-CCYY               PIC 9(04).         ELCDTEVR
   898         10  AC-LIFE-CANCEL-CCYR REDEFINES AC-LIFE-CANCEL-CCYY.   ELCDTEVR
   899             15  AC-LIFE-CANCEL-CC             PIC 99.            ELCDTEVR
   900             15  AC-LIFE-CANCEL-YR             PIC 99.            ELCDTEVR
   901         10  AC-LIFE-CANCEL-MO                 PIC 99.            ELCDTEVR
   902         10  AC-LIFE-CANCEL-DA                 PIC 99.            ELCDTEVR
   903     05  WS-AC-LIFE-CANCEL-DATE-N REDEFINES                          CL**2
   904            WS-AC-LIFE-CANCEL-DATE             PIC 9(11).            CL**2
   905     05  WS-AC-AH-CANCEL-DATE.                                    ELCDTEVR
   906         10  FILLER                            PIC 999.           ELCDTEVR
   907         10  AC-AH-CANCEL-CCYY                 PIC 9(04).         ELCDTEVR
   908         10  AC-AH-CANCEL-CCYR  REDEFINES  AC-AH-CANCEL-CCYY.     ELCDTEVR
   909             15  AC-AH-CANCEL-CC               PIC 99.            ELCDTEVR
   910             15  AC-AH-CANCEL-YR               PIC 99.            ELCDTEVR
   911         10  AC-AH-CANCEL-MO                   PIC 99.            ELCDTEVR
   912         10  AC-AH-CANCEL-DA                   PIC 99.            ELCDTEVR
   913     05  WS-AC-AH-CANCEL-DATE-N REDEFINES                            CL**2
   914            WS-AC-AH-CANCEL-DATE               PIC 9(11).            CL**2
   915 01  WS-RATE-RECORD.                                              ELCDTEVR
   916         05  WS-RT-EXPIRY-DATE.                                   ELCDTEVR
   917             10  FILLER                        PIC 999.           ELCDTEVR
   918             10  RT-EXP-CCYY                   PIC 9(04).         ELCDTEVR
   919             10  RT-EXP-CCYR  REDEFINES  RT-EXP-CCYY.             ELCDTEVR
   920                 15  RT-EXP-CC                 PIC 99.            ELCDTEVR
   921                 15  RT-EXP-YR                 PIC 99.            ELCDTEVR
   922             10  RT-EXP-MO                     PIC 99.            ELCDTEVR
   923             10  RT-EXP-DA                     PIC 99.            ELCDTEVR
   924         05  WS-RT-EXPIRY-DATE-N REDEFINES                           CL**2
   925                WS-RT-EXPIRY-DATE              PIC 9(11).            CL**2
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  20
* ECS090.cbl
   927 PROCEDURE DIVISION.                                              ECS090
   928                                                                  ECS090
   929 0000-INIT-RTN.                                                   ECS090
*  930                             COPY ELCDTERX.                       ECS090
   931******************************************************************04/15/98
   932*                                                                *ELCDTERX
   933*                                                                *ELCDTERX
   934*                            ELCDTERX.                           *   LV002
   935*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
   936*                            VMOD=2.007                          *ELCDTERX
   937*                                                                *ELCDTERX
   938*      LOAD DATE CARD DISK FILE INTO WORKING STORAGE AREA        *ELCDTERX
   939*      (COPY CODE FOR W/S = ELCDTECX AND COPY CODE FOR FD        *ELCDTERX
   940*      = ELCDTEFD)                                               *ELCDTERX
   941*                                                                *ELCDTERX
   942******************************************************************ELCDTERX
   943                                                                  ELCDTERX
   944     ACCEPT WS-ACCEPT-DATE       FROM  DATE.                      ELCDTERX
   945                                                                  ELCDTERX
   946     MOVE WS-AD-YY               TO  WS-CD-YY.                    ELCDTERX
   947     MOVE WS-AD-MM               TO  WS-CD-MM.                    ELCDTERX
   948     MOVE WS-AD-DD               TO  WS-CD-DD.                    ELCDTERX
   949                                                                  ELCDTERX
   950     ACCEPT WS-TIME-OF-DAY       FROM  TIME.                      ELCDTERX
   951                                                                  ELCDTERX
   952******************************************************************ELCDTERX
   953*    NOTE: THE FOLLOWING STATEMENT IS USED TO ELIMINATE COB II    ELCDTERX
   954*          WARNING MESSAGES.                                      ELCDTERX
   955******************************************************************ELCDTERX
   956     IF WS-CD-YY = LOW-VALUES                                     ELCDTERX
   957         COMPUTE PGM-SUB = PGM-SUB + 1.                           ELCDTERX
   958                                                                  ELCDTERX
   959     OPEN INPUT DISK-DATE.                                        ELCDTERX
   960                                                                  ELCDTERX
   961     MOVE SPACE TO DATE-CARD         CLAS-BUSINESS-CLASSES        ELCDTERX
   962                   STATE-NAMES       CLAS-MORTALITY-CODES         ELCDTERX
   963                   CLAS-INS-TYPES    COMPANY-NAME-TABLE           ELCDTERX
   964                   DATE-CARD-OPTIONS DATE-CARD-FACTORS            ELCDTERX
   965                   CLAX-ID           CLAS-MISC                    ELCDTERX
   966                   CARRIER-NAMES     CLASIC-SYSTEM-CODES          ELCDTERX
   967                   CARRIER-OPT-CLAIM-DATA                         ELCDTERX
   968                   STATE-TARGET-LOSS-RATIOS                       ELCDTERX
   969                   BUSINESS-TRGT-LOSS-RATIO-MODS                  ELCDTERX
   970                   MISC-OPT-CLM-RSV-DATA.                         ELCDTERX
   971                                                                  ELCDTERX
   972     MOVE LOW-VALUES TO CLAS-INDEX-TBL CLAS-TYPE-MISC.            ELCDTERX
   973                                                                  ELCDTERX
   974     MOVE ZERO TO CLAS-CN DTE-TOT-LINES CLAS-CO                   ELCDTERX
   975                  INDEXCA INDEXBS INDEXST.                        ELCDTERX
   976                                                                  ELCDTERX
   977     COMPUTE CLAS-CN = PGM-SUB / +50.                             ELCDTERX
   978     COMPUTE CLAS-CO = PGM-SUB / +20.                             ELCDTERX
   979     COMPUTE CLAS-INDEXEN = PGM-SUB - (CLAS-CN * +50).            ELCDTERX
   980     COMPUTE CLAS-INDEXON = PGM-SUB - (CLAS-CO * +20).            ELCDTERX
   981                                                                  ELCDTERX
   982     IF CLAS-INDEXEN = ZERO                                       ELCDTERX
   983         MOVE +50               TO CLAS-INDEXEN                   ELCDTERX
   984     ELSE                                                         ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  21
* ECS090.cbl (/apps/prod/cid1p/copy/ELCDTERX)
   985         ADD +1                 TO CLAS-CN.                       ELCDTERX
   986                                                                  ELCDTERX
   987     IF CLAS-INDEXON = ZERO                                       ELCDTERX
   988         MOVE +20               TO CLAS-INDEXON                   ELCDTERX
   989     ELSE                                                         ELCDTERX
   990         ADD +1                 TO CLAS-CO.                       ELCDTERX
   991                                                                  ELCDTERX
   992 0005-READ--CARD.                                                 ELCDTERX
   993     READ DISK-DATE                                               ELCDTERX
   994         AT END CLOSE DISK-DATE                                   ELCDTERX
   995             GO TO 0060-READ--TEST.                               ELCDTERX
   996                                                                  ELCDTERX
   997     MOVE ZERO                   TO CLAS-INDEX.                   ELCDTERX
   998                                                                  ELCDTERX
   999     IF DD-ID = 'CLAS' OR 'LIFE' OR 'GLED'                        ELCDTERX
  1000         MOVE DATE-DISK          TO DATE-CARD                     ELCDTERX
  1001         MOVE RUN-DATE           TO WS-RUN-DATE-N                    CL**2
  1002         MOVE EP-DT              TO WS-EP-DT-N                       CL**2
  1003         GO TO 0005-READ--CARD.                                   ELCDTERX
  1004                                                                  ELCDTERX
  1005     IF DD-ID = 'CLAD'                                            ELCDTERX
  1006         MOVE DATE-DISK          TO DATE-CARD-OPTIONS             ELCDTERX
  1007         GO TO 0005-READ--CARD.                                   ELCDTERX
  1008                                                                  ELCDTERX
  1009     IF DD-ID = 'CLAX'                                            ELCDTERX
  1010         MOVE DATE-DISK          TO CLAS-INDEX-TBL                ELCDTERX
  1011         GO TO 0005-READ--CARD.                                   ELCDTERX
  1012                                                                  ELCDTERX
  1013     IF DD-ID = 'CLAF'                                            ELCDTERX
  1014         MOVE DATE-DISK          TO DATE-CARD-FACTORS             ELCDTERX
  1015         GO TO 0005-READ--CARD.                                   ELCDTERX
  1016                                                                  ELCDTERX
  1017     IF DD-ID = 'CLAC'                                            ELCDTERX
  1018         GO TO 0010-READ--CLAC.                                   ELCDTERX
  1019                                                                  ELCDTERX
  1020     IF DD-ID = 'CARR'                                            ELCDTERX
  1021         GO TO 0015-READ--CARR.                                   ELCDTERX
  1022                                                                  ELCDTERX
  1023     IF DD-ID = 'STAT'                                            ELCDTERX
  1024         GO TO 0020-READ--STAT.                                   ELCDTERX
  1025                                                                  ELCDTERX
  1026     IF DD-ID = 'BUSC'                                            ELCDTERX
  1027         GO TO 0025-READ--BUSC.                                   ELCDTERX
  1028                                                                  ELCDTERX
  1029     IF DD-ID = 'MORT'                                            ELCDTERX
  1030         GO TO 0030-READ--MORT.                                   ELCDTERX
  1031                                                                  ELCDTERX
  1032     IF DD-ID = 'CLAI'                                            ELCDTERX
  1033         GO TO 0040-READ--CLAI.                                   ELCDTERX
  1034                                                                  ELCDTERX
  1035     IF DD-ID = 'COLC'                                            ELCDTERX
  1036         GO TO 0065-READ--COLC.                                   ELCDTERX
  1037                                                                  ELCDTERX
  1038     IF DD-IDX NUMERIC AND                                        ELCDTERX
  1039        DD-IDA = 'CL'                                             ELCDTERX
  1040         GO TO 0035-READ--CLXX.                                   ELCDTERX
  1041                                                                  ELCDTERX
  1042     IF DD-IDX NUMERIC AND                                        ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  22
* ECS090.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  1043        DD-IDA = 'PO'                                             ELCDTERX
  1044         GO TO 0050-READ--POXX.                                   ELCDTERX
  1045                                                                  ELCDTERX
  1046     IF DD-ID = 'OPCA'                                            ELCDTERX
  1047         GO TO 0070-READ--OPCA.                                   ELCDTERX
  1048                                                                  ELCDTERX
  1049     IF DD-ID = 'OPST'                                            ELCDTERX
  1050         GO TO 0072-READ--OPST.                                   ELCDTERX
  1051                                                                  ELCDTERX
  1052     IF DD-ID = 'OPBS'                                            ELCDTERX
  1053         GO TO 0074-READ--OPBS.                                   ELCDTERX
  1054                                                                  ELCDTERX
  1055     IF DD-ID = 'OPMS'                                            ELCDTERX
  1056         MOVE DD-MISC-DATA       TO MISC-OPT-CLM-RSV-DATA.        ELCDTERX
  1057                                                                  ELCDTERX
  1058     GO TO 0005-READ--CARD.                                       ELCDTERX
  1059                                                                  ELCDTERX
  1060 0010-READ--CLAC.                                                 ELCDTERX
  1061     ADD 1                       TO CLAS-INDEXC.                  ELCDTERX
  1062     MOVE DD-CR1                 TO CNT-ID (CLAS-INDEXC).         ELCDTERX
  1063     MOVE DD-CR1N                TO CNT-NAME (CLAS-INDEXC).       ELCDTERX
  1064     ADD 1                       TO CLAS-INDEXC.                  ELCDTERX
  1065     MOVE DD-CR2                 TO CNT-ID (CLAS-INDEXC).         ELCDTERX
  1066     MOVE DD-CR2N                TO CNT-NAME (CLAS-INDEXC).       ELCDTERX
  1067     GO TO 0005-READ--CARD.                                       ELCDTERX
  1068                                                                  ELCDTERX
  1069 0015-READ--CARR.                                                 ELCDTERX
  1070     ADD 1  TO  CLAS-INDEXCN.                                     ELCDTERX
  1071     IF CLAS-INDEXCN LESS THAN +26                                ELCDTERX
  1072        MOVE DD-CARR1         TO CARRIER-SUB (CLAS-INDEXCN)
  1073        MOVE DD-CARR1S        TO CARRIER-DOM-ST (CLAS-INDEXCN)
  1074        MOVE DD-CARR1N        TO CARRIER-PIC (CLAS-INDEXCN)
  1075        MOVE DD-CARR1-UEP-PCT TO CARRIER-UEP-PCT (CLAS-INDEXCN)
  1076        MOVE DD-CARR1-R78-PCT TO CARRIER-R78-PCT (CLAS-INDEXCN)
  1077        MOVE DD-CARR1-PRO-PCT TO CARRIER-PRO-PCT (CLAS-INDEXCN)
  1078        MOVE DD-CARR1-SECPAY-SW
  1079                               TO CARRIER-SEC-PAY (CLAS-INDEXCN)
  1080     END-IF
  1081                                                                  ELCDTERX
  1082     ADD 1  TO  CLAS-INDEXCN.                                     ELCDTERX
  1083     IF CLAS-INDEXCN LESS THAN +26                                ELCDTERX
  1084        MOVE DD-CARR2         TO CARRIER-SUB (CLAS-INDEXCN)
  1085        MOVE DD-CARR2S        TO CARRIER-DOM-ST (CLAS-INDEXCN)
  1086        MOVE DD-CARR2N        TO CARRIER-PIC (CLAS-INDEXCN)
  1087        MOVE DD-CARR2-UEP-PCT TO CARRIER-UEP-PCT (CLAS-INDEXCN)
  1088        MOVE DD-CARR2-R78-PCT TO CARRIER-R78-PCT (CLAS-INDEXCN)
  1089        MOVE DD-CARR2-PRO-PCT TO CARRIER-PRO-PCT (CLAS-INDEXCN)
  1090        MOVE DD-CARR2-SECPAY-SW
  1091                              TO CARRIER-SEC-PAY (CLAS-INDEXCN)
  1092     END-IF
  1093                                                                  ELCDTERX
  1094                                                                  ELCDTERX
  1095     GO TO 0005-READ--CARD.                                       ELCDTERX
  1096                                                                  ELCDTERX
  1097 0020-READ--STAT.                                                 ELCDTERX
  1098     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  1099     IF CLAS-INDEX GREATER 3  OR                                  ELCDTERX
  1100        DD-ST (CLAS-INDEX) = SPACE                                ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  23
* ECS090.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  1101         GO TO 0005-READ--CARD.                                   ELCDTERX
  1102                                                                  ELCDTERX
  1103     ADD 1                       TO CLAS-INDEXS.                  ELCDTERX
  1104     MOVE DD-ST (CLAS-INDEX)     TO STATE-NAME-FLD (CLAS-INDEXS). ELCDTERX
  1105     GO TO 0020-READ--STAT.                                       ELCDTERX
  1106                                                                  ELCDTERX
  1107 0025-READ--BUSC.                                                 ELCDTERX
  1108     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  1109     IF CLAS-INDEX GREATER 3  OR                                  ELCDTERX
  1110        DD-ST (CLAS-INDEX) = SPACE                                ELCDTERX
  1111         GO TO 0005-READ--CARD.                                   ELCDTERX
  1112                                                                  ELCDTERX
  1113     ADD 1                       TO CLAS-INDEXB.                  ELCDTERX
  1114     MOVE DD-ST (CLAS-INDEX)     TO CLAS-BUSC-FLD (CLAS-INDEXB).  ELCDTERX
  1115     GO TO 0025-READ--BUSC.                                       ELCDTERX
  1116                                                                  ELCDTERX
  1117 0030-READ--MORT.                                                 ELCDTERX
  1118     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  1119     IF CLAS-INDEX GREATER 2  OR                                  ELCDTERX
  1120        DD-MORT (CLAS-INDEX) = SPACE                              ELCDTERX
  1121         GO TO 0005-READ--CARD.                                   ELCDTERX
  1122                                                                  ELCDTERX
  1123     ADD 1                       TO CLAS-INDEXM.                  ELCDTERX
  1124     MOVE DD-MORT (CLAS-INDEX)   TO CLAS-MORT-FLD (CLAS-INDEXM).  ELCDTERX
  1125     GO TO 0030-READ--MORT.                                       ELCDTERX
  1126                                                                  ELCDTERX
  1127 0035-READ--CLXX.                                                 ELCDTERX
  1128     IF DD-IDX NOT = CLAS-CN                                      ELCDTERX
  1129          GO TO 0005-READ--CARD.                                  ELCDTERX
  1130                                                                  ELCDTERX
  1131     IF DD-PS-PIC (CLAS-INDEXEN) = 'X'                            ELCDTERX
  1132         DISPLAY '***********************************************'ELCDTERX
  1133         DISPLAY 'PROGRAM ECS-', PGM-SUB, ' NOT SCHEDULED TO RUN' ELCDTERX
  1134         DISPLAY '***********************************************'ELCDTERX
  1135         GO TO 0055-READ--STOP.                                   ELCDTERX
  1136                                                                  ELCDTERX
  1137     IF DD-PS-PIC (CLAS-INDEXEN) NOT LESS 'A'  AND                ELCDTERX
  1138        DD-PS-PIC (CLAS-INDEXEN) NOT GREATER 'I'                  ELCDTERX
  1139         MOVE '1'                TO DTE-FICH.                     ELCDTERX
  1140                                                                  ELCDTERX
  1141     IF DD-PS-PIC (CLAS-INDEXEN) NOT LESS 'J'  AND                ELCDTERX
  1142        DD-PS-PIC (CLAS-INDEXEN) NOT GREATER 'R'                  ELCDTERX
  1143         MOVE '2'                TO DTE-FICH.                     ELCDTERX
  1144                                                                  ELCDTERX
  1145*    MOVE DD-PS-PIC (CLAS-INDEXEN) TO DTE-PGM-OPT.                ELCDTERX
  1146     GO TO 0005-READ--CARD.                                       ELCDTERX
  1147                                                                  ELCDTERX
  1148 0040-READ--CLAI.                                                 ELCDTERX
  1149     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  1150     IF CLAS-INDEX GREATER 2  OR                                  ELCDTERX
  1151        DD-TYPE (CLAS-INDEX) = SPACE                              ELCDTERX
  1152         GO TO 0005-READ--CARD.                                   ELCDTERX
  1153                                                                  ELCDTERX
  1154     ADD 1                       TO CLAS-INDEXA.                  ELCDTERX
  1155     MOVE DD-TYPE (CLAS-INDEX) TO CLAS-ALL-TYPES (CLAS-INDEXA).   ELCDTERX
  1156     GO TO 0040-READ--CLAI.                                       ELCDTERX
  1157                                                                  ELCDTERX
  1158 0045-READ--DUMP.                                                 ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  24
* ECS090.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  1159     MOVE +999 TO WS-RETURN-CODE                                  ELCDTERX
  1160     MOVE 'MISSING AND/OR INVALID CLAS DATE CARD'                 ELCDTERX
  1161                                 TO  WS-ABEND-MESSAGE             ELCDTERX
  1162     PERFORM ABEND-PGM.                                           ELCDTERX
  1163                                                                  ELCDTERX
  1164 0050-READ--POXX.                                                 ELCDTERX
  1165     IF DD-IDX NOT = CLAS-CO                                      ELCDTERX
  1166         GO TO 0005-READ--CARD.                                   ELCDTERX
  1167                                                                  ELCDTERX
  1168     IF DD-PS-PRC (CLAS-INDEXON) = 'X'                            ELCDTERX
  1169         DISPLAY '***********************************************'ELCDTERX
  1170         DISPLAY 'ECS - ', PGM-SUB, ' IS NOT SCHEDULED TO RUN'    ELCDTERX
  1171         DISPLAY '***********************************************'ELCDTERX
  1172         GO TO 0055-READ--STOP.                                   ELCDTERX
  1173                                                                  ELCDTERX
  1174     MOVE DD-PS-PRT (CLAS-INDEXON) TO DTE-PRT-OPT.                ELCDTERX
  1175     MOVE DD-PS-FMT (CLAS-INDEXON) TO DTE-FMT-OPT.                ELCDTERX
  1176     MOVE DD-PS-PRC (CLAS-INDEXON) TO DTE-PRC-OPT DTE-PGM-OPT.    ELCDTERX
  1177     MOVE DD-PS-TOT (CLAS-INDEXON) TO DTE-TOT-OPT.                ELCDTERX
  1178                                                                  ELCDTERX
  1179     IF DTE-PRT-OPT = 'B'                                         ELCDTERX
  1180         MOVE '2'                  TO DTE-FICH.                   ELCDTERX
  1181     IF DTE-PRT-OPT = 'F'                                         ELCDTERX
  1182         MOVE '1'                  TO DTE-FICH.                   ELCDTERX
  1183                                                                  ELCDTERX
  1184     GO TO 0005-READ--CARD.                                       ELCDTERX
  1185                                                                  ELCDTERX
  1186 0055-READ--STOP.                                                 ELCDTERX
  1187     GOBACK.                                                      ELCDTERX
  1188                                                                  ELCDTERX
  1189 0060-READ--TEST.                                                 ELCDTERX
  1190     IF DATX-COD        = SPACE  OR                               ELCDTERX
  1191        CLAX-ID         = SPACE  OR                               ELCDTERX
  1192        DATE-OPTIONS-ID = SPACE                                   ELCDTERX
  1193         GO TO 0045-READ--DUMP.                                   ELCDTERX
  1194                                                                  ELCDTERX
  1195     MOVE LOW-VALUE TO CLAS-TYPE-MISC.                            ELCDTERX
  1196     GO TO 0079-READ--EXIT.                                       ELCDTERX
  1197                                                                  ELCDTERX
  1198 0065-READ--COLC.                                                 ELCDTERX
  1199     MOVE DATE-DISK              TO CLASIC-SYSTEM-CODES.          ELCDTERX
  1200     GO TO 0005-READ--CARD.                                       ELCDTERX
  1201                                                                  ELCDTERX
  1202 0070-READ--OPCA.                                                 ELCDTERX
  1203                                                                  ELCDTERX
  1204     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  1205                                                                  ELCDTERX
  1206     IF  CLAS-INDEX GREATER 13                                    ELCDTERX
  1207             OR                                                   ELCDTERX
  1208         DD-CARR-FLDS (CLAS-INDEX) = SPACE                        ELCDTERX
  1209         GO TO 0005-READ--CARD.                                   ELCDTERX
  1210                                                                  ELCDTERX
  1211     ADD 1                       TO INDEXCA.                      ELCDTERX
  1212     MOVE DD-CARR-FLDS (CLAS-INDEX)                               ELCDTERX
  1213                                 TO CARRIER-FLDS (INDEXCA).       ELCDTERX
  1214     GO TO 0070-READ--OPCA.                                       ELCDTERX
  1215                                                                  ELCDTERX
  1216 0072-READ--OPST.                                                 ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  25
* ECS090.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  1217                                                                  ELCDTERX
  1218     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  1219                                                                  ELCDTERX
  1220     IF  CLAS-INDEX GREATER 16                                    ELCDTERX
  1221             OR                                                   ELCDTERX
  1222         DD-TLR (CLAS-INDEX) = SPACE                              ELCDTERX
  1223         GO TO 0005-READ--CARD.                                   ELCDTERX
  1224                                                                  ELCDTERX
  1225     ADD 1                       TO INDEXST.                      ELCDTERX
  1226     MOVE DD-STATE-FLDS (CLAS-INDEX)                              ELCDTERX
  1227                                 TO STATE-TLR-FLD (INDEXST).      ELCDTERX
  1228     GO TO 0072-READ--OPST.                                       ELCDTERX
  1229                                                                  ELCDTERX
  1230 0074-READ--OPBS.                                                 ELCDTERX
  1231                                                                  ELCDTERX
  1232     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  1233                                                                  ELCDTERX
  1234     IF  CLAS-INDEX GREATER 32                                    ELCDTERX
  1235             OR                                                   ELCDTERX
  1236         DD-TLR (CLAS-INDEX) = SPACE                              ELCDTERX
  1237         GO TO 0005-READ--CARD.                                   ELCDTERX
  1238                                                                  ELCDTERX
  1239     ADD 1                       TO INDEXBS.                      ELCDTERX
  1240     MOVE DD-TLR (CLAS-INDEX)    TO BUS-TLRM-FLD (INDEXBS).       ELCDTERX
  1241     GO TO 0074-READ--OPBS.                                       ELCDTERX
  1242                                                                  ELCDTERX
  1243 0079-READ--EXIT.                                                 ELCDTERX
  1244*    EXIT.                                                        ELCDTERX
  1245******************************************************************ELCDTERX
  1246                                                                  ECS090
  1247     MOVE COMPANY-NAME           TO HD-CLIENT.                    ECS090
  1248     MOVE WS-CURRENT-DATE        TO HD-IPL.                       ECS090
  1249     MOVE ALPH-DATE              TO HD-DATE.                      ECS090
  1250                                                                  ECS090
  1251     OPEN OUTPUT PRNT-FILE.                                       ECS090
  1252                                                                  ECS090
  1253     MOVE SPACES                 TO P-REC.                        ECS090
  1254     MOVE 0                      TO CCSW.                         ECS090
  1255                                                                  ECS090
  1256     PERFORM 0200-HEAD-RTN    THRU 0299-EXIT.                     ECS090
  1257                                                                  ECS090
  1258     PERFORM 0300-BACKUP-DATE THRU 0399-EXIT.                     ECS090
  1259     PERFORM 0400-BACKUP-ACCT THRU 0499-EXIT.                     ECS090
  1260     PERFORM 0500-BACKUP-EXTR THRU 0599-EXIT.                     ECS090
  1261     PERFORM 0600-BACKUP-EPEC THRU 0699-EXIT.                     ECS090
  1262     PERFORM 0700-BACKUP-REIN THRU 0799-EXIT.                     ECS090
  1263     PERFORM 0800-BACKUP-CTBL THRU 0899-EXIT.                     ECS090
  1264     PERFORM 0900-BACKUP-CRED THRU 0999-EXIT.                     ECS090
  1265     PERFORM 1099-BACKUP-COMP THRU 1999-EXIT.                     ECS090
  1266                                                                  ECS090
  1267     GO TO 2000-END-JOB.                                          ECS090
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  26
* ECS090.cbl
  1269 0100-PRT-RTN.                                                    ECS090
  1270     MOVE P-REC                  TO PRT-REC.                      ECS090
  1271     MOVE P-CCSW                 TO CCSW.                         ECS090
  1272     WRITE PRT-REC AFTER ADVANCING CCSW.                          ECS090
  1273                                                                  ECS090
  1274     MOVE SPACES                 TO P-REC.                        ECS090
  1275     MOVE '0'                    TO P-CCSW.                       ECS090
  1276                                                                  ECS090
  1277     IF CCSW = '1'                                                ECS090
  1278         MOVE +1                 TO LN-CTR                        ECS090
  1279     ELSE                                                         ECS090
  1280         IF CCSW = ' '                                            ECS090
  1281             ADD +1 TO LN-CTR                                     ECS090
  1282         ELSE                                                     ECS090
  1283             IF CCSW = '0'                                        ECS090
  1284                 ADD +2 TO LN-CTR                                 ECS090
  1285             ELSE                                                 ECS090
  1286                 ADD +3 TO LN-CTR.                                ECS090
  1287                                                                  ECS090
  1288 0199-EXIT.                                                       ECS090
  1289     EXIT.                                                        ECS090
  1290                                                                  ECS090
  1291 0200-HEAD-RTN.                                                   ECS090
  1292     MOVE '1'                    TO P-CCSW.                       ECS090
  1293     MOVE HEAD-1                 TO P-LINE.                       ECS090
  1294                                                                  ECS090
  1295     PERFORM 0100-PRT-RTN THRU 0199-EXIT.                         ECS090
  1296                                                                  ECS090
  1297     MOVE ' '                    TO P-CCSW.                       ECS090
  1298     MOVE HEAD-2                 TO P-LINE.                       ECS090
  1299                                                                  ECS090
  1300     PERFORM 0100-PRT-RTN THRU 0199-EXIT.                         ECS090
  1301                                                                  ECS090
  1302     MOVE HEAD-3                 TO P-LINE.                       ECS090
  1303                                                                  ECS090
  1304     PERFORM 0100-PRT-RTN THRU 0199-EXIT.                         ECS090
  1305                                                                  ECS090
  1306     MOVE HEAD-4                 TO P-LINE.                       ECS090
  1307                                                                  ECS090
  1308     PERFORM 0100-PRT-RTN THRU 0199-EXIT 2 TIMES.                 ECS090
  1309                                                                  ECS090
  1310 0299-EXIT.                                                       ECS090
  1311     EXIT.                                                        ECS090
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  27
* ECS090.cbl
  1313 0300-BACKUP-DATE.                                                ECS090
  1314     OPEN INPUT  DISK-DATE                                        ECS090
  1315          OUTPUT BKUP-DATE.                                       ECS090
  1316*  FIRST BACKUP - COMPLETE REWIND OF OUTPUT TAPE.                 ECS090
  1317                                                                  ECS090
  1318 0310-READ-DATE.                                                  ECS090
  1319     READ DISK-DATE AT END                                        ECS090
  1320         GO TO 0320-END-DATE.                                     ECS090
  1321                                                                  ECS090
  1322     ADD +1                      TO DATE-CTR.                     ECS090
  1323     MOVE DATE-DISK              TO BK-DATE.                      ECS090
  1324                                                                  ECS090
  1325     WRITE BK-DATE.                                               ECS090
  1326                                                                  ECS090
  1327     GO TO 0310-READ-DATE.                                        ECS090
  1328                                                                  ECS090
  1329 0320-END-DATE.                                                   ECS090
  1330     MOVE 'DATE CARD'            TO P-DESC.                       ECS090
  1331     MOVE DATE-CTR               TO P-CTR.                        ECS090
  1332     MOVE 'FILE BACKED UP'       TO P-MSG.                        ECS090
  1333                                                                  ECS090
  1334     PERFORM 0100-PRT-RTN THRU 0199-EXIT.                         ECS090
  1335                                                                  ECS090
  1336     CLOSE DISK-DATE.                                             ECS090
  1337     CLOSE BKUP-DATE WITH NO REWIND.                              ECS090
  1338                                                                  ECS090
  1339 0399-EXIT.                                                       ECS090
  1340     EXIT.                                                        ECS090
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  28
* ECS090.cbl
  1342 0400-BACKUP-ACCT.                                                ECS090
  1343     OPEN INPUT  ERACCTT                                          ECS090
  1344          OUTPUT BKUP-ACCT WITH NO REWIND.                        ECS090
  1345                                                                  ECS090
  1346     IF ERACCTT-FILE-STATUS  = '00' OR '97'                       ECS090
  1347         NEXT SENTENCE                                            ECS090
  1348       ELSE                                                       ECS090
  1349         MOVE ERACCTT-FILE-STATUS                                 ECS090
  1350                                 TO WS-ABEND-FILE-STATUS          ECS090
  1351         MOVE 'ERACCTT OPEN ERROR- '                              ECS090
  1352                                 TO WS-ABEND-MESSAGE              ECS090
  1353         GO TO ABEND-PGM.                                         ECS090
  1354                                                                  ECS090
  1355 0410-READ-ACCT.                                                  ECS090
  1356     READ ERACCTT.                                                ECS090
  1357                                                                  ECS090
  1358     IF ERACCTT-FILE-STATUS = '10'                                ECS090
  1359         GO TO 0420-END-ACCT.                                     ECS090
  1360                                                                  ECS090
  1361     IF ERACCTT-FILE-STATUS NOT = '00'                            ECS090
  1362         MOVE ERACCTT-FILE-STATUS                                 ECS090
  1363                                 TO WS-ABEND-FILE-STATUS          ECS090
  1364         MOVE 'ERACCTT READ ERROR- '                              ECS090
  1365                                 TO WS-ABEND-MESSAGE              ECS090
  1366         GO TO ABEND-PGM.                                         ECS090
  1367                                                                  ECS090
  1368     ADD +1                      TO ACCT-CTR.                     ECS090
  1369     MOVE ACCT-REC               TO BK-ACCT.                      ECS090
  1370                                                                  ECS090
  1371     WRITE BK-ACCT.                                               ECS090
  1372                                                                  ECS090
  1373     GO TO 0410-READ-ACCT.                                        ECS090
  1374                                                                  ECS090
  1375 0420-END-ACCT.                                                   ECS090
  1376     MOVE 'ACCOUNT MASTER'       TO P-DESC.                       ECS090
  1377     MOVE ACCT-CTR               TO P-CTR.                        ECS090
  1378     MOVE 'FILE BACKED UP'       TO P-MSG.                        ECS090
  1379                                                                  ECS090
  1380     PERFORM 0100-PRT-RTN THRU 0199-EXIT.                         ECS090
  1381                                                                  ECS090
  1382     CLOSE ERACCTT.                                               ECS090
  1383                                                                  ECS090
  1384     IF ERACCTT-FILE-STATUS NOT = '00'                            ECS090
  1385         MOVE ERACCTT-FILE-STATUS                                 ECS090
  1386                                 TO WS-ABEND-FILE-STATUS          ECS090
  1387         MOVE 'ERACCTT CLOSE ERROR- '                             ECS090
  1388                                 TO WS-ABEND-MESSAGE              ECS090
  1389         GO TO ABEND-PGM.                                         ECS090
  1390                                                                  ECS090
  1391     CLOSE BKUP-ACCT WITH NO REWIND.                              ECS090
  1392                                                                  ECS090
  1393 0499-EXIT.                                                       ECS090
  1394     EXIT.                                                        ECS090
  1395                                                                  ECS090
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  29
* ECS090.cbl
  1397 0500-BACKUP-EXTR.                                                ECS090
  1398     OPEN INPUT  EPECEXTR                                         ECS090
  1399          OUTPUT BKUP-EXTR WITH NO REWIND.                        ECS090
  1400                                                                  ECS090
  1401 0510-READ-EXTR.                                                  ECS090
  1402     READ EPECEXTR AT END                                         ECS090
  1403         GO TO 0520-END-EXTR.                                     ECS090
  1404                                                                  ECS090
  1405     ADD +1 TO EXTR-CTR.                                          ECS090
  1406     MOVE EXTR-REC               TO BK-EXTR.                      ECS090
  1407                                                                  ECS090
  1408     WRITE BK-EXTR.                                               ECS090
  1409                                                                  ECS090
  1410     GO TO 0510-READ-EXTR.                                        ECS090
  1411                                                                  ECS090
  1412 0520-END-EXTR.                                                   ECS090
  1413     MOVE 'EXTRACT FILE'         TO P-DESC.                       ECS090
  1414     MOVE EXTR-CTR               TO P-CTR.                        ECS090
  1415     MOVE 'FILE BACKED UP'       TO P-MSG.                        ECS090
  1416                                                                  ECS090
  1417     PERFORM 0100-PRT-RTN THRU 0199-EXIT.                         ECS090
  1418                                                                  ECS090
  1419     CLOSE EPECEXTR.                                              ECS090
  1420     CLOSE BKUP-EXTR WITH NO REWIND.                              ECS090
  1421                                                                  ECS090
  1422 0599-EXIT.                                                       ECS090
  1423     EXIT.                                                        ECS090
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  30
* ECS090.cbl
  1425 0600-BACKUP-EPEC.                                                ECS090
  1426     OPEN OUTPUT BKUP-EPEC WITH NO REWIND.                        ECS090
  1427                                                                  ECS090
  1428     IF DTE-SYS-F-CLASIC-CREDIT = '1'                             ECS090
  1429         MOVE 'EPEC FILE   '     TO P-DESC                        ECS090
  1430         MOVE +0                 TO P-CTR                         ECS090
  1431         MOVE 'NO EPEC BACKUP'   TO P-MSG                         ECS090
  1432         PERFORM 0100-PRT-RTN THRU 0199-EXIT                      ECS090
  1433         GO TO 0630-CLOSE-EPEC.                                   ECS090
  1434                                                                  ECS090
  1435     OPEN INPUT  DETEXTR.                                         ECS090
  1436                                                                  ECS090
  1437 0610-READ-EPEC.                                                  ECS090
  1438     READ DETEXTR AT END                                          ECS090
  1439         GO TO 0620-END-EPEC.                                     ECS090
  1440                                                                  ECS090
  1441     ADD +1 TO EPEC-CTR.                                          ECS090
  1442     MOVE DETAIL-EPEC            TO BK-EPEC.                      ECS090
  1443                                                                  ECS090
  1444     WRITE BK-EPEC.                                               ECS090
  1445                                                                  ECS090
  1446     GO TO 0610-READ-EPEC.                                        ECS090
  1447                                                                  ECS090
  1448 0620-END-EPEC.                                                   ECS090
  1449     MOVE 'EPEC FILE   '         TO P-DESC.                       ECS090
  1450     MOVE EPEC-CTR               TO P-CTR.                        ECS090
  1451     MOVE 'FILE BACKED UP'       TO P-MSG.                        ECS090
  1452                                                                  ECS090
  1453     PERFORM 0100-PRT-RTN THRU 0199-EXIT.                         ECS090
  1454                                                                  ECS090
  1455     CLOSE DETEXTR.                                               ECS090
  1456                                                                  ECS090
  1457 0630-CLOSE-EPEC.                                                 ECS090
  1458     CLOSE BKUP-EPEC WITH NO REWIND.                              ECS090
  1459                                                                  ECS090
  1460 0699-EXIT.                                                       ECS090
  1461     EXIT.                                                        ECS090
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  31
* ECS090.cbl
  1463 0700-BACKUP-REIN.                                                ECS090
  1464     OPEN OUTPUT BKUP-REIN WITH NO REWIND.                        ECS090
  1465                                                                  ECS090
  1466     IF DTE-REINSURANCE = ' '                                     ECS090
  1467         MOVE LOW-VALUE         TO BK-REIN                        ECS090
  1468         WRITE BK-REIN                                            ECS090
  1469         MOVE 'REINSURANCE TABLES' TO P-DESC                      ECS090
  1470         MOVE +1                TO P-CTR                          ECS090
  1471         MOVE 'ZERO FILE USED'  TO P-MSG                          ECS090
  1472         PERFORM 0100-PRT-RTN THRU 0199-EXIT                      ECS090
  1473         GO TO 0730-CLOSE-REIN.                                   ECS090
  1474                                                                  ECS090
  1475     OPEN INPUT REIN-FILE.                                        ECS090
  1476                                                                  ECS090
  1477     IF REIN-FILE-STATUS  = '00' OR '97'                          ECS090
  1478         NEXT SENTENCE                                            ECS090
  1479       ELSE                                                       ECS090
  1480         MOVE REIN-FILE-STATUS                                    ECS090
  1481                                 TO WS-ABEND-FILE-STATUS          ECS090
  1482         MOVE 'REIN OPEN ERROR- '                                 ECS090
  1483                                 TO WS-ABEND-MESSAGE              ECS090
  1484         GO TO ABEND-PGM.                                         ECS090
  1485                                                                  ECS090
  1486     MOVE LOW-VALUE TO REIN-KEY.                                  ECS090
  1487                                                                  ECS090
  1488 0710-READ-REIN.                                                  ECS090
  1489     READ REIN-FILE AT END                                        ECS090
  1490         GO TO 0720-END-REIN.                                     ECS090
  1491                                                                  ECS090
  1492     IF REIN-FILE-STATUS NOT = '00'                               ECS090
  1493         MOVE REIN-FILE-STATUS                                    ECS090
  1494                                 TO WS-ABEND-FILE-STATUS          ECS090
  1495         MOVE 'REIN READ ERROR- '                                 ECS090
  1496                                 TO WS-ABEND-MESSAGE              ECS090
  1497         GO TO ABEND-PGM.                                         ECS090
  1498                                                                  ECS090
  1499     ADD +1 TO REIN-CTR.                                          ECS090
  1500     MOVE REIN-REC               TO BK-REIN.                      ECS090
  1501                                                                  ECS090
  1502     WRITE BK-REIN.                                               ECS090
  1503                                                                  ECS090
  1504     GO TO 0710-READ-REIN.                                        ECS090
  1505                                                                  ECS090
  1506 0720-END-REIN.                                                   ECS090
  1507     MOVE 'REINSURANCE TABLES'   TO P-DESC.                       ECS090
  1508     MOVE REIN-CTR               TO P-CTR.                        ECS090
  1509     MOVE 'FILE BACKED UP'       TO P-MSG.                        ECS090
  1510                                                                  ECS090
  1511     PERFORM 0100-PRT-RTN THRU 0199-EXIT.                         ECS090
  1512                                                                  ECS090
  1513     CLOSE REIN-FILE.                                             ECS090
  1514                                                                  ECS090
  1515     IF REIN-FILE-STATUS NOT = '00'                               ECS090
  1516         MOVE REIN-FILE-STATUS                                    ECS090
  1517                                 TO WS-ABEND-FILE-STATUS          ECS090
  1518         MOVE 'REIN CLOSE ERROR- '                                ECS090
  1519                                 TO WS-ABEND-MESSAGE              ECS090
  1520         GO TO ABEND-PGM.                                         ECS090
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  32
* ECS090.cbl
  1521                                                                  ECS090
  1522 0730-CLOSE-REIN.                                                 ECS090
  1523     CLOSE BKUP-REIN WITH NO REWIND.                              ECS090
  1524                                                                  ECS090
  1525 0799-EXIT.                                                       ECS090
  1526     EXIT.                                                        ECS090
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  33
* ECS090.cbl
  1528 0800-BACKUP-CTBL.                                                ECS090
  1529     OPEN OUTPUT BKUP-CTBL WITH NO REWIND.                        ECS090
  1530                                                                  ECS090
  1531     IF DTE-COM-TBL-USED = '1'                                    ECS090
  1532         MOVE LOW-VALUE          TO BK-CTBL                       ECS090
  1533         WRITE BK-CTBL                                            ECS090
  1534         MOVE +1                 TO P-CTR                         ECS090
  1535         MOVE 'COMPENSATION TABLES' TO P-DESC                     ECS090
  1536         MOVE 'ZERO FILE USED'   TO P-MSG                         ECS090
  1537         PERFORM 0100-PRT-RTN THRU 0199-EXIT                      ECS090
  1538         GO TO 0830-CLOSE-CTBL.                                   ECS090
  1539                                                                  ECS090
  1540     OPEN INPUT CTBL-FILE.                                        ECS090
  1541                                                                  ECS090
  1542     IF COMM-FILE-STATUS  = '00' OR '97'                          ECS090
  1543         NEXT SENTENCE                                            ECS090
  1544       ELSE                                                       ECS090
  1545         MOVE COMM-FILE-STATUS                                    ECS090
  1546                                 TO WS-ABEND-FILE-STATUS          ECS090
  1547         MOVE 'COMM OPEN ERROR- '                                 ECS090
  1548                                 TO WS-ABEND-MESSAGE              ECS090
  1549         GO TO ABEND-PGM.                                         ECS090
  1550                                                                  ECS090
  1551     MOVE LOW-VALUES             TO COMM-KEY.                     ECS090
  1552                                                                  ECS090
  1553 0810-READ-CTBL.                                                  ECS090
  1554     READ CTBL-FILE AT END                                        ECS090
  1555         GO TO 0820-END-CTBL.                                     ECS090
  1556                                                                  ECS090
  1557     IF COMM-FILE-STATUS NOT = '00'                               ECS090
  1558         MOVE COMM-FILE-STATUS                                    ECS090
  1559                                 TO WS-ABEND-FILE-STATUS          ECS090
  1560         MOVE 'COMM READ ERROR- '                                 ECS090
  1561                                 TO WS-ABEND-MESSAGE              ECS090
  1562         GO TO ABEND-PGM.                                         ECS090
  1563                                                                  ECS090
  1564     ADD +1 TO CTBL-CTR.                                          ECS090
  1565     MOVE CTBL-REC               TO BK-CTBL.                      ECS090
  1566                                                                  ECS090
  1567     WRITE BK-CTBL.                                               ECS090
  1568                                                                  ECS090
  1569     GO TO 0810-READ-CTBL.                                        ECS090
  1570                                                                  ECS090
  1571 0820-END-CTBL.                                                   ECS090
  1572     MOVE 'COMPENSATION TABLES'  TO P-DESC.                       ECS090
  1573     MOVE CTBL-CTR               TO P-CTR.                        ECS090
  1574     MOVE 'FILE BACKED UP'       TO P-MSG.                        ECS090
  1575                                                                  ECS090
  1576     PERFORM 0100-PRT-RTN THRU 0199-EXIT.                         ECS090
  1577                                                                  ECS090
  1578     CLOSE CTBL-FILE.                                             ECS090
  1579                                                                  ECS090
  1580     IF COMM-FILE-STATUS NOT = '00'                               ECS090
  1581         MOVE COMM-FILE-STATUS                                    ECS090
  1582                                 TO WS-ABEND-FILE-STATUS          ECS090
  1583         MOVE 'COMM CLOSE ERROR- '                                ECS090
  1584                                 TO WS-ABEND-MESSAGE              ECS090
  1585         GO TO ABEND-PGM.                                         ECS090
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  34
* ECS090.cbl
  1586                                                                  ECS090
  1587 0830-CLOSE-CTBL.                                                 ECS090
  1588     CLOSE BKUP-CTBL WITH NO REWIND.                              ECS090
  1589                                                                  ECS090
  1590 0899-EXIT.                                                       ECS090
  1591     EXIT.                                                        ECS090
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  35
* ECS090.cbl
  1593 0900-BACKUP-CRED.                                                ECS090
  1594     OPEN OUTPUT BKUP-CRED WITH NO REWIND.                        ECS090
  1595                                                                  ECS090
  1596     IF DTE-SYS-F-CLASIC-CREDIT NOT = '1'                         ECS090
  1597         MOVE 'CREDIT TRANS FILE'   TO P-DESC                     ECS090
  1598         MOVE +0                    TO P-CTR                      ECS090
  1599         MOVE 'NO CRED BACKUP'      TO P-MSG                      ECS090
  1600         PERFORM 0100-PRT-RTN THRU 0199-EXIT                      ECS090
  1601         GO TO 0930-CLOSE-CRED.                                   ECS090
  1602                                                                  ECS090
  1603     OPEN INPUT  CRED-FILE.                                       ECS090
  1604                                                                  ECS090
  1605 0910-READ-CRED.                                                  ECS090
  1606     READ CRED-FILE AT END                                        ECS090
  1607         GO TO 0920-END-CRED.                                     ECS090
  1608                                                                  ECS090
  1609     ADD +1 TO CRED-CTR.                                          ECS090
  1610     MOVE CRED-REC                  TO BK-CRED.                   ECS090
  1611                                                                  ECS090
  1612     WRITE BK-CRED.                                               ECS090
  1613                                                                  ECS090
  1614     GO TO 0910-READ-CRED.                                        ECS090
  1615                                                                  ECS090
  1616 0920-END-CRED.                                                   ECS090
  1617     MOVE 'CREDIT TRANS FILE'    TO P-DESC.                       ECS090
  1618     MOVE CRED-CTR               TO P-CTR.                        ECS090
  1619     MOVE 'FILE BACKED UP'       TO P-MSG.                        ECS090
  1620                                                                  ECS090
  1621     PERFORM 0100-PRT-RTN THRU 0199-EXIT.                         ECS090
  1622                                                                  ECS090
  1623     CLOSE CRED-FILE.                                             ECS090
  1624                                                                  ECS090
  1625 0930-CLOSE-CRED.                                                 ECS090
  1626     CLOSE BKUP-CRED WITH LOCK.                                   ECS090
  1627                                                                  ECS090
  1628 0999-EXIT.                                                       ECS090
  1629     EXIT.                                                        ECS090
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  36
* ECS090.cbl
  1631 1099-BACKUP-COMP.                                                ECS090
  1632     OPEN OUTPUT BKUP-COMP WITH NO REWIND.                        ECS090
  1633                                                                  ECS090
  1634     IF DTE-SYS-F-CLASIC-CREDIT NOT = '1'                         ECS090
  1635         MOVE 'COMP MASTER FILE' TO P-DESC                        ECS090
  1636         MOVE +0                 TO P-CTR                         ECS090
  1637         MOVE 'NO COMP BACKUP'   TO P-MSG                         ECS090
  1638         PERFORM 0100-PRT-RTN THRU 0199-EXIT                      ECS090
  1639         GO TO 0930-CLOSE-COMP.                                   ECS090
  1640                                                                  ECS090
  1641     OPEN INPUT  COMP-FILE.                                       ECS090
  1642                                                                  ECS090
  1643 0910-READ-COMP.                                                  ECS090
  1644     READ COMP-FILE AT END                                        ECS090
  1645         GO TO 0920-END-COMP.                                     ECS090
  1646                                                                  ECS090
  1647     ADD +1 TO COMP-CTR.                                          ECS090
  1648     MOVE COMP-MSTR-REC               TO BK-COMP.                 ECS090
  1649                                                                  ECS090
  1650     WRITE BK-COMP.                                               ECS090
  1651                                                                  ECS090
  1652     GO TO 0910-READ-COMP.                                        ECS090
  1653                                                                  ECS090
  1654 0920-END-COMP.                                                   ECS090
  1655     MOVE 'COMP MASTER FILE'     TO P-DESC.                       ECS090
  1656     MOVE COMP-CTR               TO P-CTR.                        ECS090
  1657     MOVE 'FILE BACKED UP'       TO P-MSG.                        ECS090
  1658                                                                  ECS090
  1659     PERFORM 0100-PRT-RTN THRU 0199-EXIT.                         ECS090
  1660                                                                  ECS090
  1661     CLOSE COMP-FILE.                                             ECS090
  1662                                                                  ECS090
  1663 0930-CLOSE-COMP.                                                 ECS090
  1664     CLOSE BKUP-COMP WITH LOCK.                                   ECS090
  1665                                                                  ECS090
  1666 1999-EXIT.                                                       ECS090
  1667     EXIT.                                                        ECS090
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  37
* ECS090.cbl
  1669 2000-END-JOB.                                                    ECS090
  1670     CLOSE PRNT-FILE.                                             ECS090
  1671     GOBACK.                                                      ECS090
  1672                                                                  ECS090
  1673 ABEND-PGM SECTION.                                               ECS090
* 1674                                   COPY ELCABEND.                 ECS090
  1675***************************************************************** 04/14/98
  1676*                                                               * ELCABEND
  1677*                            ELCABEND.                          *    LV003
  1678*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
  1679*                            VMOD 2.002                              CL**2
  1680*                                                               * ELCABEND
  1681*                THIS SECTION DISPLAYS THE NECESSARY MESSAGES   * ELCABEND
  1682*            AND THEN ABENDS.                                   * ELCABEND
  1683*                                                               * ELCABEND
  1684*  NO  CID  MODS  IN  COPYBOOK  ELCABEND                        * ELCABEND
  1685*                                                               * ELCABEND
  1686***************************************************************** ELCABEND
  1687*APS-010.                                                         ELCABEND
  1688     DISPLAY WS-ABEND-MESSAGE.                                    ELCABEND
  1689     DISPLAY WS-ABEND-MESSAGE UPON CONSOLE.                       ELCABEND
  1690                                                                  ELCABEND
  1691     IF WS-ABEND-FILE-STATUS NOT = ZERO                           ELCABEND
  1692         DISPLAY 'FILE STATUS = ' WS-ABEND-FILE-STATUS            ELCABEND
  1693         DISPLAY 'FILE STATUS = ' WS-ABEND-FILE-STATUS            ELCABEND
  1694                                 UPON CONSOLE.                    ELCABEND
  1695                                                                  ELCABEND
  1696     IF WS-RETURN-CODE NOT = ZERO                                 ELCABEND
  1697         DISPLAY 'RETURN CODE = '  WS-RETURN-CODE                 ELCABEND
  1698         DISPLAY 'RETURN CODE = '  WS-RETURN-CODE                 ELCABEND
  1699                                 UPON CONSOLE.                    ELCABEND
  1700                                                                  ELCABEND
  1701     DISPLAY 'PROGRAM WILL NOW ABEND **************'              ELCABEND
  1702     DISPLAY 'PROGRAM WILL NOW ABEND **************'              ELCABEND
  1703                                 UPON CONSOLE.                    ELCABEND
  1704                                                                  ELCABEND
  1705     DIVIDE WS-ZERO BY WS-ZERO GIVING WS-ZERO.                    ELCABEND
  1706     CALL 'ABORTME'.
  1707                                                                  ELCABEND
  1708 APS-EXIT.                                                        ELCABEND
  1709     EXIT.                                                        ELCABEND
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:       70412     Code:        7984
