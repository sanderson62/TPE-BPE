* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   1
* ECS072AS.cbl
* Options: int("ECS072AS.int") anim csi verbose NOBOUND PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("ECS072AS.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"ebmlsfile" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" NOCHECKDIV NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"32" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"ECS072AS.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST
*          "ECS072AS.lst" LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0"
*          NOMAPNAME NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT
*          NOMOVELENCHECK NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT
*          NONCHAR NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR NOSTICKY-LINKAGE
*          NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"2" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                ECS072AS.
     4*AUTHOR.     Pablo
     5*            Colleyville, TX.
     6*DATE-COMPILED.
     7
     8*SECURITY.   *****************************************************
     9*            *                                                   *
    10*            *   THIS PROGRAM IS THE PROPERTY OF CSO.            *
    11*            *                                                   *
    12*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
    13*            *   OF CSO         IS EXPRESSLY PROHIBITED WITHOUT  *
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   2
* ECS072AS.cbl
    14*            *   THE PRIOR WRITTEN PERMISSION OF CSO.            *
    15*            *                                                   *
    16*            *****************************************************
    17
    18*REMARKS. THIS PROGRAM REPORTS THE RATES JOURNAL FILE
    19
    20 ENVIRONMENT DIVISION.
    21
    22 INPUT-OUTPUT SECTION.
    23
    24 FILE-CONTROL.
    25
    26     SELECT RT-JOURNAL-IN    ASSIGN TO SYS010.
    27     SELECT PRINTX           ASSIGN TO SYS008.
    28     SELECT DISK-DATE        ASSIGN TO SYS019.
    29     SELECT SORT-WORK        ASSIGN TO SORTWK1.
    30     SELECT FICH             ASSIGN TO SYS020.
    31
    32 DATA DIVISION.
    33
    34 FILE SECTION.
    35
    36 FD  RT-JOURNAL-IN
    37     BLOCK CONTAINS 0 RECORDS
    38     RECORDING MODE F.
    39
    40 01  RT-JOURNAL-IN-REC.
    41     05  filler                  pic x(34).
    42     05  rt-jp-rest-of-rec       pic x(2000).
    43
    44 FD  PRINTX
*   45                                 COPY ELCPRTFD.
    46******************************************************************04/15/98
    47*                                                                *ELCPRTFD
    48*                                                                *ELCPRTFD
    49*                            ELCPRTFD.                           *   LV003
    50*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
    51*                            VMOD=2.006                          *ELCPRTFD
    52******************************************************************ELCPRTFD
    53     RECORDING MODE F                                             ELCPRTFD
    54     LABEL RECORDS OMITTED                                        ELCPRTFD
    55     BLOCK CONTAINS 0 RECORDS
    56     RECORD CONTAINS 133 CHARACTERS.                              ELCPRTFD
    57 01  PRT.                                                         ELCPRTFD
    58     12  P-CTL               PIC  X.                                 CL**2
    59     12  P-DATA              PIC  X(132).                         ELCPRTFD
    60******************************************************************ELCPRTFD
    61
    62 FD  FICH
*   63                                 COPY ELCFCHFD.
    64******************************************************************04/15/98
    65*                                                                *ELCFCHFD
    66*                            ELCFCHFD.                           *   LV003
    67*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
    68*                            VMOD=2.004                          *   CL**3
    69*                                                                *ELCFCHFD
    70******************************************************************ELCFCHFD
    71     BLOCK CONTAINS 0 RECORDS
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   3
* ECS072AS.cbl (/apps/prod/cid1p/copy/ELCFCHFD)
    72     RECORDING MODE F.                                            ELCFCHFD
    73                                                                  ELCFCHFD
    74 01  FICH-REC                            PIC   X(133).            ELCFCHFD
    75******************************************************************ELCFCHFD
    76
    77 FD  DISK-DATE
*   78                                 COPY ELCDTEFD.
    79******************************************************************04/15/98
    80*                                                                *ELCDTEFD
    81*                                                                *ELCDTEFD
    82*                            ELCDTEFD.                           *   LV002
    83*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
    84*                            VMOD=2.007                          *   CL**2
    85*                                                                *ELCDTEFD
    86******************************************************************ELCDTEFD
    87     BLOCK CONTAINS 0 RECORDS
    88     RECORDING MODE F.                                            ELCDTEFD
    89                                                                  ELCDTEFD
    90 01  DATE-DISK.                                                   ELCDTEFD
    91     12  DD-ID                       PIC  X(4).                   ELCDTEFD
    92     12  FILLER                      PIC  X(14).                  ELCDTEFD
    93     12  DD-CR1                      PIC  9.                      ELCDTEFD
    94     12  DD-CR1N                     PIC  X(30).                  ELCDTEFD
    95     12  DD-CR2                      PIC  9.                      ELCDTEFD
    96     12  DD-CR2N                     PIC  X(30).                  ELCDTEFD
    97     12  FILLER                      PIC  X(20).                  ELCDTEFD
    98                                                                  ELCDTEFD
    99 01  DATE-DISK-R.                                                 ELCDTEFD
   100     12  FILLER                      PIC  X(4).                   ELCDTEFD
   101     12  DD-ST           OCCURS 3 TIMES                           ELCDTEFD
   102                                     PIC  X(32).                  ELCDTEFD
   103                                                                  ELCDTEFD
   104 01  DATE-DISK-T.                                                 ELCDTEFD
   105     12  FILLER                      PIC  X(4).                   ELCDTEFD
   106     12  DD-TYPE         OCCURS 2 TIMES                           ELCDTEFD
   107                                     PIC  X(48).                  ELCDTEFD
   108                                                                  ELCDTEFD
   109 01  DATE-DISK-M.                                                 ELCDTEFD
   110     12  FILLER                      PIC  X(4).                   ELCDTEFD
   111     12  DD-MORT         OCCURS 2 TIMES                           ELCDTEFD
   112                                     PIC  X(48).                  ELCDTEFD
   113                                                                  ELCDTEFD
   114 01  DATE-DISK-P.                                                 ELCDTEFD
   115     12  DD-IDA                      PIC  XX.                     ELCDTEFD
   116     12  DD-IDX                      PIC  99.                     ELCDTEFD
   117     12  DD-DATA                     PIC  X(96).                  ELCDTEFD
   118     12  FILLER  REDEFINES DD-DATA.                               ELCDTEFD
   119         16  DD-PS-PIC   OCCURS 50 TIMES                          ELCDTEFD
   120                                     PIC  X.                      ELCDTEFD
   121         16  FILLER                  PIC  X(46).                  ELCDTEFD
   122     12  FILLER  REDEFINES DD-DATA.                               ELCDTEFD
   123         16  DD-PS-PICO  OCCURS 20 TIMES.                         ELCDTEFD
   124             20  DD-PS-PRT           PIC  X.                      ELCDTEFD
   125             20  DD-PS-FMT           PIC  X.                      ELCDTEFD
   126             20  DD-PS-PRC           PIC  X.                      ELCDTEFD
   127             20  DD-PS-TOT           PIC  X.                      ELCDTEFD
   128         16  FILLER                  PIC  X(16).                  ELCDTEFD
   129                                                                  ELCDTEFD
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   4
* ECS072AS.cbl (/apps/prod/cid1p/copy/ELCDTEFD)
   130 01  DATE-DISK-E.                                                 ELCDTEFD
   131     12  FILLER                      PIC  X(4).                   ELCDTEFD
   132     12  DD-EDIT         OCCURS 24 TIMES                          ELCDTEFD
   133                                     PIC  X(4).                   ELCDTEFD
   134                                                                  ELCDTEFD
   135 01  DATE-DISK-C.                                                 ELCDTEFD
   136     12  FILLER                      PIC  X(7).                   ELCDTEFD
   137     12  DD-CARR1-SECPAY-SW          PIC  X.
   138     12  DD-CARR1-UEP-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   139     12  DD-CARR1-R78-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   140     12  DD-CARR1-PRO-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   141     12  DD-CARR1                    PIC  X.                      ELCDTEFD
   142     12  DD-CARR1S                   PIC  XX.                     ELCDTEFD
   143     12  DD-CARR1N                   PIC  X(30).                  ELCDTEFD
   144     12  DD-CARR2                    PIC  X.                      ELCDTEFD
   145     12  DD-CARR2S                   PIC  XX.                     ELCDTEFD
   146     12  DD-CARR2N                   PIC  X(30).                  ELCDTEFD
   147     12  DD-CARR2-UEP-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   148     12  DD-CARR2-R78-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   149     12  DD-CARR2-PRO-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   150     12  DD-CARR2-SECPAY-SW          PIC  X.
   151     12  FILLER                      PIC  X(7).                   ELCDTEFD
   152                                                                  ELCDTEFD
   153 01  DATE-DISK-OPT.                                               ELCDTEFD
   154     12  FILLER                      PIC  X(04).                  ELCDTEFD
   155     12  DD-TLR-DATA.                                             ELCDTEFD
   156         16  DD-TLR                  OCCURS 32 TIMES              ELCDTEFD
   157                                     PIC  X(03).                  ELCDTEFD
   158     12  DD-STATE-DATA REDEFINES DD-TLR-DATA.                     ELCDTEFD
   159         16  DD-STATE-FLDS           OCCURS 16 TIMES              ELCDTEFD
   160                                     PIC  X(06).                  ELCDTEFD
   161     12  DD-CARR-DATA REDEFINES DD-TLR-DATA.                      ELCDTEFD
   162         16  DD-CARR-FLDS            OCCURS 13 TIMES              ELCDTEFD
   163                                     PIC  X(07).                  ELCDTEFD
   164         16  FILLER                  PIC  X(05).                  ELCDTEFD
   165     12  DD-MISC-DATA REDEFINES DD-TLR-DATA                       ELCDTEFD
   166                                     PIC  X(96).                  ELCDTEFD
   167******************************************************************ELCDTEFD
   168
   169 SD  SORT-WORK.
   170
   171 01  SORT-REC.
   172     05  sort-key.
   173         10  sk-date             pic 99999999.
   174         10  sk-state            pic xx.
   175         10  sk-class            pic xx.
   176         10  sk-dev              pic xxx.
   177         10  sk-ben-type         pic x.
   178         10  sk-ben-code         pic xx.
   179         10  sk-age              pic 99.
   180         10  sk-amt              pic 999999.
   181         10  sk-exp-dt           pic 99999999.
   182         10  sk-action           pic x.
   183         10  sk-time             pic 9(7).
   184     05  sort-user               pic x(4).
   185     05  sort-program            pic x(8).
   186     05  sort-rest-of-record     pic x(1965).
   187
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   5
* ECS072AS.cbl
   188 WORKING-STORAGE SECTION.
   189 01  LCP-ABND-CODE                 PIC S999 COMP VALUE +519.
   190 77  FILLER  PIC X(32) VALUE '********************************'.
   191 77  FILLER  PIC X(32) VALUE '    ECS072AS WORKING-STORAGE    '.
   192 77  FILLER  PIC X(32) VALUE '*****VMOD=2.001*****************'.
   193
   194 77  ACTR                        PIC S99     COMP.
   195 77  BCTR                        PIC S99     COMP.
   196 77  CTR                         PIC S999    COMP.
   197 77  CTS                         PIC S999    COMP.
   198 77  CTT                         PIC S999    COMP.
   199 77  WK-1                        PIC S999    COMP-3.
   200 77  X                           PIC X.
   201 77  T-FLD                       PIC S9(6)V9(5)  COMP-3.
   202 77  PAGER                       PIC S9(4)   VALUE +1.
   203 77  LINE-CNT                    PIC S9(4)   VALUE ZEROS.
   204 77  CTA                         PIC 9.
   205 77  MO-RTS                      PIC S999    COMP-3    VALUE +360.
   206 77  ws-records-processed        pic 9(5) value zeros.
   207 77  ws-recs-in                  pic 9(7) value zeros.
   208 77  ws-recs-rel                 pic 9(7) value zeros.
   209 77  ws-recs-ret                 pic 9(7) value zeros.
   210 77  ws-input-sw                 pic x value spaces.
   211     88  end-of-input                 value 'Y'.
   212 01  JOURNAL-RECORD.
   213     12  jp-date                 pic s9(5) comp-3.
   214     12  jp-time                 pic s9(7) comp-3.
   215     12  JP-USER-ID              PIC X(4).
   216     12  JP-FILE-ID              PIC X(8).
   217     12  JP-PROGRAM-ID           PIC X(8).
   218     12  JP-RECORD-TYPE          PIC X.
   219         88 JP-ADD                  VALUE 'A'.
   220         88 JP-BEFORE-CHANGE        VALUE 'B'.
   221         88 JP-AFTER-CHANGE         VALUE 'C'.
   222         88 JP-DELETE               VALUE 'D'.
   223         88 JP-GENERIC-DELETE       VALUE 'G'.
   224         88 JP-KEY-CHG-DELETE       VALUE 'K'.
   225         88 JP-KEY-CHG-ADD          VALUE 'N'.
   226     12  JP-GENERIC-KEY-LENGTH   PIC S9(4)   COMP.
   227     12  JP-RECORD-AREA          pic x(2000).
   228
   229 01  WS-ABEND.
   230     12  WS-RETURN-CODE          PIC S9(4)       VALUE ZERO.
   231     12  WS-ZERO                 PIC S9          VALUE ZERO.
   232     12  WS-ABEND-MESSAGE        PIC X(80)       VALUE SPACES.
   233     12  WS-ABEND-FILE-STATUS    PIC XX          VALUE ZERO.
   234
   235 01  PRINT-REC.
   236     05  print-key.
   237         10  pr-date             pic 99999999.
   238         10  pr-ccyymmdd redefines pr-date.
   239             15  pr-dt-ccyy      pic xxxx.
   240             15  pr-dt-mm        pic xx.
   241             15  pr-dt-dd        pic xx.
   242         10  pr-state            pic xx.
   243         10  pr-class            pic xx.
   244         10  pr-dev              pic xxx.
   245         10  pr-ben-type         pic x.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   6
* ECS072AS.cbl
   246         10  pr-ben-code         pic xx.
   247         10  pr-age              pic 99.
   248         10  pr-amt              pic 999999.
   249         10  pr-exp-dt           pic 99999999.
   250         10  pr-action           pic x.
   251         10  pr-time             pic 9(7).
   252     05  print-user              pic x(4).
   253     05  print-program           pic x(8).
   254     05  print-rest-of-record    pic x(2000).
   255
   256
   257 01  WS.
   258     12  PGM-SUB                 PIC S999    COMP    VALUE +072.
   259     12  RATE-FILE-STATUS        PIC XX          VALUE ZERO.
   260
*  261                                 COPY ERCRATE
*  262          replacing leading ==rt== by ==pv==
*  263          rate-record by prev-rate-record.
   264******************************************************************
   265*                                                                *
   266*                                                                *
   267*                            ERCRATE                             *
   268*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   269*                            VMOD=2.008                          *
   270*                                                                *
   271*   ONLINE CREDIT SYSTEM                                         *
   272*                                                                *
   273*   FILE DESCRIPTION = RATES MASTER FILE                         *
   274*                                                                *
   275*   FILE TYPE = VSAM,KSDS                                        *
   276*   RECORD SIZE = 1765  RECFORM = FIXED                          *
   277*                                                                *
   278*   BASE CLUSTER NAME = ERRATE                   RKP=2,LEN=28    *
   279*       ALTERNATE PATH = NONE                                    *
   280*                                                                *
   281*   LOG = NO                                                     *
   282*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
   283*                                                                *
   284******************************************************************
   285
   286 01  prev-rate-record.
   287     12  pv-RECORD-ID                      PIC XX.
   288         88  VALID-RT-ID                      VALUE 'RT'.
   289
   290     12  pv-CONTROL-PRIMARY.
   291         16  pv-COMPANY-CD                 PIC X.
   292         16  pv-STATE-CODE.
   293             20  pv-ST-CODE                PIC XX.
   294             20  pv-ST-CLASS               PIC XX.
   295             20  pv-ST-DEV                 PIC XXX.
   296         16  pv-L-AH-CODE.
   297             20  pv-L-AH                   PIC X.
   298             20  pv-LAH-NUM                PIC XX.
   299         16  pv-LIMITS.
   300             20  pv-HIGH-AGE               PIC 99.
   301             20  pv-HIGH-AMT               PIC 9(6).
   302             20  pv-FUTURE                 PIC XX.
   303             20  pv-SEX                    PIC X.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   7
* ECS072AS.cbl (/apps/prod/cid1p/copy/ERCRATE)
   304         16  pv-EXPIRY-DATE                PIC 9(11)  COMP-3.
   305
   306     12  pv-MAINT-INFORMATION.
   307         16  pv-LAST-MAINT-DT              PIC XX.
   308         16  pv-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
   309         16  pv-LAST-MAINT-USER            PIC X(4).
   310         16  FILLER                        PIC X(10).
   311
   312     12  pv-STRUCTURE-COMMENT              PIC X(50).
   313     12  pv-RATE-COMMENT                   PIC X(50).
   314
   315     12  CSL-RESERVED                      PIC X(10).
   316     12  FILLER                            PIC X(12).
   317
   318     12  pv-MAX-AGE                        PIC 99.
   319
   320     12  pv-LIFE-LIMS-FLDS.
   321         16  pv-LIFE-MORT-CODE             PIC X(4).
   322         16  pv-LIFE-EXCEPTIONS   OCCURS 8 TIMES.
   323             20  pv-L-EX-AGE               PIC 99.
   324             20  pv-L-EX-TERM              PIC S999       COMP-3.
   325             20  pv-L-EX-FACE              PIC S9(7)      COMP-3.
   326         16  FILLER                        PIC X(20).
   327
   328     12  pv-AH-LIMS-FLDS   REDEFINES   pv-LIFE-LIMS-FLDS.
   329         16  pv-AH-EXCEPTIONS   OCCURS 8 TIMES.
   330             20  pv-AH-AGE                 PIC 99.
   331             20  pv-AH-TERM                PIC S999       COMP-3.
   332             20  pv-AH-BEN-M               PIC S9(5)      COMP-3.
   333             20  pv-AH-BEN-F               PIC S9(7)      COMP-3.
   334
   335     12  pv-LIFE-RATES.
   336         16  pv-L-RATE  OCCURS 360 TIMES   PIC S99V9(5)   COMP-3.
   337
   338     12  pv-AH-RATES   REDEFINES   pv-LIFE-RATES.
   339         16  pv-AH-RATE  OCCURS 360 TIMES  PIC S99V9(5)   COMP-3.
   340
   341     12  pv-DAILY-RATE                     PIC S99V9(5)   COMP-3.
   342
   343     12  pv-DISCOUNT-OPTION                PIC X.
   344         88  pv-DO-NOT-USE                     VALUE ' '.
   345         88  pv-USE-DISCOUNT-FACTOR            VALUE '1'.
   346         88  pv-USE-APR-AS-DISCOUNT            VALUE '2'.
   347
   348     12  pv-DISCOUNT-RATE                  PIC S99V9(5)   COMP-3.
   349     12  pv-DISCOUNT-OB-RATE               PIC S99V9(5)   COMP-3.
   350
   351     12  pv-COMPOSITE-OPTION               PIC X.
   352         88  pv-NO-COMPOSITE                   VALUE ' '.
   353         88  pv-USE-COMPOSITE-RATE             VALUE '1'.
   354
   355     12  pv-COMPOSITE-RATE                 PIC S99V9(5)   COMP-3.
   356
   357     12  pv-POLICY-FEE                     PIC S9(3)V99   COMP-3.
   358     12  FILLER                            PIC X(13).
   359
   360     12  pv-TYPE-RATE                      PIC X.
   361         88  pv-IS-STND                        VALUE ' ' 'S'.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   8
* ECS072AS.cbl (/apps/prod/cid1p/copy/ERCRATE)
   362         88  pv-IS-OB                          VALUE 'O'.
   363
   364     12  pv-SRT-ALPHA                      PIC X.
   365
   366     12  pv-CONTROL-2.
   367         16  pvC-1                         PIC X(7).
   368         16  pvC-3                         PIC X(11).
   369         16  pvC-4                         PIC 9(11) COMP-3.
   370         16  pvC-2                         PIC X(3).
   371******************************************************************
   372
*  373                                 COPY ERCRATE.
   374******************************************************************01/20/90
   375*                                                                *ERCRATE
   376*                                                                *ERCRATE
   377*                            ERCRATE                             *   LV007
   378*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   379*                            VMOD=2.008                          *   CL**7
   380*                                                                *ERCRATE
   381*   ONLINE CREDIT SYSTEM                                         *ERCRATE
   382*                                                                *ERCRATE
   383*   FILE DESCRIPTION = RATES MASTER FILE                         *ERCRATE
   384*                                                                *ERCRATE
   385*   FILE TYPE = VSAM,KSDS                                        *ERCRATE
   386*   RECORD SIZE = 1765  RECFORM = FIXED                          *ERCRATE
   387*                                                                *ERCRATE
   388*   BASE CLUSTER NAME = ERRATE                   RKP=2,LEN=28    *ERCRATE
   389*       ALTERNATE PATH = NONE                                    *ERCRATE
   390*                                                                *ERCRATE
   391*   LOG = NO                                                     *ERCRATE
   392*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *ERCRATE
   393*                                                                *ERCRATE
   394******************************************************************ERCRATE
   395                                                                  ERCRATE
   396 01  RATE-RECORD.                                                 ERCRATE
   397     12  RT-RECORD-ID                      PIC XX.                ERCRATE
   398         88  VALID-RT-ID                      VALUE 'RT'.         ERCRATE
   399                                                                  ERCRATE
   400     12  RT-CONTROL-PRIMARY.                                      ERCRATE
   401         16  RT-COMPANY-CD                 PIC X.                 ERCRATE
   402         16  RT-STATE-CODE.                                       ERCRATE
   403             20  RT-ST-CODE                PIC XX.                ERCRATE
   404             20  RT-ST-CLASS               PIC XX.                ERCRATE
   405             20  RT-ST-DEV                 PIC XXX.               ERCRATE
   406         16  RT-L-AH-CODE.                                        ERCRATE
   407             20  RT-L-AH                   PIC X.                 ERCRATE
   408             20  RT-LAH-NUM                PIC XX.                   CL**3
   409         16  RT-LIMITS.                                           ERCRATE
   410             20  RT-HIGH-AGE               PIC 99.                ERCRATE
   411             20  RT-HIGH-AMT               PIC 9(6).              ERCRATE
   412             20  RT-FUTURE                 PIC XX.                ERCRATE
   413             20  RT-SEX                    PIC X.                 ERCRATE
   414         16  RT-EXPIRY-DATE                PIC 9(11)  COMP-3.     ERCRATE
   415                                                                  ERCRATE
   416     12  RT-MAINT-INFORMATION.                                    ERCRATE
   417         16  RT-LAST-MAINT-DT              PIC XX.                ERCRATE
   418         16  RT-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3. ERCRATE
   419         16  RT-LAST-MAINT-USER            PIC X(4).              ERCRATE
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   9
* ECS072AS.cbl (/apps/prod/cid1p/copy/ERCRATE)
   420         16  FILLER                        PIC X(10).             ERCRATE
   421                                                                  ERCRATE
   422     12  RT-STRUCTURE-COMMENT              PIC X(50).             ERCRATE
   423     12  RT-RATE-COMMENT                   PIC X(50).             ERCRATE
   424                                                                  ERCRATE
   425     12  CSL-RESERVED                      PIC X(10).                CL**7
   426     12  FILLER                            PIC X(12).                CL**7
   427                                                                  ERCRATE
   428     12  RT-MAX-AGE                        PIC 99.                ERCRATE
   429                                                                  ERCRATE
   430     12  RT-LIFE-LIMS-FLDS.                                       ERCRATE
   431         16  RT-LIFE-MORT-CODE             PIC X(4).              ERCRATE
   432         16  RT-LIFE-EXCEPTIONS   OCCURS 8 TIMES.                 ERCRATE
   433             20  RT-L-EX-AGE               PIC 99.                ERCRATE
   434             20  RT-L-EX-TERM              PIC S999       COMP-3. ERCRATE
   435             20  RT-L-EX-FACE              PIC S9(7)      COMP-3. ERCRATE
   436         16  FILLER                        PIC X(20).             ERCRATE
   437                                                                  ERCRATE
   438     12  RT-AH-LIMS-FLDS   REDEFINES   RT-LIFE-LIMS-FLDS.         ERCRATE
   439         16  RT-AH-EXCEPTIONS   OCCURS 8 TIMES.                   ERCRATE
   440             20  RT-AH-AGE                 PIC 99.                ERCRATE
   441             20  RT-AH-TERM                PIC S999       COMP-3. ERCRATE
   442             20  RT-AH-BEN-M               PIC S9(5)      COMP-3. ERCRATE
   443             20  RT-AH-BEN-F               PIC S9(7)      COMP-3. ERCRATE
   444                                                                  ERCRATE
   445     12  RT-LIFE-RATES.                                           ERCRATE
   446         16  RT-L-RATE  OCCURS 360 TIMES   PIC S99V9(5)   COMP-3. ERCRATE
   447                                                                  ERCRATE
   448     12  RT-AH-RATES   REDEFINES   RT-LIFE-RATES.                 ERCRATE
   449         16  RT-AH-RATE  OCCURS 360 TIMES  PIC S99V9(5)   COMP-3. ERCRATE
   450                                                                  ERCRATE
   451     12  RT-DAILY-RATE                     PIC S99V9(5)   COMP-3.    CL**2
   452                                                                     CL**2
   453     12  RT-DISCOUNT-OPTION                PIC X.                    CL**5
   454         88  RT-DO-NOT-USE                     VALUE ' '.            CL**5
   455         88  RT-USE-DISCOUNT-FACTOR            VALUE '1'.            CL**5
   456         88  RT-USE-APR-AS-DISCOUNT            VALUE '2'.            CL**5
   457                                                                     CL**5
   458     12  RT-DISCOUNT-RATE                  PIC S99V9(5)   COMP-3.    CL**5
   459     12  RT-DISCOUNT-OB-RATE               PIC S99V9(5)   COMP-3.    CL**5
   460                                                                     CL**5
   461     12  RT-COMPOSITE-OPTION               PIC X.                    CL**6
   462         88  RT-NO-COMPOSITE                   VALUE ' '.            CL**6
   463         88  RT-USE-COMPOSITE-RATE             VALUE '1'.            CL**6
   464                                                                     CL**6
   465     12  RT-COMPOSITE-RATE                 PIC S99V9(5)   COMP-3.    CL**6
   466                                                                     CL**6
   467     12  RT-POLICY-FEE                     PIC S9(3)V99   COMP-3.    CL**7
   468     12  FILLER                            PIC X(13).                CL**7
   469                                                                     CL**4
   470     12  RT-TYPE-RATE                      PIC X.                    CL**4
   471         88  RT-IS-STND                        VALUE ' ' 'S'.        CL**4
   472         88  RT-IS-OB                          VALUE 'O'.            CL**4
   473                                                                  ERCRATE
   474     12  RT-SRT-ALPHA                      PIC X.                 ERCRATE
   475                                                                  ERCRATE
   476     12  RT-CONTROL-2.                                            ERCRATE
   477         16  RTC-1                         PIC X(7).              ERCRATE
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  10
* ECS072AS.cbl (/apps/prod/cid1p/copy/ERCRATE)
   478         16  RTC-3                         PIC X(11).             ERCRATE
   479         16  RTC-4                         PIC 9(11) COMP-3.      ERCRATE
   480         16  RTC-2                         PIC X(3).              ERCRATE
   481******************************************************************ERCRATE
*  482                                 COPY ELCDTECX.
   483******************************************************************06/05/98
   484*                                                                *ELCDTECX
   485*                            ELCDTECX.                           *   LV005
   486*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
   487*                            VMOD=2.015                          *ELCDTECX
   488*                                                                *ELCDTECX
   489*      WORKING STORAGE COPY CODE FOR APPLICATIONS CALLING        *ELCDTECX
   490*      THE DATE CARD DISK FILE. ( READ ROUTINE = ELCDTERX,       *ELCDTECX
   491*      AND DISK FILE FD = ELCDTEFX)                              *ELCDTECX
   492*                                                                *ELCDTECX
   493******************************************************************ELCDTECX
   494******************************************************************
   495*                   C H A N G E   L O G
   496*
   497* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   498*-----------------------------------------------------------------
   499*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   500* EFFECTIVE    NUMBER
   501*-----------------------------------------------------------------
   502* 092602    2002091900008  PEMA  INCREASE NUMBER OF MAXIMUM
   503*                                  BENEFIT CODES FROM 300 TO 900
   504* 090803    2003080800002  PEMA  ADD CATEGORY FOR SUPER GAP
   505* 051304    2003080800002  SMVA  ADD REFUND METHOD
   506* 071714    2013100100002  PEMA  FIX CRIT PERIOD EDITS
   507******************************************************************
   508 01  DATE-CARD.                                                   ELCDTECX
   509     12  DATX-COD                    PIC  X(4).                   ELCDTECX
   510     12  RUN-DATE                    PIC  9(11)  COMP-3.          ELCDTECX
   511     12  ALPH-DATE                   PIC  X(18).                  ELCDTECX
   512     12  EP-DT                       PIC  9(11)  COMP-3.          ELCDTECX
   513     12  PEND-ACT-FILE               PIC  XX.                     ELCDTECX
   514     12  EP-SW                       PIC  X.                      ELCDTECX
   515         88  NO-EP-EXTRACTS          VALUE SPACE.                 ELCDTECX
   516     12  TAPE-BATCHES                PIC  X.                      ELCDTECX
   517         88  TP-PREL-BAL             VALUE '1'.                   ELCDTECX
   518     12  BIN-RUN-DATE                PIC  XX.                     ELCDTECX
   519     12  RUN-CENTURY.                                             ELCDTECX
   520         16 RUN-CENTURY-N            PIC  99.                        CL**4
   521     12  FILLER                      PIC  X.                         CL**4
   522     12  CLAS-MORT-OVRD              PIC  X(4).                   ELCDTECX
   523     12  FILLER                      PIC  XXX.                    ELCDTECX
   524     12  COMPANY-NAME                PIC  X(30).                  ELCDTECX
   525                                                                  ELCDTECX
   526 01  FILLER                          PIC  X(7)                       CL**6
   527                                          VALUE 'OPTIONS'.        ELCDTECX
   528 01  DATE-CARD-OPTIONS.                                           ELCDTECX
   529     12  DATE-OPTIONS-ID             PIC  X(4).                   ELCDTECX
   530     12  DTE-MIN-PREM                PIC  99V99.                  ELCDTECX
   531     12  DTE-LANGUAGE-IND            PIC  X.                      ELCDTECX
   532         88  DTE-LANGUAGE-IS-FR           VALUE 'F'.              ELCDTECX
   533         88  DTE-LANGUAGE-IS-ENG          VALUE 'E'.              ELCDTECX
   534     12  DTE-MIN-AGE                 PIC  99.                     ELCDTECX
   535     12  DTE-DEFAULT-AGE             PIC  99.                     ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  11
* ECS072AS.cbl (/apps/prod/cid1p/copy/ELCDTECX)
   536     12  FILLER                      PIC  X.                      ELCDTECX
   537     12  DTE-MAX-TERM                PIC  999.                    ELCDTECX
   538     12  DTE-COMP-VG                 PIC  X.                      ELCDTECX
   539     12  DTE-REM-TRM                 PIC  X.                      ELCDTECX
   540     12  DTE-PRM-CK                  PIC S99V99.                  ELCDTECX
   541     12  DTE-PRORATA                 PIC  X.                      ELCDTECX
   542     12  DTE-CLM-REJ                 PIC  X.                      ELCDTECX
   543     12  DTE-REF-REJ                 PIC  X.                      ELCDTECX
   544     12  DTE-COM-TBL-USED            PIC  X.                      ELCDTECX
   545     12  FILLER                      PIC  X.                      ELCDTECX
   546     12  DTE-QTR-CO                  PIC  X.                      ELCDTECX
   547     12  DTE-REF-CK                  PIC S99V99.                  ELCDTECX
   548     12  DTE-CLM-CK                  PIC S99V99.                  ELCDTECX
   549     12  DTE-CONV-DT                 PIC 9(11) COMP-3.               CL**2
   550     12  DTE-DEFAULT-SEX             PIC  X.                      ELCDTECX
   551     12  DTE-EPL-FORMAT              PIC  X.                      ELCDTECX
   552     12  FILLER                      PIC  X.                      ELCDTECX
   553     12  DTE-JT-AGE                  PIC  X.                      ELCDTECX
   554     12  DTE-KEY-BIRTH               PIC  X.                      ELCDTECX
   555     12  DTE-REINSURANCE             PIC  X.                      ELCDTECX
   556     12  DTE-CLAIM-SORT              PIC  X.                      ELCDTECX
   557     12  DTE-WRT-OFF                 PIC  S99V99.                 ELCDTECX
   558     12  DTE-R78                     PIC  X.                      ELCDTECX
   559     12  DTE-DLY-BILL                PIC  X.                      ELCDTECX
   560     12  DTE-ALT-MORT-CODE           PIC  X(4).                   ELCDTECX
   561     12  DTE-CLAIM-PAID-THRU-TO      PIC  X.                      ELCDTECX
   562     12  DTE-COMPENSATION-ACCESS     PIC  X.                      ELCDTECX
   563     12  DTE-MORTG-ACCESS-CNTL       PIC  X.                      ELCDTECX
   564     12  DTE-MP-ALT-MORT-CODE        PIC  X(4).                   ELCDTECX
   565     12  DTE-MORTALITY-AGE-CALC-METHOD                            ELCDTECX
   566                                     PIC  X.                      ELCDTECX
   567         88  DTE-USE-TABLE-ASSIGNED-METHOD VALUE '1'              ELCDTECX
   568                                                 ' '.             ELCDTECX
   569         88  DTE-USE-ALL-AGE-LAST          VALUE '2'.             ELCDTECX
   570         88  DTE-USE-ALL-AGE-NEAR          VALUE '3'.             ELCDTECX
   571     12  DTE-RESERVE-OPTION-SWITCH   PIC  X.                      ELCDTECX
   572         88  DTE-OPT-RESERVE-METHOD-AUTH       VALUE 'Y'.         ELCDTECX
   573         88  DTE-OPT-RESERVE-METHOD-UNAUTH     VALUE 'N' ' '.     ELCDTECX
   574     12  DTE-REM-TRM-CALC-OPTION     PIC  X.                      ELCDTECX
   575     12  DTE-EXPERIENCE-RETENTION-AGE                             ELCDTECX
   576                                     PIC  9.                         CL**4
   577     12  DTE-SYSTEM.                                              ELCDTECX
   578         16  DTE-SYS-A-CREDIT        PIC  X.                      ELCDTECX
   579         16  DTE-SYS-B-PEND-CLAIM    PIC  X.                      ELCDTECX
   580         16  DTE-SYS-C-CONFIRMATIONS PIC  X.                      ELCDTECX
   581         16  DTE-SYS-D-DEMAND-BILL   PIC  X.                      ELCDTECX
   582         16  DTE-SYS-E-CLASIC-CLAIMS PIC  X.                      ELCDTECX
   583         16  DTE-SYS-F-CLASIC-CREDIT PIC  X.                      ELCDTECX
   584         16  DTE-SYS-G-AR-USED       PIC  X.                      ELCDTECX
   585         16  DTE-SYS-H               PIC  X.                      ELCDTECX
   586         16  DTE-SYS-I               PIC  X.                      ELCDTECX
   587         16  DTE-SYS-J               PIC  X.                      ELCDTECX
   588         16  DTE-SYS-K               PIC  X.                      ELCDTECX
   589         16  DTE-SYS-L               PIC  X.                      ELCDTECX
   590         16  DTE-SYS-M               PIC  X.                      ELCDTECX
   591         16  DTE-SYS-N               PIC  X.                      ELCDTECX
   592         16  DTE-SYS-O               PIC  X.                      ELCDTECX
   593         16  DTE-SYS-P               PIC  X.                      ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  12
* ECS072AS.cbl (/apps/prod/cid1p/copy/ELCDTECX)
   594         16  DTE-SYS-Q               PIC  X.                      ELCDTECX
   595         16  DTE-SYS-R               PIC  X.                      ELCDTECX
   596         16  DTE-SYS-S               PIC  X.                      ELCDTECX
   597         16  DTE-SYS-T               PIC  X.                      ELCDTECX
   598         16  DTE-SYS-U               PIC  X.                      ELCDTECX
   599         16  DTE-SYS-V               PIC  X.                      ELCDTECX
   600         16  DTE-SYS-W               PIC  X.                      ELCDTECX
   601         16  DTE-SYS-X               PIC  X.                      ELCDTECX
   602         16  DTE-SYS-Y               PIC  X.                      ELCDTECX
   603         16  DTE-SYS-Z               PIC  X.                      ELCDTECX
   604     12  FILLER                      REDEFINES DTE-SYSTEM.        ELCDTECX
   605         16  DTE-SYS-CODE            OCCURS 26 TIMES              ELCDTECX
   606                                     PIC  X.                      ELCDTECX
   607     12  DTE-CLIENT                  PIC  XXX.                    ELCDTECX
   608                                                                  ELCDTECX
   609 01  CLASIC-SYSTEM-CODES.                                         ELCDTECX
   610     12  DTE-COLC-ID                 PIC  X(4).                   ELCDTECX
   611     12  DTE-CLASIC-COMPANY-CD       PIC  X.                      ELCDTECX
   612     12  DTE-CLASIC-COMPANY-NUMBER   PIC  999.                    ELCDTECX
   613*    12  DTE-CLASIC-CLAIM-ACCESS     PIC  X.                      ELCDTECX
   614     12  FILLER                      PIC  X.                      ELCDTECX
   615     12  CLASIC-REIN-MAINT           PIC  XX.                     ELCDTECX
   616     12  CLASIC-COMP-MAINT           PIC  XX.                     ELCDTECX
   617     12  CLASIC-ACCT-MAINT           PIC  XX.                     ELCDTECX
   618     12  CLASIC-CTBL-MAINT           PIC  XX.                     ELCDTECX
   619     12  CLASIC-RATE-MAINT           PIC  XX.                     ELCDTECX
   620     12  CLASIC-CREDIT-EOM-DT        PIC  XX.                     ELCDTECX
   621     12  CLASIC-CLAIMS-EOM-DT        PIC  XX.                     ELCDTECX
   622                                                                  ELCDTECX
   623     12  LIFE-OVERRIDE-L1            PIC  X.                      ELCDTECX
   624     12  LIFE-OVERRIDE-L2            PIC  XX.                     ELCDTECX
   625     12  LIFE-OVERRIDE-L6            PIC  X(6).                   ELCDTECX
   626     12  LIFE-OVERRIDE-L12           PIC  X(12).                  ELCDTECX
   627                                                                  ELCDTECX
   628     12  AH-OVERRIDE-L1              PIC  X.                      ELCDTECX
   629     12  AH-OVERRIDE-L2              PIC  XX.                     ELCDTECX
   630     12  AH-OVERRIDE-L6              PIC  X(6).                   ELCDTECX
   631     12  AH-OVERRIDE-L12             PIC  X(12).                  ELCDTECX
   632                                                                  ELCDTECX
   633     12  CLAS-REPORT-CD1-CAPTION     PIC  X(10).                  ELCDTECX
   634     12  CLAS-REPORT-CD2-CAPTION     PIC  X(10).                  ELCDTECX
   635                                                                  ELCDTECX
   636     12  CLASIC-MORTG-EOM-DT         PIC  XX.                     ELCDTECX
   637     12  CLASIC-AR-EOM-DT            PIC  XX.                     ELCDTECX
   638                                                                  ELCDTECX
   639     12  FILLER                      PIC  X(11)      VALUE SPACE. ELCDTECX
   640                                                                  ELCDTECX
   641 01  DATE-CARD-FACTORS.                                           ELCDTECX
   642     12  DATE-FACTOR-ID              PIC  X(4).                   ELCDTECX
   643     12  FAC-1                       PIC S999V9(5).               ELCDTECX
   644     12  FAC-2                       PIC S999V9(5).               ELCDTECX
   645     12  FAC-3                       PIC S999V9(5).               ELCDTECX
   646     12  FAC-4                       PIC S999V9(5).               ELCDTECX
   647     12  FAC-5                       PIC S999V9(5).               ELCDTECX
   648     12  FAC-6                       PIC S999V9(5).               ELCDTECX
   649                                                                  ELCDTECX
   650 01  FILLER                          PIC  X(12)                   ELCDTECX
   651                                          VALUE 'COMPANY NAME'.   ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  13
* ECS072AS.cbl (/apps/prod/cid1p/copy/ELCDTECX)
   652 01  COMPANY-NAME-TABLE.                                          ELCDTECX
   653     12  C-N-TBL                     OCCURS 6 TIMES.              ELCDTECX
   654         16  CNT-ID                  PIC  X.                      ELCDTECX
   655         16  CNT-NAME                PIC  X(30).                  ELCDTECX
   656                                                                  ELCDTECX
   657 01  FILLER                          PIC  X(11)                   ELCDTECX
   658                                          VALUE 'STATE NAMES'.    ELCDTECX
   659 01  STATE-NAMES.                                                 ELCDTECX
   660     12  STATE-NAME-FLD              OCCURS 75 TIMES.             ELCDTECX
   661         16  STATE-SUB               PIC  XX.                     ELCDTECX
   662         16  STATE-PIC1.                                          ELCDTECX
   663             20  STATE-ABBR          PIC  XX.                     ELCDTECX
   664             20  FILLER              PIC  XXX.                    ELCDTECX
   665             20  STATE-PIC           PIC  X(20).                  ELCDTECX
   666             20  STATE-CALL-EARN     PIC  X.                      ELCDTECX
   667             20  STATE-CALL-BREAK    PIC  X.                      ELCDTECX
   668             20  STATE-PRIM-FAC-DEV  PIC  XXX.                    ELCDTECX
   669                                                                  ELCDTECX
   670 01  FILLER                          PIC  X(13)                   ELCDTECX
   671                                          VALUE 'CARRIER NAMES'.  ELCDTECX
   672 01  CARRIER-NAMES.                                               ELCDTECX
   673     12  CARRIER-NAME-FLD            OCCURS 25 TIMES.             ELCDTECX
   674         16  CARRIER-SUB             PIC  X.                      ELCDTECX
   675         16  CARRIER-DOM-ST          PIC  XX.                     ELCDTECX
   676         16  CARRIER-PIC             PIC  X(30).                  ELCDTECX
   677         16  CARRIER-UEP-PCT         PIC  S9V9(4) COMP-3.            CL**6
   678         16  CARRIER-R78-PCT         PIC  S9V9(4) COMP-3.            CL**6
   679         16  CARRIER-PRO-PCT         PIC  S9V9(4) COMP-3.            CL**6
   680*        16  FILLER                  PIC  X.                      ELCDTECX
   681         16  CARRIER-SEC-PAY         PIC  X.
   682             88  SEC-PAY-CARRIER          VALUE 'Y'.
   683                                                                  ELCDTECX
   684 01  FILLER                          PIC  X(9)                       CL**6
   685                                          VALUE 'INS TYPES'.      ELCDTECX
   686 01  CLAS-INS-TYPES.                                              ELCDTECX
   687*    12 CLAS-ALL-TYPES               OCCURS 300 TIMES.            ELCDTECX
   688     12 CLAS-ALL-TYPES               OCCURS 900 TIMES.            ELCDTECX
   689         16  CLAS-I-BEN              PIC  XX.                     ELCDTECX
   690         16  CLAS-I-AB3.                                          ELCDTECX
   691             20  FILLER              PIC  X.                      ELCDTECX
   692             20  CLAS-I-AB2.                                      ELCDTECX
   693                 24  FILLER          PIC  X.                      ELCDTECX
   694                 24  CLAS-I-AB1      PIC  X.                      ELCDTECX
   695         16  CLAS-I-AB3-AH REDEFINES CLAS-I-AB3.                  ELCDTECX
   696             20  CLAS-EXCLUSION      PIC  XX.                        CL**4
   697             20  FILLER              PIC  X.                         CL**4
   698         16  CLAS-I-AB10.                                         ELCDTECX
   699             20  FILLER              PIC  X(9).                   ELCDTECX
   700             20  CLAS-I-REIN-YN      PIC  X.                      ELCDTECX
   701         16  CLAS-I-COMMENT          PIC  X(10).                  ELCDTECX
   702         16  CLAS-I-JOINT            PIC  X.                      ELCDTECX
   703         16  CLAS-I-RL-AH            PIC  X.                      ELCDTECX
   704         16  CLAS-I-CALC-TYPE.                                    ELCDTECX
   705             20  CLAS-I-BAL          PIC  X.                      ELCDTECX
   706         16  CLAS-I-EP               PIC  X.                      ELCDTECX
   707         16  CLAS-CO-BEN-I-G-CD      PIC  X.                      ELCDTECX
   708         16  CLAS-CO-REM-TERM-CALC   PIC  X.                      ELCDTECX
   709         16  CLAS-I-BEN-CATEGORY     PIC  X.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  14
* ECS072AS.cbl (/apps/prod/cid1p/copy/ELCDTECX)
   710         16  CLAS-I-REFUND-METHOD    PIC  X.
   711         16  CLAS-I-MAX-BENEFITS     PIC 99.
   712         16  FILLER                  PIC  XXX.
   713                                                                  ELCDTECX
   714 01  FILLER                          PIC  X(16)                   ELCDTECX
   715                                     VALUE 'MORTALITY TABLES'.    ELCDTECX
   716 01  CLAS-MORTALITY-CODES.                                        ELCDTECX
   717     12  CLAS-MORT-FLD               OCCURS 99 TIMES              ELCDTECX
   718                                     INDEXED BY CLAS-MORT-NDX.    ELCDTECX
   719         16  CLAS-MORT-CODE          PIC  X(4).                      CL**6
   720         16  CLAS-MORT-J-CODE        PIC  X.                         CL**5
   721         16  CLAS-MORT-J-FACT        PIC S9V9(4).                    CL**6
   722         16  CLAS-MORT-DESC.                                      ELCDTECX
   723             20  CLAS-RESERVE-ADJ    PIC  999.                       CL**6
   724             20  FILLER              PIC  XX.                        CL**5
   725             20  CLAS-YEAR           PIC  X(4).                      CL**6
   726             20  FILLER              PIC  X.                         CL**5
   727             20  CLAS-TABLE-TYPE     PIC  XXX.                       CL**6
   728             20  FILLER              PIC  X.                         CL**5
   729             20  CLAS-AGE-METHOD     PIC  XX.                        CL**5
   730             20  FILLER              PIC  X.                         CL**5
   731             20  CLAS-INTEREST       PIC  99.99.                     CL**5
   732             20  FILLER              PIC  X(5).                      CL**6
   733                                                                  ELCDTECX
   734 01  FILLER                          PIC  X(15)                   ELCDTECX
   735                                     VALUE 'BUSINESS TABLES'.     ELCDTECX
   736 01  CLAS-BUSINESS-CLASSES.                                       ELCDTECX
   737     12  CLAS-BUSC-FLD               OCCURS 50 TIMES.             ELCDTECX
   738         16  CLAS-BUSC-CODE          PIC  99.                     ELCDTECX
   739         16  CLAS-BUSC-GROUP         PIC  X.                      ELCDTECX
   740         16  CLAS-BUSC-DESC          PIC  X(19).                  ELCDTECX
   741         16  CLAS-BUSC-EXCL          PIC  X.                         CL**5
   742         16  FILLER                  PIC  X(4).                      CL**6
   743                                                                  ELCDTECX
   744 01  FILLER                          PIC  X(7)                       CL**6
   745                                     VALUE 'INDEXES'.             ELCDTECX
   746 01  CLAS-INDEX-TBL.                                              ELCDTECX
   747     12  CLAX-ID                     PIC  X(4).                   ELCDTECX
   748     12  CLAS-STARTC                 PIC S9(4) COMP.              ELCDTECX
   749     12  CLAS-MAXC                   PIC S9(4) COMP.              ELCDTECX
   750     12  CLAS-STARTL                 PIC S9(4) COMP.              ELCDTECX
   751     12  CLAS-MAXL                   PIC S9(4) COMP.              ELCDTECX
   752     12  CLAS-STARTA                 PIC S9(4) COMP.              ELCDTECX
   753     12  CLAS-MAXA                   PIC S9(4) COMP.              ELCDTECX
   754     12  CLAS-STARTM                 PIC S9(4) COMP.              ELCDTECX
   755     12  CLAS-MAXM                   PIC S9(4) COMP.              ELCDTECX
   756     12  CLAS-STARTB                 PIC S9(4) COMP.              ELCDTECX
   757     12  CLAS-MAXB                   PIC S9(4) COMP.              ELCDTECX
   758     12  CLAS-STARTS                 PIC S9(4) COMP.              ELCDTECX
   759     12  CLAS-MAXS                   PIC S9(4) COMP.              ELCDTECX
   760     12  CLAS-STARTE                 PIC S9(4) COMP.              ELCDTECX
   761     12  CLAS-MAXE                   PIC S9(4) COMP.              ELCDTECX
   762     12  CLAS-STARTCN                PIC S9(4) COMP.              ELCDTECX
   763     12  CLAS-MAXCN                  PIC S9(4) COMP.              ELCDTECX
   764                                                                  ELCDTECX
   765 01  CLAS-TYPE-MISC.                                              ELCDTECX
   766     12  CLAS-INDEXC                 PIC S9(4) COMP.              ELCDTECX
   767     12  CLAS-INDEXL                 PIC S9(4) COMP.              ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  15
* ECS072AS.cbl (/apps/prod/cid1p/copy/ELCDTECX)
   768     12  CLAS-INDEXA                 PIC S9(4) COMP.              ELCDTECX
   769     12  CLAS-INDEXM                 PIC S9(4) COMP.              ELCDTECX
   770     12  CLAS-INDEXB                 PIC S9(4) COMP.              ELCDTECX
   771     12  CLAS-INDEXS                 PIC S9(4) COMP.              ELCDTECX
   772     12  CLAS-INDEXE                 PIC S9(4) COMP.              ELCDTECX
   773     12  CLAS-INDEX                  PIC S9(4) COMP.              ELCDTECX
   774     12  CLAS-INDEXEN                PIC S9(4) COMP.              ELCDTECX
   775     12  CLAS-INDEXCN                PIC S9(4) COMP.              ELCDTECX
   776     12  CLAS-INDEXON                PIC S9(4) COMP.              ELCDTECX
   777                                                                  ELCDTECX
   778 01  FILLER                          PIC  X(13)                   ELCDTECX
   779                                     VALUE 'MISCELLANEOUS'.       ELCDTECX
   780 01  CLAS-MISC.                                                   ELCDTECX
   781     12  DTE-FICH                    PIC  X.                      ELCDTECX
   782         88  FICH-NO                 VALUE SPACE.                 ELCDTECX
   783         88  FICH-ONLY               VALUE '1'.                   ELCDTECX
   784         88  FICH-BOTH               VALUE '2'.                   ELCDTECX
   785     12  FICH-OPEN                   PIC  X.                      ELCDTECX
   786     12  REPT-OPEN                   PIC  X.                      ELCDTECX
   787     12  DTE-PGM-OPT                 PIC  9.                         CL**5
   788     12  DTE-PRT-OPT                 PIC  X.                      ELCDTECX
   789     12  DTE-FMT-OPT                 PIC  9.                      ELCDTECX
   790     12  DTE-PRC-OPT                 PIC  9.                      ELCDTECX
   791     12  DTE-TOT-OPT                 PIC  9.                      ELCDTECX
   792     12  CLAS-LOOK                   PIC  XX.                     ELCDTECX
   793     12  DTE-TOT-LINES               PIC S9(8)      COMP.         ELCDTECX
   794     12  STATE-L                     PIC  XX.                     ELCDTECX
   795     12  CLAS-CN                     PIC  99.                     ELCDTECX
   796     12  CLAS-CO                     PIC  99.                     ELCDTECX
   797     12  DTE-VSAM-FLAGS                              VALUE ZERO.  ELCDTECX
   798         16  DTE-F-1                 PIC  X.                      ELCDTECX
   799         16  DTE-F-2                 PIC  X.                      ELCDTECX
   800     12  DTE-ABEND-WORK.                                          ELCDTECX
   801         16  DTE-ABEND-CD-1          PIC  XX         VALUE SPACES.ELCDTECX
   802         16  DTE-ABEND-CD-2          PIC  XX         VALUE SPACES.ELCDTECX
   803                                                                  ELCDTECX
   804 01  FILLER                          PIC  X(12)                   ELCDTECX
   805                                     VALUE 'WORKING DATE'.        ELCDTECX
   806 01  WS-DATE-AND-TIME.                                            ELCDTECX
   807     12  WS-ACCEPT-DATE.                                          ELCDTECX
   808         16  WS-AD-YY                PIC  99.                     ELCDTECX
   809         16  WS-AD-MM                PIC  99.                     ELCDTECX
   810         16  WS-AD-DD                PIC  99.                     ELCDTECX
   811     12  WS-CURRENT-DATE.                                         ELCDTECX
   812         16  WS-CD-MM                PIC  99.                     ELCDTECX
   813         16  FILLER                  PIC  X          VALUE '/'.   ELCDTECX
   814         16  WS-CD-DD                PIC  99.                     ELCDTECX
   815         16  FILLER                  PIC  X          VALUE '/'.   ELCDTECX
   816         16  WS-CD-YY                PIC  99.                     ELCDTECX
   817     12  WS-TIME-OF-DAY.                                          ELCDTECX
   818         16  WS-TIME                 PIC  9(6).                   ELCDTECX
   819         16  WS-HUN-SEC              PIC  99.                     ELCDTECX
   820                                                                  ELCDTECX
   821 01  FILLER                          PIC  X(12)                   ELCDTECX
   822                                     VALUE 'CARRIER CLMS'.        ELCDTECX
   823 01  CARRIER-OPT-CLAIM-DATA.                                      ELCDTECX
   824     12  CARRIER-FLDS                OCCURS 25 TIMES.             ELCDTECX
   825         16  CARRIER-IBNR-SWITCH     PIC  X.                         CL**5
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  16
* ECS072AS.cbl (/apps/prod/cid1p/copy/ELCDTECX)
   826         16  CARRIER-IBNR-PERCENT    PIC S9V9(4) COMP-3.             CL**6
   827         16  CARRIER-CIDA-DISCOUNT   PIC S9V9(4) COMP-3.             CL**6
   828                                                                  ELCDTECX
   829 01  FILLER                          PIC  X(10)                   ELCDTECX
   830                                     VALUE 'STATE TLRS'.          ELCDTECX
   831 01  STATE-TARGET-LOSS-RATIOS.                                    ELCDTECX
   832     12  STATE-TLR-FLD               OCCURS 75 TIMES.             ELCDTECX
   833         16  STATE-TARGET-LOSS-RATIO PIC S9V9(4) COMP-3.             CL**6
   834         16  STATE-CALC-INTEREST     PIC S9V9(4) COMP-3.             CL**6
   835                                                                  ELCDTECX
   836 01  FILLER                          PIC  X(13)                   ELCDTECX
   837                                     VALUE 'BUSINESS TLRS'.       ELCDTECX
   838 01  BUSINESS-TRGT-LOSS-RATIO-MODS.                               ELCDTECX
   839     12  BUS-TLRM-FLD                OCCURS 99 TIMES.             ELCDTECX
   840         16  BUS-TRGT-LOSS-RATIO-MOD PIC S9V9(4) COMP-3.             CL**6
   841                                                                  ELCDTECX
   842 01  FILLER                          PIC  X(13)                   ELCDTECX
   843                                     VALUE 'MISC CLM DATA'.       ELCDTECX
   844 01  MISC-OPT-CLM-RSV-DATA.                                       ELCDTECX
   845     12  COMPANY-CALC-INTEREST       PIC S9V9(4) COMP-3.             CL**6
   846     12  COMPANY-CIDA-DISCOUNT       PIC S9V9(4) COMP-3.             CL**6
   847     12  COMPANY-CRDB-TABLE-SELECTION                             ELCDTECX
   848                                     PIC  X.                         CL**5
   849     12  COMPANY-IBNR-AH-FACTOR      PIC S9V9(4) COMP-3.             CL**6
   850     12  COMPANY-IBNR-LAG-MONTH      PIC S999    COMP-3.             CL**6
   851     12  COMPANY-IBNR-LIFE-FACTOR    PIC S9V9(4) COMP-3.             CL**6
   852     12  COMPANY-OPTION-START-DATE   PIC  XX.                        CL**5
   853     12  INDEXBS                     PIC S9(4)   COMP.               CL**6
   854     12  INDEXCA                     PIC S9(4)   COMP.               CL**6
   855     12  INDEXST                     PIC S9(4)   COMP.               CL**6
   856     12  FILLER                      PIC  X(75).                  ELCDTECX
   857******************************************************************ELCDTECX
   858*01  MISC-CARR-PCT-DATA.                                          00001521
   859*    12  DD-CARR1-UEP-PCT            PIC S9V9(4) COMP-3.          00001522
   860*    12  DD-CARR1-R78-PCT            PIC S9V9(4) COMP-3.          00001522
   861*    12  DD-CARR1-PRO-PCT            PIC S9V9(4) COMP-3.          00001522
   862*    12  DD-CARR2-UEP-PCT            PIC S9V9(4) COMP-3.          00001522
   863*    12  DD-CARR2-R78-PCT            PIC S9V9(4) COMP-3.          00001522
   864*    12  DD-CARR2-PRO-PCT            PIC S9V9(4) COMP-3.          00001522
   865******************************************************************ELCDTECX
*  866                                 COPY ELCDTEVR.
   867***************************************************************** 04/15/98
   868*                                                                *ELCDTEVR
   869*                                                                *ELCDTEVR
   870*                            ELCDTEVR.                           *   LV003
   871*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
   872*                            VMOD=2.001                          *   CL**2
   873*                                                                *ELCDTEVR
   874*   WORKING STORAGE FOR DATE VARIABLES CREATED                   *ELCDTEVR
   875*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCDTEVR
   876*                                                                *ELCDTEVR
   877******************************************************************ELCDTEVR
   878 01  WS-DATE-CARD-DATE.                                           ELCDTEVR
   879     05  WS-RUN-DATE.                                             ELCDTEVR
   880         10  FILLER                  PIC  9(03).                  ELCDTEVR
   881         10  RUN-CCYY                PIC  9(04).                  ELCDTEVR
   882         10  RUN-CCYR  REDEFINES  RUN-CCYY.                       ELCDTEVR
   883             15  RUN-CC              PIC  99.                     ELCDTEVR
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  17
* ECS072AS.cbl (/apps/prod/cid1p/copy/ELCDTEVR)
   884             15  RUN-YR              PIC  99.                     ELCDTEVR
   885         10  RUN-MO                  PIC  99.                     ELCDTEVR
   886         10  RUN-DA                  PIC  99.                     ELCDTEVR
   887     05  WS-RUN-DATE-N REDEFINES                                     CL**2
   888            WS-RUN-DATE              PIC 9(11).                      CL**2
   889     05  WS-EP-DT.                                                ELCDTEVR
   890         10  FILLER                  PIC  9(03).                  ELCDTEVR
   891         10  EP-CCYY                 PIC  9(04).                  ELCDTEVR
   892         10  EP-CCYR  REDEFINES  EP-CCYY.                         ELCDTEVR
   893             15  EP-CC               PIC  99.                     ELCDTEVR
   894             15  EP-YR               PIC  99.                     ELCDTEVR
   895         10  EP-MO                   PIC  99.                     ELCDTEVR
   896         10  EP-DA                   PIC  99.                     ELCDTEVR
   897     05  WS-EP-DT-N REDEFINES                                        CL**2
   898            WS-EP-DT                 PIC 9(11).                      CL**2
   899     05  WS-DTE-CONV-DT.                                             CL**4
   900         10  FILLER                  PIC  9(03).                     CL**4
   901         10  DTE-CONV-CCYY           PIC  9(04).                     CL**4
   902         10  DTE-CONV-CCYR  REDEFINES  DTE-CONV-CCYY.                CL**4
   903             15  DTE-CONV-CC         PIC  99.                        CL**4
   904             15  DTE-CONV-YR         PIC  99.                        CL**4
   905         10  DTE-CONV-MO             PIC  99.                        CL**4
   906         10  DTE-CONV-DA             PIC  99.                        CL**4
   907     05  WS-DTE-CONV-DT-N REDEFINES                                  CL**4
   908            WS-DTE-CONV-DT           PIC  9(11).                     CL**4
   909 01  WS-BALANCE-FORWARD-DATE.                                     ELCDTEVR
   910     05  WS-BF-LAST-ACTIVITY-DATE.                                ELCDTEVR
   911         10  FILLER                            PIC 999.           ELCDTEVR
   912         10  BF-ACT-CCYY                       PIC 9(04).         ELCDTEVR
   913         10  BF-ACT-CCYR  REDEFINES  BF-ACT-CCYY.                 ELCDTEVR
   914             15  BF-ACT-CC                     PIC 99.            ELCDTEVR
   915             15  BF-ACT-YEAR                   PIC 99.            ELCDTEVR
   916         10  BF-ACT-MONTH                      PIC 99.            ELCDTEVR
   917         10  BF-ACT-DAY                        PIC 99.            ELCDTEVR
   918     05  WS-BF-LAST-ACTIVITY-DATE-N REDEFINES                        CL**2
   919            WS-BF-LAST-ACTIVITY-DATE           PIC 9(11).            CL**2
   920     05  WS-BF-CURRENT-LAST-STMT-DT.                              ELCDTEVR
   921         10  FILLER                            PIC 999.           ELCDTEVR
   922         10  BF-CURRENT-LAST-STMT-CEN          PIC 99.            ELCDTEVR
   923         10  BF-CURRENT-LAST-STMT-YEAR         PIC 99.            ELCDTEVR
   924         10  BF-CURRENT-LAST-STMT-MONTH        PIC 99.            ELCDTEVR
   925         10  BF-CURRENT-LAST-STMT-DAY          PIC 99.            ELCDTEVR
   926     05  WS-BF-CURRENT-LAST-STMT-DT-N REDEFINES                      CL**2
   927            WS-BF-CURRENT-LAST-STMT-DT        PIC 9(11).             CL**2
   928 01  WS-ADD-CONF-TRANSACTIONS-DTE.                                ELCDTEVR
   929     05  WS-AC-CERT-EFF-DATE.                                     ELCDTEVR
   930         10  FILLER                            PIC 999.           ELCDTEVR
   931         10  AC-CERT-CCYY                      PIC 9(04).         ELCDTEVR
   932         10  AC-CERT-CCYR  REDEFINES  AC-CERT-CCYY.               ELCDTEVR
   933             15  AC-CERT-CC                    PIC 99.            ELCDTEVR
   934             15  AC-CERT-YR                    PIC 99.            ELCDTEVR
   935         10  AC-CERT-MO                        PIC 99.            ELCDTEVR
   936         10  AC-CERT-DA                        PIC 99.            ELCDTEVR
   937     05  WS-AC-CERT-EFF-DATE-N REDEFINES                             CL**2
   938            WS-AC-CERT-EFF-DATE                PIC 9(11).            CL**2
   939     05  WS-AC-LIFE-CANCEL-DATE.                                  ELCDTEVR
   940         10  FILLER                            PIC 999.           ELCDTEVR
   941         10  AC-LIFE-CANCEL-CCYY               PIC 9(04).         ELCDTEVR
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  18
* ECS072AS.cbl (/apps/prod/cid1p/copy/ELCDTEVR)
   942         10  AC-LIFE-CANCEL-CCYR REDEFINES AC-LIFE-CANCEL-CCYY.   ELCDTEVR
   943             15  AC-LIFE-CANCEL-CC             PIC 99.            ELCDTEVR
   944             15  AC-LIFE-CANCEL-YR             PIC 99.            ELCDTEVR
   945         10  AC-LIFE-CANCEL-MO                 PIC 99.            ELCDTEVR
   946         10  AC-LIFE-CANCEL-DA                 PIC 99.            ELCDTEVR
   947     05  WS-AC-LIFE-CANCEL-DATE-N REDEFINES                          CL**2
   948            WS-AC-LIFE-CANCEL-DATE             PIC 9(11).            CL**2
   949     05  WS-AC-AH-CANCEL-DATE.                                    ELCDTEVR
   950         10  FILLER                            PIC 999.           ELCDTEVR
   951         10  AC-AH-CANCEL-CCYY                 PIC 9(04).         ELCDTEVR
   952         10  AC-AH-CANCEL-CCYR  REDEFINES  AC-AH-CANCEL-CCYY.     ELCDTEVR
   953             15  AC-AH-CANCEL-CC               PIC 99.            ELCDTEVR
   954             15  AC-AH-CANCEL-YR               PIC 99.            ELCDTEVR
   955         10  AC-AH-CANCEL-MO                   PIC 99.            ELCDTEVR
   956         10  AC-AH-CANCEL-DA                   PIC 99.            ELCDTEVR
   957     05  WS-AC-AH-CANCEL-DATE-N REDEFINES                            CL**2
   958            WS-AC-AH-CANCEL-DATE               PIC 9(11).            CL**2
   959 01  WS-RATE-RECORD.                                              ELCDTEVR
   960         05  WS-RT-EXPIRY-DATE.                                   ELCDTEVR
   961             10  FILLER                        PIC 999.           ELCDTEVR
   962             10  RT-EXP-CCYY                   PIC 9(04).         ELCDTEVR
   963             10  RT-EXP-CCYR  REDEFINES  RT-EXP-CCYY.             ELCDTEVR
   964                 15  RT-EXP-CC                 PIC 99.            ELCDTEVR
   965                 15  RT-EXP-YR                 PIC 99.            ELCDTEVR
   966             10  RT-EXP-MO                     PIC 99.            ELCDTEVR
   967             10  RT-EXP-DA                     PIC 99.            ELCDTEVR
   968         05  WS-RT-EXPIRY-DATE-N REDEFINES                           CL**2
   969                WS-RT-EXPIRY-DATE              PIC 9(11).            CL**2
   970
   971 01  compare-keys.
   972     05  curr-key                pic x(34).
   973     05  curr-action             pic x.
   974     05  prev-key                pic x(34).
   975     05  prev-action             pic x.
   976
   977 01  data-line-0.
   978     12  filler                  pic x(16).
   979     12  DL0-COMMENT             PIC X(20).
   980     12  FILLER                  PIC X(5).
   981     12  DL0-USER                PIC X(4).
   982     12  FILLER                  PIC X(5).
   983     12  DL0-DATE                PIC X(10).
   984     12  FILLER                  PIC X(5).
   985     12  DL0-TIME                PIC 9(6).
   986     12  FILLER                  PIC X(5).
   987     12  DL0-PROGRAM             PIC X(8).
   988
   989 01  DATA-LINE-1.
   990     12  FILLER                  PIC X       VALUE SPACE.
   991     12  FILLER                  PIC X(6)    VALUE 'STATE '.
   992     12  DL-1AA                  PIC XX.
   993     12  FILLER                  PIC XXX     VALUE ' - '.
   994     12  DL-1A                   PIC X(30).
   995     12  FILLER                  PIC X(5)    VALUE SPACE.
   996     12  DL-1DTE                 PIC X(28).
   997     12  FILLER                  PIC X(5)    VALUE SPACES.
   998     12  DL-COMNT                PIC X(50).
   999
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  19
* ECS072AS.cbl
  1000 01  DATA-LINE-1A.
  1001     12  FILLER                  PIC X(11)   VALUE SPACES.
  1002     12  FILLER                  PIC X(8)    VALUE 'CLASS = '.
  1003     12  DL-CLASS                PIC XX.
  1004     12  FILLER                  PIC X(16)
  1005         VALUE '    DEVIATION = '.
  1006     12  DL-DEV                  PIC XXX.
  1007     12  FILLER                  PIC X(15)
  1008         VALUE '    HIGH AGE = '.
  1009     12  DL-HI-AGE               PIC XX.
  1010     12  FILLER                  PIC X(15)
  1011         VALUE '    HIGH AMT = '.
  1012     12  DL-HI-AMT               PIC 999999.
  1013
  1014 01  DATA-LINE-2.
  1015     12  FILLER                  PIC X(11)   VALUE '        *'.
  1016     12  DL-2-OVRD               PIC X(12).
  1017     12  DL-2A                   PIC XX.
  1018     12  FILLER                  PIC XXX     VALUE ' - '.
  1019     12  DL-2B                   PIC X(12).
  1020     12  FILLER                  PIC X(5)    VALUE SPACES.
  1021     12  DL-2A-COMNT             PIC X(50).
  1022
  1023 01  DATA-LINE-4.
  1024     12  FILLER                  PIC X(11)   VALUE SPACES.
  1025     12  DL-4-OVRD               PIC X(06).
  1026     12  FILLER      PIC X(11)
  1027         VALUE ' MORTALITY '.
  1028     12  FILLER                  PIC X(7)    VALUE 'CODE = '.
  1029     12  DL-4C                   PIC X(4)    VALUE SPACES.
  1030     12  FILLER                  PIC XXX     VALUE ' = '.
  1031     12  DL-4B                   PIC X(26).
  1032
  1033 01  DATA-LINE-4A.
  1034     12  FILLER                  PIC X(11)   VALUE SPACES.
  1035     12  FILLER      PIC X(22)
  1036         VALUE 'MAXIMUM ATTAINED AGE '.
  1037     12  DL-4AGE                 PIC Z9.
  1038
  1039 01  DATA-LINE-5.
  1040     12  FILLER                  PIC X(11)   VALUE SPACES.
  1041     12  FILLER      PIC X(29)
  1042         VALUE 'EXCEPTIONS     AGE'.
  1043     12  DL-5A               OCCURS 8.
  1044         16  DL-5B               PIC ZZ.
  1045         16  DL-5C               PIC X(8).
  1046
  1047 01  DATA-LINE-6.
  1048     12  FILLER                  PIC X(26)   VALUE SPACES.
  1049     12  FILLER                  PIC X(13)   VALUE 'TERM'.
  1050     12  DL-6A               OCCURS 8.
  1051         16  DL-6B               PIC ZZZ.
  1052         16  DL-6C               PIC X(7).
  1053
  1054 01  DATA-LINE-7.
  1055     12  FILLER                  PIC X(26)   VALUE SPACES.
  1056     12  FILLER                  PIC X(9)    VALUE 'FACE'.
  1057     12  DL-7A               OCCURS 8.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  20
* ECS072AS.cbl
  1058         16  DL-7B               PIC Z(7).
  1059         16  DL-7C               PIC X(3).
  1060
  1061 01  DATA-LINE-8.
  1062     12  FILLER                  PIC X(11)   VALUE SPACES.
  1063     12  DL-8-OVRD               PIC X(06).
  1064     12  FILLER                  PIC X(17)
  1065         VALUE ' RATES BY MONTHS'.
  1066
  1067 01  DATA-LINE-9.
  1068     12  FILLER                  PIC X(16)   VALUE SPACES.
  1069     12  FILLER                  PIC X(10)   VALUE '   1'.
  1070     12  FILLER                  PIC X(10)   VALUE '   2'.
  1071     12  FILLER                  PIC X(10)   VALUE '   3'.
  1072     12  FILLER                  PIC X(10)   VALUE '   4'.
  1073     12  FILLER                  PIC X(10)   VALUE '   5'.
  1074     12  FILLER                  PIC X(10)   VALUE '   6'.
  1075     12  FILLER                  PIC X(10)   VALUE '   7'.
  1076     12  FILLER                  PIC X(10)   VALUE '   8'.
  1077     12  FILLER                  PIC X(10)   VALUE '   9'.
  1078     12  FILLER                  PIC X(10)   VALUE '  10'.
  1079     12  FILLER                  PIC X(10)   VALUE '  11'.
  1080     12  FILLER                  PIC X(10)   VALUE '  12'.
  1081
  1082 01  DATA-LINE-10.
  1083     12  FILLER                  PIC X(5)    VALUE SPACES.
  1084     12  FILLER                  PIC X(4)    VALUE 'YEAR'.
  1085     12  DL-10A                  PIC ZZ9.
  1086     12  DL-10B              OCCURS 12.
  1087         16  DL-10C              PIC XX.
  1088         16  DL-10D              PIC ZZ.Z(5).
  1089     12  FILLER                  PIC XXXX    VALUE SPACES.
  1090
  1091 01  DATA-LINE-11.
  1092     12  FILLER                  PIC X(11)   VALUE '        *'.
  1093     12  DL-11-OVRD              PIC X(12).
  1094     12  FILLER                  PIC X(5)    VALUE 'TYPE'.
  1095     12  DL-11A                  PIC XX.
  1096     12  FILLER                  PIC XXX     VALUE ' - '.
  1097     12  DL-11B                  PIC X(12).
  1098     12  FILLER                  PIC X(5)    VALUE SPACES.
  1099     12  DL-11A-COMM             PIC X(50).
  1100
  1101 01  DATA-LINE-12.
  1102     12  FILLER                  PIC X(11)   VALUE SPACES.
  1103     12  FILLER                  PIC X(29)
  1104         VALUE 'EXCEPTIONS     AGE'.
  1105     12  DL-12A              OCCURS 8.
  1106         16  DL-12B              PIC ZZ.
  1107         16  DL-12C              PIC X(8).
  1108
  1109 01  DATA-LINE-12A.
  1110     12  FILLER                  PIC X(26)   VALUE SPACES.
  1111     12  FILLER                  PIC X(13)   VALUE 'TERM'.
  1112     12  DL-12A-TERM     OCCURS 8.
  1113         16  DL-12A-T            PIC ZZZ.
  1114         16  DL-12A-FIL          PIC X(7).
  1115
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  21
* ECS072AS.cbl
  1116
  1117 01  DATA-LINE-13.
  1118     12  FILLER                  PIC X(26)   VALUE SPACES.
  1119     12  FILLER                  PIC X(11)   VALUE 'BENEFIT'.
  1120     12  DL-13A              OCCURS 8.
  1121         16  DL-13B              PIC Z(5).
  1122         16  DL-13C              PIC X(5).
  1123
  1124 01  DATA-LINE-13A.
  1125     12  FILLER                  PIC X(26)   VALUE SPACES.
  1126     12  FILLER                  PIC X(9)    VALUE 'FACE'.
  1127     12  DL-13A-BENF     OCCURS 8 TIMES.
  1128         16  DL-13A-BF           PIC Z(7).
  1129         16  DL-13A-FIL          PIC X(3).
  1130
  1131 01  DATA-LINE-14.
  1132     12  FILLER                  PIC X(11)   VALUE SPACES.
  1133     12  DL-14-OVRD              PIC X(06).
  1134     12  FILLER                  PIC X(18)
  1135         VALUE ' RATES BY MONTHS'.
  1136
  1137 01  TRAILER-LINE.
  1138     12  FILLER                  PIC X(110) VALUE SPACES.
  1139     12  TRAILER-DESC            PIC X(12)  VALUE SPACES.
  1140     12  TRAILER-DETL            PIC X(8)   VALUE SPACES.
  1141
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  22
* ECS072AS.cbl
  1143 01  HEAD-1.
  1144     12  FILLER                  PIC X(45)   VALUE SPACES.
  1145     12  H1-OVRD-1               PIC X(12).
  1146     12  FILLER                  PIC X(05)   VALUE ' AND '.
  1147     12  H1-OVRD-2               PIC X(12).
  1148     12  FILLER                  PIC X(06)   VALUE ' RATES'.
  1149     12  FILLER                  PIC X(39)   VALUE SPACES.
  1150     12  FILLER                  PIC X(8)    VALUE 'ECS072 '.
  1151
  1152 01  HEAD-2.
  1153     12  FILLER                  PIC X(47)   VALUE SPACES.
  1154     12  H1-A                    PIC X(30).
  1155     12  FILLER                  PIC X(42)   VALUE SPACES.
  1156     12  H2-DATE                 PIC X(8).
  1157
  1158 01  HEAD-2A.
  1159     12  FILLER                  PIC X(53)   VALUE SPACES.
  1160     12  H2A-DATE                PIC X(18).
  1161     12  FILLER                  PIC X(48)   VALUE SPACES.
  1162     12  FILLER                  PIC X(5)    VALUE 'PAGE '.
  1163     12  DL-1D                   PIC ZZ,ZZ9.
  1164
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  23
* ECS072AS.cbl
  1166 01  ws-date.
  1167     05  ws-audit-report-dt      pic 9(8) value zeros.
  1168
  1169 01  ws-julian-rpt-dt            pic 9(5) value zeros.
  1170 01  PRETTY-DATE.
  1171     12  PRETTY-MO               PIC Z9.
  1172     12  FILLER                  PIC X       VALUE '-'.
  1173     12  PRETTY-DAY              PIC 99.
  1174     12  FILLER                  PIC X       VALUE '-'.
  1175     12  PRETTY-YR               PIC 99.
  1176
  1177 01  L1-CUR-DTE.
  1178     12  FILLER      PIC X(27)
  1179         VALUE 'THESE ARE THE CURRENT RATES'.
  1180
  1181 01  L1-DATER.
  1182     12  FILLER                  PIC X(20)
  1183         VALUE 'THESE RATES EXPIRED'.
  1184     12  L1D-FILL                PIC X(8).
  1185
* 1186                                 COPY ELCDATE.
  1187******************************************************************06/11/98
  1188*                                                                *ELCDATE
  1189*                                                                *ELCDATE
  1190*                            ELCDATE.                            *   LV023
  1191*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL*16
  1192*                            VMOD=2.003                           ELCDATE
  1193*                                                                *ELCDATE
  1194*                                                                *ELCDATE
  1195*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *ELCDATE
  1196*                 LENGTH = 200                                   *   CL*19
  1197******************************************************************ELCDATE
  1198                                                                  ELCDATE
  1199 01  DATE-CONVERSION-DATA.                                        ELCDATE
  1200     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.    CL*19
  1201     12  DC-OPTION-CODE                PIC X.                        CL*15
  1202         88  BIN-TO-GREG                VALUE ' '.                ELCDATE
  1203         88  ELAPSED-BETWEEN-BIN        VALUE '1'.                ELCDATE
  1204         88  EDIT-GREG-TO-BIN           VALUE '2'.                ELCDATE
  1205         88  YMD-GREG-TO-BIN            VALUE '3'.                ELCDATE
  1206         88  MDY-GREG-TO-BIN            VALUE '4'.                ELCDATE
  1207         88  JULIAN-TO-BIN              VALUE '5'.                ELCDATE
  1208         88  BIN-PLUS-ELAPSED           VALUE '6'.                ELCDATE
  1209         88  FIND-CENTURY               VALUE '7'.                   CL*22
  1210         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.                ELCDATE
  1211         88  EDIT-GREG-TO-BIN-3         VALUE '9'.                ELCDATE
  1212         88  YMD-GREG-TO-BIN-3          VALUE 'A'.                ELCDATE
  1213         88  MDY-GREG-TO-BIN-3          VALUE 'B'.                ELCDATE
  1214         88  JULIAN-TO-BIN-3            VALUE 'C'.                ELCDATE
  1215         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.                ELCDATE
  1216         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.                   CL*14
  1217         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.                   CL*14
  1218         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.                   CL*14
  1219         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.         CL*14
  1220         88  CHECK-LEAP-YEAR            VALUE 'H'.                   CL*14
  1221         88  BIN-3-TO-GREG              VALUE 'I'.                   CL*14
  1222         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.                   CL*14
  1223         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.                   CL*14
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  24
* ECS072AS.cbl (/apps/prod/cid1p/copy/ELCDATE)
  1224         88  CYMD-GREG-TO-BIN           VALUE 'L'.                   CL*14
  1225         88  MDCY-GREG-TO-BIN           VALUE 'M'.                   CL*14
  1226         88  MDY-GREG-TO-JULIAN         VALUE 'N'.                   CL*14
  1227         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.                   CL*14
  1228         88  YMD-GREG-TO-JULIAN         VALUE 'P'.                   CL*14
  1229         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.                   CL*14
  1230         88  THREE-CHARACTER-BIN                                  ELCDATE
  1231                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.       CL*14
  1232         88  GREGORIAN-TO-BIN                                        CL**2
  1233                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.    CL*14
  1234         88  BIN-TO-GREGORIAN                                        CL**2
  1235                  VALUES ' ' '1' 'I' '8' 'G'.                        CL*14
  1236         88  JULIAN-TO-BINARY                                        CL**2
  1237                  VALUES '5' 'C' 'E' 'F'.                            CL*14
  1238     12  DC-ERROR-CODE                 PIC X.                        CL*15
  1239         88  NO-CONVERSION-ERROR        VALUE ' '.                   CL**3
  1240         88  DATE-CONVERSION-ERROR                                ELCDATE
  1241                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.        CL*14
  1242         88  DATE-IS-ZERO               VALUE '1'.                ELCDATE
  1243         88  DATE-IS-NON-NUMERIC        VALUE '2'.                ELCDATE
  1244         88  DATE-IS-INVALID            VALUE '3'.                ELCDATE
  1245         88  DATE1-GREATER-DATE2        VALUE '4'.                ELCDATE
  1246         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.                ELCDATE
  1247         88  DATE-INVALID-OPTION        VALUE '9'.                ELCDATE
  1248         88  INVALID-CENTURY            VALUE 'A'.                ELCDATE
  1249         88  ONLY-CENTURY               VALUE 'B'.                ELCDATE
  1250         88  ONLY-LEAP-YEAR             VALUE 'C'.                ELCDATE
  1251         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.              CL**3
  1252     12  DC-END-OF-MONTH               PIC X.                        CL*15
  1253         88  CALCULATE-END-OF-MONTH     VALUE '1'.                ELCDATE
  1254     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.         CL*15
  1255         88  USE-NORMAL-PROCESS         VALUE ' '.                ELCDATE
  1256         88  ADJUST-DOWN-100-YRS        VALUE '1'.                ELCDATE
  1257         88  ADJUST-UP-100-YRS          VALUE '2'.                ELCDATE
  1258     12  FILLER                        PIC X.                        CL*15
  1259     12  DC-CONVERSION-DATES.                                        CL*15
  1260         16  DC-BIN-DATE-1             PIC XX.                       CL*15
  1261         16  DC-BIN-DATE-2             PIC XX.                       CL*15
  1262         16  DC-GREG-DATE-1-EDIT       PIC X(08).                    CL*15
  1263         16  DC-GREG-DATE-1-EDIT-R REDEFINES                         CL*15
  1264                       DC-GREG-DATE-1-EDIT.                       ELCDATE
  1265             20  DC-EDIT1-MONTH        PIC 99.                       CL*15
  1266             20  SLASH1-1              PIC X.                        CL*15
  1267             20  DC-EDIT1-DAY          PIC 99.                       CL*15
  1268             20  SLASH1-2              PIC X.                        CL*15
  1269             20  DC-EDIT1-YEAR         PIC 99.                       CL*15
  1270         16  DC-GREG-DATE-2-EDIT       PIC X(08).                    CL*15
  1271         16  DC-GREG-DATE-2-EDIT-R REDEFINES                         CL*15
  1272                     DC-GREG-DATE-2-EDIT.                         ELCDATE
  1273             20  DC-EDIT2-MONTH        PIC 99.                       CL*15
  1274             20  SLASH2-1              PIC X.                        CL*15
  1275             20  DC-EDIT2-DAY          PIC 99.                       CL*15
  1276             20  SLASH2-2              PIC X.                        CL*15
  1277             20  DC-EDIT2-YEAR         PIC 99.                       CL*15
  1278         16  DC-GREG-DATE-1-YMD        PIC 9(06).                    CL*15
  1279         16  DC-GREG-DATE-1-YMD-R  REDEFINES                         CL*15
  1280                     DC-GREG-DATE-1-YMD.                          ELCDATE
  1281             20  DC-YMD-YEAR           PIC 99.                       CL*15
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  25
* ECS072AS.cbl (/apps/prod/cid1p/copy/ELCDATE)
  1282             20  DC-YMD-MONTH          PIC 99.                       CL*15
  1283             20  DC-YMD-DAY            PIC 99.                       CL*15
  1284         16  DC-GREG-DATE-1-MDY        PIC 9(06).                    CL*15
  1285         16  DC-GREG-DATE-1-MDY-R REDEFINES                          CL*15
  1286                      DC-GREG-DATE-1-MDY.                         ELCDATE
  1287             20  DC-MDY-MONTH          PIC 99.                       CL*15
  1288             20  DC-MDY-DAY            PIC 99.                       CL*15
  1289             20  DC-MDY-YEAR           PIC 99.                       CL*15
  1290         16  DC-GREG-DATE-1-ALPHA.                                   CL*15
  1291             20  DC-ALPHA-MONTH        PIC X(10).                    CL*15
  1292             20  DC-ALPHA-DAY          PIC 99.                       CL*15
  1293             20  FILLER                PIC XX.                       CL*15
  1294             20  DC-ALPHA-CENTURY.                                   CL*15
  1295                 24 DC-ALPHA-CEN-N     PIC 99.                       CL*15
  1296             20  DC-ALPHA-YEAR         PIC 99.                       CL*15
  1297         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.           CL*15
  1298         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.           CL*15
  1299         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.           CL*15
  1300         16  DC-JULIAN-DATE            PIC 9(05).                    CL*15
  1301         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE                CL*20
  1302                                       PIC 9(05).                    CL*20
  1303         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.                  CL*15
  1304             20  DC-JULIAN-YEAR        PIC 99.                       CL*15
  1305             20  DC-JULIAN-DAYS        PIC 999.                      CL*15
  1306         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.       CL*15
  1307         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.    CL*15
  1308         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.    CL*15
  1309     12  DATE-CONVERSION-VARIBLES.                                   CL*15
  1310         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.            CL*15
  1311         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.          CL*15
  1312             20  FILLER                PIC 9(3).                     CL*15
  1313             20  HOLD-CEN-1-CCYY.                                    CL*15
  1314                 24  HOLD-CEN-1-CC     PIC 99.                       CL*17
  1315                 24  HOLD-CEN-1-YY     PIC 99.                       CL*17
  1316             20  HOLD-CEN-1-MO         PIC 99.                       CL*17
  1317             20  HOLD-CEN-1-DA         PIC 99.                       CL*17
  1318         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.            CL*15
  1319             20  HOLD-CEN-1-R-MO       PIC 99.                       CL*17
  1320             20  HOLD-CEN-1-R-DA       PIC 99.                       CL*17
  1321             20  HOLD-CEN-1-R-CCYY.                                  CL*15
  1322                 24  HOLD-CEN-1-R-CC   PIC 99.                       CL*17
  1323                 24  HOLD-CEN-1-R-YY   PIC 99.                       CL*17
  1324             20  FILLER                PIC 9(3).                     CL*15
  1325         16  HOLD-CENTURY-1-X.                                       CL*15
  1326             20  FILLER                PIC X(3)  VALUE SPACES.       CL*15
  1327             20  HOLD-CEN-1-X-CCYY.                                  CL*15
  1328                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.          CL*17
  1329                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.          CL*17
  1330             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.          CL*17
  1331             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.          CL*17
  1332         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.          CL*15
  1333             20  HOLD-CEN-1-R-X-MO     PIC XX.                       CL*17
  1334             20  HOLD-CEN-1-R-X-DA     PIC XX.                       CL*17
  1335             20  HOLD-CEN-1-R-X-CCYY.                                CL*15
  1336                 24  HOLD-CEN-1-R-X-CC PIC XX.                       CL*17
  1337                 24  HOLD-CEN-1-R-X-YY PIC XX.                       CL*17
  1338             20  FILLER                PIC XXX.                      CL*23
  1339         16  DC-BIN-DATE-EXPAND-1      PIC XXX.                      CL*15
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  26
* ECS072AS.cbl (/apps/prod/cid1p/copy/ELCDATE)
  1340         16  DC-BIN-DATE-EXPAND-2      PIC XXX.                      CL*15
  1341         16  DC-JULIAN-DATE-1          PIC 9(07).                    CL*15
  1342         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.          CL*15
  1343             20  DC-JULIAN-1-CCYY.                                   CL*15
  1344                 24  DC-JULIAN-1-CC    PIC 99.                       CL*15
  1345                 24  DC-JULIAN-1-YR    PIC 99.                       CL*15
  1346             20  DC-JULIAN-DA-1        PIC 999.                      CL*15
  1347         16  DC-JULIAN-DATE-2          PIC 9(07).                    CL*15
  1348         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.          CL*15
  1349             20  DC-JULIAN-2-CCYY.                                   CL*15
  1350                 24  DC-JULIAN-2-CC    PIC 99.                       CL*15
  1351                 24  DC-JULIAN-2-YR    PIC 99.                       CL*15
  1352             20  DC-JULIAN-DA-2        PIC 999.                      CL*15
  1353         16  DC-GREG-DATE-A-EDIT.                                    CL*15
  1354             20  DC-EDITA-MONTH        PIC 99.                       CL*15
  1355             20  SLASHA-1              PIC X VALUE '/'.              CL*15
  1356             20  DC-EDITA-DAY          PIC 99.                       CL*15
  1357             20  SLASHA-2              PIC X VALUE '/'.              CL*15
  1358             20  DC-EDITA-CCYY.                                      CL*15
  1359                 24  DC-EDITA-CENT     PIC 99.                       CL*15
  1360                 24  DC-EDITA-YEAR     PIC 99.                       CL*15
  1361         16  DC-GREG-DATE-B-EDIT.                                    CL*15
  1362             20  DC-EDITB-MONTH        PIC 99.                       CL*15
  1363             20  SLASHB-1              PIC X VALUE '/'.              CL*15
  1364             20  DC-EDITB-DAY          PIC 99.                       CL*15
  1365             20  SLASHB-2              PIC X VALUE '/'.              CL*15
  1366             20  DC-EDITB-CCYY.                                      CL*15
  1367                 24  DC-EDITB-CENT     PIC 99.                       CL*15
  1368                 24  DC-EDITB-YEAR     PIC 99.                       CL*15
  1369         16  DC-GREG-DATE-CYMD         PIC 9(08).                    CL*15
  1370         16  DC-GREG-DATE-CYMD-R REDEFINES                           CL*15
  1371                              DC-GREG-DATE-CYMD.                  ELCDATE
  1372             20  DC-CYMD-CEN           PIC 99.                       CL*15
  1373             20  DC-CYMD-YEAR          PIC 99.                       CL*15
  1374             20  DC-CYMD-MONTH         PIC 99.                       CL*15
  1375             20  DC-CYMD-DAY           PIC 99.                       CL*15
  1376         16  DC-GREG-DATE-MDCY         PIC 9(08).                    CL*15
  1377         16  DC-GREG-DATE-MDCY-R REDEFINES                           CL*15
  1378                              DC-GREG-DATE-MDCY.                  ELCDATE
  1379             20  DC-MDCY-MONTH         PIC 99.                       CL*15
  1380             20  DC-MDCY-DAY           PIC 99.                       CL*15
  1381             20  DC-MDCY-CEN           PIC 99.                       CL*15
  1382             20  DC-MDCY-YEAR          PIC 99.                       CL*15
  1383    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.      ELCDATE
  1384        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.        ELCDATE
  1385    12  DC-EL310-DATE                  PIC X(21).                    CL*26
  1386    12  FILLER                         PIC X(28).                    CL*26
  1387
  1388 LINKAGE SECTION.
  1389
  1390 01  PARM.
  1391     05  PARM-LENGTH BINARY  PICTURE IS S9(4).
  1392     05  PARM-VALUE  DISPLAY PICTURE IS X(8).
  1393
  1394 PROCEDURE DIVISION USING PARM.
  1395
* 1396                                 COPY ELCDTERX.
  1397******************************************************************04/15/98
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  27
* ECS072AS.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  1398*                                                                *ELCDTERX
  1399*                                                                *ELCDTERX
  1400*                            ELCDTERX.                           *   LV002
  1401*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  1402*                            VMOD=2.007                          *ELCDTERX
  1403*                                                                *ELCDTERX
  1404*      LOAD DATE CARD DISK FILE INTO WORKING STORAGE AREA        *ELCDTERX
  1405*      (COPY CODE FOR W/S = ELCDTECX AND COPY CODE FOR FD        *ELCDTERX
  1406*      = ELCDTEFD)                                               *ELCDTERX
  1407*                                                                *ELCDTERX
  1408******************************************************************ELCDTERX
  1409                                                                  ELCDTERX
  1410     ACCEPT WS-ACCEPT-DATE       FROM  DATE.                      ELCDTERX
  1411                                                                  ELCDTERX
  1412     MOVE WS-AD-YY               TO  WS-CD-YY.                    ELCDTERX
  1413     MOVE WS-AD-MM               TO  WS-CD-MM.                    ELCDTERX
  1414     MOVE WS-AD-DD               TO  WS-CD-DD.                    ELCDTERX
  1415                                                                  ELCDTERX
  1416     ACCEPT WS-TIME-OF-DAY       FROM  TIME.                      ELCDTERX
  1417                                                                  ELCDTERX
  1418******************************************************************ELCDTERX
  1419*    NOTE: THE FOLLOWING STATEMENT IS USED TO ELIMINATE COB II    ELCDTERX
  1420*          WARNING MESSAGES.                                      ELCDTERX
  1421******************************************************************ELCDTERX
  1422     IF WS-CD-YY = LOW-VALUES                                     ELCDTERX
  1423         COMPUTE PGM-SUB = PGM-SUB + 1.                           ELCDTERX
  1424                                                                  ELCDTERX
  1425     OPEN INPUT DISK-DATE.                                        ELCDTERX
  1426                                                                  ELCDTERX
  1427     MOVE SPACE TO DATE-CARD         CLAS-BUSINESS-CLASSES        ELCDTERX
  1428                   STATE-NAMES       CLAS-MORTALITY-CODES         ELCDTERX
  1429                   CLAS-INS-TYPES    COMPANY-NAME-TABLE           ELCDTERX
  1430                   DATE-CARD-OPTIONS DATE-CARD-FACTORS            ELCDTERX
  1431                   CLAX-ID           CLAS-MISC                    ELCDTERX
  1432                   CARRIER-NAMES     CLASIC-SYSTEM-CODES          ELCDTERX
  1433                   CARRIER-OPT-CLAIM-DATA                         ELCDTERX
  1434                   STATE-TARGET-LOSS-RATIOS                       ELCDTERX
  1435                   BUSINESS-TRGT-LOSS-RATIO-MODS                  ELCDTERX
  1436                   MISC-OPT-CLM-RSV-DATA.                         ELCDTERX
  1437                                                                  ELCDTERX
  1438     MOVE LOW-VALUES TO CLAS-INDEX-TBL CLAS-TYPE-MISC.            ELCDTERX
  1439                                                                  ELCDTERX
  1440     MOVE ZERO TO CLAS-CN DTE-TOT-LINES CLAS-CO                   ELCDTERX
  1441                  INDEXCA INDEXBS INDEXST.                        ELCDTERX
  1442                                                                  ELCDTERX
  1443     COMPUTE CLAS-CN = PGM-SUB / +50.                             ELCDTERX
  1444     COMPUTE CLAS-CO = PGM-SUB / +20.                             ELCDTERX
  1445     COMPUTE CLAS-INDEXEN = PGM-SUB - (CLAS-CN * +50).            ELCDTERX
  1446     COMPUTE CLAS-INDEXON = PGM-SUB - (CLAS-CO * +20).            ELCDTERX
  1447                                                                  ELCDTERX
  1448     IF CLAS-INDEXEN = ZERO                                       ELCDTERX
  1449         MOVE +50               TO CLAS-INDEXEN                   ELCDTERX
  1450     ELSE                                                         ELCDTERX
  1451         ADD +1                 TO CLAS-CN.                       ELCDTERX
  1452                                                                  ELCDTERX
  1453     IF CLAS-INDEXON = ZERO                                       ELCDTERX
  1454         MOVE +20               TO CLAS-INDEXON                   ELCDTERX
  1455     ELSE                                                         ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  28
* ECS072AS.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  1456         ADD +1                 TO CLAS-CO.                       ELCDTERX
  1457                                                                  ELCDTERX
  1458 0005-READ--CARD.                                                 ELCDTERX
  1459     READ DISK-DATE                                               ELCDTERX
  1460         AT END CLOSE DISK-DATE                                   ELCDTERX
  1461             GO TO 0060-READ--TEST.                               ELCDTERX
  1462                                                                  ELCDTERX
  1463     MOVE ZERO                   TO CLAS-INDEX.                   ELCDTERX
  1464                                                                  ELCDTERX
  1465     IF DD-ID = 'CLAS' OR 'LIFE' OR 'GLED'                        ELCDTERX
  1466         MOVE DATE-DISK          TO DATE-CARD                     ELCDTERX
  1467         MOVE RUN-DATE           TO WS-RUN-DATE-N                    CL**2
  1468         MOVE EP-DT              TO WS-EP-DT-N                       CL**2
  1469         GO TO 0005-READ--CARD.                                   ELCDTERX
  1470                                                                  ELCDTERX
  1471     IF DD-ID = 'CLAD'                                            ELCDTERX
  1472         MOVE DATE-DISK          TO DATE-CARD-OPTIONS             ELCDTERX
  1473         GO TO 0005-READ--CARD.                                   ELCDTERX
  1474                                                                  ELCDTERX
  1475     IF DD-ID = 'CLAX'                                            ELCDTERX
  1476         MOVE DATE-DISK          TO CLAS-INDEX-TBL                ELCDTERX
  1477         GO TO 0005-READ--CARD.                                   ELCDTERX
  1478                                                                  ELCDTERX
  1479     IF DD-ID = 'CLAF'                                            ELCDTERX
  1480         MOVE DATE-DISK          TO DATE-CARD-FACTORS             ELCDTERX
  1481         GO TO 0005-READ--CARD.                                   ELCDTERX
  1482                                                                  ELCDTERX
  1483     IF DD-ID = 'CLAC'                                            ELCDTERX
  1484         GO TO 0010-READ--CLAC.                                   ELCDTERX
  1485                                                                  ELCDTERX
  1486     IF DD-ID = 'CARR'                                            ELCDTERX
  1487         GO TO 0015-READ--CARR.                                   ELCDTERX
  1488                                                                  ELCDTERX
  1489     IF DD-ID = 'STAT'                                            ELCDTERX
  1490         GO TO 0020-READ--STAT.                                   ELCDTERX
  1491                                                                  ELCDTERX
  1492     IF DD-ID = 'BUSC'                                            ELCDTERX
  1493         GO TO 0025-READ--BUSC.                                   ELCDTERX
  1494                                                                  ELCDTERX
  1495     IF DD-ID = 'MORT'                                            ELCDTERX
  1496         GO TO 0030-READ--MORT.                                   ELCDTERX
  1497                                                                  ELCDTERX
  1498     IF DD-ID = 'CLAI'                                            ELCDTERX
  1499         GO TO 0040-READ--CLAI.                                   ELCDTERX
  1500                                                                  ELCDTERX
  1501     IF DD-ID = 'COLC'                                            ELCDTERX
  1502         GO TO 0065-READ--COLC.                                   ELCDTERX
  1503                                                                  ELCDTERX
  1504     IF DD-IDX NUMERIC AND                                        ELCDTERX
  1505        DD-IDA = 'CL'                                             ELCDTERX
  1506         GO TO 0035-READ--CLXX.                                   ELCDTERX
  1507                                                                  ELCDTERX
  1508     IF DD-IDX NUMERIC AND                                        ELCDTERX
  1509        DD-IDA = 'PO'                                             ELCDTERX
  1510         GO TO 0050-READ--POXX.                                   ELCDTERX
  1511                                                                  ELCDTERX
  1512     IF DD-ID = 'OPCA'                                            ELCDTERX
  1513         GO TO 0070-READ--OPCA.                                   ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  29
* ECS072AS.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  1514                                                                  ELCDTERX
  1515     IF DD-ID = 'OPST'                                            ELCDTERX
  1516         GO TO 0072-READ--OPST.                                   ELCDTERX
  1517                                                                  ELCDTERX
  1518     IF DD-ID = 'OPBS'                                            ELCDTERX
  1519         GO TO 0074-READ--OPBS.                                   ELCDTERX
  1520                                                                  ELCDTERX
  1521     IF DD-ID = 'OPMS'                                            ELCDTERX
  1522         MOVE DD-MISC-DATA       TO MISC-OPT-CLM-RSV-DATA.        ELCDTERX
  1523                                                                  ELCDTERX
  1524     GO TO 0005-READ--CARD.                                       ELCDTERX
  1525                                                                  ELCDTERX
  1526 0010-READ--CLAC.                                                 ELCDTERX
  1527     ADD 1                       TO CLAS-INDEXC.                  ELCDTERX
  1528     MOVE DD-CR1                 TO CNT-ID (CLAS-INDEXC).         ELCDTERX
  1529     MOVE DD-CR1N                TO CNT-NAME (CLAS-INDEXC).       ELCDTERX
  1530     ADD 1                       TO CLAS-INDEXC.                  ELCDTERX
  1531     MOVE DD-CR2                 TO CNT-ID (CLAS-INDEXC).         ELCDTERX
  1532     MOVE DD-CR2N                TO CNT-NAME (CLAS-INDEXC).       ELCDTERX
  1533     GO TO 0005-READ--CARD.                                       ELCDTERX
  1534                                                                  ELCDTERX
  1535 0015-READ--CARR.                                                 ELCDTERX
  1536     ADD 1  TO  CLAS-INDEXCN.                                     ELCDTERX
  1537     IF CLAS-INDEXCN LESS THAN +26                                ELCDTERX
  1538        MOVE DD-CARR1         TO CARRIER-SUB (CLAS-INDEXCN)
  1539        MOVE DD-CARR1S        TO CARRIER-DOM-ST (CLAS-INDEXCN)
  1540        MOVE DD-CARR1N        TO CARRIER-PIC (CLAS-INDEXCN)
  1541        MOVE DD-CARR1-UEP-PCT TO CARRIER-UEP-PCT (CLAS-INDEXCN)
  1542        MOVE DD-CARR1-R78-PCT TO CARRIER-R78-PCT (CLAS-INDEXCN)
  1543        MOVE DD-CARR1-PRO-PCT TO CARRIER-PRO-PCT (CLAS-INDEXCN)
  1544        MOVE DD-CARR1-SECPAY-SW
  1545                               TO CARRIER-SEC-PAY (CLAS-INDEXCN)
  1546     END-IF
  1547                                                                  ELCDTERX
  1548     ADD 1  TO  CLAS-INDEXCN.                                     ELCDTERX
  1549     IF CLAS-INDEXCN LESS THAN +26                                ELCDTERX
  1550        MOVE DD-CARR2         TO CARRIER-SUB (CLAS-INDEXCN)
  1551        MOVE DD-CARR2S        TO CARRIER-DOM-ST (CLAS-INDEXCN)
  1552        MOVE DD-CARR2N        TO CARRIER-PIC (CLAS-INDEXCN)
  1553        MOVE DD-CARR2-UEP-PCT TO CARRIER-UEP-PCT (CLAS-INDEXCN)
  1554        MOVE DD-CARR2-R78-PCT TO CARRIER-R78-PCT (CLAS-INDEXCN)
  1555        MOVE DD-CARR2-PRO-PCT TO CARRIER-PRO-PCT (CLAS-INDEXCN)
  1556        MOVE DD-CARR2-SECPAY-SW
  1557                              TO CARRIER-SEC-PAY (CLAS-INDEXCN)
  1558     END-IF
  1559                                                                  ELCDTERX
  1560                                                                  ELCDTERX
  1561     GO TO 0005-READ--CARD.                                       ELCDTERX
  1562                                                                  ELCDTERX
  1563 0020-READ--STAT.                                                 ELCDTERX
  1564     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  1565     IF CLAS-INDEX GREATER 3  OR                                  ELCDTERX
  1566        DD-ST (CLAS-INDEX) = SPACE                                ELCDTERX
  1567         GO TO 0005-READ--CARD.                                   ELCDTERX
  1568                                                                  ELCDTERX
  1569     ADD 1                       TO CLAS-INDEXS.                  ELCDTERX
  1570     MOVE DD-ST (CLAS-INDEX)     TO STATE-NAME-FLD (CLAS-INDEXS). ELCDTERX
  1571     GO TO 0020-READ--STAT.                                       ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  30
* ECS072AS.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  1572                                                                  ELCDTERX
  1573 0025-READ--BUSC.                                                 ELCDTERX
  1574     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  1575     IF CLAS-INDEX GREATER 3  OR                                  ELCDTERX
  1576        DD-ST (CLAS-INDEX) = SPACE                                ELCDTERX
  1577         GO TO 0005-READ--CARD.                                   ELCDTERX
  1578                                                                  ELCDTERX
  1579     ADD 1                       TO CLAS-INDEXB.                  ELCDTERX
  1580     MOVE DD-ST (CLAS-INDEX)     TO CLAS-BUSC-FLD (CLAS-INDEXB).  ELCDTERX
  1581     GO TO 0025-READ--BUSC.                                       ELCDTERX
  1582                                                                  ELCDTERX
  1583 0030-READ--MORT.                                                 ELCDTERX
  1584     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  1585     IF CLAS-INDEX GREATER 2  OR                                  ELCDTERX
  1586        DD-MORT (CLAS-INDEX) = SPACE                              ELCDTERX
  1587         GO TO 0005-READ--CARD.                                   ELCDTERX
  1588                                                                  ELCDTERX
  1589     ADD 1                       TO CLAS-INDEXM.                  ELCDTERX
  1590     MOVE DD-MORT (CLAS-INDEX)   TO CLAS-MORT-FLD (CLAS-INDEXM).  ELCDTERX
  1591     GO TO 0030-READ--MORT.                                       ELCDTERX
  1592                                                                  ELCDTERX
  1593 0035-READ--CLXX.                                                 ELCDTERX
  1594     IF DD-IDX NOT = CLAS-CN                                      ELCDTERX
  1595          GO TO 0005-READ--CARD.                                  ELCDTERX
  1596                                                                  ELCDTERX
  1597     IF DD-PS-PIC (CLAS-INDEXEN) = 'X'                            ELCDTERX
  1598         DISPLAY '***********************************************'ELCDTERX
  1599         DISPLAY 'PROGRAM ECS-', PGM-SUB, ' NOT SCHEDULED TO RUN' ELCDTERX
  1600         DISPLAY '***********************************************'ELCDTERX
  1601         GO TO 0055-READ--STOP.                                   ELCDTERX
  1602                                                                  ELCDTERX
  1603     IF DD-PS-PIC (CLAS-INDEXEN) NOT LESS 'A'  AND                ELCDTERX
  1604        DD-PS-PIC (CLAS-INDEXEN) NOT GREATER 'I'                  ELCDTERX
  1605         MOVE '1'                TO DTE-FICH.                     ELCDTERX
  1606                                                                  ELCDTERX
  1607     IF DD-PS-PIC (CLAS-INDEXEN) NOT LESS 'J'  AND                ELCDTERX
  1608        DD-PS-PIC (CLAS-INDEXEN) NOT GREATER 'R'                  ELCDTERX
  1609         MOVE '2'                TO DTE-FICH.                     ELCDTERX
  1610                                                                  ELCDTERX
  1611*    MOVE DD-PS-PIC (CLAS-INDEXEN) TO DTE-PGM-OPT.                ELCDTERX
  1612     GO TO 0005-READ--CARD.                                       ELCDTERX
  1613                                                                  ELCDTERX
  1614 0040-READ--CLAI.                                                 ELCDTERX
  1615     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  1616     IF CLAS-INDEX GREATER 2  OR                                  ELCDTERX
  1617        DD-TYPE (CLAS-INDEX) = SPACE                              ELCDTERX
  1618         GO TO 0005-READ--CARD.                                   ELCDTERX
  1619                                                                  ELCDTERX
  1620     ADD 1                       TO CLAS-INDEXA.                  ELCDTERX
  1621     MOVE DD-TYPE (CLAS-INDEX) TO CLAS-ALL-TYPES (CLAS-INDEXA).   ELCDTERX
  1622     GO TO 0040-READ--CLAI.                                       ELCDTERX
  1623                                                                  ELCDTERX
  1624 0045-READ--DUMP.                                                 ELCDTERX
  1625     MOVE +999 TO WS-RETURN-CODE                                  ELCDTERX
  1626     MOVE 'MISSING AND/OR INVALID CLAS DATE CARD'                 ELCDTERX
  1627                                 TO  WS-ABEND-MESSAGE             ELCDTERX
  1628     PERFORM ABEND-PGM.                                           ELCDTERX
  1629                                                                  ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  31
* ECS072AS.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  1630 0050-READ--POXX.                                                 ELCDTERX
  1631     IF DD-IDX NOT = CLAS-CO                                      ELCDTERX
  1632         GO TO 0005-READ--CARD.                                   ELCDTERX
  1633                                                                  ELCDTERX
  1634     IF DD-PS-PRC (CLAS-INDEXON) = 'X'                            ELCDTERX
  1635         DISPLAY '***********************************************'ELCDTERX
  1636         DISPLAY 'ECS - ', PGM-SUB, ' IS NOT SCHEDULED TO RUN'    ELCDTERX
  1637         DISPLAY '***********************************************'ELCDTERX
  1638         GO TO 0055-READ--STOP.                                   ELCDTERX
  1639                                                                  ELCDTERX
  1640     MOVE DD-PS-PRT (CLAS-INDEXON) TO DTE-PRT-OPT.                ELCDTERX
  1641     MOVE DD-PS-FMT (CLAS-INDEXON) TO DTE-FMT-OPT.                ELCDTERX
  1642     MOVE DD-PS-PRC (CLAS-INDEXON) TO DTE-PRC-OPT DTE-PGM-OPT.    ELCDTERX
  1643     MOVE DD-PS-TOT (CLAS-INDEXON) TO DTE-TOT-OPT.                ELCDTERX
  1644                                                                  ELCDTERX
  1645     IF DTE-PRT-OPT = 'B'                                         ELCDTERX
  1646         MOVE '2'                  TO DTE-FICH.                   ELCDTERX
  1647     IF DTE-PRT-OPT = 'F'                                         ELCDTERX
  1648         MOVE '1'                  TO DTE-FICH.                   ELCDTERX
  1649                                                                  ELCDTERX
  1650     GO TO 0005-READ--CARD.                                       ELCDTERX
  1651                                                                  ELCDTERX
  1652 0055-READ--STOP.                                                 ELCDTERX
  1653     GOBACK.                                                      ELCDTERX
  1654                                                                  ELCDTERX
  1655 0060-READ--TEST.                                                 ELCDTERX
  1656     IF DATX-COD        = SPACE  OR                               ELCDTERX
  1657        CLAX-ID         = SPACE  OR                               ELCDTERX
  1658        DATE-OPTIONS-ID = SPACE                                   ELCDTERX
  1659         GO TO 0045-READ--DUMP.                                   ELCDTERX
  1660                                                                  ELCDTERX
  1661     MOVE LOW-VALUE TO CLAS-TYPE-MISC.                            ELCDTERX
  1662     GO TO 0079-READ--EXIT.                                       ELCDTERX
  1663                                                                  ELCDTERX
  1664 0065-READ--COLC.                                                 ELCDTERX
  1665     MOVE DATE-DISK              TO CLASIC-SYSTEM-CODES.          ELCDTERX
  1666     GO TO 0005-READ--CARD.                                       ELCDTERX
  1667                                                                  ELCDTERX
  1668 0070-READ--OPCA.                                                 ELCDTERX
  1669                                                                  ELCDTERX
  1670     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  1671                                                                  ELCDTERX
  1672     IF  CLAS-INDEX GREATER 13                                    ELCDTERX
  1673             OR                                                   ELCDTERX
  1674         DD-CARR-FLDS (CLAS-INDEX) = SPACE                        ELCDTERX
  1675         GO TO 0005-READ--CARD.                                   ELCDTERX
  1676                                                                  ELCDTERX
  1677     ADD 1                       TO INDEXCA.                      ELCDTERX
  1678     MOVE DD-CARR-FLDS (CLAS-INDEX)                               ELCDTERX
  1679                                 TO CARRIER-FLDS (INDEXCA).       ELCDTERX
  1680     GO TO 0070-READ--OPCA.                                       ELCDTERX
  1681                                                                  ELCDTERX
  1682 0072-READ--OPST.                                                 ELCDTERX
  1683                                                                  ELCDTERX
  1684     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  1685                                                                  ELCDTERX
  1686     IF  CLAS-INDEX GREATER 16                                    ELCDTERX
  1687             OR                                                   ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  32
* ECS072AS.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  1688         DD-TLR (CLAS-INDEX) = SPACE                              ELCDTERX
  1689         GO TO 0005-READ--CARD.                                   ELCDTERX
  1690                                                                  ELCDTERX
  1691     ADD 1                       TO INDEXST.                      ELCDTERX
  1692     MOVE DD-STATE-FLDS (CLAS-INDEX)                              ELCDTERX
  1693                                 TO STATE-TLR-FLD (INDEXST).      ELCDTERX
  1694     GO TO 0072-READ--OPST.                                       ELCDTERX
  1695                                                                  ELCDTERX
  1696 0074-READ--OPBS.                                                 ELCDTERX
  1697                                                                  ELCDTERX
  1698     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  1699                                                                  ELCDTERX
  1700     IF  CLAS-INDEX GREATER 32                                    ELCDTERX
  1701             OR                                                   ELCDTERX
  1702         DD-TLR (CLAS-INDEX) = SPACE                              ELCDTERX
  1703         GO TO 0005-READ--CARD.                                   ELCDTERX
  1704                                                                  ELCDTERX
  1705     ADD 1                       TO INDEXBS.                      ELCDTERX
  1706     MOVE DD-TLR (CLAS-INDEX)    TO BUS-TLRM-FLD (INDEXBS).       ELCDTERX
  1707     GO TO 0074-READ--OPBS.                                       ELCDTERX
  1708                                                                  ELCDTERX
  1709 0079-READ--EXIT.                                                 ELCDTERX
  1710*    EXIT.                                                        ELCDTERX
  1711******************************************************************ELCDTERX
  1712
  1713     perform 0000-open-files     thru 0000-exit
  1714     perform 0010-init           thru 0010-exit
  1715
  1716     sort sort-work on ascending key sort-key
  1717        input procedure is  0100-sort-input
  1718                                 thru 0100-exit
  1719        output procedure is 0200-sort-output
  1720                                 thru 0200-exit
  1721     go to 0510-EOJ-CLOSER
  1722
  1723     goback
  1724
  1725     .
  1726 0000-OPEN-FILES.
  1727
  1728     OPEN INPUT RT-JOURNAL-IN
  1729         OUTPUT PRINTX
  1730     .
  1731 0000-exit.
  1732     exit.
  1733
  1734 0010-init.
  1735
  1736     move zeros                  to ws-date
  1737                                    ws-julian-rpt-dt
  1738
  1739     display ' parm length ' parm-length
  1740     display ' parm value ***' parm-value '***'
  1741     if parm-length > zeros
  1742        and parm-value numeric
  1743        move parm-value          to ws-date
  1744     end-if
  1745
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  33
* ECS072AS.cbl
  1746     if ws-date not = zeros
  1747        move ws-audit-report-dt  to dc-greg-date-cymd
  1748        move 'L'                 to dc-option-code
  1749        perform 8500-date-convert thru 8500-exit
  1750        if no-conversion-error
  1751           display ' julian date ***' dc-julian-date '***'
  1752           move dc-julian-date   to ws-julian-rpt-dt
  1753           display ' Report date override ' ws-julian-rpt-dt
  1754              ' ' ws-date (5:2) '/' ws-date (7:2) '/'
  1755              ws-date (1:4)
  1756        else
  1757           display ' bad date convert ' dc-error-code
  1758           move zeros            to ws-julian-rpt-dt
  1759        end-if
  1760     end-if
  1761
  1762     MOVE WS-CURRENT-DATE        TO H2-DATE
  1763     MOVE LOW-VALUES             TO RT-CONTROL-PRIMARY
  1764     MOVE DTE-CLASIC-COMPANY-CD  TO RT-COMPANY-CD
  1765
  1766     MOVE COMPANY-NAME           TO H1-A
  1767     MOVE ALPH-DATE              TO H2A-DATE
  1768     MOVE CLAS-STARTM            TO CLAS-INDEXM
  1769
  1770     perform varying ctr from +1 by +1 until ctr > 8
  1771        move spaces              to dl-5c (ctr)
  1772                                    dl-6c (ctr)
  1773                                    dl-7c (ctr)
  1774                                    dl-10c (ctr)
  1775                                    dl-12c (ctr)
  1776                                    dl-13c (ctr)
  1777    end-perform
  1778
  1779     perform varying ctr from +9 by +1 until ctr > 12
  1780        move spaces              to dl-10c (ctr)
  1781    end-perform
  1782
  1783     .
  1784 0010-exit.
  1785     exit.
  1786
  1787 0100-sort-input.
  1788
  1789     display ' **** begin sort input routine **** '
  1790     perform 0120-read-input     thru 0120-exit
  1791     perform 0110-process-input  thru 0110-exit until
  1792        end-of-input
  1793
  1794     display ' **** end of sort input routine **** '
  1795     display ' records released ' ws-recs-rel
  1796
  1797     .
  1798 0100-exit.
  1799     exit.
  1800
  1801 0110-process-input.
  1802
  1803     if rt-company-cd not = dte-clasic-company-cd
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  34
* ECS072AS.cbl
  1804        go to 0110-continue
  1805     end-if
  1806
  1807     if ws-julian-rpt-dt = zeros
  1808        continue
  1809     else
  1810        if jp-date not = ws-julian-rpt-dt
  1811           go to 0110-continue
  1812        end-if
  1813     end-if
  1814
  1815     move jp-date                to dc-julian-date
  1816     move '5'                    to dc-option-code
  1817     perform 8500-date-convert   thru 8500-exit
  1818     if no-conversion-error
  1819        move dc-greg-date-cymd   to sk-date
  1820     else
  1821        move zeros               to sk-date
  1822     end-if
  1823     move rt-st-code             to sk-state
  1824     move rt-st-class            to sk-class
  1825     move rt-st-dev              to sk-dev
  1826     move rt-l-ah                to sk-ben-type
  1827     move rt-lah-num             to sk-ben-code
  1828     move rt-high-age            to sk-age
  1829     move rt-high-amt            to sk-amt
  1830     move rt-expiry-date         to sk-exp-dt
  1831     move jp-record-type         to sk-action
  1832     move jp-time                to sk-time
  1833     move jp-user-id             to sort-user
  1834     move jp-program-id          to sort-program
  1835     move rate-record            to sort-rest-of-record
  1836     release sort-rec
  1837     add 1 to ws-recs-rel
  1838
  1839     .
  1840 0110-continue.
  1841
  1842     perform 0120-read-input     thru 0120-exit
  1843
  1844     .
  1845 0110-exit.
  1846     exit.
  1847
  1848 0120-READ-input.
  1849
  1850     READ RT-JOURNAL-IN AT END
  1851        set end-of-input         to true
  1852     END-READ
  1853
  1854     if not end-of-input
  1855        MOVE rt-jp-rest-of-rec   TO JOURNAL-RECORD
  1856        MOVE JP-RECORD-AREA      TO RATE-record
  1857        add 1 to ws-recs-in
  1858     end-if
  1859
* 1860                                 COPY ELCRTEM1.
  1861******************************************************************04/16/98
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  35
* ECS072AS.cbl (/apps/prod/cid1p/copy/ELCRTEM1)
  1862*                                                                *ELCRTEM1
  1863*                                                                *ELCRTEM1
  1864*                            ELCRTEM1                            *   LV002
  1865*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  1866*                            VMOD=2.001                          *ELCRTEM1
  1867*                                                                *ELCRTEM1
  1868*   COPY FILE VARIABLES TO WORKING STORAGE                       *ELCRTEM1
  1869*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCRTEM1
  1870*                                                                *ELCRTEM1
  1871******************************************************************ELCRTEM1
  1872     MOVE RT-EXPIRY-DATE    TO  WS-RT-EXPIRY-DATE-N.                 CL**2
  1873
  1874     .
  1875 0120-exit.
  1876     exit.
  1877
  1878 0200-sort-output.
  1879
  1880     display ' **** begin sort output routine **** '
  1881     move ' '                    to ws-input-sw
  1882     perform 0220-return-rec     thru 0220-exit
  1883     move curr-key               to prev-key
  1884     move curr-action            to prev-action
  1885     move sort-rec               to print-rec
  1886     perform 0210-process-output thru 0210-exit until
  1887        end-of-input
  1888
  1889     if ws-recs-ret not = zeros
  1890        perform 0215-key-change  thru 0215-exit
  1891     end-if
  1892
  1893     display ' **** end of sort output routine **** '
  1894     display ' records returned ' ws-recs-ret
  1895
  1896     .
  1897 0200-exit.
  1898     exit.
  1899
  1900 0210-process-output.
  1901
  1902     evaluate true
  1903        when curr-key not = prev-key
  1904           perform 0215-key-change
  1905                                 thru 0215-exit
  1906           move curr-key         to prev-key
  1907           move curr-action      to prev-action
  1908           move sort-rec         to print-rec
  1909        when curr-action not = prev-action
  1910           perform 0217-action-change
  1911                                 thru 0217-action-change
  1912           move sort-rec         to print-rec
  1913****  right here I want to use the oldest B (before) image to
  1914***   go on the report.
  1915        when prev-action = 'B'
  1916             and curr-action = 'B'
  1917             continue
  1918****  I want to use the newest C (after) image to
  1919***   go on the report.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  36
* ECS072AS.cbl
  1920        when other
  1921           move sort-rec         to print-rec
  1922     end-evaluate
  1923
  1924*    if curr-key not = prev-key
  1925*       perform 0215-key-change  thru 0215-exit
  1926*       move curr-key            to prev-key
  1927*       move curr-action         to prev-action
  1928*       move sort-rec            to print-rec
  1929*    else
  1930*      if curr-action not = prev-action
  1931*         perform 0217-action-change thru 0217-action-change
  1932*         move sort-rec          to print-rec
  1933*      else
  1934*         if prev-action = 'B'
  1935*            and curr-action = 'B'
  1936*            continue
  1937*         else
  1938*            move sort-rec       to print-rec
  1939*         end-if
  1940*      end-if
  1941*    end-if
  1942*
  1943*    move sort-rec               to print-rec
  1944
  1945     perform 0220-return-rec     thru 0220-exit
  1946
  1947     .
  1948 0210-exit.
  1949     exit.
  1950
  1951 0215-key-change.
  1952
  1953     evaluate true
  1954        when prev-action = 'C'
  1955           perform 1000-print-rpt thru 1000-exit
  1956*          we need to print the after image here
  1957        when prev-action = 'A'
  1958           perform 1000-print-rpt thru 1000-exit
  1959*          we need to print the add image here
  1960        when prev-action = 'D'
  1961           perform 1000-print-rpt thru 1000-exit
  1962*          we need to print the delete image here
  1963        when other
  1964           display ' something not thought out key chg '
  1965              prev-action
  1966     end-evaluate
  1967
  1968     .
  1969 0215-exit.
  1970     exit.
  1971
  1972 0217-action-change.
  1973
  1974     evaluate true
  1975        when (prev-action = 'A')
  1976           and (curr-action = 'B' OR 'C')
  1977           continue
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  37
* ECS072AS.cbl
  1978        when prev-action = 'B'
  1979           perform 1000-print-rpt thru 1000-exit
  1980*          WE NEED TO PRINT THE before image here
  1981           move curr-action      to prev-action
  1982        when other
  1983           display ' something not thought out - action chg '
  1984              prev-action
  1985     end-evaluate
  1986
  1987     .
  1988 0217-exit.
  1989     exit.
  1990
  1991 0220-return-rec.
  1992
  1993     return sort-work at end
  1994        set end-of-input         to true
  1995     end-return
  1996
  1997     if not end-of-input
  1998        move sort-key (1:34)     to curr-key
  1999        move sk-action           to curr-action
  2000        add 1                    to ws-recs-ret
  2001     end-if
  2002
  2003     .
  2004 0220-exit.
  2005     exit.
  2006
  2007 1000-print-rpt.
  2008
  2009     move print-rest-of-record   to rate-record
  2010     MOVE RT-ST-CODE             TO DL-1AA.
  2011     MOVE RT-ST-DEV              TO DL-DEV.
  2012     MOVE RT-STATE-CODE          TO STATE-L.
  2013
  2014     .
  2015 0160-LOOK-UP-STATE.
* 2016                             COPY ECSSTLOK.
  2017******************************************************************07/10/97
  2018*                                                                *ECSSTLOK
  2019*                            ECSSTLOK                            *   LV001
  2020*                            VMOD=2.001                         * ECSSTLOK
  2021*                                                                *ECSSTLOK
  2022*  NO  CID  MODS  IN  COPYBOOK  ECSSTLOK                         *ECSSTLOK
  2023*                                                                *ECSSTLOK
  2024******************************************************************ECSSTLOK
  2025 STATE--START.                                                    ECSSTLOK
  2026     MOVE ZERO TO CLAS-INDEXS.                                    ECSSTLOK
  2027                                                                  ECSSTLOK
  2028 STATE--LOOP.                                                     ECSSTLOK
  2029     ADD 1 TO CLAS-INDEXS.                                        ECSSTLOK
  2030     IF CLAS-INDEXS IS GREATER THAN CLAS-MAXS                     ECSSTLOK
  2031         MOVE SPACE TO STATE-L                                    ECSSTLOK
  2032         GO TO STATE--EXIT.                                       ECSSTLOK
  2033                                                                  ECSSTLOK
  2034     IF STATE-L NOT = STATE-SUB (CLAS-INDEXS)                     ECSSTLOK
  2035         GO TO STATE--LOOP.                                       ECSSTLOK
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  38
* ECS072AS.cbl (/apps/prod/cid1p/copy/ECSSTLOK)
  2036                                                                  ECSSTLOK
  2037 STATE--EXIT.                                                     ECSSTLOK
  2038     EXIT.
  2039******************************************************************ECSSTLOK
  2040
  2041     MOVE STATE-PIC (CLAS-INDEXS) TO DL-1A.
  2042
  2043     IF RT-EXP-DA = 99
  2044         MOVE L1-CUR-DTE         TO DL-1DTE
  2045     ELSE
  2046         MOVE RT-EXP-YR          TO PRETTY-YR
  2047         MOVE RT-EXP-MO          TO PRETTY-MO
  2048         MOVE RT-EXP-DA          TO PRETTY-DAY
  2049         MOVE PRETTY-DATE        TO L1D-FILL
  2050         MOVE L1-DATER           TO DL-1DTE.
  2051
  2052     MOVE PAGER                  TO DL-1D.
  2053     ADD 1 TO PAGER.
  2054     MOVE ZEROS                  TO LINE-CNT.
  2055     MOVE '1'                    TO X.
  2056     MOVE LIFE-OVERRIDE-L12      TO H1-OVRD-1.
  2057     MOVE   AH-OVERRIDE-L12      TO H1-OVRD-2.
  2058     MOVE HEAD-1                 TO P-DATA.
  2059     PERFORM 0260-PRT-RTN THRU 0270-PRT-RTN-EXIT.
  2060     MOVE HEAD-2                 TO P-DATA.
  2061     PERFORM 0260-PRT-RTN THRU 0270-PRT-RTN-EXIT.
  2062     MOVE HEAD-2A                TO P-DATA.
  2063     PERFORM 0260-PRT-RTN THRU 0270-PRT-RTN-EXIT.
  2064     MOVE '0'                    TO X.
  2065
  2066     move print-user             to dl0-user
  2067     move print-program          to dl0-program
  2068     move pr-time                to dl0-time
  2069
  2070     string pr-dt-mm '/' pr-dt-dd '/' pr-dt-ccyy
  2071        delimited by size into dl0-date
  2072     end-string
  2073*    move pr-date                to dl0-date
  2074*                                   dc-julian-date
  2075*    move '5'                    to dc-option-code
  2076*    perform 8500-date-convert   thru 8500-exit
  2077*    if no-conversion-error
  2078*       move dc-greg-date-a-edit to dl0-date
  2079*    else
  2080*       move 'xx/xx/xxxx'        to dl0-date
  2081*    end-if
  2082     evaluate prev-action
  2083        when 'A'
  2084           MOVE 'NEW RECORD IMAGE'
  2085                                 TO DL0-COMMENT
  2086        WHEN 'B'
  2087           MOVE 'BEFORE IMAGE'   TO DL0-COMMENT
  2088        WHEN 'C'
  2089           MOVE 'AFTER IMAGE'    TO DL0-COMMENT
  2090        WHEN 'D'
  2091           MOVE 'DELETED IMAGE'  TO DL0-COMMENT
  2092        WHEN OTHER
  2093           MOVE 'UNIDENTIFIED'   TO DL0-COMMENT
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  39
* ECS072AS.cbl
  2094     end-evaluate
  2095
  2096     move data-line-0            to p-data
  2097     perform 0260-prt-rtn        thru 0270-prt-rtn-exit
  2098
  2099     MOVE RT-ST-CLASS            TO DL-CLASS.
  2100     MOVE RT-HIGH-AGE            TO DL-HI-AGE.
  2101     MOVE RT-HIGH-AMT            TO DL-HI-AMT
  2102     MOVE RT-STRUCTURE-COMMENT   TO DL-COMNT.
  2103
  2104     MOVE DATA-LINE-1            TO P-DATA.
  2105     PERFORM 0260-PRT-RTN THRU 0270-PRT-RTN-EXIT.
  2106     MOVE DATA-LINE-1A           TO P-DATA.
  2107     PERFORM 0260-PRT-RTN THRU 0270-PRT-RTN-EXIT.
  2108     MOVE '0'                    TO X.
  2109     IF RT-L-AH NOT = 'L'
  2110         GO TO 0220-DOING-A-AND-H.
  2111
  2112 0170-PRINT-THIS-LIFE.
  2113
  2114     MOVE RT-LAH-NUM             TO DL-2A.
  2115     MOVE LIFE-OVERRIDE-L12      TO DL-2-OVRD.
  2116     PERFORM 0440-FIND-L-NAME THRU 0460-E-F-L-NAME.
  2117     MOVE RT-RATE-COMMENT        TO DL-2A-COMNT.
  2118     MOVE DATA-LINE-2            TO P-DATA.
  2119     PERFORM 0260-PRT-RTN THRU 0270-PRT-RTN-EXIT.
  2120     MOVE SPACES                 TO DL-4B.
  2121
  2122     IF RT-LIFE-MORT-CODE NOT = CLAS-MORT-CODE (CLAS-INDEXM)
  2123         MOVE CLAS-STARTM        TO CLAS-INDEXM.
  2124
  2125 0180-MORT-DESC-LOOP.
  2126
  2127     IF RT-LIFE-MORT-CODE = CLAS-MORT-CODE (CLAS-INDEXM)
  2128         MOVE CLAS-MORT-DESC (CLAS-INDEXM) TO DL-4B
  2129     ELSE
  2130         ADD +1 TO CLAS-INDEXM
  2131         IF CLAS-INDEXM NOT GREATER THAN CLAS-MAXM
  2132             GO TO 0180-MORT-DESC-LOOP.
  2133
  2134     MOVE LIFE-OVERRIDE-L6       TO DL-4-OVRD.
  2135     MOVE RT-LIFE-MORT-CODE      TO DL-4C.
  2136     MOVE DATA-LINE-4            TO P-DATA.
  2137     PERFORM 0260-PRT-RTN THRU 0270-PRT-RTN-EXIT.
  2138     MOVE RT-MAX-AGE             TO DL-4AGE.
  2139     MOVE DATA-LINE-4A           TO P-DATA.
  2140     PERFORM 0260-PRT-RTN THRU 0270-PRT-RTN-EXIT.
  2141     MOVE 1                      TO CTS.
  2142     PERFORM 0320-L-X-AGE 8 TIMES.
  2143     MOVE DATA-LINE-5            TO P-DATA.
  2144     PERFORM 0260-PRT-RTN THRU 0270-PRT-RTN-EXIT.
  2145     MOVE 1                      TO CTS.
  2146     PERFORM 0340-L-X-TERM 8 TIMES.
  2147     MOVE DATA-LINE-6            TO P-DATA.
  2148     PERFORM 0260-PRT-RTN THRU 0270-PRT-RTN-EXIT.
  2149     MOVE 1                      TO CTS.
  2150     PERFORM 0350-L-X-FACE 8 TIMES.
  2151     MOVE DATA-LINE-7            TO P-DATA.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  40
* ECS072AS.cbl
  2152     PERFORM 0260-PRT-RTN THRU 0270-PRT-RTN-EXIT.
  2153     MOVE '-'                    TO X.
  2154     MOVE LIFE-OVERRIDE-L6       TO DL-8-OVRD.
  2155     MOVE DATA-LINE-8            TO P-DATA.
  2156     PERFORM 0260-PRT-RTN THRU 0270-PRT-RTN-EXIT.
  2157     MOVE '0'                    TO X.
  2158     MOVE DATA-LINE-9            TO P-DATA.
  2159     PERFORM 0260-PRT-RTN THRU 0270-PRT-RTN-EXIT.
  2160     MOVE 1                      TO CTT.
  2161
  2162 0190-CALC-YEAR-NUMBER-L.
  2163
  2164     COMPUTE WK-1 = (CTT + 11) / 12.
  2165     MOVE WK-1                   TO DL-10A.
  2166     MOVE CTT                    TO CTS.
  2167     MOVE ZERO                   TO T-FLD.
  2168     PERFORM 0330-LIFE-RATE-ADD 12 TIMES.
  2169
  2170     IF T-FLD = ZERO
  2171         ADD 12 TO CTT
  2172         GO TO 0200-CK-LIFE-END.
  2173
  2174     MOVE 1                      TO CTS.
  2175     PERFORM 0360-FILL-LIFE-RATES 12 TIMES.
  2176     MOVE DATA-LINE-10           TO P-DATA.
  2177     PERFORM 0260-PRT-RTN THRU 0270-PRT-RTN-EXIT.
  2178
  2179 0200-CK-LIFE-END.
  2180
  2181     IF CTT NOT GREATER MO-RTS
  2182         GO TO 0190-CALC-YEAR-NUMBER-L.
  2183
  2184     PERFORM 0290-TRAILER-ROUTINE THRU 0300-TRAILER-ROUTINE-X.
  2185     go to 1000-exit
  2186*    GO TO 0150-READ-MASTER-RATE.
  2187
  2188     .
  2189 0220-DOING-A-AND-H.
  2190
  2191     MOVE AH-OVERRIDE-L12        TO DL-11-OVRD.
  2192     MOVE RT-LAH-NUM             TO DL-11A.
  2193     PERFORM 0470-FIND-D-NAME THRU 0490-E-F-D-NAME.
  2194     MOVE RT-RATE-COMMENT        TO DL-11A-COMM.
  2195     MOVE DATA-LINE-11           TO P-DATA.
  2196     PERFORM 0260-PRT-RTN THRU 0270-PRT-RTN-EXIT.
  2197     MOVE RT-MAX-AGE             TO DL-4AGE.
  2198     MOVE DATA-LINE-4A           TO P-DATA.
  2199     PERFORM 0260-PRT-RTN THRU 0270-PRT-RTN-EXIT.
  2200     MOVE 1                      TO CTS.
  2201     PERFORM 0380-AH-X-AGE 8 TIMES.
  2202     MOVE DATA-LINE-12           TO P-DATA.
  2203     PERFORM 0260-PRT-RTN THRU 0270-PRT-RTN-EXIT.
  2204     MOVE 1 TO CTS.
  2205     PERFORM 0390-AH-X-TERM 8 TIMES.
  2206     MOVE DATA-LINE-12A          TO P-DATA.
  2207     PERFORM 0260-PRT-RTN THRU 0270-PRT-RTN-EXIT.
  2208     MOVE 1                      TO CTS.
  2209     PERFORM 0400-AH-X-BEN 8 TIMES.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  41
* ECS072AS.cbl
  2210     MOVE DATA-LINE-13           TO P-DATA.
  2211     PERFORM 0260-PRT-RTN THRU 0270-PRT-RTN-EXIT.
  2212     MOVE 1 TO CTS.
  2213     PERFORM 0410-AH-X-FACE 8 TIMES.
  2214     MOVE DATA-LINE-13A          TO P-DATA.
  2215     PERFORM 0260-PRT-RTN THRU 0270-PRT-RTN-EXIT.
  2216     MOVE '-'                    TO X.
  2217     MOVE AH-OVERRIDE-L6         TO DL-14-OVRD.
  2218     MOVE DATA-LINE-14           TO P-DATA.
  2219     PERFORM 0260-PRT-RTN THRU 0270-PRT-RTN-EXIT.
  2220     MOVE '0'                    TO X.
  2221     MOVE DATA-LINE-9            TO P-DATA.
  2222     PERFORM 0260-PRT-RTN THRU 0270-PRT-RTN-EXIT.
  2223     MOVE 1                      TO CTT.
  2224
  2225 0230-CALC-YEAR-NUMBER-AH.
  2226
  2227     COMPUTE WK-1 = (CTT + 11) / 12.
  2228     MOVE WK-1                   TO DL-10A.
  2229     MOVE CTT                    TO CTS.
  2230     MOVE ZERO                   TO T-FLD.
  2231     PERFORM 0370-AH-RATE-ADD 12 TIMES.
  2232
  2233     IF T-FLD = ZERO
  2234         ADD 12 TO CTT
  2235         GO TO 0240-CK-AH-END.
  2236
  2237     MOVE 1                      TO CTS.
  2238     PERFORM 0420-FILL-AH-RATES 12 TIMES.
  2239     MOVE DATA-LINE-10           TO P-DATA.
  2240     PERFORM 0260-PRT-RTN THRU 0270-PRT-RTN-EXIT.
  2241
  2242 0240-CK-AH-END.
  2243
  2244     IF CTT NOT GREATER MO-RTS
  2245         GO TO 0230-CALC-YEAR-NUMBER-AH.
  2246
  2247     PERFORM 0290-TRAILER-ROUTINE THRU 0300-TRAILER-ROUTINE-X.
  2248*    GO TO 0150-READ-MASTER-RATE.
  2249
  2250     .
  2251 1000-exit.
  2252     exit.
  2253
  2254 0260-PRT-RTN.
* 2255                                 COPY ELCPRT2.
  2256******************************************************************04/15/98
  2257*                                                                *ELCPRT2
  2258*                                                                *ELCPRT2
  2259*                            ELCPRT2                             *   LV005
  2260*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**5
  2261*                            VMOD=2.002                          *   CL**5
  2262*                                                                *   CL**4
  2263******************************************************************   CL**4
  2264                                                                     CL**4
  2265     IF DTE-FICH NOT = SPACE AND                                     CL**4
  2266        FICH-OPEN    = SPACE                                         CL**4
  2267         MOVE 'X'                TO  FICH-OPEN                       CL**4
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  42
* ECS072AS.cbl (/apps/prod/cid1p/copy/ELCPRT2)
  2268         OPEN OUTPUT FICH.                                           CL**4
  2269                                                                     CL**4
  2270     IF DTE-FICH NOT = SPACE                                         CL**4
  2271         MOVE X                  TO  P-CTL                           CL**4
  2272         WRITE FICH-REC FROM PRT.                                    CL**4
  2273                                                                     CL**4
  2274     IF DTE-FICH = SPACE OR '2'                                      CL**4
  2275       MOVE X                    TO  P-CTL                           CL**4
  2276       IF P-CTL = ' '                                                CL**4
  2277         WRITE PRT AFTER ADVANCING 1 LINE                            CL**4
  2278       ELSE                                                          CL**4
  2279         IF P-CTL = '0'                                              CL**4
  2280           WRITE PRT AFTER ADVANCING 2 LINES                         CL**4
  2281         ELSE                                                        CL**4
  2282           IF P-CTL = '-'                                            CL**4
  2283             WRITE PRT AFTER ADVANCING 3 LINES                       CL**4
  2284           ELSE                                                      CL**4
  2285             WRITE PRT AFTER ADVANCING PAGE.                         CL**4
  2286                                                                     CL**4
  2287******************************************************************   CL**4
  2288     ADD 1 TO LINE-CNT.
  2289
  2290     IF X = '0'
  2291         ADD 1 TO LINE-CNT
  2292     ELSE
  2293         IF X = '-'
  2294             ADD 2 TO LINE-CNT.
  2295
  2296     MOVE ' '                    TO X.
  2297
  2298 0270-PRT-RTN-EXIT.    EXIT.
  2299
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  43
* ECS072AS.cbl
  2301 0290-TRAILER-ROUTINE.
  2302
  2303     IF LINE-CNT LESS 48
  2304         MOVE SPACES             TO P-DATA
  2305         PERFORM 0260-PRT-RTN THRU 0270-PRT-RTN-EXIT
  2306         GO TO 0290-TRAILER-ROUTINE.
  2307
  2308     MOVE 'STATE'                TO TRAILER-DESC.
  2309     MOVE RT-ST-CODE             TO TRAILER-DETL.
  2310     MOVE TRAILER-LINE           TO P-DATA.
  2311     PERFORM 0260-PRT-RTN THRU 0270-PRT-RTN-EXIT.
  2312     MOVE 'CLASS'                TO TRAILER-DESC.
  2313     MOVE RT-ST-CLASS            TO TRAILER-DETL.
  2314     MOVE TRAILER-LINE           TO P-DATA.
  2315     PERFORM 0260-PRT-RTN THRU 0270-PRT-RTN-EXIT.
  2316     MOVE 'DEVIATION'            TO TRAILER-DESC.
  2317     MOVE RT-ST-DEV              TO TRAILER-DETL.
  2318     MOVE TRAILER-LINE           TO P-DATA.
  2319     PERFORM 0260-PRT-RTN THRU 0270-PRT-RTN-EXIT.
  2320     MOVE 'TYPE'                 TO TRAILER-DESC.
  2321     MOVE RT-L-AH-CODE           TO TRAILER-DETL.
  2322     MOVE TRAILER-LINE           TO P-DATA.
  2323     PERFORM 0260-PRT-RTN THRU 0270-PRT-RTN-EXIT.
  2324     MOVE 'HIGH AGE'             TO TRAILER-DESC.
  2325     MOVE RT-HIGH-AGE            TO TRAILER-DETL.
  2326     MOVE TRAILER-LINE           TO P-DATA.
  2327     PERFORM 0260-PRT-RTN THRU 0270-PRT-RTN-EXIT.
  2328     MOVE RT-EXP-YR              TO PRETTY-YR.
  2329     MOVE RT-EXP-MO              TO PRETTY-MO.
  2330     MOVE RT-EXP-DA              TO PRETTY-DAY.
  2331     MOVE PRETTY-DATE            TO TRAILER-DETL.
  2332     MOVE 'EXP DATE'             TO TRAILER-DESC.
  2333     MOVE TRAILER-LINE           TO P-DATA.
  2334     PERFORM 0260-PRT-RTN THRU 0270-PRT-RTN-EXIT.
  2335
  2336 0300-TRAILER-ROUTINE-X.     EXIT.
  2337
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  44
* ECS072AS.cbl
  2339 0320-L-X-AGE.
  2340
  2341     MOVE RT-L-EX-AGE (CTS)      TO DL-5B (CTS).
  2342     ADD 1 TO CTS.
  2343
  2344 0330-LIFE-RATE-ADD.
  2345
  2346     ADD RT-L-RATE (CTS)         TO T-FLD.
  2347     ADD 1 TO CTS.
  2348
  2349 0340-L-X-TERM.
  2350
  2351     MOVE RT-L-EX-TERM (CTS)     TO DL-6B (CTS).
  2352     ADD 1 TO CTS.
  2353
  2354 0350-L-X-FACE.
  2355
  2356     MOVE RT-L-EX-FACE (CTS)     TO DL-7B (CTS).
  2357     ADD 1 TO CTS.
  2358
  2359 0360-FILL-LIFE-RATES.
  2360
  2361     MOVE RT-L-RATE (CTT)        TO DL-10D (CTS).
  2362     ADD 1 TO CTT.
  2363     ADD 1 TO CTS.
  2364
  2365 0370-AH-RATE-ADD.
  2366
  2367     ADD RT-AH-RATE (CTS)        TO T-FLD.
  2368     ADD 1 TO CTS.
  2369
  2370 0380-AH-X-AGE.
  2371
  2372     MOVE RT-AH-AGE (CTS)        TO DL-12B (CTS).
  2373     ADD 1 TO CTS.
  2374
  2375 0390-AH-X-TERM.
  2376
  2377     MOVE RT-AH-TERM (CTS)       TO DL-12A-T (CTS).
  2378     MOVE SPACES                 TO DL-12A-FIL (CTS).
  2379     ADD 1 TO CTS.
  2380
  2381 0400-AH-X-BEN.
  2382
  2383     MOVE RT-AH-BEN-M (CTS)      TO DL-13B (CTS).
  2384     ADD 1 TO CTS.
  2385
  2386 0410-AH-X-FACE.
  2387
  2388     MOVE RT-AH-BEN-F (CTS)      TO DL-13A-BF (CTS).
  2389     MOVE SPACES                 TO DL-13A-FIL (CTS).
  2390     ADD 1 TO CTS.
  2391
  2392 0420-FILL-AH-RATES.
  2393
  2394     MOVE RT-AH-RATE (CTT)       TO DL-10D (CTS).
  2395     ADD 1 TO CTT.
  2396     ADD 1 TO CTS.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  45
* ECS072AS.cbl
  2397
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  46
* ECS072AS.cbl
  2399 0440-FIND-L-NAME.
  2400
  2401     MOVE SPACES                 TO DL-2B.
  2402
  2403     IF CLAS-STARTL = ZERO
  2404         GO TO 0460-E-F-L-NAME.
  2405
  2406     MOVE CLAS-STARTL            TO CLAS-INDEXL.
  2407
  2408 0450-FLN-LOOP.
  2409
  2410     IF CLAS-I-BEN (CLAS-INDEXL) = RT-LAH-NUM
  2411         MOVE CLAS-I-AB10 (CLAS-INDEXL) TO DL-2B
  2412         GO TO 0460-E-F-L-NAME.
  2413
  2414     ADD +1 TO CLAS-INDEXL.
  2415
  2416     IF CLAS-INDEXL NOT GREATER THAN CLAS-MAXL
  2417         GO TO 0450-FLN-LOOP.
  2418
  2419 0460-E-F-L-NAME.     EXIT.
  2420
  2421
  2422 0470-FIND-D-NAME.
  2423
  2424     MOVE SPACES                 TO DL-11B.
  2425
  2426     IF CLAS-STARTA = ZERO
  2427         GO TO 0490-E-F-D-NAME.
  2428
  2429     MOVE CLAS-STARTA            TO CLAS-INDEXA.
  2430
  2431 0480-FDN-LOOP.
  2432
  2433     IF CLAS-I-BEN (CLAS-INDEXA) = RT-LAH-NUM
  2434         MOVE CLAS-I-AB10 (CLAS-INDEXA) TO DL-11B
  2435         GO TO 0490-E-F-D-NAME.
  2436
  2437     ADD +1 TO CLAS-INDEXA.
  2438
  2439     IF CLAS-INDEXA NOT GREATER THAN CLAS-MAXA
  2440         GO TO 0480-FDN-LOOP.
  2441
  2442 0490-E-F-D-NAME.     EXIT.
  2443
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  47
* ECS072AS.cbl
  2445 0510-EOJ-CLOSER.
  2446
  2447     if ws-recs-ret = zeros
  2448        MOVE '1'                 TO X
  2449        MOVE LIFE-OVERRIDE-L12   TO H1-OVRD-1
  2450        MOVE   AH-OVERRIDE-L12   TO H1-OVRD-2
  2451        MOVE HEAD-1              TO P-DATA
  2452        PERFORM 0260-PRT-RTN THRU 0270-PRT-RTN-EXIT
  2453        MOVE HEAD-2              TO P-DATA
  2454        PERFORM 0260-PRT-RTN THRU 0270-PRT-RTN-EXIT
  2455        MOVE HEAD-2A             TO P-DATA
  2456        PERFORM 0260-PRT-RTN THRU 0270-PRT-RTN-EXIT
  2457        move '0'                 to X
  2458        move 'No changes made today '
  2459                                 to data-line-0 (17:30)
  2460        move data-line-0         to p-data
  2461        PERFORM 0260-PRT-RTN THRU 0270-PRT-RTN-EXIT
  2462     end-if
  2463
* 2464                             COPY ELCPRTC.
  2465******************************************************************04/15/98
  2466*                                                                *ELCPRTC
  2467*                                                                *ELCPRTC
  2468*                            ELCPRTC.                            *   LV003
  2469*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
  2470*                            VMOD=2.002                          *   CL**2
  2471*       CLOSE FICH FILE IF OPEN                                  *ELCPRTC
  2472*                                                                *ELCPRTC
  2473* NOTE- USE ELCPRTCX IF USING ELCPRT2X (ONLINE REPORT SAVE)      *   CL**2
  2474******************************************************************ELCPRTC
  2475                                                                  ELCPRTC
  2476      IF FICH-OPEN NOT = SPACE                                    ELCPRTC
  2477          CLOSE FICH.                                             ELCPRTC
  2478                                                                  ELCPRTC
  2479******************************************************************ELCPRTC
  2480
  2481     CLOSE rt-journal-in
  2482           PRINTX.
  2483
  2484     GOBACK.
  2485
  2486 8500-DATE-CONVERT.
  2487
  2488     CALL 'ELDATCX' USING DATE-CONVERSION-DATA
  2489
  2490     .
  2491 8500-EXIT.
  2492     EXIT.
  2493
  2494 ABEND-PGM SECTION.
*                                      COPY ELCABEND.
  2495***************************************************************** 04/14/98
  2496*                                                               * ELCABEND
  2497*                            ELCABEND.                          *    LV003
  2498*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
  2499*                            VMOD 2.002                              CL**2
  2500*                                                               * ELCABEND
  2501*                THIS SECTION DISPLAYS THE NECESSARY MESSAGES   * ELCABEND
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  48
* ECS072AS.cbl (/apps/prod/cid1p/copy/ELCABEND)
  2502*            AND THEN ABENDS.                                   * ELCABEND
  2503*                                                               * ELCABEND
  2504*  NO  CID  MODS  IN  COPYBOOK  ELCABEND                        * ELCABEND
  2505*                                                               * ELCABEND
  2506***************************************************************** ELCABEND
  2507*APS-010.                                                         ELCABEND
  2508     DISPLAY WS-ABEND-MESSAGE.                                    ELCABEND
  2509     DISPLAY WS-ABEND-MESSAGE UPON CONSOLE.                       ELCABEND
  2510                                                                  ELCABEND
  2511     IF WS-ABEND-FILE-STATUS NOT = ZERO                           ELCABEND
  2512         DISPLAY 'FILE STATUS = ' WS-ABEND-FILE-STATUS            ELCABEND
  2513         DISPLAY 'FILE STATUS = ' WS-ABEND-FILE-STATUS            ELCABEND
  2514                                 UPON CONSOLE.                    ELCABEND
  2515                                                                  ELCABEND
  2516     IF WS-RETURN-CODE NOT = ZERO                                 ELCABEND
  2517         DISPLAY 'RETURN CODE = '  WS-RETURN-CODE                 ELCABEND
  2518         DISPLAY 'RETURN CODE = '  WS-RETURN-CODE                 ELCABEND
  2519                                 UPON CONSOLE.                    ELCABEND
  2520                                                                  ELCABEND
  2521     DISPLAY 'PROGRAM WILL NOW ABEND **************'              ELCABEND
  2522     DISPLAY 'PROGRAM WILL NOW ABEND **************'              ELCABEND
  2523                                 UPON CONSOLE.                    ELCABEND
  2524                                                                  ELCABEND
  2525     DIVIDE WS-ZERO BY WS-ZERO GIVING WS-ZERO.                    ELCABEND
  2526     CALL 'ABORTME'.
  2527                                                                  ELCABEND
  2528 APS-EXIT.                                                        ELCABEND
  2529     EXIT.                                                        ELCABEND
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:       62592     Code:        8562
