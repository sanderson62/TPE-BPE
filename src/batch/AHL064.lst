* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   1
* AHL064.cbl
* Options: int("AHL064.int") anim csi verbose NOBOUND PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("AHL064.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"ebmlsfile" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" NOCHECKDIV NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"32" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"AHL064.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"AHL064.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR NOSTICKY-LINKAGE
*          NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"2" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                AHL064.
     4*                           VMOD=2.005.
     5
     6*AUTHOR.        LOGIC, INC.
     7*               DALLAS, TEXAS.
     8
     9*DATE-COMPILED.
    10
    11*SECURITY.   *****************************************************
    12*            *                                                   *
    13*            *   THIS PROGRAM IS THE PROPERTY OF CSO             *
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   2
* AHL064.cbl
    14*            *                                                   *
    15*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
    16*            *   OF    CSO      IS EXPRESSLY PROHIBITED WITHOUT  *
    17*            *   THE PRIOR WRITTEN PERMISSION OF CSO             *
    18*            *                                                   *
    19*            *****************************************************
    20
    21*REMARKS.
    22*        THIS PROGRAM PRINTS THE AGED ACCOUNTS RECEIVABLE.
    23******************************************************************
    24*                   C H A N G E   L O G
    25*
    26* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    27*-----------------------------------------------------------------
    28*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    29* EFFECTIVE    NUMBER
    30*-----------------------------------------------------------------
    31* 082012  CR2012042700005  PEMA  ADD OVER 120 DAYS TO AGEING
    32******************************************************************
    33
    34 ENVIRONMENT DIVISION.
    35 INPUT-OUTPUT SECTION.
    36 FILE-CONTROL.
    37
    38     SELECT PRNTR            ASSIGN TO SYS008-UR-1403-S-SYS008.
    39     SELECT COMM-MSTR-IN     ASSIGN TO SYS010-UT-2400-S-SYS010.
    40
    41     SELECT ME50-ECS064-BALANCE
    42                             ASSIGN TO SYS012
    43                             ORGANIZATION IS LINE SEQUENTIAL.
    44
    45     SELECT DISK-DATE        ASSIGN TO SYS019-UT-FBA1-S-SYS019.
    46     SELECT FICH             ASSIGN TO SYS020-UT-2400-S-SYS020.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   3
* AHL064.cbl
    48 DATA DIVISION.
    49 FILE SECTION.
    50
    51 FD  PRNTR
    52     RECORDING MODE F
    53     LABEL RECORDS OMITTED
    54     BLOCK CONTAINS 0 RECORDS
    55     RECORD CONTAINS 150 CHARACTERS.
    56 01  PRT.
    57     12  P-CTL               PIC  X.
    58     12  P-DATA              PIC  X(149).
    59 FD  COMM-MSTR-IN
*   60                             COPY ECSCOIFD.
    61******************************************************************07/10/97
    62*                                                                *ECSCOIFD
    63*                            ECSCOIFD                            *   LV001
    64*                            VMOD=2.005                          *ECSCOIFD
    65*                                                                *ECSCOIFD
    66* NO CID  MODS IN  COPYBOOK  ECSCOIFD.                           *ECSCOIFD
    67*                                                                *ECSCOIFD
    68******************************************************************ECSCOIFD
    69     BLOCK CONTAINS 0 RECORDS
    70     RECORDING MODE F.                                            ECSCOIFD
    71                                                                  ECSCOIFD
    72 01  COMP-IN-RECORD.                                              ECSCOIFD
    73     12  COI-ID                            PIC XX.                ECSCOIFD
    74                                                                  ECSCOIFD
    75     12  COI-CONTROL.                                             ECSCOIFD
    76         16  COI-COMPANY-CD                PIC X.                 ECSCOIFD
    77         16  COI-CTL-1.                                           ECSCOIFD
    78             20  COI-CARR-GROUP.                                  ECSCOIFD
    79                 24  COI-CARRIER           PIC X.                 ECSCOIFD
    80                 24  COI-GROUPING.                                ECSCOIFD
    81                     28  COI-GRP-PREFIX    PIC XXX.               ECSCOIFD
    82                     28  COI-GRP-PRIME     PIC XXX.               ECSCOIFD
    83             20  COI-RESP-NO.                                     ECSCOIFD
    84                 24  COI-RESP-PREFIX       PIC X(4).              ECSCOIFD
    85                 24  COI-RESP-PRIME        PIC X(6).              ECSCOIFD
    86         16  COI-CTL-2.                                           ECSCOIFD
    87             20  COI-ACCOUNT.                                     ECSCOIFD
    88                 24  COI-ACCT-PREFIX       PIC X(4).              ECSCOIFD
    89                 24  COI-ACCT-PRIME        PIC X(6).              ECSCOIFD
    90         16  COI-TYPE                      PIC X.                 ECSCOIFD
    91             88  COI-COMPANY-RECORD           VALUE 'C'.          ECSCOIFD
    92             88  COI-GENERAL-AGENT-RECORD     VALUE 'G'.          ECSCOIFD
    93             88  COI-ACCOUNT-RECORD           VALUE 'A'.          ECSCOIFD
    94                                                                  ECSCOIFD
    95     12  FILLER                            PIC X(20).             ECSCOIFD
    96                                                                  ECSCOIFD
    97     12  COI-BALANCE-CONTROL               PIC X.                 ECSCOIFD
    98         88  COI-CARRY-BALANCE                VALUE 'Y'.          ECSCOIFD
    99         88  COI-NO-BALANCE                   VALUE 'N'.          ECSCOIFD
   100                                                                  ECSCOIFD
   101     12  COI-INTERNAL-CONTROL-1            PIC X.                 ECSCOIFD
   102         88  COI-AUTO-GENERATED-THIS-RUN      VALUE 'X'.          ECSCOIFD
   103         88  COI-AUTO-GENERATED               VALUE 'Y'.          ECSCOIFD
   104         88  COI-NOT-AUTO-GENERATED           VALUE 'N'.          ECSCOIFD
   105                                                                  ECSCOIFD
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   4
* AHL064.cbl (/apps/prod/cid1p/copy/ECSCOIFD)
   106     12  COI-INTERNAL-CONTROL-2            PIC X.                 ECSCOIFD
   107         88  COI-STATEMENT-THIS-RUN           VALUE 'Y'.          ECSCOIFD
   108         88  COI-NO-STATEMENT-THIS-RUN        VALUE 'N'.          ECSCOIFD
   109                                                                  ECSCOIFD
   110     12  COI-FUTURE-SPACE                  PIC X(5).              ECSCOIFD
   111         88  COI-FUTURE-NOT-USED              VALUE '     '.      ECSCOIFD
   112                                                                  ECSCOIFD
   113     12  COI-DATA                          PIC X(641).            ECSCOIFD
   114                                                                  ECSCOIFD
   115******************************************************************ECSCOIFD
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   5
* AHL064.cbl
   117
   118 FD  ME50-ECS064-BALANCE
   119     RECORDING MODE IS F
   120     BLOCK CONTAINS 0 RECORDS.
   121 01  ME50-ECS064-BALANCE-REC    PIC X(95).
   122
   123 FD  DISK-DATE
*  124                             COPY ELCDTEFD.
   125******************************************************************04/15/98
   126*                                                                *ELCDTEFD
   127*                                                                *ELCDTEFD
   128*                            ELCDTEFD.                           *   LV002
   129*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
   130*                            VMOD=2.007                          *   CL**2
   131*                                                                *ELCDTEFD
   132******************************************************************ELCDTEFD
   133     BLOCK CONTAINS 0 RECORDS
   134     RECORDING MODE F.                                            ELCDTEFD
   135                                                                  ELCDTEFD
   136 01  DATE-DISK.                                                   ELCDTEFD
   137     12  DD-ID                       PIC  X(4).                   ELCDTEFD
   138     12  FILLER                      PIC  X(14).                  ELCDTEFD
   139     12  DD-CR1                      PIC  9.                      ELCDTEFD
   140     12  DD-CR1N                     PIC  X(30).                  ELCDTEFD
   141     12  DD-CR2                      PIC  9.                      ELCDTEFD
   142     12  DD-CR2N                     PIC  X(30).                  ELCDTEFD
   143     12  FILLER                      PIC  X(20).                  ELCDTEFD
   144                                                                  ELCDTEFD
   145 01  DATE-DISK-R.                                                 ELCDTEFD
   146     12  FILLER                      PIC  X(4).                   ELCDTEFD
   147     12  DD-ST           OCCURS 3 TIMES                           ELCDTEFD
   148                                     PIC  X(32).                  ELCDTEFD
   149                                                                  ELCDTEFD
   150 01  DATE-DISK-T.                                                 ELCDTEFD
   151     12  FILLER                      PIC  X(4).                   ELCDTEFD
   152     12  DD-TYPE         OCCURS 2 TIMES                           ELCDTEFD
   153                                     PIC  X(48).                  ELCDTEFD
   154                                                                  ELCDTEFD
   155 01  DATE-DISK-M.                                                 ELCDTEFD
   156     12  FILLER                      PIC  X(4).                   ELCDTEFD
   157     12  DD-MORT         OCCURS 2 TIMES                           ELCDTEFD
   158                                     PIC  X(48).                  ELCDTEFD
   159                                                                  ELCDTEFD
   160 01  DATE-DISK-P.                                                 ELCDTEFD
   161     12  DD-IDA                      PIC  XX.                     ELCDTEFD
   162     12  DD-IDX                      PIC  99.                     ELCDTEFD
   163     12  DD-DATA                     PIC  X(96).                  ELCDTEFD
   164     12  FILLER  REDEFINES DD-DATA.                               ELCDTEFD
   165         16  DD-PS-PIC   OCCURS 50 TIMES                          ELCDTEFD
   166                                     PIC  X.                      ELCDTEFD
   167         16  FILLER                  PIC  X(46).                  ELCDTEFD
   168     12  FILLER  REDEFINES DD-DATA.                               ELCDTEFD
   169         16  DD-PS-PICO  OCCURS 20 TIMES.                         ELCDTEFD
   170             20  DD-PS-PRT           PIC  X.                      ELCDTEFD
   171             20  DD-PS-FMT           PIC  X.                      ELCDTEFD
   172             20  DD-PS-PRC           PIC  X.                      ELCDTEFD
   173             20  DD-PS-TOT           PIC  X.                      ELCDTEFD
   174         16  FILLER                  PIC  X(16).                  ELCDTEFD
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   6
* AHL064.cbl (/apps/prod/cid1p/copy/ELCDTEFD)
   175                                                                  ELCDTEFD
   176 01  DATE-DISK-E.                                                 ELCDTEFD
   177     12  FILLER                      PIC  X(4).                   ELCDTEFD
   178     12  DD-EDIT         OCCURS 24 TIMES                          ELCDTEFD
   179                                     PIC  X(4).                   ELCDTEFD
   180                                                                  ELCDTEFD
   181 01  DATE-DISK-C.                                                 ELCDTEFD
   182     12  FILLER                      PIC  X(7).                   ELCDTEFD
   183     12  DD-CARR1-SECPAY-SW          PIC  X.
   184     12  DD-CARR1-UEP-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   185     12  DD-CARR1-R78-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   186     12  DD-CARR1-PRO-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   187     12  DD-CARR1                    PIC  X.                      ELCDTEFD
   188     12  DD-CARR1S                   PIC  XX.                     ELCDTEFD
   189     12  DD-CARR1N                   PIC  X(30).                  ELCDTEFD
   190     12  DD-CARR2                    PIC  X.                      ELCDTEFD
   191     12  DD-CARR2S                   PIC  XX.                     ELCDTEFD
   192     12  DD-CARR2N                   PIC  X(30).                  ELCDTEFD
   193     12  DD-CARR2-UEP-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   194     12  DD-CARR2-R78-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   195     12  DD-CARR2-PRO-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   196     12  DD-CARR2-SECPAY-SW          PIC  X.
   197     12  FILLER                      PIC  X(7).                   ELCDTEFD
   198                                                                  ELCDTEFD
   199 01  DATE-DISK-OPT.                                               ELCDTEFD
   200     12  FILLER                      PIC  X(04).                  ELCDTEFD
   201     12  DD-TLR-DATA.                                             ELCDTEFD
   202         16  DD-TLR                  OCCURS 32 TIMES              ELCDTEFD
   203                                     PIC  X(03).                  ELCDTEFD
   204     12  DD-STATE-DATA REDEFINES DD-TLR-DATA.                     ELCDTEFD
   205         16  DD-STATE-FLDS           OCCURS 16 TIMES              ELCDTEFD
   206                                     PIC  X(06).                  ELCDTEFD
   207     12  DD-CARR-DATA REDEFINES DD-TLR-DATA.                      ELCDTEFD
   208         16  DD-CARR-FLDS            OCCURS 13 TIMES              ELCDTEFD
   209                                     PIC  X(07).                  ELCDTEFD
   210         16  FILLER                  PIC  X(05).                  ELCDTEFD
   211     12  DD-MISC-DATA REDEFINES DD-TLR-DATA                       ELCDTEFD
   212                                     PIC  X(96).                  ELCDTEFD
   213******************************************************************ELCDTEFD
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   7
* AHL064.cbl
   215 FD  FICH
*  216                             COPY ELCFCHFD.
   217******************************************************************04/15/98
   218*                                                                *ELCFCHFD
   219*                            ELCFCHFD.                           *   LV003
   220*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
   221*                            VMOD=2.004                          *   CL**3
   222*                                                                *ELCFCHFD
   223******************************************************************ELCFCHFD
   224     BLOCK CONTAINS 0 RECORDS
   225     RECORDING MODE F.                                            ELCFCHFD
   226                                                                  ELCFCHFD
   227 01  FICH-REC                            PIC   X(133).            ELCFCHFD
   228******************************************************************ELCFCHFD
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   8
* AHL064.cbl
   230 WORKING-STORAGE SECTION.
   231 01  LCP-ABND-CODE                 PIC S999 COMP VALUE +519.
   232 77  FILLER PIC X(32) VALUE '********************************'.
   233 77  FILLER PIC X(32) VALUE '*            AHL064            *'.
   234 77  FILLER PIC X(32) VALUE '*********** VMOD=2.001 *********'.
   235
   236 77  PGM-SUB                 PIC S9(03)      VALUE +64  COMP-3.
   237 77  SPACE-NP                PIC  X(01)      VALUE '1'.
   238 77  SPACE-1                 PIC  X(01)      VALUE ' '.
   239 77  SPACE-2                 PIC  X(01)      VALUE '0'.
   240 77  SPACE-3                 PIC  X(01)      VALUE '-'.
   241 77  X                       PIC  X(01)      VALUE '1'.
   242
   243 01  REQUIRED-STORAGE.
   244     12  WS-RETURN-CODE          PIC S9(04)             COMP.
   245     12  WS-ABEND-MESSAGE        PIC  X(80).
   246     12  WS-ABEND-FILE-STATUS    PIC  X(02)  VALUE ZEROS.
   247     12  WS-ZERO                 PIC S9(01)  VALUE ZERO COMP-3.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   9
* AHL064.cbl
*  249                             COPY ERCCOMP.
   250******************************************************************
   251*                                                                *
   252*                                                                *
   253*                            ERCCOMP                             *
   254*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   255*                            VMOD=2.019                          *
   256*                                                                *
   257*   ONLINE CREDIT SYSTEM                                         *
   258*                                                                *
   259*   FILE DESCRIPTION = COMPENSATION MASTER                       *
   260*                                                                *
   261*   FILE TYPE = VSAM,KSDS                                        *
   262*   RECORD SIZE = 700   RECFORM = FIXED                          *
   263*                                                                *
   264*   BASE CLUSTER NAME = ERCOMP                   RKP=2,LEN=29    *
   265*       ALTERNATE PATH = NONE                                    *
   266*                                                                *
   267*   LOG = NO                                                     *
   268*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
   269*                                                                *
   270******************************************************************
   271*                   C H A N G E   L O G
   272*
   273* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   274*-----------------------------------------------------------------
   275*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   276* EFFECTIVE    NUMBER
   277*-----------------------------------------------------------------
   278* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
   279* 041105    2005031100003  PEMA  ADD TYPE CODE FOR BANKS
   280* 092205    2005050300006  PEMA  ADD LEASE FEE
   281* 032406    2006022800001  AJRA  ADD FIRST WRITTEN DATE
   282* 072406    2006022400001  PEMA  ADD REF EDIT FLD ON B RECS
   283* 062907    2004020600003  PEMA  ADD WITHOLDING PERCENT
   284* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
   285* 020310  CR2008100900004  PEMA  ADD REF4 EXTRACT PROCESSING
   286* 071712  CR2012042700005  PEMA  ADD OVER 120 FOR AHL ONLY
   287******************************************************************
   288
   289 01  COMPENSATION-MASTER.
   290     12  CO-RECORD-ID                          PIC XX.
   291         88  VALID-CO-ID                          VALUE 'CO'.
   292
   293     12  CO-CONTROL-PRIMARY.
   294         16  CO-COMPANY-CD                     PIC X.
   295         16  CO-CONTROL.
   296             20  CO-CTL-1.
   297                 24  CO-CARR-GROUP.
   298                     28  CO-CARRIER            PIC X.
   299                     28  CO-GROUPING.
   300                         32  CO-GROUP-PREFIX   PIC XXX.
   301                         32  CO-GROUP-PRIME    PIC XXX.
   302                 24  CO-RESP-NO.
   303                     28  CO-RESP-PREFIX        PIC X(4).
   304                     28  CO-RESP-PRIME         PIC X(6).
   305             20  CO-CTL-2.
   306                 24  CO-ACCOUNT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  10
* AHL064.cbl (/apps/prod/cid1p/copy/ERCCOMP)
   307                     28  CO-ACCT-PREFIX        PIC X(4).
   308                     28  CO-ACCT-PRIME         PIC X(6).
   309         16  CO-TYPE                           PIC X.
   310             88  CO-COMPANY-TYPE                  VALUE 'C'.
   311             88  CO-GEN-AGENT-TYPE     VALUE 'G' 'B'.
   312             88  CO-ACCOUNT-TYPE                  VALUE 'A'.
   313
   314     12  CO-MAINT-INFORMATION.
   315         16  CO-LAST-MAINT-DT                  PIC XX.
   316         16  CO-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
   317         16  CO-LAST-MAINT-USER                PIC X(4).
   318     12  FILLER                                PIC XX.
   319     12  CO-STMT-TYPE                          PIC XXX.
   320     12  CO-COMP-TYPE                          PIC X.
   321         88  CO-COMP-IS-SPPDD                    VALUE '1'.
   322     12  CO-STMT-OWNER                         PIC X(4).
   323     12  CO-BALANCE-CONTROL                    PIC X.
   324         88  CO-CARRY-BALANCE                     VALUE 'Y'.
   325         88  CO-NO-BALANCE                        VALUE 'N'.
   326
   327     12  CO-INTERNAL-CONTROL-1                 PIC X.
   328         88  CO-AUTO-GENERATED-THIS-RUN           VALUE 'X'.
   329         88  CO-AUTO-GENERATED                    VALUE 'Y'.
   330         88  CO-NOT-AUTO-GENERATED                VALUE 'N'.
   331
   332     12  CO-INTERNAL-CONTROL-2                 PIC X.
   333         88  CO-STATEMENT-THIS-RUN                VALUE 'Y'.
   334         88  CO-NO-STATEMENT-THIS-RUN             VALUE 'N'.
   335
   336     12  CO-GA-WITHOLD-PCT                     PIC S9V9999 COMP-3.
   337     12  CO-GA-DIRECT-DEP                      PIC X.
   338     12  CO-FUTURE-SPACE                       PIC X.
   339         88  CO-FUTURE-NOT-USED                   VALUE ' '.
   340
   341     12  CO-ACCT-NAME                          PIC X(30).
   342     12  CO-MAIL-NAME                          PIC X(30).
   343     12  CO-ADDR-1                             PIC X(30).
   344     12  CO-ADDR-2                             PIC X(30).
   345     12  CO-ADDR-3.
   346         16  CO-ADDR-CITY                      PIC X(27).
   347         16  CO-ADDR-STATE                     PIC XX.
   348     12  CO-CSO-1099                           PIC X.
   349     12  CO-ZIP.
   350         16  CO-ZIP-PRIME.
   351             20  CO-ZIP-PRI-1ST                PIC X.
   352                 88  CO-CANADIAN-POST-CODE  VALUE 'A' THRU 'Z'.
   353             20  FILLER                        PIC X(4).
   354         16  CO-ZIP-PLUS4                      PIC X(4).
   355     12  CO-CANADIAN-POSTAL-CODE  REDEFINES  CO-ZIP.
   356         16  CO-CAN-POSTAL-1                   PIC XXX.
   357         16  CO-CAN-POSTAL-2                   PIC XXX.
   358         16  FILLER                            PIC XXX.
   359     12  CO-SOC-SEC                            PIC X(13).
   360     12  CO-TELEPHONE.
   361         16  CO-AREA-CODE                      PIC XXX.
   362         16  CO-PREFIX                         PIC XXX.
   363         16  CO-PHONE                          PIC X(4).
   364
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  11
* AHL064.cbl (/apps/prod/cid1p/copy/ERCCOMP)
   365     12  CO-ROLADEX-PRINT-DT                   PIC XX.
   366
   367     12  CO-AR-BAL-LEVEL                       PIC X.
   368         88  CO-AR-REF-LVL                        VALUE '1'.
   369         88  CO-AR-BILL-REF-LVL                   VALUE '1'.
   370         88  CO-AR-BILL-LVL                       VALUE '2'.
   371         88  CO-AR-AGT-LVL                        VALUE '3'.
   372         88  CO-AR-FR-LVL                         VALUE '4'.
   373
   374     12  CO-AR-NORMAL-PRINT                    PIC X.
   375         88  CO-AR-BILL-IS-PRINTED                VALUE 'Y'.
   376         88  CO-AR-BILL-NOT-PRINTED               VALUE 'N'.
   377
   378     12  CO-AR-SUMMARY-CODE                    PIC X(6).
   379
   380     12  CO-AR-REPORTING                       PIC X.
   381         88  CO-AR-NET-REPORT                     VALUE 'N'.
   382         88  CO-AR-GROSS-REPORT                   VALUE 'G'.
   383
   384     12  CO-AR-PULL-CHECK                      PIC X.
   385         88  CO-AR-CHECKS-PULLED                  VALUE 'Y'.
   386         88  CO-AR-CHECKS-NOT-PULLED              VALUE 'N'.
   387
   388     12  CO-AR-BALANCE-PRINT                   PIC X.
   389         88  CO-AR-PRINT-NO-BALANCE               VALUE 'N'.
   390
   391     12  CO-AR-LAST-RUN-CODE                   PIC X.
   392         88  CO-AR-LAST-RUN-ANNUAL                VALUE 'A'.
   393         88  CO-AR-LAST-RUN-CYCLE                 VALUE 'C'.
   394         88  CO-AR-LAST-RUN-EOM                   VALUE 'M'.
   395
   396     12  CO-LAST-EOM-STMT-DT                   PIC XX.
   397
   398     12  CO-USER-CODE                          PIC X.
   399     12  CO-REPORT-GROUP-ID                    PIC X(12).
   400
   401******************************************************************
   402*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN THE TOTALS AS OF
   403*    THE LAST MONTH END RUN.
   404******************************************************************
   405
   406     12  CO-LAST-ACTIVITY-DATE.
   407         16  CO-ACT-YEAR                       PIC 99.
   408         16  CO-ACT-MONTH                      PIC 99.
   409         16  CO-ACT-DAY                        PIC 99.
   410
   411     12  CO-LAST-STMT-DT.
   412         16  CO-LAST-STMT-YEAR                 PIC 99.
   413         16  CO-LAST-STMT-MONTH                PIC 99.
   414         16  CO-LAST-STMT-DAY                  PIC 99.
   415
   416     12  CO-MO-END-TOTALS.
   417         16  CO-MONTHLY-TOTALS.
   418             20  CO-BAL-FWD                PIC S9(7)V99   COMP-3.
   419             20  CO-CUR-COM                PIC S9(7)V99   COMP-3.
   420             20  CO-CUR-CHG                PIC S9(7)V99   COMP-3.
   421             20  CO-CUR-PMT                PIC S9(7)V99   COMP-3.
   422             20  CO-END-BAL                PIC S9(7)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  12
* AHL064.cbl (/apps/prod/cid1p/copy/ERCCOMP)
   423
   424         16  CO-AGING-TOTALS.
   425             20  CO-CUR                    PIC S9(7)V99   COMP-3.
   426             20  CO-OV30                   PIC S9(7)V99   COMP-3.
   427             20  CO-OV60                   PIC S9(7)V99   COMP-3.
   428             20  CO-OV90                   PIC S9(7)V99   COMP-3.
   429
   430         16  CO-YTD-TOTALS.
   431             20  CO-YTD-COM                PIC S9(7)V99   COMP-3.
   432             20  CO-YTD-OV                 PIC S9(7)V99   COMP-3.
   433
   434         16  CO-OVER-UNDER-TOTALS.
   435             20  CO-CUR-OVR-UNDR           PIC S9(7)V99   COMP-3.
   436             20  CO-YTD-OVR-UNDR           PIC S9(7)V99   COMP-3.
   437
   438     12  CO-MISCELLANEOUS-TOTALS.
   439         16  CO-FICA-TOTALS.
   440             20  CO-CUR-FICA               PIC S9(7)V99   COMP-3.
   441             20  CO-YTD-FICA               PIC S9(7)V99   COMP-3.
   442
   443         16  CO-CLAIM-TOTALS.
   444             20  CO-LF-CLM-AMT             PIC S9(9)V99   COMP-3.
   445             20  CO-AH-CLM-AMT             PIC S9(9)V99   COMP-3.
   446
   447******************************************************************
   448*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN TOTALS THAT
   449*    REPRESENT CURRENT MONTH (TOTALS OF CYCLES).
   450******************************************************************
   451
   452     12  CO-CURRENT-TOTALS.
   453         16  CO-CURRENT-LAST-STMT-DT.
   454             20  CO-CURRENT-LAST-STMT-YEAR     PIC 99.
   455             20  CO-CURRENT-LAST-STMT-MONTH    PIC 99.
   456             20  CO-CURRENT-LAST-STMT-DAY      PIC 99.
   457
   458         16  CO-CURRENT-MONTHLY-TOTALS.
   459             20  CO-CURRENT-BAL-FWD        PIC S9(7)V99   COMP-3.
   460             20  CO-CURRENT-CUR-COM        PIC S9(7)V99   COMP-3.
   461             20  CO-CURRENT-CUR-CHG        PIC S9(7)V99   COMP-3.
   462             20  CO-CURRENT-CUR-PMT        PIC S9(7)V99   COMP-3.
   463             20  CO-CURRENT-END-BAL        PIC S9(7)V99   COMP-3.
   464
   465         16  CO-CURRENT-AGING-TOTALS.
   466             20  CO-CURRENT-CUR            PIC S9(7)V99   COMP-3.
   467             20  CO-CURRENT-OV30           PIC S9(7)V99   COMP-3.
   468             20  CO-CURRENT-OV60           PIC S9(7)V99   COMP-3.
   469             20  CO-CURRENT-OV90           PIC S9(7)V99   COMP-3.
   470
   471         16  CO-CURRENT-YTD-TOTALS.
   472             20  CO-CURRENT-YTD-COM        PIC S9(7)V99   COMP-3.
   473             20  CO-CURRENT-YTD-OV         PIC S9(7)V99   COMP-3.
   474
   475     12  CO-PAID-COMM-TOTALS.
   476         16  CO-YTD-PAID-COMMS.
   477             20  CO-YTD-PAID-COM           PIC S9(7)V99   COMP-3.
   478             20  CO-YTD-PAID-OV            PIC S9(7)V99   COMP-3.
   479
   480     12  CO-CURRENT-MONTH-ACTIVITY         PIC X.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  13
* AHL064.cbl (/apps/prod/cid1p/copy/ERCCOMP)
   481         88  CO-HAS-CURR-MONTH-ACTIVITY       VALUE 'Y'.
   482         88  CO-NO-CURR-MONTH-ACTIVITY        VALUE 'N'.
   483
   484     12  CO-DELINQUENT-LETTER-CODE         PIC X.
   485         88  CO-ACCOUNT-1ST-LETTER            VALUE 'A'.
   486         88  CO-ACCOUNT-2ND-LETTER            VALUE 'B'.
   487         88  CO-AGENT-1ST-LETTER              VALUE 'B'.
   488         88  CO-AGENT-2ND-LETTER              VALUE 'G'.
   489         88  CO-OVERWRITE-LETTER              VALUE 'O'.
   490         88  CO-MEMO-TO-REGION-MGR            VALUE 'M'.
   491         88  CO-FINAL-LETTER                  VALUE 'F'.
   492         88  CO-RECONCILING                   VALUE 'R'.
   493         88  CO-PHONE-CALL                    VALUE 'P'.
   494         88  CO-LEGAL                         VALUE 'L'.
   495         88  CO-COLLECTION-AGENCY             VALUE 'C'.
   496         88  CO-WRITE-OFF                     VALUE 'W'.
   497         88  CO-NO-ACTION                     VALUE 'N' ' '.
   498
   499     12  CO-CSR-CODE                       PIC X(4).
   500
   501     12  CO-GA-STATUS-INFO.
   502         16  CO-GA-EFFECTIVE-DT            PIC XX.
   503         16  CO-GA-TERMINATION-DT          PIC XX.
   504         16  CO-GA-STATUS-CODE             PIC X.
   505             88  CO-GA-ACTIVE                 VALUE 'A'.
   506             88  CO-GA-INACTIVE               VALUE 'I'.
   507             88  CO-GA-PENDING                VALUE 'P'.
   508         16  CO-GA-COMMENTS.
   509             20  CO-GA-COMMENT-1           PIC X(40).
   510             20  CO-GA-COMMENT-2           PIC X(40).
   511             20  CO-GA-COMMENT-3           PIC X(40).
   512             20  CO-GA-COMMENT-4           PIC X(40).
   513
   514     12  CO-RPTCD2                         PIC X(10).
   515     12  CO-AHL-OVER120-DATA REDEFINES CO-RPTCD2.
   516         16  CO-OV120                      PIC S9(7)V99   COMP-3.
   517         16  CO-CURRENT-OV120              PIC S9(7)V99   COMP-3.
   518
   519     12  CO-TYPE-AGENT                     PIC X(01).
   520         88  CO-CORPORATION                   VALUE 'C'.
   521         88  CO-PARTNERSHIP                   VALUE 'P'.
   522         88  CO-SOLE-PROPRIETOR               VALUE 'S'.
   523         88  CO-TRUST                         VALUE 'T'.
   524         88  CO-UNKNOWN                       VALUE ' ' 'X'.
   525
   526     12  CO-FAXNO.
   527         16  CO-FAX-AREA-CODE                  PIC XXX.
   528         16  CO-FAX-PREFIX                     PIC XXX.
   529         16  CO-FAX-PHONE                      PIC X(4).
   530
   531     12  CO-BANK-INFORMATION.
   532         16  CO-BANK-TRANSIT-NO                PIC X(8).
   533         16  CO-BANK-TRANSIT-NON REDEFINES
   534             CO-BANK-TRANSIT-NO                PIC 9(8).
   535
   536         16  CO-BANK-ACCOUNT-NUMBER            PIC X(17).
   537     12  CO-MISC-DEDUCT-INFO REDEFINES
   538                  CO-BANK-INFORMATION.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  14
* AHL064.cbl (/apps/prod/cid1p/copy/ERCCOMP)
   539         16  CO-MD-GL-ACCT                     PIC X(10).
   540         16  CO-MD-DIV                         PIC XX.
   541         16  CO-MD-CENTER                      PIC X(4).
   542         16  CO-MD-AMT                        PIC S9(5)V99 COMP-3.
   543         16  CO-CREATE-AP-CHECK                PIC X.
   544         16  CO-DELIVER-CK-TO-MEL              PIC X.
   545         16  FILLER                            PIC XXX.
   546     12  CO-ACH-STATUS                         PIC X.
   547         88  CO-ACH-ACTIVE                         VALUE 'A'.
   548         88  CO-ACH-PENDING                        VALUE 'P'.
   549
   550     12  CO-BILL-SW                            PIC X.
   551     12  CO-CONTROL-NAME                       PIC X(30).
   552     12  CO-MAX-BANK-FEE-LEASE                 PIC S999V99 COMP-3.
   553     12  CO-MAX-BANK-FEE                       PIC S999V99 COMP-3.
   554     12  CO-CLP-STATE                          PIC XX.
   555     12  CO-FIRST-WRITTEN-DT                   PIC XX.
   556     12  CO-SPP-REFUND-EDIT                    PIC X.
   557
   558******************************************************************
   559
   560
   561 01  WS-BAL50-DESCRIPTION          PIC X(50)  VALUE
   562     'ECS064 End Bal should match EL509 Current Bal     '.
   563
   564 01  WS-ME50-BALANCE-REC.
   565     12  WS-ME50-BAL-JOB           PIC X(11)  VALUE SPACES.
   566     12  WS-ME50-BAL-DELIM1        PIC X(01)  VALUE ';'.
   567     12  WS-ME50-BAL-STEP          PIC X(08)  VALUE 'ECS064  '.
   568     12  WS-ME50-BAL-DELIM2        PIC X(01)  VALUE ';'.
   569     12  WS-ME50-BAL-AMT-LOW       PIC ZZZ,ZZZ,ZZ9.
   570     12  WS-ME50-BAL-DELIM3        PIC X(01)  VALUE ';'.
   571     12  WS-ME50-BAL-AMT-HIGH      PIC ZZZ,ZZZ,ZZ9.
   572     12  WS-ME50-BAL-DELIM4        PIC X(01)  VALUE ';'.
   573     12  WS-ME50-BAL-DESCRIP       PIC X(50)  VALUE SPACES.
   574
   575 01  COMP-WORKING-AMOUNTS.
   576     12  COMP-3-AREA     COMP-3.
   577         16  COMP-AMT-BEG    PIC S9(09)V9(02).
   578         16  COMP-AMT-COM    PIC S9(09)V9(02).
   579         16  COMP-AMT-CHG    PIC S9(09)V9(02).
   580         16  COMP-AMT-PMT    PIC S9(09)V9(02).
   581         16  COMP-AMT-END    PIC S9(09)V9(02).
   582         16  COMP-AMT-CUR    PIC S9(09)V9(02).
   583         16  COMP-AMT-OV30   PIC S9(09)V9(02).
   584         16  COMP-AMT-OV60   PIC S9(09)V9(02).
   585         16  COMP-AMT-OV90   PIC S9(09)V9(02).
   586         16  COMP-AMT-OV120  PIC S9(09)V9(02).
   587 01  MISC-WORKING-STORAGE.
   588     12  COMP-3-AREA     COMP-3.
   589         16  PGCTR           PIC S9(05)      VALUE +0.
   590         16  LNCTR           PIC S9(03)      VALUE +66.
   591     12  GA-TOTALS       COMP-3.
   592         16  G-CTR           PIC S9(07).
   593         16  G-BEG           PIC S9(09)V9(02).
   594         16  G-CHG           PIC S9(09)V9(02).
   595         16  G-PMT           PIC S9(09)V9(02).
   596         16  G-END           PIC S9(09)V9(02).
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  15
* AHL064.cbl
   597         16  G-OV30          PIC S9(09)V9(02).
   598         16  G-OV60          PIC S9(09)V9(02).
   599         16  G-OV90          PIC S9(09)V9(02).
   600         16  G-OV120         PIC S9(09)V9(02).
   601         16  G-DBT           PIC S9(09)V9(02).
   602         16  G-CRD           PIC S9(09)V9(02).
   603     12  SUB-TOTALS      COMP-3.
   604         16  S-BEG           PIC S9(09)V9(02).
   605         16  S-CHG           PIC S9(09)V9(02).
   606         16  S-PMT           PIC S9(09)V9(02).
   607         16  S-END           PIC S9(09)V9(02).
   608         16  S-OV30          PIC S9(09)V9(02).
   609         16  S-OV60          PIC S9(09)V9(02).
   610         16  S-OV90          PIC S9(09)V9(02).
   611         16  S-OV120         PIC S9(09)V9(02).
   612         16  S-DBT           PIC S9(09)V9(02).
   613         16  S-CRD           PIC S9(09)V9(02).
   614     12  CARRIER-TOTALS  COMP-3.
   615         16  C-BEG           PIC S9(09)V9(02).
   616         16  C-CHG           PIC S9(09)V9(02).
   617         16  C-PMT           PIC S9(09)V9(02).
   618         16  C-END           PIC S9(09)V9(02).
   619         16  C-OV30          PIC S9(09)V9(02).
   620         16  C-OV60          PIC S9(09)V9(02).
   621         16  C-OV90          PIC S9(09)V9(02).
   622         16  C-OV120         PIC S9(09)V9(02).
   623         16  C-DBT           PIC S9(09)V9(02).
   624         16  C-CRD           PIC S9(09)V9(02).
   625     12  FINAL-TOTALS    COMP-3.
   626         16  F-BEG           PIC S9(09)V9(02).
   627         16  F-CHG           PIC S9(09)V9(02).
   628         16  F-PMT           PIC S9(09)V9(02).
   629         16  F-END           PIC S9(09)V9(02).
   630         16  F-OV30          PIC S9(09)V9(02).
   631         16  F-OV60          PIC S9(09)V9(02).
   632         16  F-OV90          PIC S9(09)V9(02).
   633         16  F-OV120         PIC S9(09)V9(02).
   634         16  F-DBT           PIC S9(09)V9(02).
   635         16  F-CRD           PIC S9(09)V9(02).
   636     12  CUR-CTL-1.
   637         16  CUR-CARR-GROUP.
   638             20  CUR-CARR    PIC  X(01).
   639             20  CUR-GROUP   PIC  X(06).
   640         16  CUR-RESP        PIC  X(10).
   641     12  PRE-CONTROL.
   642         16  PRE-CTL-1.
   643             20  PRE-CARR-GROUP.
   644                 24  PRE-CARR    PIC  X(01).
   645                 24  PRE-GROUP   PIC  X(06).
   646             20  PRE-RESP        PIC  X(10).
   647         16  PRE-CTL-2.
   648             20  PRE-ACCT        PIC  X(10).
   649     12  BALANCE-SW          PIC  X(01).
   650         88  ACCOUNT-CARRIES-BALANCE         VALUE 'A'.
   651         88  AGENT-CARRIES-BALANCE           VALUE 'G'.
   652     12  SAVE-COMPANY-NAME   PIC  X(30).
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  16
* AHL064.cbl
   654 01  HD1.
   655     12  FILLER              PIC  X(62)      VALUE SPACES.
   656     12  FILLER              PIC  X(24)      VALUE
   657             'AGED ACCOUNTS RECEIVABLE'.
   658     12  FILLER              PIC  X(49)      VALUE SPACES.
   659     12  FILLER              PIC  X(08)      VALUE 'ECS064'.
   660
   661 01  HD2.
   662     12  FILLER              PIC  X(60)      VALUE SPACES.
   663     12  HD-CO               PIC  X(30).
   664     12  FILLER              PIC  X(45)      VALUE SPACES.
   665     12  HD-RUN-DT           PIC  X(08)      VALUE SPACES.
   666
   667 01  HD3.
   668     12  FILLER              PIC  X(63)      VALUE SPACES.
   669     12  HD-DT               PIC  X(18).
   670     12  FILLER              PIC  X(54)      VALUE SPACES.
   671     12  FILLER              PIC  X(05)      VALUE 'PAGE '.
   672     12  HD-PG               PIC ZZ,ZZ9.
   673
   674 01  HD4.
   675     12  FILLER              PIC  X(44)      VALUE
   676             '-- ACCOUNT NUMBERS --                BEGINNI'.
   677     12  FILLER              PIC  X(44)      VALUE
   678             'NG      CURRENT      PAYMENTS       ENDING  '.
   679     12  FILLER              PIC  X(56)      VALUE
   680             '  ----------------------- A G I N G ----------------
   681-            '----'.
   682
   683 01  HD5.
   684     12  FILLER              PIC  X(44)      VALUE
   685             '-------- ACCOUNT NAME --------        BALANC'.
   686     12  FILLER              PIC  X(44)      VALUE
   687             'E       CHARGES     ADJUSTMENTS     BALANCE '.
   688     12  FILLER              PIC  X(55)      VALUE
   689             '      OVER 30       OVER 60       OVER 90       OVER
   690-            '120'.
   691
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  17
* AHL064.cbl
   693 01  P-REC.
   694     12  P-CCSW              PIC  X(01).
   695     12  P-LINE.
   696         16 FILLER           PIC  X(149).
   697     12  P-LINE-1 REDEFINES P-LINE.
   698         16  P-MSG           PIC  X(07).
   699         16  FILLER          PIC  X(01).
   700         16  P-DASH          PIC  X(01).
   701         16  FILLER          PIC  X(01).
   702         16  P-CARR          PIC  X(01).
   703         16  FILLER          PIC  X(01).
   704         16  P-GROUP         PIC  X(06).
   705         16  FILLER          PIC  X(04).
   706         16  P-TOT-TITLE     PIC  X(12).
   707         16  FILLER          PIC  X(98).
   708     12  P-LINE-2 REDEFINES P-LINE.
   709         16  P-RESP          PIC  X(10).
   710         16  FILLER          PIC  X(01).
   711         16  P-ACCT          PIC  X(10).
   712         16  FILLER          PIC  X(111).
   713     12  P-LINE-3 REDEFINES P-LINE.
   714         16  P-NAME          PIC  X(30).
   715         16  FILLER          PIC  X(04).
   716         16  P-BEG           PIC ZZ,ZZZ,ZZZ.ZZ-.
   717         16  P-CHG           PIC ZZ,ZZZ,ZZZ.ZZ-.
   718         16  P-PMT           PIC ZZ,ZZZ,ZZZ.ZZ-.
   719         16  P-END           PIC ZZ,ZZZ,ZZZ.ZZ-.
   720         16  P-OV30          PIC ZZ,ZZZ,ZZZ.ZZ-.
   721         16  P-OV60          PIC ZZ,ZZZ,ZZZ.ZZ-.
   722         16  P-OV90          PIC ZZ,ZZZ,ZZZ.ZZ-.
   723         16  P-OV120         PIC ZZ,ZZZ,ZZZ.ZZ-.
   724     12  T-LINE-1 REDEFINES P-LINE.
   725         16  T-NAME          PIC  X(30).
   726         16  FILLER          PIC  X(03).
   727         16  T-BEG           PIC ZZZ,ZZZ,ZZZ.ZZ-.
   728         16  FILLER          PIC  X(13).
   729         16  T-PMT           PIC ZZZ,ZZZ,ZZZ.ZZ-.
   730         16  FILLER          PIC  X(13).
   731         16  T-OV30          PIC ZZZ,ZZZ,ZZZ.ZZ-.
   732         16  FILLER          PIC  X(13).
   733         16  T-OV90          PIC ZZZ,ZZZ,ZZZ.ZZ-.
   734     12  T-LINE-2 REDEFINES P-LINE.
   735         16  FILLER          PIC  X(47).
   736         16  T-CHG           PIC ZZZ,ZZZ,ZZZ.ZZ-.
   737         16  FILLER          PIC  X(13).
   738         16  T-END           PIC ZZZ,ZZZ,ZZZ.ZZ-.
   739         16  FILLER          PIC  X(13).
   740         16  T-OV60          PIC ZZZ,ZZZ,ZZZ.ZZ-.
   741         16  FILLER          PIC  X(14).
   742         16  T-OV120         PIC ZZZ,ZZZ,ZZZ.ZZ-.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  18
* AHL064.cbl
*  744                             COPY ELCDTECX.
   745******************************************************************06/05/98
   746*                                                                *ELCDTECX
   747*                            ELCDTECX.                           *   LV005
   748*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
   749*                            VMOD=2.015                          *ELCDTECX
   750*                                                                *ELCDTECX
   751*      WORKING STORAGE COPY CODE FOR APPLICATIONS CALLING        *ELCDTECX
   752*      THE DATE CARD DISK FILE. ( READ ROUTINE = ELCDTERX,       *ELCDTECX
   753*      AND DISK FILE FD = ELCDTEFX)                              *ELCDTECX
   754*                                                                *ELCDTECX
   755******************************************************************ELCDTECX
   756******************************************************************
   757*                   C H A N G E   L O G
   758*
   759* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   760*-----------------------------------------------------------------
   761*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   762* EFFECTIVE    NUMBER
   763*-----------------------------------------------------------------
   764* 092602    2002091900008  PEMA  INCREASE NUMBER OF MAXIMUM
   765*                                  BENEFIT CODES FROM 300 TO 900
   766* 090803    2003080800002  PEMA  ADD CATEGORY FOR SUPER GAP
   767* 051304    2003080800002  SMVA  ADD REFUND METHOD
   768* 071714    2013100100002  PEMA  FIX CRIT PERIOD EDITS
   769******************************************************************
   770 01  DATE-CARD.                                                   ELCDTECX
   771     12  DATX-COD                    PIC  X(4).                   ELCDTECX
   772     12  RUN-DATE                    PIC  9(11)  COMP-3.          ELCDTECX
   773     12  ALPH-DATE                   PIC  X(18).                  ELCDTECX
   774     12  EP-DT                       PIC  9(11)  COMP-3.          ELCDTECX
   775     12  PEND-ACT-FILE               PIC  XX.                     ELCDTECX
   776     12  EP-SW                       PIC  X.                      ELCDTECX
   777         88  NO-EP-EXTRACTS          VALUE SPACE.                 ELCDTECX
   778     12  TAPE-BATCHES                PIC  X.                      ELCDTECX
   779         88  TP-PREL-BAL             VALUE '1'.                   ELCDTECX
   780     12  BIN-RUN-DATE                PIC  XX.                     ELCDTECX
   781     12  RUN-CENTURY.                                             ELCDTECX
   782         16 RUN-CENTURY-N            PIC  99.                        CL**4
   783     12  FILLER                      PIC  X.                         CL**4
   784     12  CLAS-MORT-OVRD              PIC  X(4).                   ELCDTECX
   785     12  FILLER                      PIC  XXX.                    ELCDTECX
   786     12  COMPANY-NAME                PIC  X(30).                  ELCDTECX
   787                                                                  ELCDTECX
   788 01  FILLER                          PIC  X(7)                       CL**6
   789                                          VALUE 'OPTIONS'.        ELCDTECX
   790 01  DATE-CARD-OPTIONS.                                           ELCDTECX
   791     12  DATE-OPTIONS-ID             PIC  X(4).                   ELCDTECX
   792     12  DTE-MIN-PREM                PIC  99V99.                  ELCDTECX
   793     12  DTE-LANGUAGE-IND            PIC  X.                      ELCDTECX
   794         88  DTE-LANGUAGE-IS-FR           VALUE 'F'.              ELCDTECX
   795         88  DTE-LANGUAGE-IS-ENG          VALUE 'E'.              ELCDTECX
   796     12  DTE-MIN-AGE                 PIC  99.                     ELCDTECX
   797     12  DTE-DEFAULT-AGE             PIC  99.                     ELCDTECX
   798     12  FILLER                      PIC  X.                      ELCDTECX
   799     12  DTE-MAX-TERM                PIC  999.                    ELCDTECX
   800     12  DTE-COMP-VG                 PIC  X.                      ELCDTECX
   801     12  DTE-REM-TRM                 PIC  X.                      ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  19
* AHL064.cbl (/apps/prod/cid1p/copy/ELCDTECX)
   802     12  DTE-PRM-CK                  PIC S99V99.                  ELCDTECX
   803     12  DTE-PRORATA                 PIC  X.                      ELCDTECX
   804     12  DTE-CLM-REJ                 PIC  X.                      ELCDTECX
   805     12  DTE-REF-REJ                 PIC  X.                      ELCDTECX
   806     12  DTE-COM-TBL-USED            PIC  X.                      ELCDTECX
   807     12  FILLER                      PIC  X.                      ELCDTECX
   808     12  DTE-QTR-CO                  PIC  X.                      ELCDTECX
   809     12  DTE-REF-CK                  PIC S99V99.                  ELCDTECX
   810     12  DTE-CLM-CK                  PIC S99V99.                  ELCDTECX
   811     12  DTE-CONV-DT                 PIC 9(11) COMP-3.               CL**2
   812     12  DTE-DEFAULT-SEX             PIC  X.                      ELCDTECX
   813     12  DTE-EPL-FORMAT              PIC  X.                      ELCDTECX
   814     12  FILLER                      PIC  X.                      ELCDTECX
   815     12  DTE-JT-AGE                  PIC  X.                      ELCDTECX
   816     12  DTE-KEY-BIRTH               PIC  X.                      ELCDTECX
   817     12  DTE-REINSURANCE             PIC  X.                      ELCDTECX
   818     12  DTE-CLAIM-SORT              PIC  X.                      ELCDTECX
   819     12  DTE-WRT-OFF                 PIC  S99V99.                 ELCDTECX
   820     12  DTE-R78                     PIC  X.                      ELCDTECX
   821     12  DTE-DLY-BILL                PIC  X.                      ELCDTECX
   822     12  DTE-ALT-MORT-CODE           PIC  X(4).                   ELCDTECX
   823     12  DTE-CLAIM-PAID-THRU-TO      PIC  X.                      ELCDTECX
   824     12  DTE-COMPENSATION-ACCESS     PIC  X.                      ELCDTECX
   825     12  DTE-MORTG-ACCESS-CNTL       PIC  X.                      ELCDTECX
   826     12  DTE-MP-ALT-MORT-CODE        PIC  X(4).                   ELCDTECX
   827     12  DTE-MORTALITY-AGE-CALC-METHOD                            ELCDTECX
   828                                     PIC  X.                      ELCDTECX
   829         88  DTE-USE-TABLE-ASSIGNED-METHOD VALUE '1'              ELCDTECX
   830                                                 ' '.             ELCDTECX
   831         88  DTE-USE-ALL-AGE-LAST          VALUE '2'.             ELCDTECX
   832         88  DTE-USE-ALL-AGE-NEAR          VALUE '3'.             ELCDTECX
   833     12  DTE-RESERVE-OPTION-SWITCH   PIC  X.                      ELCDTECX
   834         88  DTE-OPT-RESERVE-METHOD-AUTH       VALUE 'Y'.         ELCDTECX
   835         88  DTE-OPT-RESERVE-METHOD-UNAUTH     VALUE 'N' ' '.     ELCDTECX
   836     12  DTE-REM-TRM-CALC-OPTION     PIC  X.                      ELCDTECX
   837     12  DTE-EXPERIENCE-RETENTION-AGE                             ELCDTECX
   838                                     PIC  9.                         CL**4
   839     12  DTE-SYSTEM.                                              ELCDTECX
   840         16  DTE-SYS-A-CREDIT        PIC  X.                      ELCDTECX
   841         16  DTE-SYS-B-PEND-CLAIM    PIC  X.                      ELCDTECX
   842         16  DTE-SYS-C-CONFIRMATIONS PIC  X.                      ELCDTECX
   843         16  DTE-SYS-D-DEMAND-BILL   PIC  X.                      ELCDTECX
   844         16  DTE-SYS-E-CLASIC-CLAIMS PIC  X.                      ELCDTECX
   845         16  DTE-SYS-F-CLASIC-CREDIT PIC  X.                      ELCDTECX
   846         16  DTE-SYS-G-AR-USED       PIC  X.                      ELCDTECX
   847         16  DTE-SYS-H               PIC  X.                      ELCDTECX
   848         16  DTE-SYS-I               PIC  X.                      ELCDTECX
   849         16  DTE-SYS-J               PIC  X.                      ELCDTECX
   850         16  DTE-SYS-K               PIC  X.                      ELCDTECX
   851         16  DTE-SYS-L               PIC  X.                      ELCDTECX
   852         16  DTE-SYS-M               PIC  X.                      ELCDTECX
   853         16  DTE-SYS-N               PIC  X.                      ELCDTECX
   854         16  DTE-SYS-O               PIC  X.                      ELCDTECX
   855         16  DTE-SYS-P               PIC  X.                      ELCDTECX
   856         16  DTE-SYS-Q               PIC  X.                      ELCDTECX
   857         16  DTE-SYS-R               PIC  X.                      ELCDTECX
   858         16  DTE-SYS-S               PIC  X.                      ELCDTECX
   859         16  DTE-SYS-T               PIC  X.                      ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  20
* AHL064.cbl (/apps/prod/cid1p/copy/ELCDTECX)
   860         16  DTE-SYS-U               PIC  X.                      ELCDTECX
   861         16  DTE-SYS-V               PIC  X.                      ELCDTECX
   862         16  DTE-SYS-W               PIC  X.                      ELCDTECX
   863         16  DTE-SYS-X               PIC  X.                      ELCDTECX
   864         16  DTE-SYS-Y               PIC  X.                      ELCDTECX
   865         16  DTE-SYS-Z               PIC  X.                      ELCDTECX
   866     12  FILLER                      REDEFINES DTE-SYSTEM.        ELCDTECX
   867         16  DTE-SYS-CODE            OCCURS 26 TIMES              ELCDTECX
   868                                     PIC  X.                      ELCDTECX
   869     12  DTE-CLIENT                  PIC  XXX.                    ELCDTECX
   870                                                                  ELCDTECX
   871 01  CLASIC-SYSTEM-CODES.                                         ELCDTECX
   872     12  DTE-COLC-ID                 PIC  X(4).                   ELCDTECX
   873     12  DTE-CLASIC-COMPANY-CD       PIC  X.                      ELCDTECX
   874     12  DTE-CLASIC-COMPANY-NUMBER   PIC  999.                    ELCDTECX
   875*    12  DTE-CLASIC-CLAIM-ACCESS     PIC  X.                      ELCDTECX
   876     12  FILLER                      PIC  X.                      ELCDTECX
   877     12  CLASIC-REIN-MAINT           PIC  XX.                     ELCDTECX
   878     12  CLASIC-COMP-MAINT           PIC  XX.                     ELCDTECX
   879     12  CLASIC-ACCT-MAINT           PIC  XX.                     ELCDTECX
   880     12  CLASIC-CTBL-MAINT           PIC  XX.                     ELCDTECX
   881     12  CLASIC-RATE-MAINT           PIC  XX.                     ELCDTECX
   882     12  CLASIC-CREDIT-EOM-DT        PIC  XX.                     ELCDTECX
   883     12  CLASIC-CLAIMS-EOM-DT        PIC  XX.                     ELCDTECX
   884                                                                  ELCDTECX
   885     12  LIFE-OVERRIDE-L1            PIC  X.                      ELCDTECX
   886     12  LIFE-OVERRIDE-L2            PIC  XX.                     ELCDTECX
   887     12  LIFE-OVERRIDE-L6            PIC  X(6).                   ELCDTECX
   888     12  LIFE-OVERRIDE-L12           PIC  X(12).                  ELCDTECX
   889                                                                  ELCDTECX
   890     12  AH-OVERRIDE-L1              PIC  X.                      ELCDTECX
   891     12  AH-OVERRIDE-L2              PIC  XX.                     ELCDTECX
   892     12  AH-OVERRIDE-L6              PIC  X(6).                   ELCDTECX
   893     12  AH-OVERRIDE-L12             PIC  X(12).                  ELCDTECX
   894                                                                  ELCDTECX
   895     12  CLAS-REPORT-CD1-CAPTION     PIC  X(10).                  ELCDTECX
   896     12  CLAS-REPORT-CD2-CAPTION     PIC  X(10).                  ELCDTECX
   897                                                                  ELCDTECX
   898     12  CLASIC-MORTG-EOM-DT         PIC  XX.                     ELCDTECX
   899     12  CLASIC-AR-EOM-DT            PIC  XX.                     ELCDTECX
   900                                                                  ELCDTECX
   901     12  FILLER                      PIC  X(11)      VALUE SPACE. ELCDTECX
   902                                                                  ELCDTECX
   903 01  DATE-CARD-FACTORS.                                           ELCDTECX
   904     12  DATE-FACTOR-ID              PIC  X(4).                   ELCDTECX
   905     12  FAC-1                       PIC S999V9(5).               ELCDTECX
   906     12  FAC-2                       PIC S999V9(5).               ELCDTECX
   907     12  FAC-3                       PIC S999V9(5).               ELCDTECX
   908     12  FAC-4                       PIC S999V9(5).               ELCDTECX
   909     12  FAC-5                       PIC S999V9(5).               ELCDTECX
   910     12  FAC-6                       PIC S999V9(5).               ELCDTECX
   911                                                                  ELCDTECX
   912 01  FILLER                          PIC  X(12)                   ELCDTECX
   913                                          VALUE 'COMPANY NAME'.   ELCDTECX
   914 01  COMPANY-NAME-TABLE.                                          ELCDTECX
   915     12  C-N-TBL                     OCCURS 6 TIMES.              ELCDTECX
   916         16  CNT-ID                  PIC  X.                      ELCDTECX
   917         16  CNT-NAME                PIC  X(30).                  ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  21
* AHL064.cbl (/apps/prod/cid1p/copy/ELCDTECX)
   918                                                                  ELCDTECX
   919 01  FILLER                          PIC  X(11)                   ELCDTECX
   920                                          VALUE 'STATE NAMES'.    ELCDTECX
   921 01  STATE-NAMES.                                                 ELCDTECX
   922     12  STATE-NAME-FLD              OCCURS 75 TIMES.             ELCDTECX
   923         16  STATE-SUB               PIC  XX.                     ELCDTECX
   924         16  STATE-PIC1.                                          ELCDTECX
   925             20  STATE-ABBR          PIC  XX.                     ELCDTECX
   926             20  FILLER              PIC  XXX.                    ELCDTECX
   927             20  STATE-PIC           PIC  X(20).                  ELCDTECX
   928             20  STATE-CALL-EARN     PIC  X.                      ELCDTECX
   929             20  STATE-CALL-BREAK    PIC  X.                      ELCDTECX
   930             20  STATE-PRIM-FAC-DEV  PIC  XXX.                    ELCDTECX
   931                                                                  ELCDTECX
   932 01  FILLER                          PIC  X(13)                   ELCDTECX
   933                                          VALUE 'CARRIER NAMES'.  ELCDTECX
   934 01  CARRIER-NAMES.                                               ELCDTECX
   935     12  CARRIER-NAME-FLD            OCCURS 25 TIMES.             ELCDTECX
   936         16  CARRIER-SUB             PIC  X.                      ELCDTECX
   937         16  CARRIER-DOM-ST          PIC  XX.                     ELCDTECX
   938         16  CARRIER-PIC             PIC  X(30).                  ELCDTECX
   939         16  CARRIER-UEP-PCT         PIC  S9V9(4) COMP-3.            CL**6
   940         16  CARRIER-R78-PCT         PIC  S9V9(4) COMP-3.            CL**6
   941         16  CARRIER-PRO-PCT         PIC  S9V9(4) COMP-3.            CL**6
   942*        16  FILLER                  PIC  X.                      ELCDTECX
   943         16  CARRIER-SEC-PAY         PIC  X.
   944             88  SEC-PAY-CARRIER          VALUE 'Y'.
   945                                                                  ELCDTECX
   946 01  FILLER                          PIC  X(9)                       CL**6
   947                                          VALUE 'INS TYPES'.      ELCDTECX
   948 01  CLAS-INS-TYPES.                                              ELCDTECX
   949*    12 CLAS-ALL-TYPES               OCCURS 300 TIMES.            ELCDTECX
   950     12 CLAS-ALL-TYPES               OCCURS 900 TIMES.            ELCDTECX
   951         16  CLAS-I-BEN              PIC  XX.                     ELCDTECX
   952         16  CLAS-I-AB3.                                          ELCDTECX
   953             20  FILLER              PIC  X.                      ELCDTECX
   954             20  CLAS-I-AB2.                                      ELCDTECX
   955                 24  FILLER          PIC  X.                      ELCDTECX
   956                 24  CLAS-I-AB1      PIC  X.                      ELCDTECX
   957         16  CLAS-I-AB3-AH REDEFINES CLAS-I-AB3.                  ELCDTECX
   958             20  CLAS-EXCLUSION      PIC  XX.                        CL**4
   959             20  FILLER              PIC  X.                         CL**4
   960         16  CLAS-I-AB10.                                         ELCDTECX
   961             20  FILLER              PIC  X(9).                   ELCDTECX
   962             20  CLAS-I-REIN-YN      PIC  X.                      ELCDTECX
   963         16  CLAS-I-COMMENT          PIC  X(10).                  ELCDTECX
   964         16  CLAS-I-JOINT            PIC  X.                      ELCDTECX
   965         16  CLAS-I-RL-AH            PIC  X.                      ELCDTECX
   966         16  CLAS-I-CALC-TYPE.                                    ELCDTECX
   967             20  CLAS-I-BAL          PIC  X.                      ELCDTECX
   968         16  CLAS-I-EP               PIC  X.                      ELCDTECX
   969         16  CLAS-CO-BEN-I-G-CD      PIC  X.                      ELCDTECX
   970         16  CLAS-CO-REM-TERM-CALC   PIC  X.                      ELCDTECX
   971         16  CLAS-I-BEN-CATEGORY     PIC  X.
   972         16  CLAS-I-REFUND-METHOD    PIC  X.
   973         16  CLAS-I-MAX-BENEFITS     PIC 99.
   974         16  FILLER                  PIC  XXX.
   975                                                                  ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  22
* AHL064.cbl (/apps/prod/cid1p/copy/ELCDTECX)
   976 01  FILLER                          PIC  X(16)                   ELCDTECX
   977                                     VALUE 'MORTALITY TABLES'.    ELCDTECX
   978 01  CLAS-MORTALITY-CODES.                                        ELCDTECX
   979     12  CLAS-MORT-FLD               OCCURS 99 TIMES              ELCDTECX
   980                                     INDEXED BY CLAS-MORT-NDX.    ELCDTECX
   981         16  CLAS-MORT-CODE          PIC  X(4).                      CL**6
   982         16  CLAS-MORT-J-CODE        PIC  X.                         CL**5
   983         16  CLAS-MORT-J-FACT        PIC S9V9(4).                    CL**6
   984         16  CLAS-MORT-DESC.                                      ELCDTECX
   985             20  CLAS-RESERVE-ADJ    PIC  999.                       CL**6
   986             20  FILLER              PIC  XX.                        CL**5
   987             20  CLAS-YEAR           PIC  X(4).                      CL**6
   988             20  FILLER              PIC  X.                         CL**5
   989             20  CLAS-TABLE-TYPE     PIC  XXX.                       CL**6
   990             20  FILLER              PIC  X.                         CL**5
   991             20  CLAS-AGE-METHOD     PIC  XX.                        CL**5
   992             20  FILLER              PIC  X.                         CL**5
   993             20  CLAS-INTEREST       PIC  99.99.                     CL**5
   994             20  FILLER              PIC  X(5).                      CL**6
   995                                                                  ELCDTECX
   996 01  FILLER                          PIC  X(15)                   ELCDTECX
   997                                     VALUE 'BUSINESS TABLES'.     ELCDTECX
   998 01  CLAS-BUSINESS-CLASSES.                                       ELCDTECX
   999     12  CLAS-BUSC-FLD               OCCURS 50 TIMES.             ELCDTECX
  1000         16  CLAS-BUSC-CODE          PIC  99.                     ELCDTECX
  1001         16  CLAS-BUSC-GROUP         PIC  X.                      ELCDTECX
  1002         16  CLAS-BUSC-DESC          PIC  X(19).                  ELCDTECX
  1003         16  CLAS-BUSC-EXCL          PIC  X.                         CL**5
  1004         16  FILLER                  PIC  X(4).                      CL**6
  1005                                                                  ELCDTECX
  1006 01  FILLER                          PIC  X(7)                       CL**6
  1007                                     VALUE 'INDEXES'.             ELCDTECX
  1008 01  CLAS-INDEX-TBL.                                              ELCDTECX
  1009     12  CLAX-ID                     PIC  X(4).                   ELCDTECX
  1010     12  CLAS-STARTC                 PIC S9(4) COMP.              ELCDTECX
  1011     12  CLAS-MAXC                   PIC S9(4) COMP.              ELCDTECX
  1012     12  CLAS-STARTL                 PIC S9(4) COMP.              ELCDTECX
  1013     12  CLAS-MAXL                   PIC S9(4) COMP.              ELCDTECX
  1014     12  CLAS-STARTA                 PIC S9(4) COMP.              ELCDTECX
  1015     12  CLAS-MAXA                   PIC S9(4) COMP.              ELCDTECX
  1016     12  CLAS-STARTM                 PIC S9(4) COMP.              ELCDTECX
  1017     12  CLAS-MAXM                   PIC S9(4) COMP.              ELCDTECX
  1018     12  CLAS-STARTB                 PIC S9(4) COMP.              ELCDTECX
  1019     12  CLAS-MAXB                   PIC S9(4) COMP.              ELCDTECX
  1020     12  CLAS-STARTS                 PIC S9(4) COMP.              ELCDTECX
  1021     12  CLAS-MAXS                   PIC S9(4) COMP.              ELCDTECX
  1022     12  CLAS-STARTE                 PIC S9(4) COMP.              ELCDTECX
  1023     12  CLAS-MAXE                   PIC S9(4) COMP.              ELCDTECX
  1024     12  CLAS-STARTCN                PIC S9(4) COMP.              ELCDTECX
  1025     12  CLAS-MAXCN                  PIC S9(4) COMP.              ELCDTECX
  1026                                                                  ELCDTECX
  1027 01  CLAS-TYPE-MISC.                                              ELCDTECX
  1028     12  CLAS-INDEXC                 PIC S9(4) COMP.              ELCDTECX
  1029     12  CLAS-INDEXL                 PIC S9(4) COMP.              ELCDTECX
  1030     12  CLAS-INDEXA                 PIC S9(4) COMP.              ELCDTECX
  1031     12  CLAS-INDEXM                 PIC S9(4) COMP.              ELCDTECX
  1032     12  CLAS-INDEXB                 PIC S9(4) COMP.              ELCDTECX
  1033     12  CLAS-INDEXS                 PIC S9(4) COMP.              ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  23
* AHL064.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  1034     12  CLAS-INDEXE                 PIC S9(4) COMP.              ELCDTECX
  1035     12  CLAS-INDEX                  PIC S9(4) COMP.              ELCDTECX
  1036     12  CLAS-INDEXEN                PIC S9(4) COMP.              ELCDTECX
  1037     12  CLAS-INDEXCN                PIC S9(4) COMP.              ELCDTECX
  1038     12  CLAS-INDEXON                PIC S9(4) COMP.              ELCDTECX
  1039                                                                  ELCDTECX
  1040 01  FILLER                          PIC  X(13)                   ELCDTECX
  1041                                     VALUE 'MISCELLANEOUS'.       ELCDTECX
  1042 01  CLAS-MISC.                                                   ELCDTECX
  1043     12  DTE-FICH                    PIC  X.                      ELCDTECX
  1044         88  FICH-NO                 VALUE SPACE.                 ELCDTECX
  1045         88  FICH-ONLY               VALUE '1'.                   ELCDTECX
  1046         88  FICH-BOTH               VALUE '2'.                   ELCDTECX
  1047     12  FICH-OPEN                   PIC  X.                      ELCDTECX
  1048     12  REPT-OPEN                   PIC  X.                      ELCDTECX
  1049     12  DTE-PGM-OPT                 PIC  9.                         CL**5
  1050     12  DTE-PRT-OPT                 PIC  X.                      ELCDTECX
  1051     12  DTE-FMT-OPT                 PIC  9.                      ELCDTECX
  1052     12  DTE-PRC-OPT                 PIC  9.                      ELCDTECX
  1053     12  DTE-TOT-OPT                 PIC  9.                      ELCDTECX
  1054     12  CLAS-LOOK                   PIC  XX.                     ELCDTECX
  1055     12  DTE-TOT-LINES               PIC S9(8)      COMP.         ELCDTECX
  1056     12  STATE-L                     PIC  XX.                     ELCDTECX
  1057     12  CLAS-CN                     PIC  99.                     ELCDTECX
  1058     12  CLAS-CO                     PIC  99.                     ELCDTECX
  1059     12  DTE-VSAM-FLAGS                              VALUE ZERO.  ELCDTECX
  1060         16  DTE-F-1                 PIC  X.                      ELCDTECX
  1061         16  DTE-F-2                 PIC  X.                      ELCDTECX
  1062     12  DTE-ABEND-WORK.                                          ELCDTECX
  1063         16  DTE-ABEND-CD-1          PIC  XX         VALUE SPACES.ELCDTECX
  1064         16  DTE-ABEND-CD-2          PIC  XX         VALUE SPACES.ELCDTECX
  1065                                                                  ELCDTECX
  1066 01  FILLER                          PIC  X(12)                   ELCDTECX
  1067                                     VALUE 'WORKING DATE'.        ELCDTECX
  1068 01  WS-DATE-AND-TIME.                                            ELCDTECX
  1069     12  WS-ACCEPT-DATE.                                          ELCDTECX
  1070         16  WS-AD-YY                PIC  99.                     ELCDTECX
  1071         16  WS-AD-MM                PIC  99.                     ELCDTECX
  1072         16  WS-AD-DD                PIC  99.                     ELCDTECX
  1073     12  WS-CURRENT-DATE.                                         ELCDTECX
  1074         16  WS-CD-MM                PIC  99.                     ELCDTECX
  1075         16  FILLER                  PIC  X          VALUE '/'.   ELCDTECX
  1076         16  WS-CD-DD                PIC  99.                     ELCDTECX
  1077         16  FILLER                  PIC  X          VALUE '/'.   ELCDTECX
  1078         16  WS-CD-YY                PIC  99.                     ELCDTECX
  1079     12  WS-TIME-OF-DAY.                                          ELCDTECX
  1080         16  WS-TIME                 PIC  9(6).                   ELCDTECX
  1081         16  WS-HUN-SEC              PIC  99.                     ELCDTECX
  1082                                                                  ELCDTECX
  1083 01  FILLER                          PIC  X(12)                   ELCDTECX
  1084                                     VALUE 'CARRIER CLMS'.        ELCDTECX
  1085 01  CARRIER-OPT-CLAIM-DATA.                                      ELCDTECX
  1086     12  CARRIER-FLDS                OCCURS 25 TIMES.             ELCDTECX
  1087         16  CARRIER-IBNR-SWITCH     PIC  X.                         CL**5
  1088         16  CARRIER-IBNR-PERCENT    PIC S9V9(4) COMP-3.             CL**6
  1089         16  CARRIER-CIDA-DISCOUNT   PIC S9V9(4) COMP-3.             CL**6
  1090                                                                  ELCDTECX
  1091 01  FILLER                          PIC  X(10)                   ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  24
* AHL064.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  1092                                     VALUE 'STATE TLRS'.          ELCDTECX
  1093 01  STATE-TARGET-LOSS-RATIOS.                                    ELCDTECX
  1094     12  STATE-TLR-FLD               OCCURS 75 TIMES.             ELCDTECX
  1095         16  STATE-TARGET-LOSS-RATIO PIC S9V9(4) COMP-3.             CL**6
  1096         16  STATE-CALC-INTEREST     PIC S9V9(4) COMP-3.             CL**6
  1097                                                                  ELCDTECX
  1098 01  FILLER                          PIC  X(13)                   ELCDTECX
  1099                                     VALUE 'BUSINESS TLRS'.       ELCDTECX
  1100 01  BUSINESS-TRGT-LOSS-RATIO-MODS.                               ELCDTECX
  1101     12  BUS-TLRM-FLD                OCCURS 99 TIMES.             ELCDTECX
  1102         16  BUS-TRGT-LOSS-RATIO-MOD PIC S9V9(4) COMP-3.             CL**6
  1103                                                                  ELCDTECX
  1104 01  FILLER                          PIC  X(13)                   ELCDTECX
  1105                                     VALUE 'MISC CLM DATA'.       ELCDTECX
  1106 01  MISC-OPT-CLM-RSV-DATA.                                       ELCDTECX
  1107     12  COMPANY-CALC-INTEREST       PIC S9V9(4) COMP-3.             CL**6
  1108     12  COMPANY-CIDA-DISCOUNT       PIC S9V9(4) COMP-3.             CL**6
  1109     12  COMPANY-CRDB-TABLE-SELECTION                             ELCDTECX
  1110                                     PIC  X.                         CL**5
  1111     12  COMPANY-IBNR-AH-FACTOR      PIC S9V9(4) COMP-3.             CL**6
  1112     12  COMPANY-IBNR-LAG-MONTH      PIC S999    COMP-3.             CL**6
  1113     12  COMPANY-IBNR-LIFE-FACTOR    PIC S9V9(4) COMP-3.             CL**6
  1114     12  COMPANY-OPTION-START-DATE   PIC  XX.                        CL**5
  1115     12  INDEXBS                     PIC S9(4)   COMP.               CL**6
  1116     12  INDEXCA                     PIC S9(4)   COMP.               CL**6
  1117     12  INDEXST                     PIC S9(4)   COMP.               CL**6
  1118     12  FILLER                      PIC  X(75).                  ELCDTECX
  1119******************************************************************ELCDTECX
  1120*01  MISC-CARR-PCT-DATA.                                          00001521
  1121*    12  DD-CARR1-UEP-PCT            PIC S9V9(4) COMP-3.          00001522
  1122*    12  DD-CARR1-R78-PCT            PIC S9V9(4) COMP-3.          00001522
  1123*    12  DD-CARR1-PRO-PCT            PIC S9V9(4) COMP-3.          00001522
  1124*    12  DD-CARR2-UEP-PCT            PIC S9V9(4) COMP-3.          00001522
  1125*    12  DD-CARR2-R78-PCT            PIC S9V9(4) COMP-3.          00001522
  1126*    12  DD-CARR2-PRO-PCT            PIC S9V9(4) COMP-3.          00001522
  1127******************************************************************ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  25
* AHL064.cbl
* 1129                             COPY ELCDTEVR.
  1130***************************************************************** 04/15/98
  1131*                                                                *ELCDTEVR
  1132*                                                                *ELCDTEVR
  1133*                            ELCDTEVR.                           *   LV003
  1134*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
  1135*                            VMOD=2.001                          *   CL**2
  1136*                                                                *ELCDTEVR
  1137*   WORKING STORAGE FOR DATE VARIABLES CREATED                   *ELCDTEVR
  1138*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCDTEVR
  1139*                                                                *ELCDTEVR
  1140******************************************************************ELCDTEVR
  1141 01  WS-DATE-CARD-DATE.                                           ELCDTEVR
  1142     05  WS-RUN-DATE.                                             ELCDTEVR
  1143         10  FILLER                  PIC  9(03).                  ELCDTEVR
  1144         10  RUN-CCYY                PIC  9(04).                  ELCDTEVR
  1145         10  RUN-CCYR  REDEFINES  RUN-CCYY.                       ELCDTEVR
  1146             15  RUN-CC              PIC  99.                     ELCDTEVR
  1147             15  RUN-YR              PIC  99.                     ELCDTEVR
  1148         10  RUN-MO                  PIC  99.                     ELCDTEVR
  1149         10  RUN-DA                  PIC  99.                     ELCDTEVR
  1150     05  WS-RUN-DATE-N REDEFINES                                     CL**2
  1151            WS-RUN-DATE              PIC 9(11).                      CL**2
  1152     05  WS-EP-DT.                                                ELCDTEVR
  1153         10  FILLER                  PIC  9(03).                  ELCDTEVR
  1154         10  EP-CCYY                 PIC  9(04).                  ELCDTEVR
  1155         10  EP-CCYR  REDEFINES  EP-CCYY.                         ELCDTEVR
  1156             15  EP-CC               PIC  99.                     ELCDTEVR
  1157             15  EP-YR               PIC  99.                     ELCDTEVR
  1158         10  EP-MO                   PIC  99.                     ELCDTEVR
  1159         10  EP-DA                   PIC  99.                     ELCDTEVR
  1160     05  WS-EP-DT-N REDEFINES                                        CL**2
  1161            WS-EP-DT                 PIC 9(11).                      CL**2
  1162     05  WS-DTE-CONV-DT.                                             CL**4
  1163         10  FILLER                  PIC  9(03).                     CL**4
  1164         10  DTE-CONV-CCYY           PIC  9(04).                     CL**4
  1165         10  DTE-CONV-CCYR  REDEFINES  DTE-CONV-CCYY.                CL**4
  1166             15  DTE-CONV-CC         PIC  99.                        CL**4
  1167             15  DTE-CONV-YR         PIC  99.                        CL**4
  1168         10  DTE-CONV-MO             PIC  99.                        CL**4
  1169         10  DTE-CONV-DA             PIC  99.                        CL**4
  1170     05  WS-DTE-CONV-DT-N REDEFINES                                  CL**4
  1171            WS-DTE-CONV-DT           PIC  9(11).                     CL**4
  1172 01  WS-BALANCE-FORWARD-DATE.                                     ELCDTEVR
  1173     05  WS-BF-LAST-ACTIVITY-DATE.                                ELCDTEVR
  1174         10  FILLER                            PIC 999.           ELCDTEVR
  1175         10  BF-ACT-CCYY                       PIC 9(04).         ELCDTEVR
  1176         10  BF-ACT-CCYR  REDEFINES  BF-ACT-CCYY.                 ELCDTEVR
  1177             15  BF-ACT-CC                     PIC 99.            ELCDTEVR
  1178             15  BF-ACT-YEAR                   PIC 99.            ELCDTEVR
  1179         10  BF-ACT-MONTH                      PIC 99.            ELCDTEVR
  1180         10  BF-ACT-DAY                        PIC 99.            ELCDTEVR
  1181     05  WS-BF-LAST-ACTIVITY-DATE-N REDEFINES                        CL**2
  1182            WS-BF-LAST-ACTIVITY-DATE           PIC 9(11).            CL**2
  1183     05  WS-BF-CURRENT-LAST-STMT-DT.                              ELCDTEVR
  1184         10  FILLER                            PIC 999.           ELCDTEVR
  1185         10  BF-CURRENT-LAST-STMT-CEN          PIC 99.            ELCDTEVR
  1186         10  BF-CURRENT-LAST-STMT-YEAR         PIC 99.            ELCDTEVR
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  26
* AHL064.cbl (/apps/prod/cid1p/copy/ELCDTEVR)
  1187         10  BF-CURRENT-LAST-STMT-MONTH        PIC 99.            ELCDTEVR
  1188         10  BF-CURRENT-LAST-STMT-DAY          PIC 99.            ELCDTEVR
  1189     05  WS-BF-CURRENT-LAST-STMT-DT-N REDEFINES                      CL**2
  1190            WS-BF-CURRENT-LAST-STMT-DT        PIC 9(11).             CL**2
  1191 01  WS-ADD-CONF-TRANSACTIONS-DTE.                                ELCDTEVR
  1192     05  WS-AC-CERT-EFF-DATE.                                     ELCDTEVR
  1193         10  FILLER                            PIC 999.           ELCDTEVR
  1194         10  AC-CERT-CCYY                      PIC 9(04).         ELCDTEVR
  1195         10  AC-CERT-CCYR  REDEFINES  AC-CERT-CCYY.               ELCDTEVR
  1196             15  AC-CERT-CC                    PIC 99.            ELCDTEVR
  1197             15  AC-CERT-YR                    PIC 99.            ELCDTEVR
  1198         10  AC-CERT-MO                        PIC 99.            ELCDTEVR
  1199         10  AC-CERT-DA                        PIC 99.            ELCDTEVR
  1200     05  WS-AC-CERT-EFF-DATE-N REDEFINES                             CL**2
  1201            WS-AC-CERT-EFF-DATE                PIC 9(11).            CL**2
  1202     05  WS-AC-LIFE-CANCEL-DATE.                                  ELCDTEVR
  1203         10  FILLER                            PIC 999.           ELCDTEVR
  1204         10  AC-LIFE-CANCEL-CCYY               PIC 9(04).         ELCDTEVR
  1205         10  AC-LIFE-CANCEL-CCYR REDEFINES AC-LIFE-CANCEL-CCYY.   ELCDTEVR
  1206             15  AC-LIFE-CANCEL-CC             PIC 99.            ELCDTEVR
  1207             15  AC-LIFE-CANCEL-YR             PIC 99.            ELCDTEVR
  1208         10  AC-LIFE-CANCEL-MO                 PIC 99.            ELCDTEVR
  1209         10  AC-LIFE-CANCEL-DA                 PIC 99.            ELCDTEVR
  1210     05  WS-AC-LIFE-CANCEL-DATE-N REDEFINES                          CL**2
  1211            WS-AC-LIFE-CANCEL-DATE             PIC 9(11).            CL**2
  1212     05  WS-AC-AH-CANCEL-DATE.                                    ELCDTEVR
  1213         10  FILLER                            PIC 999.           ELCDTEVR
  1214         10  AC-AH-CANCEL-CCYY                 PIC 9(04).         ELCDTEVR
  1215         10  AC-AH-CANCEL-CCYR  REDEFINES  AC-AH-CANCEL-CCYY.     ELCDTEVR
  1216             15  AC-AH-CANCEL-CC               PIC 99.            ELCDTEVR
  1217             15  AC-AH-CANCEL-YR               PIC 99.            ELCDTEVR
  1218         10  AC-AH-CANCEL-MO                   PIC 99.            ELCDTEVR
  1219         10  AC-AH-CANCEL-DA                   PIC 99.            ELCDTEVR
  1220     05  WS-AC-AH-CANCEL-DATE-N REDEFINES                            CL**2
  1221            WS-AC-AH-CANCEL-DATE               PIC 9(11).            CL**2
  1222 01  WS-RATE-RECORD.                                              ELCDTEVR
  1223         05  WS-RT-EXPIRY-DATE.                                   ELCDTEVR
  1224             10  FILLER                        PIC 999.           ELCDTEVR
  1225             10  RT-EXP-CCYY                   PIC 9(04).         ELCDTEVR
  1226             10  RT-EXP-CCYR  REDEFINES  RT-EXP-CCYY.             ELCDTEVR
  1227                 15  RT-EXP-CC                 PIC 99.            ELCDTEVR
  1228                 15  RT-EXP-YR                 PIC 99.            ELCDTEVR
  1229             10  RT-EXP-MO                     PIC 99.            ELCDTEVR
  1230             10  RT-EXP-DA                     PIC 99.            ELCDTEVR
  1231         05  WS-RT-EXPIRY-DATE-N REDEFINES                           CL**2
  1232                WS-RT-EXPIRY-DATE              PIC 9(11).            CL**2
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  27
* AHL064.cbl
  1234 PROCEDURE DIVISION.
  1235
  1236 0000-STANDARD-RTN.
* 1237                             COPY ELCDTERX.
  1238******************************************************************04/15/98
  1239*                                                                *ELCDTERX
  1240*                                                                *ELCDTERX
  1241*                            ELCDTERX.                           *   LV002
  1242*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  1243*                            VMOD=2.007                          *ELCDTERX
  1244*                                                                *ELCDTERX
  1245*      LOAD DATE CARD DISK FILE INTO WORKING STORAGE AREA        *ELCDTERX
  1246*      (COPY CODE FOR W/S = ELCDTECX AND COPY CODE FOR FD        *ELCDTERX
  1247*      = ELCDTEFD)                                               *ELCDTERX
  1248*                                                                *ELCDTERX
  1249******************************************************************ELCDTERX
  1250                                                                  ELCDTERX
  1251     ACCEPT WS-ACCEPT-DATE       FROM  DATE.                      ELCDTERX
  1252                                                                  ELCDTERX
  1253     MOVE WS-AD-YY               TO  WS-CD-YY.                    ELCDTERX
  1254     MOVE WS-AD-MM               TO  WS-CD-MM.                    ELCDTERX
  1255     MOVE WS-AD-DD               TO  WS-CD-DD.                    ELCDTERX
  1256                                                                  ELCDTERX
  1257     ACCEPT WS-TIME-OF-DAY       FROM  TIME.                      ELCDTERX
  1258                                                                  ELCDTERX
  1259******************************************************************ELCDTERX
  1260*    NOTE: THE FOLLOWING STATEMENT IS USED TO ELIMINATE COB II    ELCDTERX
  1261*          WARNING MESSAGES.                                      ELCDTERX
  1262******************************************************************ELCDTERX
  1263     IF WS-CD-YY = LOW-VALUES                                     ELCDTERX
  1264         COMPUTE PGM-SUB = PGM-SUB + 1.                           ELCDTERX
  1265                                                                  ELCDTERX
  1266     OPEN INPUT DISK-DATE.                                        ELCDTERX
  1267                                                                  ELCDTERX
  1268     MOVE SPACE TO DATE-CARD         CLAS-BUSINESS-CLASSES        ELCDTERX
  1269                   STATE-NAMES       CLAS-MORTALITY-CODES         ELCDTERX
  1270                   CLAS-INS-TYPES    COMPANY-NAME-TABLE           ELCDTERX
  1271                   DATE-CARD-OPTIONS DATE-CARD-FACTORS            ELCDTERX
  1272                   CLAX-ID           CLAS-MISC                    ELCDTERX
  1273                   CARRIER-NAMES     CLASIC-SYSTEM-CODES          ELCDTERX
  1274                   CARRIER-OPT-CLAIM-DATA                         ELCDTERX
  1275                   STATE-TARGET-LOSS-RATIOS                       ELCDTERX
  1276                   BUSINESS-TRGT-LOSS-RATIO-MODS                  ELCDTERX
  1277                   MISC-OPT-CLM-RSV-DATA.                         ELCDTERX
  1278                                                                  ELCDTERX
  1279     MOVE LOW-VALUES TO CLAS-INDEX-TBL CLAS-TYPE-MISC.            ELCDTERX
  1280                                                                  ELCDTERX
  1281     MOVE ZERO TO CLAS-CN DTE-TOT-LINES CLAS-CO                   ELCDTERX
  1282                  INDEXCA INDEXBS INDEXST.                        ELCDTERX
  1283                                                                  ELCDTERX
  1284     COMPUTE CLAS-CN = PGM-SUB / +50.                             ELCDTERX
  1285     COMPUTE CLAS-CO = PGM-SUB / +20.                             ELCDTERX
  1286     COMPUTE CLAS-INDEXEN = PGM-SUB - (CLAS-CN * +50).            ELCDTERX
  1287     COMPUTE CLAS-INDEXON = PGM-SUB - (CLAS-CO * +20).            ELCDTERX
  1288                                                                  ELCDTERX
  1289     IF CLAS-INDEXEN = ZERO                                       ELCDTERX
  1290         MOVE +50               TO CLAS-INDEXEN                   ELCDTERX
  1291     ELSE                                                         ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  28
* AHL064.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  1292         ADD +1                 TO CLAS-CN.                       ELCDTERX
  1293                                                                  ELCDTERX
  1294     IF CLAS-INDEXON = ZERO                                       ELCDTERX
  1295         MOVE +20               TO CLAS-INDEXON                   ELCDTERX
  1296     ELSE                                                         ELCDTERX
  1297         ADD +1                 TO CLAS-CO.                       ELCDTERX
  1298                                                                  ELCDTERX
  1299 0005-READ--CARD.                                                 ELCDTERX
  1300     READ DISK-DATE                                               ELCDTERX
  1301         AT END CLOSE DISK-DATE                                   ELCDTERX
  1302             GO TO 0060-READ--TEST.                               ELCDTERX
  1303                                                                  ELCDTERX
  1304     MOVE ZERO                   TO CLAS-INDEX.                   ELCDTERX
  1305                                                                  ELCDTERX
  1306     IF DD-ID = 'CLAS' OR 'LIFE' OR 'GLED'                        ELCDTERX
  1307         MOVE DATE-DISK          TO DATE-CARD                     ELCDTERX
  1308         MOVE RUN-DATE           TO WS-RUN-DATE-N                    CL**2
  1309         MOVE EP-DT              TO WS-EP-DT-N                       CL**2
  1310         GO TO 0005-READ--CARD.                                   ELCDTERX
  1311                                                                  ELCDTERX
  1312     IF DD-ID = 'CLAD'                                            ELCDTERX
  1313         MOVE DATE-DISK          TO DATE-CARD-OPTIONS             ELCDTERX
  1314         GO TO 0005-READ--CARD.                                   ELCDTERX
  1315                                                                  ELCDTERX
  1316     IF DD-ID = 'CLAX'                                            ELCDTERX
  1317         MOVE DATE-DISK          TO CLAS-INDEX-TBL                ELCDTERX
  1318         GO TO 0005-READ--CARD.                                   ELCDTERX
  1319                                                                  ELCDTERX
  1320     IF DD-ID = 'CLAF'                                            ELCDTERX
  1321         MOVE DATE-DISK          TO DATE-CARD-FACTORS             ELCDTERX
  1322         GO TO 0005-READ--CARD.                                   ELCDTERX
  1323                                                                  ELCDTERX
  1324     IF DD-ID = 'CLAC'                                            ELCDTERX
  1325         GO TO 0010-READ--CLAC.                                   ELCDTERX
  1326                                                                  ELCDTERX
  1327     IF DD-ID = 'CARR'                                            ELCDTERX
  1328         GO TO 0015-READ--CARR.                                   ELCDTERX
  1329                                                                  ELCDTERX
  1330     IF DD-ID = 'STAT'                                            ELCDTERX
  1331         GO TO 0020-READ--STAT.                                   ELCDTERX
  1332                                                                  ELCDTERX
  1333     IF DD-ID = 'BUSC'                                            ELCDTERX
  1334         GO TO 0025-READ--BUSC.                                   ELCDTERX
  1335                                                                  ELCDTERX
  1336     IF DD-ID = 'MORT'                                            ELCDTERX
  1337         GO TO 0030-READ--MORT.                                   ELCDTERX
  1338                                                                  ELCDTERX
  1339     IF DD-ID = 'CLAI'                                            ELCDTERX
  1340         GO TO 0040-READ--CLAI.                                   ELCDTERX
  1341                                                                  ELCDTERX
  1342     IF DD-ID = 'COLC'                                            ELCDTERX
  1343         GO TO 0065-READ--COLC.                                   ELCDTERX
  1344                                                                  ELCDTERX
  1345     IF DD-IDX NUMERIC AND                                        ELCDTERX
  1346        DD-IDA = 'CL'                                             ELCDTERX
  1347         GO TO 0035-READ--CLXX.                                   ELCDTERX
  1348                                                                  ELCDTERX
  1349     IF DD-IDX NUMERIC AND                                        ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  29
* AHL064.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  1350        DD-IDA = 'PO'                                             ELCDTERX
  1351         GO TO 0050-READ--POXX.                                   ELCDTERX
  1352                                                                  ELCDTERX
  1353     IF DD-ID = 'OPCA'                                            ELCDTERX
  1354         GO TO 0070-READ--OPCA.                                   ELCDTERX
  1355                                                                  ELCDTERX
  1356     IF DD-ID = 'OPST'                                            ELCDTERX
  1357         GO TO 0072-READ--OPST.                                   ELCDTERX
  1358                                                                  ELCDTERX
  1359     IF DD-ID = 'OPBS'                                            ELCDTERX
  1360         GO TO 0074-READ--OPBS.                                   ELCDTERX
  1361                                                                  ELCDTERX
  1362     IF DD-ID = 'OPMS'                                            ELCDTERX
  1363         MOVE DD-MISC-DATA       TO MISC-OPT-CLM-RSV-DATA.        ELCDTERX
  1364                                                                  ELCDTERX
  1365     GO TO 0005-READ--CARD.                                       ELCDTERX
  1366                                                                  ELCDTERX
  1367 0010-READ--CLAC.                                                 ELCDTERX
  1368     ADD 1                       TO CLAS-INDEXC.                  ELCDTERX
  1369     MOVE DD-CR1                 TO CNT-ID (CLAS-INDEXC).         ELCDTERX
  1370     MOVE DD-CR1N                TO CNT-NAME (CLAS-INDEXC).       ELCDTERX
  1371     ADD 1                       TO CLAS-INDEXC.                  ELCDTERX
  1372     MOVE DD-CR2                 TO CNT-ID (CLAS-INDEXC).         ELCDTERX
  1373     MOVE DD-CR2N                TO CNT-NAME (CLAS-INDEXC).       ELCDTERX
  1374     GO TO 0005-READ--CARD.                                       ELCDTERX
  1375                                                                  ELCDTERX
  1376 0015-READ--CARR.                                                 ELCDTERX
  1377     ADD 1  TO  CLAS-INDEXCN.                                     ELCDTERX
  1378     IF CLAS-INDEXCN LESS THAN +26                                ELCDTERX
  1379        MOVE DD-CARR1         TO CARRIER-SUB (CLAS-INDEXCN)
  1380        MOVE DD-CARR1S        TO CARRIER-DOM-ST (CLAS-INDEXCN)
  1381        MOVE DD-CARR1N        TO CARRIER-PIC (CLAS-INDEXCN)
  1382        MOVE DD-CARR1-UEP-PCT TO CARRIER-UEP-PCT (CLAS-INDEXCN)
  1383        MOVE DD-CARR1-R78-PCT TO CARRIER-R78-PCT (CLAS-INDEXCN)
  1384        MOVE DD-CARR1-PRO-PCT TO CARRIER-PRO-PCT (CLAS-INDEXCN)
  1385        MOVE DD-CARR1-SECPAY-SW
  1386                               TO CARRIER-SEC-PAY (CLAS-INDEXCN)
  1387     END-IF
  1388                                                                  ELCDTERX
  1389     ADD 1  TO  CLAS-INDEXCN.                                     ELCDTERX
  1390     IF CLAS-INDEXCN LESS THAN +26                                ELCDTERX
  1391        MOVE DD-CARR2         TO CARRIER-SUB (CLAS-INDEXCN)
  1392        MOVE DD-CARR2S        TO CARRIER-DOM-ST (CLAS-INDEXCN)
  1393        MOVE DD-CARR2N        TO CARRIER-PIC (CLAS-INDEXCN)
  1394        MOVE DD-CARR2-UEP-PCT TO CARRIER-UEP-PCT (CLAS-INDEXCN)
  1395        MOVE DD-CARR2-R78-PCT TO CARRIER-R78-PCT (CLAS-INDEXCN)
  1396        MOVE DD-CARR2-PRO-PCT TO CARRIER-PRO-PCT (CLAS-INDEXCN)
  1397        MOVE DD-CARR2-SECPAY-SW
  1398                              TO CARRIER-SEC-PAY (CLAS-INDEXCN)
  1399     END-IF
  1400                                                                  ELCDTERX
  1401                                                                  ELCDTERX
  1402     GO TO 0005-READ--CARD.                                       ELCDTERX
  1403                                                                  ELCDTERX
  1404 0020-READ--STAT.                                                 ELCDTERX
  1405     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  1406     IF CLAS-INDEX GREATER 3  OR                                  ELCDTERX
  1407        DD-ST (CLAS-INDEX) = SPACE                                ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  30
* AHL064.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  1408         GO TO 0005-READ--CARD.                                   ELCDTERX
  1409                                                                  ELCDTERX
  1410     ADD 1                       TO CLAS-INDEXS.                  ELCDTERX
  1411     MOVE DD-ST (CLAS-INDEX)     TO STATE-NAME-FLD (CLAS-INDEXS). ELCDTERX
  1412     GO TO 0020-READ--STAT.                                       ELCDTERX
  1413                                                                  ELCDTERX
  1414 0025-READ--BUSC.                                                 ELCDTERX
  1415     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  1416     IF CLAS-INDEX GREATER 3  OR                                  ELCDTERX
  1417        DD-ST (CLAS-INDEX) = SPACE                                ELCDTERX
  1418         GO TO 0005-READ--CARD.                                   ELCDTERX
  1419                                                                  ELCDTERX
  1420     ADD 1                       TO CLAS-INDEXB.                  ELCDTERX
  1421     MOVE DD-ST (CLAS-INDEX)     TO CLAS-BUSC-FLD (CLAS-INDEXB).  ELCDTERX
  1422     GO TO 0025-READ--BUSC.                                       ELCDTERX
  1423                                                                  ELCDTERX
  1424 0030-READ--MORT.                                                 ELCDTERX
  1425     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  1426     IF CLAS-INDEX GREATER 2  OR                                  ELCDTERX
  1427        DD-MORT (CLAS-INDEX) = SPACE                              ELCDTERX
  1428         GO TO 0005-READ--CARD.                                   ELCDTERX
  1429                                                                  ELCDTERX
  1430     ADD 1                       TO CLAS-INDEXM.                  ELCDTERX
  1431     MOVE DD-MORT (CLAS-INDEX)   TO CLAS-MORT-FLD (CLAS-INDEXM).  ELCDTERX
  1432     GO TO 0030-READ--MORT.                                       ELCDTERX
  1433                                                                  ELCDTERX
  1434 0035-READ--CLXX.                                                 ELCDTERX
  1435     IF DD-IDX NOT = CLAS-CN                                      ELCDTERX
  1436          GO TO 0005-READ--CARD.                                  ELCDTERX
  1437                                                                  ELCDTERX
  1438     IF DD-PS-PIC (CLAS-INDEXEN) = 'X'                            ELCDTERX
  1439         DISPLAY '***********************************************'ELCDTERX
  1440         DISPLAY 'PROGRAM ECS-', PGM-SUB, ' NOT SCHEDULED TO RUN' ELCDTERX
  1441         DISPLAY '***********************************************'ELCDTERX
  1442         GO TO 0055-READ--STOP.                                   ELCDTERX
  1443                                                                  ELCDTERX
  1444     IF DD-PS-PIC (CLAS-INDEXEN) NOT LESS 'A'  AND                ELCDTERX
  1445        DD-PS-PIC (CLAS-INDEXEN) NOT GREATER 'I'                  ELCDTERX
  1446         MOVE '1'                TO DTE-FICH.                     ELCDTERX
  1447                                                                  ELCDTERX
  1448     IF DD-PS-PIC (CLAS-INDEXEN) NOT LESS 'J'  AND                ELCDTERX
  1449        DD-PS-PIC (CLAS-INDEXEN) NOT GREATER 'R'                  ELCDTERX
  1450         MOVE '2'                TO DTE-FICH.                     ELCDTERX
  1451                                                                  ELCDTERX
  1452*    MOVE DD-PS-PIC (CLAS-INDEXEN) TO DTE-PGM-OPT.                ELCDTERX
  1453     GO TO 0005-READ--CARD.                                       ELCDTERX
  1454                                                                  ELCDTERX
  1455 0040-READ--CLAI.                                                 ELCDTERX
  1456     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  1457     IF CLAS-INDEX GREATER 2  OR                                  ELCDTERX
  1458        DD-TYPE (CLAS-INDEX) = SPACE                              ELCDTERX
  1459         GO TO 0005-READ--CARD.                                   ELCDTERX
  1460                                                                  ELCDTERX
  1461     ADD 1                       TO CLAS-INDEXA.                  ELCDTERX
  1462     MOVE DD-TYPE (CLAS-INDEX) TO CLAS-ALL-TYPES (CLAS-INDEXA).   ELCDTERX
  1463     GO TO 0040-READ--CLAI.                                       ELCDTERX
  1464                                                                  ELCDTERX
  1465 0045-READ--DUMP.                                                 ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  31
* AHL064.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  1466     MOVE +999 TO WS-RETURN-CODE                                  ELCDTERX
  1467     MOVE 'MISSING AND/OR INVALID CLAS DATE CARD'                 ELCDTERX
  1468                                 TO  WS-ABEND-MESSAGE             ELCDTERX
  1469     PERFORM ABEND-PGM.                                           ELCDTERX
  1470                                                                  ELCDTERX
  1471 0050-READ--POXX.                                                 ELCDTERX
  1472     IF DD-IDX NOT = CLAS-CO                                      ELCDTERX
  1473         GO TO 0005-READ--CARD.                                   ELCDTERX
  1474                                                                  ELCDTERX
  1475     IF DD-PS-PRC (CLAS-INDEXON) = 'X'                            ELCDTERX
  1476         DISPLAY '***********************************************'ELCDTERX
  1477         DISPLAY 'ECS - ', PGM-SUB, ' IS NOT SCHEDULED TO RUN'    ELCDTERX
  1478         DISPLAY '***********************************************'ELCDTERX
  1479         GO TO 0055-READ--STOP.                                   ELCDTERX
  1480                                                                  ELCDTERX
  1481     MOVE DD-PS-PRT (CLAS-INDEXON) TO DTE-PRT-OPT.                ELCDTERX
  1482     MOVE DD-PS-FMT (CLAS-INDEXON) TO DTE-FMT-OPT.                ELCDTERX
  1483     MOVE DD-PS-PRC (CLAS-INDEXON) TO DTE-PRC-OPT DTE-PGM-OPT.    ELCDTERX
  1484     MOVE DD-PS-TOT (CLAS-INDEXON) TO DTE-TOT-OPT.                ELCDTERX
  1485                                                                  ELCDTERX
  1486     IF DTE-PRT-OPT = 'B'                                         ELCDTERX
  1487         MOVE '2'                  TO DTE-FICH.                   ELCDTERX
  1488     IF DTE-PRT-OPT = 'F'                                         ELCDTERX
  1489         MOVE '1'                  TO DTE-FICH.                   ELCDTERX
  1490                                                                  ELCDTERX
  1491     GO TO 0005-READ--CARD.                                       ELCDTERX
  1492                                                                  ELCDTERX
  1493 0055-READ--STOP.                                                 ELCDTERX
  1494     GOBACK.                                                      ELCDTERX
  1495                                                                  ELCDTERX
  1496 0060-READ--TEST.                                                 ELCDTERX
  1497     IF DATX-COD        = SPACE  OR                               ELCDTERX
  1498        CLAX-ID         = SPACE  OR                               ELCDTERX
  1499        DATE-OPTIONS-ID = SPACE                                   ELCDTERX
  1500         GO TO 0045-READ--DUMP.                                   ELCDTERX
  1501                                                                  ELCDTERX
  1502     MOVE LOW-VALUE TO CLAS-TYPE-MISC.                            ELCDTERX
  1503     GO TO 0079-READ--EXIT.                                       ELCDTERX
  1504                                                                  ELCDTERX
  1505 0065-READ--COLC.                                                 ELCDTERX
  1506     MOVE DATE-DISK              TO CLASIC-SYSTEM-CODES.          ELCDTERX
  1507     GO TO 0005-READ--CARD.                                       ELCDTERX
  1508                                                                  ELCDTERX
  1509 0070-READ--OPCA.                                                 ELCDTERX
  1510                                                                  ELCDTERX
  1511     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  1512                                                                  ELCDTERX
  1513     IF  CLAS-INDEX GREATER 13                                    ELCDTERX
  1514             OR                                                   ELCDTERX
  1515         DD-CARR-FLDS (CLAS-INDEX) = SPACE                        ELCDTERX
  1516         GO TO 0005-READ--CARD.                                   ELCDTERX
  1517                                                                  ELCDTERX
  1518     ADD 1                       TO INDEXCA.                      ELCDTERX
  1519     MOVE DD-CARR-FLDS (CLAS-INDEX)                               ELCDTERX
  1520                                 TO CARRIER-FLDS (INDEXCA).       ELCDTERX
  1521     GO TO 0070-READ--OPCA.                                       ELCDTERX
  1522                                                                  ELCDTERX
  1523 0072-READ--OPST.                                                 ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  32
* AHL064.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  1524                                                                  ELCDTERX
  1525     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  1526                                                                  ELCDTERX
  1527     IF  CLAS-INDEX GREATER 16                                    ELCDTERX
  1528             OR                                                   ELCDTERX
  1529         DD-TLR (CLAS-INDEX) = SPACE                              ELCDTERX
  1530         GO TO 0005-READ--CARD.                                   ELCDTERX
  1531                                                                  ELCDTERX
  1532     ADD 1                       TO INDEXST.                      ELCDTERX
  1533     MOVE DD-STATE-FLDS (CLAS-INDEX)                              ELCDTERX
  1534                                 TO STATE-TLR-FLD (INDEXST).      ELCDTERX
  1535     GO TO 0072-READ--OPST.                                       ELCDTERX
  1536                                                                  ELCDTERX
  1537 0074-READ--OPBS.                                                 ELCDTERX
  1538                                                                  ELCDTERX
  1539     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  1540                                                                  ELCDTERX
  1541     IF  CLAS-INDEX GREATER 32                                    ELCDTERX
  1542             OR                                                   ELCDTERX
  1543         DD-TLR (CLAS-INDEX) = SPACE                              ELCDTERX
  1544         GO TO 0005-READ--CARD.                                   ELCDTERX
  1545                                                                  ELCDTERX
  1546     ADD 1                       TO INDEXBS.                      ELCDTERX
  1547     MOVE DD-TLR (CLAS-INDEX)    TO BUS-TLRM-FLD (INDEXBS).       ELCDTERX
  1548     GO TO 0074-READ--OPBS.                                       ELCDTERX
  1549                                                                  ELCDTERX
  1550 0079-READ--EXIT.                                                 ELCDTERX
  1551*    EXIT.                                                        ELCDTERX
  1552******************************************************************ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  33
* AHL064.cbl
  1554 1000-INITIALIZE-OUTPUT.
  1555     OPEN INPUT  COMM-MSTR-IN
  1556          OUTPUT PRNTR
  1557                 ME50-ECS064-BALANCE.
  1558
  1559     MOVE LOW-VALUE              TO  COMPENSATION-MASTER
  1560                                     COMP-IN-RECORD
  1561                                     CUR-CTL-1
  1562                                     PRE-CONTROL.
  1563     MOVE COMPANY-NAME           TO  HD-CO.
  1564     MOVE SPACES                 TO  SAVE-COMPANY-NAME.
  1565     MOVE ALPH-DATE              TO  HD-DT.
  1566     MOVE WS-CURRENT-DATE        TO  HD-RUN-DT.
  1567     MOVE SPACE-NP               TO  P-REC.
  1568
  1569     IF DTE-CLIENT = 'CID'
  1570         MOVE 'CILGM35'          TO  WS-ME50-BAL-JOB
  1571     ELSE
  1572       IF DTE-CLIENT = 'AHL'
  1573         MOVE 'AHLGM35'          TO  WS-ME50-BAL-JOB
  1574       ELSE
  1575         MOVE 'CIDCLGM35'        TO  WS-ME50-BAL-JOB
  1576       END-IF
  1577     END-IF.
  1578
  1579     GO TO 2000-PROCESS-RTN.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  34
* AHL064.cbl
  1581 2000-PROCESS-RTN.
  1582     PERFORM 8000-MSTR-CONTROL-RTN  THRU  8099-EXIT.
  1583
  1584     IF CO-CTL-1  IS NOT EQUAL TO  CUR-CTL-1
  1585         PERFORM 6000-BREAK-RTN  THRU  6999-EXIT.
  1586
  1587     IF CO-CTL-1  IS EQUAL TO  HIGH-VALUE
  1588         GO TO 9990-E-O-J.
  1589
  1590     IF CO-COMPANY-TYPE
  1591         GO TO 2000-PROCESS-RTN.
  1592
  1593******************************************************************
  1594*    APPLIES TO A/R USERS.
  1595*    DTE TOTAL OPTIONS IS TO ALLOW PROGRAM TO USE AMOUNTS THAT
  1596*    REPRESENT EITHER THE LAST MONTH END RUN OR THE LAST A/R CYCLE
  1597*    THAT WAS RUN (OPTION 2).
  1598******************************************************************
  1599
  1600     IF DTE-SYS-G-AR-USED NOT = '1' OR
  1601        DTE-TOT-OPT = '1'
  1602         MOVE CO-BAL-FWD         TO  COMP-AMT-BEG
  1603         MOVE CO-CUR-COM         TO  COMP-AMT-COM
  1604         MOVE CO-CUR-CHG         TO  COMP-AMT-CHG
  1605         MOVE CO-CUR-PMT         TO  COMP-AMT-PMT
  1606         MOVE CO-END-BAL         TO  COMP-AMT-END
  1607         MOVE CO-CUR             TO  COMP-AMT-CUR
  1608         MOVE CO-OV30            TO  COMP-AMT-OV30
  1609         MOVE CO-OV60            TO  COMP-AMT-OV60
  1610         MOVE CO-OV90            TO  COMP-AMT-OV90
  1611         MOVE CO-OV120           TO  COMP-AMT-OV120
  1612      ELSE
  1613         MOVE CO-CURRENT-BAL-FWD TO  COMP-AMT-BEG
  1614         MOVE CO-CURRENT-CUR-COM TO  COMP-AMT-COM
  1615         MOVE CO-CURRENT-CUR-CHG TO  COMP-AMT-CHG
  1616         MOVE CO-CURRENT-CUR-PMT TO  COMP-AMT-PMT
  1617         MOVE CO-CURRENT-END-BAL TO  COMP-AMT-END
  1618         MOVE CO-CURRENT-CUR     TO  COMP-AMT-CUR
  1619         MOVE CO-CURRENT-OV30    TO  COMP-AMT-OV30
  1620         MOVE CO-CURRENT-OV60    TO  COMP-AMT-OV60
  1621         MOVE CO-CURRENT-OV90    TO  COMP-AMT-OV90
  1622         MOVE CO-CURRENT-OV120   TO  COMP-AMT-OV120.
  1623
  1624     IF COMP-AMT-BEG      IS EQUAL TO +0
  1625       AND  COMP-AMT-COM  IS EQUAL TO +0
  1626       AND  COMP-AMT-CHG  IS EQUAL TO +0
  1627       AND  COMP-AMT-PMT  IS EQUAL TO +0
  1628       AND  COMP-AMT-END  IS EQUAL TO +0
  1629       AND  COMP-AMT-CUR  IS EQUAL TO +0
  1630       AND  COMP-AMT-OV30 IS EQUAL TO +0
  1631       AND  COMP-AMT-OV60 IS EQUAL TO +0
  1632       AND  COMP-AMT-OV90 IS EQUAL TO +0
  1633       AND  COMP-AMT-OV120 IS EQUAL TO +0
  1634         GO TO 2000-PROCESS-RTN.
  1635
  1636     SUBTRACT COMP-AMT-COM       FROM  COMP-AMT-CHG.
  1637
  1638     IF LNCTR  IS GREATER THAN  +056
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  35
* AHL064.cbl
  1639         PERFORM 8600-HD-RTN  THRU  8699-EXIT.
  1640
  1641     MOVE CO-RESP-NO             TO  P-RESP.
  1642     MOVE SPACE-2                TO  P-CCSW.
  1643
  1644     IF CO-ACCOUNT  IS NOT EQUAL TO  LOW-VALUE
  1645         MOVE CO-ACCOUNT         TO  P-ACCT.
  1646
  1647     PERFORM 8800-PRT-RTN  THRU  8800-EXIT.
  1648
  1649     MOVE CO-ACCT-NAME           TO  P-NAME.
  1650     MOVE COMP-AMT-BEG           TO  P-BEG.
  1651     MOVE COMP-AMT-CHG           TO  P-CHG.
  1652     MOVE COMP-AMT-PMT           TO  P-PMT.
  1653     MOVE COMP-AMT-END           TO  P-END.
  1654     MOVE COMP-AMT-OV30          TO  P-OV30.
  1655     MOVE COMP-AMT-OV60          TO  P-OV60.
  1656     MOVE COMP-AMT-OV90          TO  P-OV90.
  1657     MOVE COMP-AMT-OV120         TO  P-OV120.
  1658
  1659     PERFORM 8800-PRT-RTN  THRU  8800-EXIT.
  1660
  1661     ADD +1                      TO  G-CTR.
  1662     ADD COMP-AMT-BEG            TO  G-BEG.
  1663     ADD COMP-AMT-CHG            TO  G-CHG.
  1664     ADD COMP-AMT-PMT            TO  G-PMT.
  1665     ADD COMP-AMT-END            TO  G-END.
  1666     ADD COMP-AMT-OV30           TO  G-OV30.
  1667     ADD COMP-AMT-OV60           TO  G-OV60.
  1668     ADD COMP-AMT-OV90           TO  G-OV90.
  1669     ADD COMP-AMT-OV120          TO  G-OV120.
  1670
  1671     IF COMP-AMT-END IS GREATER THAN ZERO
  1672         ADD COMP-AMT-END        TO  G-DBT
  1673     ELSE
  1674         ADD COMP-AMT-END        TO  G-CRD.
  1675
  1676     GO TO 2000-PROCESS-RTN.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  36
* AHL064.cbl
  1678 6000-BREAK-RTN.
  1679     IF CUR-CTL-1  IS EQUAL TO  LOW-VALUE
  1680         GO TO 6500-INITIALIZE-ALL.
  1681
  1682 6100-AGENT-BREAK.
  1683     ADD G-BEG                   TO  S-BEG.
  1684     ADD G-CHG                   TO  S-CHG.
  1685     ADD G-PMT                   TO  S-PMT.
  1686     ADD G-END                   TO  S-END.
  1687     ADD G-OV30                  TO  S-OV30.
  1688     ADD G-OV60                  TO  S-OV60.
  1689     ADD G-OV90                  TO  S-OV90.
  1690     ADD G-OV120                 TO  S-OV120.
  1691     ADD G-DBT                   TO  S-DBT.
  1692     ADD G-CRD                   TO  S-CRD.
  1693
  1694     IF G-CTR  IS LESS THAN  +2
  1695         GO TO 6200-COMPANY-BREAK.
  1696
  1697     MOVE 'GENERAL AGENT TOTALS'  TO  P-NAME.
  1698
  1699     PERFORM 8800-PRT-RTN  THRU  8800-EXIT.
  1700
  1701     MOVE G-BEG                   TO  T-BEG.
  1702     MOVE G-PMT                   TO  T-PMT.
  1703     MOVE G-OV30                  TO  T-OV30.
  1704     MOVE G-OV90                  TO  T-OV90.
  1705
  1706     PERFORM 8800-PRT-RTN  THRU  8800-EXIT.
  1707
  1708     MOVE G-CHG                   TO  T-CHG.
  1709     MOVE G-END                   TO  T-END.
  1710     MOVE G-OV60                  TO  T-OV60.
  1711     MOVE G-OV120                 TO  T-OV120.
  1712
  1713     PERFORM 8800-PRT-RTN  THRU  8800-EXIT.
  1714
  1715     MOVE SPACE-2 TO P-CCSW.
  1716
  1717 6200-COMPANY-BREAK.
  1718     IF CUR-CARR-GROUP  IS EQUAL TO  CO-CARR-GROUP
  1719         GO TO 6800-INITIALIZE-GA.
  1720
  1721     MOVE 'COMPANY'              TO  P-MSG.
  1722     MOVE CUR-CARR               TO  P-CARR.
  1723     MOVE CUR-GROUP              TO  P-GROUP.
  1724     MOVE ' TOTALS'              TO  P-TOT-TITLE.
  1725
  1726     PERFORM 8800-PRT-RTN  THRU  8800-EXIT.
  1727
  1728     MOVE S-BEG                  TO  T-BEG.
  1729     MOVE S-PMT                  TO  T-PMT.
  1730     MOVE S-OV30                 TO  T-OV30.
  1731     MOVE S-OV90                 TO  T-OV90.
  1732     MOVE SPACE-2                TO  P-CCSW.
  1733
  1734     PERFORM 8800-PRT-RTN  THRU  8800-EXIT.
  1735
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  37
* AHL064.cbl
  1736     MOVE S-CHG                  TO  T-CHG.
  1737     MOVE S-END                  TO  T-END.
  1738     MOVE S-OV60                 TO  T-OV60.
  1739     MOVE S-OV120                TO  T-OV120.
  1740
  1741     PERFORM 8800-PRT-RTN  THRU  8800-EXIT.
  1742
  1743     MOVE 'TOTAL DEBIT BALANCE'  TO  P-NAME.
  1744     MOVE S-DBT                  TO  P-END.
  1745     MOVE SPACE-2                TO  P-CCSW.
  1746
  1747     PERFORM 8800-PRT-RTN  THRU  8800-EXIT.
  1748
  1749     MOVE 'TOTAL CREDIT BALANCE'  TO  P-NAME.
  1750     MOVE S-CRD                   TO  P-END.
  1751
  1752     PERFORM 8800-PRT-RTN  THRU  8800-EXIT.
  1753
  1754     ADD S-BEG                   TO  C-BEG.
  1755     ADD S-CHG                   TO  C-CHG.
  1756     ADD S-PMT                   TO  C-PMT.
  1757     ADD S-END                   TO  C-END.
  1758     ADD S-OV30                  TO  C-OV30.
  1759     ADD S-OV60                  TO  C-OV60.
  1760     ADD S-OV90                  TO  C-OV90.
  1761     ADD S-OV120                 TO  C-OV120.
  1762     ADD S-DBT                   TO  C-DBT.
  1763     ADD S-CRD                   TO  C-CRD.
  1764
  1765 6300-CARRIER-BREAK.
  1766     IF CO-CARRIER  IS EQUAL  TO CUR-CARR
  1767         GO TO 6700-INITIALIZE-COMPANY.
  1768
  1769     MOVE SPACES                 TO  CUR-GROUP.
  1770
  1771     PERFORM 8600-HD-RTN  THRU  8699-EXIT.
  1772
  1773     MOVE 'CARRIER'              TO  P-MSG.
  1774     MOVE CUR-CARR               TO  P-CARR.
  1775     MOVE ' TOTALS'              TO  P-TOT-TITLE.
  1776
  1777     PERFORM 8800-PRT-RTN  THRU  8800-EXIT.
  1778
  1779     MOVE C-BEG                  TO  T-BEG.
  1780     MOVE C-PMT                  TO  T-PMT.
  1781     MOVE C-OV30                 TO  T-OV30.
  1782     MOVE C-OV90                 TO  T-OV90.
  1783     MOVE SPACE-2                TO  P-CCSW.
  1784
  1785     PERFORM 8800-PRT-RTN  THRU  8800-EXIT.
  1786
  1787     MOVE C-CHG                  TO  T-CHG.
  1788     MOVE C-END                  TO  T-END.
  1789     MOVE C-OV60                 TO  T-OV60.
  1790     MOVE C-OV120                TO  T-OV120.
  1791
  1792     PERFORM 8800-PRT-RTN  THRU  8800-EXIT.
  1793
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  38
* AHL064.cbl
  1794     MOVE 'TOTAL DEBIT BALANCE'  TO  P-NAME.
  1795     MOVE C-DBT                  TO  P-END.
  1796     MOVE SPACE-2                TO  P-CCSW.
  1797
  1798     PERFORM 8800-PRT-RTN  THRU  8800-EXIT.
  1799
  1800     MOVE 'TOTAL CREDIT BALANCE'  TO  P-NAME.
  1801     MOVE C-CRD                   TO  P-END.
  1802
  1803     PERFORM 8800-PRT-RTN  THRU  8800-EXIT.
  1804
  1805     ADD C-BEG                   TO  F-BEG.
  1806     ADD C-CHG                   TO  F-CHG.
  1807     ADD C-PMT                   TO  F-PMT.
  1808     ADD C-END                   TO  F-END.
  1809     ADD C-OV30                  TO  F-OV30.
  1810     ADD C-OV60                  TO  F-OV60.
  1811     ADD C-OV90                  TO  F-OV90.
  1812     ADD C-OV120                 TO  F-OV120
  1813     ADD C-DBT                   TO  F-DBT.
  1814     ADD C-CRD                   TO  F-CRD.
  1815
  1816 6030-FINAL-BREAK.
  1817     IF CO-CTL-1  IS NOT EQUAL TO  HIGH-VALUE
  1818         GO TO 6600-INITIALIZE-CARRIER.
  1819
  1820     MOVE SPACES                 TO  CUR-CARR.
  1821
  1822     PERFORM 8600-HD-RTN  THRU  8699-EXIT.
  1823
  1824     MOVE 'FINAL TOTALS'         TO  P-TOT-TITLE.
  1825
  1826     PERFORM 8800-PRT-RTN  THRU  8800-EXIT.
  1827
  1828     MOVE F-BEG                  TO  T-BEG.
  1829     MOVE F-PMT                  TO  T-PMT.
  1830     MOVE F-OV30                 TO  T-OV30.
  1831     MOVE F-OV90                 TO  T-OV90.
  1832     MOVE SPACE-2                TO  P-CCSW.
  1833
  1834     PERFORM 8800-PRT-RTN  THRU  8800-EXIT.
  1835
  1836     MOVE F-CHG                  TO  T-CHG.
  1837     MOVE F-END                  TO  T-END.
  1838     MOVE F-OV60                 TO  T-OV60.
  1839     MOVE F-OV120                TO  T-OV120.
  1840
  1841     PERFORM 8800-PRT-RTN  THRU  8800-EXIT.
  1842
  1843     MOVE F-END                  TO WS-ME50-BAL-AMT-LOW.
  1844     MOVE F-END                  TO WS-ME50-BAL-AMT-HIGH.
  1845     MOVE WS-BAL50-DESCRIPTION   TO WS-ME50-BAL-DESCRIP.
  1846     WRITE ME50-ECS064-BALANCE-REC FROM WS-ME50-BALANCE-REC.
  1847
  1848     MOVE 'TOTAL DEBIT BALANCE'  TO  P-NAME.
  1849     MOVE F-DBT                  TO  P-END.
  1850     MOVE SPACE-2                TO  P-CCSW.
  1851
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  39
* AHL064.cbl
  1852     PERFORM 8800-PRT-RTN  THRU  8800-EXIT.
  1853
  1854     MOVE 'TOTAL CREDIT BALANCE'  TO  P-NAME.
  1855     MOVE F-CRD                   TO  P-END.
  1856
  1857     PERFORM 8800-PRT-RTN  THRU  8800-EXIT.
  1858
  1859     GO TO 6999-EXIT.
  1860
  1861 6500-INITIALIZE-ALL.
  1862     MOVE +0                     TO  F-BEG   F-CHG
  1863                                     F-PMT   F-END
  1864                                     F-OV30  F-OV60
  1865                                     F-OV90  F-DBT
  1866                                     F-CRD   F-OV120.
  1867
  1868 6600-INITIALIZE-CARRIER.
  1869     MOVE CO-CARRIER             TO  CUR-CARR.
  1870     MOVE +0                     TO  C-BEG   C-CHG
  1871                                     C-PMT   C-END
  1872                                     C-OV30  C-OV60
  1873                                     C-OV90  C-DBT
  1874                                     C-CRD   C-OV120.
  1875
  1876     IF SAVE-COMPANY-NAME  IS EQUAL TO  SPACES
  1877         MOVE COMPANY-NAME       TO  HD-CO
  1878     ELSE
  1879         MOVE SAVE-COMPANY-NAME  TO  HD-CO.
  1880
  1881 6700-INITIALIZE-COMPANY.
  1882     MOVE CO-GROUPING            TO  CUR-GROUP.
  1883     MOVE +0                     TO  S-BEG   S-CHG
  1884                                     S-PMT   S-END
  1885                                     S-OV30  S-OV60
  1886                                     S-OV90  S-DBT
  1887                                     S-CRD   S-OV120.
  1888
  1889     IF SAVE-COMPANY-NAME  IS EQUAL TO  SPACES
  1890         MOVE COMPANY-NAME       TO  HD-CO
  1891     ELSE
  1892         MOVE SAVE-COMPANY-NAME  TO  HD-CO.
  1893
  1894     MOVE +066                   TO  LNCTR.
  1895
  1896 6800-INITIALIZE-GA.
  1897     MOVE CO-RESP-NO             TO  CUR-RESP.
  1898     MOVE +0                     TO  G-CTR.
  1899     MOVE +0                     TO  G-BEG   G-CHG
  1900                                     G-PMT   G-END
  1901                                     G-OV30  G-OV60
  1902                                     G-OV90  G-DBT
  1903                                     G-CRD   G-OV120.
  1904
  1905 6999-EXIT.
  1906     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  40
* AHL064.cbl
  1908 8000-MSTR-CONTROL-RTN.
  1909     READ COMM-MSTR-IN
  1910         AT END
  1911             MOVE HIGH-VALUE     TO  COMP-IN-RECORD
  1912                                     COMPENSATION-MASTER
  1913             GO TO 8099-EXIT.
  1914
  1915     MOVE COMP-IN-RECORD         TO  COMPENSATION-MASTER.
  1916
  1917     IF CO-CTL-1  IS EQUAL TO  PRE-CTL-1
  1918         GO TO 8050-SET-NEW.
  1919
  1920 8010-RESET-CARRIER.
  1921     IF PRE-CARR  IS EQUAL TO  CO-CARRIER
  1922         GO TO 8020-RESET-COMPANY.
  1923
  1924     MOVE CO-CARRIER             TO  PRE-CARR.
  1925     MOVE SPACES                 TO  SAVE-COMPANY-NAME.
  1926
  1927 8020-RESET-COMPANY.
  1928     IF PRE-GROUP  IS EQUAL TO  CO-GROUPING
  1929         GO TO 8030-RESET-AGENT.
  1930
  1931     MOVE CO-GROUPING            TO  PRE-GROUP.
  1932
  1933 8030-RESET-AGENT.
  1934     MOVE CO-RESP-NO             TO  PRE-RESP.
  1935     MOVE 'A'                    TO  BALANCE-SW.
  1936
  1937 8050-SET-NEW.
  1938     IF CO-COMPANY-TYPE
  1939         GO TO 8080-SET-COMPANY.
  1940
  1941     IF CO-GEN-AGENT-TYPE
  1942         GO TO 8070-SET-AGENT.
  1943
  1944     IF NOT CO-ACCOUNT-TYPE
  1945         MOVE '0302'              TO  WS-RETURN-CODE
  1946         MOVE 'FATAL FILE ERROR'  TO  WS-ABEND-MESSAGE
  1947         GO TO ABEND-PGM.
  1948
  1949 8060-SET-ACCOUNT.
  1950     IF CO-NO-BALANCE
  1951         GO TO 8000-MSTR-CONTROL-RTN.
  1952
  1953     GO TO 8099-EXIT.
  1954
  1955 8070-SET-AGENT.
  1956     MOVE 'G'                    TO  BALANCE-SW.
  1957
  1958     GO TO 8099-EXIT.
  1959
  1960 8080-SET-COMPANY.
  1961     MOVE CO-ACCT-NAME           TO  SAVE-COMPANY-NAME.
  1962
  1963     GO TO 8099-EXIT.
  1964
  1965 8099-EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  41
* AHL064.cbl
  1966     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  42
* AHL064.cbl
  1968 8600-HD-RTN.
  1969     MOVE HD1                    TO  P-LINE.
  1970     MOVE SPACE-NP               TO  P-CCSW.
  1971
  1972     PERFORM 8800-PRT-RTN  THRU  8800-EXIT.
  1973
  1974     ADD +1                      TO  PGCTR.
  1975
  1976     MOVE PGCTR                  TO  HD-PG.
  1977     MOVE HD2                    TO  P-LINE.
  1978     MOVE SPACE-1                TO  P-CCSW.
  1979
  1980     PERFORM 8800-PRT-RTN  THRU  8800-EXIT.
  1981
  1982     MOVE HD3                    TO  P-LINE.
  1983     MOVE SPACE-1                TO  P-CCSW.
  1984
  1985     PERFORM 8800-PRT-RTN  THRU  8800-EXIT.
  1986
  1987     MOVE SPACE-2                TO  P-CCSW.
  1988     MOVE 'COMPANY'              TO  P-MSG.
  1989     MOVE CUR-CARR               TO  P-CARR.
  1990     MOVE CUR-GROUP              TO  P-GROUP.
  1991     MOVE '-'                    TO  P-DASH.
  1992
  1993     PERFORM 8800-PRT-RTN  THRU  8800-EXIT.
  1994
  1995     MOVE SPACE-2                TO  P-CCSW.
  1996     MOVE HD4                    TO  P-LINE.
  1997
  1998     PERFORM 8800-PRT-RTN  THRU  8800-EXIT.
  1999
  2000     MOVE HD5                    TO  P-LINE.
  2001
  2002     PERFORM 8800-PRT-RTN  THRU  8800-EXIT.
  2003
  2004     MOVE +10                    TO  LNCTR.
  2005     MOVE SPACE-2                TO  P-CCSW.
  2006
  2007 8699-EXIT.
  2008     EXIT.
  2009
  2010 8800-PRT-RTN.
  2011     MOVE P-REC                  TO  PRT.
  2012     MOVE P-CCSW                 TO  X.
  2013
  2014     IF P-CCSW  IS EQUAL TO  SPACE-1
  2015         ADD +1                  TO  LNCTR
  2016     ELSE
  2017         IF P-CCSW  IS EQUAL TO  SPACE-2
  2018             ADD +2              TO  LNCTR
  2019         ELSE
  2020             IF P-CCSW  IS EQUAL TO  SPACE-3
  2021                 ADD +3          TO  LNCTR.
  2022
  2023     MOVE SPACES                 TO  P-REC.
  2024     MOVE SPACE-1                TO  P-CCSW.
  2025
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  43
* AHL064.cbl
  2026 8850-COPY-PRT-RTN.
* 2027                             COPY ELCPRT2.
  2028******************************************************************04/15/98
  2029*                                                                *ELCPRT2
  2030*                                                                *ELCPRT2
  2031*                            ELCPRT2                             *   LV005
  2032*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**5
  2033*                            VMOD=2.002                          *   CL**5
  2034*                                                                *   CL**4
  2035******************************************************************   CL**4
  2036                                                                     CL**4
  2037     IF DTE-FICH NOT = SPACE AND                                     CL**4
  2038        FICH-OPEN    = SPACE                                         CL**4
  2039         MOVE 'X'                TO  FICH-OPEN                       CL**4
  2040         OPEN OUTPUT FICH.                                           CL**4
  2041                                                                     CL**4
  2042     IF DTE-FICH NOT = SPACE                                         CL**4
  2043         MOVE X                  TO  P-CTL                           CL**4
  2044         WRITE FICH-REC FROM PRT.                                    CL**4
  2045                                                                     CL**4
  2046     IF DTE-FICH = SPACE OR '2'                                      CL**4
  2047       MOVE X                    TO  P-CTL                           CL**4
  2048       IF P-CTL = ' '                                                CL**4
  2049         WRITE PRT AFTER ADVANCING 1 LINE                            CL**4
  2050       ELSE                                                          CL**4
  2051         IF P-CTL = '0'                                              CL**4
  2052           WRITE PRT AFTER ADVANCING 2 LINES                         CL**4
  2053         ELSE                                                        CL**4
  2054           IF P-CTL = '-'                                            CL**4
  2055             WRITE PRT AFTER ADVANCING 3 LINES                       CL**4
  2056           ELSE                                                      CL**4
  2057             WRITE PRT AFTER ADVANCING PAGE.                         CL**4
  2058                                                                     CL**4
  2059******************************************************************   CL**4
  2060
  2061 8800-EXIT.
  2062     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  44
* AHL064.cbl
  2064 9990-E-O-J.
* 2065                             COPY ELCPRTC.
  2066******************************************************************04/15/98
  2067*                                                                *ELCPRTC
  2068*                                                                *ELCPRTC
  2069*                            ELCPRTC.                            *   LV003
  2070*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
  2071*                            VMOD=2.002                          *   CL**2
  2072*       CLOSE FICH FILE IF OPEN                                  *ELCPRTC
  2073*                                                                *ELCPRTC
  2074* NOTE- USE ELCPRTCX IF USING ELCPRT2X (ONLINE REPORT SAVE)      *   CL**2
  2075******************************************************************ELCPRTC
  2076                                                                  ELCPRTC
  2077      IF FICH-OPEN NOT = SPACE                                    ELCPRTC
  2078          CLOSE FICH.                                             ELCPRTC
  2079                                                                  ELCPRTC
  2080******************************************************************ELCPRTC
  2081
  2082 9995-CLOSE.
  2083     CLOSE COMM-MSTR-IN
  2084           PRNTR
  2085           ME50-ECS064-BALANCE.
  2086
  2087     GOBACK.
  2088
  2089 ABEND-PGM SECTION.
* 2090                             COPY ELCABEND.
  2091***************************************************************** 04/14/98
  2092*                                                               * ELCABEND
  2093*                            ELCABEND.                          *    LV003
  2094*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
  2095*                            VMOD 2.002                              CL**2
  2096*                                                               * ELCABEND
  2097*                THIS SECTION DISPLAYS THE NECESSARY MESSAGES   * ELCABEND
  2098*            AND THEN ABENDS.                                   * ELCABEND
  2099*                                                               * ELCABEND
  2100*  NO  CID  MODS  IN  COPYBOOK  ELCABEND                        * ELCABEND
  2101*                                                               * ELCABEND
  2102***************************************************************** ELCABEND
  2103*APS-010.                                                         ELCABEND
  2104     DISPLAY WS-ABEND-MESSAGE.                                    ELCABEND
  2105     DISPLAY WS-ABEND-MESSAGE UPON CONSOLE.                       ELCABEND
  2106                                                                  ELCABEND
  2107     IF WS-ABEND-FILE-STATUS NOT = ZERO                           ELCABEND
  2108         DISPLAY 'FILE STATUS = ' WS-ABEND-FILE-STATUS            ELCABEND
  2109         DISPLAY 'FILE STATUS = ' WS-ABEND-FILE-STATUS            ELCABEND
  2110                                 UPON CONSOLE.                    ELCABEND
  2111                                                                  ELCABEND
  2112     IF WS-RETURN-CODE NOT = ZERO                                 ELCABEND
  2113         DISPLAY 'RETURN CODE = '  WS-RETURN-CODE                 ELCABEND
  2114         DISPLAY 'RETURN CODE = '  WS-RETURN-CODE                 ELCABEND
  2115                                 UPON CONSOLE.                    ELCABEND
  2116                                                                  ELCABEND
  2117     DISPLAY 'PROGRAM WILL NOW ABEND **************'              ELCABEND
  2118     DISPLAY 'PROGRAM WILL NOW ABEND **************'              ELCABEND
  2119                                 UPON CONSOLE.                    ELCABEND
  2120                                                                  ELCABEND
  2121     DIVIDE WS-ZERO BY WS-ZERO GIVING WS-ZERO.                    ELCABEND
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  45
* AHL064.cbl (/apps/prod/cid1p/copy/ELCABEND)
  2122     CALL 'ABORTME'.
  2123                                                                  ELCABEND
  2124 APS-EXIT.                                                        ELCABEND
  2125     EXIT.                                                        ELCABEND
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:       50928     Code:        6971
