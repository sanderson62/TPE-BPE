* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   1
* FNB180.cbl
* Options: int("FNB180.int") anim csi verbose NOBOUND PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("FNB180.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"ebmlsfile" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" NOCHECKDIV NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"32" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"FNB180.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"FNB180.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR NOSTICKY-LINKAGE
*          NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"2" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2 PROGRAM-ID.    FNB180.
     3
     4*:::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
     5*                                                                        :
     6*  THIS PROGRAM PRINTS A REPORT OF GENERAL LEDGER TRANSACTIONS           :
     7*  BY ACCOUNT NUMBER                                                     :
     8*                                                                        :
     9*  INPUT:   DETAIL FREEDOM GENERAL JOURNAL TRANSACTIONS                  :
    10*                                                                        :
    11*  OUTPUT:  SUMMARY REPORT BY ACCOUNT NUMBER                             :
    12*:::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
    13*    DATE    BY  MODIFICATION                                            :
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   2
* FNB180.cbl
    14* ========== === ========================================================:
    15* 02/03/2003 DJN CR2003020300003 CONVERT FROM MAINFRAME.                 :
    16* 07/28/2006 DJN DO NOT ADVANCE TO NEW PAGE ON FIRST PAGE OF REPORTS.    :
    17* 08/16/2006 AJR REMOVE FROM CLAIMS SYSTEM                               :
    18*:::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
    19
    20 ENVIRONMENT DIVISION.
    21 INPUT-OUTPUT SECTION.
    22 FILE-CONTROL.
    23
    24     SELECT SORT-FILE          ASSIGN TO EXTERNAL SORTWK.
    25
    26     SELECT TRANSACTION-DETAIL ASSIGN TO EXTERNAL SYS010
    27                               ORGANIZATION IS LINE SEQUENTIAL.
    28
    29     SELECT SUMMARY-REPORT     ASSIGN TO EXTERNAL SYS007
    30                               ORGANIZATION IS LINE SEQUENTIAL.
    31
    32 DATA DIVISION.
    33 FILE SECTION.
    34
    35 SD  SORT-FILE.
    36 01  SORT-RECORD.
*   37     COPY FNC019.
    38*****************************************************************
    39*                                                               *
    40*      FREEDOM GENERAL LEDGER JOURNAL TRANSACTION - CSO         *
    41*                                                               *
    42************************************************V5.50 12/21/98***
    43*
    44     05  GL-ACCOUNT-NO.
    45         10  GL-MAJ-ACCT       PIC X(10).
    46         10  GL-DIV            PIC X(2).
    47         10  GL-CENTER         PIC X(4).
    48         10  GL-PRODUCT        PIC X(6).
    49         10  GL-STATE          PIC X(2).
    50     05  GL-JOURNAL-DATE       PIC X(8).
    51     05  GL-POSTING-DATE       PIC X(8).
    52     05  GL-AMOUNT             PIC S9(10)V99
    53                               SIGN TRAILING SEPARATE.
    54     05  GL-REFERENCE          PIC X(10).
    55     05  GL-DESCRIPTION        PIC X(30).
    56     05  GL-SOURCE             PIC X(6).
    57     05  GL-SUNDRY             PIC X(30).
    58     05  GL-REVERSE-FLAG       PIC X.
    59     05  GL-SUSPENSE           PIC X(15).
    60     05  GL-ALLOC-CODE         PIC X(6).
    61
    62
    63 FD  TRANSACTION-DETAIL
    64     LABEL RECORDS ARE STANDARD
    65     RECORDING MODE IS F
    66     RECORD CONTAINS 151 CHARACTERS
    67     BLOCK CONTAINS 0 RECORDS.
    68 01  FILLER           PIC X(151).
    69
    70 FD  SUMMARY-REPORT
    71     LABEL RECORDS ARE STANDARD
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   3
* FNB180.cbl
    72     RECORDING MODE IS F
    73     RECORD CONTAINS 132 CHARACTERS
    74     BLOCK CONTAINS 0 RECORDS.
    75 01  PRINT-RECORD     PIC X(132).
    76
    77 WORKING-STORAGE SECTION.
    78
    79 01 RC                       PIC S9(9)   COMP-5 VALUE 0.
    80 01 LIST-REC                 PIC X(132).
    81
    82 01  FILLER.
    83     05  WS-WORK-ACCT.
    84         10  WS-MAJ-ACCT    PIC X(10)      VALUE SPACE.
    85         10  FILLER         PIC X          VALUE '-'.
    86         10  WS-DIV         PIC X(2)       VALUE SPACE.
    87         10  FILLER         PIC X          VALUE '-'.
    88         10  WS-CENTER      PIC X(4)       VALUE SPACE.
    89         10  FILLER         PIC X          VALUE '-'.
    90         10  WS-PRODUCT     PIC X(6)       VALUE SPACE.
    91         10  FILLER         PIC X          VALUE '-'.
    92         10  WS-STATE       PIC X(2)       VALUE SPACE.
    93
    94 01  FILLER                 COMP-3.
    95     05  SUB                PIC S9(3)      VALUE ZERO.
    96     05  LINE-COUNT         PIC S9(3)      VALUE ZERO.
    97     05  PAGE-COUNT         PIC S9(5)      VALUE ZERO.
    98     05  INPUT-COUNT        PIC S9(5)      VALUE ZERO.
    99         88  FIRST-RECORD                  VALUE +1.
   100     05  TOTALS             OCCURS 2 TIMES.
   101         10  WS-COUNT       PIC S9(7)      COMP-3.
   102         10  WS-DR-AMOUNT   PIC S9(11)V99  COMP-3.
   103         10  WS-CR-AMOUNT   PIC S9(11)V99  COMP-3.
   104
   105 01  SUMMARY-RECORD.
*  106     COPY FNC019 REPLACING LEADING ==GL== BY ==SUM==.
   107*****************************************************************
   108*                                                               *
   109*      FREEDOM GENERAL LEDGER JOURNAL TRANSACTION - CSO         *
   110*                                                               *
   111************************************************V5.50 12/21/98***
   112*
   113     05  SUM-ACCOUNT-NO.
   114         10  SUM-MAJ-ACCT       PIC X(10).
   115         10  SUM-DIV            PIC X(2).
   116         10  SUM-CENTER         PIC X(4).
   117         10  SUM-PRODUCT        PIC X(6).
   118         10  SUM-STATE          PIC X(2).
   119     05  SUM-JOURNAL-DATE       PIC X(8).
   120     05  SUM-POSTING-DATE       PIC X(8).
   121     05  SUM-AMOUNT             PIC S9(10)V99
   122                               SIGN TRAILING SEPARATE.
   123     05  SUM-REFERENCE          PIC X(10).
   124     05  SUM-DESCRIPTION        PIC X(30).
   125     05  SUM-SOURCE             PIC X(6).
   126     05  SUM-SUNDRY             PIC X(30).
   127     05  SUM-REVERSE-FLAG       PIC X.
   128     05  SUM-SUSPENSE           PIC X(15).
   129     05  SUM-ALLOC-CODE         PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   4
* FNB180.cbl
   130
   131
   132 01  HEADING-LINE-1.
   133     05  FILLER      PIC X(09)   VALUE 'FNB180 - '.
   134     05  HDG-NOTE    PIC X(35)   VALUE SPACE.
   135     05  FILLER      PIC X(47)   VALUE
   136         'A C C O U N T   S U M M A R Y   L I S T'.
   137     05  FILLER      PIC X(17)   VALUE SPACE.
   138     05  HDG-DATE    PIC XX/XX/XXXX.
   139     05  FILLER      PIC X(8)    VALUE '   PAGE '.
   140     05  HDG-PAGE    PIC ZZ,ZZ9  VALUE ZERO.
   141
   142 01  HEADING-LINE-2.
   143     05  FILLER      PIC X(28)   VALUE 'ACCOUNT NO'.
   144     05  FILLER      PIC XXX     VALUE SPACE.
   145     05  FILLER      PIC X(16)   VALUE '       DR AMOUNT'.
   146     05  FILLER      PIC XX      VALUE SPACE.
   147     05  FILLER      PIC X(16)   VALUE '       CR AMOUNT'.
   148     05  FILLER      PIC XX      VALUE SPACE.
   149     05  FILLER      PIC X(16)   VALUE '             NET'.
   150     05  FILLER      PIC XXX     VALUE SPACE.
   151     05  FILLER      PIC X(09)   VALUE '    COUNT'.
   152
   153 01  HEADING-LINE-3.
   154     05  FILLER      PIC X(28)   VALUE ALL '-'.
   155     05  FILLER      PIC XXX     VALUE SPACE.
   156     05  FILLER      PIC X(16)   VALUE ALL '-'.
   157     05  FILLER      PIC XX      VALUE SPACE.
   158     05  FILLER      PIC X(16)   VALUE ALL '-'.
   159     05  FILLER      PIC XX      VALUE SPACE.
   160     05  FILLER      PIC X(16)   VALUE ALL '-'.
   161     05  FILLER      PIC XXX     VALUE SPACE.
   162     05  FILLER      PIC X(9)    VALUE ALL '-'.
   163
   164 01  PRINT-LINE             VALUE SPACE.
   165     05  PRT-ACCOUNT        PIC X(28).
   166     05  FILLER             PIC XXX.
   167     05  PRT-DR-AMT         PIC Z,ZZZ,ZZZ,ZZZ.99.
   168     05  FILLER             PIC XX.
   169     05  PRT-CR-AMT         PIC Z,ZZZ,ZZZ,ZZZ.99.
   170     05  FILLER             PIC XX.
   171     05  PRT-NET-AMT        PIC Z,ZZZ,ZZZ,ZZZ.99-.
   172     05  FILLER             PIC XX.
   173     05  PRT-COUNT          PIC Z,ZZZ,ZZ9.
   174
   175*    EXEC SQL INCLUDE ISTDWORK.INC END-EXEC.
   176
   177 01  PARM.
   178*    05  PARM-NOTE      PIC X(50).
   179     05  PARM-NOTE      PIC X(50)  VALUE 'CSO PAYROLL'.
   180
   181 PROCEDURE DIVISION.
   182
   183*    CALL IGETPARM USING IG-P1
   184*    MOVE IG-P1 TO PARM-NOTE
   185
   186     CALL 'FNBLIST' USING 'O' LIST-REC
   187     MOVE PARM-NOTE TO HDG-NOTE
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   5
* FNB180.cbl
   188     OPEN OUTPUT SUMMARY-REPORT
   189     INITIALIZE TOTALS (1) TOTALS (2)
   190
   191     SORT SORT-FILE ON ASCENDING KEY GL-ACCOUNT-NO
   192             USING TRANSACTION-DETAIL
   193             OUTPUT PROCEDURE IS 1000-PRINT-REPORT
   194
   195     IF SORT-RETURN NOT = +0
   196       DISPLAY '*** FNB180 INTERNAL SORT FAILED ***' UPON SYSERR
   197       MOVE    '*** FNB180 INTERNAL SORT FAILED ***' TO LIST-REC
   198       CALL 'FNBLIST' USING 'W' LIST-REC
   199       CALL 'FNBLIST' USING 'C' LIST-REC
   200       MOVE 16 TO RC
   201*      GOBACK GIVING RC
   202       STOP RUN GIVING RC
   203     END-IF
   204
   205     IF INPUT-COUNT = ZERO
   206       DISPLAY '*** INPUT FILE IS EMPTY ***' UPON SYSERR
   207       MOVE    '*** INPUT FILE IS EMPTY ***' TO LIST-REC
   208       CALL 'FNBLIST' USING 'W' LIST-REC
   209       CALL 'FNBLIST' USING 'C' LIST-REC
   210       MOVE 4 TO RC
   211*      GOBACK GIVING RC
   212       STOP RUN GIVING RC
   213     ELSE
   214       PERFORM 2000-ACCOUNT-TOTAL
   215       IF LINE-COUNT > +50
   216         PERFORM 8000-HEADING
   217       END-IF
   218       MOVE '*** BATCH TOTAL ***' TO PRINT-LINE
   219       MOVE WS-DR-AMOUNT (2) TO PRT-DR-AMT
   220       MOVE WS-CR-AMOUNT (2) TO PRT-CR-AMT
   221       MOVE WS-COUNT     (2) TO PRT-COUNT
   222       ADD WS-CR-AMOUNT (2), WS-DR-AMOUNT (2) GIVING PRT-NET-AMT
   223       WRITE PRINT-RECORD FROM PRINT-LINE AFTER ADVANCING 3 LINES
   224     END-IF
   225
   226     CLOSE SUMMARY-REPORT
   227     CALL 'FNBLIST' USING 'C' LIST-REC
   228
   229*    GOBACK GIVING RC.
   230     STOP RUN GIVING RC.
   231
   232 1000-PRINT-REPORT.
   233
   234     PERFORM UNTIL EXIT
   235       RETURN SORT-FILE
   236         AT END EXIT PERFORM
   237       END-RETURN
   238       ADD +1 TO INPUT-COUNT
   239
   240       IF FIRST-RECORD
   241         MOVE SORT-RECORD TO SUMMARY-RECORD
   242         MOVE GL-JOURNAL-DATE TO HDG-DATE
   243         PERFORM 8000-HEADING
   244       END-IF
   245
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   6
* FNB180.cbl
   246       IF GL-ACCOUNT-NO NOT = SUM-ACCOUNT-NO
   247         PERFORM 2000-ACCOUNT-TOTAL
   248       END-IF
   249
   250       ADD +1 TO WS-COUNT (1)
   251       IF GL-AMOUNT IS NEGATIVE
   252         ADD GL-AMOUNT TO WS-CR-AMOUNT (1)
   253       ELSE
   254         ADD GL-AMOUNT TO WS-DR-AMOUNT (1)
   255       END-IF
   256     END-PERFORM.
   257
   258 2000-ACCOUNT-TOTAL.
   259
   260     MOVE SUM-MAJ-ACCT     TO WS-MAJ-ACCT
   261     MOVE SUM-DIV          TO WS-DIV
   262     MOVE SUM-CENTER       TO WS-CENTER
   263     MOVE SUM-PRODUCT      TO WS-PRODUCT
   264     MOVE SUM-STATE        TO WS-STATE
   265     MOVE WS-WORK-ACCT     TO PRT-ACCOUNT
   266     MOVE WS-COUNT     (1) TO PRT-COUNT
   267     MOVE WS-DR-AMOUNT (1) TO PRT-DR-AMT
   268     MOVE WS-CR-AMOUNT (1) TO PRT-CR-AMT
   269     ADD WS-CR-AMOUNT (1), WS-DR-AMOUNT (1) GIVING PRT-NET-AMT
   270     WRITE PRINT-RECORD FROM PRINT-LINE AFTER ADVANCING 1 LINE
   271     ADD +1 TO LINE-COUNT
   272     IF LINE-COUNT > +55
   273       PERFORM 8000-HEADING
   274     END-IF
   275
   276     ADD WS-COUNT     (1) TO  WS-COUNT     (2)
   277     ADD WS-DR-AMOUNT (1) TO  WS-DR-AMOUNT (2)
   278     ADD WS-CR-AMOUNT (1) TO  WS-CR-AMOUNT (2)
   279     MOVE +0  TO  WS-COUNT     (1)
   280     MOVE +0  TO  WS-DR-AMOUNT (1)
   281     MOVE +0  TO  WS-CR-AMOUNT (1)
   282     MOVE SORT-RECORD TO SUMMARY-RECORD.
   283
   284 8000-HEADING.
   285
   286     ADD +1 TO PAGE-COUNT
   287     MOVE PAGE-COUNT TO HDG-PAGE
   288     IF PAGE-COUNT = 1
   289       WRITE PRINT-RECORD FROM HEADING-LINE-1
   290                                           AFTER ADVANCING 0 LINES
   291     ELSE
   292       WRITE PRINT-RECORD FROM HEADING-LINE-1 AFTER ADVANCING PAGE
   293     END-IF
   294     WRITE PRINT-RECORD FROM HEADING-LINE-2 AFTER ADVANCING 2 LINE
   295     WRITE PRINT-RECORD FROM HEADING-LINE-3 AFTER ADVANCING 1 LINE
   296     MOVE SPACES TO PRINT-RECORD
   297     WRITE PRINT-RECORD AFTER ADVANCING 1 LINE
   298     MOVE +5 TO LINE-COUNT.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:        3192     Code:        1927
