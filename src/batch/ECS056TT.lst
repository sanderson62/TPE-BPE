* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   1
* ECS056TT.cbl
* Options: int("ECS056TT.int") anim csi verbose NOBOUND PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("ECS056TT.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"ebmlsfile" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" NOCHECKDIV NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"32" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"ECS056TT.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST
*          "ECS056TT.lst" LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0"
*          NOMAPNAME NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT
*          NOMOVELENCHECK NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT
*          NONCHAR NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR NOSTICKY-LINKAGE
*          NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"2" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2 PROGRAM-ID.    ECS056.
     3 AUTHOR.        CENTRAL STATES HEALTH AND LIFE.
     4 DATE-COMPILED. 06-Oct-15 17:18.
     6*REMARKS.
     7*    THIS PROGRAM READS THE MONTH END CERT FILE AND CLMS FILE
     8*    AND BUILDS AN EXTRACT BY ISSUE YEAR.  THE EXTRACT IS
     9*    PRIMARLIY USED BY ACTUARIAL.  THE REFUNDS SELECTED ARE
    10*    PLACED IN THE VALUATION YEAR BASED ON THE CANCEL DATE.
    11*    THE CLAIMS SELECTED ARE PLACED IN THE VALUATION YEAR
    12*    BASED ON INCURRED DATE.  THE LOWEST ISSUE YEAR WILL ALWAYS
    13*    BE 1986.  IF YOU NEED TO CHANGE THAT SIMPLY CHANGE THE
    14*    HARD CODING WHERE YOU FIND MOVE 1986 TO LO-ISSUE AND
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   2
* ECS056TT.cbl
    15*    LO-VALUATION.  ANY CHANGES MADE TO THE SPECIAL ECS083
    16*    MUST ALSO BE MADE IN THIS PROGRAM.
    18 ENVIRONMENT DIVISION.
    19 INPUT-OUTPUT SECTION.
    20 FILE-CONTROL.
    21
    22     SELECT CERTS        ASSIGN TO SYS010.
    23     SELECT EXTRACT      ASSIGN TO SYS011
    24        ORGANIZATION IS LINE SEQUENTIAL.
    25     SELECT DISK-DATE    ASSIGN TO SYS019.
    26     SELECT PRINTX       ASSIGN TO SYS008.
    27
    28 DATA DIVISION.
    29 FILE SECTION.
    30
    31
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   3
* ECS056TT.cbl
    33 FD  CERTS
*   34                                 COPY ECSCRIFD.
    35******************************************************************07/10/97
    36*                                                                *ECSCRIFD
    37*                            ECSCRIFD                            *   LV001
    38*                            VMOD 2.005                          *ECSCRIFD
    39*                                                                *ECSCRIFD
    40*  NO CID MODS FOR COPYBOOK ECSCRIFD                             *ECSCRIFD
    41*                                                                *ECSCRIFD
    42******************************************************************ECSCRIFD
    43     BLOCK CONTAINS 0 RECORDS
    44     RECORDING MODE F.                                            ECSCRIFD
    45                                                                  ECSCRIFD
    46 01  CERT-IN-RECORD.                                              ECSCRIFD
    47                                                                  ECSCRIFD
    48     12  FILLER                            PIC XXX.               ECSCRIFD
    49     12  CIR-CONTROL                       PIC X(36).             ECSCRIFD
    50     12  FILLER                            PIC X(66).             ECSCRIFD
    51     12  CIR-JOINT-AGE                     PIC 99.                ECSCRIFD
    52     12  FILLER                            PIC X(20).             ECSCRIFD
    53     12  CIR-LFTYP                         PIC XX.                ECSCRIFD
    54     12  FILLER                            PIC X(14).             ECSCRIFD
    55     12  CIR-LFAMT                         PIC S9(9)V99   COMP-3. ECSCRIFD
    56     12  FILLER                            PIC X(39).             ECSCRIFD
    57     12  CIR-LFRFND-CALC                   PIC S9(7)V99   COMP-3. ECSCRIFD
    58     12  FILLER                            PIC X(45).             ECSCRIFD
    59     12  CIR-AHTYP                         PIC XX.                ECSCRIFD
    60     12  FILLER                            PIC X(35).             ECSCRIFD
    61     12  CIR-AHRFND-CALC                   PIC S9(7)V99   COMP-3. ECSCRIFD
    62     12  FILLER                            PIC X(41).             ECSCRIFD
    63     12  CIR-APR                           PIC S999V9(4)  COMP-3. ECSCRIFD
    64     12  FILLER                            PIC X(48).             ECSCRIFD
    65     12  CIR-REIN-TABLE                    PIC XXX.               ECSCRIFD
    66     12  FILLER                            PIC X(9).              ECSCRIFD
    67     12  CIR-SUM-CAN-CNT-YTD               PIC S999       COMP-3. ECSCRIFD
    68     12  FILLER                            PIC X(120).            ECSCRIFD
    69     12  CIR-DTHAMT-YTD                    PIC S9(9)V99   COMP-3. ECSCRIFD
    70     12  FILLER                            PIC X(73).             ECSCRIFD
    71     12  CIR-DISAMT-YTD                    PIC S9(9)V99   COMP-3. ECSCRIFD
    72     12  FILLER                            PIC X(464).            ECSCRIFD
    73                                                                  ECSCRIFD
    74******************************************************************ECSCRIFD
*   75                                 COPY ECSCRT01.
    76******************************************************************
    77*                                                                *
    78*                            ECSCRT01                            *
    79*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
    80*                            VMOD=2.016                          *
    81*                                                                *
    82*   FILE DESCRIPTION = CERTIFICATE RECORD    (OFF-LINE)          *
    83*                                                                *
    84*   FILE TYPE = SEQUENTIAL
    85*   RECORD SIZE = 1056 RECFORM = FIXED                           *
    86*                                                                *
    87*   KEY DATA =                         START=4, LEN=36           *
    88*                                                                *
    89*  NO  CID  MODS  IN  COPYBOOK  ECSCRT01                         *
    90*                                                                *
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   4
* ECS056TT.cbl (/apps/prod/cid1p/copy/ECSCRT01)
    91******************************************************************
    92******************************************************************
    93*                   C H A N G E   L O G
    94*
    95* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    96*-----------------------------------------------------------------
    97*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    98* EFFECTIVE    NUMBER
    99*-----------------------------------------------------------------
   100* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
   101* 100703    2003080800002  PEMA  ADD SUPER GAP PROCESSING
   102* 040504    2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
   103* 020305    2005020000000  PEMA  ADD CLP STATE TO CERT RECORD
   104* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
   105* 042408    2007110500003  PEMA  ADD REFUND INTEREST PROCESSING
   106* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
   107* 032612  CR2011110200001  PEMA  AHL CHANGES
   108* 052814  CR2014012300001  PEMA  DCC CREDIT UNION CHANGES
   109* 090314  CR2014081300001  PEMA  LOAD CERTS INVOLVED IN THAO
   110******************************************************************
   111
   112 01  CERTIFICATE-RECORD.
   113     12  CR-RECORD-ID                      PIC XX.
   114         88  VALID-CR-ID                      VALUE 'CR'.
   115
   116     12  CR-COMPANY-CD                     PIC X.
   117
   118     12  CR-FULL-CONTROL.
   119         16  CR-CONTROL-1.
   120             20  CR-ACCT-CONTROL.
   121                 24  CR-CARRIER            PIC X.
   122                 24  CR-GROUPING.
   123                     28  CR-GROUP-PREFIX   PIC XXX.
   124                     28  CR-GROUP-PRIME    PIC XXX.
   125                 24  CR-STATE              PIC XX.
   126                 24  CR-ACCOUNT.
   127                     28  CR-ACCT-PREFIX    PIC X(4).
   128                     28  CR-ACCT-PRIME     PIC X(6).
   129             20  CR-DT                     PIC 9(11)  COMP-3.
   130         16  CR-CERT-NO.
   131             20  CR-CERT.
   132                 24  CR-CERT-PREFIX        PIC X(3).
   133                 24  CR-CERT-PRIME         PIC X(7).
   134             20  CR-CERT-SFX               PIC X.
   135
   136     12  CR-INSUREDS-PROFILE.
   137         16  CR-NAME.
   138             20  CR-LNAME                  PIC X(15).
   139             20  CR-FNAME.
   140                 24  CR-1ST-INITIAL        PIC X.
   141                 24  FILLER                PIC X(9).
   142             20  CR-INIT                   PIC X.
   143         16  CR-AGE                        PIC 99.
   144         16  CR-SEX                        PIC X.
   145             88  CR-SEX-MALE                  VALUE 'M'.
   146             88  CR-SEX-FEMALE                VALUE 'F'.
   147         16  CR-SOC-SEC                    PIC X(11).
   148         16  CR-JOINT-NAME.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   5
* ECS056TT.cbl (/apps/prod/cid1p/copy/ECSCRT01)
   149             20  CR-JT-LNAME               PIC X(15).
   150             20  CR-JT-FNAME.
   151                 24  CR-JT-1ST-INIT        PIC X.
   152                 24  FILLER                PIC X(9).
   153             20  CR-JT-INIT                PIC X.
   154         16  CR-JOINT-AGE                  PIC 99.
   155
   156         16  cr-ahl-ah-claim-no            pic x(9).
   157         16  cr-ahl-ah-cert-seq            pic x(3).
   158         16  cr-hst-proc-lf                pic x.
   159         16  f                             pic x(7).
   160
   161     12  CR-LF-COVERAGE-DATA.
   162         16  CR-LFTYP                      PIC XX.
   163         16  CR-LF-TERM                    PIC S999       COMP-3.
   164         16  CR-LF-CRIT-PERIOD             PIC S999       COMP-3.
   165         16  CR-LF-TERM-IN-DAYS            PIC S9(5)      COMP-3.
   166         16  CR-LF-DEV-CODE                PIC XXX.
   167         16  CR-LF-DEV-PCT                 PIC S9V9(6)    COMP-3.
   168
   169         16  CR-LFAMT                      PIC S9(9)V99   COMP-3.
   170         16  CR-LFPRM                      PIC S9(7)V99   COMP-3.
   171         16  CR-LFPRM-CALC                 PIC S9(7)V99   COMP-3.
   172         16  CR-LFPRM-RATE                 PIC S99V9(5)   COMP-3.
   173
   174         16  CR-LFAMT-ALT                  PIC S9(9)V99   COMP-3.
   175         16  CR-LFPRM-ALT                  PIC S9(7)V99   COMP-3.
   176         16  CR-LFPRM-CALC-ALT             PIC S9(7)V99   COMP-3.
   177         16  CR-LFPRM-RATE-ALT             PIC S99V9(5)   COMP-3.
   178
   179         16  CR-LFRFND                     PIC S9(7)V99   COMP-3.
   180         16  CR-LFRFND-CALC                PIC S9(7)V99   COMP-3.
   181
   182         16  CR-LF-NSP-PRM                 PIC S9(7)V99   COMP-3.
   183         16  CR-LF-NSP-PRM-RATE            PIC S99V9(5)   COMP-3.
   184
   185         16  CR-LF-REFUND-TYPE             PIC X.
   186         16  CR-LF-POLICY-FEE              PIC S9(3)V99   COMP-3.
   187
   188         16  CR-LF-COMM-CHARGEBACK         PIC X.
   189             88  CR-NO-LF-CHARGEBACK          VALUE 'N'.
   190
   191         16  CR-LF-REI-RISK-PRM            PIC S9(7)V99   COMP-3.
   192
   193         16  CR-LF-EXPIRE-DATE             PIC 9(11)      COMP-3.
   194         16  CR-LF-ISS-PREM-TAX            PIC S9V9(4)    COMP-3.
   195         16  CR-LF-CNC-PREM-TAX            PIC S9V9(4)    COMP-3.
   196
   197         16  cr-ahl-lf-claim-no            pic x(9).
   198         16  cr-ahl-lf-cert-seq            pic x(3).
   199         16  FILLER                        PIC XX.
   200
   201     12  CR-AH-COVERAGE-DATA.
   202         16  CR-AHTYP                      PIC XX.
   203         16  CR-AH-TERM                    PIC S999       COMP-3.
   204         16  CR-AH-CRIT-PERIOD             PIC S999       COMP-3.
   205         16  CR-AH-DEV-CODE                PIC XXX.
   206         16  CR-AH-DEV-PCT                 PIC S9V9(6)    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   6
* ECS056TT.cbl (/apps/prod/cid1p/copy/ECSCRT01)
   207
   208         16  CR-AHAMT                      PIC S9(7)V99   COMP-3.
   209         16  CR-AHPRM                      PIC S9(7)V99   COMP-3.
   210         16  CR-AHPRM-CALC                 PIC S9(7)V99   COMP-3.
   211         16  CR-AHPRM-RATE                 PIC S99V9(5)   COMP-3.
   212
   213         16  CR-AHRFND                     PIC S9(7)V99   COMP-3.
   214         16  CR-AHRFND-CALC                PIC S9(7)V99   COMP-3.
   215
   216         16  CR-AH-NSP-PRM                 PIC S9(7)V99   COMP-3.
   217         16  CR-AH-NSP-PRM-RATE            PIC S99V9(5)   COMP-3.
   218
   219         16  CR-AH-REFUND-TYPE             PIC X.
   220         16  CR-AH-POLICY-FEE              PIC S9(3)V99   COMP-3.
   221
   222         16  CR-AH-COMM-CHARGEBACK         PIC X.
   223             88  CR-NO-AH-CHARGEBACK          VALUE 'N'.
   224
   225         16  CR-AH-REI-RISK-PRM            PIC S9(7)V99   COMP-3.
   226
   227         16  CR-AH-EXPIRE-DATE             PIC 9(11)      COMP-3.
   228         16  CR-AH-ISS-PREM-TAX            PIC S9V9(4)    COMP-3.
   229         16  CR-AH-CNC-PREM-TAX            PIC S9V9(4)    COMP-3.
   230
   231         16  FILLER                        PIC XX.
   232*        16  FILLER                        PIC X(8).
   233
   234     12  CR-LOAN-DATA.
   235         16  CR-LIVES                      PIC S9(7)      COMP-3.
   236         16  CR-DDF-IU-RATE-UP REDEFINES CR-LIVES
   237                                           PIC S9(5)V99   COMP-3.
   238         16  CR-BILLED                     PIC S9(7)      COMP-3.
   239         16  CR-APR                        PIC S999V9(4)  COMP-3.
   240         16  CR-PMT-FREQ                   PIC 99.
   241         16  CR-LOAN-TERM                  PIC S999       COMP-3.
   242         16  CR-RATING-CLASS               PIC XX.
   243         16  CR-POLICY-FORM-NO             PIC X(12).
   244         16  CR-GRPTYP                     PIC XX.
   245         16  CR-IND-GRP                    PIC X.
   246             88  CR-INDIVIDUAL                VALUE '1'.
   247             88  CR-GROUP                     VALUE '2'.
   248         16  CR-SKIP                       PIC 99.
   249             88  NO-MONTHS-SKIPPED            VALUE 00.
   250             88  SKIP-JULY                    VALUE 01.
   251             88  SKIP-AUGUST                  VALUE 02.
   252             88  SKIP-SEPTEMBER               VALUE 03.
   253             88  SKIP-JULY-AUG                VALUE 04.
   254             88  SKIP-AUG-SEPT                VALUE 05.
   255             88  SKIP-JULY-AUG-SEPT           VALUE 06.
   256             88  SKIP-JUNE-JULY-AUG           VALUE 07.
   257             88  SKIP-JUNE                    VALUE 08.
   258             88  SKIP-JUNE-JULY               VALUE 09.
   259             88  SKIP-AUG-SEPT-OCT            VALUE 10.
   260             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 11.
   261         16  CR-RESIDENT-STATE             PIC XX.
   262         16  CR-RATE-CODE.
   263             20  CR-LF-CLASS-CD            PIC XX.
   264             20  CR-AH-CLASS-CD            PIC XX.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   7
* ECS056TT.cbl (/apps/prod/cid1p/copy/ECSCRT01)
   265         16  CR-MORT.
   266             20  CR-TAB                    PIC X.
   267             20  CR-INT                    PIC 99.
   268             20  CR-GRP                    PIC X.
   269         16  CR-MEMBER-NO                  PIC X(12).
   270         16  CR-OLD-LOF                    PIC XXX.
   271*        16  CR-LOAN-OFFICER               PIC XXX.
   272         16  CR-REIN-TABLE                 PIC XXX.
   273         16  CR-REIN-SPEC                  PIC X.
   274         16  CR-LOAN-1ST-PMT-DT.
   275             20  CR-1ST-PMT-YR             PIC 99.
   276             20  CR-1ST-PMT-MO             PIC 99.
   277             20  CR-1ST-PMT-DA             PIC 99.
   278         16  CR-SUM-CAN-CNT-ITD            PIC S999       COMP-3.
   279         16  CR-SUM-CAN-CNT-YTD            PIC S999       COMP-3.
   280         16  CR-PMT-EXTENSION-DAYS         PIC S999       COMP-3.
   281         16  CR-LAST-ADD-ON-DT             PIC XX.
   282
   283         16  CR-UNDERWRITING-CODE          PIC X.
   284             88  CR-POLICY-UNDERWRITTEN       VALUE 'Y'.
   285
   286         16  CR-STATE-TAX                  PIC S9(7)V99   COMP-3.
   287         16  CR-MUNI-TAX                   PIC S9(7)V99   COMP-3.
   288         16  CR-CANCEL-STATE-TAX           PIC S9(7)V99   COMP-3.
   289         16  CR-CANCEL-MUNI-TAX            PIC S9(7)V99   COMP-3.
   290
   291     12  CR-STATUS-INFORMATION.
   292         16  CR-ENTRY-STATUS               PIC X.
   293             88  CR-NORMAL-ENTRY              VALUE '1'.
   294             88  CR-POLICY-IS-RESTORE         VALUE '3'.
   295             88  CR-CONVERSION-ENTRY          VALUE '4'.
   296             88  CR-POLICY-IS-REISSUE         VALUE '5'.
   297             88  CR-POLICY-IS-CASH            VALUE 'C'.
   298             88  CR-POLICY-IS-MONTHLY         VALUE 'M'.
   299             88  CR-POLICY-IS-REIN-ONLY       VALUE '9'.
   300             88  CR-POLICY-IS-DECLINED        VALUE 'D'.
   301             88  CR-POLICY-IS-VOID            VALUE 'V'.
   302             88  CR-POLICY-IS-PREM-ONLY       VALUE 'P'.
   303             88  CR-POLICY-IS-ACTIVE          VALUE '1' '3' '4'
   304                                                'C' '5' '9' 'P'.
   305         16  CR-ENTRY-DATE                 PIC 9(11)  COMP-3.
   306
   307         16  CR-LF-STATUS-AT-CANCEL        PIC X.
   308         16  CR-LF-CANC-DT                 PIC 9(11)  COMP-3.
   309         16  CR-LF-CANCEL-EXIT-DATE        PIC 9(11)  COMP-3.
   310
   311         16  CR-LF-STATUS-AT-DEATH         PIC X.
   312         16  CR-LF-CLAIM-EXIT-DATE         PIC 9(11)  COMP-3.
   313
   314         16  CR-LF-CURRENT-STATUS          PIC X.
   315             88  CR-LF-NORMAL-ENTRY           VALUE '1'.
   316             88  CR-LF-POLICY-PENDING         VALUE '2'.
   317             88  CR-LF-POLICY-IS-RESTORE      VALUE '3'.
   318             88  CR-LF-CONVERSION-ENTRY       VALUE '4'.
   319             88  CR-LF-POLICY-IS-REISSUE      VALUE '5'.
   320             88  CR-LF-POLICY-IS-MONTHLY      VALUE 'M'.
   321             88  CR-LF-LUMP-SUM-DISAB         VALUE '6'.
   322             88  CR-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   8
* ECS056TT.cbl (/apps/prod/cid1p/copy/ECSCRT01)
   323             88  CR-LF-CANCEL-APPLIED         VALUE '8'.
   324             88  CR-LF-IS-REIN-ONLY           VALUE '9'.
   325             88  CR-LF-IS-DECLINED            VALUE 'D'.
   326             88  CR-LF-IS-VOID                VALUE 'V'.
   327             88  CR-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
   328                                                    '4' '5' '9'.
   329
   330         16  CR-AH-STATUS-AT-CANCEL        PIC X.
   331
   332         16  CR-AH-CANC-DT                 PIC 9(11)  COMP-3.
   333         16  CR-AH-CANCEL-EXIT-DATE        PIC 9(11)  COMP-3.
   334
   335         16  CR-AH-STATUS-AT-SETTLEMENT    PIC X.
   336         16  CR-AH-SETTLEMENT-EXIT-DATE    PIC 9(11)  COMP-3.
   337
   338         16  CR-AH-CURRENT-STATUS          PIC X.
   339             88  CR-AH-NORMAL-ENTRY           VALUE '1'.
   340             88  CR-AH-POLICY-PENDING         VALUE '2'.
   341             88  CR-AH-POLICY-IS-RESTORE      VALUE '3'.
   342             88  CR-AH-CONVERSION-ENTRY       VALUE '4'.
   343             88  CR-AH-POLICY-IS-REISSUE      VALUE '5'.
   344             88  CR-AH-POLICY-IS-MONTHLY      VALUE 'M'.
   345             88  CR-AH-LUMP-SUM-DISAB         VALUE '6'.
   346             88  CR-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
   347             88  CR-AH-CANCEL-APPLIED         VALUE '8'.
   348             88  CR-AH-IS-REIN-ONLY           VALUE '9'.
   349             88  CR-AH-IS-DECLINED            VALUE 'D'.
   350             88  CR-AH-IS-VOID                VALUE 'V'.
   351             88  CR-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
   352                                                    '4' '5' '9'.
   353         16  CR-LOAN-OFFICER               PIC X(5).
   354         16  CR-CANCEL-REASON              PIC X.
   355         16  cr-xycor-lf-cov-code          pic x(4).
   356         16  cr-xycor-ah-cov-code          pic x(4).
   357         16  cr-temp-epiq                  pic x(4).
   358         16  FILLER                        PIC XX.
   359
   360     12  CR-DEATH-CLAIM-DATA.
   361         16  CR-NUM-DTH-CLM                PIC S999       COMP-3.
   362
   363         16  CR-DTH-DT                     PIC 9(11)      COMP-3.
   364         16  CR-DTH-RPT-DT.
   365             20  CR-DTH-RPT-YR             PIC 99.
   366             20  CR-DTH-RPT-MO             PIC 99.
   367             20  CR-DTH-RPT-DA             PIC 99.
   368         16  CR-DTH-PAY-DT                 PIC 9(11)      COMP-3.
   369
   370         16  CR-DTHAMT                     PIC S9(9)V99   COMP-3.
   371         16  CR-DTHAMT-YTD                 PIC S9(9)V99   COMP-3.
   372         16  CR-DTHAMT-LAST                PIC S9(9)V99   COMP-3.
   373         16  CR-DTHEXP                     PIC S9(7)V99   COMP-3.
   374         16  CR-DTHEXP-YTD                 PIC S9(7)V99   COMP-3.
   375
   376         16  CR-DTH-AGE                    PIC 99.
   377         16  CR-DTH-PAY-CD                 PIC X.
   378         16  CR-DEATH-CAUSE                PIC X(6).
   379
   380         16  FILLER                        PIC X(16).
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   9
* ECS056TT.cbl (/apps/prod/cid1p/copy/ECSCRT01)
   381
   382     12  CR-DISAB-CLAIM-DATA.
   383         16  CR-NUM-DIS-CLM                PIC S999       COMP-3.
   384
   385         16  CR-DIS-DT                     PIC 9(11)      COMP-3.
   386         16  CR-DIS-RPT-DT.
   387             20  CR-DIS-RPT-YR             PIC 99.
   388             20  CR-DIS-RPT-MO             PIC 99.
   389             20  CR-DIS-RPT-DA             PIC 99.
   390         16  CR-DIS-PAY-DT                 PIC 9(11)      COMP-3.
   391         16  CR-DIS-PTO-DT                 PIC 9(11)      COMP-3.
   392
   393         16  CR-DISAMT                     PIC S9(9)V99   COMP-3.
   394         16  CR-DISAMT-YTD                 PIC S9(9)V99   COMP-3.
   395         16  CR-DISAMT-LAST                PIC S9(9)V99   COMP-3.
   396         16  CR-DISEXP                     PIC S9(7)V99   COMP-3.
   397         16  CR-DISEXP-YTD                 PIC S9(7)V99   COMP-3.
   398
   399         16  CR-DAYS-DISAB                 PIC 999        COMP-3.
   400         16  CR-DIS-PAY-CD                 PIC X.
   401         16  FILLER                        PIC XX.
   402
   403         16  CR-DISAB-INCURRED-DETAIL.
   404             20  CR-DISAB-DETAIL-DATA  OCCURS 5 TIMES.
   405**ELCCRTVR MUST BE CHANGED IF THE "OCCURS" IS CHANGED.
   406                 24  CR-DIS-INCUR-DT       PIC 9(11)     COMP-3.
   407                 24  CR-INCUR-DISAMT       PIC S9(9)V99  COMP-3.
   408                 24  CR-INCUR-DISEXP       PIC S9(9)V99  COMP-3.
   409
   410         16  CR-DISAB-CAUSE                PIC X(6).
   411         16  FILLER                        PIC X(14).
   412
   413     12  CR-REMIT-TO                       PIC 99.
   414
   415     12  CR-COMPENSATION-LEVELS.
   416         16  CR-AGT-LEVELS      OCCURS 10 TIMES.
   417             20  CR-COM-AGT.
   418                 24  CR-COM-AGT-PREFIX     PIC X(4).
   419                 24  CR-COM-AGT-PRIME      PIC X(6).
   420             20  CR-AGT-TYPE               PIC X.
   421             20  CR-LCOM-L                 PIC SV9(5)     COMP-3.
   422             20  CR-LCOM-AH                PIC SV9(5)     COMP-3.
   423
   424     12  CR-BANK-NOCHRGB-MONTHS            PIC 99.
   425     12  CR-MOB-NET-TOT-FEES               PIC S9(7)V99   COMP-3.
   426     12  CR-ADDL-CLP                       PIC S9(5)V99   COMP-3.
   427     12  CR-CLP-STATE                      PIC XX.
   428     12  CR-POST-CARD-IND                  PIC X.
   429     12  CR-LF-CLP                         PIC S9(5)V99   COMP-3.
   430     12  CR-AH-CLP                         PIC S9(5)V99   COMP-3.
   431     12  CR-DCC-PRODUCT-CODE               PIC XXX.
   432     12  CR-LF-RFND-CLP                    PIC S9(5)V99   COMP-3.
   433     12  CR-AH-RFND-CLP                    PIC S9(5)V99   COMP-3.
   434     12  FILLER                            PIC X(07).
   435
   436     12  CR-CSR-CODE                       PIC XXX.
   437
   438     12  CR-CLAIM-DEDUCT-WITHHELD          PIC S9(5)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  10
* ECS056TT.cbl (/apps/prod/cid1p/copy/ECSCRT01)
   439     12  CR-CANCEL-DEDUCT-WITHHELD         PIC S9(5)V99   COMP-3.
   440
   441     12  CR-MICROFILM-NUMBERS.
   442*        16  CR-ISS-MICROFILM-NO           PIC S9(9)      COMP-3.
   443         16  FILLER                        PIC X(5).
   444     12  CR-NH-INT-ON-REF                  PIC S9(7)V99   COMP-3.
   445
   446     12  CR-USER-CODE                      PIC X.
   447     12  CR-USER-FUTURE                    PIC X(9).
   448
   449     12  CR-BENEFICIARY.
   450         16  CR-BANK-NO                    PIC X(10).
   451         16  FILLER                        PIC X(15).
   452
   453     12  CR-ENTRY-BATCH                    PIC X(6).
   454     12  CR-LF-EXIT-BATCH                  PIC X(6).
   455     12  CR-AH-EXIT-BATCH                  PIC X(6).
   456
   457     12  CR-NOTE-SW                        PIC X.
   458
   459     12  CR-ORIGIN-INDICATOR               PIC X.
   460         88  CR-ENTERED-MANUALLY              VALUE '1'.
   461         88  CR-CREATED-FROM-TAPE-LOAD        VALUE '2'.
   462
   463     12  CR-LF-CNC-ENT-DT                  PIC 9(11)  COMP-3.
   464     12  CR-AH-CNC-ENT-DT                  PIC 9(11)  COMP-3.
   465     12  FILLER                            PIC X(33).
   466
   467******************************************************************
   468
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  11
* ECS056TT.cbl
   470 FD  EXTRACT
   471     BLOCK CONTAINS 0 RECORDS
   472     RECORDING MODE IS F.
   473
   474*         167 BYTES
   475 01  EXTRACT-RECORD.
   476     05  EXT-CAR                 PIC X.
   477     05  EXT-GROUP               PIC X(6).
   478     05  EXT-STATE               PIC XX.
   479     05  EXT-ACCOUNT             PIC X(10).
   480     05  EXT-EFF-DATE            PIC X(10).
   481     05  EXT-CERT-NO             PIC X(11).
   482     05  EXT-LF-BEN-CODE         PIC XX.
   483     05  EXT-AH-BEN-CODE         PIC XX.
   484     05  EXT-LF-TERM             PIC ZZ9.
   485     05  EXT-AH-TERM             PIC ZZ9.
   486     05  EXT-LF-EXP-DATE         PIC X(10).
   487     05  EXT-AH-EXP-DATE         PIC X(10).
   488     05  EXT-EXP-PREM            PIC ZZ,ZZZ,ZZ9.99.
   489     05  EXT-REC-PREM            PIC ZZ,ZZZ,ZZ9.99.
   490     05  EXT-GA-COMM             PIC ZZZ,ZZ9.99.
   491     05  EXT-MISC1               PIC ZZZ,ZZZ,ZZ9.99.
   492     05  EXT-MISC2               PIC ZZZ,ZZZ,ZZ9.99.
   493     05  EXT-MISC3               PIC ZZZ,ZZZ,ZZ9.99.
   494     05  EXT-MISC4               PIC ZZZ,ZZZ,ZZ9.99.
   495     05  EXT-MISC5               PIC ZZZ,ZZZ,ZZ9.99.
   496
   497
   498 FD  DISK-DATE
*  499                                 COPY ELCDTEFD.
   500******************************************************************04/15/98
   501*                                                                *ELCDTEFD
   502*                                                                *ELCDTEFD
   503*                            ELCDTEFD.                           *   LV002
   504*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
   505*                            VMOD=2.007                          *   CL**2
   506*                                                                *ELCDTEFD
   507******************************************************************ELCDTEFD
   508     BLOCK CONTAINS 0 RECORDS
   509     RECORDING MODE F.                                            ELCDTEFD
   510                                                                  ELCDTEFD
   511 01  DATE-DISK.                                                   ELCDTEFD
   512     12  DD-ID                       PIC  X(4).                   ELCDTEFD
   513     12  FILLER                      PIC  X(14).                  ELCDTEFD
   514     12  DD-CR1                      PIC  9.                      ELCDTEFD
   515     12  DD-CR1N                     PIC  X(30).                  ELCDTEFD
   516     12  DD-CR2                      PIC  9.                      ELCDTEFD
   517     12  DD-CR2N                     PIC  X(30).                  ELCDTEFD
   518     12  FILLER                      PIC  X(20).                  ELCDTEFD
   519                                                                  ELCDTEFD
   520 01  DATE-DISK-R.                                                 ELCDTEFD
   521     12  FILLER                      PIC  X(4).                   ELCDTEFD
   522     12  DD-ST           OCCURS 3 TIMES                           ELCDTEFD
   523                                     PIC  X(32).                  ELCDTEFD
   524                                                                  ELCDTEFD
   525 01  DATE-DISK-T.                                                 ELCDTEFD
   526     12  FILLER                      PIC  X(4).                   ELCDTEFD
   527     12  DD-TYPE         OCCURS 2 TIMES                           ELCDTEFD
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  12
* ECS056TT.cbl (/apps/prod/cid1p/copy/ELCDTEFD)
   528                                     PIC  X(48).                  ELCDTEFD
   529                                                                  ELCDTEFD
   530 01  DATE-DISK-M.                                                 ELCDTEFD
   531     12  FILLER                      PIC  X(4).                   ELCDTEFD
   532     12  DD-MORT         OCCURS 2 TIMES                           ELCDTEFD
   533                                     PIC  X(48).                  ELCDTEFD
   534                                                                  ELCDTEFD
   535 01  DATE-DISK-P.                                                 ELCDTEFD
   536     12  DD-IDA                      PIC  XX.                     ELCDTEFD
   537     12  DD-IDX                      PIC  99.                     ELCDTEFD
   538     12  DD-DATA                     PIC  X(96).                  ELCDTEFD
   539     12  FILLER  REDEFINES DD-DATA.                               ELCDTEFD
   540         16  DD-PS-PIC   OCCURS 50 TIMES                          ELCDTEFD
   541                                     PIC  X.                      ELCDTEFD
   542         16  FILLER                  PIC  X(46).                  ELCDTEFD
   543     12  FILLER  REDEFINES DD-DATA.                               ELCDTEFD
   544         16  DD-PS-PICO  OCCURS 20 TIMES.                         ELCDTEFD
   545             20  DD-PS-PRT           PIC  X.                      ELCDTEFD
   546             20  DD-PS-FMT           PIC  X.                      ELCDTEFD
   547             20  DD-PS-PRC           PIC  X.                      ELCDTEFD
   548             20  DD-PS-TOT           PIC  X.                      ELCDTEFD
   549         16  FILLER                  PIC  X(16).                  ELCDTEFD
   550                                                                  ELCDTEFD
   551 01  DATE-DISK-E.                                                 ELCDTEFD
   552     12  FILLER                      PIC  X(4).                   ELCDTEFD
   553     12  DD-EDIT         OCCURS 24 TIMES                          ELCDTEFD
   554                                     PIC  X(4).                   ELCDTEFD
   555                                                                  ELCDTEFD
   556 01  DATE-DISK-C.                                                 ELCDTEFD
   557     12  FILLER                      PIC  X(7).                   ELCDTEFD
   558     12  DD-CARR1-SECPAY-SW          PIC  X.
   559     12  DD-CARR1-UEP-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   560     12  DD-CARR1-R78-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   561     12  DD-CARR1-PRO-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   562     12  DD-CARR1                    PIC  X.                      ELCDTEFD
   563     12  DD-CARR1S                   PIC  XX.                     ELCDTEFD
   564     12  DD-CARR1N                   PIC  X(30).                  ELCDTEFD
   565     12  DD-CARR2                    PIC  X.                      ELCDTEFD
   566     12  DD-CARR2S                   PIC  XX.                     ELCDTEFD
   567     12  DD-CARR2N                   PIC  X(30).                  ELCDTEFD
   568     12  DD-CARR2-UEP-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   569     12  DD-CARR2-R78-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   570     12  DD-CARR2-PRO-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   571     12  DD-CARR2-SECPAY-SW          PIC  X.
   572     12  FILLER                      PIC  X(7).                   ELCDTEFD
   573                                                                  ELCDTEFD
   574 01  DATE-DISK-OPT.                                               ELCDTEFD
   575     12  FILLER                      PIC  X(04).                  ELCDTEFD
   576     12  DD-TLR-DATA.                                             ELCDTEFD
   577         16  DD-TLR                  OCCURS 32 TIMES              ELCDTEFD
   578                                     PIC  X(03).                  ELCDTEFD
   579     12  DD-STATE-DATA REDEFINES DD-TLR-DATA.                     ELCDTEFD
   580         16  DD-STATE-FLDS           OCCURS 16 TIMES              ELCDTEFD
   581                                     PIC  X(06).                  ELCDTEFD
   582     12  DD-CARR-DATA REDEFINES DD-TLR-DATA.                      ELCDTEFD
   583         16  DD-CARR-FLDS            OCCURS 13 TIMES              ELCDTEFD
   584                                     PIC  X(07).                  ELCDTEFD
   585         16  FILLER                  PIC  X(05).                  ELCDTEFD
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  13
* ECS056TT.cbl
   586     12  DD-MISC-DATA REDEFINES DD-TLR-DATA                       ELCDTEFD
   587                                     PIC  X(96).                  ELCDTEFD
   588******************************************************************ELCDTEFD
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  14
* ECS056TT.cbl
   590 FD  PRINTX
*  591                                 COPY ELCPRTFD.
   592******************************************************************04/15/98
   593*                                                                *ELCPRTFD
   594*                                                                *ELCPRTFD
   595*                            ELCPRTFD.                           *   LV003
   596*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
   597*                            VMOD=2.006                          *ELCPRTFD
   598******************************************************************ELCPRTFD
   599     RECORDING MODE F                                             ELCPRTFD
   600     LABEL RECORDS OMITTED                                        ELCPRTFD
   601     BLOCK CONTAINS 0 RECORDS
   602     RECORD CONTAINS 133 CHARACTERS.                              ELCPRTFD
   603 01  PRT.                                                         ELCPRTFD
   604     12  P-CTL               PIC  X.                                 CL**2
   605     12  P-DATA              PIC  X(132).                         ELCPRTFD
   606******************************************************************ELCPRTFD
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  15
* ECS056TT.cbl
   608 WORKING-STORAGE SECTION.
   609 77  FILLER  PIC X(32) VALUE '********************************'.
   610 77  FILLER  PIC X(32) VALUE '      ECS056  WORKING STORAGE   '.
   611 77  FILLER  PIC X(32) VALUE '********************************'.
   612
   613 77  WS-EOF-SW                   PIC X  VALUE SPACES.
   614     88  END-OF-CERT                VALUE 'Y'.
   615     88  MORE-CERTS                 VALUE 'N'.
   616 77  IYR                         PIC S9(03) COMP-3 VALUE +0.
   617 77  VYR                         PIC S9(03) COMP-3 VALUE +0.
   618 77  PAGE-CTR                    PIC S9(07) VALUE +0  COMP-3.
   619 77  LINE-CTR                    PIC S9(03) VALUE +99 COMP-3.
   620 77  SPACE-NP                    PIC X      VALUE '1'.
   621 77  SPACE-1                     PIC X      VALUE ' '.
   622 77  SPACE-2                     PIC X      VALUE '0'.
   623 77  SPACE-3                     PIC X      VALUE '-'.
   624 77  X                           PIC X      VALUE ' '.
   625
   626 01  HD1.                                                         ECS064
   627     12  FILLER              PIC  X(44)      VALUE SPACES.        ECS064
   628     12  FILLER              PIC  X(44)      VALUE                ECS064
   629             '    DUE PREMIUM AND COMMISSION             '.
   630     12  FILLER              PIC  X(31)      VALUE SPACES.        ECS064
   631     12  FILLER              PIC  X(08)      VALUE 'ECS056'.      ECS064
   632                                                                  ECS064
   633 01  HD2.                                                         ECS064
   634     12  FILLER              PIC  X(51)      VALUE SPACES.        ECS064
   635     12  HD-CO               PIC  X(30).                          ECS064
   636     12  FILLER              PIC  X(38)      VALUE SPACES.        ECS064
   637     12  HD-RUN-DT           PIC  X(08)      VALUE SPACES.        ECS064
   638                                                                  ECS064
   639 01  HD3.                                                         ECS064
   640     12  FILLER              PIC  X(57)      VALUE SPACES.        ECS064
   641     12  HD-DT               PIC  X(18).                          ECS064
   642     12  FILLER              PIC  X(44)      VALUE SPACES.        ECS064
   643     12  FILLER              PIC  X(05)      VALUE 'PAGE '.       ECS064
   644     12  HD-PG               PIC ZZ,ZZ9.                          ECS064
   645                                                                  ECS064
   646 01  HD4.                                                         ECS064
   647     12  FILLER              PIC  X(44)      VALUE                ECS064
   648             '-- ACCOUNT NUMBERS --                BEGINNI'.      ECS064
   649     12  FILLER              PIC  X(44)      VALUE                ECS064
   650             'NG      CURRENT      PAYMENTS       ENDING  '.      ECS064
   651     12  FILLER              PIC  X(44)      VALUE                ECS064
   652             '  ---------------- A G I N G ---------------'.      ECS064
   653                                                                  ECS064
   654 01  HD5.                                                         ECS064
   655     12  FILLER              PIC  X(44)      VALUE                ECS064
   656             '-------- ACCOUNT NAME --------        BALANC'.      ECS064
   657     12  FILLER              PIC  X(44)      VALUE                ECS064
   658             'E       CHARGES     ADJUSTMENTS     BALANCE '.      ECS064
   659     12  FILLER              PIC  X(44)      VALUE                ECS064
   660             '      OVER 30       OVER 60       OVER 90   '.      ECS064
   661 01  DETAIL-LINE.
   662     05  FILLER                  PIC X(5).
   663     05  DTL1-CAR                PIC X.
   664     05  FILLER                  PIC X.
   665     05  DTL1-GRP                PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  16
* ECS056TT.cbl
   666     05  FILLER                  PIC X.
   667     05  DTL1-ST                 PIC XX.
   668     05  FILLER                  PIC X.
   669     05  DTL1-ACCT               PIC X(10).
   670     05  FILLER                  PIC X.
   671     05  DTL1-BEG-BAL            PIC ZZZ,ZZ9.99.
   672     05  FILLER                  PIC X.
   673     05  DTL1-EXP-PREM           PIC ZZZ,ZZ9.99.
   674     05  FILLER                  PIC X.
   675     05  DTL1-REC-PREM           PIC ZZZ,ZZ9.99.
   676     05  FILLER                  PIC X.
   677     05  DTL1-ADJS               PIC ZZZ,ZZ9.99.
   678     05  FILLER                  PIC X.
   679     05  DTL1-END-BAL            PIC ZZZ,ZZ9.99.
   680     05  FILLER                  PIC X.
   681     05  DTL1-DUE-LT90           PIC ZZZ,ZZ9.99.
   682     05  FILLER                  PIC X.
   683     05  DTL1-DUE-GT90           PIC ZZZ,ZZ9.99.
   684     05  FILLER                  PIC X.
   685     05  DTL1-COMM               PIC ZZZ,ZZ9.99.
   686     05  FILLER                  PIC X.
   687     05  DTL1-NO-MOS             PIC ZZ9.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  17
* ECS056TT.cbl
   689 01  WS-DUE-PREM-TABLE.
   690     05  WS-RECORD.
   691         10  WS-CAR              PIC X.
   692         10  WS-GROUP            PIC X(6).
   693         10  WS-STATE            PIC XX.
   694         10  WS-ACCOUNT          PIC X(10).
   695         10  WS-EFF-DATE         PIC X(10).
   696         10  WS-CERT-NO          PIC X(11).
   697         10  WS-LF-BEN-CODE      PIC XX.
   698         10  WS-AH-BEN-CODE      PIC XX.
   699         10  WS-LF-TERM          PIC ZZ9.
   700         10  WS-AH-TERM          PIC ZZ9.
   701         10  WS-LF-EXP-DATE      PIC X(10).
   702         10  WS-AH-EXP-DATE      PIC X(10).
   703         10  WS-EXP-PREM         PIC S9(9)V99 COMP-3 VALUE +0.
   704         10  WS-REC-PREM         PIC S9(9)V99 COMP-3 VALUE +0.
   705         10  WS-GA-COMM          PIC S9(7)V99 COMP-3 VALUE +0.
   706         10  WS-MISC1            PIC S9(7)V99 COMP-3 VALUE +0.
   707         10  WS-MISC2            PIC S9(7)V99 COMP-3 VALUE +0.
   708         10  WS-MISC3            PIC S9(7)V99 COMP-3 VALUE +0.
   709         10  WS-MISC4            PIC S9(7)V99 COMP-3 VALUE +0.
   710         10  WS-MISC5            PIC S9(7)V99 COMP-3 VALUE +0.
   711
   712 01  WS-MISC.
   713     05  WS-HOLD-CONTROL.
   714         10  WS-HOLD-CAR         PIC X.
   715         10  WS-HOLD-GRP         PIC X(6).
   716         10  WS-HOLD-ST          PIC XX.
   717         10  WS-HOLD-ACCT        PIC X(10).
   718     05  INTERMED                PIC S9(9)V9(6)  COMP-3.
   719     05  WS-REM-AMT              PIC S9(11)V99 COMP-3 VALUE +0.
   720     05  WS-DISPLAY-DATE         PIC ZZZ9(8).
   721     05  WS-DISPLAY-TERM         PIC Z99.
   722     05  WS-DISPLAY-RTERM        PIC Z99.99.
   723     05  WS-DISPLAY-AMT          PIC ZZZZZZZ.99.
   724     05  WS-DISPLAY-RAMT         PIC ZZZZZZZ.99.
   725     05  WS-DISPLAY-PRM          PIC ZZZZZZZ.99.
   726     05  WS-DISPLAY-UEP          PIC ZZZZZZZ.99.
   727     05  WS-BIN-CR-DT            PIC XX  VALUE LOW-VALUES.
   728     05  WS-BIN-LF-END-DATE      PIC XX  VALUE LOW-VALUES.
   729     05  WS-BIN-AH-END-DATE      PIC XX  VALUE LOW-VALUES.
   730     05  WS-END-YEAR             PIC 9(11)  VALUE ZEROS.
   731     05  FILLER REDEFINES WS-END-YEAR.
   732         10  WS-CCYY             PIC 9(7).
   733         10  WS-MMDD             PIC 9(4).
   734 01  WS-DEBUG-AREA.
   735     12  WS-DEBUG-SW             PIC X(01) VALUE ' '.
   736         88  DEBUG-IS-ON                VALUES '1' '2' '3' '4'.
   737         88  DEBUG-LF-INFORCE-CNT       VALUE '1'.
   738         88  DEBUG-AH-INFORCE-CNT       VALUE '2'.
   739         88  DEBUG-LF-STATUTORY         VALUE '3'.
   740         88  DEBUG-AH-STATUTORY         VALUE '4'.
   741
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  18
* ECS056TT.cbl
   743
   744 01  TEXAS-REGS-WORK-AREAS.
   745     12  TEX-FACT-1              PIC S9(7)V9(2)    COMP-3.
   746     12  TEX-FACT-2              PIC S9(3)   COMP-3.
   747     12  TEX-FACT-3              PIC S9(3)   COMP-3.
   748     12  TEX-FACT-4              PIC S9(7)   COMP-3.
   749     12  TEX-FACT-5              PIC S9(3)   COMP-3.
   750     12  TEX-FACT-6              PIC S9(3)   COMP-3.
   751     12  TEX-FACT-7              PIC S9(7)   COMP-3.
   752     12  TEX-FACT-8              PIC S9V9(6) COMP-3.
   753     12  TEX-FACT-9              PIC S9(4)V9(11)   COMP-3.
   754
   755 01  NET-PAY-INTERFACE.
   756     05  NP-APR                  PIC S9(3)V9(4)    COMP-3.
   757     05  NP-ORIG                 PIC S9(3)         COMP-3.
   758     05  NP-REM                  PIC S9(3)         COMP-3.
   759     05  NP-OPT                  PIC X(01).
   760     05  NP-CAP                  PIC S9(3)         COMP-3.
   761     05  NP-FACTOR               PIC S9(4)V9(9)    COMP-3.
   762     05  NP-WORK1                PIC S9(6)V9(9)    COMP-3.
   763     05  NP-WORK2                PIC S9(6)V9(9)    COMP-3.
   764
   765 01  WS-ABEND-AREA.
   766     05  WS-ABEND-FILE-STATUS    PIC X(02).
   767     05  WS-ABEND-MESSAGE        PIC X(80) VALUE SPACES.
   768     05  WS-RETURN-CODE          PIC S9(04)  COMP VALUE +0.
   769     05  WS-ZERO                 PIC S9(01) VALUE +0 COMP-3.
   770
   771 01  WORK-ABEND-CODE.
   772     12  WAC-1                   PIC X.
   773     12  WAC-2                   PIC X.
   774     12  WAC-3-4.
   775         16  WAC-3               PIC X.
   776         16  WAC-4               PIC X.
   777
   778 01  DATE-AREAS.
   779     05  WS-TEST-RUN-DATE        PIC 9(11).
   780     05  WS-WORK-DATE            PIC 9(11).
   781     05  FILLER REDEFINES WS-WORK-DATE.
   782         10  FILLER              PIC XXX.
   783         10  WS-WORK-CCYY        PIC 9(4).
   784         10  WS-WORK-MMDD        PIC 9(4).
   785     05  WS-ISSUE-DATE           PIC 9(11).
   786     05  FILLER REDEFINES WS-ISSUE-DATE.
   787         10  FILLER              PIC XXX.
   788         10  WS-ISSUE-CCYY       PIC 9(4).
   789         10  WS-ISSUE-MMDD       PIC 9(4).
   790     05  WS-EXPIRE-DATE          PIC 9(11).
   791     05  FILLER REDEFINES WS-EXPIRE-DATE.
   792         10  FILLER              PIC XXX.
   793         10  WS-EXPIRE-CCYY      PIC 9(4).
   794         10  WS-EXPIRE-MMDD      PIC 9(4).
   795     05  WS-CANCEL-DATE          PIC 9(11).
   796     05  FILLER REDEFINES WS-CANCEL-DATE.
   797         10  FILLER              PIC XXX.
   798         10  WS-CANCEL-CCYY      PIC 9(4).
   799         10  WS-CANCEL-MMDD      PIC 9(4).
   800     05  WS-CLAIM-DATE           PIC 9(11).
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  19
* ECS056TT.cbl
   801     05  FILLER REDEFINES WS-CLAIM-DATE.
   802         10  FILLER              PIC XXX.
   803         10  WS-CLAIM-CCYY       PIC 9(4).
   804         10  WS-CLAIM-MMDD       PIC 9(4).
   805     05  WS-HI-ISSUE-CCYY        PIC 9(4) VALUE ZEROS.
   806     05  WS-LO-ISSUE-CCYY        PIC 9(4) VALUE ZEROS.
   807     05  WS-HI-VALUATION-CCYY    PIC 9(4) VALUE ZEROS.
   808     05  WS-LO-VALUATION-CCYY    PIC 9(4) VALUE ZEROS.
   809     05  WS-BIN-VAL-DATES OCCURS 50
   810                                 PIC XX.
   811
   812 01  WS-MISC-AREA.
   813*   1ST OCCURANCE           ACCOUNT TOTALS
   814*   2ND                     STATE
   815*   3RD                     GROUP
   816*   4TH                     CARRIER
   817*   5TH                     FINAL
   818     12  WS-TOTAL-TABLE OCCURS 5.
   819         16  WS-TOT-EXP-PREM     PIC S9(9)V99 COMP-3 VALUE +0.
   820         16  WS-TOT-REC-PREM     PIC S9(9)V99 COMP-3 VALUE +0.
   821         16  WS-TOT-GA-COMM      PIC S9(9)V99 COMP-3 VALUE +0.
   822     12  WS-DISPLAY-FLD          PIC 9(9).9(5).
   823     12  WS-LF-PRM               PIC S9(7)V99 COMP-3  VALUE +0.
   824     12  WS-AH-PRM               PIC S9(7)V99 COMP-3  VALUE +0.
   825     12  CERT-IN-CNT             PIC 9(9)     VALUE ZEROS.
   826     12  WS-I                    PIC SV9(9)   COMP-3  VALUE +0.
   827     12  WS-J                    PIC SV9(9)   COMP-3  VALUE +0.
   828     12  WS-VM                   PIC S9V9(9)  COMP-3  VALUE +0.
   829     12  WS-P                    PIC S9(7)V99 COMP-3  VALUE +0.
   830     12  WS-B                    PIC S9(7)V99 COMP-3  VALUE +0.
   831     12  WS-R                    PIC S9(7)V99 COMP-3  VALUE +0.
   832     12  WS-I1                   PIC S9(7)V99 COMP-3  VALUE +0.
   833     12  X1                      PIC S999     COMP-3  VALUE +0.
   834     12  WS-A                    PIC S999     COMP-3  VALUE +0.
   835     12  WS-ANGLEN               PIC S9(7)V99 COMP-3  VALUE +0.
   836     12  WS-AMT                  PIC S9(9)V99 COMP-3  VALUE +0.
   837     12  WS-ANGLEM               PIC S9(7)V99 COMP-3  VALUE +0.
   838     12  WS-ANGLEMJ              PIC S9(7)V99 COMP-3  VALUE +0.
   839     12  WS-ANGLEN-M             PIC S9(7)V99 COMP-3  VALUE +0.
   840     12  LF-REM-TRM1             PIC S999V99  COMP-3  VALUE +0.
   841     12  AH-REM-TRM1             PIC S999V99  COMP-3  VALUE +0.
   842     12  LF-REM-TRM2             PIC S999V99  COMP-3  VALUE +0.
   843     12  AH-REM-TRM2             PIC S999V99  COMP-3  VALUE +0.
   844     12  REM-TRM1                PIC S9(3)V99    COMP-3.
   845     12  REM-TRM2                PIC S9(3)V99    COMP-3.
   846     12  WS-EARN-TERM            PIC 999              VALUE ZEROS.
   847
   848
   849 01  ABEND-FIELDS.
   850     12  PGM-SUB                 PIC S999 COMP  VALUE +158.
   851     12  FIRST-TIME-SW           PIC X  VALUE 'Y'.
   852         88  FIRST-TIME                 VALUE 'Y'.
   853
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  20
* ECS056TT.cbl
*  855                                 COPY ELCCALC.
   856******************************************************************04/15/98
   857*                                                                *ELCCALC
   858*                           ELCCALC.                            *    LV003
   859*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
   860*                            VMOD=2.025                          *   CL**3
   861*                                                                *   CL**2
   862*   DESCRIPTION:  DATA TO BE PASSED TO REMAINING TERM ROUTINE    *   CL**2
   863*                 REMAINING AMOUNT ROUTINE, LOSS RESERVE ROUTINE *   CL**2
   864*                 REFUND CALCULATIONS ROUTINE, EARNINGS CALCU -  *   CL**2
   865*                 LATIONS ROUTINE, AND THE RATING ROUTINE.       *   CL**2
   866*                                                                *   CL**2
   867*  PASSED TO ELRTRM                                              *   CL**2
   868*  -----------------                                             *   CL**2
   869*  METHOD CODE (I.E. FULL MONTH, HALF ADJ, ETC)                  *   CL**2
   870*  ORIGINAL TERM                                                 *   CL**2
   871*  BEGINNING DATE                                                *   CL**2
   872*  ENDING DATE                                                   *   CL**2
   873*  COMPANY I.D.                                                  *   CL**2
   874*  ACCOUNT MASTER USER FIELD                                     *   CL**2
   875*  PROCESS SWITCH (CANCEL, CLAIM)                                *   CL**2
   876*  FREE LOOK DAYS                                                *   CL**2
   877*                                                                *   CL**2
   878*  RETURNED FROM ELRTRM                                          *   CL**2
   879*  ---------------------                                         *   CL**2
   880*  REMAINING TERM 1 - USED FOR EARNINGS                          *   CL**2
   881*  REMAINING TERM 2 - USED FOR BENEFIT CALCULATIONS              *   CL**2
   882*  REMAINING TERM 3 - USED FOR CLAIM BENEFITS                    *   CL**2
   883*  ODD DAYS - REMAINING DAYS PAST FULL MONTHS                    *   CL**2
   884*----------------------------------------------------------------*   CL**2
   885*  PASSED TO ELRAMT                                              *   CL**2
   886*  ----------------                                              *   CL**2
   887*  REMAINING TERM 1 OR 2 OR 3 (FROM ELRTRM)                      *   CL**2
   888*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *   CL**2
   889*  ORIGINAL AMOUNT                                               *   CL**2
   890*  ALTERNATE BENEFIT (BALLON)                                    *   CL**2
   891*  A.P.R. - NET PAY ONLY                                         *   CL**2
   892*  METHOD                                                            CL**2
   893*  PAYMENT FREQUENCY - FOR FARM PLAN                             *   CL**2
   894*  COMPANY I.D.                                                  *   CL**2
   895*  BENEFIT TYPE                                                  *   CL**2
   896*                                                                *   CL**2
   897*  RETURNED FROM ELRAMT                                          *   CL**2
   898*  --------------------                                          *   CL**2
   899*  REMAINING AMOUNT 1 - CURRENT                                  *   CL**2
   900*  REMAINING AMOUNT 2 - PREVIOUS MONTH                           *   CL**2
   901*  REMAINING AMOUNT FACTOR                                           CL**2
   902*----------------------------------------------------------------*   CL**2
   903*  PASSED TO ELRESV                                              *   CL**2
   904*  -----------------                                             *   CL**2
   905*  CERTIFICATE EFFECTIVE DATE                                    *   CL**2
   906*  VALUATION DATE                                                *   CL**2
   907*  PAID THRU DATE                                                *   CL**2
   908*  BENEFIT                                                       *   CL**2
   909*  INCURRED DATE                                                 *   CL**2
   910*  REPORTED DATE                                                 *   CL**2
   911*  ISSUE AGE                                                     *   CL**2
   912*  TERM                                                          *   CL**2
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  21
* ECS056TT.cbl (/apps/prod/cid1p/copy/ELCCALC)
   913*  CDT PERCENT                                                   *   CL**2
   914*  CDT METHOD (I.E. INTERPOLATED, AVERAGE, ETC)                  *   CL**2
   915* *CLAIM TYPE (LIFE, A/H)                                        *   CL**2
   916* *REMAINING BENEFIT (FROM ELRAMT)                               *   CL**2
   917* *ONLY FIELDS REQUIRED FOR LIFE CLAIMS                          *   CL**2
   918*                                                                *   CL**2
   919*  RETURNED FROM ELRESV                                          *   CL**2
   920*  --------------------                                          *   CL**2
   921*  CDT TABLE USED                                                *   CL**2
   922*  CDT FACTOR USED                                               *   CL**2
   923*  PAY TO CURRENT RESERVE                                        *   CL**2
   924*  I.B.N.R. - A/H ONLY                                           *   CL**2
   925*  FUTURE (ACCRUED) AH ONLY                                      *   CL**2
   926*----------------------------------------------------------------*   CL**2
   927*  PASSED TO ELRATE                                              *   CL**2
   928*  ----------------                                              *   CL**2
   929*  CERT ISSUE DATE                                               *   CL**2
   930*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *   CL**2
   931*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *   CL**2
   932*  CAPPED TERM   (ONLY FOR TRUNCATED LIFE)                       *   CL**2
   933*  STATE CODE (CLIENT DEFINED)                                   *   CL**2
   934*  STATE CODE (STANDARD P.O. ABBRV)                              *   CL**2
   935*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *   CL**2
   936*  DEVIATION CODE                                                *   CL**2
   937*  ISSUE AGE                                                     *   CL**2
   938*  ORIGINAL BENEFIT AMOUNT                                       *   CL**2
   939*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *   CL**2
   940*  PROCESS TYPE (ISSUE OR CANCEL)                                *   CL**2
   941*  BENEFIT KIND (LIFE OR A/H)                                    *   CL**2
   942*  A.P.R.                                                        *   CL**2
   943*  METHOD                                                            CL**2
   944*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *   CL**2
   945*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *   CL**2
   946*  COMPANY I.D. (3 CHARACTER)                                    *   CL**2
   947*  BENEFIT CODE                                                  *   CL**2
   948*  BENEFIT OVERRIDE CODE                                         *   CL**2
   949*  MAXIMUM MONTHLY BENEFIT (FROM ACCT MASTER - CSL ONLY)         *   CL**2
   950*  MAXIMUM TOTAL BENEFIT (FROM ACCT MASTER - CSL ONLY)           *   CL**2
   951*  JOINT INDICATOR (CSL ONLY)                                    *   CL**2
   952*  FIRST PAYMENT DATE (CSL ONLY)                                 *   CL**2
   953*  PERIODIC PAYMENT AMOUNT (IN CP-REMAINING-TERM - CSL ONLY)     *   CL**2
   954*                                                                *   CL**2
   955*  RETURNED FROM ELRATE                                          *   CL**2
   956*  --------------------                                          *   CL**2
   957*  CALCULATED PREMIUM                                            *   CL**2
   958*  PREMIUM RATE                                                  *   CL**2
   959*  MORTALITY CODE                                                *   CL**2
   960*  MAX ATTAINED AGE                                              *   CL**2
   961*  MAX AGE                                                       *   CL**2
   962*  MAX TERM                                                      *   CL**2
   963*  MAX MONTHLY BENEFIT                                           *   CL**2
   964*  MAX TOTAL BENIFIT                                             *   CL**2
   965*  COMPOSITE RATE (OPEN-END ONLY)                                *   CL**2
   966*----------------------------------------------------------------*   CL**2
   967*  PASSED TO ELRFND                                              *   CL**2
   968*  ----------------                                              *   CL**2
   969*  CERT ISSUE DATE                                               *   CL**2
   970*  REFUND DATE                                                   *   CL**2
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  22
* ECS056TT.cbl (/apps/prod/cid1p/copy/ELCCALC)
   971*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *   CL**2
   972*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *   CL**2
   973*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *   CL**2
   974*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *   CL**2
   975*  STATE CODE (CLIENT DEFINED)                                   *   CL**2
   976*  STATE CODE (STANDARD P.O. ABBRV)                              *   CL**2
   977*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *   CL**2
   978*  DEVIATION CODE                                                *   CL**2
   979*  ISSUE AGE                                                     *   CL**2
   980*  ORIGINAL BENEFIT AMOUNT                                       *   CL**2
   981*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *   CL**2
   982*  PROCESS TYPE (CANCEL)                                         *   CL**2
   983*  BENEFIT KIND (LIFE OR A/H)                                    *   CL**2
   984*  A.P.R.                                                        *   CL**2
   985*  EARNING METHOD - (CODE FROM BENEFIT, STATE OR ACCOUNT RECORD) *   CL**2
   986*  RATING METHOD -  (CODE FROM BENEFIT)                          *   CL**2
   987*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *   CL**2
   988*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *   CL**2
   989*  COMPANY I.D. (3 CHARACTER)                                    *   CL**2
   990*  BENEFIT CODE                                                  *   CL**2
   991*  BENEFIT OVERRIDE CODE                                         *   CL**2
   992*                                                                *   CL**2
   993*  RETURNED FROM ELRFND                                          *   CL**2
   994*  --------------------                                          *   CL**2
   995*  CALCULATED REFUND                                             *   CL**2
   996*----------------------------------------------------------------*   CL**2
   997*  PASSED TO ELEARN                                              *   CL**2
   998*  ----------------                                              *   CL**2
   999*  CERT ISSUE DATE                                               *   CL**2
  1000*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *   CL**2
  1001*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *   CL**2
  1002*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *   CL**2
  1003*  STATE CODE (CLIENT DEFINED)                                   *   CL**2
  1004*  STATE CODE (STANDARD P.O. ABBRV)                              *   CL**2
  1005*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *   CL**2
  1006*  DEVIATION CODE                                                *   CL**2
  1007*  ISSUE AGE                                                     *   CL**2
  1008*  ORIGINAL BENEFIT AMOUNT                                       *   CL**2
  1009*  BENEFIT KIND (LIFE OR A/H)                                    *   CL**2
  1010*  A.P.R.                                                        *   CL**2
  1011*  METHOD - (EARNING CODE FROM BENEFIT RECORD)                   *   CL**2
  1012*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *   CL**2
  1013*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *   CL**2
  1014*  COMPANY I.D. (3 CHARACTER)                                    *   CL**2
  1015*  BENEFIT CODE                                                  *   CL**2
  1016*  BENEFIT OVERRIDE CODE                                         *   CL**2
  1017*                                                                *   CL**2
  1018*  RETURNED FROM ELEARN                                          *   CL**2
  1019*  --------------------                                          *   CL**2
  1020*  INDICATED  EARNINGS                                           *   CL**2
  1021*----------------------------------------------------------------*   CL**2
  1022*                 LENGTH = 450                                   *   CL**2
  1023*                                                                *   CL**2
  1024******************************************************************   CL**2
  1025******************************************************************
  1026*                   C H A N G E   L O G
  1027*
  1028* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  23
* ECS056TT.cbl (/apps/prod/cid1p/copy/ELCCALC)
  1029*-----------------------------------------------------------------
  1030*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1031* EFFECTIVE    NUMBER
  1032*-----------------------------------------------------------------
  1033* 010303    2001061800003  PEMA  ADD DCC/MONTHLY PROCESSING
  1034* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  1035* 101807    2007100100007  PEMA  EXPAND CLM RESERVE FIELDS
  1036* 010410    2008021200005  PEMA  ADD FIELDS FOR MN NET PAY BALLOON
  1037* 010410    2009050700003  PEMA  ADD FIELDS FOR SPP-DD
  1038* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  1039* 041710    2007111300001  AJRA  ADD CLAIM CALC SW FOR SC NP+6
  1040* 101110  CR2010012700001  PEMA ADD DDF REFUND/UEP PROCESSING
  1041* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  1042* 040615  CR2013072200002  PEMA  ADD EXTRA PERIODS
  1043******************************************************************
  1044                                                                     CL**2
  1045 01  CALCULATION-PASS-AREA.                                          CL**2
  1046     12  CP-COMM-LENGTH            PIC S9(4)         VALUE +450      CL**2
  1047                                     COMP.                           CL**2
  1048                                                                     CL**2
  1049     12  CP-RETURN-CODE            PIC X             VALUE ZERO.     CL**2
  1050       88  NO-CP-ERROR                             VALUE ZERO.       CL**2
  1051       88  CP-ERROR-OCCURED VALUE '1' '2' '3' '4' '5' '6' '7' '8'    CL**2
  1052                                  '9' 'A' 'B' 'C' 'D' 'E' 'H'.       CL**2
  1053       88  CP-ERROR-IN-AMOUNTS                     VALUE '1'.        CL**2
  1054       88  CP-ERROR-IN-DATES                       VALUE '2'.        CL**2
  1055       88  CP-ERROR-IN-OPTIONS                     VALUE '3'.        CL**2
  1056       88  CP-ERROR-IN-TERMS                       VALUE '4'.        CL**2
  1057       88  CP-ERROR-IN-FREQUENCY                   VALUE '5'.        CL**2
  1058       88  CP-ERROR-RATE-NOT-FOUND                 VALUE '6'.        CL**2
  1059       88  CP-ERROR-RATE-IS-ZERO                   VALUE '7'.        CL**2
  1060       88  CP-ERROR-AMT-OUTSIDE-LIMIT              VALUE '8'.        CL**2
  1061       88  CP-ERROR-TERM-OUTSIDE-LIMIT             VALUE '9'.        CL**2
  1062       88  CP-ERROR-AGE-OUTSIDE-LIMIT              VALUE 'A'.        CL**2
  1063       88  CP-ERROR-ATT-OUTSIDE-LIMIT              VALUE 'B'.        CL**2
  1064       88  CP-ERROR-TOT-OUTSIDE-LIMIT              VALUE 'C'.        CL**2
  1065       88  CP-ERROR-RATE-FILE-NOTOPEN              VALUE 'D'.        CL**2
  1066       88  CP-ERROR-ISSUE-AGE-ZERO                 VALUE 'E'.        CL**2
  1067       88  CP-ERROR-NO-LIMITS-CRI                  VALUE 'F'.        CL**2
  1068       88  CP-ERROR-DIV-BY-ZERO                    VALUE 'G'.        CL**2
  1069       88  CP-ERROR-LOAN-TERM                      VALUE 'H'.        CL**2
  1070                                                                     CL**2
  1071     12  CP-RETURN-CODE-2          PIC X             VALUE ZERO.     CL**2
  1072       88  NO-CP-ERROR-2                           VALUE ZERO.       CL**2
  1073***********************  INPUT AREAS ****************************    CL**2
  1074                                                                     CL**2
  1075     12  CP-CALCULATION-AREA.                                        CL**2
  1076         16  CP-ACCOUNT-NUMBER     PIC X(10)       VALUE SPACES.     CL**2
  1077         16  CP-CERT-EFF-DT        PIC XX.                           CL**2
  1078         16  CP-VALUATION-DT       PIC XX.                           CL**2
  1079         16  CP-PAID-THRU-DT       PIC XX.                           CL**2
  1080         16  CP-BENEFIT-TYPE       PIC X.                            CL**2
  1081           88  CP-AH                               VALUE 'A' 'D'     CL**2
  1082                                                   'I' 'U'.          CL**2
  1083           88  CP-REDUCING-LIFE                    VALUE 'R'.        CL**2
  1084           88  CP-LEVEL-LIFE                       VALUE 'L' 'P'.    CL**2
  1085         16  CP-INCURRED-DT        PIC XX.                           CL**2
  1086         16  CP-REPORTED-DT        PIC XX.                           CL**2
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  24
* ECS056TT.cbl (/apps/prod/cid1p/copy/ELCCALC)
  1087         16  CP-ACCT-FLD-5         PIC XX            VALUE SPACE.    CL**2
  1088         16  CP-COMPANY-ID         PIC XXX           VALUE SPACE.    CL**2
  1089         16  CP-ISSUE-AGE          PIC S9(3)         VALUE ZERO      CL**2
  1090                                     COMP-3.                         CL**2
  1091         16  CP-CDT-PERCENT        PIC S9(3)V99      VALUE ZERO      CL**2
  1092                                     COMP-3.                         CL**2
  1093         16  CP-CDT-METHOD         PIC X.                            CL**2
  1094           88  CP-CDT-ROUND-NEAR                   VALUE '1'.        CL**2
  1095           88  CP-CDT-ROUND-HIGH                   VALUE '2'.        CL**2
  1096           88  CP-CDT-INTERPOLATED                 VALUE '3'.        CL**2
  1097         16  CP-CLAIM-TYPE         PIC X.                            CL**2
  1098           88  CP-AH-CLAIM                         VALUE 'A'.        CL**2
  1099           88  CP-LIFE-CLAIM                       VALUE 'L'.        CL**2
  1100         16  CP-ORIGINAL-TERM      PIC S9(3)         VALUE ZERO      CL**2
  1101                                     COMP-3.                         CL**2
  1102         16  CP-ORIGINAL-BENEFIT   PIC S9(9)V99      VALUE ZERO      CL**2
  1103                                     COMP-3.                         CL**2
  1104         16  CP-ORIGINAL-PREMIUM   PIC S9(7)V99      VALUE ZERO      CL**2
  1105                                     COMP-3.                         CL**2
  1106         16  CP-REMAINING-TERM     PIC S9(3)V99      VALUE ZERO      CL**2
  1107                                     COMP-3.                         CL**2
  1108         16  CP-REMAINING-BENEFIT  PIC S9(9)V99      VALUE ZERO      CL**2
  1109                                     COMP-3.                         CL**2
  1110         16  CP-LOAN-APR           PIC S9(3)V9(4)    VALUE ZERO      CL**2
  1111                                     COMP-3.                         CL**2
  1112         16  CP-PAY-FREQUENCY      PIC S9(3)         VALUE ZERO      CL**2
  1113                                     COMP-3.                         CL**2
  1114         16  CP-REM-TERM-METHOD    PIC X.                            CL**2
  1115           88  CP-EARN-AFTER-15TH                  VALUE '1'.        CL**2
  1116           88  CP-EARN-ON-HALF-MONTH               VALUE '2'.        CL**2
  1117           88  CP-EARN-ON-1ST-DAY                  VALUE '3'.        CL**2
  1118           88  CP-EARN-ON-FULL-MONTH               VALUE '4'.        CL**2
  1119           88  CP-EARN-WITH-NO-DAYS                VALUE '5'.        CL**2
  1120           88  CP-EARN-AFTER-14TH                  VALUE '6'.        CL**2
  1121           88  CP-EARN-AFTER-16TH                  VALUE '7'.        CL**2
  1122         16  CP-EARNING-METHOD     PIC X.                            CL**2
  1123           88  CP-EARN-BY-R78                      VALUE '1' 'R'.    CL**2
  1124           88  CP-EARN-BY-PRORATA                  VALUE '2' 'P'.    CL**2
  1125           88  CP-EARN-AS-CALIF                    VALUE '3' 'C'.    CL**2
  1126           88  CP-EARN-AS-TEXAS                    VALUE '4' 'T'.    CL**2
  1127           88  CP-EARN-AS-FARM-PLAN                VALUE '4' 'T'.    CL**2
  1128           88  CP-EARN-AS-NET-PAY                  VALUE '5' 'N'.    CL**2
  1129           88  CP-EARN-ANTICIPATION                VALUE '6' 'A'.    CL**2
  1130           88  CP-EARN-AS-MEAN                     VALUE '8' 'M'.    CL**2
  1131           88  CP-EARN-AS-SUM-OF-DIGITS            VALUE '9'.        CL**2
  1132           88  CP-EARN-AS-REG-BALLOON              VALUE 'B'.        CL**2
  1133           88  CP-GAP-NON-REFUNDABLE               VALUE 'G'.
  1134           88  CP-GAP-ACTUARIAL                    VALUE 'S'.
  1135           88  CP-DCC-SPP-DDF                      VALUE 'D' 'I'.
  1136           88  CP-DCC-SPP-DDF-IU                   VALUE 'I'.
  1137         16  CP-PROCESS-TYPE       PIC X.                            CL**2
  1138           88  CP-CLAIM                            VALUE '1'.        CL**2
  1139           88  CP-CANCEL                           VALUE '2'.        CL**2
  1140           88  CP-ISSUE                            VALUE '3'.        CL**2
  1141         16  CP-SPECIAL-CALC-CD    PIC X.                            CL**2
  1142           88  CP-OUTSTANDING-BAL              VALUE 'O'.            CL**2
  1143           88  CP-1-MTH-INTEREST               VALUE ' '.            CL**2
  1144           88  CP-0-MTH-INTEREST               VALUE 'A'.            CL**2
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  25
* ECS056TT.cbl (/apps/prod/cid1p/copy/ELCCALC)
  1145           88  CP-OB-OFFLINE-RESERVED          VALUE 'B'.            CL**2
  1146           88  CP-CRITICAL-PERIOD              VALUE 'C'.            CL**2
  1147           88  CP-TERM-IS-DAYS                 VALUE 'D'.            CL**2
  1148           88  CP-USE-PREM-AS-ENTERED          VALUE 'E'.            CL**2
  1149           88  CP-FARM-PLAN                    VALUE 'F'.            CL**2
  1150           88  CP-RATE-AS-STANDARD             VALUE 'G'.            CL**2
  1151           88  CP-2-MTH-INTEREST               VALUE 'I'.            CL**2
  1152           88  CP-3-MTH-INTEREST               VALUE 'J'.            CL**2
  1153           88  CP-4-MTH-INTEREST               VALUE 'K'.            CL**2
  1154           88  CP-BALLOON-LAST-PMT             VALUE 'L'.            CL**2
  1155           88  CP-MORTGAGE-REC                 VALUE 'M'.            CL**2
  1156           88  CP-OUTSTANDING-BALANCE          VALUE 'O'.            CL**2
  1157           88  CP-NET-PAY-PRUDENTIAL           VALUE 'P'.            CL**2
  1158           88  CP-NET-PAY-SIMPLE               VALUE 'S'.            CL**2
  1159           88  CP-TRUNCATED-LIFE               VALUE 'T' 'U' 'V'     CL**2
  1160                                                     'W' 'X'.        CL**2
  1161           88  CP-TRUNCATE-0-MTH               VALUE 'T'.            CL**2
  1162           88  CP-TRUNCATE-1-MTH               VALUE 'U'.            CL**2
  1163           88  CP-TRUNCATE-2-MTH               VALUE 'V'.            CL**2
  1164           88  CP-TRUNCATE-3-MTH               VALUE 'W'.            CL**2
  1165           88  CP-TRUNCATE-4-MTH               VALUE 'X'.            CL**2
  1166           88  CP-SUMMARY-REC                  VALUE 'Z'.            CL**2
  1167           88  CP-PROPERTY-BENEFIT             VALUE '2'.            CL**2
  1168           88  CP-UNEMPLOYMENT-BENEFIT         VALUE '3'.            CL**2
  1169           88  CP-AD-D-BENEFIT                 VALUE '4'.            CL**2
  1170           88  CP-CSL-METH-1                   VALUE '5'.            CL**2
  1171           88  CP-CSL-METH-2                   VALUE '6'.            CL**2
  1172           88  CP-CSL-METH-3                   VALUE '7'.            CL**2
  1173           88  CP-CSL-METH-4                   VALUE '8'.            CL**2
  1174                                                                     CL**2
  1175         16  CP-LOAN-TERM          PIC S9(3)       VALUE ZERO        CL**2
  1176                                     COMP-3.                         CL**2
  1177         16  CP-CLASS-CODE         PIC XX          VALUE ZERO.       CL**2
  1178         16  CP-DEVIATION-CODE     PIC XXX         VALUE ZERO.       CL**2
  1179         16  CP-STATE              PIC XX          VALUE SPACE.      CL**2
  1180         16  CP-STATE-STD-ABBRV    PIC XX          VALUE SPACE.      CL**2
  1181         16  CP-BENEFIT-CD         PIC XX          VALUE ZERO.       CL**2
  1182           88  CP-CSL-VALID-NP-BENEFIT-CD VALUES '12' '13'           CL**2
  1183               '34' '35' '36' '37' '44' '45' '46' '47' '72' '73'.    CL**2
  1184         16  CP-R78-OPTION         PIC X.                            CL**2
  1185           88  CP-TERM-TIMES-TERM-PLUS-1           VALUE ' '.        CL**2
  1186           88  CP-TERM-TIMES-TERM                  VALUE '1'.        CL**2
  1187                                                                     CL**2
  1188         16  CP-COMPANY-CD         PIC X             VALUE SPACE.    CL**2
  1189         16  CP-IBNR-RESERVE-SW    PIC X.                            CL**2
  1190         16  CP-CLAIM-STATUS       PIC X.                            CL**2
  1191         16  CP-RATE-FILE          PIC X.                            CL**2
  1192         16  CP-TERM-OR-EXT-DAYS   PIC S9(05)        VALUE ZERO      CL**2
  1193                                     COMP-3.                         CL**2
  1194                                                                     CL**2
  1195         16  CP-LIFE-OVERRIDE-CODE PIC X.                            CL**2
  1196         16  CP-AH-OVERRIDE-CODE   PIC X.                            CL**2
  1197                                                                     CL**2
  1198         16  CP-RATE-DEV-PCT       PIC S9V9(6)       VALUE ZERO      CL**2
  1199                                     COMP-3.
  1200         16  CP-CLP-RATE-UP        REDEFINES CP-RATE-DEV-PCT
  1201                                   PIC S9(5)V99 COMP-3.
  1202         16  CP-CRITICAL-MONTHS    PIC S9(3)         VALUE ZERO      CL**2
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  26
* ECS056TT.cbl (/apps/prod/cid1p/copy/ELCCALC)
  1203                                     COMP-3.                         CL**2
  1204         16  CP-ALTERNATE-BENEFIT  PIC S9(9)V99      VALUE ZERO      CL**2
  1205                                     COMP-3.                         CL**2
  1206         16  CP-ALTERNATE-PREMIUM  PIC S9(7)V99      VALUE ZERO      CL**2
  1207                                     COMP-3.
  1208         16  CP-DDF-CSO-ADMIN-FEE REDEFINES CP-ALTERNATE-PREMIUM
  1209                                  PIC S9(7)V99 COMP-3.
  1210                                                                     CL**2
  1211         16  CP-PAID-FROM-DATE     PIC X(02).                        CL**2
  1212         16  CP-CLAIM-CALC-METHOD  PIC X(01).                        CL**2
  1213         16  CP-EXT-DAYS-CALC      PIC X.                            CL**2
  1214           88  CP-EXT-NO-CHG                   VALUE ' '.            CL**2
  1215           88  CP-EXT-CHG-LF                   VALUE '1'.            CL**2
  1216           88  CP-EXT-CHG-AH                   VALUE '2'.            CL**2
  1217           88  CP-EXT-CHG-LF-AH                VALUE '3'.            CL**2
  1218         16  CP-DOMICILE-STATE     PIC XX.                           CL**2
  1219         16  CP-CARRIER            PIC X.                            CL**2
  1220         16  CP-REIN-FLAG          PIC X.                            CL**2
  1221         16  CP-REM-TRM-CALC-OPTION PIC X.                           CL**2
  1222           88  VALID-REM-TRM-CALC-OPTION    VALUE '1'                CL**2
  1223                      '2' '3' '4' '5'.                               CL**2
  1224           88  CP-CALC-OPTION-DEFAULT       VALUE '4'.               CL**2
  1225           88  CP-CONSIDER-EXTENSION        VALUE '3' '4' '5'.       CL**2
  1226           88  CP-30-DAY-MONTH              VALUE '1' '3' '5'.       CL**2
  1227           88  CP-NO-EXT-30-DAY-MONTH       VALUE '1'.               CL**2
  1228           88  CP-NO-EXT-ACTUAL-DAYS        VALUE '2'.               CL**2
  1229           88  CP-EXT-30-DAY-MONTH          VALUE '3'.               CL**2
  1230           88  CP-EXT-ACTUAL-DAYS           VALUE '4'.               CL**2
  1231           88  CP-USE-EXP-AND-1ST-PMT       VALUE '5'.
  1232         16  CP-SIG-SWITCH         PIC X.                            CL**2
  1233         16  CP-RATING-METHOD      PIC X.                            CL**2
  1234           88  CP-RATE-AS-R78                      VALUE '1' 'R'.    CL**2
  1235           88  CP-RATE-AS-PRORATA                  VALUE '2' 'P'.    CL**2
  1236           88  CP-RATE-AS-CALIF                    VALUE '3' 'C'.    CL**2
  1237           88  CP-RATE-AS-TEXAS                    VALUE '4' 'T'.    CL**2
  1238           88  CP-RATE-AS-FARM-PLAN                VALUE '4' 'T'.    CL**2
  1239           88  CP-RATE-AS-NET-PAY                  VALUE '5' 'N'.    CL**2
  1240           88  CP-RATE-AS-ANTICIPATION             VALUE '6' 'A'.    CL**2
  1241           88  CP-RATE-AS-MEAN                     VALUE '8' 'M'.    CL**2
  1242           88  CP-RATE-AS-REG-BALLOON              VALUE 'B'.        CL**2
  1243         16  CP-SALES-TAX          PIC S9V9999     VALUE  ZEROS      CL**2
  1244                                     COMP-3.                         CL**2
  1245         16  CP-BEN-CATEGORY       PIC X.
  1246         16  CP-DCC-LF-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  1247         16  CP-DCC-ACT-COMM REDEFINES CP-DCC-LF-RATE
  1248                                   PIC S99V9(5) COMP-3.
  1249         16  CP-DCC-AH-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  1250         16  CP-DCC-PMF-COMM REDEFINES CP-DCC-AH-RATE
  1251                                   PIC S99V9(5) COMP-3.
  1252         16  CP-DAYS-TO-1ST-PMT    PIC S999     COMP-3 VALUE +0.
  1253         16  CP-AH-BALLOON-SW      PIC X  VALUE ' '.
  1254         16  CP-EXPIRE-DT          PIC XX.
  1255         16  CP-LF-CLAIM-CALC-SW   PIC X  VALUE ' '.
  1256         16  CP-DDF-HI-FACT        PIC S9V999   COMP-3 VALUE +0.
  1257         16  CP-DDF-LO-FACT        PIC S9V999   COMP-3 VALUE +0.
  1258         16  CP-DDF-CLP            PIC S9(5)V99 COMP-3 VALUE +0.
  1259         16  CP-DDF-SPEC-CALC      PIC X.
  1260             88  CP-CALC-GROSS-FEE        VALUE 'G'.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  27
* ECS056TT.cbl (/apps/prod/cid1p/copy/ELCCALC)
  1261             88  CP-CALC-CLP              VALUE 'C'.
  1262         16  CP-IU-RATE-UP         PIC S9(5)V99   COMP-3 VALUE +0.
  1263         16  CP-CANCEL-REASON      PIC X.
  1264         16  CP-DDF-ADMIN-FEES     PIC S9(5)V99 COMP-3 VALUE +0.
  1265         16  CP-PMT-MODE           PIC X.
  1266         16  CP-NO-OF-PMTS         PIC S999 COMP-3 VALUE +0.
  1267         16  CP-1ST-YR-ALLOW       PIC S999V99 COMP-3 VALUE +0.
  1268         16  CP-DDF-COMM-AND-MFEE  PIC S9(5)V99 COMP-3 VALUE +0.
  1269         16  CP-DDF-YR1AF          PIC S9(5)V99 COMP-3 VALUE +0.
  1270         16  FILLER                PIC X.
  1271                                                                     CL**2
  1272***************    OUTPUT FROM ELRESV   ************************     CL**2
  1273                                                                     CL**2
  1274         16  CP-CDT-TABLE          PIC 9             VALUE ZERO.     CL**2
  1275                                                                     CL**2
  1276         16  CP-CDT-FACTOR         PIC S9(5)V9(6)    VALUE ZERO      CL**2
  1277                                     COMP-3.                         CL**2
  1278         16  CP-PTC-RESERVE        PIC S9(7)V99   VALUE ZERO         CL**2
  1279                                     COMP-3.                         CL**2
  1280         16  CP-IBNR-RESERVE       PIC S9(7)V99   VALUE ZERO         CL**2
  1281                                     COMP-3.                         CL**2
  1282         16  CP-FUTURE-RESERVE     PIC S9(7)V99   VALUE ZERO         CL**2
  1283                                     COMP-3.                         CL**2
  1284         16  FILLER                PIC X(09).                        CL**2
  1285***************    OUTPUT FROM ELRTRM   *************************    CL**2
  1286                                                                     CL**2
  1287         16  CP-REMAINING-TERM-1   PIC S9(4)V9    VALUE ZERO         CL**2
  1288                                     COMP-3.                         CL**2
  1289         16  CP-REMAINING-TERM-2   PIC S9(4)V9    VALUE ZERO         CL**2
  1290                                     COMP-3.                         CL**2
  1291         16  CP-REMAINING-TERM-3   PIC S9(4)V9    VALUE ZERO         CL**2
  1292                                     COMP-3.                         CL**2
  1293         16  CP-ODD-DAYS           PIC S9(3)      VALUE ZERO         CL**2
  1294                                     COMP-3.                         CL**2
  1295         16  FILLER                PIC X(12).                        CL**2
  1296                                                                     CL**2
  1297***************    OUTPUT FROM ELRAMT   *************************    CL**2
  1298                                                                     CL**2
  1299         16  CP-REMAINING-AMT      PIC S9(9)V99   VALUE ZERO         CL**2
  1300                                     COMP-3.                         CL**2
  1301         16  CP-REMAINING-AMT-PRV  PIC S9(9)V99   VALUE ZERO         CL**2
  1302                                     COMP-3.                         CL**2
  1303         16  FILLER                PIC X(12).                        CL**2
  1304                                                                     CL**2
  1305***************    OUTPUT FROM ELRATE   *************************    CL**2
  1306                                                                     CL**2
  1307         16  CP-CALC-PREMIUM       PIC S9(7)V99   VALUE ZERO         CL**2
  1308                                     COMP-3.                         CL**2
  1309         16  CP-PREMIUM-RATE       PIC S9(2)V9(5) VALUE ZERO         CL**2
  1310                                     COMP-3.                         CL**2
  1311         16  CP-MORTALITY-CODE     PIC X(4).                         CL**2
  1312         16  CP-RATE-EDIT-FLAG     PIC X.                            CL**2
  1313             88  CP-RATES-NEED-APR                  VALUE '1'.       CL**2
  1314         16  CP-COMPOSITE-RATE     PIC S99V999    VALUE ZERO         CL**2
  1315                                     COMP-3.                         CL**2
  1316         16  CP-POLICY-FEE         PIC S9(3)V99 VALUE +0 COMP-3.     CL**2
  1317         16  CP-LF-PREM            PIC S9(7)V99 VALUE +0 COMP-3.
  1318         16  CP-LF-BALLOON-PREM REDEFINES CP-LF-PREM
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  28
* ECS056TT.cbl (/apps/prod/cid1p/copy/ELCCALC)
  1319                                   PIC S9(7)V99 COMP-3.
  1320         16  FILLER                PIC X(07).                        CL**2
  1321                                                                     CL**2
  1322***************    OUTPUT FROM ELRFND   *************************    CL**2
  1323                                                                     CL**2
  1324         16  CP-CALC-REFUND        PIC S9(7)V99   VALUE ZERO         CL**2
  1325                                     COMP-3.                         CL**2
  1326         16  CP-REFUND-TYPE-USED   PIC X.                            CL**2
  1327           88  CP-R-AS-R78                         VALUE '1'.        CL**2
  1328           88  CP-R-AS-PRORATA                     VALUE '2'.        CL**2
  1329           88  CP-R-AS-CALIF                       VALUE '3'.        CL**2
  1330           88  CP-R-AS-TEXAS                       VALUE '4'.        CL**2
  1331           88  CP-R-AS-FARM-PLAN                   VALUE '4'.        CL**2
  1332           88  CP-R-AS-NET-PAY                     VALUE '5'.        CL**2
  1333           88  CP-R-AS-ANTICIPATION                VALUE '6'.        CL**2
  1334           88  CP-R-AS-MEAN                        VALUE '8'.        CL**2
  1335           88  CP-R-AS-SUM-OF-DIGITS               VALUE '9'.        CL**2
  1336           88  CP-R-AS-GAP-NON-REFUND              VALUE 'G'.
  1337           88  CP-R-AS-GAP-ACTUARIAL               VALUE 'S'.
  1338           88  CP-R-AS-SPP-DDF                     VALUE 'D'.
  1339           88  CP-R-AS-SPP-DDF-IU                  VALUE 'I'.
  1340           88  CP-R-AS-REPOSSESSION                VALUE 'R'.
  1341         16  FILLER                PIC X(12).                        CL**2
  1342                                                                     CL**2
  1343***************    OUTPUT FROM ELEARN   *************************    CL**2
  1344                                                                     CL**2
  1345         16  CP-R78-U-PRM          PIC S9(7)V99   VALUE ZERO         CL**2
  1346                                     COMP-3.                         CL**2
  1347         16  CP-R78-U-PRM-ALT      PIC S9(7)V99   VALUE ZERO         CL**2
  1348                                     COMP-3.                         CL**2
  1349         16  CP-PRORATA-U-PRM      PIC S9(7)V99   VALUE ZERO         CL**2
  1350                                     COMP-3.                         CL**2
  1351         16  CP-PRORATA-U-PRM-ALT  PIC S9(7)V99   VALUE ZERO         CL**2
  1352                                     COMP-3.                         CL**2
  1353         16  CP-STATE-U-PRM        PIC S9(7)V99   VALUE ZERO         CL**2
  1354                                     COMP-3.                         CL**2
  1355         16  CP-DOMICILE-U-PRM     PIC S9(7)V99   VALUE ZERO         CL**2
  1356                                     COMP-3.                         CL**2
  1357         16  CP-EARNING-TYPE-USED  PIC X.                            CL**2
  1358           88  CP-E-AS-SPECIAL                     VALUE 'S'.        CL**2
  1359           88  CP-E-AS-R78                         VALUE '1'.        CL**2
  1360           88  CP-E-AS-PRORATA                     VALUE '2'.        CL**2
  1361           88  CP-E-AS-TEXAS                       VALUE '4'.        CL**2
  1362           88  CP-E-AS-FARM-PLAN                   VALUE '4'.        CL**2
  1363           88  CP-E-AS-NET-PAY                     VALUE '5'.        CL**2
  1364           88  CP-E-AS-ANTICIPATION                VALUE '6'.        CL**2
  1365           88  CP-E-AS-MEAN                        VALUE '8'.        CL**2
  1366           88  CP-E-AS-SUM-OF-DIGITS               VALUE '9'.        CL**2
  1367         16  FILLER                PIC X(12).                        CL**2
  1368                                                                     CL**2
  1369***************    OUTPUT FROM ELPMNT   *************************    CL**2
  1370                                                                     CL**2
  1371         16  CP-ACTUAL-DAYS        PIC S9(05)     VALUE ZERO         CL**2
  1372                                     COMP-3.                         CL**2
  1373         16  CP-CLAIM-PAYMENT      PIC S9(7)V99   VALUE ZERO         CL**2
  1374                                     COMP-3.                         CL**2
  1375         16  FILLER                PIC X(12).                        CL**2
  1376                                                                     CL**2
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  29
* ECS056TT.cbl (/apps/prod/cid1p/copy/ELCCALC)
  1377***************   MISC WORK AREAS    *****************************   CL**2
  1378         16  CP-TOTAL-PAID         PIC S9(7)V99   VALUE ZERO         CL**2
  1379                                     COMP-3.                         CL**2
  1380         16  CP-R-MAX-ATT-AGE      PIC S9(3)      VALUE ZERO         CL**2
  1381                                     COMP-3.                         CL**2
  1382         16  CP-R-MAX-AGE          PIC S9(3)      VALUE ZERO         CL**2
  1383                                     COMP-3.                         CL**2
  1384         16  CP-R-MAX-TERM         PIC S9(5)      VALUE ZERO         CL**2
  1385                                     COMP-3.                         CL**2
  1386         16  CP-R-MAX-TOT-BEN      PIC S9(7)V99   VALUE ZERO         CL**2
  1387                                     COMP-3.                         CL**2
  1388         16  CP-R-MAX-MON-BEN      PIC S9(7)V99   VALUE ZERO         CL**2
  1389                                     COMP-3.                         CL**2
  1390         16  CP-IO-FUNCTION        PIC X          VALUE SPACE.       CL**2
  1391             88  OPEN-RATE-FILE                   VALUE 'O'.         CL**2
  1392             88  CLOSE-RATE-FILE                  VALUE 'C'.         CL**2
  1393             88  IO-ERROR                         VALUE 'E'.         CL**2
  1394                                                                     CL**2
  1395         16  CP-FIRST-PAY-DATE     PIC XX.                           CL**2
  1396                                                                     CL**2
  1397         16  CP-JOINT-INDICATOR    PIC X.                            CL**2
  1398                                                                     CL**2
  1399         16  CP-RESERVE-REMAINING-TERM                               CL**2
  1400                                   PIC S9(4)V9    VALUE ZERO         CL**2
  1401                                     COMP-3.                         CL**2
  1402                                                                     CL**2
  1403         16  CP-INSURED-BIRTH-DT   PIC XX.                           CL**2
  1404                                                                     CL**2
  1405         16  CP-INCURRED-AGE       PIC S9(3)      VALUE ZERO         CL**2
  1406                                     COMP-3.                         CL**2
  1407                                                                     CL**2
  1408         16  CP-MONTHLY-PAYMENT    PIC S9(5)V99   VALUE ZERO         CL**2
  1409                                     COMP-3.                         CL**2
  1410                                                                     CL**2
  1411         16  CP-RATING-BENEFIT-AMT PIC S9(9)V99   VALUE ZERO         CL**2
  1412                                     COMP-3.                         CL**2
  1413                                                                     CL**2
  1414         16  CP-ODD-DAYS-TO-PMT    PIC S9(3)      VALUE ZERO         CL**2
  1415                                     COMP-3.                         CL**2
  1416                                                                     CL**2
  1417         16  CP-MNTHS-TO-FIRST-PMT PIC S9(3)      VALUE ZERO         CL**2
  1418                                     COMP-3.                         CL**2
  1419                                                                     CL**2
  1420         16  CP-REMAMT-FACTOR      PIC S9(4)V9(9) VALUE ZEROS        CL**2
  1421                                     COMP-3.                         CL**2
  1422                                                                     CL**2
  1423         16  CP-FREE-LOOK          PIC S9(3)      VALUE ZERO         CL**2
  1424                                     COMP-3.                         CL**2
  1425                                                                     CL**2
  1426         16  CP-ROA-REFUND         PIC X          VALUE 'N'.         CL**2
  1427             88  CP-ROA-PREM-AT-REFUND            VALUE 'Y'.         CL**2
  1428                                                                     CL**2
  1429         16  CP-NET-BENEFIT-AMT    PIC S9(9)V99   VALUE ZERO         CL**2
  1430                                     COMP-3.                         CL**2
  1431         16  CP-SCNP-6MO-AMT       PIC S9(9)V99   VALUE ZERO
  1432                                     COMP-3.
  1433         16  CP-MONTH              PIC S999     COMP-3 VALUE +0.
  1434         16  cp-extra-periods      pic 9 value zeros.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  30
* ECS056TT.cbl (/apps/prod/cid1p/copy/ELCCALC)
  1435         16  cp-net-only-state     pic x value spaces.
  1436         16  FILLER                PIC X(13).                        CL**2
  1437******************************************************************   CL**2
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  31
* ECS056TT.cbl
  1438/
* 1439                                 COPY ELCDATE.
  1440******************************************************************06/11/98
  1441*                                                                *ELCDATE
  1442*                                                                *ELCDATE
  1443*                            ELCDATE.                            *   LV023
  1444*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL*16
  1445*                            VMOD=2.003                           ELCDATE
  1446*                                                                *ELCDATE
  1447*                                                                *ELCDATE
  1448*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *ELCDATE
  1449*                 LENGTH = 200                                   *   CL*19
  1450******************************************************************ELCDATE
  1451                                                                  ELCDATE
  1452 01  DATE-CONVERSION-DATA.                                        ELCDATE
  1453     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.    CL*19
  1454     12  DC-OPTION-CODE                PIC X.                        CL*15
  1455         88  BIN-TO-GREG                VALUE ' '.                ELCDATE
  1456         88  ELAPSED-BETWEEN-BIN        VALUE '1'.                ELCDATE
  1457         88  EDIT-GREG-TO-BIN           VALUE '2'.                ELCDATE
  1458         88  YMD-GREG-TO-BIN            VALUE '3'.                ELCDATE
  1459         88  MDY-GREG-TO-BIN            VALUE '4'.                ELCDATE
  1460         88  JULIAN-TO-BIN              VALUE '5'.                ELCDATE
  1461         88  BIN-PLUS-ELAPSED           VALUE '6'.                ELCDATE
  1462         88  FIND-CENTURY               VALUE '7'.                   CL*22
  1463         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.                ELCDATE
  1464         88  EDIT-GREG-TO-BIN-3         VALUE '9'.                ELCDATE
  1465         88  YMD-GREG-TO-BIN-3          VALUE 'A'.                ELCDATE
  1466         88  MDY-GREG-TO-BIN-3          VALUE 'B'.                ELCDATE
  1467         88  JULIAN-TO-BIN-3            VALUE 'C'.                ELCDATE
  1468         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.                ELCDATE
  1469         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.                   CL*14
  1470         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.                   CL*14
  1471         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.                   CL*14
  1472         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.         CL*14
  1473         88  CHECK-LEAP-YEAR            VALUE 'H'.                   CL*14
  1474         88  BIN-3-TO-GREG              VALUE 'I'.                   CL*14
  1475         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.                   CL*14
  1476         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.                   CL*14
  1477         88  CYMD-GREG-TO-BIN           VALUE 'L'.                   CL*14
  1478         88  MDCY-GREG-TO-BIN           VALUE 'M'.                   CL*14
  1479         88  MDY-GREG-TO-JULIAN         VALUE 'N'.                   CL*14
  1480         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.                   CL*14
  1481         88  YMD-GREG-TO-JULIAN         VALUE 'P'.                   CL*14
  1482         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.                   CL*14
  1483         88  THREE-CHARACTER-BIN                                  ELCDATE
  1484                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.       CL*14
  1485         88  GREGORIAN-TO-BIN                                        CL**2
  1486                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.    CL*14
  1487         88  BIN-TO-GREGORIAN                                        CL**2
  1488                  VALUES ' ' '1' 'I' '8' 'G'.                        CL*14
  1489         88  JULIAN-TO-BINARY                                        CL**2
  1490                  VALUES '5' 'C' 'E' 'F'.                            CL*14
  1491     12  DC-ERROR-CODE                 PIC X.                        CL*15
  1492         88  NO-CONVERSION-ERROR        VALUE ' '.                   CL**3
  1493         88  DATE-CONVERSION-ERROR                                ELCDATE
  1494                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.        CL*14
  1495         88  DATE-IS-ZERO               VALUE '1'.                ELCDATE
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  32
* ECS056TT.cbl (/apps/prod/cid1p/copy/ELCDATE)
  1496         88  DATE-IS-NON-NUMERIC        VALUE '2'.                ELCDATE
  1497         88  DATE-IS-INVALID            VALUE '3'.                ELCDATE
  1498         88  DATE1-GREATER-DATE2        VALUE '4'.                ELCDATE
  1499         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.                ELCDATE
  1500         88  DATE-INVALID-OPTION        VALUE '9'.                ELCDATE
  1501         88  INVALID-CENTURY            VALUE 'A'.                ELCDATE
  1502         88  ONLY-CENTURY               VALUE 'B'.                ELCDATE
  1503         88  ONLY-LEAP-YEAR             VALUE 'C'.                ELCDATE
  1504         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.              CL**3
  1505     12  DC-END-OF-MONTH               PIC X.                        CL*15
  1506         88  CALCULATE-END-OF-MONTH     VALUE '1'.                ELCDATE
  1507     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.         CL*15
  1508         88  USE-NORMAL-PROCESS         VALUE ' '.                ELCDATE
  1509         88  ADJUST-DOWN-100-YRS        VALUE '1'.                ELCDATE
  1510         88  ADJUST-UP-100-YRS          VALUE '2'.                ELCDATE
  1511     12  FILLER                        PIC X.                        CL*15
  1512     12  DC-CONVERSION-DATES.                                        CL*15
  1513         16  DC-BIN-DATE-1             PIC XX.                       CL*15
  1514         16  DC-BIN-DATE-2             PIC XX.                       CL*15
  1515         16  DC-GREG-DATE-1-EDIT       PIC X(08).                    CL*15
  1516         16  DC-GREG-DATE-1-EDIT-R REDEFINES                         CL*15
  1517                       DC-GREG-DATE-1-EDIT.                       ELCDATE
  1518             20  DC-EDIT1-MONTH        PIC 99.                       CL*15
  1519             20  SLASH1-1              PIC X.                        CL*15
  1520             20  DC-EDIT1-DAY          PIC 99.                       CL*15
  1521             20  SLASH1-2              PIC X.                        CL*15
  1522             20  DC-EDIT1-YEAR         PIC 99.                       CL*15
  1523         16  DC-GREG-DATE-2-EDIT       PIC X(08).                    CL*15
  1524         16  DC-GREG-DATE-2-EDIT-R REDEFINES                         CL*15
  1525                     DC-GREG-DATE-2-EDIT.                         ELCDATE
  1526             20  DC-EDIT2-MONTH        PIC 99.                       CL*15
  1527             20  SLASH2-1              PIC X.                        CL*15
  1528             20  DC-EDIT2-DAY          PIC 99.                       CL*15
  1529             20  SLASH2-2              PIC X.                        CL*15
  1530             20  DC-EDIT2-YEAR         PIC 99.                       CL*15
  1531         16  DC-GREG-DATE-1-YMD        PIC 9(06).                    CL*15
  1532         16  DC-GREG-DATE-1-YMD-R  REDEFINES                         CL*15
  1533                     DC-GREG-DATE-1-YMD.                          ELCDATE
  1534             20  DC-YMD-YEAR           PIC 99.                       CL*15
  1535             20  DC-YMD-MONTH          PIC 99.                       CL*15
  1536             20  DC-YMD-DAY            PIC 99.                       CL*15
  1537         16  DC-GREG-DATE-1-MDY        PIC 9(06).                    CL*15
  1538         16  DC-GREG-DATE-1-MDY-R REDEFINES                          CL*15
  1539                      DC-GREG-DATE-1-MDY.                         ELCDATE
  1540             20  DC-MDY-MONTH          PIC 99.                       CL*15
  1541             20  DC-MDY-DAY            PIC 99.                       CL*15
  1542             20  DC-MDY-YEAR           PIC 99.                       CL*15
  1543         16  DC-GREG-DATE-1-ALPHA.                                   CL*15
  1544             20  DC-ALPHA-MONTH        PIC X(10).                    CL*15
  1545             20  DC-ALPHA-DAY          PIC 99.                       CL*15
  1546             20  FILLER                PIC XX.                       CL*15
  1547             20  DC-ALPHA-CENTURY.                                   CL*15
  1548                 24 DC-ALPHA-CEN-N     PIC 99.                       CL*15
  1549             20  DC-ALPHA-YEAR         PIC 99.                       CL*15
  1550         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.           CL*15
  1551         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.           CL*15
  1552         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.           CL*15
  1553         16  DC-JULIAN-DATE            PIC 9(05).                    CL*15
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  33
* ECS056TT.cbl (/apps/prod/cid1p/copy/ELCDATE)
  1554         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE                CL*20
  1555                                       PIC 9(05).                    CL*20
  1556         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.                  CL*15
  1557             20  DC-JULIAN-YEAR        PIC 99.                       CL*15
  1558             20  DC-JULIAN-DAYS        PIC 999.                      CL*15
  1559         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.       CL*15
  1560         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.    CL*15
  1561         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.    CL*15
  1562     12  DATE-CONVERSION-VARIBLES.                                   CL*15
  1563         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.            CL*15
  1564         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.          CL*15
  1565             20  FILLER                PIC 9(3).                     CL*15
  1566             20  HOLD-CEN-1-CCYY.                                    CL*15
  1567                 24  HOLD-CEN-1-CC     PIC 99.                       CL*17
  1568                 24  HOLD-CEN-1-YY     PIC 99.                       CL*17
  1569             20  HOLD-CEN-1-MO         PIC 99.                       CL*17
  1570             20  HOLD-CEN-1-DA         PIC 99.                       CL*17
  1571         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.            CL*15
  1572             20  HOLD-CEN-1-R-MO       PIC 99.                       CL*17
  1573             20  HOLD-CEN-1-R-DA       PIC 99.                       CL*17
  1574             20  HOLD-CEN-1-R-CCYY.                                  CL*15
  1575                 24  HOLD-CEN-1-R-CC   PIC 99.                       CL*17
  1576                 24  HOLD-CEN-1-R-YY   PIC 99.                       CL*17
  1577             20  FILLER                PIC 9(3).                     CL*15
  1578         16  HOLD-CENTURY-1-X.                                       CL*15
  1579             20  FILLER                PIC X(3)  VALUE SPACES.       CL*15
  1580             20  HOLD-CEN-1-X-CCYY.                                  CL*15
  1581                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.          CL*17
  1582                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.          CL*17
  1583             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.          CL*17
  1584             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.          CL*17
  1585         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.          CL*15
  1586             20  HOLD-CEN-1-R-X-MO     PIC XX.                       CL*17
  1587             20  HOLD-CEN-1-R-X-DA     PIC XX.                       CL*17
  1588             20  HOLD-CEN-1-R-X-CCYY.                                CL*15
  1589                 24  HOLD-CEN-1-R-X-CC PIC XX.                       CL*17
  1590                 24  HOLD-CEN-1-R-X-YY PIC XX.                       CL*17
  1591             20  FILLER                PIC XXX.                      CL*23
  1592         16  DC-BIN-DATE-EXPAND-1      PIC XXX.                      CL*15
  1593         16  DC-BIN-DATE-EXPAND-2      PIC XXX.                      CL*15
  1594         16  DC-JULIAN-DATE-1          PIC 9(07).                    CL*15
  1595         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.          CL*15
  1596             20  DC-JULIAN-1-CCYY.                                   CL*15
  1597                 24  DC-JULIAN-1-CC    PIC 99.                       CL*15
  1598                 24  DC-JULIAN-1-YR    PIC 99.                       CL*15
  1599             20  DC-JULIAN-DA-1        PIC 999.                      CL*15
  1600         16  DC-JULIAN-DATE-2          PIC 9(07).                    CL*15
  1601         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.          CL*15
  1602             20  DC-JULIAN-2-CCYY.                                   CL*15
  1603                 24  DC-JULIAN-2-CC    PIC 99.                       CL*15
  1604                 24  DC-JULIAN-2-YR    PIC 99.                       CL*15
  1605             20  DC-JULIAN-DA-2        PIC 999.                      CL*15
  1606         16  DC-GREG-DATE-A-EDIT.                                    CL*15
  1607             20  DC-EDITA-MONTH        PIC 99.                       CL*15
  1608             20  SLASHA-1              PIC X VALUE '/'.              CL*15
  1609             20  DC-EDITA-DAY          PIC 99.                       CL*15
  1610             20  SLASHA-2              PIC X VALUE '/'.              CL*15
  1611             20  DC-EDITA-CCYY.                                      CL*15
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  34
* ECS056TT.cbl (/apps/prod/cid1p/copy/ELCDATE)
  1612                 24  DC-EDITA-CENT     PIC 99.                       CL*15
  1613                 24  DC-EDITA-YEAR     PIC 99.                       CL*15
  1614         16  DC-GREG-DATE-B-EDIT.                                    CL*15
  1615             20  DC-EDITB-MONTH        PIC 99.                       CL*15
  1616             20  SLASHB-1              PIC X VALUE '/'.              CL*15
  1617             20  DC-EDITB-DAY          PIC 99.                       CL*15
  1618             20  SLASHB-2              PIC X VALUE '/'.              CL*15
  1619             20  DC-EDITB-CCYY.                                      CL*15
  1620                 24  DC-EDITB-CENT     PIC 99.                       CL*15
  1621                 24  DC-EDITB-YEAR     PIC 99.                       CL*15
  1622         16  DC-GREG-DATE-CYMD         PIC 9(08).                    CL*15
  1623         16  DC-GREG-DATE-CYMD-R REDEFINES                           CL*15
  1624                              DC-GREG-DATE-CYMD.                  ELCDATE
  1625             20  DC-CYMD-CEN           PIC 99.                       CL*15
  1626             20  DC-CYMD-YEAR          PIC 99.                       CL*15
  1627             20  DC-CYMD-MONTH         PIC 99.                       CL*15
  1628             20  DC-CYMD-DAY           PIC 99.                       CL*15
  1629         16  DC-GREG-DATE-MDCY         PIC 9(08).                    CL*15
  1630         16  DC-GREG-DATE-MDCY-R REDEFINES                           CL*15
  1631                              DC-GREG-DATE-MDCY.                  ELCDATE
  1632             20  DC-MDCY-MONTH         PIC 99.                       CL*15
  1633             20  DC-MDCY-DAY           PIC 99.                       CL*15
  1634             20  DC-MDCY-CEN           PIC 99.                       CL*15
  1635             20  DC-MDCY-YEAR          PIC 99.                       CL*15
  1636    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.      ELCDATE
  1637        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.        ELCDATE
  1638    12  DC-EL310-DATE                  PIC X(21).                    CL*26
  1639    12  FILLER                         PIC X(28).                    CL*26
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  35
* ECS056TT.cbl
  1640/
* 1641                                 COPY ELCDTECX.
  1642******************************************************************06/05/98
  1643*                                                                *ELCDTECX
  1644*                            ELCDTECX.                           *   LV005
  1645*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  1646*                            VMOD=2.015                          *ELCDTECX
  1647*                                                                *ELCDTECX
  1648*      WORKING STORAGE COPY CODE FOR APPLICATIONS CALLING        *ELCDTECX
  1649*      THE DATE CARD DISK FILE. ( READ ROUTINE = ELCDTERX,       *ELCDTECX
  1650*      AND DISK FILE FD = ELCDTEFX)                              *ELCDTECX
  1651*                                                                *ELCDTECX
  1652******************************************************************ELCDTECX
  1653******************************************************************
  1654*                   C H A N G E   L O G
  1655*
  1656* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1657*-----------------------------------------------------------------
  1658*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1659* EFFECTIVE    NUMBER
  1660*-----------------------------------------------------------------
  1661* 092602    2002091900008  PEMA  INCREASE NUMBER OF MAXIMUM
  1662*                                  BENEFIT CODES FROM 300 TO 900
  1663* 090803    2003080800002  PEMA  ADD CATEGORY FOR SUPER GAP
  1664* 051304    2003080800002  SMVA  ADD REFUND METHOD
  1665* 071714    2013100100002  PEMA  FIX CRIT PERIOD EDITS
  1666******************************************************************
  1667 01  DATE-CARD.                                                   ELCDTECX
  1668     12  DATX-COD                    PIC  X(4).                   ELCDTECX
  1669     12  RUN-DATE                    PIC  9(11)  COMP-3.          ELCDTECX
  1670     12  ALPH-DATE                   PIC  X(18).                  ELCDTECX
  1671     12  EP-DT                       PIC  9(11)  COMP-3.          ELCDTECX
  1672     12  PEND-ACT-FILE               PIC  XX.                     ELCDTECX
  1673     12  EP-SW                       PIC  X.                      ELCDTECX
  1674         88  NO-EP-EXTRACTS          VALUE SPACE.                 ELCDTECX
  1675     12  TAPE-BATCHES                PIC  X.                      ELCDTECX
  1676         88  TP-PREL-BAL             VALUE '1'.                   ELCDTECX
  1677     12  BIN-RUN-DATE                PIC  XX.                     ELCDTECX
  1678     12  RUN-CENTURY.                                             ELCDTECX
  1679         16 RUN-CENTURY-N            PIC  99.                        CL**4
  1680     12  FILLER                      PIC  X.                         CL**4
  1681     12  CLAS-MORT-OVRD              PIC  X(4).                   ELCDTECX
  1682     12  FILLER                      PIC  XXX.                    ELCDTECX
  1683     12  COMPANY-NAME                PIC  X(30).                  ELCDTECX
  1684                                                                  ELCDTECX
  1685 01  FILLER                          PIC  X(7)                       CL**6
  1686                                          VALUE 'OPTIONS'.        ELCDTECX
  1687 01  DATE-CARD-OPTIONS.                                           ELCDTECX
  1688     12  DATE-OPTIONS-ID             PIC  X(4).                   ELCDTECX
  1689     12  DTE-MIN-PREM                PIC  99V99.                  ELCDTECX
  1690     12  DTE-LANGUAGE-IND            PIC  X.                      ELCDTECX
  1691         88  DTE-LANGUAGE-IS-FR           VALUE 'F'.              ELCDTECX
  1692         88  DTE-LANGUAGE-IS-ENG          VALUE 'E'.              ELCDTECX
  1693     12  DTE-MIN-AGE                 PIC  99.                     ELCDTECX
  1694     12  DTE-DEFAULT-AGE             PIC  99.                     ELCDTECX
  1695     12  FILLER                      PIC  X.                      ELCDTECX
  1696     12  DTE-MAX-TERM                PIC  999.                    ELCDTECX
  1697     12  DTE-COMP-VG                 PIC  X.                      ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  36
* ECS056TT.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  1698     12  DTE-REM-TRM                 PIC  X.                      ELCDTECX
  1699     12  DTE-PRM-CK                  PIC S99V99.                  ELCDTECX
  1700     12  DTE-PRORATA                 PIC  X.                      ELCDTECX
  1701     12  DTE-CLM-REJ                 PIC  X.                      ELCDTECX
  1702     12  DTE-REF-REJ                 PIC  X.                      ELCDTECX
  1703     12  DTE-COM-TBL-USED            PIC  X.                      ELCDTECX
  1704     12  FILLER                      PIC  X.                      ELCDTECX
  1705     12  DTE-QTR-CO                  PIC  X.                      ELCDTECX
  1706     12  DTE-REF-CK                  PIC S99V99.                  ELCDTECX
  1707     12  DTE-CLM-CK                  PIC S99V99.                  ELCDTECX
  1708     12  DTE-CONV-DT                 PIC 9(11) COMP-3.               CL**2
  1709     12  DTE-DEFAULT-SEX             PIC  X.                      ELCDTECX
  1710     12  DTE-EPL-FORMAT              PIC  X.                      ELCDTECX
  1711     12  FILLER                      PIC  X.                      ELCDTECX
  1712     12  DTE-JT-AGE                  PIC  X.                      ELCDTECX
  1713     12  DTE-KEY-BIRTH               PIC  X.                      ELCDTECX
  1714     12  DTE-REINSURANCE             PIC  X.                      ELCDTECX
  1715     12  DTE-CLAIM-SORT              PIC  X.                      ELCDTECX
  1716     12  DTE-WRT-OFF                 PIC  S99V99.                 ELCDTECX
  1717     12  DTE-R78                     PIC  X.                      ELCDTECX
  1718     12  DTE-DLY-BILL                PIC  X.                      ELCDTECX
  1719     12  DTE-ALT-MORT-CODE           PIC  X(4).                   ELCDTECX
  1720     12  DTE-CLAIM-PAID-THRU-TO      PIC  X.                      ELCDTECX
  1721     12  DTE-COMPENSATION-ACCESS     PIC  X.                      ELCDTECX
  1722     12  DTE-MORTG-ACCESS-CNTL       PIC  X.                      ELCDTECX
  1723     12  DTE-MP-ALT-MORT-CODE        PIC  X(4).                   ELCDTECX
  1724     12  DTE-MORTALITY-AGE-CALC-METHOD                            ELCDTECX
  1725                                     PIC  X.                      ELCDTECX
  1726         88  DTE-USE-TABLE-ASSIGNED-METHOD VALUE '1'              ELCDTECX
  1727                                                 ' '.             ELCDTECX
  1728         88  DTE-USE-ALL-AGE-LAST          VALUE '2'.             ELCDTECX
  1729         88  DTE-USE-ALL-AGE-NEAR          VALUE '3'.             ELCDTECX
  1730     12  DTE-RESERVE-OPTION-SWITCH   PIC  X.                      ELCDTECX
  1731         88  DTE-OPT-RESERVE-METHOD-AUTH       VALUE 'Y'.         ELCDTECX
  1732         88  DTE-OPT-RESERVE-METHOD-UNAUTH     VALUE 'N' ' '.     ELCDTECX
  1733     12  DTE-REM-TRM-CALC-OPTION     PIC  X.                      ELCDTECX
  1734     12  DTE-EXPERIENCE-RETENTION-AGE                             ELCDTECX
  1735                                     PIC  9.                         CL**4
  1736     12  DTE-SYSTEM.                                              ELCDTECX
  1737         16  DTE-SYS-A-CREDIT        PIC  X.                      ELCDTECX
  1738         16  DTE-SYS-B-PEND-CLAIM    PIC  X.                      ELCDTECX
  1739         16  DTE-SYS-C-CONFIRMATIONS PIC  X.                      ELCDTECX
  1740         16  DTE-SYS-D-DEMAND-BILL   PIC  X.                      ELCDTECX
  1741         16  DTE-SYS-E-CLASIC-CLAIMS PIC  X.                      ELCDTECX
  1742         16  DTE-SYS-F-CLASIC-CREDIT PIC  X.                      ELCDTECX
  1743         16  DTE-SYS-G-AR-USED       PIC  X.                      ELCDTECX
  1744         16  DTE-SYS-H               PIC  X.                      ELCDTECX
  1745         16  DTE-SYS-I               PIC  X.                      ELCDTECX
  1746         16  DTE-SYS-J               PIC  X.                      ELCDTECX
  1747         16  DTE-SYS-K               PIC  X.                      ELCDTECX
  1748         16  DTE-SYS-L               PIC  X.                      ELCDTECX
  1749         16  DTE-SYS-M               PIC  X.                      ELCDTECX
  1750         16  DTE-SYS-N               PIC  X.                      ELCDTECX
  1751         16  DTE-SYS-O               PIC  X.                      ELCDTECX
  1752         16  DTE-SYS-P               PIC  X.                      ELCDTECX
  1753         16  DTE-SYS-Q               PIC  X.                      ELCDTECX
  1754         16  DTE-SYS-R               PIC  X.                      ELCDTECX
  1755         16  DTE-SYS-S               PIC  X.                      ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  37
* ECS056TT.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  1756         16  DTE-SYS-T               PIC  X.                      ELCDTECX
  1757         16  DTE-SYS-U               PIC  X.                      ELCDTECX
  1758         16  DTE-SYS-V               PIC  X.                      ELCDTECX
  1759         16  DTE-SYS-W               PIC  X.                      ELCDTECX
  1760         16  DTE-SYS-X               PIC  X.                      ELCDTECX
  1761         16  DTE-SYS-Y               PIC  X.                      ELCDTECX
  1762         16  DTE-SYS-Z               PIC  X.                      ELCDTECX
  1763     12  FILLER                      REDEFINES DTE-SYSTEM.        ELCDTECX
  1764         16  DTE-SYS-CODE            OCCURS 26 TIMES              ELCDTECX
  1765                                     PIC  X.                      ELCDTECX
  1766     12  DTE-CLIENT                  PIC  XXX.                    ELCDTECX
  1767                                                                  ELCDTECX
  1768 01  CLASIC-SYSTEM-CODES.                                         ELCDTECX
  1769     12  DTE-COLC-ID                 PIC  X(4).                   ELCDTECX
  1770     12  DTE-CLASIC-COMPANY-CD       PIC  X.                      ELCDTECX
  1771     12  DTE-CLASIC-COMPANY-NUMBER   PIC  999.                    ELCDTECX
  1772*    12  DTE-CLASIC-CLAIM-ACCESS     PIC  X.                      ELCDTECX
  1773     12  FILLER                      PIC  X.                      ELCDTECX
  1774     12  CLASIC-REIN-MAINT           PIC  XX.                     ELCDTECX
  1775     12  CLASIC-COMP-MAINT           PIC  XX.                     ELCDTECX
  1776     12  CLASIC-ACCT-MAINT           PIC  XX.                     ELCDTECX
  1777     12  CLASIC-CTBL-MAINT           PIC  XX.                     ELCDTECX
  1778     12  CLASIC-RATE-MAINT           PIC  XX.                     ELCDTECX
  1779     12  CLASIC-CREDIT-EOM-DT        PIC  XX.                     ELCDTECX
  1780     12  CLASIC-CLAIMS-EOM-DT        PIC  XX.                     ELCDTECX
  1781                                                                  ELCDTECX
  1782     12  LIFE-OVERRIDE-L1            PIC  X.                      ELCDTECX
  1783     12  LIFE-OVERRIDE-L2            PIC  XX.                     ELCDTECX
  1784     12  LIFE-OVERRIDE-L6            PIC  X(6).                   ELCDTECX
  1785     12  LIFE-OVERRIDE-L12           PIC  X(12).                  ELCDTECX
  1786                                                                  ELCDTECX
  1787     12  AH-OVERRIDE-L1              PIC  X.                      ELCDTECX
  1788     12  AH-OVERRIDE-L2              PIC  XX.                     ELCDTECX
  1789     12  AH-OVERRIDE-L6              PIC  X(6).                   ELCDTECX
  1790     12  AH-OVERRIDE-L12             PIC  X(12).                  ELCDTECX
  1791                                                                  ELCDTECX
  1792     12  CLAS-REPORT-CD1-CAPTION     PIC  X(10).                  ELCDTECX
  1793     12  CLAS-REPORT-CD2-CAPTION     PIC  X(10).                  ELCDTECX
  1794                                                                  ELCDTECX
  1795     12  CLASIC-MORTG-EOM-DT         PIC  XX.                     ELCDTECX
  1796     12  CLASIC-AR-EOM-DT            PIC  XX.                     ELCDTECX
  1797                                                                  ELCDTECX
  1798     12  FILLER                      PIC  X(11)      VALUE SPACE. ELCDTECX
  1799                                                                  ELCDTECX
  1800 01  DATE-CARD-FACTORS.                                           ELCDTECX
  1801     12  DATE-FACTOR-ID              PIC  X(4).                   ELCDTECX
  1802     12  FAC-1                       PIC S999V9(5).               ELCDTECX
  1803     12  FAC-2                       PIC S999V9(5).               ELCDTECX
  1804     12  FAC-3                       PIC S999V9(5).               ELCDTECX
  1805     12  FAC-4                       PIC S999V9(5).               ELCDTECX
  1806     12  FAC-5                       PIC S999V9(5).               ELCDTECX
  1807     12  FAC-6                       PIC S999V9(5).               ELCDTECX
  1808                                                                  ELCDTECX
  1809 01  FILLER                          PIC  X(12)                   ELCDTECX
  1810                                          VALUE 'COMPANY NAME'.   ELCDTECX
  1811 01  COMPANY-NAME-TABLE.                                          ELCDTECX
  1812     12  C-N-TBL                     OCCURS 6 TIMES.              ELCDTECX
  1813         16  CNT-ID                  PIC  X.                      ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  38
* ECS056TT.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  1814         16  CNT-NAME                PIC  X(30).                  ELCDTECX
  1815                                                                  ELCDTECX
  1816 01  FILLER                          PIC  X(11)                   ELCDTECX
  1817                                          VALUE 'STATE NAMES'.    ELCDTECX
  1818 01  STATE-NAMES.                                                 ELCDTECX
  1819     12  STATE-NAME-FLD              OCCURS 75 TIMES.             ELCDTECX
  1820         16  STATE-SUB               PIC  XX.                     ELCDTECX
  1821         16  STATE-PIC1.                                          ELCDTECX
  1822             20  STATE-ABBR          PIC  XX.                     ELCDTECX
  1823             20  FILLER              PIC  XXX.                    ELCDTECX
  1824             20  STATE-PIC           PIC  X(20).                  ELCDTECX
  1825             20  STATE-CALL-EARN     PIC  X.                      ELCDTECX
  1826             20  STATE-CALL-BREAK    PIC  X.                      ELCDTECX
  1827             20  STATE-PRIM-FAC-DEV  PIC  XXX.                    ELCDTECX
  1828                                                                  ELCDTECX
  1829 01  FILLER                          PIC  X(13)                   ELCDTECX
  1830                                          VALUE 'CARRIER NAMES'.  ELCDTECX
  1831 01  CARRIER-NAMES.                                               ELCDTECX
  1832     12  CARRIER-NAME-FLD            OCCURS 25 TIMES.             ELCDTECX
  1833         16  CARRIER-SUB             PIC  X.                      ELCDTECX
  1834         16  CARRIER-DOM-ST          PIC  XX.                     ELCDTECX
  1835         16  CARRIER-PIC             PIC  X(30).                  ELCDTECX
  1836         16  CARRIER-UEP-PCT         PIC  S9V9(4) COMP-3.            CL**6
  1837         16  CARRIER-R78-PCT         PIC  S9V9(4) COMP-3.            CL**6
  1838         16  CARRIER-PRO-PCT         PIC  S9V9(4) COMP-3.            CL**6
  1839*        16  FILLER                  PIC  X.                      ELCDTECX
  1840         16  CARRIER-SEC-PAY         PIC  X.
  1841             88  SEC-PAY-CARRIER          VALUE 'Y'.
  1842                                                                  ELCDTECX
  1843 01  FILLER                          PIC  X(9)                       CL**6
  1844                                          VALUE 'INS TYPES'.      ELCDTECX
  1845 01  CLAS-INS-TYPES.                                              ELCDTECX
  1846*    12 CLAS-ALL-TYPES               OCCURS 300 TIMES.            ELCDTECX
  1847     12 CLAS-ALL-TYPES               OCCURS 900 TIMES.            ELCDTECX
  1848         16  CLAS-I-BEN              PIC  XX.                     ELCDTECX
  1849         16  CLAS-I-AB3.                                          ELCDTECX
  1850             20  FILLER              PIC  X.                      ELCDTECX
  1851             20  CLAS-I-AB2.                                      ELCDTECX
  1852                 24  FILLER          PIC  X.                      ELCDTECX
  1853                 24  CLAS-I-AB1      PIC  X.                      ELCDTECX
  1854         16  CLAS-I-AB3-AH REDEFINES CLAS-I-AB3.                  ELCDTECX
  1855             20  CLAS-EXCLUSION      PIC  XX.                        CL**4
  1856             20  FILLER              PIC  X.                         CL**4
  1857         16  CLAS-I-AB10.                                         ELCDTECX
  1858             20  FILLER              PIC  X(9).                   ELCDTECX
  1859             20  CLAS-I-REIN-YN      PIC  X.                      ELCDTECX
  1860         16  CLAS-I-COMMENT          PIC  X(10).                  ELCDTECX
  1861         16  CLAS-I-JOINT            PIC  X.                      ELCDTECX
  1862         16  CLAS-I-RL-AH            PIC  X.                      ELCDTECX
  1863         16  CLAS-I-CALC-TYPE.                                    ELCDTECX
  1864             20  CLAS-I-BAL          PIC  X.                      ELCDTECX
  1865         16  CLAS-I-EP               PIC  X.                      ELCDTECX
  1866         16  CLAS-CO-BEN-I-G-CD      PIC  X.                      ELCDTECX
  1867         16  CLAS-CO-REM-TERM-CALC   PIC  X.                      ELCDTECX
  1868         16  CLAS-I-BEN-CATEGORY     PIC  X.
  1869         16  CLAS-I-REFUND-METHOD    PIC  X.
  1870         16  CLAS-I-MAX-BENEFITS     PIC 99.
  1871         16  FILLER                  PIC  XXX.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  39
* ECS056TT.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  1872                                                                  ELCDTECX
  1873 01  FILLER                          PIC  X(16)                   ELCDTECX
  1874                                     VALUE 'MORTALITY TABLES'.    ELCDTECX
  1875 01  CLAS-MORTALITY-CODES.                                        ELCDTECX
  1876     12  CLAS-MORT-FLD               OCCURS 99 TIMES              ELCDTECX
  1877                                     INDEXED BY CLAS-MORT-NDX.    ELCDTECX
  1878         16  CLAS-MORT-CODE          PIC  X(4).                      CL**6
  1879         16  CLAS-MORT-J-CODE        PIC  X.                         CL**5
  1880         16  CLAS-MORT-J-FACT        PIC S9V9(4).                    CL**6
  1881         16  CLAS-MORT-DESC.                                      ELCDTECX
  1882             20  CLAS-RESERVE-ADJ    PIC  999.                       CL**6
  1883             20  FILLER              PIC  XX.                        CL**5
  1884             20  CLAS-YEAR           PIC  X(4).                      CL**6
  1885             20  FILLER              PIC  X.                         CL**5
  1886             20  CLAS-TABLE-TYPE     PIC  XXX.                       CL**6
  1887             20  FILLER              PIC  X.                         CL**5
  1888             20  CLAS-AGE-METHOD     PIC  XX.                        CL**5
  1889             20  FILLER              PIC  X.                         CL**5
  1890             20  CLAS-INTEREST       PIC  99.99.                     CL**5
  1891             20  FILLER              PIC  X(5).                      CL**6
  1892                                                                  ELCDTECX
  1893 01  FILLER                          PIC  X(15)                   ELCDTECX
  1894                                     VALUE 'BUSINESS TABLES'.     ELCDTECX
  1895 01  CLAS-BUSINESS-CLASSES.                                       ELCDTECX
  1896     12  CLAS-BUSC-FLD               OCCURS 50 TIMES.             ELCDTECX
  1897         16  CLAS-BUSC-CODE          PIC  99.                     ELCDTECX
  1898         16  CLAS-BUSC-GROUP         PIC  X.                      ELCDTECX
  1899         16  CLAS-BUSC-DESC          PIC  X(19).                  ELCDTECX
  1900         16  CLAS-BUSC-EXCL          PIC  X.                         CL**5
  1901         16  FILLER                  PIC  X(4).                      CL**6
  1902                                                                  ELCDTECX
  1903 01  FILLER                          PIC  X(7)                       CL**6
  1904                                     VALUE 'INDEXES'.             ELCDTECX
  1905 01  CLAS-INDEX-TBL.                                              ELCDTECX
  1906     12  CLAX-ID                     PIC  X(4).                   ELCDTECX
  1907     12  CLAS-STARTC                 PIC S9(4) COMP.              ELCDTECX
  1908     12  CLAS-MAXC                   PIC S9(4) COMP.              ELCDTECX
  1909     12  CLAS-STARTL                 PIC S9(4) COMP.              ELCDTECX
  1910     12  CLAS-MAXL                   PIC S9(4) COMP.              ELCDTECX
  1911     12  CLAS-STARTA                 PIC S9(4) COMP.              ELCDTECX
  1912     12  CLAS-MAXA                   PIC S9(4) COMP.              ELCDTECX
  1913     12  CLAS-STARTM                 PIC S9(4) COMP.              ELCDTECX
  1914     12  CLAS-MAXM                   PIC S9(4) COMP.              ELCDTECX
  1915     12  CLAS-STARTB                 PIC S9(4) COMP.              ELCDTECX
  1916     12  CLAS-MAXB                   PIC S9(4) COMP.              ELCDTECX
  1917     12  CLAS-STARTS                 PIC S9(4) COMP.              ELCDTECX
  1918     12  CLAS-MAXS                   PIC S9(4) COMP.              ELCDTECX
  1919     12  CLAS-STARTE                 PIC S9(4) COMP.              ELCDTECX
  1920     12  CLAS-MAXE                   PIC S9(4) COMP.              ELCDTECX
  1921     12  CLAS-STARTCN                PIC S9(4) COMP.              ELCDTECX
  1922     12  CLAS-MAXCN                  PIC S9(4) COMP.              ELCDTECX
  1923                                                                  ELCDTECX
  1924 01  CLAS-TYPE-MISC.                                              ELCDTECX
  1925     12  CLAS-INDEXC                 PIC S9(4) COMP.              ELCDTECX
  1926     12  CLAS-INDEXL                 PIC S9(4) COMP.              ELCDTECX
  1927     12  CLAS-INDEXA                 PIC S9(4) COMP.              ELCDTECX
  1928     12  CLAS-INDEXM                 PIC S9(4) COMP.              ELCDTECX
  1929     12  CLAS-INDEXB                 PIC S9(4) COMP.              ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  40
* ECS056TT.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  1930     12  CLAS-INDEXS                 PIC S9(4) COMP.              ELCDTECX
  1931     12  CLAS-INDEXE                 PIC S9(4) COMP.              ELCDTECX
  1932     12  CLAS-INDEX                  PIC S9(4) COMP.              ELCDTECX
  1933     12  CLAS-INDEXEN                PIC S9(4) COMP.              ELCDTECX
  1934     12  CLAS-INDEXCN                PIC S9(4) COMP.              ELCDTECX
  1935     12  CLAS-INDEXON                PIC S9(4) COMP.              ELCDTECX
  1936                                                                  ELCDTECX
  1937 01  FILLER                          PIC  X(13)                   ELCDTECX
  1938                                     VALUE 'MISCELLANEOUS'.       ELCDTECX
  1939 01  CLAS-MISC.                                                   ELCDTECX
  1940     12  DTE-FICH                    PIC  X.                      ELCDTECX
  1941         88  FICH-NO                 VALUE SPACE.                 ELCDTECX
  1942         88  FICH-ONLY               VALUE '1'.                   ELCDTECX
  1943         88  FICH-BOTH               VALUE '2'.                   ELCDTECX
  1944     12  FICH-OPEN                   PIC  X.                      ELCDTECX
  1945     12  REPT-OPEN                   PIC  X.                      ELCDTECX
  1946     12  DTE-PGM-OPT                 PIC  9.                         CL**5
  1947     12  DTE-PRT-OPT                 PIC  X.                      ELCDTECX
  1948     12  DTE-FMT-OPT                 PIC  9.                      ELCDTECX
  1949     12  DTE-PRC-OPT                 PIC  9.                      ELCDTECX
  1950     12  DTE-TOT-OPT                 PIC  9.                      ELCDTECX
  1951     12  CLAS-LOOK                   PIC  XX.                     ELCDTECX
  1952     12  DTE-TOT-LINES               PIC S9(8)      COMP.         ELCDTECX
  1953     12  STATE-L                     PIC  XX.                     ELCDTECX
  1954     12  CLAS-CN                     PIC  99.                     ELCDTECX
  1955     12  CLAS-CO                     PIC  99.                     ELCDTECX
  1956     12  DTE-VSAM-FLAGS                              VALUE ZERO.  ELCDTECX
  1957         16  DTE-F-1                 PIC  X.                      ELCDTECX
  1958         16  DTE-F-2                 PIC  X.                      ELCDTECX
  1959     12  DTE-ABEND-WORK.                                          ELCDTECX
  1960         16  DTE-ABEND-CD-1          PIC  XX         VALUE SPACES.ELCDTECX
  1961         16  DTE-ABEND-CD-2          PIC  XX         VALUE SPACES.ELCDTECX
  1962                                                                  ELCDTECX
  1963 01  FILLER                          PIC  X(12)                   ELCDTECX
  1964                                     VALUE 'WORKING DATE'.        ELCDTECX
  1965 01  WS-DATE-AND-TIME.                                            ELCDTECX
  1966     12  WS-ACCEPT-DATE.                                          ELCDTECX
  1967         16  WS-AD-YY                PIC  99.                     ELCDTECX
  1968         16  WS-AD-MM                PIC  99.                     ELCDTECX
  1969         16  WS-AD-DD                PIC  99.                     ELCDTECX
  1970     12  WS-CURRENT-DATE.                                         ELCDTECX
  1971         16  WS-CD-MM                PIC  99.                     ELCDTECX
  1972         16  FILLER                  PIC  X          VALUE '/'.   ELCDTECX
  1973         16  WS-CD-DD                PIC  99.                     ELCDTECX
  1974         16  FILLER                  PIC  X          VALUE '/'.   ELCDTECX
  1975         16  WS-CD-YY                PIC  99.                     ELCDTECX
  1976     12  WS-TIME-OF-DAY.                                          ELCDTECX
  1977         16  WS-TIME                 PIC  9(6).                   ELCDTECX
  1978         16  WS-HUN-SEC              PIC  99.                     ELCDTECX
  1979                                                                  ELCDTECX
  1980 01  FILLER                          PIC  X(12)                   ELCDTECX
  1981                                     VALUE 'CARRIER CLMS'.        ELCDTECX
  1982 01  CARRIER-OPT-CLAIM-DATA.                                      ELCDTECX
  1983     12  CARRIER-FLDS                OCCURS 25 TIMES.             ELCDTECX
  1984         16  CARRIER-IBNR-SWITCH     PIC  X.                         CL**5
  1985         16  CARRIER-IBNR-PERCENT    PIC S9V9(4) COMP-3.             CL**6
  1986         16  CARRIER-CIDA-DISCOUNT   PIC S9V9(4) COMP-3.             CL**6
  1987                                                                  ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  41
* ECS056TT.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  1988 01  FILLER                          PIC  X(10)                   ELCDTECX
  1989                                     VALUE 'STATE TLRS'.          ELCDTECX
  1990 01  STATE-TARGET-LOSS-RATIOS.                                    ELCDTECX
  1991     12  STATE-TLR-FLD               OCCURS 75 TIMES.             ELCDTECX
  1992         16  STATE-TARGET-LOSS-RATIO PIC S9V9(4) COMP-3.             CL**6
  1993         16  STATE-CALC-INTEREST     PIC S9V9(4) COMP-3.             CL**6
  1994                                                                  ELCDTECX
  1995 01  FILLER                          PIC  X(13)                   ELCDTECX
  1996                                     VALUE 'BUSINESS TLRS'.       ELCDTECX
  1997 01  BUSINESS-TRGT-LOSS-RATIO-MODS.                               ELCDTECX
  1998     12  BUS-TLRM-FLD                OCCURS 99 TIMES.             ELCDTECX
  1999         16  BUS-TRGT-LOSS-RATIO-MOD PIC S9V9(4) COMP-3.             CL**6
  2000                                                                  ELCDTECX
  2001 01  FILLER                          PIC  X(13)                   ELCDTECX
  2002                                     VALUE 'MISC CLM DATA'.       ELCDTECX
  2003 01  MISC-OPT-CLM-RSV-DATA.                                       ELCDTECX
  2004     12  COMPANY-CALC-INTEREST       PIC S9V9(4) COMP-3.             CL**6
  2005     12  COMPANY-CIDA-DISCOUNT       PIC S9V9(4) COMP-3.             CL**6
  2006     12  COMPANY-CRDB-TABLE-SELECTION                             ELCDTECX
  2007                                     PIC  X.                         CL**5
  2008     12  COMPANY-IBNR-AH-FACTOR      PIC S9V9(4) COMP-3.             CL**6
  2009     12  COMPANY-IBNR-LAG-MONTH      PIC S999    COMP-3.             CL**6
  2010     12  COMPANY-IBNR-LIFE-FACTOR    PIC S9V9(4) COMP-3.             CL**6
  2011     12  COMPANY-OPTION-START-DATE   PIC  XX.                        CL**5
  2012     12  INDEXBS                     PIC S9(4)   COMP.               CL**6
  2013     12  INDEXCA                     PIC S9(4)   COMP.               CL**6
  2014     12  INDEXST                     PIC S9(4)   COMP.               CL**6
  2015     12  FILLER                      PIC  X(75).                  ELCDTECX
  2016******************************************************************ELCDTECX
  2017*01  MISC-CARR-PCT-DATA.                                          00001521
  2018*    12  DD-CARR1-UEP-PCT            PIC S9V9(4) COMP-3.          00001522
  2019*    12  DD-CARR1-R78-PCT            PIC S9V9(4) COMP-3.          00001522
  2020*    12  DD-CARR1-PRO-PCT            PIC S9V9(4) COMP-3.          00001522
  2021*    12  DD-CARR2-UEP-PCT            PIC S9V9(4) COMP-3.          00001522
  2022*    12  DD-CARR2-R78-PCT            PIC S9V9(4) COMP-3.          00001522
  2023*    12  DD-CARR2-PRO-PCT            PIC S9V9(4) COMP-3.          00001522
  2024******************************************************************ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  42
* ECS056TT.cbl
  2025/
* 2026                                 COPY ELCDTEVR.
  2027***************************************************************** 04/15/98
  2028*                                                                *ELCDTEVR
  2029*                                                                *ELCDTEVR
  2030*                            ELCDTEVR.                           *   LV003
  2031*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
  2032*                            VMOD=2.001                          *   CL**2
  2033*                                                                *ELCDTEVR
  2034*   WORKING STORAGE FOR DATE VARIABLES CREATED                   *ELCDTEVR
  2035*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCDTEVR
  2036*                                                                *ELCDTEVR
  2037******************************************************************ELCDTEVR
  2038 01  WS-DATE-CARD-DATE.                                           ELCDTEVR
  2039     05  WS-RUN-DATE.                                             ELCDTEVR
  2040         10  FILLER                  PIC  9(03).                  ELCDTEVR
  2041         10  RUN-CCYY                PIC  9(04).                  ELCDTEVR
  2042         10  RUN-CCYR  REDEFINES  RUN-CCYY.                       ELCDTEVR
  2043             15  RUN-CC              PIC  99.                     ELCDTEVR
  2044             15  RUN-YR              PIC  99.                     ELCDTEVR
  2045         10  RUN-MO                  PIC  99.                     ELCDTEVR
  2046         10  RUN-DA                  PIC  99.                     ELCDTEVR
  2047     05  WS-RUN-DATE-N REDEFINES                                     CL**2
  2048            WS-RUN-DATE              PIC 9(11).                      CL**2
  2049     05  WS-EP-DT.                                                ELCDTEVR
  2050         10  FILLER                  PIC  9(03).                  ELCDTEVR
  2051         10  EP-CCYY                 PIC  9(04).                  ELCDTEVR
  2052         10  EP-CCYR  REDEFINES  EP-CCYY.                         ELCDTEVR
  2053             15  EP-CC               PIC  99.                     ELCDTEVR
  2054             15  EP-YR               PIC  99.                     ELCDTEVR
  2055         10  EP-MO                   PIC  99.                     ELCDTEVR
  2056         10  EP-DA                   PIC  99.                     ELCDTEVR
  2057     05  WS-EP-DT-N REDEFINES                                        CL**2
  2058            WS-EP-DT                 PIC 9(11).                      CL**2
  2059     05  WS-DTE-CONV-DT.                                             CL**4
  2060         10  FILLER                  PIC  9(03).                     CL**4
  2061         10  DTE-CONV-CCYY           PIC  9(04).                     CL**4
  2062         10  DTE-CONV-CCYR  REDEFINES  DTE-CONV-CCYY.                CL**4
  2063             15  DTE-CONV-CC         PIC  99.                        CL**4
  2064             15  DTE-CONV-YR         PIC  99.                        CL**4
  2065         10  DTE-CONV-MO             PIC  99.                        CL**4
  2066         10  DTE-CONV-DA             PIC  99.                        CL**4
  2067     05  WS-DTE-CONV-DT-N REDEFINES                                  CL**4
  2068            WS-DTE-CONV-DT           PIC  9(11).                     CL**4
  2069 01  WS-BALANCE-FORWARD-DATE.                                     ELCDTEVR
  2070     05  WS-BF-LAST-ACTIVITY-DATE.                                ELCDTEVR
  2071         10  FILLER                            PIC 999.           ELCDTEVR
  2072         10  BF-ACT-CCYY                       PIC 9(04).         ELCDTEVR
  2073         10  BF-ACT-CCYR  REDEFINES  BF-ACT-CCYY.                 ELCDTEVR
  2074             15  BF-ACT-CC                     PIC 99.            ELCDTEVR
  2075             15  BF-ACT-YEAR                   PIC 99.            ELCDTEVR
  2076         10  BF-ACT-MONTH                      PIC 99.            ELCDTEVR
  2077         10  BF-ACT-DAY                        PIC 99.            ELCDTEVR
  2078     05  WS-BF-LAST-ACTIVITY-DATE-N REDEFINES                        CL**2
  2079            WS-BF-LAST-ACTIVITY-DATE           PIC 9(11).            CL**2
  2080     05  WS-BF-CURRENT-LAST-STMT-DT.                              ELCDTEVR
  2081         10  FILLER                            PIC 999.           ELCDTEVR
  2082         10  BF-CURRENT-LAST-STMT-CEN          PIC 99.            ELCDTEVR
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  43
* ECS056TT.cbl (/apps/prod/cid1p/copy/ELCDTEVR)
  2083         10  BF-CURRENT-LAST-STMT-YEAR         PIC 99.            ELCDTEVR
  2084         10  BF-CURRENT-LAST-STMT-MONTH        PIC 99.            ELCDTEVR
  2085         10  BF-CURRENT-LAST-STMT-DAY          PIC 99.            ELCDTEVR
  2086     05  WS-BF-CURRENT-LAST-STMT-DT-N REDEFINES                      CL**2
  2087            WS-BF-CURRENT-LAST-STMT-DT        PIC 9(11).             CL**2
  2088 01  WS-ADD-CONF-TRANSACTIONS-DTE.                                ELCDTEVR
  2089     05  WS-AC-CERT-EFF-DATE.                                     ELCDTEVR
  2090         10  FILLER                            PIC 999.           ELCDTEVR
  2091         10  AC-CERT-CCYY                      PIC 9(04).         ELCDTEVR
  2092         10  AC-CERT-CCYR  REDEFINES  AC-CERT-CCYY.               ELCDTEVR
  2093             15  AC-CERT-CC                    PIC 99.            ELCDTEVR
  2094             15  AC-CERT-YR                    PIC 99.            ELCDTEVR
  2095         10  AC-CERT-MO                        PIC 99.            ELCDTEVR
  2096         10  AC-CERT-DA                        PIC 99.            ELCDTEVR
  2097     05  WS-AC-CERT-EFF-DATE-N REDEFINES                             CL**2
  2098            WS-AC-CERT-EFF-DATE                PIC 9(11).            CL**2
  2099     05  WS-AC-LIFE-CANCEL-DATE.                                  ELCDTEVR
  2100         10  FILLER                            PIC 999.           ELCDTEVR
  2101         10  AC-LIFE-CANCEL-CCYY               PIC 9(04).         ELCDTEVR
  2102         10  AC-LIFE-CANCEL-CCYR REDEFINES AC-LIFE-CANCEL-CCYY.   ELCDTEVR
  2103             15  AC-LIFE-CANCEL-CC             PIC 99.            ELCDTEVR
  2104             15  AC-LIFE-CANCEL-YR             PIC 99.            ELCDTEVR
  2105         10  AC-LIFE-CANCEL-MO                 PIC 99.            ELCDTEVR
  2106         10  AC-LIFE-CANCEL-DA                 PIC 99.            ELCDTEVR
  2107     05  WS-AC-LIFE-CANCEL-DATE-N REDEFINES                          CL**2
  2108            WS-AC-LIFE-CANCEL-DATE             PIC 9(11).            CL**2
  2109     05  WS-AC-AH-CANCEL-DATE.                                    ELCDTEVR
  2110         10  FILLER                            PIC 999.           ELCDTEVR
  2111         10  AC-AH-CANCEL-CCYY                 PIC 9(04).         ELCDTEVR
  2112         10  AC-AH-CANCEL-CCYR  REDEFINES  AC-AH-CANCEL-CCYY.     ELCDTEVR
  2113             15  AC-AH-CANCEL-CC               PIC 99.            ELCDTEVR
  2114             15  AC-AH-CANCEL-YR               PIC 99.            ELCDTEVR
  2115         10  AC-AH-CANCEL-MO                   PIC 99.            ELCDTEVR
  2116         10  AC-AH-CANCEL-DA                   PIC 99.            ELCDTEVR
  2117     05  WS-AC-AH-CANCEL-DATE-N REDEFINES                            CL**2
  2118            WS-AC-AH-CANCEL-DATE               PIC 9(11).            CL**2
  2119 01  WS-RATE-RECORD.                                              ELCDTEVR
  2120         05  WS-RT-EXPIRY-DATE.                                   ELCDTEVR
  2121             10  FILLER                        PIC 999.           ELCDTEVR
  2122             10  RT-EXP-CCYY                   PIC 9(04).         ELCDTEVR
  2123             10  RT-EXP-CCYR  REDEFINES  RT-EXP-CCYY.             ELCDTEVR
  2124                 15  RT-EXP-CC                 PIC 99.            ELCDTEVR
  2125                 15  RT-EXP-YR                 PIC 99.            ELCDTEVR
  2126             10  RT-EXP-MO                     PIC 99.            ELCDTEVR
  2127             10  RT-EXP-DA                     PIC 99.            ELCDTEVR
  2128         05  WS-RT-EXPIRY-DATE-N REDEFINES                           CL**2
  2129                WS-RT-EXPIRY-DATE              PIC 9(11).            CL**2
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  44
* ECS056TT.cbl
  2130/
  2131 PROCEDURE DIVISION.
  2132
  2133 0001-DT-CRD-READ SECTION.
* 2134                                 COPY ELCDTERX.
  2135******************************************************************04/15/98
  2136*                                                                *ELCDTERX
  2137*                                                                *ELCDTERX
  2138*                            ELCDTERX.                           *   LV002
  2139*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  2140*                            VMOD=2.007                          *ELCDTERX
  2141*                                                                *ELCDTERX
  2142*      LOAD DATE CARD DISK FILE INTO WORKING STORAGE AREA        *ELCDTERX
  2143*      (COPY CODE FOR W/S = ELCDTECX AND COPY CODE FOR FD        *ELCDTERX
  2144*      = ELCDTEFD)                                               *ELCDTERX
  2145*                                                                *ELCDTERX
  2146******************************************************************ELCDTERX
  2147                                                                  ELCDTERX
  2148     ACCEPT WS-ACCEPT-DATE       FROM  DATE.                      ELCDTERX
  2149                                                                  ELCDTERX
  2150     MOVE WS-AD-YY               TO  WS-CD-YY.                    ELCDTERX
  2151     MOVE WS-AD-MM               TO  WS-CD-MM.                    ELCDTERX
  2152     MOVE WS-AD-DD               TO  WS-CD-DD.                    ELCDTERX
  2153                                                                  ELCDTERX
  2154     ACCEPT WS-TIME-OF-DAY       FROM  TIME.                      ELCDTERX
  2155                                                                  ELCDTERX
  2156******************************************************************ELCDTERX
  2157*    NOTE: THE FOLLOWING STATEMENT IS USED TO ELIMINATE COB II    ELCDTERX
  2158*          WARNING MESSAGES.                                      ELCDTERX
  2159******************************************************************ELCDTERX
  2160     IF WS-CD-YY = LOW-VALUES                                     ELCDTERX
  2161         COMPUTE PGM-SUB = PGM-SUB + 1.                           ELCDTERX
  2162                                                                  ELCDTERX
  2163     OPEN INPUT DISK-DATE.                                        ELCDTERX
  2164                                                                  ELCDTERX
  2165     MOVE SPACE TO DATE-CARD         CLAS-BUSINESS-CLASSES        ELCDTERX
  2166                   STATE-NAMES       CLAS-MORTALITY-CODES         ELCDTERX
  2167                   CLAS-INS-TYPES    COMPANY-NAME-TABLE           ELCDTERX
  2168                   DATE-CARD-OPTIONS DATE-CARD-FACTORS            ELCDTERX
  2169                   CLAX-ID           CLAS-MISC                    ELCDTERX
  2170                   CARRIER-NAMES     CLASIC-SYSTEM-CODES          ELCDTERX
  2171                   CARRIER-OPT-CLAIM-DATA                         ELCDTERX
  2172                   STATE-TARGET-LOSS-RATIOS                       ELCDTERX
  2173                   BUSINESS-TRGT-LOSS-RATIO-MODS                  ELCDTERX
  2174                   MISC-OPT-CLM-RSV-DATA.                         ELCDTERX
  2175                                                                  ELCDTERX
  2176     MOVE LOW-VALUES TO CLAS-INDEX-TBL CLAS-TYPE-MISC.            ELCDTERX
  2177                                                                  ELCDTERX
  2178     MOVE ZERO TO CLAS-CN DTE-TOT-LINES CLAS-CO                   ELCDTERX
  2179                  INDEXCA INDEXBS INDEXST.                        ELCDTERX
  2180                                                                  ELCDTERX
  2181     COMPUTE CLAS-CN = PGM-SUB / +50.                             ELCDTERX
  2182     COMPUTE CLAS-CO = PGM-SUB / +20.                             ELCDTERX
  2183     COMPUTE CLAS-INDEXEN = PGM-SUB - (CLAS-CN * +50).            ELCDTERX
  2184     COMPUTE CLAS-INDEXON = PGM-SUB - (CLAS-CO * +20).            ELCDTERX
  2185                                                                  ELCDTERX
  2186     IF CLAS-INDEXEN = ZERO                                       ELCDTERX
  2187         MOVE +50               TO CLAS-INDEXEN                   ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  45
* ECS056TT.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  2188     ELSE                                                         ELCDTERX
  2189         ADD +1                 TO CLAS-CN.                       ELCDTERX
  2190                                                                  ELCDTERX
  2191     IF CLAS-INDEXON = ZERO                                       ELCDTERX
  2192         MOVE +20               TO CLAS-INDEXON                   ELCDTERX
  2193     ELSE                                                         ELCDTERX
  2194         ADD +1                 TO CLAS-CO.                       ELCDTERX
  2195                                                                  ELCDTERX
  2196 0005-READ--CARD.                                                 ELCDTERX
  2197     READ DISK-DATE                                               ELCDTERX
  2198         AT END CLOSE DISK-DATE                                   ELCDTERX
  2199             GO TO 0060-READ--TEST.                               ELCDTERX
  2200                                                                  ELCDTERX
  2201     MOVE ZERO                   TO CLAS-INDEX.                   ELCDTERX
  2202                                                                  ELCDTERX
  2203     IF DD-ID = 'CLAS' OR 'LIFE' OR 'GLED'                        ELCDTERX
  2204         MOVE DATE-DISK          TO DATE-CARD                     ELCDTERX
  2205         MOVE RUN-DATE           TO WS-RUN-DATE-N                    CL**2
  2206         MOVE EP-DT              TO WS-EP-DT-N                       CL**2
  2207         GO TO 0005-READ--CARD.                                   ELCDTERX
  2208                                                                  ELCDTERX
  2209     IF DD-ID = 'CLAD'                                            ELCDTERX
  2210         MOVE DATE-DISK          TO DATE-CARD-OPTIONS             ELCDTERX
  2211         GO TO 0005-READ--CARD.                                   ELCDTERX
  2212                                                                  ELCDTERX
  2213     IF DD-ID = 'CLAX'                                            ELCDTERX
  2214         MOVE DATE-DISK          TO CLAS-INDEX-TBL                ELCDTERX
  2215         GO TO 0005-READ--CARD.                                   ELCDTERX
  2216                                                                  ELCDTERX
  2217     IF DD-ID = 'CLAF'                                            ELCDTERX
  2218         MOVE DATE-DISK          TO DATE-CARD-FACTORS             ELCDTERX
  2219         GO TO 0005-READ--CARD.                                   ELCDTERX
  2220                                                                  ELCDTERX
  2221     IF DD-ID = 'CLAC'                                            ELCDTERX
  2222         GO TO 0010-READ--CLAC.                                   ELCDTERX
  2223                                                                  ELCDTERX
  2224     IF DD-ID = 'CARR'                                            ELCDTERX
  2225         GO TO 0015-READ--CARR.                                   ELCDTERX
  2226                                                                  ELCDTERX
  2227     IF DD-ID = 'STAT'                                            ELCDTERX
  2228         GO TO 0020-READ--STAT.                                   ELCDTERX
  2229                                                                  ELCDTERX
  2230     IF DD-ID = 'BUSC'                                            ELCDTERX
  2231         GO TO 0025-READ--BUSC.                                   ELCDTERX
  2232                                                                  ELCDTERX
  2233     IF DD-ID = 'MORT'                                            ELCDTERX
  2234         GO TO 0030-READ--MORT.                                   ELCDTERX
  2235                                                                  ELCDTERX
  2236     IF DD-ID = 'CLAI'                                            ELCDTERX
  2237         GO TO 0040-READ--CLAI.                                   ELCDTERX
  2238                                                                  ELCDTERX
  2239     IF DD-ID = 'COLC'                                            ELCDTERX
  2240         GO TO 0065-READ--COLC.                                   ELCDTERX
  2241                                                                  ELCDTERX
  2242     IF DD-IDX NUMERIC AND                                        ELCDTERX
  2243        DD-IDA = 'CL'                                             ELCDTERX
  2244         GO TO 0035-READ--CLXX.                                   ELCDTERX
  2245                                                                  ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  46
* ECS056TT.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  2246     IF DD-IDX NUMERIC AND                                        ELCDTERX
  2247        DD-IDA = 'PO'                                             ELCDTERX
  2248         GO TO 0050-READ--POXX.                                   ELCDTERX
  2249                                                                  ELCDTERX
  2250     IF DD-ID = 'OPCA'                                            ELCDTERX
  2251         GO TO 0070-READ--OPCA.                                   ELCDTERX
  2252                                                                  ELCDTERX
  2253     IF DD-ID = 'OPST'                                            ELCDTERX
  2254         GO TO 0072-READ--OPST.                                   ELCDTERX
  2255                                                                  ELCDTERX
  2256     IF DD-ID = 'OPBS'                                            ELCDTERX
  2257         GO TO 0074-READ--OPBS.                                   ELCDTERX
  2258                                                                  ELCDTERX
  2259     IF DD-ID = 'OPMS'                                            ELCDTERX
  2260         MOVE DD-MISC-DATA       TO MISC-OPT-CLM-RSV-DATA.        ELCDTERX
  2261                                                                  ELCDTERX
  2262     GO TO 0005-READ--CARD.                                       ELCDTERX
  2263                                                                  ELCDTERX
  2264 0010-READ--CLAC.                                                 ELCDTERX
  2265     ADD 1                       TO CLAS-INDEXC.                  ELCDTERX
  2266     MOVE DD-CR1                 TO CNT-ID (CLAS-INDEXC).         ELCDTERX
  2267     MOVE DD-CR1N                TO CNT-NAME (CLAS-INDEXC).       ELCDTERX
  2268     ADD 1                       TO CLAS-INDEXC.                  ELCDTERX
  2269     MOVE DD-CR2                 TO CNT-ID (CLAS-INDEXC).         ELCDTERX
  2270     MOVE DD-CR2N                TO CNT-NAME (CLAS-INDEXC).       ELCDTERX
  2271     GO TO 0005-READ--CARD.                                       ELCDTERX
  2272                                                                  ELCDTERX
  2273 0015-READ--CARR.                                                 ELCDTERX
  2274     ADD 1  TO  CLAS-INDEXCN.                                     ELCDTERX
  2275     IF CLAS-INDEXCN LESS THAN +26                                ELCDTERX
  2276        MOVE DD-CARR1         TO CARRIER-SUB (CLAS-INDEXCN)
  2277        MOVE DD-CARR1S        TO CARRIER-DOM-ST (CLAS-INDEXCN)
  2278        MOVE DD-CARR1N        TO CARRIER-PIC (CLAS-INDEXCN)
  2279        MOVE DD-CARR1-UEP-PCT TO CARRIER-UEP-PCT (CLAS-INDEXCN)
  2280        MOVE DD-CARR1-R78-PCT TO CARRIER-R78-PCT (CLAS-INDEXCN)
  2281        MOVE DD-CARR1-PRO-PCT TO CARRIER-PRO-PCT (CLAS-INDEXCN)
  2282        MOVE DD-CARR1-SECPAY-SW
  2283                               TO CARRIER-SEC-PAY (CLAS-INDEXCN)
  2284     END-IF
  2285                                                                  ELCDTERX
  2286     ADD 1  TO  CLAS-INDEXCN.                                     ELCDTERX
  2287     IF CLAS-INDEXCN LESS THAN +26                                ELCDTERX
  2288        MOVE DD-CARR2         TO CARRIER-SUB (CLAS-INDEXCN)
  2289        MOVE DD-CARR2S        TO CARRIER-DOM-ST (CLAS-INDEXCN)
  2290        MOVE DD-CARR2N        TO CARRIER-PIC (CLAS-INDEXCN)
  2291        MOVE DD-CARR2-UEP-PCT TO CARRIER-UEP-PCT (CLAS-INDEXCN)
  2292        MOVE DD-CARR2-R78-PCT TO CARRIER-R78-PCT (CLAS-INDEXCN)
  2293        MOVE DD-CARR2-PRO-PCT TO CARRIER-PRO-PCT (CLAS-INDEXCN)
  2294        MOVE DD-CARR2-SECPAY-SW
  2295                              TO CARRIER-SEC-PAY (CLAS-INDEXCN)
  2296     END-IF
  2297                                                                  ELCDTERX
  2298                                                                  ELCDTERX
  2299     GO TO 0005-READ--CARD.                                       ELCDTERX
  2300                                                                  ELCDTERX
  2301 0020-READ--STAT.                                                 ELCDTERX
  2302     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  2303     IF CLAS-INDEX GREATER 3  OR                                  ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  47
* ECS056TT.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  2304        DD-ST (CLAS-INDEX) = SPACE                                ELCDTERX
  2305         GO TO 0005-READ--CARD.                                   ELCDTERX
  2306                                                                  ELCDTERX
  2307     ADD 1                       TO CLAS-INDEXS.                  ELCDTERX
  2308     MOVE DD-ST (CLAS-INDEX)     TO STATE-NAME-FLD (CLAS-INDEXS). ELCDTERX
  2309     GO TO 0020-READ--STAT.                                       ELCDTERX
  2310                                                                  ELCDTERX
  2311 0025-READ--BUSC.                                                 ELCDTERX
  2312     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  2313     IF CLAS-INDEX GREATER 3  OR                                  ELCDTERX
  2314        DD-ST (CLAS-INDEX) = SPACE                                ELCDTERX
  2315         GO TO 0005-READ--CARD.                                   ELCDTERX
  2316                                                                  ELCDTERX
  2317     ADD 1                       TO CLAS-INDEXB.                  ELCDTERX
  2318     MOVE DD-ST (CLAS-INDEX)     TO CLAS-BUSC-FLD (CLAS-INDEXB).  ELCDTERX
  2319     GO TO 0025-READ--BUSC.                                       ELCDTERX
  2320                                                                  ELCDTERX
  2321 0030-READ--MORT.                                                 ELCDTERX
  2322     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  2323     IF CLAS-INDEX GREATER 2  OR                                  ELCDTERX
  2324        DD-MORT (CLAS-INDEX) = SPACE                              ELCDTERX
  2325         GO TO 0005-READ--CARD.                                   ELCDTERX
  2326                                                                  ELCDTERX
  2327     ADD 1                       TO CLAS-INDEXM.                  ELCDTERX
  2328     MOVE DD-MORT (CLAS-INDEX)   TO CLAS-MORT-FLD (CLAS-INDEXM).  ELCDTERX
  2329     GO TO 0030-READ--MORT.                                       ELCDTERX
  2330                                                                  ELCDTERX
  2331 0035-READ--CLXX.                                                 ELCDTERX
  2332     IF DD-IDX NOT = CLAS-CN                                      ELCDTERX
  2333          GO TO 0005-READ--CARD.                                  ELCDTERX
  2334                                                                  ELCDTERX
  2335     IF DD-PS-PIC (CLAS-INDEXEN) = 'X'                            ELCDTERX
  2336         DISPLAY '***********************************************'ELCDTERX
  2337         DISPLAY 'PROGRAM ECS-', PGM-SUB, ' NOT SCHEDULED TO RUN' ELCDTERX
  2338         DISPLAY '***********************************************'ELCDTERX
  2339         GO TO 0055-READ--STOP.                                   ELCDTERX
  2340                                                                  ELCDTERX
  2341     IF DD-PS-PIC (CLAS-INDEXEN) NOT LESS 'A'  AND                ELCDTERX
  2342        DD-PS-PIC (CLAS-INDEXEN) NOT GREATER 'I'                  ELCDTERX
  2343         MOVE '1'                TO DTE-FICH.                     ELCDTERX
  2344                                                                  ELCDTERX
  2345     IF DD-PS-PIC (CLAS-INDEXEN) NOT LESS 'J'  AND                ELCDTERX
  2346        DD-PS-PIC (CLAS-INDEXEN) NOT GREATER 'R'                  ELCDTERX
  2347         MOVE '2'                TO DTE-FICH.                     ELCDTERX
  2348                                                                  ELCDTERX
  2349*    MOVE DD-PS-PIC (CLAS-INDEXEN) TO DTE-PGM-OPT.                ELCDTERX
  2350     GO TO 0005-READ--CARD.                                       ELCDTERX
  2351                                                                  ELCDTERX
  2352 0040-READ--CLAI.                                                 ELCDTERX
  2353     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  2354     IF CLAS-INDEX GREATER 2  OR                                  ELCDTERX
  2355        DD-TYPE (CLAS-INDEX) = SPACE                              ELCDTERX
  2356         GO TO 0005-READ--CARD.                                   ELCDTERX
  2357                                                                  ELCDTERX
  2358     ADD 1                       TO CLAS-INDEXA.                  ELCDTERX
  2359     MOVE DD-TYPE (CLAS-INDEX) TO CLAS-ALL-TYPES (CLAS-INDEXA).   ELCDTERX
  2360     GO TO 0040-READ--CLAI.                                       ELCDTERX
  2361                                                                  ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  48
* ECS056TT.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  2362 0045-READ--DUMP.                                                 ELCDTERX
  2363     MOVE +999 TO WS-RETURN-CODE                                  ELCDTERX
  2364     MOVE 'MISSING AND/OR INVALID CLAS DATE CARD'                 ELCDTERX
  2365                                 TO  WS-ABEND-MESSAGE             ELCDTERX
  2366     PERFORM ABEND-PGM.                                           ELCDTERX
  2367                                                                  ELCDTERX
  2368 0050-READ--POXX.                                                 ELCDTERX
  2369     IF DD-IDX NOT = CLAS-CO                                      ELCDTERX
  2370         GO TO 0005-READ--CARD.                                   ELCDTERX
  2371                                                                  ELCDTERX
  2372     IF DD-PS-PRC (CLAS-INDEXON) = 'X'                            ELCDTERX
  2373         DISPLAY '***********************************************'ELCDTERX
  2374         DISPLAY 'ECS - ', PGM-SUB, ' IS NOT SCHEDULED TO RUN'    ELCDTERX
  2375         DISPLAY '***********************************************'ELCDTERX
  2376         GO TO 0055-READ--STOP.                                   ELCDTERX
  2377                                                                  ELCDTERX
  2378     MOVE DD-PS-PRT (CLAS-INDEXON) TO DTE-PRT-OPT.                ELCDTERX
  2379     MOVE DD-PS-FMT (CLAS-INDEXON) TO DTE-FMT-OPT.                ELCDTERX
  2380     MOVE DD-PS-PRC (CLAS-INDEXON) TO DTE-PRC-OPT DTE-PGM-OPT.    ELCDTERX
  2381     MOVE DD-PS-TOT (CLAS-INDEXON) TO DTE-TOT-OPT.                ELCDTERX
  2382                                                                  ELCDTERX
  2383     IF DTE-PRT-OPT = 'B'                                         ELCDTERX
  2384         MOVE '2'                  TO DTE-FICH.                   ELCDTERX
  2385     IF DTE-PRT-OPT = 'F'                                         ELCDTERX
  2386         MOVE '1'                  TO DTE-FICH.                   ELCDTERX
  2387                                                                  ELCDTERX
  2388     GO TO 0005-READ--CARD.                                       ELCDTERX
  2389                                                                  ELCDTERX
  2390 0055-READ--STOP.                                                 ELCDTERX
  2391     GOBACK.                                                      ELCDTERX
  2392                                                                  ELCDTERX
  2393 0060-READ--TEST.                                                 ELCDTERX
  2394     IF DATX-COD        = SPACE  OR                               ELCDTERX
  2395        CLAX-ID         = SPACE  OR                               ELCDTERX
  2396        DATE-OPTIONS-ID = SPACE                                   ELCDTERX
  2397         GO TO 0045-READ--DUMP.                                   ELCDTERX
  2398                                                                  ELCDTERX
  2399     MOVE LOW-VALUE TO CLAS-TYPE-MISC.                            ELCDTERX
  2400     GO TO 0079-READ--EXIT.                                       ELCDTERX
  2401                                                                  ELCDTERX
  2402 0065-READ--COLC.                                                 ELCDTERX
  2403     MOVE DATE-DISK              TO CLASIC-SYSTEM-CODES.          ELCDTERX
  2404     GO TO 0005-READ--CARD.                                       ELCDTERX
  2405                                                                  ELCDTERX
  2406 0070-READ--OPCA.                                                 ELCDTERX
  2407                                                                  ELCDTERX
  2408     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  2409                                                                  ELCDTERX
  2410     IF  CLAS-INDEX GREATER 13                                    ELCDTERX
  2411             OR                                                   ELCDTERX
  2412         DD-CARR-FLDS (CLAS-INDEX) = SPACE                        ELCDTERX
  2413         GO TO 0005-READ--CARD.                                   ELCDTERX
  2414                                                                  ELCDTERX
  2415     ADD 1                       TO INDEXCA.                      ELCDTERX
  2416     MOVE DD-CARR-FLDS (CLAS-INDEX)                               ELCDTERX
  2417                                 TO CARRIER-FLDS (INDEXCA).       ELCDTERX
  2418     GO TO 0070-READ--OPCA.                                       ELCDTERX
  2419                                                                  ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  49
* ECS056TT.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  2420 0072-READ--OPST.                                                 ELCDTERX
  2421                                                                  ELCDTERX
  2422     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  2423                                                                  ELCDTERX
  2424     IF  CLAS-INDEX GREATER 16                                    ELCDTERX
  2425             OR                                                   ELCDTERX
  2426         DD-TLR (CLAS-INDEX) = SPACE                              ELCDTERX
  2427         GO TO 0005-READ--CARD.                                   ELCDTERX
  2428                                                                  ELCDTERX
  2429     ADD 1                       TO INDEXST.                      ELCDTERX
  2430     MOVE DD-STATE-FLDS (CLAS-INDEX)                              ELCDTERX
  2431                                 TO STATE-TLR-FLD (INDEXST).      ELCDTERX
  2432     GO TO 0072-READ--OPST.                                       ELCDTERX
  2433                                                                  ELCDTERX
  2434 0074-READ--OPBS.                                                 ELCDTERX
  2435                                                                  ELCDTERX
  2436     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  2437                                                                  ELCDTERX
  2438     IF  CLAS-INDEX GREATER 32                                    ELCDTERX
  2439             OR                                                   ELCDTERX
  2440         DD-TLR (CLAS-INDEX) = SPACE                              ELCDTERX
  2441         GO TO 0005-READ--CARD.                                   ELCDTERX
  2442                                                                  ELCDTERX
  2443     ADD 1                       TO INDEXBS.                      ELCDTERX
  2444     MOVE DD-TLR (CLAS-INDEX)    TO BUS-TLRM-FLD (INDEXBS).       ELCDTERX
  2445     GO TO 0074-READ--OPBS.                                       ELCDTERX
  2446                                                                  ELCDTERX
  2447 0079-READ--EXIT.                                                 ELCDTERX
  2448*    EXIT.                                                        ELCDTERX
  2449******************************************************************ELCDTERX
  2450
  2451     MOVE COMPANY-NAME           TO  HD-CO
  2452     MOVE SPACES                 TO  SAVE-COMPANY-NAME
*  12-S*****************************************************           (   0)**
**    Operand SAVE-COMPANY-NAME is not declared
  2453     MOVE ALPH-DATE              TO  HD-DT
  2454     MOVE WS-CURRENT-DATE        TO  HD-RUN-DT
  2455     MOVE SPACE-NP               TO  P-REC
*  12-S*****************************************                       (  49)**
**    Operand P-REC is not declared
  2456
  2457     MOVE RUN-DATE               TO WS-TEST-RUN-DATE
  2458
  2459     PERFORM 0010-INITIALIZE     THRU 0010-EXIT
  2460
  2461     PERFORM 0020-OPEN-FILES     THRU 0020-EXIT
  2462
  2463     PERFORM 0050-PROCESS-FILE   THRU 0050-EXIT
  2464
  2465     PERFORM 0030-CLOSE-FILES    THRU 0030-EXIT
  2466
  2467
  2468     GOBACK
  2469     .
  2470
  2471 0010-INITIALIZE.
  2472
  2473
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  50
* ECS056TT.cbl
  2474     MOVE +0                     TO WS-EXP-PREM
  2475                                    WS-REC-PREM
  2476                                    WS-GA-COMM
  2477
  2478     PERFORM VARYING WS-A FROM +1 BY +1 UNTIL
  2479        (WS-A > +5)
  2480        MOVE +0                  TO WS-TOT-EXP-PREM (WS-A)
  2481                                    WS-TOT-REC-PREM (WS-A)
  2482                                    WS-TOT-GA-COMM (WS-A)
  2483     END-PERFORM
  2484
  2485     .
  2486
  2487 0010-EXIT.
  2488     EXIT.
  2489
  2490 0020-OPEN-FILES.
  2491
  2492     OPEN INPUT CERTS
  2493         OUTPUT EXTRACT
  2494
  2495     .
  2496
  2497 0020-EXIT.
  2498     EXIT.
  2499
  2500 0030-CLOSE-FILES.
  2501
  2502     CLOSE CERTS
  2503         EXTRACT
  2504
  2505     .
  2506
  2507 0030-EXIT.
  2508     EXIT.
  2509
  2510 0050-PROCESS-FILE.
  2511
  2512     PERFORM 0060-READ-CERT      THRU 0060-EXIT
  2513     MOVE CR-ACCT-CONTROL        TO WS-HOLD-CONTROL
  2514     PERFORM 0080-PROCESS-CERT   THRU 0080-EXIT UNTIL
  2515           END-OF-CERT
  2516
  2517     .
  2518
  2519 0050-EXIT.
  2520     EXIT.
  2521
  2522 0060-READ-CERT.
  2523
  2524     READ CERTS AT END
  2525         SET END-OF-CERT         TO TRUE
  2526     END-READ
  2527
  2528     IF NOT END-OF-CERT
  2529        ADD +1                   TO CERT-IN-CNT
  2530     END-IF
  2531     .
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  51
* ECS056TT.cbl
  2532
  2533 0060-EXIT.
  2534     EXIT.
  2535
  2536 0080-PROCESS-CERT.
  2537
  2538     IF CR-ACCT-CONTROL NOT = WS-HOLD-CONTROL
  2539        PERFORM 0250-BREAK-RTN   THRU 0250-EXIT
  2540     END-IF
  2541
  2542     MOVE CR-ACCT-CONTROL        TO WS-HOLD-CONTROL
  2543     MOVE CR-DT                  TO WS-ISSUE-DATE
  2544
  2545     IF (CR-ENTRY-STATUS = '9' OR 'D' OR 'V')
  2546                 OR
  2547        ((CR-LFTYP (1:1) NOT = 'M' AND 'N')
  2548        AND (CR-AHTYP (1:1) NOT = 'M' AND 'N'))
  2549        CONTINUE
  2550     ELSE
  2551        IF CR-ENTRY-STATUS NOT = '5'
  2552           PERFORM 0200-CALC-UEP THRU 0200-EXIT
  2553        END-IF
  2554     END-IF
  2555
  2556     IF (WS-EXP-PREM > +0)
  2557        OR (WS-REC-PREM > +0)
  2558        OR (WS-GA-COMM > +0)
  2559        PERFORM 0100-WRITE-EXTRACT
  2560                                 THRU 0100-EXIT
  2561     END-IF
  2562
  2563     MOVE +0                     TO WS-EXP-PREM
  2564                                    WS-REC-PREM
  2565                                    WS-GA-COMM
  2566
  2567     PERFORM 0060-READ-CERT      THRU 0060-EXIT
  2568
  2569     .
  2570
  2571 0080-EXIT.
  2572     EXIT.
  2573
  2574 0100-WRITE-EXTRACT.
  2575
  2576     COMPUTE WS-TOT-EXP-PREM (1) = WS-TOT-EXP-PREM (1)
  2577        + WS-EXP-PREM
  2578
  2579     COMPUTE WS-TOT-REC-PREM (1) = WS-TOT-REC-PREM (1)
  2580        + WS-REC-PREM
  2581
  2582     COMPUTE WS-TOT-GA-COMM (1) = WS-TOT-GA-COMM (1)
  2583        + WS-GA-COMM
  2584
  2585     MOVE CR-CARRIER             TO EXT-CAR
  2586     MOVE CR-GROUPING            TO EXT-GROUP
  2587     MOVE CR-STATE               TO EXT-STATE
  2588     MOVE CR-ACCOUNT             TO EXT-ACCOUNT
  2589     MOVE CR-DT                  TO WS-ISSUE-DATE
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  52
* ECS056TT.cbl
  2590     MOVE WS-ISSUE-MMDD (1:2)    TO EXT-EFF-DATE (1:2)
  2591     MOVE '-'                    TO EXT-EFF-DATE (3:1)
  2592                                    EXT-EFF-DATE (6:1)
  2593     MOVE WS-ISSUE-MMDD (3:2)    TO EXT-EFF-DATE (4:2)
  2594     MOVE WS-ISSUE-CCYY          TO EXT-EFF-DATE (7:4)
  2595     MOVE CR-CERT-NO             TO EXT-CERT-NO
  2596     MOVE CR-LFTYP               TO EXT-LF-BEN-CODE
  2597     MOVE CR-AHTYP               TO EXT-AH-BEN-CODE
  2598     MOVE CR-LF-TERM             TO EXT-LF-TERM
  2599     MOVE CR-AH-TERM             TO EXT-AH-TERM
  2600     MOVE CR-LF-EXPIRE-DATE      TO WS-EXPIRE-DATE
  2601     MOVE WS-EXPIRE-MMDD (1:2)   TO EXT-LF-EXP-DATE (1:2)
  2602     MOVE '-'                    TO EXT-LF-EXP-DATE (3:1)
  2603                                    EXT-LF-EXP-DATE (6:1)
  2604     MOVE WS-EXPIRE-MMDD (3:2)   TO EXT-LF-EXP-DATE (4:2)
  2605     MOVE WS-EXPIRE-CCYY         TO EXT-LF-EXP-DATE (7:4)
  2606
  2607     MOVE CR-AH-EXPIRE-DATE      TO WS-EXPIRE-DATE
  2608     MOVE WS-EXPIRE-MMDD (1:2)   TO EXT-AH-EXP-DATE (1:2)
  2609     MOVE '-'                    TO EXT-AH-EXP-DATE (3:1)
  2610                                    EXT-AH-EXP-DATE (6:1)
  2611     MOVE WS-EXPIRE-MMDD (3:2)   TO EXT-AH-EXP-DATE (4:2)
  2612     MOVE WS-EXPIRE-CCYY         TO EXT-AH-EXP-DATE (7:4)
  2613     MOVE WS-EXP-PREM            TO EXT-EXP-PREM
  2614     MOVE WS-REC-PREM            TO EXT-REC-PREM
  2615     MOVE WS-GA-COMM             TO EXT-GA-COMM
  2616     MOVE ZEROS                  TO EXT-MISC1
  2617                                    EXT-MISC2
  2618                                    EXT-MISC3
  2619                                    EXT-MISC4
  2620                                    EXT-MISC5
  2621
  2622     WRITE EXTRACT-RECORD
  2623
  2624     .
  2625
  2626 0100-EXIT.
  2627     EXIT.
  2628
  2629 0200-CALC-UEP.
  2630
  2631     IF CR-STATE = STATE-SUB (CLAS-INDEXS)
  2632        CONTINUE
  2633     ELSE
  2634        PERFORM VARYING CLAS-INDEXS FROM +1 BY +1 UNTIL
  2635            (CLAS-INDEXS = CLAS-MAXS) OR
  2636            CR-STATE = STATE-SUB (CLAS-INDEXS)
  2637        END-PERFORM
  2638        IF CR-STATE = STATE-SUB (CLAS-INDEXS)
  2639           CONTINUE
  2640        ELSE
  2641           DISPLAY 'STATE ' CR-STATE ' NOT IN TABLE'
  2642           MOVE 0302 TO WS-RETURN-CODE
  2643           PERFORM ABEND-PGM
  2644        END-IF
  2645     END-IF
  2646
  2647     MOVE CR-DT                  TO DC-GREG-DATE-CYMD
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  53
* ECS056TT.cbl
  2648     MOVE 'L'                    TO DC-OPTION-CODE
  2649     PERFORM 8510-DATE-CONVERSION
  2650                                 THRU 8590-EXIT
  2651     MOVE DC-BIN-DATE-1          TO CP-CERT-EFF-DT
  2652                                    WS-BIN-CR-DT
  2653
  2654     IF CR-LOAN-1ST-PMT-DT NOT NUMERIC
  2655        MOVE ZEROS               TO CR-LOAN-1ST-PMT-DT
  2656     END-IF
  2657
  2658     MOVE LOW-VALUES             TO CP-FIRST-PAY-DATE
  2659
  2660     IF CR-LOAN-1ST-PMT-DT NOT = ZEROS
  2661        MOVE CR-LOAN-1ST-PMT-DT  TO DC-GREG-DATE-1-YMD
  2662        MOVE ZEROS               TO DC-ELAPSED-MONTHS
  2663                                    DC-ELAPSED-DAYS
  2664        MOVE '3'                 TO DC-OPTION-CODE
  2665        PERFORM 8510-DATE-CONVERSION
  2666                                 THRU 8590-EXIT
  2667        IF NO-CONVERSION-ERROR
  2668           MOVE DC-BIN-DATE-1   TO CP-FIRST-PAY-DATE
  2669        ELSE
  2670           MOVE ZEROS           TO CR-LOAN-1ST-PMT-DT
  2671        END-IF
  2672      END-IF
  2673
  2674     IF CP-FIRST-PAY-DATE  LESS THAN  CP-CERT-EFF-DT
  2675        MOVE ZEROS  TO  CR-LOAN-1ST-PMT-DT
  2676     END-IF
  2677
  2678     IF CR-LOAN-1ST-PMT-DT = ZEROS
  2679        MOVE CP-CERT-EFF-DT      TO DC-BIN-DATE-1
  2680        MOVE +1                  TO DC-ELAPSED-MONTHS
  2681        MOVE ZEROS               TO DC-ELAPSED-DAYS
  2682        MOVE '6'                 TO DC-OPTION-CODE
  2683        PERFORM 8510-DATE-CONVERSION
  2684                                 THRU 8590-EXIT
  2685        MOVE DC-BIN-DATE-2       TO CP-FIRST-PAY-DATE
  2686        MOVE DC-GREG-DATE-1-YMD  TO CR-LOAN-1ST-PMT-DT
  2687     END-IF
  2688
  2689     MOVE CR-LF-EXPIRE-DATE          TO WS-WORK-DATE
  2690
  2691     IF (CR-LF-CANC-DT NOT = ZEROS) AND
  2692        (CR-LF-CANC-DT < WS-WORK-DATE)
  2693        MOVE CR-LF-CANC-DT           TO WS-WORK-DATE
  2694     END-IF
  2695
  2696     IF (CR-LF-CLAIM-EXIT-DATE NOT = ZEROS) AND
  2697        (CR-LF-CLAIM-EXIT-DATE < WS-WORK-DATE)
  2698        MOVE CR-LF-CLAIM-EXIT-DATE   TO WS-WORK-DATE
  2699     END-IF
  2700
  2701     MOVE WS-WORK-DATE           TO DC-GREG-DATE-CYMD
  2702     MOVE 'L'                    TO DC-OPTION-CODE
  2703     PERFORM 8510-DATE-CONVERSION
  2704                                 THRU 8590-EXIT
  2705     MOVE DC-BIN-DATE-1          TO WS-BIN-LF-END-DATE
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  54
* ECS056TT.cbl
  2706
  2707     MOVE CR-AH-EXPIRE-DATE          TO WS-WORK-DATE
  2708
  2709     IF (CR-AH-CANC-DT NOT = ZEROS) AND
  2710        (CR-AH-CANC-DT < WS-WORK-DATE)
  2711        MOVE CR-AH-CANC-DT           TO WS-WORK-DATE
  2712     END-IF
  2713
  2714     IF (CR-AH-SETTLEMENT-EXIT-DATE NOT = ZEROS) AND
  2715        (CR-AH-SETTLEMENT-EXIT-DATE < WS-WORK-DATE)
  2716        MOVE CR-AH-SETTLEMENT-EXIT-DATE
  2717                                     TO WS-WORK-DATE
  2718     END-IF
  2719
  2720     MOVE WS-WORK-DATE           TO DC-GREG-DATE-CYMD
  2721     MOVE 'L'                    TO DC-OPTION-CODE
  2722     PERFORM 8510-DATE-CONVERSION
  2723                                 THRU 8590-EXIT
  2724     MOVE DC-BIN-DATE-1          TO WS-BIN-AH-END-DATE
  2725
  2726
  2727     MOVE STATE-SUB (CLAS-INDEXS)    TO CP-STATE
  2728     MOVE STATE-ABBR (CLAS-INDEXS)   TO CP-STATE-STD-ABBRV
  2729     MOVE '3'                        TO CP-PROCESS-TYPE
  2730     MOVE DTE-CLASIC-COMPANY-CD      TO CP-COMPANY-CD
  2731     MOVE DTE-CLIENT                 TO CP-COMPANY-ID
  2732     MOVE SPACES                     TO CP-ACCT-FLD-5
  2733     MOVE DTE-REM-TRM                TO CP-REM-TERM-METHOD
  2734
  2735     IF CR-LFTYP = '00' OR '  '
  2736        CONTINUE
  2737     ELSE
  2738        PERFORM 0210-CALC-LIFE-UEP   THRU 0210-EXIT
  2739     END-IF
  2740
  2741     .
  2742
  2743 0200-EXIT.
  2744     EXIT.
  2745
  2746 0210-CALC-LIFE-UEP.
  2747
  2748     IF CR-LFTYP = CLAS-I-BEN (CLAS-INDEXL)
  2749        CONTINUE
  2750     ELSE
  2751        PERFORM VARYING CLAS-INDEXL FROM +1 BY +1 UNTIL
  2752            (CLAS-INDEXL = CLAS-MAXL) OR
  2753            (CR-LFTYP = CLAS-I-BEN (CLAS-INDEXL))
  2754        END-PERFORM
  2755        IF CR-LFTYP = CLAS-I-BEN (CLAS-INDEXL)
  2756           CONTINUE
  2757        ELSE
  2758           DISPLAY 'LIFE BENEFIT ' CR-LFTYP ' NOT IN TABLE'
  2759           DISPLAY 'RETURN CODE - 0401'
  2760           MOVE 0401 TO WS-RETURN-CODE
  2761           PERFORM ABEND-PGM
  2762        END-IF
  2763     END-IF
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  55
* ECS056TT.cbl
  2764
  2765     IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'B'
  2766        CONTINUE
  2767     ELSE
  2768        PERFORM 0220-CALC-LF-REM-TERM
  2769                                 THRU 0220-EXIT
  2770        MOVE ZEROS               TO WS-REM-AMT
  2771*       IF LF-REM-TRM2 > ZERO
  2772*          PERFORM 2000-CALC-REM-AMT
  2773*                                THRU 2999-CALC-REM-AMT-X
  2774*       END-IF
  2775*       COMPUTE WS-LF-INFORCE = WS-LF-INFORCE + WS-REM-AMT
  2776        IF CR-LFTYP = ('MG' OR 'MJ' OR 'NJ' OR 'NL')
  2777           IF CR-ENTRY-DATE = WS-TEST-RUN-DATE
  2778              PERFORM 0215-CALC-RECEIVE
  2779                                 THRU 0215-EXIT
  2780           END-IF
  2781        ELSE
  2782           IF CR-LFTYP (1:1) = 'M'
  2783              COMPUTE WS-EXP-PREM = CR-LFPRM + CR-AHPRM
  2784           ELSE
  2785              PERFORM 0230-CALC-LF-UEP
  2786                                 THRU 0230-EXIT
  2787           END-IF
  2788        END-IF
  2789     END-IF
  2790
  2791     .
  2792
  2793 0210-EXIT.
  2794     EXIT.
  2795
  2796 0215-CALC-RECEIVE.
  2797
  2798     MOVE +0                     TO WS-GA-COMM
  2799
  2800     PERFORM VARYING X1 FROM +1 BY +1 UNTIL
  2801        (X1 > +10)
  2802        IF CR-AGT-TYPE (X1) = 'C' OR 'D'
  2803           COMPUTE WS-GA-COMM = WS-GA-COMM +
  2804              (CR-LFPRM * CR-LCOM-L (X1)) +
  2805              (CR-LFPRM-ALT * CR-LCOM-L (X1)) +
  2806              (CR-AHPRM * CR-LCOM-AH (X1))
  2807        END-IF
  2808     END-PERFORM
  2809
  2810     COMPUTE WS-REC-PREM = (CR-LFPRM + CR-LFPRM-ALT + CR-AHPRM)
  2811        - WS-GA-COMM
  2812
  2813     .
  2814
  2815 0215-EXIT.
  2816     EXIT.
  2817
  2818 0220-CALC-LF-REM-TERM.
  2819
  2820     MOVE BIN-RUN-DATE           TO CP-VALUATION-DT
  2821
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  56
* ECS056TT.cbl
  2822     MOVE CLAS-I-RL-AH (CLAS-INDEXL)
  2823                                 TO CP-BENEFIT-TYPE
  2824     MOVE CLAS-I-BAL (CLAS-INDEXL)
  2825                                 TO CP-SPECIAL-CALC-CD
  2826     MOVE CR-LF-TERM             TO CP-ORIGINAL-TERM
  2827                                    CP-LOAN-TERM
  2828
  2829     IF ((CLAS-I-EP (CLAS-INDEXL) EQUAL 'B' OR 'K' OR 'L') AND
  2830        CLAS-I-CALC-TYPE (CLAS-INDEXL) NOT EQUAL 'L')
  2831        ADD +1                   TO CP-ORIGINAL-TERM
  2832                                    CP-LOAN-TERM
  2833     END-IF
  2834
  2835     IF CP-TERM-IS-DAYS
  2836        MOVE CR-LF-TERM-IN-DAYS  TO CP-TERM-OR-EXT-DAYS
  2837     ELSE
  2838        MOVE ZEROS               TO CP-TERM-OR-EXT-DAYS
  2839     END-IF
  2840
  2841     MOVE DTE-REM-TRM-CALC-OPTION
  2842                                 TO CP-REM-TRM-CALC-OPTION
  2843
  2844     PERFORM 0510-GET-REMAINING-TERM
  2845                                 THRU 0510-EXIT
  2846
  2847     IF ((CLAS-I-EP (CLAS-INDEXL) = 'B' OR 'K' OR 'L') AND
  2848          CLAS-I-CALC-TYPE (CLAS-INDEXL) NOT = 'L')
  2849*       MOVE CP-REMAINING-TERM-2 TO LF-BAL-REMTERM
  2850        COMPUTE CP-REMAINING-TERM-1 =
  2851                       CP-REMAINING-TERM-1 - 1
  2852        COMPUTE CP-REMAINING-TERM-2 =
  2853                       CP-REMAINING-TERM-2 - 1
  2854     END-IF
  2855
  2856     IF CP-REMAINING-TERM-1 NEGATIVE
  2857         MOVE ZEROS              TO CP-REMAINING-TERM-1
  2858     END-IF
  2859
  2860     IF CP-REMAINING-TERM-2 NEGATIVE
  2861         MOVE ZEROS              TO CP-REMAINING-TERM-2
  2862     END-IF
  2863
  2864     MOVE CP-REMAINING-TERM-1    TO LF-REM-TRM1
  2865     MOVE CP-REMAINING-TERM-2    TO LF-REM-TRM2
  2866
  2867     .
  2868
  2869 0220-EXIT.
  2870     EXIT.
  2871
  2872 0230-CALC-LF-UEP.
  2873
  2874     DISPLAY ' MADE IT TO 0230 '
  2875     COMPUTE WS-EARN-TERM = CR-LF-TERM - LF-REM-TRM2
  2876
  2877     DISPLAY ' EARN TERM ' WS-EARN-TERM
  2878     IF CR-LOAN-TERM NOT NUMERIC
  2879        MOVE CR-LF-TERM          TO CR-LOAN-TERM
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  57
* ECS056TT.cbl
  2880     END-IF
  2881     IF CR-LOAN-TERM = ZEROS
  2882        MOVE CR-LF-TERM          TO CR-LOAN-TERM
  2883     END-IF
  2884     COMPUTE WS-I = CR-APR / +1200
  2885
  2886     MOVE WS-I                   TO WS-DISPLAY-FLD
  2887     DISPLAY ' WS I ' WS-DISPLAY-FLD
  2888
  2889     COMPUTE WS-J = WS-I + ((CR-LFPRM-RATE / +1000)
  2890        + (CR-AHPRM-RATE / +1000))
  2891
  2892     MOVE WS-J                   TO WS-DISPLAY-FLD
  2893     DISPLAY ' WS J ' WS-DISPLAY-FLD
  2894
  2895     COMPUTE WS-VM = (1 + WS-J) ** (CR-LF-TERM * -1)
  2896
  2897     MOVE WS-VM                  TO WS-DISPLAY-FLD
  2898     DISPLAY ' WS VM ' WS-DISPLAY-FLD
  2899
  2900     COMPUTE WS-ANGLEMJ = (1 - ((1 + WS-J)
  2901        ** (CR-LF-TERM * -1))) / WS-J
  2902
  2903     MOVE WS-ANGLEMJ             TO WS-DISPLAY-FLD
  2904     DISPLAY ' WS ANGLEMJ ' WS-DISPLAY-FLD
  2905     COMPUTE WS-ANGLEN = (1 - ((1 + WS-I)
  2906        ** (CR-LOAN-TERM * -1))) / WS-I
  2907
  2908     MOVE WS-ANGLEN              TO WS-DISPLAY-FLD
  2909     DISPLAY ' WS ANGLEN  ' WS-DISPLAY-FLD
  2910     COMPUTE WS-ANGLEM = (1 - ((1 + WS-I)
  2911        ** (CR-LF-TERM * -1))) / WS-I
  2912
  2913     MOVE WS-ANGLEM              TO WS-DISPLAY-FLD
  2914     DISPLAY ' WS ANGLEM  ' WS-DISPLAY-FLD
  2915     COMPUTE WS-ANGLEN-M = (1 - ((1 + WS-I)
  2916        ** ((CR-LOAN-TERM - CR-LF-TERM) * -1))) / WS-I
  2917
  2918     MOVE WS-ANGLEN-M            TO WS-DISPLAY-FLD
  2919     DISPLAY ' WS ANGLEN - M ' WS-DISPLAY-FLD
  2920     COMPUTE WS-P = CR-LFAMT / WS-ANGLEN
  2921     MOVE WS-P                   TO WS-DISPLAY-FLD
  2922     DISPLAY ' WS P       ' WS-DISPLAY-FLD
  2923     COMPUTE WS-B = WS-P * WS-ANGLEN-M
  2924     MOVE WS-B                   TO WS-DISPLAY-FLD
  2925     DISPLAY ' WS B       ' WS-DISPLAY-FLD
  2926     COMPUTE WS-R = (CR-LFAMT - (WS-B * WS-VM))
  2927        / WS-ANGLEM
  2928     MOVE WS-R                   TO WS-DISPLAY-FLD
  2929     DISPLAY ' WS R       ' WS-DISPLAY-FLD
  2930
  2931     MOVE CR-LFAMT               TO WS-AMT
  2932     MOVE CR-LFPRM-RATE          TO WS-DISPLAY-FLD
  2933     DISPLAY ' LF RATE ' WS-DISPLAY-FLD
  2934     MOVE CR-AHPRM-RATE          TO WS-DISPLAY-FLD
  2935     DISPLAY ' AH RATE ' WS-DISPLAY-FLD
  2936
  2937     MOVE +0                     TO WS-LF-PRM
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  58
* ECS056TT.cbl
  2938                                    WS-AH-PRM
  2939     MOVE 2                      TO WS-EARN-TERM
  2940     PERFORM VARYING WS-A FROM +1 BY +1 UNTIL
  2941        (WS-A > WS-EARN-TERM)
  2942        IF WS-A = +1
  2943           COMPUTE WS-I1 ROUNDED = (WS-AMT * (WS-I / +30
  2944              * (CR-PMT-EXTENSION-DAYS + +30)) * +100) / +100
  2945        ELSE
  2946           COMPUTE WS-I1 ROUNDED = (WS-AMT * WS-I * +100)
  2947              / +100
  2948        END-IF
  2949        MOVE WS-I1               TO WS-DISPLAY-FLD
  2950        DISPLAY ' ' WS-A '  WS-I1  ' WS-DISPLAY-FLD
  2951        DISPLAY ' RUN DATE ' RUN-DATE
  2952        DISPLAY ' ENTRY DATE ' CR-ENTRY-DATE
  2953        IF RUN-DATE = CR-ENTRY-DATE
  2954           COMPUTE WS-LF-PRM = WS-LF-PRM
  2955              + (WS-AMT / +1000 * CR-LFPRM-RATE)
  2956           COMPUTE WS-AH-PRM = WS-AH-PRM
  2957              + (WS-AMT / +1000 * CR-AHPRM-RATE)
  2958        ELSE
  2959           COMPUTE WS-LF-PRM = WS-AMT / +1000 * CR-LFPRM-RATE
  2960           COMPUTE WS-AH-PRM = WS-AMT / +1000 * CR-AHPRM-RATE
  2961        END-IF
  2962        COMPUTE WS-AMT ROUNDED = (.05 + (WS-AMT - (WS-R
  2963           - WS-I1 - (WS-LF-PRM + WS-AH-PRM))) * +100)
  2964           / +100
  2965        IF WS-AMT < +0
  2966           COMPUTE WS-P = WS-P + WS-AMT
  2967           MOVE ZEROS            TO WS-AMT
  2968        END-IF
  2969        IF WS-A = CR-LOAN-TERM
  2970           IF WS-AMT > ZEROS
  2971              IF WS-R > WS-AMT
  2972                 COMPUTE WS-R = WS-R - WS-AMT
  2973                 MOVE ZEROS      TO WS-AMT
  2974              ELSE
  2975                 MOVE CR-LFAMT-ALT TO WS-R
  2976                 MOVE ZEROS      TO WS-AMT
  2977              END-IF
  2978           END-IF
  2979        END-IF
  2980     END-PERFORM
  2981
  2982     COMPUTE WS-EXP-PREM = WS-LF-PRM + WS-AH-PRM
  2983     .
  2984
  2985 0230-EXIT.
  2986     EXIT.
  2987
  2988 0250-BREAK-RTN.
  2989
  2990     IF WS-HOLD-CAR NOT = CR-CARRIER
  2991        PERFORM 0300-ACCT-BREAK  THRU 0300-EXIT
  2992        PERFORM 0310-ST-BREAK    THRU 0310-EXIT
  2993        PERFORM 0320-GRP-BREAK   THRU 0320-EXIT
  2994        PERFORM 0340-CAR-BREAK   THRU 0340-EXIT
  2995     ELSE
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  59
* ECS056TT.cbl
  2996        IF WS-HOLD-GRP NOT = CR-GROUPING
  2997           PERFORM 0300-ACCT-BREAK
  2998                                 THRU 0300-EXIT
  2999           PERFORM 0310-ST-BREAK THRU 0310-EXIT
  3000           PERFORM 0320-GRP-BREAK
  3001                                 THRU 0320-EXIT
  3002        ELSE
  3003           IF WS-HOLD-ST NOT = CR-STATE
  3004              PERFORM 0300-ACCT-BREAK
  3005                                 THRU 0300-EXIT
  3006              PERFORM 0310-ST-BREAK
  3007                                 THRU 0310-EXIT
  3008           ELSE
  3009              IF WS-HOLD-ACCT NOT = CR-ACCOUNT
  3010                 PERFORM 0300-ACCT-BREAK
  3011                                 THRU 0300-EXIT
  3012              END-IF
  3013           END-IF
  3014        END-IF
  3015     END-IF
  3016
  3017 0250-EXIT.
* 301-S*********                                                       (  49)**
**    Unrecognized verb
  3018     EXIT.
  3019
  3020 0300-ACCT-BREAK.
  3021
  3022     IF (WS-TOT-EXP-PREM (1) = ZEROS)
  3023        AND (WS-TOT-REC-PREM (1) = ZEROS)
  3024        AND (WS-TOT-GA-COMM (1) = ZEROS)
  3025        CONTINUE
  3026     ELSE
  3027        MOVE SPACES              TO DETAIL-LINE
  3028        MOVE WS-HOLD-CAR         TO DTL1-CAR
  3029        MOVE WS-HOLD-GRP         TO DTL1-GRP
  3030        MOVE WS-HOLD-ST          TO DTL1-ST
  3031        MOVE WS-HOLD-ACCT        TO DTL1-ACCT
  3032        MOVE WS-TOT-EXP-PREM (1) TO DTL1-EXP-PREM
  3033        MOVE WS-TOT-REC-PREM (1) TO DTL1-REC-PREM
  3034        MOVE WS-TOT-GA-COMM (1)  TO DTL1-COMM
  3035        MOVE DETAIL-LINE         TO PRT
  3036        PERFORM 8800-PRT-RTN     THRU 8800-EXIT
  3037
  3038        COMPUTE WS-TOT-EXP-PREM (2) = WS-TOT-EXP-PREM (2)
  3039           + WS-TOT-EXP-PREM (1)
  3040        COMPUTE WS-TOT-REC-PREM (2) = WS-TOT-REC-PREM (2)
  3041           + WS-TOT-REC-PREM (1)
  3042        COMPUTE WS-TOT-GA-COMM (2) = WS-TOT-GA-COMM (2)
  3043           + WS-TOT-GA-COMM (1)
  3044     END-IF
  3045     MOVE +0                     TO WS-TOT-EXP-PREM (1)
  3046                                    WS-TOT-REC-PREM (1)
  3047                                    WS-TOT-GA-COMM  (1)
  3048
  3049     .
  3050 0300-EXIT.
  3051     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  60
* ECS056TT.cbl
  3052
  3053 0310-ST-BREAK.
  3054
  3055     IF (WS-TOT-EXP-PREM (2) = ZEROS)
  3056        AND (WS-TOT-REC-PREM (2) = ZEROS)
  3057        AND (WS-TOT-GA-COMM (2) = ZEROS)
  3058        CONTINUE
  3059     ELSE
  3060        MOVE SPACES              TO DETAIL-LINE
  3061        MOVE WS-HOLD-CAR         TO DTL1-CAR
  3062        MOVE WS-HOLD-GRP         TO DTL1-GRP
  3063        MOVE WS-HOLD-ST          TO DTL1-ST
  3064        MOVE SPACES              TO DTL1-ACCT
  3065        MOVE WS-TOT-EXP-PREM (2) TO DTL1-EXP-PREM
  3066        MOVE WS-TOT-REC-PREM (2) TO DTL1-REC-PREM
  3067        MOVE WS-TOT-GA-COMM (2)  TO DTL1-COMM
  3068        MOVE DETAIL-LINE         TO PRT
  3069        PERFORM 8800-PRT-RTN     THRU 8800-EXIT
  3070
  3071        COMPUTE WS-TOT-EXP-PREM (3) = WS-TOT-EXP-PREM (3)
  3072           + WS-TOT-EXP-PREM (2)
  3073        COMPUTE WS-TOT-REC-PREM (3) = WS-TOT-REC-PREM (3)
  3074           + WS-TOT-REC-PREM (2)
  3075        COMPUTE WS-TOT-GA-COMM (3) = WS-TOT-GA-COMM (3)
  3076           + WS-TOT-GA-COMM (2)
  3077     END-IF
  3078
  3079     MOVE +0                     TO WS-TOT-EXP-PREM (2)
  3080                                    WS-TOT-REC-PREM (2)
  3081                                    WS-TOT-GA-COMM  (2)
  3082
  3083     .
  3084 0310-EXIT.
  3085     EXIT.
  3086
  3087 0320-GRP-BREAK.
  3088
  3089     IF (WS-TOT-EXP-PREM (3) = ZEROS)
  3090        AND (WS-TOT-REC-PREM (3) = ZEROS)
  3091        AND (WS-TOT-GA-COMM (3) = ZEROS)
  3092        CONTINUE
  3093     ELSE
  3094        MOVE SPACES              TO DETAIL-LINE
  3095        MOVE WS-HOLD-CAR         TO DTL1-CAR
  3096        MOVE WS-HOLD-GRP         TO DTL1-GRP
  3097        MOVE SPACES              TO DTL1-ST
  3098        MOVE SPACES              TO DTL1-ACCT
  3099        MOVE WS-TOT-EXP-PREM (3) TO DTL1-EXP-PREM
  3100        MOVE WS-TOT-REC-PREM (3) TO DTL1-REC-PREM
  3101        MOVE WS-TOT-GA-COMM (3)  TO DTL1-COMM
  3102        MOVE DETAIL-LINE         TO PRT
  3103        PERFORM 8800-PRT-RTN     THRU 8800-EXIT
  3104
  3105        COMPUTE WS-TOT-EXP-PREM (4) = WS-TOT-EXP-PREM (4)
  3106           + WS-TOT-EXP-PREM (3)
  3107        COMPUTE WS-TOT-REC-PREM (4) = WS-TOT-REC-PREM (4)
  3108           + WS-TOT-REC-PREM (3)
  3109        COMPUTE WS-TOT-GA-COMM (4) = WS-TOT-GA-COMM (4)
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  61
* ECS056TT.cbl
  3110           + WS-TOT-GA-COMM (3)
  3111     END-IF
  3112
  3113     MOVE +0                     TO WS-TOT-EXP-PREM (3)
  3114                                    WS-TOT-REC-PREM (3)
  3115                                    WS-TOT-GA-COMM  (3)
  3116
  3117     .
  3118 0320-EXIT.
  3119     EXIT.
  3120
  3121 0330-CAR-BREAK.
  3122
  3123     IF (WS-TOT-EXP-PREM (4) = ZEROS)
  3124        AND (WS-TOT-REC-PREM (4) = ZEROS)
  3125        AND (WS-TOT-GA-COMM (4) = ZEROS)
  3126        CONTINUE
  3127     ELSE
  3128        MOVE SPACES              TO DETAIL-LINE
  3129        MOVE WS-HOLD-CAR         TO DTL1-CAR
  3130        MOVE SPACES              TO DTL1-GRP
  3131        MOVE SPACES              TO DTL1-ST
  3132        MOVE SPACES              TO DTL1-ACCT
  3133        MOVE WS-TOT-EXP-PREM (4) TO DTL1-EXP-PREM
  3134        MOVE WS-TOT-REC-PREM (4) TO DTL1-REC-PREM
  3135        MOVE WS-TOT-GA-COMM (4)  TO DTL1-COMM
  3136        MOVE DETAIL-LINE         TO PRT
  3137        PERFORM 8800-PRT-RTN     THRU 8800-EXIT
  3138
  3139        COMPUTE WS-TOT-EXP-PREM (5) = WS-TOT-EXP-PREM (5)
  3140           + WS-TOT-EXP-PREM (4)
  3141        COMPUTE WS-TOT-REC-PREM (5) = WS-TOT-REC-PREM (5)
  3142           + WS-TOT-REC-PREM (4)
  3143        COMPUTE WS-TOT-GA-COMM (5) = WS-TOT-GA-COMM (5)
  3144           + WS-TOT-GA-COMM (4)
  3145     END-IF
  3146
  3147     MOVE +0                     TO WS-TOT-EXP-PREM (4)
  3148                                    WS-TOT-REC-PREM (4)
  3149                                    WS-TOT-GA-COMM  (4)
  3150
  3151     .
  3152 0330-EXIT.
  3153     EXIT.
  3154
  3155 0340-FIN-BREAK.
  3156
  3157     IF (WS-TOT-EXP-PREM (5) = ZEROS)
  3158        AND (WS-TOT-REC-PREM (5) = ZEROS)
  3159        AND (WS-TOT-GA-COMM (5) = ZEROS)
  3160        CONTINUE
  3161     ELSE
  3162        MOVE SPACES              TO DETAIL-LINE
  3163        MOVE SPACES              TO DTL1-CAR
  3164        MOVE SPACES              TO DTL1-GRP
  3165        MOVE SPACES              TO DTL1-ST
  3166        MOVE SPACES              TO DTL1-ACCT
  3167        MOVE WS-TOT-EXP-PREM (5) TO DTL1-EXP-PREM
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  62
* ECS056TT.cbl
  3168        MOVE WS-TOT-REC-PREM (5) TO DTL1-REC-PREM
  3169        MOVE WS-TOT-GA-COMM (5)  TO DTL1-COMM
  3170        MOVE DETAIL-LINE         TO PRT
  3171        PERFORM 8800-PRT-RTN     THRU 8800-EXIT
  3172
  3173*       COMPUTE WS-TOT-EXP-PREM (5) = WS-TOT-EXP-PREM (5)
  3174*          + WS-TOT-EXP-PREM (4)
  3175*       COMPUTE WS-TOT-REC-PREM (5) = WS-TOT-REC-PREM (5)
  3176*          + WS-TOT-REC-PREM (4)
  3177*       COMPUTE WS-TOT-GA-COMM (5) = WS-TOT-GA-COMM (5)
  3178*          + WS-TOT-GA-COMM (4)
  3179     END-IF
  3180
  3181     .
  3182 0340-EXIT.
  3183     EXIT.
  3184
  3185 0420-CALC-AH-REM-TERM.
  3186
  3187     MOVE WS-BIN-VAL-DATES (VYR) TO CP-VALUATION-DT
  3188
  3189     MOVE CLAS-I-RL-AH (CLAS-INDEXA)
  3190                                 TO CP-BENEFIT-TYPE
  3191     MOVE CLAS-I-BAL (CLAS-INDEXA)
  3192                                 TO CP-SPECIAL-CALC-CD
  3193     MOVE CR-AH-TERM             TO CP-ORIGINAL-TERM
  3194                                    CP-LOAN-TERM
  3195
  3196     MOVE ZEROS                  TO CP-TERM-OR-EXT-DAYS
  3197
  3198     MOVE DTE-REM-TRM-CALC-OPTION
  3199                                 TO CP-REM-TRM-CALC-OPTION
  3200
  3201     PERFORM 0510-GET-REMAINING-TERM
  3202                                 THRU 0510-EXIT
  3203
  3204     IF CP-REMAINING-TERM-1 NEGATIVE
  3205         MOVE ZEROS              TO CP-REMAINING-TERM-1
  3206     END-IF
  3207
  3208     IF CP-REMAINING-TERM-2 NEGATIVE
  3209         MOVE ZEROS              TO CP-REMAINING-TERM-2
  3210     END-IF
  3211
  3212     MOVE CP-REMAINING-TERM-1    TO AH-REM-TRM1
  3213     MOVE CP-REMAINING-TERM-2    TO AH-REM-TRM2
  3214
  3215     .
  3216
  3217 0420-EXIT.
  3218     EXIT.
  3219
  3220
  3221
  3222 0510-GET-REMAINING-TERM.
  3223
  3224     CALL 'ELRTRMX' USING CALCULATION-PASS-AREA
  3225
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  63
* ECS056TT.cbl
  3226     .
  3227
  3228 0510-EXIT.
  3229     EXIT.
  3230
  3231
  3232     .
  3233 2900-DISPLAY-AMTS.
  3234
  3235*    IF (CR-DT > 19921231) AND
  3236*       (CR-DT < 19940101) AND
  3237*    IF (WS-BIN-VAL-DATES (VYR) = X'95FF')
  3238*       MOVE CR-DT TO WS-DISPLAY-DATE
  3239*       MOVE CR-LF-TERM TO WS-DISPLAY-TERM
  3240*       MOVE LF-REM-TRM2 TO WS-DISPLAY-RTERM
  3241*       MOVE CR-LFPRM TO WS-DISPLAY-PRM
  3242*       IF CLAS-I-EP (CLAS-INDEXL) EQUAL 'B' OR 'K' OR 'L'
  3243*          ADD CR-LFAMT CR-LFAMT-ALT GIVING WS-DISPLAY-AMT
  3244*       ELSE
  3245*          MOVE CR-LFAMT     TO WS-DISPLAY-AMT
  3246*       END-IF
  3247*       MOVE WS-REM-AMT   TO WS-DISPLAY-RAMT
  3248*       DISPLAY '  ' CR-CERT-NO '  ' WS-DISPLAY-DATE '   '
  3249*        WS-DISPLAY-TERM '  ' WS-DISPLAY-RTERM '   '
  3250*        WS-DISPLAY-AMT '   ' WS-DISPLAY-RAMT
  3251*    END-IF
  3252
  3253     .
  3254 2999-CALC-REM-AMT-X.
  3255     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  64
* ECS056TT.cbl
  3257 8600-HD-RTN.                                                     ECS064
  3258     MOVE HD1                    TO  P-LINE.                      ECS064
*  12-S******************************************                      (  59)**
**    Operand P-LINE is not declared
  3259     MOVE SPACE-NP               TO  P-CCSW.                      ECS064
*  12-S******************************************                      (  64)**
**    Operand P-CCSW is not declared
  3260                                                                  ECS064
  3261     PERFORM 8800-PRT-RTN  THRU  8800-EXIT.                       ECS064
  3262                                                                  ECS064
  3263     ADD +1                      TO  PGCTR.                       ECS064
*  12-S*****************************************                       (  64)**
**    Operand PGCTR is not declared
  3264                                                                  ECS064
  3265     MOVE PGCTR                  TO  HD-PG.                       ECS064
*  12-S**************                                                  (  64)**
**    Operand PGCTR is not declared
  3266     MOVE HD2                    TO  P-LINE.                      ECS064
*  12-S******************************************                      (  64)**
**    Operand P-LINE is not declared
  3267     MOVE SPACE-1                TO  P-CCSW.                      ECS064
*  12-S******************************************                      (  64)**
**    Operand P-CCSW is not declared
  3268                                                                  ECS064
  3269     PERFORM 8800-PRT-RTN  THRU  8800-EXIT.                       ECS064
  3270                                                                  ECS064
  3271     MOVE HD3                    TO  P-LINE.                      ECS064
*  12-S******************************************                      (  64)**
**    Operand P-LINE is not declared
  3272     MOVE SPACE-1                TO  P-CCSW.                      ECS064
*  12-S******************************************                      (  64)**
**    Operand P-CCSW is not declared
  3273                                                                  ECS064
  3274     PERFORM 8800-PRT-RTN  THRU  8800-EXIT.                       ECS064
  3275                                                                  ECS064
  3276     MOVE SPACE-2                TO  P-CCSW.                      ECS064
*  12-S******************************************                      (  64)**
**    Operand P-CCSW is not declared
  3277     MOVE 'COMPANY'              TO  P-MSG.                       ECS064
*  12-S*****************************************                       (  64)**
**    Operand P-MSG is not declared
  3278     MOVE CUR-CARR               TO  P-CARR.                      ECS064
*  12-S*****************                                               (  64)**
**    Operand CUR-CARR is not declared
  3279     MOVE CUR-GROUP              TO  P-GROUP.                     ECS064
*  12-S******************                                              (  64)**
**    Operand CUR-GROUP is not declared
  3280     MOVE '-'                    TO  P-DASH.                      ECS064
*  12-S******************************************                      (  64)**
**    Operand P-DASH is not declared
  3281                                                                  ECS064
  3282     PERFORM 8800-PRT-RTN  THRU  8800-EXIT.                       ECS064
  3283                                                                  ECS064
  3284     MOVE SPACE-2                TO  P-CCSW.                      ECS064
*  12-S******************************************                      (  64)**
**    Operand P-CCSW is not declared
  3285     MOVE HD4                    TO  P-LINE.                      ECS064
*  12-S******************************************                      (  64)**
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  65
* ECS056TT.cbl
**    Operand P-LINE is not declared
  3286                                                                  ECS064
  3287     PERFORM 8800-PRT-RTN  THRU  8800-EXIT.                       ECS064
  3288                                                                  ECS064
  3289     MOVE HD5                    TO  P-LINE.                      ECS064
*  12-S******************************************                      (  64)**
**    Operand P-LINE is not declared
  3290                                                                  ECS064
  3291     PERFORM 8800-PRT-RTN  THRU  8800-EXIT.                       ECS064
  3292                                                                  ECS064
  3293     MOVE +10                    TO  LNCTR.                       ECS064
*  12-S*****************************************                       (  65)**
**    Operand LNCTR is not declared
  3294     MOVE SPACE-2                TO  P-CCSW.                      ECS064
*  12-S******************************************                      (  65)**
**    Operand P-CCSW is not declared
  3295                                                                  ECS064
  3296 8699-EXIT.                                                       ECS064
  3297     EXIT.                                                        ECS064
  3298                                                                  ECS064
  3299 8800-PRT-RTN.                                                    ECS064
  3300
  3301     IF LNCTR > +56
*  12-S************                                                    (  65)**
**    Operand LNCTR is not declared
  3302        PERFORM 8600-HD-RTN      THRU 8699-EXIT
  3303     END-IF
* 564-S**********                                                      (  65)**
**    A scope-delimiter did not have a matching verb and was discarded.
  3304
  3305     MOVE P-CTL                  TO X
  3306     IF P-CTL = SPACE-1
  3307        ADD +1                   TO LNCTR
*  12-S****************************************                        (  65)**
**    Operand LNCTR is not declared
  3308     ELSE
  3309        IF P-CTL = SPACE-2
  3310           ADD +2                TO LNCTR
*  12-S****************************************                        (  65)**
**    Operand LNCTR is not declared
  3311        ELSE
  3312           IF P-CTL = SPACE-3
  3313              ADD +3             TO LNCTR
*  12-S****************************************                        (  65)**
**    Operand LNCTR is not declared
  3314           END-IF
  3315        END-IF
  3316     END-IF
  3317                                                                  ECS064
  3318                                                                  ECS064
  3319 8850-COPY-PRT-RTN.                                               ECS064
* 301-S*****************                                               (  65)**
**    Unrecognized verb
* 3320                                 COPY ELCPRT2.
  3321******************************************************************04/15/98
  3322*                                                                *ELCPRT2
  3323*                                                                *ELCPRT2
  3324*                            ELCPRT2                             *   LV005
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  66
* ECS056TT.cbl (/apps/prod/cid1p/copy/ELCPRT2)
  3325*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**5
  3326*                            VMOD=2.002                          *   CL**5
  3327*                                                                *   CL**4
  3328******************************************************************   CL**4
  3329                                                                     CL**4
  3330     IF DTE-FICH NOT = SPACE AND                                     CL**4
  3331        FICH-OPEN    = SPACE                                         CL**4
  3332         MOVE 'X'                TO  FICH-OPEN                       CL**4
  3333         OPEN OUTPUT FICH.                                           CL**4
*  12-S************************                                        (  65)**
**    Operand FICH is not declared
  3334                                                                     CL**4
  3335     IF DTE-FICH NOT = SPACE                                         CL**4
  3336         MOVE X                  TO  P-CTL                           CL**4
  3337         WRITE FICH-REC FROM PRT.                                    CL**4
*  12-S**********************                                          (  66)**
**    Operand FICH-REC is not declared
  3338                                                                     CL**4
  3339     IF DTE-FICH = SPACE OR '2'                                      CL**4
  3340       MOVE X                    TO  P-CTL                           CL**4
  3341       IF P-CTL = ' '                                                CL**4
  3342         WRITE PRT AFTER ADVANCING 1 LINE                            CL**4
  3343       ELSE                                                          CL**4
  3344         IF P-CTL = '0'                                              CL**4
  3345           WRITE PRT AFTER ADVANCING 2 LINES                         CL**4
  3346         ELSE                                                        CL**4
  3347           IF P-CTL = '-'                                            CL**4
  3348             WRITE PRT AFTER ADVANCING 3 LINES                       CL**4
  3349           ELSE                                                      CL**4
  3350             WRITE PRT AFTER ADVANCING PAGE.                         CL**4
  3351                                                                     CL**4
  3352******************************************************************   CL**4
  3353                                                                  ECS064
  3354 8800-EXIT.                                                       ECS064
  3355     EXIT.                                                        ECS064
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  67
* ECS056TT.cbl
  3357 8510-DATE-CONVERSION.
  3358
  3359     CALL 'ELDATCX' USING DATE-CONVERSION-DATA
  3360
  3361     .
  3362
  3363 8590-EXIT.
  3364     EXIT.
  3365
  3366
  3367
  3368
  3369 ABEND-PGM.
* 3370                                 COPY ELCABEND.
  3371***************************************************************** 04/14/98
  3372*                                                               * ELCABEND
  3373*                            ELCABEND.                          *    LV003
  3374*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
  3375*                            VMOD 2.002                              CL**2
  3376*                                                               * ELCABEND
  3377*                THIS SECTION DISPLAYS THE NECESSARY MESSAGES   * ELCABEND
  3378*            AND THEN ABENDS.                                   * ELCABEND
  3379*                                                               * ELCABEND
  3380*  NO  CID  MODS  IN  COPYBOOK  ELCABEND                        * ELCABEND
  3381*                                                               * ELCABEND
  3382***************************************************************** ELCABEND
  3383*APS-010.                                                         ELCABEND
  3384     DISPLAY WS-ABEND-MESSAGE.                                    ELCABEND
  3385     DISPLAY WS-ABEND-MESSAGE UPON CONSOLE.                       ELCABEND
  3386                                                                  ELCABEND
  3387     IF WS-ABEND-FILE-STATUS NOT = ZERO                           ELCABEND
  3388         DISPLAY 'FILE STATUS = ' WS-ABEND-FILE-STATUS            ELCABEND
  3389         DISPLAY 'FILE STATUS = ' WS-ABEND-FILE-STATUS            ELCABEND
  3390                                 UPON CONSOLE.                    ELCABEND
  3391                                                                  ELCABEND
  3392     IF WS-RETURN-CODE NOT = ZERO                                 ELCABEND
  3393         DISPLAY 'RETURN CODE = '  WS-RETURN-CODE                 ELCABEND
  3394         DISPLAY 'RETURN CODE = '  WS-RETURN-CODE                 ELCABEND
  3395                                 UPON CONSOLE.                    ELCABEND
  3396                                                                  ELCABEND
  3397     DISPLAY 'PROGRAM WILL NOW ABEND **************'              ELCABEND
  3398     DISPLAY 'PROGRAM WILL NOW ABEND **************'              ELCABEND
  3399                                 UPON CONSOLE.                    ELCABEND
  3400                                                                  ELCABEND
  3401     DIVIDE WS-ZERO BY WS-ZERO GIVING WS-ZERO.                    ELCABEND
  3402     CALL 'ABORTME'.
  3403                                                                  ELCABEND
  3404 APS-EXIT.                                                        ELCABEND
  3405     EXIT.                                                        ELCABEND
  3406
*      0250-EXIT
* 348-S*********                                                       (  66)**
**    Procedure name 0250-EXIT undeclared, line 2539 (first usage)
*      0340-CAR-BREAK
* 348-S**************                                                  (  67)**
**    Procedure name 0340-CAR-BREAK undeclared, line 2994 (first usage)
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  68
* ECS056TT.cbl
*                                                        REF GNR-008065005AF
* Last message on page:   67
* Total Messages:    31
* Unrecoverable :     0                    Severe  :    31
* Errors        :     0                    Warnings:     0
* Informational :     0                    Flags   :     0
* Data:       50725     Code:           0
