* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   1
* ECS010P.cbl
* Options: int("ECS010P.int") anim csi verbose NOBOUND PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("ECS010P.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"ebmlsfile" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" NOCHECKDIV NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"32" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"ECS010P.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"ECS010P.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR NOSTICKY-LINKAGE
*          NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"2" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                 ECS010.
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 04/27/94 07:51:58.
     7*              PROGRAM REVIEWED FOR YEAR 2000 COMPLIANCE
     8*                            VMOD=2.082.
     9
    10*AUTHOR.        LOGIC, INC.
    11*               DALLAS, TEXAS.
    12
    13*DATE-COMPILED.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   2
* ECS010P.cbl
    14
    15*SECURITY.   *****************************************************
    16*            *                                                   *
    17*            *   THIS PROGRAM IS THE PROPERTY OF LOGIC, INC.     *
    18*            *                                                   *
    19*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
    20*            *   OF LOGIC, INC. IS EXPRESSLY PROHIBITED WITHOUT  *
    21*            *   THE PRIOR WRITTEN PERMISSION OF LOGIC INC.      *
    22*            *                                                   *
    23*            *****************************************************
    24
    25*REMARKS.
    26*        THIS PROGRAM ACCEPTS VALIDATED TRANSACTIONS FROM EL522
    27*        AND APPLIES THEM TO THE CERTIFICATE MASTER FILE.
    28*        EXTRACTS ARE PRODUCED FOR PRODUCTION  EARNED PREMIUM &
    29*        LOSS, REINSURANCE, COMMISSIONS, CLAIMS REGISTER, ETC.
    30******************************************************************
    31*                   C H A N G E   L O G
    32*
    33* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    34*-----------------------------------------------------------------
    35*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    36* EFFECTIVE    NUMBER
    37*-----------------------------------------------------------------
    38* 061802                   PEMA  ADD PROCESS FOR PEOPLES
    39* 062602    2002061900011  SMVA  CHANGE SYS009 SYSOUT TO FILE WITH
    40*                              ORGANIZATION AS LINE SEQUENTIAL
    41* 070102                   SMVA  CLEAN UP COMPILE ERRORS
    42* 080702    2002061800008  PEMA  ADD PROCESS FOR SUNFLOWER
    43* 092602    2002091900008  PEMA  INCREASE NUMBER OF MAXIMUM
    44*                                  BENEFIT CODES FROM 450 TO 900
    45* 111402    2001061800003  PEMA  ADD DCC PROCESSING
    46* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
    47* 052703                   PEMA  MODIFY CEDE BALLOON PREM TO NSP
    48* 070203                   PEMA  BUILD REIN COMP DATA FOR NSP
    49* 100703    2003080800002  PEMA  ADD SUPER GAP PROCESSING
    50* 123003                   PEMA  MODIFY COMPUTE STMTS FOR REIN
    51* 040504    2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
    52* 062104    2004050700001  SMVA  ADD NEW FILES TO AUTOMATE ME BALANCING
    53* 102204    2004101500007  PEMA  IBNR FOR DCC
    54* 111204    2004110300005  PEMA  SPLIT SPP BANK FEE
    55* 123004                   PEMA  ADD REFUND PROCESSING FOR "MONTHLY"
    56* 020305    2005020000000  PEMA  ADD CLP STATE PROCESSING
    57* 092705  CR2005050300006  PEMA  ADD SPP LEASES
    58* 052306  CR2006050800002  PEMA  ADD COMM TYPE 'J'
    59* 061206  CR2006050500001  PEMA  ADD FIRST PREMIER BANK
    60* 011207                   PEMA  PASS SIG SW TO BATCH CERT FILE
    61******************************************************************
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   3
* ECS010P.cbl
    63 ENVIRONMENT DIVISION.
    64 CONFIGURATION SECTION.
    65 SPECIAL-NAMES.
    66     C02 IS LCP-CH2
    67     C03 IS LCP-CH3
    68     C04 IS LCP-CH4
    69     C05 IS LCP-CH5
    70     C06 IS LCP-CH6
    71     C07 IS LCP-CH7
    72     C08 IS LCP-CH8
    73     C09 IS LCP-CH9
    74     C10 IS LCP-CH10
    75     C11 IS LCP-CH11
    76     C12 IS LCP-CH12
    77     S01 IS LCP-P01
    78     S02 IS LCP-P02.
    79
    80 INPUT-OUTPUT SECTION.
    81 FILE-CONTROL.
    82
    83     SELECT PENDING-EXTRACT  ASSIGN TO SYS005.
    84
    85     SELECT CERT-MASTER-IN   ASSIGN TO SYS010.
    86
    87     SELECT ERACCTT-IN       ASSIGN TO ERACCTT
    88                             ACCESS IS SEQUENTIAL
    89                             ORGANIZATION IS INDEXED
    90                             FILE STATUS IS ERACCTT-FILE-STATUS
    91                             RECORD KEY IS AM-CONTROL-PRIMARY.
    92
    93     SELECT ERRTBL-IN        ASSIGN TO ERRTBLT
    94                             ACCESS IS DYNAMIC
    95                             ORGANIZATION IS INDEXED
    96                             FILE STATUS IS ERRTBL-FILE-STATUS
    97                             RECORD KEY IS RE-CONTROL-PRIMARY.
    98
    99     SELECT ERCTBL           ASSIGN TO ERCTBLT
   100                             ACCESS IS DYNAMIC
   101                             ORGANIZATION IS INDEXED
   102                             FILE STATUS IS ERCTBL-FILE-STATUS
   103                             RECORD KEY IS CT-CONTROL-PRIMARY.
   104
   105     SELECT ERMEBL-INOUT     ASSIGN TO ERMEBL
   106                             ORGANIZATION INDEXED
   107                             ACCESS DYNAMIC
   108                             RECORD KEY ME-CONTROL-PRIMARY
   109                             FILE STATUS ERMEBL-FILE-STATUS.
   110
   111     SELECT ERRESC-IN        ASSIGN TO ERRESC
   112                             ORGANIZATION IS INDEXED
   113                             ACCESS IS DYNAMIC
   114                             RECORD KEY IS ERRESC-RECORD-KEY
   115                             FILE STATUS IS ERRESC-FILE-STATUS.
   116
   117     SELECT ELCRTT           ASSIGN TO ELCRTT
   118                             ACCESS IS DYNAMIC
   119                             ORGANIZATION IS INDEXED
   120                             FILE STATUS IS ELCRTT-FILE-STATUS
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   4
* ECS010P.cbl
   121                             RECORD KEY IS CS-CONTROL-PRIMARY.
   122
   123     SELECT ERAGTC           ASSIGN TO ERAGTC
   124                             ACCESS IS DYNAMIC
   125                             ORGANIZATION IS INDEXED
   126                             FILE STATUS IS ERAGTC-FILE-STATUS
   127                             RECORD KEY IS AG-CONTROL-PRIMARY.
   128
   129     SELECT CERT-MASTER-OUT  ASSIGN TO SYS011.
   130
   131     SELECT DETAIL-EXTR      ASSIGN TO SYS017.
   132
   133     SELECT SUMMARY-EXTR     ASSIGN TO SYS018.
   134
   135
   136     SELECT ME-ECS010-BALANCE
   137                             ASSIGN TO SYS012
   138                             ORGANIZATION IS LINE SEQUENTIAL.
   139
   140     SELECT ME50-ECS010-BALANCE
   141                             ASSIGN TO SYS013
   142                             ORGANIZATION IS LINE SEQUENTIAL.
   143
   144     SELECT DISPLAY-PRT      ASSIGN TO SYS022.
   145
   146     SELECT DISK-DATE        ASSIGN TO SYS019.
   147
   148     SELECT PRINT-COPY       ASSIGN TO SYS008.
   149
   150     SELECT MISMATCH-REPORT  ASSIGN TO SYS009.
   151
   152     SELECT FICH             ASSIGN TO SYS020.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   5
* ECS010P.cbl
   154 DATA DIVISION.
   155 FILE SECTION.
   156
   157 FD  PENDING-EXTRACT
   158     BLOCK CONTAINS 0 RECORDS
   159     RECORDING MODE F.
   160
*  161                             COPY ERCEXTD.
   162******************************************************************04/29/98
   163*                                                                *ERCEXTD
   164*                                                                *ERCEXTD
   165*                            ERCEXTD                             *   LV002
   166*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
   167*                            VMOD=2.002                          *   CL**2
   168*                                                                *ERCEXTD
   169*   FILE DESCRIPTION = ONLINE TO BATCH FILE INTERFACE AND REPORT *ERCEXTD
   170*                      EXTRACT FOR OFFLINE REPORTING.            *ERCEXTD
   171*                                                                *ERCEXTD
   172*     THIS FILE IS CREATED FROM ERCEXTR EXTRACT INTERFACE        *ERCEXTD
   173*  FOR THE FOLLOWING RECORD TYPES. THE MAIN BODY OF EACH RECORD  *ERCEXTD
   174*  CONTAINS A STRAIGHT COPY OF THE EX-DATA-AREA IN EXCEXTR.      *ERCEXTD
   175*                                                                *ERCEXTD
   176*         RECORD                                                 *ERCEXTD
   177*          TYPE          PROGRAM USING                           *ERCEXTD
   178*        --------        --------------------------------        *ERCEXTD
   179*           A             EL522  PENDING BUSINESS EXTRACT        *ERCEXTD
   180*           B             EL522  PENDING CLAIMS   EXTRACT        *ERCEXTD
   181*           C             EL522  CERT CHANGES     EXTRACT        *ERCEXTD
   182*                                                                *ERCEXTD
   183* -------------------------------------------------------------- *ERCEXTD
   184*                                                                *ERCEXTD
   185*   FILE TYPE = SEQUENTIAL                                       *ERCEXTD
   186*   RECORD SIZE = 588   RECFORM = FIX                            *ERCEXTD
   187*                                                                *ERCEXTD
   188*   FILENAME = EREXTD                                            *ERCEXTD
   189*                                                                *ERCEXTD
   190******************************************************************ERCEXTD
   191                                                                  ERCEXTD
   192 01  EXTRACT-DATA-RECORD.                                         ERCEXTD
   193     12  ED-RECORD-ID                        PIC XX.              ERCEXTD
   194         88  VALID-IN-ID                           VALUE 'ED'.    ERCEXTD
   195                                                                  ERCEXTD
   196     12  ED-RECORD-TYPE                      PIC X.               ERCEXTD
   197         88  ED-PENDING-BUSINESS                   VALUE 'A'.     ERCEXTD
   198         88  ED-PENDING-CLAIMS                     VALUE 'B'.     ERCEXTD
   199         88  ED-CERT-CHANGES                       VALUE 'C'.     ERCEXTD
   200                                                                  ERCEXTD
   201     12  ED-DATA-AREAS                       PIC X(585).          ERCEXTD
   202                                                                  ERCEXTD
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   6
* ECS010P.cbl
   204 FD  CERT-MASTER-IN
*  205                             COPY ECSCRIFD.
   206******************************************************************07/10/97
   207*                                                                *ECSCRIFD
   208*                            ECSCRIFD                            *   LV001
   209*                            VMOD 2.005                          *ECSCRIFD
   210*                                                                *ECSCRIFD
   211*  NO CID MODS FOR COPYBOOK ECSCRIFD                             *ECSCRIFD
   212*                                                                *ECSCRIFD
   213******************************************************************ECSCRIFD
   214     BLOCK CONTAINS 0 RECORDS
   215     RECORDING MODE F.                                            ECSCRIFD
   216                                                                  ECSCRIFD
   217 01  CERT-IN-RECORD.                                              ECSCRIFD
   218                                                                  ECSCRIFD
   219     12  FILLER                            PIC XXX.               ECSCRIFD
   220     12  CIR-CONTROL                       PIC X(36).             ECSCRIFD
   221     12  FILLER                            PIC X(66).             ECSCRIFD
   222     12  CIR-JOINT-AGE                     PIC 99.                ECSCRIFD
   223     12  FILLER                            PIC X(20).             ECSCRIFD
   224     12  CIR-LFTYP                         PIC XX.                ECSCRIFD
   225     12  FILLER                            PIC X(14).             ECSCRIFD
   226     12  CIR-LFAMT                         PIC S9(9)V99   COMP-3. ECSCRIFD
   227     12  FILLER                            PIC X(39).             ECSCRIFD
   228     12  CIR-LFRFND-CALC                   PIC S9(7)V99   COMP-3. ECSCRIFD
   229     12  FILLER                            PIC X(45).             ECSCRIFD
   230     12  CIR-AHTYP                         PIC XX.                ECSCRIFD
   231     12  FILLER                            PIC X(35).             ECSCRIFD
   232     12  CIR-AHRFND-CALC                   PIC S9(7)V99   COMP-3. ECSCRIFD
   233     12  FILLER                            PIC X(41).             ECSCRIFD
   234     12  CIR-APR                           PIC S999V9(4)  COMP-3. ECSCRIFD
   235     12  FILLER                            PIC X(48).             ECSCRIFD
   236     12  CIR-REIN-TABLE                    PIC XXX.               ECSCRIFD
   237     12  FILLER                            PIC X(9).              ECSCRIFD
   238     12  CIR-SUM-CAN-CNT-YTD               PIC S999       COMP-3. ECSCRIFD
   239     12  FILLER                            PIC X(120).            ECSCRIFD
   240     12  CIR-DTHAMT-YTD                    PIC S9(9)V99   COMP-3. ECSCRIFD
   241     12  FILLER                            PIC X(73).             ECSCRIFD
   242     12  CIR-DISAMT-YTD                    PIC S9(9)V99   COMP-3. ECSCRIFD
   243     12  FILLER                            PIC X(464).            ECSCRIFD
   244                                                                  ECSCRIFD
   245******************************************************************ECSCRIFD
   246
   247 01  CI-RECORD.
   248     12  FILLER          PIC  X(03).
   249     12  CI-ACCOUNT-CONTROL.
   250         16  CI-CARRIER      PIC  X(01).
   251         16  CI-GROUPING     PIC  X(06).
   252         16  CI-STATE        PIC  X(02).
   253         16  CI-ACCOUNT      PIC  X(10).
   254     12  FILLER          PIC  X(06).
   255     12  CI-CERT-NO.
   256         16  CI-CERT     PIC X(10).
   257         16  CI-CERT-SFX PIC X.
   258     12  FILLER          PIC  X(1017).
   259
   260******************************************************
   261*   THIS FILE DEFINITION WAS ADDED TO ACCOMMODATE THE EXECUTION
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   7
* ECS010P.cbl
   262*   OF A "MID MONTH" BILLING REPORT (EL562) FOR
   263*   COMMERCIAL FEDERAL BANK
   264******************************************************
   265 01  CF-RECORD.
   266     12  FILLER          PIC X(759).
   267     12  CF-THIRD-AGENT  PIC X(10).
   268     12  FILLER          PIC X(7).
   269     12  CF-FOURTH-AGENT PIC X(10).
   270     12  FILLER          PIC X(270).
   271
   272******************************************************
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   8
* ECS010P.cbl
   274 FD  ERACCTT-IN.
   275
*  276                             COPY ERCACCT.
   277******************************************************************04/19/98
   278*                                                                *ERCACCT
   279*                                                                *ERCACCT
   280*                            ERCACCT                             *   LV031
   281*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL*31
   282*                            VMOD=2.031                          *ERCACCT
   283*                                                                *ERCACCT
   284*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *ERCACCT
   285*                                                                *ERCACCT
   286*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *ERCACCT
   287*   VSAM ACCOUNT MASTER FILES.                                   *ERCACCT
   288*                                                                *ERCACCT
   289*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *ERCACCT
   290*                                                                *ERCACCT
   291*   FILE TYPE = VSAM,KSDS                                        *ERCACCT
   292*   RECORD SIZE = 2000  RECFORM = FIX                            *ERCACCT
   293*                                                                *ERCACCT
   294*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *ERCACCT
   295*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *ERCACCT
   296*                                                                *ERCACCT
   297*   LOG = NO                                                     *ERCACCT
   298*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *ERCACCT
   299*                                                                *ERCACCT
   300*                                                                *ERCACCT
   301******************************************************************ERCACCT
   302*                   C H A N G E   L O G
   303*
   304* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   305*-----------------------------------------------------------------
   306*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   307* EFFECTIVE    NUMBER
   308*-----------------------------------------------------------------
   309* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
   310* 092705    2005050300006  PEMA  ADD SPP LEASES
   311* 022808    2007083100002  PEMA  ADD FREEZE STATUS
   312* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
   313* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
   314* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
   315* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
   316******************************************************************
   317                                                                  ERCACCT
   318 01  ACCOUNT-MASTER.                                              ERCACCT
   319     12  AM-RECORD-ID                      PIC XX.                ERCACCT
   320         88  VALID-AM-ID                      VALUE 'AM'.         ERCACCT
   321                                                                  ERCACCT
   322     12  AM-CONTROL-PRIMARY.                                      ERCACCT
   323         16  AM-COMPANY-CD                 PIC X.                 ERCACCT
   324         16  AM-MSTR-CNTRL.                                       ERCACCT
   325             20  AM-CONTROL-A.                                    ERCACCT
   326                 24  AM-CARRIER            PIC X.                 ERCACCT
   327                 24  AM-GROUPING.                                 ERCACCT
   328                     28 AM-GROUPING-PREFIX PIC XXX.               ERCACCT
   329                     28 AM-GROUPING-PRIME  PIC XXX.               ERCACCT
   330                 24  AM-STATE              PIC XX.                ERCACCT
   331                 24  AM-ACCOUNT.                                  ERCACCT
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   9
* ECS010P.cbl (/apps/prod/cid1p/copy/ERCACCT)
   332                     28  AM-ACCOUNT-PREFIX PIC X(4).              ERCACCT
   333                     28  AM-ACCOUNT-PRIME  PIC X(6).              ERCACCT
   334             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A            ERCACCT
   335                                           PIC X(19).             ERCACCT
   336             20  AM-CNTRL-B.                                      ERCACCT
   337                 24  AM-EXPIRATION-DT      PIC XX.                ERCACCT
   338                 24  FILLER                PIC X(4).              ERCACCT
   339             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.                 ERCACCT
   340                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.     ERCACCT
   341                                                                  ERCACCT
   342     12  AM-CONTROL-BY-VAR-GRP.                                   ERCACCT
   343         16  AM-COMPANY-CD-A1              PIC X.                 ERCACCT
   344         16  AM-VG-CARRIER                 PIC X.                 ERCACCT
   345         16  AM-VG-GROUPING                PIC X(6).              ERCACCT
   346         16  AM-VG-STATE                   PIC XX.                ERCACCT
   347         16  AM-VG-ACCOUNT                 PIC X(10).             ERCACCT
   348         16  AM-VG-DATE.                                          ERCACCT
   349             20  AM-VG-EXPIRATION-DT       PIC XX.                ERCACCT
   350             20  FILLER                    PIC X(4).              ERCACCT
   351         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE                  ERCACCT
   352                                           PIC 9(11)      COMP-3. ERCACCT
   353     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
   354         16  FILLER                        PIC X(10).
   355         16  AM-VG-KEY3.
   356             20  AM-VG3-ACCOUNT            PIC X(10).
   357             20  AM-VG3-EXP-DT             PIC XX.
   358         16  FILLER                        PIC X(4).
   359     12  AM-MAINT-INFORMATION.                                    ERCACCT
   360         16  AM-LAST-MAINT-DT              PIC XX.                ERCACCT
   361         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3. ERCACCT
   362         16  AM-LAST-MAINT-USER            PIC X(4).              ERCACCT
   363         16  FILLER                        PIC XX.                ERCACCT
   364                                                                  ERCACCT
   365     12  AM-EFFECTIVE-DT                   PIC XX.                ERCACCT
   366     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3. ERCACCT
   367                                                                  ERCACCT
   368     12  AM-PREV-DATES  COMP-3.                                   ERCACCT
   369         16  AM-PREV-EXP-DT                PIC 9(11).             ERCACCT
   370         16  AM-PREV-EFF-DT                PIC 9(11).             ERCACCT
   371                                                                  ERCACCT
   372     12  AM-REPORT-CODE-1                  PIC X(10).             ERCACCT
   373     12  AM-REPORT-CODE-2                  PIC X(10).             ERCACCT
   374                                                                  ERCACCT
   375     12  AM-CITY-CODE                      PIC X(4).              ERCACCT
   376     12  AM-COUNTY-PARISH                  PIC X(6).              ERCACCT
   377                                                                  ERCACCT
   378     12  AM-NAME                           PIC X(30).             ERCACCT
   379     12  AM-PERSON                         PIC X(30).             ERCACCT
   380     12  AM-ADDRS                          PIC X(30).             ERCACCT
   381     12  AM-CITY.
   382         16  AM-ADDR-CITY                  PIC X(28).
   383         16  AM-ADDR-STATE                 PIC XX.
   384     12  AM-ZIP.                                                  ERCACCT
   385         16  AM-ZIP-PRIME.                                        ERCACCT
   386             20  AM-ZIP-PRI-1ST            PIC X.                 ERCACCT
   387                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'. ERCACCT
   388             20  FILLER                    PIC X(4).              ERCACCT
   389         16  AM-ZIP-PLUS4                  PIC X(4).              ERCACCT
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  10
* ECS010P.cbl (/apps/prod/cid1p/copy/ERCACCT)
   390     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.              ERCACCT
   391         16  AM-CAN-POSTAL-1               PIC XXX.               ERCACCT
   392         16  AM-CAN-POSTAL-2               PIC XXX.               ERCACCT
   393         16  FILLER                        PIC XXX.               ERCACCT
   394     12  AM-TEL-NO.                                               ERCACCT
   395         16  AM-AREA-CODE                  PIC 999.               ERCACCT
   396         16  AM-TEL-PRE                    PIC 999.               ERCACCT
   397         16  AM-TEL-NBR                    PIC 9(4).              ERCACCT
   398     12  AM-TEL-LOC                        PIC X.                 ERCACCT
   399         88  AM-TEL-AT-HOME                   VALUE 'H'.          ERCACCT
   400         88  AM-TEL-AT-BUSINESS               VALUE 'B'.          ERCACCT
   401                                                                  ERCACCT
   402     12  AM-COMM-STRUCTURE.                                       ERCACCT
   403         16  AM-DEFN-1.                                           ERCACCT
   404             20  AM-AGT-COMMS       OCCURS 10 TIMES.              ERCACCT
   405                 24  AM-AGT.                                      ERCACCT
   406                     28  AM-AGT-PREFIX     PIC X(4).              ERCACCT
   407                     28  AM-AGT-PRIME      PIC X(6).              ERCACCT
   408                 24  AM-COM-TYP            PIC X.                 ERCACCT
   409                 24  AM-L-COM              PIC SV9(5)     COMP-3. ERCACCT
   410                 24  AM-J-COM              PIC SV9(5)     COMP-3. ERCACCT
   411                 24  AM-A-COM              PIC SV9(5)     COMP-3. ERCACCT
   412                 24  AM-RECALC-LV-INDIC    PIC X.                 ERCACCT
   413                 24  AM-RETRO-LV-INDIC     PIC X.                 ERCACCT
   414                 24  AM-GL-CODES           PIC X.                 ERCACCT
   415                 24  AM-COMM-CHARGEBACK    PIC 9(02).             ERCACCT
   416                 24  FILLER                PIC X(01).             ERCACCT
   417         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.                   ERCACCT
   418             20  AM-COM-TBLS        OCCURS 10 TIMES.              ERCACCT
   419                 24  FILLER                PIC X(11).             ERCACCT
   420                 24  AM-L-COMA             PIC XXX.               ERCACCT
   421                 24  AM-J-COMA             PIC XXX.               ERCACCT
   422                 24  AM-A-COMA             PIC XXX.               ERCACCT
   423                 24  FILLER                PIC X(6).              ERCACCT
   424                                                                  ERCACCT
   425     12  AM-COMM-CHANGE-STATUS             PIC X.                 ERCACCT
   426         88  AM-COMMISSIONS-CHANGED           VALUE '*'.          ERCACCT
   427                                                                  ERCACCT
   428     12  AM-CSR-CODE                       PIC X(4).              ERCACCT
   429                                                                  ERCACCT
   430     12  AM-BILLING-STATUS                 PIC X.                 ERCACCT
   431         88  AM-ACCOUNT-BILLED                VALUE 'B'.          ERCACCT
   432         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.          ERCACCT
   433     12  AM-AUTO-REFUND-SW                 PIC X.                 ERCACCT
   434         88  AUTO-REFUNDS-USED                VALUE 'Y'.          ERCACCT
   435         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.      ERCACCT
   436     12  AM-GPCD                           PIC 99.                ERCACCT
   437     12  AM-IG                             PIC X.                 ERCACCT
   438         88  AM-HAS-INDIVIDUAL                VALUE '1'.          ERCACCT
   439         88  AM-HAS-GROUP                     VALUE '2'.          ERCACCT
   440     12  AM-STATUS                         PIC X.                 ERCACCT
   441         88  AM-ACCOUNT-ACTIVE                VALUE '0'.          ERCACCT
   442         88  AM-ACCOUNT-INACTIVE              VALUE '1'.          ERCACCT
   443         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.          ERCACCT
   444         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
   445         88  AM-ACCOUNT-FROZEN                VALUE '4'.
   446         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
   447     12  AM-REMIT-TO                       PIC 99.                ERCACCT
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  11
* ECS010P.cbl (/apps/prod/cid1p/copy/ERCACCT)
   448     12  AM-ID-NO                          PIC X(11).             ERCACCT
   449                                                                  ERCACCT
   450     12  AM-CAL-TABLE                      PIC XX.                ERCACCT
   451     12  AM-LF-DEVIATION                   PIC XXX.               ERCACCT
   452     12  AM-AH-DEVIATION                   PIC XXX.               ERCACCT
   453     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3. ERCACCT
   454     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3. ERCACCT
   455     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3. ERCACCT
   456     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3. ERCACCT
   457     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3. ERCACCT
   458     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3. ERCACCT
   459                                                                  ERCACCT
   460     12  AM-USER-FIELDS.                                          ERCACCT
   461         16  AM-FLD-1                      PIC XX.                ERCACCT
   462         16  AM-FLD-2                      PIC XX.                ERCACCT
   463         16  AM-FLD-3                      PIC XX.                ERCACCT
   464         16  AM-FLD-4                      PIC XX.                ERCACCT
   465         16  AM-FLD-5                      PIC XX.                ERCACCT
   466                                                                  ERCACCT
   467     12  AM-1ST-PROD-DATE.                                        ERCACCT
   468         16  AM-1ST-PROD-YR                PIC XX.                ERCACCT
   469         16  AM-1ST-PROD-MO                PIC XX.                ERCACCT
   470         16  AM-1ST-PROD-DA                PIC XX.                ERCACCT
   471     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.     ERCACCT
   472     12  AM-CERTS-PURGED-DATE.                                    ERCACCT
   473         16  AM-PUR-YR                     PIC XX.                ERCACCT
   474         16  AM-PUR-MO                     PIC XX.                ERCACCT
   475         16  AM-PUR-DA                     PIC XX.                ERCACCT
   476     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.     ERCACCT
   477     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.     ERCACCT
   478     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.     ERCACCT
   479     12  AM-INACTIVE-DATE.                                        ERCACCT
   480         16  AM-INA-MO                     PIC 99.                ERCACCT
   481         16  AM-INA-DA                     PIC 99.                ERCACCT
   482         16  AM-INA-YR                     PIC 99.                ERCACCT
   483     12  AM-AR-HI-CERT-DATE                PIC XX.                ERCACCT
   484                                                                  ERCACCT
   485     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3. ERCACCT
   486     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3. ERCACCT
   487                                                                  ERCACCT
   488     12  AM-OB-PAYMENT-MODE                PIC X.                 ERCACCT
   489         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.      ERCACCT
   490         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.          ERCACCT
   491         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.          ERCACCT
   492         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.          ERCACCT
   493                                                                  ERCACCT
   494     12  AM-AH-ONLY-INDICATOR              PIC X.                 ERCACCT
   495         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.      ERCACCT
   496         88  AM-NO-AH-ONLY                    VALUE 'N'.          ERCACCT
   497                                                                  ERCACCT
   498     12  AM-EDIT-LOAN-OFC                  PIC X(01).             ERCACCT
   499                                                                  ERCACCT
   500     12  AM-OVER-SHORT.                                           ERCACCT
   501         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3. ERCACCT
   502         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3. ERCACCT
   503                                                                  ERCACCT
   504     12  AM-DCC-PRODUCT-CODE               PIC XXX.
   505     12  AM-DCC-CLP-STATE                  PIC XX.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  12
* ECS010P.cbl (/apps/prod/cid1p/copy/ERCACCT)
   506                                                                  ERCACCT
   507     12  AM-RECALC-COMM                    PIC X.                 ERCACCT
   508     12  AM-RECALC-REIN                    PIC X.                 ERCACCT
   509                                                                  ERCACCT
   510     12  AM-REI-TABLE                      PIC XXX.               ERCACCT
   511     12  AM-REI-ET-LF                      PIC X.                 ERCACCT
   512     12  AM-REI-ET-AH                      PIC X.                 ERCACCT
   513     12  AM-REI-PE-LF                      PIC X.                 ERCACCT
   514     12  AM-REI-PE-AH                      PIC X.                 ERCACCT
   515     12  AM-REI-PRT-ST                     PIC X.                 ERCACCT
   516     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3. ERCACCT
   517     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3. ERCACCT
   518     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3. ERCACCT
   519     12  AM-REI-GROUP-A                    PIC X(6).              ERCACCT
   520     12  AM-REI-MORT                       PIC X(4).              ERCACCT
   521     12  AM-REI-PRT-OW                     PIC X.                 ERCACCT
   522     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3. ERCACCT
   523     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3. ERCACCT
   524     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3. ERCACCT
   525     12  AM-REI-GROUP-B                    PIC X(6).              ERCACCT
   526                                                                  ERCACCT
   527     12  AM-TRUST-TYPE                     PIC X(2).              ERCACCT
   528                                                                  ERCACCT
   529     12  AM-EMPLOYER-STMT-USED             PIC X.                 ERCACCT
   530     12  AM-GROUPED-CHECKS-Y-N             PIC X.                 ERCACCT
   531                                                                  ERCACCT
   532     12  AM-STD-AH-TYPE                    PIC XX.                ERCACCT
   533     12  AM-EARN-METHODS.                                         ERCACCT
   534         16  AM-EARN-METHOD-R              PIC X.                 ERCACCT
   535             88 AM-REF-RL-R78                 VALUE 'R'.          ERCACCT
   536             88 AM-REF-RL-PR                  VALUE 'P'.          ERCACCT
   537             88 AM-REF-RL-MEAN                VALUE 'M'.          ERCACCT
   538             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.          ERCACCT
   539         16  AM-EARN-METHOD-L              PIC X.                 ERCACCT
   540             88 AM-REF-LL-R78                 VALUE 'R'.          ERCACCT
   541             88 AM-REF-LL-PR                  VALUE 'P'.          ERCACCT
   542             88 AM-REF-LL-MEAN                VALUE 'M'.          ERCACCT
   543             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.          ERCACCT
   544         16  AM-EARN-METHOD-A              PIC X.                 ERCACCT
   545             88 AM-REF-AH-R78                 VALUE 'R'.          ERCACCT
   546             88 AM-REF-AH-PR                  VALUE 'P'.          ERCACCT
   547             88 AM-REF-AH-MEAN                VALUE 'M'.          ERCACCT
   548             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.          ERCACCT
   549             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.          ERCACCT
   550             88 AM-REF-AH-NET                 VALUE 'N'.          ERCACCT
   551                                                                  ERCACCT
   552     12  AM-TOL-PREM                       PIC S999V99    COMP-3. ERCACCT
   553     12  AM-TOL-REF                        PIC S999V99    COMP-3. ERCACCT
   554     12  AM-TOL-CLM                        PIC S999V99    COMP-3. ERCACCT
   555                                                                  ERCACCT
   556     12  AM-RET-Y-N                        PIC X.                 ERCACCT
   557     12  AM-RET-P-E                        PIC X.                 ERCACCT
   558     12  AM-LF-RET                         PIC S9V9999    COMP-3. ERCACCT
   559     12  AM-AH-RET                         PIC S9V9999    COMP-3. ERCACCT
   560     12  AM-RET-GRP                        PIC X(6).              ERCACCT
   561     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.                    ERCACCT
   562         16  AM-POOL-PRIME                 PIC XXX.               ERCACCT
   563         16  AM-POOL-SUB                   PIC XXX.               ERCACCT
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  13
* ECS010P.cbl (/apps/prod/cid1p/copy/ERCACCT)
   564     12  AM-RETRO-EARNINGS.                                       ERCACCT
   565         16  AM-RET-EARN-R                 PIC X.                 ERCACCT
   566         16  AM-RET-EARN-L                 PIC X.                 ERCACCT
   567         16  AM-RET-EARN-A                 PIC X.                 ERCACCT
   568     12  AM-RET-ST-TAX-USE                 PIC X.                 ERCACCT
   569         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.  ERCACCT
   570         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.      ERCACCT
   571     12  AM-RETRO-BEG-EARNINGS.                                   ERCACCT
   572         16  AM-RET-BEG-EARN-R             PIC X.                 ERCACCT
   573         16  AM-RET-BEG-EARN-L             PIC X.                 ERCACCT
   574         16  AM-RET-BEG-EARN-A             PIC X.                 ERCACCT
   575     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3. ERCACCT
   576     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3. ERCACCT
   577                                                                  ERCACCT
   578     12  AM-USER-SELECT-OPTIONS.                                  ERCACCT
   579         16  AM-USER-SELECT-1              PIC X(10).             ERCACCT
   580         16  AM-USER-SELECT-2              PIC X(10).             ERCACCT
   581         16  AM-USER-SELECT-3              PIC X(10).             ERCACCT
   582         16  AM-USER-SELECT-4              PIC X(10).             ERCACCT
   583         16  AM-USER-SELECT-5              PIC X(10).             ERCACCT
   584                                                                  ERCACCT
   585     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3. ERCACCT
   586                                                                  ERCACCT
   587     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3. ERCACCT
   588                                                                  ERCACCT
   589     12  AM-RPT045A-SWITCH                 PIC X.                 ERCACCT
   590         88  RPT045A-OFF                   VALUE 'N'.             ERCACCT
   591                                                                  ERCACCT
   592     12  AM-INSURANCE-LIMITS.                                     ERCACCT
   593         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3. ERCACCT
   594         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3. ERCACCT
   595                                                                  ERCACCT
   596     12  AM-PROFILE-CHANGE-SWITCH          PIC X.                 ERCACCT
   597         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.          ERCACCT
   598                                                                  ERCACCT
   599     12  AM-DISMBR-COVERAGE-SW             PIC X.                 ERCACCT
   600         88  AM-DISMBR-COVERAGE               VALUE 'Y'.          ERCACCT
   601         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.          ERCACCT
   602                                                                  ERCACCT
   603     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3. ERCACCT
   604                                                                  ERCACCT
   605     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3. ERCACCT
   606     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
   607     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
   608     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
   609     12  AM-DCC-UEF-STATE                  PIC XX.
   610     12  FILLER                            PIC XXX.
   611     12  AM-REPORT-CODE-3                  PIC X(10).
   612*    12  FILLER                            PIC X(22).             ERCACCT
   613                                                                  ERCACCT
   614     12  AM-RESERVE-DATE.                                         ERCACCT
   615         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.    ERCACCT
   616         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.    ERCACCT
   617         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.    ERCACCT
   618                                                                  ERCACCT
   619     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.                ERCACCT
   620     12  AM-NOTIFICATION-TYPES.                                   ERCACCT
   621         16  AM-NOTIF-OF-LETTERS           PIC X.                 ERCACCT
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  14
* ECS010P.cbl (/apps/prod/cid1p/copy/ERCACCT)
   622         16  AM-NOTIF-OF-PAYMENTS          PIC X.                 ERCACCT
   623         16  AM-NOTIF-OF-REPORTS           PIC X.                 ERCACCT
   624         16  AM-NOTIF-OF-STATUS            PIC X.                 ERCACCT
   625                                                                  ERCACCT
   626     12  AM-BENEFIT-TABLE-USAGE            PIC X.                 ERCACCT
   627         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.          ERCACCT
   628         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.          ERCACCT
   629         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.          ERCACCT
   630         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.     ERCACCT
   631                                                                  ERCACCT
   632     12  AM-BENEFIT-CONTROLS.                                     ERCACCT
   633         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.            ERCACCT
   634             20  AM-BENEFIT-CODE           PIC XX.                ERCACCT
   635             20  AM-BENEFIT-TYPE           PIC X.                 ERCACCT
   636             20  AM-BENEFIT-REVISION       PIC XXX.               ERCACCT
   637             20  AM-BENEFIT-REM-TERM       PIC X.                 ERCACCT
   638             20  AM-BENEFIT-RETRO-Y-N      PIC X.                 ERCACCT
   639             20  FILLER                    PIC XX.                ERCACCT
   640         16  FILLER                        PIC X(80).             ERCACCT
   641                                                                  ERCACCT
   642     12  AM-TRANSFER-DATA.                                        ERCACCT
   643         16  AM-TRANSFERRED-FROM.                                 ERCACCT
   644             20  AM-TRNFROM-CARRIER        PIC X.                 ERCACCT
   645             20  AM-TRNFROM-GROUPING.                             ERCACCT
   646                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.               ERCACCT
   647                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.               ERCACCT
   648             20  AM-TRNFROM-STATE          PIC XX.                ERCACCT
   649             20  AM-TRNFROM-ACCOUNT.                              ERCACCT
   650                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).             ERCACCT
   651                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).              ERCACCT
   652             20  AM-TRNFROM-DTE            PIC XX.                ERCACCT
   653         16  AM-TRANSFERRED-TO.                                   ERCACCT
   654             20  AM-TRNTO-CARRIER          PIC X.                 ERCACCT
   655             20  AM-TRNTO-GROUPING.                               ERCACCT
   656                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.               ERCACCT
   657                 24  AM-TRNTO-GRP-PRIME    PIC XXX.               ERCACCT
   658             20  AM-TRNTO-STATE            PIC XX.                ERCACCT
   659             20  AM-TRNTO-ACCOUNT.                                ERCACCT
   660                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).              ERCACCT
   661                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).              ERCACCT
   662             20  AM-TRNTO-DTE              PIC XX.                ERCACCT
   663         16  FILLER                        PIC X(10).             ERCACCT
   664                                                                  ERCACCT
   665     12  AM-SAVED-REMIT-TO                 PIC 99.                ERCACCT
   666                                                                  ERCACCT
   667     12  AM-COMM-STRUCTURE-SAVED.                                 ERCACCT
   668         16  AM-DEFN-1-SAVED.                                     ERCACCT
   669             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.           ERCACCT
   670                 24  AM-AGT-SV             PIC X(10).             ERCACCT
   671                 24  AM-COM-TYP-SV         PIC X.                 ERCACCT
   672                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3. ERCACCT
   673                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3. ERCACCT
   674                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3. ERCACCT
   675                 24  AM-RECALC-LV-INDIC-SV PIC X.                 ERCACCT
   676                 24  FILLER                PIC X.                 ERCACCT
   677                 24  AM-GL-CODES-SV        PIC X.                 ERCACCT
   678                 24  AM-COM-CHARGEBACK-SV  PIC 99.                ERCACCT
   679                 24  FILLER                PIC X.                 ERCACCT
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  15
* ECS010P.cbl (/apps/prod/cid1p/copy/ERCACCT)
   680         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.       ERCACCT
   681             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.            ERCACCT
   682                 24  FILLER                PIC X(11).             ERCACCT
   683                 24  AM-L-COMA-SV          PIC XXX.               ERCACCT
   684                 24  AM-J-COMA-SV          PIC XXX.               ERCACCT
   685                 24  AM-A-COMA-SV          PIC XXX.               ERCACCT
   686                 24  FILLER                PIC X(6).              ERCACCT
   687                                                                  ERCACCT
   688     12  AM-FLC-NET-PREMIUM-ALLOWANCE.                            ERCACCT
   689         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.                 ERCACCT
   690            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3. ERCACCT
   691            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3. ERCACCT
   692            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3. ERCACCT
   693                                                                  ERCACCT
   694     12  AM-ORIG-DEALER-NO                 PIC X(10).             ERCACCT
   695     12  FILLER                            PIC X(120).            ERCACCT
   696                                                                  ERCACCT
   697     12  AM-ACCOUNT-EXECUTIVE-DATA.                               ERCACCT
   698         16  AM-CONTROL-NAME               PIC X(30).             ERCACCT
   699         16  AM-EXECUTIVE-ONE.                                    ERCACCT
   700             20  AM-EXEC1-NAME             PIC X(15).             ERCACCT
   701             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)       ERCACCT
   702                                                          COMP-3. ERCACCT
   703             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)       ERCACCT
   704                                                          COMP-3. ERCACCT
   705         16  AM-EXECUTIVE-TWO.                                    ERCACCT
   706             20  AM-EXEC2-NAME             PIC X(15).             ERCACCT
   707             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)       ERCACCT
   708                                                          COMP-3. ERCACCT
   709             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)       ERCACCT
   710                                                          COMP-3. ERCACCT
   711                                                                  ERCACCT
   712     12  AM-RETRO-ADDITIONAL-DATA.                                ERCACCT
   713         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3. ERCACCT
   714         16  AM-RETRO-PREM-P-E             PIC X.                 ERCACCT
   715         16  AM-RETRO-CLMS-P-I             PIC X.                 ERCACCT
   716         16  AM-RETRO-RET-BRACKET-LF.                             ERCACCT
   717             20  AM-RETRO-RET-METHOD-LF    PIC X.                 ERCACCT
   718                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.      ERCACCT
   719                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.          ERCACCT
   720             20  AM-RETRO-RET-BASIS-LF     PIC X.                 ERCACCT
   721                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.      ERCACCT
   722                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.          ERCACCT
   723             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.           ERCACCT
   724                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3. ERCACCT
   725                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3. ERCACCT
   726         16  AM-RETRO-RET-BRACKET-AH.                             ERCACCT
   727             20  AM-RETRO-RET-METHOD-AH    PIC X.                 ERCACCT
   728                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.      ERCACCT
   729                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.          ERCACCT
   730                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.          ERCACCT
   731             20  AM-RETRO-RET-BASIS-AH     PIC X.                 ERCACCT
   732                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.      ERCACCT
   733                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.          ERCACCT
   734             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.           ERCACCT
   735                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3. ERCACCT
   736                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3. ERCACCT
   737                                                                  ERCACCT
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  16
* ECS010P.cbl (/apps/prod/cid1p/copy/ERCACCT)
   738     12  AM-COMMENTS.                                             ERCACCT
   739         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.ERCACCT
   740                                                                  ERCACCT
   741     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.         ERCACCT
   742         16  AM-FLI-RETRO-SHARE-CODE       PIC X.                 ERCACCT
   743         16  AM-FLI-BILLING-CODE           PIC X.                 ERCACCT
   744         16  AM-FLI-ALT-STATE-CODE         PIC XX.                ERCACCT
   745         16  AM-FLI-UNITED-IDENT           PIC X.                 ERCACCT
   746         16  AM-FLI-INTEREST-LOST-DATA.                           ERCACCT
   747             20  AM-FLI-BANK-NO            PIC X(5).              ERCACCT
   748             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3. ERCACCT
   749             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3. ERCACCT
   750             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3. ERCACCT
   751         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.            ERCACCT
   752             20  AM-FLI-AGT                PIC X(9).              ERCACCT
   753             20  AM-FLI-AGT-COMM-ACC       PIC X.                 ERCACCT
   754             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3. ERCACCT
   755         16  FILLER                        PIC X(102).            ERCACCT
   756                                                                  ERCACCT
   757     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.         ERCACCT
   758         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.          ERCACCT
   759             20  AM-BENEFIT-DMD-CODE         PIC XX.              ERCACCT
   760             20  AM-BENEFIT-DMD-TYPE         PIC X.               ERCACCT
   761             20  AM-BENEFIT-DMD-REVISION     PIC XXX.             ERCACCT
   762             20  AM-BENEFIT-DMD-REM-TERM     PIC X.               ERCACCT
   763             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.               ERCACCT
   764         16  FILLER                          PIC X(10).           ERCACCT
   765******************************************************************ERCACCT
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  17
* ECS010P.cbl
   767 FD  ERRTBL-IN.
   768
*  769                             COPY ERCREIN.
   770******************************************************************07/27/93
   771*                                                                *ERCREIN
   772*                            ERCREIN                             *   LV009
   773*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   774*                            VMOD=2.010                          *   CL**9
   775*                                                                *ERCREIN
   776*   ONLINE CREDIT SYSTEM                                         *ERCREIN
   777*                                                                *ERCREIN
   778*   FILE DESCRIPTION = REINSURANCE MASTER FILE                   *ERCREIN
   779*                                                                *ERCREIN
   780*   FILE TYPE = VSAM,KSDS                                        *ERCREIN
   781*   RECORD SIZE = 4000  RECFORM = FIXED                          *ERCREIN
   782*                                                                *ERCREIN
   783*   BASE CLUSTER NAME = ERREIN                   RKP=2,LEN=8     *ERCREIN
   784*       ALTERNATE PATH = NONE                                    *ERCREIN
   785*                                                                *ERCREIN
   786*   LOG = NO                                                     *ERCREIN
   787*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *ERCREIN
   788*                                                                *ERCREIN
   789******************************************************************ERCREIN
   790*                   C H A N G E   L O G
   791*
   792* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   793*-----------------------------------------------------------------
   794*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   795* EFFECTIVE    NUMBER
   796*-----------------------------------------------------------------
   797* 103101    2001100100006  SMVA  ADD STATE EXHIBIT REPORT OPTION F
   798* 032707    2007032100006  PEMA  ADD EXCISE TAX CAPABILITY
   799******************************************************************
   800 01  REINSURANCE-RECORD.                                          ERCREIN
   801     12  RE-RECORD-ID                      PIC XX.                ERCREIN
   802         88  VALID-RE-ID                      VALUE 'RE'.         ERCREIN
   803                                                                  ERCREIN
   804     12  RE-CONTROL-PRIMARY.                                      ERCREIN
   805         16  RE-COMPANY-CD                 PIC X.                 ERCREIN
   806         16  RE-KEY.                                              ERCREIN
   807             20  RE-CODE                   PIC X.                 ERCREIN
   808                 88  RE-TABLE-RECORD          VALUE 'A'.          ERCREIN
   809                 88  RE-COMPANY-RECORD        VALUE 'B'.          ERCREIN
   810             20  RE-TABLE                  PIC XXX.               ERCREIN
   811             20  FILLER                    PIC XXX.               ERCREIN
   812         16  RE-COMPANY-KEY REDEFINES RE-KEY.                     ERCREIN
   813             20  FILLER                    PIC X.                 ERCREIN
   814             20  RE-COMPANY.                                      ERCREIN
   815                 24  RE-COMP-PRIME         PIC XXX.               ERCREIN
   816                 24  RE-COMP-SUB           PIC XXX.               ERCREIN
   817                                                                  ERCREIN
   818     12  RE-MAINT-INFORMATION.                                    ERCREIN
   819         16  RE-LAST-MAINT-DT              PIC XX.                ERCREIN
   820         16  RE-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3. ERCREIN
   821         16  RE-LAST-MAINT-USER            PIC X(4).              ERCREIN
   822         16  FILLER                        PIC X(10).             ERCREIN
   823                                                                  ERCREIN
   824     12  RE-TABLE-DATA.                                           ERCREIN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  18
* ECS010P.cbl (/apps/prod/cid1p/copy/ERCREIN)
   825         16  RE-100-COMP                   PIC 99.                ERCREIN
   826                                                                  ERCREIN
   827         16  RE-COMP-INFO    OCCURS 30 TIMES.                     ERCREIN
   828             20  RE-REI-COMP-NO.                                  ERCREIN
   829                 24  RE-REI-COMP           PIC XXX.               ERCREIN
   830                 24  RE-REI-COMP-SUB       PIC XXX.               ERCREIN
   831             20  RE-LF-QC                  PIC X.                 ERCREIN
   832             20  RE-AH-QC                  PIC X.                 ERCREIN
   833             20  RE-LO-DATE                PIC 9(11)     COMP-3.  ERCREIN
   834             20  RE-HI-DATE                PIC 9(11)     COMP-3.  ERCREIN
   835             20  RE-LFAGE-LO               PIC 99.                ERCREIN
   836             20  RE-LFAGE-HI               PIC 99.                ERCREIN
   837             20  RE-AHAGE-LO               PIC 99.                ERCREIN
   838             20  RE-AHAGE-HI               PIC 99.                ERCREIN
   839             20  RE-LFTRM-LO               PIC S999       COMP-3. ERCREIN
   840             20  RE-LFTRM-HI               PIC S999       COMP-3. ERCREIN
   841             20  RE-AHTRM-LO               PIC S999       COMP-3. ERCREIN
   842             20  RE-AHTRM-HI               PIC S999       COMP-3. ERCREIN
   843             20  RE-LF-PCT                 PIC S9V9999    COMP-3. ERCREIN
   844             20  RE-AH-PCT                 PIC S9V9999    COMP-3. ERCREIN
   845             20  RE-LF-LIM-LO              PIC S9(9)V99   COMP-3. ERCREIN
   846             20  RE-LF-LIM-HI              PIC S9(9)V99   COMP-3. ERCREIN
   847             20  RE-LF-LO                  PIC S9(9)V99   COMP-3. ERCREIN
   848             20  RE-LF-HI                  PIC S9(9)V99   COMP-3. ERCREIN
   849             20  RE-AHBEN-LIM-LO           PIC S9(7)V99   COMP-3. ERCREIN
   850             20  RE-AHBEN-LIM-HI           PIC S9(7)V99   COMP-3. ERCREIN
   851             20  RE-AHBEN-LO               PIC S9(7)V99   COMP-3. ERCREIN
   852             20  RE-AHBEN-HI               PIC S9(7)V99   COMP-3. ERCREIN
   853             20  RE-AHMOA-LIM-LO           PIC S9(7)V99   COMP-3. ERCREIN
   854             20  RE-AHMOA-LIM-HI           PIC S9(7)V99   COMP-3. ERCREIN
   855             20  RE-AHMOA-LO               PIC S9(7)V99   COMP-3. ERCREIN
   856             20  RE-AHMOA-HI               PIC S9(7)V99   COMP-3. ERCREIN
   857             20  RE-LF-BEN-CODE            PIC X.                 ERCREIN
   858             20  RE-AH-BEN-CODE            PIC X.                 ERCREIN
   859             20  RE-INTERACTIVE            PIC X.                 ERCREIN
   860             20  RE-REMAINING              PIC X.                 ERCREIN
   861             20  RE-LF-RUNOFF-SW           PIC X.                      000
   862             20  RE-AH-RUNOFF-SW           PIC X.                      000
   863             20  FILLER                    PIC X(19).                  000
   864                                                                  ERCREIN
   865         16  RE-COMP-INFO-END              PIC X(6).              ERCREIN
   866         16  RE-NSP-ST-CD-LF               PIC XX.                ERCREIN
   867         16  RE-NSP-ST-CD-AH               PIC XX.                ERCREIN
   868         16  RE-TABLE-CARRIER-SECURITY     PIC X.                 ERCREIN
   869             88  NO-TABLE-CARRIER-SECURITY    VALUE SPACE.        ERCREIN
   870                                                                  ERCREIN
   871         16  FILLER                        PIC X(27).             ERCREIN
   872                                                                  ERCREIN
   873     12  RE-COMPANY-DATA   REDEFINES   RE-TABLE-DATA.             ERCREIN
   874         16  RE-NAME                       PIC X(30).             ERCREIN
   875         16  RE-LF-PE                      PIC X.                 ERCREIN
   876         16  RE-AH-PE                      PIC X.                 ERCREIN
   877         16  RE-LF-FEE                     PIC S9V9999    COMP-3. ERCREIN
   878         16  RE-AH-FEE                     PIC S9V9999    COMP-3. ERCREIN
   879         16  RE-AH-PR-PCT                  PIC S9V9999    COMP-3. ERCREIN
   880         16  RE-AH-78-PCT                  PIC S9V9999    COMP-3. ERCREIN
   881         16  RE-PRT-ST                     PIC X.                 ERCREIN
   882         16  RE-PRT-OW                     PIC X.                 ERCREIN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  19
* ECS010P.cbl (/apps/prod/cid1p/copy/ERCREIN)
   883         16  RE-MORT-CODE                  PIC X(4).              ERCREIN
   884         16  RE-CLAIM-CODE                 PIC X.                 ERCREIN
   885         16  RE-ZERO-LF-FEE                PIC X.                 ERCREIN
   886         16  RE-ZERO-AH-FEE                PIC X.                 ERCREIN
   887         16  RE-CEDE-NAME                  PIC X(30).             ERCREIN
   888         16  RE-LF-COMM                    PIC X.                 ERCREIN
   889         16  RE-AH-COMM                    PIC X.                 ERCREIN
   890         16  RE-LF-TAX                     PIC X.                 ERCREIN
   891         16  RE-AH-TAX                     PIC X.                 ERCREIN
   892         16  RE-CLM-INCURRED-LIM           PIC 9(11)  COMP-3.     ERCREIN
   893         16  RE-LF-IBNR-PCT                PIC SV999      COMP-3. ERCREIN
   894         16  RE-AH-IBNR-PCT                PIC SV999      COMP-3. ERCREIN
   895                                                                  ERCREIN
   896         16  RE-COMP-CARRIER-SECURITY      PIC X.                 ERCREIN
   897             88  NO-COMP-CARRIER-SECURITY     VALUE SPACE.        ERCREIN
   898                                                                  ERCREIN
   899         16  RE-LF-CEDING-FEE-BRACKETS.                           ERCREIN
   900             20  RE-LF-FEE-METHOD          PIC X.                 ERCREIN
   901                 88  RE-LF-FEE-BRACKETED         VALUE '1' '2'.   ERCREIN
   902                 88  RE-LF-FEE-METHOD-1          VALUE '1'.       ERCREIN
   903                 88  RE-LF-FEE-METHOD-2          VALUE '2'.       ERCREIN
   904                 88  RE-LF-FEE-PERCENT           VALUE ' ' 'P'.   ERCREIN
   905             20  RE-LF-FEE-BASIS           PIC X.                 ERCREIN
   906                 88  RE-LF-GROSS-CEDED             VALUE '1'.     ERCREIN
   907                 88  RE-LF-NET-CEDED               VALUE '2'.     ERCREIN
   908                 88  RE-LF-GROSS-WRITTEN           VALUE '3'.     ERCREIN
   909                 88  RE-LF-NET-WRITTEN             VALUE '4'.     ERCREIN
   910                 88  RE-LF-COMBINE-GROSS-CEDED     VALUE '5'.     ERCREIN
   911                 88  RE-LF-COMBINE-NET-CEDED       VALUE '6'.     ERCREIN
   912                 88  RE-LF-COMBINE-GROSS-WRITTEN   VALUE '7'.     ERCREIN
   913                 88  RE-LF-COMBINE-NET-WRITTEN     VALUE '8'.     ERCREIN
   914             20  FILLER                    PIC XXX.               ERCREIN
   915             20  RE-LF-FEE-RANGES  OCCURS 6 TIMES.                ERCREIN
   916                 24  RE-LF-FEE-RANGE-PCT   PIC S9V9999    COMP-3. ERCREIN
   917                 24  RE-LF-FEE-THRU-AMT    PIC S9(7)V99   COMP-3. ERCREIN
   918                                                                  ERCREIN
   919         16  RE-AH-CEDING-FEE-BRACKETS.                           ERCREIN
   920             20  RE-AH-FEE-METHOD          PIC X.                 ERCREIN
   921                 88  RE-AH-FEE-BRACKETED         VALUE '1' '2'.   ERCREIN
   922                 88  RE-AH-FEE-METHOD-1          VALUE '1'.       ERCREIN
   923                 88  RE-AH-FEE-METHOD-2          VALUE '2'.       ERCREIN
   924                 88  RE-AH-FEE-PERCENT           VALUE ' ' 'P'.   ERCREIN
   925             20  RE-AH-FEE-BASIS           PIC X.                 ERCREIN
   926                 88  RE-AH-GROSS-CEDED             VALUE '1'.     ERCREIN
   927                 88  RE-AH-NET-CEDED               VALUE '2'.     ERCREIN
   928                 88  RE-AH-GROSS-WRITTEN           VALUE '3'.     ERCREIN
   929                 88  RE-AH-NET-WRITTEN             VALUE '4'.     ERCREIN
   930                 88  RE-AH-COMBINE-GROSS-CEDED     VALUE '5'.     ERCREIN
   931                 88  RE-AH-COMBINE-NET-CEDED       VALUE '6'.     ERCREIN
   932                 88  RE-AH-COMBINE-GROSS-WRITTEN   VALUE '7'.     ERCREIN
   933                 88  RE-AH-COMBINE-NET-WRITTEN     VALUE '8'.     ERCREIN
   934             20  FILLER                    PIC XXX.               ERCREIN
   935             20  RE-AH-FEE-RANGES  OCCURS 6 TIMES.                ERCREIN
   936                 24  RE-AH-FEE-RANGE-PCT   PIC S9V9999    COMP-3. ERCREIN
   937                 24  RE-AH-FEE-THRU-AMT    PIC S9(7)V99   COMP-3. ERCREIN
   938                                                                  ERCREIN
   939         16  RE-EARNING-START-DT           PIC 9(11)  COMP-3.     ERCREIN
   940                                                                  ERCREIN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  20
* ECS010P.cbl (/apps/prod/cid1p/copy/ERCREIN)
   941         16  RE-OLD-CEDING-STMT            PIC X.                    CL**4
   942                                                                  ERCREIN
   943         16  RE-LF-CLM-PCT                 PIC S9V9999    COMP-3. ERCREIN
   944         16  RE-AH-CLM-PCT                 PIC S9V9999    COMP-3. ERCREIN
   945         16  RE-LF-CLM-MAX                 PIC S9(7)V99   COMP-3. ERCREIN
   946         16  RE-AH-CLM-MAX                 PIC S9(7)V99   COMP-3. ERCREIN
   947         16  RE-LF-PR-PCT                  PIC S9V9999    COMP-3. ERCREIN
   948         16  RE-LF-78-PCT                  PIC S9V9999    COMP-3. ERCREIN
   949         16  RE-REINS-GROUPING-CODE        PIC X(6).              ERCREIN
   950         16  RE-MORT-SW                    PIC X.                 ERCREIN
   951         16  RE-CEDING-TYPE-FLAG           PIC X.                    CL**2
   952             88  RE-NO-CESSION-TYPE                VALUE ' '.        CL**2
   953             88  RE-CEDED                          VALUE 'C'.        CL**2
   954             88  RE-ASSUMED                        VALUE 'A'.        CL**2
   955             88  RE-PHANTOM                        VALUE 'P'.        CL**2
   956                                                                  ERCREIN
   957         16  RE-CEDING-STMT-OPT-A          PIC X.                    CL**3
   958             88  REPORT-A-WANTED    VALUE ' ' 'Y'.                   CL**3
   959         16  RE-CEDING-STMT-OPT-B          PIC X.                    CL**3
   960             88  REPORT-B-WANTED    VALUE ' ' 'Y'.                   CL**3
   961         16  RE-CEDING-STMT-OPT-C          PIC X.                    CL**3
   962             88  REPORT-C-WANTED    VALUE ' ' 'Y'.                   CL**3
   963         16  RE-CEDING-STMT-OPT-D          PIC X.                    CL**3
   964             88  REPORT-D-WANTED    VALUE ' ' 'Y'.                   CL**3
   965         16  RE-CEDING-STMT-OPT-E          PIC X.                    CL**3
   966             88  REPORT-E-WANTED    VALUE ' ' 'Y'.                   CL**3
   967                                                                     CL**3
   968         16  RE-PRT-CRSV                   PIC X.                    CL**5
   969                                                                     CL**5
   970         16  RE-GL-CENTER                  PIC X(4).                 CL**6
   971                                                                     CL**8
   972         16  RE-CUSTODIAL-BAL              PIC S9(7)V99   COMP-3.    CL**8
   973                                                                     CL**8
   974         16  RE-EARNING-STOP-DT            PIC 9(11)  COMP-3.        CL**9
   975                                                                     CL**9
   976         16  RE-EARN-STOP-CODE             PIC X.                    CL**9
   977             88  STOP-LIFE-EARNING  VALUE 'L' 'B'.                   CL**9
   978             88  STOP-AH-EARNING    VALUE 'A' 'B'.                   CL**9
   979
   980         16  RE-STATE-EXHIBIT-OPT-F        PIC X.
   981             88  RPTF-ECS152-WANTED VALUE ' ' 'Y'.
   982                                                                     CL**9
   983         16  RE-EXCISE-TAX                 PIC S9V9999 COMP-3.
   984         16  FILLER                        PIC X(2281).              CL**9
   985                                                                  ERCREIN
   986         16  RE-DESC OCCURS 18 TIMES       PIC X(79).             ERCREIN
   987                                                                  ERCREIN
   988******************************************************************ERCREIN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  21
* ECS010P.cbl
   990 FD  ERCTBL.
   991
*  992                             COPY ERCCTBL.
   993******************************************************************04/29/98
   994*                                                                *ERCCTBL
   995*                                                                *ERCCTBL
   996*                            ERCCTBL                             *   LV002
   997*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
   998*                            VMOD=2.003                              CL**2
   999*                                                                *ERCCTBL
  1000*   ONLINE CREDIT SYSTEM                                         *ERCCTBL
  1001*                                                                *ERCCTBL
  1002*   FILE DESCRIPTION = COMPENSATION TABLE                        *ERCCTBL
  1003*                                                                *ERCCTBL
  1004*   FILE TYPE = VSAM,KSDS                                        *ERCCTBL
  1005*   RECORD SIZE = 200   RECFORM = FIXED                          *ERCCTBL
  1006*                                                                *ERCCTBL
  1007*   BASE CLUSTER NAME = ERCTBL                   RKP=2,LEN=7     *ERCCTBL
  1008*       ALTERNATE PATH = NONE                                    *ERCCTBL
  1009*                                                                *ERCCTBL
  1010*   LOG = NO                                                     *ERCCTBL
  1011*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *ERCCTBL
  1012*                                                                *ERCCTBL
  1013*                                                                *ERCCTBL
  1014******************************************************************ERCCTBL
  1015                                                                  ERCCTBL
  1016 01  COMM-TABLE-RECORD.                                           ERCCTBL
  1017     12  CT-RECORD-ID                      PIC XX.                ERCCTBL
  1018         88  VALID-CT-ID                      VALUE 'CT'.         ERCCTBL
  1019                                                                  ERCCTBL
  1020     12  CT-CONTROL-PRIMARY.                                      ERCCTBL
  1021         16  CT-COMPANY-CD                 PIC X.                 ERCCTBL
  1022         16  CT-TABLE                      PIC XXX.               ERCCTBL
  1023         16  CT-CNTRL-2.                                          ERCCTBL
  1024             20  CT-BEN-TYPE               PIC X.                 ERCCTBL
  1025             20  CT-BEN-CODE               PIC XX.                ERCCTBL
  1026                                                                  ERCCTBL
  1027     12  CT-MAINT-INFORMATION.                                    ERCCTBL
  1028         16  CT-LAST-MAINT-DT              PIC XX.                ERCCTBL
  1029         16  CT-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3. ERCCTBL
  1030         16  CT-LAST-MAINT-USER            PIC X(4).              ERCCTBL
  1031         16  FILLER                        PIC X(31).             ERCCTBL
  1032                                                                  ERCCTBL
  1033     12  CT-LIMITS.                                               ERCCTBL
  1034         16  CT-TBF OCCURS 3 TIMES         PIC S9(7)V99   COMP-3. ERCCTBL
  1035                                                                  ERCCTBL
  1036         16  CT-AGE OCCURS 3 TIMES         PIC S99        COMP-3. ERCCTBL
  1037                                                                  ERCCTBL
  1038         16  CT-TRM OCCURS 3 TIMES         PIC S999       COMP-3. ERCCTBL
  1039                                                                  ERCCTBL
  1040     12  CT-RATES.                                                ERCCTBL
  1041         16  CT-RTX          OCCURS 27 TIMES.                     ERCCTBL
  1042             20  CT-RT                     PIC SV9(5)     COMP-3. ERCCTBL
  1043             20  CT-RT-R   REDEFINES                              ERCCTBL
  1044                 CT-RT                     PIC XXX.               ERCCTBL
  1045                                                                  ERCCTBL
  1046     12  FILLER                            PIC  X(42).            ERCCTBL
  1047                                                                  ERCCTBL
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  22
* ECS010P.cbl
  1048******************************************************************ERCCTBL
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  23
* ECS010P.cbl
  1050 FD  ERMEBL-INOUT.
  1051
* 1052                             COPY ERCMEBL.
  1053******************************************************************
  1054*
  1055*
  1056*                            ERCMEBL                             *
  1057*                                                                *
  1058*    FILE DESCRIPTION = REPOSITORY FOR MONTH-END BALANCES FROM   *
  1059*                       SEVERAL PROGRAMS (IDENTIFIED IN BYTES    *
  1060*                       4-6 OF THE FIELD NAMES) AND BY EL541     *
  1061*                       FOR REPORTING DISCREPANCIES AND RUN TIME.*
  1062*                                                                *
  1063*    FILE TYPE = VSAM, KSDS                                      *
  1064*    RECORD SIZE = 765       RECFORM = FIXED                     *
  1065*                                                                *
  1066*    BASE CLUSTER = ERMEBL         KEY SIZE  =  5                *
  1067*    ALTERNATE PATHS = NONE        STARTING IN  3                *
  1068*                                                                *
  1069******************************************************************
  1070
  1071******************************************************************
  1072*                   C H A N G E   L O G
  1073*
  1074* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1075*-----------------------------------------------------------------
  1076*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1077* EFFECTIVE    NUMBER
  1078*-----------------------------------------------------------------
  1079* 070714  CR2013060600001  PEMA  AUTOMATE EOM BALANCING
  1080******************************************************************
  1081 01  MONTH-END-BALANCES.
  1082     12  ME-RECORD-ID            PIC  XX.
  1083     12  ME-CONTROL-PRIMARY.
  1084         16  ME-COMPANY          PIC  XXX.
  1085         16  ME-MOYR             PIC  9999       COMP.
  1086     12  ME-010-PREM-L           PIC S9(9)V99    COMP-3.
  1087     12  ME-010-PREM-AH          PIC S9(9)V99    COMP-3.
  1088     12  ME-010-REF-L            PIC S9(9)V99    COMP-3.
  1089     12  ME-010-REF-AH           PIC S9(9)V99    COMP-3.
  1090     12  ME-010-NET-L            PIC S9(9)V99    COMP-3.
  1091     12  ME-010-NET-AH           PIC S9(9)V99    COMP-3.
  1092     12  ME-010-COMM-L           PIC S9(9)V99    COMP-3.
  1093     12  ME-010-COMM-AH          PIC S9(9)V99    COMP-3.
  1094     12  ME-010-PMT-L            PIC S9(9)V99    COMP-3.
  1095     12  ME-010-PMT-AH           PIC S9(9)V99    COMP-3.
  1096     12  ME-010-CERT-IN          PIC S9(7)       COMP-3.
  1097     12  ME-010-CERT-OUT         PIC S9(7)       COMP-3.
  1098     12  ME-010-DUP-ISS          PIC S9(7)       COMP-3.
  1099     12  ME-010-RUN-DT           PIC  9(6)       COMP-3.
  1100*    12  ME-010-START            PIC  9(6)       COMP-3.
  1101*    12  ME-010-END              PIC  9(6)       COMP-3.
  1102     12  ME-010-RUN-CT           PIC S9(3)       COMP-3.
  1103     12  ME-018-COMM-Y           PIC S9(9)V99    COMP-3.
  1104     12  ME-018-COMM-1           PIC S9(9)V99    COMP-3.
  1105     12  ME-018-OW-Y             PIC S9(9)V99    COMP-3.
  1106     12  ME-018-OW-1             PIC S9(9)V99    COMP-3.
  1107     12  ME-018-RUN-DT           PIC  9(6)       COMP-3.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  24
* ECS010P.cbl (/apps/prod/cid1p/copy/ERCMEBL)
  1108*    12  ME-018-START            PIC  9(6)       COMP-3.
  1109*    12  ME-018-END              PIC  9(6)       COMP-3.
  1110     12  ME-018-RUN-CT           PIC S9(3)       COMP-3.
  1111     12  ME-019-PREM-L           PIC S9(9)V99    COMP-3.
  1112     12  ME-019-PREM-AH          PIC S9(9)V99    COMP-3.
  1113     12  ME-019-REF-L            PIC S9(9)V99    COMP-3.
  1114     12  ME-019-REF-AH           PIC S9(9)V99    COMP-3.
  1115     12  ME-019-COMM-L           PIC S9(9)V99    COMP-3.
  1116     12  ME-019-COMM-AH          PIC S9(9)V99    COMP-3.
  1117     12  ME-019-OR-L             PIC S9(9)V99    COMP-3.
  1118     12  ME-019-OR-AH            PIC S9(9)V99    COMP-3.
  1119     12  ME-019-RUN-DT           PIC  9(6)       COMP-3.
  1120*    12  ME-019-START            PIC  9(6)       COMP-3.
  1121*    12  ME-019-END              PIC  9(6)       COMP-3.
  1122     12  ME-019-RUN-CT           PIC S9(3)       COMP-3.
  1123     12  ME-030-CLMS-L           PIC S9(9)V99    COMP-3.
  1124     12  ME-030-CLMS-AH          PIC S9(9)V99    COMP-3.
  1125     12  ME-030-RUN-DT           PIC  9(6)       COMP-3.
  1126*    12  ME-030-START            PIC  9(6)       COMP-3.
  1127*    12  ME-030-END              PIC  9(6)       COMP-3.
  1128     12  ME-030-RUN-CT           PIC S9(3)       COMP-3.
  1129     12  ME-032-RESV-L           PIC S9(9)V99    COMP-3.
  1130     12  ME-032-RESV-AH          PIC S9(9)V99    COMP-3.
  1131     12  ME-032-RUN-DT           PIC  9(6)       COMP-3.
  1132*    12  ME-032-START            PIC  9(6)       COMP-3.
  1133*    12  ME-032-END              PIC  9(6)       COMP-3.
  1134     12  ME-032-RUN-CT           PIC S9(3)       COMP-3.
  1135     12  ME-035-NET-L            PIC S9(9)V99    COMP-3.
  1136     12  ME-035-NET-AH           PIC S9(9)V99    COMP-3.
  1137     12  ME-035-RUN-DT           PIC S9(6)       COMP-3.
  1138*    12  ME-035-START            PIC S9(6)       COMP-3.
  1139*    12  ME-035-END              PIC S9(6)       COMP-3.
  1140     12  ME-035-RUN-CT           PIC S9(3)       COMP-3.
  1141     12  ME-038-RECS-IN          PIC S9(7)       COMP-3.
  1142     12  ME-038-RECS-OUT         PIC S9(7)       COMP-3.
  1143     12  ME-038-RUN-DT           PIC  9(6)       COMP-3.
  1144*    12  ME-038-START            PIC  9(6)       COMP-3.
  1145*    12  ME-038-END              PIC  9(6)       COMP-3.
  1146     12  ME-038-RUN-CT           PIC S9(3)       COMP-3.
  1147     12  ME-041-RETROS           PIC S9(9)V99    COMP-3.
  1148     12  ME-041-RUN-DT           PIC  9(6)       COMP-3.
  1149*    12  ME-041-START            PIC  9(6)       COMP-3.
  1150*    12  ME-041-END              PIC  9(6)       COMP-3.
  1151     12  ME-041-RUN-CT           PIC S9(3)       COMP-3.
  1152     12  ME-050-CERT-IN          PIC S9(7)       COMP-3.
  1153     12  ME-050-CERT-OUT         PIC S9(7)       COMP-3.
  1154*    12  ME-050-START            PIC  9(6)       COMP-3.
  1155     12  ME-050-RUN-DT           PIC  9(6)       COMP-3.
  1156*    12  ME-050-END              PIC  9(6)       COMP-3.
  1157     12  ME-050-RUN-CT           PIC S9(3)       COMP-3.
  1158     12  ME-061-PREM             PIC S9(9)V99    COMP-3.
  1159     12  ME-061-COMM             PIC S9(9)V99    COMP-3.
  1160     12  ME-061-OR               PIC S9(9)V99    COMP-3.
  1161     12  ME-061-PY-ADJ           PIC S9(9)V99    COMP-3.
  1162     12  ME-061-COMM-RCALC       PIC S9(9)V99    COMP-3.
  1163     12  ME-061-OR-RCALC         PIC S9(9)V99    COMP-3.
  1164     12  ME-061-PREM-RCALC       PIC S9(9)V99    COMP-3.
  1165     12  ME-061-RUN-DT           PIC  9(6)       COMP-3.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  25
* ECS010P.cbl (/apps/prod/cid1p/copy/ERCMEBL)
  1166*    12  ME-061-START            PIC  9(6)       COMP-3.
  1167*    12  ME-061-END              PIC  9(6)       COMP-3.
  1168     12  ME-061-RUN-CT           PIC S9(3)       COMP-3.
  1169     12  ME-080-MORT-ERRS        PIC  9(7)       COMP-3.
  1170     12  ME-080-RUN-DT           PIC  9(6)       COMP-3.
  1171*    12  ME-080-START            PIC  9(6)       COMP-3.
  1172*    12  ME-080-END              PIC  9(6)       COMP-3.
  1173     12  ME-080-RUN-CT           PIC S9(3)       COMP-3.
  1174     12  ME-315-RESV-L           PIC S9(9)V99    COMP-3.
  1175     12  ME-315-RESV-AH          PIC S9(9)V99    COMP-3.
  1176     12  ME-315-RUN-DT           PIC  9(6)       COMP-3.
  1177*    12  ME-315-START            PIC  9(6)       COMP-3.
  1178*    12  ME-315-END              PIC  9(6)       COMP-3.
  1179     12  ME-315-RUN-CT           PIC S9(3)       COMP-3.
  1180     12  ME-331-FLAG             PIC  9.
  1181     12  ME-331-RUN-DT           PIC  9(6)       COMP-3.
  1182*    12  ME-331-START            PIC  9(6)       COMP-3.
  1183*    12  ME-331-END              PIC  9(6)       COMP-3.
  1184     12  ME-331-RUN-CT           PIC S9(3)       COMP-3.
  1185     12  ME-341-NOT-FOUND        PIC S9(7)       COMP-3.
  1186     12  ME-341-RUN-DT           PIC  9(6)       COMP-3.
  1187*    12  ME-341-START            PIC  9(6)       COMP-3.
  1188*    12  ME-341-END              PIC  9(6)       COMP-3.
  1189     12  ME-341-RUN-CT           PIC S9(3)       COMP-3.
  1190     12  ME-501-FLAG             PIC  9.
  1191     12  ME-501-RUN-DT           PIC  9(6)       COMP-3.
  1192     12  ME-501-START            PIC  9(6)       COMP-3.
  1193     12  ME-501-END              PIC  9(6)       COMP-3.
  1194     12  ME-501-RUN-CT           PIC S9(3)       COMP-3.
  1195     12  ME-509-FLAG             PIC  9.
  1196     12  ME-509-RUN-DT           PIC  9(6)       COMP-3.
  1197     12  ME-509-START            PIC  9(6)       COMP-3.
  1198     12  ME-509-END              PIC  9(6)       COMP-3.
  1199     12  ME-509-RUN-CT           PIC S9(3)       COMP-3.
  1200     12  ME-522-PY-ADJ           PIC S9(9)V99    COMP-3.
  1201     12  ME-522-RETROS           PIC S9(9)V99    COMP-3.
  1202     12  ME-522-PROC-CLM-L       PIC S9(9)V99    COMP-3.
  1203     12  ME-522-PROC-CLM-AH      PIC S9(9)V99    COMP-3.
  1204     12  ME-522-ALL-CLM-L        PIC S9(9)V99    COMP-3.
  1205     12  ME-522-ALL-CLM-AH       PIC S9(9)V99    COMP-3.
  1206     12  ME-522-PROC-RSV-L       PIC S9(9)V99    COMP-3.
  1207     12  ME-522-PROC-RSV-AH      PIC S9(9)V99    COMP-3.
  1208     12  ME-522-ALL-RSV-L        PIC S9(9)V99    COMP-3.
  1209     12  ME-522-ALL-RSV-AH       PIC S9(9)V99    COMP-3.
  1210     12  ME-522-PREM-L           PIC S9(9)V99    COMP-3.
  1211     12  ME-522-PREM-AH          PIC S9(9)V99    COMP-3.
  1212     12  ME-522-REF-L            PIC S9(9)V99    COMP-3.
  1213     12  ME-522-REF-AH           PIC S9(9)V99    COMP-3.
  1214     12  ME-522-RUN-DT           PIC  9(6)       COMP-3.
  1215     12  ME-522-START            PIC  9(6)       COMP-3.
  1216     12  ME-522-END              PIC  9(6)       COMP-3.
  1217     12  ME-522-RUN-CT           PIC S9(3)       COMP-3.
  1218     12  ME-524-CLMS-L           PIC S9(9)V99    COMP-3.
  1219     12  ME-524-CLMS-AH          PIC S9(9)V99    COMP-3.
  1220     12  ME-524-RESV-L           PIC S9(9)V99    COMP-3.
  1221     12  ME-524-RESV-AH          PIC S9(9)V99    COMP-3.
  1222     12  ME-524-RUN-DT           PIC  9(6)       COMP-3.
  1223     12  ME-524-START            PIC  9(6)       COMP-3.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  26
* ECS010P.cbl (/apps/prod/cid1p/copy/ERCMEBL)
  1224     12  ME-524-END              PIC  9(6)       COMP-3.
  1225     12  ME-524-RUN-CT           PIC S9(3)       COMP-3.
  1226     12  ME-525-FLAG             PIC  9.
  1227     12  ME-525-RUN-DT           PIC  9(6)       COMP-3.
  1228     12  ME-525-START            PIC  9(6)       COMP-3.
  1229     12  ME-525-END              PIC  9(6)       COMP-3.
  1230     12  ME-525-RUN-CT           PIC S9(3)       COMP-3.
  1231     12  ME-048-RECS-IN          PIC S9(7)       COMP-3.
  1232     12  ME-048-RECS-OUT         PIC S9(7)       COMP-3.
  1233     12  ME-048-RUN-DT           PIC  9(6)       COMP-3.
  1234     12  ME-048-START            PIC  9(6)       COMP-3.
  1235     12  ME-048-END              PIC  9(6)       COMP-3.
  1236     12  ME-048-RUN-CT           PIC S9(3)       COMP-3.
  1237     12  ME-041-REIN-ADJ         PIC S9(9)V99    COMP-3.
  1238
  1239     12  ME-019-CLMS-L           PIC S9(9)V99    COMP-3.
  1240     12  ME-019-CLMS-AH          PIC S9(9)V99    COMP-3.
  1241     12  ME-035-COMM-TOT         PIC S9(9)V99    COMP-3.
  1242     12  ME-035-CLMS-L           PIC S9(9)V99    COMP-3.
  1243     12  ME-035-CLMS-AH          PIC S9(9)V99    COMP-3.
  1244     12  ME-041-RECS-IN          PIC S9(9)       COMP-3.
  1245     12  ME-041-RECS-OUT         PIC S9(9)       COMP-3.
  1246     12  ME-050-ACT-L            PIC S9(7)       COMP-3.
  1247     12  ME-050-ACT-AH           PIC S9(7)       COMP-3.
  1248     12  ME-061-CLMS             PIC S9(9)V99    COMP-3.
  1249     12  ME-341-CLMS-L           PIC S9(9)V99    COMP-3.
  1250     12  ME-341-CLMS-AH          PIC S9(9)V99    COMP-3.
  1251     12  ME-515-CLMS-WRAP        PIC S9(7)V99    COMP-3.
  1252     12  ME-515-RESV-WRAP        PIC S9(7)V99    COMP-3.
  1253     12  ME-317-CLMS-TOT         PIC S9(9)V99    comp-3.
  1254     12  ME-325-CLMS-TOT         PIC S9(9)V99    comp-3.
  1255     12  ME-020-PREM-TOT         PIC S9(11)V99   COMP-3.
  1256     12  ME-020-CLMS-TOT         PIC S9(9)V99    COMP-3.
  1257     12  ME-020-RESV-TOT         PIC S9(9)V99    COMP-3.
  1258     12  ME-063-OW               PIC S9(9)V99    COMP-3.
  1259     12  ME-082-ACT-L            PIC S9(7)       COMP-3.
  1260     12  ME-082-ACT-AH           PIC S9(7)       COMP-3.
  1261     12  ME-016-RECS-IN          PIC S9(9)       COMP-3.
  1262     12  ME-016-RECS-OUT         PIC S9(9)       COMP-3.
  1263     12  ME-562-PREM-TOT         PIC S9(9)V99    COMP-3.
  1264     12  ME-562-COMM-TOT         PIC S9(9)V99    COMP-3.
  1265     12  ME-524-CLMS-TOT-CM      PIC S9(9)V99    comp-3.
  1266     12  ME-523-PREM-TOT         PIC S9(9)V99    COMP-3.
  1267     12  ME-064-BEG-BAL          PIC S9(9)V99    COMP-3.
  1268     12  ME-064-END-BAL          PIC S9(9)V99    COMP-3.
  1269     12  ME-010-MM-PREM-TOT      PIC S9(9)V99    COMP-3.
  1270     12  ME-010-MM-TOT-CLMS      PIC S9(9)V99    COMP-3.
  1271     12  ME-010-MM-TOT-RESV      PIC S9(9)V99    COMP-3.
  1272     12  ME-080-MORT-RESV        PIC S9(9)V99    COMP-3.
  1273
  1274     12  FILLER                  PIC  X(09).
  1275*    12  FILLER                  PIC  X(88).
  1276******************************************************************
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  27
* ECS010P.cbl
  1278 FD  CERT-MASTER-OUT
* 1279                             COPY ECSCROFD.
  1280******************************************************************07/10/97
  1281*                                                                *ECSCROFD
  1282*                            ECSCROFD                            *   LV001
  1283*                            VMOD=2.002                          *ECSCROFD
  1284*                                                                *ECSCROFD
  1285*  NO CID MODS IN COPYBOOK ECSCROFD.                             *ECSCROFD
  1286*                                                                *ECSCROFD
  1287******************************************************************ECSCROFD
  1288     RECORDING MODE F                                             ECSCROFD
  1289     LABEL RECORDS STANDARD                                       ECSCROFD
  1290     BLOCK CONTAINS 0 RECORDS
  1291     RECORD CONTAINS 1056 CHARACTERS.                             ECSCROFD
  1292 01  CERT-OUT-RECORD.                                             ECSCROFD
  1293     12  FILLER                            PIC  XXX.              ECSCROFD
  1294     12  COR-CONTROL                       PIC  X(36).            ECSCROFD
  1295     12  FILLER                            PIC  X(1017).          ECSCROFD
  1296                                                                  ECSCROFD
  1297******************************************************************ECSCROFD
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  28
* ECS010P.cbl
  1299 FD  DETAIL-EXTR
  1300     BLOCK CONTAINS 0 RECORDS
  1301     RECORDING MODE F.
  1302
* 1303                             COPY ECSEXT01.
  1304******************************************************************04/29/98
  1305*                                                                *ECSEXT01
  1306*                            ECSEXT01                            *   LV015
  1307*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL*15
  1308*                            VMOD=2.015                          *ECSEXT01
  1309*                                                                *ECSEXT01
  1310*   FILE DESCRIPTION =  DETAIL EXTRACTS                          *ECSEXT01
  1311*                       (PREMIUM, COMM., CLAIMS, AND RESERVES)   *ECSEXT01
  1312*                                                                *ECSEXT01
  1313*   FILE TYPE = SEQUENTIAL                                       *ECSEXT01
  1314*   RECORD SIZE = 510  RECFORM = FIXED                           *ECSEXT01
  1315*                                                                *ECSEXT01
  1316*   KEY DATA =                                   START=5, LEN=36 *ECSEXT01
  1317*                                                                *ECSEXT01
  1318******************************************************************ECSEXT01
  1319******************************************************************
  1320*                   C H A N G E   L O G
  1321*
  1322* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1323*-----------------------------------------------------------------
  1324*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1325* EFFECTIVE    NUMBER
  1326*-----------------------------------------------------------------
  1327* 040504    2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  1328* 042110  CR2010010400006  PEMA  ADD FIELDS FOR EMERALD 032
  1329* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  1330* 071211  CR2010012700001  PEMA  ADD SPP DEALER DIRECT
  1331* 112911  CR2011083000003  PEMA  ADD SPPDDF TRUNCATED
  1332* 032612  CR2011110200001  PEMA  AHL CHANGES
  1333******************************************************************
  1334                                                                  ECSEXT01
  1335 01  DETAIL-EXTRACT.                                              ECSEXT01
  1336     02 DETAIL-FILE.                                              ECSEXT01
  1337     12  DE-RECORD-ID                      PIC XX.                ECSEXT01
  1338         88  VALID-DE-ID                      VALUE 'DE'.         ECSEXT01
  1339                                                                  ECSEXT01
  1340     12  DE-COMPANY-CD                     PIC X.                 ECSEXT01
  1341                                                                  ECSEXT01
  1342     12  DE-REIN                           PIC X.                 ECSEXT01
  1343                                                                  ECSEXT01
  1344     12  DE-CONTROL.                                              ECSEXT01
  1345         16  DE-CNTRL1.                                           ECSEXT01
  1346             20  DE-CARRIER                PIC X.                 ECSEXT01
  1347             20  DE-GROUPING.                                     ECSEXT01
  1348                 24  DE-GROUP-PREFIX       PIC XXX.               ECSEXT01
  1349                 24  DE-GROUP-PRIME        PIC XXX.               ECSEXT01
  1350             20  DE-STATE                  PIC XX.                ECSEXT01
  1351             20  DE-ACCOUNT.                                      ECSEXT01
  1352                 24  DE-ACCT-PREFIX        PIC X(4).              ECSEXT01
  1353                 24  DE-ACCT-PRIME         PIC X(6).              ECSEXT01
  1354         16  DE-CNTRL2.                                           ECSEXT01
  1355             20  DE-EFF                    PIC 9(11)  COMP-3.     ECSEXT01
  1356             20  DE-CERT.                                         ECSEXT01
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  29
* ECS010P.cbl (/apps/prod/cid1p/copy/ECSEXT01)
  1357                 24 DE-CERT-NO.                                   ECSEXT01
  1358                     28  DE-CRT-PREFIX     PIC XXX.               ECSEXT01
  1359                     28  DE-CRT-PRIME      PIC X(7).              ECSEXT01
  1360                 24  DE-CRT-SUF            PIC X.                 ECSEXT01
  1361                                                                  ECSEXT01
  1362     12  DE-TRANS                          PIC X.                 ECSEXT01
  1363         88  DE-ISSUE                         VALUE 'I'.          ECSEXT01
  1364         88  DE-RC-ISSUE                      VALUE '8'.          ECSEXT01
  1365         88  DE-CANCEL                        VALUE 'C'.          ECSEXT01
  1366         88  DE-RC-CANCEL                     VALUE '7'.          ECSEXT01
  1367         88  DE-CLAIM                         VALUE 'X'.          ECSEXT01
  1368         88  DE-RESTORE                       VALUE 'R'.          ECSEXT01
  1369         88  DE-RESERVE                       VALUE 'Y'.          ECSEXT01
  1370         88  DE-RR-RC-ISS                     VALUE 'J'.          ECSEXT01
  1371         88  DE-RR-RC-CNC                     VALUE 'K'.          ECSEXT01
  1372         88  DE-RR-RC-CLM                     VALUE 'L'.          ECSEXT01
  1373                                                                  ECSEXT01
  1374     12  DE-REPORT-CODE-1                  PIC X(10).             ECSEXT01
  1375     12  DE-REPORT-CODE-2                  PIC X(10).             ECSEXT01
  1376                                                                  ECSEXT01
  1377     12  DE-NAME.                                                 ECSEXT01
  1378         16  DE-LNAME                      PIC X(15).             ECSEXT01
  1379         16  DE-FNAME.                                            ECSEXT01
  1380             20  DE-1ST-INIT-FNAME         PIC X.                 ECSEXT01
  1381             20  FILLER                    PIC X(9).              ECSEXT01
  1382         16  DE-INIT                       PIC X.                 ECSEXT01
  1383     12  DE-AGE                            PIC 99.                ECSEXT01
  1384     12  DE-SEX                            PIC X.                 ECSEXT01
  1385     12  DE-SOC-SEC-NO                     PIC X(11).             ECSEXT01
  1386                                                                  ECSEXT01
  1387     12  DE-LF-TYPE                        PIC XX.                ECSEXT01
  1388     12  DE-LF-TERM                        PIC 999        COMP-3. ECSEXT01
  1389     12  DE-LF-BEN                         PIC S9(9)V99   COMP-3. ECSEXT01
  1390     12  DE-LF-CNBEN                       PIC S9(9)V99   COMP-3. ECSEXT01
  1391     12  DE-LF-PRM                         PIC S9(7)V99   COMP-3. ECSEXT01
  1392     12  DE-LF-BEN-ALT                     PIC S9(9)V99   COMP-3. ECSEXT01
  1393     12  DE-LF-CNBEN-ALT                   PIC S9(9)V99   COMP-3. ECSEXT01
  1394     12  DE-LF-PRM-ALT                     PIC S9(7)V99   COMP-3. ECSEXT01
  1395     12  DE-LF-RFND                        PIC S9(7)V99   COMP-3. ECSEXT01
  1396                                                                  ECSEXT01
  1397     12  DE-LF-STAT-CDE                    PIC X.                 ECSEXT01
  1398     12  DE-LF-PREV-STAT                   PIC X.                 ECSEXT01
  1399     12  DE-LF-CANC-DTE                    PIC 9(11)      COMP-3. ECSEXT01
  1400     12  DE-LF-CANC-EXIT-DT                PIC 9(11)      COMP-3. ECSEXT01
  1401                                                                  ECSEXT01
  1402     12  DE-AH-TYPE                        PIC XX.                ECSEXT01
  1403     12  DE-AH-TERM                        PIC 999        COMP-3. ECSEXT01
  1404     12  DE-AH-BEN                         PIC S9(7)V99   COMP-3. ECSEXT01
  1405     12  DE-AH-PRM                         PIC S9(7)V99   COMP-3. ECSEXT01
  1406     12  DE-AH-RFND                        PIC S9(7)V99   COMP-3. ECSEXT01
  1407                                                                  ECSEXT01
  1408     12  DE-AH-STAT-CDE                    PIC X.                 ECSEXT01
  1409     12  DE-AH-PREV-STAT                   PIC X.                 ECSEXT01
  1410     12  DE-AH-CANC-DTE                    PIC 9(11)  COMP-3.     ECSEXT01
  1411     12  DE-AH-CANC-EXIT-DT                PIC 9(11)  COMP-3.     ECSEXT01
  1412                                                                  ECSEXT01
  1413     12  DE-LIVES                          PIC S9(7)      COMP-3. ECSEXT01
  1414     12  DE-ADDL-CLP REDEFINES DE-LIVES
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  30
* ECS010P.cbl (/apps/prod/cid1p/copy/ECSEXT01)
  1415                                           PIC S9(5)V99   COMP-3.
  1416     12  DE-NUM-BILLED                     PIC S9(7)      COMP-3. ECSEXT01
  1417     12  FILLER REDEFINES DE-NUM-BILLED.
  1418         16  DE-CLP-STATE                  PIC XX.
  1419         16  DE-DCC-DDF-REM-TRM3           PIC S999       COMP-3.
  1420     12  DE-CANCEL-CNT-ITD                 PIC S999       COMP-3. ECSEXT01
  1421     12  DE-CANCEL-CNT-YTD                 PIC S999       COMP-3. ECSEXT01
  1422                                                                  ECSEXT01
  1423     12  DE-APR                            PIC S999V9(4)  COMP-3. ECSEXT01
  1424     12  DE-PMT-FREQ                       PIC 99.                ECSEXT01
  1425     12  DE-ACC-GPCD                       PIC XX.                ECSEXT01
  1426     12  DE-IG                             PIC X.                 ECSEXT01
  1427     12  DE-REMIT-TO                       PIC XX.                ECSEXT01
  1428*    12  DE-MEMBER-NO                      PIC X(12).             ECSEXT01
  1429     12  DE-MEMBER-NO.                                            ECSEXT01
  1430         16  DE-MASTER-POLICY              PIC X(06).             ECSEXT01
  1431         16  DE-ZIP                        PIC 9(05)    COMP-3.   ECSEXT01
  1432         16  FILLER                        PIC X(03).             ECSEXT01
  1433     12  DE-LN-OFFICER                     PIC XXX.               ECSEXT01
  1434                                                                  ECSEXT01
  1435     12  DE-AUTO-GEND-IND                  PIC X.                 ECSEXT01
  1436         88  DE-AUTO-GEND-REINS            VALUE 'R'.             ECSEXT01
  1437                                                                  ECSEXT01
  1438     12  DE-ENTRY-STATUS                   PIC X.                 ECSEXT01
  1439     12  DE-ENTRY-DTE                      PIC 9(11)      COMP-3. ECSEXT01
  1440                                                                  ECSEXT01
  1441     12  DE-REI-AREA.                                             ECSEXT01
  1442         16  DE-REI-COMP.                                         ECSEXT01
  1443             20  DE-REINCO                 PIC XXX.               ECSEXT01
  1444             20  DE-REINCO-SUB             PIC XXX.               ECSEXT01
  1445         16  DE-REI-LFAMT                  PIC S9(9)V99   COMP-3. ECSEXT01
  1446         16  DE-REI-LFPRM                  PIC S9(7)V99   COMP-3. ECSEXT01
  1447         16  DE-REI-LFRFND                 PIC S9(7)V99   COMP-3. ECSEXT01
  1448         16  DE-REI-AHAMT                  PIC S9(7)V99   COMP-3. ECSEXT01
  1449         16  DE-REI-AHPRM                  PIC S9(7)V99   COMP-3. ECSEXT01
  1450         16  DE-REI-AHRFND                 PIC S9(7)V99   COMP-3. ECSEXT01
  1451         16  DE-REI-CNAMT                  PIC S9(9)V99   COMP-3. ECSEXT01
  1452                                                                  ECSEXT01
  1453     12  DE-MOB-NET-TOT-FEES               PIC S9(7)V99   COMP-3.
  1454     12  FILLER REDEFINES DE-MOB-NET-TOT-FEES.
  1455         16  DE-IU-RATE-UP                 PIC S9(5)V99 COMP-3.
  1456         16  F                             PIC X.
  1457*    12  FILLER                            PIC X(5).              ECSEXT01
  1458                                                                  ECSEXT01
  1459     12  DE-BILLED-AREA.                                          ECSEXT01
  1460         16  DE-GL-INTERFACE-CODES.                               ECSEXT01
  1461             20  DE-GL-CODES               PIC X  OCCURS 10 TIMES.ECSEXT01
  1462                                                                  ECSEXT01
  1463         16  DE-BILL-SW                    PIC X.                 ECSEXT01
  1464             88  DE-RECORD-ON-HOLD            VALUE 'H'.          ECSEXT01
  1465             88  DE-RECORD-RETURNED           VALUE 'R'.          ECSEXT01
  1466             88  DE-RECORD-ENDORSED           VALUE 'E'.          ECSEXT01
  1467             88  DE-OVERRIDE-LIFE             VALUE 'L'.          ECSEXT01
  1468             88  DE-OVERRIDE-AH               VALUE 'A'.          ECSEXT01
  1469             88  DE-OVERRIDE-BOTH             VALUE 'B'.          ECSEXT01
  1470                                                                  ECSEXT01
  1471         16  DE-REFUND-SW                  PIC X.                 ECSEXT01
  1472             88  DE-REFUND-CREATED            VALUE 'Y'.          ECSEXT01
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  31
* ECS010P.cbl (/apps/prod/cid1p/copy/ECSEXT01)
  1473                                                                  ECSEXT01
  1474         16  DE-BILLED-LFPRM               PIC S9(7)V99   COMP-3. ECSEXT01
  1475         16  DE-BILLED-LFRFND              PIC S9(7)V99   COMP-3. ECSEXT01
  1476         16  DE-BILLED-AHPRM               PIC S9(7)V99   COMP-3. ECSEXT01
  1477         16  DE-BILLED-AHRFND              PIC S9(7)V99   COMP-3. ECSEXT01
  1478                                                                  ECSEXT01
  1479         16  DE-GA-BILL-STATUS             PIC X  OCCURS 5 TIMES. ECSEXT01
  1480*            88  DE-NO-PRE-BILL-GA            VALUE ' '.          ECSEXT01
  1481*            88  DE-BILLED-GA                 VALUE 'B'.          ECSEXT01
  1482                                                                  ECSEXT01
  1483     12  DE-BILL-STATUS                    PIC X.                 ECSEXT01
  1484         88  DE-NO-PRE-BILL                   VALUE ' '.          ECSEXT01
  1485         88  DE-BILLED                        VALUE 'B'.          ECSEXT01
  1486         88  DE-REVERSE                       VALUE 'R'.          ECSEXT01
  1487                                                                  ECSEXT01
  1488     12  DE-REVERSE-REASONS.                                      ECSEXT01
  1489         16  DE-REVERSE-REASON-1           PIC X.                 ECSEXT01
  1490         16  DE-REVERSE-REASON-2           PIC X.                 ECSEXT01
  1491     12  DE-CANCEL-REASON                  PIC X.
  1492                                                                  ECSEXT01
  1493     12  DE-RECALC-CODE                    PIC X.                 ECSEXT01
  1494     12  DE-RECALC-TYPE                    PIC X.                 ECSEXT01
  1495                                                                  ECSEXT01
  1496     12  DE-CHARGEBACK-CODES.                                     ECSEXT01
  1497         16  DE-LF-COMM-CHARGEBACK         PIC X.                 ECSEXT01
  1498             88  DE-NO-LF-CHARGEBACK          VALUE 'N'.          ECSEXT01
  1499         16  DE-AH-COMM-CHARGEBACK         PIC X.                 ECSEXT01
  1500             88  DE-NO-AH-CHARGEBACK          VALUE 'N'.          ECSEXT01
  1501                                                                  ECSEXT01
  1502     12  DE-UNDERWRITING-CODE              PIC X.                 ECSEXT01
  1503         88  DE-POLICY-UNDERWRITTEN           VALUE 'Y'.          ECSEXT01
  1504                                                                  ECSEXT01
  1505     12  DE-NCL-POOL-CODE                  PIC XXX.               ECSEXT01
  1506     12  FILLER REDEFINES DE-NCL-POOL-CODE.
  1507         16  DE-LOAN-TERM                  PIC S999 COMP-3.
  1508         16  FILLER                        PIC X.
  1509                                                                  ECSEXT01
  1510****************************************************************  ECSEXT01
  1511**** CLAIM EXTRACT AND RESERVE EXTRACT IS REDEFINED AT THIS POINT ECSEXT01
  1512****************************************************************  ECSEXT01
  1513     12  DE-COMM-LEVELS.                                          ECSEXT01
  1514         16  DE-AGT-LEVELS     OCCURS  10  TIMES.                 ECSEXT01
  1515             20  DE-AGT.                                          ECSEXT01
  1516                 24  DE-AGT-PREFIX         PIC X(4).              ECSEXT01
  1517                 24  DE-AGT-PRIME          PIC X(6).              ECSEXT01
  1518             20  DE-AGT-TYPE               PIC X.                 ECSEXT01
  1519             20  DE-L-PC                   PIC SV9(5)     COMP-3. ECSEXT01
  1520             20  DE-A-PC                   PIC SV9(5)     COMP-3. ECSEXT01
  1521                                                                  ECSEXT01
  1522     12  DE-PROC-DT                        PIC 9(11)      COMP-3. ECSEXT01
  1523****************************************************************  ECSEXT01
  1524*******                 CLAIM EXTRACT                      *****  ECSEXT01
  1525****************************************************************  ECSEXT01
  1526     02 DE-CLAIM-EXTRACT     REDEFINES     DETAIL-FILE.           ECSEXT01
  1527     12  FILLER                            PIC X(334).            ECSEXT01
  1528     12  DE-TYPE                           PIC X.                 ECSEXT01
  1529         88  DE-DTH                           VALUE '1'.          ECSEXT01
  1530         88  DE-AH                            VALUE '2'.          ECSEXT01
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  32
* ECS010P.cbl (/apps/prod/cid1p/copy/ECSEXT01)
  1531         88  DE-OB-DTH                        VALUE '3'.          ECSEXT01
  1532         88  DE-OB-AH                         VALUE '4'.          ECSEXT01
  1533         88  DE-DEATH                         VALUES '1' '3'.     ECSEXT01
  1534         88  DE-DISABILITY                    VALUES '2' '4'.     ECSEXT01
  1535                                                                  ECSEXT01
  1536     12  DE-CLAIM-AMT                      PIC S9(9)V99   COMP-3. ECSEXT01
  1537     12  DE-REI-CLAIM-AMT                  PIC S9(9)V99   COMP-3. ECSEXT01
  1538                                                                  ECSEXT01
  1539     12  DE-INCUR                          PIC 9(11)      COMP-3. ECSEXT01
  1540     12  DE-REPORTED.                                             ECSEXT01
  1541         16  DE-RPT-YR                     PIC 99.                ECSEXT01
  1542         16  DE-RPT-MO                     PIC 99.                ECSEXT01
  1543         16  DE-RPT-DA                     PIC 99.                ECSEXT01
  1544     12  DE-PAY                            PIC 9(11)      COMP-3. ECSEXT01
  1545     12  DE-PAID-TO                        PIC 9(11)      COMP-3. ECSEXT01
  1546                                                                  ECSEXT01
  1547     12  DE-CNUM                           PIC X(7).              ECSEXT01
  1548     12  DE-CHECK                          PIC X(7).              ECSEXT01
  1549     12  DE-PMT-TRAILER-SEQ                PIC S9(4)       COMP.  ECSEXT01
  1550     12  DE-DAYS-DISAB                     PIC 999.               ECSEXT01
  1551     12  DE-CLM-AGE                        PIC 99.                ECSEXT01
  1552     12  DE-PAY-CODE                       PIC X.                 ECSEXT01
  1553         88  DE-PARTIAL-PAYMENT               VALUE 'P'.          ECSEXT01
  1554         88  DE-FINAL-PAYMENT                 VALUE 'F'.          ECSEXT01
  1555         88  DE-LUMP-SUM-PAYMENT              VALUE 'S'.          ECSEXT01
  1556         88  DE-ADDITIONAL-PAYMENT            VALUE 'X'.          ECSEXT01
  1557         88  DE-CHARGEABLE-EXPENSE            VALUE 'E'.          ECSEXT01
  1558         88  DE-NON-CHARGEABLE-EXPENSE        VALUE 'E'.          ECSEXT01
  1559         88  DE-VOIDED-PAYMENT                VALUE 'V'.          ECSEXT01
  1560                                                                  ECSEXT01
  1561     12  DE-CLM-ERR                        PIC XX.                ECSEXT01
  1562                                                                  ECSEXT01
  1563     12  DE-ACC-NAME                       PIC X(30).             ECSEXT01
  1564     12  DE-ACC-EXP-DTE                    PIC 9(11)  COMP-3.     ECSEXT01
  1565     12  DE-ACC-EFF-DTE                    PIC 9(11)  COMP-3.     ECSEXT01
  1566     12  FILLER                            PIC XX.                ECSEXT01
  1567     12  DE-LOAN-OFFICER                   PIC XXX.               ECSEXT01
  1568                                                                  ECSEXT01
  1569     12  DE-LOAN-TYPE                      PIC X(02).             ECSEXT01
  1570     12  DE-BENEFICIARY                    PIC X(10).
  1571     12  filler redefines de-beneficiary.
  1572         16  de-birth-date                 pic 9(11)  comp-3.
  1573         16  f                             pic x(4).
  1574     12  DE-LOAN-CLASS                     PIC X(02).             ECSEXT01
  1575     12  DE-LOSS-CODE                      PIC X(06).             ECSEXT01
  1576     12  DE-ASSOCIATES                     PIC X(01).             ECSEXT01
  1577     12  DE-LEGAL-STATE                    PIC X(02).             ECSEXT01
  1578     12  DE-CLM-CAUSE                      PIC X(6).              ECSEXT01
  1579     12  DE-CLM-CLASS                      PIC XX.
  1580     12  DE-CLM-DEV                        PIC XXX.
  1581     12  DE-XYCOR-CLAIM-NO                 PIC X(9).
  1582     12  de-xycor-cert-seq                 pic x(3).
  1583     12  DE-XYCOR-CHECK-NO                 PIC X(8).
  1584     12  DE-XYCOR-ACTION-CD                PIC XXX.
  1585     12  DE-XYCOR-STATUS                   PIC X.
  1586     12  FILLER                            PIC X(4).              ECSEXT01
  1587                                                                  ECSEXT01
  1588     12  DE-CLM-PROC-DT                    PIC 9(11)  COMP-3.        CL**2
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  33
* ECS010P.cbl (/apps/prod/cid1p/copy/ECSEXT01)
  1589                                                                  ECSEXT01
  1590****************************************************************  ECSEXT01
  1591*******               RESERVE EXTRACT                      *****  ECSEXT01
  1592****************************************************************  ECSEXT01
  1593     02 DE-RESERVE-EXTRACT     REDEFINES     DETAIL-FILE.         ECSEXT01
  1594     12  FILLER                            PIC X(334).            ECSEXT01
  1595                                                                  ECSEXT01
  1596     12  DE-RESERVE-TYPE                   PIC X.                 ECSEXT01
  1597         88  DE-LIFE-RSV                      VALUE '1' '3'.      ECSEXT01
  1598         88  DE-AH-RSV                        VALUE '2' '4'.      ECSEXT01
  1599                                                                  ECSEXT01
  1600     12  DE-IBNR                           PIC S9(7)V99   COMP-3. ECSEXT01
  1601     12  DE-PAYCUR                         PIC S9(7)V99   COMP-3. ECSEXT01
  1602     12  DE-FUTRSV                         PIC S9(7)V99   COMP-3. ECSEXT01
  1603                                                                  ECSEXT01
  1604     12  DE-CLMNO                          PIC X(7).              ECSEXT01
  1605                                                                  ECSEXT01
  1606     12  DE-RSV-INCUR                      PIC 9(11)      COMP-3. ECSEXT01
  1607     12  DE-RSV-REPORTED.                                         ECSEXT01
  1608         16  DE-RSV-RPT-YR                 PIC 99.                ECSEXT01
  1609         16  DE-RSV-RPT-MO                 PIC 99.                ECSEXT01
  1610         16  DE-RSV-RPT-DA                 PIC 99.                ECSEXT01
  1611     12  DE-RSV-PAYTO                      PIC 9(11)      COMP-3. ECSEXT01
  1612                                                                  ECSEXT01
  1613     12  DE-REI-IBNR                       PIC S9(7)V99   COMP-3. ECSEXT01
  1614     12  DE-REI-PAYCUR                     PIC S9(7)V99   COMP-3. ECSEXT01
  1615     12  DE-REI-FUTRSV                     PIC S9(7)V99   COMP-3. ECSEXT01
  1616                                                                  ECSEXT01
  1617     12  DE-RSV-ACC-NAME                   PIC X(30).             ECSEXT01
  1618     12  DE-ACC-EXP-DTE-RSV                PIC 9(11)      COMP-3. ECSEXT01
  1619     12  DE-ACC-EFF-DTE-RSV                PIC 9(11)      COMP-3. ECSEXT01
  1620                                                                  ECSEXT01
  1621     12  DE-MANUAL-RSV-SWITCH              PIC X.                 ECSEXT01
  1622                                                                  ECSEXT01
  1623     12  DE-RATE-CLASS                     PIC XX.
  1624     12  DE-DEV-CODE                       PIC XXX.
  1625     12  DE-RSV-REM-TERM                   PIC S999       COMP-3.
  1626     12  DE-RSV-REM-BENEFIT                PIC S9(9)V99   COMP-3.
  1627     12  FILLER                            PIC X(58).             ECSEXT01
  1628                                                                  ECSEXT01
  1629     12  DE-RSV-PROC-DT                    PIC 9(11)  COMP-3.        CL**2
  1630******************************************************************ECSEXT01
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  34
* ECS010P.cbl
  1632 FD  SUMMARY-EXTR
  1633     BLOCK CONTAINS 0 RECORDS
  1634     RECORDING MODE F.
  1635
* 1636                             COPY ECSEPC01.
  1637******************************************************************
  1638*                                                                *
  1639*                            ECSEPC01                            *
  1640*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1641*                            VMOD=2.008                          *
  1642*                                                                *
  1643*   FILE DESCRIPTION =  EARNED PREM / EARNED COMM  (E.P.E.C.)    *
  1644*                                                                *
  1645*   FILE TYPE = SEQUENTIAL                                       *
  1646*   RECORD SIZE = 325  RECFORM = FIXED                           *
  1647*                                                                *
  1648*   KEY DATA =                                  START=5, LEN=31  *
  1649*                                                                *
  1650*  NO  CID  MODS  IN  COPYBOOK  ECSEPC01                         *
  1651*                                                                *
  1652******************************************************************
  1653
  1654 01  EP-RECORD.
  1655     02 EP-FILE.
  1656     12  EP-RECORD-ID                      PIC XX.
  1657         88  VALID-EP-ID                      VALUE 'EP'.
  1658
  1659     12  EP-COMPANY-CD                     PIC X.
  1660
  1661     12  EP-REIN                           PIC X.
  1662         88  EP-REIN-EXTRACT                  VALUE 'R'.
  1663
  1664     12  EP-CONTROL.
  1665         16  EP-CNTRL-1.
  1666             20  EP-COMPANY.
  1667                 24  EP-CARRIER            PIC X.
  1668                 24  EP-GROUPING.
  1669                     28  EP-GROUP-PREFIX   PIC XXX.
  1670                     28  EP-GROUP-PRIME    PIC XXX.
  1671             20  EP-STATE                  PIC XX.
  1672             20  EP-ACCOUNT.
  1673                 24  EP-ACCT-PREFIX        PIC X(4).
  1674                 24  EP-ACCT-PRIME         PIC X(6).
  1675         16  EP-CNTRL-2.
  1676             20  EP-DATES.
  1677                 24  EP-EXP-DTE            PIC 9(11)   COMP-3.
  1678                 24  EP-EFF-DTE            PIC 9(11)   COMP-3.
  1679
  1680     12  EP-REI-CO.
  1681         16  EP-REINCO                     PIC XXX.
  1682         16  EP-REINCO-SUB                 PIC XXX.
  1683
  1684     12  EP-RCD-TYPE                       PIC X.
  1685         88  EP-BEN-TYPE-LIFE                 VALUE 'L'.
  1686         88  EP-BEN-TYPE-AH                   VALUE 'A'.
  1687         88  EP-BEN-TYPE-PROPERTY             VALUE 'P'.
  1688         88  EP-BEN-TYPE-UNEMPLOYMENT         VALUE 'U'.
  1689         88  EP-BEN-TYPE-DISMEMBURMENT        VALUE 'D'.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  35
* ECS010P.cbl (/apps/prod/cid1p/copy/ECSEPC01)
  1690         88  EP-BEN-TYPE-AD-D                 VALUE 'E'.
  1691     12  EP-BEN-CODE                       PIC XX.
  1692     12  FILLER                            PIC X.
  1693
  1694     12  EP-ISS-CNT                        PIC S9(7)      COMP-3.
  1695     12  EP-ISS-BEN                        PIC S9(11)V99  COMP-3.
  1696     12  EP-ISS-BEN-GROSS                  PIC S9(11)V99  COMP-3.
  1697
  1698     12  EP-CNC-CNT                        PIC S9(7)      COMP-3.
  1699     12  EP-CNC-BEN                        PIC S9(11)V99  COMP-3.
  1700     12  EP-CNC-BEN-GROSS                  PIC S9(11)V99  COMP-3.
  1701
  1702     12  EP-ISS-PRM                        PIC S9(9)V99   COMP-3.
  1703     12  EP-ISS-PRM-GROSS                  PIC S9(9)V99   COMP-3.
  1704     12  EP-CNC-PRM                        PIC S9(9)V99   COMP-3.
  1705     12  EP-CNC-PRM-GROSS                  PIC S9(9)V99   COMP-3.
  1706
  1707     12  EP-PRM-78                         PIC S9(9)V99   COMP-3.
  1708     12  EP-PRM-PR                         PIC S9(9)V99   COMP-3.
  1709     12  EP-PRM-ST                         PIC S9(9)V99   COMP-3.
  1710
  1711     12  EP-CLM-AMT                        PIC S9(9)V99   COMP-3.
  1712     12  EP-CLM-CNT                        PIC S9(7)      COMP-3.
  1713     12  EP-CLM-CRT                        PIC S9(7)      COMP-3.
  1714
  1715     12  EP-CLM-DU                         PIC S9(7)V99   COMP-3.
  1716     12  EP-CLM-PV                         PIC S9(7)V99   COMP-3.
  1717     12  EP-CLM-IBNR                       PIC S9(7)V99   COMP-3.
  1718     12  EP-LOSS-RESV                      PIC S9(7)V99   COMP-3.
  1719     12  EP-CLAIM-ADJ                      PIC S9(7)V99   COMP-3.
  1720
  1721     12  EP-RETRO-EXPENSES                 PIC S9(7)V99   COMP-3.
  1722     12  EP-RETRO-PAYMENTS                 PIC S9(7)V99   COMP-3.
  1723     12  EP-RETRO-OTH-COMM                 PIC S9(7)V99   COMP-3.
  1724
  1725     12  EP-MORT-RESV                      PIC S9(11)V9(6) COMP-3.
  1726     12  EP-IN-FORCE                       PIC S9(11)V99   COMP-3.
  1727     12  EP-ADJUST                         PIC S9(7)V99    COMP-3.
  1728
  1729     12  EP-SPECIFIC-OPT-RSV-FIELDS.
  1730         16  EP-LIFE-YEARS                 PIC S9(9)      COMP-3.
  1731         16  EP-NEW-DATA-IND               PIC X(01).
  1732             88  EP-NEW-DATA                   VALUE 'Y'.
  1733         16  EP-CLM-EXP                    PIC S9(9)V99   COMP-3.
  1734         16  FILLER                        PIC X(19).
  1735
  1736     12  EP-PRM-78-ADJ                     PIC S9(9)V99   COMP-3.
  1737     12  EP-PRM-PR-ADJ                     PIC S9(9)V99   COMP-3.
  1738     12  EP-PRM-ST-ADJ                     PIC S9(9)V99   COMP-3.
  1739
  1740     12  FILLER                            PIC XXX.
  1741
  1742     12  EP-UNDERWRITING-CODE              PIC X.
  1743         88  EP-UNDERWRITTEN-DATA             VALUE 'Y'.
  1744
  1745     12  EP-PRM-TAX                        PIC S9(7)V99   COMP-3.
  1746
  1747     12  FILLER                            PIC X(29).
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  36
* ECS010P.cbl (/apps/prod/cid1p/copy/ECSEPC01)
  1748*    12  FILLER                            PIC X(34).
  1749
  1750     12  EP-AVG-AGE                        PIC S9(3)      COMP-3.
  1751     12  EP-AVG-ORIG-TERM                  PIC S9(3)      COMP-3.
  1752     12  EP-WEIGHTED-AGE                   PIC S9(3)      COMP-3.
  1753     12  EP-WEIGHTED-ORIG-TERM             PIC S9(3)      COMP-3.
  1754     12  EP-AVG-REM-TERM                   PIC S9(3)      COMP-3.
  1755     12  EP-INFORCE-CNT                    PIC S9(9)      COMP-3.
  1756
  1757     12  EP-HI-COV-DT                      PIC 9(11)      COMP-3.
  1758
  1759     12  EP-HI-CERT                        PIC 9(11)      COMP-3.
  1760     12  EP-LO-CERT                        PIC 9(11)      COMP-3.
  1761
  1762     12  EP-PURGE                          PIC X.
  1763         88  EP-DATA-FROM-PURGED-CERTS        VALUE 'P'.
  1764
  1765     12  EP-RUN-DTE                        PIC 9(11)      COMP-3.
  1766
  1767     02 EC-RECORD     REDEFINES     EP-FILE.
  1768     12  EC-RECORD-ID                      PIC XX.
  1769         88  VALID-EC-ID                      VALUE 'EC'.
  1770
  1771     12  EC-COMPANY-CD                     PIC X.
  1772
  1773     12  EC-REIN                           PIC X.
  1774         88  EC-REIN-EXTRACT                  VALUE 'R'.
  1775
  1776     12  EC-CONTROL.
  1777         16  EC-CARRIER                    PIC X.
  1778         16  EC-GROUPING.
  1779             20  EC-GROUP-PREFIX           PIC XXX.
  1780             20  EC-GROUP-PRIME            PIC XXX.
  1781         16  EC-STATE                      PIC XX.
  1782         16  EC-ACCOUNT.
  1783             20  EC-ACCT-PREFIX            PIC X(4).
  1784             20  EC-ACCT-PRIME             PIC X(6).
  1785         16  EC-DATES.
  1786             20  EC-EXP-DTE                PIC 9(11)    COMP-3.
  1787             20  EC-EFF-DTE                PIC 9(11)    COMP-3.
  1788
  1789     12  EC-REI-CO.
  1790         16  EC-REINCO                     PIC XXX.
  1791         16  EC-REINCO-SUB                 PIC XXX.
  1792
  1793     12  EC-RCD-TYPE                       PIC X.
  1794         88  EC-BEN-TYPE-LIFE                 VALUE 'L'.
  1795         88  EC-BEN-TYPE-AH                   VALUE 'A'.
  1796         88  EC-BEN-TYPE-PROPERTY             VALUE 'P'.
  1797         88  EC-BEN-TYPE-UNEMPLOYMENT         VALUE 'U'.
  1798         88  EC-BEN-TYPE-DISMEMBURMENT        VALUE 'D'.
  1799     12  EC-BEN-CODE                       PIC XX.
  1800     12  EC-SEQ-NBR                        PIC X.
  1801         88  EC-COMP-LEVELS-1-5               VALUE '1'.
  1802         88  EC-COMP-LEVELS-6-10              VALUE '2'.
  1803
  1804     12  EC-AGENTS-DATA.
  1805         16  EC-AGENTS-LEVEL     OCCURS   5   TIMES.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  37
* ECS010P.cbl (/apps/prod/cid1p/copy/ECSEPC01)
  1806             20  EC-AGT-NO.
  1807                 24  EC-AGT-PREFIX         PIC X(4).
  1808                 24  EC-AGT-PRIME          PIC X(6).
  1809             20  EC-AGT-TYPE               PIC X.
  1810             20  EC-ISS-COMM               PIC S9(9)V99   COMP-3.
  1811             20  EC-CNC-COMM               PIC S9(9)V99   COMP-3.
  1812             20  EC-COMM-78                PIC S9(9)V99   COMP-3.
  1813             20  EC-COMM-PR                PIC S9(9)V99   COMP-3.
  1814             20  EC-COMM-ST                PIC S9(9)V99   COMP-3.
  1815
  1816     12  EC-UNDERWRITING-CODE              PIC X.
  1817         88  EC-UNDERWRITTEN-DATA             VALUE 'Y'.
  1818
  1819     12  EC-AGENTS-DATA-II.
  1820         16  EC-AGENTS-LEVEL-II  OCCURS   5   TIMES.
  1821             20  EC-COMM-78-ADJ            PIC S9(9)V99   COMP-3.
  1822             20  EC-COMM-PR-ADJ            PIC S9(9)V99   COMP-3.
  1823
  1824     12  FILLER                            PIC X(7).
  1825
  1826     12  EC-PURGE                          PIC X.
  1827         88  EC-DATA-FROM-PURGED-CERTS        VALUE 'P'.
  1828
  1829     12  EC-RUN-DTE                        PIC 9(11)     COMP-3.
  1830
  1831******************************************************************
  1832
  1833 FD  ERRESC-IN.
* 1834                             COPY ERCRESC.
  1835******************************************************************04/29/98
  1836*                                                                *ERCRESC
  1837*                            ERCRESC                             *   LV002
  1838*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  1839*                            VMOD=2.003                          *   CL**2
  1840*                                                                *ERCRESC
  1841*   FILE DESCRIPTION = ACCOUNT RESIDENT STATE COMMISSION         *ERCRESC
  1842*                                                                *ERCRESC
  1843*   FILE TYPE = VSAM,KSDS                                        *ERCRESC
  1844*   RECORD SIZE = 103 RECFORM = FIXED                            *ERCRESC
  1845*                                                                *ERCRESC
  1846*   BASE CLUSTER NAME = ERRESC                    RKP=00,LEN=37  *ERCRESC
  1847*       ALTERNATE PATH1 = NONE                                   *ERCRESC
  1848*                                                                *ERCRESC
  1849*   LOG = NO                                                     *ERCRESC
  1850*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *ERCRESC
  1851*                                                                *ERCRESC
  1852******************************************************************ERCRESC
  1853                                                                  ERCRESC
  1854 01  ACCOUNT-RESIDENT-ST-COMMISSION.                              ERCRESC
  1855                                                                  ERCRESC
  1856     10  ERRESC-RECORD-KEY.                                       ERCRESC
  1857         15  RESC-COMPANY-CD           PIC   X.                   ERCRESC
  1858         15  RESC-CARRIER              PIC   X.                   ERCRESC
  1859         15  RESC-GROUP                PIC   X(6).                ERCRESC
  1860         15  RESC-STATE                PIC   XX.                  ERCRESC
  1861         15  RESC-ACCOUNT              PIC   X(10).               ERCRESC
  1862         15  RESC-AGENT                PIC   X(10).               ERCRESC
  1863         15  RESC-RESIDENT-STATE       PIC   XX.                  ERCRESC
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  38
* ECS010P.cbl (/apps/prod/cid1p/copy/ERCRESC)
  1864         15  RESC-EXPIRE-DATE          PIC  9(8) COMP-3.          ERCRESC
  1865*                                           YYYYMMDD              ERCRESC
  1866     10  RESC-EFFECTIVE-DATE           PIC  9(8) COMP-3.          ERCRESC
  1867                                                                  ERCRESC
  1868     10  RESC-COMM-RECORD-DATA.                                   ERCRESC
  1869         15  RESC-COMMISSIONS OCCURS 12 TIMES.                    ERCRESC
  1870             20 RESC-COVERAGE-CAT      PIC    X.                  ERCRESC
  1871             20 RESC-COMMISSION-PER    PIC SV9(5) COMP-3.         ERCRESC
  1872             20 RESC-COMMISSION-TAB REDEFINES                     ERCRESC
  1873                RESC-COMMISSION-PER    PIC  XXX.                  ERCRESC
  1874                                                                  ERCRESC
  1875     10  RESC-MAINT-BY                 PIC X(4).                  ERCRESC
  1876     10  RESC-LST-MAINT-TIME           PIC 9(7)   COMP-3.         ERCRESC
  1877     10  RESC-LST-MAINT-DATE           PIC 9(8)   COMP-3.         ERCRESC
  1878*                                          YYYYMMDD               ERCRESC
  1879 FD  ELCRTT.
  1880
* 1881                             COPY ELCCRTT.
  1882******************************************************************
  1883*                                                                *ELCCRTT
  1884*                            ELCCRTT.                            *
  1885*                                                                *ELCCRTT
  1886*   FILE DESCRIPTION = CERTIFICATE TRAILERS                      *ELCCRTT
  1887*                                                                *ELCCRTT
  1888*   FILE TYPE = VSAM,KSDS                                        *ELCCRTT
  1889*   RECORD SIZE = 552  RECFORM = FIXED                           *ELCCRTT
  1890*                                                                *ELCCRTT
  1891*   BASE CLUSTER = ELCRTT                         RKP=2,LEN=34   *ELCCRTT
  1892*                                                                *ELCCRTT
  1893*   LOG = YES                                                    *ELCCRTT
  1894*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *ELCCRTT
  1895******************************************************************
  1896*                   C H A N G E   L O G
  1897*
  1898* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1899*-----------------------------------------------------------------
  1900*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1901* EFFECTIVE    NUMBER
  1902*-----------------------------------------------------------------
  1903* 111204                   PEMA  NEW FILE TO SPLIT BANK COMM
  1904* 040109  2009031600001    AJRA  ADD NEW TRAILER TYPE AND REDEFINE DATA
  1905* 012010  2009061500002    AJRA  ADD FLAG FOR REFUND WITH OPEN CLAIM
  1906* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  1907* 061013  CR2012113000002  PEMA  SPP CLAIM RELATED CHANGES
  1908* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  1909* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  1910* 022715  CR2015010800003  PEMA  AGENT SIGNATURE
  1911******************************************************************
  1912                                                                  ELCCRTT
  1913 01  CERTIFICATE-TRAILERS.                                        ELCCRTT
  1914     12  CS-RECORD-ID                      PIC XX.                ELCCRTT
  1915         88  VALID-CS-ID                      VALUE 'CS'.         ELCCRTT
  1916                                                                  ELCCRTT
  1917     12  CS-CONTROL-PRIMARY.                                      ELCCRTT
  1918         16  CS-COMPANY-CD                 PIC X.                 ELCCRTT
  1919         16  CS-CARRIER                    PIC X.                 ELCCRTT
  1920         16  CS-GROUPING                   PIC X(6).              ELCCRTT
  1921         16  CS-STATE                      PIC XX.                ELCCRTT
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  39
* ECS010P.cbl (/apps/prod/cid1p/copy/ELCCRTT)
  1922         16  CS-ACCOUNT                    PIC X(10).
  1923         16  CS-CERT-EFF-DT                PIC XX.                ELCCRTT
  1924         16  CS-CERT-NO.                                          ELCCRTT
  1925             20  CS-CERT-PRIME             PIC X(10).             ELCCRTT
  1926             20  CS-CERT-SFX               PIC X.                 ELCCRTT
  1927         16  CS-TRAILER-TYPE               PIC X.
  1928             88  COMM-TRLR           VALUE 'A'.
  1929             88  CLAIM-HISTORY-TRLR  VALUE 'B'.
  1930             88  CERT-DATA-TRLR      VALUE 'C'.
  1931                                                                  ELCCRTT
  1932     12  CS-DATA-AREA                      PIC X(516).
  1933
  1934     12  CS-BANK-COMMISSIONS REDEFINES CS-DATA-AREA.
  1935         16  CS-BANK-COMMISSION-AREA.
  1936             20  CS-BANK-COMMS       OCCURS 10.
  1937                 24  CS-AGT                PIC X(10).
  1938                 24  CS-COM-TYP            PIC X.
  1939                 24  CS-SPP-FEES           PIC S9(5)V99   COMP-3.
  1940                 24  CS-RECALC-LV-INDIC    PIC X.
  1941                 24  FILLER                PIC X(10).
  1942
  1943         16  FILLER                        PIC X(256).
  1944
  1945     12  CS-CLAIM-HISTORY-TRAILER REDEFINES CS-DATA-AREA.
  1946****  TO CALC NO OF BENEFITS PAID = (CS-DAYS-PAID / 30)
  1947
  1948         16  CS-MB-CLAIM-DATA OCCURS 24.
  1949             20  CS-CLAIM-NO               PIC X(7).
  1950             20  CS-CLAIM-TYPE             PIC X.
  1951                 88  CS-AH-CLM               VALUE 'A'.
  1952                 88  CS-IU-CLM               VALUE 'I'.
  1953                 88  CS-GP-CLM               VALUE 'G'.
  1954                 88  CS-LF-CLM               VALUE 'L'.
  1955                 88  CS-PR-CLM               VALUE 'P'.
  1956                 88  CS-FL-CLM               VALUE 'F'.
  1957             20  CS-INSURED-TYPE           PIC X.
  1958                 88  CS-PRIM-INSURED          VALUE 'P'.
  1959                 88  CS-CO-BORROWER           VALUE 'C'.
  1960             20  CS-BENEFIT-PERIOD         PIC 99.
  1961             20  CS-DAYS-PAID              PIC S9(5) COMP-3.
  1962             20  CS-TOTAL-PAID             PIC S9(7)V99 COMP-3.
  1963             20  CS-REMAINING-BENS         PIC S999 COMP-3.
  1964         16  FILLER                        PIC X(12).
  1965
  1966     12  CS-CERT-DATA REDEFINES CS-DATA-AREA.
  1967         16  CS-VIN-NUMBER                 PIC X(17).
  1968         16  CS-REFUND-CLAIM-FLAG          PIC X(01).
  1969         16  CS-INS-AGE-DEFAULT-FLAG       PIC X(01).
  1970         16  CS-JNT-AGE-DEFAULT-FLAG       PIC X(01).
  1971         16  cs-agent-name.
  1972             20  cs-agent-fname            pic x(20).
  1973             20  cs-agent-mi               pic x.
  1974             20  cs-agent-lname            pic x(25).
  1975         16  cs-license-no                 pic x(15).
  1976         16  cs-npn-number                 pic x(10).
  1977         16  cs-agent-edit-status          pic x.
  1978             88  cs-ae-refer-to-manager      value 'M'.
  1979             88  cs-ae-cover-sheet           value 'C'.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  40
* ECS010P.cbl (/apps/prod/cid1p/copy/ELCCRTT)
  1980             88  cs-ae-sig-form              value 'S'.
  1981             88  cs-ae-verified              value 'V'.
  1982             88  cs-unidentified-signature   value 'U'.
  1983             88  cs-cert-returned            value 'R'.
  1984             88  cs-accept-no-commission     value 'N'.
  1985         16  FILLER                        PIC X(424).
  1986*        16  FILLER                        PIC X(496).
  1987
  1988 FD  ERAGTC.
  1989
* 1990                             COPY ERCAGTC.
  1991******************************************************************
  1992*                                                                *
  1993*                                                                *
  1994*                            ERCAGTC                             *
  1995*                            VMOD=2.001                          *
  1996*                                                                *
  1997*   ONLINE CREDIT SYSTEM                                         *
  1998*                                                                *
  1999*   FILE DESCRIPTION = AGENT COMMISSIONS                         *
  2000*                                                                *
  2001*   FILE TYPE = VSAM,KSDS                                        *
  2002*   RECORD SIZE = 450   RECFORM = FIXED                          *
  2003*                                                                *
  2004*   BASE CLUSTER NAME = ERAGTC                   RKP=2,LEN=21    *
  2005*       ALTERNATE PATH = NONE                                    *
  2006*                                                                *
  2007*   LOG = NO                                                     *
  2008*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2009*                                                                *
  2010******************************************************************
  2011*                   C H A N G E   L O G
  2012*
  2013* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2014*-----------------------------------------------------------------
  2015*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2016* EFFECTIVE    NUMBER
  2017*-----------------------------------------------------------------
  2018* 111004    2004110300005  PEMA  ADD DISTRIBUTION OF ADDENDUM FEE
  2019* 111004                         NEW FILE AND COPYBOOK
  2020* 092205                   PEMA  ADD PROCESSING FOR SPP LEASE
  2021******************************************************************
  2022
  2023 01  AGENT-COMMISSIONS.
  2024     12  AG-RECORD-ID                          PIC XX.
  2025         88  VALID-CO-ID                          VALUE 'AG'.
  2026
  2027     12  AG-CONTROL-PRIMARY.
  2028         16  AG-COMPANY-CD                     PIC X.
  2029         16  AG-CONTROL.
  2030             20  AG-CTL-1.
  2031                 24  AG-CARR-GROUP.
  2032                     28  AG-CARRIER            PIC X.
  2033                     28  AG-GROUPING           PIC X(6).
  2034                 24  AG-BANK                   PIC X(10).
  2035             20  AG-CTL-2.
  2036                 24  AG-EXP-DT                 PIC XX.
  2037         16  AG-TYPE                           PIC X.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  41
* ECS010P.cbl (/apps/prod/cid1p/copy/ERCAGTC)
  2038             88  AG-GEN-AGENT-TYPE                VALUE 'G'.
  2039             88  AG-ACCOUNT-TYPE                  VALUE 'A'.
  2040
  2041     12  AG-MAINT-INFORMATION.
  2042         16  AG-LAST-MAINT-DT                  PIC XX.
  2043         16  AG-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  2044         16  AG-LAST-MAINT-USER                PIC X(4).
  2045         16  FILLER                            PIC X(10).
  2046
  2047     12  AG-EFF-DT                             PIC XX.
  2048     12  AG-COMM-STRUCTURE.
  2049         16  AG-AGT-COMMS OCCURS 10.
  2050             20  AG-AGT                PIC X(10).
  2051             20  AG-COM-TYP            PIC X.
  2052             20  AG-SPP-FEES           PIC S9(5)V99   COMP-3.
  2053             20  AG-RECALC-LV-INDIC    PIC X.
  2054             20  AG-SPP-LFEES          PIC S9(5)V99   COMP-3.
  2055             20  AG-LRCALC-LV-INDIC    PIC X.
  2056             20  FILLER                PIC X(05).
  2057
  2058     12  FILLER                  PIC X(145).
  2059******************************************************************
  2060
  2061 FD  ME-ECS010-BALANCE
  2062     RECORDING MODE IS F
  2063     BLOCK CONTAINS 0 RECORDS.
  2064 01  ME-ECS010-BALANCE-REC    PIC X(83).
  2065
  2066 FD  ME50-ECS010-BALANCE
  2067     RECORDING MODE IS F
  2068     BLOCK CONTAINS 0 RECORDS.
  2069 01  ME50-ECS010-BALANCE-REC  PIC X(95).
  2070
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  42
* ECS010P.cbl
  2072 FD  DISK-DATE
* 2073                             COPY ELCDTEFD.
  2074******************************************************************04/15/98
  2075*                                                                *ELCDTEFD
  2076*                                                                *ELCDTEFD
  2077*                            ELCDTEFD.                           *   LV002
  2078*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  2079*                            VMOD=2.007                          *   CL**2
  2080*                                                                *ELCDTEFD
  2081******************************************************************ELCDTEFD
  2082     BLOCK CONTAINS 0 RECORDS
  2083     RECORDING MODE F.                                            ELCDTEFD
  2084                                                                  ELCDTEFD
  2085 01  DATE-DISK.                                                   ELCDTEFD
  2086     12  DD-ID                       PIC  X(4).                   ELCDTEFD
  2087     12  FILLER                      PIC  X(14).                  ELCDTEFD
  2088     12  DD-CR1                      PIC  9.                      ELCDTEFD
  2089     12  DD-CR1N                     PIC  X(30).                  ELCDTEFD
  2090     12  DD-CR2                      PIC  9.                      ELCDTEFD
  2091     12  DD-CR2N                     PIC  X(30).                  ELCDTEFD
  2092     12  FILLER                      PIC  X(20).                  ELCDTEFD
  2093                                                                  ELCDTEFD
  2094 01  DATE-DISK-R.                                                 ELCDTEFD
  2095     12  FILLER                      PIC  X(4).                   ELCDTEFD
  2096     12  DD-ST           OCCURS 3 TIMES                           ELCDTEFD
  2097                                     PIC  X(32).                  ELCDTEFD
  2098                                                                  ELCDTEFD
  2099 01  DATE-DISK-T.                                                 ELCDTEFD
  2100     12  FILLER                      PIC  X(4).                   ELCDTEFD
  2101     12  DD-TYPE         OCCURS 2 TIMES                           ELCDTEFD
  2102                                     PIC  X(48).                  ELCDTEFD
  2103                                                                  ELCDTEFD
  2104 01  DATE-DISK-M.                                                 ELCDTEFD
  2105     12  FILLER                      PIC  X(4).                   ELCDTEFD
  2106     12  DD-MORT         OCCURS 2 TIMES                           ELCDTEFD
  2107                                     PIC  X(48).                  ELCDTEFD
  2108                                                                  ELCDTEFD
  2109 01  DATE-DISK-P.                                                 ELCDTEFD
  2110     12  DD-IDA                      PIC  XX.                     ELCDTEFD
  2111     12  DD-IDX                      PIC  99.                     ELCDTEFD
  2112     12  DD-DATA                     PIC  X(96).                  ELCDTEFD
  2113     12  FILLER  REDEFINES DD-DATA.                               ELCDTEFD
  2114         16  DD-PS-PIC   OCCURS 50 TIMES                          ELCDTEFD
  2115                                     PIC  X.                      ELCDTEFD
  2116         16  FILLER                  PIC  X(46).                  ELCDTEFD
  2117     12  FILLER  REDEFINES DD-DATA.                               ELCDTEFD
  2118         16  DD-PS-PICO  OCCURS 20 TIMES.                         ELCDTEFD
  2119             20  DD-PS-PRT           PIC  X.                      ELCDTEFD
  2120             20  DD-PS-FMT           PIC  X.                      ELCDTEFD
  2121             20  DD-PS-PRC           PIC  X.                      ELCDTEFD
  2122             20  DD-PS-TOT           PIC  X.                      ELCDTEFD
  2123         16  FILLER                  PIC  X(16).                  ELCDTEFD
  2124                                                                  ELCDTEFD
  2125 01  DATE-DISK-E.                                                 ELCDTEFD
  2126     12  FILLER                      PIC  X(4).                   ELCDTEFD
  2127     12  DD-EDIT         OCCURS 24 TIMES                          ELCDTEFD
  2128                                     PIC  X(4).                   ELCDTEFD
  2129                                                                  ELCDTEFD
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  43
* ECS010P.cbl (/apps/prod/cid1p/copy/ELCDTEFD)
  2130 01  DATE-DISK-C.                                                 ELCDTEFD
  2131     12  FILLER                      PIC  X(7).                   ELCDTEFD
  2132     12  DD-CARR1-SECPAY-SW          PIC  X.
  2133     12  DD-CARR1-UEP-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
  2134     12  DD-CARR1-R78-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
  2135     12  DD-CARR1-PRO-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
  2136     12  DD-CARR1                    PIC  X.                      ELCDTEFD
  2137     12  DD-CARR1S                   PIC  XX.                     ELCDTEFD
  2138     12  DD-CARR1N                   PIC  X(30).                  ELCDTEFD
  2139     12  DD-CARR2                    PIC  X.                      ELCDTEFD
  2140     12  DD-CARR2S                   PIC  XX.                     ELCDTEFD
  2141     12  DD-CARR2N                   PIC  X(30).                  ELCDTEFD
  2142     12  DD-CARR2-UEP-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
  2143     12  DD-CARR2-R78-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
  2144     12  DD-CARR2-PRO-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
  2145     12  DD-CARR2-SECPAY-SW          PIC  X.
  2146     12  FILLER                      PIC  X(7).                   ELCDTEFD
  2147                                                                  ELCDTEFD
  2148 01  DATE-DISK-OPT.                                               ELCDTEFD
  2149     12  FILLER                      PIC  X(04).                  ELCDTEFD
  2150     12  DD-TLR-DATA.                                             ELCDTEFD
  2151         16  DD-TLR                  OCCURS 32 TIMES              ELCDTEFD
  2152                                     PIC  X(03).                  ELCDTEFD
  2153     12  DD-STATE-DATA REDEFINES DD-TLR-DATA.                     ELCDTEFD
  2154         16  DD-STATE-FLDS           OCCURS 16 TIMES              ELCDTEFD
  2155                                     PIC  X(06).                  ELCDTEFD
  2156     12  DD-CARR-DATA REDEFINES DD-TLR-DATA.                      ELCDTEFD
  2157         16  DD-CARR-FLDS            OCCURS 13 TIMES              ELCDTEFD
  2158                                     PIC  X(07).                  ELCDTEFD
  2159         16  FILLER                  PIC  X(05).                  ELCDTEFD
  2160     12  DD-MISC-DATA REDEFINES DD-TLR-DATA                       ELCDTEFD
  2161                                     PIC  X(96).                  ELCDTEFD
  2162******************************************************************ELCDTEFD
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  44
* ECS010P.cbl
  2164 FD  PRINT-COPY
* 2165                             COPY ELCPRTFD.
  2166******************************************************************04/15/98
  2167*                                                                *ELCPRTFD
  2168*                                                                *ELCPRTFD
  2169*                            ELCPRTFD.                           *   LV003
  2170*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
  2171*                            VMOD=2.006                          *ELCPRTFD
  2172******************************************************************ELCPRTFD
  2173     RECORDING MODE F                                             ELCPRTFD
  2174     LABEL RECORDS OMITTED                                        ELCPRTFD
  2175     BLOCK CONTAINS 0 RECORDS
  2176     RECORD CONTAINS 133 CHARACTERS.                              ELCPRTFD
  2177 01  PRT.                                                         ELCPRTFD
  2178     12  P-CTL               PIC  X.                                 CL**2
  2179     12  P-DATA              PIC  X(132).                         ELCPRTFD
  2180******************************************************************ELCPRTFD
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  45
* ECS010P.cbl
  2182 FD  MISMATCH-REPORT
  2183     RECORDING MODE F.
  2184
  2185 01  MISMATCH-RPT.
  2186     12  MR-CTL              PIC X.
  2187     12  MR-DATA             PIC X(132).
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  46
* ECS010P.cbl
  2189 FD  FICH
* 2190                             COPY ELCFCHFD.
  2191******************************************************************04/15/98
  2192*                                                                *ELCFCHFD
  2193*                            ELCFCHFD.                           *   LV003
  2194*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  2195*                            VMOD=2.004                          *   CL**3
  2196*                                                                *ELCFCHFD
  2197******************************************************************ELCFCHFD
  2198     BLOCK CONTAINS 0 RECORDS
  2199     RECORDING MODE F.                                            ELCFCHFD
  2200                                                                  ELCFCHFD
  2201 01  FICH-REC                            PIC   X(133).            ELCFCHFD
  2202******************************************************************ELCFCHFD
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  47
* ECS010P.cbl
  2204 FD  DISPLAY-PRT
  2205     RECORDING MODE IS F
  2206     LABEL RECORDS ARE STANDARD
  2207     BLOCK CONTAINS 0 RECORDS
  2208     RECORD CONTAINS 133 CHARACTERS.
  2209
  2210 01  DISPLAY-REC.
  2211     05  DISPLAY-CC           PIC X.
  2212     05  DISPLAY-INFO         PIC X(132).
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  48
* ECS010P.cbl
  2214 WORKING-STORAGE SECTION.
  2215 77  LCP-ASA                       PIC X.
  2216 77  FILLER  PIC X(32)  VALUE '********************************'.
  2217 77  FILLER  PIC X(32)  VALUE '*     ECS010 WORKING-STORAGE    '.
  2218 77  FILLER  PIC X(32)  VALUE '******** VMOD=2.082 ************'.
  2219
  2220 77  WS-DISP-AMT             PIC Z,ZZZ,ZZZ.99    VALUE ZEROS.
  2221 77  ERROR-COUNT             PIC 9(7)            VALUE ZEROS.
  2222 77  DIS-LINE-CNT            PIC 99              VALUE ZEROS.
  2223 77  PGM-SUB                 PIC S999    COMP    VALUE +010.
  2224 77  FIRST-ACCOUNT           PIC S9      COMP-3  VALUE +1.
  2225 77  FIRST-CERT              PIC S9      COMP-3  VALUE +1.
  2226 77  TR-CNT                  PIC S9(5)   COMP-3  VALUE +0.
  2227 77  CMIN-CNT                PIC S9(7)   COMP-3  VALUE +0.
  2228 77  CMOT-CNT                PIC S9(7)   COMP-3  VALUE +0.
  2229 77  DE-CNT                  PIC S9(7)   COMP-3  VALUE +0.
  2230 77  EP-CNT                  PIC S9(7)   COMP-3  VALUE +0.
  2231 77  LN-CNT                  PIC S999    COMP-3  VALUE +61.
  2232 77  PG-CNT                  PIC S9(5)   COMP-3  VALUE +0.
  2233 77  DUP-CNT                 PIC S9(5)   COMP-3  VALUE +0.
  2234 77  DISABILITY-TBL-MAX      PIC S9              VALUE +5.
  2235 77  DUP-MAX                 PIC S9(5)   COMP-3  VALUE +500.
  2236 77  RANGE-CNT               PIC S999    COMP-3  VALUE +0.
  2237 77  ERACCTT-READS           PIC S9(7)   COMP-3  VALUE +0.
  2238 77  ERAGTC-READS            PIC S9(7)   COMP-3  VALUE +0.
  2239 77  ELCRTT-READS            PIC S9(7)   COMP-3  VALUE +0.
  2240 77  ERRTBL-READS            PIC S9(7)   COMP-3  VALUE +0.
  2241 77  ERCTBL-READS            PIC S9(7)   COMP-3  VALUE +0.
  2242 77  FLA-CLM-REIN-BASE       PIC S9(9)V99 COMP-3.
  2243 77  WK-RATE                 PIC S99V9(5) COMP-3 VALUE +0.
  2244 77  COMM-CK-AMT             PIC S9(9)V99 COMP-3 VALUE +0.
  2245 77  ADJ-FLA-REIN-BASE       PIC S9(9)V9(4) COMP-3.
  2246 77  ISS-WK                  PIC S9(9)V99 COMP-3 VALUE +0.
  2247 77  CNC-WK                  PIC S9(9)V99 COMP-3 VALUE +0.
  2248 77  CNC-FACT                PIC S9(3)V9(7) COMP-3 VALUE +0.
  2249 77  COMM-WK                 PIC S9(9)V99 COMP-3 VALUE +0.
  2250 77  X                       PIC X.
  2251 77  DD-FLG                  PIC X               VALUE SPACE.
  2252 77  AGT-SW                  PIC X               VALUE SPACE.
  2253 77  RC-COMM-FLG             PIC X               VALUE SPACE.
  2254 77  RECALC-TYPE             PIC X               VALUE SPACE.
  2255 77  LIFE-REFUND             PIC S9(7)V99        COMP-3.
  2256 77  LIFE-REFUND-CALC        PIC S9(7)V99        COMP-3.
  2257 77  A-H-REFUND              PIC S9(7)V99        COMP-3.
  2258 77  A-H-REFUND-CALC         PIC S9(7)V99        COMP-3.
  2259 77  YTD-CANCEL-CNT          PIC S9(3)           COMP-3.
  2260 77  MISMATCH-COUNT          PIC S9(5)           VALUE +0.
  2261 77  MISMATCH-LINE-COUNT     PIC S9(5)           VALUE +99.
  2262 77  MISMATCH-PAGE-NUMBER    PIC S9(5)           VALUE +0.
  2263 77  SV-HI-CERT              PIC 9(11)           VALUE ZEROS.
  2264 77  SV-LO-CERT              PIC 9(11)           VALUE ZEROS.
  2265 77  LST-TRD-CERT            PIC X(11)           VALUE SPACES.
  2266 77  SV-TRD-CERT             PIC X(11).
  2267 77  LST-TRD-ISDT            PIC X(10)           VALUE SPACES.
  2268 77  SV-TRD-ISDT             PIC X(10).
  2269 77  SAVE-EXTRACT            PIC X(510)          VALUE SPACES.
  2270*77  W-TLR                   PIC S9(01)V9(04) COMP-3 VALUE +.40.
  2271*77  W-AH-FACTOR             PIC S9(01)V9(04) COMP-3 VALUE +.50.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  49
* ECS010P.cbl
  2272 77  W-EPEC-EP               PIC S9(11)V9(02) COMP-3 VALUE +0.
  2273 77  W-EPEC-EP-IN            PIC S9(11)V9(02) COMP-3 VALUE +0.
  2274 77  W-EPEC-EP-1             PIC S9(11)V9(02) COMP-3 VALUE +0.
  2275 77  W-EPEC-EP-2             PIC S9(11)V9(02) COMP-3 VALUE +0.
  2276 77  W-P-EP                  PIC S9(11)V9(02) COMP-3 VALUE +0.
  2277 77  W-M-EP                  PIC S9(11)V9(02) COMP-3 VALUE +0.
  2278 77  W-R-EP                  PIC S9(11)V9(02) COMP-3 VALUE +0.
  2279 77  W-WY-EP                 PIC S9(11)V9(02) COMP-3 VALUE +0.
  2280 77  W-VA-EP                 PIC S9(11)V9(02) COMP-3 VALUE +0.
  2281 77  W-1-EP                  PIC S9(11)V9(02) COMP-3 VALUE +0.
  2282 77  W-OTHERS-COUNT          PIC S9(11)       COMP-3 VALUE +0.
  2283 77  W-AH-CLAIM-EP           PIC S9(11)V9(02) COMP-3 VALUE +0.
  2284 77  W-AH-CLAIM-CTR          PIC S9(11)       COMP-3 VALUE +0.
  2285 77  W-EP-LESS-THAN-0        PIC S9(11)       COMP-3 VALUE +0.
  2286 77  W-CLAIMS-MADE-PAID-IN   PIC S9(11)V9(02) COMP-3 VALUE +0.
  2287 77  W-CLAIMS-MADE-PAID      PIC S9(11)V9(02) COMP-3 VALUE +0.
  2288 77  W-AH-IBNR               PIC S9(11)V9(02) COMP-3 VALUE +0.
  2289 77  W-AH-IBNR-1             PIC S9(11)V9(02) COMP-3 VALUE +0.
  2290 77  W-AH-IBNR-1-CNT         PIC S9(11)       COMP-3 VALUE +0.
  2291 77  W-AH-IBNR-2             PIC S9(11)V9(02) COMP-3 VALUE +0.
  2292 77  W-AH-IBNR-2-CNT         PIC S9(11)       COMP-3 VALUE +0.
  2293 77  W-LIFE-IBNR             PIC S9(11)V9(02) COMP-3 VALUE +0.
  2294 77  W-LIFE-IBNR-IN          PIC S9(11)V9(02) COMP-3 VALUE +0.
  2295 77  W-LIFE-REMAINING-AMT    PIC S9(11)V9(02) COMP-3 VALUE +0.
  2296 77  W-RTRM-0-CLMAMT         PIC S9(11)V9(02) COMP-3 VALUE +0.
  2297 77  W-CLM-EXCEPT-CNT        PIC S9(11)       COMP-3 VALUE +0.
  2298 77  W-CLM-EXCEPT-AMT        PIC S9(11)V9(02) COMP-3 VALUE +0.
  2299 77  W-RTRM-0-CNT            PIC S9(11)       COMP-3 VALUE +0.
  2300 77  W-RTRM-EP-1             PIC S9(11)V9(02) COMP-3 VALUE +0.
  2301 77  W-RTRM-EP-2             PIC S9(11)V9(02) COMP-3 VALUE +0.
  2302 77  W-RTRM-EP               PIC S9(11)V9(02) COMP-3 VALUE +0.
  2303 77  W-01-REMAMT             PIC S9(11)V9(02) COMP-3 VALUE +0.
  2304 77  W-01-DATA-USED          PIC S9(11)       COMP-3 VALUE +0.
  2305 77  W-02-REMAMT             PIC S9(11)V9(02) COMP-3 VALUE +0.
  2306 77  W-02-DATA-USED          PIC S9(11)       COMP-3 VALUE +0.
  2307 77  W-03-REMAMT             PIC S9(11)V9(02) COMP-3 VALUE +0.
  2308 77  W-03-DATA-USED          PIC S9(11)       COMP-3 VALUE +0.
  2309 77  W-04-REMAMT             PIC S9(11)V9(02) COMP-3 VALUE +0.
  2310 77  W-04-DATA-USED          PIC S9(11)       COMP-3 VALUE +0.
  2311 77  W-05-REMAMT             PIC S9(11)V9(02) COMP-3 VALUE +0.
  2312 77  W-05-DATA-USED          PIC S9(11)       COMP-3 VALUE +0.
  2313 77  W-06-REMAMT             PIC S9(11)V9(02) COMP-3 VALUE +0.
  2314 77  W-06-DATA-USED          PIC S9(11)       COMP-3 VALUE +0.
  2315 77  W-30-REMAMT             PIC S9(11)V9(02) COMP-3 VALUE +0.
  2316 77  W-30-DATA-USED          PIC S9(11)       COMP-3 VALUE +0.
  2317 77  W-31-REMAMT             PIC S9(11)V9(02) COMP-3 VALUE +0.
  2318 77  W-31-DATA-USED          PIC S9(11)       COMP-3 VALUE +0.
  2319 77  W-XX-REMAMT             PIC S9(11)V9(02) COMP-3 VALUE +0.
  2320 77  WS-TOT-PRM-AMT          PIC S9(11)V9(02) COMP-3 VALUE +0.
  2321 77  W-XX-DATA-USED          PIC S9(11)       COMP-3 VALUE +0.
  2322 77  W-MM-LF-PRM             PIC S9(7)V99     COMP-3 VALUE +0.
  2323 77  W-MM-AH-PRM             PIC S9(7)V99     COMP-3 VALUE +0.
  2324 77  W-MM-LF-RFD             PIC S9(7)V99     COMP-3 VALUE +0.
  2325 77  W-MM-AH-RFD             PIC S9(7)V99     COMP-3 VALUE +0.
  2326 77  W-MM-LF-CLM             PIC S9(7)V99     COMP-3 VALUE +0.
  2327 77  W-MM-AH-CLM             PIC S9(7)V99     COMP-3 VALUE +0.
  2328 77  WS-CEDE-FACT            PIC S9V9(4)      COMP-3 VALUE +0.
  2329 77  WS-SAVE-CARR            PIC X                   VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  50
* ECS010P.cbl
  2330 77  WS-LOOP-MAX             PIC S99          COMP-3 VALUE +10.
  2331 77  WS-CR-PMT-FREQ          PIC 99           VALUE ZEROS.
  2332 77  WS-WE-LFPRM             PIC S9(7)V99    COMP-3 VALUE +0.
  2333 77  WS-FIRST-K              PIC X                  VALUE ' '.
  2334 77  WS-DLR-INC-CHG-BACK     PIC X                  VALUE ' '.
  2335 77  TOT-AH-IBNR             PIC S9(11)V99 COMP-3 VALUE +0.
  2336 77  TOT-AH-PRM              PIC S9(11)V99 COMP-3 VALUE +0.
  2337 77  TOT-AH-PD-CLMS          PIC S9(11)V99 COMP-3 VALUE +0.
  2338 77  TOT-AH-CLMRSV           PIC S9(11)V99 COMP-3 VALUE +0.
  2339 77  TOT-LF-IBNR             PIC S9(11)V99 COMP-3 VALUE +0.
  2340 77  TOT-LF-PRM              PIC S9(11)V99 COMP-3 VALUE +0.
  2341 77  TOT-LF-PD-CLMS          PIC S9(11)V99 COMP-3 VALUE +0.
  2342 77  TOT-LF-CLMRSV           PIC S9(11)V99 COMP-3 VALUE +0.
  2343 77  RTOT-AH-IBNR            PIC S9(11)V99 COMP-3 VALUE +0.
  2344 77  RTOT-AH-PRM             PIC S9(11)V99 COMP-3 VALUE +0.
  2345 77  RTOT-AH-PD-CLMS         PIC S9(11)V99 COMP-3 VALUE +0.
  2346 77  RTOT-AH-CLMRSV          PIC S9(11)V99 COMP-3 VALUE +0.
  2347 77  RTOT-LF-IBNR            PIC S9(11)V99 COMP-3 VALUE +0.
  2348 77  RTOT-LF-PRM             PIC S9(11)V99 COMP-3 VALUE +0.
  2349 77  RTOT-LF-PD-CLMS         PIC S9(11)V99 COMP-3 VALUE +0.
  2350 77  RTOT-LF-CLMRSV          PIC S9(11)V99 COMP-3 VALUE +0.
  2351 77  IBNR-FACT               PIC S9(3)V9(7) COMP-3 VALUE +0.
  2352
  2353 01  MONTH-END-DATA.
  2354     12  ME-START-DATE.
  2355         16  ME-START-MO         PIC 99.
  2356         16  FILLER              PIC X.
  2357         16  ME-START-DA         PIC 99.
  2358         16  FILLER              PIC X.
  2359         16  ME-START-YR         PIC 99.
  2360     12  ME-CNDS-DATE            PIC 9(6).
  2361     12  ME-CNDS-DATE-R REDEFINES ME-CNDS-DATE.
  2362         16  ME-CNDS-MO          PIC 99.
  2363         16  ME-CNDS-DA          PIC 99.
  2364         16  ME-CNDS-YR          PIC 99.
  2365     12  ME-START-TIME           PIC 9(6).
  2366     12  ME-UPDATE-FLAG          PIC X VALUE 'Y'.
  2367         88  ME-DO-UPDATE        VALUE 'Y'.
  2368         88  ME-NO-UPDATE        VALUE 'N'.
  2369     12  MONTH-END-MOYR          PIC S9(5) COMP-3.
  2370
  2371 01  WS-BALANCE-DESCRIPTION1       PIC X(50)  VALUE
  2372     'Life Claims Paid'.
  2373
  2374 01  WS-BALANCE-DESCRIPTION2       PIC X(50)  VALUE
  2375     'A&H Claims Paid'.
  2376
  2377 01  WS-BALANCE-DESCRIPTION3       PIC X(50)  VALUE
  2378     'Output Certificate Master Records Prior Month'.
  2379
  2380 01  WS-BAL50-DESCRIPTION          PIC X(50)  VALUE
  2381     'ECS010 Out Recs should match EL331 Offline Certs  '.
  2382
  2383 01  WS-ME-BALANCE-REC.
  2384     12  WS-ME-BAL-JOB           PIC X(11)  VALUE SPACES.
  2385     12  WS-ME-BAL-DELIM1        PIC X(01)  VALUE ';'.
  2386     12  WS-ME-BAL-STEP          PIC X(08)  VALUE 'ECS010  '.
  2387     12  WS-ME-BAL-DELIM2        PIC X(01)  VALUE ';'.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  51
* ECS010P.cbl
  2388     12  WS-ME-BAL-AMT           PIC ZZZ,ZZZ,ZZ9.
  2389     12  WS-ME-BAL-DELIM3        PIC X(01)  VALUE ';'.
  2390     12  WS-ME-BAL-DESCRIP       PIC X(50)  VALUE SPACES.
  2391
  2392 01  WS-ME50-BALANCE-REC.
  2393     12  WS-ME50-BAL-JOB           PIC X(11)  VALUE SPACES.
  2394     12  WS-ME50-BAL-DELIM1        PIC X(01)  VALUE ';'.
  2395     12  WS-ME50-BAL-STEP          PIC X(08)  VALUE 'ECS010  '.
  2396     12  WS-ME50-BAL-DELIM2        PIC X(01)  VALUE ';'.
  2397     12  WS-ME50-BAL-AMT-LOW       PIC ZZZ,ZZZ,ZZ9.
  2398     12  WS-ME50-BAL-DELIM3        PIC X(01)  VALUE ';'.
  2399     12  WS-ME50-BAL-AMT-HIGH      PIC ZZZ,ZZZ,ZZ9.
  2400     12  WS-ME50-BAL-DELIM4        PIC X(01)  VALUE ';'.
  2401     12  WS-ME50-BAL-DESCRIP       PIC X(50)  VALUE SPACES.
  2402
  2403 01  WS-PREV-BANK-COMM-KEY       PIC X(21)  VALUE LOW-VALUES.
  2404 01  WS-BANK-INIT                PIC X(260) VALUE SPACES.
  2405 01  WS-BANK-COMMISSIONS.
  2406     12  WS-BANK-COMMS           OCCURS 10.
  2407         16  WS-BNK-AGT          PIC X(10).
  2408         16  WS-BNK-TYPE         PIC X.
  2409         16  WS-BNK-SPP-FEES     PIC S9(5)V99  COMP-3.
  2410         16  WS-BNK-RECALC       PIC X.
  2411         16  FILLER              PIC X(10).
  2412
  2413 01  PENDING-MATCH-CONTROL.
  2414     12  PENDING-ACCOUNT-CONTROL.
  2415         16  PEND-MATCH-CARRIER    PIC X.
  2416         16  PEND-MATCH-GROUPING   PIC X(6).
  2417         16  PEND-MATCH-STATE      PIC XX.
  2418         16  PEND-MATCH-ACCOUNT    PIC X(10).
  2419     12  PEND-MATCH-EFF-DTE        PIC 9(11) COMP-3.
  2420     12  PEND-MATCH-CERT-NO.
  2421         16  PEND-MATCH-CERT       PIC X(10).
  2422         16  PEND-MATCH-CERT-SFX   PIC X.
  2423 01  PENDING-RECORD-TYPE           PIC X.
  2424     88  ISSUE-TRANSACTION            VALUE '1'.
  2425     88  CANCEL-TRANSACTION           VALUE '2'.
  2426     88  CLAIM-TRANSACTION            VALUE '3'.
  2427     88  RESERVE-TRANSACTION          VALUE '4'.
  2428     88  UPDATE-TRANSACTION           VALUE '5'.
  2429
  2430 01  CLM-INCUR-REIN-DATE.
  2431     12  CIRD-CCYY.
  2432         16  CIRD-CC         PIC 99.
  2433         16  CIRD-YR         PIC 99.
  2434     12  CIRD-MO             PIC 99.
  2435
  2436 01  HIGH-CERT               PIC 9(11)           VALUE ZEROS.
  2437
  2438 01  LOW-CERT                PIC 9(11)           VALUE ZEROS.
  2439
  2440 01  REIN-BILLING-TABLE.
  2441     12  REIN-CO-ENTRIES OCCURS 50 TIMES.
  2442         16  RB-COMPANY      PIC X(6).
  2443         16  RB-COUNT        PIC S9(5)   COMP-3.
  2444
  2445 01  B-SUB                   PIC S9(4)   COMP.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  52
* ECS010P.cbl
  2446
  2447 01  BINARY-COUNTERS     COMP      SYNC.
  2448     12  IA                  PIC S999            VALUE +0.
  2449     12  IB                  PIC S999            VALUE +0.
  2450     12  SUB                 PIC S999            VALUE +0.
  2451     12  SUBM                PIC S999            VALUE +0.
  2452     12  SUB3                PIC S999            VALUE +0.
  2453     12  SUB4                PIC S999            VALUE +0.
  2454     12  SUB5                PIC S999            VALUE +0.
  2455     12  SUB6                PIC S999            VALUE +0.
  2456     12  SUB7                PIC S999            VALUE +0.
  2457     12  SUB8                PIC S999            VALUE +0.
  2458     12  SUB9                PIC S999            VALUE +0.
  2459     12  SUB10               PIC S999            VALUE +0.
  2460     12  SUB11               PIC S999            VALUE +0.
  2461     12  SUB12               PIC S999            VALUE +0.
  2462     12  SUB13               PIC S999            VALUE +0.
  2463     12  SUB14               PIC S999            VALUE +0.
  2464     12  SUB15               PIC S999            VALUE +0.
  2465     12  SUB16               PIC S999            VALUE +0.
  2466     12  LEVELS-BUILT        PIC S999            VALUE +0.
  2467 01  WS-SEQ-NBR              PIC 9               VALUE ZERO.
  2468
  2469 01  WS.
  2470     12  WS-RETURN-CODE        PIC S9(4)   COMP   VALUE +0.
  2471     12  WS-ABEND-MESSAGE      PIC X(80)          VALUE SPACES.
  2472     12  WS-ABEND-FILE-STATUS  PIC XX             VALUE ZEROS.
  2473     12  WS-ZERO               PIC S9      COMP-3 VALUE +0.
  2474
  2475     12  WS-ABEND-CODE         PIC 9(4).
  2476     12  ABEND-CODE  REDEFINES  WS-ABEND-CODE.
  2477         16  ABEND-CODE-1    PIC XX.
  2478         16  ABEND-CODE-2.
  2479             20  AC2-ONE     PIC X.
  2480             20  AC2-TWO     PIC X.
  2481
  2482     12  CTBL-SEARCH.
  2483         16  CTBL-COMP-CD    PIC X.
  2484         16  CTBL-TABLE-CD   PIC XXX.
  2485         16  CTBL-BEN-TYPE   PIC X.
  2486         16  CTBL-BEN-CODE   PIC XX.
  2487     12  LAST-CTBL           PIC X(7)            VALUE SPACES.
  2488     12  COMM-OPEN-SW        PIC X               VALUE SPACES.
  2489     12  WS-COMM-TERM        PIC S999            COMP-3.
  2490     12  CTBL-ERROR-SWITCH   PIC X               VALUE SPACE.
  2491         88  CTBL-ERROR         VALUE '*'.
  2492
  2493     12  REIN-SPEC.
  2494         16  REIN-SPEC-A     PIC X.
  2495         16  REIN-SPEC-B     PIC X.
  2496         16  REIN-SPEC-C     PIC X.
  2497
  2498     12  WS-CHECK-NUMBER.
  2499         16  WS-CHECK-NO     PIC X(4).
  2500         16  FILLER          PIC XXX.
  2501
  2502     12  AH-EARN-METHOD      PIC X               VALUE SPACES.
  2503         88  AH-EARN-ANTICIPATION                VALUE 'A' 'C'.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  53
* ECS010P.cbl
  2504         88  AH-EARN-NET                         VALUE 'N'.
  2505
  2506 01  ERACCTT-FILE-STATUS     PIC XX VALUE ZEROS.
  2507 01  ERCTBL-FILE-STATUS      PIC XX VALUE ZEROS.
  2508 01  ERMEBL-FILE-STATUS      PIC XX VALUE ZEROS.
  2509 01  ERRTBL-FILE-STATUS      PIC XX VALUE ZEROS.
  2510 01  ERRESC-FILE-STATUS      PIC XX VALUE ZEROS.
  2511 01  ERAGTC-FILE-STATUS      PIC XX VALUE ZEROS.
  2512 01  ELCRTT-FILE-STATUS      PIC XX VALUE ZEROS.
  2513
  2514 01  MONTHS-DIFF-LF          PIC S9(05) VALUE +0.
  2515 01  MONTHS-DIFF-AH          PIC S9(05) VALUE +0.
  2516 01  WS-CR-BIN-DATE          PIC XX VALUE LOW-VALUES.
  2517 01  WS-BIN-CANCEL-DATE      PIC XX VALUE LOW-VALUES.
  2518
  2519 01  WS-LEVELS-CHARGEBACK-SWITCHES.
  2520     12  WS-LF-CHARGEBACK-LEVELS.
  2521         16  WS-LF-CHARGEBACK-SW   PIC X(01) OCCURS 10 TIMES.
  2522     12  WS-AH-CHARGEBACK-LEVELS.
  2523         16  WS-AH-CHARGEBACK-SW   PIC X(01) OCCURS 10 TIMES.
  2524*****************************************************************
  2525*        WORKING STORAGE AREA FOR CLIENT-DMD               START*
  2526*****************************************************************
  2527*RESIDENT STATE TAXES MASTER(ERRESC)
  2528*
  2529 01  WORK-AREAS.
  2530     12  WS-ERRESC-KEY.
  2531         16 WS-ERRESC-SEARCH-KEY.
  2532             20  WS-ERRESC-COMPANY-CD PIC  X.
  2533             20  WS-ERRESC-CARRIER    PIC  X.
  2534             20  WS-ERRESC-GROUP      PIC X(6).
  2535             20  WS-ERRESC-STATE      PIC XX.
  2536             20  WS-ERRESC-ACCOUNT    PIC X(10).
  2537         16 WS-ERRESC-RESIDUAL-KEY.
  2538             20  WS-ERRESC-AGENT      PIC X(10).
  2539             20  WS-ERRESC-RES-STATE  PIC XX.
  2540             20  WS-ERRESC-EXPIRE-DT  PIC 9(8) COMP-3.
  2541*                                          YYYYMMDD
  2542     12  WS-YYYYMMDD-DT               PIC 9(8).
  2543     12  WS-COMMISSION                PIC SV9(5) COMP-3.
  2544     12  WS-SUB                       PIC    99  COMP-3.
  2545     12  WS-SUB1                      PIC    99  COMP-3.
  2546*****************************************************************
  2547*        WORKING STORAGE AREA FOR CLIENT-DMD                 END*
  2548*****************************************************************
  2549
  2550 01  COMM-WORK-AREAS.
  2551     12  FILLER              PIC  X(17)
  2552         VALUE 'COMMON WORK AREAS'.
  2553     12  ACCT-COMM-LF        PIC SV9(5)  COMP-3.
  2554     12  ACCT-COMM-AH        PIC SV9(5)  COMP-3.
  2555     12  W-AH-ACTIVE         PIC S9(13)  COMP-3 VALUE ZEROS.
  2556     12  W-AH-CALC-B         PIC S9(13)  COMP-3 VALUE ZEROS.
  2557     12  W-AH-CLAIMS         PIC S9(13)  COMP-3 VALUE ZEROS.
  2558     12  W-AH-DATA-USED      PIC S9(13)  COMP-3 VALUE ZEROS.
  2559     12  W-AH-INACTIVE       PIC S9(13)  COMP-3 VALUE ZEROS.
  2560     12  W-AH-ISSUES         PIC S9(13)  COMP-3 VALUE ZEROS.
  2561     12  W-AH-REIN           PIC S9(13)  COMP-3 VALUE ZEROS.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  54
* ECS010P.cbl
  2562     12  W-AH-REISSUE        PIC S9(13)  COMP-3 VALUE ZEROS.
  2563     12  W-AH-REMTERM-0      PIC S9(13)  COMP-3 VALUE ZEROS.
  2564     12  W-AH-RESERVES       PIC S9(13)  COMP-3 VALUE ZEROS.
  2565     12  W-AH-RESV           PIC S9(13)  COMP-3 VALUE ZEROS.
  2566     12  W-AHTYP-99          PIC S9(13)  COMP-3 VALUE ZEROS.
  2567     12  W-BAL-REMTRM        PIC S9(05)V99  COMP-3.
  2568     12  W-CERT-COUNT        PIC S9(08)  COMP.
  2569     12  W-COUNT             PIC S9(08)  COMP   VALUE +0.
  2570     12  W-CLMAMT            PIC S9(07)V9(02)   VALUE ZEROS.
  2571     12  W-90-DAY-MAX        PIC S9(07)V9(02)   VALUE ZEROS.
  2572
  2573     12  W-EARNED-PREMIUM    PIC S9(07)V9(02)
  2574                                         COMP-3 VALUE ZEROS.
  2575     12  W-EARNED-PREMIUM-1  PIC S9(07)V9(02)
  2576                                         COMP-3 VALUE ZEROS.
  2577     12  W-EARNED-PREMIUM-2  PIC S9(07)V9(02)
  2578                                         COMP-3 VALUE ZEROS.
  2579     12  W-EDIT-FIELD        PIC ----------9.
  2580     12  W-EDIT-FIELD2       PIC ----------9.99.
  2581     12  W-EDIT-7            PIC Z(06)9.
  2582     12  W-FACTOR            PIC S9(09)V9(08)
  2583                                         COMP-3 VALUE ZEROS.
  2584     12  W-IBNR-1            PIC S9(07)V9(02)
  2585                                         COMP-3 VALUE ZEROS.
  2586     12  W-IBNR-2            PIC S9(07)V9(02)
  2587                                         COMP-3 VALUE ZEROS.
  2588     12  W-ISS-BEN           PIC S9(11)V9(02)
  2589                                         COMP-3 VALUE ZEROS.
  2590     12  W-ISS-BEN-GROSS     PIC S9(11)V9(02)
  2591                                         COMP-3 VALUE ZEROS.
  2592     12  W-LF-ACTIVE         PIC S9(13)  COMP-3 VALUE ZEROS.
  2593     12  W-LF-BALLOON        PIC S9(13)  COMP-3 VALUE ZEROS.
  2594     12  W-LF-CLAIMS         PIC S9(13)  COMP-3 VALUE ZEROS.
  2595     12  W-LF-CALC-B         PIC S9(13)  COMP-3 VALUE ZEROS.
  2596     12  W-LF-DATA-USED      PIC S9(13)  COMP-3 VALUE ZEROS.
  2597     12  W-LF-INACTIVE       PIC S9(13)  COMP-3 VALUE ZEROS.
  2598     12  W-LF-ISSUES         PIC S9(13)  COMP-3 VALUE ZEROS.
  2599     12  W-LF-REMAMT-0       PIC S9(13)  COMP-3 VALUE ZEROS.
  2600     12  W-LF-REMTERM-0      PIC S9(13)  COMP-3 VALUE ZEROS.
  2601     12  W-LF-REIN           PIC S9(13)  COMP-3 VALUE ZEROS.
  2602     12  W-LF-REISSUE        PIC S9(13)  COMP-3 VALUE ZEROS.
  2603     12  W-LF-RESERVES       PIC S9(13)  COMP-3 VALUE ZEROS.
  2604     12  W-LF-RESV           PIC S9(13)  COMP-3 VALUE ZEROS.
  2605     12  W-LFTYP-99          PIC S9(13)  COMP-3 VALUE ZEROS.
  2606     12  W-LIFE-YEARS        PIC S9(09)  COMP-3 VALUE ZEROS.
  2607     12  W-LIFE-YEARS-INT    PIC S9(09)V9(06)
  2608                                         COMP-3 VALUE ZEROS.
  2609     12  W-NDX               PIC S9(03)  COMP-3 VALUE ZEROS.
  2610     12  W-ORGTRM-0-AH       PIC S9(13)  COMP-3 VALUE ZEROS.
  2611     12  W-ORGTRM-0-LF       PIC S9(13)  COMP-3 VALUE ZEROS.
  2612     12  W-RET-CODE-AH       PIC S9(13)  COMP-3 VALUE ZEROS.
  2613     12  W-RET-CODE-LF       PIC S9(13)  COMP-3 VALUE ZEROS.
  2614     12  W-PENDING-CLMS      PIC S9(13)  COMP-3 VALUE ZEROS.
  2615     12  W-POL-ISSUES        PIC S9(13)  COMP-3 VALUE ZEROS.
  2616     12  W-POLICY-ACTIVE-CTR PIC S9(13)  COMP-3 VALUE ZEROS.
  2617     12  W-POLICY-INACTIVE-CTR
  2618                             PIC S9(13)  COMP-3 VALUE ZEROS.
  2619     12  W-POLICY-REISSUE-CTR
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  55
* ECS010P.cbl
  2620                             PIC S9(13)  COMP-3 VALUE ZEROS.
  2621     12  W-POLICY-REIN-CTR   PIC S9(13)  COMP-3 VALUE ZEROS.
  2622     12  W-POLICY-INACTIVE   PIC S9(13)  COMP-3 VALUE ZEROS.
  2623     12  W-TARGET-LOSS-RATIO PIC S9(01)V9(04)
  2624                                         COMP-3 VALUE ZEROS.
  2625     12  W-VAL-SOURCE        PIC S9(03)  COMP-3 VALUE ZEROS.
  2626     12  W-WK-IBNR           PIC S9(07)V9(02)
  2627                                         COMP-3 VALUE ZEROS.
  2628
  2629     12  W-CLAIM-TYPE        PIC  X(01).
  2630         88  W-A-H                              VALUE 'A'.
  2631         88  W-LIFE                             VALUE 'L'.
  2632     12  W-CUTOFF-DATE       PIC  9(08).
  2633     12  W-DIS-DT            PIC  XX.
  2634     12  W-DIS-PTO-DT        PIC  XX.
  2635     12  WK-LEVEL.
  2636         16  WK-AGT          PIC X(10).
  2637         16  WK-A-TYPE       PIC X.
  2638         16  WK-L-RT         PIC SV9(5)  COMP-3.
  2639         16  WK-J-RT         PIC SV9(5)  COMP-3.
  2640         16  WK-A-RT         PIC SV9(5)  COMP-3.
  2641         16  FILLER          PIC X(6).
  2642     12  WK-LEVEL-R REDEFINES WK-LEVEL.
  2643         16  FILLER          PIC X(11).
  2644         16  WK-L-RTX        PIC X(3).
  2645         16  WK-J-RTX        PIC X(3).
  2646         16  WK-A-RTX        PIC X(3).
  2647         16  FILLER          PIC X(6).
  2648     12  WK-NEW-RATES.
  2649         16  WK-N-R      OCCURS 10.
  2650             20  WK-N-AGT    PIC X(10).
  2651             20  WK-N-TYPE   PIC X.
  2652             20  WK-L-RT1    PIC SV9(5)  COMP-3.
  2653             20  WK-A-RT1    PIC SV9(5)  COMP-3.
  2654     12  W-LIFE-YEARS-ZERO.
  2655         16  FILLER          PIC  X(06)         VALUE ZEROS.
  2656         16  FILLER          PIC  X(01)         VALUE SPACES.
  2657         16  FILLER          PIC  X(02)         VALUE ZEROS.
  2658         16  FILLER          PIC  X(01)         VALUE SPACES.
  2659         16  FILLER          PIC  X(01)         VALUE SPACES.
  2660         16  FILLER          PIC  X(01)         VALUE SPACES.
  2661         16  FILLER          PIC S9(09)  COMP-3 VALUE ZEROS.
  2662         16  FILLER          PIC S9(09)  COMP-3 VALUE ZEROS.
  2663         16  FILLER          PIC S9(09)  COMP-3 VALUE ZEROS.
  2664         16  FILLER          PIC S9(09)  COMP-3 VALUE ZEROS.
  2665         16  FILLER          PIC S9(09)  COMP-3 VALUE ZEROS.
  2666         16  FILLER          PIC S9(09)  COMP-3 VALUE ZEROS.
  2667         16  FILLER          PIC S9(09)  COMP-3 VALUE ZEROS.
  2668         16  FILLER          PIC S9(09)  COMP-3 VALUE ZEROS.
  2669         16  FILLER          PIC S9(09)  COMP-3 VALUE ZEROS.
  2670         16  FILLER          PIC S9(09)  COMP-3 VALUE ZEROS.
  2671         16  FILLER          PIC S9(09)  COMP-3 VALUE ZEROS.
  2672         16  FILLER          PIC S9(09)  COMP-3 VALUE ZEROS.
  2673         16  FILLER          PIC S9(09)  COMP-3 VALUE ZEROS.
  2674         16  FILLER          PIC S9(09)V9(02) COMP-3
  2675                                                VALUE ZEROS.
  2676         16  FILLER          PIC S9(09)V9(02) COMP-3
  2677                                                VALUE ZEROS.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  56
* ECS010P.cbl
  2678         16  FILLER          PIC S9(09)V9(02) COMP-3
  2679                                                VALUE ZEROS.
  2680         16  FILLER          PIC S9(09)V9(02) COMP-3
  2681                                                VALUE ZEROS.
  2682         16  FILLER          PIC S9(11)V9(02) COMP-3
  2683                                                VALUE ZEROS.
  2684
  2685     12  W-REIN-PROCESS-IND  PIC  X(01)         VALUE SPACES.
  2686         88 W-REIN-IN-PROCESS                   VALUE 'Y'.
  2687     12  W-REIN-PROCESS-SW   PIC  X(01)         VALUE SPACES.
  2688         88  W-REIN-PROCESS                     VALUE 'Y'.
  2689         88  W-NOT-REIN-PROCESS                 VALUE SPACES.
  2690     12  W-SELECTION-SW      PIC  X(01)         VALUE SPACES.
  2691         88  W-SELECTION-ON                     VALUE 'Y'.
  2692         88  W-SELECTION-OFF                    VALUE SPACES.
  2693     12  W-RTRM-0-SW         PIC  X(01)         VALUE SPACES.
  2694         88  W-RTRM-0                           VALUE 'Y'.
  2695         88  W-RTRM-NOT-0                       VALUE SPACES.
  2696     12  W-SUB-KEY           PIC  X(03)         VALUE SPACES.
  2697     12  W-TABLE-USED-SW     PIC  X(01)         VALUE SPACES.
  2698         88  W-TABLE-USED                       VALUE 'Y'.
  2699         88  W-TABLE-NOT-USED                   VALUE SPACES.
  2700     12  W-UNDERWRITING-SW   PIC  X             VALUE SPACES.
  2701         88  W-UNDERWRITTEN-DATA                VALUE '*'.
  2702
  2703     12  W-VAL-ERRORS.
  2704         16  FILLER          PIC  X(40)
  2705             VALUE 'PENDING CANC PROCESS - CR-LF-CANC-DT - '.
  2706         16  FILLER          PIC  X(40)
  2707             VALUE 'EPEC PROCESS - LIFE - RUN DATE - '.
  2708         16  FILLER          PIC  X(40)
  2709             VALUE 'EPEC CANCEL - LIFE - CR-LF-CANC-DT - '.
  2710         16  FILLER          PIC  X(40)
  2711             VALUE 'EPEC CANCEL LIFE SUM - CR-LF-CANC-DT - '.
  2712         16  FILLER          PIC  X(40)
  2713             VALUE 'EOM RUN DATE - EPEC - COMM - '.
  2714         16  FILLER          PIC  X(40)
  2715             VALUE 'RUN DATE EPEC - A&H - '.
  2716         16  FILLER          PIC  X(40)
  2717             VALUE 'CUTOFF DTE (OPT-MTHD) - '.
  2718         16  FILLER          PIC  X(40)
  2719             VALUE 'EOM RUN DATE - A&H EARNED PREMIUM - '.
  2720         16  FILLER          PIC  X(40)
  2721             VALUE 'EARNINGS START DATE - REIN CO RCD - '.
  2722     12  FILLER REDEFINES W-VAL-ERRORS.
  2723         16  W-VAL-ERROR OCCURS 9 TIMES
  2724                             PIC  X(40).
  2725
  2726     12  W-WORK-DATE         PIC  X(02).
  2727     12  SAVE-WK-NEW-RATES.
  2728         16  FILLER          PIC X(170).
  2729
  2730***   The following data area is for NCL only
  2731*    12  W-WORK-OB-DATA OCCURS 300.
  2732*    12  W-WORK-OB-DATA OCCURS 220.
  2733     12  W-WORK-OB-DATA OCCURS 900.
  2734         16  WS-OB-REIN-CO       PIC X(06).
  2735         16  WS-OB-LF-AH         PIC X.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  57
* ECS010P.cbl
  2736         16  WS-OB-BENEFIT-CODE  PIC XX.
  2737         16  WS-OB-EARNED OCCURS 3.
  2738             20  WS-EPR-R78   PIC S9(09)V99 COMP-3.
  2739
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  58
* ECS010P.cbl
  2741 01  EPEC-WORK-AREAS.
  2742     12  WE-REIN-CO          PIC X(6).
  2743     12  WE-LF-AH            PIC X.
  2744     12  WE-BEN-TYPE         PIC XX.
  2745     12  WE-LFAMT            PIC S9(9)V99    COMP-3.
  2746     12  WE-LFPRM            PIC S9(7)V99    COMP-3.
  2747     12  WE-LFAMT-ALT        PIC S9(9)V99    COMP-3.
  2748     12  WE-LFPRM-ALT        PIC S9(7)V99    COMP-3.
  2749     12  WE-LFRFND           PIC S9(7)V99    COMP-3.
  2750     12  WE-DTHAMT           PIC S9(9)V99    COMP-3.
  2751     12  WE-DTHEXP           PIC S9(9)V99    COMP-3.
  2752     12  WE-NUM-DTH-CLM      PIC S999        COMP-3.
  2753     12  WE-DTH-IBNR         PIC S9(7)V99    COMP-3.
  2754     12  WE-DTH-PAYCUR       PIC S9(7)V99    COMP-3.
  2755     12  WE-DTH-FUTRSV       PIC S9(7)V99    COMP-3.
  2756     12  WE-AHAMT            PIC S9(9)V99    COMP-3.
  2757     12  WE-AHPRM            PIC S9(7)V99    COMP-3.
  2758     12  WE-AHRFND           PIC S9(7)V99    COMP-3.
  2759     12  WE-DSPY-AMT         PIC S9(9)V99    COMP-3.
  2760     12  WE-DSPY-EXP         PIC S9(9)V99    COMP-3.
  2761     12  WE-NUM-DIS-CLM      PIC S999        COMP-3.
  2762     12  WE-DIS-IBNR         PIC S9(7)V99    COMP-3.
  2763     12  WE-DIS-PAYCUR       PIC S9(7)V99    COMP-3.
  2764     12  WE-DIS-FUTRSV       PIC S9(7)V99    COMP-3.
  2765     12  ISS-BEN             PIC S9(9)V99    COMP-3.
  2766     12  CNC-BEN             PIC S9(9)V99    COMP-3.
  2767     12  ISS-PRM             PIC S9(7)V99    COMP-3.
  2768     12  ISS-PRMTAX          PIC S9(7)V99    COMP-3.
  2769     12  CNC-PRM             PIC S9(7)V99    COMP-3.
  2770     12  GROSS-ISS-BEN-LF    PIC S9(9)V99    COMP-3.
  2771     12  GROSS-CNC-BEN-LF    PIC S9(9)V99    COMP-3.
  2772     12  GROSS-ISS-PRM-LF    PIC S9(7)V99    COMP-3.
  2773     12  GROSS-CNC-PRM-LF    PIC S9(7)V99    COMP-3.
  2774     12  GROSS-ISS-BEN-AH    PIC S9(7)V99    COMP-3.
  2775     12  GROSS-CNC-BEN-AH    PIC S9(7)V99    COMP-3.
  2776     12  GROSS-ISS-PRM-AH    PIC S9(7)V99    COMP-3.
  2777     12  GROSS-CNC-PRM-AH    PIC S9(7)V99    COMP-3.
  2778     12  EARNED-BY-CANCEL    PIC S9(7)V99    COMP-3.
  2779     12  EPR-R78             PIC S9(7)V99    COMP-3.
  2780     12  EPR-PRO             PIC S9(7)V99    COMP-3.
  2781     12  EPR-ST              PIC S9(7)V99    COMP-3.
  2782     12  W-OPT-R78           PIC S9(7)V99    COMP-3.
  2783     12  W-OPT-PRO           PIC S9(7)V99    COMP-3.
  2784     12  W-OPT-ST            PIC S9(7)V99    COMP-3.
  2785     12  WX-ACTIVE-COUNT     PIC S9          COMP-3.
  2786     12  WX-CANC-DT          PIC 9(11)       COMP-3.
  2787     12  WX-CLM-AMT          PIC S9(9)V99    COMP-3.
  2788     12  WX-CLM-EXP          PIC S9(9)V99    COMP-3.
  2789     12  WX-CLM-CNT          PIC S9(7)       COMP-3.
  2790     12  WX-CLM-CRT          PIC S9(7)       COMP-3.
  2791     12  WX-CNC-CNT          PIC S9(7)       COMP-3.
  2792     12  WX-CLAIM-EXIT-DATE  PIC  9(11)      COMP-3.
  2793     12  WX-SETTLEMENT-EXIT-DATE
  2794                             PIC  9(11)      COMP-3.
  2795     12  WX-STATUS-AT-CANCEL PIC  X(1).
  2796     12  WX-STATUS-AT-DEATH  PIC  X(1).
  2797     12  WX-STATUS-AT-SETTLEMENT
  2798                             PIC  X(1).
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  59
* ECS010P.cbl
  2799     12  WX-EOM-RUN-DATE     PIC  9(11)      COMP-3.
  2800
  2801 01  EPEC-WORK.
  2802     12  EW-REIN-CO          PIC X(6).
  2803     12  EW-SUB-KEY.
  2804         16  EW-LF-AH        PIC X.
  2805         16  EW-BEN-TYPE     PIC XX.
  2806     12  EW-ISS-BEN          PIC S9(11)V99   COMP-3.
  2807     12  EW-ISS-BEN-GROSS    PIC S9(11)V99   COMP-3.
  2808     12  EW-CNC-BEN          PIC S9(11)V99   COMP-3.
  2809     12  EW-CNC-BEN-GROSS    PIC S9(11)V99   COMP-3.
  2810     12  EW-ISS-PRM          PIC S9(9)V99    COMP-3.
  2811     12  EW-ISS-PRM-GROSS    PIC S9(9)V99    COMP-3.
  2812     12  EW-CNC-PRM          PIC S9(9)V99    COMP-3.
  2813     12  EW-CNC-PRM-GROSS    PIC S9(9)V99    COMP-3.
  2814     12  EW-EPR-R78          PIC S9(9)V99    COMP-3.
  2815     12  EW-EPR-R78-ADJ      PIC S9(9)V99    COMP-3.
  2816     12  EW-EPR-PRO          PIC S9(9)V99    COMP-3.
  2817     12  EW-EPR-PRO-ADJ      PIC S9(9)V99    COMP-3.
  2818     12  EW-EPR-ST           PIC S9(9)V99    COMP-3.
  2819     12  EW-EPR-ST-ADJ       PIC S9(9)V99    COMP-3.
  2820     12  EW-CLM-AMT          PIC S9(9)V99    COMP-3.
  2821     12  EW-CLM-IBNR         PIC S9(7)V99    COMP-3.
  2822     12  EW-CLM-PAYCUR       PIC S9(7)V99    COMP-3.
  2823     12  EW-CLM-FUTRSV       PIC S9(7)V99    COMP-3.
  2824     12  EW-CLM-CNT          PIC S9(7)       COMP-3.
  2825     12  EW-CLM-CRT          PIC S9(7)       COMP-3.
  2826     12  EW-ISS-CNT          PIC S9(7)       COMP-3.
  2827     12  EW-CNC-CNT          PIC S9(7)       COMP-3.
  2828     12  EW-ISS-PRM-TAX      PIC S9(7)V99    COMP-3.
  2829     12  EW-AGENTS       OCCURS 10.
  2830         16  EW-AGT-NO       PIC X(10).
  2831         16  EW-AGT-TYPE     PIC X.
  2832         16  EW-ISS-COM      PIC S9(9)V99    COMP-3.
  2833         16  EW-CNC-COM      PIC S9(9)V99    COMP-3.
  2834         16  EW-ECR-R78      PIC S9(9)V99    COMP-3.
  2835         16  EW-ECR-R78-ADJ  PIC S9(9)V99    COMP-3.
  2836         16  EW-ECR-PRO      PIC S9(9)V99    COMP-3.
  2837         16  EW-ECR-PRO-ADJ  PIC S9(9)V99    COMP-3.
  2838         16  EW-ECR-ST       PIC S9(9)V99    COMP-3.
  2839     12  EW-COV-DTE          PIC 9(11)       COMP-3.
  2840     12  EW-INFORCE-CNT      PIC S9(9)       COMP-3.
  2841     12  EW-ORIG-TERM        PIC S9(9)       COMP-3.
  2842     12  EW-REM-TERM         PIC S9(9)       COMP-3.
  2843     12  EW-AGE              PIC S9(9)       COMP-3.
  2844     12  EW-AGE-BEN          PIC S9(11)      COMP-3.
  2845     12  EW-TERM-BEN         PIC S9(11)      COMP-3.
  2846     12  EW-LEVEL-USED       PIC X.
  2847
  2848 01  EPEC-TOTALS.
  2849     12  EPEC-LEVELS     OCCURS 900.
  2850*    12  EPEC-LEVELS     OCCURS 220.
  2851*    12  EPEC-LEVELS     OCCURS 300.
  2852         16  EPEC-REIN-CO          PIC X(6).
  2853         16  EPEC-SUB-KEY.
  2854             24  EPEC-LF-AH        PIC X.
  2855             24  EPEC-BEN-TYPE     PIC XX.
  2856*        16  FILLER                PIC X(694).
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  60
* ECS010P.cbl
  2857         16  FILLER                PIC X(699).
  2858     12  EPEC-LEVELS-END           PIC X(6).
  2859
  2860 01  EPEC-UNDERWRITTEN-TOTALS.
  2861     12  EPEC-LEVELS-II  OCCURS 900.
  2862*    12  EPEC-LEVELS-II  OCCURS 220.
  2863*    12  EPEC-LEVELS-II  OCCURS 300.
  2864         16  EPEC-REIN-CO-II       PIC X(6).
  2865         16  EPEC-SUB-KEY-II.
  2866             24  EPEC-LF-AH-II     PIC X.
  2867             24  EPEC-BEN-TYPE-II  PIC XX.
  2868*        16  FILLER                PIC X(694).
  2869         16  FILLER                PIC X(699).
  2870     12  EPEC-LEVELS-END-II        PIC X(6).
  2871
  2872
  2873 01  FILLER                      PIC  X(11)
  2874                                 VALUE 'OPT RSV TBL'.
  2875*
  2876* THE 'PIC' VALUE OF THE NEXT 2 DATA NAMES IS 300 OCCURANCES
  2877*  TIMES THE SIZE OF THE DATA NAME THAT OCCURS.
  2878*  EX: EPEC-OPT-GRP  (300) TIMES THE TOTAL SIZE OF FIELDS IN
  2879*      EPEC-OPT-GRP  (108)
  2880*
  2881*      300 X 108 = 32400.
  2882*
  2883 01  EPEC-OPT-DATA-TABLE.
  2884*    12  FILLER                  PIC X(32400).
  2885*    12  FILLER                  PIC X(23760).
  2886     12  FILLER                  PIC X(97200).
  2887
  2888 01  FILLER                      PIC  X(16)
  2889                                 VALUE 'OPT RSV TBL UNDW'.
  2890 01  EPEC-UNDW-OPT-DATA-TABLE.
  2891*    12  FILLER                  PIC X(32400).
  2892*    12  FILLER                  PIC X(23760).
  2893     12  FILLER                  PIC X(97200).
  2894
  2895 01  FILLER                      PIC  X(16)
  2896                                 VALUE 'OPT RSV TBL WORK'.
  2897 01  EPEC-OPT-WORK-TABLE.
  2898*    12  EPEC-OPT-GRP        OCCURS 300.
  2899*    12  EPEC-OPT-GRP        OCCURS 220.
  2900     12  EPEC-OPT-GRP        OCCURS 900.
  2901         16  EPEC-REIN-CO-OPT
  2902                             PIC  X(06).
  2903         16  EPEC-SUB-KEY-OPT.
  2904             24  EPEC-LF-AH-OPT
  2905                             PIC  X(01).
  2906             24  EPEC-BEN-TYPE-OPT
  2907                             PIC  X(02).
  2908         16  EPEC-OPT-DATA.
  2909             20  EPEC-REIN-ONLY-IND
  2910                             PIC  X(01).
  2911                 88  EPEC-REIN-ONLY-DATA   VALUE 'R'.
  2912             20  EPEC-LINE-NOT-USED-IND
  2913                             PIC  X(01).
  2914                 88  EPEC-LINE-NOT-USED    VALUE 'N'.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  61
* ECS010P.cbl
  2915             20  EPEC-LIFE-CTR-USED-IND
  2916                             PIC  X(01).
  2917                 88  EPEC-LIFE-CTR-USED    VALUE 'Y'.
  2918                 88  EPEC-LIFE-CTR-NOT-USED
  2919                                           VALUE ' '.
  2920             20  EPEC-LIFE-CTR   OCCURS 13 TIMES
  2921                             PIC S9(09)       COMP-3.
  2922             20  EPEC-EARNED-PREMIUM-AH
  2923                             PIC S9(09)V9(02) COMP-3.
  2924             20  EPEC-CLAIMS-MADE-PAID
  2925                             PIC S9(09)V9(02) COMP-3.
  2926             20  EPEC-CLM-EXP
  2927                             PIC S9(09)V9(02) COMP-3.
  2928             20  EPEC-LIFE-IBNR
  2929                             PIC S9(09)V9(02) COMP-3.
  2930             20  EPEC-REIN-ISS-BEN
  2931                             PIC S9(11)V9(02) COMP-3.
  2932
  2933 01  FILLER                  PIC X(09)
  2934                                 VALUE 'EOM TABLE'.
  2935
  2936 01  EOM-DATE-TABLE.
  2937     12  EOM-DATE            OCCURS 13
  2938                             PIC 9(08).
  2939
  2940 01  EPEC-SUBS.
  2941     12  EPEC-SUB-LEVELS OCCURS 31.
  2942         16  EPEC-SUB-REIN   PIC X(6).
  2943         16  EPEC-SUB-LF     PIC S999  COMP  OCCURS 900.
  2944         16  EPEC-SUB-AH     PIC S999  COMP  OCCURS 900.
  2945     12  EPEC-SUBS-END       PIC X(6).
  2946
  2947 01  SAVE-REIN-WORK.
  2948     12  REIN-SUB-1          PIC S9(4)   COMP    VALUE +0.
  2949     12  REIN-SUB-2          PIC S9(4)   COMP    VALUE +0.
  2950     12  REIN-MAX            PIC S9(4)   COMP    VALUE +32.
  2951     12  REIN-LOW-TIME       PIC 9(6)            VALUE 999999.
  2952     12  REIN-LOW-SUB        PIC S9(4)   COMP    VALUE +1.
  2953
  2954 01  SAVE-REIN-TABLE.
  2955     12  SAVE-REIN-ENTRY     OCCURS 32 TIMES.
  2956         16  SR-TIME         PIC 9(6).
  2957         16  SR-ENTRY.
  2958             20  FILLER      PIC XX.
  2959             20  SR-CONTROL  PIC X(8).
  2960             20  FILLER      PIC X(3990).
  2961
  2962
* 2963                             COPY ECSRITAB.
  2964******************************************************************04/29/98
  2965*                                                                *ECSRITAB
  2966*                            ECSRITAB                            *   LV015
  2967*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL*15
  2968*                            VMOD=2.015                          *ECSRITAB
  2969*                                                                *ECSRITAB
  2970*  NO  CID  MODS  IN  COPYBOOK  ECSRITAB                         *ECSRITAB
  2971*                                                                *ECSRITAB
  2972******************************************************************ECSRITAB
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  62
* ECS010P.cbl (/apps/prod/cid1p/copy/ECSRITAB)
  2973 01  REIN-WORK-AREAS.                                             ECSRITAB
  2974     12  RW-LFAMT                PIC S9(9)V99  VALUE +0   COMP-3. ECSRITAB
  2975     12  RW-AHWRK                PIC S9(9)V99  VALUE +0   COMP-3. ECSRITAB
  2976     12  RW-LFPRM                PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  2977     12  RW-LFPRMC               PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  2978     12  RW-LFRFND               PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  2979     12  RW-AHPRM                PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  2980     12  RW-AHPRMC               PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  2981     12  RW-AHRFND               PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  2982     12  RW-LFCLMWK              PIC S9(9)V99  VALUE +0   COMP-3. ECSRITAB
  2983     12  RW-AHCLMWK              PIC S9(9)V99  VALUE +0   COMP-3. ECSRITAB
  2984     12  RW-AH-INCURRED-DETAIL.                                   ECSRITAB
  2985         16  RW-AH-INCURRED-DATA OCCURS 5 TIMES.                  ECSRITAB
  2986             20  RW-AH-INCUR-DT  PIC 9(11) COMP-3.                   CL**2
  2987             20  RW-AH-CLM-AMT   PIC S9(9)V99             COMP-3. ECSRITAB
  2988             20  RW-AH-CLM-EXP   PIC S9(9)V99             COMP-3. ECSRITAB
  2989     12  RW-LFCLM                PIC S9(9)V99  VALUE +0   COMP-3. ECSRITAB
  2990     12  RW-AHCLM                PIC S9(9)V99  VALUE +0   COMP-3. ECSRITAB
  2991     12  RW-AH-LIMIT             PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  2992     12  RW-LFIBNR               PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  2993     12  RW-LFPAYCUR             PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  2994     12  RW-LFFUTRSV             PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  2995     12  RW-AHIBNR               PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  2996     12  RW-AHPAYCUR             PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  2997     12  RW-AHFUTRSV             PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  2998     12  RW-LFIBNRWK             PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  2999     12  RW-LFPAYCURWK           PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  3000     12  RW-LFFUTRSVWK           PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  3001     12  RW-AHIBNRWK             PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  3002     12  RW-AHPAYCURWK           PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  3003     12  RW-AHFUTRSVWK           PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  3004     12  RW-AHLIM-LO             PIC S9(9)V99  VALUE +0   COMP-3. ECSRITAB
  3005     12  RW-AHLIM-HI             PIC S9(9)V99  VALUE +0   COMP-3. ECSRITAB
  3006     12  RW-ACCUM-LF             PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  3007     12  RW-ACCUM-AH             PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  3008     12  RW-ACCUM-CLM            PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  3009     12  RW-ACCUM-IBNR           PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  3010     12  RW-ACCUM-PAYCUR         PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  3011     12  RW-ACCUM-FUTRSV         PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  3012                                                                  ECSRITAB
  3013 01  REIN-HOLD-AREAS.                                             ECSRITAB
  3014     12  REIN-LEVELS       OCCURS 30 TIMES.                       ECSRITAB
  3015         16  REIN-COMP               PIC X(6).                    ECSRITAB
  3016         16  REIN-LF-AH-FLGS.                                     ECSRITAB
  3017             20  REIN-LF-FLG         PIC X.                       ECSRITAB
  3018             20  REIN-AH-FLG         PIC X.                       ECSRITAB
  3019         16  REIN-WORK-FLDS.                                      ECSRITAB
  3020             20  REIN-LFAMT          PIC S9(9)V99   COMP-3.       ECSRITAB
  3021             20  REIN-LFPRM          PIC S9(7)V99   COMP-3.       ECSRITAB
  3022             20  REIN-AHAMT          PIC S9(7)V99   COMP-3.       ECSRITAB
  3023             20  REIN-AHPRM          PIC S9(7)V99   COMP-3.       ECSRITAB
  3024             20  REIN-LFRFND         PIC S9(7)V99   COMP-3.       ECSRITAB
  3025             20  REIN-AHRFND         PIC S9(7)V99   COMP-3.       ECSRITAB
  3026             20  REIN-LFCLM          PIC S9(9)V99   COMP-3.       ECSRITAB
  3027             20  REIN-AHCLM          PIC S9(9)V99   COMP-3.       ECSRITAB
  3028             20  REIN-LFCLML         PIC S9(9)V99   COMP-3.       ECSRITAB
  3029             20  REIN-AHCLML         PIC S9(9)V99   COMP-3.       ECSRITAB
  3030             20  REIN-DIS-IBNR       PIC S9(7)V99   COMP-3.       ECSRITAB
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  63
* ECS010P.cbl (/apps/prod/cid1p/copy/ECSRITAB)
  3031             20  REIN-DIS-PAYCUR     PIC S9(7)V99   COMP-3.       ECSRITAB
  3032             20  REIN-DIS-FUTRSV     PIC S9(7)V99   COMP-3.       ECSRITAB
  3033             20  REIN-DIS-IBNRL      PIC S9(7)V99   COMP-3.       ECSRITAB
  3034             20  REIN-DIS-PAYCURL    PIC S9(7)V99   COMP-3.       ECSRITAB
  3035             20  REIN-DIS-FUTRSVL    PIC S9(7)V99   COMP-3.       ECSRITAB
  3036             20  REIN-DTH-IBNR       PIC S9(7)V99   COMP-3.       ECSRITAB
  3037             20  REIN-DTH-PAYCUR     PIC S9(7)V99   COMP-3.       ECSRITAB
  3038             20  REIN-DTH-FUTRSV     PIC S9(7)V99   COMP-3.       ECSRITAB
  3039             20  REIN-DTH-IBNRL      PIC S9(7)V99   COMP-3.       ECSRITAB
  3040             20  REIN-DTH-PAYCURL    PIC S9(7)V99   COMP-3.       ECSRITAB
  3041             20  REIN-DTH-FUTRSVL    PIC S9(7)V99   COMP-3.       ECSRITAB
  3042             20  REIN-AH-LIMIT       PIC S9(7)V99   COMP-3.       ECSRITAB
  3043             20  REIN-REM-SW         PIC X.                       ECSRITAB
  3044             20  REIN-REM-AH-100     PIC X.                       ECSRITAB
  3045             20  REIN-EP-STOP-DATE   PIC 9(11)      COMP-3.          CL**4
  3046             20  REIN-LF-RUNOFF-SW   PIC X.                       ECSRITAB
  3047             20  REIN-AH-RUNOFF-SW   PIC X.                       ECSRITAB
  3048     12  REIN-LEVELS-END             PIC X(6).                    ECSRITAB
  3049                                                                  ECSRITAB
  3050     12  RWF-FIELDS.                                              ECSRITAB
  3051         16  RWF-LFAMT               PIC S9(9)V99   COMP-3.       ECSRITAB
  3052         16  RWF-LFPRM               PIC S9(7)V99   COMP-3.       ECSRITAB
  3053         16  RWF-AHAMT               PIC S9(7)V99   COMP-3.       ECSRITAB
  3054         16  RWF-AHPRM               PIC S9(7)V99   COMP-3.       ECSRITAB
  3055         16  RWF-LFRFND              PIC S9(7)V99   COMP-3.       ECSRITAB
  3056         16  RWF-AHRFND              PIC S9(7)V99   COMP-3.       ECSRITAB
  3057         16  RWF-LFCLM               PIC S9(9)V99   COMP-3.       ECSRITAB
  3058         16  RWF-AHCLM               PIC S9(9)V99   COMP-3.       ECSRITAB
  3059         16  RWF-LFCLML              PIC S9(9)V99   COMP-3.       ECSRITAB
  3060         16  RWF-AHCLML              PIC S9(9)V99   COMP-3.       ECSRITAB
  3061         16  RWF-DIS-IBNR            PIC S9(7)V99   COMP-3.       ECSRITAB
  3062         16  RWF-DIS-PAYCUR          PIC S9(7)V99   COMP-3.       ECSRITAB
  3063         16  RWF-DIS-FUTRSV          PIC S9(7)V99   COMP-3.       ECSRITAB
  3064         16  RWF-DIS-IBNRL           PIC S9(7)V99   COMP-3.       ECSRITAB
  3065         16  RWF-DIS-PAYCURL         PIC S9(7)V99   COMP-3.       ECSRITAB
  3066         16  RWF-DIS-FUTRSVL         PIC S9(7)V99   COMP-3.       ECSRITAB
  3067         16  RWF-DTH-IBNR            PIC S9(7)V99   COMP-3.       ECSRITAB
  3068         16  RWF-DTH-PAYCUR          PIC S9(7)V99   COMP-3.       ECSRITAB
  3069         16  RWF-DTH-FUTRSV          PIC S9(7)V99   COMP-3.       ECSRITAB
  3070         16  RWF-DTH-IBNRL           PIC S9(7)V99   COMP-3.       ECSRITAB
  3071         16  RWF-DTH-PAYCURL         PIC S9(7)V99   COMP-3.       ECSRITAB
  3072         16  RWF-DTH-FUTRSVL         PIC S9(7)V99   COMP-3.       ECSRITAB
  3073         16  RWF-AH-LIMIT            PIC S9(7)V99   COMP-3.       ECSRITAB
  3074         16  RWF-REM-SW              PIC X.                       ECSRITAB
  3075         16  RWF-REM-AH-100          PIC X.                       ECSRITAB
  3076         16  RWF-EP-STOP-DATE        PIC 9(11)      COMP-3.          CL**3
  3077         16  RWF-LF-RUNOFF-SW        PIC X.                       ECSRITAB
  3078         16  RWF-AH-RUNOFF-SW        PIC X.                       ECSRITAB
  3079                                                                  ECSRITAB
  3080     12  WT-COMP-INFO.                                            ECSRITAB
  3081         16  WT-REI-COMP             PIC X(6).                    ECSRITAB
  3082         16  WT-LF-QC                PIC X.                       ECSRITAB
  3083         16  WT-AH-QC                PIC X.                       ECSRITAB
  3084         16  WT-LO-DATE              PIC 9(11)     COMP-3.           CL**2
  3085         16  WT-HI-DATE              PIC 9(11)     COMP-3.           CL**2
  3086         16  WT-LFAGE-LO             PIC 99.                      ECSRITAB
  3087         16  WT-LFAGE-HI             PIC 99.                      ECSRITAB
  3088         16  WT-AHAGE-LO             PIC 99.                      ECSRITAB
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  64
* ECS010P.cbl (/apps/prod/cid1p/copy/ECSRITAB)
  3089         16  WT-AHAGE-HI             PIC 99.                      ECSRITAB
  3090         16  WT-LFTRM-LO             PIC S999       COMP-3.       ECSRITAB
  3091         16  WT-LFTRM-HI             PIC S999       COMP-3.       ECSRITAB
  3092         16  WT-AHTRM-LO             PIC S999       COMP-3.       ECSRITAB
  3093         16  WT-AHTRM-HI             PIC S999       COMP-3.       ECSRITAB
  3094         16  WT-LF-PCT               PIC S9V9999    COMP-3.       ECSRITAB
  3095         16  WT-AH-PCT               PIC S9V9999    COMP-3.       ECSRITAB
  3096         16  WT-LF-LIM-LO            PIC S9(9)V99   COMP-3.       ECSRITAB
  3097         16  WT-LF-LIM-HI            PIC S9(9)V99   COMP-3.       ECSRITAB
  3098         16  WT-LF-LO                PIC S9(9)V99   COMP-3.       ECSRITAB
  3099         16  WT-LF-HI                PIC S9(9)V99   COMP-3.       ECSRITAB
  3100         16  WT-AHBEN-LIM-LO         PIC S9(7)V99   COMP-3.       ECSRITAB
  3101         16  WT-AHBEN-LIM-HI         PIC S9(7)V99   COMP-3.       ECSRITAB
  3102         16  WT-AHBEN-LO             PIC S9(7)V99   COMP-3.       ECSRITAB
  3103         16  WT-AHBEN-HI             PIC S9(7)V99   COMP-3.       ECSRITAB
  3104         16  WT-AHMOA-LIM-LO         PIC S9(7)V99   COMP-3.       ECSRITAB
  3105         16  WT-AHMOA-LIM-HI         PIC S9(7)V99   COMP-3.       ECSRITAB
  3106         16  WT-AHMOA-LO             PIC S9(7)V99   COMP-3.       ECSRITAB
  3107         16  WT-AHMOA-HI             PIC S9(7)V99   COMP-3.       ECSRITAB
  3108         16  WT-LF-BEN-CODE          PIC X.                       ECSRITAB
  3109         16  WT-AH-BEN-CODE          PIC X.                       ECSRITAB
  3110         16  WT-INTERACTIVE          PIC X.                       ECSRITAB
  3111         16  WT-REMAINING            PIC X.                       ECSRITAB
  3112         16  FILLER                  PIC X(21).                   ECSRITAB
  3113                                                                  ECSRITAB
  3114 01  REIN-MISC-WORK-FIELDS.                                       ECSRITAB
  3115     12  SUB1                    PIC S9(4)       COMP.            ECSRITAB
  3116     12  SUB2                    PIC S9(4)       COMP.            ECSRITAB
  3117     12  CO-SUB                  PIC S9(4)       COMP.            ECSRITAB
  3118     12  INC-SUB                 PIC S999        COMP.            ECSRITAB
  3119     12  MORTALITY-SUB           PIC S999        COMP.            ECSRITAB
  3120     12  REIN-FACTOR             PIC S99V9(7)  COMP-3   VALUE +0. ECSRITAB
  3121     12  REIN-CALCED-LIFE        PIC S9(7)V99  COMP-3   VALUE +0. ECSRITAB
  3122     12  REIN-CALCED-AH          PIC S9(7)V99  COMP-3   VALUE +0. ECSRITAB
  3123     12  REIN-RISK-AMOUNT        PIC S9(11)V99 COMP-3   VALUE +0. ECSRITAB
  3124     12  REIN-MONTH-REDUCE       PIC S9(7)V99  COMP-3   VALUE +0. ECSRITAB
  3125     12  REIN-CEDE-TERM          PIC S999V99   COMP-3   VALUE +0. ECSRITAB
  3126     12  REIN-WORKA              PIC S999      COMP-3   VALUE +0. ECSRITAB
  3127     12  REIN-EARN-LF-TERM       PIC S999      COMP-3   VALUE +0. ECSRITAB
  3128     12  REIN-EARN-AH-TERM       PIC S999      COMP-3   VALUE +0. ECSRITAB
  3129     12  REIN-LCNC-EARN-TERM     PIC S999      COMP-3   VALUE +0. ECSRITAB
  3130     12  REIN-ACNC-EARN-TERM     PIC S999      COMP-3   VALUE +0. ECSRITAB
  3131     12  REIN-LF-CLM-MONTHS      PIC S999      COMP-3   VALUE +0. ECSRITAB
  3132     12  REIN-AH-CLM-MONTHS      PIC S999      COMP-3   VALUE +0. ECSRITAB
  3133     12  REIN-AH-CLM-MTH-1       PIC S999      COMP-3   VALUE +0. ECSRITAB
  3134     12  REIN-AH-CLM-MTH-2       PIC S999      COMP-3   VALUE +0. ECSRITAB
  3135     12  REIN-AH-CLM-MTH-3       PIC S999      COMP-3   VALUE +0. ECSRITAB
  3136     12  REIN-AH-CLM-MTH-4       PIC S999      COMP-3   VALUE +0. ECSRITAB
  3137     12  REIN-AH-CLM-MTH-5       PIC S999      COMP-3   VALUE +0. ECSRITAB
  3138     12  REIN-AH-PRIOR-CLMS-PAID PIC S9(11)V99 COMP-3   VALUE +0. ECSRITAB
  3139                                                                  ECSRITAB
  3140     12  REIN-VOID-LF-SW         PIC X    VALUE ' '.              ECSRITAB
  3141         88  VOIDING-LF-CANCEL            VALUE '*'.              ECSRITAB
  3142     12  REIN-VOID-AH-SW         PIC X    VALUE ' '.              ECSRITAB
  3143         88  VOIDING-AH-CANCEL            VALUE '*'.              ECSRITAB
  3144     12  REIN-ADDL-LF-SW         PIC X    VALUE ' '.              ECSRITAB
  3145         88  ADDITIONAL-LF-CANCEL         VALUE '*'.              ECSRITAB
  3146     12  REIN-ADDL-AH-SW         PIC X    VALUE ' '.              ECSRITAB
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  65
* ECS010P.cbl (/apps/prod/cid1p/copy/ECSRITAB)
  3147         88  ADDITIONAL-AH-CANCEL         VALUE '*'.              ECSRITAB
  3148     12  REIN-CANCEL-LF-SW       PIC X    VALUE ' '.              ECSRITAB
  3149         88  FLAT-CANCEL-LF               VALUE '*'.              ECSRITAB
  3150     12  REIN-CANCEL-AH-SW       PIC X    VALUE ' '.              ECSRITAB
  3151         88  FLAT-CANCEL-AH               VALUE '*'.              ECSRITAB
  3152                                                                  ECSRITAB
  3153     12  REIN-BEN-CODE           PIC X.                           ECSRITAB
  3154         88  CEDING-SINGLE-PREM-ONLY      VALUE 'A'.              ECSRITAB
  3155         88  CEDING-OUT-BALANCE-ONLY      VALUE 'B'.              ECSRITAB
  3156         88  CEDING-REDUCING-ONLY         VALUE 'C'  'F'.         ECSRITAB
  3157         88  CEDING-LEVEL-ONLY            VALUE 'D'  'E'.         ECSRITAB
  3158         88  CEDING-GROUP-ONLY            VALUE 'G'.              ECSRITAB
  3159         88  CEDING-GROUP-RED-LIFE-ONLY   VALUE 'H'.              ECSRITAB
  3160         88  CEDING-INDIVIDUAL-ONLY       VALUE 'I'.              ECSRITAB
  3161         88  CEDING-JOINT-ONLY            VALUE 'J'.              ECSRITAB
  3162         88  CEDING-SGL-PREM-REDUCING     VALUE 'K'.              ECSRITAB
  3163         88  CEDING-SGL-PREM-GROUP        VALUE 'L'.              ECSRITAB
  3164         88  CEDING-GROUP-LEVEL-ONLY      VALUE 'M'.              ECSRITAB
  3165         88  CEDING-SGL-PREM-GRP-REDUCING VALUE 'N'.              ECSRITAB
  3166         88  CEDING-SGL-PREM-GROUP-LEVEL  VALUE 'P'.              ECSRITAB
  3167         88  CEDING-GROUP-REDUCING-ONLY   VALUE 'R'.              ECSRITAB
  3168         88  CEDING-SINGLE-POLICIES-ONLY  VALUE 'S'.              ECSRITAB
  3169         88  CEDING-AH-ONLY               VALUE '1'.              ECSRITAB
  3170         88  CEDING-PROPERTY-ONLY         VALUE '2'.              ECSRITAB
  3171         88  CEDING-UNEMPLOYMENT-ONLY     VALUE '3'.              ECSRITAB
  3172         88  CEDING-AD-D-ONLY             VALUE '4'.              ECSRITAB
  3173         88  CEDING-LIFE-ONLY             VALUE '5'.              ECSRITAB
  3174         88  CEDING-DISMEMBERMENT-ONLY    VALUE '6'.              ECSRITAB
  3175         88  CEDING-7-DAY-RETRO           VALUE '7'.              ECSRITAB
  3176         88  CEDING-14-DAY-RETRO          VALUE '8'.              ECSRITAB
  3177     12  REIN-OPEN-SW            PIC X           VALUE SPACE.     ECSRITAB
  3178     12  REIN-SEARCH.                                             ECSRITAB
  3179         16  REIN-SRCH-COMP-CD   PIC X           VALUE SPACE.     ECSRITAB
  3180         16  REIN-SRCH-CODE      PIC X           VALUE SPACE.     ECSRITAB
  3181         16  REIN-SRCH           PIC XXX         VALUE SPACE.     ECSRITAB
  3182         16  FILLER              PIC XXX         VALUE LOW-VALUE. ECSRITAB
  3183     12  SAVE-REIN-SRCH          PIC XXX         VALUE SPACE.     ECSRITAB
  3184     12  REIN-BUS-FLAG           PIC X           VALUE SPACE.     ECSRITAB
  3185     12  RATE-WORK               PIC S9(8)V9(5)  COMP-3.          ECSRITAB
  3186     12  RATE-WORK-L             PIC S9(8)V9(5)  COMP-3.          ECSRITAB
  3187     12  RATE-WORK-A             PIC S9(8)V9(5)  COMP-3.          ECSRITAB
  3188     12  RS-LIFE-BEN             PIC S9(9)V99  COMP-3   VALUE +0. ECSRITAB
  3189     12  RS-LIFE-PREM            PIC S9(7)V99  COMP-3   VALUE +0. ECSRITAB
  3190     12  RS-AH-BEN               PIC S9(9)V99  COMP-3   VALUE +0. ECSRITAB
  3191     12  RS-AH-PREM              PIC S9(7)V99  COMP-3   VALUE +0. ECSRITAB
  3192     12  RS-LP-CALC              PIC S9(7)V99  COMP-3   VALUE +0. ECSRITAB
  3193     12  RS-AP-CALC              PIC S9(7)V99  COMP-3   VALUE +0. ECSRITAB
  3194     12  RS-R-LB                 PIC S9(9)V99  COMP-3   VALUE +0. ECSRITAB
  3195     12  RS-R-LP                 PIC S9(7)V99  COMP-3   VALUE +0. ECSRITAB
  3196     12  RS-R-AB                 PIC S9(9)V99  COMP-3   VALUE +0. ECSRITAB
  3197     12  RS-R-AP                 PIC S9(7)V99  COMP-3   VALUE +0. ECSRITAB
  3198     12  RS-R-LPC                PIC S9(7)V99  COMP-3   VALUE +0. ECSRITAB
  3199     12  RS-R-APC                PIC S9(7)V99  COMP-3   VALUE +0. ECSRITAB
  3200     12  BIN-RWF-EP-STOP-DT      PIC XX        VALUE SPACES.      ECSRITAB
  3201     12  BIN-CNT                 PIC 9(3)      VALUE ZEROES.      ECSRITAB
  3202     12  BIN-CR-DIS-DT           PIC XX        VALUE SPACES.      ECSRITAB
  3203     12  BIN-WT-HIGH-DT          PIC XX        VALUE SPACES.      ECSRITAB
  3204     12  BIN-WT-LO-DT            PIC XX        VALUE SPACES.      ECSRITAB
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  66
* ECS010P.cbl (/apps/prod/cid1p/copy/ECSRITAB)
  3205     12  BIN-LF-CANC-DT          PIC XX        VALUE SPACES.      ECSRITAB
  3206     12  BIN-AH-CANC-DT          PIC XX        VALUE SPACES.      ECSRITAB
  3207     12  BIN-CR-DTH-DT           PIC XX        VALUE SPACES.      ECSRITAB
  3208                                                                  ECSRITAB
  3209 01  REIN-CO-HOLD-TABLE.                                          ECSRITAB
  3210* ELCPSEVR MUST BE MODIFIED IF THE "OCCURS" IS CHANGED.           ECSRITAB
  3211     12  REIN-CO-HOLD-ENTRIES  OCCURS 1500 TIMES.                 ECSRITAB
  3212         16  RCT-REIN-CO         PIC X(6).                        ECSRITAB
  3213         16  RCT-CLM-CUTOFF-DT   PIC 9(11)  COMP-3.               ECSRITAB
  3214         16  RCT-EARNING-START-DT PIC 9(11)  COMP-3.              ECSRITAB
  3215         16  RCT-EARNING-STOP-DT PIC 9(11)  COMP-3.               ECSRITAB
  3216         16  RCT-EARN-STOP-CODE  PIC X.                           ECSRITAB
  3217         16  RCT-LF-CLM-PCT      PIC S9V9(4)    COMP-3.           ECSRITAB
  3218         16  RCT-LF-CLM-MAX      PIC S9(9)V99   COMP-3.           ECSRITAB
  3219         16  RCT-AH-CLM-PCT      PIC S9V9(4)    COMP-3.           ECSRITAB
  3220         16  RCT-AH-CLM-MAX      PIC S9(9)V99   COMP-3.           ECSRITAB
  3221                                                                  ECSRITAB
  3222 01  REIN-CO-HOLD-TABLE-2.                                        ECSRITAB
  3223     12  RC2-CO-HOLD-ENTRIES  OCCURS 1500 TIMES.                  ECSRITAB
  3224         16  RC2-REIN-CO.                                         ECSRITAB
  3225             20  RC2-CO-PRIME    PIC XXX.                         ECSRITAB
  3226             20  RC2-CO-SUB      PIC XXX.                         ECSRITAB
  3227         16  RC2-LF-R78-PCT      PIC S9V9(4)    COMP-3.           ECSRITAB
  3228         16  RC2-LF-PRO-PCT      PIC S9V9(4)    COMP-3.           ECSRITAB
  3229         16  RC2-AH-R78-PCT      PIC S9V9(4)    COMP-3.           ECSRITAB
  3230         16  RC2-AH-PRO-PCT      PIC S9V9(4)    COMP-3.           ECSRITAB
  3231         16  RC2-CO-NAME         PIC X(30).                       ECSRITAB
  3232         16  RC2-ECS152-RPT      PIC X.                           ECSRITAB
  3233                                                                  ECSRITAB
  3234 01  REIN-MORT-CD-HOLD-TABLE.                                     ECSRITAB
  3235     12  REIN-MORT-CD-ENTRIES  OCCURS 1500 TIMES.                 ECSRITAB
  3236         16  RCT-MORT-CO         PIC X(6).                        ECSRITAB
  3237         16  RCT-MORT-CODE       PIC X(4).                        ECSRITAB
  3238     12  REIN-INDEX              PIC S9(4)    COMP    VALUE +0.   ECSRITAB
  3239                                                                  ECSRITAB
  3240 01  BIN-RCT-ITEMS-TABLE.                                         ECSRITAB
  3241     12  BIN-RCT-ITEMS OCCURS 1500 TIMES.                         ECSRITAB
  3242         16  BIN-RCT-CLM-CUTOFF-DT    PIC XX.                     ECSRITAB
  3243         16  BIN-RCT-EARNING-START-DT PIC XX.                     ECSRITAB
  3244         16  BIN-RCT-EARNING-STOP-DT  PIC XX.                     ECSRITAB
  3245 01  BIN-RW-ITEMS-TABLE.                                          ECSRITAB
  3246     12  BIN-RW-ITEMS OCCURS 5 TIMES.                             ECSRITAB
  3247         16  BIN-RW-AH-INCUR-DT       PIC XX.                     ECSRITAB
  3248                                                                  ECSRITAB
  3249 01  REIN-CO-TABLE-ENT-CNT       PIC S9(4)    COMP-3  VALUE +1500.ECSRITAB
  3250******************************************************************ECSRITAB
  3251
* 3252                             COPY ELCPSEVR.
  3253******************************************************************04/16/98
  3254*                                                                *ELCPSEVR
  3255*                                                                *ELCPSEVR
  3256*                            ELCPSEVR                            *   LV003
  3257*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  3258*                            VMOD=2.001                          *ELCPSEVR
  3259*                                                                *ELCPSEVR
  3260*   WORKING STORAGE FOR DATE VARIABLES CREATED                   *ELCPSEVR
  3261*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCPSEVR
  3262*                                                                *ELCPSEVR
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  67
* ECS010P.cbl (/apps/prod/cid1p/copy/ELCPSEVR)
  3263******************************************************************ELCPSEVR
  3264                                                                  ELCPSEVR
  3265 01  WS-PD-SUMMARY-DETAIL-EXTR-DT.                                ELCPSEVR
  3266     05  WS-PSC-CID-LOW.                                          ELCPSEVR
  3267         10  FILLER               PIC 999.                        ELCPSEVR
  3268         10  PSC-CID-LOW-CCYY     PIC 9(04).                      ELCPSEVR
  3269         10  PSC-CID-LOW-CCYR  REDEFINES  PSC-CID-LOW-CCYY.       ELCPSEVR
  3270             15  PSC-CID-LOW-CC   PIC 99.                            CL**3
  3271             15  PSC-CID-LOW-YY   PIC 99.                            CL**3
  3272         10  PSC-CID-LOW-MM       PIC 99.                            CL**3
  3273         10  PSC-CID-LOW-DD       PIC 99.                            CL**3
  3274     05  WS-PSC-CID-LOW-N REDEFINES                                  CL**2
  3275            WS-PSC-CID-LOW        PIC 9(11).                         CL**2
  3276     05  WS-PSC-CID-HIGH.                                         ELCPSEVR
  3277         10  FILLER              PIC 999.                         ELCPSEVR
  3278         10  PSC-CID-HIGH-CCYY   PIC 9(04).                       ELCPSEVR
  3279         10  PSC-CID-HIGH-CCYR  REDEFINES  PSC-CID-HIGH-CCYY.     ELCPSEVR
  3280             15  PSC-CID-HIGH-CC PIC 99.                             CL**3
  3281             15  PSC-CID-HIGH-YY PIC 99.                             CL**3
  3282         10  PSC-CID-HIGH-MM     PIC 99.                             CL**3
  3283         10  PSC-CID-HIGH-DD     PIC 99.                             CL**3
  3284     05  WS-PSC-CID-HIGH-N REDEFINES                                 CL**2
  3285            WS-PSC-CID-HIGH          PIC 9(11).                      CL**2
  3286 01  WS-REIN-WORK-AREAS.                                          ELCPSEVR
  3287     05  WS-REIN-CO-HOLD-ENTRIES  OCCURS 1500 TIMES               ELCPSEVR
  3288                 INDEXED BY CPSE-NDX.                             ELCPSEVR
  3289         10  WS-RCT-CLM-CUTOFF-DT.                                ELCPSEVR
  3290             15  FILLER              PIC 999.                     ELCPSEVR
  3291             15  RCT-CUTOFF-CCYY     PIC 9(04).                   ELCPSEVR
  3292             15  RCT-CUTOFF-CCYR  REDEFINES  RCT-CUTOFF-CCYY.     ELCPSEVR
  3293                 20  RCT-CUTOFF-CC   PIC 99.                      ELCPSEVR
  3294                 20  RCT-CUTOFF-YR   PIC 99.                      ELCPSEVR
  3295             15  RCT-CUTOFF-MO       PIC 99.                      ELCPSEVR
  3296             15  RCT-CUTOFF-DA       PIC 99.                      ELCPSEVR
  3297         10  WS-RCT-CLM-CUTOFF-DT-N REDEFINES                        CL**2
  3298                WS-RCT-CLM-CUTOFF-DT PIC 9(11).                      CL**2
  3299         10  WS-RCT-EARNING-START-DT.                             ELCPSEVR
  3300             15  FILLER              PIC 999.                     ELCPSEVR
  3301             15  RCT-START-CCYY      PIC 9(04).                   ELCPSEVR
  3302             15  RCT-START-CCYR  REDEFINES  RCT-START-CCYY.       ELCPSEVR
  3303                 20  RCT-START-CC    PIC 99.                      ELCPSEVR
  3304                 20  RCT-START-YR    PIC 99.                      ELCPSEVR
  3305             15  RCT-START-MO        PIC 99.                      ELCPSEVR
  3306             15  RCT-START-DA        PIC 99.                      ELCPSEVR
  3307         10  WS-RCT-EARNING-START-DT-N REDEFINES                     CL**2
  3308                WS-RCT-EARNING-START-DT  PIC 9(11).                  CL**2
  3309         10  WS-RCT-EARNING-STOP-DT.                              ELCPSEVR
  3310             15  FILLER              PIC 999.                     ELCPSEVR
  3311             15  RCT-STOP-CCYY       PIC 9(04).                   ELCPSEVR
  3312             15  RCT-STOP-CCYR  REDEFINES  RCT-STOP-CCYY.         ELCPSEVR
  3313                 20  RCT-STOP-CC     PIC 99.                      ELCPSEVR
  3314                 20  RCT-STOP-YR     PIC 99.                      ELCPSEVR
  3315             15  RCT-STOP-MO         PIC 99.                      ELCPSEVR
  3316             15  RCT-STOP-DA         PIC 99.                      ELCPSEVR
  3317         10  WS-RCT-EARNING-STOP-DT-N REDEFINES                      CL**2
  3318                WS-RCT-EARNING-STOP-DT   PIC 9(11).                  CL**2
  3319     05  WS-RWF-EP-STOP-DATE.                                     ELCPSEVR
  3320         10  FILLER              PIC 999.                         ELCPSEVR
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  68
* ECS010P.cbl (/apps/prod/cid1p/copy/ELCPSEVR)
  3321         10  RWF-EP-STOP-CCYY    PIC 9(04).                       ELCPSEVR
  3322         10  RWF-EP-STOP-CCYR REDEFINES  RWF-EP-STOP-CCYY.        ELCPSEVR
  3323             15  RWF-EP-STOP-CC  PIC 99.                          ELCPSEVR
  3324             15  RWF-EP-STOP-YR  PIC 99.                          ELCPSEVR
  3325         10  RWF-EP-STOP-MO      PIC 99.                          ELCPSEVR
  3326         10  RWF-EP-STOP-DA      PIC 99.                          ELCPSEVR
  3327     05  WS-RWF-EP-STOP-DATE-N REDEFINES                             CL**2
  3328            WS-RWF-EP-STOP-DATE  PIC 9(11).                          CL**2
  3329
* 3330                             COPY ELCEPCVR.
  3331******************************************************************05/15/98
  3332*                                                                *ELCEPCVR
  3333*                                                                *ELCEPCVR
  3334*                            ELCEPCVR                            *   LV003
  3335*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  3336*                            VMOD=2.001                          *ELCEPCVR
  3337*                                                                *ELCEPCVR
  3338*   WORKING STORAGE FOR DATE VARIABLES CREATED                   *ELCEPCVR
  3339*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCEPCVR
  3340*                                                                *ELCEPCVR
  3341******************************************************************ELCEPCVR
  3342 01  WS-EP-RECORD-DATE.                                           ELCEPCVR
  3343     05  WS-EP-EXP-DTE.                                           ELCEPCVR
  3344         10  FILLER            PIC 999.                           ELCEPCVR
  3345         10  EP-EXP-CCYY       PIC 9(04).                         ELCEPCVR
  3346         10  EP-EXP-CCYR  REDEFINES  EP-EXP-CCYY.                 ELCEPCVR
  3347             15  EP-EXP-CC     PIC 99.                            ELCEPCVR
  3348             15  EP-EXP-YR     PIC 99.                            ELCEPCVR
  3349         10  EP-EXP-MO         PIC 99.                            ELCEPCVR
  3350         10  EP-EXP-DA         PIC 99.                            ELCEPCVR
  3351     05  WS-EP-EXP-DTE-N REDEFINES                                   CL**3
  3352            WS-EP-EXP-DTE      PIC 9(11).                            CL**3
  3353     05  WS-EC-EXP-DTE REDEFINES WS-EP-EXP-DTE.                      CL**5
  3354         10  FILLER            PIC 999.                              CL**5
  3355         10  EC-EXP-CCYY       PIC 9(04).                            CL**5
  3356         10  EC-EXP-CCYR  REDEFINES  EC-EXP-CCYY.                    CL**5
  3357             15  EC-EXP-CC     PIC 99.                               CL**5
  3358             15  EC-EXP-YR     PIC 99.                               CL**5
  3359         10  EC-EXP-MO         PIC 99.                               CL**5
  3360         10  EC-EXP-DA         PIC 99.                               CL**5
  3361     05  WS-EC-EXP-DTE-N REDEFINES                                   CL**5
  3362            WS-EC-EXP-DTE      PIC 9(11).                            CL**5
  3363     05  WS-EP-EFF-DTE.                                           ELCEPCVR
  3364         10  FILLER            PIC 999.                           ELCEPCVR
  3365         10  EP-EFF-CCYY       PIC 9(04).                         ELCEPCVR
  3366         10  EP-EFF-CCYR  REDEFINES  EP-EFF-CCYY.                 ELCEPCVR
  3367             15  EP-EFF-CC     PIC 99.                            ELCEPCVR
  3368             15  EP-EFF-YR     PIC 99.                            ELCEPCVR
  3369         10  EP-EFF-MO         PIC 99.                            ELCEPCVR
  3370         10  EP-EFF-DA         PIC 99.                            ELCEPCVR
  3371     05  WS-EP-EFF-DTE-N REDEFINES                                   CL**3
  3372            WS-EP-EFF-DTE      PIC 9(11).                            CL**3
  3373     05  WS-EC-EFF-DTE REDEFINES WS-EP-EFF-DTE.                      CL**5
  3374         10  FILLER            PIC 999.                              CL**5
  3375         10  EC-EFF-CCYY       PIC 9(04).                            CL**5
  3376         10  EC-EFF-CCYR  REDEFINES  EC-EFF-CCYY.                    CL**5
  3377             15  EC-EFF-CC     PIC 99.                               CL**5
  3378             15  EC-EFF-YR     PIC 99.                               CL**5
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  69
* ECS010P.cbl (/apps/prod/cid1p/copy/ELCEPCVR)
  3379         10  EC-EFF-MO         PIC 99.                               CL**5
  3380         10  EC-EFF-DA         PIC 99.                               CL**5
  3381     05  WS-EC-EFF-DTE-N REDEFINES                                   CL**5
  3382            WS-EC-EFF-DTE      PIC 9(11).                            CL**5
  3383     05  WS-EP-HI-COV-DT.                                         ELCEPCVR
  3384         10  FILLER            PIC 999.                           ELCEPCVR
  3385         10  EP-COV-CCYY       PIC 9(04).                         ELCEPCVR
  3386         10  EP-COV-CCYR  REDEFINES  EP-COV-CCYY.                 ELCEPCVR
  3387             15  EP-COV-CC     PIC 99.                            ELCEPCVR
  3388             15  EP-COV-YR     PIC 99.                            ELCEPCVR
  3389         10  EP-COV-MO         PIC 99.                            ELCEPCVR
  3390         10  EP-COV-DA         PIC 99.                            ELCEPCVR
  3391     05  WS-EP-HI-COV-DT-N REDEFINES                                 CL**3
  3392            WS-EP-HI-COV-DT    PIC 9(11).                            CL**3
  3393     05  WS-EP-HI-CERT.                                           ELCEPCVR
  3394         10  FILLER            PIC 999.                           ELCEPCVR
  3395         10  EP-HI-CCYY        PIC 9(04).                         ELCEPCVR
  3396         10  EP-HI-CCYR  REDEFINES  EP-HI-CCYY.                   ELCEPCVR
  3397             15  EP-HI-CC      PIC 99.                            ELCEPCVR
  3398             15  EP-HI-YR      PIC 99.                            ELCEPCVR
  3399         10  EP-HI-MO          PIC 99.                            ELCEPCVR
  3400         10  EP-HI-DA          PIC 99.                            ELCEPCVR
  3401     05  WS-EP-HI-CERT-N REDEFINES                                   CL**3
  3402            WS-EP-HI-CERT      PIC 9(11).                            CL**3
  3403     05  WS-EP-LO-CERT.                                           ELCEPCVR
  3404         10  FILLER            PIC 999.                           ELCEPCVR
  3405         10  EP-LO-CCYY        PIC 9(04).                         ELCEPCVR
  3406         10  EP-LO-CCYR  REDEFINES   EP-LO-CCYY.                  ELCEPCVR
  3407             15  EP-LO-CC      PIC 99.                            ELCEPCVR
  3408             15  EP-LO-YR      PIC 99.                            ELCEPCVR
  3409         10  EP-LO-MO          PIC 99.                            ELCEPCVR
  3410         10  EP-LO-DA          PIC 99.                            ELCEPCVR
  3411     05  WS-EP-LO-CERT-N REDEFINES                                   CL**3
  3412            WS-EP-LO-CERT      PIC 9(11).                            CL**3
  3413     05  WS-EP-RUN-DTE.                                           ELCEPCVR
  3414         10  FILLER            PIC 999.                           ELCEPCVR
  3415         10  EP-RUN-CCYY       PIC 9(04).                         ELCEPCVR
  3416         10  EP-RUN-CCYR  REDEFINES  EP-RUN-CCYY.                 ELCEPCVR
  3417             15  EP-RUN-CC     PIC 99.                            ELCEPCVR
  3418             15  EP-RUN-YR     PIC 99.                            ELCEPCVR
  3419         10  EP-RUN-MO         PIC 99.                            ELCEPCVR
  3420         10  EP-RUN-DA         PIC 99.                            ELCEPCVR
  3421     05  WS-EP-RUN-DTE-N REDEFINES                                   CL**3
  3422            WS-EP-RUN-DTE      PIC 9(11).                            CL**3
  3423     05  WS-EC-RUN-DTE REDEFINES WS-EP-RUN-DTE.                      CL**5
  3424         10  FILLER            PIC 999.                           ELCEPCVR
  3425         10  EC-RUN-CCYY       PIC 9(04).                         ELCEPCVR
  3426         10  EC-RUN-CCYR  REDEFINES  EC-RUN-CCYY.                 ELCEPCVR
  3427             15  EC-RUN-CC     PIC 99.                            ELCEPCVR
  3428             15  EC-RUN-YR     PIC 99.                            ELCEPCVR
  3429         10  EC-RUN-MO         PIC 99.                            ELCEPCVR
  3430         10  EC-RUN-DA         PIC 99.                            ELCEPCVR
  3431     05  WS-EC-RUN-DTE-N REDEFINES                                   CL**3
  3432            WS-EC-RUN-DTE      PIC 9(11).                            CL**3
  3433
* 3434                             COPY ELCREINV.
  3435******************************************************************04/18/98
  3436*                                                                *ELCREINV
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  70
* ECS010P.cbl (/apps/prod/cid1p/copy/ELCREINV)
  3437*                                                                *ELCREINV
  3438*                            ELCREINV                            *   LV003
  3439*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  3440*                            VMOD=2.001                          *ELCREINV
  3441*                                                                *ELCREINV
  3442*   WORKING STORAGE FOR DATE VARIABLES CREATED                   *ELCREINV
  3443*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCREINV
  3444*                                                                *ELCREINV
  3445******************************************************************ELCREINV
  3446                                                                  ELCREINV
  3447 01  WS-REINSURANCE-RECORD-DATE.                                  ELCREINV
  3448     05  WS-RE-LO-DATE.                                              CL**3
  3449         10 FILLER                     PIC 999.                      CL**3
  3450         10 RE-LO-CCYY                 PIC 9(04).                    CL**3
  3451         10 RE-LO-CCYR  REDEFINES  RE-LO-CCYY.                       CL**3
  3452            15 RE-LO-CC                PIC 99.                       CL**3
  3453            15 RE-LO-YR                PIC 99.                       CL**3
  3454         10 RE-LO-MO                   PIC 99.                       CL**3
  3455         10 RE-LO-DA                   PIC 99.                       CL**3
  3456     05  WS-RE-LO-DATE-N REDEFINES                                   CL**3
  3457            WS-RE-LO-DATE              PIC 9(11).                    CL**3
  3458     05  WS-RE-HI-DATE.                                              CL**3
  3459         10 FILLER                     PIC 999.                      CL**3
  3460         10 RE-HI-CCYY                 PIC 9(04).                    CL**3
  3461         10 RE-HI-CCYR  REDEFINES  RE-HI-CCYY.                       CL**3
  3462            15 RE-HI-CC                PIC 99.                       CL**3
  3463            15 RE-HI-YR                PIC 99.                       CL**3
  3464         10 RE-HI-MO                   PIC 99.                       CL**3
  3465         10 RE-HI-DA                   PIC 99.                       CL**3
  3466     05  WS-RE-HI-DATE-N REDEFINES                                   CL**3
  3467            WS-RE-HI-DATE              PIC 9(11).                    CL**3
  3468     05  WS-RE-CLM-INCURRED-LIM.                                  ELCREINV
  3469         10 FILLER                     PIC 999.                   ELCREINV
  3470         10 RE-CLM-CCYY                PIC 9(04).                 ELCREINV
  3471         10 RE-CLM-CCYR  REDEFINES  RE-CLM-CCYY.                  ELCREINV
  3472            15 RE-CLM-CC               PIC 99.                    ELCREINV
  3473            15 RE-CLM-YR               PIC 99.                    ELCREINV
  3474         10 RE-CLM-MO                  PIC 99.                    ELCREINV
  3475         10 RE-CLM-DA                  PIC 99.                    ELCREINV
  3476     05  WS-RE-CLM-INCURRED-LIM-N REDEFINES                          CL**2
  3477            WS-RE-CLM-INCURRED-LIM     PIC 9(11).                    CL**2
  3478     05  WS-RE-EARNING-START-DT.                                  ELCREINV
  3479         10  FILLER                    PIC 999.                   ELCREINV
  3480         10  RE-EARN-CCYY              PIC 9(04).                 ELCREINV
  3481         10  RE-EARN-CCYR  REDEFINES  RE-EARN-CCYY.               ELCREINV
  3482             15  RE-EARN-CC            PIC 99.                    ELCREINV
  3483             15  RE-EARN-YR            PIC 99.                    ELCREINV
  3484         10  RE-EARN-MO                PIC 99.                    ELCREINV
  3485         10  RE-EARN-DA                PIC 99.                    ELCREINV
  3486     05  WS-RE-EARNING-START-DT-N REDEFINES                          CL**2
  3487            WS-RE-EARNING-START-DT     PIC 9(11).                    CL**2
  3488     05  WS-RE-EARNING-STOP-DT.                                   ELCREINV
  3489         10  FILLER                    PIC 999.                   ELCREINV
  3490         10  RE-EARN-STOP-CCYY         PIC 9(04).                 ELCREINV
  3491         10  RE-EARN-STOP-CCYR  REDEFINES  RE-EARN-STOP-CCYY.     ELCREINV
  3492             15  RE-EARN-STOP-CC       PIC 99.                    ELCREINV
  3493             15  RE-EARN-STOP-YR       PIC 99.                    ELCREINV
  3494         10  RE-EARN-STOP-MO           PIC 99.                    ELCREINV
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  71
* ECS010P.cbl (/apps/prod/cid1p/copy/ELCREINV)
  3495         10  RE-EARN-STOP-DA           PIC 99.                    ELCREINV
  3496     05  WS-RE-EARNING-STOP-DT-N REDEFINES                           CL**2
  3497            WS-RE-EARNING-STOP-DT      PIC 9(11).                    CL**2
  3498
  3499 01  RC-REIN-HOLD-AREAS.
  3500     12  RC-REIN-LEVELS  OCCURS 30.
  3501         16  RC-REIN-COMP    PIC X(6).
  3502         16  RC-OLD-ISS      PIC X.
  3503         16  RC-NEW-ISS      PIC X.
  3504         16  RC-OLD-CNC      PIC X.
  3505         16  RC-NEW-CNC      PIC X.
  3506         16  RC-OLD-LF-CLM   PIC X.
  3507         16  RC-OLD-AH-CLM   PIC X.
  3508         16  RC-NEW-LF-CLM   PIC X.
  3509         16  RC-NEW-AH-CLM   PIC X.
  3510         16  RC-REIN-LFAMT   PIC S9(9)V99    COMP-3.
  3511         16  RC-REIN-LFPRM   PIC S9(7)V99    COMP-3.
  3512         16  RC-REIN-AHAMT   PIC S9(7)V99    COMP-3.
  3513         16  RC-REIN-AHPRM   PIC S9(7)V99    COMP-3.
  3514         16  RC-REIN-LFRFND  PIC S9(7)V99    COMP-3.
  3515         16  RC-REIN-AHRFND  PIC S9(7)V99    COMP-3.
  3516         16  RC-REIN-LFCLM   PIC S9(9)V99    COMP-3.
  3517         16  RC-REIN-AHCLM   PIC S9(9)V99    COMP-3.
  3518         16  RC-REIN-REM-SW  PIC X.
  3519     12  RC-REIN-LEVELS-END  PIC X(6).
  3520
  3521 01  TOTAL-PAGES-COUNTERS    COMP-3.
  3522     12  TPC-COUNTERS    OCCURS 6.
  3523         16  TPL-ISS-PRM     PIC S9(9)V99.
  3524         16  TPA-ISS-PRM     PIC S9(9)V99.
  3525         16  TPL-CNC-PRM     PIC S9(9)V99.
  3526         16  TPA-CNC-PRM     PIC S9(9)V99.
  3527         16  TPL-ACCT-COM    PIC S9(9)V99.
  3528         16  TPA-ACCT-COM    PIC S9(9)V99.
  3529         16  TPL-CLAIMS      PIC S9(9)V99.
  3530         16  TPA-CLAIMS      PIC S9(9)V99.
  3531
  3532 01  HLD-DTS SYNC.
  3533     12  EOM-RUN-DATE        PIC 9(08).
  3534     12  EOM-RUN-DATE-R REDEFINES EOM-RUN-DATE.
  3535         16  EOM-CCYY.
  3536             20  EOM-CC      PIC 99.
  3537             20  EOM-YR      PIC 99.
  3538         16  EOM-MO          PIC 99.
  3539         16  EOM-DA          PIC 99.
  3540
  3541****   1ST OCCURRENCE IS MONTHEND DATE MINUS ONE MONTH
  3542****   2ND OCCURRENCE IS MONTHEND DATE MINUS TWO MONTHS
  3543     12  OB-RUN-DATES OCCURS 2.
  3544         16  OB-CCYY         PIC 9(4).
  3545         16  OB-MO           PIC 99.
  3546         16  OB-DA           PIC 99.
  3547
  3548     12  OB-DATE-1-SWITCH    PIC X           VALUE SPACE.
  3549         88  OB-DATE-1-USED     VALUE '*'.
  3550     12  OB-DATE-2-SWITCH    PIC X           VALUE SPACE.
  3551         88  OB-DATE-2-USED     VALUE '*'.
  3552     12  OB-DATE-3-SWITCH    PIC X           VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  72
* ECS010P.cbl
  3553         88  OB-DATE-3-USED     VALUE '*'.
  3554     12  EARNING-START-DATE  PIC 9(08).
  3555     12  EARNING-START-DATE-R REDEFINES  EARNING-START-DATE.
  3556         16  E-ERN-START-CC  PIC 99.
  3557         16  E-ERN-START-YR  PIC 99.
  3558         16  E-ERN-START-MO  PIC 99.
  3559         16  E-ERN-START-DA  PIC 99.
  3560     12  EARNING-STOP-DATE   PIC 9(08).
  3561     12  EARNING-STOP-DATE-R REDEFINES  EARNING-STOP-DATE.
  3562         16  E-ERN-STOP-CC   PIC 99.
  3563         16  E-ERN-STOP-YR   PIC 99.
  3564         16  E-ERN-STOP-MO   PIC 99.
  3565         16  E-ERN-STOP-DA   PIC 99.
  3566     12  STOP-LF-DATE        PIC 9(08).
  3567     12  STOP-LF-DATE-R REDEFINES STOP-LF-DATE.
  3568         16  STOP-LF-CC      PIC 99.
  3569         16  STOP-LF-YR      PIC 99.
  3570         16  STOP-LF-MO      PIC 99.
  3571         16  STOP-LF-DA      PIC 99.
  3572     12  STOP-AH-DATE        PIC 9(08).
  3573     12  STOP-AH-DATE-R REDEFINES STOP-AH-DATE.
  3574         16  STOP-AH-CC      PIC 99.
  3575         16  STOP-AH-YR      PIC 99.
  3576         16  STOP-AH-MO      PIC 99.
  3577         16  STOP-AH-DA      PIC 99.
  3578     12  BIN-VALUATION-DT    PIC XX.
  3579     12  BIN-EOM-RUN-DATE    PIC XX.
  3580     12  LAST-YRS-DATE       PIC 9(08).
  3581     12  LAST-YRS-DATE-R  REDEFINES  LAST-YRS-DATE.
  3582         16  LYD-CCYY        PIC 9(04).
  3583         16  LYD-CCYR REDEFINES LYD-CCYY.
  3584             20  LYD-CC      PIC 99.
  3585             20  LYD-YR      PIC 99.
  3586         16  LYD-MO          PIC 99.
  3587         16  LYD-DA          PIC 99.
  3588     12  VALUATION-DT        PIC 9(08)  VALUE 0.
  3589     12  VALUATION-DT-R REDEFINES VALUATION-DT.
  3590         16  VAL-CC          PIC 99.
  3591         16  VAL-YR          PIC 99.
  3592         16  VAL-MO          PIC 99.
  3593         16  VAL-DA          PIC 99.
  3594     12  INCURRED-DATE       PIC 9(08).
  3595     12  INCURRED-DATE-R REDEFINES INCURRED-DATE.
  3596         16  DTO-CC          PIC 99.
  3597         16  DTO-YR          PIC 99.
  3598         16  DTO-MO          PIC 99.
  3599         16  DTO-DA          PIC 99.
  3600     12  REPORTED-DATE.
  3601         16  RPT-YR          PIC 99.
  3602         16  RPT-MO          PIC 99.
  3603         16  RPT-DA          PIC 99.
  3604     12  PAYMENT-DATE        PIC 9(08).
  3605     12  PAYMENT-DATE-R REDEFINES PAYMENT-DATE.
  3606         16  PAY-CC          PIC 99.
  3607         16  PAY-YR          PIC 99.
  3608         16  PAY-MO          PIC 99.
  3609         16  PAY-DA          PIC 99.
  3610     12  PAY-TO-DATE         PIC 9(8).
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  73
* ECS010P.cbl
  3611     12  PAY-TO-DATE-R  REDEFINES PAY-TO-DATE.
  3612         16  PAYTO-CC        PIC 99.
  3613         16  PAYTO-YR        PIC 99.
  3614         16  PAYTO-MO        PIC 99.
  3615         16  PAYTO-DA        PIC 99.
  3616
  3617 01  AH-RES-STATE-TABLE.
  3618     12  FILLER              PIC X(42)       VALUE
  3619             'AKALAZCADEGAIDILKSKYLAMDMIMTNVOHORSCSDWIWY'.
  3620     12  FILLER              PIC XX          VALUE HIGH-VALUES.
  3621
  3622 01  AH-RES-STATE-TAB REDEFINES AH-RES-STATE-TABLE.
  3623     12  AH-RES-STATE-ENT    PIC XX      OCCURS 22 TIMES.
  3624
  3625 01  BILLING-COUNTERS    COMP-3.
  3626     12  BC-NET-WRIT         PIC S9(7)V99        VALUE +0.
  3627     12  BC-NET-WRIT-SP      PIC S9(7)V99        VALUE +0.
  3628     12  BC-NET-WRIT-OB      PIC S9(7)V99        VALUE +0.
  3629     12  BC-G-ISS            PIC S9(5)           VALUE +0.
  3630     12  BC-G-CNC            PIC S9(5)           VALUE +0.
  3631     12  BC-G-CLM            PIC S9(5)           VALUE +0.
  3632     12  BC-G-CRS            PIC S9(5)           VALUE +0.
  3633     12  BC-G-CTN            PIC S9(5)           VALUE +0.
  3634     12  BC-R-ISS            PIC S9(5)           VALUE +0.
  3635     12  BC-R-CNC            PIC S9(5)           VALUE +0.
  3636     12  BC-R-CLM            PIC S9(5)           VALUE +0.
  3637     12  BC-R-CRS            PIC S9(5)           VALUE +0.
  3638     12  BC-R-CTN            PIC S9(5)           VALUE +0.
  3639     12  BC-COMM             PIC S9(5)           VALUE +0.
  3640     12  BC-NEW-ACCTS        PIC S9(5)           VALUE +0.
  3641     12  BC-ACCTS            PIC S9(5)           VALUE +0.
  3642     12  BC-ACT-ACCTS        PIC S9(5)           VALUE +0.
  3643     12  BC-G-CERTS          PIC S9(7)           VALUE +0.
  3644     12  BC-G-A-CERTS        PIC S9(7)           VALUE +0.
  3645     12  BC-R-CERTS          PIC S9(7)           VALUE +0.
  3646     12  BC-R-A-CERTS        PIC S9(7)           VALUE +0.
  3647     12  BC-ER-ACCTS         PIC S9(5)           VALUE +0.
  3648     12  BC-CS-ACCTS         PIC S9(5)           VALUE +0.
  3649     12  ACTIVE-COUNT        PIC S9              VALUE +0.
  3650
  3651 01  FLAGS SYNC.
  3652     12  BILLED-SWITCH           PIC X           VALUE 'N'.
  3653         88  CHECK-BILLED                        VALUE 'Y'.
  3654     12  TRANS-EOF-FLAG          PIC X           VALUE SPACE.
  3655         88  EOF-ON-TRANS                        VALUE '*'.
  3656     12  CERT-EOF-FLAG           PIC X           VALUE SPACE.
  3657         88  EOF-ON-CERT                         VALUE '*'.
  3658     12  PROCESSING-FLAG         PIC X           VALUE SPACE.
  3659         88  PROCESSING-COMPLETED                VALUE '*'.
  3660     12  DEATH-VOID-FLAG         PIC X           VALUE SPACE.
  3661         88  DEATH-CLAIM-VOIDED                  VALUE '*'.
  3662     12  CERT-CHANGE-FLAG        PIC X           VALUE SPACE.
  3663         88  PRINTING-CERT-CHANGES               VALUE '*'.
  3664     12  STATUTORY-SWITCH        PIC X           VALUE SPACE.
  3665         88  STATUTORY-REQUIREMENT               VALUE '*'.
  3666     12  STATUTORY-SWITCH-AH     PIC X           VALUE SPACE.
  3667         88  STATUTORY-REQUIREMENT-AH            VALUE '*'.
  3668     12  LIFE-EARNED-SWITCH      PIC X           VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  74
* ECS010P.cbl
  3669         88  LIFE-FULLY-EARNED                   VALUE '*'.
  3670     12  A-H-EARNED-SWITCH       PIC X           VALUE SPACE.
  3671         88  A-H-FULLY-EARNED                    VALUE '*'.
  3672     12  CNCL-FLG            PIC X               VALUE SPACE.
  3673     12  TRANSACTION-FLAG    PIC X               VALUE SPACE.
  3674         88  NO-TRANSACTION-WAS-PROCESSED    VALUE SPACE.
  3675         88  TRANSACTION-WAS-PROCESSED       VALUE '*'.
  3676     12  RISK-REIN-FLAG      PIC X               VALUE SPACE.
  3677         88  REIN-IS-RISK-PREMIUM            VALUE '*'.
  3678     12  RISK-PREM-FLAG      PIC X               VALUE SPACE.
  3679         88  UPDATING-RISK-PREMIUMS          VALUE '*'.
  3680     12  EP-FLG              PIC X               VALUE SPACE.
  3681     12  END-FLG             PIC X               VALUE SPACE.
  3682     12  PRIOR-MATCH-CNTRL   PIC X(36)           VALUE LOW-VALUE.
  3683     12  PRIOR-CERT-IN-CNTRL PIC X(36)           VALUE LOW-VALUE.
  3684     12  ACCT-FLG            PIC X               VALUE SPACE.
  3685     12  STATE-FLG           PIC X               VALUE SPACE.
  3686     12  COMP-FLG            PIC X               VALUE SPACE.
  3687     12  CARR-FLG            PIC X               VALUE SPACE.
  3688     12  FINAL-FLG           PIC X               VALUE SPACE.
  3689     12  LOW-CTL             PIC X(19)           VALUE SPACES.
  3690     12  REIN-FLG            PIC X               VALUE SPACE.
  3691     12  REIN-EP-FLG         PIC X               VALUE SPACE.
  3692     12  REIN-RT-SW          PIC X               VALUE SPACE.
  3693
  3694 01  TEXAS-REG-WORK-AREAS   SYNC.
  3695     12  TEX-FACT-1          PIC S9(9)V99    COMP-3.
  3696     12  TEX-FACT-2          PIC S999        COMP-3.
  3697     12  TEX-FACT-3          PIC S999        COMP-3.
  3698     12  TEX-FACT-4          PIC S9(7)       COMP-3.
  3699     12  TEX-FACT-5          PIC S999        COMP-3.
  3700     12  TEX-FACT-6          PIC S999        COMP-3.
  3701     12  TEX-FACT-7          PIC S9(7)       COMP-3.
  3702     12  TEX-FACT-8          PIC S9V9(6)     COMP-3.
  3703     12  TEX-FACT-9          PIC S9(4)V9(11) COMP-3.
  3704
  3705 01  NET-PAY-INTERFACE.
  3706     12  NP-APR              PIC S999V9(4)   COMP-3.
  3707     12  NP-ORIG             PIC S999        COMP-3.
  3708     12  NP-REM              PIC S999        COMP-3.
  3709     12  NP-OPT              PIC X.
  3710     12  NP-CAP              PIC S999        COMP-3.
  3711     12  NP-FACTOR           PIC S9(4)V9(9)  COMP-3.
  3712     12  NP-WORK1            PIC S9(9)V9(9)  COMP-3.
  3713     12  NP-WORK2            PIC S9(9)V9(9)  COMP-3.
  3714     12  NP-BENEFIT          PIC S9(9)V99    COMP-3.
  3715     12  NP-REMAINING        PIC S9(9)V99    COMP-3.
  3716     12  NP-AHPRM            PIC S9(7)V99    COMP-3.
  3717     12  NP-ACCOUNT          PIC X(10).
  3718
  3719 01  HOLDERS SYNC.
  3720     12  DIS-IBNR            PIC S9(7)V99 COMP-3 VALUE +0.
  3721     12  DIS-PAYCUR          PIC S9(7)V99 COMP-3 VALUE +0.
  3722     12  DIS-FUTRSV          PIC S9(7)V99 COMP-3 VALUE +0.
  3723     12  DTH-IBNR            PIC S9(7)V99 COMP-3 VALUE +0.
  3724     12  DTH-PAYCUR          PIC S9(7)V99 COMP-3 VALUE +0.
  3725     12  DTH-FUTRSV          PIC S9(7)V99 COMP-3 VALUE +0.
  3726     12  EXCESS-RESERVE      PIC S9(7)V99 COMP-3 VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  75
* ECS010P.cbl
  3727     12  H-LFCM              PIC S9(9)V99 COMP-3 VALUE +0.
  3728     12  H-AHCM              PIC S9(9)V99 COMP-3 VALUE +0.
  3729     12  TEMP-1              PIC S9(5)V99 COMP-3 VALUE +0.
  3730     12  TEMP-2              PIC S9(5)V99 COMP-3 VALUE +0.
  3731     12  TEMP-3              PIC S9(5)V99 COMP-3 VALUE +0.
  3732     12  TEMP-4              PIC S9V9(6)  COMP-3 VALUE +0.
  3733     12  TEMP-5              PIC S9V9(6)  COMP-3 VALUE +0.
  3734     12  TEMP-6              PIC S99V9(6) COMP-3 VALUE +0.
  3735     12  TEMP-7              PIC S9(9)V99 COMP-3 VALUE +0.
  3736     12  TEMP-8              PIC S9(9)V99 COMP-3 VALUE +0.
  3737     12  REM-TRM1            PIC S999V99  COMP-3.
  3738     12  REM-TRM2            PIC S999V99  COMP-3.
  3739     12  REM-TRM3            PIC S999V99  COMP-3.
  3740     12  TEM-TRM1            PIC S999V99  COMP-3.
  3741     12  MAX-REM-TERM        PIC S999V99  COMP-3.
  3742     12  ORIG-TERM           PIC S999V99  COMP-3.
  3743     12  HLD-CONTROL.
  3744         16  HLD-CARRIER     PIC X               VALUE SPACES.
  3745         16  HLD-GROUPING    PIC X(6)            VALUE SPACES.
  3746         16  HLD-STATE       PIC XX              VALUE SPACES.
  3747         16  HLD-ACCT        PIC X(10)           VALUE SPACES.
  3748     12  LN-MX               PIC S999     COMP-3 VALUE +56.
  3749
  3750 01  DISPLAY-IBNR-LINE.
  3751     05  FILLER                  PIC X       VALUE SPACES.
  3752     05  DIL-COMMENT             PIC X(20)   VALUE SPACES.
  3753     05  FILLER                  PIC XX      VALUE SPACES.
  3754     05  DIL-TYPE                PIC X       VALUE SPACES.
  3755     05  FILLER                  PIC X       VALUE SPACES.
  3756     05  DIL-BEN-CODE            PIC ZZ      VALUE SPACES.
  3757     05  FILLER                  PIC XXX     VALUE SPACES.
  3758     05  DIL-AMOUNT              PIC ZZZ9.99999-.
  3759
  3760 01  DISPLAY-HD-1.
  3761     05  FILLER      PIC X       VALUE SPACES.
  3762     05  FILLER      PIC X(50)   VALUE SPACES.
  3763     05  FILLER      PIC X(23)   VALUE 'PROCESSING ERROR REPORT'.
  3764     05  FILLER      PIC X(51)   VALUE SPACES.
  3765     05  FILLER      PIC X(8)    VALUE 'ECS010 '.
  3766
  3767 01  DISPLAY-HD-2.
  3768     05  FILLER                 PIC X       VALUE SPACE.
  3769     05  FILLER                 PIC X(57)   VALUE SPACES.
  3770     05  DIS-DATE               PIC X(8).
  3771     05  FILLER                 PIC X(66)   VALUE SPACES.
  3772
  3773 01  DISPLAY-LINE.
  3774     05  DL-FULL.
  3775         10  FILLER           PIC X       VALUE SPACE.
  3776         10  DIS-LINE-REASON  PIC X(32)   VALUE SPACES.
  3777         10  DIS-LINE-REC     PIC X(100)  VALUE SPACES.
  3778
  3779 01  PRT-HDNGS SYNC.
  3780     12  TR-HD-1.
  3781         16  FILLER      PIC X       VALUE '1'.
  3782         16  FILLER      PIC X(53)   VALUE SPACES.
  3783         16  FILLER      PIC X(18)   VALUE 'TRANSACTION REPORT'.
  3784         16  FILLER      PIC X(48)   VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  76
* ECS010P.cbl
  3785         16  FILLER      PIC X(8)    VALUE 'ECS010 '.
  3786     12  TR-HD-2.
  3787         16  FILLER      PIC X       VALUE SPACE.
  3788         16  FILLER      PIC X(47)   VALUE SPACES.
  3789         16  TRHDNM      PIC X(30).
  3790         16  FILLER      PIC X(42)   VALUE SPACES.
  3791         16  TR-RN-DT    PIC X(8).
  3792     12  TR-HD-3.
  3793         16  FILLER      PIC X       VALUE SPACE.
  3794         16  FILLER      PIC X(53)   VALUE SPACES.
  3795         16  TR-MODAYR   PIC X(18).
  3796         16  FILLER      PIC X       VALUE SPACE.
  3797         16  TR-YRASK    PIC X       VALUE SPACE.
  3798         16  FILLER      PIC X(46)   VALUE SPACES.
  3799         16  FILLER      PIC X(5)    VALUE 'PAGE '.
  3800         16  TR-PG       PIC ZZ,ZZ9.
  3801     12  TR-HD-4.
  3802         16  FILLER      PIC X       VALUE SPACE.
  3803         16  TR-AGCY     PIC X(30).
  3804     12  TR-HD-5.
  3805         16  FILLER      PIC X       VALUE SPACE.
  3806         16  TR-CARR     PIC X.
  3807         16  FILLER      PIC X       VALUE '-'.
  3808         16  TR-GROUP    PIC X(6).
  3809         16  FILLER      PIC X       VALUE '-'.
  3810         16  TR-ST-NO    PIC X(2).
  3811         16  FILLER      PIC X       VALUE '-'.
  3812         16  TR-AG-NO    PIC X(10).
  3813         16  FILLER      PIC X(23)   VALUE SPACES.
  3814         16  TR5-RP-TYP.
  3815             20  FILLER  PIC X(20)   VALUE
  3816                     '* * * * TRANSACTION '.
  3817             20  FILLER  PIC X(15)   VALUE 'LISTING * * * *'.
  3818     12  TR-HD-6.
  3819         16  FILLER      PIC X       VALUE SPACE.
  3820         16  TR-CE-MO    PIC XX.
  3821         16  FILLER      PIC X       VALUE '-'.
  3822         16  TR-CE-DA    PIC XX.
  3823         16  FILLER      PIC X       VALUE '-'.
  3824         16  TR-CE-YR    PIC XX.
  3825         16  FILLER      PIC X(6)    VALUE '  TO  '.
  3826         16  TR-CX.
  3827             20  TR-CX-MO PIC XX.
  3828             20  HSHR1    PIC X.
  3829             20  TR-CX-DA PIC XX.
  3830             20  HSHR2    PIC X.
  3831             20  TR-CX-YR PIC XX.
  3832     12  TR-HD-7.
  3833         16  FILLER  PIC X      VALUE '0'.
  3834         16  FILLER  PIC X(24)  VALUE SPACES.
  3835         16  FILLER  PIC X(19)  VALUE '*----------------- '.
  3836         16  TR-7-LF PIC X(6).
  3837         16  FILLER  PIC X(9)   VALUE ' COVERAGE'.
  3838         16  FILLER  PIC X(19)  VALUE ' -----------------*'.
  3839         16  FILLER  PIC X(20)  VALUE '  *---------------- '.
  3840         16  TR-7-AH PIC X(6).
  3841         16  FILLER  PIC X(10)  VALUE ' COVERAGE '.
  3842         16  FILLER  PIC X(19)  VALUE ' -----------------*'.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  77
* ECS010P.cbl
  3843     12  TR-HD-8.
  3844         16  FILLER  PIC X      VALUE SPACE.
  3845         16  FILLER  PIC X(24)  VALUE '   CERT      ISSUE      '.
  3846         16  FILLER  PIC X(24)  VALUE '        PREMIUM    COMMI'.
  3847         16  FILLER  PIC X(24)  VALUE 'SSION   ACTION          '.
  3848         16  FILLER  PIC X(24)  VALUE '                PREMIUM '.
  3849         16  FILLER  PIC X(22)  VALUE '   COMMISSION   ACTION'.
  3850     12  TR-HD-9.
  3851         16  FILLER  PIC X      VALUE SPACE.
  3852         16  FILLER  PIC X(24)  VALUE '  NUMBER      DATE  AGE '.
  3853         16  FILLER  PIC X(24)  VALUE 'TYP TRM  / REFUND    /  '.
  3854         16  FILLER  PIC X(24)  VALUE 'CLAIM    DATE     ACTION'.
  3855         16  FILLER  PIC X(24)  VALUE '  ST    TYP TRM  / REFUN'.
  3856         16  FILLER  PIC X(24)  VALUE 'D    /  CLAIM    DATE   '.
  3857         16  FILLER  PIC X(12)  VALUE '  ACTION  ST'.
  3858     12  TR-TTL-HD.
  3859         16  FILLER      PIC X       VALUE '0'.
  3860         16  TTL-PT-CNT  PIC ZZZZ,ZZZ,ZZZ,ZZ9.
  3861         16  FILLER      PIC XX      VALUE SPACES.
  3862         16  TTL-HD-DS   PIC X(60)   VALUE
  3863             'ECS010 CONTROL TOTALS'.
  3864
  3865 01  TR-DTL.
  3866     12  FILLER                  PIC X           VALUE SPACE.
  3867     12  TR-DTL1.
  3868         16  TRD-CERT            PIC X(11).
  3869         16  TRD-ISDT.
  3870             20  FILLER          PIC X           VALUE SPACE.
  3871             20  TRD-ISMO        PIC XX.
  3872             20  TRD-IS-S1       PIC X           VALUE '/'.
  3873             20  TRD-ISDA        PIC XX.
  3874             20  TRD-IS-S2       PIC X           VALUE '/'.
  3875             20  TRD-ISYR        PIC XX.
  3876             20  FILLER          PIC X           VALUE SPACE.
  3877         16  TRD-AGE             PIC XX.
  3878     12  TR-DTL2.
  3879         16  FILLER              PIC X           VALUE SPACE.
  3880         16  TRD-LFTYP           PIC XXX.
  3881         16  FILLER              PIC X           VALUE SPACE.
  3882         16  TRD-LFTRM           PIC ZZ9.
  3883         16  TRD-LFPRM-RFND      PIC ZZZZ,ZZZ.99  BLANK WHEN ZERO.
  3884         16  TRD-LFCOM-CLM       PIC ZZZZ,ZZZ.99- BLANK WHEN ZERO.
  3885         16  TRD-LFACTDT.
  3886             20  FILLER          PIC X           VALUE SPACE.
  3887             20  TRD-LFACTMO     PIC XX.
  3888             20  TRD-LF-S1       PIC X           VALUE '/'.
  3889             20  TRD-LFACTDA     PIC XX.
  3890             20  TRD-LF-S2       PIC X           VALUE '/'.
  3891             20  TRD-LFACTYR     PIC XX.
  3892             20  FILLER          PIC X           VALUE SPACE.
  3893         16  TRD-LF-ACTION       PIC X(10)       VALUE SPACE.
  3894         16  FILLER              PIC X           VALUE SPACE.
  3895         16  TRD-LF-STATUS       PIC X.
  3896         16  FILLER              PIC X(4)        VALUE SPACE.
  3897         16  TRD-AHTYP           PIC XXX.
  3898         16  FILLER              PIC X           VALUE SPACE.
  3899         16  TRD-AHTRM           PIC ZZ9.
  3900         16  TRD-AHPRM-RFND      PIC ZZZZ,ZZZ.99  BLANK WHEN ZERO.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  78
* ECS010P.cbl
  3901         16  TRD-AHCOM-CLM       PIC ZZZZ,ZZZ.99- BLANK WHEN ZERO.
  3902         16  TRD-AHACTDT.
  3903             20  FILLER          PIC X           VALUE SPACE.
  3904             20  TRD-AHACTMO     PIC XX.
  3905             20  TRD-AH-S1       PIC X           VALUE '/'.
  3906             20  TRD-AHACTDA     PIC XX.
  3907             20  TRD-AH-S2       PIC X           VALUE '/'.
  3908             20  TRD-AHACTYR     PIC XX.
  3909             20  FILLER          PIC X           VALUE SPACE.
  3910         16  TRD-AH-ACTION       PIC X(10)       VALUE SPACE.
  3911         16  FILLER              PIC X           VALUE SPACE.
  3912         16  TRD-AH-STATUS       PIC X.
  3913     12  TR-DTL3 REDEFINES TR-DTL2.
  3914         16  FILLER              PIC X(20).
  3915         16  TRD-IBNR            PIC ZZZ,ZZZ.99-.
  3916         16  FILLER              PIC X.
  3917         16  TRD-IBNRX           PIC X(4).
  3918         16  FILLER              PIC X(2).
  3919         16  TRD-PAYCUR          PIC ZZZ,ZZZ.99-.
  3920         16  TRD-PAYCUR-SPACE REDEFINES TRD-PAYCUR
  3921                                 PIC X(11).
  3922         16  FILLER              PIC X.
  3923         16  TRD-PAYCURX         PIC X(8).
  3924         16  FILLER              PIC X(2).
  3925         16  TRD-FUTRSV-DATA.
  3926             20  TRD-FUTRSV      PIC ZZZ,ZZZ.99-.
  3927             20  TRD-FUTRSV-SPACE REDEFINES TRD-FUTRSV
  3928                                 PIC X(11).
  3929             20  FILLER          PIC X.
  3930             20  TRD-FUTRSVX     PIC X(6).
  3931         16  TRD-BENEFIT-DATA REDEFINES TRD-FUTRSV-DATA.
  3932             20  TRD-BENEFIT-X   PIC X(10).
  3933             20  TRD-BENEFIT-CODE
  3934                                 PIC X(02).
  3935             20  FILLER          PIC X(06).
  3936         16  FILLER              PIC X(4).
  3937         16  TRD-RSV-DESC        PIC X(6).
  3938         16  TRD-RSV-ACTION      PIC X(21).
  3939
  3940 01  DET-PR-UREC.
  3941     12  FILLER              PIC X(7)     VALUE ' AGE - '.
  3942     12  DET-AGE             PIC 99         BLANK WHEN ZERO.
  3943     12  FILLER              PIC X(11)    VALUE ' JT. AGE - '.
  3944     12  DET-JT-AGE          PIC 99         BLANK WHEN ZERO.
  3945     12  FILLER              PIC X(7)     VALUE ' SEX - '.
  3946     12  DET-SEX             PIC X.
  3947     12  FILLER              PIC X(9)     VALUE '   APR - '.
  3948     12  DET-PR-APR          PIC Z9.999     BLANK WHEN ZERO.
  3949     12  FILLER              PIC X(9)     VALUE '  MEM# - '.
  3950     12  DET-PR-MEM          PIC X(12).
  3951     12  FILLER              PIC X(9)     VALUE '   SS# - '.
  3952     12  DET-PR-SS           PIC X(11).
  3953     12  FILLER              PIC XXX      VALUE SPACES.
  3954     12  DET-1-ACTION        PIC X(20)    VALUE ' MAINTENANCE'.
  3955
  3956 01  DET-PR-UREC-2.
  3957     12  FILLER              PIC X        VALUE SPACE.
  3958     12  DET-LF-DESC         PIC XX.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  79
* ECS010P.cbl
  3959     12  FILLER              PIC X(10)    VALUE ' TERM CHG '.
  3960     12  DET-O-LF-TERM       PIC 999        BLANK WHEN ZERO.
  3961     12  FILLER              PIC X(4)     VALUE ' TO '.
  3962     12  DET-N-LF-TERM       PIC 999        BLANK WHEN ZERO.
  3963     12  FILLER              PIC X        VALUE SPACE.
  3964     12  DET-AH-DESC         PIC XX.
  3965     12  FILLER              PIC X(10)    VALUE ' TERM CHG '.
  3966     12  DET-O-AH-TERM       PIC 999        BLANK WHEN ZERO.
  3967     12  FILLER              PIC X(4)     VALUE ' TO '.
  3968     12  DET-N-AH-TERM       PIC 999        BLANK WHEN ZERO.
  3969     12  FILLER              PIC X(12)    VALUE ' OLD LIVES -'.
  3970     12  DET-O-LIVES         PIC ZZZZ999    BLANK WHEN ZERO.
  3971     12  FILLER              PIC X(12)    VALUE ' NEW LIVES -'.
  3972     12  DET-N-LIVES         PIC ZZZZ999    BLANK WHEN ZERO.
  3973     12  FILLER              PIC X(5)     VALUE SPACES.
  3974     12  DET-2-ACTION        PIC X(20)    VALUE ' MAINTENANCE'.
  3975
  3976 01  DET-PR-UREC-3.
  3977     12  FILLER              PIC X(7)     VALUE ' I/G - '.
  3978     12  DET-IND-GRP         PIC X.
  3979     12  FILLER              PIC X(13)    VALUE '  PMT FREQ - '.
  3980     12  DET-PMT-FREQ        PIC 99         BLANK WHEN ZERO.
  3981     12  FILLER              PIC X(14)    VALUE '  POL FORM# - '.
  3982     12  DET-POL-FORM        PIC X(12).
  3983     12  FILLER              PIC X(14)    VALUE '  LOAN OFF# - '.
  3984     12  DET-LOAN-OFFICER    PIC XXX.
  3985     12  FILLER              PIC X(14)    VALUE '  USER CODE - '.
  3986     12  DET-USER-CODE       PIC X.
  3987     12  FILLER              PIC X(8)     VALUE SPACES.
  3988     12  DET-3-ACTION        PIC X(20)    VALUE ' MAINTENANCE'.
  3989
  3990 01  DET-PR-UREC-4.
  3991     12  FILLER              PIC X(18) VALUE ' CLM DEDUCT AMT - '.
  3992     12  DET-CLM-DEDUCT      PIC 99999.99   BLANK WHEN ZERO.
  3993     12  FILLER              PIC X(18) VALUE ' CAN DEDUCT AMT - '.
  3994     12  DET-CAN-DEDUCT      PIC 99999.99   BLANK WHEN ZERO.
  3995     12  FILLER              PIC X(37)    VALUE SPACES.
  3996     12  DET-3-ACTION        PIC X(20)    VALUE ' MAINTENANCE'.
  3997
  3998 01  DET-PR-UREC-5.
  3999     12  FILLER              PIC X(13) VALUE ' LF BEN CD - '.
  4000     12  DET-LF-BEN-CD       PIC XX.
  4001     12  FILLER              PIC X(11) VALUE ' LF PREM - '.
  4002     12  DET-LF-PREM         PIC ZZZZZZZ.99   BLANK WHEN ZERO.
  4003     12  FILLER              PIC X(11) VALUE ' LF BENE - '.
  4004     12  DET-LF-BEN          PIC ZZZZZZZZZ.99   BLANK WHEN ZERO.
  4005     12  FILLER              PIC X(30)    VALUE SPACES.
  4006     12  DET-3-ACTION        PIC X(20)    VALUE ' MAINTENANCE'.
  4007
  4008 01  DET-PR-UREC-6.
  4009     12  FILLER              PIC X(13) VALUE ' AH BEN CD - '.
  4010     12  DET-AH-BEN-CD       PIC XX.
  4011     12  FILLER              PIC X(11) VALUE ' AH PREM - '.
  4012     12  DET-AH-PREM         PIC ZZZZZZZ.99   BLANK WHEN ZERO.
  4013     12  FILLER              PIC X(11) VALUE ' AH BENE - '.
  4014     12  DET-AH-BEN          PIC ZZZZZZZZZ.99   BLANK WHEN ZERO.
  4015     12  FILLER              PIC X(30)    VALUE SPACES.
  4016     12  DET-3-ACTION        PIC X(20)    VALUE ' MAINTENANCE'.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  80
* ECS010P.cbl
  4017
  4018 01  WS-CHANGE-REC-SW        PIC X  VALUE 'N'.
  4019     88  WS-CHANGE-REC              VALUE 'Y'.
  4020
  4021 01  TOTAL-PAGE-HD1.
  4022     12  FILLER              PIC X               VALUE SPACE.
  4023     12  TPH1-TYPE           PIC X(8).
  4024     12  TPH1-DESC.
  4025         16  TPH1-ST-CODE    PIC XX.
  4026         16  FILLER          PIC XXX.
  4027         16  TPH1-ST-DESC    PIC X(20).
  4028
  4029 01  TOTAL-PAGE-HD2.
  4030     12  FILLER              PIC X           VALUE SPACE.
  4031     12  TPH2-DESC           PIC X(20)       VALUE SPACES.
  4032     12  FILLER              PIC X(7)        VALUE 'WRITTEN'.
  4033     12  FILLER              PIC X(9)        VALUE SPACES.
  4034     12  FILLER              PIC X(9)        VALUE 'CANCELLED'.
  4035     12  FILLER              PIC X(11)       VALUE SPACES.
  4036     12  FILLER              PIC X(3)        VALUE 'NET'.
  4037     12  FILLER              PIC X(11)       VALUE SPACES.
  4038     12  FILLER              PIC X(7)        VALUE 'ACCOUNT'.
  4039     12  FILLER              PIC X(10)       VALUE SPACES.
  4040     12  FILLER              PIC X(10)       VALUE 'NET PREM -'.
  4041
  4042 01  TOTAL-PAGE-HD3.
  4043     12  FILLER              PIC X           VALUE SPACE.
  4044     12  TPH3-DESC           PIC X(20)       VALUE SPACES.
  4045     12  FILLER              PIC X(7)        VALUE 'PREMIUM'.
  4046     12  FILLER              PIC X(10)       VALUE SPACES.
  4047     12  FILLER              PIC X(7)        VALUE 'PREMIUM'.
  4048     12  FILLER              PIC X(10)       VALUE SPACES.
  4049     12  FILLER              PIC X(7)        VALUE 'PREMIUM'.
  4050     12  FILLER              PIC X(7)        VALUE SPACES.
  4051     12  FILLER              PIC X(10)       VALUE 'COMMISSION'.
  4052     12  FILLER              PIC X(08)       VALUE SPACES.
  4053     12  FILLER              PIC X(09)       VALUE 'ACCT COMP'.
  4054     12  FILLER              PIC X(11)       VALUE SPACES.
  4055     12  FILLER              PIC X(6)        VALUE 'CLAIMS'.
  4056
  4057 01  TOTAL-PAGE-DETAIL.
  4058     12  FILLER              PIC X(5).
  4059     12  TPD-DESC            PIC X(6).
  4060     12  FILLER              PIC X(3).
  4061     12  TPD-ISS-PRM         PIC ZZZ,ZZZ,ZZZ.99-.
  4062     12  FILLER              PIC X(2).
  4063     12  TPD-CNC-PRM         PIC ZZZ,ZZZ,ZZZ.99-.
  4064     12  FILLER              PIC X(2).
  4065     12  TPD-NET-PRM         PIC ZZZ,ZZZ,ZZZ.99-.
  4066     12  FILLER              PIC X(2).
  4067     12  TPD-ACCT-COM        PIC ZZZ,ZZZ,ZZZ.99-.
  4068     12  FILLER              PIC X(2).
  4069     12  TPD-PREM-COMP       PIC ZZZ,ZZZ,ZZZ.99-.
  4070     12  FILLER              PIC X(2).
  4071     12  TPD-CLAIMS          PIC ZZZ,ZZZ,ZZZ.99-.
  4072     12  FILLER              PIC X(4).
  4073     12  TPD-LO-CERT         PIC X(6).
  4074     12  FILLER              PIC X(2).
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  81
* ECS010P.cbl
  4075     12  TPD-HI-CERT         PIC X(6).
  4076*    12  FILLER              PIC X.
  4077*    12  TPD-LO-CERT         PIC X(8).
  4078*    12  FILLER              PIC X.
  4079*    12  TPD-HI-CERT         PIC X(8).
  4080
  4081 01  DUPE-CERT-TABLE.
  4082     12  DUPE-ENTRIES  OCCURS 1000 TIMES.
  4083         16  DUPE-ENTRY      PIC X(36).
  4084         16  DUPE-STATUS     PIC X(01).
  4085         16  DUPE-LF-PRM     PIC S9(7)V99    COMP-3.
  4086         16  DUPE-AH-PRM     PIC S9(7)V99    COMP-3.
  4087
  4088 01  MISMATCH-HEADING-1.
  4089     12  FILLER              PIC X           VALUE '1'.
  4090     12  FILLER              PIC X(45)       VALUE SPACES.
  4091     12  FILLER              PIC X(42)       VALUE
  4092             'MISMATCHED TRANS AND DUPLICATE CERT REPORT'.
  4093     12  FILLER              PIC X(35)       VALUE SPACES.
  4094     12  FILLER              PIC X(10)       VALUE 'ECS010    '.
  4095
  4096 01  MISMATCH-HEADING-2.
  4097     12  FILLER              PIC X           VALUE '0'.
  4098     12  FILLER              PIC X(44)       VALUE
  4099             ' C  GRP ST  ACCT    EFF DTE  CERT      REC T'.
  4100     12  FILLER              PIC X(44)       VALUE
  4101             'YPE      CERT IN CONTROL                    '.
  4102     12  FILLER              PIC X(44)       VALUE
  4103             '        CERT OUT CONTROL           STATUS   '.
  4104
  4105 01  MISMATCH-DETAIL.
  4106     12  FILLER              PIC X           VALUE '0'.
  4107     12  FILLER              PIC X           VALUE SPACES.
  4108     12  DTL-MATCH-CONTROL   PIC X(36).
  4109     12  FILLER              PIC X(3)        VALUE SPACES.
  4110     12  DTL-REC-TYPE        PIC X.
  4111     12  FILLER              PIC X(2)        VALUE SPACES.
  4112     12  DTL-REC-TYPE-DESC   PIC X(3).
  4113     12  FILLER              PIC X(3)        VALUE SPACES.
  4114     12  DTL-CERT-IN-CONTROL
  4115                             PIC X(36).
  4116     12  FILLER              PIC X           VALUE SPACES.
  4117     12  DTL-CERT-OUT-CONTROL
  4118                             PIC X(36).
  4119     12  FILLER              PIC X           VALUE SPACES.
  4120     12  DTL-STATUS          PIC X(7)        VALUE 'DROPPED'.
  4121     12  FILLER              PIC X(2)        VALUE SPACES.
  4122
  4123 01  MISMATCH-DETAIL-2.
  4124     12  FILLER              PIC X           VALUE ' '.
  4125     12  FILLER              PIC X           VALUE SPACES.
  4126     12  MD2-LF-PREM-DESC    PIC X(16)       VALUE
  4127             ' LIFE PREMIUM = '.
  4128     12  MD2-LF-PREM         PIC Z,ZZZ,ZZZ.99-.
  4129     12  FILLER              PIC X           VALUE SPACES.
  4130     12  MD2-LF-ALT-PREM-DESC PIC X(16)       VALUE
  4131             'LIFE ALT PREM = '.
  4132     12  MD2-LF-ALT-PREM     PIC Z,ZZZ,ZZZ.99-.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  82
* ECS010P.cbl
  4133     12  FILLER              PIC XX          VALUE SPACES.
  4134     12  MD2-AH-PREM-DESC    PIC X(18)       VALUE
  4135             'A/H PREMIUM = '.
  4136     12  MD2-AH-PREM         PIC Z,ZZZ,ZZZ.99-.
  4137     12  FILLER              PIC X(39)       VALUE SPACES.
  4138
  4139 01  MISMATCH-DETAIL-3.
  4140     12  FILLER              PIC X           VALUE ' '.
  4141     12  FILLER              PIC X           VALUE SPACES.
  4142     12  FILLER              PIC X(16)       VALUE
  4143             ' LIFE  REFUND = '.
  4144     12  MD3-LF-REFUND       PIC Z,ZZZ,ZZZ.99-.
  4145     12  FILLER              PIC X           VALUE SPACES.
  4146     12  FILLER              PIC X(16)       VALUE
  4147             'A & H  REFUND = '.
  4148     12  MD3-AH-REFUND       PIC Z,ZZZ,ZZZ.99-.
  4149     12  FILLER              PIC X(72)       VALUE SPACES.
  4150
  4151 01  MISMATCH-DETAIL-4.
  4152     12  FILLER              PIC X           VALUE ' '.
  4153     12  FILLER              PIC X           VALUE SPACES.
  4154     12  FILLER              PIC X(16)       VALUE
  4155             ' LIFE  CLAIM  = '.
  4156     12  MD4-LF-CLAIM        PIC Z,ZZZ,ZZZ.99-.
  4157     12  FILLER              PIC X           VALUE SPACES.
  4158     12  FILLER              PIC X(16)       VALUE
  4159             'A & H  CLAIM  = '.
  4160     12  MD4-AH-CLAIM        PIC Z,ZZZ,ZZZ.99-.
  4161     12  FILLER              PIC X(72)       VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  83
* ECS010P.cbl
  4163*
  4164*
  4165* LEAVE THE ABOVE 2 LINES IN TO PREVENT LOSING THE LINE ABOVE
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  84
* ECS010P.cbl
  4167 01  PB-STARTS-HERE              PIC X(48)
  4168       VALUE '*****  PENDING BUSINESS RECORD STARTS HERE  ****'.
  4169
* 4170                             COPY ERCPNDB.
  4171******************************************************************
  4172*                                                                *
  4173*                                                                *
  4174*                            ERCPNDB.                            *
  4175*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4176*                            VMOD=2.025                          *
  4177*                                                                *
  4178*   FILE DESCRIPTION = PENDING NEW BUSINESS (ISSUES AND CANCELS) *
  4179*                                                                *
  4180******************************************************************
  4181*   NOTE: IF THIS FORMAT IS CHANGED, THE SORT RECORD IN THE      *
  4182*         EL861 A/R SYSTEM MAY NEED TO BE CHANGED.               *
  4183******************************************************************
  4184*                                                                *
  4185*                                                                *
  4186*   FILE TYPE = VSAM,KSDS                                        *
  4187*   RECORD SIZE = 585  RECFORM = FIXED                           *
  4188*                                                                *
  4189*   BASE CLUSTER = ERPNDB                         RKP=2,LEN=11   *
  4190*       ALTERNATE PATH1 = ERPNDB2  (BY CAR GRP STATE ACCOUNT     *
  4191*                                  EFF-DT CERT CHG-SEQ REC-TYPE) *
  4192*                                                 RKP=13,LEN=36  *
  4193*       ALTERNATE PATH2 = ERPNDB3  (BY CO, ORIGINAL BATCH, SEQ.  *
  4194*                                      AND CHG-SEQ.)             *
  4195*                                                RKP=49,LEN=11   *
  4196*       ALTERNATE PATH3 = ERPNDB4  (BY CO, CSR-ID, BATCH, SEQ.   *
  4197*                                      AND CHG-SEQ.)             *
  4198*                                                RKP=60,LEN=15   *
  4199*                                                                *
  4200*   LOG = NO                                                     *
  4201*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4202******************************************************************
  4203******************************************************************
  4204*                   C H A N G E   L O G
  4205*
  4206* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4207*-----------------------------------------------------------------
  4208*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4209* EFFECTIVE    NUMBER
  4210*-----------------------------------------------------------------
  4211* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  4212* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  4213* 011904                   PEMA  ADD TOTAL FEE PROCESSING
  4214* 040504    2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  4215* 020305    2005020000000  PEMA  ADD CLP STATE TO PNDB RECORD
  4216* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  4217* 032306                   PEMA  ADD BOW LOAN NUMBER
  4218* 081606    2006080800002  PEMA  ADD VIN, ISSUES ONLY
  4219* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
  4220* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  4221* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  4222* 032109    2009021700002  PEMA  ADD CRED BENE TO PNDB REC
  4223* 072209  CR2008101500003  AJRA  ADD BORROWER FIRST NAME TO ENDORSEMENT
  4224* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  85
* ECS010P.cbl (/apps/prod/cid1p/copy/ERCPNDB)
  4225* 071211  CR2010012700001  PEMA  ADD SPP DEALER DIRECT
  4226* 073114  CR2014012300001  PEMA  ADD CU CARRIER 7 PROCESSING
  4227******************************************************************
  4228
  4229 01  PENDING-BUSINESS.
  4230     12  PB-RECORD-ID                     PIC XX.
  4231         88  VALID-PB-ID                        VALUE 'PB'.
  4232
  4233     12  PB-CONTROL-PRIMARY.
  4234         16  PB-COMPANY-CD                PIC X.
  4235         16  PB-ENTRY-BATCH               PIC X(6).
  4236         16  PB-BATCH-SEQ-NO              PIC S9(4)     COMP.
  4237         16  PB-BATCH-CHG-SEQ-NO          PIC S9(4)     COMP.
  4238
  4239     12  PB-CONTROL-BY-ACCOUNT.
  4240         16  PB-COMPANY-CD-A1             PIC X.
  4241         16  PB-CARRIER                   PIC X.
  4242         16  PB-GROUPING.
  4243             20  PB-GROUPING-PREFIX       PIC XXX.
  4244             20  PB-GROUPING-PRIME        PIC XXX.
  4245         16  PB-STATE                     PIC XX.
  4246         16  PB-ACCOUNT.
  4247             20  PB-ACCOUNT-PREFIX        PIC X(4).
  4248             20  PB-ACCOUNT-PRIME         PIC X(6).
  4249         16  PB-CERT-EFF-DT               PIC XX.
  4250         16  PB-CERT-NO.
  4251             20  PB-CERT-PRIME            PIC X(10).
  4252             20  PB-CERT-SFX              PIC X.
  4253         16  PB-ALT-CHG-SEQ-NO            PIC S9(4)     COMP.
  4254
  4255         16  PB-RECORD-TYPE               PIC X.
  4256             88  PB-MAILING-DATA                VALUE '0'.
  4257             88  PB-ISSUE                       VALUE '1'.
  4258             88  PB-CANCELLATION                VALUE '2'.
  4259             88  PB-BATCH-TRAILER               VALUE '9'.
  4260
  4261     12  PB-CONTROL-BY-ORIG-BATCH.
  4262         16  PB-ORIGINAL-COMPANY-CD       PIC X.
  4263         16  PB-ORIGINAL-ENTRY-BATCH      PIC X(6).
  4264         16  PB-ORIGINAL-SEQ-NO           PIC S9(4)     COMP.
  4265         16  PB-ORIGINAL-CHG-SEQ-NO       PIC S9(4)     COMP.
  4266
  4267     12  PB-CONTROL-BY-CSR.
  4268         16  PB-CSR-COMPANY-CD            PIC X.
  4269         16  PB-CSR-ID                    PIC X(4).
  4270         16  PB-CSR-ENTRY-BATCH           PIC X(6).
  4271         16  PB-CSR-BATCH-SEQ-NO          PIC S9(4)     COMP.
  4272         16  PB-CSR-BATCH-CHG-SEQ-NO      PIC S9(4)     COMP.
  4273******************************************************************
  4274*    MAILING DATA IS PROCESSED IN ONLY PRGS. EL512 & EL513       *
  4275******************************************************************
  4276
  4277     12  PB-LAST-MAINT-DT                 PIC XX.
  4278     12  PB-LAST-MAINT-BY                 PIC X(4).
  4279     12  PB-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.
  4280
  4281     12  PB-RECORD-BODY                   PIC X(375).
  4282
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  86
* ECS010P.cbl (/apps/prod/cid1p/copy/ERCPNDB)
  4283     12  PB-ISSUE-RECORD   REDEFINES PB-RECORD-BODY.
  4284         16  PB-CERT-ORIGIN               PIC X.
  4285             88  CLASIC-CREATED-CERT         VALUE '1'.
  4286         16  PB-I-NAME.
  4287             20  PB-I-INSURED-LAST-NAME   PIC X(15).
  4288             20  PB-I-INSURED-FIRST-NAME.
  4289                 24  PB-I-INSURED-1ST-INIT PIC X.
  4290                 24  FILLER                PIC X(9).
  4291             20  PB-I-INSURED-MIDDLE-INIT PIC X.
  4292         16  PB-I-AGE                     PIC S99   COMP-3.
  4293         16  PB-I-JOINT-AGE               PIC S99   COMP-3.
  4294         16  PB-I-BIRTHDAY                PIC XX.
  4295         16  PB-I-INSURED-SEX             PIC X.
  4296             88  PB-SEX-MALE     VALUE 'M'.
  4297             88  PB-SEX-FEMALE   VALUE 'F'.
  4298
  4299         16  PB-I-LF-TERM                 PIC S999   COMP-3.
  4300         16  PB-I-AH-TERM                 PIC S999   COMP-3.
  4301         16  PB-I-LOAN-TERM               PIC S999   COMP-3.
  4302         16  PB-I-PAY-FREQUENCY           PIC S99    COMP-3.
  4303         16  PB-I-SKIP-CODE               PIC X.
  4304             88  PB-NO-MONTHS-SKIPPED      VALUE ' ' '0'.
  4305             88  PB-SKIP-JULY              VALUE '1'.
  4306             88  PB-SKIP-AUGUST            VALUE '2'.
  4307             88  PB-SKIP-SEPTEMBER         VALUE '3'.
  4308             88  PB-SKIP-JULY-AUG          VALUE '4'.
  4309             88  PB-SKIP-AUG-SEPT          VALUE '5'.
  4310             88  PB-SKIP-JULY-AUG-SEPT     VALUE '6'.
  4311             88  PB-SKIP-JUNE-JULY-AUG     VALUE '7'.
  4312             88  PB-SKIP-JUNE              VALUE '8'.
  4313             88  PB-SKIP-JUNE-JULY         VALUE '9'.
  4314             88  PB-SKIP-AUG-SEPT-OCT      VALUE 'A'.
  4315             88  PB-SKIP-BI-WKLY-3RD-PMT   VALUE 'X'.
  4316         16  PB-I-TERM-TYPE               PIC X.
  4317             88  PB-PAID-MONTHLY           VALUE ' ' 'M'.
  4318             88  PB-PAID-WEEKLY            VALUE 'W'.
  4319             88  PB-PAID-SEMI-MONTHLY      VALUE 'S'.
  4320             88  PB-PAID-BI-WEEKLY         VALUE 'B'.
  4321             88  PB-PAID-13-YEARLY         VALUE 'T'.
  4322         16  PB-I-NO-OF-PAYMENTS          PIC S999   COMP-3.
  4323         16  PB-I-POLICY-FORM-NO          PIC X(12).
  4324         16  PB-I-DATA-ENTRY-SW           PIC X.
  4325             88  PB-EFF-DT-PROCESSING      VALUE '1' ' '.
  4326             88  PB-EXT-DAYS-PROCESSING    VALUE '2'.
  4327             88  PB-EXPIRE-DT-PROCESSING   VALUE '3'.
  4328             88  PB-1ST-PMT-DT-PROCESSING  VALUE '4'.
  4329         16  PB-I-PAYMENT-AMOUNT          PIC S9(7)V99  COMP-3.
  4330         16  PB-I-DCC-OVER-CHG-AMT        PIC S9(5)V99  COMP-3.
  4331*        16  PB-I-MICROFILM-NO            PIC S9(9)      COMP-3.
  4332         16  PB-I-AH-CLP                  PIC S9(5)V99 COMP-3.
  4333         16  FILLER                       PIC X.
  4334
  4335         16  PB-I-LIFE-BENEFIT-CD         PIC XX.
  4336             88  PB-VALID-LIFE               VALUE '01' THRU '89'.
  4337             88  PB-INVALID-LIFE             VALUE '  ' '00'
  4338                                                   '90' THRU '99'.
  4339         16  PB-I-LF-BENEFIT-CD   REDEFINES PB-I-LIFE-BENEFIT-CD
  4340                                          PIC XX.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  87
* ECS010P.cbl (/apps/prod/cid1p/copy/ERCPNDB)
  4341         16  PB-I-LF-BENEFIT-AMT          PIC S9(9)V99   COMP-3.
  4342         16  PB-I-AMOUNT-FINANCED REDEFINES
  4343                  PB-I-LF-BENEFIT-AMT     PIC S9(9)V99   COMP-3.
  4344         16  PB-I-LF-ALT-BENEFIT-AMT      PIC S9(9)V99   COMP-3.
  4345         16  PB-I-UNPAID-CASH-PRICE REDEFINES
  4346                  PB-I-LF-ALT-BENEFIT-AMT PIC S9(9)V99   COMP-3.
  4347         16  PB-I-LF-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  4348         16  PB-I-LF-ALT-PREMIUM-AMT      PIC S9(7)V99   COMP-3.
  4349         16  PB-I-CLP-AMOUNT REDEFINES
  4350                  PB-I-LF-ALT-PREMIUM-AMT PIC S9(7)V99   COMP-3.
  4351         16  PB-I-LF-CALC-FLAG            PIC X.
  4352             88 PB-COMP-LF-PREM               VALUE '?'.
  4353         16  PB-I-LF-PREM-CALC            PIC S9(7)V99   COMP-3.
  4354         16  PB-I-LF-ALT-PREM-CALC        PIC S9(7)V99   COMP-3.
  4355         16  PB-I-LF-RATE                 PIC S99V9(5)   COMP-3.
  4356         16  PB-I-LF-ALT-RATE             PIC S99V9(5)   COMP-3.
  4357         16  PB-I-LF-POLICY-FEE           PIC S9(3)V99   COMP-3.
  4358         16  PB-I-LF-REI-RATE             PIC S99V9(5)   COMP-3.
  4359         16  PB-I-LF-ALT-REI-RATE         PIC S99V9(5)   COMP-3.
  4360         16  PB-I-LF-ABBR                 PIC XXX.
  4361         16  PB-I-LF-INPUT-CD             PIC XX.
  4362
  4363         16  PB-I-AH-BENEFIT-CD           PIC XX.
  4364             88  PB-VALID-AH                 VALUE '01' THRU '89'.
  4365             88  PB-INVALID-AH               VALUE '  ' '00'
  4366                                                   '90' THRU '99'.
  4367         16  PB-I-AH-BENEFIT-AMT          PIC S9(7)V99   COMP-3.
  4368         16  PB-I-AH-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  4369         16  PB-I-AH-CALC-FLAG            PIC X.
  4370             88 PB-COMP-AH-PREM                  VALUE '?'.
  4371         16  PB-I-AH-PREM-CALC            PIC S9(7)V99   COMP-3.
  4372         16  PB-I-AH-RATE                 PIC S99V9(5)   COMP-3.
  4373         16  PB-I-AH-POLICY-FEE           PIC S9(3)V99   COMP-3.
  4374         16  PB-I-AH-REI-RATE             PIC S99V9(5)   COMP-3.
  4375         16  PB-I-AH-RATE-TRM             PIC S999       COMP-3.
  4376         16  PB-I-AH-ABBR                 PIC XXX.
  4377         16  PB-I-AH-INPUT-CD             PIC XXX.
  4378
  4379         16  PB-I-SPECIAL-REIN-CODE       PIC X.
  4380         16  PB-I-REIN-TABLE              PIC XXX.
  4381         16  PB-I-BUSINESS-TYPE           PIC 99.
  4382         16  PB-I-INDV-GRP-CD             PIC X.
  4383         16  PB-I-MORT-CODE.
  4384             20  PB-I-TABLE               PIC X.
  4385             20  PB-I-INTEREST            PIC XX.
  4386             20  PB-I-MORT-TYP            PIC X.
  4387         16  PB-I-LF-CRIT-PER             PIC S9(3)      COMP-3.
  4388         16  PB-I-AH-CRIT-PER             PIC S9(3)      COMP-3.
  4389         16  PB-I-LF-CLP                  PIC S9(5)V99   COMP-3.
  4390         16  PB-I-INDV-GRP-OVRD           PIC X.
  4391         16  PB-I-RATE-CLASS-OVRD         PIC XX.
  4392         16  PB-I-SIG-SW                  PIC X.
  4393             88  PB-POLICY-SIGNED             VALUE 'Y'.
  4394         16  PB-I-RATE-CLASS              PIC XX.
  4395         16  PB-I-RATE-DEVIATION-LF       PIC XXX.
  4396         16  PB-I-RATE-DEVIATION-AH       PIC XXX.
  4397         16  PB-I-RATE-DEV-PCT-LF         PIC S9V9(6)    COMP-3.
  4398         16  PB-I-RATE-DEV-PCT-AH         PIC S9V9(6)    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  88
* ECS010P.cbl (/apps/prod/cid1p/copy/ERCPNDB)
  4399         16  PB-I-LIFE-COMMISSION         PIC SV9(5)     COMP-3.
  4400         16  PB-I-JOINT-COMMISSION        PIC SV9(5)     COMP-3.
  4401         16  PB-I-AH-COMMISSION           PIC SV9(5)     COMP-3.
  4402         16  PB-I-BENEFIT-TYPE            PIC XXX.
  4403         16  PB-I-OB-FLAG                 PIC X.
  4404             88  PB-I-OB                      VALUE 'B'.
  4405             88  PB-I-SUMMARY                 VALUE 'Z'.
  4406         16  PB-I-ENTRY-STATUS            PIC X.
  4407             88  PB-I-POLICY-IS-ACTIVE        VALUE '1' '3' '4'
  4408                                              'M' '5' '9' '2'.
  4409             88  PB-I-NORMAL-ENTRY            VALUE '1'.
  4410             88  PB-I-POLICY-PENDING          VALUE '2'.
  4411             88  PB-I-CONVERSION-ENTRY        VALUE '4'.
  4412             88  PB-I-POLICY-IS-REISSUE       VALUE '5'.
  4413             88  PB-I-POLICY-IS-CASH          VALUE 'C'.
  4414             88  PB-I-POLICY-IS-MONTHLY       VALUE 'M'.
  4415             88  PB-I-REIN-ONLY               VALUE '9'.
  4416             88  PB-I-POLICY-IS-DECLINED      VALUE 'D'.
  4417             88  PB-I-POLICY-IS-VOIDED        VALUE 'V'.
  4418             88  PB-I-PREM-ACCTNG-ONLY        VALUE 'P'.
  4419             88  PB-I-UNDERWRITE-POLICY       VALUE 'U'.
  4420         16  PB-I-INT-CODE                PIC X.
  4421             88  PB-ADD-ON-INTEREST           VALUE 'A'.
  4422             88  PB-SIMPLE-INTEREST           VALUE 'S'.
  4423         16  PB-I-LOAN-APR                PIC 9(3)V9(4)   COMP-3.
  4424         16  PB-I-SOC-SEC-NO              PIC X(11).
  4425         16  PB-I-MEMBER-NO               PIC X(12).
  4426         16  PB-I-CURR-SEQ                PIC S9(4)       COMP.
  4427*        16  PB-I-LOAN-OFFICER            PIC XXX.
  4428         16  PB-I-OLD-LOF                 PIC XXX.
  4429         16  PB-I-LF-EXPIRE-DT            PIC XX.
  4430         16  PB-I-AH-EXPIRE-DT            PIC XX.
  4431         16  PB-I-EXTENTION-DAYS          PIC S999        COMP-3.
  4432         16  PB-I-TERM-IN-DAYS            PIC S9(5)       COMP-3.
  4433         16  PB-I-LIFE-INDICATOR          PIC X.
  4434             88  PB-I-JOINT-COVERAGE         VALUE 'J'.
  4435         16  PB-I-LIVES                   PIC S9(7)       COMP-3.
  4436         16  PB-I-DDF-IU-RATE-UP REDEFINES PB-I-LIVES
  4437                                          PIC S9(5)V99    COMP-3.
  4438         16  PB-I-MAIL-ADDRS-SW           PIC X.
  4439             88 PB-I-MAIL-ADDRS-NOT-PRESENT  VALUE ' '.
  4440             88 PB-I-MAIL-ADDRS-PRESENT      VALUE '1'.
  4441         16  PB-I-1ST-PMT-DT              PIC XX.
  4442         16  PB-I-JOINT-INSURED.
  4443             20 PB-I-JOINT-LAST-NAME      PIC X(15).
  4444             20 PB-I-JOINT-FIRST-NAME.
  4445                24  PB-I-JOINT-FIRST-INIT PIC X.
  4446                24  FILLER                PIC X(9).
  4447             20 PB-I-JOINT-MIDDLE-INIT    PIC X.
  4448*        16  PB-I-BENEFICIARY-NAME        PIC X(25).
  4449         16  PB-I-BENEFICIARY-NAME.
  4450             20  PB-I-BANK-NUMBER         PIC X(10).
  4451             20  FILLER                   PIC X(15).
  4452         16  PB-I-LAST-ADD-ON-DT          PIC XX.
  4453         16  PB-I-REFERENCE               PIC X(12).
  4454         16  FILLER REDEFINES PB-I-REFERENCE.
  4455             20  PB-I-TOT-FEES            PIC S9(7)V99 COMP-3.
  4456             20  PB-I-TOT-FEES-CALC       PIC S9(7)V99 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  89
* ECS010P.cbl (/apps/prod/cid1p/copy/ERCPNDB)
  4457             20  PB-I-CLP-STATE           PIC XX.
  4458         16  PB-I-UNDERWRITING-STATUS     PIC X.
  4459             88  PB-I-POLICY-ACCEPTED         VALUE 'A' 'N'.
  4460             88  PB-I-POLICY-DECLINED         VALUE 'D'.
  4461             88  PB-I-NEEDS-UNDERWRITING      VALUE 'U'.
  4462         16  PB-I-STATE-TAX               PIC S9(7)V99 COMP-3.
  4463         16  PB-I-MUNI-TAX                PIC S9(7)V99 COMP-3.
  4464         16  PB-I-RESIDENT-STATE          PIC XX.
  4465         16  PB-I-RATE-CODE               PIC X(4).
  4466         16  PB-I-NUM-BILLED              PIC S9(7)    COMP-3.
  4467         16  PB-I-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  4468         16  PB-I-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  4469         16  PB-I-BANK-FEE                PIC S999V99  COMP-3.
  4470         16  PB-I-BANK-NOCHRGB            PIC 99.
  4471         16  PB-I-ADDL-CLP                PIC S9(5)V99 COMP-3.
  4472         16  PB-I-JOINT-BIRTHDAY          PIC XX.
  4473
  4474     12  PB-CANCEL-RECORD   REDEFINES PB-RECORD-BODY.
  4475         16  PB-C-LF-CANCEL-VOID-SW       PIC X.
  4476             88  PB-C-LF-CANCEL-VOIDED        VALUE '1'.
  4477         16  PB-C-CANCEL-ORIGIN           PIC X.
  4478             88  PB-C-CLAIM-CREATED-CANCEL   VALUE '1'.
  4479         16  PB-C-LF-CANCEL-DT            PIC XX.
  4480         16  PB-C-LF-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  4481         16  PB-C-LF-CALC-REQ             PIC X.
  4482             88 PB-COMP-LF-CANCEL            VALUE '?'.
  4483         16  PB-C-LF-REF-CALC             PIC S9(7)V99    COMP-3.
  4484         16  PB-C-LF-REM-TERM             PIC S9(3)       COMP-3.
  4485         16  PB-C-AH-CANCEL-VOID-SW       PIC X.
  4486             88  PB-C-AH-CANCEL-VOIDED        VALUE '1'.
  4487         16  PB-C-AH-CANCEL-DT            PIC XX.
  4488         16  PB-C-AH-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  4489         16  PB-C-AH-CALC-REQ             PIC X.
  4490             88 PB-COMP-AH-CANCEL            VALUE '?'.
  4491         16  PB-C-AH-REF-CALC             PIC S9(7)V99    COMP-3.
  4492         16  PB-C-AH-REM-TERM             PIC S9(3)       COMP-3.
  4493         16  PB-C-LAST-NAME               PIC X(15).
  4494         16  PB-C-REFUND-SW               PIC X.
  4495             88  PB-C-REFUND-CREATED          VALUE 'Y'.
  4496             88  PB-C-REFUND-REQUESTED        VALUE 'R'.
  4497         16  PB-C-LIVES                   PIC S9(3)       COMP-3.
  4498         16  PB-C-PAYEE-CODE              PIC X(6).
  4499         16  PB-C-LF-REFUND-OVERRIDE      PIC X.
  4500         16  PB-C-AH-REFUND-OVERRIDE      PIC X.
  4501         16  PB-C-LF-COMM-CHARGEBACK      PIC X.
  4502         16  PB-C-AH-COMM-CHARGEBACK      PIC X.
  4503         16  PB-C-REFERENCE               PIC X(12).
  4504         16  PB-C-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  4505         16  PB-C-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  4506         16  PB-C-POST-CARD-IND           PIC X.
  4507         16  PB-C-CANCEL-REASON           PIC X.
  4508         16  PB-C-REF-INTERFACE-SW        PIC X.
  4509         16  PB-C-LF-RFND-CLP             PIC S9(5)V99 COMP-3.
  4510         16  PB-C-AH-RFND-CLP             PIC S9(5)V99 COMP-3.
  4511         16  FILLER                       PIC X(01).
  4512*        16  FILLER                       PIC X(18).
  4513         16  PB-C-POLICY-FORM-NO          PIC X(12).
  4514*        16  PB-C-MICROFILM-NO            PIC S9(9)      COMP-3.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  90
* ECS010P.cbl (/apps/prod/cid1p/copy/ERCPNDB)
  4515         16  PB-C-NH-INT-ON-REFS          PIC S9(7)V99   COMP-3.
  4516         16  PB-CANCELED-CERT-DATA.
  4517             20  PB-CI-INSURED-NAME.
  4518                 24  PB-CI-LAST-NAME      PIC X(15).
  4519                 24  PB-CI-INITIALS       PIC XX.
  4520             20  PB-CI-INSURED-AGE        PIC S99         COMP-3.
  4521             20  PB-CI-INSURED-SEX        PIC X.
  4522             20  PB-CI-LF-TERM            PIC S999        COMP-3.
  4523             20  PB-CI-LF-BENEFIT-CD      PIC XX.
  4524             20  PB-CI-LF-BENEFIT-AMT     PIC S9(9)V99    COMP-3.
  4525             20  PB-CI-LF-ALT-BENEFIT-AMT PIC S9(9)V99    COMP-3.
  4526             20  PB-CI-LF-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  4527             20  PB-CI-LF-ALT-PREMIUM-AMT PIC S9(7)V99    COMP-3.
  4528             20  PB-CI-AH-TERM            PIC S999        COMP-3.
  4529             20  PB-CI-AH-BENEFIT-CD      PIC XX.
  4530             20  PB-CI-AH-BENEFIT-AMT     PIC S9(7)V99    COMP-3.
  4531             20  PB-CI-AH-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  4532             20  PB-CI-RATE-CLASS         PIC XX.
  4533             20  PB-CI-RATE-DEV-LF        PIC XXX.
  4534             20  PB-CI-RATE-DEV-AH        PIC XXX.
  4535             20  PB-CI-RATE-DEV-PCT-LF    PIC S9V9(6)     COMP-3.
  4536             20  PB-CI-RATE-DEV-PCT-AH    PIC S9V9(6)     COMP-3.
  4537             20  PB-CI-LIFE-COMMISSION    PIC SV9(5)      COMP-3.
  4538             20  PB-CI-AH-COMMISSION      PIC SV9(5)      COMP-3.
  4539             20  PB-CI-LF-ABBR            PIC X(3).
  4540             20  PB-CI-AH-ABBR            PIC X(3).
  4541             20  PB-CI-OB-FLAG            PIC X.
  4542                 88  PB-CI-OB                VALUE 'B'.
  4543             20  PB-CI-LF-POLICY-STATUS   PIC X.
  4544                 88  PB-CI-LF-POLICY-IS-ACTIVE       VALUE '1' '3'
  4545                                           'M' '4' '5' '9' '2'.
  4546                 88  PB-CI-LF-NORMAL-ENTRY           VALUE '1'.
  4547                 88  PB-CI-LF-POLICY-PENDING         VALUE '2'.
  4548                 88  PB-CI-LF-POLICY-IS-RESTORE      VALUE '3'.
  4549                 88  PB-CI-LF-CONVERSION-ENTRY       VALUE '4'.
  4550                 88  PB-CI-LF-POLICY-IS-REISSUE      VALUE '5'.
  4551                 88  PB-CI-LF-POLICY-IS-CASH         VALUE 'C'.
  4552                 88  PB-CI-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  4553                 88  PB-CI-LF-LUMP-SUM-DISAB         VALUE '6'.
  4554                 88  PB-CI-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  4555                 88  PB-CI-LF-CANCEL-APPLIED         VALUE '8'.
  4556                 88  PB-CI-LF-REIN-ONLY              VALUE '9'.
  4557                 88  PB-CI-LF-POLICY-IS-DECLINED     VALUE 'D'.
  4558                 88  PB-CI-LF-POLICY-IS-VOID         VALUE 'V'.
  4559             20  PB-CI-AH-POLICY-STATUS   PIC X.
  4560                 88  PB-CI-AH-POLICY-IS-ACTIVE       VALUE '1' '3'
  4561                                           'M' '4' '5' '9' '2'.
  4562                 88  PB-CI-AH-NORMAL-ENTRY           VALUE '1'.
  4563                 88  PB-CI-AH-POLICY-PENDING         VALUE '2'.
  4564                 88  PB-CI-AH-POLICY-IS-RESTORE      VALUE '3'.
  4565                 88  PB-CI-AH-CONVERSION-ENTRY       VALUE '4'.
  4566                 88  PB-CI-AH-POLICY-IS-REISSUE      VALUE '5'.
  4567                 88  PB-CI-AH-POLICY-IS-CASH         VALUE 'C'.
  4568                 88  PB-CI-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  4569                 88  PB-CI-AH-LUMP-SUM-DISAB         VALUE '6'.
  4570                 88  PB-CI-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  4571                 88  PB-CI-AH-CANCEL-APPLIED         VALUE '8'.
  4572                 88  PB-CI-AH-REIN-ONLY              VALUE '9'.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  91
* ECS010P.cbl (/apps/prod/cid1p/copy/ERCPNDB)
  4573                 88  PB-CI-AH-POLICY-IS-DECLINED     VALUE 'D'.
  4574                 88  PB-CI-AH-POLICY-IS-VOID         VALUE 'V'.
  4575             20  PB-CI-PAY-FREQUENCY      PIC 99.
  4576             20  PB-CI-LOAN-APR           PIC 9(3)V9(4)   COMP-3.
  4577             20  PB-CI-SOC-SEC-NO         PIC X(11).
  4578             20  PB-CI-MEMBER-NO          PIC X(12).
  4579             20  PB-CI-INT-CODE           PIC X.
  4580                 88  PB-CI-ADD-ON                  VALUE 'A'.
  4581                 88  PB-CI-SIMPLE                  VALUE 'S'.
  4582             20  PB-CI-LOAN-TERM          PIC S999        COMP-3.
  4583             20  PB-CI-LOAN-1ST-PMT-DT    PIC X(2).
  4584             20  PB-CI-COMP-EXCP-SW       PIC X.
  4585                 88  PB-CI-NO-COMP-EXCP            VALUE ' '.
  4586                 88  PB-CI-CERT-HAS-ERCOMM-ENTRY   VALUE '1'.
  4587             20  PB-CI-ENTRY-STATUS       PIC X.
  4588             20  PB-CI-CURR-SEQ           PIC S9(4)       COMP.
  4589             20  PB-CI-AH-PAID-THRU-DT    PIC XX.
  4590             20  PB-CI-AH-SETTLEMENT-DT   PIC XX.
  4591             20  PB-CI-DEATH-DT           PIC XX.
  4592             20  PB-CI-LF-PRIOR-CANCEL-DT PIC XX.
  4593             20  PB-CI-AH-PRIOR-CANCEL-DT PIC XX.
  4594             20  PB-CI-AH-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  4595             20  PB-CI-LF-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  4596             20  PB-CI-CREDIT-INTERFACE-SW-1 PIC X.
  4597             20  PB-CI-CREDIT-INTERFACE-SW-2 PIC X.
  4598             20  PB-CI-ENTRY-DT              PIC XX.
  4599             20  PB-CI-ENTRY-BATCH           PIC X(6).
  4600             20  PB-CI-LF-EXPIRE-DT          PIC XX.
  4601             20  PB-CI-AH-EXPIRE-DT          PIC XX.
  4602             20  PB-CI-EXTENTION-DAYS        PIC S999     COMP-3.
  4603             20  PB-CI-TERM-IN-DAYS          PIC S9(5)    COMP-3.
  4604             20  PB-CI-OLD-LOF               PIC XXX.
  4605*            20  PB-CI-LOAN-OFFICER          PIC XXX.
  4606             20  PB-CI-LIVES                 PIC S9(3)    COMP-3.
  4607             20  PB-CI-LF-CRIT-PER           PIC S9(3)    COMP-3.
  4608             20  PB-CI-AH-CRIT-PER           PIC S9(3)    COMP-3.
  4609             20  PB-CI-INDV-GRP-CD           PIC X.
  4610             20  PB-CI-BENEFICIARY-NAME.
  4611                 24  PB-CI-BANK-NUMBER       PIC X(10).
  4612                 24  FILLER                  PIC X(15).
  4613             20  PB-CI-NOTE-SW               PIC X.
  4614             20  PB-CI-CANCEL-FEE            PIC S9(3)V99 COMP-3.
  4615             20  PB-CI-MUNI-TAX              PIC S9(7)V99 COMP-3.
  4616             20  PB-CI-STATE-TAX             PIC S9(7)V99 COMP-3.
  4617             20  PB-CI-ADDL-CLP              PIC S9(5)V99 COMP-3.
  4618             20  PB-CI-LOAN-OFFICER          PIC X(5).
  4619             20  PB-CI-BOW-LOAN-NUMBER       PIC X(14).
  4620             20  PB-CI-FIRST-NAME            PIC X(10).
  4621             20  PB-CI-DDF-IU-RATE-UP        PIC S9(5)V99 COMP-3.
  4622
  4623         16  FILLER                       PIC X(13).
  4624*032306  16  FILLER                       PIC X(27).
  4625*        16  FILLER                       PIC X(46).
  4626
  4627     12  PB-MAIL-RECORD    REDEFINES PB-RECORD-BODY.
  4628         16  FILLER                       PIC X(10).
  4629         16  PB-M-INSURED-LAST-NAME       PIC X(15).
  4630         16  PB-M-INSURED-FIRST-NAME      PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  92
* ECS010P.cbl (/apps/prod/cid1p/copy/ERCPNDB)
  4631         16  PB-M-INSURED-MID-INIT        PIC X.
  4632         16  PB-M-INSURED-AGE             PIC 99.
  4633         16  PB-M-INSURED-BIRTHDAY        PIC XX.
  4634         16  PB-M-INSURED-SEX             PIC X.
  4635         16  PB-M-INSURED-SOC-SEC-NO      PIC X(11).
  4636         16  PB-M-INSURED-ADDRESS-1       PIC X(30).
  4637         16  PB-M-INSURED-ADDRESS-2       PIC X(30).
  4638         16  PB-M-INSURED-CITY-STATE.
  4639             20  PB-M-INSURED-CITY        PIC X(28).
  4640             20  PB-M-INSURED-STATE       PIC XX.
  4641         16  PB-M-INSURED-ZIP-CODE.
  4642             20  PB-M-INSURED-ZIP-PRIME.
  4643                 24  PB-M-INSURED-ZIP-1   PIC X.
  4644                     88  PB-M-CANADIAN-POST-CODE
  4645                                             VALUE 'A' THRU 'Z'.
  4646                 24  FILLER               PIC X(4).
  4647             20  PB-M-INSURED-ZIP-PLUS4   PIC X(4).
  4648         16  PB-M-INSURED-CANADIAN-ZIP  REDEFINES
  4649                                        PB-M-INSURED-ZIP-CODE.
  4650             20  PM-M-INS-CAN-POST1       PIC XXX.
  4651             20  PM-M-INS-CAN-POST2       PIC XXX.
  4652             20  FILLER                   PIC XXX.
  4653         16  PB-M-INSURED-PHONE-NO        PIC 9(10).
  4654         16  PB-M-JOINT-BIRTHDAY          PIC XX.
  4655         16  PB-M-CRED-BENE-NAME          PIC X(30).
  4656         16  PB-M-CRED-BENE-ADDR1         PIC X(30).
  4657         16  PB-M-CRED-BENE-ADDR2         PIC X(30).
  4658         16  PB-M-CRED-BENE-CITYST.
  4659             20  PB-M-CRED-BENE-CITY      PIC X(28).
  4660             20  PB-M-CRED-BENE-STATE     PIC XX.
  4661
  4662         16  FILLER                       PIC X(92).
  4663
  4664     12  PB-BATCH-RECORD   REDEFINES PB-RECORD-BODY.
  4665         16  FILLER                       PIC X(10).
  4666         16  PB-B-LF-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4667         16  PB-B-LF-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4668         16  PB-B-LF-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4669         16  PB-B-LF-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4670         16  PB-B-LF-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4671         16  PB-B-LF-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4672         16  PB-B-AH-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4673         16  PB-B-AH-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4674         16  PB-B-AH-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4675         16  PB-B-AH-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4676         16  PB-B-AH-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4677         16  PB-B-AH-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4678         16  PB-B-ISSUE-CNT-REMITTED      PIC S9(5)    COMP-3.
  4679         16  PB-B-ISSUE-CNT-ENTERED       PIC S9(5)    COMP-3.
  4680         16  PB-B-CANCEL-CNT-REMITTED     PIC S9(5)    COMP-3.
  4681         16  PB-B-CANCEL-CNT-ENTERED      PIC S9(5)    COMP-3.
  4682         16  PB-B-HIGHEST-SEQ-NO          PIC S9(4)    COMP.
  4683         16  PB-ACCOUNT-NAME              PIC X(30).
  4684         16  PB-PREM-REF-RPT-FLAG         PIC X.
  4685         16  PB-REFERENCE                 PIC X(12).
  4686         16  PB-B-RECEIVED-DT             PIC XX.
  4687         16  FILLER                       PIC X(234).
  4688
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  93
* ECS010P.cbl (/apps/prod/cid1p/copy/ERCPNDB)
  4689     12  PB-RECORD-STATUS.
  4690         16  PB-CREDIT-SELECT-DT          PIC XX.
  4691         16  PB-CREDIT-ACCEPT-DT          PIC XX.
  4692         16  PB-BILLED-DT                 PIC XX.
  4693         16  PB-BILLING-STATUS            PIC X.
  4694             88  PB-ENTRY-REVERSED            VALUE 'R'.
  4695             88  PB-EL860-INTERNAL-ERROR      VALUE 'E'.
  4696             88  PB-EL860-INTERNAL-PROCESS    VALUE 'P'.
  4697         16  PB-RECORD-BILL               PIC X.
  4698             88  PB-RECORD-ON-HOLD            VALUE 'H'.
  4699             88  PB-RECORD-RETURNED           VALUE 'R'.
  4700             88  PB-RECORD-ENDORSED           VALUE 'E'.
  4701             88  PB-OVERRIDE-LIFE             VALUE 'L'.
  4702             88  PB-OVERRIDE-AH               VALUE 'A'.
  4703             88  PB-OVERRIDE-BOTH             VALUE 'B'.
  4704         16  PB-BATCH-ENTRY               PIC X.
  4705             88  PB-POLICY-IS-DECLINED        VALUE 'D'.
  4706             88  PB-REIN-ONLY-CERT            VALUE 'R'.
  4707             88  PB-REISSUED-CERT             VALUE 'E'.
  4708             88  PB-CASH-CERT                 VALUE 'C'.
  4709             88  PB-MONTHLY-CERT              VALUE 'M'.
  4710             88  PB-PREM-ACCTNG-ONLY          VALUE 'P'.
  4711             88  PB-NEEDS-UNDERWRITING        VALUE 'U'.
  4712             88  PB-POLICY-IS-VOIDED          VALUE 'V'.
  4713         16  PB-FORCE-CODE                PIC X.
  4714             88  PB-FORCE-OFF                 VALUE ' ' '0'.
  4715             88  PB-ISSUE-FORCE               VALUE 'A' 'O'.
  4716             88  PB-CANCEL-FORCE              VALUE '8'.
  4717             88  PB-ALL-ISSUE-FORCED          VALUE 'A' 'O'.
  4718             88  PB-ALL-CANCEL-FORCED         VALUE '8'.
  4719             88  PB-ALL-CANCEL-FORCED-NO-FEE  VALUE '9'.
  4720             88  PB-CANCEL-DATE-FORCED        VALUE 'D'.
  4721             88  PB-CANCEL-DATE-FORCED-NO-FEE VALUE 'E'.
  4722             88  PB-ISSUE-DATE-FORCED         VALUE 'D'.
  4723             88  PB-OVERCHARGE-FORCE          VALUE 'O'.
  4724         16  PB-FATAL-FLAG                PIC X.
  4725             88  PB-FATAL-ERRORS              VALUE 'X'.
  4726         16  PB-FORCE-ER-CD               PIC X.
  4727             88  PB-FORCE-ERRORS              VALUE 'F'.
  4728             88  PB-UNFORCED-ERRORS           VALUE 'X'.
  4729         16  PB-WARN-ER-CD                PIC X.
  4730             88  PB-WARNING-ERRORS            VALUE 'W'.
  4731         16  FILLER                       PIC X.
  4732         16  PB-OUT-BAL-CD                PIC X.
  4733             88  PB-OUT-OF-BAL                VALUE 'O'.
  4734         16  PB-LIFE-OVERRIDE-L1          PIC X.
  4735         16  PB-AH-OVERRIDE-L1            PIC X.
  4736         16  PB-INPUT-DT                  PIC XX.
  4737         16  PB-INPUT-BY                  PIC X(4).
  4738         16  PB-CHG-COUNT                 PIC 9(3)        COMP-3.
  4739         16  PB-CALC-TOLERANCE            PIC 9(3)V99     COMP-3.
  4740         16  PB-TOLERANCE-REJECT-SW       PIC X.
  4741         16  PB-LF-EARNING-METHOD         PIC X.
  4742         16  PB-AH-EARNING-METHOD         PIC X.
  4743         16  PB-LF-TERM-CALC-METHOD       PIC X.
  4744         16  PB-AH-TERM-CALC-METHOD       PIC X.
  4745         16  PB-REIN-CD                   PIC XXX.
  4746         16  PB-LF-REFUND-TYPE            PIC X.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  94
* ECS010P.cbl (/apps/prod/cid1p/copy/ERCPNDB)
  4747         16  PB-AH-REFUND-TYPE            PIC X.
  4748         16  PB-ACCT-EFF-DT               PIC XX.
  4749         16  PB-ACCT-EXP-DT               PIC XX.
  4750         16  PB-COMPANY-ID                PIC X(3).
  4751         16  PB-LF-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  4752         16  PB-AH-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  4753         16  PB-SV-CARRIER                PIC X.
  4754         16  PB-SV-GROUPING               PIC X(6).
  4755         16  PB-SV-STATE                  PIC XX.
  4756         16  PB-CONFIRMATION-REPT-DT      PIC XX.
  4757         16  PB-GA-BILLING-INFO.
  4758             20  PB-GA-BILL-DT OCCURS 5 TIMES
  4759                                          PIC XX.
  4760         16  PB-SV-REMIT-TO  REDEFINES
  4761             PB-GA-BILLING-INFO           PIC X(10).
  4762         16  PB-NO-OF-ERRORS              PIC S9(3) COMP-3.
  4763         16  PB-I-LOAN-OFFICER            PIC X(5).
  4764         16  PB-I-VIN                     PIC X(17).
  4765
  4766         16  FILLER                       PIC X(04).
  4767         16  IMNET-BYPASS-SW              PIC X.
  4768
  4769******************************************************************
  4770*                COMMON EDIT ERRORS                              *
  4771******************************************************************
  4772
  4773     12  PB-COMMON-ERRORS.
  4774         16  PB-COMMON-ERROR    OCCURS 10 TIMES
  4775                                           PIC S9(4)     COMP.
  4776
  4777******************************************************************
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  95
* ECS010P.cbl
  4779 01  PC-STARTS-HERE              PIC X(48)
  4780       VALUE '*****   PENDING CLAIMS RECORD STARTS HERE   ****'.
  4781
* 4782                             COPY ERCPNDC.
  4783******************************************************************04/29/98
  4784*                                                                *ERCPNDC
  4785*                                                                *ERCPNDC
  4786*                            ERCPNDC                             *   LV003
  4787*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
  4788*                            VMOD=2.004                          *   CL**2
  4789*                                                                *ERCPNDC
  4790*   FILE DESCRIPTION = PENDING CLAIM TRANSACTIONS                *ERCPNDC
  4791*                      PAYMENTS, RESERVES, EXPENSES              *ERCPNDC
  4792*                                                                *ERCPNDC
  4793*   FILE TYPE = VSAM,KSDS                                        *ERCPNDC
  4794*   RECORD SIZE = 500  RECFORM = FIXED                           *ERCPNDC
  4795*                                                                *ERCPNDC
  4796*   BASE CLUSTER = ERPNDC                         RKP=2,LEN=50   *ERCPNDC
  4797*       ALTERNATE PATHS = NONE                                   *ERCPNDC
  4798*                                                                *ERCPNDC
  4799*   LOG = YES                                                    *ERCPNDC
  4800*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *ERCPNDC
  4801******************************************************************ERCPNDC
  4802                                                                  ERCPNDC
  4803 01  PENDING-CLAIMS.                                              ERCPNDC
  4804     12  PC-RECORD-ID                     PIC XX.                 ERCPNDC
  4805         88  VALID-PC-ID                      VALUE 'PC'.         ERCPNDC
  4806                                                                  ERCPNDC
  4807     12  PC-CONTROL-PRIMARY.                                      ERCPNDC
  4808         16  PC-COMPANY-CD                PIC X.                  ERCPNDC
  4809         16  PC-CARRIER                   PIC X.                  ERCPNDC
  4810         16  PC-GROUPING.                                         ERCPNDC
  4811             20  PC-GROUPING-PREFIX       PIC XXX.                ERCPNDC
  4812             20  PC-GROUPING-PRIME        PIC XXX.                ERCPNDC
  4813         16  PC-STATE                     PIC XX.                 ERCPNDC
  4814         16  PC-ACCOUNT.                                          ERCPNDC
  4815             20  PC-ACCOUNT-PREFIX        PIC X(4).               ERCPNDC
  4816             20  PC-ACCOUNT-PRIME         PIC X(6).               ERCPNDC
  4817         16  PC-CERT-EFF-DT               PIC XX.                 ERCPNDC
  4818         16  PC-CERT-NO.                                          ERCPNDC
  4819             20  PC-CERT-PRIME            PIC X(10).              ERCPNDC
  4820             20  PC-CERT-SFX              PIC X.                  ERCPNDC
  4821         16  PC-CLAIM-NO                  PIC X(7).               ERCPNDC
  4822         16  PC-CHECK-NO                  PIC X(7).               ERCPNDC
  4823                                                                  ERCPNDC
  4824         16  PC-RECORD-TYPE               PIC X.                  ERCPNDC
  4825             88  PC-CLAIMS                    VALUE '1'.          ERCPNDC
  4826             88  PC-RESERVES                  VALUE '2'.          ERCPNDC
  4827         16  PC-RECORD-SEQUENCE           PIC S9(4)     COMP.     ERCPNDC
  4828                                                                  ERCPNDC
  4829     12  PC-LAST-MAINT-DT                 PIC XX.                 ERCPNDC
  4830     12  PC-LAST-MAINT-BY                 PIC X(4).               ERCPNDC
  4831     12  PC-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.   ERCPNDC
  4832                                                                  ERCPNDC
  4833     12  PC-CLAIM-RECORD.                                         ERCPNDC
  4834         16  PC-CLAIM-TYPE                PIC X.                  ERCPNDC
  4835             88  PC-LF-CLAIM                  VALUE '1'.          ERCPNDC
  4836             88  PC-AH-CLAIM                  VALUE '2'.          ERCPNDC
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  96
* ECS010P.cbl (/apps/prod/cid1p/copy/ERCPNDC)
  4837             88  PC-OB-LF-CLAIM               VALUE '3'.          ERCPNDC
  4838             88  PC-OB-AH-CLAIM               VALUE '4'.          ERCPNDC
  4839         16  PC-PAYMENT-DT                PIC XX.                 ERCPNDC
  4840         16  PC-PAID-THRU-DT              PIC XX.                 ERCPNDC
  4841         16  PC-REPORTED-DT               PIC XX.                 ERCPNDC
  4842         16  PC-INCURRED-DT               PIC XX.                 ERCPNDC
  4843         16  PC-NO-OF-DAYS-PAID           PIC S9(3)     COMP-3.   ERCPNDC
  4844         16  PC-CLAIM-PAYMENT             PIC S9(7)V99  COMP-3.   ERCPNDC
  4845         16  PC-AGE-AT-CLAIM              PIC 99.                 ERCPNDC
  4846         16  FILLER                       PIC XX.                 ERCPNDC
  4847         16  PC-PAYMENT-TYPE              PIC X.                  ERCPNDC
  4848             88  PC-PARTIAL-PAYMENT           VALUE '1'.          ERCPNDC
  4849             88  PC-FINAL-PAYMENT             VALUE '2'.          ERCPNDC
  4850             88  PC-LUMP-SUM-PAYMENT          VALUE '3'.          ERCPNDC
  4851             88  PC-ADDITIONAL-PAYMENT        VALUE '4'.          ERCPNDC
  4852             88  PC-CHARGEBLE-EXPENSE         VALUE '5'.          ERCPNDC
  4853             88  PC-NON-CHARGEBLE-EXPENSE     VALUE '6'.          ERCPNDC
  4854             88  PC-VOIDED-PAYMENT            VALUE '9'.          ERCPNDC
  4855                                                                  ERCPNDC
  4856         16  PC-FUTURE-RESERVE-AMT        PIC S9(7)V99  COMP-3.   ERCPNDC
  4857         16  PC-IBNR-RESERVE-AMT          PIC S9(7)V99  COMP-3.   ERCPNDC
  4858         16  PC-PTC-RESERVE-AMT           PIC S9(7)V99  COMP-3.   ERCPNDC
  4859         16  PC-MANUAL-RESERVE-AMT        PIC S9(7)V99  COMP-3.   ERCPNDC
  4860                                                                  ERCPNDC
  4861         16  PC-SV-CARRIER                PIC X.                  ERCPNDC
  4862         16  PC-SV-GROUPING               PIC X(6).               ERCPNDC
  4863         16  PC-SV-STATE                  PIC XX.                 ERCPNDC
  4864                                                                  ERCPNDC
  4865         16  PC-VOID-SW                   PIC X.                  ERCPNDC
  4866             88  PC-PUT-CERT-INFORCE          VALUE '1'.          ERCPNDC
  4867                                                                  ERCPNDC
  4868         16  PC-CAUSE-CODE                PIC X(6).               ERCPNDC
  4869         16  FILLER                       PIC X(48).              ERCPNDC
  4870                                                                  ERCPNDC
  4871         16  PC-CLAIMED-CERT-DATA.                                ERCPNDC
  4872             20  PC-CC-INSURED-NAME.                              ERCPNDC
  4873                 24  PC-CC-LAST-NAME      PIC X(15).              ERCPNDC
  4874                 24  PC-CC-INITIALS       PIC XX.                 ERCPNDC
  4875             20  PC-CC-INSURED-AGE        PIC S99.                ERCPNDC
  4876             20  PC-CC-INSURED-SEX        PIC X.                  ERCPNDC
  4877             20  PC-CC-ORIG-TERM          PIC S999        COMP-3. ERCPNDC
  4878             20  PC-CC-LF-BENEFIT-CD      PIC XX.                 ERCPNDC
  4879             20  PC-CC-LIFE-BENEFIT-AMT   PIC S9(9)V99    COMP-3. ERCPNDC
  4880             20  PC-CC-ALT-LF-BENEFIT-AMT PIC S9(9)V99    COMP-3. ERCPNDC
  4881             20  PC-CC-LIFE-PREMIUM       PIC S9(7)V99    COMP-3. ERCPNDC
  4882             20  PC-CC-AH-BENEFIT-CD      PIC XX.                 ERCPNDC
  4883             20  PC-CC-AH-BENEFIT-AMT     PIC S9(7)V99    COMP-3. ERCPNDC
  4884             20  PC-CC-AH-PREMIUM-AMT     PIC S9(7)V99    COMP-3. ERCPNDC
  4885             20  PC-CC-RATE-CLASS         PIC XX.                 ERCPNDC
  4886             20  PC-CC-RATE-DEV           PIC XXX.                ERCPNDC
  4887             20  PC-CC-OB-FLAG            PIC X.                  ERCPNDC
  4888                 88  PC-CC-OB                VALUE 'B'.           ERCPNDC
  4889             20  PC-CC-AH-POLICY-STATUS   PIC X.                  ERCPNDC
  4890                 88  PC-CCA-POLICY-IS-ACTIVE        VALUE '1' '3' ERCPNDC
  4891                                               '4' '5' '9' '2'.   ERCPNDC
  4892                 88  PC-CCA-NORMAL-ENTRY            VALUE '1'.    ERCPNDC
  4893                 88  PC-CCA-POLICY-PENDING          VALUE '2'.    ERCPNDC
  4894                 88  PC-CCA-POLICY-IS-RESTORE       VALUE '3'.    ERCPNDC
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  97
* ECS010P.cbl (/apps/prod/cid1p/copy/ERCPNDC)
  4895                 88  PC-CCA-CONVERSION-ENTRY        VALUE '4'.    ERCPNDC
  4896                 88  PC-CCA-POLICY-IS-REISSUE       VALUE '5'.    ERCPNDC
  4897                 88  PC-CCA-LUMP-SUM-DISAB          VALUE '6'.    ERCPNDC
  4898                 88  PC-CCA-DEATH-CLAIM-APPLIED     VALUE '7'.    ERCPNDC
  4899                 88  PC-CCA-CANCEL-APPLIED          VALUE '8'.    ERCPNDC
  4900                 88  PC-CCA-REIN-ONLY               VALUE '9'.    ERCPNDC
  4901             20  PC-CC-LF-POLICY-STATUS   PIC X.                  ERCPNDC
  4902                 88  PC-CCL-POLICY-IS-ACTIVE        VALUE '1' '3' ERCPNDC
  4903                                               '4' '5' '9' '2'.   ERCPNDC
  4904                 88  PC-CCL-NORMAL-ENTRY            VALUE '1'.    ERCPNDC
  4905                 88  PC-CCL-POLICY-PENDING          VALUE '2'.    ERCPNDC
  4906                 88  PC-CCL-POLICY-IS-RESTORE       VALUE '3'.    ERCPNDC
  4907                 88  PC-CCL-CONVERSION-ENTRY        VALUE '4'.    ERCPNDC
  4908                 88  PC-CCL-POLICY-IS-REISSUE       VALUE '5'.    ERCPNDC
  4909                 88  PC-CCL-LUMP-SUM-DISAB          VALUE '6'.    ERCPNDC
  4910                 88  PC-CCL-DEATH-CLAIM-APPLIED     VALUE '7'.    ERCPNDC
  4911                 88  PC-CCL-CANCEL-APPLIED          VALUE '8'.    ERCPNDC
  4912                 88  PC-CCL-REIN-ONLY               VALUE '9'.    ERCPNDC
  4913             20  PC-CC-PAY-FREQUENCY      PIC 99.                 ERCPNDC
  4914             20  PC-CC-LOAN-APR           PIC 9(3)V9(4)   COMP-3. ERCPNDC
  4915             20  PC-CC-SOC-SEC-NO         PIC X(11).              ERCPNDC
  4916             20  PC-CC-MEMBER-NO          PIC X(12).              ERCPNDC
  4917             20  PC-CC-INT-CODE           PIC X.                  ERCPNDC
  4918                 88  PC-CC-ADD-ON                  VALUE 'A'.     ERCPNDC
  4919                 88  PC-CC-SIMPLE                  VALUE 'S'.     ERCPNDC
  4920             20  PC-CC-CAPPED-TERM        PIC 999.                ERCPNDC
  4921             20  PC-CC-PRIOR-LUMP-PMT     PIC S9(7)V99  COMP-3.   ERCPNDC
  4922             20  PC-CC-PRIOR-DEATH-AMT    PIC S9(9)V99  COMP-3.   ERCPNDC
  4923             20  PC-CC-CANCEL-DT          PIC XX.                 ERCPNDC
  4924             20  PC-CC-DEATH-DT           PIC XX.                 ERCPNDC
  4925             20  PC-CC-SETTLEMENT-DT      PIC XX.                 ERCPNDC
  4926             20  PC-CC-PRIOR-STATUS       PIC X.                  ERCPNDC
  4927             20  PC-CC-CERT-ENTRY-STATUS  PIC X.                  ERCPNDC
  4928         16  PC-TRLR-SEQ-NO               PIC S9(4)     COMP.     ERCPNDC
  4929         16  PC-CC-CLP-STATE              PIC XX.
  4930         16  FILLER                       PIC X(14).              ERCPNDC
  4931         16  PC-REMAINING-BENEFIT         PIC S9(9)V99  COMP-3.   ERCPNDC
  4932         16  PC-REMAINING-TERM            PIC S9(3)     COMP-3.   ERCPNDC
  4933         16  FILLER                       PIC X(34).              ERCPNDC
  4934                                                                  ERCPNDC
  4935     12  PC-RECORD-STATUS.                                        ERCPNDC
  4936         16  PC-CREDIT-SELECT-DT          PIC XX.                 ERCPNDC
  4937         16  PC-CREDIT-ACCEPT-DT          PIC XX.                 ERCPNDC
  4938         16  FILLER                       PIC XX.                 ERCPNDC
  4939         16  PC-FATAL-FLAG                PIC X.                  ERCPNDC
  4940             88  PC-FATAL-ERRORS             VALUE 'X'.           ERCPNDC
  4941         16  PC-FORCE-CODE                PIC X.                  ERCPNDC
  4942             88  PC-FORCE-OFF                VALUE ' ' '0'.       ERCPNDC
  4943             88  PC-CLAIM-FORCE              VALUE '6' '7'        ERCPNDC
  4944                                                     '8'.         ERCPNDC
  4945         16  PC-FORCE-ER-CD               PIC X.                  ERCPNDC
  4946             88  PC-FORCE-ERRORS             VALUE 'F'.           ERCPNDC
  4947             88  PC-UNFORCED-ERRORS          VALUE 'X'.           ERCPNDC
  4948         16  PC-WARN-ER-CD                PIC X.                  ERCPNDC
  4949             88  PC-WARNING-ERRORS           VALUE 'W'.           ERCPNDC
  4950         16  PC-LF-OVERRIDE-L1            PIC X.                  ERCPNDC
  4951         16  PC-AH-OVERRIDE-L1            PIC X.                  ERCPNDC
  4952         16  FILLER                       PIC X(17).              ERCPNDC
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  98
* ECS010P.cbl (/apps/prod/cid1p/copy/ERCPNDC)
  4953         16  PC-CERT-UPDATE-SW            PIC X.                  ERCPNDC
  4954             88  PC-CERT-DATA-CAPTURED       VALUE '1'.           ERCPNDC
  4955         16  PC-COMPANY-ID                PIC XXX.                ERCPNDC
  4956         16  PC-INPUT-DT                  PIC XX.                 ERCPNDC
  4957                                                                  ERCPNDC
  4958     12  PC-ERROR-FLAGS.                                          ERCPNDC
  4959         16  PC-STANDARD-ERRORS.                                  ERCPNDC
  4960             20  PC-STD-ERROR-FLAGS   OCCURS 25 TIMES PIC X.      ERCPNDC
  4961         16  PC-TRANSACTION-ERRORS.                               ERCPNDC
  4962             20  PC-TRN-ERROR-FLAGS   OCCURS 75 TIMES PIC X.      ERCPNDC
  4963                                                                  ERCPNDC
  4964     12  PC-ERR-FLAGS-R REDEFINES  PC-ERROR-FLAGS.                ERCPNDC
  4965         16  PC-ERR-FLAG              OCCURS 100 TIMES PIC X.     ERCPNDC
  4966                                                                  ERCPNDC
  4967     12  FILLER                           PIC X(25).              ERCPNDC
  4968                                                                  ERCPNDC
  4969******************************************************************ERCPNDC
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  99
* ECS010P.cbl
  4971 01  CC-STARTS-HERE              PIC X(48)
  4972       VALUE '***** CERTIFICATE CHANGE RECORD STARTS HERE ****'.
  4973
* 4974                             COPY ERCCRTC.
  4975******************************************************************04/29/98
  4976*                                                                *ERCCRTC
  4977*                                                                *ERCCRTC
  4978*                            ERCCRTC                             *   LV003
  4979*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  4980*                            VMOD=2.005                          *   CL**3
  4981*                                                                *ERCCRTC
  4982*   FILE DESCRIPTION = PENDING CHANGES TO CERTIFICATE RECORD     *ERCCRTC
  4983*                      (MAINTENANCE ONLY - SEE ERCPNDB FOR NEW   *ERCCRTC
  4984*                       ISSUES AND CANCELS)                      *ERCCRTC
  4985*   FILE TYPE = VSAM,KSDS                                        *ERCCRTC
  4986*   RECORD SIZE = 300  RECFORM = FIXED                           *ERCCRTC
  4987*                                                                *ERCCRTC
  4988*   BASE CLUSTER = ERCRTC                         RKP=2,LEN=37   *ERCCRTC
  4989*       ALTERNATE PATHS = NONE                                   *ERCCRTC
  4990*                                                                *ERCCRTC
  4991*   LOG = YES                                                    *ERCCRTC
  4992*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *ERCCRTC
  4993******************************************************************ERCCRTC
  4994*                   C H A N G E   L O G
  4995*
  4996* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4997*-----------------------------------------------------------------
  4998*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4999* EFFECTIVE    NUMBER
  5000*-----------------------------------------------------------------
  5001* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  5002******************************************************************
  5003 01  PENDING-MAINT-TO-CERT-FILE.                                  ERCCRTC
  5004     12  CC-RECORD-ID                     PIC XX.                 ERCCRTC
  5005         88  VALID-CC-ID                        VALUE 'CC'.       ERCCRTC
  5006                                                                  ERCCRTC
  5007     12  CC-CONTROL-PRIMARY.                                      ERCCRTC
  5008         16  CC-COMPANY-CD                PIC X.                  ERCCRTC
  5009         16  CC-CARRIER                   PIC X.                  ERCCRTC
  5010         16  CC-GROUPING                  PIC X(6).               ERCCRTC
  5011         16  CC-STATE                     PIC XX.                 ERCCRTC
  5012         16  CC-ACCOUNT                   PIC X(10).              ERCCRTC
  5013         16  CC-CERT-EFF-DT               PIC XX.                 ERCCRTC
  5014         16  CC-CERT-NO.                                          ERCCRTC
  5015             20  CC-CERT-PRIME            PIC X(10).              ERCCRTC
  5016             20  CC-CERT-SFX              PIC X.                  ERCCRTC
  5017                                                                  ERCCRTC
  5018         16  CC-FILE-SEQ-NO               PIC S9(8)     COMP.     ERCCRTC
  5019                                                                  ERCCRTC
  5020     12  CC-LAST-MAINT-DT                 PIC XX.                 ERCCRTC
  5021     12  CC-LAST-MAINT-BY                 PIC X(4).               ERCCRTC
  5022     12  CC-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.   ERCCRTC
  5023                                                                  ERCCRTC
  5024     12  CC-RECORD-BODY                   PIC X(191).             ERCCRTC
  5025                                                                  ERCCRTC
  5026     12  CC-CHANGES-RECORD   REDEFINES CC-RECORD-BODY.            ERCCRTC
  5027         16  FILLER                       PIC X(10).              ERCCRTC
  5028         16  CC-NAME.                                             ERCCRTC
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 100
* ECS010P.cbl (/apps/prod/cid1p/copy/ERCCRTC)
  5029             20  CC-INSURED-LAST-NAME     PIC X(15).              ERCCRTC
  5030             20  CC-INSURED-FIRST-NAME.                           ERCCRTC
  5031                 24  CC-INSURED-1ST-INIT  PIC X.                  ERCCRTC
  5032                 24  FILLER               PIC X(9).               ERCCRTC
  5033             20  CC-INSURED-INITIAL2      PIC XX.                 ERCCRTC
  5034         16  CC-AGE                       PIC S99.                ERCCRTC
  5035         16  CC-INSURED-JOINT-AGE         PIC S99.                ERCCRTC
  5036         16  CC-BIRTHDAY                  PIC XX.                 ERCCRTC
  5037         16  CC-INSURED-SEX               PIC X.                  ERCCRTC
  5038             88  CC-SEX-MALE                 VALUE 'M'.           ERCCRTC
  5039             88  CC-SEX-FEMALE               VALUE 'F'.           ERCCRTC
  5040         16  CC-JOINT-INSURED-NAME.                               ERCCRTC
  5041             20  CC-JT-LAST-NAME          PIC X(15).              ERCCRTC
  5042             20  CC-JT-FIRST-NAME.                                ERCCRTC
  5043                 24  CC-JT-1ST-INIT       PIC X.                  ERCCRTC
  5044                 24  FILLER               PIC X(9).               ERCCRTC
  5045             20  CC-JT-INITIAL            PIC X.                  ERCCRTC
  5046         16  CC-LOAN-APR                  PIC 9(3)V9(4).          ERCCRTC
  5047         16  CC-PAY-FREQUENCY             PIC S99.                ERCCRTC
  5048         16  CC-BENEFICIARY               PIC X(25).              ERCCRTC
  5049         16  CC-POLICY-FORM-NO            PIC X(12).              ERCCRTC
  5050         16  CC-PREMIUM-TYPE              PIC X.                  ERCCRTC
  5051         16  CC-IND-GRP-TYPE              PIC X.                  ERCCRTC
  5052         16  CC-LOAN-NUMBER               PIC X(8).               ERCCRTC
  5053         16  CC-LOAN-BALANCE              PIC S9(7)V99  COMP-3.   ERCCRTC
  5054         16  CC-OLD-LOF                   PIC XXX.
  5055*        16  CC-LOAN-OFFICER              PIC XXX.                ERCCRTC
  5056         16  CC-USER-FIELD                PIC X.                  ERCCRTC
  5057         16  CC-SOC-SEC-NO                PIC X(11).              ERCCRTC
  5058         16  CC-MEMBER-NO                 PIC X(12).              ERCCRTC
  5059         16  CC-LF-ORIG-TERM              PIC S9(3).              ERCCRTC
  5060         16  CC-AH-ORIG-TERM              PIC S9(3).              ERCCRTC
  5061         16  FILLER                       PIC X(3).               ERCCRTC
  5062         16  CC-CLAIM-DEDUCT-WITHHELD     PIC S9(5)V99  COMP-3.   ERCCRTC
  5063         16  CC-CANCEL-DEDUCT-WITHHELD    PIC S9(5)V99  COMP-3.   ERCCRTC
  5064         16  CC-LIVES                     PIC S9(7)     COMP-3.   ERCCRTC
  5065         16  CC-BILLED                    PIC S9(7)     COMP-3.   ERCCRTC
  5066         16  CC-LOAN-OFFICER              PIC X(5).
  5067         16  FILLER                       PIC XXX.                ERCCRTC
  5068     12  CC-RECORD-STATUS.                                        ERCCRTC
  5069         16  CC-CREDIT-SELECT-DT          PIC XX.                 ERCCRTC
  5070         16  CC-CREDIT-ACCEPT-DT          PIC XX.                 ERCCRTC
  5071     12  CC-ADDITIONAL-LF-DATA.                                   ERCCRTC
  5072         16  CC-LF-BENEFIT-CD             PIC XX.                 ERCCRTC
  5073         16  CC-LF-PREMIUM-AMT            PIC S9(7)V99  COMP-3.   ERCCRTC
  5074         16  CC-LF-BENEFIT-AMT            PIC S9(9)V99  COMP-3.   ERCCRTC
  5075         16  CC-LF-EXPIRY-DT              PIC XX.                 ERCCRTC
  5076     12  CC-INPUT-DT                      PIC XX.                 ERCCRTC
  5077     12  CC-ERROR-FLAGS.                                          ERCCRTC
  5078         16  CC-STANDARD-ERRORS.                                  ERCCRTC
  5079             20  FILLER                   PIC X    OCCURS 10.     ERCCRTC
  5080         16  CC-TRANSACTION-ERRORS.                               ERCCRTC
  5081             20  FILLER                   PIC X    OCCURS 10.     ERCCRTC
  5082     12  CC-ADDITIONAL-AH-DATA.                                   ERCCRTC
  5083         16  CC-AH-BENEFIT-CD             PIC XX.                 ERCCRTC
  5084         16  CC-AH-PREMIUM-AMT            PIC S9(7)V99  COMP-3.   ERCCRTC
  5085         16  CC-AH-BENEFIT-AMT            PIC S9(7)V99  COMP-3.   ERCCRTC
  5086         16  CC-AH-EXPIRY-DT              PIC XX.                 ERCCRTC
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 101
* ECS010P.cbl (/apps/prod/cid1p/copy/ERCCRTC)
  5087                                                                  ERCCRTC
  5088     12  FILLER                           PIC X(05).              ERCCRTC
  5089******************************************************************ERCCRTC
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 102
* ECS010P.cbl
  5091 01  CR-STARTS-HERE              PIC X(48)
  5092       VALUE '***** CERTIFICATE MASTER RECORD STARTS HERE ****'.
  5093
* 5094                             COPY ECSCRT01.
  5095******************************************************************
  5096*                                                                *
  5097*                            ECSCRT01                            *
  5098*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5099*                            VMOD=2.016                          *
  5100*                                                                *
  5101*   FILE DESCRIPTION = CERTIFICATE RECORD    (OFF-LINE)          *
  5102*                                                                *
  5103*   FILE TYPE = SEQUENTIAL
  5104*   RECORD SIZE = 1056 RECFORM = FIXED                           *
  5105*                                                                *
  5106*   KEY DATA =                         START=4, LEN=36           *
  5107*                                                                *
  5108*  NO  CID  MODS  IN  COPYBOOK  ECSCRT01                         *
  5109*                                                                *
  5110******************************************************************
  5111******************************************************************
  5112*                   C H A N G E   L O G
  5113*
  5114* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5115*-----------------------------------------------------------------
  5116*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5117* EFFECTIVE    NUMBER
  5118*-----------------------------------------------------------------
  5119* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  5120* 100703    2003080800002  PEMA  ADD SUPER GAP PROCESSING
  5121* 040504    2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  5122* 020305    2005020000000  PEMA  ADD CLP STATE TO CERT RECORD
  5123* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  5124* 042408    2007110500003  PEMA  ADD REFUND INTEREST PROCESSING
  5125* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  5126* 032612  CR2011110200001  PEMA  AHL CHANGES
  5127* 052814  CR2014012300001  PEMA  DCC CREDIT UNION CHANGES
  5128* 090314  CR2014081300001  PEMA  LOAD CERTS INVOLVED IN THAO
  5129******************************************************************
  5130
  5131 01  CERTIFICATE-RECORD.
  5132     12  CR-RECORD-ID                      PIC XX.
  5133         88  VALID-CR-ID                      VALUE 'CR'.
  5134
  5135     12  CR-COMPANY-CD                     PIC X.
  5136
  5137     12  CR-FULL-CONTROL.
  5138         16  CR-CONTROL-1.
  5139             20  CR-ACCT-CONTROL.
  5140                 24  CR-CARRIER            PIC X.
  5141                 24  CR-GROUPING.
  5142                     28  CR-GROUP-PREFIX   PIC XXX.
  5143                     28  CR-GROUP-PRIME    PIC XXX.
  5144                 24  CR-STATE              PIC XX.
  5145                 24  CR-ACCOUNT.
  5146                     28  CR-ACCT-PREFIX    PIC X(4).
  5147                     28  CR-ACCT-PRIME     PIC X(6).
  5148             20  CR-DT                     PIC 9(11)  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 103
* ECS010P.cbl (/apps/prod/cid1p/copy/ECSCRT01)
  5149         16  CR-CERT-NO.
  5150             20  CR-CERT.
  5151                 24  CR-CERT-PREFIX        PIC X(3).
  5152                 24  CR-CERT-PRIME         PIC X(7).
  5153             20  CR-CERT-SFX               PIC X.
  5154
  5155     12  CR-INSUREDS-PROFILE.
  5156         16  CR-NAME.
  5157             20  CR-LNAME                  PIC X(15).
  5158             20  CR-FNAME.
  5159                 24  CR-1ST-INITIAL        PIC X.
  5160                 24  FILLER                PIC X(9).
  5161             20  CR-INIT                   PIC X.
  5162         16  CR-AGE                        PIC 99.
  5163         16  CR-SEX                        PIC X.
  5164             88  CR-SEX-MALE                  VALUE 'M'.
  5165             88  CR-SEX-FEMALE                VALUE 'F'.
  5166         16  CR-SOC-SEC                    PIC X(11).
  5167         16  CR-JOINT-NAME.
  5168             20  CR-JT-LNAME               PIC X(15).
  5169             20  CR-JT-FNAME.
  5170                 24  CR-JT-1ST-INIT        PIC X.
  5171                 24  FILLER                PIC X(9).
  5172             20  CR-JT-INIT                PIC X.
  5173         16  CR-JOINT-AGE                  PIC 99.
  5174
  5175         16  cr-ahl-ah-claim-no            pic x(9).
  5176         16  cr-ahl-ah-cert-seq            pic x(3).
  5177         16  cr-hst-proc-lf                pic x.
  5178         16  f                             pic x(7).
  5179
  5180     12  CR-LF-COVERAGE-DATA.
  5181         16  CR-LFTYP                      PIC XX.
  5182         16  CR-LF-TERM                    PIC S999       COMP-3.
  5183         16  CR-LF-CRIT-PERIOD             PIC S999       COMP-3.
  5184         16  CR-LF-TERM-IN-DAYS            PIC S9(5)      COMP-3.
  5185         16  CR-LF-DEV-CODE                PIC XXX.
  5186         16  CR-LF-DEV-PCT                 PIC S9V9(6)    COMP-3.
  5187
  5188         16  CR-LFAMT                      PIC S9(9)V99   COMP-3.
  5189         16  CR-LFPRM                      PIC S9(7)V99   COMP-3.
  5190         16  CR-LFPRM-CALC                 PIC S9(7)V99   COMP-3.
  5191         16  CR-LFPRM-RATE                 PIC S99V9(5)   COMP-3.
  5192
  5193         16  CR-LFAMT-ALT                  PIC S9(9)V99   COMP-3.
  5194         16  CR-LFPRM-ALT                  PIC S9(7)V99   COMP-3.
  5195         16  CR-LFPRM-CALC-ALT             PIC S9(7)V99   COMP-3.
  5196         16  CR-LFPRM-RATE-ALT             PIC S99V9(5)   COMP-3.
  5197
  5198         16  CR-LFRFND                     PIC S9(7)V99   COMP-3.
  5199         16  CR-LFRFND-CALC                PIC S9(7)V99   COMP-3.
  5200
  5201         16  CR-LF-NSP-PRM                 PIC S9(7)V99   COMP-3.
  5202         16  CR-LF-NSP-PRM-RATE            PIC S99V9(5)   COMP-3.
  5203
  5204         16  CR-LF-REFUND-TYPE             PIC X.
  5205         16  CR-LF-POLICY-FEE              PIC S9(3)V99   COMP-3.
  5206
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 104
* ECS010P.cbl (/apps/prod/cid1p/copy/ECSCRT01)
  5207         16  CR-LF-COMM-CHARGEBACK         PIC X.
  5208             88  CR-NO-LF-CHARGEBACK          VALUE 'N'.
  5209
  5210         16  CR-LF-REI-RISK-PRM            PIC S9(7)V99   COMP-3.
  5211
  5212         16  CR-LF-EXPIRE-DATE             PIC 9(11)      COMP-3.
  5213         16  CR-LF-ISS-PREM-TAX            PIC S9V9(4)    COMP-3.
  5214         16  CR-LF-CNC-PREM-TAX            PIC S9V9(4)    COMP-3.
  5215
  5216         16  cr-ahl-lf-claim-no            pic x(9).
  5217         16  cr-ahl-lf-cert-seq            pic x(3).
  5218         16  FILLER                        PIC XX.
  5219
  5220     12  CR-AH-COVERAGE-DATA.
  5221         16  CR-AHTYP                      PIC XX.
  5222         16  CR-AH-TERM                    PIC S999       COMP-3.
  5223         16  CR-AH-CRIT-PERIOD             PIC S999       COMP-3.
  5224         16  CR-AH-DEV-CODE                PIC XXX.
  5225         16  CR-AH-DEV-PCT                 PIC S9V9(6)    COMP-3.
  5226
  5227         16  CR-AHAMT                      PIC S9(7)V99   COMP-3.
  5228         16  CR-AHPRM                      PIC S9(7)V99   COMP-3.
  5229         16  CR-AHPRM-CALC                 PIC S9(7)V99   COMP-3.
  5230         16  CR-AHPRM-RATE                 PIC S99V9(5)   COMP-3.
  5231
  5232         16  CR-AHRFND                     PIC S9(7)V99   COMP-3.
  5233         16  CR-AHRFND-CALC                PIC S9(7)V99   COMP-3.
  5234
  5235         16  CR-AH-NSP-PRM                 PIC S9(7)V99   COMP-3.
  5236         16  CR-AH-NSP-PRM-RATE            PIC S99V9(5)   COMP-3.
  5237
  5238         16  CR-AH-REFUND-TYPE             PIC X.
  5239         16  CR-AH-POLICY-FEE              PIC S9(3)V99   COMP-3.
  5240
  5241         16  CR-AH-COMM-CHARGEBACK         PIC X.
  5242             88  CR-NO-AH-CHARGEBACK          VALUE 'N'.
  5243
  5244         16  CR-AH-REI-RISK-PRM            PIC S9(7)V99   COMP-3.
  5245
  5246         16  CR-AH-EXPIRE-DATE             PIC 9(11)      COMP-3.
  5247         16  CR-AH-ISS-PREM-TAX            PIC S9V9(4)    COMP-3.
  5248         16  CR-AH-CNC-PREM-TAX            PIC S9V9(4)    COMP-3.
  5249
  5250         16  FILLER                        PIC XX.
  5251*        16  FILLER                        PIC X(8).
  5252
  5253     12  CR-LOAN-DATA.
  5254         16  CR-LIVES                      PIC S9(7)      COMP-3.
  5255         16  CR-DDF-IU-RATE-UP REDEFINES CR-LIVES
  5256                                           PIC S9(5)V99   COMP-3.
  5257         16  CR-BILLED                     PIC S9(7)      COMP-3.
  5258         16  CR-APR                        PIC S999V9(4)  COMP-3.
  5259         16  CR-PMT-FREQ                   PIC 99.
  5260         16  CR-LOAN-TERM                  PIC S999       COMP-3.
  5261         16  CR-RATING-CLASS               PIC XX.
  5262         16  CR-POLICY-FORM-NO             PIC X(12).
  5263         16  CR-GRPTYP                     PIC XX.
  5264         16  CR-IND-GRP                    PIC X.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 105
* ECS010P.cbl (/apps/prod/cid1p/copy/ECSCRT01)
  5265             88  CR-INDIVIDUAL                VALUE '1'.
  5266             88  CR-GROUP                     VALUE '2'.
  5267         16  CR-SKIP                       PIC 99.
  5268             88  NO-MONTHS-SKIPPED            VALUE 00.
  5269             88  SKIP-JULY                    VALUE 01.
  5270             88  SKIP-AUGUST                  VALUE 02.
  5271             88  SKIP-SEPTEMBER               VALUE 03.
  5272             88  SKIP-JULY-AUG                VALUE 04.
  5273             88  SKIP-AUG-SEPT                VALUE 05.
  5274             88  SKIP-JULY-AUG-SEPT           VALUE 06.
  5275             88  SKIP-JUNE-JULY-AUG           VALUE 07.
  5276             88  SKIP-JUNE                    VALUE 08.
  5277             88  SKIP-JUNE-JULY               VALUE 09.
  5278             88  SKIP-AUG-SEPT-OCT            VALUE 10.
  5279             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 11.
  5280         16  CR-RESIDENT-STATE             PIC XX.
  5281         16  CR-RATE-CODE.
  5282             20  CR-LF-CLASS-CD            PIC XX.
  5283             20  CR-AH-CLASS-CD            PIC XX.
  5284         16  CR-MORT.
  5285             20  CR-TAB                    PIC X.
  5286             20  CR-INT                    PIC 99.
  5287             20  CR-GRP                    PIC X.
  5288         16  CR-MEMBER-NO                  PIC X(12).
  5289         16  CR-OLD-LOF                    PIC XXX.
  5290*        16  CR-LOAN-OFFICER               PIC XXX.
  5291         16  CR-REIN-TABLE                 PIC XXX.
  5292         16  CR-REIN-SPEC                  PIC X.
  5293         16  CR-LOAN-1ST-PMT-DT.
  5294             20  CR-1ST-PMT-YR             PIC 99.
  5295             20  CR-1ST-PMT-MO             PIC 99.
  5296             20  CR-1ST-PMT-DA             PIC 99.
  5297         16  CR-SUM-CAN-CNT-ITD            PIC S999       COMP-3.
  5298         16  CR-SUM-CAN-CNT-YTD            PIC S999       COMP-3.
  5299         16  CR-PMT-EXTENSION-DAYS         PIC S999       COMP-3.
  5300         16  CR-LAST-ADD-ON-DT             PIC XX.
  5301
  5302         16  CR-UNDERWRITING-CODE          PIC X.
  5303             88  CR-POLICY-UNDERWRITTEN       VALUE 'Y'.
  5304
  5305         16  CR-STATE-TAX                  PIC S9(7)V99   COMP-3.
  5306         16  CR-MUNI-TAX                   PIC S9(7)V99   COMP-3.
  5307         16  CR-CANCEL-STATE-TAX           PIC S9(7)V99   COMP-3.
  5308         16  CR-CANCEL-MUNI-TAX            PIC S9(7)V99   COMP-3.
  5309
  5310     12  CR-STATUS-INFORMATION.
  5311         16  CR-ENTRY-STATUS               PIC X.
  5312             88  CR-NORMAL-ENTRY              VALUE '1'.
  5313             88  CR-POLICY-IS-RESTORE         VALUE '3'.
  5314             88  CR-CONVERSION-ENTRY          VALUE '4'.
  5315             88  CR-POLICY-IS-REISSUE         VALUE '5'.
  5316             88  CR-POLICY-IS-CASH            VALUE 'C'.
  5317             88  CR-POLICY-IS-MONTHLY         VALUE 'M'.
  5318             88  CR-POLICY-IS-REIN-ONLY       VALUE '9'.
  5319             88  CR-POLICY-IS-DECLINED        VALUE 'D'.
  5320             88  CR-POLICY-IS-VOID            VALUE 'V'.
  5321             88  CR-POLICY-IS-PREM-ONLY       VALUE 'P'.
  5322             88  CR-POLICY-IS-ACTIVE          VALUE '1' '3' '4'
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 106
* ECS010P.cbl (/apps/prod/cid1p/copy/ECSCRT01)
  5323                                                'C' '5' '9' 'P'.
  5324         16  CR-ENTRY-DATE                 PIC 9(11)  COMP-3.
  5325
  5326         16  CR-LF-STATUS-AT-CANCEL        PIC X.
  5327         16  CR-LF-CANC-DT                 PIC 9(11)  COMP-3.
  5328         16  CR-LF-CANCEL-EXIT-DATE        PIC 9(11)  COMP-3.
  5329
  5330         16  CR-LF-STATUS-AT-DEATH         PIC X.
  5331         16  CR-LF-CLAIM-EXIT-DATE         PIC 9(11)  COMP-3.
  5332
  5333         16  CR-LF-CURRENT-STATUS          PIC X.
  5334             88  CR-LF-NORMAL-ENTRY           VALUE '1'.
  5335             88  CR-LF-POLICY-PENDING         VALUE '2'.
  5336             88  CR-LF-POLICY-IS-RESTORE      VALUE '3'.
  5337             88  CR-LF-CONVERSION-ENTRY       VALUE '4'.
  5338             88  CR-LF-POLICY-IS-REISSUE      VALUE '5'.
  5339             88  CR-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  5340             88  CR-LF-LUMP-SUM-DISAB         VALUE '6'.
  5341             88  CR-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  5342             88  CR-LF-CANCEL-APPLIED         VALUE '8'.
  5343             88  CR-LF-IS-REIN-ONLY           VALUE '9'.
  5344             88  CR-LF-IS-DECLINED            VALUE 'D'.
  5345             88  CR-LF-IS-VOID                VALUE 'V'.
  5346             88  CR-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  5347                                                    '4' '5' '9'.
  5348
  5349         16  CR-AH-STATUS-AT-CANCEL        PIC X.
  5350
  5351         16  CR-AH-CANC-DT                 PIC 9(11)  COMP-3.
  5352         16  CR-AH-CANCEL-EXIT-DATE        PIC 9(11)  COMP-3.
  5353
  5354         16  CR-AH-STATUS-AT-SETTLEMENT    PIC X.
  5355         16  CR-AH-SETTLEMENT-EXIT-DATE    PIC 9(11)  COMP-3.
  5356
  5357         16  CR-AH-CURRENT-STATUS          PIC X.
  5358             88  CR-AH-NORMAL-ENTRY           VALUE '1'.
  5359             88  CR-AH-POLICY-PENDING         VALUE '2'.
  5360             88  CR-AH-POLICY-IS-RESTORE      VALUE '3'.
  5361             88  CR-AH-CONVERSION-ENTRY       VALUE '4'.
  5362             88  CR-AH-POLICY-IS-REISSUE      VALUE '5'.
  5363             88  CR-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  5364             88  CR-AH-LUMP-SUM-DISAB         VALUE '6'.
  5365             88  CR-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  5366             88  CR-AH-CANCEL-APPLIED         VALUE '8'.
  5367             88  CR-AH-IS-REIN-ONLY           VALUE '9'.
  5368             88  CR-AH-IS-DECLINED            VALUE 'D'.
  5369             88  CR-AH-IS-VOID                VALUE 'V'.
  5370             88  CR-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  5371                                                    '4' '5' '9'.
  5372         16  CR-LOAN-OFFICER               PIC X(5).
  5373         16  CR-CANCEL-REASON              PIC X.
  5374         16  cr-xycor-lf-cov-code          pic x(4).
  5375         16  cr-xycor-ah-cov-code          pic x(4).
  5376         16  cr-temp-epiq                  pic x(4).
  5377         16  FILLER                        PIC XX.
  5378
  5379     12  CR-DEATH-CLAIM-DATA.
  5380         16  CR-NUM-DTH-CLM                PIC S999       COMP-3.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 107
* ECS010P.cbl (/apps/prod/cid1p/copy/ECSCRT01)
  5381
  5382         16  CR-DTH-DT                     PIC 9(11)      COMP-3.
  5383         16  CR-DTH-RPT-DT.
  5384             20  CR-DTH-RPT-YR             PIC 99.
  5385             20  CR-DTH-RPT-MO             PIC 99.
  5386             20  CR-DTH-RPT-DA             PIC 99.
  5387         16  CR-DTH-PAY-DT                 PIC 9(11)      COMP-3.
  5388
  5389         16  CR-DTHAMT                     PIC S9(9)V99   COMP-3.
  5390         16  CR-DTHAMT-YTD                 PIC S9(9)V99   COMP-3.
  5391         16  CR-DTHAMT-LAST                PIC S9(9)V99   COMP-3.
  5392         16  CR-DTHEXP                     PIC S9(7)V99   COMP-3.
  5393         16  CR-DTHEXP-YTD                 PIC S9(7)V99   COMP-3.
  5394
  5395         16  CR-DTH-AGE                    PIC 99.
  5396         16  CR-DTH-PAY-CD                 PIC X.
  5397         16  CR-DEATH-CAUSE                PIC X(6).
  5398
  5399         16  FILLER                        PIC X(16).
  5400
  5401     12  CR-DISAB-CLAIM-DATA.
  5402         16  CR-NUM-DIS-CLM                PIC S999       COMP-3.
  5403
  5404         16  CR-DIS-DT                     PIC 9(11)      COMP-3.
  5405         16  CR-DIS-RPT-DT.
  5406             20  CR-DIS-RPT-YR             PIC 99.
  5407             20  CR-DIS-RPT-MO             PIC 99.
  5408             20  CR-DIS-RPT-DA             PIC 99.
  5409         16  CR-DIS-PAY-DT                 PIC 9(11)      COMP-3.
  5410         16  CR-DIS-PTO-DT                 PIC 9(11)      COMP-3.
  5411
  5412         16  CR-DISAMT                     PIC S9(9)V99   COMP-3.
  5413         16  CR-DISAMT-YTD                 PIC S9(9)V99   COMP-3.
  5414         16  CR-DISAMT-LAST                PIC S9(9)V99   COMP-3.
  5415         16  CR-DISEXP                     PIC S9(7)V99   COMP-3.
  5416         16  CR-DISEXP-YTD                 PIC S9(7)V99   COMP-3.
  5417
  5418         16  CR-DAYS-DISAB                 PIC 999        COMP-3.
  5419         16  CR-DIS-PAY-CD                 PIC X.
  5420         16  FILLER                        PIC XX.
  5421
  5422         16  CR-DISAB-INCURRED-DETAIL.
  5423             20  CR-DISAB-DETAIL-DATA  OCCURS 5 TIMES.
  5424**ELCCRTVR MUST BE CHANGED IF THE "OCCURS" IS CHANGED.
  5425                 24  CR-DIS-INCUR-DT       PIC 9(11)     COMP-3.
  5426                 24  CR-INCUR-DISAMT       PIC S9(9)V99  COMP-3.
  5427                 24  CR-INCUR-DISEXP       PIC S9(9)V99  COMP-3.
  5428
  5429         16  CR-DISAB-CAUSE                PIC X(6).
  5430         16  FILLER                        PIC X(14).
  5431
  5432     12  CR-REMIT-TO                       PIC 99.
  5433
  5434     12  CR-COMPENSATION-LEVELS.
  5435         16  CR-AGT-LEVELS      OCCURS 10 TIMES.
  5436             20  CR-COM-AGT.
  5437                 24  CR-COM-AGT-PREFIX     PIC X(4).
  5438                 24  CR-COM-AGT-PRIME      PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 108
* ECS010P.cbl (/apps/prod/cid1p/copy/ECSCRT01)
  5439             20  CR-AGT-TYPE               PIC X.
  5440             20  CR-LCOM-L                 PIC SV9(5)     COMP-3.
  5441             20  CR-LCOM-AH                PIC SV9(5)     COMP-3.
  5442
  5443     12  CR-BANK-NOCHRGB-MONTHS            PIC 99.
  5444     12  CR-MOB-NET-TOT-FEES               PIC S9(7)V99   COMP-3.
  5445     12  CR-ADDL-CLP                       PIC S9(5)V99   COMP-3.
  5446     12  CR-CLP-STATE                      PIC XX.
  5447     12  CR-POST-CARD-IND                  PIC X.
  5448     12  CR-LF-CLP                         PIC S9(5)V99   COMP-3.
  5449     12  CR-AH-CLP                         PIC S9(5)V99   COMP-3.
  5450     12  CR-DCC-PRODUCT-CODE               PIC XXX.
  5451     12  CR-LF-RFND-CLP                    PIC S9(5)V99   COMP-3.
  5452     12  CR-AH-RFND-CLP                    PIC S9(5)V99   COMP-3.
  5453     12  FILLER                            PIC X(07).
  5454
  5455     12  CR-CSR-CODE                       PIC XXX.
  5456
  5457     12  CR-CLAIM-DEDUCT-WITHHELD          PIC S9(5)V99   COMP-3.
  5458     12  CR-CANCEL-DEDUCT-WITHHELD         PIC S9(5)V99   COMP-3.
  5459
  5460     12  CR-MICROFILM-NUMBERS.
  5461*        16  CR-ISS-MICROFILM-NO           PIC S9(9)      COMP-3.
  5462         16  FILLER                        PIC X(5).
  5463     12  CR-NH-INT-ON-REF                  PIC S9(7)V99   COMP-3.
  5464
  5465     12  CR-USER-CODE                      PIC X.
  5466     12  CR-USER-FUTURE                    PIC X(9).
  5467
  5468     12  CR-BENEFICIARY.
  5469         16  CR-BANK-NO                    PIC X(10).
  5470         16  FILLER                        PIC X(15).
  5471
  5472     12  CR-ENTRY-BATCH                    PIC X(6).
  5473     12  CR-LF-EXIT-BATCH                  PIC X(6).
  5474     12  CR-AH-EXIT-BATCH                  PIC X(6).
  5475
  5476     12  CR-NOTE-SW                        PIC X.
  5477
  5478     12  CR-ORIGIN-INDICATOR               PIC X.
  5479         88  CR-ENTERED-MANUALLY              VALUE '1'.
  5480         88  CR-CREATED-FROM-TAPE-LOAD        VALUE '2'.
  5481
  5482     12  CR-LF-CNC-ENT-DT                  PIC 9(11)  COMP-3.
  5483     12  CR-AH-CNC-ENT-DT                  PIC 9(11)  COMP-3.
  5484     12  FILLER                            PIC X(33).
  5485
  5486******************************************************************
* 5487                             COPY ELCCRTVR.
  5488***************************************************************** 04/24/98
  5489*                                                                *ELCCRTVR
  5490*                                                                *ELCCRTVR
  5491*                            ELCCRTVR                            *   LV003
  5492*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  5493*                            VMOD=2.001                          *ELCCRTVR
  5494*                                                                *ELCCRTVR
  5495*   WORKING STORAGE FOR DATE VARIABLES CREATED                   *ELCCRTVR
  5496*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCCRTVR
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 109
* ECS010P.cbl (/apps/prod/cid1p/copy/ELCCRTVR)
  5497*                                                                *ELCCRTVR
  5498******************************************************************ELCCRTVR
  5499                                                                  ELCCRTVR
  5500 01  WS-CERTIFICATE-RECORD-DATE.                                  ELCCRTVR
  5501     05  WS-CR-DT.                                                ELCCRTVR
  5502         10  FILLER                PIC 999.                       ELCCRTVR
  5503         10  CR-CCYY               PIC 9(04).                     ELCCRTVR
  5504         10  CR-CCYR  REDEFINES  CR-CCYY.                         ELCCRTVR
  5505             15  CR-CC             PIC 99.                        ELCCRTVR
  5506             15  CR-YR             PIC 99.                        ELCCRTVR
  5507         10  CR-MO                 PIC 99.                        ELCCRTVR
  5508         10  CR-DA                 PIC 99.                        ELCCRTVR
  5509     05  WS-CR-DT-N REDEFINES                                        CL**2
  5510            WS-CR-DT               PIC 9(11).                        CL**2
  5511     05  WS-CR-LF-EXPIRE-DATE.                                    ELCCRTVR
  5512         10  FILLER                    PIC 999.                   ELCCRTVR
  5513         10  CR-LF-EXPIRE-CCYY         PIC 9(04).                 ELCCRTVR
  5514         10  CR-LF-EXPIRE-CCYR  REDEFINES  CR-LF-EXPIRE-CCYY.     ELCCRTVR
  5515             15  CR-LF-EXPIRE-CC       PIC 99.                    ELCCRTVR
  5516             15  CR-LF-EXPIRE-YR       PIC 99.                    ELCCRTVR
  5517         10  CR-LF-EXPIRE-MO           PIC 99.                    ELCCRTVR
  5518         10  CR-LF-EXPIRE-DA           PIC 99.                    ELCCRTVR
  5519     05  WS-CR-LF-EXPIRE-DATE-N REDEFINES                            CL**2
  5520            WS-CR-LF-EXPIRE-DATE       PIC 9(11).                    CL**2
  5521     05  WS-CR-AH-EXPIRE-DATE.                                    ELCCRTVR
  5522         10  FILLER                    PIC 999.                   ELCCRTVR
  5523         10  CR-AH-EXPIRE-CCYY         PIC 9(04).                 ELCCRTVR
  5524         10  CR-AH-EXPIRE-CCYR   REDEFINES CR-AH-EXPIRE-CCYY.     ELCCRTVR
  5525             15  CR-AH-EXPIRE-CC       PIC 99.                    ELCCRTVR
  5526             15  CR-AH-EXPIRE-YR       PIC 99.                    ELCCRTVR
  5527         10  CR-AH-EXPIRE-MO           PIC 99.                    ELCCRTVR
  5528         10  CR-AH-EXPIRE-DA           PIC 99.                    ELCCRTVR
  5529     05  WS-CR-AH-EXPIRE-DATE-N REDEFINES                            CL**2
  5530            WS-CR-AH-EXPIRE-DATE       PIC 9(11).                    CL**2
  5531     05  WS-CR-ENTRY-DATE.                                        ELCCRTVR
  5532         10  FILLER                    PIC 999.                   ELCCRTVR
  5533         10  CR-ENTRY-CCYY             PIC 9(04).                 ELCCRTVR
  5534         10  CR-ENTRY-CCYR  REDEFINES  CR-ENTRY-CCYY.             ELCCRTVR
  5535             15 CR-ENTRY-CC            PIC 99.                    ELCCRTVR
  5536             15 CR-ENTRY-YR            PIC 99.                    ELCCRTVR
  5537         10  CR-ENTRY-MO               PIC 99.                    ELCCRTVR
  5538         10  CR-ENTRY-DA               PIC 99.                    ELCCRTVR
  5539     05  WS-CR-ENTRY-DATE-N REDEFINES                                CL**2
  5540            WS-CR-ENTRY-DATE           PIC 9(11).                    CL**2
  5541     05  WS-CR-LF-CANC-DT.                                        ELCCRTVR
  5542         10  FILLER                    PIC 999.                   ELCCRTVR
  5543         10  CR-LF-CNC-CCYY            PIC 9(04).                 ELCCRTVR
  5544         10  CR-LF-CNC-CCYR   REDEFINES CR-LF-CNC-CCYY.           ELCCRTVR
  5545             15  CR-LF-CNC-CC          PIC 99.                    ELCCRTVR
  5546             15  CR-LF-CNC-YR          PIC 99.                    ELCCRTVR
  5547         10  CR-LF-CNC-MO              PIC 99.                    ELCCRTVR
  5548         10  CR-LF-CNC-DA              PIC 99.                    ELCCRTVR
  5549     05  WS-CR-LF-CANC-DT-N REDEFINES                                CL**2
  5550            WS-CR-LF-CANC-DT           PIC 9(11).                    CL**2
  5551     05  WS-CR-LF-CANCEL-EXIT-DATE.                               ELCCRTVR
  5552         10  FILLER                    PIC 999.                   ELCCRTVR
  5553         10  CR-LF-CEX-CCYY            PIC 9(04).                 ELCCRTVR
  5554         10  CR-LF-CEX-CCYR  REDEFINES  CR-LF-CEX-CCYY.              CL**3
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 110
* ECS010P.cbl (/apps/prod/cid1p/copy/ELCCRTVR)
  5555             15  CR-LF-CEX-CC          PIC 99.                    ELCCRTVR
  5556             15  CR-LF-CEX-YR          PIC 99.                    ELCCRTVR
  5557         10  CR-LF-CEX-MO              PIC 99.                    ELCCRTVR
  5558         10  CR-LF-CEX-DA              PIC 99.                    ELCCRTVR
  5559     05  WS-CR-LF-CANCEL-EXIT-DATE-N REDEFINES                       CL**2
  5560            WS-CR-LF-CANCEL-EXIT-DATE  PIC 9(11).                    CL**2
  5561     05  WS-CR-LF-CLAIM-EXIT-DATE.                                ELCCRTVR
  5562         10  FILLER                    PIC 999.                   ELCCRTVR
  5563         10  CR-LF-DEX-CCYY            PIC 9(04).                 ELCCRTVR
  5564         10  CR-LF-DEX-CCYR  REDEFINES  CR-LF-DEX-CCYY.           ELCCRTVR
  5565             15  CR-LF-DEX-CC          PIC 99.                    ELCCRTVR
  5566             15  CR-LF-DEX-YR          PIC 99.                    ELCCRTVR
  5567         10  CR-LF-DEX-MO              PIC 99.                    ELCCRTVR
  5568         10  CR-LF-DEX-DA              PIC 99.                    ELCCRTVR
  5569     05  WS-CR-LF-CLAIM-EXIT-DATE-N REDEFINES                        CL**2
  5570            WS-CR-LF-CLAIM-EXIT-DATE   PIC 9(11).                    CL**2
  5571     05  WS-CR-AH-CANC-DT.                                        ELCCRTVR
  5572         10  FILLER                    PIC 999.                   ELCCRTVR
  5573         10  CR-AH-CNC-CCYY            PIC 9(04).                 ELCCRTVR
  5574         10  CR-AH-CNC-CCYR  REDEFINES  CR-AH-CNC-CCYY.           ELCCRTVR
  5575             15  CR-AH-CNC-CC          PIC 99.                    ELCCRTVR
  5576             15  CR-AH-CNC-YR          PIC 99.                    ELCCRTVR
  5577         10  CR-AH-CNC-MO              PIC 99.                    ELCCRTVR
  5578         10  CR-AH-CNC-DA              PIC 99.                    ELCCRTVR
  5579     05  WS-CR-AH-CANC-DT-N  REDEFINES                               CL**2
  5580            WS-CR-AH-CANC-DT           PIC 9(11).                    CL**2
  5581     05  WS-CR-AH-CANCEL-EXIT-DATE.                               ELCCRTVR
  5582         10  FILLER                    PIC 999.                   ELCCRTVR
  5583         10  CR-AH-CEX-CCYY            PIC 9(04).                 ELCCRTVR
  5584         10  CR-AH-CEX-CCYR  REDEFINES  CR-AH-CEX-CCYY.           ELCCRTVR
  5585             15  CR-AH-CEX-CC          PIC 99.                    ELCCRTVR
  5586             15  CR-AH-CEX-YR          PIC 99.                    ELCCRTVR
  5587         10  CR-AH-CEX-MO              PIC 99.                    ELCCRTVR
  5588         10  CR-AH-CEX-DA              PIC 99.                    ELCCRTVR
  5589     05  WS-CR-AH-CANCEL-EXIT-DATE-N REDEFINES                       CL**2
  5590            WS-CR-AH-CANCEL-EXIT-DATE  PIC 9(11).                    CL**2
  5591     05  WS-CR-AH-SETTLEMENT-EXIT-DATE.                           ELCCRTVR
  5592         10  FILLER                    PIC 999.                   ELCCRTVR
  5593         10  CR-AH-DEX-CCYY            PIC 9(04).                 ELCCRTVR
  5594         10  CR-AH-DEX-CCYR  REDEFINES  CR-AH-DEX-CCYY.           ELCCRTVR
  5595             15  CR-AH-DEX-CC          PIC 99.                    ELCCRTVR
  5596             15  CR-AH-DEX-YR          PIC 99.                    ELCCRTVR
  5597         10  CR-AH-DEX-MO              PIC 99.                    ELCCRTVR
  5598         10  CR-AH-DEX-DA              PIC 99.                    ELCCRTVR
  5599     05  WS-CR-AH-SETTLEMENT-EXIT-DATEN REDEFINES                    CL**5
  5600          WS-CR-AH-SETTLEMENT-EXIT-DATE   PIC 9(11).                 CL**5
  5601     05  WS-CR-DTH-DT.                                            ELCCRTVR
  5602         10  FILLER                    PIC 999.                   ELCCRTVR
  5603         10  CR-DTH-CCYY               PIC 9(04).                 ELCCRTVR
  5604         10  CR-DTH-CCYR  REDEFINES  CR-DTH-CCYY.                 ELCCRTVR
  5605             15  CR-DTH-CC             PIC 99.                    ELCCRTVR
  5606             15  CR-DTH-YR             PIC 99.                    ELCCRTVR
  5607         10  CR-DTH-MO                 PIC 99.                    ELCCRTVR
  5608         10  CR-DTH-DA                 PIC 99.                    ELCCRTVR
  5609     05  WS-CR-DTH-DT-N REDEFINES                                    CL**2
  5610            WS-CR-DTH-DT               PIC 9(11).                    CL**2
  5611     05  WS-CR-DTH-PAY-DT.                                        ELCCRTVR
  5612         10  FILLER                    PIC 999.                   ELCCRTVR
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 111
* ECS010P.cbl (/apps/prod/cid1p/copy/ELCCRTVR)
  5613         10  CR-DTH-PAY-CCYY           PIC 9(04).                 ELCCRTVR
  5614         10  CR-DTH-PAY-CCYR  REDEFINES CR-DTH-PAY-CCYY.          ELCCRTVR
  5615             15  CR-DTH-PAY-CC         PIC 99.                    ELCCRTVR
  5616             15  CR-DTH-PAY-YR         PIC 99.                    ELCCRTVR
  5617         10  CR-DTH-PAY-MO             PIC 99.                    ELCCRTVR
  5618         10  CR-DTH-PAY-DA             PIC 99.                    ELCCRTVR
  5619     05  WS-CR-DTH-PAY-DT-N REDEFINES                                CL**2
  5620            WS-CR-DTH-PAY-DT           PIC 9(11).                    CL**2
  5621     05  WS-CR-DIS-DT.                                            ELCCRTVR
  5622         10  FILLER                    PIC 999.                   ELCCRTVR
  5623         10  CR-DIS-CCYY               PIC 9(04).                 ELCCRTVR
  5624         10  CR-DIS-CCYR  REDEFINES  CR-DIS-CCYY.                 ELCCRTVR
  5625             15  CR-DIS-CC             PIC 99.                    ELCCRTVR
  5626             15  CR-DIS-YR             PIC 99.                    ELCCRTVR
  5627         10  CR-DIS-MO                 PIC 99.                    ELCCRTVR
  5628         10  CR-DIS-DA                 PIC 99.                    ELCCRTVR
  5629     05  WS-CR-DIS-DT-N REDEFINES                                    CL**2
  5630            WS-CR-DIS-DT               PIC 9(11).                    CL**2
  5631     05  WS-CR-DIS-PAY-DT.                                        ELCCRTVR
  5632         10  FILLER                    PIC 999.                   ELCCRTVR
  5633         10  CR-DIS-PAY-CCYY           PIC 9(04).                 ELCCRTVR
  5634         10  CR-DIS-PAY-CCYR  REDEFINES  CR-DIS-PAY-CCYY.         ELCCRTVR
  5635             15  CR-DIS-PAY-CC         PIC 99.                    ELCCRTVR
  5636             15  CR-DIS-PAY-YR         PIC 99.                    ELCCRTVR
  5637         10  CR-DIS-PAY-MO             PIC 99.                    ELCCRTVR
  5638         10  CR-DIS-PAY-DA             PIC 99.                    ELCCRTVR
  5639     05  WS-CR-DIS-PAY-DT-N REDEFINES                                CL**2
  5640            WS-CR-DIS-PAY-DT           PIC 9(11).                    CL**2
  5641     05  WS-CR-DIS-PTO-DT.                                        ELCCRTVR
  5642         10  FILLER                    PIC 999.                   ELCCRTVR
  5643         10  CR-DIS-PTO-CCYY           PIC 9(04).                 ELCCRTVR
  5644         10  CR-DIS-PTO-CCYR  REDEFINES  CR-DIS-PTO-CCYY.         ELCCRTVR
  5645             15  CR-DIS-PTO-CC         PIC 99.                    ELCCRTVR
  5646             15  CR-DIS-PTO-YR         PIC 99.                    ELCCRTVR
  5647         10  CR-DIS-PTO-MO             PIC 99.                    ELCCRTVR
  5648         10  CR-DIS-PTO-DA             PIC 99.                    ELCCRTVR
  5649     05  WS-CR-DIS-PTO-DT-N REDEFINES                                CL**2
  5650            WS-CR-DIS-PTO-DT           PIC 9(11).                    CL**2
  5651     05  COPY-NDX                      PIC 9.                        CL**6
  5652     05  WS-DIS-INCUR-DT OCCURS 5 TIMES.                             CL**6
  5653         10  WS-CR-DIS-INCUR-DT.                                  ELCCRTVR
  5654             15  FILLER                PIC 999.                   ELCCRTVR
  5655             15  CR-DIS-INC-CCYY       PIC 9(04).                 ELCCRTVR
  5656             15  CR-DIS-INC-CCYR  REDEFINES  CR-DIS-INC-CCYY.     ELCCRTVR
  5657                 20  CR-DIS-INC-CC     PIC 99.                    ELCCRTVR
  5658                 20  CR-DIS-INC-YR     PIC 99.                    ELCCRTVR
  5659             15  CR-DIS-INC-MO         PIC 99.                    ELCCRTVR
  5660             15  CR-DIS-INC-DA         PIC 99.                    ELCCRTVR
  5661         10  WS-CR-DIS-INCUR-DT-N REDEFINES                          CL**2
  5662                WS-CR-DIS-INCUR-DT     PIC 9(11).                    CL**2
  5663
  5664 01  INITIALIZED-CERTIFICATE     PIC X(1056).
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 112
* ECS010P.cbl
* 5666                             COPY ELCDATE.
  5667******************************************************************06/11/98
  5668*                                                                *ELCDATE
  5669*                                                                *ELCDATE
  5670*                            ELCDATE.                            *   LV023
  5671*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL*16
  5672*                            VMOD=2.003                           ELCDATE
  5673*                                                                *ELCDATE
  5674*                                                                *ELCDATE
  5675*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *ELCDATE
  5676*                 LENGTH = 200                                   *   CL*19
  5677******************************************************************ELCDATE
  5678                                                                  ELCDATE
  5679 01  DATE-CONVERSION-DATA.                                        ELCDATE
  5680     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.    CL*19
  5681     12  DC-OPTION-CODE                PIC X.                        CL*15
  5682         88  BIN-TO-GREG                VALUE ' '.                ELCDATE
  5683         88  ELAPSED-BETWEEN-BIN        VALUE '1'.                ELCDATE
  5684         88  EDIT-GREG-TO-BIN           VALUE '2'.                ELCDATE
  5685         88  YMD-GREG-TO-BIN            VALUE '3'.                ELCDATE
  5686         88  MDY-GREG-TO-BIN            VALUE '4'.                ELCDATE
  5687         88  JULIAN-TO-BIN              VALUE '5'.                ELCDATE
  5688         88  BIN-PLUS-ELAPSED           VALUE '6'.                ELCDATE
  5689         88  FIND-CENTURY               VALUE '7'.                   CL*22
  5690         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.                ELCDATE
  5691         88  EDIT-GREG-TO-BIN-3         VALUE '9'.                ELCDATE
  5692         88  YMD-GREG-TO-BIN-3          VALUE 'A'.                ELCDATE
  5693         88  MDY-GREG-TO-BIN-3          VALUE 'B'.                ELCDATE
  5694         88  JULIAN-TO-BIN-3            VALUE 'C'.                ELCDATE
  5695         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.                ELCDATE
  5696         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.                   CL*14
  5697         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.                   CL*14
  5698         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.                   CL*14
  5699         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.         CL*14
  5700         88  CHECK-LEAP-YEAR            VALUE 'H'.                   CL*14
  5701         88  BIN-3-TO-GREG              VALUE 'I'.                   CL*14
  5702         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.                   CL*14
  5703         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.                   CL*14
  5704         88  CYMD-GREG-TO-BIN           VALUE 'L'.                   CL*14
  5705         88  MDCY-GREG-TO-BIN           VALUE 'M'.                   CL*14
  5706         88  MDY-GREG-TO-JULIAN         VALUE 'N'.                   CL*14
  5707         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.                   CL*14
  5708         88  YMD-GREG-TO-JULIAN         VALUE 'P'.                   CL*14
  5709         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.                   CL*14
  5710         88  THREE-CHARACTER-BIN                                  ELCDATE
  5711                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.       CL*14
  5712         88  GREGORIAN-TO-BIN                                        CL**2
  5713                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.    CL*14
  5714         88  BIN-TO-GREGORIAN                                        CL**2
  5715                  VALUES ' ' '1' 'I' '8' 'G'.                        CL*14
  5716         88  JULIAN-TO-BINARY                                        CL**2
  5717                  VALUES '5' 'C' 'E' 'F'.                            CL*14
  5718     12  DC-ERROR-CODE                 PIC X.                        CL*15
  5719         88  NO-CONVERSION-ERROR        VALUE ' '.                   CL**3
  5720         88  DATE-CONVERSION-ERROR                                ELCDATE
  5721                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.        CL*14
  5722         88  DATE-IS-ZERO               VALUE '1'.                ELCDATE
  5723         88  DATE-IS-NON-NUMERIC        VALUE '2'.                ELCDATE
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 113
* ECS010P.cbl (/apps/prod/cid1p/copy/ELCDATE)
  5724         88  DATE-IS-INVALID            VALUE '3'.                ELCDATE
  5725         88  DATE1-GREATER-DATE2        VALUE '4'.                ELCDATE
  5726         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.                ELCDATE
  5727         88  DATE-INVALID-OPTION        VALUE '9'.                ELCDATE
  5728         88  INVALID-CENTURY            VALUE 'A'.                ELCDATE
  5729         88  ONLY-CENTURY               VALUE 'B'.                ELCDATE
  5730         88  ONLY-LEAP-YEAR             VALUE 'C'.                ELCDATE
  5731         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.              CL**3
  5732     12  DC-END-OF-MONTH               PIC X.                        CL*15
  5733         88  CALCULATE-END-OF-MONTH     VALUE '1'.                ELCDATE
  5734     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.         CL*15
  5735         88  USE-NORMAL-PROCESS         VALUE ' '.                ELCDATE
  5736         88  ADJUST-DOWN-100-YRS        VALUE '1'.                ELCDATE
  5737         88  ADJUST-UP-100-YRS          VALUE '2'.                ELCDATE
  5738     12  FILLER                        PIC X.                        CL*15
  5739     12  DC-CONVERSION-DATES.                                        CL*15
  5740         16  DC-BIN-DATE-1             PIC XX.                       CL*15
  5741         16  DC-BIN-DATE-2             PIC XX.                       CL*15
  5742         16  DC-GREG-DATE-1-EDIT       PIC X(08).                    CL*15
  5743         16  DC-GREG-DATE-1-EDIT-R REDEFINES                         CL*15
  5744                       DC-GREG-DATE-1-EDIT.                       ELCDATE
  5745             20  DC-EDIT1-MONTH        PIC 99.                       CL*15
  5746             20  SLASH1-1              PIC X.                        CL*15
  5747             20  DC-EDIT1-DAY          PIC 99.                       CL*15
  5748             20  SLASH1-2              PIC X.                        CL*15
  5749             20  DC-EDIT1-YEAR         PIC 99.                       CL*15
  5750         16  DC-GREG-DATE-2-EDIT       PIC X(08).                    CL*15
  5751         16  DC-GREG-DATE-2-EDIT-R REDEFINES                         CL*15
  5752                     DC-GREG-DATE-2-EDIT.                         ELCDATE
  5753             20  DC-EDIT2-MONTH        PIC 99.                       CL*15
  5754             20  SLASH2-1              PIC X.                        CL*15
  5755             20  DC-EDIT2-DAY          PIC 99.                       CL*15
  5756             20  SLASH2-2              PIC X.                        CL*15
  5757             20  DC-EDIT2-YEAR         PIC 99.                       CL*15
  5758         16  DC-GREG-DATE-1-YMD        PIC 9(06).                    CL*15
  5759         16  DC-GREG-DATE-1-YMD-R  REDEFINES                         CL*15
  5760                     DC-GREG-DATE-1-YMD.                          ELCDATE
  5761             20  DC-YMD-YEAR           PIC 99.                       CL*15
  5762             20  DC-YMD-MONTH          PIC 99.                       CL*15
  5763             20  DC-YMD-DAY            PIC 99.                       CL*15
  5764         16  DC-GREG-DATE-1-MDY        PIC 9(06).                    CL*15
  5765         16  DC-GREG-DATE-1-MDY-R REDEFINES                          CL*15
  5766                      DC-GREG-DATE-1-MDY.                         ELCDATE
  5767             20  DC-MDY-MONTH          PIC 99.                       CL*15
  5768             20  DC-MDY-DAY            PIC 99.                       CL*15
  5769             20  DC-MDY-YEAR           PIC 99.                       CL*15
  5770         16  DC-GREG-DATE-1-ALPHA.                                   CL*15
  5771             20  DC-ALPHA-MONTH        PIC X(10).                    CL*15
  5772             20  DC-ALPHA-DAY          PIC 99.                       CL*15
  5773             20  FILLER                PIC XX.                       CL*15
  5774             20  DC-ALPHA-CENTURY.                                   CL*15
  5775                 24 DC-ALPHA-CEN-N     PIC 99.                       CL*15
  5776             20  DC-ALPHA-YEAR         PIC 99.                       CL*15
  5777         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.           CL*15
  5778         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.           CL*15
  5779         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.           CL*15
  5780         16  DC-JULIAN-DATE            PIC 9(05).                    CL*15
  5781         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE                CL*20
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 114
* ECS010P.cbl (/apps/prod/cid1p/copy/ELCDATE)
  5782                                       PIC 9(05).                    CL*20
  5783         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.                  CL*15
  5784             20  DC-JULIAN-YEAR        PIC 99.                       CL*15
  5785             20  DC-JULIAN-DAYS        PIC 999.                      CL*15
  5786         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.       CL*15
  5787         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.    CL*15
  5788         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.    CL*15
  5789     12  DATE-CONVERSION-VARIBLES.                                   CL*15
  5790         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.            CL*15
  5791         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.          CL*15
  5792             20  FILLER                PIC 9(3).                     CL*15
  5793             20  HOLD-CEN-1-CCYY.                                    CL*15
  5794                 24  HOLD-CEN-1-CC     PIC 99.                       CL*17
  5795                 24  HOLD-CEN-1-YY     PIC 99.                       CL*17
  5796             20  HOLD-CEN-1-MO         PIC 99.                       CL*17
  5797             20  HOLD-CEN-1-DA         PIC 99.                       CL*17
  5798         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.            CL*15
  5799             20  HOLD-CEN-1-R-MO       PIC 99.                       CL*17
  5800             20  HOLD-CEN-1-R-DA       PIC 99.                       CL*17
  5801             20  HOLD-CEN-1-R-CCYY.                                  CL*15
  5802                 24  HOLD-CEN-1-R-CC   PIC 99.                       CL*17
  5803                 24  HOLD-CEN-1-R-YY   PIC 99.                       CL*17
  5804             20  FILLER                PIC 9(3).                     CL*15
  5805         16  HOLD-CENTURY-1-X.                                       CL*15
  5806             20  FILLER                PIC X(3)  VALUE SPACES.       CL*15
  5807             20  HOLD-CEN-1-X-CCYY.                                  CL*15
  5808                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.          CL*17
  5809                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.          CL*17
  5810             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.          CL*17
  5811             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.          CL*17
  5812         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.          CL*15
  5813             20  HOLD-CEN-1-R-X-MO     PIC XX.                       CL*17
  5814             20  HOLD-CEN-1-R-X-DA     PIC XX.                       CL*17
  5815             20  HOLD-CEN-1-R-X-CCYY.                                CL*15
  5816                 24  HOLD-CEN-1-R-X-CC PIC XX.                       CL*17
  5817                 24  HOLD-CEN-1-R-X-YY PIC XX.                       CL*17
  5818             20  FILLER                PIC XXX.                      CL*23
  5819         16  DC-BIN-DATE-EXPAND-1      PIC XXX.                      CL*15
  5820         16  DC-BIN-DATE-EXPAND-2      PIC XXX.                      CL*15
  5821         16  DC-JULIAN-DATE-1          PIC 9(07).                    CL*15
  5822         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.          CL*15
  5823             20  DC-JULIAN-1-CCYY.                                   CL*15
  5824                 24  DC-JULIAN-1-CC    PIC 99.                       CL*15
  5825                 24  DC-JULIAN-1-YR    PIC 99.                       CL*15
  5826             20  DC-JULIAN-DA-1        PIC 999.                      CL*15
  5827         16  DC-JULIAN-DATE-2          PIC 9(07).                    CL*15
  5828         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.          CL*15
  5829             20  DC-JULIAN-2-CCYY.                                   CL*15
  5830                 24  DC-JULIAN-2-CC    PIC 99.                       CL*15
  5831                 24  DC-JULIAN-2-YR    PIC 99.                       CL*15
  5832             20  DC-JULIAN-DA-2        PIC 999.                      CL*15
  5833         16  DC-GREG-DATE-A-EDIT.                                    CL*15
  5834             20  DC-EDITA-MONTH        PIC 99.                       CL*15
  5835             20  SLASHA-1              PIC X VALUE '/'.              CL*15
  5836             20  DC-EDITA-DAY          PIC 99.                       CL*15
  5837             20  SLASHA-2              PIC X VALUE '/'.              CL*15
  5838             20  DC-EDITA-CCYY.                                      CL*15
  5839                 24  DC-EDITA-CENT     PIC 99.                       CL*15
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 115
* ECS010P.cbl (/apps/prod/cid1p/copy/ELCDATE)
  5840                 24  DC-EDITA-YEAR     PIC 99.                       CL*15
  5841         16  DC-GREG-DATE-B-EDIT.                                    CL*15
  5842             20  DC-EDITB-MONTH        PIC 99.                       CL*15
  5843             20  SLASHB-1              PIC X VALUE '/'.              CL*15
  5844             20  DC-EDITB-DAY          PIC 99.                       CL*15
  5845             20  SLASHB-2              PIC X VALUE '/'.              CL*15
  5846             20  DC-EDITB-CCYY.                                      CL*15
  5847                 24  DC-EDITB-CENT     PIC 99.                       CL*15
  5848                 24  DC-EDITB-YEAR     PIC 99.                       CL*15
  5849         16  DC-GREG-DATE-CYMD         PIC 9(08).                    CL*15
  5850         16  DC-GREG-DATE-CYMD-R REDEFINES                           CL*15
  5851                              DC-GREG-DATE-CYMD.                  ELCDATE
  5852             20  DC-CYMD-CEN           PIC 99.                       CL*15
  5853             20  DC-CYMD-YEAR          PIC 99.                       CL*15
  5854             20  DC-CYMD-MONTH         PIC 99.                       CL*15
  5855             20  DC-CYMD-DAY           PIC 99.                       CL*15
  5856         16  DC-GREG-DATE-MDCY         PIC 9(08).                    CL*15
  5857         16  DC-GREG-DATE-MDCY-R REDEFINES                           CL*15
  5858                              DC-GREG-DATE-MDCY.                  ELCDATE
  5859             20  DC-MDCY-MONTH         PIC 99.                       CL*15
  5860             20  DC-MDCY-DAY           PIC 99.                       CL*15
  5861             20  DC-MDCY-CEN           PIC 99.                       CL*15
  5862             20  DC-MDCY-YEAR          PIC 99.                       CL*15
  5863    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.      ELCDATE
  5864        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.        ELCDATE
  5865    12  DC-EL310-DATE                  PIC X(21).                    CL*26
  5866    12  FILLER                         PIC X(28).                    CL*26
* 5867                             COPY ELCFUNDT.
  5868***************************************************************** 12/03/98
  5869*                                                               * ELCFUNDT
  5870*                            ELCFUNDT.                          *    LV004
  5871*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE *             CL**4
  5872*                            VMOD=2.001                         * ELCFUNDT
  5873*                                                               * ELCFUNDT
  5874*           COPYBOOK FOR THE FUNCTION DATE FORMAT               * ELCFUNDT
  5875*                                                               * ELCFUNDT
  5876***************************************************************** ELCFUNDT
  5877                                                                  ELCFUNDT
  5878                                                                  ELCFUNDT
  5879 01  FUNCTION-DATE.                                                  CL**2
  5880     05  WS-FN-DATE                PIC 9(8)    VALUE ZEROS.          CL**3
  5881     05  WS-FN-CYMD  REDEFINES  WS-FN-DATE.                          CL**3
  5882         10  WS-FN-CCYR            PIC 9(4).                         CL**3
  5883         10  WS-FN-CCYY  REDEFINES  WS-FN-CCYR.                      CL**3
  5884             15  WS-FN-CC          PIC 99.                           CL**3
  5885             15  WS-FN-YR          PIC 99.                           CL**3
  5886         10  WS-FN-MO              PIC 99.                           CL**3
  5887         10  WS-FN-DA              PIC 99.                           CL**3
  5888     05  WS-FN-HOURS               PIC 99      VALUE ZEROS.          CL**3
  5889     05  WS-FN-MINUTES             PIC 99      VALUE ZEROS.          CL**3
  5890     05  WS-FN-SECONDS             PIC 99      VALUE ZEROS.          CL**3
  5891     05  WS-FN-HUNDSECS            PIC 99      VALUE ZEROS.          CL**3
  5892     05  WS-FN-GMT-IND             PIC X       VALUE SPACES.         CL**2
  5893         88  WS-BEHIND-GMT                     VALUE '-'.            CL**2
  5894         88  WS-AFTER-GMT                      VALUE '+'.            CL**2
  5895         88  WS-NO-GMT                         VALUE ZERO.           CL**2
  5896     05  WS-FN-GMT-HOURS           PIC 99      VALUE ZEROS.          CL**2
  5897     05  WS-FN-GMT-MINUTES         PIC 99      VALUE ZEROS.          CL**2
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 116
* ECS010P.cbl
  5898
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 117
* ECS010P.cbl
  5900 01  CPA-STARTS-HERE             PIC X(48)
  5901       VALUE '***** CALCULATION PASS AREA STARTS HERE ********'.
* 5902                             COPY ELCCALC.
  5903******************************************************************04/15/98
  5904*                                                                *ELCCALC
  5905*                           ELCCALC.                            *    LV003
  5906*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
  5907*                            VMOD=2.025                          *   CL**3
  5908*                                                                *   CL**2
  5909*   DESCRIPTION:  DATA TO BE PASSED TO REMAINING TERM ROUTINE    *   CL**2
  5910*                 REMAINING AMOUNT ROUTINE, LOSS RESERVE ROUTINE *   CL**2
  5911*                 REFUND CALCULATIONS ROUTINE, EARNINGS CALCU -  *   CL**2
  5912*                 LATIONS ROUTINE, AND THE RATING ROUTINE.       *   CL**2
  5913*                                                                *   CL**2
  5914*  PASSED TO ELRTRM                                              *   CL**2
  5915*  -----------------                                             *   CL**2
  5916*  METHOD CODE (I.E. FULL MONTH, HALF ADJ, ETC)                  *   CL**2
  5917*  ORIGINAL TERM                                                 *   CL**2
  5918*  BEGINNING DATE                                                *   CL**2
  5919*  ENDING DATE                                                   *   CL**2
  5920*  COMPANY I.D.                                                  *   CL**2
  5921*  ACCOUNT MASTER USER FIELD                                     *   CL**2
  5922*  PROCESS SWITCH (CANCEL, CLAIM)                                *   CL**2
  5923*  FREE LOOK DAYS                                                *   CL**2
  5924*                                                                *   CL**2
  5925*  RETURNED FROM ELRTRM                                          *   CL**2
  5926*  ---------------------                                         *   CL**2
  5927*  REMAINING TERM 1 - USED FOR EARNINGS                          *   CL**2
  5928*  REMAINING TERM 2 - USED FOR BENEFIT CALCULATIONS              *   CL**2
  5929*  REMAINING TERM 3 - USED FOR CLAIM BENEFITS                    *   CL**2
  5930*  ODD DAYS - REMAINING DAYS PAST FULL MONTHS                    *   CL**2
  5931*----------------------------------------------------------------*   CL**2
  5932*  PASSED TO ELRAMT                                              *   CL**2
  5933*  ----------------                                              *   CL**2
  5934*  REMAINING TERM 1 OR 2 OR 3 (FROM ELRTRM)                      *   CL**2
  5935*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *   CL**2
  5936*  ORIGINAL AMOUNT                                               *   CL**2
  5937*  ALTERNATE BENEFIT (BALLON)                                    *   CL**2
  5938*  A.P.R. - NET PAY ONLY                                         *   CL**2
  5939*  METHOD                                                            CL**2
  5940*  PAYMENT FREQUENCY - FOR FARM PLAN                             *   CL**2
  5941*  COMPANY I.D.                                                  *   CL**2
  5942*  BENEFIT TYPE                                                  *   CL**2
  5943*                                                                *   CL**2
  5944*  RETURNED FROM ELRAMT                                          *   CL**2
  5945*  --------------------                                          *   CL**2
  5946*  REMAINING AMOUNT 1 - CURRENT                                  *   CL**2
  5947*  REMAINING AMOUNT 2 - PREVIOUS MONTH                           *   CL**2
  5948*  REMAINING AMOUNT FACTOR                                           CL**2
  5949*----------------------------------------------------------------*   CL**2
  5950*  PASSED TO ELRESV                                              *   CL**2
  5951*  -----------------                                             *   CL**2
  5952*  CERTIFICATE EFFECTIVE DATE                                    *   CL**2
  5953*  VALUATION DATE                                                *   CL**2
  5954*  PAID THRU DATE                                                *   CL**2
  5955*  BENEFIT                                                       *   CL**2
  5956*  INCURRED DATE                                                 *   CL**2
  5957*  REPORTED DATE                                                 *   CL**2
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 118
* ECS010P.cbl (/apps/prod/cid1p/copy/ELCCALC)
  5958*  ISSUE AGE                                                     *   CL**2
  5959*  TERM                                                          *   CL**2
  5960*  CDT PERCENT                                                   *   CL**2
  5961*  CDT METHOD (I.E. INTERPOLATED, AVERAGE, ETC)                  *   CL**2
  5962* *CLAIM TYPE (LIFE, A/H)                                        *   CL**2
  5963* *REMAINING BENEFIT (FROM ELRAMT)                               *   CL**2
  5964* *ONLY FIELDS REQUIRED FOR LIFE CLAIMS                          *   CL**2
  5965*                                                                *   CL**2
  5966*  RETURNED FROM ELRESV                                          *   CL**2
  5967*  --------------------                                          *   CL**2
  5968*  CDT TABLE USED                                                *   CL**2
  5969*  CDT FACTOR USED                                               *   CL**2
  5970*  PAY TO CURRENT RESERVE                                        *   CL**2
  5971*  I.B.N.R. - A/H ONLY                                           *   CL**2
  5972*  FUTURE (ACCRUED) AH ONLY                                      *   CL**2
  5973*----------------------------------------------------------------*   CL**2
  5974*  PASSED TO ELRATE                                              *   CL**2
  5975*  ----------------                                              *   CL**2
  5976*  CERT ISSUE DATE                                               *   CL**2
  5977*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *   CL**2
  5978*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *   CL**2
  5979*  CAPPED TERM   (ONLY FOR TRUNCATED LIFE)                       *   CL**2
  5980*  STATE CODE (CLIENT DEFINED)                                   *   CL**2
  5981*  STATE CODE (STANDARD P.O. ABBRV)                              *   CL**2
  5982*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *   CL**2
  5983*  DEVIATION CODE                                                *   CL**2
  5984*  ISSUE AGE                                                     *   CL**2
  5985*  ORIGINAL BENEFIT AMOUNT                                       *   CL**2
  5986*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *   CL**2
  5987*  PROCESS TYPE (ISSUE OR CANCEL)                                *   CL**2
  5988*  BENEFIT KIND (LIFE OR A/H)                                    *   CL**2
  5989*  A.P.R.                                                        *   CL**2
  5990*  METHOD                                                            CL**2
  5991*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *   CL**2
  5992*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *   CL**2
  5993*  COMPANY I.D. (3 CHARACTER)                                    *   CL**2
  5994*  BENEFIT CODE                                                  *   CL**2
  5995*  BENEFIT OVERRIDE CODE                                         *   CL**2
  5996*  MAXIMUM MONTHLY BENEFIT (FROM ACCT MASTER - CSL ONLY)         *   CL**2
  5997*  MAXIMUM TOTAL BENEFIT (FROM ACCT MASTER - CSL ONLY)           *   CL**2
  5998*  JOINT INDICATOR (CSL ONLY)                                    *   CL**2
  5999*  FIRST PAYMENT DATE (CSL ONLY)                                 *   CL**2
  6000*  PERIODIC PAYMENT AMOUNT (IN CP-REMAINING-TERM - CSL ONLY)     *   CL**2
  6001*                                                                *   CL**2
  6002*  RETURNED FROM ELRATE                                          *   CL**2
  6003*  --------------------                                          *   CL**2
  6004*  CALCULATED PREMIUM                                            *   CL**2
  6005*  PREMIUM RATE                                                  *   CL**2
  6006*  MORTALITY CODE                                                *   CL**2
  6007*  MAX ATTAINED AGE                                              *   CL**2
  6008*  MAX AGE                                                       *   CL**2
  6009*  MAX TERM                                                      *   CL**2
  6010*  MAX MONTHLY BENEFIT                                           *   CL**2
  6011*  MAX TOTAL BENIFIT                                             *   CL**2
  6012*  COMPOSITE RATE (OPEN-END ONLY)                                *   CL**2
  6013*----------------------------------------------------------------*   CL**2
  6014*  PASSED TO ELRFND                                              *   CL**2
  6015*  ----------------                                              *   CL**2
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 119
* ECS010P.cbl (/apps/prod/cid1p/copy/ELCCALC)
  6016*  CERT ISSUE DATE                                               *   CL**2
  6017*  REFUND DATE                                                   *   CL**2
  6018*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *   CL**2
  6019*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *   CL**2
  6020*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *   CL**2
  6021*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *   CL**2
  6022*  STATE CODE (CLIENT DEFINED)                                   *   CL**2
  6023*  STATE CODE (STANDARD P.O. ABBRV)                              *   CL**2
  6024*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *   CL**2
  6025*  DEVIATION CODE                                                *   CL**2
  6026*  ISSUE AGE                                                     *   CL**2
  6027*  ORIGINAL BENEFIT AMOUNT                                       *   CL**2
  6028*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *   CL**2
  6029*  PROCESS TYPE (CANCEL)                                         *   CL**2
  6030*  BENEFIT KIND (LIFE OR A/H)                                    *   CL**2
  6031*  A.P.R.                                                        *   CL**2
  6032*  EARNING METHOD - (CODE FROM BENEFIT, STATE OR ACCOUNT RECORD) *   CL**2
  6033*  RATING METHOD -  (CODE FROM BENEFIT)                          *   CL**2
  6034*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *   CL**2
  6035*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *   CL**2
  6036*  COMPANY I.D. (3 CHARACTER)                                    *   CL**2
  6037*  BENEFIT CODE                                                  *   CL**2
  6038*  BENEFIT OVERRIDE CODE                                         *   CL**2
  6039*                                                                *   CL**2
  6040*  RETURNED FROM ELRFND                                          *   CL**2
  6041*  --------------------                                          *   CL**2
  6042*  CALCULATED REFUND                                             *   CL**2
  6043*----------------------------------------------------------------*   CL**2
  6044*  PASSED TO ELEARN                                              *   CL**2
  6045*  ----------------                                              *   CL**2
  6046*  CERT ISSUE DATE                                               *   CL**2
  6047*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *   CL**2
  6048*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *   CL**2
  6049*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *   CL**2
  6050*  STATE CODE (CLIENT DEFINED)                                   *   CL**2
  6051*  STATE CODE (STANDARD P.O. ABBRV)                              *   CL**2
  6052*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *   CL**2
  6053*  DEVIATION CODE                                                *   CL**2
  6054*  ISSUE AGE                                                     *   CL**2
  6055*  ORIGINAL BENEFIT AMOUNT                                       *   CL**2
  6056*  BENEFIT KIND (LIFE OR A/H)                                    *   CL**2
  6057*  A.P.R.                                                        *   CL**2
  6058*  METHOD - (EARNING CODE FROM BENEFIT RECORD)                   *   CL**2
  6059*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *   CL**2
  6060*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *   CL**2
  6061*  COMPANY I.D. (3 CHARACTER)                                    *   CL**2
  6062*  BENEFIT CODE                                                  *   CL**2
  6063*  BENEFIT OVERRIDE CODE                                         *   CL**2
  6064*                                                                *   CL**2
  6065*  RETURNED FROM ELEARN                                          *   CL**2
  6066*  --------------------                                          *   CL**2
  6067*  INDICATED  EARNINGS                                           *   CL**2
  6068*----------------------------------------------------------------*   CL**2
  6069*                 LENGTH = 450                                   *   CL**2
  6070*                                                                *   CL**2
  6071******************************************************************   CL**2
  6072******************************************************************
  6073*                   C H A N G E   L O G
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 120
* ECS010P.cbl (/apps/prod/cid1p/copy/ELCCALC)
  6074*
  6075* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6076*-----------------------------------------------------------------
  6077*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6078* EFFECTIVE    NUMBER
  6079*-----------------------------------------------------------------
  6080* 010303    2001061800003  PEMA  ADD DCC/MONTHLY PROCESSING
  6081* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  6082* 101807    2007100100007  PEMA  EXPAND CLM RESERVE FIELDS
  6083* 010410    2008021200005  PEMA  ADD FIELDS FOR MN NET PAY BALLOON
  6084* 010410    2009050700003  PEMA  ADD FIELDS FOR SPP-DD
  6085* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  6086* 041710    2007111300001  AJRA  ADD CLAIM CALC SW FOR SC NP+6
  6087* 101110  CR2010012700001  PEMA ADD DDF REFUND/UEP PROCESSING
  6088* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  6089* 040615  CR2013072200002  PEMA  ADD EXTRA PERIODS
  6090******************************************************************
  6091                                                                     CL**2
  6092 01  CALCULATION-PASS-AREA.                                          CL**2
  6093     12  CP-COMM-LENGTH            PIC S9(4)         VALUE +450      CL**2
  6094                                     COMP.                           CL**2
  6095                                                                     CL**2
  6096     12  CP-RETURN-CODE            PIC X             VALUE ZERO.     CL**2
  6097       88  NO-CP-ERROR                             VALUE ZERO.       CL**2
  6098       88  CP-ERROR-OCCURED VALUE '1' '2' '3' '4' '5' '6' '7' '8'    CL**2
  6099                                  '9' 'A' 'B' 'C' 'D' 'E' 'H'.       CL**2
  6100       88  CP-ERROR-IN-AMOUNTS                     VALUE '1'.        CL**2
  6101       88  CP-ERROR-IN-DATES                       VALUE '2'.        CL**2
  6102       88  CP-ERROR-IN-OPTIONS                     VALUE '3'.        CL**2
  6103       88  CP-ERROR-IN-TERMS                       VALUE '4'.        CL**2
  6104       88  CP-ERROR-IN-FREQUENCY                   VALUE '5'.        CL**2
  6105       88  CP-ERROR-RATE-NOT-FOUND                 VALUE '6'.        CL**2
  6106       88  CP-ERROR-RATE-IS-ZERO                   VALUE '7'.        CL**2
  6107       88  CP-ERROR-AMT-OUTSIDE-LIMIT              VALUE '8'.        CL**2
  6108       88  CP-ERROR-TERM-OUTSIDE-LIMIT             VALUE '9'.        CL**2
  6109       88  CP-ERROR-AGE-OUTSIDE-LIMIT              VALUE 'A'.        CL**2
  6110       88  CP-ERROR-ATT-OUTSIDE-LIMIT              VALUE 'B'.        CL**2
  6111       88  CP-ERROR-TOT-OUTSIDE-LIMIT              VALUE 'C'.        CL**2
  6112       88  CP-ERROR-RATE-FILE-NOTOPEN              VALUE 'D'.        CL**2
  6113       88  CP-ERROR-ISSUE-AGE-ZERO                 VALUE 'E'.        CL**2
  6114       88  CP-ERROR-NO-LIMITS-CRI                  VALUE 'F'.        CL**2
  6115       88  CP-ERROR-DIV-BY-ZERO                    VALUE 'G'.        CL**2
  6116       88  CP-ERROR-LOAN-TERM                      VALUE 'H'.        CL**2
  6117                                                                     CL**2
  6118     12  CP-RETURN-CODE-2          PIC X             VALUE ZERO.     CL**2
  6119       88  NO-CP-ERROR-2                           VALUE ZERO.       CL**2
  6120***********************  INPUT AREAS ****************************    CL**2
  6121                                                                     CL**2
  6122     12  CP-CALCULATION-AREA.                                        CL**2
  6123         16  CP-ACCOUNT-NUMBER     PIC X(10)       VALUE SPACES.     CL**2
  6124         16  CP-CERT-EFF-DT        PIC XX.                           CL**2
  6125         16  CP-VALUATION-DT       PIC XX.                           CL**2
  6126         16  CP-PAID-THRU-DT       PIC XX.                           CL**2
  6127         16  CP-BENEFIT-TYPE       PIC X.                            CL**2
  6128           88  CP-AH                               VALUE 'A' 'D'     CL**2
  6129                                                   'I' 'U'.          CL**2
  6130           88  CP-REDUCING-LIFE                    VALUE 'R'.        CL**2
  6131           88  CP-LEVEL-LIFE                       VALUE 'L' 'P'.    CL**2
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 121
* ECS010P.cbl (/apps/prod/cid1p/copy/ELCCALC)
  6132         16  CP-INCURRED-DT        PIC XX.                           CL**2
  6133         16  CP-REPORTED-DT        PIC XX.                           CL**2
  6134         16  CP-ACCT-FLD-5         PIC XX            VALUE SPACE.    CL**2
  6135         16  CP-COMPANY-ID         PIC XXX           VALUE SPACE.    CL**2
  6136         16  CP-ISSUE-AGE          PIC S9(3)         VALUE ZERO      CL**2
  6137                                     COMP-3.                         CL**2
  6138         16  CP-CDT-PERCENT        PIC S9(3)V99      VALUE ZERO      CL**2
  6139                                     COMP-3.                         CL**2
  6140         16  CP-CDT-METHOD         PIC X.                            CL**2
  6141           88  CP-CDT-ROUND-NEAR                   VALUE '1'.        CL**2
  6142           88  CP-CDT-ROUND-HIGH                   VALUE '2'.        CL**2
  6143           88  CP-CDT-INTERPOLATED                 VALUE '3'.        CL**2
  6144         16  CP-CLAIM-TYPE         PIC X.                            CL**2
  6145           88  CP-AH-CLAIM                         VALUE 'A'.        CL**2
  6146           88  CP-LIFE-CLAIM                       VALUE 'L'.        CL**2
  6147         16  CP-ORIGINAL-TERM      PIC S9(3)         VALUE ZERO      CL**2
  6148                                     COMP-3.                         CL**2
  6149         16  CP-ORIGINAL-BENEFIT   PIC S9(9)V99      VALUE ZERO      CL**2
  6150                                     COMP-3.                         CL**2
  6151         16  CP-ORIGINAL-PREMIUM   PIC S9(7)V99      VALUE ZERO      CL**2
  6152                                     COMP-3.                         CL**2
  6153         16  CP-REMAINING-TERM     PIC S9(3)V99      VALUE ZERO      CL**2
  6154                                     COMP-3.                         CL**2
  6155         16  CP-REMAINING-BENEFIT  PIC S9(9)V99      VALUE ZERO      CL**2
  6156                                     COMP-3.                         CL**2
  6157         16  CP-LOAN-APR           PIC S9(3)V9(4)    VALUE ZERO      CL**2
  6158                                     COMP-3.                         CL**2
  6159         16  CP-PAY-FREQUENCY      PIC S9(3)         VALUE ZERO      CL**2
  6160                                     COMP-3.                         CL**2
  6161         16  CP-REM-TERM-METHOD    PIC X.                            CL**2
  6162           88  CP-EARN-AFTER-15TH                  VALUE '1'.        CL**2
  6163           88  CP-EARN-ON-HALF-MONTH               VALUE '2'.        CL**2
  6164           88  CP-EARN-ON-1ST-DAY                  VALUE '3'.        CL**2
  6165           88  CP-EARN-ON-FULL-MONTH               VALUE '4'.        CL**2
  6166           88  CP-EARN-WITH-NO-DAYS                VALUE '5'.        CL**2
  6167           88  CP-EARN-AFTER-14TH                  VALUE '6'.        CL**2
  6168           88  CP-EARN-AFTER-16TH                  VALUE '7'.        CL**2
  6169         16  CP-EARNING-METHOD     PIC X.                            CL**2
  6170           88  CP-EARN-BY-R78                      VALUE '1' 'R'.    CL**2
  6171           88  CP-EARN-BY-PRORATA                  VALUE '2' 'P'.    CL**2
  6172           88  CP-EARN-AS-CALIF                    VALUE '3' 'C'.    CL**2
  6173           88  CP-EARN-AS-TEXAS                    VALUE '4' 'T'.    CL**2
  6174           88  CP-EARN-AS-FARM-PLAN                VALUE '4' 'T'.    CL**2
  6175           88  CP-EARN-AS-NET-PAY                  VALUE '5' 'N'.    CL**2
  6176           88  CP-EARN-ANTICIPATION                VALUE '6' 'A'.    CL**2
  6177           88  CP-EARN-AS-MEAN                     VALUE '8' 'M'.    CL**2
  6178           88  CP-EARN-AS-SUM-OF-DIGITS            VALUE '9'.        CL**2
  6179           88  CP-EARN-AS-REG-BALLOON              VALUE 'B'.        CL**2
  6180           88  CP-GAP-NON-REFUNDABLE               VALUE 'G'.
  6181           88  CP-GAP-ACTUARIAL                    VALUE 'S'.
  6182           88  CP-DCC-SPP-DDF                      VALUE 'D' 'I'.
  6183           88  CP-DCC-SPP-DDF-IU                   VALUE 'I'.
  6184         16  CP-PROCESS-TYPE       PIC X.                            CL**2
  6185           88  CP-CLAIM                            VALUE '1'.        CL**2
  6186           88  CP-CANCEL                           VALUE '2'.        CL**2
  6187           88  CP-ISSUE                            VALUE '3'.        CL**2
  6188         16  CP-SPECIAL-CALC-CD    PIC X.                            CL**2
  6189           88  CP-OUTSTANDING-BAL              VALUE 'O'.            CL**2
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 122
* ECS010P.cbl (/apps/prod/cid1p/copy/ELCCALC)
  6190           88  CP-1-MTH-INTEREST               VALUE ' '.            CL**2
  6191           88  CP-0-MTH-INTEREST               VALUE 'A'.            CL**2
  6192           88  CP-OB-OFFLINE-RESERVED          VALUE 'B'.            CL**2
  6193           88  CP-CRITICAL-PERIOD              VALUE 'C'.            CL**2
  6194           88  CP-TERM-IS-DAYS                 VALUE 'D'.            CL**2
  6195           88  CP-USE-PREM-AS-ENTERED          VALUE 'E'.            CL**2
  6196           88  CP-FARM-PLAN                    VALUE 'F'.            CL**2
  6197           88  CP-RATE-AS-STANDARD             VALUE 'G'.            CL**2
  6198           88  CP-2-MTH-INTEREST               VALUE 'I'.            CL**2
  6199           88  CP-3-MTH-INTEREST               VALUE 'J'.            CL**2
  6200           88  CP-4-MTH-INTEREST               VALUE 'K'.            CL**2
  6201           88  CP-BALLOON-LAST-PMT             VALUE 'L'.            CL**2
  6202           88  CP-MORTGAGE-REC                 VALUE 'M'.            CL**2
  6203           88  CP-OUTSTANDING-BALANCE          VALUE 'O'.            CL**2
  6204           88  CP-NET-PAY-PRUDENTIAL           VALUE 'P'.            CL**2
  6205           88  CP-NET-PAY-SIMPLE               VALUE 'S'.            CL**2
  6206           88  CP-TRUNCATED-LIFE               VALUE 'T' 'U' 'V'     CL**2
  6207                                                     'W' 'X'.        CL**2
  6208           88  CP-TRUNCATE-0-MTH               VALUE 'T'.            CL**2
  6209           88  CP-TRUNCATE-1-MTH               VALUE 'U'.            CL**2
  6210           88  CP-TRUNCATE-2-MTH               VALUE 'V'.            CL**2
  6211           88  CP-TRUNCATE-3-MTH               VALUE 'W'.            CL**2
  6212           88  CP-TRUNCATE-4-MTH               VALUE 'X'.            CL**2
  6213           88  CP-SUMMARY-REC                  VALUE 'Z'.            CL**2
  6214           88  CP-PROPERTY-BENEFIT             VALUE '2'.            CL**2
  6215           88  CP-UNEMPLOYMENT-BENEFIT         VALUE '3'.            CL**2
  6216           88  CP-AD-D-BENEFIT                 VALUE '4'.            CL**2
  6217           88  CP-CSL-METH-1                   VALUE '5'.            CL**2
  6218           88  CP-CSL-METH-2                   VALUE '6'.            CL**2
  6219           88  CP-CSL-METH-3                   VALUE '7'.            CL**2
  6220           88  CP-CSL-METH-4                   VALUE '8'.            CL**2
  6221                                                                     CL**2
  6222         16  CP-LOAN-TERM          PIC S9(3)       VALUE ZERO        CL**2
  6223                                     COMP-3.                         CL**2
  6224         16  CP-CLASS-CODE         PIC XX          VALUE ZERO.       CL**2
  6225         16  CP-DEVIATION-CODE     PIC XXX         VALUE ZERO.       CL**2
  6226         16  CP-STATE              PIC XX          VALUE SPACE.      CL**2
  6227         16  CP-STATE-STD-ABBRV    PIC XX          VALUE SPACE.      CL**2
  6228         16  CP-BENEFIT-CD         PIC XX          VALUE ZERO.       CL**2
  6229           88  CP-CSL-VALID-NP-BENEFIT-CD VALUES '12' '13'           CL**2
  6230               '34' '35' '36' '37' '44' '45' '46' '47' '72' '73'.    CL**2
  6231         16  CP-R78-OPTION         PIC X.                            CL**2
  6232           88  CP-TERM-TIMES-TERM-PLUS-1           VALUE ' '.        CL**2
  6233           88  CP-TERM-TIMES-TERM                  VALUE '1'.        CL**2
  6234                                                                     CL**2
  6235         16  CP-COMPANY-CD         PIC X             VALUE SPACE.    CL**2
  6236         16  CP-IBNR-RESERVE-SW    PIC X.                            CL**2
  6237         16  CP-CLAIM-STATUS       PIC X.                            CL**2
  6238         16  CP-RATE-FILE          PIC X.                            CL**2
  6239         16  CP-TERM-OR-EXT-DAYS   PIC S9(05)        VALUE ZERO      CL**2
  6240                                     COMP-3.                         CL**2
  6241                                                                     CL**2
  6242         16  CP-LIFE-OVERRIDE-CODE PIC X.                            CL**2
  6243         16  CP-AH-OVERRIDE-CODE   PIC X.                            CL**2
  6244                                                                     CL**2
  6245         16  CP-RATE-DEV-PCT       PIC S9V9(6)       VALUE ZERO      CL**2
  6246                                     COMP-3.
  6247         16  CP-CLP-RATE-UP        REDEFINES CP-RATE-DEV-PCT
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 123
* ECS010P.cbl (/apps/prod/cid1p/copy/ELCCALC)
  6248                                   PIC S9(5)V99 COMP-3.
  6249         16  CP-CRITICAL-MONTHS    PIC S9(3)         VALUE ZERO      CL**2
  6250                                     COMP-3.                         CL**2
  6251         16  CP-ALTERNATE-BENEFIT  PIC S9(9)V99      VALUE ZERO      CL**2
  6252                                     COMP-3.                         CL**2
  6253         16  CP-ALTERNATE-PREMIUM  PIC S9(7)V99      VALUE ZERO      CL**2
  6254                                     COMP-3.
  6255         16  CP-DDF-CSO-ADMIN-FEE REDEFINES CP-ALTERNATE-PREMIUM
  6256                                  PIC S9(7)V99 COMP-3.
  6257                                                                     CL**2
  6258         16  CP-PAID-FROM-DATE     PIC X(02).                        CL**2
  6259         16  CP-CLAIM-CALC-METHOD  PIC X(01).                        CL**2
  6260         16  CP-EXT-DAYS-CALC      PIC X.                            CL**2
  6261           88  CP-EXT-NO-CHG                   VALUE ' '.            CL**2
  6262           88  CP-EXT-CHG-LF                   VALUE '1'.            CL**2
  6263           88  CP-EXT-CHG-AH                   VALUE '2'.            CL**2
  6264           88  CP-EXT-CHG-LF-AH                VALUE '3'.            CL**2
  6265         16  CP-DOMICILE-STATE     PIC XX.                           CL**2
  6266         16  CP-CARRIER            PIC X.                            CL**2
  6267         16  CP-REIN-FLAG          PIC X.                            CL**2
  6268         16  CP-REM-TRM-CALC-OPTION PIC X.                           CL**2
  6269           88  VALID-REM-TRM-CALC-OPTION    VALUE '1'                CL**2
  6270                      '2' '3' '4' '5'.                               CL**2
  6271           88  CP-CALC-OPTION-DEFAULT       VALUE '4'.               CL**2
  6272           88  CP-CONSIDER-EXTENSION        VALUE '3' '4' '5'.       CL**2
  6273           88  CP-30-DAY-MONTH              VALUE '1' '3' '5'.       CL**2
  6274           88  CP-NO-EXT-30-DAY-MONTH       VALUE '1'.               CL**2
  6275           88  CP-NO-EXT-ACTUAL-DAYS        VALUE '2'.               CL**2
  6276           88  CP-EXT-30-DAY-MONTH          VALUE '3'.               CL**2
  6277           88  CP-EXT-ACTUAL-DAYS           VALUE '4'.               CL**2
  6278           88  CP-USE-EXP-AND-1ST-PMT       VALUE '5'.
  6279         16  CP-SIG-SWITCH         PIC X.                            CL**2
  6280         16  CP-RATING-METHOD      PIC X.                            CL**2
  6281           88  CP-RATE-AS-R78                      VALUE '1' 'R'.    CL**2
  6282           88  CP-RATE-AS-PRORATA                  VALUE '2' 'P'.    CL**2
  6283           88  CP-RATE-AS-CALIF                    VALUE '3' 'C'.    CL**2
  6284           88  CP-RATE-AS-TEXAS                    VALUE '4' 'T'.    CL**2
  6285           88  CP-RATE-AS-FARM-PLAN                VALUE '4' 'T'.    CL**2
  6286           88  CP-RATE-AS-NET-PAY                  VALUE '5' 'N'.    CL**2
  6287           88  CP-RATE-AS-ANTICIPATION             VALUE '6' 'A'.    CL**2
  6288           88  CP-RATE-AS-MEAN                     VALUE '8' 'M'.    CL**2
  6289           88  CP-RATE-AS-REG-BALLOON              VALUE 'B'.        CL**2
  6290         16  CP-SALES-TAX          PIC S9V9999     VALUE  ZEROS      CL**2
  6291                                     COMP-3.                         CL**2
  6292         16  CP-BEN-CATEGORY       PIC X.
  6293         16  CP-DCC-LF-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  6294         16  CP-DCC-ACT-COMM REDEFINES CP-DCC-LF-RATE
  6295                                   PIC S99V9(5) COMP-3.
  6296         16  CP-DCC-AH-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  6297         16  CP-DCC-PMF-COMM REDEFINES CP-DCC-AH-RATE
  6298                                   PIC S99V9(5) COMP-3.
  6299         16  CP-DAYS-TO-1ST-PMT    PIC S999     COMP-3 VALUE +0.
  6300         16  CP-AH-BALLOON-SW      PIC X  VALUE ' '.
  6301         16  CP-EXPIRE-DT          PIC XX.
  6302         16  CP-LF-CLAIM-CALC-SW   PIC X  VALUE ' '.
  6303         16  CP-DDF-HI-FACT        PIC S9V999   COMP-3 VALUE +0.
  6304         16  CP-DDF-LO-FACT        PIC S9V999   COMP-3 VALUE +0.
  6305         16  CP-DDF-CLP            PIC S9(5)V99 COMP-3 VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 124
* ECS010P.cbl (/apps/prod/cid1p/copy/ELCCALC)
  6306         16  CP-DDF-SPEC-CALC      PIC X.
  6307             88  CP-CALC-GROSS-FEE        VALUE 'G'.
  6308             88  CP-CALC-CLP              VALUE 'C'.
  6309         16  CP-IU-RATE-UP         PIC S9(5)V99   COMP-3 VALUE +0.
  6310         16  CP-CANCEL-REASON      PIC X.
  6311         16  CP-DDF-ADMIN-FEES     PIC S9(5)V99 COMP-3 VALUE +0.
  6312         16  CP-PMT-MODE           PIC X.
  6313         16  CP-NO-OF-PMTS         PIC S999 COMP-3 VALUE +0.
  6314         16  CP-1ST-YR-ALLOW       PIC S999V99 COMP-3 VALUE +0.
  6315         16  CP-DDF-COMM-AND-MFEE  PIC S9(5)V99 COMP-3 VALUE +0.
  6316         16  CP-DDF-YR1AF          PIC S9(5)V99 COMP-3 VALUE +0.
  6317         16  FILLER                PIC X.
  6318                                                                     CL**2
  6319***************    OUTPUT FROM ELRESV   ************************     CL**2
  6320                                                                     CL**2
  6321         16  CP-CDT-TABLE          PIC 9             VALUE ZERO.     CL**2
  6322                                                                     CL**2
  6323         16  CP-CDT-FACTOR         PIC S9(5)V9(6)    VALUE ZERO      CL**2
  6324                                     COMP-3.                         CL**2
  6325         16  CP-PTC-RESERVE        PIC S9(7)V99   VALUE ZERO         CL**2
  6326                                     COMP-3.                         CL**2
  6327         16  CP-IBNR-RESERVE       PIC S9(7)V99   VALUE ZERO         CL**2
  6328                                     COMP-3.                         CL**2
  6329         16  CP-FUTURE-RESERVE     PIC S9(7)V99   VALUE ZERO         CL**2
  6330                                     COMP-3.                         CL**2
  6331         16  FILLER                PIC X(09).                        CL**2
  6332***************    OUTPUT FROM ELRTRM   *************************    CL**2
  6333                                                                     CL**2
  6334         16  CP-REMAINING-TERM-1   PIC S9(4)V9    VALUE ZERO         CL**2
  6335                                     COMP-3.                         CL**2
  6336         16  CP-REMAINING-TERM-2   PIC S9(4)V9    VALUE ZERO         CL**2
  6337                                     COMP-3.                         CL**2
  6338         16  CP-REMAINING-TERM-3   PIC S9(4)V9    VALUE ZERO         CL**2
  6339                                     COMP-3.                         CL**2
  6340         16  CP-ODD-DAYS           PIC S9(3)      VALUE ZERO         CL**2
  6341                                     COMP-3.                         CL**2
  6342         16  FILLER                PIC X(12).                        CL**2
  6343                                                                     CL**2
  6344***************    OUTPUT FROM ELRAMT   *************************    CL**2
  6345                                                                     CL**2
  6346         16  CP-REMAINING-AMT      PIC S9(9)V99   VALUE ZERO         CL**2
  6347                                     COMP-3.                         CL**2
  6348         16  CP-REMAINING-AMT-PRV  PIC S9(9)V99   VALUE ZERO         CL**2
  6349                                     COMP-3.                         CL**2
  6350         16  FILLER                PIC X(12).                        CL**2
  6351                                                                     CL**2
  6352***************    OUTPUT FROM ELRATE   *************************    CL**2
  6353                                                                     CL**2
  6354         16  CP-CALC-PREMIUM       PIC S9(7)V99   VALUE ZERO         CL**2
  6355                                     COMP-3.                         CL**2
  6356         16  CP-PREMIUM-RATE       PIC S9(2)V9(5) VALUE ZERO         CL**2
  6357                                     COMP-3.                         CL**2
  6358         16  CP-MORTALITY-CODE     PIC X(4).                         CL**2
  6359         16  CP-RATE-EDIT-FLAG     PIC X.                            CL**2
  6360             88  CP-RATES-NEED-APR                  VALUE '1'.       CL**2
  6361         16  CP-COMPOSITE-RATE     PIC S99V999    VALUE ZERO         CL**2
  6362                                     COMP-3.                         CL**2
  6363         16  CP-POLICY-FEE         PIC S9(3)V99 VALUE +0 COMP-3.     CL**2
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 125
* ECS010P.cbl (/apps/prod/cid1p/copy/ELCCALC)
  6364         16  CP-LF-PREM            PIC S9(7)V99 VALUE +0 COMP-3.
  6365         16  CP-LF-BALLOON-PREM REDEFINES CP-LF-PREM
  6366                                   PIC S9(7)V99 COMP-3.
  6367         16  FILLER                PIC X(07).                        CL**2
  6368                                                                     CL**2
  6369***************    OUTPUT FROM ELRFND   *************************    CL**2
  6370                                                                     CL**2
  6371         16  CP-CALC-REFUND        PIC S9(7)V99   VALUE ZERO         CL**2
  6372                                     COMP-3.                         CL**2
  6373         16  CP-REFUND-TYPE-USED   PIC X.                            CL**2
  6374           88  CP-R-AS-R78                         VALUE '1'.        CL**2
  6375           88  CP-R-AS-PRORATA                     VALUE '2'.        CL**2
  6376           88  CP-R-AS-CALIF                       VALUE '3'.        CL**2
  6377           88  CP-R-AS-TEXAS                       VALUE '4'.        CL**2
  6378           88  CP-R-AS-FARM-PLAN                   VALUE '4'.        CL**2
  6379           88  CP-R-AS-NET-PAY                     VALUE '5'.        CL**2
  6380           88  CP-R-AS-ANTICIPATION                VALUE '6'.        CL**2
  6381           88  CP-R-AS-MEAN                        VALUE '8'.        CL**2
  6382           88  CP-R-AS-SUM-OF-DIGITS               VALUE '9'.        CL**2
  6383           88  CP-R-AS-GAP-NON-REFUND              VALUE 'G'.
  6384           88  CP-R-AS-GAP-ACTUARIAL               VALUE 'S'.
  6385           88  CP-R-AS-SPP-DDF                     VALUE 'D'.
  6386           88  CP-R-AS-SPP-DDF-IU                  VALUE 'I'.
  6387           88  CP-R-AS-REPOSSESSION                VALUE 'R'.
  6388         16  FILLER                PIC X(12).                        CL**2
  6389                                                                     CL**2
  6390***************    OUTPUT FROM ELEARN   *************************    CL**2
  6391                                                                     CL**2
  6392         16  CP-R78-U-PRM          PIC S9(7)V99   VALUE ZERO         CL**2
  6393                                     COMP-3.                         CL**2
  6394         16  CP-R78-U-PRM-ALT      PIC S9(7)V99   VALUE ZERO         CL**2
  6395                                     COMP-3.                         CL**2
  6396         16  CP-PRORATA-U-PRM      PIC S9(7)V99   VALUE ZERO         CL**2
  6397                                     COMP-3.                         CL**2
  6398         16  CP-PRORATA-U-PRM-ALT  PIC S9(7)V99   VALUE ZERO         CL**2
  6399                                     COMP-3.                         CL**2
  6400         16  CP-STATE-U-PRM        PIC S9(7)V99   VALUE ZERO         CL**2
  6401                                     COMP-3.                         CL**2
  6402         16  CP-DOMICILE-U-PRM     PIC S9(7)V99   VALUE ZERO         CL**2
  6403                                     COMP-3.                         CL**2
  6404         16  CP-EARNING-TYPE-USED  PIC X.                            CL**2
  6405           88  CP-E-AS-SPECIAL                     VALUE 'S'.        CL**2
  6406           88  CP-E-AS-R78                         VALUE '1'.        CL**2
  6407           88  CP-E-AS-PRORATA                     VALUE '2'.        CL**2
  6408           88  CP-E-AS-TEXAS                       VALUE '4'.        CL**2
  6409           88  CP-E-AS-FARM-PLAN                   VALUE '4'.        CL**2
  6410           88  CP-E-AS-NET-PAY                     VALUE '5'.        CL**2
  6411           88  CP-E-AS-ANTICIPATION                VALUE '6'.        CL**2
  6412           88  CP-E-AS-MEAN                        VALUE '8'.        CL**2
  6413           88  CP-E-AS-SUM-OF-DIGITS               VALUE '9'.        CL**2
  6414         16  FILLER                PIC X(12).                        CL**2
  6415                                                                     CL**2
  6416***************    OUTPUT FROM ELPMNT   *************************    CL**2
  6417                                                                     CL**2
  6418         16  CP-ACTUAL-DAYS        PIC S9(05)     VALUE ZERO         CL**2
  6419                                     COMP-3.                         CL**2
  6420         16  CP-CLAIM-PAYMENT      PIC S9(7)V99   VALUE ZERO         CL**2
  6421                                     COMP-3.                         CL**2
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 126
* ECS010P.cbl (/apps/prod/cid1p/copy/ELCCALC)
  6422         16  FILLER                PIC X(12).                        CL**2
  6423                                                                     CL**2
  6424***************   MISC WORK AREAS    *****************************   CL**2
  6425         16  CP-TOTAL-PAID         PIC S9(7)V99   VALUE ZERO         CL**2
  6426                                     COMP-3.                         CL**2
  6427         16  CP-R-MAX-ATT-AGE      PIC S9(3)      VALUE ZERO         CL**2
  6428                                     COMP-3.                         CL**2
  6429         16  CP-R-MAX-AGE          PIC S9(3)      VALUE ZERO         CL**2
  6430                                     COMP-3.                         CL**2
  6431         16  CP-R-MAX-TERM         PIC S9(5)      VALUE ZERO         CL**2
  6432                                     COMP-3.                         CL**2
  6433         16  CP-R-MAX-TOT-BEN      PIC S9(7)V99   VALUE ZERO         CL**2
  6434                                     COMP-3.                         CL**2
  6435         16  CP-R-MAX-MON-BEN      PIC S9(7)V99   VALUE ZERO         CL**2
  6436                                     COMP-3.                         CL**2
  6437         16  CP-IO-FUNCTION        PIC X          VALUE SPACE.       CL**2
  6438             88  OPEN-RATE-FILE                   VALUE 'O'.         CL**2
  6439             88  CLOSE-RATE-FILE                  VALUE 'C'.         CL**2
  6440             88  IO-ERROR                         VALUE 'E'.         CL**2
  6441                                                                     CL**2
  6442         16  CP-FIRST-PAY-DATE     PIC XX.                           CL**2
  6443                                                                     CL**2
  6444         16  CP-JOINT-INDICATOR    PIC X.                            CL**2
  6445                                                                     CL**2
  6446         16  CP-RESERVE-REMAINING-TERM                               CL**2
  6447                                   PIC S9(4)V9    VALUE ZERO         CL**2
  6448                                     COMP-3.                         CL**2
  6449                                                                     CL**2
  6450         16  CP-INSURED-BIRTH-DT   PIC XX.                           CL**2
  6451                                                                     CL**2
  6452         16  CP-INCURRED-AGE       PIC S9(3)      VALUE ZERO         CL**2
  6453                                     COMP-3.                         CL**2
  6454                                                                     CL**2
  6455         16  CP-MONTHLY-PAYMENT    PIC S9(5)V99   VALUE ZERO         CL**2
  6456                                     COMP-3.                         CL**2
  6457                                                                     CL**2
  6458         16  CP-RATING-BENEFIT-AMT PIC S9(9)V99   VALUE ZERO         CL**2
  6459                                     COMP-3.                         CL**2
  6460                                                                     CL**2
  6461         16  CP-ODD-DAYS-TO-PMT    PIC S9(3)      VALUE ZERO         CL**2
  6462                                     COMP-3.                         CL**2
  6463                                                                     CL**2
  6464         16  CP-MNTHS-TO-FIRST-PMT PIC S9(3)      VALUE ZERO         CL**2
  6465                                     COMP-3.                         CL**2
  6466                                                                     CL**2
  6467         16  CP-REMAMT-FACTOR      PIC S9(4)V9(9) VALUE ZEROS        CL**2
  6468                                     COMP-3.                         CL**2
  6469                                                                     CL**2
  6470         16  CP-FREE-LOOK          PIC S9(3)      VALUE ZERO         CL**2
  6471                                     COMP-3.                         CL**2
  6472                                                                     CL**2
  6473         16  CP-ROA-REFUND         PIC X          VALUE 'N'.         CL**2
  6474             88  CP-ROA-PREM-AT-REFUND            VALUE 'Y'.         CL**2
  6475                                                                     CL**2
  6476         16  CP-NET-BENEFIT-AMT    PIC S9(9)V99   VALUE ZERO         CL**2
  6477                                     COMP-3.                         CL**2
  6478         16  CP-SCNP-6MO-AMT       PIC S9(9)V99   VALUE ZERO
  6479                                     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 127
* ECS010P.cbl (/apps/prod/cid1p/copy/ELCCALC)
  6480         16  CP-MONTH              PIC S999     COMP-3 VALUE +0.
  6481         16  cp-extra-periods      pic 9 value zeros.
  6482         16  cp-net-only-state     pic x value spaces.
  6483         16  FILLER                PIC X(13).                        CL**2
  6484******************************************************************   CL**2
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 128
* ECS010P.cbl
* 6486                             COPY ELCDTECX.
  6487******************************************************************06/05/98
  6488*                                                                *ELCDTECX
  6489*                            ELCDTECX.                           *   LV005
  6490*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  6491*                            VMOD=2.015                          *ELCDTECX
  6492*                                                                *ELCDTECX
  6493*      WORKING STORAGE COPY CODE FOR APPLICATIONS CALLING        *ELCDTECX
  6494*      THE DATE CARD DISK FILE. ( READ ROUTINE = ELCDTERX,       *ELCDTECX
  6495*      AND DISK FILE FD = ELCDTEFX)                              *ELCDTECX
  6496*                                                                *ELCDTECX
  6497******************************************************************ELCDTECX
  6498******************************************************************
  6499*                   C H A N G E   L O G
  6500*
  6501* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6502*-----------------------------------------------------------------
  6503*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6504* EFFECTIVE    NUMBER
  6505*-----------------------------------------------------------------
  6506* 092602    2002091900008  PEMA  INCREASE NUMBER OF MAXIMUM
  6507*                                  BENEFIT CODES FROM 300 TO 900
  6508* 090803    2003080800002  PEMA  ADD CATEGORY FOR SUPER GAP
  6509* 051304    2003080800002  SMVA  ADD REFUND METHOD
  6510* 071714    2013100100002  PEMA  FIX CRIT PERIOD EDITS
  6511******************************************************************
  6512 01  DATE-CARD.                                                   ELCDTECX
  6513     12  DATX-COD                    PIC  X(4).                   ELCDTECX
  6514     12  RUN-DATE                    PIC  9(11)  COMP-3.          ELCDTECX
  6515     12  ALPH-DATE                   PIC  X(18).                  ELCDTECX
  6516     12  EP-DT                       PIC  9(11)  COMP-3.          ELCDTECX
  6517     12  PEND-ACT-FILE               PIC  XX.                     ELCDTECX
  6518     12  EP-SW                       PIC  X.                      ELCDTECX
  6519         88  NO-EP-EXTRACTS          VALUE SPACE.                 ELCDTECX
  6520     12  TAPE-BATCHES                PIC  X.                      ELCDTECX
  6521         88  TP-PREL-BAL             VALUE '1'.                   ELCDTECX
  6522     12  BIN-RUN-DATE                PIC  XX.                     ELCDTECX
  6523     12  RUN-CENTURY.                                             ELCDTECX
  6524         16 RUN-CENTURY-N            PIC  99.                        CL**4
  6525     12  FILLER                      PIC  X.                         CL**4
  6526     12  CLAS-MORT-OVRD              PIC  X(4).                   ELCDTECX
  6527     12  FILLER                      PIC  XXX.                    ELCDTECX
  6528     12  COMPANY-NAME                PIC  X(30).                  ELCDTECX
  6529                                                                  ELCDTECX
  6530 01  FILLER                          PIC  X(7)                       CL**6
  6531                                          VALUE 'OPTIONS'.        ELCDTECX
  6532 01  DATE-CARD-OPTIONS.                                           ELCDTECX
  6533     12  DATE-OPTIONS-ID             PIC  X(4).                   ELCDTECX
  6534     12  DTE-MIN-PREM                PIC  99V99.                  ELCDTECX
  6535     12  DTE-LANGUAGE-IND            PIC  X.                      ELCDTECX
  6536         88  DTE-LANGUAGE-IS-FR           VALUE 'F'.              ELCDTECX
  6537         88  DTE-LANGUAGE-IS-ENG          VALUE 'E'.              ELCDTECX
  6538     12  DTE-MIN-AGE                 PIC  99.                     ELCDTECX
  6539     12  DTE-DEFAULT-AGE             PIC  99.                     ELCDTECX
  6540     12  FILLER                      PIC  X.                      ELCDTECX
  6541     12  DTE-MAX-TERM                PIC  999.                    ELCDTECX
  6542     12  DTE-COMP-VG                 PIC  X.                      ELCDTECX
  6543     12  DTE-REM-TRM                 PIC  X.                      ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 129
* ECS010P.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  6544     12  DTE-PRM-CK                  PIC S99V99.                  ELCDTECX
  6545     12  DTE-PRORATA                 PIC  X.                      ELCDTECX
  6546     12  DTE-CLM-REJ                 PIC  X.                      ELCDTECX
  6547     12  DTE-REF-REJ                 PIC  X.                      ELCDTECX
  6548     12  DTE-COM-TBL-USED            PIC  X.                      ELCDTECX
  6549     12  FILLER                      PIC  X.                      ELCDTECX
  6550     12  DTE-QTR-CO                  PIC  X.                      ELCDTECX
  6551     12  DTE-REF-CK                  PIC S99V99.                  ELCDTECX
  6552     12  DTE-CLM-CK                  PIC S99V99.                  ELCDTECX
  6553     12  DTE-CONV-DT                 PIC 9(11) COMP-3.               CL**2
  6554     12  DTE-DEFAULT-SEX             PIC  X.                      ELCDTECX
  6555     12  DTE-EPL-FORMAT              PIC  X.                      ELCDTECX
  6556     12  FILLER                      PIC  X.                      ELCDTECX
  6557     12  DTE-JT-AGE                  PIC  X.                      ELCDTECX
  6558     12  DTE-KEY-BIRTH               PIC  X.                      ELCDTECX
  6559     12  DTE-REINSURANCE             PIC  X.                      ELCDTECX
  6560     12  DTE-CLAIM-SORT              PIC  X.                      ELCDTECX
  6561     12  DTE-WRT-OFF                 PIC  S99V99.                 ELCDTECX
  6562     12  DTE-R78                     PIC  X.                      ELCDTECX
  6563     12  DTE-DLY-BILL                PIC  X.                      ELCDTECX
  6564     12  DTE-ALT-MORT-CODE           PIC  X(4).                   ELCDTECX
  6565     12  DTE-CLAIM-PAID-THRU-TO      PIC  X.                      ELCDTECX
  6566     12  DTE-COMPENSATION-ACCESS     PIC  X.                      ELCDTECX
  6567     12  DTE-MORTG-ACCESS-CNTL       PIC  X.                      ELCDTECX
  6568     12  DTE-MP-ALT-MORT-CODE        PIC  X(4).                   ELCDTECX
  6569     12  DTE-MORTALITY-AGE-CALC-METHOD                            ELCDTECX
  6570                                     PIC  X.                      ELCDTECX
  6571         88  DTE-USE-TABLE-ASSIGNED-METHOD VALUE '1'              ELCDTECX
  6572                                                 ' '.             ELCDTECX
  6573         88  DTE-USE-ALL-AGE-LAST          VALUE '2'.             ELCDTECX
  6574         88  DTE-USE-ALL-AGE-NEAR          VALUE '3'.             ELCDTECX
  6575     12  DTE-RESERVE-OPTION-SWITCH   PIC  X.                      ELCDTECX
  6576         88  DTE-OPT-RESERVE-METHOD-AUTH       VALUE 'Y'.         ELCDTECX
  6577         88  DTE-OPT-RESERVE-METHOD-UNAUTH     VALUE 'N' ' '.     ELCDTECX
  6578     12  DTE-REM-TRM-CALC-OPTION     PIC  X.                      ELCDTECX
  6579     12  DTE-EXPERIENCE-RETENTION-AGE                             ELCDTECX
  6580                                     PIC  9.                         CL**4
  6581     12  DTE-SYSTEM.                                              ELCDTECX
  6582         16  DTE-SYS-A-CREDIT        PIC  X.                      ELCDTECX
  6583         16  DTE-SYS-B-PEND-CLAIM    PIC  X.                      ELCDTECX
  6584         16  DTE-SYS-C-CONFIRMATIONS PIC  X.                      ELCDTECX
  6585         16  DTE-SYS-D-DEMAND-BILL   PIC  X.                      ELCDTECX
  6586         16  DTE-SYS-E-CLASIC-CLAIMS PIC  X.                      ELCDTECX
  6587         16  DTE-SYS-F-CLASIC-CREDIT PIC  X.                      ELCDTECX
  6588         16  DTE-SYS-G-AR-USED       PIC  X.                      ELCDTECX
  6589         16  DTE-SYS-H               PIC  X.                      ELCDTECX
  6590         16  DTE-SYS-I               PIC  X.                      ELCDTECX
  6591         16  DTE-SYS-J               PIC  X.                      ELCDTECX
  6592         16  DTE-SYS-K               PIC  X.                      ELCDTECX
  6593         16  DTE-SYS-L               PIC  X.                      ELCDTECX
  6594         16  DTE-SYS-M               PIC  X.                      ELCDTECX
  6595         16  DTE-SYS-N               PIC  X.                      ELCDTECX
  6596         16  DTE-SYS-O               PIC  X.                      ELCDTECX
  6597         16  DTE-SYS-P               PIC  X.                      ELCDTECX
  6598         16  DTE-SYS-Q               PIC  X.                      ELCDTECX
  6599         16  DTE-SYS-R               PIC  X.                      ELCDTECX
  6600         16  DTE-SYS-S               PIC  X.                      ELCDTECX
  6601         16  DTE-SYS-T               PIC  X.                      ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 130
* ECS010P.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  6602         16  DTE-SYS-U               PIC  X.                      ELCDTECX
  6603         16  DTE-SYS-V               PIC  X.                      ELCDTECX
  6604         16  DTE-SYS-W               PIC  X.                      ELCDTECX
  6605         16  DTE-SYS-X               PIC  X.                      ELCDTECX
  6606         16  DTE-SYS-Y               PIC  X.                      ELCDTECX
  6607         16  DTE-SYS-Z               PIC  X.                      ELCDTECX
  6608     12  FILLER                      REDEFINES DTE-SYSTEM.        ELCDTECX
  6609         16  DTE-SYS-CODE            OCCURS 26 TIMES              ELCDTECX
  6610                                     PIC  X.                      ELCDTECX
  6611     12  DTE-CLIENT                  PIC  XXX.                    ELCDTECX
  6612                                                                  ELCDTECX
  6613 01  CLASIC-SYSTEM-CODES.                                         ELCDTECX
  6614     12  DTE-COLC-ID                 PIC  X(4).                   ELCDTECX
  6615     12  DTE-CLASIC-COMPANY-CD       PIC  X.                      ELCDTECX
  6616     12  DTE-CLASIC-COMPANY-NUMBER   PIC  999.                    ELCDTECX
  6617*    12  DTE-CLASIC-CLAIM-ACCESS     PIC  X.                      ELCDTECX
  6618     12  FILLER                      PIC  X.                      ELCDTECX
  6619     12  CLASIC-REIN-MAINT           PIC  XX.                     ELCDTECX
  6620     12  CLASIC-COMP-MAINT           PIC  XX.                     ELCDTECX
  6621     12  CLASIC-ACCT-MAINT           PIC  XX.                     ELCDTECX
  6622     12  CLASIC-CTBL-MAINT           PIC  XX.                     ELCDTECX
  6623     12  CLASIC-RATE-MAINT           PIC  XX.                     ELCDTECX
  6624     12  CLASIC-CREDIT-EOM-DT        PIC  XX.                     ELCDTECX
  6625     12  CLASIC-CLAIMS-EOM-DT        PIC  XX.                     ELCDTECX
  6626                                                                  ELCDTECX
  6627     12  LIFE-OVERRIDE-L1            PIC  X.                      ELCDTECX
  6628     12  LIFE-OVERRIDE-L2            PIC  XX.                     ELCDTECX
  6629     12  LIFE-OVERRIDE-L6            PIC  X(6).                   ELCDTECX
  6630     12  LIFE-OVERRIDE-L12           PIC  X(12).                  ELCDTECX
  6631                                                                  ELCDTECX
  6632     12  AH-OVERRIDE-L1              PIC  X.                      ELCDTECX
  6633     12  AH-OVERRIDE-L2              PIC  XX.                     ELCDTECX
  6634     12  AH-OVERRIDE-L6              PIC  X(6).                   ELCDTECX
  6635     12  AH-OVERRIDE-L12             PIC  X(12).                  ELCDTECX
  6636                                                                  ELCDTECX
  6637     12  CLAS-REPORT-CD1-CAPTION     PIC  X(10).                  ELCDTECX
  6638     12  CLAS-REPORT-CD2-CAPTION     PIC  X(10).                  ELCDTECX
  6639                                                                  ELCDTECX
  6640     12  CLASIC-MORTG-EOM-DT         PIC  XX.                     ELCDTECX
  6641     12  CLASIC-AR-EOM-DT            PIC  XX.                     ELCDTECX
  6642                                                                  ELCDTECX
  6643     12  FILLER                      PIC  X(11)      VALUE SPACE. ELCDTECX
  6644                                                                  ELCDTECX
  6645 01  DATE-CARD-FACTORS.                                           ELCDTECX
  6646     12  DATE-FACTOR-ID              PIC  X(4).                   ELCDTECX
  6647     12  FAC-1                       PIC S999V9(5).               ELCDTECX
  6648     12  FAC-2                       PIC S999V9(5).               ELCDTECX
  6649     12  FAC-3                       PIC S999V9(5).               ELCDTECX
  6650     12  FAC-4                       PIC S999V9(5).               ELCDTECX
  6651     12  FAC-5                       PIC S999V9(5).               ELCDTECX
  6652     12  FAC-6                       PIC S999V9(5).               ELCDTECX
  6653                                                                  ELCDTECX
  6654 01  FILLER                          PIC  X(12)                   ELCDTECX
  6655                                          VALUE 'COMPANY NAME'.   ELCDTECX
  6656 01  COMPANY-NAME-TABLE.                                          ELCDTECX
  6657     12  C-N-TBL                     OCCURS 6 TIMES.              ELCDTECX
  6658         16  CNT-ID                  PIC  X.                      ELCDTECX
  6659         16  CNT-NAME                PIC  X(30).                  ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 131
* ECS010P.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  6660                                                                  ELCDTECX
  6661 01  FILLER                          PIC  X(11)                   ELCDTECX
  6662                                          VALUE 'STATE NAMES'.    ELCDTECX
  6663 01  STATE-NAMES.                                                 ELCDTECX
  6664     12  STATE-NAME-FLD              OCCURS 75 TIMES.             ELCDTECX
  6665         16  STATE-SUB               PIC  XX.                     ELCDTECX
  6666         16  STATE-PIC1.                                          ELCDTECX
  6667             20  STATE-ABBR          PIC  XX.                     ELCDTECX
  6668             20  FILLER              PIC  XXX.                    ELCDTECX
  6669             20  STATE-PIC           PIC  X(20).                  ELCDTECX
  6670             20  STATE-CALL-EARN     PIC  X.                      ELCDTECX
  6671             20  STATE-CALL-BREAK    PIC  X.                      ELCDTECX
  6672             20  STATE-PRIM-FAC-DEV  PIC  XXX.                    ELCDTECX
  6673                                                                  ELCDTECX
  6674 01  FILLER                          PIC  X(13)                   ELCDTECX
  6675                                          VALUE 'CARRIER NAMES'.  ELCDTECX
  6676 01  CARRIER-NAMES.                                               ELCDTECX
  6677     12  CARRIER-NAME-FLD            OCCURS 25 TIMES.             ELCDTECX
  6678         16  CARRIER-SUB             PIC  X.                      ELCDTECX
  6679         16  CARRIER-DOM-ST          PIC  XX.                     ELCDTECX
  6680         16  CARRIER-PIC             PIC  X(30).                  ELCDTECX
  6681         16  CARRIER-UEP-PCT         PIC  S9V9(4) COMP-3.            CL**6
  6682         16  CARRIER-R78-PCT         PIC  S9V9(4) COMP-3.            CL**6
  6683         16  CARRIER-PRO-PCT         PIC  S9V9(4) COMP-3.            CL**6
  6684*        16  FILLER                  PIC  X.                      ELCDTECX
  6685         16  CARRIER-SEC-PAY         PIC  X.
  6686             88  SEC-PAY-CARRIER          VALUE 'Y'.
  6687                                                                  ELCDTECX
  6688 01  FILLER                          PIC  X(9)                       CL**6
  6689                                          VALUE 'INS TYPES'.      ELCDTECX
  6690 01  CLAS-INS-TYPES.                                              ELCDTECX
  6691*    12 CLAS-ALL-TYPES               OCCURS 300 TIMES.            ELCDTECX
  6692     12 CLAS-ALL-TYPES               OCCURS 900 TIMES.            ELCDTECX
  6693         16  CLAS-I-BEN              PIC  XX.                     ELCDTECX
  6694         16  CLAS-I-AB3.                                          ELCDTECX
  6695             20  FILLER              PIC  X.                      ELCDTECX
  6696             20  CLAS-I-AB2.                                      ELCDTECX
  6697                 24  FILLER          PIC  X.                      ELCDTECX
  6698                 24  CLAS-I-AB1      PIC  X.                      ELCDTECX
  6699         16  CLAS-I-AB3-AH REDEFINES CLAS-I-AB3.                  ELCDTECX
  6700             20  CLAS-EXCLUSION      PIC  XX.                        CL**4
  6701             20  FILLER              PIC  X.                         CL**4
  6702         16  CLAS-I-AB10.                                         ELCDTECX
  6703             20  FILLER              PIC  X(9).                   ELCDTECX
  6704             20  CLAS-I-REIN-YN      PIC  X.                      ELCDTECX
  6705         16  CLAS-I-COMMENT          PIC  X(10).                  ELCDTECX
  6706         16  CLAS-I-JOINT            PIC  X.                      ELCDTECX
  6707         16  CLAS-I-RL-AH            PIC  X.                      ELCDTECX
  6708         16  CLAS-I-CALC-TYPE.                                    ELCDTECX
  6709             20  CLAS-I-BAL          PIC  X.                      ELCDTECX
  6710         16  CLAS-I-EP               PIC  X.                      ELCDTECX
  6711         16  CLAS-CO-BEN-I-G-CD      PIC  X.                      ELCDTECX
  6712         16  CLAS-CO-REM-TERM-CALC   PIC  X.                      ELCDTECX
  6713         16  CLAS-I-BEN-CATEGORY     PIC  X.
  6714         16  CLAS-I-REFUND-METHOD    PIC  X.
  6715         16  CLAS-I-MAX-BENEFITS     PIC 99.
  6716         16  FILLER                  PIC  XXX.
  6717                                                                  ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 132
* ECS010P.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  6718 01  FILLER                          PIC  X(16)                   ELCDTECX
  6719                                     VALUE 'MORTALITY TABLES'.    ELCDTECX
  6720 01  CLAS-MORTALITY-CODES.                                        ELCDTECX
  6721     12  CLAS-MORT-FLD               OCCURS 99 TIMES              ELCDTECX
  6722                                     INDEXED BY CLAS-MORT-NDX.    ELCDTECX
  6723         16  CLAS-MORT-CODE          PIC  X(4).                      CL**6
  6724         16  CLAS-MORT-J-CODE        PIC  X.                         CL**5
  6725         16  CLAS-MORT-J-FACT        PIC S9V9(4).                    CL**6
  6726         16  CLAS-MORT-DESC.                                      ELCDTECX
  6727             20  CLAS-RESERVE-ADJ    PIC  999.                       CL**6
  6728             20  FILLER              PIC  XX.                        CL**5
  6729             20  CLAS-YEAR           PIC  X(4).                      CL**6
  6730             20  FILLER              PIC  X.                         CL**5
  6731             20  CLAS-TABLE-TYPE     PIC  XXX.                       CL**6
  6732             20  FILLER              PIC  X.                         CL**5
  6733             20  CLAS-AGE-METHOD     PIC  XX.                        CL**5
  6734             20  FILLER              PIC  X.                         CL**5
  6735             20  CLAS-INTEREST       PIC  99.99.                     CL**5
  6736             20  FILLER              PIC  X(5).                      CL**6
  6737                                                                  ELCDTECX
  6738 01  FILLER                          PIC  X(15)                   ELCDTECX
  6739                                     VALUE 'BUSINESS TABLES'.     ELCDTECX
  6740 01  CLAS-BUSINESS-CLASSES.                                       ELCDTECX
  6741     12  CLAS-BUSC-FLD               OCCURS 50 TIMES.             ELCDTECX
  6742         16  CLAS-BUSC-CODE          PIC  99.                     ELCDTECX
  6743         16  CLAS-BUSC-GROUP         PIC  X.                      ELCDTECX
  6744         16  CLAS-BUSC-DESC          PIC  X(19).                  ELCDTECX
  6745         16  CLAS-BUSC-EXCL          PIC  X.                         CL**5
  6746         16  FILLER                  PIC  X(4).                      CL**6
  6747                                                                  ELCDTECX
  6748 01  FILLER                          PIC  X(7)                       CL**6
  6749                                     VALUE 'INDEXES'.             ELCDTECX
  6750 01  CLAS-INDEX-TBL.                                              ELCDTECX
  6751     12  CLAX-ID                     PIC  X(4).                   ELCDTECX
  6752     12  CLAS-STARTC                 PIC S9(4) COMP.              ELCDTECX
  6753     12  CLAS-MAXC                   PIC S9(4) COMP.              ELCDTECX
  6754     12  CLAS-STARTL                 PIC S9(4) COMP.              ELCDTECX
  6755     12  CLAS-MAXL                   PIC S9(4) COMP.              ELCDTECX
  6756     12  CLAS-STARTA                 PIC S9(4) COMP.              ELCDTECX
  6757     12  CLAS-MAXA                   PIC S9(4) COMP.              ELCDTECX
  6758     12  CLAS-STARTM                 PIC S9(4) COMP.              ELCDTECX
  6759     12  CLAS-MAXM                   PIC S9(4) COMP.              ELCDTECX
  6760     12  CLAS-STARTB                 PIC S9(4) COMP.              ELCDTECX
  6761     12  CLAS-MAXB                   PIC S9(4) COMP.              ELCDTECX
  6762     12  CLAS-STARTS                 PIC S9(4) COMP.              ELCDTECX
  6763     12  CLAS-MAXS                   PIC S9(4) COMP.              ELCDTECX
  6764     12  CLAS-STARTE                 PIC S9(4) COMP.              ELCDTECX
  6765     12  CLAS-MAXE                   PIC S9(4) COMP.              ELCDTECX
  6766     12  CLAS-STARTCN                PIC S9(4) COMP.              ELCDTECX
  6767     12  CLAS-MAXCN                  PIC S9(4) COMP.              ELCDTECX
  6768                                                                  ELCDTECX
  6769 01  CLAS-TYPE-MISC.                                              ELCDTECX
  6770     12  CLAS-INDEXC                 PIC S9(4) COMP.              ELCDTECX
  6771     12  CLAS-INDEXL                 PIC S9(4) COMP.              ELCDTECX
  6772     12  CLAS-INDEXA                 PIC S9(4) COMP.              ELCDTECX
  6773     12  CLAS-INDEXM                 PIC S9(4) COMP.              ELCDTECX
  6774     12  CLAS-INDEXB                 PIC S9(4) COMP.              ELCDTECX
  6775     12  CLAS-INDEXS                 PIC S9(4) COMP.              ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 133
* ECS010P.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  6776     12  CLAS-INDEXE                 PIC S9(4) COMP.              ELCDTECX
  6777     12  CLAS-INDEX                  PIC S9(4) COMP.              ELCDTECX
  6778     12  CLAS-INDEXEN                PIC S9(4) COMP.              ELCDTECX
  6779     12  CLAS-INDEXCN                PIC S9(4) COMP.              ELCDTECX
  6780     12  CLAS-INDEXON                PIC S9(4) COMP.              ELCDTECX
  6781                                                                  ELCDTECX
  6782 01  FILLER                          PIC  X(13)                   ELCDTECX
  6783                                     VALUE 'MISCELLANEOUS'.       ELCDTECX
  6784 01  CLAS-MISC.                                                   ELCDTECX
  6785     12  DTE-FICH                    PIC  X.                      ELCDTECX
  6786         88  FICH-NO                 VALUE SPACE.                 ELCDTECX
  6787         88  FICH-ONLY               VALUE '1'.                   ELCDTECX
  6788         88  FICH-BOTH               VALUE '2'.                   ELCDTECX
  6789     12  FICH-OPEN                   PIC  X.                      ELCDTECX
  6790     12  REPT-OPEN                   PIC  X.                      ELCDTECX
  6791     12  DTE-PGM-OPT                 PIC  9.                         CL**5
  6792     12  DTE-PRT-OPT                 PIC  X.                      ELCDTECX
  6793     12  DTE-FMT-OPT                 PIC  9.                      ELCDTECX
  6794     12  DTE-PRC-OPT                 PIC  9.                      ELCDTECX
  6795     12  DTE-TOT-OPT                 PIC  9.                      ELCDTECX
  6796     12  CLAS-LOOK                   PIC  XX.                     ELCDTECX
  6797     12  DTE-TOT-LINES               PIC S9(8)      COMP.         ELCDTECX
  6798     12  STATE-L                     PIC  XX.                     ELCDTECX
  6799     12  CLAS-CN                     PIC  99.                     ELCDTECX
  6800     12  CLAS-CO                     PIC  99.                     ELCDTECX
  6801     12  DTE-VSAM-FLAGS                              VALUE ZERO.  ELCDTECX
  6802         16  DTE-F-1                 PIC  X.                      ELCDTECX
  6803         16  DTE-F-2                 PIC  X.                      ELCDTECX
  6804     12  DTE-ABEND-WORK.                                          ELCDTECX
  6805         16  DTE-ABEND-CD-1          PIC  XX         VALUE SPACES.ELCDTECX
  6806         16  DTE-ABEND-CD-2          PIC  XX         VALUE SPACES.ELCDTECX
  6807                                                                  ELCDTECX
  6808 01  FILLER                          PIC  X(12)                   ELCDTECX
  6809                                     VALUE 'WORKING DATE'.        ELCDTECX
  6810 01  WS-DATE-AND-TIME.                                            ELCDTECX
  6811     12  WS-ACCEPT-DATE.                                          ELCDTECX
  6812         16  WS-AD-YY                PIC  99.                     ELCDTECX
  6813         16  WS-AD-MM                PIC  99.                     ELCDTECX
  6814         16  WS-AD-DD                PIC  99.                     ELCDTECX
  6815     12  WS-CURRENT-DATE.                                         ELCDTECX
  6816         16  WS-CD-MM                PIC  99.                     ELCDTECX
  6817         16  FILLER                  PIC  X          VALUE '/'.   ELCDTECX
  6818         16  WS-CD-DD                PIC  99.                     ELCDTECX
  6819         16  FILLER                  PIC  X          VALUE '/'.   ELCDTECX
  6820         16  WS-CD-YY                PIC  99.                     ELCDTECX
  6821     12  WS-TIME-OF-DAY.                                          ELCDTECX
  6822         16  WS-TIME                 PIC  9(6).                   ELCDTECX
  6823         16  WS-HUN-SEC              PIC  99.                     ELCDTECX
  6824                                                                  ELCDTECX
  6825 01  FILLER                          PIC  X(12)                   ELCDTECX
  6826                                     VALUE 'CARRIER CLMS'.        ELCDTECX
  6827 01  CARRIER-OPT-CLAIM-DATA.                                      ELCDTECX
  6828     12  CARRIER-FLDS                OCCURS 25 TIMES.             ELCDTECX
  6829         16  CARRIER-IBNR-SWITCH     PIC  X.                         CL**5
  6830         16  CARRIER-IBNR-PERCENT    PIC S9V9(4) COMP-3.             CL**6
  6831         16  CARRIER-CIDA-DISCOUNT   PIC S9V9(4) COMP-3.             CL**6
  6832                                                                  ELCDTECX
  6833 01  FILLER                          PIC  X(10)                   ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 134
* ECS010P.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  6834                                     VALUE 'STATE TLRS'.          ELCDTECX
  6835 01  STATE-TARGET-LOSS-RATIOS.                                    ELCDTECX
  6836     12  STATE-TLR-FLD               OCCURS 75 TIMES.             ELCDTECX
  6837         16  STATE-TARGET-LOSS-RATIO PIC S9V9(4) COMP-3.             CL**6
  6838         16  STATE-CALC-INTEREST     PIC S9V9(4) COMP-3.             CL**6
  6839                                                                  ELCDTECX
  6840 01  FILLER                          PIC  X(13)                   ELCDTECX
  6841                                     VALUE 'BUSINESS TLRS'.       ELCDTECX
  6842 01  BUSINESS-TRGT-LOSS-RATIO-MODS.                               ELCDTECX
  6843     12  BUS-TLRM-FLD                OCCURS 99 TIMES.             ELCDTECX
  6844         16  BUS-TRGT-LOSS-RATIO-MOD PIC S9V9(4) COMP-3.             CL**6
  6845                                                                  ELCDTECX
  6846 01  FILLER                          PIC  X(13)                   ELCDTECX
  6847                                     VALUE 'MISC CLM DATA'.       ELCDTECX
  6848 01  MISC-OPT-CLM-RSV-DATA.                                       ELCDTECX
  6849     12  COMPANY-CALC-INTEREST       PIC S9V9(4) COMP-3.             CL**6
  6850     12  COMPANY-CIDA-DISCOUNT       PIC S9V9(4) COMP-3.             CL**6
  6851     12  COMPANY-CRDB-TABLE-SELECTION                             ELCDTECX
  6852                                     PIC  X.                         CL**5
  6853     12  COMPANY-IBNR-AH-FACTOR      PIC S9V9(4) COMP-3.             CL**6
  6854     12  COMPANY-IBNR-LAG-MONTH      PIC S999    COMP-3.             CL**6
  6855     12  COMPANY-IBNR-LIFE-FACTOR    PIC S9V9(4) COMP-3.             CL**6
  6856     12  COMPANY-OPTION-START-DATE   PIC  XX.                        CL**5
  6857     12  INDEXBS                     PIC S9(4)   COMP.               CL**6
  6858     12  INDEXCA                     PIC S9(4)   COMP.               CL**6
  6859     12  INDEXST                     PIC S9(4)   COMP.               CL**6
  6860     12  FILLER                      PIC  X(75).                  ELCDTECX
  6861******************************************************************ELCDTECX
  6862*01  MISC-CARR-PCT-DATA.                                          00001521
  6863*    12  DD-CARR1-UEP-PCT            PIC S9V9(4) COMP-3.          00001522
  6864*    12  DD-CARR1-R78-PCT            PIC S9V9(4) COMP-3.          00001522
  6865*    12  DD-CARR1-PRO-PCT            PIC S9V9(4) COMP-3.          00001522
  6866*    12  DD-CARR2-UEP-PCT            PIC S9V9(4) COMP-3.          00001522
  6867*    12  DD-CARR2-R78-PCT            PIC S9V9(4) COMP-3.          00001522
  6868*    12  DD-CARR2-PRO-PCT            PIC S9V9(4) COMP-3.          00001522
  6869******************************************************************ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 135
* ECS010P.cbl
* 6871                             COPY ELCDTEVR.
  6872***************************************************************** 04/15/98
  6873*                                                                *ELCDTEVR
  6874*                                                                *ELCDTEVR
  6875*                            ELCDTEVR.                           *   LV003
  6876*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
  6877*                            VMOD=2.001                          *   CL**2
  6878*                                                                *ELCDTEVR
  6879*   WORKING STORAGE FOR DATE VARIABLES CREATED                   *ELCDTEVR
  6880*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCDTEVR
  6881*                                                                *ELCDTEVR
  6882******************************************************************ELCDTEVR
  6883 01  WS-DATE-CARD-DATE.                                           ELCDTEVR
  6884     05  WS-RUN-DATE.                                             ELCDTEVR
  6885         10  FILLER                  PIC  9(03).                  ELCDTEVR
  6886         10  RUN-CCYY                PIC  9(04).                  ELCDTEVR
  6887         10  RUN-CCYR  REDEFINES  RUN-CCYY.                       ELCDTEVR
  6888             15  RUN-CC              PIC  99.                     ELCDTEVR
  6889             15  RUN-YR              PIC  99.                     ELCDTEVR
  6890         10  RUN-MO                  PIC  99.                     ELCDTEVR
  6891         10  RUN-DA                  PIC  99.                     ELCDTEVR
  6892     05  WS-RUN-DATE-N REDEFINES                                     CL**2
  6893            WS-RUN-DATE              PIC 9(11).                      CL**2
  6894     05  WS-EP-DT.                                                ELCDTEVR
  6895         10  FILLER                  PIC  9(03).                  ELCDTEVR
  6896         10  EP-CCYY                 PIC  9(04).                  ELCDTEVR
  6897         10  EP-CCYR  REDEFINES  EP-CCYY.                         ELCDTEVR
  6898             15  EP-CC               PIC  99.                     ELCDTEVR
  6899             15  EP-YR               PIC  99.                     ELCDTEVR
  6900         10  EP-MO                   PIC  99.                     ELCDTEVR
  6901         10  EP-DA                   PIC  99.                     ELCDTEVR
  6902     05  WS-EP-DT-N REDEFINES                                        CL**2
  6903            WS-EP-DT                 PIC 9(11).                      CL**2
  6904     05  WS-DTE-CONV-DT.                                             CL**4
  6905         10  FILLER                  PIC  9(03).                     CL**4
  6906         10  DTE-CONV-CCYY           PIC  9(04).                     CL**4
  6907         10  DTE-CONV-CCYR  REDEFINES  DTE-CONV-CCYY.                CL**4
  6908             15  DTE-CONV-CC         PIC  99.                        CL**4
  6909             15  DTE-CONV-YR         PIC  99.                        CL**4
  6910         10  DTE-CONV-MO             PIC  99.                        CL**4
  6911         10  DTE-CONV-DA             PIC  99.                        CL**4
  6912     05  WS-DTE-CONV-DT-N REDEFINES                                  CL**4
  6913            WS-DTE-CONV-DT           PIC  9(11).                     CL**4
  6914 01  WS-BALANCE-FORWARD-DATE.                                     ELCDTEVR
  6915     05  WS-BF-LAST-ACTIVITY-DATE.                                ELCDTEVR
  6916         10  FILLER                            PIC 999.           ELCDTEVR
  6917         10  BF-ACT-CCYY                       PIC 9(04).         ELCDTEVR
  6918         10  BF-ACT-CCYR  REDEFINES  BF-ACT-CCYY.                 ELCDTEVR
  6919             15  BF-ACT-CC                     PIC 99.            ELCDTEVR
  6920             15  BF-ACT-YEAR                   PIC 99.            ELCDTEVR
  6921         10  BF-ACT-MONTH                      PIC 99.            ELCDTEVR
  6922         10  BF-ACT-DAY                        PIC 99.            ELCDTEVR
  6923     05  WS-BF-LAST-ACTIVITY-DATE-N REDEFINES                        CL**2
  6924            WS-BF-LAST-ACTIVITY-DATE           PIC 9(11).            CL**2
  6925     05  WS-BF-CURRENT-LAST-STMT-DT.                              ELCDTEVR
  6926         10  FILLER                            PIC 999.           ELCDTEVR
  6927         10  BF-CURRENT-LAST-STMT-CEN          PIC 99.            ELCDTEVR
  6928         10  BF-CURRENT-LAST-STMT-YEAR         PIC 99.            ELCDTEVR
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 136
* ECS010P.cbl (/apps/prod/cid1p/copy/ELCDTEVR)
  6929         10  BF-CURRENT-LAST-STMT-MONTH        PIC 99.            ELCDTEVR
  6930         10  BF-CURRENT-LAST-STMT-DAY          PIC 99.            ELCDTEVR
  6931     05  WS-BF-CURRENT-LAST-STMT-DT-N REDEFINES                      CL**2
  6932            WS-BF-CURRENT-LAST-STMT-DT        PIC 9(11).             CL**2
  6933 01  WS-ADD-CONF-TRANSACTIONS-DTE.                                ELCDTEVR
  6934     05  WS-AC-CERT-EFF-DATE.                                     ELCDTEVR
  6935         10  FILLER                            PIC 999.           ELCDTEVR
  6936         10  AC-CERT-CCYY                      PIC 9(04).         ELCDTEVR
  6937         10  AC-CERT-CCYR  REDEFINES  AC-CERT-CCYY.               ELCDTEVR
  6938             15  AC-CERT-CC                    PIC 99.            ELCDTEVR
  6939             15  AC-CERT-YR                    PIC 99.            ELCDTEVR
  6940         10  AC-CERT-MO                        PIC 99.            ELCDTEVR
  6941         10  AC-CERT-DA                        PIC 99.            ELCDTEVR
  6942     05  WS-AC-CERT-EFF-DATE-N REDEFINES                             CL**2
  6943            WS-AC-CERT-EFF-DATE                PIC 9(11).            CL**2
  6944     05  WS-AC-LIFE-CANCEL-DATE.                                  ELCDTEVR
  6945         10  FILLER                            PIC 999.           ELCDTEVR
  6946         10  AC-LIFE-CANCEL-CCYY               PIC 9(04).         ELCDTEVR
  6947         10  AC-LIFE-CANCEL-CCYR REDEFINES AC-LIFE-CANCEL-CCYY.   ELCDTEVR
  6948             15  AC-LIFE-CANCEL-CC             PIC 99.            ELCDTEVR
  6949             15  AC-LIFE-CANCEL-YR             PIC 99.            ELCDTEVR
  6950         10  AC-LIFE-CANCEL-MO                 PIC 99.            ELCDTEVR
  6951         10  AC-LIFE-CANCEL-DA                 PIC 99.            ELCDTEVR
  6952     05  WS-AC-LIFE-CANCEL-DATE-N REDEFINES                          CL**2
  6953            WS-AC-LIFE-CANCEL-DATE             PIC 9(11).            CL**2
  6954     05  WS-AC-AH-CANCEL-DATE.                                    ELCDTEVR
  6955         10  FILLER                            PIC 999.           ELCDTEVR
  6956         10  AC-AH-CANCEL-CCYY                 PIC 9(04).         ELCDTEVR
  6957         10  AC-AH-CANCEL-CCYR  REDEFINES  AC-AH-CANCEL-CCYY.     ELCDTEVR
  6958             15  AC-AH-CANCEL-CC               PIC 99.            ELCDTEVR
  6959             15  AC-AH-CANCEL-YR               PIC 99.            ELCDTEVR
  6960         10  AC-AH-CANCEL-MO                   PIC 99.            ELCDTEVR
  6961         10  AC-AH-CANCEL-DA                   PIC 99.            ELCDTEVR
  6962     05  WS-AC-AH-CANCEL-DATE-N REDEFINES                            CL**2
  6963            WS-AC-AH-CANCEL-DATE               PIC 9(11).            CL**2
  6964 01  WS-RATE-RECORD.                                              ELCDTEVR
  6965         05  WS-RT-EXPIRY-DATE.                                   ELCDTEVR
  6966             10  FILLER                        PIC 999.           ELCDTEVR
  6967             10  RT-EXP-CCYY                   PIC 9(04).         ELCDTEVR
  6968             10  RT-EXP-CCYR  REDEFINES  RT-EXP-CCYY.             ELCDTEVR
  6969                 15  RT-EXP-CC                 PIC 99.            ELCDTEVR
  6970                 15  RT-EXP-YR                 PIC 99.            ELCDTEVR
  6971             10  RT-EXP-MO                     PIC 99.            ELCDTEVR
  6972             10  RT-EXP-DA                     PIC 99.            ELCDTEVR
  6973         05  WS-RT-EXPIRY-DATE-N REDEFINES                           CL**2
  6974                WS-RT-EXPIRY-DATE              PIC 9(11).            CL**2
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 137
* ECS010P.cbl
* 6976                             COPY ELCACCTV.
  6977******************************************************************04/14/98
  6978*                                                                *ELCACCTV
  6979*                            ELCACCTV                            *   LV002
  6980*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  6981*                            VMOD=2.001                          *ELCACCTV
  6982*                                                                *ELCACCTV
  6983*   WORKING STORAGE FOR DATE VARIABLES CREATED                   *ELCACCTV
  6984*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCACCTV
  6985*                                                                *ELCACCTV
  6986*  NO  CID  MODS  IN  COPYBOOK  ELCACCTV                         *ELCACCTV
  6987*                                                                *ELCACCTV
  6988******************************************************************ELCACCTV
  6989                                                                  ELCACCTV
  6990 01  WS-ACCOUNT-MASTER-DATE.                                      ELCACCTV
  6991                                                                  ELCACCTV
  6992     05  WS-AM-EXPIRE-DT.                                         ELCACCTV
  6993         10  FILLER            PIC 999.                           ELCACCTV
  6994         10  AM-EXP-CCYY       PIC 9(04).                         ELCACCTV
  6995         10  AM-EXP-CCYR  REDEFINES  AM-EXP-CCYY.                 ELCACCTV
  6996             15  AM-EXP-CC     PIC 99.                            ELCACCTV
  6997             15  AM-EXP-YR     PIC 99.                            ELCACCTV
  6998         10  AM-EXP-MO         PIC 99.                               CL**5
  6999         10  AM-EXP-DA         PIC 99.                               CL**5
  7000     05  WS-AM-EXPIRE-DT-N REDEFINES                                 CL**3
  7001            WS-AM-EXPIRE-DT    PIC 9(11).                            CL**4
  7002     05  WS-AM-VG-EXP-DATE.                                       ELCACCTV
  7003         10  FILLER                    PIC 999.                   ELCACCTV
  7004         10  AM-VG-EXP-CCYY            PIC 9(04).                 ELCACCTV
  7005         10  AM-VG-EXP-CCYR  REDEFINES  AM-VG-EXP-CCYY.           ELCACCTV
  7006             15  AM-VG-EXP-CC          PIC 99.                    ELCACCTV
  7007             15  AM-VG-EXP-YR          PIC 99.                    ELCACCTV
  7008         10  AM-VG-EXP-MO              PIC 99.                    ELCACCTV
  7009         10  AM-VG-EXP-DA              PIC 99.                    ELCACCTV
  7010     05  WS-AM-VG-EXP-DATE-N REDEFINES                               CL**3
  7011            WS-AM-VG-EXP-DATE          PIC 9(11).                    CL**4
  7012     05  WS-AM-EFFECT-DT.                                         ELCACCTV
  7013         10  FILLER                    PIC 999.                   ELCACCTV
  7014         10  AM-EFF-CCYY               PIC 9(04).                 ELCACCTV
  7015         10  AM-EFF-CCYR  REDEFINES  AM-EFF-CCYY.                 ELCACCTV
  7016             15  AM-EFF-CC             PIC 99.                    ELCACCTV
  7017             15  AM-EFF-YR             PIC 99.                    ELCACCTV
  7018         10  AM-EFF-MO                 PIC 99.                    ELCACCTV
  7019         10  AM-EFF-DA                 PIC 99.                    ELCACCTV
  7020     05  WS-AM-EFFECT-DT-N REDEFINES                                 CL**3
  7021            WS-AM-EFFECT-DT            PIC 9(11).                    CL**4
  7022     05  WS-AM-PREV-EXP-DT.                                       ELCACCTV
  7023         10 FILLER                     PIC 999.                   ELCACCTV
  7024         10 AM-PREV-EXP-DT-CCYY        PIC 9(04).                 ELCACCTV
  7025         10 AM-PREV-EXP-DT-CCYR  REDEFINES  AM-PREV-EXP-DT-CCYY.  ELCACCTV
  7026            15 AM-PREV-EXP-DT-CC       PIC 99.                    ELCACCTV
  7027            15 AM-PREV-EXP-DT-YR       PIC 99.                    ELCACCTV
  7028         10 AM-PREV-EXP-MO             PIC 99.                    ELCACCTV
  7029         10 AM-PREV-EXP-DA             PIC 99.                    ELCACCTV
  7030     05  WS-AM-PREV-EXP-DT-N REDEFINES                               CL**3
  7031            WS-AM-PREV-EXP-DT          PIC 9(11).                    CL**3
  7032     05  WS-AM-PREV-EFF-DT.                                       ELCACCTV
  7033         10 FILLER                     PIC 999.                   ELCACCTV
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 138
* ECS010P.cbl (/apps/prod/cid1p/copy/ELCACCTV)
  7034         10 AM-PREV-EFF-CCYY           PIC 9(04).                 ELCACCTV
  7035         10 AM-PREV-EFF-CCYR  REDEFINES  AM-PREV-EFF-CCYY.        ELCACCTV
  7036            15 AM-PREV-EFF-CC          PIC 99.                    ELCACCTV
  7037            15 AM-PREV-EFF-YR          PIC 99.                    ELCACCTV
  7038         10 AM-PREV-EFF-MO             PIC 99.                    ELCACCTV
  7039         10 AM-PREV-EFF-DA             PIC 99.                    ELCACCTV
  7040     05  WS-AM-PREV-EFF-DT-N REDEFINES                               CL**3
  7041            WS-AM-PREV-EFF-DT          PIC 9(11).                    CL**3
  7042     05  WS-AM-ANNIVERSARY-DATE.                                  ELCACCTV
  7043         10  FILLER                    PIC 999.                   ELCACCTV
  7044         10  AM-AN-CCYY                PIC 9(04).                 ELCACCTV
  7045         10  AM-AN-CCYR  REDEFINES  AM-AN-CCYY.                   ELCACCTV
  7046             15  AM-AN-CC              PIC 99.                    ELCACCTV
  7047             15  AM-AN-YR              PIC 99.                    ELCACCTV
  7048         10  AM-AN-MO                  PIC 99.                    ELCACCTV
  7049         10  AM-AN-DA                  PIC 99.                    ELCACCTV
  7050     05  WS-AM-ANNIVERSARY-DATE-N REDEFINES                          CL**3
  7051            WS-AM-ANNIVERSARY-DATE     PIC 9(11).                    CL**4
  7052     05  WS-AM-HI-CERT-DATE.                                      ELCACCTV
  7053         10  FILLER                    PIC 999.                   ELCACCTV
  7054         10  AM-HI-CCYY                PIC 9(04).                 ELCACCTV
  7055         10  AM-HI-CCYR  REDEFINES  AM-HI-CCYY.                   ELCACCTV
  7056             15  AM-HI-CC              PIC 99.                    ELCACCTV
  7057             15  AM-HI-YR              PIC 99.                    ELCACCTV
  7058         10  AM-HI-MO                  PIC 99.                    ELCACCTV
  7059         10  AM-HI-DA                  PIC 99.                    ELCACCTV
  7060     05  WS-AM-HI-CERT-DATE-N REDEFINES                              CL**3
  7061            WS-AM-HI-CERT-DATE         PIC 9(11).                    CL**3
  7062     05  WS-AM-LO-CERT-DATE.                                      ELCACCTV
  7063         10  FILLER                    PIC 999.                   ELCACCTV
  7064         10  AM-LO-CCYY                PIC 9(04).                 ELCACCTV
  7065         10  AM-LO-CCYR  REDEFINES  AM-LO-CCYY.                   ELCACCTV
  7066             15  AM-LO-CC              PIC 99.                    ELCACCTV
  7067             15  AM-LO-YR              PIC 99.                    ELCACCTV
  7068         10  AM-LO-MO                  PIC 99.                    ELCACCTV
  7069         10  AM-LO-DA                  PIC 99.                    ELCACCTV
  7070     05  WS-AM-LO-CERT-DATE-N REDEFINES                              CL**3
  7071            WS-AM-LO-CERT-DATE         PIC 9(11).                    CL**3
  7072     05  WS-AM-ENTRY-DATE.                                        ELCACCTV
  7073         10  FILLER                    PIC 999.                   ELCACCTV
  7074         10  AM-ENT-CCYY               PIC 9(04).                 ELCACCTV
  7075         10  AM-ENT-CCYR  REDEFINES  AM-ENT-CCYY.                 ELCACCTV
  7076             15  AM-ENT-CC             PIC 99.                    ELCACCTV
  7077             15  AM-ENT-YR             PIC 99.                    ELCACCTV
  7078         10  AM-ENT-MO                 PIC 99.                    ELCACCTV
  7079         10  AM-ENT-DA                 PIC 99.                    ELCACCTV
  7080     05  WS-AM-ENTRY-DATE-N REDEFINES                                CL**3
  7081            WS-AM-ENTRY-DATE           PIC 9(11).                    CL**3
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 139
* ECS010P.cbl
* 7083                             COPY ELCEXTVR.
  7084******************************************************************04/15/98
  7085*                                                                *ELCEXTVR
  7086*                                                                *ELCEXTVR
  7087*                             ELCEXTVR                           *   LV002
  7088*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  7089*                            VMOD=2.001                          *ELCEXTVR
  7090*                                                                *ELCEXTVR
  7091*   WORKING STORAGE FOR DATE VARIABLES CREATED                   *ELCEXTVR
  7092*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCEXTVR
  7093*                                                                *ELCEXTVR
  7094******************************************************************ELCEXTVR
  7095 01  WS-CALL-EXTRACT-DATE.                                        ELCEXTVR
  7096     05  WS-EX-EFF-DATE.                                          ELCEXTVR
  7097         10  FILLER              PIC 999.                         ELCEXTVR
  7098         10  EX-EFF-DATE-CCYY    PIC 9(04).                       ELCEXTVR
  7099         10  EX-EFF-DATE-CCYR  REDEFINES  EX-EFF-DATE-CCYY.       ELCEXTVR
  7100             15  EX-EFF-DATE-CC  PIC 99.                          ELCEXTVR
  7101             15  EX-EFF-DATE-YR  PIC 99.                          ELCEXTVR
  7102         10  EX-EFF-DATE-MO      PIC 99.                          ELCEXTVR
  7103         10  EX-EFF-DATE-DA      PIC 99.                          ELCEXTVR
  7104     05  WS-EX-EFF-DATE-N REDEFINES                                  CL**2
  7105            WS-EX-EFF-DATE       PIC 9(11).                          CL**2
  7106 01  WS-DETAIL-EXTRACT-DATE.                                      ELCEXTVR
  7107     05  WS-DE-EFF.                                               ELCEXTVR
  7108         10  FILLER              PIC 999.                         ELCEXTVR
  7109         10  DE-EF-CCYY          PIC 9(04).                       ELCEXTVR
  7110         10  DE-EF-CCYR  REDEFINES  DE-EF-CCYY.                   ELCEXTVR
  7111             15  DE-EF-CC        PIC 99.                          ELCEXTVR
  7112             15  DE-EF-YR        PIC 99.                          ELCEXTVR
  7113         10  DE-EF-MO            PIC 99.                          ELCEXTVR
  7114         10  DE-EF-DA            PIC 99.                          ELCEXTVR
  7115     05  WS-DE-EFF-N REDEFINES                                       CL**2
  7116            WS-DE-EFF            PIC 9(11).                          CL**2
  7117     05  WS-DE-LF-CANC-DTE.                                       ELCEXTVR
  7118         10  FILLER              PIC 999.                         ELCEXTVR
  7119         10  DE-LF-CANC-CCYY     PIC 9(04).                       ELCEXTVR
  7120         10  DE-LF-CANC-CCYR  REDEFINES  DE-LF-CANC-CCYY.         ELCEXTVR
  7121             15  DE-LF-CANC-CC   PIC 99.                          ELCEXTVR
  7122             15  DE-LF-CANC-YR   PIC 99.                          ELCEXTVR
  7123         10  DE-LF-CANC-MO       PIC 99.                          ELCEXTVR
  7124         10  DE-LF-CANC-DA       PIC 99.                          ELCEXTVR
  7125     05  WS-DE-LF-CANC-DTE-N REDEFINES                               CL**2
  7126            WS-DE-LF-CANC-DTE       PIC 9(11).                       CL**2
  7127     05  WS-DE-LF-CANC-EXIT-DT.                                   ELCEXTVR
  7128         10  FILLER                 PIC 999.                      ELCEXTVR
  7129         10  DE-LF-CANC-EXIT-CCYY   PIC 9(04).                    ELCEXTVR
  7130         10  DE-LF-CANC-EXIT-CCYR REDEFINES DE-LF-CANC-EXIT-CCYY. ELCEXTVR
  7131             15  DE-LF-CANC-EXIT-CC PIC 99.                       ELCEXTVR
  7132             15  DE-LF-CANC-EXIT-YR PIC 99.                       ELCEXTVR
  7133         10  DE-LF-CANC-EXIT-MO     PIC 99.                       ELCEXTVR
  7134         10  DE-LF-CANC-EXIT-DA     PIC 99.                       ELCEXTVR
  7135     05  WS-DE-LF-CANC-EXIT-DT-N REDEFINES                           CL**3
  7136            WS-DE-LF-CANC-EXIT-DT   PIC 9(11).                       CL**2
  7137     05  WS-DE-AH-CANC-DTE.                                       ELCEXTVR
  7138         10  FILLER                 PIC 999.                      ELCEXTVR
  7139         10  DE-AH-CANC-CCYY        PIC 9(04).                    ELCEXTVR
  7140         10  DE-AH-CANC-CCYR  REDEFINES  DE-AH-CANC-CCYY.         ELCEXTVR
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 140
* ECS010P.cbl (/apps/prod/cid1p/copy/ELCEXTVR)
  7141             15  DE-AH-CANC-CC      PIC 99.                       ELCEXTVR
  7142             15  DE-AH-CANC-YR      PIC 99.                       ELCEXTVR
  7143         10  DE-AH-CANC-MO          PIC 99.                       ELCEXTVR
  7144         10  DE-AH-CANC-DA          PIC 99.                       ELCEXTVR
  7145     05  WS-DE-AH-CANC-DTE-N REDEFINES                               CL**4
  7146            WS-DE-AH-CANC-DTE       PIC 9(11).                       CL**2
  7147     05  WS-DE-AH-CANC-EXIT-DT.                                   ELCEXTVR
  7148         10  FILLER                 PIC 999.                      ELCEXTVR
  7149         10  DE-AH-CANC-EXIT-CCYY   PIC 9(04).                    ELCEXTVR
  7150         10  DE-AH-CANC-EXIT-CCYR REDEFINES DE-AH-CANC-EXIT-CCYY. ELCEXTVR
  7151             15  DE-AH-CANC-EXIT-CC PIC 99.                       ELCEXTVR
  7152             15  DE-AH-CANC-EXIT-YR PIC 99.                       ELCEXTVR
  7153         10  DE-AH-CANC-EXIT-MO     PIC 99.                       ELCEXTVR
  7154         10  DE-AH-CANC-EXIT-DA     PIC 99.                       ELCEXTVR
  7155     05  WS-DE-AH-CANC-EXIT-DT-N REDEFINES                           CL**2
  7156            WS-DE-AH-CANC-EXIT-DT   PIC 9(11).                       CL**2
  7157     05  WS-DE-ENTRY-DTE.                                         ELCEXTVR
  7158         10  FILLER                 PIC 999.                      ELCEXTVR
  7159         10  DE-ENTRY-CCYY          PIC 9(04).                    ELCEXTVR
  7160         10  DE-ENTRY-CCYR  REDEFINES  DE-ENTRY-CCYY.             ELCEXTVR
  7161             15  DE-ENTRY-CC        PIC 99.                       ELCEXTVR
  7162             15  DE-ENTRY-YR        PIC 99.                       ELCEXTVR
  7163         10  DE-ENTRY-MO            PIC 99.                       ELCEXTVR
  7164         10  DE-ENTRY-DA            PIC 99.                       ELCEXTVR
  7165     05  WS-DE-ENTRY-DTE-N REDEFINES                                 CL**2
  7166            WS-DE-ENTRY-DTE         PIC 9(11).                       CL**2
  7167     05  WS-DE-PROC-DT.                                           ELCEXTVR
  7168         10  FILLER                 PIC 999.                      ELCEXTVR
  7169         10  DE-PD-CCYY             PIC 9(04).                    ELCEXTVR
  7170         10  DE-PD-CCYR  REDEFINES  DE-PD-CCYY.                   ELCEXTVR
  7171             15  DE-PD-CC           PIC 99.                       ELCEXTVR
  7172             15  DE-PD-YR           PIC 99.                       ELCEXTVR
  7173         10  DE-PD-MO               PIC 99.                       ELCEXTVR
  7174         10  DE-PD-DA               PIC 99.                       ELCEXTVR
  7175     05  WS-DE-PROC-DT-N REDEFINES                                   CL**2
  7176            WS-DE-PROC-DT           PIC 9(11).                       CL**2
  7177     05  WS-DE-CLM-PROC-DT REDEFINES WS-DE-PROC-DT.                  CL**5
  7178         10  FILLER                 PIC 999.                         CL**5
  7179         10  DE-CP-CCYY             PIC 9(04).                       CL**5
  7180         10  DE-CP-CCYR  REDEFINES  DE-CP-CCYY.                      CL**6
  7181             15  DE-CP-CC           PIC 99.                          CL**5
  7182             15  DE-CP-YR           PIC 99.                          CL**5
  7183         10  DE-CP-MO               PIC 99.                          CL**5
  7184         10  DE-CP-DA               PIC 99.                          CL**5
  7185     05  WS-DE-CLM-PROC-DT-N REDEFINES                               CL**5
  7186            WS-DE-CLM-PROC-DT              PIC 9(11).                CL**5
  7187     05  WS-DE-RSV-PROC-DT REDEFINES WS-DE-PROC-DT.                  CL**5
  7188         10  FILLER                 PIC 999.                         CL**5
  7189         10  DE-RP-CCYY             PIC 9(04).                       CL**5
  7190         10  DE-RP-CCYR  REDEFINES  DE-RP-CCYY.                      CL**6
  7191             15  DE-RP-CC           PIC 99.                          CL**5
  7192             15  DE-RP-YR           PIC 99.                          CL**5
  7193         10  DE-RP-MO                      PIC 99.                   CL**5
  7194         10  DE-RP-DA                      PIC 99.                   CL**5
  7195     05  WS-DE-RSV-PROC-DT-N REDEFINES                               CL**5
  7196            WS-DE-RSV-PROC-DT              PIC 9(11).                CL**5
  7197     05  WS-DE-INCUR.                                             ELCEXTVR
  7198         10  FILLER                 PIC 999.                      ELCEXTVR
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 141
* ECS010P.cbl (/apps/prod/cid1p/copy/ELCEXTVR)
  7199         10  DE-INCUR-CCYY          PIC 9(04).                    ELCEXTVR
  7200         10  DE-INCUR-CCYR  REDEFINES  DE-INCUR-CCYY.             ELCEXTVR
  7201             15  DE-INCUR-CC        PIC 99.                       ELCEXTVR
  7202             15  DE-INCUR-YR        PIC 99.                       ELCEXTVR
  7203         10  DE-INCUR-MO            PIC 99.                       ELCEXTVR
  7204         10  DE-INCUR-DA            PIC 99.                       ELCEXTVR
  7205     05  WS-DE-INCUR-N REDEFINES                                     CL**2
  7206            WS-DE-INCUR             PIC 9(11).                       CL**2
  7207     05  WS-DE-PAY.                                               ELCEXTVR
  7208         10  FILLER                 PIC 999.                      ELCEXTVR
  7209         10  DE-PAY-CCYY            PIC 9(04).                    ELCEXTVR
  7210         10  DE-PAY-CCYR  REDEFINES  DE-PAY-CCYY.                 ELCEXTVR
  7211             15  DE-PAY-CC          PIC 99.                       ELCEXTVR
  7212             15  DE-PAY-YR          PIC 99.                       ELCEXTVR
  7213         10  DE-PAY-MO              PIC 99.                       ELCEXTVR
  7214         10  DE-PAY-DA              PIC 99.                       ELCEXTVR
  7215     05  WS-DE-PAY-N REDEFINES                                       CL**2
  7216            WS-DE-PAY               PIC 9(11).                       CL**2
  7217     05  WS-DE-PAID-TO.                                           ELCEXTVR
  7218         10  FILLER                 PIC 999.                      ELCEXTVR
  7219         10  DE-PTO-CCYY            PIC 9(04).                    ELCEXTVR
  7220         10  DE-PTO-CCYR  REDEFINES  DE-PTO-CCYY.                 ELCEXTVR
  7221             15  DE-PTO-CC          PIC 99.                       ELCEXTVR
  7222             15  DE-PTO-YR          PIC 99.                       ELCEXTVR
  7223         10  DE-PTO-MO              PIC 99.                       ELCEXTVR
  7224         10  DE-PTO-DA              PIC 99.                       ELCEXTVR
  7225     05  WS-DE-PAID-TO-N REDEFINES                                   CL**2
  7226            WS-DE-PAID-TO           PIC 9(11).                       CL**2
  7227     05  WS-DE-ACC-EXP-DTE.                                       ELCEXTVR
  7228         10 FILLER                  PIC 999.                      ELCEXTVR
  7229         10 DE-ACC-EXP-CCYY         PIC 9(04).                    ELCEXTVR
  7230         10 DE-ACC-EXP-CCYR  REDEFINES  DE-ACC-EXP-CCYY.          ELCEXTVR
  7231            15 DE-ACC-EXP-CC        PIC 99.                       ELCEXTVR
  7232            15 DE-ACC-EXP-YR        PIC 99.                       ELCEXTVR
  7233         10 DE-ACC-EXP-MO           PIC 99.                       ELCEXTVR
  7234         10 DE-ACC-EXP-DA           PIC 99.                       ELCEXTVR
  7235     05  WS-DE-ACC-EXP-DTE-N REDEFINES                               CL**2
  7236            WS-DE-ACC-EXP-DTE       PIC 9(11).                       CL**2
  7237     05  WS-DE-ACC-EFF-DTE.                                       ELCEXTVR
  7238         10 FILLER                  PIC 999.                      ELCEXTVR
  7239         10 DE-ACC-EFF-CCYY         PIC 9(04).                    ELCEXTVR
  7240         10 DE-ACC-EFF-CCYR  REDEFINES  DE-ACC-EFF-CCYY.          ELCEXTVR
  7241            15 DE-ACC-EFF-CC        PIC 99.                       ELCEXTVR
  7242            15 DE-ACC-EFF-YR        PIC 99.                       ELCEXTVR
  7243         10 DE-ACC-EFF-MO           PIC 99.                       ELCEXTVR
  7244         10 DE-ACC-EFF-DA           PIC 99.                       ELCEXTVR
  7245     05  WS-DE-ACC-EFF-DTE-N REDEFINES                               CL**2
  7246            WS-DE-ACC-EFF-DTE       PIC 9(11).                       CL**2
  7247     05  WS-DE-RSV-INCUR.                                         ELCEXTVR
  7248         10  FILLER                 PIC 999.                      ELCEXTVR
  7249         10  DE-RSV-INCUR-CCYY      PIC 9(04).                    ELCEXTVR
  7250         10  DE-RSV-INCUR-CCYR  REDEFINES  DE-RSV-INCUR-CCYY.     ELCEXTVR
  7251             15  DE-RSV-INCUR-CC    PIC 99.                       ELCEXTVR
  7252             15  DE-RSV-INCUR-YR    PIC 99.                       ELCEXTVR
  7253         10  DE-RSV-INCUR-MO        PIC 99.                       ELCEXTVR
  7254         10  DE-RSV-INCUR-DA        PIC 99.                       ELCEXTVR
  7255     05  WS-DE-RSV-INCUR-N REDEFINES                                 CL**2
  7256            WS-DE-RSV-INCUR         PIC 9(11).                       CL**2
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 142
* ECS010P.cbl (/apps/prod/cid1p/copy/ELCEXTVR)
  7257     05  WS-DE-RSV-PAYTO.                                         ELCEXTVR
  7258         10  FILLER                 PIC 999.                      ELCEXTVR
  7259         10  DE-RSV-PAYTO-CCYY      PIC 9(04).                    ELCEXTVR
  7260         10  DE-RSV-PAYTO-CCYR  REDEFINES  DE-RSV-PAYTO-CCYY.     ELCEXTVR
  7261             15  DE-RSV-PAYTO-CC    PIC 99.                       ELCEXTVR
  7262             15  DE-RSV-PAYTO-YR    PIC 99.                       ELCEXTVR
  7263         10  DE-RSV-PAYTO-MO        PIC 99.                       ELCEXTVR
  7264         10  DE-RSV-PAYTO-DA        PIC 99.                       ELCEXTVR
  7265     05  WS-DE-RSV-PAYTO-N REDEFINES                                 CL**2
  7266            WS-DE-RSV-PAYTO         PIC 9(11).                       CL**2
  7267     05  WS-DE-ACC-EXP-DTE-RSV.                                   ELCEXTVR
  7268         10  FILLER                        PIC 999.               ELCEXTVR
  7269         10  DE-ACC-EXP-DTE-RSV-CCYY       PIC 9(04).             ELCEXTVR
  7270         10  DE-ACC-EXP-DTE-RSV-CCYR REDEFINES                    ELCEXTVR
  7271                             DE-ACC-EXP-DTE-RSV-CCYY.             ELCEXTVR
  7272             15  DE-ACC-EXP-DTE-RSV-CC     PIC 99.                ELCEXTVR
  7273             15  DE-ACC-EXP-DTE-RSV-YR     PIC 99.                ELCEXTVR
  7274         10  DE-ACC-EXP-DTE-RSV-MO         PIC 99.                ELCEXTVR
  7275         10  DE-ACC-EXP-DTE-RSV-DA         PIC 99.                ELCEXTVR
  7276     05  WS-DE-ACC-EXP-DTE-RSV-N REDEFINES                           CL**2
  7277            WS-DE-ACC-EXP-DTE-RSV          PIC 9(11).                CL**2
  7278     05  WS-DE-ACC-EFF-DTE-RSV.                                   ELCEXTVR
  7279         10  FILLER                        PIC 999.               ELCEXTVR
  7280         10  DE-ACC-EFF-DTE-RSV-CCYY       PIC 9(04).             ELCEXTVR
  7281         10  DE-ACC-EFF-DTE-RSV-CCYR  REDEFINES                   ELCEXTVR
  7282                                DE-ACC-EFF-DTE-RSV-CCYY.          ELCEXTVR
  7283             15  DE-ACC-EFF-DTE-RSV-CC     PIC 99.                ELCEXTVR
  7284             15  DE-ACC-EFF-DTE-RSV-YR     PIC 99.                ELCEXTVR
  7285         10  DE-ACC-EFF-DTE-RSV-MO         PIC 99.                ELCEXTVR
  7286         10  DE-ACC-EFF-DTE-RSV-DA         PIC 99.                ELCEXTVR
  7287     05  WS-DE-ACC-EFF-DTE-RSV-N REDEFINES                           CL**2
  7288            WS-DE-ACC-EFF-DTE-RSV          PIC 9(11).                CL**2
  7289                                                                     CL**5
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 143
* ECS010P.cbl
  7291 PROCEDURE DIVISION.
  7292
  7293 0000-START.
  7294
  7295******************************************************************
  7296***        D A T E   C A R D   L O A D   R O U T I N E         ***
  7297******************************************************************
  7298
  7299*0003-LOAD-DATE-CARD.
* 7300                             COPY ELCDTERX.
  7301******************************************************************04/15/98
  7302*                                                                *ELCDTERX
  7303*                                                                *ELCDTERX
  7304*                            ELCDTERX.                           *   LV002
  7305*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  7306*                            VMOD=2.007                          *ELCDTERX
  7307*                                                                *ELCDTERX
  7308*      LOAD DATE CARD DISK FILE INTO WORKING STORAGE AREA        *ELCDTERX
  7309*      (COPY CODE FOR W/S = ELCDTECX AND COPY CODE FOR FD        *ELCDTERX
  7310*      = ELCDTEFD)                                               *ELCDTERX
  7311*                                                                *ELCDTERX
  7312******************************************************************ELCDTERX
  7313                                                                  ELCDTERX
  7314     ACCEPT WS-ACCEPT-DATE       FROM  DATE.                      ELCDTERX
  7315                                                                  ELCDTERX
  7316     MOVE WS-AD-YY               TO  WS-CD-YY.                    ELCDTERX
  7317     MOVE WS-AD-MM               TO  WS-CD-MM.                    ELCDTERX
  7318     MOVE WS-AD-DD               TO  WS-CD-DD.                    ELCDTERX
  7319                                                                  ELCDTERX
  7320     ACCEPT WS-TIME-OF-DAY       FROM  TIME.                      ELCDTERX
  7321                                                                  ELCDTERX
  7322******************************************************************ELCDTERX
  7323*    NOTE: THE FOLLOWING STATEMENT IS USED TO ELIMINATE COB II    ELCDTERX
  7324*          WARNING MESSAGES.                                      ELCDTERX
  7325******************************************************************ELCDTERX
  7326     IF WS-CD-YY = LOW-VALUES                                     ELCDTERX
  7327         COMPUTE PGM-SUB = PGM-SUB + 1.                           ELCDTERX
  7328                                                                  ELCDTERX
  7329     OPEN INPUT DISK-DATE.                                        ELCDTERX
  7330                                                                  ELCDTERX
  7331     MOVE SPACE TO DATE-CARD         CLAS-BUSINESS-CLASSES        ELCDTERX
  7332                   STATE-NAMES       CLAS-MORTALITY-CODES         ELCDTERX
  7333                   CLAS-INS-TYPES    COMPANY-NAME-TABLE           ELCDTERX
  7334                   DATE-CARD-OPTIONS DATE-CARD-FACTORS            ELCDTERX
  7335                   CLAX-ID           CLAS-MISC                    ELCDTERX
  7336                   CARRIER-NAMES     CLASIC-SYSTEM-CODES          ELCDTERX
  7337                   CARRIER-OPT-CLAIM-DATA                         ELCDTERX
  7338                   STATE-TARGET-LOSS-RATIOS                       ELCDTERX
  7339                   BUSINESS-TRGT-LOSS-RATIO-MODS                  ELCDTERX
  7340                   MISC-OPT-CLM-RSV-DATA.                         ELCDTERX
  7341                                                                  ELCDTERX
  7342     MOVE LOW-VALUES TO CLAS-INDEX-TBL CLAS-TYPE-MISC.            ELCDTERX
  7343                                                                  ELCDTERX
  7344     MOVE ZERO TO CLAS-CN DTE-TOT-LINES CLAS-CO                   ELCDTERX
  7345                  INDEXCA INDEXBS INDEXST.                        ELCDTERX
  7346                                                                  ELCDTERX
  7347     COMPUTE CLAS-CN = PGM-SUB / +50.                             ELCDTERX
  7348     COMPUTE CLAS-CO = PGM-SUB / +20.                             ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 144
* ECS010P.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  7349     COMPUTE CLAS-INDEXEN = PGM-SUB - (CLAS-CN * +50).            ELCDTERX
  7350     COMPUTE CLAS-INDEXON = PGM-SUB - (CLAS-CO * +20).            ELCDTERX
  7351                                                                  ELCDTERX
  7352     IF CLAS-INDEXEN = ZERO                                       ELCDTERX
  7353         MOVE +50               TO CLAS-INDEXEN                   ELCDTERX
  7354     ELSE                                                         ELCDTERX
  7355         ADD +1                 TO CLAS-CN.                       ELCDTERX
  7356                                                                  ELCDTERX
  7357     IF CLAS-INDEXON = ZERO                                       ELCDTERX
  7358         MOVE +20               TO CLAS-INDEXON                   ELCDTERX
  7359     ELSE                                                         ELCDTERX
  7360         ADD +1                 TO CLAS-CO.                       ELCDTERX
  7361                                                                  ELCDTERX
  7362 0005-READ--CARD.                                                 ELCDTERX
  7363     READ DISK-DATE                                               ELCDTERX
  7364         AT END CLOSE DISK-DATE                                   ELCDTERX
  7365             GO TO 0060-READ--TEST.                               ELCDTERX
  7366                                                                  ELCDTERX
  7367     MOVE ZERO                   TO CLAS-INDEX.                   ELCDTERX
  7368                                                                  ELCDTERX
  7369     IF DD-ID = 'CLAS' OR 'LIFE' OR 'GLED'                        ELCDTERX
  7370         MOVE DATE-DISK          TO DATE-CARD                     ELCDTERX
  7371         MOVE RUN-DATE           TO WS-RUN-DATE-N                    CL**2
  7372         MOVE EP-DT              TO WS-EP-DT-N                       CL**2
  7373         GO TO 0005-READ--CARD.                                   ELCDTERX
  7374                                                                  ELCDTERX
  7375     IF DD-ID = 'CLAD'                                            ELCDTERX
  7376         MOVE DATE-DISK          TO DATE-CARD-OPTIONS             ELCDTERX
  7377         GO TO 0005-READ--CARD.                                   ELCDTERX
  7378                                                                  ELCDTERX
  7379     IF DD-ID = 'CLAX'                                            ELCDTERX
  7380         MOVE DATE-DISK          TO CLAS-INDEX-TBL                ELCDTERX
  7381         GO TO 0005-READ--CARD.                                   ELCDTERX
  7382                                                                  ELCDTERX
  7383     IF DD-ID = 'CLAF'                                            ELCDTERX
  7384         MOVE DATE-DISK          TO DATE-CARD-FACTORS             ELCDTERX
  7385         GO TO 0005-READ--CARD.                                   ELCDTERX
  7386                                                                  ELCDTERX
  7387     IF DD-ID = 'CLAC'                                            ELCDTERX
  7388         GO TO 0010-READ--CLAC.                                   ELCDTERX
  7389                                                                  ELCDTERX
  7390     IF DD-ID = 'CARR'                                            ELCDTERX
  7391         GO TO 0015-READ--CARR.                                   ELCDTERX
  7392                                                                  ELCDTERX
  7393     IF DD-ID = 'STAT'                                            ELCDTERX
  7394         GO TO 0020-READ--STAT.                                   ELCDTERX
  7395                                                                  ELCDTERX
  7396     IF DD-ID = 'BUSC'                                            ELCDTERX
  7397         GO TO 0025-READ--BUSC.                                   ELCDTERX
  7398                                                                  ELCDTERX
  7399     IF DD-ID = 'MORT'                                            ELCDTERX
  7400         GO TO 0030-READ--MORT.                                   ELCDTERX
  7401                                                                  ELCDTERX
  7402     IF DD-ID = 'CLAI'                                            ELCDTERX
  7403         GO TO 0040-READ--CLAI.                                   ELCDTERX
  7404                                                                  ELCDTERX
  7405     IF DD-ID = 'COLC'                                            ELCDTERX
  7406         GO TO 0065-READ--COLC.                                   ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 145
* ECS010P.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  7407                                                                  ELCDTERX
  7408     IF DD-IDX NUMERIC AND                                        ELCDTERX
  7409        DD-IDA = 'CL'                                             ELCDTERX
  7410         GO TO 0035-READ--CLXX.                                   ELCDTERX
  7411                                                                  ELCDTERX
  7412     IF DD-IDX NUMERIC AND                                        ELCDTERX
  7413        DD-IDA = 'PO'                                             ELCDTERX
  7414         GO TO 0050-READ--POXX.                                   ELCDTERX
  7415                                                                  ELCDTERX
  7416     IF DD-ID = 'OPCA'                                            ELCDTERX
  7417         GO TO 0070-READ--OPCA.                                   ELCDTERX
  7418                                                                  ELCDTERX
  7419     IF DD-ID = 'OPST'                                            ELCDTERX
  7420         GO TO 0072-READ--OPST.                                   ELCDTERX
  7421                                                                  ELCDTERX
  7422     IF DD-ID = 'OPBS'                                            ELCDTERX
  7423         GO TO 0074-READ--OPBS.                                   ELCDTERX
  7424                                                                  ELCDTERX
  7425     IF DD-ID = 'OPMS'                                            ELCDTERX
  7426         MOVE DD-MISC-DATA       TO MISC-OPT-CLM-RSV-DATA.        ELCDTERX
  7427                                                                  ELCDTERX
  7428     GO TO 0005-READ--CARD.                                       ELCDTERX
  7429                                                                  ELCDTERX
  7430 0010-READ--CLAC.                                                 ELCDTERX
  7431     ADD 1                       TO CLAS-INDEXC.                  ELCDTERX
  7432     MOVE DD-CR1                 TO CNT-ID (CLAS-INDEXC).         ELCDTERX
  7433     MOVE DD-CR1N                TO CNT-NAME (CLAS-INDEXC).       ELCDTERX
  7434     ADD 1                       TO CLAS-INDEXC.                  ELCDTERX
  7435     MOVE DD-CR2                 TO CNT-ID (CLAS-INDEXC).         ELCDTERX
  7436     MOVE DD-CR2N                TO CNT-NAME (CLAS-INDEXC).       ELCDTERX
  7437     GO TO 0005-READ--CARD.                                       ELCDTERX
  7438                                                                  ELCDTERX
  7439 0015-READ--CARR.                                                 ELCDTERX
  7440     ADD 1  TO  CLAS-INDEXCN.                                     ELCDTERX
  7441     IF CLAS-INDEXCN LESS THAN +26                                ELCDTERX
  7442        MOVE DD-CARR1         TO CARRIER-SUB (CLAS-INDEXCN)
  7443        MOVE DD-CARR1S        TO CARRIER-DOM-ST (CLAS-INDEXCN)
  7444        MOVE DD-CARR1N        TO CARRIER-PIC (CLAS-INDEXCN)
  7445        MOVE DD-CARR1-UEP-PCT TO CARRIER-UEP-PCT (CLAS-INDEXCN)
  7446        MOVE DD-CARR1-R78-PCT TO CARRIER-R78-PCT (CLAS-INDEXCN)
  7447        MOVE DD-CARR1-PRO-PCT TO CARRIER-PRO-PCT (CLAS-INDEXCN)
  7448        MOVE DD-CARR1-SECPAY-SW
  7449                               TO CARRIER-SEC-PAY (CLAS-INDEXCN)
  7450     END-IF
  7451                                                                  ELCDTERX
  7452     ADD 1  TO  CLAS-INDEXCN.                                     ELCDTERX
  7453     IF CLAS-INDEXCN LESS THAN +26                                ELCDTERX
  7454        MOVE DD-CARR2         TO CARRIER-SUB (CLAS-INDEXCN)
  7455        MOVE DD-CARR2S        TO CARRIER-DOM-ST (CLAS-INDEXCN)
  7456        MOVE DD-CARR2N        TO CARRIER-PIC (CLAS-INDEXCN)
  7457        MOVE DD-CARR2-UEP-PCT TO CARRIER-UEP-PCT (CLAS-INDEXCN)
  7458        MOVE DD-CARR2-R78-PCT TO CARRIER-R78-PCT (CLAS-INDEXCN)
  7459        MOVE DD-CARR2-PRO-PCT TO CARRIER-PRO-PCT (CLAS-INDEXCN)
  7460        MOVE DD-CARR2-SECPAY-SW
  7461                              TO CARRIER-SEC-PAY (CLAS-INDEXCN)
  7462     END-IF
  7463                                                                  ELCDTERX
  7464                                                                  ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 146
* ECS010P.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  7465     GO TO 0005-READ--CARD.                                       ELCDTERX
  7466                                                                  ELCDTERX
  7467 0020-READ--STAT.                                                 ELCDTERX
  7468     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  7469     IF CLAS-INDEX GREATER 3  OR                                  ELCDTERX
  7470        DD-ST (CLAS-INDEX) = SPACE                                ELCDTERX
  7471         GO TO 0005-READ--CARD.                                   ELCDTERX
  7472                                                                  ELCDTERX
  7473     ADD 1                       TO CLAS-INDEXS.                  ELCDTERX
  7474     MOVE DD-ST (CLAS-INDEX)     TO STATE-NAME-FLD (CLAS-INDEXS). ELCDTERX
  7475     GO TO 0020-READ--STAT.                                       ELCDTERX
  7476                                                                  ELCDTERX
  7477 0025-READ--BUSC.                                                 ELCDTERX
  7478     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  7479     IF CLAS-INDEX GREATER 3  OR                                  ELCDTERX
  7480        DD-ST (CLAS-INDEX) = SPACE                                ELCDTERX
  7481         GO TO 0005-READ--CARD.                                   ELCDTERX
  7482                                                                  ELCDTERX
  7483     ADD 1                       TO CLAS-INDEXB.                  ELCDTERX
  7484     MOVE DD-ST (CLAS-INDEX)     TO CLAS-BUSC-FLD (CLAS-INDEXB).  ELCDTERX
  7485     GO TO 0025-READ--BUSC.                                       ELCDTERX
  7486                                                                  ELCDTERX
  7487 0030-READ--MORT.                                                 ELCDTERX
  7488     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  7489     IF CLAS-INDEX GREATER 2  OR                                  ELCDTERX
  7490        DD-MORT (CLAS-INDEX) = SPACE                              ELCDTERX
  7491         GO TO 0005-READ--CARD.                                   ELCDTERX
  7492                                                                  ELCDTERX
  7493     ADD 1                       TO CLAS-INDEXM.                  ELCDTERX
  7494     MOVE DD-MORT (CLAS-INDEX)   TO CLAS-MORT-FLD (CLAS-INDEXM).  ELCDTERX
  7495     GO TO 0030-READ--MORT.                                       ELCDTERX
  7496                                                                  ELCDTERX
  7497 0035-READ--CLXX.                                                 ELCDTERX
  7498     IF DD-IDX NOT = CLAS-CN                                      ELCDTERX
  7499          GO TO 0005-READ--CARD.                                  ELCDTERX
  7500                                                                  ELCDTERX
  7501     IF DD-PS-PIC (CLAS-INDEXEN) = 'X'                            ELCDTERX
  7502         DISPLAY '***********************************************'ELCDTERX
  7503         DISPLAY 'PROGRAM ECS-', PGM-SUB, ' NOT SCHEDULED TO RUN' ELCDTERX
  7504         DISPLAY '***********************************************'ELCDTERX
  7505         GO TO 0055-READ--STOP.                                   ELCDTERX
  7506                                                                  ELCDTERX
  7507     IF DD-PS-PIC (CLAS-INDEXEN) NOT LESS 'A'  AND                ELCDTERX
  7508        DD-PS-PIC (CLAS-INDEXEN) NOT GREATER 'I'                  ELCDTERX
  7509         MOVE '1'                TO DTE-FICH.                     ELCDTERX
  7510                                                                  ELCDTERX
  7511     IF DD-PS-PIC (CLAS-INDEXEN) NOT LESS 'J'  AND                ELCDTERX
  7512        DD-PS-PIC (CLAS-INDEXEN) NOT GREATER 'R'                  ELCDTERX
  7513         MOVE '2'                TO DTE-FICH.                     ELCDTERX
  7514                                                                  ELCDTERX
  7515*    MOVE DD-PS-PIC (CLAS-INDEXEN) TO DTE-PGM-OPT.                ELCDTERX
  7516     GO TO 0005-READ--CARD.                                       ELCDTERX
  7517                                                                  ELCDTERX
  7518 0040-READ--CLAI.                                                 ELCDTERX
  7519     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  7520     IF CLAS-INDEX GREATER 2  OR                                  ELCDTERX
  7521        DD-TYPE (CLAS-INDEX) = SPACE                              ELCDTERX
  7522         GO TO 0005-READ--CARD.                                   ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 147
* ECS010P.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  7523                                                                  ELCDTERX
  7524     ADD 1                       TO CLAS-INDEXA.                  ELCDTERX
  7525     MOVE DD-TYPE (CLAS-INDEX) TO CLAS-ALL-TYPES (CLAS-INDEXA).   ELCDTERX
  7526     GO TO 0040-READ--CLAI.                                       ELCDTERX
  7527                                                                  ELCDTERX
  7528 0045-READ--DUMP.                                                 ELCDTERX
  7529     MOVE +999 TO WS-RETURN-CODE                                  ELCDTERX
  7530     MOVE 'MISSING AND/OR INVALID CLAS DATE CARD'                 ELCDTERX
  7531                                 TO  WS-ABEND-MESSAGE             ELCDTERX
  7532     PERFORM ABEND-PGM.                                           ELCDTERX
  7533                                                                  ELCDTERX
  7534 0050-READ--POXX.                                                 ELCDTERX
  7535     IF DD-IDX NOT = CLAS-CO                                      ELCDTERX
  7536         GO TO 0005-READ--CARD.                                   ELCDTERX
  7537                                                                  ELCDTERX
  7538     IF DD-PS-PRC (CLAS-INDEXON) = 'X'                            ELCDTERX
  7539         DISPLAY '***********************************************'ELCDTERX
  7540         DISPLAY 'ECS - ', PGM-SUB, ' IS NOT SCHEDULED TO RUN'    ELCDTERX
  7541         DISPLAY '***********************************************'ELCDTERX
  7542         GO TO 0055-READ--STOP.                                   ELCDTERX
  7543                                                                  ELCDTERX
  7544     MOVE DD-PS-PRT (CLAS-INDEXON) TO DTE-PRT-OPT.                ELCDTERX
  7545     MOVE DD-PS-FMT (CLAS-INDEXON) TO DTE-FMT-OPT.                ELCDTERX
  7546     MOVE DD-PS-PRC (CLAS-INDEXON) TO DTE-PRC-OPT DTE-PGM-OPT.    ELCDTERX
  7547     MOVE DD-PS-TOT (CLAS-INDEXON) TO DTE-TOT-OPT.                ELCDTERX
  7548                                                                  ELCDTERX
  7549     IF DTE-PRT-OPT = 'B'                                         ELCDTERX
  7550         MOVE '2'                  TO DTE-FICH.                   ELCDTERX
  7551     IF DTE-PRT-OPT = 'F'                                         ELCDTERX
  7552         MOVE '1'                  TO DTE-FICH.                   ELCDTERX
  7553                                                                  ELCDTERX
  7554     GO TO 0005-READ--CARD.                                       ELCDTERX
  7555                                                                  ELCDTERX
  7556 0055-READ--STOP.                                                 ELCDTERX
  7557     GOBACK.                                                      ELCDTERX
  7558                                                                  ELCDTERX
  7559 0060-READ--TEST.                                                 ELCDTERX
  7560     IF DATX-COD        = SPACE  OR                               ELCDTERX
  7561        CLAX-ID         = SPACE  OR                               ELCDTERX
  7562        DATE-OPTIONS-ID = SPACE                                   ELCDTERX
  7563         GO TO 0045-READ--DUMP.                                   ELCDTERX
  7564                                                                  ELCDTERX
  7565     MOVE LOW-VALUE TO CLAS-TYPE-MISC.                            ELCDTERX
  7566     GO TO 0079-READ--EXIT.                                       ELCDTERX
  7567                                                                  ELCDTERX
  7568 0065-READ--COLC.                                                 ELCDTERX
  7569     MOVE DATE-DISK              TO CLASIC-SYSTEM-CODES.          ELCDTERX
  7570     GO TO 0005-READ--CARD.                                       ELCDTERX
  7571                                                                  ELCDTERX
  7572 0070-READ--OPCA.                                                 ELCDTERX
  7573                                                                  ELCDTERX
  7574     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  7575                                                                  ELCDTERX
  7576     IF  CLAS-INDEX GREATER 13                                    ELCDTERX
  7577             OR                                                   ELCDTERX
  7578         DD-CARR-FLDS (CLAS-INDEX) = SPACE                        ELCDTERX
  7579         GO TO 0005-READ--CARD.                                   ELCDTERX
  7580                                                                  ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 148
* ECS010P.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  7581     ADD 1                       TO INDEXCA.                      ELCDTERX
  7582     MOVE DD-CARR-FLDS (CLAS-INDEX)                               ELCDTERX
  7583                                 TO CARRIER-FLDS (INDEXCA).       ELCDTERX
  7584     GO TO 0070-READ--OPCA.                                       ELCDTERX
  7585                                                                  ELCDTERX
  7586 0072-READ--OPST.                                                 ELCDTERX
  7587                                                                  ELCDTERX
  7588     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  7589                                                                  ELCDTERX
  7590     IF  CLAS-INDEX GREATER 16                                    ELCDTERX
  7591             OR                                                   ELCDTERX
  7592         DD-TLR (CLAS-INDEX) = SPACE                              ELCDTERX
  7593         GO TO 0005-READ--CARD.                                   ELCDTERX
  7594                                                                  ELCDTERX
  7595     ADD 1                       TO INDEXST.                      ELCDTERX
  7596     MOVE DD-STATE-FLDS (CLAS-INDEX)                              ELCDTERX
  7597                                 TO STATE-TLR-FLD (INDEXST).      ELCDTERX
  7598     GO TO 0072-READ--OPST.                                       ELCDTERX
  7599                                                                  ELCDTERX
  7600 0074-READ--OPBS.                                                 ELCDTERX
  7601                                                                  ELCDTERX
  7602     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  7603                                                                  ELCDTERX
  7604     IF  CLAS-INDEX GREATER 32                                    ELCDTERX
  7605             OR                                                   ELCDTERX
  7606         DD-TLR (CLAS-INDEX) = SPACE                              ELCDTERX
  7607         GO TO 0005-READ--CARD.                                   ELCDTERX
  7608                                                                  ELCDTERX
  7609     ADD 1                       TO INDEXBS.                      ELCDTERX
  7610     MOVE DD-TLR (CLAS-INDEX)    TO BUS-TLRM-FLD (INDEXBS).       ELCDTERX
  7611     GO TO 0074-READ--OPBS.                                       ELCDTERX
  7612                                                                  ELCDTERX
  7613 0079-READ--EXIT.                                                 ELCDTERX
  7614*    EXIT.                                                        ELCDTERX
  7615******************************************************************ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 149
* ECS010P.cbl
  7617******************************************************************
  7618***           O P E N   F I L E S   R O U T I N E              ***
  7619******************************************************************
  7620
  7621     DISPLAY ' '.
  7622     DISPLAY '****** THE FOLLOWING MESSAGES WERE CREATED BY '
  7623         'ECS010 ******'
  7624     DISPLAY ' '.
  7625
  7626     MOVE FUNCTION CURRENT-DATE  TO FUNCTION-DATE
  7627     MOVE 'Y'                    TO DC-FORCE-EL310-DATE-SW
  7628     MOVE FUNCTION-DATE          TO DC-EL310-DATE
  7629     .
  7630 0080-OPEN-FILES.
  7631*    IF DTE-PGM-OPT = '1'
  7632*       open output detail-extr
  7633*    end-if
  7634     OPEN INPUT  PENDING-EXTRACT
  7635                 CERT-MASTER-IN
  7636                 ERACCTT-IN
  7637                 ERAGTC
  7638
  7639          I-O    ERMEBL-INOUT
  7640                 ELCRTT
  7641
  7642          OUTPUT SUMMARY-EXTR
  7643                 ME-ECS010-BALANCE
  7644                 ME50-ECS010-BALANCE
  7645                 DISPLAY-PRT
  7646                 MISMATCH-REPORT
  7647                 PRINT-COPY.
  7648
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 150
* ECS010P.cbl
  7650*START*************CUSTOM CODE FOR CLIENT "DMD"*************
  7651     IF DTE-CLIENT NOT = 'DMD'
  7652         NEXT SENTENCE
  7653     ELSE
  7654         OPEN INPUT ERRESC-IN
  7655            IF ERRESC-FILE-STATUS   = '00' OR '97'
  7656                NEXT SENTENCE
  7657            ELSE
  7658                MOVE ERRESC-FILE-STATUS TO WS-ABEND-FILE-STATUS
  7659                MOVE 'ERROR OPENING ERRESC FILE'
  7660                                        TO WS-ABEND-MESSAGE
  7661                GO TO ABEND-PGM.
  7662*END***************CUSTOM CODE FOR CLIENT "DMD"*************
  7663
  7664     IF ERACCTT-FILE-STATUS  = '00'  OR  '97'
  7665         NEXT SENTENCE
  7666       ELSE
  7667         MOVE '11'                    TO ABEND-CODE-1
  7668         MOVE ERACCTT-FILE-STATUS     TO ABEND-CODE-2
  7669         MOVE WS-ABEND-CODE           TO WS-RETURN-CODE
  7670         GO TO ABEND-PGM.
  7671
  7672     IF ELCRTT-FILE-STATUS  = '00'  OR  '97'
  7673        CONTINUE
  7674     ELSE
  7675        DISPLAY ' OPEN ERROR ELCRTT '
  7676        MOVE '31'                TO ABEND-CODE-1
  7677        MOVE ELCRTT-FILE-STATUS  TO ABEND-CODE-2
  7678        MOVE WS-ABEND-CODE       TO WS-RETURN-CODE
  7679        GO TO ABEND-PGM
  7680     END-IF
  7681
  7682     IF ERAGTC-FILE-STATUS  = '00'  OR  '97'
  7683        CONTINUE
  7684     ELSE
  7685        DISPLAY ' OPEN ERROR ERAGTC '
  7686        MOVE '41'                TO ABEND-CODE-1
  7687        MOVE ERAGTC-FILE-STATUS  TO ABEND-CODE-2
  7688        MOVE WS-ABEND-CODE       TO WS-RETURN-CODE
  7689        GO TO ABEND-PGM
  7690     END-IF
  7691
  7692     IF ERMEBL-FILE-STATUS  = '00'  OR  '97'
  7693         NEXT SENTENCE
  7694       ELSE
  7695         MOVE 'N'                     TO ME-UPDATE-FLAG.
  7696
  7697     IF DTE-PGM-OPT = '1'
  7698         OPEN OUTPUT  CERT-MASTER-OUT
  7699                      DETAIL-EXTR
  7700     ELSE
  7701         MOVE HIGH-VALUES             TO PENDING-MATCH-CONTROL
  7702         MOVE '*'                     TO TRANS-EOF-FLAG.
  7703
  7704     MOVE 'R'                         TO CP-RATE-FILE.
  7705     MOVE 'O'                         TO CP-IO-FUNCTION.
  7706     PERFORM 8100-GET-RATE THRU 8199-GET-RATE-X.
  7707     IF IO-ERROR
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 151
* ECS010P.cbl
  7708         MOVE 'ERROR OCCURED OPENING - ELRATE'
  7709                                      TO WS-ABEND-MESSAGE
  7710         MOVE 0302                    TO WS-RETURN-CODE
  7711         GO TO ABEND-PGM.
  7712
  7713******************************************************************
  7714***       I N I T I A L I Z A T I O N   R O U T I N E          ***
  7715******************************************************************
  7716
  7717 0090-INITIALIZATION-ROUTINE.
  7718
  7719     ACCEPT WS-TIME-OF-DAY   FROM TIME.
  7720     MOVE WS-TIME                     TO ME-START-TIME.
  7721     MOVE WS-CURRENT-DATE             TO ME-START-DATE
  7722                                         TR-RN-DT.
  7723     MOVE ME-START-MO                 TO ME-CNDS-MO.
  7724     MOVE ME-START-DA                 TO ME-CNDS-DA.
  7725     MOVE ME-START-YR                 TO ME-CNDS-YR.
  7726     COMPUTE MONTH-END-MOYR = (RUN-CCYY * 12) + RUN-MO.
  7727     MOVE COMPANY-NAME                TO TRHDNM.
  7728     MOVE ALPH-DATE                   TO TR-MODAYR.
  7729     MOVE RUN-DATE                    TO EOM-RUN-DATE.
  7730     MOVE BIN-RUN-DATE                TO BIN-EOM-RUN-DATE.
  7731
  7732     MOVE EOM-RUN-DATE                TO  LAST-YRS-DATE.
  7733     COMPUTE LYD-CCYY = LYD-CCYY - 1.
  7734     COMPUTE LYD-MO = LYD-MO - 1.
  7735     IF LYD-MO = ZERO
  7736         MOVE 12                      TO LYD-MO
  7737         COMPUTE LYD-CCYY = LYD-CCYY - 1.
  7738
  7739     MOVE BIN-EOM-RUN-DATE       TO BIN-VALUATION-DT.
  7740
  7741
  7742     IF DTE-CLIENT = 'CID'
  7743         MOVE 'CILGM15'          TO  WS-ME-BAL-JOB
  7744         MOVE 'CILGM15'          TO  WS-ME50-BAL-JOB
  7745     ELSE
  7746         MOVE 'CIDCLGM15'        TO  WS-ME-BAL-JOB
  7747         MOVE 'CIDCLGM15'        TO  WS-ME50-BAL-JOB
  7748     END-IF.
  7749
  7750     IF  NOT DTE-OPT-RESERVE-METHOD-AUTH
  7751         GO TO 0090-CONTINUE.
  7752
  7753     MOVE BIN-VALUATION-DT       TO DC-BIN-DATE-1.
  7754     MOVE -12                    TO DC-ELAPSED-MONTHS.
  7755     MOVE ZEROS                  TO DC-ELAPSED-DAYS.
  7756     MOVE '6'                    TO DC-OPTION-CODE.
  7757     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
  7758
  7759     IF  DC-ERROR-CODE NOT EQUAL SPACES
  7760         MOVE '**** WORK DATE CALC ERROR ****'
  7761                                 TO WS-ABEND-MESSAGE
  7762         MOVE '90'               TO ABEND-CODE-1
  7763         MOVE '0'                TO AC2-ONE
  7764         MOVE DC-ERROR-CODE      TO AC2-TWO
  7765         MOVE WS-ABEND-CODE      TO WS-RETURN-CODE
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 152
* ECS010P.cbl
  7766         GO TO ABEND-PGM.
  7767
  7768     MOVE DC-BIN-DATE-2          TO  W-WORK-DATE.
  7769
  7770     MOVE DC-GREG-DATE-CYMD      TO  EOM-DATE (01).
  7771     MOVE EOM-RUN-DATE           TO  EOM-DATE (13).
  7772
  7773     PERFORM 0095-GET-EOM-DATES THRU 0095-EXIT
  7774             VARYING
  7775         SUBM FROM +2 BY +1
  7776             UNTIL
  7777         SUBM GREATER THAN +12.
  7778
  7779     DISPLAY 'END OF MONTH TABLE VALUES USED BY ECS010 - '.
  7780
  7781     PERFORM 0096-DISPLAY-EOM-DATES THRU 0096-EXIT
  7782             VARYING
  7783         SUBM FROM +1 BY +1
  7784             UNTIL
  7785         SUBM GREATER THAN +13.
  7786
  7787     MOVE BIN-VALUATION-DT       TO DC-BIN-DATE-1.
  7788*    MOVE -90                    TO DC-ELAPSED-DAYS.
  7789     MOVE ZEROS                  TO DC-ELAPSED-DAYS
  7790                                    DC-ELAPSED-MONTHS.
  7791     SUBTRACT COMPANY-IBNR-LAG-MONTH FROM DC-ELAPSED-MONTHS.
  7792     MOVE 1                      TO DC-END-OF-MONTH.
  7793     MOVE '6'                    TO DC-OPTION-CODE.
  7794     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
  7795
  7796     IF  DC-ERROR-CODE NOT EQUAL SPACES
  7797         MOVE '**** CUT OFF DATE ERROR ****'
  7798                                 TO WS-ABEND-MESSAGE
  7799         MOVE '90'               TO ABEND-CODE-1
  7800         MOVE '0'                TO AC2-ONE
  7801         MOVE DC-ERROR-CODE      TO AC2-TWO
  7802         MOVE WS-ABEND-CODE      TO WS-RETURN-CODE
  7803         GO TO ABEND-PGM.
  7804
  7805     MOVE DC-GREG-DATE-CYMD      TO W-CUTOFF-DATE.
  7806     DISPLAY ' CUT OFF DATE - '  W-CUTOFF-DATE.
  7807
  7808 0090-CONTINUE.
  7809
  7810     MOVE BIN-VALUATION-DT       TO DC-BIN-DATE-1.
  7811     MOVE -1                     TO DC-ELAPSED-MONTHS.
  7812     MOVE +0                     TO DC-ELAPSED-DAYS.
  7813     MOVE '6'                    TO DC-OPTION-CODE.
  7814     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
  7815
  7816     IF NO-CONVERSION-ERROR
  7817        MOVE DC-GREG-DATE-CYMD   TO OB-RUN-DATES (1).
  7818
  7819     MOVE DC-BIN-DATE-2          TO DC-BIN-DATE-1.
  7820     MOVE -1                     TO DC-ELAPSED-MONTHS.
  7821     MOVE +0                     TO DC-ELAPSED-DAYS.
  7822     MOVE '6'                    TO DC-OPTION-CODE.
  7823     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 153
* ECS010P.cbl
  7824
  7825     IF NO-CONVERSION-ERROR
  7826        MOVE DC-GREG-DATE-CYMD   TO OB-RUN-DATES (2).
  7827
  7828     MOVE +0                     TO DC-ELAPSED-MONTHS
  7829                                    DC-ELAPSED-DAYS.
  7830
  7831     MOVE SPACES                 TO CERTIFICATE-RECORD.
  7832     MOVE 'CR'                   TO CR-RECORD-ID.
  7833     MOVE ZEROS                  TO
  7834               CR-AGE                  CR-JOINT-AGE
  7835               CR-LFTYP                CR-AHTYP
  7836               CR-LF-TERM              CR-AH-TERM
  7837               CR-LF-CRIT-PERIOD       CR-AH-CRIT-PERIOD
  7838               CR-LF-TERM-IN-DAYS
  7839               CR-LF-DEV-PCT           CR-AH-DEV-PCT
  7840               CR-LFAMT                CR-AHAMT
  7841               CR-LFPRM                CR-AHPRM
  7842               CR-LF-POLICY-FEE        CR-AH-POLICY-FEE
  7843               CR-LFPRM-CALC           CR-AHPRM-CALC
  7844               CR-LFPRM-RATE           CR-AHPRM-RATE
  7845               CR-LFAMT-ALT
  7846               CR-LFPRM-ALT            CR-ISS-MICROFILM-NO
*  12-S*********************************************************       (   0)**
**    Operand CR-ISS-MICROFILM-NO is not declared
  7847               CR-LFPRM-CALC-ALT       CR-CAN-MICROFILM-NO
  7848               CR-LFPRM-RATE-ALT
  7849               CR-LFRFND               CR-AHRFND
  7850               CR-LFRFND-CALC          CR-AHRFND-CALC
  7851               CR-LF-NSP-PRM           CR-AH-NSP-PRM
  7852               CR-LF-NSP-PRM-RATE      CR-AH-NSP-PRM-RATE
  7853               CR-LF-REI-RISK-PRM      CR-AH-REI-RISK-PRM
  7854               CR-LF-EXPIRE-DATE       CR-AH-EXPIRE-DATE
  7855               CR-LIVES                CR-APR
  7856               CR-BILLED
  7857               CR-LF-ISS-PREM-TAX      CR-AH-ISS-PREM-TAX
  7858               CR-LF-CNC-PREM-TAX      CR-AH-CNC-PREM-TAX
  7859               CR-PMT-FREQ             CR-LOAN-TERM
  7860               CR-SKIP                 CR-LOAN-1ST-PMT-DT
  7861               CR-SUM-CAN-CNT-ITD      CR-SUM-CAN-CNT-YTD
  7862               CR-PMT-EXTENSION-DAYS   CR-ENTRY-DATE
  7863               CR-LF-CANC-DT           CR-AH-CANC-DT
  7864               CR-LF-CANCEL-EXIT-DATE  CR-AH-CANCEL-EXIT-DATE
  7865               CR-LF-CLAIM-EXIT-DATE   CR-AH-SETTLEMENT-EXIT-DATE
  7866               CR-NUM-DTH-CLM          CR-NUM-DIS-CLM
  7867               CR-DTH-DT               CR-DIS-DT
  7868               CR-DTH-RPT-DT           CR-DIS-RPT-DT
  7869               CR-DTH-PAY-DT           CR-DIS-PAY-DT
  7870                                       CR-DIS-PTO-DT
  7871               CR-DTHAMT               CR-DISAMT
  7872               CR-DTHAMT-YTD           CR-DISAMT-YTD
  7873               CR-DTHAMT-LAST          CR-DISAMT-LAST
  7874               CR-DTHEXP               CR-DISEXP
  7875               CR-DTHEXP-YTD           CR-DISEXP-YTD
  7876               CR-DTH-AGE              CR-DAYS-DISAB
  7877               CR-DIS-INCUR-DT (1)     CR-CLAIM-DEDUCT-WITHHELD
  7878               CR-INCUR-DISAMT (1)     CR-CANCEL-DEDUCT-WITHHELD
  7879               CR-INCUR-DISEXP (1)     CR-REMIT-TO
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 154
* ECS010P.cbl
  7880               CR-CANCEL-STATE-TAX     CR-CANCEL-MUNI-TAX
  7881               CR-MOB-NET-TOT-FEES
  7882               CR-ADDL-CLP.
  7883
  7884     MOVE CR-DISAB-DETAIL-DATA (1)  TO CR-DISAB-DETAIL-DATA (2)
  7885                                       CR-DISAB-DETAIL-DATA (3)
  7886                                       CR-DISAB-DETAIL-DATA (4)
  7887                                       CR-DISAB-DETAIL-DATA (5).
  7888
  7889     MOVE CERTIFICATE-RECORD     TO INITIALIZED-CERTIFICATE.
  7890
  7891     MOVE SPACES                 TO WS-BANK-COMMISSIONS
  7892     PERFORM VARYING IA FROM +1 BY +1 UNTIL
  7893        IA > +10
  7894        MOVE ZEROS               TO WS-BNK-SPP-FEES (IA)
  7895     END-PERFORM
  7896     MOVE WS-BANK-COMMISSIONS    TO WS-BANK-INIT
  7897
  7898     MOVE LOW-VALUES   TO ACCOUNT-MASTER   CERTIFICATE-RECORD.
  7899
  7900     MOVE HIGH-VALUES  TO REIN-HOLD-AREAS  RC-REIN-HOLD-AREAS
  7901                          EPEC-TOTALS      EPEC-SUBS
  7902                          EPEC-UNDERWRITTEN-TOTALS.
  7903
  7904     MOVE ZEROS        TO EPEC-LEVELS-END  EPEC-SUBS-END
  7905                          EPEC-LEVELS-END-II.
  7906     MOVE SPACES       TO REIN-LEVELS-END  RC-REIN-LEVELS-END
  7907                          DUPE-CERT-TABLE.
  7908
  7909     PERFORM CLEAR-REIN-HOLD        THRU CLEAR-REIN-HOLD-X.
  7910     PERFORM 4550-CLEAR-EPEC-TOTALS THRU 4589-CLEAR-EPEC-TOTALS-X.
  7911     PERFORM 5900-CLEAR-TOTAL-PAGES THRU 5999-CLEAR-TOTAL-PAGES-X
  7912                VARYING SUB6 FROM 1 BY 1 UNTIL SUB6 GREATER 6.
  7913     PERFORM 7900-CLEAR-BILLING-TABLE THRU 7999-CLEAR-BILLING-X
  7914                VARYING B-SUB FROM 1 BY 1 UNTIL B-SUB GREATER 50.
  7915
  7916     IF RUN-DATE NOT = EP-DT
  7917         MOVE '*'                     TO TR-YRASK.
  7918     MOVE LIFE-OVERRIDE-L6            TO TR-7-LF.
  7919     MOVE LIFE-OVERRIDE-L2            TO DET-LF-DESC.
  7920     MOVE AH-OVERRIDE-L6              TO TR-7-AH.
  7921     MOVE AH-OVERRIDE-L2              TO DET-AH-DESC.
  7922
  7923     IF DTE-CLIENT = 'FIA' OR 'TAO' OR 'PEK'
  7924         MOVE +1000                   TO DUP-MAX.
  7925
  7926     MOVE DTE-CLIENT                  TO ME-COMPANY.
  7927     MOVE MONTH-END-MOYR              TO ME-MOYR.
  7928     IF ME-DO-UPDATE
  7929         READ ERMEBL-INOUT INVALID KEY
  7930                       CLOSE ERMEBL-INOUT
  7931                       MOVE 'N'       TO ME-UPDATE-FLAG.
  7932
  7933     GO TO 0150-READ-ACCOUNT-MASTER.
  7934
  7935 0090-EXIT.
  7936     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 155
* ECS010P.cbl
  7938 0095-GET-EOM-DATES.
  7939
  7940     MOVE W-WORK-DATE            TO DC-BIN-DATE-1.
  7941     MOVE '6'                    TO DC-OPTION-CODE.
  7942     MOVE 1                      TO DC-ELAPSED-MONTHS
  7943                                    DC-END-OF-MONTH.
  7944     MOVE ZEROS                  TO DC-ELAPSED-DAYS.
  7945     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
  7946
  7947     IF  DC-ERROR-CODE NOT EQUAL SPACES
  7948         MOVE '**** EOM PLUS 1 DATE CALC ERROR ****'
  7949                                 TO WS-ABEND-MESSAGE
  7950         MOVE '90'               TO ABEND-CODE-1
  7951         MOVE '0'                TO AC2-ONE
  7952         MOVE DC-ERROR-CODE      TO AC2-TWO
  7953         MOVE WS-ABEND-CODE      TO WS-RETURN-CODE
  7954         GO TO ABEND-PGM.
  7955
  7956     MOVE DC-BIN-DATE-2          TO  W-WORK-DATE
  7957                                     DC-BIN-DATE-1.
  7958     MOVE SPACES                 TO  DC-BIN-DATE-2.
  7959     MOVE ' '                    TO  DC-OPTION-CODE.
  7960     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
  7961
  7962     IF  DC-ERROR-CODE NOT EQUAL SPACES
  7963         MOVE '**** YMD EOM DATE CALC ERROR ****'
  7964                                 TO WS-ABEND-MESSAGE
  7965         MOVE '90'               TO ABEND-CODE-1
  7966         MOVE '0'                TO AC2-ONE
  7967         MOVE DC-ERROR-CODE      TO AC2-TWO
  7968         MOVE WS-ABEND-CODE      TO WS-RETURN-CODE
  7969         GO TO ABEND-PGM.
  7970
  7971     MOVE DC-GREG-DATE-CYMD      TO  EOM-DATE (SUBM).
  7972
  7973 0095-EXIT.
  7974     EXIT.
  7975
  7976 0096-DISPLAY-EOM-DATES.
  7977
  7978     DISPLAY SUBM '. ' EOM-DATE (SUBM).
  7979
  7980 0096-EXIT.
  7981     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 156
* ECS010P.cbl
  7983******************************************************************
  7984***    R E A D   A C C O U N T   M A S T E R   R O U T I N E   ***
  7985******************************************************************
  7986
  7987 0100-ACCT-MASTER-READ-ROUTINE.
  7988
  7989     IF EP-FLG = '1'
  7990        ADD +1                   TO BC-ACT-ACCTS
  7991        IF DTE-OPT-RESERVE-METHOD-AUTH
  7992           PERFORM 4700-CALC-OPT-IBNR
  7993                                 THRU 4700-EXIT
  7994        END-IF
  7995        PERFORM 4500-BUILD-EPEC-EXTRACT
  7996                                 THRU 4599-BUILD-EPEC-EXTRACT-X
  7997     END-IF
  7998
  7999     IF TRANSACTION-WAS-PROCESSED
  8000         MOVE '1'                     TO ACCT-FLG
  8001                                         STATE-FLG
  8002                                         COMP-FLG
  8003                                         CARR-FLG
  8004                                         FINAL-FLG.
  8005
  8006 0150-READ-ACCOUNT-MASTER.
  8007
  8008     READ ERACCTT-IN AT END
  8009         GO TO 9930-EOJ-3.
  8010
  8011     ADD +1                            TO ERACCTT-READS.
  8012
* 8013     COPY ELCACCTI.
  8014******************************************************************04/14/98
  8015*                                                                *ELCACCTI
  8016*                            ELCACCTI                            *   LV003
  8017*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
  8018*                            VMOD=2.001                          *ELCACCTI
  8019*                                                                *ELCACCTI
  8020*   COPY FILE VARIABLES TO WORKING STORAGE                       *ELCACCTI
  8021*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCACCTI
  8022*                                                                *ELCACCTI
  8023*  NO  CID  MODS  IN  COPYBOOK  ELCACCTI                         *ELCACCTI
  8024*                                                                *ELCACCTI
  8025******************************************************************ELCACCTI
  8026     MOVE AM-EXPIRE-DT           TO  WS-AM-EXPIRE-DT-N.              CL**2
  8027     MOVE AM-VG-EXP-DATE         TO  WS-AM-VG-EXP-DATE-N.            CL**2
  8028     MOVE AM-EFFECT-DT           TO  WS-AM-EFFECT-DT-N.              CL**2
  8029     MOVE AM-PREV-EXP-DT         TO  WS-AM-PREV-EXP-DT-N.            CL**2
  8030     MOVE AM-PREV-EFF-DT         TO  WS-AM-PREV-EFF-DT-N             CL**2
  8031     MOVE AM-ANNIVERSARY-DATE    TO  WS-AM-ANNIVERSARY-DATE-N.       CL**2
  8032     MOVE AM-HI-CERT-DATE        TO  WS-AM-HI-CERT-DATE-N.           CL**2
  8033     MOVE AM-LO-CERT-DATE        TO  WS-AM-LO-CERT-DATE-N.           CL**2
  8034     MOVE AM-ENTRY-DATE          TO  WS-AM-ENTRY-DATE-N.             CL**2
  8035
  8036     IF FIRST-ACCOUNT EQUAL +1
  8037        MOVE +0                  TO FIRST-ACCOUNT
  8038        GO TO 0190-PROCESS-NEW-ACCOUNT.
  8039
  8040     IF AM-CARRIER NOT = HLD-CARRIER
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 157
* ECS010P.cbl
  8041         PERFORM 5400-CARR-BREAK THRU 5499-CARR-BREAK-X
  8042     ELSE
  8043     IF AM-GROUPING NOT = HLD-GROUPING
  8044         PERFORM 5300-COMP-BREAK THRU 5399-COMP-BREAK-X
  8045     ELSE
  8046     IF AM-STATE NOT = HLD-STATE
  8047         PERFORM 5200-STATE-BREAK THRU 5299-STATE-BREAK-X
  8048     ELSE
  8049     IF AM-ACCOUNT NOT = HLD-ACCT
  8050         PERFORM 5100-ACCOUNT-BREAK THRU 5199-ACCOUNT-BREAK-X
  8051     ELSE
  8052     PERFORM 5000-DATE-RANGE-BREAK THRU 5099-DATE-RANGE-BREAK-X.
  8053
  8054     IF (AM-CARRIER NOT = HLD-CARRIER) OR
  8055        (AM-GROUPING NOT = HLD-GROUPING)
  8056         PERFORM 7000-CLIENT-BILLING-ROUTINE THRU 7099-BILL-X.
  8057
  8058 0190-PROCESS-NEW-ACCOUNT.
  8059
  8060     IF AM-CARRIER NOT = HLD-CARRIER
  8061         PERFORM 0199A-CARRIER-TABLE-LOOKUP THRU 0199A-LOOKUP-XIT.
  8062
  8063     MOVE AM-CONTROL-A          TO HLD-CONTROL.
  8064     MOVE AM-CARRIER            TO TR-CARR.
  8065     MOVE AM-GROUPING           TO TR-GROUP.
  8066     MOVE AM-ACCOUNT            TO TR-AG-NO.
  8067     MOVE AM-NAME               TO TR-AGCY.
  8068     MOVE AM-EFF-MO             TO TR-CE-MO.
  8069     MOVE AM-EFF-DA             TO TR-CE-DA.
  8070     MOVE AM-EFF-YR             TO TR-CE-YR.
  8071     MOVE AM-STATE              TO TR-ST-NO.
  8072     IF AM-EXPIRE-DT =  99999999999
  8073         MOVE 'CURRENT '        TO TR-CX
  8074     ELSE
  8075         MOVE AM-EXP-MO         TO TR-CX-MO
  8076         MOVE AM-EXP-DA         TO TR-CX-DA
  8077         MOVE AM-EXP-YR         TO TR-CX-YR
  8078         MOVE '-'               TO HSHR1  HSHR2.
  8079
  8080     ADD +1 TO BC-ACCTS.
  8081
  8082     IF AM-RECORD-ID = '**'
  8083         ADD +1 TO BC-NEW-ACCTS.
  8084     IF AM-RET-Y-N = 'Y' OR 'I' OR 'G' OR 'L' OR 'D'
  8085         ADD +1 TO BC-ER-ACCTS.
  8086
  8087     MOVE ZEROS                 TO SV-LO-CERT
  8088                                   SV-HI-CERT.
  8089     MOVE SPACE                 TO TRANSACTION-FLAG
  8090                                   LST-TRD-CERT
  8091                                   LST-TRD-ISDT
  8092                                   OB-DATE-1-SWITCH
  8093                                   OB-DATE-2-SWITCH
  8094                                   OB-DATE-3-SWITCH.
  8095     MOVE +81                   TO LN-CNT.
  8096
  8097 0199-READ-ACCOUNT-X.
  8098     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 158
* ECS010P.cbl
  8099
  8100 0199A-CARRIER-TABLE-LOOKUP.
  8101
  8102     PERFORM 0199B-SEARCH-CARRIER-TABLE
  8103            VARYING CLAS-INDEXCN FROM 1 BY 1
  8104         UNTIL AM-CARRIER = CARRIER-SUB (CLAS-INDEXCN)  OR
  8105               CLAS-INDEXCN GREATER CLAS-MAXCN.
  8106
  8107     IF CLAS-INDEXCN GREATER CLAS-MAXCN
  8108         DISPLAY 'CARRIER NOT IN CARRIER NAME TABLE: ' AM-CARRIER
  8109         MOVE '** CARRIER NOT IN CARRIER NAME TABLE **'
  8110                                 TO WS-ABEND-MESSAGE
  8111         MOVE 4004               TO WS-ABEND-CODE
  8112         MOVE WS-ABEND-CODE      TO WS-RETURN-CODE
  8113         GO TO ABEND-PGM.
  8114
  8115 0199A-LOOKUP-XIT.
  8116     EXIT.
  8117 0199B-SEARCH-CARRIER-TABLE.
  8118     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 159
* ECS010P.cbl
  8120******************************************************************
  8121***       R E A D   C E R T   M A S T E R   R O U T I N E      ***
  8122******************************************************************
  8123
  8124 0200-CERT-MASTER-READ-ROUTINE.
  8125
  8126     IF EOF-ON-CERT
  8127         GO TO 0299-READ-CERT-X.
  8128
  8129     IF FIRST-CERT EQUAL +1
  8130        MOVE +0                  TO FIRST-CERT
  8131        GO TO 0250-READ-CERT-MASTER.
  8132
  8133     MOVE CERT-IN-RECORD             TO CERTIFICATE-RECORD.
  8134
  8135     PERFORM CERT-DATE-LOAD.
  8136
  8137     IF CR-IND-GRP = 'I'  OR  '1'
  8138         MOVE '1'                    TO CR-IND-GRP
  8139     ELSE
  8140         MOVE '2'                    TO CR-IND-GRP.
  8141
  8142     IF CR-LF-REI-RISK-PRM NOT NUMERIC
  8143         MOVE ZEROS                TO CR-LF-REI-RISK-PRM.
  8144     IF CR-AH-REI-RISK-PRM NOT NUMERIC
  8145         MOVE ZEROS                TO CR-AH-REI-RISK-PRM.
  8146
  8147************ TEMP CODE TO INITIALIZE RISK PREM FIELDS ************
  8148     IF DTE-CLIENT NOT = 'NSL'
  8149         MOVE ZEROS                TO CR-LF-REI-RISK-PRM
  8150                                      CR-AH-REI-RISK-PRM.
  8151******************************************************************
  8152
  8153     IF CR-CLAIM-DEDUCT-WITHHELD NOT NUMERIC
  8154         MOVE ZEROS                TO CR-CLAIM-DEDUCT-WITHHELD.
  8155     IF CR-CANCEL-DEDUCT-WITHHELD NOT NUMERIC
  8156         MOVE ZEROS                TO CR-CANCEL-DEDUCT-WITHHELD.
  8157
  8158     MOVE CR-STATE                   TO STATE-L.
  8159     PERFORM 8200-STATE-CODE-LOOKUP THRU 8299-STATE-LOOKUP-X.
  8160
  8161     IF CR-LFTYP NOT = ZERO
  8162         MOVE CR-LFTYP               TO CLAS-LOOK
  8163         PERFORM 8300-LIFE-TYPE-LOOKUP THRU 8399-LIFE-LOOKUP-X.
  8164
  8165     IF CR-AHTYP NOT = ZERO
  8166         MOVE CR-AHTYP               TO CLAS-LOOK
  8167         PERFORM 8400-A-H-TYPE-LOOKUP THRU 8499-A-H-LOOKUP-X.
  8168
  8169     MOVE CR-DT                  TO DC-GREG-DATE-CYMD
  8170     MOVE 'L'                    TO DC-OPTION-CODE
  8171     MOVE +0                     TO DC-ELAPSED-MONTHS
  8172                                    DC-ELAPSED-DAYS
  8173     PERFORM 8000-DATE-CONVERT-ROUTINE
  8174                                 THRU 8099-DATE-CONVERT-X
  8175     MOVE DC-BIN-DATE-1          TO WS-CR-BIN-DATE
  8176
  8177     IF (DTE-CLIENT = 'DCC')
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 160
* ECS010P.cbl
  8178        AND (CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'G' OR 'L')
  8179        PERFORM 0395-GET-CERT-TRLRS
  8180                                 THRU 0395-EXIT
  8181     END-IF
  8182
  8183     IF RUN-MO NOT = 01
  8184         GO TO 0250-READ-CERT-MASTER.
  8185
  8186     MOVE ZERO                 TO CR-DTHAMT-YTD  CR-DISAMT-YTD
  8187                                  CR-DTHEXP-YTD  CR-DISEXP-YTD.
  8188
  8189     IF ((CR-LFTYP NOT = ZERO)  AND
  8190         (CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'Z'))  OR
  8191        ((CR-AHTYP NOT = ZERO)  AND
  8192         (CLAS-I-CALC-TYPE (CLAS-INDEXA) = 'Z'))
  8193           MOVE ZERO           TO CR-SUM-CAN-CNT-YTD.
  8194
  8195     .
  8196 0250-READ-CERT-MASTER.
  8197
  8198     READ CERT-MASTER-IN
  8199               AT END GO TO 9920-EOJ-2.
  8200
  8201     ADD +1 TO CMIN-CNT.
  8202
  8203     IF CIR-CONTROL LESS THAN PRIOR-CERT-IN-CNTRL
  8204         DISPLAY 'SEQUENCE ERROR ON CERT MASTER'
  8205         DISPLAY 'FIRST  - '  PRIOR-CERT-IN-CNTRL
  8206         DISPLAY 'SECOND - '  CIR-CONTROL
  8207         MOVE 0612                    TO WS-ABEND-CODE
  8208         MOVE WS-ABEND-CODE           TO WS-RETURN-CODE
  8209         GO TO ABEND-PGM.
  8210
  8211     IF CIR-CONTROL = PRIOR-CERT-IN-CNTRL
  8212         DISPLAY 'DUPLICATE CERT ON FILE'  PRIOR-CERT-IN-CNTRL
  8213         IF DTE-CLIENT EQUAL 'SEN'
  8214            GO TO 0250-READ-CERT-MASTER
  8215         ELSE
  8216            MOVE 'DUPLICATE CERT ON FILE'
  8217                                      TO WS-ABEND-MESSAGE
  8218            MOVE 0302                 TO WS-ABEND-CODE
  8219            MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
  8220            GO TO ABEND-PGM.
  8221
  8222******************************************************
  8223*   THIS LOGIC WAS ADDED TO ACCOMMODATE THE EXECUTION
  8224*   OF A "MID MONTH" BILLING REPORT (EL562) FOR
  8225*   COMMERCIAL FEDERAL BANK AND PEOPLES TRUST
  8226******************************************************
  8227     IF DTE-CLIENT = 'CID'
  8228        IF COMPANY-NAME = '      COMMERCIAL FEDERAL'
  8229           IF (CF-THIRD-AGENT  = '0000713100') OR
  8230              (CF-FOURTH-AGENT = '0000713100')
  8231              CONTINUE
  8232           ELSE
  8233              GO TO 0250-READ-CERT-MASTER
  8234           END-IF
  8235        ELSE
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 161
* ECS010P.cbl
  8236           IF COMPANY-NAME = '        PEOPLES TRUST'
  8237              IF CI-ACCOUNT = '0000845800'
  8238                 CONTINUE
  8239              ELSE
  8240                 GO TO 0250-READ-CERT-MASTER
  8241              END-IF
  8242           ELSE
  8243              IF COMPANY-NAME = '        SUNFLOWER BANK'
  8244                 IF (CF-THIRD-AGENT  = '0000681700') OR
  8245                    (CF-FOURTH-AGENT = '0000681700')
  8246                    CONTINUE
  8247                 ELSE
  8248                    GO TO 0250-READ-CERT-MASTER
  8249                 END-IF
  8250              ELSE
  8251                 IF COMPANY-NAME = '      FIRST PREMIER BANK'
  8252                    IF CI-ACCOUNT = '0001107200'
  8253                       CONTINUE
  8254                    ELSE
  8255                       GO TO 0250-READ-CERT-MASTER
  8256                    END-IF
  8257                 END-IF
  8258              END-IF
  8259           END-IF
  8260        END-IF
  8261     END-IF
  8262
  8263******************************************************
  8264     MOVE CIR-CONTROL                 TO PRIOR-CERT-IN-CNTRL.
  8265
  8266 0299-READ-CERT-X.
  8267     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 162
* ECS010P.cbl
  8269******************************************************************
  8270***     R E A D   P E N D I N G   F I L E   R O U T I N E      ***
  8271******************************************************************
  8272
  8273 0300-READ-PENDING-TRANSACTIONS.
  8274
  8275     READ PENDING-EXTRACT
  8276                   AT END GO TO 9910-EOJ-1.
  8277
  8278     MOVE SPACE                    TO PENDING-RECORD-TYPE.
  8279
  8280     IF NOT ED-PENDING-BUSINESS  AND
  8281        NOT ED-PENDING-CLAIMS  AND
  8282        NOT ED-CERT-CHANGES
  8283           DISPLAY 'INVALID EXTRACT TYPE INTO ECS010 - TYPE = '
  8284                                               ED-RECORD-TYPE
  8285           MOVE 0301                        TO WS-ABEND-CODE
  8286           MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
  8287           GO TO ABEND-PGM.
  8288
  8289     PERFORM 0310-SET-UP-MATCHING-KEY THRU 0310-EXIT.
  8290
  8291     IF DTE-CLIENT = 'NCL'
  8292         IF PEND-MATCH-EFF-DTE LESS THAN 19400101
  8293             DISPLAY 'TRANS DROPPED: ' PENDING-MATCH-CONTROL
  8294                     '  TRANS TYPE: ' PENDING-RECORD-TYPE
  8295             GO TO 0300-READ-PENDING-TRANSACTIONS.
  8296
  8297     IF PENDING-MATCH-CONTROL  LESS THAN  PRIOR-MATCH-CNTRL
  8298         DISPLAY 'SEQUENCE ERROR ON TRANSACTION FILE'
  8299         DISPLAY ' PRIOR SEQ.   = '  PRIOR-MATCH-CNTRL
  8300         DISPLAY ' CURRENT SEQ. = '  PENDING-MATCH-CONTROL
  8301         MOVE 0603                    TO WS-ABEND-CODE
  8302         MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
  8303         GO TO ABEND-PGM.
  8304
  8305     ADD +1 TO TR-CNT.
  8306
  8307     IF ISSUE-TRANSACTION   OR
  8308        CANCEL-TRANSACTION  OR
  8309        CLAIM-TRANSACTION   OR
  8310        RESERVE-TRANSACTION OR
  8311        UPDATE-TRANSACTION
  8312         MOVE PENDING-MATCH-CONTROL   TO PRIOR-MATCH-CNTRL
  8313         GO TO 0330-MATCH-PENDING-TO-CERT.
  8314
  8315     DISPLAY 'INVALID TRANSACTION INTO ECS010 '.
  8316
  8317     DISPLAY 'INVALID TRANSACTION INTO ECS010 '.
  8318     DISPLAY '  MATCH CONTROL: ' PENDING-MATCH-CONTROL ' TYPE: ('
  8319             PENDING-RECORD-TYPE ')'.
  8320
  8321     MOVE 0301                   TO WS-ABEND-CODE.
  8322     MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
  8323     GO TO ABEND-PGM.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 163
* ECS010P.cbl
  8325 0310-SET-UP-MATCHING-KEY.
  8326
  8327     IF ED-PENDING-BUSINESS
  8328         MOVE ED-DATA-AREAS      TO PENDING-BUSINESS
  8329         MOVE PB-CARRIER         TO PEND-MATCH-CARRIER
  8330         MOVE PB-GROUPING        TO PEND-MATCH-GROUPING
  8331         MOVE PB-STATE           TO PEND-MATCH-STATE
  8332         MOVE PB-ACCOUNT         TO PEND-MATCH-ACCOUNT
  8333         MOVE PB-CERT-EFF-DT     TO DC-BIN-DATE-1
  8334         MOVE PB-CERT-NO         TO PEND-MATCH-CERT-NO
  8335         MOVE PB-RECORD-TYPE     TO PENDING-RECORD-TYPE.
  8336
  8337     IF ED-PENDING-CLAIMS
  8338         ADD +1                  TO W-PENDING-CLMS
  8339         MOVE ED-DATA-AREAS      TO PENDING-CLAIMS
  8340         MOVE PC-CARRIER         TO PEND-MATCH-CARRIER
  8341         MOVE PC-GROUPING        TO PEND-MATCH-GROUPING
  8342         MOVE PC-STATE           TO PEND-MATCH-STATE
  8343         MOVE PC-ACCOUNT         TO PEND-MATCH-ACCOUNT
  8344         MOVE PC-CERT-EFF-DT     TO DC-BIN-DATE-1
  8345         MOVE PC-CERT-NO         TO PEND-MATCH-CERT-NO
  8346         IF PC-CLAIMS
  8347             MOVE '3'            TO PENDING-RECORD-TYPE
  8348         ELSE
  8349             IF PC-RESERVES
  8350                 MOVE '4'        TO PENDING-RECORD-TYPE.
  8351
  8352     IF ED-CERT-CHANGES
  8353         MOVE ED-DATA-AREAS      TO PENDING-MAINT-TO-CERT-FILE
  8354         MOVE CC-CARRIER         TO PEND-MATCH-CARRIER
  8355         MOVE CC-GROUPING        TO PEND-MATCH-GROUPING
  8356         MOVE CC-STATE           TO PEND-MATCH-STATE
  8357         MOVE CC-ACCOUNT         TO PEND-MATCH-ACCOUNT
  8358         MOVE CC-CERT-EFF-DT     TO DC-BIN-DATE-1
  8359         MOVE CC-CERT-NO         TO PEND-MATCH-CERT-NO
  8360         MOVE '5'                TO PENDING-RECORD-TYPE.
  8361
  8362     MOVE ' '                    TO DC-OPTION-CODE.
  8363     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
  8364     MOVE DC-GREG-DATE-CYMD      TO PEND-MATCH-EFF-DTE.
  8365
  8366 0310-EXIT.
  8367     EXIT.
  8368
  8369******************************************************************
  8370***    M A T C H   P E N D I N G   F I L E   T O   C E R T     ***
  8371******************************************************************
  8372
  8373 0330-MATCH-PENDING-TO-CERT.
  8374
  8375     IF PENDING-MATCH-CONTROL  LESS THAN  CR-FULL-CONTROL
  8376         GO TO 0390-CERT-MISMATCH-ERROR.
  8377
  8378     IF PENDING-MATCH-CONTROL  EQUAL   CR-FULL-CONTROL
  8379       IF CLAIM-TRANSACTION
  8380         IF NOT PC-CHARGEBLE-EXPENSE  AND
  8381            NOT PC-NON-CHARGEBLE-EXPENSE
  8382             IF ((PC-CLAIM-TYPE = '1' OR '3') AND CR-LFTYP = '00')
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 164
* ECS010P.cbl
  8383                                      OR
  8384                ((PC-CLAIM-TYPE = '2' OR '4') AND CR-AHTYP = '00')
  8385                  GO TO 0390-CERT-MISMATCH-ERROR.
  8386
  8387     IF PENDING-MATCH-CONTROL  EQUAL   CR-FULL-CONTROL
  8388       IF RESERVE-TRANSACTION
  8389         IF ((PC-CLAIM-TYPE = '1' OR '3') AND CR-LFTYP = '00')
  8390                                  OR
  8391            ((PC-CLAIM-TYPE = '2' OR '4') AND CR-AHTYP = '00')
  8392              GO TO 0390-CERT-MISMATCH-ERROR.
  8393
  8394     IF PENDING-MATCH-CONTROL  EQUAL   CR-FULL-CONTROL
  8395         IF ISSUE-TRANSACTION
  8396             GO TO 0380-DUPLICATE-CERT-ERROR
  8397         ELSE
  8398             GO TO 0350-MATCH-PENDING-TO-ACCOUNT.
  8399
  8400     IF PENDING-MATCH-CONTROL  NOT LESS THAN  CIR-CONTROL
  8401         PERFORM 0400-WRITE-CERT-RECORD THRU 0499-WRITE-CERT-X
  8402         PERFORM 0200-CERT-MASTER-READ-ROUTINE THRU
  8403                                               0299-READ-CERT-X
  8404         GO TO 0330-MATCH-PENDING-TO-CERT.
  8405
  8406     IF ISSUE-TRANSACTION
  8407         PERFORM 0400-WRITE-CERT-RECORD THRU 0499-WRITE-CERT-X
  8408     ELSE
  8409         GO TO 0390-CERT-MISMATCH-ERROR.
  8410
  8411 0350-MATCH-PENDING-TO-ACCOUNT.
  8412
  8413     IF PENDING-ACCOUNT-CONTROL LESS THAN AM-CONTROL-A
  8414       ADD +1  TO ERROR-COUNT
  8415         MOVE    '*** MISMATCH BETWEEN PENDING TRAN AND ACCOUNT'
  8416           TO  DL-FULL
  8417             PERFORM 8600-DISPLAY-PRT  THRU  8600-DISPLAY-EXIT
  8418         MOVE    ' PENDING CONTROL = '
  8419           TO  DIS-LINE-REASON
  8420         MOVE  PENDING-MATCH-CONTROL
  8421           TO  DIS-LINE-REC
  8422             PERFORM 8600-DISPLAY-PRT  THRU  8600-DISPLAY-EXIT
  8423         MOVE    ' KEY OF PENDING REC BYPASSED - '
  8424           TO  DIS-LINE-REASON
  8425         MOVE  PENDING-MATCH-CONTROL
  8426           TO  DIS-LINE-REC
  8427             PERFORM 8600-DISPLAY-PRT  THRU  8600-DISPLAY-EXIT
  8428         MOVE  SPACES
  8429           TO  DISPLAY-LINE
  8430             PERFORM 8600-DISPLAY-PRT  THRU  8600-DISPLAY-EXIT
  8432         DISPLAY '*** MISMATCH BETWEEN PENDING TRAN AND ACCOUNT'
  8433         DISPLAY '    PENDING CONTROL = ' PENDING-MATCH-CONTROL
  8434         DISPLAY 'PENDING REC BYPASSED - ' PENDING-MATCH-CONTROL
  8435         DISPLAY 'TRAN TYPE =   '  PENDING-RECORD-TYPE
  8436         DISPLAY '  TYPE  1=ISS   2=CAN   3=CLM   4=RSV   5=CHG'
  8437         DISPLAY '    ACCOUNT CONTROL = '
  8438         AM-MSTR-CNTRL AM-EFFECT-DT
  8439         IF DTE-CLIENT = 'UAL'  OR  'NCL' OR 'CID'
  8440            DISPLAY 'TRANS BYPASSED.... CLIENT = ' DTE-CLIENT
  8441            GO TO 0300-READ-PENDING-TRANSACTIONS
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 165
* ECS010P.cbl
  8442         ELSE
  8443            MOVE 'MISMATCH BETWEEN PENDING TRAN AND ACCOUNT'
  8444                                      TO WS-ABEND-MESSAGE
  8445            MOVE 0302 TO WS-ABEND-CODE
  8446            MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
  8447            GO TO ABEND-PGM.
  8448
  8449     IF PENDING-ACCOUNT-CONTROL GREATER AM-CONTROL-A
  8450         PERFORM 0100-ACCT-MASTER-READ-ROUTINE THRU
  8451                                              0199-READ-ACCOUNT-X
  8452         GO TO 0350-MATCH-PENDING-TO-ACCOUNT.
  8453
  8454     IF PEND-MATCH-EFF-DTE NOT LESS THAN AM-EFFECT-DT  AND
  8455        PEND-MATCH-EFF-DTE LESS THAN AM-EXPIRE-DT
  8456         GO TO 0500-APPLY-PENDING-BUSINESS.
  8457
  8458     PERFORM 0100-ACCT-MASTER-READ-ROUTINE THRU
  8459                                       0199-READ-ACCOUNT-X.
  8460     GO TO 0350-MATCH-PENDING-TO-ACCOUNT.
  8461
  8462
  8463 0370-ACCOUNT-MISMATCH-ERROR.
  8464
  8465     DISPLAY 'MISMATCH ACCOUNT ERROR'
  8466     DISPLAY '    ACCOUNT CONTROL = ' AM-MSTR-CNTRL AM-EFFECT-DT.
  8467     MOVE 'MISMATCH ACCOUNT ERROR'
  8468                               TO WS-ABEND-MESSAGE.
  8469     MOVE 0302 TO WS-ABEND-CODE.
  8470         DISPLAY '******************************'
  8471         DISPLAY '***** ERROR LOCATION 009 *****'
  8472         DISPLAY '******************************'
  8473     MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
  8474     GO TO ABEND-PGM.
  8475
  8476
  8477 0380-DUPLICATE-CERT-ERROR.
  8478
  8479     IF PB-I-OB  OR  PB-I-SUMMARY
  8480         GO TO 0300-READ-PENDING-TRANSACTIONS.
  8481
  8482     ADD +1 TO DUP-CNT.
  8483
  8484     IF DUP-CNT NOT GREATER THAN DUP-MAX
  8485         MOVE CR-FULL-CONTROL           TO DUPE-ENTRY (DUP-CNT)
  8486         COMPUTE DUPE-LF-PRM (DUP-CNT) = PB-I-LF-PREMIUM-AMT +
  8487                                         PB-I-LF-ALT-PREMIUM-AMT
  8488         MOVE  PB-I-AH-PREMIUM-AMT      TO  DUPE-AH-PRM (DUP-CNT)
  8489         MOVE  PB-I-ENTRY-STATUS        TO  DUPE-STATUS (DUP-CNT)
  8490         GO TO 0300-READ-PENDING-TRANSACTIONS.
  8491
  8492     DISPLAY 'MORE THAN ' DUP-MAX ' DUPLICATE ISSUES PROCESSED'.
  8493     GO TO 0300-READ-PENDING-TRANSACTIONS.
  8494
  8495*    MOVE 0301 TO WS-ABEND-CODE.
  8496*    MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
  8497*    GO TO ABEND-PGM.
  8498
  8499
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 166
* ECS010P.cbl
  8500 0390-CERT-MISMATCH-ERROR.
  8501
  8502     IF ISSUE-TRANSACTION  OR
  8503        CANCEL-TRANSACTION  OR
  8504        CLAIM-TRANSACTION
  8505         ADD +1                  TO  MISMATCH-COUNT.
  8506
  8507     IF DTE-CLIENT  =  'CID'  OR  'CSO'
  8508       ADD  +1  TO  ERROR-COUNT
  8509         MOVE    '*** MISMATCH BETWEEN CERT AND TRANS'
  8510           TO  DL-FULL
  8511             PERFORM 8600-DISPLAY-PRT  THRU  8600-DISPLAY-EXIT
  8512         MOVE    ' TRANS CONTROL = '
  8513           TO  DIS-LINE-REASON
  8514         MOVE  PENDING-MATCH-CONTROL
  8515           TO  DIS-LINE-REC
  8516             PERFORM 8600-DISPLAY-PRT  THRU  8600-DISPLAY-EXIT
  8517         MOVE    ' TRANS TYPE    = '
  8518           TO  DIS-LINE-REASON
  8519         MOVE  PENDING-RECORD-TYPE
  8520           TO  DIS-LINE-REC
  8521             PERFORM 8600-DISPLAY-PRT  THRU  8600-DISPLAY-EXIT
  8522         MOVE '  TYPE: 1=ISS   2=CAN   3=CLM   4=RSV   5=CHG'
  8523           TO  DL-FULL
  8524             PERFORM 8600-DISPLAY-PRT  THRU  8600-DISPLAY-EXIT
  8525         MOVE    ' CERT IN CTL   = '
  8526           TO  DIS-LINE-REASON
  8527         MOVE  CIR-CONTROL
  8528           TO  DIS-LINE-REC
  8529             PERFORM 8600-DISPLAY-PRT  THRU  8600-DISPLAY-EXIT
  8530         MOVE    ' BYPASSED TRANS  = '
  8531           TO  DIS-LINE-REASON
  8532         MOVE  PENDING-MATCH-CONTROL
  8533           TO  DIS-LINE-REC
  8534             PERFORM 8600-DISPLAY-PRT  THRU  8600-DISPLAY-EXIT
  8535         MOVE  SPACES
  8536           TO  DISPLAY-LINE
  8537             PERFORM 8600-DISPLAY-PRT  THRU  8600-DISPLAY-EXIT
  8538         DISPLAY 'BYPASSED TRANS = ' PENDING-MATCH-CONTROL.
  8539
  8540     MOVE PENDING-MATCH-CONTROL  TO  DTL-MATCH-CONTROL.
  8541     MOVE PENDING-RECORD-TYPE    TO  DTL-REC-TYPE.
  8542
  8543     IF ISSUE-TRANSACTION
  8544         MOVE 'ISS'              TO  DTL-REC-TYPE-DESC
  8545     ELSE
  8546         IF CANCEL-TRANSACTION
  8547             MOVE 'CAN'          TO  DTL-REC-TYPE-DESC
  8548         ELSE
  8549             IF CLAIM-TRANSACTION
  8550                 MOVE 'CLM'      TO  DTL-REC-TYPE-DESC
  8551             ELSE
  8552                 IF RESERVE-TRANSACTION
  8553                     MOVE 'RES'  TO  DTL-REC-TYPE-DESC
  8554                 ELSE
  8555                     IF UPDATE-TRANSACTION
  8556                         MOVE 'CHG'
  8557                                 TO  DTL-REC-TYPE-DESC.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 167
* ECS010P.cbl
  8558
  8559     MOVE CIR-CONTROL            TO  DTL-CERT-IN-CONTROL.
  8560     MOVE CR-FULL-CONTROL        TO  DTL-CERT-OUT-CONTROL.
  8561     MOVE 'DROPPED'              TO  DTL-STATUS.
  8562
  8563     IF ISSUE-TRANSACTION
  8564         MOVE PB-I-LF-PREMIUM-AMT
  8565                                 TO  MD2-LF-PREM
  8566         MOVE PB-I-LF-ALT-PREMIUM-AMT
  8567                                 TO  MD2-LF-ALT-PREM
  8568         MOVE PB-I-AH-PREMIUM-AMT
  8569                                 TO  MD2-AH-PREM
  8570         ADD PB-I-LF-PREMIUM-AMT TO W-MM-LF-PRM
  8571         ADD PB-I-LF-ALT-PREMIUM-AMT TO W-MM-LF-PRM
  8572         ADD PB-I-AH-PREMIUM-AMT TO W-MM-AH-PRM
  8573     ELSE
  8574         IF CANCEL-TRANSACTION
  8575             MOVE PB-C-LF-CANCEL-AMT
  8576                                 TO  MD3-LF-REFUND
  8577             MOVE PB-C-AH-CANCEL-AMT
  8578                                 TO  MD3-AH-REFUND
  8579             ADD PB-C-LF-CANCEL-AMT TO W-MM-LF-RFD
  8580             ADD PB-C-AH-CANCEL-AMT TO W-MM-AH-RFD
  8581         ELSE
  8582             IF CLAIM-TRANSACTION
  8583                 IF PC-LF-CLAIM  OR  PC-OB-LF-CLAIM
  8584                     MOVE PC-CLAIM-PAYMENT  TO MD4-LF-CLAIM
  8585                     MOVE ZEROS             TO MD4-AH-CLAIM
  8586                     ADD PC-CLAIM-PAYMENT TO W-MM-LF-CLM
  8587                 ELSE
  8588                     MOVE ZEROS             TO MD4-LF-CLAIM
  8589                     MOVE PC-CLAIM-PAYMENT  TO MD4-AH-CLAIM
  8590                     ADD PC-CLAIM-PAYMENT TO W-MM-AH-CLM.
  8591
  8592     IF  MISMATCH-LINE-COUNT GREATER THAN +56
  8593         ADD +1                  TO  MISMATCH-PAGE-NUMBER
  8594         MOVE MISMATCH-PAGE-NUMBER
  8595                                 TO  TR-PG
  8596         MOVE MISMATCH-HEADING-1 TO  MISMATCH-RPT
  8597         MOVE MR-CTL             TO  X
  8598         MOVE X TO LCP-ASA
  8599         PERFORM LCP-WRITE-POS-MISMATCH-RPT
  8600             THRU LCP-WRITE-END-MISMATCH-RPT
  8601         MOVE TR-HD-2            TO  MISMATCH-RPT
  8602         MOVE MR-CTL             TO  X
  8603         MOVE X TO LCP-ASA
  8604         PERFORM LCP-WRITE-POS-MISMATCH-RPT
  8605             THRU LCP-WRITE-END-MISMATCH-RPT
  8606         MOVE TR-HD-3            TO  MISMATCH-RPT
  8607         MOVE MR-CTL             TO  X
  8608         MOVE X TO LCP-ASA
  8609         PERFORM LCP-WRITE-POS-MISMATCH-RPT
  8610             THRU LCP-WRITE-END-MISMATCH-RPT
  8611         MOVE MISMATCH-HEADING-2 TO  MISMATCH-RPT
  8612         MOVE MR-CTL             TO  X
  8613         MOVE X TO LCP-ASA
  8614         PERFORM LCP-WRITE-POS-MISMATCH-RPT
  8615             THRU LCP-WRITE-END-MISMATCH-RPT
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 168
* ECS010P.cbl
  8616         MOVE +6                 TO  MISMATCH-LINE-COUNT.
  8617
  8618     MOVE MISMATCH-DETAIL        TO  MISMATCH-RPT.
  8619     MOVE MR-CTL                 TO  X.
  8620     ADD +2                      TO  MISMATCH-LINE-COUNT.
  8621
  8622     MOVE X TO LCP-ASA
  8623     PERFORM LCP-WRITE-POS-MISMATCH-RPT
  8624         THRU LCP-WRITE-END-MISMATCH-RPT.
  8625
  8626     IF ISSUE-TRANSACTION
  8627         MOVE MISMATCH-DETAIL-2  TO  MISMATCH-RPT
  8628         MOVE MR-CTL             TO  X
  8629         ADD +1                  TO  MISMATCH-LINE-COUNT
  8630         MOVE X TO LCP-ASA
  8631         PERFORM LCP-WRITE-POS-MISMATCH-RPT
  8632             THRU LCP-WRITE-END-MISMATCH-RPT.
  8633
  8634     IF CANCEL-TRANSACTION
  8635         MOVE MISMATCH-DETAIL-3  TO  MISMATCH-RPT
  8636         MOVE MR-CTL             TO  X
  8637         ADD +1                  TO  MISMATCH-LINE-COUNT
  8638         MOVE X TO LCP-ASA
  8639         PERFORM LCP-WRITE-POS-MISMATCH-RPT
  8640             THRU LCP-WRITE-END-MISMATCH-RPT.
  8641
  8642     IF CLAIM-TRANSACTION
  8643         MOVE MISMATCH-DETAIL-4  TO  MISMATCH-RPT
  8644         MOVE MR-CTL             TO  X
  8645         ADD +1                  TO  MISMATCH-LINE-COUNT
  8646         MOVE X TO LCP-ASA
  8647         PERFORM LCP-WRITE-POS-MISMATCH-RPT
  8648             THRU LCP-WRITE-END-MISMATCH-RPT.
  8649
  8650     MOVE SPACES                 TO  MISMATCH-RPT.
  8651
  8652     GO TO 0300-READ-PENDING-TRANSACTIONS.
  8653
  8654 0395-GET-CERT-TRLRS.
  8655
  8656     MOVE WS-BANK-INIT           TO WS-BANK-COMMISSIONS
  8657     MOVE DTE-CLASIC-COMPANY-CD  TO CS-COMPANY-CD
  8658     MOVE CR-CARRIER             TO CS-CARRIER
  8659     MOVE CR-GROUPING            TO CS-GROUPING
  8660     MOVE CR-STATE               TO CS-STATE
  8661     MOVE CR-ACCOUNT             TO CS-ACCOUNT
  8662     MOVE WS-CR-BIN-DATE         TO CS-CERT-EFF-DT
  8663     MOVE CR-CERT-NO             TO CS-CERT-NO
  8664     MOVE 'A'                    TO CS-TRAILER-TYPE
  8665
  8666     READ ELCRTT
  8667
  8668     IF ELCRTT-FILE-STATUS = '00'
  8669        MOVE CS-BANK-COMMISSION-AREA
  8670                                 TO WS-BANK-COMMISSIONS
  8671     ELSE
  8672        IF ELCRTT-FILE-STATUS NOT = '10' AND '23'
  8673           DISPLAY ' BAD READ    ELCRTT ' ELCRTT-FILE-STATUS
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 169
* ECS010P.cbl
  8674           PERFORM ABEND-PGM
  8675        END-IF
  8676     END-IF
  8677
  8678     .
  8679 0395-EXIT.
  8680     EXIT.
  8681
  8682******************************************************************
  8683***       W R I T E   C E R T I F I C A T E   R E C O R D      ***
  8684******************************************************************
  8685
  8686 0400-WRITE-CERT-RECORD.
  8687
  8688     IF CERTIFICATE-RECORD = LOW-VALUES
  8689         GO TO 0499-WRITE-CERT-X.
  8690
  8691     IF CR-ACCT-CONTROL LESS THAN AM-CONTROL-A
  8692         DISPLAY '*** MISMATCH BETWEEN CERT MASTER AND ACCOUNT'
  8693         DISPLAY '    CERT. CONTROL = ' CR-FULL-CONTROL
  8694         ADD  +1  TO  ERROR-COUNT
  8695         MOVE    '*** CERT ACCT LESS THAN TRANS ACCT'
  8696           TO  DL-FULL
  8697             PERFORM 8600-DISPLAY-PRT  THRU  8600-DISPLAY-EXIT
  8698         MOVE    ' CERT. CONTROL = '
  8699           TO  DIS-LINE-REASON
  8700         MOVE  CR-FULL-CONTROL
  8701           TO  DIS-LINE-REC
  8702             PERFORM 8600-DISPLAY-PRT  THRU  8600-DISPLAY-EXIT
  8703         MOVE  SPACES
  8704           TO  DISPLAY-LINE
  8705             PERFORM 8600-DISPLAY-PRT  THRU  8600-DISPLAY-EXIT
  8706            WRITE CERT-OUT-RECORD FROM CERTIFICATE-RECORD
  8707            ADD +1 TO CMOT-CNT
  8708            PERFORM 0200-CERT-MASTER-READ-ROUTINE
  8709               GO TO 0400-WRITE-CERT-RECORD.
  8710
  8711*          GO TO 0370-ACCOUNT-MISMATCH-ERROR.
  8712
  8713     IF CR-ACCT-CONTROL GREATER THAN AM-CONTROL-A
  8714         PERFORM 0100-ACCT-MASTER-READ-ROUTINE THRU
  8715                                              0199-READ-ACCOUNT-X
  8716         GO TO 0400-WRITE-CERT-RECORD.
  8717
  8718     IF CR-DT LESS THAN AM-EFFECT-DT  OR
  8719        CR-DT NOT LESS THAN AM-EXPIRE-DT
  8720         PERFORM 0100-ACCT-MASTER-READ-ROUTINE THRU
  8721                                              0199-READ-ACCOUNT-X
  8722         GO TO 0400-WRITE-CERT-RECORD.
  8723
  8724     PERFORM 3000-REINSURE-ROUTINE THRU 3099-REINSURE-ROUTINE-X.
  8725
  8726     IF CR-LFTYP = ZEROS  AND
  8727        CR-DTHEXP NOT = ZEROS
  8728         ADD +1                     TO W-LFTYP-99
  8729         MOVE '99'                  TO CR-LFTYP  CLAS-LOOK
  8730         PERFORM 8300-LIFE-TYPE-LOOKUP THRU 8399-LIFE-LOOKUP-X.
  8731
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 170
* ECS010P.cbl
  8732     IF CR-AHTYP = ZEROS  AND
  8733        CR-DISEXP NOT = ZEROS
  8734         ADD +1                     TO W-AHTYP-99
  8735         MOVE '99'                  TO CR-AHTYP  CLAS-LOOK
  8736         PERFORM 8400-A-H-TYPE-LOOKUP THRU 8499-A-H-LOOKUP-X.
  8737
  8738     PERFORM 4000-EP-BUMP-RTN THRU 4099-EP-BUMP-RTN-X.
  8739
  8740     IF CR-LFTYP = '99'
  8741         MOVE '00'                  TO CR-LFTYP.
  8742     IF CR-AHTYP = '99'
  8743         MOVE '00'                  TO CR-AHTYP.
  8744
  8745     IF CR-ISS-MICROFILM-NO NOT NUMERIC
*  12-S**************************                                      ( 153)**
**    Operand CR-ISS-MICROFILM-NO is not declared
  8746         MOVE ZEROS                 TO CR-ISS-MICROFILM-NO.
*  12-S*********************************************************       ( 170)**
**    Operand CR-ISS-MICROFILM-NO is not declared
  8747
  8748     IF CR-CAN-MICROFILM-NO NOT NUMERIC
*  12-S**************************                                      ( 170)**
**    Operand CR-CAN-MICROFILM-NO is not declared
  8749         MOVE ZEROS                 TO CR-CAN-MICROFILM-NO.
*  12-S*********************************************************       ( 170)**
**    Operand CR-CAN-MICROFILM-NO is not declared
  8750
  8751     IF  CR-POLICY-IS-ACTIVE
  8752         ADD +1                  TO W-POLICY-ACTIVE-CTR
  8753         IF  CR-POLICY-IS-REISSUE
  8754             OR CR-POLICY-IS-MONTHLY
  8755             ADD +1              TO W-POLICY-REISSUE-CTR
  8756         ELSE
  8757             IF  CR-POLICY-IS-REIN-ONLY
  8758                 ADD +1          TO W-POLICY-REIN-CTR
  8759             ELSE
  8760                 NEXT SENTENCE
  8761     ELSE
  8762         ADD +1                  TO W-POLICY-INACTIVE-CTR.
  8763
  8764     IF DTE-PGM-OPT = '1'
  8765       IF REIN-IS-RISK-PREMIUM  AND
  8766          CR-ENTRY-DATE NOT = EOM-RUN-DATE
  8767         IF NOT CR-POLICY-IS-REISSUE  AND
  8768            NOT CR-POLICY-IS-DECLINED  AND
  8769            NOT CR-POLICY-IS-VOID
  8770            AND NOT CR-POLICY-IS-MONTHLY
  8771             MOVE '*'            TO RISK-PREM-FLAG
  8772             PERFORM 3100-REINSURE-ISSUE THRU
  8773                     3199-REINSURE-ISSUE-X.
  8774
* 8775     COPY ELCCRTM2.
  8776******************************************************************04/16/98
  8777*                                                                *ELCCRTM2
  8778*                                                                *ELCCRTM2
  8779*                            ELCCRTM2                            *   LV004
  8780*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
  8781*                            VMOD=2.001                          *ELCCRTM2
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 171
* ECS010P.cbl (/apps/prod/cid1p/copy/ELCCRTM2)
  8782*                                                                *ELCCRTM2
  8783*   COPY WORKING STORAGE TO FILE VARIABLES                       *ELCCRTM2
  8784*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCCRTM2
  8785*                                                                *ELCCRTM2
  8786******************************************************************ELCCRTM2
  8787     MOVE WS-CR-DT-N                 TO  CR-DT.                      CL**2
  8788     MOVE WS-CR-LF-EXPIRE-DATE-N     TO  CR-LF-EXPIRE-DATE.          CL**2
  8789     MOVE WS-CR-AH-EXPIRE-DATE-N     TO  CR-AH-EXPIRE-DATE.          CL**2
  8790     MOVE WS-CR-ENTRY-DATE-N         TO  CR-ENTRY-DATE.              CL**2
  8791     MOVE WS-CR-LF-CANC-DT-N         TO  CR-LF-CANC-DT.              CL**2
  8792     MOVE WS-CR-LF-CANCEL-EXIT-DATE-N TO                             CL**2
  8793                                     CR-LF-CANCEL-EXIT-DATE.         CL**2
  8794     MOVE WS-CR-LF-CLAIM-EXIT-DATE-N TO  CR-LF-CLAIM-EXIT-DATE.      CL**2
  8795     MOVE WS-CR-AH-CANC-DT-N         TO  CR-AH-CANC-DT.              CL**2
  8796     MOVE WS-CR-AH-CANCEL-EXIT-DATE-N TO CR-AH-CANCEL-EXIT-DATE.     CL**2
  8797     MOVE WS-CR-AH-SETTLEMENT-EXIT-DATEN TO                          CL**2
  8798                                  CR-AH-SETTLEMENT-EXIT-DATE.     ELCCRTM2
  8799     MOVE WS-CR-DTH-DT-N             TO  CR-DTH-DT.                  CL**2
  8800     MOVE WS-CR-DTH-PAY-DT-N         TO  CR-DTH-PAY-DT.              CL**2
  8801     MOVE WS-CR-DIS-DT-N             TO  CR-DIS-DT.                  CL**2
  8802     MOVE WS-CR-DIS-PAY-DT-N         TO  CR-DIS-PAY-DT.              CL**2
  8803     MOVE WS-CR-DIS-PTO-DT-N         TO  CR-DIS-PTO-DT.              CL**2
  8804                                                                     CL**4
  8805     PERFORM  VARYING COPY-NDX FROM 1 BY 1                           CL**4
  8806                UNTIL COPY-NDX > 5                                   CL**4
  8807           MOVE WS-CR-DIS-INCUR-DT-N (COPY-NDX)   TO                 CL**2
  8808                                  CR-DIS-INCUR-DT (COPY-NDX)      ELCCRTM2
  8809     END-PERFORM.                                                 ELCCRTM2
  8810                                                                  ELCCRTM2
  8811
  8812     IF DTE-PGM-OPT = '1'
  8813         WRITE CERT-OUT-RECORD FROM CERTIFICATE-RECORD
  8814         ADD +1 TO CMOT-CNT.
  8815
  8816     MOVE SPACE                  TO REIN-FLG
  8817                                    RISK-REIN-FLAG
  8818                                    RISK-PREM-FLAG
  8819                                    RC-COMM-FLG.
  8820
  8821 0499-WRITE-CERT-X.
  8822     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 172
* ECS010P.cbl
  8824******************************************************************
  8825***     A P P L Y   P E N D I N G   T R A N S A C T I O N S    ***
  8826******************************************************************
  8827
  8828 0500-APPLY-PENDING-BUSINESS.
  8829
  8830     IF CANCEL-TRANSACTION
  8831         GO TO 0600-PROCESS-CANCELLATIONS.
  8832
  8833     IF CLAIM-TRANSACTION
  8834         GO TO 0700-PROCESS-CLAIMS.
  8835
  8836     IF RESERVE-TRANSACTION
  8837         GO TO 0800-PROCESS-RESERVES.
  8838
  8839     IF UPDATE-TRANSACTION
  8840         GO TO 0900-PROCESS-CERT-CHANGES.
  8841
  8842******************************************************************
  8843***     P R O C E S S   I S S U E   T R A N S A C T I O N S    ***
  8844******************************************************************
  8845
  8846 0505-PROCESS-ISSUES.
  8847
  8848     MOVE INITIALIZED-CERTIFICATE TO CERTIFICATE-RECORD.
  8849     PERFORM CERT-DATE-LOAD.
  8850
  8851     ADD +1                      TO  W-POL-ISSUES.
  8852
  8853     MOVE PB-COMPANY-CD          TO  CR-COMPANY-CD.
  8854     MOVE PB-CARRIER             TO  CR-CARRIER.
  8855     MOVE PB-GROUPING            TO  CR-GROUPING.
  8856     MOVE PB-STATE               TO  CR-STATE.
  8857     MOVE PB-ACCOUNT             TO  CR-ACCOUNT.
  8858     MOVE PB-CERT-EFF-DT         TO  DC-BIN-DATE-1
  8859                                     WS-CR-BIN-DATE
  8860     MOVE ' '                    TO  DC-OPTION-CODE.
  8861     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
  8862     MOVE DC-GREG-DATE-CYMD      TO  CR-DT
  8863                                     WS-CR-DT-N.
  8864     MOVE PB-CERT-NO             TO  CR-CERT-NO.
  8865
  8866     MOVE PB-I-NAME              TO  CR-NAME.
  8867     MOVE PB-I-AGE               TO  CR-AGE.
  8868     MOVE PB-I-INSURED-SEX       TO  CR-SEX.
  8869     MOVE PB-I-SOC-SEC-NO        TO  CR-SOC-SEC.
  8870
  8871     IF PB-I-JOINT-COVERAGE
  8872         MOVE PB-I-JOINT-INSURED TO  CR-JOINT-NAME
  8873         MOVE PB-I-JOINT-AGE     TO  CR-JOINT-AGE
  8874     ELSE
  8875        IF (DTE-CLIENT EQUAL 'BOA')  AND
  8876           (PB-I-JOINT-INSURED NOT EQUAL SPACES)
  8877             MOVE PB-I-JOINT-INSURED TO  CR-JOINT-NAME.
  8878
  8879     IF PB-I-SUMMARY  OR
  8880        DTE-CLIENT = 'DMD'
  8881         MOVE PB-I-LIVES         TO  CR-LIVES.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 173
* ECS010P.cbl
  8882
  8883     IF PB-I-NUM-BILLED NOT NUMERIC
  8884        MOVE ZEROS               TO PB-I-NUM-BILLED.
  8885
  8886     IF PB-I-STATE-TAX NOT NUMERIC
  8887        MOVE ZEROS               TO PB-I-STATE-TAX.
  8888
  8889     IF PB-I-MUNI-TAX NOT NUMERIC
  8890        MOVE ZEROS               TO PB-I-MUNI-TAX.
  8891     IF PB-I-TOT-FEES NOT NUMERIC
  8892        MOVE ZEROS               TO PB-I-TOT-FEES
  8893     END-IF
  8894     IF PB-I-ADDL-CLP NOT NUMERIC
  8895        MOVE ZEROS               TO PB-I-ADDL-CLP
  8896     END-IF
  8897
  8898     MOVE PB-I-TOT-FEES          TO  CR-MOB-NET-TOT-FEES
  8899     MOVE PB-I-ADDL-CLP          TO  CR-ADDL-CLP
  8900     MOVE PB-I-CLP-STATE         TO  CR-CLP-STATE
  8901     MOVE PB-I-NUM-BILLED        TO  CR-BILLED.
  8902     MOVE PB-I-STATE-TAX         TO  CR-STATE-TAX.
  8903     MOVE PB-I-RESIDENT-STATE    TO  CR-RESIDENT-STATE.
  8904     MOVE PB-I-RATE-CODE         TO  CR-RATE-CODE.
  8905     MOVE PB-I-MUNI-TAX          TO  CR-MUNI-TAX.
  8906     MOVE PB-I-LOAN-APR          TO  CR-APR.
  8907     MOVE PB-I-PAY-FREQUENCY     TO  CR-PMT-FREQ.
  8908     MOVE PB-I-LOAN-TERM         TO  CR-LOAN-TERM.
  8909
  8910     IF PB-I-RATE-CLASS-OVRD = SPACES
  8911         MOVE PB-I-RATE-CLASS    TO  CR-RATING-CLASS
  8912     ELSE
  8913         MOVE PB-I-RATE-CLASS-OVRD TO CR-RATING-CLASS.
  8914
  8915     MOVE PB-I-POLICY-FORM-NO    TO  CR-POLICY-FORM-NO.
  8916     MOVE PB-I-BUSINESS-TYPE     TO  CR-GRPTYP.
  8917
  8918     IF PB-I-INDV-GRP-OVRD = SPACES
  8919         MOVE PB-I-INDV-GRP-CD   TO  CR-IND-GRP
  8920     ELSE
  8921         MOVE PB-I-INDV-GRP-OVRD TO  CR-IND-GRP.
  8922
  8923     IF CR-IND-GRP = 'I'  OR  '1'
  8924         MOVE '1'                TO  CR-IND-GRP
  8925     ELSE
  8926         MOVE '2'                TO  CR-IND-GRP.
  8927
  8928     IF PB-I-SKIP-CODE = '1'
  8929         MOVE 01                 TO  CR-SKIP.
  8930     IF PB-I-SKIP-CODE = '2'
  8931         MOVE 02                 TO  CR-SKIP.
  8932     IF PB-I-SKIP-CODE = '3'
  8933         MOVE 03                 TO  CR-SKIP.
  8934     IF PB-I-SKIP-CODE = '4'
  8935         MOVE 04                 TO  CR-SKIP.
  8936     IF PB-I-SKIP-CODE = '5'
  8937         MOVE 05                 TO  CR-SKIP.
  8938     IF PB-I-SKIP-CODE = '6'
  8939         MOVE 06                 TO  CR-SKIP.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 174
* ECS010P.cbl
  8940     IF PB-I-SKIP-CODE = '7'
  8941         MOVE 07                 TO  CR-SKIP.
  8942     IF PB-I-SKIP-CODE = '8'
  8943         MOVE 08                 TO  CR-SKIP.
  8944     IF PB-I-SKIP-CODE = '9'
  8945         MOVE 09                 TO  CR-SKIP.
  8946     IF PB-I-SKIP-CODE = 'A'
  8947         MOVE 10                 TO  CR-SKIP.
  8948     IF PB-I-SKIP-CODE = 'X'
  8949         MOVE 11                 TO  CR-SKIP.
  8950
  8951     MOVE PB-I-MORT-CODE         TO  CR-MORT.
  8952     MOVE PB-I-MEMBER-NO         TO  CR-MEMBER-NO.
  8953     MOVE PB-I-LOAN-OFFICER      TO  CR-LOAN-OFFICER.
  8954
  8955     IF PB-I-SPECIAL-REIN-CODE NOT = SPACE
  8956         MOVE PB-I-SPECIAL-REIN-CODE TO CR-REIN-SPEC
  8957                                        REIN-SPEC-A
  8958                                        REIN-SPEC-B
  8959                                        REIN-SPEC-C
  8960         MOVE REIN-SPEC          TO CR-REIN-TABLE
  8961     ELSE
  8962         MOVE AM-REI-TABLE       TO CR-REIN-TABLE.
  8963
  8964     MOVE PB-I-1ST-PMT-DT        TO  DC-BIN-DATE-1.
  8965     MOVE ' '                    TO  DC-OPTION-CODE.
  8966     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
  8967     MOVE DC-GREG-DATE-1-YMD     TO  CR-LOAN-1ST-PMT-DT.
  8968
  8969     MOVE PB-I-EXTENTION-DAYS    TO  CR-PMT-EXTENSION-DAYS.
  8970
  8971     IF PB-I-LAST-ADD-ON-DT  =  ZEROS  OR  SPACES
  8972         MOVE LOW-VALUES          TO CR-LAST-ADD-ON-DT
  8973     ELSE
  8974         MOVE PB-I-LAST-ADD-ON-DT TO CR-LAST-ADD-ON-DT.
  8975
  8976     IF PB-I-UNDERWRITING-STATUS = 'A'  OR  'D'
  8977         MOVE 'Y'                TO  CR-UNDERWRITING-CODE.
  8978
  8979     IF PB-BATCH-ENTRY = SPACE  OR
  8980        (PB-I-ENTRY-STATUS = '2'  OR  'U')
  8981         MOVE '1'                TO  CR-ENTRY-STATUS
  8982     ELSE
  8983         MOVE PB-I-ENTRY-STATUS  TO  CR-ENTRY-STATUS.
  8984
  8985     IF PB-POLICY-IS-DECLINED
  8986         MOVE 'D'                TO  CR-ENTRY-STATUS.
  8987
  8988     IF PB-POLICY-IS-VOIDED
  8989         MOVE 'V'                TO  CR-ENTRY-STATUS.
  8990
  8991***  IF DTE-CLIENT NOT = 'CRI'
  8992***      IF PB-I-PREM-ACCTNG-ONLY
  8993***          MOVE '1'            TO  CR-ENTRY-STATUS.
  8994
  8995     MOVE EOM-RUN-DATE           TO  CR-ENTRY-DATE
  8996                                     WS-CR-ENTRY-DATE-N.
  8997
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 175
* ECS010P.cbl
  8998     IF PB-I-MICROFILM-NO NUMERIC
*  12-S************************                                        ( 170)**
**    Operand PB-I-MICROFILM-NO is not declared
  8999         MOVE PB-I-MICROFILM-NO  TO CR-ISS-MICROFILM-NO.
*  12-S******************************                                  ( 175)**
**    Operand PB-I-MICROFILM-NO is not declared
  9000
  9001     IF DTE-CLIENT = 'TIH' OR 'FLA' OR 'TII' OR
  9002        'TMS' OR 'NCL' OR 'HER' OR 'CID' OR 'DCC'
  9003         MOVE PB-I-SIG-SW        TO CR-USER-CODE
  9004     END-IF
  9005
  9006*************************************************
  9007***  ADDED IN 06/93 WHEN CERTIFICATE-RECORD   ***
  9008***  WAS CONVERTED TO 1056 BYTES.             ***
  9009*************************************************
  9010     MOVE PB-ENTRY-BATCH         TO  CR-ENTRY-BATCH.
  9011     MOVE PB-I-BENEFICIARY-NAME  TO  CR-BENEFICIARY.
  9012
  9013     MOVE PB-LAST-MAINT-BY       TO  CR-CSR-CODE.
  9014
  9015     MOVE CR-STATE               TO STATE-L.
  9016
  9017     PERFORM 8200-STATE-CODE-LOOKUP THRU 8299-STATE-LOOKUP-X.
  9018
  9019     PERFORM 8600-SETUP-DETAIL-LINE THRU 8689-SETUP-DETAIL-X.
  9020
  9021***************************************************
  9022***  WHEN AN ISSUE WAS PROCESSED THAT HAD       ***
  9023***  INVALID BENEFIT CODES LOCATED IN BOTH      ***
  9024***  BENEFITS,  THE 'ACTION' ON THE DETAIL LIST ***
  9025***  LINE WAS BYPASSED - ONLY THE CERTIFICATE,  ***
  9026***  THE EFFECTIVE DATE AND THE AGE PRINTED.    ***
  9027***************************************************
  9028     IF (PB-INVALID-LIFE AND PB-INVALID-AH)
  9029         IF CR-LF-POLICY-IS-RESTORE
  9030             MOVE 'RESTORED  '          TO TRD-LF-ACTION
  9031             GO TO 0530-PROCESS-ISSUE-CONTINUED
  9032         ELSE
  9033         IF CR-LF-POLICY-IS-REISSUE
  9034             MOVE 'RE-ISSUED '          TO TRD-LF-ACTION
  9035             GO TO 0530-PROCESS-ISSUE-CONTINUED
  9036         ELSE
  9037         IF CR-LF-IS-REIN-ONLY
  9038             MOVE 'REIN. ONLY'          TO TRD-LF-ACTION
  9039             GO TO 0530-PROCESS-ISSUE-CONTINUED
  9040         ELSE
  9041         IF CR-LF-IS-DECLINED
  9042             MOVE 'DECLINED  '          TO TRD-LF-ACTION
  9043             GO TO 0530-PROCESS-ISSUE-CONTINUED
  9044         ELSE
  9045         IF CR-LF-IS-VOID
  9046             MOVE 'VOIDED    '          TO TRD-LF-ACTION
  9047             GO TO 0530-PROCESS-ISSUE-CONTINUED
  9048         ELSE
  9049         IF CR-LF-POLICY-IS-MONTHLY
  9050            MOVE 'MONTHLY'       TO TRD-LF-ACTION
  9051            GO TO 0530-PROCESS-ISSUE-CONTINUED.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 176
* ECS010P.cbl
  9052
  9053
  9054 0510-PROCESS-LIFE-ISSUE.
  9055
  9056     IF PB-INVALID-LIFE
  9057         GO TO 0520-PROCESS-A-H-ISSUE.
  9058
  9059     MOVE PB-I-LF-BENEFIT-CD     TO  CLAS-LOOK.
  9060     PERFORM 8300-LIFE-TYPE-LOOKUP THRU 8399-LIFE-LOOKUP-X.
  9061     MOVE CLAS-LOOK              TO  PB-I-LF-BENEFIT-CD.
  9062
  9063     MOVE PB-I-LF-BENEFIT-CD     TO  CR-LFTYP.
  9064     MOVE PB-I-LF-TERM           TO  CR-LF-TERM.
  9065     MOVE PB-I-LF-CRIT-PER       TO  CR-LF-CRIT-PERIOD.
  9066     MOVE PB-I-TERM-IN-DAYS      TO  CR-LF-TERM-IN-DAYS.
  9067     MOVE PB-I-RATE-DEVIATION-LF TO  CR-LF-DEV-CODE.
  9068     MOVE PB-I-RATE-DEV-PCT-LF   TO  CR-LF-DEV-PCT.
  9069
  9070     MOVE PB-I-LF-BENEFIT-AMT    TO  CR-LFAMT.
  9071     MOVE PB-I-LF-PREMIUM-AMT    TO  CR-LFPRM.
  9072     IF PB-I-LF-POLICY-FEE  NUMERIC
  9073         MOVE PB-I-LF-POLICY-FEE TO  CR-LF-POLICY-FEE.
  9074     MOVE PB-I-LF-PREM-CALC      TO  CR-LFPRM-CALC.
  9075     MOVE PB-I-LF-RATE           TO  CR-LFPRM-RATE.
  9076
  9077     IF PB-I-LF-PREM-TAX NUMERIC
  9078        MOVE PB-I-LF-PREM-TAX    TO CR-LF-ISS-PREM-TAX
  9079     END-IF
  9080
  9081
  9082     IF PB-I-LF-REI-RATE NOT = ZEROS
  9083        IF DTE-CLIENT = 'DCC'
  9084           CONTINUE
  9085*          PERFORM 0795-DCC-NSP-LF  THRU 0795-EXIT
  9086        ELSE
  9087           MOVE PB-I-LF-REI-RATE TO CR-LF-NSP-PRM-RATE
  9088           COMPUTE CR-LF-NSP-PRM ROUNDED =
  9089                          (CR-LFAMT / 100) * PB-I-LF-REI-RATE
  9090        END-IF
  9091     END-IF
  9092
  9093     IF CLAS-I-EP (CLAS-INDEXL) = 'B'
  9094         MOVE PB-I-LF-ALT-BENEFIT-AMT TO CR-LFAMT-ALT
  9095         MOVE PB-I-LF-ALT-PREMIUM-AMT TO CR-LFPRM-ALT
  9096         MOVE PB-I-LF-ALT-PREM-CALC   TO CR-LFPRM-CALC-ALT
  9097         MOVE PB-I-LF-ALT-RATE        TO CR-LFPRM-RATE-ALT
  9098         IF PB-I-LF-ALT-REI-RATE NOT = ZEROS
  9099             COMPUTE CR-LF-NSP-PRM ROUNDED =  CR-LF-NSP-PRM +
  9100                 ((CR-LFAMT-ALT / 100) * PB-I-LF-ALT-REI-RATE).
  9101
  9102     MOVE PB-I-LF-EXPIRE-DT      TO  DC-BIN-DATE-1.
  9103     MOVE ' '                    TO  DC-OPTION-CODE.
  9104     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
  9105     MOVE DC-GREG-DATE-CYMD      TO  CR-LF-EXPIRE-DATE
  9106                                     WS-CR-LF-EXPIRE-DATE-N.
  9107
  9108     IF CR-ENTRY-STATUS = 'P'
  9109         MOVE '1'                TO  CR-LF-CURRENT-STATUS
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 177
* ECS010P.cbl
  9110     ELSE
  9111         MOVE CR-ENTRY-STATUS    TO  CR-LF-CURRENT-STATUS.
  9112
  9113     MOVE CLAS-I-AB3 (CLAS-INDEXL)  TO TRD-LFTYP.
  9114     MOVE CR-LF-TERM                TO TRD-LFTRM.
  9115     COMPUTE TRD-LFPRM-RFND = CR-LFPRM + CR-LFPRM-ALT.
  9116     MOVE 'ISSUE     '              TO TRD-LF-ACTION.
  9117     MOVE CR-LF-CURRENT-STATUS      TO TRD-LF-STATUS.
  9118
  9119     IF CR-LF-POLICY-IS-RESTORE
  9120         MOVE 'RESTORED  '          TO TRD-LF-ACTION.
  9121     IF CR-LF-POLICY-IS-REISSUE
  9122         MOVE 'RE-ISSUED '          TO TRD-LF-ACTION.
  9123     IF CR-LF-IS-REIN-ONLY
  9124         MOVE 'REIN. ONLY'          TO TRD-LF-ACTION.
  9125
  9126     IF CR-LF-IS-DECLINED
  9127         MOVE 'DECLINED  '          TO TRD-LF-ACTION.
  9128
  9129     IF CR-LF-IS-VOID
  9130         MOVE 'VOIDED    '          TO TRD-LF-ACTION.
  9131     IF CR-LF-POLICY-IS-MONTHLY
  9132         MOVE 'MONTHLY   '          TO TRD-LF-ACTION.
  9133
  9134     ADD +1                      TO  W-LF-ISSUES.
  9135
  9136 0520-PROCESS-A-H-ISSUE.
  9137
  9138     IF PB-INVALID-AH
  9139         GO TO 0530-PROCESS-ISSUE-CONTINUED.
  9140
  9141     MOVE PB-I-AH-BENEFIT-CD     TO CLAS-LOOK.
  9142     PERFORM 8400-A-H-TYPE-LOOKUP THRU 8499-A-H-LOOKUP-X.
  9143     MOVE CLAS-LOOK              TO  PB-I-AH-BENEFIT-CD.
  9144
  9145     MOVE PB-I-AH-BENEFIT-CD     TO  CR-AHTYP.
  9146     MOVE PB-I-AH-TERM           TO  CR-AH-TERM.
  9147     MOVE PB-I-AH-CRIT-PER       TO  CR-AH-CRIT-PERIOD.
  9148     MOVE PB-I-RATE-DEVIATION-AH TO  CR-AH-DEV-CODE.
  9149     MOVE PB-I-RATE-DEV-PCT-AH   TO  CR-AH-DEV-PCT.
  9150
  9151     MOVE PB-I-AH-BENEFIT-AMT    TO  CR-AHAMT.
  9152     MOVE PB-I-AH-PREMIUM-AMT    TO  CR-AHPRM.
  9153     IF PB-I-AH-POLICY-FEE  NUMERIC
  9154         MOVE PB-I-AH-POLICY-FEE TO  CR-AH-POLICY-FEE.
  9155     MOVE PB-I-AH-PREM-CALC      TO  CR-AHPRM-CALC.
  9156     MOVE PB-I-AH-RATE           TO  CR-AHPRM-RATE.
  9157
  9158     IF PB-I-AH-PREM-TAX NUMERIC
  9159        MOVE PB-I-AH-PREM-TAX    TO CR-AH-ISS-PREM-TAX
  9160     END-IF
  9161
  9162     IF PB-I-AH-REI-RATE NOT = ZEROS
  9163        IF DTE-CLIENT = 'DCC'
  9164           CONTINUE
  9165        ELSE
  9166           MOVE PB-I-AH-REI-RATE   TO  CR-AH-NSP-PRM-RATE
  9167           COMPUTE CR-AH-NSP-PRM ROUNDED =
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 178
* ECS010P.cbl
  9168             ((CR-AHAMT * CR-AH-TERM) / 100) * PB-I-AH-REI-RATE
  9169        END-IF
  9170     END-IF
  9171
  9172     IF CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'G' OR 'L'
  9173        MOVE PB-I-AMOUNT-FINANCED TO CR-LFAMT
  9174        MOVE PB-I-UNPAID-CASH-PRICE TO CR-LFAMT-ALT
  9175        MOVE PB-I-CLP-AMOUNT     TO CR-LFPRM-ALT
  9176     END-IF
  9177     MOVE PB-I-AH-EXPIRE-DT      TO  DC-BIN-DATE-1.
  9178     MOVE ' '                    TO  DC-OPTION-CODE.
  9179     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
  9180     MOVE DC-GREG-DATE-CYMD      TO  CR-AH-EXPIRE-DATE
  9181                                     WS-CR-AH-EXPIRE-DATE-N.
  9182
  9183     IF CR-ENTRY-STATUS = 'P'
  9184         MOVE '1'                TO  CR-AH-CURRENT-STATUS
  9185     ELSE
  9186         MOVE CR-ENTRY-STATUS    TO  CR-AH-CURRENT-STATUS.
  9187
  9188     MOVE CLAS-I-AB3 (CLAS-INDEXA)  TO TRD-AHTYP.
  9189     MOVE CR-AH-TERM                TO TRD-AHTRM.
  9190     MOVE CR-AHPRM                  TO TRD-AHPRM-RFND.
  9191     MOVE 'ISSUE     '              TO TRD-AH-ACTION.
  9192     MOVE CR-AH-CURRENT-STATUS      TO TRD-AH-STATUS.
  9193
  9194     IF CR-AH-POLICY-IS-RESTORE
  9195         MOVE 'RESTORED  '          TO TRD-AH-ACTION.
  9196     IF CR-AH-POLICY-IS-REISSUE
  9197         MOVE 'RE-ISSUED '          TO TRD-AH-ACTION.
  9198     IF CR-AH-IS-REIN-ONLY
  9199         MOVE 'REIN. ONLY'          TO TRD-AH-ACTION.
  9200
  9201     IF CR-AH-IS-DECLINED
  9202         MOVE 'DECLINED  '          TO TRD-AH-ACTION.
  9203
  9204     IF CR-AH-IS-VOID
  9205         MOVE 'VOIDED    '          TO TRD-AH-ACTION.
  9206     IF CR-AH-POLICY-IS-MONTHLY
  9207         MOVE 'MONTHLY   '          TO TRD-AH-ACTION.
  9208
  9209     ADD +1                      TO  W-AH-ISSUES.
  9210
  9211 0530-PROCESS-ISSUE-CONTINUED.
  9212
  9213     PERFORM 1000-SET-COMMISSION-STRUCTURE THRU 1499-SET-COMM-X.
  9214     MOVE WK-NEW-RATES           TO CR-COMPENSATION-LEVELS.
  9215     MOVE  SPACES                TO WS-LEVELS-CHARGEBACK-SWITCHES.
  9216     PERFORM 1500-GET-ACCT-LEVEL-LF-COMM THRU 1519-ACCT-LF-COMM-X.
  9217
  9218     IF (DTE-CLIENT = 'DCC')
  9219        AND (CR-AHTYP NOT = '00' AND '  ')
  9220        IF CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'G' OR 'L'
  9221           PERFORM 0920-GET-BANK-FEES
  9222                                 THRU 0920-EXIT
  9223           PERFORM 0930-BUILD-CERT-TRLR
  9224                                 THRU 0930-EXIT
  9225           PERFORM 0395-GET-CERT-TRLRS
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 179
* ECS010P.cbl
  9226                                 THRU 0395-EXIT
  9227        END-IF
  9228     END-IF
  9229
  9230     IF DTE-CLIENT = 'DCC'
  9231        IF CR-LF-DEV-PCT NOT = +0 AND +1
  9232           COMPUTE CR-LF-NSP-PRM ROUNDED =
  9233              (CR-LFPRM + CR-LFPRM-ALT) -
  9234              ((CR-LFPRM + CR-LFPRM-ALT) * CR-LCOM-L (1))
  9235*             ((CR-LFPRM + CR-LFPRM-ALT) * WK-L-RT1 (1))
  9236        END-IF
  9237     END-IF
  9238
  9239     IF CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'G' OR 'L'
  9240        MOVE CR-LFPRM-ALT        TO CR-AH-NSP-PRM
  9241     ELSE
  9242        IF DTE-CLIENT = 'DCC'
  9243           IF CR-AH-DEV-PCT NOT = +0 AND +1
  9244              COMPUTE CR-AH-NSP-PRM ROUNDED =
  9245              CR-AHPRM -
  9246              (CR-AHPRM * CR-LCOM-AH (1))
  9247*             (CR-AHPRM * WK-A-RT1 (1))
  9248           END-IF
  9249        END-IF
  9250     END-IF
  9251
  9252     IF CR-ENTRY-STATUS = 'P'
  9253         MOVE '1'                   TO CR-ENTRY-STATUS.
  9254
  9255     IF CR-POLICY-IS-REISSUE  OR
  9256        CR-POLICY-IS-REIN-ONLY OR
  9257        CR-POLICY-IS-DECLINED OR
  9258        CR-POLICY-IS-VOID
  9259        OR CR-POLICY-IS-MONTHLY
  9260         GO TO 0590-END-ISSUE-PROCESSING.
  9261
  9262     ADD CR-LFPRM TO TPL-ISS-PRM (1).
  9263     IF CLAS-I-BEN-CATEGORY (CLAS-INDEXA) NOT = 'G' AND 'L'
  9264        ADD CR-LFPRM-ALT TO TPL-ISS-PRM (1)
  9265     END-IF
  9266     ADD CR-AHPRM TO TPA-ISS-PRM (1).
  9267
  9268     IF NOT PB-INVALID-LIFE
  9269         COMPUTE H-LFCM ROUNDED =
  9270                    (CR-LFPRM + CR-LFPRM-ALT) * ACCT-COMM-LF
  9271         MOVE H-LFCM                   TO TRD-LFCOM-CLM
  9272         ADD H-LFCM                    TO TPL-ACCT-COM (1).
  9273
  9274     IF NOT PB-INVALID-AH
  9275        IF CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'G' OR 'L'
  9276           COMPUTE H-AHCM ROUNDED = CR-AHPRM - (CR-LFPRM-ALT
  9277           + CR-ADDL-CLP)
  9278        ELSE
  9279           COMPUTE H-AHCM ROUNDED = CR-AHPRM * ACCT-COMM-AH
  9280        END-IF
  9281        MOVE H-AHCM                   TO TRD-AHCOM-CLM
  9282        ADD H-AHCM                    TO TPA-ACCT-COM (1)
  9283     END-IF
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 180
* ECS010P.cbl
  9284
  9285     ADD +1 TO BC-G-ISS.
  9286     ADD +1 TO BC-COMM.
  9287     ADD CR-LFPRM TO BC-NET-WRIT.
  9288     IF CLAS-I-BEN-CATEGORY (CLAS-INDEXA) NOT = 'G' AND 'L'
  9289        ADD CR-LFPRM-ALT TO BC-NET-WRIT
  9290     END-IF
  9291     ADD CR-AHPRM TO BC-NET-WRIT.
  9292
  9293     IF CLAS-I-BAL (CLAS-INDEXL) = 'B'
  9294        ADD CR-LFPRM             TO BC-NET-WRIT-OB
  9295        ADD CR-LFPRM-ALT         TO BC-NET-WRIT-OB
  9296     ELSE
  9297        ADD CR-LFPRM             TO BC-NET-WRIT-SP
  9298        IF CLAS-I-BEN-CATEGORY (CLAS-INDEXA) NOT = 'G' AND 'L'
  9299           ADD CR-LFPRM-ALT      TO BC-NET-WRIT-SP
  9300        END-IF
  9301     END-IF
  9302
  9303     IF  CLAS-I-BAL (CLAS-INDEXA) = 'B'
  9304         ADD CR-AHPRM            TO BC-NET-WRIT-OB
  9305     ELSE
  9306         ADD CR-AHPRM            TO BC-NET-WRIT-SP.
  9307
  9308 0590-END-ISSUE-PROCESSING.
  9309
  9310     PERFORM 8690-PRINT-DETAIL-LINE THRU 8699-PRT-DETAIL-X.
  9311
  9312     PERFORM 3000-REINSURE-ROUTINE THRU 3099-REINSURE-ROUTINE-X.
  9313
  9314     IF NOT CR-POLICY-IS-REIN-ONLY  AND
  9315        NOT CR-POLICY-IS-DECLINED  AND
  9316        NOT CR-POLICY-IS-VOID
  9317         MOVE 'Y' TO BILLED-SWITCH
  9318         PERFORM 2100-BUILD-ISSUE-EXTRACT THRU 2199-BLD-ISSUE-X.
  9319
  9320     IF NOT CR-POLICY-IS-REISSUE  AND
  9321        NOT CR-POLICY-IS-DECLINED  AND
  9322        NOT CR-POLICY-IS-VOID
  9323        AND NOT CR-POLICY-IS-MONTHLY
  9324         PERFORM 3100-REINSURE-ISSUE THRU 3199-REINSURE-ISSUE-X.
  9325
  9326     MOVE '*'                   TO TRANSACTION-FLAG.
  9327     GO TO 0300-READ-PENDING-TRANSACTIONS.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 181
* ECS010P.cbl
  9329******************************************************************
  9330***    P R O C E S S   C A N C E L   T R A N S A C T I O N S   ***
  9331******************************************************************
  9332
  9333 0600-PROCESS-CANCELLATIONS.
  9334
  9335     PERFORM 3000-REINSURE-ROUTINE THRU 3099-REINSURE-ROUTINE-X.
  9336
  9337     IF AM-RECALC-COMM = ('Y' OR '1')
  9338        PERFORM 1600-RECALC-COMM-EXTR
  9339                                 THRU 1899-RECALC-COMM-EXTR-X
  9340        MOVE ' '                 TO RECALC-TYPE
  9341     END-IF
  9342
  9343     MOVE CR-LFRFND               TO LIFE-REFUND.
  9344     MOVE CR-LFRFND-CALC          TO LIFE-REFUND-CALC.
  9345     MOVE CR-AHRFND               TO A-H-REFUND.
  9346     MOVE CR-AHRFND-CALC          TO A-H-REFUND-CALC.
  9347     MOVE CR-SUM-CAN-CNT-YTD      TO YTD-CANCEL-CNT.
  9348
  9349     MOVE PB-C-LF-CANCEL-AMT      TO CR-LFRFND.
  9350     IF CR-LFRFND-CALC = ZEROS
  9351         MOVE PB-C-LF-REF-CALC    TO CR-LFRFND-CALC
  9352                                     LIFE-REFUND-CALC
  9353     ELSE
  9354         MOVE PB-C-LF-CANCEL-AMT  TO CR-LFRFND-CALC.
  9355
  9356     MOVE PB-C-AH-CANCEL-AMT      TO CR-AHRFND.
  9357     IF CR-AHRFND-CALC = ZEROS
  9358         MOVE PB-C-AH-REF-CALC    TO CR-AHRFND-CALC
  9359                                     A-H-REFUND-CALC
  9360     ELSE
  9361         MOVE PB-C-AH-CANCEL-AMT  TO CR-AHRFND-CALC.
  9362
  9363*    MOVE CR-DT                 TO  DC-GREG-DATE-CYMD.
  9364*    MOVE 'L'                   TO  DC-OPTION-CODE.
  9365*    PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
  9366*    MOVE DC-BIN-DATE-1         TO  WS-CR-BIN-DATE.
  9367
  9368     IF PB-C-MICROFILM-NO NUMERIC  AND
*  12-S************************                                        ( 175)**
**    Operand PB-C-MICROFILM-NO is not declared
  9369        PB-C-MICROFILM-NO NOT = ZEROS
  9370         MOVE PB-C-MICROFILM-NO  TO CR-CAN-MICROFILM-NO.
*  12-S******************************                                  ( 181)**
**    Operand PB-C-MICROFILM-NO is not declared
  9371
  9372     IF PB-CI-STATE-TAX NOT NUMERIC
  9373        MOVE ZEROS               TO PB-CI-STATE-TAX.
  9374
  9375     IF PB-CI-MUNI-TAX NOT NUMERIC
  9376        MOVE ZEROS               TO PB-CI-MUNI-TAX.
  9377
  9378     IF CR-CANCEL-STATE-TAX NUMERIC
  9379         ADD PB-CI-STATE-TAX  TO CR-CANCEL-STATE-TAX
  9380       ELSE
  9381         MOVE PB-CI-STATE-TAX TO CR-CANCEL-STATE-TAX.
  9382
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 182
* ECS010P.cbl
  9383     IF CR-CANCEL-MUNI-TAX NUMERIC
  9384         ADD PB-CI-MUNI-TAX   TO CR-CANCEL-MUNI-TAX
  9385       ELSE
  9386         MOVE PB-CI-MUNI-TAX  TO CR-CANCEL-MUNI-TAX.
  9387
  9388     MOVE ZEROS                  TO MONTHS-DIFF-LF
  9389                                    MONTHS-DIFF-AH.
  9390
  9391     PERFORM 8600-SETUP-DETAIL-LINE THRU 8689-SETUP-DETAIL-X.
  9392
  9393 0630-PROCESS-LIFE-CANCEL.
  9394
  9395     IF CR-LFTYP = ZERO  OR
  9396        PB-C-LF-CANCEL-DT = LOW-VALUES  OR  SPACES
  9397         MOVE ZEROS               TO H-LFCM
  9398         GO TO 0650-PROCESS-A-H-CANCEL.
  9399
  9400     IF PB-C-LF-PREM-TAX NUMERIC
  9401        MOVE PB-C-LF-PREM-TAX    TO CR-LF-CNC-PREM-TAX
  9402     END-IF
  9403     MOVE PB-C-LF-CANCEL-DT       TO  DC-BIN-DATE-1.
  9404     MOVE ' '                     TO  DC-OPTION-CODE.
  9405     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
  9406     MOVE DC-GREG-DATE-CYMD       TO  CR-LF-CANC-DT
  9407                                      WS-CR-LF-CANC-DT-N.
  9408
  9409     MOVE WS-CR-BIN-DATE          TO  DC-BIN-DATE-1.
  9410     MOVE PB-C-LF-CANCEL-DT       TO  DC-BIN-DATE-2.
  9411     MOVE '1'                     TO  DC-OPTION-CODE.
  9412     MOVE ' '                     TO  DC-CENTURY-ADJUSTMENT.
  9413     MOVE ZEROS                   TO  DC-ELAPSED-MONTHS
  9414                                      DC-ODD-DAYS-OVER
  9415                                      DC-ELAPSED-DAYS.
  9416     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
  9417     MOVE DC-ELAPSED-MONTHS       TO  MONTHS-DIFF-LF.
  9418
  9419     IF DC-ODD-DAYS-OVER   GREATER THAN  ZERO
  9420         ADD  +1                  TO  MONTHS-DIFF-LF.
  9421
  9422     MOVE  'YYYYYYYYYY'           TO  WS-LF-CHARGEBACK-LEVELS.
  9423
  9424     MOVE  ZEROS                  TO  SUB.
  9425
  9426 0635-LIFE-CHARGEBACK-LOOP.
  9427
  9428     ADD    +1                    TO  SUB.
  9429
  9430     IF  SUB  GREATER THAN  +10
  9431         GO TO  0640-CONTINUE-LIFE-CANCEL.
  9432
  9433     IF  AM-COMM-CHARGEBACK (SUB)  NOT  NUMERIC  OR
  9434         AM-COMM-CHARGEBACK (SUB)  =  ZEROS
  9435         GO TO  0635-LIFE-CHARGEBACK-LOOP.
  9436
  9437     IF  AM-COMM-CHARGEBACK (SUB)  EQUAL    '99'
  9438         MOVE  'N'    TO  WS-LF-CHARGEBACK-SW (SUB).
  9439
  9440     IF  MONTHS-DIFF-LF GREATER THAN AM-COMM-CHARGEBACK (SUB)
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 183
* ECS010P.cbl
  9441         MOVE  'N'        TO  WS-LF-CHARGEBACK-SW (SUB).
  9442
  9443     GO TO  0635-LIFE-CHARGEBACK-LOOP.
  9444
  9445
  9446 0640-CONTINUE-LIFE-CANCEL.
  9447
  9448     IF DC-ODD-DAYS-OVER GREATER THAN ZEROS
  9449        SUBTRACT +1 FROM MONTHS-DIFF-LF.
  9450
  9451     PERFORM 1500-GET-ACCT-LEVEL-LF-COMM THRU 1519-ACCT-LF-COMM-X.
  9452
  9453     IF DTE-CLIENT = 'GIC'
  9454         IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'B'
  9455             MOVE CR-LFPRM-CALC   TO CR-LFRFND-CALC
  9456                                     LIFE-REFUND-CALC.
  9457
  9458*    IF DTE-CLIENT = 'TMS'
  9459     MOVE PB-LF-REFUND-TYPE      TO CR-LF-REFUND-TYPE
  9460
  9461     IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'Z'
  9462         MOVE PB-C-LIVES               TO CR-SUM-CAN-CNT-YTD
  9463     ELSE
  9464         IF CR-LF-CANCEL-EXIT-DATE = ZEROS
  9465             MOVE CR-LF-CURRENT-STATUS TO CR-LF-STATUS-AT-CANCEL
  9466             MOVE '8'                  TO CR-LF-CURRENT-STATUS
  9467             MOVE PB-C-LF-COMM-CHARGEBACK TO CR-LF-COMM-CHARGEBACK
  9468             MOVE EOM-RUN-DATE      TO CR-LF-CANCEL-EXIT-DATE
  9469                                       WS-CR-LF-CANCEL-EXIT-DATE-N
  9470         ELSE
  9471             IF CR-LF-CURRENT-STATUS = '6'
  9472                 MOVE '8'              TO CR-LF-CURRENT-STATUS
  9473                 MOVE PB-C-LF-COMM-CHARGEBACK
  9474                                       TO CR-LF-COMM-CHARGEBACK
  9475                 MOVE EOM-RUN-DATE TO CR-LF-CANCEL-EXIT-DATE
  9476                                      WS-CR-LF-CANCEL-EXIT-DATE-N.
  9477
  9478*************************************************
  9479***  ADDED IN 06/93 WHEN CERTIFICATE-RECORD   ***
  9480***  WAS CONVERTED TO 1056 BYTES.             ***
  9481*************************************************
  9482     MOVE PB-ENTRY-BATCH               TO CR-LF-EXIT-BATCH.
  9483
  9484     MOVE CLAS-I-AB3 (CLAS-INDEXL)     TO TRD-LFTYP.
  9485     MOVE CR-LF-TERM                   TO TRD-LFTRM.
  9486     MOVE CR-LFRFND                    TO TRD-LFPRM-RFND.
  9487
  9488     COMPUTE H-LFCM ROUNDED =
  9489                              (CR-LFRFND * ACCT-COMM-LF) * (-1).
  9490     MOVE H-LFCM                       TO TRD-LFCOM-CLM.
  9491
  9492     MOVE CR-LF-CNC-MO                 TO TRD-LFACTMO.
  9493     MOVE CR-LF-CNC-DA                 TO TRD-LFACTDA.
  9494     MOVE CR-LF-CNC-YR                 TO TRD-LFACTYR.
  9495     MOVE '/'                          TO TRD-LF-S1  TRD-LF-S2.
  9496
  9497     MOVE 'CANCEL    '                 TO TRD-LF-ACTION.
  9498     MOVE CR-LF-CURRENT-STATUS         TO TRD-LF-STATUS.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 184
* ECS010P.cbl
  9499
  9500 0650-PROCESS-A-H-CANCEL.
  9501
  9502     IF CR-AHTYP = ZERO  OR
  9503        PB-C-AH-CANCEL-DT = LOW-VALUES  OR  SPACES
  9504         MOVE ZEROS               TO H-AHCM
  9505         GO TO 0660-PROCESS-CANCEL-CONTINUE.
  9506
  9507*    MOVE CR-DT                 TO  DC-GREG-DATE-CYMD.
  9508*    MOVE 'L'                   TO  DC-OPTION-CODE.
  9509*    PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
  9510*    MOVE DC-BIN-DATE-1         TO  WS-CR-BIN-DATE.
  9511
  9512     MOVE PB-C-AH-CANCEL-DT       TO  DC-BIN-DATE-1.
  9513     MOVE ' '                     TO  DC-OPTION-CODE.
  9514     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
  9515     MOVE DC-GREG-DATE-CYMD       TO  CR-AH-CANC-DT
  9516                                      WS-CR-AH-CANC-DT-N.
  9517
  9518     IF PB-C-AH-PREM-TAX NUMERIC
  9519        MOVE PB-C-AH-PREM-TAX    TO CR-AH-CNC-PREM-TAX
  9520     END-IF
  9521     MOVE WS-CR-BIN-DATE          TO  DC-BIN-DATE-1.
  9522     MOVE PB-C-AH-CANCEL-DT       TO  DC-BIN-DATE-2.
  9523     MOVE '1'                     TO  DC-OPTION-CODE.
  9524     MOVE ' '                     TO  DC-CENTURY-ADJUSTMENT.
  9525     MOVE ZEROS                   TO  DC-ELAPSED-MONTHS
  9526                                      DC-ODD-DAYS-OVER
  9527                                      DC-ELAPSED-DAYS.
  9528     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
  9529     MOVE DC-ELAPSED-MONTHS       TO  MONTHS-DIFF-AH.
  9530
  9531     IF  DC-ODD-DAYS-OVER   GREATER THAN   ZERO
  9532          ADD  +1                 TO  MONTHS-DIFF-AH.
  9533
  9534     MOVE  'YYYYYYYYYY'           TO  WS-AH-CHARGEBACK-LEVELS.
  9535     IF CR-BANK-NOCHRGB-MONTHS NOT NUMERIC
  9536        MOVE ZEROS               TO CR-BANK-NOCHRGB-MONTHS
  9537     END-IF
  9538*    IF DTE-CLIENT = 'DCC'
  9539*       IF (CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'G' OR 'L')
  9540*          AND (CR-BANK-NOCHRGB-MONTHS > ZEROS)
  9541*          PERFORM VARYING SUB FROM +1 BY +1 UNTIL
  9542*             (CR-BANK-NO = CR-COM-AGT (SUB))
  9543*             OR (SUB > +10)
  9544*          END-PERFORM
  9545*          IF CR-BANK-NO = CR-COM-AGT (SUB)
  9546*             MOVE CR-BANK-NOCHRGB-MONTHS
  9547*                                TO AM-COMM-CHARGEBACK (SUB)
  9548*          END-IF
  9549*       END-IF
  9550*    END-IF
  9551
  9552
  9553     MOVE 'Y'                     TO WS-FIRST-K
  9554     MOVE ' '                     TO WS-DLR-INC-CHG-BACK
  9555     MOVE  ZEROS                  TO  SUB.
  9556
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 185
* ECS010P.cbl
  9557 0653-A-H-CHARGEBACK-LOOP.
  9558
  9559     ADD    +1                    TO  SUB.
  9560
  9561     IF  SUB  GREATER THAN  +10
  9562         GO TO  0655-CONTINUE-A-H-CANCEL.
  9563
  9564     IF  AM-COMM-CHARGEBACK (SUB)  NOT  NUMERIC  OR
  9565         AM-COMM-CHARGEBACK (SUB)  =  ZEROS
  9566         GO TO  0653-A-H-CHARGEBACK-LOOP.
  9567
  9568     IF  AM-COMM-CHARGEBACK (SUB)  EQUAL    '99'
  9569         MOVE  'N'    TO  WS-AH-CHARGEBACK-SW (SUB).
  9570
  9571     IF  (MONTHS-DIFF-AH GREATER THAN AM-COMM-CHARGEBACK (SUB))
  9572         OR ((DTE-CLIENT = 'DCC')
  9573             AND (CR-AHRFND = ZEROS))
  9574         MOVE  'N'        TO  WS-AH-CHARGEBACK-SW (SUB).
  9575
  9576     GO TO  0653-A-H-CHARGEBACK-LOOP.
  9577
  9578
  9579 0655-CONTINUE-A-H-CANCEL.
  9580
  9581     IF DC-ODD-DAYS-OVER GREATER THAN ZEROS
  9582        SUBTRACT +1 FROM MONTHS-DIFF-AH.
  9583
  9584     PERFORM 1550-GET-ACCT-LEVEL-AH-COMM THRU 1599-ACCT-AH-COMM-X.
  9585
  9586     IF DTE-CLIENT = 'GIC'
  9587         IF CLAS-I-CALC-TYPE (CLAS-INDEXA) = 'B'
  9588             MOVE CR-AHPRM-CALC   TO CR-AHRFND-CALC
  9589                                     A-H-REFUND-CALC.
  9590
  9591*    IF DTE-CLIENT = 'TMS'
  9592     MOVE PB-AH-REFUND-TYPE      TO CR-AH-REFUND-TYPE
  9593*    DISPLAY ' PEND AH REF TYPE ' PB-AH-REFUND-TYPE
  9594
  9595
  9596     IF CLAS-I-CALC-TYPE (CLAS-INDEXA) = 'Z'
  9597         MOVE PB-C-LIVES               TO CR-SUM-CAN-CNT-YTD
  9598     ELSE
  9599         IF CR-AH-CANCEL-EXIT-DATE = ZEROS
  9600             MOVE CR-AH-CURRENT-STATUS TO CR-AH-STATUS-AT-CANCEL
  9601             MOVE '8'                  TO CR-AH-CURRENT-STATUS
  9602             MOVE PB-C-AH-COMM-CHARGEBACK TO CR-AH-COMM-CHARGEBACK
  9603             MOVE EOM-RUN-DATE    TO CR-AH-CANCEL-EXIT-DATE
  9604                                     WS-CR-AH-CANCEL-EXIT-DATE-N
  9605         ELSE
  9606             IF CR-AH-CURRENT-STATUS = '7'
  9607                 MOVE '8'              TO CR-AH-CURRENT-STATUS
  9608                 MOVE PB-C-AH-COMM-CHARGEBACK
  9609                                       TO CR-AH-COMM-CHARGEBACK
  9610                 MOVE EOM-RUN-DATE TO CR-AH-CANCEL-EXIT-DATE
  9611                                      WS-CR-AH-CANCEL-EXIT-DATE-N.
  9612
  9613*************************************************
  9614***  ADDED IN 06/93 WHEN CERTIFICATE-RECORD   ***
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 186
* ECS010P.cbl
  9615***  WAS CONVERTED TO 1056 BYTES.             ***
  9616*************************************************
  9617     MOVE PB-ENTRY-BATCH               TO CR-AH-EXIT-BATCH.
  9618
  9619     MOVE CLAS-I-AB3 (CLAS-INDEXA)     TO TRD-AHTYP.
  9620     MOVE CR-AH-TERM                   TO TRD-AHTRM.
  9621     MOVE CR-AHRFND                    TO TRD-AHPRM-RFND.
  9622
  9623     IF CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'G' OR 'L'
  9624        COMPUTE CNC-FACT = CR-AHRFND / CR-AHPRM
  9625        COMPUTE H-AHCM ROUNDED = CNC-FACT *
  9626           (CR-AHPRM - (CR-LFPRM-ALT
  9627           + CR-ADDL-CLP)) * -1
  9628     ELSE
  9629        COMPUTE H-AHCM ROUNDED =
  9630          (CR-AHRFND * ACCT-COMM-AH) * (-1)
  9631     END-IF
  9632
  9633     MOVE H-AHCM                       TO TRD-AHCOM-CLM.
  9634
  9635     MOVE CR-AH-CNC-MO                 TO TRD-AHACTMO.
  9636     MOVE CR-AH-CNC-DA                 TO TRD-AHACTDA.
  9637     MOVE CR-AH-CNC-YR                 TO TRD-AHACTYR
  9638     MOVE '/'                          TO TRD-AH-S1  TRD-AH-S2.
  9639
  9640     MOVE 'CANCEL    '                 TO TRD-AH-ACTION.
  9641     MOVE CR-AH-CURRENT-STATUS         TO TRD-AH-STATUS.
  9642
  9643 0660-PROCESS-CANCEL-CONTINUE.
  9644
  9645     PERFORM 8690-PRINT-DETAIL-LINE THRU 8699-PRT-DETAIL-X.
  9646
  9647     IF CR-POLICY-IS-REIN-ONLY
  9648        GO TO 0660-CONT.
  9649
  9650     MOVE 'Y'                    TO BILLED-SWITCH.
  9651     PERFORM 2200-BUILD-CANCEL-EXTRACT THRU 2299-BLD-CANCEL-X.
  9652
  9653     IF CR-POLICY-IS-MONTHLY
  9654        GO TO 0660-CONT
  9655     END-IF
  9656
  9657     ADD +1                      TO BC-G-CNC.
  9658     ADD +1                      TO BC-COMM.
  9659     SUBTRACT CR-LFRFND FROM BC-NET-WRIT.
  9660     SUBTRACT CR-AHRFND FROM BC-NET-WRIT.
  9661     ADD CR-LFRFND               TO TPL-CNC-PRM (1).
  9662     ADD H-LFCM                  TO TPL-ACCT-COM (1).
  9663     ADD CR-AHRFND               TO TPA-CNC-PRM (1).
  9664     ADD H-AHCM                  TO TPA-ACCT-COM (1).
  9665
  9666     IF  CLAS-I-BAL (CLAS-INDEXL) = 'B'
  9667         SUBTRACT CR-LFRFND FROM BC-NET-WRIT-OB
  9668     ELSE
  9669         SUBTRACT CR-LFRFND FROM BC-NET-WRIT-SP.
  9670
  9671     IF  CLAS-I-BAL (CLAS-INDEXA) = 'B'
  9672         SUBTRACT CR-AHRFND FROM BC-NET-WRIT-OB
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 187
* ECS010P.cbl
  9673     ELSE
  9674         SUBTRACT CR-AHRFND FROM BC-NET-WRIT-SP.
  9675
  9676
  9677 0660-CONT.
  9678
  9679     MOVE MONTHS-DIFF-LF            TO REIN-LCNC-EARN-TERM.
  9680     MOVE MONTHS-DIFF-AH            TO REIN-ACNC-EARN-TERM.
  9681
  9682     IF CR-LFRFND NEGATIVE
  9683       IF CR-LFRFND + LIFE-REFUND = ZEROS
  9684           MOVE '*'                 TO REIN-VOID-LF-SW.
  9685     IF CR-AHRFND NEGATIVE
  9686       IF CR-AHRFND + A-H-REFUND = ZEROS
  9687           MOVE '*'                 TO REIN-VOID-AH-SW.
  9688
  9689     IF CR-LFRFND NOT = ZEROS
  9690       IF CR-LF-CANCEL-EXIT-DATE NOT = EOM-RUN-DATE
  9691           MOVE '*'                 TO REIN-ADDL-LF-SW.
  9692     IF CR-AHRFND NOT = ZEROS
  9693       IF CR-AH-CANCEL-EXIT-DATE NOT = EOM-RUN-DATE
  9694           MOVE '*'                 TO REIN-ADDL-AH-SW.
  9695
  9696     IF CR-DT = CR-LF-CANC-DT
  9697       MOVE '*'                     TO REIN-CANCEL-LF-SW.
  9698     IF CR-DT = CR-AH-CANC-DT
  9699       MOVE '*'                     TO REIN-CANCEL-AH-SW.
  9700
  9701     PERFORM 3200-REINSURE-CANCEL THRU 3299-REINSURE-CANCEL-X.
  9702
  9703     MOVE SPACES                    TO REIN-VOID-LF-SW
  9704                                       REIN-VOID-AH-SW
  9705                                       REIN-ADDL-LF-SW
  9706                                       REIN-ADDL-AH-SW.
  9707
  9708     COMPUTE CR-LFRFND = LIFE-REFUND + PB-C-LF-CANCEL-AMT.
  9709     MOVE LIFE-REFUND-CALC          TO CR-LFRFND-CALC.
  9710
  9711     COMPUTE CR-AHRFND = A-H-REFUND  + PB-C-AH-CANCEL-AMT.
  9712     MOVE A-H-REFUND-CALC           TO CR-AHRFND-CALC.
  9713
  9714     IF (CR-LFTYP NOT = ZERO  AND
  9715        CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'Z')  OR
  9716        (CR-AHTYP NOT = ZERO  AND
  9717        CLAS-I-CALC-TYPE (CLAS-INDEXA) = 'Z')
  9718         ADD PB-C-LIVES                TO CR-SUM-CAN-CNT-ITD
  9719         COMPUTE CR-SUM-CAN-CNT-YTD = YTD-CANCEL-CNT + PB-C-LIVES.
  9720
  9721 0670-LIFE-CANCEL-VOID.
  9722
  9723     IF CR-LFTYP NOT = ZERO  AND
  9724        CR-LFRFND = ZERO  AND
  9725        PB-C-LF-CANCEL-AMT NEGATIVE
  9726         NEXT SENTENCE
  9727     ELSE
  9728         GO TO 0680-A-H-CANCEL-VOID.
  9729
  9730     MOVE ZEROS                        TO CR-LF-CANCEL-EXIT-DATE
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 188
* ECS010P.cbl
  9731                                       WS-CR-LF-CANCEL-EXIT-DATE-N
  9732                                          CR-LF-CANC-DT
  9733                                          WS-CR-LF-CANC-DT-N
  9734                                          CR-LFRFND-CALC.
  9735
  9736     MOVE SPACES                       TO CR-LF-COMM-CHARGEBACK.
  9737
  9738     IF CR-LF-CANCEL-APPLIED
  9739         MOVE CR-LF-STATUS-AT-CANCEL   TO CR-LF-CURRENT-STATUS
  9740         MOVE ' '                      TO CR-LF-STATUS-AT-CANCEL
  9741     ELSE
  9742         MOVE CR-LF-STATUS-AT-CANCEL   TO CR-LF-STATUS-AT-DEATH
  9743         MOVE ' '                      TO CR-LF-STATUS-AT-CANCEL.
  9744
  9745     PERFORM 8600-SETUP-DETAIL-LINE THRU 8689-SETUP-DETAIL-X.
  9746
  9747     MOVE 'VOID CANCL'                 TO TRD-LF-ACTION.
  9748     MOVE CR-LF-CURRENT-STATUS         TO TRD-LF-STATUS.
  9749
  9750     PERFORM 8690-PRINT-DETAIL-LINE THRU 8699-PRT-DETAIL-X.
  9751
  9752 0680-A-H-CANCEL-VOID.
  9753
  9754     IF CR-AHTYP NOT = ZERO  AND
  9755        CR-AHRFND = ZERO  AND
  9756        PB-C-AH-CANCEL-AMT NEGATIVE
  9757         NEXT SENTENCE
  9758     ELSE
  9759         GO TO 0690-END-CANCEL-PROCESSING.
  9760
  9761     MOVE ZEROS                      TO CR-AH-CANCEL-EXIT-DATE
  9762                                     WS-CR-AH-CANCEL-EXIT-DATE-N
  9763                                        CR-AH-CANC-DT
  9764                                        WS-CR-AH-CANC-DT-N
  9765                                        CR-AHRFND-CALC.
  9766
  9767     MOVE SPACES                        TO CR-AH-COMM-CHARGEBACK.
  9768
  9769     IF CR-AH-CANCEL-APPLIED
  9770         MOVE CR-AH-STATUS-AT-CANCEL    TO CR-AH-CURRENT-STATUS
  9771         MOVE ' '                       TO CR-AH-STATUS-AT-CANCEL
  9772     ELSE
  9773         MOVE CR-AH-STATUS-AT-CANCEL
  9774                                    TO CR-AH-STATUS-AT-SETTLEMENT
  9775         MOVE ' '                       TO CR-AH-STATUS-AT-CANCEL.
  9776
  9777     PERFORM 8600-SETUP-DETAIL-LINE THRU 8689-SETUP-DETAIL-X.
  9778
  9779     MOVE 'VOID CANCL'                  TO TRD-AH-ACTION.
  9780     MOVE CR-AH-CURRENT-STATUS          TO TRD-AH-STATUS.
  9781
  9782     PERFORM 8690-PRINT-DETAIL-LINE THRU 8699-PRT-DETAIL-X.
  9783
  9784 0690-END-CANCEL-PROCESSING.
  9785
  9786     IF CR-LF-CANC-DT = ZEROS  AND
  9787        CR-AH-CANC-DT = ZEROS
  9788         MOVE ZEROS             TO CR-CAN-MICROFILM-NO.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 189
* ECS010P.cbl
*  12-S*****************************************************           ( 181)**
**    Operand CR-CAN-MICROFILM-NO is not declared
  9789
  9790     IF LIFE-REFUND = ZERO  AND  A-H-REFUND = ZERO
  9791         NEXT SENTENCE
  9792     ELSE
  9793         MOVE 'X'               TO REIN-RT-SW
  9794         PERFORM 3200-REINSURE-CANCEL THRU 3299-REINSURE-CANCEL-X
  9795         MOVE ' '               TO REIN-RT-SW.
  9796
  9797     MOVE '*'                   TO TRANSACTION-FLAG.
  9798     GO TO 0300-READ-PENDING-TRANSACTIONS.
  9799
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 190
* ECS010P.cbl
  9801******************************************************************
  9802***    P R O C E S S   C L A I M S   T R A N S A C T I O N S   ***
  9803******************************************************************
  9804
  9805 0700-PROCESS-CLAIMS.
  9806
  9807     IF NOT PC-LF-CLAIM  AND  NOT  PC-OB-LF-CLAIM  AND
  9808        NOT PC-AH-CLAIM  AND  NOT  PC-OB-AH-CLAIM
  9809         DISPLAY 'INVALID CLAIM TYPE TO ECS010 '
  9810             PENDING-MATCH-CONTROL
  9811         MOVE 0301 TO WS-ABEND-CODE
  9812         DISPLAY '******************************'
  9813         DISPLAY '***** ERROR LOCATION 011 *****'
  9814         DISPLAY '******************************'
  9815         MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
  9816         GO TO ABEND-PGM.
  9817
  9818     PERFORM 3000-REINSURE-ROUTINE THRU 3099-REINSURE-ROUTINE-X.
  9819
  9820     ADD +1                       TO  W-LF-CLAIMS.
  9821
  9822     MOVE PC-INCURRED-DT          TO  DC-BIN-DATE-1.
  9823     MOVE ' '                     TO  DC-OPTION-CODE.
  9824     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
  9825     MOVE DC-GREG-DATE-CYMD       TO  INCURRED-DATE.
  9826
  9827     MOVE PC-REPORTED-DT          TO  DC-BIN-DATE-1.
  9828     MOVE ' '                     TO  DC-OPTION-CODE.
  9829     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
  9830     MOVE DC-GREG-DATE-1-YMD      TO  REPORTED-DATE.
  9831
  9832     MOVE PC-PAYMENT-DT           TO  DC-BIN-DATE-1.
  9833     MOVE ' '                     TO  DC-OPTION-CODE.
  9834     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
  9835     MOVE DC-GREG-DATE-CYMD       TO  PAYMENT-DATE.
  9836
  9837     MOVE PC-PAID-THRU-DT         TO  DC-BIN-DATE-1.
  9838     MOVE ' '                     TO  DC-OPTION-CODE.
  9839     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
  9840     MOVE DC-GREG-DATE-CYMD       TO  PAY-TO-DATE.
  9841
  9842     PERFORM 8600-SETUP-DETAIL-LINE THRU 8689-SETUP-DETAIL-X.
  9843
  9844     IF DTE-CLIENT = 'LAP'  OR  'RMC'
  9845       MOVE PC-CHECK-NO            TO WS-CHECK-NUMBER
  9846       IF WS-CHECK-NO = 'DEDU'  OR  ' DED'  OR  '0DED'
  9847         IF CR-CLAIM-DEDUCT-WITHHELD = +99999.99
  9848             MOVE PC-CLAIM-PAYMENT TO CR-CLAIM-DEDUCT-WITHHELD
  9849         ELSE
  9850             ADD PC-CLAIM-PAYMENT  TO CR-CLAIM-DEDUCT-WITHHELD.
  9851
  9852     IF PC-AH-CLAIM  OR  PC-OB-AH-CLAIM
  9853         GO TO 0750-PROCESS-DISABILITY-CLAIM.
  9854
  9855******************************************************************
  9856***           P R O C E S S   D E A T H   C L A I M            ***
  9857******************************************************************
  9858
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 191
* ECS010P.cbl
  9859     IF REIN-IS-RISK-PREMIUM
  9860       IF CR-DTH-DT = ZEROS
  9861           MOVE INCURRED-DATE      TO DC-GREG-DATE-CYMD
  9862           PERFORM 3025-CALC-ELAPSED-MONTHS THRU 3026-CALC-EXIT
  9863           MOVE DC-ELAPSED-MONTHS  TO REIN-LF-CLM-MONTHS.
  9864
  9865     MOVE INCURRED-DATE            TO CR-DTH-DT
  9866                                      WS-CR-DTH-DT-N.
  9867
  9868     IF PC-CHARGEBLE-EXPENSE  OR
  9869        PC-NON-CHARGEBLE-EXPENSE
  9870         IF CR-LFTYP = '00'
  9871             MOVE '99'             TO CR-LFTYP  CLAS-LOOK
  9872             PERFORM 8300-LIFE-TYPE-LOOKUP THRU
  9873                     8399-LIFE-LOOKUP-X.
  9874
  9875     IF PC-CHARGEBLE-EXPENSE  OR
  9876        PC-NON-CHARGEBLE-EXPENSE
  9877         ADD PC-CLAIM-PAYMENT      TO CR-DTHEXP
  9878         ADD PC-CLAIM-PAYMENT      TO CR-DTHEXP-YTD
  9879         ADD PC-CLAIM-PAYMENT      TO TPL-CLAIMS (1)
  9880         MOVE PC-CLAIM-PAYMENT     TO TRD-LFCOM-CLM
  9881         MOVE 'CLAIM EXP '         TO TRD-LF-ACTION
  9882         GO TO 0780-END-CLAIMS-PROCESSING.
  9883
  9884     ADD +1                       TO  CR-NUM-DTH-CLM.
  9885     MOVE REPORTED-DATE           TO  CR-DTH-RPT-DT.
  9886     MOVE PAYMENT-DATE            TO  CR-DTH-PAY-DT
  9887                                      WS-CR-DTH-PAY-DT-N.
  9888
  9889     ADD PC-CLAIM-PAYMENT         TO  CR-DTHAMT.
  9890     ADD PC-CLAIM-PAYMENT         TO  CR-DTHAMT-YTD.
  9891     MOVE PC-CLAIM-PAYMENT        TO  CR-DTHAMT-LAST.
  9892     MOVE PC-AGE-AT-CLAIM         TO  CR-DTH-AGE.
  9893     IF CR-DTH-PAY-CD NOT = 'F'
  9894         MOVE PC-PAYMENT-TYPE     TO  CR-DTH-PAY-CD.
  9895     INSPECT CR-DTH-PAY-CD
  9896         CONVERTING '12349' TO 'PFSXV'.
  9897     MOVE PC-CAUSE-CODE           TO  CR-DEATH-CAUSE.
  9898
  9899     IF (LIFE-OVERRIDE-L1 EQUAL 'P'  OR
  9900         CLAS-I-RL-AH (CLAS-INDEXL) EQUAL 'P')
  9901       AND
  9902       (CR-DTHAMT LESS THAN (CR-LFAMT + CR-LFAMT-ALT)
  9903       OR
  9904        DTE-CLIENT = 'ACC' OR 'FDL')
  9905        NEXT SENTENCE
  9906     ELSE
  9907     IF (CLAS-I-CALC-TYPE (CLAS-INDEXL) NOT = 'Z')
  9908         IF CR-LF-CLAIM-EXIT-DATE = ZEROS
  9909             MOVE CR-LF-CURRENT-STATUS TO CR-LF-STATUS-AT-DEATH
  9910             MOVE '7'            TO CR-LF-CURRENT-STATUS
  9911             MOVE EOM-RUN-DATE   TO CR-LF-CLAIM-EXIT-DATE
  9912                                    WS-CR-LF-CLAIM-EXIT-DATE-N.
  9913
  9914     MOVE CLAS-I-AB3 (CLAS-INDEXL)     TO TRD-LFTYP.
  9915     MOVE CR-LF-TERM                   TO TRD-LFTRM.
  9916     MOVE PC-CLAIM-PAYMENT        TO  TRD-LFCOM-CLM.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 192
* ECS010P.cbl
  9917     IF CLAS-I-RL-AH (CLAS-INDEXL) = 'P'
  9918         MOVE 'PROPERTY  '       TO TRD-LF-ACTION
  9919     ELSE
  9920         MOVE 'CLAIM PYMT'       TO TRD-LF-ACTION.
  9921     MOVE CR-LF-CURRENT-STATUS   TO TRD-LF-STATUS.
  9922
  9923     IF NOT CR-POLICY-IS-REIN-ONLY
  9924         ADD PC-CLAIM-PAYMENT    TO TPL-CLAIMS (1).
  9925
  9926 0720-CANCEL-AH-COVERAGE.
  9927
  9928     IF CR-AHTYP = ZEROS  OR
  9929        NOT CR-AH-POLICY-IS-ACTIVE
  9930         GO TO 0740-DEATH-CLAIM-VOID.
  9931
  9932     MOVE CR-AH-CURRENT-STATUS          TO CR-AH-STATUS-AT-CANCEL.
  9933     MOVE '7'                           TO CR-AH-CURRENT-STATUS.
  9934     MOVE CR-DTH-DT                     TO CR-AH-CANC-DT
  9935                                           WS-CR-AH-CANC-DT-N.
  9936     MOVE EOM-RUN-DATE               TO CR-AH-CANCEL-EXIT-DATE
  9937                                     WS-CR-AH-CANCEL-EXIT-DATE-N.
  9938
  9939     MOVE CLAS-I-AB3 (CLAS-INDEXA)      TO TRD-AHTYP.
  9940     MOVE CR-AH-TERM                    TO TRD-AHTRM.
  9941     MOVE CR-DTH-MO                     TO TRD-AHACTMO.
  9942     MOVE CR-DTH-DA                     TO TRD-AHACTDA.
  9943     MOVE CR-DTH-YR                     TO TRD-AHACTYR.
  9944     MOVE '/'                           TO TRD-AH-S1  TRD-AH-S2.
  9945     MOVE 'CLAIM CANC'                  TO TRD-AH-ACTION.
  9946     MOVE CR-AH-CURRENT-STATUS          TO TRD-AH-STATUS.
  9947
  9948 0740-DEATH-CLAIM-VOID.
  9949
  9950     IF CR-DTHAMT = ZERO  AND
  9951        PC-CLAIM-PAYMENT NEGATIVE
  9952         NEXT SENTENCE
  9953     ELSE
  9954         GO TO 0780-END-CLAIMS-PROCESSING.
  9955
  9956     MOVE '*'                           TO DEATH-VOID-FLAG.
  9957
  9958     MOVE ZEROS                         TO CR-LF-CLAIM-EXIT-DATE
  9959                                        WS-CR-LF-CLAIM-EXIT-DATE-N
  9960                                           CR-NUM-DTH-CLM
  9961                                           CR-DTH-RPT-DT
  9962                                           CR-DTH-PAY-DT
  9963                                           WS-CR-DTH-PAY-DT-N
  9964*                                          CR-DTHAMT-YTD
  9965*                                          CR-DTHAMT-LAST
  9966                                           CR-DTH-AGE.
  9967     MOVE ' '                           TO CR-DTH-PAY-CD.
  9968
  9969     IF CR-LF-DEATH-CLAIM-APPLIED
  9970         MOVE CR-LF-STATUS-AT-DEATH     TO CR-LF-CURRENT-STATUS
  9971         MOVE ' '                       TO CR-LF-STATUS-AT-DEATH
  9972     ELSE
  9973         MOVE CR-LF-STATUS-AT-DEATH     TO CR-LF-STATUS-AT-CANCEL
  9974         MOVE ' '                       TO CR-LF-STATUS-AT-DEATH.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 193
* ECS010P.cbl
  9975
  9976     MOVE 'VOID CLAIM'                  TO TRD-LF-ACTION.
  9977     MOVE CR-LF-CURRENT-STATUS          TO TRD-LF-STATUS.
  9978
  9979     IF CR-AH-DEATH-CLAIM-APPLIED
  9980         MOVE CR-AH-STATUS-AT-CANCEL    TO CR-AH-CURRENT-STATUS
  9981         MOVE ' '                       TO CR-AH-STATUS-AT-CANCEL
  9982         MOVE ZEROS                     TO CR-AH-CANC-DT
  9983                                           WS-CR-AH-CANC-DT-N
  9984                                           CR-AH-CANCEL-EXIT-DATE
  9985                                       WS-CR-AH-CANCEL-EXIT-DATE-N
  9986         MOVE CLAS-I-AB3 (CLAS-INDEXA)  TO TRD-AHTYP
  9987         MOVE CR-AH-TERM                TO TRD-AHTRM
  9988         MOVE 'VOID CANCL'              TO TRD-AH-ACTION
  9989         MOVE CR-AH-CURRENT-STATUS      TO TRD-AH-STATUS.
  9990
  9991     GO TO 0780-END-CLAIMS-PROCESSING.
  9992
  9993******************************************************************
  9994***       P R O C E S S   D I S A B I L I T Y   C L A I M      ***
  9995******************************************************************
  9996
  9997 0750-PROCESS-DISABILITY-CLAIM.
  9998
  9999     ADD +1                       TO W-AH-CLAIMS.
 10000
 10001     MOVE INCURRED-DATE           TO CR-DIS-DT
 10002                                     WS-CR-DIS-DT-N.
 10003
 10004     PERFORM 0790-TABLE-DISAB-PERIODS THRU 0791-TABLE-AH-EXIT.
 10005
 10006     IF REIN-AH-CLM-MONTHS = +1
 10007         MOVE REIN-AH-CLM-MTH-1        TO REIN-AH-CLM-MONTHS
 10008     ELSE
 10009       IF REIN-AH-CLM-MONTHS = +2
 10010           MOVE REIN-AH-CLM-MTH-2      TO REIN-AH-CLM-MONTHS
 10011       ELSE
 10012         IF REIN-AH-CLM-MONTHS = +3
 10013             MOVE REIN-AH-CLM-MTH-3    TO REIN-AH-CLM-MONTHS
 10014         ELSE
 10015           IF REIN-AH-CLM-MONTHS = +4
 10016               MOVE REIN-AH-CLM-MTH-4  TO REIN-AH-CLM-MONTHS
 10017           ELSE
 10018               MOVE REIN-AH-CLM-MTH-5  TO REIN-AH-CLM-MONTHS.
 10019
 10020     IF PC-CHARGEBLE-EXPENSE  OR
 10021        PC-NON-CHARGEBLE-EXPENSE
 10022         IF CR-AHTYP = '00'
 10023             MOVE '99'             TO CR-AHTYP  CLAS-LOOK
 10024             PERFORM 8400-A-H-TYPE-LOOKUP THRU
 10025                     8499-A-H-LOOKUP-X.
 10026
 10027     IF PC-CHARGEBLE-EXPENSE  OR
 10028        PC-NON-CHARGEBLE-EXPENSE
 10029         ADD PC-CLAIM-PAYMENT      TO CR-DISEXP
 10030         ADD PC-CLAIM-PAYMENT      TO CR-DISEXP-YTD
 10031         ADD PC-CLAIM-PAYMENT      TO TPA-CLAIMS (1)
 10032         MOVE PC-CLAIM-PAYMENT     TO TRD-AHCOM-CLM
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 194
* ECS010P.cbl
 10033         MOVE 'CLAIM EXP '         TO TRD-AH-ACTION
 10034         GO TO 0780-END-CLAIMS-PROCESSING.
 10035
 10036     ADD +1                       TO CR-NUM-DIS-CLM.
 10037
 10038     MOVE REPORTED-DATE           TO  CR-DIS-RPT-DT.
 10039     MOVE PAYMENT-DATE            TO  CR-DIS-PAY-DT
 10040                                      WS-CR-DIS-PAY-DT-N.
 10041     MOVE PAY-TO-DATE             TO  CR-DIS-PTO-DT
 10042                                      WS-CR-DIS-PTO-DT-N.
 10043
 10044     ADD  PC-CLAIM-PAYMENT         TO CR-DISAMT.
 10045     ADD  PC-CLAIM-PAYMENT         TO CR-DISAMT-YTD.
 10046     MOVE PC-CLAIM-PAYMENT         TO CR-DISAMT-LAST.
 10047
 10048     MOVE PC-NO-OF-DAYS-PAID       TO CR-DAYS-DISAB.
 10049     IF CR-DIS-PAY-CD NOT = 'S'
 10050         MOVE PC-PAYMENT-TYPE      TO CR-DIS-PAY-CD.
 10051     INSPECT CR-DIS-PAY-CD
 10052         CONVERTING '12349' TO 'PFSXV'.
 10053     MOVE PC-CAUSE-CODE            TO CR-DISAB-CAUSE.
 10054
 10055     IF PC-LUMP-SUM-PAYMENT
 10056         IF CR-AH-SETTLEMENT-EXIT-DATE = ZEROS
 10057           MOVE CR-AH-CURRENT-STATUS TO CR-AH-STATUS-AT-SETTLEMENT
 10058           MOVE '6'                  TO CR-AH-CURRENT-STATUS
 10059           MOVE EOM-RUN-DATE    TO CR-AH-SETTLEMENT-EXIT-DATE
 10060                                   WS-CR-AH-SETTLEMENT-EXIT-DATEN.
 10061
 10062     MOVE CLAS-I-AB3 (CLAS-INDEXA) TO TRD-AHTYP.
 10063     MOVE CR-AH-TERM               TO TRD-AHTRM.
 10064     MOVE PC-CLAIM-PAYMENT         TO TRD-AHCOM-CLM.
 10065     MOVE 'CLAIM PYMT'             TO TRD-AH-ACTION.
 10066     MOVE CR-AH-CURRENT-STATUS     TO TRD-AH-STATUS.
 10067
 10068     IF NOT CR-POLICY-IS-REIN-ONLY
 10069         ADD PC-CLAIM-PAYMENT      TO TPA-CLAIMS (1).
 10070
 10071     IF NOT PC-LUMP-SUM-PAYMENT
 10072         GO TO 0780-END-CLAIMS-PROCESSING.
 10073
 10074 0770-CANCEL-LF-COVERAGE.
 10075
 10076     IF CR-LFTYP = ZEROS  OR
 10077        NOT CR-LF-POLICY-IS-ACTIVE
 10078         GO TO 0780-END-CLAIMS-PROCESSING.
 10079
 10080     MOVE CR-LF-CURRENT-STATUS          TO CR-LF-STATUS-AT-CANCEL.
 10081     MOVE '6'                           TO CR-LF-CURRENT-STATUS.
 10082     MOVE CR-DIS-PAY-DT                 TO CR-LF-CANC-DT
 10083                                           WS-CR-LF-CANC-DT-N.
 10084     MOVE EOM-RUN-DATE               TO CR-LF-CANCEL-EXIT-DATE
 10085                                     WS-CR-LF-CANCEL-EXIT-DATE-N.
 10086
 10087     MOVE CLAS-I-AB3 (CLAS-INDEXL)      TO TRD-LFTYP.
 10088     MOVE CR-LF-TERM                    TO TRD-LFTRM.
 10089     MOVE CR-DIS-PAY-MO                 TO TRD-LFACTMO.
 10090     MOVE CR-DIS-PAY-DA                 TO TRD-LFACTDA.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 195
* ECS010P.cbl
 10091     MOVE CR-DIS-PAY-YR                 TO TRD-LFACTYR.
 10092     MOVE '/'                           TO TRD-LF-S1  TRD-LF-S2.
 10093     MOVE 'CLAIM CANC'                  TO TRD-LF-ACTION.
 10094     MOVE CR-LF-CURRENT-STATUS          TO TRD-LF-STATUS.
 10095
 10096 0780-END-CLAIMS-PROCESSING.
 10097
 10098     IF PC-LF-CLAIM  OR  PC-OB-LF-CLAIM
 10099         MOVE DTO-MO               TO TRD-LFACTMO
 10100         MOVE DTO-DA               TO TRD-LFACTDA
 10101         MOVE DTO-YR               TO TRD-LFACTYR
 10102         MOVE '/'                  TO TRD-LF-S1  TRD-LF-S2
 10103     ELSE
 10104         MOVE PAY-MO               TO TRD-AHACTMO
 10105         MOVE PAY-DA               TO TRD-AHACTDA
 10106         MOVE PAY-YR               TO TRD-AHACTYR
 10107         MOVE '/'                  TO TRD-AH-S1  TRD-AH-S2.
 10108
 10109     PERFORM 8690-PRINT-DETAIL-LINE THRU 8699-PRT-DETAIL-X.
 10110
 10111     IF NOT CR-POLICY-IS-REIN-ONLY
 10112         PERFORM 2300-BUILD-CLAIM-EXTRACT THRU 2399-BLD-CLAIM-X
 10113         ADD +1                    TO BC-G-CLM.
 10114
 10115     PERFORM 3300-REINSURE-CLAIM THRU 3399-REINSURE-CLAIM-X.
 10116
 10117     IF DEATH-CLAIM-VOIDED
 10118         MOVE ZEROS                TO CR-DTH-DT
 10119                                      WS-CR-DTH-DT-N.
 10120     MOVE SPACE                    TO DEATH-VOID-FLAG.
 10121
 10122     MOVE '*'                      TO TRANSACTION-FLAG.
 10123     GO TO 0300-READ-PENDING-TRANSACTIONS.
 10124
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 196
* ECS010P.cbl
 10126 0790-TABLE-DISAB-PERIODS.
 10127
 10128     MOVE +1                       TO SUB14.
 10129     PERFORM 0794-REVIEW-TABLE     THRU 0794-REVIEW-TABLE-EXIT.
 10130
 10131     MOVE +1                       TO SUB14.
 10132
 10133**************************************************************
 10134**                                                          **
 10135**   THIS ROUTINE SEARCHES THROUGH THE DISAB-DETAIL-DATA    **
 10136**  AND MATCHES INCURRED DATE.  IT THEN ADDS THE AMOUNT OF  **
 10137**  THE CLAIM TO THAT OCCURRENCE.  IF THE INCURRED DATE     **
 10138**  DOES NOT MATCH ANY PREVIOUS INCURRED DATE,  IT WILL     **
 10139**  INITIALIZE THE NEXT OCCURRENCE.  (OLDEST TO MOST RECENT)**
 10140**                                                          **
 10141**    IF ALL 5 OCCURRENCES ARE FILLED,  THE TWO OLDEST      **
 10142**  AMOUNTS ARE COMBINED LEAVING THE LAST OCCURRENCE OPEN   **
 10143**  FOR THE MOST RECENT CLAIM INFORMATION.                  **
 10144**                                                          **
 10145**************************************************************
 10146
 10147 0791-TABLE-AH-AMOUNT.
 10148
 10149     IF SUB14 GREATER THAN DISABILITY-TBL-MAX
 10150         PERFORM 0792-MOVE-TABLE  THRU 0792-MOVE-TABLE-EXIT.
 10151
 10152     IF CR-DIS-INCUR-DT (SUB14)  EQUAL ZEROS
 10153         MOVE INCURRED-DATE        TO CR-DIS-INCUR-DT (SUB14)
 10154                                      WS-CR-DIS-INCUR-DT-N (SUB14)
 10155         IF REIN-IS-RISK-PREMIUM
 10156             MOVE INCURRED-DATE     TO DC-GREG-DATE-CYMD
 10157             PERFORM 3025-CALC-ELAPSED-MONTHS THRU 3026-CALC-EXIT
 10158             IF SUB14 = +1
 10159               MOVE DC-ELAPSED-MONTHS TO REIN-AH-CLM-MTH-1
 10160             ELSE
 10161             IF SUB14 = +2
 10162               MOVE DC-ELAPSED-MONTHS TO REIN-AH-CLM-MTH-2
 10163             ELSE
 10164             IF SUB14 = +3
 10165               MOVE DC-ELAPSED-MONTHS TO REIN-AH-CLM-MTH-3
 10166             ELSE
 10167             IF SUB14 = +4
 10168               MOVE DC-ELAPSED-MONTHS TO REIN-AH-CLM-MTH-4
 10169             ELSE
 10170               MOVE DC-ELAPSED-MONTHS TO REIN-AH-CLM-MTH-5.
 10171
 10172
 10173     IF INCURRED-DATE EQUAL CR-DIS-INCUR-DT (SUB14)
 10174         MOVE SUB14                TO REIN-AH-CLM-MONTHS
 10175         COMPUTE REIN-AH-PRIOR-CLMS-PAID = CR-INCUR-DISAMT (SUB14)
 10176                                        +  CR-INCUR-DISEXP (SUB14)
 10177         IF PC-CHARGEBLE-EXPENSE  OR
 10178            PC-NON-CHARGEBLE-EXPENSE
 10179             ADD PC-CLAIM-PAYMENT  TO CR-INCUR-DISEXP (SUB14)
 10180             GO TO 0791-TABLE-AH-EXIT
 10181         ELSE
 10182             ADD  PC-CLAIM-PAYMENT TO CR-INCUR-DISAMT (SUB14)
 10183             GO TO 0791-TABLE-AH-EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 197
* ECS010P.cbl
 10184
 10185     ADD +1                       TO SUB14.
 10186
 10187     GO TO 0791-TABLE-AH-AMOUNT.
 10188
 10189 0791-TABLE-AH-EXIT.
 10190     EXIT.
 10191
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 198
* ECS010P.cbl
 10193**************************************************************
 10194**                                                          **
 10195** THIS ROUTINE IS PERFORMED WHEN THERE HAVE BEEN MORE THAN **
 10196** 5 DISABILITY PERIODS ATTACHED TO THE SAME CERTIFICATE.   **
 10197**                                                          **
 10198** THE SECOND OCCURRENCE IS ADDED TO THE 1ST OCCURRENCE     **
 10199** COMBINING THE TWO OLDEST OCCURRENCES INTO ONE BUCKET     **
 10200** THE NEWEST CLAIM INFORMATION IS MOVED INTO THE LAST      **
 10201** OCCURRENCE.                                              **
 10202**************************************************************
 10203 0792-MOVE-TABLE.
 10204
 10205     MOVE CR-DIS-INCUR-DT (2)  TO CR-DIS-INCUR-DT (1)
 10206                                  WS-CR-DIS-INCUR-DT-N (1).
 10207     ADD  CR-INCUR-DISAMT (2)  TO CR-INCUR-DISAMT (1).
 10208     ADD  CR-INCUR-DISEXP (2)  TO CR-INCUR-DISEXP (1).
 10209
 10210     MOVE +2                   TO SUB14.
 10211     MOVE +3                   TO SUB15.
 10212     PERFORM 0794A-BUMP-TBL    THRU 0794A-BUMP-TBL-EXIT.
 10213
 10214     MOVE DISABILITY-TBL-MAX   TO SUB14.
 10215
 10216     MOVE INCURRED-DATE        TO CR-DIS-INCUR-DT (SUB14)
 10217                                  WS-CR-DIS-INCUR-DT-N (SUB14).
 10218
 10219 0792-MOVE-TABLE-EXIT.
 10220     EXIT.
 10221
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 199
* ECS010P.cbl
 10223**************************************************************
 10224**                                                          **
 10225**  A REVIEW OF ALL OCCURRENCES IS PERFORMED TO ELIMINATE   **
 10226** ANY WITH NO PAYMENTS OR EXPENSES ATTACHED. THESE CAN     **
 10227** OCCUR WHEN DISABILITY PAYMENTS HAVE BEEN VOIDED, BECAUSE **
 10228** CLAIM ATTACHED TO WRONG CERTIFICATE, OR WRONG CLAIM TYPE **
 10229** PAID, OR A CHANGE IN THE INCURRED DATE OF A CLAIM.       **
 10230**************************************************************
 10231
 10232 0794-REVIEW-TABLE.
 10233
 10234     IF SUB14 GREATER THAN DISABILITY-TBL-MAX
 10235         GO TO 0794-REVIEW-TABLE-EXIT.
 10236
 10237     IF CR-DIS-INCUR-DT (SUB14) EQUAL ZEROS
 10238         GO TO 0794-REVIEW-TABLE-EXIT.
 10239
 10240     IF CR-INCUR-DISAMT (SUB14) EQUAL ZEROS  AND
 10241        CR-INCUR-DISEXP (SUB14) EQUAL ZEROS
 10242         DISPLAY CR-ACCOUNT ' ' CR-CERT-NO ' ' SUB14
 10243         MOVE ZEROS            TO CR-DIS-INCUR-DT (SUB14)
 10244                                  WS-CR-DIS-INCUR-DT-N (SUB14)
 10245         MOVE SUB14            TO SUB15
 10246         ADD +1                TO SUB15
 10247         PERFORM 0794A-BUMP-TBL   THRU 0794A-BUMP-TBL-EXIT
 10248         MOVE +1               TO SUB14
 10249         GO TO 0794-REVIEW-TABLE.
 10250
 10251     ADD +1                    TO SUB14.
 10252
 10253     GO TO 0794-REVIEW-TABLE.
 10254
 10255 0794-REVIEW-TABLE-EXIT.
 10256     EXIT.
 10257
 10258 0794A-BUMP-TBL.
 10259
 10260     IF SUB15 GREATER THAN DISABILITY-TBL-MAX
 10261         GO TO 0794A-BUMP-TBL-EXIT.
 10262
 10263     MOVE CR-DISAB-DETAIL-DATA (SUB15)  TO
 10264                             CR-DISAB-DETAIL-DATA (SUB14).
 10265
 10266     MOVE ZEROS                TO CR-DIS-INCUR-DT (SUB15)
 10267                                  WS-CR-DIS-INCUR-DT-N (SUB15)
 10268                                  CR-INCUR-DISAMT (SUB15)
 10269                                  CR-INCUR-DISEXP (SUB15).
 10270
 10271     ADD +1                    TO SUB14
 10272                                  SUB15.
 10273     GO TO 0794A-BUMP-TBL.
 10274
 10275 0794A-BUMP-TBL-EXIT.
 10276     EXIT.
 10277
 10278 0795-DCC-NSP-LF.
 10279
 10280     MOVE CR-DT                      TO DC-GREG-DATE-CYMD.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 200
* ECS010P.cbl
 10281     MOVE 'L'                        TO DC-OPTION-CODE.
 10282     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 10283     MOVE DC-BIN-DATE-1              TO CP-CERT-EFF-DT.
 10284     MOVE SPACES                     TO CP-ACCT-FLD-5.
 10285     MOVE DTE-CLIENT                 TO CP-COMPANY-ID.
 10286     MOVE CR-AGE                     TO CP-ISSUE-AGE.
 10287     MOVE CR-APR                     TO CP-LOAN-APR.
 10288     MOVE CR-PMT-FREQ                TO CP-PAY-FREQUENCY.
 10289     MOVE CR-LOAN-TERM               TO CP-LOAN-TERM.
 10290     MOVE ZEROS                      TO CP-DEVIATION-CODE.
 10291     MOVE CR-RATING-CLASS            TO CP-CLASS-CODE.
 10292
 10293     MOVE '3'                        TO CP-PROCESS-TYPE.
 10294     MOVE DTE-CLASIC-COMPANY-CD      TO CP-COMPANY-CD.
 10295     MOVE CR-PMT-EXTENSION-DAYS      TO CP-TERM-OR-EXT-DAYS.
 10296
 10297     IF CR-LFTYP = ZERO
 10298         GO TO 0795-EXIT
 10299     END-IF
 10300
 10301     IF (CLAS-I-BAL (CLAS-INDEXL) = 'B')
 10302         GO TO 0795-EXIT
 10303     END-IF
 10304     MOVE CR-LFPRM                   TO CP-ORIGINAL-PREMIUM
 10305     MOVE CLAS-I-RL-AH (CLAS-INDEXL) TO CP-BENEFIT-TYPE.
 10306     MOVE CR-LF-TERM                 TO CP-ORIGINAL-TERM.
 10307     MOVE CR-LFAMT                   TO CP-ORIGINAL-BENEFIT
 10308                                        CP-RATING-BENEFIT-AMT.
 10309     MOVE CLAS-I-EP (CLAS-INDEXL)    TO CP-EARNING-METHOD.
 10310     MOVE CLAS-I-BAL (CLAS-INDEXL)   TO CP-SPECIAL-CALC-CD.
 10311     MOVE CR-LFTYP                   TO CP-BENEFIT-CD.
 10312     MOVE LIFE-OVERRIDE-L1           TO CP-LIFE-OVERRIDE-CODE.
 10313     MOVE ZEROS                      TO CP-RATE-DEV-PCT.
 10314     MOVE CR-STATE                   TO CP-STATE.
 10315     MOVE STATE-ABBR (CLAS-INDEXS)   TO CP-STATE-STD-ABBRV.
 10316
 10317     IF CP-STATE-STD-ABBRV = 'OR'
 10318         COMPUTE CP-RATING-BENEFIT-AMT = CR-LFAMT + CR-LFAMT-ALT.
 10319
 10320     PERFORM 8100-GET-RATE THRU 8199-GET-RATE-X.
 10321
 10322     IF CP-ERROR-RATE-NOT-FOUND  OR
 10323        CP-ERROR-RATE-IS-ZERO
 10324         MOVE 'LIFE NET SINGLE PREMIUM RATE NOT FOUND'
 10325                                     TO WS-ABEND-MESSAGE
 10326         MOVE 0302                   TO WS-ABEND-CODE
 10327         DISPLAY '******************************'
 10328         DISPLAY '***** ERROR LOCATION 018 *****'
 10329         DISPLAY '******************************'
 10330         MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
 10331         GO TO ABEND-PGM.
 10332
 10333     MOVE CP-CALC-PREMIUM          TO CR-LF-NSP-PRM.
 10334
 10335*    COMPUTE CR-LF-NSP-PRM ROUNDED =
 10336*                      (CR-LFAMT / 100) * CP-PREMIUM-RATE.
 10337
 10338     COMPUTE CR-LF-NSP-PRM ROUNDED =  CR-LF-NSP-PRM +
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 201
* ECS010P.cbl
 10339                   ((CR-LFAMT-ALT / 100) * CP-PREMIUM-RATE).
 10340
 10341     MOVE CP-PREMIUM-RATE            TO CR-LF-NSP-PRM-RATE.
 10342
 10343 0795-exit.
 10344     exit.
 10345
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 202
* ECS010P.cbl
 10347******************************************************************
 10348***   P R O C E S S   R E S E R V E   T R A N S A C T I O N S  ***
 10349******************************************************************
 10350
 10351 0800-PROCESS-RESERVES.
 10352
 10353     IF PC-AH-CLAIM  OR  PC-OB-AH-CLAIM
 10354       IF CARRIER-UEP-PCT (CLAS-INDEXCN) NOT = ZEROS
 10355           MOVE ZEROS             TO  PC-IBNR-RESERVE-AMT.
 10356
 10357     PERFORM 3000-REINSURE-ROUTINE THRU 3099-REINSURE-ROUTINE-X.
 10358
 10359     MOVE PC-INCURRED-DT          TO  DC-BIN-DATE-1.
 10360     MOVE ' '                     TO  DC-OPTION-CODE.
 10361     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 10362     MOVE DC-GREG-DATE-CYMD       TO  INCURRED-DATE.
 10363
 10364     MOVE PC-REPORTED-DT          TO  DC-BIN-DATE-1.
 10365     MOVE ' '                     TO  DC-OPTION-CODE.
 10366     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 10367     MOVE DC-GREG-DATE-1-YMD      TO  REPORTED-DATE.
 10368
 10369     MOVE PC-PAID-THRU-DT         TO  DC-BIN-DATE-1.
 10370     MOVE ' '                     TO  DC-OPTION-CODE.
 10371     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 10372     MOVE DC-GREG-DATE-CYMD       TO  PAY-TO-DATE.
 10373
 10374     PERFORM 8600-SETUP-DETAIL-LINE THRU 8689-SETUP-DETAIL-X.
 10375
 10376     IF PC-LF-CLAIM  OR  PC-OB-LF-CLAIM
 10377         ADD +1                     TO W-LF-RESERVES
 10378         ADD PC-IBNR-RESERVE-AMT    TO DTH-IBNR
 10379         ADD PC-PTC-RESERVE-AMT     TO DTH-PAYCUR
 10380         ADD PC-FUTURE-RESERVE-AMT  TO DTH-FUTRSV
 10381         ADD PC-MANUAL-RESERVE-AMT  TO DTH-FUTRSV
 10382         MOVE INCURRED-DATE         TO CR-DTH-DT
 10383                                       WS-CR-DTH-DT-N
 10384         MOVE LIFE-OVERRIDE-L6      TO TRD-RSV-DESC
 10385
 10386     ELSE
 10387         ADD +1                     TO W-AH-RESERVES
 10388         ADD PC-IBNR-RESERVE-AMT    TO DIS-IBNR
 10389         ADD PC-PTC-RESERVE-AMT     TO DIS-PAYCUR
 10390         ADD PC-FUTURE-RESERVE-AMT  TO DIS-FUTRSV
 10391         ADD PC-MANUAL-RESERVE-AMT  TO DIS-FUTRSV
 10392         MOVE INCURRED-DATE         TO CR-DIS-DT
 10393                                       WS-CR-DIS-DT-N
 10394         MOVE AH-OVERRIDE-L6        TO TRD-RSV-DESC.
 10395
 10396     MOVE PC-IBNR-RESERVE-AMT       TO TRD-IBNR.
 10397     MOVE 'IBNR'                    TO TRD-IBNRX.
 10398     MOVE PC-PTC-RESERVE-AMT        TO TRD-PAYCUR.
 10399     MOVE 'PAY CURR'                TO TRD-PAYCURX.
 10400     COMPUTE TRD-FUTRSV EQUAL
 10401            (PC-FUTURE-RESERVE-AMT + PC-MANUAL-RESERVE-AMT).
 10402     MOVE 'FUTURE'                  TO TRD-FUTRSVX.
 10403     MOVE ' CLAIM RESERVES      '   TO TRD-RSV-ACTION.
 10404
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 203
* ECS010P.cbl
 10405 0820-END-RESERVE-PROCESSING.
 10406
 10407     PERFORM 8690-PRINT-DETAIL-LINE THRU 8699-PRT-DETAIL-X.
 10408
 10409     IF NOT CR-POLICY-IS-REIN-ONLY
 10410         PERFORM 2400-BUILD-RESERVE-EXTRACT THRU
 10411                                            2499-BLD-RESERVE-X
 10412         ADD +1 TO BC-G-CRS.
 10413
 10414     PERFORM 3400-REINSURE-RESERVE THRU 3499-REINSURE-RESERVE-X.
 10415
 10416     MOVE '*'                    TO TRANSACTION-FLAG.
 10417     GO TO 0300-READ-PENDING-TRANSACTIONS.
 10418
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 204
* ECS010P.cbl
 10420******************************************************************
 10421***    P R O C E S S   C H A N G E   T R A N S A C T I O N S   ***
 10422******************************************************************
 10423
 10424 0900-PROCESS-CERT-CHANGES.
 10425
 10426     PERFORM 8600-SETUP-DETAIL-LINE THRU 8689-SETUP-DETAIL-X.
 10427
 10428     IF CC-AGE NOT NUMERIC  OR
 10429        CC-AGE = CR-AGE
 10430         MOVE ZEROS TO CC-AGE.
 10431
 10432     IF CC-INSURED-JOINT-AGE NOT NUMERIC  OR
 10433        CC-INSURED-JOINT-AGE = CR-JOINT-AGE
 10434         MOVE ZEROS TO CC-INSURED-JOINT-AGE.
 10435
 10436     IF CC-INSURED-SEX NOT = 'M'  AND
 10437        CC-INSURED-SEX NOT = 'F'
 10438         MOVE SPACES TO CC-INSURED-SEX.
 10439
 10440     IF CC-LOAN-APR NOT NUMERIC  OR
 10441        CC-LOAN-APR = CR-APR
 10442         MOVE ZEROS TO CC-LOAN-APR.
 10443
 10444     IF CC-PAY-FREQUENCY NOT NUMERIC  OR
 10445        CC-PAY-FREQUENCY = CR-PMT-FREQ
 10446         MOVE ZEROS TO CC-PAY-FREQUENCY.
 10447
 10448     IF CC-IND-GRP-TYPE NOT = '1'  AND
 10449        CC-IND-GRP-TYPE NOT = '2'
 10450         MOVE SPACES TO CC-IND-GRP-TYPE.
 10451
 10452     IF CC-CLAIM-DEDUCT-WITHHELD NOT NUMERIC  OR
 10453        CC-CLAIM-DEDUCT-WITHHELD = CR-CLAIM-DEDUCT-WITHHELD
 10454         MOVE ZEROS TO CC-CLAIM-DEDUCT-WITHHELD.
 10455
 10456     IF CC-CANCEL-DEDUCT-WITHHELD NOT NUMERIC  OR
 10457        CC-CANCEL-DEDUCT-WITHHELD = CR-CANCEL-DEDUCT-WITHHELD
 10458         MOVE ZEROS TO CC-CANCEL-DEDUCT-WITHHELD.
 10459
 10460     IF CC-LF-ORIG-TERM NOT NUMERIC  OR
 10461        CC-LF-ORIG-TERM = CR-LF-TERM  OR
 10462        CR-LFTYP = ZEROS
 10463         MOVE ZEROS TO CC-LF-ORIG-TERM.
 10464
 10465     IF CC-AH-ORIG-TERM NOT NUMERIC  OR
 10466        CC-AH-ORIG-TERM = CR-AH-TERM  OR
 10467        CR-AHTYP = ZEROS
 10468         MOVE ZEROS TO CC-AH-ORIG-TERM.
 10469
 10470     IF CR-BILLED NOT NUMERIC
 10471         MOVE ZEROS TO CR-BILLED.
 10472
 10473     IF CR-LIVES NOT NUMERIC
 10474         MOVE ZEROS TO CR-LIVES.
 10475
 10476     IF CC-LIVES NOT NUMERIC  OR
 10477        CC-LIVES = CR-LIVES
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 205
* ECS010P.cbl
 10478         MOVE ZEROS TO CC-LIVES.
 10479
 10480     IF CC-BILLED NOT NUMERIC  OR
 10481        CC-BILLED = CR-BILLED
 10482         MOVE ZEROS TO CC-BILLED.
 10483
 10484     IF CC-INSURED-LAST-NAME NOT = SPACES
 10485         MOVE CC-INSURED-LAST-NAME   TO CR-LNAME.
 10486     IF CC-INSURED-FIRST-NAME NOT = SPACES
 10487         MOVE CC-INSURED-FIRST-NAME  TO CR-FNAME.
 10488     IF CC-INSURED-INITIAL2 NOT = SPACES
 10489         MOVE CC-INSURED-INITIAL2    TO CR-INIT.
 10490     IF CC-JT-LAST-NAME NOT = SPACES
 10491         MOVE CC-JT-LAST-NAME        TO CR-JT-LNAME.
 10492     IF CC-JT-FIRST-NAME NOT = SPACES
 10493         MOVE CC-JT-FIRST-NAME       TO CR-JT-FNAME.
 10494     IF CC-JT-INITIAL NOT = SPACES
 10495         MOVE CC-JT-INITIAL          TO CR-JT-INIT.
 10496
 10497     IF CC-AGE NOT = ZEROS
 10498         MOVE CC-AGE                 TO CR-AGE
 10499                                        DET-AGE
 10500     ELSE
 10501         MOVE ZEROS                  TO DET-AGE.
 10502
 10503     IF CC-INSURED-JOINT-AGE NOT = ZEROS
 10504         MOVE CC-INSURED-JOINT-AGE   TO CR-JOINT-AGE
 10505                                        DET-JT-AGE
 10506     ELSE
 10507         MOVE ZEROS                  TO DET-JT-AGE.
 10508
 10509     IF CC-INSURED-SEX NOT = SPACES
 10510         MOVE CC-INSURED-SEX         TO CR-SEX
 10511                                        DET-SEX
 10512     ELSE
 10513         MOVE SPACE                  TO DET-SEX.
 10514
 10515     IF CC-MEMBER-NO NOT = SPACES
 10516         MOVE CC-MEMBER-NO           TO CR-MEMBER-NO
 10517                                        DET-PR-MEM
 10518     ELSE
 10519         MOVE SPACES                 TO DET-PR-MEM.
 10520
 10521     IF CC-SOC-SEC-NO NOT = SPACES
 10522         MOVE CC-SOC-SEC-NO          TO CR-SOC-SEC
 10523                                        DET-PR-SS
 10524     ELSE
 10525         MOVE SPACES                 TO DET-PR-SS.
 10526
 10527     IF CC-LOAN-APR NOT = ZEROS
 10528         MOVE CC-LOAN-APR            TO CR-APR
 10529                                        DET-PR-APR
 10530     ELSE
 10531         MOVE ZEROS                  TO DET-PR-APR.
 10532
 10533     IF CC-AGE NOT = ZERO  OR
 10534        CC-INSURED-JOINT-AGE NOT = ZERO  OR
 10535        CC-INSURED-SEX NOT = SPACE  OR
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 206
* ECS010P.cbl
 10536        CC-MEMBER-NO NOT = SPACES  OR
 10537        CC-SOC-SEC-NO NOT = SPACES  OR
 10538        CC-LOAN-APR NOT = ZERO
 10539         MOVE DET-PR-UREC            TO TR-DTL2
 10540         MOVE 'Y'                    TO WS-CHANGE-REC-SW
 10541         PERFORM 8690-PRINT-DETAIL-LINE THRU 8699-PRT-DETAIL-X.
 10542
 10543     IF CC-LF-ORIG-TERM NOT = ZEROS
 10544         MOVE CR-LF-TERM             TO DET-O-LF-TERM
 10545         MOVE CC-LF-ORIG-TERM        TO CR-LF-TERM
 10546                                        DET-N-LF-TERM
 10547     ELSE
 10548         MOVE ZEROS                  TO DET-O-LF-TERM
 10549                                        DET-N-LF-TERM.
 10550
 10551     IF CC-AH-ORIG-TERM NOT = ZEROS
 10552         MOVE CR-AH-TERM             TO DET-O-AH-TERM
 10553         MOVE CC-AH-ORIG-TERM        TO CR-AH-TERM
 10554                                        DET-N-AH-TERM
 10555     ELSE
 10556         MOVE ZEROS                  TO DET-O-AH-TERM
 10557                                        DET-N-AH-TERM.
 10558
 10559     IF CC-LIVES NOT = ZEROS
 10560         MOVE CR-LIVES               TO DET-O-LIVES
 10561         MOVE CC-LIVES               TO CR-LIVES
 10562                                        DET-N-LIVES
 10563     ELSE
 10564         MOVE ZEROS                  TO DET-O-LIVES
 10565                                        DET-N-LIVES.
 10566
 10567     IF CC-BILLED NOT  = ZEROES
 10568         MOVE CC-BILLED              TO CR-BILLED.
 10569
 10570     IF CC-LF-ORIG-TERM NOT = ZERO  OR
 10571        CC-AH-ORIG-TERM NOT = ZERO  OR
 10572        CC-LIVES NOT = ZERO
 10573         MOVE DET-PR-UREC-2          TO TR-DTL2
 10574         MOVE 'Y'                    TO WS-CHANGE-REC-SW
 10575         PERFORM 8690-PRINT-DETAIL-LINE THRU 8699-PRT-DETAIL-X.
 10576
 10577     IF CC-IND-GRP-TYPE NOT = SPACES
 10578         MOVE CC-IND-GRP-TYPE        TO CR-IND-GRP
 10579                                        DET-IND-GRP
 10580     ELSE
 10581         MOVE SPACE                  TO DET-IND-GRP.
 10582
 10583     IF CC-PAY-FREQUENCY NOT = ZEROS
 10584         MOVE CC-PAY-FREQUENCY       TO CR-PMT-FREQ
 10585                                        DET-PMT-FREQ
 10586     ELSE
 10587         MOVE ZEROS                  TO DET-PMT-FREQ.
 10588
 10589     IF CC-POLICY-FORM-NO NOT = SPACES
 10590         MOVE CC-POLICY-FORM-NO      TO CR-POLICY-FORM-NO
 10591                                        DET-POL-FORM
 10592     ELSE
 10593         MOVE SPACES                 TO DET-POL-FORM.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 207
* ECS010P.cbl
 10594
 10595     IF CC-LOAN-OFFICER NOT = SPACES
 10596         MOVE CC-LOAN-OFFICER        TO CR-LOAN-OFFICER
 10597                                        DET-LOAN-OFFICER
 10598     ELSE
 10599         MOVE SPACES                 TO DET-LOAN-OFFICER.
 10600
 10601     IF CC-USER-FIELD NOT = SPACES
 10602         MOVE CC-USER-FIELD          TO CR-USER-CODE
 10603                                        DET-USER-CODE
 10604     ELSE
 10605         MOVE SPACE                  TO DET-USER-CODE.
 10606
 10607     IF CC-IND-GRP-TYPE NOT = SPACE  OR
 10608        CC-PAY-FREQUENCY NOT = ZEROS  OR
 10609        CC-POLICY-FORM-NO NOT = SPACES  OR
 10610        CC-LOAN-OFFICER NOT = SPACES  OR
 10611        CC-USER-FIELD NOT = SPACES
 10612         MOVE DET-PR-UREC-3          TO TR-DTL2
 10613         MOVE 'Y'                    TO WS-CHANGE-REC-SW
 10614         PERFORM 8690-PRINT-DETAIL-LINE THRU 8699-PRT-DETAIL-X.
 10615
 10616     IF CC-CLAIM-DEDUCT-WITHHELD NOT = ZEROS
 10617         MOVE CC-CLAIM-DEDUCT-WITHHELD
 10618                                     TO CR-CLAIM-DEDUCT-WITHHELD
 10619                                        DET-CLM-DEDUCT
 10620     ELSE
 10621         MOVE ZEROS                  TO DET-CLM-DEDUCT.
 10622
 10623     IF CC-CANCEL-DEDUCT-WITHHELD NOT = ZEROS
 10624         MOVE CC-CANCEL-DEDUCT-WITHHELD
 10625                                     TO CR-CANCEL-DEDUCT-WITHHELD
 10626                                        DET-CAN-DEDUCT
 10627     ELSE
 10628         MOVE ZEROS                  TO DET-CAN-DEDUCT.
 10629
 10630     IF CC-CLAIM-DEDUCT-WITHHELD NOT = ZEROS  OR
 10631        CC-CANCEL-DEDUCT-WITHHELD NOT = ZEROS
 10632         MOVE DET-PR-UREC-4          TO TR-DTL2
 10633         MOVE 'Y'                    TO WS-CHANGE-REC-SW
 10634         PERFORM 8690-PRINT-DETAIL-LINE THRU 8699-PRT-DETAIL-X.
 10635
 10636     IF CC-LF-PREMIUM-AMT NOT NUMERIC
 10637         MOVE ZEROS              TO  CC-LF-PREMIUM-AMT.
 10638
 10639     IF CC-LF-BENEFIT-AMT NOT NUMERIC
 10640         MOVE ZEROS              TO  CC-LF-BENEFIT-AMT.
 10641
 10642     IF CC-AH-PREMIUM-AMT NOT NUMERIC
 10643         MOVE ZEROS              TO  CC-AH-PREMIUM-AMT.
 10644
 10645     IF CC-AH-BENEFIT-AMT NOT NUMERIC
 10646         MOVE ZEROS              TO  CC-AH-BENEFIT-AMT.
 10647
 10648     IF CC-LF-BENEFIT-CD NOT = SPACES
 10649         MOVE CC-LF-BENEFIT-CD   TO  CR-LFTYP
 10650                                     DET-LF-BEN-CD
 10651     ELSE
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 208
* ECS010P.cbl
 10652         MOVE SPACES             TO DET-LF-BEN-CD.
 10653
 10654     IF CC-LF-PREMIUM-AMT NOT = ZEROS
 10655         MOVE CC-LF-PREMIUM-AMT  TO  CR-LFPRM
 10656                                     DET-LF-PREM
 10657     ELSE
 10658         MOVE ZEROS              TO DET-LF-PREM.
 10659
 10660     IF CC-LF-BENEFIT-AMT NOT = ZEROS
 10661         MOVE CC-LF-BENEFIT-AMT  TO  CR-LFAMT
 10662                                     DET-LF-BEN
 10663     ELSE
 10664         MOVE ZEROS              TO DET-LF-BEN.
 10665
 10666     IF (CC-LF-BENEFIT-CD NOT = SPACES)  OR
 10667        (CC-LF-PREMIUM-AMT NOT = ZEROS)  OR
 10668        (CC-LF-BENEFIT-AMT NOT = ZEROS)
 10669         MOVE DET-PR-UREC-5          TO TR-DTL2
 10670         MOVE 'Y'                    TO WS-CHANGE-REC-SW
 10671         PERFORM 8690-PRINT-DETAIL-LINE THRU 8699-PRT-DETAIL-X.
 10672
 10673     IF CC-AH-BENEFIT-CD NOT = SPACES
 10674         MOVE CC-AH-BENEFIT-CD   TO  CR-AHTYP
 10675                                     DET-AH-BEN-CD
 10676     ELSE
 10677         MOVE SPACES             TO DET-AH-BEN-CD.
 10678
 10679     IF CC-AH-PREMIUM-AMT NOT = ZEROS
 10680         MOVE CC-AH-PREMIUM-AMT  TO  CR-AHPRM
 10681                                     DET-AH-PREM
 10682     ELSE
 10683         MOVE ZEROS              TO DET-AH-PREM.
 10684
 10685     IF CC-AH-BENEFIT-AMT NOT = ZEROS
 10686         MOVE CC-AH-BENEFIT-AMT  TO  CR-AHAMT
 10687                                     DET-AH-BEN
 10688     ELSE
 10689         MOVE ZEROS              TO DET-AH-BEN.
 10690
 10691     IF CC-AH-BENEFIT-CD NOT = SPACES OR
 10692        CC-AH-PREMIUM-AMT NOT = ZEROS OR
 10693        CC-AH-BENEFIT-AMT NOT = ZEROS
 10694         MOVE DET-PR-UREC-6          TO TR-DTL2
 10695         MOVE 'Y'                    TO WS-CHANGE-REC-SW
 10696         PERFORM 8690-PRINT-DETAIL-LINE THRU 8699-PRT-DETAIL-X.
 10697
 10698 0910-END-CHANGE-PROCESSING.
 10699
 10700     IF CR-LNAME = ALL '*'
 10701         MOVE SPACES                 TO CR-LNAME.
 10702     IF CR-FNAME = ALL '*'
 10703         MOVE SPACES                 TO CR-FNAME.
 10704     IF CR-INIT = '*'
 10705         MOVE SPACES                 TO CR-INIT.
 10706     IF CR-SOC-SEC = ALL '*'
 10707         MOVE SPACES                 TO CR-SOC-SEC.
 10708     IF CR-JT-LNAME = ALL '*'
 10709         MOVE SPACES                 TO CR-JT-LNAME.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 209
* ECS010P.cbl
 10710     IF CR-JT-FNAME = ALL '*'
 10711         MOVE SPACES                 TO CR-JT-FNAME.
 10712     IF CR-JT-INIT = '*'
 10713         MOVE SPACES                 TO CR-JT-INIT.
 10714     IF CR-POLICY-FORM-NO = ALL '*'
 10715         MOVE SPACES                 TO CR-POLICY-FORM-NO.
 10716     IF CR-MEMBER-NO = ALL '*'
 10717         MOVE SPACES                 TO CR-MEMBER-NO.
 10718     IF CR-LOAN-OFFICER = ALL '*'
 10719         MOVE SPACES                 TO CR-LOAN-OFFICER.
 10720     IF CR-USER-CODE = ALL '*'
 10721         MOVE SPACES                 TO CR-USER-CODE.
 10722
 10723     ADD +1 TO BC-G-CTN.
 10724     GO TO 0300-READ-PENDING-TRANSACTIONS.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 210
* ECS010P.cbl
 10726 0920-GET-BANK-FEES.
 10727
 10728     IF CR-CERT-NO = '0008771354 '
 10729        DISPLAY ' MADE IT TO 0920 '
 10730     END-IF
 10731
 10732     MOVE DTE-CLASIC-COMPANY-CD  TO AG-COMPANY-CD
 10733     MOVE CR-CARRIER             TO AG-CARRIER
 10734     MOVE CR-GROUPING            TO AG-GROUPING
 10735     MOVE CR-BANK-NO             TO AG-BANK
 10736     MOVE WS-CR-BIN-DATE         TO AG-EXP-DT
 10737     MOVE 'B'                    TO AG-TYPE
 10738
 10739*    IF WS-PREV-BANK-COMM-KEY = AG-CONTROL-PRIMARY
 10740*       PERFORM 0925-BUILD-WORK-BNK-COMM
 10741*                                THRU 0925-EXIT
 10742*       GO TO 0920-EXIT
 10743*    END-IF
 10744
 10745     START ERAGTC KEY NOT < AG-CONTROL-PRIMARY
 10746
 10747     IF CR-CERT-NO = '0008771354 '
 10748        DISPLAY ' MADE IT AFTER START '
 10749     END-IF
 10750
 10751     .
 10752 0920-READ-ERAGTC.
 10753
 10754     IF ERAGTC-FILE-STATUS = '00'
 10755        READ ERAGTC NEXT RECORD
 10756     IF CR-CERT-NO = '0008771354 '
 10757        DISPLAY ' MADE ONE READ '
 10758     END-IF
 10759
 10760        IF ERAGTC-FILE-STATUS = '00'
 10761           IF (CR-CARRIER         = AG-CARRIER)
 10762              AND (CR-GROUPING    = AG-GROUPING)
 10763              AND (CR-BANK-NO     = AG-BANK)
 10764              IF WS-CR-BIN-DATE  = AG-EXP-DT
 10765                 GO TO 0920-READ-ERAGTC
 10766              ELSE
 10767                 IF (WS-CR-BIN-DATE NOT < AG-EFF-DT)
 10768                    AND (WS-CR-BIN-DATE < AG-EXP-DT)
 10769                    PERFORM 0925-BUILD-WORK-BNK-COMM
 10770                                 THRU 0925-EXIT
 10771                    MOVE AG-CONTROL-PRIMARY
 10772                                 TO WS-PREV-BANK-COMM-KEY
 10773                    GO TO 0920-EXIT
 10774                 END-IF
 10775              END-IF
 10776           END-IF
 10777        END-IF
 10778     END-IF
 10779
 10780     MOVE WS-BANK-INIT           TO WS-BANK-COMMISSIONS
 10781     PERFORM 0925-BUILD-WORK-BNK-COMM
 10782
 10783     .
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 211
* ECS010P.cbl
 10784 0920-EXIT.
 10785     EXIT.
 10786
 10787 0925-BUILD-WORK-BNK-COMM.
 10788
 10789     IF CR-CERT-NO = '0008771354 '
 10790        DISPLAY ' MADE IT TO 0925 '
 10791     END-IF
 10792
 10793     MOVE +1                     TO IA IB
 10794
 10795     IF (CR-BANK-NO NOT = SPACES AND ZEROS)
 10796        AND (PB-I-BANK-FEE NOT = ZEROS)
 10797        MOVE CR-BANK-NO          TO WS-BNK-AGT (IB)
 10798        MOVE 'B'                 TO WS-BNK-TYPE (IB)
 10799        MOVE PB-I-BANK-FEE       TO WS-BNK-SPP-FEES (IB)
 10800        MOVE ' '                 TO WS-BNK-RECALC (IB)
 10801        ADD +1                   TO IB
 10802     END-IF
 10803     .
 10804 0925-BUILD-CONTINUE.
 10805
 10806     IF CR-CERT-NO = '00087735841'
 10807        DISPLAY ' WS-BNK-AGT ' WS-BNK-AGT (1)
 10808        MOVE WS-BNK-SPP-FEES (1) TO WS-DISP-AMT
 10809        DISPLAY ' WS-BNK-FEE ' WS-DISP-AMT
 10810     END-IF
 10811
 10812     PERFORM VARYING IA FROM +2 BY +1 UNTIL
 10813        (IA > +10)
 10814        OR (IB > +10)
 10815        IF AG-AGT (IA) NOT = SPACES AND ZEROS
 10816           MOVE AG-AGT (IA)      TO WS-BNK-AGT (IB)
 10817           MOVE 'B'              TO WS-BNK-TYPE (IB)
 10818*          MOVE AG-COM-TYP (IA)  TO WS-BNK-TYPE (IB)
 10819           IF AG-SPP-FEES (IA) NOT NUMERIC
 10820              MOVE ZEROS         TO AG-SPP-FEES (IA)
 10821           END-IF
 10822           MOVE AG-SPP-FEES (IA) TO WS-BNK-SPP-FEES (IB)
 10823           MOVE AG-RECALC-LV-INDIC (IA)
 10824                                 TO WS-BNK-RECALC (IB)
 10825        ELSE
 10826           MOVE SPACES           TO WS-BNK-AGT (IB)
 10827                                    WS-BNK-TYPE (IB)
 10828                                    WS-BNK-RECALC (IB)
 10829           MOVE ZEROS            TO WS-BNK-SPP-FEES (IB)
 10830        END-IF
 10831        ADD +1                   TO IB
 10832     END-PERFORM
 10833
 10834     .
 10835 0925-EXIT.
 10836     EXIT.
 10837
 10838 0930-BUILD-CERT-TRLR.
 10839
 10840     MOVE SPACES                 TO CERTIFICATE-TRAILERS
 10841     MOVE 'CS'                   TO CS-RECORD-ID
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 212
* ECS010P.cbl
 10842     MOVE DTE-CLASIC-COMPANY-CD  TO CS-COMPANY-CD
 10843     MOVE CR-CARRIER             TO CS-CARRIER
 10844     MOVE CR-GROUPING            TO CS-GROUPING
 10845     MOVE CR-STATE               TO CS-STATE
 10846     MOVE CR-ACCOUNT             TO CS-ACCOUNT
 10847     MOVE WS-CR-BIN-DATE         TO CS-CERT-EFF-DT
 10848     MOVE CR-CERT-NO             TO CS-CERT-NO
 10849     MOVE 'A'                    TO CS-TRAILER-TYPE
 10850
 10851     MOVE WS-BANK-COMMISSIONS    TO CS-BANK-COMMISSION-AREA
 10852
 10853     IF CS-AGT (1) NOT = SPACES AND ZEROS
 10854        WRITE CERTIFICATE-TRAILERS
 10855        IF ELCRTT-FILE-STATUS = '00'
 10856           CONTINUE
 10857        ELSE
 10858           IF ELCRTT-FILE-STATUS = '22'
 10859              READ ELCRTT
 10860              IF ELCRTT-FILE-STATUS = '00'
 10861                 MOVE WS-BANK-COMMISSIONS
 10862                                 TO CS-BANK-COMMISSION-AREA
 10863                 REWRITE CERTIFICATE-TRAILERS
 10864                 IF ELCRTT-FILE-STATUS NOT = '00'
 10865                    DISPLAY ' BAD REWRITE ELCRTT '
 10866                                 ELCRTT-FILE-STATUS
 10867                    PERFORM ABEND-PGM
 10868                 END-IF
 10869              ELSE
 10870                 DISPLAY ' BAD READ    ELCRTT '
 10871                                  ELCRTT-FILE-STATUS
 10872                 PERFORM ABEND-PGM
 10873              END-IF
 10874           ELSE
 10875              DISPLAY ' BAD WRITE ELCRTT '
 10876                                 ELCRTT-FILE-STATUS
 10877              PERFORM ABEND-PGM
 10878           END-IF
 10879        END-IF
 10880     END-IF
 10881
 10882     .
 10883 0930-EXIT.
 10884     EXIT.
 10885
 10886******************************************************************
 10887***      S E T   C O M M I S S I O N   S T R U C T U R E       ***
 10888******************************************************************
 10889
 10890 1000-SET-COMMISSION-STRUCTURE.
 10891
 10892     MOVE +1                     TO IA
 10893                                    IB.
 10894
 10895 1100-GET-COMMISSION-LEVEL.
 10896
 10897     MOVE AM-AGT-COMMS (IA)      TO WK-LEVEL.
 10898
 10899     IF WK-AGT = '0000000000' OR SPACES
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 213
* ECS010P.cbl
 10900         MOVE +0                 TO WK-L-RT
 10901                                    WK-J-RT
 10902                                    WK-A-RT
 10903         GO TO 1200-SET-COMMISSION-LEVEL.
 10904
 10905 1110-LIFE-COMMISSION.
 10906
 10907     IF CR-LFTYP = ZERO  OR
 10908       (CR-ENTRY-STATUS = 'P' OR 'D' OR 'V')
 10909         MOVE +0 TO WK-L-RT
 10910                    WK-J-RT
 10911         GO TO 1130-A-H-COMMISSION.
 10912
 10913     IF CLAS-I-JOINT (CLAS-INDEXL) = 'J'
 10914         GO TO 1120-JOINT-LIFE-COMMISSION.
 10915
 10916     IF WK-L-RT NUMERIC
 10917        AND (WK-L-RTX (3:1) NOT = 'L' AND 'M')
 10918         MOVE WK-L-RT                TO WS-COMMISSION
 10919         PERFORM 6650-GET-RES-STATE-COMM  THRU 6700-COMM-EXIT
 10920         MOVE WS-COMMISSION          TO WK-L-RT
 10921         GO TO 1130-A-H-COMMISSION.
 10922
 10923     MOVE LIFE-OVERRIDE-L1           TO CTBL-BEN-TYPE.
 10924     MOVE CR-LFTYP                   TO CTBL-BEN-CODE.
 10925     MOVE ZEROS                      TO WS-SUB1.
 10926     PERFORM 6650-GET-RES-STATE-COMM  THRU 6700-COMM-EXIT
 10927
 10928     IF WS-SUB1 = ZEROS
 10929         MOVE WK-L-RTX               TO CTBL-TABLE-CD
 10930     ELSE
 10931         MOVE WK-RATE                TO WK-L-RT
 10932         GO TO 1130-A-H-COMMISSION.
 10933
 10934     PERFORM 1300-READ-ERCTBL-FILE THRU 1399-READ-ERCTBL-X.
 10935
 10936     MOVE CR-LFAMT                   TO COMM-CK-AMT.
 10937     MOVE CR-LF-TERM                 TO WS-COMM-TERM.
 10938     PERFORM 1400-GET-COMM-PERCENT THRU 1489-GET-PERCENT-X.
 10939     MOVE WK-RATE                    TO WK-L-RT.
 10940
 10941     GO TO 1130-A-H-COMMISSION.
 10942
 10943 1120-JOINT-LIFE-COMMISSION.
 10944
 10945     IF WK-J-RT NUMERIC
 10946        AND (WK-J-RTX (3:1) NOT = 'L' AND 'M')
 10947         MOVE WK-J-RT                TO WS-COMMISSION
 10948         PERFORM 6650-GET-RES-STATE-COMM  THRU 6700-COMM-EXIT
 10949         MOVE WS-COMMISSION          TO WK-J-RT
 10950         GO TO 1130-A-H-COMMISSION.
 10951
 10952     MOVE LIFE-OVERRIDE-L1           TO CTBL-BEN-TYPE.
 10953     MOVE CR-LFTYP                   TO CTBL-BEN-CODE.
 10954     MOVE ZEROS                      TO WS-SUB1.
 10955     PERFORM 6650-GET-RES-STATE-COMM  THRU 6700-COMM-EXIT
 10956
 10957     IF WS-SUB1 = ZEROS
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 214
* ECS010P.cbl
 10958         MOVE WK-J-RTX               TO CTBL-TABLE-CD
 10959     ELSE
 10960         MOVE WK-RATE                TO WK-J-RT
 10961         GO TO 1130-A-H-COMMISSION.
 10962
 10963     PERFORM 1300-READ-ERCTBL-FILE THRU 1399-READ-ERCTBL-X.
 10964
 10965     MOVE CR-LFAMT                   TO COMM-CK-AMT.
 10966     MOVE CR-LF-TERM                 TO WS-COMM-TERM.
 10967     PERFORM 1400-GET-COMM-PERCENT THRU 1489-GET-PERCENT-X.
 10968     MOVE WK-RATE                    TO WK-J-RT.
 10969
 10970 1130-A-H-COMMISSION.
 10971
 10972     IF CR-AHTYP = ZERO  OR
 10973       (CR-ENTRY-STATUS = 'P' OR 'D' OR 'V')
 10974         MOVE +0 TO WK-A-RT
 10975         GO TO 1200-SET-COMMISSION-LEVEL.
 10976
 10977     IF WK-A-RT NUMERIC
 10978        AND (WK-A-RTX (3:1) NOT = 'L' AND 'M')
 10979         MOVE WK-A-RT                TO WS-COMMISSION
 10980         PERFORM 6650-GET-RES-STATE-COMM  THRU 6700-COMM-EXIT
 10981         MOVE WS-COMMISSION          TO WK-A-RT
 10982         GO TO 1200-SET-COMMISSION-LEVEL.
 10983
 10984     MOVE AH-OVERRIDE-L1             TO CTBL-BEN-TYPE.
 10985     MOVE CR-AHTYP                   TO CTBL-BEN-CODE.
 10986     MOVE ZEROS                      TO WS-SUB1.
 10987     PERFORM 6650-GET-RES-STATE-COMM  THRU 6700-COMM-EXIT
 10988
 10989     IF WS-SUB1 = ZEROS
 10990         MOVE WK-A-RTX               TO CTBL-TABLE-CD
 10991     ELSE
 10992         MOVE WK-RATE                TO WK-A-RT
 10993         GO TO 1200-SET-COMMISSION-LEVEL.
 10994
 10995     PERFORM 1300-READ-ERCTBL-FILE THRU 1399-READ-ERCTBL-X.
 10996
 10997     COMPUTE COMM-CK-AMT = CR-AHAMT * CR-AH-TERM.
 10998     MOVE CR-AH-TERM                 TO WS-COMM-TERM.
 10999     PERFORM 1400-GET-COMM-PERCENT THRU 1489-GET-PERCENT-X.
 11000     MOVE WK-RATE                    TO WK-A-RT.
 11001
 11002 1200-SET-COMMISSION-LEVEL.
 11003
 11004     MOVE WK-AGT                      TO WK-N-AGT  (IA).
 11005     IF WK-AGT = '0000000000' OR SPACES
 11006         MOVE SPACE                   TO WK-N-TYPE (IA)
 11007     ELSE
 11008         MOVE WK-A-TYPE               TO WK-N-TYPE (IA).
 11009
 11010     IF CR-LFTYP = ZERO
 11011         MOVE +0                      TO WK-L-RT1  (IA)
 11012     ELSE
 11013         IF CLAS-I-JOINT (CLAS-INDEXL) = 'J'
 11014             MOVE WK-J-RT             TO WK-L-RT1 (IA)
 11015         ELSE
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 215
* ECS010P.cbl
 11016             MOVE WK-L-RT             TO WK-L-RT1 (IA).
 11017
 11018     MOVE WK-A-RT                     TO WK-A-RT1 (IA).
 11019
 11020     IF RC-COMM-FLG = 'X'
 11021        IF (AM-RECALC-LV-INDIC (IA) = 'N')
 11022*          OR ((CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'G' OR 'L')
 11023*             AND (IA = +5))
 11024            MOVE CR-COM-AGT  (IA)         TO WK-N-AGT  (IA)
 11025            MOVE CR-AGT-TYPE (IA)         TO WK-N-TYPE (IA)
 11026            MOVE CR-LCOM-L   (IA)         TO WK-L-RT1  (IA)
 11027            MOVE CR-LCOM-AH  (IA)         TO WK-A-RT1  (IA).
 11028
 11029     IF IA LESS THAN +10
 11030         ADD +1 TO IA
 11031         GO TO 1100-GET-COMMISSION-LEVEL.
 11032
 11033     GO TO 1499-SET-COMM-X.
 11034
 11035 1300-READ-ERCTBL-FILE.
 11036
 11037     IF CTBL-SEARCH = LAST-CTBL
 11038         GO TO 1399-READ-ERCTBL-X.
 11039
 11040     MOVE SPACE                          TO CTBL-ERROR-SWITCH.
 11041
 11042     IF COMM-OPEN-SW = ' '
 11043         MOVE 'X'                        TO COMM-OPEN-SW
 11044         MOVE DTE-CLASIC-COMPANY-CD      TO CTBL-COMP-CD
 11045         OPEN INPUT ERCTBL
 11046         IF ERCTBL-FILE-STATUS = '00'  OR  '97'
 11047             NEXT SENTENCE
 11048            ELSE
 11049             MOVE '41'                   TO ABEND-CODE-1
 11050             MOVE ERCTBL-FILE-STATUS     TO ABEND-CODE-2
 11051             DISPLAY '******************************'
 11052             DISPLAY '***** ERROR LOCATION 012 *****'
 11053             DISPLAY '******************************'
 11054             DISPLAY '******************************'
 11055             MOVE WS-ABEND-CODE          TO WS-RETURN-CODE
 11056             GO TO ABEND-PGM.
 11057
 11058     MOVE CTBL-SEARCH                    TO CT-CONTROL-PRIMARY
 11059                                            LAST-CTBL.
 11060     READ ERCTBL.
 11061
 11062     IF ERCTBL-FILE-STATUS = '23'
 11063         DISPLAY 'INVALID COMM TABLE CODE FOR: ' CR-FULL-CONTROL
 11064                 ' ENTERED: ' CR-ENTRY-STATUS '-' CR-ENTRY-DATE
 11065                 ' CTBL: ' CTBL-SEARCH
 11066         MOVE '*'                TO CTBL-ERROR-SWITCH
 11067         MOVE '44'               TO ABEND-CODE-1
 11068         MOVE ERCTBL-FILE-STATUS TO ABEND-CODE-2
 11069         DISPLAY 'CT-CONTROL-PRIMARY = ' CT-CONTROL-PRIMARY
 11070         DISPLAY '******************************'
 11071         DISPLAY '***** ERROR LOCATION 013 *****'
 11072         DISPLAY '******************************'
 11073         MOVE WS-ABEND-CODE      TO WS-RETURN-CODE
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 216
* ECS010P.cbl
 11074*        IF DTE-CLIENT NOT = 'NCL'
 11075         IF DTE-CLIENT NOT = 'NCL' AND 'CID' AND 'CSO'
 11076             GO TO ABEND-PGM
 11077         ELSE
 11078             NEXT SENTENCE
 11079     ELSE
 11080         IF ERCTBL-FILE-STATUS NOT = '00'
 11081             MOVE 'READ ERROR ON ERCTBL' TO WS-ABEND-MESSAGE
 11082             MOVE '44'               TO ABEND-CODE-1
 11083             MOVE ERCTBL-FILE-STATUS TO ABEND-CODE-2
 11084             DISPLAY '******************************'
 11085             DISPLAY '***** ERROR LOCATION 014 *****'
 11086             DISPLAY '******************************'
 11087             MOVE WS-ABEND-CODE      TO WS-RETURN-CODE
 11088             GO TO ABEND-PGM.
 11089
 11090     ADD +1                            TO ERCTBL-READS.
 11091
 11092 1399-READ-ERCTBL-X.
 11093     EXIT.
 11094
 11095 1400-GET-COMM-PERCENT.
 11096
 11097     IF CTBL-ERROR
 11098         MOVE ZEROS                      TO WK-RATE
 11099         GO TO 1489-GET-PERCENT-X.
 11100
 11101     MOVE +1 TO IB.
 11102     IF (COMM-CK-AMT GREATER CT-TBF (1)) AND
 11103        (CT-TBF (1) NOT EQUAL +9999999.99)
 11104         ADD +9 TO IB
 11105         IF (COMM-CK-AMT GREATER CT-TBF (2)) AND
 11106            (CT-TBF (2) NOT EQUAL +9999999.99)
 11107             ADD +9 TO IB.
 11108
 11109     IF CR-AGE GREATER CT-AGE (1)
 11110         ADD +3 TO IB
 11111         IF CR-AGE GREATER CT-AGE (2)
 11112             ADD +3 TO IB.
 11113
 11114     IF WS-COMM-TERM GREATER CT-TRM (1)
 11115         ADD +1 TO IB
 11116         IF WS-COMM-TERM GREATER CT-TRM (2)
 11117             ADD +1 TO IB.
 11118
 11119     IF CT-RT (IB) NOT NUMERIC
 11120         MOVE LAST-CTBL     TO CT-CONTROL-PRIMARY
 11121         MOVE CT-RT-R (IB)  TO CTBL-TABLE-CD
 11122         GO TO 1300-READ-ERCTBL-FILE.
 11123
 11124     MOVE CT-RT (IB) TO WK-RATE.
 11125
 11126 1489-GET-PERCENT-X.
 11127     EXIT.
 11128
 11129 1499-SET-COMM-X.
 11130     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 217
* ECS010P.cbl
 11132******************************************************************
 11133***  C O M P U T E   A C C T   L E V E L   C O M M I S S I O N ***
 11134******************************************************************
 11135
 11136 1500-GET-ACCT-LEVEL-LF-COMM.
 11137
 11138     MOVE ZEROS                      TO ACCT-COMM-LF
 11139                                        ACCT-COMM-AH.
 11140
 11141     MOVE +1                         TO IA.
 11142
 11143 1510-ACCT-LEVEL-LOOP.
 11144
 11145     IF CR-AGT-TYPE (IA) = 'C'  OR  'D' OR 'F' OR 'S'
 11146         IF WS-LEVELS-CHARGEBACK-SWITCHES = SPACES
 11147             ADD CR-LCOM-L (IA)  TO ACCT-COMM-LF
 11148             ADD CR-LCOM-AH (IA) TO ACCT-COMM-AH
 11149         ELSE
 11150             IF WS-LF-CHARGEBACK-SW (IA)  =  'Y'
 11151                 ADD CR-LCOM-L (IA)  TO ACCT-COMM-LF.
 11152
 11153     IF IA LESS THAN +10
 11154         ADD +1 TO IA
 11155         GO TO 1510-ACCT-LEVEL-LOOP.
 11156
 11157 1519-ACCT-LF-COMM-X.
 11158     EXIT.
 11159
 11160
 11161 1550-GET-ACCT-LEVEL-AH-COMM.
 11162
 11163     MOVE ZEROS                      TO ACCT-COMM-AH.
 11164
 11165     MOVE +1                         TO IA.
 11166
 11167 1555-ACCT-LEVEL-LOOP.
 11168
 11169     IF CR-AGT-TYPE (IA) = 'C'  OR  'D' OR 'F' OR 'S'
 11170         IF WS-AH-CHARGEBACK-SW (IA)  =  'Y'
 11171             ADD CR-LCOM-AH (IA)  TO ACCT-COMM-AH.
 11172
 11173     IF IA LESS THAN +10
 11174         ADD +1 TO IA
 11175         GO TO 1555-ACCT-LEVEL-LOOP.
 11176
 11177 1599-ACCT-AH-COMM-X.
 11178     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 218
* ECS010P.cbl
 11180******************************************************************
 11181***      C O M M I S S I O N   R E C A L C   R O U T I N E     ***
 11182******************************************************************
 11183
 11184 1600-RECALC-COMM-EXTR.
 11185
 11186     IF RC-COMM-FLG = 'X'  OR
 11187        (DTE-PGM-OPT = '2'  OR  '3')  OR
 11188        CR-POLICY-IS-DECLINED  OR
 11189        CR-POLICY-IS-VOID
 11190         GO TO 1899-RECALC-COMM-EXTR-X.
 11191
 11192     MOVE 'X'                           TO RC-COMM-FLG.
 11193
 11194     IF CR-ENTRY-DATE = EOM-RUN-DATE
 11195         GO TO 1899-RECALC-COMM-EXTR-X.
 11196
 11197     PERFORM 1000-SET-COMMISSION-STRUCTURE THRU 1499-SET-COMM-X.
 11198
 11199     IF CR-COMPENSATION-LEVELS = WK-NEW-RATES
 11200         GO TO 1899-RECALC-COMM-EXTR-X.
 11201
 11202     MOVE WK-NEW-RATES                  TO SAVE-WK-NEW-RATES.
 11203
 11204     PERFORM 1610-CK-DUPLICATE-ENTRIES
 11205         THRU 1619-CK-DUPLICATE-ENTRIES-XIT
 11206             VARYING SUB11 FROM 1 BY 1 UNTIL SUB11 GREATER 10.
 11207
 11208     IF CR-COMPENSATION-LEVELS = WK-NEW-RATES
 11209         MOVE SAVE-WK-NEW-RATES         TO CR-COMPENSATION-LEVELS
 11210                                           WK-NEW-RATES
 11211         GO TO 1899-RECALC-COMM-EXTR-X.
 11212
 11213     MOVE +1                            TO SUB8.
 11214     GO TO 1700-REVERSE-OLD-COMM-LOOP.
 11215
 11216 1610-CK-DUPLICATE-ENTRIES.
 11217     PERFORM 1620-CK-DUPL-ENTR-NEW
 11218         THRU 1629-CK-DUPL-ENTR-NEW-XIT
 11219             VARYING SUB12 FROM 1 BY 1 UNTIL SUB12 GREATER 10.
 11220
 11221 1619-CK-DUPLICATE-ENTRIES-XIT.
 11222     EXIT.
 11223
 11224 1620-CK-DUPL-ENTR-NEW.
 11225     IF CR-AGT-LEVELS (SUB11) = WK-N-R (SUB12)
 11226         MOVE SPACES                    TO CR-COM-AGT (SUB11)
 11227         MOVE SPACE                     TO CR-AGT-TYPE (SUB11)
 11228         MOVE +0                        TO CR-LCOM-L (SUB11)
 11229                                           CR-LCOM-AH (SUB11)
 11230         MOVE CR-AGT-LEVELS (SUB11)     TO WK-N-R (SUB12)
 11231         MOVE 11                        TO SUB12.
 11232
 11233 1629-CK-DUPL-ENTR-NEW-XIT.
 11234     EXIT.
 11235
 11236 1700-REVERSE-OLD-COMM-LOOP.
 11237     COMPUTE CR-LCOM-L (SUB8) = CR-LCOM-L (SUB8) * -1.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 219
* ECS010P.cbl
 11238     COMPUTE CR-LCOM-AH (SUB8) = CR-LCOM-AH (SUB8) * -1.
 11239
 11240     IF SUB8 LESS THAN +10
 11241         ADD +1 TO SUB8
 11242         GO TO 1700-REVERSE-OLD-COMM-LOOP.
 11243
 11244     MOVE 'O' TO RECALC-TYPE.
 11245
 11246     PERFORM 1710-DO-R-C-EXTRACTS THRU 1719-DO-R-C-EXTRACTS-X.
 11247
 11248     GO TO 1800-MOVE-NEW-COMM-RATES.
 11249
 11250 1710-DO-R-C-EXTRACTS.
 11251
 11252     PERFORM 2000-INITIALIZE-DETAIL-EXTRACT THRU 2099-INIT-DTL-X.
 11253
 11254     PERFORM 1720-CHECK-COMM-LEVELS
 11255         THRU 1729-CHECK-COMM-LEVELS-EXIT
 11256             VARYING SUB13 FROM +1 BY +1
 11257                 UNTIL SUB13 GREATER THAN 10.
 11258
 11259     MOVE '8'                           TO DE-TRANS.
 11260     MOVE RECALC-TYPE                   TO DE-RECALC-TYPE.
 11261*****PERFORM EXTRACT-DATE-RELOAD.
 11262     MOVE DETAIL-EXTRACT                TO SAVE-EXTRACT.
 11263     PERFORM 2500-WRITE-DETAIL-EXTRACTS THRU 2599-WRT-DETAIL-X.
 11264     MOVE SAVE-EXTRACT                  TO DETAIL-EXTRACT.
 11265     PERFORM EXTRACT-DATE-LOAD.
 11266     MOVE 'R'                           TO DE-REIN.
 11267     MOVE DETAIL-EXTRACT                TO SAVE-EXTRACT.
 11268     MOVE +1                            TO SUB1.
 11269     PERFORM 3110-REINSURE-ISSUE-LOOP
 11270         THRU 3119-REINSURE-ISSUE-LOOP-END.
 11271
 11272     IF CR-LF-CANCEL-APPLIED  OR  CR-AH-CANCEL-APPLIED
 11273         PERFORM 2200-BUILD-CANCEL-EXTRACT THRU
 11274                                       2259-END-CANCEL-BUILD
 11275         PERFORM 1720-CHECK-COMM-LEVELS
 11276             THRU 1729-CHECK-COMM-LEVELS-EXIT
 11277                 VARYING SUB13 FROM +1 BY +1
 11278                     UNTIL SUB13 GREATER THAN 10
 11279         MOVE '7'                       TO DE-TRANS
 11280         MOVE RECALC-TYPE               TO DE-RECALC-TYPE
 11281*********PERFORM EXTRACT-DATE-RELOAD
 11282         MOVE DETAIL-EXTRACT            TO SAVE-EXTRACT
 11283         PERFORM 2500-WRITE-DETAIL-EXTRACTS THRU 2599-WRT-DETAIL-X
 11284         MOVE SAVE-EXTRACT              TO DETAIL-EXTRACT
 11285         PERFORM EXTRACT-DATE-LOAD
 11286         MOVE 'R'                       TO DE-REIN
 11287         MOVE DETAIL-EXTRACT            TO SAVE-EXTRACT
 11288         MOVE +1                        TO SUB1
 11289         PERFORM 3210-REINSURE-CANCEL-LOOP
 11290             THRU 3219-REINSURE-CANCEL-LOOP-END.
 11291
 11292 1719-DO-R-C-EXTRACTS-X.
 11293     EXIT.
 11294
 11295 1720-CHECK-COMM-LEVELS.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 220
* ECS010P.cbl
 11296
 11297     IF  DE-AGT (SUB13)       =  SPACES  AND
 11298         DE-AGT-TYPE (SUB13)  =  SPACES  AND
 11299         DE-L-PC (SUB13)      =  ZEROS   AND
 11300         DE-A-PC (SUB13)      =  ZEROS
 11301         MOVE '0000000000'        TO  DE-AGT (SUB13).
 11302
 11303 1729-CHECK-COMM-LEVELS-EXIT.
 11304     EXIT.
 11305
 11306 1800-MOVE-NEW-COMM-RATES.
 11307     MOVE WK-NEW-RATES                  TO CR-COMPENSATION-LEVELS.
 11308     MOVE 'N'                           TO RECALC-TYPE.
 11309     PERFORM 1710-DO-R-C-EXTRACTS THRU 1719-DO-R-C-EXTRACTS-X.
 11310     MOVE SAVE-WK-NEW-RATES             TO WK-NEW-RATES
 11311                                           CR-COMPENSATION-LEVELS.
 11312     IF DTE-CLIENT = 'DCC'
 11313        IF CR-LF-NSP-PRM NOT = ZEROS
 11314           COMPUTE CR-LF-NSP-PRM ROUNDED =
 11315              (CR-LFPRM + CR-LFPRM-ALT) -
 11316              ((CR-LFPRM + CR-LFPRM-ALT) * CR-LCOM-L (1))
 11317        END-IF
 11318        IF (CR-AH-NSP-PRM NOT = ZEROS)
 11319           AND (CLAS-I-BEN-CATEGORY (CLAS-INDEXA)
 11320                                        NOT = 'G' AND 'L')
 11321           COMPUTE CR-AH-NSP-PRM ROUNDED =
 11322           CR-AHPRM -
 11323           (CR-AHPRM * CR-LCOM-AH (1))
 11324        END-IF
 11325     END-IF
 11326     .
 11327
 11328 1899-RECALC-COMM-EXTR-X.
 11329     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 221
* ECS010P.cbl
 11331******************************************************************
 11332***      I N I T I A L I Z E   D E T A I L   E X T R A C T     ***
 11333******************************************************************
 11334
 11335 2000-INITIALIZE-DETAIL-EXTRACT.
 11336
 11337     MOVE SPACES                   TO DETAIL-EXTRACT.
 11338
 11339     MOVE 'DE'                     TO DE-RECORD-ID.
 11340     MOVE CR-COMPANY-CD            TO DE-COMPANY-CD.
 11341     MOVE CR-FULL-CONTROL          TO DE-CONTROL.
 11342
 11343     MOVE AM-REPORT-CODE-1         TO DE-REPORT-CODE-1.
 11344     MOVE AM-REPORT-CODE-2         TO DE-REPORT-CODE-2.
 11345
 11346     MOVE CR-NAME                  TO DE-NAME.
 11347     MOVE CR-AGE                   TO DE-AGE.
 11348     MOVE CR-SEX                   TO DE-SEX.
 11349     MOVE CR-SOC-SEC               TO DE-SOC-SEC-NO.
 11350
 11351     MOVE CR-LFTYP                 TO DE-LF-TYPE.
 11352     MOVE CR-LF-TERM               TO DE-LF-TERM.
 11353     MOVE CR-LFAMT                 TO DE-LF-BEN.
 11354     MOVE ZEROS                    TO DE-LF-CNBEN.
 11355     MOVE CR-LFPRM                 TO DE-LF-PRM.
 11356     MOVE CR-LFAMT-ALT             TO DE-LF-BEN-ALT.
 11357     MOVE ZEROS                    TO DE-LF-CNBEN-ALT.
 11358     MOVE CR-LFPRM-ALT             TO DE-LF-PRM-ALT.
 11359     MOVE ZEROS                    TO DE-LF-RFND.
 11360
 11361     MOVE CR-LF-CURRENT-STATUS     TO DE-LF-STAT-CDE.
 11362     MOVE ZEROS                    TO DE-LF-CANC-DTE
 11363                                      DE-LF-CANC-EXIT-DT.
 11364
 11365     MOVE CR-AHTYP                 TO DE-AH-TYPE.
 11366     MOVE CR-AH-TERM               TO DE-AH-TERM.
 11367     MOVE CR-AHAMT                 TO DE-AH-BEN.
 11368     MOVE CR-AHPRM                 TO DE-AH-PRM.
 11369     MOVE ZEROS                    TO DE-AH-RFND.
 11370
 11371     MOVE CR-AH-CURRENT-STATUS     TO DE-AH-STAT-CDE.
 11372     MOVE ZEROS                    TO DE-AH-CANC-DTE
 11373                                      DE-AH-CANC-EXIT-DT.
 11374     MOVE CR-MOB-NET-TOT-FEES      TO DE-MOB-NET-TOT-FEES.
 11375
 11376     IF DTE-CLIENT = 'DCC'
 11377        MOVE CR-ADDL-CLP         TO DE-ADDL-CLP
 11378        MOVE CR-CLP-STATE        TO DE-CLP-STATE
 11379     ELSE
 11380        IF (CR-LFTYP NOT = ZERO   AND
 11381           CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'Z')  OR
 11382           (CR-AHTYP NOT = ZERO  AND
 11383           CLAS-I-CALC-TYPE (CLAS-INDEXA) = 'Z')
 11384           MOVE CR-LIVES           TO DE-LIVES
 11385           MOVE ZERO               TO DE-CANCEL-CNT-ITD
 11386                                      DE-CANCEL-CNT-YTD
 11387        END-IF
 11388     END-IF
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 222
* ECS010P.cbl
 11389
 11390     MOVE CR-MEMBER-NO             TO DE-MEMBER-NO.
 11391     IF AM-ZIP-PRIME NUMERIC
 11392        MOVE AM-ZIP-PRIME          TO DE-ZIP
 11393      ELSE
 11394        MOVE ZEROS                 TO DE-ZIP.
 11395     MOVE CR-LOAN-OFFICER          TO DE-LN-OFFICER.
 11396
 11397     MOVE CR-APR                   TO DE-APR.
 11398     MOVE CR-PMT-FREQ              TO DE-PMT-FREQ.
 11399     MOVE CR-GRPTYP                TO DE-ACC-GPCD.
 11400     MOVE CR-IND-GRP               TO DE-IG.
 11401     MOVE AM-REMIT-TO              TO DE-REMIT-TO.
 11402     MOVE CR-MEMBER-NO             TO DE-MEMBER-NO.
 11403
 11404     MOVE CR-ENTRY-STATUS          TO DE-ENTRY-STATUS.
 11405     MOVE CR-ENTRY-DATE            TO DE-ENTRY-DTE.
 11406
 11407     MOVE CR-UNDERWRITING-CODE     TO DE-UNDERWRITING-CODE.
 11408     MOVE AM-POOL-PRIME            TO DE-NCL-POOL-CODE.
 11409
 11410     MOVE ZEROS                    TO DE-REI-LFAMT  DE-REI-LFPRM
 11411                                      DE-REI-AHAMT  DE-REI-AHPRM
 11412                                      DE-REI-LFRFND DE-REI-AHRFND
 11413                                      DE-REI-CNAMT.
 11414
 11415     MOVE +1                       TO SUB1.
 11416
 11417     PERFORM EXTRACT-DATE-LOAD.
 11418
 11419     MOVE ZEROS                    TO WS-DE-PROC-DT-N
 11420                                      WS-DE-INCUR-N
 11421                                      WS-DE-PAY-N
 11422                                      WS-DE-PAID-TO-N
 11423                                      WS-DE-ACC-EXP-DTE-N
 11424                                      WS-DE-ACC-EFF-DTE-N
 11425                                      WS-DE-RSV-INCUR-N
 11426                                      WS-DE-RSV-PAYTO-N
 11427                                      WS-DE-ACC-EXP-DTE-RSV-N
 11428                                      WS-DE-ACC-EFF-DTE-RSV-N.
 11429
 11430 2090-GL-CODE-LOOP.
 11431
 11432     MOVE AM-GL-CODES (SUB1)       TO DE-GL-CODES (SUB1).
 11433
 11434     IF SUB1 LESS THAN +10
 11435         ADD +1 TO SUB1
 11436         GO TO 2090-GL-CODE-LOOP.
 11437
 11438     MOVE AM-RECALC-COMM           TO DE-RECALC-CODE.
 11439
 11440     MOVE CR-COMPENSATION-LEVELS   TO DE-COMM-LEVELS.
 11441
 11442     IF (DTE-CLIENT = 'DCC')
 11443        AND (CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'G' OR 'L')
 11444        AND (RECALC-TYPE = SPACES)
 11445        MOVE +1                  TO IA
 11446        IF CR-CERT-NO = '0008773536 '
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 223
* ECS010P.cbl
 11447           DISPLAY ' MADE IT TO 2000 '
 11448           DISPLAY ' CERT AREA  REIN ' DE-REIN
 11449           PERFORM VARYING IB FROM +1 BY +1 UNTIL
 11450              (IB > +10)
 11451              IF CR-COM-AGT (IB) NOT = SPACES AND ZEROS
 11452                 MOVE IB TO DIL-BEN-CODE
 11453                 MOVE CR-LCOM-AH (IB) TO DIL-AMOUNT
 11454                 MOVE CR-COM-AGT (IB) TO DIL-COMMENT
 11455                 DISPLAY DISPLAY-IBNR-LINE
 11456              END-IF
 11457           END-PERFORM
 11458           DISPLAY ' TRLR AREA  '
 11459           DISPLAY ' CS CERT NO ' CS-CERT-NO
 11460           PERFORM VARYING IB FROM +1 BY +1 UNTIL
 11461              (IB > +10)
 11462              IF WS-BNK-AGT (IB) NOT = SPACES AND ZEROS
 11463                 MOVE IB TO DIL-BEN-CODE
 11464                 MOVE WS-BNK-SPP-FEES (IB) TO DIL-AMOUNT
 11465                 MOVE WS-BNK-AGT (IB) TO DIL-COMMENT
 11466                 DISPLAY DISPLAY-IBNR-LINE
 11467              END-IF
 11468           END-PERFORM
 11469        END-IF
 11470        PERFORM VARYING IB FROM +1 BY +1 UNTIL
 11471           IB > +10
 11472           IF DE-AGT (IB) NOT = SPACES AND ZEROS
 11473              CONTINUE
 11474           ELSE
 11475              IF WS-BNK-AGT (IA) NOT = SPACES AND ZEROS
 11476                 MOVE WS-BNK-AGT (IA)  TO DE-AGT (IB)
 11477                 MOVE WS-BNK-TYPE (IA) TO DE-AGT-TYPE (IB)
 11478                 COMPUTE DE-A-PC (IB) =
 11479                        WS-BNK-SPP-FEES (IA) / +1000
 11480                 MOVE +0              TO DE-L-PC (IB)
 11481                 ADD +1               TO IA
 11482              END-IF
 11483*             IF CS-AGT (IA) NOT = SPACES AND ZEROS
 11484*                MOVE CS-AGT (IA)     TO DE-AGT (IB)
 11485*                MOVE CS-COM-TYP (IA) TO DE-AGT-TYPE (IB)
 11486*                COMPUTE DE-A-PC (IB) = CS-SPP-FEES (IA) / +1000
 11487*                MOVE +0              TO DE-L-PC (IB)
 11488*                ADD +1               TO IA
 11489*             END-IF
 11490           END-IF
 11491        END-PERFORM
 11492     END-IF
 11493
 11494
 11495
 11496     .
 11497 2099-INIT-DTL-X.
 11498     EXIT.
 11499
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 224
* ECS010P.cbl
 11501******************************************************************
 11502***            B U I L D   I S S U E   E X T R A C T           ***
 11503******************************************************************
 11504
 11505 2100-BUILD-ISSUE-EXTRACT.
 11506
 11507     PERFORM 2000-INITIALIZE-DETAIL-EXTRACT THRU 2099-INIT-DTL-X.
 11508
 11509     MOVE 'I'                      TO DE-TRANS.
 11510
 11511     IF CHECK-BILLED
 11512         MOVE 'N' TO BILLED-SWITCH
 11513     ELSE
 11514         GO TO 2190-WRITE-ISSUE-EXTRACT.
 11515
 11516     MOVE +1                        TO SUB1.
 11517 2150-GA-BILL-LOOP.
 11518
 11519     IF PB-GA-BILL-DT (SUB1) NOT = LOW-VALUES  AND  SPACES
 11520         MOVE 'B'                   TO DE-GA-BILL-STATUS (SUB1).
 11521
 11522     IF SUB1 LESS THAN +5
 11523         ADD +1 TO SUB1
 11524         GO TO 2150-GA-BILL-LOOP.
 11525
 11526     MOVE PB-RECORD-BILL            TO DE-BILL-SW.
 11527     MOVE ZEROS                     TO DE-BILLED-LFPRM
 11528                                       DE-BILLED-LFRFND
 11529                                       DE-BILLED-AHPRM
 11530                                       DE-BILLED-AHRFND.
 11531
 11532     IF PB-BILLED-DT = LOW-VALUES  OR  SPACES
 11533         IF PB-LF-BILLED-AMTS = ZERO  AND
 11534            PB-AH-BILLED-AMTS = ZERO
 11535             MOVE ' '                    TO DE-BILL-STATUS
 11536         ELSE
 11537             IF PB-LF-BILLED-AMTS = PB-I-LF-PREMIUM-AMT  AND
 11538                PB-AH-BILLED-AMTS = PB-I-AH-PREMIUM-AMT
 11539                 MOVE 'B'                TO DE-BILL-STATUS
 11540             ELSE
 11541                 MOVE 'R'                TO DE-BILL-STATUS
 11542                 MOVE PB-LF-BILLED-AMTS  TO DE-BILLED-LFPRM
 11543                 MOVE PB-AH-BILLED-AMTS  TO DE-BILLED-AHPRM
 11544     ELSE
 11545         MOVE 'B'                        TO DE-BILL-STATUS.
 11546
 11547 2190-WRITE-ISSUE-EXTRACT.
 11548
 11549     PERFORM 2500-WRITE-DETAIL-EXTRACTS THRU 2599-WRT-DETAIL-X.
 11550
 11551 2199-BLD-ISSUE-X.
 11552     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 225
* ECS010P.cbl
 11554******************************************************************
 11555***           B U I L D   C A N C E L   E X T R A C T          ***
 11556******************************************************************
 11557
 11558 2200-BUILD-CANCEL-EXTRACT.
 11559
 11560     PERFORM 2000-INITIALIZE-DETAIL-EXTRACT THRU 2099-INIT-DTL-X.
 11561
 11562     MOVE 'C'                           TO DE-TRANS.
 11563
 11564     IF CR-LFTYP = ZERO
 11565         GO TO 2250-CONTINUE-CANCEL-BUILD.
 11566
 11567     IF CLAS-I-CALC-TYPE (CLAS-INDEXL) NOT = 'Z'
 11568         IF (CR-LF-STATUS-AT-CANCEL = ' ' OR '7')  AND
 11569             CR-LFRFND = +0
 11570              MOVE +0                   TO TEMP-5
 11571              GO TO 2250-CONTINUE-CANCEL-BUILD.
 11572
 11573     IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'Z'
 11574          IF CR-LFRFND = +0
 11575              GO TO 2250-CONTINUE-CANCEL-BUILD.
 11576
 11577     MOVE +1 TO TEMP-5.
 11578     MOVE CR-LF-TERM             TO ORIG-TERM.
 11579     MOVE CR-LF-CANC-DT          TO VALUATION-DT.
 11580     MOVE LIFE-OVERRIDE-L1       TO WE-LF-AH.
 11581     MOVE '1'                    TO W-VAL-SOURCE.
 11582     PERFORM 8500-REMAINING-TERM-ROUTINE THRU 8599-REM-TERM-X.
 11583
 11584     IF CLAS-I-RL-AH (CLAS-INDEXL) = 'L' OR 'P'
 11585         MOVE CR-LFAMT TO DE-LF-CNBEN
 11586         GO TO 2250-CONTINUE-CANCEL-BUILD.
 11587
 11588     IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'Z'
 11589         GO TO 2220-BLD-DE-CANCEL-SUM.
 11590
 11591     IF REM-TRM3 = CR-LF-TERM
 11592         MOVE CR-LFAMT TO DE-LF-CNBEN
 11593         GO TO 2250-CONTINUE-CANCEL-BUILD.
 11594
 11595     IF CLAS-I-EP (CLAS-INDEXL) = 'T'
 11596         GO TO 2210-BLD-DE-CANCEL-TEX.
 11597
 11598     IF DTE-CLIENT = 'NCL'
 11599         IF CR-DT LESS THAN 19910101
 11600             GO TO 2205-BLD-DE-CANCEL-BEN.
 11601
 11602     IF CLAS-I-EP (CLAS-INDEXL) = 'N'
 11603         GO TO 2230-BLD-DE-CANCEL-NP.
 11604
 11605     IF DTE-CLIENT = 'FUL'
 11606         GO TO 2240-BLD-DE-CANCEL-FUL.
 11607
 11608*    IF STATE-ABBR (CLAS-INDEXS) = 'OH'
 11609     IF (STATE-ABBR (CLAS-INDEXS) = 'OH') AND
 11610        (CR-RATING-CLASS NOT = 'L ')
 11611         IF (CR-APR GREATER THAN ZERO)  AND
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 226
* ECS010P.cbl
 11612            (CR-LF-TERM GREATER THAN 060)  AND
 11613            (CR-DT GREATER THAN 19831031)
 11614              GO TO 2230-BLD-DE-CANCEL-NP.
 11615
 11616     IF STATE-ABBR (CLAS-INDEXS) = 'MT'
 11617         IF (CR-APR GREATER THAN ZERO)  AND
 11618            (CR-LF-TERM GREATER THAN 061)  AND
 11619            (CR-DT GREATER THAN 19830318)
 11620              GO TO 2230-BLD-DE-CANCEL-NP.
 11621
 11622     IF STATE-ABBR (CLAS-INDEXS) = 'UT'
 11623         IF (CR-APR GREATER THAN ZERO)  AND
 11624            (CR-LF-TERM GREATER THAN 062)  AND
 11625            (CR-DT GREATER THAN 19810831)  AND
 11626            (CR-DT LESS THAN 19830901)
 11627              GO TO 2230-BLD-DE-CANCEL-NP.
 11628
 11629     IF STATE-ABBR (CLAS-INDEXS) = 'RI'
 11630         IF (CR-APR GREATER THAN ZERO)  AND
 11631            (CR-LF-TERM GREATER THAN 060)  AND
 11632            (CR-DT GREATER THAN 19831231)
 11633              GO TO 2230-BLD-DE-CANCEL-NP.
 11634
 11635 2205-BLD-DE-CANCEL-BEN.
 11636
 11637     IF CR-LF-TERM EQUAL +0
 11638         MOVE +0          TO TEMP-5
 11639     ELSE
 11640         COMPUTE TEMP-5 = REM-TRM3 / CR-LF-TERM.
 11641
 11642     COMPUTE DE-LF-CNBEN = CR-LFAMT * TEMP-5.
 11643
 11644     GO TO 2250-CONTINUE-CANCEL-BUILD.
 11645
 11646 2210-BLD-DE-CANCEL-TEX.
 11647
 11648     DIVIDE CR-LFAMT BY CR-LF-TERM
 11649         GIVING TEX-FACT-1.
 11650     DIVIDE REM-TRM3 BY CR-PMT-FREQ
 11651         GIVING TEX-FACT-2
 11652             REMAINDER TEX-FACT-3.
 11653     IF TEX-FACT-3 NOT = ZERO
 11654         ADD +1 TO TEX-FACT-2.
 11655     COMPUTE DE-LF-CNBEN =
 11656         (TEX-FACT-1 * (TEX-FACT-2 * CR-PMT-FREQ)).
 11657
 11658     IF CR-LFAMT EQUAL +0
 11659         MOVE +0                  TO TEMP-5
 11660     ELSE
 11661         COMPUTE TEMP-5 = DE-LF-CNBEN / CR-LFAMT.
 11662
 11663     GO TO 2250-CONTINUE-CANCEL-BUILD.
 11664
 11665 2220-BLD-DE-CANCEL-SUM.
 11666
 11667     MOVE CR-SUM-CAN-CNT-YTD      TO DE-CANCEL-CNT-YTD.
 11668     MOVE CR-SUM-CAN-CNT-ITD      TO DE-CANCEL-CNT-ITD.
 11669
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 227
* ECS010P.cbl
 11670     IF CR-LFRFND NOT LESS CR-LFPRM
 11671         MOVE CR-LFAMT           TO DE-LF-CNBEN
 11672          GO TO 2250-CONTINUE-CANCEL-BUILD.
 11673
 11674     COMPUTE TEMP-6 ROUNDED = CR-LFRFND / CR-LFPRM.
 11675     COMPUTE TEMP-7 ROUNDED = TEMP-6 * CR-LFAMT.
 11676     IF CLAS-I-RL-AH (CLAS-INDEXL) = 'L' OR 'P'
 11677         MOVE TEMP-7             TO DE-LF-CNBEN
 11678       ELSE
 11679         COMPUTE TEMP-5 = REM-TRM3 / CR-LF-TERM
 11680         COMPUTE DE-LF-CNBEN = TEMP-7 * TEMP-5.
 11681
 11682     IF CR-LFAMT EQUAL +0
 11683         MOVE +0                  TO TEMP-5
 11684     ELSE
 11685         COMPUTE TEMP-5 ROUNDED =  DE-LF-CNBEN / CR-LFAMT.
 11686
 11687     IF CLAS-I-EP (CLAS-INDEXL) NOT = 'N'
 11688         GO TO 2250-CONTINUE-CANCEL-BUILD.
 11689
 11690 2230-BLD-DE-CANCEL-NP.
 11691
 11692     MOVE CR-DT                      TO  DC-GREG-DATE-CYMD.
 11693     MOVE 'L'                        TO  DC-OPTION-CODE.
 11694     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 11695     MOVE DC-BIN-DATE-1              TO  CP-CERT-EFF-DT.
 11696
 11697     IF CR-LOAN-1ST-PMT-DT NOT = ZEROS
 11698       MOVE CR-LOAN-1ST-PMT-DT       TO  DC-GREG-DATE-1-YMD
 11699       MOVE '3'                      TO  DC-OPTION-CODE
 11700       PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X
 11701       MOVE DC-BIN-DATE-1            TO  CP-FIRST-PAY-DATE
 11702     ELSE
 11703       MOVE CP-CERT-EFF-DT           TO  DC-BIN-DATE-1
 11704       MOVE '6'                      TO  DC-OPTION-CODE
 11705       MOVE +1                       TO  DC-ELAPSED-MONTHS
 11706       MOVE +0                       TO  DC-ELAPSED-DAYS
 11707       PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X
 11708       MOVE DC-BIN-DATE-2            TO  CP-FIRST-PAY-DATE.
 11709
 11710     MOVE CR-RATING-CLASS            TO  CP-CLASS-CODE
 11711     MOVE CR-LFAMT                   TO  CP-ORIGINAL-BENEFIT.
 11712     MOVE CR-APR                     TO  CP-LOAN-APR.
 11713     MOVE CR-LF-TERM                 TO  CP-ORIGINAL-TERM.
 11714     MOVE CR-LOAN-TERM               TO  CP-LOAN-TERM.
 11715     MOVE REM-TRM3                   TO  CP-REMAINING-TERM.
 11716     MOVE CLAS-I-CALC-TYPE (CLAS-INDEXL) TO  CP-SPECIAL-CALC-CD.
 11717     MOVE CLAS-I-RL-AH     (CLAS-INDEXL) TO  CP-BENEFIT-TYPE.
 11718     MOVE CLAS-I-EP        (CLAS-INDEXL) TO  CP-EARNING-METHOD.
 11719
 11720     CALL 'ELRAMTX' USING CALCULATION-PASS-AREA.
 11721
 11722     IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'Z'
 11723         COMPUTE DE-LF-CNBEN =
 11724                 CP-REMAMT-FACTOR * (TEMP-7 / +1000)
 11725      ELSE
 11726          COMPUTE DE-LF-CNBEN =
 11727                  CP-REMAMT-FACTOR * (CR-LFAMT / +1000).
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 228
* ECS010P.cbl
 11728
 11729     IF CR-LFAMT EQUAL +0
 11730         MOVE +0                  TO TEMP-5
 11731     ELSE
 11732         COMPUTE TEMP-5 = DE-LF-CNBEN / CR-LFAMT.
 11733
 11734     GO TO 2250-CONTINUE-CANCEL-BUILD.
 11735
 11736 2240-BLD-DE-CANCEL-FUL.
 11737
 11738     MOVE CR-APR                  TO NP-APR.
 11739     MOVE CR-LF-TERM              TO NP-ORIG.
 11740     MOVE REM-TRM3                TO NP-REM.
 11741     MOVE '2'                     TO NP-OPT.
 11742     MOVE CR-AHPRM                TO NP-AHPRM.
 11743     MOVE CR-ACCOUNT              TO NP-ACCOUNT.
 11744     MOVE CR-LFAMT                TO NP-BENEFIT.
 11745
 11746*    CALL 'FULNETRM'
 11747*        USING NP-APR NP-ORIG NP-REM NP-OPT NP-BENEFIT NP-AHPRM
 11748*              NP-ACCOUNT NP-REMAINING.
 11749
 11750     MOVE NP-REMAINING            TO DE-LF-CNBEN.
 11751
 11752     IF CR-LFAMT EQUAL +0
 11753         MOVE +0                  TO TEMP-5
 11754     ELSE
 11755         COMPUTE TEMP-5 = DE-LF-CNBEN / CR-LFAMT.
 11756
 11757 2250-CONTINUE-CANCEL-BUILD.
 11758
 11759     MOVE CR-LFRFND                   TO DE-LF-RFND.
 11760     MOVE CR-LF-STATUS-AT-CANCEL      TO DE-LF-PREV-STAT.
 11761     MOVE CR-LF-CANC-DT               TO DE-LF-CANC-DTE
 11762                                         WS-DE-LF-CANC-DTE-N.
 11763     MOVE CR-LF-CANCEL-EXIT-DATE      TO DE-LF-CANC-EXIT-DT
 11764                                         WS-DE-LF-CANC-EXIT-DT-N.
 11765     MOVE CR-LF-COMM-CHARGEBACK       TO DE-LF-COMM-CHARGEBACK.
 11766
 11767     MOVE CR-AHRFND                   TO DE-AH-RFND.
 11768
 11769     IF DTE-CLIENT = 'DCC'
 11770        IF DE-AH-RFND = ZEROS
 11771           MOVE ZEROS                 TO DE-ADDL-CLP
 11772        END-IF
 11773     END-IF
 11774
 11775     MOVE CR-AH-STATUS-AT-CANCEL      TO DE-AH-PREV-STAT.
 11776     MOVE CR-AH-CANC-DT               TO DE-AH-CANC-DTE
 11777                                         WS-DE-AH-CANC-DTE-N.
 11778     MOVE CR-AH-CANCEL-EXIT-DATE      TO DE-AH-CANC-EXIT-DT
 11779                                         WS-DE-AH-CANC-EXIT-DT-N.
 11780     MOVE CR-AH-COMM-CHARGEBACK       TO DE-AH-COMM-CHARGEBACK.
 11781
 11782     IF PB-LAST-MAINT-BY = 'E570'
 11783         MOVE 'R'                     TO DE-AUTO-GEND-IND.
 11784
 11785     IF CHECK-BILLED
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 229
* ECS010P.cbl
 11786         MOVE 'N' TO BILLED-SWITCH
 11787     ELSE
 11788         GO TO 2259-END-CANCEL-BUILD.
 11789
 11790     MOVE +1                        TO SUB1.
 11791 2255-GA-BILL-LOOP.
 11792
 11793     IF PB-GA-BILL-DT (SUB1) NOT = LOW-VALUES  AND  SPACES
 11794         MOVE 'B'                   TO DE-GA-BILL-STATUS (SUB1).
 11795
 11796     IF SUB1 LESS THAN +5
 11797         ADD +1 TO SUB1
 11798         GO TO 2255-GA-BILL-LOOP.
 11799
 11800     MOVE PB-RECORD-BILL            TO DE-BILL-SW.
 11801     MOVE PB-C-REFUND-SW            TO DE-REFUND-SW.
 11802     MOVE ZEROS                     TO DE-BILLED-LFPRM
 11803                                       DE-BILLED-LFRFND
 11804                                       DE-BILLED-AHPRM
 11805                                       DE-BILLED-AHRFND.
 11806
 11807     IF PB-BILLED-DT = LOW-VALUES  OR  SPACES
 11808         IF PB-LF-BILLED-AMTS = ZERO  AND
 11809            PB-AH-BILLED-AMTS = ZERO
 11810             MOVE ' '                    TO DE-BILL-STATUS
 11811         ELSE
 11812             IF PB-LF-BILLED-AMTS = PB-C-LF-CANCEL-AMT  AND
 11813                PB-AH-BILLED-AMTS = PB-C-AH-CANCEL-AMT
 11814                 MOVE 'B'                TO DE-BILL-STATUS
 11815             ELSE
 11816                 MOVE 'R'                TO DE-BILL-STATUS
 11817                 MOVE PB-LF-BILLED-AMTS  TO DE-BILLED-LFRFND
 11818                 MOVE PB-AH-BILLED-AMTS  TO DE-BILLED-AHRFND
 11819     ELSE
 11820         MOVE 'B'                        TO DE-BILL-STATUS.
 11821
 11822 2259-END-CANCEL-BUILD.
 11823     EXIT.
 11824
 11825 2290-WRITE-CANCEL-EXTRACT.
 11826
 11827     PERFORM 2500-WRITE-DETAIL-EXTRACTS THRU 2599-WRT-DETAIL-X.
 11828
 11829 2299-BLD-CANCEL-X.
 11830     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 230
* ECS010P.cbl
 11832******************************************************************
 11833***            B U I L D   C L A I M   E X T R A C T           ***
 11834******************************************************************
 11835
 11836 2300-BUILD-CLAIM-EXTRACT.
 11837
 11838     PERFORM 2000-INITIALIZE-DETAIL-EXTRACT THRU 2099-INIT-DTL-X.
 11839
 11840     MOVE 'X'                       TO DE-TRANS.
 11841
 11842     MOVE PC-CLAIM-TYPE             TO DE-TYPE.
 11843
 11844     MOVE PC-CLAIM-PAYMENT          TO DE-CLAIM-AMT.
 11845     MOVE ZEROS                     TO DE-REI-CLAIM-AMT.
 11846
 11847     MOVE INCURRED-DATE             TO DE-INCUR
 11848                                       WS-DE-INCUR-N.
 11849     MOVE REPORTED-DATE             TO DE-REPORTED.
 11850     MOVE PAYMENT-DATE              TO DE-PAY
 11851                                       WS-DE-PAY-N.
 11852     MOVE PAY-TO-DATE               TO DE-PAID-TO
 11853                                       WS-DE-PAID-TO-N.
 11854
 11855     MOVE PC-CLAIM-NO               TO DE-CNUM.
 11856     MOVE PC-CHECK-NO               TO DE-CHECK.
 11857     MOVE PC-TRLR-SEQ-NO            TO DE-PMT-TRAILER-SEQ.
 11858     MOVE PC-NO-OF-DAYS-PAID        TO DE-DAYS-DISAB.
 11859     MOVE PC-AGE-AT-CLAIM           TO DE-CLM-AGE.
 11860     MOVE PC-PAYMENT-TYPE           TO DE-PAY-CODE.
 11861     INSPECT DE-PAY-CODE
 11862         CONVERTING '1234569' TO 'PFSXEEV'.
 11863
 11864     MOVE AM-NAME                   TO DE-ACC-NAME.
 11865     MOVE AM-EXPIRE-DT              TO DE-ACC-EXP-DTE
 11866                                       WS-DE-ACC-EXP-DTE-N.
 11867     MOVE AM-EFFECT-DT              TO DE-ACC-EFF-DTE
 11868                                       WS-DE-ACC-EFF-DTE-N.
 11869     MOVE PC-CAUSE-CODE             TO DE-CLM-CAUSE.
 11870     MOVE CR-LOAN-OFFICER           TO DE-LOAN-OFFICER.
 11871
 11872     IF DE-DTH  OR  DE-OB-DTH
 11873         MOVE CR-LF-STATUS-AT-DEATH TO DE-LF-PREV-STAT
 11874     ELSE
 11875         IF CR-AH-LUMP-SUM-DISAB
 11876             MOVE CR-AH-STATUS-AT-SETTLEMENT
 11877                                    TO DE-AH-PREV-STAT.
 11878
 11879     IF PC-LAST-MAINT-BY EQUAL 'E570'
 11880         MOVE 'R'                     TO DE-AUTO-GEND-IND.
 11881
 11882 2390-WRITE-CLAIM-EXTRACT.
 11883
 11884     PERFORM 2500-WRITE-DETAIL-EXTRACTS THRU 2599-WRT-DETAIL-X.
 11885
 11886 2399-BLD-CLAIM-X.
 11887     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 231
* ECS010P.cbl
 11889******************************************************************
 11890***          B U I L D   R E S E R V E   E X T R A C T         ***
 11891******************************************************************
 11892
 11893 2400-BUILD-RESERVE-EXTRACT.
 11894
 11895     PERFORM 2000-INITIALIZE-DETAIL-EXTRACT THRU 2099-INIT-DTL-X.
 11896
 11897     MOVE 'Y'                         TO DE-TRANS.
 11898     MOVE PC-CLAIM-TYPE               TO DE-RESERVE-TYPE.
 11899
 11900     MOVE PC-IBNR-RESERVE-AMT         TO DE-IBNR.
 11901     MOVE PC-PTC-RESERVE-AMT          TO DE-PAYCUR.
 11902     MOVE PC-FUTURE-RESERVE-AMT       TO DE-FUTRSV.
 11903     ADD  PC-MANUAL-RESERVE-AMT       TO DE-FUTRSV.
 11904
 11905     IF DTE-CLIENT  =  'NCL'
 11906        IF PC-MANUAL-RESERVE-AMT  GREATER THAN   ZEROS
 11907            MOVE 'Y'                  TO DE-MANUAL-RSV-SWITCH.
 11908
 11909     MOVE PC-CLAIM-NO                 TO DE-CLMNO.
 11910
 11911     MOVE AM-EXPIRE-DT                TO DE-ACC-EXP-DTE-RSV
 11912                                         WS-DE-ACC-EXP-DTE-RSV-N.
 11913
 11914     MOVE AM-EFFECT-DT                TO DE-ACC-EFF-DTE-RSV
 11915                                         WS-DE-ACC-EFF-DTE-RSV-N.
 11916
 11917     MOVE INCURRED-DATE               TO DE-RSV-INCUR
 11918                                         WS-DE-RSV-INCUR-N.
 11919     MOVE REPORTED-DATE               TO DE-RSV-REPORTED.
 11920     MOVE PAY-TO-DATE                 TO DE-RSV-PAYTO
 11921                                         WS-DE-RSV-PAYTO-N.
 11922
 11923     MOVE ZEROS                       TO DE-REI-IBNR
 11924                                         DE-REI-PAYCUR
 11925                                         DE-REI-FUTRSV.
 11926
 11927     MOVE AM-NAME                     TO DE-RSV-ACC-NAME.
 11928
 11929     IF PC-LAST-MAINT-BY EQUAL 'E570'
 11930         MOVE 'R'                     TO DE-AUTO-GEND-IND.
 11931
 11932 2490-WRITE-RESERVE-EXTRACT.
 11933
 11934     PERFORM 2500-WRITE-DETAIL-EXTRACTS THRU 2599-WRT-DETAIL-X.
 11935
 11936 2499-BLD-RESERVE-X.
 11937     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 232
* ECS010P.cbl
 11939******************************************************************
 11940***          W R I T E   D E T A I L   E X T R A C T S         ***
 11941******************************************************************
 11942
 11943 2500-WRITE-DETAIL-EXTRACTS.
 11944
 11945
 11946     MOVE  ZEROS            TO  SUB.
 11947
 11948     IF  NOT  DE-CANCEL  AND   NOT  DE-RC-CANCEL
 11949         GO TO 2520-WRITE-CONTINUE.
 11950
 11951 2510-ZERO-CHARGEBACK-LOOP.
 11952
 11953     ADD  +1                TO  SUB.
 11954
 11955     IF  SUB    GREATER  THAN     +10
 11956         GO TO  2520-WRITE-CONTINUE.
 11957
 11958*    DISPLAY ' CERT NO ' CR-CERT-NO
 11959*    DISPLAY ' REFUND TYPE ' CR-AH-REFUND-TYPE
 11960*    DISPLAY '  SUB  ' SUB '   ' WS-AH-CHARGEBACK-SW (SUB)
 11961
 11962
 11963     IF  WS-LF-CHARGEBACK-SW (SUB)  = 'N'
 11964         MOVE  ZEROS            TO  DE-L-PC (SUB).
 11965
 11966     IF  (WS-AH-CHARGEBACK-SW (SUB)  = 'N')
 11967                   OR
 11968         ((CR-AH-REFUND-TYPE = 'G')
 11969         AND (CR-AHRFND = ZEROS))
 11970         MOVE  ZEROS             TO DE-A-PC (SUB)
 11971     END-IF
 11972
 11973     GO TO 2510-ZERO-CHARGEBACK-LOOP.
 11974
 11975 2520-WRITE-CONTINUE.
 11976
 11977     IF DTE-CLIENT NOT = 'HER'
 11978         GO TO 2590-WRITE-EXTRACTS.
 11979
 11980     IF DE-REINCO NOT = 'LNL'
 11981         GO TO 2590-WRITE-EXTRACTS.
 11982
 11983     IF DE-CLAIM  OR  DE-RESERVE  OR  DE-RR-RC-CLM
 11984         GO TO 2590-WRITE-EXTRACTS.
 11985
 11986     IF DE-AGT-TYPE (1)  = 'D'   MOVE 'C'    TO DE-AGT-TYPE (1).
 11987     IF DE-AGT-TYPE (2)  = 'P'   MOVE 'O'    TO DE-AGT-TYPE (2).
 11988     IF DE-AGT-TYPE (3)  = 'P'   MOVE 'O'    TO DE-AGT-TYPE (3).
 11989     IF DE-AGT-TYPE (4)  = 'P'   MOVE 'O'    TO DE-AGT-TYPE (4).
 11990     IF DE-AGT-TYPE (5)  = 'P'   MOVE 'O'    TO DE-AGT-TYPE (5).
 11991     IF DE-AGT-TYPE (6)  = 'P'   MOVE 'O'    TO DE-AGT-TYPE (6).
 11992     IF DE-AGT-TYPE (7)  = 'P'   MOVE 'O'    TO DE-AGT-TYPE (7).
 11993     IF DE-AGT-TYPE (8)  = 'P'   MOVE 'O'    TO DE-AGT-TYPE (8).
 11994     IF DE-AGT-TYPE (9)  = 'P'   MOVE 'O'    TO DE-AGT-TYPE (9).
 11995     IF DE-AGT-TYPE (10) = 'P'   MOVE 'O'    TO DE-AGT-TYPE (10).
 11996
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 233
* ECS010P.cbl
 11997     IF DE-AGT-TYPE (1)  = 'S'   MOVE 'F'    TO DE-AGT-TYPE (1).
 11998     IF DE-AGT-TYPE (2)  = 'B'   MOVE 'G'    TO DE-AGT-TYPE (2).
 11999     IF DE-AGT-TYPE (3)  = 'B'   MOVE 'G'    TO DE-AGT-TYPE (3).
 12000     IF DE-AGT-TYPE (4)  = 'B'   MOVE 'G'    TO DE-AGT-TYPE (4).
 12001     IF DE-AGT-TYPE (5)  = 'B'   MOVE 'G'    TO DE-AGT-TYPE (5).
 12002     IF DE-AGT-TYPE (6)  = 'B'   MOVE 'G'    TO DE-AGT-TYPE (6).
 12003     IF DE-AGT-TYPE (7)  = 'B'   MOVE 'G'    TO DE-AGT-TYPE (7).
 12004     IF DE-AGT-TYPE (8)  = 'B'   MOVE 'G'    TO DE-AGT-TYPE (8).
 12005     IF DE-AGT-TYPE (9)  = 'B'   MOVE 'G'    TO DE-AGT-TYPE (9).
 12006     IF DE-AGT-TYPE (10) = 'B'   MOVE 'G'    TO DE-AGT-TYPE (10).
 12007
 12008
 12009 2590-WRITE-EXTRACTS.
 12010
 12011     MOVE EOM-RUN-DATE            TO DE-PROC-DT
 12012                                     WS-DE-PROC-DT-N.
 12013
 12014     IF DTE-PGM-OPT = '1'
 12015         ADD +1                   TO DE-CNT
 12016*********PERFORM EXTRACT-DATE-RELOAD
 12017         WRITE DETAIL-EXTRACT.
 12018
 12019
 12020 2599-WRT-DETAIL-X.
 12021     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 234
* ECS010P.cbl
 12023******************************************************************
 12024***         R E I N S U R A N C E   P R O C E S S I N G        ***
 12025******************************************************************
 12026
 12027 3000-REINSURE-ROUTINE.
 12028
 12029     IF (CR-POLICY-IS-DECLINED) OR
 12030        (CR-POLICY-IS-VOID)
 12031        GO TO 3099-REINSURE-ROUTINE-X.
 12032
 12033     IF REIN-FLG = 'X'
 12034         GO TO 3099-REINSURE-ROUTINE-X.
 12035
 12036     MOVE 'X' TO REIN-FLG.
 12037
 12038     PERFORM CLEAR-REIN-HOLD THRU CLEAR-REIN-HOLD-X.
 12039
 12040     IF CR-REIN-TABLE = SPACES OR ZEROS
 12041         GO TO 3030-RE-CALCULATE-REINSURANCE.
 12042
 12043******************************************************************
 12044***    R E A D   R E I N S U R A N C E   T A B L E   F I L E   ***
 12045******************************************************************
 12046
 12047 3010-RR-READ-REIN.
 12048
 12049     IF REIN-OPEN-SW = ' '
 12050         MOVE 'X'                       TO REIN-OPEN-SW
 12051         MOVE DTE-CLASIC-COMPANY-CD     TO REIN-SRCH-COMP-CD
 12052         MOVE 'A'                       TO REIN-SRCH-CODE
 12053         OPEN INPUT ERRTBL-IN
 12054         IF ERRTBL-FILE-STATUS = '00'  OR  '97'
 12055             PERFORM REIN-CO-TABLE-BUILD THRU REIN-BUILD-EXIT
 12056          ELSE
 12057             MOVE '21'                  TO ABEND-CODE-1
 12058             MOVE ERRTBL-FILE-STATUS    TO ABEND-CODE-2
 12059             DISPLAY '******************************'
 12060             DISPLAY '***** ERROR LOCATION 015 *****'
 12061             DISPLAY '******************************'
 12062             MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
 12063             GO TO ABEND-PGM.
 12064
 12065     IF CR-REIN-TABLE = REIN-SRCH
 12066         GO TO 3019-RR-READ-REIN-X.
 12067
 12068     MOVE +0                            TO REIN-SUB-1.
 12069     MOVE 999999                        TO REIN-LOW-TIME.
 12070     MOVE CR-REIN-TABLE                 TO REIN-SRCH.
 12071
 12072 3011-RR-CHECK-REIN-SAVE-TABLE.
 12073
 12074     ADD +1                             TO REIN-SUB-1.
 12075     IF REIN-SUB-1 GREATER THAN REIN-MAX  OR
 12076        REIN-SUB-1 GREATER THAN REIN-SUB-2
 12077         GO TO 3015-RR-READ-ERRTBL.
 12078
 12079     IF REIN-SEARCH = SR-CONTROL (REIN-SUB-1)
 12080         MOVE SR-ENTRY (REIN-SUB-1)     TO REINSURANCE-RECORD
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 235
* ECS010P.cbl
 12081         ACCEPT WS-TIME-OF-DAY   FROM TIME
 12082         MOVE WS-TIME                   TO SR-TIME (REIN-SUB-1)
 12083         GO TO 3019-RR-READ-REIN-X.
 12084
 12085     IF SR-TIME (REIN-SUB-1) LESS THAN REIN-LOW-TIME
 12086         MOVE SR-TIME (REIN-SUB-1)      TO REIN-LOW-TIME
 12087         MOVE REIN-SUB-1                TO REIN-LOW-SUB.
 12088
 12089     GO TO 3011-RR-CHECK-REIN-SAVE-TABLE.
 12090
 12091 3015-RR-READ-ERRTBL.
 12092
 12093     MOVE REIN-SEARCH                   TO RE-CONTROL-PRIMARY.
 12094
 12095     READ ERRTBL-IN.
 12096
 12097     IF ERRTBL-FILE-STATUS  = '23'
 12098         DISPLAY 'INVALID REINSURANCE TABLE CODE - ' REIN-SRCH
 12099                                           ' ' CR-FULL-CONTROL
 12100         MOVE '24'                      TO ABEND-CODE-1
 12101         MOVE ERRTBL-FILE-STATUS        TO ABEND-CODE-2
 12102         DISPLAY '******************************'
 12103         DISPLAY '***** ERROR LOCATION 016 *****'
 12104         DISPLAY '******************************'
 12105         MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
 12106         GO TO ABEND-PGM.
 12107
 12108     IF ERRTBL-FILE-STATUS  = '00'  OR  '97'
 12109         NEXT SENTENCE
 12110       ELSE
 12111         MOVE '24'                      TO ABEND-CODE-1
 12112         MOVE ERRTBL-FILE-STATUS        TO ABEND-CODE-2
 12113         DISPLAY '******************************'
 12114         DISPLAY '***** ERROR LOCATION 017 *****'
 12115         DISPLAY '******************************'
 12116         MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
 12117         GO TO ABEND-PGM.
 12118
 12119     ADD +1                            TO ERRTBL-READS.
 12120
 12121     IF REIN-SUB-1 GREATER THAN REIN-MAX
 12122         MOVE REINSURANCE-RECORD       TO SR-ENTRY (REIN-LOW-SUB)
 12123         ACCEPT WS-TIME-OF-DAY   FROM TIME
 12124         MOVE WS-TIME                  TO SR-TIME (REIN-LOW-SUB)
 12125     ELSE
 12126         MOVE REINSURANCE-RECORD       TO SR-ENTRY (REIN-SUB-1)
 12127         ACCEPT WS-TIME-OF-DAY   FROM TIME
 12128         MOVE WS-TIME                  TO SR-TIME (REIN-SUB-1)
 12129         MOVE REIN-SUB-1               TO REIN-SUB-2.
 12130
 12131 3019-RR-READ-REIN-X.
 12132     EXIT.
 12133
 12134 3020-CALCULATE-REINSURANCE.
 12135
 12136*    IF DTE-CLIENT = '???'  AND
 12137*       (CR-REIN-TABLE = 'SE1')
 12138*        PERFORM 3640-NSP-REIN-RATING-ROUTINE THRU 3669-NSP-REIN-X
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 236
* ECS010P.cbl
 12139*        IF CR-STATE NOT = STATE-L
 12140*            MOVE CR-STATE             TO STATE-L
 12141*            PERFORM 8200-STATE-CODE-LOOKUP
 12142*                         THRU 8299-STATE-LOOKUP-X.
 12143
 12144
 12145*    IF DTE-CLIENT = 'DCC'
 12146*       IF CR-LF-NSP-PRM NOT = ZEROS
 12147*          COMPUTE CR-LF-NSP-PRM ROUNDED =
 12148*             (CR-LFPRM + CR-LFPRM-ALT) -
 12149*             ((CR-LFPRM + CR-LFPRM-ALT) * CR-LCOM-L (1))
 12150*       END-IF
 12151*       IF CR-AH-NSP-PRM NOT = ZEROS
 12152*          COMPUTE CR-AH-NSP-PRM ROUNDED =
 12153*          CR-AHPRM -
 12154*          (CR-AHPRM * CR-LCOM-AH (1))
 12155*       END-IF
 12156*    END-IF
 12157
 12158
 12159     IF RE-REMAINING (1) = 'I'
 12160         MOVE '*'                      TO RISK-REIN-FLAG
 12161     ELSE
 12162         GO TO 3029-CONTINUE-REIN-CALC.
 12163
 12164     MOVE SPACE                        TO REIN-CANCEL-LF-SW
 12165                                          REIN-CANCEL-AH-SW.
 12166     MOVE ZEROS                        TO REIN-EARN-LF-TERM
 12167                                          REIN-LCNC-EARN-TERM
 12168                                          REIN-LF-CLM-MONTHS
 12169                                          REIN-EARN-AH-TERM
 12170                                          REIN-ACNC-EARN-TERM
 12171                                          REIN-AH-PRIOR-CLMS-PAID
 12172                                          REIN-AH-CLM-MONTHS
 12173                                          REIN-AH-CLM-MTH-1
 12174                                          REIN-AH-CLM-MTH-2
 12175                                          REIN-AH-CLM-MTH-3
 12176                                          REIN-AH-CLM-MTH-4
 12177                                          REIN-AH-CLM-MTH-5.
 12178
 12179*    MOVE CR-DT                        TO DC-GREG-DATE-CYMD.
 12180*    MOVE 'L'                          TO DC-OPTION-CODE.
 12181*    PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 12182*    MOVE DC-BIN-DATE-1                TO WS-CR-BIN-DATE.
 12183
 12184     IF CR-LFTYP = ZEROS  OR  SPACES
 12185         GO TO 3023-CONTINUE.
 12186
 12187     MOVE EOM-RUN-DATE                 TO VALUATION-DT.
 12188
 12189     IF CR-LF-CANCEL-EXIT-DATE NOT = ZEROS
 12190       IF CR-LF-CANCEL-EXIT-DATE LESS THAN VALUATION-DT
 12191           MOVE CR-LF-CANCEL-EXIT-DATE TO VALUATION-DT.
 12192
 12193     IF CR-LF-CLAIM-EXIT-DATE NOT = ZEROS
 12194       IF CR-LF-CLAIM-EXIT-DATE LESS THAN VALUATION-DT
 12195           MOVE CR-LF-CLAIM-EXIT-DATE  TO VALUATION-DT.
 12196
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 237
* ECS010P.cbl
 12197     MOVE VALUATION-DT                 TO DC-GREG-DATE-CYMD.
 12198     PERFORM 3025-CALC-ELAPSED-MONTHS THRU 3026-CALC-EXIT.
 12199
 12200     IF DC-ELAPSED-MONTHS GREATER THAN CR-LF-TERM
 12201         MOVE CR-LF-TERM               TO MONTHS-DIFF-LF
 12202     ELSE
 12203         MOVE DC-ELAPSED-MONTHS        TO MONTHS-DIFF-LF.
 12204
 12205     IF CR-LF-CANC-DT NOT = ZEROS
 12206         MOVE CR-LF-CANC-DT            TO DC-GREG-DATE-CYMD
 12207         PERFORM 3025-CALC-ELAPSED-MONTHS THRU 3026-CALC-EXIT
 12208         MOVE DC-ELAPSED-MONTHS        TO REIN-LCNC-EARN-TERM
 12209         IF CR-DT = CR-LF-CANC-DT
 12210             MOVE '*'                  TO REIN-CANCEL-LF-SW.
 12211
 12212     IF CR-DTH-DT NOT = ZEROS
 12213         MOVE CR-DTH-DT                TO DC-GREG-DATE-CYMD
 12214         PERFORM 3025-CALC-ELAPSED-MONTHS THRU 3026-CALC-EXIT
 12215         MOVE DC-ELAPSED-MONTHS        TO REIN-LF-CLM-MONTHS.
 12216
 12217     MOVE MONTHS-DIFF-LF               TO REIN-EARN-LF-TERM.
 12218
 12219
 12220 3023-CONTINUE.
 12221
 12222     IF CR-AHTYP = ZEROS  OR  SPACES
 12223        GO TO 3029-CONTINUE-REIN-CALC.
 12224
 12225     MOVE EOM-RUN-DATE                 TO VALUATION-DT.
 12226
 12227     IF CR-AH-CANCEL-EXIT-DATE NOT = ZEROS
 12228       IF CR-AH-CANCEL-EXIT-DATE LESS THAN VALUATION-DT
 12229           MOVE CR-AH-CANCEL-EXIT-DATE TO VALUATION-DT.
 12230
 12231     IF CR-AH-SETTLEMENT-EXIT-DATE NOT = ZEROS
 12232       IF CR-AH-SETTLEMENT-EXIT-DATE LESS THAN VALUATION-DT
 12233           MOVE CR-AH-SETTLEMENT-EXIT-DATE TO VALUATION-DT.
 12234
 12235     MOVE VALUATION-DT                 TO DC-GREG-DATE-CYMD.
 12236     PERFORM 3025-CALC-ELAPSED-MONTHS THRU 3026-CALC-EXIT.
 12237
 12238     IF DC-ELAPSED-MONTHS GREATER THAN CR-AH-TERM
 12239         MOVE CR-AH-TERM               TO MONTHS-DIFF-AH
 12240     ELSE
 12241         MOVE DC-ELAPSED-MONTHS        TO MONTHS-DIFF-AH.
 12242
 12243     IF CR-AH-CANC-DT NOT = ZEROS
 12244         MOVE CR-AH-CANC-DT           TO DC-GREG-DATE-CYMD
 12245         PERFORM 3025-CALC-ELAPSED-MONTHS THRU 3026-CALC-EXIT
 12246         MOVE DC-ELAPSED-MONTHS        TO REIN-ACNC-EARN-TERM
 12247         IF CR-DT = CR-AH-CANC-DT
 12248             MOVE '*'                  TO REIN-CANCEL-AH-SW.
 12249
 12250     IF CR-DIS-INCUR-DT (1) NOT = ZEROS
 12251         MOVE CR-DIS-INCUR-DT (1)    TO DC-GREG-DATE-CYMD
 12252         PERFORM 3025-CALC-ELAPSED-MONTHS THRU 3026-CALC-EXIT
 12253         MOVE DC-ELAPSED-MONTHS        TO REIN-AH-CLM-MTH-1.
 12254
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 238
* ECS010P.cbl
 12255     IF CR-DIS-INCUR-DT (2) NOT = ZEROS
 12256         MOVE CR-DIS-INCUR-DT (2)    TO DC-GREG-DATE-CYMD
 12257         PERFORM 3025-CALC-ELAPSED-MONTHS THRU 3026-CALC-EXIT
 12258         MOVE DC-ELAPSED-MONTHS        TO REIN-AH-CLM-MTH-2.
 12259
 12260     IF CR-DIS-INCUR-DT (3) NOT = ZEROS
 12261         MOVE CR-DIS-INCUR-DT (3)      TO DC-GREG-DATE-CYMD
 12262         PERFORM 3025-CALC-ELAPSED-MONTHS THRU 3026-CALC-EXIT
 12263         MOVE DC-ELAPSED-MONTHS        TO REIN-AH-CLM-MTH-3.
 12264
 12265     IF CR-DIS-INCUR-DT (4) NOT = ZEROS
 12266         MOVE CR-DIS-INCUR-DT (4)    TO DC-GREG-DATE-CYMD
 12267         PERFORM 3025-CALC-ELAPSED-MONTHS THRU 3026-CALC-EXIT
 12268         MOVE DC-ELAPSED-MONTHS        TO REIN-AH-CLM-MTH-4.
 12269
 12270     IF CR-DIS-INCUR-DT (5) NOT = ZEROS
 12271         MOVE CR-DIS-INCUR-DT (5)    TO DC-GREG-DATE-CYMD
 12272         PERFORM 3025-CALC-ELAPSED-MONTHS THRU 3026-CALC-EXIT
 12273         MOVE DC-ELAPSED-MONTHS        TO REIN-AH-CLM-MTH-5.
 12274
 12275     MOVE MONTHS-DIFF-AH               TO REIN-EARN-AH-TERM.
 12276
 12277
 12278     GO TO 3029-CONTINUE-REIN-CALC.
 12279
 12280
 12281 3025-CALC-ELAPSED-MONTHS.
 12282
 12283     MOVE 'L'                          TO DC-OPTION-CODE.
 12284     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 12285     MOVE DC-BIN-DATE-1                TO DC-BIN-DATE-2.
 12286     MOVE WS-CR-BIN-DATE               TO DC-BIN-DATE-1.
 12287     MOVE '1'                          TO DC-OPTION-CODE.
 12288     MOVE ' '                          TO DC-CENTURY-ADJUSTMENT.
 12289     MOVE ZEROS                        TO DC-ELAPSED-MONTHS
 12290                                          DC-ODD-DAYS-OVER
 12291                                          DC-ELAPSED-DAYS.
 12292     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 12293
 12294 3026-CALC-EXIT.
 12295     EXIT.
 12296
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 239
* ECS010P.cbl
 12298 3029-CONTINUE-REIN-CALC.
 12299
*12300                             COPY ECSRTPFM.
 12301******************************************************************07/10/97
 12302*                                                                *ECSRTPFM
 12303*                            ECSRTPFM                            *   LV001
 12304*                            VMOD=2.002                          *ECSRTPFM
 12305*                                                                *ECSRTPFM
 12306******************************************************************ECSRTPFM
 12307                                                                  ECSRTPFM
 12308     IF    CR-LFAMT  NUMERIC                                      00000072
 12309           NEXT SENTENCE                                          00000073
 12310        ELSE                                                      00000074
 12311           MOVE ZEROS TO CR-LFAMT.                                00000075
 12312                                                                  00000076
 12313     IF    CR-LFAMT-ALT  NUMERIC                                  00000077
 12314           NEXT SENTENCE                                          00000078
 12315        ELSE                                                      00000079
 12316           MOVE ZEROS TO CR-LFAMT-ALT.                            00000080
 12317                                                                  00000081
 12318                                                                  00000082
 12319     IF    CR-LFPRM  NUMERIC                                      00000083
 12320           NEXT SENTENCE                                          00000084
 12321        ELSE                                                      00000085
 12322           MOVE ZEROS TO CR-LFPRM.                                00000086
 12323                                                                  00000087
 12324     IF    CR-LFPRM-ALT  NUMERIC                                  00000088
 12325           NEXT SENTENCE                                          00000089
 12326        ELSE                                                      00000090
 12327           MOVE ZEROS TO CR-LFPRM-ALT.                            00000091
 12328                                                                  00000092
 12329                                                                  00000093
 12330     IF    CR-LFPRM-CALC  NUMERIC                                 00000094
 12331           NEXT SENTENCE                                          00000095
 12332        ELSE                                                      00000096
 12333           MOVE ZEROS TO CR-LFPRM-CALC.                           00000097
 12334                                                                  00000098
 12335     IF    CR-LFPRM-CALC-ALT  NUMERIC                             00000099
 12336           NEXT SENTENCE                                          00000100
 12337        ELSE                                                      00000101
 12338           MOVE ZEROS TO CR-LFPRM-CALC-ALT.                       00000102
 12339                                                                  00000103
 12340     IF    CR-LF-NSP-PRM  NUMERIC                                 00000104
 12341           NEXT SENTENCE                                          00000105
 12342        ELSE                                                      00000106
 12343           MOVE ZEROS TO CR-LF-NSP-PRM.                           00000107
 12344                                                                  00000108
 12345     COMPUTE RS-R-LB = CR-LFAMT + CR-LFAMT-ALT.                   ECSRTPFM
 12346     COMPUTE RS-R-LP = CR-LFPRM + CR-LFPRM-ALT.                   ECSRTPFM
 12347     IF RE-NSP-ST-CD-LF = ZEROS  OR  SPACES                       ECSRTPFM
 12348         COMPUTE RS-R-LPC = CR-LFPRM-CALC + CR-LFPRM-CALC-ALT     ECSRTPFM
 12349     ELSE                                                         ECSRTPFM
 12350         MOVE CR-LF-NSP-PRM         TO RS-R-LPC.                  ECSRTPFM
 12351     MOVE RS-R-LPC                  TO REIN-CALCED-LIFE.          ECSRTPFM
 12352                                                                  ECSRTPFM
 12353     MOVE CR-AHAMT                  TO RS-R-AB.                   ECSRTPFM
 12354     MOVE CR-AHPRM                  TO RS-R-AP.                   ECSRTPFM
 12355     IF RE-NSP-ST-CD-AH = ZEROS  OR  SPACES                       ECSRTPFM
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 240
* ECS010P.cbl (/apps/prod/cid1p/copy/ECSRTPFM)
 12356         MOVE CR-AHPRM-CALC         TO RS-R-APC                   ECSRTPFM
 12357     ELSE                                                         ECSRTPFM
 12358         MOVE CR-AH-NSP-PRM         TO RS-R-APC.                  ECSRTPFM
 12359     MOVE RS-R-APC                  TO REIN-CALCED-AH.            ECSRTPFM
 12360                                                                  ECSRTPFM
 12361     PERFORM REINSURE-CALC THRU REINSURE-CALC-X                   ECSRTPFM
 12362         VARYING SUB1 FROM +1 BY +1                               ECSRTPFM
 12363             UNTIL RE-REI-COMP-NO (SUB1) = SPACES.                ECSRTPFM
 12364                                                                  ECSRTPFM
 12365
 12366     MOVE 'X'                  TO REIN-RT-SW.
 12367     PERFORM 3200-REINSURE-CANCEL THRU 3299-REINSURE-CANCEL-X.
 12368     PERFORM 3300-REINSURE-CLAIM THRU 3399-REINSURE-CLAIM-X.
 12369     MOVE ' '                  TO REIN-RT-SW.
 12370
 12371 3030-RE-CALCULATE-REINSURANCE.
 12372
 12373     IF AM-RECALC-REIN = 'Y'
 12374         IF CR-REIN-TABLE NOT = AM-REI-TABLE  AND
 12375            CR-REIN-SPEC = SPACE  AND
 12376            CR-ENTRY-DATE NOT = EOM-RUN-DATE
 12377             PERFORM 3600-RC-REINSURANCE
 12378                 THRU 3799-RC-REINSURANCE-X.
 12379
 12380     PERFORM 3040-REIN-REC-CNT THRU 3049-RRC-XIT
 12381         VARYING SUB1 FROM 1 BY 1
 12382             UNTIL REIN-COMP (SUB1) = SPACES.
 12383
 12384     GO TO 3099-REINSURE-ROUTINE-X.
 12385
 12386 3040-REIN-REC-CNT.
 12387
 12388     IF REIN-LF-AH-FLGS (SUB1) = SPACES
 12389         GO TO 3049-RRC-XIT.
 12390
 12391     PERFORM 3050-REIN-COMP-ADD THRU 3059-RCA-XIT
 12392         VARYING B-SUB FROM 1 BY 1
 12393             UNTIL B-SUB GREATER THAN 50.
 12394
 12395 3049-RRC-XIT.
 12396     EXIT.
 12397
 12398 3050-REIN-COMP-ADD.
 12399
 12400     IF RB-COMPANY (B-SUB) = SPACES
 12401         MOVE REIN-COMP (SUB1) TO RB-COMPANY (B-SUB).
 12402     IF RB-COMPANY (B-SUB) = REIN-COMP (SUB1)
 12403         MOVE 1   TO RB-COUNT (B-SUB)
 12404         MOVE +50 TO B-SUB.
 12405
 12406 3059-RCA-XIT.
 12407     EXIT.
 12408
 12409 3099-REINSURE-ROUTINE-X.
 12410     EXIT.
 12411
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 241
* ECS010P.cbl
 12413******************************************************************
 12414***                R E I N S U R E   I S S U E S               ***
 12415******************************************************************
 12416
 12417 3100-REINSURE-ISSUE.
 12418
 12419     IF  REIN-COMP (1) = SPACES
 12420         GO TO 3199-REINSURE-ISSUE-X.
 12421
 12422     PERFORM 2000-INITIALIZE-DETAIL-EXTRACT THRU 2099-INIT-DTL-X.
 12423     MOVE ZEROS    TO RW-ACCUM-LF  RW-ACCUM-AH.
 12424     MOVE 'I'      TO DE-TRANS.
 12425     MOVE 'R'      TO DE-REIN.
 12426*****PERFORM EXTRACT-DATE-RELOAD.
 12427     MOVE DETAIL-EXTRACT TO SAVE-EXTRACT.
 12428     MOVE +1       TO SUB1.
 12429
 12430 3110-REINSURE-ISSUE-LOOP.
 12431
 12432     IF REIN-COMP (SUB1) = SPACES
 12433         GO TO 3119-REINSURE-ISSUE-LOOP-END.
 12434
 12435     IF UPDATING-RISK-PREMIUMS
 12436       IF REIN-REM-SW (SUB1) NOT = 'I'
 12437         ADD +1 TO SUB1
 12438         GO TO 3110-REINSURE-ISSUE-LOOP.
 12439
 12440     IF REIN-REM-SW (SUB1) = 'Z'
 12441         ADD +1 TO SUB1
 12442         GO TO 3110-REINSURE-ISSUE-LOOP.
 12443
 12444     MOVE REIN-COMP (SUB1)      TO DE-REI-COMP.
 12445     MOVE REIN-WORK-FLDS (SUB1) TO RWF-FIELDS.
 12446     MOVE RWF-LFAMT             TO DE-REI-LFAMT.
 12447     MOVE RWF-LFPRM             TO DE-REI-LFPRM.
 12448     MOVE RWF-AHAMT             TO DE-REI-AHAMT.
 12449     MOVE RWF-AHPRM             TO DE-REI-AHPRM.
 12450
 12451     IF REIN-REM-SW (SUB1) NOT = 'I'
 12452         GO TO 3115-CONTINUE-ISSUE-LOOP.
 12453
 12454     IF RWF-LFPRM = ZEROS  AND
 12455        RWF-AHPRM = ZEROS
 12456         GO TO 3115-CONTINUE-ISSUE-LOOP.
 12457
 12458     IF RWF-LFPRM NOT = ZEROS
 12459         COMPUTE DE-REI-LFPRM = RWF-LFPRM - CR-LF-REI-RISK-PRM
 12460         MOVE RWF-LFPRM         TO CR-LF-REI-RISK-PRM.
 12461
 12462     IF RWF-AHPRM NOT = ZEROS
 12463         COMPUTE DE-REI-AHPRM = RWF-AHPRM - CR-AH-REI-RISK-PRM
 12464         MOVE RWF-AHPRM         TO CR-AH-REI-RISK-PRM.
 12465
 12466 3115-CONTINUE-ISSUE-LOOP.
 12467
 12468     ADD DE-REI-LFPRM           TO RW-ACCUM-LF.
 12469     ADD DE-REI-AHPRM           TO RW-ACCUM-AH.
 12470
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 242
* ECS010P.cbl
 12471     IF DE-REI-LFAMT NOT = ZERO
 12472        OR DE-REI-LFPRM NOT = ZERO
 12473        OR DE-REI-AHAMT NOT = ZERO
 12474        OR DE-REI-AHPRM NOT = ZERO
 12475         PERFORM 2500-WRITE-DETAIL-EXTRACTS THRU
 12476                 2599-WRT-DETAIL-X
 12477         ADD +1 TO BC-R-ISS.
 12478
 12479     ADD +1 TO SUB1.
 12480     MOVE SAVE-EXTRACT TO DETAIL-EXTRACT.
 12481     PERFORM EXTRACT-DATE-LOAD.
 12482
 12483     GO TO 3110-REINSURE-ISSUE-LOOP.
 12484
 12485 3119-REINSURE-ISSUE-LOOP-END.
 12486     EXIT.
 12487
 12488 3190-REINSURE-ISSUE-PRINT.
 12489
 12490     PERFORM 8600-SETUP-DETAIL-LINE THRU 8689-SETUP-DETAIL-X.
 12491     IF RW-ACCUM-LF NOT = ZERO
 12492         MOVE CLAS-I-AB3 (CLAS-INDEXL) TO TRD-LFTYP
 12493         MOVE CR-LF-TERM               TO TRD-LFTRM
 12494         MOVE RW-ACCUM-LF         TO TRD-LFPRM-RFND
 12495         MOVE 'REIN CEDED'        TO TRD-LF-ACTION.
 12496     IF RW-ACCUM-AH NOT = ZERO
 12497         MOVE CLAS-I-AB3 (CLAS-INDEXA) TO TRD-AHTYP
 12498         MOVE CR-AH-TERM               TO TRD-AHTRM
 12499         MOVE RW-ACCUM-AH         TO TRD-AHPRM-RFND
 12500         MOVE 'REIN CEDED'        TO TRD-AH-ACTION.
 12501     IF RW-ACCUM-LF NOT = ZERO  OR  RW-ACCUM-AH NOT = ZERO
 12502         PERFORM 8690-PRINT-DETAIL-LINE THRU 8699-PRT-DETAIL-X.
 12503
 12504 3199-REINSURE-ISSUE-X.
 12505     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 243
* ECS010P.cbl
 12507******************************************************************
 12508***               R E I N S U R E   C A N C E L S              ***
 12509******************************************************************
 12510
 12511 3200-REINSURE-CANCEL.
 12512
 12513     IF REIN-COMP (1) = SPACES
 12514         GO TO 3299-REINSURE-CANCEL-X.
 12515
 12516     IF CR-LFRFND = ZERO
 12517        AND CR-AHRFND = ZERO
 12518         GO TO 3299-REINSURE-CANCEL-X.
 12519
 12520     PERFORM REINSURE-CALC-CANCEL THRU REINSURE-CALC-CANCEL-X
 12521             VARYING SUB1 FROM +1 BY +1 UNTIL
 12522                       REIN-COMP (SUB1) = SPACES.
 12523
 12524     IF REIN-RT-SW = 'X'
 12525         GO TO 3299-REINSURE-CANCEL-X.
 12526
 12527     PERFORM 2200-BUILD-CANCEL-EXTRACT THRU 2259-END-CANCEL-BUILD.
 12528     MOVE ZEROS    TO RW-ACCUM-LF  RW-ACCUM-AH.
 12529     MOVE 'R'      TO DE-REIN.
 12530*****PERFORM EXTRACT-DATE-RELOAD.
 12531     MOVE DETAIL-EXTRACT TO SAVE-EXTRACT.
 12532     MOVE +1       TO SUB1.
 12533
 12534 3210-REINSURE-CANCEL-LOOP.
 12535
 12536     IF REIN-COMP (SUB1) = SPACES
 12537         GO TO 3219-REINSURE-CANCEL-LOOP-END.
 12538
 12539     IF REIN-REM-SW (SUB1) = 'Z'
 12540         ADD +1        TO SUB1
 12541         MOVE SAVE-EXTRACT TO DETAIL-EXTRACT
 12542         PERFORM EXTRACT-DATE-LOAD
 12543         GO TO 3210-REINSURE-CANCEL-LOOP.
 12544
 12545     MOVE REIN-COMP (SUB1)      TO DE-REI-COMP.
 12546     MOVE REIN-WORK-FLDS (SUB1) TO RWF-FIELDS.
 12547
 12548     MOVE RWF-LFRFND            TO DE-REI-LFRFND.
 12549     MOVE RWF-AHRFND            TO DE-REI-AHRFND.
 12550     MOVE RWF-LFAMT             TO DE-REI-LFAMT.
 12551     MOVE RWF-LFPRM             TO DE-REI-LFPRM.
 12552     MOVE RWF-AHAMT             TO DE-REI-AHAMT.
 12553     MOVE RWF-AHPRM             TO DE-REI-AHPRM.
 12554     ADD RWF-LFRFND             TO RW-ACCUM-LF.
 12555     ADD RWF-AHRFND             TO RW-ACCUM-AH.
 12556     COMPUTE DE-REI-CNAMT = RWF-LFAMT * TEMP-5.
 12557
 12558     IF REIN-REM-SW (SUB1) NOT = 'I'
 12559         GO TO 3215-CONTINUE-CANCEL-LOOP.
 12560
 12561     IF CR-LF-CANCEL-EXIT-DATE = EOM-RUN-DATE  OR
 12562        VOIDING-LF-CANCEL
 12563         NEXT SENTENCE
 12564     ELSE
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 244
* ECS010P.cbl
 12565         MOVE ZEROS             TO DE-REI-LFRFND.
 12566
 12567     IF CR-AH-CANCEL-EXIT-DATE = EOM-RUN-DATE  OR
 12568        VOIDING-AH-CANCEL
 12569         NEXT SENTENCE
 12570     ELSE
 12571         MOVE ZEROS             TO DE-REI-AHRFND.
 12572
 12573 3215-CONTINUE-CANCEL-LOOP.
 12574
 12575     IF RWF-LF-RUNOFF-SW = 'N'
 12576         IF DE-LF-CANC-DTE NOT LESS THAN RWF-EP-STOP-DATE
 12577             MOVE ZEROS         TO DE-LF-TYPE
 12578                                   DE-REI-LFAMT
 12579                                   DE-REI-LFPRM
 12580                                   DE-REI-LFRFND
 12581                                   DE-REI-CNAMT.
 12582
 12583     IF RWF-AH-RUNOFF-SW = 'N'
 12584         IF DE-AH-CANC-DTE NOT LESS THAN RWF-EP-STOP-DATE
 12585             MOVE ZEROS         TO DE-AH-TYPE
 12586                                   DE-REI-AHAMT
 12587                                   DE-REI-AHPRM
 12588                                   DE-REI-AHRFND.
 12589
 12590     IF DE-REI-LFAMT NOT = ZERO
 12591        OR DE-REI-LFPRM NOT = ZERO
 12592        OR DE-REI-AHAMT NOT = ZERO
 12593        OR DE-REI-AHPRM NOT = ZERO
 12594        OR DE-REI-LFRFND NOT = ZERO
 12595        OR DE-REI-AHRFND NOT = ZERO
 12596        OR DE-REI-CNAMT NOT = ZERO
 12597         PERFORM 2500-WRITE-DETAIL-EXTRACTS THRU
 12598                                            2599-WRT-DETAIL-X
 12599         ADD +1 TO BC-R-CNC.
 12600
 12601     ADD +1 TO SUB1.
 12602     MOVE SAVE-EXTRACT TO DETAIL-EXTRACT.
 12603     PERFORM EXTRACT-DATE-LOAD.
 12604     GO TO 3210-REINSURE-CANCEL-LOOP.
 12605
 12606 3219-REINSURE-CANCEL-LOOP-END.
 12607     EXIT.
 12608
 12609 3290-REINSURE-CANCEL-PRINT.
 12610
 12611     PERFORM 8600-SETUP-DETAIL-LINE THRU 8689-SETUP-DETAIL-X.
 12612     IF RW-ACCUM-LF NOT = ZERO
 12613         MOVE CLAS-I-AB3 (CLAS-INDEXL) TO TRD-LFTYP
 12614         MOVE CR-LF-TERM               TO TRD-LFTRM
 12615         MOVE RW-ACCUM-LF         TO TRD-LFPRM-RFND
 12616         MOVE 'REIN CANCL'        TO TRD-LF-ACTION.
 12617     IF RW-ACCUM-AH NOT = ZERO
 12618         MOVE CLAS-I-AB3 (CLAS-INDEXA) TO TRD-AHTYP
 12619         MOVE CR-AH-TERM               TO TRD-AHTRM
 12620         MOVE RW-ACCUM-AH         TO TRD-AHPRM-RFND
 12621         MOVE 'REIN CANCL'        TO TRD-AH-ACTION.
 12622     IF RW-ACCUM-LF NOT = ZERO  OR  RW-ACCUM-AH NOT = ZERO
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 245
* ECS010P.cbl
 12623         PERFORM 8690-PRINT-DETAIL-LINE THRU 8699-PRT-DETAIL-X.
 12624
 12625 3299-REINSURE-CANCEL-X.
 12626     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 246
* ECS010P.cbl
 12628******************************************************************
 12629***                R E I N S U R E   C L A I M S               ***
 12630******************************************************************
 12631
 12632 3300-REINSURE-CLAIM.
 12633
 12634*    IF DTE-CLIENT = '???'
 12635*       IF (REIN-RT-SW NOT = 'X')  AND
 12636*          (PC-PAYMENT-TYPE = '5' OR '6')
 12637*        GO TO 3399-REINSURE-CLAIM-X.
 12638
 12639     IF REIN-COMP (1) = SPACES
 12640         GO TO 3399-REINSURE-CLAIM-X.
 12641
 12642     IF REIN-RT-SW = 'X'
 12643         MOVE CR-DTHAMT   TO RW-LFCLMWK
 12644         ADD  CR-DTHEXP   TO RW-LFCLMWK
 12645         MOVE CR-DISAMT   TO RW-AHCLMWK
 12646         ADD  CR-DISEXP   TO RW-AHCLMWK
 12647     ELSE
 12648         IF PC-CLAIM-TYPE  = 1 OR 3
 12649             MOVE PC-CLAIM-PAYMENT    TO RW-LFCLMWK
 12650             MOVE +0                  TO RW-AHCLMWK
 12651         ELSE
 12652             MOVE PC-CLAIM-PAYMENT    TO RW-AHCLMWK
 12653             MOVE +0                  TO RW-LFCLMWK.
 12654
 12655     MOVE +0                          TO RW-LFCLM
 12656                                         RW-AHCLM.
 12657     IF RW-LFCLMWK = ZERO
 12658        AND RW-AHCLMWK = ZERO
 12659         GO TO 3399-REINSURE-CLAIM-X.
 12660
 12661     PERFORM REINSURE-CALC-CLAIM THRU REINSURE-CALC-CLAIM-X
 12662         VARYING SUB1 FROM +1 BY +1
 12663             UNTIL REIN-COMP (SUB1) = SPACES.
 12664
 12665     IF REIN-RT-SW = 'X'
 12666         GO TO 3399-REINSURE-CLAIM-X.
 12667
 12668     PERFORM 2300-BUILD-CLAIM-EXTRACT.
 12669     MOVE ZEROS                TO RW-ACCUM-CLM.
 12670     MOVE 'R'                  TO DE-REIN.
 12671*****PERFORM EXTRACT-DATE-RELOAD.
 12672     MOVE DETAIL-EXTRACT       TO SAVE-EXTRACT.
 12673     MOVE +1                   TO SUB1.
 12674
 12675 3310-REINSURE-CLAIM-LOOP.
 12676
 12677     IF REIN-COMP (SUB1) = SPACES
 12678         GO TO 3390-REINSURE-CLAIM-PRINT.
 12679
 12680     IF REIN-REM-SW (SUB1) = 'Z'
 12681         ADD +1        TO SUB1
 12682         MOVE SAVE-EXTRACT TO DETAIL-EXTRACT
 12683         PERFORM EXTRACT-DATE-LOAD
 12684         GO TO 3310-REINSURE-CLAIM-LOOP.
 12685
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 247
* ECS010P.cbl
 12686     MOVE REIN-COMP (SUB1)      TO DE-REI-COMP.
 12687     MOVE REIN-WORK-FLDS (SUB1) TO RWF-FIELDS.
 12688
 12689     IF PC-CLAIM-TYPE  = 1 OR 3
 12690         IF RWF-LF-RUNOFF-SW = 'N'
 12691           IF CR-DTH-DT NOT LESS THAN RWF-EP-STOP-DATE
 12692               GO TO 3330-REINSURE-CLAIM-LOOP-ADD.
 12693
 12694     IF PC-CLAIM-TYPE  = 2 OR 4
 12695         IF RWF-AH-RUNOFF-SW = 'N'
 12696           IF CR-DIS-DT NOT LESS THAN RWF-EP-STOP-DATE
 12697               GO TO 3330-REINSURE-CLAIM-LOOP-ADD.
 12698
 12699     MOVE RWF-LFAMT             TO DE-REI-LFAMT.
 12700     MOVE RWF-LFPRM             TO DE-REI-LFPRM.
 12701     MOVE RWF-AHAMT             TO DE-REI-AHAMT.
 12702     MOVE RWF-AHPRM             TO DE-REI-AHPRM.
 12703
 12704     IF PC-CLAIM-TYPE  = 1 OR 3
 12705         MOVE RWF-LFCLML TO DE-REI-CLAIM-AMT
 12706         ADD RWF-LFCLML  TO RW-ACCUM-CLM
 12707     ELSE
 12708         MOVE RWF-AHCLML TO DE-REI-CLAIM-AMT
 12709         ADD RWF-AHCLML  TO RW-ACCUM-CLM.
 12710
 12711     IF PC-CLAIM-TYPE = 1 OR 3
 12712         IF +0 = DE-REI-LFPRM AND DE-REI-LFAMT
 12713            AND DE-REI-CLAIM-AMT
 12714             GO TO 3330-REINSURE-CLAIM-LOOP-ADD
 12715         ELSE
 12716             GO TO 3320-REINSURE-CLAIM-LOOP-GO
 12717     ELSE
 12718         IF +0 = DE-REI-AHPRM AND DE-REI-AHAMT
 12719            AND DE-REI-CLAIM-AMT
 12720             GO TO 3330-REINSURE-CLAIM-LOOP-ADD
 12721         ELSE
 12722             GO TO 3320-REINSURE-CLAIM-LOOP-GO.
 12723
 12724 3320-REINSURE-CLAIM-LOOP-GO.
 12725
 12726     PERFORM 2500-WRITE-DETAIL-EXTRACTS THRU 2599-WRT-DETAIL-X.
 12727     ADD +1                     TO BC-R-CLM.
 12728
 12729 3330-REINSURE-CLAIM-LOOP-ADD.
 12730
 12731     ADD +1                     TO SUB1.
 12732     MOVE SAVE-EXTRACT          TO DETAIL-EXTRACT.
 12733     PERFORM EXTRACT-DATE-LOAD.
 12734     GO TO 3310-REINSURE-CLAIM-LOOP.
 12735
 12736 3390-REINSURE-CLAIM-PRINT.
 12737
 12738     PERFORM 8600-SETUP-DETAIL-LINE THRU 8689-SETUP-DETAIL-X.
 12739     IF PC-CLAIM-TYPE = '1'  OR  '3'
 12740         MOVE CLAS-I-AB3 (CLAS-INDEXL) TO TRD-LFTYP
 12741         MOVE CR-LF-TERM               TO TRD-LFTRM
 12742         MOVE RW-ACCUM-CLM     TO TRD-LFCOM-CLM
 12743         MOVE 'REIN CLAIM'     TO TRD-LF-ACTION
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 248
* ECS010P.cbl
 12744     ELSE
 12745         MOVE CLAS-I-AB3 (CLAS-INDEXA) TO TRD-AHTYP
 12746         MOVE CR-AH-TERM               TO TRD-AHTRM
 12747         MOVE RW-ACCUM-CLM     TO TRD-AHCOM-CLM
 12748         MOVE CR-DIS-MO        TO TRD-AHACTMO
 12749         MOVE CR-DIS-DA        TO TRD-AHACTDA
 12750         MOVE CR-DIS-YR        TO TRD-AHACTYR
 12751         MOVE '/'              TO TRD-AH-S1  TRD-AH-S2
 12752         MOVE 'REIN CLAIM'     TO TRD-AH-ACTION.
 12753     PERFORM 8690-PRINT-DETAIL-LINE THRU 8699-PRT-DETAIL-X.
 12754
 12755 3399-REINSURE-CLAIM-X.
 12756     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 249
* ECS010P.cbl
 12758******************************************************************
 12759***              R E I N S U R E   R E S E R V E S             ***
 12760******************************************************************
 12761
 12762 3400-REINSURE-RESERVE.
 12763
 12764     IF REIN-COMP (1) = SPACES
 12765         GO TO 3499-REINSURE-RESERVE-X.
 12766
 12767     IF PC-CLAIM-TYPE = '1' OR '3'
 12768         MOVE PC-IBNR-RESERVE-AMT    TO RW-LFIBNRWK
 12769         MOVE PC-PTC-RESERVE-AMT     TO RW-LFPAYCURWK
 12770         MOVE PC-FUTURE-RESERVE-AMT  TO RW-LFFUTRSVWK
 12771         ADD  PC-MANUAL-RESERVE-AMT  TO RW-LFFUTRSVWK
 12772         MOVE +0 TO RW-AHIBNRWK  RW-AHPAYCURWK  RW-AHFUTRSVWK
 12773     ELSE
 12774         MOVE PC-IBNR-RESERVE-AMT    TO RW-AHIBNRWK
 12775         MOVE PC-PTC-RESERVE-AMT     TO RW-AHPAYCURWK
 12776         MOVE PC-FUTURE-RESERVE-AMT  TO RW-AHFUTRSVWK
 12777         ADD  PC-MANUAL-RESERVE-AMT  TO RW-AHFUTRSVWK
 12778         MOVE +0 TO RW-LFIBNRWK  RW-LFPAYCURWK  RW-LFFUTRSVWK.
 12779
 12780     MOVE +0 TO RW-LFIBNR  RW-LFPAYCUR  RW-LFFUTRSV
 12781                RW-AHIBNR  RW-AHPAYCUR  RW-AHFUTRSV.
 12782     IF +0 = RW-LFIBNRWK AND RW-LFPAYCURWK AND RW-LFFUTRSVWK
 12783         AND RW-AHIBNRWK AND RW-AHPAYCURWK AND RW-AHFUTRSVWK
 12784          GO TO 3499-REINSURE-RESERVE-X.
 12785
 12786     IF DTE-CLIENT NOT = 'MIC'
 12787         GO TO 3405-REINSURE-RESERVE-CONT.
 12788
 12789     IF PC-CLAIM-TYPE = '1'  OR  '3'
 12790         GO TO 3405-REINSURE-RESERVE-CONT.
 12791
 12792     MOVE PC-CERT-EFF-DT             TO CP-CERT-EFF-DT.
 12793     MOVE BIN-VALUATION-DT           TO CP-VALUATION-DT.
 12794     MOVE PC-PAID-THRU-DT            TO CP-PAID-THRU-DT.
 12795     MOVE 'A'                        TO CP-BENEFIT-TYPE
 12796                                        CP-CLAIM-TYPE.
 12797     MOVE PC-INCURRED-DT             TO CP-INCURRED-DT.
 12798     MOVE PC-REPORTED-DT             TO CP-REPORTED-DT.
 12799     MOVE DTE-CLIENT                 TO CP-COMPANY-ID.
 12800     MOVE CR-AGE                     TO CP-ISSUE-AGE.
 12801     MOVE ZEROS                      TO CP-CDT-PERCENT.
 12802     MOVE '3'                        TO CP-CDT-METHOD.
 12803     MOVE CR-AH-TERM                 TO CP-ORIGINAL-TERM.
 12804     MOVE CR-AHAMT                   TO CP-ORIGINAL-BENEFIT
 12805                                        CP-RATING-BENEFIT-AMT.
 12806     MOVE PC-REMAINING-TERM          TO CP-REMAINING-TERM.
 12807     MOVE 'O'                        TO CP-CLAIM-STATUS.
 12808
 12809 3405-REINSURE-RESERVE-CONT.
 12810
 12811     PERFORM 3500-REINSURE-CALC-RESERVE
 12812         THRU 3599-REINSURE-CALC-RESERVE-X
 12813             VARYING SUB1 FROM +1 BY +1
 12814                 UNTIL REIN-COMP (SUB1) = SPACES.
 12815
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 250
* ECS010P.cbl
 12816     PERFORM 2400-BUILD-RESERVE-EXTRACT.
 12817     MOVE +0 TO RW-ACCUM-IBNR  RW-ACCUM-PAYCUR  RW-ACCUM-FUTRSV.
 12818     MOVE 'R'            TO DE-REIN.
 12819*****PERFORM EXTRACT-DATE-RELOAD.
 12820     MOVE DETAIL-EXTRACT TO SAVE-EXTRACT.
 12821     MOVE +1             TO SUB1.
 12822
 12823 3410-REINSURE-RESERVE-LOOP.
 12824
 12825     IF REIN-COMP (SUB1) = SPACES
 12826         GO TO 3490-REINSURE-RESERVE-PRINT.
 12827
 12828     IF REIN-REM-SW (SUB1) = 'Z'
 12829         ADD +1 TO SUB1
 12830         GO TO 3410-REINSURE-RESERVE-LOOP.
 12831
 12832     MOVE REIN-COMP (SUB1)      TO DE-REI-COMP.
 12833     MOVE REIN-WORK-FLDS (SUB1) TO RWF-FIELDS.
 12834
 12835     IF PC-CLAIM-TYPE  = 1 OR 3
 12836         IF RWF-LF-RUNOFF-SW = 'N'
 12837           IF CR-DTH-DT NOT LESS THAN RWF-EP-STOP-DATE
 12838               GO TO 3415-REINSURE-RESERVE-LOOP-ADD.
 12839
 12840     IF PC-CLAIM-TYPE  = 2 OR 4
 12841         IF RWF-AH-RUNOFF-SW = 'N'
 12842           IF CR-DIS-DT NOT LESS THAN RWF-EP-STOP-DATE
 12843               GO TO 3415-REINSURE-RESERVE-LOOP-ADD.
 12844
 12845     MOVE RWF-LFAMT             TO DE-REI-LFAMT.
 12846     MOVE RWF-LFPRM             TO DE-REI-LFPRM.
 12847     MOVE RWF-AHAMT             TO DE-REI-AHAMT.
 12848     MOVE RWF-AHPRM             TO DE-REI-AHPRM.
 12849
 12850     IF PC-CLAIM-TYPE = 1 OR 3
 12851         MOVE RWF-DTH-IBNRL   TO DE-REI-IBNR
 12852         MOVE RWF-DTH-PAYCURL TO DE-REI-PAYCUR
 12853         MOVE RWF-DTH-FUTRSVL TO DE-REI-FUTRSV
 12854     ELSE
 12855         MOVE RWF-DIS-IBNRL   TO DE-REI-IBNR
 12856         MOVE RWF-DIS-PAYCURL TO DE-REI-PAYCUR
 12857         MOVE RWF-DIS-FUTRSVL TO DE-REI-FUTRSV.
 12858
 12859     ADD DE-REI-IBNR            TO RW-ACCUM-IBNR.
 12860     ADD DE-REI-PAYCUR          TO RW-ACCUM-PAYCUR.
 12861     ADD DE-REI-FUTRSV          TO RW-ACCUM-FUTRSV.
 12862
 12863     IF +0 NOT = DE-REI-LFAMT OR DE-REI-LFPRM OR DE-REI-AHAMT
 12864        OR DE-REI-AHPRM OR DE-REI-IBNR OR DE-REI-PAYCUR
 12865        OR DE-REI-FUTRSV
 12866         PERFORM 2500-WRITE-DETAIL-EXTRACTS THRU
 12867                                            2599-WRT-DETAIL-X
 12868         ADD +1 TO BC-R-CRS.
 12869
 12870 3415-REINSURE-RESERVE-LOOP-ADD.
 12871
 12872     ADD +1 TO SUB1.
 12873     MOVE SAVE-EXTRACT TO DETAIL-EXTRACT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 251
* ECS010P.cbl
 12874     PERFORM EXTRACT-DATE-LOAD.
 12875     GO TO 3410-REINSURE-RESERVE-LOOP.
 12876
 12877 3490-REINSURE-RESERVE-PRINT.
 12878
 12879     IF RW-ACCUM-IBNR   = ZERO  AND
 12880        RW-ACCUM-PAYCUR = ZERO  AND
 12881        RW-ACCUM-FUTRSV = ZERO
 12882         GO TO 3499-REINSURE-RESERVE-X.
 12883
 12884     PERFORM 8600-SETUP-DETAIL-LINE THRU 8689-SETUP-DETAIL-X.
 12885     MOVE RW-ACCUM-IBNR             TO TRD-IBNR.
 12886     MOVE 'IBNR'                    TO TRD-IBNRX.
 12887     MOVE RW-ACCUM-PAYCUR           TO TRD-PAYCUR.
 12888     MOVE 'PAY CURR'                TO TRD-PAYCURX.
 12889     MOVE RW-ACCUM-FUTRSV           TO TRD-FUTRSV.
 12890     MOVE 'FUTURE'                  TO TRD-FUTRSVX.
 12891
 12892     IF PC-CLAIM-TYPE = 1
 12893         MOVE LIFE-OVERRIDE-L6      TO TRD-RSV-DESC
 12894     ELSE
 12895         MOVE AH-OVERRIDE-L6        TO TRD-RSV-DESC.
 12896     MOVE ' REIN. CLAIM RESERVES'   TO TRD-RSV-ACTION.
 12897
 12898     PERFORM 8690-PRINT-DETAIL-LINE THRU 8699-PRT-DETAIL-X.
 12899
 12900 3499-REINSURE-RESERVE-X.
 12901     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 252
* ECS010P.cbl
 12903******************************************************************
 12904***        C A L C U L A T E   R E I N   R E S E R V E S       ***
 12905******************************************************************
 12906
 12907 3500-REINSURE-CALC-RESERVE.
 12908
 12909     MOVE REIN-WORK-FLDS (SUB1) TO RWF-FIELDS.
 12910     MOVE +0 TO RWF-DTH-IBNRL RWF-DTH-PAYCURL  RWF-DTH-FUTRSVL
 12911                RWF-DIS-IBNRL  RWF-DIS-PAYCURL  RWF-DIS-FUTRSVL.
 12912
 12913     PERFORM REIN-FIND-CO-LOOP THRU FIND-REI-CO-EXIT
 12914        VARYING CO-SUB FROM 1 BY 1 UNTIL
 12915          (RCT-REIN-CO (CO-SUB) = REIN-COMP (SUB1))
 12916       OR (CO-SUB GREATER REIN-CO-TABLE-ENT-CNT).
 12917
 12918     IF CO-SUB GREATER REIN-CO-TABLE-ENT-CNT
 12919        MOVE ZERO TO CO-SUB.
 12920
 12921     IF CO-SUB NOT = ZERO
 12922        IF RCT-CLM-CUTOFF-DT (CO-SUB) NOT = ZERO
 12923           IF PC-CLAIM-TYPE = '1' OR '3'
 12924             IF CR-DTH-DT LESS THAN RCT-CLM-CUTOFF-DT (CO-SUB)
 12925                 GO TO 3540-CONT-REIN-CALC-RESERVE.
 12926
 12927     IF PC-CLAIM-TYPE  = 1 OR 3
 12928         IF RWF-LF-RUNOFF-SW = 'N'
 12929           IF CR-DTH-DT NOT LESS THAN RWF-EP-STOP-DATE
 12930               GO TO 3540-CONT-REIN-CALC-RESERVE.
 12931
 12932     IF CO-SUB NOT = ZERO
 12933        IF RCT-CLM-CUTOFF-DT (CO-SUB) NOT = ZERO
 12934           IF PC-CLAIM-TYPE = '2' OR '4'
 12935             IF CR-DIS-DT LESS THAN RCT-CLM-CUTOFF-DT (CO-SUB)
 12936                 GO TO 3540-CONT-REIN-CALC-RESERVE.
 12937
 12938     IF PC-CLAIM-TYPE  = 2 OR 4
 12939         IF RWF-AH-RUNOFF-SW = 'N'
 12940           IF CR-DIS-DT NOT LESS THAN RWF-EP-STOP-DATE
 12941               GO TO 3540-CONT-REIN-CALC-RESERVE.
 12942
 12943     IF DTE-CLIENT NOT = 'MIC'
 12944         GO TO 3505-REIN-CALC-RESERVE-CONT.
 12945
 12946     IF PC-CLAIM-TYPE = '1'  OR  '3'
 12947         GO TO 3505-REIN-CALC-RESERVE-CONT.
 12948
 12949     MOVE PC-FUTURE-RESERVE-AMT        TO RW-AHFUTRSVWK.
 12950
 12951     IF CR-AHTYP = ZERO  OR
 12952        CO-SUB = ZERO
 12953         GO TO 3505-REIN-CALC-RESERVE-CONT
 12954     ELSE
 12955         IF RCT-AH-CLM-MAX (CO-SUB) = ZERO
 12956             GO TO 3505-REIN-CALC-RESERVE-CONT.
 12957
 12958     COMPUTE MAX-REM-TERM ROUNDED =
 12959                         RCT-AH-CLM-MAX (CO-SUB) / CR-AHAMT.
 12960
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 253
* ECS010P.cbl
 12961     IF MAX-REM-TERM NOT LESS THAN CP-REMAINING-TERM
 12962         GO TO 3505-REIN-CALC-RESERVE-CONT.
 12963
 12964     COMPUTE CP-ORIGINAL-TERM =
 12965                 CR-AH-TERM - CP-REMAINING-TERM + MAX-REM-TERM.
 12966
 12967     CALL 'ELRESVX' USING CALCULATION-PASS-AREA.
 12968
 12969     IF  CP-RETURN-CODE = ZERO
 12970         MOVE CP-FUTURE-RESERVE    TO RW-AHFUTRSVWK.
 12971
 12972 3505-REIN-CALC-RESERVE-CONT.
 12973
 12974     IF SUB1 = RE-100-COMP
 12975         GO TO 3520-REIN-REMAINDER-RSRV.
 12976
 12977     IF CR-LFAMT NOT = ZERO  AND
 12978        RWF-LFAMT NOT = ZERO
 12979         IF DTE-CLIENT NOT = 'MIC'
 12980             COMPUTE RWF-DTH-IBNRL = (RW-LFIBNRWK *
 12981                         RWF-LFAMT) / (CR-LFAMT + CR-LFAMT-ALT)
 12982             COMPUTE RWF-DTH-PAYCURL = (RW-LFPAYCURWK *
 12983                         RWF-LFAMT) / (CR-LFAMT + CR-LFAMT-ALT)
 12984             COMPUTE RWF-DTH-FUTRSVL = (RW-LFFUTRSVWK *
 12985                         RWF-LFAMT) / (CR-LFAMT + CR-LFAMT-ALT)
 12986         ELSE
 12987             MOVE RW-LFIBNRWK         TO RWF-DTH-IBNRL
 12988             MOVE RW-LFPAYCURWK       TO RWF-DTH-PAYCURL
 12989             MOVE RW-LFFUTRSVWK       TO RWF-DTH-FUTRSVL.
 12990
 12991     IF CR-AHAMT NOT = ZERO  AND
 12992        RWF-AHAMT NOT = ZERO
 12993         IF DTE-CLIENT NOT = 'MIC'
 12994             COMPUTE RWF-DIS-IBNRL = (RW-AHIBNRWK *
 12995                         RWF-AHAMT) / CR-AHAMT
 12996             COMPUTE RWF-DIS-PAYCURL = (RW-AHPAYCURWK *
 12997                         RWF-AHAMT) / CR-AHAMT
 12998             COMPUTE RWF-DIS-FUTRSVL = (RW-AHFUTRSVWK *
 12999                         RWF-AHAMT) / CR-AHAMT
 13000         ELSE
 13001             MOVE RW-AHIBNRWK         TO RWF-DIS-IBNRL
 13002             MOVE RW-AHPAYCURWK       TO RWF-DIS-PAYCURL
 13003             MOVE RW-AHFUTRSVWK       TO RWF-DIS-FUTRSVL.
 13004
 13005 3510-REINSURE-CALC-RESERVE-ADD.
 13006
 13007     ADD RWF-DTH-IBNRL   TO RWF-DTH-IBNR.
 13008     ADD RWF-DTH-PAYCURL TO RWF-DTH-PAYCUR.
 13009     ADD RWF-DTH-FUTRSVL TO RWF-DTH-FUTRSV.
 13010     ADD RWF-DIS-IBNRL   TO RWF-DIS-IBNR.
 13011     ADD RWF-DIS-PAYCURL TO RWF-DIS-PAYCUR.
 13012     ADD RWF-DIS-FUTRSVL TO RWF-DIS-FUTRSV.
 13013
 13014     IF DTE-CLIENT NOT = 'MIC'  AND  'MCC'
 13015         GO TO 3519-REINSURE-CALC-RESERVE-END.
 13016
 13017     IF CO-SUB = ZERO
 13018         GO TO 3519-REINSURE-CALC-RESERVE-END.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 254
* ECS010P.cbl
 13019
 13020 3513-REIN-CHK-LF-RSRV-LIMIT.
 13021     IF RCT-LF-CLM-MAX (CO-SUB) = ZERO
 13022         GO TO 3515-REIN-CHK-AH-RSRV-LIMIT.
 13023
 13024     IF RWF-DTH-IBNR GREATER THAN RCT-LF-CLM-MAX (CO-SUB)
 13025         MOVE RCT-LF-CLM-MAX (CO-SUB) TO RWF-DTH-IBNR.
 13026
 13027     COMPUTE EXCESS-RESERVE = RCT-LF-CLM-MAX (CO-SUB) -
 13028                                      (RWF-LFCLM +
 13029                                       RWF-DTH-PAYCUR +
 13030                                       RWF-DTH-FUTRSV).
 13031
 13032     IF EXCESS-RESERVE NOT LESS THAN ZERO
 13033         GO TO 3515-REIN-CHK-AH-RSRV-LIMIT.
 13034
 13035     ADD EXCESS-RESERVE TO RWF-DTH-PAYCURL.
 13036
 13037     IF RWF-DTH-PAYCURL LESS THAN ZERO
 13038         ADD RWF-DTH-PAYCURL TO RWF-DTH-FUTRSVL
 13039         MOVE ZEROS TO RWF-DTH-PAYCURL.
 13040     IF RWF-DTH-FUTRSVL LESS THAN ZERO
 13041         MOVE ZEROS TO RWF-DTH-FUTRSVL.
 13042
 13043     ADD EXCESS-RESERVE TO RWF-DTH-PAYCUR.
 13044
 13045     IF RWF-DTH-PAYCUR LESS THAN ZERO
 13046         ADD RWF-DTH-PAYCUR TO RWF-DTH-FUTRSV
 13047         MOVE ZEROS TO RWF-DTH-PAYCUR.
 13048     IF RWF-DTH-FUTRSV LESS THAN ZERO
 13049         MOVE ZEROS TO RWF-DTH-FUTRSV.
 13050
 13051 3515-REIN-CHK-AH-RSRV-LIMIT.
 13052     IF RCT-AH-CLM-MAX (CO-SUB) = ZERO
 13053         GO TO 3519-REINSURE-CALC-RESERVE-END.
 13054
 13055     IF RWF-DIS-IBNR GREATER THAN RCT-AH-CLM-MAX (CO-SUB)
 13056         MOVE RCT-AH-CLM-MAX (CO-SUB) TO RWF-DIS-IBNR.
 13057
 13058     COMPUTE EXCESS-RESERVE = RCT-AH-CLM-MAX (CO-SUB) -
 13059                                      (RWF-AHCLM +
 13060                                       RWF-DIS-PAYCUR +
 13061                                       RWF-DIS-FUTRSV).
 13062
 13063     IF EXCESS-RESERVE NOT LESS THAN ZERO
 13064         GO TO 3519-REINSURE-CALC-RESERVE-END.
 13065
 13066     ADD EXCESS-RESERVE TO RWF-DIS-PAYCURL.
 13067
 13068     IF RWF-DIS-PAYCURL LESS THAN ZERO
 13069         ADD RWF-DIS-PAYCURL TO RWF-DIS-FUTRSVL
 13070         MOVE ZEROS TO RWF-DIS-PAYCURL.
 13071     IF RWF-DIS-FUTRSVL LESS THAN ZERO
 13072         MOVE ZEROS TO RWF-DIS-FUTRSVL.
 13073
 13074     ADD EXCESS-RESERVE TO RWF-DIS-PAYCUR.
 13075
 13076     IF RWF-DIS-PAYCUR LESS THAN ZERO
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 255
* ECS010P.cbl
 13077         ADD RWF-DIS-PAYCUR TO RWF-DIS-FUTRSV
 13078         MOVE ZEROS TO RWF-DIS-PAYCUR.
 13079     IF RWF-DIS-FUTRSV LESS THAN ZERO
 13080         MOVE ZEROS TO RWF-DIS-FUTRSV.
 13081
 13082 3519-REINSURE-CALC-RESERVE-END.
 13083
 13084     IF +0 NOT = RWF-DTH-IBNR OR RWF-DTH-PAYCUR
 13085        OR RWF-DTH-FUTRSV
 13086         MOVE 'X' TO REIN-LF-FLG (SUB1).
 13087
 13088     IF +0 NOT = RWF-DIS-IBNR OR RWF-DIS-PAYCUR
 13089        OR RWF-DIS-FUTRSV
 13090         MOVE 'X' TO REIN-AH-FLG (SUB1).
 13091
 13092     GO TO 3540-CONT-REIN-CALC-RESERVE.
 13093
 13094 3520-REIN-REMAINDER-RSRV.
 13095
 13096     MOVE RW-LFIBNRWK   TO RWF-DTH-IBNRL.
 13097     MOVE RW-LFPAYCURWK TO RWF-DTH-PAYCURL.
 13098     MOVE RW-LFFUTRSVWK TO RWF-DTH-FUTRSVL.
 13099     MOVE RW-AHIBNRWK   TO RWF-DIS-IBNRL.
 13100     MOVE RW-AHPAYCURWK TO RWF-DIS-PAYCURL.
 13101     MOVE RW-AHFUTRSVWK TO RWF-DIS-FUTRSVL.
 13102
 13103     PERFORM 3530-REIN-SUB-RSRV
 13104         THRU 3539-REIN-SUB-RSRV-X
 13105             VARYING SUB2 FROM +1 BY +1 UNTIL SUB2 = SUB1.
 13106
 13107     GO TO 3510-REINSURE-CALC-RESERVE-ADD.
 13108
 13109 3530-REIN-SUB-RSRV.
 13110
 13111     SUBTRACT REIN-DTH-IBNRL (SUB2)   FROM RWF-DTH-IBNRL.
 13112     SUBTRACT REIN-DTH-PAYCURL (SUB2) FROM RWF-DTH-PAYCURL.
 13113     SUBTRACT REIN-DTH-FUTRSVL (SUB2) FROM RWF-DTH-FUTRSVL.
 13114     SUBTRACT REIN-DIS-IBNRL (SUB2)   FROM RWF-DIS-IBNRL.
 13115     SUBTRACT REIN-DIS-PAYCURL (SUB2) FROM RWF-DIS-PAYCURL.
 13116     SUBTRACT REIN-DIS-FUTRSVL (SUB2) FROM RWF-DIS-FUTRSVL.
 13117
 13118 3539-REIN-SUB-RSRV-X.
 13119     EXIT.
 13120
 13121 3540-CONT-REIN-CALC-RESERVE.
 13122
 13123     IF REIN-LF-AH-FLGS (SUB1) NOT = SPACES
 13124         MOVE 'X' TO REIN-BUS-FLAG.
 13125     MOVE RWF-FIELDS TO REIN-WORK-FLDS (SUB1).
 13126
 13127 3599-REINSURE-CALC-RESERVE-X.
 13128     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 256
* ECS010P.cbl
 13130******************************************************************
 13131***       R E I N S U R A N C E   C A L C U L A T I O N S      ***
 13132******************************************************************
 13133
 13134*REINSURANCE-CALCULATIONS.
*13135                             COPY ECSRIRTN.
 13136******************************************************************04/30/98
 13137*                                                                *ECSRIRTN
 13138*                            ECSRIRTN                            *   LV012
 13139*                            VMOD=2.025.                         *ECSRIRTN
 13140*                                                                *ECSRIRTN
 13141******************************************************************ECSRIRTN
 13142******************************************************************
 13143*                   C H A N G E   L O G
 13144*
 13145* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
 13146*-----------------------------------------------------------------
 13147*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
 13148* EFFECTIVE    NUMBER
 13149*-----------------------------------------------------------------
 13150* 062703                   PEMA  ADD DCC CLIENT ID TO
 13151*                                SPECIAL CEDED CLAIM CALC
 13152* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
 13153* 052114  CR2014051900001  PEMA  ADD ROUNDING TO PREM TAX CALC
 13154                                                                  ECSRIRTN
 13155 REINSURE-CALC.                                                   ECSRIRTN
 13156                                                                  ECSRIRTN
 13157     MOVE RE-REI-COMP-NO (SUB1) TO REIN-COMP (SUB1).              ECSRIRTN
 13158     MOVE REIN-WORK-FLDS (SUB1) TO RWF-FIELDS.                    ECSRIRTN
 13159     MOVE RE-COMP-INFO (SUB1)   TO WT-COMP-INFO.                  ECSRIRTN
 13160     MOVE WT-REMAINING          TO RWF-REM-SW                     ECSRIRTN
 13161                                   REIN-REM-SW (SUB1).            ECSRIRTN
 13162                                                                  ECSRIRTN
 13163     MOVE ZEROS                 TO RWF-EP-STOP-DATE               ECSRIRTN
 13164                                   WS-RWF-EP-STOP-DATE-N             CL*12
 13165                                   REIN-EP-STOP-DATE (SUB1).      ECSRIRTN
 13166                                                                  ECSRIRTN
 13167     MOVE 'Y'                   TO RWF-LF-RUNOFF-SW               ECSRIRTN
 13168                                   REIN-LF-RUNOFF-SW (SUB1)       ECSRIRTN
 13169                                   RWF-AH-RUNOFF-SW               ECSRIRTN
 13170                                   REIN-AH-RUNOFF-SW (SUB1).      ECSRIRTN
 13171                                                                  ECSRIRTN
 13172     PERFORM REIN-FIND-CO-LOOP THRU FIND-REI-CO-EXIT              ECSRIRTN
 13173        VARYING CO-SUB FROM 1 BY 1 UNTIL                          ECSRIRTN
 13174          (RCT-REIN-CO (CO-SUB) = REIN-COMP (SUB1))  OR           ECSRIRTN
 13175          (CO-SUB GREATER REIN-CO-TABLE-ENT-CNT)     OR           ECSRIRTN
 13176          (RCT-REIN-CO (CO-SUB) = SPACES).                        ECSRIRTN
 13177                                                                  ECSRIRTN
 13178     IF (CO-SUB GREATER REIN-CO-TABLE-ENT-CNT)  OR                ECSRIRTN
 13179        (RCT-REIN-CO (CO-SUB) = SPACES)                           ECSRIRTN
 13180         GO TO CALC-CONTINUED.                                    ECSRIRTN
 13181                                                                  ECSRIRTN
 13182     MOVE RCT-EARNING-STOP-DT (CO-SUB) TO RWF-EP-STOP-DATE        ECSRIRTN
 13183                                          WS-RWF-EP-STOP-DATE-N      CL*12
 13184                                          REIN-EP-STOP-DATE (SUB1)ECSRIRTN
 13185                                                                  ECSRIRTN
 13186     IF RWF-EP-STOP-DATE = ZEROS                                  ECSRIRTN
 13187         GO TO CALC-CONTINUED.                                    ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 257
* ECS010P.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 13188                                                                  ECSRIRTN
 13189     IF RCT-EARN-STOP-CODE (CO-SUB) = 'L'  OR  'B'                ECSRIRTN
 13190         MOVE 'N'               TO RWF-LF-RUNOFF-SW               ECSRIRTN
 13191                                   REIN-LF-RUNOFF-SW (SUB1).      ECSRIRTN
 13192                                                                  ECSRIRTN
 13193     IF RCT-EARN-STOP-CODE (CO-SUB) = 'A'  OR  'B'                ECSRIRTN
 13194         MOVE 'N'               TO RWF-AH-RUNOFF-SW               ECSRIRTN
 13195                                   REIN-AH-RUNOFF-SW (SUB1).      ECSRIRTN
 13196                                                                  ECSRIRTN
 13197 CALC-CONTINUED.                                                  ECSRIRTN
 13198                                                                  ECSRIRTN
 13199     COMPUTE RS-LIFE-BEN  = CR-LFAMT + CR-LFAMT-ALT.              ECSRIRTN
 13200     COMPUTE RS-LIFE-PREM = CR-LFPRM + CR-LFPRM-ALT.              ECSRIRTN
 13201                                                                  ECSRIRTN
 13202     IF RE-NSP-ST-CD-LF = ZEROS  OR  SPACES                       ECSRIRTN
 13203         COMPUTE RS-LP-CALC = CR-LFPRM-CALC + CR-LFPRM-CALC-ALT   ECSRIRTN
 13204     ELSE                                                         ECSRIRTN
 13205         MOVE CR-LF-NSP-PRM         TO RS-LP-CALC.                ECSRIRTN
 13206     MOVE RS-LP-CALC                TO REIN-CALCED-LIFE.          ECSRIRTN
 13207                                                                  ECSRIRTN
 13208     MOVE CR-AHAMT                  TO RS-AH-BEN.                 ECSRIRTN
 13209     MOVE CR-AHPRM                  TO RS-AH-PREM.                ECSRIRTN
 13210     IF RE-NSP-ST-CD-AH = ZEROS  OR  SPACES                       ECSRIRTN
 13211         MOVE CR-AHPRM-CALC         TO RS-AP-CALC                 ECSRIRTN
 13212     ELSE                                                         ECSRIRTN
 13213         MOVE CR-AH-NSP-PRM         TO RS-AP-CALC.                ECSRIRTN
 13214     MOVE RS-AP-CALC                TO REIN-CALCED-AH.            ECSRIRTN
 13215                                                                  ECSRIRTN
 13216     IF WT-REMAINING = 'Y' OR 'Z' OR 'L' OR 'R'                   ECSRIRTN
 13217         MOVE RS-R-LB               TO RS-LIFE-BEN                ECSRIRTN
 13218         MOVE RS-R-LP               TO RS-LIFE-PREM               ECSRIRTN
 13219         MOVE RS-R-LPC              TO RS-LP-CALC                 ECSRIRTN
 13220         MOVE RS-R-AB               TO RS-AH-BEN                  ECSRIRTN
 13221         MOVE RS-R-AP               TO RS-AH-PREM                 ECSRIRTN
 13222         MOVE RS-R-APC              TO RS-AP-CALC.                ECSRIRTN
 13223                                                                  ECSRIRTN
 13224     IF SUB1 = RE-100-COMP                                        ECSRIRTN
 13225         GO TO REINSURE-CALC-REMAINDER.                           ECSRIRTN
 13226                                                                  ECSRIRTN
 13227     IF CR-DT LESS WT-LO-DATE                                        CL**2
 13228         GO TO REINSURE-CALC-X.                                   ECSRIRTN
 13229                                                                  ECSRIRTN
 13230     IF CR-DT NOT LESS WT-HI-DATE                                    CL**2
 13231         GO TO REINSURE-CALC-X.                                   ECSRIRTN
 13232                                                                  ECSRIRTN
 13233     PERFORM REINSURE-CK-LIFE      THRU REINSURE-CK-LIFE-X.       ECSRIRTN
 13234     PERFORM REINSURE-CK-AH        THRU REINSURE-CK-AH-X.         ECSRIRTN
 13235                                                                  ECSRIRTN
 13236     IF WT-INTERACTIVE = 'E'                                      ECSRIRTN
 13237         PERFORM REIN-CHECK-INTERACT-E THRU REIN-INTERACT-CHECK-X.ECSRIRTN
 13238                                                                  ECSRIRTN
 13239     IF WT-INTERACTIVE = 'X'                                      ECSRIRTN
 13240       IF  (REIN-LF-FLG (SUB1) = 'X' AND REIN-AH-FLG (SUB1) = 'X')ECSRIRTN
 13241        OR (REIN-LF-FLG (SUB1) = 'X' AND REIN-AH-FLG (SUB1) = ' ')ECSRIRTN
 13242        OR (REIN-LF-FLG (SUB1) = ' ' AND REIN-AH-FLG (SUB1) = 'X')ECSRIRTN
 13243           NEXT SENTENCE                                          ECSRIRTN
 13244       ELSE                                                       ECSRIRTN
 13245           MOVE 'Y' TO REIN-LF-FLG (SUB1)                         ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 258
* ECS010P.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 13246                       REIN-AH-FLG (SUB1).                        ECSRIRTN
 13247                                                                  ECSRIRTN
 13248     IF WT-INTERACTIVE = 'Y'                                      ECSRIRTN
 13249         IF REIN-LF-FLG (SUB1) = 'X' AND                          ECSRIRTN
 13250            REIN-AH-FLG (SUB1) = 'Y'                              ECSRIRTN
 13251             MOVE 'X' TO REIN-AH-FLG (SUB1).                      ECSRIRTN
 13252                                                                  ECSRIRTN
 13253     IF WT-INTERACTIVE = 'Y'                                      ECSRIRTN
 13254         IF REIN-AH-FLG (SUB1) = 'X' AND                          ECSRIRTN
 13255            REIN-LF-FLG (SUB1) = 'Y'                              ECSRIRTN
 13256             MOVE 'X' TO REIN-LF-FLG (SUB1).                      ECSRIRTN
 13257                                                                  ECSRIRTN
 13258     IF WT-INTERACTIVE = 'Z'                                      ECSRIRTN
 13259         IF REIN-LF-FLG (SUB1) = 'X'                              ECSRIRTN
 13260             IF REIN-AH-FLG (SUB1) = 'Y'                          ECSRIRTN
 13261                 MOVE 'X' TO REIN-AH-FLG (SUB1)                   ECSRIRTN
 13262             ELSE                                                 ECSRIRTN
 13263                 NEXT SENTENCE                                    ECSRIRTN
 13264         ELSE                                                     ECSRIRTN
 13265             MOVE 'Y' TO REIN-LF-FLG (SUB1)                       ECSRIRTN
 13266                         REIN-AH-FLG (SUB1).                      ECSRIRTN
 13267                                                                  ECSRIRTN
 13268     IF WT-INTERACTIVE = 'W'                                      ECSRIRTN
 13269         IF REIN-AH-FLG (SUB1) = 'X'                              ECSRIRTN
 13270             IF REIN-LF-FLG (SUB1) = 'Y'                          ECSRIRTN
 13271                 MOVE 'X' TO REIN-LF-FLG (SUB1)                   ECSRIRTN
 13272             ELSE                                                 ECSRIRTN
 13273                 NEXT SENTENCE                                    ECSRIRTN
 13274         ELSE                                                     ECSRIRTN
 13275             MOVE 'Y' TO REIN-LF-FLG (SUB1)                       ECSRIRTN
 13276                         REIN-AH-FLG (SUB1).                      ECSRIRTN
 13277                                                                  ECSRIRTN
 13278     IF REIN-LF-FLG (SUB1) = 'X'                                  ECSRIRTN
 13279         PERFORM REIN-CALC-LIFE THRU REIN-CALC-LIFE-X.            ECSRIRTN
 13280                                                                  ECSRIRTN
 13281     IF REIN-LF-FLG (SUB1) = 'E'                                  ECSRIRTN
 13282         PERFORM REIN-LF-SKIP-LIMIT THRU REIN-CALC-LIFE-X         ECSRIRTN
 13283         MOVE 'X' TO REIN-LF-FLG (SUB1).                          ECSRIRTN
 13284                                                                  ECSRIRTN
 13285     IF REIN-AH-FLG (SUB1) = 'X'                                  ECSRIRTN
 13286         PERFORM REIN-CALC-AH THRU REIN-CALC-AH-X.                ECSRIRTN
 13287                                                                  ECSRIRTN
 13288     IF REIN-AH-FLG (SUB1) = 'E'                                  ECSRIRTN
 13289         PERFORM REIN-AH-SKIP-LIMIT THRU REIN-CALC-AH-X           ECSRIRTN
 13290         MOVE 'X'                TO  REIN-AH-FLG (SUB1).          ECSRIRTN
 13291                                                                  ECSRIRTN
 13292     IF REIN-LF-FLG (SUB1) NOT = 'X'                              ECSRIRTN
 13293         MOVE SPACE TO REIN-LF-FLG (SUB1).                        ECSRIRTN
 13294                                                                  ECSRIRTN
 13295     IF REIN-AH-FLG (SUB1) NOT = 'X'                              ECSRIRTN
 13296         MOVE SPACE TO REIN-AH-FLG (SUB1).                        ECSRIRTN
 13297                                                                  ECSRIRTN
 13298     GO TO REINSURE-CALC-X.                                       ECSRIRTN
 13299                                                                  ECSRIRTN
 13300 REINSURE-CK-LIFE.                                                ECSRIRTN
 13301                                                                  ECSRIRTN
 13302     IF CR-LFTYP = ZERO                                           ECSRIRTN
 13303         GO TO REINSURE-CK-LIFE-X.                                ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 259
* ECS010P.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 13304                                                                  ECSRIRTN
 13305     IF WT-LF-PCT = ZERO                                          ECSRIRTN
 13306         GO TO REINSURE-CK-LIFE-X.                                ECSRIRTN
 13307                                                                  ECSRIRTN
 13308     IF DTE-CLIENT = 'CSO' OR 'CSI'                               ECSRIRTN
 13309         IF CLAS-I-REIN-YN (CLAS-INDEXL) = 'N'                    ECSRIRTN
 13310             GO TO REINSURE-CK-LIFE-X.                            ECSRIRTN
 13311                                                                  ECSRIRTN
 13312     MOVE WT-LF-BEN-CODE                TO REIN-BEN-CODE.         ECSRIRTN
 13313                                                                  ECSRIRTN
 13314     IF CEDING-PROPERTY-ONLY                                      ECSRIRTN
 13315         IF CLAS-I-CALC-TYPE (CLAS-INDEXL) NOT = '2'              ECSRIRTN
 13316             GO TO REINSURE-CK-LIFE-X                             ECSRIRTN
 13317         ELSE                                                     ECSRIRTN
 13318             NEXT SENTENCE                                        ECSRIRTN
 13319     ELSE                                                         ECSRIRTN
 13320         IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = '2'                  ECSRIRTN
 13321             GO TO REINSURE-CK-LIFE-X.                            ECSRIRTN
 13322                                                                  ECSRIRTN
 13323     IF CEDING-AD-D-ONLY                                          ECSRIRTN
 13324         IF CLAS-I-CALC-TYPE (CLAS-INDEXL) NOT = '4'              ECSRIRTN
 13325             GO TO REINSURE-CK-LIFE-X                             ECSRIRTN
 13326         ELSE                                                     ECSRIRTN
 13327             NEXT SENTENCE                                        ECSRIRTN
 13328     ELSE                                                         ECSRIRTN
 13329         IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = '4'                  ECSRIRTN
 13330             GO TO REINSURE-CK-LIFE-X.                            ECSRIRTN
 13331                                                                  ECSRIRTN
 13332     IF CEDING-SINGLE-PREM-ONLY                                   ECSRIRTN
 13333         IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'B'                  ECSRIRTN
 13334             GO TO REINSURE-CK-LIFE-X.                            ECSRIRTN
 13335                                                                  ECSRIRTN
 13336     IF CEDING-OUT-BALANCE-ONLY                                   ECSRIRTN
 13337         IF CLAS-I-CALC-TYPE (CLAS-INDEXL) NOT = 'B'              ECSRIRTN
 13338            GO TO REINSURE-CK-LIFE-X.                             ECSRIRTN
 13339                                                                  ECSRIRTN
 13340     IF CEDING-REDUCING-ONLY                                      ECSRIRTN
 13341         IF CLAS-I-RL-AH (CLAS-INDEXL) = 'L' OR 'P'               ECSRIRTN
 13342             GO TO REINSURE-CK-LIFE-X.                            ECSRIRTN
 13343                                                                  ECSRIRTN
 13344     IF CEDING-LEVEL-ONLY                                         ECSRIRTN
 13345         IF CLAS-I-RL-AH (CLAS-INDEXL) = 'R'                      ECSRIRTN
 13346            GO TO REINSURE-CK-LIFE-X.                             ECSRIRTN
 13347                                                                  ECSRIRTN
 13348     IF CEDING-GROUP-ONLY                                         ECSRIRTN
 13349         IF CR-IND-GRP NOT = '2'                                  ECSRIRTN
 13350             GO TO REINSURE-CK-LIFE-X.                            ECSRIRTN
 13351                                                                  ECSRIRTN
 13352     IF CEDING-GROUP-RED-LIFE-ONLY                                ECSRIRTN
 13353         IF (CR-IND-GRP = '1')  OR                                ECSRIRTN
 13354            (CLAS-I-RL-AH (CLAS-INDEXL) = 'L' OR 'P') OR          ECSRIRTN
 13355            (CR-AHTYP NOT = ZERO)                                 ECSRIRTN
 13356             GO TO REINSURE-CK-LIFE-X.                            ECSRIRTN
 13357                                                                  ECSRIRTN
 13358     IF CEDING-GROUP-REDUCING-ONLY                                ECSRIRTN
 13359         IF (CR-IND-GRP = '1')  OR                                ECSRIRTN
 13360            (CLAS-I-RL-AH (CLAS-INDEXL) = 'L' OR 'P')             ECSRIRTN
 13361             GO TO REINSURE-CK-LIFE-X.                            ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 260
* ECS010P.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 13362                                                                  ECSRIRTN
 13363     IF CEDING-INDIVIDUAL-ONLY                                    ECSRIRTN
 13364         IF CR-IND-GRP NOT = '1'                                  ECSRIRTN
 13365             GO TO REINSURE-CK-LIFE-X.                            ECSRIRTN
 13366                                                                  ECSRIRTN
 13367     IF CEDING-JOINT-ONLY                                         ECSRIRTN
 13368         IF CLAS-I-JOINT (CLAS-INDEXL) NOT = 'J'                  ECSRIRTN
 13369             GO TO REINSURE-CK-LIFE-X.                            ECSRIRTN
 13370                                                                  ECSRIRTN
 13371     IF CEDING-SGL-PREM-REDUCING                                  ECSRIRTN
 13372        IF (CLAS-I-RL-AH (CLAS-INDEXL) = 'L' OR 'P')  OR          ECSRIRTN
 13373           CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'B'                   ECSRIRTN
 13374            GO TO REINSURE-CK-LIFE-X.                             ECSRIRTN
 13375                                                                  ECSRIRTN
 13376     IF CEDING-SGL-PREM-GROUP                                     ECSRIRTN
 13377         IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'B'  OR              ECSRIRTN
 13378            CR-IND-GRP = '1'                                      ECSRIRTN
 13379             GO TO REINSURE-CK-LIFE-X.                            ECSRIRTN
 13380                                                                  ECSRIRTN
 13381     IF CEDING-GROUP-LEVEL-ONLY                                   ECSRIRTN
 13382         IF CLAS-I-RL-AH (CLAS-INDEXL) = 'R'  OR                  ECSRIRTN
 13383            CR-IND-GRP = '1'                                      ECSRIRTN
 13384             GO TO REINSURE-CK-LIFE-X.                            ECSRIRTN
 13385                                                                  ECSRIRTN
 13386     IF CEDING-SGL-PREM-GRP-REDUCING                              ECSRIRTN
 13387         IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'B'  OR              ECSRIRTN
 13388            (CLAS-I-RL-AH (CLAS-INDEXL) = 'L' OR 'P')  OR         ECSRIRTN
 13389            CR-IND-GRP = '1'                                      ECSRIRTN
 13390             GO TO REINSURE-CK-LIFE-X.                            ECSRIRTN
 13391                                                                  ECSRIRTN
 13392     IF CEDING-SGL-PREM-GROUP-LEVEL                               ECSRIRTN
 13393         IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'B'  OR              ECSRIRTN
 13394            CLAS-I-RL-AH (CLAS-INDEXL) = 'R'  OR                  ECSRIRTN
 13395            CR-IND-GRP = '1'                                      ECSRIRTN
 13396             GO TO REINSURE-CK-LIFE-X.                            ECSRIRTN
 13397                                                                  ECSRIRTN
 13398     IF CEDING-SINGLE-POLICIES-ONLY                               ECSRIRTN
 13399         IF CLAS-I-JOINT (CLAS-INDEXL) = 'J'                      ECSRIRTN
 13400            GO TO REINSURE-CK-LIFE-X.                             ECSRIRTN
 13401                                                                  ECSRIRTN
 13402     IF DTE-CLIENT EQUAL 'NCL'                                    ECSRIRTN
 13403        MOVE 'Y'                 TO REIN-LF-FLG (SUB1).           ECSRIRTN
 13404                                                                  ECSRIRTN
 13405     IF CR-AGE LESS WT-LFAGE-LO                                   ECSRIRTN
 13406         GO TO REINSURE-CK-LIFE-X.                                ECSRIRTN
 13407                                                                  ECSRIRTN
 13408     IF CR-AGE GREATER WT-LFAGE-HI                                ECSRIRTN
 13409         GO TO REINSURE-CK-LIFE-X.                                ECSRIRTN
 13410                                                                  ECSRIRTN
 13411     IF CR-LF-TERM  NUMERIC                                       00002331
 13412        NEXT SENTENCE                                             00002332
 13413     ELSE                                                         00002333
 13414        MOVE ZEROS               TO CR-LF-TERM                    00002334
 13415     END-IF
 13416                                                                  00002335
 13417     IF CR-LF-TERM LESS WT-LFTRM-LO                               ECSRIRTN
 13418         GO TO REINSURE-CK-LIFE-X.                                ECSRIRTN
 13419                                                                  ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 261
* ECS010P.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 13420     IF CR-LF-TERM GREATER WT-LFTRM-HI                            ECSRIRTN
 13421         GO TO REINSURE-CK-LIFE-X.                                ECSRIRTN
 13422                                                                  ECSRIRTN
 13423     MOVE 'Y' TO REIN-LF-FLG (SUB1).                              ECSRIRTN
 13424                                                                  ECSRIRTN
 13425     IF RS-LIFE-BEN NOT GREATER WT-LF-LIM-LO                      ECSRIRTN
 13426         GO TO REINSURE-CK-LIFE-X.                                ECSRIRTN
 13427                                                                  ECSRIRTN
 13428     IF RS-LIFE-BEN GREATER WT-LF-LIM-HI                          ECSRIRTN
 13429         GO TO REINSURE-CK-LIFE-X.                                ECSRIRTN
 13430                                                                  ECSRIRTN
 13431     MOVE 'X' TO REIN-LF-FLG (SUB1).                              ECSRIRTN
 13432                                                                  ECSRIRTN
 13433 REINSURE-CK-LIFE-X.                                              ECSRIRTN
 13434     EXIT.                                                        ECSRIRTN
 13435                                                                  ECSRIRTN
 13436 REINSURE-CK-AH.                                                  ECSRIRTN
 13437                                                                  ECSRIRTN
 13438     IF CR-AHTYP = ZERO                                           ECSRIRTN
 13439         GO TO REINSURE-CK-AH-X.                                  ECSRIRTN
 13440                                                                  ECSRIRTN
 13441     IF WT-AH-PCT = ZERO                                          ECSRIRTN
 13442         GO TO REINSURE-CK-AH-X.                                  ECSRIRTN
 13443                                                                  ECSRIRTN
 13444     IF DTE-CLIENT = 'CSO' OR 'CSI'                               ECSRIRTN
 13445         IF CLAS-I-REIN-YN (CLAS-INDEXA) = 'N'                    ECSRIRTN
 13446             GO TO REINSURE-CK-AH-X.                              ECSRIRTN
 13447                                                                  ECSRIRTN
 13448     MOVE WT-AH-BEN-CODE                TO REIN-BEN-CODE.         ECSRIRTN
 13449                                                                  ECSRIRTN
 13450     IF CEDING-UNEMPLOYMENT-ONLY                                  ECSRIRTN
 13451         IF CLAS-I-CALC-TYPE (CLAS-INDEXA) NOT = '3'              ECSRIRTN
 13452             GO TO REINSURE-CK-AH-X                               ECSRIRTN
 13453         ELSE                                                     ECSRIRTN
 13454             NEXT SENTENCE                                        ECSRIRTN
 13455     ELSE                                                         ECSRIRTN
 13456         IF CLAS-I-CALC-TYPE (CLAS-INDEXA) = '3'                  ECSRIRTN
 13457             GO TO REINSURE-CK-AH-X.                              ECSRIRTN
 13458                                                                  ECSRIRTN
 13459     IF CEDING-SINGLE-PREM-ONLY                                   ECSRIRTN
 13460         IF CLAS-I-CALC-TYPE (CLAS-INDEXA) = 'B'                  ECSRIRTN
 13461             GO TO REINSURE-CK-AH-X.                              ECSRIRTN
 13462                                                                  ECSRIRTN
 13463     IF CEDING-JOINT-ONLY                                         ECSRIRTN
 13464         IF CLAS-I-JOINT (CLAS-INDEXA) NOT = 'J'                  ECSRIRTN
 13465             GO TO REINSURE-CK-AH-X.                              ECSRIRTN
 13466                                                                  ECSRIRTN
 13467     IF CEDING-OUT-BALANCE-ONLY                                   ECSRIRTN
 13468         IF CLAS-I-CALC-TYPE (CLAS-INDEXA) NOT = 'B'              ECSRIRTN
 13469             GO TO REINSURE-CK-AH-X.                              ECSRIRTN
 13470                                                                  ECSRIRTN
 13471     IF CEDING-GROUP-ONLY                                         ECSRIRTN
 13472         IF CR-IND-GRP NOT = '2'                                  ECSRIRTN
 13473             GO TO REINSURE-CK-AH-X.                              ECSRIRTN
 13474                                                                  ECSRIRTN
 13475     IF CEDING-SGL-PREM-GROUP                                     ECSRIRTN
 13476         IF CLAS-I-CALC-TYPE (CLAS-INDEXA) = 'B'  OR              ECSRIRTN
 13477            CR-IND-GRP = '1'                                      ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 262
* ECS010P.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 13478             GO TO REINSURE-CK-AH-X.                              ECSRIRTN
 13479                                                                  ECSRIRTN
 13480     IF CEDING-INDIVIDUAL-ONLY                                    ECSRIRTN
 13481         IF CR-IND-GRP NOT = '1'                                  ECSRIRTN
 13482             GO TO REINSURE-CK-AH-X.                              ECSRIRTN
 13483                                                                  ECSRIRTN
 13484     IF CEDING-SINGLE-POLICIES-ONLY                               ECSRIRTN
 13485         IF CLAS-I-JOINT (CLAS-INDEXA) = 'J'                      ECSRIRTN
 13486            GO TO REINSURE-CK-AH-X.                               ECSRIRTN
 13487                                                                  ECSRIRTN
 13488     IF CEDING-7-DAY-RETRO                                        ECSRIRTN
 13489         IF CLAS-I-AB3 (CLAS-INDEXA) NOT = (' 7R'  AND  '07R')    ECSRIRTN
 13490            GO TO REINSURE-CK-AH-X.                               ECSRIRTN
 13491                                                                  ECSRIRTN
 13492     IF CEDING-14-DAY-RETRO                                       ECSRIRTN
 13493         IF CLAS-I-AB3 (CLAS-INDEXA) NOT = '14R'                  ECSRIRTN
 13494             GO TO REINSURE-CK-AH-X.                              ECSRIRTN
 13495                                                                  ECSRIRTN
 13496     IF DTE-CLIENT EQUAL 'NCL'                                    ECSRIRTN
 13497        MOVE 'Y'                 TO REIN-AH-FLG (SUB1).           ECSRIRTN
 13498                                                                  ECSRIRTN
 13499     IF CR-AGE LESS WT-AHAGE-LO                                   ECSRIRTN
 13500         GO TO REINSURE-CK-AH-X.                                  ECSRIRTN
 13501                                                                  ECSRIRTN
 13502     IF CR-AGE GREATER WT-AHAGE-HI                                ECSRIRTN
 13503         GO TO REINSURE-CK-AH-X.                                  ECSRIRTN
 13504                                                                  ECSRIRTN
 13505     IF CR-AH-TERM  NUMERIC                                       00002331
 13506        NEXT SENTENCE                                             00002332
 13507     ELSE                                                         00002333
 13508        MOVE ZEROS               TO CR-AH-TERM                    00002334
 13509     END-IF
 13510                                                                  00002335
 13511     IF CR-AH-TERM LESS WT-AHTRM-LO                               ECSRIRTN
 13512         GO TO REINSURE-CK-AH-X.                                  ECSRIRTN
 13513                                                                  ECSRIRTN
 13514     IF CR-AH-TERM GREATER WT-AHTRM-HI                            ECSRIRTN
 13515         GO TO REINSURE-CK-AH-X.                                  ECSRIRTN
 13516                                                                  ECSRIRTN
 13517     MOVE 'Y' TO REIN-AH-FLG (SUB1).                              ECSRIRTN
 13518                                                                  ECSRIRTN
 13519     IF WT-AHBEN-LIM-LO = ZERO                                    ECSRIRTN
 13520         AND WT-AHBEN-LIM-HI = ZERO                               ECSRIRTN
 13521             MOVE +9999999.99 TO WT-AHBEN-LIM-LO                  ECSRIRTN
 13522                                 WT-AHBEN-LIM-HI.                 ECSRIRTN
 13523                                                                  ECSRIRTN
 13524     IF WT-AHMOA-LIM-LO = ZERO                                    ECSRIRTN
 13525         AND WT-AHMOA-LIM-HI = ZERO                               ECSRIRTN
 13526             MOVE +9999999.99 TO WT-AHMOA-LIM-LO                  ECSRIRTN
 13527                                 WT-AHMOA-LIM-HI.                 ECSRIRTN
 13528                                                                  ECSRIRTN
 13529     COMPUTE RW-AHLIM-LO = CR-AH-TERM * WT-AHMOA-LIM-LO.          ECSRIRTN
 13530     COMPUTE RW-AHLIM-HI = CR-AH-TERM * WT-AHMOA-LIM-HI.          ECSRIRTN
 13531                                                                  ECSRIRTN
 13532     IF RW-AHLIM-LO GREATER WT-AHBEN-LIM-LO                       ECSRIRTN
 13533         MOVE WT-AHBEN-LIM-LO TO RW-AHLIM-LO.                     ECSRIRTN
 13534                                                                  ECSRIRTN
 13535     IF RW-AHLIM-HI GREATER WT-AHBEN-LIM-HI                       ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 263
* ECS010P.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 13536         MOVE WT-AHBEN-LIM-HI TO RW-AHLIM-HI.                     ECSRIRTN
 13537                                                                  ECSRIRTN
 13538     MOVE RW-AHLIM-LO TO RWF-AH-LIMIT.                            ECSRIRTN
 13539                                                                  ECSRIRTN
 13540     COMPUTE RW-AHWRK = RS-AH-BEN * CR-AH-TERM.                   ECSRIRTN
 13541                                                                  ECSRIRTN
 13542     IF RW-AHWRK NOT GREATER RW-AHLIM-LO                          ECSRIRTN
 13543         GO TO REINSURE-CK-AH-X.                                  ECSRIRTN
 13544                                                                  ECSRIRTN
 13545     IF RW-AHWRK GREATER RW-AHLIM-HI                              ECSRIRTN
 13546         GO TO REINSURE-CK-AH-X.                                  ECSRIRTN
 13547                                                                  ECSRIRTN
 13548     MOVE 'X' TO REIN-AH-FLG (SUB1).                              ECSRIRTN
 13549                                                                  ECSRIRTN
 13550 REINSURE-CK-AH-X.                                                ECSRIRTN
 13551     EXIT.                                                        ECSRIRTN
 13552                                                                  ECSRIRTN
 13553 REIN-CHECK-INTERACT-E.                                           ECSRIRTN
 13554                                                                  ECSRIRTN
 13555     IF RS-LIFE-BEN = ZERO  OR                                    ECSRIRTN
 13556        RS-AH-BEN = ZERO                                          ECSRIRTN
 13557         GO TO REIN-INTERACT-CHECK-X.                             ECSRIRTN
 13558                                                                  ECSRIRTN
 13559     IF REIN-LF-FLG (SUB1) NOT = 'X'  AND                         ECSRIRTN
 13560        REIN-AH-FLG (SUB1) NOT = 'X'                              ECSRIRTN
 13561         GO TO REIN-INTERACT-CHECK-X.                             ECSRIRTN
 13562                                                                  ECSRIRTN
 13563     MOVE 'X'                    TO REIN-LF-FLG (SUB1)            ECSRIRTN
 13564                                    REIN-AH-FLG (SUB1).           ECSRIRTN
 13565                                                                  ECSRIRTN
 13566     IF WT-AHBEN-LO = ZERO                                        ECSRIRTN
 13567         AND WT-AHBEN-HI = ZERO                                   ECSRIRTN
 13568             MOVE +9999999.99    TO  WT-AHBEN-LO                  ECSRIRTN
 13569                                     WT-AHBEN-HI.                 ECSRIRTN
 13570     IF WT-AHMOA-LO = ZERO                                        ECSRIRTN
 13571         AND WT-AHMOA-HI = ZERO                                   ECSRIRTN
 13572             MOVE +9999999.99    TO  WT-AHMOA-LO                  ECSRIRTN
 13573                                     WT-AHMOA-HI.                 ECSRIRTN
 13574                                                                  ECSRIRTN
 13575     COMPUTE RW-AHLIM-LO = CR-AH-TERM * WT-AHMOA-LO.              ECSRIRTN
 13576     COMPUTE RW-AHLIM-HI = CR-AH-TERM * WT-AHMOA-HI.              ECSRIRTN
 13577                                                                  ECSRIRTN
 13578     IF RW-AHLIM-LO GREATER WT-AHBEN-LO                           ECSRIRTN
 13579         MOVE WT-AHBEN-LO        TO  RW-AHLIM-LO.                 ECSRIRTN
 13580                                                                  ECSRIRTN
 13581     IF RW-AHLIM-HI GREATER WT-AHBEN-HI                           ECSRIRTN
 13582         MOVE WT-AHBEN-HI        TO  RW-AHLIM-HI.                 ECSRIRTN
 13583                                                                  ECSRIRTN
 13584     COMPUTE RW-AHWRK = RS-AH-BEN * CR-AH-TERM.                   ECSRIRTN
 13585                                                                  ECSRIRTN
 13586     IF RW-AHWRK GREATER RW-AHLIM-HI                              ECSRIRTN
 13587         MOVE RW-AHLIM-HI        TO  RW-AHWRK.                    ECSRIRTN
 13588                                                                  ECSRIRTN
 13589     IF RW-AHWRK GREATER RW-AHLIM-LO                              ECSRIRTN
 13590         COMPUTE RATE-WORK-A ROUNDED = (RW-AHWRK - RW-AHLIM-LO)   ECSRIRTN
 13591                                       / RW-AHWRK                 ECSRIRTN
 13592       ELSE                                                       ECSRIRTN
 13593         MOVE ZERO               TO RATE-WORK-A.                  ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 264
* ECS010P.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 13594                                                                  ECSRIRTN
 13595     IF RS-LIFE-BEN GREATER WT-LF-LO                              ECSRIRTN
 13596         COMPUTE RATE-WORK-L ROUNDED = (RS-LIFE-BEN - WT-LF-LO)   ECSRIRTN
 13597                                       / RS-LIFE-BEN              ECSRIRTN
 13598       ELSE                                                       ECSRIRTN
 13599         MOVE ZERO               TO RATE-WORK-L.                  ECSRIRTN
 13600                                                                  ECSRIRTN
 13601     IF (RS-LIFE-BEN GREATER WT-LF-LO) AND                        ECSRIRTN
 13602        (RW-AHWRK NOT GREATER RW-AHLIM-LO)                        ECSRIRTN
 13603          MOVE 'E'               TO REIN-AH-FLG (SUB1)            ECSRIRTN
 13604          COMPUTE RWF-AHAMT ROUNDED = (RW-AHWRK * RATE-WORK-L)    ECSRIRTN
 13605                                      / CR-AH-TERM.               ECSRIRTN
 13606                                                                  ECSRIRTN
 13607     IF (RW-AHWRK GREATER RW-AHLIM-LO) AND                        ECSRIRTN
 13608        (RS-LIFE-BEN NOT GREATER WT-LF-LO)                        ECSRIRTN
 13609          MOVE 'E'               TO REIN-LF-FLG (SUB1)            ECSRIRTN
 13610          IF (RW-AHWRK - RW-AHLIM-LO) NOT GREATER RS-LIFE-BEN     ECSRIRTN
 13611               COMPUTE RWF-LFAMT = RW-AHWRK - RW-AHLIM-LO         ECSRIRTN
 13612            ELSE                                                  ECSRIRTN
 13613                MOVE RS-LIFE-BEN TO RWF-LFAMT.                    ECSRIRTN
 13614                                                                  ECSRIRTN
 13615     IF (RW-AHWRK GREATER RW-AHLIM-LO) AND                        ECSRIRTN
 13616        (RS-LIFE-BEN GREATER WT-LF-LO)                            ECSRIRTN
 13617        IF RATE-WORK-L GREATER RATE-WORK-A                        ECSRIRTN
 13618          MOVE 'E'               TO REIN-AH-FLG (SUB1)            ECSRIRTN
 13619          COMPUTE RWF-AHAMT ROUNDED = (RW-AHWRK * RATE-WORK-L)    ECSRIRTN
 13620                                      / CR-AH-TERM                ECSRIRTN
 13621         ELSE                                                     ECSRIRTN
 13622          MOVE 'E'               TO REIN-LF-FLG (SUB1)            ECSRIRTN
 13623          IF (RW-AHWRK - RW-AHLIM-LO) NOT GREATER RS-LIFE-BEN     ECSRIRTN
 13624               COMPUTE RWF-LFAMT = RW-AHWRK - RW-AHLIM-LO         ECSRIRTN
 13625            ELSE                                                  ECSRIRTN
 13626                MOVE RS-LIFE-BEN TO RWF-LFAMT.                    ECSRIRTN
 13627                                                                  ECSRIRTN
 13628 REIN-INTERACT-CHECK-X.                                           ECSRIRTN
 13629     EXIT.                                                        ECSRIRTN
 13630                                                                  ECSRIRTN
 13631                                                                  ECSRIRTN
 13632 REIN-CALC-LIFE.                                                  ECSRIRTN
 13633                                                                  ECSRIRTN
 13634     IF RS-LIFE-BEN NOT GREATER WT-LF-HI                          ECSRIRTN
 13635         MOVE RS-LIFE-BEN TO RWF-LFAMT                            ECSRIRTN
 13636     ELSE                                                         ECSRIRTN
 13637         MOVE WT-LF-HI TO RWF-LFAMT.                              ECSRIRTN
 13638                                                                  ECSRIRTN
 13639     IF RS-LIFE-BEN LESS WT-LF-LO                                 ECSRIRTN
 13640         MOVE +0 TO RWF-LFAMT                                     ECSRIRTN
 13641     ELSE                                                         ECSRIRTN
 13642         IF WT-REMAINING NOT = 'L'                                ECSRIRTN
 13643           IF RS-LIFE-BEN LESS THAN ZERO                          ECSRIRTN
 13644               COMPUTE RWF-LFAMT ROUNDED = WT-LF-PCT * RS-LIFE-BENECSRIRTN
 13645           ELSE                                                   ECSRIRTN
 13646               COMPUTE RWF-LFAMT ROUNDED = WT-LF-PCT *            ECSRIRTN
 13647                                          (RWF-LFAMT - WT-LF-LO). ECSRIRTN
 13648                                                                  ECSRIRTN
 13649 REIN-LF-SKIP-LIMIT.                                              ECSRIRTN
 13650                                                                  ECSRIRTN
 13651     MOVE +0 TO RW-LFPRM  RW-LFPRMC.                              ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 265
* ECS010P.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 13652                                                                  ECSRIRTN
 13653     IF WT-REMAINING = 'I'                                        ECSRIRTN
 13654         GO TO REIN-CALC-LF-RISK-PREM.                            ECSRIRTN
 13655                                                                  ECSRIRTN
 13656     IF WT-REMAINING = 'L'                                        ECSRIRTN
 13657         COMPUTE RWF-LFPRM ROUNDED = RS-LIFE-PREM * WT-LF-PCT     ECSRIRTN
 13658         GO TO REIN-CALC-LIFE-X.                                  ECSRIRTN
 13659                                                                  ECSRIRTN
 13660     IF RS-LIFE-BEN NOT = ZERO                                    ECSRIRTN
 13661         COMPUTE RW-LFPRM ROUNDED = (RS-LIFE-PREM *               ECSRIRTN
 13662                   RWF-LFAMT) / RS-LIFE-BEN                       ECSRIRTN
 13663         COMPUTE RW-LFPRMC ROUNDED = (RS-LP-CALC *                ECSRIRTN
 13664                   RWF-LFAMT) / RS-LIFE-BEN                       ECSRIRTN
 13665     ELSE                                                         ECSRIRTN
 13666         IF WT-LF-LIM-LO = ZERO                                   ECSRIRTN
 13667             COMPUTE RW-LFPRM ROUNDED = RS-LIFE-PREM * WT-LF-PCT  ECSRIRTN
 13668             COMPUTE RW-LFPRMC ROUNDED = RS-LP-CALC * WT-LF-PCT.  ECSRIRTN
 13669                                                                  ECSRIRTN
 13670     IF ((WT-LF-QC = '1' OR '3') OR                                  CL**8
 13671         (WT-LF-QC = '2' AND                                         CL**8
 13672          PGM-SUB = +50  AND                                         CL**8
 13673          DTE-CLIENT = 'LAP'))                                       CL**8
 13674          MOVE RW-LFPRM TO RWF-LFPRM                                 CL**8
 13675     ELSE                                                         ECSRIRTN
 13676         MOVE RW-LFPRMC TO RWF-LFPRM.                             ECSRIRTN
 13677                                                                  ECSRIRTN
 13678     IF WT-REMAINING = 'Y' OR 'Z' OR 'X' OR 'N'                   ECSRIRTN
 13679         COMPUTE RS-R-LB = RS-R-LB - RWF-LFAMT                    ECSRIRTN
 13680         COMPUTE RS-R-LP = RS-R-LP - RW-LFPRM                     ECSRIRTN
 13681         COMPUTE RS-R-LPC = RS-R-LPC - RW-LFPRMC.                 ECSRIRTN
 13682                                                                  ECSRIRTN
 13683     GO TO REIN-CALC-LIFE-X.                                      ECSRIRTN
 13684                                                                  ECSRIRTN
 13685 REIN-CALC-LF-RISK-PREM.                                          ECSRIRTN
 13686                                                                  ECSRIRTN
 13687     IF RWF-LFAMT NOT GREATER THAN +0                             ECSRIRTN
 13688         MOVE ZEROS                 TO RWF-LFPRM                  ECSRIRTN
 13689         GO TO REIN-CALC-LIFE-X.                                  ECSRIRTN
 13690                                                                  ECSRIRTN
 13691     MOVE RWF-LFAMT                 TO REIN-RISK-AMOUNT.          ECSRIRTN
 13692     COMPUTE REIN-MONTH-REDUCE = RS-LIFE-BEN / CR-LF-TERM.        ECSRIRTN
 13693     MOVE +0                        TO REIN-WORKA                 ECSRIRTN
 13694                                       RW-LFPRM.                  ECSRIRTN
 13695                                                                  ECSRIRTN
 13696 REIN-LF-RISK-PREM-LOOP.                                          ECSRIRTN
 13697                                                                  ECSRIRTN
 13698     COMPUTE RW-LFPRM = RW-LFPRM +                                ECSRIRTN
 13699                ((REIN-RISK-AMOUNT / +1000) * CR-LF-NSP-PRM-RATE).ECSRIRTN
 13700                                                                  ECSRIRTN
 13701     IF CLAS-I-RL-AH (CLAS-INDEXL) NOT = 'L'                      ECSRIRTN
 13702        SUBTRACT REIN-MONTH-REDUCE FROM REIN-RISK-AMOUNT.         ECSRIRTN
 13703                                                                  ECSRIRTN
 13704     IF REIN-WORKA = REIN-EARN-LF-TERM  OR                        ECSRIRTN
 13705        REIN-RISK-AMOUNT LESS THAN +0                             ECSRIRTN
 13706         MOVE RW-LFPRM              TO RWF-LFPRM                  ECSRIRTN
 13707     ELSE                                                         ECSRIRTN
 13708         ADD +1 TO REIN-WORKA                                     ECSRIRTN
 13709         GO TO REIN-LF-RISK-PREM-LOOP.                            ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 266
* ECS010P.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 13710                                                                  ECSRIRTN
 13711                                                                  ECSRIRTN
 13712 REIN-CALC-LIFE-X.                                                ECSRIRTN
 13713     EXIT.                                                        ECSRIRTN
 13714                                                                  ECSRIRTN
 13715 REIN-CALC-AH.                                                    ECSRIRTN
 13716                                                                  ECSRIRTN
 13717     IF WT-AHBEN-LO = ZERO                                        ECSRIRTN
 13718         AND WT-AHBEN-HI = ZERO                                   ECSRIRTN
 13719             MOVE +9999999.99 TO WT-AHBEN-LO                      ECSRIRTN
 13720                                 WT-AHBEN-HI.                     ECSRIRTN
 13721                                                                  ECSRIRTN
 13722     IF WT-AHMOA-LO = ZERO                                        ECSRIRTN
 13723         AND WT-AHMOA-HI = ZERO                                   ECSRIRTN
 13724             MOVE +9999999.99 TO WT-AHMOA-LO                      ECSRIRTN
 13725                                 WT-AHMOA-HI.                     ECSRIRTN
 13726                                                                  ECSRIRTN
 13727     COMPUTE RW-AHLIM-LO = CR-AH-TERM * WT-AHMOA-LO.              ECSRIRTN
 13728     COMPUTE RW-AHLIM-HI = CR-AH-TERM * WT-AHMOA-HI.              ECSRIRTN
 13729                                                                  ECSRIRTN
 13730     IF RW-AHLIM-LO GREATER WT-AHBEN-LO                           ECSRIRTN
 13731         MOVE WT-AHBEN-LO TO RW-AHLIM-LO.                         ECSRIRTN
 13732                                                                  ECSRIRTN
 13733     IF RW-AHLIM-HI GREATER WT-AHBEN-HI                           ECSRIRTN
 13734         MOVE WT-AHBEN-HI TO RW-AHLIM-HI.                         ECSRIRTN
 13735                                                                  ECSRIRTN
 13736     IF RW-AHWRK GREATER RW-AHLIM-HI                              ECSRIRTN
 13737         MOVE RW-AHLIM-HI TO RW-AHWRK.                            ECSRIRTN
 13738                                                                  ECSRIRTN
 13739     IF RW-AHWRK LESS RW-AHLIM-LO                                 ECSRIRTN
 13740         MOVE +0 TO RWF-AHAMT                                     ECSRIRTN
 13741     ELSE                                                         ECSRIRTN
 13742         IF WT-REMAINING = 'L'                                    ECSRIRTN
 13743             COMPUTE RWF-AHAMT ROUNDED = RW-AHWRK / CR-AH-TERM    ECSRIRTN
 13744         ELSE                                                     ECSRIRTN
 13745             COMPUTE RWF-AHAMT ROUNDED =                          ECSRIRTN
 13746             ((RW-AHWRK - RW-AHLIM-LO) / CR-AH-TERM) * WT-AH-PCT. ECSRIRTN
 13747                                                                  ECSRIRTN
 13748 REIN-AH-SKIP-LIMIT.                                              ECSRIRTN
 13749                                                                  ECSRIRTN
 13750     IF WT-REMAINING = 'I'                                        ECSRIRTN
 13751         GO TO REIN-CALC-AH-RISK-PREM.                            ECSRIRTN
 13752                                                                  ECSRIRTN
 13753     IF WT-REMAINING = 'L'                                        ECSRIRTN
 13754         COMPUTE RWF-AHPRM ROUNDED = RS-AH-PREM * WT-AH-PCT       ECSRIRTN
 13755         GO TO REIN-CALC-AH-X.                                    ECSRIRTN
 13756                                                                  ECSRIRTN
 13757     IF RS-AH-BEN NOT = ZERO                                      ECSRIRTN
 13758         COMPUTE RW-AHPRM ROUNDED = (RS-AH-PREM *                 ECSRIRTN
 13759                   RWF-AHAMT) / RS-AH-BEN                         ECSRIRTN
 13760         COMPUTE RW-AHPRMC ROUNDED = (RS-AP-CALC *                ECSRIRTN
 13761                   RWF-AHAMT) / RS-AH-BEN                         ECSRIRTN
 13762     ELSE                                                         ECSRIRTN
 13763         IF RW-AHLIM-LO = ZERO                                    ECSRIRTN
 13764             COMPUTE RW-AHPRM ROUNDED = RS-AH-PREM * WT-AH-PCT    ECSRIRTN
 13765             COMPUTE RW-AHPRMC ROUNDED = RS-AP-CALC * WT-AH-PCT.  ECSRIRTN
 13766                                                                  ECSRIRTN
 13767     IF ((WT-AH-QC = '1' OR '3') OR                                  CL**8
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 267
* ECS010P.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 13768         (WT-AH-QC = '2' AND                                         CL**8
 13769          PGM-SUB = +50  AND                                         CL**8
 13770          DTE-CLIENT = 'LAP'))                                       CL**8
 13771         MOVE RW-AHPRM TO RWF-AHPRM                               ECSRIRTN
 13772     ELSE                                                         ECSRIRTN
 13773         MOVE RW-AHPRMC TO RWF-AHPRM.                             ECSRIRTN
 13774                                                                  ECSRIRTN
 13775     IF RE-NSP-ST-CD-AH = SPACES OR ZERO                          ECSRIRTN
 13776         IF (WT-REMAINING = 'Y' OR 'Z') AND (WT-AH-QC = '1')      ECSRIRTN
 13777            AND (RWF-AHAMT = RS-R-AB) AND (RWF-AHAMT NOT = +0)    ECSRIRTN
 13778                MOVE 'Y' TO RWF-REM-AH-100.                       ECSRIRTN
 13779                                                                  ECSRIRTN
 13780     IF WT-REMAINING = 'Y' OR 'Z' OR 'X' OR 'N'                   ECSRIRTN
 13781         COMPUTE RS-R-AB = RS-R-AB - RWF-AHAMT                    ECSRIRTN
 13782         COMPUTE RS-R-AP = RS-R-AP - RW-AHPRM                     ECSRIRTN
 13783         COMPUTE RS-R-APC = RS-R-APC - RW-AHPRMC.                 ECSRIRTN
 13784                                                                  ECSRIRTN
 13785     GO TO REIN-CALC-AH-X.                                        ECSRIRTN
 13786                                                                  ECSRIRTN
 13787 REIN-CALC-AH-RISK-PREM.                                          ECSRIRTN
 13788                                                                  ECSRIRTN
 13789     IF RWF-AHAMT NOT GREATER THAN +0                             ECSRIRTN
 13790         MOVE ZEROS                 TO RWF-AHPRM                  ECSRIRTN
 13791         GO TO REIN-CALC-AH-X.                                    ECSRIRTN
 13792                                                                  ECSRIRTN
 13793     COMPUTE REIN-RISK-AMOUNT = RWF-AHAMT * CR-AH-TERM.           ECSRIRTN
 13794     MOVE RS-AH-BEN              TO REIN-MONTH-REDUCE.            ECSRIRTN
 13795     MOVE +0                     TO REIN-WORKA                    ECSRIRTN
 13796                                    RW-AHPRM.                     ECSRIRTN
 13797                                                                  ECSRIRTN
 13798 REIN-AH-RISK-PREM-LOOP.                                          ECSRIRTN
 13799                                                                  ECSRIRTN
 13800     COMPUTE RW-AHPRM = RW-AHPRM +                                ECSRIRTN
 13801                ((REIN-RISK-AMOUNT / +1000) * CR-AH-NSP-PRM-RATE).ECSRIRTN
 13802                                                                  ECSRIRTN
 13803     SUBTRACT REIN-MONTH-REDUCE FROM REIN-RISK-AMOUNT.            ECSRIRTN
 13804                                                                  ECSRIRTN
 13805     IF REIN-WORKA = REIN-EARN-AH-TERM  OR                        ECSRIRTN
 13806        REIN-RISK-AMOUNT LESS THAN +0                             ECSRIRTN
 13807         MOVE RW-AHPRM          TO RWF-AHPRM                      ECSRIRTN
 13808     ELSE                                                         ECSRIRTN
 13809         ADD +1 TO REIN-WORKA                                     ECSRIRTN
 13810         GO TO REIN-AH-RISK-PREM-LOOP.                            ECSRIRTN
 13811                                                                  ECSRIRTN
 13812                                                                  ECSRIRTN
 13813 REIN-CALC-AH-X.                                                  ECSRIRTN
 13814     EXIT.                                                        ECSRIRTN
 13815                                                                  ECSRIRTN
 13816 REINSURE-CALC-REMAINDER.                                         ECSRIRTN
 13817                                                                  ECSRIRTN
 13818     COMPUTE RWF-LFAMT = CR-LFAMT + CR-LFAMT-ALT.                 ECSRIRTN
 13819     COMPUTE RWF-LFPRM = CR-LFPRM + CR-LFPRM-ALT.                 ECSRIRTN
 13820     MOVE CR-AHAMT TO RWF-AHAMT.                                  ECSRIRTN
 13821     MOVE CR-AHPRM TO RWF-AHPRM.                                  ECSRIRTN
 13822                                                                  ECSRIRTN
 13823     PERFORM REINSURE-SUBTRACT THRU REINSURE-SUBTRACT-X           ECSRIRTN
 13824         VARYING SUB2 FROM +1 BY +1 UNTIL SUB2 = SUB1.            ECSRIRTN
 13825                                                                  ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 268
* ECS010P.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 13826     IF RWF-LFAMT NOT = ZEROS OR                                  ECSRIRTN
 13827        RWF-LFPRM NOT = ZEROS                                     ECSRIRTN
 13828           MOVE 'X' TO REIN-LF-FLG (SUB1).                        ECSRIRTN
 13829                                                                  ECSRIRTN
 13830     IF RWF-AHAMT NOT = ZEROS OR                                  ECSRIRTN
 13831        RWF-AHPRM NOT = ZEROS                                     ECSRIRTN
 13832           MOVE 'X' TO REIN-AH-FLG (SUB1).                        ECSRIRTN
 13833                                                                  ECSRIRTN
 13834 REINSURE-CALC-X.                                                 ECSRIRTN
 13835                                                                  ECSRIRTN
 13836     IF REIN-LF-AH-FLGS (SUB1) NOT = SPACES                       ECSRIRTN
 13837         MOVE 'X' TO REIN-BUS-FLAG.                               ECSRIRTN
 13838                                                                  ECSRIRTN
 13839     MOVE RWF-FIELDS TO REIN-WORK-FLDS (SUB1).                    ECSRIRTN
 13840                                                                  ECSRIRTN
 13841 REINSURE-SUBTRACT.                                               ECSRIRTN
 13842                                                                  ECSRIRTN
 13843     SUBTRACT REIN-LFAMT (SUB2) FROM RWF-LFAMT.                   ECSRIRTN
 13844     SUBTRACT REIN-LFPRM (SUB2) FROM RWF-LFPRM.                   ECSRIRTN
 13845     SUBTRACT REIN-AHAMT (SUB2) FROM RWF-AHAMT.                   ECSRIRTN
 13846     SUBTRACT REIN-AHPRM (SUB2) FROM RWF-AHPRM.                   ECSRIRTN
 13847                                                                  ECSRIRTN
 13848 REINSURE-SUBTRACT-X.                                             ECSRIRTN
 13849     EXIT.                                                        ECSRIRTN
 13850                                                                  ECSRIRTN
 13851 REINSURE-CALC-CANCEL.                                            ECSRIRTN
 13852                                                                  ECSRIRTN
 13853     MOVE REIN-WORK-FLDS (SUB1) TO RWF-FIELDS.                    ECSRIRTN
 13854     MOVE RE-COMP-INFO (SUB1) TO WT-COMP-INFO.                    ECSRIRTN
 13855                                                                  ECSRIRTN
 13856     IF SUB1 = RE-100-COMP                                        ECSRIRTN
 13857         GO TO REINSURE-REMAINDER-CANCEL.                         ECSRIRTN
 13858                                                                  ECSRIRTN
 13859     IF REIN-LF-FLG (SUB1) NOT = 'X'                              ECSRIRTN
 13860         GO TO REINSURE-CALC-CANCEL-AH.                           ECSRIRTN
 13861                                                                  ECSRIRTN
 13862     IF RWF-LF-RUNOFF-SW = 'N'                                    ECSRIRTN
 13863         IF CR-LF-CANC-DT NOT LESS THAN RWF-EP-STOP-DATE             CL**3
 13864             GO TO REINSURE-CALC-CANCEL-AH.                       ECSRIRTN
 13865                                                                  ECSRIRTN
 13866     IF WT-REMAINING = 'I'                                        ECSRIRTN
 13867         GO TO REINSURE-CALC-LF-RISK-CANCEL.                      ECSRIRTN
 13868                                                                  ECSRIRTN
 13869     IF WT-REMAINING = 'L'                                        ECSRIRTN
 13870         COMPUTE RWF-LFRFND ROUNDED = CR-LFRFND * WT-LF-PCT       ECSRIRTN
 13871         GO TO REINSURE-CALC-CANCEL-AH.                           ECSRIRTN
 13872                                                                  ECSRIRTN
 13873     IF CR-LFPRM = ZERO                                           ECSRIRTN
 13874        MOVE ZERO                TO REIN-FACTOR
 13875     ELSE                                                         ECSRIRTN
 13876        IF DTE-CLIENT = 'GIC'  AND
 13877           CLAS-I-BAL (CLAS-INDEXL) = 'B'
 13878           MOVE +1.0             TO REIN-FACTOR
 13879        ELSE
 13880           IF DTE-CLIENT = 'DCC'
 13881              COMPUTE REIN-FACTOR = CR-LFRFND /
 13882                 (CR-LFPRM + CR-LFPRM-ALT)
 13883           ELSE
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 269
* ECS010P.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 13884              COMPUTE REIN-FACTOR ROUNDED =  CR-LFRFND-CALC /
 13885                 (CR-LFPRM + CR-LFPRM-ALT)
 13886            END-IF
 13887         END-IF
 13888     END-IF
 13889                                                                  ECSRIRTN
 13890     IF CR-LFAMT NOT = ZERO                                       ECSRIRTN
 13891         IF DTE-CLIENT = 'GTL'  OR  'UAL'  OR  'NCL'  OR  'CVL'   ECSRIRTN
 13892             IF WT-LF-QC = ('1' OR '4')                           ECSRIRTN
 13893                 COMPUTE RWF-LFRFND ROUNDED =  ((CR-LFRFND *      ECSRIRTN
 13894                         RWF-LFAMT) / (CR-LFAMT + CR-LFAMT-ALT))  ECSRIRTN
 13895             ELSE                                                 ECSRIRTN
 13896                 COMPUTE RWF-LFRFND =                             ECSRIRTN
 13897                            REIN-FACTOR * REIN-CALCED-LIFE        ECSRIRTN
 13898                 COMPUTE RWF-LFRFND ROUNDED =  ((RWF-LFRFND *     ECSRIRTN
 13899                         RWF-LFAMT) / (CR-LFAMT + CR-LFAMT-ALT))  ECSRIRTN
 13900         ELSE                                                     ECSRIRTN
 13901             IF WT-LF-QC = ('1' OR '4')                           ECSRIRTN
 13902                 compute rein-factor rounded =
 13903                    RWF-LFAMT / (CR-LFAMT + CR-LFAMT-ALT)
 13904                 COMPUTE RWF-LFRFND ROUNDED =  CR-LFRFND *
 13905                    rein-factor
 13906             ELSE                                                 ECSRIRTN
 13907*                COMPUTE RWF-LFRFND = REIN-FACTOR
 13908*                   * REIN-CALCED-LIFE *
 13909*                   (RWF-LFAMT / (CR-LFAMT + CR-LFAMT-ALT)).
 13910                 COMPUTE RWF-LFRFND =                             ECSRIRTN
 13911                            REIN-FACTOR * REIN-CALCED-LIFE        ECSRIRTN
 13912                 COMPUTE RWF-LFRFND ROUNDED =  (RWF-LFRFND *
 13913                        RWF-LFAMT) / (CR-LFAMT + CR-LFAMT-ALT).
 13914                                                                  ECSRIRTN
 13915     IF CR-LFAMT = ZERO                                           ECSRIRTN
 13916         IF WT-LF-LIM-LO = ZERO                                   ECSRIRTN
 13917             IF WT-LF-QC = ('1' OR '4')                           ECSRIRTN
 13918                 COMPUTE RWF-LFRFND ROUNDED =                     ECSRIRTN
 13919                       CR-LFRFND * WT-LF-PCT                      ECSRIRTN
 13920             ELSE                                                 ECSRIRTN
 13921                 COMPUTE RWF-LFRFND =                             ECSRIRTN
 13922                            REIN-FACTOR * REIN-CALCED-LIFE        ECSRIRTN
 13923                 COMPUTE RWF-LFRFND ROUNDED =                     ECSRIRTN
 13924                       RWF-LFRFND * WT-LF-PCT.                    ECSRIRTN
 13925                                                                  ECSRIRTN
 13926     GO TO REINSURE-CALC-CANCEL-AH.                               ECSRIRTN
 13927                                                                  ECSRIRTN
 13928                                                                  ECSRIRTN
 13929 REINSURE-CALC-LF-RISK-CANCEL.                                    ECSRIRTN
 13930                                                                  ECSRIRTN
 13931     IF RWF-LFAMT NOT GREATER THAN +0  OR                         ECSRIRTN
 13932       (CR-LF-CANC-DT = ZEROS)                                       CL*10
 13933         MOVE ZERO                    TO RWF-LFRFND               ECSRIRTN
 13934         GO TO REINSURE-CALC-CANCEL-AH.                           ECSRIRTN
 13935                                                                  ECSRIRTN
 13936     IF REIN-RT-SW NOT = 'X'                                      ECSRIRTN
 13937       IF VOIDING-LF-CANCEL                                       ECSRIRTN
 13938           COMPUTE RWF-LFRFND = RWF-LFRFND * (-1)                 ECSRIRTN
 13939           GO TO REINSURE-CALC-CANCEL-AH                          ECSRIRTN
 13940       ELSE                                                       ECSRIRTN
 13941           IF ADDITIONAL-LF-CANCEL                                ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 270
* ECS010P.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 13942               GO TO REINSURE-CALC-CANCEL-AH.                     ECSRIRTN
 13943                                                                  ECSRIRTN
 13944     IF FLAT-CANCEL-LF                                            ECSRIRTN
 13945         MOVE RWF-LFPRM               TO RWF-LFRFND               ECSRIRTN
 13946         GO TO REINSURE-CALC-CANCEL-AH.                           ECSRIRTN
 13947                                                                  ECSRIRTN
 13948     IF REIN-EARN-LF-TERM = REIN-LCNC-EARN-TERM                   ECSRIRTN
 13949         MOVE ZERO                    TO RWF-LFRFND               ECSRIRTN
 13950         GO TO REINSURE-CALC-CANCEL-AH.                           ECSRIRTN
 13951                                                                  ECSRIRTN
 13952     MOVE RWF-LFAMT                   TO REIN-RISK-AMOUNT.        ECSRIRTN
 13953     COMPUTE REIN-MONTH-REDUCE = RS-LIFE-BEN / CR-LF-TERM.        ECSRIRTN
 13954     MOVE +0                          TO REIN-WORKA               ECSRIRTN
 13955                                         RW-LFRFND.               ECSRIRTN
 13956                                                                  ECSRIRTN
 13957 REINSURE-LF-RISK-CANCEL-LOOP.                                    ECSRIRTN
 13958                                                                  ECSRIRTN
 13959     COMPUTE RW-LFRFND = RW-LFRFND +                              ECSRIRTN
 13960                ((REIN-RISK-AMOUNT / +1000) * CR-LF-NSP-PRM-RATE).ECSRIRTN
 13961                                                                  ECSRIRTN
 13962     IF CLAS-I-RL-AH (CLAS-INDEXL) NOT = 'L'                      ECSRIRTN
 13963        SUBTRACT REIN-MONTH-REDUCE FROM REIN-RISK-AMOUNT.         ECSRIRTN
 13964                                                                  ECSRIRTN
 13965     IF REIN-WORKA = REIN-LCNC-EARN-TERM  OR                      ECSRIRTN
 13966        REIN-RISK-AMOUNT LESS THAN +0                             ECSRIRTN
 13967         COMPUTE RWF-LFRFND = RWF-LFPRM - RW-LFRFND               ECSRIRTN
 13968     ELSE                                                         ECSRIRTN
 13969         ADD +1 TO REIN-WORKA                                     ECSRIRTN
 13970         GO TO REINSURE-LF-RISK-CANCEL-LOOP.                      ECSRIRTN
 13971                                                                  ECSRIRTN
 13972                                                                  ECSRIRTN
 13973 REINSURE-CALC-CANCEL-AH.                                         ECSRIRTN
 13974                                                                  ECSRIRTN
 13975     IF REIN-AH-FLG (SUB1) NOT = 'X'                              ECSRIRTN
 13976         GO TO REINSURE-CALC-CANCEL-SKIP.                         ECSRIRTN
 13977                                                                  ECSRIRTN
 13978     IF RWF-AH-RUNOFF-SW = 'N'                                    ECSRIRTN
 13979         IF CR-AH-CANC-DT NOT LESS THAN RWF-EP-STOP-DATE             CL**4
 13980             GO TO REINSURE-CALC-CANCEL-SKIP.                     ECSRIRTN
 13981                                                                  ECSRIRTN
 13982     IF RWF-REM-AH-100 = 'Y'                                      ECSRIRTN
 13983         MOVE CR-AHRFND TO RWF-AHRFND                             ECSRIRTN
 13984         PERFORM REINSURE-SUB-REM-CANCEL THRU                     ECSRIRTN
 13985             REINSURE-SUB-REM-CANCEL-X                            ECSRIRTN
 13986                 VARYING SUB2 FROM +1 BY +1 UNTIL SUB2 = SUB1     ECSRIRTN
 13987         GO TO REINSURE-CALC-CANCEL-SKIP.                         ECSRIRTN
 13988                                                                  ECSRIRTN
 13989     IF WT-REMAINING = 'I'                                        ECSRIRTN
 13990         GO TO REINSURE-CALC-AH-RISK-CANCEL.                      ECSRIRTN
 13991                                                                  ECSRIRTN
 13992     IF WT-REMAINING = 'L'                                        ECSRIRTN
 13993         COMPUTE RWF-AHRFND ROUNDED = CR-AHRFND * WT-AH-PCT       ECSRIRTN
 13994         GO TO REINSURE-CALC-CANCEL-SKIP.                         ECSRIRTN
 13995                                                                  ECSRIRTN
 13996     IF CR-AHPRM = ZERO                                           ECSRIRTN
 13997        MOVE ZERO                TO REIN-FACTOR
 13998     ELSE
 13999        IF DTE-CLIENT = 'GIC'  AND
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 271
* ECS010P.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 14000           CLAS-I-BAL (CLAS-INDEXA) = 'B'
 14001            MOVE +1.0            TO REIN-FACTOR
 14002        ELSE
 14003           IF DTE-CLIENT = 'DCC'
 14004              COMPUTE REIN-FACTOR =
 14005                 CR-AHRFND / CR-AHPRM
 14006           ELSE
 14007              COMPUTE REIN-FACTOR ROUNDED =
 14008                                CR-AHRFND-CALC / CR-AHPRM
 14009           END-IF
 14010        END-IF
 14011     END-IF
 14012
 14013     IF CR-AHAMT NOT = ZERO
 14014        IF (DTE-CLIENT = 'DCC')
 14015           AND (CLAS-I-REFUND-METHOD (CLAS-INDEXA) = 'D')
 14016           MOVE CR-AH-RFND-CLP   TO RWF-AHRFND
 14017        ELSE
 14018           IF WT-AH-QC = ('1' OR '4')
 14019              compute rein-factor rounded = rwf-ahamt / cr-ahamt
 14020              compute rwf-ahrfnd rounded =
 14021                 cr-ahrfnd * rein-factor
 14022           ELSE
 14023              COMPUTE RWF-AHRFND = REIN-FACTOR * REIN-CALCED-AH
 14024              COMPUTE RWF-AHRFND ROUNDED = (RWF-AHRFND *
 14025                       RWF-AHAMT) / CR-AHAMT
 14026           END-IF
 14027        END-IF
 14028     ELSE
 14029        IF RWF-AH-LIMIT = ZERO
 14030           IF WT-AH-QC = ('1' OR '4')
 14031              COMPUTE RWF-AHRFND ROUNDED =
 14032                       CR-AHRFND * WT-AH-PCT
 14033           ELSE
 14034              COMPUTE RWF-AHRFND =
 14035                            REIN-FACTOR * REIN-CALCED-AH
 14036              COMPUTE RWF-AHRFND ROUNDED =
 14037                       RWF-AHRFND * WT-AH-PCT
 14038           END-IF
 14039        END-IF
 14040     END-IF
 14041
 14042     GO TO REINSURE-CALC-CANCEL-SKIP.                             ECSRIRTN
 14043                                                                  ECSRIRTN
 14044                                                                  ECSRIRTN
 14045 REINSURE-CALC-AH-RISK-CANCEL.                                    ECSRIRTN
 14046                                                                  ECSRIRTN
 14047     IF RWF-AHAMT NOT GREATER THAN +0  OR                         ECSRIRTN
 14048       (CR-AH-CANC-DT = ZEROS)                                       CL*10
 14049         MOVE ZERO                    TO RWF-AHRFND               ECSRIRTN
 14050         GO TO REINSURE-CALC-CANCEL-SKIP.                         ECSRIRTN
 14051                                                                  ECSRIRTN
 14052     IF REIN-RT-SW NOT = 'X'                                      ECSRIRTN
 14053       IF VOIDING-AH-CANCEL                                       ECSRIRTN
 14054           COMPUTE RWF-AHRFND = RWF-AHRFND * (-1)                 ECSRIRTN
 14055           GO TO REINSURE-CALC-CANCEL-SKIP                        ECSRIRTN
 14056       ELSE                                                       ECSRIRTN
 14057           IF ADDITIONAL-AH-CANCEL                                ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 272
* ECS010P.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 14058               GO TO REINSURE-CALC-CANCEL-SKIP.                   ECSRIRTN
 14059                                                                  ECSRIRTN
 14060     IF FLAT-CANCEL-AH                                            ECSRIRTN
 14061         MOVE RWF-AHPRM               TO RWF-AHRFND               ECSRIRTN
 14062         GO TO REINSURE-CALC-CANCEL-SKIP.                         ECSRIRTN
 14063                                                                  ECSRIRTN
 14064     IF REIN-EARN-AH-TERM = REIN-ACNC-EARN-TERM                   ECSRIRTN
 14065         MOVE ZERO                    TO RWF-AHRFND               ECSRIRTN
 14066         GO TO REINSURE-CALC-CANCEL-SKIP.                         ECSRIRTN
 14067                                                                  ECSRIRTN
 14068     MOVE RS-AH-BEN              TO REIN-MONTH-REDUCE.            ECSRIRTN
 14069     COMPUTE REIN-RISK-AMOUNT = RWF-AHAMT * CR-AH-TERM.           ECSRIRTN
 14070     MOVE +0                     TO REIN-WORKA                    ECSRIRTN
 14071                                    RW-AHRFND.                    ECSRIRTN
 14072                                                                  ECSRIRTN
 14073 REINSURE-AH-RISK-CANCEL-LOOP.                                    ECSRIRTN
 14074                                                                  ECSRIRTN
 14075     COMPUTE RW-AHRFND = RW-AHRFND +                              ECSRIRTN
 14076                ((REIN-RISK-AMOUNT / +1000) * CR-AH-NSP-PRM-RATE).ECSRIRTN
 14077                                                                  ECSRIRTN
 14078     SUBTRACT REIN-MONTH-REDUCE FROM REIN-RISK-AMOUNT.            ECSRIRTN
 14079                                                                  ECSRIRTN
 14080     IF REIN-WORKA = REIN-ACNC-EARN-TERM  OR                      ECSRIRTN
 14081        REIN-RISK-AMOUNT LESS THAN +0                             ECSRIRTN
 14082         COMPUTE RWF-AHRFND = RWF-AHPRM - RW-AHRFND               ECSRIRTN
 14083     ELSE                                                         ECSRIRTN
 14084         ADD +1 TO REIN-WORKA                                     ECSRIRTN
 14085         GO TO REINSURE-AH-RISK-CANCEL-LOOP.                      ECSRIRTN
 14086                                                                  ECSRIRTN
 14087                                                                  ECSRIRTN
 14088 REINSURE-CALC-CANCEL-SKIP.                                       ECSRIRTN
 14089                                                                  ECSRIRTN
 14090     IF RWF-LFRFND NOT = ZEROS                                    ECSRIRTN
 14091         MOVE 'X' TO REIN-LF-FLG (SUB1).                          ECSRIRTN
 14092                                                                  ECSRIRTN
 14093     IF RWF-AHRFND NOT = ZEROS                                    ECSRIRTN
 14094         MOVE 'X' TO REIN-AH-FLG (SUB1).                          ECSRIRTN
 14095                                                                  ECSRIRTN
 14096     GO TO REINSURE-CALC-CANCEL-X.                                ECSRIRTN
 14097                                                                  ECSRIRTN
 14098 REINSURE-REMAINDER-CANCEL.                                       ECSRIRTN
 14099                                                                  ECSRIRTN
 14100     MOVE CR-LFRFND TO RWF-LFRFND.                                ECSRIRTN
 14101     MOVE CR-AHRFND TO RWF-AHRFND.                                ECSRIRTN
 14102                                                                  ECSRIRTN
 14103     PERFORM REINSURE-SUBTRACT-CANCEL THRU                        ECSRIRTN
 14104         REINSURE-SUBTRACT-CANCEL-X                               ECSRIRTN
 14105             VARYING SUB2 FROM +1 BY +1 UNTIL SUB2 = SUB1.        ECSRIRTN
 14106                                                                  ECSRIRTN
 14107     IF RWF-LFRFND NOT = ZEROS                                    ECSRIRTN
 14108         MOVE 'X' TO REIN-LF-FLG (SUB1).                          ECSRIRTN
 14109                                                                  ECSRIRTN
 14110     IF RWF-AHRFND NOT = ZEROS                                    ECSRIRTN
 14111         MOVE 'X' TO REIN-AH-FLG (SUB1).                          ECSRIRTN
 14112                                                                  ECSRIRTN
 14113 REINSURE-CALC-CANCEL-X.                                          ECSRIRTN
 14114                                                                  ECSRIRTN
 14115     IF REIN-LF-AH-FLGS (SUB1) NOT = SPACES                       ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 273
* ECS010P.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 14116         MOVE 'X' TO REIN-BUS-FLAG.                               ECSRIRTN
 14117                                                                  ECSRIRTN
 14118     MOVE RWF-FIELDS TO REIN-WORK-FLDS (SUB1).                    ECSRIRTN
 14119                                                                  ECSRIRTN
 14120 REINSURE-SUBTRACT-CANCEL.                                        ECSRIRTN
 14121                                                                  ECSRIRTN
 14122     SUBTRACT REIN-LFRFND (SUB2) FROM RWF-LFRFND.                 ECSRIRTN
 14123     SUBTRACT REIN-AHRFND (SUB2) FROM RWF-AHRFND.                 ECSRIRTN
 14124                                                                  ECSRIRTN
 14125 REINSURE-SUBTRACT-CANCEL-X.                                      ECSRIRTN
 14126     EXIT.                                                        ECSRIRTN
 14127                                                                  ECSRIRTN
 14128 REINSURE-SUB-REM-CANCEL.                                         ECSRIRTN
 14129                                                                  ECSRIRTN
 14130     IF REIN-REM-SW (SUB2) = 'Y' OR 'Z' OR 'X' OR 'N'             ECSRIRTN
 14131         SUBTRACT REIN-AHRFND (SUB2) FROM RWF-AHRFND.             ECSRIRTN
 14132                                                                  ECSRIRTN
 14133 REINSURE-SUB-REM-CANCEL-X.                                       ECSRIRTN
 14134     EXIT.                                                        ECSRIRTN
 14135                                                                  ECSRIRTN
 14136 REINSURE-CALC-CLAIM.                                             ECSRIRTN
 14137                                                                  ECSRIRTN
 14138     MOVE REIN-WORK-FLDS (SUB1) TO RWF-FIELDS.                    ECSRIRTN
 14139     MOVE RE-COMP-INFO (SUB1) TO WT-COMP-INFO.                    ECSRIRTN
 14140                                                                  ECSRIRTN
 14141     IF SUB1 = RE-100-COMP                                        ECSRIRTN
 14142         GO TO REINSURE-REMAINDER-CLAIM.                          ECSRIRTN
 14143                                                                  ECSRIRTN
 14144     PERFORM REIN-FIND-CO-LOOP THRU FIND-REI-CO-EXIT              ECSRIRTN
 14145        VARYING CO-SUB FROM 1 BY 1 UNTIL                          ECSRIRTN
 14146          (RCT-REIN-CO (CO-SUB) = REIN-COMP (SUB1))  OR           ECSRIRTN
 14147          (CO-SUB GREATER REIN-CO-TABLE-ENT-CNT)     OR           ECSRIRTN
 14148          (RCT-REIN-CO (CO-SUB) = SPACES).                        ECSRIRTN
 14149                                                                  ECSRIRTN
 14150     IF (CO-SUB GREATER REIN-CO-TABLE-ENT-CNT)  OR                ECSRIRTN
 14151        (RCT-REIN-CO (CO-SUB) = SPACES)                           ECSRIRTN
 14152          MOVE ZERO TO CO-SUB.                                    ECSRIRTN
 14153                                                                  ECSRIRTN
 14154     MOVE ZEROS                TO RWF-LFCLML                      ECSRIRTN
 14155                                  RWF-AHCLML.                     ECSRIRTN
 14156                                                                  ECSRIRTN
 14157     IF REIN-LF-FLG (SUB1) NOT = 'X'                              ECSRIRTN
 14158         GO TO REINSURE-CALC-CLAIM-AH.                            ECSRIRTN
 14159                                                                  ECSRIRTN
 14160     IF RW-LFCLMWK = ZEROS                                        ECSRIRTN
 14161         GO TO REINSURE-CALC-CLAIM-AH.                            ECSRIRTN
 14162                                                                  ECSRIRTN
 14163     IF CO-SUB NOT = ZERO                                         ECSRIRTN
 14164         IF RCT-CLM-CUTOFF-DT (CO-SUB) NOT = ZERO                 ECSRIRTN
 14165             IF CR-DTH-DT LESS RCT-CLM-CUTOFF-DT (CO-SUB)         ECSRIRTN
 14166                 GO TO REINSURE-CALC-CLAIM-AH.                    ECSRIRTN
 14167                                                                  ECSRIRTN
 14168     IF RWF-LF-RUNOFF-SW = 'N'                                    ECSRIRTN
 14169         IF CR-DTH-DT NOT LESS THAN RWF-EP-STOP-DATE                 CL**6
 14170                 GO TO REINSURE-CALC-CLAIM-AH.                    ECSRIRTN
 14171                                                                  ECSRIRTN
 14172     IF WT-REMAINING = 'I'                                        ECSRIRTN
 14173         GO TO REINSURE-CALC-LF-RISK-CLAIM.                       ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 274
* ECS010P.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 14174                                                                  ECSRIRTN
 14175     IF WT-REMAINING = 'L'                                        ECSRIRTN
 14176         IF REIN-RT-SW = 'X'                                      ECSRIRTN
 14177             IF RW-LFCLMWK GREATER WT-LF-HI                       ECSRIRTN
 14178                 MOVE WT-LF-HI TO RWF-LFCLM                       ECSRIRTN
 14179             ELSE                                                 ECSRIRTN
 14180                 MOVE RW-LFCLMWK TO RWF-LFCLM                     ECSRIRTN
 14181         ELSE                                                     ECSRIRTN
 14182             IF (RW-LFCLMWK + RWF-LFCLM) GREATER WT-LF-HI         ECSRIRTN
 14183                 COMPUTE RWF-LFCLML = WT-LF-HI - RWF-LFCLM        ECSRIRTN
 14184                 MOVE WT-LF-HI TO RWF-LFCLM                       ECSRIRTN
 14185             ELSE                                                 ECSRIRTN
 14186                 MOVE RW-LFCLMWK TO RWF-LFCLML                    ECSRIRTN
 14187                 ADD RWF-LFCLML TO RWF-LFCLM.                     ECSRIRTN
 14188                                                                  ECSRIRTN
 14189     IF WT-REMAINING = 'L'                                        ECSRIRTN
 14190         GO TO REINSURE-CALC-CLAIM-AH.                            ECSRIRTN
 14191                                                                  ECSRIRTN
 14192     IF CR-LFAMT NOT = ZERO                                       ECSRIRTN
 14193         IF DTE-CLIENT = 'GTL'  OR  'UAL'  OR  'NCL'  OR  'CVL'   ECSRIRTN
 14194            OR 'DCC'
 14195             COMPUTE RWF-LFCLML ROUNDED =  ((RW-LFCLMWK *         ECSRIRTN
 14196                         RWF-LFAMT) / (CR-LFAMT + CR-LFAMT-ALT))  ECSRIRTN
 14197         ELSE                                                     ECSRIRTN
 14198             COMPUTE RWF-LFCLML ROUNDED =  RW-LFCLMWK *           ECSRIRTN
 14199                        (RWF-LFAMT / (CR-LFAMT + CR-LFAMT-ALT)).  ECSRIRTN
 14200                                                                  ECSRIRTN
 14201     IF CR-LFAMT = ZERO                                           ECSRIRTN
 14202         IF WT-LF-LIM-LO = ZERO                                   ECSRIRTN
 14203             COMPUTE RWF-LFCLML ROUNDED =                         ECSRIRTN
 14204                       RW-LFCLMWK * WT-LF-PCT.                    ECSRIRTN
 14205                                                                  ECSRIRTN
 14206     IF CO-SUB NOT = ZERO                                         ECSRIRTN
 14207         IF RCT-LF-CLM-PCT (CO-SUB) NOT = ZERO                    ECSRIRTN
 14208             COMPUTE RWF-LFCLML ROUNDED =                         ECSRIRTN
 14209                          RW-LFCLMWK * RCT-LF-CLM-PCT (CO-SUB).   ECSRIRTN
 14210                                                                  ECSRIRTN
 14211     IF CO-SUB NOT = ZERO                                         ECSRIRTN
 14212         IF RCT-LF-CLM-MAX (CO-SUB) NOT = ZERO                    ECSRIRTN
 14213             IF REIN-RT-SW = 'X'                                  ECSRIRTN
 14214               IF RWF-LFCLML GREATER RCT-LF-CLM-MAX (CO-SUB)      ECSRIRTN
 14215                     MOVE RCT-LF-CLM-MAX (CO-SUB) TO RWF-LFCLM    ECSRIRTN
 14216                      GO TO REINSURE-CALC-CLAIM-AH                ECSRIRTN
 14217                  ELSE                                            ECSRIRTN
 14218                     MOVE RWF-LFCLML TO RWF-LFCLM                 ECSRIRTN
 14219                      GO TO REINSURE-CALC-CLAIM-AH                ECSRIRTN
 14220              ELSE                                                ECSRIRTN
 14221                 IF (RWF-LFCLML + RWF-LFCLM) GREATER              ECSRIRTN
 14222                                           RCT-LF-CLM-MAX (CO-SUB)ECSRIRTN
 14223                     COMPUTE RWF-LFCLML =                         ECSRIRTN
 14224                               RCT-LF-CLM-MAX (CO-SUB) - RWF-LFCLMECSRIRTN
 14225                     MOVE RCT-LF-CLM-MAX (CO-SUB) TO RWF-LFCLM    ECSRIRTN
 14226                      GO TO REINSURE-CALC-CLAIM-AH.               ECSRIRTN
 14227                                                                  ECSRIRTN
 14228     ADD RWF-LFCLML TO RWF-LFCLM.                                 ECSRIRTN
 14229                                                                  ECSRIRTN
 14230     GO TO REINSURE-CALC-CLAIM-AH.                                ECSRIRTN
 14231                                                                  ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 275
* ECS010P.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 14232                                                                  ECSRIRTN
 14233 REINSURE-CALC-LF-RISK-CLAIM.                                     ECSRIRTN
 14234                                                                  ECSRIRTN
 14235     IF RWF-LFAMT NOT GREATER THAN +0                             ECSRIRTN
 14236         GO TO REINSURE-CALC-CLAIM-AH.                            ECSRIRTN
 14237                                                                  ECSRIRTN
 14238     IF CLAS-I-RL-AH (CLAS-INDEXL) = 'L'                          ECSRIRTN
 14239         MOVE RWF-LFAMT                   TO REIN-RISK-AMOUNT     ECSRIRTN
 14240     ELSE                                                         ECSRIRTN
 14241         COMPUTE REIN-RISK-AMOUNT = RWF-LFAMT -                   ECSRIRTN
 14242                ((RS-LIFE-BEN / CR-LF-TERM) * REIN-LF-CLM-MONTHS).ECSRIRTN
 14243                                                                  ECSRIRTN
 14244     IF REIN-RISK-AMOUNT NOT GREATER THAN +0                      ECSRIRTN
 14245         GO TO REINSURE-CALC-CLAIM-AH.                            ECSRIRTN
 14246                                                                  ECSRIRTN
 14247     IF REIN-RT-SW = 'X'                                          ECSRIRTN
 14248         IF RW-LFCLMWK GREATER THAN REIN-RISK-AMOUNT              ECSRIRTN
 14249             MOVE REIN-RISK-AMOUNT        TO RWF-LFCLM            ECSRIRTN
 14250         ELSE                                                     ECSRIRTN
 14251             MOVE RW-LFCLMWK              TO RWF-LFCLM            ECSRIRTN
 14252     ELSE                                                         ECSRIRTN
 14253         IF (RW-LFCLMWK + RWF-LFCLM) GREATER THAN REIN-RISK-AMOUNTECSRIRTN
 14254             COMPUTE RWF-LFCLML = REIN-RISK-AMOUNT - RWF-LFCLM    ECSRIRTN
 14255             MOVE REIN-RISK-AMOUNT        TO RWF-LFCLM            ECSRIRTN
 14256         ELSE                                                     ECSRIRTN
 14257             MOVE RW-LFCLMWK              TO RWF-LFCLML           ECSRIRTN
 14258             ADD RW-LFCLMWK TO RWF-LFCLM.                         ECSRIRTN
 14259                                                                  ECSRIRTN
 14260                                                                  ECSRIRTN
 14261 REINSURE-CALC-CLAIM-AH.                                          ECSRIRTN
 14262                                                                  ECSRIRTN
 14263     IF REIN-AH-FLG (SUB1) NOT = 'X'                              ECSRIRTN
 14264         GO TO REINSURE-CALC-CLAIM-X.                             ECSRIRTN
 14265                                                                  ECSRIRTN
 14266     IF RW-AHCLMWK = ZEROS                                        ECSRIRTN
 14267         GO TO REINSURE-CALC-CLAIM-SKIP.                          ECSRIRTN
 14268                                                                  ECSRIRTN
 14269     IF REIN-RT-SW NOT = 'X'                                      ECSRIRTN
 14270         GO TO REINSURE-CALC-AH-DETAIL.                           ECSRIRTN
 14271                                                                  ECSRIRTN
 14272     MOVE CR-DISAB-INCURRED-DETAIL    TO RW-AH-INCURRED-DETAIL.   ECSRIRTN
 14273     MOVE ZEROS                       TO RW-AHCLMWK.              ECSRIRTN
 14274                                                                  ECSRIRTN
 14275     PERFORM CHECK-MULTIPLE-DISABILITIES THRU CHECK-DISABS-EXIT   ECSRIRTN
 14276             VARYING                                              ECSRIRTN
 14277         INC-SUB FROM +1 BY +1                                    ECSRIRTN
 14278             UNTIL                                                ECSRIRTN
 14279         INC-SUB GREATER THAN +5.                                 ECSRIRTN
 14280                                                                  ECSRIRTN
 14281     IF RW-AHCLMWK = ZEROS                                        ECSRIRTN
 14282         GO TO REINSURE-CALC-CLAIM-SKIP                           ECSRIRTN
 14283     ELSE                                                         ECSRIRTN
 14284         GO TO REINSURE-CALC-AH-CONTINUED.                        ECSRIRTN
 14285                                                                  ECSRIRTN
 14286 CHECK-MULTIPLE-DISABILITIES.                                     ECSRIRTN
 14287                                                                  ECSRIRTN
 14288     IF RW-AH-INCUR-DT (INC-SUB) = ZEROS                          ECSRIRTN
 14289         GO TO CHECK-DISABS-EXIT.                                 ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 276
* ECS010P.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 14290                                                                  ECSRIRTN
 14291     IF CO-SUB NOT = ZERO                                         ECSRIRTN
 14292       IF RCT-CLM-CUTOFF-DT (CO-SUB) NOT = ZERO                   ECSRIRTN
 14293           IF RW-AH-INCUR-DT (INC-SUB) LESS THAN                  ECSRIRTN
 14294                       RCT-CLM-CUTOFF-DT (CO-SUB)                    CL**5
 14295               MOVE ZEROS             TO RW-AH-CLM-AMT (INC-SUB)  ECSRIRTN
 14296                                         RW-AH-CLM-EXP (INC-SUB)  ECSRIRTN
 14297               GO TO CHECK-DISABS-EXIT.                           ECSRIRTN
 14298                                                                  ECSRIRTN
 14299     IF RWF-AH-RUNOFF-SW = 'N'                                    ECSRIRTN
 14300       IF RW-AH-INCUR-DT (INC-SUB) NOT LESS THAN RWF-EP-STOP-DATE ECSRIRTN
 14301           MOVE ZEROS                 TO RW-AH-CLM-AMT (INC-SUB)  ECSRIRTN
 14302                                         RW-AH-CLM-EXP (INC-SUB)  ECSRIRTN
 14303           GO TO CHECK-DISABS-EXIT.                               ECSRIRTN
 14304                                                                  ECSRIRTN
 14305     IF WT-REMAINING NOT = 'I'                                    ECSRIRTN
 14306         COMPUTE RW-AHCLMWK = RW-AHCLMWK                          ECSRIRTN
 14307                             + RW-AH-CLM-AMT (INC-SUB)            ECSRIRTN
 14308                             + RW-AH-CLM-EXP (INC-SUB)            ECSRIRTN
 14309         GO TO CHECK-DISABS-EXIT.                                 ECSRIRTN
 14310                                                                  ECSRIRTN
 14311     IF RWF-AHAMT NOT GREATER THAN +0                             ECSRIRTN
 14312         GO TO CHECK-DISABS-EXIT.                                 ECSRIRTN
 14313                                                                  ECSRIRTN
 14314     IF INC-SUB = +1                                              ECSRIRTN
 14315         MOVE REIN-AH-CLM-MTH-1       TO REIN-AH-CLM-MONTHS.      ECSRIRTN
 14316     IF INC-SUB = +2                                              ECSRIRTN
 14317         MOVE REIN-AH-CLM-MTH-2       TO REIN-AH-CLM-MONTHS.      ECSRIRTN
 14318     IF INC-SUB = +3                                              ECSRIRTN
 14319         MOVE REIN-AH-CLM-MTH-3       TO REIN-AH-CLM-MONTHS.      ECSRIRTN
 14320     IF INC-SUB = +4                                              ECSRIRTN
 14321         MOVE REIN-AH-CLM-MTH-4       TO REIN-AH-CLM-MONTHS.      ECSRIRTN
 14322     IF INC-SUB = +5                                              ECSRIRTN
 14323         MOVE REIN-AH-CLM-MTH-5       TO REIN-AH-CLM-MONTHS.      ECSRIRTN
 14324                                                                  ECSRIRTN
 14325     COMPUTE REIN-RISK-AMOUNT = (RWF-AHAMT * CR-AH-TERM) -        ECSRIRTN
 14326                                (RS-AH-BEN * REIN-AH-CLM-MONTHS). ECSRIRTN
 14327                                                                  ECSRIRTN
 14328     IF REIN-RISK-AMOUNT NOT GREATER THAN +0                      ECSRIRTN
 14329         GO TO CHECK-DISABS-EXIT.                                 ECSRIRTN
 14330                                                                  ECSRIRTN
 14331     IF (RW-AH-CLM-AMT (INC-SUB) + RW-AH-CLM-EXP (INC-SUB))       ECSRIRTN
 14332              GREATER THAN REIN-RISK-AMOUNT                       ECSRIRTN
 14333         COMPUTE RW-AHCLMWK = RW-AHCLMWK + REIN-RISK-AMOUNT       ECSRIRTN
 14334     ELSE                                                         ECSRIRTN
 14335         COMPUTE RW-AHCLMWK = RW-AHCLMWK                          ECSRIRTN
 14336                             + RW-AH-CLM-AMT (INC-SUB)            ECSRIRTN
 14337                             + RW-AH-CLM-EXP (INC-SUB).           ECSRIRTN
 14338                                                                  ECSRIRTN
 14339 CHECK-DISABS-EXIT.                                               ECSRIRTN
 14340      EXIT.                                                       ECSRIRTN
 14341                                                                  ECSRIRTN
 14342 REINSURE-CALC-AH-DETAIL.                                         ECSRIRTN
 14343                                                                  ECSRIRTN
 14344     IF RW-AHCLMWK = ZEROS                                        ECSRIRTN
 14345         GO TO REINSURE-CALC-CLAIM-SKIP.                          ECSRIRTN
 14346                                                                  ECSRIRTN
 14347     IF CO-SUB NOT = ZERO                                         ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 277
* ECS010P.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 14348         IF RCT-CLM-CUTOFF-DT (CO-SUB) NOT = ZERO                 ECSRIRTN
 14349             IF CR-DIS-DT LESS RCT-CLM-CUTOFF-DT (CO-SUB)            CL*11
 14350                 GO TO REINSURE-CALC-CLAIM-SKIP.                  ECSRIRTN
 14351                                                                  ECSRIRTN
 14352     IF RWF-AH-RUNOFF-SW = 'N'                                    ECSRIRTN
 14353         IF CR-DIS-DT NOT LESS THAN RWF-EP-STOP-DATE                 CL**6
 14354             GO TO REINSURE-CALC-CLAIM-SKIP.                      ECSRIRTN
 14355                                                                  ECSRIRTN
 14356 REINSURE-CALC-AH-CONTINUED.                                      ECSRIRTN
 14357                                                                  ECSRIRTN
 14358     IF RWF-REM-AH-100 = 'Y'                                      ECSRIRTN
 14359         MOVE RW-AHCLMWK TO RWF-AHCLML                            ECSRIRTN
 14360         PERFORM REINSURE-SUB-REM-CLAIM THRU                      ECSRIRTN
 14361             REINSURE-SUB-REM-CLAIM-X                             ECSRIRTN
 14362                 VARYING SUB2 FROM +1 BY +1 UNTIL SUB2 = SUB1     ECSRIRTN
 14363         ADD RWF-AHCLML TO RWF-AHCLM                              ECSRIRTN
 14364         GO TO REINSURE-CALC-CLAIM-SKIP.                          ECSRIRTN
 14365                                                                  ECSRIRTN
 14366     IF WT-REMAINING = 'I'                                        ECSRIRTN
 14367         GO TO REINSURE-CALC-AH-RISK-CLAIM.                       ECSRIRTN
 14368                                                                  ECSRIRTN
 14369     IF WT-REMAINING = 'L'                                        ECSRIRTN
 14370         IF REIN-RT-SW = 'X'                                      ECSRIRTN
 14371             IF RW-AHCLMWK GREATER WT-AHBEN-HI                    ECSRIRTN
 14372                 MOVE WT-AHBEN-HI TO RWF-AHCLM                    ECSRIRTN
 14373             ELSE                                                 ECSRIRTN
 14374                 MOVE RW-AHCLMWK TO RWF-AHCLM                     ECSRIRTN
 14375         ELSE                                                     ECSRIRTN
 14376             IF (RW-AHCLMWK + RWF-AHCLM) GREATER WT-AHBEN-HI      ECSRIRTN
 14377                 COMPUTE RWF-AHCLML = WT-AHBEN-HI - RWF-AHCLM     ECSRIRTN
 14378                 MOVE WT-AHBEN-HI TO RWF-AHCLM                    ECSRIRTN
 14379             ELSE                                                 ECSRIRTN
 14380                 MOVE RW-AHCLMWK TO RWF-AHCLML                    ECSRIRTN
 14381                 ADD RWF-AHCLML TO RWF-AHCLM.                     ECSRIRTN
 14382                                                                  ECSRIRTN
 14383     IF WT-REMAINING = 'L'                                        ECSRIRTN
 14384         GO TO REINSURE-CALC-CLAIM-SKIP.                          ECSRIRTN
 14385                                                                  ECSRIRTN
 14386     IF CR-AHAMT NOT = ZERO                                       ECSRIRTN
 14387         COMPUTE RWF-AHCLML ROUNDED = (RW-AHCLMWK *               ECSRIRTN
 14388                            RWF-AHAMT) / CR-AHAMT                 ECSRIRTN
 14389     ELSE                                                         ECSRIRTN
 14390         IF RWF-AH-LIMIT = ZERO                                   ECSRIRTN
 14391             COMPUTE RWF-AHCLML ROUNDED =                         ECSRIRTN
 14392                       RW-AHCLMWK * WT-AH-PCT.                    ECSRIRTN
 14393                                                                  ECSRIRTN
 14394     IF CO-SUB NOT = ZERO                                         ECSRIRTN
 14395         IF RCT-AH-CLM-PCT (CO-SUB) NOT = ZERO                    ECSRIRTN
 14396             COMPUTE RWF-AHCLML ROUNDED =                         ECSRIRTN
 14397                           RW-AHCLMWK * RCT-AH-CLM-PCT (CO-SUB).  ECSRIRTN
 14398                                                                  ECSRIRTN
 14399     IF CO-SUB NOT = ZERO                                         ECSRIRTN
 14400         IF RCT-AH-CLM-MAX (CO-SUB) NOT = ZERO                    ECSRIRTN
 14401             IF REIN-RT-SW = 'X'                                  ECSRIRTN
 14402               IF RWF-AHCLML GREATER RCT-AH-CLM-MAX (CO-SUB)      ECSRIRTN
 14403                     MOVE RCT-AH-CLM-MAX (CO-SUB) TO RWF-AHCLM    ECSRIRTN
 14404                      GO TO REINSURE-CALC-CLAIM-SKIP              ECSRIRTN
 14405                  ELSE                                            ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 278
* ECS010P.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 14406                     MOVE RWF-AHCLML TO RWF-AHCLM                 ECSRIRTN
 14407                      GO TO REINSURE-CALC-CLAIM-SKIP              ECSRIRTN
 14408              ELSE                                                ECSRIRTN
 14409                 IF (RWF-AHCLML + RWF-AHCLM) GREATER              ECSRIRTN
 14410                                           RCT-AH-CLM-MAX (CO-SUB)ECSRIRTN
 14411                     COMPUTE RWF-AHCLML =                         ECSRIRTN
 14412                               RCT-AH-CLM-MAX (CO-SUB) - RWF-AHCLMECSRIRTN
 14413                     MOVE RCT-AH-CLM-MAX (CO-SUB) TO RWF-AHCLM    ECSRIRTN
 14414                      GO TO REINSURE-CALC-CLAIM-SKIP.             ECSRIRTN
 14415                                                                  ECSRIRTN
 14416                                                                  ECSRIRTN
 14417     IF DTE-CLIENT = 'FLA'                                        ECSRIRTN
 14418        IF REIN-COMP (SUB1) = ('200000' OR '210000' OR            ECSRIRTN
 14419                               '220000' OR '230000')              ECSRIRTN
 14420           PERFORM FLA-SPEC-REIN-CLMS THRU                        ECSRIRTN
 14421               E-FLA-SPEC-REIN-CLMS.                              ECSRIRTN
 14422                                                                  ECSRIRTN
 14423     ADD RWF-AHCLML TO RWF-AHCLM.                                 ECSRIRTN
 14424                                                                  ECSRIRTN
 14425     GO TO REINSURE-CALC-CLAIM-SKIP.                              ECSRIRTN
 14426                                                                  ECSRIRTN
 14427                                                                  ECSRIRTN
 14428 REINSURE-CALC-AH-RISK-CLAIM.                                     ECSRIRTN
 14429                                                                  ECSRIRTN
 14430     IF RWF-AHAMT NOT GREATER THAN +0                             ECSRIRTN
 14431         GO TO REINSURE-CALC-CLAIM-SKIP.                          ECSRIRTN
 14432                                                                  ECSRIRTN
 14433     IF REIN-RT-SW = 'X'                                          ECSRIRTN
 14434         MOVE RW-AHCLMWK              TO RWF-AHCLM                ECSRIRTN
 14435         GO TO REINSURE-CALC-CLAIM-SKIP.                          ECSRIRTN
 14436                                                                  ECSRIRTN
 14437     COMPUTE REIN-RISK-AMOUNT = (RWF-AHAMT * CR-AH-TERM) -        ECSRIRTN
 14438                                (RS-AH-BEN * REIN-AH-CLM-MONTHS). ECSRIRTN
 14439                                                                  ECSRIRTN
 14440     IF REIN-RISK-AMOUNT NOT GREATER THAN +0                      ECSRIRTN
 14441         GO TO REINSURE-CALC-CLAIM-SKIP.                          ECSRIRTN
 14442                                                                  ECSRIRTN
 14443     IF REIN-AH-PRIOR-CLMS-PAID GREATER THAN REIN-RISK-AMOUNT     ECSRIRTN
 14444         GO TO REINSURE-CALC-CLAIM-SKIP.                          ECSRIRTN
 14445                                                                  ECSRIRTN
 14446     IF (RW-AHCLMWK + REIN-AH-PRIOR-CLMS-PAID)                    ECSRIRTN
 14447                                GREATER THAN REIN-RISK-AMOUNT     ECSRIRTN
 14448         COMPUTE RWF-AHCLML = REIN-RISK-AMOUNT                    ECSRIRTN
 14449                             - REIN-AH-PRIOR-CLMS-PAID            ECSRIRTN
 14450         MOVE REIN-RISK-AMOUNT        TO RWF-AHCLM                ECSRIRTN
 14451     ELSE                                                         ECSRIRTN
 14452         MOVE RW-AHCLMWK              TO RWF-AHCLML               ECSRIRTN
 14453         ADD RW-AHCLMWK TO RWF-AHCLM.                             ECSRIRTN
 14454                                                                  ECSRIRTN
 14455                                                                  ECSRIRTN
 14456 REINSURE-CALC-CLAIM-SKIP.                                        ECSRIRTN
 14457                                                                  ECSRIRTN
 14458     IF RWF-LFCLM NOT = ZEROS                                     ECSRIRTN
 14459         MOVE 'X' TO REIN-LF-FLG (SUB1).                          ECSRIRTN
 14460                                                                  ECSRIRTN
 14461     IF RWF-AHCLM NOT = ZEROS                                     ECSRIRTN
 14462         MOVE 'X' TO REIN-AH-FLG (SUB1).                          ECSRIRTN
 14463                                                                  ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 279
* ECS010P.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 14464     GO TO REINSURE-CALC-CLAIM-X.                                 ECSRIRTN
 14465                                                                  ECSRIRTN
 14466 REINSURE-REMAINDER-CLAIM.                                        ECSRIRTN
 14467                                                                  ECSRIRTN
 14468     MOVE RW-LFCLMWK TO RWF-LFCLML.                               ECSRIRTN
 14469     MOVE RW-AHCLMWK TO RWF-AHCLML.                               ECSRIRTN
 14470                                                                  ECSRIRTN
 14471     PERFORM REINSURE-SUBTRACT-CLAIM THRU                         ECSRIRTN
 14472         REINSURE-SUBTRACT-CLAIM-X                                ECSRIRTN
 14473             VARYING SUB2 FROM +1 BY +1 UNTIL SUB2 = SUB1.        ECSRIRTN
 14474                                                                  ECSRIRTN
 14475     ADD RWF-LFCLML TO RWF-LFCLM.                                 ECSRIRTN
 14476     ADD RWF-AHCLML TO RWF-AHCLM.                                 ECSRIRTN
 14477                                                                  ECSRIRTN
 14478     IF RWF-LFCLM NOT = ZEROS                                     ECSRIRTN
 14479         MOVE 'X' TO REIN-LF-FLG (SUB1).                          ECSRIRTN
 14480                                                                  ECSRIRTN
 14481     IF RWF-AHCLM NOT = ZEROS                                     ECSRIRTN
 14482         MOVE 'X' TO REIN-AH-FLG (SUB1).                          ECSRIRTN
 14483                                                                  ECSRIRTN
 14484 REINSURE-CALC-CLAIM-X.                                           ECSRIRTN
 14485                                                                  ECSRIRTN
 14486     IF REIN-LF-AH-FLGS (SUB1) NOT = SPACES                       ECSRIRTN
 14487         MOVE 'X' TO REIN-BUS-FLAG.                               ECSRIRTN
 14488                                                                  ECSRIRTN
 14489     MOVE RWF-FIELDS TO REIN-WORK-FLDS (SUB1).                    ECSRIRTN
 14490                                                                  ECSRIRTN
 14491 REINSURE-SUBTRACT-CLAIM.                                         ECSRIRTN
 14492                                                                  ECSRIRTN
 14493     SUBTRACT REIN-LFCLML (SUB2) FROM RWF-LFCLML.                 ECSRIRTN
 14494     SUBTRACT REIN-AHCLML (SUB2) FROM RWF-AHCLML.                 ECSRIRTN
 14495                                                                  ECSRIRTN
 14496 REINSURE-SUBTRACT-CLAIM-X.                                       ECSRIRTN
 14497     EXIT.                                                        ECSRIRTN
 14498                                                                  ECSRIRTN
 14499 REINSURE-SUB-REM-CLAIM.                                          ECSRIRTN
 14500                                                                  ECSRIRTN
 14501     IF REIN-REM-SW (SUB2) = 'Y' OR 'Z' OR 'X' OR 'N'             ECSRIRTN
 14502         SUBTRACT REIN-AHCLML (SUB2) FROM RWF-AHCLML.             ECSRIRTN
 14503                                                                  ECSRIRTN
 14504 REINSURE-SUB-REM-CLAIM-X.                                        ECSRIRTN
 14505     EXIT.                                                        ECSRIRTN
 14506                                                                  ECSRIRTN
 14507                                                                  ECSRIRTN
 14508 CLEAR-REIN-HOLD.                                                 ECSRIRTN
 14509                                                                  ECSRIRTN
 14510     MOVE SPACES TO REIN-COMP (1).                                ECSRIRTN
 14511     MOVE SPACES TO REIN-LF-AH-FLGS (1).                          ECSRIRTN
 14512     MOVE SPACES TO REIN-REM-SW (1).                              ECSRIRTN
 14513     MOVE SPACES TO REIN-REM-AH-100 (1).                          ECSRIRTN
 14514                                                                  ECSRIRTN
 14515     MOVE +0 TO REIN-LFAMT (1)  REIN-LFPRM (1)  REIN-AHAMT (1)    ECSRIRTN
 14516         REIN-AHPRM (1)  REIN-LFRFND (1)  REIN-AHRFND (1)         ECSRIRTN
 14517         REIN-LFCLM (1)  REIN-AHCLM (1)  REIN-LFCLML (1)          ECSRIRTN
 14518         REIN-AHCLML (1)  REIN-DIS-IBNR (1)  REIN-DIS-PAYCUR (1)  ECSRIRTN
 14519         REIN-DIS-FUTRSV (1)  REIN-DTH-IBNR (1)                   ECSRIRTN
 14520         REIN-DTH-PAYCUR (1)  REIN-DTH-FUTRSV (1)                 ECSRIRTN
 14521         REIN-DIS-IBNRL (1)  REIN-DIS-PAYCURL (1)                 ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 280
* ECS010P.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 14522         REIN-DIS-FUTRSVL (1)  REIN-DTH-IBNRL (1)                 ECSRIRTN
 14523         REIN-DTH-PAYCURL (1)  REIN-DTH-FUTRSVL (1)               ECSRIRTN
 14524         REIN-AH-LIMIT (1).                                       ECSRIRTN
 14525                                                                  ECSRIRTN
 14526     PERFORM CLEAR-REIN-HOLD-ALL VARYING SUB1 FROM 2 BY 1         ECSRIRTN
 14527         UNTIL REIN-COMP (SUB1) = SPACES.                         ECSRIRTN
 14528                                                                  ECSRIRTN
 14529     GO TO CLEAR-REIN-HOLD-X.                                     ECSRIRTN
 14530                                                                  ECSRIRTN
 14531 CLEAR-REIN-HOLD-ALL.                                             ECSRIRTN
 14532                                                                  ECSRIRTN
 14533     MOVE REIN-LEVELS (1) TO REIN-LEVELS (SUB1).                  ECSRIRTN
 14534                                                                  ECSRIRTN
 14535 CLEAR-REIN-HOLD-X.                                               ECSRIRTN
 14536     EXIT.                                                        ECSRIRTN
 14537                                                                  ECSRIRTN
 14538 FLA-SPEC-REIN-CLMS.                                              ECSRIRTN
 14539                                                                  ECSRIRTN
 14540     MOVE +250.00 TO FLA-CLM-REIN-BASE  ADJ-FLA-REIN-BASE.        ECSRIRTN
 14541                                                                  ECSRIRTN
 14542     IF REIN-COMP (SUB1) = '230000'                               ECSRIRTN
 14543         MOVE +100.00 TO FLA-CLM-REIN-BASE  ADJ-FLA-REIN-BASE.    ECSRIRTN
 14544                                                                  ECSRIRTN
 14545     IF CR-AHAMT NOT = ZERO                                       ECSRIRTN
 14546         COMPUTE ADJ-FLA-REIN-BASE ROUNDED =                      ECSRIRTN
 14547             (RW-AHCLMWK / CR-AHAMT) * FLA-CLM-REIN-BASE.         ECSRIRTN
 14548                                                                  ECSRIRTN
 14549     IF REIN-RT-SW = 'X'                                          ECSRIRTN
 14550         MOVE CR-DIS-CC TO CIRD-CC                                ECSRIRTN
 14551         MOVE CR-DIS-YR TO CIRD-YR                                ECSRIRTN
 14552         MOVE CR-DIS-MO TO CIRD-MO                                ECSRIRTN
 14553     ELSE                                                         ECSRIRTN
 14554         MOVE DTO-CC    TO CIRD-CC                                ECSRIRTN
 14555         MOVE DTO-YR    TO CIRD-YR                                ECSRIRTN
 14556         MOVE DTO-MO    TO CIRD-MO.                               ECSRIRTN
 14557                                                                  ECSRIRTN
 14558     MOVE ZEROS TO RWF-AHCLML.                                    ECSRIRTN
 14559                                                                  ECSRIRTN
 14560     IF CLM-INCUR-REIN-DATE LESS '197809'  AND                    ECSRIRTN
 14561        CR-AHAMT GREATER FLA-CLM-REIN-BASE                        ECSRIRTN
 14562         COMPUTE RWF-AHCLML = RW-AHCLMWK - ADJ-FLA-REIN-BASE.     ECSRIRTN
 14563                                                                  ECSRIRTN
 14564     IF CLM-INCUR-REIN-DATE GREATER '197806'                      ECSRIRTN
 14565         COMPUTE RWF-AHCLML = RWF-AHCLML + (RW-AHCLMWK * +.9).    ECSRIRTN
 14566                                                                  ECSRIRTN
 14567 E-FLA-SPEC-REIN-CLMS.                                            ECSRIRTN
 14568     EXIT.                                                        ECSRIRTN
 14569                                                                  ECSRIRTN
 14570 REIN-FIND-CO-LOOP.                                               ECSRIRTN
 14571                                                                  ECSRIRTN
 14572     CONTINUE.                                                    ECSRIRTN
 14573*  DUMMY PARAGRAPH - NO CODE NEEDED.                              ECSRIRTN
 14574 FIND-REI-CO-EXIT.                                                ECSRIRTN
 14575     EXIT.                                                        ECSRIRTN
 14576                                                                  ECSRIRTN
 14577 REIN-CO-TABLE-BUILD.                                             ECSRIRTN
 14578                                                                  ECSRIRTN
 14579     PERFORM ZERO-RCT-ENTRIES THRU ZERO-RCT-EXIT                  ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 281
* ECS010P.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 14580         VARYING CO-SUB FROM 1 BY 1                               ECSRIRTN
 14581                   UNTIL CO-SUB GREATER REIN-CO-TABLE-ENT-CNT.    ECSRIRTN
 14582                                                                  ECSRIRTN
 14583     PERFORM ZERO-RC2-ENTRIES THRU ZERO-RC2-EXIT                  ECSRIRTN
 14584         VARYING CO-SUB FROM 1 BY 1                               ECSRIRTN
 14585                   UNTIL CO-SUB GREATER REIN-CO-TABLE-ENT-CNT.    ECSRIRTN
 14586                                                                  ECSRIRTN
 14587     MOVE LOW-VALUES          TO RE-CONTROL-PRIMARY.              ECSRIRTN
 14588                                                                  ECSRIRTN
 14589     START ERRTBL-IN                                              ECSRIRTN
 14590           KEY IS GREATER THAN RE-CONTROL-PRIMARY                 ECSRIRTN
 14591             INVALID KEY                                          ECSRIRTN
 14592               GO TO REIN-BUILD-EXIT.                             ECSRIRTN
 14593                                                                  ECSRIRTN
 14594     MOVE 0 TO CO-SUB.                                            ECSRIRTN
 14595     MOVE 0 TO SUB1.                                              ECSRIRTN
 14596 REIN-CO-BUILD-LOOP.                                              ECSRIRTN
 14597                                                                  ECSRIRTN
 14598     READ ERRTBL-IN  NEXT RECORD.                                 ECSRIRTN
 14599                                                                  ECSRIRTN
 14600     IF ERRTBL-FILE-STATUS = '10'                                 ECSRIRTN
 14601        GO TO REIN-BUILD-EXIT.                                    ECSRIRTN
 14602                                                                  ECSRIRTN
 14603     IF ERRTBL-FILE-STATUS NOT = ZERO                             ECSRIRTN
 14604        MOVE ERRTBL-FILE-STATUS TO WS-ABEND-FILE-STATUS           ECSRIRTN
 14605        MOVE 'READ ERROR ON FILE - ERRTBL'                        ECSRIRTN
 14606                                  TO WS-ABEND-MESSAGE             ECSRIRTN
 14607        GO TO ABEND-PGM.                                          ECSRIRTN
 14608                                                                  ECSRIRTN
 14609     IF RE-CODE NOT = 'B'                                         ECSRIRTN
 14610        GO TO REIN-CO-BUILD-LOOP.                                 ECSRIRTN
 14611                                                                  ECSRIRTN
 14612     IF RE-CLM-INCURRED-LIM NOT NUMERIC                           ECSRIRTN
 14613        MOVE ZERO TO RE-CLM-INCURRED-LIM.                         ECSRIRTN
 14614                                                                  ECSRIRTN
 14615     IF RE-EARNING-START-DT NOT NUMERIC                           ECSRIRTN
 14616        MOVE ZERO TO RE-EARNING-START-DT.                         ECSRIRTN
 14617                                                                  ECSRIRTN
 14618     IF RE-EARNING-STOP-DT NOT NUMERIC                            ECSRIRTN
 14619        MOVE ZERO TO RE-EARNING-STOP-DT.                          ECSRIRTN
 14620                                                                  ECSRIRTN
 14621     PERFORM VARYING CPSE-NDX FROM 1 BY 1 UNTIL CPSE-NDX > 1500   ECSRIRTN
 14622        MOVE RCT-CLM-CUTOFF-DT (CPSE-NDX)                         ECSRIRTN
*1118-E***************************************                         ( 188)**
**    Index-name belongs to different table - unexpected behaviour may occur
 14623                        TO  WS-RCT-CLM-CUTOFF-DT-N (CPSE-NDX)        CL*12
 14624        MOVE RCT-EARNING-START-DT (CPSE-NDX)                      ECSRIRTN
*1118-E******************************************                      ( 281)**
**    Index-name belongs to different table - unexpected behaviour may occur
 14625                        TO  WS-RCT-EARNING-START-DT-N (CPSE-NDX)     CL*12
 14626        MOVE RCT-EARNING-STOP-DT (CPSE-NDX)                       ECSRIRTN
*1118-E*****************************************                       ( 281)**
**    Index-name belongs to different table - unexpected behaviour may occur
 14627                        TO  WS-RCT-EARNING-STOP-DT-N (CPSE-NDX)      CL*12
 14628     END-PERFORM.                                                 ECSRIRTN
 14629     MOVE RWF-EP-STOP-DATE       TO  WS-RWF-EP-STOP-DATE-N.          CL*12
 14630                                                                  ECSRIRTN
 14631     IF RE-LF-CLM-PCT NOT NUMERIC                                 ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 282
* ECS010P.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 14632        MOVE ZERO TO RE-LF-CLM-PCT.                               ECSRIRTN
 14633                                                                  ECSRIRTN
 14634     IF RE-AH-CLM-PCT NOT NUMERIC                                 ECSRIRTN
 14635        MOVE ZERO TO RE-AH-CLM-PCT.                               ECSRIRTN
 14636                                                                  ECSRIRTN
 14637     IF RE-LF-CLM-MAX NOT NUMERIC                                 ECSRIRTN
 14638        MOVE ZERO TO RE-LF-CLM-MAX.                               ECSRIRTN
 14639                                                                  ECSRIRTN
 14640     IF RE-AH-CLM-MAX NOT NUMERIC                                 ECSRIRTN
 14641        MOVE ZERO TO RE-AH-CLM-MAX.                               ECSRIRTN
 14642                                                                  ECSRIRTN
 14643     IF (RE-AH-CLM-MAX = ZERO) AND                                ECSRIRTN
 14644        (RE-LF-CLM-MAX = ZERO) AND                                ECSRIRTN
 14645        (RE-AH-CLM-PCT = ZERO) AND                                ECSRIRTN
 14646        (RE-LF-CLM-PCT = ZERO) AND                                ECSRIRTN
 14647        (RE-CLM-INCURRED-LIM = ZERO) AND                          ECSRIRTN
 14648        (RE-EARNING-START-DT = ZERO) AND                          ECSRIRTN
 14649        (RE-EARNING-STOP-DT = ZERO)                               ECSRIRTN
 14650          GO TO REIN-CO-BUILD-EPR.                                ECSRIRTN
 14651                                                                  ECSRIRTN
 14652     ADD +1 TO CO-SUB.                                            ECSRIRTN
 14653                                                                  ECSRIRTN
 14654     IF CO-SUB GREATER REIN-CO-TABLE-ENT-CNT                      ECSRIRTN
 14655        MOVE 0202 TO WS-RETURN-CODE                               ECSRIRTN
 14656        DISPLAY 'REINSURANCE COMPANY SAVE TABLE EXCEEDED'         ECSRIRTN
 14657        DISPLAY 'ERROR DETECTED IN ECSRIRTN, SEE ECSRITAB'        ECSRIRTN
 14658        MOVE 'REINSURANCE COMPANY SAVE TABLE EXCEEDED'            ECSRIRTN
 14659                                  TO WS-ABEND-MESSAGE             ECSRIRTN
 14660        GO TO ABEND-PGM.                                          ECSRIRTN
 14661                                                                  ECSRIRTN
 14662     MOVE RE-COMPANY           TO RCT-REIN-CO (CO-SUB).              CL**7
 14663                                                                  ECSRIRTN
 14664     MOVE RE-CLM-INCURRED-LIM  TO RCT-CLM-CUTOFF-DT (CO-SUB)      ECSRIRTN
 14665                               WS-RCT-CLM-CUTOFF-DT-N (CO-SUB).      CL*12
 14666     MOVE RE-EARNING-START-DT  TO RCT-EARNING-START-DT (CO-SUB)   ECSRIRTN
 14667                               WS-RCT-EARNING-START-DT-N (CO-SUB).   CL*12
 14668     MOVE RE-EARNING-STOP-DT   TO RCT-EARNING-STOP-DT (CO-SUB)    ECSRIRTN
 14669                               WS-RCT-EARNING-STOP-DT-N (CO-SUB).    CL*12
 14670                                                                  ECSRIRTN
 14671     IF RE-EARN-STOP-CODE = 'A'  OR  'L'                          ECSRIRTN
 14672         MOVE RE-EARN-STOP-CODE  TO RCT-EARN-STOP-CODE (CO-SUB)   ECSRIRTN
 14673     ELSE                                                         ECSRIRTN
 14674         MOVE 'B'                TO RCT-EARN-STOP-CODE (CO-SUB).  ECSRIRTN
 14675                                                                  ECSRIRTN
 14676     MOVE RE-LF-CLM-PCT  TO RCT-LF-CLM-PCT (CO-SUB).              ECSRIRTN
 14677     MOVE RE-AH-CLM-PCT  TO RCT-AH-CLM-PCT (CO-SUB).              ECSRIRTN
 14678     MOVE RE-LF-CLM-MAX  TO RCT-LF-CLM-MAX (CO-SUB).              ECSRIRTN
 14679     MOVE RE-AH-CLM-MAX  TO RCT-AH-CLM-MAX (CO-SUB).              ECSRIRTN
 14680                                                                  ECSRIRTN
 14681 REIN-CO-BUILD-EPR.                                               ECSRIRTN
 14682                                                                  ECSRIRTN
 14683     IF RE-AH-PR-PCT  NOT NUMERIC                                 ECSRIRTN
 14684        MOVE ZERO TO RE-AH-PR-PCT.                                ECSRIRTN
 14685                                                                  ECSRIRTN
 14686     IF RE-AH-78-PCT  NOT NUMERIC                                 ECSRIRTN
 14687        MOVE ZERO TO RE-AH-78-PCT.                                ECSRIRTN
 14688                                                                  ECSRIRTN
 14689     IF RE-LF-PR-PCT  NOT NUMERIC                                 ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 283
* ECS010P.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 14690        MOVE ZERO TO RE-LF-PR-PCT.                                ECSRIRTN
 14691                                                                  ECSRIRTN
 14692     IF RE-LF-78-PCT  NOT NUMERIC                                 ECSRIRTN
 14693        MOVE ZERO TO RE-LF-78-PCT.                                ECSRIRTN
 14694                                                                  ECSRIRTN
 14695     ADD +1 TO SUB1.                                              ECSRIRTN
 14696                                                                  ECSRIRTN
 14697     IF SUB1 GREATER REIN-CO-TABLE-ENT-CNT                        ECSRIRTN
 14698        MOVE 0201 TO WS-RETURN-CODE                               ECSRIRTN
 14699        MOVE 'REINSURANCE COMPANY SAVE TABLE EXCEEDED'            ECSRIRTN
 14700                                  TO WS-ABEND-MESSAGE             ECSRIRTN
 14701        GO TO ABEND-PGM.                                          ECSRIRTN
 14702                                                                  ECSRIRTN
 14703     MOVE RE-COMPANY     TO RC2-REIN-CO    (SUB1).                ECSRIRTN
 14704     MOVE RE-AH-PR-PCT   TO RC2-AH-PRO-PCT (SUB1).                ECSRIRTN
 14705     MOVE RE-AH-78-PCT   TO RC2-AH-R78-PCT (SUB1).                ECSRIRTN
 14706     MOVE RE-LF-PR-PCT   TO RC2-LF-PRO-PCT (SUB1).                ECSRIRTN
 14707     MOVE RE-LF-78-PCT   TO RC2-LF-R78-PCT (SUB1).                ECSRIRTN
 14708     MOVE RE-NAME        TO RC2-CO-NAME    (SUB1).                ECSRIRTN
 14709     if re-state-exhibit-opt-f = 'Y'
 14710        move 'Y'         to rc2-ecs152-rpt (sub1)
 14711     else
 14712        move 'N'         to rc2-ecs152-rpt (sub1)
 14713     end-if
 14714                                                                  ECSRIRTN
 14715     GO TO REIN-CO-BUILD-LOOP.                                    ECSRIRTN
 14716                                                                  ECSRIRTN
 14717 REIN-BUILD-EXIT.                                                 ECSRIRTN
 14718     EXIT.                                                        ECSRIRTN
 14719                                                                  ECSRIRTN
 14720 ZERO-RCT-ENTRIES.                                                ECSRIRTN
 14721                                                                  ECSRIRTN
 14722     MOVE SPACES TO REIN-CO-HOLD-ENTRIES (CO-SUB).                ECSRIRTN
 14723                                                                  ECSRIRTN
 14724     MOVE ZERO   TO RCT-CLM-CUTOFF-DT (CO-SUB)                    ECSRIRTN
 14725                    WS-RCT-CLM-CUTOFF-DT-N (CO-SUB)                  CL*12
 14726                    RCT-EARNING-START-DT (CO-SUB)                 ECSRIRTN
 14727                    WS-RCT-EARNING-START-DT-N (CO-SUB)               CL*12
 14728                    RCT-EARNING-STOP-DT (CO-SUB)                  ECSRIRTN
 14729                    WS-RCT-EARNING-STOP-DT-N (CO-SUB)                CL*12
 14730                    RCT-LF-CLM-PCT    (CO-SUB)                    ECSRIRTN
 14731                    RCT-AH-CLM-PCT    (CO-SUB)                    ECSRIRTN
 14732                    RCT-LF-CLM-MAX    (CO-SUB)                    ECSRIRTN
 14733                    RCT-AH-CLM-MAX    (CO-SUB).                   ECSRIRTN
 14734                                                                  ECSRIRTN
 14735 ZERO-RCT-EXIT.                                                   ECSRIRTN
 14736     EXIT.                                                        ECSRIRTN
 14737                                                                  ECSRIRTN
 14738 ZERO-RC2-ENTRIES.                                                ECSRIRTN
 14739                                                                  ECSRIRTN
 14740     MOVE SPACES TO RC2-CO-NAME (CO-SUB)                          ECSRIRTN
 14741                    RC2-REIN-CO (CO-SUB).                         ECSRIRTN
 14742     move spaces      to rc2-ecs152-rpt (co-sub)
 14743                                                                  ECSRIRTN
 14744     MOVE ZERO   TO RC2-LF-R78-PCT    (CO-SUB)                    ECSRIRTN
 14745                    RC2-LF-PRO-PCT    (CO-SUB)                    ECSRIRTN
 14746                    RC2-AH-R78-PCT    (CO-SUB)                    ECSRIRTN
 14747                    RC2-AH-PRO-PCT    (CO-SUB).                   ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 284
* ECS010P.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 14748                                                                  ECSRIRTN
 14749 ZERO-RC2-EXIT.                                                   ECSRIRTN
 14750     EXIT.                                                        ECSRIRTN
 14751******************************************************************ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 285
* ECS010P.cbl
 14753******************************************************************
 14754***   R E C A L C U L A T I O N   O F   R E I N S U R A N C E  ***
 14755******************************************************************
 14756
 14757 3600-RC-REINSURANCE.
 14758
 14759     IF DTE-PGM-OPT NOT = '1'
 14760         GO TO 3799-RC-REINSURANCE-X.
 14761
 14762     IF DTE-CLIENT = 'WSL'
 14763         IF CR-REIN-TABLE = '00A'
 14764             GO TO 3799-RC-REINSURANCE-X.
 14765
 14766     IF CR-REIN-TABLE = SPACES OR ZEROS
 14767         PERFORM CLEAR-REIN-HOLD THRU CLEAR-REIN-HOLD-X.
 14768
 14769 3610-CLEAR-RC-REIN.
 14770
 14771     MOVE SPACES TO RC-REIN-LEVELS (1).
 14772     MOVE ZEROS  TO RC-REIN-LFAMT (1)
 14773                    RC-REIN-LFPRM (1)
 14774                    RC-REIN-AHAMT (1)
 14775                    RC-REIN-AHPRM (1)
 14776                    RC-REIN-LFRFND (1)
 14777                    RC-REIN-AHRFND (1)
 14778                    RC-REIN-LFCLM (1)
 14779                    RC-REIN-AHCLM (1).
 14780
 14781     PERFORM 3620-CLEAR-RC-LEVELS VARYING SUB1 FROM +2 BY +1
 14782         UNTIL RC-REIN-COMP (SUB1) = SPACES.
 14783
 14784     MOVE +1 TO SUB1.
 14785     MOVE +0 TO SUB2.
 14786
 14787     GO TO 3630-RC-REIN-LOOP-1.
 14788
 14789 3620-CLEAR-RC-LEVELS.
 14790
 14791     MOVE RC-REIN-LEVELS (1) TO RC-REIN-LEVELS (SUB1).
 14792
 14793
 14794 3630-RC-REIN-LOOP-1.
 14795
 14796     IF REIN-LF-AH-FLGS (SUB1) NOT = SPACES
 14797         ADD +1 TO SUB2
 14798         MOVE REIN-COMP (SUB1)   TO RC-REIN-COMP (SUB2)
 14799         MOVE REIN-LFAMT (SUB1)  TO RC-REIN-LFAMT (SUB2)
 14800         MOVE REIN-LFPRM (SUB1)  TO RC-REIN-LFPRM (SUB2)
 14801         MOVE REIN-AHAMT (SUB1)  TO RC-REIN-AHAMT (SUB2)
 14802         MOVE REIN-AHPRM (SUB1)  TO RC-REIN-AHPRM (SUB2)
 14803         MOVE REIN-LFRFND (SUB1) TO RC-REIN-LFRFND (SUB2)
 14804         MOVE REIN-AHRFND (SUB1) TO RC-REIN-AHRFND (SUB2)
 14805         MOVE REIN-LFCLM (SUB1)  TO RC-REIN-LFCLM (SUB2)
 14806         MOVE REIN-AHCLM (SUB1)  TO RC-REIN-AHCLM (SUB2)
 14807         MOVE REIN-REM-SW (SUB1) TO RC-REIN-REM-SW (SUB2).
 14808
 14809     ADD +1 TO SUB1.
 14810     IF REIN-COMP (SUB1) NOT = SPACES
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 286
* ECS010P.cbl
 14811         GO TO 3630-RC-REIN-LOOP-1.
 14812
 14813     PERFORM CLEAR-REIN-HOLD THRU CLEAR-REIN-HOLD-X.
 14814
 14815     MOVE AM-REI-TABLE TO CR-REIN-TABLE.
 14816     IF CR-REIN-TABLE = SPACES OR ZEROS
 14817         MOVE +1                     TO SUB1
 14818         GO TO 3710-RC-REIN-LOOP-2.
 14819
 14820     PERFORM 3010-RR-READ-REIN THRU 3019-RR-READ-REIN-X.
 14821
 14822 3640-NSP-REIN-RATING-ROUTINE.
 14823
 14824     MOVE CR-DT                      TO DC-GREG-DATE-CYMD.
 14825     MOVE 'L'                        TO DC-OPTION-CODE.
 14826     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 14827     MOVE DC-BIN-DATE-1              TO CP-CERT-EFF-DT.
 14828     MOVE SPACES                     TO CP-ACCT-FLD-5.
 14829     MOVE DTE-CLIENT                 TO CP-COMPANY-ID.
 14830     MOVE CR-AGE                     TO CP-ISSUE-AGE.
 14831     MOVE CR-APR                     TO CP-LOAN-APR.
 14832     MOVE CR-PMT-FREQ                TO CP-PAY-FREQUENCY.
 14833     MOVE CR-LOAN-TERM               TO CP-LOAN-TERM.
 14834     MOVE ZEROS                      TO CP-DEVIATION-CODE.
 14835     MOVE ZEROS                      TO CP-CLASS-CODE.
 14836
 14837     IF DTE-CLIENT = 'TIC'
 14838        IF CR-REIN-TABLE = '01T' OR '02T' OR '03T'
 14839            MOVE ZERO                TO CP-CLASS-CODE
 14840        ELSE
 14841            MOVE CR-RATING-CLASS     TO CP-CLASS-CODE.
 14842
 14843     MOVE '3'                        TO CP-PROCESS-TYPE.
 14844     MOVE DTE-CLASIC-COMPANY-CD      TO CP-COMPANY-CD.
 14845     MOVE CR-PMT-EXTENSION-DAYS      TO CP-TERM-OR-EXT-DAYS.
 14846
 14847 3650-NSP-REIN-LIFE.
 14848
 14849     IF CR-LFTYP = ZERO
 14850         GO TO 3660-NSP-REIN-AH.
 14851     IF (RE-NSP-ST-CD-LF = ZEROS OR SPACES)
 14852        OR (DTE-CLIENT = 'DCC')
 14853         GO TO 3660-NSP-REIN-AH.
 14854     IF DTE-CLIENT NOT = 'LBL'
 14855         IF (CLAS-I-BAL (CLAS-INDEXL) = 'B')
 14856             GO TO 3660-NSP-REIN-AH.
 14857
 14858     IF RE-NSP-ST-CD-LF NOT = STATE-L
 14859         MOVE RE-NSP-ST-CD-LF        TO STATE-L
 14860         PERFORM 8200-STATE-CODE-LOOKUP THRU 8299-STATE-LOOKUP-X.
 14861
 14862     MOVE CLAS-I-RL-AH (CLAS-INDEXL) TO CP-BENEFIT-TYPE.
 14863     MOVE CR-LF-TERM                 TO CP-ORIGINAL-TERM.
 14864     MOVE CR-LFAMT                   TO CP-ORIGINAL-BENEFIT
 14865                                        CP-RATING-BENEFIT-AMT.
 14866     MOVE CLAS-I-EP (CLAS-INDEXL)    TO CP-EARNING-METHOD.
 14867     MOVE CLAS-I-BAL (CLAS-INDEXL)   TO CP-SPECIAL-CALC-CD.
 14868     MOVE CR-LFTYP                   TO CP-BENEFIT-CD.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 287
* ECS010P.cbl
 14869     MOVE LIFE-OVERRIDE-L1           TO CP-LIFE-OVERRIDE-CODE.
 14870     MOVE AM-LF-DEVIATION-PCT        TO CP-RATE-DEV-PCT.
 14871     MOVE RE-NSP-ST-CD-LF            TO CP-STATE.
 14872     MOVE STATE-ABBR (CLAS-INDEXS)   TO CP-STATE-STD-ABBRV.
 14873
 14874     IF CP-STATE-STD-ABBRV = 'OR'
 14875         COMPUTE CP-RATING-BENEFIT-AMT = CR-LFAMT + CR-LFAMT-ALT.
 14876
 14877     PERFORM 8100-GET-RATE THRU 8199-GET-RATE-X.
 14878
 14879     IF CP-ERROR-RATE-NOT-FOUND  OR
 14880        CP-ERROR-RATE-IS-ZERO
 14881         MOVE 'LIFE NET SINGLE PREMIUM RATE NOT FOUND'
 14882                                     TO WS-ABEND-MESSAGE
 14883         MOVE 0302                   TO WS-ABEND-CODE
 14884         DISPLAY '******************************'
 14885         DISPLAY '***** ERROR LOCATION 018 *****'
 14886         DISPLAY '******************************'
 14887         MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
 14888         GO TO ABEND-PGM.
 14889
 14890     MOVE CP-CALC-PREMIUM          TO CR-LF-NSP-PRM.
 14891
 14892*    COMPUTE CR-LF-NSP-PRM ROUNDED =
 14893*                      (CR-LFAMT / 100) * CP-PREMIUM-RATE.
 14894
 14895     COMPUTE CR-LF-NSP-PRM ROUNDED =  CR-LF-NSP-PRM +
 14896                   ((CR-LFAMT-ALT / 100) * CP-PREMIUM-RATE).
 14897
 14898     MOVE CP-PREMIUM-RATE            TO CR-LF-NSP-PRM-RATE.
 14899
 14900 3660-NSP-REIN-AH.
 14901
 14902     IF CR-AHTYP = ZERO
 14903         GO TO 3669-NSP-REIN-X.
 14904     IF (RE-NSP-ST-CD-AH = ZEROS OR SPACES)
 14905        OR (DTE-CLIENT = 'DCC')
 14906         GO TO 3669-NSP-REIN-X.
 14907     IF DTE-CLIENT NOT = 'LBL'
 14908         IF (CLAS-I-BAL (CLAS-INDEXA) = 'B')
 14909             GO TO 3669-NSP-REIN-X.
 14910
 14911     IF RE-NSP-ST-CD-AH NOT = STATE-L
 14912         MOVE RE-NSP-ST-CD-AH        TO STATE-L
 14913         PERFORM 8200-STATE-CODE-LOOKUP THRU 8299-STATE-LOOKUP-X.
 14914
 14915     MOVE CLAS-I-RL-AH (CLAS-INDEXA) TO CP-BENEFIT-TYPE.
 14916     MOVE CR-AH-TERM                 TO CP-ORIGINAL-TERM.
 14917     MOVE CR-AHAMT                   TO CP-ORIGINAL-BENEFIT
 14918                                        CP-RATING-BENEFIT-AMT.
 14919     MOVE CLAS-I-EP (CLAS-INDEXA)    TO CP-EARNING-METHOD.
 14920     MOVE CLAS-I-BAL (CLAS-INDEXA)   TO CP-SPECIAL-CALC-CD.
 14921     MOVE CR-AHTYP                   TO CP-BENEFIT-CD.
 14922     MOVE AH-OVERRIDE-L1             TO CP-AH-OVERRIDE-CODE.
 14923     MOVE AM-AH-DEVIATION-PCT        TO CP-RATE-DEV-PCT.
 14924     MOVE RE-NSP-ST-CD-AH            TO CP-STATE.
 14925     MOVE STATE-ABBR (CLAS-INDEXS)   TO CP-STATE-STD-ABBRV.
 14926
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 288
* ECS010P.cbl
 14927     IF CP-STATE-STD-ABBRV = 'OR'
 14928         COMPUTE CP-RATING-BENEFIT-AMT = CR-AHAMT * CR-AH-TERM.
 14929
 14930     PERFORM 8100-GET-RATE THRU 8199-GET-RATE-X.
 14931
 14932     IF CP-ERROR-RATE-NOT-FOUND  OR
 14933        CP-ERROR-RATE-IS-ZERO
 14934         MOVE 'A&H NET SINGLE PREMIUM RATE NOT FOUND'
 14935                                     TO WS-ABEND-MESSAGE
 14936         MOVE 0302                   TO WS-ABEND-CODE
 14937         DISPLAY '******************************'
 14938         DISPLAY '***** ERROR LOCATION 019 *****'
 14939         DISPLAY '******************************'
 14940         MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
 14941         GO TO ABEND-PGM.
 14942
 14943     COMPUTE CR-AH-NSP-PRM ROUNDED =
 14944             ((CR-AHAMT * CR-AH-TERM) / 100) * CP-PREMIUM-RATE.
 14945
 14946     MOVE CP-PREMIUM-RATE            TO CR-AH-NSP-PRM-RATE.
 14947
 14948 3669-NSP-REIN-X.
 14949     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 289
* ECS010P.cbl
 14951******************************************************************
 14952***        R E C A L C U L A T E   R E I N S U R A N C E       ***
 14953******************************************************************
 14954
 14955 3700-RC-REIN-PERF-CALC.
 14956
*14957                             COPY ECSRTPFM.
 14958******************************************************************07/10/97
 14959*                                                                *ECSRTPFM
 14960*                            ECSRTPFM                            *   LV001
 14961*                            VMOD=2.002                          *ECSRTPFM
 14962*                                                                *ECSRTPFM
 14963******************************************************************ECSRTPFM
 14964                                                                  ECSRTPFM
 14965     IF    CR-LFAMT  NUMERIC                                      00000072
 14966           NEXT SENTENCE                                          00000073
 14967        ELSE                                                      00000074
 14968           MOVE ZEROS TO CR-LFAMT.                                00000075
 14969                                                                  00000076
 14970     IF    CR-LFAMT-ALT  NUMERIC                                  00000077
 14971           NEXT SENTENCE                                          00000078
 14972        ELSE                                                      00000079
 14973           MOVE ZEROS TO CR-LFAMT-ALT.                            00000080
 14974                                                                  00000081
 14975                                                                  00000082
 14976     IF    CR-LFPRM  NUMERIC                                      00000083
 14977           NEXT SENTENCE                                          00000084
 14978        ELSE                                                      00000085
 14979           MOVE ZEROS TO CR-LFPRM.                                00000086
 14980                                                                  00000087
 14981     IF    CR-LFPRM-ALT  NUMERIC                                  00000088
 14982           NEXT SENTENCE                                          00000089
 14983        ELSE                                                      00000090
 14984           MOVE ZEROS TO CR-LFPRM-ALT.                            00000091
 14985                                                                  00000092
 14986                                                                  00000093
 14987     IF    CR-LFPRM-CALC  NUMERIC                                 00000094
 14988           NEXT SENTENCE                                          00000095
 14989        ELSE                                                      00000096
 14990           MOVE ZEROS TO CR-LFPRM-CALC.                           00000097
 14991                                                                  00000098
 14992     IF    CR-LFPRM-CALC-ALT  NUMERIC                             00000099
 14993           NEXT SENTENCE                                          00000100
 14994        ELSE                                                      00000101
 14995           MOVE ZEROS TO CR-LFPRM-CALC-ALT.                       00000102
 14996                                                                  00000103
 14997     IF    CR-LF-NSP-PRM  NUMERIC                                 00000104
 14998           NEXT SENTENCE                                          00000105
 14999        ELSE                                                      00000106
 15000           MOVE ZEROS TO CR-LF-NSP-PRM.                           00000107
 15001                                                                  00000108
 15002     COMPUTE RS-R-LB = CR-LFAMT + CR-LFAMT-ALT.                   ECSRTPFM
 15003     COMPUTE RS-R-LP = CR-LFPRM + CR-LFPRM-ALT.                   ECSRTPFM
 15004     IF RE-NSP-ST-CD-LF = ZEROS  OR  SPACES                       ECSRTPFM
 15005         COMPUTE RS-R-LPC = CR-LFPRM-CALC + CR-LFPRM-CALC-ALT     ECSRTPFM
 15006     ELSE                                                         ECSRTPFM
 15007         MOVE CR-LF-NSP-PRM         TO RS-R-LPC.                  ECSRTPFM
 15008     MOVE RS-R-LPC                  TO REIN-CALCED-LIFE.          ECSRTPFM
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 290
* ECS010P.cbl (/apps/prod/cid1p/copy/ECSRTPFM)
 15009                                                                  ECSRTPFM
 15010     MOVE CR-AHAMT                  TO RS-R-AB.                   ECSRTPFM
 15011     MOVE CR-AHPRM                  TO RS-R-AP.                   ECSRTPFM
 15012     IF RE-NSP-ST-CD-AH = ZEROS  OR  SPACES                       ECSRTPFM
 15013         MOVE CR-AHPRM-CALC         TO RS-R-APC                   ECSRTPFM
 15014     ELSE                                                         ECSRTPFM
 15015         MOVE CR-AH-NSP-PRM         TO RS-R-APC.                  ECSRTPFM
 15016     MOVE RS-R-APC                  TO REIN-CALCED-AH.            ECSRTPFM
 15017                                                                  ECSRTPFM
 15018     PERFORM REINSURE-CALC THRU REINSURE-CALC-X                   ECSRTPFM
 15019         VARYING SUB1 FROM +1 BY +1                               ECSRTPFM
 15020             UNTIL RE-REI-COMP-NO (SUB1) = SPACES.                ECSRTPFM
 15021                                                                  ECSRTPFM
 15022
 15023     IF CR-STATE NOT = STATE-L
 15024         MOVE CR-STATE               TO STATE-L
 15025         PERFORM 8200-STATE-CODE-LOOKUP THRU 8299-STATE-LOOKUP-X.
 15026
 15027     MOVE 'X'                     TO REIN-RT-SW.
 15028     PERFORM 3200-REINSURE-CANCEL THRU 3299-REINSURE-CANCEL-X.
 15029     PERFORM 3300-REINSURE-CLAIM THRU 3399-REINSURE-CLAIM-X.
 15030     MOVE ' '                     TO REIN-RT-SW.
 15031
 15032 3710-RC-REIN-LOOP-2.
 15033
 15034     IF REIN-COMP (SUB1) = SPACES
 15035         GO TO 3730-RC-REIN-EXTRACTS.
 15036
 15037     IF REIN-LF-AH-FLGS (SUB1) = SPACES
 15038        ADD +1 TO SUB1
 15039         GO TO 3710-RC-REIN-LOOP-2.
 15040
 15041     MOVE +1 TO SUB2.
 15042
 15043 3720-RC-REIN-LOOP-3.
 15044
 15045     IF RC-REIN-COMP (SUB2) = SPACES
 15046         ADD +1 TO SUB1
 15047         GO TO 3710-RC-REIN-LOOP-2.
 15048
 15049     IF REIN-COMP (SUB1) NOT = RC-REIN-COMP (SUB2)
 15050         ADD +1 TO SUB2
 15051         GO TO 3720-RC-REIN-LOOP-3.
 15052
 15053     IF REIN-LFAMT (SUB1) = RC-REIN-LFAMT (SUB2)
 15054        AND REIN-LFPRM (SUB1) = RC-REIN-LFPRM (SUB2)
 15055        AND REIN-AHAMT (SUB1) = RC-REIN-AHAMT (SUB2)
 15056        AND REIN-AHPRM (SUB1) = RC-REIN-AHPRM (SUB2)
 15057         MOVE 'X' TO RC-OLD-ISS (SUB2)
 15058         MOVE 'X' TO RC-NEW-ISS (SUB1).
 15059
 15060     IF REIN-LFRFND (SUB1) = RC-REIN-LFRFND (SUB2)
 15061        AND REIN-AHRFND (SUB1) = RC-REIN-AHRFND (SUB2)
 15062         MOVE 'X' TO RC-OLD-CNC (SUB2)
 15063         MOVE 'X' TO RC-NEW-CNC (SUB1).
 15064
 15065     IF REIN-LFCLM (SUB1) = RC-REIN-LFCLM (SUB2)
 15066         MOVE 'X' TO RC-OLD-LF-CLM (SUB2)
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 291
* ECS010P.cbl
 15067         MOVE 'X' TO RC-NEW-LF-CLM (SUB1).
 15068
 15069     IF REIN-AHCLM (SUB1) = RC-REIN-AHCLM (SUB2)
 15070         MOVE 'X' TO RC-OLD-AH-CLM (SUB2)
 15071         MOVE 'X' TO RC-NEW-AH-CLM (SUB1).
 15072
 15073     ADD +1 TO SUB2.
 15074     GO TO 3720-RC-REIN-LOOP-3.
 15075
 15076 3730-RC-REIN-EXTRACTS.
 15077
 15078     PERFORM 2000-INITIALIZE-DETAIL-EXTRACT THRU 2099-INIT-DTL-X.
 15079     MOVE 'R' TO DE-REIN.
 15080     MOVE 'J' TO DE-TRANS.
 15081*****PERFORM EXTRACT-DATE-RELOAD.
 15082     MOVE DETAIL-EXTRACT TO SAVE-EXTRACT.
 15083     MOVE +1 TO SUB1.
 15084
 15085 3740-RC-REIN-OLD-ISSUE.
 15086
 15087     IF RC-REIN-COMP (SUB1) = SPACES
 15088         MOVE +1 TO SUB1
 15089         GO TO 3745-RC-REIN-NEW-ISSUE.
 15090
 15091     IF RC-REIN-REM-SW (SUB1) = 'Z'
 15092         ADD +1 TO SUB1
 15093         GO TO 3740-RC-REIN-OLD-ISSUE.
 15094
 15095     IF RC-OLD-ISS (SUB1) = 'X'
 15096         ADD +1 TO SUB1
 15097         GO TO 3740-RC-REIN-OLD-ISSUE.
 15098
 15099     IF RC-REIN-LFAMT (SUB1) = ZERO
 15100        AND RC-REIN-LFPRM (SUB1) = ZERO
 15101        AND RC-REIN-AHAMT (SUB1) = ZERO
 15102        AND RC-REIN-AHPRM (SUB1) = ZERO
 15103         ADD +1 TO SUB1
 15104         GO TO 3740-RC-REIN-OLD-ISSUE.
 15105
 15106     MOVE SAVE-EXTRACT TO DETAIL-EXTRACT.
 15107     PERFORM EXTRACT-DATE-LOAD.
 15108     MOVE RC-REIN-COMP (SUB1) TO DE-REI-COMP.
 15109     MULTIPLY RC-REIN-LFAMT (SUB1) BY -1 GIVING DE-REI-LFAMT.
 15110     MULTIPLY RC-REIN-LFPRM (SUB1) BY -1 GIVING DE-REI-LFPRM.
 15111     MULTIPLY RC-REIN-AHAMT (SUB1) BY -1 GIVING DE-REI-AHAMT.
 15112     MULTIPLY RC-REIN-AHPRM (SUB1) BY -1 GIVING DE-REI-AHPRM.
 15113     PERFORM 2500-WRITE-DETAIL-EXTRACTS THRU 2599-WRT-DETAIL-X.
 15114
 15115     ADD +1 TO BC-R-ISS.
 15116     ADD +1 TO SUB1.
 15117     GO TO 3740-RC-REIN-OLD-ISSUE.
 15118
 15119 3745-RC-REIN-NEW-ISSUE.
 15120
 15121     IF REIN-COMP (SUB1) = SPACES
 15122         PERFORM 2200-BUILD-CANCEL-EXTRACT THRU
 15123                                         2259-END-CANCEL-BUILD
 15124         MOVE 'R'      TO DE-REIN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 292
* ECS010P.cbl
 15125         MOVE 'K'      TO DE-TRANS
 15126*********PERFORM EXTRACT-DATE-RELOAD
 15127         MOVE DETAIL-EXTRACT TO SAVE-EXTRACT
 15128         MOVE +1       TO SUB1
 15129         GO TO 3750-RC-REIN-OLD-CANCEL.
 15130
 15131     IF REIN-REM-SW (SUB1) = 'Z'
 15132         ADD +1 TO SUB1
 15133         GO TO 3745-RC-REIN-NEW-ISSUE.
 15134
 15135     IF RC-NEW-ISS (SUB1) = 'X'
 15136         ADD +1 TO SUB1
 15137         GO TO 3745-RC-REIN-NEW-ISSUE.
 15138
 15139     IF REIN-LFAMT (SUB1) = ZERO
 15140        AND REIN-LFPRM (SUB1) = ZERO
 15141        AND REIN-AHAMT (SUB1) = ZERO
 15142        AND REIN-AHPRM (SUB1) = ZERO
 15143         ADD +1 TO SUB1
 15144         GO TO 3745-RC-REIN-NEW-ISSUE.
 15145
 15146     MOVE SAVE-EXTRACT      TO DETAIL-EXTRACT.
 15147     PERFORM EXTRACT-DATE-LOAD.
 15148     MOVE REIN-COMP (SUB1)  TO DE-REI-COMP.
 15149     MOVE REIN-LFAMT (SUB1) TO DE-REI-LFAMT.
 15150     MOVE REIN-LFPRM (SUB1) TO DE-REI-LFPRM.
 15151     MOVE REIN-AHAMT (SUB1) TO DE-REI-AHAMT.
 15152     MOVE REIN-AHPRM (SUB1) TO DE-REI-AHPRM.
 15153     PERFORM 2500-WRITE-DETAIL-EXTRACTS THRU 2599-WRT-DETAIL-X.
 15154
 15155     ADD +1 TO BC-R-ISS.
 15156     ADD +1 TO SUB1.
 15157     GO TO 3745-RC-REIN-NEW-ISSUE.
 15158
 15159 3750-RC-REIN-OLD-CANCEL.
 15160
 15161     IF RC-REIN-COMP (SUB1) = SPACES
 15162         MOVE +1 TO SUB1
 15163         GO TO 3755-RC-REIN-NEW-CANCEL.
 15164
 15165     IF RC-REIN-REM-SW (SUB1) = 'Z'
 15166         ADD +1 TO SUB1
 15167         GO TO 3750-RC-REIN-OLD-CANCEL.
 15168
 15169     IF RC-OLD-CNC (SUB1) = 'X'
 15170         ADD +1 TO SUB1
 15171         GO TO 3750-RC-REIN-OLD-CANCEL.
 15172
 15173     IF RC-REIN-LFRFND (SUB1) = ZERO
 15174        AND RC-REIN-AHRFND (SUB1) = ZERO
 15175         ADD +1 TO SUB1
 15176         GO TO 3750-RC-REIN-OLD-CANCEL.
 15177
 15178     MOVE SAVE-EXTRACT        TO DETAIL-EXTRACT.
 15179     PERFORM EXTRACT-DATE-LOAD.
 15180     MOVE RC-REIN-COMP (SUB1) TO DE-REI-COMP.
 15181     MULTIPLY RC-REIN-LFRFND (SUB1) BY -1 GIVING DE-REI-LFRFND.
 15182     MULTIPLY RC-REIN-AHRFND (SUB1) BY -1 GIVING DE-REI-AHRFND.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 293
* ECS010P.cbl
 15183     PERFORM 2500-WRITE-DETAIL-EXTRACTS THRU 2599-WRT-DETAIL-X.
 15184
 15185     ADD +1 TO BC-R-CNC.
 15186     ADD +1 TO SUB1.
 15187     GO TO 3750-RC-REIN-OLD-CANCEL.
 15188
 15189 3755-RC-REIN-NEW-CANCEL.
 15190
 15191     IF REIN-COMP (SUB1) = SPACES
 15192         PERFORM 2000-INITIALIZE-DETAIL-EXTRACT
 15193         MOVE 'R' TO DE-REIN
 15194         MOVE 'L' TO DE-TRANS
 15195*********PERFORM EXTRACT-DATE-RELOAD
 15196         MOVE DETAIL-EXTRACT TO SAVE-EXTRACT
 15197         MOVE +1 TO SUB1
 15198         GO TO 3760-RC-REIN-OLD-CLAIM.
 15199
 15200     IF REIN-REM-SW (SUB1) = 'Z'
 15201         ADD +1 TO SUB1
 15202         GO TO 3755-RC-REIN-NEW-CANCEL.
 15203
 15204     IF RC-NEW-CNC (SUB1) = 'X'
 15205         ADD +1 TO SUB1
 15206         GO TO 3755-RC-REIN-NEW-CANCEL.
 15207
 15208     IF REIN-LFRFND (SUB1) = ZERO
 15209        AND REIN-AHRFND (SUB1) = ZERO
 15210         ADD +1 TO SUB1
 15211         GO TO 3755-RC-REIN-NEW-CANCEL.
 15212
 15213     MOVE SAVE-EXTRACT       TO DETAIL-EXTRACT.
 15214     PERFORM EXTRACT-DATE-LOAD.
 15215     MOVE REIN-COMP (SUB1)   TO DE-REI-COMP.
 15216     MOVE REIN-LFRFND (SUB1) TO DE-REI-LFRFND.
 15217     MOVE REIN-AHRFND (SUB1) TO DE-REI-AHRFND.
 15218     PERFORM 2500-WRITE-DETAIL-EXTRACTS THRU 2599-WRT-DETAIL-X.
 15219
 15220     ADD +1 TO BC-R-CNC.
 15221     ADD +1 TO SUB1.
 15222     GO TO 3755-RC-REIN-NEW-CANCEL.
 15223
 15224 3760-RC-REIN-OLD-CLAIM.
 15225
 15226     IF RC-REIN-COMP (SUB1) = SPACES
 15227         MOVE +1 TO SUB1
 15228         GO TO 3780-RC-REIN-NEW-CLAIM.
 15229
 15230     IF RC-REIN-REM-SW (SUB1) = 'Z'
 15231         ADD +1 TO SUB1
 15232         GO TO 3760-RC-REIN-OLD-CLAIM.
 15233
 15234     IF RC-OLD-LF-CLM (SUB1) = 'X'
 15235         GO TO 3770-RC-REIN-OLD-AH-CLM.
 15236
 15237     IF RC-REIN-LFCLM (SUB1) = ZERO
 15238         GO TO 3770-RC-REIN-OLD-AH-CLM.
 15239
 15240     MOVE SAVE-EXTRACT         TO DETAIL-EXTRACT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 294
* ECS010P.cbl
 15241     PERFORM EXTRACT-DATE-LOAD.
 15242     MOVE RC-REIN-COMP (SUB1)  TO DE-REI-COMP.
 15243     MOVE RC-REIN-LFAMT (SUB1) TO DE-REI-LFAMT.
 15244     MOVE RC-REIN-LFPRM (SUB1) TO DE-REI-LFPRM.
 15245     MOVE RC-REIN-AHAMT (SUB1) TO DE-REI-AHAMT.
 15246     MOVE RC-REIN-AHPRM (SUB1) TO DE-REI-AHPRM.
 15247     MULTIPLY RC-REIN-LFCLM (SUB1) BY -1 GIVING DE-REI-CLAIM-AMT.
 15248     MOVE CR-DTHAMT     TO DE-CLAIM-AMT.
 15249     ADD  CR-DTHEXP     TO DE-CLAIM-AMT.
 15250     MOVE CR-DTH-PAY-DT TO DE-PAY
 15251                           WS-DE-PAY-N.
 15252
 15253     IF CLAS-I-BAL (CLAS-INDEXL) = 'B'
 15254         MOVE '3' TO DE-TYPE
 15255     ELSE
 15256         MOVE '1' TO DE-TYPE.
 15257
 15258     PERFORM 2500-WRITE-DETAIL-EXTRACTS THRU 2599-WRT-DETAIL-X.
 15259
 15260     ADD +1 TO BC-R-CLM.
 15261
 15262 3770-RC-REIN-OLD-AH-CLM.
 15263
 15264     IF RC-OLD-AH-CLM (SUB1) = 'X'
 15265         ADD +1 TO SUB1
 15266         GO TO 3760-RC-REIN-OLD-CLAIM.
 15267
 15268     IF RC-REIN-AHCLM (SUB1) = ZERO
 15269         ADD +1 TO SUB1
 15270         GO TO 3760-RC-REIN-OLD-CLAIM.
 15271
 15272     MOVE SAVE-EXTRACT         TO DETAIL-EXTRACT.
 15273     PERFORM EXTRACT-DATE-LOAD.
 15274     MOVE RC-REIN-COMP (SUB1)  TO DE-REI-COMP.
 15275     MOVE RC-REIN-LFAMT (SUB1) TO DE-REI-LFAMT.
 15276     MOVE RC-REIN-LFPRM (SUB1) TO DE-REI-LFPRM.
 15277     MOVE RC-REIN-AHAMT (SUB1) TO DE-REI-AHAMT.
 15278     MOVE RC-REIN-AHPRM (SUB1) TO DE-REI-AHPRM.
 15279     MULTIPLY RC-REIN-AHCLM (SUB1) BY -1 GIVING DE-REI-CLAIM-AMT.
 15280     MOVE CR-DISAMT     TO DE-CLAIM-AMT.
 15281     ADD  CR-DISEXP     TO DE-CLAIM-AMT.
 15282     MOVE CR-DIS-PAY-DT TO DE-PAY
 15283                           WS-DE-PAY-N.
 15284
 15285     IF CLAS-I-BAL (CLAS-INDEXA) = 'B'
 15286         MOVE '4' TO DE-TYPE
 15287     ELSE
 15288         MOVE '2' TO DE-TYPE.
 15289
 15290     PERFORM 2500-WRITE-DETAIL-EXTRACTS THRU 2599-WRT-DETAIL-X.
 15291
 15292     ADD +1 TO BC-R-CLM.
 15293     ADD +1 TO SUB1.
 15294
 15295     GO TO 3760-RC-REIN-OLD-CLAIM.
 15296
 15297 3780-RC-REIN-NEW-CLAIM.
 15298
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 295
* ECS010P.cbl
 15299     IF REIN-COMP (SUB1) = SPACES
 15300         GO TO 3799-RC-REINSURANCE-X.
 15301
 15302     IF REIN-REM-SW (SUB1) = 'Z'
 15303         ADD +1 TO SUB1
 15304         GO TO 3780-RC-REIN-NEW-CLAIM.
 15305
 15306     IF RC-NEW-LF-CLM (SUB1) = 'X'
 15307         GO TO 3790-RC-REIN-NEW-AH-CLM.
 15308
 15309     IF REIN-LFCLM (SUB1) = ZERO
 15310         GO TO 3790-RC-REIN-NEW-AH-CLM.
 15311
 15312     MOVE SAVE-EXTRACT      TO DETAIL-EXTRACT.
 15313     PERFORM EXTRACT-DATE-LOAD.
 15314     MOVE REIN-COMP (SUB1)  TO DE-REI-COMP.
 15315     MOVE REIN-LFAMT (SUB1) TO DE-REI-LFAMT.
 15316     MOVE REIN-LFPRM (SUB1) TO DE-REI-LFPRM.
 15317     MOVE REIN-AHAMT (SUB1) TO DE-REI-AHAMT.
 15318     MOVE REIN-AHPRM (SUB1) TO DE-REI-AHPRM.
 15319     MOVE REIN-LFCLM (SUB1) TO DE-REI-CLAIM-AMT.
 15320     MOVE CR-DTHAMT         TO DE-CLAIM-AMT.
 15321     ADD  CR-DTHEXP         TO DE-CLAIM-AMT.
 15322     MOVE CR-DTH-PAY-DT     TO DE-PAY
 15323                               WS-DE-PAY-N.
 15324
 15325     IF CLAS-I-BAL (CLAS-INDEXL) = 'B'
 15326         MOVE '3' TO DE-TYPE
 15327     ELSE
 15328         MOVE '1' TO DE-TYPE.
 15329
 15330     PERFORM 2500-WRITE-DETAIL-EXTRACTS THRU 2599-WRT-DETAIL-X.
 15331
 15332     ADD +1 TO BC-R-CLM.
 15333
 15334 3790-RC-REIN-NEW-AH-CLM.
 15335
 15336     IF RC-NEW-AH-CLM (SUB1) = 'X'
 15337         ADD +1 TO SUB1
 15338         GO TO 3780-RC-REIN-NEW-CLAIM.
 15339
 15340     IF REIN-AHCLM (SUB1) = ZERO
 15341         ADD +1 TO SUB1
 15342         GO TO 3780-RC-REIN-NEW-CLAIM.
 15343
 15344     MOVE SAVE-EXTRACT      TO DETAIL-EXTRACT.
 15345     PERFORM EXTRACT-DATE-LOAD.
 15346     MOVE REIN-COMP (SUB1)  TO DE-REI-COMP.
 15347     MOVE REIN-LFAMT (SUB1) TO DE-REI-LFAMT.
 15348     MOVE REIN-LFPRM (SUB1) TO DE-REI-LFPRM.
 15349     MOVE REIN-AHAMT (SUB1) TO DE-REI-AHAMT.
 15350     MOVE REIN-AHPRM (SUB1) TO DE-REI-AHPRM.
 15351     MOVE REIN-AHCLM (SUB1) TO DE-REI-CLAIM-AMT.
 15352     MOVE CR-DISAMT         TO DE-CLAIM-AMT.
 15353     ADD  CR-DISEXP         TO DE-CLAIM-AMT.
 15354     MOVE CR-DIS-PAY-DT     TO DE-PAY
 15355                               WS-DE-PAY-N.
 15356
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 296
* ECS010P.cbl
 15357     IF CLAS-I-BAL (CLAS-INDEXA) = 'B'
 15358         MOVE '4' TO DE-TYPE
 15359     ELSE
 15360         MOVE '2' TO DE-TYPE.
 15361
 15362     PERFORM 2500-WRITE-DETAIL-EXTRACTS THRU 2599-WRT-DETAIL-X.
 15363
 15364     ADD +1 TO BC-R-CLM.
 15365     ADD +1 TO SUB1.
 15366
 15367     GO TO 3780-RC-REIN-NEW-CLAIM.
 15368
 15369 3799-RC-REINSURANCE-X.
 15370     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 297
* ECS010P.cbl
 15372******************************************************************
 15373***    E A R N E D   P R E M I U M   C A L C U L A T I O N S   ***
 15374******************************************************************
 15375
 15376 4000-EP-BUMP-RTN.
 15377
 15378     IF AM-RECALC-COMM = ('Y' OR '1')
 15379        PERFORM 1600-RECALC-COMM-EXTR
 15380                                 THRU 1899-RECALC-COMM-EXTR-X
 15381        MOVE ' '                 TO RECALC-TYPE
 15382     END-IF
 15383
 15384     MOVE '1'    TO EP-FLG.
 15385     ADD +1      TO BC-G-CERTS.
 15386
 15387     MOVE CR-DT               TO HIGH-CERT.
 15388     IF CR-ACCT-CONTROL NOT = LOW-CTL
 15389         MOVE CR-DT           TO LOW-CERT
 15390         MOVE CR-ACCT-CONTROL TO LOW-CTL.
 15391
 15392     IF CR-POLICY-IS-REIN-ONLY
 15393         MOVE +0           TO GROSS-ISS-BEN-LF   GROSS-ISS-BEN-AH
 15394                              GROSS-CNC-BEN-LF   GROSS-CNC-BEN-AH
 15395                              GROSS-ISS-PRM-LF   GROSS-ISS-PRM-AH
 15396                              GROSS-CNC-PRM-LF   GROSS-CNC-PRM-AH
 15397                              DTH-IBNR           DIS-IBNR
 15398                              DTH-PAYCUR         DIS-PAYCUR
 15399                              DTH-FUTRSV         DIS-FUTRSV
 15400         GO TO 4050-EP-DO-REINSURE.
 15401
 15402     MOVE CR-LFAMT       TO WE-LFAMT.
 15403     MOVE CR-LFPRM       TO WE-LFPRM.
 15404     IF CR-LFTYP NOT = ZEROS
 15405         IF CLAS-I-EP (CLAS-INDEXL) = 'B'
 15406             MOVE CR-LFAMT-ALT        TO WE-LFAMT-ALT
 15407             MOVE CR-LFPRM-ALT        TO WE-LFPRM-ALT
 15408         ELSE
 15409             MOVE ZEROS               TO WE-LFAMT-ALT
 15410                                         WE-LFPRM-ALT.
 15411
 15412     MOVE SPACES         TO REIN-EP-FLG
 15413                            WE-REIN-CO.
 15414     MOVE CR-LFRFND      TO WE-LFRFND.
 15415     MOVE CR-DTHAMT      TO WE-DTHAMT.
 15416     ADD  CR-DTHEXP      TO WE-DTHAMT.
 15417     MOVE CR-DTHEXP      TO WE-DTHEXP.
 15418     MOVE CR-NUM-DTH-CLM TO WE-NUM-DTH-CLM.
 15419     MOVE DTH-IBNR       TO WE-DTH-IBNR.
 15420     MOVE DTH-PAYCUR     TO WE-DTH-PAYCUR.
 15421     MOVE DTH-FUTRSV     TO WE-DTH-FUTRSV.
 15422
 15423     MOVE CR-AHPRM       TO WE-AHPRM.
 15424     MOVE CR-AHAMT       TO WE-AHAMT.
 15425     MOVE CR-AHRFND      TO WE-AHRFND.
 15426     MOVE CR-DISAMT      TO WE-DSPY-AMT.
 15427     ADD  CR-DISEXP      TO WE-DSPY-AMT.
 15428     MOVE CR-DISEXP      TO WE-DSPY-EXP.
 15429     MOVE CR-NUM-DIS-CLM TO WE-NUM-DIS-CLM.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 298
* ECS010P.cbl
 15430     MOVE DIS-IBNR       TO WE-DIS-IBNR.
 15431     MOVE DIS-PAYCUR     TO WE-DIS-PAYCUR.
 15432     MOVE DIS-FUTRSV     TO WE-DIS-FUTRSV.
 15433
 15434     IF CR-POLICY-IS-RESTORE  OR
 15435        CR-POLICY-IS-REISSUE
 15436        OR CR-POLICY-IS-MONTHLY
 15437         MOVE ZEROS      TO WE-LFPRM
 15438                            WE-LFPRM-ALT
 15439                            WE-AHPRM.
 15440
 15441     MOVE +0               TO GROSS-ISS-BEN-LF   GROSS-ISS-BEN-AH
 15442                              GROSS-CNC-BEN-LF   GROSS-CNC-BEN-AH
 15443                              GROSS-ISS-PRM-LF   GROSS-ISS-PRM-AH
 15444                              GROSS-CNC-PRM-LF   GROSS-CNC-PRM-AH
 15445                              DTH-IBNR           DIS-IBNR
 15446                              DTH-PAYCUR         DIS-PAYCUR
 15447                              DTH-FUTRSV         DIS-FUTRSV.
 15448
 15449     PERFORM 4100-EP-DO-LF THRU 4299-EPBX.
 15450
 15451     IF CR-POLICY-IS-DECLINED  OR
 15452        CR-POLICY-IS-VOID
 15453         GO TO 4099-EP-BUMP-RTN-X.
 15454
 15455 4050-EP-DO-REINSURE.
 15456
 15457     MOVE 'R' TO REIN-EP-FLG.
 15458     MOVE +1  TO SUB5.
 15459
 15460 4090-EP-DO-REINSURE-LOOP.
 15461
 15462     IF REIN-COMP (SUB5) = SPACES
 15463         MOVE SPACE TO REIN-EP-FLG
 15464         GO TO 4099-EP-BUMP-RTN-X.
 15465
 15466     IF REIN-REM-SW (SUB5) = 'Z'  OR
 15467        REIN-LF-AH-FLGS (SUB5) = SPACES
 15468         ADD +1 TO SUB5
 15469         GO TO 4090-EP-DO-REINSURE-LOOP.
 15470
 15471     PERFORM REIN-FIND-CO-LOOP THRU FIND-REI-CO-EXIT
 15472        VARYING CO-SUB FROM 1 BY 1 UNTIL
 15473          (RCT-REIN-CO (CO-SUB) = REIN-COMP (SUB5))  OR
 15474          (CO-SUB GREATER REIN-CO-TABLE-ENT-CNT)     OR
 15475          (RCT-REIN-CO (CO-SUB) = SPACES).
 15476
 15477     IF (CO-SUB GREATER REIN-CO-TABLE-ENT-CNT)  OR
 15478        (RCT-REIN-CO (CO-SUB) = SPACES)
 15479        MOVE ZERO TO CO-SUB.
 15480
 15481     ADD +1 TO BC-R-CERTS.
 15482     MOVE REIN-COMP (SUB5)      TO WE-REIN-CO.
 15483     MOVE REIN-WORK-FLDS (SUB5) TO RWF-FIELDS.
 15484     MOVE RE-COMP-INFO (SUB5)   TO WT-COMP-INFO
 15485
 15486     IF DTE-CLIENT = 'DCC'
 15487        COMPUTE WS-CEDE-FACT =
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 299
* ECS010P.cbl
 15488           RWF-LFAMT / (CR-LFAMT + CR-LFAMT-ALT)
 15489        IF (AM-RECALC-COMM = ('Y' OR '1'))
 15490           AND (CLAS-I-BEN-CATEGORY (CLAS-INDEXA)
 15491                                     NOT = 'G' AND 'L')
 15492           COMPUTE RWF-LFPRM = CR-LF-NSP-PRM * WS-CEDE-FACT
 15493*          COMPUTE RWF-LFRFND ROUNDED = CR-LF-NSP-PRM
 15494*          / (CR-LFPRM + CR-LFPRM-ALT) * CR-LFRFND
 15495           COMPUTE RWF-LFRFND ROUNDED = (CR-LFRFND
 15496           / (CR-LFPRM + CR-LFPRM-ALT)) * CR-LF-NSP-PRM
 15497        END-IF
 15498     END-IF
 15499
 15500     MOVE RWF-LFPRM      TO WE-LFPRM.
 15501     MOVE RWF-LFAMT      TO WE-LFAMT.
 15502     MOVE RWF-LFRFND     TO WE-LFRFND.
 15503     MOVE RWF-LFCLM      TO WE-DTHAMT.
 15504     MOVE RWF-DTH-IBNR   TO WE-DTH-IBNR.
 15505     MOVE RWF-DTH-PAYCUR TO WE-DTH-PAYCUR.
 15506     MOVE RWF-DTH-FUTRSV TO WE-DTH-FUTRSV.
 15507     MOVE +0             TO WE-LFAMT-ALT
 15508                            WE-LFPRM-ALT
 15509                            WE-DTHEXP
 15510                            WE-NUM-DTH-CLM.
 15511
 15512     IF (DTE-CLIENT EQUAL 'NSL') AND
 15513        (CR-REIN-TABLE EQUAL 'NAR')
 15514        CONTINUE
 15515     ELSE
 15516      IF CLAS-I-EP (CLAS-INDEXL) EQUAL 'B'
 15517       IF (CR-LFAMT + CR-LFAMT-ALT) GREATER THAN +0
 15518        COMPUTE WS-CEDE-FACT ROUNDED EQUAL
 15519            RWF-LFAMT / (CR-LFAMT + CR-LFAMT-ALT)
 15520        COMPUTE WE-LFAMT ROUNDED EQUAL
 15521                           CR-LFAMT * WS-CEDE-FACT
 15522        COMPUTE WE-LFAMT-ALT ROUNDED EQUAL
 15523                           CR-LFAMT-ALT * WS-CEDE-FACT
 15524        IF (DTE-CLIENT = 'CID')
 15525           AND (CR-LF-NSP-PRM > +0)
 15526           AND (CR-ENTRY-DATE > 20031130)
 15527           AND (WT-LF-QC NOT = '1' AND '3')
 15528           COMPUTE WE-LFPRM ROUNDED = (CR-LF-NSP-PRM *
 15529              RWF-LFAMT) / (CR-LFAMT + CR-LFAMT-ALT)
 15530           MOVE +0            TO WE-LFPRM-ALT
 15531        ELSE
 15532          IF (DTE-CLIENT = 'CID')
 15533             AND (CR-LF-NSP-PRM > +0)
 15534             AND (CR-ENTRY-DATE > 20030430)
 15535             AND (WT-LF-QC NOT = '1' AND '3')
 15536             COMPUTE WE-LFPRM = CR-LF-NSP-PRM * WS-CEDE-FACT
 15537             MOVE +0            TO WE-LFPRM-ALT
 15538          ELSE
 15539             COMPUTE WE-LFPRM ROUNDED EQUAL
 15540                           CR-LFPRM * WS-CEDE-FACT
 15541             COMPUTE WE-LFPRM-ALT ROUNDED EQUAL
 15542                           CR-LFPRM-ALT * WS-CEDE-FACT
 15543          END-IF
 15544        END-IF
 15545        IF (DTE-CLIENT = 'CID')
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 300
* ECS010P.cbl
 15546           AND (CR-LF-NSP-PRM > +0)
 15547           AND (CR-LFRFND-CALC > +0)
 15548           AND (CR-LF-CANCEL-EXIT-DATE > 20031130)
 15549           AND (WT-LF-QC NOT = '1' AND '4')
 15550           COMPUTE REIN-FACTOR ROUNDED =  CR-LFRFND-CALC /
 15551              (CR-LFPRM + CR-LFPRM-ALT)
 15552           COMPUTE WE-LFRFND =
 15553              REIN-FACTOR * REIN-CALCED-LIFE
 15554           COMPUTE WE-LFRFND ROUNDED =  (WE-LFRFND
 15555              * RWF-LFAMT) / (CR-LFAMT + CR-LFAMT-ALT)
 15556*          COMPUTE WE-LFRFND = CR-LFRFND-CALC / (CR-LFPRM
 15557*             + CR-LFPRM-ALT) * CR-LF-NSP-PRM
 15558*             * RWF-LFAMT / (CR-LFAMT + CR-LFAMT-ALT)
 15559        ELSE
 15560
 15561          IF (DTE-CLIENT = 'CID')
 15562           AND (CR-LF-NSP-PRM > +0)
 15563           AND (CR-LFRFND-CALC > +0)
 15564           AND (CR-LF-CANCEL-EXIT-DATE > 20030430)
 15565           AND (WT-LF-QC NOT = '1' AND '4')
 15566           COMPUTE WS-WE-LFPRM = CR-LF-NSP-PRM * WS-CEDE-FACT
 15567           COMPUTE WE-LFRFND = (CR-LFRFND-CALC / (CR-LFPRM
 15568              + CR-LFPRM-ALT)) * (WS-WE-LFPRM)
 15569
 15570          END-IF
 15571        END-IF
 15572       ELSE
 15573         MOVE +0 TO WS-CEDE-FACT
 15574       END-IF
 15575      END-IF
 15576     END-IF
 15577
 15578     IF DTE-CLIENT = 'DCC'
 15579        IF (AM-RECALC-COMM = ('Y' OR '1'))
 15580           AND (CLAS-I-BEN-CATEGORY (CLAS-INDEXA)
 15581                                   NOT = 'G' AND 'L')
 15582           COMPUTE WS-CEDE-FACT =
 15583               RWF-AHAMT / CR-AHAMT
 15584           COMPUTE RWF-AHPRM = CR-AH-NSP-PRM * WS-CEDE-FACT
 15585*          COMPUTE RWF-AHRFND ROUNDED = CR-AH-NSP-PRM
 15586*          / CR-AHPRM * CR-AHRFND
 15587           COMPUTE RWF-AHRFND ROUNDED = (CR-AHRFND
 15588           / CR-AHPRM) * CR-AH-NSP-PRM
 15589        END-IF
 15590     END-IF
 15591
 15592     MOVE RWF-AHPRM      TO WE-AHPRM.
 15593
 15594     MOVE RWF-AHAMT      TO WE-AHAMT
 15595     MOVE RWF-AHRFND     TO WE-AHRFND.
 15596     MOVE RWF-AHCLM      TO WE-DSPY-AMT.
 15597     MOVE +0             TO WE-DSPY-EXP
 15598                            WE-NUM-DIS-CLM.
 15599     MOVE RWF-DIS-IBNR   TO WE-DIS-IBNR.
 15600     MOVE RWF-DIS-PAYCUR TO WE-DIS-PAYCUR.
 15601     MOVE RWF-DIS-FUTRSV TO WE-DIS-FUTRSV.
 15602
 15603     IF  RWF-LF-RUNOFF-SW = 'N'
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 301
* ECS010P.cbl
 15604             OR
 15605         RWF-AH-RUNOFF-SW = 'N'
 15606         PERFORM 8000R-CONVERT-STOP-DATE THRU 8099R-STOP-DATE-X.
 15607
 15608     IF  RWF-LF-RUNOFF-SW = 'N'
 15609         MOVE EARNING-STOP-DATE    TO STOP-LF-DATE
 15610     ELSE
 15611         MOVE 99999999             TO STOP-LF-DATE.
 15612
 15613     IF  RWF-AH-RUNOFF-SW = 'N'
 15614         MOVE EARNING-STOP-DATE    TO STOP-AH-DATE
 15615     ELSE
 15616         MOVE 99999999             TO STOP-AH-DATE.
 15617
 15618     IF CR-POLICY-IS-RESTORE  OR
 15619        CR-POLICY-IS-REISSUE
 15620        OR CR-POLICY-IS-MONTHLY
 15621         MOVE ZEROS      TO WE-LFPRM
 15622                            WE-LFPRM-ALT
 15623                            WE-AHPRM.
 15624
 15625     PERFORM 4100-EP-DO-LF THRU 4299-EPBX.
 15626
 15627     IF CO-SUB NOT = ZERO
 15628       IF RCT-EARNING-START-DT (CO-SUB) NOT = ZERO
 15629         IF CR-DT LESS THAN RCT-EARNING-START-DT (CO-SUB)
 15630             PERFORM S-4100-EP-DO-LF THRU S-4299-EPBX.
 15631
 15632     ADD +1 TO SUB5.
 15633     GO TO 4090-EP-DO-REINSURE-LOOP.
 15634
 15635 4099-EP-BUMP-RTN-X.
 15636     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 302
* ECS010P.cbl
 15638******************************************************************
 15639***  C A L C U L A T E   L I F E   E A R N E D   P R E M I U M ***
 15640******************************************************************
 15641
 15642 4100-EP-DO-LF.
 15643
 15644     MOVE +0                         TO ISS-BEN  EPR-R78
 15645                                        CNC-BEN  EPR-PRO
 15646                                        ISS-PRM  EPR-ST
 15647                                        ISS-PRMTAX
 15648                                        CNC-PRM  ACTIVE-COUNT.
 15649     MOVE SPACE                      TO LIFE-EARNED-SWITCH.
 15650
 15651     IF CR-LFTYP = ZERO
 15652         GO TO 4200-EP-DO-AH.
 15653
 15654     IF REIN-EP-FLG = 'R'
 15655         IF REIN-LF-FLG (SUB5) = SPACE
 15656             GO TO 4200-EP-DO-AH.
 15657
 15658     IF CR-APR NOT NUMERIC
 15659         MOVE ZERO TO CR-APR.
 15660
 15661     MOVE LIFE-OVERRIDE-L1       TO WE-LF-AH.
 15662     MOVE CR-LFTYP               TO WE-BEN-TYPE.
 15663     PERFORM 4400-EP-FIND-TAB-ENT THRU 4499-EP-FIND-TAB-ENT-X.
 15664
 15665     IF CR-POLICY-IS-DECLINED  OR
 15666        CR-POLICY-IS-VOID
 15667         GO TO 4191-CONTINUE.
 15668
 15669     MOVE CR-LF-TERM             TO ORIG-TERM.
 15670     MOVE CLAS-INDEXL            TO W-NDX.
 15671
 15672     IF CR-DT GREATER EW-COV-DTE
 15673         MOVE CR-DT              TO EW-COV-DTE.
 15674
 15675     IF (NOT CR-POLICY-IS-RESTORE) AND
 15676        (NOT CR-POLICY-IS-REISSUE)
 15677        AND (NOT CR-POLICY-IS-MONTHLY)
 15678         COMPUTE ISS-BEN = WE-LFAMT + WE-LFAMT-ALT
 15679         IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'Z'
 15680             ADD CR-LIVES TO EW-ISS-CNT
 15681             COMPUTE EW-ORIG-TERM = EW-ORIG-TERM +
 15682                                    (ORIG-TERM * CR-LIVES)
 15683             COMPUTE EW-AGE = EW-AGE + (CR-AGE * CR-LIVES)
 15684             COMPUTE EW-AGE-BEN = EW-AGE-BEN + (CR-AGE * ISS-BEN)
 15685             COMPUTE EW-TERM-BEN = EW-TERM-BEN +
 15686                                   (ORIG-TERM * ISS-BEN)
 15687         ELSE
 15688             ADD +1 TO EW-ISS-CNT
 15689             COMPUTE EW-ORIG-TERM = EW-ORIG-TERM + ORIG-TERM
 15690             COMPUTE EW-AGE = EW-AGE + CR-AGE
 15691             COMPUTE EW-AGE-BEN = EW-AGE-BEN + (CR-AGE * ISS-BEN)
 15692             COMPUTE EW-TERM-BEN = EW-TERM-BEN +
 15693                                   (ORIG-TERM * ISS-BEN).
 15694
 15695     MOVE RUN-DATE        TO VALUATION-DT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 303
* ECS010P.cbl
 15696     MOVE '2'             TO W-VAL-SOURCE.
 15697
 15698     IF REIN-EP-FLG = 'R'
 15699         IF REIN-LF-RUNOFF-SW (SUB5) = 'N' AND
 15700            EARNING-STOP-DATE LESS THAN VALUATION-DT
 15701             MOVE EARNING-STOP-DATE TO VALUATION-DT
 15702             MOVE '10'              TO W-VAL-SOURCE.
 15703
 15704     PERFORM 8500-REMAINING-TERM-ROUTINE THRU 8599-REM-TERM-X.
 15705
 15706     IF (CR-LF-CURRENT-STATUS = '1' OR '4') AND
 15707        (REM-TRM3 GREATER ZERO)
 15708        IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'Z'
 15709            COMPUTE EW-INFORCE-CNT = EW-INFORCE-CNT +
 15710                                  (CR-LIVES - CR-SUM-CAN-CNT-ITD)
 15711            COMPUTE EW-REM-TERM = EW-REM-TERM +
 15712                     (REM-TRM3 * (CR-LIVES - CR-SUM-CAN-CNT-ITD))
 15713          ELSE
 15714            COMPUTE EW-INFORCE-CNT = EW-INFORCE-CNT + 1
 15715            COMPUTE EW-REM-TERM = EW-REM-TERM + REM-TRM3.
 15716
 15717     COMPUTE ISS-PRM = WE-LFPRM + WE-LFPRM-ALT.
 15718
 15719     IF DTE-CLIENT = 'GIC'
 15720         IF REIN-EP-FLG NOT = 'R'  AND
 15721            CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'B'  AND
 15722            (CR-ENTRY-STATUS NOT = '5' AND '3' AND 'M')
 15723            MOVE CR-LFPRM-CALC TO ISS-PRM.
 15724
 15725     IF  DTE-OPT-RESERVE-METHOD-UNAUTH
 15726         GO TO 4105-EP-DO-LF-REIN-CHK.
 15727
 15728     IF  CR-DT NOT GREATER THAN EOM-DATE (13)
 15729             AND
 15730         CR-LF-EXPIRE-DATE GREATER THAN EOM-DATE (1)
 15731             AND
 15732         (CR-LF-CANC-DT GREATER THAN EOM-DATE (1)
 15733                 OR
 15734             CR-LF-CANC-DT EQUAL ZEROS)
 15735             AND
 15736         (CR-LF-CLAIM-EXIT-DATE GREATER THAN EOM-DATE (1)
 15737                 OR
 15738             CR-LF-CLAIM-EXIT-DATE EQUAL ZEROS)
 15739         MOVE 'Y'               TO  EPEC-LIFE-CTR-USED-IND (SUB3)
 15740         PERFORM 4194-SLOT-INTO-EFFECTED-MONTHS THRU 4194-EXIT
 15741                 VARYING
 15742             SUBM FROM +1 BY +1
 15743                 UNTIL
 15744             SUBM GREATER THAN +13.
 15745
 15746     MOVE EW-SUB-KEY             TO EPEC-SUB-KEY-OPT (SUB3).
 15747     MOVE EW-REIN-CO             TO EPEC-REIN-CO-OPT (SUB3).
 15748
 15749 4105-EP-DO-LF-REIN-CHK.
 15750
 15751     IF REIN-EP-FLG = 'R'  AND
 15752        REIN-LF-RUNOFF-SW (SUB5) = 'N'
 15753         NEXT SENTENCE
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 304
* ECS010P.cbl
 15754     ELSE
 15755         GO TO 4110-EP-DO-LF-CLM.
 15756
 15757     IF CR-LF-STATUS-AT-CANCEL NOT = ' '
 15758         IF CR-LF-CANC-DT GREATER THAN EARNING-STOP-DATE
 15759             GO TO 4130-EP-DO-LF-EP.
 15760
 15761     IF CR-LF-STATUS-AT-DEATH NOT = ' '
 15762         IF CR-DTH-DT GREATER THAN EARNING-STOP-DATE
 15763             GO TO 4130-EP-DO-LF-EP.
 15764
 15765 4110-EP-DO-LF-CLM.
 15766
 15767     IF  EPEC-CLM-EXP (SUB3)  NUMERIC
 15768         NEXT  SENTENCE
 15769       ELSE
 15770         MOVE ZEROS TO EPEC-CLM-EXP (SUB3).
 15771
 15772     ADD WE-DTHAMT      TO EW-CLM-AMT.
 15773     ADD WE-DTHEXP      TO EPEC-CLM-EXP (SUB3).
 15774
 15775     IF CR-LF-STATUS-AT-DEATH = ' '
 15776         IF CLAS-I-CALC-TYPE (CLAS-INDEXL) NOT = 'B'
 15777             GO TO 4115-EP-DO-LF-CLM-EPR.
 15778
 15779     ADD WE-NUM-DTH-CLM TO EW-CLM-CNT.
 15780     ADD +1             TO EW-CLM-CRT.
 15781
 15782 4115-EP-DO-LF-CLM-EPR.
 15783
 15784     IF CR-LF-STATUS-AT-DEATH NOT = ' '
 15785         COMPUTE EPR-R78 = WE-LFPRM + WE-LFPRM-ALT
 15786         MOVE EPR-R78 TO EPR-PRO  EPR-ST
 15787     END-IF
 15788     .
 15789 4120-EP-DO-LF-CNCL.
 15790
 15791     IF CR-LF-STATUS-AT-CANCEL = ' '  AND
 15792        CLAS-I-CALC-TYPE (CLAS-INDEXL) NOT = 'Z'
 15793         IF CR-LF-STATUS-AT-DEATH NOT = ' '
 15794             GO TO 4190-EP-DO-LF-COMM
 15795         ELSE
 15796             GO TO 4130-EP-DO-LF-EP.
 15797
 15798     IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'Z'
 15799         ADD CR-SUM-CAN-CNT-ITD TO EW-CNC-CNT
 15800         GO TO 4124-EP-DO-LF-CNCL-SUM.
 15801
 15802     ADD +1                       TO EW-CNC-CNT.
 15803
 15804     MOVE WE-LFRFND               TO CNC-PRM.
 15805
 15806     IF DTE-CLIENT = 'GIC'
 15807         IF REIN-EP-FLG NOT = 'R'  AND
 15808            CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'B'
 15809             MOVE CR-LFRFND-CALC TO CNC-PRM.
 15810
 15811*    MOVE CR-DT                 TO  DC-GREG-DATE-CYMD.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 305
* ECS010P.cbl
 15812*    MOVE 'L'                   TO  DC-OPTION-CODE.
 15813*    PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 15814*    MOVE DC-BIN-DATE-1         TO  WS-CR-BIN-DATE.
 15815
 15816     MOVE CR-LF-CANC-DT         TO  DC-GREG-DATE-CYMD.
 15817     MOVE 'L'                   TO  DC-OPTION-CODE.
 15818     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 15819     MOVE DC-BIN-DATE-1         TO  WS-BIN-CANCEL-DATE.
 15820
 15821     MOVE WS-CR-BIN-DATE          TO  DC-BIN-DATE-1.
 15822     MOVE WS-BIN-CANCEL-DATE      TO  DC-BIN-DATE-2.
 15823     MOVE '1'                     TO  DC-OPTION-CODE.
 15824     MOVE ZEROS                   TO  MONTHS-DIFF-LF.
 15825     MOVE ' '                     TO  DC-CENTURY-ADJUSTMENT.
 15826     MOVE ZEROS                   TO  DC-ELAPSED-MONTHS
 15827                                      DC-ODD-DAYS-OVER
 15828                                      DC-ELAPSED-DAYS.
 15829     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 15830     MOVE DC-ELAPSED-MONTHS       TO  MONTHS-DIFF-LF.
 15831
 15832     IF DC-ODD-DAYS-OVER   GREATER THAN  ZERO
 15833         ADD  +1                  TO  MONTHS-DIFF-LF.
 15834
 15835     MOVE  'YYYYYYYYYY'           TO  WS-LF-CHARGEBACK-LEVELS.
 15836
 15837     IF DTE-CLIENT = 'ACE'
 15838         GO TO 4120-CONTINUE-LIFE-CANCEL.
 15839
 15840     MOVE  ZEROS                  TO  SUB.
 15841
 15842 4120-LIFE-CHARGEBACK-LOOP.
 15843
 15844     ADD    +1                    TO  SUB.
 15845
 15846     IF  SUB  GREATER THAN  +10
 15847         GO TO  4120-CONTINUE-LIFE-CANCEL.
 15848
 15849     IF  AM-COMM-CHARGEBACK (SUB)  NOT  NUMERIC  OR
 15850         AM-COMM-CHARGEBACK (SUB)  =  ZEROS
 15851         GO TO  4120-LIFE-CHARGEBACK-LOOP.
 15852
 15853     IF  AM-COMM-CHARGEBACK (SUB)  EQUAL    '99'
 15854         MOVE  'N'    TO  WS-LF-CHARGEBACK-SW (SUB).
 15855
 15856     IF  MONTHS-DIFF-LF GREATER THAN AM-COMM-CHARGEBACK (SUB)
 15857         MOVE  'N'        TO  WS-LF-CHARGEBACK-SW (SUB).
 15858
 15859     GO TO  4120-LIFE-CHARGEBACK-LOOP.
 15860
 15861
 15862 4120-CONTINUE-LIFE-CANCEL.
 15863
 15864     COMPUTE EPR-R78 = (WE-LFPRM + WE-LFPRM-ALT) - WE-LFRFND.
 15865     MOVE EPR-R78 TO EPR-PRO  EPR-ST.
 15866
 15867     IF WE-LFRFND = +0 AND WE-DTHAMT NOT = +0
 15868         GO TO 4190-EP-DO-LF-COMM.
 15869
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 306
* ECS010P.cbl
 15870     IF CLAS-I-RL-AH (CLAS-INDEXL) = 'L' OR 'P'
 15871         COMPUTE CNC-BEN = WE-LFAMT + WE-LFAMT-ALT
 15872         GO TO 4190-EP-DO-LF-COMM.
 15873
 15874     MOVE CR-LF-CANC-DT TO VALUATION-DT.
 15875     MOVE '3'           TO W-VAL-SOURCE.
 15876     PERFORM 8500-REMAINING-TERM-ROUTINE THRU 8599-REM-TERM-X.
 15877
 15878     IF REM-TRM3 = CR-LF-TERM
 15879         COMPUTE CNC-BEN = WE-LFAMT + WE-LFAMT-ALT
 15880         GO TO 4190-EP-DO-LF-COMM.
 15881
 15882     IF CLAS-I-EP (CLAS-INDEXL) = 'T'
 15883         GO TO 4122-EP-DO-LF-CNCL-TEX.
 15884
 15885     IF DTE-CLIENT = 'NCL'
 15886         IF CR-DT LESS THAN 19910101
 15887             GO TO 4121-EP-DO-LF-CNC-BEN.
 15888
 15889     IF CLAS-I-EP (CLAS-INDEXL) = 'N'
 15890         GO TO 4126-EP-DO-LF-CNCL-NP.
 15891
 15892     IF DTE-CLIENT = 'FUL'
 15893         GO TO 4128-EP-DO-LF-CNCL-FUL.
 15894
 15895*    IF STATE-ABBR (CLAS-INDEXS) = 'OH'
 15896     IF (STATE-ABBR (CLAS-INDEXS) = 'OH') AND
 15897        (CR-RATING-CLASS NOT = 'L ')
 15898         IF (CR-APR GREATER THAN ZERO)  AND
 15899            (CR-LF-TERM GREATER THAN 060)  AND
 15900            (CR-DT GREATER THAN 19831031)
 15901              GO TO 4126-EP-DO-LF-CNCL-NP.
 15902
 15903     IF STATE-ABBR (CLAS-INDEXS) = 'MT'
 15904         IF (CR-APR GREATER THAN ZERO)  AND
 15905            (CR-LF-TERM GREATER THAN 061)  AND
 15906            (CR-DT GREATER THAN 19830318)
 15907              GO TO 4126-EP-DO-LF-CNCL-NP.
 15908
 15909     IF STATE-ABBR (CLAS-INDEXS) = 'UT'
 15910         IF (CR-APR GREATER THAN ZERO)  AND
 15911            (CR-LF-TERM GREATER THAN 062)  AND
 15912            (CR-DT GREATER THAN 19810831)  AND
 15913            (CR-DT LESS THAN 19830901)
 15914              GO TO 4126-EP-DO-LF-CNCL-NP.
 15915
 15916     IF STATE-ABBR (CLAS-INDEXS) = 'RI'
 15917         IF (CR-APR GREATER THAN ZERO)  AND
 15918            (CR-LF-TERM GREATER THAN 060)  AND
 15919            (CR-DT GREATER THAN 19831231)
 15920              GO TO 4126-EP-DO-LF-CNCL-NP.
 15921
 15922 4121-EP-DO-LF-CNC-BEN.
 15923
 15924     COMPUTE TEMP-4 ROUNDED EQUAL REM-TRM3 / CR-LF-TERM.
 15925
 15926     COMPUTE TEMP-3 ROUNDED EQUAL
 15927         (WE-LFAMT + WE-LFAMT-ALT) * TEMP-4.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 307
* ECS010P.cbl
 15928
 15929     MOVE TEMP-3                 TO CNC-BEN.
 15930
 15931     GO TO 4190-EP-DO-LF-COMM.
 15932
 15933 4122-EP-DO-LF-CNCL-TEX.
 15934
 15935     DIVIDE WE-LFAMT BY CR-LF-TERM
 15936         GIVING TEX-FACT-1.
 15937     DIVIDE REM-TRM3 BY CR-PMT-FREQ
 15938         GIVING TEX-FACT-2
 15939             REMAINDER TEX-FACT-3.
 15940     IF TEX-FACT-3 NOT = ZERO
 15941         ADD +1 TO TEX-FACT-2.
 15942
 15943     COMPUTE CNC-BEN = (TEX-FACT-1 * (TEX-FACT-2 * CR-PMT-FREQ)).
 15944
 15945     GO TO 4190-EP-DO-LF-COMM.
 15946
 15947 4124-EP-DO-LF-CNCL-SUM.
 15948
 15949     IF WE-LFRFND = ZERO
 15950         GO TO 4130-EP-DO-LF-EP.
 15951
 15952     MOVE WE-LFRFND TO CNC-PRM.
 15953
 15954     MOVE  'YYYYYYYYYY'           TO  WS-LF-CHARGEBACK-LEVELS.
 15955
 15956     IF WE-LFRFND NOT LESS WE-LFPRM
 15957         MOVE WE-LFAMT TO CNC-BEN
 15958          GO TO 4130-EP-DO-LF-EP.
 15959
 15960
 15961     COMPUTE TEMP-7 ROUNDED = WE-LFAMT * (WE-LFRFND / WE-LFPRM).
 15962
 15963     IF CLAS-I-RL-AH (CLAS-INDEXL) = 'L' OR 'P'
 15964         MOVE TEMP-7 TO CNC-BEN
 15965          GO TO 4130-EP-DO-LF-EP.
 15966
 15967     MOVE CR-LF-CANC-DT TO VALUATION-DT.
 15968     MOVE '4'           TO W-VAL-SOURCE.
 15969     PERFORM 8500-REMAINING-TERM-ROUTINE THRU 8599-REM-TERM-X.
 15970
 15971     IF CLAS-I-EP (CLAS-INDEXL) NOT = 'N'
 15972         COMPUTE CNC-BEN = TEMP-7 * (REM-TRM3 / CR-LF-TERM)
 15973         GO TO 4130-EP-DO-LF-EP.
 15974
 15975 4126-EP-DO-LF-CNCL-NP.
 15976
 15977     IF WE-LFAMT = ZERO
 15978        GO TO 4190-EP-DO-LF-COMM.
 15979
 15980     MOVE CR-DT                      TO  DC-GREG-DATE-CYMD.
 15981     MOVE 'L'                        TO  DC-OPTION-CODE.
 15982     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 15983     MOVE DC-BIN-DATE-1              TO  CP-CERT-EFF-DT.
 15984
 15985     IF CR-LOAN-1ST-PMT-DT NOT = ZEROS
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 308
* ECS010P.cbl
 15986       MOVE CR-LOAN-1ST-PMT-DT       TO  DC-GREG-DATE-1-YMD
 15987       MOVE '3'                      TO  DC-OPTION-CODE
 15988       PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X
 15989       MOVE DC-BIN-DATE-1            TO  CP-FIRST-PAY-DATE
 15990     ELSE
 15991       MOVE CP-CERT-EFF-DT           TO  DC-BIN-DATE-1
 15992       MOVE '6'                      TO  DC-OPTION-CODE
 15993       MOVE +1                       TO  DC-ELAPSED-MONTHS
 15994       MOVE +0                       TO  DC-ELAPSED-DAYS
 15995       PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X
 15996       MOVE DC-BIN-DATE-2            TO  CP-FIRST-PAY-DATE.
 15997
 15998     MOVE CR-LFAMT                   TO  CP-ORIGINAL-BENEFIT.
 15999     MOVE CR-APR                     TO  CP-LOAN-APR.
 16000     MOVE CR-LF-TERM                 TO  CP-ORIGINAL-TERM.
 16001     MOVE CR-LOAN-TERM               TO  CP-LOAN-TERM.
 16002     MOVE REM-TRM3                   TO  CP-REMAINING-TERM.
 16003     MOVE CLAS-I-CALC-TYPE (CLAS-INDEXL) TO  CP-SPECIAL-CALC-CD.
 16004     MOVE CLAS-I-RL-AH     (CLAS-INDEXL) TO  CP-BENEFIT-TYPE.
 16005     MOVE CLAS-I-EP        (CLAS-INDEXL) TO  CP-EARNING-METHOD.
 16006
 16007     CALL 'ELRAMTX' USING CALCULATION-PASS-AREA.
 16008
 16009     IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'Z'
 16010       COMPUTE CNC-BEN = (CP-REMAMT-FACTOR * (TEMP-7 / +1000))
 16011       GO TO 4130-EP-DO-LF-EP
 16012     ELSE
 16013       COMPUTE CNC-BEN = (CP-REMAMT-FACTOR * (WE-LFAMT / +1000)).
 16014
 16015     GO TO 4190-EP-DO-LF-COMM.
 16016
 16017 4128-EP-DO-LF-CNCL-FUL.
 16018
 16019     IF WE-LFAMT = ZERO
 16020        GO TO 4190-EP-DO-LF-COMM.
 16021
 16022     MOVE CR-APR              TO NP-APR.
 16023     MOVE CR-LF-TERM          TO NP-ORIG.
 16024     MOVE REM-TRM3            TO NP-REM.
 16025     MOVE '2'                 TO NP-OPT.
 16026     MOVE CR-AHPRM            TO NP-AHPRM.
 16027     MOVE CR-ACCOUNT          TO NP-ACCOUNT.
 16028     MOVE CR-LFAMT            TO NP-BENEFIT.
 16029
 16030*    CALL 'FULNETRM'
 16031*        USING NP-APR NP-ORIG NP-REM NP-OPT NP-BENEFIT NP-AHPRM
 16032*              NP-ACCOUNT NP-REMAINING.
 16033
 16034     MOVE NP-REMAINING TO CNC-BEN.
 16035
 16036     GO TO 4190-EP-DO-LF-COMM.
 16037
 16038 4130-EP-DO-LF-EP.
 16039
 16040     MOVE SPACE                  TO STATUTORY-SWITCH.
 16041
 16042     MOVE EOM-RUN-DATE TO VALUATION-DT.
 16043     MOVE '5'           TO W-VAL-SOURCE.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 309
* ECS010P.cbl
 16044
 16045     IF REIN-EP-FLG = 'R'
 16046       IF REIN-REM-SW (SUB5) = 'I'
 16047           COMPUTE EPR-R78 = WE-LFPRM + WE-LFPRM-ALT
 16048           MOVE EPR-R78             TO EPR-PRO  EPR-ST
 16049           GO TO 4190-EP-DO-LF-COMM.
 16050
 16051     IF REIN-EP-FLG = 'R'
 16052         IF REIN-LF-RUNOFF-SW (SUB5) = 'N'  AND
 16053            EARNING-STOP-DATE LESS THAN VALUATION-DT
 16054             MOVE '*'               TO LIFE-EARNED-SWITCH
 16055             MOVE EARNING-STOP-DATE TO VALUATION-DT
 16056             MOVE '10'              TO W-VAL-SOURCE.
 16057
 16058     PERFORM 8500-REMAINING-TERM-ROUTINE THRU 8599-REM-TERM-X.
 16059
 16060     IF REM-TRM2 GREATER CR-LF-TERM
 16061         MOVE +0 TO EPR-R78  EPR-PRO  EPR-ST
 16062         GO TO 4190-EP-DO-LF-COMM.
 16063
 16064     IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'Z'
 16065         GO TO 4180-EP-DO-LF-EP-SUM.
 16066
 16067     IF CLAS-I-EP (CLAS-INDEXL) = 'B'
 16068         IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'L'
 16069             IF REM-TRM2 NOT GREATER THAN +0
 16070                 COMPUTE EPR-R78 = WE-LFPRM + WE-LFPRM-ALT
 16071                 MOVE EPR-R78 TO EPR-PRO  EPR-ST
 16072                 GO TO 4190-EP-DO-LF-COMM
 16073             ELSE
 16074                 NEXT SENTENCE
 16075         ELSE
 16076             IF W-BAL-REMTRM NOT GREATER +0
 16077                 COMPUTE EPR-R78 = WE-LFPRM + WE-LFPRM-ALT
 16078                 MOVE EPR-R78 TO EPR-PRO  EPR-ST
 16079                 GO TO 4190-EP-DO-LF-COMM
 16080             ELSE
 16081                 NEXT SENTENCE
 16082     ELSE
 16083        IF DTE-CLIENT = 'NCL'  AND
 16084           CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'B'
 16085            MOVE WE-LFPRM TO EPR-R78  EPR-PRO  EPR-ST
 16086        ELSE
 16087         IF REM-TRM2 NOT GREATER +0  OR
 16088            CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'B'
 16089             MOVE WE-LFPRM TO EPR-R78  EPR-PRO  EPR-ST
 16090             GO TO 4190-EP-DO-LF-COMM.
 16091
 16092     MOVE +1 TO ACTIVE-COUNT.
 16093
 16094     IF CLAS-I-EP (CLAS-INDEXL) = 'T'
 16095         GO TO 4140-EP-DO-LF-EP-TEX.
 16096
 16097     IF CLAS-I-EP (CLAS-INDEXL) = 'N'
 16098         GO TO 4150-EP-DO-LF-EP-NP.
 16099
 16100*    IF STATE-ABBR (CLAS-INDEXS) = 'OH'
 16101     IF (STATE-ABBR (CLAS-INDEXS) = 'OH') AND
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 310
* ECS010P.cbl
 16102        (CR-RATING-CLASS NOT = 'L ')
 16103         IF (CR-APR GREATER THAN ZERO)  AND
 16104            (CR-LF-TERM GREATER THAN 060)  AND
 16105            (CR-DT GREATER THAN 19831031)
 16106             MOVE '*'             TO STATUTORY-SWITCH
 16107              GO TO 4150-EP-DO-LF-EP-NP.
 16108
 16109     IF STATE-ABBR (CLAS-INDEXS) = 'MT'
 16110         IF (CR-APR GREATER THAN ZERO)  AND
 16111            (CR-LF-TERM GREATER THAN 061)  AND
 16112            (CR-DT GREATER THAN 19830318)
 16113             MOVE '*'             TO STATUTORY-SWITCH
 16114              GO TO 4150-EP-DO-LF-EP-NP.
 16115
 16116     IF STATE-ABBR (CLAS-INDEXS) = 'UT'
 16117         IF (CR-APR GREATER THAN ZERO)  AND
 16118            (CR-LF-TERM GREATER THAN 062)  AND
 16119            (CR-DT GREATER THAN 19810831)  AND
 16120            (CR-DT LESS THAN 19830901)
 16121             MOVE '*'             TO STATUTORY-SWITCH
 16122              GO TO 4150-EP-DO-LF-EP-NP.
 16123
 16124     IF STATE-ABBR (CLAS-INDEXS) = 'RI'
 16125         IF (CR-APR GREATER THAN ZERO)  AND
 16126            (CR-LF-TERM GREATER THAN 060)  AND
 16127            (CR-DT GREATER THAN 19831231)
 16128             MOVE '*'             TO STATUTORY-SWITCH
 16129              GO TO 4150-EP-DO-LF-EP-NP.
 16130
 16131     GO TO 4160-EP-DO-LF-EP-R78.
 16132
 16133 4140-EP-DO-LF-EP-TEX.
 16134
 16135     IF CR-PMT-FREQ = 0
 16136       DISPLAY '*************************************'
 16137       DISPLAY '***** CR-PMT-FREQ EQUAL TO ZERO *****'
 16138       DISPLAY '*************************************'
 16139       DISPLAY '***** CR-FULL-CONTROL -->' CR-FULL-CONTROL
 16140       DISPLAY '*************************************'
 16141       COMPUTE TEX-FACT-4 =
 16142          (CR-LF-TERM * CR-LF-TERM) +
 16143                               (WS-CR-PMT-FREQ * CR-LF-TERM)
 16144     ELSE
 16145        COMPUTE TEX-FACT-4 =
 16146         (CR-LF-TERM * CR-LF-TERM) + (CR-PMT-FREQ * CR-LF-TERM).
 16147
 16148     IF CR-PMT-FREQ = 0
 16149       DIVIDE REM-TRM1 BY WS-CR-PMT-FREQ
 16150           GIVING TEX-FACT-5
 16151               REMAINDER TEX-FACT-6
 16152     ELSE
 16153        DIVIDE REM-TRM1 BY CR-PMT-FREQ
 16154            GIVING TEX-FACT-5
 16155                REMAINDER TEX-FACT-6.
 16156
 16157     IF CR-PMT-FREQ > 0
 16158        MOVE CR-PMT-FREQ TO WS-CR-PMT-FREQ.
 16159
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 311
* ECS010P.cbl
 16160     COMPUTE TEX-FACT-5 = TEX-FACT-5 * CR-PMT-FREQ.
 16161     COMPUTE TEX-FACT-7 = (TEX-FACT-5 * TEX-FACT-5) +
 16162         (TEX-FACT-5 * CR-PMT-FREQ) +
 16163         (2 * (TEX-FACT-6 * (TEX-FACT-5 + CR-PMT-FREQ))).
 16164     COMPUTE TEX-FACT-8 ROUNDED = TEX-FACT-7 / TEX-FACT-4.
 16165
 16166     COMPUTE EPR-R78 ROUNDED = WE-LFPRM - (WE-LFPRM * TEX-FACT-8).
 16167
 16168     GO TO 4170-EP-DO-LF-EP-PRO.
 16169
 16170 4150-EP-DO-LF-EP-NP.
 16171
 16172     IF WE-LFPRM = ZERO
 16173         GO TO 4160-EP-DO-LF-EP-R78.
 16174
 16175     IF DTE-CLIENT = 'CRI'
 16176       IF STATE-ABBR (CLAS-INDEXS) = ('AB' OR 'BC' OR 'MB' OR
 16177             'NS' OR 'ON' OR 'NB' OR 'NF' OR 'QB' OR 'SK' OR 'PE')
 16178           GO TO 4160-EP-DO-LF-EP-R78.
 16179
 16180     IF DTE-CLIENT = 'NCL'
 16181       IF CR-DT LESS THAN 19910101
 16182           GO TO 4160-EP-DO-LF-EP-R78.
 16183
 16184     IF REM-TRM1 = CR-LF-TERM
 16185         MOVE +0 TO EPR-R78  EPR-PRO  EPR-ST
 16186         GO TO 4190-EP-DO-LF-COMM.
 16187
 16188     MOVE CR-APR TO NP-APR.
 16189     MOVE CR-LF-TERM TO NP-ORIG  NP-CAP.
 16190     MOVE REM-TRM1 TO NP-REM.
 16191     MOVE CLAS-I-CALC-TYPE (CLAS-INDEXL) TO NP-OPT.
 16192     IF NP-OPT = 'T' OR 'U' OR 'V' OR 'W' OR 'X'
 16193         MOVE CR-LOAN-TERM TO NP-ORIG.
 16194
 16195     MOVE 'R' TO NP-OPT.
 16196     CALL 'ECSNETRM'
 16197         USING NP-APR NP-ORIG NP-REM NP-OPT NP-CAP NP-FACTOR.
 16198
 16199     COMPUTE EPR-R78 ROUNDED = WE-LFPRM - (NP-FACTOR * WE-LFPRM).
 16200
 16201     IF STATUTORY-REQUIREMENT
 16202         MOVE EPR-R78                TO EPR-ST.
 16203
 16204 4160-EP-DO-LF-EP-R78.
 16205
 16206     IF (CLAS-I-CALC-TYPE (CLAS-INDEXL) EQUAL 'B') AND
 16207        (DTE-CLIENT EQUAL 'NCL')
 16208        IF (CR-CCYY EQUAL EOM-CCYY) AND
 16209           (CR-MO EQUAL EOM-MO)
 16210           MOVE '*'            TO OB-DATE-1-SWITCH
 16211           MOVE EW-REIN-CO     TO WS-OB-REIN-CO (SUB3)
 16212           MOVE LIFE-OVERRIDE-L1 TO WS-OB-LF-AH (SUB3)
 16213           MOVE CR-LFTYP       TO WS-OB-BENEFIT-CODE (SUB3)
 16214           COMPUTE WS-EPR-R78 (SUB3 1) =
 16215                   WS-EPR-R78 (SUB3 1) + (WE-LFPRM * .5)
 16216           GO TO 4190-EP-DO-LF-COMM
 16217        ELSE
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 312
* ECS010P.cbl
 16218        IF (CR-CCYY EQUAL OB-CCYY (1)) AND
 16219           (CR-MO EQUAL OB-MO (1))
 16220           MOVE '*'            TO OB-DATE-2-SWITCH
 16221           MOVE EW-REIN-CO     TO WS-OB-REIN-CO (SUB3)
 16222           MOVE LIFE-OVERRIDE-L1 TO WS-OB-LF-AH (SUB3)
 16223           MOVE CR-LFTYP       TO WS-OB-BENEFIT-CODE (SUB3)
 16224           COMPUTE WS-EPR-R78 (SUB3 2) =
 16225                   WS-EPR-R78 (SUB3 2) + (WE-LFPRM * .5)
 16226           GO TO 4190-EP-DO-LF-COMM
 16227        ELSE
 16228        IF (CR-CCYY EQUAL OB-CCYY (2)) AND
 16229           (CR-MO EQUAL OB-MO (2))
 16230           MOVE '*'            TO OB-DATE-3-SWITCH
 16231           MOVE EW-REIN-CO     TO WS-OB-REIN-CO (SUB3)
 16232           MOVE LIFE-OVERRIDE-L1 TO WS-OB-LF-AH (SUB3)
 16233           MOVE CR-LFTYP       TO WS-OB-BENEFIT-CODE (SUB3)
 16234           COMPUTE WS-EPR-R78 (SUB3 3) =
 16235                   WS-EPR-R78 (SUB3 3) + (WE-LFPRM * .5)
 16236           GO TO 4190-EP-DO-LF-COMM
 16237        ELSE
 16238           GO TO 4190-EP-DO-LF-COMM.
 16239
 16240     COMPUTE TEMP-1 = CR-LF-TERM * (CR-LF-TERM + 1).
 16241
 16242     IF DTE-R78 = '1'
 16243         COMPUTE TEMP-2 = REM-TRM1 * REM-TRM1
 16244     ELSE
 16245         COMPUTE TEMP-2 = REM-TRM1 * (REM-TRM1 + 1).
 16246
 16247     COMPUTE TEMP-4 ROUNDED EQUAL TEMP-2 / TEMP-1.
 16248
 16249     IF REM-TRM1 GREATER THAN +0
 16250         COMPUTE TEMP-7 ROUNDED EQUAL
 16251             WE-LFPRM - (WE-LFPRM * TEMP-4)
 16252     ELSE
 16253         MOVE WE-LFPRM                TO TEMP-7.
 16254
 16255     IF CLAS-I-EP (CLAS-INDEXL) NOT = 'B'
 16256         MOVE ZEROS                  TO TEMP-8
 16257         GO TO 4165-END-LF-EP-R78.
 16258
 16259     IF EPR-ST = ZEROS
 16260         MOVE TEMP-7                 TO EPR-ST.
 16261
 16262     IF CLAS-I-CALC-TYPE (CLAS-INDEXL) NOT = 'L'
 16263         COMPUTE TEMP-1 = (CR-LF-TERM + 1) * (CR-LF-TERM + 2)
 16264         COMPUTE TEMP-2 = (REM-TRM1 + 1) * (REM-TRM1 + 2)
 16265         IF DTE-R78 = '1'
 16266             COMPUTE TEMP-2 = (REM-TRM1 + 1) * (REM-TRM1 + 1).
 16267
 16268     COMPUTE TEMP-4 ROUNDED EQUAL TEMP-2 / TEMP-1.
 16269
 16270     COMPUTE TEMP-8 ROUNDED =
 16271               WE-LFPRM-ALT - (WE-LFPRM-ALT * TEMP-4).
 16272
 16273 4165-END-LF-EP-R78.
 16274
 16275     IF EPR-R78 = ZEROS
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 313
* ECS010P.cbl
 16276         COMPUTE EPR-R78 = TEMP-7 + TEMP-8
 16277     ELSE
 16278         COMPUTE EPR-R78 = EPR-R78 + TEMP-8.
 16279
 16280 4170-EP-DO-LF-EP-PRO.
 16281
 16282     IF DTE-CLIENT = 'MIC' OR 'MCC'
 16283         COMPUTE TEMP-5 ROUNDED = (REM-TRM1 - .5) / CR-LF-TERM
 16284     ELSE
 16285         COMPUTE TEMP-5 ROUNDED = REM-TRM1 / CR-LF-TERM.
 16286
 16287     IF REM-TRM1 GREATER THAN +0
 16288         COMPUTE TEMP-7 ROUNDED = WE-LFPRM - (WE-LFPRM * TEMP-5)
 16289     ELSE
 16290         MOVE WE-LFPRM                  TO TEMP-7.
 16291
 16292     IF CLAS-I-EP (CLAS-INDEXL) NOT = 'B'
 16293         MOVE ZEROS                     TO TEMP-8
 16294         GO TO 4175-END-LF-EP-PRO.
 16295
 16296     IF CLAS-I-CALC-TYPE (CLAS-INDEXL) NOT = 'L'
 16297         IF DTE-CLIENT = 'MIC' OR 'MCC'
 16298             COMPUTE TEMP-5 ROUNDED =
 16299                           (REM-TRM1 + .5) / (CR-LF-TERM + 1)
 16300         ELSE
 16301             COMPUTE TEMP-5 ROUNDED =
 16302                           (REM-TRM1 + 1) / (CR-LF-TERM + 1).
 16303
 16304     COMPUTE TEMP-8 ROUNDED =
 16305                   WE-LFPRM-ALT - (WE-LFPRM-ALT * TEMP-5).
 16306
 16307     COMPUTE EPR-ST = EPR-ST + TEMP-8.
 16308
 16309 4175-END-LF-EP-PRO.
 16310
 16311     COMPUTE EPR-PRO = TEMP-7 + TEMP-8.
 16312
 16313     GO TO 4185-EP-DO-LF-STATUTORY.
 16314
 16315 4180-EP-DO-LF-EP-SUM.
 16316
 16317     IF REM-TRM1 NOT GREATER +0
 16318         COMPUTE EPR-R78 = (WE-LFPRM + WE-LFPRM-ALT) - WE-LFRFND
 16319         MOVE EPR-R78 TO EPR-PRO  EPR-ST
 16320         GO TO 4190-EP-DO-LF-COMM.
 16321
 16322     COMPUTE ACTIVE-COUNT = CR-LIVES - CR-SUM-CAN-CNT-ITD.
 16323
 16324     IF WE-LFPRM = ZERO  AND  WE-LFPRM-ALT = ZERO
 16325         MOVE ZEROS                 TO TEMP-7
 16326     ELSE
 16327         COMPUTE TEMP-7 ROUNDED = WE-LFPRM - (WE-LFRFND *
 16328                       (WE-LFPRM / (WE-LFPRM + WE-LFPRM-ALT))).
 16329
 16330     IF TEMP-7 NOT GREATER ZERO
 16331         IF CLAS-I-EP (CLAS-INDEXL) NOT = 'B'
 16332             MOVE ZEROS             TO EPR-R78  EPR-PRO  EPR-ST
 16333             GO TO 4190-EP-DO-LF-COMM
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 314
* ECS010P.cbl
 16334         ELSE
 16335             MOVE ZEROS             TO TEMP-7.
 16336
 16337     COMPUTE TEMP-1 = CR-LF-TERM * (CR-LF-TERM + 1).
 16338     COMPUTE TEMP-2 = REM-TRM1 * (REM-TRM1 + 1).
 16339     IF DTE-R78 = '1'
 16340         COMPUTE TEMP-2 = REM-TRM1 * REM-TRM1.
 16341
 16342     COMPUTE TEMP-4 ROUNDED = TEMP-2 / TEMP-1.
 16343     COMPUTE TEMP-5 ROUNDED = REM-TRM1 / CR-LF-TERM.
 16344
 16345     COMPUTE EPR-R78 ROUNDED = TEMP-7 - (TEMP-7 * TEMP-4).
 16346
 16347     COMPUTE EPR-PRO ROUNDED = TEMP-7 - (TEMP-7 * TEMP-5).
 16348
 16349     IF CLAS-I-EP (CLAS-INDEXL) NOT = 'B'
 16350         GO TO 4185-EP-DO-LF-STATUTORY.
 16351
 16352     MOVE EPR-R78                  TO EPR-ST.
 16353
 16354     IF WE-LFPRM = ZERO  AND  WE-LFPRM-ALT = ZERO
 16355         MOVE ZEROS                 TO TEMP-8
 16356     ELSE
 16357         COMPUTE TEMP-8 ROUNDED = WE-LFPRM-ALT - (WE-LFRFND *
 16358                     (WE-LFPRM-ALT / (WE-LFPRM + WE-LFPRM-ALT))).
 16359
 16360     IF TEMP-8 NOT GREATER ZERO
 16361         GO TO 4185-EP-DO-LF-STATUTORY.
 16362
 16363     COMPUTE EPR-R78 ROUNDED = EPR-R78 +
 16364                              (TEMP-8 - (TEMP-8 * TEMP-4)).
 16365
 16366     COMPUTE EPR-PRO ROUNDED = EPR-PRO +
 16367                              (TEMP-8 - (TEMP-8 * TEMP-5)).
 16368
 16369     COMPUTE EPR-ST ROUNDED = EPR-ST +
 16370                             (TEMP-8 - (TEMP-8 * TEMP-5)).
 16371
 16372 4185-EP-DO-LF-STATUTORY.
 16373
 16374     IF STATE-ABBR (CLAS-INDEXS) = 'AL'
 16375         MOVE EPR-R78                TO EPR-ST.
 16376     IF STATE-ABBR (CLAS-INDEXS) = 'WY'
 16377         MOVE EPR-PRO                TO EPR-ST.
 16378
 16379     IF EPR-ST NOT = ZEROS
 16380         GO TO 4190-EP-DO-LF-COMM.
 16381
 16382     IF CLAS-I-RL-AH (CLAS-INDEXL) = 'R'
 16383         MOVE EPR-R78                TO EPR-ST
 16384     ELSE
 16385         MOVE EPR-PRO                TO EPR-ST.
 16386
 16387 4190-EP-DO-LF-COMM.
 16388
 16389     MOVE +0 TO SUB1.
 16390     PERFORM 4300-EP-COMM-LOOP THRU 4350-EP-COMM-LOOP-X
 16391         10 TIMES.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 315
* ECS010P.cbl
 16392
 16393     IF REIN-EP-FLG NOT = 'R'  OR
 16394        CR-POLICY-IS-REIN-ONLY
 16395         MOVE ISS-BEN TO GROSS-ISS-BEN-LF
 16396         MOVE CNC-BEN TO GROSS-CNC-BEN-LF
 16397         MOVE ISS-PRM TO GROSS-ISS-PRM-LF
 16398         MOVE CNC-PRM TO GROSS-CNC-PRM-LF.
 16399
 16400     ADD ISS-BEN TO EW-ISS-BEN.
 16401     ADD GROSS-ISS-BEN-LF TO EW-ISS-BEN-GROSS.
 16402     ADD CNC-BEN TO EW-CNC-BEN.
 16403     ADD GROSS-CNC-BEN-LF TO EW-CNC-BEN-GROSS.
 16404     ADD ISS-PRM TO EW-ISS-PRM.
 16405     ADD GROSS-ISS-PRM-LF TO EW-ISS-PRM-GROSS.
 16406     ADD CNC-PRM TO EW-CNC-PRM.
 16407     ADD GROSS-CNC-PRM-LF TO EW-CNC-PRM-GROSS.
 16408
 16409     COMPUTE EW-EPR-R78 = EW-EPR-R78 + EPR-R78.
 16410     COMPUTE EW-EPR-PRO = EW-EPR-PRO + EPR-PRO.
 16411     COMPUTE EW-EPR-ST  = EW-EPR-ST  + EPR-ST.
 16412
 16413     IF CR-LF-ISS-PREM-TAX NOT NUMERIC
 16414        MOVE +0                  TO CR-LF-ISS-PREM-TAX
 16415     END-IF
 16416     IF CR-LF-CNC-PREM-TAX NOT NUMERIC
 16417        MOVE +0                  TO CR-LF-CNC-PREM-TAX
 16418     END-IF
 16419
 16420     COMPUTE ISS-PRMTAX =
 16421        (ISS-PRM * CR-LF-ISS-PREM-TAX) -
 16422        (CNC-PRM * CR-LF-CNC-PREM-TAX)
 16423
 16424     COMPUTE EW-ISS-PRM-TAX = EW-ISS-PRM-TAX + ISS-PRMTAX
 16425
 16426     IF LIFE-FULLY-EARNED
 16427         COMPUTE EW-EPR-R78-ADJ = EW-EPR-R78-ADJ +
 16428                                            (ISS-PRM - EPR-R78)
 16429         COMPUTE EW-EPR-PRO-ADJ = EW-EPR-PRO-ADJ +
 16430                                            (ISS-PRM - EPR-PRO)
 16431         COMPUTE EW-EPR-ST-ADJ  = EW-EPR-ST-ADJ +
 16432                                            (ISS-PRM - EPR-ST).
 16433
 16434     IF  DTE-OPT-RESERVE-METHOD-AUTH
 16435         IF  REIN-EP-FLG NOT = 'R'
 16436                 OR
 16437             CR-POLICY-IS-REIN-ONLY
 16438             MOVE 'L'      TO W-CLAIM-TYPE
 16439             MOVE EPR-R78  TO W-OPT-R78
 16440             MOVE EPR-PRO  TO W-OPT-PRO
 16441             MOVE EPR-ST   TO W-OPT-ST
 16442             PERFORM 4600-GET-OPT-IBNR THRU 4600-EXIT
 16443             MOVE ZEROS    TO EW-CLM-IBNR
 16444         ELSE
 16445             IF  STOP-LF-DATE LESS THAN EOM-RUN-DATE
 16446                 MOVE 'N'        TO EPEC-LINE-NOT-USED-IND (SUB3)
 16447                 MOVE ZEROS      TO EW-CLM-IBNR
 16448             ELSE
 16449                 MOVE ZEROS      TO EW-CLM-IBNR
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 316
* ECS010P.cbl
 16450     ELSE
 16451         IF  DTE-CLIENT NOT EQUAL 'ITG'
 16452             ADD WE-DTH-IBNR
 16453                       TO EW-CLM-IBNR
 16454         ELSE
 16455             IF  CLAS-I-BAL (CLAS-INDEXL) = 'B'
 16456                     AND
 16457                 CR-DT GREATER THAN LAST-YRS-DATE
 16458                 COMPUTE  EW-CLM-IBNR
 16459                     = EW-CLM-IBNR + (WE-LFAMT * .0000500).
 16460
 16461     ADD WE-DTH-PAYCUR TO EW-CLM-PAYCUR.
 16462     ADD WE-DTH-FUTRSV TO EW-CLM-FUTRSV.
 16463
 16464 4191-CONTINUE.
 16465
 16466     MOVE 'Y'          TO EW-LEVEL-USED.
 16467
 16468     IF CR-POLICY-UNDERWRITTEN
 16469         MOVE EPEC-WORK       TO EPEC-LEVELS-II (SUB3)
 16470         MOVE EPEC-OPT-WORK-TABLE
 16471                              TO EPEC-UNDW-OPT-DATA-TABLE
 16472     ELSE
 16473         MOVE EPEC-WORK       TO EPEC-LEVELS (SUB3)
 16474         MOVE EPEC-OPT-WORK-TABLE
 16475                              TO EPEC-OPT-DATA-TABLE.
 16476
 16477     GO TO 4200-EP-DO-AH.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 317
* ECS010P.cbl
 16479 4194-SLOT-INTO-EFFECTED-MONTHS.
 16480
 16481     IF  CR-DT NOT GREATER THAN EOM-DATE (SUBM)
 16482             AND
 16483         CR-LF-EXPIRE-DATE GREATER THAN EOM-DATE (SUBM)
 16484             AND
 16485         (CR-LF-CANC-DT GREATER THAN EOM-DATE (SUBM)
 16486                 OR
 16487          CR-LF-CANC-DT EQUAL ZEROS)
 16488             AND
 16489         (CR-LF-CLAIM-EXIT-DATE GREATER THAN EOM-DATE (SUBM)
 16490                 OR
 16491          CR-LF-CLAIM-EXIT-DATE EQUAL ZEROS)
 16492         MOVE 'Y'                 TO W-TABLE-USED-SW
 16493         IF  CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'Z'
 16494             COMPUTE EPEC-LIFE-CTR (SUB3 SUBM) ROUNDED
 16495                 = EPEC-LIFE-CTR (SUB3 SUBM)
 16496                 + CR-LIVES
 16497         ELSE
 16498             COMPUTE EPEC-LIFE-CTR (SUB3 SUBM)
 16499                 = EPEC-LIFE-CTR (SUB3 SUBM) + 1.
 16500
 16501 4194-EXIT.
 16502     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 318
* ECS010P.cbl
 16504******************************************************************
 16505***   C A L C U L A T E   A & H   E A R N E D   P R E M I U M  ***
 16506******************************************************************
 16507
 16508 4200-EP-DO-AH.
 16509
 16510     MOVE +0                         TO ISS-BEN  EPR-R78
 16511                                        CNC-BEN  EPR-PRO
 16512                                        ISS-PRM  EPR-ST
 16513                                        CNC-PRM
 16514                                        WX-CLM-AMT
 16515                                        WX-CLM-EXP
 16516                                        WX-CLM-CNT
 16517                                        WX-CLM-CRT
 16518                                        WX-ACTIVE-COUNT
 16519                                        ISS-PRMTAX
 16520                                        WX-CNC-CNT.
 16521     MOVE SPACE                      TO A-H-EARNED-SWITCH.
 16522
 16523     IF CR-AHTYP = ZERO
 16524         GO TO 4295-EP-DO-COUNT.
 16525
 16526     IF REIN-EP-FLG = 'R'
 16527         IF REIN-AH-FLG (SUB5) = SPACE
 16528             GO TO 4295-EP-DO-COUNT.
 16529
 16530     MOVE AH-OVERRIDE-L1       TO WE-LF-AH.
 16531     MOVE CR-AHTYP             TO WE-BEN-TYPE.
 16532     PERFORM 4400-EP-FIND-TAB-ENT THRU 4499-EP-FIND-TAB-ENT-X.
 16533
 16534     IF CR-POLICY-IS-DECLINED  OR
 16535        CR-POLICY-IS-VOID
 16536         GO TO 4290-CONTINUE.
 16537
 16538     MOVE CR-AH-TERM           TO ORIG-TERM.
 16539
 16540     IF CR-DT GREATER EW-COV-DTE
 16541         MOVE CR-DT            TO EW-COV-DTE.
 16542
 16543     IF NOT CR-POLICY-IS-RESTORE  AND
 16544        NOT CR-POLICY-IS-REISSUE
 16545        AND NOT CR-POLICY-IS-MONTHLY
 16546         MOVE WE-AHAMT         TO ISS-BEN
 16547         COMPUTE EW-ORIG-TERM = EW-ORIG-TERM + ORIG-TERM
 16548         COMPUTE EW-AGE = EW-AGE + CR-AGE
 16549         COMPUTE EW-AGE-BEN = EW-AGE-BEN + (CR-AGE * ISS-BEN)
 16550         COMPUTE EW-TERM-BEN = EW-TERM-BEN +
 16551                                   (ORIG-TERM * ISS-BEN).
 16552
 16553     MOVE CLAS-INDEXA     TO W-NDX.
 16554     MOVE RUN-DATE        TO VALUATION-DT
 16555     MOVE '6'             TO W-VAL-SOURCE.
 16556
 16557     IF REIN-EP-FLG = 'R'
 16558         IF REIN-AH-RUNOFF-SW (SUB5) = 'N'  AND
 16559            EARNING-STOP-DATE LESS THAN VALUATION-DT
 16560             MOVE EARNING-STOP-DATE TO VALUATION-DT
 16561             MOVE '10'              TO W-VAL-SOURCE.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 319
* ECS010P.cbl
 16562
 16563     PERFORM 8500-REMAINING-TERM-ROUTINE THRU 8599-REM-TERM-X.
 16564
 16565     IF (CR-AH-CURRENT-STATUS = '1' OR '4') AND
 16566        (REM-TRM3 GREATER ZERO)
 16567        IF CLAS-I-CALC-TYPE (CLAS-INDEXA) = 'Z'
 16568            COMPUTE EW-INFORCE-CNT = EW-INFORCE-CNT +
 16569                                  (CR-LIVES - CR-SUM-CAN-CNT-ITD)
 16570            COMPUTE EW-REM-TERM = EW-REM-TERM +
 16571                     (REM-TRM3 * (CR-LIVES - CR-SUM-CAN-CNT-ITD))
 16572          ELSE
 16573            COMPUTE EW-INFORCE-CNT = EW-INFORCE-CNT + 1
 16574            COMPUTE EW-REM-TERM = EW-REM-TERM + REM-TRM3.
 16575
 16576     IF  DTE-OPT-RESERVE-METHOD-UNAUTH
 16577         GO TO 4210-BY-OPT-LOGIC.
 16578
 16579     IF  CR-DT NOT GREATER THAN EOM-DATE (13)
 16580             AND
 16581         CR-AH-EXPIRE-DATE GREATER THAN EOM-DATE (1)
 16582             AND
 16583         (CR-AH-CANC-DT GREATER THAN EOM-DATE (1)
 16584                 OR
 16585          CR-AH-CANC-DT EQUAL ZEROS)
 16586         MOVE 'Y'                TO EPEC-LIFE-CTR-USED-IND (SUB3)
 16587         PERFORM 4296-SLOT-INTO-EFFECTED-MONTHS THRU 4296-EXIT
 16588                 VARYING
 16589             SUBM FROM +1 BY +1
 16590                 UNTIL
 16591             SUBM GREATER THAN +13.
 16592
 16593     MOVE EW-SUB-KEY             TO EPEC-SUB-KEY-OPT (SUB3).
 16594     MOVE EW-REIN-CO             TO EPEC-REIN-CO-OPT (SUB3).
 16595
 16596 4210-BY-OPT-LOGIC.
 16597
 16598     IF CLAS-I-CALC-TYPE (CLAS-INDEXA) = 'Z'
 16599         ADD CR-LIVES TO EW-ISS-CNT
 16600         MOVE WE-AHPRM TO ISS-PRM
 16601         COMPUTE EW-ORIG-TERM = EW-ORIG-TERM +
 16602                                (ORIG-TERM * CR-LIVES)
 16603         COMPUTE EW-AGE = EW-AGE + (CR-AGE * CR-LIVES)
 16604         COMPUTE EW-AGE-BEN = EW-AGE-BEN + (CR-AGE * ISS-BEN)
 16605         COMPUTE EW-TERM-BEN = EW-TERM-BEN +
 16606                                   (ORIG-TERM * ISS-BEN)
 16607         PERFORM 4825-EP-DO-AH-CNCL-SUM THRU 4899-EXIT
 16608         GO TO 4225-CONTINUE.
 16609
 16610     IF (NOT CR-POLICY-IS-RESTORE) AND
 16611        (NOT CR-POLICY-IS-REISSUE)
 16612        AND (NOT CR-POLICY-IS-MONTHLY)
 16613        ADD +1 TO EW-ISS-CNT.
 16614
 16615     PERFORM 4800-CALC-EARNED-PREMIUM-AH THRU 4899-EXIT.
 16616
 16617 4225-CONTINUE.
 16618
 16619     IF  EPEC-CLM-EXP (SUB3)  NUMERIC
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 320
* ECS010P.cbl
 16620         NEXT  SENTENCE
 16621       ELSE
 16622         MOVE ZEROS TO EPEC-CLM-EXP (SUB3).
 16623
 16624     ADD WX-CLM-AMT              TO EW-CLM-AMT.
 16625     ADD WX-CLM-EXP              TO EPEC-CLM-EXP (SUB3).
 16626     ADD WX-CLM-CNT              TO EW-CLM-CNT.
 16627     ADD WX-CLM-CRT              TO EW-CLM-CRT.
 16628     ADD WX-ACTIVE-COUNT         TO ACTIVE-COUNT.
 16629     ADD WX-CNC-CNT              TO EW-CNC-CNT.
 16630
 16631     MOVE +0           TO SUB1.
 16632     PERFORM 4300-EP-COMM-LOOP THRU 4350-EP-COMM-LOOP-X
 16633         10 TIMES.
 16634     MOVE +0                     TO SUB16
 16635     PERFORM 4375-EP-BANK-COMM   THRU 4375-EXIT VARYING
 16636        WS-SUB1 FROM +1 BY +1 UNTIL WS-SUB1 > +10
 16637
 16638     IF REIN-EP-FLG NOT = 'R'  OR
 16639        CR-POLICY-IS-REIN-ONLY
 16640         MOVE ISS-BEN TO GROSS-ISS-BEN-AH
 16641         MOVE CNC-BEN TO GROSS-CNC-BEN-AH
 16642         MOVE ISS-PRM TO GROSS-ISS-PRM-AH
 16643         MOVE CNC-PRM TO GROSS-CNC-PRM-AH.
 16644
 16645     ADD ISS-BEN TO EW-ISS-BEN.
 16646     ADD GROSS-ISS-BEN-AH TO EW-ISS-BEN-GROSS.
 16647     ADD CNC-BEN TO EW-CNC-BEN.
 16648     ADD GROSS-CNC-BEN-AH TO EW-CNC-BEN-GROSS.
 16649     ADD ISS-PRM TO EW-ISS-PRM.
 16650     ADD GROSS-ISS-PRM-AH TO EW-ISS-PRM-GROSS.
 16651     ADD CNC-PRM TO EW-CNC-PRM.
 16652     ADD GROSS-CNC-PRM-AH TO EW-CNC-PRM-GROSS.
 16653
 16654     COMPUTE EW-EPR-R78 = EW-EPR-R78 + EPR-R78.
 16655     COMPUTE EW-EPR-PRO = EW-EPR-PRO + EPR-PRO.
 16656     COMPUTE EW-EPR-ST  = EW-EPR-ST  + EPR-ST.
 16657
 16658     IF CR-AH-ISS-PREM-TAX NOT NUMERIC
 16659        MOVE ZEROS               TO CR-AH-ISS-PREM-TAX
 16660     END-IF
 16661     IF CR-AH-CNC-PREM-TAX NOT NUMERIC
 16662        MOVE ZEROS               TO CR-AH-CNC-PREM-TAX
 16663     END-IF
 16664     COMPUTE ISS-PRMTAX =
 16665        (ISS-PRM * CR-AH-ISS-PREM-TAX) -
 16666        (CNC-PRM * CR-AH-CNC-PREM-TAX)
 16667     COMPUTE EW-ISS-PRM-TAX = EW-ISS-PRM-TAX + ISS-PRMTAX
 16668
 16669     IF A-H-FULLY-EARNED
 16670         COMPUTE EW-EPR-R78-ADJ = EW-EPR-R78-ADJ +
 16671                                            (ISS-PRM - EPR-R78)
 16672         COMPUTE EW-EPR-PRO-ADJ = EW-EPR-PRO-ADJ +
 16673                                            (ISS-PRM - EPR-PRO)
 16674         COMPUTE EW-EPR-ST-ADJ  = EW-EPR-ST-ADJ +
 16675                                            (ISS-PRM - EPR-ST).
 16676
 16677     IF  DTE-OPT-RESERVE-METHOD-AUTH
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 321
* ECS010P.cbl
 16678         IF  REIN-EP-FLG NOT = 'R'
 16679                 OR
 16680             CR-POLICY-IS-REIN-ONLY
 16681             MOVE 'A'      TO W-CLAIM-TYPE
 16682             MOVE EPR-R78  TO W-OPT-R78
 16683             MOVE EPR-PRO  TO W-OPT-PRO
 16684             MOVE EPR-ST   TO W-OPT-ST
 16685             PERFORM 4600-GET-OPT-IBNR THRU 4600-EXIT
 16686             MOVE ZEROS    TO EW-CLM-IBNR
 16687         ELSE
 16688             IF  STOP-AH-DATE LESS THAN EOM-RUN-DATE
 16689                 MOVE 'N'   TO EPEC-LINE-NOT-USED-IND (SUB3)
 16690                 MOVE ZEROS TO EW-CLM-IBNR
 16691             ELSE
 16692                 MOVE ZEROS TO EW-CLM-IBNR
 16693     ELSE
 16694         IF  DTE-CLIENT NOT EQUAL 'ITG'
 16695             ADD WE-DIS-IBNR     TO EW-CLM-IBNR
 16696         ELSE
 16697             IF  CLAS-I-BAL (CLAS-INDEXA) NOT EQUAL 'B'
 16698                 IF  CR-AH-POLICY-IS-ACTIVE
 16699                     COMPUTE  EW-CLM-IBNR  =  EW-CLM-IBNR
 16700                              + ((WE-AHPRM - EPR-PRO) * .0730000)
 16701                 ELSE
 16702                     NEXT SENTENCE
 16703             ELSE
 16704                 IF  CR-DT GREATER THAN LAST-YRS-DATE
 16705                     COMPUTE  EW-CLM-IBNR
 16706                         = EW-CLM-IBNR + (WE-AHPRM * .0600000).
 16707
 16708     ADD WE-DIS-PAYCUR TO EW-CLM-PAYCUR.
 16709     ADD WE-DIS-FUTRSV TO EW-CLM-FUTRSV.
 16710
 16711 4290-CONTINUE.
 16712
 16713     MOVE 'Y'          TO EW-LEVEL-USED.
 16714
 16715     IF CR-POLICY-UNDERWRITTEN
 16716         MOVE EPEC-WORK       TO EPEC-LEVELS-II (SUB3)
 16717         MOVE EPEC-OPT-WORK-TABLE
 16718                              TO EPEC-UNDW-OPT-DATA-TABLE
 16719     ELSE
 16720         MOVE EPEC-WORK       TO EPEC-LEVELS (SUB3)
 16721         MOVE EPEC-OPT-WORK-TABLE
 16722                              TO EPEC-OPT-DATA-TABLE.
 16723
 16724
 16725 4295-EP-DO-COUNT.
 16726
 16727     IF REIN-EP-FLG = 'R'
 16728         ADD ACTIVE-COUNT TO BC-R-A-CERTS
 16729     ELSE
 16730         ADD ACTIVE-COUNT TO BC-G-A-CERTS.
 16731
 16732     GO TO 4299-EPBX.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 322
* ECS010P.cbl
 16734 4296-SLOT-INTO-EFFECTED-MONTHS.
 16735
 16736     IF  CR-DT NOT GREATER THAN EOM-DATE (SUBM)
 16737             AND
 16738         CR-AH-EXPIRE-DATE GREATER THAN EOM-DATE (SUBM)
 16739             AND
 16740         (CR-AH-CANC-DT GREATER THAN EOM-DATE (SUBM)
 16741                 OR
 16742          CR-AH-CANC-DT EQUAL ZEROS)
 16743         MOVE 'Y'                 TO W-TABLE-USED-SW
 16744         IF  CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'Z'
 16745             COMPUTE EPEC-LIFE-CTR (SUB3 SUBM) ROUNDED
 16746                 = EPEC-LIFE-CTR (SUB3 SUBM)
 16747                 + CR-LIVES
 16748         ELSE
 16749             COMPUTE EPEC-LIFE-CTR (SUB3 SUBM)
 16750                 = EPEC-LIFE-CTR (SUB3 SUBM) + 1.
 16751
 16752 4296-EXIT.
 16753     EXIT.
 16754
 16755 4299-EPBX.
 16756     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 323
* ECS010P.cbl
 16758******************************************************************
 16759***    C A L C U L A T E   E A R N E D   C O M M I S S I O N   ***
 16760******************************************************************
 16761
 16762 4300-EP-COMM-LOOP.
 16763     IF DTE-CLIENT = 'DMD'
 16764         GO TO 4350-EP-COMM-LOOP-X.
 16765
 16766     ADD +1                         TO SUB1.
 16767     MOVE ZEROS                     TO SUB16.
 16768
 16769     IF CR-ADDL-CLP NOT NUMERIC
 16770        MOVE ZEROS               TO CR-ADDL-CLP
 16771     END-IF
 16772     IF CR-COM-AGT (SUB1) = SPACES OR ZEROS
 16773         GO TO 4350-EP-COMM-LOOP-X.
 16774
 16775 4300-AGENT-LOOP.
 16776
 16777     ADD +1                         TO SUB16.
 16778
 16779     IF SUB16 GREATER THAN WS-LOOP-MAX
 16780         DISPLAY 'ERROR OCCURRED - MAXIMUM AGENT LEVELS EXCEEDED'
 16781         DISPLAY 'CONTROL= ' CR-FULL-CONTROL
 16782         MOVE 'ERR0R OCCURRED - MAXIMUM AGENT LEVELS EXCEEDED'
 16783                                     TO WS-ABEND-MESSAGE
 16784         MOVE DC-ERROR-CODE          TO WS-ABEND-FILE-STATUS
 16785         MOVE 4001                   TO WS-ABEND-CODE
 16786         GO TO ABEND-PGM.
 16787
 16788     IF EW-AGT-NO (SUB16) = SPACES
 16789         MOVE CR-COM-AGT  (SUB1)     TO EW-AGT-NO   (SUB16)
 16790         MOVE CR-AGT-TYPE (SUB1)     TO EW-AGT-TYPE (SUB16)
 16791     ELSE
 16792         IF (CR-COM-AGT (SUB1)  = EW-AGT-NO   (SUB16)) AND
 16793            (CR-AGT-TYPE (SUB1) = EW-AGT-TYPE (SUB16))
 16794             NEXT SENTENCE
 16795         ELSE
 16796             GO TO 4300-AGENT-LOOP.
 16797
 16798     IF EW-LF-AH = AH-OVERRIDE-L1
 16799         GO TO 4350-EP-COMM-LOOP-A.
 16800
 16801     IF (DTE-CLIENT = 'DCC')
 16802        AND (REIN-EP-FLG = 'R')
 16803        AND (CR-AGT-TYPE (SUB1) = 'P' OR 'T')
 16804        AND (WE-LFPRM NOT = ZEROS)
 16805        COMPUTE WS-CEDE-FACT = RWF-LFAMT /
 16806            (CR-LFAMT + CR-LFAMT-ALT)
 16807*       COMPUTE ISS-WK ROUNDED = ((WE-LFPRM + WE-LFPRM-ALT)
 16808        COMPUTE ISS-WK ROUNDED = ((CR-LFPRM + CR-LFPRM-ALT)
 16809           * WS-CEDE-FACT) * CR-LCOM-L (SUB1)
 16810     ELSE
 16811        IF CR-AGT-TYPE (SUB1) = 'B' OR 'I' OR 'K' OR 'L'
 16812                             OR 'J'
 16813           COMPUTE ISS-WK = CR-LCOM-L (SUB1) * +1000
 16814        ELSE
 16815           COMPUTE ISS-WK  ROUNDED = ISS-PRM * CR-LCOM-L (SUB1)
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 324
* ECS010P.cbl
 16816        END-IF
 16817     END-IF
 16818
 16819     COMPUTE EW-ISS-COM (SUB16) = EW-ISS-COM (SUB16) + ISS-WK.
 16820
 16821     MOVE ZEROS                  TO CNC-WK
 16822                                    CNC-FACT
 16823     IF DTE-CLIENT EQUAL 'XXX'
 16824         IF NOT CR-NO-LF-CHARGEBACK
 16825            COMPUTE CNC-WK  ROUNDED = CNC-PRM * CR-LCOM-L (SUB1)
 16826            COMPUTE EW-CNC-COM (SUB16) = EW-CNC-COM (SUB16)
 16827                                + CNC-WK
 16828            GO TO 4300-CONTINUE-LOOP.
 16829
 16830
 16831     IF (WS-LEVELS-CHARGEBACK-SWITCHES = SPACES) OR
 16832        (WS-LF-CHARGEBACK-SW (SUB1) EQUAL 'Y')
 16833        IF (CR-AGT-TYPE (SUB1) = 'K')
 16834           AND (CNC-PRM > +0)
 16835           COMPUTE CNC-WK = CR-LCOM-L (SUB1) * +1000
 16836        ELSE
 16837           IF (CR-AGT-TYPE (SUB1) = 'B' OR 'I' OR 'L' OR 'J')
 16838              AND (CNC-PRM > +0)
 16839              COMPUTE CNC-FACT = CNC-PRM / ISS-PRM
 16840              COMPUTE CNC-WK = CNC-FACT *
 16841                 (CR-LCOM-L (SUB1) * +1000)
 16842           ELSE
 16843             IF (CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'G' OR 'L')
 16844                AND (CR-AGT-TYPE (SUB1) = 'C' OR 'D')
 16845                COMPUTE CNC-FACT = CNC-PRM / ISS-PRM
 16846                COMPUTE CNC-WK = CNC-FACT *
 16847                   (CR-AHPRM - (CR-LFPRM-ALT
 16848                   + CR-ADDL-CLP))
 16849             ELSE
 16850                COMPUTE CNC-WK  ROUNDED =
 16851                   CNC-PRM * CR-LCOM-L (SUB1)
 16852             END-IF
 16853           END-IF
 16854        END-IF
 16855        COMPUTE EW-CNC-COM (SUB16) =
 16856                                  EW-CNC-COM (SUB16) + CNC-WK
 16857     END-IF
 16858     .
 16859 4300-CONTINUE-LOOP.
 16860
 16861     IF ((ISS-PRM - CNC-PRM) = ZEROS)
 16862               OR
 16863        ((ISS-WK - CNC-WK) = ZEROS)
 16864        MOVE ZEROS              TO COMM-WK
 16865     ELSE
 16866        COMPUTE COMM-WK ROUNDED = EPR-R78 /
 16867        (ISS-PRM - CNC-PRM) * (ISS-WK - CNC-WK)
 16868     END-IF
 16869
 16870     COMPUTE EW-ECR-R78 (SUB16) = EW-ECR-R78 (SUB16) + COMM-WK.
 16871
 16872     IF ((ISS-PRM - CNC-PRM) = ZEROS)
 16873               OR
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 325
* ECS010P.cbl
 16874        ((ISS-WK - CNC-WK) = ZEROS)
 16875        MOVE ZEROS              TO COMM-WK
 16876     ELSE
 16877        COMPUTE COMM-WK ROUNDED = EPR-PRO /
 16878        (ISS-PRM - CNC-PRM) * (ISS-WK - CNC-WK)
 16879     END-IF
 16880     COMPUTE EW-ECR-PRO (SUB16) = EW-ECR-PRO (SUB16) + COMM-WK.
 16881
 16882     IF ((ISS-PRM - CNC-PRM) = ZEROS)
 16883               OR
 16884        ((ISS-WK - CNC-WK) = ZEROS)
 16885        MOVE ZEROS              TO COMM-WK
 16886     ELSE
 16887        COMPUTE COMM-WK ROUNDED = EPR-ST /
 16888        (ISS-PRM - CNC-PRM) * (ISS-WK - CNC-WK)
 16889     END-IF
 16890
 16891     COMPUTE EW-ECR-ST (SUB16) = EW-ECR-ST (SUB16) + COMM-WK.
 16892
 16893     IF LIFE-FULLY-EARNED
 16894         COMPUTE COMM-WK ROUNDED = (ISS-PRM - EPR-R78) *
 16895                                                CR-LCOM-L (SUB1)
 16896         COMPUTE EW-ECR-R78-ADJ (SUB16) =
 16897                               EW-ECR-R78-ADJ (SUB16) + COMM-WK
 16898         COMPUTE COMM-WK ROUNDED = (ISS-PRM - EPR-PRO) *
 16899                                                CR-LCOM-L (SUB1)
 16900         COMPUTE EW-ECR-PRO-ADJ (SUB16) =
 16901                               EW-ECR-PRO-ADJ (SUB16) + COMM-WK.
 16902
 16903     GO TO 4350-EP-COMM-LOOP-X.
 16904
 16905 4350-EP-COMM-LOOP-A.
 16906
 16907     IF (DTE-CLIENT = 'DCC')
 16908        AND (REIN-EP-FLG = 'R')
 16909        AND (CR-AGT-TYPE (SUB1) = 'P' OR 'T')
 16910        AND (WE-AHPRM NOT = ZEROS)
 16911        COMPUTE WS-CEDE-FACT = RWF-AHAMT / CR-AHAMT
 16912        COMPUTE ISS-WK ROUNDED = (CR-AHPRM * WS-CEDE-FACT)
 16913*       COMPUTE ISS-WK ROUNDED = (WE-AHPRM * WS-CEDE-FACT)
 16914           * CR-LCOM-AH (SUB1)
 16915     ELSE
 16916        IF CR-AGT-TYPE (SUB1) = 'B' OR 'I' OR 'K' OR 'L' OR 'J'
 16917           COMPUTE ISS-WK = CR-LCOM-AH (SUB1) * +1000
 16918        ELSE
 16919           IF (CR-AGT-TYPE (SUB1) = 'D' OR 'C')
 16920             AND (CLAS-I-BEN-CATEGORY (CLAS-INDEXA)) = 'G' OR 'L'
 16921              COMPUTE ISS-WK = CR-AHPRM - (CR-LFPRM-ALT
 16922              + CR-ADDL-CLP)
 16923           ELSE
 16924              COMPUTE ISS-WK  ROUNDED =
 16925                    ISS-PRM * CR-LCOM-AH (SUB1)
 16926           END-IF
 16927        END-IF
 16928     END-IF
 16929
 16930     COMPUTE EW-ISS-COM (SUB16) =
 16931             EW-ISS-COM (SUB16) + ISS-WK.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 326
* ECS010P.cbl
 16932
 16933     MOVE ZEROS                  TO CNC-WK
 16934     IF DTE-CLIENT EQUAL 'XXX'
 16935         IF NOT CR-NO-LF-CHARGEBACK
 16936           COMPUTE CNC-WK  ROUNDED = CNC-PRM * CR-LCOM-AH (SUB1)
 16937           COMPUTE EW-CNC-COM (SUB16) =
 16938                   EW-CNC-COM (SUB16) + CNC-WK
 16939           GO TO 4300-CONTINUE-LOOP-AH.
 16940
 16941
 16942     IF (WS-LEVELS-CHARGEBACK-SWITCHES = SPACES) OR
 16943        (WS-AH-CHARGEBACK-SW (SUB1) EQUAL 'Y')
 16944      IF (DTE-CLIENT = 'DCC')
 16945         AND (REIN-EP-FLG = 'R')
 16946         AND (CR-AGT-TYPE (SUB1) = 'P' OR 'T')
 16947         AND (WE-AHRFND NOT = ZEROS)
 16948         COMPUTE WS-CEDE-FACT = RWF-AHAMT / CR-AHAMT
 16949         COMPUTE CNC-WK ROUNDED = (CR-AHRFND * WS-CEDE-FACT)
 16950            * CR-LCOM-AH (SUB1)
 16951      ELSE
 16952
 16953
 16954
 16955        IF (CR-AGT-TYPE (SUB1) = 'K')
 16956           AND (CNC-PRM > +0)
 16957           COMPUTE CNC-WK = CR-LCOM-AH (SUB1) * +1000
 16958        ELSE
 16959           IF (CR-AGT-TYPE (SUB1) = 'B' OR 'I' OR 'L' OR 'J')
 16960              AND (CNC-PRM > +0)
 16961              COMPUTE CNC-FACT = CNC-PRM / ISS-PRM
 16962              COMPUTE CNC-WK = CNC-FACT *
 16963                 (CR-LCOM-AH (SUB1) * +1000)
 16964           ELSE
 16965              IF CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'G' OR 'L'
 16966                 COMPUTE CNC-FACT = CR-AHRFND / CR-AHPRM
 16967                 COMPUTE CNC-WK = CNC-FACT *
 16968                    (CR-AHPRM - (CR-LFPRM-ALT
 16969                    + CR-ADDL-CLP))
 16970              ELSE
 16971                 COMPUTE CNC-WK  ROUNDED =
 16972                    CNC-PRM * CR-LCOM-AH (SUB1)
 16973              END-IF
 16974           END-IF
 16975        END-IF
 16976      END-IF
 16977        COMPUTE EW-CNC-COM (SUB16) =
 16978                   EW-CNC-COM (SUB16) + CNC-WK
 16979     END-IF
 16980
 16981     .
 16982 4300-CONTINUE-LOOP-AH.
 16983
 16984     IF ((ISS-PRM - CNC-PRM) = ZEROS)
 16985                OR
 16986        ((ISS-WK - CNC-WK) = ZEROS)
 16987        MOVE ZEROS          TO COMM-WK
 16988     ELSE
 16989        COMPUTE COMM-WK ROUNDED = EPR-R78 /
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 327
* ECS010P.cbl
 16990        (ISS-PRM - CNC-PRM) * (ISS-WK - CNC-WK)
 16991     END-IF
 16992
 16993     COMPUTE EW-ECR-R78 (SUB16) = EW-ECR-R78 (SUB16) + COMM-WK.
 16994
 16995     IF ((ISS-PRM - CNC-PRM) = ZEROS)
 16996                OR
 16997        ((ISS-WK - CNC-WK) = ZEROS)
 16998        MOVE ZEROS          TO COMM-WK
 16999     ELSE
 17000        COMPUTE COMM-WK ROUNDED = EPR-PRO /
 17001        (ISS-PRM - CNC-PRM) * (ISS-WK - CNC-WK)
 17002     END-IF
 17003
 17004     COMPUTE EW-ECR-PRO (SUB16) = EW-ECR-PRO (SUB16) + COMM-WK.
 17005
 17006     IF ((ISS-PRM - CNC-PRM) = ZEROS)
 17007                OR
 17008        ((ISS-WK - CNC-WK) = ZEROS)
 17009        MOVE ZEROS          TO COMM-WK
 17010     ELSE
 17011        COMPUTE COMM-WK ROUNDED = EPR-ST  /
 17012        (ISS-PRM - CNC-PRM) * (ISS-WK - CNC-WK)
 17013     END-IF
 17014
 17015     COMPUTE EW-ECR-ST (SUB16) = EW-ECR-ST (SUB16) + COMM-WK.
 17016
 17017     IF A-H-FULLY-EARNED
 17018         COMPUTE COMM-WK ROUNDED = (ISS-PRM - EPR-R78) *
 17019                                                CR-LCOM-AH (SUB1)
 17020         COMPUTE EW-ECR-R78-ADJ (SUB16) =
 17021                               EW-ECR-R78-ADJ (SUB16) + COMM-WK
 17022         COMPUTE COMM-WK ROUNDED = (ISS-PRM - EPR-PRO) *
 17023                                                CR-LCOM-AH (SUB1)
 17024         COMPUTE EW-ECR-PRO-ADJ (SUB16) =
 17025                               EW-ECR-PRO-ADJ (SUB16) + COMM-WK.
 17026
 17027 4350-EP-COMM-LOOP-X.
 17028     EXIT.
 17029
 17030
 17031
 17032
 17033******************************************************************
 17034***    C A L C U L A T E   E A R N E D  BANK COMMISSION        ***
 17035******************************************************************
 17036
 17037 4375-EP-BANK-COMM.
 17038
 17039     IF CS-AGT (SUB1) = SPACES OR ZEROS
 17040        GO TO 4375-EXIT
 17041     END-IF
 17042     .
 17043 4375-BANK-LOOP.
 17044
 17045     ADD +1                      TO SUB16
 17046
 17047     IF EW-LF-AH NOT = AH-OVERRIDE-L1
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 328
* ECS010P.cbl
 17048        GO TO 4375-EXIT
 17049     END-IF
 17050
 17051     IF SUB16 GREATER THAN WS-LOOP-MAX
 17052         DISPLAY 'ERROR OCCURRED - MAXIMUM BANK  LEVELS EXCEEDED'
 17053         DISPLAY 'CONTROL= ' CR-FULL-CONTROL
 17054         MOVE 'ERR0R OCCURRED - MAXIMUM AGENT LEVELS EXCEEDED'
 17055                                     TO WS-ABEND-MESSAGE
 17056         MOVE DC-ERROR-CODE          TO WS-ABEND-FILE-STATUS
 17057         MOVE 4001                   TO WS-ABEND-CODE
 17058         PERFORM ABEND-PGM
 17059     END-IF
 17060
 17061     IF EW-AGT-NO (SUB16) = SPACES
 17062        MOVE CS-AGT (SUB1)       TO EW-AGT-NO   (SUB16)
 17063        MOVE CS-COM-TYP (SUB1)   TO EW-AGT-TYPE (SUB16)
 17064     ELSE
 17065        IF (CS-AGT (SUB1) = EW-AGT-NO   (SUB16)) AND
 17066           (CS-COM-TYP (SUB1) = EW-AGT-TYPE (SUB16))
 17067           CONTINUE
 17068        ELSE
 17069           GO TO 4375-BANK-LOOP
 17070        END-IF
 17071     END-IF
 17072
 17073     IF CS-COM-TYP  (SUB1) = 'B'
 17074        MOVE CS-SPP-FEES (SUB1)  TO ISS-WK
 17075     END-IF
 17076
 17077     COMPUTE EW-ISS-COM (SUB16) = EW-ISS-COM (SUB16) + ISS-WK.
 17078
 17079     MOVE ZEROS                  TO CNC-WK
 17080                                    CNC-FACT
 17081
 17082     IF (CS-COM-TYP (SUB1) = 'B')
 17083        AND (CNC-PRM > +0)
 17084        COMPUTE CNC-FACT = CNC-PRM / ISS-PRM
 17085        COMPUTE CNC-WK = CNC-FACT * CS-SPP-FEES (SUB1)
 17086     END-IF
 17087
 17088     COMPUTE EW-CNC-COM (SUB16) =
 17089                  EW-CNC-COM (SUB16) + CNC-WK
 17090
 17091     IF ((ISS-PRM - CNC-PRM) = ZEROS)
 17092                OR
 17093        ((ISS-WK - CNC-WK) = ZEROS)
 17094        MOVE ZEROS          TO COMM-WK
 17095     ELSE
 17096        COMPUTE COMM-WK ROUNDED = EPR-R78 /
 17097        (ISS-PRM - CNC-PRM) * (ISS-WK - CNC-WK)
 17098     END-IF
 17099
 17100     COMPUTE EW-ECR-R78 (SUB16) = EW-ECR-R78 (SUB16) + COMM-WK.
 17101
 17102     IF ((ISS-PRM - CNC-PRM) = ZEROS)
 17103                OR
 17104        ((ISS-WK - CNC-WK) = ZEROS)
 17105        MOVE ZEROS          TO COMM-WK
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 329
* ECS010P.cbl
 17106     ELSE
 17107        COMPUTE COMM-WK ROUNDED = EPR-PRO /
 17108        (ISS-PRM - CNC-PRM) * (ISS-WK - CNC-WK)
 17109     END-IF
 17110
 17111     COMPUTE EW-ECR-PRO (SUB16) = EW-ECR-PRO (SUB16) + COMM-WK.
 17112
 17113     IF ((ISS-PRM - CNC-PRM) = ZEROS)
 17114                OR
 17115        ((ISS-WK - CNC-WK) = ZEROS)
 17116        MOVE ZEROS          TO COMM-WK
 17117     ELSE
 17118        COMPUTE COMM-WK ROUNDED = EPR-ST  /
 17119        (ISS-PRM - CNC-PRM) * (ISS-WK - CNC-WK)
 17120     END-IF
 17121
 17122     COMPUTE EW-ECR-ST (SUB16) = EW-ECR-ST (SUB16) + COMM-WK.
 17123
 17124     IF A-H-FULLY-EARNED
 17125        MOVE CS-SPP-FEES (SUB1)  TO COMM-WK
 17126        COMPUTE EW-ECR-R78-ADJ (SUB16) =
 17127                               EW-ECR-R78-ADJ (SUB16) + COMM-WK
 17128        COMPUTE EW-ECR-PRO-ADJ (SUB16) =
 17129                               EW-ECR-PRO-ADJ (SUB16) + COMM-WK
 17130     END-IF
 17131
 17132     .
 17133 4375-EXIT.
 17134     EXIT.
 17135
 17136******************************************************************
 17137******************************************************************
 17138******************************************************************
 17139******************************************************************
 17140******************************************************************
 17141******************************************************************
 17142******************************************************************
 17143******************************************************************
 17144******************************************************************
 17145******************************************************************
 17146***  C A L C U L A T E   L I F E   S T A R T I N G  E A R N E D***
 17147******************************************************************
 17148
 17149 S-4100-EP-DO-LF.
 17150
 17151     MOVE +0                         TO EPR-R78  EARNED-BY-CANCEL
 17152                                        EPR-PRO
 17153                                        EPR-ST.
 17154
 17155     MOVE RCT-EARNING-START-DT (CO-SUB) TO DC-GREG-DATE-CYMD.
 17156     MOVE 'L'                    TO DC-OPTION-CODE.
 17157     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 17158
 17159     MOVE +0                     TO DC-ELAPSED-MONTHS.
 17160     MOVE -1                     TO DC-ELAPSED-DAYS.
 17161     MOVE '6'                    TO DC-OPTION-CODE.
 17162     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 17163
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 330
* ECS010P.cbl
 17164     MOVE +0                     TO DC-ELAPSED-MONTHS
 17165                                    DC-ELAPSED-DAYS.
 17166
 17167     MOVE DC-BIN-DATE-2          TO DC-BIN-DATE-1.
 17168     MOVE ' '                    TO DC-OPTION-CODE.
 17169     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 17170
 17171     IF NO-CONVERSION-ERROR
 17172        MOVE DC-GREG-DATE-CYMD   TO EARNING-START-DATE
 17173     ELSE
 17174         DISPLAY 'ERROR OCCURED CONVERTING EARNING START DATE '
 17175                 'FOR REIN. CO. ' RCT-REIN-CO (CO-SUB)
 17176                 '  START DATE:' RCT-EARNING-START-DT (CO-SUB)
 17177         MOVE 'ERROR OCCURED CONVERTING EARNING START DATE '
 17178                                     TO WS-ABEND-MESSAGE
 17179         MOVE DC-ERROR-CODE          TO WS-ABEND-FILE-STATUS
 17180         MOVE 4001                   TO WS-ABEND-CODE
 17181         GO TO ABEND-PGM.
 17182
 17183     IF CR-LFTYP = ZERO
 17184         GO TO S-4200-EP-DO-AH.
 17185
 17186     IF REIN-LF-FLG (SUB5) = SPACE
 17187         GO TO S-4200-EP-DO-AH.
 17188
 17189     MOVE LIFE-OVERRIDE-L1       TO WE-LF-AH.
 17190     MOVE CR-LFTYP               TO WE-BEN-TYPE.
 17191     PERFORM 4400-EP-FIND-TAB-ENT THRU 4499-EP-FIND-TAB-ENT-X.
 17192
 17193     MOVE CR-LF-TERM             TO ORIG-TERM.
 17194     MOVE CLAS-INDEXL            TO W-NDX.
 17195
 17196 S-4120-EP-DO-LF-CNCL.
 17197
 17198     IF CR-LF-STATUS-AT-CANCEL = ' '  AND
 17199        CLAS-I-CALC-TYPE (CLAS-INDEXL) NOT = 'Z'
 17200         GO TO S-4130-EP-DO-LF-EP.
 17201
 17202     COMPUTE EARNED-BY-CANCEL =
 17203                       (WE-LFPRM + WE-LFPRM-ALT) - WE-LFRFND.
 17204
 17205 S-4130-EP-DO-LF-EP.
 17206
 17207     MOVE SPACE                  TO STATUTORY-SWITCH.
 17208
 17209     MOVE EARNING-START-DATE     TO VALUATION-DT.
 17210     MOVE '9'                    TO W-VAL-SOURCE.
 17211     PERFORM 8500-REMAINING-TERM-ROUTINE THRU 8599-REM-TERM-X.
 17212
 17213     IF REM-TRM2 GREATER CR-LF-TERM
 17214         MOVE +0 TO EPR-R78  EPR-PRO  EPR-ST
 17215         GO TO S-4190-EP-DO-LF-COMM.
 17216
 17217     IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'Z'
 17218         GO TO S-4180-EP-DO-LF-EP-SUM.
 17219
 17220     IF CLAS-I-EP (CLAS-INDEXL) = 'B'
 17221         IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'L'
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 331
* ECS010P.cbl
 17222             IF REM-TRM2 NOT GREATER THAN +0
 17223                 COMPUTE EPR-R78 = WE-LFPRM + WE-LFPRM-ALT
 17224                 MOVE EPR-R78 TO EPR-PRO  EPR-ST
 17225                 GO TO S-4190-EP-DO-LF-COMM
 17226             ELSE
 17227                 NEXT SENTENCE
 17228         ELSE
 17229             IF W-BAL-REMTRM NOT GREATER +0
 17230                 COMPUTE EPR-R78 = WE-LFPRM + WE-LFPRM-ALT
 17231                 MOVE EPR-R78 TO EPR-PRO  EPR-ST
 17232                 GO TO S-4190-EP-DO-LF-COMM
 17233             ELSE
 17234                 NEXT SENTENCE
 17235     ELSE
 17236        IF (DTE-CLIENT EQUAL 'NCL') AND
 17237           (CLAS-I-CALC-TYPE (CLAS-INDEXL) EQUAL 'B')
 17238             MOVE WE-LFPRM TO EPR-R78  EPR-PRO  EPR-ST
 17239        ELSE
 17240         IF REM-TRM2 NOT GREATER +0  OR
 17241            CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'B'
 17242             MOVE WE-LFPRM TO EPR-R78  EPR-PRO  EPR-ST
 17243             GO TO S-4190-EP-DO-LF-COMM.
 17244
 17245     IF CLAS-I-EP (CLAS-INDEXL) = 'T'
 17246         GO TO S-4140-EP-DO-LF-EP-TEX.
 17247
 17248     IF CLAS-I-EP (CLAS-INDEXL) = 'N'
 17249         GO TO S-4150-EP-DO-LF-EP-NP.
 17250
 17251*    IF STATE-ABBR (CLAS-INDEXS) = 'OH'
 17252     IF (STATE-ABBR (CLAS-INDEXS) = 'OH') AND
 17253        (CR-RATING-CLASS NOT = 'L ')
 17254         IF (CR-APR GREATER THAN ZERO)  AND
 17255            (CR-LF-TERM GREATER THAN 060)  AND
 17256            (CR-DT GREATER THAN 19831031)
 17257             MOVE '*'             TO STATUTORY-SWITCH
 17258              GO TO S-4150-EP-DO-LF-EP-NP.
 17259
 17260     IF STATE-ABBR (CLAS-INDEXS) = 'MT'
 17261         IF (CR-APR GREATER THAN ZERO)  AND
 17262            (CR-LF-TERM GREATER THAN 061)  AND
 17263            (CR-DT GREATER THAN 19830318)
 17264             MOVE '*'             TO STATUTORY-SWITCH
 17265              GO TO S-4150-EP-DO-LF-EP-NP.
 17266
 17267     IF STATE-ABBR (CLAS-INDEXS) = 'UT'
 17268         IF (CR-APR GREATER THAN ZERO)  AND
 17269            (CR-LF-TERM GREATER THAN 062)  AND
 17270            (CR-DT GREATER THAN 19810831)  AND
 17271            (CR-DT LESS THAN 19830901)
 17272             MOVE '*'             TO STATUTORY-SWITCH
 17273              GO TO S-4150-EP-DO-LF-EP-NP.
 17274
 17275     IF STATE-ABBR (CLAS-INDEXS) = 'RI'
 17276         IF (CR-APR GREATER THAN ZERO)  AND
 17277            (CR-LF-TERM GREATER THAN 060)  AND
 17278            (CR-DT GREATER THAN 19831231)
 17279             MOVE '*'             TO STATUTORY-SWITCH
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 332
* ECS010P.cbl
 17280              GO TO S-4150-EP-DO-LF-EP-NP.
 17281
 17282     GO TO S-4160-EP-DO-LF-EP-R78.
 17283
 17284 S-4140-EP-DO-LF-EP-TEX.
 17285
 17286     COMPUTE TEX-FACT-4 =
 17287         (CR-LF-TERM * CR-LF-TERM) + (CR-PMT-FREQ * CR-LF-TERM).
 17288     DIVIDE REM-TRM1 BY CR-PMT-FREQ
 17289         GIVING TEX-FACT-5
 17290             REMAINDER TEX-FACT-6.
 17291     COMPUTE TEX-FACT-5 = TEX-FACT-5 * CR-PMT-FREQ.
 17292     COMPUTE TEX-FACT-7 = (TEX-FACT-5 * TEX-FACT-5) +
 17293         (TEX-FACT-5 * CR-PMT-FREQ) +
 17294         (2 * (TEX-FACT-6 * (TEX-FACT-5 + CR-PMT-FREQ))).
 17295     COMPUTE TEX-FACT-8 ROUNDED = TEX-FACT-7 / TEX-FACT-4.
 17296
 17297     COMPUTE EPR-R78 ROUNDED = WE-LFPRM - (WE-LFPRM * TEX-FACT-8).
 17298
 17299     GO TO S-4170-EP-DO-LF-EP-PRO.
 17300
 17301 S-4150-EP-DO-LF-EP-NP.
 17302
 17303     IF WE-LFPRM = ZERO
 17304         GO TO S-4160-EP-DO-LF-EP-R78.
 17305
 17306     IF DTE-CLIENT = 'CRI'
 17307       IF STATE-ABBR (CLAS-INDEXS) = ('AB' OR 'BC' OR 'MB' OR
 17308             'NS' OR 'ON' OR 'NB' OR 'NF' OR 'QB' OR 'SK' OR 'PE')
 17309           GO TO S-4160-EP-DO-LF-EP-R78.
 17310
 17311     IF DTE-CLIENT = 'NCL'
 17312       IF CR-DT LESS THAN 19910101
 17313           GO TO S-4160-EP-DO-LF-EP-R78.
 17314
 17315     IF REM-TRM1 = CR-LF-TERM
 17316         MOVE +0 TO EPR-R78  EPR-PRO  EPR-ST
 17317         GO TO S-4190-EP-DO-LF-COMM.
 17318
 17319     MOVE CR-APR TO NP-APR.
 17320     MOVE CR-LF-TERM TO NP-ORIG  NP-CAP.
 17321     MOVE REM-TRM1 TO NP-REM.
 17322     MOVE CLAS-I-CALC-TYPE (CLAS-INDEXL) TO NP-OPT.
 17323     IF NP-OPT = 'T' OR 'U' OR 'V' OR 'W' OR 'X'
 17324         MOVE CR-LOAN-TERM TO NP-ORIG.
 17325     MOVE 'R' TO NP-OPT.
 17326     CALL 'ECSNETRM'
 17327         USING NP-APR NP-ORIG NP-REM NP-OPT NP-CAP NP-FACTOR.
 17328
 17329     COMPUTE EPR-R78 ROUNDED = WE-LFPRM - (NP-FACTOR * WE-LFPRM).
 17330
 17331     IF STATUTORY-REQUIREMENT
 17332         MOVE EPR-R78                TO EPR-ST.
 17333
 17334 S-4160-EP-DO-LF-EP-R78.
 17335
 17336     IF (CLAS-I-CALC-TYPE (CLAS-INDEXL) EQUAL 'B') AND
 17337        (DTE-CLIENT EQUAL 'NCL')
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 333
* ECS010P.cbl
 17338        IF (CR-CCYY EQUAL EOM-CCYY) AND
 17339           (CR-MO EQUAL EOM-MO)
 17340           MOVE '*'            TO OB-DATE-1-SWITCH
 17341           MOVE EW-REIN-CO     TO WS-OB-REIN-CO (SUB3)
 17342           MOVE LIFE-OVERRIDE-L1 TO WS-OB-LF-AH (SUB3)
 17343           MOVE CR-LFTYP       TO WS-OB-BENEFIT-CODE (SUB3)
 17344           COMPUTE WS-EPR-R78 (SUB3 1) =
 17345                   WS-EPR-R78 (SUB3 1) - (WE-LFPRM * .5)
 17346           GO TO S-4190-EP-DO-LF-COMM
 17347        ELSE
 17348        IF (CR-CCYY EQUAL OB-CCYY (1)) AND
 17349           (CR-MO EQUAL OB-MO (1))
 17350           MOVE '*'            TO OB-DATE-2-SWITCH
 17351           MOVE EW-REIN-CO     TO WS-OB-REIN-CO (SUB3)
 17352           MOVE LIFE-OVERRIDE-L1 TO WS-OB-LF-AH (SUB3)
 17353           MOVE CR-LFTYP       TO WS-OB-BENEFIT-CODE (SUB3)
 17354           COMPUTE WS-EPR-R78 (SUB3 2) =
 17355                   WS-EPR-R78 (SUB3 2) - (WE-LFPRM * .5)
 17356           GO TO S-4190-EP-DO-LF-COMM
 17357        ELSE
 17358        IF (CR-CCYY EQUAL OB-CCYY (2)) AND
 17359           (CR-MO EQUAL OB-MO (2))
 17360           MOVE '*'            TO OB-DATE-3-SWITCH
 17361           MOVE EW-REIN-CO     TO WS-OB-REIN-CO (SUB3)
 17362           MOVE LIFE-OVERRIDE-L1 TO WS-OB-LF-AH (SUB3)
 17363           MOVE CR-LFTYP       TO WS-OB-BENEFIT-CODE (SUB3)
 17364           COMPUTE WS-EPR-R78 (SUB3 3) =
 17365                   WS-EPR-R78 (SUB3 3) - (WE-LFPRM * .5)
 17366           GO TO S-4190-EP-DO-LF-COMM
 17367        ELSE
 17368           GO TO S-4190-EP-DO-LF-COMM.
 17369
 17370     COMPUTE TEMP-1 = CR-LF-TERM * (CR-LF-TERM + 1).
 17371
 17372     IF DTE-R78 = '1'
 17373         COMPUTE TEMP-2 = REM-TRM1 * REM-TRM1
 17374     ELSE
 17375         COMPUTE TEMP-2 = REM-TRM1 * (REM-TRM1 + 1).
 17376
 17377     COMPUTE TEMP-4 ROUNDED EQUAL TEMP-2 / TEMP-1.
 17378
 17379     IF REM-TRM1 GREATER THAN +0
 17380         COMPUTE TEMP-7 ROUNDED EQUAL
 17381             WE-LFPRM - (WE-LFPRM * TEMP-4)
 17382     ELSE
 17383         MOVE WE-LFPRM                TO TEMP-7.
 17384
 17385     IF CLAS-I-EP (CLAS-INDEXL) NOT = 'B'
 17386         MOVE ZEROS                  TO TEMP-8
 17387         GO TO S-4165-END-LF-EP-R78.
 17388
 17389     IF EPR-ST NOT = ZEROS
 17390         MOVE TEMP-7                 TO EPR-ST.
 17391
 17392     IF CLAS-I-CALC-TYPE (CLAS-INDEXL) NOT = 'L'
 17393         COMPUTE TEMP-1 = (CR-LF-TERM + 1) * (CR-LF-TERM + 2)
 17394         COMPUTE TEMP-2 = (REM-TRM1 + 1) * (REM-TRM1 + 2)
 17395         IF DTE-R78 = '1'
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 334
* ECS010P.cbl
 17396             COMPUTE TEMP-2 = (REM-TRM1 + 1) * (REM-TRM1 + 1).
 17397
 17398     COMPUTE TEMP-4 ROUNDED EQUAL TEMP-2 / TEMP-1.
 17399
 17400     COMPUTE TEMP-8 ROUNDED =
 17401               WE-LFPRM-ALT - (WE-LFPRM-ALT * TEMP-4).
 17402
 17403 S-4165-END-LF-EP-R78.
 17404
 17405     IF EPR-R78 = ZEROS
 17406         COMPUTE EPR-R78 = TEMP-7 + TEMP-8
 17407     ELSE
 17408         COMPUTE EPR-R78 = EPR-R78 + TEMP-8.
 17409
 17410 S-4170-EP-DO-LF-EP-PRO.
 17411
 17412     IF DTE-CLIENT = 'MIC' OR 'MCC'
 17413         COMPUTE TEMP-5 ROUNDED = (REM-TRM1 - .5) / CR-LF-TERM
 17414     ELSE
 17415         COMPUTE TEMP-5 ROUNDED = REM-TRM1 / CR-LF-TERM.
 17416
 17417     IF REM-TRM1 GREATER THAN +0
 17418         COMPUTE TEMP-7 ROUNDED = WE-LFPRM - (WE-LFPRM * TEMP-5)
 17419     ELSE
 17420         MOVE WE-LFPRM                  TO TEMP-7.
 17421
 17422     IF CLAS-I-EP (CLAS-INDEXL) NOT = 'B'
 17423         MOVE ZEROS                     TO TEMP-8
 17424         GO TO S-4175-END-LF-EP-PRO.
 17425
 17426     IF CLAS-I-CALC-TYPE (CLAS-INDEXL) NOT = 'L'
 17427         IF DTE-CLIENT = 'MIC' OR 'MCC'
 17428             COMPUTE TEMP-5 ROUNDED =
 17429                           (REM-TRM1 + .5) / (CR-LF-TERM + 1)
 17430         ELSE
 17431             COMPUTE TEMP-5 ROUNDED =
 17432                           (REM-TRM1 + 1) / (CR-LF-TERM + 1).
 17433
 17434     COMPUTE TEMP-8 ROUNDED =
 17435                   WE-LFPRM-ALT - (WE-LFPRM-ALT * TEMP-5).
 17436
 17437     COMPUTE EPR-ST = EPR-ST + TEMP-8.
 17438
 17439 S-4175-END-LF-EP-PRO.
 17440
 17441     COMPUTE EPR-PRO = TEMP-7 + TEMP-8.
 17442
 17443     GO TO S-4185-EP-DO-LF-STATUTORY.
 17444
 17445 S-4180-EP-DO-LF-EP-SUM.
 17446
 17447     IF REM-TRM1 NOT GREATER +0
 17448         COMPUTE EPR-R78 = (WE-LFPRM + WE-LFPRM-ALT) - WE-LFRFND
 17449         MOVE EPR-R78 TO EPR-PRO  EPR-ST
 17450         GO TO S-4190-EP-DO-LF-COMM.
 17451
 17452     IF WE-LFPRM = ZERO  AND  WE-LFPRM-ALT = ZERO
 17453         MOVE ZEROS                 TO TEMP-7
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 335
* ECS010P.cbl
 17454     ELSE
 17455         COMPUTE TEMP-7 ROUNDED = WE-LFPRM - (WE-LFRFND *
 17456                       (WE-LFPRM / (WE-LFPRM + WE-LFPRM-ALT))).
 17457
 17458     IF TEMP-7 NOT GREATER ZERO
 17459         IF CLAS-I-EP (CLAS-INDEXL) NOT = 'B'
 17460             MOVE ZEROS             TO EPR-R78  EPR-PRO  EPR-ST
 17461             GO TO S-4190-EP-DO-LF-COMM
 17462         ELSE
 17463             MOVE ZEROS             TO TEMP-7.
 17464
 17465     COMPUTE TEMP-1 = CR-LF-TERM * (CR-LF-TERM + 1).
 17466     COMPUTE TEMP-2 = REM-TRM1 * (REM-TRM1 + 1).
 17467     IF DTE-R78 = '1'
 17468         COMPUTE TEMP-2 = REM-TRM1 * REM-TRM1.
 17469
 17470     COMPUTE TEMP-4 ROUNDED = TEMP-2 / TEMP-1.
 17471     COMPUTE TEMP-5 ROUNDED = REM-TRM1 / CR-LF-TERM.
 17472
 17473     COMPUTE EPR-R78 ROUNDED = TEMP-7 - (TEMP-7 * TEMP-4).
 17474
 17475     COMPUTE EPR-PRO ROUNDED = TEMP-7 - (TEMP-7 * TEMP-5).
 17476
 17477     IF CLAS-I-EP (CLAS-INDEXL) NOT = 'B'
 17478         GO TO S-4185-EP-DO-LF-STATUTORY.
 17479
 17480     MOVE EPR-R78                  TO EPR-ST.
 17481
 17482     IF WE-LFPRM = ZERO  AND  WE-LFPRM-ALT = ZERO
 17483         MOVE ZEROS                 TO TEMP-8
 17484     ELSE
 17485         COMPUTE TEMP-8 ROUNDED = WE-LFPRM-ALT - (WE-LFRFND *
 17486                     (WE-LFPRM-ALT / (WE-LFPRM + WE-LFPRM-ALT))).
 17487
 17488     IF TEMP-8 NOT GREATER ZERO
 17489         GO TO S-4185-EP-DO-LF-STATUTORY.
 17490
 17491     COMPUTE EPR-R78 ROUNDED = EPR-R78 +
 17492                              (TEMP-8 - (TEMP-8 * TEMP-4)).
 17493
 17494     COMPUTE EPR-PRO ROUNDED = EPR-PRO +
 17495                              (TEMP-8 - (TEMP-8 * TEMP-5)).
 17496
 17497     COMPUTE EPR-ST ROUNDED = EPR-ST +
 17498                             (TEMP-8 - (TEMP-8 * TEMP-5)).
 17499
 17500 S-4185-EP-DO-LF-STATUTORY.
 17501
 17502     IF STATE-ABBR (CLAS-INDEXS) = 'AL'
 17503         MOVE EPR-R78                TO EPR-ST.
 17504
 17505     IF STATE-ABBR (CLAS-INDEXS) = 'WY'
 17506         MOVE EPR-PRO                TO EPR-ST.
 17507
 17508     IF EPR-ST NOT = ZEROS
 17509         GO TO S-4190-EP-DO-LF-COMM.
 17510
 17511     IF CLAS-I-RL-AH (CLAS-INDEXL) = 'R'
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 336
* ECS010P.cbl
 17512         MOVE EPR-R78                TO EPR-ST
 17513     ELSE
 17514         MOVE EPR-PRO                TO EPR-ST.
 17515
 17516 S-4190-EP-DO-LF-COMM.
 17517
 17518     IF EARNED-BY-CANCEL = ZEROS
 17519         GO TO S-4195-LF-COMM-CONTINUE.
 17520
 17521     IF EPR-R78 GREATER THAN EARNED-BY-CANCEL
 17522         MOVE EARNED-BY-CANCEL     TO EPR-R78.
 17523
 17524     IF EPR-PRO GREATER THAN EARNED-BY-CANCEL
 17525         MOVE EARNED-BY-CANCEL     TO EPR-PRO.
 17526
 17527     IF EPR-ST  GREATER THAN EARNED-BY-CANCEL
 17528         MOVE EARNED-BY-CANCEL     TO EPR-ST.
 17529
 17530 S-4195-LF-COMM-CONTINUE.
 17531
 17532     MOVE +0 TO SUB1.
 17533     PERFORM S-4300-EP-COMM-LOOP THRU S-4399-EP-COMM-LOOP-X
 17534         10 TIMES.
 17535
 17536     COMPUTE EW-EPR-R78 = EW-EPR-R78 - EPR-R78.
 17537     COMPUTE EW-EPR-PRO = EW-EPR-PRO - EPR-PRO.
 17538     COMPUTE EW-EPR-ST  = EW-EPR-ST  - EPR-ST.
 17539
 17540     COMPUTE EW-EPR-R78-ADJ = EW-EPR-R78-ADJ + EPR-R78.
 17541     COMPUTE EW-EPR-PRO-ADJ = EW-EPR-PRO-ADJ + EPR-PRO.
 17542     COMPUTE EW-EPR-ST-ADJ  = EW-EPR-ST-ADJ  + EPR-ST.
 17543
 17544     MOVE 'Y'          TO EW-LEVEL-USED.
 17545
 17546     IF CR-POLICY-UNDERWRITTEN
 17547         MOVE EPEC-WORK       TO EPEC-LEVELS-II (SUB3)
 17548
 17549     ELSE
 17550         MOVE EPEC-WORK       TO EPEC-LEVELS (SUB3).
 17551
 17552     GO TO S-4200-EP-DO-AH.
 17553
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 337
* ECS010P.cbl
 17555******************************************************************
 17556***  C A L C U L A T E   A & H   S T A R T   E A R N E D       ***
 17557******************************************************************
 17558
 17559 S-4200-EP-DO-AH.
 17560
 17561     MOVE +0                         TO EPR-R78  EARNED-BY-CANCEL
 17562                                        EPR-PRO
 17563                                        EPR-ST.
 17564
 17565     IF CR-AHTYP = ZERO
 17566         GO TO S-4299-EPBX.
 17567
 17568     IF REIN-AH-FLG (SUB5) = SPACE
 17569         GO TO S-4299-EPBX.
 17570
 17571     MOVE AH-OVERRIDE-L1       TO WE-LF-AH.
 17572     MOVE CR-AHTYP             TO WE-BEN-TYPE.
 17573     PERFORM 4400-EP-FIND-TAB-ENT THRU 4499-EP-FIND-TAB-ENT-X.
 17574
 17575     MOVE CR-AH-TERM           TO ORIG-TERM.
 17576     MOVE CLAS-INDEXA          TO W-NDX.
 17577
 17578     MOVE EARNING-START-DATE     TO VALUATION-DT.
 17579     MOVE '9'                    TO W-VAL-SOURCE.
 17580     PERFORM 8500-REMAINING-TERM-ROUTINE THRU 8599-REM-TERM-X.
 17581
 17582 S-4220-EP-DO-AH-CNCL.
 17583
 17584     IF CR-AH-STATUS-AT-CANCEL NOT = ' '
 17585         COMPUTE EARNED-BY-CANCEL = WE-AHPRM - WE-AHRFND.
 17586
 17587 S-4230-EP-DO-AH-EP.
 17588
 17589     IF REM-TRM2 GREATER CR-AH-TERM
 17590         MOVE +0 TO EPR-R78  EPR-PRO  EPR-ST
 17591         GO TO S-4290-EP-DO-AH-COMM.
 17592
 17593     IF CLAS-I-CALC-TYPE (CLAS-INDEXA) = 'Z'
 17594         COMPUTE WE-AHPRM = WE-AHPRM - WE-AHRFND.
 17595
 17596 S-4235-CHECK-OB-AH-NCL.
 17597
 17598     IF (DTE-CLIENT EQUAL 'NCL') AND
 17599        (CLAS-I-CALC-TYPE (CLAS-INDEXA) EQUAL 'B')
 17600           MOVE WE-AHPRM         TO EPR-R78
 17601                                    EPR-PRO
 17602                                    EPR-ST
 17603        IF (CR-CCYY EQUAL EOM-CCYY) AND
 17604           (CR-MO EQUAL EOM-MO)
 17605           MOVE '*'            TO OB-DATE-1-SWITCH
 17606           MOVE EW-REIN-CO     TO WS-OB-REIN-CO (SUB3)
 17607           MOVE AH-OVERRIDE-L1 TO WS-OB-LF-AH (SUB3)
 17608           MOVE CR-AHTYP       TO WS-OB-BENEFIT-CODE (SUB3)
 17609           COMPUTE WS-EPR-R78 (SUB3 1) =
 17610                   WS-EPR-R78 (SUB3 1) - (WE-AHPRM * .5)
 17611            GO TO S-4290-EP-DO-AH-COMM
 17612        ELSE
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 338
* ECS010P.cbl
 17613        IF (CR-CCYY EQUAL OB-CCYY (1)) AND
 17614           (CR-MO EQUAL OB-MO (1))
 17615           MOVE '*'            TO OB-DATE-2-SWITCH
 17616           MOVE EW-REIN-CO     TO WS-OB-REIN-CO (SUB3)
 17617           MOVE AH-OVERRIDE-L1 TO WS-OB-LF-AH (SUB3)
 17618           MOVE CR-AHTYP       TO WS-OB-BENEFIT-CODE (SUB3)
 17619           COMPUTE WS-EPR-R78 (SUB3 2) =
 17620                   WS-EPR-R78 (SUB3 2) - (WE-AHPRM * .5)
 17621            GO TO S-4290-EP-DO-AH-COMM
 17622        ELSE
 17623        IF (CR-CCYY EQUAL OB-CCYY (2)) AND
 17624           (CR-MO EQUAL OB-MO (2))
 17625           MOVE '*'            TO OB-DATE-3-SWITCH
 17626           MOVE EW-REIN-CO     TO WS-OB-REIN-CO (SUB3)
 17627           MOVE AH-OVERRIDE-L1 TO WS-OB-LF-AH (SUB3)
 17628           MOVE CR-AHTYP       TO WS-OB-BENEFIT-CODE (SUB3)
 17629           COMPUTE WS-EPR-R78 (SUB3 3) =
 17630                   WS-EPR-R78 (SUB3 3) - (WE-AHPRM * .5)
 17631            GO TO S-4290-EP-DO-AH-COMM
 17632        ELSE
 17633            GO TO S-4290-EP-DO-AH-COMM.
 17634
 17635     IF REM-TRM2 NOT GREATER +0
 17636         MOVE WE-AHPRM TO EPR-R78  EPR-PRO  EPR-ST
 17637         GO TO S-4290-EP-DO-AH-COMM.
 17638
 17639     IF CLAS-I-CALC-TYPE (CLAS-INDEXA) = 'B'
 17640         MOVE WE-AHPRM TO EPR-R78  EPR-PRO  EPR-ST
 17641         GO TO S-4290-EP-DO-AH-COMM.
 17642
 17643     COMPUTE TEMP-1 = CR-AH-TERM * (CR-AH-TERM + 1).
 17644     COMPUTE TEMP-2 = REM-TRM1 * (REM-TRM1 + 1).
 17645     IF DTE-R78 = '1'
 17646         COMPUTE TEMP-2 = REM-TRM1 * REM-TRM1.
 17647     COMPUTE TEMP-4 ROUNDED = TEMP-2 / TEMP-1.
 17648
 17649     IF DTE-CLIENT = 'MIC' OR 'MCC'
 17650         COMPUTE TEMP-5 ROUNDED = (REM-TRM1 - .5) / CR-AH-TERM
 17651     ELSE
 17652         COMPUTE TEMP-5 ROUNDED = REM-TRM1 / CR-AH-TERM.
 17653
 17654     COMPUTE EPR-R78 ROUNDED = WE-AHPRM * TEMP-4.
 17655     COMPUTE EPR-R78 = WE-AHPRM - EPR-R78.
 17656
 17657     COMPUTE EPR-PRO ROUNDED = WE-AHPRM * TEMP-5.
 17658     COMPUTE EPR-PRO = WE-AHPRM - EPR-PRO.
 17659
 17660     MOVE  CLAS-I-EP (CLAS-INDEXA) TO AH-EARN-METHOD.
 17661
 17662*    IF AM-EARN-METHOD-A NOT EQUAL SPACES AND ZEROS
 17663*        MOVE AM-EARN-METHOD-A TO AH-EARN-METHOD.
 17664
 17665     MOVE SPACES TO STATUTORY-SWITCH-AH.
 17666
 17667     IF (STATE-ABBR (CLAS-INDEXS) = 'VA') AND
 17668        (CR-DT GREATER THAN  19921231)
 17669         IF CR-AH-TERM GREATER THAN  +61
 17670             MOVE 'A' TO AH-EARN-METHOD
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 339
* ECS010P.cbl
 17671             MOVE '*' TO STATUTORY-SWITCH-AH
 17672             GO TO S-4245-EP-DO-AH-EP-AN
 17673         ELSE
 17674             GO TO S-4250-EP-DO-AH-STATUTORY.
 17675
 17676     IF AH-EARN-METHOD EQUAL 'N'
 17677         GO TO S-4240-EP-DO-AH-EP-NP.
 17678
 17679     IF AH-EARN-METHOD EQUAL 'A' OR 'C'
 17680         MOVE 'A' TO AH-EARN-METHOD
 17681         GO TO S-4245-EP-DO-AH-EP-AN.
 17682
 17683     GO TO S-4250-EP-DO-AH-STATUTORY.
 17684
 17685 S-4240-EP-DO-AH-EP-NP.
 17686
 17687     IF WE-AHPRM = ZERO
 17688         GO TO S-4250-EP-DO-AH-STATUTORY.
 17689
 17690     IF CR-APR GREATER THAN +0
 17691         NEXT SENTENCE
 17692     ELSE
 17693         GO TO S-4250-EP-DO-AH-STATUTORY.
 17694
 17695     IF DTE-CLIENT = 'NCL'
 17696       IF CR-DT LESS THAN 19910101
 17697           GO TO S-4250-EP-DO-AH-STATUTORY.
 17698
 17699     IF REM-TRM1 = CR-AH-TERM
 17700         MOVE +0 TO EPR-R78  EPR-PRO  EPR-ST
 17701         GO TO S-4290-EP-DO-AH-COMM.
 17702
 17703     MOVE CR-APR TO NP-APR.
 17704     MOVE CR-AH-TERM TO NP-ORIG  NP-CAP.
 17705     MOVE REM-TRM1 TO NP-REM.
 17706     MOVE CLAS-I-CALC-TYPE (CLAS-INDEXA) TO NP-OPT.
 17707     IF NP-OPT = 'T' OR 'U' OR 'V' OR 'W' OR 'X'
 17708         MOVE CR-LOAN-TERM TO NP-ORIG.
 17709     MOVE 'R' TO NP-OPT.
 17710     CALL 'ECSNETRM'
 17711         USING NP-APR NP-ORIG NP-REM NP-OPT NP-CAP NP-FACTOR.
 17712
 17713     COMPUTE EPR-R78 ROUNDED = WE-AHPRM - (NP-FACTOR * WE-AHPRM).
 17714
 17715     GO TO S-4250-EP-DO-AH-STATUTORY.
 17716
 17717 S-4245-EP-DO-AH-EP-AN.
 17718     MOVE CR-DT                      TO DC-GREG-DATE-CYMD.
 17719     MOVE 'L'                        TO DC-OPTION-CODE.
 17720     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 17721     MOVE DC-BIN-DATE-1              TO CP-CERT-EFF-DT.
 17722     MOVE CLAS-I-RL-AH (CLAS-INDEXA) TO CP-BENEFIT-TYPE.
 17723     MOVE SPACES                     TO CP-ACCT-FLD-5.
 17724     MOVE DTE-CLIENT                 TO CP-COMPANY-ID.
 17725     MOVE STATE-SUB (CLAS-INDEXS)    TO CP-STATE.
 17726     MOVE STATE-ABBR (CLAS-INDEXS)   TO CP-STATE-STD-ABBRV.
 17727     MOVE CR-AGE                     TO CP-ISSUE-AGE.
 17728     MOVE REM-TRM1                   TO CP-ORIGINAL-TERM.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 340
* ECS010P.cbl
 17729     MOVE CR-AHAMT                   TO CP-ORIGINAL-BENEFIT
 17730                                        CP-RATING-BENEFIT-AMT.
 17731     IF CP-STATE-STD-ABBRV = 'OR'
 17732         COMPUTE CP-RATING-BENEFIT-AMT =
 17733                                  CR-AHAMT * REM-TRM1.
 17734     MOVE CR-APR                     TO CP-LOAN-APR.
 17735     MOVE CR-PMT-FREQ                TO CP-PAY-FREQUENCY.
 17736     MOVE AH-EARN-METHOD             TO CP-EARNING-METHOD.
 17737     MOVE '3'                        TO CP-PROCESS-TYPE.
 17738     MOVE CLAS-I-BAL (CLAS-INDEXA)   TO CP-SPECIAL-CALC-CD.
 17739     MOVE CR-LOAN-TERM               TO CP-LOAN-TERM.
 17740
 17741     IF CR-RATING-CLASS NOT = SPACE AND ZERO
 17742         MOVE CR-RATING-CLASS        TO CP-CLASS-CODE
 17743     ELSE
 17744         MOVE AM-CAL-TABLE           TO CP-CLASS-CODE.
 17745
 17746     MOVE AM-AH-DEVIATION            TO CP-DEVIATION-CODE.
 17747     MOVE CR-AHTYP                   TO CP-BENEFIT-CD.
 17748     MOVE DTE-CLASIC-COMPANY-CD      TO CP-COMPANY-CD.
 17749     MOVE CR-PMT-EXTENSION-DAYS      TO CP-TERM-OR-EXT-DAYS.
 17750     MOVE AH-OVERRIDE-L1             TO CP-AH-OVERRIDE-CODE.
 17751     MOVE AM-AH-DEVIATION-PCT        TO CP-RATE-DEV-PCT.
 17752
 17753     PERFORM 8100-GET-RATE THRU 8199-GET-RATE-X.
 17754
 17755     IF CP-ERROR-RATE-NOT-FOUND  OR
 17756        CP-ERROR-RATE-IS-ZERO  OR
 17757        CP-ERROR-IN-DATES
 17758         GO TO S-4250-EP-DO-AH-STATUTORY.
 17759
 17760     COMPUTE EPR-R78 ROUNDED =
 17761             ((REM-TRM1 * WE-AHAMT) / +100) *
 17762               CP-PREMIUM-RATE.
 17763
 17764     COMPUTE EPR-R78 = WE-AHPRM - EPR-R78.
 17765
 17766     IF STATUTORY-REQUIREMENT-AH
 17767         MOVE EPR-R78                TO EPR-ST
 17768         GO TO S-4290-EP-DO-AH-COMM.
 17769
 17770 S-4250-EP-DO-AH-STATUTORY.
 17771     MOVE EPR-R78                    TO EPR-ST.
 17772
 17773     MOVE +0                         TO SUB1.
 17774
 17775 S-4255-EP-AH-STAT-LOOP.
 17776     ADD +1 TO SUB1.
 17777
 17778     IF STATE-ABBR (CLAS-INDEXS) = AH-RES-STATE-ENT (SUB1)
 17779         MOVE EPR-PRO                TO EPR-ST
 17780     ELSE
 17781         IF AH-RES-STATE-ENT (SUB1) NOT = HIGH-VALUES
 17782             GO TO S-4255-EP-AH-STAT-LOOP.
 17783
 17784     IF (STATE-ABBR (CLAS-INDEXS) = 'OH'  AND
 17785         CR-DT GREATER THAN 19831031)
 17786                    OR
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 341
* ECS010P.cbl
 17787        (STATE-ABBR (CLAS-INDEXS) = 'OK'  AND
 17788         CR-DT GREATER THAN 19820629)
 17789                    OR
 17790        (STATE-ABBR (CLAS-INDEXS) = 'TX'  AND
 17791         CR-DT GREATER THAN 19830831)
 17792             COMPUTE EPR-ST = (EPR-R78 + EPR-PRO) / 2.
 17793
 17794     IF DTE-CLIENT = 'CSO'  OR  'CID'
 17795       IF STATE-ABBR (CLAS-INDEXS) = 'CO'
 17796         IF CR-DT LESS THAN 19970101
 17797             MOVE EPR-R78            TO EPR-ST
 17798         ELSE
 17799             COMPUTE EPR-ST = (EPR-R78 + EPR-PRO) / 2.
 17800
 17801 S-4290-EP-DO-AH-COMM.
 17802
 17803     IF EARNED-BY-CANCEL = ZEROS
 17804         GO TO S-4295-AH-COMM-CONTINUE.
 17805
 17806     IF EPR-R78 GREATER THAN EARNED-BY-CANCEL
 17807         MOVE EARNED-BY-CANCEL     TO EPR-R78.
 17808
 17809     IF EPR-PRO GREATER THAN EARNED-BY-CANCEL
 17810         MOVE EARNED-BY-CANCEL     TO EPR-PRO.
 17811
 17812     IF EPR-ST  GREATER THAN EARNED-BY-CANCEL
 17813         MOVE EARNED-BY-CANCEL     TO EPR-ST.
 17814
 17815 S-4295-AH-COMM-CONTINUE.
 17816
 17817     MOVE +0           TO SUB1.
 17818     PERFORM S-4300-EP-COMM-LOOP THRU S-4399-EP-COMM-LOOP-X
 17819         10 TIMES.
 17820
 17821     COMPUTE EW-EPR-R78 = EW-EPR-R78 - EPR-R78.
 17822     COMPUTE EW-EPR-PRO = EW-EPR-PRO - EPR-PRO.
 17823     COMPUTE EW-EPR-ST  = EW-EPR-ST  - EPR-ST.
 17824
 17825     COMPUTE EW-EPR-R78-ADJ = EW-EPR-R78-ADJ + EPR-R78.
 17826     COMPUTE EW-EPR-PRO-ADJ = EW-EPR-PRO-ADJ + EPR-PRO.
 17827     COMPUTE EW-EPR-ST-ADJ  = EW-EPR-ST-ADJ  + EPR-ST.
 17828
 17829     MOVE 'Y'          TO EW-LEVEL-USED.
 17830
 17831     IF CR-POLICY-UNDERWRITTEN
 17832         MOVE EPEC-WORK       TO EPEC-LEVELS-II (SUB3)
 17833     ELSE
 17834         MOVE EPEC-WORK       TO EPEC-LEVELS (SUB3).
 17835
 17836
 17837 S-4299-EPBX.
 17838     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 342
* ECS010P.cbl
 17840******************************************************************
 17841***    C A L C U L A T E   S T A R T   E A R N E D   C O M M   ***
 17842******************************************************************
 17843
 17844 S-4300-EP-COMM-LOOP.
 17845
 17846     ADD +1 TO SUB1.
 17847     IF CR-COM-AGT (SUB1) = SPACES OR ZEROS
 17848         GO TO S-4399-EP-COMM-LOOP-X.
 17849
 17850     IF EW-LF-AH = AH-OVERRIDE-L1
 17851         GO TO S-4350-EP-COMM-LOOP-A.
 17852
 17853*    IF CR-AGT-TYPE (SUB1) = 'K'
 17854*       COMPUTE COMM-WK =
 17855     COMPUTE COMM-WK ROUNDED = EPR-R78 * CR-LCOM-L (SUB1).
 17856     COMPUTE EW-ECR-R78 (SUB1) = EW-ECR-R78 (SUB1) - COMM-WK.
 17857     COMPUTE EW-ECR-R78-ADJ (SUB1) =
 17858                                 EW-ECR-R78-ADJ (SUB1) + COMM-WK.
 17859
 17860     COMPUTE COMM-WK ROUNDED = EPR-PRO * CR-LCOM-L (SUB1).
 17861     COMPUTE EW-ECR-PRO (SUB1) = EW-ECR-PRO (SUB1) - COMM-WK.
 17862     COMPUTE EW-ECR-PRO-ADJ (SUB1) =
 17863                                 EW-ECR-PRO-ADJ (SUB1) + COMM-WK.
 17864
 17865     COMPUTE COMM-WK ROUNDED = EPR-ST * CR-LCOM-L (SUB1).
 17866     COMPUTE EW-ECR-ST (SUB1) = EW-ECR-ST (SUB1) - COMM-WK.
 17867
 17868     GO TO S-4399-EP-COMM-LOOP-X.
 17869
 17870 S-4350-EP-COMM-LOOP-A.
 17871
 17872     COMPUTE COMM-WK ROUNDED = EPR-R78 * CR-LCOM-AH (SUB1).
 17873     COMPUTE EW-ECR-R78 (SUB1) = EW-ECR-R78 (SUB1) - COMM-WK.
 17874     COMPUTE EW-ECR-R78-ADJ (SUB1) =
 17875                                 EW-ECR-R78-ADJ (SUB1) + COMM-WK.
 17876
 17877     COMPUTE COMM-WK ROUNDED = EPR-PRO * CR-LCOM-AH (SUB1).
 17878     COMPUTE EW-ECR-PRO (SUB1) = EW-ECR-PRO (SUB1) - COMM-WK.
 17879     COMPUTE EW-ECR-PRO-ADJ (SUB1) =
 17880                                 EW-ECR-PRO-ADJ (SUB1) + COMM-WK.
 17881
 17882     COMPUTE COMM-WK ROUNDED = EPR-ST * CR-LCOM-AH (SUB1).
 17883     COMPUTE EW-ECR-ST (SUB1) = EW-ECR-ST (SUB1) - COMM-WK.
 17884
 17885 S-4399-EP-COMM-LOOP-X.
 17886     EXIT.
 17887
 17888******************************************************************
 17889******************************************************************
 17890******************************************************************
 17891******************************************************************
 17892******************************************************************
 17893******************************************************************
 17894******************************************************************
 17895******************************************************************
 17896******************************************************************
 17897******************************************************************
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 343
* ECS010P.cbl
 17899******************************************************************
 17900***     F I N D   R E I N S U R A N C E   T A B L E   S U B    ***
 17901******************************************************************
 17902
 17903 4400-EP-FIND-TAB-ENT.
 17904
 17905     IF WE-REIN-CO = EPEC-SUB-REIN (SUB9)
 17906         GO TO 4490-EP-FIND-TAB-SUB.
 17907     MOVE +1 TO SUB9.
 17908
 17909 4450-EP-FIND-TAB-LOOP.
 17910
 17911     IF WE-REIN-CO = EPEC-SUB-REIN (SUB9)
 17912         GO TO 4490-EP-FIND-TAB-SUB.
 17913     IF EPEC-SUB-REIN (SUB9) = ZEROS
 17914         MOVE WE-REIN-CO TO EPEC-SUB-REIN (SUB9)
 17915         GO TO 4490-EP-FIND-TAB-SUB.
 17916
 17917     ADD +1 TO SUB9.
 17918     IF SUB9 GREATER THAN +31
 17919         DISPLAY 'EPEC SUBSCRIPT TABLE FULL ' AM-MSTR-CNTRL
 17920         MOVE 0201 TO WS-ABEND-CODE
 17921         DISPLAY '******************************'
 17922         DISPLAY '***** ERROR LOCATION 020 *****'
 17923         DISPLAY '******************************'
 17924         MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
 17925         GO TO ABEND-PGM.
 17926
 17927     GO TO 4450-EP-FIND-TAB-LOOP.
 17928
 17929 4490-EP-FIND-TAB-SUB.
 17930
 17931     IF WE-LF-AH = LIFE-OVERRIDE-L1
 17932         IF EPEC-SUB-LF (SUB9 CLAS-INDEXL) = ZERO
 17933             ADD +1 TO SUB10
 17934             MOVE SUB10 TO SUB3
 17935             MOVE SUB10 TO EPEC-SUB-LF (SUB9 CLAS-INDEXL)
 17936         ELSE
 17937             MOVE EPEC-SUB-LF (SUB9 CLAS-INDEXL) TO SUB3.
 17938
 17939     IF WE-LF-AH = AH-OVERRIDE-L1
 17940         IF EPEC-SUB-AH (SUB9 CLAS-INDEXA) = ZERO
 17941             ADD +1 TO SUB10
 17942             MOVE SUB10 TO SUB3
 17943             MOVE SUB10 TO EPEC-SUB-AH (SUB9 CLAS-INDEXA)
 17944         ELSE
 17945             MOVE EPEC-SUB-AH (SUB9 CLAS-INDEXA) TO SUB3.
 17946
 17947*    IF SUB3 GREATER THAN +220
 17948*    IF SUB3 GREATER THAN +300
 17949     IF SUB3 GREATER THAN +900
 17950         DISPLAY 'SUB3 VALUE IS - ' SUB3
 17951         DISPLAY 'EPEC WORK TABLE FULL ' AM-MSTR-CNTRL
 17952         MOVE 0202 TO WS-ABEND-CODE
 17953         DISPLAY '******************************'
 17954         DISPLAY '***** ERROR LOCATION 021 *****'
 17955         DISPLAY '******************************'
 17956         MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 344
* ECS010P.cbl
 17957         GO TO ABEND-PGM.
 17958
 17959     IF CR-POLICY-UNDERWRITTEN
 17960         MOVE EPEC-LEVELS-II (SUB3)  TO EPEC-WORK
 17961         MOVE EPEC-UNDW-OPT-DATA-TABLE
 17962                                     TO EPEC-OPT-WORK-TABLE
 17963     ELSE
 17964         MOVE EPEC-LEVELS (SUB3)     TO EPEC-WORK
 17965         MOVE EPEC-OPT-DATA-TABLE    TO EPEC-OPT-WORK-TABLE.
 17966
 17967     MOVE WE-REIN-CO         TO EW-REIN-CO
 17968                                EPEC-REIN-CO (SUB3)
 17969                                EPEC-REIN-CO-II (SUB3).
 17970     MOVE WE-LF-AH           TO EW-LF-AH
 17971                                EPEC-LF-AH (SUB3)
 17972                                EPEC-LF-AH-II (SUB3).
 17973     MOVE WE-BEN-TYPE        TO EW-BEN-TYPE
 17974                                EPEC-BEN-TYPE (SUB3)
 17975                                EPEC-BEN-TYPE-II (SUB3).
 17976
 17977 4499-EP-FIND-TAB-ENT-X.
 17978     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 345
* ECS010P.cbl
 17980******************************************************************
 17981***         B U I L D   S U M M A R Y   E X T R A C T S        ***
 17982******************************************************************
 17983
 17984 4500-BUILD-EPEC-EXTRACT.
 17985
 17986     IF DTE-CLIENT = 'DCC'
 17987        PERFORM 4541-CALC-IBNR   THRU 4541-EXIT
 17988     END-IF
 17989
 17990     PERFORM 4510-BUILD-EPEC-EXT THRU 4519-BUILD-EPEC-EXT-X
 17991         VARYING SUB2 FROM +1 BY +1
 17992             UNTIL EPEC-REIN-CO (SUB2) = ZEROS.
 17993
 17994     PERFORM 4550-CLEAR-EPEC-TOTALS THRU 4589-CLEAR-EPEC-TOTALS-X.
 17995
 17996     GO TO 4599-BUILD-EPEC-EXTRACT-X.
 17997
 17998
 17999 4510-BUILD-EPEC-EXT.
 18000
 18001     MOVE EPEC-LEVELS (SUB2)            TO EPEC-WORK.
 18002     MOVE EPEC-OPT-DATA-TABLE           TO EPEC-OPT-WORK-TABLE.
 18003     IF EW-LEVEL-USED = 'Y'
 18004         MOVE SPACE                     TO W-UNDERWRITING-SW
 18005         PERFORM 4511-BUILD-EPEC-RECORD THRU
 18006                 4518-BUILD-EPEC-RCD-X.
 18007
 18008     MOVE EPEC-LEVELS-II (SUB2)         TO EPEC-WORK.
 18009     MOVE EPEC-UNDW-OPT-DATA-TABLE      TO EPEC-OPT-WORK-TABLE.
 18010     IF EW-LEVEL-USED = 'Y'
 18011         MOVE '*'                       TO W-UNDERWRITING-SW
 18012         PERFORM 4511-BUILD-EPEC-RECORD THRU
 18013                 4518-BUILD-EPEC-RCD-X.
 18014
 18015     GO TO 4519-BUILD-EPEC-EXT-X.
 18016
 18017 4511-BUILD-EPEC-RECORD.
 18018
 18019     MOVE SPACES                        TO EP-RECORD.
 18020     MOVE 'EP'                          TO EP-RECORD-ID.
 18021     MOVE DTE-CLASIC-COMPANY-CD         TO EP-COMPANY-CD.
 18022     MOVE AM-MSTR-CNTRL                 TO EP-CONTROL.
 18023     MOVE AM-EXPIRE-DT                  TO WS-EP-EXP-DTE-N.
 18024     MOVE AM-EFFECT-DT                  TO EP-EFF-DTE
 18025                                           WS-EP-EFF-DTE-N.
 18026     MOVE EW-REIN-CO                    TO EP-REI-CO.
 18027     IF EP-REI-CO NOT = SPACES
 18028         MOVE 'R'                       TO EP-REIN.
 18029     MOVE EW-LF-AH                      TO EP-RCD-TYPE.
 18030     MOVE EW-BEN-TYPE                   TO EP-BEN-CODE.
 18031
 18032     MOVE EW-ISS-CNT                    TO EP-ISS-CNT.
 18033     MOVE EW-ISS-BEN                    TO EP-ISS-BEN.
 18034     MOVE EW-ISS-BEN-GROSS              TO EP-ISS-BEN-GROSS.
 18035
 18036     MOVE EW-CNC-CNT                    TO EP-CNC-CNT.
 18037     MOVE EW-CNC-BEN                    TO EP-CNC-BEN.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 346
* ECS010P.cbl
 18038     MOVE EW-CNC-BEN-GROSS              TO EP-CNC-BEN-GROSS.
 18039
 18040     MOVE EW-ISS-PRM                    TO EP-ISS-PRM.
 18041     MOVE EW-ISS-PRM-GROSS              TO EP-ISS-PRM-GROSS.
 18042     MOVE EW-CNC-PRM                    TO EP-CNC-PRM.
 18043     MOVE EW-CNC-PRM-GROSS              TO EP-CNC-PRM-GROSS.
 18044
 18045     IF DTE-CLIENT NOT = 'NCL'
 18046         GO TO 4512-BUILD-EPEC-CONTINUE.
 18047
 18048     IF W-UNDERWRITTEN-DATA
 18049         GO TO 4512-BUILD-EPEC-CONTINUE.
 18050
 18051     IF AM-EXPIRE-DT NOT GREATER THAN EOM-RUN-DATE
 18052         GO TO 4512-BUILD-EPEC-CONTINUE.
 18053
 18054     IF WS-OB-REIN-CO (SUB2) = EW-REIN-CO  AND
 18055        WS-OB-LF-AH (SUB2) = EW-LF-AH  AND
 18056        WS-OB-BENEFIT-CODE (SUB2) = EW-BEN-TYPE
 18057         NEXT SENTENCE
 18058     ELSE
 18059         GO TO 4512-BUILD-EPEC-CONTINUE.
 18060
 18061     IF OB-DATE-1-USED  OR
 18062        OB-DATE-2-USED  OR
 18063        OB-DATE-3-USED
 18064         NEXT SENTENCE
 18065     ELSE
 18066         GO TO 4512-BUILD-EPEC-CONTINUE.
 18067
 18068     IF OB-DATE-1-USED
 18069         IF WS-EPR-R78 (SUB2 1) NOT EQUAL +0
 18070             COMPUTE EW-EPR-R78 = EW-ISS-PRM - EW-CNC-PRM -
 18071                           EW-EPR-R78-ADJ - WS-EPR-R78 (SUB2 1)
 18072             MOVE EW-EPR-R78    TO EW-EPR-PRO
 18073                                   EW-EPR-ST
 18074             GO TO 4512-BUILD-EPEC-CONTINUE
 18075         ELSE
 18076             GO TO 4512-BUILD-EPEC-CONTINUE.
 18077
 18078     IF OB-DATE-2-USED
 18079         IF WS-EPR-R78 (SUB2 2) NOT EQUAL +0
 18080             COMPUTE EW-EPR-R78 = EW-ISS-PRM - EW-CNC-PRM -
 18081                           EW-EPR-R78-ADJ - WS-EPR-R78 (SUB2 2)
 18082             MOVE EW-EPR-R78    TO EW-EPR-PRO
 18083                                   EW-EPR-ST
 18084             GO TO 4512-BUILD-EPEC-CONTINUE
 18085         ELSE
 18086             GO TO 4512-BUILD-EPEC-CONTINUE.
 18087
 18088     IF OB-DATE-3-USED
 18089         IF WS-EPR-R78 (SUB2 3) NOT EQUAL +0
 18090             COMPUTE EW-EPR-R78 = EW-ISS-PRM - EW-CNC-PRM -
 18091                           EW-EPR-R78-ADJ - WS-EPR-R78 (SUB2 3)
 18092             MOVE EW-EPR-R78    TO EW-EPR-PRO
 18093                                   EW-EPR-ST
 18094             GO TO 4512-BUILD-EPEC-CONTINUE
 18095         ELSE
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 347
* ECS010P.cbl
 18096             GO TO 4512-BUILD-EPEC-CONTINUE.
 18097
 18098 4512-BUILD-EPEC-CONTINUE.
 18099
 18100     MOVE EW-EPR-R78                    TO EP-PRM-78.
 18101     MOVE EW-EPR-PRO                    TO EP-PRM-PR.
 18102     MOVE EW-EPR-ST                     TO EP-PRM-ST.
 18103
 18104     MOVE EW-EPR-R78-ADJ                TO EP-PRM-78-ADJ.
 18105     MOVE EW-EPR-PRO-ADJ                TO EP-PRM-PR-ADJ.
 18106     MOVE EW-EPR-ST-ADJ                 TO EP-PRM-ST-ADJ.
 18107
 18108     MOVE EW-ISS-PRM-TAX                TO EP-PRM-TAX
 18109
 18110     MOVE EW-CLM-AMT                    TO EP-CLM-AMT.
 18111     MOVE EW-CLM-CNT                    TO EP-CLM-CNT.
 18112     MOVE EW-CLM-CRT                    TO EP-CLM-CRT.
 18113
 18114     MOVE EW-CLM-PAYCUR                 TO EP-CLM-DU.
 18115     MOVE ZEROS                         TO EP-CLM-PV.
 18116
 18117     IF EP-RCD-TYPE = 'A' OR 'U'
 18118         IF CARRIER-UEP-PCT (CLAS-INDEXCN) NOT = ZEROS
 18119             PERFORM 4599A-CALC-IBNR THRU 4599A-CALC-EXIT.
 18120
 18121     MOVE EW-CLM-IBNR                   TO EP-CLM-IBNR.
 18122
 18123     MOVE EW-CLM-FUTRSV                 TO EP-LOSS-RESV.
 18124     MOVE ZEROS                         TO EP-CLAIM-ADJ.
 18125
 18126     MOVE EW-INFORCE-CNT                TO EP-INFORCE-CNT.
 18127
 18128     IF EW-ISS-CNT = ZERO
 18129         MOVE ZERO                      TO EP-AVG-ORIG-TERM
 18130                                           EP-AVG-AGE
 18131       ELSE
 18132         COMPUTE EP-AVG-ORIG-TERM ROUNDED =
 18133                                EW-ORIG-TERM / EW-ISS-CNT
 18134         COMPUTE EP-AVG-AGE ROUNDED = EW-AGE / EW-ISS-CNT.
 18135
 18136     IF EW-INFORCE-CNT = ZERO
 18137         MOVE ZERO                      TO EP-AVG-REM-TERM
 18138       ELSE
 18139         COMPUTE EP-AVG-REM-TERM ROUNDED =
 18140                             EW-REM-TERM / EW-INFORCE-CNT.
 18141
 18142     IF EW-ISS-BEN = ZERO
 18143         MOVE ZERO                      TO EP-WEIGHTED-ORIG-TERM
 18144                                           EP-WEIGHTED-AGE
 18145       ELSE
 18146         COMPUTE EP-WEIGHTED-ORIG-TERM ROUNDED =
 18147                                  EW-TERM-BEN / EW-ISS-BEN
 18148         COMPUTE EP-WEIGHTED-AGE ROUNDED =
 18149                                   EW-AGE-BEN / EW-ISS-BEN.
 18150
 18151     MOVE ZEROS                         TO
 18152         EP-RETRO-EXPENSES  EP-RETRO-PAYMENTS  EP-RETRO-OTH-COMM
 18153         EP-MORT-RESV       EP-IN-FORCE        EP-ADJUST.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 348
* ECS010P.cbl
 18154
 18155     MOVE EW-COV-DTE                    TO EP-HI-COV-DT
 18156                                           WS-EP-HI-COV-DT-N.
 18157     MOVE HIGH-CERT                     TO EP-HI-CERT
 18158                                           WS-EP-HI-CERT-N.
 18159     MOVE LOW-CERT                      TO EP-LO-CERT
 18160                                           WS-EP-LO-CERT-N.
 18161     IF DTE-PGM-OPT = '3'
 18162         MOVE 'P'                       TO EP-PURGE.
 18163
 18164     IF  DTE-OPT-RESERVE-METHOD-UNAUTH
 18165         GO TO 4514-CONTINUE.
 18166
 18167     MOVE EPEC-CLM-EXP (SUB2)    TO EP-CLM-EXP.
 18168
 18169     IF  EPEC-LIFE-CTR-NOT-USED (SUB2)
 18170         MOVE +1                 TO EP-LIFE-YEARS
 18171     ELSE
 18172         MOVE ZEROS              TO W-LIFE-YEARS
 18173         PERFORM 4515-DETERMINE-LIFE-YEARS THRU 4515-EXIT
 18174                 VARYING
 18175             SUBM FROM +1 BY +1
 18176                 UNTIL
 18177             SUBM GREATER THAN +13
 18178         COMPUTE W-LIFE-YEARS-INT ROUNDED
 18179             = W-LIFE-YEARS / 12
 18180             - (EPEC-LIFE-CTR (SUB2 1)
 18181             + EPEC-LIFE-CTR (SUB2 13)) / 24
 18182         COMPUTE EP-LIFE-YEARS ROUNDED = W-LIFE-YEARS-INT
 18183         IF  EP-LIFE-YEARS LESS THAN +1
 18184             MOVE +1             TO EP-LIFE-YEARS.
 18185
 18186 4514-CONTINUE.
 18187
 18188     PERFORM 4900-WRITE-SUMMARY-EXTRACTS THRU 4999-WRT-SUMMARY-X.
 18189
 18190     MOVE SPACES                        TO EC-RECORD.
 18191     MOVE '1'                           TO WS-SEQ-NBR.
 18192     MOVE +0                            TO SUB3.
 18193     MOVE +0                            TO SUB4.
 18194     PERFORM 4520-BUILD-EPEC-LOAD-COMM
 18195         THRU 4539-BUILD-EPEC-LOAD-COMM-X
 18196         UNTIL SUB4  GREATER THAN WS-LOOP-MAX.
 18197
 18198     GO TO 4518-BUILD-EPEC-RCD-X.
 18199
 18200 4515-DETERMINE-LIFE-YEARS.
 18201
 18202     ADD EPEC-LIFE-CTR (SUB2 SUBM)      TO W-LIFE-YEARS.
 18203
 18204 4515-EXIT.
 18205     EXIT.
 18206
 18207 4518-BUILD-EPEC-RCD-X.
 18208     EXIT.
 18209
 18210 4519-BUILD-EPEC-EXT-X.
 18211     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 349
* ECS010P.cbl
 18212
 18213 4520-BUILD-EPEC-LOAD-COMM.
 18214
 18215     PERFORM 4545-BUILD-BASE  THRU  4545-BUILD-BASE-X.
 18216
 18217     ADD +1 TO SUB3  SUB4.
 18218     MOVE ZEROS                  TO LEVELS-BUILT.
 18219
 18220 4530-BUILD-EPEC-LOAD-COMM-LOOP.
 18221
 18222     IF SUB4 GREATER THAN WS-LOOP-MAX
 18223         IF AGT-SW = 'X'
 18224             PERFORM 4900-WRITE-SUMMARY-EXTRACTS
 18225                 THRU 4999-WRT-SUMMARY-X
 18226             MOVE ' '            TO AGT-SW
 18227             MOVE WS-LOOP-MAX    TO  SUB4
 18228             GO TO 4539-BUILD-EPEC-LOAD-COMM-X
 18229         ELSE
 18230             GO TO 4539-BUILD-EPEC-LOAD-COMM-X.
 18231
 18232     IF LEVELS-BUILT EQUAL +5
 18233         IF AGT-SW = 'X'
 18234             PERFORM 4900-WRITE-SUMMARY-EXTRACTS
 18235                 THRU 4999-WRT-SUMMARY-X
 18236             MOVE ' '            TO AGT-SW
 18237             MOVE ZEROS          TO LEVELS-BUILT
 18238             ADD 1 TO WS-SEQ-NBR
 18239             PERFORM 4545-BUILD-BASE  THRU  4545-BUILD-BASE-X
 18240             PERFORM 4540-BUILD-EPEC-CLEAR  THRU
 18241                     4540-BUILD-CLEAR-X
 18242                 VARYING SUB3 FROM +1 BY +1
 18243                 UNTIL SUB3 GREATER THAN +5
 18244             MOVE +1             TO SUB3
 18245             GO TO 4531-BUILD-EPEC-LOAD-COMM
 18246         ELSE
 18247             MOVE +1             TO SUB3
 18248             MOVE ZEROS          TO LEVELS-BUILT
 18249             GO TO 4531-BUILD-EPEC-LOAD-COMM.
 18250
 18251     IF SUB4 GREATER THAN WS-LOOP-MAX
 18252         IF AGT-SW = 'X'
 18253             PERFORM 4900-WRITE-SUMMARY-EXTRACTS
 18254                 THRU 4999-WRT-SUMMARY-X
 18255             MOVE ' '                   TO AGT-SW
 18256             GO TO 4539-BUILD-EPEC-LOAD-COMM-X
 18257         ELSE
 18258             GO TO 4539-BUILD-EPEC-LOAD-COMM-X.
 18259
 18260 4531-BUILD-EPEC-LOAD-COMM.
 18261
 18262     IF (EW-AGT-NO (SUB4) = SPACES)
 18263                  OR
 18264        ((EW-ISS-COM (SUB4) = ZEROS) AND
 18265         (EW-CNC-COM (SUB4) = ZEROS) AND
 18266         (EW-ECR-R78 (SUB4) = ZEROS) AND
 18267         (EW-ECR-R78-ADJ (SUB4) = ZEROS) AND
 18268         (EW-ECR-PRO (SUB4) = ZEROS) AND
 18269         (EW-ECR-PRO-ADJ (SUB4) = ZEROS) AND
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 350
* ECS010P.cbl
 18270         (EW-ECR-ST (SUB4) = ZEROS))
 18271         PERFORM 4540-BUILD-EPEC-CLEAR
 18272             THRU 4540-BUILD-CLEAR-X
 18273         ADD +1 TO SUB4
 18274         GO TO 4530-BUILD-EPEC-LOAD-COMM-LOOP.
 18275
 18276     MOVE 'X'                           TO AGT-SW.
 18277     MOVE EW-AGT-NO (SUB4)              TO EC-AGT-NO (SUB3).
 18278     MOVE EW-AGT-TYPE (SUB4)            TO EC-AGT-TYPE (SUB3).
 18279     MOVE EW-ISS-COM (SUB4)             TO EC-ISS-COMM (SUB3).
 18280     MOVE EW-CNC-COM (SUB4)             TO EC-CNC-COMM (SUB3).
 18281     MOVE EW-ECR-R78 (SUB4)             TO EC-COMM-78 (SUB3).
 18282     MOVE EW-ECR-PRO (SUB4)             TO EC-COMM-PR (SUB3).
 18283     MOVE EW-ECR-ST (SUB4)              TO EC-COMM-ST (SUB3).
 18284     MOVE EW-ECR-R78-ADJ (SUB4)         TO EC-COMM-78-ADJ (SUB3).
 18285     MOVE EW-ECR-PRO-ADJ (SUB4)         TO EC-COMM-PR-ADJ (SUB3).
 18286
 18287     ADD +1 TO SUB3 SUB4 LEVELS-BUILT.
 18288
 18289     GO TO 4530-BUILD-EPEC-LOAD-COMM-LOOP.
 18290
 18291 4539-BUILD-EPEC-LOAD-COMM-X.
 18292     EXIT.
 18293
 18294 4540-BUILD-EPEC-CLEAR.
 18295
 18296     MOVE ZEROS                         TO EC-AGT-NO (SUB3).
 18297     MOVE SPACE                         TO EC-AGT-TYPE (SUB3).
 18298     MOVE ZEROS                         TO EC-ISS-COMM (SUB3)
 18299                                           EC-CNC-COMM (SUB3)
 18300                                           EC-COMM-78 (SUB3)
 18301                                           EC-COMM-PR (SUB3)
 18302                                           EC-COMM-ST (SUB3)
 18303                                           EC-COMM-78-ADJ (SUB3)
 18304                                           EC-COMM-PR-ADJ (SUB3).
 18305
 18306 4540-BUILD-CLEAR-X.
 18307     EXIT.
 18308
 18309 4541-CALC-IBNR.
 18310
 18311     MOVE +0                    TO TOT-AH-IBNR
 18312                                   TOT-AH-PRM
 18313                                   TOT-AH-PD-CLMS
 18314                                   TOT-AH-CLMRSV
 18315                                   TOT-LF-IBNR
 18316                                   TOT-LF-PRM
 18317                                   TOT-LF-PD-CLMS
 18318                                   TOT-LF-CLMRSV
 18319
 18320     MOVE +0                    TO RTOT-AH-IBNR
 18321                                   RTOT-AH-PRM
 18322                                   RTOT-AH-PD-CLMS
 18323                                   RTOT-AH-CLMRSV
 18324                                   RTOT-LF-IBNR
 18325                                   RTOT-LF-PRM
 18326                                   RTOT-LF-PD-CLMS
 18327                                   RTOT-LF-CLMRSV
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 351
* ECS010P.cbl
 18328
 18329     PERFORM VARYING SUB2 FROM +1 BY +1 UNTIL
 18330        (SUB2 > +900)
 18331        OR (EPEC-REIN-CO (SUB2) = ZEROS)
 18332*       IF W-UNDERWRITTEN-DATA
 18333*          MOVE EPEC-LEVELS-II (SUB2)
 18334*                                TO EPEC-WORK
 18335*       ELSE
 18336           MOVE EPEC-LEVELS (SUB2)
 18337                                 TO EPEC-WORK
 18338*       END-IF
 18339        IF EW-REIN-CO = SPACES
 18340           IF EW-LF-AH = 'L'
 18341              COMPUTE TOT-LF-PRM = TOT-LF-PRM
 18342                 + EW-EPR-ST
 18343              COMPUTE TOT-LF-PD-CLMS = TOT-LF-PD-CLMS
 18344                 + EW-CLM-AMT
 18345              COMPUTE TOT-LF-CLMRSV = TOT-LF-CLMRSV
 18346                 + EW-CLM-PAYCUR + EW-CLM-FUTRSV
 18347           ELSE
 18348              COMPUTE TOT-AH-PRM = TOT-AH-PRM
 18349                 + EW-EPR-ST
 18350              COMPUTE TOT-AH-PD-CLMS = TOT-AH-PD-CLMS
 18351                 + EW-CLM-AMT
 18352              COMPUTE TOT-AH-CLMRSV = TOT-AH-CLMRSV
 18353                 + EW-CLM-PAYCUR + EW-CLM-FUTRSV
 18354        ELSE
 18355           IF EW-LF-AH = 'L'
 18356              COMPUTE RTOT-LF-PRM = RTOT-LF-PRM
 18357                 + EW-EPR-ST
 18358              COMPUTE RTOT-LF-PD-CLMS = RTOT-LF-PD-CLMS
 18359                 + EW-CLM-AMT
 18360              COMPUTE RTOT-LF-CLMRSV = RTOT-LF-CLMRSV
 18361                 + EW-CLM-PAYCUR + EW-CLM-FUTRSV
 18362           ELSE
 18363              COMPUTE RTOT-AH-PRM = RTOT-AH-PRM
 18364                 + EW-EPR-ST
 18365              COMPUTE RTOT-AH-PD-CLMS = RTOT-AH-PD-CLMS
 18366                 + EW-CLM-AMT
 18367              COMPUTE RTOT-AH-CLMRSV = RTOT-AH-CLMRSV
 18368                 + EW-CLM-PAYCUR + EW-CLM-FUTRSV
 18369           END-IF
 18370        END-IF
 18371     END-PERFORM
 18372
 18373     COMPUTE TOT-AH-IBNR = (TOT-AH-PRM * .6)
 18374        - TOT-AH-PD-CLMS - TOT-AH-CLMRSV
 18375     IF TOT-AH-IBNR < ZEROS
 18376        COMPUTE TOT-AH-IBNR = TOT-AH-PRM * .15
 18377     END-IF
 18378     COMPUTE TOT-LF-IBNR = (TOT-LF-PRM * .6)
 18379        - TOT-LF-PD-CLMS - TOT-LF-CLMRSV
 18380     IF TOT-LF-IBNR < ZEROS
 18381        COMPUTE TOT-LF-IBNR = TOT-LF-PRM * .15
 18382     END-IF
 18383
 18384     COMPUTE RTOT-AH-IBNR = (RTOT-AH-PRM * .6)
 18385        - RTOT-AH-PD-CLMS - RTOT-AH-CLMRSV
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 352
* ECS010P.cbl
 18386     IF RTOT-AH-IBNR < ZEROS
 18387        COMPUTE RTOT-AH-IBNR = RTOT-AH-PRM * .15
 18388     END-IF
 18389     COMPUTE RTOT-LF-IBNR = (RTOT-LF-PRM * .6)
 18390        - RTOT-LF-PD-CLMS - RTOT-LF-CLMRSV
 18391     IF RTOT-LF-IBNR < ZEROS
 18392        COMPUTE RTOT-LF-IBNR = RTOT-LF-PRM * .15
 18393     END-IF
 18394
 18395     PERFORM VARYING SUB2 FROM +1 BY +1 UNTIL
 18396        (SUB2 > +900)
 18397        OR (EPEC-REIN-CO (SUB2) = ZEROS)
 18398*       IF W-UNDERWRITTEN-DATA
 18399*          MOVE EPEC-LEVELS-II (SUB2)
 18400*                                TO EPEC-WORK
 18401*       ELSE
 18402           MOVE EPEC-LEVELS (SUB2)
 18403                                 TO EPEC-WORK
 18404*       END-IF
 18405        IF EW-REIN-CO = SPACES
 18406           IF EW-LF-AH = 'L'
 18407              COMPUTE IBNR-FACT ROUNDED = EW-EPR-ST
 18408                 / TOT-LF-PRM
 18409              COMPUTE EW-CLM-IBNR ROUNDED = IBNR-FACT
 18410                 * RTOT-LF-IBNR
 18411*                * TOT-LF-IBNR
 18412           ELSE
 18413              COMPUTE IBNR-FACT ROUNDED = EW-EPR-ST
 18414                 / TOT-AH-PRM
 18415              COMPUTE EW-CLM-IBNR ROUNDED = IBNR-FACT
 18416                 * RTOT-AH-IBNR
 18417*                * TOT-AH-IBNR
 18418           END-IF
 18419        ELSE
 18420           IF EW-LF-AH = 'L'
 18421              COMPUTE IBNR-FACT ROUNDED = EW-EPR-ST
 18422                 / RTOT-LF-PRM
 18423              COMPUTE EW-CLM-IBNR ROUNDED = IBNR-FACT
 18424                 * RTOT-LF-IBNR
 18425           ELSE
 18426              COMPUTE IBNR-FACT ROUNDED = EW-EPR-ST
 18427                 / RTOT-AH-PRM
 18428              COMPUTE EW-CLM-IBNR ROUNDED = IBNR-FACT
 18429                 * RTOT-AH-IBNR
 18430           END-IF
 18431        END-IF
 18432*       IF W-UNDERWRITTEN-DATA
 18433*          MOVE EPEC-WORK        TO EPEC-LEVELS-II (SUB2)
 18434*       ELSE
 18435           MOVE EPEC-WORK        TO EPEC-LEVELS (SUB2)
 18436*       END-IF
 18437     END-PERFORM
 18438
 18439     .
 18440 4541-EXIT.
 18441     EXIT.
 18442
 18443 4545-BUILD-BASE.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 353
* ECS010P.cbl
 18444
 18445     MOVE 'EC'                   TO EC-RECORD-ID.
 18446     MOVE DTE-CLASIC-COMPANY-CD  TO EP-COMPANY-CD.
 18447     MOVE AM-MSTR-CNTRL          TO EC-CONTROL.
 18448     MOVE AM-EXPIRE-DT           TO WS-EC-EXP-DTE-N.
 18449     MOVE AM-EFFECT-DT           TO EC-EFF-DTE
 18450                                    WS-EC-EFF-DTE.
 18451     MOVE EW-REIN-CO             TO EC-REI-CO.
 18452     IF EC-REI-CO NOT = SPACES
 18453         MOVE 'R'                TO EC-REIN.
 18454     MOVE EW-LF-AH               TO EC-RCD-TYPE.
 18455     MOVE EW-BEN-TYPE            TO EC-BEN-CODE.
 18456     IF DTE-PGM-OPT = '3'
 18457         MOVE 'P'                TO EC-PURGE.
 18458     MOVE WS-SEQ-NBR             TO EC-SEQ-NBR.
 18459
 18460 4545-BUILD-BASE-X.
 18461     EXIT.
 18462
 18463******************************************************************
 18464***        CLEAR EARNED PREMIUM  AND  REINSURANCE TOTALS       ***
 18465******************************************************************
 18466
 18467 4550-CLEAR-EPEC-TOTALS.
 18468
 18469     MOVE LOW-CERT             TO SV-LO-CERT.
 18470     MOVE HIGH-CERT            TO SV-HI-CERT.
 18471     MOVE SPACES               TO LOW-CTL.
 18472     MOVE ZEROS                TO LOW-CERT  HIGH-CERT.
 18473
 18474     MOVE +1                   TO SUB9.
 18475     MOVE +0                   TO SUB10.
 18476     MOVE ZERO                 TO EW-REIN-CO
 18477                                  EW-BEN-TYPE.
 18478     MOVE SPACE                TO EP-FLG
 18479                                  EW-LF-AH
 18480                                  EW-LEVEL-USED
 18481                                  W-TABLE-USED-SW.
 18482
 18483     MOVE +0                   TO EW-ISS-BEN     EW-ISS-BEN-GROSS
 18484                                  EW-CNC-BEN     EW-CNC-BEN-GROSS
 18485                                  EW-ISS-PRM     EW-ISS-PRM-GROSS
 18486                                  EW-CNC-PRM     EW-CNC-PRM-GROSS
 18487                                  EW-EPR-R78     EW-EPR-R78-ADJ
 18488                                  EW-EPR-PRO     EW-EPR-PRO-ADJ
 18489                                  EW-EPR-ST      EW-EPR-ST-ADJ
 18490                                  EW-CLM-AMT     EW-COV-DTE
 18491                                  EW-CLM-IBNR    EW-CLM-PAYCUR
 18492                                  EW-CLM-FUTRSV  EW-CLM-CNT
 18493                                  EW-CLM-CRT     EW-ISS-CNT
 18494                                  EW-CNC-CNT     EW-AGE
 18495                                  EW-ORIG-TERM   EW-INFORCE-CNT
 18496                                  EW-AGE-BEN     EW-TERM-BEN
 18497                                  EW-ISS-PRM-TAX
 18498                                  EW-REM-TERM.
 18499
 18500     MOVE +1 TO SUB1.
 18501     PERFORM 4555-CLEAR-EPEC-COMM WS-LOOP-MAX TIMES.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 354
* ECS010P.cbl
 18502     PERFORM 4560-CLEAR-EPEC-ALL VARYING SUB1 FROM +1 BY +1
 18503         UNTIL EPEC-REIN-CO (SUB1) = ZEROS.
 18504     MOVE EPEC-OPT-WORK-TABLE    TO EPEC-OPT-DATA-TABLE
 18505                                    EPEC-UNDW-OPT-DATA-TABLE.
 18506     PERFORM 4570-CLEAR-EPEC-SUB-A VARYING SUB1 FROM +1 BY +1
 18507         UNTIL EPEC-SUB-REIN (SUB1) = ZEROS.
 18508
 18509     PERFORM 4590-INIT-OB THRU 4590-EXIT
 18510         VARYING SUB3 FROM +1 BY +1
 18511*        UNTIL SUB3 GREATER THAN +300.
 18512*        UNTIL SUB3 GREATER THAN +220.
 18513         UNTIL SUB3 GREATER THAN +900.
 18514
 18515     GO TO 4589-CLEAR-EPEC-TOTALS-X.
 18516
 18517 4555-CLEAR-EPEC-COMM.
 18518
 18519     MOVE +0 TO EW-ISS-COM (SUB1)  EW-CNC-COM (SUB1)
 18520                EW-ECR-R78 (SUB1)  EW-ECR-R78-ADJ (SUB1)
 18521                EW-ECR-PRO (SUB1)  EW-ECR-PRO-ADJ (SUB1)
 18522                EW-ECR-ST  (SUB1).
 18523     MOVE SPACES                 TO EW-AGT-NO (SUB1)
 18524                                    EW-AGT-TYPE (SUB1).
 18525
 18526     ADD +1 TO SUB1.
 18527
 18528 4560-CLEAR-EPEC-ALL.
 18529
 18530     MOVE EPEC-WORK              TO EPEC-LEVELS (SUB1)
 18531                                    EPEC-LEVELS-II (SUB1).
 18532     MOVE W-LIFE-YEARS-ZERO      TO EPEC-OPT-GRP (SUB1).
 18533
 18534 4570-CLEAR-EPEC-SUB-A.
 18535
 18536     MOVE ZEROS TO EPEC-SUB-REIN (SUB1).
 18537     PERFORM 4580-CLEAR-EPEC-SUB-B VARYING SUB2 FROM +1 BY +1
 18538*        UNTIL SUB2 GREATER +300.
 18539         UNTIL SUB2 GREATER +900.
 18540
 18541 4580-CLEAR-EPEC-SUB-B.
 18542
 18543     MOVE ZEROS TO EPEC-SUB-LF (SUB1 SUB2).
 18544     MOVE ZEROS TO EPEC-SUB-AH (SUB1 SUB2).
 18545
 18546 4589-CLEAR-EPEC-TOTALS-X.
 18547     EXIT.
 18548
 18549 4590-INIT-OB.
 18550
 18551     MOVE +0 TO WS-EPR-R78 (SUB3 1).
 18552     MOVE +0 TO WS-EPR-R78 (SUB3 2).
 18553     MOVE +0 TO WS-EPR-R78 (SUB3 3).
 18554
 18555 4590-EXIT.
 18556     EXIT.
 18557
 18558 4599-BUILD-EPEC-EXTRACT-X.
 18559     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 355
* ECS010P.cbl
 18560
 18561*********************************************************
 18562*  THIS ROUTINE IS USED TO CALCULATE THE A&H IBNR       *
 18563*  RESERVES USING A PERCENTAGE OF THE UNEARNED PREMIUM. *
 18564*  THESE PERCENTAGES ARE ENTERED THROUGH SCREEN EL105A  *
 18565*  (CARRIER CONTROLS) AND PASSED THROUGHOUT THE SYSTEM  *
 18566*  IN THE DATE CARD.                                    *
 18567*  'CARRIER-UEP-PCT' IS THE ACTUAL PERCENT PER CARRIER. *
 18568*********************************************************
 18569
 18570 4599A-CALC-IBNR.
 18571
 18572     COMPUTE EW-CLM-IBNR =  ((EP-ISS-PRM - EP-CNC-PRM) -
 18573        (((EP-PRM-78 + EP-PRM-78-ADJ)
 18574                              * CARRIER-R78-PCT (CLAS-INDEXCN)) +
 18575         ((EP-PRM-PR + EP-PRM-PR-ADJ)
 18576                              * CARRIER-PRO-PCT (CLAS-INDEXCN))))
 18577                         * CARRIER-UEP-PCT (CLAS-INDEXCN).
 18578
 18579     IF EW-CLM-IBNR NOT GREATER THAN ZEROS
 18580         MOVE ZEROS                 TO EW-CLM-IBNR
 18581         GO TO 4599A-CALC-EXIT.
 18582
 18583     IF EP-REIN = 'R'
 18584         MOVE 'Y'                   TO W-REIN-PROCESS-IND.
 18585
 18586     PERFORM 4740-CREATE-DETAIL-EXTR THRU 4740-EXIT.
 18587
 18588 4599A-CALC-EXIT.
 18589      EXIT.
 18590 4599B-SEARCH.
 18591      EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 356
* ECS010P.cbl
 18593******************************************************************
 18594***         CALCULATE OPTIONAL METHOD I B N R                  ***
 18595******************************************************************
 18596
 18597 4600-GET-OPT-IBNR.
 18598
 18599     IF  CR-POLICY-IS-ACTIVE
 18600         IF  CR-POLICY-IS-REISSUE
 18601             OR CR-POLICY-IS-MONTHLY
 18602             IF  W-LIFE
 18603                 GO TO 4600-EXIT
 18604             ELSE
 18605                 NEXT SENTENCE
 18606         ELSE
 18607             NEXT SENTENCE
 18608     ELSE
 18609         IF  W-LIFE
 18610             GO TO 4600-EXIT.
 18611
 18612     IF  W-LIFE
 18613         PERFORM 4620-DETERMINE-LIFE-IBNR THRU 4620-EXIT
 18614     ELSE
 18615         PERFORM 4640-GET-A-H-EARNED-PREMIUM THRU 4640-EXIT.
 18616
 18617 4600-EXIT.
 18618     EXIT.
 18619
 18620 4620-DETERMINE-LIFE-IBNR.
 18621
 18622     IF  CR-LF-POLICY-IS-ACTIVE
 18623         ADD +1                  TO W-LF-ACTIVE
 18624         IF  CR-LF-POLICY-IS-REISSUE
 18625             OR CR-LF-POLICY-IS-MONTHLY
 18626             MOVE ZEROS          TO W-WK-IBNR
 18627             ADD +1              TO W-LF-REISSUE
 18628             GO TO 4620-EXIT
 18629         ELSE
 18630             NEXT SENTENCE
 18631     ELSE
 18632         ADD +1                  TO W-LF-INACTIVE
 18633         MOVE ZEROS              TO W-WK-IBNR
 18634         GO TO 4620-EXIT.
 18635
 18636     IF  CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'B'
 18637         MOVE ZEROS              TO W-WK-IBNR
 18638         ADD +1                  TO W-LF-CALC-B
 18639         GO TO 4620-EXIT.
 18640
 18641     IF  (CLAS-I-EP (CLAS-INDEXL) = 'B'
 18642                 AND
 18643             CLAS-I-CALC-TYPE (CLAS-INDEXL) NOT = 'L'
 18644                 AND
 18645             W-BAL-REMTRM NOT GREATER THAN ZERO)
 18646             OR
 18647         (CLAS-I-EP (CLAS-INDEXL) = 'B'
 18648                 AND
 18649             CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'L'
 18650                 AND
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 357
* ECS010P.cbl
 18651             REM-TRM2 NOT GREATER THAN ZERO)
 18652         MOVE ZEROS              TO W-WK-IBNR
 18653         ADD +1                  TO W-LF-BALLOON
 18654         GO TO 4620-EXIT
 18655     ELSE
 18656         IF  (CLAS-I-EP (CLAS-INDEXL) NOT = 'B'
 18657                 AND
 18658             REM-TRM2 NOT GREATER THAN ZERO)
 18659             ADD +1              TO W-LF-REMTERM-0
 18660             MOVE ZEROS          TO W-WK-IBNR
 18661             GO TO 4620-EXIT.
 18662
 18663     PERFORM 4680-CALC-REMAINING-AMT-LF THRU 4680-EXIT.
 18664
 18665     IF  CP-REMAINING-AMT NOT GREATER THAN ZEROS
 18666         ADD +1                  TO W-LF-REMAMT-0
 18667         MOVE ZEROS              TO W-WK-IBNR
 18668         GO TO 4620-EXIT.
 18669
 18670     IF  AM-LIFE-IBNR-PCT NUMERIC
 18671             AND
 18672         AM-LIFE-IBNR-PCT GREATER THAN ZEROS
 18673         COMPUTE W-WK-IBNR ROUNDED
 18674             = CP-REMAINING-AMT
 18675             / 1000
 18676             * AM-LIFE-IBNR-PCT
 18677     ELSE
 18678         COMPUTE W-WK-IBNR ROUNDED
 18679             = CP-REMAINING-AMT
 18680             / 1000
 18681             * COMPANY-IBNR-LIFE-FACTOR.
 18682
 18683     IF  CR-LF-IS-REIN-ONLY
 18684         ADD +1                  TO W-LF-REIN
 18685     ELSE
 18686         ADD +1                  TO W-LF-DATA-USED
 18687         ADD W-WK-IBNR           TO W-LIFE-IBNR-IN
 18688         ADD CP-REMAINING-AMT    TO W-LIFE-REMAINING-AMT
 18689         IF  CR-LFTYP = '01'
 18690             ADD CP-REMAINING-AMT
 18691                                 TO W-01-REMAMT
 18692             ADD +1              TO W-01-DATA-USED
 18693         ELSE
 18694         IF  CR-LFTYP = '02'
 18695             ADD CP-REMAINING-AMT
 18696                                 TO W-02-REMAMT
 18697             ADD +1              TO W-02-DATA-USED
 18698         ELSE
 18699         IF  CR-LFTYP = '03'
 18700             ADD CP-REMAINING-AMT
 18701                                 TO W-03-REMAMT
 18702             ADD +1              TO W-03-DATA-USED
 18703         ELSE
 18704         IF  CR-LFTYP = '04'
 18705             ADD CP-REMAINING-AMT
 18706                                 TO W-04-REMAMT
 18707             ADD +1              TO W-04-DATA-USED
 18708         ELSE
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 358
* ECS010P.cbl
 18709         IF  CR-LFTYP = '05'
 18710             ADD CP-REMAINING-AMT
 18711                                 TO W-05-REMAMT
 18712             ADD +1              TO W-05-DATA-USED
 18713         ELSE
 18714         IF  CR-LFTYP = '06'
 18715             ADD CP-REMAINING-AMT
 18716                                 TO W-06-REMAMT
 18717             ADD +1              TO W-06-DATA-USED
 18718         ELSE
 18719         IF  CR-LFTYP = '30'
 18720             ADD CP-REMAINING-AMT
 18721                                 TO W-30-REMAMT
 18722             ADD +1              TO W-30-DATA-USED
 18723         ELSE
 18724         IF  CR-LFTYP = '31'
 18725             ADD CP-REMAINING-AMT
 18726                                 TO W-31-REMAMT
 18727             ADD +1              TO W-31-DATA-USED
 18728         ELSE
 18729             ADD CP-REMAINING-AMT
 18730                                 TO W-XX-REMAMT
 18731             ADD +1              TO W-XX-DATA-USED.
 18732
 18733     IF  CR-POLICY-IS-REIN-ONLY
 18734             OR
 18735         CR-LF-IS-REIN-ONLY
 18736         ADD ISS-BEN             TO EPEC-REIN-ISS-BEN (SUB3)
 18737         MOVE 'R'                TO EPEC-REIN-ONLY-IND (SUB3)
 18738         ADD W-WK-IBNR           TO EPEC-LIFE-IBNR (SUB3)
 18739     ELSE
 18740         ADD W-WK-IBNR           TO EPEC-LIFE-IBNR (SUB3).
 18741
 18742 4620-EXIT.
 18743     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 359
* ECS010P.cbl
 18745 4640-GET-A-H-EARNED-PREMIUM.
 18746
 18747     IF  CR-AH-POLICY-IS-ACTIVE
 18748         ADD +1                  TO W-AH-ACTIVE
 18749         IF  CR-AH-POLICY-IS-REISSUE
 18750             OR CR-AH-POLICY-IS-MONTHLY
 18751             ADD +1              TO W-AH-REISSUE
 18752         ELSE
 18753             NEXT SENTENCE
 18754     ELSE
 18755         ADD +1                  TO W-AH-INACTIVE.
 18756
 18757     IF  CLAS-I-CALC-TYPE (CLAS-INDEXA) = 'B'
 18758         ADD +1                  TO W-AH-CALC-B
 18759         GO TO 4640-EXIT.
 18760
 18761     IF  REM-TRM2 NOT GREATER THAN ZEROS
 18762         MOVE 'Y'                TO W-RTRM-0-SW
 18763     ELSE
 18764         MOVE SPACES             TO W-RTRM-0-SW.
 18765
 18766     PERFORM 4660-DETERMINE-EARNED-PREMIUM THRU 4660-EXIT.
 18767
 18768****** NOTE:  THERE IS AN ASSUMPTION THAT STATISTICALLY ONLY ONE
 18769******        ACTUALLY CLAIM PER 90 DAY PERIOD AND THAT THE CLAIM
 18770******        ITD FIELD (CR-DISAMT) CONTAINS ONLY THE AMOUNT OF
 18771******        THAT CLAIM.
 18772
 18773     PERFORM 4650-DETERMINE-CLM-AMT-AH THRU 4650-EXIT.
 18774
 18775     IF  CR-POLICY-IS-REIN-ONLY
 18776              OR
 18777         CR-AH-IS-REIN-ONLY
 18778         ADD +1                  TO W-AH-REIN
 18779         ADD ISS-BEN             TO EPEC-REIN-ISS-BEN (SUB3)
 18780         MOVE 'R'                TO EPEC-REIN-ONLY-IND (SUB3)
 18781         ADD W-CLMAMT            TO EPEC-CLAIMS-MADE-PAID (SUB3)
 18782         ADD W-EARNED-PREMIUM    TO EPEC-EARNED-PREMIUM-AH (SUB3)
 18783         GO TO 4640-EXIT.
 18784
 18785     ADD W-EARNED-PREMIUM        TO EPEC-EARNED-PREMIUM-AH (SUB3)
 18786                                    W-EPEC-EP-IN.
 18787     ADD W-CLMAMT                TO EPEC-CLAIMS-MADE-PAID (SUB3)
 18788                                    W-CLAIMS-MADE-PAID-IN.
 18789     ADD +1                      TO W-AH-DATA-USED.
 18790     ADD W-EARNED-PREMIUM-1      TO W-EPEC-EP-1.
 18791     ADD W-EARNED-PREMIUM-2      TO W-EPEC-EP-2.
 18792
 18793     IF  W-CLMAMT GREATER THAN ZEROS
 18794         ADD +1                  TO W-AH-CLAIM-CTR
 18795         ADD W-EARNED-PREMIUM    TO W-AH-CLAIM-EP.
 18796
 18797     IF  W-RTRM-0
 18798             AND
 18799         NOT CR-POLICY-IS-REIN-ONLY
 18800             AND
 18801         NOT CR-AH-IS-REIN-ONLY
 18802         ADD W-CLMAMT            TO W-RTRM-0-CLMAMT
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 360
* ECS010P.cbl
 18803         ADD W-EARNED-PREMIUM-1  TO W-RTRM-EP-1
 18804         ADD W-EARNED-PREMIUM-2  TO W-RTRM-EP-2
 18805         ADD W-EARNED-PREMIUM    TO W-RTRM-EP
 18806         ADD +1                  TO W-AH-REMTERM-0.
 18807
 18808 4640-EXIT.
 18809     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 361
* ECS010P.cbl
 18811 4650-DETERMINE-CLM-AMT-AH.
 18812
 18813     MOVE ZEROS                  TO W-CLMAMT.
 18814
 18815     IF  CR-DIS-DT NOT GREATER THAN ZEROS
 18816             OR
 18817         CR-DIS-DT NOT GREATER THAN W-CUTOFF-DATE
 18818         GO TO 4650-EXIT.
 18819
 18820     IF  CR-DIS-PTO-DT GREATER THAN ZEROS
 18821             AND
 18822         CR-DIS-PTO-DT GREATER THAN CR-DIS-DT
 18823         MOVE CR-DIS-DT              TO DC-GREG-DATE-CYMD
 18824         MOVE 'L'                    TO DC-OPTION-CODE
 18825         PERFORM 8000-DATE-CONVERT-ROUTINE
 18826             THRU 8099-DATE-CONVERT-X
 18827         MOVE DC-BIN-DATE-1          TO W-DIS-DT
 18828         MOVE CR-DIS-PTO-DT          TO DC-GREG-DATE-CYMD
 18829         MOVE 'L'                    TO DC-OPTION-CODE
 18830         PERFORM 8000-DATE-CONVERT-ROUTINE
 18831             THRU 8099-DATE-CONVERT-X
 18832         MOVE DC-BIN-DATE-1          TO W-DIS-PTO-DT
 18833         IF  DATE-CONVERSION-ERROR
 18834             DISPLAY 'CERT DATES ERROR' CR-FULL-CONTROL
 18835             MOVE 'CERT DATES ERROR' TO WS-ABEND-MESSAGE
 18836             MOVE DC-ERROR-CODE      TO WS-ABEND-FILE-STATUS
 18837             MOVE 0303               TO WS-ABEND-CODE
 18838             MOVE WS-ABEND-CODE      TO WS-RETURN-CODE
 18839             GO TO ABEND-PGM
 18840         ELSE
 18841             MOVE W-DIS-DT           TO DC-BIN-DATE-1
 18842             MOVE W-DIS-PTO-DT       TO DC-BIN-DATE-2
 18843             MOVE '1'                TO DC-OPTION-CODE
 18844             MOVE ZEROS              TO DC-ELAPSED-MONTHS
 18845                                        DC-ELAPSED-DAYS
 18846             PERFORM 8000-DATE-CONVERT-ROUTINE
 18847                 THRU 8099-DATE-CONVERT-X
 18848             IF  DATE-CONVERSION-ERROR
 18849                 DISPLAY 'DIS TO PTO DATE ERROR '
 18850                     CR-FULL-CONTROL
 18851                 MOVE 'DIS TO PTO DATE ERROR '
 18852                                     TO WS-ABEND-MESSAGE
 18853                 MOVE DC-ERROR-CODE  TO WS-ABEND-FILE-STATUS
 18854                 MOVE 0303           TO WS-ABEND-CODE
 18855                 MOVE WS-ABEND-CODE  TO WS-RETURN-CODE
 18856                 GO TO ABEND-PGM
 18857             ELSE
 18858                 COMPUTE W-CLMAMT ROUNDED
 18859                     = CR-AHAMT
 18860                     * (DC-ELAPSED-DAYS / 30)
 18861                 GO TO 4650-EXIT.
 18862
 18863     IF  CR-DIS-PAY-DT NOT GREATER THAN ZEROS
 18864             OR
 18865         CR-DIS-PAY-DT LESS THAN CR-DIS-DT
 18866         GO TO 4650-EXIT.
 18867
 18868     COMPUTE W-90-DAY-MAX ROUNDED
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 362
* ECS010P.cbl
 18869         = CR-AHAMT * 3.
 18870
 18871     IF  CR-DISAMT NOT GREATER THAN W-90-DAY-MAX
 18872         MOVE CR-DISAMT          TO W-CLMAMT
 18873     ELSE
 18874         MOVE W-90-DAY-MAX       TO W-CLMAMT.
 18875
 18876     IF  NOT CR-POLICY-IS-REIN-ONLY
 18877              AND
 18878         NOT CR-AH-IS-REIN-ONLY
 18879         ADD +1          TO W-CLM-EXCEPT-CNT
 18880         ADD W-CLMAMT    TO W-CLM-EXCEPT-AMT.
 18881
 18882 4650-EXIT.
 18883     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 363
* ECS010P.cbl
 18885 4660-DETERMINE-EARNED-PREMIUM.
 18886
 18887     MOVE ZEROS                  TO W-EARNED-PREMIUM.
 18888
 18889     PERFORM 4670-CALC-EP THRU 4670-EXIT.
 18890
 18891     MOVE W-EARNED-PREMIUM       TO W-EARNED-PREMIUM-1.
 18892
 18893     IF  CR-ENTRY-DATE NOT GREATER THAN W-CUTOFF-DATE
 18894         MOVE ZEROS              TO W-EARNED-PREMIUM
 18895         MOVE W-CUTOFF-DATE      TO VALUATION-DT
 18896         MOVE '7'                TO W-VAL-SOURCE
 18897         PERFORM 8500-REMAINING-TERM-ROUTINE
 18898             THRU 8599-REM-TERM-X
 18899         PERFORM 4666-SAVE-AHCR-DATA THRU 4666-EXIT
 18900         PERFORM 4800-CALC-EARNED-PREMIUM-AH THRU 4899-EXIT
 18901         PERFORM 4668-RESTORE-AHCR-DATA THRU 4668-EXIT
 18902         MOVE EPR-R78            TO W-OPT-R78
 18903         MOVE EPR-PRO            TO W-OPT-PRO
 18904         MOVE EPR-ST             TO W-OPT-ST
 18905         PERFORM 4670-CALC-EP THRU 4670-EXIT
 18906         MOVE W-EARNED-PREMIUM   TO W-EARNED-PREMIUM-2
 18907     ELSE
 18908         MOVE ZEROS              TO W-EARNED-PREMIUM-2.
 18909
 18910     COMPUTE W-EARNED-PREMIUM ROUNDED
 18911         = W-EARNED-PREMIUM-1 - W-EARNED-PREMIUM-2.
 18912
 18913     IF  W-EARNED-PREMIUM LESS THAN ZERO
 18914         ADD +1                  TO W-EP-LESS-THAN-0
 18915         MOVE ZERO               TO W-EARNED-PREMIUM.
 18916
 18917 4660-EXIT.
 18918     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 364
* ECS010P.cbl
 18920 4666-SAVE-AHCR-DATA.
 18921
 18922     MOVE SPACES                 TO WX-STATUS-AT-CANCEL
 18923                                    WX-STATUS-AT-SETTLEMENT.
 18924
 18925     MOVE ZEROS                  TO WX-CANC-DT
 18926                                    WX-EOM-RUN-DATE
 18927                                    WX-SETTLEMENT-EXIT-DATE.
 18928
 18929     IF  CR-AH-CANC-DT GREATER THAN W-CUTOFF-DATE
 18930         MOVE CR-AH-CANC-DT      TO WX-CANC-DT
 18931         MOVE CR-AH-STATUS-AT-CANCEL
 18932                                 TO WX-STATUS-AT-CANCEL
 18933         MOVE ZEROS              TO CR-AH-CANC-DT
 18934                                    WS-CR-AH-CANC-DT-N
 18935         MOVE SPACES             TO CR-AH-STATUS-AT-CANCEL.
 18936
 18937     IF  CR-AH-SETTLEMENT-EXIT-DATE GREATER THAN W-CUTOFF-DATE
 18938         MOVE CR-AH-SETTLEMENT-EXIT-DATE
 18939                                 TO WX-SETTLEMENT-EXIT-DATE
 18940         MOVE CR-AH-STATUS-AT-SETTLEMENT
 18941                                 TO WX-STATUS-AT-SETTLEMENT
 18942         MOVE ZEROS              TO CR-AH-SETTLEMENT-EXIT-DATE
 18943                                 WS-CR-AH-SETTLEMENT-EXIT-DATEN
 18944         MOVE SPACES             TO CR-AH-STATUS-AT-SETTLEMENT.
 18945
 18946     MOVE EOM-RUN-DATE           TO WX-EOM-RUN-DATE.
 18947     MOVE W-CUTOFF-DATE          TO EOM-RUN-DATE.
 18948
 18949 4666-EXIT.
 18950     EXIT.
 18951
 18952 4668-RESTORE-AHCR-DATA.
 18953
 18954     IF  WX-CANC-DT GREATER THAN W-CUTOFF-DATE
 18955         MOVE WX-CANC-DT         TO CR-AH-CANC-DT
 18956                                    WS-CR-AH-CANC-DT-N
 18957         MOVE WX-STATUS-AT-CANCEL
 18958                                 TO CR-AH-STATUS-AT-CANCEL.
 18959
 18960     IF  WX-SETTLEMENT-EXIT-DATE GREATER THAN W-CUTOFF-DATE
 18961         MOVE WX-SETTLEMENT-EXIT-DATE
 18962                                 TO CR-AH-SETTLEMENT-EXIT-DATE
 18963                                 WS-CR-AH-SETTLEMENT-EXIT-DATEN
 18964         MOVE WX-STATUS-AT-SETTLEMENT
 18965                                 TO CR-AH-STATUS-AT-SETTLEMENT.
 18966
 18967     MOVE WX-EOM-RUN-DATE        TO EOM-RUN-DATE.
 18968
 18969 4668-EXIT.
 18970     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 365
* ECS010P.cbl
 18972 4670-CALC-EP.
 18973
 18974     IF  STATE-ABBR (CLAS-INDEXS) = 'WY'
 18975         MOVE W-OPT-PRO          TO W-EARNED-PREMIUM
 18976         ADD W-EARNED-PREMIUM    TO W-WY-EP
 18977         GO TO 4670-EXIT.
 18978
 18979     IF  STATE-ABBR (CLAS-INDEXS) = 'VA'
 18980         MOVE W-OPT-ST           TO W-EARNED-PREMIUM
 18981         ADD W-EARNED-PREMIUM    TO W-VA-EP
 18982         GO TO 4670-EXIT.
 18983
 18984***** NOTE THIS ASSUMES THAT ONLY A&H COVERAGES ARE PROCESSED HERE
 18985
 18986     IF  CLAS-I-EP (CLAS-INDEXA) = 'M'
 18987         COMPUTE W-EARNED-PREMIUM
 18988             = (W-OPT-PRO + W-OPT-R78) / +2
 18989         ADD W-EARNED-PREMIUM    TO W-M-EP
 18990     ELSE
 18991         IF  CLAS-I-EP (CLAS-INDEXA) = 'R'
 18992             MOVE W-OPT-R78      TO W-EARNED-PREMIUM
 18993             ADD W-EARNED-PREMIUM
 18994                                 TO W-R-EP
 18995         ELSE
 18996             IF  CLAS-I-EP (CLAS-INDEXA) = 'P'
 18997                 MOVE W-OPT-PRO  TO W-EARNED-PREMIUM
 18998                 ADD W-EARNED-PREMIUM
 18999                                 TO W-P-EP
 19000             ELSE
 19001                 IF  CLAS-I-EP (CLAS-INDEXA) = '1'
 19002                     COMPUTE W-EARNED-PREMIUM ROUNDED
 19003                         = (W-OPT-PRO * +.6667)
 19004                         + (W-OPT-R78 * +.3333)
 19005                     ADD W-EARNED-PREMIUM
 19006                                 TO W-1-EP
 19007                 ELSE
 19008                     ADD +1      TO W-OTHERS-COUNT
 19009                     MOVE ZEROS  TO W-EARNED-PREMIUM.
 19010
 19011 4670-EXIT.
 19012     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 366
* ECS010P.cbl
 19014 4680-CALC-REMAINING-AMT-LF.
 19015
 19016     MOVE LOW-VALUES             TO CP-INSURED-BIRTH-DT.
 19017     MOVE CR-AGE                 TO CP-ISSUE-AGE.
 19018     MOVE CR-APR                 TO CP-LOAN-APR.
 19019     MOVE CR-LOAN-TERM           TO CP-LOAN-TERM.
 19020
 19021     IF  CR-PMT-FREQ NOT GREATER THAN ZERO
 19022         MOVE +1                 TO CR-PMT-FREQ.
 19023
 19024     MOVE CR-PMT-FREQ            TO CP-PAY-FREQUENCY.
 19025
 19026     MOVE REM-TRM2               TO CP-REMAINING-TERM.
 19027     MOVE CR-LFAMT               TO CP-ORIGINAL-BENEFIT
 19028                                    CP-RATING-BENEFIT-AMT.
 19029     IF CP-STATE-STD-ABBRV = 'OR'
 19030         COMPUTE CP-RATING-BENEFIT-AMT = CR-LFAMT + CR-LFAMT-ALT.
 19031     MOVE CR-LFAMT-ALT           TO CP-ALTERNATE-BENEFIT.
 19032     MOVE CR-LFPRM               TO CP-ORIGINAL-PREMIUM.
 19033     MOVE ZEROS                  TO CP-REMAINING-AMT
 19034                                    CP-REMAINING-AMT-PRV
 19035                                    CP-RETURN-CODE
 19036                                    CP-RETURN-CODE-2.
 19037
 19038
 19039     CALL 'ELRAMTX' USING CALCULATION-PASS-AREA
 19040
 19041     IF  CP-RETURN-CODE NOT = ZERO
 19042         MOVE 'ERROR OCCURED REMAINING AMT CALCULATIONS'
 19043                             TO WS-ABEND-MESSAGE
 19044         MOVE CP-RETURN-CODE TO WS-ABEND-FILE-STATUS
 19045         MOVE 2001           TO WS-ABEND-CODE
 19046         GO TO ABEND-PGM.
 19047
 19048 4680-EXIT.
 19049     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 367
* ECS010P.cbl
 19051******************************************************************
 19052***  BUILDS ACCOUNT LEVEL IBNR (DIRECT AND REIN)               ***
 19053******************************************************************
 19054
 19055 4700-CALC-OPT-IBNR.
 19056
 19057     MOVE EPEC-OPT-DATA-TABLE    TO EPEC-OPT-WORK-TABLE.
 19058     MOVE SPACE                  TO W-UNDERWRITING-SW.
 19059
 19060     PERFORM 4710-PROCESS-THRU-EPEC-TABLE THRU 4710-EXIT
 19061             VARYING
 19062         SUB2 FROM +1 BY +1
 19063             UNTIL
 19064*        SUB2 GREATER THAN 300.
 19065*        SUB2 GREATER THAN 220.
 19066         SUB2 GREATER THAN 900.
 19067
 19068     MOVE EPEC-UNDW-OPT-DATA-TABLE
 19069                                 TO EPEC-OPT-WORK-TABLE.
 19070     MOVE '*'                    TO W-UNDERWRITING-SW.
 19071
 19072     PERFORM 4710-PROCESS-THRU-EPEC-TABLE THRU 4710-EXIT
 19073             VARYING
 19074         SUB2 FROM +1 BY +1
 19075             UNTIL
 19076*        SUB2 GREATER THAN 300.
 19077*        SUB2 GREATER THAN 220.
 19078         SUB2 GREATER THAN 900.
 19079
 19080 4700-EXIT.
 19081     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 368
* ECS010P.cbl
 19083 4710-PROCESS-THRU-EPEC-TABLE.
 19084
 19085     IF  EPEC-REIN-CO-OPT (SUB2) = ZEROS
 19086         GO TO 4710-EXIT.
 19087
 19088     IF  W-UNDERWRITTEN-DATA
 19089         MOVE EPEC-LEVELS-II (SUB2)  TO EPEC-WORK
 19090     ELSE
 19091         MOVE EPEC-LEVELS (SUB2)     TO EPEC-WORK.
 19092
 19093     IF EW-LEVEL-USED NOT = 'Y'
 19094         GO TO 4710-EXIT.
 19095
 19096     IF  EW-REIN-CO GREATER THAN SPACES
 19097         MOVE 'Y'                TO W-REIN-PROCESS-SW
 19098         IF  EPEC-REIN-ONLY-DATA (SUB2)
 19099             PERFORM 4760-PROCESS-REIN-ONLY THRU 4760-EXIT
 19100             IF  W-WK-IBNR GREATER THAN ZEROS
 19101                 PERFORM 4770-CREATE-REIN-DETAIL THRU 4770-EXIT
 19102                 GO TO 4710-EXIT
 19103             ELSE
 19104                 GO TO 4710-EXIT
 19105         ELSE
 19106             IF  EW-CLM-IBNR GREATER THAN ZEROS
 19107                 PERFORM 4770-CREATE-REIN-DETAIL THRU 4770-EXIT
 19108                 GO TO 4710-EXIT
 19109             ELSE
 19110                 GO TO 4710-EXIT.
 19111
 19112     MOVE SPACES                 TO W-REIN-PROCESS-SW.
 19113
 19114     IF  EW-LF-AH EQUAL 'L'
 19115         IF  EPEC-LIFE-IBNR (SUB2) EQUAL ZEROS
 19116             GO TO 4710-EXIT
 19117         ELSE
 19118             PERFORM 4720-PROCESS-LIFE THRU 4720-EXIT
 19119             ADD W-WK-IBNR       TO W-LIFE-IBNR
 19120     ELSE
 19121         IF  EPEC-EARNED-PREMIUM-AH (SUB2)
 19122                 GREATER THAN ZEROS
 19123             PERFORM 4730-PROCESS-A-H THRU 4730-EXIT
 19124             ADD W-WK-IBNR       TO W-AH-IBNR
 19125         ELSE
 19126             GO TO 4710-EXIT.
 19127
 19128     MOVE W-WK-IBNR              TO EW-CLM-IBNR.
 19129     MOVE EW-ISS-BEN             TO W-ISS-BEN.
 19130     MOVE EW-ISS-BEN-GROSS       TO W-ISS-BEN-GROSS.
 19131
 19132     IF  W-UNDERWRITTEN-DATA
 19133         MOVE EPEC-WORK          TO EPEC-LEVELS-II (SUB2)
 19134     ELSE
 19135         MOVE EPEC-WORK          TO EPEC-LEVELS (SUB2).
 19136
 19137
 19138     PERFORM 4740-CREATE-DETAIL-EXTR THRU 4740-EXIT.
 19139     PERFORM 4750-UPDATE-REIN THRU 4750-EXIT.
 19140
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 369
* ECS010P.cbl
 19141 4710-EXIT.
 19142     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 370
* ECS010P.cbl
 19144 4720-PROCESS-LIFE.
 19145
 19146     MOVE EPEC-LIFE-IBNR (SUB2)  TO W-WK-IBNR.
 19147
 19148 4720-EXIT.
 19149     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 371
* ECS010P.cbl
 19151 4730-PROCESS-A-H.
 19152
 19153     IF  AM-TARGET-LOSS-RATIO NUMERIC
 19154             AND
 19155         AM-TARGET-LOSS-RATIO NOT EQUAL ZERO
 19156         MOVE AM-TARGET-LOSS-RATIO
 19157                                 TO W-TARGET-LOSS-RATIO
 19158     ELSE
 19159         IF  CLAS-INDEXS NOT GREATER THAN CLAS-MAXS
 19160             MOVE STATE-TARGET-LOSS-RATIO (CLAS-INDEXS)
 19161                                 TO W-TARGET-LOSS-RATIO
 19162             PERFORM 4735-GET-BUSINESS-ADJUSTMENT THRU 4735-EXIT.
 19163
 19164     IF  W-NOT-REIN-PROCESS
 19165         ADD EPEC-EARNED-PREMIUM-AH (SUB2) TO W-EPEC-EP
 19166         ADD EPEC-CLAIMS-MADE-PAID (SUB2)  TO W-CLAIMS-MADE-PAID.
 19167
 19168     COMPUTE W-IBNR-1 ROUNDED
 19169         = EPEC-EARNED-PREMIUM-AH (SUB2)
 19170         * COMPANY-IBNR-AH-FACTOR
 19171         * W-TARGET-LOSS-RATIO.
 19172
 19173     COMPUTE W-IBNR-2 ROUNDED
 19174         = (EPEC-EARNED-PREMIUM-AH (SUB2)
 19175         * W-TARGET-LOSS-RATIO)
 19176         - EPEC-CLAIMS-MADE-PAID (SUB2).
 19177
 19178     IF  W-IBNR-1 GREATER THAN W-IBNR-2
 19179         MOVE W-IBNR-1           TO W-WK-IBNR
 19180         IF  W-NOT-REIN-PROCESS
 19181             ADD +1              TO W-AH-IBNR-1-CNT
 19182             ADD W-IBNR-1        TO W-AH-IBNR-1
 19183         ELSE
 19184             NEXT SENTENCE
 19185     ELSE
 19186         MOVE W-IBNR-2           TO W-WK-IBNR
 19187         IF  W-NOT-REIN-PROCESS
 19188             ADD +1              TO W-AH-IBNR-2-CNT
 19189             ADD W-IBNR-2        TO W-AH-IBNR-2.
 19190
 19191 4730-EXIT.
 19192     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 372
* ECS010P.cbl
 19194 4735-GET-BUSINESS-ADJUSTMENT.
 19195
 19196     IF  CR-GRPTYP NOT NUMERIC
 19197         MOVE '99'               TO INDEXBS
 19198     ELSE
 19199         MOVE CR-GRPTYP          TO INDEXBS.
 19200
 19201     IF  BUS-TRGT-LOSS-RATIO-MOD (INDEXBS) NUMERIC
 19202             AND
 19203         BUS-TRGT-LOSS-RATIO-MOD (INDEXBS)
 19204             NOT EQUAL ZEROS
 19205             AND
 19206         BUS-TRGT-LOSS-RATIO-MOD (INDEXBS)
 19207             NOT EQUAL +1.0000
 19208         MOVE INDEXBS           TO W-EDIT-7
 19209         COMPUTE W-TARGET-LOSS-RATIO ROUNDED
 19210             = W-TARGET-LOSS-RATIO
 19211             * BUS-TRGT-LOSS-RATIO-MOD (INDEXBS).
 19212
 19213 4735-EXIT.
 19214     EXIT.
 19215
 19216 4740-CREATE-DETAIL-EXTR.
 19217
 19218     IF DTE-PGM-OPT NOT = '1'
 19219         GO TO 4740-EXIT.
 19220
 19221     IF  EW-CLM-IBNR NOT GREATER THAN ZEROS
 19222         GO TO 4740-EXIT.
 19223
 19224     MOVE EOM-RUN-DATE           TO INCURRED-DATE.
 19225     MOVE ZEROS                  TO REPORTED-DATE
 19226                                    PAY-TO-DATE.
 19227
 19228     MOVE SPACES                 TO TR-DTL2.
 19229     MOVE 'ACTBENIBNR'           TO TRD-CERT.
 19230
 19231     MOVE EOM-YR                 TO TRD-ISYR.
 19232     MOVE EOM-MO                 TO TRD-ISMO.
 19233     MOVE EOM-DA                 TO TRD-ISDA.
 19234     MOVE ZERO                   TO TRD-AGE.
 19235
 19236     IF  EW-LF-AH EQUAL 'L'
 19237         MOVE LIFE-OVERRIDE-L6   TO TRD-RSV-DESC
 19238     ELSE
 19239         MOVE AH-OVERRIDE-L6     TO TRD-RSV-DESC.
 19240
 19241     MOVE SPACES                 TO TRD-PAYCURX
 19242                                    TRD-PAYCUR-SPACE
 19243                                    TRD-FUTRSV-SPACE
 19244                                    TRD-FUTRSVX.
 19245
 19246     MOVE EW-CLM-IBNR            TO TRD-IBNR.
 19247     MOVE 'IBNR'                 TO TRD-IBNRX.
 19248     MOVE EW-BEN-TYPE            TO TRD-BENEFIT-CODE.
 19249     MOVE 'BENEFIT - '           TO TRD-BENEFIT-X.
 19250
 19251     IF  W-UNDERWRITTEN-DATA
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 373
* ECS010P.cbl
 19252         IF  W-REIN-IN-PROCESS
 19253             MOVE ' ACCT/BEN REIN RSV UW'
 19254                                 TO TRD-RSV-ACTION
 19255         ELSE
 19256             MOVE ' ACCT/BEN RESERVES UW'
 19257                                 TO TRD-RSV-ACTION
 19258     ELSE
 19259         IF  W-REIN-IN-PROCESS
 19260             MOVE ' ACCT/BEN REIN RSV'
 19261                                 TO TRD-RSV-ACTION
 19262         ELSE
 19263             MOVE ' ACCT/BEN RESERVES'
 19264                                 TO TRD-RSV-ACTION.
 19265
 19266     PERFORM 8690-PRINT-DETAIL-LINE THRU 8699-PRT-DETAIL-X.
 19267
 19268     MOVE SPACES                 TO DETAIL-EXTRACT.
 19269
 19270     IF  W-REIN-IN-PROCESS
 19271         MOVE EW-REIN-CO         TO DE-REI-COMP
 19272         MOVE 'R'                TO DE-REIN
 19273         MOVE EW-CLM-IBNR        TO DE-REI-IBNR
 19274         MOVE ZEROS              TO DE-IBNR
 19275     ELSE
 19276         MOVE EW-CLM-IBNR        TO DE-IBNR
 19277         MOVE ZEROS              TO DE-REI-IBNR.
 19278
 19279     MOVE 'DE'                   TO DE-RECORD-ID.
 19280     MOVE 'Y'                    TO DE-TRANS.
 19281     MOVE 'IBNRRSV'              TO DE-CLMNO.
 19282     MOVE '1'                    TO DE-ENTRY-STATUS.
 19283     MOVE 'ACTBENIBNR'           TO DE-CERT.
 19284
 19285     MOVE EOM-RUN-DATE           TO DE-EFF
 19286                                    WS-DE-EFF-N
 19287                                    DE-ENTRY-DTE
 19288                                    WS-DE-ENTRY-DTE-N.
 19289     MOVE INCURRED-DATE          TO DE-RSV-INCUR
 19290                                    WS-DE-RSV-INCUR-N.
 19291
 19292     MOVE AM-COMPANY-CD          TO DE-COMPANY-CD.
 19293     MOVE AM-MSTR-CNTRL          TO DE-CNTRL1.
 19294     MOVE AM-EXPIRE-DT           TO DE-ACC-EXP-DTE-RSV
 19295                                    WS-DE-ACC-EXP-DTE-RSV-N.
 19296     MOVE AM-EFFECT-DT           TO DE-ACC-EFF-DTE-RSV
 19297                                    WS-DE-ACC-EFF-DTE-RSV-N.
 19298
 19299     MOVE AM-NAME                TO DE-RSV-ACC-NAME.
 19300     MOVE AM-RECALC-COMM         TO DE-RECALC-CODE.
 19301     MOVE AM-REMIT-TO            TO DE-REMIT-TO.
 19302     MOVE AM-REPORT-CODE-1       TO DE-REPORT-CODE-1.
 19303     MOVE AM-REPORT-CODE-2       TO DE-REPORT-CODE-2.
 19304     MOVE AM-POOL-PRIME          TO DE-NCL-POOL-CODE.
 19305     MOVE AM-IG                  TO DE-IG.
 19306
 19307     IF W-UNDERWRITTEN-DATA
 19308         MOVE 'Y'                TO DE-UNDERWRITING-CODE
 19309     ELSE
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 374
* ECS010P.cbl
 19310         MOVE 'N'                TO DE-UNDERWRITING-CODE.
 19311
 19312     IF  EW-LF-AH EQUAL 'L'
 19313         MOVE EW-BEN-TYPE        TO DE-LF-TYPE
 19314         MOVE '1'                TO DE-RESERVE-TYPE
 19315         MOVE ZEROS              TO DE-AH-TYPE
 19316     ELSE
 19317         MOVE EW-BEN-TYPE        TO DE-AH-TYPE
 19318         MOVE '2'                TO DE-RESERVE-TYPE
 19319         MOVE ZEROS              TO DE-LF-TYPE.
 19320
 19321     MOVE SPACES                 TO DE-NAME
 19322                                    DE-ACC-GPCD
 19323                                    DE-AH-STAT-CDE
 19324                                    DE-LF-STAT-CDE
 19325                                    DE-MEMBER-NO
 19326                                    DE-NAME
 19327                                    DE-SEX.
 19328     MOVE ZEROS                  TO DE-AGE
 19329                                    DE-AH-BEN
 19330                                    DE-AH-CANC-DTE
 19331                                    WS-DE-AH-CANC-DTE-N
 19332                                    DE-AH-CANC-EXIT-DT
 19333                                    WS-DE-AH-CANC-EXIT-DT-N
 19334                                    DE-AH-PRM
 19335                                    DE-AH-RFND
 19336                                    DE-AH-TERM
 19337                                    DE-APR
 19338                                    DE-CANCEL-CNT-ITD
 19339                                    DE-CANCEL-CNT-YTD
 19340                                    DE-FUTRSV
 19341                                    DE-LF-BEN
 19342                                    DE-LF-BEN-ALT
 19343                                    DE-LF-CANC-DTE
 19344                                    WS-DE-LF-CANC-DTE-N
 19345                                    DE-LF-CANC-EXIT-DT
 19346                                    WS-DE-LF-CANC-EXIT-DT-N
 19347                                    DE-LF-CNBEN
 19348                                    DE-LF-CNBEN-ALT
 19349                                    DE-LF-PRM
 19350                                    DE-LF-PRM-ALT
 19351                                    DE-LF-RFND
 19352                                    DE-LF-TERM
 19353                                    DE-LIVES
 19354                                    DE-PAYCUR
 19355                                    DE-PMT-FREQ
 19356                                    DE-REI-AHAMT
 19357                                    DE-REI-AHPRM
 19358                                    DE-REI-AHRFND
 19359                                    DE-REI-CNAMT
 19360                                    DE-REI-FUTRSV
 19361                                    DE-REI-LFAMT
 19362                                    DE-REI-LFPRM
 19363                                    DE-REI-LFRFND
 19364                                    DE-REI-PAYCUR
 19365                                    DE-RSV-REPORTED
 19366                                    DE-RSV-PAYTO
 19367                                    WS-DE-RSV-PAYTO-N
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 375
* ECS010P.cbl
 19368                                    DE-MOB-NET-TOT-FEES
 19369                                    DE-SOC-SEC-NO.
 19370
 19371     MOVE SPACES                 TO W-REIN-PROCESS-IND.
 19372
 19373     PERFORM 2500-WRITE-DETAIL-EXTRACTS
 19374         THRU 2599-WRT-DETAIL-X.
 19375     ADD +1                      TO BC-G-CRS.
 19376
 19377 4740-EXIT.
 19378     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 376
* ECS010P.cbl
 19380 4750-UPDATE-REIN.
 19381
 19382     COMPUTE SUB3 = SUB2 + 1.
 19383
 19384     IF  W-UNDERWRITTEN-DATA
 19385         MOVE EPEC-SUB-KEY-II (SUB2)
 19386                                 TO W-SUB-KEY
 19387     ELSE
 19388         MOVE EPEC-SUB-KEY (SUB2)
 19389                                 TO W-SUB-KEY.
 19390
 19391     PERFORM 4755-MATCH-REIN-EPEC THRU 4755-EXIT
 19392             VARYING
 19393         SUB3 FROM SUB3 BY +1
 19394             UNTIL
 19395         SUB3 GREATER THAN +900
 19396*        SUB3 GREATER THAN +220
 19397*        SUB3 GREATER THAN +300
 19398             OR
 19399         EPEC-LF-AH-OPT (SUB3) EQUAL SPACES.
 19400
 19401 4750-EXIT.
 19402     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 377
* ECS010P.cbl
 19404 4755-MATCH-REIN-EPEC.
 19405
 19406     IF  W-UNDERWRITTEN-DATA
 19407         MOVE EPEC-LEVELS-II (SUB3)
 19408                                 TO EPEC-WORK
 19409     ELSE
 19410         MOVE EPEC-LEVELS (SUB3) TO EPEC-WORK.
 19411
 19412     IF  EPEC-LINE-NOT-USED (SUB3)
 19413         GO TO 4755-EXIT.
 19414
 19415     IF  EW-SUB-KEY NOT EQUAL W-SUB-KEY
 19416             OR
 19417         EW-REIN-CO EQUAL SPACES
 19418         GO TO 4755-EXIT.
 19419
 19420     IF  W-ISS-BEN GREATER THAN ZEROS
 19421         IF  EPEC-REIN-ONLY-DATA (SUB3)
 19422             COMPUTE W-FACTOR ROUNDED
 19423                 = (EW-ISS-BEN
 19424                 - EPEC-REIN-ISS-BEN (SUB3))
 19425                 / W-ISS-BEN
 19426         ELSE
 19427             COMPUTE W-FACTOR ROUNDED
 19428                 = EW-ISS-BEN
 19429                 / W-ISS-BEN.
 19430
 19431     COMPUTE EW-CLM-IBNR ROUNDED
 19432         = EW-CLM-IBNR
 19433         + (W-WK-IBNR * W-FACTOR).
 19434
 19435     IF  W-UNDERWRITTEN-DATA
 19436         MOVE EPEC-WORK          TO EPEC-LEVELS-II (SUB3)
 19437     ELSE
 19438         MOVE EPEC-WORK          TO EPEC-LEVELS (SUB3).
 19439
 19440 4755-EXIT.
 19441     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 378
* ECS010P.cbl
 19443 4760-PROCESS-REIN-ONLY.
 19444
 19445     MOVE ZEROS                  TO W-WK-IBNR.
 19446
 19447     IF  EPEC-LINE-NOT-USED (SUB2)
 19448         GO TO 4760-EXIT.
 19449
 19450     IF  EW-LF-AH EQUAL 'L'
 19451         IF  EPEC-LIFE-IBNR (SUB2) EQUAL ZEROS
 19452             GO TO 4760-EXIT
 19453         ELSE
 19454             PERFORM 4720-PROCESS-LIFE THRU 4720-EXIT
 19455             ADD W-WK-IBNR       TO EW-CLM-IBNR
 19456     ELSE
 19457         IF  EPEC-EARNED-PREMIUM-AH (SUB2) EQUAL ZEROS
 19458             GO TO 4760-EXIT
 19459         ELSE
 19460             PERFORM 4730-PROCESS-A-H THRU 4730-EXIT
 19461             ADD W-WK-IBNR       TO EW-CLM-IBNR.
 19462
 19463 4760-EXIT.
 19464     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 379
* ECS010P.cbl
 19466 4770-CREATE-REIN-DETAIL.
 19467
 19468     MOVE 'Y'                    TO W-REIN-PROCESS-IND.
 19469     PERFORM 4740-CREATE-DETAIL-EXTR THRU 4740-EXIT.
 19470
 19471 4770-EXIT.
 19472     EXIT.
 19473
 19474 4799-EXIT.
 19475     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 380
* ECS010P.cbl
 19477 4800-CALC-EARNED-PREMIUM-AH.
 19478
 19479     MOVE +0                         TO CNC-BEN  EPR-R78
 19480                                        ISS-PRM  EPR-PRO
 19481                                        CNC-PRM  EPR-ST
 19482                                        WX-CLM-AMT
 19483                                        WX-CLM-EXP
 19484                                        WX-CLM-CNT
 19485                                        WX-CLM-CRT
 19486                                        WX-CNC-CNT
 19487                                        ISS-PRMTAX
 19488                                        WX-ACTIVE-COUNT.
 19489     MOVE SPACE                      TO A-H-EARNED-SWITCH.
 19490
 19491     MOVE WE-AHPRM TO ISS-PRM.
 19492
 19493     IF DTE-CLIENT = 'GIC'
 19494         IF REIN-EP-FLG NOT = 'R'  AND
 19495            CLAS-I-CALC-TYPE (CLAS-INDEXA) = 'B'  AND
 19496            (CR-ENTRY-STATUS NOT = '5' AND '3' AND 'M')
 19497            MOVE CR-AHPRM-CALC TO ISS-PRM.
 19498
 19499     IF REIN-EP-FLG = 'R'  AND
 19500        REIN-AH-RUNOFF-SW (SUB5) = 'N'
 19501         NEXT SENTENCE
 19502     ELSE
 19503         GO TO 4810-EP-DO-AH-CLM.
 19504
 19505     IF CR-DIS-DT NOT GREATER THAN EARNING-STOP-DATE
 19506         IF WE-DSPY-AMT NOT = +0
 19507             ADD WE-DSPY-AMT    TO WX-CLM-AMT
 19508             ADD WE-DSPY-EXP    TO WX-CLM-EXP
 19509             ADD CR-NUM-DIS-CLM TO WX-CLM-CNT
 19510             ADD +1             TO WX-CLM-CNT.
 19511
 19512     IF CR-AH-STATUS-AT-SETTLEMENT NOT = ' '
 19513         IF CR-DIS-DT GREATER THAN EARNING-STOP-DATE
 19514             GO TO 4830-EP-DO-AH-EP.
 19515
 19516     IF CR-AH-STATUS-AT-CANCEL NOT = ' '
 19517         IF CR-AH-CANC-DT GREATER THAN EARNING-STOP-DATE
 19518             GO TO 4830-EP-DO-AH-EP.
 19519
 19520     GO TO 4815-EP-DO-AH-CLM-EPR.
 19521
 19522 4810-EP-DO-AH-CLM.
 19523
 19524     IF WE-DSPY-AMT NOT = +0
 19525         ADD WE-DSPY-AMT    TO WX-CLM-AMT
 19526         ADD WE-DSPY-EXP    TO WX-CLM-EXP
 19527         ADD CR-NUM-DIS-CLM TO WX-CLM-CNT
 19528         ADD +1             TO WX-CLM-CNT.
 19529
 19530 4815-EP-DO-AH-CLM-EPR.
 19531
 19532     IF CR-AH-STATUS-AT-SETTLEMENT NOT = ' '
 19533         MOVE WE-AHPRM TO EPR-R78  EPR-PRO  EPR-ST.
 19534
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 381
* ECS010P.cbl
 19535 4820-EP-DO-AH-CNCL.
 19536
 19537     IF CR-AH-STATUS-AT-CANCEL = ' '
 19538         IF CR-AH-STATUS-AT-SETTLEMENT NOT = ' '  AND
 19539            CLAS-I-CALC-TYPE (CLAS-INDEXA) NOT = 'Z'
 19540             GO TO 4899-EXIT
 19541         ELSE
 19542             GO TO 4830-EP-DO-AH-EP.
 19543
 19544     IF (DTE-CLIENT = 'DCC')
 19545        AND (CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'G' OR 'L')
 19546        IF CR-AHRFND NOT = ZEROS
 19547           ADD +1                TO WX-CNC-CNT
 19548        END-IF
 19549     ELSE
 19550        ADD +1                   TO WX-CNC-CNT
 19551     END-IF
 19552
 19553     MOVE WE-AHRFND TO CNC-PRM.
 19554
 19555*    MOVE CR-DT                 TO  DC-GREG-DATE-CYMD.
 19556*    MOVE 'L'                   TO  DC-OPTION-CODE.
 19557*    PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 19558*    MOVE DC-BIN-DATE-1         TO  WS-CR-BIN-DATE.
 19559
 19560     MOVE CR-AH-CANC-DT         TO DC-GREG-DATE-CYMD.
 19561     MOVE 'L'                   TO  DC-OPTION-CODE.
 19562     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 19563     MOVE DC-BIN-DATE-1         TO  WS-BIN-CANCEL-DATE.
 19564
 19565     MOVE WS-CR-BIN-DATE          TO  DC-BIN-DATE-1.
 19566     MOVE WS-BIN-CANCEL-DATE      TO  DC-BIN-DATE-2.
 19567     MOVE '1'                     TO  DC-OPTION-CODE.
 19568     MOVE ZEROS                   TO  MONTHS-DIFF-AH.
 19569     MOVE ZEROS                   TO  DC-ELAPSED-MONTHS
 19570                                      DC-ODD-DAYS-OVER
 19571                                      DC-ELAPSED-DAYS.
 19572     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 19573     MOVE DC-ELAPSED-MONTHS       TO  MONTHS-DIFF-AH.
 19574
 19575     IF DC-ODD-DAYS-OVER   GREATER THAN  ZERO
 19576         ADD  +1                  TO  MONTHS-DIFF-AH.
 19577
 19578     MOVE  'YYYYYYYYYY'           TO  WS-AH-CHARGEBACK-LEVELS.
 19579
 19580     IF DTE-CLIENT = 'ACE'
 19581         GO TO 4820-CONTINUE-AH-CANCEL.
 19582
 19583     MOVE  ZEROS                  TO  SUB.
 19584
 19585 4820-AH-CHARGEBACK-LOOP.
 19586
 19587     ADD    +1                    TO  SUB.
 19588
 19589     IF  SUB  GREATER THAN  +10
 19590         GO TO  4820-CONTINUE-AH-CANCEL.
 19591
 19592     IF  AM-COMM-CHARGEBACK (SUB)  NOT  NUMERIC  OR
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 382
* ECS010P.cbl
 19593         AM-COMM-CHARGEBACK (SUB)  =  ZEROS
 19594         GO TO  4820-AH-CHARGEBACK-LOOP.
 19595
 19596     IF  AM-COMM-CHARGEBACK (SUB)  EQUAL    '99'
 19597         MOVE  'N'    TO  WS-AH-CHARGEBACK-SW (SUB).
 19598
 19599     IF  (MONTHS-DIFF-AH GREATER THAN AM-COMM-CHARGEBACK (SUB))
 19600         OR (CR-AHRFND = ZEROS)
 19601         MOVE  'N'        TO  WS-AH-CHARGEBACK-SW (SUB)
 19602     END-IF
 19603
 19604     GO TO  4820-AH-CHARGEBACK-LOOP.
 19605
 19606
 19607 4820-CONTINUE-AH-CANCEL.
 19608
 19609     IF DTE-CLIENT = 'GIC'
 19610         IF REIN-EP-FLG NOT = 'R'  AND
 19611            CLAS-I-CALC-TYPE (CLAS-INDEXA) = 'B'
 19612            MOVE CR-AHRFND-CALC TO CNC-PRM.
 19613
 19614     COMPUTE EPR-R78 = WE-AHPRM - WE-AHRFND.
 19615     MOVE EPR-R78 TO EPR-PRO  EPR-ST.
 19616
 19617     IF CR-AH-LUMP-SUM-DISAB
 19618         GO TO 4899-EXIT.
 19619
 19620     MOVE WE-AHAMT TO CNC-BEN.
 19621
 19622     GO TO 4899-EXIT.
 19623
 19624 4825-EP-DO-AH-CNCL-SUM.
 19625
 19626     IF WE-DSPY-AMT NOT = +0
 19627         ADD WE-DSPY-AMT    TO WX-CLM-AMT
 19628         ADD WE-DSPY-EXP    TO WX-CLM-EXP
 19629         ADD CR-NUM-DIS-CLM TO WX-CLM-CNT
 19630         ADD +1             TO WX-CLM-CNT.
 19631
 19632     IF WE-AHRFND = ZERO
 19633        GO TO 4830-EP-DO-AH-EP.
 19634
 19635     MOVE WE-AHRFND TO CNC-PRM.
 19636
 19637     ADD CR-SUM-CAN-CNT-ITD TO WX-CNC-CNT.
 19638
 19639     MOVE  'YYYYYYYYYY'           TO  WS-AH-CHARGEBACK-LEVELS.
 19640
 19641     IF WE-AHRFND NOT LESS WE-AHPRM
 19642         MOVE WE-AHAMT TO CNC-BEN
 19643          GO TO 4830-EP-DO-AH-EP.
 19644
 19645     COMPUTE TEMP-6 ROUNDED = WE-AHRFND / WE-AHPRM.
 19646     COMPUTE TEMP-7 ROUNDED = TEMP-6 * WE-AHAMT.
 19647     MOVE TEMP-7 TO CNC-BEN.
 19648
 19649 4830-EP-DO-AH-EP.
 19650
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 383
* ECS010P.cbl
 19651     MOVE EOM-RUN-DATE TO VALUATION-DT.
 19652     MOVE '8'           TO W-VAL-SOURCE.
 19653
 19654     IF REIN-EP-FLG = 'R'
 19655       IF REIN-REM-SW (SUB5) = 'I'
 19656           MOVE WE-AHPRM            TO EPR-R78  EPR-PRO  EPR-ST
 19657           GO TO 4899-EXIT.
 19658
 19659     IF REIN-EP-FLG = 'R'
 19660         IF REIN-AH-RUNOFF-SW (SUB5) = 'N'  AND
 19661            EARNING-STOP-DATE LESS THAN VALUATION-DT
 19662             MOVE '*'               TO A-H-EARNED-SWITCH
 19663             MOVE EARNING-STOP-DATE TO VALUATION-DT
 19664             MOVE '10'              TO W-VAL-SOURCE.
 19665
 19666     PERFORM 8500-REMAINING-TERM-ROUTINE THRU 8599-REM-TERM-X.
 19667
 19668     IF REM-TRM2 GREATER CR-AH-TERM
 19669         MOVE +0 TO EPR-R78  EPR-PRO  EPR-ST
 19670         GO TO 4899-EXIT.
 19671
 19672     IF CLAS-I-CALC-TYPE (CLAS-INDEXA) = 'Z'
 19673         COMPUTE WE-AHPRM = WE-AHPRM - WE-AHRFND.
 19674*
 19675 4835-CHECK-OB-AH-NCL.
 19676
 19677     IF (DTE-CLIENT EQUAL 'NCL') AND
 19678        (CLAS-I-CALC-TYPE (CLAS-INDEXA) EQUAL 'B')
 19679           MOVE WE-AHPRM         TO EPR-R78
 19680                                    EPR-PRO
 19681                                    EPR-ST
 19682        IF (CR-CCYY EQUAL EOM-CCYY) AND
 19683           (CR-MO EQUAL EOM-MO)
 19684           MOVE '*'            TO OB-DATE-1-SWITCH
 19685           MOVE EW-REIN-CO     TO WS-OB-REIN-CO (SUB3)
 19686           MOVE AH-OVERRIDE-L1 TO WS-OB-LF-AH (SUB3)
 19687           MOVE CR-AHTYP       TO WS-OB-BENEFIT-CODE (SUB3)
 19688           COMPUTE WS-EPR-R78 (SUB3 1) =
 19689                   WS-EPR-R78 (SUB3 1) + (WE-AHPRM * .5)
 19690           GO TO 4899-EXIT
 19691        ELSE
 19692        IF (CR-CCYY EQUAL OB-CCYY (1)) AND
 19693           (CR-MO EQUAL OB-MO (1))
 19694           MOVE '*'            TO OB-DATE-2-SWITCH
 19695           MOVE EW-REIN-CO     TO WS-OB-REIN-CO (SUB3)
 19696           MOVE AH-OVERRIDE-L1 TO WS-OB-LF-AH (SUB3)
 19697           MOVE CR-AHTYP       TO WS-OB-BENEFIT-CODE (SUB3)
 19698           COMPUTE WS-EPR-R78 (SUB3 2) =
 19699                   WS-EPR-R78 (SUB3 2) + (WE-AHPRM * .5)
 19700           GO TO 4899-EXIT
 19701        ELSE
 19702        IF (CR-CCYY EQUAL OB-CCYY (2)) AND
 19703           (CR-MO EQUAL OB-MO (2))
 19704           MOVE '*'            TO OB-DATE-3-SWITCH
 19705           MOVE EW-REIN-CO     TO WS-OB-REIN-CO (SUB3)
 19706           MOVE AH-OVERRIDE-L1 TO WS-OB-LF-AH (SUB3)
 19707           MOVE CR-AHTYP       TO WS-OB-BENEFIT-CODE (SUB3)
 19708           COMPUTE WS-EPR-R78 (SUB3 3) =
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 384
* ECS010P.cbl
 19709                   WS-EPR-R78 (SUB3 3) + (WE-AHPRM * .5)
 19710           GO TO 4899-EXIT
 19711        ELSE
 19712           GO TO 4899-EXIT.
 19713
 19714     IF REM-TRM2 NOT GREATER +0
 19715         MOVE WE-AHPRM TO EPR-R78  EPR-PRO  EPR-ST
 19716         GO TO 4899-EXIT.
 19717
 19718     IF CLAS-I-CALC-TYPE (CLAS-INDEXA) = 'B'
 19719         MOVE WE-AHPRM TO EPR-R78  EPR-PRO  EPR-ST
 19720         GO TO 4899-EXIT.
 19721
 19722     IF CLAS-I-CALC-TYPE (CLAS-INDEXA) NOT = 'Z'
 19723         MOVE +1 TO WX-ACTIVE-COUNT
 19724     ELSE
 19725         COMPUTE WX-ACTIVE-COUNT = CR-LIVES - CR-SUM-CAN-CNT-ITD.
 19726
 19727     COMPUTE TEMP-1 = CR-AH-TERM * (CR-AH-TERM + 1).
 19728     COMPUTE TEMP-2 = REM-TRM1 * (REM-TRM1 + 1).
 19729     IF DTE-R78 = '1'
 19730         COMPUTE TEMP-2 = REM-TRM1 * REM-TRM1.
 19731     COMPUTE TEMP-4 ROUNDED = TEMP-2 / TEMP-1.
 19732
 19733     IF DTE-CLIENT = 'MIC' OR 'MCC'
 19734         COMPUTE TEMP-5 ROUNDED = (REM-TRM1 - .5) / CR-AH-TERM
 19735     ELSE
 19736         COMPUTE TEMP-5 ROUNDED = REM-TRM1 / CR-AH-TERM.
 19737
 19738     COMPUTE EPR-R78 ROUNDED = WE-AHPRM * TEMP-4.
 19739     COMPUTE EPR-R78 = WE-AHPRM - EPR-R78.
 19740
 19741     COMPUTE EPR-PRO ROUNDED = WE-AHPRM * TEMP-5.
 19742     COMPUTE EPR-PRO = WE-AHPRM - EPR-PRO.
 19743
 19744     MOVE CLAS-I-EP (CLAS-INDEXA) TO AH-EARN-METHOD.
 19745
 19746*    IF AM-EARN-METHOD-A NOT EQUAL SPACES AND ZEROS
 19747*        MOVE AM-EARN-METHOD-A TO AH-EARN-METHOD.
 19748
 19749     MOVE SPACES TO STATUTORY-SWITCH-AH.
 19750
 19751     IF (STATE-ABBR (CLAS-INDEXS) = 'VA') AND
 19752        (CR-DT GREATER THAN  19921231)
 19753        AND (DTE-CLIENT NOT = 'DCC')
 19754         IF CR-AH-TERM GREATER THAN  +61
 19755             MOVE 'A' TO AH-EARN-METHOD
 19756             MOVE '*' TO STATUTORY-SWITCH-AH
 19757             GO TO 4845-EP-DO-AH-EP-AN
 19758         ELSE
 19759             GO TO 4860-EP-DO-AH-STATUTORY.
 19760
 19761     IF (AH-EARN-METHOD EQUAL 'N')
 19762                  OR
 19763        ((DTE-CLIENT = 'DCC')
 19764         AND (CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'G' OR 'L')
 19765         AND (CLAS-I-REFUND-METHOD (CLAS-INDEXA) NOT = 'G'))
 19766         GO TO 4840-EP-DO-AH-EP-NP
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 385
* ECS010P.cbl
 19767     END-IF
 19768
 19769     IF AH-EARN-METHOD EQUAL 'A' OR 'C'
 19770         MOVE 'A' TO AH-EARN-METHOD
 19771         GO TO 4845-EP-DO-AH-EP-AN.
 19772
 19773     GO TO 4860-EP-DO-AH-STATUTORY.
 19774
 19775 4840-EP-DO-AH-EP-NP.
 19776
 19777     IF WE-AHPRM = ZERO
 19778         GO TO 4860-EP-DO-AH-STATUTORY.
 19779
 19780     IF CR-APR GREATER THAN +0
 19781         NEXT SENTENCE
 19782     ELSE
 19783         GO TO 4860-EP-DO-AH-STATUTORY.
 19784
 19785     IF DTE-CLIENT = 'NCL'
 19786       IF CR-DT LESS THAN 19910101
 19787           GO TO 4860-EP-DO-AH-STATUTORY.
 19788
 19789     IF REM-TRM1 = CR-AH-TERM
 19790         MOVE +0 TO EPR-R78  EPR-PRO  EPR-ST
 19791         GO TO 4899-EXIT.
 19792
 19793     MOVE CR-APR TO NP-APR.
 19794     MOVE CR-AH-TERM TO NP-ORIG  NP-CAP.
 19795     MOVE REM-TRM1 TO NP-REM.
 19796     MOVE CLAS-I-CALC-TYPE (CLAS-INDEXA) TO NP-OPT.
 19797     IF NP-OPT = 'T' OR 'U' OR 'V' OR 'W' OR 'X'
 19798         MOVE CR-LOAN-TERM TO NP-ORIG.
 19799
 19800     IF (DTE-CLIENT = 'DCC')
 19801        AND (CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'G' OR 'L')
 19802        MOVE 'S'                 TO NP-OPT
 19803     ELSE
 19804        MOVE 'R'                 TO NP-OPT
 19805     END-IF
 19806
 19807
 19808*    MOVE 'R' TO NP-OPT.
 19809     CALL 'ECSNETRM'
 19810         USING NP-APR NP-ORIG NP-REM NP-OPT NP-CAP NP-FACTOR.
 19811
 19812     IF (DTE-CLIENT = 'DCC')
 19813        AND (CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'G' OR 'L')
 19814        COMPUTE EPR-ST ROUNDED =
 19815           WE-AHPRM - (NP-FACTOR * WE-AHPRM)
 19816        GO TO 4899-EXIT
 19817     ELSE
 19818        COMPUTE EPR-R78 ROUNDED =
 19819           WE-AHPRM - (NP-FACTOR * WE-AHPRM)
 19820     END-IF
 19821
 19822     GO TO 4860-EP-DO-AH-STATUTORY.
 19823
 19824 4845-EP-DO-AH-EP-AN.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 386
* ECS010P.cbl
 19825     MOVE CR-DT                      TO DC-GREG-DATE-CYMD.
 19826     MOVE 'L'                        TO DC-OPTION-CODE.
 19827     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 19828     MOVE DC-BIN-DATE-1              TO CP-CERT-EFF-DT.
 19829     MOVE CLAS-I-RL-AH (CLAS-INDEXA) TO CP-BENEFIT-TYPE.
 19830     MOVE SPACES                     TO CP-ACCT-FLD-5.
 19831     MOVE DTE-CLIENT                 TO CP-COMPANY-ID.
 19832     MOVE STATE-SUB (CLAS-INDEXS)    TO CP-STATE.
 19833     MOVE STATE-ABBR (CLAS-INDEXS)   TO CP-STATE-STD-ABBRV.
 19834     MOVE CR-AGE                     TO CP-ISSUE-AGE.
 19835     MOVE REM-TRM1                   TO CP-ORIGINAL-TERM.
 19836     MOVE CR-AHAMT                   TO CP-ORIGINAL-BENEFIT
 19837                                        CP-RATING-BENEFIT-AMT.
 19838     IF CP-STATE-STD-ABBRV = 'OR'
 19839         COMPUTE CP-RATING-BENEFIT-AMT =
 19840                                  CR-AHAMT * REM-TRM1.
 19841     MOVE CR-APR                     TO CP-LOAN-APR.
 19842     MOVE CR-PMT-FREQ                TO CP-PAY-FREQUENCY.
 19843     MOVE AH-EARN-METHOD             TO CP-EARNING-METHOD.
 19844     MOVE '3'                        TO CP-PROCESS-TYPE.
 19845     MOVE CLAS-I-BAL (CLAS-INDEXA)   TO CP-SPECIAL-CALC-CD.
 19846     MOVE CR-LOAN-TERM               TO CP-LOAN-TERM.
 19847     IF CR-RATING-CLASS NOT = SPACE AND ZERO
 19848         MOVE CR-RATING-CLASS        TO CP-CLASS-CODE
 19849     ELSE
 19850         MOVE AM-CAL-TABLE           TO CP-CLASS-CODE.
 19851     MOVE AM-AH-DEVIATION            TO CP-DEVIATION-CODE.
 19852     MOVE CR-AHTYP                   TO CP-BENEFIT-CD.
 19853     MOVE DTE-CLASIC-COMPANY-CD      TO CP-COMPANY-CD.
 19854     MOVE CR-PMT-EXTENSION-DAYS      TO CP-TERM-OR-EXT-DAYS.
 19855     MOVE AH-OVERRIDE-L1             TO CP-AH-OVERRIDE-CODE.
 19856     MOVE AM-AH-DEVIATION-PCT        TO CP-RATE-DEV-PCT.
 19857
 19858     PERFORM 8100-GET-RATE THRU 8199-GET-RATE-X.
 19859
 19860     IF CP-ERROR-RATE-NOT-FOUND  OR
 19861        CP-ERROR-RATE-IS-ZERO  OR
 19862        CP-ERROR-IN-DATES
 19863         GO TO 4860-EP-DO-AH-STATUTORY.
 19864
 19865     COMPUTE EPR-R78 ROUNDED =
 19866             ((REM-TRM1 * WE-AHAMT) / +100) *
 19867               CP-PREMIUM-RATE.
 19868
 19869     COMPUTE EPR-R78 = WE-AHPRM - EPR-R78.
 19870
 19871     IF STATUTORY-REQUIREMENT-AH
 19872         MOVE EPR-R78                TO EPR-ST
 19873         GO TO 4899-EXIT.
 19874
 19875 4860-EP-DO-AH-STATUTORY.
 19876
 19877     IF (DTE-CLIENT = 'DCC')
 19878        AND (CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'G' OR 'L')
 19879        AND (CLAS-I-REFUND-METHOD (CLAS-INDEXA) = 'G')
 19880        MOVE EPR-R78             TO EPR-ST
 19881        GO TO 4899-EXIT
 19882     END-IF
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 387
* ECS010P.cbl
 19883
 19884     MOVE EPR-R78                    TO EPR-ST.
 19885
 19886     MOVE +0                         TO SUB1.
 19887
 19888 4865-EP-AH-STAT-LOOP.
 19889     ADD +1 TO SUB1.
 19890
 19891     IF STATE-ABBR (CLAS-INDEXS) = AH-RES-STATE-ENT (SUB1)
 19892         MOVE EPR-PRO                TO EPR-ST
 19893     ELSE
 19894         IF AH-RES-STATE-ENT (SUB1) NOT = HIGH-VALUES
 19895             GO TO 4865-EP-AH-STAT-LOOP.
 19896
 19897     IF (STATE-ABBR (CLAS-INDEXS) = 'OH'  AND
 19898         CR-DT GREATER THAN 19831031)  OR
 19899
 19900        (STATE-ABBR (CLAS-INDEXS) = 'OK'  AND
 19901         CR-DT GREATER THAN 19820629)  OR
 19902
 19903        (STATE-ABBR (CLAS-INDEXS) = 'TX'  AND
 19904         CR-DT GREATER THAN 19830831)
 19905
 19906         COMPUTE EPR-ST = (EPR-R78 + EPR-PRO) / 2.
 19907
 19908     IF DTE-CLIENT = 'CSO'  OR  'CID'
 19909       IF STATE-ABBR (CLAS-INDEXS) = 'CO'
 19910         IF CR-DT LESS THAN 19970101
 19911             MOVE EPR-R78            TO EPR-ST
 19912         ELSE
 19913             COMPUTE EPR-ST = (EPR-R78 + EPR-PRO) / 2.
 19914
 19915     IF DTE-CLIENT = 'DCC'
 19916        IF CLAS-I-BAL (CLAS-INDEXA) = 'C'
 19917           MOVE EPR-PRO          TO EPR-ST
 19918        ELSE
 19919           COMPUTE EPR-ST = (EPR-R78 + EPR-PRO) / 2
 19920        END-IF
 19921     END-IF
 19922     .
 19923 4899-EXIT.
 19924     EXIT.
 19925******************************************************************
 19926***         W R I T E   S U M M A R Y   E X T R A C T S        ***
 19927******************************************************************
 19928
 19929 4900-WRITE-SUMMARY-EXTRACTS.
 19930
 19931     IF DTE-CLIENT = 'HER'
 19932         IF EP-RECORD-ID = 'EC'  AND
 19933            EP-REINCO = 'LNL'
 19934             GO TO 4999-WRT-SUMMARY-X.
 19935
 19936     MOVE EOM-RUN-DATE            TO EP-RUN-DTE
 19937                                     WS-EP-RUN-DTE-N.
 19938
 19939     IF W-UNDERWRITTEN-DATA
 19940         MOVE 'Y'                 TO EP-UNDERWRITING-CODE
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 388
* ECS010P.cbl
 19941     ELSE
 19942         MOVE 'N'                 TO EP-UNDERWRITING-CODE.
 19943
 19944     IF  DTE-OPT-RESERVE-METHOD-AUTH
 19945         IF VALID-EP-ID
 19946             MOVE 'Y'             TO EP-NEW-DATA-IND.
 19947
 19948     WRITE EP-RECORD.
 19949
 19950     ADD +1                       TO EP-CNT.
 19951
 19952 4999-WRT-SUMMARY-X.
 19953     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 389
* ECS010P.cbl
 19955******************************************************************
 19956***       T O T A L   P A G E   S E T U P   R O U T I N E      ***
 19957******************************************************************
 19958
 19959 5000-DATE-RANGE-BREAK.
 19960
 19961     IF NO-TRANSACTION-WAS-PROCESSED
 19962         GO TO 5099-DATE-RANGE-BREAK-X.
 19963
 19964     ADD +1  TO RANGE-CNT.
 19965     MOVE +1 TO SUB6.
 19966     MOVE +2 TO SUB7.
 19967     PERFORM 5800-ADD-PAGES-LEVELS THRU 5899-ADD-PAGES-LEVELS-X.
 19968     IF LN-CNT GREATER +50
 19969         PERFORM 8700-PRINT-REPORT-HEADINGS THRU
 19970                 8750-PRT-RANGE-HEADING.
 19971
 19972     MOVE SPACES                     TO PRT.
 19973     PERFORM 8800-PRINT-ROUTINE.
 19974     MOVE 'DATE RANGE'               TO TPH2-DESC.
 19975     MOVE '  TOTALS'                 TO TPH3-DESC.
 19976     PERFORM 6100-ACCT-TOTAL-HEADINGS THRU 6199-PAGE-HEADINGS-X.
 19977     PERFORM 6500-PRINT-TOTAL-PAGE THRU 6599-TOTAL-PAGE-PRINT-X.
 19978     PERFORM 5900-CLEAR-TOTAL-PAGES
 19979         THRU 5999-CLEAR-TOTAL-PAGES-X
 19980             VARYING SUB6 FROM 1 BY 1 UNTIL SUB6 GREATER 1.
 19981
 19982 5099-DATE-RANGE-BREAK-X.
 19983     EXIT.
 19984
 19985 5100-ACCOUNT-BREAK.
 19986
 19987     IF RANGE-CNT NOT = +0
 19988         PERFORM 5000-DATE-RANGE-BREAK
 19989             THRU 5099-DATE-RANGE-BREAK-X
 19990     ELSE
 19991         MOVE +1 TO SUB6
 19992         MOVE +2 TO SUB7
 19993         PERFORM 5800-ADD-PAGES-LEVELS
 19994             THRU 5899-ADD-PAGES-LEVELS-X
 19995         PERFORM 5900-CLEAR-TOTAL-PAGES
 19996             THRU 5999-CLEAR-TOTAL-PAGES-X
 19997                 VARYING SUB6 FROM 1 BY 1 UNTIL SUB6 GREATER 1.
 19998
 19999     MOVE +0 TO RANGE-CNT.
 20000     PERFORM 7500-ADD-UP-REIN-CO THRU 7599-ADD-UP-REIN-X
 20001         VARYING B-SUB FROM 1 BY 1
 20002             UNTIL B-SUB GREATER THAN 50  OR
 20003                   RB-COMPANY (B-SUB) = SPACES.
 20004     PERFORM 7900-CLEAR-BILLING-TABLE THRU 7999-CLEAR-BILLING-X
 20005         VARYING B-SUB FROM 1 BY 1
 20006             UNTIL B-SUB GREATER THAN 50.
 20007
 20008     IF ACCT-FLG = SPACE
 20009         GO TO 5199-ACCOUNT-BREAK-X.
 20010
 20011     MOVE SPACE TO ACCT-FLG.
 20012     MOVE +2 TO SUB6.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 390
* ECS010P.cbl
 20013     MOVE +3 TO SUB7.
 20014     PERFORM 5800-ADD-PAGES-LEVELS THRU 5899-ADD-PAGES-LEVELS-X.
 20015     IF LN-CNT GREATER +50
 20016         PERFORM 8700-PRINT-REPORT-HEADINGS THRU
 20017                 8725-PRT-ACCT-HEADING.
 20018
 20019     MOVE SPACES                     TO PRT.
 20020     PERFORM 8800-PRINT-ROUTINE.
 20021     MOVE 'ACCOUNT'                  TO TPH2-DESC.
 20022     MOVE ' TOTALS'                  TO TPH3-DESC.
 20023     PERFORM 6100-ACCT-TOTAL-HEADINGS THRU 6199-PAGE-HEADINGS-X.
 20024     PERFORM 6500-PRINT-TOTAL-PAGE THRU 6599-TOTAL-PAGE-PRINT-X.
 20025     PERFORM 5900-CLEAR-TOTAL-PAGES
 20026         THRU 5999-CLEAR-TOTAL-PAGES-X
 20027             VARYING SUB6 FROM 2 BY 1 UNTIL SUB6 GREATER 2.
 20028
 20029 5199-ACCOUNT-BREAK-X.
 20030     EXIT.
 20031
 20032 5200-STATE-BREAK.
 20033
 20034     PERFORM 5100-ACCOUNT-BREAK THRU 5199-ACCOUNT-BREAK-X.
 20035     MOVE ZEROS TO SV-LO-CERT  SV-HI-CERT.
 20036     MOVE +3 TO SUB6.
 20037     MOVE +4 TO SUB7.
 20038     PERFORM 5800-ADD-PAGES-LEVELS THRU 5899-ADD-PAGES-LEVELS-X.
 20039
 20040     IF STATE-FLG = SPACE
 20041         GO TO 5299-STATE-BREAK-X.
 20042
 20043     MOVE SPACE         TO STATE-FLG.
 20044     PERFORM 8700-PRINT-REPORT-HEADINGS.
 20045     MOVE 'STATE'       TO TPH1-TYPE.
 20046     MOVE HLD-STATE     TO STATE-L.
 20047
 20048     PERFORM 8200-STATE-CODE-LOOKUP THRU 8299-STATE-LOOKUP-X.
 20049
 20050     IF HLD-STATE NOT = STATE-SUB (CLAS-INDEXS)
 20051         MOVE SPACES          TO TPH1-DESC
 20052         MOVE HLD-STATE       TO TPH1-ST-CODE
 20053         MOVE 'UNKNOWN STATE' TO TPH1-ST-DESC
 20054     ELSE
 20055         MOVE SPACES TO TPH1-DESC
 20056         MOVE STATE-SUB (CLAS-INDEXS) TO TPH1-ST-CODE
 20057         MOVE STATE-PIC (CLAS-INDEXS) TO TPH1-ST-DESC.
 20058
 20059     MOVE 'STATE'  TO TPH2-DESC.
 20060     MOVE 'TOTALS' TO TPH3-DESC.
 20061     PERFORM 6000-TOTAL-PAGE-HEADINGS THRU 6199-PAGE-HEADINGS-X.
 20062     PERFORM 6500-PRINT-TOTAL-PAGE THRU 6599-TOTAL-PAGE-PRINT-X.
 20063     PERFORM 5900-CLEAR-TOTAL-PAGES
 20064         THRU 5999-CLEAR-TOTAL-PAGES-X
 20065             VARYING SUB6 FROM 3 BY 1 UNTIL SUB6 GREATER 3.
 20066
 20067 5299-STATE-BREAK-X.
 20068     EXIT.
 20069
 20070 5300-COMP-BREAK.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 391
* ECS010P.cbl
 20071
 20072     PERFORM 5200-STATE-BREAK THRU 5299-STATE-BREAK-X.
 20073     MOVE +4 TO SUB6.
 20074     MOVE +5 TO SUB7.
 20075     PERFORM 5800-ADD-PAGES-LEVELS THRU 5899-ADD-PAGES-LEVELS-X.
 20076
 20077     IF COMP-FLG = SPACE
 20078         GO TO 5399-COMP-BREAK-X.
 20079
 20080     MOVE ' ' TO COMP-FLG.
 20081     PERFORM 8700-PRINT-REPORT-HEADINGS.
 20082     MOVE 'COMPANY'                   TO TPH1-TYPE.
 20083     MOVE HLD-GROUPING                TO TPH1-DESC.
 20084     MOVE 'COMPANY'                   TO TPH2-DESC.
 20085     MOVE ' TOTALS'                   TO TPH3-DESC.
 20086     PERFORM 6000-TOTAL-PAGE-HEADINGS THRU 6199-PAGE-HEADINGS-X.
 20087     PERFORM 6500-PRINT-TOTAL-PAGE THRU 6599-TOTAL-PAGE-PRINT-X.
 20088     PERFORM 5900-CLEAR-TOTAL-PAGES
 20089         THRU 5999-CLEAR-TOTAL-PAGES-X
 20090             VARYING SUB6 FROM 4 BY 1 UNTIL SUB6 GREATER 4.
 20091
 20092 5399-COMP-BREAK-X.
 20093     EXIT.
 20094
 20095 5400-CARR-BREAK.
 20096
 20097     PERFORM 5300-COMP-BREAK THRU 5399-COMP-BREAK-X.
 20098     MOVE +5 TO SUB6.
 20099     MOVE +6 TO SUB7.
 20100     PERFORM 5800-ADD-PAGES-LEVELS THRU 5899-ADD-PAGES-LEVELS-X.
 20101
 20102     IF CARR-FLG = SPACE
 20103         GO TO 5499-CARR-BREAK-X.
 20104
 20105     MOVE ' ' TO CARR-FLG.
 20106     PERFORM 8700-PRINT-REPORT-HEADINGS.
 20107     MOVE 'CARRIER'               TO TPH1-TYPE.
 20108     MOVE HLD-CARRIER             TO TPH1-DESC.
 20109     MOVE 'CARRIER'               TO TPH2-DESC.
 20110     MOVE ' TOTALS'               TO TPH3-DESC.
 20111     PERFORM 6000-TOTAL-PAGE-HEADINGS THRU 6199-PAGE-HEADINGS-X.
 20112     PERFORM 6500-PRINT-TOTAL-PAGE THRU 6599-TOTAL-PAGE-PRINT-X.
 20113     PERFORM 5900-CLEAR-TOTAL-PAGES
 20114         THRU 5999-CLEAR-TOTAL-PAGES-X
 20115             VARYING SUB6 FROM 5 BY 1 UNTIL SUB6 GREATER 5.
 20116
 20117 5499-CARR-BREAK-X.
 20118     EXIT.
 20119
 20120 5500-FINAL-BREAK.
 20121
 20122     PERFORM 5400-CARR-BREAK THRU 5499-CARR-BREAK-X.
 20123
 20124     IF FINAL-FLG = SPACE
 20125         GO TO 5599-FINAL-BREAK-X.
 20126
 20127     IF DTE-FICH = '1'
 20128         MOVE '2'  TO  DTE-FICH.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 392
* ECS010P.cbl
 20129     MOVE +6 TO SUB6.
 20130     PERFORM 8700-PRINT-REPORT-HEADINGS.
 20131     MOVE SPACES   TO TPH1-TYPE.
 20132     MOVE SPACES   TO TPH1-DESC.
 20133     MOVE 'FINAL'  TO TPH2-DESC.
 20134     MOVE 'TOTALS' TO TPH3-DESC.
 20135     PERFORM 6000-TOTAL-PAGE-HEADINGS THRU 6199-PAGE-HEADINGS-X.
 20136     PERFORM 6500-PRINT-TOTAL-PAGE THRU 6599-TOTAL-PAGE-PRINT-X.
 20137
 20138 5599-FINAL-BREAK-X.
 20139     EXIT.
 20140
 20141 5800-ADD-PAGES-LEVELS.
 20142
 20143     ADD TPL-ISS-PRM (SUB6)  TO TPL-ISS-PRM (SUB7).
 20144     ADD TPA-ISS-PRM (SUB6)  TO TPA-ISS-PRM (SUB7).
 20145     ADD TPL-CNC-PRM (SUB6)  TO TPL-CNC-PRM (SUB7).
 20146     ADD TPA-CNC-PRM (SUB6)  TO TPA-CNC-PRM (SUB7).
 20147     ADD TPL-ACCT-COM (SUB6) TO TPL-ACCT-COM (SUB7).
 20148     ADD TPA-ACCT-COM (SUB6) TO TPA-ACCT-COM (SUB7).
 20149     ADD TPL-CLAIMS (SUB6)   TO TPL-CLAIMS (SUB7).
 20150     ADD TPA-CLAIMS (SUB6)   TO TPA-CLAIMS (SUB7).
 20151
 20152 5899-ADD-PAGES-LEVELS-X.
 20153     EXIT.
 20154
 20155 5900-CLEAR-TOTAL-PAGES.
 20156
 20157     MOVE +0 TO TPL-ISS-PRM (SUB6)  TPA-ISS-PRM (SUB6)
 20158             TPL-CNC-PRM (SUB6)     TPA-CNC-PRM (SUB6)
 20159             TPL-ACCT-COM (SUB6)    TPA-ACCT-COM (SUB6)
 20160             TPL-CLAIMS (SUB6)      TPA-CLAIMS (SUB6).
 20161
 20162 5999-CLEAR-TOTAL-PAGES-X.
 20163     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 393
* ECS010P.cbl
 20165******************************************************************
 20166***       T O T A L   P A G E   P R I N T   R O U T I N E      ***
 20167******************************************************************
 20168
 20169 6000-TOTAL-PAGE-HEADINGS.
 20170
 20171     MOVE TOTAL-PAGE-HD1 TO PRT.
 20172     PERFORM 8800-PRINT-ROUTINE.
 20173
 20174 6100-ACCT-TOTAL-HEADINGS.
 20175
 20176     MOVE TOTAL-PAGE-HD2 TO PRT.
 20177     MOVE '0' TO P-CTL.
 20178     PERFORM 8800-PRINT-ROUTINE.
 20179     MOVE TOTAL-PAGE-HD3 TO PRT.
 20180     MOVE ' ' TO P-CTL.
 20181     PERFORM 8800-PRINT-ROUTINE.
 20182     PERFORM 8800-PRINT-ROUTINE.
 20183     MOVE +81 TO LN-CNT.
 20184
 20185 6199-PAGE-HEADINGS-X.
 20186     EXIT.
 20187
 20188 6500-PRINT-TOTAL-PAGE.
 20189
 20190     MOVE SPACES             TO TOTAL-PAGE-DETAIL.
 20191     MOVE LIFE-OVERRIDE-L6   TO TPD-DESC.
 20192     MOVE TPL-ISS-PRM (SUB6) TO TPD-ISS-PRM.
 20193
 20194     IF SUB6 = 6 AND ME-DO-UPDATE
 20195         MOVE TPL-ISS-PRM (6) TO ME-010-PREM-L.
 20196
 20197     MOVE TPL-CNC-PRM (SUB6) TO TPD-CNC-PRM.
 20198
 20199     IF SUB6 = 6 AND ME-DO-UPDATE
 20200         MOVE TPL-CNC-PRM (6) TO ME-010-REF-L.
 20201
 20202     COMPUTE TPD-NET-PRM =
 20203         TPL-ISS-PRM (SUB6) - TPL-CNC-PRM (SUB6).
 20204
 20205     IF SUB6 = 6 AND ME-DO-UPDATE
 20206         SUBTRACT TPL-CNC-PRM (6) FROM TPL-ISS-PRM (6)
 20207         GIVING ME-010-NET-L.
 20208
 20209     MOVE TPL-ACCT-COM (SUB6) TO TPD-ACCT-COM.
 20210
 20211     IF SUB6 = 6 AND ME-DO-UPDATE
 20212         MOVE TPL-ACCT-COM (6) TO ME-010-COMM-L.
 20213
 20214     COMPUTE TPD-PREM-COMP =
 20215         TPL-ISS-PRM (SUB6) - TPL-CNC-PRM (SUB6)
 20216                            - TPL-ACCT-COM (SUB6).
 20217     MOVE TPL-CLAIMS (SUB6)   TO TPD-CLAIMS.
 20218
 20219     IF SUB6 = 6 AND ME-DO-UPDATE
 20220         MOVE TPL-CLAIMS (6) TO ME-010-PMT-L.
 20221
 20222     IF SUB6 = 6
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 394
* ECS010P.cbl
 20223         MOVE TPL-CLAIMS (6)          TO WS-ME-BAL-AMT
 20224         MOVE WS-BALANCE-DESCRIPTION1 TO WS-ME-BAL-DESCRIP
 20225         WRITE ME-ECS010-BALANCE-REC  FROM WS-ME-BALANCE-REC
 20226     END-IF.
 20227
 20228     MOVE TOTAL-PAGE-DETAIL   TO PRT.
 20229     PERFORM 8800-PRINT-ROUTINE.
 20230     MOVE SPACES             TO TOTAL-PAGE-DETAIL.
 20231     MOVE AH-OVERRIDE-L6     TO TPD-DESC.
 20232     MOVE TPA-ISS-PRM (SUB6) TO TPD-ISS-PRM.
 20233     MOVE TPA-CNC-PRM (SUB6) TO TPD-CNC-PRM.
 20234
 20235     IF SUB6 = 6 AND ME-DO-UPDATE
 20236         MOVE TPA-ISS-PRM (6) TO ME-010-PREM-AH
 20237         MOVE TPA-CNC-PRM (6) TO ME-010-REF-AH.
 20238
 20239     COMPUTE TPD-NET-PRM =
 20240         TPA-ISS-PRM (SUB6) - TPA-CNC-PRM (SUB6).
 20241
 20242     IF SUB6 = 6 AND ME-DO-UPDATE
 20243         SUBTRACT TPA-CNC-PRM (6) FROM TPA-ISS-PRM (6)
 20244         GIVING ME-010-NET-AH.
 20245
 20246     MOVE TPA-ACCT-COM (SUB6) TO TPD-ACCT-COM.
 20247
 20248     IF SUB6 = 6 AND ME-DO-UPDATE
 20249         MOVE TPA-ACCT-COM (6) TO ME-010-COMM-AH.
 20250
 20251     COMPUTE TPD-PREM-COMP =
 20252         TPA-ISS-PRM (SUB6) - TPA-CNC-PRM (SUB6)
 20253                            - TPA-ACCT-COM (SUB6).
 20254     MOVE TPA-CLAIMS (SUB6)   TO TPD-CLAIMS.
 20255
 20256     IF SUB6 = 6 AND ME-DO-UPDATE
 20257         MOVE TPA-CLAIMS (6) TO ME-010-PMT-AH.
 20258
 20259     IF SUB6 = 6
 20260         MOVE TPA-CLAIMS (6)          TO WS-ME-BAL-AMT
 20261         MOVE WS-BALANCE-DESCRIPTION2 TO WS-ME-BAL-DESCRIP
 20262         WRITE ME-ECS010-BALANCE-REC  FROM WS-ME-BALANCE-REC
 20263     END-IF.
 20264
 20265     MOVE TOTAL-PAGE-DETAIL   TO PRT.
 20266     PERFORM 8800-PRINT-ROUTINE.
 20267
 20268     MOVE 'TOTAL' TO TPD-DESC.
 20269
 20270     COMPUTE TPD-ISS-PRM =
 20271         TPL-ISS-PRM (SUB6) + TPA-ISS-PRM (SUB6).
 20272
 20273     COMPUTE TPD-CNC-PRM =
 20274         TPL-CNC-PRM (SUB6) + TPA-CNC-PRM (SUB6).
 20275
 20276     COMPUTE TPD-NET-PRM =
 20277         TPL-ISS-PRM (SUB6) + TPA-ISS-PRM (SUB6)
 20278         - TPL-CNC-PRM (SUB6) - TPA-CNC-PRM (SUB6).
 20279
 20280     COMPUTE TPD-ACCT-COM =
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 395
* ECS010P.cbl
 20281         TPL-ACCT-COM (SUB6) + TPA-ACCT-COM (SUB6).
 20282
 20283     COMPUTE TPD-PREM-COMP =
 20284         TPL-ISS-PRM (SUB6) + TPA-ISS-PRM (SUB6)
 20285         - TPL-CNC-PRM (SUB6) - TPA-CNC-PRM (SUB6)
 20286         - TPL-ACCT-COM (SUB6) - TPA-ACCT-COM (SUB6).
 20287
 20288     COMPUTE TPD-CLAIMS =
 20289         TPL-CLAIMS (SUB6) + TPA-CLAIMS (SUB6).
 20290
 20291     IF SV-LO-CERT = ZEROS  AND  SV-HI-CERT = ZEROS
 20292         NEXT SENTENCE
 20293     ELSE
 20294         MOVE SV-LO-CERT (6:6) TO TPD-LO-CERT
 20295         MOVE SV-HI-CERT (6:6) TO TPD-HI-CERT
 20296         MOVE ZEROS TO SV-LO-CERT  SV-HI-CERT.
 20297*        MOVE SV-LO-CERT (4:8)    TO TPD-LO-CERT
 20298*        MOVE SV-HI-CERT (4:8)    TO TPD-HI-CERT
 20299*        MOVE ZEROS               TO SV-LO-CERT
 20300*                                    SV-HI-CERT.
 20301
 20302     MOVE TOTAL-PAGE-DETAIL       TO PRT.
 20303     MOVE '0'                     TO P-CTL.
 20304     PERFORM 8800-PRINT-ROUTINE.
 20305     PERFORM 8800-PRINT-ROUTINE.
 20306
 20307 6599-TOTAL-PAGE-PRINT-X.
 20308     EXIT.
 20309*
 20310*
 20311*
 20312**START***********************************************************
 20313*      CUSTOM CODING FOR CLIENT "DMD"            PROJECT# 6475
 20314*            PARAGRAPHS  XXXX THRU 6700-COMM-EXIT
 20315******************************************************************
 20316*
 20317 6650-GET-RES-STATE-COMM.
 20318*6650-BROWSE-FORWARD.
 20319
 20320     IF DTE-CLIENT NOT = 'DMD'
 20321         GO TO 6700-COMM-EXIT.
 20322
 20323     MOVE CR-COMPANY-CD       TO WS-ERRESC-COMPANY-CD.
 20324     MOVE CR-CARRIER          TO WS-ERRESC-CARRIER.
 20325     MOVE CR-GROUPING         TO WS-ERRESC-GROUP.
 20326     MOVE CR-STATE            TO WS-ERRESC-STATE.
 20327     MOVE CR-ACCOUNT          TO WS-ERRESC-ACCOUNT.
 20328     MOVE WK-AGT              TO WS-ERRESC-AGENT.
 20329     MOVE CR-CERT-NO (1:2)    TO WS-ERRESC-RES-STATE.
 20330     MOVE CR-DT               TO WS-YYYYMMDD-DT.
 20331
 20332     MOVE WS-YYYYMMDD-DT      TO WS-ERRESC-EXPIRE-DT.
 20333
 20334*POSITION FILE AT STARTING KEY RECORD(COMPANY, CARRIER, GROUP, STA
 20335*ACCOUNT,AGENT, RESIDENT STATE) AND RESC-EXPIRE-DATE SET BY THE
 20336*VALUE OF PB-CERT-EFF-DT
 20337*
 20338     MOVE WS-ERRESC-KEY        TO ERRESC-RECORD-KEY.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 396
* ECS010P.cbl
 20339
 20340     START ERRESC-IN KEY NOT LESS THAN ERRESC-RECORD-KEY.
 20341
 20342     IF ERRESC-FILE-STATUS NOT EQUAL '00'
 20343         GO TO 6700-COMM-EXIT.
 20344
 20345*GET RECORD WHERE POSITIONED
 20346
 20347 6650-READ-ERRESC-NEXT.
 20348     READ ERRESC-IN NEXT RECORD.
 20349
 20350     IF ERRESC-FILE-STATUS NOT EQUAL '00'
 20351         GO TO 6700-COMM-EXIT.
 20352
 20353*GOT GOOD RECORD ??    FIRST 32 POSITIONS MUST MATCH  !!!!!!
 20354
 20355     IF ERRESC-RECORD-KEY (1:32) EQUAL TO WS-ERRESC-KEY (1:32)
 20356        NEXT SENTENCE
 20357     ELSE
 20358         GO TO 6700-COMM-EXIT.
 20359
 20360     IF WS-YYYYMMDD-DT < RESC-EXPIRE-DATE
 20361         NEXT SENTENCE
 20362     ELSE
 20363         GO TO 6650-READ-ERRESC-NEXT.
 20364
 20365*  CR-DT  = WS-YYYYMMDD-DT
 20366*CHECK TO SEE IF CERTIFICATE EFFECTIVE DATE IS WITHIN ACCOUNT
 20367*RESIDENT STATE COMMISSION RECORD'S EFFECTIVE TIME PERIOD???
 20368
 20369     IF WS-YYYYMMDD-DT IS LESS THAN RESC-EFFECTIVE-DATE
 20370         GO TO 6700-COMM-EXIT.
 20371
 20372* SEARCH FOR MATCHING CATEGORY CODE ENTRY
 20373
 20374     MOVE ZEROS               TO WS-SUB WS-SUB1.
 20375
 20376     PERFORM 6680-SEARCH-CATEGORY THRU 6680-EXIT.
 20377
 20378     IF WS-SUB1 IS GREATER THAN ZERO
 20379         IF RESC-COMMISSION-PER (WS-SUB) NOT NUMERIC
 20380             PERFORM 6680-SET-TABLE-CODE
 20381         ELSE
 20382             PERFORM 6680-SET-COMMISSION.
 20383
 20384     GO TO 6700-COMM-EXIT.
 20385
 20386 6680-SET-TABLE-CODE.
 20387     IF RESC-COMMISSION-TAB (WS-SUB) EQUAL SPACES
 20388        MOVE ZEROS             TO WS-SUB1
 20389     ELSE
 20390* DEFAULT TO AH-COVERAGE TO READ COMMISSION TABLE(CTBL)
 20391* TO COMPUTE AH COMMISSION.
 20392        MOVE CR-AHTYP          TO CTBL-BEN-CODE
 20393        MOVE CR-AH-TERM        TO WS-COMM-TERM
 20394        MOVE AH-OVERRIDE-L1    TO CTBL-BEN-TYPE
 20395        MOVE RESC-COMMISSION-TAB (WS-SUB)
 20396                               TO CTBL-TABLE-CD
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 397
* ECS010P.cbl
 20397        PERFORM 6680-READ-CTBL-TABLE
 20398        IF ERCTBL-FILE-STATUS NOT EQUAL '00'
 20399           MOVE ZEROS          TO WS-SUB1.
 20400
 20401 6680-READ-CTBL-TABLE.
 20402*
 20403* WHEN CR-AHTYP = ZEROS READ COMMISSION TABLE(CTBL)
 20404* TO COMPUTE LIFE COMMISSION
 20405
 20406     IF CR-AHTYP = ZERO
 20407        MOVE LIFE-OVERRIDE-L1  TO CTBL-BEN-TYPE
 20408        MOVE CR-LFTYP          TO CTBL-BEN-CODE
 20409        MOVE CR-LF-TERM        TO WS-COMM-TERM.
 20410
 20411     PERFORM 1300-READ-ERCTBL-FILE THRU 1399-READ-ERCTBL-X.
 20412
 20413     IF ERCTBL-FILE-STATUS EQUAL '00'
 20414* COMPUTE A-H COMMISSION WHEN CR-AHTYP IS NOT ZEROS
 20415        IF CR-AHTYP NOT = ZERO
 20416             COMPUTE COMM-CK-AMT = CR-AHAMT * CR-AH-TERM
 20417             MOVE CR-AH-TERM        TO WS-COMM-TERM
 20418             PERFORM 1400-GET-COMM-PERCENT THRU 1489-GET-PERCENT-X
 20419             MOVE WK-RATE           TO WS-COMMISSION
 20420                                       PB-I-AH-COMMISSION
 20421        ELSE
 20422* COMPUTE LIFE COMMISSION WHEN CR-AHTYP IS ZEROS
 20423             MOVE CR-LFAMT    TO COMM-CK-AMT
 20424             MOVE CR-LF-TERM  TO WS-COMM-TERM
 20425             PERFORM 1400-GET-COMM-PERCENT THRU 1489-GET-PERCENT-X
 20426             MOVE WK-RATE     TO WS-COMMISSION
 20427                                 PB-I-LIFE-COMMISSION.
 20428
 20429 6680-SET-COMMISSION.
 20430     IF RESC-COMMISSION-PER (WS-SUB) EQUAL ZEROS
 20431           MOVE ZEROS         TO WS-SUB1
 20432       ELSE
 20433           MOVE RESC-COMMISSION-PER (WS-SUB)
 20434                              TO WS-COMMISSION WK-RATE
 20435           IF CR-AHTYP NOT = ZERO
 20436                MOVE WS-COMMISSION TO PB-I-AH-COMMISSION
 20437           ELSE
 20438                MOVE WS-COMMISSION TO PB-I-LIFE-COMMISSION.
 20439
 20440 6680-SEARCH-CATEGORY.
 20441     ADD +1 TO WS-SUB.
 20442
 20443     IF WS-SUB IS GREATER THAN +12
 20444         GO TO 6680-EXIT.
 20445
 20446     IF CR-CERT-NO (4:1) = RESC-COVERAGE-CAT (WS-SUB)
 20447          MOVE WS-SUB         TO WS-SUB1
 20448          GO TO 6680-EXIT.
 20449
 20450     GO TO 6680-SEARCH-CATEGORY.
 20451
 20452 6680-EXIT.
 20453     EXIT.
 20454
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 398
* ECS010P.cbl
 20455 6700-COMM-EXIT.
 20456     EXIT.
 20457*
 20458*END***************CUSTOM CODE FOR CLIENT "DMD"*************
 20459
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 399
* ECS010P.cbl
 20461******************************************************************
 20462***         C L I E N T   B I L L I N G   R O U T I N E        ***
 20463******************************************************************
 20464
 20465 7000-CLIENT-BILLING-ROUTINE.
 20466*
 20467*
 20468* LEAVE THE ABOVE 2 LINES IN TO PREVENT LOSING THE LINE ABOVE
 20469
 20470     MOVE +0 TO BC-NET-WRIT BC-NET-WRIT-OB BC-NET-WRIT-SP
 20471                BC-G-ISS      BC-G-CNC   BC-G-CLM
 20472                BC-G-CRS      BC-G-CTN   BC-R-ISS      BC-R-CNC
 20473                BC-R-CLM      BC-R-CRS   BC-R-CTN      BC-COMM
 20474                BC-NEW-ACCTS  BC-ACCTS   BC-ACT-ACCTS
 20475                BC-G-CERTS    BC-G-A-CERTS  BC-R-CERTS
 20476                BC-R-A-CERTS  BC-ER-ACCTS   BC-CS-ACCTS.
 20477
 20478 7099-BILL-X.
 20479     EXIT.
 20480
 20481
 20482 7500-ADD-UP-REIN-CO.
 20483
 20484     IF RB-COMPANY (B-SUB) NOT = SPACES
 20485         ADD RB-COUNT (B-SUB) TO BC-CS-ACCTS.
 20486
 20487 7599-ADD-UP-REIN-X.
 20488     EXIT.
 20489
 20490 7900-CLEAR-BILLING-TABLE.
 20491
 20492     MOVE SPACES TO RB-COMPANY (B-SUB).
 20493     MOVE 0      TO RB-COUNT (B-SUB).
 20494
 20495 7999-CLEAR-BILLING-X.
 20496     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 400
* ECS010P.cbl
 20498******************************************************************
 20499***         M I S C E L L A N E O U S   R O U T I N E S        ***
 20500******************************************************************
 20501
 20502 8000-DATE-CONVERT-ROUTINE.
 20503
 20504     CALL 'ELDATCX' USING DATE-CONVERSION-DATA.
 20505
 20506 8099-DATE-CONVERT-X.
 20507     EXIT.
 20508
 20509 8000R-CONVERT-STOP-DATE.
 20510
 20511     MOVE RWF-EP-STOP-DATE        TO DC-GREG-DATE-CYMD.
 20512     MOVE 'L'                     TO DC-OPTION-CODE.
 20513     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 20514     MOVE +0                      TO DC-ELAPSED-MONTHS.
 20515     MOVE -1                      TO DC-ELAPSED-DAYS.
 20516     MOVE '6'                     TO DC-OPTION-CODE.
 20517     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 20518     MOVE +0                      TO DC-ELAPSED-MONTHS
 20519                                     DC-ELAPSED-DAYS.
 20520     MOVE DC-BIN-DATE-2           TO DC-BIN-DATE-1.
 20521     MOVE ' '                     TO DC-OPTION-CODE.
 20522     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 20523
 20524     IF NO-CONVERSION-ERROR
 20525         MOVE DC-GREG-DATE-CYMD   TO EARNING-STOP-DATE
 20526     ELSE
 20527         DISPLAY 'ERROR OCCURED CONVERTING EARNING STOP '
 20528                 'DATE IN REIN TABLE: ' CR-REIN-TABLE
 20529                 '  STOP DATE: ' RWF-EP-STOP-DATE
 20530         MOVE 'ERROR OCCURED CONVERTING EARNING STOP DATE '
 20531                                  TO WS-ABEND-MESSAGE
 20532         MOVE DC-ERROR-CODE       TO WS-ABEND-FILE-STATUS
 20533         MOVE 4002                TO WS-ABEND-CODE
 20534         GO TO ABEND-PGM.
 20535
 20536 8099R-STOP-DATE-X.
 20537     EXIT.
 20538
 20539
 20540 8100-GET-RATE.
 20541
 20542     CALL 'ELRATEX' USING CALCULATION-PASS-AREA.
 20543
 20544 8199-GET-RATE-X.
 20545     EXIT.
 20546
 20547
 20548 8200-STATE-CODE-LOOKUP.
 20549
 20550     IF CLAS-INDEXS NOT GREATER CLAS-MAXS  AND
 20551        CLAS-INDEXS NOT = ZERO
 20552         IF STATE-L = STATE-SUB (CLAS-INDEXS)
 20553             GO TO 8299-STATE-LOOKUP-X.
 20554
 20555     MOVE CLAS-STARTS TO CLAS-INDEXS.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 401
* ECS010P.cbl
 20556
 20557 8250-STATE-LOOKUP-LOOP.
 20558
 20559     IF CLAS-INDEXS GREATER CLAS-MAXS  OR  CLAS-INDEXS = ZERO
 20560         MOVE 0302 TO WS-ABEND-CODE
 20561         DISPLAY 'STATE CODE ' STATE-L ' NOT IN STATE TABLE'
 20562         DISPLAY '******************************'
 20563         DISPLAY '***** ERROR LOCATION 022 *****'
 20564         DISPLAY '******************************'
 20565         MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
 20566         GO TO ABEND-PGM.
 20567
 20568     IF STATE-L NOT = STATE-SUB (CLAS-INDEXS)
 20569         ADD +1 TO CLAS-INDEXS
 20570         GO TO 8250-STATE-LOOKUP-LOOP.
 20571
 20572 8299-STATE-LOOKUP-X.
 20573     EXIT.
 20574
 20575
 20576 8300-LIFE-TYPE-LOOKUP.
 20577
 20578     IF CLAS-INDEXL NOT GREATER CLAS-MAXL  AND
 20579        CLAS-INDEXL NOT = ZERO
 20580         IF CLAS-LOOK = CLAS-I-BEN (CLAS-INDEXL)
 20581             GO TO 8399-LIFE-LOOKUP-X.
 20582
 20583     MOVE CLAS-STARTL TO CLAS-INDEXL.
 20584
 20585 8350-LIFE-LOOKUP-LOOP.
 20586
 20587     IF CLAS-INDEXL GREATER CLAS-MAXL  OR  CLAS-INDEXL = ZERO
 20588         MOVE 0401 TO WS-ABEND-CODE
 20589         DISPLAY 'LIFE TYPE ' CLAS-LOOK ' NOT IN TYPE TABLE'
 20590         DISPLAY '    PENDING CONTROL = ' PENDING-MATCH-CONTROL
 20591         DISPLAY '       CERT CONTROL = ' CR-FULL-CONTROL
 20592         DISPLAY '******************************'
 20593         DISPLAY '***** ERROR LOCATION 023 *****'
 20594         DISPLAY '******************************'
 20595         MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
 20596         IF DTE-CLIENT = 'NCL'
 20597                      OR 'CID'
 20598             MOVE CLAS-STARTL      TO CLAS-INDEXL
 20599             MOVE '05'             TO CLAS-LOOK
 20600             GO TO 8350-LIFE-LOOKUP-LOOP
 20601         ELSE
 20602             GO TO ABEND-PGM.
 20603
 20604     IF CLAS-LOOK NOT = CLAS-I-BEN (CLAS-INDEXL)
 20605         ADD +1 TO CLAS-INDEXL
 20606         GO TO 8350-LIFE-LOOKUP-LOOP.
 20607
 20608     IF CLAS-I-EP (CLAS-INDEXL) = 'U'
 20609         MOVE 'R'                    TO CLAS-I-EP (CLAS-INDEXL).
 20610
 20611 8399-LIFE-LOOKUP-X.
 20612     EXIT.
 20613
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 402
* ECS010P.cbl
 20614
 20615 8400-A-H-TYPE-LOOKUP.
 20616
 20617     IF CLAS-INDEXA NOT GREATER CLAS-MAXA  AND
 20618        CLAS-INDEXA NOT = ZERO
 20619         IF CLAS-LOOK = CLAS-I-BEN (CLAS-INDEXA)
 20620             GO TO 8499-A-H-LOOKUP-X.
 20621
 20622     MOVE CLAS-STARTA TO CLAS-INDEXA.
 20623
 20624 8450-A-H-LOOKUP-LOOP.
 20625
 20626     IF CLAS-INDEXA GREATER CLAS-MAXA  OR  CLAS-INDEXA = ZERO
 20627         MOVE 0402 TO WS-ABEND-CODE
 20628         DISPLAY 'A&H TYPE ' CLAS-LOOK ' NOT IN TYPE TABLE'
 20629         DISPLAY '    PENDING CONTROL = ' PENDING-MATCH-CONTROL
 20630         DISPLAY '       CERT CONTROL = ' CR-FULL-CONTROL
 20631         DISPLAY '******************************'
 20632         DISPLAY '***** ERROR LOCATION 024 *****'
 20633         DISPLAY '******************************'
 20634         MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
 20635         IF DTE-CLIENT = 'NCL'
 20636             MOVE CLAS-STARTA      TO CLAS-INDEXA
 20637             MOVE '05'             TO CLAS-LOOK
 20638             GO TO 8450-A-H-LOOKUP-LOOP
 20639         ELSE
 20640             GO TO ABEND-PGM.
 20641
 20642     IF CLAS-LOOK NOT = CLAS-I-BEN (CLAS-INDEXA)
 20643         ADD +1 TO CLAS-INDEXA
 20644         GO TO 8450-A-H-LOOKUP-LOOP.
 20645
 20646 8499-A-H-LOOKUP-X.
 20647     EXIT.
 20648
 20649 8500-REMAINING-TERM-ROUTINE.
 20650
 20651     MOVE ZEROS                      TO CP-REMAINING-TERM
 20652                                        CP-REMAINING-TERM-1
 20653                                        CP-REMAINING-TERM-2
 20654                                        CP-REMAINING-TERM-3
 20655                                        CP-RETURN-CODE
 20656                                        CP-RETURN-CODE-2
 20657                                        REM-TRM1
 20658                                        REM-TRM2
 20659                                        REM-TRM3
 20660                                        TEM-TRM1.
 20661     MOVE SPACES                     TO CP-REM-TERM-METHOD.
 20662
 20663     MOVE CR-DT                      TO DC-GREG-DATE-CYMD.
 20664     MOVE 'L'                        TO DC-OPTION-CODE.
 20665     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 20666
 20667     IF  NO-CONVERSION-ERROR
 20668         MOVE DC-BIN-DATE-1          TO CP-CERT-EFF-DT
 20669     ELSE
 20670         MOVE 'ERROR OCCURED CONVERTING CR-DT'
 20671                                     TO WS-ABEND-MESSAGE
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 403
* ECS010P.cbl
 20672         MOVE DC-ERROR-CODE          TO WS-ABEND-FILE-STATUS
 20673         MOVE 3001                   TO WS-ABEND-CODE
 20674         GO TO ABEND-PGM.
 20675
 20676     MOVE LOW-VALUES                 TO CP-FIRST-PAY-DATE
 20677
 20678     IF  CR-LOAN-1ST-PMT-DT NOT NUMERIC
 20679         MOVE ZEROS                  TO CR-LOAN-1ST-PMT-DT.
 20680
 20681     IF  CR-LOAN-1ST-PMT-DT NOT = ZEROS
 20682         MOVE CR-LOAN-1ST-PMT-DT     TO DC-GREG-DATE-1-YMD
 20683         MOVE ZEROS                  TO DC-ELAPSED-MONTHS
 20684                                        DC-ELAPSED-DAYS
 20685         MOVE '3'                    TO DC-OPTION-CODE
 20686         PERFORM 8000-DATE-CONVERT-ROUTINE THRU
 20687                 8099-DATE-CONVERT-X
 20688         IF  NO-CONVERSION-ERROR
 20689             MOVE DC-BIN-DATE-1      TO CP-FIRST-PAY-DATE
 20690         ELSE
 20691             MOVE ZEROS              TO CR-LOAN-1ST-PMT-DT.
 20692
 20693     IF  CP-FIRST-PAY-DATE LESS THAN CP-CERT-EFF-DT
 20694         MOVE ZEROS                  TO CR-LOAN-1ST-PMT-DT.
 20695
 20696     IF  CR-LOAN-1ST-PMT-DT = ZEROS
 20697         MOVE CP-CERT-EFF-DT         TO DC-BIN-DATE-1
 20698         MOVE +1                     TO DC-ELAPSED-MONTHS
 20699         MOVE ZEROS                  TO DC-ELAPSED-DAYS
 20700         MOVE '6'                    TO DC-OPTION-CODE
 20701         PERFORM 8000-DATE-CONVERT-ROUTINE THRU
 20702                 8099-DATE-CONVERT-X
 20703         IF  NO-CONVERSION-ERROR
 20704             MOVE DC-BIN-DATE-2      TO CP-FIRST-PAY-DATE
 20705             MOVE DC-GREG-DATE-1-YMD TO CR-LOAN-1ST-PMT-DT
 20706         ELSE
 20707             MOVE 'ERROR OCCURED DETERMINING 1ST PAY DATE '
 20708                                     TO WS-ABEND-MESSAGE
 20709             MOVE DC-ERROR-CODE      TO WS-ABEND-FILE-STATUS
 20710             MOVE 3002               TO WS-ABEND-CODE
 20711             GO TO ABEND-PGM.
 20712
 20713     MOVE VALUATION-DT               TO DC-GREG-DATE-CYMD.
 20714     MOVE 'L'                        TO DC-OPTION-CODE.
 20715     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 20716
 20717     IF  NO-CONVERSION-ERROR
 20718         MOVE DC-BIN-DATE-1          TO CP-VALUATION-DT
 20719     ELSE
 20720         DISPLAY 'ERROR CONVERTING VALUATION DATE, SOURCE - '
 20721             W-VAL-ERROR (W-VAL-SOURCE)
 20722         DISPLAY '   KEY - ' CR-FULL-CONTROL
 20723             ' VALUATION DT - ' VALUATION-DT ' ERROR - '
 20724             DC-ERROR-CODE
 20725         DISPLAY '   STATUS: ' CR-ENTRY-STATUS ' LF: ' CR-LFTYP
 20726         ' ' CR-LF-CURRENT-STATUS '-' CR-LF-STATUS-AT-CANCEL '-'
 20727             CR-LF-STATUS-AT-DEATH ' AH: ' CR-AHTYP ' '
 20728             CR-AH-CURRENT-STATUS '-' CR-AH-STATUS-AT-CANCEL '-'
 20729             CR-AH-STATUS-AT-SETTLEMENT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 404
* ECS010P.cbl
 20730*        MOVE 'ERROR OCCURED CONVERTING VALUATION DATE'
 20731*                                    TO WS-ABEND-MESSAGE
 20732*        MOVE DC-ERROR-CODE          TO WS-ABEND-FILE-STATUS
 20733*        MOVE 3003                   TO WS-ABEND-CODE
 20734*        GO TO ABEND-PGM.
 20735
 20736     MOVE STATE-SUB (CLAS-INDEXS)    TO CP-STATE.
 20737     MOVE STATE-ABBR (CLAS-INDEXS)   TO CP-STATE-STD-ABBRV.
 20738     MOVE '3'                        TO CP-PROCESS-TYPE.
 20739     MOVE DTE-CLASIC-COMPANY-CD      TO CP-COMPANY-CD.
 20740     MOVE DTE-CLIENT                 TO CP-COMPANY-ID.
 20741     MOVE SPACES                     TO CP-ACCT-FLD-5.
 20742
 20743*    MOVE CLAS-CO-REM-TERM-CALC (W-NDX)
 20744*                                    TO CP-REM-TERM-METHOD.
 20745
 20746     IF  DTE-CLIENT = 'FIM'
 20747         MOVE '5'                    TO CP-REM-TERM-METHOD.
 20748
 20749     IF DTE-CLIENT = 'FLI' OR 'FLU'
 20750         IF WE-LF-AH = AH-OVERRIDE-L1
 20751             MOVE '2'                TO CP-REM-TERM-METHOD
 20752         ELSE
 20753             IF CR-LFTYP = '01' OR '03'
 20754                 MOVE '4'            TO CP-REM-TERM-METHOD
 20755             ELSE
 20756                 IF CR-LFTYP = '02' OR '04'
 20757                     MOVE '2'        TO CP-REM-TERM-METHOD.
 20758
 20759     IF  DTE-CLIENT = 'CSL'
 20760         IF  CR-CARRIER = '2'
 20761             IF  CR-LFTYP = '07' OR  '08'
 20762                 MOVE '4'            TO CP-REM-TERM-METHOD.
 20763
 20764     IF  DTE-CLIENT = 'POS'
 20765         IF  CR-CARRIER = '1'
 20766             MOVE '1'                TO CP-REM-TERM-METHOD
 20767         ELSE
 20768             MOVE '2'                TO CP-REM-TERM-METHOD.
 20769
 20770     IF  CP-REM-TERM-METHOD = SPACES OR LOW-VALUES
 20771         MOVE DTE-REM-TRM            TO CP-REM-TERM-METHOD.
 20772
 20773     IF  WE-LF-AH EQUAL AH-OVERRIDE-L1
 20774         GO TO 8540-CALC-REM-TERM-AH.
 20775
 20776 8520-CALC-REM-TERM-LIFE.
 20777
 20778     MOVE CLAS-I-EP (CLAS-INDEXL)    TO CP-EARNING-METHOD.
 20779     MOVE CLAS-I-RL-AH (CLAS-INDEXL) TO CP-BENEFIT-TYPE.
 20780     MOVE CLAS-I-BAL (CLAS-INDEXL)   TO CP-SPECIAL-CALC-CD.
 20781*    MOVE ORIG-TERM                  TO CP-ORIGINAL-TERM.
 20782     MOVE CR-LF-TERM                 TO CP-ORIGINAL-TERM
 20783                                        CP-LOAN-TERM.
 20784
 20785     IF  CLAS-I-EP (CLAS-INDEXL) EQUAL 'B'
 20786             AND
 20787         CLAS-I-CALC-TYPE (CLAS-INDEXL) NOT EQUAL 'L'
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 405
* ECS010P.cbl
 20788         ADD +1                      TO CP-ORIGINAL-TERM
 20789                                        CP-LOAN-TERM.
 20790
 20791     IF  CP-TERM-IS-DAYS
 20792         MOVE CR-LF-TERM-IN-DAYS     TO CP-TERM-OR-EXT-DAYS
 20793     ELSE
 20794         MOVE ZEROS                  TO CP-TERM-OR-EXT-DAYS.
 20795
 20796     MOVE DTE-REM-TRM-CALC-OPTION    TO CP-REM-TRM-CALC-OPTION.
 20797
 20798     IF  CP-ORIGINAL-TERM NOT GREATER THAN ZEROS
 20799         ADD +1                      TO W-ORGTRM-0-LF
 20800         DISPLAY 'LF TRM NOT GREATER THAN +0 - '
 20801             CR-FULL-CONTROL
 20802         GO TO 8599-REM-TERM-X.
 20803
 20804     CALL 'ELRTRMX' USING CALCULATION-PASS-AREA.
 20805
 20806     IF  CP-RETURN-CODE NOT EQUAL ZEROS
 20807         ADD +1                      TO W-RET-CODE-LF
 20808         GO TO 8599-REM-TERM-X.
 20809*
 20810*        MOVE 'ERROR OCCURED REMAINING TERM CALCULATION - LF'
 20811*                                    TO WS-ABEND-MESSAGE
 20812*        MOVE CP-RETURN-CODE         TO WS-ABEND-FILE-STATUS
 20813*        MOVE 2002                   TO WS-ABEND-CODE
 20814*        GO TO ABEND-PGM.
 20815
 20816     IF  CLAS-I-EP (CLAS-INDEXL) EQUAL 'B'
 20817             AND
 20818         CLAS-I-CALC-TYPE (CLAS-INDEXL) NOT EQUAL 'L'
 20819         MOVE CP-REMAINING-TERM-2    TO W-BAL-REMTRM
 20820         COMPUTE CP-REMAINING-TERM-1 = CP-REMAINING-TERM-1 - 1
 20821         COMPUTE CP-REMAINING-TERM-2 = CP-REMAINING-TERM-2 - 1.
 20822
 20823     IF  CP-REMAINING-TERM-1 NEGATIVE
 20824         MOVE ZEROS                  TO CP-REMAINING-TERM-1.
 20825
 20826     IF  CP-REMAINING-TERM-2 NEGATIVE
 20827         MOVE ZEROS                  TO CP-REMAINING-TERM-2.
 20828
 20829     IF DTE-CLIENT = 'NCL'
 20830         MOVE CP-REMAINING-TERM-1    TO CP-REMAINING-TERM-2
 20831                                        CP-REMAINING-TERM-3.
 20832
 20833     MOVE CP-REMAINING-TERM-1        TO REM-TRM1.
 20834     MOVE CP-REMAINING-TERM-2        TO REM-TRM2.
 20835     MOVE CP-REMAINING-TERM-3        TO REM-TRM3.
 20836     MOVE CP-ODD-DAYS                TO TEM-TRM1.
 20837
 20838     GO TO 8599-REM-TERM-X.
 20839
 20840 8520-EXIT.
 20841     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 406
* ECS010P.cbl
 20843 8540-CALC-REM-TERM-AH.
 20844
 20845     MOVE CLAS-I-EP (CLAS-INDEXA)    TO CP-EARNING-METHOD.
 20846     MOVE CLAS-I-RL-AH (CLAS-INDEXA) TO CP-BENEFIT-TYPE.
 20847     MOVE CLAS-I-BAL (CLAS-INDEXA)   TO CP-SPECIAL-CALC-CD.
 20848     MOVE CR-AH-TERM                 TO CP-ORIGINAL-TERM
 20849                                        CP-LOAN-TERM.
 20850     MOVE ZEROS                      TO CP-TERM-OR-EXT-DAYS.
 20851
 20852     MOVE DTE-REM-TRM-CALC-OPTION    TO CP-REM-TRM-CALC-OPTION.
 20853
 20854     IF  CP-ORIGINAL-TERM NOT GREATER THAN ZEROS
 20855         DISPLAY 'AH TRM NOT GREATER THAN +0 - '
 20856             CR-FULL-CONTROL
 20857         ADD +1                      TO W-ORGTRM-0-AH
 20858         GO TO 8599-REM-TERM-X.
 20859
 20860     CALL 'ELRTRMX' USING CALCULATION-PASS-AREA.
 20861
 20862     IF  CP-RETURN-CODE NOT EQUAL ZEROS
 20863         ADD +1                      TO W-RET-CODE-AH
 20864         GO TO 8599-REM-TERM-X.
 20865*
 20866*        MOVE 'ERROR OCCURED REMAINING TERM CALCULATION - AH'
 20867*                                    TO WS-ABEND-MESSAGE
 20868*        MOVE CP-RETURN-CODE         TO WS-ABEND-FILE-STATUS
 20869*        MOVE 2001                   TO WS-ABEND-CODE
 20870*        GO TO ABEND-PGM.
 20871
 20872     IF DTE-CLIENT = 'NCL'
 20873         MOVE CP-REMAINING-TERM-1    TO CP-REMAINING-TERM-2
 20874                                        CP-REMAINING-TERM-3.
 20875
 20876     MOVE CP-REMAINING-TERM-1        TO REM-TRM1.
 20877     MOVE CP-REMAINING-TERM-2        TO REM-TRM2.
 20878     MOVE CP-REMAINING-TERM-3        TO REM-TRM3.
 20879     MOVE CP-ODD-DAYS                TO TEM-TRM1.
 20880
 20881 8599-REM-TERM-X.
 20882     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 407
* ECS010P.cbl
 20884
 20885******************************************************************
 20886***     " D I S P L A Y "  P R I N T   R O U T I N E           ***
 20887******************************************************************
 20888
 20889 8600-DISPLAY-PRT.
 20890
 20891     IF  DIS-LINE-CNT GREATER THAN 59
 20892         PERFORM 8600-DISPLAY-HD THRU
 20893             8600-HD-EXIT.
 20894
 20895     ADD  1  TO DIS-LINE-CNT.
 20896     WRITE DISPLAY-REC FROM DISPLAY-LINE.
 20897     MOVE  SPACES TO DISPLAY-REC
 20898                     DISPLAY-LINE.
 20899
 20900 8600-DISPLAY-EXIT.
 20901     EXIT.
 20902
 20903
 20904 8600-DISPLAY-HD.
 20905
 20906     MOVE '1'  TO  DISPLAY-CC.
 20907     MOVE ZEROS TO DIS-LINE-CNT.
 20908     WRITE DISPLAY-REC FROM DISPLAY-HD-1.
 20909     ADD +1 TO DIS-LINE-CNT.
 20910     MOVE ' '  TO  DISPLAY-CC.
 20911     MOVE SPACES TO DISPLAY-REC.
 20912     WRITE DISPLAY-REC.
 20913     ADD +1 TO DIS-LINE-CNT.
 20914     MOVE WS-CURRENT-DATE  TO  DIS-DATE.
 20915     WRITE DISPLAY-REC FROM DISPLAY-HD-2.
 20916     ADD +1 TO DIS-LINE-CNT.
 20917     MOVE SPACES TO DISPLAY-REC.
 20918     ADD +1 TO DIS-LINE-CNT.
 20919     WRITE DISPLAY-REC.
 20920
 20921 8600-HD-EXIT.
 20922     EXIT.
 20923
 20924******************************************************************
 20925***      T R A N S A C T I O N   P R I N T   R O U T I N E     ***
 20926******************************************************************
 20927
 20928 8600-SETUP-DETAIL-LINE.
 20929
 20930     MOVE SPACES                TO TR-DTL2.
 20931
 20932     MOVE CR-CERT-NO            TO TRD-CERT.
 20933     MOVE CR-YR                 TO TRD-ISYR.
 20934     MOVE CR-MO                 TO TRD-ISMO.
 20935     MOVE CR-DA                 TO TRD-ISDA.
 20936     MOVE CR-AGE                TO TRD-AGE.
 20937
 20938 8689-SETUP-DETAIL-X.
 20939     EXIT.
 20940
 20941 8690-PRINT-DETAIL-LINE.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 408
* ECS010P.cbl
 20942
 20943     IF LN-CNT GREATER THAN LN-MX
 20944         PERFORM 8700-PRINT-REPORT-HEADINGS THRU
 20945                 8799-PRT-HEADINGS-X.
 20946     MOVE TRD-CERT TO SV-TRD-CERT.
 20947     MOVE TRD-ISDT TO SV-TRD-ISDT.
 20948
 20949     IF TRD-CERT = LST-TRD-CERT  AND  TRD-ISDT = LST-TRD-ISDT
 20950         MOVE SPACES TO TRD-CERT  TRD-ISDT  TRD-AGE.
 20951
 20952     MOVE SV-TRD-CERT TO LST-TRD-CERT.
 20953     MOVE SV-TRD-ISDT TO LST-TRD-ISDT.
 20954     MOVE TR-DTL TO PRT.
 20955
 20956     IF NOT WS-CHANGE-REC
 20957         MOVE '/'                TO TRD-IS-S1  TRD-IS-S2
 20958     ELSE
 20959         MOVE 'N'                TO  WS-CHANGE-REC-SW.
 20960
 20961     PERFORM 8800-PRINT-ROUTINE.
 20962
 20963 8699-PRT-DETAIL-X.
 20964     EXIT.
 20965
 20966 8700-PRINT-REPORT-HEADINGS.
 20967     ADD +1 TO PG-CNT.
 20968     MOVE PG-CNT TO TR-PG.
 20969     MOVE +0 TO LN-CNT.
 20970     MOVE TR-HD-1 TO PRT.
 20971     PERFORM 8800-PRINT-ROUTINE.
 20972     MOVE TR-HD-2 TO PRT.
 20973     PERFORM 8800-PRINT-ROUTINE.
 20974     MOVE TR-HD-3 TO PRT.
 20975     PERFORM 8800-PRINT-ROUTINE.
 20976     ADD +1 TO LN-CNT.
 20977
 20978 8725-PRT-ACCT-HEADING.
 20979     MOVE TR-HD-4 TO PRT.
 20980     PERFORM 8800-PRINT-ROUTINE.
 20981     MOVE TR-HD-5 TO PRT.
 20982     PERFORM 8800-PRINT-ROUTINE.
 20983
 20984 8750-PRT-RANGE-HEADING.
 20985     MOVE TR-HD-6 TO PRT.
 20986     PERFORM 8800-PRINT-ROUTINE.
 20987
 20988 8775-PRT-COLUMN-HEADINGS.
 20989     MOVE TR-HD-7 TO PRT.
 20990     PERFORM 8800-PRINT-ROUTINE.
 20991     MOVE TR-HD-8 TO PRT.
 20992     PERFORM 8800-PRINT-ROUTINE.
 20993     MOVE TR-HD-9 TO PRT.
 20994     PERFORM 8800-PRINT-ROUTINE.
 20995     PERFORM 8800-PRINT-ROUTINE.
 20996
 20997 8799-PRT-HEADINGS-X.
 20998     EXIT.
 20999
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 409
* ECS010P.cbl
 21000 8800-PRINT-ROUTINE.
 21001     MOVE P-CTL TO X.
 21002     PERFORM 8900-PRINT-A-LINE THRU 8999-PRT-LINE-X.
 21003     ADD +1 TO LN-CNT.
 21004     MOVE SPACES TO PRT.
 21005
 21006 8900-PRINT-A-LINE.
*21007                             COPY ELCPRT2.
 21008******************************************************************04/15/98
 21009*                                                                *ELCPRT2
 21010*                                                                *ELCPRT2
 21011*                            ELCPRT2                             *   LV005
 21012*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**5
 21013*                            VMOD=2.002                          *   CL**5
 21014*                                                                *   CL**4
 21015******************************************************************   CL**4
 21016                                                                     CL**4
 21017     IF DTE-FICH NOT = SPACE AND                                     CL**4
 21018        FICH-OPEN    = SPACE                                         CL**4
 21019         MOVE 'X'                TO  FICH-OPEN                       CL**4
 21020         OPEN OUTPUT FICH.                                           CL**4
 21021                                                                     CL**4
 21022     IF DTE-FICH NOT = SPACE                                         CL**4
 21023         MOVE X                  TO  P-CTL                           CL**4
 21024         WRITE FICH-REC FROM PRT.                                    CL**4
 21025                                                                     CL**4
 21026     IF DTE-FICH = SPACE OR '2'                                      CL**4
 21027       MOVE X                    TO  P-CTL                           CL**4
 21028       IF P-CTL = ' '                                                CL**4
 21029         WRITE PRT AFTER ADVANCING 1 LINE                            CL**4
 21030       ELSE                                                          CL**4
 21031         IF P-CTL = '0'                                              CL**4
 21032           WRITE PRT AFTER ADVANCING 2 LINES                         CL**4
 21033         ELSE                                                        CL**4
 21034           IF P-CTL = '-'                                            CL**4
 21035             WRITE PRT AFTER ADVANCING 3 LINES                       CL**4
 21036           ELSE                                                      CL**4
 21037             WRITE PRT AFTER ADVANCING PAGE.                         CL**4
 21038                                                                     CL**4
 21039******************************************************************   CL**4
 21040
 21041 8999-PRT-LINE-X.
 21042     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 410
* ECS010P.cbl
 21044******************************************************************
 21045***          E N D   O F   J O B   P R O C E S S I N G         ***
 21046******************************************************************
 21047
 21048 9910-EOJ-1.
 21049     IF TR-CNT = ZERO
 21050         IF (DTE-PGM-OPT = '2' OR '3') OR
 21051            (DTE-CLIENT = 'LGX' OR 'FNA' OR 'HER' OR 'NCL' OR
 21052                          'ITY' OR 'DAC' OR 'FLC')
 21053             NEXT SENTENCE
 21054         ELSE
 21055             MOVE 'NO INPUT TRANSACTIONS' TO WS-ABEND-MESSAGE
 21056             MOVE 0703                    TO WS-ABEND-CODE
 21057             DISPLAY '******************************'
 21058             DISPLAY '***** ERROR LOCATION 025 *****'
 21059             DISPLAY '******************************'
 21060             MOVE WS-ABEND-CODE           TO WS-RETURN-CODE
 21061             GO TO ABEND-PGM.
 21062
 21063     MOVE '*'         TO TRANS-EOF-FLAG.
 21064     MOVE HIGH-VALUES TO PENDING-MATCH-CONTROL.
 21065
 21066     IF EOF-ON-CERT
 21067         PERFORM 0400-WRITE-CERT-RECORD THRU 0499-WRITE-CERT-X
 21068         GO TO 9940-EOJ-FIN.
 21069
 21070     GO TO 0330-MATCH-PENDING-TO-CERT.
 21071
 21072 9920-EOJ-2.
 21073     MOVE '*'         TO CERT-EOF-FLAG.
 21074     MOVE HIGH-VALUES TO CIR-CONTROL.
 21075
 21076     IF EOF-ON-TRANS
 21077         PERFORM 0400-WRITE-CERT-RECORD THRU 0499-WRITE-CERT-X
 21078         MOVE HIGH-VALUES TO CERTIFICATE-RECORD
 21079         GO TO 9940-EOJ-FIN.
 21080
 21081     GO TO 0299-READ-CERT-X.
 21082
 21083 9930-EOJ-3.
 21084     IF PROCESSING-COMPLETED
 21085         GO TO 9950-EOJ-FIN-GO.
 21086
 21087     DISPLAY 'MISSING ACCOUNT MASTER - '  CR-ACCT-CONTROL.
 21088     MOVE 'MISSING ACCOUNT MASTER'
 21089                               TO WS-ABEND-MESSAGE.
 21090     MOVE 0302                 TO WS-ABEND-CODE.
 21091     DISPLAY '******************************'
 21092     DISPLAY '***** ERROR LOCATION 026 *****'
 21093     DISPLAY '******************************'
 21094     MOVE WS-ABEND-CODE        TO WS-RETURN-CODE.
 21095     GO TO ABEND-PGM.
 21096
 21097 9940-EOJ-FIN.
 21098     MOVE '*'        TO PROCESSING-FLAG.
 21099     MOVE LOW-VALUES TO CERTIFICATE-RECORD.
 21100
 21101     PERFORM 0100-ACCT-MASTER-READ-ROUTINE THRU
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 411
* ECS010P.cbl
 21102             0199-READ-ACCOUNT-X.
 21103     GO TO 9940-EOJ-FIN.
 21104
 21105 9950-EOJ-FIN-GO.
 21106     PERFORM 5500-FINAL-BREAK THRU 5599-FINAL-BREAK-X.
 21107     MOVE HIGH-VALUES TO ACCOUNT-MASTER.
 21108*
 21109*
 21110* LEAVE THE ABOVE 2 LINE IN TO PREVENT LOSING THE LINE ABOVE
 21111     PERFORM 7000-CLIENT-BILLING-ROUTINE THRU 7099-BILL-X.
 21112
 21113 9960-NO-TOTS.
 21114
 21115     MOVE +15                    TO LN-CNT.
 21116     MOVE CMIN-CNT               TO TTL-PT-CNT.
 21117     IF ME-DO-UPDATE
 21118         MOVE CMIN-CNT           TO ME-010-CERT-IN.
 21119
 21120     MOVE CMIN-CNT                TO WS-ME-BAL-AMT.
 21121     MOVE WS-BALANCE-DESCRIPTION3 TO WS-ME-BAL-DESCRIP.
 21122     WRITE ME-ECS010-BALANCE-REC  FROM WS-ME-BALANCE-REC.
 21123
 21124
 21125     MOVE 'INPUT CERTIFICATE MASTER RECORDS' TO TTL-HD-DS.
 21126     MOVE TR-TTL-HD              TO PRT.
 21127     PERFORM 8800-PRINT-ROUTINE.
 21128     ADD +1 TO LN-CNT.
 21129     MOVE TR-CNT                TO TTL-PT-CNT.
 21130     MOVE 'TRANSACTION RECORDS' TO TTL-HD-DS.
 21131     MOVE TR-TTL-HD             TO PRT.
 21132     PERFORM 8800-PRINT-ROUTINE.
 21133     ADD +1 TO LN-CNT.
 21134
 21135     IF DUP-CNT = ZERO
 21136         GO TO 9969-CHECK-MISMATCHED-TOTS.
 21137
 21138     MOVE DUP-CNT                 TO TTL-PT-CNT.
 21139
 21140     IF ME-DO-UPDATE
 21141         MOVE DUP-CNT            TO ME-010-DUP-ISS.
 21142
 21143     MOVE 'DUPE ISSUES DROPPED  ' TO TTL-HD-DS.
 21144     MOVE TR-TTL-HD               TO PRT.
 21145     PERFORM 8800-PRINT-ROUTINE.
 21146     PERFORM 8800-PRINT-ROUTINE.
 21147     ADD +1 TO LN-CNT.
 21148
 21149     MOVE '1'                           TO  DTL-REC-TYPE.
 21150     MOVE 'ISS'                         TO  DTL-REC-TYPE-DESC.
 21151     MOVE SPACES                        TO  DTL-CERT-IN-CONTROL.
 21152     MOVE 'DUPLICATE CERTIFICATE RECORD WILL BE'
 21153                                        TO  DTL-CERT-OUT-CONTROL.
 21154     MOVE SPACES                        TO  MISMATCH-DETAIL-2.
 21155     MOVE ' LIFE PREMIUM = '            TO  MD2-LF-PREM-DESC.
 21156     MOVE ' A&H  PREMIUM = '            TO  MD2-LF-ALT-PREM-DESC.
 21157
 21158     MOVE +1 TO SUB3.
 21159 9965-PRT-DUPES.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 412
* ECS010P.cbl
 21160
 21161     IF  MISMATCH-LINE-COUNT GREATER THAN +56
 21162         ADD +1                  TO  MISMATCH-PAGE-NUMBER
 21163         MOVE MISMATCH-PAGE-NUMBER
 21164                                 TO  TR-PG
 21165         MOVE MISMATCH-HEADING-1 TO  MISMATCH-RPT
 21166         MOVE MR-CTL             TO  X
 21167         MOVE X TO LCP-ASA
 21168         PERFORM LCP-WRITE-POS-MISMATCH-RPT
 21169             THRU LCP-WRITE-END-MISMATCH-RPT
 21170         MOVE TR-HD-2            TO  MISMATCH-RPT
 21171         MOVE MR-CTL             TO  X
 21172         MOVE X TO LCP-ASA
 21173         PERFORM LCP-WRITE-POS-MISMATCH-RPT
 21174             THRU LCP-WRITE-END-MISMATCH-RPT
 21175         MOVE TR-HD-3            TO  MISMATCH-RPT
 21176         MOVE MR-CTL             TO  X
 21177         MOVE X TO LCP-ASA
 21178         PERFORM LCP-WRITE-POS-MISMATCH-RPT
 21179             THRU LCP-WRITE-END-MISMATCH-RPT
 21180         MOVE MISMATCH-HEADING-2 TO  MISMATCH-RPT
 21181         MOVE MR-CTL             TO  X
 21182         MOVE X TO LCP-ASA
 21183         PERFORM LCP-WRITE-POS-MISMATCH-RPT
 21184             THRU LCP-WRITE-END-MISMATCH-RPT
 21185         MOVE +6                 TO  MISMATCH-LINE-COUNT.
 21186
 21187     MOVE DUPE-ENTRY (SUB3)             TO  DTL-MATCH-CONTROL.
 21188
 21189     MOVE MISMATCH-DETAIL               TO  MISMATCH-RPT.
 21190     MOVE MR-CTL                        TO  X.
 21191     ADD +2                             TO  MISMATCH-LINE-COUNT.
 21192
 21193     MOVE X TO LCP-ASA
 21194     PERFORM LCP-WRITE-POS-MISMATCH-RPT
 21195         THRU LCP-WRITE-END-MISMATCH-RPT.
 21196
 21197     MOVE  DUPE-LF-PRM (SUB3)           TO  MD2-LF-PREM.
 21198     MOVE  DUPE-AH-PRM (SUB3)           TO  MD2-LF-ALT-PREM.
 21199
 21200     ADD  DUPE-LF-PRM (SUB3)            TO  W-MM-LF-PRM.
 21201     ADD  DUPE-AH-PRM (SUB3)            TO  W-MM-AH-PRM.
 21202
 21203     MOVE DUPE-STATUS (SUB3)            TO  MD2-AH-PREM-DESC.
 21204     IF  DUPE-STATUS (SUB3)  =  '2'
 21205         MOVE  'POLICY IS PENDING '     TO  MD2-AH-PREM-DESC.
 21206     IF  DUPE-STATUS (SUB3)  =  '5'
 21207         MOVE  'POLICY IS REISSUE '     TO  MD2-AH-PREM-DESC.
 21208     IF  DUPE-STATUS (SUB3)  =  'M'
 21209         MOVE  'POLICY IS MONTHLY '     TO  MD2-AH-PREM-DESC.
 21210     IF  DUPE-STATUS (SUB3)  =  '9'
 21211         MOVE  'POLICY REIN ONLY  '     TO  MD2-AH-PREM-DESC.
 21212     IF  DUPE-STATUS (SUB3)  =  'D'
 21213         MOVE  'POLICY IS DECLINED'     TO  MD2-AH-PREM-DESC.
 21214     IF  DUPE-STATUS (SUB3)  =  'V'
 21215         MOVE  'POLICY IS VOIDED  '     TO  MD2-AH-PREM-DESC.
 21216     IF  DUPE-STATUS (SUB3)  =  'P'
 21217         MOVE  'POLICY PREM ACCTNG'     TO  MD2-AH-PREM-DESC.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 413
* ECS010P.cbl
 21218
 21219     MOVE MISMATCH-DETAIL-2             TO  MISMATCH-RPT.
 21220     MOVE MR-CTL                        TO  X.
 21221     ADD +1                             TO  MISMATCH-LINE-COUNT.
 21222
 21223     MOVE X TO LCP-ASA
 21224     PERFORM LCP-WRITE-POS-MISMATCH-RPT
 21225         THRU LCP-WRITE-END-MISMATCH-RPT.
 21226
 21227     IF SUB3 LESS THAN DUP-CNT
 21228         ADD +1 TO SUB3
 21229         GO TO 9965-PRT-DUPES.
 21230
 21231 9969-CHECK-MISMATCHED-TOTS.
 21232
 21233     IF W-MM-LF-PRM = ZEROS  AND
 21234        W-MM-AH-PRM = ZEROS  AND
 21235        W-MM-LF-RFD = ZEROS  AND
 21236        W-MM-AH-RFD = ZEROS  AND
 21237        W-MM-LF-CLM = ZEROS  AND
 21238        W-MM-AH-CLM = ZEROS
 21239         GO TO 9970-FIN-TOTS.
 21240
 21241     MOVE SPACES                        TO  MISMATCH-RPT.
 21242     MOVE '0'                           TO  MR-CTL  X.
 21243     MOVE X TO LCP-ASA
 21244     PERFORM LCP-WRITE-POS-MISMATCH-RPT
 21245         THRU LCP-WRITE-END-MISMATCH-RPT.
 21246
 21247     MOVE 'TOT LF PREMS  = '            TO  MD2-LF-PREM-DESC.
 21248     MOVE 'TOT AH PREMS  = '            TO  MD2-LF-ALT-PREM-DESC.
 21249     MOVE ' TOTAL PREMIUMS = '          TO  MD2-AH-PREM-DESC.
 21250
 21251     MOVE W-MM-LF-PRM                   TO MD2-LF-PREM.
 21252     MOVE W-MM-AH-PRM                   TO MD2-LF-ALT-PREM.
 21253     COMPUTE MD2-AH-PREM = W-MM-LF-PRM + W-MM-AH-PRM.
 21254
 21255     MOVE MISMATCH-DETAIL-2             TO  MISMATCH-RPT.
 21256     MOVE '0'                           TO  MR-CTL  X.
 21257     MOVE X TO LCP-ASA
 21258     PERFORM LCP-WRITE-POS-MISMATCH-RPT
 21259         THRU LCP-WRITE-END-MISMATCH-RPT.
 21260
 21261     MOVE 'TOT LF RFNDS  = '            TO  MD2-LF-PREM-DESC.
 21262     MOVE 'TOT AH RFNDS  = '            TO  MD2-LF-ALT-PREM-DESC.
 21263     MOVE ' TOTAL REFUNDS  = '          TO  MD2-AH-PREM-DESC.
 21264
 21265     MOVE W-MM-LF-RFD                   TO MD2-LF-PREM.
 21266     MOVE W-MM-AH-RFD                   TO MD2-LF-ALT-PREM.
 21267     COMPUTE MD2-AH-PREM = W-MM-LF-RFD + W-MM-AH-RFD.
 21268
 21269     MOVE MISMATCH-DETAIL-2             TO  MISMATCH-RPT.
 21270     MOVE '0'                           TO  MR-CTL  X.
 21271     MOVE X TO LCP-ASA
 21272     PERFORM LCP-WRITE-POS-MISMATCH-RPT
 21273         THRU LCP-WRITE-END-MISMATCH-RPT.
 21274
 21275     MOVE 'TOT LF CLAIMS = '            TO  MD2-LF-PREM-DESC.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 414
* ECS010P.cbl
 21276     MOVE 'TOT AH CLAIMS = '            TO  MD2-LF-ALT-PREM-DESC.
 21277     MOVE ' TOTAL CLAIMS   = '          TO  MD2-AH-PREM-DESC.
 21278
 21279     MOVE W-MM-LF-CLM                   TO MD2-LF-PREM.
 21280     MOVE W-MM-AH-CLM                   TO MD2-LF-ALT-PREM.
 21281     COMPUTE MD2-AH-PREM = W-MM-LF-CLM + W-MM-AH-CLM.
 21282
 21283     MOVE MISMATCH-DETAIL-2             TO  MISMATCH-RPT.
 21284     MOVE '0'                           TO  MR-CTL  X.
 21285     MOVE X TO LCP-ASA
 21286     PERFORM LCP-WRITE-POS-MISMATCH-RPT
 21287         THRU LCP-WRITE-END-MISMATCH-RPT.
 21288
 21289 9970-FIN-TOTS.
 21290
 21291     MOVE CMOT-CNT                TO TTL-PT-CNT.
 21292
 21293     IF ME-DO-UPDATE
 21294         MOVE CMOT-CNT           TO ME-010-CERT-OUT.
 21295
 21296     MOVE 'OUTPUT CERTIFICATE MASTER RECORDS' TO TTL-HD-DS.
 21297     MOVE TR-TTL-HD               TO PRT.
 21298     PERFORM 8800-PRINT-ROUTINE.
 21299
 21300     MOVE CMOT-CNT                TO WS-ME50-BAL-AMT-LOW.
 21301     MOVE CMOT-CNT                TO WS-ME50-BAL-AMT-HIGH.
 21302     MOVE WS-BAL50-DESCRIPTION    TO WS-ME50-BAL-DESCRIP.
 21303     WRITE ME50-ECS010-BALANCE-REC FROM WS-ME50-BALANCE-REC.
 21304
 21305     MOVE DE-CNT                  TO TTL-PT-CNT.
 21306     MOVE 'DETAIL EXTRACT RECORDS' TO TTL-HD-DS.
 21307     MOVE TR-TTL-HD               TO PRT.
 21308     PERFORM 8800-PRINT-ROUTINE.
 21309
 21310     MOVE EP-CNT                  TO TTL-PT-CNT.
 21311     MOVE 'SUMMARY EXTRACTS RECORDS' TO TTL-HD-DS.
 21312     MOVE TR-TTL-HD               TO PRT.
 21313     PERFORM 8800-PRINT-ROUTINE.
 21314     PERFORM 8800-PRINT-ROUTINE.
 21315
 21316     MOVE ERACCTT-READS           TO TTL-PT-CNT.
 21317     MOVE 'VSAM ACCOUNT MASTER FILE READS' TO TTL-HD-DS.
 21318     MOVE TR-TTL-HD               TO PRT.
 21319     PERFORM 8800-PRINT-ROUTINE.
 21320
 21321     MOVE ERRTBL-READS            TO TTL-PT-CNT.
 21322     MOVE 'VSAM REINSURANCE TABLE FILE READS' TO TTL-HD-DS.
 21323     MOVE TR-TTL-HD               TO PRT.
 21324     PERFORM 8800-PRINT-ROUTINE.
 21325
 21326     MOVE ERCTBL-READS            TO TTL-PT-CNT.
 21327     MOVE 'VSAM COMMISSION TABLE FILE READS' TO TTL-HD-DS.
 21328     MOVE TR-TTL-HD               TO PRT.
 21329     PERFORM 8800-PRINT-ROUTINE.
 21330
 21331     IF  DTE-OPT-RESERVE-METHOD-UNAUTH
 21332         GO TO 9990-FINAL-CLOSE.
 21333
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 415
* ECS010P.cbl
 21334**** MOST OF THE LINES WRITTEN BELOW ARE USED TO VERIFY
 21335**** REPORT TOTALS, ETC, THAT CANNOT BE VERIFIED ANY OTHER
 21336**** WAY.  MOST OF THESE FIELDS WILL BE DELETED WHEN ALL
 21337**** PILOT COMPANIES HAVE BEEN SUCCESSFULLY PROCESSED.
 21338
 21339     MOVE W-POLICY-ACTIVE-CTR     TO TTL-PT-CNT.
 21340     MOVE 'ACTIVE POLICIES'       TO TTL-HD-DS.
 21341     MOVE TR-TTL-HD               TO PRT.
 21342     PERFORM 8800-PRINT-ROUTINE.
 21343
 21344     MOVE W-POLICY-INACTIVE-CTR   TO TTL-PT-CNT.
 21345     MOVE 'INACTIVE POLICIES'     TO TTL-HD-DS.
 21346     MOVE TR-TTL-HD               TO PRT.
 21347     PERFORM 8800-PRINT-ROUTINE.
 21348
 21349     MOVE W-POLICY-REISSUE-CTR    TO TTL-PT-CNT.
 21350     MOVE 'REISSUE POLICIES'      TO TTL-HD-DS.
 21351     MOVE TR-TTL-HD               TO PRT.
 21352     PERFORM 8800-PRINT-ROUTINE.
 21353
 21354     MOVE W-POLICY-REIN-CTR       TO TTL-PT-CNT.
 21355     MOVE 'REINSURANCE ONLY POLICIES' TO TTL-HD-DS.
 21356     MOVE TR-TTL-HD               TO PRT.
 21357     PERFORM 8800-PRINT-ROUTINE.
 21358
 21359     MOVE W-POL-ISSUES            TO TTL-PT-CNT.
 21360     MOVE 'ISSUE TRANSACTIONS'    TO TTL-HD-DS.
 21361     MOVE TR-TTL-HD               TO PRT.
 21362     PERFORM 8800-PRINT-ROUTINE.
 21363
 21364     MOVE W-AH-ISSUES             TO TTL-PT-CNT.
 21365     MOVE 'AH ISSUE TRANSACTIONS' TO TTL-HD-DS.
 21366     MOVE TR-TTL-HD               TO PRT.
 21367     PERFORM 8800-PRINT-ROUTINE.
 21368
 21369     MOVE W-LF-ISSUES             TO TTL-PT-CNT.
 21370     MOVE 'LF ISSUE TRANSACTIONS' TO TTL-HD-DS.
 21371     MOVE TR-TTL-HD               TO PRT.
 21372     PERFORM 8800-PRINT-ROUTINE.
 21373
 21374     MOVE W-PENDING-CLMS          TO TTL-PT-CNT.
 21375     MOVE 'CLAIM TRANSACTIONS'    TO TTL-HD-DS.
 21376     MOVE TR-TTL-HD               TO PRT.
 21377     PERFORM 8800-PRINT-ROUTINE.
 21378
 21379     MOVE W-AH-CLAIMS             TO TTL-PT-CNT.
 21380     MOVE 'AH CLAIMS TRANSACTIONS' TO TTL-HD-DS.
 21381     MOVE TR-TTL-HD               TO PRT.
 21382     PERFORM 8800-PRINT-ROUTINE.
 21383
 21384     MOVE W-LF-CLAIMS             TO TTL-PT-CNT.
 21385     MOVE 'LF CLAIMS TRANSACTIONS' TO TTL-HD-DS.
 21386     MOVE TR-TTL-HD               TO PRT.
 21387     PERFORM 8800-PRINT-ROUTINE.
 21388
 21389     MOVE W-AH-RESERVES           TO TTL-PT-CNT.
 21390     MOVE 'AH RESERVES TRANSACTIONS' TO TTL-HD-DS.
 21391     MOVE TR-TTL-HD               TO PRT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 416
* ECS010P.cbl
 21392     PERFORM 8800-PRINT-ROUTINE.
 21393
 21394     MOVE W-LF-RESERVES           TO TTL-PT-CNT.
 21395     MOVE 'LF RESERVES TRANSACTIONS' TO TTL-HD-DS.
 21396     MOVE TR-TTL-HD               TO PRT.
 21397     PERFORM 8800-PRINT-ROUTINE.
 21398
 21399     MOVE W-AH-ACTIVE             TO TTL-PT-CNT.
 21400     MOVE 'AH RECORDS ACTIVE '    TO TTL-HD-DS.
 21401     MOVE TR-TTL-HD               TO PRT.
 21402     PERFORM 8800-PRINT-ROUTINE.
 21403
 21404     MOVE W-AH-INACTIVE           TO TTL-PT-CNT.
 21405     MOVE 'AH RECORDS INACTIVE'   TO TTL-HD-DS.
 21406     MOVE TR-TTL-HD               TO PRT.
 21407     PERFORM 8800-PRINT-ROUTINE.
 21408
 21409     MOVE W-AH-REISSUE            TO TTL-PT-CNT.
 21410     MOVE 'AH REISSUE REJECTS'    TO TTL-HD-DS.
 21411     MOVE TR-TTL-HD               TO PRT.
 21412     PERFORM 8800-PRINT-ROUTINE.
 21413
 21414     MOVE W-AH-REIN               TO TTL-PT-CNT.
 21415     MOVE 'AH REIN ONLY      '    TO TTL-HD-DS.
 21416     MOVE TR-TTL-HD               TO PRT.
 21417     PERFORM 8800-PRINT-ROUTINE.
 21418
 21419     MOVE W-AH-CALC-B             TO TTL-PT-CNT.
 21420     MOVE 'AH CALC B REJECTS'     TO TTL-HD-DS.
 21421     MOVE TR-TTL-HD               TO PRT.
 21422     PERFORM 8800-PRINT-ROUTINE.
 21423
 21424     MOVE W-AHTYP-99              TO TTL-PT-CNT.
 21425     MOVE 'AH TYPE CHANGED TO 99' TO TTL-HD-DS.
 21426     MOVE TR-TTL-HD               TO PRT.
 21427     PERFORM 8800-PRINT-ROUTINE.
 21428
 21429     MOVE W-ORGTRM-0-AH           TO TTL-PT-CNT.
 21430     MOVE 'AH ORIGINAL TERM = 0 ' TO TTL-HD-DS.
 21431     MOVE TR-TTL-HD               TO PRT.
 21432     PERFORM 8800-PRINT-ROUTINE.
 21433
 21434     MOVE W-RET-CODE-AH           TO TTL-PT-CNT.
 21435     MOVE 'AH RET CODE TERM = 0 ' TO TTL-HD-DS.
 21436     MOVE TR-TTL-HD               TO PRT.
 21437     PERFORM 8800-PRINT-ROUTINE.
 21438
 21439     MOVE W-AH-REMTERM-0          TO TTL-PT-CNT.
 21440     MOVE 'AH REMAINING TERM = 0' TO TTL-HD-DS.
 21441     MOVE TR-TTL-HD               TO PRT.
 21442     PERFORM 8800-PRINT-ROUTINE.
 21443
 21444     MOVE W-AH-DATA-USED          TO TTL-PT-CNT.
 21445     MOVE 'AH RECORDS ACCEPTED DURING PROCESSING' TO TTL-HD-DS.
 21446     MOVE TR-TTL-HD               TO PRT.
 21447     PERFORM 8800-PRINT-ROUTINE.
 21448
 21449     MOVE W-LF-ACTIVE             TO TTL-PT-CNT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 417
* ECS010P.cbl
 21450     MOVE 'LF RECORDS ACTIVE '    TO TTL-HD-DS.
 21451     MOVE TR-TTL-HD               TO PRT.
 21452     PERFORM 8800-PRINT-ROUTINE.
 21453
 21454     MOVE W-LF-INACTIVE           TO TTL-PT-CNT.
 21455     MOVE 'LF RECORDS INACTIVE'   TO TTL-HD-DS.
 21456     MOVE TR-TTL-HD               TO PRT.
 21457     PERFORM 8800-PRINT-ROUTINE.
 21458
 21459     MOVE W-LF-BALLOON            TO TTL-PT-CNT.
 21460     MOVE 'LF BALLOON REJECTS'    TO TTL-HD-DS.
 21461     MOVE TR-TTL-HD               TO PRT.
 21462     PERFORM 8800-PRINT-ROUTINE.
 21463
 21464     MOVE W-LF-REISSUE            TO TTL-PT-CNT.
 21465     MOVE 'LF REISSUE REJECTS'    TO TTL-HD-DS.
 21466     MOVE TR-TTL-HD               TO PRT.
 21467     PERFORM 8800-PRINT-ROUTINE.
 21468
 21469     MOVE W-LF-REIN               TO TTL-PT-CNT.
 21470     MOVE 'LF REIN ONLY      '    TO TTL-HD-DS.
 21471     MOVE TR-TTL-HD               TO PRT.
 21472     PERFORM 8800-PRINT-ROUTINE.
 21473
 21474     MOVE W-LF-CALC-B             TO TTL-PT-CNT.
 21475     MOVE 'LF CALC B REJECTS'     TO TTL-HD-DS.
 21476     MOVE TR-TTL-HD               TO PRT.
 21477     PERFORM 8800-PRINT-ROUTINE.
 21478
 21479     MOVE W-ORGTRM-0-LF           TO TTL-PT-CNT.
 21480     MOVE 'LF ORIGINAL TERM = 0 ' TO TTL-HD-DS.
 21481     MOVE TR-TTL-HD               TO PRT.
 21482     PERFORM 8800-PRINT-ROUTINE.
 21483
 21484     MOVE W-RET-CODE-LF           TO TTL-PT-CNT.
 21485     MOVE 'LF RET CODE TERM = 0 ' TO TTL-HD-DS.
 21486     MOVE TR-TTL-HD               TO PRT.
 21487     PERFORM 8800-PRINT-ROUTINE.
 21488
 21489     MOVE W-LF-REMTERM-0          TO TTL-PT-CNT.
 21490     MOVE 'LF REMTERM = 0 REJECTS' TO TTL-HD-DS.
 21491     MOVE TR-TTL-HD               TO PRT.
 21492     PERFORM 8800-PRINT-ROUTINE.
 21493
 21494     MOVE W-LF-REMAMT-0           TO TTL-PT-CNT.
 21495     MOVE 'LF REMAMT = 0 REJECTS' TO TTL-HD-DS.
 21496     MOVE TR-TTL-HD               TO PRT.
 21497     PERFORM 8800-PRINT-ROUTINE.
 21498
 21499     MOVE W-LFTYP-99              TO TTL-PT-CNT.
 21500     MOVE 'LF TYPE CHANGED TO 99' TO TTL-HD-DS.
 21501     MOVE TR-TTL-HD               TO PRT.
 21502     PERFORM 8800-PRINT-ROUTINE.
 21503
 21504     MOVE W-LF-DATA-USED          TO TTL-PT-CNT.
 21505     MOVE 'LF RECORDS ACCEPTED DURING PROCESSING' TO TTL-HD-DS.
 21506     MOVE TR-TTL-HD               TO PRT.
 21507     PERFORM 8800-PRINT-ROUTINE.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 418
* ECS010P.cbl
 21508
 21509     MOVE W-EPEC-EP-IN            TO TTL-PT-CNT.
 21510     MOVE 'AH EARNED PREMIUM LAST 90 DAYS - DET ' TO TTL-HD-DS.
 21511     MOVE TR-TTL-HD               TO PRT.
 21512     PERFORM 8800-PRINT-ROUTINE.
 21513
 21514     MOVE W-EPEC-EP               TO TTL-PT-CNT.
 21515     MOVE 'AH EARNED PREMIUM LAST 90 DAYS       ' TO TTL-HD-DS.
 21516     MOVE TR-TTL-HD               TO PRT.
 21517     PERFORM 8800-PRINT-ROUTINE.
 21518
 21519     MOVE W-EPEC-EP-2             TO TTL-PT-CNT.
 21520     MOVE 'AH EARNED PREMIUM 90 DAYS AGO        ' TO TTL-HD-DS.
 21521     MOVE TR-TTL-HD               TO PRT.
 21522     PERFORM 8800-PRINT-ROUTINE.
 21523
 21524     MOVE W-EP-LESS-THAN-0        TO TTL-PT-CNT.
 21525     MOVE 'AH RECORDS WITH 90 DAY EP < +0       ' TO TTL-HD-DS.
 21526     MOVE TR-TTL-HD               TO PRT.
 21527     PERFORM 8800-PRINT-ROUTINE.
 21528
 21529     MOVE W-EPEC-EP-1             TO TTL-PT-CNT.
 21530     MOVE 'AH EARNED PREMIUM TODAY              ' TO TTL-HD-DS.
 21531     MOVE TR-TTL-HD               TO PRT.
 21532     PERFORM 8800-PRINT-ROUTINE.
 21533
 21534     MOVE W-AH-CLAIM-CTR          TO TTL-PT-CNT.
 21535     MOVE 'AH COVERAGES WITH QUALIFIED CLAIMS'
 21536                                  TO TTL-HD-DS.
 21537     MOVE TR-TTL-HD               TO PRT.
 21538     PERFORM 8800-PRINT-ROUTINE.
 21539
 21540     MOVE W-AH-CLAIM-EP           TO TTL-PT-CNT.
 21541     MOVE 'AH EARNED PREM WITH QUALIFIED CLAIMS'
 21542                                  TO TTL-HD-DS.
 21543     MOVE TR-TTL-HD               TO PRT.
 21544     PERFORM 8800-PRINT-ROUTINE.
 21545
 21546     MOVE W-CLAIMS-MADE-PAID-IN   TO TTL-PT-CNT.
 21547     MOVE 'AH CLAIMS MADE AND PAID LAST 90 DAYS- DET'
 21548                                  TO TTL-HD-DS.
 21549     MOVE TR-TTL-HD               TO PRT.
 21550     PERFORM 8800-PRINT-ROUTINE.
 21551
 21552     MOVE W-CLAIMS-MADE-PAID      TO TTL-PT-CNT.
 21553     MOVE 'AH CLAIMS MADE AND PAID LAST 90 DAYS'
 21554                                  TO TTL-HD-DS.
 21555     MOVE TR-TTL-HD               TO PRT.
 21556     PERFORM 8800-PRINT-ROUTINE.
 21557
 21558     MOVE W-CLM-EXCEPT-CNT        TO TTL-PT-CNT.
 21559     MOVE 'AH CLAIMS CALCD. USING ITD AMOUNT'
 21560                                  TO TTL-HD-DS.
 21561     MOVE TR-TTL-HD               TO PRT.
 21562     PERFORM 8800-PRINT-ROUTINE.
 21563
 21564     MOVE W-CLM-EXCEPT-AMT        TO TTL-PT-CNT.
 21565     MOVE 'AH CLAIMS AMT USING ITD AMOUNT'
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 419
* ECS010P.cbl
 21566                                  TO TTL-HD-DS.
 21567     MOVE TR-TTL-HD               TO PRT.
 21568     PERFORM 8800-PRINT-ROUTINE.
 21569
 21570     MOVE W-AH-IBNR-1             TO TTL-PT-CNT.
 21571     MOVE 'A&H IBNR-1'            TO TTL-HD-DS.
 21572     MOVE TR-TTL-HD               TO PRT.
 21573     PERFORM 8800-PRINT-ROUTINE.
 21574
 21575     MOVE W-AH-IBNR-2             TO TTL-PT-CNT.
 21576     MOVE 'A&H IBNR-2'            TO TTL-HD-DS.
 21577     MOVE TR-TTL-HD               TO PRT.
 21578     PERFORM 8800-PRINT-ROUTINE.
 21579
 21580     MOVE W-LIFE-IBNR-IN          TO TTL-PT-CNT.
 21581     MOVE 'LIFE IBNR - DETAIL'    TO TTL-HD-DS.
 21582     MOVE TR-TTL-HD               TO PRT.
 21583     PERFORM 8800-PRINT-ROUTINE.
 21584
 21585     MOVE W-LIFE-IBNR             TO TTL-PT-CNT.
 21586     MOVE 'LIFE IBNR'             TO TTL-HD-DS.
 21587     MOVE TR-TTL-HD               TO PRT.
 21588     PERFORM 8800-PRINT-ROUTINE.
 21589
 21590     MOVE W-LIFE-REMAINING-AMT    TO TTL-PT-CNT.
 21591     MOVE 'LIFE REMAINING-AMT '   TO TTL-HD-DS.
 21592     MOVE TR-TTL-HD               TO PRT.
 21593     PERFORM 8800-PRINT-ROUTINE.
 21594
 21595     MOVE W-01-REMAMT             TO TTL-PT-CNT.
 21596     MOVE '01 REMAINING-AMT '     TO TTL-HD-DS.
 21597     MOVE TR-TTL-HD               TO PRT.
 21598     PERFORM 8800-PRINT-ROUTINE.
 21599
 21600     MOVE W-01-DATA-USED          TO TTL-PT-CNT.
 21601     MOVE '01 CERT COUNT    '     TO TTL-HD-DS.
 21602     MOVE TR-TTL-HD               TO PRT.
 21603     PERFORM 8800-PRINT-ROUTINE.
 21604
 21605     MOVE W-02-REMAMT             TO TTL-PT-CNT.
 21606     MOVE '02 REMAINING-AMT '     TO TTL-HD-DS.
 21607     MOVE TR-TTL-HD               TO PRT.
 21608     PERFORM 8800-PRINT-ROUTINE.
 21609
 21610     MOVE W-02-DATA-USED          TO TTL-PT-CNT.
 21611     MOVE '02 CERT COUNT    '     TO TTL-HD-DS.
 21612     MOVE TR-TTL-HD               TO PRT.
 21613     PERFORM 8800-PRINT-ROUTINE.
 21614
 21615     MOVE W-03-REMAMT             TO TTL-PT-CNT.
 21616     MOVE '03 REMAINING-AMT '     TO TTL-HD-DS.
 21617     MOVE TR-TTL-HD               TO PRT.
 21618     PERFORM 8800-PRINT-ROUTINE.
 21619
 21620     MOVE W-03-DATA-USED          TO TTL-PT-CNT.
 21621     MOVE '03 CERT COUNT    '     TO TTL-HD-DS.
 21622     MOVE TR-TTL-HD               TO PRT.
 21623     PERFORM 8800-PRINT-ROUTINE.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 420
* ECS010P.cbl
 21624
 21625     MOVE W-04-REMAMT             TO TTL-PT-CNT.
 21626     MOVE '04 REMAINING-AMT '     TO TTL-HD-DS.
 21627     MOVE TR-TTL-HD               TO PRT.
 21628     PERFORM 8800-PRINT-ROUTINE.
 21629
 21630     MOVE W-04-DATA-USED          TO TTL-PT-CNT.
 21631     MOVE '04 CERT COUNT    '     TO TTL-HD-DS.
 21632     MOVE TR-TTL-HD               TO PRT.
 21633     PERFORM 8800-PRINT-ROUTINE.
 21634
 21635     MOVE W-05-REMAMT             TO TTL-PT-CNT.
 21636     MOVE '05 REMAINING-AMT '     TO TTL-HD-DS.
 21637     MOVE TR-TTL-HD               TO PRT.
 21638     PERFORM 8800-PRINT-ROUTINE.
 21639
 21640     MOVE W-05-DATA-USED          TO TTL-PT-CNT.
 21641     MOVE '05 CERT COUNT    '     TO TTL-HD-DS.
 21642     MOVE TR-TTL-HD               TO PRT.
 21643     PERFORM 8800-PRINT-ROUTINE.
 21644
 21645     MOVE W-06-REMAMT             TO TTL-PT-CNT.
 21646     MOVE '06 REMAINING-AMT '     TO TTL-HD-DS.
 21647     MOVE TR-TTL-HD               TO PRT.
 21648     PERFORM 8800-PRINT-ROUTINE.
 21649
 21650     MOVE W-06-DATA-USED          TO TTL-PT-CNT.
 21651     MOVE '06 CERT COUNT    '     TO TTL-HD-DS.
 21652     MOVE TR-TTL-HD               TO PRT.
 21653     PERFORM 8800-PRINT-ROUTINE.
 21654
 21655     MOVE W-30-REMAMT             TO TTL-PT-CNT.
 21656     MOVE '30 REMAINING-AMT '     TO TTL-HD-DS.
 21657     MOVE TR-TTL-HD               TO PRT.
 21658     PERFORM 8800-PRINT-ROUTINE.
 21659
 21660     MOVE W-30-DATA-USED          TO TTL-PT-CNT.
 21661     MOVE '30 CERT COUNT    '     TO TTL-HD-DS.
 21662     MOVE TR-TTL-HD               TO PRT.
 21663     PERFORM 8800-PRINT-ROUTINE.
 21664
 21665     MOVE W-31-REMAMT             TO TTL-PT-CNT.
 21666     MOVE '31 REMAINING-AMT '     TO TTL-HD-DS.
 21667     MOVE TR-TTL-HD               TO PRT.
 21668     PERFORM 8800-PRINT-ROUTINE.
 21669
 21670     MOVE W-31-DATA-USED          TO TTL-PT-CNT.
 21671     MOVE '31 CERT COUNT    '     TO TTL-HD-DS.
 21672     MOVE TR-TTL-HD               TO PRT.
 21673     PERFORM 8800-PRINT-ROUTINE.
 21674
 21675     MOVE W-XX-REMAMT             TO TTL-PT-CNT.
 21676     MOVE 'XX REMAINING-AMT '     TO TTL-HD-DS.
 21677     MOVE TR-TTL-HD               TO PRT.
 21678     PERFORM 8800-PRINT-ROUTINE.
 21679
 21680     MOVE W-XX-DATA-USED          TO TTL-PT-CNT.
 21681     MOVE 'XX CERT COUNT    '     TO TTL-HD-DS.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 421
* ECS010P.cbl
 21682     MOVE TR-TTL-HD               TO PRT.
 21683     PERFORM 8800-PRINT-ROUTINE.
 21684
 21685     MOVE W-1-EP                  TO TTL-PT-CNT.
 21686     MOVE 'TYPE 1 EP        '     TO TTL-HD-DS.
 21687     MOVE TR-TTL-HD               TO PRT.
 21688     PERFORM 8800-PRINT-ROUTINE.
 21689
 21690     MOVE W-P-EP                  TO TTL-PT-CNT.
 21691     MOVE 'TYPE P EP        '     TO TTL-HD-DS.
 21692     MOVE TR-TTL-HD               TO PRT.
 21693     PERFORM 8800-PRINT-ROUTINE.
 21694
 21695     MOVE W-M-EP                  TO TTL-PT-CNT.
 21696     MOVE 'TYPE M EP        '     TO TTL-HD-DS.
 21697     MOVE TR-TTL-HD               TO PRT.
 21698     PERFORM 8800-PRINT-ROUTINE.
 21699
 21700     MOVE W-R-EP                  TO TTL-PT-CNT.
 21701     MOVE 'TYPE R EP        '     TO TTL-HD-DS.
 21702     MOVE TR-TTL-HD               TO PRT.
 21703     PERFORM 8800-PRINT-ROUTINE.
 21704
 21705     MOVE W-WY-EP                 TO TTL-PT-CNT.
 21706     MOVE 'EP FOR STATE WY  '     TO TTL-HD-DS.
 21707     MOVE TR-TTL-HD               TO PRT.
 21708     PERFORM 8800-PRINT-ROUTINE.
 21709
 21710     MOVE W-VA-EP                 TO TTL-PT-CNT.
 21711     MOVE 'EP FOR STATE VA  '     TO TTL-HD-DS.
 21712     MOVE TR-TTL-HD               TO PRT.
 21713     PERFORM 8800-PRINT-ROUTINE.
 21714
 21715     MOVE W-OTHERS-COUNT          TO TTL-PT-CNT.
 21716     MOVE 'AH COUNT OF OTHERS'    TO TTL-HD-DS.
 21717     MOVE TR-TTL-HD               TO PRT.
 21718     PERFORM 8800-PRINT-ROUTINE.
 21719
 21720     MOVE W-RTRM-0-CLMAMT         TO TTL-PT-CNT.
 21721     MOVE 'CLM AMT OF THOSE CERTS WITH RTRM=0'    TO TTL-HD-DS.
 21722     MOVE TR-TTL-HD               TO PRT.
 21723     PERFORM 8800-PRINT-ROUTINE.
 21724
 21725     MOVE W-RTRM-EP-1             TO TTL-PT-CNT.
 21726     MOVE 'EP1 OF THOSE CERTS WITH RTRM=0'    TO TTL-HD-DS.
 21727     MOVE TR-TTL-HD               TO PRT.
 21728     PERFORM 8800-PRINT-ROUTINE.
 21729
 21730     MOVE W-RTRM-EP-2             TO TTL-PT-CNT.
 21731     MOVE 'EP2 OF THOSE CERTS WITH RTRM=0'    TO TTL-HD-DS.
 21732     MOVE TR-TTL-HD               TO PRT.
 21733     PERFORM 8800-PRINT-ROUTINE.
 21734
 21735     MOVE W-RTRM-EP               TO TTL-PT-CNT.
 21736     MOVE 'EP OF THOSE CERTS WITH RTRM=0'    TO TTL-HD-DS.
 21737     MOVE TR-TTL-HD               TO PRT.
 21738     PERFORM 8800-PRINT-ROUTINE.
 21739
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 422
* ECS010P.cbl
 21740     MOVE W-AH-IBNR-1             TO TTL-PT-CNT.
 21741     MOVE 'IBNR1 FROM EQUATION 1' TO TTL-HD-DS.
 21742     MOVE TR-TTL-HD               TO PRT.
 21743     PERFORM 8800-PRINT-ROUTINE.
 21744
 21745     MOVE W-AH-IBNR-1-CNT         TO TTL-PT-CNT.
 21746     MOVE 'REC CNT FROM EQUATION 1' TO TTL-HD-DS.
 21747     MOVE TR-TTL-HD               TO PRT.
 21748     PERFORM 8800-PRINT-ROUTINE.
 21749
 21750     MOVE W-AH-IBNR-2             TO TTL-PT-CNT.
 21751     MOVE 'IBNR2 FROM EQUATION 2' TO TTL-HD-DS.
 21752     MOVE TR-TTL-HD               TO PRT.
 21753     PERFORM 8800-PRINT-ROUTINE.
 21754
 21755     MOVE W-AH-IBNR-2-CNT         TO TTL-PT-CNT.
 21756     MOVE 'REC CNT FROM EQUATION 2' TO TTL-HD-DS.
 21757     MOVE TR-TTL-HD               TO PRT.
 21758     PERFORM 8800-PRINT-ROUTINE.
 21759
 21760 9990-FINAL-CLOSE.
*21761                             COPY ELCPRTC.
 21762******************************************************************04/15/98
 21763*                                                                *ELCPRTC
 21764*                                                                *ELCPRTC
 21765*                            ELCPRTC.                            *   LV003
 21766*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
 21767*                            VMOD=2.002                          *   CL**2
 21768*       CLOSE FICH FILE IF OPEN                                  *ELCPRTC
 21769*                                                                *ELCPRTC
 21770* NOTE- USE ELCPRTCX IF USING ELCPRT2X (ONLINE REPORT SAVE)      *   CL**2
 21771******************************************************************ELCPRTC
 21772                                                                  ELCPRTC
 21773      IF FICH-OPEN NOT = SPACE                                    ELCPRTC
 21774          CLOSE FICH.                                             ELCPRTC
 21775                                                                  ELCPRTC
 21776******************************************************************ELCPRTC
 21777
 21778     IF DTE-CLIENT = 'DMD'
 21779         CLOSE ERRESC-IN.
 21780
 21781     PERFORM 8600-DISPLAY-HD   THRU  8600-HD-EXIT.
 21782
 21783     DISPLAY ' '.
 21784     DISPLAY '* * * * * * * * * * * * * * * * * *'.
 21785     DISPLAY ' DISPLAY ERROR COUNT = '  ERROR-COUNT.
 21786     DISPLAY '* * * * * * * * * * * * * * * * * *'.
 21787     DISPLAY ' '.
 21788
 21789     MOVE    ' DISPLAY ERROR COUNT = '
 21790       TO  DIS-LINE-REASON.
 21791     MOVE  ERROR-COUNT
 21792       TO  DIS-LINE-REC.
 21793         PERFORM 8600-DISPLAY-PRT  THRU  8600-DISPLAY-EXIT.
 21794
 21795     CLOSE ERACCTT-IN  CERT-MASTER-IN  PRINT-COPY  MISMATCH-REPORT
 21796           DISPLAY-PRT
 21797           ME-ECS010-BALANCE
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 423
* ECS010P.cbl
 21798           ME50-ECS010-BALANCE
 21799           PENDING-EXTRACT  SUMMARY-EXTR.
 21800
 21801     IF DTE-PGM-OPT = '1'
 21802         CLOSE CERT-MASTER-OUT
 21803               DETAIL-EXTR.
 21804
 21805     IF ERACCTT-FILE-STATUS NOT = '00'
 21806         MOVE '12'                TO ABEND-CODE-1
 21807         MOVE ERACCTT-FILE-STATUS TO ABEND-CODE-2
 21808         DISPLAY '******************************'
 21809         DISPLAY '***** ERROR LOCATION 027 *****'
 21810         DISPLAY '******************************'
 21811         MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
 21812           GO TO ABEND-PGM.
 21813
 21814     IF COMM-OPEN-SW = 'X'
 21815         CLOSE ERCTBL
 21816         IF ERCTBL-FILE-STATUS NOT = '00'
 21817             MOVE '42'               TO ABEND-CODE-1
 21818             MOVE ERCTBL-FILE-STATUS TO ABEND-CODE-2
 21819             DISPLAY '******************************'
 21820             DISPLAY '***** ERROR LOCATION 028 *****'
 21821             DISPLAY '******************************'
 21822             MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
 21823             GO TO ABEND-PGM.
 21824
 21825     IF REIN-OPEN-SW = 'X'
 21826         CLOSE ERRTBL-IN
 21827         IF ERRTBL-FILE-STATUS NOT = '00'
 21828             MOVE '22'               TO ABEND-CODE-1
 21829             MOVE ERRTBL-FILE-STATUS TO ABEND-CODE-2
 21830             DISPLAY '******************************'
 21831             DISPLAY '***** ERROR LOCATION 029 *****'
 21832             DISPLAY '******************************'
 21833             MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
 21834             GO TO ABEND-PGM.
 21835
 21836     MOVE 'C'                         TO CP-IO-FUNCTION.
 21837     PERFORM 8100-GET-RATE THRU 8199-GET-RATE-X.
 21838     IF IO-ERROR
 21839         MOVE 'ERROR OCCURED CLOSING - ELRATE'
 21840                                      TO WS-ABEND-MESSAGE
 21841         MOVE 0302                    TO WS-RETURN-CODE
 21842         DISPLAY '******************************'
 21843         DISPLAY '***** ERROR LOCATION 030 *****'
 21844         DISPLAY '******************************'
 21845         MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
 21846         GO TO ABEND-PGM.
 21847
 21848     IF ME-DO-UPDATE
 21849           MOVE ME-START-TIME        TO ME-010-START
*  12-S***************************************************             ( 281)**
**    Operand ME-010-START is not declared
 21850           MOVE ME-CNDS-DATE         TO ME-010-RUN-DT
 21851           ACCEPT WS-TIME-OF-DAY   FROM TIME
 21852           MOVE WS-TIME              TO ME-010-END
*  12-S*************************************************               ( 423)**
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 424
* ECS010P.cbl
**    Operand ME-010-END is not declared
 21853           ADD 1 TO ME-010-RUN-CT
 21854           REWRITE MONTH-END-BALANCES
 21855           DISPLAY 'MONTH-END BALANCES POSTED'
 21856           CLOSE ERMEBL-INOUT
 21857     ELSE
 21858         DISPLAY 'MONTH-END BALANCES NOT POSTED'.
 21859
 21860     GO TO 9999-END-THE-JOB.
 21861
 21862 CERT-DATE-LOAD.
*21863     COPY ELCCRTM1.
 21864******************************************************************04/15/98
 21865*                                                                *ELCCRTM1
 21866*                                                                *ELCCRTM1
 21867*                            ELCCRTM1                            *   LV003
 21868*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
 21869*                            VMOD=2.001                          *ELCCRTM1
 21870*                                                                *ELCCRTM1
 21871*   COPY FILE VARIABLES TO WORKING STORAGE                       *ELCCRTM1
 21872*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCCRTM1
 21873*                                                                *ELCCRTM1
 21874******************************************************************ELCCRTM1
 21875     MOVE CR-DT                   TO  WS-CR-DT-N.                    CL**2
 21876     MOVE CR-LF-EXPIRE-DATE       TO  WS-CR-LF-EXPIRE-DATE-N.        CL**2
 21877     MOVE CR-AH-EXPIRE-DATE       TO  WS-CR-AH-EXPIRE-DATE-N.        CL**2
 21878     MOVE CR-ENTRY-DATE           TO  WS-CR-ENTRY-DATE-N.            CL**2
 21879     MOVE CR-LF-CANC-DT           TO  WS-CR-LF-CANC-DT-N.            CL**2
 21880     MOVE CR-LF-CANCEL-EXIT-DATE  TO  WS-CR-LF-CANCEL-EXIT-DATE-N.   CL**2
 21881     MOVE CR-LF-CLAIM-EXIT-DATE   TO  WS-CR-LF-CLAIM-EXIT-DATE-N.    CL**2
 21882     MOVE CR-AH-CANC-DT           TO  WS-CR-AH-CANC-DT-N.            CL**2
 21883     MOVE CR-AH-CANCEL-EXIT-DATE  TO                                 CL**2
 21884                                  WS-CR-AH-CANCEL-EXIT-DATE-N.       CL**2
 21885     MOVE CR-AH-SETTLEMENT-EXIT-DATE TO                           ELCCRTM1
 21886                                 WS-CR-AH-SETTLEMENT-EXIT-DATEN.     CL**2
 21887     MOVE CR-DTH-DT               TO  WS-CR-DTH-DT-N.                CL**2
 21888     MOVE CR-DTH-PAY-DT           TO  WS-CR-DTH-PAY-DT-N.            CL**2
 21889     MOVE CR-DIS-DT               TO  WS-CR-DIS-DT-N.                CL**2
 21890     MOVE CR-DIS-PAY-DT           TO  WS-CR-DIS-PAY-DT-N.            CL**2
 21891     MOVE CR-DIS-PTO-DT           TO  WS-CR-DIS-PTO-DT-N.            CL**2
 21892     PERFORM  VARYING COPY-NDX FROM 1 BY 1 UNTIL COPY-NDX > 5     ELCCRTM1
 21893           MOVE CR-DIS-INCUR-DT (COPY-NDX)   TO                   ELCCRTM1
 21894                                WS-CR-DIS-INCUR-DT-N (COPY-NDX)      CL**2
 21895     END-PERFORM.                                                 ELCCRTM1
 21896                                                                  ELCCRTM1
 21897
 21898 EXTRACT-DATE-LOAD.
*21899     COPY ELCEXTM1.
 21900******************************************************************04/15/98
 21901*                                                                *ELCEXTM1
 21902*                                                                *ELCEXTM1
 21903*                            ELCEXTM1                            *   LV010
 21904*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL*10
 21905*                            VMOD=2.001                          *ELCEXTM1
 21906*                                                                *ELCEXTM1
 21907*   COPY FILE VARIABLES TO WORKING STORAGE                       *ELCEXTM1
 21908*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCEXTM1
 21909*                                                                *ELCEXTM1
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 425
* ECS010P.cbl (/apps/prod/cid1p/copy/ELCEXTM1)
 21910******************************************************************ELCEXTM1
 21911                                                                  ELCEXTM1
 21912     MOVE DE-EFF                     TO  WS-DE-EFF-N.                CL**9
 21913     MOVE DE-LF-CANC-DTE             TO  WS-DE-LF-CANC-DTE-N.        CL**9
 21914     MOVE DE-LF-CANC-EXIT-DT         TO  WS-DE-LF-CANC-EXIT-DT-N.    CL**9
 21915     MOVE DE-AH-CANC-DTE             TO  WS-DE-AH-CANC-DTE-N.        CL**9
 21916     MOVE DE-AH-CANC-EXIT-DT         TO  WS-DE-AH-CANC-EXIT-DT-N.    CL**9
 21917     MOVE DE-ENTRY-DTE               TO  WS-DE-ENTRY-DTE-N.          CL**9
 21918                                                                     CL**9
 21919     EVALUATE TRUE                                                   CL**5
 21920        WHEN DE-ISSUE      OR                                        CL**8
 21921             DE-RC-ISSUE   OR                                        CL**8
 21922             DE-RR-RC-ISS  OR                                        CL**8
 21923             DE-CANCEL     OR                                        CL**8
 21924             DE-RC-CANCEL  OR                                        CL**8
 21925             DE-RR-RC-CNC                                            CL**8
 21926           MOVE DE-PROC-DT           TO  WS-DE-PROC-DT-N             CL**9
 21927                                                                     CL**9
 21928        WHEN DE-CLAIM      OR                                        CL**8
 21929             DE-RR-RC-CLM                                            CL**6
 21930           MOVE DE-INCUR             TO  WS-DE-INCUR-N               CL**9
 21931           MOVE DE-PAY               TO  WS-DE-PAY-N                 CL**9
 21932           MOVE DE-PAID-TO           TO  WS-DE-PAID-TO-N             CL**9
 21933           MOVE DE-ACC-EXP-DTE       TO  WS-DE-ACC-EXP-DTE-N         CL**9
 21934           MOVE DE-ACC-EFF-DTE       TO  WS-DE-ACC-EFF-DTE-N         CL**9
 21935           MOVE DE-CLM-PROC-DT       TO  WS-DE-CLM-PROC-DT-N         CL**9
 21936                                                                     CL**9
 21937        WHEN DE-RESERVE                                              CL**9
 21938           MOVE DE-RSV-INCUR         TO  WS-DE-RSV-INCUR-N           CL**9
 21939           MOVE DE-RSV-PAYTO         TO  WS-DE-RSV-PAYTO-N           CL**9
 21940           MOVE DE-ACC-EXP-DTE-RSV                                   CL**5
 21941                                     TO  WS-DE-ACC-EXP-DTE-RSV-N     CL**9
 21942           MOVE DE-ACC-EFF-DTE-RSV                                   CL**9
 21943                                     TO  WS-DE-ACC-EFF-DTE-RSV-N     CL**9
 21944           MOVE DE-RSV-PROC-DT       TO  WS-DE-RSV-PROC-DT-N         CL**9
 21945     END-EVALUATE.                                                   CL**9
 21946                                                                     CL**9
 21947
 21948 EXTRACT-DATE-RELOAD.
*21949     COPY ELCEXTM2.
 21950******************************************************************04/15/98
 21951*                                                                *ELCEXTM2
 21952*                                                                *ELCEXTM2
 21953*                            ELCEXTM2                            *   LV011
 21954*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL*11
 21955*                            VMOD=2.001                          *ELCEXTM2
 21956*                                                                *ELCEXTM2
 21957*   COPY WORKING STORAGE TO  FILE VARIABLES                      *ELCEXTM2
 21958*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCEXTM2
 21959*                                                                *   CL**9
 21960******************************************************************ELCEXTM2
 21961                                                                  ELCEXTM2
 21962     MOVE WS-DE-EFF-N                TO  DE-EFF.                     CL*10
 21963     MOVE WS-DE-LF-CANC-DTE-N        TO  DE-LF-CANC-DTE.             CL*10
 21964     MOVE WS-DE-LF-CANC-EXIT-DT-N    TO  DE-LF-CANC-EXIT-DT.         CL*10
 21965     MOVE WS-DE-AH-CANC-DTE-N        TO  DE-AH-CANC-DTE.             CL*10
 21966     MOVE WS-DE-AH-CANC-EXIT-DT-N    TO  DE-AH-CANC-EXIT-DT.         CL*10
 21967     MOVE WS-DE-ENTRY-DTE-N          TO  DE-ENTRY-DTE.               CL*10
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 426
* ECS010P.cbl (/apps/prod/cid1p/copy/ELCEXTM2)
 21968                                                                     CL*10
 21969     EVALUATE TRUE                                                   CL*10
 21970        WHEN DE-ISSUE      OR                                        CL*10
 21971             DE-RC-ISSUE   OR                                        CL*10
 21972             DE-RR-RC-ISS  OR                                        CL*10
 21973             DE-CANCEL     OR                                        CL*10
 21974             DE-RC-CANCEL  OR                                        CL*10
 21975             DE-RR-RC-CNC                                            CL*10
 21976           MOVE WS-DE-PROC-DT-N      TO  DE-PROC-DT                  CL*10
 21977                                                                     CL*10
 21978        WHEN DE-CLAIM      OR                                        CL*10
 21979             DE-RR-RC-CLM                                            CL**7
 21980           MOVE WS-DE-INCUR-N        TO  DE-INCUR                    CL*10
 21981           MOVE WS-DE-PAY-N          TO  DE-PAY                      CL*10
 21982           MOVE WS-DE-PAID-TO-N      TO  DE-PAID-TO                  CL*10
 21983           MOVE WS-DE-ACC-EXP-DTE-N  TO  DE-ACC-EXP-DTE              CL*10
 21984           MOVE WS-DE-ACC-EFF-DTE-N  TO  DE-ACC-EFF-DTE              CL*10
 21985           MOVE WS-DE-CLM-PROC-DT-N  TO  DE-CLM-PROC-DT              CL*10
 21986                                                                     CL*10
 21987        WHEN DE-RESERVE                                              CL**7
 21988            MOVE WS-DE-RSV-INCUR-N   TO  DE-RSV-INCUR                CL*10
 21989            MOVE WS-DE-RSV-PAYTO-N   TO  DE-RSV-PAYTO                CL*10
 21990            MOVE WS-DE-ACC-EXP-DTE-RSV-N                             CL*10
 21991                                     TO  DE-ACC-EXP-DTE-RSV          CL*10
 21992            MOVE WS-DE-ACC-EFF-DTE-RSV-N                             CL**4
 21993                                     TO  DE-ACC-EFF-DTE-RSV          CL*10
 21994            MOVE WS-DE-RSV-PROC-DT-N TO  DE-RSV-PROC-DT              CL*10
 21995     END-EVALUATE.                                                   CL**5
 21996                                                                  ELCEXTM2
 21997
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 427
* ECS010P.cbl
 21999 ABEND-PGM.
 22000     DISPLAY '******************************'
 22001     DISPLAY '***** ABEND PGM **************'
 22002     DISPLAY '******************************'
*22003                             COPY ELCABEND.
 22004***************************************************************** 04/14/98
 22005*                                                               * ELCABEND
 22006*                            ELCABEND.                          *    LV003
 22007*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
 22008*                            VMOD 2.002                              CL**2
 22009*                                                               * ELCABEND
 22010*                THIS SECTION DISPLAYS THE NECESSARY MESSAGES   * ELCABEND
 22011*            AND THEN ABENDS.                                   * ELCABEND
 22012*                                                               * ELCABEND
 22013*  NO  CID  MODS  IN  COPYBOOK  ELCABEND                        * ELCABEND
 22014*                                                               * ELCABEND
 22015***************************************************************** ELCABEND
 22016*APS-010.                                                         ELCABEND
 22017     DISPLAY WS-ABEND-MESSAGE.                                    ELCABEND
 22018     DISPLAY WS-ABEND-MESSAGE UPON CONSOLE.                       ELCABEND
 22019                                                                  ELCABEND
 22020     IF WS-ABEND-FILE-STATUS NOT = ZERO                           ELCABEND
 22021         DISPLAY 'FILE STATUS = ' WS-ABEND-FILE-STATUS            ELCABEND
 22022         DISPLAY 'FILE STATUS = ' WS-ABEND-FILE-STATUS            ELCABEND
 22023                                 UPON CONSOLE.                    ELCABEND
 22024                                                                  ELCABEND
 22025     IF WS-RETURN-CODE NOT = ZERO                                 ELCABEND
 22026         DISPLAY 'RETURN CODE = '  WS-RETURN-CODE                 ELCABEND
 22027         DISPLAY 'RETURN CODE = '  WS-RETURN-CODE                 ELCABEND
 22028                                 UPON CONSOLE.                    ELCABEND
 22029                                                                  ELCABEND
 22030     DISPLAY 'PROGRAM WILL NOW ABEND **************'              ELCABEND
 22031     DISPLAY 'PROGRAM WILL NOW ABEND **************'              ELCABEND
 22032                                 UPON CONSOLE.                    ELCABEND
 22033                                                                  ELCABEND
 22034     DIVIDE WS-ZERO BY WS-ZERO GIVING WS-ZERO.                    ELCABEND
 22035     CALL 'ABORTME'.
 22036                                                                  ELCABEND
 22037 APS-EXIT.                                                        ELCABEND
 22038     EXIT.                                                        ELCABEND
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 428
* ECS010P.cbl
 22040 9999-END-THE-JOB.
 22041
 22042     DISPLAY ' '.
 22043     DISPLAY '****** THE END OF MESSAGES CREATED BY '
 22044         'ECS010 ******'
 22045     DISPLAY ' '.
 22046     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 429
* ECS010P.cbl
 22047/
 22048 LCP-WRITE-POS-MISMATCH-RPT SECTION.
 22049     IF LCP-ASA = '+'
 22050         WRITE MISMATCH-RPT AFTER 0 LINE
 22051     ELSE
 22052     IF LCP-ASA = ' '
 22053         WRITE MISMATCH-RPT AFTER ADVANCING 1 LINE
 22054     ELSE
 22055     IF LCP-ASA = '0'
 22056         WRITE MISMATCH-RPT AFTER ADVANCING 2 LINE
 22057     ELSE
 22058     IF LCP-ASA = '-'
 22059         WRITE MISMATCH-RPT AFTER ADVANCING 3 LINE
 22060     ELSE
 22061     IF LCP-ASA = '1'
 22062         WRITE MISMATCH-RPT AFTER ADVANCING PAGE
 22063     ELSE
 22064     IF LCP-ASA = '2'
 22065         WRITE MISMATCH-RPT AFTER ADVANCING LCP-CH2
 22066     ELSE
 22067     IF LCP-ASA = '3'
 22068         WRITE MISMATCH-RPT AFTER ADVANCING LCP-CH3
 22069     ELSE
 22070     IF LCP-ASA = '4'
 22071         WRITE MISMATCH-RPT AFTER ADVANCING LCP-CH4
 22072     ELSE
 22073     IF LCP-ASA = '5'
 22074         WRITE MISMATCH-RPT AFTER ADVANCING LCP-CH5
 22075     ELSE
 22076     IF LCP-ASA = '6'
 22077         WRITE MISMATCH-RPT AFTER ADVANCING LCP-CH6
 22078     ELSE
 22079     IF LCP-ASA = '7'
 22080         WRITE MISMATCH-RPT AFTER ADVANCING LCP-CH7
 22081     ELSE
 22082     IF LCP-ASA = '8'
 22083         WRITE MISMATCH-RPT AFTER ADVANCING LCP-CH8
 22084     ELSE
 22085     IF LCP-ASA = '9'
 22086         WRITE MISMATCH-RPT AFTER ADVANCING LCP-CH9
 22087     ELSE
 22088     IF LCP-ASA = 'A'
 22089         WRITE MISMATCH-RPT AFTER ADVANCING LCP-CH10
 22090     ELSE
 22091     IF LCP-ASA = 'B'
 22092         WRITE MISMATCH-RPT AFTER ADVANCING LCP-CH11
 22093     ELSE
 22094     IF LCP-ASA = 'C'
 22095         WRITE MISMATCH-RPT AFTER ADVANCING LCP-CH12
 22096     ELSE
 22097     IF LCP-ASA = 'V'
 22098         WRITE MISMATCH-RPT AFTER ADVANCING LCP-P01
 22099     ELSE
 22100     IF LCP-ASA = 'W'
 22101         WRITE MISMATCH-RPT AFTER ADVANCING LCP-P02
 22102     ELSE
 22103     DISPLAY 'ASA CODE ERROR'.
 22104 LCP-WRITE-END-MISMATCH-RPT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 430
* ECS010P.cbl
 22105     EXIT.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Last message on page:  423
* Total Messages:    15
* Unrecoverable :     0                    Severe  :    12
* Errors        :     3                    Warnings:     0
* Informational :     0                    Flags   :     0
* Data:     2176749     Code:           0
