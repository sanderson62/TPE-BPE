* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   1
* ECS150P.cbl
* Options: int("ECS150P.int") anim csi verbose NOBOUND PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("ECS150P.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"ebmlsfile" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" NOCHECKDIV NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"32" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"ECS150P.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"ECS150P.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR NOSTICKY-LINKAGE
*          NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"2" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                 ECS150.
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 01/01/97 16:27:55.
     7*             PROGRAM REVIEWED FOR YEAR 2000 COMPLIANCE
     8*                            VMOD=2.029.
     9*AUTHOR         LOGIC, INC.
    10*               DALLAS, TEXAS.
    11*DATE-COMPILED.
    12
    13*SECURITY.   *****************************************************
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   2
* ECS150P.cbl
    14*            *                                                   *
    15*            *   THIS PROGRAM IS THE PROPERTY OF LOGIC, INC.     *
    16*            *                                                   *
    17*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
    18*            *   OF LOGIC, INC. IS EXPRESSLY PROHIBITED WITHOUT  *
    19*            *   THE PRIOR WRITTEN PERMISSION OF LOGIC INC.      *
    20*            *                                                   *
    21*            *****************************************************
    22
    23*REMARKS.
    24*        THIS PROGRAM PRODUCES THE EXTRACT RECORDS
    25*        NEEDED TO COMPLETE THE LIFE AND A/H ANNUAL REPORT.
    26*        DETAIL IS GENERATED IF REQUESTED.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   3
* ECS150P.cbl
    28 ENVIRONMENT DIVISION.
    29 CONFIGURATION SECTION.
    30 INPUT-OUTPUT SECTION.
    31 FILE-CONTROL.
    32
    33     SELECT SORT-WORK        ASSIGN TO SYS001-UT-2314-S-SORTWK1.
    34     SELECT PRINT-FILE       ASSIGN TO SYS008-UR-1403-S-SYS008.
    35     SELECT CERT-FILE        ASSIGN TO SYS011-UT-2400-S-SYS011.
    36     SELECT REINS-EXTRACT-2  ASSIGN TO SYS012-UT-2400-S-SYS012.
    37     SELECT ERRTBL-IN        ASSIGN TO ERRTBLT
    38                             ORGANIZATION IS INDEXED
    39                             ACCESS IS DYNAMIC
    40                             FILE STATUS IS ERRTBL-FILE-STATUS
    41                             RECORD KEY IS RE-CONTROL-PRIMARY.
    42     SELECT ERACCTT          ASSIGN TO SYS010-FBA1-ERACCTT
    43                             ORGANIZATION IS INDEXED
    44                             ACCESS IS SEQUENTIAL
    45                             FILE STATUS IS ACCT-FILE-STATUS
    46                             RECORD KEY IS AM-CONTROL-PRIMARY.
    47     SELECT REINS-EXTRACT-1  ASSIGN TO SYS018-UT-2400-S-SYS018.
    48     SELECT DISK-DATE        ASSIGN TO SYS019-UT-2314-S-SYS019.
    49     SELECT FICH             ASSIGN TO SYS020-UT-2400-S-SYS020.
    50     SELECT CLAS150-A-EXTRACT ASSIGN TO SYS021-UT-2400-S-SYS021.
    51     SELECT CLAS150-B-EXTRACT ASSIGN TO SYS022-UT-2400-S-SYS022.
    52     SELECT CLAS150-C-EXTRACT ASSIGN TO SYS023-UT-2400-S-SYS023.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   4
* ECS150P.cbl
    54 DATA DIVISION.
    55 FILE SECTION.
    56
    57 SD  SORT-WORK.
    58*    RECORD CONTAINS 210 CHARACTERS
    59
    60 01  SORT-REC.
    61     12  SORT-KEY            PIC X(42).
    62     12  FILLER              PIC X(168).
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   5
* ECS150P.cbl
    64 FD  PRINT-FILE
*   65                             COPY ELCPRTFD.
    66******************************************************************04/15/98
    67*                                                                *ELCPRTFD
    68*                                                                *ELCPRTFD
    69*                            ELCPRTFD.                           *   LV003
    70*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
    71*                            VMOD=2.006                          *ELCPRTFD
    72******************************************************************ELCPRTFD
    73     RECORDING MODE F                                             ELCPRTFD
    74     LABEL RECORDS OMITTED                                        ELCPRTFD
    75     BLOCK CONTAINS 0 RECORDS
    76     RECORD CONTAINS 133 CHARACTERS.                              ELCPRTFD
    77 01  PRT.                                                         ELCPRTFD
    78     12  P-CTL               PIC  X.                                 CL**2
    79     12  P-DATA              PIC  X(132).                         ELCPRTFD
    80******************************************************************ELCPRTFD
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   6
* ECS150P.cbl
    82 FD  CERT-FILE
*   83                             COPY ECSCRIFD.
    84******************************************************************07/10/97
    85*                                                                *ECSCRIFD
    86*                            ECSCRIFD                            *   LV001
    87*                            VMOD 2.005                          *ECSCRIFD
    88*                                                                *ECSCRIFD
    89*  NO CID MODS FOR COPYBOOK ECSCRIFD                             *ECSCRIFD
    90*                                                                *ECSCRIFD
    91******************************************************************ECSCRIFD
    92     BLOCK CONTAINS 0 RECORDS
    93     RECORDING MODE F.                                            ECSCRIFD
    94                                                                  ECSCRIFD
    95 01  CERT-IN-RECORD.                                              ECSCRIFD
    96                                                                  ECSCRIFD
    97     12  FILLER                            PIC XXX.               ECSCRIFD
    98     12  CIR-CONTROL                       PIC X(36).             ECSCRIFD
    99     12  FILLER                            PIC X(66).             ECSCRIFD
   100     12  CIR-JOINT-AGE                     PIC 99.                ECSCRIFD
   101     12  FILLER                            PIC X(20).             ECSCRIFD
   102     12  CIR-LFTYP                         PIC XX.                ECSCRIFD
   103     12  FILLER                            PIC X(14).             ECSCRIFD
   104     12  CIR-LFAMT                         PIC S9(9)V99   COMP-3. ECSCRIFD
   105     12  FILLER                            PIC X(39).             ECSCRIFD
   106     12  CIR-LFRFND-CALC                   PIC S9(7)V99   COMP-3. ECSCRIFD
   107     12  FILLER                            PIC X(45).             ECSCRIFD
   108     12  CIR-AHTYP                         PIC XX.                ECSCRIFD
   109     12  FILLER                            PIC X(35).             ECSCRIFD
   110     12  CIR-AHRFND-CALC                   PIC S9(7)V99   COMP-3. ECSCRIFD
   111     12  FILLER                            PIC X(41).             ECSCRIFD
   112     12  CIR-APR                           PIC S999V9(4)  COMP-3. ECSCRIFD
   113     12  FILLER                            PIC X(48).             ECSCRIFD
   114     12  CIR-REIN-TABLE                    PIC XXX.               ECSCRIFD
   115     12  FILLER                            PIC X(9).              ECSCRIFD
   116     12  CIR-SUM-CAN-CNT-YTD               PIC S999       COMP-3. ECSCRIFD
   117     12  FILLER                            PIC X(120).            ECSCRIFD
   118     12  CIR-DTHAMT-YTD                    PIC S9(9)V99   COMP-3. ECSCRIFD
   119     12  FILLER                            PIC X(73).             ECSCRIFD
   120     12  CIR-DISAMT-YTD                    PIC S9(9)V99   COMP-3. ECSCRIFD
   121     12  FILLER                            PIC X(464).            ECSCRIFD
   122                                                                  ECSCRIFD
   123******************************************************************ECSCRIFD
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   7
* ECS150P.cbl
   125 FD  REINS-EXTRACT-2
   126     BLOCK CONTAINS 0 RECORDS
   127     RECORDING MODE IS F.
   128*    RECORD CONTAINS 210 CHARACTERS
   129
   130 01  RC-REC-2.
   131     12  RC-CONTRAL-2        PIC  X(210).
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   8
* ECS150P.cbl
   133 FD  ERRTBL-IN
*  134                             COPY ECSRTFDD.
   135******************************************************************07/10/97
   136*                                                                *ECSRTFDD
   137*                            ECSRTFDD                            *   LV001
   138*                            VMOD=2.001                          *ECSRTFDD
   139*                                                                *ECSRTFDD
   140*  NO  CID  MODS  IN  COPYBOOK  ECSRTFDD                         *ECSRTFDD
   141*                                                                *ECSRTFDD
   142******************************************************************ECSRTFDD
   143     LABEL RECORDS STANDARD                                       ECSRTFDD
   144     RECORD CONTAINS 4000 CHARACTERS.                             ECSRTFDD
   145                                                                  ECSRTFDD
   146 01  RT-REC                  PIC  X(4000).                        ECSRTFDD
   147******************************************************************ECSRTFDD
   148
*  149                             COPY ERCREIN.
   150******************************************************************07/27/93
   151*                                                                *ERCREIN
   152*                            ERCREIN                             *   LV009
   153*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   154*                            VMOD=2.010                          *   CL**9
   155*                                                                *ERCREIN
   156*   ONLINE CREDIT SYSTEM                                         *ERCREIN
   157*                                                                *ERCREIN
   158*   FILE DESCRIPTION = REINSURANCE MASTER FILE                   *ERCREIN
   159*                                                                *ERCREIN
   160*   FILE TYPE = VSAM,KSDS                                        *ERCREIN
   161*   RECORD SIZE = 4000  RECFORM = FIXED                          *ERCREIN
   162*                                                                *ERCREIN
   163*   BASE CLUSTER NAME = ERREIN                   RKP=2,LEN=8     *ERCREIN
   164*       ALTERNATE PATH = NONE                                    *ERCREIN
   165*                                                                *ERCREIN
   166*   LOG = NO                                                     *ERCREIN
   167*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *ERCREIN
   168*                                                                *ERCREIN
   169******************************************************************ERCREIN
   170*                   C H A N G E   L O G
   171*
   172* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   173*-----------------------------------------------------------------
   174*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   175* EFFECTIVE    NUMBER
   176*-----------------------------------------------------------------
   177* 103101    2001100100006  SMVA  ADD STATE EXHIBIT REPORT OPTION F
   178* 032707    2007032100006  PEMA  ADD EXCISE TAX CAPABILITY
   179******************************************************************
   180 01  REINSURANCE-RECORD.                                          ERCREIN
   181     12  RE-RECORD-ID                      PIC XX.                ERCREIN
   182         88  VALID-RE-ID                      VALUE 'RE'.         ERCREIN
   183                                                                  ERCREIN
   184     12  RE-CONTROL-PRIMARY.                                      ERCREIN
   185         16  RE-COMPANY-CD                 PIC X.                 ERCREIN
   186         16  RE-KEY.                                              ERCREIN
   187             20  RE-CODE                   PIC X.                 ERCREIN
   188                 88  RE-TABLE-RECORD          VALUE 'A'.          ERCREIN
   189                 88  RE-COMPANY-RECORD        VALUE 'B'.          ERCREIN
   190             20  RE-TABLE                  PIC XXX.               ERCREIN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   9
* ECS150P.cbl (/apps/prod/cid1p/copy/ERCREIN)
   191             20  FILLER                    PIC XXX.               ERCREIN
   192         16  RE-COMPANY-KEY REDEFINES RE-KEY.                     ERCREIN
   193             20  FILLER                    PIC X.                 ERCREIN
   194             20  RE-COMPANY.                                      ERCREIN
   195                 24  RE-COMP-PRIME         PIC XXX.               ERCREIN
   196                 24  RE-COMP-SUB           PIC XXX.               ERCREIN
   197                                                                  ERCREIN
   198     12  RE-MAINT-INFORMATION.                                    ERCREIN
   199         16  RE-LAST-MAINT-DT              PIC XX.                ERCREIN
   200         16  RE-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3. ERCREIN
   201         16  RE-LAST-MAINT-USER            PIC X(4).              ERCREIN
   202         16  FILLER                        PIC X(10).             ERCREIN
   203                                                                  ERCREIN
   204     12  RE-TABLE-DATA.                                           ERCREIN
   205         16  RE-100-COMP                   PIC 99.                ERCREIN
   206                                                                  ERCREIN
   207         16  RE-COMP-INFO    OCCURS 30 TIMES.                     ERCREIN
   208             20  RE-REI-COMP-NO.                                  ERCREIN
   209                 24  RE-REI-COMP           PIC XXX.               ERCREIN
   210                 24  RE-REI-COMP-SUB       PIC XXX.               ERCREIN
   211             20  RE-LF-QC                  PIC X.                 ERCREIN
   212             20  RE-AH-QC                  PIC X.                 ERCREIN
   213             20  RE-LO-DATE                PIC 9(11)     COMP-3.  ERCREIN
   214             20  RE-HI-DATE                PIC 9(11)     COMP-3.  ERCREIN
   215             20  RE-LFAGE-LO               PIC 99.                ERCREIN
   216             20  RE-LFAGE-HI               PIC 99.                ERCREIN
   217             20  RE-AHAGE-LO               PIC 99.                ERCREIN
   218             20  RE-AHAGE-HI               PIC 99.                ERCREIN
   219             20  RE-LFTRM-LO               PIC S999       COMP-3. ERCREIN
   220             20  RE-LFTRM-HI               PIC S999       COMP-3. ERCREIN
   221             20  RE-AHTRM-LO               PIC S999       COMP-3. ERCREIN
   222             20  RE-AHTRM-HI               PIC S999       COMP-3. ERCREIN
   223             20  RE-LF-PCT                 PIC S9V9999    COMP-3. ERCREIN
   224             20  RE-AH-PCT                 PIC S9V9999    COMP-3. ERCREIN
   225             20  RE-LF-LIM-LO              PIC S9(9)V99   COMP-3. ERCREIN
   226             20  RE-LF-LIM-HI              PIC S9(9)V99   COMP-3. ERCREIN
   227             20  RE-LF-LO                  PIC S9(9)V99   COMP-3. ERCREIN
   228             20  RE-LF-HI                  PIC S9(9)V99   COMP-3. ERCREIN
   229             20  RE-AHBEN-LIM-LO           PIC S9(7)V99   COMP-3. ERCREIN
   230             20  RE-AHBEN-LIM-HI           PIC S9(7)V99   COMP-3. ERCREIN
   231             20  RE-AHBEN-LO               PIC S9(7)V99   COMP-3. ERCREIN
   232             20  RE-AHBEN-HI               PIC S9(7)V99   COMP-3. ERCREIN
   233             20  RE-AHMOA-LIM-LO           PIC S9(7)V99   COMP-3. ERCREIN
   234             20  RE-AHMOA-LIM-HI           PIC S9(7)V99   COMP-3. ERCREIN
   235             20  RE-AHMOA-LO               PIC S9(7)V99   COMP-3. ERCREIN
   236             20  RE-AHMOA-HI               PIC S9(7)V99   COMP-3. ERCREIN
   237             20  RE-LF-BEN-CODE            PIC X.                 ERCREIN
   238             20  RE-AH-BEN-CODE            PIC X.                 ERCREIN
   239             20  RE-INTERACTIVE            PIC X.                 ERCREIN
   240             20  RE-REMAINING              PIC X.                 ERCREIN
   241             20  RE-LF-RUNOFF-SW           PIC X.                      000
   242             20  RE-AH-RUNOFF-SW           PIC X.                      000
   243             20  FILLER                    PIC X(19).                  000
   244                                                                  ERCREIN
   245         16  RE-COMP-INFO-END              PIC X(6).              ERCREIN
   246         16  RE-NSP-ST-CD-LF               PIC XX.                ERCREIN
   247         16  RE-NSP-ST-CD-AH               PIC XX.                ERCREIN
   248         16  RE-TABLE-CARRIER-SECURITY     PIC X.                 ERCREIN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  10
* ECS150P.cbl (/apps/prod/cid1p/copy/ERCREIN)
   249             88  NO-TABLE-CARRIER-SECURITY    VALUE SPACE.        ERCREIN
   250                                                                  ERCREIN
   251         16  FILLER                        PIC X(27).             ERCREIN
   252                                                                  ERCREIN
   253     12  RE-COMPANY-DATA   REDEFINES   RE-TABLE-DATA.             ERCREIN
   254         16  RE-NAME                       PIC X(30).             ERCREIN
   255         16  RE-LF-PE                      PIC X.                 ERCREIN
   256         16  RE-AH-PE                      PIC X.                 ERCREIN
   257         16  RE-LF-FEE                     PIC S9V9999    COMP-3. ERCREIN
   258         16  RE-AH-FEE                     PIC S9V9999    COMP-3. ERCREIN
   259         16  RE-AH-PR-PCT                  PIC S9V9999    COMP-3. ERCREIN
   260         16  RE-AH-78-PCT                  PIC S9V9999    COMP-3. ERCREIN
   261         16  RE-PRT-ST                     PIC X.                 ERCREIN
   262         16  RE-PRT-OW                     PIC X.                 ERCREIN
   263         16  RE-MORT-CODE                  PIC X(4).              ERCREIN
   264         16  RE-CLAIM-CODE                 PIC X.                 ERCREIN
   265         16  RE-ZERO-LF-FEE                PIC X.                 ERCREIN
   266         16  RE-ZERO-AH-FEE                PIC X.                 ERCREIN
   267         16  RE-CEDE-NAME                  PIC X(30).             ERCREIN
   268         16  RE-LF-COMM                    PIC X.                 ERCREIN
   269         16  RE-AH-COMM                    PIC X.                 ERCREIN
   270         16  RE-LF-TAX                     PIC X.                 ERCREIN
   271         16  RE-AH-TAX                     PIC X.                 ERCREIN
   272         16  RE-CLM-INCURRED-LIM           PIC 9(11)  COMP-3.     ERCREIN
   273         16  RE-LF-IBNR-PCT                PIC SV999      COMP-3. ERCREIN
   274         16  RE-AH-IBNR-PCT                PIC SV999      COMP-3. ERCREIN
   275                                                                  ERCREIN
   276         16  RE-COMP-CARRIER-SECURITY      PIC X.                 ERCREIN
   277             88  NO-COMP-CARRIER-SECURITY     VALUE SPACE.        ERCREIN
   278                                                                  ERCREIN
   279         16  RE-LF-CEDING-FEE-BRACKETS.                           ERCREIN
   280             20  RE-LF-FEE-METHOD          PIC X.                 ERCREIN
   281                 88  RE-LF-FEE-BRACKETED         VALUE '1' '2'.   ERCREIN
   282                 88  RE-LF-FEE-METHOD-1          VALUE '1'.       ERCREIN
   283                 88  RE-LF-FEE-METHOD-2          VALUE '2'.       ERCREIN
   284                 88  RE-LF-FEE-PERCENT           VALUE ' ' 'P'.   ERCREIN
   285             20  RE-LF-FEE-BASIS           PIC X.                 ERCREIN
   286                 88  RE-LF-GROSS-CEDED             VALUE '1'.     ERCREIN
   287                 88  RE-LF-NET-CEDED               VALUE '2'.     ERCREIN
   288                 88  RE-LF-GROSS-WRITTEN           VALUE '3'.     ERCREIN
   289                 88  RE-LF-NET-WRITTEN             VALUE '4'.     ERCREIN
   290                 88  RE-LF-COMBINE-GROSS-CEDED     VALUE '5'.     ERCREIN
   291                 88  RE-LF-COMBINE-NET-CEDED       VALUE '6'.     ERCREIN
   292                 88  RE-LF-COMBINE-GROSS-WRITTEN   VALUE '7'.     ERCREIN
   293                 88  RE-LF-COMBINE-NET-WRITTEN     VALUE '8'.     ERCREIN
   294             20  FILLER                    PIC XXX.               ERCREIN
   295             20  RE-LF-FEE-RANGES  OCCURS 6 TIMES.                ERCREIN
   296                 24  RE-LF-FEE-RANGE-PCT   PIC S9V9999    COMP-3. ERCREIN
   297                 24  RE-LF-FEE-THRU-AMT    PIC S9(7)V99   COMP-3. ERCREIN
   298                                                                  ERCREIN
   299         16  RE-AH-CEDING-FEE-BRACKETS.                           ERCREIN
   300             20  RE-AH-FEE-METHOD          PIC X.                 ERCREIN
   301                 88  RE-AH-FEE-BRACKETED         VALUE '1' '2'.   ERCREIN
   302                 88  RE-AH-FEE-METHOD-1          VALUE '1'.       ERCREIN
   303                 88  RE-AH-FEE-METHOD-2          VALUE '2'.       ERCREIN
   304                 88  RE-AH-FEE-PERCENT           VALUE ' ' 'P'.   ERCREIN
   305             20  RE-AH-FEE-BASIS           PIC X.                 ERCREIN
   306                 88  RE-AH-GROSS-CEDED             VALUE '1'.     ERCREIN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  11
* ECS150P.cbl (/apps/prod/cid1p/copy/ERCREIN)
   307                 88  RE-AH-NET-CEDED               VALUE '2'.     ERCREIN
   308                 88  RE-AH-GROSS-WRITTEN           VALUE '3'.     ERCREIN
   309                 88  RE-AH-NET-WRITTEN             VALUE '4'.     ERCREIN
   310                 88  RE-AH-COMBINE-GROSS-CEDED     VALUE '5'.     ERCREIN
   311                 88  RE-AH-COMBINE-NET-CEDED       VALUE '6'.     ERCREIN
   312                 88  RE-AH-COMBINE-GROSS-WRITTEN   VALUE '7'.     ERCREIN
   313                 88  RE-AH-COMBINE-NET-WRITTEN     VALUE '8'.     ERCREIN
   314             20  FILLER                    PIC XXX.               ERCREIN
   315             20  RE-AH-FEE-RANGES  OCCURS 6 TIMES.                ERCREIN
   316                 24  RE-AH-FEE-RANGE-PCT   PIC S9V9999    COMP-3. ERCREIN
   317                 24  RE-AH-FEE-THRU-AMT    PIC S9(7)V99   COMP-3. ERCREIN
   318                                                                  ERCREIN
   319         16  RE-EARNING-START-DT           PIC 9(11)  COMP-3.     ERCREIN
   320                                                                  ERCREIN
   321         16  RE-OLD-CEDING-STMT            PIC X.                    CL**4
   322                                                                  ERCREIN
   323         16  RE-LF-CLM-PCT                 PIC S9V9999    COMP-3. ERCREIN
   324         16  RE-AH-CLM-PCT                 PIC S9V9999    COMP-3. ERCREIN
   325         16  RE-LF-CLM-MAX                 PIC S9(7)V99   COMP-3. ERCREIN
   326         16  RE-AH-CLM-MAX                 PIC S9(7)V99   COMP-3. ERCREIN
   327         16  RE-LF-PR-PCT                  PIC S9V9999    COMP-3. ERCREIN
   328         16  RE-LF-78-PCT                  PIC S9V9999    COMP-3. ERCREIN
   329         16  RE-REINS-GROUPING-CODE        PIC X(6).              ERCREIN
   330         16  RE-MORT-SW                    PIC X.                 ERCREIN
   331         16  RE-CEDING-TYPE-FLAG           PIC X.                    CL**2
   332             88  RE-NO-CESSION-TYPE                VALUE ' '.        CL**2
   333             88  RE-CEDED                          VALUE 'C'.        CL**2
   334             88  RE-ASSUMED                        VALUE 'A'.        CL**2
   335             88  RE-PHANTOM                        VALUE 'P'.        CL**2
   336                                                                  ERCREIN
   337         16  RE-CEDING-STMT-OPT-A          PIC X.                    CL**3
   338             88  REPORT-A-WANTED    VALUE ' ' 'Y'.                   CL**3
   339         16  RE-CEDING-STMT-OPT-B          PIC X.                    CL**3
   340             88  REPORT-B-WANTED    VALUE ' ' 'Y'.                   CL**3
   341         16  RE-CEDING-STMT-OPT-C          PIC X.                    CL**3
   342             88  REPORT-C-WANTED    VALUE ' ' 'Y'.                   CL**3
   343         16  RE-CEDING-STMT-OPT-D          PIC X.                    CL**3
   344             88  REPORT-D-WANTED    VALUE ' ' 'Y'.                   CL**3
   345         16  RE-CEDING-STMT-OPT-E          PIC X.                    CL**3
   346             88  REPORT-E-WANTED    VALUE ' ' 'Y'.                   CL**3
   347                                                                     CL**3
   348         16  RE-PRT-CRSV                   PIC X.                    CL**5
   349                                                                     CL**5
   350         16  RE-GL-CENTER                  PIC X(4).                 CL**6
   351                                                                     CL**8
   352         16  RE-CUSTODIAL-BAL              PIC S9(7)V99   COMP-3.    CL**8
   353                                                                     CL**8
   354         16  RE-EARNING-STOP-DT            PIC 9(11)  COMP-3.        CL**9
   355                                                                     CL**9
   356         16  RE-EARN-STOP-CODE             PIC X.                    CL**9
   357             88  STOP-LIFE-EARNING  VALUE 'L' 'B'.                   CL**9
   358             88  STOP-AH-EARNING    VALUE 'A' 'B'.                   CL**9
   359
   360         16  RE-STATE-EXHIBIT-OPT-F        PIC X.
   361             88  RPTF-ECS152-WANTED VALUE ' ' 'Y'.
   362                                                                     CL**9
   363         16  RE-EXCISE-TAX                 PIC S9V9999 COMP-3.
   364         16  FILLER                        PIC X(2281).              CL**9
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  12
* ECS150P.cbl (/apps/prod/cid1p/copy/ERCREIN)
   365                                                                  ERCREIN
   366         16  RE-DESC OCCURS 18 TIMES       PIC X(79).             ERCREIN
   367                                                                  ERCREIN
   368******************************************************************ERCREIN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  13
* ECS150P.cbl
   370 FD  ERACCTT.
*  371                             COPY ERCACCT.
   372******************************************************************04/19/98
   373*                                                                *ERCACCT
   374*                                                                *ERCACCT
   375*                            ERCACCT                             *   LV031
   376*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL*31
   377*                            VMOD=2.031                          *ERCACCT
   378*                                                                *ERCACCT
   379*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *ERCACCT
   380*                                                                *ERCACCT
   381*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *ERCACCT
   382*   VSAM ACCOUNT MASTER FILES.                                   *ERCACCT
   383*                                                                *ERCACCT
   384*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *ERCACCT
   385*                                                                *ERCACCT
   386*   FILE TYPE = VSAM,KSDS                                        *ERCACCT
   387*   RECORD SIZE = 2000  RECFORM = FIX                            *ERCACCT
   388*                                                                *ERCACCT
   389*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *ERCACCT
   390*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *ERCACCT
   391*                                                                *ERCACCT
   392*   LOG = NO                                                     *ERCACCT
   393*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *ERCACCT
   394*                                                                *ERCACCT
   395*                                                                *ERCACCT
   396******************************************************************ERCACCT
   397*                   C H A N G E   L O G
   398*
   399* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   400*-----------------------------------------------------------------
   401*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   402* EFFECTIVE    NUMBER
   403*-----------------------------------------------------------------
   404* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
   405* 092705    2005050300006  PEMA  ADD SPP LEASES
   406* 022808    2007083100002  PEMA  ADD FREEZE STATUS
   407* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
   408* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
   409* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
   410* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
   411******************************************************************
   412                                                                  ERCACCT
   413 01  ACCOUNT-MASTER.                                              ERCACCT
   414     12  AM-RECORD-ID                      PIC XX.                ERCACCT
   415         88  VALID-AM-ID                      VALUE 'AM'.         ERCACCT
   416                                                                  ERCACCT
   417     12  AM-CONTROL-PRIMARY.                                      ERCACCT
   418         16  AM-COMPANY-CD                 PIC X.                 ERCACCT
   419         16  AM-MSTR-CNTRL.                                       ERCACCT
   420             20  AM-CONTROL-A.                                    ERCACCT
   421                 24  AM-CARRIER            PIC X.                 ERCACCT
   422                 24  AM-GROUPING.                                 ERCACCT
   423                     28 AM-GROUPING-PREFIX PIC XXX.               ERCACCT
   424                     28 AM-GROUPING-PRIME  PIC XXX.               ERCACCT
   425                 24  AM-STATE              PIC XX.                ERCACCT
   426                 24  AM-ACCOUNT.                                  ERCACCT
   427                     28  AM-ACCOUNT-PREFIX PIC X(4).              ERCACCT
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  14
* ECS150P.cbl (/apps/prod/cid1p/copy/ERCACCT)
   428                     28  AM-ACCOUNT-PRIME  PIC X(6).              ERCACCT
   429             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A            ERCACCT
   430                                           PIC X(19).             ERCACCT
   431             20  AM-CNTRL-B.                                      ERCACCT
   432                 24  AM-EXPIRATION-DT      PIC XX.                ERCACCT
   433                 24  FILLER                PIC X(4).              ERCACCT
   434             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.                 ERCACCT
   435                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.     ERCACCT
   436                                                                  ERCACCT
   437     12  AM-CONTROL-BY-VAR-GRP.                                   ERCACCT
   438         16  AM-COMPANY-CD-A1              PIC X.                 ERCACCT
   439         16  AM-VG-CARRIER                 PIC X.                 ERCACCT
   440         16  AM-VG-GROUPING                PIC X(6).              ERCACCT
   441         16  AM-VG-STATE                   PIC XX.                ERCACCT
   442         16  AM-VG-ACCOUNT                 PIC X(10).             ERCACCT
   443         16  AM-VG-DATE.                                          ERCACCT
   444             20  AM-VG-EXPIRATION-DT       PIC XX.                ERCACCT
   445             20  FILLER                    PIC X(4).              ERCACCT
   446         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE                  ERCACCT
   447                                           PIC 9(11)      COMP-3. ERCACCT
   448     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
   449         16  FILLER                        PIC X(10).
   450         16  AM-VG-KEY3.
   451             20  AM-VG3-ACCOUNT            PIC X(10).
   452             20  AM-VG3-EXP-DT             PIC XX.
   453         16  FILLER                        PIC X(4).
   454     12  AM-MAINT-INFORMATION.                                    ERCACCT
   455         16  AM-LAST-MAINT-DT              PIC XX.                ERCACCT
   456         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3. ERCACCT
   457         16  AM-LAST-MAINT-USER            PIC X(4).              ERCACCT
   458         16  FILLER                        PIC XX.                ERCACCT
   459                                                                  ERCACCT
   460     12  AM-EFFECTIVE-DT                   PIC XX.                ERCACCT
   461     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3. ERCACCT
   462                                                                  ERCACCT
   463     12  AM-PREV-DATES  COMP-3.                                   ERCACCT
   464         16  AM-PREV-EXP-DT                PIC 9(11).             ERCACCT
   465         16  AM-PREV-EFF-DT                PIC 9(11).             ERCACCT
   466                                                                  ERCACCT
   467     12  AM-REPORT-CODE-1                  PIC X(10).             ERCACCT
   468     12  AM-REPORT-CODE-2                  PIC X(10).             ERCACCT
   469                                                                  ERCACCT
   470     12  AM-CITY-CODE                      PIC X(4).              ERCACCT
   471     12  AM-COUNTY-PARISH                  PIC X(6).              ERCACCT
   472                                                                  ERCACCT
   473     12  AM-NAME                           PIC X(30).             ERCACCT
   474     12  AM-PERSON                         PIC X(30).             ERCACCT
   475     12  AM-ADDRS                          PIC X(30).             ERCACCT
   476     12  AM-CITY.
   477         16  AM-ADDR-CITY                  PIC X(28).
   478         16  AM-ADDR-STATE                 PIC XX.
   479     12  AM-ZIP.                                                  ERCACCT
   480         16  AM-ZIP-PRIME.                                        ERCACCT
   481             20  AM-ZIP-PRI-1ST            PIC X.                 ERCACCT
   482                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'. ERCACCT
   483             20  FILLER                    PIC X(4).              ERCACCT
   484         16  AM-ZIP-PLUS4                  PIC X(4).              ERCACCT
   485     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.              ERCACCT
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  15
* ECS150P.cbl (/apps/prod/cid1p/copy/ERCACCT)
   486         16  AM-CAN-POSTAL-1               PIC XXX.               ERCACCT
   487         16  AM-CAN-POSTAL-2               PIC XXX.               ERCACCT
   488         16  FILLER                        PIC XXX.               ERCACCT
   489     12  AM-TEL-NO.                                               ERCACCT
   490         16  AM-AREA-CODE                  PIC 999.               ERCACCT
   491         16  AM-TEL-PRE                    PIC 999.               ERCACCT
   492         16  AM-TEL-NBR                    PIC 9(4).              ERCACCT
   493     12  AM-TEL-LOC                        PIC X.                 ERCACCT
   494         88  AM-TEL-AT-HOME                   VALUE 'H'.          ERCACCT
   495         88  AM-TEL-AT-BUSINESS               VALUE 'B'.          ERCACCT
   496                                                                  ERCACCT
   497     12  AM-COMM-STRUCTURE.                                       ERCACCT
   498         16  AM-DEFN-1.                                           ERCACCT
   499             20  AM-AGT-COMMS       OCCURS 10 TIMES.              ERCACCT
   500                 24  AM-AGT.                                      ERCACCT
   501                     28  AM-AGT-PREFIX     PIC X(4).              ERCACCT
   502                     28  AM-AGT-PRIME      PIC X(6).              ERCACCT
   503                 24  AM-COM-TYP            PIC X.                 ERCACCT
   504                 24  AM-L-COM              PIC SV9(5)     COMP-3. ERCACCT
   505                 24  AM-J-COM              PIC SV9(5)     COMP-3. ERCACCT
   506                 24  AM-A-COM              PIC SV9(5)     COMP-3. ERCACCT
   507                 24  AM-RECALC-LV-INDIC    PIC X.                 ERCACCT
   508                 24  AM-RETRO-LV-INDIC     PIC X.                 ERCACCT
   509                 24  AM-GL-CODES           PIC X.                 ERCACCT
   510                 24  AM-COMM-CHARGEBACK    PIC 9(02).             ERCACCT
   511                 24  FILLER                PIC X(01).             ERCACCT
   512         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.                   ERCACCT
   513             20  AM-COM-TBLS        OCCURS 10 TIMES.              ERCACCT
   514                 24  FILLER                PIC X(11).             ERCACCT
   515                 24  AM-L-COMA             PIC XXX.               ERCACCT
   516                 24  AM-J-COMA             PIC XXX.               ERCACCT
   517                 24  AM-A-COMA             PIC XXX.               ERCACCT
   518                 24  FILLER                PIC X(6).              ERCACCT
   519                                                                  ERCACCT
   520     12  AM-COMM-CHANGE-STATUS             PIC X.                 ERCACCT
   521         88  AM-COMMISSIONS-CHANGED           VALUE '*'.          ERCACCT
   522                                                                  ERCACCT
   523     12  AM-CSR-CODE                       PIC X(4).              ERCACCT
   524                                                                  ERCACCT
   525     12  AM-BILLING-STATUS                 PIC X.                 ERCACCT
   526         88  AM-ACCOUNT-BILLED                VALUE 'B'.          ERCACCT
   527         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.          ERCACCT
   528     12  AM-AUTO-REFUND-SW                 PIC X.                 ERCACCT
   529         88  AUTO-REFUNDS-USED                VALUE 'Y'.          ERCACCT
   530         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.      ERCACCT
   531     12  AM-GPCD                           PIC 99.                ERCACCT
   532     12  AM-IG                             PIC X.                 ERCACCT
   533         88  AM-HAS-INDIVIDUAL                VALUE '1'.          ERCACCT
   534         88  AM-HAS-GROUP                     VALUE '2'.          ERCACCT
   535     12  AM-STATUS                         PIC X.                 ERCACCT
   536         88  AM-ACCOUNT-ACTIVE                VALUE '0'.          ERCACCT
   537         88  AM-ACCOUNT-INACTIVE              VALUE '1'.          ERCACCT
   538         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.          ERCACCT
   539         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
   540         88  AM-ACCOUNT-FROZEN                VALUE '4'.
   541         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
   542     12  AM-REMIT-TO                       PIC 99.                ERCACCT
   543     12  AM-ID-NO                          PIC X(11).             ERCACCT
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  16
* ECS150P.cbl (/apps/prod/cid1p/copy/ERCACCT)
   544                                                                  ERCACCT
   545     12  AM-CAL-TABLE                      PIC XX.                ERCACCT
   546     12  AM-LF-DEVIATION                   PIC XXX.               ERCACCT
   547     12  AM-AH-DEVIATION                   PIC XXX.               ERCACCT
   548     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3. ERCACCT
   549     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3. ERCACCT
   550     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3. ERCACCT
   551     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3. ERCACCT
   552     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3. ERCACCT
   553     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3. ERCACCT
   554                                                                  ERCACCT
   555     12  AM-USER-FIELDS.                                          ERCACCT
   556         16  AM-FLD-1                      PIC XX.                ERCACCT
   557         16  AM-FLD-2                      PIC XX.                ERCACCT
   558         16  AM-FLD-3                      PIC XX.                ERCACCT
   559         16  AM-FLD-4                      PIC XX.                ERCACCT
   560         16  AM-FLD-5                      PIC XX.                ERCACCT
   561                                                                  ERCACCT
   562     12  AM-1ST-PROD-DATE.                                        ERCACCT
   563         16  AM-1ST-PROD-YR                PIC XX.                ERCACCT
   564         16  AM-1ST-PROD-MO                PIC XX.                ERCACCT
   565         16  AM-1ST-PROD-DA                PIC XX.                ERCACCT
   566     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.     ERCACCT
   567     12  AM-CERTS-PURGED-DATE.                                    ERCACCT
   568         16  AM-PUR-YR                     PIC XX.                ERCACCT
   569         16  AM-PUR-MO                     PIC XX.                ERCACCT
   570         16  AM-PUR-DA                     PIC XX.                ERCACCT
   571     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.     ERCACCT
   572     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.     ERCACCT
   573     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.     ERCACCT
   574     12  AM-INACTIVE-DATE.                                        ERCACCT
   575         16  AM-INA-MO                     PIC 99.                ERCACCT
   576         16  AM-INA-DA                     PIC 99.                ERCACCT
   577         16  AM-INA-YR                     PIC 99.                ERCACCT
   578     12  AM-AR-HI-CERT-DATE                PIC XX.                ERCACCT
   579                                                                  ERCACCT
   580     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3. ERCACCT
   581     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3. ERCACCT
   582                                                                  ERCACCT
   583     12  AM-OB-PAYMENT-MODE                PIC X.                 ERCACCT
   584         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.      ERCACCT
   585         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.          ERCACCT
   586         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.          ERCACCT
   587         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.          ERCACCT
   588                                                                  ERCACCT
   589     12  AM-AH-ONLY-INDICATOR              PIC X.                 ERCACCT
   590         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.      ERCACCT
   591         88  AM-NO-AH-ONLY                    VALUE 'N'.          ERCACCT
   592                                                                  ERCACCT
   593     12  AM-EDIT-LOAN-OFC                  PIC X(01).             ERCACCT
   594                                                                  ERCACCT
   595     12  AM-OVER-SHORT.                                           ERCACCT
   596         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3. ERCACCT
   597         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3. ERCACCT
   598                                                                  ERCACCT
   599     12  AM-DCC-PRODUCT-CODE               PIC XXX.
   600     12  AM-DCC-CLP-STATE                  PIC XX.
   601                                                                  ERCACCT
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  17
* ECS150P.cbl (/apps/prod/cid1p/copy/ERCACCT)
   602     12  AM-RECALC-COMM                    PIC X.                 ERCACCT
   603     12  AM-RECALC-REIN                    PIC X.                 ERCACCT
   604                                                                  ERCACCT
   605     12  AM-REI-TABLE                      PIC XXX.               ERCACCT
   606     12  AM-REI-ET-LF                      PIC X.                 ERCACCT
   607     12  AM-REI-ET-AH                      PIC X.                 ERCACCT
   608     12  AM-REI-PE-LF                      PIC X.                 ERCACCT
   609     12  AM-REI-PE-AH                      PIC X.                 ERCACCT
   610     12  AM-REI-PRT-ST                     PIC X.                 ERCACCT
   611     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3. ERCACCT
   612     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3. ERCACCT
   613     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3. ERCACCT
   614     12  AM-REI-GROUP-A                    PIC X(6).              ERCACCT
   615     12  AM-REI-MORT                       PIC X(4).              ERCACCT
   616     12  AM-REI-PRT-OW                     PIC X.                 ERCACCT
   617     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3. ERCACCT
   618     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3. ERCACCT
   619     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3. ERCACCT
   620     12  AM-REI-GROUP-B                    PIC X(6).              ERCACCT
   621                                                                  ERCACCT
   622     12  AM-TRUST-TYPE                     PIC X(2).              ERCACCT
   623                                                                  ERCACCT
   624     12  AM-EMPLOYER-STMT-USED             PIC X.                 ERCACCT
   625     12  AM-GROUPED-CHECKS-Y-N             PIC X.                 ERCACCT
   626                                                                  ERCACCT
   627     12  AM-STD-AH-TYPE                    PIC XX.                ERCACCT
   628     12  AM-EARN-METHODS.                                         ERCACCT
   629         16  AM-EARN-METHOD-R              PIC X.                 ERCACCT
   630             88 AM-REF-RL-R78                 VALUE 'R'.          ERCACCT
   631             88 AM-REF-RL-PR                  VALUE 'P'.          ERCACCT
   632             88 AM-REF-RL-MEAN                VALUE 'M'.          ERCACCT
   633             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.          ERCACCT
   634         16  AM-EARN-METHOD-L              PIC X.                 ERCACCT
   635             88 AM-REF-LL-R78                 VALUE 'R'.          ERCACCT
   636             88 AM-REF-LL-PR                  VALUE 'P'.          ERCACCT
   637             88 AM-REF-LL-MEAN                VALUE 'M'.          ERCACCT
   638             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.          ERCACCT
   639         16  AM-EARN-METHOD-A              PIC X.                 ERCACCT
   640             88 AM-REF-AH-R78                 VALUE 'R'.          ERCACCT
   641             88 AM-REF-AH-PR                  VALUE 'P'.          ERCACCT
   642             88 AM-REF-AH-MEAN                VALUE 'M'.          ERCACCT
   643             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.          ERCACCT
   644             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.          ERCACCT
   645             88 AM-REF-AH-NET                 VALUE 'N'.          ERCACCT
   646                                                                  ERCACCT
   647     12  AM-TOL-PREM                       PIC S999V99    COMP-3. ERCACCT
   648     12  AM-TOL-REF                        PIC S999V99    COMP-3. ERCACCT
   649     12  AM-TOL-CLM                        PIC S999V99    COMP-3. ERCACCT
   650                                                                  ERCACCT
   651     12  AM-RET-Y-N                        PIC X.                 ERCACCT
   652     12  AM-RET-P-E                        PIC X.                 ERCACCT
   653     12  AM-LF-RET                         PIC S9V9999    COMP-3. ERCACCT
   654     12  AM-AH-RET                         PIC S9V9999    COMP-3. ERCACCT
   655     12  AM-RET-GRP                        PIC X(6).              ERCACCT
   656     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.                    ERCACCT
   657         16  AM-POOL-PRIME                 PIC XXX.               ERCACCT
   658         16  AM-POOL-SUB                   PIC XXX.               ERCACCT
   659     12  AM-RETRO-EARNINGS.                                       ERCACCT
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  18
* ECS150P.cbl (/apps/prod/cid1p/copy/ERCACCT)
   660         16  AM-RET-EARN-R                 PIC X.                 ERCACCT
   661         16  AM-RET-EARN-L                 PIC X.                 ERCACCT
   662         16  AM-RET-EARN-A                 PIC X.                 ERCACCT
   663     12  AM-RET-ST-TAX-USE                 PIC X.                 ERCACCT
   664         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.  ERCACCT
   665         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.      ERCACCT
   666     12  AM-RETRO-BEG-EARNINGS.                                   ERCACCT
   667         16  AM-RET-BEG-EARN-R             PIC X.                 ERCACCT
   668         16  AM-RET-BEG-EARN-L             PIC X.                 ERCACCT
   669         16  AM-RET-BEG-EARN-A             PIC X.                 ERCACCT
   670     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3. ERCACCT
   671     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3. ERCACCT
   672                                                                  ERCACCT
   673     12  AM-USER-SELECT-OPTIONS.                                  ERCACCT
   674         16  AM-USER-SELECT-1              PIC X(10).             ERCACCT
   675         16  AM-USER-SELECT-2              PIC X(10).             ERCACCT
   676         16  AM-USER-SELECT-3              PIC X(10).             ERCACCT
   677         16  AM-USER-SELECT-4              PIC X(10).             ERCACCT
   678         16  AM-USER-SELECT-5              PIC X(10).             ERCACCT
   679                                                                  ERCACCT
   680     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3. ERCACCT
   681                                                                  ERCACCT
   682     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3. ERCACCT
   683                                                                  ERCACCT
   684     12  AM-RPT045A-SWITCH                 PIC X.                 ERCACCT
   685         88  RPT045A-OFF                   VALUE 'N'.             ERCACCT
   686                                                                  ERCACCT
   687     12  AM-INSURANCE-LIMITS.                                     ERCACCT
   688         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3. ERCACCT
   689         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3. ERCACCT
   690                                                                  ERCACCT
   691     12  AM-PROFILE-CHANGE-SWITCH          PIC X.                 ERCACCT
   692         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.          ERCACCT
   693                                                                  ERCACCT
   694     12  AM-DISMBR-COVERAGE-SW             PIC X.                 ERCACCT
   695         88  AM-DISMBR-COVERAGE               VALUE 'Y'.          ERCACCT
   696         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.          ERCACCT
   697                                                                  ERCACCT
   698     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3. ERCACCT
   699                                                                  ERCACCT
   700     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3. ERCACCT
   701     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
   702     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
   703     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
   704     12  AM-DCC-UEF-STATE                  PIC XX.
   705     12  FILLER                            PIC XXX.
   706     12  AM-REPORT-CODE-3                  PIC X(10).
   707*    12  FILLER                            PIC X(22).             ERCACCT
   708                                                                  ERCACCT
   709     12  AM-RESERVE-DATE.                                         ERCACCT
   710         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.    ERCACCT
   711         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.    ERCACCT
   712         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.    ERCACCT
   713                                                                  ERCACCT
   714     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.                ERCACCT
   715     12  AM-NOTIFICATION-TYPES.                                   ERCACCT
   716         16  AM-NOTIF-OF-LETTERS           PIC X.                 ERCACCT
   717         16  AM-NOTIF-OF-PAYMENTS          PIC X.                 ERCACCT
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  19
* ECS150P.cbl (/apps/prod/cid1p/copy/ERCACCT)
   718         16  AM-NOTIF-OF-REPORTS           PIC X.                 ERCACCT
   719         16  AM-NOTIF-OF-STATUS            PIC X.                 ERCACCT
   720                                                                  ERCACCT
   721     12  AM-BENEFIT-TABLE-USAGE            PIC X.                 ERCACCT
   722         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.          ERCACCT
   723         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.          ERCACCT
   724         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.          ERCACCT
   725         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.     ERCACCT
   726                                                                  ERCACCT
   727     12  AM-BENEFIT-CONTROLS.                                     ERCACCT
   728         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.            ERCACCT
   729             20  AM-BENEFIT-CODE           PIC XX.                ERCACCT
   730             20  AM-BENEFIT-TYPE           PIC X.                 ERCACCT
   731             20  AM-BENEFIT-REVISION       PIC XXX.               ERCACCT
   732             20  AM-BENEFIT-REM-TERM       PIC X.                 ERCACCT
   733             20  AM-BENEFIT-RETRO-Y-N      PIC X.                 ERCACCT
   734             20  FILLER                    PIC XX.                ERCACCT
   735         16  FILLER                        PIC X(80).             ERCACCT
   736                                                                  ERCACCT
   737     12  AM-TRANSFER-DATA.                                        ERCACCT
   738         16  AM-TRANSFERRED-FROM.                                 ERCACCT
   739             20  AM-TRNFROM-CARRIER        PIC X.                 ERCACCT
   740             20  AM-TRNFROM-GROUPING.                             ERCACCT
   741                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.               ERCACCT
   742                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.               ERCACCT
   743             20  AM-TRNFROM-STATE          PIC XX.                ERCACCT
   744             20  AM-TRNFROM-ACCOUNT.                              ERCACCT
   745                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).             ERCACCT
   746                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).              ERCACCT
   747             20  AM-TRNFROM-DTE            PIC XX.                ERCACCT
   748         16  AM-TRANSFERRED-TO.                                   ERCACCT
   749             20  AM-TRNTO-CARRIER          PIC X.                 ERCACCT
   750             20  AM-TRNTO-GROUPING.                               ERCACCT
   751                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.               ERCACCT
   752                 24  AM-TRNTO-GRP-PRIME    PIC XXX.               ERCACCT
   753             20  AM-TRNTO-STATE            PIC XX.                ERCACCT
   754             20  AM-TRNTO-ACCOUNT.                                ERCACCT
   755                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).              ERCACCT
   756                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).              ERCACCT
   757             20  AM-TRNTO-DTE              PIC XX.                ERCACCT
   758         16  FILLER                        PIC X(10).             ERCACCT
   759                                                                  ERCACCT
   760     12  AM-SAVED-REMIT-TO                 PIC 99.                ERCACCT
   761                                                                  ERCACCT
   762     12  AM-COMM-STRUCTURE-SAVED.                                 ERCACCT
   763         16  AM-DEFN-1-SAVED.                                     ERCACCT
   764             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.           ERCACCT
   765                 24  AM-AGT-SV             PIC X(10).             ERCACCT
   766                 24  AM-COM-TYP-SV         PIC X.                 ERCACCT
   767                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3. ERCACCT
   768                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3. ERCACCT
   769                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3. ERCACCT
   770                 24  AM-RECALC-LV-INDIC-SV PIC X.                 ERCACCT
   771                 24  FILLER                PIC X.                 ERCACCT
   772                 24  AM-GL-CODES-SV        PIC X.                 ERCACCT
   773                 24  AM-COM-CHARGEBACK-SV  PIC 99.                ERCACCT
   774                 24  FILLER                PIC X.                 ERCACCT
   775         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.       ERCACCT
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  20
* ECS150P.cbl (/apps/prod/cid1p/copy/ERCACCT)
   776             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.            ERCACCT
   777                 24  FILLER                PIC X(11).             ERCACCT
   778                 24  AM-L-COMA-SV          PIC XXX.               ERCACCT
   779                 24  AM-J-COMA-SV          PIC XXX.               ERCACCT
   780                 24  AM-A-COMA-SV          PIC XXX.               ERCACCT
   781                 24  FILLER                PIC X(6).              ERCACCT
   782                                                                  ERCACCT
   783     12  AM-FLC-NET-PREMIUM-ALLOWANCE.                            ERCACCT
   784         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.                 ERCACCT
   785            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3. ERCACCT
   786            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3. ERCACCT
   787            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3. ERCACCT
   788                                                                  ERCACCT
   789     12  AM-ORIG-DEALER-NO                 PIC X(10).             ERCACCT
   790     12  FILLER                            PIC X(120).            ERCACCT
   791                                                                  ERCACCT
   792     12  AM-ACCOUNT-EXECUTIVE-DATA.                               ERCACCT
   793         16  AM-CONTROL-NAME               PIC X(30).             ERCACCT
   794         16  AM-EXECUTIVE-ONE.                                    ERCACCT
   795             20  AM-EXEC1-NAME             PIC X(15).             ERCACCT
   796             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)       ERCACCT
   797                                                          COMP-3. ERCACCT
   798             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)       ERCACCT
   799                                                          COMP-3. ERCACCT
   800         16  AM-EXECUTIVE-TWO.                                    ERCACCT
   801             20  AM-EXEC2-NAME             PIC X(15).             ERCACCT
   802             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)       ERCACCT
   803                                                          COMP-3. ERCACCT
   804             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)       ERCACCT
   805                                                          COMP-3. ERCACCT
   806                                                                  ERCACCT
   807     12  AM-RETRO-ADDITIONAL-DATA.                                ERCACCT
   808         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3. ERCACCT
   809         16  AM-RETRO-PREM-P-E             PIC X.                 ERCACCT
   810         16  AM-RETRO-CLMS-P-I             PIC X.                 ERCACCT
   811         16  AM-RETRO-RET-BRACKET-LF.                             ERCACCT
   812             20  AM-RETRO-RET-METHOD-LF    PIC X.                 ERCACCT
   813                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.      ERCACCT
   814                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.          ERCACCT
   815             20  AM-RETRO-RET-BASIS-LF     PIC X.                 ERCACCT
   816                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.      ERCACCT
   817                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.          ERCACCT
   818             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.           ERCACCT
   819                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3. ERCACCT
   820                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3. ERCACCT
   821         16  AM-RETRO-RET-BRACKET-AH.                             ERCACCT
   822             20  AM-RETRO-RET-METHOD-AH    PIC X.                 ERCACCT
   823                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.      ERCACCT
   824                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.          ERCACCT
   825                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.          ERCACCT
   826             20  AM-RETRO-RET-BASIS-AH     PIC X.                 ERCACCT
   827                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.      ERCACCT
   828                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.          ERCACCT
   829             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.           ERCACCT
   830                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3. ERCACCT
   831                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3. ERCACCT
   832                                                                  ERCACCT
   833     12  AM-COMMENTS.                                             ERCACCT
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  21
* ECS150P.cbl (/apps/prod/cid1p/copy/ERCACCT)
   834         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.ERCACCT
   835                                                                  ERCACCT
   836     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.         ERCACCT
   837         16  AM-FLI-RETRO-SHARE-CODE       PIC X.                 ERCACCT
   838         16  AM-FLI-BILLING-CODE           PIC X.                 ERCACCT
   839         16  AM-FLI-ALT-STATE-CODE         PIC XX.                ERCACCT
   840         16  AM-FLI-UNITED-IDENT           PIC X.                 ERCACCT
   841         16  AM-FLI-INTEREST-LOST-DATA.                           ERCACCT
   842             20  AM-FLI-BANK-NO            PIC X(5).              ERCACCT
   843             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3. ERCACCT
   844             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3. ERCACCT
   845             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3. ERCACCT
   846         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.            ERCACCT
   847             20  AM-FLI-AGT                PIC X(9).              ERCACCT
   848             20  AM-FLI-AGT-COMM-ACC       PIC X.                 ERCACCT
   849             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3. ERCACCT
   850         16  FILLER                        PIC X(102).            ERCACCT
   851                                                                  ERCACCT
   852     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.         ERCACCT
   853         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.          ERCACCT
   854             20  AM-BENEFIT-DMD-CODE         PIC XX.              ERCACCT
   855             20  AM-BENEFIT-DMD-TYPE         PIC X.               ERCACCT
   856             20  AM-BENEFIT-DMD-REVISION     PIC XXX.             ERCACCT
   857             20  AM-BENEFIT-DMD-REM-TERM     PIC X.               ERCACCT
   858             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.               ERCACCT
   859         16  FILLER                          PIC X(10).           ERCACCT
   860******************************************************************ERCACCT
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  22
* ECS150P.cbl
   862 FD  REINS-EXTRACT-1
   863     BLOCK CONTAINS 0 RECORDS
   864     RECORDING MODE IS F.
   865*    RECORD CONTAINS 210 CHARACTERS
   866
   867 01  RC-REC-1.
   868     12  RC-CONTRAL-1        PIC  X(210).
   869
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  23
* ECS150P.cbl
   871 FD  DISK-DATE
*  872                             COPY ELCDTEFD.
   873******************************************************************04/15/98
   874*                                                                *ELCDTEFD
   875*                                                                *ELCDTEFD
   876*                            ELCDTEFD.                           *   LV002
   877*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
   878*                            VMOD=2.007                          *   CL**2
   879*                                                                *ELCDTEFD
   880******************************************************************ELCDTEFD
   881     BLOCK CONTAINS 0 RECORDS
   882     RECORDING MODE F.                                            ELCDTEFD
   883                                                                  ELCDTEFD
   884 01  DATE-DISK.                                                   ELCDTEFD
   885     12  DD-ID                       PIC  X(4).                   ELCDTEFD
   886     12  FILLER                      PIC  X(14).                  ELCDTEFD
   887     12  DD-CR1                      PIC  9.                      ELCDTEFD
   888     12  DD-CR1N                     PIC  X(30).                  ELCDTEFD
   889     12  DD-CR2                      PIC  9.                      ELCDTEFD
   890     12  DD-CR2N                     PIC  X(30).                  ELCDTEFD
   891     12  FILLER                      PIC  X(20).                  ELCDTEFD
   892                                                                  ELCDTEFD
   893 01  DATE-DISK-R.                                                 ELCDTEFD
   894     12  FILLER                      PIC  X(4).                   ELCDTEFD
   895     12  DD-ST           OCCURS 3 TIMES                           ELCDTEFD
   896                                     PIC  X(32).                  ELCDTEFD
   897                                                                  ELCDTEFD
   898 01  DATE-DISK-T.                                                 ELCDTEFD
   899     12  FILLER                      PIC  X(4).                   ELCDTEFD
   900     12  DD-TYPE         OCCURS 2 TIMES                           ELCDTEFD
   901                                     PIC  X(48).                  ELCDTEFD
   902                                                                  ELCDTEFD
   903 01  DATE-DISK-M.                                                 ELCDTEFD
   904     12  FILLER                      PIC  X(4).                   ELCDTEFD
   905     12  DD-MORT         OCCURS 2 TIMES                           ELCDTEFD
   906                                     PIC  X(48).                  ELCDTEFD
   907                                                                  ELCDTEFD
   908 01  DATE-DISK-P.                                                 ELCDTEFD
   909     12  DD-IDA                      PIC  XX.                     ELCDTEFD
   910     12  DD-IDX                      PIC  99.                     ELCDTEFD
   911     12  DD-DATA                     PIC  X(96).                  ELCDTEFD
   912     12  FILLER  REDEFINES DD-DATA.                               ELCDTEFD
   913         16  DD-PS-PIC   OCCURS 50 TIMES                          ELCDTEFD
   914                                     PIC  X.                      ELCDTEFD
   915         16  FILLER                  PIC  X(46).                  ELCDTEFD
   916     12  FILLER  REDEFINES DD-DATA.                               ELCDTEFD
   917         16  DD-PS-PICO  OCCURS 20 TIMES.                         ELCDTEFD
   918             20  DD-PS-PRT           PIC  X.                      ELCDTEFD
   919             20  DD-PS-FMT           PIC  X.                      ELCDTEFD
   920             20  DD-PS-PRC           PIC  X.                      ELCDTEFD
   921             20  DD-PS-TOT           PIC  X.                      ELCDTEFD
   922         16  FILLER                  PIC  X(16).                  ELCDTEFD
   923                                                                  ELCDTEFD
   924 01  DATE-DISK-E.                                                 ELCDTEFD
   925     12  FILLER                      PIC  X(4).                   ELCDTEFD
   926     12  DD-EDIT         OCCURS 24 TIMES                          ELCDTEFD
   927                                     PIC  X(4).                   ELCDTEFD
   928                                                                  ELCDTEFD
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  24
* ECS150P.cbl (/apps/prod/cid1p/copy/ELCDTEFD)
   929 01  DATE-DISK-C.                                                 ELCDTEFD
   930     12  FILLER                      PIC  X(7).                   ELCDTEFD
   931     12  DD-CARR1-SECPAY-SW          PIC  X.
   932     12  DD-CARR1-UEP-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   933     12  DD-CARR1-R78-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   934     12  DD-CARR1-PRO-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   935     12  DD-CARR1                    PIC  X.                      ELCDTEFD
   936     12  DD-CARR1S                   PIC  XX.                     ELCDTEFD
   937     12  DD-CARR1N                   PIC  X(30).                  ELCDTEFD
   938     12  DD-CARR2                    PIC  X.                      ELCDTEFD
   939     12  DD-CARR2S                   PIC  XX.                     ELCDTEFD
   940     12  DD-CARR2N                   PIC  X(30).                  ELCDTEFD
   941     12  DD-CARR2-UEP-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   942     12  DD-CARR2-R78-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   943     12  DD-CARR2-PRO-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   944     12  DD-CARR2-SECPAY-SW          PIC  X.
   945     12  FILLER                      PIC  X(7).                   ELCDTEFD
   946                                                                  ELCDTEFD
   947 01  DATE-DISK-OPT.                                               ELCDTEFD
   948     12  FILLER                      PIC  X(04).                  ELCDTEFD
   949     12  DD-TLR-DATA.                                             ELCDTEFD
   950         16  DD-TLR                  OCCURS 32 TIMES              ELCDTEFD
   951                                     PIC  X(03).                  ELCDTEFD
   952     12  DD-STATE-DATA REDEFINES DD-TLR-DATA.                     ELCDTEFD
   953         16  DD-STATE-FLDS           OCCURS 16 TIMES              ELCDTEFD
   954                                     PIC  X(06).                  ELCDTEFD
   955     12  DD-CARR-DATA REDEFINES DD-TLR-DATA.                      ELCDTEFD
   956         16  DD-CARR-FLDS            OCCURS 13 TIMES              ELCDTEFD
   957                                     PIC  X(07).                  ELCDTEFD
   958         16  FILLER                  PIC  X(05).                  ELCDTEFD
   959     12  DD-MISC-DATA REDEFINES DD-TLR-DATA                       ELCDTEFD
   960                                     PIC  X(96).                  ELCDTEFD
   961******************************************************************ELCDTEFD
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  25
* ECS150P.cbl
   963 FD  FICH
   964     RECORDING MODE IS F.
   965
   966 01  FICH-REC                PIC X(133).
   967
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  26
* ECS150P.cbl
   969 FD  CLAS150-A-EXTRACT
   970     BLOCK CONTAINS 0 RECORDS
   971     RECORDING MODE IS F.
   972*    RECORD CONTAINS 2701 CHARACTERS
   973*
   974*  THIS EXTRACT FILE CONTAINS THE RECORDS
   975*  NEEDED TO PRINT THE CERTIFICATE ACTIVITY AND EXHIBIT
   976*  REPORT FOR THE 1ST INSURANCE COMPANY
   977*
   978*          ** RECORD TYPE AND SORT KEY DESCRIPTION **
   979******** SORT KEY ***************   ******** USAGE *********
   980*TYPE*CARR*COMP*STATE*ACCT*STATE*
   981* 01 * X  *  X *  X  * X  * LV  * - ACCT TOTAL-1ST INS.
   982* 02 * X  *  X *  X  * X  * LV  * - ACCT TOTAL-REINS
   983* 03 * X  *  X *  X  * HV * LV  * - ST TOT-1ST INS
   984* 04 * X  *  X *  X  * HV * LV  * - ST TOT-REINS
   985* 05 * X  *  X *  HV * HV * LV  * - ST TOT-1ST,ACCUM FOR CO TOTAL
   986* 06 * X  *  X *  HV * HV * LV  * - ST TOT-REINS,ACCUM FOR CO TOT
   987* 07 * X  * HV *  X  * HV * LV  * - ST TOT-1ST,ACCUM FOR ST/CARR
   988* 08 * X  * HV *  X  * HV * LV  * - ST TOT-REIN,ACCUM FOR ST/CARR
   989* 09 * X  * HV *  HV * HV * LV  * - ST TOT-1ST,ACCUM FOR CARR TOT
   990* 10 * X  * HV *  HV * HV * LV  * - ST TOT-REIN,ACCUM FOR CARR TOT
   991* 11 * HV * HV *  HV * HV * LV  * - ST TOT-1ST,ACCUM FOR GRND TOT
   992* 12 * HV * HV *  HV * HV * LV  * - ST TOT-REIN,ACCUM FOR GRND TOT
   993* 13 * HV * HV *  HV * HV *  X  * - ST TOT-1ST,ACCUM FOR ST TOTAL
   994* 14 * HV * HV *  HV * HV *  X  * - ST TOT-REIN,ACCUM FOR ST TOTAL
   995*
   996* X-INDICATES FIELD INITIALIZED WITH ACTUAL VALUE
   997* LV - INDICATES FIELD WILL CONTAIN LOW-VALUE
   998* HV - INDICATES FIELD WILL CONTAIN HIGH-VALUE
   999*
  1000***NOTE - FIELD ER-REINS-CO IS SET TO LOW-VALUE FOR ALL RECORDS
  1001*         IN THIS FILE SINCE IT IS NOT USED FOR THIS REPORT
  1002
  1003 01  CLAS150-EXTRACT-RECORD-A    PIC X(2701).
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  27
* ECS150P.cbl
  1005 FD  CLAS150-B-EXTRACT
  1006     BLOCK CONTAINS 0 RECORDS
  1007     RECORDING MODE IS F.
  1008*    RECORD CONTAINS 2701 CHARACTERS
  1009*
  1010*  THIS FILE CONTAINS THE RECORDS NEEDED TO
  1011*  PRINT THE CERTIFICATE ACTIVITY AND EXHIBIT
  1012*  REPORT FOR THE REINSURANCE COMPANY WITH THE
  1013*  EXCEPTION OF OVER STATE TOTALS.
  1014*
  1015*          ** RECORD TYPE AND SORT KEY DESCRIPTION **
  1016******* SORT KEY *********
  1017*RE-CO*CARR*COMP*STATE*ACCT*STATE*TYPE*
  1018*  X  * X  *  X *  X  * X  * LV  * 15 *   ACCT TOTAL
  1019*  X  * X  *  X *  X  * LV * LV  * 16 *   STATE TOTAL
  1020*  X  * X  *  X *  LV * LV * LV  * 17 *   COMPANY TOTAL
  1021*  X  * X  * LV *  LV * LV * LV  * 18 *   CARRIER TOTAL
  1022*  X  * LV * LV *  LV * LV * LV  * 19 *   REINS CO TOTAL
  1023*     *    *    *     *    *     *    *
  1024* X= INITIALIZED TO ACTUAL VALUE       * TOTAL RECORD TYPE 19
  1025* LV = INITIALIZED TO LOW-VALUE          FOR GRAND TOTALS
  1026
  1027 01  CLAS150-EXTRACT-RECORD-B    PIC X(2701).
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  28
* ECS150P.cbl
  1029 FD  CLAS150-C-EXTRACT
  1030     BLOCK CONTAINS 0 RECORDS
  1031     RECORDING MODE IS F.
  1032*    RECORD CONTAINS 2701 CHARACTERS
  1033*
  1034*    THIS FILE CONTAINS THE RECORDS NEEDED TO PRINT
  1035*    THE REINSURANCE COMPANY - CERTIFICATE AND EXHIBIT
  1036*    REPORT - AT THE STATE LEVEL.
  1037*
  1038*    ALL RECORDS IN THIS FILE ARE TYPE 20
  1039*    ALL CONTROL FIELDS IN THE SORT KEY ARE SET TO
  1040*     LOW-VALUE WITH THE EXCEPTION OF THE STATE AND TYPE
  1041*     FIELDS.
  1042*
  1043*
  1044
  1045 01  CLAS150-EXTRACT-RECORD-C    PIC X(2701).
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  29
* ECS150P.cbl
  1047 WORKING-STORAGE SECTION.
  1048 01  LCP-ABND-CODE                 PIC S999 COMP VALUE +519.
  1049 77  FILLER  PIC X(32) VALUE '********************************'.
  1050 77  FILLER  PIC X(32) VALUE '     ECS150 WORKING STORAGE     '.
  1051 77  FILLER  PIC X(32) VALUE '******* VMOD=2.029 *************'.
  1052
  1053
  1054 77  LINE-CNT                PIC S9(3)      COMP-3 VALUE +56.
  1055 77  FACTOR-C                PIC S9(3)      COMP-3 VALUE +0.
  1056 77  MINUS-CNT               PIC S9(3)      COMP-3 VALUE +0.
  1057 77  PAGE-CNT                PIC S9(5)      COMP-3 VALUE +0.
  1058 77  EXPIRED-MONTHS          PIC S9(5)      COMP-3 VALUE +0.
  1059 77  UNEXPIRED-MONTHS        PIC S9(3)V99   COMP-3 VALUE +0.
  1060 77  HOLD-PREV-UNEXP         PIC S9(5)      COMP-3 VALUE +0.
  1061 77  HOLD-PREV-EXP           PIC S9(5)      COMP-3 VALUE +0.
  1062 77  HOLD-END-UNEXP          PIC S9(5)      COMP-3 VALUE +0.
  1063 77  HOLD-END-EXP            PIC S9(5)      COMP-3 VALUE +0.
  1064 77  TERM-WORK               PIC S9(5)      COMP-3 VALUE +0.
  1065 77  REINS-REC-CNT           PIC S9(7)      COMP-3 VALUE +0.
  1066 77  EXB-CNT                 PIC S9(7)      COMP-3 VALUE ZERO.
  1067 77  FACTOR-A                PIC S9(4)V9(11) COMP-3 VALUE +0.
  1068 77  FACTOR-B                PIC S9(4)V9(11) COMP-3 VALUE +0.
  1069 77  WS-TOTAL-FACE-AMT       PIC S9(7)V99   COMP-3 VALUE +0.
  1070 77  UNEARNED-AMT-LF         PIC S9(7)V99   COMP-3 VALUE +0.
  1071 77  UNEARNED-AMT-AH         PIC S9(7)V99   COMP-3 VALUE +0.
  1072 77  SUMMARY-AMT-LF          PIC S9(9)V99   COMP-3 VALUE +0.
  1073 77  SUMMARY-AMT-AH          PIC S9(9)V99   COMP-3 VALUE +0.
  1074 77  MINUS-AMT               PIC S9(7)V99   COMP-3 VALUE +0.
  1075 77  TEMP-RESULT             PIC S9(9)V99   COMP-3 VALUE +0.
  1076 77  SAVE-BGN-INFORCE        PIC S9(9)V99   COMP-3 VALUE +0.
  1077 77  SAVE-END-INFORCE        PIC S9(9)V99   COMP-3 VALUE +0.
  1078 77  TEMP-RESULT-L           PIC S9(9)V9(6) COMP-3 VALUE +0.
  1079 77  SAVE-REM-TERM           PIC S9(3)V99   COMP-3 VALUE +0.
  1080 77  X                       PIC X                 VALUE SPACE.
  1081 77  ERRTBL-FILE-STATUS      PIC XX              VALUE '00'.
  1082 77  ACCT-FILE-STATUS        PIC XX              VALUE '00'.
  1083
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  30
* ECS150P.cbl
  1085 01  WORK-AREAS.
  1086     12  sub3                       pic s9(5) value +0 comp-3.
  1087     12  WS-ZERO                    PIC S9     VALUE +0 COMP-3.
  1088     12  WS-RETURN-CODE             PIC S9(4)  VALUE +0 COMP-3.
  1089     12  WS-ABEND-MESSAGE           PIC X(80)  VALUE SPACES.
  1090     12  WS-ABEND-FILE-STATUS       PIC XX     VALUE ZERO.
  1091     12  INTERIM-YR                 PIC 99     VALUE 0.
  1092     12  WS-931231                  PIC XX     VALUE X'8CFF'.
  1093     12  WS-CR-DIS-CCYY             PIC 9(04)  VALUE 0.
  1094     12  WS-CR-CCYY                 PIC 9(04)  VALUE 0.
  1095
  1096 01  FILLER PIC X(16)  VALUE 'CONTROL SWITCHES'.
  1097 01  PROGRAM-CNTRL-SWITCHES.
  1098     12  PASS-TYPE           PIC 9               VALUE 0.
  1099         88  FIRST-INS-PASS                      VALUE 0.
  1100         88  REINSURANCE-PASS                    VALUE 1.
  1101     12  INFORCE-CNT-SW      PIC 9               VALUE 0.
  1102     12  RECORD-TYPE-SW      PIC 9               VALUE 0.
  1103         88  FIRST-INS-REC                       VALUE 0.
  1104         88  REINSURANCE-REC                     VALUE 1.
  1105     12  EFFECTIVE-CONTROL   PIC 9               VALUE 0.
  1106         88  EFFECTIVE-LAST-PER                  VALUE 1.
  1107         88  EFFECTIVE-THIS-PER                  VALUE 2.
  1108         88  EFFECTIVE-BOTH-PER                  VALUE 3.
  1109     12  CERT-STATUS         PIC 9               VALUE 0.
  1110         88  CERT-ACTIVE                         VALUE 0.
  1111         88  CERT-CANCELLED                      VALUE 1.
  1112         88  CERT-CLAIM                          VALUE 2.
  1113         88  LUMP-SUM                            VALUE 3.
  1114         88  CLAIM-OR-CANCEL                     VALUE 1 2 3.
  1115     12  REINSURANCE-FOUND   PIC 9               VALUE 0.
  1116         88  NO-REINSURANCE                      VALUE 0.
  1117     12  OB-SW               PIC 9               VALUE 0.
  1118         88  OB-COVERAGE                         VALUE 1.
  1119     12  SUMMARY-SW          PIC 9               VALUE 0.
  1120         88  SUMMARY-REC                         VALUE 1.
  1121     12  COUNT-CNTRL         PIC 9               VALUE 0.
  1122         88  ALREADY-COUNTED                     VALUE 1.
  1123     12  NEW-IN-EFFECT       PIC 9               VALUE 0.
  1124         88  ENTERED-THIS-PERIOD                 VALUE 1.
  1125     12  OLD-IN-EFFECT       PIC 9               VALUE 0.
  1126         88  ENTERED-PREV-PERIOD                 VALUE 1.
  1127     12  PRINT-CNTRL         PIC 9               VALUE 0.
  1128         88  FIRST-DETAIL-DONE                   VALUE 1.
  1129     12  INS-TYPE-SW         PIC 9               VALUE 0.
  1130         88  INDIVIDUAL-INS                      VALUE 1.
  1131         88  GROUP-INS                           VALUE 2.
  1132     12  LIFE-INS-SW         PIC 9               VALUE 0.
  1133         88  LEVEL-LIFE                          VALUE 1.
  1134         88  REDUCING-LIFE                       VALUE 2.
  1135     12  CANCEL-SW           PIC 9               VALUE 0.
  1136         88  CURRENT-CANCEL-ONLY                 VALUE 1.
  1137     12  CLAIM-SW            PIC 9               VALUE 0.
  1138         88  CURRENT-CLAIM-ONLY                  VALUE 1.
  1139     12  REINS-FILE-SW       PIC 9               VALUE 0.
  1140         88  REINS-FILE-CLOSED                   VALUE 0.
  1141         88  REINS-FILE-OPEN                     VALUE 1.
  1142     12  TEXAS-REG-SW        PIC 9               VALUE 0.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  31
* ECS150P.cbl
  1143         88  TEXAS-CERT                          VALUE 1.
  1144     12  NET-PAY-SW          PIC 9               VALUE 0.
  1145         88  NET-PAY-CERT                        VALUE 1.
  1146 01  FILLER PIC X(16)  VALUE 'PRINT   SWITCHES'.
  1147 01  PRINT-SWITCHES.
  1148     12  LF-REFUND-SW        PIC 9               VALUE 0.
  1149         88 PRT-LF-REFUND                        VALUE 1.
  1150     12  AH-REFUND-SW        PIC 9               VALUE 0.
  1151         88 PRT-AH-REFUND                        VALUE 1.
  1152     12  LF-ISSUE            PIC 9               VALUE 0.
  1153         88 PRT-LF-ISSUE                         VALUE 1.
  1154     12  LF-CANC             PIC 9               VALUE 0.
  1155         88 PRT-LF-CANC                          VALUE 1.
  1156     12  LF-DEATH            PIC 9               VALUE 0.
  1157         88 PRT-LF-DEATH                         VALUE 1.
  1158     12  LF-EXPIRY           PIC 9               VALUE 0.
  1159         88 PRT-LF-EXPIRY                        VALUE 1.
  1160     12  LF-DECR             PIC 9               VALUE 0.
  1161         88 PRT-LF-DECR                          VALUE 1.
  1162     12  LF-INCR             PIC 9               VALUE 0.
  1163         88 PRT-LF-INCR                          VALUE 1.
  1164     12  LF-LUMP             PIC 9               VALUE 0.
  1165         88 PRT-LF-LUMP                          VALUE 1.
  1166     12  AH-ISSUE            PIC 9               VALUE 0.
  1167         88 PRT-AH-ISSUE                         VALUE 1.
  1168     12  AH-CANC             PIC 9               VALUE 0.
  1169         88 PRT-AH-CANC                          VALUE 1.
  1170     12  AH-CLAIM            PIC 9               VALUE 0.
  1171         88 PRT-AH-CLAIM                         VALUE 1.
  1172 01  PRINT-AMOUNTS.
  1173     12  PRT-ISSUE-AMT-LF    PIC S9(11)V99 COMP-3   VALUE ZERO.
  1174     12  PRT-CANC-AMT-LF     PIC S9(11)V99 COMP-3   VALUE ZERO.
  1175     12  PRT-DEATH-AMT-LF    PIC S9(11)V99 COMP-3   VALUE ZERO.
  1176     12  PRT-EXPIRY-AMT-LF   PIC S9(11)V99 COMP-3   VALUE ZERO.
  1177     12  PRT-DECR-AMT-LF     PIC S9(11)V99 COMP-3   VALUE ZERO.
  1178     12  PRT-INCR-AMT-LF     PIC S9(11)V99 COMP-3   VALUE ZERO.
  1179     12  PRT-ISSUE-AMT-AH    PIC S9(11)V99 COMP-3   VALUE ZERO.
  1180     12  PRT-CANC-AMT-AH     PIC S9(11)V99 COMP-3   VALUE ZERO.
  1181     12  PRT-CLAIM-AMT-AH    PIC S9(11)V99 COMP-3   VALUE ZERO.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  32
* ECS150P.cbl
  1183 01  RC-REC.
  1184     12  RC-CONTROL.
  1185         16  RC-COMP            PIC X(6).
  1186         16  RC-CMCTL.
  1187             20  RC-CNTRL-1     PIC X(19).
  1188             20  RC-CNTRL-2     PIC X(17).
  1189     12  RC-ENTRY-STATUS        PIC X.
  1190     12  RC-LFTYP               PIC XX.
  1191     12  RC-LF-TERM             PIC S9(3)       COMP-3.
  1192     12  RC-LFAMT               PIC S9(9)V99    COMP-3.
  1193     12  RC-LFPRM               PIC S9(7)V99    COMP-3.
  1194     12  RC-LFRFND              PIC S9(7)V99    COMP-3.
  1195     12  RC-LF-CANCEL-STATUS    PIC X.
  1196     12  RC-LF-CLAIM-STATUS     PIC X.
  1197     12  RC-LF-CURRENT-STATUS   PIC X.
  1198     12  RC-AHTYP               PIC XX.
  1199     12  RC-AH-TERM             PIC S9(3)       COMP-3.
  1200     12  RC-AHAMT               PIC S9(7)V99    COMP-3.
  1201     12  RC-AHPRM               PIC S9(7)V99    COMP-3.
  1202     12  RC-AHRFND              PIC S9(7)V99    COMP-3.
  1203     12  RC-AH-CANCEL-STATUS    PIC X.
  1204     12  RC-AH-CLAIM-STATUS     PIC X.
  1205     12  RC-AH-CURRENT-STATUS   PIC X.
  1206     12  RC-DTHAMT              PIC S9(9)V99    COMP-3.
  1207     12  RC-DISAMT              PIC S9(9)V99    COMP-3.
  1208     12  RC-IND-GRP             PIC X.
  1209     12  RC-LF-CANC-DT          PIC 9(11)       COMP-3.
  1210     12  RC-AH-CANC-DT          PIC 9(11)       COMP-3.
  1211     12  RC-DIS-DT              PIC 9(11)       COMP-3.
  1212     12  RC-ENT-DT              PIC 9(11)       COMP-3.
  1213     12  RC-LF-CANC-EXIT        PIC 9(11)       COMP-3.
  1214     12  RC-AH-CANC-EXIT        PIC 9(11)       COMP-3.
  1215     12  RC-LF-CLAIM-EXIT       PIC 9(11)       COMP-3.
  1216     12  RC-AH-CLAIM-EXIT       PIC 9(11)       COMP-3.
  1217     12  RC-PMT-FREQ            PIC 9(2).
  1218     12  RC-APR                 PIC S9(3)V9(4)  COMP-3.
  1219     12  RC-LOAN-TERM           PIC S9(3)       COMP-3.
  1220     12  RC-I-LIVES             PIC S9(3)       COMP-3.
  1221     12  RC-C-LIVES-YTD         PIC S9(3)       COMP-3.
  1222     12  RC-C-LIVES-ITD         PIC S9(3)       COMP-3.
  1223     12  RC-LFRFND-YTD          PIC S9(7)V99    COMP-3.
  1224     12  RC-AHRFND-YTD          PIC S9(7)V99    COMP-3.
  1225     12  RC-LF-TERM-IN-DAYS     PIC S9(5)       COMP-3.
  1226     12  RC-LF-EXPIRE-DT        PIC 9(11)       COMP-3.
  1227     12  RC-AH-EXPIRE-DT        PIC 9(11)       COMP-3.
  1228     12  RC-LOAN-1ST-PMT-DT     PIC 9(6).
  1229     12  RC-ORIG-LFAMT          PIC S9(9)V99    COMP-3.
  1230     12  RC-LFAMT-ALT           PIC S9(9)V99    COMP-3.
  1231     12  RC-CEDE-FACT           PIC S9(1)V9(4)  COMP-3.
  1232     12  FILLER                 PIC X.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  33
* ECS150P.cbl
  1234 01  PROCESSING-CONTROL-DATES.
  1235     12  PERIOD-START        PIC XX.
  1236     12  PERIOD-START-9      PIC S9(5)    COMP-3.
  1237     12  PERIOD-END          PIC XX.
  1238     12  PERIOD-END-9        PIC S9(5)    COMP-3.
  1239     12  CERT-EFFECT-DT      PIC XX.
  1240     12  FIRST-PAY-DT        PIC XX.
  1241     12  CERT-EXPIRE-DATE    PIC XX.
  1242     12  CERT-EXPIRE-DATE-O  PIC XX.
  1243     12  CANCEL-EXIT-DATE    PIC XX.
  1244     12  CLAIM-EXIT-DATE     PIC XX.
  1245     12  VALUATION-DATE      PIC S9(5)    COMP-3.
  1246     12  CERT-ENTRY-DATE     PIC XX.
  1247     12  LOW-EXIT-DATE       PIC XX.
  1248     12  SUM-CANCEL-DATE     PIC XX.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  34
* ECS150P.cbl
  1250 01  SAVE-CONTROL-BREAKS                         VALUE SPACES.
  1251     12  LAST-REINS-CO       PIC X(6).
  1252     12  SAVE-CNTRL-GRP.
  1253         16  LAST-CARRIER    PIC X.
  1254         16  LAST-GROUPING   PIC X(6).
  1255         16  LAST-STATE      PIC XX.
  1256         16  LAST-ACCOUNT    PIC X(10).
  1257
  1258 01  SAVE-EXP-DT.
  1259     12  SE-YR             PIC 99.
  1260     12  SE-MO             PIC 99.
  1261     12  SE-DA             PIC 99.
  1262
  1263 01  REMAINING-TERM-WORK-FIELDS.
  1264     12  BGN-DT.
  1265         16  BGN-YR          PIC 99.
  1266         16  BGN-MO          PIC 99.
  1267         16  BGN-DA          PIC 99.
  1268     12  END-DT.
  1269         16  END-YR          PIC 99.
  1270         16  END-MO          PIC 99.
  1271         16  END-DA          PIC 99.
  1272     12  TEMP-1              PIC S9(9)V9(7)  COMP-3 VALUE +0.
  1273     12  TEMP-2              PIC S9(9)V9(7)  COMP-3 VALUE +0.
  1274     12  TEMP-3              PIC S9(9)V9(7)  COMP-3 VALUE +0.
  1275     12  TEMP-4              PIC S9V9(8)     COMP-3 VALUE +0.
  1276     12  TEMP-5              PIC S9V9(8)     COMP-3 VALUE +0.
  1277     12  LF-REM-TRM          PIC S9(3)V99    COMP-3 VALUE +0.
  1278     12  AH-REM-TRM          PIC S9(3)V99    COMP-3 VALUE +0.
  1279     12  LF-BAL-REMTRM       PIC S9(3)V99    COMP-3 VALUE +0.
  1280     12  REM-TRM1            PIC S9(3)V99    COMP-3 VALUE +0.
  1281     12  REM-TRM2            PIC S9(3)V99    COMP-3 VALUE +0.
  1282     12  TEM-TRM1            PIC S9(3)V99    COMP-3 VALUE +0.
  1283     12  HLD-TRM             PIC S9(3)V99    COMP-3 VALUE +0.
  1284     12  RUN-DATE-BIN        PIC XX.
  1285     12  EP-DT-BIN           PIC XX.
  1286     12  WS-CR-BIN-DATE      PIC XX.
  1287
  1288 01  TEXAS-REG-WORK-AREAS.
  1289     12  TEX-FACT-1          PIC S9(7)V99    COMP-3.
  1290     12  TEX-FACT-2          PIC S9(3)       COMP-3.
  1291     12  TEX-FACT-3          PIC S9(3)       COMP-3.
  1292     12  TEX-FACT-4          PIC S9(7)       COMP-3.
  1293     12  TEX-FACT-5          PIC S9(3)       COMP-3.
  1294     12  TEX-FACT-6          PIC S9(3)       COMP-3.
  1295     12  TEX-FACT-7          PIC S9(7)       COMP-3.
  1296     12  TEX-FACT-8          PIC S9V9(6)     COMP-3.
  1297     12  TEX-FACT-9          PIC S9(4)V9(11) COMP-3.
  1298
  1299 01  NET-PAY-INTERFACE.
  1300     12  NP-APR              PIC S9(3)V9(4)  COMP-3.
  1301     12  NP-ORIG             PIC S9(3)       COMP-3.
  1302     12  NP-REM              PIC S9(3)       COMP-3.
  1303     12  NP251-ORIG          PIC S9(3)V99    COMP-3.
  1304     12  NP251-REM           PIC S9(3)V99    COMP-3.
  1305     12  NP-SUB              PIC S9(3)       COMP-3.
  1306     12  NP-EFF-DT           PIC X(06).
  1307     12  NP-OPT              PIC X.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  35
* ECS150P.cbl
  1308     12  NP-CAP              PIC S9(3)       COMP-3.
  1309     12  NP-FACTOR           PIC S9(4)V9(9)  COMP-3.
  1310     12  NP-WORK1            PIC S9(6)V9(9)  COMP-3.
  1311     12  NP-WORK2            PIC S9(6)V9(9)  COMP-3.
  1312     12  NP-BENEFIT          PIC S9(9)V99    COMP-3.
  1313     12  NP-REMAINING        PIC S9(9)V99    COMP-3.
  1314     12  NP-AHPRM            PIC S9(7)V99    COMP-3.
  1315     12  NP-ACCOUNT          PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  36
* ECS150P.cbl
  1317** OTHER WORK FIELDS
  1318 01  SAVE-REINS-CERT         PIC X(210).
  1319
  1320 01  COUNT-WORK              PIC S9(3)   COMP-3  VALUE +0.
  1321
  1322 01  COUNT-SAVE              PIC S9(3)   COMP-3  VALUE +0.
  1323 01  INFORCE-DOLLARS         PIC S9(9)V99 COMP-3 VALUE +0.
  1324 01  DOLLAR-AMT              PIC S9(9)V99 COMP-3 VALUE +0.
  1325 01  DECREASING-DOLLAR       PIC S9(9)V99 COMP-3 VALUE +0.
  1326 01  WS-PR-UN-PREM           PIC S9(7)V99 COMP-3 VALUE +0.
  1327 01  WS-PR-UN-PREM-ALT       PIC S9(7)V99 COMP-3 VALUE +0.
  1328 01  WS-R78-UN-PREM          PIC S9(7)V99 COMP-3 VALUE +0.
  1329 01  WS-R78-UN-PREM-ALT      PIC S9(7)V99 COMP-3 VALUE +0.
  1330 01  WS-STATE-UN-PREM        PIC S9(7)V99 COMP-3 VALUE +0.
  1331 01  AH-EARN-METHOD          PIC X(01)           VALUE SPACE.
  1332*
  1333*
  1334* LEAVE THE ABOVE 2 LINE IN TO PREVENT LOSING THE LINE ABOVE
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  37
* ECS150P.cbl
  1336 01  ACTIVITY-TOTAL-TABLE.
  1337     12  CONTROL-LEVELS OCCURS 5 TIMES.
  1338*          **ON PASS FOR 1ST INSURANCE COMPANY
  1339*            1=  STATE TOTALS   - 1ST INSURANCE
  1340*            2=  ACCOUNT TOTALS - 1ST INSURANCE
  1341*            3=  STATE TOTALS   - REINSURANCE
  1342*            4=  ACCOUNT TOTALS - REINSURANCE
  1343*            5=  NOT USED
  1344*          **ON PASS FOR REINSURANCE COMPANY
  1345*            1=  REINSURANCE COMPANY TOTALS
  1346*            2=  CARRIER TOTALS
  1347*            3=  COMPANY TOTALS
  1348*            4=  STATE TOTALS
  1349*            5=  ACCOUNT TOTALS
  1350*
  1351         16  TERM-GROUPS OCCURS 3 TIMES.
  1352*            1=  0-60 MONTHS
  1353*            2=  61 - 120 MONTHS
  1354*            3=  OVER 120 MONTHS
  1355*
  1356             20  INSURANCE-TYPES OCCURS 10 TIMES.
  1357*                **  1-5 ARE GROUP
  1358*                    6-10 ARE INDIVIDUAL
  1359*                 1,6 =  LIFE(RED)
  1360*                 2,7 =  LIFE(LEV)
  1361*                 3,8 =  LIFE(OB)
  1362*                 4,9 =  AH
  1363*                 5,10=  AH(OB)
  1364                 24  ISSUE-CNT   PIC S9(13)    COMP-3.
  1365                 24  ISSUE-AMT   PIC S9(11)V99 COMP-3.
  1366                 24  ISSUE-PREM  PIC S9(11)V99 COMP-3.
  1367                 24  CANCEL-CNT  PIC S9(13)    COMP-3.
  1368                 24  CANCEL-AMT  PIC S9(11)V99 COMP-3.
  1369                 24  CANCEL-PREM PIC S9(11)V99 COMP-3.
  1370                 24  CLAIM-CNT   PIC S9(13)    COMP-3.
  1371                 24  CLAIM-AMT   PIC S9(11)V99 COMP-3.
  1372                 24  EARN-PREM   PIC S9(11)V99 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  38
* ECS150P.cbl
  1374 01  EXHIBIT-TOTALS-TABLE.
  1375     12  E-CONTROL-LEVELS OCCURS 5 TIMES.
  1376*            * DEFINITION OF LEVELS SAME AS ACTIVITY-TOTAL-TABLE
  1377         16  E-TERM-GROUPS OCCURS 3 TIMES.
  1378*            * DEFINITION OF LEVELS SAME AS ACTIVITY-TOTAL-TABLE
  1379             20  EXHIBIT-GROUPS OCCURS 9 TIMES.
  1380*                1=  INFORCE END OF PREVIOUS PERIOD
  1381*                2=  ISSUED DURING PERIOD
  1382*                3=  TOTAL INFORCE (LEV 1 + LEV 2)
  1383*                4=  DEATHS IN PERIOD
  1384*                5=  EXPIRED
  1385*                6=  CANCELLED
  1386*                7=  DECREASES
  1387*                8=  TOTAL DEDUCTIONS (LEV 4+5+6+7)
  1388*                9=  TOTAL INFORCE AT END OF PERIOD (LEV 3-8)
  1389*
  1390                 24  GROUP-CNT   PIC S9(13)    COMP-3.
  1391                 24  GROUP-AMT   PIC S9(11)V99 COMP-3.
  1392                 24  IND-CNT     PIC S9(13)    COMP-3.
  1393                 24  IND-AMT     PIC S9(11)V99 COMP-3.
  1394
  1395 01  AH-PAID-TABLE.
  1396     12  A-CONTROL-LEVELS OCCURS 5 TIMES.
  1397*            * DEFINITION OF LEVELS SAME AS ACTIVITY-TOTAL-TABLE.
  1398         16  AH-PAID-THIS-YR     PIC S9(11)V99 COMP-3.
  1399         16  AH-PAID-LAST-YR     PIC S9(11)V99 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  39
* ECS150P.cbl
  1401 01  TABLE-SUBSCRIPTS    COMP.
  1402*
  1403* CONTROL-LEVELS
  1404     12  CL                  PIC S9(4).
  1405* TERM-GROUPS
  1406     12  TG                  PIC S9(4).
  1407* DETAIL (EXHIBIT GROUPS)
  1408     12  EG                  PIC S9(4).
  1409* DETAIL (INSURANCE TYPES)
  1410     12  IY                  PIC S9(4).
  1411* CONTROL-LEVELS + 1 (USED TO ROLL TOTALS)
  1412     12  CLX                 PIC S9(4).
  1413* LAST-ADD-LEVEL.
  1414     12  LA                  PIC S9(4).
  1415
  1416     12  SAV-LF-TERM-CODE    PIC S9(4).
  1417
  1418 01  DATE-EDIT-AREAS.
  1419     12  FORMAT-DATE.
  1420         16  XMM             PIC 99.
  1421         16  FILLER          PIC X               VALUE '/'.
  1422         16  XDD             PIC 99.
  1423         16  FILLER          PIC X               VALUE '/'.
  1424         16  XYY             PIC 99.
  1425     12  EDITED-DATE REDEFINES
  1426         FORMAT-DATE         PIC X(8).
  1427     12  RAW-DATE.
  1428         16  XCC             PIC 99.
  1429         16  XYY             PIC 99.
  1430         16  XMM             PIC 99.
  1431         16  XDD             PIC 99.
  1432     12  DATE-WORK REDEFINES
  1433         RAW-DATE            PIC 9(8).
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  40
* ECS150P.cbl
  1435 01  HEAD-LINE-1.
  1436     12  FILLER              PIC X(12)           VALUE
  1437             '  CARRIER - '.
  1438     12  HL-CARRIER          PIC X               VALUE SPACES.
  1439     12  FILLER              PIC X(34)           VALUE SPACES.
  1440     12  HL-CO-NAME          PIC X(30)           VALUE SPACES.
  1441     12  FILLER              PIC X(42)           VALUE SPACES.
  1442     12  FILLER              PIC X(8)            VALUE 'ECS150'.
  1443
  1444 01  HEAD-LINE-2.
  1445     12  FILLER              PIC X(12)           VALUE
  1446             ' GROUPING - '.
  1447     12  HL-COMPANY          PIC X(6)            VALUE SPACES.
  1448     12  FILLER              PIC X(23)           VALUE SPACES.
  1449     12  FILLER              PIC X(49)           VALUE
  1450             'CERTIFICATE ACTIVITY - DETAIL AND SUMMARY TOTALS'.
  1451     12  FILLER              PIC X(29)           VALUE SPACES.
  1452     12  HL-DATE             PIC X(8).
  1453
  1454 01  HEAD-LINE-3.
  1455     12  FILLER              PIC X(12)           VALUE
  1456             '  STATE   - '.
  1457     12  HL-STATE            PIC X(20)           VALUE SPACES.
  1458     12  FILLER              PIC X(17)           VALUE SPACES.
  1459     12  FILLER              PIC X(11)           VALUE
  1460             'FOR PERIOD '.
  1461     12  HL-PER-START        PIC X(8).
  1462     12  FILLER              PIC X(6)            VALUE ' THRU '.
  1463     12  HL-PER-END          PIC X(8).
  1464     12  FILLER              PIC X(37)           VALUE SPACES.
  1465     12  FILLER              PIC X(5)            VALUE 'PAGE '.
  1466     12  HL-PAGENO           PIC ZZ,ZZ9.
  1467
  1468 01  HEAD-LINE-4.
  1469     12  FILLER              PIC X(12)           VALUE
  1470             '  ACCOUNT - '.
  1471     12  HL-ACCOUNT          PIC X(11)           VALUE SPACES.
  1472     12  FILLER              PIC X(109)          VALUE SPACES.
  1473
  1474 01  HEAD-LINE-5.
  1475     12  FILLER              PIC X(25)           VALUE
  1476             '  REINSURANCE COMPANY - '.
  1477     12  HL-REIN-CO          PIC X(6)            VALUE SPACES.
  1478     12  FILLER              PIC X(101)          VALUE SPACES.
  1479
  1480 01  HEAD-LINE-6.
  1481     12  FILLER              PIC X(7)    VALUE '  *****'.
  1482     12  HL-MESSAGE          PIC X(21)   VALUE SPACES.
  1483     12  FILLER              PIC X(5)    VALUE '*****'.
  1484     12  FILLER              PIC X(99)   VALUE SPACES.
  1485
  1486 01  HEAD-LINE-7A.
  1487     12  FILLER              PIC X(44)           VALUE
  1488             '          CERTIFICATE     ISSUE    TERM     '.
  1489     12  FILLER              PIC X(44)           VALUE
  1490             '       PLAN       ORIGINAL        PREMIUM AM'.
  1491     12  FILLER              PIC X(44)           VALUE
  1492             'OUNTS                                       '.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  41
* ECS150P.cbl
  1493
  1494 01  HEAD-LINE-7B.
  1495     12  FILLER              PIC X(44)           VALUE
  1496             '            NUMBER        DATE     AH  LF   '.
  1497     12  FILLER              PIC X(44)           VALUE
  1498             'TYPE   CODE        AMOUNT          LIFE     '.
  1499     12  FILLER              PIC X(44)           VALUE
  1500             ' AH        ACTIVITY      AMOUNT             '.
  1501
  1502 01  HEAD-LINE-8A.
  1503     12  FILLER              PIC X(44)           VALUE
  1504             ' CLASSIFICATION         I S S U E D         '.
  1505     12  FILLER              PIC X(44)           VALUE
  1506             '                  C A N C E L L E D         '.
  1507     12  FILLER              PIC X(44)           VALUE
  1508             '          C L A I M S            E A R N E D'.
  1509
  1510 01  HEAD-LINE-8B.
  1511     12  FILLER              PIC X(44)           VALUE
  1512             '*************** ****************************'.
  1513     12  FILLER              PIC X(44)           VALUE
  1514             '********    ********************************'.
  1515     12  FILLER              PIC X(44)           VALUE
  1516             '****   *********************    ************'.
  1517
  1518 01  HEAD-LINE-8C.
  1519     12  FILLER              PIC X(44)           VALUE
  1520            ' TYPE    TERM   -COUNT- ----AMOUNT----  --PR'.
  1521     12  FILLER              PIC X(44)           VALUE
  1522            'EMIUM---    -COUNT- ----AMOUNT----  --PREMIU'.
  1523     12  FILLER              PIC X(44)           VALUE
  1524            'M---   -COUNT- ---AMOUNT----    ---AMOUNT---'.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  42
* ECS150P.cbl
  1526 01  DETAIL-LINE-1.
  1527     12  FILLER              PIC X(8)            VALUE SPACES.
  1528     12  DL-CERT-NO          PIC X(10).
  1529     12  DL-CERT-SUFX        PIC X.
  1530     12  FILLER              PIC X(5)            VALUE SPACES.
  1531     12  DL-ISSUE-DT         PIC X(8).
  1532     12  FILLER              PIC XX              VALUE SPACES.
  1533     12  DL-AH-TERM          PIC ZZ9.
  1534     12  FILLER              PIC X               VALUE SPACES.
  1535     12  DL-LF-TERM          PIC ZZ9.
  1536     12  FILLER              PIC X(4)            VALUE SPACES.
  1537     12  DL-TYPE             PIC XXX.
  1538     12  FILLER              PIC X(4)            VALUE SPACES.
  1539     12  DL-PLAN             PIC XXX.
  1540     12  FILLER              PIC X(2)            VALUE SPACES.
  1541     12  DL-ORIG-AMT         PIC ZZZ,ZZZ,ZZ9.99.
  1542     12  FILLER              PIC X(5)            VALUE SPACES.
  1543     12  DL-LF-PREM          PIC ZZ,ZZ9.99.
  1544     12  DL-AH-PREM          PIC ZZ,ZZ9.99.
  1545     12  FILLER              PIC X(7)            VALUE SPACES.
  1546     12  DL-ACTIVITY         PIC X(5).
  1547     12  DL-RSRV-AMT         PIC ZZZ,ZZZ,ZZ9.99-.
  1548     12  FILLER              PIC X(14)           VALUE SPACES.
  1549
  1550 01  DETAIL-LINE-2.
  1551     12  DL-DESCRIP          PIC X(16)           VALUE SPACES.
  1552     12  DL-ISS-CNT          PIC ZZZ,ZZ9.
  1553     12  DL-ISS-AMT          PIC ZZZ,ZZZ,ZZ9.99-.
  1554     12  DL-ISS-PRM          PIC ZZ,ZZZ,ZZ9.99-.
  1555     12  FILLER              PIC XX              VALUE SPACES.
  1556     12  DL-CAN-CNT          PIC ZZZ,ZZ9.
  1557     12  FILLER              PIC X               VALUE SPACES.
  1558     12  DL-CAN-AMT          PIC ZZZ,ZZZ,ZZ9.99.
  1559     12  FILLER              PIC X               VALUE SPACES.
  1560     12  DL-CAN-PRM          PIC ZZ,ZZZ,ZZ9.99.
  1561     12  FILLER              PIC XXX             VALUE SPACES.
  1562     12  DL-CLM-CNT          PIC ZZZ,ZZ9.
  1563     12  FILLER              PIC X               VALUE SPACES.
  1564     12  DL-CLM-AMT          PIC ZZ,ZZZ,ZZ9.99.
  1565     12  FILLER              PIC XX              VALUE SPACES.
  1566     12  DL-EARN-AMT         PIC ZZ,ZZZ,ZZZ.99-.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  43
* ECS150P.cbl
  1568 01  ABEND-CD.
  1569     12  ABEND-CODE.
  1570         16  ABEND-FILE-ID       PIC XX VALUE ZEROS.
  1571         16  ABEND-CODE-1 REDEFINES ABEND-FILE-ID
  1572                                 PIC XX.
  1573         16  ABEND-REASON        PIC XX VALUE ZEROS.
  1574         16  ABEND-CODE-2 REDEFINES ABEND-REASON
  1575                                 PIC XX.
  1576     12  ABEND-OPTION    PIC X          VALUE 'Y'.
  1577     12  PGM-SUB         PIC S999 COMP  VALUE +150.
  1578     12  R-EX-DT             PIC X(6).
  1579
  1580 01  KB-REIN.
  1581     12  CLM-INCUR-REIN-DATE PIC 9(6).
  1582     12  CLM-INCUR-REIN-DATE-R REDEFINES CLM-INCUR-REIN-DATE.
  1583         16  CIRD-CCYY.
  1584             20  CIRD-CC     PIC 99.
  1585             20  CIRD-YR     PIC 99.
  1586         16  CIRD-MO         PIC 99.
  1587     12  DTO-CC              PIC 99.
  1588     12  DTO-YR              PIC 99.
  1589     12  DTO-MO              PIC 99.
  1590     12  FLA-CLM-REIN-BASE   PIC S9(5)V99.
  1591     12  ADJ-FLA-REIN-BASE   PIC S9(5)V99.
  1592     12  REIN-RT-SW          PIC X               VALUE 'X'.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  44
* ECS150P.cbl
* 1594                             COPY ECSRITAB.
  1595******************************************************************04/29/98
  1596*                                                                *ECSRITAB
  1597*                            ECSRITAB                            *   LV015
  1598*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL*15
  1599*                            VMOD=2.015                          *ECSRITAB
  1600*                                                                *ECSRITAB
  1601*  NO  CID  MODS  IN  COPYBOOK  ECSRITAB                         *ECSRITAB
  1602*                                                                *ECSRITAB
  1603******************************************************************ECSRITAB
  1604 01  REIN-WORK-AREAS.                                             ECSRITAB
  1605     12  RW-LFAMT                PIC S9(9)V99  VALUE +0   COMP-3. ECSRITAB
  1606     12  RW-AHWRK                PIC S9(9)V99  VALUE +0   COMP-3. ECSRITAB
  1607     12  RW-LFPRM                PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  1608     12  RW-LFPRMC               PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  1609     12  RW-LFRFND               PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  1610     12  RW-AHPRM                PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  1611     12  RW-AHPRMC               PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  1612     12  RW-AHRFND               PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  1613     12  RW-LFCLMWK              PIC S9(9)V99  VALUE +0   COMP-3. ECSRITAB
  1614     12  RW-AHCLMWK              PIC S9(9)V99  VALUE +0   COMP-3. ECSRITAB
  1615     12  RW-AH-INCURRED-DETAIL.                                   ECSRITAB
  1616         16  RW-AH-INCURRED-DATA OCCURS 5 TIMES.                  ECSRITAB
  1617             20  RW-AH-INCUR-DT  PIC 9(11) COMP-3.                   CL**2
  1618             20  RW-AH-CLM-AMT   PIC S9(9)V99             COMP-3. ECSRITAB
  1619             20  RW-AH-CLM-EXP   PIC S9(9)V99             COMP-3. ECSRITAB
  1620     12  RW-LFCLM                PIC S9(9)V99  VALUE +0   COMP-3. ECSRITAB
  1621     12  RW-AHCLM                PIC S9(9)V99  VALUE +0   COMP-3. ECSRITAB
  1622     12  RW-AH-LIMIT             PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  1623     12  RW-LFIBNR               PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  1624     12  RW-LFPAYCUR             PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  1625     12  RW-LFFUTRSV             PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  1626     12  RW-AHIBNR               PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  1627     12  RW-AHPAYCUR             PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  1628     12  RW-AHFUTRSV             PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  1629     12  RW-LFIBNRWK             PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  1630     12  RW-LFPAYCURWK           PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  1631     12  RW-LFFUTRSVWK           PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  1632     12  RW-AHIBNRWK             PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  1633     12  RW-AHPAYCURWK           PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  1634     12  RW-AHFUTRSVWK           PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  1635     12  RW-AHLIM-LO             PIC S9(9)V99  VALUE +0   COMP-3. ECSRITAB
  1636     12  RW-AHLIM-HI             PIC S9(9)V99  VALUE +0   COMP-3. ECSRITAB
  1637     12  RW-ACCUM-LF             PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  1638     12  RW-ACCUM-AH             PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  1639     12  RW-ACCUM-CLM            PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  1640     12  RW-ACCUM-IBNR           PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  1641     12  RW-ACCUM-PAYCUR         PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  1642     12  RW-ACCUM-FUTRSV         PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  1643                                                                  ECSRITAB
  1644 01  REIN-HOLD-AREAS.                                             ECSRITAB
  1645     12  REIN-LEVELS       OCCURS 30 TIMES.                       ECSRITAB
  1646         16  REIN-COMP               PIC X(6).                    ECSRITAB
  1647         16  REIN-LF-AH-FLGS.                                     ECSRITAB
  1648             20  REIN-LF-FLG         PIC X.                       ECSRITAB
  1649             20  REIN-AH-FLG         PIC X.                       ECSRITAB
  1650         16  REIN-WORK-FLDS.                                      ECSRITAB
  1651             20  REIN-LFAMT          PIC S9(9)V99   COMP-3.       ECSRITAB
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  45
* ECS150P.cbl (/apps/prod/cid1p/copy/ECSRITAB)
  1652             20  REIN-LFPRM          PIC S9(7)V99   COMP-3.       ECSRITAB
  1653             20  REIN-AHAMT          PIC S9(7)V99   COMP-3.       ECSRITAB
  1654             20  REIN-AHPRM          PIC S9(7)V99   COMP-3.       ECSRITAB
  1655             20  REIN-LFRFND         PIC S9(7)V99   COMP-3.       ECSRITAB
  1656             20  REIN-AHRFND         PIC S9(7)V99   COMP-3.       ECSRITAB
  1657             20  REIN-LFCLM          PIC S9(9)V99   COMP-3.       ECSRITAB
  1658             20  REIN-AHCLM          PIC S9(9)V99   COMP-3.       ECSRITAB
  1659             20  REIN-LFCLML         PIC S9(9)V99   COMP-3.       ECSRITAB
  1660             20  REIN-AHCLML         PIC S9(9)V99   COMP-3.       ECSRITAB
  1661             20  REIN-DIS-IBNR       PIC S9(7)V99   COMP-3.       ECSRITAB
  1662             20  REIN-DIS-PAYCUR     PIC S9(7)V99   COMP-3.       ECSRITAB
  1663             20  REIN-DIS-FUTRSV     PIC S9(7)V99   COMP-3.       ECSRITAB
  1664             20  REIN-DIS-IBNRL      PIC S9(7)V99   COMP-3.       ECSRITAB
  1665             20  REIN-DIS-PAYCURL    PIC S9(7)V99   COMP-3.       ECSRITAB
  1666             20  REIN-DIS-FUTRSVL    PIC S9(7)V99   COMP-3.       ECSRITAB
  1667             20  REIN-DTH-IBNR       PIC S9(7)V99   COMP-3.       ECSRITAB
  1668             20  REIN-DTH-PAYCUR     PIC S9(7)V99   COMP-3.       ECSRITAB
  1669             20  REIN-DTH-FUTRSV     PIC S9(7)V99   COMP-3.       ECSRITAB
  1670             20  REIN-DTH-IBNRL      PIC S9(7)V99   COMP-3.       ECSRITAB
  1671             20  REIN-DTH-PAYCURL    PIC S9(7)V99   COMP-3.       ECSRITAB
  1672             20  REIN-DTH-FUTRSVL    PIC S9(7)V99   COMP-3.       ECSRITAB
  1673             20  REIN-AH-LIMIT       PIC S9(7)V99   COMP-3.       ECSRITAB
  1674             20  REIN-REM-SW         PIC X.                       ECSRITAB
  1675             20  REIN-REM-AH-100     PIC X.                       ECSRITAB
  1676             20  REIN-EP-STOP-DATE   PIC 9(11)      COMP-3.          CL**4
  1677             20  REIN-LF-RUNOFF-SW   PIC X.                       ECSRITAB
  1678             20  REIN-AH-RUNOFF-SW   PIC X.                       ECSRITAB
  1679     12  REIN-LEVELS-END             PIC X(6).                    ECSRITAB
  1680                                                                  ECSRITAB
  1681     12  RWF-FIELDS.                                              ECSRITAB
  1682         16  RWF-LFAMT               PIC S9(9)V99   COMP-3.       ECSRITAB
  1683         16  RWF-LFPRM               PIC S9(7)V99   COMP-3.       ECSRITAB
  1684         16  RWF-AHAMT               PIC S9(7)V99   COMP-3.       ECSRITAB
  1685         16  RWF-AHPRM               PIC S9(7)V99   COMP-3.       ECSRITAB
  1686         16  RWF-LFRFND              PIC S9(7)V99   COMP-3.       ECSRITAB
  1687         16  RWF-AHRFND              PIC S9(7)V99   COMP-3.       ECSRITAB
  1688         16  RWF-LFCLM               PIC S9(9)V99   COMP-3.       ECSRITAB
  1689         16  RWF-AHCLM               PIC S9(9)V99   COMP-3.       ECSRITAB
  1690         16  RWF-LFCLML              PIC S9(9)V99   COMP-3.       ECSRITAB
  1691         16  RWF-AHCLML              PIC S9(9)V99   COMP-3.       ECSRITAB
  1692         16  RWF-DIS-IBNR            PIC S9(7)V99   COMP-3.       ECSRITAB
  1693         16  RWF-DIS-PAYCUR          PIC S9(7)V99   COMP-3.       ECSRITAB
  1694         16  RWF-DIS-FUTRSV          PIC S9(7)V99   COMP-3.       ECSRITAB
  1695         16  RWF-DIS-IBNRL           PIC S9(7)V99   COMP-3.       ECSRITAB
  1696         16  RWF-DIS-PAYCURL         PIC S9(7)V99   COMP-3.       ECSRITAB
  1697         16  RWF-DIS-FUTRSVL         PIC S9(7)V99   COMP-3.       ECSRITAB
  1698         16  RWF-DTH-IBNR            PIC S9(7)V99   COMP-3.       ECSRITAB
  1699         16  RWF-DTH-PAYCUR          PIC S9(7)V99   COMP-3.       ECSRITAB
  1700         16  RWF-DTH-FUTRSV          PIC S9(7)V99   COMP-3.       ECSRITAB
  1701         16  RWF-DTH-IBNRL           PIC S9(7)V99   COMP-3.       ECSRITAB
  1702         16  RWF-DTH-PAYCURL         PIC S9(7)V99   COMP-3.       ECSRITAB
  1703         16  RWF-DTH-FUTRSVL         PIC S9(7)V99   COMP-3.       ECSRITAB
  1704         16  RWF-AH-LIMIT            PIC S9(7)V99   COMP-3.       ECSRITAB
  1705         16  RWF-REM-SW              PIC X.                       ECSRITAB
  1706         16  RWF-REM-AH-100          PIC X.                       ECSRITAB
  1707         16  RWF-EP-STOP-DATE        PIC 9(11)      COMP-3.          CL**3
  1708         16  RWF-LF-RUNOFF-SW        PIC X.                       ECSRITAB
  1709         16  RWF-AH-RUNOFF-SW        PIC X.                       ECSRITAB
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  46
* ECS150P.cbl (/apps/prod/cid1p/copy/ECSRITAB)
  1710                                                                  ECSRITAB
  1711     12  WT-COMP-INFO.                                            ECSRITAB
  1712         16  WT-REI-COMP             PIC X(6).                    ECSRITAB
  1713         16  WT-LF-QC                PIC X.                       ECSRITAB
  1714         16  WT-AH-QC                PIC X.                       ECSRITAB
  1715         16  WT-LO-DATE              PIC 9(11)     COMP-3.           CL**2
  1716         16  WT-HI-DATE              PIC 9(11)     COMP-3.           CL**2
  1717         16  WT-LFAGE-LO             PIC 99.                      ECSRITAB
  1718         16  WT-LFAGE-HI             PIC 99.                      ECSRITAB
  1719         16  WT-AHAGE-LO             PIC 99.                      ECSRITAB
  1720         16  WT-AHAGE-HI             PIC 99.                      ECSRITAB
  1721         16  WT-LFTRM-LO             PIC S999       COMP-3.       ECSRITAB
  1722         16  WT-LFTRM-HI             PIC S999       COMP-3.       ECSRITAB
  1723         16  WT-AHTRM-LO             PIC S999       COMP-3.       ECSRITAB
  1724         16  WT-AHTRM-HI             PIC S999       COMP-3.       ECSRITAB
  1725         16  WT-LF-PCT               PIC S9V9999    COMP-3.       ECSRITAB
  1726         16  WT-AH-PCT               PIC S9V9999    COMP-3.       ECSRITAB
  1727         16  WT-LF-LIM-LO            PIC S9(9)V99   COMP-3.       ECSRITAB
  1728         16  WT-LF-LIM-HI            PIC S9(9)V99   COMP-3.       ECSRITAB
  1729         16  WT-LF-LO                PIC S9(9)V99   COMP-3.       ECSRITAB
  1730         16  WT-LF-HI                PIC S9(9)V99   COMP-3.       ECSRITAB
  1731         16  WT-AHBEN-LIM-LO         PIC S9(7)V99   COMP-3.       ECSRITAB
  1732         16  WT-AHBEN-LIM-HI         PIC S9(7)V99   COMP-3.       ECSRITAB
  1733         16  WT-AHBEN-LO             PIC S9(7)V99   COMP-3.       ECSRITAB
  1734         16  WT-AHBEN-HI             PIC S9(7)V99   COMP-3.       ECSRITAB
  1735         16  WT-AHMOA-LIM-LO         PIC S9(7)V99   COMP-3.       ECSRITAB
  1736         16  WT-AHMOA-LIM-HI         PIC S9(7)V99   COMP-3.       ECSRITAB
  1737         16  WT-AHMOA-LO             PIC S9(7)V99   COMP-3.       ECSRITAB
  1738         16  WT-AHMOA-HI             PIC S9(7)V99   COMP-3.       ECSRITAB
  1739         16  WT-LF-BEN-CODE          PIC X.                       ECSRITAB
  1740         16  WT-AH-BEN-CODE          PIC X.                       ECSRITAB
  1741         16  WT-INTERACTIVE          PIC X.                       ECSRITAB
  1742         16  WT-REMAINING            PIC X.                       ECSRITAB
  1743         16  FILLER                  PIC X(21).                   ECSRITAB
  1744                                                                  ECSRITAB
  1745 01  REIN-MISC-WORK-FIELDS.                                       ECSRITAB
  1746     12  SUB1                    PIC S9(4)       COMP.            ECSRITAB
  1747     12  SUB2                    PIC S9(4)       COMP.            ECSRITAB
  1748     12  CO-SUB                  PIC S9(4)       COMP.            ECSRITAB
  1749     12  INC-SUB                 PIC S999        COMP.            ECSRITAB
  1750     12  MORTALITY-SUB           PIC S999        COMP.            ECSRITAB
  1751     12  REIN-FACTOR             PIC S99V9(7)  COMP-3   VALUE +0. ECSRITAB
  1752     12  REIN-CALCED-LIFE        PIC S9(7)V99  COMP-3   VALUE +0. ECSRITAB
  1753     12  REIN-CALCED-AH          PIC S9(7)V99  COMP-3   VALUE +0. ECSRITAB
  1754     12  REIN-RISK-AMOUNT        PIC S9(11)V99 COMP-3   VALUE +0. ECSRITAB
  1755     12  REIN-MONTH-REDUCE       PIC S9(7)V99  COMP-3   VALUE +0. ECSRITAB
  1756     12  REIN-CEDE-TERM          PIC S999V99   COMP-3   VALUE +0. ECSRITAB
  1757     12  REIN-WORKA              PIC S999      COMP-3   VALUE +0. ECSRITAB
  1758     12  REIN-EARN-LF-TERM       PIC S999      COMP-3   VALUE +0. ECSRITAB
  1759     12  REIN-EARN-AH-TERM       PIC S999      COMP-3   VALUE +0. ECSRITAB
  1760     12  REIN-LCNC-EARN-TERM     PIC S999      COMP-3   VALUE +0. ECSRITAB
  1761     12  REIN-ACNC-EARN-TERM     PIC S999      COMP-3   VALUE +0. ECSRITAB
  1762     12  REIN-LF-CLM-MONTHS      PIC S999      COMP-3   VALUE +0. ECSRITAB
  1763     12  REIN-AH-CLM-MONTHS      PIC S999      COMP-3   VALUE +0. ECSRITAB
  1764     12  REIN-AH-CLM-MTH-1       PIC S999      COMP-3   VALUE +0. ECSRITAB
  1765     12  REIN-AH-CLM-MTH-2       PIC S999      COMP-3   VALUE +0. ECSRITAB
  1766     12  REIN-AH-CLM-MTH-3       PIC S999      COMP-3   VALUE +0. ECSRITAB
  1767     12  REIN-AH-CLM-MTH-4       PIC S999      COMP-3   VALUE +0. ECSRITAB
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  47
* ECS150P.cbl (/apps/prod/cid1p/copy/ECSRITAB)
  1768     12  REIN-AH-CLM-MTH-5       PIC S999      COMP-3   VALUE +0. ECSRITAB
  1769     12  REIN-AH-PRIOR-CLMS-PAID PIC S9(11)V99 COMP-3   VALUE +0. ECSRITAB
  1770                                                                  ECSRITAB
  1771     12  REIN-VOID-LF-SW         PIC X    VALUE ' '.              ECSRITAB
  1772         88  VOIDING-LF-CANCEL            VALUE '*'.              ECSRITAB
  1773     12  REIN-VOID-AH-SW         PIC X    VALUE ' '.              ECSRITAB
  1774         88  VOIDING-AH-CANCEL            VALUE '*'.              ECSRITAB
  1775     12  REIN-ADDL-LF-SW         PIC X    VALUE ' '.              ECSRITAB
  1776         88  ADDITIONAL-LF-CANCEL         VALUE '*'.              ECSRITAB
  1777     12  REIN-ADDL-AH-SW         PIC X    VALUE ' '.              ECSRITAB
  1778         88  ADDITIONAL-AH-CANCEL         VALUE '*'.              ECSRITAB
  1779     12  REIN-CANCEL-LF-SW       PIC X    VALUE ' '.              ECSRITAB
  1780         88  FLAT-CANCEL-LF               VALUE '*'.              ECSRITAB
  1781     12  REIN-CANCEL-AH-SW       PIC X    VALUE ' '.              ECSRITAB
  1782         88  FLAT-CANCEL-AH               VALUE '*'.              ECSRITAB
  1783                                                                  ECSRITAB
  1784     12  REIN-BEN-CODE           PIC X.                           ECSRITAB
  1785         88  CEDING-SINGLE-PREM-ONLY      VALUE 'A'.              ECSRITAB
  1786         88  CEDING-OUT-BALANCE-ONLY      VALUE 'B'.              ECSRITAB
  1787         88  CEDING-REDUCING-ONLY         VALUE 'C'  'F'.         ECSRITAB
  1788         88  CEDING-LEVEL-ONLY            VALUE 'D'  'E'.         ECSRITAB
  1789         88  CEDING-GROUP-ONLY            VALUE 'G'.              ECSRITAB
  1790         88  CEDING-GROUP-RED-LIFE-ONLY   VALUE 'H'.              ECSRITAB
  1791         88  CEDING-INDIVIDUAL-ONLY       VALUE 'I'.              ECSRITAB
  1792         88  CEDING-JOINT-ONLY            VALUE 'J'.              ECSRITAB
  1793         88  CEDING-SGL-PREM-REDUCING     VALUE 'K'.              ECSRITAB
  1794         88  CEDING-SGL-PREM-GROUP        VALUE 'L'.              ECSRITAB
  1795         88  CEDING-GROUP-LEVEL-ONLY      VALUE 'M'.              ECSRITAB
  1796         88  CEDING-SGL-PREM-GRP-REDUCING VALUE 'N'.              ECSRITAB
  1797         88  CEDING-SGL-PREM-GROUP-LEVEL  VALUE 'P'.              ECSRITAB
  1798         88  CEDING-GROUP-REDUCING-ONLY   VALUE 'R'.              ECSRITAB
  1799         88  CEDING-SINGLE-POLICIES-ONLY  VALUE 'S'.              ECSRITAB
  1800         88  CEDING-AH-ONLY               VALUE '1'.              ECSRITAB
  1801         88  CEDING-PROPERTY-ONLY         VALUE '2'.              ECSRITAB
  1802         88  CEDING-UNEMPLOYMENT-ONLY     VALUE '3'.              ECSRITAB
  1803         88  CEDING-AD-D-ONLY             VALUE '4'.              ECSRITAB
  1804         88  CEDING-LIFE-ONLY             VALUE '5'.              ECSRITAB
  1805         88  CEDING-DISMEMBERMENT-ONLY    VALUE '6'.              ECSRITAB
  1806         88  CEDING-7-DAY-RETRO           VALUE '7'.              ECSRITAB
  1807         88  CEDING-14-DAY-RETRO          VALUE '8'.              ECSRITAB
  1808     12  REIN-OPEN-SW            PIC X           VALUE SPACE.     ECSRITAB
  1809     12  REIN-SEARCH.                                             ECSRITAB
  1810         16  REIN-SRCH-COMP-CD   PIC X           VALUE SPACE.     ECSRITAB
  1811         16  REIN-SRCH-CODE      PIC X           VALUE SPACE.     ECSRITAB
  1812         16  REIN-SRCH           PIC XXX         VALUE SPACE.     ECSRITAB
  1813         16  FILLER              PIC XXX         VALUE LOW-VALUE. ECSRITAB
  1814     12  SAVE-REIN-SRCH          PIC XXX         VALUE SPACE.     ECSRITAB
  1815     12  REIN-BUS-FLAG           PIC X           VALUE SPACE.     ECSRITAB
  1816     12  RATE-WORK               PIC S9(8)V9(5)  COMP-3.          ECSRITAB
  1817     12  RATE-WORK-L             PIC S9(8)V9(5)  COMP-3.          ECSRITAB
  1818     12  RATE-WORK-A             PIC S9(8)V9(5)  COMP-3.          ECSRITAB
  1819     12  RS-LIFE-BEN             PIC S9(9)V99  COMP-3   VALUE +0. ECSRITAB
  1820     12  RS-LIFE-PREM            PIC S9(7)V99  COMP-3   VALUE +0. ECSRITAB
  1821     12  RS-AH-BEN               PIC S9(9)V99  COMP-3   VALUE +0. ECSRITAB
  1822     12  RS-AH-PREM              PIC S9(7)V99  COMP-3   VALUE +0. ECSRITAB
  1823     12  RS-LP-CALC              PIC S9(7)V99  COMP-3   VALUE +0. ECSRITAB
  1824     12  RS-AP-CALC              PIC S9(7)V99  COMP-3   VALUE +0. ECSRITAB
  1825     12  RS-R-LB                 PIC S9(9)V99  COMP-3   VALUE +0. ECSRITAB
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  48
* ECS150P.cbl (/apps/prod/cid1p/copy/ECSRITAB)
  1826     12  RS-R-LP                 PIC S9(7)V99  COMP-3   VALUE +0. ECSRITAB
  1827     12  RS-R-AB                 PIC S9(9)V99  COMP-3   VALUE +0. ECSRITAB
  1828     12  RS-R-AP                 PIC S9(7)V99  COMP-3   VALUE +0. ECSRITAB
  1829     12  RS-R-LPC                PIC S9(7)V99  COMP-3   VALUE +0. ECSRITAB
  1830     12  RS-R-APC                PIC S9(7)V99  COMP-3   VALUE +0. ECSRITAB
  1831     12  BIN-RWF-EP-STOP-DT      PIC XX        VALUE SPACES.      ECSRITAB
  1832     12  BIN-CNT                 PIC 9(3)      VALUE ZEROES.      ECSRITAB
  1833     12  BIN-CR-DIS-DT           PIC XX        VALUE SPACES.      ECSRITAB
  1834     12  BIN-WT-HIGH-DT          PIC XX        VALUE SPACES.      ECSRITAB
  1835     12  BIN-WT-LO-DT            PIC XX        VALUE SPACES.      ECSRITAB
  1836     12  BIN-LF-CANC-DT          PIC XX        VALUE SPACES.      ECSRITAB
  1837     12  BIN-AH-CANC-DT          PIC XX        VALUE SPACES.      ECSRITAB
  1838     12  BIN-CR-DTH-DT           PIC XX        VALUE SPACES.      ECSRITAB
  1839                                                                  ECSRITAB
  1840 01  REIN-CO-HOLD-TABLE.                                          ECSRITAB
  1841* ELCPSEVR MUST BE MODIFIED IF THE "OCCURS" IS CHANGED.           ECSRITAB
  1842     12  REIN-CO-HOLD-ENTRIES  OCCURS 1500 TIMES.                 ECSRITAB
  1843         16  RCT-REIN-CO         PIC X(6).                        ECSRITAB
  1844         16  RCT-CLM-CUTOFF-DT   PIC 9(11)  COMP-3.               ECSRITAB
  1845         16  RCT-EARNING-START-DT PIC 9(11)  COMP-3.              ECSRITAB
  1846         16  RCT-EARNING-STOP-DT PIC 9(11)  COMP-3.               ECSRITAB
  1847         16  RCT-EARN-STOP-CODE  PIC X.                           ECSRITAB
  1848         16  RCT-LF-CLM-PCT      PIC S9V9(4)    COMP-3.           ECSRITAB
  1849         16  RCT-LF-CLM-MAX      PIC S9(9)V99   COMP-3.           ECSRITAB
  1850         16  RCT-AH-CLM-PCT      PIC S9V9(4)    COMP-3.           ECSRITAB
  1851         16  RCT-AH-CLM-MAX      PIC S9(9)V99   COMP-3.           ECSRITAB
  1852                                                                  ECSRITAB
  1853 01  REIN-CO-HOLD-TABLE-2.                                        ECSRITAB
  1854     12  RC2-CO-HOLD-ENTRIES  OCCURS 1500 TIMES.                  ECSRITAB
  1855         16  RC2-REIN-CO.                                         ECSRITAB
  1856             20  RC2-CO-PRIME    PIC XXX.                         ECSRITAB
  1857             20  RC2-CO-SUB      PIC XXX.                         ECSRITAB
  1858         16  RC2-LF-R78-PCT      PIC S9V9(4)    COMP-3.           ECSRITAB
  1859         16  RC2-LF-PRO-PCT      PIC S9V9(4)    COMP-3.           ECSRITAB
  1860         16  RC2-AH-R78-PCT      PIC S9V9(4)    COMP-3.           ECSRITAB
  1861         16  RC2-AH-PRO-PCT      PIC S9V9(4)    COMP-3.           ECSRITAB
  1862         16  RC2-CO-NAME         PIC X(30).                       ECSRITAB
  1863         16  RC2-ECS152-RPT      PIC X.                           ECSRITAB
  1864                                                                  ECSRITAB
  1865 01  REIN-MORT-CD-HOLD-TABLE.                                     ECSRITAB
  1866     12  REIN-MORT-CD-ENTRIES  OCCURS 1500 TIMES.                 ECSRITAB
  1867         16  RCT-MORT-CO         PIC X(6).                        ECSRITAB
  1868         16  RCT-MORT-CODE       PIC X(4).                        ECSRITAB
  1869     12  REIN-INDEX              PIC S9(4)    COMP    VALUE +0.   ECSRITAB
  1870                                                                  ECSRITAB
  1871 01  BIN-RCT-ITEMS-TABLE.                                         ECSRITAB
  1872     12  BIN-RCT-ITEMS OCCURS 1500 TIMES.                         ECSRITAB
  1873         16  BIN-RCT-CLM-CUTOFF-DT    PIC XX.                     ECSRITAB
  1874         16  BIN-RCT-EARNING-START-DT PIC XX.                     ECSRITAB
  1875         16  BIN-RCT-EARNING-STOP-DT  PIC XX.                     ECSRITAB
  1876 01  BIN-RW-ITEMS-TABLE.                                          ECSRITAB
  1877     12  BIN-RW-ITEMS OCCURS 5 TIMES.                             ECSRITAB
  1878         16  BIN-RW-AH-INCUR-DT       PIC XX.                     ECSRITAB
  1879                                                                  ECSRITAB
  1880 01  REIN-CO-TABLE-ENT-CNT       PIC S9(4)    COMP-3  VALUE +1500.ECSRITAB
  1881******************************************************************ECSRITAB
* 1882                             COPY ELCPSEVR.
  1883******************************************************************04/16/98
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  49
* ECS150P.cbl (/apps/prod/cid1p/copy/ELCPSEVR)
  1884*                                                                *ELCPSEVR
  1885*                                                                *ELCPSEVR
  1886*                            ELCPSEVR                            *   LV003
  1887*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  1888*                            VMOD=2.001                          *ELCPSEVR
  1889*                                                                *ELCPSEVR
  1890*   WORKING STORAGE FOR DATE VARIABLES CREATED                   *ELCPSEVR
  1891*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCPSEVR
  1892*                                                                *ELCPSEVR
  1893******************************************************************ELCPSEVR
  1894                                                                  ELCPSEVR
  1895 01  WS-PD-SUMMARY-DETAIL-EXTR-DT.                                ELCPSEVR
  1896     05  WS-PSC-CID-LOW.                                          ELCPSEVR
  1897         10  FILLER               PIC 999.                        ELCPSEVR
  1898         10  PSC-CID-LOW-CCYY     PIC 9(04).                      ELCPSEVR
  1899         10  PSC-CID-LOW-CCYR  REDEFINES  PSC-CID-LOW-CCYY.       ELCPSEVR
  1900             15  PSC-CID-LOW-CC   PIC 99.                            CL**3
  1901             15  PSC-CID-LOW-YY   PIC 99.                            CL**3
  1902         10  PSC-CID-LOW-MM       PIC 99.                            CL**3
  1903         10  PSC-CID-LOW-DD       PIC 99.                            CL**3
  1904     05  WS-PSC-CID-LOW-N REDEFINES                                  CL**2
  1905            WS-PSC-CID-LOW        PIC 9(11).                         CL**2
  1906     05  WS-PSC-CID-HIGH.                                         ELCPSEVR
  1907         10  FILLER              PIC 999.                         ELCPSEVR
  1908         10  PSC-CID-HIGH-CCYY   PIC 9(04).                       ELCPSEVR
  1909         10  PSC-CID-HIGH-CCYR  REDEFINES  PSC-CID-HIGH-CCYY.     ELCPSEVR
  1910             15  PSC-CID-HIGH-CC PIC 99.                             CL**3
  1911             15  PSC-CID-HIGH-YY PIC 99.                             CL**3
  1912         10  PSC-CID-HIGH-MM     PIC 99.                             CL**3
  1913         10  PSC-CID-HIGH-DD     PIC 99.                             CL**3
  1914     05  WS-PSC-CID-HIGH-N REDEFINES                                 CL**2
  1915            WS-PSC-CID-HIGH          PIC 9(11).                      CL**2
  1916 01  WS-REIN-WORK-AREAS.                                          ELCPSEVR
  1917     05  WS-REIN-CO-HOLD-ENTRIES  OCCURS 1500 TIMES               ELCPSEVR
  1918                 INDEXED BY CPSE-NDX.                             ELCPSEVR
  1919         10  WS-RCT-CLM-CUTOFF-DT.                                ELCPSEVR
  1920             15  FILLER              PIC 999.                     ELCPSEVR
  1921             15  RCT-CUTOFF-CCYY     PIC 9(04).                   ELCPSEVR
  1922             15  RCT-CUTOFF-CCYR  REDEFINES  RCT-CUTOFF-CCYY.     ELCPSEVR
  1923                 20  RCT-CUTOFF-CC   PIC 99.                      ELCPSEVR
  1924                 20  RCT-CUTOFF-YR   PIC 99.                      ELCPSEVR
  1925             15  RCT-CUTOFF-MO       PIC 99.                      ELCPSEVR
  1926             15  RCT-CUTOFF-DA       PIC 99.                      ELCPSEVR
  1927         10  WS-RCT-CLM-CUTOFF-DT-N REDEFINES                        CL**2
  1928                WS-RCT-CLM-CUTOFF-DT PIC 9(11).                      CL**2
  1929         10  WS-RCT-EARNING-START-DT.                             ELCPSEVR
  1930             15  FILLER              PIC 999.                     ELCPSEVR
  1931             15  RCT-START-CCYY      PIC 9(04).                   ELCPSEVR
  1932             15  RCT-START-CCYR  REDEFINES  RCT-START-CCYY.       ELCPSEVR
  1933                 20  RCT-START-CC    PIC 99.                      ELCPSEVR
  1934                 20  RCT-START-YR    PIC 99.                      ELCPSEVR
  1935             15  RCT-START-MO        PIC 99.                      ELCPSEVR
  1936             15  RCT-START-DA        PIC 99.                      ELCPSEVR
  1937         10  WS-RCT-EARNING-START-DT-N REDEFINES                     CL**2
  1938                WS-RCT-EARNING-START-DT  PIC 9(11).                  CL**2
  1939         10  WS-RCT-EARNING-STOP-DT.                              ELCPSEVR
  1940             15  FILLER              PIC 999.                     ELCPSEVR
  1941             15  RCT-STOP-CCYY       PIC 9(04).                   ELCPSEVR
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  50
* ECS150P.cbl (/apps/prod/cid1p/copy/ELCPSEVR)
  1942             15  RCT-STOP-CCYR  REDEFINES  RCT-STOP-CCYY.         ELCPSEVR
  1943                 20  RCT-STOP-CC     PIC 99.                      ELCPSEVR
  1944                 20  RCT-STOP-YR     PIC 99.                      ELCPSEVR
  1945             15  RCT-STOP-MO         PIC 99.                      ELCPSEVR
  1946             15  RCT-STOP-DA         PIC 99.                      ELCPSEVR
  1947         10  WS-RCT-EARNING-STOP-DT-N REDEFINES                      CL**2
  1948                WS-RCT-EARNING-STOP-DT   PIC 9(11).                  CL**2
  1949     05  WS-RWF-EP-STOP-DATE.                                     ELCPSEVR
  1950         10  FILLER              PIC 999.                         ELCPSEVR
  1951         10  RWF-EP-STOP-CCYY    PIC 9(04).                       ELCPSEVR
  1952         10  RWF-EP-STOP-CCYR REDEFINES  RWF-EP-STOP-CCYY.        ELCPSEVR
  1953             15  RWF-EP-STOP-CC  PIC 99.                          ELCPSEVR
  1954             15  RWF-EP-STOP-YR  PIC 99.                          ELCPSEVR
  1955         10  RWF-EP-STOP-MO      PIC 99.                          ELCPSEVR
  1956         10  RWF-EP-STOP-DA      PIC 99.                          ELCPSEVR
  1957     05  WS-RWF-EP-STOP-DATE-N REDEFINES                             CL**2
  1958            WS-RWF-EP-STOP-DATE  PIC 9(11).                          CL**2
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  51
* ECS150P.cbl
  1960 01  CLAS150-EXTRACT-RECORD.
  1961     12  ER-SORT-KEY.
  1962         16  ER-CONTROL.
  1963             20  ER-REINS-CO             PIC X(06).
  1964             20  ER-CARRIER              PIC X(01).
  1965             20  ER-COMPANY              PIC X(06).
  1966             20  ER-STATE                PIC X(02).
  1967             20  ER-ACCOUNT              PIC X(10).
  1968         16  ER-ST-SEQ                   PIC X(02).
  1969         16  ER-REC-TYPE                 PIC 99.
  1970     12  ER-PERIOD-START                 PIC 9(11)  COMP-3.
  1971     12  ER-PERIOD-END                   PIC 9(11)  COMP-3.
  1972     12  ER-ACTIVITY-TOTALS.
  1973         16  ER-TERM-GROUP OCCURS 3 TIMES.
  1974*                1= 0-60 MONTHS
  1975*                2= 61-120 MONTHS
  1976*                3= 121 AND OVER
  1977             20  ER-TYPE-GROUPS OCCURS 10 TIMES.
  1978*                1= LIFE(R-GP)       6= LIFE(R-IND)
  1979*                2= LIFE(L-GP)       7= LIFE(L-IND)
  1980*                3= LIFE(OB-GP)      8= LIFE(OB-IND)
  1981*                4= AH(GP)           9= AH(IND)
  1982*                5= AH(OB-GP)       10= AH(OB-IND)
  1983                 24  ER-DETAIL.
  1984                     28  ER-ISSUE-CNT    PIC S9(13)    COMP-3.
  1985                     28  ER-ISSUE-AMT    PIC S9(11)V99 COMP-3.
  1986                     28  ER-ISSUE-PREM   PIC S9(11)V99 COMP-3.
  1987                     28  ER-CANCEL-CNT   PIC S9(13)    COMP-3.
  1988                     28  ER-CANCEL-AMT   PIC S9(11)V99 COMP-3.
  1989                     28  ER-CANCEL-PREM  PIC S9(11)V99 COMP-3.
  1990                     28  ER-CLAIM-CNT    PIC S9(13)    COMP-3.
  1991                     28  ER-CLAIM-AMT    PIC S9(11)V99 COMP-3.
  1992                     28  ER-EARN-PREM    PIC S9(11)V99 COMP-3.
  1993     12  ER-EXHIBIT-TOTALS.
  1994         16  ER-TERM-GROUP-E OCCURS 3 TIMES.
  1995*                1= 0-60 MONTHS
  1996*                2= 61-120 MONTHS
  1997*                3= 121 AND OVER
  1998             20  ER-LINE-DETAIL OCCURS 9 TIMES.
  1999*                1= INFORCE PREVIOUS PER  6= CANCELED IN PERIOD
  2000*                2= ISSUED IN PERIOD      7= DECREASES IN PERIOD
  2001*                3= TOTAL INFORCE-START   8= TOTAL DEC IN PERIOD
  2002*                4= DEATHS IN PERIOD      9= TOTAL INFORCE AT END
  2003*                5= EXPIRED IN PERIOD
  2004                 24  ER-DETAIL-E.
  2005                     28  ER-GROUP-CNT    PIC S9(13)    COMP-3.
  2006                     28  ER-GROUP-AMT    PIC S9(11)V99 COMP-3.
  2007                     28  ER-IND-CNT      PIC S9(13)    COMP-3.
  2008                     28  ER-IND-AMT      PIC S9(11)V99 COMP-3.
  2009
  2010     12  ER-AH-PD-THIS                   PIC S9(11)V99 COMP-3.
  2011     12  ER-AH-PD-LAST                   PIC S9(11)V99 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  52
* ECS150P.cbl
* 2013                             COPY ECSCRT01.
  2014******************************************************************
  2015*                                                                *
  2016*                            ECSCRT01                            *
  2017*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2018*                            VMOD=2.016                          *
  2019*                                                                *
  2020*   FILE DESCRIPTION = CERTIFICATE RECORD    (OFF-LINE)          *
  2021*                                                                *
  2022*   FILE TYPE = SEQUENTIAL
  2023*   RECORD SIZE = 1056 RECFORM = FIXED                           *
  2024*                                                                *
  2025*   KEY DATA =                         START=4, LEN=36           *
  2026*                                                                *
  2027*  NO  CID  MODS  IN  COPYBOOK  ECSCRT01                         *
  2028*                                                                *
  2029******************************************************************
  2030******************************************************************
  2031*                   C H A N G E   L O G
  2032*
  2033* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2034*-----------------------------------------------------------------
  2035*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2036* EFFECTIVE    NUMBER
  2037*-----------------------------------------------------------------
  2038* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  2039* 100703    2003080800002  PEMA  ADD SUPER GAP PROCESSING
  2040* 040504    2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  2041* 020305    2005020000000  PEMA  ADD CLP STATE TO CERT RECORD
  2042* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  2043* 042408    2007110500003  PEMA  ADD REFUND INTEREST PROCESSING
  2044* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  2045* 032612  CR2011110200001  PEMA  AHL CHANGES
  2046* 052814  CR2014012300001  PEMA  DCC CREDIT UNION CHANGES
  2047* 090314  CR2014081300001  PEMA  LOAD CERTS INVOLVED IN THAO
  2048******************************************************************
  2049
  2050 01  CERTIFICATE-RECORD.
  2051     12  CR-RECORD-ID                      PIC XX.
  2052         88  VALID-CR-ID                      VALUE 'CR'.
  2053
  2054     12  CR-COMPANY-CD                     PIC X.
  2055
  2056     12  CR-FULL-CONTROL.
  2057         16  CR-CONTROL-1.
  2058             20  CR-ACCT-CONTROL.
  2059                 24  CR-CARRIER            PIC X.
  2060                 24  CR-GROUPING.
  2061                     28  CR-GROUP-PREFIX   PIC XXX.
  2062                     28  CR-GROUP-PRIME    PIC XXX.
  2063                 24  CR-STATE              PIC XX.
  2064                 24  CR-ACCOUNT.
  2065                     28  CR-ACCT-PREFIX    PIC X(4).
  2066                     28  CR-ACCT-PRIME     PIC X(6).
  2067             20  CR-DT                     PIC 9(11)  COMP-3.
  2068         16  CR-CERT-NO.
  2069             20  CR-CERT.
  2070                 24  CR-CERT-PREFIX        PIC X(3).
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  53
* ECS150P.cbl (/apps/prod/cid1p/copy/ECSCRT01)
  2071                 24  CR-CERT-PRIME         PIC X(7).
  2072             20  CR-CERT-SFX               PIC X.
  2073
  2074     12  CR-INSUREDS-PROFILE.
  2075         16  CR-NAME.
  2076             20  CR-LNAME                  PIC X(15).
  2077             20  CR-FNAME.
  2078                 24  CR-1ST-INITIAL        PIC X.
  2079                 24  FILLER                PIC X(9).
  2080             20  CR-INIT                   PIC X.
  2081         16  CR-AGE                        PIC 99.
  2082         16  CR-SEX                        PIC X.
  2083             88  CR-SEX-MALE                  VALUE 'M'.
  2084             88  CR-SEX-FEMALE                VALUE 'F'.
  2085         16  CR-SOC-SEC                    PIC X(11).
  2086         16  CR-JOINT-NAME.
  2087             20  CR-JT-LNAME               PIC X(15).
  2088             20  CR-JT-FNAME.
  2089                 24  CR-JT-1ST-INIT        PIC X.
  2090                 24  FILLER                PIC X(9).
  2091             20  CR-JT-INIT                PIC X.
  2092         16  CR-JOINT-AGE                  PIC 99.
  2093
  2094         16  cr-ahl-ah-claim-no            pic x(9).
  2095         16  cr-ahl-ah-cert-seq            pic x(3).
  2096         16  cr-hst-proc-lf                pic x.
  2097         16  f                             pic x(7).
  2098
  2099     12  CR-LF-COVERAGE-DATA.
  2100         16  CR-LFTYP                      PIC XX.
  2101         16  CR-LF-TERM                    PIC S999       COMP-3.
  2102         16  CR-LF-CRIT-PERIOD             PIC S999       COMP-3.
  2103         16  CR-LF-TERM-IN-DAYS            PIC S9(5)      COMP-3.
  2104         16  CR-LF-DEV-CODE                PIC XXX.
  2105         16  CR-LF-DEV-PCT                 PIC S9V9(6)    COMP-3.
  2106
  2107         16  CR-LFAMT                      PIC S9(9)V99   COMP-3.
  2108         16  CR-LFPRM                      PIC S9(7)V99   COMP-3.
  2109         16  CR-LFPRM-CALC                 PIC S9(7)V99   COMP-3.
  2110         16  CR-LFPRM-RATE                 PIC S99V9(5)   COMP-3.
  2111
  2112         16  CR-LFAMT-ALT                  PIC S9(9)V99   COMP-3.
  2113         16  CR-LFPRM-ALT                  PIC S9(7)V99   COMP-3.
  2114         16  CR-LFPRM-CALC-ALT             PIC S9(7)V99   COMP-3.
  2115         16  CR-LFPRM-RATE-ALT             PIC S99V9(5)   COMP-3.
  2116
  2117         16  CR-LFRFND                     PIC S9(7)V99   COMP-3.
  2118         16  CR-LFRFND-CALC                PIC S9(7)V99   COMP-3.
  2119
  2120         16  CR-LF-NSP-PRM                 PIC S9(7)V99   COMP-3.
  2121         16  CR-LF-NSP-PRM-RATE            PIC S99V9(5)   COMP-3.
  2122
  2123         16  CR-LF-REFUND-TYPE             PIC X.
  2124         16  CR-LF-POLICY-FEE              PIC S9(3)V99   COMP-3.
  2125
  2126         16  CR-LF-COMM-CHARGEBACK         PIC X.
  2127             88  CR-NO-LF-CHARGEBACK          VALUE 'N'.
  2128
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  54
* ECS150P.cbl (/apps/prod/cid1p/copy/ECSCRT01)
  2129         16  CR-LF-REI-RISK-PRM            PIC S9(7)V99   COMP-3.
  2130
  2131         16  CR-LF-EXPIRE-DATE             PIC 9(11)      COMP-3.
  2132         16  CR-LF-ISS-PREM-TAX            PIC S9V9(4)    COMP-3.
  2133         16  CR-LF-CNC-PREM-TAX            PIC S9V9(4)    COMP-3.
  2134
  2135         16  cr-ahl-lf-claim-no            pic x(9).
  2136         16  cr-ahl-lf-cert-seq            pic x(3).
  2137         16  FILLER                        PIC XX.
  2138
  2139     12  CR-AH-COVERAGE-DATA.
  2140         16  CR-AHTYP                      PIC XX.
  2141         16  CR-AH-TERM                    PIC S999       COMP-3.
  2142         16  CR-AH-CRIT-PERIOD             PIC S999       COMP-3.
  2143         16  CR-AH-DEV-CODE                PIC XXX.
  2144         16  CR-AH-DEV-PCT                 PIC S9V9(6)    COMP-3.
  2145
  2146         16  CR-AHAMT                      PIC S9(7)V99   COMP-3.
  2147         16  CR-AHPRM                      PIC S9(7)V99   COMP-3.
  2148         16  CR-AHPRM-CALC                 PIC S9(7)V99   COMP-3.
  2149         16  CR-AHPRM-RATE                 PIC S99V9(5)   COMP-3.
  2150
  2151         16  CR-AHRFND                     PIC S9(7)V99   COMP-3.
  2152         16  CR-AHRFND-CALC                PIC S9(7)V99   COMP-3.
  2153
  2154         16  CR-AH-NSP-PRM                 PIC S9(7)V99   COMP-3.
  2155         16  CR-AH-NSP-PRM-RATE            PIC S99V9(5)   COMP-3.
  2156
  2157         16  CR-AH-REFUND-TYPE             PIC X.
  2158         16  CR-AH-POLICY-FEE              PIC S9(3)V99   COMP-3.
  2159
  2160         16  CR-AH-COMM-CHARGEBACK         PIC X.
  2161             88  CR-NO-AH-CHARGEBACK          VALUE 'N'.
  2162
  2163         16  CR-AH-REI-RISK-PRM            PIC S9(7)V99   COMP-3.
  2164
  2165         16  CR-AH-EXPIRE-DATE             PIC 9(11)      COMP-3.
  2166         16  CR-AH-ISS-PREM-TAX            PIC S9V9(4)    COMP-3.
  2167         16  CR-AH-CNC-PREM-TAX            PIC S9V9(4)    COMP-3.
  2168
  2169         16  FILLER                        PIC XX.
  2170*        16  FILLER                        PIC X(8).
  2171
  2172     12  CR-LOAN-DATA.
  2173         16  CR-LIVES                      PIC S9(7)      COMP-3.
  2174         16  CR-DDF-IU-RATE-UP REDEFINES CR-LIVES
  2175                                           PIC S9(5)V99   COMP-3.
  2176         16  CR-BILLED                     PIC S9(7)      COMP-3.
  2177         16  CR-APR                        PIC S999V9(4)  COMP-3.
  2178         16  CR-PMT-FREQ                   PIC 99.
  2179         16  CR-LOAN-TERM                  PIC S999       COMP-3.
  2180         16  CR-RATING-CLASS               PIC XX.
  2181         16  CR-POLICY-FORM-NO             PIC X(12).
  2182         16  CR-GRPTYP                     PIC XX.
  2183         16  CR-IND-GRP                    PIC X.
  2184             88  CR-INDIVIDUAL                VALUE '1'.
  2185             88  CR-GROUP                     VALUE '2'.
  2186         16  CR-SKIP                       PIC 99.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  55
* ECS150P.cbl (/apps/prod/cid1p/copy/ECSCRT01)
  2187             88  NO-MONTHS-SKIPPED            VALUE 00.
  2188             88  SKIP-JULY                    VALUE 01.
  2189             88  SKIP-AUGUST                  VALUE 02.
  2190             88  SKIP-SEPTEMBER               VALUE 03.
  2191             88  SKIP-JULY-AUG                VALUE 04.
  2192             88  SKIP-AUG-SEPT                VALUE 05.
  2193             88  SKIP-JULY-AUG-SEPT           VALUE 06.
  2194             88  SKIP-JUNE-JULY-AUG           VALUE 07.
  2195             88  SKIP-JUNE                    VALUE 08.
  2196             88  SKIP-JUNE-JULY               VALUE 09.
  2197             88  SKIP-AUG-SEPT-OCT            VALUE 10.
  2198             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 11.
  2199         16  CR-RESIDENT-STATE             PIC XX.
  2200         16  CR-RATE-CODE.
  2201             20  CR-LF-CLASS-CD            PIC XX.
  2202             20  CR-AH-CLASS-CD            PIC XX.
  2203         16  CR-MORT.
  2204             20  CR-TAB                    PIC X.
  2205             20  CR-INT                    PIC 99.
  2206             20  CR-GRP                    PIC X.
  2207         16  CR-MEMBER-NO                  PIC X(12).
  2208         16  CR-OLD-LOF                    PIC XXX.
  2209*        16  CR-LOAN-OFFICER               PIC XXX.
  2210         16  CR-REIN-TABLE                 PIC XXX.
  2211         16  CR-REIN-SPEC                  PIC X.
  2212         16  CR-LOAN-1ST-PMT-DT.
  2213             20  CR-1ST-PMT-YR             PIC 99.
  2214             20  CR-1ST-PMT-MO             PIC 99.
  2215             20  CR-1ST-PMT-DA             PIC 99.
  2216         16  CR-SUM-CAN-CNT-ITD            PIC S999       COMP-3.
  2217         16  CR-SUM-CAN-CNT-YTD            PIC S999       COMP-3.
  2218         16  CR-PMT-EXTENSION-DAYS         PIC S999       COMP-3.
  2219         16  CR-LAST-ADD-ON-DT             PIC XX.
  2220
  2221         16  CR-UNDERWRITING-CODE          PIC X.
  2222             88  CR-POLICY-UNDERWRITTEN       VALUE 'Y'.
  2223
  2224         16  CR-STATE-TAX                  PIC S9(7)V99   COMP-3.
  2225         16  CR-MUNI-TAX                   PIC S9(7)V99   COMP-3.
  2226         16  CR-CANCEL-STATE-TAX           PIC S9(7)V99   COMP-3.
  2227         16  CR-CANCEL-MUNI-TAX            PIC S9(7)V99   COMP-3.
  2228
  2229     12  CR-STATUS-INFORMATION.
  2230         16  CR-ENTRY-STATUS               PIC X.
  2231             88  CR-NORMAL-ENTRY              VALUE '1'.
  2232             88  CR-POLICY-IS-RESTORE         VALUE '3'.
  2233             88  CR-CONVERSION-ENTRY          VALUE '4'.
  2234             88  CR-POLICY-IS-REISSUE         VALUE '5'.
  2235             88  CR-POLICY-IS-CASH            VALUE 'C'.
  2236             88  CR-POLICY-IS-MONTHLY         VALUE 'M'.
  2237             88  CR-POLICY-IS-REIN-ONLY       VALUE '9'.
  2238             88  CR-POLICY-IS-DECLINED        VALUE 'D'.
  2239             88  CR-POLICY-IS-VOID            VALUE 'V'.
  2240             88  CR-POLICY-IS-PREM-ONLY       VALUE 'P'.
  2241             88  CR-POLICY-IS-ACTIVE          VALUE '1' '3' '4'
  2242                                                'C' '5' '9' 'P'.
  2243         16  CR-ENTRY-DATE                 PIC 9(11)  COMP-3.
  2244
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  56
* ECS150P.cbl (/apps/prod/cid1p/copy/ECSCRT01)
  2245         16  CR-LF-STATUS-AT-CANCEL        PIC X.
  2246         16  CR-LF-CANC-DT                 PIC 9(11)  COMP-3.
  2247         16  CR-LF-CANCEL-EXIT-DATE        PIC 9(11)  COMP-3.
  2248
  2249         16  CR-LF-STATUS-AT-DEATH         PIC X.
  2250         16  CR-LF-CLAIM-EXIT-DATE         PIC 9(11)  COMP-3.
  2251
  2252         16  CR-LF-CURRENT-STATUS          PIC X.
  2253             88  CR-LF-NORMAL-ENTRY           VALUE '1'.
  2254             88  CR-LF-POLICY-PENDING         VALUE '2'.
  2255             88  CR-LF-POLICY-IS-RESTORE      VALUE '3'.
  2256             88  CR-LF-CONVERSION-ENTRY       VALUE '4'.
  2257             88  CR-LF-POLICY-IS-REISSUE      VALUE '5'.
  2258             88  CR-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  2259             88  CR-LF-LUMP-SUM-DISAB         VALUE '6'.
  2260             88  CR-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  2261             88  CR-LF-CANCEL-APPLIED         VALUE '8'.
  2262             88  CR-LF-IS-REIN-ONLY           VALUE '9'.
  2263             88  CR-LF-IS-DECLINED            VALUE 'D'.
  2264             88  CR-LF-IS-VOID                VALUE 'V'.
  2265             88  CR-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  2266                                                    '4' '5' '9'.
  2267
  2268         16  CR-AH-STATUS-AT-CANCEL        PIC X.
  2269
  2270         16  CR-AH-CANC-DT                 PIC 9(11)  COMP-3.
  2271         16  CR-AH-CANCEL-EXIT-DATE        PIC 9(11)  COMP-3.
  2272
  2273         16  CR-AH-STATUS-AT-SETTLEMENT    PIC X.
  2274         16  CR-AH-SETTLEMENT-EXIT-DATE    PIC 9(11)  COMP-3.
  2275
  2276         16  CR-AH-CURRENT-STATUS          PIC X.
  2277             88  CR-AH-NORMAL-ENTRY           VALUE '1'.
  2278             88  CR-AH-POLICY-PENDING         VALUE '2'.
  2279             88  CR-AH-POLICY-IS-RESTORE      VALUE '3'.
  2280             88  CR-AH-CONVERSION-ENTRY       VALUE '4'.
  2281             88  CR-AH-POLICY-IS-REISSUE      VALUE '5'.
  2282             88  CR-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  2283             88  CR-AH-LUMP-SUM-DISAB         VALUE '6'.
  2284             88  CR-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  2285             88  CR-AH-CANCEL-APPLIED         VALUE '8'.
  2286             88  CR-AH-IS-REIN-ONLY           VALUE '9'.
  2287             88  CR-AH-IS-DECLINED            VALUE 'D'.
  2288             88  CR-AH-IS-VOID                VALUE 'V'.
  2289             88  CR-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  2290                                                    '4' '5' '9'.
  2291         16  CR-LOAN-OFFICER               PIC X(5).
  2292         16  CR-CANCEL-REASON              PIC X.
  2293         16  cr-xycor-lf-cov-code          pic x(4).
  2294         16  cr-xycor-ah-cov-code          pic x(4).
  2295         16  cr-temp-epiq                  pic x(4).
  2296         16  FILLER                        PIC XX.
  2297
  2298     12  CR-DEATH-CLAIM-DATA.
  2299         16  CR-NUM-DTH-CLM                PIC S999       COMP-3.
  2300
  2301         16  CR-DTH-DT                     PIC 9(11)      COMP-3.
  2302         16  CR-DTH-RPT-DT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  57
* ECS150P.cbl (/apps/prod/cid1p/copy/ECSCRT01)
  2303             20  CR-DTH-RPT-YR             PIC 99.
  2304             20  CR-DTH-RPT-MO             PIC 99.
  2305             20  CR-DTH-RPT-DA             PIC 99.
  2306         16  CR-DTH-PAY-DT                 PIC 9(11)      COMP-3.
  2307
  2308         16  CR-DTHAMT                     PIC S9(9)V99   COMP-3.
  2309         16  CR-DTHAMT-YTD                 PIC S9(9)V99   COMP-3.
  2310         16  CR-DTHAMT-LAST                PIC S9(9)V99   COMP-3.
  2311         16  CR-DTHEXP                     PIC S9(7)V99   COMP-3.
  2312         16  CR-DTHEXP-YTD                 PIC S9(7)V99   COMP-3.
  2313
  2314         16  CR-DTH-AGE                    PIC 99.
  2315         16  CR-DTH-PAY-CD                 PIC X.
  2316         16  CR-DEATH-CAUSE                PIC X(6).
  2317
  2318         16  FILLER                        PIC X(16).
  2319
  2320     12  CR-DISAB-CLAIM-DATA.
  2321         16  CR-NUM-DIS-CLM                PIC S999       COMP-3.
  2322
  2323         16  CR-DIS-DT                     PIC 9(11)      COMP-3.
  2324         16  CR-DIS-RPT-DT.
  2325             20  CR-DIS-RPT-YR             PIC 99.
  2326             20  CR-DIS-RPT-MO             PIC 99.
  2327             20  CR-DIS-RPT-DA             PIC 99.
  2328         16  CR-DIS-PAY-DT                 PIC 9(11)      COMP-3.
  2329         16  CR-DIS-PTO-DT                 PIC 9(11)      COMP-3.
  2330
  2331         16  CR-DISAMT                     PIC S9(9)V99   COMP-3.
  2332         16  CR-DISAMT-YTD                 PIC S9(9)V99   COMP-3.
  2333         16  CR-DISAMT-LAST                PIC S9(9)V99   COMP-3.
  2334         16  CR-DISEXP                     PIC S9(7)V99   COMP-3.
  2335         16  CR-DISEXP-YTD                 PIC S9(7)V99   COMP-3.
  2336
  2337         16  CR-DAYS-DISAB                 PIC 999        COMP-3.
  2338         16  CR-DIS-PAY-CD                 PIC X.
  2339         16  FILLER                        PIC XX.
  2340
  2341         16  CR-DISAB-INCURRED-DETAIL.
  2342             20  CR-DISAB-DETAIL-DATA  OCCURS 5 TIMES.
  2343**ELCCRTVR MUST BE CHANGED IF THE "OCCURS" IS CHANGED.
  2344                 24  CR-DIS-INCUR-DT       PIC 9(11)     COMP-3.
  2345                 24  CR-INCUR-DISAMT       PIC S9(9)V99  COMP-3.
  2346                 24  CR-INCUR-DISEXP       PIC S9(9)V99  COMP-3.
  2347
  2348         16  CR-DISAB-CAUSE                PIC X(6).
  2349         16  FILLER                        PIC X(14).
  2350
  2351     12  CR-REMIT-TO                       PIC 99.
  2352
  2353     12  CR-COMPENSATION-LEVELS.
  2354         16  CR-AGT-LEVELS      OCCURS 10 TIMES.
  2355             20  CR-COM-AGT.
  2356                 24  CR-COM-AGT-PREFIX     PIC X(4).
  2357                 24  CR-COM-AGT-PRIME      PIC X(6).
  2358             20  CR-AGT-TYPE               PIC X.
  2359             20  CR-LCOM-L                 PIC SV9(5)     COMP-3.
  2360             20  CR-LCOM-AH                PIC SV9(5)     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  58
* ECS150P.cbl (/apps/prod/cid1p/copy/ECSCRT01)
  2361
  2362     12  CR-BANK-NOCHRGB-MONTHS            PIC 99.
  2363     12  CR-MOB-NET-TOT-FEES               PIC S9(7)V99   COMP-3.
  2364     12  CR-ADDL-CLP                       PIC S9(5)V99   COMP-3.
  2365     12  CR-CLP-STATE                      PIC XX.
  2366     12  CR-POST-CARD-IND                  PIC X.
  2367     12  CR-LF-CLP                         PIC S9(5)V99   COMP-3.
  2368     12  CR-AH-CLP                         PIC S9(5)V99   COMP-3.
  2369     12  CR-DCC-PRODUCT-CODE               PIC XXX.
  2370     12  CR-LF-RFND-CLP                    PIC S9(5)V99   COMP-3.
  2371     12  CR-AH-RFND-CLP                    PIC S9(5)V99   COMP-3.
  2372     12  FILLER                            PIC X(07).
  2373
  2374     12  CR-CSR-CODE                       PIC XXX.
  2375
  2376     12  CR-CLAIM-DEDUCT-WITHHELD          PIC S9(5)V99   COMP-3.
  2377     12  CR-CANCEL-DEDUCT-WITHHELD         PIC S9(5)V99   COMP-3.
  2378
  2379     12  CR-MICROFILM-NUMBERS.
  2380*        16  CR-ISS-MICROFILM-NO           PIC S9(9)      COMP-3.
  2381         16  FILLER                        PIC X(5).
  2382     12  CR-NH-INT-ON-REF                  PIC S9(7)V99   COMP-3.
  2383
  2384     12  CR-USER-CODE                      PIC X.
  2385     12  CR-USER-FUTURE                    PIC X(9).
  2386
  2387     12  CR-BENEFICIARY.
  2388         16  CR-BANK-NO                    PIC X(10).
  2389         16  FILLER                        PIC X(15).
  2390
  2391     12  CR-ENTRY-BATCH                    PIC X(6).
  2392     12  CR-LF-EXIT-BATCH                  PIC X(6).
  2393     12  CR-AH-EXIT-BATCH                  PIC X(6).
  2394
  2395     12  CR-NOTE-SW                        PIC X.
  2396
  2397     12  CR-ORIGIN-INDICATOR               PIC X.
  2398         88  CR-ENTERED-MANUALLY              VALUE '1'.
  2399         88  CR-CREATED-FROM-TAPE-LOAD        VALUE '2'.
  2400
  2401     12  CR-LF-CNC-ENT-DT                  PIC 9(11)  COMP-3.
  2402     12  CR-AH-CNC-ENT-DT                  PIC 9(11)  COMP-3.
  2403     12  FILLER                            PIC X(33).
  2404
  2405******************************************************************
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  59
* ECS150P.cbl
* 2407                             COPY ELCDATE.
  2408******************************************************************06/11/98
  2409*                                                                *ELCDATE
  2410*                                                                *ELCDATE
  2411*                            ELCDATE.                            *   LV023
  2412*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL*16
  2413*                            VMOD=2.003                           ELCDATE
  2414*                                                                *ELCDATE
  2415*                                                                *ELCDATE
  2416*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *ELCDATE
  2417*                 LENGTH = 200                                   *   CL*19
  2418******************************************************************ELCDATE
  2419                                                                  ELCDATE
  2420 01  DATE-CONVERSION-DATA.                                        ELCDATE
  2421     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.    CL*19
  2422     12  DC-OPTION-CODE                PIC X.                        CL*15
  2423         88  BIN-TO-GREG                VALUE ' '.                ELCDATE
  2424         88  ELAPSED-BETWEEN-BIN        VALUE '1'.                ELCDATE
  2425         88  EDIT-GREG-TO-BIN           VALUE '2'.                ELCDATE
  2426         88  YMD-GREG-TO-BIN            VALUE '3'.                ELCDATE
  2427         88  MDY-GREG-TO-BIN            VALUE '4'.                ELCDATE
  2428         88  JULIAN-TO-BIN              VALUE '5'.                ELCDATE
  2429         88  BIN-PLUS-ELAPSED           VALUE '6'.                ELCDATE
  2430         88  FIND-CENTURY               VALUE '7'.                   CL*22
  2431         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.                ELCDATE
  2432         88  EDIT-GREG-TO-BIN-3         VALUE '9'.                ELCDATE
  2433         88  YMD-GREG-TO-BIN-3          VALUE 'A'.                ELCDATE
  2434         88  MDY-GREG-TO-BIN-3          VALUE 'B'.                ELCDATE
  2435         88  JULIAN-TO-BIN-3            VALUE 'C'.                ELCDATE
  2436         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.                ELCDATE
  2437         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.                   CL*14
  2438         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.                   CL*14
  2439         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.                   CL*14
  2440         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.         CL*14
  2441         88  CHECK-LEAP-YEAR            VALUE 'H'.                   CL*14
  2442         88  BIN-3-TO-GREG              VALUE 'I'.                   CL*14
  2443         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.                   CL*14
  2444         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.                   CL*14
  2445         88  CYMD-GREG-TO-BIN           VALUE 'L'.                   CL*14
  2446         88  MDCY-GREG-TO-BIN           VALUE 'M'.                   CL*14
  2447         88  MDY-GREG-TO-JULIAN         VALUE 'N'.                   CL*14
  2448         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.                   CL*14
  2449         88  YMD-GREG-TO-JULIAN         VALUE 'P'.                   CL*14
  2450         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.                   CL*14
  2451         88  THREE-CHARACTER-BIN                                  ELCDATE
  2452                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.       CL*14
  2453         88  GREGORIAN-TO-BIN                                        CL**2
  2454                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.    CL*14
  2455         88  BIN-TO-GREGORIAN                                        CL**2
  2456                  VALUES ' ' '1' 'I' '8' 'G'.                        CL*14
  2457         88  JULIAN-TO-BINARY                                        CL**2
  2458                  VALUES '5' 'C' 'E' 'F'.                            CL*14
  2459     12  DC-ERROR-CODE                 PIC X.                        CL*15
  2460         88  NO-CONVERSION-ERROR        VALUE ' '.                   CL**3
  2461         88  DATE-CONVERSION-ERROR                                ELCDATE
  2462                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.        CL*14
  2463         88  DATE-IS-ZERO               VALUE '1'.                ELCDATE
  2464         88  DATE-IS-NON-NUMERIC        VALUE '2'.                ELCDATE
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  60
* ECS150P.cbl (/apps/prod/cid1p/copy/ELCDATE)
  2465         88  DATE-IS-INVALID            VALUE '3'.                ELCDATE
  2466         88  DATE1-GREATER-DATE2        VALUE '4'.                ELCDATE
  2467         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.                ELCDATE
  2468         88  DATE-INVALID-OPTION        VALUE '9'.                ELCDATE
  2469         88  INVALID-CENTURY            VALUE 'A'.                ELCDATE
  2470         88  ONLY-CENTURY               VALUE 'B'.                ELCDATE
  2471         88  ONLY-LEAP-YEAR             VALUE 'C'.                ELCDATE
  2472         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.              CL**3
  2473     12  DC-END-OF-MONTH               PIC X.                        CL*15
  2474         88  CALCULATE-END-OF-MONTH     VALUE '1'.                ELCDATE
  2475     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.         CL*15
  2476         88  USE-NORMAL-PROCESS         VALUE ' '.                ELCDATE
  2477         88  ADJUST-DOWN-100-YRS        VALUE '1'.                ELCDATE
  2478         88  ADJUST-UP-100-YRS          VALUE '2'.                ELCDATE
  2479     12  FILLER                        PIC X.                        CL*15
  2480     12  DC-CONVERSION-DATES.                                        CL*15
  2481         16  DC-BIN-DATE-1             PIC XX.                       CL*15
  2482         16  DC-BIN-DATE-2             PIC XX.                       CL*15
  2483         16  DC-GREG-DATE-1-EDIT       PIC X(08).                    CL*15
  2484         16  DC-GREG-DATE-1-EDIT-R REDEFINES                         CL*15
  2485                       DC-GREG-DATE-1-EDIT.                       ELCDATE
  2486             20  DC-EDIT1-MONTH        PIC 99.                       CL*15
  2487             20  SLASH1-1              PIC X.                        CL*15
  2488             20  DC-EDIT1-DAY          PIC 99.                       CL*15
  2489             20  SLASH1-2              PIC X.                        CL*15
  2490             20  DC-EDIT1-YEAR         PIC 99.                       CL*15
  2491         16  DC-GREG-DATE-2-EDIT       PIC X(08).                    CL*15
  2492         16  DC-GREG-DATE-2-EDIT-R REDEFINES                         CL*15
  2493                     DC-GREG-DATE-2-EDIT.                         ELCDATE
  2494             20  DC-EDIT2-MONTH        PIC 99.                       CL*15
  2495             20  SLASH2-1              PIC X.                        CL*15
  2496             20  DC-EDIT2-DAY          PIC 99.                       CL*15
  2497             20  SLASH2-2              PIC X.                        CL*15
  2498             20  DC-EDIT2-YEAR         PIC 99.                       CL*15
  2499         16  DC-GREG-DATE-1-YMD        PIC 9(06).                    CL*15
  2500         16  DC-GREG-DATE-1-YMD-R  REDEFINES                         CL*15
  2501                     DC-GREG-DATE-1-YMD.                          ELCDATE
  2502             20  DC-YMD-YEAR           PIC 99.                       CL*15
  2503             20  DC-YMD-MONTH          PIC 99.                       CL*15
  2504             20  DC-YMD-DAY            PIC 99.                       CL*15
  2505         16  DC-GREG-DATE-1-MDY        PIC 9(06).                    CL*15
  2506         16  DC-GREG-DATE-1-MDY-R REDEFINES                          CL*15
  2507                      DC-GREG-DATE-1-MDY.                         ELCDATE
  2508             20  DC-MDY-MONTH          PIC 99.                       CL*15
  2509             20  DC-MDY-DAY            PIC 99.                       CL*15
  2510             20  DC-MDY-YEAR           PIC 99.                       CL*15
  2511         16  DC-GREG-DATE-1-ALPHA.                                   CL*15
  2512             20  DC-ALPHA-MONTH        PIC X(10).                    CL*15
  2513             20  DC-ALPHA-DAY          PIC 99.                       CL*15
  2514             20  FILLER                PIC XX.                       CL*15
  2515             20  DC-ALPHA-CENTURY.                                   CL*15
  2516                 24 DC-ALPHA-CEN-N     PIC 99.                       CL*15
  2517             20  DC-ALPHA-YEAR         PIC 99.                       CL*15
  2518         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.           CL*15
  2519         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.           CL*15
  2520         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.           CL*15
  2521         16  DC-JULIAN-DATE            PIC 9(05).                    CL*15
  2522         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE                CL*20
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  61
* ECS150P.cbl (/apps/prod/cid1p/copy/ELCDATE)
  2523                                       PIC 9(05).                    CL*20
  2524         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.                  CL*15
  2525             20  DC-JULIAN-YEAR        PIC 99.                       CL*15
  2526             20  DC-JULIAN-DAYS        PIC 999.                      CL*15
  2527         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.       CL*15
  2528         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.    CL*15
  2529         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.    CL*15
  2530     12  DATE-CONVERSION-VARIBLES.                                   CL*15
  2531         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.            CL*15
  2532         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.          CL*15
  2533             20  FILLER                PIC 9(3).                     CL*15
  2534             20  HOLD-CEN-1-CCYY.                                    CL*15
  2535                 24  HOLD-CEN-1-CC     PIC 99.                       CL*17
  2536                 24  HOLD-CEN-1-YY     PIC 99.                       CL*17
  2537             20  HOLD-CEN-1-MO         PIC 99.                       CL*17
  2538             20  HOLD-CEN-1-DA         PIC 99.                       CL*17
  2539         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.            CL*15
  2540             20  HOLD-CEN-1-R-MO       PIC 99.                       CL*17
  2541             20  HOLD-CEN-1-R-DA       PIC 99.                       CL*17
  2542             20  HOLD-CEN-1-R-CCYY.                                  CL*15
  2543                 24  HOLD-CEN-1-R-CC   PIC 99.                       CL*17
  2544                 24  HOLD-CEN-1-R-YY   PIC 99.                       CL*17
  2545             20  FILLER                PIC 9(3).                     CL*15
  2546         16  HOLD-CENTURY-1-X.                                       CL*15
  2547             20  FILLER                PIC X(3)  VALUE SPACES.       CL*15
  2548             20  HOLD-CEN-1-X-CCYY.                                  CL*15
  2549                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.          CL*17
  2550                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.          CL*17
  2551             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.          CL*17
  2552             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.          CL*17
  2553         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.          CL*15
  2554             20  HOLD-CEN-1-R-X-MO     PIC XX.                       CL*17
  2555             20  HOLD-CEN-1-R-X-DA     PIC XX.                       CL*17
  2556             20  HOLD-CEN-1-R-X-CCYY.                                CL*15
  2557                 24  HOLD-CEN-1-R-X-CC PIC XX.                       CL*17
  2558                 24  HOLD-CEN-1-R-X-YY PIC XX.                       CL*17
  2559             20  FILLER                PIC XXX.                      CL*23
  2560         16  DC-BIN-DATE-EXPAND-1      PIC XXX.                      CL*15
  2561         16  DC-BIN-DATE-EXPAND-2      PIC XXX.                      CL*15
  2562         16  DC-JULIAN-DATE-1          PIC 9(07).                    CL*15
  2563         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.          CL*15
  2564             20  DC-JULIAN-1-CCYY.                                   CL*15
  2565                 24  DC-JULIAN-1-CC    PIC 99.                       CL*15
  2566                 24  DC-JULIAN-1-YR    PIC 99.                       CL*15
  2567             20  DC-JULIAN-DA-1        PIC 999.                      CL*15
  2568         16  DC-JULIAN-DATE-2          PIC 9(07).                    CL*15
  2569         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.          CL*15
  2570             20  DC-JULIAN-2-CCYY.                                   CL*15
  2571                 24  DC-JULIAN-2-CC    PIC 99.                       CL*15
  2572                 24  DC-JULIAN-2-YR    PIC 99.                       CL*15
  2573             20  DC-JULIAN-DA-2        PIC 999.                      CL*15
  2574         16  DC-GREG-DATE-A-EDIT.                                    CL*15
  2575             20  DC-EDITA-MONTH        PIC 99.                       CL*15
  2576             20  SLASHA-1              PIC X VALUE '/'.              CL*15
  2577             20  DC-EDITA-DAY          PIC 99.                       CL*15
  2578             20  SLASHA-2              PIC X VALUE '/'.              CL*15
  2579             20  DC-EDITA-CCYY.                                      CL*15
  2580                 24  DC-EDITA-CENT     PIC 99.                       CL*15
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  62
* ECS150P.cbl (/apps/prod/cid1p/copy/ELCDATE)
  2581                 24  DC-EDITA-YEAR     PIC 99.                       CL*15
  2582         16  DC-GREG-DATE-B-EDIT.                                    CL*15
  2583             20  DC-EDITB-MONTH        PIC 99.                       CL*15
  2584             20  SLASHB-1              PIC X VALUE '/'.              CL*15
  2585             20  DC-EDITB-DAY          PIC 99.                       CL*15
  2586             20  SLASHB-2              PIC X VALUE '/'.              CL*15
  2587             20  DC-EDITB-CCYY.                                      CL*15
  2588                 24  DC-EDITB-CENT     PIC 99.                       CL*15
  2589                 24  DC-EDITB-YEAR     PIC 99.                       CL*15
  2590         16  DC-GREG-DATE-CYMD         PIC 9(08).                    CL*15
  2591         16  DC-GREG-DATE-CYMD-R REDEFINES                           CL*15
  2592                              DC-GREG-DATE-CYMD.                  ELCDATE
  2593             20  DC-CYMD-CEN           PIC 99.                       CL*15
  2594             20  DC-CYMD-YEAR          PIC 99.                       CL*15
  2595             20  DC-CYMD-MONTH         PIC 99.                       CL*15
  2596             20  DC-CYMD-DAY           PIC 99.                       CL*15
  2597         16  DC-GREG-DATE-MDCY         PIC 9(08).                    CL*15
  2598         16  DC-GREG-DATE-MDCY-R REDEFINES                           CL*15
  2599                              DC-GREG-DATE-MDCY.                  ELCDATE
  2600             20  DC-MDCY-MONTH         PIC 99.                       CL*15
  2601             20  DC-MDCY-DAY           PIC 99.                       CL*15
  2602             20  DC-MDCY-CEN           PIC 99.                       CL*15
  2603             20  DC-MDCY-YEAR          PIC 99.                       CL*15
  2604    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.      ELCDATE
  2605        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.        ELCDATE
  2606    12  DC-EL310-DATE                  PIC X(21).                    CL*26
  2607    12  FILLER                         PIC X(28).                    CL*26
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  63
* ECS150P.cbl
* 2609                             COPY ELCCALC.
  2610******************************************************************04/15/98
  2611*                                                                *ELCCALC
  2612*                           ELCCALC.                            *    LV003
  2613*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
  2614*                            VMOD=2.025                          *   CL**3
  2615*                                                                *   CL**2
  2616*   DESCRIPTION:  DATA TO BE PASSED TO REMAINING TERM ROUTINE    *   CL**2
  2617*                 REMAINING AMOUNT ROUTINE, LOSS RESERVE ROUTINE *   CL**2
  2618*                 REFUND CALCULATIONS ROUTINE, EARNINGS CALCU -  *   CL**2
  2619*                 LATIONS ROUTINE, AND THE RATING ROUTINE.       *   CL**2
  2620*                                                                *   CL**2
  2621*  PASSED TO ELRTRM                                              *   CL**2
  2622*  -----------------                                             *   CL**2
  2623*  METHOD CODE (I.E. FULL MONTH, HALF ADJ, ETC)                  *   CL**2
  2624*  ORIGINAL TERM                                                 *   CL**2
  2625*  BEGINNING DATE                                                *   CL**2
  2626*  ENDING DATE                                                   *   CL**2
  2627*  COMPANY I.D.                                                  *   CL**2
  2628*  ACCOUNT MASTER USER FIELD                                     *   CL**2
  2629*  PROCESS SWITCH (CANCEL, CLAIM)                                *   CL**2
  2630*  FREE LOOK DAYS                                                *   CL**2
  2631*                                                                *   CL**2
  2632*  RETURNED FROM ELRTRM                                          *   CL**2
  2633*  ---------------------                                         *   CL**2
  2634*  REMAINING TERM 1 - USED FOR EARNINGS                          *   CL**2
  2635*  REMAINING TERM 2 - USED FOR BENEFIT CALCULATIONS              *   CL**2
  2636*  REMAINING TERM 3 - USED FOR CLAIM BENEFITS                    *   CL**2
  2637*  ODD DAYS - REMAINING DAYS PAST FULL MONTHS                    *   CL**2
  2638*----------------------------------------------------------------*   CL**2
  2639*  PASSED TO ELRAMT                                              *   CL**2
  2640*  ----------------                                              *   CL**2
  2641*  REMAINING TERM 1 OR 2 OR 3 (FROM ELRTRM)                      *   CL**2
  2642*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *   CL**2
  2643*  ORIGINAL AMOUNT                                               *   CL**2
  2644*  ALTERNATE BENEFIT (BALLON)                                    *   CL**2
  2645*  A.P.R. - NET PAY ONLY                                         *   CL**2
  2646*  METHOD                                                            CL**2
  2647*  PAYMENT FREQUENCY - FOR FARM PLAN                             *   CL**2
  2648*  COMPANY I.D.                                                  *   CL**2
  2649*  BENEFIT TYPE                                                  *   CL**2
  2650*                                                                *   CL**2
  2651*  RETURNED FROM ELRAMT                                          *   CL**2
  2652*  --------------------                                          *   CL**2
  2653*  REMAINING AMOUNT 1 - CURRENT                                  *   CL**2
  2654*  REMAINING AMOUNT 2 - PREVIOUS MONTH                           *   CL**2
  2655*  REMAINING AMOUNT FACTOR                                           CL**2
  2656*----------------------------------------------------------------*   CL**2
  2657*  PASSED TO ELRESV                                              *   CL**2
  2658*  -----------------                                             *   CL**2
  2659*  CERTIFICATE EFFECTIVE DATE                                    *   CL**2
  2660*  VALUATION DATE                                                *   CL**2
  2661*  PAID THRU DATE                                                *   CL**2
  2662*  BENEFIT                                                       *   CL**2
  2663*  INCURRED DATE                                                 *   CL**2
  2664*  REPORTED DATE                                                 *   CL**2
  2665*  ISSUE AGE                                                     *   CL**2
  2666*  TERM                                                          *   CL**2
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  64
* ECS150P.cbl (/apps/prod/cid1p/copy/ELCCALC)
  2667*  CDT PERCENT                                                   *   CL**2
  2668*  CDT METHOD (I.E. INTERPOLATED, AVERAGE, ETC)                  *   CL**2
  2669* *CLAIM TYPE (LIFE, A/H)                                        *   CL**2
  2670* *REMAINING BENEFIT (FROM ELRAMT)                               *   CL**2
  2671* *ONLY FIELDS REQUIRED FOR LIFE CLAIMS                          *   CL**2
  2672*                                                                *   CL**2
  2673*  RETURNED FROM ELRESV                                          *   CL**2
  2674*  --------------------                                          *   CL**2
  2675*  CDT TABLE USED                                                *   CL**2
  2676*  CDT FACTOR USED                                               *   CL**2
  2677*  PAY TO CURRENT RESERVE                                        *   CL**2
  2678*  I.B.N.R. - A/H ONLY                                           *   CL**2
  2679*  FUTURE (ACCRUED) AH ONLY                                      *   CL**2
  2680*----------------------------------------------------------------*   CL**2
  2681*  PASSED TO ELRATE                                              *   CL**2
  2682*  ----------------                                              *   CL**2
  2683*  CERT ISSUE DATE                                               *   CL**2
  2684*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *   CL**2
  2685*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *   CL**2
  2686*  CAPPED TERM   (ONLY FOR TRUNCATED LIFE)                       *   CL**2
  2687*  STATE CODE (CLIENT DEFINED)                                   *   CL**2
  2688*  STATE CODE (STANDARD P.O. ABBRV)                              *   CL**2
  2689*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *   CL**2
  2690*  DEVIATION CODE                                                *   CL**2
  2691*  ISSUE AGE                                                     *   CL**2
  2692*  ORIGINAL BENEFIT AMOUNT                                       *   CL**2
  2693*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *   CL**2
  2694*  PROCESS TYPE (ISSUE OR CANCEL)                                *   CL**2
  2695*  BENEFIT KIND (LIFE OR A/H)                                    *   CL**2
  2696*  A.P.R.                                                        *   CL**2
  2697*  METHOD                                                            CL**2
  2698*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *   CL**2
  2699*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *   CL**2
  2700*  COMPANY I.D. (3 CHARACTER)                                    *   CL**2
  2701*  BENEFIT CODE                                                  *   CL**2
  2702*  BENEFIT OVERRIDE CODE                                         *   CL**2
  2703*  MAXIMUM MONTHLY BENEFIT (FROM ACCT MASTER - CSL ONLY)         *   CL**2
  2704*  MAXIMUM TOTAL BENEFIT (FROM ACCT MASTER - CSL ONLY)           *   CL**2
  2705*  JOINT INDICATOR (CSL ONLY)                                    *   CL**2
  2706*  FIRST PAYMENT DATE (CSL ONLY)                                 *   CL**2
  2707*  PERIODIC PAYMENT AMOUNT (IN CP-REMAINING-TERM - CSL ONLY)     *   CL**2
  2708*                                                                *   CL**2
  2709*  RETURNED FROM ELRATE                                          *   CL**2
  2710*  --------------------                                          *   CL**2
  2711*  CALCULATED PREMIUM                                            *   CL**2
  2712*  PREMIUM RATE                                                  *   CL**2
  2713*  MORTALITY CODE                                                *   CL**2
  2714*  MAX ATTAINED AGE                                              *   CL**2
  2715*  MAX AGE                                                       *   CL**2
  2716*  MAX TERM                                                      *   CL**2
  2717*  MAX MONTHLY BENEFIT                                           *   CL**2
  2718*  MAX TOTAL BENIFIT                                             *   CL**2
  2719*  COMPOSITE RATE (OPEN-END ONLY)                                *   CL**2
  2720*----------------------------------------------------------------*   CL**2
  2721*  PASSED TO ELRFND                                              *   CL**2
  2722*  ----------------                                              *   CL**2
  2723*  CERT ISSUE DATE                                               *   CL**2
  2724*  REFUND DATE                                                   *   CL**2
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  65
* ECS150P.cbl (/apps/prod/cid1p/copy/ELCCALC)
  2725*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *   CL**2
  2726*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *   CL**2
  2727*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *   CL**2
  2728*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *   CL**2
  2729*  STATE CODE (CLIENT DEFINED)                                   *   CL**2
  2730*  STATE CODE (STANDARD P.O. ABBRV)                              *   CL**2
  2731*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *   CL**2
  2732*  DEVIATION CODE                                                *   CL**2
  2733*  ISSUE AGE                                                     *   CL**2
  2734*  ORIGINAL BENEFIT AMOUNT                                       *   CL**2
  2735*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *   CL**2
  2736*  PROCESS TYPE (CANCEL)                                         *   CL**2
  2737*  BENEFIT KIND (LIFE OR A/H)                                    *   CL**2
  2738*  A.P.R.                                                        *   CL**2
  2739*  EARNING METHOD - (CODE FROM BENEFIT, STATE OR ACCOUNT RECORD) *   CL**2
  2740*  RATING METHOD -  (CODE FROM BENEFIT)                          *   CL**2
  2741*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *   CL**2
  2742*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *   CL**2
  2743*  COMPANY I.D. (3 CHARACTER)                                    *   CL**2
  2744*  BENEFIT CODE                                                  *   CL**2
  2745*  BENEFIT OVERRIDE CODE                                         *   CL**2
  2746*                                                                *   CL**2
  2747*  RETURNED FROM ELRFND                                          *   CL**2
  2748*  --------------------                                          *   CL**2
  2749*  CALCULATED REFUND                                             *   CL**2
  2750*----------------------------------------------------------------*   CL**2
  2751*  PASSED TO ELEARN                                              *   CL**2
  2752*  ----------------                                              *   CL**2
  2753*  CERT ISSUE DATE                                               *   CL**2
  2754*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *   CL**2
  2755*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *   CL**2
  2756*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *   CL**2
  2757*  STATE CODE (CLIENT DEFINED)                                   *   CL**2
  2758*  STATE CODE (STANDARD P.O. ABBRV)                              *   CL**2
  2759*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *   CL**2
  2760*  DEVIATION CODE                                                *   CL**2
  2761*  ISSUE AGE                                                     *   CL**2
  2762*  ORIGINAL BENEFIT AMOUNT                                       *   CL**2
  2763*  BENEFIT KIND (LIFE OR A/H)                                    *   CL**2
  2764*  A.P.R.                                                        *   CL**2
  2765*  METHOD - (EARNING CODE FROM BENEFIT RECORD)                   *   CL**2
  2766*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *   CL**2
  2767*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *   CL**2
  2768*  COMPANY I.D. (3 CHARACTER)                                    *   CL**2
  2769*  BENEFIT CODE                                                  *   CL**2
  2770*  BENEFIT OVERRIDE CODE                                         *   CL**2
  2771*                                                                *   CL**2
  2772*  RETURNED FROM ELEARN                                          *   CL**2
  2773*  --------------------                                          *   CL**2
  2774*  INDICATED  EARNINGS                                           *   CL**2
  2775*----------------------------------------------------------------*   CL**2
  2776*                 LENGTH = 450                                   *   CL**2
  2777*                                                                *   CL**2
  2778******************************************************************   CL**2
  2779******************************************************************
  2780*                   C H A N G E   L O G
  2781*
  2782* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  66
* ECS150P.cbl (/apps/prod/cid1p/copy/ELCCALC)
  2783*-----------------------------------------------------------------
  2784*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2785* EFFECTIVE    NUMBER
  2786*-----------------------------------------------------------------
  2787* 010303    2001061800003  PEMA  ADD DCC/MONTHLY PROCESSING
  2788* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  2789* 101807    2007100100007  PEMA  EXPAND CLM RESERVE FIELDS
  2790* 010410    2008021200005  PEMA  ADD FIELDS FOR MN NET PAY BALLOON
  2791* 010410    2009050700003  PEMA  ADD FIELDS FOR SPP-DD
  2792* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  2793* 041710    2007111300001  AJRA  ADD CLAIM CALC SW FOR SC NP+6
  2794* 101110  CR2010012700001  PEMA ADD DDF REFUND/UEP PROCESSING
  2795* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  2796* 040615  CR2013072200002  PEMA  ADD EXTRA PERIODS
  2797******************************************************************
  2798                                                                     CL**2
  2799 01  CALCULATION-PASS-AREA.                                          CL**2
  2800     12  CP-COMM-LENGTH            PIC S9(4)         VALUE +450      CL**2
  2801                                     COMP.                           CL**2
  2802                                                                     CL**2
  2803     12  CP-RETURN-CODE            PIC X             VALUE ZERO.     CL**2
  2804       88  NO-CP-ERROR                             VALUE ZERO.       CL**2
  2805       88  CP-ERROR-OCCURED VALUE '1' '2' '3' '4' '5' '6' '7' '8'    CL**2
  2806                                  '9' 'A' 'B' 'C' 'D' 'E' 'H'.       CL**2
  2807       88  CP-ERROR-IN-AMOUNTS                     VALUE '1'.        CL**2
  2808       88  CP-ERROR-IN-DATES                       VALUE '2'.        CL**2
  2809       88  CP-ERROR-IN-OPTIONS                     VALUE '3'.        CL**2
  2810       88  CP-ERROR-IN-TERMS                       VALUE '4'.        CL**2
  2811       88  CP-ERROR-IN-FREQUENCY                   VALUE '5'.        CL**2
  2812       88  CP-ERROR-RATE-NOT-FOUND                 VALUE '6'.        CL**2
  2813       88  CP-ERROR-RATE-IS-ZERO                   VALUE '7'.        CL**2
  2814       88  CP-ERROR-AMT-OUTSIDE-LIMIT              VALUE '8'.        CL**2
  2815       88  CP-ERROR-TERM-OUTSIDE-LIMIT             VALUE '9'.        CL**2
  2816       88  CP-ERROR-AGE-OUTSIDE-LIMIT              VALUE 'A'.        CL**2
  2817       88  CP-ERROR-ATT-OUTSIDE-LIMIT              VALUE 'B'.        CL**2
  2818       88  CP-ERROR-TOT-OUTSIDE-LIMIT              VALUE 'C'.        CL**2
  2819       88  CP-ERROR-RATE-FILE-NOTOPEN              VALUE 'D'.        CL**2
  2820       88  CP-ERROR-ISSUE-AGE-ZERO                 VALUE 'E'.        CL**2
  2821       88  CP-ERROR-NO-LIMITS-CRI                  VALUE 'F'.        CL**2
  2822       88  CP-ERROR-DIV-BY-ZERO                    VALUE 'G'.        CL**2
  2823       88  CP-ERROR-LOAN-TERM                      VALUE 'H'.        CL**2
  2824                                                                     CL**2
  2825     12  CP-RETURN-CODE-2          PIC X             VALUE ZERO.     CL**2
  2826       88  NO-CP-ERROR-2                           VALUE ZERO.       CL**2
  2827***********************  INPUT AREAS ****************************    CL**2
  2828                                                                     CL**2
  2829     12  CP-CALCULATION-AREA.                                        CL**2
  2830         16  CP-ACCOUNT-NUMBER     PIC X(10)       VALUE SPACES.     CL**2
  2831         16  CP-CERT-EFF-DT        PIC XX.                           CL**2
  2832         16  CP-VALUATION-DT       PIC XX.                           CL**2
  2833         16  CP-PAID-THRU-DT       PIC XX.                           CL**2
  2834         16  CP-BENEFIT-TYPE       PIC X.                            CL**2
  2835           88  CP-AH                               VALUE 'A' 'D'     CL**2
  2836                                                   'I' 'U'.          CL**2
  2837           88  CP-REDUCING-LIFE                    VALUE 'R'.        CL**2
  2838           88  CP-LEVEL-LIFE                       VALUE 'L' 'P'.    CL**2
  2839         16  CP-INCURRED-DT        PIC XX.                           CL**2
  2840         16  CP-REPORTED-DT        PIC XX.                           CL**2
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  67
* ECS150P.cbl (/apps/prod/cid1p/copy/ELCCALC)
  2841         16  CP-ACCT-FLD-5         PIC XX            VALUE SPACE.    CL**2
  2842         16  CP-COMPANY-ID         PIC XXX           VALUE SPACE.    CL**2
  2843         16  CP-ISSUE-AGE          PIC S9(3)         VALUE ZERO      CL**2
  2844                                     COMP-3.                         CL**2
  2845         16  CP-CDT-PERCENT        PIC S9(3)V99      VALUE ZERO      CL**2
  2846                                     COMP-3.                         CL**2
  2847         16  CP-CDT-METHOD         PIC X.                            CL**2
  2848           88  CP-CDT-ROUND-NEAR                   VALUE '1'.        CL**2
  2849           88  CP-CDT-ROUND-HIGH                   VALUE '2'.        CL**2
  2850           88  CP-CDT-INTERPOLATED                 VALUE '3'.        CL**2
  2851         16  CP-CLAIM-TYPE         PIC X.                            CL**2
  2852           88  CP-AH-CLAIM                         VALUE 'A'.        CL**2
  2853           88  CP-LIFE-CLAIM                       VALUE 'L'.        CL**2
  2854         16  CP-ORIGINAL-TERM      PIC S9(3)         VALUE ZERO      CL**2
  2855                                     COMP-3.                         CL**2
  2856         16  CP-ORIGINAL-BENEFIT   PIC S9(9)V99      VALUE ZERO      CL**2
  2857                                     COMP-3.                         CL**2
  2858         16  CP-ORIGINAL-PREMIUM   PIC S9(7)V99      VALUE ZERO      CL**2
  2859                                     COMP-3.                         CL**2
  2860         16  CP-REMAINING-TERM     PIC S9(3)V99      VALUE ZERO      CL**2
  2861                                     COMP-3.                         CL**2
  2862         16  CP-REMAINING-BENEFIT  PIC S9(9)V99      VALUE ZERO      CL**2
  2863                                     COMP-3.                         CL**2
  2864         16  CP-LOAN-APR           PIC S9(3)V9(4)    VALUE ZERO      CL**2
  2865                                     COMP-3.                         CL**2
  2866         16  CP-PAY-FREQUENCY      PIC S9(3)         VALUE ZERO      CL**2
  2867                                     COMP-3.                         CL**2
  2868         16  CP-REM-TERM-METHOD    PIC X.                            CL**2
  2869           88  CP-EARN-AFTER-15TH                  VALUE '1'.        CL**2
  2870           88  CP-EARN-ON-HALF-MONTH               VALUE '2'.        CL**2
  2871           88  CP-EARN-ON-1ST-DAY                  VALUE '3'.        CL**2
  2872           88  CP-EARN-ON-FULL-MONTH               VALUE '4'.        CL**2
  2873           88  CP-EARN-WITH-NO-DAYS                VALUE '5'.        CL**2
  2874           88  CP-EARN-AFTER-14TH                  VALUE '6'.        CL**2
  2875           88  CP-EARN-AFTER-16TH                  VALUE '7'.        CL**2
  2876         16  CP-EARNING-METHOD     PIC X.                            CL**2
  2877           88  CP-EARN-BY-R78                      VALUE '1' 'R'.    CL**2
  2878           88  CP-EARN-BY-PRORATA                  VALUE '2' 'P'.    CL**2
  2879           88  CP-EARN-AS-CALIF                    VALUE '3' 'C'.    CL**2
  2880           88  CP-EARN-AS-TEXAS                    VALUE '4' 'T'.    CL**2
  2881           88  CP-EARN-AS-FARM-PLAN                VALUE '4' 'T'.    CL**2
  2882           88  CP-EARN-AS-NET-PAY                  VALUE '5' 'N'.    CL**2
  2883           88  CP-EARN-ANTICIPATION                VALUE '6' 'A'.    CL**2
  2884           88  CP-EARN-AS-MEAN                     VALUE '8' 'M'.    CL**2
  2885           88  CP-EARN-AS-SUM-OF-DIGITS            VALUE '9'.        CL**2
  2886           88  CP-EARN-AS-REG-BALLOON              VALUE 'B'.        CL**2
  2887           88  CP-GAP-NON-REFUNDABLE               VALUE 'G'.
  2888           88  CP-GAP-ACTUARIAL                    VALUE 'S'.
  2889           88  CP-DCC-SPP-DDF                      VALUE 'D' 'I'.
  2890           88  CP-DCC-SPP-DDF-IU                   VALUE 'I'.
  2891         16  CP-PROCESS-TYPE       PIC X.                            CL**2
  2892           88  CP-CLAIM                            VALUE '1'.        CL**2
  2893           88  CP-CANCEL                           VALUE '2'.        CL**2
  2894           88  CP-ISSUE                            VALUE '3'.        CL**2
  2895         16  CP-SPECIAL-CALC-CD    PIC X.                            CL**2
  2896           88  CP-OUTSTANDING-BAL              VALUE 'O'.            CL**2
  2897           88  CP-1-MTH-INTEREST               VALUE ' '.            CL**2
  2898           88  CP-0-MTH-INTEREST               VALUE 'A'.            CL**2
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  68
* ECS150P.cbl (/apps/prod/cid1p/copy/ELCCALC)
  2899           88  CP-OB-OFFLINE-RESERVED          VALUE 'B'.            CL**2
  2900           88  CP-CRITICAL-PERIOD              VALUE 'C'.            CL**2
  2901           88  CP-TERM-IS-DAYS                 VALUE 'D'.            CL**2
  2902           88  CP-USE-PREM-AS-ENTERED          VALUE 'E'.            CL**2
  2903           88  CP-FARM-PLAN                    VALUE 'F'.            CL**2
  2904           88  CP-RATE-AS-STANDARD             VALUE 'G'.            CL**2
  2905           88  CP-2-MTH-INTEREST               VALUE 'I'.            CL**2
  2906           88  CP-3-MTH-INTEREST               VALUE 'J'.            CL**2
  2907           88  CP-4-MTH-INTEREST               VALUE 'K'.            CL**2
  2908           88  CP-BALLOON-LAST-PMT             VALUE 'L'.            CL**2
  2909           88  CP-MORTGAGE-REC                 VALUE 'M'.            CL**2
  2910           88  CP-OUTSTANDING-BALANCE          VALUE 'O'.            CL**2
  2911           88  CP-NET-PAY-PRUDENTIAL           VALUE 'P'.            CL**2
  2912           88  CP-NET-PAY-SIMPLE               VALUE 'S'.            CL**2
  2913           88  CP-TRUNCATED-LIFE               VALUE 'T' 'U' 'V'     CL**2
  2914                                                     'W' 'X'.        CL**2
  2915           88  CP-TRUNCATE-0-MTH               VALUE 'T'.            CL**2
  2916           88  CP-TRUNCATE-1-MTH               VALUE 'U'.            CL**2
  2917           88  CP-TRUNCATE-2-MTH               VALUE 'V'.            CL**2
  2918           88  CP-TRUNCATE-3-MTH               VALUE 'W'.            CL**2
  2919           88  CP-TRUNCATE-4-MTH               VALUE 'X'.            CL**2
  2920           88  CP-SUMMARY-REC                  VALUE 'Z'.            CL**2
  2921           88  CP-PROPERTY-BENEFIT             VALUE '2'.            CL**2
  2922           88  CP-UNEMPLOYMENT-BENEFIT         VALUE '3'.            CL**2
  2923           88  CP-AD-D-BENEFIT                 VALUE '4'.            CL**2
  2924           88  CP-CSL-METH-1                   VALUE '5'.            CL**2
  2925           88  CP-CSL-METH-2                   VALUE '6'.            CL**2
  2926           88  CP-CSL-METH-3                   VALUE '7'.            CL**2
  2927           88  CP-CSL-METH-4                   VALUE '8'.            CL**2
  2928                                                                     CL**2
  2929         16  CP-LOAN-TERM          PIC S9(3)       VALUE ZERO        CL**2
  2930                                     COMP-3.                         CL**2
  2931         16  CP-CLASS-CODE         PIC XX          VALUE ZERO.       CL**2
  2932         16  CP-DEVIATION-CODE     PIC XXX         VALUE ZERO.       CL**2
  2933         16  CP-STATE              PIC XX          VALUE SPACE.      CL**2
  2934         16  CP-STATE-STD-ABBRV    PIC XX          VALUE SPACE.      CL**2
  2935         16  CP-BENEFIT-CD         PIC XX          VALUE ZERO.       CL**2
  2936           88  CP-CSL-VALID-NP-BENEFIT-CD VALUES '12' '13'           CL**2
  2937               '34' '35' '36' '37' '44' '45' '46' '47' '72' '73'.    CL**2
  2938         16  CP-R78-OPTION         PIC X.                            CL**2
  2939           88  CP-TERM-TIMES-TERM-PLUS-1           VALUE ' '.        CL**2
  2940           88  CP-TERM-TIMES-TERM                  VALUE '1'.        CL**2
  2941                                                                     CL**2
  2942         16  CP-COMPANY-CD         PIC X             VALUE SPACE.    CL**2
  2943         16  CP-IBNR-RESERVE-SW    PIC X.                            CL**2
  2944         16  CP-CLAIM-STATUS       PIC X.                            CL**2
  2945         16  CP-RATE-FILE          PIC X.                            CL**2
  2946         16  CP-TERM-OR-EXT-DAYS   PIC S9(05)        VALUE ZERO      CL**2
  2947                                     COMP-3.                         CL**2
  2948                                                                     CL**2
  2949         16  CP-LIFE-OVERRIDE-CODE PIC X.                            CL**2
  2950         16  CP-AH-OVERRIDE-CODE   PIC X.                            CL**2
  2951                                                                     CL**2
  2952         16  CP-RATE-DEV-PCT       PIC S9V9(6)       VALUE ZERO      CL**2
  2953                                     COMP-3.
  2954         16  CP-CLP-RATE-UP        REDEFINES CP-RATE-DEV-PCT
  2955                                   PIC S9(5)V99 COMP-3.
  2956         16  CP-CRITICAL-MONTHS    PIC S9(3)         VALUE ZERO      CL**2
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  69
* ECS150P.cbl (/apps/prod/cid1p/copy/ELCCALC)
  2957                                     COMP-3.                         CL**2
  2958         16  CP-ALTERNATE-BENEFIT  PIC S9(9)V99      VALUE ZERO      CL**2
  2959                                     COMP-3.                         CL**2
  2960         16  CP-ALTERNATE-PREMIUM  PIC S9(7)V99      VALUE ZERO      CL**2
  2961                                     COMP-3.
  2962         16  CP-DDF-CSO-ADMIN-FEE REDEFINES CP-ALTERNATE-PREMIUM
  2963                                  PIC S9(7)V99 COMP-3.
  2964                                                                     CL**2
  2965         16  CP-PAID-FROM-DATE     PIC X(02).                        CL**2
  2966         16  CP-CLAIM-CALC-METHOD  PIC X(01).                        CL**2
  2967         16  CP-EXT-DAYS-CALC      PIC X.                            CL**2
  2968           88  CP-EXT-NO-CHG                   VALUE ' '.            CL**2
  2969           88  CP-EXT-CHG-LF                   VALUE '1'.            CL**2
  2970           88  CP-EXT-CHG-AH                   VALUE '2'.            CL**2
  2971           88  CP-EXT-CHG-LF-AH                VALUE '3'.            CL**2
  2972         16  CP-DOMICILE-STATE     PIC XX.                           CL**2
  2973         16  CP-CARRIER            PIC X.                            CL**2
  2974         16  CP-REIN-FLAG          PIC X.                            CL**2
  2975         16  CP-REM-TRM-CALC-OPTION PIC X.                           CL**2
  2976           88  VALID-REM-TRM-CALC-OPTION    VALUE '1'                CL**2
  2977                      '2' '3' '4' '5'.                               CL**2
  2978           88  CP-CALC-OPTION-DEFAULT       VALUE '4'.               CL**2
  2979           88  CP-CONSIDER-EXTENSION        VALUE '3' '4' '5'.       CL**2
  2980           88  CP-30-DAY-MONTH              VALUE '1' '3' '5'.       CL**2
  2981           88  CP-NO-EXT-30-DAY-MONTH       VALUE '1'.               CL**2
  2982           88  CP-NO-EXT-ACTUAL-DAYS        VALUE '2'.               CL**2
  2983           88  CP-EXT-30-DAY-MONTH          VALUE '3'.               CL**2
  2984           88  CP-EXT-ACTUAL-DAYS           VALUE '4'.               CL**2
  2985           88  CP-USE-EXP-AND-1ST-PMT       VALUE '5'.
  2986         16  CP-SIG-SWITCH         PIC X.                            CL**2
  2987         16  CP-RATING-METHOD      PIC X.                            CL**2
  2988           88  CP-RATE-AS-R78                      VALUE '1' 'R'.    CL**2
  2989           88  CP-RATE-AS-PRORATA                  VALUE '2' 'P'.    CL**2
  2990           88  CP-RATE-AS-CALIF                    VALUE '3' 'C'.    CL**2
  2991           88  CP-RATE-AS-TEXAS                    VALUE '4' 'T'.    CL**2
  2992           88  CP-RATE-AS-FARM-PLAN                VALUE '4' 'T'.    CL**2
  2993           88  CP-RATE-AS-NET-PAY                  VALUE '5' 'N'.    CL**2
  2994           88  CP-RATE-AS-ANTICIPATION             VALUE '6' 'A'.    CL**2
  2995           88  CP-RATE-AS-MEAN                     VALUE '8' 'M'.    CL**2
  2996           88  CP-RATE-AS-REG-BALLOON              VALUE 'B'.        CL**2
  2997         16  CP-SALES-TAX          PIC S9V9999     VALUE  ZEROS      CL**2
  2998                                     COMP-3.                         CL**2
  2999         16  CP-BEN-CATEGORY       PIC X.
  3000         16  CP-DCC-LF-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  3001         16  CP-DCC-ACT-COMM REDEFINES CP-DCC-LF-RATE
  3002                                   PIC S99V9(5) COMP-3.
  3003         16  CP-DCC-AH-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  3004         16  CP-DCC-PMF-COMM REDEFINES CP-DCC-AH-RATE
  3005                                   PIC S99V9(5) COMP-3.
  3006         16  CP-DAYS-TO-1ST-PMT    PIC S999     COMP-3 VALUE +0.
  3007         16  CP-AH-BALLOON-SW      PIC X  VALUE ' '.
  3008         16  CP-EXPIRE-DT          PIC XX.
  3009         16  CP-LF-CLAIM-CALC-SW   PIC X  VALUE ' '.
  3010         16  CP-DDF-HI-FACT        PIC S9V999   COMP-3 VALUE +0.
  3011         16  CP-DDF-LO-FACT        PIC S9V999   COMP-3 VALUE +0.
  3012         16  CP-DDF-CLP            PIC S9(5)V99 COMP-3 VALUE +0.
  3013         16  CP-DDF-SPEC-CALC      PIC X.
  3014             88  CP-CALC-GROSS-FEE        VALUE 'G'.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  70
* ECS150P.cbl (/apps/prod/cid1p/copy/ELCCALC)
  3015             88  CP-CALC-CLP              VALUE 'C'.
  3016         16  CP-IU-RATE-UP         PIC S9(5)V99   COMP-3 VALUE +0.
  3017         16  CP-CANCEL-REASON      PIC X.
  3018         16  CP-DDF-ADMIN-FEES     PIC S9(5)V99 COMP-3 VALUE +0.
  3019         16  CP-PMT-MODE           PIC X.
  3020         16  CP-NO-OF-PMTS         PIC S999 COMP-3 VALUE +0.
  3021         16  CP-1ST-YR-ALLOW       PIC S999V99 COMP-3 VALUE +0.
  3022         16  CP-DDF-COMM-AND-MFEE  PIC S9(5)V99 COMP-3 VALUE +0.
  3023         16  CP-DDF-YR1AF          PIC S9(5)V99 COMP-3 VALUE +0.
  3024         16  FILLER                PIC X.
  3025                                                                     CL**2
  3026***************    OUTPUT FROM ELRESV   ************************     CL**2
  3027                                                                     CL**2
  3028         16  CP-CDT-TABLE          PIC 9             VALUE ZERO.     CL**2
  3029                                                                     CL**2
  3030         16  CP-CDT-FACTOR         PIC S9(5)V9(6)    VALUE ZERO      CL**2
  3031                                     COMP-3.                         CL**2
  3032         16  CP-PTC-RESERVE        PIC S9(7)V99   VALUE ZERO         CL**2
  3033                                     COMP-3.                         CL**2
  3034         16  CP-IBNR-RESERVE       PIC S9(7)V99   VALUE ZERO         CL**2
  3035                                     COMP-3.                         CL**2
  3036         16  CP-FUTURE-RESERVE     PIC S9(7)V99   VALUE ZERO         CL**2
  3037                                     COMP-3.                         CL**2
  3038         16  FILLER                PIC X(09).                        CL**2
  3039***************    OUTPUT FROM ELRTRM   *************************    CL**2
  3040                                                                     CL**2
  3041         16  CP-REMAINING-TERM-1   PIC S9(4)V9    VALUE ZERO         CL**2
  3042                                     COMP-3.                         CL**2
  3043         16  CP-REMAINING-TERM-2   PIC S9(4)V9    VALUE ZERO         CL**2
  3044                                     COMP-3.                         CL**2
  3045         16  CP-REMAINING-TERM-3   PIC S9(4)V9    VALUE ZERO         CL**2
  3046                                     COMP-3.                         CL**2
  3047         16  CP-ODD-DAYS           PIC S9(3)      VALUE ZERO         CL**2
  3048                                     COMP-3.                         CL**2
  3049         16  FILLER                PIC X(12).                        CL**2
  3050                                                                     CL**2
  3051***************    OUTPUT FROM ELRAMT   *************************    CL**2
  3052                                                                     CL**2
  3053         16  CP-REMAINING-AMT      PIC S9(9)V99   VALUE ZERO         CL**2
  3054                                     COMP-3.                         CL**2
  3055         16  CP-REMAINING-AMT-PRV  PIC S9(9)V99   VALUE ZERO         CL**2
  3056                                     COMP-3.                         CL**2
  3057         16  FILLER                PIC X(12).                        CL**2
  3058                                                                     CL**2
  3059***************    OUTPUT FROM ELRATE   *************************    CL**2
  3060                                                                     CL**2
  3061         16  CP-CALC-PREMIUM       PIC S9(7)V99   VALUE ZERO         CL**2
  3062                                     COMP-3.                         CL**2
  3063         16  CP-PREMIUM-RATE       PIC S9(2)V9(5) VALUE ZERO         CL**2
  3064                                     COMP-3.                         CL**2
  3065         16  CP-MORTALITY-CODE     PIC X(4).                         CL**2
  3066         16  CP-RATE-EDIT-FLAG     PIC X.                            CL**2
  3067             88  CP-RATES-NEED-APR                  VALUE '1'.       CL**2
  3068         16  CP-COMPOSITE-RATE     PIC S99V999    VALUE ZERO         CL**2
  3069                                     COMP-3.                         CL**2
  3070         16  CP-POLICY-FEE         PIC S9(3)V99 VALUE +0 COMP-3.     CL**2
  3071         16  CP-LF-PREM            PIC S9(7)V99 VALUE +0 COMP-3.
  3072         16  CP-LF-BALLOON-PREM REDEFINES CP-LF-PREM
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  71
* ECS150P.cbl (/apps/prod/cid1p/copy/ELCCALC)
  3073                                   PIC S9(7)V99 COMP-3.
  3074         16  FILLER                PIC X(07).                        CL**2
  3075                                                                     CL**2
  3076***************    OUTPUT FROM ELRFND   *************************    CL**2
  3077                                                                     CL**2
  3078         16  CP-CALC-REFUND        PIC S9(7)V99   VALUE ZERO         CL**2
  3079                                     COMP-3.                         CL**2
  3080         16  CP-REFUND-TYPE-USED   PIC X.                            CL**2
  3081           88  CP-R-AS-R78                         VALUE '1'.        CL**2
  3082           88  CP-R-AS-PRORATA                     VALUE '2'.        CL**2
  3083           88  CP-R-AS-CALIF                       VALUE '3'.        CL**2
  3084           88  CP-R-AS-TEXAS                       VALUE '4'.        CL**2
  3085           88  CP-R-AS-FARM-PLAN                   VALUE '4'.        CL**2
  3086           88  CP-R-AS-NET-PAY                     VALUE '5'.        CL**2
  3087           88  CP-R-AS-ANTICIPATION                VALUE '6'.        CL**2
  3088           88  CP-R-AS-MEAN                        VALUE '8'.        CL**2
  3089           88  CP-R-AS-SUM-OF-DIGITS               VALUE '9'.        CL**2
  3090           88  CP-R-AS-GAP-NON-REFUND              VALUE 'G'.
  3091           88  CP-R-AS-GAP-ACTUARIAL               VALUE 'S'.
  3092           88  CP-R-AS-SPP-DDF                     VALUE 'D'.
  3093           88  CP-R-AS-SPP-DDF-IU                  VALUE 'I'.
  3094           88  CP-R-AS-REPOSSESSION                VALUE 'R'.
  3095         16  FILLER                PIC X(12).                        CL**2
  3096                                                                     CL**2
  3097***************    OUTPUT FROM ELEARN   *************************    CL**2
  3098                                                                     CL**2
  3099         16  CP-R78-U-PRM          PIC S9(7)V99   VALUE ZERO         CL**2
  3100                                     COMP-3.                         CL**2
  3101         16  CP-R78-U-PRM-ALT      PIC S9(7)V99   VALUE ZERO         CL**2
  3102                                     COMP-3.                         CL**2
  3103         16  CP-PRORATA-U-PRM      PIC S9(7)V99   VALUE ZERO         CL**2
  3104                                     COMP-3.                         CL**2
  3105         16  CP-PRORATA-U-PRM-ALT  PIC S9(7)V99   VALUE ZERO         CL**2
  3106                                     COMP-3.                         CL**2
  3107         16  CP-STATE-U-PRM        PIC S9(7)V99   VALUE ZERO         CL**2
  3108                                     COMP-3.                         CL**2
  3109         16  CP-DOMICILE-U-PRM     PIC S9(7)V99   VALUE ZERO         CL**2
  3110                                     COMP-3.                         CL**2
  3111         16  CP-EARNING-TYPE-USED  PIC X.                            CL**2
  3112           88  CP-E-AS-SPECIAL                     VALUE 'S'.        CL**2
  3113           88  CP-E-AS-R78                         VALUE '1'.        CL**2
  3114           88  CP-E-AS-PRORATA                     VALUE '2'.        CL**2
  3115           88  CP-E-AS-TEXAS                       VALUE '4'.        CL**2
  3116           88  CP-E-AS-FARM-PLAN                   VALUE '4'.        CL**2
  3117           88  CP-E-AS-NET-PAY                     VALUE '5'.        CL**2
  3118           88  CP-E-AS-ANTICIPATION                VALUE '6'.        CL**2
  3119           88  CP-E-AS-MEAN                        VALUE '8'.        CL**2
  3120           88  CP-E-AS-SUM-OF-DIGITS               VALUE '9'.        CL**2
  3121         16  FILLER                PIC X(12).                        CL**2
  3122                                                                     CL**2
  3123***************    OUTPUT FROM ELPMNT   *************************    CL**2
  3124                                                                     CL**2
  3125         16  CP-ACTUAL-DAYS        PIC S9(05)     VALUE ZERO         CL**2
  3126                                     COMP-3.                         CL**2
  3127         16  CP-CLAIM-PAYMENT      PIC S9(7)V99   VALUE ZERO         CL**2
  3128                                     COMP-3.                         CL**2
  3129         16  FILLER                PIC X(12).                        CL**2
  3130                                                                     CL**2
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  72
* ECS150P.cbl (/apps/prod/cid1p/copy/ELCCALC)
  3131***************   MISC WORK AREAS    *****************************   CL**2
  3132         16  CP-TOTAL-PAID         PIC S9(7)V99   VALUE ZERO         CL**2
  3133                                     COMP-3.                         CL**2
  3134         16  CP-R-MAX-ATT-AGE      PIC S9(3)      VALUE ZERO         CL**2
  3135                                     COMP-3.                         CL**2
  3136         16  CP-R-MAX-AGE          PIC S9(3)      VALUE ZERO         CL**2
  3137                                     COMP-3.                         CL**2
  3138         16  CP-R-MAX-TERM         PIC S9(5)      VALUE ZERO         CL**2
  3139                                     COMP-3.                         CL**2
  3140         16  CP-R-MAX-TOT-BEN      PIC S9(7)V99   VALUE ZERO         CL**2
  3141                                     COMP-3.                         CL**2
  3142         16  CP-R-MAX-MON-BEN      PIC S9(7)V99   VALUE ZERO         CL**2
  3143                                     COMP-3.                         CL**2
  3144         16  CP-IO-FUNCTION        PIC X          VALUE SPACE.       CL**2
  3145             88  OPEN-RATE-FILE                   VALUE 'O'.         CL**2
  3146             88  CLOSE-RATE-FILE                  VALUE 'C'.         CL**2
  3147             88  IO-ERROR                         VALUE 'E'.         CL**2
  3148                                                                     CL**2
  3149         16  CP-FIRST-PAY-DATE     PIC XX.                           CL**2
  3150                                                                     CL**2
  3151         16  CP-JOINT-INDICATOR    PIC X.                            CL**2
  3152                                                                     CL**2
  3153         16  CP-RESERVE-REMAINING-TERM                               CL**2
  3154                                   PIC S9(4)V9    VALUE ZERO         CL**2
  3155                                     COMP-3.                         CL**2
  3156                                                                     CL**2
  3157         16  CP-INSURED-BIRTH-DT   PIC XX.                           CL**2
  3158                                                                     CL**2
  3159         16  CP-INCURRED-AGE       PIC S9(3)      VALUE ZERO         CL**2
  3160                                     COMP-3.                         CL**2
  3161                                                                     CL**2
  3162         16  CP-MONTHLY-PAYMENT    PIC S9(5)V99   VALUE ZERO         CL**2
  3163                                     COMP-3.                         CL**2
  3164                                                                     CL**2
  3165         16  CP-RATING-BENEFIT-AMT PIC S9(9)V99   VALUE ZERO         CL**2
  3166                                     COMP-3.                         CL**2
  3167                                                                     CL**2
  3168         16  CP-ODD-DAYS-TO-PMT    PIC S9(3)      VALUE ZERO         CL**2
  3169                                     COMP-3.                         CL**2
  3170                                                                     CL**2
  3171         16  CP-MNTHS-TO-FIRST-PMT PIC S9(3)      VALUE ZERO         CL**2
  3172                                     COMP-3.                         CL**2
  3173                                                                     CL**2
  3174         16  CP-REMAMT-FACTOR      PIC S9(4)V9(9) VALUE ZEROS        CL**2
  3175                                     COMP-3.                         CL**2
  3176                                                                     CL**2
  3177         16  CP-FREE-LOOK          PIC S9(3)      VALUE ZERO         CL**2
  3178                                     COMP-3.                         CL**2
  3179                                                                     CL**2
  3180         16  CP-ROA-REFUND         PIC X          VALUE 'N'.         CL**2
  3181             88  CP-ROA-PREM-AT-REFUND            VALUE 'Y'.         CL**2
  3182                                                                     CL**2
  3183         16  CP-NET-BENEFIT-AMT    PIC S9(9)V99   VALUE ZERO         CL**2
  3184                                     COMP-3.                         CL**2
  3185         16  CP-SCNP-6MO-AMT       PIC S9(9)V99   VALUE ZERO
  3186                                     COMP-3.
  3187         16  CP-MONTH              PIC S999     COMP-3 VALUE +0.
  3188         16  cp-extra-periods      pic 9 value zeros.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  73
* ECS150P.cbl (/apps/prod/cid1p/copy/ELCCALC)
  3189         16  cp-net-only-state     pic x value spaces.
  3190         16  FILLER                PIC X(13).                        CL**2
  3191******************************************************************   CL**2
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  74
* ECS150P.cbl
* 3193                             COPY ELCDTECX.
  3194******************************************************************06/05/98
  3195*                                                                *ELCDTECX
  3196*                            ELCDTECX.                           *   LV005
  3197*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  3198*                            VMOD=2.015                          *ELCDTECX
  3199*                                                                *ELCDTECX
  3200*      WORKING STORAGE COPY CODE FOR APPLICATIONS CALLING        *ELCDTECX
  3201*      THE DATE CARD DISK FILE. ( READ ROUTINE = ELCDTERX,       *ELCDTECX
  3202*      AND DISK FILE FD = ELCDTEFX)                              *ELCDTECX
  3203*                                                                *ELCDTECX
  3204******************************************************************ELCDTECX
  3205******************************************************************
  3206*                   C H A N G E   L O G
  3207*
  3208* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3209*-----------------------------------------------------------------
  3210*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3211* EFFECTIVE    NUMBER
  3212*-----------------------------------------------------------------
  3213* 092602    2002091900008  PEMA  INCREASE NUMBER OF MAXIMUM
  3214*                                  BENEFIT CODES FROM 300 TO 900
  3215* 090803    2003080800002  PEMA  ADD CATEGORY FOR SUPER GAP
  3216* 051304    2003080800002  SMVA  ADD REFUND METHOD
  3217* 071714    2013100100002  PEMA  FIX CRIT PERIOD EDITS
  3218******************************************************************
  3219 01  DATE-CARD.                                                   ELCDTECX
  3220     12  DATX-COD                    PIC  X(4).                   ELCDTECX
  3221     12  RUN-DATE                    PIC  9(11)  COMP-3.          ELCDTECX
  3222     12  ALPH-DATE                   PIC  X(18).                  ELCDTECX
  3223     12  EP-DT                       PIC  9(11)  COMP-3.          ELCDTECX
  3224     12  PEND-ACT-FILE               PIC  XX.                     ELCDTECX
  3225     12  EP-SW                       PIC  X.                      ELCDTECX
  3226         88  NO-EP-EXTRACTS          VALUE SPACE.                 ELCDTECX
  3227     12  TAPE-BATCHES                PIC  X.                      ELCDTECX
  3228         88  TP-PREL-BAL             VALUE '1'.                   ELCDTECX
  3229     12  BIN-RUN-DATE                PIC  XX.                     ELCDTECX
  3230     12  RUN-CENTURY.                                             ELCDTECX
  3231         16 RUN-CENTURY-N            PIC  99.                        CL**4
  3232     12  FILLER                      PIC  X.                         CL**4
  3233     12  CLAS-MORT-OVRD              PIC  X(4).                   ELCDTECX
  3234     12  FILLER                      PIC  XXX.                    ELCDTECX
  3235     12  COMPANY-NAME                PIC  X(30).                  ELCDTECX
  3236                                                                  ELCDTECX
  3237 01  FILLER                          PIC  X(7)                       CL**6
  3238                                          VALUE 'OPTIONS'.        ELCDTECX
  3239 01  DATE-CARD-OPTIONS.                                           ELCDTECX
  3240     12  DATE-OPTIONS-ID             PIC  X(4).                   ELCDTECX
  3241     12  DTE-MIN-PREM                PIC  99V99.                  ELCDTECX
  3242     12  DTE-LANGUAGE-IND            PIC  X.                      ELCDTECX
  3243         88  DTE-LANGUAGE-IS-FR           VALUE 'F'.              ELCDTECX
  3244         88  DTE-LANGUAGE-IS-ENG          VALUE 'E'.              ELCDTECX
  3245     12  DTE-MIN-AGE                 PIC  99.                     ELCDTECX
  3246     12  DTE-DEFAULT-AGE             PIC  99.                     ELCDTECX
  3247     12  FILLER                      PIC  X.                      ELCDTECX
  3248     12  DTE-MAX-TERM                PIC  999.                    ELCDTECX
  3249     12  DTE-COMP-VG                 PIC  X.                      ELCDTECX
  3250     12  DTE-REM-TRM                 PIC  X.                      ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  75
* ECS150P.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  3251     12  DTE-PRM-CK                  PIC S99V99.                  ELCDTECX
  3252     12  DTE-PRORATA                 PIC  X.                      ELCDTECX
  3253     12  DTE-CLM-REJ                 PIC  X.                      ELCDTECX
  3254     12  DTE-REF-REJ                 PIC  X.                      ELCDTECX
  3255     12  DTE-COM-TBL-USED            PIC  X.                      ELCDTECX
  3256     12  FILLER                      PIC  X.                      ELCDTECX
  3257     12  DTE-QTR-CO                  PIC  X.                      ELCDTECX
  3258     12  DTE-REF-CK                  PIC S99V99.                  ELCDTECX
  3259     12  DTE-CLM-CK                  PIC S99V99.                  ELCDTECX
  3260     12  DTE-CONV-DT                 PIC 9(11) COMP-3.               CL**2
  3261     12  DTE-DEFAULT-SEX             PIC  X.                      ELCDTECX
  3262     12  DTE-EPL-FORMAT              PIC  X.                      ELCDTECX
  3263     12  FILLER                      PIC  X.                      ELCDTECX
  3264     12  DTE-JT-AGE                  PIC  X.                      ELCDTECX
  3265     12  DTE-KEY-BIRTH               PIC  X.                      ELCDTECX
  3266     12  DTE-REINSURANCE             PIC  X.                      ELCDTECX
  3267     12  DTE-CLAIM-SORT              PIC  X.                      ELCDTECX
  3268     12  DTE-WRT-OFF                 PIC  S99V99.                 ELCDTECX
  3269     12  DTE-R78                     PIC  X.                      ELCDTECX
  3270     12  DTE-DLY-BILL                PIC  X.                      ELCDTECX
  3271     12  DTE-ALT-MORT-CODE           PIC  X(4).                   ELCDTECX
  3272     12  DTE-CLAIM-PAID-THRU-TO      PIC  X.                      ELCDTECX
  3273     12  DTE-COMPENSATION-ACCESS     PIC  X.                      ELCDTECX
  3274     12  DTE-MORTG-ACCESS-CNTL       PIC  X.                      ELCDTECX
  3275     12  DTE-MP-ALT-MORT-CODE        PIC  X(4).                   ELCDTECX
  3276     12  DTE-MORTALITY-AGE-CALC-METHOD                            ELCDTECX
  3277                                     PIC  X.                      ELCDTECX
  3278         88  DTE-USE-TABLE-ASSIGNED-METHOD VALUE '1'              ELCDTECX
  3279                                                 ' '.             ELCDTECX
  3280         88  DTE-USE-ALL-AGE-LAST          VALUE '2'.             ELCDTECX
  3281         88  DTE-USE-ALL-AGE-NEAR          VALUE '3'.             ELCDTECX
  3282     12  DTE-RESERVE-OPTION-SWITCH   PIC  X.                      ELCDTECX
  3283         88  DTE-OPT-RESERVE-METHOD-AUTH       VALUE 'Y'.         ELCDTECX
  3284         88  DTE-OPT-RESERVE-METHOD-UNAUTH     VALUE 'N' ' '.     ELCDTECX
  3285     12  DTE-REM-TRM-CALC-OPTION     PIC  X.                      ELCDTECX
  3286     12  DTE-EXPERIENCE-RETENTION-AGE                             ELCDTECX
  3287                                     PIC  9.                         CL**4
  3288     12  DTE-SYSTEM.                                              ELCDTECX
  3289         16  DTE-SYS-A-CREDIT        PIC  X.                      ELCDTECX
  3290         16  DTE-SYS-B-PEND-CLAIM    PIC  X.                      ELCDTECX
  3291         16  DTE-SYS-C-CONFIRMATIONS PIC  X.                      ELCDTECX
  3292         16  DTE-SYS-D-DEMAND-BILL   PIC  X.                      ELCDTECX
  3293         16  DTE-SYS-E-CLASIC-CLAIMS PIC  X.                      ELCDTECX
  3294         16  DTE-SYS-F-CLASIC-CREDIT PIC  X.                      ELCDTECX
  3295         16  DTE-SYS-G-AR-USED       PIC  X.                      ELCDTECX
  3296         16  DTE-SYS-H               PIC  X.                      ELCDTECX
  3297         16  DTE-SYS-I               PIC  X.                      ELCDTECX
  3298         16  DTE-SYS-J               PIC  X.                      ELCDTECX
  3299         16  DTE-SYS-K               PIC  X.                      ELCDTECX
  3300         16  DTE-SYS-L               PIC  X.                      ELCDTECX
  3301         16  DTE-SYS-M               PIC  X.                      ELCDTECX
  3302         16  DTE-SYS-N               PIC  X.                      ELCDTECX
  3303         16  DTE-SYS-O               PIC  X.                      ELCDTECX
  3304         16  DTE-SYS-P               PIC  X.                      ELCDTECX
  3305         16  DTE-SYS-Q               PIC  X.                      ELCDTECX
  3306         16  DTE-SYS-R               PIC  X.                      ELCDTECX
  3307         16  DTE-SYS-S               PIC  X.                      ELCDTECX
  3308         16  DTE-SYS-T               PIC  X.                      ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  76
* ECS150P.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  3309         16  DTE-SYS-U               PIC  X.                      ELCDTECX
  3310         16  DTE-SYS-V               PIC  X.                      ELCDTECX
  3311         16  DTE-SYS-W               PIC  X.                      ELCDTECX
  3312         16  DTE-SYS-X               PIC  X.                      ELCDTECX
  3313         16  DTE-SYS-Y               PIC  X.                      ELCDTECX
  3314         16  DTE-SYS-Z               PIC  X.                      ELCDTECX
  3315     12  FILLER                      REDEFINES DTE-SYSTEM.        ELCDTECX
  3316         16  DTE-SYS-CODE            OCCURS 26 TIMES              ELCDTECX
  3317                                     PIC  X.                      ELCDTECX
  3318     12  DTE-CLIENT                  PIC  XXX.                    ELCDTECX
  3319                                                                  ELCDTECX
  3320 01  CLASIC-SYSTEM-CODES.                                         ELCDTECX
  3321     12  DTE-COLC-ID                 PIC  X(4).                   ELCDTECX
  3322     12  DTE-CLASIC-COMPANY-CD       PIC  X.                      ELCDTECX
  3323     12  DTE-CLASIC-COMPANY-NUMBER   PIC  999.                    ELCDTECX
  3324*    12  DTE-CLASIC-CLAIM-ACCESS     PIC  X.                      ELCDTECX
  3325     12  FILLER                      PIC  X.                      ELCDTECX
  3326     12  CLASIC-REIN-MAINT           PIC  XX.                     ELCDTECX
  3327     12  CLASIC-COMP-MAINT           PIC  XX.                     ELCDTECX
  3328     12  CLASIC-ACCT-MAINT           PIC  XX.                     ELCDTECX
  3329     12  CLASIC-CTBL-MAINT           PIC  XX.                     ELCDTECX
  3330     12  CLASIC-RATE-MAINT           PIC  XX.                     ELCDTECX
  3331     12  CLASIC-CREDIT-EOM-DT        PIC  XX.                     ELCDTECX
  3332     12  CLASIC-CLAIMS-EOM-DT        PIC  XX.                     ELCDTECX
  3333                                                                  ELCDTECX
  3334     12  LIFE-OVERRIDE-L1            PIC  X.                      ELCDTECX
  3335     12  LIFE-OVERRIDE-L2            PIC  XX.                     ELCDTECX
  3336     12  LIFE-OVERRIDE-L6            PIC  X(6).                   ELCDTECX
  3337     12  LIFE-OVERRIDE-L12           PIC  X(12).                  ELCDTECX
  3338                                                                  ELCDTECX
  3339     12  AH-OVERRIDE-L1              PIC  X.                      ELCDTECX
  3340     12  AH-OVERRIDE-L2              PIC  XX.                     ELCDTECX
  3341     12  AH-OVERRIDE-L6              PIC  X(6).                   ELCDTECX
  3342     12  AH-OVERRIDE-L12             PIC  X(12).                  ELCDTECX
  3343                                                                  ELCDTECX
  3344     12  CLAS-REPORT-CD1-CAPTION     PIC  X(10).                  ELCDTECX
  3345     12  CLAS-REPORT-CD2-CAPTION     PIC  X(10).                  ELCDTECX
  3346                                                                  ELCDTECX
  3347     12  CLASIC-MORTG-EOM-DT         PIC  XX.                     ELCDTECX
  3348     12  CLASIC-AR-EOM-DT            PIC  XX.                     ELCDTECX
  3349                                                                  ELCDTECX
  3350     12  FILLER                      PIC  X(11)      VALUE SPACE. ELCDTECX
  3351                                                                  ELCDTECX
  3352 01  DATE-CARD-FACTORS.                                           ELCDTECX
  3353     12  DATE-FACTOR-ID              PIC  X(4).                   ELCDTECX
  3354     12  FAC-1                       PIC S999V9(5).               ELCDTECX
  3355     12  FAC-2                       PIC S999V9(5).               ELCDTECX
  3356     12  FAC-3                       PIC S999V9(5).               ELCDTECX
  3357     12  FAC-4                       PIC S999V9(5).               ELCDTECX
  3358     12  FAC-5                       PIC S999V9(5).               ELCDTECX
  3359     12  FAC-6                       PIC S999V9(5).               ELCDTECX
  3360                                                                  ELCDTECX
  3361 01  FILLER                          PIC  X(12)                   ELCDTECX
  3362                                          VALUE 'COMPANY NAME'.   ELCDTECX
  3363 01  COMPANY-NAME-TABLE.                                          ELCDTECX
  3364     12  C-N-TBL                     OCCURS 6 TIMES.              ELCDTECX
  3365         16  CNT-ID                  PIC  X.                      ELCDTECX
  3366         16  CNT-NAME                PIC  X(30).                  ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  77
* ECS150P.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  3367                                                                  ELCDTECX
  3368 01  FILLER                          PIC  X(11)                   ELCDTECX
  3369                                          VALUE 'STATE NAMES'.    ELCDTECX
  3370 01  STATE-NAMES.                                                 ELCDTECX
  3371     12  STATE-NAME-FLD              OCCURS 75 TIMES.             ELCDTECX
  3372         16  STATE-SUB               PIC  XX.                     ELCDTECX
  3373         16  STATE-PIC1.                                          ELCDTECX
  3374             20  STATE-ABBR          PIC  XX.                     ELCDTECX
  3375             20  FILLER              PIC  XXX.                    ELCDTECX
  3376             20  STATE-PIC           PIC  X(20).                  ELCDTECX
  3377             20  STATE-CALL-EARN     PIC  X.                      ELCDTECX
  3378             20  STATE-CALL-BREAK    PIC  X.                      ELCDTECX
  3379             20  STATE-PRIM-FAC-DEV  PIC  XXX.                    ELCDTECX
  3380                                                                  ELCDTECX
  3381 01  FILLER                          PIC  X(13)                   ELCDTECX
  3382                                          VALUE 'CARRIER NAMES'.  ELCDTECX
  3383 01  CARRIER-NAMES.                                               ELCDTECX
  3384     12  CARRIER-NAME-FLD            OCCURS 25 TIMES.             ELCDTECX
  3385         16  CARRIER-SUB             PIC  X.                      ELCDTECX
  3386         16  CARRIER-DOM-ST          PIC  XX.                     ELCDTECX
  3387         16  CARRIER-PIC             PIC  X(30).                  ELCDTECX
  3388         16  CARRIER-UEP-PCT         PIC  S9V9(4) COMP-3.            CL**6
  3389         16  CARRIER-R78-PCT         PIC  S9V9(4) COMP-3.            CL**6
  3390         16  CARRIER-PRO-PCT         PIC  S9V9(4) COMP-3.            CL**6
  3391*        16  FILLER                  PIC  X.                      ELCDTECX
  3392         16  CARRIER-SEC-PAY         PIC  X.
  3393             88  SEC-PAY-CARRIER          VALUE 'Y'.
  3394                                                                  ELCDTECX
  3395 01  FILLER                          PIC  X(9)                       CL**6
  3396                                          VALUE 'INS TYPES'.      ELCDTECX
  3397 01  CLAS-INS-TYPES.                                              ELCDTECX
  3398*    12 CLAS-ALL-TYPES               OCCURS 300 TIMES.            ELCDTECX
  3399     12 CLAS-ALL-TYPES               OCCURS 900 TIMES.            ELCDTECX
  3400         16  CLAS-I-BEN              PIC  XX.                     ELCDTECX
  3401         16  CLAS-I-AB3.                                          ELCDTECX
  3402             20  FILLER              PIC  X.                      ELCDTECX
  3403             20  CLAS-I-AB2.                                      ELCDTECX
  3404                 24  FILLER          PIC  X.                      ELCDTECX
  3405                 24  CLAS-I-AB1      PIC  X.                      ELCDTECX
  3406         16  CLAS-I-AB3-AH REDEFINES CLAS-I-AB3.                  ELCDTECX
  3407             20  CLAS-EXCLUSION      PIC  XX.                        CL**4
  3408             20  FILLER              PIC  X.                         CL**4
  3409         16  CLAS-I-AB10.                                         ELCDTECX
  3410             20  FILLER              PIC  X(9).                   ELCDTECX
  3411             20  CLAS-I-REIN-YN      PIC  X.                      ELCDTECX
  3412         16  CLAS-I-COMMENT          PIC  X(10).                  ELCDTECX
  3413         16  CLAS-I-JOINT            PIC  X.                      ELCDTECX
  3414         16  CLAS-I-RL-AH            PIC  X.                      ELCDTECX
  3415         16  CLAS-I-CALC-TYPE.                                    ELCDTECX
  3416             20  CLAS-I-BAL          PIC  X.                      ELCDTECX
  3417         16  CLAS-I-EP               PIC  X.                      ELCDTECX
  3418         16  CLAS-CO-BEN-I-G-CD      PIC  X.                      ELCDTECX
  3419         16  CLAS-CO-REM-TERM-CALC   PIC  X.                      ELCDTECX
  3420         16  CLAS-I-BEN-CATEGORY     PIC  X.
  3421         16  CLAS-I-REFUND-METHOD    PIC  X.
  3422         16  CLAS-I-MAX-BENEFITS     PIC 99.
  3423         16  FILLER                  PIC  XXX.
  3424                                                                  ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  78
* ECS150P.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  3425 01  FILLER                          PIC  X(16)                   ELCDTECX
  3426                                     VALUE 'MORTALITY TABLES'.    ELCDTECX
  3427 01  CLAS-MORTALITY-CODES.                                        ELCDTECX
  3428     12  CLAS-MORT-FLD               OCCURS 99 TIMES              ELCDTECX
  3429                                     INDEXED BY CLAS-MORT-NDX.    ELCDTECX
  3430         16  CLAS-MORT-CODE          PIC  X(4).                      CL**6
  3431         16  CLAS-MORT-J-CODE        PIC  X.                         CL**5
  3432         16  CLAS-MORT-J-FACT        PIC S9V9(4).                    CL**6
  3433         16  CLAS-MORT-DESC.                                      ELCDTECX
  3434             20  CLAS-RESERVE-ADJ    PIC  999.                       CL**6
  3435             20  FILLER              PIC  XX.                        CL**5
  3436             20  CLAS-YEAR           PIC  X(4).                      CL**6
  3437             20  FILLER              PIC  X.                         CL**5
  3438             20  CLAS-TABLE-TYPE     PIC  XXX.                       CL**6
  3439             20  FILLER              PIC  X.                         CL**5
  3440             20  CLAS-AGE-METHOD     PIC  XX.                        CL**5
  3441             20  FILLER              PIC  X.                         CL**5
  3442             20  CLAS-INTEREST       PIC  99.99.                     CL**5
  3443             20  FILLER              PIC  X(5).                      CL**6
  3444                                                                  ELCDTECX
  3445 01  FILLER                          PIC  X(15)                   ELCDTECX
  3446                                     VALUE 'BUSINESS TABLES'.     ELCDTECX
  3447 01  CLAS-BUSINESS-CLASSES.                                       ELCDTECX
  3448     12  CLAS-BUSC-FLD               OCCURS 50 TIMES.             ELCDTECX
  3449         16  CLAS-BUSC-CODE          PIC  99.                     ELCDTECX
  3450         16  CLAS-BUSC-GROUP         PIC  X.                      ELCDTECX
  3451         16  CLAS-BUSC-DESC          PIC  X(19).                  ELCDTECX
  3452         16  CLAS-BUSC-EXCL          PIC  X.                         CL**5
  3453         16  FILLER                  PIC  X(4).                      CL**6
  3454                                                                  ELCDTECX
  3455 01  FILLER                          PIC  X(7)                       CL**6
  3456                                     VALUE 'INDEXES'.             ELCDTECX
  3457 01  CLAS-INDEX-TBL.                                              ELCDTECX
  3458     12  CLAX-ID                     PIC  X(4).                   ELCDTECX
  3459     12  CLAS-STARTC                 PIC S9(4) COMP.              ELCDTECX
  3460     12  CLAS-MAXC                   PIC S9(4) COMP.              ELCDTECX
  3461     12  CLAS-STARTL                 PIC S9(4) COMP.              ELCDTECX
  3462     12  CLAS-MAXL                   PIC S9(4) COMP.              ELCDTECX
  3463     12  CLAS-STARTA                 PIC S9(4) COMP.              ELCDTECX
  3464     12  CLAS-MAXA                   PIC S9(4) COMP.              ELCDTECX
  3465     12  CLAS-STARTM                 PIC S9(4) COMP.              ELCDTECX
  3466     12  CLAS-MAXM                   PIC S9(4) COMP.              ELCDTECX
  3467     12  CLAS-STARTB                 PIC S9(4) COMP.              ELCDTECX
  3468     12  CLAS-MAXB                   PIC S9(4) COMP.              ELCDTECX
  3469     12  CLAS-STARTS                 PIC S9(4) COMP.              ELCDTECX
  3470     12  CLAS-MAXS                   PIC S9(4) COMP.              ELCDTECX
  3471     12  CLAS-STARTE                 PIC S9(4) COMP.              ELCDTECX
  3472     12  CLAS-MAXE                   PIC S9(4) COMP.              ELCDTECX
  3473     12  CLAS-STARTCN                PIC S9(4) COMP.              ELCDTECX
  3474     12  CLAS-MAXCN                  PIC S9(4) COMP.              ELCDTECX
  3475                                                                  ELCDTECX
  3476 01  CLAS-TYPE-MISC.                                              ELCDTECX
  3477     12  CLAS-INDEXC                 PIC S9(4) COMP.              ELCDTECX
  3478     12  CLAS-INDEXL                 PIC S9(4) COMP.              ELCDTECX
  3479     12  CLAS-INDEXA                 PIC S9(4) COMP.              ELCDTECX
  3480     12  CLAS-INDEXM                 PIC S9(4) COMP.              ELCDTECX
  3481     12  CLAS-INDEXB                 PIC S9(4) COMP.              ELCDTECX
  3482     12  CLAS-INDEXS                 PIC S9(4) COMP.              ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  79
* ECS150P.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  3483     12  CLAS-INDEXE                 PIC S9(4) COMP.              ELCDTECX
  3484     12  CLAS-INDEX                  PIC S9(4) COMP.              ELCDTECX
  3485     12  CLAS-INDEXEN                PIC S9(4) COMP.              ELCDTECX
  3486     12  CLAS-INDEXCN                PIC S9(4) COMP.              ELCDTECX
  3487     12  CLAS-INDEXON                PIC S9(4) COMP.              ELCDTECX
  3488                                                                  ELCDTECX
  3489 01  FILLER                          PIC  X(13)                   ELCDTECX
  3490                                     VALUE 'MISCELLANEOUS'.       ELCDTECX
  3491 01  CLAS-MISC.                                                   ELCDTECX
  3492     12  DTE-FICH                    PIC  X.                      ELCDTECX
  3493         88  FICH-NO                 VALUE SPACE.                 ELCDTECX
  3494         88  FICH-ONLY               VALUE '1'.                   ELCDTECX
  3495         88  FICH-BOTH               VALUE '2'.                   ELCDTECX
  3496     12  FICH-OPEN                   PIC  X.                      ELCDTECX
  3497     12  REPT-OPEN                   PIC  X.                      ELCDTECX
  3498     12  DTE-PGM-OPT                 PIC  9.                         CL**5
  3499     12  DTE-PRT-OPT                 PIC  X.                      ELCDTECX
  3500     12  DTE-FMT-OPT                 PIC  9.                      ELCDTECX
  3501     12  DTE-PRC-OPT                 PIC  9.                      ELCDTECX
  3502     12  DTE-TOT-OPT                 PIC  9.                      ELCDTECX
  3503     12  CLAS-LOOK                   PIC  XX.                     ELCDTECX
  3504     12  DTE-TOT-LINES               PIC S9(8)      COMP.         ELCDTECX
  3505     12  STATE-L                     PIC  XX.                     ELCDTECX
  3506     12  CLAS-CN                     PIC  99.                     ELCDTECX
  3507     12  CLAS-CO                     PIC  99.                     ELCDTECX
  3508     12  DTE-VSAM-FLAGS                              VALUE ZERO.  ELCDTECX
  3509         16  DTE-F-1                 PIC  X.                      ELCDTECX
  3510         16  DTE-F-2                 PIC  X.                      ELCDTECX
  3511     12  DTE-ABEND-WORK.                                          ELCDTECX
  3512         16  DTE-ABEND-CD-1          PIC  XX         VALUE SPACES.ELCDTECX
  3513         16  DTE-ABEND-CD-2          PIC  XX         VALUE SPACES.ELCDTECX
  3514                                                                  ELCDTECX
  3515 01  FILLER                          PIC  X(12)                   ELCDTECX
  3516                                     VALUE 'WORKING DATE'.        ELCDTECX
  3517 01  WS-DATE-AND-TIME.                                            ELCDTECX
  3518     12  WS-ACCEPT-DATE.                                          ELCDTECX
  3519         16  WS-AD-YY                PIC  99.                     ELCDTECX
  3520         16  WS-AD-MM                PIC  99.                     ELCDTECX
  3521         16  WS-AD-DD                PIC  99.                     ELCDTECX
  3522     12  WS-CURRENT-DATE.                                         ELCDTECX
  3523         16  WS-CD-MM                PIC  99.                     ELCDTECX
  3524         16  FILLER                  PIC  X          VALUE '/'.   ELCDTECX
  3525         16  WS-CD-DD                PIC  99.                     ELCDTECX
  3526         16  FILLER                  PIC  X          VALUE '/'.   ELCDTECX
  3527         16  WS-CD-YY                PIC  99.                     ELCDTECX
  3528     12  WS-TIME-OF-DAY.                                          ELCDTECX
  3529         16  WS-TIME                 PIC  9(6).                   ELCDTECX
  3530         16  WS-HUN-SEC              PIC  99.                     ELCDTECX
  3531                                                                  ELCDTECX
  3532 01  FILLER                          PIC  X(12)                   ELCDTECX
  3533                                     VALUE 'CARRIER CLMS'.        ELCDTECX
  3534 01  CARRIER-OPT-CLAIM-DATA.                                      ELCDTECX
  3535     12  CARRIER-FLDS                OCCURS 25 TIMES.             ELCDTECX
  3536         16  CARRIER-IBNR-SWITCH     PIC  X.                         CL**5
  3537         16  CARRIER-IBNR-PERCENT    PIC S9V9(4) COMP-3.             CL**6
  3538         16  CARRIER-CIDA-DISCOUNT   PIC S9V9(4) COMP-3.             CL**6
  3539                                                                  ELCDTECX
  3540 01  FILLER                          PIC  X(10)                   ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  80
* ECS150P.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  3541                                     VALUE 'STATE TLRS'.          ELCDTECX
  3542 01  STATE-TARGET-LOSS-RATIOS.                                    ELCDTECX
  3543     12  STATE-TLR-FLD               OCCURS 75 TIMES.             ELCDTECX
  3544         16  STATE-TARGET-LOSS-RATIO PIC S9V9(4) COMP-3.             CL**6
  3545         16  STATE-CALC-INTEREST     PIC S9V9(4) COMP-3.             CL**6
  3546                                                                  ELCDTECX
  3547 01  FILLER                          PIC  X(13)                   ELCDTECX
  3548                                     VALUE 'BUSINESS TLRS'.       ELCDTECX
  3549 01  BUSINESS-TRGT-LOSS-RATIO-MODS.                               ELCDTECX
  3550     12  BUS-TLRM-FLD                OCCURS 99 TIMES.             ELCDTECX
  3551         16  BUS-TRGT-LOSS-RATIO-MOD PIC S9V9(4) COMP-3.             CL**6
  3552                                                                  ELCDTECX
  3553 01  FILLER                          PIC  X(13)                   ELCDTECX
  3554                                     VALUE 'MISC CLM DATA'.       ELCDTECX
  3555 01  MISC-OPT-CLM-RSV-DATA.                                       ELCDTECX
  3556     12  COMPANY-CALC-INTEREST       PIC S9V9(4) COMP-3.             CL**6
  3557     12  COMPANY-CIDA-DISCOUNT       PIC S9V9(4) COMP-3.             CL**6
  3558     12  COMPANY-CRDB-TABLE-SELECTION                             ELCDTECX
  3559                                     PIC  X.                         CL**5
  3560     12  COMPANY-IBNR-AH-FACTOR      PIC S9V9(4) COMP-3.             CL**6
  3561     12  COMPANY-IBNR-LAG-MONTH      PIC S999    COMP-3.             CL**6
  3562     12  COMPANY-IBNR-LIFE-FACTOR    PIC S9V9(4) COMP-3.             CL**6
  3563     12  COMPANY-OPTION-START-DATE   PIC  XX.                        CL**5
  3564     12  INDEXBS                     PIC S9(4)   COMP.               CL**6
  3565     12  INDEXCA                     PIC S9(4)   COMP.               CL**6
  3566     12  INDEXST                     PIC S9(4)   COMP.               CL**6
  3567     12  FILLER                      PIC  X(75).                  ELCDTECX
  3568******************************************************************ELCDTECX
  3569*01  MISC-CARR-PCT-DATA.                                          00001521
  3570*    12  DD-CARR1-UEP-PCT            PIC S9V9(4) COMP-3.          00001522
  3571*    12  DD-CARR1-R78-PCT            PIC S9V9(4) COMP-3.          00001522
  3572*    12  DD-CARR1-PRO-PCT            PIC S9V9(4) COMP-3.          00001522
  3573*    12  DD-CARR2-UEP-PCT            PIC S9V9(4) COMP-3.          00001522
  3574*    12  DD-CARR2-R78-PCT            PIC S9V9(4) COMP-3.          00001522
  3575*    12  DD-CARR2-PRO-PCT            PIC S9V9(4) COMP-3.          00001522
  3576******************************************************************ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  81
* ECS150P.cbl
* 3578                             COPY ELCDTEVR.
  3579***************************************************************** 04/15/98
  3580*                                                                *ELCDTEVR
  3581*                                                                *ELCDTEVR
  3582*                            ELCDTEVR.                           *   LV003
  3583*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
  3584*                            VMOD=2.001                          *   CL**2
  3585*                                                                *ELCDTEVR
  3586*   WORKING STORAGE FOR DATE VARIABLES CREATED                   *ELCDTEVR
  3587*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCDTEVR
  3588*                                                                *ELCDTEVR
  3589******************************************************************ELCDTEVR
  3590 01  WS-DATE-CARD-DATE.                                           ELCDTEVR
  3591     05  WS-RUN-DATE.                                             ELCDTEVR
  3592         10  FILLER                  PIC  9(03).                  ELCDTEVR
  3593         10  RUN-CCYY                PIC  9(04).                  ELCDTEVR
  3594         10  RUN-CCYR  REDEFINES  RUN-CCYY.                       ELCDTEVR
  3595             15  RUN-CC              PIC  99.                     ELCDTEVR
  3596             15  RUN-YR              PIC  99.                     ELCDTEVR
  3597         10  RUN-MO                  PIC  99.                     ELCDTEVR
  3598         10  RUN-DA                  PIC  99.                     ELCDTEVR
  3599     05  WS-RUN-DATE-N REDEFINES                                     CL**2
  3600            WS-RUN-DATE              PIC 9(11).                      CL**2
  3601     05  WS-EP-DT.                                                ELCDTEVR
  3602         10  FILLER                  PIC  9(03).                  ELCDTEVR
  3603         10  EP-CCYY                 PIC  9(04).                  ELCDTEVR
  3604         10  EP-CCYR  REDEFINES  EP-CCYY.                         ELCDTEVR
  3605             15  EP-CC               PIC  99.                     ELCDTEVR
  3606             15  EP-YR               PIC  99.                     ELCDTEVR
  3607         10  EP-MO                   PIC  99.                     ELCDTEVR
  3608         10  EP-DA                   PIC  99.                     ELCDTEVR
  3609     05  WS-EP-DT-N REDEFINES                                        CL**2
  3610            WS-EP-DT                 PIC 9(11).                      CL**2
  3611     05  WS-DTE-CONV-DT.                                             CL**4
  3612         10  FILLER                  PIC  9(03).                     CL**4
  3613         10  DTE-CONV-CCYY           PIC  9(04).                     CL**4
  3614         10  DTE-CONV-CCYR  REDEFINES  DTE-CONV-CCYY.                CL**4
  3615             15  DTE-CONV-CC         PIC  99.                        CL**4
  3616             15  DTE-CONV-YR         PIC  99.                        CL**4
  3617         10  DTE-CONV-MO             PIC  99.                        CL**4
  3618         10  DTE-CONV-DA             PIC  99.                        CL**4
  3619     05  WS-DTE-CONV-DT-N REDEFINES                                  CL**4
  3620            WS-DTE-CONV-DT           PIC  9(11).                     CL**4
  3621 01  WS-BALANCE-FORWARD-DATE.                                     ELCDTEVR
  3622     05  WS-BF-LAST-ACTIVITY-DATE.                                ELCDTEVR
  3623         10  FILLER                            PIC 999.           ELCDTEVR
  3624         10  BF-ACT-CCYY                       PIC 9(04).         ELCDTEVR
  3625         10  BF-ACT-CCYR  REDEFINES  BF-ACT-CCYY.                 ELCDTEVR
  3626             15  BF-ACT-CC                     PIC 99.            ELCDTEVR
  3627             15  BF-ACT-YEAR                   PIC 99.            ELCDTEVR
  3628         10  BF-ACT-MONTH                      PIC 99.            ELCDTEVR
  3629         10  BF-ACT-DAY                        PIC 99.            ELCDTEVR
  3630     05  WS-BF-LAST-ACTIVITY-DATE-N REDEFINES                        CL**2
  3631            WS-BF-LAST-ACTIVITY-DATE           PIC 9(11).            CL**2
  3632     05  WS-BF-CURRENT-LAST-STMT-DT.                              ELCDTEVR
  3633         10  FILLER                            PIC 999.           ELCDTEVR
  3634         10  BF-CURRENT-LAST-STMT-CEN          PIC 99.            ELCDTEVR
  3635         10  BF-CURRENT-LAST-STMT-YEAR         PIC 99.            ELCDTEVR
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  82
* ECS150P.cbl (/apps/prod/cid1p/copy/ELCDTEVR)
  3636         10  BF-CURRENT-LAST-STMT-MONTH        PIC 99.            ELCDTEVR
  3637         10  BF-CURRENT-LAST-STMT-DAY          PIC 99.            ELCDTEVR
  3638     05  WS-BF-CURRENT-LAST-STMT-DT-N REDEFINES                      CL**2
  3639            WS-BF-CURRENT-LAST-STMT-DT        PIC 9(11).             CL**2
  3640 01  WS-ADD-CONF-TRANSACTIONS-DTE.                                ELCDTEVR
  3641     05  WS-AC-CERT-EFF-DATE.                                     ELCDTEVR
  3642         10  FILLER                            PIC 999.           ELCDTEVR
  3643         10  AC-CERT-CCYY                      PIC 9(04).         ELCDTEVR
  3644         10  AC-CERT-CCYR  REDEFINES  AC-CERT-CCYY.               ELCDTEVR
  3645             15  AC-CERT-CC                    PIC 99.            ELCDTEVR
  3646             15  AC-CERT-YR                    PIC 99.            ELCDTEVR
  3647         10  AC-CERT-MO                        PIC 99.            ELCDTEVR
  3648         10  AC-CERT-DA                        PIC 99.            ELCDTEVR
  3649     05  WS-AC-CERT-EFF-DATE-N REDEFINES                             CL**2
  3650            WS-AC-CERT-EFF-DATE                PIC 9(11).            CL**2
  3651     05  WS-AC-LIFE-CANCEL-DATE.                                  ELCDTEVR
  3652         10  FILLER                            PIC 999.           ELCDTEVR
  3653         10  AC-LIFE-CANCEL-CCYY               PIC 9(04).         ELCDTEVR
  3654         10  AC-LIFE-CANCEL-CCYR REDEFINES AC-LIFE-CANCEL-CCYY.   ELCDTEVR
  3655             15  AC-LIFE-CANCEL-CC             PIC 99.            ELCDTEVR
  3656             15  AC-LIFE-CANCEL-YR             PIC 99.            ELCDTEVR
  3657         10  AC-LIFE-CANCEL-MO                 PIC 99.            ELCDTEVR
  3658         10  AC-LIFE-CANCEL-DA                 PIC 99.            ELCDTEVR
  3659     05  WS-AC-LIFE-CANCEL-DATE-N REDEFINES                          CL**2
  3660            WS-AC-LIFE-CANCEL-DATE             PIC 9(11).            CL**2
  3661     05  WS-AC-AH-CANCEL-DATE.                                    ELCDTEVR
  3662         10  FILLER                            PIC 999.           ELCDTEVR
  3663         10  AC-AH-CANCEL-CCYY                 PIC 9(04).         ELCDTEVR
  3664         10  AC-AH-CANCEL-CCYR  REDEFINES  AC-AH-CANCEL-CCYY.     ELCDTEVR
  3665             15  AC-AH-CANCEL-CC               PIC 99.            ELCDTEVR
  3666             15  AC-AH-CANCEL-YR               PIC 99.            ELCDTEVR
  3667         10  AC-AH-CANCEL-MO                   PIC 99.            ELCDTEVR
  3668         10  AC-AH-CANCEL-DA                   PIC 99.            ELCDTEVR
  3669     05  WS-AC-AH-CANCEL-DATE-N REDEFINES                            CL**2
  3670            WS-AC-AH-CANCEL-DATE               PIC 9(11).            CL**2
  3671 01  WS-RATE-RECORD.                                              ELCDTEVR
  3672         05  WS-RT-EXPIRY-DATE.                                   ELCDTEVR
  3673             10  FILLER                        PIC 999.           ELCDTEVR
  3674             10  RT-EXP-CCYY                   PIC 9(04).         ELCDTEVR
  3675             10  RT-EXP-CCYR  REDEFINES  RT-EXP-CCYY.             ELCDTEVR
  3676                 15  RT-EXP-CC                 PIC 99.            ELCDTEVR
  3677                 15  RT-EXP-YR                 PIC 99.            ELCDTEVR
  3678             10  RT-EXP-MO                     PIC 99.            ELCDTEVR
  3679             10  RT-EXP-DA                     PIC 99.            ELCDTEVR
  3680         05  WS-RT-EXPIRY-DATE-N REDEFINES                           CL**2
  3681                WS-RT-EXPIRY-DATE              PIC 9(11).            CL**2
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  83
* ECS150P.cbl
* 3683                             COPY ELCCRTVR.
  3684***************************************************************** 04/24/98
  3685*                                                                *ELCCRTVR
  3686*                                                                *ELCCRTVR
  3687*                            ELCCRTVR                            *   LV003
  3688*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  3689*                            VMOD=2.001                          *ELCCRTVR
  3690*                                                                *ELCCRTVR
  3691*   WORKING STORAGE FOR DATE VARIABLES CREATED                   *ELCCRTVR
  3692*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCCRTVR
  3693*                                                                *ELCCRTVR
  3694******************************************************************ELCCRTVR
  3695                                                                  ELCCRTVR
  3696 01  WS-CERTIFICATE-RECORD-DATE.                                  ELCCRTVR
  3697     05  WS-CR-DT.                                                ELCCRTVR
  3698         10  FILLER                PIC 999.                       ELCCRTVR
  3699         10  CR-CCYY               PIC 9(04).                     ELCCRTVR
  3700         10  CR-CCYR  REDEFINES  CR-CCYY.                         ELCCRTVR
  3701             15  CR-CC             PIC 99.                        ELCCRTVR
  3702             15  CR-YR             PIC 99.                        ELCCRTVR
  3703         10  CR-MO                 PIC 99.                        ELCCRTVR
  3704         10  CR-DA                 PIC 99.                        ELCCRTVR
  3705     05  WS-CR-DT-N REDEFINES                                        CL**2
  3706            WS-CR-DT               PIC 9(11).                        CL**2
  3707     05  WS-CR-LF-EXPIRE-DATE.                                    ELCCRTVR
  3708         10  FILLER                    PIC 999.                   ELCCRTVR
  3709         10  CR-LF-EXPIRE-CCYY         PIC 9(04).                 ELCCRTVR
  3710         10  CR-LF-EXPIRE-CCYR  REDEFINES  CR-LF-EXPIRE-CCYY.     ELCCRTVR
  3711             15  CR-LF-EXPIRE-CC       PIC 99.                    ELCCRTVR
  3712             15  CR-LF-EXPIRE-YR       PIC 99.                    ELCCRTVR
  3713         10  CR-LF-EXPIRE-MO           PIC 99.                    ELCCRTVR
  3714         10  CR-LF-EXPIRE-DA           PIC 99.                    ELCCRTVR
  3715     05  WS-CR-LF-EXPIRE-DATE-N REDEFINES                            CL**2
  3716            WS-CR-LF-EXPIRE-DATE       PIC 9(11).                    CL**2
  3717     05  WS-CR-AH-EXPIRE-DATE.                                    ELCCRTVR
  3718         10  FILLER                    PIC 999.                   ELCCRTVR
  3719         10  CR-AH-EXPIRE-CCYY         PIC 9(04).                 ELCCRTVR
  3720         10  CR-AH-EXPIRE-CCYR   REDEFINES CR-AH-EXPIRE-CCYY.     ELCCRTVR
  3721             15  CR-AH-EXPIRE-CC       PIC 99.                    ELCCRTVR
  3722             15  CR-AH-EXPIRE-YR       PIC 99.                    ELCCRTVR
  3723         10  CR-AH-EXPIRE-MO           PIC 99.                    ELCCRTVR
  3724         10  CR-AH-EXPIRE-DA           PIC 99.                    ELCCRTVR
  3725     05  WS-CR-AH-EXPIRE-DATE-N REDEFINES                            CL**2
  3726            WS-CR-AH-EXPIRE-DATE       PIC 9(11).                    CL**2
  3727     05  WS-CR-ENTRY-DATE.                                        ELCCRTVR
  3728         10  FILLER                    PIC 999.                   ELCCRTVR
  3729         10  CR-ENTRY-CCYY             PIC 9(04).                 ELCCRTVR
  3730         10  CR-ENTRY-CCYR  REDEFINES  CR-ENTRY-CCYY.             ELCCRTVR
  3731             15 CR-ENTRY-CC            PIC 99.                    ELCCRTVR
  3732             15 CR-ENTRY-YR            PIC 99.                    ELCCRTVR
  3733         10  CR-ENTRY-MO               PIC 99.                    ELCCRTVR
  3734         10  CR-ENTRY-DA               PIC 99.                    ELCCRTVR
  3735     05  WS-CR-ENTRY-DATE-N REDEFINES                                CL**2
  3736            WS-CR-ENTRY-DATE           PIC 9(11).                    CL**2
  3737     05  WS-CR-LF-CANC-DT.                                        ELCCRTVR
  3738         10  FILLER                    PIC 999.                   ELCCRTVR
  3739         10  CR-LF-CNC-CCYY            PIC 9(04).                 ELCCRTVR
  3740         10  CR-LF-CNC-CCYR   REDEFINES CR-LF-CNC-CCYY.           ELCCRTVR
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  84
* ECS150P.cbl (/apps/prod/cid1p/copy/ELCCRTVR)
  3741             15  CR-LF-CNC-CC          PIC 99.                    ELCCRTVR
  3742             15  CR-LF-CNC-YR          PIC 99.                    ELCCRTVR
  3743         10  CR-LF-CNC-MO              PIC 99.                    ELCCRTVR
  3744         10  CR-LF-CNC-DA              PIC 99.                    ELCCRTVR
  3745     05  WS-CR-LF-CANC-DT-N REDEFINES                                CL**2
  3746            WS-CR-LF-CANC-DT           PIC 9(11).                    CL**2
  3747     05  WS-CR-LF-CANCEL-EXIT-DATE.                               ELCCRTVR
  3748         10  FILLER                    PIC 999.                   ELCCRTVR
  3749         10  CR-LF-CEX-CCYY            PIC 9(04).                 ELCCRTVR
  3750         10  CR-LF-CEX-CCYR  REDEFINES  CR-LF-CEX-CCYY.              CL**3
  3751             15  CR-LF-CEX-CC          PIC 99.                    ELCCRTVR
  3752             15  CR-LF-CEX-YR          PIC 99.                    ELCCRTVR
  3753         10  CR-LF-CEX-MO              PIC 99.                    ELCCRTVR
  3754         10  CR-LF-CEX-DA              PIC 99.                    ELCCRTVR
  3755     05  WS-CR-LF-CANCEL-EXIT-DATE-N REDEFINES                       CL**2
  3756            WS-CR-LF-CANCEL-EXIT-DATE  PIC 9(11).                    CL**2
  3757     05  WS-CR-LF-CLAIM-EXIT-DATE.                                ELCCRTVR
  3758         10  FILLER                    PIC 999.                   ELCCRTVR
  3759         10  CR-LF-DEX-CCYY            PIC 9(04).                 ELCCRTVR
  3760         10  CR-LF-DEX-CCYR  REDEFINES  CR-LF-DEX-CCYY.           ELCCRTVR
  3761             15  CR-LF-DEX-CC          PIC 99.                    ELCCRTVR
  3762             15  CR-LF-DEX-YR          PIC 99.                    ELCCRTVR
  3763         10  CR-LF-DEX-MO              PIC 99.                    ELCCRTVR
  3764         10  CR-LF-DEX-DA              PIC 99.                    ELCCRTVR
  3765     05  WS-CR-LF-CLAIM-EXIT-DATE-N REDEFINES                        CL**2
  3766            WS-CR-LF-CLAIM-EXIT-DATE   PIC 9(11).                    CL**2
  3767     05  WS-CR-AH-CANC-DT.                                        ELCCRTVR
  3768         10  FILLER                    PIC 999.                   ELCCRTVR
  3769         10  CR-AH-CNC-CCYY            PIC 9(04).                 ELCCRTVR
  3770         10  CR-AH-CNC-CCYR  REDEFINES  CR-AH-CNC-CCYY.           ELCCRTVR
  3771             15  CR-AH-CNC-CC          PIC 99.                    ELCCRTVR
  3772             15  CR-AH-CNC-YR          PIC 99.                    ELCCRTVR
  3773         10  CR-AH-CNC-MO              PIC 99.                    ELCCRTVR
  3774         10  CR-AH-CNC-DA              PIC 99.                    ELCCRTVR
  3775     05  WS-CR-AH-CANC-DT-N  REDEFINES                               CL**2
  3776            WS-CR-AH-CANC-DT           PIC 9(11).                    CL**2
  3777     05  WS-CR-AH-CANCEL-EXIT-DATE.                               ELCCRTVR
  3778         10  FILLER                    PIC 999.                   ELCCRTVR
  3779         10  CR-AH-CEX-CCYY            PIC 9(04).                 ELCCRTVR
  3780         10  CR-AH-CEX-CCYR  REDEFINES  CR-AH-CEX-CCYY.           ELCCRTVR
  3781             15  CR-AH-CEX-CC          PIC 99.                    ELCCRTVR
  3782             15  CR-AH-CEX-YR          PIC 99.                    ELCCRTVR
  3783         10  CR-AH-CEX-MO              PIC 99.                    ELCCRTVR
  3784         10  CR-AH-CEX-DA              PIC 99.                    ELCCRTVR
  3785     05  WS-CR-AH-CANCEL-EXIT-DATE-N REDEFINES                       CL**2
  3786            WS-CR-AH-CANCEL-EXIT-DATE  PIC 9(11).                    CL**2
  3787     05  WS-CR-AH-SETTLEMENT-EXIT-DATE.                           ELCCRTVR
  3788         10  FILLER                    PIC 999.                   ELCCRTVR
  3789         10  CR-AH-DEX-CCYY            PIC 9(04).                 ELCCRTVR
  3790         10  CR-AH-DEX-CCYR  REDEFINES  CR-AH-DEX-CCYY.           ELCCRTVR
  3791             15  CR-AH-DEX-CC          PIC 99.                    ELCCRTVR
  3792             15  CR-AH-DEX-YR          PIC 99.                    ELCCRTVR
  3793         10  CR-AH-DEX-MO              PIC 99.                    ELCCRTVR
  3794         10  CR-AH-DEX-DA              PIC 99.                    ELCCRTVR
  3795     05  WS-CR-AH-SETTLEMENT-EXIT-DATEN REDEFINES                    CL**5
  3796          WS-CR-AH-SETTLEMENT-EXIT-DATE   PIC 9(11).                 CL**5
  3797     05  WS-CR-DTH-DT.                                            ELCCRTVR
  3798         10  FILLER                    PIC 999.                   ELCCRTVR
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  85
* ECS150P.cbl (/apps/prod/cid1p/copy/ELCCRTVR)
  3799         10  CR-DTH-CCYY               PIC 9(04).                 ELCCRTVR
  3800         10  CR-DTH-CCYR  REDEFINES  CR-DTH-CCYY.                 ELCCRTVR
  3801             15  CR-DTH-CC             PIC 99.                    ELCCRTVR
  3802             15  CR-DTH-YR             PIC 99.                    ELCCRTVR
  3803         10  CR-DTH-MO                 PIC 99.                    ELCCRTVR
  3804         10  CR-DTH-DA                 PIC 99.                    ELCCRTVR
  3805     05  WS-CR-DTH-DT-N REDEFINES                                    CL**2
  3806            WS-CR-DTH-DT               PIC 9(11).                    CL**2
  3807     05  WS-CR-DTH-PAY-DT.                                        ELCCRTVR
  3808         10  FILLER                    PIC 999.                   ELCCRTVR
  3809         10  CR-DTH-PAY-CCYY           PIC 9(04).                 ELCCRTVR
  3810         10  CR-DTH-PAY-CCYR  REDEFINES CR-DTH-PAY-CCYY.          ELCCRTVR
  3811             15  CR-DTH-PAY-CC         PIC 99.                    ELCCRTVR
  3812             15  CR-DTH-PAY-YR         PIC 99.                    ELCCRTVR
  3813         10  CR-DTH-PAY-MO             PIC 99.                    ELCCRTVR
  3814         10  CR-DTH-PAY-DA             PIC 99.                    ELCCRTVR
  3815     05  WS-CR-DTH-PAY-DT-N REDEFINES                                CL**2
  3816            WS-CR-DTH-PAY-DT           PIC 9(11).                    CL**2
  3817     05  WS-CR-DIS-DT.                                            ELCCRTVR
  3818         10  FILLER                    PIC 999.                   ELCCRTVR
  3819         10  CR-DIS-CCYY               PIC 9(04).                 ELCCRTVR
  3820         10  CR-DIS-CCYR  REDEFINES  CR-DIS-CCYY.                 ELCCRTVR
  3821             15  CR-DIS-CC             PIC 99.                    ELCCRTVR
  3822             15  CR-DIS-YR             PIC 99.                    ELCCRTVR
  3823         10  CR-DIS-MO                 PIC 99.                    ELCCRTVR
  3824         10  CR-DIS-DA                 PIC 99.                    ELCCRTVR
  3825     05  WS-CR-DIS-DT-N REDEFINES                                    CL**2
  3826            WS-CR-DIS-DT               PIC 9(11).                    CL**2
  3827     05  WS-CR-DIS-PAY-DT.                                        ELCCRTVR
  3828         10  FILLER                    PIC 999.                   ELCCRTVR
  3829         10  CR-DIS-PAY-CCYY           PIC 9(04).                 ELCCRTVR
  3830         10  CR-DIS-PAY-CCYR  REDEFINES  CR-DIS-PAY-CCYY.         ELCCRTVR
  3831             15  CR-DIS-PAY-CC         PIC 99.                    ELCCRTVR
  3832             15  CR-DIS-PAY-YR         PIC 99.                    ELCCRTVR
  3833         10  CR-DIS-PAY-MO             PIC 99.                    ELCCRTVR
  3834         10  CR-DIS-PAY-DA             PIC 99.                    ELCCRTVR
  3835     05  WS-CR-DIS-PAY-DT-N REDEFINES                                CL**2
  3836            WS-CR-DIS-PAY-DT           PIC 9(11).                    CL**2
  3837     05  WS-CR-DIS-PTO-DT.                                        ELCCRTVR
  3838         10  FILLER                    PIC 999.                   ELCCRTVR
  3839         10  CR-DIS-PTO-CCYY           PIC 9(04).                 ELCCRTVR
  3840         10  CR-DIS-PTO-CCYR  REDEFINES  CR-DIS-PTO-CCYY.         ELCCRTVR
  3841             15  CR-DIS-PTO-CC         PIC 99.                    ELCCRTVR
  3842             15  CR-DIS-PTO-YR         PIC 99.                    ELCCRTVR
  3843         10  CR-DIS-PTO-MO             PIC 99.                    ELCCRTVR
  3844         10  CR-DIS-PTO-DA             PIC 99.                    ELCCRTVR
  3845     05  WS-CR-DIS-PTO-DT-N REDEFINES                                CL**2
  3846            WS-CR-DIS-PTO-DT           PIC 9(11).                    CL**2
  3847     05  COPY-NDX                      PIC 9.                        CL**6
  3848     05  WS-DIS-INCUR-DT OCCURS 5 TIMES.                             CL**6
  3849         10  WS-CR-DIS-INCUR-DT.                                  ELCCRTVR
  3850             15  FILLER                PIC 999.                   ELCCRTVR
  3851             15  CR-DIS-INC-CCYY       PIC 9(04).                 ELCCRTVR
  3852             15  CR-DIS-INC-CCYR  REDEFINES  CR-DIS-INC-CCYY.     ELCCRTVR
  3853                 20  CR-DIS-INC-CC     PIC 99.                    ELCCRTVR
  3854                 20  CR-DIS-INC-YR     PIC 99.                    ELCCRTVR
  3855             15  CR-DIS-INC-MO         PIC 99.                    ELCCRTVR
  3856             15  CR-DIS-INC-DA         PIC 99.                    ELCCRTVR
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  86
* ECS150P.cbl
  3857         10  WS-CR-DIS-INCUR-DT-N REDEFINES                          CL**2
  3858                WS-CR-DIS-INCUR-DT     PIC 9(11).                    CL**2
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  87
* ECS150P.cbl
* 3860                             COPY ELCACCTV.
  3861******************************************************************04/14/98
  3862*                                                                *ELCACCTV
  3863*                            ELCACCTV                            *   LV002
  3864*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  3865*                            VMOD=2.001                          *ELCACCTV
  3866*                                                                *ELCACCTV
  3867*   WORKING STORAGE FOR DATE VARIABLES CREATED                   *ELCACCTV
  3868*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCACCTV
  3869*                                                                *ELCACCTV
  3870*  NO  CID  MODS  IN  COPYBOOK  ELCACCTV                         *ELCACCTV
  3871*                                                                *ELCACCTV
  3872******************************************************************ELCACCTV
  3873                                                                  ELCACCTV
  3874 01  WS-ACCOUNT-MASTER-DATE.                                      ELCACCTV
  3875                                                                  ELCACCTV
  3876     05  WS-AM-EXPIRE-DT.                                         ELCACCTV
  3877         10  FILLER            PIC 999.                           ELCACCTV
  3878         10  AM-EXP-CCYY       PIC 9(04).                         ELCACCTV
  3879         10  AM-EXP-CCYR  REDEFINES  AM-EXP-CCYY.                 ELCACCTV
  3880             15  AM-EXP-CC     PIC 99.                            ELCACCTV
  3881             15  AM-EXP-YR     PIC 99.                            ELCACCTV
  3882         10  AM-EXP-MO         PIC 99.                               CL**5
  3883         10  AM-EXP-DA         PIC 99.                               CL**5
  3884     05  WS-AM-EXPIRE-DT-N REDEFINES                                 CL**3
  3885            WS-AM-EXPIRE-DT    PIC 9(11).                            CL**4
  3886     05  WS-AM-VG-EXP-DATE.                                       ELCACCTV
  3887         10  FILLER                    PIC 999.                   ELCACCTV
  3888         10  AM-VG-EXP-CCYY            PIC 9(04).                 ELCACCTV
  3889         10  AM-VG-EXP-CCYR  REDEFINES  AM-VG-EXP-CCYY.           ELCACCTV
  3890             15  AM-VG-EXP-CC          PIC 99.                    ELCACCTV
  3891             15  AM-VG-EXP-YR          PIC 99.                    ELCACCTV
  3892         10  AM-VG-EXP-MO              PIC 99.                    ELCACCTV
  3893         10  AM-VG-EXP-DA              PIC 99.                    ELCACCTV
  3894     05  WS-AM-VG-EXP-DATE-N REDEFINES                               CL**3
  3895            WS-AM-VG-EXP-DATE          PIC 9(11).                    CL**4
  3896     05  WS-AM-EFFECT-DT.                                         ELCACCTV
  3897         10  FILLER                    PIC 999.                   ELCACCTV
  3898         10  AM-EFF-CCYY               PIC 9(04).                 ELCACCTV
  3899         10  AM-EFF-CCYR  REDEFINES  AM-EFF-CCYY.                 ELCACCTV
  3900             15  AM-EFF-CC             PIC 99.                    ELCACCTV
  3901             15  AM-EFF-YR             PIC 99.                    ELCACCTV
  3902         10  AM-EFF-MO                 PIC 99.                    ELCACCTV
  3903         10  AM-EFF-DA                 PIC 99.                    ELCACCTV
  3904     05  WS-AM-EFFECT-DT-N REDEFINES                                 CL**3
  3905            WS-AM-EFFECT-DT            PIC 9(11).                    CL**4
  3906     05  WS-AM-PREV-EXP-DT.                                       ELCACCTV
  3907         10 FILLER                     PIC 999.                   ELCACCTV
  3908         10 AM-PREV-EXP-DT-CCYY        PIC 9(04).                 ELCACCTV
  3909         10 AM-PREV-EXP-DT-CCYR  REDEFINES  AM-PREV-EXP-DT-CCYY.  ELCACCTV
  3910            15 AM-PREV-EXP-DT-CC       PIC 99.                    ELCACCTV
  3911            15 AM-PREV-EXP-DT-YR       PIC 99.                    ELCACCTV
  3912         10 AM-PREV-EXP-MO             PIC 99.                    ELCACCTV
  3913         10 AM-PREV-EXP-DA             PIC 99.                    ELCACCTV
  3914     05  WS-AM-PREV-EXP-DT-N REDEFINES                               CL**3
  3915            WS-AM-PREV-EXP-DT          PIC 9(11).                    CL**3
  3916     05  WS-AM-PREV-EFF-DT.                                       ELCACCTV
  3917         10 FILLER                     PIC 999.                   ELCACCTV
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  88
* ECS150P.cbl (/apps/prod/cid1p/copy/ELCACCTV)
  3918         10 AM-PREV-EFF-CCYY           PIC 9(04).                 ELCACCTV
  3919         10 AM-PREV-EFF-CCYR  REDEFINES  AM-PREV-EFF-CCYY.        ELCACCTV
  3920            15 AM-PREV-EFF-CC          PIC 99.                    ELCACCTV
  3921            15 AM-PREV-EFF-YR          PIC 99.                    ELCACCTV
  3922         10 AM-PREV-EFF-MO             PIC 99.                    ELCACCTV
  3923         10 AM-PREV-EFF-DA             PIC 99.                    ELCACCTV
  3924     05  WS-AM-PREV-EFF-DT-N REDEFINES                               CL**3
  3925            WS-AM-PREV-EFF-DT          PIC 9(11).                    CL**3
  3926     05  WS-AM-ANNIVERSARY-DATE.                                  ELCACCTV
  3927         10  FILLER                    PIC 999.                   ELCACCTV
  3928         10  AM-AN-CCYY                PIC 9(04).                 ELCACCTV
  3929         10  AM-AN-CCYR  REDEFINES  AM-AN-CCYY.                   ELCACCTV
  3930             15  AM-AN-CC              PIC 99.                    ELCACCTV
  3931             15  AM-AN-YR              PIC 99.                    ELCACCTV
  3932         10  AM-AN-MO                  PIC 99.                    ELCACCTV
  3933         10  AM-AN-DA                  PIC 99.                    ELCACCTV
  3934     05  WS-AM-ANNIVERSARY-DATE-N REDEFINES                          CL**3
  3935            WS-AM-ANNIVERSARY-DATE     PIC 9(11).                    CL**4
  3936     05  WS-AM-HI-CERT-DATE.                                      ELCACCTV
  3937         10  FILLER                    PIC 999.                   ELCACCTV
  3938         10  AM-HI-CCYY                PIC 9(04).                 ELCACCTV
  3939         10  AM-HI-CCYR  REDEFINES  AM-HI-CCYY.                   ELCACCTV
  3940             15  AM-HI-CC              PIC 99.                    ELCACCTV
  3941             15  AM-HI-YR              PIC 99.                    ELCACCTV
  3942         10  AM-HI-MO                  PIC 99.                    ELCACCTV
  3943         10  AM-HI-DA                  PIC 99.                    ELCACCTV
  3944     05  WS-AM-HI-CERT-DATE-N REDEFINES                              CL**3
  3945            WS-AM-HI-CERT-DATE         PIC 9(11).                    CL**3
  3946     05  WS-AM-LO-CERT-DATE.                                      ELCACCTV
  3947         10  FILLER                    PIC 999.                   ELCACCTV
  3948         10  AM-LO-CCYY                PIC 9(04).                 ELCACCTV
  3949         10  AM-LO-CCYR  REDEFINES  AM-LO-CCYY.                   ELCACCTV
  3950             15  AM-LO-CC              PIC 99.                    ELCACCTV
  3951             15  AM-LO-YR              PIC 99.                    ELCACCTV
  3952         10  AM-LO-MO                  PIC 99.                    ELCACCTV
  3953         10  AM-LO-DA                  PIC 99.                    ELCACCTV
  3954     05  WS-AM-LO-CERT-DATE-N REDEFINES                              CL**3
  3955            WS-AM-LO-CERT-DATE         PIC 9(11).                    CL**3
  3956     05  WS-AM-ENTRY-DATE.                                        ELCACCTV
  3957         10  FILLER                    PIC 999.                   ELCACCTV
  3958         10  AM-ENT-CCYY               PIC 9(04).                 ELCACCTV
  3959         10  AM-ENT-CCYR  REDEFINES  AM-ENT-CCYY.                 ELCACCTV
  3960             15  AM-ENT-CC             PIC 99.                    ELCACCTV
  3961             15  AM-ENT-YR             PIC 99.                    ELCACCTV
  3962         10  AM-ENT-MO                 PIC 99.                    ELCACCTV
  3963         10  AM-ENT-DA                 PIC 99.                    ELCACCTV
  3964     05  WS-AM-ENTRY-DATE-N REDEFINES                                CL**3
  3965            WS-AM-ENTRY-DATE           PIC 9(11).                    CL**3
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  89
* ECS150P.cbl
* 3967                             COPY ELCREINV.
  3968******************************************************************04/18/98
  3969*                                                                *ELCREINV
  3970*                                                                *ELCREINV
  3971*                            ELCREINV                            *   LV003
  3972*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  3973*                            VMOD=2.001                          *ELCREINV
  3974*                                                                *ELCREINV
  3975*   WORKING STORAGE FOR DATE VARIABLES CREATED                   *ELCREINV
  3976*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCREINV
  3977*                                                                *ELCREINV
  3978******************************************************************ELCREINV
  3979                                                                  ELCREINV
  3980 01  WS-REINSURANCE-RECORD-DATE.                                  ELCREINV
  3981     05  WS-RE-LO-DATE.                                              CL**3
  3982         10 FILLER                     PIC 999.                      CL**3
  3983         10 RE-LO-CCYY                 PIC 9(04).                    CL**3
  3984         10 RE-LO-CCYR  REDEFINES  RE-LO-CCYY.                       CL**3
  3985            15 RE-LO-CC                PIC 99.                       CL**3
  3986            15 RE-LO-YR                PIC 99.                       CL**3
  3987         10 RE-LO-MO                   PIC 99.                       CL**3
  3988         10 RE-LO-DA                   PIC 99.                       CL**3
  3989     05  WS-RE-LO-DATE-N REDEFINES                                   CL**3
  3990            WS-RE-LO-DATE              PIC 9(11).                    CL**3
  3991     05  WS-RE-HI-DATE.                                              CL**3
  3992         10 FILLER                     PIC 999.                      CL**3
  3993         10 RE-HI-CCYY                 PIC 9(04).                    CL**3
  3994         10 RE-HI-CCYR  REDEFINES  RE-HI-CCYY.                       CL**3
  3995            15 RE-HI-CC                PIC 99.                       CL**3
  3996            15 RE-HI-YR                PIC 99.                       CL**3
  3997         10 RE-HI-MO                   PIC 99.                       CL**3
  3998         10 RE-HI-DA                   PIC 99.                       CL**3
  3999     05  WS-RE-HI-DATE-N REDEFINES                                   CL**3
  4000            WS-RE-HI-DATE              PIC 9(11).                    CL**3
  4001     05  WS-RE-CLM-INCURRED-LIM.                                  ELCREINV
  4002         10 FILLER                     PIC 999.                   ELCREINV
  4003         10 RE-CLM-CCYY                PIC 9(04).                 ELCREINV
  4004         10 RE-CLM-CCYR  REDEFINES  RE-CLM-CCYY.                  ELCREINV
  4005            15 RE-CLM-CC               PIC 99.                    ELCREINV
  4006            15 RE-CLM-YR               PIC 99.                    ELCREINV
  4007         10 RE-CLM-MO                  PIC 99.                    ELCREINV
  4008         10 RE-CLM-DA                  PIC 99.                    ELCREINV
  4009     05  WS-RE-CLM-INCURRED-LIM-N REDEFINES                          CL**2
  4010            WS-RE-CLM-INCURRED-LIM     PIC 9(11).                    CL**2
  4011     05  WS-RE-EARNING-START-DT.                                  ELCREINV
  4012         10  FILLER                    PIC 999.                   ELCREINV
  4013         10  RE-EARN-CCYY              PIC 9(04).                 ELCREINV
  4014         10  RE-EARN-CCYR  REDEFINES  RE-EARN-CCYY.               ELCREINV
  4015             15  RE-EARN-CC            PIC 99.                    ELCREINV
  4016             15  RE-EARN-YR            PIC 99.                    ELCREINV
  4017         10  RE-EARN-MO                PIC 99.                    ELCREINV
  4018         10  RE-EARN-DA                PIC 99.                    ELCREINV
  4019     05  WS-RE-EARNING-START-DT-N REDEFINES                          CL**2
  4020            WS-RE-EARNING-START-DT     PIC 9(11).                    CL**2
  4021     05  WS-RE-EARNING-STOP-DT.                                   ELCREINV
  4022         10  FILLER                    PIC 999.                   ELCREINV
  4023         10  RE-EARN-STOP-CCYY         PIC 9(04).                 ELCREINV
  4024         10  RE-EARN-STOP-CCYR  REDEFINES  RE-EARN-STOP-CCYY.     ELCREINV
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  90
* ECS150P.cbl (/apps/prod/cid1p/copy/ELCREINV)
  4025             15  RE-EARN-STOP-CC       PIC 99.                    ELCREINV
  4026             15  RE-EARN-STOP-YR       PIC 99.                    ELCREINV
  4027         10  RE-EARN-STOP-MO           PIC 99.                    ELCREINV
  4028         10  RE-EARN-STOP-DA           PIC 99.                    ELCREINV
  4029     05  WS-RE-EARNING-STOP-DT-N REDEFINES                           CL**2
  4030            WS-RE-EARNING-STOP-DT      PIC 9(11).                    CL**2
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  91
* ECS150P.cbl
  4032 PROCEDURE DIVISION.
  4033******************************************************************
  4034*                                                                *
  4035*                *** SECTION DESCRIPTIONS ***                    *
  4036*  * SECTION NO. *                                               *
  4037*                                                                *
  4038*      1000      CLAS DATE LOAD, DATE EDITS, WORK AREA INIT      *
  4039*                                                                *
  4040*      2000      PERFORM LOOP FOR EXTRACT-A                      *
  4041*                                                                *
  4042*      3000      PERFORM LOOP FOR EXTRACT-B                      *
  4043*                                                                *
  4044*      4000      COMPUTATIONS FOR-RESERVES, CLAIMS, ISSUES,      *
  4045*                                 CANCELS, INCREASES/DECREASES   *
  4046*                                                                *
  4047*      5000      PRINT ROUTINES                                  *
  4048*                                                                *
  4049*      6000      REINSURANCE CALCULATIONS                        *
  4050*                                                                *
  4051*      7000      LEVEL BREAK PROCESSING                          *
  4052*                                                                *
  4053*      8000      MISCELANEOUS ROUTINES                           *
  4054*                                                                *
  4055*      9990      PROGRAM EXIT                                    *
  4056******************************************************************
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  92
* ECS150P.cbl
  4058 0100-ININITIALIZATION       SECTION 49.
  4059
  4060 0110-CLAS-DATA-LOAD.
* 4061                             COPY ELCDTERX.
  4062******************************************************************04/15/98
  4063*                                                                *ELCDTERX
  4064*                                                                *ELCDTERX
  4065*                            ELCDTERX.                           *   LV002
  4066*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  4067*                            VMOD=2.007                          *ELCDTERX
  4068*                                                                *ELCDTERX
  4069*      LOAD DATE CARD DISK FILE INTO WORKING STORAGE AREA        *ELCDTERX
  4070*      (COPY CODE FOR W/S = ELCDTECX AND COPY CODE FOR FD        *ELCDTERX
  4071*      = ELCDTEFD)                                               *ELCDTERX
  4072*                                                                *ELCDTERX
  4073******************************************************************ELCDTERX
  4074                                                                  ELCDTERX
  4075     ACCEPT WS-ACCEPT-DATE       FROM  DATE.                      ELCDTERX
  4076                                                                  ELCDTERX
  4077     MOVE WS-AD-YY               TO  WS-CD-YY.                    ELCDTERX
  4078     MOVE WS-AD-MM               TO  WS-CD-MM.                    ELCDTERX
  4079     MOVE WS-AD-DD               TO  WS-CD-DD.                    ELCDTERX
  4080                                                                  ELCDTERX
  4081     ACCEPT WS-TIME-OF-DAY       FROM  TIME.                      ELCDTERX
  4082                                                                  ELCDTERX
  4083******************************************************************ELCDTERX
  4084*    NOTE: THE FOLLOWING STATEMENT IS USED TO ELIMINATE COB II    ELCDTERX
  4085*          WARNING MESSAGES.                                      ELCDTERX
  4086******************************************************************ELCDTERX
  4087     IF WS-CD-YY = LOW-VALUES                                     ELCDTERX
  4088         COMPUTE PGM-SUB = PGM-SUB + 1.                           ELCDTERX
  4089                                                                  ELCDTERX
  4090     OPEN INPUT DISK-DATE.                                        ELCDTERX
  4091                                                                  ELCDTERX
  4092     MOVE SPACE TO DATE-CARD         CLAS-BUSINESS-CLASSES        ELCDTERX
  4093                   STATE-NAMES       CLAS-MORTALITY-CODES         ELCDTERX
  4094                   CLAS-INS-TYPES    COMPANY-NAME-TABLE           ELCDTERX
  4095                   DATE-CARD-OPTIONS DATE-CARD-FACTORS            ELCDTERX
  4096                   CLAX-ID           CLAS-MISC                    ELCDTERX
  4097                   CARRIER-NAMES     CLASIC-SYSTEM-CODES          ELCDTERX
  4098                   CARRIER-OPT-CLAIM-DATA                         ELCDTERX
  4099                   STATE-TARGET-LOSS-RATIOS                       ELCDTERX
  4100                   BUSINESS-TRGT-LOSS-RATIO-MODS                  ELCDTERX
  4101                   MISC-OPT-CLM-RSV-DATA.                         ELCDTERX
  4102                                                                  ELCDTERX
  4103     MOVE LOW-VALUES TO CLAS-INDEX-TBL CLAS-TYPE-MISC.            ELCDTERX
  4104                                                                  ELCDTERX
  4105     MOVE ZERO TO CLAS-CN DTE-TOT-LINES CLAS-CO                   ELCDTERX
  4106                  INDEXCA INDEXBS INDEXST.                        ELCDTERX
  4107                                                                  ELCDTERX
  4108     COMPUTE CLAS-CN = PGM-SUB / +50.                             ELCDTERX
  4109     COMPUTE CLAS-CO = PGM-SUB / +20.                             ELCDTERX
  4110     COMPUTE CLAS-INDEXEN = PGM-SUB - (CLAS-CN * +50).            ELCDTERX
  4111     COMPUTE CLAS-INDEXON = PGM-SUB - (CLAS-CO * +20).            ELCDTERX
  4112                                                                  ELCDTERX
  4113     IF CLAS-INDEXEN = ZERO                                       ELCDTERX
  4114         MOVE +50               TO CLAS-INDEXEN                   ELCDTERX
  4115     ELSE                                                         ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  93
* ECS150P.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  4116         ADD +1                 TO CLAS-CN.                       ELCDTERX
  4117                                                                  ELCDTERX
  4118     IF CLAS-INDEXON = ZERO                                       ELCDTERX
  4119         MOVE +20               TO CLAS-INDEXON                   ELCDTERX
  4120     ELSE                                                         ELCDTERX
  4121         ADD +1                 TO CLAS-CO.                       ELCDTERX
  4122                                                                  ELCDTERX
  4123 0005-READ--CARD.                                                 ELCDTERX
  4124     READ DISK-DATE                                               ELCDTERX
  4125         AT END CLOSE DISK-DATE                                   ELCDTERX
  4126             GO TO 0060-READ--TEST.                               ELCDTERX
  4127                                                                  ELCDTERX
  4128     MOVE ZERO                   TO CLAS-INDEX.                   ELCDTERX
  4129                                                                  ELCDTERX
  4130     IF DD-ID = 'CLAS' OR 'LIFE' OR 'GLED'                        ELCDTERX
  4131         MOVE DATE-DISK          TO DATE-CARD                     ELCDTERX
  4132         MOVE RUN-DATE           TO WS-RUN-DATE-N                    CL**2
  4133         MOVE EP-DT              TO WS-EP-DT-N                       CL**2
  4134         GO TO 0005-READ--CARD.                                   ELCDTERX
  4135                                                                  ELCDTERX
  4136     IF DD-ID = 'CLAD'                                            ELCDTERX
  4137         MOVE DATE-DISK          TO DATE-CARD-OPTIONS             ELCDTERX
  4138         GO TO 0005-READ--CARD.                                   ELCDTERX
  4139                                                                  ELCDTERX
  4140     IF DD-ID = 'CLAX'                                            ELCDTERX
  4141         MOVE DATE-DISK          TO CLAS-INDEX-TBL                ELCDTERX
  4142         GO TO 0005-READ--CARD.                                   ELCDTERX
  4143                                                                  ELCDTERX
  4144     IF DD-ID = 'CLAF'                                            ELCDTERX
  4145         MOVE DATE-DISK          TO DATE-CARD-FACTORS             ELCDTERX
  4146         GO TO 0005-READ--CARD.                                   ELCDTERX
  4147                                                                  ELCDTERX
  4148     IF DD-ID = 'CLAC'                                            ELCDTERX
  4149         GO TO 0010-READ--CLAC.                                   ELCDTERX
  4150                                                                  ELCDTERX
  4151     IF DD-ID = 'CARR'                                            ELCDTERX
  4152         GO TO 0015-READ--CARR.                                   ELCDTERX
  4153                                                                  ELCDTERX
  4154     IF DD-ID = 'STAT'                                            ELCDTERX
  4155         GO TO 0020-READ--STAT.                                   ELCDTERX
  4156                                                                  ELCDTERX
  4157     IF DD-ID = 'BUSC'                                            ELCDTERX
  4158         GO TO 0025-READ--BUSC.                                   ELCDTERX
  4159                                                                  ELCDTERX
  4160     IF DD-ID = 'MORT'                                            ELCDTERX
  4161         GO TO 0030-READ--MORT.                                   ELCDTERX
  4162                                                                  ELCDTERX
  4163     IF DD-ID = 'CLAI'                                            ELCDTERX
  4164         GO TO 0040-READ--CLAI.                                   ELCDTERX
  4165                                                                  ELCDTERX
  4166     IF DD-ID = 'COLC'                                            ELCDTERX
  4167         GO TO 0065-READ--COLC.                                   ELCDTERX
  4168                                                                  ELCDTERX
  4169     IF DD-IDX NUMERIC AND                                        ELCDTERX
  4170        DD-IDA = 'CL'                                             ELCDTERX
  4171         GO TO 0035-READ--CLXX.                                   ELCDTERX
  4172                                                                  ELCDTERX
  4173     IF DD-IDX NUMERIC AND                                        ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  94
* ECS150P.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  4174        DD-IDA = 'PO'                                             ELCDTERX
  4175         GO TO 0050-READ--POXX.                                   ELCDTERX
  4176                                                                  ELCDTERX
  4177     IF DD-ID = 'OPCA'                                            ELCDTERX
  4178         GO TO 0070-READ--OPCA.                                   ELCDTERX
  4179                                                                  ELCDTERX
  4180     IF DD-ID = 'OPST'                                            ELCDTERX
  4181         GO TO 0072-READ--OPST.                                   ELCDTERX
  4182                                                                  ELCDTERX
  4183     IF DD-ID = 'OPBS'                                            ELCDTERX
  4184         GO TO 0074-READ--OPBS.                                   ELCDTERX
  4185                                                                  ELCDTERX
  4186     IF DD-ID = 'OPMS'                                            ELCDTERX
  4187         MOVE DD-MISC-DATA       TO MISC-OPT-CLM-RSV-DATA.        ELCDTERX
  4188                                                                  ELCDTERX
  4189     GO TO 0005-READ--CARD.                                       ELCDTERX
  4190                                                                  ELCDTERX
  4191 0010-READ--CLAC.                                                 ELCDTERX
  4192     ADD 1                       TO CLAS-INDEXC.                  ELCDTERX
  4193     MOVE DD-CR1                 TO CNT-ID (CLAS-INDEXC).         ELCDTERX
  4194     MOVE DD-CR1N                TO CNT-NAME (CLAS-INDEXC).       ELCDTERX
  4195     ADD 1                       TO CLAS-INDEXC.                  ELCDTERX
  4196     MOVE DD-CR2                 TO CNT-ID (CLAS-INDEXC).         ELCDTERX
  4197     MOVE DD-CR2N                TO CNT-NAME (CLAS-INDEXC).       ELCDTERX
  4198     GO TO 0005-READ--CARD.                                       ELCDTERX
  4199                                                                  ELCDTERX
  4200 0015-READ--CARR.                                                 ELCDTERX
  4201     ADD 1  TO  CLAS-INDEXCN.                                     ELCDTERX
  4202     IF CLAS-INDEXCN LESS THAN +26                                ELCDTERX
  4203        MOVE DD-CARR1         TO CARRIER-SUB (CLAS-INDEXCN)
  4204        MOVE DD-CARR1S        TO CARRIER-DOM-ST (CLAS-INDEXCN)
  4205        MOVE DD-CARR1N        TO CARRIER-PIC (CLAS-INDEXCN)
  4206        MOVE DD-CARR1-UEP-PCT TO CARRIER-UEP-PCT (CLAS-INDEXCN)
  4207        MOVE DD-CARR1-R78-PCT TO CARRIER-R78-PCT (CLAS-INDEXCN)
  4208        MOVE DD-CARR1-PRO-PCT TO CARRIER-PRO-PCT (CLAS-INDEXCN)
  4209        MOVE DD-CARR1-SECPAY-SW
  4210                               TO CARRIER-SEC-PAY (CLAS-INDEXCN)
  4211     END-IF
  4212                                                                  ELCDTERX
  4213     ADD 1  TO  CLAS-INDEXCN.                                     ELCDTERX
  4214     IF CLAS-INDEXCN LESS THAN +26                                ELCDTERX
  4215        MOVE DD-CARR2         TO CARRIER-SUB (CLAS-INDEXCN)
  4216        MOVE DD-CARR2S        TO CARRIER-DOM-ST (CLAS-INDEXCN)
  4217        MOVE DD-CARR2N        TO CARRIER-PIC (CLAS-INDEXCN)
  4218        MOVE DD-CARR2-UEP-PCT TO CARRIER-UEP-PCT (CLAS-INDEXCN)
  4219        MOVE DD-CARR2-R78-PCT TO CARRIER-R78-PCT (CLAS-INDEXCN)
  4220        MOVE DD-CARR2-PRO-PCT TO CARRIER-PRO-PCT (CLAS-INDEXCN)
  4221        MOVE DD-CARR2-SECPAY-SW
  4222                              TO CARRIER-SEC-PAY (CLAS-INDEXCN)
  4223     END-IF
  4224                                                                  ELCDTERX
  4225                                                                  ELCDTERX
  4226     GO TO 0005-READ--CARD.                                       ELCDTERX
  4227                                                                  ELCDTERX
  4228 0020-READ--STAT.                                                 ELCDTERX
  4229     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  4230     IF CLAS-INDEX GREATER 3  OR                                  ELCDTERX
  4231        DD-ST (CLAS-INDEX) = SPACE                                ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  95
* ECS150P.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  4232         GO TO 0005-READ--CARD.                                   ELCDTERX
  4233                                                                  ELCDTERX
  4234     ADD 1                       TO CLAS-INDEXS.                  ELCDTERX
  4235     MOVE DD-ST (CLAS-INDEX)     TO STATE-NAME-FLD (CLAS-INDEXS). ELCDTERX
  4236     GO TO 0020-READ--STAT.                                       ELCDTERX
  4237                                                                  ELCDTERX
  4238 0025-READ--BUSC.                                                 ELCDTERX
  4239     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  4240     IF CLAS-INDEX GREATER 3  OR                                  ELCDTERX
  4241        DD-ST (CLAS-INDEX) = SPACE                                ELCDTERX
  4242         GO TO 0005-READ--CARD.                                   ELCDTERX
  4243                                                                  ELCDTERX
  4244     ADD 1                       TO CLAS-INDEXB.                  ELCDTERX
  4245     MOVE DD-ST (CLAS-INDEX)     TO CLAS-BUSC-FLD (CLAS-INDEXB).  ELCDTERX
  4246     GO TO 0025-READ--BUSC.                                       ELCDTERX
  4247                                                                  ELCDTERX
  4248 0030-READ--MORT.                                                 ELCDTERX
  4249     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  4250     IF CLAS-INDEX GREATER 2  OR                                  ELCDTERX
  4251        DD-MORT (CLAS-INDEX) = SPACE                              ELCDTERX
  4252         GO TO 0005-READ--CARD.                                   ELCDTERX
  4253                                                                  ELCDTERX
  4254     ADD 1                       TO CLAS-INDEXM.                  ELCDTERX
  4255     MOVE DD-MORT (CLAS-INDEX)   TO CLAS-MORT-FLD (CLAS-INDEXM).  ELCDTERX
  4256     GO TO 0030-READ--MORT.                                       ELCDTERX
  4257                                                                  ELCDTERX
  4258 0035-READ--CLXX.                                                 ELCDTERX
  4259     IF DD-IDX NOT = CLAS-CN                                      ELCDTERX
  4260          GO TO 0005-READ--CARD.                                  ELCDTERX
  4261                                                                  ELCDTERX
  4262     IF DD-PS-PIC (CLAS-INDEXEN) = 'X'                            ELCDTERX
  4263         DISPLAY '***********************************************'ELCDTERX
  4264         DISPLAY 'PROGRAM ECS-', PGM-SUB, ' NOT SCHEDULED TO RUN' ELCDTERX
  4265         DISPLAY '***********************************************'ELCDTERX
  4266         GO TO 0055-READ--STOP.                                   ELCDTERX
  4267                                                                  ELCDTERX
  4268     IF DD-PS-PIC (CLAS-INDEXEN) NOT LESS 'A'  AND                ELCDTERX
  4269        DD-PS-PIC (CLAS-INDEXEN) NOT GREATER 'I'                  ELCDTERX
  4270         MOVE '1'                TO DTE-FICH.                     ELCDTERX
  4271                                                                  ELCDTERX
  4272     IF DD-PS-PIC (CLAS-INDEXEN) NOT LESS 'J'  AND                ELCDTERX
  4273        DD-PS-PIC (CLAS-INDEXEN) NOT GREATER 'R'                  ELCDTERX
  4274         MOVE '2'                TO DTE-FICH.                     ELCDTERX
  4275                                                                  ELCDTERX
  4276*    MOVE DD-PS-PIC (CLAS-INDEXEN) TO DTE-PGM-OPT.                ELCDTERX
  4277     GO TO 0005-READ--CARD.                                       ELCDTERX
  4278                                                                  ELCDTERX
  4279 0040-READ--CLAI.                                                 ELCDTERX
  4280     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  4281     IF CLAS-INDEX GREATER 2  OR                                  ELCDTERX
  4282        DD-TYPE (CLAS-INDEX) = SPACE                              ELCDTERX
  4283         GO TO 0005-READ--CARD.                                   ELCDTERX
  4284                                                                  ELCDTERX
  4285     ADD 1                       TO CLAS-INDEXA.                  ELCDTERX
  4286     MOVE DD-TYPE (CLAS-INDEX) TO CLAS-ALL-TYPES (CLAS-INDEXA).   ELCDTERX
  4287     GO TO 0040-READ--CLAI.                                       ELCDTERX
  4288                                                                  ELCDTERX
  4289 0045-READ--DUMP.                                                 ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  96
* ECS150P.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  4290     MOVE +999 TO WS-RETURN-CODE                                  ELCDTERX
  4291     MOVE 'MISSING AND/OR INVALID CLAS DATE CARD'                 ELCDTERX
  4292                                 TO  WS-ABEND-MESSAGE             ELCDTERX
  4293     PERFORM ABEND-PGM.                                           ELCDTERX
  4294                                                                  ELCDTERX
  4295 0050-READ--POXX.                                                 ELCDTERX
  4296     IF DD-IDX NOT = CLAS-CO                                      ELCDTERX
  4297         GO TO 0005-READ--CARD.                                   ELCDTERX
  4298                                                                  ELCDTERX
  4299     IF DD-PS-PRC (CLAS-INDEXON) = 'X'                            ELCDTERX
  4300         DISPLAY '***********************************************'ELCDTERX
  4301         DISPLAY 'ECS - ', PGM-SUB, ' IS NOT SCHEDULED TO RUN'    ELCDTERX
  4302         DISPLAY '***********************************************'ELCDTERX
  4303         GO TO 0055-READ--STOP.                                   ELCDTERX
  4304                                                                  ELCDTERX
  4305     MOVE DD-PS-PRT (CLAS-INDEXON) TO DTE-PRT-OPT.                ELCDTERX
  4306     MOVE DD-PS-FMT (CLAS-INDEXON) TO DTE-FMT-OPT.                ELCDTERX
  4307     MOVE DD-PS-PRC (CLAS-INDEXON) TO DTE-PRC-OPT DTE-PGM-OPT.    ELCDTERX
  4308     MOVE DD-PS-TOT (CLAS-INDEXON) TO DTE-TOT-OPT.                ELCDTERX
  4309                                                                  ELCDTERX
  4310     IF DTE-PRT-OPT = 'B'                                         ELCDTERX
  4311         MOVE '2'                  TO DTE-FICH.                   ELCDTERX
  4312     IF DTE-PRT-OPT = 'F'                                         ELCDTERX
  4313         MOVE '1'                  TO DTE-FICH.                   ELCDTERX
  4314                                                                  ELCDTERX
  4315     GO TO 0005-READ--CARD.                                       ELCDTERX
  4316                                                                  ELCDTERX
  4317 0055-READ--STOP.                                                 ELCDTERX
  4318     GOBACK.                                                      ELCDTERX
  4319                                                                  ELCDTERX
  4320 0060-READ--TEST.                                                 ELCDTERX
  4321     IF DATX-COD        = SPACE  OR                               ELCDTERX
  4322        CLAX-ID         = SPACE  OR                               ELCDTERX
  4323        DATE-OPTIONS-ID = SPACE                                   ELCDTERX
  4324         GO TO 0045-READ--DUMP.                                   ELCDTERX
  4325                                                                  ELCDTERX
  4326     MOVE LOW-VALUE TO CLAS-TYPE-MISC.                            ELCDTERX
  4327     GO TO 0079-READ--EXIT.                                       ELCDTERX
  4328                                                                  ELCDTERX
  4329 0065-READ--COLC.                                                 ELCDTERX
  4330     MOVE DATE-DISK              TO CLASIC-SYSTEM-CODES.          ELCDTERX
  4331     GO TO 0005-READ--CARD.                                       ELCDTERX
  4332                                                                  ELCDTERX
  4333 0070-READ--OPCA.                                                 ELCDTERX
  4334                                                                  ELCDTERX
  4335     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  4336                                                                  ELCDTERX
  4337     IF  CLAS-INDEX GREATER 13                                    ELCDTERX
  4338             OR                                                   ELCDTERX
  4339         DD-CARR-FLDS (CLAS-INDEX) = SPACE                        ELCDTERX
  4340         GO TO 0005-READ--CARD.                                   ELCDTERX
  4341                                                                  ELCDTERX
  4342     ADD 1                       TO INDEXCA.                      ELCDTERX
  4343     MOVE DD-CARR-FLDS (CLAS-INDEX)                               ELCDTERX
  4344                                 TO CARRIER-FLDS (INDEXCA).       ELCDTERX
  4345     GO TO 0070-READ--OPCA.                                       ELCDTERX
  4346                                                                  ELCDTERX
  4347 0072-READ--OPST.                                                 ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  97
* ECS150P.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  4348                                                                  ELCDTERX
  4349     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  4350                                                                  ELCDTERX
  4351     IF  CLAS-INDEX GREATER 16                                    ELCDTERX
  4352             OR                                                   ELCDTERX
  4353         DD-TLR (CLAS-INDEX) = SPACE                              ELCDTERX
  4354         GO TO 0005-READ--CARD.                                   ELCDTERX
  4355                                                                  ELCDTERX
  4356     ADD 1                       TO INDEXST.                      ELCDTERX
  4357     MOVE DD-STATE-FLDS (CLAS-INDEX)                              ELCDTERX
  4358                                 TO STATE-TLR-FLD (INDEXST).      ELCDTERX
  4359     GO TO 0072-READ--OPST.                                       ELCDTERX
  4360                                                                  ELCDTERX
  4361 0074-READ--OPBS.                                                 ELCDTERX
  4362                                                                  ELCDTERX
  4363     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  4364                                                                  ELCDTERX
  4365     IF  CLAS-INDEX GREATER 32                                    ELCDTERX
  4366             OR                                                   ELCDTERX
  4367         DD-TLR (CLAS-INDEX) = SPACE                              ELCDTERX
  4368         GO TO 0005-READ--CARD.                                   ELCDTERX
  4369                                                                  ELCDTERX
  4370     ADD 1                       TO INDEXBS.                      ELCDTERX
  4371     MOVE DD-TLR (CLAS-INDEX)    TO BUS-TLRM-FLD (INDEXBS).       ELCDTERX
  4372     GO TO 0074-READ--OPBS.                                       ELCDTERX
  4373                                                                  ELCDTERX
  4374 0079-READ--EXIT.                                                 ELCDTERX
  4375*    EXIT.                                                        ELCDTERX
  4376******************************************************************ELCDTERX
  4377
  4378 0120-PERIOD-EDIT.
  4379**   MOVE 1 TO DTE-PGM-OPT.
  4380     IF EP-CCYY GREATER THAN RUN-CCYY OR
  4381        EP-MO GREATER THAN RUN-MO
  4382         GO TO 0130-CLEAR-WORK.
  4383
  4384     IF EP-DT = RUN-DATE
  4385         SUBTRACT +1 FROM RUN-CCYY
  4386         MOVE WS-RUN-DATE-N TO RUN-DATE
  4387         GO TO 0130-CLEAR-WORK.
  4388
  4389     DISPLAY 'PERIOD START IS AFTER PERIOD END-CHECK CLAS CARD'.
  4390     MOVE '0998'                 TO ABEND-CODE.
  4391     GO TO ABEND-PGM.
  4392
  4393 0130-CLEAR-WORK.
  4394     MOVE HIGH-VALUES            TO REIN-HOLD-AREAS.
  4395     MOVE SPACES                 TO REIN-LEVELS-END.
  4396     PERFORM 8100-CLEAR-TABLES THRU 8100-EXIT
  4397         VARYING CL FROM +1 BY +1
  4398             UNTIL CL GREATER THAN +5.
  4399
  4400 0140-OPEN-FILES.
  4401     OPEN INPUT ERACCTT  CERT-FILE
  4402          OUTPUT PRINT-FILE  CLAS150-A-EXTRACT.
  4403     MOVE LOW-VALUES             TO ACCOUNT-MASTER.
  4404
* 4405     COPY ELCACCTI.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  98
* ECS150P.cbl (/apps/prod/cid1p/copy/ELCACCTI)
  4406******************************************************************04/14/98
  4407*                                                                *ELCACCTI
  4408*                            ELCACCTI                            *   LV003
  4409*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
  4410*                            VMOD=2.001                          *ELCACCTI
  4411*                                                                *ELCACCTI
  4412*   COPY FILE VARIABLES TO WORKING STORAGE                       *ELCACCTI
  4413*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCACCTI
  4414*                                                                *ELCACCTI
  4415*  NO  CID  MODS  IN  COPYBOOK  ELCACCTI                         *ELCACCTI
  4416*                                                                *ELCACCTI
  4417******************************************************************ELCACCTI
  4418     MOVE AM-EXPIRE-DT           TO  WS-AM-EXPIRE-DT-N.              CL**2
  4419     MOVE AM-VG-EXP-DATE         TO  WS-AM-VG-EXP-DATE-N.            CL**2
  4420     MOVE AM-EFFECT-DT           TO  WS-AM-EFFECT-DT-N.              CL**2
  4421     MOVE AM-PREV-EXP-DT         TO  WS-AM-PREV-EXP-DT-N.            CL**2
  4422     MOVE AM-PREV-EFF-DT         TO  WS-AM-PREV-EFF-DT-N             CL**2
  4423     MOVE AM-ANNIVERSARY-DATE    TO  WS-AM-ANNIVERSARY-DATE-N.       CL**2
  4424     MOVE AM-HI-CERT-DATE        TO  WS-AM-HI-CERT-DATE-N.           CL**2
  4425     MOVE AM-LO-CERT-DATE        TO  WS-AM-LO-CERT-DATE-N.           CL**2
  4426     MOVE AM-ENTRY-DATE          TO  WS-AM-ENTRY-DATE-N.             CL**2
  4427
  4428     IF ACCT-FILE-STATUS NOT = '00' AND '97'
  4429         MOVE ACCT-FILE-STATUS   TO WS-ABEND-FILE-STATUS
  4430         MOVE ' ERROR ACCOUNT MASTER OPEN '
  4431                                 TO WS-ABEND-MESSAGE
  4432         PERFORM ABEND-PGM.
  4433
  4434     MOVE 'R'                        TO  CP-RATE-FILE.
  4435     MOVE 'O'                        TO  CP-IO-FUNCTION.
  4436     PERFORM 8455-CALL-RATING-ROUTINE THRU 8499-EXIT.
  4437     IF IO-ERROR
  4438         MOVE 0302                   TO  WS-RETURN-CODE
  4439         MOVE 'ERROR OCCURED OPENING - ELRATE'
  4440                                     TO  WS-ABEND-MESSAGE
  4441         GO TO ABEND-PGM.
  4442
  4443 0150-SET-DATES.
  4444
  4445     MOVE RUN-DATE                   TO DC-GREG-DATE-CYMD.
  4446     MOVE 'L'                        TO DC-OPTION-CODE.
  4447     PERFORM 8500-DATE-CONVERT-ROUTINE THRU 8599-DATE-CONVERT-X.
  4448     MOVE DC-BIN-DATE-1              TO RUN-DATE-BIN PERIOD-START.
  4449
  4450     MOVE EP-DT                      TO DC-GREG-DATE-CYMD.
  4451     MOVE 'L'                        TO DC-OPTION-CODE.
  4452     PERFORM 8500-DATE-CONVERT-ROUTINE THRU 8599-DATE-CONVERT-X.
  4453     MOVE DC-BIN-DATE-1              TO PERIOD-END  EP-DT-BIN.
  4454
  4455     COMPUTE PERIOD-START-9 = (RUN-CCYY * 12) + RUN-MO.
  4456     COMPUTE PERIOD-END-9 = (EP-CCYY * 12) + EP-MO.
  4457
  4458
  4459
  4460     MOVE COMPANY-NAME           TO HL-CO-NAME.
  4461     MOVE WS-CURRENT-DATE        TO HL-DATE.
  4462     MOVE RUN-DATE               TO DATE-WORK.
  4463     MOVE CORRESPONDING RAW-DATE TO FORMAT-DATE.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  99
* ECS150P.cbl
  4464     MOVE FORMAT-DATE            TO HL-PER-START.
  4465     MOVE EP-DT                  TO DATE-WORK.
  4466     MOVE CORRESPONDING RAW-DATE TO FORMAT-DATE.
  4467     MOVE FORMAT-DATE            TO HL-PER-END.
  4468
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 100
* ECS150P.cbl
  4470 1000-MAINLINE-CONTROL       SECTION 05.
  4471
  4472 1100-CREATE-EXTRACT-A.
  4473
  4474     PERFORM 2000-EXTRACT-A THRU 2000-EXIT
  4475         UNTIL CR-ACCT-CONTROL = HIGH-VALUES.
  4476     CLOSE ERACCTT CERT-FILE  CLAS150-A-EXTRACT.
  4477
  4478     IF REINS-FILE-OPEN
  4479         CLOSE REINS-EXTRACT-1.
  4480
  4481     IF REIN-OPEN-SW NOT = SPACE
  4482         MOVE SPACE              TO REIN-OPEN-SW
  4483         CLOSE ERRTBL-IN
  4484         IF ERRTBL-FILE-STATUS NOT = '00'
  4485             MOVE '22'           TO ABEND-FILE-ID
  4486             MOVE ERRTBL-FILE-STATUS
  4487                                 TO ABEND-REASON
  4488             GO TO ABEND-PGM.
  4489
  4490     IF NO-REINSURANCE
  4491         GO TO 9990-PROGRAM-END.
  4492
  4493 1200-CREATE-EXTRACT-BC.
  4494     SORT SORT-WORK  ASCENDING KEY SORT-KEY
  4495         USING REINS-EXTRACT-1
  4496             GIVING REINS-EXTRACT-2.
  4497 S1200-EXIT.
  4498     EXIT.
  4499
  4500 1200-CONTINUE.
  4501     OPEN INPUT  REINS-EXTRACT-2
  4502          OUTPUT CLAS150-B-EXTRACT  CLAS150-C-EXTRACT.
  4503     MOVE SPACES                 TO SAVE-CONTROL-BREAKS.
  4504     MOVE LOW-VALUES             TO CERTIFICATE-RECORD.
* 4505     COPY ELCCRTM1.
  4506******************************************************************04/15/98
  4507*                                                                *ELCCRTM1
  4508*                                                                *ELCCRTM1
  4509*                            ELCCRTM1                            *   LV003
  4510*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
  4511*                            VMOD=2.001                          *ELCCRTM1
  4512*                                                                *ELCCRTM1
  4513*   COPY FILE VARIABLES TO WORKING STORAGE                       *ELCCRTM1
  4514*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCCRTM1
  4515*                                                                *ELCCRTM1
  4516******************************************************************ELCCRTM1
  4517     MOVE CR-DT                   TO  WS-CR-DT-N.                    CL**2
  4518     MOVE CR-LF-EXPIRE-DATE       TO  WS-CR-LF-EXPIRE-DATE-N.        CL**2
  4519     MOVE CR-AH-EXPIRE-DATE       TO  WS-CR-AH-EXPIRE-DATE-N.        CL**2
  4520     MOVE CR-ENTRY-DATE           TO  WS-CR-ENTRY-DATE-N.            CL**2
  4521     MOVE CR-LF-CANC-DT           TO  WS-CR-LF-CANC-DT-N.            CL**2
  4522     MOVE CR-LF-CANCEL-EXIT-DATE  TO  WS-CR-LF-CANCEL-EXIT-DATE-N.   CL**2
  4523     MOVE CR-LF-CLAIM-EXIT-DATE   TO  WS-CR-LF-CLAIM-EXIT-DATE-N.    CL**2
  4524     MOVE CR-AH-CANC-DT           TO  WS-CR-AH-CANC-DT-N.            CL**2
  4525     MOVE CR-AH-CANCEL-EXIT-DATE  TO                                 CL**2
  4526                                  WS-CR-AH-CANCEL-EXIT-DATE-N.       CL**2
  4527     MOVE CR-AH-SETTLEMENT-EXIT-DATE TO                           ELCCRTM1
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 101
* ECS150P.cbl (/apps/prod/cid1p/copy/ELCCRTM1)
  4528                                 WS-CR-AH-SETTLEMENT-EXIT-DATEN.     CL**2
  4529     MOVE CR-DTH-DT               TO  WS-CR-DTH-DT-N.                CL**2
  4530     MOVE CR-DTH-PAY-DT           TO  WS-CR-DTH-PAY-DT-N.            CL**2
  4531     MOVE CR-DIS-DT               TO  WS-CR-DIS-DT-N.                CL**2
  4532     MOVE CR-DIS-PAY-DT           TO  WS-CR-DIS-PAY-DT-N.            CL**2
  4533     MOVE CR-DIS-PTO-DT           TO  WS-CR-DIS-PTO-DT-N.            CL**2
  4534     PERFORM  VARYING COPY-NDX FROM 1 BY 1 UNTIL COPY-NDX > 5     ELCCRTM1
  4535           MOVE CR-DIS-INCUR-DT (COPY-NDX)   TO                   ELCCRTM1
  4536                                WS-CR-DIS-INCUR-DT-N (COPY-NDX)      CL**2
  4537     END-PERFORM.                                                 ELCCRTM1
  4538                                                                  ELCCRTM1
  4539     MOVE +1                     TO PASS-TYPE.
  4540     PERFORM 8100-CLEAR-TABLES THRU 8100-EXIT
  4541         VARYING CL FROM +1 BY +1
  4542             UNTIL CL GREATER +5.
  4543     PERFORM 3000-EXTRACT-BC THRU 3000-EXIT
  4544         UNTIL RC-CONTROL = HIGH-VALUES.
  4545     CLOSE CLAS150-B-EXTRACT  CLAS150-C-EXTRACT  REINS-EXTRACT-2.
  4546     GO TO 9990-PROGRAM-END.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 102
* ECS150P.cbl
  4548
  4549 2000-EXTRACT-A          SECTION 10.
  4550 2100-READ-CERT-FILE.
  4551     READ CERT-FILE INTO CERTIFICATE-RECORD AT END
  4552         MOVE HIGH-VALUES        TO CR-ACCT-CONTROL.
  4553
* 4554     COPY ELCCRTM1.
  4555******************************************************************04/15/98
  4556*                                                                *ELCCRTM1
  4557*                                                                *ELCCRTM1
  4558*                            ELCCRTM1                            *   LV003
  4559*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
  4560*                            VMOD=2.001                          *ELCCRTM1
  4561*                                                                *ELCCRTM1
  4562*   COPY FILE VARIABLES TO WORKING STORAGE                       *ELCCRTM1
  4563*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCCRTM1
  4564*                                                                *ELCCRTM1
  4565******************************************************************ELCCRTM1
  4566     MOVE CR-DT                   TO  WS-CR-DT-N.                    CL**2
  4567     MOVE CR-LF-EXPIRE-DATE       TO  WS-CR-LF-EXPIRE-DATE-N.        CL**2
  4568     MOVE CR-AH-EXPIRE-DATE       TO  WS-CR-AH-EXPIRE-DATE-N.        CL**2
  4569     MOVE CR-ENTRY-DATE           TO  WS-CR-ENTRY-DATE-N.            CL**2
  4570     MOVE CR-LF-CANC-DT           TO  WS-CR-LF-CANC-DT-N.            CL**2
  4571     MOVE CR-LF-CANCEL-EXIT-DATE  TO  WS-CR-LF-CANCEL-EXIT-DATE-N.   CL**2
  4572     MOVE CR-LF-CLAIM-EXIT-DATE   TO  WS-CR-LF-CLAIM-EXIT-DATE-N.    CL**2
  4573     MOVE CR-AH-CANC-DT           TO  WS-CR-AH-CANC-DT-N.            CL**2
  4574     MOVE CR-AH-CANCEL-EXIT-DATE  TO                                 CL**2
  4575                                  WS-CR-AH-CANCEL-EXIT-DATE-N.       CL**2
  4576     MOVE CR-AH-SETTLEMENT-EXIT-DATE TO                           ELCCRTM1
  4577                                 WS-CR-AH-SETTLEMENT-EXIT-DATEN.     CL**2
  4578     MOVE CR-DTH-DT               TO  WS-CR-DTH-DT-N.                CL**2
  4579     MOVE CR-DTH-PAY-DT           TO  WS-CR-DTH-PAY-DT-N.            CL**2
  4580     MOVE CR-DIS-DT               TO  WS-CR-DIS-DT-N.                CL**2
  4581     MOVE CR-DIS-PAY-DT           TO  WS-CR-DIS-PAY-DT-N.            CL**2
  4582     MOVE CR-DIS-PTO-DT           TO  WS-CR-DIS-PTO-DT-N.            CL**2
  4583     PERFORM  VARYING COPY-NDX FROM 1 BY 1 UNTIL COPY-NDX > 5     ELCCRTM1
  4584           MOVE CR-DIS-INCUR-DT (COPY-NDX)   TO                   ELCCRTM1
  4585                                WS-CR-DIS-INCUR-DT-N (COPY-NDX)      CL**2
  4586     END-PERFORM.                                                 ELCCRTM1
  4587                                                                  ELCCRTM1
  4588
  4589     IF CR-AH-CANC-DT NOT = ZEROS
  4590        IF CR-AH-CANCEL-EXIT-DATE = ZEROS
  4591            MOVE CR-AH-CANC-DT TO CR-AH-CANCEL-EXIT-DATE
  4592                                  WS-CR-AH-CANCEL-EXIT-DATE.
  4593
  4594     IF CR-LF-CANC-DT NOT = ZEROS
  4595        IF CR-LF-CANCEL-EXIT-DATE = ZEROS
  4596            MOVE CR-LF-CANC-DT TO CR-LF-CANCEL-EXIT-DATE
  4597                                  WS-CR-LF-CANCEL-EXIT-DATE.
  4598
  4599     IF CR-ACCT-CONTROL = HIGH-VALUES
  4600         GO TO 2210-CONTINUE.
  4601
  4602     IF CR-POLICY-IS-DECLINED OR
  4603        CR-POLICY-IS-VOID
  4604            DISPLAY 'CERT BYPASSED - VOID OR DECLINED '
  4605                                                CR-FULL-CONTROL
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 103
* ECS150P.cbl
  4606            GO TO 2100-READ-CERT-FILE.
  4607
  4608     IF (cr-carrier = '9')
  4609        and (cr-state = 'NE')
  4610        and (cr-account = '0000015860')
  4611        and (cr-cert-no = '1098173790 ')
  4612            DISPLAY 'CERT BYPASSED - the big one '
  4613                                                CR-FULL-CONTROL
  4614            GO TO 2100-READ-CERT-FILE.
  4615
  4616     IF CR-LFTYP NOT = '00'
  4617         IF CR-LF-TERM = 0
  4618             IF CR-AHTYP = '00'
  4619                 DISPLAY 'CERT BYPASSED DUE TO INVALID TERM '
  4620                                                 CR-FULL-CONTROL
  4621                 GO TO 2100-READ-CERT-FILE.
  4622
  4623     IF CR-AHTYP NOT EQUAL '00'
  4624         IF CR-AH-TERM = 0
  4625             IF CR-LFTYP = '00'
  4626                 DISPLAY 'CERT BYPASSED DUE TO INVALID TERM '
  4627                                                 CR-FULL-CONTROL
  4628                 GO TO 2100-READ-CERT-FILE.
  4629
  4630 2210-CONTINUE.
  4631
  4632     IF CR-LFTYP NOT EQUAL '00'
  4633         IF CR-LF-TERM = 0
  4634             DISPLAY 'INVALID TERM ON LIFE CVG ' CR-FULL-CONTROL
  4635             MOVE '00'             TO  CR-LFTYP.
  4636
  4637     IF CR-AHTYP NOT EQUAL '00'
  4638         IF CR-AH-TERM = 0
  4639             DISPLAY 'INVALID TERM ON AH CVG ' CR-FULL-CONTROL
  4640             MOVE '00'             TO  CR-AHTYP.
  4641
  4642     IF SAVE-CONTROL-BREAKS = SPACES
  4643         MOVE CR-CARRIER         TO LAST-CARRIER
  4644         MOVE CR-GROUPING        TO LAST-GROUPING
  4645         MOVE CR-STATE           TO LAST-STATE
  4646         MOVE CR-ACCOUNT         TO LAST-ACCOUNT.
  4647
  4648 2200-MATCH-ACCT-TO-CERT.
  4649
  4650     IF CR-ACCT-CONTROL EQUAL HIGH-VALUES
  4651         GO TO 2300-LEVEL-BREAK-CHECK.
  4652
  4653     IF AM-CONTROL-A LESS THAN CR-ACCT-CONTROL
  4654         PERFORM 2210-ACCT-MAST-READ THRU 2210-EXIT
  4655         GO TO 2200-MATCH-ACCT-TO-CERT.
  4656
  4657     IF AM-CONTROL-A GREATER THAN CR-ACCT-CONTROL
  4658         GO TO 2205-ACCT-CERT-MISMATCH.
  4659
  4660     IF CR-DT  NOT LESS THAN AM-EXPIRE-DT
  4661         PERFORM 2210-ACCT-MAST-READ THRU 2210-EXIT
  4662         GO TO 2200-MATCH-ACCT-TO-CERT.
  4663
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 104
* ECS150P.cbl
  4664     IF CR-DT NOT LESS THAN AM-EFFECT-DT
  4665         GO TO 2300-LEVEL-BREAK-CHECK.
  4666
  4667 2205-ACCT-CERT-MISMATCH.
  4668     DISPLAY 'NO MATCHING ACCOUNT MASTER FOR CONTROL '
  4669              CR-ACCT-CONTROL.
  4670
  4671     IF DTE-CLIENT EQUAL 'FIA'
  4672                      OR 'CID'
  4673        GO TO 2100-READ-CERT-FILE
  4674     ELSE
  4675        MOVE '0302'              TO ABEND-CODE
  4676        GO TO ABEND-PGM.
  4677
  4678 2210-ACCT-MAST-READ.
  4679     READ ERACCTT AT END
  4680         MOVE HIGH-VALUES        TO ACCOUNT-MASTER.
  4681
* 4682     COPY ELCACCTI.
  4683******************************************************************04/14/98
  4684*                                                                *ELCACCTI
  4685*                            ELCACCTI                            *   LV003
  4686*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
  4687*                            VMOD=2.001                          *ELCACCTI
  4688*                                                                *ELCACCTI
  4689*   COPY FILE VARIABLES TO WORKING STORAGE                       *ELCACCTI
  4690*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCACCTI
  4691*                                                                *ELCACCTI
  4692*  NO  CID  MODS  IN  COPYBOOK  ELCACCTI                         *ELCACCTI
  4693*                                                                *ELCACCTI
  4694******************************************************************ELCACCTI
  4695     MOVE AM-EXPIRE-DT           TO  WS-AM-EXPIRE-DT-N.              CL**2
  4696     MOVE AM-VG-EXP-DATE         TO  WS-AM-VG-EXP-DATE-N.            CL**2
  4697     MOVE AM-EFFECT-DT           TO  WS-AM-EFFECT-DT-N.              CL**2
  4698     MOVE AM-PREV-EXP-DT         TO  WS-AM-PREV-EXP-DT-N.            CL**2
  4699     MOVE AM-PREV-EFF-DT         TO  WS-AM-PREV-EFF-DT-N             CL**2
  4700     MOVE AM-ANNIVERSARY-DATE    TO  WS-AM-ANNIVERSARY-DATE-N.       CL**2
  4701     MOVE AM-HI-CERT-DATE        TO  WS-AM-HI-CERT-DATE-N.           CL**2
  4702     MOVE AM-LO-CERT-DATE        TO  WS-AM-LO-CERT-DATE-N.           CL**2
  4703     MOVE AM-ENTRY-DATE          TO  WS-AM-ENTRY-DATE-N.             CL**2
  4704
  4705 2210-EXIT.
  4706     EXIT.
  4707
  4708 2300-LEVEL-BREAK-CHECK.
  4709
  4710     IF (LAST-CARRIER NOT = CR-CARRIER) OR
  4711        (LAST-GROUPING NOT = CR-GROUPING)
  4712         PERFORM 7400-STATE-BREAK THRU 7400-EXIT
  4713         PERFORM 7500-ACCOUNT-BREAK THRU 7500-EXIT
  4714         MOVE CR-ACCT-CONTROL   TO SAVE-CNTRL-GRP
  4715         GO TO 2400-VALIDATE-DATA.
  4716
  4717     IF LAST-STATE NOT EQUAL CR-STATE
  4718         PERFORM 7400-STATE-BREAK THRU 7400-EXIT
  4719         MOVE CR-ACCT-CONTROL    TO SAVE-CNTRL-GRP
  4720         GO TO 2400-VALIDATE-DATA.
  4721
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 105
* ECS150P.cbl
  4722     IF LAST-ACCOUNT NOT EQUAL CR-ACCOUNT
  4723         PERFORM 7500-ACCOUNT-BREAK THRU 7500-EXIT
  4724         MOVE CR-ACCT-CONTROL    TO SAVE-CNTRL-GRP.
  4725
  4726 2400-VALIDATE-DATA.
  4727     IF SAVE-CNTRL-GRP = HIGH-VALUES
  4728         GO TO 2000-EXIT.
  4729
  4730*    IF AM-EARN-METHOD-A NOT EQUAL SPACES AND ZEROS
  4731*        MOVE AM-EARN-METHOD-A   TO AH-EARN-METHOD
  4732*    ELSE
  4733     MOVE SPACES                 TO AH-EARN-METHOD
  4734
  4735     IF CR-IND-GRP NOT = '1' AND '2'
  4736         MOVE AM-IG              TO CR-IND-GRP.
  4737     IF CR-LFAMT-ALT NOT NUMERIC
  4738         MOVE ZEROS              TO CR-LFAMT-ALT.
  4739     IF CR-LFPRM-ALT NOT NUMERIC
  4740         MOVE ZEROS              TO CR-LFPRM-ALT.
  4741     IF CR-LFPRM-CALC NOT NUMERIC
  4742         MOVE ZEROES             TO CR-LFPRM-CALC.
  4743     IF CR-AHPRM-CALC NOT NUMERIC
  4744         MOVE ZEROES             TO CR-AHPRM-CALC.
  4745     IF CR-LFRFND-CALC NOT NUMERIC
  4746         MOVE ZEROES             TO CR-LFRFND-CALC.
  4747     IF CR-AHRFND-CALC NOT NUMERIC
  4748         MOVE ZEROES             TO CR-AHRFND-CALC.
  4749     IF CR-APR NOT NUMERIC
  4750         MOVE ZEROS              TO CR-APR.
  4751     IF CR-AGE NOT NUMERIC
  4752         MOVE ZEROS              TO CR-AGE.
  4753     IF CR-LIVES NOT NUMERIC
  4754         MOVE ZERO               TO CR-LIVES.
  4755     IF CR-SUM-CAN-CNT-ITD NOT NUMERIC
  4756         MOVE ZERO               TO CR-SUM-CAN-CNT-ITD.
  4757     IF CR-SUM-CAN-CNT-YTD NOT NUMERIC
  4758         MOVE ZERO               TO CR-SUM-CAN-CNT-YTD.
  4759     IF CR-DTHEXP-YTD NOT NUMERIC
  4760         MOVE ZERO               TO CR-DTHEXP-YTD.
  4761     IF CR-DTHAMT-YTD NOT NUMERIC
  4762         MOVE ZERO               TO CR-DTHAMT-YTD.
  4763     IF CR-DISAMT-YTD NOT NUMERIC
  4764         MOVE ZERO               TO CR-DISAMT-YTD.
  4765     IF CR-DISEXP-YTD NOT NUMERIC
  4766         MOVE ZERO               TO CR-DISEXP-YTD.
  4767
  4768     ADD CR-DTHEXP-YTD           TO CR-DTHAMT-YTD.
  4769     ADD CR-DISEXP-YTD           TO CR-DISAMT-YTD.
  4770
  4771     MOVE CR-DIS-CC              TO CR-DIS-INC-CC (1).
  4772     MOVE CR-DIS-YR              TO CR-DIS-INC-YR (1).
  4773     MOVE CR-DIS-MO              TO CR-DIS-INC-MO (1).
  4774     MOVE CR-DIS-DA              TO CR-DIS-INC-DA (1).
  4775     MOVE WS-CR-DIS-INCUR-DT(1)  TO CR-DIS-INCUR-DT (1).
  4776     MOVE CR-DISAMT-YTD          TO CR-INCUR-DISAMT (1).
  4777
  4778     MOVE ZEROS                  TO CR-INCUR-DISEXP (1)
  4779                                    CR-DIS-INCUR-DT (2)
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 106
* ECS150P.cbl
  4780                                    WS-CR-DIS-INCUR-DT(2)
  4781                                    CR-DIS-INCUR-DT (3)
  4782                                    WS-CR-DIS-INCUR-DT(3)
  4783                                    CR-DIS-INCUR-DT (4)
  4784                                    WS-CR-DIS-INCUR-DT(4)
  4785                                    CR-DIS-INCUR-DT (5)
  4786                                    WS-CR-DIS-INCUR-DT(5).
  4787
  4788 2500-CALC-1ST-INS.
  4789     MOVE 0                      TO RECORD-TYPE-SW.
  4790     PERFORM 4000-ACTIVITY-TOTALING THRU 4000-EXIT.
  4791
  4792 2600-CALC-REINSURANCE.
  4793     IF CR-REIN-TABLE = SPACES OR ZEROES
  4794         GO TO 2000-EXIT.
  4795
  4796     IF REINS-FILE-CLOSED
  4797         OPEN OUTPUT REINS-EXTRACT-1
  4798         MOVE 1                  TO REINS-FILE-SW.
  4799
  4800     PERFORM 6000-REINSURANCE-CALC THRU 6000-EXIT.
  4801     PERFORM 2700-REINS-EXTRACT THRU 2700-EXIT
  4802         VARYING SUB1 FROM +1 BY +1
  4803             UNTIL REIN-COMP (SUB1) = SPACES.
  4804     GO TO 2000-EXIT.
  4805
  4806 2700-REINS-EXTRACT.
  4807     IF REIN-LF-AH-FLGS (SUB1) = SPACES
  4808         GO TO 2700-EXIT.
  4809
  4810     IF REIN-REM-SW (SUB1) = 'Z'
  4811         GO TO 2700-EXIT.
  4812     perform varying sub3 from +1 by +1 until
  4813        (sub3 > +1500) or
  4814        (rein-comp (sub1) = rc2-rein-co (sub3))
  4815     end-perform
  4816     if sub3 > +1500
  4817        go to 2700-exit
  4818     else
  4819        if rc2-ecs152-rpt (sub3) = 'Y'
  4820           continue
  4821        else
  4822           go to 2700-exit
  4823        end-if
  4824     end-if
  4825
  4826
  4827     MOVE REIN-WORK-FLDS (SUB1)  TO RWF-FIELDS.
  4828     MOVE SAVE-REINS-CERT        TO RC-REC.
  4829     MOVE REIN-COMP (SUB1)       TO RC-COMP.
  4830     MOVE RC-AHTYP               TO CR-AHTYP.
  4831     MOVE RC-LFTYP               TO CR-LFTYP.
  4832     MOVE RC-PMT-FREQ            TO CR-PMT-FREQ.
  4833     MOVE RC-I-LIVES             TO CR-LIVES.
  4834     MOVE RC-C-LIVES-ITD         TO CR-SUM-CAN-CNT-ITD.
  4835     MOVE RC-C-LIVES-YTD         TO CR-SUM-CAN-CNT-YTD.
  4836     MOVE RC-AHRFND-YTD          TO CR-AHRFND-CALC.
  4837     MOVE RC-LFRFND-YTD          TO CR-LFRFND-CALC.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 107
* ECS150P.cbl
  4838     MOVE RC-LF-EXPIRE-DT        TO CR-LF-EXPIRE-DATE
  4839                                    WS-CR-LF-EXPIRE-DATE-N.
  4840     MOVE RC-AH-EXPIRE-DT        TO CR-AH-EXPIRE-DATE
  4841                                    WS-CR-AH-EXPIRE-DATE-N.
  4842     MOVE ZEROES                 TO RC-LFAMT   CR-LFAMT
  4843                                    RC-LFPRM   CR-LFPRM
  4844                                    cr-lfprm-alt
  4845                                    RC-AHAMT   CR-AHAMT
  4846                                    RC-AHPRM   CR-AHPRM
  4847                                    RC-LFRFND  CR-LFRFND
  4848                                    RC-AHRFND  CR-AHRFND
  4849                                    RC-DTHAMT  CR-DTHAMT-YTD
  4850                                    RC-DISAMT  CR-DISAMT-YTD
  4851                                    RC-CEDE-FACT.
  4852
  4853     IF REIN-LF-FLG (SUB1) = 'X'
  4854         MOVE RWF-LFAMT          TO RC-LFAMT   CR-LFAMT
  4855         MOVE RWF-LFPRM          TO RC-LFPRM   CR-LFPRM
  4856         MOVE RWF-LFRFND         TO RC-LFRFND  CR-LFRFND
  4857         MOVE RWF-LFCLM          TO RC-DTHAMT  CR-DTHAMT-YTD
  4858     ELSE
  4859         MOVE ZERO               TO RC-LFTYP  CR-LFTYP.
  4860
  4861     COMPUTE WS-TOTAL-FACE-AMT = RC-ORIG-LFAMT + RC-LFAMT-ALT.
  4862
  4863     IF (REIN-LF-FLG (SUB1) = 'X')  AND
  4864        (CLAS-I-EP (CLAS-INDEXL) = 'B')
  4865         COMPUTE RC-CEDE-FACT = CR-LFAMT / WS-TOTAL-FACE-AMT.
  4866
  4867     IF REIN-AH-FLG (SUB1) = 'X'
  4868         MOVE RWF-AHAMT          TO RC-AHAMT   CR-AHAMT
  4869         MOVE RWF-AHPRM          TO RC-AHPRM   CR-AHPRM
  4870         MOVE RWF-AHRFND         TO RC-AHRFND  CR-AHRFND
  4871         MOVE RWF-AHCLM          TO RC-DISAMT  CR-DISAMT-YTD
  4872     ELSE
  4873         MOVE ZERO               TO RC-AHTYP  CR-AHTYP.
  4874
  4875     ADD +1 TO REINS-REC-CNT.
  4876     MOVE 1                      TO REINSURANCE-FOUND.
  4877     WRITE RC-REC-1 FROM RC-REC.
  4878     .
  4879 2710-EVALUATE-REINS.
  4880     MOVE 1                      TO RECORD-TYPE-SW.
  4881     PERFORM 4000-ACTIVITY-TOTALING THRU 4000-EXIT.
  4882
  4883 2700-EXIT.
  4884     EXIT.
  4885
  4886 2000-EXIT.
  4887     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 108
* ECS150P.cbl
  4889 3000-EXTRACT-BC     SECTION 15.
  4890
  4891 3100-READ-REINS-EXTRACT.
  4892     READ REINS-EXTRACT-2 INTO RC-REC AT END
  4893         MOVE HIGH-VALUES TO RC-CONTROL
  4894         GO TO 2150-CONTROL-BREAKS.
  4895     MOVE SPACES                 TO CERTIFICATE-RECORD.
  4896     MOVE RC-CMCTL               TO CR-FULL-CONTROL.
  4897     MOVE RC-ENTRY-STATUS        TO CR-ENTRY-STATUS.
  4898     MOVE RC-LFTYP               TO CR-LFTYP.
  4899     MOVE RC-LF-TERM             TO CR-LF-TERM.
  4900     MOVE RC-LF-TERM-IN-DAYS     TO CR-LF-TERM-IN-DAYS.
  4901     MOVE RC-LF-CANCEL-STATUS    TO CR-LF-STATUS-AT-CANCEL.
  4902     MOVE RC-LF-CLAIM-STATUS     TO CR-LF-STATUS-AT-DEATH.
  4903     MOVE RC-LF-CURRENT-STATUS   TO CR-LF-CURRENT-STATUS.
  4904     MOVE RC-AHTYP               TO CR-AHTYP.
  4905     MOVE RC-AH-TERM             TO CR-AH-TERM.
  4906     MOVE RC-AH-CANCEL-STATUS    TO CR-AH-STATUS-AT-CANCEL.
  4907     MOVE RC-AH-CLAIM-STATUS     TO CR-AH-STATUS-AT-SETTLEMENT.
  4908     MOVE RC-AH-CURRENT-STATUS   TO CR-AH-CURRENT-STATUS.
  4909     MOVE RC-AHAMT               TO CR-AHAMT.
  4910     MOVE RC-LFAMT               TO CR-LFAMT.
  4911     MOVE RC-LFAMT-ALT           TO CR-LFAMT-ALT.
  4912     MOVE RC-LFPRM               TO CR-LFPRM.
  4913     MOVE RC-AHPRM               TO CR-AHPRM.
  4914     MOVE RC-LFRFND              TO CR-LFRFND.
  4915     MOVE RC-AHRFND              TO CR-AHRFND.
  4916     MOVE RC-DTHAMT              TO CR-DTHAMT-YTD.
  4917     MOVE RC-DISAMT              TO CR-DISAMT-YTD.
  4918     MOVE RC-IND-GRP             TO CR-IND-GRP.
  4919     MOVE RC-LF-CANCEL-STATUS    TO CR-LF-STATUS-AT-CANCEL.
  4920     MOVE RC-LF-CLAIM-STATUS     TO CR-LF-STATUS-AT-DEATH.
  4921     MOVE RC-AH-CANCEL-STATUS    TO CR-AH-STATUS-AT-CANCEL.
  4922     MOVE RC-AH-CLAIM-STATUS     TO CR-AH-STATUS-AT-SETTLEMENT.
  4923     MOVE RC-LF-CANC-DT          TO CR-LF-CANC-DT.
  4924     MOVE RC-AH-CANC-DT          TO CR-AH-CANC-DT.
  4925     MOVE RC-DIS-DT              TO CR-DIS-DT.
  4926     MOVE RC-ENT-DT              TO CR-ENTRY-DATE.
  4927     MOVE RC-LF-CANC-EXIT        TO CR-LF-CANCEL-EXIT-DATE.
  4928     MOVE RC-AH-CANC-EXIT        TO CR-AH-CANCEL-EXIT-DATE.
  4929     MOVE RC-LF-CLAIM-EXIT       TO CR-LF-CLAIM-EXIT-DATE.
  4930     MOVE RC-AH-CLAIM-EXIT       TO CR-AH-SETTLEMENT-EXIT-DATE.
  4931     MOVE RC-PMT-FREQ            TO CR-PMT-FREQ.
  4932     MOVE RC-APR                 TO CR-APR.
  4933     MOVE RC-LOAN-TERM           TO CR-LOAN-TERM.
  4934     MOVE RC-I-LIVES             TO CR-LIVES.
  4935     MOVE RC-C-LIVES-ITD         TO CR-SUM-CAN-CNT-ITD.
  4936     MOVE RC-C-LIVES-YTD         TO CR-SUM-CAN-CNT-YTD.
  4937     MOVE RC-AHRFND-YTD          TO CR-AHRFND-CALC.
  4938     MOVE RC-LFRFND-YTD          TO CR-LFRFND-CALC.
  4939     MOVE RC-LF-EXPIRE-DT        TO CR-LF-EXPIRE-DATE.
  4940     MOVE RC-AH-EXPIRE-DT        TO CR-AH-EXPIRE-DATE.
  4941     MOVE RC-LOAN-1ST-PMT-DT     TO CR-LOAN-1ST-PMT-DT.
  4942
* 4943     COPY ELCCRTM1.
  4944******************************************************************04/15/98
  4945*                                                                *ELCCRTM1
  4946*                                                                *ELCCRTM1
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 109
* ECS150P.cbl (/apps/prod/cid1p/copy/ELCCRTM1)
  4947*                            ELCCRTM1                            *   LV003
  4948*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
  4949*                            VMOD=2.001                          *ELCCRTM1
  4950*                                                                *ELCCRTM1
  4951*   COPY FILE VARIABLES TO WORKING STORAGE                       *ELCCRTM1
  4952*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCCRTM1
  4953*                                                                *ELCCRTM1
  4954******************************************************************ELCCRTM1
  4955     MOVE CR-DT                   TO  WS-CR-DT-N.                    CL**2
  4956     MOVE CR-LF-EXPIRE-DATE       TO  WS-CR-LF-EXPIRE-DATE-N.        CL**2
  4957     MOVE CR-AH-EXPIRE-DATE       TO  WS-CR-AH-EXPIRE-DATE-N.        CL**2
  4958     MOVE CR-ENTRY-DATE           TO  WS-CR-ENTRY-DATE-N.            CL**2
  4959     MOVE CR-LF-CANC-DT           TO  WS-CR-LF-CANC-DT-N.            CL**2
  4960     MOVE CR-LF-CANCEL-EXIT-DATE  TO  WS-CR-LF-CANCEL-EXIT-DATE-N.   CL**2
  4961     MOVE CR-LF-CLAIM-EXIT-DATE   TO  WS-CR-LF-CLAIM-EXIT-DATE-N.    CL**2
  4962     MOVE CR-AH-CANC-DT           TO  WS-CR-AH-CANC-DT-N.            CL**2
  4963     MOVE CR-AH-CANCEL-EXIT-DATE  TO                                 CL**2
  4964                                  WS-CR-AH-CANCEL-EXIT-DATE-N.       CL**2
  4965     MOVE CR-AH-SETTLEMENT-EXIT-DATE TO                           ELCCRTM1
  4966                                 WS-CR-AH-SETTLEMENT-EXIT-DATEN.     CL**2
  4967     MOVE CR-DTH-DT               TO  WS-CR-DTH-DT-N.                CL**2
  4968     MOVE CR-DTH-PAY-DT           TO  WS-CR-DTH-PAY-DT-N.            CL**2
  4969     MOVE CR-DIS-DT               TO  WS-CR-DIS-DT-N.                CL**2
  4970     MOVE CR-DIS-PAY-DT           TO  WS-CR-DIS-PAY-DT-N.            CL**2
  4971     MOVE CR-DIS-PTO-DT           TO  WS-CR-DIS-PTO-DT-N.            CL**2
  4972     PERFORM  VARYING COPY-NDX FROM 1 BY 1 UNTIL COPY-NDX > 5     ELCCRTM1
  4973           MOVE CR-DIS-INCUR-DT (COPY-NDX)   TO                   ELCCRTM1
  4974                                WS-CR-DIS-INCUR-DT-N (COPY-NDX)      CL**2
  4975     END-PERFORM.                                                 ELCCRTM1
  4976                                                                  ELCCRTM1
  4977
  4978 2150-CONTROL-BREAKS.
  4979     IF SAVE-CONTROL-BREAKS = SPACES
  4980         MOVE CR-ACCT-CONTROL    TO SAVE-CNTRL-GRP
  4981         MOVE RC-COMP            TO LAST-REINS-CO.
  4982
  4983     IF LAST-REINS-CO NOT = RC-COMP
  4984         PERFORM 7100-REINS-CO-BREAK THRU 7100-EXIT
  4985         GO TO 3200-CALC-FOR-REINSURANCE.
  4986
  4987     IF LAST-CARRIER NOT = CR-CARRIER
  4988         PERFORM 7200-CARRIER-BREAK THRU 7200-EXIT
  4989         GO TO 3200-CALC-FOR-REINSURANCE.
  4990
  4991     IF LAST-GROUPING NOT = CR-GROUPING
  4992         PERFORM 7300-COMPANY-BREAK THRU 7300-EXIT
  4993         GO TO 3200-CALC-FOR-REINSURANCE.
  4994
  4995     IF LAST-STATE NOT = CR-STATE
  4996         PERFORM 7400-STATE-BREAK THRU 7400-EXIT
  4997         GO TO 3200-CALC-FOR-REINSURANCE.
  4998
  4999     IF LAST-ACCOUNT NOT = CR-ACCOUNT
  5000         PERFORM 7500-ACCOUNT-BREAK THRU 7500-EXIT.
  5001
  5002 3200-CALC-FOR-REINSURANCE.
  5003     IF RC-CONTROL = HIGH-VALUES
  5004         GO TO 3000-EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 110
* ECS150P.cbl
  5005
  5006     MOVE CR-ACCT-CONTROL        TO SAVE-CNTRL-GRP.
  5007     MOVE RC-COMP                TO LAST-REINS-CO.
  5008     PERFORM 4000-ACTIVITY-TOTALING THRU 4000-EXIT.
  5009
  5010 3000-EXIT.
  5011     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 111
* ECS150P.cbl
  5013 4000-ACTIVITY-TOTALING  SECTION 25.
  5014
  5015 4100-ELIM-FUTURES.
  5016     MOVE  CR-ENTRY-DATE     TO  DC-GREG-DATE-CYMD.
  5017     MOVE 'L'                TO  DC-OPTION-CODE.
  5018     PERFORM 8500-DATE-CONVERT-ROUTINE THRU 8599-DATE-CONVERT-X.
  5019     IF NO-CONVERSION-ERROR
  5020         MOVE DC-BIN-DATE-1  TO  CERT-ENTRY-DATE
  5021     ELSE
  5022         MOVE CR-DT          TO  DC-GREG-DATE-CYMD
  5023         MOVE 'L'            TO  DC-OPTION-CODE
  5024         PERFORM 8500-DATE-CONVERT-ROUTINE THRU
  5025                                      8599-DATE-CONVERT-X
  5026         IF NO-CONVERSION-ERROR
  5027             MOVE DC-BIN-DATE-1  TO  CERT-ENTRY-DATE.
  5028
  5029     IF CERT-ENTRY-DATE GREATER THAN PERIOD-END
  5030         GO TO 4000-EXIT.
  5031
  5032     IF CR-ENTRY-STATUS = '9'
  5033         IF REINSURANCE-PASS OR REINSURANCE-REC
  5034             NEXT SENTENCE
  5035         ELSE
  5036             GO TO 4000-EXIT.
  5037
  5038 4110-FIND-CLAS-L-TYPE.
  5039     IF CR-LFTYP = ZERO
  5040         GO TO 4120-FIND-CLAS-A-TYPE.
  5041
  5042     MOVE CR-LFTYP               TO CLAS-LOOK.
  5043     MOVE CLAS-STARTL            TO CLAS-INDEXL.
  5044
  5045 4115-LIFE-LOOKUP.
  5046     IF CLAS-INDEXL IS GREATER THAN CLAS-MAXL
  5047         DISPLAY 'INVALID LIFE TYPE' CLAS-LOOK
  5048         MOVE '0401'             TO ABEND-CODE
  5049         GO TO ABEND-PGM.
  5050
  5051     IF CLAS-I-BEN (CLAS-INDEXL) NOT = CLAS-LOOK
  5052         ADD +1 TO CLAS-INDEXL
  5053         GO TO 4115-LIFE-LOOKUP.
  5054
  5055 4120-FIND-CLAS-A-TYPE.
  5056     IF CR-AHTYP = ZERO
  5057         GO TO 4130-FIND-CLAS-STATE-ABBR.
  5058     MOVE CR-AHTYP               TO CLAS-LOOK.
  5059     MOVE CLAS-STARTA            TO CLAS-INDEXA.
  5060
  5061 4125-AH-LOOKUP.
  5062     IF CLAS-INDEXA IS GREATER THAN CLAS-MAXA
  5063         DISPLAY 'INVALID AH TYPE' CLAS-LOOK
  5064         MOVE '0402'             TO ABEND-CODE
  5065         GO TO ABEND-PGM.
  5066
  5067     IF CLAS-I-BEN (CLAS-INDEXA) NOT = CLAS-LOOK
  5068         ADD +1 TO CLAS-INDEXA
  5069         GO TO 4125-AH-LOOKUP.
  5070
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 112
* ECS150P.cbl
  5071     MOVE CLAS-I-EP (CLAS-INDEXA) TO AH-EARN-METHOD.
  5072
  5073*    IF AM-EARN-METHOD-A NOT EQUAL SPACES AND ZEROS
  5074*        MOVE AM-EARN-METHOD-A TO AH-EARN-METHOD.
  5075
  5076 4130-FIND-CLAS-STATE-ABBR.
  5077     MOVE CLAS-STARTS TO CLAS-INDEXS.
  5078
  5079 4135-STATE-LOOK-UP.
  5080     IF CLAS-INDEXS IS GREATER THAN CLAS-MAXS
  5081         DISPLAY ' INVALID STATE CODE -' CR-STATE
  5082         MOVE '0301'             TO ABEND-CODE
  5083         GO TO ABEND-PGM.
  5084
  5085     IF STATE-SUB (CLAS-INDEXS) NOT = CR-STATE
  5086         ADD +1 TO CLAS-INDEXS
  5087         GO TO 4135-STATE-LOOK-UP.
  5088
  5089     IF (CR-LFTYP NOT = ZERO AND
  5090         CLAS-I-BAL (CLAS-INDEXL) = 'B')
  5091         OR
  5092        (CR-AHTYP NOT = ZERO AND
  5093         CLAS-I-BAL (CLAS-INDEXA) = 'B')
  5094          MOVE 1                 TO OB-SW
  5095     ELSE
  5096          MOVE 0                 TO OB-SW.
  5097
  5098     IF (CR-LFTYP NOT = ZERO AND
  5099         CLAS-I-BAL (CLAS-INDEXL) = 'Z')
  5100         OR
  5101        (CR-AHTYP NOT = ZERO AND
  5102         CLAS-I-BAL (CLAS-INDEXA) = 'Z')
  5103          MOVE 1                 TO SUMMARY-SW
  5104     ELSE
  5105          MOVE 0                 TO SUMMARY-SW.
  5106
  5107     IF CERT-ENTRY-DATE GREATER THAN PERIOD-START
  5108         MOVE 2                  TO EFFECTIVE-CONTROL
  5109     ELSE
  5110         MOVE 3                  TO EFFECTIVE-CONTROL.
  5111
  5112     MOVE ZEROS                  TO PRINT-SWITCHES.
  5113     MOVE ZEROS                  TO PRT-ISSUE-AMT-LF
  5114                                    PRT-CANC-AMT-LF
  5115                                    PRT-DEATH-AMT-LF
  5116                                    PRT-EXPIRY-AMT-LF
  5117                                    PRT-DECR-AMT-LF
  5118                                    PRT-INCR-AMT-LF
  5119                                    PRT-ISSUE-AMT-LF
  5120                                    PRT-CANC-AMT-LF
  5121                                    PRT-CLAIM-AMT-AH.
  5122     MOVE 1                      TO COUNT-WORK.
  5123
  5124     MOVE CR-DT                      TO DC-GREG-DATE-CYMD.
  5125     MOVE 'L'                        TO DC-OPTION-CODE.
  5126     PERFORM 8500-DATE-CONVERT-ROUTINE THRU 8599-DATE-CONVERT-X.
  5127     MOVE DC-BIN-DATE-1              TO CERT-EFFECT-DT.
  5128
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 113
* ECS150P.cbl
  5129     IF REINSURANCE-PASS OR REINSURANCE-REC
  5130         MOVE CR-LOAN-1ST-PMT-DT TO DC-GREG-DATE-1-YMD
  5131         MOVE ZEROS                  TO DC-ELAPSED-MONTHS
  5132                                        DC-ELAPSED-DAYS
  5133         MOVE '3' TO DC-OPTION-CODE
  5134         PERFORM 8500-DATE-CONVERT-ROUTINE THRU
  5135                 8599-DATE-CONVERT-X
  5136         MOVE DC-BIN-DATE-1 TO FIRST-PAY-DT
  5137         GO TO 4137-SKIP-CALC.
  5138
  5139     IF CR-LOAN-1ST-PMT-DT NOT NUMERIC
  5140         MOVE ZEROS                  TO CR-LOAN-1ST-PMT-DT.
  5141
  5142     MOVE LOW-VALUES             TO     FIRST-PAY-DT.
  5143
  5144     IF CR-LOAN-1ST-PMT-DT NOT = ZEROS
  5145         MOVE CR-LOAN-1ST-PMT-DT     TO DC-GREG-DATE-1-YMD
  5146         MOVE ZEROS                  TO DC-ELAPSED-MONTHS
  5147                                        DC-ELAPSED-DAYS
  5148         MOVE '3'                    TO DC-OPTION-CODE
  5149         PERFORM 8500-DATE-CONVERT-ROUTINE THRU
  5150                 8599-DATE-CONVERT-X
  5151         IF NO-CONVERSION-ERROR
  5152             MOVE DC-BIN-DATE-1      TO FIRST-PAY-DT
  5153         ELSE
  5154             MOVE ZEROS              TO CR-LOAN-1ST-PMT-DT.
  5155
  5156     IF FIRST-PAY-DT       LESS THAN  CERT-EFFECT-DT
  5157         MOVE ZEROS  TO  CR-LOAN-1ST-PMT-DT.
  5158
  5159     IF CR-LOAN-1ST-PMT-DT = ZEROS
  5160         MOVE CERT-EFFECT-DT         TO DC-BIN-DATE-1
  5161         MOVE +1                     TO DC-ELAPSED-MONTHS
  5162         MOVE ZEROS                  TO DC-ELAPSED-DAYS
  5163         MOVE '6'                    TO DC-OPTION-CODE
  5164         PERFORM 8500-DATE-CONVERT-ROUTINE THRU
  5165                 8599-DATE-CONVERT-X
  5166         MOVE DC-BIN-DATE-2          TO FIRST-PAY-DT
  5167         MOVE DC-GREG-DATE-1-YMD     TO CR-LOAN-1ST-PMT-DT.
  5168
  5169 4137-SKIP-CALC.
  5170
  5171     IF SUMMARY-REC
  5172         COMPUTE COUNT-WORK = CR-LIVES - CR-SUM-CAN-CNT-ITD.
  5173     IF OB-COVERAGE
  5174         MOVE ZERO               TO COUNT-WORK.
  5175
  5176     IF CR-ENTRY-STATUS = '3' OR '5'
  5177         MOVE ZERO               TO COUNT-WORK.
  5178
  5179     MOVE ZEROES                 TO DOLLAR-AMT
  5180                                    DECREASING-DOLLAR
  5181                                    TEXAS-REG-SW
  5182                                    NET-PAY-SW
  5183                                    NEW-IN-EFFECT
  5184                                    OLD-IN-EFFECT
  5185                                    SAVE-BGN-INFORCE
  5186                                    SAVE-END-INFORCE
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 114
* ECS150P.cbl
  5187                                    INFORCE-CNT-SW
  5188                                    CANCEL-SW
  5189                                    CLAIM-SW
  5190                                    PRINT-CNTRL.
  5191
  5192     IF DTE-CLIENT EQUAL 'HAN'
  5193        MOVE '2' TO CR-IND-GRP.
  5194
  5195     IF CR-IND-GRP = '2'
  5196         MOVE 2                  TO INS-TYPE-SW
  5197     ELSE
  5198         MOVE 1                  TO INS-TYPE-SW.
  5199
  5200     IF REINSURANCE-PASS
  5201         MOVE +5                 TO CL
  5202     ELSE
  5203         IF FIRST-INS-REC
  5204             MOVE +2             TO CL
  5205         ELSE
  5206             MOVE +4             TO CL.
  5207
  5208     IF CR-LFTYP = ZERO
  5209         GO TO 4900-PROCESS-DISABILITY.
  5210
  5211     IF CR-LF-CURRENT-STATUS = '4'
  5212         IF CR-LF-CANCEL-EXIT-DATE IS GREATER THAN ZEROS
  5213             MOVE '8'            TO  CR-LF-CURRENT-STATUS.
  5214
  5215     IF CR-LF-CURRENT-STATUS = '6' OR '7' OR '8'
  5216         NEXT SENTENCE
  5217     ELSE
  5218         IF (CR-DTHAMT-YTD IS GREATER THAN +0) OR
  5219            (CR-DTHAMT-YTD IS LESS THAN +0)
  5220             MOVE '7'            TO  CR-LF-CURRENT-STATUS.
  5221
  5222     IF CR-LF-CURRENT-STATUS NOT = 6 AND 7 AND 8
  5223         MOVE 0                  TO CERT-STATUS.
  5224     IF CR-LF-CURRENT-STATUS = 7
  5225         MOVE 2                  TO CERT-STATUS.
  5226     IF CR-LF-CURRENT-STATUS = 8
  5227         MOVE 1                  TO CERT-STATUS.
  5228     IF CR-LF-CURRENT-STATUS = 6
  5229         MOVE 3                  TO CERT-STATUS.
  5230
  5231     MOVE CERT-EFFECT-DT             TO CP-CERT-EFF-DT.
  5232     MOVE FIRST-PAY-DT               TO CP-FIRST-PAY-DATE.
  5233     MOVE SPACES                     TO CP-ACCT-FLD-5.
  5234     MOVE DTE-CLIENT                 TO CP-COMPANY-ID.
  5235     MOVE CR-LF-TERM                 TO CP-ORIGINAL-TERM.
  5236     MOVE DTE-REM-TRM                TO CP-REM-TERM-METHOD.
  5237     MOVE '3'                        TO CP-PROCESS-TYPE.
  5238     MOVE DTE-CLASIC-COMPANY-CD      TO CP-COMPANY-CD.
  5239     MOVE DTE-REM-TRM-CALC-OPTION    TO CP-REM-TRM-CALC-OPTION.
  5240
  5241     MOVE CLAS-I-RL-AH (CLAS-INDEXL) TO CP-BENEFIT-TYPE.
  5242     MOVE CLAS-I-BAL (CLAS-INDEXL)   TO CP-SPECIAL-CALC-CD.
  5243     MOVE CR-LF-TERM                 TO CP-ORIGINAL-TERM
  5244                                        CP-LOAN-TERM.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 115
* ECS150P.cbl
  5245
  5246     IF CLAS-I-EP (CLAS-INDEXL) = 'B' AND
  5247        CLAS-I-CALC-TYPE (CLAS-INDEXL) NOT = 'L'
  5248         ADD +1                      TO CP-ORIGINAL-TERM
  5249                                        CP-LOAN-TERM.
  5250
  5251     IF CP-TERM-IS-DAYS
  5252         MOVE CR-LF-TERM-IN-DAYS     TO CP-TERM-OR-EXT-DAYS
  5253     ELSE
  5254         MOVE ZEROS                  TO CP-TERM-OR-EXT-DAYS.
  5255
  5256     MOVE RUN-DATE-BIN       TO CP-VALUATION-DT.
  5257
  5258     PERFORM 4585-GET-REMAINING-TERM THRU 4585-EXIT.
  5259
  5260     IF CLAS-I-EP (CLAS-INDEXL) = 'B' AND
  5261        CLAS-I-CALC-TYPE (CLAS-INDEXL) NOT = 'L'
  5262         COMPUTE CP-REMAINING-TERM-1 = CP-REMAINING-TERM-1 - 1
  5263         COMPUTE CP-REMAINING-TERM-2 = CP-REMAINING-TERM-2 - 1.
  5264
  5265     MOVE CP-REMAINING-TERM-2  TO  SAVE-REM-TERM.
  5266
  5267     MOVE EP-DT-BIN          TO CP-VALUATION-DT.
  5268
  5269     PERFORM 4585-GET-REMAINING-TERM THRU 4585-EXIT.
  5270
  5271     MOVE ZEROS TO LF-BAL-REMTRM.
  5272     IF CLAS-I-EP (CLAS-INDEXL) = 'B' AND
  5273        CLAS-I-CALC-TYPE (CLAS-INDEXL) NOT = 'L'
  5274         MOVE CP-REMAINING-TERM-2 TO LF-BAL-REMTRM
  5275         COMPUTE CP-REMAINING-TERM-1 = CP-REMAINING-TERM-1 - 1
  5276         COMPUTE CP-REMAINING-TERM-2 = CP-REMAINING-TERM-2 - 1.
  5277
  5278     IF CP-REMAINING-TERM-2 GREATER THAN CR-LF-TERM
  5279         MOVE CR-LF-TERM TO CP-REMAINING-TERM-2
  5280                            CP-REMAINING-TERM-1.
  5281
  5282     MOVE CP-REMAINING-TERM-2 TO LF-REM-TRM.
  5283
  5284     MOVE CR-LF-EXPIRE-DATE TO DC-GREG-DATE-CYMD
  5285     MOVE 'L' TO DC-OPTION-CODE
  5286     PERFORM 8500-DATE-CONVERT-ROUTINE THRU
  5287             8599-DATE-CONVERT-X
  5288     MOVE DC-BIN-DATE-1 TO CERT-EXPIRE-DATE-O
  5289
  5290     IF REINSURANCE-PASS OR REINSURANCE-REC
  5291         MOVE CR-LF-EXPIRE-DATE TO DC-GREG-DATE-CYMD
  5292         MOVE 'L' TO DC-OPTION-CODE
  5293         PERFORM 8500-DATE-CONVERT-ROUTINE THRU
  5294                 8599-DATE-CONVERT-X
  5295         MOVE DC-BIN-DATE-1 TO CERT-EXPIRE-DATE
  5296         GO TO 4150-SKIP-CALC.
  5297
  5298     MOVE FIRST-PAY-DT            TO DC-BIN-DATE-1.
  5299
  5300     IF (CLAS-I-EP (CLAS-INDEXL) = 'B') AND
  5301        (CLAS-I-CALC-TYPE (CLAS-INDEXL) NOT = 'L')
  5302         MOVE CR-LF-TERM          TO DC-ELAPSED-MONTHS
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 116
* ECS150P.cbl
  5303     ELSE
  5304         COMPUTE DC-ELAPSED-MONTHS = CR-LF-TERM - +1.
  5305
  5306     MOVE '6'                     TO DC-OPTION-CODE.
  5307     PERFORM 8500-DATE-CONVERT-ROUTINE THRU
  5308             8599-DATE-CONVERT-X.
  5309     IF NO-CONVERSION-ERROR
  5310         MOVE DC-BIN-DATE-2        TO CERT-EXPIRE-DATE
  5311     ELSE
  5312         MOVE LOW-VALUES           TO CERT-EXPIRE-DATE.
  5313
  5314     IF (CERT-EXPIRE-DATE = LOW-VALUES)
  5315        OR (DTE-REM-TRM-CALC-OPTION = '1' OR '2')
  5316        MOVE CERT-EFFECT-DT          TO DC-BIN-DATE-1
  5317        MOVE CR-LF-TERM              TO DC-ELAPSED-MONTHS
  5318        MOVE ZEROS                   TO DC-ELAPSED-DAYS
  5319        MOVE '6'                     TO DC-OPTION-CODE
  5320        PERFORM 8500-DATE-CONVERT-ROUTINE THRU
  5321                8599-DATE-CONVERT-X
  5322        IF NO-CONVERSION-ERROR
  5323           MOVE DC-BIN-DATE-2        TO CERT-EXPIRE-DATE
  5324        ELSE
  5325           MOVE LOW-VALUES           TO CERT-EXPIRE-DATE.
  5326
  5327*    IF CLAS-I-EP (CLAS-INDEXL) = 'B' AND
  5328*       CLAS-I-CALC-TYPE (CLAS-INDEXL) NOT = 'L'
  5329*       MOVE CERT-EFFECT-DT          TO DC-BIN-DATE-1
  5330*       COMPUTE DC-ELAPSED-MONTHS = CR-LF-TERM + 1
  5331*       MOVE ZEROS                   TO DC-ELAPSED-DAYS
  5332*       MOVE '6'                     TO DC-OPTION-CODE
  5333*       PERFORM 8500-DATE-CONVERT-ROUTINE THRU
  5334*               8599-DATE-CONVERT-X
  5335*       IF NO-CONVERSION-ERROR
  5336*          MOVE DC-BIN-DATE-2        TO CERT-EXPIRE-DATE
  5337*       ELSE
  5338*          MOVE LOW-VALUES           TO CERT-EXPIRE-DATE.
  5339
  5340     IF CP-REMAINING-TERM-2  GREATER THAN ZEROS
  5341         IF CERT-EXPIRE-DATE LESS THAN PERIOD-END
  5342            MOVE CERT-EXPIRE-DATE-O
  5343                              TO CERT-EXPIRE-DATE.
  5344*            MOVE PERIOD-END  TO  CERT-EXPIRE-DATE.
  5345
  5346     MOVE CERT-EXPIRE-DATE TO DC-BIN-DATE-1.
  5347     MOVE ' '                TO  DC-OPTION-CODE.
  5348     PERFORM 8500-DATE-CONVERT-ROUTINE THRU 8599-DATE-CONVERT-X.
  5349     MOVE DC-GREG-DATE-CYMD  TO WS-CR-LF-EXPIRE-DATE-N
  5350                                CR-LF-EXPIRE-DATE.
  5351
  5352 4150-SKIP-CALC.
  5353
  5354     MOVE LOW-VALUES             TO LOW-EXIT-DATE.
  5355     MOVE CR-LF-DEX-CC           TO DC-ALPHA-CEN-N.
  5356     MOVE CR-LF-DEX-YR           TO DC-YMD-YEAR.
  5357     MOVE CR-LF-DEX-MO           TO DC-YMD-MONTH.
  5358     MOVE CR-LF-DEX-DA           TO DC-YMD-DAY.
  5359     MOVE '3'                TO  DC-OPTION-CODE.
  5360     PERFORM 8500-DATE-CONVERT-ROUTINE THRU 8599-DATE-CONVERT-X.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 117
* ECS150P.cbl
  5361     MOVE DC-BIN-DATE-1  TO  CLAIM-EXIT-DATE.
  5362
  5363     MOVE CR-LF-CANCEL-EXIT-DATE  TO DC-GREG-DATE-CYMD.
  5364     MOVE 'L'                TO  DC-OPTION-CODE.
  5365     PERFORM 8500-DATE-CONVERT-ROUTINE THRU 8599-DATE-CONVERT-X.
  5366     MOVE DC-BIN-DATE-1  TO  CANCEL-EXIT-DATE.
  5367
  5368     MOVE CR-LF-CANC-DT      TO DC-GREG-DATE-CYMD.
  5369     MOVE 'L'                TO  DC-OPTION-CODE.
  5370     PERFORM 8500-DATE-CONVERT-ROUTINE THRU 8599-DATE-CONVERT-X.
  5371     MOVE DC-BIN-DATE-1  TO  SUM-CANCEL-DATE.
  5372
  5373     IF CLAIM-EXIT-DATE = SPACES OR ZEROS
  5374         MOVE LOW-VALUES TO CLAIM-EXIT-DATE.
  5375
  5376     IF CANCEL-EXIT-DATE = SPACES OR ZEROS
  5377         MOVE LOW-VALUES TO CANCEL-EXIT-DATE.
  5378
  5379     IF CLAIM-EXIT-DATE = LOW-VALUES AND
  5380        CANCEL-EXIT-DATE = LOW-VALUES
  5381         GO TO 4300-SET-SUBSCRIPTS.
  5382
  5383     IF CLAIM-EXIT-DATE = LOW-VALUES
  5384         MOVE CANCEL-EXIT-DATE   TO LOW-EXIT-DATE
  5385         GO TO 4300-SET-SUBSCRIPTS.
  5386
  5387     IF CANCEL-EXIT-DATE = LOW-VALUES
  5388         MOVE CLAIM-EXIT-DATE    TO LOW-EXIT-DATE
  5389         GO TO 4300-SET-SUBSCRIPTS.
  5390
  5391     IF CLAIM-EXIT-DATE LESS THAN CANCEL-EXIT-DATE
  5392         MOVE CLAIM-EXIT-DATE    TO LOW-EXIT-DATE
  5393     ELSE
  5394         MOVE CANCEL-EXIT-DATE   TO LOW-EXIT-DATE.
  5395
  5396 4300-SET-SUBSCRIPTS.
  5397     IF (CLAS-I-RL-AH (CLAS-INDEXL) = 'L' OR 'P')
  5398         MOVE 1                  TO LIFE-INS-SW
  5399     ELSE
  5400         MOVE 2                  TO LIFE-INS-SW.
  5401
  5402     IF CR-LF-TERM LESS THAN +121
  5403         MOVE +2                 TO TG
  5404     ELSE
  5405         MOVE +3                 TO TG.
  5406
  5407     IF CR-LF-TERM LESS THAN +61
  5408         MOVE +1                 TO TG.
  5409     MOVE TG                     TO SAV-LF-TERM-CODE.
  5410
  5411 4410-INFORCE-PRIOR-PERIOD.
  5412     IF NOT EFFECTIVE-BOTH-PER
  5413         GO TO 4420-INFORCE-THIS-PERIOD.
  5414
  5415     IF CLAIM-EXIT-DATE NOT = LOW-VALUES  AND
  5416        CANCEL-EXIT-DATE NOT = LOW-VALUES
  5417         IF CLAIM-EXIT-DATE NOT GREATER THAN PERIOD-START AND
  5418            CANCEL-EXIT-DATE GREATER THAN PERIOD-START
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 118
* ECS150P.cbl
  5419             MOVE 1              TO CANCEL-SW
  5420             MOVE 0              TO COUNT-WORK
  5421             GO TO 4700-COMPUTE-CANCEL
  5422         ELSE
  5423             IF CANCEL-EXIT-DATE NOT GREATER THAN PERIOD-START
  5424             AND
  5425             CLAIM-EXIT-DATE GREATER THAN PERIOD-START
  5426              MOVE 1             TO CLAIM-SW
  5427              MOVE 0             TO COUNT-WORK
  5428              GO TO 4750-COMPUTE-CLAIM.
  5429
  5430     IF CERT-CLAIM  AND
  5431        LOW-EXIT-DATE = LOW-VALUES
  5432         GO TO 4415-CONTINUE.
  5433
  5434     IF CLAIM-OR-CANCEL AND
  5435        LOW-EXIT-DATE NOT GREATER THAN PERIOD-START AND
  5436            CR-DTHAMT-YTD NOT = ZERO
  5437                GO TO 4750-COMPUTE-CLAIM.
  5438
  5439     IF CLAIM-OR-CANCEL AND
  5440        LOW-EXIT-DATE NOT GREATER THAN PERIOD-START
  5441         GO TO 4900-PROCESS-DISABILITY.
  5442
  5443 4415-CONTINUE.
  5444
  5445     IF (CERT-EXPIRE-DATE NOT GREATER THAN PERIOD-START) AND
  5446        NOT CLAIM-OR-CANCEL
  5447            GO TO 4900-PROCESS-DISABILITY.
  5448
  5449     MOVE 1                      TO OLD-IN-EFFECT.
  5450
  5451     IF CERT-EXPIRE-DATE NOT GREATER THAN PERIOD-START
  5452         MOVE 0                  TO COUNT-WORK
  5453         GO TO 4420-INFORCE-THIS-PERIOD.
  5454
  5455     IF (CR-LFTYP = ZERO) OR
  5456        (CR-ENTRY-STATUS = '5') OR
  5457        (OB-COVERAGE)
  5458           MOVE ZERO             TO INFORCE-DOLLARS
  5459           GO TO 4420-INFORCE-THIS-PERIOD.
  5460
  5461     IF NOT SUMMARY-REC
  5462        NEXT SENTENCE
  5463      ELSE
  5464         IF (SUM-CANCEL-DATE GREATER PERIOD-START) OR
  5465            (CR-LFRFND = ZERO)
  5466             MOVE CR-LIVES       TO COUNT-WORK
  5467             MOVE CR-LFAMT       TO INFORCE-DOLLARS
  5468           ELSE
  5469             IF CR-LFPRM NOT GREATER CR-LFRFND
  5470                MOVE ZERO        TO INFORCE-DOLLARS
  5471                                    CR-LFPRM
  5472                                    CR-LFRFND
  5473              ELSE
  5474                COMPUTE TEMP-RESULT-L ROUNDED =
  5475                                     CR-LFRFND / CR-LFPRM
  5476                COMPUTE INFORCE-DOLLARS ROUNDED = CR-LFAMT -
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 119
* ECS150P.cbl
  5477                                    (CR-LFAMT * TEMP-RESULT-L).
  5478
  5479     PERFORM 8300-STARTING-INFORCE THRU 8300-EXIT.
  5480
  5481
  5482     IF DTE-CLIENT = 'HER'
  5483         MOVE CR-LFAMT TO INFORCE-DOLLARS
  5484         IF CLAS-I-EP (CLAS-INDEXL) = 'B'
  5485             ADD CR-LFAMT-ALT TO INFORCE-DOLLARS.
  5486
  5487     MOVE +1                     TO EG.
  5488     PERFORM 8400-ADD-TO-EXHIBIT THRU 8400-EXIT.
  5489
  5490     MOVE INFORCE-DOLLARS        TO SAVE-BGN-INFORCE.
  5491
  5492 4420-INFORCE-THIS-PERIOD.
  5493
  5494     IF CERT-CLAIM  AND
  5495        LOW-EXIT-DATE = LOW-VALUES
  5496         NEXT SENTENCE
  5497     ELSE
  5498        IF CLAIM-OR-CANCEL AND
  5499           LOW-EXIT-DATE NOT GREATER THAN PERIOD-END
  5500            GO TO 4500-COMPUTE-UNEARNED.
  5501
  5502     IF CERT-EXPIRE-DATE NOT GREATER THAN PERIOD-END
  5503         GO TO 4500-COMPUTE-UNEARNED.
  5504
  5505     MOVE 1                      TO NEW-IN-EFFECT.
  5506
  5507     IF NOT REINSURANCE-PASS
  5508         ADD +1 TO EXB-CNT.
  5509
  5510     IF (CR-LFTYP = ZERO) OR
  5511        (CR-ENTRY-STATUS = '5') OR
  5512        (OB-COVERAGE)
  5513           MOVE ZERO             TO INFORCE-DOLLARS
  5514           GO TO 4500-COMPUTE-UNEARNED.
  5515
  5516     IF SUMMARY-REC
  5517         COMPUTE COUNT-WORK = CR-LIVES - CR-SUM-CAN-CNT-ITD
  5518         IF CR-LFPRM NOT GREATER CR-LFRFND
  5519            MOVE ZERO            TO INFORCE-DOLLARS
  5520                                    CR-LFPRM
  5521                                    CR-LFRFND
  5522          ELSE
  5523           IF CR-LFRFND = ZERO
  5524             MOVE CR-LFAMT       TO INFORCE-DOLLARS
  5525           ELSE
  5526                COMPUTE TEMP-RESULT-L ROUNDED =
  5527                                     CR-LFRFND / CR-LFPRM
  5528                COMPUTE INFORCE-DOLLARS ROUNDED = CR-LFAMT -
  5529                                    (CR-LFAMT * TEMP-RESULT-L).
  5530
  5531     PERFORM 8350-ENDING-INFORCE THRU 8300-EXIT.
  5532
  5533     IF DTE-CLIENT = 'HER'
  5534         MOVE CR-LFAMT TO INFORCE-DOLLARS
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 120
* ECS150P.cbl
  5535         IF CLAS-I-EP (CLAS-INDEXL) = 'B'
  5536             ADD CR-LFAMT-ALT TO INFORCE-DOLLARS.
  5537
  5538     IF GROUP-INS
  5539         ADD COUNT-WORK TO GROUP-CNT (CL  TG  9)
  5540         ADD INFORCE-DOLLARS TO GROUP-AMT (CL  TG  9)
  5541     ELSE
  5542         ADD COUNT-WORK TO IND-CNT (CL  TG  9)
  5543         ADD INFORCE-DOLLARS TO IND-AMT (CL  TG  9).
  5544
  5545     MOVE 1                      TO INFORCE-CNT-SW.
  5546     MOVE INFORCE-DOLLARS        TO DECREASING-DOLLAR
  5547                                    SAVE-END-INFORCE.
  5548
  5549 4500-COMPUTE-UNEARNED.
  5550     IF CR-ENTRY-STATUS = ('3' OR '5')
  5551         GO TO 4600-COMPUTE-ISSUES.
  5552
  5553     IF OB-COVERAGE
  5554         GO TO 4600-COMPUTE-ISSUES.
  5555
  5556     MOVE CR-DT                      TO DC-GREG-DATE-CYMD.
  5557     MOVE 'L'                        TO DC-OPTION-CODE.
  5558     PERFORM 8500-DATE-CONVERT-ROUTINE THRU 8599-DATE-CONVERT-X.
  5559     MOVE DC-BIN-DATE-1              TO CP-CERT-EFF-DT.
  5560
  5561     IF CR-LOAN-1ST-PMT-DT NOT NUMERIC
  5562         MOVE ZEROS                  TO CR-LOAN-1ST-PMT-DT.
  5563
  5564     MOVE LOW-VALUES  TO  CP-FIRST-PAY-DATE.
  5565
  5566     IF CR-LOAN-1ST-PMT-DT NOT = ZEROS
  5567         MOVE CR-LOAN-1ST-PMT-DT     TO DC-GREG-DATE-1-YMD
  5568         MOVE ZEROS                  TO DC-ELAPSED-MONTHS
  5569                                        DC-ELAPSED-DAYS
  5570         MOVE '3'                    TO DC-OPTION-CODE
  5571         PERFORM 8500-DATE-CONVERT-ROUTINE THRU
  5572                 8599-DATE-CONVERT-X
  5573         IF NO-CONVERSION-ERROR
  5574             MOVE DC-BIN-DATE-1      TO CP-FIRST-PAY-DATE
  5575         ELSE
  5576             MOVE ZEROS              TO CR-LOAN-1ST-PMT-DT.
  5577
  5578     IF CP-FIRST-PAY-DATE LESS THAN  CP-CERT-EFF-DT
  5579         MOVE ZEROS  TO  CR-LOAN-1ST-PMT-DT.
  5580
  5581     IF CR-LOAN-1ST-PMT-DT = ZEROS
  5582         MOVE CP-CERT-EFF-DT         TO DC-BIN-DATE-1
  5583         MOVE +1                     TO DC-ELAPSED-MONTHS
  5584         MOVE ZEROS                  TO DC-ELAPSED-DAYS
  5585         MOVE '6'                    TO DC-OPTION-CODE
  5586         PERFORM 8500-DATE-CONVERT-ROUTINE THRU
  5587                 8599-DATE-CONVERT-X
  5588         MOVE DC-BIN-DATE-2          TO CP-FIRST-PAY-DATE
  5589         MOVE DC-GREG-DATE-1-YMD     TO CR-LOAN-1ST-PMT-DT.
  5590
  5591     IF ENTERED-PREV-PERIOD
  5592         MOVE RUN-DATE-BIN       TO CP-VALUATION-DT
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 121
* ECS150P.cbl
  5593         MOVE +1                 TO FACTOR-C
  5594         PERFORM 4550-UNEARNED-CALC THRU 4550-EXIT
  5595         MOVE UNEXPIRED-MONTHS   TO HOLD-PREV-UNEXP
  5596         MOVE EXPIRED-MONTHS     TO HOLD-PREV-EXP.
  5597
  5598     IF ENTERED-PREV-PERIOD
  5599         IF CERT-CANCELLED
  5600             IF CANCEL-EXIT-DATE IS NOT GREATER THAN PERIOD-END
  5601                 GO TO 4700-COMPUTE-CANCEL.
  5602
  5603     IF ENTERED-THIS-PERIOD
  5604         IF CERT-CANCELLED
  5605             IF CANCEL-EXIT-DATE IS NOT GREATER THAN PERIOD-END
  5606                 GO TO 4600-COMPUTE-ISSUES.
  5607
  5608     IF ENTERED-THIS-PERIOD
  5609         MOVE EP-DT-BIN          TO CP-VALUATION-DT
  5610         MOVE -1                 TO FACTOR-C
  5611         PERFORM 4550-UNEARNED-CALC THRU 4550-EXIT
  5612         MOVE UNEXPIRED-MONTHS   TO HOLD-END-UNEXP
  5613         MOVE EXPIRED-MONTHS     TO HOLD-END-EXP.
  5614
  5615     GO TO 4600-COMPUTE-ISSUES.
  5616
  5617 4550-UNEARNED-CALC.
  5618
  5619     MOVE SPACES                     TO CP-ACCT-FLD-5.
  5620     MOVE DTE-CLIENT                 TO CP-COMPANY-ID.
  5621     MOVE CR-LF-TERM                 TO CP-ORIGINAL-TERM.
  5622     MOVE DTE-REM-TRM                TO CP-REM-TERM-METHOD.
  5623     MOVE '3'                        TO CP-PROCESS-TYPE.
  5624     MOVE DTE-CLASIC-COMPANY-CD      TO CP-COMPANY-CD.
  5625     MOVE DTE-REM-TRM-CALC-OPTION    TO CP-REM-TRM-CALC-OPTION.
  5626     MOVE CLAS-I-RL-AH (CLAS-INDEXL) TO CP-BENEFIT-TYPE.
  5627     MOVE CLAS-I-BAL   (CLAS-INDEXL) TO CP-SPECIAL-CALC-CD.
  5628
  5629     IF (CLAS-I-EP (CLAS-INDEXL) = 'B') AND
  5630        (CLAS-I-CALC-TYPE (CLAS-INDEXL) NOT = 'L')
  5631         ADD +1                      TO CP-ORIGINAL-TERM
  5632                                        CP-LOAN-TERM.
  5633
  5634     IF CP-TERM-IS-DAYS
  5635         MOVE CR-LF-TERM-IN-DAYS     TO CP-TERM-OR-EXT-DAYS
  5636     ELSE
  5637         MOVE ZEROS                  TO CP-TERM-OR-EXT-DAYS.
  5638
  5639     PERFORM 4585-GET-REMAINING-TERM THRU 4585-EXIT.
  5640
  5641     IF NO-CP-ERROR
  5642         NEXT SENTENCE
  5643     ELSE
  5644         MOVE +0                     TO CP-REMAINING-TERM-1
  5645                                        CP-REMAINING-TERM-2.
  5646
  5647     IF (CLAS-I-EP (CLAS-INDEXL) = 'B') AND
  5648        (CLAS-I-CALC-TYPE (CLAS-INDEXL) NOT = 'L')
  5649         COMPUTE CP-REMAINING-TERM-1 = (CP-REMAINING-TERM-1 - +1).
  5650
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 122
* ECS150P.cbl
  5651     IF CP-REMAINING-TERM-1 IS NEGATIVE
  5652         MOVE ZEROS                  TO CP-REMAINING-TERM-1.
  5653     IF CP-REMAINING-TERM-2 IS NEGATIVE
  5654         MOVE ZEROS                  TO CP-REMAINING-TERM-2.
  5655
  5656     IF CP-REMAINING-TERM-1 = ZEROS
  5657         IF (CLAS-I-EP (CLAS-INDEXL) = 'B') AND
  5658            (CLAS-I-CALC-TYPE (CLAS-INDEXL) NOT = 'L') AND
  5659            (CP-REMAINING-TERM-2 IS GREATER THAN ZEROS)
  5660             NEXT SENTENCE
  5661         ELSE
  5662             GO TO 4550-EXIT.
  5663
  5664     MOVE CP-REMAINING-TERM-1        TO UNEXPIRED-MONTHS.
  5665     COMPUTE EXPIRED-MONTHS = CR-LF-TERM - UNEXPIRED-MONTHS.
  5666
  5667     IF CR-LFPRM NOT NUMERIC
  5668        MOVE +0 TO CR-LFPRM.
  5669
  5670     IF SUMMARY-REC
  5671         IF CR-LFRFND = +0
  5672             MOVE CR-LFPRM       TO CP-ORIGINAL-PREMIUM
  5673         ELSE
  5674             COMPUTE CP-ORIGINAL-PREMIUM ROUNDED =
  5675                     CR-LFPRM - CR-LFRFND
  5676     ELSE
  5677         MOVE CR-LFPRM           TO CP-ORIGINAL-PREMIUM.
  5678
  5679     IF CR-LFPRM-ALT NOT NUMERIC
  5680        MOVE +0 TO CR-LFPRM-ALT.
  5681     MOVE CR-LFPRM-ALT           TO CP-ALTERNATE-PREMIUM
  5682     IF CR-LF-TERM NOT NUMERIC
  5683        MOVE +0 TO CR-LF-TERM.
  5684     MOVE CR-LF-TERM             TO CP-ORIGINAL-TERM
  5685     MOVE UNEXPIRED-MONTHS       TO CP-REMAINING-TERM
  5686     MOVE CLAS-I-EP (CLAS-INDEXL)
  5687                                 TO CP-EARNING-METHOD
  5688     MOVE CLAS-I-RL-AH (CLAS-INDEXL)
  5689                                 TO CP-BENEFIT-TYPE
  5690     MOVE CLAS-I-CALC-TYPE (CLAS-INDEXL)
  5691                                 TO CP-SPECIAL-CALC-CD
  5692     MOVE CR-LFTYP               TO CP-BENEFIT-CD
  5693     MOVE LIFE-OVERRIDE-L1       TO CP-LIFE-OVERRIDE-CODE
  5694     PERFORM 4945-CALC-UNEARNED-PREMIUM THRU 4945-AH-EXIT.
  5695
  5696     IF CP-ERROR-OCCURED
  5697        GO TO 4575-ERROR-LF.
  5698
  5699     MOVE CP-STATE-U-PRM         TO UNEARNED-AMT-LF
  5700
  5701     IF CLAS-I-EP (CLAS-INDEXL) = 'T'
  5702         MOVE '1'                TO  TEXAS-REG-SW.
  5703
  5704     IF CLAS-I-EP (CLAS-INDEXL) = 'N'
  5705         MOVE '1'                TO  NET-PAY-SW.
  5706
  5707 4552-LIFE-EARNINGS-CONT.
  5708
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 123
* ECS150P.cbl
  5709     COMPUTE UNEARNED-AMT-LF = UNEARNED-AMT-LF * FACTOR-C.
  5710
  5711     IF LEVEL-LIFE
  5712         MOVE +2                 TO IY
  5713     ELSE
  5714         MOVE +1                 TO IY.
  5715
  5716     IF INDIVIDUAL-INS
  5717         ADD +5 TO IY.
  5718
  5719     ADD UNEARNED-AMT-LF TO EARN-PREM (CL  TG  IY).
  5720
  5721 4550-EXIT.
  5722     EXIT.
  5723
  5724 4575-ERROR-LF.
  5725
  5726     DISPLAY 'ERROR OCCURED IN LF UNEARNED ROUTINE'
  5727     DISPLAY 'CP RETURN CODE ...' CP-RETURN-CODE.
  5728     DISPLAY 'FULL CONTROL   ...' CR-FULL-CONTROL
  5729     GO TO ABEND-PGM.
  5730
  5731 4585-GET-REMAINING-TERM.
  5732
  5733     CALL 'ELRTRMX' USING CALCULATION-PASS-AREA.
  5734
  5735     IF DTE-CLIENT = 'NCL'
  5736         MOVE CP-REMAINING-TERM-1 TO CP-REMAINING-TERM-2.
  5737
  5738 4585-EXIT.
  5739     EXIT.
  5740
  5741 4600-COMPUTE-ISSUES.
  5742     IF EFFECTIVE-BOTH-PER
  5743         GO TO 4700-COMPUTE-CANCEL.
  5744
  5745     IF CR-ENTRY-STATUS = '3' OR '5'
  5746         GO TO 4700-COMPUTE-CANCEL.
  5747
  5748     MOVE '1'                    TO LF-ISSUE.
  5749     MOVE CR-LFAMT               TO PRT-ISSUE-AMT-LF.
  5750     MOVE CR-LFAMT               TO TEMP-RESULT.
  5751
  5752
  5753     IF LEVEL-LIFE
  5754         MOVE +2                 TO IY
  5755     ELSE
  5756         MOVE +1                 TO IY.
  5757
  5758     IF OB-COVERAGE
  5759         MOVE +3                 TO IY.
  5760
  5761 4610-TOT-LF-ISSUES.
  5762     MOVE TEMP-RESULT            TO INFORCE-DOLLARS.
  5763
  5764     MOVE +2                     TO EG.
  5765     IF SUMMARY-REC
  5766         MOVE CR-LIVES           TO COUNT-WORK.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 124
* ECS150P.cbl
  5767     PERFORM 8400-ADD-TO-EXHIBIT THRU 8400-EXIT.
  5768
  5769     MOVE 1                      TO INFORCE-CNT-SW.
  5770     ADD INFORCE-DOLLARS TO SAVE-BGN-INFORCE.
  5771
  5772     IF INDIVIDUAL-INS
  5773         ADD +5 TO IY.
  5774
  5775     IF CR-LFPRM-ALT NOT NUMERIC
  5776         MOVE ZEROS              TO  CR-LFPRM-ALT.
  5777
  5778     IF CLAS-I-EP (CLAS-INDEXL) = 'B'
  5779         ADD CR-LFPRM            TO  EARN-PREM  (CL  TG  IY)
  5780                                     ISSUE-PREM (CL  TG  IY)
  5781         ADD CR-LFPRM-ALT        TO  EARN-PREM  (CL  TG  IY)
  5782                                     ISSUE-PREM (CL  TG  IY)
  5783     ELSE
  5784         ADD CR-LFPRM            TO  EARN-PREM  (CL  TG  IY)
  5785                                     ISSUE-PREM (CL  TG  IY).
  5786
  5787     ADD TEMP-RESULT TO ISSUE-AMT (CL  TG  IY).
  5788     ADD COUNT-WORK TO ISSUE-CNT (CL  TG  IY).
  5789
  5790 4700-COMPUTE-CANCEL.
  5791*    NOTE *******************************************************
  5792*         *  EFFECTIVE AS OF VMOD 6.30 THE FOLLOWING TWO        *
  5793*         *  LINES OF CODE ARE DELETED. IF PRESENT, YOUR CANCEL *
  5794*         *  COUNT AND CLAIM COUNT WILL BE TOO LOW BECAUSE ONLY *
  5795*         *  POLICIES ISSUED IN CURRENT YEAR WILL BE COUNTED.   *
  5796*         *  THE AMOUNTS ARE CORRECT AND WILL BE UNAFFECTED.    *
  5797*         *******************************************************.
  5798*    IF INFORCE-CNT-SW NOT = 1
  5799*        MOVE 0 TO COUNT-WORK.
  5800******************************************************************
  5801     IF SUMMARY-REC AND
  5802        (SUM-CANCEL-DATE NOT GREATER PERIOD-END) AND
  5803        (SUM-CANCEL-DATE GREATER PERIOD-START) AND
  5804        (CR-SUM-CAN-CNT-YTD NOT = ZERO)
  5805         NEXT SENTENCE
  5806       ELSE
  5807        IF LUMP-SUM AND
  5808           (CLAIM-EXIT-DATE NOT GREATER PERIOD-END) AND
  5809           (CLAIM-EXIT-DATE NOT LESS PERIOD-START)
  5810            NEXT SENTENCE
  5811         ELSE
  5812            IF (CANCEL-EXIT-DATE = ZERO OR LOW-VALUES) OR
  5813               CANCEL-EXIT-DATE GREATER THAN PERIOD-END
  5814                GO TO 4750-COMPUTE-CLAIM.
  5815
  5816     SUBTRACT CR-CCYY FROM CR-LF-CNC-CCYY GIVING INTERIM-YR.
  5817*    SUBTRACT CR-YR FROM CR-LF-CNC-YR GIVING INTERIM-YR.
  5818     IF INTERIM-YR < 0
  5819        ADD 100 TO INTERIM-YR
  5820     END-IF.
  5821     COMPUTE TERM-WORK = (INTERIM-YR * 12)
  5822                        + (CR-LF-CNC-MO - CR-MO).
  5823     IF CR-LF-CNC-DA LESS THAN CR-DA
  5824         SUBTRACT 1 FROM TERM-WORK.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 125
* ECS150P.cbl
  5825
  5826     IF LUMP-SUM
  5827         MOVE '1'                TO LF-LUMP
  5828     ELSE
  5829         MOVE '1'                TO LF-CANC.
  5830
  5831     MULTIPLY CR-LFRFND BY -1 GIVING UNEARNED-AMT-LF.
  5832     MOVE '1'                    TO LF-CANC.
  5833     MOVE CR-LFRFND              TO PRT-CANC-AMT-LF.
  5834
  5835     IF LEVEL-LIFE
  5836         MOVE +2                 TO IY
  5837     ELSE
  5838         MOVE +1                 TO IY.
  5839
  5840     IF OB-COVERAGE
  5841         MOVE +3                 TO IY.
  5842
  5843     IF INDIVIDUAL-INS
  5844         ADD +5 TO IY.
  5845
  5846     ADD UNEARNED-AMT-LF TO EARN-PREM (CL  TG  IY).
  5847
  5848     IF SUMMARY-REC
  5849         GO TO 4703-SUM-CANC.
  5850
  5851     IF LEVEL-LIFE
  5852         MOVE CR-LFAMT           TO DOLLAR-AMT
  5853         GO TO 4705-LF-CANCEL-GO.
  5854
  5855     IF OB-COVERAGE
  5856         MOVE CR-LFAMT           TO DOLLAR-AMT
  5857         GO TO 4705-LF-CANCEL-GO.
  5858
  5859     IF TERM-WORK NOT POSITIVE
  5860         MOVE CR-LFAMT           TO DOLLAR-AMT
  5861         GO TO 4705-LF-CANCEL-GO.
  5862
  5863     IF TEXAS-CERT
  5864         GO TO 4701-TEX-CANC.
  5865
  5866     IF NET-PAY-CERT
  5867         GO TO 4702-NET-PAY-CANC.
  5868
  5869 4700-REG-CANCEL.
  5870     COMPUTE DOLLAR-AMT = CR-LFAMT - ((TERM-WORK / CR-LF-TERM)
  5871                             * CR-LFAMT).
  5872     GO TO 4705-LF-CANCEL-GO.
  5873
  5874 4701-TEX-CANC.
  5875     DIVIDE CR-LFAMT BY CR-LF-TERM
  5876         GIVING TEX-FACT-1.
  5877     DIVIDE TERM-WORK BY CR-PMT-FREQ
  5878         GIVING TEX-FACT-2
  5879             REMAINDER TEX-FACT-3.
  5880     COMPUTE DOLLAR-AMT =
  5881         (TEX-FACT-1 * (TEX-FACT-2 * CR-PMT-FREQ)).
  5882
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 126
* ECS150P.cbl
  5883     GO TO 4705-LF-CANCEL-GO.
  5884
  5885 4702-NET-PAY-CANC.
  5886
  5887     MOVE CR-DT                  TO  DC-GREG-DATE-CYMD.
  5888     MOVE 'L'                    TO  DC-OPTION-CODE.
  5889     PERFORM 8500-DATE-CONVERT-ROUTINE THRU 8599-DATE-CONVERT-X.
  5890     MOVE DC-BIN-DATE-1          TO  CP-CERT-EFF-DT.
  5891
  5892     IF CR-LOAN-1ST-PMT-DT NOT = ZEROS
  5893         MOVE CR-LOAN-1ST-PMT-DT TO  DC-GREG-DATE-1-YMD
  5894         MOVE '3'                TO  DC-OPTION-CODE
  5895         PERFORM 8500-DATE-CONVERT-ROUTINE THRU
  5896             8599-DATE-CONVERT-X
  5897         MOVE DC-BIN-DATE-1      TO  CP-FIRST-PAY-DATE
  5898     ELSE
  5899         MOVE CP-CERT-EFF-DT     TO  DC-BIN-DATE-1
  5900         MOVE +1                 TO  DC-ELAPSED-MONTHS
  5901         MOVE +0                 TO  DC-ELAPSED-DAYS
  5902         MOVE '6'                TO  DC-OPTION-CODE
  5903         PERFORM 8500-DATE-CONVERT-ROUTINE THRU
  5904             8599-DATE-CONVERT-X
  5905         MOVE DC-BIN-DATE-2      TO  CP-FIRST-PAY-DATE.
  5906
  5907     MOVE CR-LFAMT               TO  CP-ORIGINAL-BENEFIT.
  5908     MOVE CR-APR                 TO  CP-LOAN-APR.
  5909     MOVE CR-LF-TERM             TO  CP-ORIGINAL-TERM.
  5910     MOVE CR-LOAN-TERM           TO  CP-LOAN-TERM.
  5911     COMPUTE CP-REMAINING-TERM = CR-LF-TERM - TERM-WORK.
  5912     MOVE STATE-ABBR       (CLAS-INDEXS) TO  CP-STATE-STD-ABBRV.
  5913     MOVE CLAS-I-CALC-TYPE (CLAS-INDEXL) TO  CP-SPECIAL-CALC-CD.
  5914     MOVE CLAS-I-RL-AH     (CLAS-INDEXL) TO  CP-BENEFIT-TYPE.
  5915     MOVE CLAS-I-EP        (CLAS-INDEXL) TO  CP-EARNING-METHOD.
  5916
  5917     CALL 'ELRAMTX' USING CALCULATION-PASS-AREA.
  5918
  5919     IF SUMMARY-REC
  5920         COMPUTE DOLLAR-AMT ROUNDED = CP-REMAMT-FACTOR *
  5921                                      (TEMP-1 / +1000)
  5922         GO TO 4705-LF-CANCEL-GO.
  5923
  5924     IF CP-STATE-STD-ABBRV = 'NC'
  5925               AND
  5926*      DTE-CLIENT NOT = 'WDS'
  5927       (DTE-CLIENT NOT = 'WDS' AND 'CID')
  5928          IF CP-CERT-EFF-DT GREATER THAN WS-931231
  5929             MOVE CP-REMAINING-AMT
  5930                                  TO  DOLLAR-AMT
  5931             GO TO 4705-LF-CANCEL-GO.
  5932
  5933      COMPUTE DOLLAR-AMT ROUNDED = CP-REMAMT-FACTOR *
  5934                                      (CR-LFAMT / +1000).
  5935*    IF SUMMARY-REC
  5936*          COMPUTE DOLLAR-AMT ROUNDED =
  5937*                          CP-REMAMT-FACTOR * (TEMP-1 / +1000)
  5938*      ELSE
  5939*          COMPUTE DOLLAR-AMT ROUNDED =
  5940*                          CP-REMAMT-FACTOR * (CR-LFAMT / +1000).
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 127
* ECS150P.cbl
  5941
  5942     GO TO 4705-LF-CANCEL-GO.
  5943
  5944 4703-SUM-CANC.
  5945     IF CR-LFPRM NOT GREATER CR-LFRFND
  5946        MOVE ZERO                TO DOLLAR-AMT
  5947        GO TO 4705-LF-CANCEL-GO.
  5948
  5949     IF CR-LFRFND = ZERO
  5950        MOVE CR-LFAMT            TO TEMP-1
  5951      ELSE
  5952                COMPUTE TEMP-RESULT-L ROUNDED =
  5953                                     CR-LFRFND / CR-LFPRM
  5954                COMPUTE TEMP-1 ROUNDED = CR-LFAMT -
  5955                                    (CR-LFAMT * TEMP-RESULT-L).
  5956
  5957     IF NET-PAY-CERT
  5958         GO TO 4702-NET-PAY-CANC.
  5959
  5960     IF LEVEL-LIFE
  5961         MOVE TEMP-1             TO DOLLAR-AMT
  5962      ELSE
  5963         COMPUTE DOLLAR-AMT = TEMP-1 - ((TERM-WORK / CR-LF-TERM)
  5964                                                        * TEMP-1).
  5965
  5966 4705-LF-CANCEL-GO.
  5967     MOVE DOLLAR-AMT             TO DECREASING-DOLLAR.
  5968
  5969     IF DOLLAR-AMT NEGATIVE
  5970         MOVE ZERO               TO DOLLAR-AMT.
  5971
  5972 4710-TOT-LF-CANCEL.
  5973     MOVE +6                     TO EG.
  5974     MOVE DOLLAR-AMT             TO INFORCE-DOLLARS.
  5975     MOVE COUNT-WORK             TO COUNT-SAVE.
  5976
  5977     IF (CLAIM-EXIT-DATE NOT = ZERO AND LOW-VALUES) AND
  5978        (CLAIM-EXIT-DATE NOT GREATER PERIOD-END) AND
  5979        (CLAIM-EXIT-DATE GREATER PERIOD-START) AND
  5980        (NOT LUMP-SUM)
  5981         MOVE ZERO               TO COUNT-WORK
  5982         MOVE ZERO               TO DOLLAR-AMT INFORCE-DOLLARS.
  5983
  5984     IF SUMMARY-REC
  5985         MOVE CR-SUM-CAN-CNT-YTD TO COUNT-WORK.
  5986
  5987     IF NOT CURRENT-CANCEL-ONLY
  5988         PERFORM 8400-ADD-TO-EXHIBIT THRU 8400-EXIT
  5989         SUBTRACT INFORCE-DOLLARS FROM SAVE-BGN-INFORCE.
  5990
  5991     IF LEVEL-LIFE
  5992         MOVE +2                 TO IY
  5993     ELSE
  5994         MOVE +1                 TO IY.
  5995
  5996     IF OB-COVERAGE
  5997         MOVE +3                 TO IY.
  5998
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 128
* ECS150P.cbl
  5999     IF INDIVIDUAL-INS
  6000         ADD +5 TO IY.
  6001
  6002     IF CR-LF-STATUS-AT-CANCEL NOT = SPACES
  6003         ADD COUNT-WORK TO CANCEL-CNT (CL  TG  IY).
  6004
  6005     ADD CR-LFRFND TO CANCEL-PREM (CL  TG  IY).
  6006     IF NOT CURRENT-CANCEL-ONLY
  6007        ADD DOLLAR-AMT TO CANCEL-AMT (CL  TG  IY).
  6008
  6009     MOVE COUNT-SAVE             TO COUNT-WORK.
  6010
  6011 4730-TOT-AH-CANCEL.
  6012     IF LUMP-SUM
  6013         GO TO 4900-PROCESS-DISABILITY.
  6014
  6015     IF (CANCEL-EXIT-DATE NOT = ZERO AND LOW-VALUES) AND
  6016        (CANCEL-EXIT-DATE NOT GREATER PERIOD-END) AND
  6017        (CANCEL-EXIT-DATE GREATER PERIOD-START)
  6018          NEXT SENTENCE
  6019       ELSE
  6020         GO TO 4750-COMPUTE-CLAIM.
  6021
  6022     IF OB-COVERAGE
  6023         MOVE +5                 TO IY
  6024     ELSE
  6025         MOVE +4                 TO IY.
  6026
  6027     IF INDIVIDUAL-INS
  6028         ADD +5 TO IY.
  6029
  6030     IF SUMMARY-REC
  6031         MOVE CR-SUM-CAN-CNT-YTD TO COUNT-WORK.
  6032
  6033
  6034
  6035     IF CURRENT-CANCEL-ONLY
  6036         GO TO 4900-PROCESS-DISABILITY.
  6037     IF CLAIM-EXIT-DATE NOT = LOW-VALUES
  6038         GO TO 4750-COMPUTE-CLAIM.
  6039     IF CR-DTHAMT-YTD NOT = ZERO
  6040         GO TO 4750-COMPUTE-CLAIM.
  6041     IF CERT-ENTRY-DATE GREATER THAN PERIOD-START
  6042         GO TO 4820-COMPUTE-DECREASE.
  6043     IF CERT-EXPIRE-DATE NOT GREATER THAN PERIOD-START
  6044         GO TO 4800-COMPUTE-INCREASE.
  6045
  6046     GO TO 4820-COMPUTE-DECREASE.
  6047
  6048 4750-COMPUTE-CLAIM.
  6049     IF CR-LFTYP = ZERO
  6050         GO TO 4820-COMPUTE-DECREASE.
  6051
  6052     IF LUMP-SUM
  6053         GO TO 4820-COMPUTE-DECREASE.
  6054
  6055     IF CLAIM-EXIT-DATE GREATER THAN PERIOD-END
  6056         GO TO 4770-COMPUTE-EXPIRE.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 129
* ECS150P.cbl
  6057
  6058     IF (CLAIM-EXIT-DATE = ZERO OR LOW-VALUES OR SPACES) AND
  6059         CR-DTHAMT-YTD = ZERO
  6060             GO TO 4770-COMPUTE-EXPIRE.
  6061
  6062     MOVE CR-DTHAMT-YTD          TO DECREASING-DOLLAR.
  6063     MOVE CR-DTHAMT-YTD          TO PRT-DEATH-AMT-LF.
  6064     MOVE '1'                    TO LF-DEATH.
  6065
  6066     IF LEVEL-LIFE
  6067         MOVE +2                 TO IY
  6068     ELSE
  6069         MOVE +1                 TO IY.
  6070
  6071     IF OB-COVERAGE
  6072         MOVE +3                 TO IY.
  6073
  6074     IF INDIVIDUAL-INS
  6075         ADD +5 TO IY.
  6076
  6077     ADD COUNT-WORK TO CLAIM-CNT (CL  TG  IY).
  6078     ADD CR-DTHAMT-YTD TO CLAIM-AMT (CL TG IY).
  6079     MOVE CR-DTHAMT-YTD TO INFORCE-DOLLARS.
  6080
  6081     IF OB-COVERAGE
  6082         MOVE +5                 TO IY
  6083     ELSE
  6084         MOVE +4                 TO IY.
  6085
  6086     IF INDIVIDUAL-INS
  6087         ADD +5 TO IY.
  6088
  6089     MOVE +4                     TO EG.
  6090     PERFORM 8400-ADD-TO-EXHIBIT THRU 8400-EXIT
  6091
  6092     IF CURRENT-CLAIM-ONLY
  6093         GO TO 4900-PROCESS-DISABILITY.
  6094
  6095     IF OB-COVERAGE
  6096         GO TO 4770-COMPUTE-EXPIRE.
  6097
  6098     SUBTRACT INFORCE-DOLLARS FROM SAVE-BGN-INFORCE.
  6099
  6100     IF CERT-EXPIRE-DATE NOT GREATER THAN PERIOD-START AND
  6101        NOT LEVEL-LIFE
  6102         GO TO 4800-COMPUTE-INCREASE.
  6103
  6104     IF NOT LEVEL-LIFE
  6105         GO TO 4820-COMPUTE-DECREASE.
  6106
  6107     COMPUTE DOLLAR-AMT = CR-LFAMT - CR-DTHAMT-YTD.
  6108     MOVE '1'                    TO LF-DECR.
  6109     MOVE DOLLAR-AMT             TO PRT-DECR-AMT-LF.
  6110
  6111     IF GROUP-INS
  6112         ADD DOLLAR-AMT TO GROUP-AMT (CL  TG  7)
  6113         ADD DOLLAR-AMT TO GROUP-AMT (CL  TG  8)
  6114     ELSE
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 130
* ECS150P.cbl
  6115         ADD DOLLAR-AMT TO IND-AMT (CL  TG  7)
  6116         ADD DOLLAR-AMT TO IND-AMT (CL  TG  8).
  6117     SUBTRACT DOLLAR-AMT FROM SAVE-BGN-INFORCE.
  6118
  6119     IF CERT-EXPIRE-DATE GREATER THAN PERIOD-START
  6120         GO TO 4900-PROCESS-DISABILITY
  6121     ELSE
  6122         MOVE CR-LFAMT           TO DECREASING-DOLLAR
  6123         GO TO 4800-COMPUTE-INCREASE.
  6124
  6125 4770-COMPUTE-EXPIRE.
  6126     IF CR-ENTRY-STATUS = '3' OR '5'
  6127         GO TO 4900-PROCESS-DISABILITY.
  6128
  6129     IF CERT-EXPIRE-DATE GREATER THAN PERIOD-END
  6130         GO TO 4820-COMPUTE-DECREASE.
  6131
  6132     IF CR-LFTYP = ZERO
  6133         GO TO 4900-PROCESS-DISABILITY.
  6134
  6135     IF (CLAS-I-EP (CLAS-INDEXL) = 'B'  AND
  6136         CLAS-I-CALC-TYPE (CLAS-INDEXL) NOT = 'L'  AND
  6137         LF-BAL-REMTRM NOT GREATER THAN ZERO)
  6138                       OR
  6139        (CLAS-I-EP (CLAS-INDEXL) = 'B'  AND
  6140         CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'L'  AND
  6141         LF-REM-TRM NOT GREATER THAN ZERO)
  6142                       OR
  6143        (CLAS-I-EP (CLAS-INDEXL) NOT = 'B'  AND
  6144         LF-REM-TRM NOT GREATER ZERO)
  6145           NEXT SENTENCE
  6146         ELSE
  6147         GO TO 4900-PROCESS-DISABILITY.
  6148
  6149     IF SUMMARY-REC
  6150        COMPUTE COUNT-WORK = CR-LIVES - CR-SUM-CAN-CNT-ITD
  6151        IF CR-LFPRM NOT GREATER CR-LFRFND
  6152           MOVE ZERO TO INFORCE-DOLLARS
  6153         ELSE
  6154          IF CR-LFRFND = ZERO
  6155             MOVE CR-LFAMT TO INFORCE-DOLLARS
  6156           ELSE
  6157                COMPUTE TEMP-RESULT-L ROUNDED =
  6158                                     CR-LFRFND / CR-LFPRM
  6159                COMPUTE DOLLAR-AMT ROUNDED = CR-LFAMT -
  6160                                    (CR-LFAMT * TEMP-RESULT-L).
  6161
  6162     IF EFFECTIVE-BOTH-PER
  6163         PERFORM 8300-STARTING-INFORCE THRU 8300-EXIT
  6164         MOVE INFORCE-DOLLARS    TO DOLLAR-AMT
  6165     ELSE
  6166         MOVE CR-LFAMT           TO DOLLAR-AMT.
  6167
  6168     IF OB-COVERAGE AND CR-LFTYP NOT = ZERO
  6169         MOVE CR-LFAMT           TO DOLLAR-AMT.
  6170
  6171     MOVE '1'                    TO LF-EXPIRY.
  6172     MOVE DOLLAR-AMT             TO PRT-EXPIRY-AMT-LF.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 131
* ECS150P.cbl
  6173     MOVE DOLLAR-AMT             TO INFORCE-DOLLARS.
  6174     MOVE +5                     TO EG.
  6175     PERFORM 8400-ADD-TO-EXHIBIT THRU 8400-EXIT.
  6176
  6177     IF NOT OB-COVERAGE
  6178         SUBTRACT INFORCE-DOLLARS FROM SAVE-BGN-INFORCE.
  6179
  6180     GO TO 4900-PROCESS-DISABILITY.
  6181
  6182 4800-COMPUTE-INCREASE.
  6183     IF CR-ENTRY-STATUS = '3' OR '5'
  6184         GO TO 4900-PROCESS-DISABILITY.
  6185
  6186     IF NOT EFFECTIVE-BOTH-PER
  6187         GO TO 4900-PROCESS-DISABILITY.
  6188
  6189     IF CR-LFTYP = ZERO
  6190         GO TO 4900-PROCESS-DISABILITY.
  6191
  6192     IF OB-COVERAGE OR SUMMARY-REC
  6193         GO TO 4900-PROCESS-DISABILITY.
  6194
  6195     COMPUTE MINUS-AMT = DECREASING-DOLLAR * -1.
  6196     MOVE '1'                    TO LF-INCR.
  6197     MOVE MINUS-AMT              TO PRT-INCR-AMT-LF.
  6198
  6199     IF GROUP-INS
  6200         ADD MINUS-AMT TO GROUP-AMT (CL  TG  7)
  6201         ADD MINUS-AMT TO GROUP-AMT (CL  TG  8)
  6202     ELSE
  6203         ADD MINUS-AMT TO IND-AMT (CL  TG  7)
  6204         ADD MINUS-AMT TO IND-AMT (CL  TG  8).
  6205     ADD DECREASING-DOLLAR TO SAVE-BGN-INFORCE.
  6206
  6207     GO TO 4900-PROCESS-DISABILITY.
  6208
  6209 4820-COMPUTE-DECREASE.
  6210     IF CR-ENTRY-STATUS = '3' OR '5'
  6211         GO TO 4900-PROCESS-DISABILITY.
  6212
  6213     IF CR-LFTYP = ZERO
  6214         GO TO 4900-PROCESS-DISABILITY.
  6215
  6216     IF LEVEL-LIFE
  6217         GO TO 4900-PROCESS-DISABILITY.
  6218
  6219     IF OB-COVERAGE OR SUMMARY-REC
  6220         GO TO 4900-PROCESS-DISABILITY.
  6221
  6222     IF NOT EFFECTIVE-BOTH-PER
  6223         SUBTRACT DECREASING-DOLLAR FROM CR-LFAMT
  6224             GIVING DOLLAR-AMT.
  6225
  6226     IF EFFECTIVE-BOTH-PER
  6227         PERFORM 8300-STARTING-INFORCE THRU 8300-EXIT
  6228         MOVE INFORCE-DOLLARS    TO DOLLAR-AMT
  6229         SUBTRACT DECREASING-DOLLAR FROM DOLLAR-AMT.
  6230
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 132
* ECS150P.cbl
  6231     MOVE '1'                    TO LF-DECR.
  6232     MOVE DOLLAR-AMT             TO PRT-DECR-AMT-LF.
  6233
  6234     IF GROUP-INS
  6235         ADD DOLLAR-AMT TO GROUP-AMT (CL  TG  7)
  6236         ADD DOLLAR-AMT TO GROUP-AMT (CL  TG  8)
  6237     ELSE
  6238         ADD DOLLAR-AMT TO IND-AMT (CL  TG  7)
  6239         ADD DOLLAR-AMT TO IND-AMT (CL  TG  8).
  6240     SUBTRACT DOLLAR-AMT FROM SAVE-BGN-INFORCE.
  6241
  6242 4900-PROCESS-DISABILITY.
  6243
  6244     IF CR-AHTYP = ZERO
  6245         GO TO 4999-PRINT.
  6246
  6247     MOVE ZERO                   TO CANCEL-SW.
  6248     MOVE ZERO                   TO CLAIM-SW.
  6249
  6250     IF CR-AH-CURRENT-STATUS NOT = 6 AND 7 AND 8
  6251         MOVE 0                  TO CERT-STATUS.
  6252     IF CR-AH-CURRENT-STATUS = 7
  6253         MOVE 2                  TO CERT-STATUS.
  6254     IF CR-AH-CURRENT-STATUS = 8
  6255         MOVE 1                  TO CERT-STATUS.
  6256     IF CR-AH-CURRENT-STATUS = 6
  6257         MOVE 3                  TO CERT-STATUS.
  6258
  6259     MOVE CERT-EFFECT-DT             TO CP-CERT-EFF-DT.
  6260     MOVE FIRST-PAY-DT               TO CP-FIRST-PAY-DATE.
  6261     MOVE CR-AH-TERM                 TO CP-ORIGINAL-TERM.
  6262     MOVE CLAS-I-RL-AH (CLAS-INDEXL) TO CP-BENEFIT-TYPE.
  6263     MOVE CLAS-I-BAL (CLAS-INDEXL)   TO CP-SPECIAL-CALC-CD.
  6264     MOVE '3'                        TO CP-PROCESS-TYPE.
  6265     MOVE DTE-CLASIC-COMPANY-CD      TO CP-COMPANY-CD.
  6266     MOVE DTE-REM-TRM-CALC-OPTION    TO CP-REM-TRM-CALC-OPTION.
  6267     MOVE ZEROS TO  CP-TERM-OR-EXT-DAYS.
  6268
  6269 AH-REM-TERM.
  6270
  6271     PERFORM 4585-GET-REMAINING-TERM THRU 4585-EXIT.
  6272
  6273     MOVE CP-REMAINING-TERM-2 TO AH-REM-TRM.
  6274
  6275     IF REINSURANCE-PASS OR REINSURANCE-REC
  6276         MOVE CR-AH-EXPIRE-DATE TO DC-GREG-DATE-CYMD
  6277         MOVE 'L' TO DC-OPTION-CODE
  6278         PERFORM 8500-DATE-CONVERT-ROUTINE THRU
  6279                 8599-DATE-CONVERT-X
  6280         MOVE DC-BIN-DATE-1 TO CERT-EXPIRE-DATE
  6281         GO TO 4910-SKIP-CALC.
  6282
  6283     MOVE FIRST-PAY-DT            TO DC-BIN-DATE-1.
  6284     COMPUTE DC-ELAPSED-MONTHS = CR-AH-TERM - +1.
  6285     MOVE '6'                     TO DC-OPTION-CODE.
  6286     PERFORM 8500-DATE-CONVERT-ROUTINE THRU
  6287                 8599-DATE-CONVERT-X.
  6288     IF NO-CONVERSION-ERROR
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 133
* ECS150P.cbl
  6289         MOVE DC-BIN-DATE-2        TO CERT-EXPIRE-DATE
  6290     ELSE
  6291         MOVE LOW-VALUES           TO CERT-EXPIRE-DATE.
  6292
  6293     IF (CERT-EXPIRE-DATE = LOW-VALUES)     OR
  6294         (DTE-REM-TRM-CALC-OPTION = '1' OR '2')
  6295        MOVE CERT-EFFECT-DT          TO DC-BIN-DATE-1
  6296        MOVE CR-AH-TERM              TO DC-ELAPSED-MONTHS
  6297        MOVE ZEROS                   TO DC-ELAPSED-DAYS
  6298        MOVE '6'                     TO DC-OPTION-CODE
  6299        PERFORM 8500-DATE-CONVERT-ROUTINE THRU
  6300                8599-DATE-CONVERT-X
  6301        IF NO-CONVERSION-ERROR
  6302           MOVE DC-BIN-DATE-2        TO CERT-EXPIRE-DATE
  6303        ELSE
  6304           MOVE LOW-VALUES           TO CERT-EXPIRE-DATE.
  6305
  6306     IF CP-REMAINING-TERM-2 NOT GREATER THAN ZEROS
  6307         IF CERT-EXPIRE-DATE GREATER THAN PERIOD-END
  6308             MOVE PERIOD-END  TO  CERT-EXPIRE-DATE.
  6309
  6310     MOVE CERT-EXPIRE-DATE TO DC-BIN-DATE-1.
  6311     MOVE ' '                TO  DC-OPTION-CODE.
  6312     PERFORM 8500-DATE-CONVERT-ROUTINE THRU 8599-DATE-CONVERT-X.
  6313     MOVE DC-GREG-DATE-CYMD TO WS-CR-AH-EXPIRE-DATE
  6314                               CR-AH-EXPIRE-DATE.
  6315
  6316 4910-SKIP-CALC.
  6317
  6318     MOVE LOW-VALUES             TO LOW-EXIT-DATE.
  6319     MOVE CR-AH-SETTLEMENT-EXIT-DATE TO DC-GREG-DATE-CYMD.
  6320     MOVE 'L'                TO  DC-OPTION-CODE.
  6321     PERFORM 8500-DATE-CONVERT-ROUTINE THRU 8599-DATE-CONVERT-X.
  6322     MOVE DC-BIN-DATE-1  TO  CLAIM-EXIT-DATE.
  6323
  6324     MOVE CR-AH-CANCEL-EXIT-DATE  TO DC-GREG-DATE-CYMD.
  6325     MOVE 'L'                TO  DC-OPTION-CODE.
  6326     PERFORM 8500-DATE-CONVERT-ROUTINE THRU 8599-DATE-CONVERT-X.
  6327     MOVE DC-BIN-DATE-1  TO  CANCEL-EXIT-DATE.
  6328
  6329     MOVE CR-AH-CANC-DT      TO DC-GREG-DATE-CYMD.
  6330     MOVE 'L'                TO  DC-OPTION-CODE.
  6331     PERFORM 8500-DATE-CONVERT-ROUTINE THRU 8599-DATE-CONVERT-X.
  6332     MOVE DC-BIN-DATE-1  TO  SUM-CANCEL-DATE.
  6333
  6334     MOVE LOW-VALUES             TO LOW-EXIT-DATE.
  6335
  6336     IF CLAIM-EXIT-DATE = SPACES OR ZEROS
  6337         MOVE LOW-VALUES TO CLAIM-EXIT-DATE.
  6338
  6339     IF CANCEL-EXIT-DATE = SPACES OR ZEROS
  6340         MOVE LOW-VALUES TO CANCEL-EXIT-DATE.
  6341
  6342     IF CLAIM-EXIT-DATE = LOW-VALUES AND
  6343        CANCEL-EXIT-DATE = LOW-VALUES
  6344         GO TO 4920-SET-SUBSCRIPTS.
  6345
  6346     IF CLAIM-EXIT-DATE = LOW-VALUES
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 134
* ECS150P.cbl
  6347         MOVE CANCEL-EXIT-DATE   TO LOW-EXIT-DATE
  6348         GO TO 4920-SET-SUBSCRIPTS.
  6349
  6350     IF CANCEL-EXIT-DATE = LOW-VALUES
  6351         MOVE CLAIM-EXIT-DATE    TO LOW-EXIT-DATE
  6352         GO TO 4920-SET-SUBSCRIPTS.
  6353
  6354     IF CLAIM-EXIT-DATE LESS THAN CANCEL-EXIT-DATE
  6355         MOVE CLAIM-EXIT-DATE    TO LOW-EXIT-DATE
  6356     ELSE
  6357         MOVE CANCEL-EXIT-DATE   TO LOW-EXIT-DATE.
  6358
  6359 4920-SET-SUBSCRIPTS.
  6360
  6361     IF CR-AH-TERM LESS THAN +121
  6362         MOVE +2                 TO TG
  6363     ELSE
  6364         MOVE +3                 TO TG.
  6365
  6366     IF CR-AH-TERM LESS THAN +61
  6367         MOVE +1                 TO TG.
  6368
  6369     IF OB-COVERAGE
  6370         MOVE +5                 TO IY
  6371     ELSE
  6372         MOVE +4                 TO IY.
  6373
  6374     IF INDIVIDUAL-INS
  6375         ADD +5 TO IY.
  6376
  6377     IF NOT EFFECTIVE-BOTH-PER
  6378         GO TO 4925-CHECK-THIS-PER-ITEM.
  6379
  6380     IF CLAIM-EXIT-DATE NOT = LOW-VALUES AND
  6381        CANCEL-EXIT-DATE NOT = LOW-VALUES
  6382         IF CLAIM-EXIT-DATE NOT GREATER THAN PERIOD-START AND
  6383            CANCEL-EXIT-DATE GREATER THAN PERIOD-START
  6384             MOVE 1              TO CANCEL-SW
  6385             MOVE 0              TO COUNT-WORK
  6386             GO TO 4970-CHECK-CANCEL
  6387         ELSE
  6388             IF CANCEL-EXIT-DATE NOT GREATER THAN PERIOD-START
  6389             AND
  6390             CLAIM-EXIT-DATE GREATER THAN PERIOD-START
  6391              MOVE 1             TO CLAIM-SW
  6392              MOVE 0             TO COUNT-WORK
  6393              GO TO 4980-CHECK-CLAIM.
  6394
  6395     IF CLAIM-OR-CANCEL AND
  6396        LOW-EXIT-DATE NOT GREATER THAN PERIOD-START AND
  6397            CR-DISAMT-YTD NOT = ZERO
  6398                GO TO 4980-CHECK-CLAIM.
  6399
  6400     IF CLAIM-OR-CANCEL AND
  6401        LOW-EXIT-DATE NOT GREATER THAN PERIOD-START
  6402         GO TO 4999-PRINT.
  6403
  6404     IF (CERT-EXPIRE-DATE NOT GREATER THAN PERIOD-START) AND
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 135
* ECS150P.cbl
  6405        NOT CLAIM-OR-CANCEL
  6406            GO TO 4980-CHECK-CLAIM.
  6407
  6408     MOVE '1'                    TO OLD-IN-EFFECT.
  6409
  6410 4925-CHECK-THIS-PER-ITEM.
  6411
  6412     IF CLAIM-OR-CANCEL AND
  6413        LOW-EXIT-DATE NOT GREATER THAN PERIOD-END
  6414         GO TO 4930-COMPUTE-UNEARNED.
  6415
  6416     IF CERT-EXPIRE-DATE NOT GREATER THAN PERIOD-END
  6417         GO TO 4930-COMPUTE-UNEARNED.
  6418
  6419     MOVE 1                      TO NEW-IN-EFFECT.
  6420
  6421 4930-COMPUTE-UNEARNED.
  6422     IF CR-ENTRY-STATUS = ('3' OR '5')
  6423         GO TO 4950-CHECK-AH-ISSUE.
  6424
  6425     IF SUMMARY-REC
  6426         IF CR-AHPRM IS NOT GREATER THAN CR-AHRFND
  6427             MOVE ZERO           TO  CR-AHPRM
  6428                                     CR-AHRFND.
  6429     IF OB-COVERAGE
  6430         GO TO 4950-CHECK-AH-ISSUE.
  6431
  6432     MOVE CR-DT                      TO DC-GREG-DATE-CYMD.
  6433     MOVE 'L'                        TO DC-OPTION-CODE.
  6434     PERFORM 8500-DATE-CONVERT-ROUTINE THRU 8599-DATE-CONVERT-X.
  6435     MOVE DC-BIN-DATE-1              TO CP-CERT-EFF-DT.
  6436
  6437     IF CR-LOAN-1ST-PMT-DT NOT NUMERIC
  6438         MOVE ZEROS                  TO CR-LOAN-1ST-PMT-DT.
  6439
  6440     IF CR-LOAN-1ST-PMT-DT NOT = ZEROS
  6441         MOVE CR-LOAN-1ST-PMT-DT     TO DC-GREG-DATE-1-YMD
  6442         MOVE ZEROS                  TO DC-ELAPSED-MONTHS
  6443                                        DC-ELAPSED-DAYS
  6444         MOVE '3'                    TO DC-OPTION-CODE
  6445         PERFORM 8500-DATE-CONVERT-ROUTINE THRU
  6446                 8599-DATE-CONVERT-X
  6447         IF NO-CONVERSION-ERROR
  6448             MOVE DC-BIN-DATE-1      TO CP-FIRST-PAY-DATE
  6449         ELSE
  6450             MOVE ZEROS              TO CR-LOAN-1ST-PMT-DT.
  6451
  6452     IF CR-LOAN-1ST-PMT-DT = ZEROS
  6453         MOVE CP-CERT-EFF-DT         TO DC-BIN-DATE-1
  6454         MOVE +1                     TO DC-ELAPSED-MONTHS
  6455         MOVE ZEROS                  TO DC-ELAPSED-DAYS
  6456         MOVE '6'                    TO DC-OPTION-CODE
  6457         PERFORM 8500-DATE-CONVERT-ROUTINE THRU
  6458                 8599-DATE-CONVERT-X
  6459         MOVE DC-BIN-DATE-1          TO CP-FIRST-PAY-DATE.
  6460
  6461     IF ENTERED-PREV-PERIOD
  6462         MOVE RUN-DATE-BIN       TO CP-VALUATION-DT
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 136
* ECS150P.cbl
  6463         MOVE +1                 TO FACTOR-C
  6464         PERFORM 4940-UNEARNED-CALC THRU 4940-EXIT.
  6465
  6466     IF ENTERED-PREV-PERIOD
  6467         IF CERT-CANCELLED
  6468             IF CANCEL-EXIT-DATE IS NOT GREATER THAN PERIOD-END
  6469                 GO TO 4970-CHECK-CANCEL.
  6470
  6471     IF ENTERED-THIS-PERIOD
  6472         IF CERT-CANCELLED
  6473             IF CANCEL-EXIT-DATE IS NOT GREATER THAN PERIOD-END
  6474                 GO TO 4950-CHECK-AH-ISSUE.
  6475
  6476     IF ENTERED-THIS-PERIOD
  6477         MOVE EP-DT-BIN          TO CP-VALUATION-DT
  6478         MOVE -1                 TO FACTOR-C
  6479         PERFORM 4940-UNEARNED-CALC THRU 4940-EXIT.
  6480
  6481     GO TO 4950-CHECK-AH-ISSUE.
  6482
  6483 4940-UNEARNED-CALC.
  6484
  6485     MOVE SPACES                     TO CP-ACCT-FLD-5.
  6486     MOVE DTE-CLIENT                 TO CP-COMPANY-ID.
  6487     MOVE CR-AH-TERM                 TO CP-ORIGINAL-TERM.
  6488     MOVE DTE-REM-TRM                TO CP-REM-TERM-METHOD.
  6489     MOVE '3'                        TO CP-PROCESS-TYPE.
  6490     MOVE DTE-CLASIC-COMPANY-CD      TO CP-COMPANY-CD.
  6491     MOVE DTE-REM-TRM-CALC-OPTION    TO CP-REM-TRM-CALC-OPTION.
  6492
  6493 4940-GET-REMAINING-TERM.
  6494
  6495     PERFORM 4585-GET-REMAINING-TERM THRU 4585-EXIT.
  6496
  6497     MOVE CP-REMAINING-TERM-1        TO UNEXPIRED-MONTHS.
  6498     COMPUTE EXPIRED-MONTHS = CR-AH-TERM - UNEXPIRED-MONTHS.
  6499
  6500 4940-TERM-OK.
  6501     IF UNEXPIRED-MONTHS NOT GREATER ZERO
  6502         GO TO 4940-EXIT.
  6503
  6504     IF SUMMARY-REC
  6505         IF CR-AHRFND = +0
  6506             MOVE CR-AHPRM       TO CP-ORIGINAL-PREMIUM
  6507         ELSE
  6508             COMPUTE CP-ORIGINAL-PREMIUM ROUNDED =
  6509                 CR-AHPRM - CR-AHRFND
  6510     ELSE
  6511         MOVE CR-AHPRM           TO CP-ORIGINAL-PREMIUM.
  6512
  6513     MOVE CR-AH-TERM             TO CP-ORIGINAL-TERM
  6514     MOVE CR-AHAMT               TO CP-ORIGINAL-BENEFIT
  6515                                    CP-RATING-BENEFIT-AMT.
  6516     MOVE UNEXPIRED-MONTHS       TO CP-REMAINING-TERM
  6517
  6518     IF AH-EARN-METHOD = SPACES
  6519         MOVE CLAS-I-EP (CLAS-INDEXA) TO  CP-EARNING-METHOD
  6520     ELSE
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 137
* ECS150P.cbl
  6521         MOVE AH-EARN-METHOD          TO  CP-EARNING-METHOD.
  6522
  6523     MOVE CLAS-I-RL-AH (CLAS-INDEXA)
  6524                                 TO CP-BENEFIT-TYPE
  6525     MOVE ZEROS                  TO CP-ALTERNATE-PREMIUM
  6526     MOVE CLAS-I-CALC-TYPE (CLAS-INDEXA)
  6527                                 TO CP-SPECIAL-CALC-CD
  6528     MOVE AM-AH-DEVIATION        TO CP-DEVIATION-CODE
  6529     MOVE CR-AHTYP               TO CP-BENEFIT-CD
  6530     MOVE AH-OVERRIDE-L1         TO CP-AH-OVERRIDE-CODE
  6531
  6532     IF CR-PMT-EXTENSION-DAYS NOT NUMERIC
  6533        MOVE ZEROS               TO CP-TERM-OR-EXT-DAYS
  6534     ELSE
  6535        MOVE CR-PMT-EXTENSION-DAYS
  6536                                 TO CP-TERM-OR-EXT-DAYS.
  6537
  6538     PERFORM 4945-CALC-UNEARNED-PREMIUM THRU 4945-AH-EXIT.
  6539
  6540     IF CP-ERROR-OCCURED
  6541        GO TO 4945-ERROR-AH.
  6542
  6543     MOVE CP-STATE-U-PRM    TO UNEARNED-AMT-AH.
  6544
  6545     IF (STATE-ABBR (CLAS-INDEXS) = 'VA')      AND
  6546        (CR-AH-TERM GREATER THAN +61)  AND
  6547        (CR-DT GREATER THAN  19921231)
  6548          MOVE  'A'  TO  AH-EARN-METHOD.
  6549
  6550     IF (CLAS-I-CALC-TYPE (CLAS-INDEXA) NOT = 'B' AND 'Z') AND
  6551        (AH-EARN-METHOD = 'A' OR 'C')
  6552         PERFORM 8450-RE-RATE-ROUTINE THRU 8499-EXIT
  6553         IF (CP-ERROR-RATE-NOT-FOUND OR
  6554             CP-ERROR-RATE-IS-ZERO OR
  6555             CP-ERROR-IN-DATES)
  6556             NEXT SENTENCE
  6557         ELSE
  6558             COMPUTE UNEARNED-AMT-AH ROUNDED =
  6559              ((UNEXPIRED-MONTHS * CR-AHAMT) / +100) *
  6560                CP-PREMIUM-RATE.
  6561
  6562     COMPUTE UNEARNED-AMT-AH ROUNDED =
  6563                           UNEARNED-AMT-AH * FACTOR-C.
  6564
  6565     IF GROUP-INS
  6566         ADD UNEARNED-AMT-AH TO EARN-PREM (CL  TG  4)
  6567     ELSE
  6568         ADD UNEARNED-AMT-AH TO EARN-PREM (CL  TG  9).
  6569 4940-EXIT.
  6570     EXIT.
  6571
  6572 4945-CALC-UNEARNED-PREMIUM.
  6573
  6574     MOVE CR-DT TO DC-GREG-DATE-CYMD.
  6575     MOVE 'L' TO DC-OPTION-CODE.
  6576     PERFORM 8500-DATE-CONVERT-ROUTINE THRU
  6577                  8599-DATE-CONVERT-X.
  6578     MOVE DC-BIN-DATE-1 TO CP-CERT-EFF-DT
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 138
* ECS150P.cbl
  6579     MOVE DTE-R78 TO CP-R78-OPTION
  6580     MOVE SPACES TO CP-ACCT-FLD-5
  6581     MOVE DTE-CLIENT TO CP-COMPANY-ID
  6582     IF CR-AGE NOT NUMERIC
  6583        MOVE +0 TO CR-AGE.
  6584     MOVE CR-AGE TO CP-ISSUE-AGE
  6585     IF CR-APR NOT NUMERIC
  6586        MOVE +0 TO CR-APR.
  6587     MOVE CR-APR TO CP-LOAN-APR
  6588
  6589     IF CR-PMT-FREQ IS NOT NUMERIC
  6590         MOVE ZEROS              TO  CP-PAY-FREQUENCY
  6591     ELSE
  6592         MOVE CR-PMT-FREQ        TO  CP-PAY-FREQUENCY.
  6593
  6594     IF CR-LOAN-TERM NOT NUMERIC
  6595        MOVE +0 TO CR-LOAN-TERM.
  6596     MOVE CR-LOAN-TERM TO CP-LOAN-TERM
  6597     MOVE SPACES         TO CP-DOMICILE-STATE
  6598     MOVE CR-CARRIER TO CP-CARRIER
  6599     IF CR-RATING-CLASS NOT = SPACES AND ZERO
  6600        MOVE CR-RATING-CLASS TO CP-CLASS-CODE
  6601     ELSE
  6602        MOVE AM-CAL-TABLE TO CP-CLASS-CODE.
  6603
  6604     MOVE STATE-SUB (CLAS-INDEXS) TO CP-STATE
  6605     MOVE STATE-ABBR (CLAS-INDEXS) TO CP-STATE-STD-ABBRV
  6606     MOVE DTE-CLASIC-COMPANY-CD TO CP-COMPANY-CD
  6607
  6608     CALL 'ELUPRMX'  USING CALCULATION-PASS-AREA.
  6609
  6610 4945-AH-EXIT.
  6611     EXIT.
  6612
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 139
* ECS150P.cbl
  6614 4945-ERROR-AH.
  6615
  6616     DISPLAY 'ERROR OCCURED IN AH UNEARNED ROUTINE'
  6617     DISPLAY 'CP RETURN CODE ...' CP-RETURN-CODE.
  6618     GO TO ABEND-PGM.
  6619
  6620 4950-CHECK-AH-ISSUE.
  6621
  6622     IF EFFECTIVE-BOTH-PER
  6623         GO TO 4970-CHECK-CANCEL.
  6624
  6625     IF CR-ENTRY-STATUS = '3' OR '5'
  6626         GO TO 4970-CHECK-CANCEL.
  6627
  6628     IF SUMMARY-REC
  6629         MOVE CR-LIVES           TO COUNT-WORK.
  6630
  6631     MOVE '1'                    TO AH-ISSUE.
  6632     ADD COUNT-WORK TO ISSUE-CNT (CL  TG  IY).
  6633     ADD CR-AHPRM TO EARN-PREM (CL  TG  IY).
  6634     ADD CR-AHPRM TO ISSUE-PREM (CL  TG  IY).
  6635
  6636 4970-CHECK-CANCEL.
  6637     IF SUMMARY-REC AND
  6638        (SUM-CANCEL-DATE NOT GREATER PERIOD-END) AND
  6639        (SUM-CANCEL-DATE GREATER PERIOD-START) AND
  6640        (CR-SUM-CAN-CNT-YTD NOT = ZERO)
  6641         NEXT SENTENCE
  6642       ELSE
  6643        IF LUMP-SUM AND
  6644           (CLAIM-EXIT-DATE NOT GREATER PERIOD-END) AND
  6645           (CLAIM-EXIT-DATE NOT LESS PERIOD-START)
  6646            NEXT SENTENCE
  6647         ELSE
  6648            IF (CANCEL-EXIT-DATE = ZERO OR LOW-VALUES) OR
  6649               CANCEL-EXIT-DATE GREATER THAN PERIOD-END
  6650                GO TO 4980-CHECK-CLAIM.
  6651
  6652     MOVE '1'                TO AH-CANC.
  6653
  6654     MULTIPLY CR-AHRFND BY -1 GIVING UNEARNED-AMT-AH.
  6655     MOVE '1'                    TO AH-CANC.
  6656     MOVE CR-AHRFND              TO PRT-CANC-AMT-AH.
  6657     ADD UNEARNED-AMT-AH TO EARN-PREM (CL  TG  IY).
  6658
  6659     IF CR-AH-STATUS-AT-CANCEL NOT = SPACES
  6660         ADD COUNT-WORK TO     CANCEL-CNT (CL  TG  IY).
  6661
  6662     ADD CR-AHRFND TO     CANCEL-PREM (CL  TG  IY).
  6663
  6664 4980-CHECK-CLAIM.
  6665     IF CR-DISAMT-YTD = ZERO
  6666         GO TO 4999-PRINT.
  6667
  6668     MOVE '1'                    TO AH-CLAIM.
  6669     MOVE CR-DISAMT-YTD          TO PRT-CLAIM-AMT-AH.
  6670
  6671     MOVE CR-DIS-CC              TO WS-CR-DIS-CCYY(1:2).
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 140
* ECS150P.cbl
  6672     MOVE CR-DIS-YR              TO WS-CR-DIS-CCYY(3:2).
  6673     ADD COUNT-WORK    TO CLAIM-CNT (CL TG IY).
  6674     ADD CR-DISAMT-YTD TO CLAIM-AMT (CL TG IY).
  6675     COMPUTE TERM-WORK = (WS-CR-DIS-CCYY * 12) + CR-DIS-MO.
  6676
  6677     IF TERM-WORK LESS THAN PERIOD-START-9
  6678         ADD CR-DISAMT-YTD TO AH-PAID-LAST-YR (CL)
  6679     ELSE
  6680         ADD CR-DISAMT-YTD TO AH-PAID-THIS-YR (CL).
  6681
  6682     MULTIPLY CR-AHRFND BY -1 GIVING UNEARNED-AMT-AH.
  6683
  6684 4999-PRINT.
  6685
  6686     IF PRT-LF-ISSUE OR
  6687        PRT-AH-ISSUE
  6688         MOVE 'ISSUE'            TO DL-ACTIVITY
  6689         MOVE PRT-ISSUE-AMT-LF   TO DL-RSRV-AMT
  6690         PERFORM 5100-PRINT-DETAIL THRU 5100-EXIT.
  6691
  6692     IF PRT-LF-DECR
  6693         MOVE 'DECR '            TO DL-ACTIVITY
  6694         MOVE PRT-DECR-AMT-LF    TO DL-RSRV-AMT
  6695         PERFORM 5100-PRINT-DETAIL THRU 5100-EXIT.
  6696
  6697     IF PRT-LF-CANC AND
  6698        PRT-AH-CANC
  6699             MOVE '1'                TO LF-REFUND-SW
  6700             MOVE 'CANC '            TO DL-ACTIVITY
  6701             MOVE '1'                TO AH-REFUND-SW
  6702             ADD PRT-CANC-AMT-AH     TO PRT-CANC-AMT-LF
  6703             MOVE PRT-CANC-AMT-LF    TO DL-RSRV-AMT
  6704             PERFORM 5100-PRINT-DETAIL THRU 5100-EXIT
  6705             GO TO 4999-NEXT-PRINT.
  6706
  6707     IF PRT-LF-CANC
  6708             MOVE '1'                TO LF-REFUND-SW
  6709             MOVE 'CANC '            TO DL-ACTIVITY
  6710             MOVE PRT-CANC-AMT-LF    TO DL-RSRV-AMT
  6711             PERFORM 5100-PRINT-DETAIL THRU 5100-EXIT.
  6712
  6713     IF PRT-AH-CANC
  6714             MOVE '1'                TO AH-REFUND-SW
  6715             MOVE 'CANC '            TO DL-ACTIVITY
  6716             MOVE PRT-CANC-AMT-AH    TO DL-RSRV-AMT
  6717             PERFORM 5100-PRINT-DETAIL THRU 5100-EXIT.
  6718
  6719 4999-NEXT-PRINT.
  6720     IF PRT-LF-INCR
  6721         MOVE 'INCR '            TO DL-ACTIVITY
  6722         MOVE PRT-INCR-AMT-LF    TO DL-RSRV-AMT
  6723         PERFORM 5100-PRINT-DETAIL THRU 5100-EXIT.
  6724
  6725     IF PRT-LF-EXPIRY
  6726         MOVE 'EXP  '            TO DL-ACTIVITY
  6727         MOVE PRT-EXPIRY-AMT-LF   TO DL-RSRV-AMT
  6728         PERFORM 5100-PRINT-DETAIL THRU 5100-EXIT.
  6729
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 141
* ECS150P.cbl
  6730     IF PRT-LF-DEATH
  6731         MOVE 'DEATH'            TO DL-ACTIVITY
  6732         MOVE PRT-DEATH-AMT-LF   TO DL-RSRV-AMT
  6733         PERFORM 5100-PRINT-DETAIL THRU 5100-EXIT.
  6734
  6735     IF PRT-LF-LUMP
  6736         MOVE 'LUMP '            TO DL-ACTIVITY
  6737         MOVE PRT-CANC-AMT-LF    TO DL-RSRV-AMT
  6738         PERFORM 5100-PRINT-DETAIL THRU 5100-EXIT.
  6739
  6740     IF PRT-AH-CLAIM
  6741         MOVE 'DISAB'            TO DL-ACTIVITY
  6742         MOVE PRT-CLAIM-AMT-AH   TO DL-RSRV-AMT
  6743         PERFORM 5100-PRINT-DETAIL THRU 5100-EXIT.
  6744
  6745 4999-ADVN-TOTALS.
  6746
  6747     IF CR-LFTYP = ZERO
  6748         GO TO 4000-EXIT.
  6749
  6750     MOVE SAV-LF-TERM-CODE       TO TG.
  6751
  6752     COMPUTE GROUP-CNT (CL TG 3) =
  6753                            GROUP-CNT (CL TG 1)
  6754                          + GROUP-CNT (CL TG 2).
  6755     COMPUTE GROUP-AMT (CL TG 3) =
  6756                            GROUP-AMT (CL TG 1)
  6757                          + GROUP-AMT (CL TG 2).
  6758     COMPUTE GROUP-AMT (CL TG 8) =
  6759                            GROUP-AMT (CL TG 3)
  6760                          - GROUP-AMT (CL TG 9).
  6761     COMPUTE GROUP-AMT (CL TG 7) =
  6762                            GROUP-AMT (CL TG 8)
  6763                          - GROUP-AMT (CL TG 4)
  6764                          - GROUP-AMT (CL TG 5)
  6765                          - GROUP-AMT (CL TG 6).
  6766
  6767     COMPUTE GROUP-CNT (CL TG 5) =
  6768                            GROUP-CNT (CL TG 3)
  6769                          - GROUP-CNT (CL TG 9)
  6770                          - GROUP-CNT (CL TG 4)
  6771                          - GROUP-CNT (CL TG 6).
  6772
  6773     IF GROUP-CNT (CL TG 5) GREATER THAN ZEROS
  6774         COMPUTE GROUP-AMT (CL TG 5) =
  6775                            GROUP-AMT (CL TG 3)
  6776                          - GROUP-AMT (CL TG 9)
  6777                          - GROUP-AMT (CL TG 4)
  6778                          - GROUP-AMT (CL TG 6)
  6779                          - GROUP-AMT (CL TG 7).
  6780
  6781     IF GROUP-CNT (CL TG 5) LESS THAN ZERO
  6782         MOVE ZEROS TO GROUP-CNT (CL TG 5).
  6783
  6784     COMPUTE GROUP-CNT (CL TG 8) =
  6785                            GROUP-CNT (CL TG 4)
  6786                          + GROUP-CNT (CL TG 5)
  6787                          + GROUP-CNT (CL TG 6).
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 142
* ECS150P.cbl
  6788     COMPUTE IND-CNT (CL TG 3) =
  6789                            IND-CNT (CL TG 1)
  6790                          + IND-CNT (CL TG 2).
  6791     COMPUTE IND-AMT (CL TG 3) =
  6792                            IND-AMT (CL TG 1)
  6793                          + IND-AMT (CL TG 2).
  6794     COMPUTE IND-AMT (CL TG 8) =
  6795                            IND-AMT (CL TG 3)
  6796                          - IND-AMT (CL TG 9).
  6797     COMPUTE IND-AMT (CL TG 7) =
  6798                            IND-AMT (CL TG 8)
  6799                          - IND-AMT (CL TG 4)
  6800                          - IND-AMT (CL TG 5)
  6801                          - IND-AMT (CL TG 6).
  6802
  6803     COMPUTE IND-CNT (CL TG 5) =
  6804                            IND-CNT (CL TG 3)
  6805                          - IND-CNT (CL TG 9)
  6806                          - IND-CNT (CL TG 4)
  6807                          - IND-CNT (CL TG 6).
  6808     IF IND-CNT (CL TG 5) GREATER THAN ZEROS
  6809         COMPUTE IND-AMT (CL TG 5) =
  6810                            IND-AMT (CL TG 3)
  6811                          - IND-AMT (CL TG 9)
  6812                          - IND-AMT (CL TG 4)
  6813                          - IND-AMT (CL TG 6)
  6814                          - IND-AMT (CL TG 7).
  6815
  6816     IF IND-CNT (CL TG 5) LESS THAN ZERO
  6817         MOVE ZEROS TO IND-CNT (CL TG 5).
  6818
  6819     COMPUTE IND-CNT (CL TG 8) =
  6820                            IND-CNT (CL TG 4)
  6821                          + IND-CNT (CL TG 5)
  6822                          + IND-CNT (CL TG 6).
  6823 4000-EXIT.
  6824     EXIT.
  6825
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 143
* ECS150P.cbl
  6827 5000-PRINT-ROUTINES     SECTION 30.
  6828
  6829 5100-PRINT-DETAIL.
  6830     IF DTE-PGM-OPT NOT = 1
  6831         GO TO 5100-EXIT.
  6832
  6833     IF FIRST-INS-PASS AND REINSURANCE-REC
  6834         GO TO 5100-EXIT.
  6835
  6836     IF LINE-CNT GREATER THAN +53
  6837         PERFORM 5500-PRINT-HEADING THRU 5500-EXIT.
  6838
  6839     IF FIRST-DETAIL-DONE
  6840         MOVE DETAIL-LINE-1      TO P-DATA
  6841         MOVE SPACE              TO X
  6842         PERFORM 5900-PRINT
  6843         MOVE SPACES             TO DETAIL-LINE-1
  6844         ADD +1 TO LINE-CNT
  6845         GO TO 5100-EXIT.
  6846
  6847     MOVE CR-CERT                TO DL-CERT-NO.
  6848     MOVE CR-CERT-SFX            TO DL-CERT-SUFX.
  6849     MOVE CR-DA                  TO XDD OF FORMAT-DATE.
  6850     MOVE CR-MO                  TO XMM OF FORMAT-DATE.
  6851     MOVE CR-YR                  TO XYY OF FORMAT-DATE.
  6852     MOVE EDITED-DATE            TO DL-ISSUE-DT.
  6853     MOVE CR-AH-TERM             TO DL-AH-TERM.
  6854     MOVE CR-LF-TERM             TO DL-LF-TERM.
  6855
  6856     IF CR-IND-GRP = '2'
  6857         MOVE 'GP '              TO DL-TYPE
  6858     ELSE
  6859         MOVE 'IND'              TO DL-TYPE.
  6860
  6861     MOVE SPACE                  TO DL-PLAN.
  6862     MOVE CLAS-I-AB3 (CLAS-INDEXL)
  6863                                 TO DL-PLAN.
  6864     MOVE CR-LFAMT               TO DL-ORIG-AMT.
  6865
  6866     IF OB-COVERAGE OR SUMMARY-REC
  6867          MOVE CR-LFAMT          TO DL-ORIG-AMT.
  6868
  6869     IF PRT-LF-REFUND
  6870         MOVE CR-LFRFND          TO DL-LF-PREM
  6871     ELSE
  6872         MOVE CR-LFPRM           TO DL-LF-PREM.
  6873
  6874     IF PRT-AH-REFUND
  6875         MOVE CR-AHRFND          TO DL-AH-PREM
  6876     ELSE
  6877         MOVE CR-AHPRM           TO DL-AH-PREM.
  6878
  6879     MOVE SPACE                  TO X.
  6880     MOVE DETAIL-LINE-1          TO P-DATA.
  6881     PERFORM 5900-PRINT.
  6882     MOVE SPACES                 TO DETAIL-LINE-1.
  6883     MOVE 1                      TO PRINT-CNTRL.
  6884     ADD +1 TO LINE-CNT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 144
* ECS150P.cbl
  6885
  6886 5100-EXIT.
  6887     EXIT.
  6888
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 145
* ECS150P.cbl
  6890 5200-PRINT-SUMMARY-TOTALS    SECTION 40.
  6891     IF DTE-PGM-OPT NOT = 1
  6892         PERFORM 5500-PRINT-HEADING THRU 5500-EXIT
  6893     ELSE
  6894         IF LINE-CNT NOT LESS THAN +44
  6895             PERFORM 5500-PRINT-HEADING THRU 5500-EXIT.
  6896
  6897     ADD 60 TO LINE-CNT.
  6898     MOVE '    SUMMARY TOTALS   ' TO HL-MESSAGE.
  6899     MOVE HEAD-LINE-6            TO P-DATA.
  6900     MOVE '0'                    TO X.
  6901     PERFORM 5900-PRINT.
  6902
  6903     MOVE SPACE                  TO X.
  6904     MOVE HEAD-LINE-8A           TO P-DATA.
  6905     PERFORM 5900-PRINT.
  6906
  6907     MOVE HEAD-LINE-8B           TO P-DATA.
  6908     PERFORM 5900-PRINT.
  6909     MOVE HEAD-LINE-8C           TO P-DATA.
  6910     PERFORM 5900-PRINT.
  6911
  6912     IF REINSURANCE-PASS
  6913         MOVE +5                 TO CL
  6914     ELSE
  6915         MOVE +2                 TO CL.
  6916
  6917     PERFORM 5300-ADD-TERMS THRU 5300-EXIT
  6918         VARYING TG FROM +1 BY +1
  6919             UNTIL TG GREATER THAN +3.
  6920
  6921     MOVE 'GROUP   0-60    '     TO DL-DESCRIP.
  6922     MOVE 1                      TO TG.
  6923     MOVE 5                      TO IY.
  6924     PERFORM 5240-BUILD-SUMMARY.
  6925
  6926     MOVE 'GROUP   61-120  '     TO DL-DESCRIP.
  6927     MOVE 2                      TO TG.
  6928     PERFORM 5240-BUILD-SUMMARY.
  6929
  6930     MOVE 'GROUP   GTR 120 '     TO DL-DESCRIP.
  6931     MOVE 3                      TO TG
  6932     PERFORM 5240-BUILD-SUMMARY.
  6933
  6934     MOVE 1                      TO TG.
  6935     MOVE 10                     TO IY.
  6936     MOVE 'INDV    0-60    '     TO DL-DESCRIP.
  6937     PERFORM 5240-BUILD-SUMMARY
  6938
  6939     MOVE 2                      TO TG.
  6940     MOVE 'INDV    61-120  '     TO DL-DESCRIP.
  6941     PERFORM 5240-BUILD-SUMMARY.
  6942
  6943     MOVE 3                      TO TG.
  6944     MOVE 'INDV    GTR 120 '     TO DL-DESCRIP.
  6945     PERFORM 5240-BUILD-SUMMARY.
  6946
  6947 5200-EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 146
* ECS150P.cbl
  6948     EXIT.
  6949
  6950 5240-BUILD-SUMMARY.
  6951     MOVE ISSUE-CNT   (CL  TG  IY) TO DL-ISS-CNT.
  6952     MOVE ISSUE-AMT   (CL  TG  IY) TO DL-ISS-AMT.
  6953     MOVE ISSUE-PREM  (CL  TG  IY) TO DL-ISS-PRM.
  6954     MOVE CANCEL-CNT  (CL  TG  IY) TO DL-CAN-CNT.
  6955     MOVE CANCEL-AMT  (CL  TG  IY) TO DL-CAN-AMT.
  6956     MOVE CANCEL-PREM (CL  TG  IY) TO DL-CAN-PRM.
  6957     MOVE CLAIM-CNT   (CL  TG  IY) TO DL-CLM-CNT.
  6958     MOVE CLAIM-AMT   (CL  TG  IY) TO DL-CLM-AMT.
  6959     MOVE EARN-PREM   (CL  TG  IY) TO DL-EARN-AMT.
  6960     MOVE DETAIL-LINE-2            TO P-DATA.
  6961     PERFORM 5900-PRINT.
  6962
  6963 5300-ADD-TERMS.
  6964     MOVE +5                     TO LA.
  6965
  6966     PERFORM 5350-ADD-GRPS THRU 5350-EXIT
  6967         VARYING IY FROM 1 BY 1
  6968             UNTIL IY GREATER THAN +4.
  6969
  6970     MOVE +10 TO LA.
  6971
  6972     PERFORM 5350-ADD-GRPS THRU 5350-EXIT
  6973         VARYING IY FROM 6 BY 1
  6974             UNTIL IY GREATER THAN +9.
  6975
  6976 5300-EXIT.
  6977     EXIT.
  6978
  6979 5350-ADD-GRPS.
  6980     ADD CORRESPONDING INSURANCE-TYPES (CL  TG  IY) TO
  6981                       INSURANCE-TYPES (CL  TG  LA).
  6982
  6983 5350-EXIT.
  6984     EXIT.
  6985
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 147
* ECS150P.cbl
  6987 5500-PRINT-HEADING      SECTION 30.
  6988     MOVE 0                      TO LINE-CNT.
  6989     ADD +1 TO PAGE-CNT.
  6990     MOVE LAST-CARRIER           TO HL-CARRIER.
  6991     MOVE LAST-GROUPING          TO HL-COMPANY.
  6992     MOVE PAGE-CNT               TO HL-PAGENO.
  6993     MOVE LAST-ACCOUNT           TO HL-ACCOUNT.
  6994     MOVE LAST-REINS-CO          TO HL-REIN-CO.
  6995     MOVE LAST-STATE             TO STATE-L.
  6996
  6997 5510-STATE-LOOKUP.
* 6998                             COPY ECSSTLOK.
  6999******************************************************************07/10/97
  7000*                                                                *ECSSTLOK
  7001*                            ECSSTLOK                            *   LV001
  7002*                            VMOD=2.001                         * ECSSTLOK
  7003*                                                                *ECSSTLOK
  7004*  NO  CID  MODS  IN  COPYBOOK  ECSSTLOK                         *ECSSTLOK
  7005*                                                                *ECSSTLOK
  7006******************************************************************ECSSTLOK
  7007 STATE--START.                                                    ECSSTLOK
  7008     MOVE ZERO TO CLAS-INDEXS.                                    ECSSTLOK
  7009                                                                  ECSSTLOK
  7010 STATE--LOOP.                                                     ECSSTLOK
  7011     ADD 1 TO CLAS-INDEXS.                                        ECSSTLOK
  7012     IF CLAS-INDEXS IS GREATER THAN CLAS-MAXS                     ECSSTLOK
  7013         MOVE SPACE TO STATE-L                                    ECSSTLOK
  7014         GO TO STATE--EXIT.                                       ECSSTLOK
  7015                                                                  ECSSTLOK
  7016     IF STATE-L NOT = STATE-SUB (CLAS-INDEXS)                     ECSSTLOK
  7017         GO TO STATE--LOOP.                                       ECSSTLOK
  7018                                                                  ECSSTLOK
  7019 STATE--EXIT.                                                     ECSSTLOK
  7020     EXIT.
  7021******************************************************************ECSSTLOK
  7022
  7023     IF STATE-L = SPACE
  7024         MOVE SPACE              TO HL-STATE
  7025     ELSE
  7026         MOVE STATE-PIC (CLAS-INDEXS) TO HL-STATE.
  7027
  7028     MOVE '1'                    TO X.
  7029     MOVE HEAD-LINE-1            TO P-DATA.
  7030     PERFORM 5900-PRINT.
  7031
  7032     MOVE SPACE                  TO X.
  7033     MOVE HEAD-LINE-2            TO P-DATA.
  7034     PERFORM 5900-PRINT.
  7035
  7036     MOVE HEAD-LINE-3            TO P-DATA.
  7037     PERFORM 5900-PRINT.
  7038
  7039     MOVE HEAD-LINE-4            TO P-DATA.
  7040     PERFORM 5900-PRINT.
  7041
  7042     IF REINSURANCE-PASS
  7043         MOVE HEAD-LINE-5        TO P-DATA
  7044         PERFORM 5900-PRINT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 148
* ECS150P.cbl
  7045
  7046     IF DTE-PGM-OPT NOT = 1
  7047         MOVE ' NO DETAIL GENERATED ' TO HL-MESSAGE
  7048         MOVE HEAD-LINE-6        TO P-DATA
  7049         PERFORM 5900-PRINT
  7050     ELSE
  7051         MOVE '0'                TO X
  7052         MOVE HEAD-LINE-7A       TO P-DATA
  7053         PERFORM 5900-PRINT
  7054         MOVE SPACE              TO X
  7055         MOVE HEAD-LINE-7B       TO P-DATA
  7056         PERFORM 5900-PRINT.
  7057
  7058 5500-EXIT.
  7059     EXIT.
  7060
  7061 5900-PRINT.
* 7062                             COPY ELCPRT2.
  7063******************************************************************04/15/98
  7064*                                                                *ELCPRT2
  7065*                                                                *ELCPRT2
  7066*                            ELCPRT2                             *   LV005
  7067*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**5
  7068*                            VMOD=2.002                          *   CL**5
  7069*                                                                *   CL**4
  7070******************************************************************   CL**4
  7071                                                                     CL**4
  7072     IF DTE-FICH NOT = SPACE AND                                     CL**4
  7073        FICH-OPEN    = SPACE                                         CL**4
  7074         MOVE 'X'                TO  FICH-OPEN                       CL**4
  7075         OPEN OUTPUT FICH.                                           CL**4
  7076                                                                     CL**4
  7077     IF DTE-FICH NOT = SPACE                                         CL**4
  7078         MOVE X                  TO  P-CTL                           CL**4
  7079         WRITE FICH-REC FROM PRT.                                    CL**4
  7080                                                                     CL**4
  7081     IF DTE-FICH = SPACE OR '2'                                      CL**4
  7082       MOVE X                    TO  P-CTL                           CL**4
  7083       IF P-CTL = ' '                                                CL**4
  7084         WRITE PRT AFTER ADVANCING 1 LINE                            CL**4
  7085       ELSE                                                          CL**4
  7086         IF P-CTL = '0'                                              CL**4
  7087           WRITE PRT AFTER ADVANCING 2 LINES                         CL**4
  7088         ELSE                                                        CL**4
  7089           IF P-CTL = '-'                                            CL**4
  7090             WRITE PRT AFTER ADVANCING 3 LINES                       CL**4
  7091           ELSE                                                      CL**4
  7092             WRITE PRT AFTER ADVANCING PAGE.                         CL**4
  7093                                                                     CL**4
  7094******************************************************************   CL**4
  7095
  7096 5900-EXIT.
  7097     EXIT.
  7098
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 149
* ECS150P.cbl
  7100 6000-REINSURANCE-CALC   SECTION 35.
  7101     IF CR-REIN-TABLE = SPACES OR ZEROS
  7102         GO TO 6000-EXIT.
  7103
  7104     PERFORM CLEAR-REIN-HOLD THRU CLEAR-REIN-HOLD-X.
  7105     MOVE CR-REIN-TABLE          TO REIN-SRCH.
  7106     PERFORM RR-READ-REIN THRU RR-READ-REIN-X.
  7107
  7108 REINSURE-ROUTINE-GET-CALC.
* 7109                             COPY ECSRTPFM.
  7110******************************************************************07/10/97
  7111*                                                                *ECSRTPFM
  7112*                            ECSRTPFM                            *   LV001
  7113*                            VMOD=2.002                          *ECSRTPFM
  7114*                                                                *ECSRTPFM
  7115******************************************************************ECSRTPFM
  7116                                                                  ECSRTPFM
  7117     IF    CR-LFAMT  NUMERIC                                      00000072
  7118           NEXT SENTENCE                                          00000073
  7119        ELSE                                                      00000074
  7120           MOVE ZEROS TO CR-LFAMT.                                00000075
  7121                                                                  00000076
  7122     IF    CR-LFAMT-ALT  NUMERIC                                  00000077
  7123           NEXT SENTENCE                                          00000078
  7124        ELSE                                                      00000079
  7125           MOVE ZEROS TO CR-LFAMT-ALT.                            00000080
  7126                                                                  00000081
  7127                                                                  00000082
  7128     IF    CR-LFPRM  NUMERIC                                      00000083
  7129           NEXT SENTENCE                                          00000084
  7130        ELSE                                                      00000085
  7131           MOVE ZEROS TO CR-LFPRM.                                00000086
  7132                                                                  00000087
  7133     IF    CR-LFPRM-ALT  NUMERIC                                  00000088
  7134           NEXT SENTENCE                                          00000089
  7135        ELSE                                                      00000090
  7136           MOVE ZEROS TO CR-LFPRM-ALT.                            00000091
  7137                                                                  00000092
  7138                                                                  00000093
  7139     IF    CR-LFPRM-CALC  NUMERIC                                 00000094
  7140           NEXT SENTENCE                                          00000095
  7141        ELSE                                                      00000096
  7142           MOVE ZEROS TO CR-LFPRM-CALC.                           00000097
  7143                                                                  00000098
  7144     IF    CR-LFPRM-CALC-ALT  NUMERIC                             00000099
  7145           NEXT SENTENCE                                          00000100
  7146        ELSE                                                      00000101
  7147           MOVE ZEROS TO CR-LFPRM-CALC-ALT.                       00000102
  7148                                                                  00000103
  7149     IF    CR-LF-NSP-PRM  NUMERIC                                 00000104
  7150           NEXT SENTENCE                                          00000105
  7151        ELSE                                                      00000106
  7152           MOVE ZEROS TO CR-LF-NSP-PRM.                           00000107
  7153                                                                  00000108
  7154     COMPUTE RS-R-LB = CR-LFAMT + CR-LFAMT-ALT.                   ECSRTPFM
  7155     COMPUTE RS-R-LP = CR-LFPRM + CR-LFPRM-ALT.                   ECSRTPFM
  7156     IF RE-NSP-ST-CD-LF = ZEROS  OR  SPACES                       ECSRTPFM
  7157         COMPUTE RS-R-LPC = CR-LFPRM-CALC + CR-LFPRM-CALC-ALT     ECSRTPFM
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 150
* ECS150P.cbl (/apps/prod/cid1p/copy/ECSRTPFM)
  7158     ELSE                                                         ECSRTPFM
  7159         MOVE CR-LF-NSP-PRM         TO RS-R-LPC.                  ECSRTPFM
  7160     MOVE RS-R-LPC                  TO REIN-CALCED-LIFE.          ECSRTPFM
  7161                                                                  ECSRTPFM
  7162     MOVE CR-AHAMT                  TO RS-R-AB.                   ECSRTPFM
  7163     MOVE CR-AHPRM                  TO RS-R-AP.                   ECSRTPFM
  7164     IF RE-NSP-ST-CD-AH = ZEROS  OR  SPACES                       ECSRTPFM
  7165         MOVE CR-AHPRM-CALC         TO RS-R-APC                   ECSRTPFM
  7166     ELSE                                                         ECSRTPFM
  7167         MOVE CR-AH-NSP-PRM         TO RS-R-APC.                  ECSRTPFM
  7168     MOVE RS-R-APC                  TO REIN-CALCED-AH.            ECSRTPFM
  7169                                                                  ECSRTPFM
  7170     PERFORM REINSURE-CALC THRU REINSURE-CALC-X                   ECSRTPFM
  7171         VARYING SUB1 FROM +1 BY +1                               ECSRTPFM
  7172             UNTIL RE-REI-COMP-NO (SUB1) = SPACES.                ECSRTPFM
  7173                                                                  ECSRTPFM
  7174
  7175 REINSURE-ROUTINE-SKIP-1.
  7176     PERFORM REINSURE-CANCEL THRU REINSURE-CANCEL-X.
  7177     PERFORM REINSURE-CLAIM THRU REINSURE-CLAIM-X.
  7178     MOVE SPACES                 TO RC-REC.
  7179     MOVE CR-FULL-CONTROL        TO RC-CMCTL.
  7180     MOVE CR-LFAMT               TO RC-ORIG-LFAMT.
  7181     MOVE CR-LFAMT-ALT           TO RC-LFAMT-ALT.
  7182     MOVE CR-LF-TERM             TO RC-LF-TERM.
  7183     MOVE CR-LF-TERM-IN-DAYS     TO RC-LF-TERM-IN-DAYS.
  7184     MOVE CR-AH-TERM             TO RC-AH-TERM.
  7185     MOVE CR-ENTRY-STATUS        TO RC-ENTRY-STATUS.
  7186     MOVE CR-LF-CURRENT-STATUS   TO RC-LF-CURRENT-STATUS.
  7187     MOVE CR-AH-CURRENT-STATUS   TO RC-AH-CURRENT-STATUS.
  7188     MOVE CR-LFTYP               TO RC-LFTYP.
  7189     MOVE CR-AHTYP               TO RC-AHTYP.
  7190     MOVE CR-IND-GRP             TO RC-IND-GRP.
  7191     MOVE CR-LF-CANC-DT          TO RC-LF-CANC-DT.
  7192     MOVE CR-AH-CANC-DT          TO RC-AH-CANC-DT.
  7193     MOVE CR-DIS-DT              TO RC-DIS-DT.
  7194     MOVE CR-ENTRY-DATE          TO RC-ENT-DT.
  7195     MOVE CR-LF-status-at-cancel TO RC-LF-cancel-status
  7196     MOVE CR-ah-status-at-cancel TO RC-ah-cancel-status
  7197     MOVE CR-LF-CANCEL-EXIT-DATE TO RC-LF-CANC-EXIT.
  7198     MOVE CR-AH-CANCEL-EXIT-DATE TO RC-AH-CANC-EXIT.
  7199     MOVE CR-LF-CLAIM-EXIT-DATE  TO RC-LF-CLAIM-EXIT.
  7200     MOVE CR-AH-SETTLEMENT-EXIT-DATE
  7201                                 TO RC-AH-CLAIM-EXIT.
  7202     MOVE CR-PMT-FREQ            TO RC-PMT-FREQ.
  7203     MOVE CR-APR                 TO RC-APR.
  7204     MOVE CR-LOAN-TERM           TO RC-LOAN-TERM.
  7205     MOVE CR-IND-GRP             TO RC-IND-GRP.
  7206     MOVE CR-LIVES               TO RC-I-LIVES.
  7207     MOVE CR-SUM-CAN-CNT-YTD     TO RC-C-LIVES-YTD.
  7208     MOVE CR-SUM-CAN-CNT-ITD     TO RC-C-LIVES-ITD.
  7209     MOVE CR-LFRFND-CALC         TO RC-LFRFND-YTD.
  7210     MOVE CR-AHRFND-CALC         TO RC-AHRFND-YTD.
  7211     MOVE CR-LF-EXPIRE-DATE      TO RC-LF-EXPIRE-DT.
  7212     MOVE CR-AH-EXPIRE-DATE      TO RC-AH-EXPIRE-DT.
  7213     MOVE CR-LOAN-1ST-PMT-DT     TO RC-LOAN-1ST-PMT-DT.
  7214     MOVE RC-REC                 TO SAVE-REINS-CERT.
  7215     GO TO 6000-EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 151
* ECS150P.cbl
  7216
  7217 RR-READ-REIN.
  7218     IF REIN-OPEN-SW = ' '
  7219         MOVE LOW-VALUES         TO RE-KEY
  7220         MOVE 'X'                TO REIN-OPEN-SW
  7221         MOVE 'A'                TO REIN-SRCH-CODE
  7222         OPEN INPUT ERRTBL-IN
  7223         IF ERRTBL-FILE-STATUS = '00' OR '97'
  7224             PERFORM REIN-CO-TABLE-BUILD THRU REIN-BUILD-EXIT
  7225          ELSE
  7226             MOVE '21'           TO ABEND-FILE-ID
  7227             MOVE ERRTBL-FILE-STATUS
  7228                                 TO ABEND-REASON
  7229             GO TO ABEND-PGM.
  7230
  7231     IF REIN-SRCH NOT = SAVE-REIN-SRCH
  7232         MOVE LOW-VALUES         TO RE-KEY
  7233         MOVE DTE-CLASIC-COMPANY-CD
  7234                                 TO RE-COMPANY-CD
  7235         MOVE REIN-SRCH          TO SAVE-REIN-SRCH
  7236                                    RE-TABLE
  7237         MOVE REIN-SRCH-CODE     TO RE-CODE
  7238         READ ERRTBL-IN
  7239         IF ERRTBL-FILE-STATUS NOT = '00'
  7240             DISPLAY 'INVALID REINSURANCE TABLE CODE - '
  7241                 RE-TABLE ' ' CR-ACCT-CONTROL
  7242             MOVE '24'            TO ABEND-FILE-ID
  7243             MOVE ERRTBL-FILE-STATUS
  7244                                 TO ABEND-REASON
  7245             GO TO ABEND-PGM.
  7246
  7247     IF RE-CODE NOT = 'A'
  7248        PERFORM REIN-DATE-LOAD.
  7249
  7250 RR-READ-REIN-X.
  7251     EXIT.
  7252
  7253 REINSURE-CANCEL.
  7254     IF REIN-COMP (1) = SPACES
  7255         GO TO REINSURE-CANCEL-X.
  7256
  7257     IF CR-LFRFND = ZERO AND
  7258        CR-AHRFND = ZERO
  7259         GO TO REINSURE-CANCEL-X.
  7260
  7261     PERFORM REINSURE-CALC-CANCEL
  7262             THRU REINSURE-CALC-CANCEL-X
  7263                 VARYING SUB1 FROM +1 BY +1
  7264                     UNTIL REIN-COMP (SUB1) = SPACES.
  7265
  7266 REINSURE-CANCEL-X.
  7267     EXIT.
  7268
  7269 REINSURE-CLAIM.
  7270     IF REIN-COMP (1) = SPACES
  7271         GO TO REINSURE-CLAIM-X.
  7272
  7273     MOVE CR-DTHAMT-YTD          TO RW-LFCLMWK.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 152
* ECS150P.cbl
  7274     MOVE CR-DISAMT-YTD          TO RW-AHCLMWK.
  7275     MOVE +0                     TO RW-LFCLM
  7276                                    RW-AHCLM.
  7277
  7278     IF RW-LFCLMWK = ZERO AND
  7279        RW-AHCLMWK = ZERO
  7280         GO TO REINSURE-CLAIM-X.
  7281
  7282     PERFORM REINSURE-CALC-CLAIM
  7283             THRU REINSURE-CALC-CLAIM-X
  7284                 VARYING SUB1 FROM +1 BY +1
  7285                     UNTIL REIN-COMP (SUB1) = SPACES.
  7286
  7287 REINSURE-CLAIM-X.
  7288     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 153
* ECS150P.cbl
  7290
  7291 REINSURANCE-ROUTINES.
* 7292                             COPY ECSRIRTNP.
  7293******************************************************************04/30/98
  7294*                                                                *ECSRIRTN
  7295*                            ECSRIRTN                            *   LV012
  7296*                            VMOD=2.025.                         *ECSRIRTN
  7297*                                                                *ECSRIRTN
  7298******************************************************************ECSRIRTN
  7299******************************************************************
  7300*                   C H A N G E   L O G
  7301*
  7302* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7303*-----------------------------------------------------------------
  7304*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7305* EFFECTIVE    NUMBER
  7306*-----------------------------------------------------------------
  7307* 062703                   PEMA  ADD DCC CLIENT ID TO
  7308*                                SPECIAL CEDED CLAIM CALC
  7309                                                                  ECSRIRTN
  7310 REINSURE-CALC.                                                   ECSRIRTN
  7311                                                                  ECSRIRTN
  7312     MOVE RE-REI-COMP-NO (SUB1) TO REIN-COMP (SUB1).              ECSRIRTN
  7313     MOVE REIN-WORK-FLDS (SUB1) TO RWF-FIELDS.                    ECSRIRTN
  7314     MOVE RE-COMP-INFO (SUB1)   TO WT-COMP-INFO.                  ECSRIRTN
  7315     MOVE WT-REMAINING          TO RWF-REM-SW                     ECSRIRTN
  7316                                   REIN-REM-SW (SUB1).            ECSRIRTN
  7317                                                                  ECSRIRTN
  7318     MOVE ZEROS                 TO RWF-EP-STOP-DATE               ECSRIRTN
  7319                                   WS-RWF-EP-STOP-DATE-N             CL*12
  7320                                   REIN-EP-STOP-DATE (SUB1).      ECSRIRTN
  7321                                                                  ECSRIRTN
  7322     MOVE 'Y'                   TO RWF-LF-RUNOFF-SW               ECSRIRTN
  7323                                   REIN-LF-RUNOFF-SW (SUB1)       ECSRIRTN
  7324                                   RWF-AH-RUNOFF-SW               ECSRIRTN
  7325                                   REIN-AH-RUNOFF-SW (SUB1).      ECSRIRTN
  7326                                                                  ECSRIRTN
  7327     PERFORM REIN-FIND-CO-LOOP THRU FIND-REI-CO-EXIT              ECSRIRTN
  7328        VARYING CO-SUB FROM 1 BY 1 UNTIL                          ECSRIRTN
  7329          (RCT-REIN-CO (CO-SUB) = REIN-COMP (SUB1))  OR           ECSRIRTN
  7330          (CO-SUB GREATER REIN-CO-TABLE-ENT-CNT)     OR           ECSRIRTN
  7331          (RCT-REIN-CO (CO-SUB) = SPACES).                        ECSRIRTN
  7332                                                                  ECSRIRTN
  7333     IF (CO-SUB GREATER REIN-CO-TABLE-ENT-CNT)  OR                ECSRIRTN
  7334        (RCT-REIN-CO (CO-SUB) = SPACES)                           ECSRIRTN
  7335         GO TO CALC-CONTINUED.                                    ECSRIRTN
  7336                                                                  ECSRIRTN
  7337     MOVE RCT-EARNING-STOP-DT (CO-SUB) TO RWF-EP-STOP-DATE        ECSRIRTN
  7338                                          WS-RWF-EP-STOP-DATE-N      CL*12
  7339                                          REIN-EP-STOP-DATE (SUB1)ECSRIRTN
  7340                                                                  ECSRIRTN
  7341     IF RWF-EP-STOP-DATE = ZEROS                                  ECSRIRTN
  7342         GO TO CALC-CONTINUED.                                    ECSRIRTN
  7343                                                                  ECSRIRTN
  7344     IF RCT-EARN-STOP-CODE (CO-SUB) = 'L'  OR  'B'                ECSRIRTN
  7345         MOVE 'N'               TO RWF-LF-RUNOFF-SW               ECSRIRTN
  7346                                   REIN-LF-RUNOFF-SW (SUB1).      ECSRIRTN
  7347                                                                  ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 154
* ECS150P.cbl (/apps/prod/cid1p/copy/ECSRIRTNP)
  7348     IF RCT-EARN-STOP-CODE (CO-SUB) = 'A'  OR  'B'                ECSRIRTN
  7349         MOVE 'N'               TO RWF-AH-RUNOFF-SW               ECSRIRTN
  7350                                   REIN-AH-RUNOFF-SW (SUB1).      ECSRIRTN
  7351                                                                  ECSRIRTN
  7352 CALC-CONTINUED.                                                  ECSRIRTN
  7353                                                                  ECSRIRTN
  7354     COMPUTE RS-LIFE-BEN  = CR-LFAMT + CR-LFAMT-ALT.              ECSRIRTN
  7355     COMPUTE RS-LIFE-PREM = CR-LFPRM + CR-LFPRM-ALT.              ECSRIRTN
  7356                                                                  ECSRIRTN
  7357     IF RE-NSP-ST-CD-LF = ZEROS  OR  SPACES                       ECSRIRTN
  7358         COMPUTE RS-LP-CALC = CR-LFPRM-CALC + CR-LFPRM-CALC-ALT   ECSRIRTN
  7359     ELSE                                                         ECSRIRTN
  7360         MOVE CR-LF-NSP-PRM         TO RS-LP-CALC.                ECSRIRTN
  7361     MOVE RS-LP-CALC                TO REIN-CALCED-LIFE.          ECSRIRTN
  7362                                                                  ECSRIRTN
  7363     MOVE CR-AHAMT                  TO RS-AH-BEN.                 ECSRIRTN
  7364     MOVE CR-AHPRM                  TO RS-AH-PREM.                ECSRIRTN
  7365     IF RE-NSP-ST-CD-AH = ZEROS  OR  SPACES                       ECSRIRTN
  7366         MOVE CR-AHPRM-CALC         TO RS-AP-CALC                 ECSRIRTN
  7367     ELSE                                                         ECSRIRTN
  7368         MOVE CR-AH-NSP-PRM         TO RS-AP-CALC.                ECSRIRTN
  7369     MOVE RS-AP-CALC                TO REIN-CALCED-AH.            ECSRIRTN
  7370                                                                  ECSRIRTN
  7371     IF WT-REMAINING = 'Y' OR 'Z' OR 'L' OR 'R'                   ECSRIRTN
  7372         MOVE RS-R-LB               TO RS-LIFE-BEN                ECSRIRTN
  7373         MOVE RS-R-LP               TO RS-LIFE-PREM               ECSRIRTN
  7374         MOVE RS-R-LPC              TO RS-LP-CALC                 ECSRIRTN
  7375         MOVE RS-R-AB               TO RS-AH-BEN                  ECSRIRTN
  7376         MOVE RS-R-AP               TO RS-AH-PREM                 ECSRIRTN
  7377         MOVE RS-R-APC              TO RS-AP-CALC.                ECSRIRTN
  7378                                                                  ECSRIRTN
  7379     IF SUB1 = RE-100-COMP                                        ECSRIRTN
  7380         GO TO REINSURE-CALC-REMAINDER.                           ECSRIRTN
  7381                                                                  ECSRIRTN
  7382     IF CR-DT LESS WT-LO-DATE                                        CL**2
  7383         GO TO REINSURE-CALC-X.                                   ECSRIRTN
  7384                                                                  ECSRIRTN
  7385     IF CR-DT NOT LESS WT-HI-DATE                                    CL**2
  7386         GO TO REINSURE-CALC-X.                                   ECSRIRTN
  7387                                                                  ECSRIRTN
  7388     PERFORM REINSURE-CK-LIFE      THRU REINSURE-CK-LIFE-X.       ECSRIRTN
  7389     PERFORM REINSURE-CK-AH        THRU REINSURE-CK-AH-X.         ECSRIRTN
  7390                                                                  ECSRIRTN
  7391     IF WT-INTERACTIVE = 'E'                                      ECSRIRTN
  7392         PERFORM REIN-CHECK-INTERACT-E THRU REIN-INTERACT-CHECK-X.ECSRIRTN
  7393                                                                  ECSRIRTN
  7394     IF WT-INTERACTIVE = 'X'                                      ECSRIRTN
  7395       IF  (REIN-LF-FLG (SUB1) = 'X' AND REIN-AH-FLG (SUB1) = 'X')ECSRIRTN
  7396        OR (REIN-LF-FLG (SUB1) = 'X' AND REIN-AH-FLG (SUB1) = ' ')ECSRIRTN
  7397        OR (REIN-LF-FLG (SUB1) = ' ' AND REIN-AH-FLG (SUB1) = 'X')ECSRIRTN
  7398           NEXT SENTENCE                                          ECSRIRTN
  7399       ELSE                                                       ECSRIRTN
  7400           MOVE 'Y' TO REIN-LF-FLG (SUB1)                         ECSRIRTN
  7401                       REIN-AH-FLG (SUB1).                        ECSRIRTN
  7402                                                                  ECSRIRTN
  7403     IF WT-INTERACTIVE = 'Y'                                      ECSRIRTN
  7404         IF REIN-LF-FLG (SUB1) = 'X' AND                          ECSRIRTN
  7405            REIN-AH-FLG (SUB1) = 'Y'                              ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 155
* ECS150P.cbl (/apps/prod/cid1p/copy/ECSRIRTNP)
  7406             MOVE 'X' TO REIN-AH-FLG (SUB1).                      ECSRIRTN
  7407                                                                  ECSRIRTN
  7408     IF WT-INTERACTIVE = 'Y'                                      ECSRIRTN
  7409         IF REIN-AH-FLG (SUB1) = 'X' AND                          ECSRIRTN
  7410            REIN-LF-FLG (SUB1) = 'Y'                              ECSRIRTN
  7411             MOVE 'X' TO REIN-LF-FLG (SUB1).                      ECSRIRTN
  7412                                                                  ECSRIRTN
  7413     IF WT-INTERACTIVE = 'Z'                                      ECSRIRTN
  7414         IF REIN-LF-FLG (SUB1) = 'X'                              ECSRIRTN
  7415             IF REIN-AH-FLG (SUB1) = 'Y'                          ECSRIRTN
  7416                 MOVE 'X' TO REIN-AH-FLG (SUB1)                   ECSRIRTN
  7417             ELSE                                                 ECSRIRTN
  7418                 NEXT SENTENCE                                    ECSRIRTN
  7419         ELSE                                                     ECSRIRTN
  7420             MOVE 'Y' TO REIN-LF-FLG (SUB1)                       ECSRIRTN
  7421                         REIN-AH-FLG (SUB1).                      ECSRIRTN
  7422                                                                  ECSRIRTN
  7423     IF WT-INTERACTIVE = 'W'                                      ECSRIRTN
  7424         IF REIN-AH-FLG (SUB1) = 'X'                              ECSRIRTN
  7425             IF REIN-LF-FLG (SUB1) = 'Y'                          ECSRIRTN
  7426                 MOVE 'X' TO REIN-LF-FLG (SUB1)                   ECSRIRTN
  7427             ELSE                                                 ECSRIRTN
  7428                 NEXT SENTENCE                                    ECSRIRTN
  7429         ELSE                                                     ECSRIRTN
  7430             MOVE 'Y' TO REIN-LF-FLG (SUB1)                       ECSRIRTN
  7431                         REIN-AH-FLG (SUB1).                      ECSRIRTN
  7432                                                                  ECSRIRTN
  7433     IF REIN-LF-FLG (SUB1) = 'X'                                  ECSRIRTN
  7434         PERFORM REIN-CALC-LIFE THRU REIN-CALC-LIFE-X.            ECSRIRTN
  7435                                                                  ECSRIRTN
  7436     IF REIN-LF-FLG (SUB1) = 'E'                                  ECSRIRTN
  7437         PERFORM REIN-LF-SKIP-LIMIT THRU REIN-CALC-LIFE-X         ECSRIRTN
  7438         MOVE 'X' TO REIN-LF-FLG (SUB1).                          ECSRIRTN
  7439                                                                  ECSRIRTN
  7440     IF REIN-AH-FLG (SUB1) = 'X'                                  ECSRIRTN
  7441         PERFORM REIN-CALC-AH THRU REIN-CALC-AH-X.                ECSRIRTN
  7442                                                                  ECSRIRTN
  7443     IF REIN-AH-FLG (SUB1) = 'E'                                  ECSRIRTN
  7444         PERFORM REIN-AH-SKIP-LIMIT THRU REIN-CALC-AH-X           ECSRIRTN
  7445         MOVE 'X'                TO  REIN-AH-FLG (SUB1).          ECSRIRTN
  7446                                                                  ECSRIRTN
  7447     IF REIN-LF-FLG (SUB1) NOT = 'X'                              ECSRIRTN
  7448         MOVE SPACE TO REIN-LF-FLG (SUB1).                        ECSRIRTN
  7449                                                                  ECSRIRTN
  7450     IF REIN-AH-FLG (SUB1) NOT = 'X'                              ECSRIRTN
  7451         MOVE SPACE TO REIN-AH-FLG (SUB1).                        ECSRIRTN
  7452                                                                  ECSRIRTN
  7453     GO TO REINSURE-CALC-X.                                       ECSRIRTN
  7454                                                                  ECSRIRTN
  7455 REINSURE-CK-LIFE.                                                ECSRIRTN
  7456                                                                  ECSRIRTN
  7457     IF CR-LFTYP = ZERO                                           ECSRIRTN
  7458         GO TO REINSURE-CK-LIFE-X.                                ECSRIRTN
  7459                                                                  ECSRIRTN
  7460     IF WT-LF-PCT = ZERO                                          ECSRIRTN
  7461         GO TO REINSURE-CK-LIFE-X.                                ECSRIRTN
  7462                                                                  ECSRIRTN
  7463     IF DTE-CLIENT = 'CSO' OR 'CSI'                               ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 156
* ECS150P.cbl (/apps/prod/cid1p/copy/ECSRIRTNP)
  7464         IF CLAS-I-REIN-YN (CLAS-INDEXL) = 'N'                    ECSRIRTN
  7465             GO TO REINSURE-CK-LIFE-X.                            ECSRIRTN
  7466                                                                  ECSRIRTN
  7467     MOVE WT-LF-BEN-CODE                TO REIN-BEN-CODE.         ECSRIRTN
  7468                                                                  ECSRIRTN
  7469     IF CEDING-PROPERTY-ONLY                                      ECSRIRTN
  7470         IF CLAS-I-CALC-TYPE (CLAS-INDEXL) NOT = '2'              ECSRIRTN
  7471             GO TO REINSURE-CK-LIFE-X                             ECSRIRTN
  7472         ELSE                                                     ECSRIRTN
  7473             NEXT SENTENCE                                        ECSRIRTN
  7474     ELSE                                                         ECSRIRTN
  7475         IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = '2'                  ECSRIRTN
  7476             GO TO REINSURE-CK-LIFE-X.                            ECSRIRTN
  7477                                                                  ECSRIRTN
  7478     IF CEDING-AD-D-ONLY                                          ECSRIRTN
  7479         IF CLAS-I-CALC-TYPE (CLAS-INDEXL) NOT = '4'              ECSRIRTN
  7480             GO TO REINSURE-CK-LIFE-X                             ECSRIRTN
  7481         ELSE                                                     ECSRIRTN
  7482             NEXT SENTENCE                                        ECSRIRTN
  7483     ELSE                                                         ECSRIRTN
  7484         IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = '4'                  ECSRIRTN
  7485             GO TO REINSURE-CK-LIFE-X.                            ECSRIRTN
  7486                                                                  ECSRIRTN
  7487     IF CEDING-SINGLE-PREM-ONLY                                   ECSRIRTN
  7488         IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'B'                  ECSRIRTN
  7489             GO TO REINSURE-CK-LIFE-X.                            ECSRIRTN
  7490                                                                  ECSRIRTN
  7491     IF CEDING-OUT-BALANCE-ONLY                                   ECSRIRTN
  7492         IF CLAS-I-CALC-TYPE (CLAS-INDEXL) NOT = 'B'              ECSRIRTN
  7493            GO TO REINSURE-CK-LIFE-X.                             ECSRIRTN
  7494                                                                  ECSRIRTN
  7495     IF CEDING-REDUCING-ONLY                                      ECSRIRTN
  7496         IF CLAS-I-RL-AH (CLAS-INDEXL) = 'L' OR 'P'               ECSRIRTN
  7497             GO TO REINSURE-CK-LIFE-X.                            ECSRIRTN
  7498                                                                  ECSRIRTN
  7499     IF CEDING-LEVEL-ONLY                                         ECSRIRTN
  7500         IF CLAS-I-RL-AH (CLAS-INDEXL) = 'R'                      ECSRIRTN
  7501            GO TO REINSURE-CK-LIFE-X.                             ECSRIRTN
  7502                                                                  ECSRIRTN
  7503     IF CEDING-GROUP-ONLY                                         ECSRIRTN
  7504         IF CR-IND-GRP NOT = '2'                                  ECSRIRTN
  7505             GO TO REINSURE-CK-LIFE-X.                            ECSRIRTN
  7506                                                                  ECSRIRTN
  7507     IF CEDING-GROUP-RED-LIFE-ONLY                                ECSRIRTN
  7508         IF (CR-IND-GRP = '1')  OR                                ECSRIRTN
  7509            (CLAS-I-RL-AH (CLAS-INDEXL) = 'L' OR 'P') OR          ECSRIRTN
  7510            (CR-AHTYP NOT = ZERO)                                 ECSRIRTN
  7511             GO TO REINSURE-CK-LIFE-X.                            ECSRIRTN
  7512                                                                  ECSRIRTN
  7513     IF CEDING-GROUP-REDUCING-ONLY                                ECSRIRTN
  7514         IF (CR-IND-GRP = '1')  OR                                ECSRIRTN
  7515            (CLAS-I-RL-AH (CLAS-INDEXL) = 'L' OR 'P')             ECSRIRTN
  7516             GO TO REINSURE-CK-LIFE-X.                            ECSRIRTN
  7517                                                                  ECSRIRTN
  7518     IF CEDING-INDIVIDUAL-ONLY                                    ECSRIRTN
  7519         IF CR-IND-GRP NOT = '1'                                  ECSRIRTN
  7520             GO TO REINSURE-CK-LIFE-X.                            ECSRIRTN
  7521                                                                  ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 157
* ECS150P.cbl (/apps/prod/cid1p/copy/ECSRIRTNP)
  7522     IF CEDING-JOINT-ONLY                                         ECSRIRTN
  7523         IF CLAS-I-JOINT (CLAS-INDEXL) NOT = 'J'                  ECSRIRTN
  7524             GO TO REINSURE-CK-LIFE-X.                            ECSRIRTN
  7525                                                                  ECSRIRTN
  7526     IF CEDING-SGL-PREM-REDUCING                                  ECSRIRTN
  7527        IF (CLAS-I-RL-AH (CLAS-INDEXL) = 'L' OR 'P')  OR          ECSRIRTN
  7528           CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'B'                   ECSRIRTN
  7529            GO TO REINSURE-CK-LIFE-X.                             ECSRIRTN
  7530                                                                  ECSRIRTN
  7531     IF CEDING-SGL-PREM-GROUP                                     ECSRIRTN
  7532         IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'B'  OR              ECSRIRTN
  7533            CR-IND-GRP = '1'                                      ECSRIRTN
  7534             GO TO REINSURE-CK-LIFE-X.                            ECSRIRTN
  7535                                                                  ECSRIRTN
  7536     IF CEDING-GROUP-LEVEL-ONLY                                   ECSRIRTN
  7537         IF CLAS-I-RL-AH (CLAS-INDEXL) = 'R'  OR                  ECSRIRTN
  7538            CR-IND-GRP = '1'                                      ECSRIRTN
  7539             GO TO REINSURE-CK-LIFE-X.                            ECSRIRTN
  7540                                                                  ECSRIRTN
  7541     IF CEDING-SGL-PREM-GRP-REDUCING                              ECSRIRTN
  7542         IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'B'  OR              ECSRIRTN
  7543            (CLAS-I-RL-AH (CLAS-INDEXL) = 'L' OR 'P')  OR         ECSRIRTN
  7544            CR-IND-GRP = '1'                                      ECSRIRTN
  7545             GO TO REINSURE-CK-LIFE-X.                            ECSRIRTN
  7546                                                                  ECSRIRTN
  7547     IF CEDING-SGL-PREM-GROUP-LEVEL                               ECSRIRTN
  7548         IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'B'  OR              ECSRIRTN
  7549            CLAS-I-RL-AH (CLAS-INDEXL) = 'R'  OR                  ECSRIRTN
  7550            CR-IND-GRP = '1'                                      ECSRIRTN
  7551             GO TO REINSURE-CK-LIFE-X.                            ECSRIRTN
  7552                                                                  ECSRIRTN
  7553     IF CEDING-SINGLE-POLICIES-ONLY                               ECSRIRTN
  7554         IF CLAS-I-JOINT (CLAS-INDEXL) = 'J'                      ECSRIRTN
  7555            GO TO REINSURE-CK-LIFE-X.                             ECSRIRTN
  7556                                                                  ECSRIRTN
  7557     IF DTE-CLIENT EQUAL 'NCL'                                    ECSRIRTN
  7558        MOVE 'Y'                 TO REIN-LF-FLG (SUB1).           ECSRIRTN
  7559                                                                  ECSRIRTN
  7560     IF CR-AGE LESS WT-LFAGE-LO                                   ECSRIRTN
  7561         GO TO REINSURE-CK-LIFE-X.                                ECSRIRTN
  7562                                                                  ECSRIRTN
  7563     IF CR-AGE GREATER WT-LFAGE-HI                                ECSRIRTN
  7564         GO TO REINSURE-CK-LIFE-X.                                ECSRIRTN
  7565                                                                  ECSRIRTN
  7566     IF CR-LF-TERM  NUMERIC                                       00002331
  7567        NEXT SENTENCE                                             00002332
  7568     ELSE                                                         00002333
  7569        MOVE ZEROS               TO CR-LF-TERM                    00002334
  7570     END-IF
  7571                                                                  00002335
  7572     IF CR-LF-TERM LESS WT-LFTRM-LO                               ECSRIRTN
  7573         GO TO REINSURE-CK-LIFE-X.                                ECSRIRTN
  7574                                                                  ECSRIRTN
  7575     IF CR-LF-TERM GREATER WT-LFTRM-HI                            ECSRIRTN
  7576         GO TO REINSURE-CK-LIFE-X.                                ECSRIRTN
  7577                                                                  ECSRIRTN
  7578     MOVE 'Y' TO REIN-LF-FLG (SUB1).                              ECSRIRTN
  7579                                                                  ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 158
* ECS150P.cbl (/apps/prod/cid1p/copy/ECSRIRTNP)
  7580     IF RS-LIFE-BEN NOT GREATER WT-LF-LIM-LO                      ECSRIRTN
  7581         GO TO REINSURE-CK-LIFE-X.                                ECSRIRTN
  7582                                                                  ECSRIRTN
  7583     IF RS-LIFE-BEN GREATER WT-LF-LIM-HI                          ECSRIRTN
  7584         GO TO REINSURE-CK-LIFE-X.                                ECSRIRTN
  7585                                                                  ECSRIRTN
  7586     MOVE 'X' TO REIN-LF-FLG (SUB1).                              ECSRIRTN
  7587                                                                  ECSRIRTN
  7588 REINSURE-CK-LIFE-X.                                              ECSRIRTN
  7589     EXIT.                                                        ECSRIRTN
  7590                                                                  ECSRIRTN
  7591 REINSURE-CK-AH.                                                  ECSRIRTN
  7592                                                                  ECSRIRTN
  7593     IF CR-AHTYP = ZERO                                           ECSRIRTN
  7594         GO TO REINSURE-CK-AH-X.                                  ECSRIRTN
  7595                                                                  ECSRIRTN
  7596     IF WT-AH-PCT = ZERO                                          ECSRIRTN
  7597         GO TO REINSURE-CK-AH-X.                                  ECSRIRTN
  7598                                                                  ECSRIRTN
  7599     IF DTE-CLIENT = 'CSO' OR 'CSI'                               ECSRIRTN
  7600         IF CLAS-I-REIN-YN (CLAS-INDEXA) = 'N'                    ECSRIRTN
  7601             GO TO REINSURE-CK-AH-X.                              ECSRIRTN
  7602                                                                  ECSRIRTN
  7603     MOVE WT-AH-BEN-CODE                TO REIN-BEN-CODE.         ECSRIRTN
  7604                                                                  ECSRIRTN
  7605     IF CEDING-UNEMPLOYMENT-ONLY                                  ECSRIRTN
  7606         IF CLAS-I-CALC-TYPE (CLAS-INDEXA) NOT = '3'              ECSRIRTN
  7607             GO TO REINSURE-CK-AH-X                               ECSRIRTN
  7608         ELSE                                                     ECSRIRTN
  7609             NEXT SENTENCE                                        ECSRIRTN
  7610     ELSE                                                         ECSRIRTN
  7611         IF CLAS-I-CALC-TYPE (CLAS-INDEXA) = '3'                  ECSRIRTN
  7612             GO TO REINSURE-CK-AH-X.                              ECSRIRTN
  7613                                                                  ECSRIRTN
  7614     IF CEDING-SINGLE-PREM-ONLY                                   ECSRIRTN
  7615         IF CLAS-I-CALC-TYPE (CLAS-INDEXA) = 'B'                  ECSRIRTN
  7616             GO TO REINSURE-CK-AH-X.                              ECSRIRTN
  7617                                                                  ECSRIRTN
  7618     IF CEDING-JOINT-ONLY                                         ECSRIRTN
  7619         IF CLAS-I-JOINT (CLAS-INDEXA) NOT = 'J'                  ECSRIRTN
  7620             GO TO REINSURE-CK-AH-X.                              ECSRIRTN
  7621                                                                  ECSRIRTN
  7622     IF CEDING-OUT-BALANCE-ONLY                                   ECSRIRTN
  7623         IF CLAS-I-CALC-TYPE (CLAS-INDEXA) NOT = 'B'              ECSRIRTN
  7624             GO TO REINSURE-CK-AH-X.                              ECSRIRTN
  7625                                                                  ECSRIRTN
  7626     IF CEDING-GROUP-ONLY                                         ECSRIRTN
  7627         IF CR-IND-GRP NOT = '2'                                  ECSRIRTN
  7628             GO TO REINSURE-CK-AH-X.                              ECSRIRTN
  7629                                                                  ECSRIRTN
  7630     IF CEDING-SGL-PREM-GROUP                                     ECSRIRTN
  7631         IF CLAS-I-CALC-TYPE (CLAS-INDEXA) = 'B'  OR              ECSRIRTN
  7632            CR-IND-GRP = '1'                                      ECSRIRTN
  7633             GO TO REINSURE-CK-AH-X.                              ECSRIRTN
  7634                                                                  ECSRIRTN
  7635     IF CEDING-INDIVIDUAL-ONLY                                    ECSRIRTN
  7636         IF CR-IND-GRP NOT = '1'                                  ECSRIRTN
  7637             GO TO REINSURE-CK-AH-X.                              ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 159
* ECS150P.cbl (/apps/prod/cid1p/copy/ECSRIRTNP)
  7638                                                                  ECSRIRTN
  7639     IF CEDING-SINGLE-POLICIES-ONLY                               ECSRIRTN
  7640         IF CLAS-I-JOINT (CLAS-INDEXA) = 'J'                      ECSRIRTN
  7641            GO TO REINSURE-CK-AH-X.                               ECSRIRTN
  7642                                                                  ECSRIRTN
  7643     IF CEDING-7-DAY-RETRO                                        ECSRIRTN
  7644         IF CLAS-I-AB3 (CLAS-INDEXA) NOT = (' 7R'  AND  '07R')    ECSRIRTN
  7645            GO TO REINSURE-CK-AH-X.                               ECSRIRTN
  7646                                                                  ECSRIRTN
  7647     IF CEDING-14-DAY-RETRO                                       ECSRIRTN
  7648         IF CLAS-I-AB3 (CLAS-INDEXA) NOT = '14R'                  ECSRIRTN
  7649             GO TO REINSURE-CK-AH-X.                              ECSRIRTN
  7650                                                                  ECSRIRTN
  7651     IF DTE-CLIENT EQUAL 'NCL'                                    ECSRIRTN
  7652        MOVE 'Y'                 TO REIN-AH-FLG (SUB1).           ECSRIRTN
  7653                                                                  ECSRIRTN
  7654     IF CR-AGE LESS WT-AHAGE-LO                                   ECSRIRTN
  7655         GO TO REINSURE-CK-AH-X.                                  ECSRIRTN
  7656                                                                  ECSRIRTN
  7657     IF CR-AGE GREATER WT-AHAGE-HI                                ECSRIRTN
  7658         GO TO REINSURE-CK-AH-X.                                  ECSRIRTN
  7659                                                                  ECSRIRTN
  7660     IF CR-AH-TERM  NUMERIC                                       00002331
  7661        NEXT SENTENCE                                             00002332
  7662     ELSE                                                         00002333
  7663        MOVE ZEROS               TO CR-AH-TERM                    00002334
  7664     END-IF
  7665                                                                  00002335
  7666     IF CR-AH-TERM LESS WT-AHTRM-LO                               ECSRIRTN
  7667         GO TO REINSURE-CK-AH-X.                                  ECSRIRTN
  7668                                                                  ECSRIRTN
  7669     IF CR-AH-TERM GREATER WT-AHTRM-HI                            ECSRIRTN
  7670         GO TO REINSURE-CK-AH-X.                                  ECSRIRTN
  7671                                                                  ECSRIRTN
  7672     MOVE 'Y' TO REIN-AH-FLG (SUB1).                              ECSRIRTN
  7673                                                                  ECSRIRTN
  7674     IF WT-AHBEN-LIM-LO = ZERO                                    ECSRIRTN
  7675         AND WT-AHBEN-LIM-HI = ZERO                               ECSRIRTN
  7676             MOVE +9999999.99 TO WT-AHBEN-LIM-LO                  ECSRIRTN
  7677                                 WT-AHBEN-LIM-HI.                 ECSRIRTN
  7678                                                                  ECSRIRTN
  7679     IF WT-AHMOA-LIM-LO = ZERO                                    ECSRIRTN
  7680         AND WT-AHMOA-LIM-HI = ZERO                               ECSRIRTN
  7681             MOVE +9999999.99 TO WT-AHMOA-LIM-LO                  ECSRIRTN
  7682                                 WT-AHMOA-LIM-HI.                 ECSRIRTN
  7683                                                                  ECSRIRTN
  7684     COMPUTE RW-AHLIM-LO = CR-AH-TERM * WT-AHMOA-LIM-LO.          ECSRIRTN
  7685     COMPUTE RW-AHLIM-HI = CR-AH-TERM * WT-AHMOA-LIM-HI.          ECSRIRTN
  7686                                                                  ECSRIRTN
  7687     IF RW-AHLIM-LO GREATER WT-AHBEN-LIM-LO                       ECSRIRTN
  7688         MOVE WT-AHBEN-LIM-LO TO RW-AHLIM-LO.                     ECSRIRTN
  7689                                                                  ECSRIRTN
  7690     IF RW-AHLIM-HI GREATER WT-AHBEN-LIM-HI                       ECSRIRTN
  7691         MOVE WT-AHBEN-LIM-HI TO RW-AHLIM-HI.                     ECSRIRTN
  7692                                                                  ECSRIRTN
  7693     MOVE RW-AHLIM-LO TO RWF-AH-LIMIT.                            ECSRIRTN
  7694                                                                  ECSRIRTN
  7695     COMPUTE RW-AHWRK = RS-AH-BEN * CR-AH-TERM.                   ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 160
* ECS150P.cbl (/apps/prod/cid1p/copy/ECSRIRTNP)
  7696                                                                  ECSRIRTN
  7697     IF RW-AHWRK NOT GREATER RW-AHLIM-LO                          ECSRIRTN
  7698         GO TO REINSURE-CK-AH-X.                                  ECSRIRTN
  7699                                                                  ECSRIRTN
  7700     IF RW-AHWRK GREATER RW-AHLIM-HI                              ECSRIRTN
  7701         GO TO REINSURE-CK-AH-X.                                  ECSRIRTN
  7702                                                                  ECSRIRTN
  7703     MOVE 'X' TO REIN-AH-FLG (SUB1).                              ECSRIRTN
  7704                                                                  ECSRIRTN
  7705 REINSURE-CK-AH-X.                                                ECSRIRTN
  7706     EXIT.                                                        ECSRIRTN
  7707                                                                  ECSRIRTN
  7708 REIN-CHECK-INTERACT-E.                                           ECSRIRTN
  7709                                                                  ECSRIRTN
  7710     IF RS-LIFE-BEN = ZERO  OR                                    ECSRIRTN
  7711        RS-AH-BEN = ZERO                                          ECSRIRTN
  7712         GO TO REIN-INTERACT-CHECK-X.                             ECSRIRTN
  7713                                                                  ECSRIRTN
  7714     IF REIN-LF-FLG (SUB1) NOT = 'X'  AND                         ECSRIRTN
  7715        REIN-AH-FLG (SUB1) NOT = 'X'                              ECSRIRTN
  7716         GO TO REIN-INTERACT-CHECK-X.                             ECSRIRTN
  7717                                                                  ECSRIRTN
  7718     MOVE 'X'                    TO REIN-LF-FLG (SUB1)            ECSRIRTN
  7719                                    REIN-AH-FLG (SUB1).           ECSRIRTN
  7720                                                                  ECSRIRTN
  7721     IF WT-AHBEN-LO = ZERO                                        ECSRIRTN
  7722         AND WT-AHBEN-HI = ZERO                                   ECSRIRTN
  7723             MOVE +9999999.99    TO  WT-AHBEN-LO                  ECSRIRTN
  7724                                     WT-AHBEN-HI.                 ECSRIRTN
  7725     IF WT-AHMOA-LO = ZERO                                        ECSRIRTN
  7726         AND WT-AHMOA-HI = ZERO                                   ECSRIRTN
  7727             MOVE +9999999.99    TO  WT-AHMOA-LO                  ECSRIRTN
  7728                                     WT-AHMOA-HI.                 ECSRIRTN
  7729                                                                  ECSRIRTN
  7730     COMPUTE RW-AHLIM-LO = CR-AH-TERM * WT-AHMOA-LO.              ECSRIRTN
  7731     COMPUTE RW-AHLIM-HI = CR-AH-TERM * WT-AHMOA-HI.              ECSRIRTN
  7732                                                                  ECSRIRTN
  7733     IF RW-AHLIM-LO GREATER WT-AHBEN-LO                           ECSRIRTN
  7734         MOVE WT-AHBEN-LO        TO  RW-AHLIM-LO.                 ECSRIRTN
  7735                                                                  ECSRIRTN
  7736     IF RW-AHLIM-HI GREATER WT-AHBEN-HI                           ECSRIRTN
  7737         MOVE WT-AHBEN-HI        TO  RW-AHLIM-HI.                 ECSRIRTN
  7738                                                                  ECSRIRTN
  7739     COMPUTE RW-AHWRK = RS-AH-BEN * CR-AH-TERM.                   ECSRIRTN
  7740                                                                  ECSRIRTN
  7741     IF RW-AHWRK GREATER RW-AHLIM-HI                              ECSRIRTN
  7742         MOVE RW-AHLIM-HI        TO  RW-AHWRK.                    ECSRIRTN
  7743                                                                  ECSRIRTN
  7744     IF RW-AHWRK GREATER RW-AHLIM-LO                              ECSRIRTN
  7745         COMPUTE RATE-WORK-A ROUNDED = (RW-AHWRK - RW-AHLIM-LO)   ECSRIRTN
  7746                                       / RW-AHWRK                 ECSRIRTN
  7747       ELSE                                                       ECSRIRTN
  7748         MOVE ZERO               TO RATE-WORK-A.                  ECSRIRTN
  7749                                                                  ECSRIRTN
  7750     IF RS-LIFE-BEN GREATER WT-LF-LO                              ECSRIRTN
  7751         COMPUTE RATE-WORK-L ROUNDED = (RS-LIFE-BEN - WT-LF-LO)   ECSRIRTN
  7752                                       / RS-LIFE-BEN              ECSRIRTN
  7753       ELSE                                                       ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 161
* ECS150P.cbl (/apps/prod/cid1p/copy/ECSRIRTNP)
  7754         MOVE ZERO               TO RATE-WORK-L.                  ECSRIRTN
  7755                                                                  ECSRIRTN
  7756     IF (RS-LIFE-BEN GREATER WT-LF-LO) AND                        ECSRIRTN
  7757        (RW-AHWRK NOT GREATER RW-AHLIM-LO)                        ECSRIRTN
  7758          MOVE 'E'               TO REIN-AH-FLG (SUB1)            ECSRIRTN
  7759          COMPUTE RWF-AHAMT ROUNDED = (RW-AHWRK * RATE-WORK-L)    ECSRIRTN
  7760                                      / CR-AH-TERM.               ECSRIRTN
  7761                                                                  ECSRIRTN
  7762     IF (RW-AHWRK GREATER RW-AHLIM-LO) AND                        ECSRIRTN
  7763        (RS-LIFE-BEN NOT GREATER WT-LF-LO)                        ECSRIRTN
  7764          MOVE 'E'               TO REIN-LF-FLG (SUB1)            ECSRIRTN
  7765          IF (RW-AHWRK - RW-AHLIM-LO) NOT GREATER RS-LIFE-BEN     ECSRIRTN
  7766               COMPUTE RWF-LFAMT = RW-AHWRK - RW-AHLIM-LO         ECSRIRTN
  7767            ELSE                                                  ECSRIRTN
  7768                MOVE RS-LIFE-BEN TO RWF-LFAMT.                    ECSRIRTN
  7769                                                                  ECSRIRTN
  7770     IF (RW-AHWRK GREATER RW-AHLIM-LO) AND                        ECSRIRTN
  7771        (RS-LIFE-BEN GREATER WT-LF-LO)                            ECSRIRTN
  7772        IF RATE-WORK-L GREATER RATE-WORK-A                        ECSRIRTN
  7773          MOVE 'E'               TO REIN-AH-FLG (SUB1)            ECSRIRTN
  7774          COMPUTE RWF-AHAMT ROUNDED = (RW-AHWRK * RATE-WORK-L)    ECSRIRTN
  7775                                      / CR-AH-TERM                ECSRIRTN
  7776         ELSE                                                     ECSRIRTN
  7777          MOVE 'E'               TO REIN-LF-FLG (SUB1)            ECSRIRTN
  7778          IF (RW-AHWRK - RW-AHLIM-LO) NOT GREATER RS-LIFE-BEN     ECSRIRTN
  7779               COMPUTE RWF-LFAMT = RW-AHWRK - RW-AHLIM-LO         ECSRIRTN
  7780            ELSE                                                  ECSRIRTN
  7781                MOVE RS-LIFE-BEN TO RWF-LFAMT.                    ECSRIRTN
  7782                                                                  ECSRIRTN
  7783 REIN-INTERACT-CHECK-X.                                           ECSRIRTN
  7784     EXIT.                                                        ECSRIRTN
  7785                                                                  ECSRIRTN
  7786                                                                  ECSRIRTN
  7787 REIN-CALC-LIFE.                                                  ECSRIRTN
  7788                                                                  ECSRIRTN
  7789     IF RS-LIFE-BEN NOT GREATER WT-LF-HI                          ECSRIRTN
  7790         MOVE RS-LIFE-BEN TO RWF-LFAMT                            ECSRIRTN
  7791     ELSE                                                         ECSRIRTN
  7792         MOVE WT-LF-HI TO RWF-LFAMT.                              ECSRIRTN
  7793                                                                  ECSRIRTN
  7794     IF RS-LIFE-BEN LESS WT-LF-LO                                 ECSRIRTN
  7795         MOVE +0 TO RWF-LFAMT                                     ECSRIRTN
  7796     ELSE                                                         ECSRIRTN
  7797         IF WT-REMAINING NOT = 'L'                                ECSRIRTN
  7798           IF RS-LIFE-BEN LESS THAN ZERO                          ECSRIRTN
  7799               COMPUTE RWF-LFAMT ROUNDED = WT-LF-PCT * RS-LIFE-BENECSRIRTN
  7800           ELSE                                                   ECSRIRTN
  7801               COMPUTE RWF-LFAMT ROUNDED = WT-LF-PCT *            ECSRIRTN
  7802                                          (RWF-LFAMT - WT-LF-LO). ECSRIRTN
  7803                                                                  ECSRIRTN
  7804 REIN-LF-SKIP-LIMIT.                                              ECSRIRTN
  7805                                                                  ECSRIRTN
  7806     MOVE +0 TO RW-LFPRM  RW-LFPRMC.                              ECSRIRTN
  7807                                                                  ECSRIRTN
  7808     IF WT-REMAINING = 'I'                                        ECSRIRTN
  7809         GO TO REIN-CALC-LF-RISK-PREM.                            ECSRIRTN
  7810                                                                  ECSRIRTN
  7811     IF WT-REMAINING = 'L'                                        ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 162
* ECS150P.cbl (/apps/prod/cid1p/copy/ECSRIRTNP)
  7812         COMPUTE RWF-LFPRM ROUNDED = RS-LIFE-PREM * WT-LF-PCT     ECSRIRTN
  7813         GO TO REIN-CALC-LIFE-X.                                  ECSRIRTN
  7814                                                                  ECSRIRTN
  7815     IF RS-LIFE-BEN NOT = ZERO                                    ECSRIRTN
  7816         COMPUTE RW-LFPRM ROUNDED = (RS-LIFE-PREM *               ECSRIRTN
  7817                   RWF-LFAMT) / RS-LIFE-BEN                       ECSRIRTN
  7818         COMPUTE RW-LFPRMC ROUNDED = (RS-LP-CALC *                ECSRIRTN
  7819                   RWF-LFAMT) / RS-LIFE-BEN                       ECSRIRTN
  7820     ELSE                                                         ECSRIRTN
  7821         IF WT-LF-LIM-LO = ZERO                                   ECSRIRTN
  7822             COMPUTE RW-LFPRM ROUNDED = RS-LIFE-PREM * WT-LF-PCT  ECSRIRTN
  7823             COMPUTE RW-LFPRMC ROUNDED = RS-LP-CALC * WT-LF-PCT.  ECSRIRTN
  7824                                                                  ECSRIRTN
  7825     IF ((WT-LF-QC = '1' OR '3') OR                                  CL**8
  7826         (WT-LF-QC = '2' AND                                         CL**8
  7827          PGM-SUB = +50  AND                                         CL**8
  7828          DTE-CLIENT = 'LAP'))                                       CL**8
  7829          MOVE RW-LFPRM TO RWF-LFPRM                                 CL**8
  7830     ELSE                                                         ECSRIRTN
  7831         MOVE RW-LFPRMC TO RWF-LFPRM.                             ECSRIRTN
  7832                                                                  ECSRIRTN
  7833     IF WT-REMAINING = 'Y' OR 'Z' OR 'X' OR 'N'                   ECSRIRTN
  7834         COMPUTE RS-R-LB = RS-R-LB - RWF-LFAMT                    ECSRIRTN
  7835         COMPUTE RS-R-LP = RS-R-LP - RW-LFPRM                     ECSRIRTN
  7836         COMPUTE RS-R-LPC = RS-R-LPC - RW-LFPRMC.                 ECSRIRTN
  7837                                                                  ECSRIRTN
  7838     GO TO REIN-CALC-LIFE-X.                                      ECSRIRTN
  7839                                                                  ECSRIRTN
  7840 REIN-CALC-LF-RISK-PREM.                                          ECSRIRTN
  7841                                                                  ECSRIRTN
  7842     IF RWF-LFAMT NOT GREATER THAN +0                             ECSRIRTN
  7843         MOVE ZEROS                 TO RWF-LFPRM                  ECSRIRTN
  7844         GO TO REIN-CALC-LIFE-X.                                  ECSRIRTN
  7845                                                                  ECSRIRTN
  7846     MOVE RWF-LFAMT                 TO REIN-RISK-AMOUNT.          ECSRIRTN
  7847     COMPUTE REIN-MONTH-REDUCE = RS-LIFE-BEN / CR-LF-TERM.        ECSRIRTN
  7848     MOVE +0                        TO REIN-WORKA                 ECSRIRTN
  7849                                       RW-LFPRM.                  ECSRIRTN
  7850                                                                  ECSRIRTN
  7851 REIN-LF-RISK-PREM-LOOP.                                          ECSRIRTN
  7852                                                                  ECSRIRTN
  7853     COMPUTE RW-LFPRM = RW-LFPRM +                                ECSRIRTN
  7854                ((REIN-RISK-AMOUNT / +1000) * CR-LF-NSP-PRM-RATE).ECSRIRTN
  7855                                                                  ECSRIRTN
  7856     IF CLAS-I-RL-AH (CLAS-INDEXL) NOT = 'L'                      ECSRIRTN
  7857        SUBTRACT REIN-MONTH-REDUCE FROM REIN-RISK-AMOUNT.         ECSRIRTN
  7858                                                                  ECSRIRTN
  7859     IF REIN-WORKA = REIN-EARN-LF-TERM  OR                        ECSRIRTN
  7860        REIN-RISK-AMOUNT LESS THAN +0                             ECSRIRTN
  7861         MOVE RW-LFPRM              TO RWF-LFPRM                  ECSRIRTN
  7862     ELSE                                                         ECSRIRTN
  7863         ADD +1 TO REIN-WORKA                                     ECSRIRTN
  7864         GO TO REIN-LF-RISK-PREM-LOOP.                            ECSRIRTN
  7865                                                                  ECSRIRTN
  7866                                                                  ECSRIRTN
  7867 REIN-CALC-LIFE-X.                                                ECSRIRTN
  7868     EXIT.                                                        ECSRIRTN
  7869                                                                  ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 163
* ECS150P.cbl (/apps/prod/cid1p/copy/ECSRIRTNP)
  7870 REIN-CALC-AH.                                                    ECSRIRTN
  7871                                                                  ECSRIRTN
  7872     IF WT-AHBEN-LO = ZERO                                        ECSRIRTN
  7873         AND WT-AHBEN-HI = ZERO                                   ECSRIRTN
  7874             MOVE +9999999.99 TO WT-AHBEN-LO                      ECSRIRTN
  7875                                 WT-AHBEN-HI.                     ECSRIRTN
  7876                                                                  ECSRIRTN
  7877     IF WT-AHMOA-LO = ZERO                                        ECSRIRTN
  7878         AND WT-AHMOA-HI = ZERO                                   ECSRIRTN
  7879             MOVE +9999999.99 TO WT-AHMOA-LO                      ECSRIRTN
  7880                                 WT-AHMOA-HI.                     ECSRIRTN
  7881                                                                  ECSRIRTN
  7882     COMPUTE RW-AHLIM-LO = CR-AH-TERM * WT-AHMOA-LO.              ECSRIRTN
  7883     COMPUTE RW-AHLIM-HI = CR-AH-TERM * WT-AHMOA-HI.              ECSRIRTN
  7884                                                                  ECSRIRTN
  7885     IF RW-AHLIM-LO GREATER WT-AHBEN-LO                           ECSRIRTN
  7886         MOVE WT-AHBEN-LO TO RW-AHLIM-LO.                         ECSRIRTN
  7887                                                                  ECSRIRTN
  7888     IF RW-AHLIM-HI GREATER WT-AHBEN-HI                           ECSRIRTN
  7889         MOVE WT-AHBEN-HI TO RW-AHLIM-HI.                         ECSRIRTN
  7890                                                                  ECSRIRTN
  7891     IF RW-AHWRK GREATER RW-AHLIM-HI                              ECSRIRTN
  7892         MOVE RW-AHLIM-HI TO RW-AHWRK.                            ECSRIRTN
  7893                                                                  ECSRIRTN
  7894     IF RW-AHWRK LESS RW-AHLIM-LO                                 ECSRIRTN
  7895         MOVE +0 TO RWF-AHAMT                                     ECSRIRTN
  7896     ELSE                                                         ECSRIRTN
  7897         IF WT-REMAINING = 'L'                                    ECSRIRTN
  7898             COMPUTE RWF-AHAMT ROUNDED = RW-AHWRK / CR-AH-TERM    ECSRIRTN
  7899         ELSE                                                     ECSRIRTN
  7900             COMPUTE RWF-AHAMT ROUNDED =                          ECSRIRTN
  7901             ((RW-AHWRK - RW-AHLIM-LO) / CR-AH-TERM) * WT-AH-PCT. ECSRIRTN
  7902                                                                  ECSRIRTN
  7903 REIN-AH-SKIP-LIMIT.                                              ECSRIRTN
  7904                                                                  ECSRIRTN
  7905     IF WT-REMAINING = 'I'                                        ECSRIRTN
  7906         GO TO REIN-CALC-AH-RISK-PREM.                            ECSRIRTN
  7907                                                                  ECSRIRTN
  7908     IF WT-REMAINING = 'L'                                        ECSRIRTN
  7909         COMPUTE RWF-AHPRM ROUNDED = RS-AH-PREM * WT-AH-PCT       ECSRIRTN
  7910         GO TO REIN-CALC-AH-X.                                    ECSRIRTN
  7911                                                                  ECSRIRTN
  7912     IF RS-AH-BEN NOT = ZERO                                      ECSRIRTN
  7913         COMPUTE RW-AHPRM ROUNDED = (RS-AH-PREM *                 ECSRIRTN
  7914                   RWF-AHAMT) / RS-AH-BEN                         ECSRIRTN
  7915         COMPUTE RW-AHPRMC ROUNDED = (RS-AP-CALC *                ECSRIRTN
  7916                   RWF-AHAMT) / RS-AH-BEN                         ECSRIRTN
  7917     ELSE                                                         ECSRIRTN
  7918         IF RW-AHLIM-LO = ZERO                                    ECSRIRTN
  7919             COMPUTE RW-AHPRM ROUNDED = RS-AH-PREM * WT-AH-PCT    ECSRIRTN
  7920             COMPUTE RW-AHPRMC ROUNDED = RS-AP-CALC * WT-AH-PCT.  ECSRIRTN
  7921                                                                  ECSRIRTN
  7922     IF ((WT-AH-QC = '1' OR '3') OR                                  CL**8
  7923         (WT-AH-QC = '2' AND                                         CL**8
  7924          PGM-SUB = +50  AND                                         CL**8
  7925          DTE-CLIENT = 'LAP'))                                       CL**8
  7926         MOVE RW-AHPRM TO RWF-AHPRM                               ECSRIRTN
  7927     ELSE                                                         ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 164
* ECS150P.cbl (/apps/prod/cid1p/copy/ECSRIRTNP)
  7928         MOVE RW-AHPRMC TO RWF-AHPRM.                             ECSRIRTN
  7929                                                                  ECSRIRTN
  7930     IF RE-NSP-ST-CD-AH = SPACES OR ZERO                          ECSRIRTN
  7931         IF (WT-REMAINING = 'Y' OR 'Z') AND (WT-AH-QC = '1')      ECSRIRTN
  7932            AND (RWF-AHAMT = RS-R-AB) AND (RWF-AHAMT NOT = +0)    ECSRIRTN
  7933                MOVE 'Y' TO RWF-REM-AH-100.                       ECSRIRTN
  7934                                                                  ECSRIRTN
  7935     IF WT-REMAINING = 'Y' OR 'Z' OR 'X' OR 'N'                   ECSRIRTN
  7936         COMPUTE RS-R-AB = RS-R-AB - RWF-AHAMT                    ECSRIRTN
  7937         COMPUTE RS-R-AP = RS-R-AP - RW-AHPRM                     ECSRIRTN
  7938         COMPUTE RS-R-APC = RS-R-APC - RW-AHPRMC.                 ECSRIRTN
  7939                                                                  ECSRIRTN
  7940     GO TO REIN-CALC-AH-X.                                        ECSRIRTN
  7941                                                                  ECSRIRTN
  7942 REIN-CALC-AH-RISK-PREM.                                          ECSRIRTN
  7943                                                                  ECSRIRTN
  7944     IF RWF-AHAMT NOT GREATER THAN +0                             ECSRIRTN
  7945         MOVE ZEROS                 TO RWF-AHPRM                  ECSRIRTN
  7946         GO TO REIN-CALC-AH-X.                                    ECSRIRTN
  7947                                                                  ECSRIRTN
  7948     COMPUTE REIN-RISK-AMOUNT = RWF-AHAMT * CR-AH-TERM.           ECSRIRTN
  7949     MOVE RS-AH-BEN              TO REIN-MONTH-REDUCE.            ECSRIRTN
  7950     MOVE +0                     TO REIN-WORKA                    ECSRIRTN
  7951                                    RW-AHPRM.                     ECSRIRTN
  7952                                                                  ECSRIRTN
  7953 REIN-AH-RISK-PREM-LOOP.                                          ECSRIRTN
  7954                                                                  ECSRIRTN
  7955     COMPUTE RW-AHPRM = RW-AHPRM +                                ECSRIRTN
  7956                ((REIN-RISK-AMOUNT / +1000) * CR-AH-NSP-PRM-RATE).ECSRIRTN
  7957                                                                  ECSRIRTN
  7958     SUBTRACT REIN-MONTH-REDUCE FROM REIN-RISK-AMOUNT.            ECSRIRTN
  7959                                                                  ECSRIRTN
  7960     IF REIN-WORKA = REIN-EARN-AH-TERM  OR                        ECSRIRTN
  7961        REIN-RISK-AMOUNT LESS THAN +0                             ECSRIRTN
  7962         MOVE RW-AHPRM          TO RWF-AHPRM                      ECSRIRTN
  7963     ELSE                                                         ECSRIRTN
  7964         ADD +1 TO REIN-WORKA                                     ECSRIRTN
  7965         GO TO REIN-AH-RISK-PREM-LOOP.                            ECSRIRTN
  7966                                                                  ECSRIRTN
  7967                                                                  ECSRIRTN
  7968 REIN-CALC-AH-X.                                                  ECSRIRTN
  7969     EXIT.                                                        ECSRIRTN
  7970                                                                  ECSRIRTN
  7971 REINSURE-CALC-REMAINDER.                                         ECSRIRTN
  7972                                                                  ECSRIRTN
  7973     COMPUTE RWF-LFAMT = CR-LFAMT + CR-LFAMT-ALT.                 ECSRIRTN
  7974     COMPUTE RWF-LFPRM = CR-LFPRM + CR-LFPRM-ALT.                 ECSRIRTN
  7975     MOVE CR-AHAMT TO RWF-AHAMT.                                  ECSRIRTN
  7976     MOVE CR-AHPRM TO RWF-AHPRM.                                  ECSRIRTN
  7977                                                                  ECSRIRTN
  7978     PERFORM REINSURE-SUBTRACT THRU REINSURE-SUBTRACT-X           ECSRIRTN
  7979         VARYING SUB2 FROM +1 BY +1 UNTIL SUB2 = SUB1.            ECSRIRTN
  7980                                                                  ECSRIRTN
  7981     IF RWF-LFAMT NOT = ZEROS OR                                  ECSRIRTN
  7982        RWF-LFPRM NOT = ZEROS                                     ECSRIRTN
  7983           MOVE 'X' TO REIN-LF-FLG (SUB1).                        ECSRIRTN
  7984                                                                  ECSRIRTN
  7985     IF RWF-AHAMT NOT = ZEROS OR                                  ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 165
* ECS150P.cbl (/apps/prod/cid1p/copy/ECSRIRTNP)
  7986        RWF-AHPRM NOT = ZEROS                                     ECSRIRTN
  7987           MOVE 'X' TO REIN-AH-FLG (SUB1).                        ECSRIRTN
  7988                                                                  ECSRIRTN
  7989 REINSURE-CALC-X.                                                 ECSRIRTN
  7990                                                                  ECSRIRTN
  7991     IF REIN-LF-AH-FLGS (SUB1) NOT = SPACES                       ECSRIRTN
  7992         MOVE 'X' TO REIN-BUS-FLAG.                               ECSRIRTN
  7993                                                                  ECSRIRTN
  7994     MOVE RWF-FIELDS TO REIN-WORK-FLDS (SUB1).                    ECSRIRTN
  7995                                                                  ECSRIRTN
  7996 REINSURE-SUBTRACT.                                               ECSRIRTN
  7997                                                                  ECSRIRTN
  7998     SUBTRACT REIN-LFAMT (SUB2) FROM RWF-LFAMT.                   ECSRIRTN
  7999     SUBTRACT REIN-LFPRM (SUB2) FROM RWF-LFPRM.                   ECSRIRTN
  8000     SUBTRACT REIN-AHAMT (SUB2) FROM RWF-AHAMT.                   ECSRIRTN
  8001     SUBTRACT REIN-AHPRM (SUB2) FROM RWF-AHPRM.                   ECSRIRTN
  8002                                                                  ECSRIRTN
  8003 REINSURE-SUBTRACT-X.                                             ECSRIRTN
  8004     EXIT.                                                        ECSRIRTN
  8005                                                                  ECSRIRTN
  8006 REINSURE-CALC-CANCEL.                                            ECSRIRTN
  8007                                                                  ECSRIRTN
  8008     MOVE REIN-WORK-FLDS (SUB1) TO RWF-FIELDS.                    ECSRIRTN
  8009     MOVE RE-COMP-INFO (SUB1) TO WT-COMP-INFO.                    ECSRIRTN
  8010                                                                  ECSRIRTN
  8011     IF SUB1 = RE-100-COMP                                        ECSRIRTN
  8012         GO TO REINSURE-REMAINDER-CANCEL.                         ECSRIRTN
  8013                                                                  ECSRIRTN
  8014     IF REIN-LF-FLG (SUB1) NOT = 'X'                              ECSRIRTN
  8015         GO TO REINSURE-CALC-CANCEL-AH.                           ECSRIRTN
  8016                                                                  ECSRIRTN
  8017     IF RWF-LF-RUNOFF-SW = 'N'
  8018        IF CR-LF-CANC-DT NOT LESS THAN RWF-EP-STOP-DATE
  8019           GO TO REINSURE-CALC-CANCEL-AH
  8020        END-IF
  8021     END-IF
  8022                                                                  ECSRIRTN
  8023     IF WT-REMAINING = 'I'                                        ECSRIRTN
  8024         GO TO REINSURE-CALC-LF-RISK-CANCEL.                      ECSRIRTN
  8025                                                                  ECSRIRTN
  8026     IF WT-REMAINING = 'L'                                        ECSRIRTN
  8027         COMPUTE RWF-LFRFND ROUNDED = CR-LFRFND * WT-LF-PCT       ECSRIRTN
  8028         GO TO REINSURE-CALC-CANCEL-AH.                           ECSRIRTN
  8029                                                                  ECSRIRTN
  8030     IF CR-LFPRM = ZERO                                           ECSRIRTN
  8031        MOVE ZERO                TO REIN-FACTOR
  8032     ELSE                                                         ECSRIRTN
  8033        IF DTE-CLIENT = 'GIC'  AND
  8034           CLAS-I-BAL (CLAS-INDEXL) = 'B'
  8035           MOVE +1.0             TO REIN-FACTOR
  8036        ELSE
  8037           IF DTE-CLIENT = 'DCC'
  8038              COMPUTE REIN-FACTOR = CR-LFRFND /
  8039                 (CR-LFPRM + CR-LFPRM-ALT)
  8040           ELSE
  8041              COMPUTE REIN-FACTOR ROUNDED =  CR-LFRFND-CALC /
  8042                 (CR-LFPRM + CR-LFPRM-ALT)
  8043            END-IF
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 166
* ECS150P.cbl (/apps/prod/cid1p/copy/ECSRIRTNP)
  8044         END-IF
  8045     END-IF
  8046                                                                  ECSRIRTN
  8047     IF CR-LFAMT NOT = ZERO                                       ECSRIRTN
  8048         IF DTE-CLIENT = 'GTL'  OR  'UAL'  OR  'NCL'  OR  'CVL'   ECSRIRTN
  8049             IF WT-LF-QC = ('1' OR '4')                           ECSRIRTN
  8050                 COMPUTE RWF-LFRFND ROUNDED =  ((CR-LFRFND *      ECSRIRTN
  8051                         RWF-LFAMT) / (CR-LFAMT + CR-LFAMT-ALT))  ECSRIRTN
  8052             ELSE                                                 ECSRIRTN
  8053                 COMPUTE RWF-LFRFND =                             ECSRIRTN
  8054                            REIN-FACTOR * REIN-CALCED-LIFE        ECSRIRTN
  8055                 COMPUTE RWF-LFRFND ROUNDED =  ((RWF-LFRFND *     ECSRIRTN
  8056                         RWF-LFAMT) / (CR-LFAMT + CR-LFAMT-ALT))  ECSRIRTN
  8057         ELSE                                                     ECSRIRTN
  8058             IF WT-LF-QC = ('1' OR '4')                           ECSRIRTN
  8059                 COMPUTE RWF-LFRFND ROUNDED =  CR-LFRFND *        ECSRIRTN
  8060                        (RWF-LFAMT / (CR-LFAMT + CR-LFAMT-ALT))   ECSRIRTN
  8061             ELSE                                                 ECSRIRTN
  8062*                COMPUTE RWF-LFRFND = REIN-FACTOR
  8063*                   * REIN-CALCED-LIFE *
  8064*                   (RWF-LFAMT / (CR-LFAMT + CR-LFAMT-ALT)).
  8065                 COMPUTE RWF-LFRFND =                             ECSRIRTN
  8066                            REIN-FACTOR * REIN-CALCED-LIFE        ECSRIRTN
  8067                 COMPUTE RWF-LFRFND ROUNDED =  (RWF-LFRFND *
  8068                        RWF-LFAMT) / (CR-LFAMT + CR-LFAMT-ALT).
  8069                                                                  ECSRIRTN
  8070     IF CR-LFAMT = ZERO                                           ECSRIRTN
  8071         IF WT-LF-LIM-LO = ZERO                                   ECSRIRTN
  8072             IF WT-LF-QC = ('1' OR '4')                           ECSRIRTN
  8073                 COMPUTE RWF-LFRFND ROUNDED =                     ECSRIRTN
  8074                       CR-LFRFND * WT-LF-PCT                      ECSRIRTN
  8075             ELSE                                                 ECSRIRTN
  8076                 COMPUTE RWF-LFRFND =                             ECSRIRTN
  8077                            REIN-FACTOR * REIN-CALCED-LIFE        ECSRIRTN
  8078                 COMPUTE RWF-LFRFND ROUNDED =                     ECSRIRTN
  8079                       RWF-LFRFND * WT-LF-PCT.                    ECSRIRTN
  8080                                                                  ECSRIRTN
  8081     GO TO REINSURE-CALC-CANCEL-AH.                               ECSRIRTN
  8082                                                                  ECSRIRTN
  8083                                                                  ECSRIRTN
  8084 REINSURE-CALC-LF-RISK-CANCEL.                                    ECSRIRTN
  8085                                                                  ECSRIRTN
  8086     IF RWF-LFAMT NOT GREATER THAN +0  OR                         ECSRIRTN
  8087       (CR-LF-CANC-DT = ZEROS)                                       CL*10
  8088         MOVE ZERO                    TO RWF-LFRFND               ECSRIRTN
  8089         GO TO REINSURE-CALC-CANCEL-AH.                           ECSRIRTN
  8090                                                                  ECSRIRTN
  8091     IF REIN-RT-SW NOT = 'X'                                      ECSRIRTN
  8092       IF VOIDING-LF-CANCEL                                       ECSRIRTN
  8093           COMPUTE RWF-LFRFND = RWF-LFRFND * (-1)                 ECSRIRTN
  8094           GO TO REINSURE-CALC-CANCEL-AH                          ECSRIRTN
  8095       ELSE                                                       ECSRIRTN
  8096           IF ADDITIONAL-LF-CANCEL                                ECSRIRTN
  8097               GO TO REINSURE-CALC-CANCEL-AH.                     ECSRIRTN
  8098                                                                  ECSRIRTN
  8099     IF FLAT-CANCEL-LF                                            ECSRIRTN
  8100         MOVE RWF-LFPRM               TO RWF-LFRFND               ECSRIRTN
  8101         GO TO REINSURE-CALC-CANCEL-AH.                           ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 167
* ECS150P.cbl (/apps/prod/cid1p/copy/ECSRIRTNP)
  8102                                                                  ECSRIRTN
  8103     IF REIN-EARN-LF-TERM = REIN-LCNC-EARN-TERM                   ECSRIRTN
  8104         MOVE ZERO                    TO RWF-LFRFND               ECSRIRTN
  8105         GO TO REINSURE-CALC-CANCEL-AH.                           ECSRIRTN
  8106                                                                  ECSRIRTN
  8107     MOVE RWF-LFAMT                   TO REIN-RISK-AMOUNT.        ECSRIRTN
  8108     COMPUTE REIN-MONTH-REDUCE = RS-LIFE-BEN / CR-LF-TERM.        ECSRIRTN
  8109     MOVE +0                          TO REIN-WORKA               ECSRIRTN
  8110                                         RW-LFRFND.               ECSRIRTN
  8111                                                                  ECSRIRTN
  8112 REINSURE-LF-RISK-CANCEL-LOOP.                                    ECSRIRTN
  8113                                                                  ECSRIRTN
  8114     COMPUTE RW-LFRFND = RW-LFRFND +                              ECSRIRTN
  8115                ((REIN-RISK-AMOUNT / +1000) * CR-LF-NSP-PRM-RATE).ECSRIRTN
  8116                                                                  ECSRIRTN
  8117     IF CLAS-I-RL-AH (CLAS-INDEXL) NOT = 'L'                      ECSRIRTN
  8118        SUBTRACT REIN-MONTH-REDUCE FROM REIN-RISK-AMOUNT.         ECSRIRTN
  8119                                                                  ECSRIRTN
  8120     IF REIN-WORKA = REIN-LCNC-EARN-TERM  OR                      ECSRIRTN
  8121        REIN-RISK-AMOUNT LESS THAN +0                             ECSRIRTN
  8122         COMPUTE RWF-LFRFND = RWF-LFPRM - RW-LFRFND               ECSRIRTN
  8123     ELSE                                                         ECSRIRTN
  8124         ADD +1 TO REIN-WORKA                                     ECSRIRTN
  8125         GO TO REINSURE-LF-RISK-CANCEL-LOOP.                      ECSRIRTN
  8126                                                                  ECSRIRTN
  8127                                                                  ECSRIRTN
  8128 REINSURE-CALC-CANCEL-AH.                                         ECSRIRTN
  8129                                                                  ECSRIRTN
  8130     IF REIN-AH-FLG (SUB1) NOT = 'X'                              ECSRIRTN
  8131         GO TO REINSURE-CALC-CANCEL-SKIP.                         ECSRIRTN
  8132                                                                  ECSRIRTN
  8133     IF RWF-AH-RUNOFF-SW = 'N'
  8134        IF CR-AH-CANC-DT NOT LESS THAN RWF-EP-STOP-DATE
  8135           GO TO REINSURE-CALC-CANCEL-SKIP
  8136        END-IF
  8137     END-IF
  8138                                                                  ECSRIRTN
  8139     IF RWF-REM-AH-100 = 'Y'                                      ECSRIRTN
  8140         MOVE CR-AHRFND TO RWF-AHRFND                             ECSRIRTN
  8141         PERFORM REINSURE-SUB-REM-CANCEL THRU                     ECSRIRTN
  8142             REINSURE-SUB-REM-CANCEL-X                            ECSRIRTN
  8143                 VARYING SUB2 FROM +1 BY +1 UNTIL SUB2 = SUB1     ECSRIRTN
  8144         GO TO REINSURE-CALC-CANCEL-SKIP.                         ECSRIRTN
  8145                                                                  ECSRIRTN
  8146     IF WT-REMAINING = 'I'                                        ECSRIRTN
  8147         GO TO REINSURE-CALC-AH-RISK-CANCEL.                      ECSRIRTN
  8148                                                                  ECSRIRTN
  8149     IF WT-REMAINING = 'L'                                        ECSRIRTN
  8150         COMPUTE RWF-AHRFND ROUNDED = CR-AHRFND * WT-AH-PCT       ECSRIRTN
  8151         GO TO REINSURE-CALC-CANCEL-SKIP.                         ECSRIRTN
  8152                                                                  ECSRIRTN
  8153     IF CR-AHPRM = ZERO                                           ECSRIRTN
  8154        MOVE ZERO                TO REIN-FACTOR
  8155     ELSE
  8156        IF DTE-CLIENT = 'GIC'  AND
  8157           CLAS-I-BAL (CLAS-INDEXA) = 'B'
  8158            MOVE +1.0            TO REIN-FACTOR
  8159        ELSE
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 168
* ECS150P.cbl (/apps/prod/cid1p/copy/ECSRIRTNP)
  8160           IF DTE-CLIENT = 'DCC'
  8161              COMPUTE REIN-FACTOR =
  8162                 CR-AHRFND / CR-AHPRM
  8163           ELSE
  8164              COMPUTE REIN-FACTOR ROUNDED =
  8165                                CR-AHRFND-CALC / CR-AHPRM
  8166           END-IF
  8167        END-IF
  8168     END-IF
  8169                                                                  ECSRIRTN
  8170     IF CR-AHAMT NOT = ZERO                                       ECSRIRTN
  8171         IF WT-AH-QC = ('1' OR '4')                               ECSRIRTN
  8172             COMPUTE RWF-AHRFND ROUNDED = (CR-AHRFND *            ECSRIRTN
  8173                       RWF-AHAMT) / CR-AHAMT                      ECSRIRTN
  8174         ELSE                                                     ECSRIRTN
  8175             COMPUTE RWF-AHRFND = REIN-FACTOR * REIN-CALCED-AH    ECSRIRTN
  8176             COMPUTE RWF-AHRFND ROUNDED = (RWF-AHRFND *           ECSRIRTN
  8177                       RWF-AHAMT) / CR-AHAMT                      ECSRIRTN
  8178     ELSE                                                         ECSRIRTN
  8179         IF RWF-AH-LIMIT = ZERO                                   ECSRIRTN
  8180             IF WT-AH-QC = ('1' OR '4')                           ECSRIRTN
  8181                 COMPUTE RWF-AHRFND ROUNDED =                     ECSRIRTN
  8182                       CR-AHRFND * WT-AH-PCT                      ECSRIRTN
  8183             ELSE                                                 ECSRIRTN
  8184                 COMPUTE RWF-AHRFND =                             ECSRIRTN
  8185                            REIN-FACTOR * REIN-CALCED-AH          ECSRIRTN
  8186                 COMPUTE RWF-AHRFND ROUNDED =                     ECSRIRTN
  8187                       RWF-AHRFND * WT-AH-PCT.                    ECSRIRTN
  8188                                                                  ECSRIRTN
  8189     GO TO REINSURE-CALC-CANCEL-SKIP.                             ECSRIRTN
  8190                                                                  ECSRIRTN
  8191                                                                  ECSRIRTN
  8192 REINSURE-CALC-AH-RISK-CANCEL.                                    ECSRIRTN
  8193                                                                  ECSRIRTN
  8194     IF RWF-AHAMT NOT GREATER THAN +0  OR                         ECSRIRTN
  8195       (CR-AH-CANC-DT = ZEROS)                                       CL*10
  8196         MOVE ZERO                    TO RWF-AHRFND               ECSRIRTN
  8197         GO TO REINSURE-CALC-CANCEL-SKIP.                         ECSRIRTN
  8198                                                                  ECSRIRTN
  8199     IF REIN-RT-SW NOT = 'X'                                      ECSRIRTN
  8200       IF VOIDING-AH-CANCEL                                       ECSRIRTN
  8201           COMPUTE RWF-AHRFND = RWF-AHRFND * (-1)                 ECSRIRTN
  8202           GO TO REINSURE-CALC-CANCEL-SKIP                        ECSRIRTN
  8203       ELSE                                                       ECSRIRTN
  8204           IF ADDITIONAL-AH-CANCEL                                ECSRIRTN
  8205               GO TO REINSURE-CALC-CANCEL-SKIP.                   ECSRIRTN
  8206                                                                  ECSRIRTN
  8207     IF FLAT-CANCEL-AH                                            ECSRIRTN
  8208         MOVE RWF-AHPRM               TO RWF-AHRFND               ECSRIRTN
  8209         GO TO REINSURE-CALC-CANCEL-SKIP.                         ECSRIRTN
  8210                                                                  ECSRIRTN
  8211     IF REIN-EARN-AH-TERM = REIN-ACNC-EARN-TERM                   ECSRIRTN
  8212         MOVE ZERO                    TO RWF-AHRFND               ECSRIRTN
  8213         GO TO REINSURE-CALC-CANCEL-SKIP.                         ECSRIRTN
  8214                                                                  ECSRIRTN
  8215     MOVE RS-AH-BEN              TO REIN-MONTH-REDUCE.            ECSRIRTN
  8216     COMPUTE REIN-RISK-AMOUNT = RWF-AHAMT * CR-AH-TERM.           ECSRIRTN
  8217     MOVE +0                     TO REIN-WORKA                    ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 169
* ECS150P.cbl (/apps/prod/cid1p/copy/ECSRIRTNP)
  8218                                    RW-AHRFND.                    ECSRIRTN
  8219                                                                  ECSRIRTN
  8220 REINSURE-AH-RISK-CANCEL-LOOP.                                    ECSRIRTN
  8221                                                                  ECSRIRTN
  8222     COMPUTE RW-AHRFND = RW-AHRFND +                              ECSRIRTN
  8223                ((REIN-RISK-AMOUNT / +1000) * CR-AH-NSP-PRM-RATE).ECSRIRTN
  8224                                                                  ECSRIRTN
  8225     SUBTRACT REIN-MONTH-REDUCE FROM REIN-RISK-AMOUNT.            ECSRIRTN
  8226                                                                  ECSRIRTN
  8227     IF REIN-WORKA = REIN-ACNC-EARN-TERM  OR                      ECSRIRTN
  8228        REIN-RISK-AMOUNT LESS THAN +0                             ECSRIRTN
  8229         COMPUTE RWF-AHRFND = RWF-AHPRM - RW-AHRFND               ECSRIRTN
  8230     ELSE                                                         ECSRIRTN
  8231         ADD +1 TO REIN-WORKA                                     ECSRIRTN
  8232         GO TO REINSURE-AH-RISK-CANCEL-LOOP.                      ECSRIRTN
  8233                                                                  ECSRIRTN
  8234                                                                  ECSRIRTN
  8235 REINSURE-CALC-CANCEL-SKIP.                                       ECSRIRTN
  8236                                                                  ECSRIRTN
  8237     IF RWF-LFRFND NOT = ZEROS                                    ECSRIRTN
  8238         MOVE 'X' TO REIN-LF-FLG (SUB1).                          ECSRIRTN
  8239                                                                  ECSRIRTN
  8240     IF RWF-AHRFND NOT = ZEROS                                    ECSRIRTN
  8241         MOVE 'X' TO REIN-AH-FLG (SUB1).                          ECSRIRTN
  8242                                                                  ECSRIRTN
  8243     GO TO REINSURE-CALC-CANCEL-X.                                ECSRIRTN
  8244                                                                  ECSRIRTN
  8245 REINSURE-REMAINDER-CANCEL.                                       ECSRIRTN
  8246                                                                  ECSRIRTN
  8247     MOVE CR-LFRFND TO RWF-LFRFND.                                ECSRIRTN
  8248     MOVE CR-AHRFND TO RWF-AHRFND.                                ECSRIRTN
  8249                                                                  ECSRIRTN
  8250     PERFORM REINSURE-SUBTRACT-CANCEL THRU                        ECSRIRTN
  8251         REINSURE-SUBTRACT-CANCEL-X                               ECSRIRTN
  8252             VARYING SUB2 FROM +1 BY +1 UNTIL SUB2 = SUB1.        ECSRIRTN
  8253                                                                  ECSRIRTN
  8254     IF RWF-LFRFND NOT = ZEROS                                    ECSRIRTN
  8255         MOVE 'X' TO REIN-LF-FLG (SUB1).                          ECSRIRTN
  8256                                                                  ECSRIRTN
  8257     IF RWF-AHRFND NOT = ZEROS                                    ECSRIRTN
  8258         MOVE 'X' TO REIN-AH-FLG (SUB1).                          ECSRIRTN
  8259                                                                  ECSRIRTN
  8260 REINSURE-CALC-CANCEL-X.                                          ECSRIRTN
  8261                                                                  ECSRIRTN
  8262     IF REIN-LF-AH-FLGS (SUB1) NOT = SPACES                       ECSRIRTN
  8263         MOVE 'X' TO REIN-BUS-FLAG.                               ECSRIRTN
  8264                                                                  ECSRIRTN
  8265     MOVE RWF-FIELDS TO REIN-WORK-FLDS (SUB1).                    ECSRIRTN
  8266                                                                  ECSRIRTN
  8267 REINSURE-SUBTRACT-CANCEL.                                        ECSRIRTN
  8268                                                                  ECSRIRTN
  8269     SUBTRACT REIN-LFRFND (SUB2) FROM RWF-LFRFND.                 ECSRIRTN
  8270     SUBTRACT REIN-AHRFND (SUB2) FROM RWF-AHRFND.                 ECSRIRTN
  8271                                                                  ECSRIRTN
  8272 REINSURE-SUBTRACT-CANCEL-X.                                      ECSRIRTN
  8273     EXIT.                                                        ECSRIRTN
  8274                                                                  ECSRIRTN
  8275 REINSURE-SUB-REM-CANCEL.                                         ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 170
* ECS150P.cbl (/apps/prod/cid1p/copy/ECSRIRTNP)
  8276                                                                  ECSRIRTN
  8277     IF REIN-REM-SW (SUB2) = 'Y' OR 'Z' OR 'X' OR 'N'             ECSRIRTN
  8278         SUBTRACT REIN-AHRFND (SUB2) FROM RWF-AHRFND.             ECSRIRTN
  8279                                                                  ECSRIRTN
  8280 REINSURE-SUB-REM-CANCEL-X.                                       ECSRIRTN
  8281     EXIT.                                                        ECSRIRTN
  8282                                                                  ECSRIRTN
  8283 REINSURE-CALC-CLAIM.                                             ECSRIRTN
  8284                                                                  ECSRIRTN
  8285     MOVE REIN-WORK-FLDS (SUB1) TO RWF-FIELDS.                    ECSRIRTN
  8286     MOVE RE-COMP-INFO (SUB1) TO WT-COMP-INFO.                    ECSRIRTN
  8287                                                                  ECSRIRTN
  8288     IF SUB1 = RE-100-COMP                                        ECSRIRTN
  8289         GO TO REINSURE-REMAINDER-CLAIM.                          ECSRIRTN
  8290                                                                  ECSRIRTN
  8291     PERFORM REIN-FIND-CO-LOOP THRU FIND-REI-CO-EXIT              ECSRIRTN
  8292        VARYING CO-SUB FROM 1 BY 1 UNTIL                          ECSRIRTN
  8293          (RCT-REIN-CO (CO-SUB) = REIN-COMP (SUB1))  OR           ECSRIRTN
  8294          (CO-SUB GREATER REIN-CO-TABLE-ENT-CNT)     OR           ECSRIRTN
  8295          (RCT-REIN-CO (CO-SUB) = SPACES).                        ECSRIRTN
  8296                                                                  ECSRIRTN
  8297     IF (CO-SUB GREATER REIN-CO-TABLE-ENT-CNT)  OR                ECSRIRTN
  8298        (RCT-REIN-CO (CO-SUB) = SPACES)                           ECSRIRTN
  8299          MOVE ZERO TO CO-SUB.                                    ECSRIRTN
  8300                                                                  ECSRIRTN
  8301     MOVE ZEROS                TO RWF-LFCLML                      ECSRIRTN
  8302                                  RWF-AHCLML.                     ECSRIRTN
  8303                                                                  ECSRIRTN
  8304     IF REIN-LF-FLG (SUB1) NOT = 'X'                              ECSRIRTN
  8305         GO TO REINSURE-CALC-CLAIM-AH.                            ECSRIRTN
  8306                                                                  ECSRIRTN
  8307     IF RW-LFCLMWK = ZEROS                                        ECSRIRTN
  8308         GO TO REINSURE-CALC-CLAIM-AH.                            ECSRIRTN
  8309                                                                  ECSRIRTN
  8310     IF CO-SUB NOT = ZERO                                         ECSRIRTN
  8311         IF RCT-CLM-CUTOFF-DT (CO-SUB) NOT = ZERO                 ECSRIRTN
  8312             IF CR-DTH-DT LESS RCT-CLM-CUTOFF-DT (CO-SUB)         ECSRIRTN
  8313                 GO TO REINSURE-CALC-CLAIM-AH.                    ECSRIRTN
  8314                                                                  ECSRIRTN
  8315     IF RWF-LF-RUNOFF-SW = 'N'
  8316        IF CR-DTH-DT NOT LESS THAN RWF-EP-STOP-DATE
  8317           GO TO REINSURE-CALC-CLAIM-AH
  8318        END-IF
  8319     END-IF
  8320
  8321     IF WT-REMAINING = 'I'                                        ECSRIRTN
  8322         GO TO REINSURE-CALC-LF-RISK-CLAIM.                       ECSRIRTN
  8323                                                                  ECSRIRTN
  8324     IF WT-REMAINING = 'L'                                        ECSRIRTN
  8325         IF REIN-RT-SW = 'X'                                      ECSRIRTN
  8326             IF RW-LFCLMWK GREATER WT-LF-HI                       ECSRIRTN
  8327                 MOVE WT-LF-HI TO RWF-LFCLM                       ECSRIRTN
  8328             ELSE                                                 ECSRIRTN
  8329                 MOVE RW-LFCLMWK TO RWF-LFCLM                     ECSRIRTN
  8330         ELSE                                                     ECSRIRTN
  8331             IF (RW-LFCLMWK + RWF-LFCLM) GREATER WT-LF-HI         ECSRIRTN
  8332                 COMPUTE RWF-LFCLML = WT-LF-HI - RWF-LFCLM        ECSRIRTN
  8333                 MOVE WT-LF-HI TO RWF-LFCLM                       ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 171
* ECS150P.cbl (/apps/prod/cid1p/copy/ECSRIRTNP)
  8334             ELSE                                                 ECSRIRTN
  8335                 MOVE RW-LFCLMWK TO RWF-LFCLML                    ECSRIRTN
  8336                 ADD RWF-LFCLML TO RWF-LFCLM.                     ECSRIRTN
  8337                                                                  ECSRIRTN
  8338     IF WT-REMAINING = 'L'                                        ECSRIRTN
  8339         GO TO REINSURE-CALC-CLAIM-AH.                            ECSRIRTN
  8340                                                                  ECSRIRTN
  8341     IF CR-LFAMT NOT = ZERO                                       ECSRIRTN
  8342         IF DTE-CLIENT = 'GTL'  OR  'UAL'  OR  'NCL'  OR  'CVL'   ECSRIRTN
  8343            OR 'DCC'
  8344             COMPUTE RWF-LFCLML ROUNDED =  ((RW-LFCLMWK *         ECSRIRTN
  8345                         RWF-LFAMT) / (CR-LFAMT + CR-LFAMT-ALT))  ECSRIRTN
  8346         ELSE                                                     ECSRIRTN
  8347             COMPUTE RWF-LFCLML ROUNDED =  RW-LFCLMWK *           ECSRIRTN
  8348                        (RWF-LFAMT / (CR-LFAMT + CR-LFAMT-ALT)).  ECSRIRTN
  8349                                                                  ECSRIRTN
  8350     IF CR-LFAMT = ZERO                                           ECSRIRTN
  8351         IF WT-LF-LIM-LO = ZERO                                   ECSRIRTN
  8352             COMPUTE RWF-LFCLML ROUNDED =                         ECSRIRTN
  8353                       RW-LFCLMWK * WT-LF-PCT.                    ECSRIRTN
  8354                                                                  ECSRIRTN
  8355     IF CO-SUB NOT = ZERO                                         ECSRIRTN
  8356         IF RCT-LF-CLM-PCT (CO-SUB) NOT = ZERO                    ECSRIRTN
  8357             COMPUTE RWF-LFCLML ROUNDED =                         ECSRIRTN
  8358                          RW-LFCLMWK * RCT-LF-CLM-PCT (CO-SUB).   ECSRIRTN
  8359                                                                  ECSRIRTN
  8360     IF CO-SUB NOT = ZERO                                         ECSRIRTN
  8361         IF RCT-LF-CLM-MAX (CO-SUB) NOT = ZERO                    ECSRIRTN
  8362             IF REIN-RT-SW = 'X'                                  ECSRIRTN
  8363               IF RWF-LFCLML GREATER RCT-LF-CLM-MAX (CO-SUB)      ECSRIRTN
  8364                     MOVE RCT-LF-CLM-MAX (CO-SUB) TO RWF-LFCLM    ECSRIRTN
  8365                      GO TO REINSURE-CALC-CLAIM-AH                ECSRIRTN
  8366                  ELSE                                            ECSRIRTN
  8367                     MOVE RWF-LFCLML TO RWF-LFCLM                 ECSRIRTN
  8368                      GO TO REINSURE-CALC-CLAIM-AH                ECSRIRTN
  8369              ELSE                                                ECSRIRTN
  8370                 IF (RWF-LFCLML + RWF-LFCLM) GREATER              ECSRIRTN
  8371                                           RCT-LF-CLM-MAX (CO-SUB)ECSRIRTN
  8372                     COMPUTE RWF-LFCLML =                         ECSRIRTN
  8373                               RCT-LF-CLM-MAX (CO-SUB) - RWF-LFCLMECSRIRTN
  8374                     MOVE RCT-LF-CLM-MAX (CO-SUB) TO RWF-LFCLM    ECSRIRTN
  8375                      GO TO REINSURE-CALC-CLAIM-AH.               ECSRIRTN
  8376                                                                  ECSRIRTN
  8377     ADD RWF-LFCLML TO RWF-LFCLM.                                 ECSRIRTN
  8378                                                                  ECSRIRTN
  8379     GO TO REINSURE-CALC-CLAIM-AH.                                ECSRIRTN
  8380                                                                  ECSRIRTN
  8381                                                                  ECSRIRTN
  8382 REINSURE-CALC-LF-RISK-CLAIM.                                     ECSRIRTN
  8383                                                                  ECSRIRTN
  8384     IF RWF-LFAMT NOT GREATER THAN +0                             ECSRIRTN
  8385         GO TO REINSURE-CALC-CLAIM-AH.                            ECSRIRTN
  8386                                                                  ECSRIRTN
  8387     IF CLAS-I-RL-AH (CLAS-INDEXL) = 'L'                          ECSRIRTN
  8388         MOVE RWF-LFAMT                   TO REIN-RISK-AMOUNT     ECSRIRTN
  8389     ELSE                                                         ECSRIRTN
  8390         COMPUTE REIN-RISK-AMOUNT = RWF-LFAMT -                   ECSRIRTN
  8391                ((RS-LIFE-BEN / CR-LF-TERM) * REIN-LF-CLM-MONTHS).ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 172
* ECS150P.cbl (/apps/prod/cid1p/copy/ECSRIRTNP)
  8392                                                                  ECSRIRTN
  8393     IF REIN-RISK-AMOUNT NOT GREATER THAN +0                      ECSRIRTN
  8394         GO TO REINSURE-CALC-CLAIM-AH.                            ECSRIRTN
  8395                                                                  ECSRIRTN
  8396     IF REIN-RT-SW = 'X'                                          ECSRIRTN
  8397         IF RW-LFCLMWK GREATER THAN REIN-RISK-AMOUNT              ECSRIRTN
  8398             MOVE REIN-RISK-AMOUNT        TO RWF-LFCLM            ECSRIRTN
  8399         ELSE                                                     ECSRIRTN
  8400             MOVE RW-LFCLMWK              TO RWF-LFCLM            ECSRIRTN
  8401     ELSE                                                         ECSRIRTN
  8402         IF (RW-LFCLMWK + RWF-LFCLM) GREATER THAN REIN-RISK-AMOUNTECSRIRTN
  8403             COMPUTE RWF-LFCLML = REIN-RISK-AMOUNT - RWF-LFCLM    ECSRIRTN
  8404             MOVE REIN-RISK-AMOUNT        TO RWF-LFCLM            ECSRIRTN
  8405         ELSE                                                     ECSRIRTN
  8406             MOVE RW-LFCLMWK              TO RWF-LFCLML           ECSRIRTN
  8407             ADD RW-LFCLMWK TO RWF-LFCLM.                         ECSRIRTN
  8408                                                                  ECSRIRTN
  8409                                                                  ECSRIRTN
  8410 REINSURE-CALC-CLAIM-AH.                                          ECSRIRTN
  8411                                                                  ECSRIRTN
  8412     IF REIN-AH-FLG (SUB1) NOT = 'X'                              ECSRIRTN
  8413         GO TO REINSURE-CALC-CLAIM-X.                             ECSRIRTN
  8414                                                                  ECSRIRTN
  8415     IF RW-AHCLMWK = ZEROS                                        ECSRIRTN
  8416         GO TO REINSURE-CALC-CLAIM-SKIP.                          ECSRIRTN
  8417                                                                  ECSRIRTN
  8418     IF REIN-RT-SW NOT = 'X'                                      ECSRIRTN
  8419         GO TO REINSURE-CALC-AH-DETAIL.                           ECSRIRTN
  8420                                                                  ECSRIRTN
  8421     MOVE CR-DISAB-INCURRED-DETAIL    TO RW-AH-INCURRED-DETAIL.   ECSRIRTN
  8422     MOVE ZEROS                       TO RW-AHCLMWK.              ECSRIRTN
  8423                                                                  ECSRIRTN
  8424     PERFORM CHECK-MULTIPLE-DISABILITIES THRU CHECK-DISABS-EXIT   ECSRIRTN
  8425             VARYING                                              ECSRIRTN
  8426         INC-SUB FROM +1 BY +1                                    ECSRIRTN
  8427             UNTIL                                                ECSRIRTN
  8428         INC-SUB GREATER THAN +5.                                 ECSRIRTN
  8429                                                                  ECSRIRTN
  8430     IF RW-AHCLMWK = ZEROS                                        ECSRIRTN
  8431         GO TO REINSURE-CALC-CLAIM-SKIP                           ECSRIRTN
  8432     ELSE                                                         ECSRIRTN
  8433         GO TO REINSURE-CALC-AH-CONTINUED.                        ECSRIRTN
  8434                                                                  ECSRIRTN
  8435 CHECK-MULTIPLE-DISABILITIES.                                     ECSRIRTN
  8436                                                                  ECSRIRTN
  8437     IF RW-AH-INCUR-DT (INC-SUB) = ZEROS                          ECSRIRTN
  8438         GO TO CHECK-DISABS-EXIT.                                 ECSRIRTN
  8439                                                                  ECSRIRTN
  8440     IF CO-SUB NOT = ZERO                                         ECSRIRTN
  8441       IF RCT-CLM-CUTOFF-DT (CO-SUB) NOT = ZERO                   ECSRIRTN
  8442           IF RW-AH-INCUR-DT (INC-SUB) LESS THAN                  ECSRIRTN
  8443                       RCT-CLM-CUTOFF-DT (CO-SUB)                    CL**5
  8444               MOVE ZEROS             TO RW-AH-CLM-AMT (INC-SUB)  ECSRIRTN
  8445                                         RW-AH-CLM-EXP (INC-SUB)  ECSRIRTN
  8446               GO TO CHECK-DISABS-EXIT.                           ECSRIRTN
  8447                                                                  ECSRIRTN
  8448     IF RWF-AH-RUNOFF-SW = 'N'                                    ECSRIRTN
  8449       IF RW-AH-INCUR-DT (INC-SUB) NOT LESS THAN RWF-EP-STOP-DATE ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 173
* ECS150P.cbl (/apps/prod/cid1p/copy/ECSRIRTNP)
  8450           MOVE ZEROS                 TO RW-AH-CLM-AMT (INC-SUB)  ECSRIRTN
  8451                                         RW-AH-CLM-EXP (INC-SUB)  ECSRIRTN
  8452           GO TO CHECK-DISABS-EXIT.                               ECSRIRTN
  8453                                                                  ECSRIRTN
  8454     IF WT-REMAINING NOT = 'I'                                    ECSRIRTN
  8455         COMPUTE RW-AHCLMWK = RW-AHCLMWK                          ECSRIRTN
  8456                             + RW-AH-CLM-AMT (INC-SUB)            ECSRIRTN
  8457                             + RW-AH-CLM-EXP (INC-SUB)            ECSRIRTN
  8458         GO TO CHECK-DISABS-EXIT.                                 ECSRIRTN
  8459                                                                  ECSRIRTN
  8460     IF RWF-AHAMT NOT GREATER THAN +0                             ECSRIRTN
  8461         GO TO CHECK-DISABS-EXIT.                                 ECSRIRTN
  8462                                                                  ECSRIRTN
  8463     IF INC-SUB = +1                                              ECSRIRTN
  8464         MOVE REIN-AH-CLM-MTH-1       TO REIN-AH-CLM-MONTHS.      ECSRIRTN
  8465     IF INC-SUB = +2                                              ECSRIRTN
  8466         MOVE REIN-AH-CLM-MTH-2       TO REIN-AH-CLM-MONTHS.      ECSRIRTN
  8467     IF INC-SUB = +3                                              ECSRIRTN
  8468         MOVE REIN-AH-CLM-MTH-3       TO REIN-AH-CLM-MONTHS.      ECSRIRTN
  8469     IF INC-SUB = +4                                              ECSRIRTN
  8470         MOVE REIN-AH-CLM-MTH-4       TO REIN-AH-CLM-MONTHS.      ECSRIRTN
  8471     IF INC-SUB = +5                                              ECSRIRTN
  8472         MOVE REIN-AH-CLM-MTH-5       TO REIN-AH-CLM-MONTHS.      ECSRIRTN
  8473                                                                  ECSRIRTN
  8474     COMPUTE REIN-RISK-AMOUNT = (RWF-AHAMT * CR-AH-TERM) -        ECSRIRTN
  8475                                (RS-AH-BEN * REIN-AH-CLM-MONTHS). ECSRIRTN
  8476                                                                  ECSRIRTN
  8477     IF REIN-RISK-AMOUNT NOT GREATER THAN +0                      ECSRIRTN
  8478         GO TO CHECK-DISABS-EXIT.                                 ECSRIRTN
  8479                                                                  ECSRIRTN
  8480     IF (RW-AH-CLM-AMT (INC-SUB) + RW-AH-CLM-EXP (INC-SUB))       ECSRIRTN
  8481              GREATER THAN REIN-RISK-AMOUNT                       ECSRIRTN
  8482         COMPUTE RW-AHCLMWK = RW-AHCLMWK + REIN-RISK-AMOUNT       ECSRIRTN
  8483     ELSE                                                         ECSRIRTN
  8484         COMPUTE RW-AHCLMWK = RW-AHCLMWK                          ECSRIRTN
  8485                             + RW-AH-CLM-AMT (INC-SUB)            ECSRIRTN
  8486                             + RW-AH-CLM-EXP (INC-SUB).           ECSRIRTN
  8487                                                                  ECSRIRTN
  8488 CHECK-DISABS-EXIT.                                               ECSRIRTN
  8489      EXIT.                                                       ECSRIRTN
  8490                                                                  ECSRIRTN
  8491 REINSURE-CALC-AH-DETAIL.                                         ECSRIRTN
  8492                                                                  ECSRIRTN
  8493     IF RW-AHCLMWK = ZEROS                                        ECSRIRTN
  8494         GO TO REINSURE-CALC-CLAIM-SKIP.                          ECSRIRTN
  8495                                                                  ECSRIRTN
  8496     IF CO-SUB NOT = ZERO                                         ECSRIRTN
  8497         IF RCT-CLM-CUTOFF-DT (CO-SUB) NOT = ZERO                 ECSRIRTN
  8498             IF CR-DIS-DT LESS RCT-CLM-CUTOFF-DT (CO-SUB)            CL*11
  8499                 GO TO REINSURE-CALC-CLAIM-SKIP.                  ECSRIRTN
  8500                                                                  ECSRIRTN
  8501     IF RWF-AH-RUNOFF-SW = 'N'                                    ECSRIRTN
  8502         IF CR-DIS-DT NOT LESS THAN RWF-EP-STOP-DATE                 CL**6
  8503             GO TO REINSURE-CALC-CLAIM-SKIP.                      ECSRIRTN
  8504                                                                  ECSRIRTN
  8505 REINSURE-CALC-AH-CONTINUED.                                      ECSRIRTN
  8506                                                                  ECSRIRTN
  8507     IF RWF-REM-AH-100 = 'Y'                                      ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 174
* ECS150P.cbl (/apps/prod/cid1p/copy/ECSRIRTNP)
  8508         MOVE RW-AHCLMWK TO RWF-AHCLML                            ECSRIRTN
  8509         PERFORM REINSURE-SUB-REM-CLAIM THRU                      ECSRIRTN
  8510             REINSURE-SUB-REM-CLAIM-X                             ECSRIRTN
  8511                 VARYING SUB2 FROM +1 BY +1 UNTIL SUB2 = SUB1     ECSRIRTN
  8512         ADD RWF-AHCLML TO RWF-AHCLM                              ECSRIRTN
  8513         GO TO REINSURE-CALC-CLAIM-SKIP.                          ECSRIRTN
  8514                                                                  ECSRIRTN
  8515     IF WT-REMAINING = 'I'                                        ECSRIRTN
  8516         GO TO REINSURE-CALC-AH-RISK-CLAIM.                       ECSRIRTN
  8517                                                                  ECSRIRTN
  8518     IF WT-REMAINING = 'L'                                        ECSRIRTN
  8519         IF REIN-RT-SW = 'X'                                      ECSRIRTN
  8520             IF RW-AHCLMWK GREATER WT-AHBEN-HI                    ECSRIRTN
  8521                 MOVE WT-AHBEN-HI TO RWF-AHCLM                    ECSRIRTN
  8522             ELSE                                                 ECSRIRTN
  8523                 MOVE RW-AHCLMWK TO RWF-AHCLM                     ECSRIRTN
  8524         ELSE                                                     ECSRIRTN
  8525             IF (RW-AHCLMWK + RWF-AHCLM) GREATER WT-AHBEN-HI      ECSRIRTN
  8526                 COMPUTE RWF-AHCLML = WT-AHBEN-HI - RWF-AHCLM     ECSRIRTN
  8527                 MOVE WT-AHBEN-HI TO RWF-AHCLM                    ECSRIRTN
  8528             ELSE                                                 ECSRIRTN
  8529                 MOVE RW-AHCLMWK TO RWF-AHCLML                    ECSRIRTN
  8530                 ADD RWF-AHCLML TO RWF-AHCLM.                     ECSRIRTN
  8531                                                                  ECSRIRTN
  8532     IF WT-REMAINING = 'L'                                        ECSRIRTN
  8533         GO TO REINSURE-CALC-CLAIM-SKIP.                          ECSRIRTN
  8534                                                                  ECSRIRTN
  8535     IF CR-AHAMT NOT = ZERO                                       ECSRIRTN
  8536         COMPUTE RWF-AHCLML ROUNDED = (RW-AHCLMWK *               ECSRIRTN
  8537                            RWF-AHAMT) / CR-AHAMT                 ECSRIRTN
  8538     ELSE                                                         ECSRIRTN
  8539         IF RWF-AH-LIMIT = ZERO                                   ECSRIRTN
  8540             COMPUTE RWF-AHCLML ROUNDED =                         ECSRIRTN
  8541                       RW-AHCLMWK * WT-AH-PCT.                    ECSRIRTN
  8542                                                                  ECSRIRTN
  8543     IF CO-SUB NOT = ZERO                                         ECSRIRTN
  8544         IF RCT-AH-CLM-PCT (CO-SUB) NOT = ZERO                    ECSRIRTN
  8545             COMPUTE RWF-AHCLML ROUNDED =                         ECSRIRTN
  8546                           RW-AHCLMWK * RCT-AH-CLM-PCT (CO-SUB).  ECSRIRTN
  8547                                                                  ECSRIRTN
  8548     IF CO-SUB NOT = ZERO                                         ECSRIRTN
  8549         IF RCT-AH-CLM-MAX (CO-SUB) NOT = ZERO                    ECSRIRTN
  8550             IF REIN-RT-SW = 'X'                                  ECSRIRTN
  8551               IF RWF-AHCLML GREATER RCT-AH-CLM-MAX (CO-SUB)      ECSRIRTN
  8552                     MOVE RCT-AH-CLM-MAX (CO-SUB) TO RWF-AHCLM    ECSRIRTN
  8553                      GO TO REINSURE-CALC-CLAIM-SKIP              ECSRIRTN
  8554                  ELSE                                            ECSRIRTN
  8555                     MOVE RWF-AHCLML TO RWF-AHCLM                 ECSRIRTN
  8556                      GO TO REINSURE-CALC-CLAIM-SKIP              ECSRIRTN
  8557              ELSE                                                ECSRIRTN
  8558                 IF (RWF-AHCLML + RWF-AHCLM) GREATER              ECSRIRTN
  8559                                           RCT-AH-CLM-MAX (CO-SUB)ECSRIRTN
  8560                     COMPUTE RWF-AHCLML =                         ECSRIRTN
  8561                               RCT-AH-CLM-MAX (CO-SUB) - RWF-AHCLMECSRIRTN
  8562                     MOVE RCT-AH-CLM-MAX (CO-SUB) TO RWF-AHCLM    ECSRIRTN
  8563                      GO TO REINSURE-CALC-CLAIM-SKIP.             ECSRIRTN
  8564                                                                  ECSRIRTN
  8565                                                                  ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 175
* ECS150P.cbl (/apps/prod/cid1p/copy/ECSRIRTNP)
  8566     IF DTE-CLIENT = 'FLA'                                        ECSRIRTN
  8567        IF REIN-COMP (SUB1) = ('200000' OR '210000' OR            ECSRIRTN
  8568                               '220000' OR '230000')              ECSRIRTN
  8569           PERFORM FLA-SPEC-REIN-CLMS THRU                        ECSRIRTN
  8570               E-FLA-SPEC-REIN-CLMS.                              ECSRIRTN
  8571                                                                  ECSRIRTN
  8572     ADD RWF-AHCLML TO RWF-AHCLM.                                 ECSRIRTN
  8573                                                                  ECSRIRTN
  8574     GO TO REINSURE-CALC-CLAIM-SKIP.                              ECSRIRTN
  8575                                                                  ECSRIRTN
  8576                                                                  ECSRIRTN
  8577 REINSURE-CALC-AH-RISK-CLAIM.                                     ECSRIRTN
  8578                                                                  ECSRIRTN
  8579     IF RWF-AHAMT NOT GREATER THAN +0                             ECSRIRTN
  8580         GO TO REINSURE-CALC-CLAIM-SKIP.                          ECSRIRTN
  8581                                                                  ECSRIRTN
  8582     IF REIN-RT-SW = 'X'                                          ECSRIRTN
  8583         MOVE RW-AHCLMWK              TO RWF-AHCLM                ECSRIRTN
  8584         GO TO REINSURE-CALC-CLAIM-SKIP.                          ECSRIRTN
  8585                                                                  ECSRIRTN
  8586     COMPUTE REIN-RISK-AMOUNT = (RWF-AHAMT * CR-AH-TERM) -        ECSRIRTN
  8587                                (RS-AH-BEN * REIN-AH-CLM-MONTHS). ECSRIRTN
  8588                                                                  ECSRIRTN
  8589     IF REIN-RISK-AMOUNT NOT GREATER THAN +0                      ECSRIRTN
  8590         GO TO REINSURE-CALC-CLAIM-SKIP.                          ECSRIRTN
  8591                                                                  ECSRIRTN
  8592     IF REIN-AH-PRIOR-CLMS-PAID GREATER THAN REIN-RISK-AMOUNT     ECSRIRTN
  8593         GO TO REINSURE-CALC-CLAIM-SKIP.                          ECSRIRTN
  8594                                                                  ECSRIRTN
  8595     IF (RW-AHCLMWK + REIN-AH-PRIOR-CLMS-PAID)                    ECSRIRTN
  8596                                GREATER THAN REIN-RISK-AMOUNT     ECSRIRTN
  8597         COMPUTE RWF-AHCLML = REIN-RISK-AMOUNT                    ECSRIRTN
  8598                             - REIN-AH-PRIOR-CLMS-PAID            ECSRIRTN
  8599         MOVE REIN-RISK-AMOUNT        TO RWF-AHCLM                ECSRIRTN
  8600     ELSE                                                         ECSRIRTN
  8601         MOVE RW-AHCLMWK              TO RWF-AHCLML               ECSRIRTN
  8602         ADD RW-AHCLMWK TO RWF-AHCLM.                             ECSRIRTN
  8603                                                                  ECSRIRTN
  8604                                                                  ECSRIRTN
  8605 REINSURE-CALC-CLAIM-SKIP.                                        ECSRIRTN
  8606                                                                  ECSRIRTN
  8607     IF RWF-LFCLM NOT = ZEROS                                     ECSRIRTN
  8608         MOVE 'X' TO REIN-LF-FLG (SUB1).                          ECSRIRTN
  8609                                                                  ECSRIRTN
  8610     IF RWF-AHCLM NOT = ZEROS                                     ECSRIRTN
  8611         MOVE 'X' TO REIN-AH-FLG (SUB1).                          ECSRIRTN
  8612                                                                  ECSRIRTN
  8613     GO TO REINSURE-CALC-CLAIM-X.                                 ECSRIRTN
  8614                                                                  ECSRIRTN
  8615 REINSURE-REMAINDER-CLAIM.                                        ECSRIRTN
  8616                                                                  ECSRIRTN
  8617     MOVE RW-LFCLMWK TO RWF-LFCLML.                               ECSRIRTN
  8618     MOVE RW-AHCLMWK TO RWF-AHCLML.                               ECSRIRTN
  8619                                                                  ECSRIRTN
  8620     PERFORM REINSURE-SUBTRACT-CLAIM THRU                         ECSRIRTN
  8621         REINSURE-SUBTRACT-CLAIM-X                                ECSRIRTN
  8622             VARYING SUB2 FROM +1 BY +1 UNTIL SUB2 = SUB1.        ECSRIRTN
  8623                                                                  ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 176
* ECS150P.cbl (/apps/prod/cid1p/copy/ECSRIRTNP)
  8624     ADD RWF-LFCLML TO RWF-LFCLM.                                 ECSRIRTN
  8625     ADD RWF-AHCLML TO RWF-AHCLM.                                 ECSRIRTN
  8626                                                                  ECSRIRTN
  8627     IF RWF-LFCLM NOT = ZEROS                                     ECSRIRTN
  8628         MOVE 'X' TO REIN-LF-FLG (SUB1).                          ECSRIRTN
  8629                                                                  ECSRIRTN
  8630     IF RWF-AHCLM NOT = ZEROS                                     ECSRIRTN
  8631         MOVE 'X' TO REIN-AH-FLG (SUB1).                          ECSRIRTN
  8632                                                                  ECSRIRTN
  8633 REINSURE-CALC-CLAIM-X.                                           ECSRIRTN
  8634                                                                  ECSRIRTN
  8635     IF REIN-LF-AH-FLGS (SUB1) NOT = SPACES                       ECSRIRTN
  8636         MOVE 'X' TO REIN-BUS-FLAG.                               ECSRIRTN
  8637                                                                  ECSRIRTN
  8638     MOVE RWF-FIELDS TO REIN-WORK-FLDS (SUB1).                    ECSRIRTN
  8639                                                                  ECSRIRTN
  8640 REINSURE-SUBTRACT-CLAIM.                                         ECSRIRTN
  8641                                                                  ECSRIRTN
  8642     SUBTRACT REIN-LFCLML (SUB2) FROM RWF-LFCLML.                 ECSRIRTN
  8643     SUBTRACT REIN-AHCLML (SUB2) FROM RWF-AHCLML.                 ECSRIRTN
  8644                                                                  ECSRIRTN
  8645 REINSURE-SUBTRACT-CLAIM-X.                                       ECSRIRTN
  8646     EXIT.                                                        ECSRIRTN
  8647                                                                  ECSRIRTN
  8648 REINSURE-SUB-REM-CLAIM.                                          ECSRIRTN
  8649                                                                  ECSRIRTN
  8650     IF REIN-REM-SW (SUB2) = 'Y' OR 'Z' OR 'X' OR 'N'             ECSRIRTN
  8651         SUBTRACT REIN-AHCLML (SUB2) FROM RWF-AHCLML.             ECSRIRTN
  8652                                                                  ECSRIRTN
  8653 REINSURE-SUB-REM-CLAIM-X.                                        ECSRIRTN
  8654     EXIT.                                                        ECSRIRTN
  8655                                                                  ECSRIRTN
  8656                                                                  ECSRIRTN
  8657 CLEAR-REIN-HOLD.                                                 ECSRIRTN
  8658                                                                  ECSRIRTN
  8659     MOVE SPACES TO REIN-COMP (1).                                ECSRIRTN
  8660     MOVE SPACES TO REIN-LF-AH-FLGS (1).                          ECSRIRTN
  8661     MOVE SPACES TO REIN-REM-SW (1).                              ECSRIRTN
  8662     MOVE SPACES TO REIN-REM-AH-100 (1).                          ECSRIRTN
  8663                                                                  ECSRIRTN
  8664     MOVE +0 TO REIN-LFAMT (1)  REIN-LFPRM (1)  REIN-AHAMT (1)    ECSRIRTN
  8665         REIN-AHPRM (1)  REIN-LFRFND (1)  REIN-AHRFND (1)         ECSRIRTN
  8666         REIN-LFCLM (1)  REIN-AHCLM (1)  REIN-LFCLML (1)          ECSRIRTN
  8667         REIN-AHCLML (1)  REIN-DIS-IBNR (1)  REIN-DIS-PAYCUR (1)  ECSRIRTN
  8668         REIN-DIS-FUTRSV (1)  REIN-DTH-IBNR (1)                   ECSRIRTN
  8669         REIN-DTH-PAYCUR (1)  REIN-DTH-FUTRSV (1)                 ECSRIRTN
  8670         REIN-DIS-IBNRL (1)  REIN-DIS-PAYCURL (1)                 ECSRIRTN
  8671         REIN-DIS-FUTRSVL (1)  REIN-DTH-IBNRL (1)                 ECSRIRTN
  8672         REIN-DTH-PAYCURL (1)  REIN-DTH-FUTRSVL (1)               ECSRIRTN
  8673         REIN-AH-LIMIT (1).                                       ECSRIRTN
  8674                                                                  ECSRIRTN
  8675     PERFORM CLEAR-REIN-HOLD-ALL VARYING SUB1 FROM 2 BY 1         ECSRIRTN
  8676         UNTIL REIN-COMP (SUB1) = SPACES.                         ECSRIRTN
  8677                                                                  ECSRIRTN
  8678     GO TO CLEAR-REIN-HOLD-X.                                     ECSRIRTN
  8679                                                                  ECSRIRTN
  8680 CLEAR-REIN-HOLD-ALL.                                             ECSRIRTN
  8681                                                                  ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 177
* ECS150P.cbl (/apps/prod/cid1p/copy/ECSRIRTNP)
  8682     MOVE REIN-LEVELS (1) TO REIN-LEVELS (SUB1).                  ECSRIRTN
  8683                                                                  ECSRIRTN
  8684 CLEAR-REIN-HOLD-X.                                               ECSRIRTN
  8685     EXIT.                                                        ECSRIRTN
  8686                                                                  ECSRIRTN
  8687 FLA-SPEC-REIN-CLMS.                                              ECSRIRTN
  8688                                                                  ECSRIRTN
  8689     MOVE +250.00 TO FLA-CLM-REIN-BASE  ADJ-FLA-REIN-BASE.        ECSRIRTN
  8690                                                                  ECSRIRTN
  8691     IF REIN-COMP (SUB1) = '230000'                               ECSRIRTN
  8692         MOVE +100.00 TO FLA-CLM-REIN-BASE  ADJ-FLA-REIN-BASE.    ECSRIRTN
  8693                                                                  ECSRIRTN
  8694     IF CR-AHAMT NOT = ZERO                                       ECSRIRTN
  8695         COMPUTE ADJ-FLA-REIN-BASE ROUNDED =                      ECSRIRTN
  8696             (RW-AHCLMWK / CR-AHAMT) * FLA-CLM-REIN-BASE.         ECSRIRTN
  8697                                                                  ECSRIRTN
  8698     IF REIN-RT-SW = 'X'                                          ECSRIRTN
  8699         MOVE CR-DIS-CC TO CIRD-CC                                ECSRIRTN
  8700         MOVE CR-DIS-YR TO CIRD-YR                                ECSRIRTN
  8701         MOVE CR-DIS-MO TO CIRD-MO                                ECSRIRTN
  8702     ELSE                                                         ECSRIRTN
  8703         MOVE DTO-CC    TO CIRD-CC                                ECSRIRTN
  8704         MOVE DTO-YR    TO CIRD-YR                                ECSRIRTN
  8705         MOVE DTO-MO    TO CIRD-MO.                               ECSRIRTN
  8706                                                                  ECSRIRTN
  8707     MOVE ZEROS TO RWF-AHCLML.                                    ECSRIRTN
  8708                                                                  ECSRIRTN
  8709     IF CLM-INCUR-REIN-DATE LESS '197809'  AND                    ECSRIRTN
  8710        CR-AHAMT GREATER FLA-CLM-REIN-BASE                        ECSRIRTN
  8711         COMPUTE RWF-AHCLML = RW-AHCLMWK - ADJ-FLA-REIN-BASE.     ECSRIRTN
  8712                                                                  ECSRIRTN
  8713     IF CLM-INCUR-REIN-DATE GREATER '197806'                      ECSRIRTN
  8714         COMPUTE RWF-AHCLML = RWF-AHCLML + (RW-AHCLMWK * +.9).    ECSRIRTN
  8715                                                                  ECSRIRTN
  8716 E-FLA-SPEC-REIN-CLMS.                                            ECSRIRTN
  8717     EXIT.                                                        ECSRIRTN
  8718                                                                  ECSRIRTN
  8719 REIN-FIND-CO-LOOP.                                               ECSRIRTN
  8720                                                                  ECSRIRTN
  8721     CONTINUE.                                                    ECSRIRTN
  8722*  DUMMY PARAGRAPH - NO CODE NEEDED.                              ECSRIRTN
  8723 FIND-REI-CO-EXIT.                                                ECSRIRTN
  8724     EXIT.                                                        ECSRIRTN
  8725                                                                  ECSRIRTN
  8726 REIN-CO-TABLE-BUILD.                                             ECSRIRTN
  8727                                                                  ECSRIRTN
  8728     PERFORM ZERO-RCT-ENTRIES THRU ZERO-RCT-EXIT                  ECSRIRTN
  8729         VARYING CO-SUB FROM 1 BY 1                               ECSRIRTN
  8730                   UNTIL CO-SUB GREATER REIN-CO-TABLE-ENT-CNT.    ECSRIRTN
  8731                                                                  ECSRIRTN
  8732     PERFORM ZERO-RC2-ENTRIES THRU ZERO-RC2-EXIT                  ECSRIRTN
  8733         VARYING CO-SUB FROM 1 BY 1                               ECSRIRTN
  8734                   UNTIL CO-SUB GREATER REIN-CO-TABLE-ENT-CNT.    ECSRIRTN
  8735                                                                  ECSRIRTN
  8736     MOVE LOW-VALUES          TO RE-CONTROL-PRIMARY.              ECSRIRTN
  8737                                                                  ECSRIRTN
  8738     START ERRTBL-IN                                              ECSRIRTN
  8739           KEY IS GREATER THAN RE-CONTROL-PRIMARY                 ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 178
* ECS150P.cbl (/apps/prod/cid1p/copy/ECSRIRTNP)
  8740             INVALID KEY                                          ECSRIRTN
  8741               GO TO REIN-BUILD-EXIT.                             ECSRIRTN
  8742                                                                  ECSRIRTN
  8743     MOVE 0 TO CO-SUB.                                            ECSRIRTN
  8744     MOVE 0 TO SUB1.                                              ECSRIRTN
  8745 REIN-CO-BUILD-LOOP.                                              ECSRIRTN
  8746                                                                  ECSRIRTN
  8747     READ ERRTBL-IN  NEXT RECORD.                                 ECSRIRTN
  8748                                                                  ECSRIRTN
  8749     IF ERRTBL-FILE-STATUS = '10'                                 ECSRIRTN
  8750        GO TO REIN-BUILD-EXIT.                                    ECSRIRTN
  8751                                                                  ECSRIRTN
  8752     IF ERRTBL-FILE-STATUS NOT = ZERO                             ECSRIRTN
  8753        MOVE ERRTBL-FILE-STATUS TO WS-ABEND-FILE-STATUS           ECSRIRTN
  8754        MOVE 'READ ERROR ON FILE - ERRTBL'                        ECSRIRTN
  8755                                  TO WS-ABEND-MESSAGE             ECSRIRTN
  8756        GO TO ABEND-PGM.                                          ECSRIRTN
  8757                                                                  ECSRIRTN
  8758     IF RE-CODE NOT = 'B'                                         ECSRIRTN
  8759        GO TO REIN-CO-BUILD-LOOP.                                 ECSRIRTN
  8760                                                                  ECSRIRTN
  8761     IF RE-CLM-INCURRED-LIM NOT NUMERIC                           ECSRIRTN
  8762        MOVE ZERO TO RE-CLM-INCURRED-LIM.                         ECSRIRTN
  8763                                                                  ECSRIRTN
  8764     IF RE-EARNING-START-DT NOT NUMERIC                           ECSRIRTN
  8765        MOVE ZERO TO RE-EARNING-START-DT.                         ECSRIRTN
  8766                                                                  ECSRIRTN
  8767     IF RE-EARNING-STOP-DT NOT NUMERIC                            ECSRIRTN
  8768        MOVE ZERO TO RE-EARNING-STOP-DT.                          ECSRIRTN
  8769                                                                  ECSRIRTN
  8770     PERFORM VARYING CPSE-NDX FROM 1 BY 1 UNTIL CPSE-NDX > 1500   ECSRIRTN
  8771        MOVE RCT-CLM-CUTOFF-DT (CPSE-NDX)                         ECSRIRTN
*1118-E***************************************                         (   0)**
**    Index-name belongs to different table - unexpected behaviour may occur
  8772                        TO  WS-RCT-CLM-CUTOFF-DT-N (CPSE-NDX)        CL*12
  8773        MOVE RCT-EARNING-START-DT (CPSE-NDX)                      ECSRIRTN
*1118-E******************************************                      ( 178)**
**    Index-name belongs to different table - unexpected behaviour may occur
  8774                        TO  WS-RCT-EARNING-START-DT-N (CPSE-NDX)     CL*12
  8775        MOVE RCT-EARNING-STOP-DT (CPSE-NDX)                       ECSRIRTN
*1118-E*****************************************                       ( 178)**
**    Index-name belongs to different table - unexpected behaviour may occur
  8776                        TO  WS-RCT-EARNING-STOP-DT-N (CPSE-NDX)      CL*12
  8777     END-PERFORM.                                                 ECSRIRTN
  8778     MOVE RWF-EP-STOP-DATE       TO  WS-RWF-EP-STOP-DATE-N.          CL*12
  8779                                                                  ECSRIRTN
  8780     IF RE-LF-CLM-PCT NOT NUMERIC                                 ECSRIRTN
  8781        MOVE ZERO TO RE-LF-CLM-PCT.                               ECSRIRTN
  8782                                                                  ECSRIRTN
  8783     IF RE-AH-CLM-PCT NOT NUMERIC                                 ECSRIRTN
  8784        MOVE ZERO TO RE-AH-CLM-PCT.                               ECSRIRTN
  8785                                                                  ECSRIRTN
  8786     IF RE-LF-CLM-MAX NOT NUMERIC                                 ECSRIRTN
  8787        MOVE ZERO TO RE-LF-CLM-MAX.                               ECSRIRTN
  8788                                                                  ECSRIRTN
  8789     IF RE-AH-CLM-MAX NOT NUMERIC                                 ECSRIRTN
  8790        MOVE ZERO TO RE-AH-CLM-MAX.                               ECSRIRTN
  8791                                                                  ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 179
* ECS150P.cbl (/apps/prod/cid1p/copy/ECSRIRTNP)
  8792     IF (RE-AH-CLM-MAX = ZERO) AND                                ECSRIRTN
  8793        (RE-LF-CLM-MAX = ZERO) AND                                ECSRIRTN
  8794        (RE-AH-CLM-PCT = ZERO) AND                                ECSRIRTN
  8795        (RE-LF-CLM-PCT = ZERO) AND                                ECSRIRTN
  8796        (RE-CLM-INCURRED-LIM = ZERO) AND                          ECSRIRTN
  8797        (RE-EARNING-START-DT = ZERO) AND                          ECSRIRTN
  8798        (RE-EARNING-STOP-DT = ZERO)                               ECSRIRTN
  8799          GO TO REIN-CO-BUILD-EPR.                                ECSRIRTN
  8800                                                                  ECSRIRTN
  8801     ADD +1 TO CO-SUB.                                            ECSRIRTN
  8802                                                                  ECSRIRTN
  8803     IF CO-SUB GREATER REIN-CO-TABLE-ENT-CNT                      ECSRIRTN
  8804        MOVE 0202 TO WS-RETURN-CODE                               ECSRIRTN
  8805        DISPLAY 'REINSURANCE COMPANY SAVE TABLE EXCEEDED'         ECSRIRTN
  8806        DISPLAY 'ERROR DETECTED IN ECSRIRTN, SEE ECSRITAB'        ECSRIRTN
  8807        MOVE 'REINSURANCE COMPANY SAVE TABLE EXCEEDED'            ECSRIRTN
  8808                                  TO WS-ABEND-MESSAGE             ECSRIRTN
  8809        GO TO ABEND-PGM.                                          ECSRIRTN
  8810                                                                  ECSRIRTN
  8811     MOVE RE-COMPANY           TO RCT-REIN-CO (CO-SUB).              CL**7
  8812
  8813                                                                  ECSRIRTN
  8814     MOVE RE-CLM-INCURRED-LIM  TO RCT-CLM-CUTOFF-DT (CO-SUB)      ECSRIRTN
  8815                               WS-RCT-CLM-CUTOFF-DT-N (CO-SUB).      CL*12
  8816     MOVE RE-EARNING-START-DT  TO RCT-EARNING-START-DT (CO-SUB)   ECSRIRTN
  8817                               WS-RCT-EARNING-START-DT-N (CO-SUB).   CL*12
  8818     MOVE RE-EARNING-STOP-DT   TO RCT-EARNING-STOP-DT (CO-SUB)    ECSRIRTN
  8819                               WS-RCT-EARNING-STOP-DT-N (CO-SUB).    CL*12
  8820                                                                  ECSRIRTN
  8821     IF RE-EARN-STOP-CODE = 'A'  OR  'L'                          ECSRIRTN
  8822         MOVE RE-EARN-STOP-CODE  TO RCT-EARN-STOP-CODE (CO-SUB)   ECSRIRTN
  8823     ELSE                                                         ECSRIRTN
  8824         MOVE 'B'                TO RCT-EARN-STOP-CODE (CO-SUB).  ECSRIRTN
  8825                                                                  ECSRIRTN
  8826     MOVE RE-LF-CLM-PCT  TO RCT-LF-CLM-PCT (CO-SUB).              ECSRIRTN
  8827     MOVE RE-AH-CLM-PCT  TO RCT-AH-CLM-PCT (CO-SUB).              ECSRIRTN
  8828     MOVE RE-LF-CLM-MAX  TO RCT-LF-CLM-MAX (CO-SUB).              ECSRIRTN
  8829     MOVE RE-AH-CLM-MAX  TO RCT-AH-CLM-MAX (CO-SUB).              ECSRIRTN
  8830                                                                  ECSRIRTN
  8831 REIN-CO-BUILD-EPR.                                               ECSRIRTN
  8832                                                                  ECSRIRTN
  8833     IF RE-AH-PR-PCT  NOT NUMERIC                                 ECSRIRTN
  8834        MOVE ZERO TO RE-AH-PR-PCT.                                ECSRIRTN
  8835                                                                  ECSRIRTN
  8836     IF RE-AH-78-PCT  NOT NUMERIC                                 ECSRIRTN
  8837        MOVE ZERO TO RE-AH-78-PCT.                                ECSRIRTN
  8838                                                                  ECSRIRTN
  8839     IF RE-LF-PR-PCT  NOT NUMERIC                                 ECSRIRTN
  8840        MOVE ZERO TO RE-LF-PR-PCT.                                ECSRIRTN
  8841                                                                  ECSRIRTN
  8842     IF RE-LF-78-PCT  NOT NUMERIC                                 ECSRIRTN
  8843        MOVE ZERO TO RE-LF-78-PCT.                                ECSRIRTN
  8844                                                                  ECSRIRTN
  8845     ADD +1 TO SUB1.                                              ECSRIRTN
  8846                                                                  ECSRIRTN
  8847     IF SUB1 GREATER REIN-CO-TABLE-ENT-CNT                        ECSRIRTN
  8848        MOVE 0201 TO WS-RETURN-CODE                               ECSRIRTN
  8849        MOVE 'REINSURANCE COMPANY SAVE TABLE EXCEEDED'            ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 180
* ECS150P.cbl (/apps/prod/cid1p/copy/ECSRIRTNP)
  8850                                  TO WS-ABEND-MESSAGE             ECSRIRTN
  8851        GO TO ABEND-PGM.                                          ECSRIRTN
  8852                                                                  ECSRIRTN
  8853     MOVE RE-COMPANY     TO RC2-REIN-CO    (SUB1).                ECSRIRTN
  8854     MOVE RE-AH-PR-PCT   TO RC2-AH-PRO-PCT (SUB1).                ECSRIRTN
  8855     MOVE RE-AH-78-PCT   TO RC2-AH-R78-PCT (SUB1).                ECSRIRTN
  8856     MOVE RE-LF-PR-PCT   TO RC2-LF-PRO-PCT (SUB1).                ECSRIRTN
  8857     MOVE RE-LF-78-PCT   TO RC2-LF-R78-PCT (SUB1).                ECSRIRTN
  8858     MOVE RE-NAME        TO RC2-CO-NAME    (SUB1).                ECSRIRTN
  8859
  8860     IF RE-COMPANY = '570000'
  8861        MOVE 'N'               TO RE-STATE-EXHIBIT-OPT-F
  8862     END-IF
  8863
  8864     if re-state-exhibit-opt-f = 'Y'
  8865        move 'Y'         to rc2-ecs152-rpt (sub1)
  8866     else
  8867        move 'N'         to rc2-ecs152-rpt (sub1)
  8868     end-if
  8869                                                                  ECSRIRTN
  8870     GO TO REIN-CO-BUILD-LOOP.                                    ECSRIRTN
  8871                                                                  ECSRIRTN
  8872 REIN-BUILD-EXIT.                                                 ECSRIRTN
  8873     EXIT.                                                        ECSRIRTN
  8874                                                                  ECSRIRTN
  8875 ZERO-RCT-ENTRIES.                                                ECSRIRTN
  8876                                                                  ECSRIRTN
  8877     MOVE SPACES TO REIN-CO-HOLD-ENTRIES (CO-SUB).                ECSRIRTN
  8878                                                                  ECSRIRTN
  8879     MOVE ZERO   TO RCT-CLM-CUTOFF-DT (CO-SUB)                    ECSRIRTN
  8880                    WS-RCT-CLM-CUTOFF-DT-N (CO-SUB)                  CL*12
  8881                    RCT-EARNING-START-DT (CO-SUB)                 ECSRIRTN
  8882                    WS-RCT-EARNING-START-DT-N (CO-SUB)               CL*12
  8883                    RCT-EARNING-STOP-DT (CO-SUB)                  ECSRIRTN
  8884                    WS-RCT-EARNING-STOP-DT-N (CO-SUB)                CL*12
  8885                    RCT-LF-CLM-PCT    (CO-SUB)                    ECSRIRTN
  8886                    RCT-AH-CLM-PCT    (CO-SUB)                    ECSRIRTN
  8887                    RCT-LF-CLM-MAX    (CO-SUB)                    ECSRIRTN
  8888                    RCT-AH-CLM-MAX    (CO-SUB).                   ECSRIRTN
  8889                                                                  ECSRIRTN
  8890 ZERO-RCT-EXIT.                                                   ECSRIRTN
  8891     EXIT.                                                        ECSRIRTN
  8892                                                                  ECSRIRTN
  8893 ZERO-RC2-ENTRIES.                                                ECSRIRTN
  8894                                                                  ECSRIRTN
  8895     MOVE SPACES TO RC2-CO-NAME (CO-SUB)                          ECSRIRTN
  8896                    RC2-REIN-CO (CO-SUB).                         ECSRIRTN
  8897     move spaces      to rc2-ecs152-rpt (co-sub)
  8898                                                                  ECSRIRTN
  8899     MOVE ZERO   TO RC2-LF-R78-PCT    (CO-SUB)                    ECSRIRTN
  8900                    RC2-LF-PRO-PCT    (CO-SUB)                    ECSRIRTN
  8901                    RC2-AH-R78-PCT    (CO-SUB)                    ECSRIRTN
  8902                    RC2-AH-PRO-PCT    (CO-SUB).                   ECSRIRTN
  8903                                                                  ECSRIRTN
  8904 ZERO-RC2-EXIT.                                                   ECSRIRTN
  8905     EXIT.                                                        ECSRIRTN
  8906******************************************************************ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 181
* ECS150P.cbl
  8908
  8909 REM-TRM-RTN.
  8910     SUBTRACT BGN-YR FROM END-YR GIVING REM-TRM1.
  8911
  8912     IF REM-TRM1 < 0
  8913       ADD 100 TO REM-TRM1.
  8914
  8915     MULTIPLY +12 BY REM-TRM1.
  8916     SUBTRACT BGN-MO FROM END-MO GIVING TEM-TRM1.
  8917     ADD TEM-TRM1 TO REM-TRM1.
  8918
  8919     IF DTE-REM-TRM = '2'
  8920         GO TO REM-TRM-2.
  8921
  8922     SUBTRACT BGN-DA FROM END-DA GIVING TEM-TRM1.
  8923
  8924     IF TEM-TRM1 = ZERO
  8925         GO TO REM-TRM-1.
  8926
  8927     IF TEM-TRM1 IS LESS THAN -15
  8928         SUBTRACT +1 FROM REM-TRM1
  8929         GO TO REM-TRM-1.
  8930
  8931     IF TEM-TRM1 IS GREATER THAN +15
  8932         ADD +1 TO REM-TRM1
  8933         GO TO REM-TRM-0.
  8934
  8935     IF TEM-TRM1 IS GREATER THAN ZERO
  8936         GO TO REM-TRM-1.
  8937
  8938 REM-TRM-0.
  8939     SUBTRACT REM-TRM1 FROM HLD-TRM GIVING REM-TRM1.
  8940     ADD +1   REM-TRM1 GIVING REM-TRM2.
  8941     GO TO REM-TRMX.
  8942
  8943 REM-TRM-1.
  8944     SUBTRACT REM-TRM1 FROM HLD-TRM GIVING REM-TRM1.
  8945     MOVE REM-TRM1               TO REM-TRM2.
  8946     GO TO REM-TRMX.
  8947
  8948 REM-TRM-2.
  8949     SUBTRACT REM-TRM1 FROM HLD-TRM GIVING REM-TRM2.
  8950     MOVE REM-TRM2               TO REM-TRM1.
  8951     IF REM-TRM2 NOT = +0
  8952         COMPUTE REM-TRM1 = REM-TRM2 - +.5.
  8953
  8954 REM-TRMX.
  8955     EXIT.
  8956
  8957 6000-EXIT.
  8958     EXIT.
  8959
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 182
* ECS150P.cbl
  8961 7000-LEVEL-BREAK-PROCESSING SECTION 40.
  8962
  8963 7100-REINS-CO-BREAK.
  8964     PERFORM 7200-CARRIER-BREAK THRU 7200-EXIT.
  8965     MOVE 1                      TO CL.
  8966     PERFORM 8200-RECORD-SETUP THRU 8200-EXIT.
  8967     MOVE 19                     TO ER-REC-TYPE.
  8968     MOVE LAST-REINS-CO          TO ER-REINS-CO.
  8969     WRITE CLAS150-EXTRACT-RECORD-B FROM CLAS150-EXTRACT-RECORD.
  8970     PERFORM 8100-CLEAR-TABLES THRU 8100-EXIT.
  8971
  8972 7100-EXIT.
  8973     EXIT.
  8974
  8975 7200-CARRIER-BREAK.
  8976     PERFORM 7300-COMPANY-BREAK THRU 7300-EXIT.
  8977     MOVE +2                     TO CL.
  8978     PERFORM 7900-ROLL-TOTALS THRU 7900-EXIT.
  8979     PERFORM 8200-RECORD-SETUP THRU 8200-EXIT.
  8980     MOVE 18                     TO ER-REC-TYPE
  8981     MOVE LAST-REINS-CO          TO ER-REINS-CO.
  8982     MOVE LAST-CARRIER           TO ER-CARRIER.
  8983     WRITE CLAS150-EXTRACT-RECORD-B FROM CLAS150-EXTRACT-RECORD.
  8984     PERFORM 8100-CLEAR-TABLES THRU 8100-EXIT.
  8985
  8986 7200-EXIT.
  8987     EXIT.
  8988
  8989 7300-COMPANY-BREAK.
  8990     PERFORM 7400-STATE-BREAK THRU 7400-EXIT.
  8991     MOVE +3                     TO CL.
  8992     PERFORM 7900-ROLL-TOTALS THRU 7900-EXIT.
  8993     PERFORM 8200-RECORD-SETUP THRU 8200-EXIT.
  8994     MOVE 17                     TO ER-REC-TYPE.
  8995     MOVE LAST-REINS-CO          TO ER-REINS-CO.
  8996     MOVE LAST-CARRIER           TO ER-CARRIER.
  8997     MOVE LAST-GROUPING          TO ER-COMPANY.
  8998     WRITE CLAS150-EXTRACT-RECORD-B FROM CLAS150-EXTRACT-RECORD.
  8999     PERFORM 8100-CLEAR-TABLES THRU 8100-EXIT.
  9000
  9001 7300-EXIT.
  9002     EXIT.
  9003
  9004 7400-STATE-BREAK.
  9005     PERFORM 7500-ACCOUNT-BREAK THRU 7500-EXIT.
  9006
  9007     IF FIRST-INS-PASS
  9008         GO TO 7450-STATE-BREAK-2.
  9009
  9010     MOVE +4                     TO CL.
  9011     PERFORM 7900-ROLL-TOTALS THRU 7900-EXIT.
  9012     PERFORM 8200-RECORD-SETUP THRU 8200-EXIT.
  9013     MOVE 16                     TO ER-REC-TYPE.
  9014     MOVE LAST-REINS-CO          TO ER-REINS-CO.
  9015     MOVE LAST-GROUPING          TO ER-COMPANY.
  9016     MOVE LAST-CARRIER           TO ER-CARRIER.
  9017     MOVE LAST-STATE             TO ER-STATE.
  9018     WRITE CLAS150-EXTRACT-RECORD-B FROM CLAS150-EXTRACT-RECORD.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 183
* ECS150P.cbl
  9019     PERFORM 8100-CLEAR-TABLES THRU 8100-EXIT.
  9020     MOVE LOW-VALUES             TO ER-SORT-KEY.
  9021     MOVE 20                     TO ER-REC-TYPE.
  9022     MOVE LAST-STATE             TO ER-STATE
  9023     WRITE CLAS150-EXTRACT-RECORD-C FROM CLAS150-EXTRACT-RECORD.
  9024     GO TO 7400-EXIT.
  9025
  9026 7450-STATE-BREAK-2.
  9027     MOVE +1                     TO CL.
  9028     PERFORM 8200-RECORD-SETUP THRU 8200-EXIT.
  9029     MOVE 11                     TO ER-REC-TYPE.
  9030     PERFORM 7460-WRITE-ST-EXTRACT THRU 7460-EXIT.
  9031
  9032     MOVE 09                     TO ER-REC-TYPE.
  9033     MOVE LAST-CARRIER           TO ER-CARRIER.
  9034     PERFORM 7460-WRITE-ST-EXTRACT THRU 7460-EXIT.
  9035
  9036     MOVE 07                     TO ER-REC-TYPE.
  9037     MOVE LAST-STATE             TO ER-STATE.
  9038     PERFORM 7460-WRITE-ST-EXTRACT THRU 7460-EXIT.
  9039
  9040     MOVE 05                     TO ER-REC-TYPE.
  9041     MOVE HIGH-VALUE             TO ER-STATE.
  9042     MOVE LAST-GROUPING          TO ER-COMPANY.
  9043     PERFORM 7460-WRITE-ST-EXTRACT THRU 7460-EXIT.
  9044
  9045     MOVE LAST-STATE             TO ER-STATE.
  9046     MOVE 03                     TO ER-REC-TYPE.
  9047     PERFORM 7460-WRITE-ST-EXTRACT THRU 7460-EXIT.
  9048
  9049     MOVE HIGH-VALUES            TO ER-CONTROL.
  9050     MOVE LAST-STATE             TO ER-ST-SEQ.
  9051     MOVE 13 TO                  ER-REC-TYPE.
  9052     PERFORM 7460-WRITE-ST-EXTRACT THRU 7460-EXIT.
  9053
  9054     PERFORM 8100-CLEAR-TABLES THRU 8100-EXIT.
  9055     MOVE +3                     TO CL.
  9056     PERFORM 8200-RECORD-SETUP THRU 8200-EXIT.
  9057     MOVE 12                     TO ER-REC-TYPE.
  9058     PERFORM 7460-WRITE-ST-EXTRACT THRU 7460-EXIT.
  9059
  9060     MOVE 10                     TO ER-REC-TYPE.
  9061     MOVE LAST-CARRIER           TO ER-CARRIER
  9062     PERFORM 7460-WRITE-ST-EXTRACT THRU 7460-EXIT.
  9063
  9064     MOVE 08                     TO ER-REC-TYPE.
  9065     MOVE LAST-STATE             TO ER-STATE.
  9066     PERFORM 7460-WRITE-ST-EXTRACT THRU 7460-EXIT.
  9067
  9068     MOVE 06                     TO ER-REC-TYPE.
  9069     MOVE HIGH-VALUE             TO ER-STATE.
  9070     MOVE LAST-GROUPING          TO ER-COMPANY.
  9071     PERFORM 7460-WRITE-ST-EXTRACT THRU 7460-EXIT.
  9072
  9073     MOVE 04                     TO ER-REC-TYPE.
  9074     MOVE LAST-STATE             TO ER-STATE.
  9075     PERFORM 7460-WRITE-ST-EXTRACT THRU 7460-EXIT.
  9076
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 184
* ECS150P.cbl
  9077     MOVE HIGH-VALUES            TO ER-CONTROL
  9078     MOVE LAST-STATE             TO ER-ST-SEQ.
  9079     MOVE 14                     TO ER-REC-TYPE.
  9080     PERFORM 7460-WRITE-ST-EXTRACT THRU 7460-EXIT.
  9081
  9082     PERFORM 8100-CLEAR-TABLES THRU 8100-EXIT.
  9083
  9084 7400-EXIT.
  9085     EXIT.
  9086
  9087 7460-WRITE-ST-EXTRACT.
  9088     WRITE CLAS150-EXTRACT-RECORD-A FROM CLAS150-EXTRACT-RECORD.
  9089
  9090 7460-EXIT.
  9091     EXIT.
  9092
  9093 7500-ACCOUNT-BREAK.
  9094     COMPUTE TERM-WORK = PERIOD-END-9 - PERIOD-START-9.
  9095
  9096     PERFORM 7505-ADJ-OB-TOTS THRU 7505-EXIT
  9097         VARYING TG FROM 1 BY 1
  9098             UNTIL TG GREATER +3.
  9099
  9100     GO TO 7510-ACCT-REIN-BREAK.
  9101
  9102 7505-ADJ-OB-TOTS.
  9103     IF REINSURANCE-PASS
  9104         MOVE +5                 TO CL
  9105         PERFORM 7507-OB-DIVIDE THRU 7507-EXIT
  9106     ELSE
  9107         MOVE +2                 TO CL
  9108         PERFORM 7507-OB-DIVIDE THRU 7507-EXIT
  9109         MOVE +4                 TO CL
  9110         PERFORM 7507-OB-DIVIDE THRU 7507-EXIT.
  9111
  9112 7505-EXIT.
  9113     EXIT.
  9114
  9115 7507-OB-DIVIDE.
  9116*    IF ISSUE-AMT (CL  TG  3) NOT = 0
  9117*        DIVIDE 12 INTO ISSUE-AMT (CL  TG  3)
  9118*        MOVE +1                 TO ISSUE-CNT (CL  TG  3).
  9119*
  9120*    IF ISSUE-AMT (CL  TG  8) NOT = 0
  9121*        DIVIDE 12 INTO ISSUE-AMT (CL  TG  8)
  9122*        MOVE +1                 TO ISSUE-CNT (CL  TG  8).
  9123*
  9124*    IF ISSUE-AMT (CL  TG  5) NOT = 0
  9125*        DIVIDE 12 INTO ISSUE-AMT (CL  TG  5)
  9126*        MOVE +1                 TO ISSUE-CNT (CL  TG  5).
  9127*
  9128*    IF ISSUE-AMT (CL  TG  10) NOT = 0
  9129*        DIVIDE 12 INTO ISSUE-AMT (CL  TG  10)
  9130*        MOVE +1                 TO ISSUE-CNT (CL  TG  10).
  9131
  9132 7507-EXIT.
  9133     EXIT.
  9134
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 185
* ECS150P.cbl
  9135 7510-ACCT-REIN-BREAK.
  9136     IF FIRST-INS-PASS
  9137         GO TO 7550-ACCNT-BREAK-2.
  9138
  9139     MOVE +5                     TO CL.
  9140     PERFORM 7900-ROLL-TOTALS THRU 7900-EXIT.
  9141     PERFORM 8200-RECORD-SETUP THRU 8200-EXIT.
  9142     MOVE SAVE-CONTROL-BREAKS    TO ER-CONTROL.
  9143     MOVE 15                     TO ER-REC-TYPE.
  9144     WRITE CLAS150-EXTRACT-RECORD-B FROM CLAS150-EXTRACT-RECORD.
  9145
  9146     IF DTE-PGM-OPT = 1
  9147         PERFORM 5200-PRINT-SUMMARY-TOTALS THRU 5200-EXIT.
  9148
  9149     PERFORM 8100-CLEAR-TABLES THRU 8100-EXIT.
  9150     GO TO 7500-EXIT.
  9151
  9152 7550-ACCNT-BREAK-2.
  9153     MOVE +2                     TO CL.
  9154     PERFORM 7900-ROLL-TOTALS THRU 7900-EXIT.
  9155     PERFORM 8200-RECORD-SETUP THRU 8200-EXIT.
  9156     MOVE SAVE-CONTROL-BREAKS    TO ER-CONTROL.
  9157     MOVE 01                     TO ER-REC-TYPE.
  9158     WRITE CLAS150-EXTRACT-RECORD-A FROM CLAS150-EXTRACT-RECORD.
  9159
  9160     MOVE +4                     TO CL.
  9161     PERFORM 7900-ROLL-TOTALS THRU 7900-EXIT.
  9162     PERFORM 8200-RECORD-SETUP THRU 8200-EXIT.
  9163     MOVE SAVE-CONTROL-BREAKS    TO ER-CONTROL.
  9164     MOVE 02                     TO ER-REC-TYPE.
  9165     WRITE CLAS150-EXTRACT-RECORD-A FROM CLAS150-EXTRACT-RECORD.
  9166
  9167     IF DTE-PGM-OPT = 1
  9168         PERFORM 5200-PRINT-SUMMARY-TOTALS THRU 5200-EXIT.
  9169     MOVE +4                     TO CL.
  9170     PERFORM 8100-CLEAR-TABLES THRU 8100-EXIT.
  9171     MOVE +2                     TO CL.
  9172     PERFORM 8100-CLEAR-TABLES THRU 8100-EXIT.
  9173
  9174 7500-EXIT.
  9175     EXIT.
  9176
  9177 7900-ROLL-TOTALS.
  9178     COMPUTE CLX = CL - 1.
  9179     ADD CORRESPONDING A-CONTROL-LEVELS (CL) TO
  9180                       A-CONTROL-LEVELS (CLX).
  9181     PERFORM 7910-TERM-LOOP THRU 7910-EXIT
  9182         VARYING TG FROM +1 BY +1
  9183             UNTIL TG GREATER +3.
  9184
  9185 7900-EXIT.
  9186     EXIT.
  9187
  9188 7910-TERM-LOOP.
  9189     PERFORM 7920-ROLL-ACTIVITY THRU 7920-EXIT
  9190         VARYING IY FROM +1 BY +1
  9191             UNTIL IY GREATER +10.
  9192     PERFORM 7930-ROLL-EXHIBIT THRU 7930-EXIT
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 186
* ECS150P.cbl
  9193         VARYING EG FROM +1 BY +1
  9194             UNTIL EG GREATER +9.
  9195
  9196 7910-EXIT.
  9197     EXIT.
  9198
  9199 7920-ROLL-ACTIVITY.
  9200     ADD CORRESPONDING INSURANCE-TYPES (CL  TG  IY) TO
  9201                       INSURANCE-TYPES (CLX  TG  IY).
  9202
  9203 7920-EXIT.
  9204     EXIT.
  9205
  9206 7930-ROLL-EXHIBIT.
  9207     ADD CORRESPONDING EXHIBIT-GROUPS (CL  TG  EG) TO
  9208                       EXHIBIT-GROUPS (CLX  TG  EG).
  9209
  9210 7930-EXIT.
  9211     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 187
* ECS150P.cbl
  9213 8000-MISCELANEOUS-ROUTINES  SECTION 32.
  9214
  9215 8100-CLEAR-TABLES.
  9216     MOVE ZERO                   TO AH-PAID-THIS-YR (CL)
  9217                                    AH-PAID-LAST-YR (CL).
  9218
  9219     PERFORM 8110-ZERO-TERM-GROUPS THRU 8110-EXIT
  9220         VARYING TG FROM +1 BY +1
  9221             UNTIL TG GREATER THAN 3.
  9222
  9223 8100-EXIT.
  9224     EXIT.
  9225
  9226 8110-ZERO-TERM-GROUPS.
  9227     PERFORM 8120-ZERO-ACTIVITY THRU 8120-EXIT
  9228         VARYING IY FROM +1 BY +1
  9229             UNTIL IY GREATER +10.
  9230
  9231     PERFORM 8130-ZERO-EXHIBIT THRU 8130-EXIT
  9232         VARYING EG FROM +1 BY +1
  9233             UNTIL EG GREATER +9.
  9234
  9235 8110-EXIT.
  9236     EXIT.
  9237
  9238 8120-ZERO-ACTIVITY.
  9239     MOVE ZERO                  TO ISSUE-CNT   (CL  TG  IY)
  9240                                   ISSUE-AMT   (CL  TG  IY)
  9241                                   ISSUE-PREM  (CL  TG  IY)
  9242                                   CANCEL-CNT  (CL  TG  IY)
  9243                                   CANCEL-PREM (CL  TG  IY)
  9244                                   CANCEL-AMT  (CL  TG  IY)
  9245                                   CLAIM-CNT   (CL  TG  IY)
  9246                                   CLAIM-AMT   (CL  TG  IY)
  9247                                   EARN-PREM   (CL  TG  IY).
  9248
  9249 8120-EXIT.
  9250     EXIT.
  9251
  9252 8130-ZERO-EXHIBIT.
  9253     MOVE ZERO                  TO GROUP-CNT (CL  TG  EG)
  9254                                   GROUP-AMT (CL  TG  EG)
  9255                                   IND-CNT   (CL  TG  EG)
  9256                                   IND-AMT   (CL  TG  EG).
  9257
  9258 8130-EXIT.
  9259     EXIT.
  9260
  9261 8200-RECORD-SETUP.
  9262     MOVE LOW-VALUES             TO ER-SORT-KEY.
  9263     MOVE RUN-DATE               TO ER-PERIOD-START.
  9264     MOVE EP-DT                  TO ER-PERIOD-END.
  9265     MOVE CONTROL-LEVELS (CL)    TO ER-ACTIVITY-TOTALS.
  9266     MOVE E-CONTROL-LEVELS (CL)  TO ER-EXHIBIT-TOTALS.
  9267     MOVE AH-PAID-THIS-YR (CL)   TO ER-AH-PD-THIS.
  9268     MOVE AH-PAID-LAST-YR (CL)   TO ER-AH-PD-LAST.
  9269     MOVE HIGH-VALUES            TO ER-CONTROL.
  9270
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 188
* ECS150P.cbl
  9271 8200-EXIT.
  9272     EXIT.
  9273
  9274 8300-STARTING-INFORCE.
  9275
  9276     IF CR-LFAMT-ALT NOT NUMERIC
  9277         MOVE ZEROS TO CR-LFAMT-ALT.
  9278
  9279     IF CR-ENTRY-STATUS = '3' OR '5'
  9280         MOVE ZERO               TO INFORCE-DOLLARS
  9281         GO TO 8300-EXIT.
  9282
  9283     IF SUMMARY-REC
  9284         NEXT SENTENCE
  9285       ELSE
  9286          MOVE CR-LFAMT          TO INFORCE-DOLLARS.
  9287
  9288     IF CLAS-I-RL-AH (CLAS-INDEXL) = 'L' OR 'P'
  9289         GO TO 8390-OB-ADJ.
  9290
  9291     MOVE CR-CC                  TO WS-CR-CCYY (1:2).
  9292     MOVE CR-YR                  TO WS-CR-CCYY (3:2).
  9293
  9294     COMPUTE VALUATION-DATE = CR-LF-TERM -
  9295       (((RUN-CCYY * 12) + RUN-MO) -
  9296                            ((WS-CR-CCYY * 12) + CR-MO)).
  9297
  9298     MOVE SAVE-REM-TERM              TO UNEXPIRED-MONTHS.
  9299     COMPUTE EXPIRED-MONTHS = CR-LF-TERM - UNEXPIRED-MONTHS.
  9300
  9301     IF SAVE-REM-TERM  = CR-LF-TERM
  9302         MOVE CR-LFAMT  TO  INFORCE-DOLLARS
  9303         IF CLAS-I-EP (CLAS-INDEXL) = 'B'
  9304             ADD CR-LFAMT-ALT      TO INFORCE-DOLLARS
  9305             GO TO 8300-EXIT
  9306         ELSE
  9307             GO TO 8300-EXIT.
  9308
  9309     IF UNEXPIRED-MONTHS NOT GREATER ZERO
  9310         IF LF-BAL-REMTRM NOT GREATER THAN ZERO
  9311             MOVE ZEROS TO INFORCE-DOLLARS
  9312             GO TO 8300-EXIT.
  9313
  9314     IF SUMMARY-REC
  9315         COMPUTE TEMP-RESULT-L ROUNDED =
  9316                         INFORCE-DOLLARS / CR-LF-TERM
  9317      ELSE
  9318         COMPUTE TEMP-RESULT-L ROUNDED =
  9319                         CR-LFAMT / CR-LF-TERM.
  9320
  9321     IF REINSURANCE-PASS OR REINSURANCE-REC
  9322        IF CLAS-I-EP (CLAS-INDEXL) = 'B'
  9323            COMPUTE TEMP-RESULT-L ROUNDED  =
  9324            (RC-ORIG-LFAMT * RC-CEDE-FACT) / CR-LF-TERM.
  9325
  9326     IF CLAS-I-EP (CLAS-INDEXL) = 'T'
  9327         GO TO 8310-TEXAS-INFORCE.
  9328
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 189
* ECS150P.cbl
  9329     IF CLAS-I-EP (CLAS-INDEXL) = 'N'
  9330         GO TO 8320-NET-PAY-INFORCE.
  9331
  9332     IF DTE-CLIENT EQUAL 'FLU'
  9333         GO TO 8325-FLU-INFORCE.
  9334
  9335     IF CR-LFTYP = 'QD'
  9336        MOVE +15.0               TO CR-APR
  9337        GO TO 8320-NET-PAY-INFORCE
  9338     END-IF
  9339
  9340*    IF STATE-ABBR (CLAS-INDEXS) = 'OH'
  9341     IF (STATE-ABBR (CLAS-INDEXS) = 'OH') AND
  9342        (CR-RATING-CLASS NOT = 'L ')
  9343         IF (CR-DT GREATER THAN 19831031) AND
  9344            (CR-LF-TERM GREATER THAN +60)  AND
  9345            (CR-APR GREATER THAN ZERO)
  9346             GO TO 8320-NET-PAY-INFORCE.
  9347
  9348     IF STATE-ABBR (CLAS-INDEXS) = 'MT'
  9349         IF (CR-DT GREATER THAN 19830318) AND
  9350            (CR-LF-TERM GREATER THAN +61)  AND
  9351            (CR-APR GREATER THAN ZERO)
  9352             GO TO 8320-NET-PAY-INFORCE.
  9353
  9354     IF STATE-ABBR (CLAS-INDEXS) = 'UT'
  9355         IF (CR-DT GREATER THAN 19810831) AND
  9356            (CR-DT LESS THAN 19830901) AND
  9357            (CR-LF-TERM GREATER THAN +62)  AND
  9358            (CR-APR GREATER THAN ZERO)
  9359             GO TO 8320-NET-PAY-INFORCE.
  9360
  9361     IF STATE-ABBR (CLAS-INDEXS) = 'RI'
  9362         IF (CR-DT GREATER THAN 19831231) AND
  9363            (CR-LF-TERM GREATER THAN +60)  AND
  9364            (CR-APR GREATER THAN ZERO)
  9365             GO TO 8320-NET-PAY-INFORCE.
  9366
  9367 8305-REG-INFORCE.
  9368
  9369     COMPUTE INFORCE-DOLLARS ROUNDED =
  9370         (TEMP-RESULT-L * UNEXPIRED-MONTHS) + CR-LFAMT-ALT.
  9371
  9372     IF REINSURANCE-PASS OR REINSURANCE-REC
  9373        IF CLAS-I-EP (CLAS-INDEXL) = 'B'
  9374         COMPUTE INFORCE-DOLLARS ROUNDED =
  9375          (TEMP-RESULT-L * UNEXPIRED-MONTHS) +
  9376          (CR-LFAMT-ALT * RC-CEDE-FACT).
  9377
  9378     GO TO 8390-OB-ADJ.
  9379
  9380 8310-TEXAS-INFORCE.
  9381     DIVIDE CR-LFAMT  BY  CR-LF-TERM
  9382         GIVING TEX-FACT-1.
  9383
  9384     DIVIDE UNEXPIRED-MONTHS  BY  CR-PMT-FREQ
  9385         GIVING TEX-FACT-2
  9386         REMAINDER TEX-FACT-3.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 190
* ECS150P.cbl
  9387
  9388     IF TEX-FACT-3 NOT ZERO
  9389         ADD +1 TO TEX-FACT-2.
  9390
  9391     IF (TEX-FACT-2 * CR-PMT-FREQ) = CR-LF-TERM
  9392         MOVE CR-LFAMT  TO  INFORCE-DOLLARS
  9393     ELSE
  9394         COMPUTE INFORCE-DOLLARS ROUNDED =
  9395             (TEX-FACT-1 * (TEX-FACT-2 * CR-PMT-FREQ)).
  9396
  9397     GO TO 8390-OB-ADJ.
  9398
  9399 8320-NET-PAY-INFORCE.
  9400
  9401     MOVE CR-DT                  TO  DC-GREG-DATE-CYMD.
  9402     MOVE 'L'                    TO  DC-OPTION-CODE.
  9403     PERFORM 8500-DATE-CONVERT-ROUTINE THRU
  9404             8599-DATE-CONVERT-X
  9405
  9406     MOVE DC-BIN-DATE-1          TO  CP-CERT-EFF-DT.
  9407
  9408     IF CR-LOAN-1ST-PMT-DT NOT = ZEROS
  9409         MOVE CR-LOAN-1ST-PMT-DT TO  DC-GREG-DATE-1-YMD
  9410         MOVE '3'                TO  DC-OPTION-CODE
  9411         PERFORM 8500-DATE-CONVERT-ROUTINE THRU
  9412                 8599-DATE-CONVERT-X
  9413         MOVE DC-BIN-DATE-1      TO  CP-FIRST-PAY-DATE
  9414     ELSE
  9415         MOVE CP-CERT-EFF-DT     TO  DC-BIN-DATE-1
  9416         MOVE +1                 TO  DC-ELAPSED-MONTHS
  9417         MOVE +0                 TO  DC-ELAPSED-DAYS
  9418         MOVE '6'                TO  DC-OPTION-CODE
  9419         PERFORM 8500-DATE-CONVERT-ROUTINE THRU
  9420             8599-DATE-CONVERT-X
  9421         MOVE DC-BIN-DATE-2      TO  CP-FIRST-PAY-DATE.
  9422
  9423     MOVE CR-LFAMT               TO  CP-ORIGINAL-BENEFIT.
  9424     MOVE CR-APR                 TO  CP-LOAN-APR.
  9425     MOVE CR-LF-TERM             TO  CP-ORIGINAL-TERM.
  9426     MOVE CR-LOAN-TERM           TO  CP-LOAN-TERM.
  9427     MOVE SAVE-REM-TERM          TO  CP-REMAINING-TERM.
  9428     MOVE STATE-ABBR       (CLAS-INDEXS) TO  CP-STATE-STD-ABBRV.
  9429     MOVE CLAS-I-CALC-TYPE (CLAS-INDEXL) TO  CP-SPECIAL-CALC-CD.
  9430     MOVE CLAS-I-RL-AH     (CLAS-INDEXL) TO  CP-BENEFIT-TYPE.
  9431     MOVE CLAS-I-EP        (CLAS-INDEXL) TO  CP-EARNING-METHOD.
  9432
  9433     CALL 'ELRAMTX' USING CALCULATION-PASS-AREA.
  9434
  9435     IF SUMMARY-REC
  9436         COMPUTE INFORCE-DOLLARS ROUNDED = CP-REMAMT-FACTOR *
  9437                                      (INFORCE-DOLLARS / +1000)
  9438         GO TO 8390-OB-ADJ.
  9439
  9440     IF CP-STATE-STD-ABBRV = 'NC'
  9441               AND
  9442*      DTE-CLIENT NOT = 'WDS'
  9443       (DTE-CLIENT NOT = 'WDS' AND 'CID')
  9444         IF CP-CERT-EFF-DT GREATER THAN WS-931231
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 191
* ECS150P.cbl
  9445             MOVE CP-REMAINING-AMT TO  INFORCE-DOLLARS
  9446             GO TO 8390-OB-ADJ.
  9447
  9448      COMPUTE INFORCE-DOLLARS ROUNDED = CP-REMAMT-FACTOR *
  9449                                      (CR-LFAMT / +1000).
  9450
  9451     GO TO 8390-OB-ADJ.
  9452
  9453 8325-FLU-INFORCE.
  9454     MOVE CR-APR                 TO NP-APR.
  9455     MOVE CR-LF-TERM             TO NP-ORIG  NP-CAP.
  9456     COMPUTE NP251-REM = CR-LF-TERM - TERM-WORK.
  9457     MOVE '1'                    TO NP-OPT.
  9458     MOVE CR-AHPRM               TO NP-AHPRM.
  9459     MOVE CR-ACCOUNT             TO NP-ACCOUNT.
  9460     MOVE CR-DT                  TO NP-EFF-DT.
  9461     MOVE CR-LFAMT               TO NP-BENEFIT.
  9462***  CALL 'IBKE251B'
  9463***      USING NP-ACCOUNT NP-EFF-DT NP-BENEFIT NP-AHPRM NP251-REM
  9464***            NP251-ORIG NP-SUB NP-REMAINING.
  9465     MOVE NP-REMAINING           TO INFORCE-DOLLARS.
  9466     GO TO 8390-OB-ADJ.
  9467
  9468 8350-ENDING-INFORCE.
  9469     IF CR-LFAMT-ALT NOT NUMERIC
  9470         MOVE ZEROS TO CR-LFAMT-ALT.
  9471
  9472     IF CR-ENTRY-STATUS = '3' OR '5'
  9473         MOVE ZERO               TO INFORCE-DOLLARS
  9474         GO TO 8300-EXIT.
  9475
  9476     IF SUMMARY-REC
  9477         NEXT SENTENCE
  9478       ELSE
  9479          MOVE CR-LFAMT          TO INFORCE-DOLLARS.
  9480
  9481     IF CLAS-I-RL-AH (CLAS-INDEXL) = 'L' OR 'P'
  9482         IF CLAS-I-EP (CLAS-INDEXL) = 'B'
  9483             ADD CR-LFAMT-ALT    TO INFORCE-DOLLARS
  9484             GO TO 8390-OB-ADJ
  9485         ELSE
  9486             GO TO 8390-OB-ADJ.
  9487
  9488     MOVE CP-REMAINING-TERM-2        TO UNEXPIRED-MONTHS.
  9489     COMPUTE EXPIRED-MONTHS = CR-LF-TERM - UNEXPIRED-MONTHS.
  9490
  9491     IF CP-REMAINING-TERM-2 = CR-LF-TERM
  9492         MOVE CR-LFAMT  TO  INFORCE-DOLLARS
  9493         IF CLAS-I-EP (CLAS-INDEXL) = 'B'
  9494            IF REINSURANCE-PASS OR REINSURANCE-REC
  9495                NEXT SENTENCE
  9496            ELSE
  9497                ADD CR-LFAMT-ALT    TO INFORCE-DOLLARS
  9498                GO TO 8390-OB-ADJ
  9499         ELSE
  9500             GO TO 8300-EXIT.
  9501
  9502     IF UNEXPIRED-MONTHS NOT GREATER ZERO
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 192
* ECS150P.cbl
  9503         IF LF-BAL-REMTRM NOT GREATER THAN ZERO
  9504             MOVE ZEROS TO INFORCE-DOLLARS
  9505             GO TO 8300-EXIT.
  9506
  9507     MOVE CR-CC                  TO WS-CR-CCYY (1:2).
  9508     MOVE CR-YR                  TO WS-CR-CCYY (3:2).
  9509     COMPUTE VALUATION-DATE = CR-LF-TERM -
  9510        (((EP-CCYY * 12) + EP-MO)
  9511                    - ((WS-CR-CCYY * 12) + CR-MO)).
  9512
  9513     IF SUMMARY-REC
  9514         COMPUTE TEMP-RESULT-L ROUNDED =
  9515                           INFORCE-DOLLARS / CR-LF-TERM
  9516      ELSE
  9517         COMPUTE TEMP-RESULT-L ROUNDED =
  9518                           CR-LFAMT / CR-LF-TERM.
  9519
  9520     IF REINSURANCE-PASS OR REINSURANCE-REC
  9521        IF CLAS-I-EP (CLAS-INDEXL) = 'B'
  9522         COMPUTE TEMP-RESULT-L ROUNDED =
  9523          (RC-ORIG-LFAMT * RC-CEDE-FACT) / CR-LF-TERM.
  9524
  9525     IF CLAS-I-EP (CLAS-INDEXL) = 'B'
  9526         GO TO 8355-NORMAL-ENDING.
  9527
  9528     IF CLAS-I-EP (CLAS-INDEXL) = 'T'
  9529         GO TO 8360-TEXAS-ENDING.
  9530
  9531     IF DTE-CLIENT = 'NCL'
  9532       IF CR-DT LESS 19910101
  9533         GO TO 8355-NORMAL-ENDING.
  9534
  9535     IF CLAS-I-EP (CLAS-INDEXL) = 'N'
  9536         GO TO 8370-NET-PAY-ENDING.
  9537
  9538     IF DTE-CLIENT = 'FLU'
  9539         GO TO 8375-FLU-ENDING.
  9540
  9541     IF CR-LFTYP = 'QD'
  9542        MOVE +15.0               TO CR-APR
  9543        GO TO 8370-NET-PAY-ENDING
  9544     END-IF
  9545
  9546*    IF STATE-ABBR (CLAS-INDEXS) = 'OH'
  9547     IF (STATE-ABBR (CLAS-INDEXS) = 'OH') AND
  9548        (CR-RATING-CLASS NOT = 'L ')
  9549         IF (CR-DT GREATER THAN 19831031) AND
  9550            (CR-LF-TERM GREATER THAN +60) AND
  9551            (CR-APR GREATER THAN ZERO)
  9552             GO TO 8370-NET-PAY-ENDING.
  9553
  9554     IF STATE-ABBR (CLAS-INDEXS) = 'MT'
  9555         IF (CR-DT GREATER THAN 19830318) AND
  9556            (CR-LF-TERM GREATER THAN +61) AND
  9557            (CR-APR GREATER THAN ZERO)
  9558             GO TO 8370-NET-PAY-ENDING.
  9559
  9560     IF STATE-ABBR (CLAS-INDEXS) = 'UT'
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 193
* ECS150P.cbl
  9561         IF (CR-DT GREATER THAN 19810831 ) AND
  9562            (CR-DT LESS THAN 19830901 ) AND
  9563            (CR-LF-TERM GREATER THAN +62) AND
  9564            (CR-APR GREATER THAN ZERO)
  9565             GO TO 8370-NET-PAY-ENDING.
  9566
  9567     IF STATE-ABBR (CLAS-INDEXS) = 'RI'
  9568         IF (CR-DT GREATER THAN 19831231) AND
  9569            (CR-LF-TERM GREATER THAN +60) AND
  9570            (CR-APR GREATER THAN ZERO)
  9571             GO TO 8370-NET-PAY-ENDING.
  9572
  9573 8355-NORMAL-ENDING.
  9574
  9575     COMPUTE INFORCE-DOLLARS ROUNDED =
  9576        (TEMP-RESULT-L * UNEXPIRED-MONTHS) + CR-LFAMT-ALT.
  9577
  9578     IF REINSURANCE-PASS OR REINSURANCE-REC
  9579         IF CLAS-I-EP (CLAS-INDEXL) = 'B'
  9580          COMPUTE INFORCE-DOLLARS ROUNDED =
  9581          (TEMP-RESULT-L * UNEXPIRED-MONTHS) +
  9582          (CR-LFAMT-ALT * RC-CEDE-FACT).
  9583
  9584     GO TO 8390-OB-ADJ.
  9585
  9586 8360-TEXAS-ENDING.
  9587     DIVIDE CR-LFAMT  BY  CR-LF-TERM
  9588         GIVING TEX-FACT-1.
  9589     DIVIDE UNEXPIRED-MONTHS  BY  CR-PMT-FREQ
  9590         GIVING TEX-FACT-2
  9591         REMAINDER TEX-FACT-3.
  9592     IF TEX-FACT-3 NOT ZERO
  9593         ADD +1 TO TEX-FACT-2.
  9594     IF (TEX-FACT-2 * CR-PMT-FREQ) = CR-LF-TERM
  9595         MOVE CR-LFAMT  TO  INFORCE-DOLLARS
  9596     ELSE
  9597         COMPUTE INFORCE-DOLLARS ROUNDED =
  9598             (TEX-FACT-1 * (TEX-FACT-2 * CR-PMT-FREQ)).
  9599
  9600****************************************************************
  9601*    DIVIDE VALUATION-DATE BY CR-PMT-FREQ
  9602*        GIVING TEX-FACT-2
  9603*            REMAINDER TEX-FACT-3.
  9604*    IF TEX-FACT-3 NOT = ZERO
  9605*        ADD +1 TO TEX-FACT-2.
  9606*    COMPUTE INFORCE-DOLLARS =
  9607*         (TEMP-RESULT-L * (TEX-FACT-2 * CR-PMT-FREQ)).
  9608
  9609     GO TO 8390-OB-ADJ.
  9610
  9611 8370-NET-PAY-ENDING.
  9612
  9613     MOVE CR-DT                  TO  DC-GREG-DATE-CYMD.
  9614     MOVE 'L'                    TO  DC-OPTION-CODE.
  9615     PERFORM 8500-DATE-CONVERT-ROUTINE THRU
  9616             8599-DATE-CONVERT-X.
  9617     MOVE DC-BIN-DATE-1          TO  CP-CERT-EFF-DT.
  9618
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 194
* ECS150P.cbl
  9619     IF CR-LOAN-1ST-PMT-DT NOT = ZEROS
  9620         MOVE CR-LOAN-1ST-PMT-DT TO  DC-GREG-DATE-1-YMD
  9621         MOVE '3'                TO  DC-OPTION-CODE
  9622         PERFORM 8500-DATE-CONVERT-ROUTINE THRU
  9623                 8599-DATE-CONVERT-X
  9624         MOVE DC-BIN-DATE-1      TO  CP-FIRST-PAY-DATE
  9625     ELSE
  9626         MOVE CP-CERT-EFF-DT     TO  DC-BIN-DATE-1
  9627         MOVE +1                 TO  DC-ELAPSED-MONTHS
  9628         MOVE +0                 TO  DC-ELAPSED-DAYS
  9629         MOVE '6'                TO  DC-OPTION-CODE
  9630         PERFORM 8500-DATE-CONVERT-ROUTINE THRU
  9631                 8599-DATE-CONVERT-X
  9632         MOVE DC-BIN-DATE-2      TO  CP-FIRST-PAY-DATE.
  9633
  9634     MOVE CR-LFAMT               TO  CP-ORIGINAL-BENEFIT.
  9635     MOVE CR-APR                 TO  CP-LOAN-APR.
  9636     MOVE CR-LF-TERM             TO  CP-ORIGINAL-TERM.
  9637     MOVE CR-LOAN-TERM           TO  CP-LOAN-TERM.
  9638     MOVE CP-REMAINING-TERM-2    TO  CP-REMAINING-TERM.
  9639     MOVE STATE-ABBR       (CLAS-INDEXS) TO  CP-STATE-STD-ABBRV.
  9640     MOVE CLAS-I-CALC-TYPE (CLAS-INDEXL) TO  CP-SPECIAL-CALC-CD.
  9641     MOVE CLAS-I-RL-AH     (CLAS-INDEXL) TO  CP-BENEFIT-TYPE.
  9642     MOVE CLAS-I-EP        (CLAS-INDEXL) TO  CP-EARNING-METHOD.
  9643
  9644     CALL 'ELRAMTX' USING CALCULATION-PASS-AREA.
  9645
  9646     IF SUMMARY-REC
  9647         COMPUTE INFORCE-DOLLARS ROUNDED = CP-REMAMT-FACTOR *
  9648                                      (INFORCE-DOLLARS / +1000)
  9649         GO TO 8390-OB-ADJ.
  9650
  9651     IF CP-STATE-STD-ABBRV = 'NC'
  9652               AND
  9653*      DTE-CLIENT NOT = 'WDS'
  9654       (DTE-CLIENT NOT = 'WDS' AND 'CID')
  9655         IF CP-CERT-EFF-DT GREATER THAN WS-931231
  9656             MOVE CP-REMAINING-AMT TO INFORCE-DOLLARS
  9657             GO TO 8390-OB-ADJ.
  9658
  9659      COMPUTE INFORCE-DOLLARS ROUNDED = CP-REMAMT-FACTOR *
  9660                                      (CR-LFAMT / +1000).
  9661
  9662     GO TO 8390-OB-ADJ.
  9663
  9664 8375-FLU-ENDING.
  9665     MOVE CR-APR                 TO NP-APR.
  9666     MOVE CR-LF-TERM             TO NP-ORIG  NP-CAP.
  9667     COMPUTE NP251-REM = CR-LF-TERM - TERM-WORK.
  9668     MOVE '1'                    TO NP-OPT.
  9669     MOVE CR-AHPRM               TO NP-AHPRM.
  9670     MOVE CR-ACCOUNT             TO NP-ACCOUNT.
  9671     MOVE CR-DT                  TO NP-EFF-DT.
  9672     MOVE CR-LFAMT               TO NP-BENEFIT.
  9673***  CALL 'IBKE251B'
  9674***      USING NP-ACCOUNT NP-EFF-DT NP-BENEFIT NP-AHPRM NP251-REM
  9675***            NP251-ORIG NP-SUB NP-REMAINING.
  9676     MOVE NP-REMAINING           TO INFORCE-DOLLARS.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 195
* ECS150P.cbl
  9677     GO TO 8390-OB-ADJ.
  9678
  9679 8390-OB-ADJ.
  9680     IF CLAS-I-BAL (CLAS-INDEXL) = 'B'
  9681         MOVE ZERO               TO INFORCE-DOLLARS.
  9682
  9683 8300-EXIT.
  9684     EXIT.
  9685
  9686 8400-ADD-TO-EXHIBIT.
  9687     IF GROUP-INS
  9688         ADD COUNT-WORK      TO GROUP-CNT (CL  TG  EG)
  9689         ADD INFORCE-DOLLARS TO GROUP-AMT (CL  TG  EG)
  9690     ELSE
  9691         ADD COUNT-WORK      TO IND-CNT (CL  TG  EG)
  9692         ADD INFORCE-DOLLARS TO IND-AMT (CL  TG  EG).
  9693
  9694 8400-EXIT.
  9695     EXIT.
  9696
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 196
* ECS150P.cbl
  9698 8450-RE-RATE-ROUTINE.
  9699
  9700     MOVE CR-DT                  TO  DC-GREG-DATE-CYMD.
  9701     MOVE 'L'                    TO  DC-OPTION-CODE.
  9702     PERFORM 8500-DATE-CONVERT-ROUTINE THRU 8599-DATE-CONVERT-X.
  9703     MOVE DC-BIN-DATE-1          TO  CP-CERT-EFF-DT.
  9704     MOVE CLAS-I-RL-AH (CLAS-INDEXA) TO  CP-BENEFIT-TYPE.
  9705     MOVE SPACES                 TO  CP-ACCT-FLD-5.
  9706     MOVE DTE-CLIENT             TO  CP-COMPANY-ID.
  9707     MOVE STATE-SUB (CLAS-INDEXS)    TO  CP-STATE.
  9708     MOVE STATE-ABBR (CLAS-INDEXS)   TO  CP-STATE-STD-ABBRV.
  9709
  9710     IF CR-AGE IS NOT NUMERIC
  9711         MOVE ZEROS              TO  CP-ISSUE-AGE
  9712     ELSE
  9713         MOVE CR-AGE             TO  CP-ISSUE-AGE.
  9714
  9715     MOVE CP-REMAINING-TERM-1    TO  CP-ORIGINAL-TERM.
  9716     MOVE CR-AHAMT               TO  CP-ORIGINAL-BENEFIT
  9717                                     CP-RATING-BENEFIT-AMT.
  9718
  9719     IF CP-STATE-STD-ABBRV = 'OR'
  9720         COMPUTE CP-RATING-BENEFIT-AMT =
  9721                                CR-AHAMT * CP-REMAINING-TERM-1.
  9722
  9723     MOVE CR-APR                 TO  CP-LOAN-APR.
  9724
  9725     IF CR-PMT-FREQ IS NOT NUMERIC
  9726         MOVE ZEROS              TO  CP-PAY-FREQUENCY
  9727     ELSE
  9728         MOVE CR-PMT-FREQ        TO  CP-PAY-FREQUENCY.
  9729
  9730     IF AH-EARN-METHOD = SPACES
  9731         MOVE CLAS-I-EP (CLAS-INDEXA) TO  CP-EARNING-METHOD
  9732     ELSE
  9733         MOVE AH-EARN-METHOD          TO  CP-EARNING-METHOD.
  9734
  9735     IF CR-RATING-CLASS NOT = SPACE AND ZERO
  9736         MOVE CR-RATING-CLASS    TO  CP-CLASS-CODE
  9737     ELSE
  9738         MOVE AM-CAL-TABLE       TO  CP-CLASS-CODE.
  9739
  9740     MOVE '3'                    TO  CP-PROCESS-TYPE.
  9741     MOVE CLAS-I-BAL (CLAS-INDEXA)   TO  CP-SPECIAL-CALC-CD.
  9742     MOVE CR-LOAN-TERM           TO  CP-LOAN-TERM.
  9743     MOVE AM-AH-DEVIATION        TO  CP-DEVIATION-CODE.
  9744     MOVE CR-AHTYP               TO  CP-BENEFIT-CD.
  9745     MOVE DTE-CLASIC-COMPANY-CD  TO  CP-COMPANY-CD.
  9746
  9747     IF CR-PMT-EXTENSION-DAYS IS NOT NUMERIC
  9748         MOVE ZEROS              TO  CP-TERM-OR-EXT-DAYS
  9749     ELSE
  9750         MOVE CR-PMT-EXTENSION-DAYS  TO  CP-TERM-OR-EXT-DAYS.
  9751
  9752     MOVE AH-OVERRIDE-L1         TO  CP-AH-OVERRIDE-CODE.
  9753
  9754     IF AM-AH-DEVIATION-PCT IS NOT NUMERIC
  9755         MOVE ZEROS              TO  CP-RATE-DEV-PCT
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 197
* ECS150P.cbl
  9756     ELSE
  9757         MOVE AM-AH-DEVIATION-PCT TO CP-RATE-DEV-PCT.
  9758
  9759 8455-CALL-RATING-ROUTINE.
  9760
  9761     CALL 'ELRATEX' USING CALCULATION-PASS-AREA.
  9762
  9763 8499-EXIT.
  9764     EXIT.
  9765
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 198
* ECS150P.cbl
  9767 8500-DATE-CONVERT-ROUTINE.
  9768
* 9769     COPY ELCDCS.
  9770****************************************************************  04/15/98
  9771*                                                              *  ELCDCS
  9772*                                                              *  ELCDCS
  9773*                            ELCDCS.                           *     LV003
  9774*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  9775*                            VMOD=2.002                        *     CL**3
  9776*                                                              *  ELCDCS
  9777*           THIS SECTION CALLS THE DATE CONVERSION SUBROUTINE. *  ELCDCS
  9778****************************************************************. ELCDCS
  9779                                                                  ELCDCS
  9780 8510-DATE-CONVERSION.                                            ELCDCS
  9781     CALL 'ELDATCX' USING DATE-CONVERSION-DATA.                   ELCDCS
  9782                                                                  ELCDCS
  9783 8590-EXIT.                                                       ELCDCS
  9784     EXIT.                                                        ELCDCS
  9785                                                                  ELCDCS
  9786
  9787 8599-DATE-CONVERT-X.
  9788     EXIT.
  9789
  9790 REIN-DATE-LOAD.
  9791     MOVE RE-CLM-INCURRED-LIM    TO  WS-RE-CLM-INCURRED-LIM-N.
  9792     MOVE RE-EARNING-START-DT    TO  WS-RE-EARNING-START-DT-N.
  9793     MOVE RE-EARNING-STOP-DT     TO  WS-RE-EARNING-STOP-DT-N.
  9794
  9795 9990-PROGRAM-END            SECTION 45.
  9796
  9797 9999-CLOSE-FICH.
* 9798                             COPY ELCPRTC.
  9799******************************************************************04/15/98
  9800*                                                                *ELCPRTC
  9801*                                                                *ELCPRTC
  9802*                            ELCPRTC.                            *   LV003
  9803*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
  9804*                            VMOD=2.002                          *   CL**2
  9805*       CLOSE FICH FILE IF OPEN                                  *ELCPRTC
  9806*                                                                *ELCPRTC
  9807* NOTE- USE ELCPRTCX IF USING ELCPRT2X (ONLINE REPORT SAVE)      *   CL**2
  9808******************************************************************ELCPRTC
  9809                                                                  ELCPRTC
  9810      IF FICH-OPEN NOT = SPACE                                    ELCPRTC
  9811          CLOSE FICH.                                             ELCPRTC
  9812                                                                  ELCPRTC
  9813******************************************************************ELCPRTC
  9814
  9815     CLOSE PRINT-FILE.
  9816
  9817     IF REIN-OPEN-SW EQUAL 'X'
  9818            MOVE SPACE           TO REIN-OPEN-SW
  9819            CLOSE ERRTBL-IN
  9820            IF ERRTBL-FILE-STATUS = '00'
  9821               NEXT SENTENCE
  9822            ELSE
  9823               MOVE '22'         TO ABEND-FILE-ID
  9824               MOVE ERRTBL-FILE-STATUS
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 199
* ECS150P.cbl
  9825                                 TO ABEND-REASON
  9826               GO TO ABEND-PGM.
  9827*
  9828*
  9829* LEAVE THE ABOVE 2 LINES IN TO PREVENT LOSING THE LINE ABOVE
  9830
  9831     MOVE ZEROS  TO RETURN-CODE.
  9832     GOBACK.
  9833
  9834 9999-EXIT.
  9835     EXIT.
  9836
  9837 ABEND-PGM.
* 9838                                 COPY ELCABEND.
  9839***************************************************************** 04/14/98
  9840*                                                               * ELCABEND
  9841*                            ELCABEND.                          *    LV003
  9842*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
  9843*                            VMOD 2.002                              CL**2
  9844*                                                               * ELCABEND
  9845*                THIS SECTION DISPLAYS THE NECESSARY MESSAGES   * ELCABEND
  9846*            AND THEN ABENDS.                                   * ELCABEND
  9847*                                                               * ELCABEND
  9848*  NO  CID  MODS  IN  COPYBOOK  ELCABEND                        * ELCABEND
  9849*                                                               * ELCABEND
  9850***************************************************************** ELCABEND
  9851*APS-010.                                                         ELCABEND
  9852     DISPLAY WS-ABEND-MESSAGE.                                    ELCABEND
  9853     DISPLAY WS-ABEND-MESSAGE UPON CONSOLE.                       ELCABEND
  9854                                                                  ELCABEND
  9855     IF WS-ABEND-FILE-STATUS NOT = ZERO                           ELCABEND
  9856         DISPLAY 'FILE STATUS = ' WS-ABEND-FILE-STATUS            ELCABEND
  9857         DISPLAY 'FILE STATUS = ' WS-ABEND-FILE-STATUS            ELCABEND
  9858                                 UPON CONSOLE.                    ELCABEND
  9859                                                                  ELCABEND
  9860     IF WS-RETURN-CODE NOT = ZERO                                 ELCABEND
  9861         DISPLAY 'RETURN CODE = '  WS-RETURN-CODE                 ELCABEND
  9862         DISPLAY 'RETURN CODE = '  WS-RETURN-CODE                 ELCABEND
  9863                                 UPON CONSOLE.                    ELCABEND
  9864                                                                  ELCABEND
  9865     DISPLAY 'PROGRAM WILL NOW ABEND **************'              ELCABEND
  9866     DISPLAY 'PROGRAM WILL NOW ABEND **************'              ELCABEND
  9867                                 UPON CONSOLE.                    ELCABEND
  9868                                                                  ELCABEND
  9869     DIVIDE WS-ZERO BY WS-ZERO GIVING WS-ZERO.                    ELCABEND
  9870     CALL 'ABORTME'.
  9871                                                                  ELCABEND
  9872 APS-EXIT.                                                        ELCABEND
  9873     EXIT.                                                        ELCABEND
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Last message on page:  178
* Total Messages:     3
* Unrecoverable :     0                    Severe  :     0
* Errors        :     3                    Warnings:     0
* Informational :     0                    Flags   :     0
* Data:      304388     Code:       47069
