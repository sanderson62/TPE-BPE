* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   1
* CPSRTU1.cbl
* Options: int("CPSRTU1.int") anim csi verbose NOBOUND PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("CPSRTU1.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"ebmlsfile" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" NOCHECKDIV NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"32" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"CPSRTU1.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"CPSRTU1.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR NOSTICKY-LINKAGE
*          NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"2" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2 PROGRAM-ID. CPSRTU1.
     3 AUTHOR.     PABLO
     4 ENVIRONMENT DIVISION.
     5 INPUT-OUTPUT SECTION.
     6 FILE-CONTROL.
     7
     8     SELECT RATE-FILE ASSIGN TO SYS010
     9         ORGANIZATION IS LINE SEQUENTIAL.
    10
    11     SELECT DISK-DATE ASSIGN TO SYS019.
    12
    13     SELECT ERRATE    ASSIGN ERRATE
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   2
* CPSRTU1.cbl
    14                      ORGANIZATION IS INDEXED
    15                      ACCESS IS DYNAMIC
    16                      RECORD KEY IS RT-CONTROL-PRIMARY
    17                      FILE STATUS IS ERRATE-FILE-STATUS.
    18     SELECT PRINTER   ASSIGN TO SYS008.
    19
    20
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   3
* CPSRTU1.cbl
    22 DATA DIVISION.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   4
* CPSRTU1.cbl
    23/
    24 FILE SECTION.
    25
    26 FD  RATE-FILE
    27     RECORDING MODE IS F
    28     RECORD CONTAINS 1552 CHARACTERS
    29     LABEL RECORDS ARE OMITTED.
    30
    31 01  RATE-RECORD-IN.
    32     05  RR-STATE                PIC XX.
    33     05  RR-CLASS                PIC XX.
    34     05  RR-DEVIATION            PIC XXX.
    35     05  RR-TYPE                 PIC X.
    36     05  RR-BEN-CODE             PIC XX.
    37     05  RR-AGE                  PIC XX.
    38     05  RR-AMT                  PIC 999999.
    39     05  RR-EFF-DT               PIC X(08).
    40     05  RR-ATT-AGE              PIC 99.
    41     05  RR-MORT                 PIC X(4).
    42     05  FILLER OCCURS 3.
    43         10  RR-TAGE             PIC 99.
    44         10  RR-TTERM            PIC 999.
    45         10  RR-TBEN             PIC 9(5).
    46         10  RR-TAMT             PIC 9(7).
    47     05  RR-COMMENTS             PIC X(50).
    48     05  RATE-VALUES OCCURS 180.
    49         10  RR-RATES            PIC 99V9(05).
    50
    51 FD  ERRATE
    52     LABEL RECORDS ARE STANDARD.
*   53                                 COPY ERCRATE.
    54******************************************************************01/20/90
    55*                                                                *ERCRATE
    56*                                                                *ERCRATE
    57*                            ERCRATE                             *   LV007
    58*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
    59*                            VMOD=2.008                          *   CL**7
    60*                                                                *ERCRATE
    61*   ONLINE CREDIT SYSTEM                                         *ERCRATE
    62*                                                                *ERCRATE
    63*   FILE DESCRIPTION = RATES MASTER FILE                         *ERCRATE
    64*                                                                *ERCRATE
    65*   FILE TYPE = VSAM,KSDS                                        *ERCRATE
    66*   RECORD SIZE = 1765  RECFORM = FIXED                          *ERCRATE
    67*                                                                *ERCRATE
    68*   BASE CLUSTER NAME = ERRATE                   RKP=2,LEN=28    *ERCRATE
    69*       ALTERNATE PATH = NONE                                    *ERCRATE
    70*                                                                *ERCRATE
    71*   LOG = NO                                                     *ERCRATE
    72*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *ERCRATE
    73*                                                                *ERCRATE
    74******************************************************************ERCRATE
    75                                                                  ERCRATE
    76 01  RATE-RECORD.                                                 ERCRATE
    77     12  RT-RECORD-ID                      PIC XX.                ERCRATE
    78         88  VALID-RT-ID                      VALUE 'RT'.         ERCRATE
    79                                                                  ERCRATE
    80     12  RT-CONTROL-PRIMARY.                                      ERCRATE
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   5
* CPSRTU1.cbl (/apps/prod/cid1p/copy/ERCRATE)
    81         16  RT-COMPANY-CD                 PIC X.                 ERCRATE
    82         16  RT-STATE-CODE.                                       ERCRATE
    83             20  RT-ST-CODE                PIC XX.                ERCRATE
    84             20  RT-ST-CLASS               PIC XX.                ERCRATE
    85             20  RT-ST-DEV                 PIC XXX.               ERCRATE
    86         16  RT-L-AH-CODE.                                        ERCRATE
    87             20  RT-L-AH                   PIC X.                 ERCRATE
    88             20  RT-LAH-NUM                PIC XX.                   CL**3
    89         16  RT-LIMITS.                                           ERCRATE
    90             20  RT-HIGH-AGE               PIC 99.                ERCRATE
    91             20  RT-HIGH-AMT               PIC 9(6).              ERCRATE
    92             20  RT-FUTURE                 PIC XX.                ERCRATE
    93             20  RT-SEX                    PIC X.                 ERCRATE
    94         16  RT-EXPIRY-DATE                PIC 9(11)  COMP-3.     ERCRATE
    95                                                                  ERCRATE
    96     12  RT-MAINT-INFORMATION.                                    ERCRATE
    97         16  RT-LAST-MAINT-DT              PIC XX.                ERCRATE
    98         16  RT-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3. ERCRATE
    99         16  RT-LAST-MAINT-USER            PIC X(4).              ERCRATE
   100         16  FILLER                        PIC X(10).             ERCRATE
   101                                                                  ERCRATE
   102     12  RT-STRUCTURE-COMMENT              PIC X(50).             ERCRATE
   103     12  RT-RATE-COMMENT                   PIC X(50).             ERCRATE
   104                                                                  ERCRATE
   105     12  CSL-RESERVED                      PIC X(10).                CL**7
   106     12  FILLER                            PIC X(12).                CL**7
   107                                                                  ERCRATE
   108     12  RT-MAX-AGE                        PIC 99.                ERCRATE
   109                                                                  ERCRATE
   110     12  RT-LIFE-LIMS-FLDS.                                       ERCRATE
   111         16  RT-LIFE-MORT-CODE             PIC X(4).              ERCRATE
   112         16  RT-LIFE-EXCEPTIONS   OCCURS 8 TIMES.                 ERCRATE
   113             20  RT-L-EX-AGE               PIC 99.                ERCRATE
   114             20  RT-L-EX-TERM              PIC S999       COMP-3. ERCRATE
   115             20  RT-L-EX-FACE              PIC S9(7)      COMP-3. ERCRATE
   116         16  FILLER                        PIC X(20).             ERCRATE
   117                                                                  ERCRATE
   118     12  RT-AH-LIMS-FLDS   REDEFINES   RT-LIFE-LIMS-FLDS.         ERCRATE
   119         16  RT-AH-EXCEPTIONS   OCCURS 8 TIMES.                   ERCRATE
   120             20  RT-AH-AGE                 PIC 99.                ERCRATE
   121             20  RT-AH-TERM                PIC S999       COMP-3. ERCRATE
   122             20  RT-AH-BEN-M               PIC S9(5)      COMP-3. ERCRATE
   123             20  RT-AH-BEN-F               PIC S9(7)      COMP-3. ERCRATE
   124                                                                  ERCRATE
   125     12  RT-LIFE-RATES.                                           ERCRATE
   126         16  RT-L-RATE  OCCURS 360 TIMES   PIC S99V9(5)   COMP-3. ERCRATE
   127                                                                  ERCRATE
   128     12  RT-AH-RATES   REDEFINES   RT-LIFE-RATES.                 ERCRATE
   129         16  RT-AH-RATE  OCCURS 360 TIMES  PIC S99V9(5)   COMP-3. ERCRATE
   130                                                                  ERCRATE
   131     12  RT-DAILY-RATE                     PIC S99V9(5)   COMP-3.    CL**2
   132                                                                     CL**2
   133     12  RT-DISCOUNT-OPTION                PIC X.                    CL**5
   134         88  RT-DO-NOT-USE                     VALUE ' '.            CL**5
   135         88  RT-USE-DISCOUNT-FACTOR            VALUE '1'.            CL**5
   136         88  RT-USE-APR-AS-DISCOUNT            VALUE '2'.            CL**5
   137                                                                     CL**5
   138     12  RT-DISCOUNT-RATE                  PIC S99V9(5)   COMP-3.    CL**5
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   6
* CPSRTU1.cbl (/apps/prod/cid1p/copy/ERCRATE)
   139     12  RT-DISCOUNT-OB-RATE               PIC S99V9(5)   COMP-3.    CL**5
   140                                                                     CL**5
   141     12  RT-COMPOSITE-OPTION               PIC X.                    CL**6
   142         88  RT-NO-COMPOSITE                   VALUE ' '.            CL**6
   143         88  RT-USE-COMPOSITE-RATE             VALUE '1'.            CL**6
   144                                                                     CL**6
   145     12  RT-COMPOSITE-RATE                 PIC S99V9(5)   COMP-3.    CL**6
   146                                                                     CL**6
   147     12  RT-POLICY-FEE                     PIC S9(3)V99   COMP-3.    CL**7
   148     12  FILLER                            PIC X(13).                CL**7
   149                                                                     CL**4
   150     12  RT-TYPE-RATE                      PIC X.                    CL**4
   151         88  RT-IS-STND                        VALUE ' ' 'S'.        CL**4
   152         88  RT-IS-OB                          VALUE 'O'.            CL**4
   153                                                                  ERCRATE
   154     12  RT-SRT-ALPHA                      PIC X.                 ERCRATE
   155                                                                  ERCRATE
   156     12  RT-CONTROL-2.                                            ERCRATE
   157         16  RTC-1                         PIC X(7).              ERCRATE
   158         16  RTC-3                         PIC X(11).             ERCRATE
   159         16  RTC-4                         PIC 9(11) COMP-3.      ERCRATE
   160         16  RTC-2                         PIC X(3).              ERCRATE
   161******************************************************************ERCRATE
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   7
* CPSRTU1.cbl
   163
   164 FD  DISK-DATE
*  165                                 COPY ELCDTEFD.
   166******************************************************************04/15/98
   167*                                                                *ELCDTEFD
   168*                                                                *ELCDTEFD
   169*                            ELCDTEFD.                           *   LV002
   170*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
   171*                            VMOD=2.007                          *   CL**2
   172*                                                                *ELCDTEFD
   173******************************************************************ELCDTEFD
   174     BLOCK CONTAINS 0 RECORDS
   175     RECORDING MODE F.                                            ELCDTEFD
   176                                                                  ELCDTEFD
   177 01  DATE-DISK.                                                   ELCDTEFD
   178     12  DD-ID                       PIC  X(4).                   ELCDTEFD
   179     12  FILLER                      PIC  X(14).                  ELCDTEFD
   180     12  DD-CR1                      PIC  9.                      ELCDTEFD
   181     12  DD-CR1N                     PIC  X(30).                  ELCDTEFD
   182     12  DD-CR2                      PIC  9.                      ELCDTEFD
   183     12  DD-CR2N                     PIC  X(30).                  ELCDTEFD
   184     12  FILLER                      PIC  X(20).                  ELCDTEFD
   185                                                                  ELCDTEFD
   186 01  DATE-DISK-R.                                                 ELCDTEFD
   187     12  FILLER                      PIC  X(4).                   ELCDTEFD
   188     12  DD-ST           OCCURS 3 TIMES                           ELCDTEFD
   189                                     PIC  X(32).                  ELCDTEFD
   190                                                                  ELCDTEFD
   191 01  DATE-DISK-T.                                                 ELCDTEFD
   192     12  FILLER                      PIC  X(4).                   ELCDTEFD
   193     12  DD-TYPE         OCCURS 2 TIMES                           ELCDTEFD
   194                                     PIC  X(48).                  ELCDTEFD
   195                                                                  ELCDTEFD
   196 01  DATE-DISK-M.                                                 ELCDTEFD
   197     12  FILLER                      PIC  X(4).                   ELCDTEFD
   198     12  DD-MORT         OCCURS 2 TIMES                           ELCDTEFD
   199                                     PIC  X(48).                  ELCDTEFD
   200                                                                  ELCDTEFD
   201 01  DATE-DISK-P.                                                 ELCDTEFD
   202     12  DD-IDA                      PIC  XX.                     ELCDTEFD
   203     12  DD-IDX                      PIC  99.                     ELCDTEFD
   204     12  DD-DATA                     PIC  X(96).                  ELCDTEFD
   205     12  FILLER  REDEFINES DD-DATA.                               ELCDTEFD
   206         16  DD-PS-PIC   OCCURS 50 TIMES                          ELCDTEFD
   207                                     PIC  X.                      ELCDTEFD
   208         16  FILLER                  PIC  X(46).                  ELCDTEFD
   209     12  FILLER  REDEFINES DD-DATA.                               ELCDTEFD
   210         16  DD-PS-PICO  OCCURS 20 TIMES.                         ELCDTEFD
   211             20  DD-PS-PRT           PIC  X.                      ELCDTEFD
   212             20  DD-PS-FMT           PIC  X.                      ELCDTEFD
   213             20  DD-PS-PRC           PIC  X.                      ELCDTEFD
   214             20  DD-PS-TOT           PIC  X.                      ELCDTEFD
   215         16  FILLER                  PIC  X(16).                  ELCDTEFD
   216                                                                  ELCDTEFD
   217 01  DATE-DISK-E.                                                 ELCDTEFD
   218     12  FILLER                      PIC  X(4).                   ELCDTEFD
   219     12  DD-EDIT         OCCURS 24 TIMES                          ELCDTEFD
   220                                     PIC  X(4).                   ELCDTEFD
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   8
* CPSRTU1.cbl (/apps/prod/cid1p/copy/ELCDTEFD)
   221                                                                  ELCDTEFD
   222 01  DATE-DISK-C.                                                 ELCDTEFD
   223     12  FILLER                      PIC  X(7).                   ELCDTEFD
   224     12  DD-CARR1-SECPAY-SW          PIC  X.
   225     12  DD-CARR1-UEP-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   226     12  DD-CARR1-R78-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   227     12  DD-CARR1-PRO-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   228     12  DD-CARR1                    PIC  X.                      ELCDTEFD
   229     12  DD-CARR1S                   PIC  XX.                     ELCDTEFD
   230     12  DD-CARR1N                   PIC  X(30).                  ELCDTEFD
   231     12  DD-CARR2                    PIC  X.                      ELCDTEFD
   232     12  DD-CARR2S                   PIC  XX.                     ELCDTEFD
   233     12  DD-CARR2N                   PIC  X(30).                  ELCDTEFD
   234     12  DD-CARR2-UEP-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   235     12  DD-CARR2-R78-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   236     12  DD-CARR2-PRO-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   237     12  DD-CARR2-SECPAY-SW          PIC  X.
   238     12  FILLER                      PIC  X(7).                   ELCDTEFD
   239                                                                  ELCDTEFD
   240 01  DATE-DISK-OPT.                                               ELCDTEFD
   241     12  FILLER                      PIC  X(04).                  ELCDTEFD
   242     12  DD-TLR-DATA.                                             ELCDTEFD
   243         16  DD-TLR                  OCCURS 32 TIMES              ELCDTEFD
   244                                     PIC  X(03).                  ELCDTEFD
   245     12  DD-STATE-DATA REDEFINES DD-TLR-DATA.                     ELCDTEFD
   246         16  DD-STATE-FLDS           OCCURS 16 TIMES              ELCDTEFD
   247                                     PIC  X(06).                  ELCDTEFD
   248     12  DD-CARR-DATA REDEFINES DD-TLR-DATA.                      ELCDTEFD
   249         16  DD-CARR-FLDS            OCCURS 13 TIMES              ELCDTEFD
   250                                     PIC  X(07).                  ELCDTEFD
   251         16  FILLER                  PIC  X(05).                  ELCDTEFD
   252     12  DD-MISC-DATA REDEFINES DD-TLR-DATA                       ELCDTEFD
   253                                     PIC  X(96).                  ELCDTEFD
   254******************************************************************ELCDTEFD
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   9
* CPSRTU1.cbl
   256 FD  PRINTER
*  257                                 COPY ELCPRTFD.
   258******************************************************************04/15/98
   259*                                                                *ELCPRTFD
   260*                                                                *ELCPRTFD
   261*                            ELCPRTFD.                           *   LV003
   262*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
   263*                            VMOD=2.006                          *ELCPRTFD
   264******************************************************************ELCPRTFD
   265     RECORDING MODE F                                             ELCPRTFD
   266     LABEL RECORDS OMITTED                                        ELCPRTFD
   267     BLOCK CONTAINS 0 RECORDS
   268     RECORD CONTAINS 133 CHARACTERS.                              ELCPRTFD
   269 01  PRT.                                                         ELCPRTFD
   270     12  P-CTL               PIC  X.                                 CL**2
   271     12  P-DATA              PIC  X(132).                         ELCPRTFD
   272******************************************************************ELCPRTFD
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  10
* CPSRTU1.cbl
   274 WORKING-STORAGE SECTION.
   275
   276 77  FILLER  PIC X(32) VALUE '********************************'.
   277 77  FILLER  PIC X(32) VALUE '   CPSRTU1 WORKING-STORAGE      '.
   278 77  FILLER  PIC X(32) VALUE '************ VM 2.001 **********'.
   279
   280 01  WORK-AREAS.
   281     12  WS-RETURN-CODE          PIC XXXX.
   282     12  WS-NUM-DATE             PIC 9(11).
   283     12  WS-WORK-DATE REDEFINES WS-NUM-DATE.
   284         16  FILLER              PIC XXX.
   285         16  WS-WORK-CCYY        PIC 9999.
   286         16  WS-WORK-MM          PIC 99.
   287         16  WS-WORK-DD          PIC 99.
   288     12  WS-CARD-SW              PIC X VALUE SPACES.
   289         88  NO-MORE-RATES            VALUE 'Y'.
   290     12  SUB1                   PIC S9(3) VALUE +0 COMP-3.
   291     12  WS-LINE-COUNT          PIC S9(3)  VALUE +99 COMP-3.
   292     12  WS-LINE-COUNT-MAX      PIC S9(3)  VALUE +60 COMP-3.
   293     12  WS-PAGE                PIC S9(3)  VALUE +1  COMP-3.
   294     12  WS-CURRENT-BIN-DT      PIC XX.
   295     12  WS-ABEND-MESSAGE       PIC X(80).
   296     12  WS-ABEND-FILE-STATUS   PIC XX  VALUE ZEROS.
   297     12  WS-ZERO                PIC S9  VALUE ZERO COMP-3.
   298     12  ERRATE-FILE-STATUS     PIC XX  VALUE ZEROS.
   299     12  RTE REDEFINES ERRATE-FILE-STATUS.
   300         16  RTE1               PIC X.
   301         16  RTE2               PIC X.
   302
   303     12  ERROR-SW               PIC X    VALUE SPACE.
   304         88  ERROR-OCCURRED              VALUE 'E'.
   305         88  NO-ERRORS                   VALUE ' '.
   306     12  WS-SAVE-PRINT-RECORD   PIC X(133) VALUE SPACES.
   307
   308 01  WS-HOLD-ERRATE  PIC X(1765) VALUE SPACES.
   309 01  DTE-INTERFACE-CODES.
   310     05  X                 PIC X           VALUE SPACE.
   311     05  PGM-SUB           PIC S9(4)  COMP VALUE +504.
   312     05  ABEND-CODE        PIC 9999        VALUE ZERO.
   313     05  ABEND-OPTION      PIC X           VALUE SPACE.
   314     05  OLC-REPORT-NAME   PIC X(6)        VALUE 'EL504'.
   315
   316     05 WS-IN              PIC 9(5) VALUE ZEROS.
   317     05 WS-OUT             PIC 9(5) VALUE ZEROS.
   318
   319 01  WS-PRINT-LINES.
   320
   321     12  HDR-1.
   322         16  FILLER          PIC X(45)       VALUE SPACES.
   323         16  H1-COMPANY-ID   PIC XXX         VALUE SPACES.
   324         16  FILLER          PIC X(72)       VALUE
   325            '    RATE FILE UPDATE REPORT   '.
   326         16  FILLER          PIC X(6)        VALUE 'CPSRTU'.
   327         16  H1-SUFFIX       PIC X           VALUE 'A'.
   328     12  HDR-2.
   329         16  FILLER          PIC X(47)       VALUE SPACES.
   330         16  H2-COMP         PIC X(30).
   331         16  FILLER          PIC X(43)       VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  11
* CPSRTU1.cbl
   332         16  H2-DATE         PIC X(8).
   333     12  HDR-3.
   334         16  FILLER          PIC X(54)       VALUE SPACES.
   335         16  H3-DATE         PIC X(18).
   336         16  FILLER          PIC X(48)       VALUE SPACES.
   337         16  FILLER          PIC X(5)        VALUE 'PAGE '.
   338         16  H3-PAGE         PIC ZZ,ZZ9.
   339     12  HDR-4.
   340         16  FILLER          PIC XX          VALUE SPACES.
   341         16  FILLER          PIC X(52)       VALUE
   342         'STATE   CLASS   DEV   BEN CODE   EFF DATE   COMMENTS'.
   343
   344     12  DTL-1.
   345         16  FILLER              PIC XXX   VALUE SPACES.
   346         16  DTL-STATE           PIC X(08) VALUE SPACES.
   347         16  DTL-CLASS           PIC X(07) VALUE SPACES.
   348         16  DTL-DEV             PIC X(09) VALUE SPACES.
   349         16  DTL-BEN-CD          PIC X(07) VALUE SPACES.
   350         16  DTL-EFF-DT          PIC X(13) VALUE SPACES.
   351         16  DTL-COMMENTS        PIC X(30) VALUE SPACES.
   352 01  COMP-3-WORK-AREA.
   353     05  K1                 PIC S9(7)  VALUE +1.
   354     05  K2                 PIC S9(7)  VALUE +2.
   355     05  WS-RATE-RECS       PIC S9(7)  VALUE +0.
   356     05  RECORD-COUNT       PIC S9(7)  VALUE +0.
   357     05  LINE-CNT           PIC S9(7)  VALUE +0.
   358     05  DELETE-COUNT       PIC S9(7)  VALUE +0.
   359     05  DATE-ERROR-COUNT   PIC S9(7)  VALUE +0.
   360
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  12
* CPSRTU1.cbl
*  362                             COPY ELCDTECX.
   363******************************************************************06/05/98
   364*                                                                *ELCDTECX
   365*                            ELCDTECX.                           *   LV005
   366*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
   367*                            VMOD=2.015                          *ELCDTECX
   368*                                                                *ELCDTECX
   369*      WORKING STORAGE COPY CODE FOR APPLICATIONS CALLING        *ELCDTECX
   370*      THE DATE CARD DISK FILE. ( READ ROUTINE = ELCDTERX,       *ELCDTECX
   371*      AND DISK FILE FD = ELCDTEFX)                              *ELCDTECX
   372*                                                                *ELCDTECX
   373******************************************************************ELCDTECX
   374******************************************************************
   375*                   C H A N G E   L O G
   376*
   377* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   378*-----------------------------------------------------------------
   379*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   380* EFFECTIVE    NUMBER
   381*-----------------------------------------------------------------
   382* 092602    2002091900008  PEMA  INCREASE NUMBER OF MAXIMUM
   383*                                  BENEFIT CODES FROM 300 TO 900
   384* 090803    2003080800002  PEMA  ADD CATEGORY FOR SUPER GAP
   385* 051304    2003080800002  SMVA  ADD REFUND METHOD
   386* 071714    2013100100002  PEMA  FIX CRIT PERIOD EDITS
   387******************************************************************
   388 01  DATE-CARD.                                                   ELCDTECX
   389     12  DATX-COD                    PIC  X(4).                   ELCDTECX
   390     12  RUN-DATE                    PIC  9(11)  COMP-3.          ELCDTECX
   391     12  ALPH-DATE                   PIC  X(18).                  ELCDTECX
   392     12  EP-DT                       PIC  9(11)  COMP-3.          ELCDTECX
   393     12  PEND-ACT-FILE               PIC  XX.                     ELCDTECX
   394     12  EP-SW                       PIC  X.                      ELCDTECX
   395         88  NO-EP-EXTRACTS          VALUE SPACE.                 ELCDTECX
   396     12  TAPE-BATCHES                PIC  X.                      ELCDTECX
   397         88  TP-PREL-BAL             VALUE '1'.                   ELCDTECX
   398     12  BIN-RUN-DATE                PIC  XX.                     ELCDTECX
   399     12  RUN-CENTURY.                                             ELCDTECX
   400         16 RUN-CENTURY-N            PIC  99.                        CL**4
   401     12  FILLER                      PIC  X.                         CL**4
   402     12  CLAS-MORT-OVRD              PIC  X(4).                   ELCDTECX
   403     12  FILLER                      PIC  XXX.                    ELCDTECX
   404     12  COMPANY-NAME                PIC  X(30).                  ELCDTECX
   405                                                                  ELCDTECX
   406 01  FILLER                          PIC  X(7)                       CL**6
   407                                          VALUE 'OPTIONS'.        ELCDTECX
   408 01  DATE-CARD-OPTIONS.                                           ELCDTECX
   409     12  DATE-OPTIONS-ID             PIC  X(4).                   ELCDTECX
   410     12  DTE-MIN-PREM                PIC  99V99.                  ELCDTECX
   411     12  DTE-LANGUAGE-IND            PIC  X.                      ELCDTECX
   412         88  DTE-LANGUAGE-IS-FR           VALUE 'F'.              ELCDTECX
   413         88  DTE-LANGUAGE-IS-ENG          VALUE 'E'.              ELCDTECX
   414     12  DTE-MIN-AGE                 PIC  99.                     ELCDTECX
   415     12  DTE-DEFAULT-AGE             PIC  99.                     ELCDTECX
   416     12  FILLER                      PIC  X.                      ELCDTECX
   417     12  DTE-MAX-TERM                PIC  999.                    ELCDTECX
   418     12  DTE-COMP-VG                 PIC  X.                      ELCDTECX
   419     12  DTE-REM-TRM                 PIC  X.                      ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  13
* CPSRTU1.cbl (/apps/prod/cid1p/copy/ELCDTECX)
   420     12  DTE-PRM-CK                  PIC S99V99.                  ELCDTECX
   421     12  DTE-PRORATA                 PIC  X.                      ELCDTECX
   422     12  DTE-CLM-REJ                 PIC  X.                      ELCDTECX
   423     12  DTE-REF-REJ                 PIC  X.                      ELCDTECX
   424     12  DTE-COM-TBL-USED            PIC  X.                      ELCDTECX
   425     12  FILLER                      PIC  X.                      ELCDTECX
   426     12  DTE-QTR-CO                  PIC  X.                      ELCDTECX
   427     12  DTE-REF-CK                  PIC S99V99.                  ELCDTECX
   428     12  DTE-CLM-CK                  PIC S99V99.                  ELCDTECX
   429     12  DTE-CONV-DT                 PIC 9(11) COMP-3.               CL**2
   430     12  DTE-DEFAULT-SEX             PIC  X.                      ELCDTECX
   431     12  DTE-EPL-FORMAT              PIC  X.                      ELCDTECX
   432     12  FILLER                      PIC  X.                      ELCDTECX
   433     12  DTE-JT-AGE                  PIC  X.                      ELCDTECX
   434     12  DTE-KEY-BIRTH               PIC  X.                      ELCDTECX
   435     12  DTE-REINSURANCE             PIC  X.                      ELCDTECX
   436     12  DTE-CLAIM-SORT              PIC  X.                      ELCDTECX
   437     12  DTE-WRT-OFF                 PIC  S99V99.                 ELCDTECX
   438     12  DTE-R78                     PIC  X.                      ELCDTECX
   439     12  DTE-DLY-BILL                PIC  X.                      ELCDTECX
   440     12  DTE-ALT-MORT-CODE           PIC  X(4).                   ELCDTECX
   441     12  DTE-CLAIM-PAID-THRU-TO      PIC  X.                      ELCDTECX
   442     12  DTE-COMPENSATION-ACCESS     PIC  X.                      ELCDTECX
   443     12  DTE-MORTG-ACCESS-CNTL       PIC  X.                      ELCDTECX
   444     12  DTE-MP-ALT-MORT-CODE        PIC  X(4).                   ELCDTECX
   445     12  DTE-MORTALITY-AGE-CALC-METHOD                            ELCDTECX
   446                                     PIC  X.                      ELCDTECX
   447         88  DTE-USE-TABLE-ASSIGNED-METHOD VALUE '1'              ELCDTECX
   448                                                 ' '.             ELCDTECX
   449         88  DTE-USE-ALL-AGE-LAST          VALUE '2'.             ELCDTECX
   450         88  DTE-USE-ALL-AGE-NEAR          VALUE '3'.             ELCDTECX
   451     12  DTE-RESERVE-OPTION-SWITCH   PIC  X.                      ELCDTECX
   452         88  DTE-OPT-RESERVE-METHOD-AUTH       VALUE 'Y'.         ELCDTECX
   453         88  DTE-OPT-RESERVE-METHOD-UNAUTH     VALUE 'N' ' '.     ELCDTECX
   454     12  DTE-REM-TRM-CALC-OPTION     PIC  X.                      ELCDTECX
   455     12  DTE-EXPERIENCE-RETENTION-AGE                             ELCDTECX
   456                                     PIC  9.                         CL**4
   457     12  DTE-SYSTEM.                                              ELCDTECX
   458         16  DTE-SYS-A-CREDIT        PIC  X.                      ELCDTECX
   459         16  DTE-SYS-B-PEND-CLAIM    PIC  X.                      ELCDTECX
   460         16  DTE-SYS-C-CONFIRMATIONS PIC  X.                      ELCDTECX
   461         16  DTE-SYS-D-DEMAND-BILL   PIC  X.                      ELCDTECX
   462         16  DTE-SYS-E-CLASIC-CLAIMS PIC  X.                      ELCDTECX
   463         16  DTE-SYS-F-CLASIC-CREDIT PIC  X.                      ELCDTECX
   464         16  DTE-SYS-G-AR-USED       PIC  X.                      ELCDTECX
   465         16  DTE-SYS-H               PIC  X.                      ELCDTECX
   466         16  DTE-SYS-I               PIC  X.                      ELCDTECX
   467         16  DTE-SYS-J               PIC  X.                      ELCDTECX
   468         16  DTE-SYS-K               PIC  X.                      ELCDTECX
   469         16  DTE-SYS-L               PIC  X.                      ELCDTECX
   470         16  DTE-SYS-M               PIC  X.                      ELCDTECX
   471         16  DTE-SYS-N               PIC  X.                      ELCDTECX
   472         16  DTE-SYS-O               PIC  X.                      ELCDTECX
   473         16  DTE-SYS-P               PIC  X.                      ELCDTECX
   474         16  DTE-SYS-Q               PIC  X.                      ELCDTECX
   475         16  DTE-SYS-R               PIC  X.                      ELCDTECX
   476         16  DTE-SYS-S               PIC  X.                      ELCDTECX
   477         16  DTE-SYS-T               PIC  X.                      ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  14
* CPSRTU1.cbl (/apps/prod/cid1p/copy/ELCDTECX)
   478         16  DTE-SYS-U               PIC  X.                      ELCDTECX
   479         16  DTE-SYS-V               PIC  X.                      ELCDTECX
   480         16  DTE-SYS-W               PIC  X.                      ELCDTECX
   481         16  DTE-SYS-X               PIC  X.                      ELCDTECX
   482         16  DTE-SYS-Y               PIC  X.                      ELCDTECX
   483         16  DTE-SYS-Z               PIC  X.                      ELCDTECX
   484     12  FILLER                      REDEFINES DTE-SYSTEM.        ELCDTECX
   485         16  DTE-SYS-CODE            OCCURS 26 TIMES              ELCDTECX
   486                                     PIC  X.                      ELCDTECX
   487     12  DTE-CLIENT                  PIC  XXX.                    ELCDTECX
   488                                                                  ELCDTECX
   489 01  CLASIC-SYSTEM-CODES.                                         ELCDTECX
   490     12  DTE-COLC-ID                 PIC  X(4).                   ELCDTECX
   491     12  DTE-CLASIC-COMPANY-CD       PIC  X.                      ELCDTECX
   492     12  DTE-CLASIC-COMPANY-NUMBER   PIC  999.                    ELCDTECX
   493*    12  DTE-CLASIC-CLAIM-ACCESS     PIC  X.                      ELCDTECX
   494     12  FILLER                      PIC  X.                      ELCDTECX
   495     12  CLASIC-REIN-MAINT           PIC  XX.                     ELCDTECX
   496     12  CLASIC-COMP-MAINT           PIC  XX.                     ELCDTECX
   497     12  CLASIC-ACCT-MAINT           PIC  XX.                     ELCDTECX
   498     12  CLASIC-CTBL-MAINT           PIC  XX.                     ELCDTECX
   499     12  CLASIC-RATE-MAINT           PIC  XX.                     ELCDTECX
   500     12  CLASIC-CREDIT-EOM-DT        PIC  XX.                     ELCDTECX
   501     12  CLASIC-CLAIMS-EOM-DT        PIC  XX.                     ELCDTECX
   502                                                                  ELCDTECX
   503     12  LIFE-OVERRIDE-L1            PIC  X.                      ELCDTECX
   504     12  LIFE-OVERRIDE-L2            PIC  XX.                     ELCDTECX
   505     12  LIFE-OVERRIDE-L6            PIC  X(6).                   ELCDTECX
   506     12  LIFE-OVERRIDE-L12           PIC  X(12).                  ELCDTECX
   507                                                                  ELCDTECX
   508     12  AH-OVERRIDE-L1              PIC  X.                      ELCDTECX
   509     12  AH-OVERRIDE-L2              PIC  XX.                     ELCDTECX
   510     12  AH-OVERRIDE-L6              PIC  X(6).                   ELCDTECX
   511     12  AH-OVERRIDE-L12             PIC  X(12).                  ELCDTECX
   512                                                                  ELCDTECX
   513     12  CLAS-REPORT-CD1-CAPTION     PIC  X(10).                  ELCDTECX
   514     12  CLAS-REPORT-CD2-CAPTION     PIC  X(10).                  ELCDTECX
   515                                                                  ELCDTECX
   516     12  CLASIC-MORTG-EOM-DT         PIC  XX.                     ELCDTECX
   517     12  CLASIC-AR-EOM-DT            PIC  XX.                     ELCDTECX
   518                                                                  ELCDTECX
   519     12  FILLER                      PIC  X(11)      VALUE SPACE. ELCDTECX
   520                                                                  ELCDTECX
   521 01  DATE-CARD-FACTORS.                                           ELCDTECX
   522     12  DATE-FACTOR-ID              PIC  X(4).                   ELCDTECX
   523     12  FAC-1                       PIC S999V9(5).               ELCDTECX
   524     12  FAC-2                       PIC S999V9(5).               ELCDTECX
   525     12  FAC-3                       PIC S999V9(5).               ELCDTECX
   526     12  FAC-4                       PIC S999V9(5).               ELCDTECX
   527     12  FAC-5                       PIC S999V9(5).               ELCDTECX
   528     12  FAC-6                       PIC S999V9(5).               ELCDTECX
   529                                                                  ELCDTECX
   530 01  FILLER                          PIC  X(12)                   ELCDTECX
   531                                          VALUE 'COMPANY NAME'.   ELCDTECX
   532 01  COMPANY-NAME-TABLE.                                          ELCDTECX
   533     12  C-N-TBL                     OCCURS 6 TIMES.              ELCDTECX
   534         16  CNT-ID                  PIC  X.                      ELCDTECX
   535         16  CNT-NAME                PIC  X(30).                  ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  15
* CPSRTU1.cbl (/apps/prod/cid1p/copy/ELCDTECX)
   536                                                                  ELCDTECX
   537 01  FILLER                          PIC  X(11)                   ELCDTECX
   538                                          VALUE 'STATE NAMES'.    ELCDTECX
   539 01  STATE-NAMES.                                                 ELCDTECX
   540     12  STATE-NAME-FLD              OCCURS 75 TIMES.             ELCDTECX
   541         16  STATE-SUB               PIC  XX.                     ELCDTECX
   542         16  STATE-PIC1.                                          ELCDTECX
   543             20  STATE-ABBR          PIC  XX.                     ELCDTECX
   544             20  FILLER              PIC  XXX.                    ELCDTECX
   545             20  STATE-PIC           PIC  X(20).                  ELCDTECX
   546             20  STATE-CALL-EARN     PIC  X.                      ELCDTECX
   547             20  STATE-CALL-BREAK    PIC  X.                      ELCDTECX
   548             20  STATE-PRIM-FAC-DEV  PIC  XXX.                    ELCDTECX
   549                                                                  ELCDTECX
   550 01  FILLER                          PIC  X(13)                   ELCDTECX
   551                                          VALUE 'CARRIER NAMES'.  ELCDTECX
   552 01  CARRIER-NAMES.                                               ELCDTECX
   553     12  CARRIER-NAME-FLD            OCCURS 25 TIMES.             ELCDTECX
   554         16  CARRIER-SUB             PIC  X.                      ELCDTECX
   555         16  CARRIER-DOM-ST          PIC  XX.                     ELCDTECX
   556         16  CARRIER-PIC             PIC  X(30).                  ELCDTECX
   557         16  CARRIER-UEP-PCT         PIC  S9V9(4) COMP-3.            CL**6
   558         16  CARRIER-R78-PCT         PIC  S9V9(4) COMP-3.            CL**6
   559         16  CARRIER-PRO-PCT         PIC  S9V9(4) COMP-3.            CL**6
   560*        16  FILLER                  PIC  X.                      ELCDTECX
   561         16  CARRIER-SEC-PAY         PIC  X.
   562             88  SEC-PAY-CARRIER          VALUE 'Y'.
   563                                                                  ELCDTECX
   564 01  FILLER                          PIC  X(9)                       CL**6
   565                                          VALUE 'INS TYPES'.      ELCDTECX
   566 01  CLAS-INS-TYPES.                                              ELCDTECX
   567*    12 CLAS-ALL-TYPES               OCCURS 300 TIMES.            ELCDTECX
   568     12 CLAS-ALL-TYPES               OCCURS 900 TIMES.            ELCDTECX
   569         16  CLAS-I-BEN              PIC  XX.                     ELCDTECX
   570         16  CLAS-I-AB3.                                          ELCDTECX
   571             20  FILLER              PIC  X.                      ELCDTECX
   572             20  CLAS-I-AB2.                                      ELCDTECX
   573                 24  FILLER          PIC  X.                      ELCDTECX
   574                 24  CLAS-I-AB1      PIC  X.                      ELCDTECX
   575         16  CLAS-I-AB3-AH REDEFINES CLAS-I-AB3.                  ELCDTECX
   576             20  CLAS-EXCLUSION      PIC  XX.                        CL**4
   577             20  FILLER              PIC  X.                         CL**4
   578         16  CLAS-I-AB10.                                         ELCDTECX
   579             20  FILLER              PIC  X(9).                   ELCDTECX
   580             20  CLAS-I-REIN-YN      PIC  X.                      ELCDTECX
   581         16  CLAS-I-COMMENT          PIC  X(10).                  ELCDTECX
   582         16  CLAS-I-JOINT            PIC  X.                      ELCDTECX
   583         16  CLAS-I-RL-AH            PIC  X.                      ELCDTECX
   584         16  CLAS-I-CALC-TYPE.                                    ELCDTECX
   585             20  CLAS-I-BAL          PIC  X.                      ELCDTECX
   586         16  CLAS-I-EP               PIC  X.                      ELCDTECX
   587         16  CLAS-CO-BEN-I-G-CD      PIC  X.                      ELCDTECX
   588         16  CLAS-CO-REM-TERM-CALC   PIC  X.                      ELCDTECX
   589         16  CLAS-I-BEN-CATEGORY     PIC  X.
   590         16  CLAS-I-REFUND-METHOD    PIC  X.
   591         16  CLAS-I-MAX-BENEFITS     PIC 99.
   592         16  FILLER                  PIC  XXX.
   593                                                                  ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  16
* CPSRTU1.cbl (/apps/prod/cid1p/copy/ELCDTECX)
   594 01  FILLER                          PIC  X(16)                   ELCDTECX
   595                                     VALUE 'MORTALITY TABLES'.    ELCDTECX
   596 01  CLAS-MORTALITY-CODES.                                        ELCDTECX
   597     12  CLAS-MORT-FLD               OCCURS 99 TIMES              ELCDTECX
   598                                     INDEXED BY CLAS-MORT-NDX.    ELCDTECX
   599         16  CLAS-MORT-CODE          PIC  X(4).                      CL**6
   600         16  CLAS-MORT-J-CODE        PIC  X.                         CL**5
   601         16  CLAS-MORT-J-FACT        PIC S9V9(4).                    CL**6
   602         16  CLAS-MORT-DESC.                                      ELCDTECX
   603             20  CLAS-RESERVE-ADJ    PIC  999.                       CL**6
   604             20  FILLER              PIC  XX.                        CL**5
   605             20  CLAS-YEAR           PIC  X(4).                      CL**6
   606             20  FILLER              PIC  X.                         CL**5
   607             20  CLAS-TABLE-TYPE     PIC  XXX.                       CL**6
   608             20  FILLER              PIC  X.                         CL**5
   609             20  CLAS-AGE-METHOD     PIC  XX.                        CL**5
   610             20  FILLER              PIC  X.                         CL**5
   611             20  CLAS-INTEREST       PIC  99.99.                     CL**5
   612             20  FILLER              PIC  X(5).                      CL**6
   613                                                                  ELCDTECX
   614 01  FILLER                          PIC  X(15)                   ELCDTECX
   615                                     VALUE 'BUSINESS TABLES'.     ELCDTECX
   616 01  CLAS-BUSINESS-CLASSES.                                       ELCDTECX
   617     12  CLAS-BUSC-FLD               OCCURS 50 TIMES.             ELCDTECX
   618         16  CLAS-BUSC-CODE          PIC  99.                     ELCDTECX
   619         16  CLAS-BUSC-GROUP         PIC  X.                      ELCDTECX
   620         16  CLAS-BUSC-DESC          PIC  X(19).                  ELCDTECX
   621         16  CLAS-BUSC-EXCL          PIC  X.                         CL**5
   622         16  FILLER                  PIC  X(4).                      CL**6
   623                                                                  ELCDTECX
   624 01  FILLER                          PIC  X(7)                       CL**6
   625                                     VALUE 'INDEXES'.             ELCDTECX
   626 01  CLAS-INDEX-TBL.                                              ELCDTECX
   627     12  CLAX-ID                     PIC  X(4).                   ELCDTECX
   628     12  CLAS-STARTC                 PIC S9(4) COMP.              ELCDTECX
   629     12  CLAS-MAXC                   PIC S9(4) COMP.              ELCDTECX
   630     12  CLAS-STARTL                 PIC S9(4) COMP.              ELCDTECX
   631     12  CLAS-MAXL                   PIC S9(4) COMP.              ELCDTECX
   632     12  CLAS-STARTA                 PIC S9(4) COMP.              ELCDTECX
   633     12  CLAS-MAXA                   PIC S9(4) COMP.              ELCDTECX
   634     12  CLAS-STARTM                 PIC S9(4) COMP.              ELCDTECX
   635     12  CLAS-MAXM                   PIC S9(4) COMP.              ELCDTECX
   636     12  CLAS-STARTB                 PIC S9(4) COMP.              ELCDTECX
   637     12  CLAS-MAXB                   PIC S9(4) COMP.              ELCDTECX
   638     12  CLAS-STARTS                 PIC S9(4) COMP.              ELCDTECX
   639     12  CLAS-MAXS                   PIC S9(4) COMP.              ELCDTECX
   640     12  CLAS-STARTE                 PIC S9(4) COMP.              ELCDTECX
   641     12  CLAS-MAXE                   PIC S9(4) COMP.              ELCDTECX
   642     12  CLAS-STARTCN                PIC S9(4) COMP.              ELCDTECX
   643     12  CLAS-MAXCN                  PIC S9(4) COMP.              ELCDTECX
   644                                                                  ELCDTECX
   645 01  CLAS-TYPE-MISC.                                              ELCDTECX
   646     12  CLAS-INDEXC                 PIC S9(4) COMP.              ELCDTECX
   647     12  CLAS-INDEXL                 PIC S9(4) COMP.              ELCDTECX
   648     12  CLAS-INDEXA                 PIC S9(4) COMP.              ELCDTECX
   649     12  CLAS-INDEXM                 PIC S9(4) COMP.              ELCDTECX
   650     12  CLAS-INDEXB                 PIC S9(4) COMP.              ELCDTECX
   651     12  CLAS-INDEXS                 PIC S9(4) COMP.              ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  17
* CPSRTU1.cbl (/apps/prod/cid1p/copy/ELCDTECX)
   652     12  CLAS-INDEXE                 PIC S9(4) COMP.              ELCDTECX
   653     12  CLAS-INDEX                  PIC S9(4) COMP.              ELCDTECX
   654     12  CLAS-INDEXEN                PIC S9(4) COMP.              ELCDTECX
   655     12  CLAS-INDEXCN                PIC S9(4) COMP.              ELCDTECX
   656     12  CLAS-INDEXON                PIC S9(4) COMP.              ELCDTECX
   657                                                                  ELCDTECX
   658 01  FILLER                          PIC  X(13)                   ELCDTECX
   659                                     VALUE 'MISCELLANEOUS'.       ELCDTECX
   660 01  CLAS-MISC.                                                   ELCDTECX
   661     12  DTE-FICH                    PIC  X.                      ELCDTECX
   662         88  FICH-NO                 VALUE SPACE.                 ELCDTECX
   663         88  FICH-ONLY               VALUE '1'.                   ELCDTECX
   664         88  FICH-BOTH               VALUE '2'.                   ELCDTECX
   665     12  FICH-OPEN                   PIC  X.                      ELCDTECX
   666     12  REPT-OPEN                   PIC  X.                      ELCDTECX
   667     12  DTE-PGM-OPT                 PIC  9.                         CL**5
   668     12  DTE-PRT-OPT                 PIC  X.                      ELCDTECX
   669     12  DTE-FMT-OPT                 PIC  9.                      ELCDTECX
   670     12  DTE-PRC-OPT                 PIC  9.                      ELCDTECX
   671     12  DTE-TOT-OPT                 PIC  9.                      ELCDTECX
   672     12  CLAS-LOOK                   PIC  XX.                     ELCDTECX
   673     12  DTE-TOT-LINES               PIC S9(8)      COMP.         ELCDTECX
   674     12  STATE-L                     PIC  XX.                     ELCDTECX
   675     12  CLAS-CN                     PIC  99.                     ELCDTECX
   676     12  CLAS-CO                     PIC  99.                     ELCDTECX
   677     12  DTE-VSAM-FLAGS                              VALUE ZERO.  ELCDTECX
   678         16  DTE-F-1                 PIC  X.                      ELCDTECX
   679         16  DTE-F-2                 PIC  X.                      ELCDTECX
   680     12  DTE-ABEND-WORK.                                          ELCDTECX
   681         16  DTE-ABEND-CD-1          PIC  XX         VALUE SPACES.ELCDTECX
   682         16  DTE-ABEND-CD-2          PIC  XX         VALUE SPACES.ELCDTECX
   683                                                                  ELCDTECX
   684 01  FILLER                          PIC  X(12)                   ELCDTECX
   685                                     VALUE 'WORKING DATE'.        ELCDTECX
   686 01  WS-DATE-AND-TIME.                                            ELCDTECX
   687     12  WS-ACCEPT-DATE.                                          ELCDTECX
   688         16  WS-AD-YY                PIC  99.                     ELCDTECX
   689         16  WS-AD-MM                PIC  99.                     ELCDTECX
   690         16  WS-AD-DD                PIC  99.                     ELCDTECX
   691     12  WS-CURRENT-DATE.                                         ELCDTECX
   692         16  WS-CD-MM                PIC  99.                     ELCDTECX
   693         16  FILLER                  PIC  X          VALUE '/'.   ELCDTECX
   694         16  WS-CD-DD                PIC  99.                     ELCDTECX
   695         16  FILLER                  PIC  X          VALUE '/'.   ELCDTECX
   696         16  WS-CD-YY                PIC  99.                     ELCDTECX
   697     12  WS-TIME-OF-DAY.                                          ELCDTECX
   698         16  WS-TIME                 PIC  9(6).                   ELCDTECX
   699         16  WS-HUN-SEC              PIC  99.                     ELCDTECX
   700                                                                  ELCDTECX
   701 01  FILLER                          PIC  X(12)                   ELCDTECX
   702                                     VALUE 'CARRIER CLMS'.        ELCDTECX
   703 01  CARRIER-OPT-CLAIM-DATA.                                      ELCDTECX
   704     12  CARRIER-FLDS                OCCURS 25 TIMES.             ELCDTECX
   705         16  CARRIER-IBNR-SWITCH     PIC  X.                         CL**5
   706         16  CARRIER-IBNR-PERCENT    PIC S9V9(4) COMP-3.             CL**6
   707         16  CARRIER-CIDA-DISCOUNT   PIC S9V9(4) COMP-3.             CL**6
   708                                                                  ELCDTECX
   709 01  FILLER                          PIC  X(10)                   ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  18
* CPSRTU1.cbl (/apps/prod/cid1p/copy/ELCDTECX)
   710                                     VALUE 'STATE TLRS'.          ELCDTECX
   711 01  STATE-TARGET-LOSS-RATIOS.                                    ELCDTECX
   712     12  STATE-TLR-FLD               OCCURS 75 TIMES.             ELCDTECX
   713         16  STATE-TARGET-LOSS-RATIO PIC S9V9(4) COMP-3.             CL**6
   714         16  STATE-CALC-INTEREST     PIC S9V9(4) COMP-3.             CL**6
   715                                                                  ELCDTECX
   716 01  FILLER                          PIC  X(13)                   ELCDTECX
   717                                     VALUE 'BUSINESS TLRS'.       ELCDTECX
   718 01  BUSINESS-TRGT-LOSS-RATIO-MODS.                               ELCDTECX
   719     12  BUS-TLRM-FLD                OCCURS 99 TIMES.             ELCDTECX
   720         16  BUS-TRGT-LOSS-RATIO-MOD PIC S9V9(4) COMP-3.             CL**6
   721                                                                  ELCDTECX
   722 01  FILLER                          PIC  X(13)                   ELCDTECX
   723                                     VALUE 'MISC CLM DATA'.       ELCDTECX
   724 01  MISC-OPT-CLM-RSV-DATA.                                       ELCDTECX
   725     12  COMPANY-CALC-INTEREST       PIC S9V9(4) COMP-3.             CL**6
   726     12  COMPANY-CIDA-DISCOUNT       PIC S9V9(4) COMP-3.             CL**6
   727     12  COMPANY-CRDB-TABLE-SELECTION                             ELCDTECX
   728                                     PIC  X.                         CL**5
   729     12  COMPANY-IBNR-AH-FACTOR      PIC S9V9(4) COMP-3.             CL**6
   730     12  COMPANY-IBNR-LAG-MONTH      PIC S999    COMP-3.             CL**6
   731     12  COMPANY-IBNR-LIFE-FACTOR    PIC S9V9(4) COMP-3.             CL**6
   732     12  COMPANY-OPTION-START-DATE   PIC  XX.                        CL**5
   733     12  INDEXBS                     PIC S9(4)   COMP.               CL**6
   734     12  INDEXCA                     PIC S9(4)   COMP.               CL**6
   735     12  INDEXST                     PIC S9(4)   COMP.               CL**6
   736     12  FILLER                      PIC  X(75).                  ELCDTECX
   737******************************************************************ELCDTECX
   738*01  MISC-CARR-PCT-DATA.                                          00001521
   739*    12  DD-CARR1-UEP-PCT            PIC S9V9(4) COMP-3.          00001522
   740*    12  DD-CARR1-R78-PCT            PIC S9V9(4) COMP-3.          00001522
   741*    12  DD-CARR1-PRO-PCT            PIC S9V9(4) COMP-3.          00001522
   742*    12  DD-CARR2-UEP-PCT            PIC S9V9(4) COMP-3.          00001522
   743*    12  DD-CARR2-R78-PCT            PIC S9V9(4) COMP-3.          00001522
   744*    12  DD-CARR2-PRO-PCT            PIC S9V9(4) COMP-3.          00001522
   745******************************************************************ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  19
* CPSRTU1.cbl
*  747                             COPY ELCDTEVR.
   748***************************************************************** 04/15/98
   749*                                                                *ELCDTEVR
   750*                                                                *ELCDTEVR
   751*                            ELCDTEVR.                           *   LV003
   752*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
   753*                            VMOD=2.001                          *   CL**2
   754*                                                                *ELCDTEVR
   755*   WORKING STORAGE FOR DATE VARIABLES CREATED                   *ELCDTEVR
   756*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCDTEVR
   757*                                                                *ELCDTEVR
   758******************************************************************ELCDTEVR
   759 01  WS-DATE-CARD-DATE.                                           ELCDTEVR
   760     05  WS-RUN-DATE.                                             ELCDTEVR
   761         10  FILLER                  PIC  9(03).                  ELCDTEVR
   762         10  RUN-CCYY                PIC  9(04).                  ELCDTEVR
   763         10  RUN-CCYR  REDEFINES  RUN-CCYY.                       ELCDTEVR
   764             15  RUN-CC              PIC  99.                     ELCDTEVR
   765             15  RUN-YR              PIC  99.                     ELCDTEVR
   766         10  RUN-MO                  PIC  99.                     ELCDTEVR
   767         10  RUN-DA                  PIC  99.                     ELCDTEVR
   768     05  WS-RUN-DATE-N REDEFINES                                     CL**2
   769            WS-RUN-DATE              PIC 9(11).                      CL**2
   770     05  WS-EP-DT.                                                ELCDTEVR
   771         10  FILLER                  PIC  9(03).                  ELCDTEVR
   772         10  EP-CCYY                 PIC  9(04).                  ELCDTEVR
   773         10  EP-CCYR  REDEFINES  EP-CCYY.                         ELCDTEVR
   774             15  EP-CC               PIC  99.                     ELCDTEVR
   775             15  EP-YR               PIC  99.                     ELCDTEVR
   776         10  EP-MO                   PIC  99.                     ELCDTEVR
   777         10  EP-DA                   PIC  99.                     ELCDTEVR
   778     05  WS-EP-DT-N REDEFINES                                        CL**2
   779            WS-EP-DT                 PIC 9(11).                      CL**2
   780     05  WS-DTE-CONV-DT.                                             CL**4
   781         10  FILLER                  PIC  9(03).                     CL**4
   782         10  DTE-CONV-CCYY           PIC  9(04).                     CL**4
   783         10  DTE-CONV-CCYR  REDEFINES  DTE-CONV-CCYY.                CL**4
   784             15  DTE-CONV-CC         PIC  99.                        CL**4
   785             15  DTE-CONV-YR         PIC  99.                        CL**4
   786         10  DTE-CONV-MO             PIC  99.                        CL**4
   787         10  DTE-CONV-DA             PIC  99.                        CL**4
   788     05  WS-DTE-CONV-DT-N REDEFINES                                  CL**4
   789            WS-DTE-CONV-DT           PIC  9(11).                     CL**4
   790 01  WS-BALANCE-FORWARD-DATE.                                     ELCDTEVR
   791     05  WS-BF-LAST-ACTIVITY-DATE.                                ELCDTEVR
   792         10  FILLER                            PIC 999.           ELCDTEVR
   793         10  BF-ACT-CCYY                       PIC 9(04).         ELCDTEVR
   794         10  BF-ACT-CCYR  REDEFINES  BF-ACT-CCYY.                 ELCDTEVR
   795             15  BF-ACT-CC                     PIC 99.            ELCDTEVR
   796             15  BF-ACT-YEAR                   PIC 99.            ELCDTEVR
   797         10  BF-ACT-MONTH                      PIC 99.            ELCDTEVR
   798         10  BF-ACT-DAY                        PIC 99.            ELCDTEVR
   799     05  WS-BF-LAST-ACTIVITY-DATE-N REDEFINES                        CL**2
   800            WS-BF-LAST-ACTIVITY-DATE           PIC 9(11).            CL**2
   801     05  WS-BF-CURRENT-LAST-STMT-DT.                              ELCDTEVR
   802         10  FILLER                            PIC 999.           ELCDTEVR
   803         10  BF-CURRENT-LAST-STMT-CEN          PIC 99.            ELCDTEVR
   804         10  BF-CURRENT-LAST-STMT-YEAR         PIC 99.            ELCDTEVR
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  20
* CPSRTU1.cbl (/apps/prod/cid1p/copy/ELCDTEVR)
   805         10  BF-CURRENT-LAST-STMT-MONTH        PIC 99.            ELCDTEVR
   806         10  BF-CURRENT-LAST-STMT-DAY          PIC 99.            ELCDTEVR
   807     05  WS-BF-CURRENT-LAST-STMT-DT-N REDEFINES                      CL**2
   808            WS-BF-CURRENT-LAST-STMT-DT        PIC 9(11).             CL**2
   809 01  WS-ADD-CONF-TRANSACTIONS-DTE.                                ELCDTEVR
   810     05  WS-AC-CERT-EFF-DATE.                                     ELCDTEVR
   811         10  FILLER                            PIC 999.           ELCDTEVR
   812         10  AC-CERT-CCYY                      PIC 9(04).         ELCDTEVR
   813         10  AC-CERT-CCYR  REDEFINES  AC-CERT-CCYY.               ELCDTEVR
   814             15  AC-CERT-CC                    PIC 99.            ELCDTEVR
   815             15  AC-CERT-YR                    PIC 99.            ELCDTEVR
   816         10  AC-CERT-MO                        PIC 99.            ELCDTEVR
   817         10  AC-CERT-DA                        PIC 99.            ELCDTEVR
   818     05  WS-AC-CERT-EFF-DATE-N REDEFINES                             CL**2
   819            WS-AC-CERT-EFF-DATE                PIC 9(11).            CL**2
   820     05  WS-AC-LIFE-CANCEL-DATE.                                  ELCDTEVR
   821         10  FILLER                            PIC 999.           ELCDTEVR
   822         10  AC-LIFE-CANCEL-CCYY               PIC 9(04).         ELCDTEVR
   823         10  AC-LIFE-CANCEL-CCYR REDEFINES AC-LIFE-CANCEL-CCYY.   ELCDTEVR
   824             15  AC-LIFE-CANCEL-CC             PIC 99.            ELCDTEVR
   825             15  AC-LIFE-CANCEL-YR             PIC 99.            ELCDTEVR
   826         10  AC-LIFE-CANCEL-MO                 PIC 99.            ELCDTEVR
   827         10  AC-LIFE-CANCEL-DA                 PIC 99.            ELCDTEVR
   828     05  WS-AC-LIFE-CANCEL-DATE-N REDEFINES                          CL**2
   829            WS-AC-LIFE-CANCEL-DATE             PIC 9(11).            CL**2
   830     05  WS-AC-AH-CANCEL-DATE.                                    ELCDTEVR
   831         10  FILLER                            PIC 999.           ELCDTEVR
   832         10  AC-AH-CANCEL-CCYY                 PIC 9(04).         ELCDTEVR
   833         10  AC-AH-CANCEL-CCYR  REDEFINES  AC-AH-CANCEL-CCYY.     ELCDTEVR
   834             15  AC-AH-CANCEL-CC               PIC 99.            ELCDTEVR
   835             15  AC-AH-CANCEL-YR               PIC 99.            ELCDTEVR
   836         10  AC-AH-CANCEL-MO                   PIC 99.            ELCDTEVR
   837         10  AC-AH-CANCEL-DA                   PIC 99.            ELCDTEVR
   838     05  WS-AC-AH-CANCEL-DATE-N REDEFINES                            CL**2
   839            WS-AC-AH-CANCEL-DATE               PIC 9(11).            CL**2
   840 01  WS-RATE-RECORD.                                              ELCDTEVR
   841         05  WS-RT-EXPIRY-DATE.                                   ELCDTEVR
   842             10  FILLER                        PIC 999.           ELCDTEVR
   843             10  RT-EXP-CCYY                   PIC 9(04).         ELCDTEVR
   844             10  RT-EXP-CCYR  REDEFINES  RT-EXP-CCYY.             ELCDTEVR
   845                 15  RT-EXP-CC                 PIC 99.            ELCDTEVR
   846                 15  RT-EXP-YR                 PIC 99.            ELCDTEVR
   847             10  RT-EXP-MO                     PIC 99.            ELCDTEVR
   848             10  RT-EXP-DA                     PIC 99.            ELCDTEVR
   849         05  WS-RT-EXPIRY-DATE-N REDEFINES                           CL**2
   850                WS-RT-EXPIRY-DATE              PIC 9(11).            CL**2
   851
   852 PROCEDURE DIVISION.
   853
*  854                                 COPY ELCDTERX.
   855******************************************************************04/15/98
   856*                                                                *ELCDTERX
   857*                                                                *ELCDTERX
   858*                            ELCDTERX.                           *   LV002
   859*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
   860*                            VMOD=2.007                          *ELCDTERX
   861*                                                                *ELCDTERX
   862*      LOAD DATE CARD DISK FILE INTO WORKING STORAGE AREA        *ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  21
* CPSRTU1.cbl (/apps/prod/cid1p/copy/ELCDTERX)
   863*      (COPY CODE FOR W/S = ELCDTECX AND COPY CODE FOR FD        *ELCDTERX
   864*      = ELCDTEFD)                                               *ELCDTERX
   865*                                                                *ELCDTERX
   866******************************************************************ELCDTERX
   867                                                                  ELCDTERX
   868     ACCEPT WS-ACCEPT-DATE       FROM  DATE.                      ELCDTERX
   869                                                                  ELCDTERX
   870     MOVE WS-AD-YY               TO  WS-CD-YY.                    ELCDTERX
   871     MOVE WS-AD-MM               TO  WS-CD-MM.                    ELCDTERX
   872     MOVE WS-AD-DD               TO  WS-CD-DD.                    ELCDTERX
   873                                                                  ELCDTERX
   874     ACCEPT WS-TIME-OF-DAY       FROM  TIME.                      ELCDTERX
   875                                                                  ELCDTERX
   876******************************************************************ELCDTERX
   877*    NOTE: THE FOLLOWING STATEMENT IS USED TO ELIMINATE COB II    ELCDTERX
   878*          WARNING MESSAGES.                                      ELCDTERX
   879******************************************************************ELCDTERX
   880     IF WS-CD-YY = LOW-VALUES                                     ELCDTERX
   881         COMPUTE PGM-SUB = PGM-SUB + 1.                           ELCDTERX
   882                                                                  ELCDTERX
   883     OPEN INPUT DISK-DATE.                                        ELCDTERX
   884                                                                  ELCDTERX
   885     MOVE SPACE TO DATE-CARD         CLAS-BUSINESS-CLASSES        ELCDTERX
   886                   STATE-NAMES       CLAS-MORTALITY-CODES         ELCDTERX
   887                   CLAS-INS-TYPES    COMPANY-NAME-TABLE           ELCDTERX
   888                   DATE-CARD-OPTIONS DATE-CARD-FACTORS            ELCDTERX
   889                   CLAX-ID           CLAS-MISC                    ELCDTERX
   890                   CARRIER-NAMES     CLASIC-SYSTEM-CODES          ELCDTERX
   891                   CARRIER-OPT-CLAIM-DATA                         ELCDTERX
   892                   STATE-TARGET-LOSS-RATIOS                       ELCDTERX
   893                   BUSINESS-TRGT-LOSS-RATIO-MODS                  ELCDTERX
   894                   MISC-OPT-CLM-RSV-DATA.                         ELCDTERX
   895                                                                  ELCDTERX
   896     MOVE LOW-VALUES TO CLAS-INDEX-TBL CLAS-TYPE-MISC.            ELCDTERX
   897                                                                  ELCDTERX
   898     MOVE ZERO TO CLAS-CN DTE-TOT-LINES CLAS-CO                   ELCDTERX
   899                  INDEXCA INDEXBS INDEXST.                        ELCDTERX
   900                                                                  ELCDTERX
   901     COMPUTE CLAS-CN = PGM-SUB / +50.                             ELCDTERX
   902     COMPUTE CLAS-CO = PGM-SUB / +20.                             ELCDTERX
   903     COMPUTE CLAS-INDEXEN = PGM-SUB - (CLAS-CN * +50).            ELCDTERX
   904     COMPUTE CLAS-INDEXON = PGM-SUB - (CLAS-CO * +20).            ELCDTERX
   905                                                                  ELCDTERX
   906     IF CLAS-INDEXEN = ZERO                                       ELCDTERX
   907         MOVE +50               TO CLAS-INDEXEN                   ELCDTERX
   908     ELSE                                                         ELCDTERX
   909         ADD +1                 TO CLAS-CN.                       ELCDTERX
   910                                                                  ELCDTERX
   911     IF CLAS-INDEXON = ZERO                                       ELCDTERX
   912         MOVE +20               TO CLAS-INDEXON                   ELCDTERX
   913     ELSE                                                         ELCDTERX
   914         ADD +1                 TO CLAS-CO.                       ELCDTERX
   915                                                                  ELCDTERX
   916 0005-READ--CARD.                                                 ELCDTERX
   917     READ DISK-DATE                                               ELCDTERX
   918         AT END CLOSE DISK-DATE                                   ELCDTERX
   919             GO TO 0060-READ--TEST.                               ELCDTERX
   920                                                                  ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  22
* CPSRTU1.cbl (/apps/prod/cid1p/copy/ELCDTERX)
   921     MOVE ZERO                   TO CLAS-INDEX.                   ELCDTERX
   922                                                                  ELCDTERX
   923     IF DD-ID = 'CLAS' OR 'LIFE' OR 'GLED'                        ELCDTERX
   924         MOVE DATE-DISK          TO DATE-CARD                     ELCDTERX
   925         MOVE RUN-DATE           TO WS-RUN-DATE-N                    CL**2
   926         MOVE EP-DT              TO WS-EP-DT-N                       CL**2
   927         GO TO 0005-READ--CARD.                                   ELCDTERX
   928                                                                  ELCDTERX
   929     IF DD-ID = 'CLAD'                                            ELCDTERX
   930         MOVE DATE-DISK          TO DATE-CARD-OPTIONS             ELCDTERX
   931         GO TO 0005-READ--CARD.                                   ELCDTERX
   932                                                                  ELCDTERX
   933     IF DD-ID = 'CLAX'                                            ELCDTERX
   934         MOVE DATE-DISK          TO CLAS-INDEX-TBL                ELCDTERX
   935         GO TO 0005-READ--CARD.                                   ELCDTERX
   936                                                                  ELCDTERX
   937     IF DD-ID = 'CLAF'                                            ELCDTERX
   938         MOVE DATE-DISK          TO DATE-CARD-FACTORS             ELCDTERX
   939         GO TO 0005-READ--CARD.                                   ELCDTERX
   940                                                                  ELCDTERX
   941     IF DD-ID = 'CLAC'                                            ELCDTERX
   942         GO TO 0010-READ--CLAC.                                   ELCDTERX
   943                                                                  ELCDTERX
   944     IF DD-ID = 'CARR'                                            ELCDTERX
   945         GO TO 0015-READ--CARR.                                   ELCDTERX
   946                                                                  ELCDTERX
   947     IF DD-ID = 'STAT'                                            ELCDTERX
   948         GO TO 0020-READ--STAT.                                   ELCDTERX
   949                                                                  ELCDTERX
   950     IF DD-ID = 'BUSC'                                            ELCDTERX
   951         GO TO 0025-READ--BUSC.                                   ELCDTERX
   952                                                                  ELCDTERX
   953     IF DD-ID = 'MORT'                                            ELCDTERX
   954         GO TO 0030-READ--MORT.                                   ELCDTERX
   955                                                                  ELCDTERX
   956     IF DD-ID = 'CLAI'                                            ELCDTERX
   957         GO TO 0040-READ--CLAI.                                   ELCDTERX
   958                                                                  ELCDTERX
   959     IF DD-ID = 'COLC'                                            ELCDTERX
   960         GO TO 0065-READ--COLC.                                   ELCDTERX
   961                                                                  ELCDTERX
   962     IF DD-IDX NUMERIC AND                                        ELCDTERX
   963        DD-IDA = 'CL'                                             ELCDTERX
   964         GO TO 0035-READ--CLXX.                                   ELCDTERX
   965                                                                  ELCDTERX
   966     IF DD-IDX NUMERIC AND                                        ELCDTERX
   967        DD-IDA = 'PO'                                             ELCDTERX
   968         GO TO 0050-READ--POXX.                                   ELCDTERX
   969                                                                  ELCDTERX
   970     IF DD-ID = 'OPCA'                                            ELCDTERX
   971         GO TO 0070-READ--OPCA.                                   ELCDTERX
   972                                                                  ELCDTERX
   973     IF DD-ID = 'OPST'                                            ELCDTERX
   974         GO TO 0072-READ--OPST.                                   ELCDTERX
   975                                                                  ELCDTERX
   976     IF DD-ID = 'OPBS'                                            ELCDTERX
   977         GO TO 0074-READ--OPBS.                                   ELCDTERX
   978                                                                  ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  23
* CPSRTU1.cbl (/apps/prod/cid1p/copy/ELCDTERX)
   979     IF DD-ID = 'OPMS'                                            ELCDTERX
   980         MOVE DD-MISC-DATA       TO MISC-OPT-CLM-RSV-DATA.        ELCDTERX
   981                                                                  ELCDTERX
   982     GO TO 0005-READ--CARD.                                       ELCDTERX
   983                                                                  ELCDTERX
   984 0010-READ--CLAC.                                                 ELCDTERX
   985     ADD 1                       TO CLAS-INDEXC.                  ELCDTERX
   986     MOVE DD-CR1                 TO CNT-ID (CLAS-INDEXC).         ELCDTERX
   987     MOVE DD-CR1N                TO CNT-NAME (CLAS-INDEXC).       ELCDTERX
   988     ADD 1                       TO CLAS-INDEXC.                  ELCDTERX
   989     MOVE DD-CR2                 TO CNT-ID (CLAS-INDEXC).         ELCDTERX
   990     MOVE DD-CR2N                TO CNT-NAME (CLAS-INDEXC).       ELCDTERX
   991     GO TO 0005-READ--CARD.                                       ELCDTERX
   992                                                                  ELCDTERX
   993 0015-READ--CARR.                                                 ELCDTERX
   994     ADD 1  TO  CLAS-INDEXCN.                                     ELCDTERX
   995     IF CLAS-INDEXCN LESS THAN +26                                ELCDTERX
   996        MOVE DD-CARR1         TO CARRIER-SUB (CLAS-INDEXCN)
   997        MOVE DD-CARR1S        TO CARRIER-DOM-ST (CLAS-INDEXCN)
   998        MOVE DD-CARR1N        TO CARRIER-PIC (CLAS-INDEXCN)
   999        MOVE DD-CARR1-UEP-PCT TO CARRIER-UEP-PCT (CLAS-INDEXCN)
  1000        MOVE DD-CARR1-R78-PCT TO CARRIER-R78-PCT (CLAS-INDEXCN)
  1001        MOVE DD-CARR1-PRO-PCT TO CARRIER-PRO-PCT (CLAS-INDEXCN)
  1002        MOVE DD-CARR1-SECPAY-SW
  1003                               TO CARRIER-SEC-PAY (CLAS-INDEXCN)
  1004     END-IF
  1005                                                                  ELCDTERX
  1006     ADD 1  TO  CLAS-INDEXCN.                                     ELCDTERX
  1007     IF CLAS-INDEXCN LESS THAN +26                                ELCDTERX
  1008        MOVE DD-CARR2         TO CARRIER-SUB (CLAS-INDEXCN)
  1009        MOVE DD-CARR2S        TO CARRIER-DOM-ST (CLAS-INDEXCN)
  1010        MOVE DD-CARR2N        TO CARRIER-PIC (CLAS-INDEXCN)
  1011        MOVE DD-CARR2-UEP-PCT TO CARRIER-UEP-PCT (CLAS-INDEXCN)
  1012        MOVE DD-CARR2-R78-PCT TO CARRIER-R78-PCT (CLAS-INDEXCN)
  1013        MOVE DD-CARR2-PRO-PCT TO CARRIER-PRO-PCT (CLAS-INDEXCN)
  1014        MOVE DD-CARR2-SECPAY-SW
  1015                              TO CARRIER-SEC-PAY (CLAS-INDEXCN)
  1016     END-IF
  1017                                                                  ELCDTERX
  1018                                                                  ELCDTERX
  1019     GO TO 0005-READ--CARD.                                       ELCDTERX
  1020                                                                  ELCDTERX
  1021 0020-READ--STAT.                                                 ELCDTERX
  1022     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  1023     IF CLAS-INDEX GREATER 3  OR                                  ELCDTERX
  1024        DD-ST (CLAS-INDEX) = SPACE                                ELCDTERX
  1025         GO TO 0005-READ--CARD.                                   ELCDTERX
  1026                                                                  ELCDTERX
  1027     ADD 1                       TO CLAS-INDEXS.                  ELCDTERX
  1028     MOVE DD-ST (CLAS-INDEX)     TO STATE-NAME-FLD (CLAS-INDEXS). ELCDTERX
  1029     GO TO 0020-READ--STAT.                                       ELCDTERX
  1030                                                                  ELCDTERX
  1031 0025-READ--BUSC.                                                 ELCDTERX
  1032     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  1033     IF CLAS-INDEX GREATER 3  OR                                  ELCDTERX
  1034        DD-ST (CLAS-INDEX) = SPACE                                ELCDTERX
  1035         GO TO 0005-READ--CARD.                                   ELCDTERX
  1036                                                                  ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  24
* CPSRTU1.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  1037     ADD 1                       TO CLAS-INDEXB.                  ELCDTERX
  1038     MOVE DD-ST (CLAS-INDEX)     TO CLAS-BUSC-FLD (CLAS-INDEXB).  ELCDTERX
  1039     GO TO 0025-READ--BUSC.                                       ELCDTERX
  1040                                                                  ELCDTERX
  1041 0030-READ--MORT.                                                 ELCDTERX
  1042     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  1043     IF CLAS-INDEX GREATER 2  OR                                  ELCDTERX
  1044        DD-MORT (CLAS-INDEX) = SPACE                              ELCDTERX
  1045         GO TO 0005-READ--CARD.                                   ELCDTERX
  1046                                                                  ELCDTERX
  1047     ADD 1                       TO CLAS-INDEXM.                  ELCDTERX
  1048     MOVE DD-MORT (CLAS-INDEX)   TO CLAS-MORT-FLD (CLAS-INDEXM).  ELCDTERX
  1049     GO TO 0030-READ--MORT.                                       ELCDTERX
  1050                                                                  ELCDTERX
  1051 0035-READ--CLXX.                                                 ELCDTERX
  1052     IF DD-IDX NOT = CLAS-CN                                      ELCDTERX
  1053          GO TO 0005-READ--CARD.                                  ELCDTERX
  1054                                                                  ELCDTERX
  1055     IF DD-PS-PIC (CLAS-INDEXEN) = 'X'                            ELCDTERX
  1056         DISPLAY '***********************************************'ELCDTERX
  1057         DISPLAY 'PROGRAM ECS-', PGM-SUB, ' NOT SCHEDULED TO RUN' ELCDTERX
  1058         DISPLAY '***********************************************'ELCDTERX
  1059         GO TO 0055-READ--STOP.                                   ELCDTERX
  1060                                                                  ELCDTERX
  1061     IF DD-PS-PIC (CLAS-INDEXEN) NOT LESS 'A'  AND                ELCDTERX
  1062        DD-PS-PIC (CLAS-INDEXEN) NOT GREATER 'I'                  ELCDTERX
  1063         MOVE '1'                TO DTE-FICH.                     ELCDTERX
  1064                                                                  ELCDTERX
  1065     IF DD-PS-PIC (CLAS-INDEXEN) NOT LESS 'J'  AND                ELCDTERX
  1066        DD-PS-PIC (CLAS-INDEXEN) NOT GREATER 'R'                  ELCDTERX
  1067         MOVE '2'                TO DTE-FICH.                     ELCDTERX
  1068                                                                  ELCDTERX
  1069*    MOVE DD-PS-PIC (CLAS-INDEXEN) TO DTE-PGM-OPT.                ELCDTERX
  1070     GO TO 0005-READ--CARD.                                       ELCDTERX
  1071                                                                  ELCDTERX
  1072 0040-READ--CLAI.                                                 ELCDTERX
  1073     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  1074     IF CLAS-INDEX GREATER 2  OR                                  ELCDTERX
  1075        DD-TYPE (CLAS-INDEX) = SPACE                              ELCDTERX
  1076         GO TO 0005-READ--CARD.                                   ELCDTERX
  1077                                                                  ELCDTERX
  1078     ADD 1                       TO CLAS-INDEXA.                  ELCDTERX
  1079     MOVE DD-TYPE (CLAS-INDEX) TO CLAS-ALL-TYPES (CLAS-INDEXA).   ELCDTERX
  1080     GO TO 0040-READ--CLAI.                                       ELCDTERX
  1081                                                                  ELCDTERX
  1082 0045-READ--DUMP.                                                 ELCDTERX
  1083     MOVE +999 TO WS-RETURN-CODE                                  ELCDTERX
  1084     MOVE 'MISSING AND/OR INVALID CLAS DATE CARD'                 ELCDTERX
  1085                                 TO  WS-ABEND-MESSAGE             ELCDTERX
  1086     PERFORM ABEND-PGM.                                           ELCDTERX
  1087                                                                  ELCDTERX
  1088 0050-READ--POXX.                                                 ELCDTERX
  1089     IF DD-IDX NOT = CLAS-CO                                      ELCDTERX
  1090         GO TO 0005-READ--CARD.                                   ELCDTERX
  1091                                                                  ELCDTERX
  1092     IF DD-PS-PRC (CLAS-INDEXON) = 'X'                            ELCDTERX
  1093         DISPLAY '***********************************************'ELCDTERX
  1094         DISPLAY 'ECS - ', PGM-SUB, ' IS NOT SCHEDULED TO RUN'    ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  25
* CPSRTU1.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  1095         DISPLAY '***********************************************'ELCDTERX
  1096         GO TO 0055-READ--STOP.                                   ELCDTERX
  1097                                                                  ELCDTERX
  1098     MOVE DD-PS-PRT (CLAS-INDEXON) TO DTE-PRT-OPT.                ELCDTERX
  1099     MOVE DD-PS-FMT (CLAS-INDEXON) TO DTE-FMT-OPT.                ELCDTERX
  1100     MOVE DD-PS-PRC (CLAS-INDEXON) TO DTE-PRC-OPT DTE-PGM-OPT.    ELCDTERX
  1101     MOVE DD-PS-TOT (CLAS-INDEXON) TO DTE-TOT-OPT.                ELCDTERX
  1102                                                                  ELCDTERX
  1103     IF DTE-PRT-OPT = 'B'                                         ELCDTERX
  1104         MOVE '2'                  TO DTE-FICH.                   ELCDTERX
  1105     IF DTE-PRT-OPT = 'F'                                         ELCDTERX
  1106         MOVE '1'                  TO DTE-FICH.                   ELCDTERX
  1107                                                                  ELCDTERX
  1108     GO TO 0005-READ--CARD.                                       ELCDTERX
  1109                                                                  ELCDTERX
  1110 0055-READ--STOP.                                                 ELCDTERX
  1111     GOBACK.                                                      ELCDTERX
  1112                                                                  ELCDTERX
  1113 0060-READ--TEST.                                                 ELCDTERX
  1114     IF DATX-COD        = SPACE  OR                               ELCDTERX
  1115        CLAX-ID         = SPACE  OR                               ELCDTERX
  1116        DATE-OPTIONS-ID = SPACE                                   ELCDTERX
  1117         GO TO 0045-READ--DUMP.                                   ELCDTERX
  1118                                                                  ELCDTERX
  1119     MOVE LOW-VALUE TO CLAS-TYPE-MISC.                            ELCDTERX
  1120     GO TO 0079-READ--EXIT.                                       ELCDTERX
  1121                                                                  ELCDTERX
  1122 0065-READ--COLC.                                                 ELCDTERX
  1123     MOVE DATE-DISK              TO CLASIC-SYSTEM-CODES.          ELCDTERX
  1124     GO TO 0005-READ--CARD.                                       ELCDTERX
  1125                                                                  ELCDTERX
  1126 0070-READ--OPCA.                                                 ELCDTERX
  1127                                                                  ELCDTERX
  1128     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  1129                                                                  ELCDTERX
  1130     IF  CLAS-INDEX GREATER 13                                    ELCDTERX
  1131             OR                                                   ELCDTERX
  1132         DD-CARR-FLDS (CLAS-INDEX) = SPACE                        ELCDTERX
  1133         GO TO 0005-READ--CARD.                                   ELCDTERX
  1134                                                                  ELCDTERX
  1135     ADD 1                       TO INDEXCA.                      ELCDTERX
  1136     MOVE DD-CARR-FLDS (CLAS-INDEX)                               ELCDTERX
  1137                                 TO CARRIER-FLDS (INDEXCA).       ELCDTERX
  1138     GO TO 0070-READ--OPCA.                                       ELCDTERX
  1139                                                                  ELCDTERX
  1140 0072-READ--OPST.                                                 ELCDTERX
  1141                                                                  ELCDTERX
  1142     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  1143                                                                  ELCDTERX
  1144     IF  CLAS-INDEX GREATER 16                                    ELCDTERX
  1145             OR                                                   ELCDTERX
  1146         DD-TLR (CLAS-INDEX) = SPACE                              ELCDTERX
  1147         GO TO 0005-READ--CARD.                                   ELCDTERX
  1148                                                                  ELCDTERX
  1149     ADD 1                       TO INDEXST.                      ELCDTERX
  1150     MOVE DD-STATE-FLDS (CLAS-INDEX)                              ELCDTERX
  1151                                 TO STATE-TLR-FLD (INDEXST).      ELCDTERX
  1152     GO TO 0072-READ--OPST.                                       ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  26
* CPSRTU1.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  1153                                                                  ELCDTERX
  1154 0074-READ--OPBS.                                                 ELCDTERX
  1155                                                                  ELCDTERX
  1156     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  1157                                                                  ELCDTERX
  1158     IF  CLAS-INDEX GREATER 32                                    ELCDTERX
  1159             OR                                                   ELCDTERX
  1160         DD-TLR (CLAS-INDEX) = SPACE                              ELCDTERX
  1161         GO TO 0005-READ--CARD.                                   ELCDTERX
  1162                                                                  ELCDTERX
  1163     ADD 1                       TO INDEXBS.                      ELCDTERX
  1164     MOVE DD-TLR (CLAS-INDEX)    TO BUS-TLRM-FLD (INDEXBS).       ELCDTERX
  1165     GO TO 0074-READ--OPBS.                                       ELCDTERX
  1166                                                                  ELCDTERX
  1167 0079-READ--EXIT.                                                 ELCDTERX
  1168*    EXIT.                                                        ELCDTERX
  1169******************************************************************ELCDTERX
  1170
  1171     PERFORM 0100-INITIALIZE     THRU 0100-EXIT
  1172
  1173     PERFORM 0300-BUILD-RATES    THRU 0300-EXIT UNTIL
  1174        NO-MORE-RATES
  1175
  1176     PERFORM 0600-FINALIZE       THRU 0600-EXIT
  1177
  1178     GOBACK
  1179
  1180     .
  1181
  1182 0100-INITIALIZE.
  1183
  1184     MOVE WS-CURRENT-DATE        TO H2-DATE
  1185     MOVE COMPANY-NAME           TO H2-COMP
  1186     MOVE ALPH-DATE              TO H3-DATE
  1187     MOVE ZEROS                  TO H3-PAGE
  1188     MOVE 70                     TO LINE-CNT
  1189
  1190     OPEN INPUT RATE-FILE
  1191        OUTPUT PRINTER
  1192
  1193     OPEN I-O   ERRATE
  1194
  1195     IF ERRATE-FILE-STATUS = '00' OR '97'
  1196        CONTINUE
  1197     ELSE
  1198        MOVE ERRATE-FILE-STATUS  TO WS-ABEND-FILE-STATUS
  1199        MOVE ' RATE MASTER OPEN ERROR- '
  1200                                 TO WS-ABEND-MESSAGE
  1201        PERFORM ABEND-PGM
  1202     END-IF
  1203
  1204     PERFORM 0200-READ-RATES     THRU 0200-EXIT
  1205
  1206     .
  1207 0100-EXIT.
  1208     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  27
* CPSRTU1.cbl
  1210
  1211 0200-READ-RATES.
  1212
  1213     READ RATE-FILE AT END
  1214         SET NO-MORE-RATES TO TRUE
  1215     END-READ
  1216
  1217     IF NOT NO-MORE-RATES
  1218        MOVE FUNCTION UPPER-CASE(RR-STATE)
  1219                                 TO RR-STATE
  1220        MOVE FUNCTION UPPER-CASE(RR-BEN-CODE)
  1221                                 TO RR-BEN-CODE
  1222        MOVE FUNCTION UPPER-CASE(RR-MORT)
  1223                                 TO RR-MORT
  1224        MOVE FUNCTION UPPER-CASE(RR-COMMENTS)
  1225                                 TO RR-COMMENTS
  1226        ADD +1                   TO WS-RATE-RECS
  1227     END-IF
  1228
  1229     .
  1230 0200-EXIT.
  1231     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  28
* CPSRTU1.cbl
  1233
  1234 0300-BUILD-RATES.
  1235
  1236     MOVE LOW-VALUES             TO RT-CONTROL-PRIMARY
  1237     MOVE DTE-CLASIC-COMPANY-CD  TO RT-COMPANY-CD
  1238     MOVE RR-STATE               TO RT-ST-CODE
  1239     MOVE RR-CLASS               TO RT-ST-CLASS
  1240     MOVE RR-DEVIATION           TO RT-ST-DEV
  1241     MOVE RR-TYPE                TO RT-L-AH
  1242     MOVE RR-BEN-CODE            TO RT-LAH-NUM
  1243     MOVE RR-AGE                 TO RT-HIGH-AGE
  1244     MOVE '9'                    TO RT-SEX
  1245     MOVE '99'                   TO RT-FUTURE
  1246     MOVE RR-AMT                 TO RT-HIGH-AMT
  1247     MOVE 99999999999            TO RT-EXPIRY-DATE
  1248
  1249     PERFORM 0500-BUILD-PRT-LINE THRU 0500-EXIT
  1250
  1251     MOVE RR-EFF-DT              TO WS-WORK-DATE (4:8)
  1252     STRING WS-WORK-MM '/' WS-WORK-DD '/' WS-WORK-CCYY
  1253        DELIMITED BY SIZE INTO DTL-EFF-DT
  1254     END-STRING
  1255     MOVE ' INPUT RATE IMAGE '   TO DTL-COMMENTS
  1256     PERFORM 0700-WRITE-PRT-LINE THRU 0700-EXIT
  1257     IF (RR-STATE = SPACES)
  1258        OR (RR-CLASS = SPACES)
  1259        OR (RR-DEVIATION = SPACES)
  1260        OR (RR-BEN-CODE = SPACES)
  1261        OR (RR-TYPE NOT = 'A' AND 'L')
  1262        MOVE ' INPUT IMAGE IN ERROR RATE NOT ADDED '
  1263                 TO DTL-COMMENTS
  1264        PERFORM 0700-WRITE-PRT-LINE THRU 0700-EXIT
  1265     ELSE
  1266        READ ERRATE
  1267        IF ERRATE-FILE-STATUS = '10' OR '23'
  1268           PERFORM 0400-ADD-ERRATE  THRU 0400-EXIT
  1269        ELSE
  1270           IF ERRATE-FILE-STATUS NOT = '00'
  1271              DISPLAY 'STATUS, ERRATE, READ ' ERRATE-FILE-STATUS
  1272              PERFORM ABEND-PGM
  1273           ELSE
  1274              MOVE RATE-RECORD   TO WS-HOLD-ERRATE
  1275              PERFORM 0310-BUILD-NEW
  1276                                 THRU 0310-EXIT
  1277              PERFORM 0320-EXPIRE-OLD
  1278                                 THRU 0320-EXIT
  1279           END-IF
  1280        END-IF
  1281        ADD 1                    TO RECORD-COUNT
  1282     end-if
  1283     PERFORM 0200-READ-RATES     THRU 0200-EXIT
  1284
  1285     .
  1286 0300-EXIT.
  1287     EXIT.
  1288
  1289 0310-BUILD-NEW.
  1290
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  29
* CPSRTU1.cbl
  1291     MOVE RR-ATT-AGE             TO RT-MAX-AGE
  1292     MOVE RR-COMMENTS            TO RT-RATE-COMMENT
  1293     MOVE BIN-RUN-DATE           TO RT-LAST-MAINT-DT
  1294     MOVE 'E504'                 TO RT-LAST-MAINT-USER
  1295     MOVE +190000                TO RT-LAST-MAINT-HHMMSS
  1296     MOVE 'UPLOADED RATES'       TO RT-STRUCTURE-COMMENT
  1297     IF RR-TYPE = 'L'
  1298        MOVE RR-MORT             TO RT-LIFE-MORT-CODE
  1299     END-IF
  1300     PERFORM VARYING SUB1 FROM +1 BY +1 UNTIL
  1301        (SUB1 > +3)
  1302        IF RR-TYPE = 'L'
  1303           MOVE RR-TAGE  (SUB1)  TO RT-L-EX-AGE  (SUB1)
  1304           MOVE RR-TTERM (SUB1)  TO RT-L-EX-TERM (SUB1)
  1305           MOVE RR-TAMT  (SUB1)  TO RT-L-EX-FACE (SUB1)
  1306        ELSE
  1307           MOVE RR-TAGE  (SUB1)  TO RT-AH-AGE   (SUB1)
  1308           MOVE RR-TTERM (SUB1)  TO RT-AH-TERM  (SUB1)
  1309           MOVE RR-TBEN  (SUB1)  TO RT-AH-BEN-M (SUB1)
  1310           MOVE RR-TAMT  (SUB1)  TO RT-AH-BEN-F (SUB1)
  1311        END-IF
  1312     END-PERFORM
  1313     PERFORM VARYING SUB1 FROM +1 BY +1 UNTIL SUB1 > +180
  1314        IF RR-RATES (SUB1) NOT NUMERIC
  1315*          DISPLAY ' RATE NOT NUMERIC  ' RR-RATES (SUB1)
  1316           MOVE ZEROS            TO RR-RATES (SUB1)
  1317        END-IF
  1318        MOVE RR-RATES (SUB1)     TO RT-AH-RATE (SUB1)
  1319     END-PERFORM
  1320     PERFORM 0500-BUILD-PRT-LINE THRU 0500-EXIT
  1321
  1322     MOVE RT-EXPIRY-DATE         TO WS-NUM-DATE
  1323     STRING WS-WORK-MM '/' WS-WORK-DD '/' WS-WORK-CCYY
  1324        DELIMITED BY SIZE INTO DTL-EFF-DT
  1325     END-STRING
  1326     REWRITE RATE-RECORD
  1327     IF ERRATE-FILE-STATUS = '00'
  1328        MOVE ' NEW RATES APPLIED   '
  1329                                 TO DTL-COMMENTS
  1330     ELSE
  1331        DISPLAY 'STATUS, ERRATE, REWRITE ' ERRATE-FILE-STATUS
  1332        PERFORM ABEND-PGM
  1333     END-IF
  1334     PERFORM 0700-WRITE-PRT-LINE THRU 0700-EXIT
  1335
  1336     .
  1337 0310-EXIT.
  1338     EXIT.
  1339 0320-EXPIRE-OLD.
  1340
  1341     MOVE WS-HOLD-ERRATE         TO RATE-RECORD
  1342     MOVE RR-EFF-DT              TO RT-EXPIRY-DATE
  1343     PERFORM 0500-BUILD-PRT-LINE THRU 0500-EXIT
  1344
  1345     MOVE RT-EXPIRY-DATE         TO WS-NUM-DATE
  1346     STRING WS-WORK-MM '/' WS-WORK-DD '/' WS-WORK-CCYY
  1347        DELIMITED BY SIZE INTO DTL-EFF-DT
  1348     END-STRING
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  30
* CPSRTU1.cbl
  1349     WRITE RATE-RECORD
  1350     IF ERRATE-FILE-STATUS = '22'
  1351        MOVE ' DUPLICATE RECORD FOUND '
  1352                                 TO DTL-COMMENTS
  1353     ELSE
  1354        IF ERRATE-FILE-STATUS = '00'
  1355           MOVE ' RATE RECORD EXPIRED '
  1356                                 TO DTL-COMMENTS
  1357        ELSE
  1358           DISPLAY 'STATUS, ERRATE,  1WRITE ' ERRATE-FILE-STATUS
  1359           PERFORM ABEND-PGM
  1360        END-IF
  1361     END-IF
  1362
  1363     PERFORM 0700-WRITE-PRT-LINE THRU 0700-EXIT
  1364     .
  1365 0320-EXIT.
  1366     EXIT.
  1367
  1368 0400-ADD-ERRATE.
  1369
  1370     MOVE SPACES                 TO RATE-RECORD
  1371     MOVE LOW-VALUES             TO RT-CONTROL-PRIMARY
  1372     MOVE DTE-CLASIC-COMPANY-CD  TO RT-COMPANY-CD
  1373     MOVE RR-STATE               TO RT-ST-CODE
  1374     MOVE RR-CLASS               TO RT-ST-CLASS
  1375     MOVE RR-DEVIATION           TO RT-ST-DEV
  1376     MOVE RR-TYPE                TO RT-L-AH
  1377     MOVE RR-BEN-CODE            TO RT-LAH-NUM
  1378     MOVE RR-AGE                 TO RT-HIGH-AGE
  1379     MOVE '9'                    TO RT-SEX
  1380     MOVE '99'                   TO RT-FUTURE
  1381     MOVE RR-AMT                 TO RT-HIGH-AMT
  1382     MOVE 99999999999            TO RT-EXPIRY-DATE
  1383
  1384     MOVE BIN-RUN-DATE           TO RT-LAST-MAINT-DT
  1385     MOVE 'E504'                 TO RT-LAST-MAINT-USER
  1386     MOVE +190000                TO RT-LAST-MAINT-HHMMSS
  1387     MOVE 'UPLOADED RATES'       TO RT-STRUCTURE-COMMENT
  1388     IF RT-L-AH = 'A'
  1389        INITIALIZE RT-AH-LIMS-FLDS
  1390        INITIALIZE RT-AH-RATES
  1391     ELSE
  1392        INITIALIZE RT-LIFE-LIMS-FLDS
  1393        INITIALIZE RT-LIFE-RATES
  1394     END-IF
  1395
  1396     MOVE +0                     TO RT-DAILY-RATE
  1397                                    RT-DISCOUNT-RATE
  1398                                    RT-DISCOUNT-OB-RATE
  1399                                    RT-COMPOSITE-RATE
  1400                                    RT-POLICY-FEE
  1401                                    RTC-4
  1402     MOVE RR-ATT-AGE             TO RT-MAX-AGE
  1403     MOVE RR-COMMENTS            TO RT-RATE-COMMENT
  1404     IF RR-TYPE = 'L'
  1405        MOVE RR-MORT             TO RT-LIFE-MORT-CODE
  1406     END-IF
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  31
* CPSRTU1.cbl
  1407     PERFORM VARYING SUB1 FROM +1 BY +1 UNTIL
  1408        (SUB1 > +3)
  1409        IF RR-TYPE = 'L'
  1410           MOVE RR-TAGE  (SUB1)  TO RT-L-EX-AGE  (SUB1)
  1411           MOVE RR-TTERM (SUB1)  TO RT-L-EX-TERM (SUB1)
  1412           MOVE RR-TAMT  (SUB1)  TO RT-L-EX-FACE (SUB1)
  1413        ELSE
  1414           MOVE RR-TAGE  (SUB1)  TO RT-AH-AGE   (SUB1)
  1415           MOVE RR-TTERM (SUB1)  TO RT-AH-TERM  (SUB1)
  1416           MOVE RR-TBEN  (SUB1)  TO RT-AH-BEN-M (SUB1)
  1417           MOVE RR-TAMT  (SUB1)  TO RT-AH-BEN-F (SUB1)
  1418        END-IF
  1419     END-PERFORM
  1420     PERFORM VARYING SUB1 FROM +1 BY +1 UNTIL SUB1 > +180
  1421        IF RR-RATES (SUB1) NOT NUMERIC
  1422*          DISPLAY ' ADD RATE NOT NUMERIC  ' RR-RATES (SUB1)
  1423           MOVE ZEROS            TO RR-RATES (SUB1)
  1424        END-IF
  1425        MOVE RR-RATES (SUB1)      TO RT-AH-RATE (SUB1)
  1426     END-PERFORM
  1427
  1428     PERFORM 0500-BUILD-PRT-LINE THRU 0500-EXIT
  1429     MOVE RT-EXPIRY-DATE         TO WS-NUM-DATE
  1430     STRING WS-WORK-MM '/' WS-WORK-DD '/' WS-WORK-CCYY
  1431        DELIMITED BY SIZE INTO DTL-EFF-DT
  1432     END-STRING
  1433
  1434     WRITE RATE-RECORD
  1435     IF ERRATE-FILE-STATUS = '22'
  1436        MOVE ' DUPLICATE RECORD FOUND '
  1437                                 TO DTL-COMMENTS
  1438     ELSE
  1439        IF ERRATE-FILE-STATUS = '00'
  1440
  1441           MOVE ' RATE RECORD   ADDED '
  1442                                 TO DTL-COMMENTS
  1443        ELSE
  1444           DISPLAY 'STATUS, ERRATE,  2WRITE ' ERRATE-FILE-STATUS
  1445           PERFORM ABEND-PGM
  1446        END-IF
  1447     END-IF
  1448
  1449     PERFORM 0700-WRITE-PRT-LINE THRU 0700-EXIT
  1450
  1451     .
  1452 0400-EXIT.
  1453     EXIT.
  1454
  1455 0500-BUILD-PRT-LINE.
  1456
  1457     MOVE RT-ST-CODE             TO DTL-STATE
  1458     MOVE RT-ST-CLASS            TO DTL-CLASS
  1459     MOVE RT-ST-DEV              TO DTL-DEV
  1460     MOVE RT-LAH-NUM             TO DTL-BEN-CD
  1461     MOVE SPACES                 TO DTL-EFF-DT
  1462
  1463     .
  1464 0500-EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  32
* CPSRTU1.cbl
  1465     EXIT.
  1466
  1467 0600-FINALIZE.
  1468
  1469     CLOSE RATE-FILE
  1470           ERRATE
  1471           PRINTER
  1472
  1473     .
  1474 0600-EXIT.
  1475     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  33
* CPSRTU1.cbl
  1477
  1478 0700-WRITE-PRT-LINE.
  1479
  1480     IF LINE-CNT > +60
  1481        PERFORM 0800-WRITE-HDR-LINES
  1482                                 THRU 0800-EXIT
  1483     END-IF
  1484
  1485     MOVE DTL-1                  TO P-DATA
  1486     MOVE ' '                    TO P-CTL
  1487     WRITE PRT AFTER ADVANCING 1 LINES
  1488     ADD +1                      TO LINE-CNT
  1489
  1490     .
  1491 0700-EXIT.
  1492     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  34
* CPSRTU1.cbl
  1494
  1495 0800-WRITE-HDR-LINES.
  1496
  1497     MOVE DTE-CLIENT             TO H1-COMPANY-ID
  1498     MOVE HDR-1                  TO P-DATA
  1499     MOVE '1'                    TO P-CTL
  1500     WRITE PRT AFTER ADVANCING PAGE
  1501     MOVE HDR-2                  TO P-DATA
  1502     MOVE ' '                    TO P-CTL
  1503     WRITE PRT AFTER ADVANCING 1 LINE
  1504     MOVE HDR-3                  TO P-DATA
  1505     MOVE ' '                    TO P-CTL
  1506     WRITE PRT AFTER ADVANCING 1 LINE
  1507     MOVE HDR-4                  TO P-DATA
  1508     MOVE '0'                    TO P-CTL
  1509     WRITE PRT AFTER ADVANCING 2 LINES
  1510     MOVE ' '                    TO P-DATA
  1511     MOVE ' '                    TO P-CTL
  1512     WRITE PRT AFTER ADVANCING 1 LINES
  1513
  1514     MOVE +6                     TO LINE-CNT
  1515
  1516     .
  1517 0800-EXIT.
  1518     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  35
* CPSRTU1.cbl
  1520
  1521
  1522 ABEND-PGM  SECTION.
*                           COPY ELCABEND  SUPPRESS.
  1558
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:       53288     Code:        6211
