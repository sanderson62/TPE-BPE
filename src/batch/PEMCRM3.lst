* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   1
* PEMCRM3.cbl
* Options: int("PEMCRM3.int") anim csi verbose NOBOUND PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("PEMCRM3.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"ebmlsfile" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" NOCHECKDIV NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"32" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"PEMCRM3.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"PEMCRM3.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR NOSTICKY-LINKAGE
*          NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"2" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.                                         00000100
     2 PROGRAM-ID.                PEMCRM3.                              00000200
     3*AUTHOR.     PABLO.                                               00000400
     4*REMARKS.                                                         00000900
     5*     THIS PROGRAM READS THE CERT, MATCHES TO ELCERT AND WRITES
     6*       OUT A NEW CERT.
     7 ENVIRONMENT DIVISION.                                            00001500
     8 INPUT-OUTPUT SECTION.                                            00001600
     9 FILE-CONTROL.                                                    00001700
    10
    11     SELECT ELCERT-IN            ASSIGN TO SYS010.
    12
    13     SELECT CERT-IN              ASSIGN TO SYS011.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   2
* PEMCRM3.cbl
    14
    15     SELECT CERT-OUT             ASSIGN TO SYS013.
    16                                                                  00002200
    17 DATA DIVISION.                                                   00002400
    18                                                                  00002500
    19 FILE SECTION.                                                    00002600
    20
    21 FD  CERT-IN                                                      00004060
    22     RECORDING MODE IS F                                          00004070
    23     LABEL RECORDS ARE STANDARD                                   00004080
    24     BLOCK CONTAINS 0 RECORDS.                                    00004091
    25
*   26                                COPY ECSCRT01.                    00004094
    27******************************************************************
    28*                                                                *
    29*                            ECSCRT01                            *
    30*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
    31*                            VMOD=2.016                          *
    32*                                                                *
    33*   FILE DESCRIPTION = CERTIFICATE RECORD    (OFF-LINE)          *
    34*                                                                *
    35*   FILE TYPE = SEQUENTIAL
    36*   RECORD SIZE = 1056 RECFORM = FIXED                           *
    37*                                                                *
    38*   KEY DATA =                         START=4, LEN=36           *
    39*                                                                *
    40*  NO  CID  MODS  IN  COPYBOOK  ECSCRT01                         *
    41*                                                                *
    42******************************************************************
    43******************************************************************
    44*                   C H A N G E   L O G
    45*
    46* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    47*-----------------------------------------------------------------
    48*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    49* EFFECTIVE    NUMBER
    50*-----------------------------------------------------------------
    51* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
    52* 100703    2003080800002  PEMA  ADD SUPER GAP PROCESSING
    53* 040504    2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
    54* 020305    2005020000000  PEMA  ADD CLP STATE TO CERT RECORD
    55* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
    56* 042408    2007110500003  PEMA  ADD REFUND INTEREST PROCESSING
    57* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
    58* 032612  CR2011110200001  PEMA  AHL CHANGES
    59* 052814  CR2014012300001  PEMA  DCC CREDIT UNION CHANGES
    60* 090314  CR2014081300001  PEMA  LOAD CERTS INVOLVED IN THAO
    61******************************************************************
    62
    63 01  CERTIFICATE-RECORD.
    64     12  CR-RECORD-ID                      PIC XX.
    65         88  VALID-CR-ID                      VALUE 'CR'.
    66
    67     12  CR-COMPANY-CD                     PIC X.
    68
    69     12  CR-FULL-CONTROL.
    70         16  CR-CONTROL-1.
    71             20  CR-ACCT-CONTROL.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   3
* PEMCRM3.cbl (/apps/prod/cid1p/copy/ECSCRT01)
    72                 24  CR-CARRIER            PIC X.
    73                 24  CR-GROUPING.
    74                     28  CR-GROUP-PREFIX   PIC XXX.
    75                     28  CR-GROUP-PRIME    PIC XXX.
    76                 24  CR-STATE              PIC XX.
    77                 24  CR-ACCOUNT.
    78                     28  CR-ACCT-PREFIX    PIC X(4).
    79                     28  CR-ACCT-PRIME     PIC X(6).
    80             20  CR-DT                     PIC 9(11)  COMP-3.
    81         16  CR-CERT-NO.
    82             20  CR-CERT.
    83                 24  CR-CERT-PREFIX        PIC X(3).
    84                 24  CR-CERT-PRIME         PIC X(7).
    85             20  CR-CERT-SFX               PIC X.
    86
    87     12  CR-INSUREDS-PROFILE.
    88         16  CR-NAME.
    89             20  CR-LNAME                  PIC X(15).
    90             20  CR-FNAME.
    91                 24  CR-1ST-INITIAL        PIC X.
    92                 24  FILLER                PIC X(9).
    93             20  CR-INIT                   PIC X.
    94         16  CR-AGE                        PIC 99.
    95         16  CR-SEX                        PIC X.
    96             88  CR-SEX-MALE                  VALUE 'M'.
    97             88  CR-SEX-FEMALE                VALUE 'F'.
    98         16  CR-SOC-SEC                    PIC X(11).
    99         16  CR-JOINT-NAME.
   100             20  CR-JT-LNAME               PIC X(15).
   101             20  CR-JT-FNAME.
   102                 24  CR-JT-1ST-INIT        PIC X.
   103                 24  FILLER                PIC X(9).
   104             20  CR-JT-INIT                PIC X.
   105         16  CR-JOINT-AGE                  PIC 99.
   106
   107         16  cr-ahl-ah-claim-no            pic x(9).
   108         16  cr-ahl-ah-cert-seq            pic x(3).
   109         16  cr-hst-proc-lf                pic x.
   110         16  f                             pic x(7).
   111
   112     12  CR-LF-COVERAGE-DATA.
   113         16  CR-LFTYP                      PIC XX.
   114         16  CR-LF-TERM                    PIC S999       COMP-3.
   115         16  CR-LF-CRIT-PERIOD             PIC S999       COMP-3.
   116         16  CR-LF-TERM-IN-DAYS            PIC S9(5)      COMP-3.
   117         16  CR-LF-DEV-CODE                PIC XXX.
   118         16  CR-LF-DEV-PCT                 PIC S9V9(6)    COMP-3.
   119
   120         16  CR-LFAMT                      PIC S9(9)V99   COMP-3.
   121         16  CR-LFPRM                      PIC S9(7)V99   COMP-3.
   122         16  CR-LFPRM-CALC                 PIC S9(7)V99   COMP-3.
   123         16  CR-LFPRM-RATE                 PIC S99V9(5)   COMP-3.
   124
   125         16  CR-LFAMT-ALT                  PIC S9(9)V99   COMP-3.
   126         16  CR-LFPRM-ALT                  PIC S9(7)V99   COMP-3.
   127         16  CR-LFPRM-CALC-ALT             PIC S9(7)V99   COMP-3.
   128         16  CR-LFPRM-RATE-ALT             PIC S99V9(5)   COMP-3.
   129
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   4
* PEMCRM3.cbl (/apps/prod/cid1p/copy/ECSCRT01)
   130         16  CR-LFRFND                     PIC S9(7)V99   COMP-3.
   131         16  CR-LFRFND-CALC                PIC S9(7)V99   COMP-3.
   132
   133         16  CR-LF-NSP-PRM                 PIC S9(7)V99   COMP-3.
   134         16  CR-LF-NSP-PRM-RATE            PIC S99V9(5)   COMP-3.
   135
   136         16  CR-LF-REFUND-TYPE             PIC X.
   137         16  CR-LF-POLICY-FEE              PIC S9(3)V99   COMP-3.
   138
   139         16  CR-LF-COMM-CHARGEBACK         PIC X.
   140             88  CR-NO-LF-CHARGEBACK          VALUE 'N'.
   141
   142         16  CR-LF-REI-RISK-PRM            PIC S9(7)V99   COMP-3.
   143
   144         16  CR-LF-EXPIRE-DATE             PIC 9(11)      COMP-3.
   145         16  CR-LF-ISS-PREM-TAX            PIC S9V9(4)    COMP-3.
   146         16  CR-LF-CNC-PREM-TAX            PIC S9V9(4)    COMP-3.
   147
   148         16  cr-ahl-lf-claim-no            pic x(9).
   149         16  cr-ahl-lf-cert-seq            pic x(3).
   150         16  FILLER                        PIC XX.
   151
   152     12  CR-AH-COVERAGE-DATA.
   153         16  CR-AHTYP                      PIC XX.
   154         16  CR-AH-TERM                    PIC S999       COMP-3.
   155         16  CR-AH-CRIT-PERIOD             PIC S999       COMP-3.
   156         16  CR-AH-DEV-CODE                PIC XXX.
   157         16  CR-AH-DEV-PCT                 PIC S9V9(6)    COMP-3.
   158
   159         16  CR-AHAMT                      PIC S9(7)V99   COMP-3.
   160         16  CR-AHPRM                      PIC S9(7)V99   COMP-3.
   161         16  CR-AHPRM-CALC                 PIC S9(7)V99   COMP-3.
   162         16  CR-AHPRM-RATE                 PIC S99V9(5)   COMP-3.
   163
   164         16  CR-AHRFND                     PIC S9(7)V99   COMP-3.
   165         16  CR-AHRFND-CALC                PIC S9(7)V99   COMP-3.
   166
   167         16  CR-AH-NSP-PRM                 PIC S9(7)V99   COMP-3.
   168         16  CR-AH-NSP-PRM-RATE            PIC S99V9(5)   COMP-3.
   169
   170         16  CR-AH-REFUND-TYPE             PIC X.
   171         16  CR-AH-POLICY-FEE              PIC S9(3)V99   COMP-3.
   172
   173         16  CR-AH-COMM-CHARGEBACK         PIC X.
   174             88  CR-NO-AH-CHARGEBACK          VALUE 'N'.
   175
   176         16  CR-AH-REI-RISK-PRM            PIC S9(7)V99   COMP-3.
   177
   178         16  CR-AH-EXPIRE-DATE             PIC 9(11)      COMP-3.
   179         16  CR-AH-ISS-PREM-TAX            PIC S9V9(4)    COMP-3.
   180         16  CR-AH-CNC-PREM-TAX            PIC S9V9(4)    COMP-3.
   181
   182         16  FILLER                        PIC XX.
   183*        16  FILLER                        PIC X(8).
   184
   185     12  CR-LOAN-DATA.
   186         16  CR-LIVES                      PIC S9(7)      COMP-3.
   187         16  CR-DDF-IU-RATE-UP REDEFINES CR-LIVES
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   5
* PEMCRM3.cbl (/apps/prod/cid1p/copy/ECSCRT01)
   188                                           PIC S9(5)V99   COMP-3.
   189         16  CR-BILLED                     PIC S9(7)      COMP-3.
   190         16  CR-APR                        PIC S999V9(4)  COMP-3.
   191         16  CR-PMT-FREQ                   PIC 99.
   192         16  CR-LOAN-TERM                  PIC S999       COMP-3.
   193         16  CR-RATING-CLASS               PIC XX.
   194         16  CR-POLICY-FORM-NO             PIC X(12).
   195         16  CR-GRPTYP                     PIC XX.
   196         16  CR-IND-GRP                    PIC X.
   197             88  CR-INDIVIDUAL                VALUE '1'.
   198             88  CR-GROUP                     VALUE '2'.
   199         16  CR-SKIP                       PIC 99.
   200             88  NO-MONTHS-SKIPPED            VALUE 00.
   201             88  SKIP-JULY                    VALUE 01.
   202             88  SKIP-AUGUST                  VALUE 02.
   203             88  SKIP-SEPTEMBER               VALUE 03.
   204             88  SKIP-JULY-AUG                VALUE 04.
   205             88  SKIP-AUG-SEPT                VALUE 05.
   206             88  SKIP-JULY-AUG-SEPT           VALUE 06.
   207             88  SKIP-JUNE-JULY-AUG           VALUE 07.
   208             88  SKIP-JUNE                    VALUE 08.
   209             88  SKIP-JUNE-JULY               VALUE 09.
   210             88  SKIP-AUG-SEPT-OCT            VALUE 10.
   211             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 11.
   212         16  CR-RESIDENT-STATE             PIC XX.
   213         16  CR-RATE-CODE.
   214             20  CR-LF-CLASS-CD            PIC XX.
   215             20  CR-AH-CLASS-CD            PIC XX.
   216         16  CR-MORT.
   217             20  CR-TAB                    PIC X.
   218             20  CR-INT                    PIC 99.
   219             20  CR-GRP                    PIC X.
   220         16  CR-MEMBER-NO                  PIC X(12).
   221         16  CR-OLD-LOF                    PIC XXX.
   222*        16  CR-LOAN-OFFICER               PIC XXX.
   223         16  CR-REIN-TABLE                 PIC XXX.
   224         16  CR-REIN-SPEC                  PIC X.
   225         16  CR-LOAN-1ST-PMT-DT.
   226             20  CR-1ST-PMT-YR             PIC 99.
   227             20  CR-1ST-PMT-MO             PIC 99.
   228             20  CR-1ST-PMT-DA             PIC 99.
   229         16  CR-SUM-CAN-CNT-ITD            PIC S999       COMP-3.
   230         16  CR-SUM-CAN-CNT-YTD            PIC S999       COMP-3.
   231         16  CR-PMT-EXTENSION-DAYS         PIC S999       COMP-3.
   232         16  CR-LAST-ADD-ON-DT             PIC XX.
   233
   234         16  CR-UNDERWRITING-CODE          PIC X.
   235             88  CR-POLICY-UNDERWRITTEN       VALUE 'Y'.
   236
   237         16  CR-STATE-TAX                  PIC S9(7)V99   COMP-3.
   238         16  CR-MUNI-TAX                   PIC S9(7)V99   COMP-3.
   239         16  CR-CANCEL-STATE-TAX           PIC S9(7)V99   COMP-3.
   240         16  CR-CANCEL-MUNI-TAX            PIC S9(7)V99   COMP-3.
   241
   242     12  CR-STATUS-INFORMATION.
   243         16  CR-ENTRY-STATUS               PIC X.
   244             88  CR-NORMAL-ENTRY              VALUE '1'.
   245             88  CR-POLICY-IS-RESTORE         VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   6
* PEMCRM3.cbl (/apps/prod/cid1p/copy/ECSCRT01)
   246             88  CR-CONVERSION-ENTRY          VALUE '4'.
   247             88  CR-POLICY-IS-REISSUE         VALUE '5'.
   248             88  CR-POLICY-IS-CASH            VALUE 'C'.
   249             88  CR-POLICY-IS-MONTHLY         VALUE 'M'.
   250             88  CR-POLICY-IS-REIN-ONLY       VALUE '9'.
   251             88  CR-POLICY-IS-DECLINED        VALUE 'D'.
   252             88  CR-POLICY-IS-VOID            VALUE 'V'.
   253             88  CR-POLICY-IS-PREM-ONLY       VALUE 'P'.
   254             88  CR-POLICY-IS-ACTIVE          VALUE '1' '3' '4'
   255                                                'C' '5' '9' 'P'.
   256         16  CR-ENTRY-DATE                 PIC 9(11)  COMP-3.
   257
   258         16  CR-LF-STATUS-AT-CANCEL        PIC X.
   259         16  CR-LF-CANC-DT                 PIC 9(11)  COMP-3.
   260         16  CR-LF-CANCEL-EXIT-DATE        PIC 9(11)  COMP-3.
   261
   262         16  CR-LF-STATUS-AT-DEATH         PIC X.
   263         16  CR-LF-CLAIM-EXIT-DATE         PIC 9(11)  COMP-3.
   264
   265         16  CR-LF-CURRENT-STATUS          PIC X.
   266             88  CR-LF-NORMAL-ENTRY           VALUE '1'.
   267             88  CR-LF-POLICY-PENDING         VALUE '2'.
   268             88  CR-LF-POLICY-IS-RESTORE      VALUE '3'.
   269             88  CR-LF-CONVERSION-ENTRY       VALUE '4'.
   270             88  CR-LF-POLICY-IS-REISSUE      VALUE '5'.
   271             88  CR-LF-POLICY-IS-MONTHLY      VALUE 'M'.
   272             88  CR-LF-LUMP-SUM-DISAB         VALUE '6'.
   273             88  CR-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
   274             88  CR-LF-CANCEL-APPLIED         VALUE '8'.
   275             88  CR-LF-IS-REIN-ONLY           VALUE '9'.
   276             88  CR-LF-IS-DECLINED            VALUE 'D'.
   277             88  CR-LF-IS-VOID                VALUE 'V'.
   278             88  CR-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
   279                                                    '4' '5' '9'.
   280
   281         16  CR-AH-STATUS-AT-CANCEL        PIC X.
   282
   283         16  CR-AH-CANC-DT                 PIC 9(11)  COMP-3.
   284         16  CR-AH-CANCEL-EXIT-DATE        PIC 9(11)  COMP-3.
   285
   286         16  CR-AH-STATUS-AT-SETTLEMENT    PIC X.
   287         16  CR-AH-SETTLEMENT-EXIT-DATE    PIC 9(11)  COMP-3.
   288
   289         16  CR-AH-CURRENT-STATUS          PIC X.
   290             88  CR-AH-NORMAL-ENTRY           VALUE '1'.
   291             88  CR-AH-POLICY-PENDING         VALUE '2'.
   292             88  CR-AH-POLICY-IS-RESTORE      VALUE '3'.
   293             88  CR-AH-CONVERSION-ENTRY       VALUE '4'.
   294             88  CR-AH-POLICY-IS-REISSUE      VALUE '5'.
   295             88  CR-AH-POLICY-IS-MONTHLY      VALUE 'M'.
   296             88  CR-AH-LUMP-SUM-DISAB         VALUE '6'.
   297             88  CR-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
   298             88  CR-AH-CANCEL-APPLIED         VALUE '8'.
   299             88  CR-AH-IS-REIN-ONLY           VALUE '9'.
   300             88  CR-AH-IS-DECLINED            VALUE 'D'.
   301             88  CR-AH-IS-VOID                VALUE 'V'.
   302             88  CR-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
   303                                                    '4' '5' '9'.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   7
* PEMCRM3.cbl (/apps/prod/cid1p/copy/ECSCRT01)
   304         16  CR-LOAN-OFFICER               PIC X(5).
   305         16  CR-CANCEL-REASON              PIC X.
   306         16  cr-xycor-lf-cov-code          pic x(4).
   307         16  cr-xycor-ah-cov-code          pic x(4).
   308         16  cr-temp-epiq                  pic x(4).
   309         16  FILLER                        PIC XX.
   310
   311     12  CR-DEATH-CLAIM-DATA.
   312         16  CR-NUM-DTH-CLM                PIC S999       COMP-3.
   313
   314         16  CR-DTH-DT                     PIC 9(11)      COMP-3.
   315         16  CR-DTH-RPT-DT.
   316             20  CR-DTH-RPT-YR             PIC 99.
   317             20  CR-DTH-RPT-MO             PIC 99.
   318             20  CR-DTH-RPT-DA             PIC 99.
   319         16  CR-DTH-PAY-DT                 PIC 9(11)      COMP-3.
   320
   321         16  CR-DTHAMT                     PIC S9(9)V99   COMP-3.
   322         16  CR-DTHAMT-YTD                 PIC S9(9)V99   COMP-3.
   323         16  CR-DTHAMT-LAST                PIC S9(9)V99   COMP-3.
   324         16  CR-DTHEXP                     PIC S9(7)V99   COMP-3.
   325         16  CR-DTHEXP-YTD                 PIC S9(7)V99   COMP-3.
   326
   327         16  CR-DTH-AGE                    PIC 99.
   328         16  CR-DTH-PAY-CD                 PIC X.
   329         16  CR-DEATH-CAUSE                PIC X(6).
   330
   331         16  FILLER                        PIC X(16).
   332
   333     12  CR-DISAB-CLAIM-DATA.
   334         16  CR-NUM-DIS-CLM                PIC S999       COMP-3.
   335
   336         16  CR-DIS-DT                     PIC 9(11)      COMP-3.
   337         16  CR-DIS-RPT-DT.
   338             20  CR-DIS-RPT-YR             PIC 99.
   339             20  CR-DIS-RPT-MO             PIC 99.
   340             20  CR-DIS-RPT-DA             PIC 99.
   341         16  CR-DIS-PAY-DT                 PIC 9(11)      COMP-3.
   342         16  CR-DIS-PTO-DT                 PIC 9(11)      COMP-3.
   343
   344         16  CR-DISAMT                     PIC S9(9)V99   COMP-3.
   345         16  CR-DISAMT-YTD                 PIC S9(9)V99   COMP-3.
   346         16  CR-DISAMT-LAST                PIC S9(9)V99   COMP-3.
   347         16  CR-DISEXP                     PIC S9(7)V99   COMP-3.
   348         16  CR-DISEXP-YTD                 PIC S9(7)V99   COMP-3.
   349
   350         16  CR-DAYS-DISAB                 PIC 999        COMP-3.
   351         16  CR-DIS-PAY-CD                 PIC X.
   352         16  FILLER                        PIC XX.
   353
   354         16  CR-DISAB-INCURRED-DETAIL.
   355             20  CR-DISAB-DETAIL-DATA  OCCURS 5 TIMES.
   356**ELCCRTVR MUST BE CHANGED IF THE "OCCURS" IS CHANGED.
   357                 24  CR-DIS-INCUR-DT       PIC 9(11)     COMP-3.
   358                 24  CR-INCUR-DISAMT       PIC S9(9)V99  COMP-3.
   359                 24  CR-INCUR-DISEXP       PIC S9(9)V99  COMP-3.
   360
   361         16  CR-DISAB-CAUSE                PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   8
* PEMCRM3.cbl (/apps/prod/cid1p/copy/ECSCRT01)
   362         16  FILLER                        PIC X(14).
   363
   364     12  CR-REMIT-TO                       PIC 99.
   365
   366     12  CR-COMPENSATION-LEVELS.
   367         16  CR-AGT-LEVELS      OCCURS 10 TIMES.
   368             20  CR-COM-AGT.
   369                 24  CR-COM-AGT-PREFIX     PIC X(4).
   370                 24  CR-COM-AGT-PRIME      PIC X(6).
   371             20  CR-AGT-TYPE               PIC X.
   372             20  CR-LCOM-L                 PIC SV9(5)     COMP-3.
   373             20  CR-LCOM-AH                PIC SV9(5)     COMP-3.
   374
   375     12  CR-BANK-NOCHRGB-MONTHS            PIC 99.
   376     12  CR-MOB-NET-TOT-FEES               PIC S9(7)V99   COMP-3.
   377     12  CR-ADDL-CLP                       PIC S9(5)V99   COMP-3.
   378     12  CR-CLP-STATE                      PIC XX.
   379     12  CR-POST-CARD-IND                  PIC X.
   380     12  CR-LF-CLP                         PIC S9(5)V99   COMP-3.
   381     12  CR-AH-CLP                         PIC S9(5)V99   COMP-3.
   382     12  CR-DCC-PRODUCT-CODE               PIC XXX.
   383     12  CR-LF-RFND-CLP                    PIC S9(5)V99   COMP-3.
   384     12  CR-AH-RFND-CLP                    PIC S9(5)V99   COMP-3.
   385     12  FILLER                            PIC X(07).
   386
   387     12  CR-CSR-CODE                       PIC XXX.
   388
   389     12  CR-CLAIM-DEDUCT-WITHHELD          PIC S9(5)V99   COMP-3.
   390     12  CR-CANCEL-DEDUCT-WITHHELD         PIC S9(5)V99   COMP-3.
   391
   392     12  CR-MICROFILM-NUMBERS.
   393*        16  CR-ISS-MICROFILM-NO           PIC S9(9)      COMP-3.
   394         16  FILLER                        PIC X(5).
   395     12  CR-NH-INT-ON-REF                  PIC S9(7)V99   COMP-3.
   396
   397     12  CR-USER-CODE                      PIC X.
   398     12  CR-USER-FUTURE                    PIC X(9).
   399
   400     12  CR-BENEFICIARY.
   401         16  CR-BANK-NO                    PIC X(10).
   402         16  FILLER                        PIC X(15).
   403
   404     12  CR-ENTRY-BATCH                    PIC X(6).
   405     12  CR-LF-EXIT-BATCH                  PIC X(6).
   406     12  CR-AH-EXIT-BATCH                  PIC X(6).
   407
   408     12  CR-NOTE-SW                        PIC X.
   409
   410     12  CR-ORIGIN-INDICATOR               PIC X.
   411         88  CR-ENTERED-MANUALLY              VALUE '1'.
   412         88  CR-CREATED-FROM-TAPE-LOAD        VALUE '2'.
   413
   414     12  CR-LF-CNC-ENT-DT                  PIC 9(11)  COMP-3.
   415     12  CR-AH-CNC-ENT-DT                  PIC 9(11)  COMP-3.
   416     12  FILLER                            PIC X(33).
   417
   418******************************************************************
   419
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   9
* PEMCRM3.cbl
   420 FD  CERT-OUT                                                     00004060
   421     RECORDING MODE IS F                                          00004070
   422     LABEL RECORDS ARE STANDARD                                   00004080
   423     BLOCK CONTAINS 0 RECORDS.                                    00004091
   424
   425 01  CERT-OUT-RECORD            PIC X(1056).                      00004094
   426
   427 FD  ELCERT-IN                                                    00004060
   428     RECORDING MODE IS F                                          00004070
   429     LABEL RECORDS ARE STANDARD                                   00004080
   430     RECORD CONTAINS 450 CHARACTERS                               00004090
   431     BLOCK CONTAINS 0 RECORDS.                                    00004091
   432
*  433                                 COPY ELCCERT.
   434******************************************************************04/15/98
   435*                                                                *ELCCERT
   436*                            ELCCERT.                            *   LV002
   437*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
   438*                            VMOD=2.013                          *   CL**2
   439*                                                                *ELCCERT
   440*   FILE DESCRIPTION = CERTIFICATE MASTER                        *ELCCERT
   441*                                                                *ELCCERT
   442*   FILE TYPE = VSAM,KSDS                                        *ELCCERT
   443*   RECORD SIZE = 450  RECFORM = FIXED                           *ELCCERT
   444*                                                                *ELCCERT
   445*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *ELCCERT
   446*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *ELCCERT
   447*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *ELCCERT
   448*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *ELCCERT
   449*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *ELCCERT
   450*                                                                *ELCCERT
   451*   LOG = YES                                                    *ELCCERT
   452*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *ELCCERT
   453******************************************************************
   454*                   C H A N G E   L O G
   455*
   456* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   457*-----------------------------------------------------------------
   458*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   459* EFFECTIVE    NUMBER
   460*-----------------------------------------------------------------
   461* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
   462* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
   463* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
   464* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
   465* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
   466* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
   467* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
   468* 032612  CR2011110200001  PEMA  AHL CHANGES
   469* 090314  CR2014081300001  PEMA  LOAD CERTS INVOLVED IN THAO
   470******************************************************************
   471                                                                  ELCCERT
   472 01  CERTIFICATE-MASTER.                                          ELCCERT
   473     12  CM-RECORD-ID                      PIC XX.                ELCCERT
   474         88  VALID-CM-ID                      VALUE 'CM'.         ELCCERT
   475                                                                  ELCCERT
   476     12  CM-CONTROL-PRIMARY.                                      ELCCERT
   477         16  CM-COMPANY-CD                 PIC X.                 ELCCERT
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  10
* PEMCRM3.cbl (/apps/prod/cid1p/copy/ELCCERT)
   478         16  CM-CARRIER                    PIC X.                 ELCCERT
   479         16  CM-GROUPING.                                         ELCCERT
   480             20  CM-GROUPING-PREFIX        PIC X(3).              ELCCERT
   481             20  CM-GROUPING-PRIME         PIC X(3).              ELCCERT
   482         16  CM-STATE                      PIC XX.                ELCCERT
   483         16  CM-ACCOUNT.                                          ELCCERT
   484             20  CM-ACCOUNT-PREFIX         PIC X(4).              ELCCERT
   485             20  CM-ACCOUNT-PRIME          PIC X(6).              ELCCERT
   486         16  CM-CERT-EFF-DT                PIC XX.                ELCCERT
   487         16  CM-CERT-NO.                                          ELCCERT
   488             20  CM-CERT-PRIME             PIC X(10).             ELCCERT
   489             20  CM-CERT-SFX               PIC X.                 ELCCERT
   490                                                                  ELCCERT
   491     12  CM-CONTROL-BY-NAME.                                      ELCCERT
   492         16  CM-COMPANY-CD-A1              PIC X.                 ELCCERT
   493         16  CM-INSURED-LAST-NAME          PIC X(15).             ELCCERT
   494         16  CM-INSURED-INITIALS.                                 ELCCERT
   495             20  CM-INSURED-INITIAL1       PIC X.                 ELCCERT
   496             20  CM-INSURED-INITIAL2       PIC X.                 ELCCERT
   497                                                                  ELCCERT
   498     12  CM-CONTROL-BY-SSN.                                       ELCCERT
   499         16  CM-COMPANY-CD-A2              PIC X.                 ELCCERT
   500         16  CM-SOC-SEC-NO.                                       ELCCERT
   501             20  CM-SSN-STATE              PIC XX.                ELCCERT
   502             20  CM-SSN-ACCOUNT            PIC X(6).              ELCCERT
   503             20  CM-SSN-LN3.                                      ELCCERT
   504                 25  CM-INSURED-INITIALS-A2.                      ELCCERT
   505                     30 CM-INSURED-INITIAL1-A2   PIC X.           ELCCERT
   506                     30 CM-INSURED-INITIAL2-A2   PIC X.           ELCCERT
   507                 25 CM-PART-LAST-NAME-A2         PIC X.           ELCCERT
   508                                                                  ELCCERT
   509     12  CM-CONTROL-BY-CERT-NO.                                   ELCCERT
   510         16  CM-COMPANY-CD-A4              PIC X.                 ELCCERT
   511         16  CM-CERT-NO-A4                 PIC X(11).             ELCCERT
   512                                                                  ELCCERT
   513     12  CM-CONTROL-BY-MEMB.                                      ELCCERT
   514         16  CM-COMPANY-CD-A5              PIC X.                 ELCCERT
   515         16  CM-MEMBER-NO.                                        ELCCERT
   516             20  CM-MEMB-STATE             PIC XX.                ELCCERT
   517             20  CM-MEMB-ACCOUNT           PIC X(6).              ELCCERT
   518             20  CM-MEMB-LN4.                                     ELCCERT
   519                 25  CM-INSURED-INITIALS-A5.                      ELCCERT
   520                     30 CM-INSURED-INITIAL1-A5   PIC X.           ELCCERT
   521                     30 CM-INSURED-INITIAL2-A5   PIC X.           ELCCERT
   522                 25 CM-PART-LAST-NAME-A5         PIC XX.          ELCCERT
   523                                                                  ELCCERT
   524     12  CM-INSURED-PROFILE-DATA.                                 ELCCERT
   525         16  CM-INSURED-FIRST-NAME.                               ELCCERT
   526             20  CM-INSURED-1ST-INIT       PIC X.                 ELCCERT
   527             20  FILLER                    PIC X(9).              ELCCERT
   528         16  CM-INSURED-ISSUE-AGE          PIC 99.                ELCCERT
   529         16  CM-INSURED-SEX                PIC X.                 ELCCERT
   530             88  CM-SEX-MALE                  VALUE 'M'.          ELCCERT
   531             88  CM-SEX-FEMAL                 VALUE 'F'.          ELCCERT
   532         16  CM-INSURED-JOINT-AGE          PIC 99.                ELCCERT
   533         16  CM-JOINT-INSURED-NAME.                               ELCCERT
   534             20  CM-JT-LAST-NAME           PIC X(15).             ELCCERT
   535             20  CM-JT-FIRST-NAME.                                ELCCERT
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  11
* PEMCRM3.cbl (/apps/prod/cid1p/copy/ELCCERT)
   536                 24  CM-JT-1ST-INIT        PIC X.                 ELCCERT
   537                 24  FILLER                PIC X(9).              ELCCERT
   538             20  CM-JT-INITIAL             PIC X.                 ELCCERT
   539                                                                  ELCCERT
   540     12  CM-LIFE-DATA.                                            ELCCERT
   541         16  CM-LF-BENEFIT-CD              PIC XX.                ELCCERT
   542         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.  ELCCERT
   543         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.  ELCCERT
   544         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.  ELCCERT
   545         16  CM-LF-DEV-CODE                PIC XXX.               ELCCERT
   546         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.  ELCCERT
   547         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.  ELCCERT
   548         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.  ELCCERT
   549         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.  ELCCERT
   550         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.  ELCCERT
   551         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.  ELCCERT
   552         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.  ELCCERT
   553         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.  ELCCERT
   554         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.  ELCCERT
   555         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.  ELCCERT
   556         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.  ELCCERT
   557         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.  ELCCERT
   558         16  cm-temp-epiq                  pic xx.
   559             88  EPIQ-CLASS                  value 'EQ'.
   560*        16  FILLER                        PIC XX.                ELCCERT
   561                                                                  ELCCERT
   562     12  CM-AH-DATA.                                              ELCCERT
   563         16  CM-AH-BENEFIT-CD              PIC XX.                ELCCERT
   564         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.  ELCCERT
   565         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.  ELCCERT
   566         16  CM-AH-DEV-CODE                PIC XXX.               ELCCERT
   567         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.  ELCCERT
   568         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.  ELCCERT
   569         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.  ELCCERT
   570         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.  ELCCERT
   571         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.  ELCCERT
   572         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.  ELCCERT
   573         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.  ELCCERT
   574         16  CM-AH-PAID-THRU-DT            PIC XX.                ELCCERT
   575             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.    ELCCERT
   576         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.  ELCCERT
   577         16  CM-AH-POLICY-FEE              PIC S9(3)V99  COMP-3.  ELCCERT
   578         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.  ELCCERT
   579         16  FILLER                        PIC X.                 ELCCERT
   580                                                                  ELCCERT
   581     12  CM-LOAN-INFORMATION.                                     ELCCERT
   582         16  CM-LIVES                      PIC S9(7)     COMP-3.  ELCCERT
   583         16  CM-DDF-IU-RATE-UP REDEFINES CM-LIVES
   584                                           PIC S9(5)V99  COMP-3.
   585         16  CM-BILLED                     PIC S9(7)     COMP-3.  ELCCERT
   586         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.  ELCCERT
   587         16  CM-PAY-FREQUENCY              PIC S99.               ELCCERT
   588         16  CM-LOAN-TERM                  PIC S999      COMP-3.  ELCCERT
   589         16  CM-RATE-CLASS                 PIC XX.                ELCCERT
   590         16  CM-BENEFICIARY                PIC X(25).             ELCCERT
   591         16  CM-POLICY-FORM-NO             PIC X(12).             ELCCERT
   592         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.  ELCCERT
   593         16  CM-LAST-ADD-ON-DT             PIC XX.                ELCCERT
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  12
* PEMCRM3.cbl (/apps/prod/cid1p/copy/ELCCERT)
   594         16  CM-DEDUCTIBLE-AMOUNTS.                               ELCCERT
   595             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.  ELCCERT
   596             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.  ELCCERT
   597         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.    ELCCERT
   598             20  CM-RESIDENT-STATE         PIC XX.                ELCCERT
   599             20  CM-RATE-CODE              PIC X(4).              ELCCERT
   600             20  FILLER                    PIC XX.                ELCCERT
   601         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.              ELCCERT
   602             20  CM-LOAN-OFFICER           PIC X(5).              ELCCERT
   603             20  FILLER                    PIC XXX.               ELCCERT
   604         16  CM-CSR-CODE                   PIC XXX.               ELCCERT
   605         16  CM-UNDERWRITING-CODE          PIC X.                 ELCCERT
   606             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.          ELCCERT
   607         16  CM-POST-CARD-IND              PIC X.
   608         16  CM-NH-INTERFACE-SW            PIC X.
   609         16  CM-PREMIUM-TYPE               PIC X.                 ELCCERT
   610             88  CM-SING-PRM                  VALUE '1'.          ELCCERT
   611             88  CM-O-B-COVERAGE              VALUE '2'.          ELCCERT
   612             88  CM-OPEN-END                  VALUE '3'.          ELCCERT
   613         16  CM-IND-GRP-TYPE               PIC X.                 ELCCERT
   614             88  CM-INDIVIDUAL                VALUE 'I'.          ELCCERT
   615             88  CM-GROUP                     VALUE 'G'.          ELCCERT
   616         16  CM-SKIP-CODE                  PIC X.                 ELCCERT
   617             88  NO-MONTHS-SKIPPED            VALUE SPACE.        ELCCERT
   618             88  SKIP-JULY                    VALUE '1'.          ELCCERT
   619             88  SKIP-AUGUST                  VALUE '2'.          ELCCERT
   620             88  SKIP-SEPTEMBER               VALUE '3'.          ELCCERT
   621             88  SKIP-JULY-AUG                VALUE '4'.          ELCCERT
   622             88  SKIP-AUG-SEPT                VALUE '5'.          ELCCERT
   623             88  SKIP-JULY-AUG-SEPT           VALUE '6'.          ELCCERT
   624             88  SKIP-JUNE-JULY-AUG           VALUE '7'.          ELCCERT
   625             88  SKIP-JUNE                    VALUE '8'.          ELCCERT
   626             88  SKIP-JUNE-JULY               VALUE '9'.          ELCCERT
   627             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.          ELCCERT
   628             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.          ELCCERT
   629         16  CM-PAYMENT-MODE               PIC X.                 ELCCERT
   630             88  PAY-MONTHLY                  VALUE SPACE.        ELCCERT
   631             88  PAY-WEEKLY                   VALUE '1'.          ELCCERT
   632             88  PAY-SEMI-MONTHLY             VALUE '2'.          ELCCERT
   633             88  PAY-BI-WEEKLY                VALUE '3'.          ELCCERT
   634             88  PAY-SEMI-ANUALLY             VALUE '4'.          ELCCERT
   635         16  CM-LOAN-NUMBER                PIC X(8).              ELCCERT
   636         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.  ELCCERT
   637         16  CM-OLD-LOF                    PIC XXX.               ELCCERT
   638*        16  CM-LOAN-OFFICER               PIC XXX.               ELCCERT
   639         16  CM-REIN-TABLE                 PIC XXX.               ELCCERT
   640         16  CM-SPECIAL-REIN-CODE          PIC X.                 ELCCERT
   641         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.                ELCCERT
   642         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.                ELCCERT
   643         16  CM-LOAN-1ST-PMT-DT            PIC XX.                ELCCERT
   644                                                                  ELCCERT
   645     12  CM-STATUS-DATA.                                          ELCCERT
   646         16  CM-ENTRY-STATUS               PIC X.                 ELCCERT
   647         16  CM-ENTRY-DT                   PIC XX.                ELCCERT
   648                                                                  ELCCERT
   649         16  CM-LF-STATUS-AT-CANCEL        PIC X.                 ELCCERT
   650         16  CM-LF-CANCEL-DT               PIC XX.                ELCCERT
   651         16  CM-LF-CANCEL-EXIT-DT          PIC XX.                ELCCERT
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  13
* PEMCRM3.cbl (/apps/prod/cid1p/copy/ELCCERT)
   652                                                                  ELCCERT
   653         16  CM-LF-STATUS-AT-DEATH         PIC X.                 ELCCERT
   654         16  CM-LF-DEATH-DT                PIC XX.                ELCCERT
   655         16  CM-LF-DEATH-EXIT-DT           PIC XX.                ELCCERT
   656                                                                  ELCCERT
   657         16  CM-LF-CURRENT-STATUS          PIC X.                 ELCCERT
   658             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'   ELCCERT
   659                                                'M' '4' '5' '9'.  ELCCERT
   660             88  CM-LF-NORMAL-ENTRY           VALUE '1'.          ELCCERT
   661             88  CM-LF-POLICY-PENDING         VALUE '2'.          ELCCERT
   662             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.          ELCCERT
   663             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.          ELCCERT
   664             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.          ELCCERT
   665             88  CM-LF-POLICY-IS-CASH         VALUE 'C'.
   666             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.          ELCCERT
   667             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.          ELCCERT
   668             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.          ELCCERT
   669             88  CM-LF-CANCEL-APPLIED         VALUE '8'.          ELCCERT
   670             88  CM-LF-IS-REIN-ONLY           VALUE '9'.          ELCCERT
   671             88  CM-LF-DECLINED               VALUE 'D'.          ELCCERT
   672             88  CM-LF-VOIDED                 VALUE 'V'.          ELCCERT
   673                                                                  ELCCERT
   674         16  CM-AH-STATUS-AT-CANCEL        PIC X.                 ELCCERT
   675         16  CM-AH-CANCEL-DT               PIC XX.                ELCCERT
   676         16  CM-AH-CANCEL-EXIT-DT          PIC XX.                ELCCERT
   677                                                                  ELCCERT
   678         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.                 ELCCERT
   679         16  CM-AH-SETTLEMENT-DT           PIC XX.                ELCCERT
   680         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.                ELCCERT
   681                                                                  ELCCERT
   682         16  CM-AH-CURRENT-STATUS          PIC X.                 ELCCERT
   683             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'   ELCCERT
   684                                                'M' '4' '5' '9'.  ELCCERT
   685             88  CM-AH-NORMAL-ENTRY           VALUE '1'.          ELCCERT
   686             88  CM-AH-POLICY-PENDING         VALUE '2'.          ELCCERT
   687             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.          ELCCERT
   688             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.          ELCCERT
   689             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.          ELCCERT
   690             88  CM-AH-POLICY-IS-CASH         VALUE 'C'.
   691             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.          ELCCERT
   692             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.          ELCCERT
   693             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.          ELCCERT
   694             88  CM-AH-CANCEL-APPLIED         VALUE '8'.          ELCCERT
   695             88  CM-AH-IS-REIN-ONLY           VALUE '9'.          ELCCERT
   696             88  CM-AH-DECLINED               VALUE 'D'.          ELCCERT
   697             88  CM-AH-VOIDED                 VALUE 'V'.          ELCCERT
   698                                                                  ELCCERT
   699         16  CM-CLAIM-INTERFACE-SW         PIC X.                 ELCCERT
   700             88  NO-CLAIM-ATTACHED            VALUE SPACE.        ELCCERT
   701             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.          ELCCERT
   702             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.          ELCCERT
   703         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.    ELCCERT
   704                                                                  ELCCERT
   705         16  CM-ENTRY-BATCH                PIC X(6).              ELCCERT
   706         16  CM-LF-EXIT-BATCH              PIC X(6).              ELCCERT
   707         16  CM-AH-EXIT-BATCH              PIC X(6).              ELCCERT
   708         16  CM-LAST-MONTH-END             PIC XX.                ELCCERT
   709                                                                  ELCCERT
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  14
* PEMCRM3.cbl (/apps/prod/cid1p/copy/ELCCERT)
   710     12  CM-NOTE-SW                        PIC X.                 ELCCERT
   711         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.          ELCCERT
   712         88  CERT-NOTES-PRESENT               VALUE '1'.          ELCCERT
   713         88  BILLING-NOTES-PRESENT            VALUE '2'.          ELCCERT
   714         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.          ELCCERT
   715         88  CLAIM-NOTES-PRESENT              VALUE '4'.
   716         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
   717         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
   718         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
   719     12  CM-COMP-EXCP-SW                   PIC X.                 ELCCERT
   720         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.          ELCCERT
   721         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.          ELCCERT
   722     12  CM-INSURED-ADDRESS-SW             PIC X.                 ELCCERT
   723         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.          ELCCERT
   724         88  INSURED-ADDR-PRESENT             VALUE '1'.          ELCCERT
   725                                                                  ELCCERT
   726*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3. ELCCERT
   727     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
   728     12  FILLER                            PIC X.
   729                                                                  ELCCERT
   730*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3. ELCCERT
   731     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
   732     12  FILLER                            PIC X.
   733*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3. ELCCERT
   734     12  CM-NH-INT-ON-REFS                 PIC S9(7)V99   COMP-3. ELCCERT
   735                                                                  ELCCERT
   736     12  CM-CREDIT-INTERFACE-SW-1          PIC X.                 ELCCERT
   737         88  CERT-ADDED-BATCH                 VALUE ' '.          ELCCERT
   738         88  CERT-ADDED-ONLINE                VALUE '1'.          ELCCERT
   739         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.          ELCCERT
   740         88  CERT-PURGED-OFFLINE              VALUE '3'.          ELCCERT
   741         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.          ELCCERT
   742     12  CM-CREDIT-INTERFACE-SW-2          PIC X.                 ELCCERT
   743         88  CERT-AS-LOADED                   VALUE ' '.          ELCCERT
   744         88  CERT-CANCELLED-ONLINE            VALUE '1'.          ELCCERT
   745         88  CERT-CLAIM-ONLINE                VALUE '2'.          ELCCERT
   746         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.          ELCCERT
   747         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.          ELCCERT
   748         88  CERT-PEND-CANCEL-VOID            VALUE '5'.          ELCCERT
   749         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.          ELCCERT
   750         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.          ELCCERT
   751                                                                  ELCCERT
   752     12  CM-ACCOUNT-COMM-PCTS.                                    ELCCERT
   753         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.  ELCCERT
   754         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.  ELCCERT
   755                                                                  ELCCERT
   756     12  CM-USER-FIELD                     PIC X.                 ELCCERT
   757     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
   758     12  CM-CLP-STATE                      PIC XX.
   759     12  CM-LF-CLASS-CD REDEFINES CM-CLP-STATE PIC XX.
   760     12  CM-USER-RESERVED                  PIC XXX.
   761     12  FILLER REDEFINES CM-USER-RESERVED.
   762         16  CM-AH-CLASS-CD                PIC XX.
   763         16  F                             PIC X.
   764******************************************************************ELCCERT
   765
   766 WORKING-STORAGE SECTION.                                         00007200
   767 77  FILLER  PIC X(32) VALUE '********************************'.  00007300
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  15
* PEMCRM3.cbl
   768 77  FILLER  PIC X(32) VALUE '         WORKING-STORAGE        '.  00007400
   769 77  FILLER  PIC X(32) VALUE '********************************'.  00007500
   770
   771 01  WS-COMPARE-CERT-KEY.
   772     05  WS-CCK-CARRIER          PIC X.
   773     05  WS-CCK-GROUP            PIC X(6).
   774     05  WS-CCK-STATE            PIC XX.
   775     05  WS-CCK-ACCOUNT          PIC X(10).
   776     05  WS-CCK-EFF-DT           PIC 9(11) COMP-3.
   777     05  WS-CCK-CERT-NO          PIC X(11).
   778
   779 01  W-MISC.
   780     05  WS-WORK-DT              PIC 9(8)  VALUE ZEROS.
   781     05  WS-WORK-DTR REDEFINES WS-WORK-DT.
   782         10  WS-WORK-DT-CCYY      PIC X(4).
   783         10  WS-WORK-DT-MM        PIC XX.
   784         10  WS-WORK-DT-DD        PIC XX.
   785     05  WS-DATE-ALPH.
   786         10  FILLER             PIC XXX VALUE '000'.
   787         10  WS-WORK-CENT       PIC XX.
   788         10  WS-WORK-YR         PIC XX.
   789         10  WS-WORK-MO         PIC XX.
   790         10  WS-WORK-DA         PIC XX.
   791     05  WS-DATE-NUM REDEFINES WS-DATE-ALPH
   792                                PIC 9(11).
   793     05  WS-WORK-TERM           PIC 999 VALUE ZEROS.
   794     05  WS-BIN-EFF             PIC XX VALUE LOW-VALUES.
   795     05  WS-BIN-CNC             PIC XX VALUE LOW-VALUES.
   796
   797     05  ELCERT-IN-CNT          PIC 9(9) VALUE ZEROS.
   798     05  CERT-IN-CNT             PIC 9(9) VALUE ZEROS.
   799     05  CERT-UPD-CNT            PIC 9(9) VALUE ZEROS.
   800     05  CERT-MATCH-CNT          PIC 9(9) VALUE ZEROS.
   801     05  CERT-PC-Y-CNT           PIC 9(9) VALUE ZEROS.
   802     05  CERT-IN-PC-Y-CNT        PIC 9(9) VALUE ZEROS.
   803     05  CERT-OT-CNT             PIC 9(9) VALUE ZEROS.
   804     05  WS-EOF-SW              PIC X VALUE SPACES.
   805         88  END-OF-INPUT             VALUE 'Y'.
   806     05  WS-CRT-SW              PIC X VALUE ' '.
   807         88  END-OF-CERT              VALUE 'Y'.
   808     05  W-PREM-N               PIC 9(7)V99.                      00010840
   809     05  W-PREM-X      REDEFINES  W-PREM-N.                       00010841
   810         10  W-PREM-DOL.                                          00010842
   811             15  W-PREM-DOL2    PIC X(02).                        00010843
   812             15  W-PREM-DOL5    PIC X(05).                        00010844
   813         10  W-PREM-CEN         PIC X(02).                        00010845
   814     05  WS-ALPHA-AMT.
   815         10  WS-DOLLARS         PIC X(5).
   816         10  WS-CENTS           PIC XX.
   817     05  WS-NUM-AMT REDEFINES WS-ALPHA-AMT
   818                                PIC 9(5)V99.
   819
*  820                                 COPY ELCDATE.
   821******************************************************************06/11/98
   822*                                                                *ELCDATE
   823*                                                                *ELCDATE
   824*                            ELCDATE.                            *   LV023
   825*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL*16
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  16
* PEMCRM3.cbl (/apps/prod/cid1p/copy/ELCDATE)
   826*                            VMOD=2.003                           ELCDATE
   827*                                                                *ELCDATE
   828*                                                                *ELCDATE
   829*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *ELCDATE
   830*                 LENGTH = 200                                   *   CL*19
   831******************************************************************ELCDATE
   832                                                                  ELCDATE
   833 01  DATE-CONVERSION-DATA.                                        ELCDATE
   834     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.    CL*19
   835     12  DC-OPTION-CODE                PIC X.                        CL*15
   836         88  BIN-TO-GREG                VALUE ' '.                ELCDATE
   837         88  ELAPSED-BETWEEN-BIN        VALUE '1'.                ELCDATE
   838         88  EDIT-GREG-TO-BIN           VALUE '2'.                ELCDATE
   839         88  YMD-GREG-TO-BIN            VALUE '3'.                ELCDATE
   840         88  MDY-GREG-TO-BIN            VALUE '4'.                ELCDATE
   841         88  JULIAN-TO-BIN              VALUE '5'.                ELCDATE
   842         88  BIN-PLUS-ELAPSED           VALUE '6'.                ELCDATE
   843         88  FIND-CENTURY               VALUE '7'.                   CL*22
   844         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.                ELCDATE
   845         88  EDIT-GREG-TO-BIN-3         VALUE '9'.                ELCDATE
   846         88  YMD-GREG-TO-BIN-3          VALUE 'A'.                ELCDATE
   847         88  MDY-GREG-TO-BIN-3          VALUE 'B'.                ELCDATE
   848         88  JULIAN-TO-BIN-3            VALUE 'C'.                ELCDATE
   849         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.                ELCDATE
   850         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.                   CL*14
   851         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.                   CL*14
   852         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.                   CL*14
   853         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.         CL*14
   854         88  CHECK-LEAP-YEAR            VALUE 'H'.                   CL*14
   855         88  BIN-3-TO-GREG              VALUE 'I'.                   CL*14
   856         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.                   CL*14
   857         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.                   CL*14
   858         88  CYMD-GREG-TO-BIN           VALUE 'L'.                   CL*14
   859         88  MDCY-GREG-TO-BIN           VALUE 'M'.                   CL*14
   860         88  MDY-GREG-TO-JULIAN         VALUE 'N'.                   CL*14
   861         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.                   CL*14
   862         88  YMD-GREG-TO-JULIAN         VALUE 'P'.                   CL*14
   863         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.                   CL*14
   864         88  THREE-CHARACTER-BIN                                  ELCDATE
   865                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.       CL*14
   866         88  GREGORIAN-TO-BIN                                        CL**2
   867                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.    CL*14
   868         88  BIN-TO-GREGORIAN                                        CL**2
   869                  VALUES ' ' '1' 'I' '8' 'G'.                        CL*14
   870         88  JULIAN-TO-BINARY                                        CL**2
   871                  VALUES '5' 'C' 'E' 'F'.                            CL*14
   872     12  DC-ERROR-CODE                 PIC X.                        CL*15
   873         88  NO-CONVERSION-ERROR        VALUE ' '.                   CL**3
   874         88  DATE-CONVERSION-ERROR                                ELCDATE
   875                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.        CL*14
   876         88  DATE-IS-ZERO               VALUE '1'.                ELCDATE
   877         88  DATE-IS-NON-NUMERIC        VALUE '2'.                ELCDATE
   878         88  DATE-IS-INVALID            VALUE '3'.                ELCDATE
   879         88  DATE1-GREATER-DATE2        VALUE '4'.                ELCDATE
   880         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.                ELCDATE
   881         88  DATE-INVALID-OPTION        VALUE '9'.                ELCDATE
   882         88  INVALID-CENTURY            VALUE 'A'.                ELCDATE
   883         88  ONLY-CENTURY               VALUE 'B'.                ELCDATE
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  17
* PEMCRM3.cbl (/apps/prod/cid1p/copy/ELCDATE)
   884         88  ONLY-LEAP-YEAR             VALUE 'C'.                ELCDATE
   885         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.              CL**3
   886     12  DC-END-OF-MONTH               PIC X.                        CL*15
   887         88  CALCULATE-END-OF-MONTH     VALUE '1'.                ELCDATE
   888     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.         CL*15
   889         88  USE-NORMAL-PROCESS         VALUE ' '.                ELCDATE
   890         88  ADJUST-DOWN-100-YRS        VALUE '1'.                ELCDATE
   891         88  ADJUST-UP-100-YRS          VALUE '2'.                ELCDATE
   892     12  FILLER                        PIC X.                        CL*15
   893     12  DC-CONVERSION-DATES.                                        CL*15
   894         16  DC-BIN-DATE-1             PIC XX.                       CL*15
   895         16  DC-BIN-DATE-2             PIC XX.                       CL*15
   896         16  DC-GREG-DATE-1-EDIT       PIC X(08).                    CL*15
   897         16  DC-GREG-DATE-1-EDIT-R REDEFINES                         CL*15
   898                       DC-GREG-DATE-1-EDIT.                       ELCDATE
   899             20  DC-EDIT1-MONTH        PIC 99.                       CL*15
   900             20  SLASH1-1              PIC X.                        CL*15
   901             20  DC-EDIT1-DAY          PIC 99.                       CL*15
   902             20  SLASH1-2              PIC X.                        CL*15
   903             20  DC-EDIT1-YEAR         PIC 99.                       CL*15
   904         16  DC-GREG-DATE-2-EDIT       PIC X(08).                    CL*15
   905         16  DC-GREG-DATE-2-EDIT-R REDEFINES                         CL*15
   906                     DC-GREG-DATE-2-EDIT.                         ELCDATE
   907             20  DC-EDIT2-MONTH        PIC 99.                       CL*15
   908             20  SLASH2-1              PIC X.                        CL*15
   909             20  DC-EDIT2-DAY          PIC 99.                       CL*15
   910             20  SLASH2-2              PIC X.                        CL*15
   911             20  DC-EDIT2-YEAR         PIC 99.                       CL*15
   912         16  DC-GREG-DATE-1-YMD        PIC 9(06).                    CL*15
   913         16  DC-GREG-DATE-1-YMD-R  REDEFINES                         CL*15
   914                     DC-GREG-DATE-1-YMD.                          ELCDATE
   915             20  DC-YMD-YEAR           PIC 99.                       CL*15
   916             20  DC-YMD-MONTH          PIC 99.                       CL*15
   917             20  DC-YMD-DAY            PIC 99.                       CL*15
   918         16  DC-GREG-DATE-1-MDY        PIC 9(06).                    CL*15
   919         16  DC-GREG-DATE-1-MDY-R REDEFINES                          CL*15
   920                      DC-GREG-DATE-1-MDY.                         ELCDATE
   921             20  DC-MDY-MONTH          PIC 99.                       CL*15
   922             20  DC-MDY-DAY            PIC 99.                       CL*15
   923             20  DC-MDY-YEAR           PIC 99.                       CL*15
   924         16  DC-GREG-DATE-1-ALPHA.                                   CL*15
   925             20  DC-ALPHA-MONTH        PIC X(10).                    CL*15
   926             20  DC-ALPHA-DAY          PIC 99.                       CL*15
   927             20  FILLER                PIC XX.                       CL*15
   928             20  DC-ALPHA-CENTURY.                                   CL*15
   929                 24 DC-ALPHA-CEN-N     PIC 99.                       CL*15
   930             20  DC-ALPHA-YEAR         PIC 99.                       CL*15
   931         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.           CL*15
   932         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.           CL*15
   933         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.           CL*15
   934         16  DC-JULIAN-DATE            PIC 9(05).                    CL*15
   935         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE                CL*20
   936                                       PIC 9(05).                    CL*20
   937         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.                  CL*15
   938             20  DC-JULIAN-YEAR        PIC 99.                       CL*15
   939             20  DC-JULIAN-DAYS        PIC 999.                      CL*15
   940         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.       CL*15
   941         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.    CL*15
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  18
* PEMCRM3.cbl (/apps/prod/cid1p/copy/ELCDATE)
   942         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.    CL*15
   943     12  DATE-CONVERSION-VARIBLES.                                   CL*15
   944         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.            CL*15
   945         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.          CL*15
   946             20  FILLER                PIC 9(3).                     CL*15
   947             20  HOLD-CEN-1-CCYY.                                    CL*15
   948                 24  HOLD-CEN-1-CC     PIC 99.                       CL*17
   949                 24  HOLD-CEN-1-YY     PIC 99.                       CL*17
   950             20  HOLD-CEN-1-MO         PIC 99.                       CL*17
   951             20  HOLD-CEN-1-DA         PIC 99.                       CL*17
   952         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.            CL*15
   953             20  HOLD-CEN-1-R-MO       PIC 99.                       CL*17
   954             20  HOLD-CEN-1-R-DA       PIC 99.                       CL*17
   955             20  HOLD-CEN-1-R-CCYY.                                  CL*15
   956                 24  HOLD-CEN-1-R-CC   PIC 99.                       CL*17
   957                 24  HOLD-CEN-1-R-YY   PIC 99.                       CL*17
   958             20  FILLER                PIC 9(3).                     CL*15
   959         16  HOLD-CENTURY-1-X.                                       CL*15
   960             20  FILLER                PIC X(3)  VALUE SPACES.       CL*15
   961             20  HOLD-CEN-1-X-CCYY.                                  CL*15
   962                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.          CL*17
   963                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.          CL*17
   964             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.          CL*17
   965             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.          CL*17
   966         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.          CL*15
   967             20  HOLD-CEN-1-R-X-MO     PIC XX.                       CL*17
   968             20  HOLD-CEN-1-R-X-DA     PIC XX.                       CL*17
   969             20  HOLD-CEN-1-R-X-CCYY.                                CL*15
   970                 24  HOLD-CEN-1-R-X-CC PIC XX.                       CL*17
   971                 24  HOLD-CEN-1-R-X-YY PIC XX.                       CL*17
   972             20  FILLER                PIC XXX.                      CL*23
   973         16  DC-BIN-DATE-EXPAND-1      PIC XXX.                      CL*15
   974         16  DC-BIN-DATE-EXPAND-2      PIC XXX.                      CL*15
   975         16  DC-JULIAN-DATE-1          PIC 9(07).                    CL*15
   976         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.          CL*15
   977             20  DC-JULIAN-1-CCYY.                                   CL*15
   978                 24  DC-JULIAN-1-CC    PIC 99.                       CL*15
   979                 24  DC-JULIAN-1-YR    PIC 99.                       CL*15
   980             20  DC-JULIAN-DA-1        PIC 999.                      CL*15
   981         16  DC-JULIAN-DATE-2          PIC 9(07).                    CL*15
   982         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.          CL*15
   983             20  DC-JULIAN-2-CCYY.                                   CL*15
   984                 24  DC-JULIAN-2-CC    PIC 99.                       CL*15
   985                 24  DC-JULIAN-2-YR    PIC 99.                       CL*15
   986             20  DC-JULIAN-DA-2        PIC 999.                      CL*15
   987         16  DC-GREG-DATE-A-EDIT.                                    CL*15
   988             20  DC-EDITA-MONTH        PIC 99.                       CL*15
   989             20  SLASHA-1              PIC X VALUE '/'.              CL*15
   990             20  DC-EDITA-DAY          PIC 99.                       CL*15
   991             20  SLASHA-2              PIC X VALUE '/'.              CL*15
   992             20  DC-EDITA-CCYY.                                      CL*15
   993                 24  DC-EDITA-CENT     PIC 99.                       CL*15
   994                 24  DC-EDITA-YEAR     PIC 99.                       CL*15
   995         16  DC-GREG-DATE-B-EDIT.                                    CL*15
   996             20  DC-EDITB-MONTH        PIC 99.                       CL*15
   997             20  SLASHB-1              PIC X VALUE '/'.              CL*15
   998             20  DC-EDITB-DAY          PIC 99.                       CL*15
   999             20  SLASHB-2              PIC X VALUE '/'.              CL*15
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  19
* PEMCRM3.cbl (/apps/prod/cid1p/copy/ELCDATE)
  1000             20  DC-EDITB-CCYY.                                      CL*15
  1001                 24  DC-EDITB-CENT     PIC 99.                       CL*15
  1002                 24  DC-EDITB-YEAR     PIC 99.                       CL*15
  1003         16  DC-GREG-DATE-CYMD         PIC 9(08).                    CL*15
  1004         16  DC-GREG-DATE-CYMD-R REDEFINES                           CL*15
  1005                              DC-GREG-DATE-CYMD.                  ELCDATE
  1006             20  DC-CYMD-CEN           PIC 99.                       CL*15
  1007             20  DC-CYMD-YEAR          PIC 99.                       CL*15
  1008             20  DC-CYMD-MONTH         PIC 99.                       CL*15
  1009             20  DC-CYMD-DAY           PIC 99.                       CL*15
  1010         16  DC-GREG-DATE-MDCY         PIC 9(08).                    CL*15
  1011         16  DC-GREG-DATE-MDCY-R REDEFINES                           CL*15
  1012                              DC-GREG-DATE-MDCY.                  ELCDATE
  1013             20  DC-MDCY-MONTH         PIC 99.                       CL*15
  1014             20  DC-MDCY-DAY           PIC 99.                       CL*15
  1015             20  DC-MDCY-CEN           PIC 99.                       CL*15
  1016             20  DC-MDCY-YEAR          PIC 99.                       CL*15
  1017    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.      ELCDATE
  1018        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.        ELCDATE
  1019    12  DC-EL310-DATE                  PIC X(21).                    CL*26
  1020    12  FILLER                         PIC X(28).                    CL*26
  1021
  1022 PROCEDURE DIVISION.
  1023
  1024     OPEN INPUT ELCERT-IN CERT-IN
  1025
  1026     OPEN OUTPUT CERT-OUT
  1027
  1028     PERFORM 0010-READ-ELCERT    THRU 0010-EXIT
  1029     PERFORM 0015-READ-CERT      THRU 0015-EXIT
  1030
  1031     PERFORM 0020-PROCESS THRU 0020-EXIT UNTIL
  1032        (END-OF-INPUT)
  1033        AND (END-OF-CERT)
  1034
  1035     CLOSE   ELCERT-IN   CERT-IN  CERT-OUT
  1036
  1037     DISPLAY ' CERT RECS READ       ' CERT-IN-CNT
  1038     DISPLAY ' ELCERT  RECS READ    ' ELCERT-IN-CNT
  1039     DISPLAY ' CERT RECS OUT        ' CERT-OT-CNT
  1040     DISPLAY ' CERT RECS UPDATED    ' CERT-UPD-CNT
  1041     DISPLAY ' CERT RECS MATCHED    ' CERT-MATCH-CNT
  1042     DISPLAY ' CERT IN RECS WITH Y  ' CERT-IN-PC-Y-CNT
  1043     DISPLAY ' CERT OUT RECS WITH Y ' CERT-PC-Y-CNT
  1044
  1045     GOBACK
  1046
  1047     .
  1048 0010-READ-ELCERT.
  1049
  1050     READ ELCERT-IN AT END
  1051        SET END-OF-INPUT         TO TRUE
  1052        MOVE HIGH-VALUES         TO WS-COMPARE-CERT-KEY
  1053     END-READ
  1054
  1055     IF NOT END-OF-INPUT
  1056        IF CM-COMPANY-CD > X'04'
  1057           SET END-OF-INPUT      TO TRUE
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  20
* PEMCRM3.cbl
  1058           MOVE HIGH-VALUES      TO WS-COMPARE-CERT-KEY
  1059        END-IF
  1060     END-IF
  1061
  1062     IF NOT END-OF-INPUT
  1063        MOVE CM-CONTROL-PRIMARY (2:19)
  1064                                 TO WS-COMPARE-CERT-KEY
  1065        MOVE CM-CERT-EFF-DT      TO DC-BIN-DATE-1
  1066        MOVE ' '                 TO DC-OPTION-CODE
  1067        PERFORM 8510-DATE-CONVERSION
  1068                                 THRU 8590-EXIT
  1069        IF NO-CONVERSION-ERROR
  1070           MOVE DC-GREG-DATE-CYMD
  1071                                 TO WS-CCK-EFF-DT
  1072        ELSE
  1073           DISPLAY ' ERROR - EFF DT CONVERT ' CM-CERT-NO
  1074           MOVE ZEROS            TO WS-CCK-EFF-DT
  1075        END-IF
  1076        MOVE CM-CERT-NO          TO WS-CCK-CERT-NO
  1077        ADD  1                   TO ELCERT-IN-CNT
  1078     END-IF
  1079
  1080     .
  1081 0010-EXIT.
  1082     EXIT.
  1083
  1084 0015-READ-CERT.
  1085
  1086     READ CERT-IN AT END
  1087        SET END-OF-CERT          TO TRUE
  1088        MOVE HIGH-VALUES         TO CR-FULL-CONTROL
  1089     END-READ
  1090
  1091     IF NOT END-OF-CERT
  1092        ADD  1                   TO CERT-IN-CNT
  1093     END-IF
  1094
  1095     IF NOT END-OF-CERT
  1096        IF CR-POST-CARD-IND = 'Y'
  1097           ADD 1                 TO CERT-IN-PC-Y-CNT
  1098        END-IF
  1099     END-IF
  1100
  1101     .
  1102 0015-EXIT.
  1103     EXIT.
  1104
  1105 0020-PROCESS.
  1106
  1107*    DISPLAY ' EXT KEY = ' EXT-KEY
  1108*    DISPLAY 'CERT KEY = ' CERT-KEY
  1109
  1110     IF CR-FULL-CONTROL < WS-COMPARE-CERT-KEY
  1111        PERFORM 0040-WRITE-CERT  THRU 0040-EXIT
  1112        PERFORM 0015-READ-CERT   THRU 0015-EXIT
  1113     ELSE
  1114        IF CR-FULL-CONTROL > WS-COMPARE-CERT-KEY
  1115*          DISPLAY ' ERROR - NO MATCHING CERT ' WS-CCK-CARRIER
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  21
* PEMCRM3.cbl
  1116*          ' ' WS-CCK-STATE ' ' WS-CCK-ACCOUNT ' ' WS-CCK-EFF-DT
  1117*          ' ' WS-CCK-CERT-NO
  1118*          DISPLAY ' FULL CONTROL ' CR-ACCT-CONTROL ' '
  1119*            CR-DT ' ' CR-CERT-NO
  1120           PERFORM 0010-READ-ELCERT
  1121                                 THRU 0010-EXIT
  1122        ELSE
  1123           PERFORM 0030-MATCHED  THRU 0030-EXIT
  1124           PERFORM 0040-WRITE-CERT
  1125                                 THRU 0040-EXIT
  1126           PERFORM 0010-READ-ELCERT
  1127                                 THRU 0010-EXIT
  1128           PERFORM 0015-READ-CERT
  1129                                 THRU 0015-EXIT
  1130        END-IF
  1131     END-IF
  1132
  1133     .
  1134 0020-EXIT.
  1135      EXIT.
  1136
  1137 0030-MATCHED.
  1138
  1139     ADD 1                       TO CERT-MATCH-CNT
  1140
  1141     IF CR-POST-CARD-IND = 'Y'
  1142        CONTINUE
  1143     ELSE
  1144        IF CM-POST-CARD-IND = 'Y' OR 'N'
  1145           ADD 1                 TO CERT-UPD-CNT
  1146           MOVE CM-POST-CARD-IND TO CR-POST-CARD-IND
  1147        ELSE
  1148           MOVE SPACES           TO CR-POST-CARD-IND
  1149        END-IF
  1150     END-IF
  1151
  1152*    INSPECT EXT-TOT-FEE REPLACING ALL ' ' BY ZEROS
  1153*    INSPECT EXT-LF-FEE  REPLACING ALL ' ' BY ZEROS
  1154*    INSPECT EXT-AH-FEE  REPLACING ALL ' ' BY ZEROS
  1155
  1156*    MOVE EXT-TOT-FEE (1:5)      TO WS-DOLLARS
  1157*    MOVE EXT-TOT-FEE (7:2)      TO WS-CENTS
  1158*    MOVE WS-NUM-AMT             TO CR-MOB-NET-TOT-FEES
  1159
  1160*    MOVE EXT-LF-FEE (1:5)       TO WS-DOLLARS
  1161*    MOVE EXT-LF-FEE (7:2)       TO WS-CENTS
  1162*    MOVE WS-NUM-AMT             TO CR-LFPRM
  1163
  1164*    MOVE EXT-AH-FEE (1:5)       TO WS-DOLLARS
  1165*    MOVE EXT-AH-FEE (7:2)       TO WS-CENTS
  1166*    MOVE WS-NUM-AMT             TO CR-AHPRM
  1167
  1168     .
  1169 0030-EXIT.                                                       00119300
  1170      EXIT.                                                       00119400
  1171
  1172 0040-WRITE-CERT.
  1173
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  22
* PEMCRM3.cbl
  1174     IF CR-POST-CARD-IND NOT = 'Y' AND 'N' AND ' '
  1175        MOVE SPACES              TO CR-POST-CARD-IND
  1176     END-IF
  1177
  1178     IF CR-POST-CARD-IND = 'Y'
  1179        ADD 1                    TO CERT-PC-Y-CNT
  1180     END-IF
  1181
  1182     WRITE CERT-OUT-RECORD       FROM CERTIFICATE-RECORD
  1183     ADD 1                       TO CERT-OT-CNT
  1184
  1185     .
  1186 0040-EXIT.
  1187     EXIT.
  1188
  1189 8510-DATE-CONVERSION.
  1190
  1191     CALL 'ELDATCX' USING DATE-CONVERSION-DATA
  1192
  1193     .
  1194 8590-EXIT.
  1195     EXIT.
  1196
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:        4820     Code:        1295
