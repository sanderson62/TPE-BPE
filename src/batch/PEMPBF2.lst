* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   1
* PEMPBF2.cbl
* Options: int("PEMPBF2.int") anim csi verbose NOBOUND PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("PEMPBF2.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"ebmlsfile" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" NOCHECKDIV NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"32" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"PEMPBF2.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"PEMPBF2.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR NOSTICKY-LINKAGE
*          NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"2" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2 PROGRAM-ID. PEMPBF2.
     3 AUTHOR.     PABLO.
     4 DATE-COMPILED. 06-Oct-15 17:19.
     6 ENVIRONMENT DIVISION.
     7 INPUT-OUTPUT SECTION.
     8 FILE-CONTROL.
     9     SELECT ERPNDB           ASSIGN TO ERPNDB
    10                             ORGANIZATION IS INDEXED
    11                             ACCESS IS DYNAMIC
    12                             RECORD KEY IS PB-CONTROL-PRIMARY
    13                             FILE STATUS IS ERPNDB-FILE-STATUS.
    14
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   2
* PEMPBF2.cbl
    15 DATA DIVISION.
    16 FILE SECTION.
    17
    18 FD  ERPNDB.
    19
*   20                                 COPY ERCPNDB.
    21******************************************************************
    22*                                                                *
    23*                                                                *
    24*                            ERCPNDB.                            *
    25*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
    26*                            VMOD=2.025                          *
    27*                                                                *
    28*   FILE DESCRIPTION = PENDING NEW BUSINESS (ISSUES AND CANCELS) *
    29*                                                                *
    30******************************************************************
    31*   NOTE: IF THIS FORMAT IS CHANGED, THE SORT RECORD IN THE      *
    32*         EL861 A/R SYSTEM MAY NEED TO BE CHANGED.               *
    33******************************************************************
    34*                                                                *
    35*                                                                *
    36*   FILE TYPE = VSAM,KSDS                                        *
    37*   RECORD SIZE = 585  RECFORM = FIXED                           *
    38*                                                                *
    39*   BASE CLUSTER = ERPNDB                         RKP=2,LEN=11   *
    40*       ALTERNATE PATH1 = ERPNDB2  (BY CAR GRP STATE ACCOUNT     *
    41*                                  EFF-DT CERT CHG-SEQ REC-TYPE) *
    42*                                                 RKP=13,LEN=36  *
    43*       ALTERNATE PATH2 = ERPNDB3  (BY CO, ORIGINAL BATCH, SEQ.  *
    44*                                      AND CHG-SEQ.)             *
    45*                                                RKP=49,LEN=11   *
    46*       ALTERNATE PATH3 = ERPNDB4  (BY CO, CSR-ID, BATCH, SEQ.   *
    47*                                      AND CHG-SEQ.)             *
    48*                                                RKP=60,LEN=15   *
    49*                                                                *
    50*   LOG = NO                                                     *
    51*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
    52******************************************************************
    53******************************************************************
    54*                   C H A N G E   L O G
    55*
    56* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    57*-----------------------------------------------------------------
    58*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    59* EFFECTIVE    NUMBER
    60*-----------------------------------------------------------------
    61* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
    62* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
    63* 011904                   PEMA  ADD TOTAL FEE PROCESSING
    64* 040504    2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
    65* 020305    2005020000000  PEMA  ADD CLP STATE TO PNDB RECORD
    66* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
    67* 032306                   PEMA  ADD BOW LOAN NUMBER
    68* 081606    2006080800002  PEMA  ADD VIN, ISSUES ONLY
    69* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
    70* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
    71* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
    72* 032109    2009021700002  PEMA  ADD CRED BENE TO PNDB REC
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   3
* PEMPBF2.cbl (/apps/prod/cid1p/copy/ERCPNDB)
    73* 072209  CR2008101500003  AJRA  ADD BORROWER FIRST NAME TO ENDORSEMENT
    74* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
    75* 071211  CR2010012700001  PEMA  ADD SPP DEALER DIRECT
    76* 073114  CR2014012300001  PEMA  ADD CU CARRIER 7 PROCESSING
    77******************************************************************
    78
    79 01  PENDING-BUSINESS.
    80     12  PB-RECORD-ID                     PIC XX.
    81         88  VALID-PB-ID                        VALUE 'PB'.
    82
    83     12  PB-CONTROL-PRIMARY.
    84         16  PB-COMPANY-CD                PIC X.
    85         16  PB-ENTRY-BATCH               PIC X(6).
    86         16  PB-BATCH-SEQ-NO              PIC S9(4)     COMP.
    87         16  PB-BATCH-CHG-SEQ-NO          PIC S9(4)     COMP.
    88
    89     12  PB-CONTROL-BY-ACCOUNT.
    90         16  PB-COMPANY-CD-A1             PIC X.
    91         16  PB-CARRIER                   PIC X.
    92         16  PB-GROUPING.
    93             20  PB-GROUPING-PREFIX       PIC XXX.
    94             20  PB-GROUPING-PRIME        PIC XXX.
    95         16  PB-STATE                     PIC XX.
    96         16  PB-ACCOUNT.
    97             20  PB-ACCOUNT-PREFIX        PIC X(4).
    98             20  PB-ACCOUNT-PRIME         PIC X(6).
    99         16  PB-CERT-EFF-DT               PIC XX.
   100         16  PB-CERT-NO.
   101             20  PB-CERT-PRIME            PIC X(10).
   102             20  PB-CERT-SFX              PIC X.
   103         16  PB-ALT-CHG-SEQ-NO            PIC S9(4)     COMP.
   104
   105         16  PB-RECORD-TYPE               PIC X.
   106             88  PB-MAILING-DATA                VALUE '0'.
   107             88  PB-ISSUE                       VALUE '1'.
   108             88  PB-CANCELLATION                VALUE '2'.
   109             88  PB-BATCH-TRAILER               VALUE '9'.
   110
   111     12  PB-CONTROL-BY-ORIG-BATCH.
   112         16  PB-ORIGINAL-COMPANY-CD       PIC X.
   113         16  PB-ORIGINAL-ENTRY-BATCH      PIC X(6).
   114         16  PB-ORIGINAL-SEQ-NO           PIC S9(4)     COMP.
   115         16  PB-ORIGINAL-CHG-SEQ-NO       PIC S9(4)     COMP.
   116
   117     12  PB-CONTROL-BY-CSR.
   118         16  PB-CSR-COMPANY-CD            PIC X.
   119         16  PB-CSR-ID                    PIC X(4).
   120         16  PB-CSR-ENTRY-BATCH           PIC X(6).
   121         16  PB-CSR-BATCH-SEQ-NO          PIC S9(4)     COMP.
   122         16  PB-CSR-BATCH-CHG-SEQ-NO      PIC S9(4)     COMP.
   123******************************************************************
   124*    MAILING DATA IS PROCESSED IN ONLY PRGS. EL512 & EL513       *
   125******************************************************************
   126
   127     12  PB-LAST-MAINT-DT                 PIC XX.
   128     12  PB-LAST-MAINT-BY                 PIC X(4).
   129     12  PB-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.
   130
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   4
* PEMPBF2.cbl (/apps/prod/cid1p/copy/ERCPNDB)
   131     12  PB-RECORD-BODY                   PIC X(375).
   132
   133     12  PB-ISSUE-RECORD   REDEFINES PB-RECORD-BODY.
   134         16  PB-CERT-ORIGIN               PIC X.
   135             88  CLASIC-CREATED-CERT         VALUE '1'.
   136         16  PB-I-NAME.
   137             20  PB-I-INSURED-LAST-NAME   PIC X(15).
   138             20  PB-I-INSURED-FIRST-NAME.
   139                 24  PB-I-INSURED-1ST-INIT PIC X.
   140                 24  FILLER                PIC X(9).
   141             20  PB-I-INSURED-MIDDLE-INIT PIC X.
   142         16  PB-I-AGE                     PIC S99   COMP-3.
   143         16  PB-I-JOINT-AGE               PIC S99   COMP-3.
   144         16  PB-I-BIRTHDAY                PIC XX.
   145         16  PB-I-INSURED-SEX             PIC X.
   146             88  PB-SEX-MALE     VALUE 'M'.
   147             88  PB-SEX-FEMALE   VALUE 'F'.
   148
   149         16  PB-I-LF-TERM                 PIC S999   COMP-3.
   150         16  PB-I-AH-TERM                 PIC S999   COMP-3.
   151         16  PB-I-LOAN-TERM               PIC S999   COMP-3.
   152         16  PB-I-PAY-FREQUENCY           PIC S99    COMP-3.
   153         16  PB-I-SKIP-CODE               PIC X.
   154             88  PB-NO-MONTHS-SKIPPED      VALUE ' ' '0'.
   155             88  PB-SKIP-JULY              VALUE '1'.
   156             88  PB-SKIP-AUGUST            VALUE '2'.
   157             88  PB-SKIP-SEPTEMBER         VALUE '3'.
   158             88  PB-SKIP-JULY-AUG          VALUE '4'.
   159             88  PB-SKIP-AUG-SEPT          VALUE '5'.
   160             88  PB-SKIP-JULY-AUG-SEPT     VALUE '6'.
   161             88  PB-SKIP-JUNE-JULY-AUG     VALUE '7'.
   162             88  PB-SKIP-JUNE              VALUE '8'.
   163             88  PB-SKIP-JUNE-JULY         VALUE '9'.
   164             88  PB-SKIP-AUG-SEPT-OCT      VALUE 'A'.
   165             88  PB-SKIP-BI-WKLY-3RD-PMT   VALUE 'X'.
   166         16  PB-I-TERM-TYPE               PIC X.
   167             88  PB-PAID-MONTHLY           VALUE ' ' 'M'.
   168             88  PB-PAID-WEEKLY            VALUE 'W'.
   169             88  PB-PAID-SEMI-MONTHLY      VALUE 'S'.
   170             88  PB-PAID-BI-WEEKLY         VALUE 'B'.
   171             88  PB-PAID-13-YEARLY         VALUE 'T'.
   172         16  PB-I-NO-OF-PAYMENTS          PIC S999   COMP-3.
   173         16  PB-I-POLICY-FORM-NO          PIC X(12).
   174         16  PB-I-DATA-ENTRY-SW           PIC X.
   175             88  PB-EFF-DT-PROCESSING      VALUE '1' ' '.
   176             88  PB-EXT-DAYS-PROCESSING    VALUE '2'.
   177             88  PB-EXPIRE-DT-PROCESSING   VALUE '3'.
   178             88  PB-1ST-PMT-DT-PROCESSING  VALUE '4'.
   179         16  PB-I-PAYMENT-AMOUNT          PIC S9(7)V99  COMP-3.
   180         16  PB-I-DCC-OVER-CHG-AMT        PIC S9(5)V99  COMP-3.
   181*        16  PB-I-MICROFILM-NO            PIC S9(9)      COMP-3.
   182         16  PB-I-AH-CLP                  PIC S9(5)V99 COMP-3.
   183         16  FILLER                       PIC X.
   184
   185         16  PB-I-LIFE-BENEFIT-CD         PIC XX.
   186             88  PB-VALID-LIFE               VALUE '01' THRU '89'.
   187             88  PB-INVALID-LIFE             VALUE '  ' '00'
   188                                                   '90' THRU '99'.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   5
* PEMPBF2.cbl (/apps/prod/cid1p/copy/ERCPNDB)
   189         16  PB-I-LF-BENEFIT-CD   REDEFINES PB-I-LIFE-BENEFIT-CD
   190                                          PIC XX.
   191         16  PB-I-LF-BENEFIT-AMT          PIC S9(9)V99   COMP-3.
   192         16  PB-I-AMOUNT-FINANCED REDEFINES
   193                  PB-I-LF-BENEFIT-AMT     PIC S9(9)V99   COMP-3.
   194         16  PB-I-LF-ALT-BENEFIT-AMT      PIC S9(9)V99   COMP-3.
   195         16  PB-I-UNPAID-CASH-PRICE REDEFINES
   196                  PB-I-LF-ALT-BENEFIT-AMT PIC S9(9)V99   COMP-3.
   197         16  PB-I-LF-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
   198         16  PB-I-LF-ALT-PREMIUM-AMT      PIC S9(7)V99   COMP-3.
   199         16  PB-I-CLP-AMOUNT REDEFINES
   200                  PB-I-LF-ALT-PREMIUM-AMT PIC S9(7)V99   COMP-3.
   201         16  PB-I-LF-CALC-FLAG            PIC X.
   202             88 PB-COMP-LF-PREM               VALUE '?'.
   203         16  PB-I-LF-PREM-CALC            PIC S9(7)V99   COMP-3.
   204         16  PB-I-LF-ALT-PREM-CALC        PIC S9(7)V99   COMP-3.
   205         16  PB-I-LF-RATE                 PIC S99V9(5)   COMP-3.
   206         16  PB-I-LF-ALT-RATE             PIC S99V9(5)   COMP-3.
   207         16  PB-I-LF-POLICY-FEE           PIC S9(3)V99   COMP-3.
   208         16  PB-I-LF-REI-RATE             PIC S99V9(5)   COMP-3.
   209         16  PB-I-LF-ALT-REI-RATE         PIC S99V9(5)   COMP-3.
   210         16  PB-I-LF-ABBR                 PIC XXX.
   211         16  PB-I-LF-INPUT-CD             PIC XX.
   212
   213         16  PB-I-AH-BENEFIT-CD           PIC XX.
   214             88  PB-VALID-AH                 VALUE '01' THRU '89'.
   215             88  PB-INVALID-AH               VALUE '  ' '00'
   216                                                   '90' THRU '99'.
   217         16  PB-I-AH-BENEFIT-AMT          PIC S9(7)V99   COMP-3.
   218         16  PB-I-AH-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
   219         16  PB-I-AH-CALC-FLAG            PIC X.
   220             88 PB-COMP-AH-PREM                  VALUE '?'.
   221         16  PB-I-AH-PREM-CALC            PIC S9(7)V99   COMP-3.
   222         16  PB-I-AH-RATE                 PIC S99V9(5)   COMP-3.
   223         16  PB-I-AH-POLICY-FEE           PIC S9(3)V99   COMP-3.
   224         16  PB-I-AH-REI-RATE             PIC S99V9(5)   COMP-3.
   225         16  PB-I-AH-RATE-TRM             PIC S999       COMP-3.
   226         16  PB-I-AH-ABBR                 PIC XXX.
   227         16  PB-I-AH-INPUT-CD             PIC XXX.
   228
   229         16  PB-I-SPECIAL-REIN-CODE       PIC X.
   230         16  PB-I-REIN-TABLE              PIC XXX.
   231         16  PB-I-BUSINESS-TYPE           PIC 99.
   232         16  PB-I-INDV-GRP-CD             PIC X.
   233         16  PB-I-MORT-CODE.
   234             20  PB-I-TABLE               PIC X.
   235             20  PB-I-INTEREST            PIC XX.
   236             20  PB-I-MORT-TYP            PIC X.
   237         16  PB-I-LF-CRIT-PER             PIC S9(3)      COMP-3.
   238         16  PB-I-AH-CRIT-PER             PIC S9(3)      COMP-3.
   239         16  PB-I-LF-CLP                  PIC S9(5)V99   COMP-3.
   240         16  PB-I-INDV-GRP-OVRD           PIC X.
   241         16  PB-I-RATE-CLASS-OVRD         PIC XX.
   242         16  PB-I-SIG-SW                  PIC X.
   243             88  PB-POLICY-SIGNED             VALUE 'Y'.
   244         16  PB-I-RATE-CLASS              PIC XX.
   245         16  PB-I-RATE-DEVIATION-LF       PIC XXX.
   246         16  PB-I-RATE-DEVIATION-AH       PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   6
* PEMPBF2.cbl (/apps/prod/cid1p/copy/ERCPNDB)
   247         16  PB-I-RATE-DEV-PCT-LF         PIC S9V9(6)    COMP-3.
   248         16  PB-I-RATE-DEV-PCT-AH         PIC S9V9(6)    COMP-3.
   249         16  PB-I-LIFE-COMMISSION         PIC SV9(5)     COMP-3.
   250         16  PB-I-JOINT-COMMISSION        PIC SV9(5)     COMP-3.
   251         16  PB-I-AH-COMMISSION           PIC SV9(5)     COMP-3.
   252         16  PB-I-BENEFIT-TYPE            PIC XXX.
   253         16  PB-I-OB-FLAG                 PIC X.
   254             88  PB-I-OB                      VALUE 'B'.
   255             88  PB-I-SUMMARY                 VALUE 'Z'.
   256         16  PB-I-ENTRY-STATUS            PIC X.
   257             88  PB-I-POLICY-IS-ACTIVE        VALUE '1' '3' '4'
   258                                              'M' '5' '9' '2'.
   259             88  PB-I-NORMAL-ENTRY            VALUE '1'.
   260             88  PB-I-POLICY-PENDING          VALUE '2'.
   261             88  PB-I-CONVERSION-ENTRY        VALUE '4'.
   262             88  PB-I-POLICY-IS-REISSUE       VALUE '5'.
   263             88  PB-I-POLICY-IS-CASH          VALUE 'C'.
   264             88  PB-I-POLICY-IS-MONTHLY       VALUE 'M'.
   265             88  PB-I-REIN-ONLY               VALUE '9'.
   266             88  PB-I-POLICY-IS-DECLINED      VALUE 'D'.
   267             88  PB-I-POLICY-IS-VOIDED        VALUE 'V'.
   268             88  PB-I-PREM-ACCTNG-ONLY        VALUE 'P'.
   269             88  PB-I-UNDERWRITE-POLICY       VALUE 'U'.
   270         16  PB-I-INT-CODE                PIC X.
   271             88  PB-ADD-ON-INTEREST           VALUE 'A'.
   272             88  PB-SIMPLE-INTEREST           VALUE 'S'.
   273         16  PB-I-LOAN-APR                PIC 9(3)V9(4)   COMP-3.
   274         16  PB-I-SOC-SEC-NO              PIC X(11).
   275         16  PB-I-MEMBER-NO               PIC X(12).
   276         16  PB-I-CURR-SEQ                PIC S9(4)       COMP.
   277*        16  PB-I-LOAN-OFFICER            PIC XXX.
   278         16  PB-I-OLD-LOF                 PIC XXX.
   279         16  PB-I-LF-EXPIRE-DT            PIC XX.
   280         16  PB-I-AH-EXPIRE-DT            PIC XX.
   281         16  PB-I-EXTENTION-DAYS          PIC S999        COMP-3.
   282         16  PB-I-TERM-IN-DAYS            PIC S9(5)       COMP-3.
   283         16  PB-I-LIFE-INDICATOR          PIC X.
   284             88  PB-I-JOINT-COVERAGE         VALUE 'J'.
   285         16  PB-I-LIVES                   PIC S9(7)       COMP-3.
   286         16  PB-I-DDF-IU-RATE-UP REDEFINES PB-I-LIVES
   287                                          PIC S9(5)V99    COMP-3.
   288         16  PB-I-MAIL-ADDRS-SW           PIC X.
   289             88 PB-I-MAIL-ADDRS-NOT-PRESENT  VALUE ' '.
   290             88 PB-I-MAIL-ADDRS-PRESENT      VALUE '1'.
   291         16  PB-I-1ST-PMT-DT              PIC XX.
   292         16  PB-I-JOINT-INSURED.
   293             20 PB-I-JOINT-LAST-NAME      PIC X(15).
   294             20 PB-I-JOINT-FIRST-NAME.
   295                24  PB-I-JOINT-FIRST-INIT PIC X.
   296                24  FILLER                PIC X(9).
   297             20 PB-I-JOINT-MIDDLE-INIT    PIC X.
   298*        16  PB-I-BENEFICIARY-NAME        PIC X(25).
   299         16  PB-I-BENEFICIARY-NAME.
   300             20  PB-I-BANK-NUMBER         PIC X(10).
   301             20  FILLER                   PIC X(15).
   302         16  PB-I-LAST-ADD-ON-DT          PIC XX.
   303         16  PB-I-REFERENCE               PIC X(12).
   304         16  FILLER REDEFINES PB-I-REFERENCE.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   7
* PEMPBF2.cbl (/apps/prod/cid1p/copy/ERCPNDB)
   305             20  PB-I-TOT-FEES            PIC S9(7)V99 COMP-3.
   306             20  PB-I-TOT-FEES-CALC       PIC S9(7)V99 COMP-3.
   307             20  PB-I-CLP-STATE           PIC XX.
   308         16  PB-I-UNDERWRITING-STATUS     PIC X.
   309             88  PB-I-POLICY-ACCEPTED         VALUE 'A' 'N'.
   310             88  PB-I-POLICY-DECLINED         VALUE 'D'.
   311             88  PB-I-NEEDS-UNDERWRITING      VALUE 'U'.
   312         16  PB-I-STATE-TAX               PIC S9(7)V99 COMP-3.
   313         16  PB-I-MUNI-TAX                PIC S9(7)V99 COMP-3.
   314         16  PB-I-RESIDENT-STATE          PIC XX.
   315         16  PB-I-RATE-CODE               PIC X(4).
   316         16  PB-I-NUM-BILLED              PIC S9(7)    COMP-3.
   317         16  PB-I-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
   318         16  PB-I-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
   319         16  PB-I-BANK-FEE                PIC S999V99  COMP-3.
   320         16  PB-I-BANK-NOCHRGB            PIC 99.
   321         16  PB-I-ADDL-CLP                PIC S9(5)V99 COMP-3.
   322         16  PB-I-JOINT-BIRTHDAY          PIC XX.
   323
   324     12  PB-CANCEL-RECORD   REDEFINES PB-RECORD-BODY.
   325         16  PB-C-LF-CANCEL-VOID-SW       PIC X.
   326             88  PB-C-LF-CANCEL-VOIDED        VALUE '1'.
   327         16  PB-C-CANCEL-ORIGIN           PIC X.
   328             88  PB-C-CLAIM-CREATED-CANCEL   VALUE '1'.
   329         16  PB-C-LF-CANCEL-DT            PIC XX.
   330         16  PB-C-LF-CANCEL-AMT           PIC S9(7)V99    COMP-3.
   331         16  PB-C-LF-CALC-REQ             PIC X.
   332             88 PB-COMP-LF-CANCEL            VALUE '?'.
   333         16  PB-C-LF-REF-CALC             PIC S9(7)V99    COMP-3.
   334         16  PB-C-LF-REM-TERM             PIC S9(3)       COMP-3.
   335         16  PB-C-AH-CANCEL-VOID-SW       PIC X.
   336             88  PB-C-AH-CANCEL-VOIDED        VALUE '1'.
   337         16  PB-C-AH-CANCEL-DT            PIC XX.
   338         16  PB-C-AH-CANCEL-AMT           PIC S9(7)V99    COMP-3.
   339         16  PB-C-AH-CALC-REQ             PIC X.
   340             88 PB-COMP-AH-CANCEL            VALUE '?'.
   341         16  PB-C-AH-REF-CALC             PIC S9(7)V99    COMP-3.
   342         16  PB-C-AH-REM-TERM             PIC S9(3)       COMP-3.
   343         16  PB-C-LAST-NAME               PIC X(15).
   344         16  PB-C-REFUND-SW               PIC X.
   345             88  PB-C-REFUND-CREATED          VALUE 'Y'.
   346             88  PB-C-REFUND-REQUESTED        VALUE 'R'.
   347         16  PB-C-LIVES                   PIC S9(3)       COMP-3.
   348         16  PB-C-PAYEE-CODE              PIC X(6).
   349         16  PB-C-LF-REFUND-OVERRIDE      PIC X.
   350         16  PB-C-AH-REFUND-OVERRIDE      PIC X.
   351         16  PB-C-LF-COMM-CHARGEBACK      PIC X.
   352         16  PB-C-AH-COMM-CHARGEBACK      PIC X.
   353         16  PB-C-REFERENCE               PIC X(12).
   354         16  PB-C-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
   355         16  PB-C-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
   356         16  PB-C-POST-CARD-IND           PIC X.
   357         16  PB-C-CANCEL-REASON           PIC X.
   358         16  PB-C-REF-INTERFACE-SW        PIC X.
   359         16  PB-C-LF-RFND-CLP             PIC S9(5)V99 COMP-3.
   360         16  PB-C-AH-RFND-CLP             PIC S9(5)V99 COMP-3.
   361         16  FILLER                       PIC X(01).
   362*        16  FILLER                       PIC X(18).
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   8
* PEMPBF2.cbl (/apps/prod/cid1p/copy/ERCPNDB)
   363         16  PB-C-POLICY-FORM-NO          PIC X(12).
   364*        16  PB-C-MICROFILM-NO            PIC S9(9)      COMP-3.
   365         16  PB-C-NH-INT-ON-REFS          PIC S9(7)V99   COMP-3.
   366         16  PB-CANCELED-CERT-DATA.
   367             20  PB-CI-INSURED-NAME.
   368                 24  PB-CI-LAST-NAME      PIC X(15).
   369                 24  PB-CI-INITIALS       PIC XX.
   370             20  PB-CI-INSURED-AGE        PIC S99         COMP-3.
   371             20  PB-CI-INSURED-SEX        PIC X.
   372             20  PB-CI-LF-TERM            PIC S999        COMP-3.
   373             20  PB-CI-LF-BENEFIT-CD      PIC XX.
   374             20  PB-CI-LF-BENEFIT-AMT     PIC S9(9)V99    COMP-3.
   375             20  PB-CI-LF-ALT-BENEFIT-AMT PIC S9(9)V99    COMP-3.
   376             20  PB-CI-LF-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
   377             20  PB-CI-LF-ALT-PREMIUM-AMT PIC S9(7)V99    COMP-3.
   378             20  PB-CI-AH-TERM            PIC S999        COMP-3.
   379             20  PB-CI-AH-BENEFIT-CD      PIC XX.
   380             20  PB-CI-AH-BENEFIT-AMT     PIC S9(7)V99    COMP-3.
   381             20  PB-CI-AH-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
   382             20  PB-CI-RATE-CLASS         PIC XX.
   383             20  PB-CI-RATE-DEV-LF        PIC XXX.
   384             20  PB-CI-RATE-DEV-AH        PIC XXX.
   385             20  PB-CI-RATE-DEV-PCT-LF    PIC S9V9(6)     COMP-3.
   386             20  PB-CI-RATE-DEV-PCT-AH    PIC S9V9(6)     COMP-3.
   387             20  PB-CI-LIFE-COMMISSION    PIC SV9(5)      COMP-3.
   388             20  PB-CI-AH-COMMISSION      PIC SV9(5)      COMP-3.
   389             20  PB-CI-LF-ABBR            PIC X(3).
   390             20  PB-CI-AH-ABBR            PIC X(3).
   391             20  PB-CI-OB-FLAG            PIC X.
   392                 88  PB-CI-OB                VALUE 'B'.
   393             20  PB-CI-LF-POLICY-STATUS   PIC X.
   394                 88  PB-CI-LF-POLICY-IS-ACTIVE       VALUE '1' '3'
   395                                           'M' '4' '5' '9' '2'.
   396                 88  PB-CI-LF-NORMAL-ENTRY           VALUE '1'.
   397                 88  PB-CI-LF-POLICY-PENDING         VALUE '2'.
   398                 88  PB-CI-LF-POLICY-IS-RESTORE      VALUE '3'.
   399                 88  PB-CI-LF-CONVERSION-ENTRY       VALUE '4'.
   400                 88  PB-CI-LF-POLICY-IS-REISSUE      VALUE '5'.
   401                 88  PB-CI-LF-POLICY-IS-CASH         VALUE 'C'.
   402                 88  PB-CI-LF-POLICY-IS-MONTHLY      VALUE 'M'.
   403                 88  PB-CI-LF-LUMP-SUM-DISAB         VALUE '6'.
   404                 88  PB-CI-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
   405                 88  PB-CI-LF-CANCEL-APPLIED         VALUE '8'.
   406                 88  PB-CI-LF-REIN-ONLY              VALUE '9'.
   407                 88  PB-CI-LF-POLICY-IS-DECLINED     VALUE 'D'.
   408                 88  PB-CI-LF-POLICY-IS-VOID         VALUE 'V'.
   409             20  PB-CI-AH-POLICY-STATUS   PIC X.
   410                 88  PB-CI-AH-POLICY-IS-ACTIVE       VALUE '1' '3'
   411                                           'M' '4' '5' '9' '2'.
   412                 88  PB-CI-AH-NORMAL-ENTRY           VALUE '1'.
   413                 88  PB-CI-AH-POLICY-PENDING         VALUE '2'.
   414                 88  PB-CI-AH-POLICY-IS-RESTORE      VALUE '3'.
   415                 88  PB-CI-AH-CONVERSION-ENTRY       VALUE '4'.
   416                 88  PB-CI-AH-POLICY-IS-REISSUE      VALUE '5'.
   417                 88  PB-CI-AH-POLICY-IS-CASH         VALUE 'C'.
   418                 88  PB-CI-AH-POLICY-IS-MONTHLY      VALUE 'M'.
   419                 88  PB-CI-AH-LUMP-SUM-DISAB         VALUE '6'.
   420                 88  PB-CI-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   9
* PEMPBF2.cbl (/apps/prod/cid1p/copy/ERCPNDB)
   421                 88  PB-CI-AH-CANCEL-APPLIED         VALUE '8'.
   422                 88  PB-CI-AH-REIN-ONLY              VALUE '9'.
   423                 88  PB-CI-AH-POLICY-IS-DECLINED     VALUE 'D'.
   424                 88  PB-CI-AH-POLICY-IS-VOID         VALUE 'V'.
   425             20  PB-CI-PAY-FREQUENCY      PIC 99.
   426             20  PB-CI-LOAN-APR           PIC 9(3)V9(4)   COMP-3.
   427             20  PB-CI-SOC-SEC-NO         PIC X(11).
   428             20  PB-CI-MEMBER-NO          PIC X(12).
   429             20  PB-CI-INT-CODE           PIC X.
   430                 88  PB-CI-ADD-ON                  VALUE 'A'.
   431                 88  PB-CI-SIMPLE                  VALUE 'S'.
   432             20  PB-CI-LOAN-TERM          PIC S999        COMP-3.
   433             20  PB-CI-LOAN-1ST-PMT-DT    PIC X(2).
   434             20  PB-CI-COMP-EXCP-SW       PIC X.
   435                 88  PB-CI-NO-COMP-EXCP            VALUE ' '.
   436                 88  PB-CI-CERT-HAS-ERCOMM-ENTRY   VALUE '1'.
   437             20  PB-CI-ENTRY-STATUS       PIC X.
   438             20  PB-CI-CURR-SEQ           PIC S9(4)       COMP.
   439             20  PB-CI-AH-PAID-THRU-DT    PIC XX.
   440             20  PB-CI-AH-SETTLEMENT-DT   PIC XX.
   441             20  PB-CI-DEATH-DT           PIC XX.
   442             20  PB-CI-LF-PRIOR-CANCEL-DT PIC XX.
   443             20  PB-CI-AH-PRIOR-CANCEL-DT PIC XX.
   444             20  PB-CI-AH-CANCEL-AMT      PIC S9(7)V99    COMP-3.
   445             20  PB-CI-LF-CANCEL-AMT      PIC S9(7)V99    COMP-3.
   446             20  PB-CI-CREDIT-INTERFACE-SW-1 PIC X.
   447             20  PB-CI-CREDIT-INTERFACE-SW-2 PIC X.
   448             20  PB-CI-ENTRY-DT              PIC XX.
   449             20  PB-CI-ENTRY-BATCH           PIC X(6).
   450             20  PB-CI-LF-EXPIRE-DT          PIC XX.
   451             20  PB-CI-AH-EXPIRE-DT          PIC XX.
   452             20  PB-CI-EXTENTION-DAYS        PIC S999     COMP-3.
   453             20  PB-CI-TERM-IN-DAYS          PIC S9(5)    COMP-3.
   454             20  PB-CI-OLD-LOF               PIC XXX.
   455*            20  PB-CI-LOAN-OFFICER          PIC XXX.
   456             20  PB-CI-LIVES                 PIC S9(3)    COMP-3.
   457             20  PB-CI-LF-CRIT-PER           PIC S9(3)    COMP-3.
   458             20  PB-CI-AH-CRIT-PER           PIC S9(3)    COMP-3.
   459             20  PB-CI-INDV-GRP-CD           PIC X.
   460             20  PB-CI-BENEFICIARY-NAME.
   461                 24  PB-CI-BANK-NUMBER       PIC X(10).
   462                 24  FILLER                  PIC X(15).
   463             20  PB-CI-NOTE-SW               PIC X.
   464             20  PB-CI-CANCEL-FEE            PIC S9(3)V99 COMP-3.
   465             20  PB-CI-MUNI-TAX              PIC S9(7)V99 COMP-3.
   466             20  PB-CI-STATE-TAX             PIC S9(7)V99 COMP-3.
   467             20  PB-CI-ADDL-CLP              PIC S9(5)V99 COMP-3.
   468             20  PB-CI-LOAN-OFFICER          PIC X(5).
   469             20  PB-CI-BOW-LOAN-NUMBER       PIC X(14).
   470             20  PB-CI-FIRST-NAME            PIC X(10).
   471             20  PB-CI-DDF-IU-RATE-UP        PIC S9(5)V99 COMP-3.
   472
   473         16  FILLER                       PIC X(13).
   474*032306  16  FILLER                       PIC X(27).
   475*        16  FILLER                       PIC X(46).
   476
   477     12  PB-MAIL-RECORD    REDEFINES PB-RECORD-BODY.
   478         16  FILLER                       PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  10
* PEMPBF2.cbl (/apps/prod/cid1p/copy/ERCPNDB)
   479         16  PB-M-INSURED-LAST-NAME       PIC X(15).
   480         16  PB-M-INSURED-FIRST-NAME      PIC X(10).
   481         16  PB-M-INSURED-MID-INIT        PIC X.
   482         16  PB-M-INSURED-AGE             PIC 99.
   483         16  PB-M-INSURED-BIRTHDAY        PIC XX.
   484         16  PB-M-INSURED-SEX             PIC X.
   485         16  PB-M-INSURED-SOC-SEC-NO      PIC X(11).
   486         16  PB-M-INSURED-ADDRESS-1       PIC X(30).
   487         16  PB-M-INSURED-ADDRESS-2       PIC X(30).
   488         16  PB-M-INSURED-CITY-STATE.
   489             20  PB-M-INSURED-CITY        PIC X(28).
   490             20  PB-M-INSURED-STATE       PIC XX.
   491         16  PB-M-INSURED-ZIP-CODE.
   492             20  PB-M-INSURED-ZIP-PRIME.
   493                 24  PB-M-INSURED-ZIP-1   PIC X.
   494                     88  PB-M-CANADIAN-POST-CODE
   495                                             VALUE 'A' THRU 'Z'.
   496                 24  FILLER               PIC X(4).
   497             20  PB-M-INSURED-ZIP-PLUS4   PIC X(4).
   498         16  PB-M-INSURED-CANADIAN-ZIP  REDEFINES
   499                                        PB-M-INSURED-ZIP-CODE.
   500             20  PM-M-INS-CAN-POST1       PIC XXX.
   501             20  PM-M-INS-CAN-POST2       PIC XXX.
   502             20  FILLER                   PIC XXX.
   503         16  PB-M-INSURED-PHONE-NO        PIC 9(10).
   504         16  PB-M-JOINT-BIRTHDAY          PIC XX.
   505         16  PB-M-CRED-BENE-NAME          PIC X(30).
   506         16  PB-M-CRED-BENE-ADDR1         PIC X(30).
   507         16  PB-M-CRED-BENE-ADDR2         PIC X(30).
   508         16  PB-M-CRED-BENE-CITYST.
   509             20  PB-M-CRED-BENE-CITY      PIC X(28).
   510             20  PB-M-CRED-BENE-STATE     PIC XX.
   511
   512         16  FILLER                       PIC X(92).
   513
   514     12  PB-BATCH-RECORD   REDEFINES PB-RECORD-BODY.
   515         16  FILLER                       PIC X(10).
   516         16  PB-B-LF-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
   517         16  PB-B-LF-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
   518         16  PB-B-LF-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
   519         16  PB-B-LF-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
   520         16  PB-B-LF-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
   521         16  PB-B-LF-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
   522         16  PB-B-AH-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
   523         16  PB-B-AH-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
   524         16  PB-B-AH-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
   525         16  PB-B-AH-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
   526         16  PB-B-AH-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
   527         16  PB-B-AH-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
   528         16  PB-B-ISSUE-CNT-REMITTED      PIC S9(5)    COMP-3.
   529         16  PB-B-ISSUE-CNT-ENTERED       PIC S9(5)    COMP-3.
   530         16  PB-B-CANCEL-CNT-REMITTED     PIC S9(5)    COMP-3.
   531         16  PB-B-CANCEL-CNT-ENTERED      PIC S9(5)    COMP-3.
   532         16  PB-B-HIGHEST-SEQ-NO          PIC S9(4)    COMP.
   533         16  PB-ACCOUNT-NAME              PIC X(30).
   534         16  PB-PREM-REF-RPT-FLAG         PIC X.
   535         16  PB-REFERENCE                 PIC X(12).
   536         16  PB-B-RECEIVED-DT             PIC XX.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  11
* PEMPBF2.cbl (/apps/prod/cid1p/copy/ERCPNDB)
   537         16  FILLER                       PIC X(234).
   538
   539     12  PB-RECORD-STATUS.
   540         16  PB-CREDIT-SELECT-DT          PIC XX.
   541         16  PB-CREDIT-ACCEPT-DT          PIC XX.
   542         16  PB-BILLED-DT                 PIC XX.
   543         16  PB-BILLING-STATUS            PIC X.
   544             88  PB-ENTRY-REVERSED            VALUE 'R'.
   545             88  PB-EL860-INTERNAL-ERROR      VALUE 'E'.
   546             88  PB-EL860-INTERNAL-PROCESS    VALUE 'P'.
   547         16  PB-RECORD-BILL               PIC X.
   548             88  PB-RECORD-ON-HOLD            VALUE 'H'.
   549             88  PB-RECORD-RETURNED           VALUE 'R'.
   550             88  PB-RECORD-ENDORSED           VALUE 'E'.
   551             88  PB-OVERRIDE-LIFE             VALUE 'L'.
   552             88  PB-OVERRIDE-AH               VALUE 'A'.
   553             88  PB-OVERRIDE-BOTH             VALUE 'B'.
   554         16  PB-BATCH-ENTRY               PIC X.
   555             88  PB-POLICY-IS-DECLINED        VALUE 'D'.
   556             88  PB-REIN-ONLY-CERT            VALUE 'R'.
   557             88  PB-REISSUED-CERT             VALUE 'E'.
   558             88  PB-CASH-CERT                 VALUE 'C'.
   559             88  PB-MONTHLY-CERT              VALUE 'M'.
   560             88  PB-PREM-ACCTNG-ONLY          VALUE 'P'.
   561             88  PB-NEEDS-UNDERWRITING        VALUE 'U'.
   562             88  PB-POLICY-IS-VOIDED          VALUE 'V'.
   563         16  PB-FORCE-CODE                PIC X.
   564             88  PB-FORCE-OFF                 VALUE ' ' '0'.
   565             88  PB-ISSUE-FORCE               VALUE 'A' 'O'.
   566             88  PB-CANCEL-FORCE              VALUE '8'.
   567             88  PB-ALL-ISSUE-FORCED          VALUE 'A' 'O'.
   568             88  PB-ALL-CANCEL-FORCED         VALUE '8'.
   569             88  PB-ALL-CANCEL-FORCED-NO-FEE  VALUE '9'.
   570             88  PB-CANCEL-DATE-FORCED        VALUE 'D'.
   571             88  PB-CANCEL-DATE-FORCED-NO-FEE VALUE 'E'.
   572             88  PB-ISSUE-DATE-FORCED         VALUE 'D'.
   573             88  PB-OVERCHARGE-FORCE          VALUE 'O'.
   574         16  PB-FATAL-FLAG                PIC X.
   575             88  PB-FATAL-ERRORS              VALUE 'X'.
   576         16  PB-FORCE-ER-CD               PIC X.
   577             88  PB-FORCE-ERRORS              VALUE 'F'.
   578             88  PB-UNFORCED-ERRORS           VALUE 'X'.
   579         16  PB-WARN-ER-CD                PIC X.
   580             88  PB-WARNING-ERRORS            VALUE 'W'.
   581         16  FILLER                       PIC X.
   582         16  PB-OUT-BAL-CD                PIC X.
   583             88  PB-OUT-OF-BAL                VALUE 'O'.
   584         16  PB-LIFE-OVERRIDE-L1          PIC X.
   585         16  PB-AH-OVERRIDE-L1            PIC X.
   586         16  PB-INPUT-DT                  PIC XX.
   587         16  PB-INPUT-BY                  PIC X(4).
   588         16  PB-CHG-COUNT                 PIC 9(3)        COMP-3.
   589         16  PB-CALC-TOLERANCE            PIC 9(3)V99     COMP-3.
   590         16  PB-TOLERANCE-REJECT-SW       PIC X.
   591         16  PB-LF-EARNING-METHOD         PIC X.
   592         16  PB-AH-EARNING-METHOD         PIC X.
   593         16  PB-LF-TERM-CALC-METHOD       PIC X.
   594         16  PB-AH-TERM-CALC-METHOD       PIC X.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  12
* PEMPBF2.cbl (/apps/prod/cid1p/copy/ERCPNDB)
   595         16  PB-REIN-CD                   PIC XXX.
   596         16  PB-LF-REFUND-TYPE            PIC X.
   597         16  PB-AH-REFUND-TYPE            PIC X.
   598         16  PB-ACCT-EFF-DT               PIC XX.
   599         16  PB-ACCT-EXP-DT               PIC XX.
   600         16  PB-COMPANY-ID                PIC X(3).
   601         16  PB-LF-BILLED-AMTS            PIC S9(7)V99  COMP-3.
   602         16  PB-AH-BILLED-AMTS            PIC S9(7)V99  COMP-3.
   603         16  PB-SV-CARRIER                PIC X.
   604         16  PB-SV-GROUPING               PIC X(6).
   605         16  PB-SV-STATE                  PIC XX.
   606         16  PB-CONFIRMATION-REPT-DT      PIC XX.
   607         16  PB-GA-BILLING-INFO.
   608             20  PB-GA-BILL-DT OCCURS 5 TIMES
   609                                          PIC XX.
   610         16  PB-SV-REMIT-TO  REDEFINES
   611             PB-GA-BILLING-INFO           PIC X(10).
   612         16  PB-NO-OF-ERRORS              PIC S9(3) COMP-3.
   613         16  PB-I-LOAN-OFFICER            PIC X(5).
   614         16  PB-I-VIN                     PIC X(17).
   615
   616         16  FILLER                       PIC X(04).
   617         16  IMNET-BYPASS-SW              PIC X.
   618
   619******************************************************************
   620*                COMMON EDIT ERRORS                              *
   621******************************************************************
   622
   623     12  PB-COMMON-ERRORS.
   624         16  PB-COMMON-ERROR    OCCURS 10 TIMES
   625                                           PIC S9(4)     COMP.
   626
   627******************************************************************
   628
   629 WORKING-STORAGE SECTION.
   630 77  S1                          PIC S9(3) COMP-3 VALUE +0.
   631 77  WS-STATE-SW                 PIC X  VALUE ' '.
   632     88  VALID-STATE               VALUE 'Y'.
   633 77  WS-DIS-EFF-DT               PIC X(10)  VALUE SPACES.
   634 77  WS-DIS-EXP-DT               PIC X(10)  VALUE SPACES.
   635 77  WS-REWRITE-SW               PIC X      VALUE SPACES.
   636     88  REWRITE-PB                 VALUE 'Y'.
   637 01  WS-STATUS-CODES.
   638     05  ERPNDB-FILE-STATUS      PIC XX  VALUE SPACES.
   639     05  WS-EOF-SW               PIC X   VALUE SPACES.
   640         88  END-OF-ERPNDB               VALUE 'Y'.
   641         88  MORE-ERPNDB                 VALUE ' '.
   642
   643*****************************************************************
   644*                                                               *
   645*                     STATE CODE TABLE                          *
   646*                                                               *
   647*  CAUTION:  THIS TABLE MUST BE IN SEQUENCE BY STATE OR THE     *
   648*            SEARCH VERB WILL NOT WORK PROPERLY !               *
   649*                                                               *
   650*****************************************************************
   651
   652 01  STATE-VALUES.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  13
* PEMPBF2.cbl
   653     05  PIC X(24)  VALUE 'AAAA                    '.
   654     05  PIC X(24)  VALUE 'AEAE                    '.
   655     05  PIC X(24)  VALUE 'AKAKALASKA              '.
   656     05  PIC X(24)  VALUE 'ALALALABAMA             '.
   657     05  PIC X(24)  VALUE 'APAP                    '.
   658     05  PIC X(24)  VALUE 'ARARARKANSAS            '.
   659     05  PIC X(24)  VALUE 'ASASAMERICAN SAMOA      '.
   660     05  PIC X(24)  VALUE 'AZAZARIZONA             '.
   661     05  PIC X(24)  VALUE 'CACACALIFORNIA          '.
   662     05  PIC X(24)  VALUE 'CDCNCANADA              '.
   663     05  PIC X(24)  VALUE 'CNCNCANADA              '.
   664     05  PIC X(24)  VALUE 'COCOCOLORADO            '.
   665     05  PIC X(24)  VALUE 'CTCTCONNECTICUT         '.
   666     05  PIC X(24)  VALUE 'DCDCDISTRICT OF COLUMBIA'.
   667     05  PIC X(24)  VALUE 'DEDEDELAWARE            '.
   668     05  PIC X(24)  VALUE 'FCOTOTHER ALIEN         '.
   669     05  PIC X(24)  VALUE 'FLFLFLORIDA             '.
   670     05  PIC X(24)  VALUE 'GAGAGEORGIA             '.
   671     05  PIC X(24)  VALUE 'GUGUGUAM                '.
   672     05  PIC X(24)  VALUE 'HIHIHAWAII              '.
   673     05  PIC X(24)  VALUE 'IAIAIOWA                '.
   674     05  PIC X(24)  VALUE 'IDIDIDAHO               '.
   675     05  PIC X(24)  VALUE 'ILILILLINOIS            '.
   676     05  PIC X(24)  VALUE 'INININDIANA             '.
   677     05  PIC X(24)  VALUE 'KSKSKANSAS              '.
   678     05  PIC X(24)  VALUE 'KYKYKENTUCKY            '.
   679     05  PIC X(24)  VALUE 'LALALOUISIANA           '.
   680     05  PIC X(24)  VALUE 'MAMAMASSACHUSETTS       '.
   681     05  PIC X(24)  VALUE 'MDMDMARYLAND            '.
   682     05  PIC X(24)  VALUE 'MEMEMAINE               '.
   683     05  PIC X(24)  VALUE 'MIMIMICHIGAN            '.
   684     05  PIC X(24)  VALUE 'MNMNMINNESOTA           '.
   685     05  PIC X(24)  VALUE 'MOMOMISSOURI            '.
   686     05  PIC X(24)  VALUE 'MSMSMISSISSIPPI         '.
   687     05  PIC X(24)  VALUE 'MTMTMONTANA             '.
   688     05  PIC X(24)  VALUE 'NCNCNORTH CAROLINA      '.
   689     05  PIC X(24)  VALUE 'NDNDNORTH DAKOTA        '.
   690     05  PIC X(24)  VALUE 'NENENEBRASKA            '.
   691     05  PIC X(24)  VALUE 'NHNHNEW HAMPSHIRE       '.
   692     05  PIC X(24)  VALUE 'NJNJNEW JERSEY          '.
   693     05  PIC X(24)  VALUE 'NMNMNEW MEXICO          '.
   694     05  PIC X(24)  VALUE 'NVNVNEVADA              '.
   695     05  PIC X(24)  VALUE 'NYNYNEW YORK            '.
   696     05  PIC X(24)  VALUE 'OFOTOTHER ALIEN         '.
   697     05  PIC X(24)  VALUE 'OHOHOHIO                '.
   698     05  PIC X(24)  VALUE 'OKOKOKLAHOMA            '.
   699     05  PIC X(24)  VALUE 'OROROREGON              '.
   700     05  PIC X(24)  VALUE 'OTOTOTHER ALIEN         '.
   701     05  PIC X(24)  VALUE 'PAPAPENNSYLVANIA        '.
   702     05  PIC X(24)  VALUE 'PRPRPUERTO RICO         '.
   703     05  PIC X(24)  VALUE 'RIRIRHODE ISLAND        '.
   704     05  PIC X(24)  VALUE 'SCSCSOUTH CAROLINA      '.
   705     05  PIC X(24)  VALUE 'SDSDSOUTH DAKOTA        '.
   706     05  PIC X(24)  VALUE 'TNTNTENNESSEE           '.
   707     05  PIC X(24)  VALUE 'TXTXTEXAS               '.
   708     05  PIC X(24)  VALUE 'UTUTUTAH                '.
   709     05  PIC X(24)  VALUE 'VAVAVIRGINIA            '.
   710     05  PIC X(24)  VALUE 'VIVIUS VIRGIN ISLANDS   '.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  14
* PEMPBF2.cbl
   711     05  PIC X(24)  VALUE 'VTVTVERMONT             '.
   712     05  PIC X(24)  VALUE 'WAWAWASHINGTON          '.
   713     05  PIC X(24)  VALUE 'WIWIWISCONSIN           '.
   714     05  PIC X(24)  VALUE 'WVWVWEST VIRGINIA       '.
   715     05  PIC X(24)  VALUE 'WYWYWYOMING             '.
   716
   717 01  FILLER REDEFINES STATE-VALUES.
   718     05  STATE-TABLE
   719             OCCURS 63 TIMES
   720             ASCENDING KEY IS ST-STATE
   721             INDEXED BY ST-INDEX.
   722         10  ST-STATE          PIC XX.
   723         10  ST-ALT-STATE      PIC XX.
   724         10  ST-NAME           PIC X(20).
   725
   726
*  727                                 COPY ELCDATE.
   728******************************************************************06/11/98
   729*                                                                *ELCDATE
   730*                                                                *ELCDATE
   731*                            ELCDATE.                            *   LV023
   732*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL*16
   733*                            VMOD=2.003                           ELCDATE
   734*                                                                *ELCDATE
   735*                                                                *ELCDATE
   736*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *ELCDATE
   737*                 LENGTH = 200                                   *   CL*19
   738******************************************************************ELCDATE
   739                                                                  ELCDATE
   740 01  DATE-CONVERSION-DATA.                                        ELCDATE
   741     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.    CL*19
   742     12  DC-OPTION-CODE                PIC X.                        CL*15
   743         88  BIN-TO-GREG                VALUE ' '.                ELCDATE
   744         88  ELAPSED-BETWEEN-BIN        VALUE '1'.                ELCDATE
   745         88  EDIT-GREG-TO-BIN           VALUE '2'.                ELCDATE
   746         88  YMD-GREG-TO-BIN            VALUE '3'.                ELCDATE
   747         88  MDY-GREG-TO-BIN            VALUE '4'.                ELCDATE
   748         88  JULIAN-TO-BIN              VALUE '5'.                ELCDATE
   749         88  BIN-PLUS-ELAPSED           VALUE '6'.                ELCDATE
   750         88  FIND-CENTURY               VALUE '7'.                   CL*22
   751         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.                ELCDATE
   752         88  EDIT-GREG-TO-BIN-3         VALUE '9'.                ELCDATE
   753         88  YMD-GREG-TO-BIN-3          VALUE 'A'.                ELCDATE
   754         88  MDY-GREG-TO-BIN-3          VALUE 'B'.                ELCDATE
   755         88  JULIAN-TO-BIN-3            VALUE 'C'.                ELCDATE
   756         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.                ELCDATE
   757         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.                   CL*14
   758         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.                   CL*14
   759         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.                   CL*14
   760         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.         CL*14
   761         88  CHECK-LEAP-YEAR            VALUE 'H'.                   CL*14
   762         88  BIN-3-TO-GREG              VALUE 'I'.                   CL*14
   763         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.                   CL*14
   764         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.                   CL*14
   765         88  CYMD-GREG-TO-BIN           VALUE 'L'.                   CL*14
   766         88  MDCY-GREG-TO-BIN           VALUE 'M'.                   CL*14
   767         88  MDY-GREG-TO-JULIAN         VALUE 'N'.                   CL*14
   768         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.                   CL*14
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  15
* PEMPBF2.cbl (/apps/prod/cid1p/copy/ELCDATE)
   769         88  YMD-GREG-TO-JULIAN         VALUE 'P'.                   CL*14
   770         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.                   CL*14
   771         88  THREE-CHARACTER-BIN                                  ELCDATE
   772                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.       CL*14
   773         88  GREGORIAN-TO-BIN                                        CL**2
   774                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.    CL*14
   775         88  BIN-TO-GREGORIAN                                        CL**2
   776                  VALUES ' ' '1' 'I' '8' 'G'.                        CL*14
   777         88  JULIAN-TO-BINARY                                        CL**2
   778                  VALUES '5' 'C' 'E' 'F'.                            CL*14
   779     12  DC-ERROR-CODE                 PIC X.                        CL*15
   780         88  NO-CONVERSION-ERROR        VALUE ' '.                   CL**3
   781         88  DATE-CONVERSION-ERROR                                ELCDATE
   782                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.        CL*14
   783         88  DATE-IS-ZERO               VALUE '1'.                ELCDATE
   784         88  DATE-IS-NON-NUMERIC        VALUE '2'.                ELCDATE
   785         88  DATE-IS-INVALID            VALUE '3'.                ELCDATE
   786         88  DATE1-GREATER-DATE2        VALUE '4'.                ELCDATE
   787         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.                ELCDATE
   788         88  DATE-INVALID-OPTION        VALUE '9'.                ELCDATE
   789         88  INVALID-CENTURY            VALUE 'A'.                ELCDATE
   790         88  ONLY-CENTURY               VALUE 'B'.                ELCDATE
   791         88  ONLY-LEAP-YEAR             VALUE 'C'.                ELCDATE
   792         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.              CL**3
   793     12  DC-END-OF-MONTH               PIC X.                        CL*15
   794         88  CALCULATE-END-OF-MONTH     VALUE '1'.                ELCDATE
   795     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.         CL*15
   796         88  USE-NORMAL-PROCESS         VALUE ' '.                ELCDATE
   797         88  ADJUST-DOWN-100-YRS        VALUE '1'.                ELCDATE
   798         88  ADJUST-UP-100-YRS          VALUE '2'.                ELCDATE
   799     12  FILLER                        PIC X.                        CL*15
   800     12  DC-CONVERSION-DATES.                                        CL*15
   801         16  DC-BIN-DATE-1             PIC XX.                       CL*15
   802         16  DC-BIN-DATE-2             PIC XX.                       CL*15
   803         16  DC-GREG-DATE-1-EDIT       PIC X(08).                    CL*15
   804         16  DC-GREG-DATE-1-EDIT-R REDEFINES                         CL*15
   805                       DC-GREG-DATE-1-EDIT.                       ELCDATE
   806             20  DC-EDIT1-MONTH        PIC 99.                       CL*15
   807             20  SLASH1-1              PIC X.                        CL*15
   808             20  DC-EDIT1-DAY          PIC 99.                       CL*15
   809             20  SLASH1-2              PIC X.                        CL*15
   810             20  DC-EDIT1-YEAR         PIC 99.                       CL*15
   811         16  DC-GREG-DATE-2-EDIT       PIC X(08).                    CL*15
   812         16  DC-GREG-DATE-2-EDIT-R REDEFINES                         CL*15
   813                     DC-GREG-DATE-2-EDIT.                         ELCDATE
   814             20  DC-EDIT2-MONTH        PIC 99.                       CL*15
   815             20  SLASH2-1              PIC X.                        CL*15
   816             20  DC-EDIT2-DAY          PIC 99.                       CL*15
   817             20  SLASH2-2              PIC X.                        CL*15
   818             20  DC-EDIT2-YEAR         PIC 99.                       CL*15
   819         16  DC-GREG-DATE-1-YMD        PIC 9(06).                    CL*15
   820         16  DC-GREG-DATE-1-YMD-R  REDEFINES                         CL*15
   821                     DC-GREG-DATE-1-YMD.                          ELCDATE
   822             20  DC-YMD-YEAR           PIC 99.                       CL*15
   823             20  DC-YMD-MONTH          PIC 99.                       CL*15
   824             20  DC-YMD-DAY            PIC 99.                       CL*15
   825         16  DC-GREG-DATE-1-MDY        PIC 9(06).                    CL*15
   826         16  DC-GREG-DATE-1-MDY-R REDEFINES                          CL*15
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  16
* PEMPBF2.cbl (/apps/prod/cid1p/copy/ELCDATE)
   827                      DC-GREG-DATE-1-MDY.                         ELCDATE
   828             20  DC-MDY-MONTH          PIC 99.                       CL*15
   829             20  DC-MDY-DAY            PIC 99.                       CL*15
   830             20  DC-MDY-YEAR           PIC 99.                       CL*15
   831         16  DC-GREG-DATE-1-ALPHA.                                   CL*15
   832             20  DC-ALPHA-MONTH        PIC X(10).                    CL*15
   833             20  DC-ALPHA-DAY          PIC 99.                       CL*15
   834             20  FILLER                PIC XX.                       CL*15
   835             20  DC-ALPHA-CENTURY.                                   CL*15
   836                 24 DC-ALPHA-CEN-N     PIC 99.                       CL*15
   837             20  DC-ALPHA-YEAR         PIC 99.                       CL*15
   838         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.           CL*15
   839         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.           CL*15
   840         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.           CL*15
   841         16  DC-JULIAN-DATE            PIC 9(05).                    CL*15
   842         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE                CL*20
   843                                       PIC 9(05).                    CL*20
   844         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.                  CL*15
   845             20  DC-JULIAN-YEAR        PIC 99.                       CL*15
   846             20  DC-JULIAN-DAYS        PIC 999.                      CL*15
   847         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.       CL*15
   848         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.    CL*15
   849         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.    CL*15
   850     12  DATE-CONVERSION-VARIBLES.                                   CL*15
   851         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.            CL*15
   852         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.          CL*15
   853             20  FILLER                PIC 9(3).                     CL*15
   854             20  HOLD-CEN-1-CCYY.                                    CL*15
   855                 24  HOLD-CEN-1-CC     PIC 99.                       CL*17
   856                 24  HOLD-CEN-1-YY     PIC 99.                       CL*17
   857             20  HOLD-CEN-1-MO         PIC 99.                       CL*17
   858             20  HOLD-CEN-1-DA         PIC 99.                       CL*17
   859         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.            CL*15
   860             20  HOLD-CEN-1-R-MO       PIC 99.                       CL*17
   861             20  HOLD-CEN-1-R-DA       PIC 99.                       CL*17
   862             20  HOLD-CEN-1-R-CCYY.                                  CL*15
   863                 24  HOLD-CEN-1-R-CC   PIC 99.                       CL*17
   864                 24  HOLD-CEN-1-R-YY   PIC 99.                       CL*17
   865             20  FILLER                PIC 9(3).                     CL*15
   866         16  HOLD-CENTURY-1-X.                                       CL*15
   867             20  FILLER                PIC X(3)  VALUE SPACES.       CL*15
   868             20  HOLD-CEN-1-X-CCYY.                                  CL*15
   869                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.          CL*17
   870                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.          CL*17
   871             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.          CL*17
   872             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.          CL*17
   873         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.          CL*15
   874             20  HOLD-CEN-1-R-X-MO     PIC XX.                       CL*17
   875             20  HOLD-CEN-1-R-X-DA     PIC XX.                       CL*17
   876             20  HOLD-CEN-1-R-X-CCYY.                                CL*15
   877                 24  HOLD-CEN-1-R-X-CC PIC XX.                       CL*17
   878                 24  HOLD-CEN-1-R-X-YY PIC XX.                       CL*17
   879             20  FILLER                PIC XXX.                      CL*23
   880         16  DC-BIN-DATE-EXPAND-1      PIC XXX.                      CL*15
   881         16  DC-BIN-DATE-EXPAND-2      PIC XXX.                      CL*15
   882         16  DC-JULIAN-DATE-1          PIC 9(07).                    CL*15
   883         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.          CL*15
   884             20  DC-JULIAN-1-CCYY.                                   CL*15
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  17
* PEMPBF2.cbl (/apps/prod/cid1p/copy/ELCDATE)
   885                 24  DC-JULIAN-1-CC    PIC 99.                       CL*15
   886                 24  DC-JULIAN-1-YR    PIC 99.                       CL*15
   887             20  DC-JULIAN-DA-1        PIC 999.                      CL*15
   888         16  DC-JULIAN-DATE-2          PIC 9(07).                    CL*15
   889         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.          CL*15
   890             20  DC-JULIAN-2-CCYY.                                   CL*15
   891                 24  DC-JULIAN-2-CC    PIC 99.                       CL*15
   892                 24  DC-JULIAN-2-YR    PIC 99.                       CL*15
   893             20  DC-JULIAN-DA-2        PIC 999.                      CL*15
   894         16  DC-GREG-DATE-A-EDIT.                                    CL*15
   895             20  DC-EDITA-MONTH        PIC 99.                       CL*15
   896             20  SLASHA-1              PIC X VALUE '/'.              CL*15
   897             20  DC-EDITA-DAY          PIC 99.                       CL*15
   898             20  SLASHA-2              PIC X VALUE '/'.              CL*15
   899             20  DC-EDITA-CCYY.                                      CL*15
   900                 24  DC-EDITA-CENT     PIC 99.                       CL*15
   901                 24  DC-EDITA-YEAR     PIC 99.                       CL*15
   902         16  DC-GREG-DATE-B-EDIT.                                    CL*15
   903             20  DC-EDITB-MONTH        PIC 99.                       CL*15
   904             20  SLASHB-1              PIC X VALUE '/'.              CL*15
   905             20  DC-EDITB-DAY          PIC 99.                       CL*15
   906             20  SLASHB-2              PIC X VALUE '/'.              CL*15
   907             20  DC-EDITB-CCYY.                                      CL*15
   908                 24  DC-EDITB-CENT     PIC 99.                       CL*15
   909                 24  DC-EDITB-YEAR     PIC 99.                       CL*15
   910         16  DC-GREG-DATE-CYMD         PIC 9(08).                    CL*15
   911         16  DC-GREG-DATE-CYMD-R REDEFINES                           CL*15
   912                              DC-GREG-DATE-CYMD.                  ELCDATE
   913             20  DC-CYMD-CEN           PIC 99.                       CL*15
   914             20  DC-CYMD-YEAR          PIC 99.                       CL*15
   915             20  DC-CYMD-MONTH         PIC 99.                       CL*15
   916             20  DC-CYMD-DAY           PIC 99.                       CL*15
   917         16  DC-GREG-DATE-MDCY         PIC 9(08).                    CL*15
   918         16  DC-GREG-DATE-MDCY-R REDEFINES                           CL*15
   919                              DC-GREG-DATE-MDCY.                  ELCDATE
   920             20  DC-MDCY-MONTH         PIC 99.                       CL*15
   921             20  DC-MDCY-DAY           PIC 99.                       CL*15
   922             20  DC-MDCY-CEN           PIC 99.                       CL*15
   923             20  DC-MDCY-YEAR          PIC 99.                       CL*15
   924    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.      ELCDATE
   925        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.        ELCDATE
   926    12  DC-EL310-DATE                  PIC X(21).                    CL*26
   927    12  FILLER                         PIC X(28).                    CL*26
   928
   929 01  WS-HOLD-CITY-STATE          PIC X(30)  VALUE SPACES.
   930 01  WS-WORK-CITY-ST.
   931     05  WS-WORK-CITY            PIC X(28)  VALUE SPACES.
   932     05  WS-WORK-STATE           PIC XX     VALUE SPACES.
   933 01  WS-HOLD-ERPNDB              PIC X(374) VALUE LOW-VALUES.
   934 01  WS-WORK-FIELDS.
   935     05  WS-ABEND-FLD            PIC 9         VALUE ZEROS.
   936     05  WS-ZERO-FLD             PIC 9         VALUE ZEROS.
   937     05  WS-ERPNDB-RECS-IN       PIC 9(9)      VALUE ZEROS.
   938     05  WS-ERPNDB-RECS-FIX      PIC 9(9)      VALUE ZEROS.
   939     05  WS-ERPNDB-RECS-DEL      PIC 9(9)      VALUE ZEROS.
   940     05  WS-DISPLAY-CNT          PIC Z,ZZZ,ZZ9 VALUE ZEROS.
   941     05  WS-INVALID-ST-CNT       PIC 9(9)      VALUE ZEROS.
   942
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  18
* PEMPBF2.cbl
   943 PROCEDURE DIVISION.
   944 0000-MAINLINE.
   945
   946     PERFORM 0100-OPEN-FILES     THRU 0100-EXIT
   947     PERFORM 0200-INITIALIZE     THRU 0200-EXIT
   948     PERFORM 0500-PROCESS        THRU 0500-EXIT UNTIL
   949        END-OF-ERPNDB
   950*       OR WS-ERPNDB-RECS-FIX > 500
   951     PERFORM 3000-CLOSE-FILES    THRU 3000-EXIT
   952     PERFORM 4000-FINAL-TOTALS   THRU 4000-EXIT
   953     GOBACK
   954
   955     .
   956 0000-EXIT.
   957     EXIT.
   958
   959 0100-OPEN-FILES.
   960
   961*    OPEN I-O   ERPNDB
   962     OPEN INPUT ERPNDB
   963
   964     IF ERPNDB-FILE-STATUS = '00'
   965         CONTINUE
   966     ELSE
   967         DISPLAY '*** ERROR OPENING ERPNDB FILE ***'
   968         DISPLAY '*** STATUS CODE IS ' ERPNDB-FILE-STATUS
   969         PERFORM 9999-ABEND-RTN
   970     END-IF
   971
   972     .
   973 0100-EXIT.
   974     EXIT.
   975
   976 0200-INITIALIZE.
   977
   978     MOVE SPACES                 TO WS-EOF-SW
   979     MOVE ZEROS                  TO WS-ERPNDB-RECS-IN
   980                                    WS-ERPNDB-RECS-FIX
   981                                    WS-ERPNDB-RECS-DEL
   982
   983     PERFORM 1100-START-ERPNDB   THRU 1100-EXIT
   984
   985     PERFORM 1200-READ-ERPNDB    THRU 1200-EXIT
   986
   987     .
   988 0200-EXIT.
   989     EXIT.
   990
   991 0500-PROCESS.
   992
   993     IF PB-RECORD-TYPE = '0'
   994        DISPLAY ' FOUND TYPE 0 '
   995        IF (PB-M-INSURED-CITY-STATE NOT = SPACES)
   996           OR (PB-M-CRED-BENE-CITYST NOT = SPACES)
   997           PERFORM 1000-PROCESS     THRU 1000-EXIT
   998        END-IF
   999     END-IF
  1000
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  19
* PEMPBF2.cbl
  1001     PERFORM 1200-READ-ERPNDB    THRU 1200-EXIT
  1002
  1003     .
  1004 0500-EXIT.
  1005     EXIT.
  1006
  1007 1000-PROCESS.
  1008
  1009     DISPLAY ' MADE 1000 '
  1010     MOVE ' '                    TO WS-REWRITE-SW
  1011     IF PB-M-INSURED-CITY-STATE NOT = SPACES
  1012        MOVE SPACES              TO WS-WORK-CITY-ST
  1013        MOVE PB-M-INSURED-CITY-STATE       TO WS-HOLD-CITY-STATE
  1014
  1015** CHECK FOR GUAM AND CHANGE TO GU **
  1016        PERFORM VARYING S1 FROM +27 BY -1 UNTIL
  1017           (S1 = +1)
  1018           OR (PB-M-INSURED-CITY-STATE (S1:4) = 'GUAM')
  1019        END-PERFORM
  1020        IF PB-M-INSURED-CITY-STATE (S1:4) = 'GUAM'
  1021           MOVE 'GU  '      TO PB-M-INSURED-CITY-STATE (S1:4)
  1022           DISPLAY ' FIXED GUAM ' WS-HOLD-CITY-STATE ' '
  1023              PB-M-INSURED-CITY-STATE
  1024           MOVE PB-M-INSURED-CITY-STATE TO WS-HOLD-CITY-STATE
  1025        END-IF
  1026
  1027        PERFORM VARYING S1 FROM +30 BY -1 UNTIL
  1028           (PB-M-INSURED-CITY-STATE (S1:1) NOT = SPACE AND '.')
  1029           OR (S1 = +1)
  1030        END-PERFORM
  1031        IF S1 > 3
  1032           SUBTRACT +1 FROM S1
  1033           MOVE PB-M-INSURED-CITY-STATE (S1:2)
  1034                                    TO WS-WORK-STATE
  1035           SUBTRACT +1 FROM S1
  1036           PERFORM VARYING S1 FROM S1 BY -1 UNTIL
  1037              PB-M-INSURED-CITY-STATE (S1:1) NOT = SPACE
  1038           END-PERFORM
  1039           IF S1 > 2
  1040              IF PB-M-INSURED-CITY-STATE (S1:1) = ','
  1041                   OR ';' OR '.'
  1042                 MOVE PB-M-INSURED-CITY-STATE (1:S1 - 1)
  1043                                         TO WS-WORK-CITY
  1044              ELSE
  1045                 MOVE PB-M-INSURED-CITY-STATE (1:S1)
  1046                                         TO WS-WORK-CITY
  1047              END-IF
  1048           END-IF
  1049           MOVE SPACE               TO WS-STATE-SW
  1050           PERFORM 1500-EDIT-STATE  THRU 1500-EXIT
  1051           IF VALID-STATE
  1052              MOVE WS-WORK-CITY  TO PB-M-INSURED-CITY
  1053              MOVE WS-WORK-STATE TO PB-M-INSURED-STATE
  1054              DISPLAY ' PB OLD ' WS-HOLD-CITY-STATE
  1055                 ' NEW ' PB-M-INSURED-CITY-STATE
  1056              SET REWRITE-PB TO TRUE
  1057           ELSE
  1058              DISPLAY 'INVALID STATE CODE: ' WS-WORK-STATE
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  20
* PEMPBF2.cbl
  1059                 ' ' WS-HOLD-CITY-STATE ' ' PB-ENTRY-BATCH ' '
  1060                 PB-BATCH-SEQ-NO
  1061           END-IF
  1062        ELSE
  1063           DISPLAY ' WEIRD CITY STATE ' PB-ENTRY-BATCH
  1064              ' ' PB-BATCH-SEQ-NO
  1065              ' ' PB-M-INSURED-CITY-STATE
  1066        END-IF
  1067     END-IF
  1068
  1069
  1070     IF PB-M-CRED-BENE-CITYST NOT = SPACES
  1071        MOVE SPACES              TO WS-WORK-CITY-ST
  1072        MOVE PB-M-CRED-BENE-CITYST  TO WS-HOLD-CITY-STATE
  1073
  1074** CHECK FOR GUAM AND CHANGE TO GU **
  1075        PERFORM VARYING S1 FROM +27 BY -1 UNTIL
  1076           (S1 = +1)
  1077           OR (PB-M-CRED-BENE-CITYST (S1:4) = 'GUAM')
  1078        END-PERFORM
  1079        IF PB-M-CRED-BENE-CITYST (S1:4) = 'GUAM'
  1080           MOVE 'GU  '           TO PB-M-CRED-BENE-CITYST (S1:4)
  1081           DISPLAY ' FIXED GUAM ' WS-HOLD-CITY-STATE ' '
  1082              PB-M-CRED-BENE-CITYST
  1083           MOVE PB-M-CRED-BENE-CITYST  TO WS-HOLD-CITY-STATE
  1084        END-IF
  1085
  1086        PERFORM VARYING S1 FROM +30 BY -1 UNTIL
  1087           (PB-M-CRED-BENE-CITYST (S1:1) NOT = SPACE AND '.')
  1088           OR (S1 = +1)
  1089        END-PERFORM
  1090        IF S1 > 3
  1091           SUBTRACT +1 FROM S1
  1092           MOVE PB-M-CRED-BENE-CITYST (S1:2)
  1093                                    TO WS-WORK-STATE
  1094           SUBTRACT +1 FROM S1
  1095           PERFORM VARYING S1 FROM S1 BY -1 UNTIL
  1096              PB-M-CRED-BENE-CITYST (S1:1) NOT = SPACE
  1097           END-PERFORM
  1098           IF S1 > 2
  1099              IF PB-M-CRED-BENE-CITYST (S1:1) = ',' OR ';' OR '.'
  1100                 MOVE PB-M-CRED-BENE-CITYST (1:S1 - 1)
  1101                                 TO WS-WORK-CITY
  1102              ELSE
  1103                 MOVE PB-M-CRED-BENE-CITYST (1:S1)
  1104                                 TO WS-WORK-CITY
  1105              END-IF
  1106           END-IF
  1107           MOVE SPACE               TO WS-STATE-SW
  1108           PERFORM 1500-EDIT-STATE  THRU 1500-EXIT
  1109           IF VALID-STATE
  1110              MOVE WS-WORK-CITY  TO PB-M-CRED-BENE-CITY
  1111              MOVE WS-WORK-STATE TO PB-M-CRED-BENE-STATE
  1112              DISPLAY ' CB OLD ' WS-HOLD-CITY-STATE
  1113                 ' NEW ' PB-M-CRED-BENE-CITYST
  1114              SET REWRITE-PB TO TRUE
  1115           ELSE
  1116              DISPLAY 'INVALID STATE CODE: ' WS-WORK-STATE
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  21
* PEMPBF2.cbl
  1117                 ' ' WS-HOLD-CITY-STATE ' ' PB-ENTRY-BATCH ' '
  1118                 PB-BATCH-SEQ-NO
  1119           END-IF
  1120        ELSE
  1121           DISPLAY ' WEIRD CITY STATE ' PB-ENTRY-BATCH
  1122              ' ' PB-BATCH-SEQ-NO
  1123              ' ' PB-M-CRED-BENE-CITYST
  1124        END-IF
  1125     END-IF
  1126
  1127     IF REWRITE-PB
  1128        PERFORM 2100-REWRITE-ERPNDB
  1129                                    THRU 2100-EXIT
  1130     END-IF
  1131
  1132     .
  1133 1000-EXIT.
  1134     EXIT.
  1135
  1136 1100-START-ERPNDB.
  1137
  1138     MOVE LOW-VALUES             TO PB-CONTROL-PRIMARY
  1139     MOVE X'04'                  TO PB-COMPANY-CD
  1140
  1141     START ERPNDB KEY IS NOT <
  1142                      PB-CONTROL-PRIMARY
  1143     IF ERPNDB-FILE-STATUS NOT = '00'
  1144        DISPLAY ' ERPNDB, BAD START '
  1145              ERPNDB-FILE-STATUS
  1146        PERFORM 9999-ABEND-RTN
  1147     END-IF
  1148
  1149     .
  1150
  1151 1100-EXIT.
  1152     EXIT.
  1153
  1154 1200-READ-ERPNDB.
  1155
  1156     READ ERPNDB NEXT RECORD
  1157
  1158     IF ERPNDB-FILE-STATUS = '10' OR '23'
  1159        SET END-OF-ERPNDB TO TRUE
  1160     ELSE
  1161        IF ERPNDB-FILE-STATUS NOT = '00'
  1162           DISPLAY 'ERPNDB, BAD READ NEXT '
  1163                ERPNDB-FILE-STATUS
  1164           PERFORM 9999-ABEND-RTN
  1165        ELSE
  1166           ADD 1              TO WS-ERPNDB-RECS-IN
  1167        END-IF
  1168     END-IF
  1169
  1170     .
  1171 1200-EXIT.
  1172     EXIT.
  1173
  1174 1500-EDIT-STATE.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  22
* PEMPBF2.cbl
  1175
  1176     SEARCH ALL STATE-TABLE AT END
  1177        ADD 1 TO WS-INVALID-ST-CNT
  1178        WHEN ST-STATE (ST-INDEX) = WS-WORK-STATE
  1179           SET VALID-STATE TO TRUE
  1180     END-SEARCH
  1181
  1182     .
  1183 1500-EXIT.
  1184     EXIT.
  1185
  1186 2100-REWRITE-ERPNDB.
  1187
  1188*    REWRITE PENDING-MAILING-DATA
  1189     MOVE '00' TO ERPNDB-FILE-STATUS
  1190
  1191     IF ERPNDB-FILE-STATUS = '00'
  1192         ADD 1                   TO WS-ERPNDB-RECS-FIX
  1193     ELSE
  1194         DISPLAY 'ERPNDB, BAD REWRITE '
  1195         DISPLAY '*** STATUS CODE IS ' ERPNDB-FILE-STATUS
  1196         PERFORM 9999-ABEND-RTN
  1197     END-IF
  1198     .
  1199 2100-EXIT.
  1200     EXIT.
  1201
  1202 2200-DELETE-ERPNDB.
  1203
  1204     DELETE  ERPNDB
  1205
  1206     IF ERPNDB-FILE-STATUS = '00'
  1207         ADD 1                   TO WS-ERPNDB-RECS-DEL
  1208     ELSE
  1209         DISPLAY 'ERPNDB, BAD DELETE  '
  1210         DISPLAY '*** STATUS CODE IS ' ERPNDB-FILE-STATUS
  1211         PERFORM 9999-ABEND-RTN
  1212     END-IF
  1213     .
  1214 2200-EXIT.
  1215     EXIT.
  1216
  1217
  1218 3000-CLOSE-FILES.
  1219
  1220     CLOSE ERPNDB
  1221
  1222     .
  1223 3000-EXIT.
  1224     EXIT.
  1225
  1226 4000-FINAL-TOTALS.
  1227
  1228     DISPLAY '**************************************************'
  1229     DISPLAY '***                                            ***'
  1230
  1231     MOVE WS-ERPNDB-RECS-IN      TO WS-DISPLAY-CNT
  1232     DISPLAY '***  ERPNDB RECORDS   IN         = ' WS-DISPLAY-CNT
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  23
* PEMPBF2.cbl
  1233
  1234     MOVE WS-ERPNDB-RECS-FIX     TO WS-DISPLAY-CNT
  1235     DISPLAY '***  ERPNDB RECORDS   FIXED      = ' WS-DISPLAY-CNT
  1236
  1237     MOVE WS-INVALID-ST-CNT      TO WS-DISPLAY-CNT
  1238     DISPLAY '***  INVALID STATES              = ' WS-DISPLAY-CNT
  1239
  1240     MOVE WS-ERPNDB-RECS-DEL     TO WS-DISPLAY-CNT
  1241     DISPLAY '***  ERPNDB RECORDS   DELETED    = ' WS-DISPLAY-CNT
  1242
  1243     DISPLAY '***                                            ***'
  1244     DISPLAY '**************************************************'
  1245
  1246     .
  1247 4000-EXIT.
  1248     EXIT.
  1249
  1250 8510-DATE-CONVERSION.
  1251
  1252     CALL 'ELDATCX' USING DATE-CONVERSION-DATA
  1253
  1254     .
  1255 8590-EXIT.
  1256     EXIT.
  1257
  1258 9999-ABEND-RTN.
  1259
  1260     DISPLAY '*** ERPNDB  FILE CONVERSION PROGRAM ABENDING ***'
  1261     DISPLAY '************************************************'
  1262
  1263     MOVE 1                      TO WS-ABEND-FLD
  1264     MOVE 0                      TO WS-ZERO-FLD
  1265
  1266     COMPUTE WS-ABEND-FLD = WS-ABEND-FLD / WS-ZERO-FLD
  1267     .
  1268 9999-EXIT.
  1269     EXIT.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:        3884     Code:        2744
