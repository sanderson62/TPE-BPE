* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   1
* ZAJRERLAEX.cbl
* Options: int("ZAJRERLAEX.int") anim csi verbose NOBOUND PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("ZAJRERLAEX.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"ebmlsfile" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" NOCHECKDIV NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"32" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"ZAJRERLAEX.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST
*          "ZAJRERLAEX.lst" LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE
*          "0" NOMAPNAME NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT
*          NOMOVELENCHECK NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT
*          NONCHAR NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR NOSTICKY-LINKAGE
*          NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"2" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2 PROGRAM-ID. ZAJRERLAEX.
     3 AUTHOR.     PABLO
     4 DATE-COMPILED. 06-Oct-15 17:19.
     5 ENVIRONMENT DIVISION.
     6 INPUT-OUTPUT SECTION.
     7 FILE-CONTROL.
     8
     9     SELECT ERARCH           ASSIGN TO ERARCH
    10                             ORGANIZATION IS INDEXED
    11                             ACCESS IS DYNAMIC
    12                             RECORD KEY IS LA-CONTROL-PRIMARY
    13                             FILE STATUS IS ERARCH-FILE-STATUS.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   2
* ZAJRERLAEX.cbl
    14
    15     SELECT  EXTRACT-OUT      ASSIGN TO EXTROT
    16                              organization is line sequential.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   3
* ZAJRERLAEX.cbl
    18 DATA DIVISION.
    19 FILE SECTION.
    20
    21
    22 FD  ERARCH.
    23
*   24                             COPY ERCARCH.
    25******************************************************************04/19/98
    26*                                                                *ERCARCH
    27*                            ERCARCH.                            *   LV002
    28*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
    29*                            VMOD=2.002                          *   CL**2
    30*                                                                *ERCARCH
    31*   FILE DESCRIPTION = LETTERS SENT TO ARCHIVE FILE              *ERCARCH
    32*                                                                *ERCARCH
    33*   FILE TYPE = VSAM,KSDS                                        *ERCARCH
    34*   RECORD SIZE = 250  RECFORM = FIXED                           *ERCARCH
    35*                                                                *ERCARCH
    36*   BASE CLUSTER = ERARCH                        RKP=2,LEN=5     *ERCARCH
    37*     ALTERNATE PATH1 = ERARCH2 (CERT/RESP)      RKP=07,LEN=35   *ERCARCH
    38*     ALTERNATE PATH2 = ERARCH3 (FORM NUMBER)    RKP=44,LEN=28   *ERCARCH
    39*     ALTERNATE PATH3 = ERARCH4 (PROCCESSOR ID)  RKP=73,LEN=28   *ERCARCH
    40*     ALTERNATE PATH4 = ERARCH5 (ACCOUNT KEY)    RKP=100,LEN=24  *ERCARCH
    41*     ALTERNATE PATH5 = ERARCH6 (BTCH/CHK KEY)   RKP=124,LEN=11  *ERCARCH
    42*                                                                *ERCARCH
    43*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *ERCARCH
    44******************************************************************ERCARCH
    45*                   C H A N G E   L O G
    46*
    47* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    48*-----------------------------------------------------------------
    49*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    50* EFFECTIVE    NUMBER
    51*-----------------------------------------------------------------
    52* 031011  CR2007070900001  PEMA  ADD FOLLOW-UP LETTER PROCESSING
    53* 070711  CR2011022800001  AJRA  NAPERSOFT CHANGES
    54* 110612    2012101700002  AJRA  ADD NEW FIELDS
    55******************************************************************
    56 01  LETTER-ARCHIVE.                                              ERCARCH
    57     12  LA-RECORD-ID                PIC  X(02).                  ERCARCH
    58         88  LA-VALID-ID                VALUE 'LA'.               ERCARCH
    59                                                                  ERCARCH
    60     12  LA-CONTROL-PRIMARY.                                      ERCARCH
    61         16  LA-COMPANY-CD           PIC  X(01).                  ERCARCH
    62         16  LA-ARCHIVE-NO           PIC S9(08)    COMP.          ERCARCH
    63                                                                  ERCARCH
    64     12  LA-CONTROL-BY-CERT-RESP.                                 ERCARCH
    65         16  LA-COMPANY-CD-A2        PIC  X(01).                  ERCARCH
    66         16  LA-CERT-NO-A2.                                       ERCARCH
    67             20  LA-CERT-PRIME-A2    PIC  X(10).                  ERCARCH
    68             20  LA-CERT-SUFFIX-A2   PIC  X(01).                  ERCARCH
    69         16  LA-RSP-PERSON-A2 REDEFINES LA-CERT-NO-A2.            ERCARCH
    70             20  LA-RESP-PERSON-A2   PIC  X(10).                  ERCARCH
    71             20  LA-TYPE-A2          PIC  X(01).                  ERCARCH
    72         16  LA-CARRIER-A2           PIC  X(01).                  ERCARCH
    73         16  LA-GROUPING-A2          PIC  X(06).                  ERCARCH
    74         16  LA-STATE-A2             PIC  X(02).                  ERCARCH
    75         16  LA-ACCOUNT-A2           PIC  X(10).                  ERCARCH
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   4
* ZAJRERLAEX.cbl (/apps/prod/cid1p/copy/ERCARCH)
    76         16  LA-EFFECT-DATE-A2       PIC  X(02).                  ERCARCH
    77         16  LA-ARCHIVE-NO-A2        PIC S9(08)    COMP.          ERCARCH
    78                                                                  ERCARCH
    79     12  LA-CONTROL-BY-FORM.                                      ERCARCH
    80         16  LA-COMPANY-CD-A3        PIC  X(01).                  ERCARCH
    81         16  LA-FORM-A3              PIC  X(04).                  ERCARCH
    82         16  LA-CARRIER-A3           PIC  X(01).                  ERCARCH
    83         16  LA-GROUPING-A3          PIC  X(06).                  ERCARCH
    84         16  LA-STATE-A3             PIC  X(02).                  ERCARCH
    85         16  LA-ACCOUNT-A3           PIC  X(10).                  ERCARCH
    86         16  LA-ARCHIVE-NO-A3        PIC S9(08)    COMP.          ERCARCH
    87                                                                  ERCARCH
    88     12  LA-CONTROL-BY-PROCESSOR.                                 ERCARCH
    89         16  LA-COMPANY-CD-A4        PIC  X(01).                  ERCARCH
    90         16  LA-PROCESSOR-CD         PIC  X(04).                  ERCARCH
    91         16  LA-CARRIER-A4           PIC  X(01).                  ERCARCH
    92         16  LA-GROUPING-A4          PIC  X(06).                  ERCARCH
    93         16  LA-STATE-A4             PIC  X(02).                  ERCARCH
    94         16  LA-ACCOUNT-A4           PIC  X(10).                  ERCARCH
    95         16  LA-ARCHIVE-NO-A4        PIC S9(08)    COMP.          ERCARCH
    96                                                                  ERCARCH
    97     12  LA-CONTROL-BY-KEY-FIELDS.                                ERCARCH
    98         16  LA-COMPANY-CD-A5        PIC  X(01).                  ERCARCH
    99         16  LA-CARRIER-A5           PIC  X(01).                  ERCARCH
   100         16  LA-GROUPING-A5          PIC  X(06).                  ERCARCH
   101         16  LA-STATE-A5             PIC  X(02).                  ERCARCH
   102         16  LA-ACCOUNT-A5           PIC  X(10).                  ERCARCH
   103         16  LA-ARCHIVE-NO-A5        PIC S9(08)    COMP.          ERCARCH
   104                                                                  ERCARCH
   105     12  LA-CONTROL-BY-GROUP-CODE.                                ERCARCH
   106         16  LA-COMPANY-CD-A6        PIC  X(01).                  ERCARCH
   107         16  LA-ENTRY-A6.                                         ERCARCH
   108             20  LA-FILLER           PIC  X(02).                  ERCARCH
   109             20  LA-QUE-CONTROL-A6   PIC S9(08)    COMP.          ERCARCH
   110         16  LA-ARCHIVE-NO-A6        PIC S9(08)    COMP.          ERCARCH
   111                                                                  ERCARCH
   112     12  FILLER                      PIC  X(09).                  ERCARCH
   113                                                                  ERCARCH
   114     12  LA-HEADER-RECORD.                                        ERCARCH
   115         16  LA-NUMBER-LABEL-LINES   PIC S9(04)    COMP.          ERCARCH
   116         16  LA-CREATION-DATE        PIC  X(02).                  ERCARCH
   117         16  LA-FOLLOW-UP-DATE       PIC  X(02).                  ERCARCH
   118         16  LA-FINAL-ACT-DATE       REDEFINES
   119               LA-FOLLOW-UP-DATE     PIC  X(02).
   120         16  LA-INITIAL-PRINT-DATE   PIC  X(02).                  ERCARCH
   121         16  LA-NO-OF-COPIES         PIC S9(01).                  ERCARCH
   122         16  LA-NO-OF-TEXT-RECORDS   PIC S9(04)    COMP.          ERCARCH
   123         16  LA-REPLY-DATE           PIC  X(02).                  ERCARCH
   124         16  LA-RESEND-DATES.                                     ERCARCH
   125             20  LA-RESEND-DATE      PIC  X(02).                  ERCARCH
   126             20  LA-SENT-DATE        PIC  X(02).                  ERCARCH
   127             20  FILLER              PIC  X(08).
   128         16  LA-SOURCE-INFORMATION.                               ERCARCH
   129             20  LA-DATA-SOURCE      PIC  X(01).                  ERCARCH
   130             20  LA-ADDR-SOURCE      PIC  X(01).                  ERCARCH
   131         16  LA-STATUS               PIC  X(01).                  ERCARCH
   132             88  LA-STATUS-ACTIVE         VALUE 'A'.              ERCARCH
   133             88  LA-STATUS-COMPLETED      VALUE 'C'.              ERCARCH
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   5
* ZAJRERLAEX.cbl (/apps/prod/cid1p/copy/ERCARCH)
   134             88  LA-STATUS-ON-HOLD        VALUE 'H'.              ERCARCH
   135             88  LA-STATUS-TO-BE-PURGED   VALUE 'X'.              ERCARCH
   136             88  LA-STATUS-PURGED         VALUE 'P'.              ERCARCH
   137             88  LA-STATUS-VOIDED         VALUE 'V'.              ERCARCH
   138         16  LA-LAST-RESENT-PRINT-DATE                            ERCARCH
   139                                     PIC  X(02).                  ERCARCH
   140         16  LA-PRINT-RESTRICTION    PIC  X(01).                  ERCARCH
   141             88  LA-PRINT-ONLY-WHEN-CNTL-GIVEN                    ERCARCH
   142                                          VALUE 'C'.              ERCARCH
   143             88  LA-PRINT-ONLY-WHEN-FORM-GIVEN                    ERCARCH
   144                                          VALUE 'F'.              ERCARCH
   145             88  LA-PRINT-ONLY-WHEN-PROC-GIVEN                    ERCARCH
   146                                          VALUE 'P'.              ERCARCH
   147         16  LA-PURGED-DATE          PIC  X(02).                  ERCARCH
   148         16  LA-VOIDED-DATE          PIC  X(02).
   149         16  LA-RESEND-LETR          PIC  X(4).
   150         16  FILLER                  PIC  X(08).
   151*        16  LA-RESEND-LETR-2        PIC  X(4).
   152*        16  LA-RESEND-LETR-3        PIC  X(4).
   153*        16  FILLER                  PIC  X(59).
   154         16  LA-ARCHIVE-STATUS       PIC  X.
   155             88  LA-TEMP                VALUE 'T'.
   156             88  LA-QWS                 VALUE 'Q'.
   157             88  LA-BATCH               VALUE 'B'.
   158         16  LA-FINAL-ACT-IND        PIC  X(1).
   159         16  LA-VA-DISCLOSURE-IND    PIC  X(1).
   160         16  LA-ENDT-ARCH-NO         PIC S9(8) COMP.
   161         16  LA-ENDT-ARCH-NO-X REDEFINES LA-ENDT-ARCH-NO
   162                                     PIC X(4).
   163         16  FILLER                  PIC  X(42).
   164*        16  FILLER                  PIC  X(71).                  ERCARCH
   165         16  LA-LAST-MAINT-DATE      PIC  X(2).
   166         16  LA-LAST-MAINT-TIME      PIC S9(6) COMP-3.
   167         16  LA-LAST-MAINT-TIMEX  REDEFINES LA-LAST-MAINT-TIME
   168                                     PIC  X(4).
   169         16  LA-LAST-UPDATED-BY      PIC  X(4).
   170                                                                  ERCARCH
   171******************************************************************ERCARCH
   172
   173 FD  EXTRACT-OUT
   174     RECORDING MODE F
   175     LABEL RECORDS STANDARD
   176     BLOCK CONTAINS 0 RECORDS.
   177 01  EXTRACT-RECORD.
   178     05  EXT-REC-CERT-NO       PIC X(11).
   179     05  EXT-REC-LTR-FORM      PIC X(04).
   180     05  EXT-REC-creation-DT   PIC X(08).
   181     05  EXT-REC-archive-no    PIC 9(08).
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   6
* ZAJRERLAEX.cbl
   183
   184 WORKING-STORAGE SECTION.
   185 77  FILLER  PIC X(32) VALUE '********************************'.
   186 77  FILLER  PIC X(32) VALUE '   PEMATC1   WORKING-STORAGE    '.
   187 77  FILLER  PIC X(32) VALUE '********************************'.
   188
   189 77  WS-EOF-SW               PIC X VALUE SPACES.
   190     88  END-OF-ERARCH             VALUE 'Y'.
   191 77  TRLR-RECS-IN            PIC 9(9) VALUE ZEROS.
   192 77  TRLR-RECS-OUT           PIC 9(9) VALUE ZEROS.
   193 77  TRLR-RECS-FIX           PIC 9(9) VALUE ZEROS.
   194
   195 01  WS-MISC.
   196     05  START-DT                PIC XX.
   197     05  END-DT                  PIC XX.
   198     05  ws-work-seq             pic x.
   199     05  ws-num-seq redefines ws-work-seq pic 9.
   200     05  WS-SAVE-ERARCH          PIC X(207) VALUE LOW-VALUES.
   201     05  ERARCH-FILE-STATUS      PIC XX    VALUE ZEROS.
   202     05  WS-DATE                 PIC 9(11) VALUE ZEROS.
   203     05  WS-ZERO               PIC S9(01)    VALUE +0.
   204     05  WS-RETURN-CODE        PIC S9(03)    VALUE +0.
   205     05  WS-ABEND-MESSAGE      PIC X(80)     VALUE SPACES.
   206     05  WS-ABEND-FILE-STATUS  PIC X(02)     VALUE ZERO.
   207
*  208                                 COPY ELCDATE.
   209******************************************************************06/11/98
   210*                                                                *ELCDATE
   211*                                                                *ELCDATE
   212*                            ELCDATE.                            *   LV023
   213*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL*16
   214*                            VMOD=2.003                           ELCDATE
   215*                                                                *ELCDATE
   216*                                                                *ELCDATE
   217*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *ELCDATE
   218*                 LENGTH = 200                                   *   CL*19
   219******************************************************************ELCDATE
   220                                                                  ELCDATE
   221 01  DATE-CONVERSION-DATA.                                        ELCDATE
   222     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.    CL*19
   223     12  DC-OPTION-CODE                PIC X.                        CL*15
   224         88  BIN-TO-GREG                VALUE ' '.                ELCDATE
   225         88  ELAPSED-BETWEEN-BIN        VALUE '1'.                ELCDATE
   226         88  EDIT-GREG-TO-BIN           VALUE '2'.                ELCDATE
   227         88  YMD-GREG-TO-BIN            VALUE '3'.                ELCDATE
   228         88  MDY-GREG-TO-BIN            VALUE '4'.                ELCDATE
   229         88  JULIAN-TO-BIN              VALUE '5'.                ELCDATE
   230         88  BIN-PLUS-ELAPSED           VALUE '6'.                ELCDATE
   231         88  FIND-CENTURY               VALUE '7'.                   CL*22
   232         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.                ELCDATE
   233         88  EDIT-GREG-TO-BIN-3         VALUE '9'.                ELCDATE
   234         88  YMD-GREG-TO-BIN-3          VALUE 'A'.                ELCDATE
   235         88  MDY-GREG-TO-BIN-3          VALUE 'B'.                ELCDATE
   236         88  JULIAN-TO-BIN-3            VALUE 'C'.                ELCDATE
   237         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.                ELCDATE
   238         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.                   CL*14
   239         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.                   CL*14
   240         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.                   CL*14
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   7
* ZAJRERLAEX.cbl (/apps/prod/cid1p/copy/ELCDATE)
   241         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.         CL*14
   242         88  CHECK-LEAP-YEAR            VALUE 'H'.                   CL*14
   243         88  BIN-3-TO-GREG              VALUE 'I'.                   CL*14
   244         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.                   CL*14
   245         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.                   CL*14
   246         88  CYMD-GREG-TO-BIN           VALUE 'L'.                   CL*14
   247         88  MDCY-GREG-TO-BIN           VALUE 'M'.                   CL*14
   248         88  MDY-GREG-TO-JULIAN         VALUE 'N'.                   CL*14
   249         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.                   CL*14
   250         88  YMD-GREG-TO-JULIAN         VALUE 'P'.                   CL*14
   251         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.                   CL*14
   252         88  THREE-CHARACTER-BIN                                  ELCDATE
   253                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.       CL*14
   254         88  GREGORIAN-TO-BIN                                        CL**2
   255                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.    CL*14
   256         88  BIN-TO-GREGORIAN                                        CL**2
   257                  VALUES ' ' '1' 'I' '8' 'G'.                        CL*14
   258         88  JULIAN-TO-BINARY                                        CL**2
   259                  VALUES '5' 'C' 'E' 'F'.                            CL*14
   260     12  DC-ERROR-CODE                 PIC X.                        CL*15
   261         88  NO-CONVERSION-ERROR        VALUE ' '.                   CL**3
   262         88  DATE-CONVERSION-ERROR                                ELCDATE
   263                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.        CL*14
   264         88  DATE-IS-ZERO               VALUE '1'.                ELCDATE
   265         88  DATE-IS-NON-NUMERIC        VALUE '2'.                ELCDATE
   266         88  DATE-IS-INVALID            VALUE '3'.                ELCDATE
   267         88  DATE1-GREATER-DATE2        VALUE '4'.                ELCDATE
   268         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.                ELCDATE
   269         88  DATE-INVALID-OPTION        VALUE '9'.                ELCDATE
   270         88  INVALID-CENTURY            VALUE 'A'.                ELCDATE
   271         88  ONLY-CENTURY               VALUE 'B'.                ELCDATE
   272         88  ONLY-LEAP-YEAR             VALUE 'C'.                ELCDATE
   273         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.              CL**3
   274     12  DC-END-OF-MONTH               PIC X.                        CL*15
   275         88  CALCULATE-END-OF-MONTH     VALUE '1'.                ELCDATE
   276     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.         CL*15
   277         88  USE-NORMAL-PROCESS         VALUE ' '.                ELCDATE
   278         88  ADJUST-DOWN-100-YRS        VALUE '1'.                ELCDATE
   279         88  ADJUST-UP-100-YRS          VALUE '2'.                ELCDATE
   280     12  FILLER                        PIC X.                        CL*15
   281     12  DC-CONVERSION-DATES.                                        CL*15
   282         16  DC-BIN-DATE-1             PIC XX.                       CL*15
   283         16  DC-BIN-DATE-2             PIC XX.                       CL*15
   284         16  DC-GREG-DATE-1-EDIT       PIC X(08).                    CL*15
   285         16  DC-GREG-DATE-1-EDIT-R REDEFINES                         CL*15
   286                       DC-GREG-DATE-1-EDIT.                       ELCDATE
   287             20  DC-EDIT1-MONTH        PIC 99.                       CL*15
   288             20  SLASH1-1              PIC X.                        CL*15
   289             20  DC-EDIT1-DAY          PIC 99.                       CL*15
   290             20  SLASH1-2              PIC X.                        CL*15
   291             20  DC-EDIT1-YEAR         PIC 99.                       CL*15
   292         16  DC-GREG-DATE-2-EDIT       PIC X(08).                    CL*15
   293         16  DC-GREG-DATE-2-EDIT-R REDEFINES                         CL*15
   294                     DC-GREG-DATE-2-EDIT.                         ELCDATE
   295             20  DC-EDIT2-MONTH        PIC 99.                       CL*15
   296             20  SLASH2-1              PIC X.                        CL*15
   297             20  DC-EDIT2-DAY          PIC 99.                       CL*15
   298             20  SLASH2-2              PIC X.                        CL*15
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   8
* ZAJRERLAEX.cbl (/apps/prod/cid1p/copy/ELCDATE)
   299             20  DC-EDIT2-YEAR         PIC 99.                       CL*15
   300         16  DC-GREG-DATE-1-YMD        PIC 9(06).                    CL*15
   301         16  DC-GREG-DATE-1-YMD-R  REDEFINES                         CL*15
   302                     DC-GREG-DATE-1-YMD.                          ELCDATE
   303             20  DC-YMD-YEAR           PIC 99.                       CL*15
   304             20  DC-YMD-MONTH          PIC 99.                       CL*15
   305             20  DC-YMD-DAY            PIC 99.                       CL*15
   306         16  DC-GREG-DATE-1-MDY        PIC 9(06).                    CL*15
   307         16  DC-GREG-DATE-1-MDY-R REDEFINES                          CL*15
   308                      DC-GREG-DATE-1-MDY.                         ELCDATE
   309             20  DC-MDY-MONTH          PIC 99.                       CL*15
   310             20  DC-MDY-DAY            PIC 99.                       CL*15
   311             20  DC-MDY-YEAR           PIC 99.                       CL*15
   312         16  DC-GREG-DATE-1-ALPHA.                                   CL*15
   313             20  DC-ALPHA-MONTH        PIC X(10).                    CL*15
   314             20  DC-ALPHA-DAY          PIC 99.                       CL*15
   315             20  FILLER                PIC XX.                       CL*15
   316             20  DC-ALPHA-CENTURY.                                   CL*15
   317                 24 DC-ALPHA-CEN-N     PIC 99.                       CL*15
   318             20  DC-ALPHA-YEAR         PIC 99.                       CL*15
   319         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.           CL*15
   320         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.           CL*15
   321         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.           CL*15
   322         16  DC-JULIAN-DATE            PIC 9(05).                    CL*15
   323         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE                CL*20
   324                                       PIC 9(05).                    CL*20
   325         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.                  CL*15
   326             20  DC-JULIAN-YEAR        PIC 99.                       CL*15
   327             20  DC-JULIAN-DAYS        PIC 999.                      CL*15
   328         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.       CL*15
   329         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.    CL*15
   330         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.    CL*15
   331     12  DATE-CONVERSION-VARIBLES.                                   CL*15
   332         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.            CL*15
   333         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.          CL*15
   334             20  FILLER                PIC 9(3).                     CL*15
   335             20  HOLD-CEN-1-CCYY.                                    CL*15
   336                 24  HOLD-CEN-1-CC     PIC 99.                       CL*17
   337                 24  HOLD-CEN-1-YY     PIC 99.                       CL*17
   338             20  HOLD-CEN-1-MO         PIC 99.                       CL*17
   339             20  HOLD-CEN-1-DA         PIC 99.                       CL*17
   340         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.            CL*15
   341             20  HOLD-CEN-1-R-MO       PIC 99.                       CL*17
   342             20  HOLD-CEN-1-R-DA       PIC 99.                       CL*17
   343             20  HOLD-CEN-1-R-CCYY.                                  CL*15
   344                 24  HOLD-CEN-1-R-CC   PIC 99.                       CL*17
   345                 24  HOLD-CEN-1-R-YY   PIC 99.                       CL*17
   346             20  FILLER                PIC 9(3).                     CL*15
   347         16  HOLD-CENTURY-1-X.                                       CL*15
   348             20  FILLER                PIC X(3)  VALUE SPACES.       CL*15
   349             20  HOLD-CEN-1-X-CCYY.                                  CL*15
   350                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.          CL*17
   351                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.          CL*17
   352             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.          CL*17
   353             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.          CL*17
   354         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.          CL*15
   355             20  HOLD-CEN-1-R-X-MO     PIC XX.                       CL*17
   356             20  HOLD-CEN-1-R-X-DA     PIC XX.                       CL*17
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   9
* ZAJRERLAEX.cbl (/apps/prod/cid1p/copy/ELCDATE)
   357             20  HOLD-CEN-1-R-X-CCYY.                                CL*15
   358                 24  HOLD-CEN-1-R-X-CC PIC XX.                       CL*17
   359                 24  HOLD-CEN-1-R-X-YY PIC XX.                       CL*17
   360             20  FILLER                PIC XXX.                      CL*23
   361         16  DC-BIN-DATE-EXPAND-1      PIC XXX.                      CL*15
   362         16  DC-BIN-DATE-EXPAND-2      PIC XXX.                      CL*15
   363         16  DC-JULIAN-DATE-1          PIC 9(07).                    CL*15
   364         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.          CL*15
   365             20  DC-JULIAN-1-CCYY.                                   CL*15
   366                 24  DC-JULIAN-1-CC    PIC 99.                       CL*15
   367                 24  DC-JULIAN-1-YR    PIC 99.                       CL*15
   368             20  DC-JULIAN-DA-1        PIC 999.                      CL*15
   369         16  DC-JULIAN-DATE-2          PIC 9(07).                    CL*15
   370         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.          CL*15
   371             20  DC-JULIAN-2-CCYY.                                   CL*15
   372                 24  DC-JULIAN-2-CC    PIC 99.                       CL*15
   373                 24  DC-JULIAN-2-YR    PIC 99.                       CL*15
   374             20  DC-JULIAN-DA-2        PIC 999.                      CL*15
   375         16  DC-GREG-DATE-A-EDIT.                                    CL*15
   376             20  DC-EDITA-MONTH        PIC 99.                       CL*15
   377             20  SLASHA-1              PIC X VALUE '/'.              CL*15
   378             20  DC-EDITA-DAY          PIC 99.                       CL*15
   379             20  SLASHA-2              PIC X VALUE '/'.              CL*15
   380             20  DC-EDITA-CCYY.                                      CL*15
   381                 24  DC-EDITA-CENT     PIC 99.                       CL*15
   382                 24  DC-EDITA-YEAR     PIC 99.                       CL*15
   383         16  DC-GREG-DATE-B-EDIT.                                    CL*15
   384             20  DC-EDITB-MONTH        PIC 99.                       CL*15
   385             20  SLASHB-1              PIC X VALUE '/'.              CL*15
   386             20  DC-EDITB-DAY          PIC 99.                       CL*15
   387             20  SLASHB-2              PIC X VALUE '/'.              CL*15
   388             20  DC-EDITB-CCYY.                                      CL*15
   389                 24  DC-EDITB-CENT     PIC 99.                       CL*15
   390                 24  DC-EDITB-YEAR     PIC 99.                       CL*15
   391         16  DC-GREG-DATE-CYMD         PIC 9(08).                    CL*15
   392         16  DC-GREG-DATE-CYMD-R REDEFINES                           CL*15
   393                              DC-GREG-DATE-CYMD.                  ELCDATE
   394             20  DC-CYMD-CEN           PIC 99.                       CL*15
   395             20  DC-CYMD-YEAR          PIC 99.                       CL*15
   396             20  DC-CYMD-MONTH         PIC 99.                       CL*15
   397             20  DC-CYMD-DAY           PIC 99.                       CL*15
   398         16  DC-GREG-DATE-MDCY         PIC 9(08).                    CL*15
   399         16  DC-GREG-DATE-MDCY-R REDEFINES                           CL*15
   400                              DC-GREG-DATE-MDCY.                  ELCDATE
   401             20  DC-MDCY-MONTH         PIC 99.                       CL*15
   402             20  DC-MDCY-DAY           PIC 99.                       CL*15
   403             20  DC-MDCY-CEN           PIC 99.                       CL*15
   404             20  DC-MDCY-YEAR          PIC 99.                       CL*15
   405    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.      ELCDATE
   406        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.        ELCDATE
   407    12  DC-EL310-DATE                  PIC X(21).                    CL*26
   408    12  FILLER                         PIC X(28).                    CL*26
   409
   410 LINKAGE SECTION.
   411
   412 01  PARM.
   413     05  PARM-LENGTH        COMP     PIC S9(04)    VALUE ZEROS.
   414     05  PARM-START-DT               PIC X(08)     VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  10
* ZAJRERLAEX.cbl
   415     05  PARM-END-DT                 PIC X(08)     VALUE SPACES.
   416
   417
   418 PROCEDURE DIVISION USING PARM.
   419
   420 0000-MAIN.
   421     DISPLAY 'PARM Start Date = ' PARM-Start-dt
   422     DISPLAY 'PARM End Date = ' PARM-End-dt
   423
   424     PERFORM 0400-OPEN-FILES THRU 0400-EXIT
   425
   426     PERFORM 0600-INITIALIZE THRU 0600-EXIT
   427
   428     PERFORM 0100-PROCESS-TRLR THRU 0100-EXIT UNTIL
   429           END-OF-ERARCH
   430
   431     PERFORM 0500-CLOSE-FILES THRU 0500-EXIT
   432
   433     DISPLAY ' ARCH RECORDS READ    ' TRLR-RECS-IN
   434     DISPLAY ' ARCH RECORDS WRITTEN ' TRLR-RECS-OUT
   435     DISPLAY ' ARCH RECORDS FIXED   ' TRLR-RECS-FIX
   436     GOBACK
   437
   438     .
   439 0100-PROCESS-TRLR.
   440
   441     IF LA-creation-date >= start-dt  and
   442        la-creation-date <= end-dt
   443        PERFORM 0300-WRITE-TRLR THRU 0300-EXIT
   444     END-IF
   445
   446     PERFORM 0200-READ-TRLR THRU 0200-EXIT
   447
   448     .
   449
   450 0100-EXIT.
   451     EXIT.
   452
   453 0200-READ-TRLR.
   454
   455     READ ERARCH NEXT RECORD
   456
   457     if la-company-cd not = X'04'
   458         set end-of-erarch       to true
   459     end-if
   460
   461     IF ERARCH-FILE-STATUS = '10' OR '23'
   462        SET END-OF-ERARCH        TO TRUE
   463     ELSE
   464        IF ERARCH-FILE-STATUS NOT = '00'
   465           DISPLAY 'ERARCH READ NEXT ' ERARCH-FILE-STATUS
   466           SET END-OF-ERARCH     TO TRUE
   467        END-IF
   468     END-IF
   469
   470     IF NOT END-OF-ERARCH
   471        ADD 1 TO trlr-RECS-IN
   472     END-IF
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  11
* ZAJRERLAEX.cbl
   473
   474     .
   475
   476 0200-EXIT.
   477     EXIT.
   478
   479 0300-WRITE-TRLR.
   480
   481     if la-cert-no-a2 equal low-values
   482         go to 0300-exit
   483     else
   484         MOVE LA-CERT-NO-A2       TO EXT-REC-CERT-NO
   485     end-if
   486     if la-form-a3 equal low-values
   487*         move spaces              to ext-rec-ltr-form
   488         go to 0300-exit
   489     else
   490         MOVE LA-FORM-A3          TO EXT-REC-LTR-FORM
   491     end-if
   492
   493     MOVE LA-Creation-DaTe        TO DC-BIN-DATE-1
   494     MOVE ' '                     TO DC-OPTION-CODE
   495     PERFORM 8500-DATE-CONVERSION THRU 8500-EXIT
   496
   497     IF NO-CONVERSION-ERROR
   498         MOVE DC-GREG-DATE-CYMD  TO EXT-REC-creation-DT
   499     ELSE
   500         MOVE SPACES              TO EXT-REC-creation-DT
   501     END-IF
   502
   503     move la-archive-no           to ext-rec-archive-no
   504
   505     WRITE EXTRACT-RECORD
   506     ADD 1 TO TRLR-RECS-OUT
   507
   508     .
   509
   510 0300-EXIT.
   511     EXIT.
   512
   513 0400-OPEN-FILES.
   514
   515     OPEN INPUT ERARCH
   516         OUTPUT EXTRACT-OUT
   517
   518     IF ERARCH-FILE-STATUS = '00' OR '97'
   519        continue
   520     ELSE
   521        DISPLAY 'ERARCH open err  ' ERARCH-FILE-STATUS
   522     END-IF
   523
   524
   525     .
   526
   527 0400-EXIT.
   528     EXIT.
   529
   530 0500-CLOSE-FILES.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  12
* ZAJRERLAEX.cbl
   531
   532     CLOSE ERARCH EXTRACT-OUT
   533
   534     .
   535
   536 0500-EXIT.
   537     EXIT.
   538 0550-START-ERARCH.
   539
   540     MOVE LOW-VALUES             TO LA-CONTROL-PRIMARY
   541     MOVE X'04'                  TO LA-COMPANY-CD
   542
   543     START ERARCH KEY IS NOT < LA-CONTROL-PRIMARY
   544
   545     IF ERARCH-FILE-STATUS = '10' OR '23'
   546        SET END-OF-ERARCH        TO TRUE
   547     ELSE
   548        IF ERARCH-FILE-STATUS NOT = '00'
   549           DISPLAY 'ERARCH START     ' ERARCH-FILE-STATUS
   550           SET END-OF-ERARCH     TO TRUE
   551        END-IF
   552     END-IF
   553
   554     .
   555
   556 0550-EXIT.
   557     EXIT.
   558
   559
   560 0600-INITIALIZE.
   561
   562     MOVE PARM-START-DT           TO DC-GREG-DATE-CYMD
   563     MOVE 'L'                     TO DC-OPTION-CODE
   564     PERFORM 8500-DATE-CONVERSION THRU 8500-EXIT
   565
   566     IF NO-CONVERSION-ERROR
   567         MOVE DC-BIN-DATE-1       TO START-DT
   568     ELSE
   569         DISPLAY 'INVALID DATE '  PARM-START-DT
   570         PERFORM ABEND-PGM        THRU APS-EXIT
   571     END-IF
   572
   573
   574     MOVE PARM-END-DT             TO DC-GREG-DATE-CYMD
   575     MOVE 'L'                     TO DC-OPTION-CODE
   576     PERFORM 8500-DATE-CONVERSION THRU 8500-EXIT
   577
   578     IF NO-CONVERSION-ERROR
   579         MOVE DC-BIN-DATE-1       TO END-DT
   580     ELSE
   581         DISPLAY 'INVALID DATE '  PARM-END-DT
   582         PERFORM ABEND-PGM        THRU APS-EXIT
   583     END-IF
   584
   585
   586     PERFORM 0550-START-ERARCH   THRU 0550-EXIT
   587     PERFORM 0200-READ-TRLR THRU 0200-EXIT
   588
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  13
* ZAJRERLAEX.cbl
   589     .
   590
   591 0600-EXIT.
   592     EXIT.
   593
   594
   595
   596 8500-DATE-CONVERSION.
   597
   598     CALL 'ELDATCX' USING DATE-CONVERSION-DATA
   599
   600     .
   601 8500-EXIT.
   602     EXIT.
   603
   604
   605 ABEND-PGM.
*                 COPY ELCABEND.
   606***************************************************************** 04/14/98
   607*                                                               * ELCABEND
   608*                            ELCABEND.                          *    LV003
   609*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
   610*                            VMOD 2.002                              CL**2
   611*                                                               * ELCABEND
   612*                THIS SECTION DISPLAYS THE NECESSARY MESSAGES   * ELCABEND
   613*            AND THEN ABENDS.                                   * ELCABEND
   614*                                                               * ELCABEND
   615*  NO  CID  MODS  IN  COPYBOOK  ELCABEND                        * ELCABEND
   616*                                                               * ELCABEND
   617***************************************************************** ELCABEND
   618*APS-010.                                                         ELCABEND
   619     DISPLAY WS-ABEND-MESSAGE.                                    ELCABEND
   620     DISPLAY WS-ABEND-MESSAGE UPON CONSOLE.                       ELCABEND
   621                                                                  ELCABEND
   622     IF WS-ABEND-FILE-STATUS NOT = ZERO                           ELCABEND
   623         DISPLAY 'FILE STATUS = ' WS-ABEND-FILE-STATUS            ELCABEND
   624         DISPLAY 'FILE STATUS = ' WS-ABEND-FILE-STATUS            ELCABEND
   625                                 UPON CONSOLE.                    ELCABEND
   626                                                                  ELCABEND
   627     IF WS-RETURN-CODE NOT = ZERO                                 ELCABEND
   628         DISPLAY 'RETURN CODE = '  WS-RETURN-CODE                 ELCABEND
   629         DISPLAY 'RETURN CODE = '  WS-RETURN-CODE                 ELCABEND
   630                                 UPON CONSOLE.                    ELCABEND
   631                                                                  ELCABEND
   632     DISPLAY 'PROGRAM WILL NOW ABEND **************'              ELCABEND
   633     DISPLAY 'PROGRAM WILL NOW ABEND **************'              ELCABEND
   634                                 UPON CONSOLE.                    ELCABEND
   635                                                                  ELCABEND
   636     DIVIDE WS-ZERO BY WS-ZERO GIVING WS-ZERO.                    ELCABEND
   637     CALL 'ABORTME'.
   638                                                                  ELCABEND
   639 APS-EXIT.                                                        ELCABEND
   640     EXIT.                                                        ELCABEND
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:        2380     Code:        1394
